<!DOCTYPE html><html><head><title>Help for package dfped</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dfped}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dfped-package'>
<p>Extrapolation and Bridging of Adult Information in Early Phase Dose-Finding Paediatrics Studies</p></a></li>
<li><a href='#albAge'>
<p>Concentration of albumin according to age.</p></a></li>
<li><a href='#alpha1AGage'>
<p>Concentration of alpha1-acid glycoprotein according to age.</p></a></li>
<li><a href='#Cladu'>
<p>Clearance of the unbound fraction of a specific molecule for the adult population.</p></a></li>
<li><a href='#Clch.Allo'>
<p>Paediatric clearance according to the allometry adjustment (AA) for a specific age.</p></a></li>
<li><a href='#Clch.Linear'>
<p>Paediatric clearance according to the linear adjustment (LA) for a specific age.</p></a></li>
<li><a href='#Clch.Mat'>
<p>Paediatric clearance according to the maturation adjustment (MA) for a specific age.</p></a></li>
<li><a href='#Clchu'>
<p>Clearance of the unbound fraction of a specific molecule for the paediatric population.</p></a></li>
<li><a href='#concAd'>
<p>Concentration of a specific molecule in plasma for the adult population.</p></a></li>
<li><a href='#concCh'>
<p>Concentration of a specific molecule in plasma for the paediatric population.</p></a></li>
<li><a href='#doseChoice'>
<p>Choice of the next given dose level.</p></a></li>
<li><a href='#doseRange'>
<p>Dose-range for the paediatric population according to adult clearance, adult doses and paediatric clearance.</p></a></li>
<li><a href='#Fch'>
<p>Paediatric bioavailability according to age.</p></a></li>
<li><a href='#fuCh'>
<p>Unbound fraction of the molecule in the plasma for children.</p></a></li>
<li><a href='#KCYP1A2'>
<p>Fraction of adult CYP1A2 abundance according to age.</p></a></li>
<li><a href='#KCYP2B6'>
<p>Fraction of adult CYP2B6 abundance according to age.</p></a></li>
<li><a href='#KCYP2C18_19'>
<p>Fraction of adult CYP2C18/CYP2C19 abundance according to age.</p></a></li>
<li><a href='#KCYP2C8'>
<p>Fraction of adult CYP2C8 abundance according to age.</p></a></li>
<li><a href='#KCYP2C9'>
<p>Fraction of adult CYP2C9 abundance according to age.</p></a></li>
<li><a href='#KCYP2D6'>
<p>Fraction of adult CYP2D6 abundance according to age.</p></a></li>
<li><a href='#KCYP2E1'>
<p>Fraction of adult CYP2E1 abundance according to age.</p></a></li>
<li><a href='#KCYP3A'>
<p>Fraction of adult CYP3A abundance according to age.</p></a></li>
<li><a href='#KCYP3A4_5'>
<p>Fraction of adult CYP3A4/CYP3A5 abundance according to age.</p></a></li>
<li><a href='#kickoffControl'>
<p>Control for presence of at least toxicities and efficacies for the good run of bCRM model.</p></a></li>
<li><a href='#metaPhase'>
<p>Meta-analysis function of dose-finding studies proposed by Zohar et al, (2011).</p></a></li>
<li><a href='#priorChoice'>
<p>Decision function for the choice of variance (sigmaHI or sigmaLI) in the adaptive prior variance calibration.</p></a></li>
<li><a href='#sigmaEss'>
<p>The variance of the effective sample size (ESS).</p></a></li>
<li><a href='#sigmaHI'>
<p>Compute the informative prior variance for the adaptive prior.</p></a></li>
<li><a href='#sigmaLI'>
<p>Compute the least informative prior variance for the adaptive prior.</p></a></li>
<li><a href='#simu'>
<p>A simulation of a single dose-finding trials in paediatrics.</p></a></li>
<li><a href='#simulation'>
<p>Simulate one or &quot;n&quot; dose-finding trials in paediatrics.</p></a></li>
<li><a href='#skeleton'>
<p>Build a working model.</p></a></li>
<li><a href='#waic'>
<p>Function for the Watanabe-Akaike information criteria (WAIC)</p></a></li>
<li><a href='#weightCYPsum'>
<p>Proportion of the molecule metabolised by the CYPs for a child according to age.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extrapolation and Bridging of Adult Information in Early Phase
Dose-Finding Paediatrics Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;, Caroline Petit &lt;caroline.petit@crc.jussieu.fr&gt;, Sarah Zohar &lt;sarah.zohar@inserm.fr&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Artemis Toumazi &lt;artemis.toumazi@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A unified method for designing and analysing dose-finding trials in paediatrics, while bridging information from adults, is proposed in the 'dfped' package. The dose range can be calculated under three extrapolation methods: linear, allometry and maturation adjustment, using pharmacokinetic (PK) data. To do this, it is assumed that target exposures are the same in both populations. The working model and prior distribution parameters of the dose-toxicity and dose-efficacy relationships can be obtained using early phase adult toxicity and efficacy data at several dose levels through 'dfped' package. Priors are used into the dose finding process through a Bayesian model selection or adaptive priors, to facilitate adjusting the amount of prior information to differences between adults and children. This calibrates the model to adjust for misspecification if the adult and paediatric data are very different. User can use his/her own Bayesian model written in Stan code through the 'dfped' package. A template of this model is proposed in the examples of the corresponding R functions in the package. Finally, in this package you can find a simulation function for one trial or for more than one trial. These methods are proposed by Petit et al, (2016) &lt;<a href="https://doi.org/10.1177%2F0962280216671348">doi:10.1177/0962280216671348</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), rstan(&ge; 2.8.1), stats4</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 2.0.0), methods, stats, graphics, grDevices</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://github.com/artemis-toumazi/dfped">http://github.com/artemis-toumazi/dfped</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://github.com/artemis-toumazi/dfped/issues">http://github.com/artemis-toumazi/dfped/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-25 13:54:24 UTC; artemistoumazi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-27 21:19:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='dfped-package'>
Extrapolation and Bridging of Adult Information in Early Phase Dose-Finding Paediatrics Studies
</h2><span id='topic+dfped-package'></span><span id='topic+dfped'></span>

<h3>Description</h3>

<p>A unified method for designing and analysing dose-finding trials in paediatrics, while bridging information from adults, is proposed in the 'dfped' package. The dose range can be calculated under three extrapolation methods: linear, allometry and maturation adjustment, using pharmacokinetic (PK) data. To do this, it is assumed that target exposures are the same in both populations. The working model and prior distribution parameters of the dose-toxicity and dose-efficacy relationships can be obtained using early phase adult toxicity and efficacy data at several dose levels through 'dfped' package. Priors are used into the dose finding process through a Bayesian model selection or adaptive priors, to facilitate adjusting the amount of prior information to differences between adults and children. This calibrates the model to adjust for misspecification if the adult and paediatric data are very different. User can use his/her own Bayesian model written in Stan code through the 'dfped' package. A template of this model is proposed in the examples of the corresponding R functions in the package. Finally, in this package you can find a simulation function for one trial or for more than one trial. These methods are proposed by Petit et al, (2016) &lt;doi:10.1177/0962280216671348&gt;.
</p>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>, Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>,
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a> 
</p>
<p>Maintainer: Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a> 
</p>


<h3>References</h3>

 
<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>

<hr>
<h2 id='albAge'>
Concentration of albumin according to age.
</h2><span id='topic+albAge'></span>

<h3>Description</h3>

<p>Compute the value of albumin (alb) concentration (g/L) according to age (year) for children - Truncated at 10000 days, i.e. 27 y.o. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>albAge(age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="albAge_+3A_age">age</code></td>
<td>

<p>The age of child.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+concCh">concCh</a></code>, <code><a href="#topic+alpha1AGage">alpha1AGage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 8
albAge(age)
</code></pre>

<hr>
<h2 id='alpha1AGage'>
Concentration of alpha1-acid glycoprotein according to age.
</h2><span id='topic+alpha1AGage'></span>

<h3>Description</h3>

<p>Compute the value of alpha1-acid glycoprotein (alpha1AG) concentration (g/L) according to age (year) for children.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha1AGage(age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha1AGage_+3A_age">age</code></td>
<td>
 
<p>The age of children. 
</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+concCh">concCh</a></code>, <code><a href="#topic+albAge">albAge</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 2
alpha1AGage(age)
</code></pre>

<hr>
<h2 id='Cladu'>
Clearance of the unbound fraction of a specific molecule for the adult population.
</h2><span id='topic+Cladu'></span>

<h3>Description</h3>

<p>Compute the clearance of the unbound fraction of a specific molecule for the adult population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cladu(Clad, fuAd, Fad)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cladu_+3A_clad">Clad</code></td>
<td>

<p>The apparent clearance for adults.
</p>
</td></tr>
<tr><td><code id="Cladu_+3A_fuad">fuAd</code></td>
<td>
 
<p>Unbound bioavailability for adults for the molecule. 
</p>
</td></tr>
<tr><td><code id="Cladu_+3A_fad">Fad</code></td>
<td>

<p>Bioavailability for adults.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Clchu">Clchu</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Cl_ad &lt;- 3.95
F_ad &lt;- 0.6
fu_ad &lt;- 1
Cladu(Cl_ad, fu_ad, F_ad)
</code></pre>

<hr>
<h2 id='Clch.Allo'>
Paediatric clearance according to the allometry adjustment (AA) for a specific age.
</h2><span id='topic+Clch.Allo'></span>

<h3>Description</h3>

<p>Compute the paediatric clearance according to the allometry adjustment (AA) for a specific age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Clch.Allo(age, w, Clad, Wad)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Clch.Allo_+3A_age">age</code></td>
<td>

<p>The age of child.
</p>
</td></tr>
<tr><td><code id="Clch.Allo_+3A_w">w</code></td>
<td>

<p>The weight of child.
</p>
</td></tr>
<tr><td><code id="Clch.Allo_+3A_clad">Clad</code></td>
<td>

<p>Apparent clearance of adult. 
</p>
</td></tr>
<tr><td><code id="Clch.Allo_+3A_wad">Wad</code></td>
<td>

<p>Weight of adult (or average weight in the adult population).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;. 
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Clch.Linear">Clch.Linear</a></code>, <code><a href="#topic+Clch.Mat">Clch.Mat</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########

    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    W &lt;- children$Weight
    W_ad &lt;- 70
    Cl_ad &lt;- 3.95

    Clch_allo &lt;- Clch.Allo(AGE, W, Cl_ad, W_ad)

## End(Not run)
</code></pre>

<hr>
<h2 id='Clch.Linear'>
Paediatric clearance according to the linear adjustment (LA) for a specific age.
</h2><span id='topic+Clch.Linear'></span>

<h3>Description</h3>

<p>Compute the paediatric clearance according to the linear adjustment (LA) for a specific age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Clch.Linear(age, w, Clad, Wad)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Clch.Linear_+3A_age">age</code></td>
<td>

<p>The age of child.
</p>
</td></tr>
<tr><td><code id="Clch.Linear_+3A_w">w</code></td>
<td>

<p>The weight of child.
</p>
</td></tr>
<tr><td><code id="Clch.Linear_+3A_clad">Clad</code></td>
<td>

<p>The apparent clearance of adult.
</p>
</td></tr>
<tr><td><code id="Clch.Linear_+3A_wad">Wad</code></td>
<td>

<p>Weight of adult (or average weight in the adult population).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a> 
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Clch.Allo">Clch.Allo</a></code>, <code><a href="#topic+Clch.Mat">Clch.Mat</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########

    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    W &lt;- children$Weight
    W_ad &lt;- 70
    Cl_ad &lt;- 3.95

    Clch.Linear(AGE, W, Cl_ad, W_ad)

## End(Not run)
</code></pre>

<hr>
<h2 id='Clch.Mat'>
Paediatric clearance according to the maturation adjustment (MA) for a specific age.
</h2><span id='topic+Clch.Mat'></span>

<h3>Description</h3>

<p>Compute the paediatric clearance according to the maturation adjustment (MA) for a specific age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Clch.Mat(age, w, Clad, Wad, dataMolecule)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Clch.Mat_+3A_age">age</code></td>
<td>

<p>The age of child.
</p>
</td></tr>
<tr><td><code id="Clch.Mat_+3A_w">w</code></td>
<td>

<p>The weight of child.
</p>
</td></tr>
<tr><td><code id="Clch.Mat_+3A_clad">Clad</code></td>
<td>

<p>The apparent clearance of adult.
</p>
</td></tr>
<tr><td><code id="Clch.Mat_+3A_wad">Wad</code></td>
<td>

<p>Weight of adult (or average weight in the adult population).
</p>
</td></tr>
<tr><td><code id="Clch.Mat_+3A_datamolecule">dataMolecule</code></td>
<td>

<p>The database of molecule.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Clch.Allo">Clch.Allo</a></code>, <code><a href="#topic+Clch.Linear">Clch.Linear</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########

    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    W &lt;- children$Weight
    W_ad &lt;- 70
    Cl_ad &lt;- 3.95

    F_ad &lt;- 0.6
    Eg &lt;- 0
    Eh &lt;- 0.058
    f_abs &lt;- F_ad/((1 - Eh)*(1-Eg))
    fu_ad &lt;- 1
    perc_CYPh &lt;- data.frame("CYP3A4_5" = 0.7, "CYP1A2" = 0.3)
    perc_CYPg &lt;- data.frame("CYP3A4_5" = 1)
    perc_alb &lt;- 1
    perc_alpha1AG &lt;- 0 

    data_molecule &lt;- list(F_ad, f_abs, Eg, Eh, fu_ad, perc_CYPg, perc_CYPh, perc_alb, 
                          perc_alpha1AG)

    Clch.Mat(AGE, W, Cl_ad, W_ad, data_molecule)

## End(Not run)
</code></pre>

<hr>
<h2 id='Clchu'>
Clearance of the unbound fraction of a specific molecule for the paediatric population.
</h2><span id='topic+Clchu'></span>

<h3>Description</h3>

<p>Compute the clearance of the unbound fraction of a specific molecule for the paediatric population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Clchu(age, w, Clad, Wad, fabs, fuAd, Fad, Eg, Eh, percCYPh) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Clchu_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_w">w</code></td>
<td>

<p>The weight of child.
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_clad">Clad</code></td>
<td>

<p>The apparent clearance in the adult population.
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_wad">Wad</code></td>
<td>

<p>The weight of adult (or average weight in the adult population).
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_fabs">fabs</code></td>
<td>

<p>Coefficient of absorption for the molecule.
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_fuad">fuAd</code></td>
<td>
 
<p>Unbound bioavailability for adults for the molecule.
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_fad">Fad</code></td>
<td>

<p>Bioavailability for adults.
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_eg">Eg</code></td>
<td>

<p>Coefficient of intestinal extraction.
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_eh">Eh</code></td>
<td>

<p>Coefficient of hepatic extraction.
</p>
</td></tr>
<tr><td><code id="Clchu_+3A_perccyph">percCYPh</code></td>
<td>

<p>Vector giving the percentage of the molecule metabolised for each cytochrome in the liver in adults. Dataframe with two column - column 1: CYP name, column 2: percentage of the molecule metabolised. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Cladu">Cladu</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########

    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    W &lt;- children$Weight
    W_ad &lt;- 70
    Cl_ad &lt;- 3.95
    F_ad &lt;- 0.6
    Eg &lt;- 0
    Eh &lt;- 0.058
    f_abs &lt;- F_ad/((1 - Eh)*(1-Eg))
    fu_ad &lt;- 1
    perc_CYPh &lt;- data.frame("CYP3A4_5" = 0.7, "CYP1A2" = 0.3)

    Clchu(AGE, W, Cl_ad, W_ad, f_abs, fu_ad, F_ad, Eg, Eh, perc_CYPh)

## End(Not run)
</code></pre>

<hr>
<h2 id='concAd'>
Concentration of a specific molecule in plasma for the adult population. 
</h2><span id='topic+concAd'></span>

<h3>Description</h3>

<p>Compute the concentration of a specific molecule in plasma for the adult population according to the percentage binding with albumin and alpha1-acid glycoprotein. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concAd(percAlb, percAlpha1AG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concAd_+3A_percalb">percAlb</code></td>
<td>

<p>Percentage of the molecule binding with albumin.
</p>
</td></tr>
<tr><td><code id="concAd_+3A_percalpha1ag">percAlpha1AG</code></td>
<td>

<p>Percentage of the molecule binding with alpha1-acid glycoprotein. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+concCh">concCh</a></code>  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>perc_alb &lt;- 1
perc_alpha1AG &lt;- 0 
concAd(perc_alb, perc_alpha1AG) 
</code></pre>

<hr>
<h2 id='concCh'>
Concentration of a specific molecule in plasma for the paediatric population. 
</h2><span id='topic+concCh'></span>

<h3>Description</h3>

<p>Compute the concentration of a specific molecule in plasma for the paediatric population according to age, the percentage binding with albumin and alpha1-acid glycoprotein. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concCh(age, percAlb, percAlpha1AG) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concCh_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
<tr><td><code id="concCh_+3A_percalb">percAlb</code></td>
<td>

<p>Percentage of the molecule binding with albumin.
</p>
</td></tr>
<tr><td><code id="concCh_+3A_percalpha1ag">percAlpha1AG</code></td>
<td>

<p>Percentage of the molecule binding with alpha1-acid glycoprotein. 
</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+concAd">concAd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########

    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    perc_alb &lt;- 1
    perc_alpha1AG &lt;- 0
    concCh(AGE, perc_alb, perc_alpha1AG)

## End(Not run)
</code></pre>

<hr>
<h2 id='doseChoice'>
Choice of the next given dose level.
</h2><span id='topic+doseChoice'></span>

<h3>Description</h3>

<p>Algorithm giving the next dose which is the safe most successful dose (sMSD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doseChoice(probaTox, probaEff, p, targetTox, givenDose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doseChoice_+3A_probatox">probaTox</code></td>
<td>
 
<p>The probability of toxicity estimated with STAN model. 
</p>
</td></tr>
<tr><td><code id="doseChoice_+3A_probaeff">probaEff</code></td>
<td>

<p>The probability of efficacy estimated with STAN model.    
</p>
</td></tr> 
<tr><td><code id="doseChoice_+3A_p">p</code></td>
<td>

<p>The probability of success.      
</p>
</td></tr>
<tr><td><code id="doseChoice_+3A_targettox">targetTox</code></td>
<td>

<p>The target of toxicity.         
</p>
</td></tr>
<tr><td><code id="doseChoice_+3A_givendose">givenDose</code></td>
<td>
 
<p>The vector of doses given to patients so far.
</p>
</td></tr>   
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>      
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r &lt;- 0.10
q &lt;- 0.17
p &lt;- 0.9
targetTox &lt;- 0.6 
givenDose &lt;- 2
newDose &lt;- doseChoice(r, q, p, targetTox, givenDose)   
newDose
</code></pre>

<hr>
<h2 id='doseRange'>
Dose-range for the paediatric population according to adult clearance, adult doses and paediatric clearance.
</h2><span id='topic+doseRange'></span>

<h3>Description</h3>

<p>This function gives the dose-range for paediatrics, given the adult apparent clearance, the paediatric apparent clearance (known or estimated) and the adult doses. The paediatric apparent clearance can be estimated using the maturation adjustment (through the function <code><a href="#topic+Clch.Mat">Clch.Mat</a></code>), allometric adjustment (through the function <code><a href="#topic+Clch.Allo">Clch.Allo</a></code>) or linear adjustment (through the function <code><a href="#topic+Clch.Linear">Clch.Linear</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doseRange(Clch, Clad, doseAd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doseRange_+3A_clch">Clch</code></td>
<td>

<p>The paediatric apparent clearance which can be calculated using the maturation (<code><a href="#topic+Clch.Mat">Clch.Mat</a></code>) or allocation (<code><a href="#topic+Clch.Allo">Clch.Allo</a></code>) or 
linear adjustment (<code><a href="#topic+Clch.Linear">Clch.Linear</a></code>) functions for a specific age.
</p>
</td></tr>
<tr><td><code id="doseRange_+3A_clad">Clad</code></td>
<td>

<p>The clearance of adult.
</p>
</td></tr>
<tr><td><code id="doseRange_+3A_dosead">doseAd</code></td>
<td>

<p>The dose which is given to adult. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+skeleton">skeleton</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########


    # Doses of adults
    doseAd &lt;- data.frame("d1" = 100, "d2" = 150,"d3" = 200,"d4"= 250,"d5" =300)
    
    Cl_ad &lt;- 3.95
    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    W &lt;- children$Weight
    W_ad &lt;- 70
    Cl_ad &lt;- 3.95
    F_ad &lt;- 0.6
    Eg &lt;- 0
    Eh &lt;- 0.058
    f_abs &lt;- F_ad/((1 - Eh)*(1-Eg))
    fu_ad &lt;- 1
    perc_CYPh &lt;- data.frame("CYP3A4_5" = 0.7, "CYP1A2" = 0.3)
    perc_CYPg &lt;- data.frame("CYP3A4_5" = 1)
    perc_alb &lt;- 1
    perc_alpha1AG &lt;- 0 

    data_molecule &lt;- list(F_ad, f_abs, Eg, Eh, fu_ad, perc_CYPg, perc_CYPh, perc_alb, 
                          perc_alpha1AG)

    # Compute the clearance of children using maturation adjustment via 
    # the function Clch.Mat().
    Clch_mat &lt;- Clch.Mat(AGE, W, Cl_ad, W_ad, data_molecule)
    
    doseRange(Clch_mat, Cl_ad, doseAd)

## End(Not run)
</code></pre>

<hr>
<h2 id='Fch'>
Paediatric bioavailability according to age.
</h2><span id='topic+Fch'></span>

<h3>Description</h3>

<p>Bioavailability of a child according to his/her age. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fch(age, fabs, Eg, Eh, percCYPg, percCYPh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fch_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
<tr><td><code id="Fch_+3A_fabs">fabs</code></td>
<td>

<p>Coefficient of the absorption.
</p>
</td></tr>
<tr><td><code id="Fch_+3A_eg">Eg</code></td>
<td>

<p>Coefficient of intestinal extraction.
</p>
</td></tr>
<tr><td><code id="Fch_+3A_eh">Eh</code></td>
<td>

<p>Coefficient of hepatic extraction.
</p>
</td></tr>
<tr><td><code id="Fch_+3A_perccypg">percCYPg</code></td>
<td>

<p>Vector giving the percentage of the molecule metabolised for each cytochrome in the guts in adults. Dataframe with two column - column 1: CYP name, column 2: percentage of the molecule metabolised.
</p>
</td></tr>
<tr><td><code id="Fch_+3A_perccyph">percCYPh</code></td>
<td>

<p>Vector giving the percentage of the molecule metabolised for each cytochrome in the liver in adults. Dataframe with two column - column 1: CYP name, column 2: percentage of the molecule metabolised.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Clch.Mat">Clch.Mat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########

    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    F_ad &lt;- 0.6
    Eg &lt;- 0
    Eh &lt;- 0.058
    f_abs &lt;- F_ad/((1 - Eh)*(1-Eg))
    perc_CYPg &lt;- data.frame("CYP3A4_5" = 1)
    perc_CYPh &lt;- data.frame("CYP3A4_5" = 0.7, "CYP1A2" = 0.3)
    Fch(AGE, f_abs, Eg, Eh, perc_CYPg, perc_CYPh)

## End(Not run)
</code></pre>

<hr>
<h2 id='fuCh'>
Unbound fraction of the molecule in the plasma for children.
</h2><span id='topic+fuCh'></span>

<h3>Description</h3>

<p>Unbound fraction of the molecule in the plasma for children.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fuCh(age, fuAd, percAlb, percAlpha1AG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fuCh_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
<tr><td><code id="fuCh_+3A_fuad">fuAd</code></td>
<td>

<p>Unbound fraction of the molecule in adults.
</p>
</td></tr>
<tr><td><code id="fuCh_+3A_percalb">percAlb</code></td>
<td>

<p>Percentage of the molecule binding with albumin.
</p>
</td></tr>
<tr><td><code id="fuCh_+3A_percalpha1ag">percAlpha1AG</code></td>
<td>

<p>Percentage of the molecule binding with alpha1-acid glycoprotein. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Clch.Mat">Clch.Mat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########

    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    fu_ad &lt;- 1
    perc_alb &lt;- 1
    perc_alpha1AG &lt;- 0 

    fuCh(AGE, fu_ad, perc_alb, perc_alpha1AG)

## End(Not run)
</code></pre>

<hr>
<h2 id='KCYP1A2'>
Fraction of adult CYP1A2 abundance according to age.
</h2><span id='topic+KCYP1A2'></span>

<h3>Description</h3>

<p>Compute the value of the fraction of adult CYP1A2 abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP1A2(age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP1A2_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP2B6">KCYP2B6</a></code>, <code><a href="#topic+KCYP2C8">KCYP2C8</a></code>, <code><a href="#topic+KCYP2C9">KCYP2C9</a></code>, <code><a href="#topic+KCYP2C18_19">KCYP2C18_19</a></code>, <code><a href="#topic+KCYP2D6">KCYP2D6</a></code>, <code><a href="#topic+KCYP2E1">KCYP2E1</a></code>, <code><a href="#topic+KCYP3A4_5">KCYP3A4_5</a></code>, <code><a href="#topic+KCYP3A">KCYP3A</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 1
KCYP1A2(age) 
</code></pre>

<hr>
<h2 id='KCYP2B6'>
Fraction of adult CYP2B6 abundance according to age.
</h2><span id='topic+KCYP2B6'></span>

<h3>Description</h3>

<p>Compute the value of the fraction of adult CYP2B6 abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP2B6(age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP2B6_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP1A2">KCYP1A2</a></code>, <code><a href="#topic+KCYP2C8">KCYP2C8</a></code>, <code><a href="#topic+KCYP2C9">KCYP2C9</a></code>, <code><a href="#topic+KCYP2C18_19">KCYP2C18_19</a></code>, <code><a href="#topic+KCYP2D6">KCYP2D6</a></code>, <code><a href="#topic+KCYP2E1">KCYP2E1</a></code>, 
<code><a href="#topic+KCYP3A4_5">KCYP3A4_5</a></code>, <code><a href="#topic+KCYP3A">KCYP3A</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 4
KCYP2B6(age) 
</code></pre>

<hr>
<h2 id='KCYP2C18_19'>
Fraction of adult CYP2C18/CYP2C19 abundance according to age.
</h2><span id='topic+KCYP2C18_19'></span>

<h3>Description</h3>

<p>Compute the value of the fraction of adult CYP2C18/CYP2C19 abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP2C18_19(age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP2C18_19_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP1A2">KCYP1A2</a></code>, <code><a href="#topic+KCYP2B6">KCYP2B6</a></code>, <code><a href="#topic+KCYP2C8">KCYP2C8</a></code>, <code><a href="#topic+KCYP2C9">KCYP2C9</a></code>, <code><a href="#topic+KCYP2D6">KCYP2D6</a></code>, <code><a href="#topic+KCYP2E1">KCYP2E1</a></code>, 
<code><a href="#topic+KCYP3A4_5">KCYP3A4_5</a></code>, <code><a href="#topic+KCYP3A">KCYP3A</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 18
KCYP2C18_19(age)
</code></pre>

<hr>
<h2 id='KCYP2C8'>
Fraction of adult CYP2C8 abundance according to age.
</h2><span id='topic+KCYP2C8'></span>

<h3>Description</h3>

<p>Compute the value of the fraction of adult CYP2C8 abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP2C8(age) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP2C8_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP1A2">KCYP1A2</a></code>, <code><a href="#topic+KCYP2B6">KCYP2B6</a></code>, <code><a href="#topic+KCYP2C9">KCYP2C9</a></code>, <code><a href="#topic+KCYP2C18_19">KCYP2C18_19</a></code>, <code><a href="#topic+KCYP2D6">KCYP2D6</a></code>, <code><a href="#topic+KCYP2E1">KCYP2E1</a></code>, 
<code><a href="#topic+KCYP3A4_5">KCYP3A4_5</a></code>, <code><a href="#topic+KCYP3A">KCYP3A</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 2
KCYP2C8(age)
</code></pre>

<hr>
<h2 id='KCYP2C9'>
Fraction of adult CYP2C9 abundance according to age.
</h2><span id='topic+KCYP2C9'></span>

<h3>Description</h3>

<p>Compute the value of the fraction of adult CYP2C9 abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP2C9(age) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP2C9_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP1A2">KCYP1A2</a></code>, <code><a href="#topic+KCYP2B6">KCYP2B6</a></code>, <code><a href="#topic+KCYP2C8">KCYP2C8</a></code>, <code><a href="#topic+KCYP2C18_19">KCYP2C18_19</a></code>, <code><a href="#topic+KCYP2D6">KCYP2D6</a></code>, <code><a href="#topic+KCYP2E1">KCYP2E1</a></code>, 
<code><a href="#topic+KCYP3A4_5">KCYP3A4_5</a></code>, <code><a href="#topic+KCYP3A">KCYP3A</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 3
KCYP2C9(age)
</code></pre>

<hr>
<h2 id='KCYP2D6'>
Fraction of adult CYP2D6 abundance according to age.
</h2><span id='topic+KCYP2D6'></span>

<h3>Description</h3>

<p>Compute the value of the fraction of adult CYP2D6 abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP2D6(age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP2D6_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP1A2">KCYP1A2</a></code>, <code><a href="#topic+KCYP2B6">KCYP2B6</a></code>, <code><a href="#topic+KCYP2C8">KCYP2C8</a></code>, <code><a href="#topic+KCYP2C9">KCYP2C9</a></code>, <code><a href="#topic+KCYP2C18_19">KCYP2C18_19</a></code>, <code><a href="#topic+KCYP2E1">KCYP2E1</a></code>, 
<code><a href="#topic+KCYP3A4_5">KCYP3A4_5</a></code>, <code><a href="#topic+KCYP3A">KCYP3A</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 2
KCYP2D6(age)
</code></pre>

<hr>
<h2 id='KCYP2E1'>
Fraction of adult CYP2E1 abundance according to age.
</h2><span id='topic+KCYP2E1'></span>

<h3>Description</h3>

<p>Compute value of the fraction of adult CYP2E1 abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP2E1(age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP2E1_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP1A2">KCYP1A2</a></code>, <code><a href="#topic+KCYP2B6">KCYP2B6</a></code>, <code><a href="#topic+KCYP2C8">KCYP2C8</a></code>, <code><a href="#topic+KCYP2C9">KCYP2C9</a></code>, <code><a href="#topic+KCYP2C18_19">KCYP2C18_19</a></code>, <code><a href="#topic+KCYP2D6">KCYP2D6</a></code>, 
<code><a href="#topic+KCYP3A4_5">KCYP3A4_5</a></code>, <code><a href="#topic+KCYP3A">KCYP3A</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 2
KCYP2E1(age)
</code></pre>

<hr>
<h2 id='KCYP3A'>
Fraction of adult CYP3A abundance according to age.
</h2><span id='topic+KCYP3A'></span>

<h3>Description</h3>

<p>Compute the value of the fraction of adult CYP3A abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP3A(age) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP3A_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP1A2">KCYP1A2</a></code>, <code><a href="#topic+KCYP2B6">KCYP2B6</a></code>, <code><a href="#topic+KCYP2C8">KCYP2C8</a></code>, <code><a href="#topic+KCYP2C9">KCYP2C9</a></code>, <code><a href="#topic+KCYP2C18_19">KCYP2C18_19</a></code>, <code><a href="#topic+KCYP2D6">KCYP2D6</a></code>, 
<code><a href="#topic+KCYP3A4_5">KCYP3A4_5</a></code>, <code><a href="#topic+KCYP2E1">KCYP2E1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 2
KCYP3A(age)
</code></pre>

<hr>
<h2 id='KCYP3A4_5'> 
Fraction of adult CYP3A4/CYP3A5 abundance according to age.
</h2><span id='topic+KCYP3A4_5'></span>

<h3>Description</h3>

<p>Compute the value of the fraction of adult CYP3A4/CYP3A5 abundance according to the children age. It is described by a hyperbolic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KCYP3A4_5(age) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KCYP3A4_5_+3A_age">age</code></td>
<td>

<p>The age of children.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Johnson T., Rostami-Hodjegan A. and Tucker G. (2006) Prediction of clearance of eleven drugs and associated variability in neonates, infants and children, Clin. Pharmacokinet., 45:931-956.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KCYP1A2">KCYP1A2</a></code>, <code><a href="#topic+KCYP2B6">KCYP2B6</a></code>, <code><a href="#topic+KCYP2C8">KCYP2C8</a></code>, <code><a href="#topic+KCYP2C9">KCYP2C9</a></code>, <code><a href="#topic+KCYP2C18_19">KCYP2C18_19</a></code>, <code><a href="#topic+KCYP2D6">KCYP2D6</a></code>, 
<code><a href="#topic+KCYP3A">KCYP3A</a></code>, <code><a href="#topic+KCYP2E1">KCYP2E1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 1
KCYP3A4_5(age)
</code></pre>

<hr>
<h2 id='kickoffControl'>
Control for presence of at least toxicities and efficacies for the good run of bCRM model.
</h2><span id='topic+kickoffControl'></span>

<h3>Description</h3>

<p>An algorithm that control if we have at least one 0 and one 1 for both efficacy and toxicity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kickoffControl(tox, currentDose, cohortSize, nbDoses)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kickoffControl_+3A_tox">tox</code></td>
<td>

<p>The vector of toxicity outcomes.  
</p>
</td></tr>
<tr><td><code id="kickoffControl_+3A_currentdose">currentDose</code></td>
<td>

<p>The current dose of a patient. 
</p>
</td></tr>
<tr><td><code id="kickoffControl_+3A_cohortsize">cohortSize</code></td>
<td>

<p>The size of the cohort; must be integer. 
</p>
</td></tr>
<tr><td><code id="kickoffControl_+3A_nbdoses">nbDoses</code></td>
<td>

<p>The maximum number of the doses. 
</p>
</td></tr>    
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>,
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric
studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
	tox &lt;- c(0.1301477, 0.2774171, 0.4184642, 0.6486846, 0.8257219)
	currentDose &lt;- 3
	cohortSize &lt;- 1
	nbDoses &lt;- 5 
	kickoffControl(tox, currentDose, cohortSize, nbDoses)

## End(Not run)
</code></pre>

<hr>
<h2 id='metaPhase'>
Meta-analysis function of dose-finding studies proposed by Zohar et al, (2011).
</h2><span id='topic+metaPhase'></span>

<h3>Description</h3>

 
<p>A function of meta-analysis for dose-finding studies in clinical trials proposed by Zohar et al, (2011). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metaPhase(dataTox, doses, nbSimu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metaPhase_+3A_datatox">dataTox</code></td>
<td>

<p>A database of the toxicity outcomes for each patient; must be a dataframe.
</p>
</td></tr>
<tr><td><code id="metaPhase_+3A_doses">doses</code></td>
<td>

<p>The drug's dose levels.
</p>
</td></tr>
<tr><td><code id="metaPhase_+3A_nbsimu">nbSimu</code></td>
<td>

<p>The number of simulations.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>,
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a> 
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Zohar, S., et al, (2011) An approach to meta-analysis of dose-finding studies, Statistics in Medicine. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+skeleton">skeleton</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    pardos_2006 &lt;- rbind(c(100,0/3, 3), c(150, 1/3,3), c(200, 0/3, 3), c(250, 3/6, 6))
    thepot_2014 &lt;- rbind(c(100, 0/5, 5), c(150,3/25, 25))
    calvo_2007 &lt;- rbind(c(150, 1/25, 25))
    raizer_2010 &lt;- rbind(c(150,11/99, 99))
    vanDenBent_2009 &lt;- rbind( c(200, 6/54, 54))
    sheikh_2012 &lt;- rbind(c(150, 0.544, 307)) 
    rocheNTC00531934 &lt;- rbind(c(150, 0.186, 59)) 
    dataTox &lt;- rbind(pardos_2006, thepot_2014, calvo_2007, raizer_2010, vanDenBent_2009, 
                   rocheNTC00531934, sheikh_2012)
    dataTox &lt;- data.frame(dataTox)
    colnames(dataTox) &lt;- c("doses", "proba", "nbPatients")
    nbTox &lt;- dataTox$proba*dataTox$nbPatients
    dataTox &lt;- data.frame(dataTox, nbTox)
    doses &lt;- c(100,150,200, 250)
    nbSimu &lt;- 10

    metaPhase(dataTox, doses, nbSimu)

## End(Not run)
</code></pre>

<hr>
<h2 id='priorChoice'>
Decision function for the choice of variance (sigmaHI or sigmaLI) in the adaptive prior variance calibration.
</h2><span id='topic+priorChoice'></span>

<h3>Description</h3>

<p>Algorithm of the decision function for the choice of variance (sigmaHI or sigmaLI) in the adaptive prior variance calibration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>priorChoice(tox, givenDose, skeletonTox, lesb) 
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="priorChoice_+3A_tox">tox</code></td>
<td>
 
<p>The vector of toxicity.
</p>
</td></tr>
<tr><td><code id="priorChoice_+3A_givendose">givenDose</code></td>
<td>

<p>The vector of doses given to patients so far.
</p>
</td></tr>
<tr><td><code id="priorChoice_+3A_skeletontox">skeletonTox</code></td>
<td>

<p>Skeleton of toxicity for the BMA bivariate CRM or the bivariate CRM model.
</p>
</td></tr>
<tr><td><code id="priorChoice_+3A_lesb">lesb</code></td>
<td>

<p>A vector containing the parameters b; (resp. 0 &lt;- b1 &lt; ... &lt; bk &lt; 1).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>,
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Zhang J., Braun T., and J. Taylor. (2013) Adaptive prior variance calibration in the bayesian continual reassessment method. Stat. Med. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+doseChoice">doseChoice</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tox &lt;-  c(0.10, 0.21, 0.33, 0.55, 0.76)
givenDose &lt;- 2

skeleton_tox1 &lt;- c(0.10, 0.21, 0.33, 0.55, 0.76)
skeleton_tox2 &lt;- c(0.21, 0.33, 0.55, 0.76, 0.88)
skeleton_tox3 &lt;- c(0.05, 0.10, 0.21, 0.33, 0.55)
skeleton_tox4 &lt;- c(0.025, 0.05,0.1, 0.21, 0.33)
skeleton_tox5 &lt;- c(0.0125, 0.025, 0.05,0.1, 0.21)

skeletonTox &lt;-  data.frame(skeleton_tox1, skeleton_tox2, skeleton_tox3, 
                           skeleton_tox4, skeleton_tox5)

lesb &lt;- c(0.10, 0.16, 0.23, 0.25, 0.30)
priorChoice(tox, givenDose, skeletonTox, lesb)
</code></pre>

<hr>
<h2 id='sigmaEss'>
The variance of the effective sample size (ESS).
</h2><span id='topic+sigmaEss'></span>

<h3>Description</h3>

<p>Let <code class="reqn">\pi_{ESS}(\alpha)</code> be the prior normal distribution <code class="reqn">\mathcal{N} (\mu_\alpha, \sigma^{2}_{\alpha,ESS})</code>.
The variance <code class="reqn">\sigma^{2}_{\alpha,ESS}</code> was fixed such that the information introduced by the prior would be equivalent to the information introduced by a
fixed number of patients, which was calibrated to control the amount of information. This approach is based on the effective sample size (ESS): the higher the ESS, the more informative the prior. For an ESS <code class="reqn">m^{*}</code>, parameters <code class="reqn">(\mu_\alpha, \sigma^{2}_{\alpha,ESS})</code> were chosen such that </p>
<p style="text-align: center;"><code class="reqn">min_{m} \delta(m, \mu_\alpha, \sigma^{2}_{\alpha,ESS})) = m^{*}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>sigmaEss(mStar, sigma, Mmin, Mmax, meana, c, wm, Tmc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaEss_+3A_mstar">mStar</code></td>
<td>

<p>The number of patients anticipated for the trial.
</p>
</td></tr>
<tr><td><code id="sigmaEss_+3A_sigma">sigma</code></td>
<td>

<p>The vector of sigma.
</p>
</td></tr>
<tr><td><code id="sigmaEss_+3A_mmin">Mmin</code></td>
<td>

<p>The minimum number of patients for which the effective sample size (ESS) is computed.
</p>
</td></tr>
<tr><td><code id="sigmaEss_+3A_mmax">Mmax</code></td>
<td>

<p>The maximum number of patients for which the effective sample size (ESS) is computed.
</p>
</td></tr>
<tr><td><code id="sigmaEss_+3A_meana">meana</code></td>
<td>

<p>Mean value of the prior distribution (known or chosen).
</p>
</td></tr>
<tr><td><code id="sigmaEss_+3A_c">c</code></td>
<td>

<p>The maximum number of iteration for the algorithm to compute the ESS. See references for more details.
</p>
</td></tr>
<tr><td><code id="sigmaEss_+3A_wm">wm</code></td>
<td>

<p>The working model.
</p>
</td></tr>
<tr><td><code id="sigmaEss_+3A_tmc">Tmc</code></td>
<td>

<p>The number of draw in the normal distribution in the ESS algorithm. See references for more details.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>,
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a> 
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Morita S., Thall P.F., and Muller P. (2008) Determining the effective sample size of a parametric prior. Biometrics.
</p>
<p>Morita S. (2011) Application of the continual reassessment method to a phase I dose-finding trial in japanese patients: East meets west. Stat. Med.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    wm_mat &lt;- c(0.10, 0.21, 0.33, 0.55, 0.76 )
    wm_allo &lt;- c(0.13, 0.27, 0.48, 0.70, 0.88)
    wm_linear &lt;- c(0.07, 0.13, 0.21, 0.33, 0.55)
    c &lt;- 10000
    meana &lt;- 0.88
    Tmc &lt;- 100000
    Mmax &lt;- 30
    Mmin &lt;- 1
    sigma_vect &lt;- seq(0.1, 2, by = 0.01)
    mStar &lt;- 30
    sigmaEss(mStar, sigma_vect, Mmin, Mmax, meana, c, wm_mat, Tmc)

## End(Not run)
</code></pre>

<hr>
<h2 id='sigmaHI'>
Compute the informative prior variance for the adaptive prior.  
</h2><span id='topic+sigmaHI'></span>

<h3>Description</h3>

<p>Compute the informative prior variance for the adaptive prior based on the assumption that every dose has the same probability to be the maximum tolerated dose (MTD), i.e. uniform distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmaHI(wm, meanbeta, a = NULL, model, tau, threshold) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaHI_+3A_wm">wm</code></td>
<td>
  
<p>The selected working model; for example the skeleton of toxicity; must be a vector. 
</p>
</td></tr> 
<tr><td><code id="sigmaHI_+3A_meanbeta">meanbeta</code></td>
<td>
 
<p>The mean value of variable beta. 
</p>
</td></tr> 
<tr><td><code id="sigmaHI_+3A_a">a</code></td>
<td>

<p>The variable a; the default value is NULL.
</p>
</td></tr> 
<tr><td><code id="sigmaHI_+3A_model">model</code></td>
<td>

<p>A valid model; for example &quot;power_log&quot; model.    
</p>
</td></tr> 
<tr><td><code id="sigmaHI_+3A_tau">tau</code></td>
<td>

<p>The target of toxicity. 
</p>
</td></tr>
<tr><td><code id="sigmaHI_+3A_threshold">threshold</code></td>
<td>

<p>A threshold of the model. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>,
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Zhang J., Braun T., and J. Taylor. Adaptive prior variance calibration in the bayesian continual reassessment method. Stat. Med., 32:2221-34, 2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sigmaLI">sigmaLI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>targetTox &lt;- 0.25             # target of toxicity  

####### Skeleton ########### 

skeleton_tox1 &lt;- c(0.10, 0.21, 0.33, 0.55, 0.76)
skeleton_tox2 &lt;- c(0.21, 0.33, 0.55, 0.76, 0.88)
skeleton_tox3 &lt;- c(0.05, 0.10, 0.21, 0.33, 0.55)
skeleton_tox4 &lt;- c(0.025, 0.05, 0.1, 0.21, 0.33)
skeleton_tox5 &lt;- c(0.0125, 0.025, 0.05, 0.1, 0.21)
skeletonTox &lt;-  data.frame(skeleton_tox1, skeleton_tox2, skeleton_tox3, 
                    skeleton_tox4, skeleton_tox5)
mu &lt;- -0.34 
sigmaHI &lt;- sigmaHI(skeletonTox[ ,1], mu, a = NULL, "power_log", targetTox, 0.80)
</code></pre>

<hr>
<h2 id='sigmaLI'> 
Compute the least informative prior variance for the adaptive prior. 
</h2><span id='topic+sigmaLI'></span>

<h3>Description</h3>

<p>Compute the least informative prior variance for the adaptive prior based on the assumption that every dose has the same probability to be the maximum tolerated dose (MTD), i.e. uniform distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmaLI(wm, meanbeta, a = NULL, model, tau)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmaLI_+3A_wm">wm</code></td>
<td>

<p>The selected working model; for example the skeleton of toxicity; must be a vector.
</p>
</td></tr>
<tr><td><code id="sigmaLI_+3A_meanbeta">meanbeta</code></td>
<td>

<p>The mean value of variable beta. 
</p>
</td></tr>
<tr><td><code id="sigmaLI_+3A_a">a</code></td>
<td>

<p>The variable a; defaults to NULL.
</p>
</td></tr>
<tr><td><code id="sigmaLI_+3A_model">model</code></td>
<td>

<p>A valid model; for example the &quot;power_log&quot; model. 
</p>
</td></tr>
<tr><td><code id="sigmaLI_+3A_tau">tau</code></td>
<td>

<p>The target of toxicity.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Zhang J., Braun T., and J. Taylor. Adaptive prior variance calibration in the bayesian continual reassessment method. Stat. Med., 32:2221-34, 2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sigmaHI">sigmaHI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>targetTox &lt;- 0.25             # target of toxicity  

####### Skeleton ########### 

skeleton_tox1 &lt;- c(0.10, 0.21, 0.33, 0.55, 0.76)
skeleton_tox2 &lt;- c(0.21, 0.33, 0.55, 0.76, 0.88)
skeleton_tox3 &lt;- c(0.05, 0.10, 0.21, 0.33, 0.55)
skeleton_tox4 &lt;- c(0.025, 0.05, 0.1, 0.21, 0.33)
skeleton_tox5 &lt;- c(0.0125, 0.025, 0.05, 0.1, 0.21)
skeletonTox &lt;-  data.frame(skeleton_tox1, skeleton_tox2, skeleton_tox3, 
                    skeleton_tox4, skeleton_tox5)
mu &lt;- -0.34 
sigmaLI &lt;- sigmaLI(skeletonTox[ ,1], mu, a = NULL, "power_log", targetTox)
</code></pre>

<hr>
<h2 id='simu'>
A simulation of a single dose-finding trials in paediatrics.
</h2><span id='topic+simu'></span><span id='topic+crmAtj'></span>

<h3>Description</h3>

<p>Simulate a single dose-finding clinical trial with the given scenarios of toxicity and efficacy. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    simu(targetTox, targetEff, skeletonTox, skeletonEff, startingDose, 
        nbSubjects, crmModel, cohortSize, scenarioTox, scenarioEff, 
        nbDesign, mu, sd = NULL, lesb, sigmaLI, sigmaHI, adaptivePrior) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simu_+3A_targettox">targetTox</code></td>
<td>

<p>Target/threshold of toxicity; must be a integer/double.   
</p>
</td></tr>
<tr><td><code id="simu_+3A_targeteff">targetEff</code></td>
<td>

<p>Target/threshold of efficacy; must be a integer/double.   
</p>
</td></tr>
<tr><td><code id="simu_+3A_skeletontox">skeletonTox</code></td>
<td>

<p>Skeleton of toxicity for the BMA bivariate CRM, or the bivariate CRM. Must be a dataframe with the number of row corresponding to the number of doses and the number of columns corresponding to the number of working models for toxicity.  
</p>
</td></tr>  
<tr><td><code id="simu_+3A_skeletoneff">skeletonEff</code></td>
<td>

<p>Skeleton of efficacy for the BMA bivariate CRM, or the bivariate CRM. Must be a dataframe with the number of row corresponding to the number of doses and the number of columns corresponding to the number of working models for efficacy.
</p>
</td></tr>
<tr><td><code id="simu_+3A_startingdose">startingDose</code></td>
<td>
 
<p>First dose to be assigned; must be an integer.    
</p>
</td></tr>
<tr><td><code id="simu_+3A_nbsubjects">nbSubjects</code></td>
<td>

<p>Maximum number of allocated patients; must be an integer.
</p>
</td></tr>
<tr><td><code id="simu_+3A_crmmodel">crmModel</code></td>
<td>

<p>A model for STAN in C++.    
</p>
</td></tr> 
<tr><td><code id="simu_+3A_cohortsize">cohortSize</code></td>
<td>
 
<p>The size of the cohorts for the 3+3 based algorithm before kickoff of the CRM; must be an integer.   
</p>
</td></tr>  
<tr><td><code id="simu_+3A_scenariotox">scenarioTox</code></td>
<td>

<p>Toxicity scenario for the simulations with the probability of toxicity for each dose; must be a vector of length the number of doses.   
</p>
</td></tr>
<tr><td><code id="simu_+3A_scenarioeff">scenarioEff</code></td>
<td>

<p>Efficacy scenario for the simulations; must be a vector of length the number of doses. 
</p>
</td></tr> 
<tr><td><code id="simu_+3A_nbdesign">nbDesign</code></td>
<td>

<p>The number of different designs for the model selection using the Watanabe-Akaike information criteria (WAIC); must be an integer.
</p>
</td></tr>
<tr><td><code id="simu_+3A_mu">mu</code></td>
<td>

<p>The mean value which the model is using.
</p>
</td></tr> 
<tr><td><code id="simu_+3A_sd">sd</code></td>
<td>
 
<p>The standard deviation.
</p>
</td></tr>
<tr><td><code id="simu_+3A_lesb">lesb</code></td>
<td>
 
<p>A vector consisting of the variables b.  
</p>
</td></tr> 
<tr><td><code id="simu_+3A_sigmali">sigmaLI</code></td>
<td>

<p>The standard deviation when the model using non-informative prior.
</p>
</td></tr>
<tr><td><code id="simu_+3A_sigmahi">sigmaHI</code></td>
<td>

<p>The standard deviation when the model using informative prior.  
</p>
</td></tr>
<tr><td><code id="simu_+3A_adaptiveprior">adaptivePrior</code></td>
<td>

<p>TRUE if you want to use as a prior an adaptive prior; FALSE otherwise.   
</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>, 
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simulation">simulation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## Not run:  
    library(rstan)
    adaptivePrior &lt;- TRUE

    ####### Targets  ###########

    targetTox &lt;- 0.25   # target of toxicity
    targetEff &lt;- 0.20   # target of efficacy 

    ####### Skeleton ###########

    skeleton_tox1 &lt;- c(0.10, 0.21, 0.33, 0.55, 0.76) 
    skeleton_tox2 &lt;- c(0.21, 0.33, 0.55, 0.76, 0.88) 
    skeleton_tox3 &lt;- c(0.05, 0.10, 0.21, 0.33, 0.55) 
    skeleton_tox4 &lt;- c(0.025, 0.05,0.1, 0.21, 0.33) 
    skeleton_tox5 &lt;- c(0.0125, 0.025, 0.05,0.1, 0.21) 

    skeleton_eff &lt;- c(0.04937516, 0.20496890, 0.43388003, 0.64409781, 0.79313693) 
    skeleton_tox &lt;-  data.frame(skeleton_tox1, skeleton_tox2, skeleton_tox3,
                        skeleton_tox4, skeleton_tox5)
    skeleton_eff &lt;-  data.frame(skeleton_eff, skeleton_eff, skeleton_eff,
                        skeleton_eff, skeleton_eff)  

    ############# Priors ############
    priorModel  &lt;- list(rep(1/5,5), 0.001)
    sd &lt;- 0.65  
    mu &lt;- -0.34   

    ####### Trial settings  #############

    startingDose &lt;- 1 
    nbSubjects &lt;- 15   
    cohortSize &lt;- 3       

    nbDesign &lt;- length(skeleton_tox[1,])  
    nbDoses &lt;- length(scenario_tox)       

    lesb &lt;- calcul.bi(skeleton_tox[,1], mu, a = NULL, "power_log", targetTox) 
    sigmaLI &lt;- sigmaLI(skeleton_tox[,1],  mu, a = NULL, "power_log", targetTox)
    sigmaHI &lt;- sigmaHI(skeleton_tox[,1],  mu, a = NULL, "power_log", targetTox, 0.80)

    ################## Scenarios ##############

    scenario_tox &lt;- c(0.1301477, 0.2774171, 0.4184642, 0.6486846, 0.8257219)  
    scenario_eff &lt;- c(0.07945205, 0.20000000, 0.33686856, 0.59537737, 0.80996173)  

    stancode &lt;- 'data {
        int &lt;lower = 0&gt; J; //nb of patients
        int &lt;lower = 0&gt; K; // nb of doses and dose reference
        real r[K]; // skeleton for tox - K doses
        real q[K]; // skeleton for efficacy - K doses
        int y[J]; // toxicity of patient j
        int v[J]; // efficacy of patient j
        int d[J]; // dose received by patient j
        real moy; // mean for the normal prior of toxicity
        real standardError; //standard error of the normal prior of toxicity
    }
    parameters {
        real &lt;lower = 0&gt; alpha;
        real  &lt;lower = 0&gt; beta;
    }
    transformed parameters{
        real &lt;lower = 0, upper = 1&gt; varphi[K]; // marginal probability of toxicity for dose k
        real &lt;lower = 0, upper = 1&gt; psi[K]; // marginal probability of efficacy for dose k
        // defining the marginal probabilities for each value of a and b for each dose
        real p01[K]; // tox = 0, eff = 1
        real p10[K]; // tox = 1, eff = 0
        real p11[K]; // tox = 1, eff = 1
        real p00[K]; // tox = 0, eff = 0

        vector[J] logLike;

        for (k in 1:K){
            varphi[k] = exp(alpha*log(r[k]));
            psi[k] = exp(beta*log(q[k]));
        }
        
        
        // computing the marginal probabilities for each dose
            for (k in 1:K){
                p01[k] = (1-varphi[k])*psi[k]; 
                p10[k] = varphi[k]*(1-psi[k]);
                p00[k] = (1-varphi[k])*(1-psi[k]);
                p11[k] = varphi[k]*psi[k];
            }
        // Computing the log-likelihood
            for (j in 1:J){
                logLike[j] = y[j]*v[j]*log(p11[d[j]]) + y[j]*(1-v[j])*log(p10[d[j]]) 
                + (1-y[j])*v[j]*log(p01[d[j]]) + (1-y[j])*(1-v[j])*log(p00[d[j]]);
            }
        
    }
    model {
        // priors
        alpha ~lognormal(moy, standardError);
        beta ~ lognormal(0,sqrt(1.34));              
        increment_log_prob(sum(logLike));
    }'
    
    crm_model &lt;- stan_model(model_code = stancode) 

    ################## Simulation ##############

    simu(targetTox, targetEff, skeleton_tox, skeleton_eff,
        startingDose, nbSubjects, crm_model, cohortSize, scenario_tox,
        scenario_eff, nbDesign, mu, sd = sd, lesb,
        sigmaLI, sigmaHI, adaptivePrior)

## End(Not run)
</code></pre>

<hr>
<h2 id='simulation'>
Simulate one or &quot;n&quot; dose-finding trials in paediatrics.
</h2><span id='topic+simulation'></span><span id='topic+saveSimu'></span>

<h3>Description</h3>

<p>It starts the process of simulations for a required number of simulated trials and return NULL. A dataframe is saved in the url named as &quot;save_name&quot; with the number of rows equals to the number of simulations lines and 26 columns containing the different estimates, the selected dose of each trial, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation(stanModel, scenarioTox, scenarioEff, nbSubjects,
           nbSimu, skeletonTox, skeletonEff, targetTox, targetEff,
           cohortSize, startingDose, sd = NULL, mu, 
           adaptivePrior, saveName)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_+3A_stanmodel">stanModel</code></td>
<td>
  
<p>A compiled STAN model.
</p>
</td></tr>
<tr><td><code id="simulation_+3A_scenariotox">scenarioTox</code></td>
<td>

<p>Toxicity scenario for simulations, with the probability of toxicity for each dose; must be a vector of length the number of doses.
</p>
</td></tr>
<tr><td><code id="simulation_+3A_scenarioeff">scenarioEff</code></td>
<td>

<p>Efficacy scenario for simulations; must be a vector of length the number of doses. 
</p>
</td></tr>
<tr><td><code id="simulation_+3A_nbsubjects">nbSubjects</code></td>
<td>

<p>The maximum number of allocated patients; must be an integer. 
</p>
</td></tr>
<tr><td><code id="simulation_+3A_nbsimu">nbSimu</code></td>
<td>

<p>The number of simulated trials; must be an integer. 
</p>
</td></tr>
<tr><td><code id="simulation_+3A_skeletontox">skeletonTox</code></td>
<td>

<p>The skeleton of toxicity for the BMA bivariate CRM or the bivariate CRM; must be a dataframe with the number of rows corresponding to the number of doses and the number of columns corresponding to the number of working models for toxicity.                   
</p>
</td></tr>
<tr><td><code id="simulation_+3A_skeletoneff">skeletonEff</code></td>
<td>
  
<p>The skeleton of efficacy for the BMA bivariate CRM or the bivariate CRM; must be a dataframe with the number of rows corresponding to the number of doses and the number of columns corresponding to the number of working models for efficacy.
</p>
</td></tr>
<tr><td><code id="simulation_+3A_targettox">targetTox</code></td>
<td>
 
<p>Target/threshold of toxicity; must be a double.  
</p>
</td></tr>
<tr><td><code id="simulation_+3A_targeteff">targetEff</code></td>
<td>
 
<p>Target/threshold of efficacy; must be a double.           
</p>
</td></tr>
<tr><td><code id="simulation_+3A_cohortsize">cohortSize</code></td>
<td>

<p>The size of the cohorts for the 3+3 based algorithm before kickoff of the CRM; must be an integer.
</p>
</td></tr>
<tr><td><code id="simulation_+3A_startingdose">startingDose</code></td>
<td>

<p>First dose to be assigned; must be an integer.
</p>
</td></tr>
<tr><td><code id="simulation_+3A_sd">sd</code></td>
<td>
  
<p>The standard deviation; defaults to NULL.
</p>
</td></tr>
<tr><td><code id="simulation_+3A_mu">mu</code></td>
<td>

<p>The mean value which using the model. 
</p>
</td></tr>
<tr><td><code id="simulation_+3A_adaptiveprior">adaptivePrior</code></td>
<td>

<p>TRUE if you want to use as a prior an adaptive prior; FALSE otherwise. 
</p>
</td></tr>
<tr><td><code id="simulation_+3A_savename">saveName</code></td>
<td>

<p>The name of the RData that simulation will be stored; must be a string.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>,
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>  
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Zohar, S., et al, (2011) An approach to meta-analysis of dose-finding studies, Statistics in Medicine.      
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simu">simu</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
## Not run: 
    library("rstan")       
    adaptivePrior &lt;- TRUE     

    targetTox &lt;- 0.25             # target of toxicity  
    targetEff &lt;- 0.20             # target of efficacy 

    ####### Skeleton ########### 

    skeleton_tox1 &lt;- c(0.10, 0.21, 0.33, 0.55, 0.76)
    skeleton_tox2 &lt;- c(0.21, 0.33, 0.55, 0.76, 0.88)
    skeleton_tox3 &lt;- c(0.05, 0.10, 0.21, 0.33, 0.55)
    skeleton_tox4 &lt;- c(0.025, 0.05, 0.1, 0.21, 0.33)
    skeleton_tox5 &lt;- c(0.0125, 0.025, 0.05, 0.1, 0.21)

    skeleton_eff &lt;- c(0.04937516, 0.20496890, 0.43388003, 0.64409781, 0.79313693)  

    skeleton_tox &lt;-  data.frame(skeleton_tox1, skeleton_tox2, skeleton_tox3, 
                        skeleton_tox4, skeleton_tox5)         
    skeleton_eff &lt;-  data.frame(skeleton_eff, skeleton_eff, skeleton_eff, 
                        skeleton_eff, skeleton_eff)

    ########## Priors ###########    

    priorModel  &lt;- list(rep(1/5,5), 0.001)      
    sd &lt;- 0.65                           
    mu &lt;- -0.34 

    ####### Trial settings  #############

    startingDose &lt;- 1       
    nbSubjects &lt;- 15
    cohortSize &lt;- 3

    ####### Number of simulation desired  ########### 

    nbSimu &lt;- 10 

    ################# CRM model ################
    ############# Prior Normal #################    

    stancode &lt;- 'data {
        int &lt;lower = 0&gt; J; //nb of patients
        int &lt;lower = 0&gt; K; // nb of doses and dose reference
        real r[K]; // skeleton for tox - K doses
        real q[K]; // skeleton for efficacy - K doses
        int y[J]; // toxicity of patient j
        int v[J]; // efficacy of patient j
        int d[J]; // dose received by patient j
        real moy; // mean for the normal prior of toxicity
        real standardError; //standard error of the normal prior of toxicity
        }
        parameters {
            real &lt;lower = 0&gt; alpha;
            real  &lt;lower = 0&gt; beta;
        }
        transformed parameters{
            real &lt;lower = 0, upper = 1&gt; varphi[K]; 
            // marginal probability of toxicity for dose k
            real &lt;lower = 0, upper = 1&gt; psi[K]; 
            // marginal probability of efficacy for dose k
            
            // defining the marginal probabilities for each value of a and b for each dose
            real p01[K]; // tox = 0, eff = 1
            real p10[K]; // tox = 1, eff = 0
            real p11[K]; // tox = 1, eff = 1
            real p00[K]; // tox = 0, eff = 0

            vector[J] logLike;

            for (k in 1:K){
                varphi[k] = exp(alpha*log(r[k]));
                psi[k] = exp(beta*log(q[k]));
            }
            
            
            // computing the marginal probabilities for each dose
                for (k in 1:K){
                    p01[k] = (1-varphi[k])*psi[k]; 
                    p10[k] = varphi[k]*(1-psi[k]);
                    p00[k] = (1-varphi[k])*(1-psi[k]);
                    p11[k] = varphi[k]*psi[k];
                }
            // Computing the log-likelihood
                for (j in 1:J){
                    logLike[j] = y[j]*v[j]*log(p11[d[j]]) + y[j]*(1-v[j])*log(p10[d[j]]) 
                    + (1-y[j])*v[j]*log(p01[d[j]]) + (1-y[j])*(1-v[j])*log(p00[d[j]]);
                }
            
        }
        model {
            // priors
            alpha ~lognormal(moy, standardError);
            beta ~ lognormal(0,sqrt(1.34));              
            increment_log_prob(sum(logLike));
    }'

    stan_model &lt;- stan_model(model_code = stancode)

    ################## Scenarios ##############

    scenario_tox &lt;- c(0.1301477, 0.2774171, 0.4184642, 0.6486846, 0.8257219)
    scenario_eff &lt;- c(0.07945205, 0.20000000, 0.33686856, 0.59537737, 0.80996173)

    ################# Simulation BMA - Normal prior  ################

    simulation(stan_model, scenario_tox, scenario_eff, nbSubjects,
               nbSimu, skeleton_tox, skeleton_eff, targetTox, targetEff,
               cohortSize, startingDose, sd, mu, TRUE, tempfile())

## End(Not run)
</code></pre>

<hr>
<h2 id='skeleton'>
Build a working model.            
</h2><span id='topic+skeleton'></span><span id='topic+plotEstimates'></span>

<h3>Description</h3>

<p>The construction of the working model's skeleton.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skeleton(doseChildren, doseAdult, dataTox, dataAuc = NULL, Clad,
         Clch, nbSimu, graph = TRUE)
</code></pre>


<h3>Arguments</h3>

  
<table>
<tr><td><code id="skeleton_+3A_dosechildren">doseChildren</code></td>
<td>

<p>The paediatric dose level.
</p>
</td></tr> 
<tr><td><code id="skeleton_+3A_doseadult">doseAdult</code></td>
<td>
 
<p>The adult dose level.
</p>
</td></tr>  
<tr><td><code id="skeleton_+3A_datatox">dataTox</code></td>
<td>
 
<p>The database of the toxicities.
</p>
</td></tr> 
<tr><td><code id="skeleton_+3A_dataauc">dataAuc</code></td>
<td>
 
<p>The database of the AUC; defaults to NULL. 
</p>
</td></tr> 
<tr><td><code id="skeleton_+3A_clad">Clad</code></td>
<td>

<p>The clearance of the adults.
</p>
</td></tr> 
<tr><td><code id="skeleton_+3A_clch">Clch</code></td>
<td>

<p>Paediatric clearance (known or estimated). An estimate can be computed using maturation adjustment (MA), allometric adjustment (AA) or linear adjustment (LA) for a specific group of age.
</p>
</td></tr>
<tr><td><code id="skeleton_+3A_nbsimu">nbSimu</code></td>
<td>

<p>The number of simulation using in meta analysis function <code><a href="#topic+metaPhase">metaPhase</a></code>.
</p>
</td></tr>
<tr><td><code id="skeleton_+3A_graph">graph</code></td>
<td>

<p>A choice to plot the estimates using the function <code><a href="#topic+plotEstimates">plotEstimates</a></code> in the end of the working model. Indicates graph = TRUE to plot or otherwise graph = FALSE; defaults to TRUE.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a> 
</p>


<h3>References</h3>

<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+plotEstimates">plotEstimates</a></code>, <code><a href="#topic+metaPhase">metaPhase</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## Not run: 
    ########
    # Note: For this example we are using a paediatric database that we have including data of 
    # children from 0 to 19 years old.
    ########
    
    children &lt;- read.csv("/Users/artemistoumazi/paediatric_data_p3m/children_0_19.csv")
    AGE &lt;- children$Age
    W &lt;- children$Weight

    W_ad &lt;- 70
    Cl_ad &lt;- 3.95

    F_ad &lt;- 0.6
    Eg &lt;- 0
    Eh &lt;- 0.058
    f_abs &lt;- F_ad/((1 - Eh)*(1-Eg))
    fu_ad &lt;- 1
    perc_CYPh &lt;- data.frame("CYP3A4_5" = 0.7, "CYP1A2" = 0.3)
    perc_CYPg &lt;- data.frame("CYP3A4_5" = 1)
    perc_alb &lt;- 1
    perc_alpha1AG &lt;- 0 

    data_molecule &lt;- list(F_ad, f_abs, Eg, Eh, fu_ad, perc_CYPg, perc_CYPh, 
                          perc_alb, perc_alpha1AG)
    Clch_mat &lt;- Clch.Mat(AGE, W, Cl_ad, W_ad, data_molecule)

    ####################################
    ########## WORKING MODEL ###########
    ####################################

    children &lt;- data.frame(children, Clch_mat)

    ########## Children from 2 to 5 years old 
    children2_5 &lt;- children[children$Age &gt;= 2 &amp; children$Age &lt;= 5  ,]                          
    Cl_ch &lt;-  mean(children2_5$Clch_mat)                    

    # Doses for paediatric using maturation adjustment
    dCh_mat_2_5 &lt;- c(30, 45, 55, 70, 85)

    Cl_ad &lt;- 3.95
    AUCThomas &lt;- c(20,40, 60)
    probaToxThomas &lt;- c(0.1,0.25, 0.55)


    ################# Non-parametric PAVA estimate ###################

    # data from the publications of toxicity in the erlotinib
    pardos_2006 &lt;- rbind(c(100,0/3, 3), c(150, 1/3,3), c(200, 0/3, 3), c(250, 3/6, 6))
    thepot_2014 &lt;- rbind(c(100, 0/5, 5), c(150,3/25, 25))
    calvo_2007 &lt;- rbind(c(150, 1/25, 25))
    raizer_2010 &lt;- rbind(c(150,11/99, 99))
    vanDenBent_2009 &lt;- rbind( c(200, 6/54, 54))
    sheikh_2012 &lt;- rbind(c(150, 0.544, 307)) 
    rocheNTC00531934 &lt;- rbind(c(150, 0.186, 59)) 


    dataTox &lt;- rbind(pardos_2006, thepot_2014, calvo_2007, raizer_2010, vanDenBent_2009, 
                     rocheNTC00531934, sheikh_2012)
    dataTox &lt;- data.frame(dataTox)
    colnames(dataTox) &lt;- c("doses", "proba", "nbPatients")
    nbTox &lt;- dataTox$proba*dataTox$nbPatients
    dataTox &lt;- data.frame(dataTox, nbTox)

    data_auc &lt;- data.frame(AUCThomas, probaToxThomas )
    dose_children &lt;- dCh_mat_2_5[1:4]
    dose_adult &lt;- c(100,150,200, 250)
    graph &lt;- TRUE

    skeleton(dose_children, dose_adult, dataTox, data_auc, Cl_ad, Cl_ch, nbSimu = 10, 
             graph = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='waic'>
Function for the Watanabe-Akaike information criteria (WAIC) 
</h2><span id='topic+waic'></span><span id='topic+fitDataj'></span>

<h3>Description</h3>

<p>Model selection can be performed for each working model (WM) using the Watanabe-Akaike
information criteria (WAIC) developed by Watanabe. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>waic(stanfit, s)            
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="waic_+3A_stanfit">stanfit</code></td>
<td>

<p>Estimates obtained with the STAN fit. You can use the <code><a href="#topic+fitDataj">fitDataj</a></code> function which is giving the next fit of the model from STAN.  
</p>
</td></tr>
<tr><td><code id="waic_+3A_s">s</code></td>
<td>

<p>Integer specifying the number of models used to compute the WAIC selection.
</p>
</td></tr>      
</table>


<h3>Author(s)</h3>

   
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>,
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a>
</p>


<h3>References</h3>

 
<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>
<p>Watanabe S. Asymptotic Equivalence of Bayes cross vallidation and widely applicable information criterion in singular learning theory, volume 11. 2010.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
	for(s in 1:nbDesign){
		fitj &lt;- fitDataj(stan_model, nbPatientsj, nbDoses, tox, eff, given_dose,
						 skeleton_tox, skeleton_eff, mu, sigma, s)
		waicj &lt;- waic(stanfit=fitj, s)
	}

## End(Not run)
</code></pre>

<hr>
<h2 id='weightCYPsum'>
Proportion of the molecule metabolised by the CYPs for a child according to age.
</h2><span id='topic+weightCYPsum'></span>

<h3>Description</h3>

<p>Proportion of the molecule metabolised by the CYPs. A weighted sum is computed. For each CYP, the proportion metabolised in adults is multiplied with the fraction of CYP (KCYP) available for a child according to age. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightCYPsum(age, percCYP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightCYPsum_+3A_age">age</code></td>
<td>

<p>The age of child.
</p>
</td></tr>
<tr><td><code id="weightCYPsum_+3A_perccyp">percCYP</code></td>
<td>

<p>Dataframe giving the percentage of the molecule metabolised for each cytochrome in adults. Dataframe with two column - column 1: CYP name, column 2: percentage of the molecule metabolised.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Artemis Toumazi <a href="mailto:artemis.toumazi@gmail.com">artemis.toumazi@gmail.com</a>,
Caroline Petit <a href="mailto:caroline.petit@crc.jussieu.fr">caroline.petit@crc.jussieu.fr</a>, 
Sarah Zohar <a href="mailto:sarah.zohar@inserm.fr">sarah.zohar@inserm.fr</a> 
</p>


<h3>References</h3>

 
<p>Petit, C., et al, (2016) Unified approach for extrapolation and bridging of adult information in early phase dose-finding paediatric studies, Statistical Methods in Medical Research, &lt;doi:10.1177/0962280216671348&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Clchu">Clchu</a></code>, <code><a href="#topic+Fch">Fch</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- 2
perc_CYP &lt;- data.frame("CYP3A4_5" = 0.7, "CYP1A2" = 0.3)
weightCYPsum(age, perc_CYP)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
