<!DOCTYPE html><html lang="en"><head><title>Help for package Simile</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Simile}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Simile-package'>
<p>Interface to executable Simile models</p></a></li>
<li><a href='#consult.parameter.metafile'>
<p>Set a model's parameters from a file saved by Simile</p></a></li>
<li><a href='#create.model'>
<p>Create an executable model instance</p></a></li>
<li><a href='#create.param.array'>
<p>Allocates memory for interactively loading model parameters</p></a></li>
<li><a href='#execute.model'>
<p>Execute a Simile model to a given time point</p></a></li>
<li><a href='#get.model.property'>
<p>Get properties of model components</p></a></li>
<li><a href='#get.model.time'>
<p>Gets the time in the simulation.</p></a></li>
<li><a href='#get.value.array'>
<p>Get values from model components</p></a></li>
<li><a href='#get.value.list'>
<p>Get values from model components</p></a></li>
<li><a href='#is.dummy'>
<p>Test if a path or handle is a 'dummy' whose only purpose is to allow</p>
tests to run.</a></li>
<li><a href='#list.objects'>
<p>List Simile model components</p></a></li>
<li><a href='#load.model'>
<p>Load a Simile executable model</p></a></li>
<li><a href='#reset.model'>
<p>resets the model to its initial state.</p></a></li>
<li><a href='#set.model.parameter'>
<p>Sets a model parameter with data in an array</p></a></li>
<li><a href='#set.model.step'>
<p>Sets the time step used to execute a model.</p></a></li>
<li><a href='#tcl.paired.to.array'>
<p>Re-format model value array</p></a></li>
<li><a href='#tcl.paired.to.list'>
<p>Re-format model value array</p></a></li>
<li><a href='#use.simile.at'>
<p>Initialize the Simile interface</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Interact with Simile Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.4</td>
</tr>
<tr>
<td>Depends:</td>
<td>tcltk</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-10</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows a Simile model saved as a compiled binary to be
  loaded, parameterized, executed and interrogated. This version works 
  with Simile v6 on.</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-11 17:42:03 UTC; jaspert</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Simulistics Ltd [cph],
  Jasper Taylor [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jasper Taylor &lt;support@simulistics.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-11 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Simile-package'>
Interface to executable Simile models
</h2><span id='topic+Simile-package'></span><span id='topic+Simile'></span>

<h3>Description</h3>

<p>This package loads, parameterizes, executes and interrogates executable
models saved by Simile.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> Simile</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.3.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-12-10</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unrestricted</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The package loads some Simile libraries into R's tcltk extension, so you
need Simile installed to use it. Initialize the package by calling
use.simile.at() to tell it where to find Simile in the file system. Tell
it where to find the saved executable model with load.model() which
returns a handle to the loaded model. This can be used to interrogate
static model info via list.objects() and get.model.property(), and to
create executable instances with create.model(), which returns their handles.
</p>
<p>An executable instance can be parameterized either by loading a Simile
parameter metafile with consult.parameter.metafile(), or directly from R
arrays with create.param.array() and set.model.parameter(). The
functions set.model.step(), reset.model() and execute.model() control
execution. get.model.time() returns the time at which execution
finished. Use get.value.array() to get the values from any model
component as an R array, or get.value.list() to get them as an R list.
</p>
<p>This version works with Simile versions 6.0 on.
</p>


<h3>Author(s)</h3>

<p>Simulistics Ltd
</p>


<h3>References</h3>

<p>Simile modelling environment: http://simulistics.com
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("Simile")
exec.extn &lt;- as.character(tcl("info","sharedlibextension"))
if (interactive()) {
  path.to.installation &lt;- tcl("tk_chooseDirectory", "-title",
  		       "Folder where Simile is installed:")

  path.to.spiro &lt;- tcl("tk_getOpenFile",
		       "-title", "Compiled binary for Spiro example:",		
                       "-initialfile", paste("spiro",exec.extn,sep=""))
} else { 
  path.to.installation &lt;- "dummy/path"
  path.to.spiro &lt;- "dummy.dll"
}

use.simile.at(path.to.installation)
mHandle &lt;- load.model(path.to.spiro)
objs &lt;- list.objects(mHandle)

for (obj in objs) {
  print(c(obj, get.model.property(mHandle, obj, "Class")))
}

iHandle &lt;- create.model(mHandle)
# model step is 0.1 by default but spiro only needs 1.0
set.model.step(iHandle, 1, 1)

# initialize the model, including default slider values
reset.model(iHandle, -2)

xs &lt;- list(get.value.list(iHandle, "/runs/x"))
ys &lt;- list(get.value.list(iHandle, "/runs/y"))
for (count in 1:1739) {
  execute.model(iHandle, count)
  xs[[count+1]] &lt;- get.value.list(iHandle, "/runs/x")
  ys[[count+1]] &lt;- get.value.list(iHandle, "/runs/y")
}
xs &lt;- mapply(c,xs)
ys &lt;- mapply(c,ys)
print("View default pattern -- now try to plot dancer")
plot(xs, ys, type="l")

# now we are going to parameterize it using a state file for the slider helper
# -- to make this work we load the mime library, which is needed only because
# the dancer.spf in Simile v6 is an older v4.x format file. No need to load 
# if testing, and will always be available if live because required for Simile.

if (!is.dummy(iHandle)) {
   tcl("package","require","mime")
}
pFile  &lt;- tcl("file", "join", path.to.installation, "Examples", "dancer.spf")
consult.parameter.metafile(iHandle, pFile)

# also the file from the v6 distribution has no value for "Wheel outside?"
# so we set this boolean directly
pHandle &lt;- create.param.array(iHandle, "/start/Wheel outside?")
set.model.parameter(pHandle, FALSE)

# apply reset at level 0 to propagate input values
reset.model(iHandle, 0)

xs &lt;- list(get.value.list(iHandle, "/runs/x"))
ys &lt;- list(get.value.list(iHandle, "/runs/y"))
for (count in 1:419) {
  execute.model(iHandle, count)
  xs[[count+1]] &lt;- get.value.list(iHandle, "/runs/x")
  ys[[count+1]] &lt;- get.value.list(iHandle, "/runs/y")
}
xs &lt;- mapply(c,xs)
ys &lt;- mapply(c,ys)
plot(xs, ys, type="l")

print("OK, but that's not how it looks on Simile is it? Try this...")
xs &lt;- aperm(xs, c(2,1))
ys &lt;- aperm(ys, c(2,1))
plot(xs, ys, type="l")
</code></pre>

<hr>
<h2 id='consult.parameter.metafile'>
Set a model's parameters from a file saved by Simile
</h2><span id='topic+consult.parameter.metafile'></span>

<h3>Description</h3>

<p>Parameter metafiles (.spf) saved from within Simile can contain
information about a model's parameter values, either locally or as
references to other files. They may refer to the whole model or a submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>consult.parameter.metafile(instance.handle,param.file,target.submodel="")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="consult.parameter.metafile_+3A_instance.handle">instance.handle</code></td>
<td>

<p>The handle returned by create.model() identifying the model instance.
</p>
</td></tr>
<tr><td><code id="consult.parameter.metafile_+3A_param.file">param.file</code></td>
<td>

<p>Location of the parameter metafile.
</p>
</td></tr>
<tr><td><code id="consult.parameter.metafile_+3A_target.submodel">target.submodel</code></td>
<td>

<p>Pathname of the submodel into which the parameters are to be loaded. Default is the top level.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>consult.parameter.metafile("dummy_ih", "../data/base_vals.spf")
</code></pre>

<hr>
<h2 id='create.model'>
Create an executable model instance
</h2><span id='topic+create.model'></span>

<h3>Description</h3>

<p>A script can create many independent instances of the same model
description, each with its own execution state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.model(model.handle)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.model_+3A_model.handle">model.handle</code></td>
<td>

<p>The handle returned by load.model() identifying the model type.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A handle to a new instance of the model, which will have its own
component values, parameter values and execution settings
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>instance.handle &lt;- create.model("dummy_mh")
</code></pre>

<hr>
<h2 id='create.param.array'>
Allocates memory for interactively loading model parameters
</h2><span id='topic+create.param.array'></span>

<h3>Description</h3>

<p>If a script is to provide values directly for a Simile model parameter,
this command must be called first to set up a location for the
parameters to be held
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.param.array(instance.handle,param.name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.param.array_+3A_instance.handle">instance.handle</code></td>
<td>

<p>The handle returned by create.model() identifying the model instance.
</p>
</td></tr>
<tr><td><code id="create.param.array_+3A_param.name">param.name</code></td>
<td>

<p>Caption path to the model component whose value is to be specified
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A handle to the location that has been created.
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param.handle &lt;- create.param.array("dummy_ih", "/submodel1/trees/larch")
</code></pre>

<hr>
<h2 id='execute.model'>
Execute a Simile model to a given time point 
</h2><span id='topic+execute.model'></span>

<h3>Description</h3>

<p>The model will be executed using the time steps specified by earlier
calling set.model.step until either the finish.time is reached or an
exception occurs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>execute.model(instance.handle, finish.time, integration.method,
start.time, error.limit, pause.on.event)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="execute.model_+3A_instance.handle">instance.handle</code></td>
<td>

<p>The handle returned by create.model(), identifying an executable model instance.
</p>
</td></tr>
<tr><td><code id="execute.model_+3A_finish.time">finish.time</code></td>
<td>

<p>Time returned by functions in the model on the last execution
step, when incrementing the time takes it to or beyond this value. 
</p>
</td></tr>
<tr><td><code id="execute.model_+3A_integration.method">integration.method</code></td>
<td>

<p>One of &quot;Euler&quot; or &quot;Runge-Kutta&quot;, the latter being 4th-order. Default
is &quot;Euler&quot;.
</p>
</td></tr>
<tr><td><code id="execute.model_+3A_start.time">start.time</code></td>
<td>

<p>Time returned by functions in the model on the first execution
step. On each subsequent step this will be incremented by the value
specified by earlier calling set.model.step. Default is NA, which starts the
model at the time to which it was previously reset or executed.
</p>
</td></tr>
<tr><td><code id="execute.model_+3A_error.limit">error.limit</code></td>
<td>
<p>Maximum integration error allowed by adaptive step
size variation, as a fraction of the allowed
range of each model compartment value. The integration error is
estimated by comparing each compartment's rate of change with that
predicted on the previous time step (equal to its previous rate of
change if integration method is Euler). If error limit is exceeded,
the time step is temporarily shortened and the model re-executed
from the end of the last time step. Default is 0, in which case no
adaptive step size variation is done.</p>
</td></tr>
<tr><td><code id="execute.model_+3A_pause.on.event">pause.on.event</code></td>
<td>
<p>Controls whether execution should be paused in
the case of potentially interesting model occurrences. These are
limit events (discrete events triggered by the value of an
expression reaching a preset maximum or minimum), and compartment
over/underruns (the level of a compartment exceeding or underrunning
its specified maximum or minimum). Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Result code: value of system error (-ve), user-defined
interruption (+ve) or 0 if model runs to finish.time
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>for (count in 0:1738) {
  execute.model("dummy_ih", count+1, "Euler", count, 0, FALSE)
}
</code></pre>

<hr>
<h2 id='get.model.property'>
Get properties of model components
</h2><span id='topic+get.model.property'></span>

<h3>Description</h3>

<p>This function can return any of several pieces of static information
about a component in a loaded Simile model</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.model.property(model.handle,caption.path,requested.property)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.model.property_+3A_model.handle">model.handle</code></td>
<td>

<p>Model handle created when calling load.model()
</p>
</td></tr>
<tr><td><code id="get.model.property_+3A_caption.path">caption.path</code></td>
<td>

<p>Path made from submodel and component captions separated by forward
slashes, like a member of the list returned by list.objects()
</p>
</td></tr>
<tr><td><code id="get.model.property_+3A_requested.property">requested.property</code></td>
<td>

<p>One of the following strings:
</p>

<dl>
<dt>Class</dt><dd><p>Returns the component class, i.e., which Simile symbol it is.</p>
</dd>
<dt>Type</dt><dd><p>Data type of component's value. </p>
</dd>
<dt>Eval</dt><dd><p>Source of component's value. </p>
</dd>
<dt>Dims</dt><dd><p>Returns list of the component value's array dimensions.</p>
</dd>
<dt>MinVal, MaxVal, Desc, Comment</dt><dd><p>Return other values or text associated
with component in Simile.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>Form of returned value depends on the requested.property as described
above.
</p>

<ul>
<li><p> For Class it is one of SUBMODEL VARIABLE COMPARTMENT FLOW CONDITION
CREATION REPRODUCTION IMMIGRATION LOSS ALARM EVENT SQUIRT STATE
</p>
</li>
<li><p> For Type: one of VALUELESS REAL
INTEGER FLAG EXTERNAL or ENUM(n), where n is the index of a set of
enumerated type values.
</p>
</li>
<li><p> For Eval: one of EXOGENOUS DERIVED
TABLE INPUT SPLIT GHOST. Fixed parameters have TABLE and variable
parameters INPUT for this property.
</p>
</li>
<li><p> For Dims it is a list containing integers or the special types RECORDS
MEMBERS SEPARATE START_VM END_VM for components in submodels without a
preset member count.
</p>
</li>
<li><p> For MinVal and MaxVal it is a number of the same type as the component.
</p>
</li>
<li><p> For Desc and Comment it is a character string.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get.model.property("dummy_mh","/sector/output","Class")
# [1] "COMPARTMENT"
get.model.property("dummy_mh","/sector/output","Dims")
# [1] 2 5
</code></pre>

<hr>
<h2 id='get.model.time'>
Gets the time in the simulation.
</h2><span id='topic+get.model.time'></span>

<h3>Description</h3>

<p>The simulation time is initialized by the reset.model command, and
incremented by the execute.model command. After execute.model it may
not be the expected end time because the model may stop executing
before that point for various reasons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.model.time(instance.handle)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.model.time_+3A_instance.handle">instance.handle</code></td>
<td>

<p>The handle returned by create.model(), identifying an executable model instance.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The current model time
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get.model.time("dummy_ih")
</code></pre>

<hr>
<h2 id='get.value.array'>
Get values from model components
</h2><span id='topic+get.value.array'></span>

<h3>Description</h3>

<p>Retrieves data from the model, as either a single quantity or an array
of values with the appropriate dimensions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.value.array(instance.handle, value.name, as.enum.types)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.value.array_+3A_instance.handle">instance.handle</code></td>
<td>

<p>The handle returned by create.model(), identifying an executable model instance.
</p>
</td></tr>
<tr><td><code id="get.value.array_+3A_value.name">value.name</code></td>
<td>

<p>Caption path to the model component whose values are required
</p>
</td></tr>
<tr><td><code id="get.value.array_+3A_as.enum.types">as.enum.types</code></td>
<td>

<p>Logical: whether to supply values as character strings, using
enumerated type names if applicable. Default is false: values are numerical.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value or array of values, from the model
</p>


<h3>Note</h3>


<p>Will not work on components inside variable-membership submodels. For
these you should use get.value.list instead, as R's list structure is
more appropriate than the array structure when not all values exist.
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.value.list">get.value.list</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get.value.array("dummy_ih", "/sector/output", FALSE)
# [1]  0.8414710  0.9092974  0.1411200 -0.7568025 -0.9589243 -0.2794155
# [7]  0.6569866  0.9893582  0.4121185 -0.5440211
</code></pre>

<hr>
<h2 id='get.value.list'>
Get values from model components
</h2><span id='topic+get.value.list'></span>

<h3>Description</h3>

<p>Retrieves data from the model, as either a single quantity or a
possibly nested list of values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.value.list(instance.handle, value.name, as.enum.types)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.value.list_+3A_instance.handle">instance.handle</code></td>
<td>

<p>The handle returned by create.model(), identifying an executable model instance.
</p>
</td></tr>
<tr><td><code id="get.value.list_+3A_value.name">value.name</code></td>
<td>

<p>Caption path to the model component whose values are required
</p>
</td></tr>
<tr><td><code id="get.value.list_+3A_as.enum.types">as.enum.types</code></td>
<td>

<p>Logical: whether to supply indices and values as character strings, using
enumerated type members if applicable. Default is false: indices are
integers and values are numerical.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value or index-value list, from the model
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.value.array">get.value.array</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get.value.list("dummy_ih", "/runs/x", "FALSE")
# [[1]]
# [1] 40.76668
# 
# [[2]]
# [1] 37.52907
# 
# [[3]]
# [1] 33.82021
# 
# [[4]]
# [1] 29.69413
</code></pre>

<hr>
<h2 id='is.dummy'>
Test if a path or handle is a 'dummy' whose only purpose is to allow
tests to run.
</h2><span id='topic+is.dummy'></span>

<h3>Description</h3>

<p>When any of the functions in the package are called, if this returns
'true' on their first argument, no actual Simile interaction will be
attempted but some sample output may be returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.dummy(path.or.handle)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.dummy_+3A_path.or.handle">path.or.handle</code></td>
<td>

<p>The file path or handle which is being tested for dummy-ness.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean which is true in the case of a dummy argument.
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.dummy("dummy.dll")
# [1] TRUE
is.dummy("~/.simile/Examples/spiro.so")
# [1] FALSE
</code></pre>

<hr>
<h2 id='list.objects'>
List Simile model components
</h2><span id='topic+list.objects'></span>

<h3>Description</h3>

<p>Lists all the model components with values. Components are specified by
path, i.e., a string made from their caption preceded by the caption of
their parent submodel, its parent and so on, separated by
forward-slashes like a directory path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list.objects(model.handle)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list.objects_+3A_model.handle">model.handle</code></td>
<td>


<p>Model handle created when calling load.model()
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of component paths as described above, in tree traversal order</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>list.objects("dummy_mh")
# [1] "/sector"           "/sector/output"    "/sector/flow1"    
# [4] "/sector/variation"
</code></pre>

<hr>
<h2 id='load.model'>
Load a Simile executable model
</h2><span id='topic+load.model'></span>

<h3>Description</h3>

<p>Loads a simile model saved as a compiled binary ( a .dll, .so or .dylib
file depending on platform)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.model(path.to.binary)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load.model_+3A_path.to.binary">path.to.binary</code></td>
<td>

<p>Absolute or relative path to file to be loaded
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Handle to be used for querying or instantiating model, as a Tcl object
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor</p>


<h3>Examples</h3>

<pre><code class='language-R'>model.handle &lt;- load.model("dummy.dll")
</code></pre>

<hr>
<h2 id='reset.model'>
resets the model to its initial state. 
</h2><span id='topic+reset.model'></span>

<h3>Description</h3>

<p>A Simile model instance must be reset before it is first run, whenever
the parameters are changed, and in order to run it again with new values
for random constants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reset.model(instance.handle, depth, integration.method, starting.time)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reset.model_+3A_instance.handle">instance.handle</code></td>
<td>

<p>The handle returned by create.model(), identifying an executable model instance.
</p>
</td></tr>
<tr><td><code id="reset.model_+3A_depth">depth</code></td>
<td>

<p>Simile does a sort of 'lazy execution', with values being left
untouched if they do not need to be recalculated for a given type of
reset. This argument tells it what to reset, with each action
including those that follow it:
</p>

<dl>
<dt>-2</dt><dd><p>Recalculate constant atrithmetic expressions including numerals</p>
</dd>
<dt>-1</dt><dd><p>Recalculate values that depend on fixed parameters</p>
</dd>
<dt>0</dt><dd><p>Recalculate random constants and set state variables to their
initial values</p>
</dd>
<dt>+ve</dt><dd><p>Recalculate rate variables from the current state values at this
time step</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="reset.model_+3A_integration.method">integration.method</code></td>
<td>

<p>One of &quot;Euler&quot; or &quot;Runge-Kutta&quot;, the latter being 4th-order. Default
is &quot;Euler&quot;.
</p>
</td></tr>
<tr><td><code id="reset.model_+3A_starting.time">starting.time</code></td>
<td>

<p>Value for model time after resetting. Used for indexing time series,
time plots etc in the model. Default is 0. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>reset.model("dummy_ih", -2)
</code></pre>

<hr>
<h2 id='set.model.parameter'>
Sets a model parameter with data in an array
</h2><span id='topic+set.model.parameter'></span>

<h3>Description</h3>

<p>A model parameter may be a single value or an array of values. This
function allows it to be set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.model.parameter(param.handle,data, as.enum.types)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set.model.parameter_+3A_param.handle">param.handle</code></td>
<td>

<p>The handle returned by create.param.array() identifying the location to
send the data.
</p>
</td></tr>
<tr><td><code id="set.model.parameter_+3A_data">data</code></td>
<td>

<p>The data to be used in the model, either a single value or an array with
the appropriate dimensions
</p>
</td></tr>
<tr><td><code id="set.model.parameter_+3A_as.enum.types">as.enum.types</code></td>
<td>

<p>Logical: whether the values are supplied using
enumerated type names if applicable. Default is false: values are numerical.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.model.parameter("dummy_ph", array(c(4,4,3,4,2,5,5,2,1,5), c(2,5)))
</code></pre>

<hr>
<h2 id='set.model.step'>
Sets the time step used to execute a model.
</h2><span id='topic+set.model.step'></span>

<h3>Description</h3>

<p>The time step is the amount by which the model time advances each time
the state variables are updated. A model may have more than one time
step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.model.step(instance.handle,step.index,step.size)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set.model.step_+3A_instance.handle">instance.handle</code></td>
<td>

<p>The handle returned by create.model(), identifying an executable model instance.
</p>
</td></tr>
<tr><td><code id="set.model.step_+3A_step.index">step.index</code></td>
<td>

<p>The level of the time step to be set. If a model only has one time step,
this is step 1. Higher levels are set to shorter steps.
</p>
</td></tr>
<tr><td><code id="set.model.step_+3A_step.size">step.size</code></td>
<td>

<p>The duration for the time step.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.model.step("dummy_ih", 1, 0.1)
</code></pre>

<hr>
<h2 id='tcl.paired.to.array'>
Re-format model value array
</h2><span id='topic+tcl.paired.to.array'></span>

<h3>Description</h3>

<p>Convert a set of values from a Simile model component from a nested
list of alternating indices and values to an R array structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tcl.paired.to.array(paired, dims, as.enum.types)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tcl.paired.to.array_+3A_paired">paired</code></td>
<td>

<p>Nested list of alternating indices and values
</p>
</td></tr>
<tr><td><code id="tcl.paired.to.array_+3A_dims">dims</code></td>
<td>

<p>Dimensions of R array structure
</p>
</td></tr>
<tr><td><code id="tcl.paired.to.array_+3A_as.enum.types">as.enum.types</code></td>
<td>

<p>If TRUE, values will be converted to R character strings, otherwise
they are numeric
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical value or array of numerical values, from the Tcl value or array
</p>


<h3>Note</h3>

<p>Note that the dimensions of the array returned will be in the opposite
order from those supplied in the 'dims' argument. This is because
Simile's convention is to list the outermost dimension first, whereas
R's is to list the outermost dimension last.
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tcl.paired.to.list">tcl.paired.to.list</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Simile:::tcl.paired.to.array("1 {1 7 2 4} 2 {1 8 2 6} 3 {1 9 2 1}",
c(3,2), FALSE)
#     [,1] [,2] [,3]
#[1,]    7    8    9
#[2,]    4    6    1
</code></pre>

<hr>
<h2 id='tcl.paired.to.list'>
Re-format model value array
</h2><span id='topic+tcl.paired.to.list'></span>

<h3>Description</h3>

<p>Convert a set of values from a Simile model component from a nested
list of alternating indices and values to an R nested list structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tcl.paired.to.list(paired, as.enum.types)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tcl.paired.to.list_+3A_paired">paired</code></td>
<td>

<p>Nested list of alternating indices and values
</p>
</td></tr>
<tr><td><code id="tcl.paired.to.list_+3A_as.enum.types">as.enum.types</code></td>
<td>

<p>If TRUE, indices and values will be converted to R character
strings, otherwise they are numeric
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical value or nested list of numerical values, from the Tcl value or array
</p>


<h3>Author(s)</h3>

<p>Jasper Taylor
</p>


<h3>See Also</h3>


<p><code><a href="#topic+tcl.paired.to.array">tcl.paired.to.array</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Simile:::tcl.paired.to.list("1 {1 7 2 4} 2 {1 8} 3 {2 1}", FALSE)
# [[1]]
# [[1]][[1]]
# [1] 7
# 
# [[1]][[2]]
# [1] 4
# 
# 
# [[2]]
# [[2]][[1]]
# [1] 8
# 
# 
# [[3]]
# [[3]][[1]]
# NULL
# 
# [[3]][[2]]
# [1] 1
</code></pre>

<hr>
<h2 id='use.simile.at'>
Initialize the Simile interface
</h2><span id='topic+use.simile.at'></span>

<h3>Description</h3>

<p>This tells the package where to find an installed copy of Simile. It
then loads the Tcl command implementations in the Simile installation to
enable R's tcltk package to communicate with Simile's saved executable
models. It should be called only once in a session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use.simile.at(path.to.installation)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="use.simile.at_+3A_path.to.installation">path.to.installation</code></td>
<td>

<p>Absolute or realtive path to top directory of Simile installation, e.g., &quot;c:/Program files/Simile5.97&quot; or &quot;/usr/lib64/Simile-6.3&quot;
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>undefined.
</p>


<h3>Author(s)</h3>

<p>Simulistics Ltd
</p>


<h3>Examples</h3>

<pre><code class='language-R'>use.simile.at("dummy/path")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
