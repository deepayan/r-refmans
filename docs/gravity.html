<!DOCTYPE html><html><head><title>Help for package gravity</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gravity}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bvu'><p>Bonus vetus OLS (BVU)</p></a></li>
<li><a href='#bvw'><p>Bonus vetus OLS (BVW)</p></a></li>
<li><a href='#ddm'><p>Double Demeaning (DDM)</p></a></li>
<li><a href='#discard_unusable'><p>Discard non-positive and/or non-finite observations in datasets</p></a></li>
<li><a href='#ek_tobit'><p>Eaton and Kortum (2001) Tobit model (EK Tobit)</p></a></li>
<li><a href='#et_tobit'><p>Eaton and Tamura (1995) threshold Tobit model (ET Tobit)</p></a></li>
<li><a href='#fixed_effects'><p>Fixed Effects</p></a></li>
<li><a href='#gpml'><p>Gamma Pseudo Maximum Likelihood (GPML)</p></a></li>
<li><a href='#gravity_no_zeros'>
<p>Gravity dataset without zero trade flows</p></a></li>
<li><a href='#gravity_zeros'>
<p>Gravity dataset without zero trade flows</p></a></li>
<li><a href='#gravity-exports'><p>gravity exported operators and S3 methods</p>
The following functions are imported and then re-exported
from the gravity package to avoid listing Depends of gravity.</a></li>
<li><a href='#hm_summary'><p>Head and Mayer consistent summary statistics</p></a></li>
<li><a href='#log_distance'><p>Apply logarithm to distance column</p></a></li>
<li><a href='#nbpml'><p>Negative Binomial Pseudo Maximum Likelihood (NBPML)</p></a></li>
<li><a href='#nls'><p>Non-linear Least Squares (NLS)</p></a></li>
<li><a href='#ols'><p>Ordinary Least Squares (OLS)</p></a></li>
<li><a href='#ppml'><p>Poisson Pseudo Maximum Likelihood (PPML)</p></a></li>
<li><a href='#sils'><p>Structural Iterated Least Squares (SILS)</p></a></li>
<li><a href='#tetrads'><p>Tetrads</p></a></li>
<li><a href='#tobit'><p>Left-censored Tobit model with known threshold</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation Methods for Gravity Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A wrapper of different standard estimation methods for gravity models. 
  This package provides estimation methods for log-log models and multiplicative models.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pacha.dev/gravity/">https://pacha.dev/gravity/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pachadotdev/gravity/issues/">https://github.com/pachadotdev/gravity/issues/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>lmtest, sandwich, glm2, MASS, stats, censReg, survival,
multiwayvcov, tibble, magrittr, dplyr, tidyr, purrr, rlang,
Rdpack, utils</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (&ge; 2)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, broom</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-29 06:30:16 UTC; pacha</td>
</tr>
<tr>
<td>Author:</td>
<td>Anna-Lena Woelwer [aut, cph],
  Jan Pablo Burgard [aut, cph],
  Joshua Kunst [aut, cph],
  Mauricio Vargas <a href="https://orcid.org/0000-0003-1017-7574"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Romain Francois [ctb] (adapted parts of the code to use dplyr 0.8.0),
  Lionel Henry [ctb] (simplified parts of the code),
  Sarah Johnson [ctb] (improved the double demeaning function),
  Hrisyana Doytchinova [rev] (sent us different suggestions and bug
    reports)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mauricio Vargas &lt;m.sepulveda@mail.utoronto.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-02 08:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='bvu'>Bonus vetus OLS (BVU)</h2><span id='topic+bvu'></span>

<h3>Description</h3>

<p><code>bvu</code> estimates gravity models via Bonus vetus OLS with simple averages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bvu(
  dependent_variable,
  distance,
  additional_regressors = NULL,
  income_origin,
  income_destination,
  code_origin,
  code_destination,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bvu_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This dependent variable is
divided by the product of unilateral incomes such (i.e. <code>income_origin</code> and <code>income_destination</code>)
and logged afterwards.</p>
</td></tr>
<tr><td><code id="bvu_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="bvu_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDP should be inserted via the arguments
<code>income_origin</code> and <code>income_destination</code>. As country specific effects are subdued due to demeaning, no further unilateral variables apart from incomes can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="bvu_+3A_income_origin">income_origin</code></td>
<td>
<p>(Type: character) origin income variable (e.g. GDP) in the dataset.</p>
</td></tr>
<tr><td><code id="bvu_+3A_income_destination">income_destination</code></td>
<td>
<p>(Type: character) destination income variable (e.g. GDP) in the dataset.</p>
</td></tr>
<tr><td><code id="bvu_+3A_code_origin">code_origin</code></td>
<td>
<p>(Type: character) country of origin variable (e.g. ISO-3 country codes). The variables are grouped
using this parameter.</p>
</td></tr>
<tr><td><code id="bvu_+3A_code_destination">code_destination</code></td>
<td>
<p>(Type: character) country of destination variable (e.g. country ISO-3 codes). The variables are
grouped using this parameter.</p>
</td></tr>
<tr><td><code id="bvu_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bvu_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="bvu_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bonus vetus OLS is an estimation method for gravity models
developed by Baier and Bergstrand (2009); Baier and Bergstrand (2010) using simple averages to center a
Taylor-series.
</p>
<p>The <code>bvu</code> function considers Multilateral Resistance terms and allows to
conduct comparative statics. Country specific effects are subdued due
to demeaning. Hence, unilateral variables apart from incomes cannot be included
in the estimation.
</p>
<p><code>bvu</code> is designed to be consistent with the Stata code provided at
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.
</p>
<p>As, to our knowledge at the moment, there is no explicit literature covering
the estimation of a gravity equation by <code>bvu</code> using panel data,
we do not recommend to apply this method in this case.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- bvu(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "contig", "comcur"),
  income_origin = "gdp_o",
  income_destination = "gdp_d",
  code_origin = "iso_o",
  code_destination = "iso_d",
  robust = FALSE,
  data = grav_small
)
</code></pre>

<hr>
<h2 id='bvw'>Bonus vetus OLS (BVW)</h2><span id='topic+bvw'></span>

<h3>Description</h3>

<p><code>bvw</code> estimates gravity models via Bonus
vetus OLS with income-weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bvw(
  dependent_variable,
  distance,
  additional_regressors = NULL,
  income_origin,
  income_destination,
  code_origin,
  code_destination,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bvw_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This dependent variable is
divided by the product of unilateral incomes such (i.e. <code>income_origin</code> and <code>income_destination</code>)
and logged afterwards.</p>
</td></tr>
<tr><td><code id="bvw_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="bvw_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDP should be inserted via the arguments
<code>income_origin</code> and <code>income_destination</code>. As country specific effects are subdued due to demeaning, no further
unilateral variables apart from incomes can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="bvw_+3A_income_origin">income_origin</code></td>
<td>
<p>(Type: character) origin income variable (e.g. GDP) in the dataset.</p>
</td></tr>
<tr><td><code id="bvw_+3A_income_destination">income_destination</code></td>
<td>
<p>(Type: character) destination income variable (e.g. GDP) in the dataset.</p>
</td></tr>
<tr><td><code id="bvw_+3A_code_origin">code_origin</code></td>
<td>
<p>(Type: character) country of origin variable (e.g. ISO-3 country codes). The variables are grouped
using this parameter.</p>
</td></tr>
<tr><td><code id="bvw_+3A_code_destination">code_destination</code></td>
<td>
<p>(Type: character) country of destination variable (e.g. country ISO-3 codes). The variables are
grouped using this parameter.</p>
</td></tr>
<tr><td><code id="bvw_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bvw_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="bvw_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bonus vetus OLS is an estimation method for gravity models
developed by Baier and Bergstrand (2009); Baier and Bergstrand (2010) using income-weights to center a
Taylor series.
</p>
<p>The <code>bvw</code> function considers Multilateral Resistance terms and allows to
conduct comparative statics. Country specific effects are subdued due
to demeaning. Hence, unilateral variables apart from <code>inc_o</code>
and <code>inc_d</code> cannot be included in the estimation.
</p>
<p><code>bvw</code> is designed to be consistent with the Stata code provided at
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.
</p>
<p>As, to our knowledge at the moment, there is no explicit literature covering
the estimation of a gravity equation by <code>bvw</code> using panel data,
we do not recommend to apply this method in this case.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- bvw(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "comcur", "contig"),
  income_origin = "gdp_o",
  income_destination = "gdp_d",
  code_origin = "iso_o",
  code_destination = "iso_d",
  robust = FALSE,
  data = grav_small
)
</code></pre>

<hr>
<h2 id='ddm'>Double Demeaning (DDM)</h2><span id='topic+ddm'></span>

<h3>Description</h3>

<p><code>ddm</code> estimates gravity models via double demeaning the
left hand side and right hand side of the gravity equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddm(
  dependent_variable,
  distance,
  additional_regressors = NULL,
  code_origin,
  code_destination,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ddm_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This dependent variable is
divided by the product of unilateral incomes such (i.e. <code>income_origin</code> and <code>income_destination</code>)
and logged afterwards.</p>
</td></tr>
<tr><td><code id="ddm_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="ddm_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDP should be inserted via the arguments
<code>income_origin</code> and <code>income_destination</code>. As country specific effects are subdued due to demeaning, no further unilateral variables apart from incomes can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ddm_+3A_code_origin">code_origin</code></td>
<td>
<p>(Type: character) country of origin variable (e.g. ISO-3 country codes). The variables are grouped
using this parameter.</p>
</td></tr>
<tr><td><code id="ddm_+3A_code_destination">code_destination</code></td>
<td>
<p>(Type: character) country of destination variable (e.g. country ISO-3 codes). The variables are
grouped using this parameter.</p>
</td></tr>
<tr><td><code id="ddm_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ddm_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="ddm_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ddm</code> is an estimation method for gravity models presented
in Head and Mayer (2014).
</p>
<p>Country specific effects are subdued due double demeaning. Hence, unilateral income
proxies such as GDP cannot be considered as exogenous variables.
</p>
<p>Unilateral effect drop out due to double demeaning and therefore cannot be estimated.
</p>
<p><code>ddm</code> is designed to be consistent with the Stata code provided at
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.
</p>
<p>As, to our knowledge at the moment, there is no explicit literature covering
the estimation of a gravity equation by <code>ddm</code> using panel data,
we do not recommend to apply this method in this case.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- ddm(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "comcur", "contig"),
  code_origin = "iso_o",
  code_destination = "iso_d",
  robust = FALSE,
  data = grav_small
)
</code></pre>

<hr>
<h2 id='discard_unusable'>Discard non-positive and/or non-finite observations in datasets</h2><span id='topic+discard_unusable'></span>

<h3>Description</h3>

<p><code>discard_unusable</code> drops observations that cannot be used
with models that convert columns to log scale, and therefore requiere non-negative
and finite observations.
</p>
<p>Consider that some of the functions within this package will drop
observations when required and it is not requiered to be run before fitting a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discard_unusable(data, columns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discard_unusable_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="discard_unusable_+3A_columns">columns</code></td>
<td>
<p>The columns to be cleaned (e.g. <code>c("flow", "distw"))</code> in
the case of <code>ddm</code> when used with the example dataset <code>gravity_zeros</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>discard_unusable(gravity_zeros, "flow")
discard_unusable(gravity_zeros, c("flow", "distw"))
</code></pre>

<hr>
<h2 id='ek_tobit'>Eaton and Kortum (2001) Tobit model (EK Tobit)</h2><span id='topic+ek_tobit'></span>

<h3>Description</h3>

<p><code>ek_tobit</code> estimates gravity models in their additive form
by conducting a censored regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ek_tobit(
  dependent_variable,
  distance,
  additional_regressors = NULL,
  code_destination,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ek_tobit_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This variable is logged and then used as the
dependent variable in the estimation. As the log of zero is not defined, all flows equal to zero are replaced by a left
open interval with the logged minimum trade flow of the respective importing country as right border.</p>
</td></tr>
<tr><td><code id="ek_tobit_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="ek_tobit_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDP should be inserted via the arguments
<code>income_origin</code> and <code>income_destination</code>.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ek_tobit_+3A_code_destination">code_destination</code></td>
<td>
<p>(Type: character) country of destination variable (e.g. country ISO-3 codes). The variables are
grouped using this parameter.</p>
</td></tr>
<tr><td><code id="ek_tobit_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ek_tobit_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="ek_tobit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ek_tobit</code> represents the Eaton and Kortum (2001) Tobit model where each country
is assigned specific censoring bounds.
</p>
<p>When taking the log of the gravity equation flows equal to zero
constitute a problem as their log is not defined. Therefore, in <code>ek_tobit</code> all values of
the dependent variable are redefined as intervals.
</p>
<p>The positive observations have both interval bounds equal to their original value.
</p>
<p>For zero flows the interval is left open. The right border of the interval is set to the
log of the minimum positive trade flow of the respective importing country.
</p>
<p>The defined data object of class <code><a href="survival.html#topic+Surv">Surv</a></code> is then inserted
in <code><a href="survival.html#topic+survreg">survreg</a></code> for the parameter estimation.
</p>
<p><code>ek_tobit</code> is designed to be consistent with the Stata code provided at
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.
</p>
<p>For other Tobit functions, see <code><a href="#topic+tobit">tobit</a></code>
for a simple Tobit model where number <code>1</code> is added to all observations
and <code><a href="#topic+et_tobit">et_tobit</a></code> for the Eaton and Tamura (1995)
threshold Tobit model where instead of simply adding number <code>1</code>
to the data the threshold is estimated.
</p>
<p>The function is designed for cross-sectional data, but can be extended to panel data using the
<code><a href="survival.html#topic+survreg">survreg</a></code> function.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as a
<code><a href="survival.html#topic+survreg">survreg</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+Surv">Surv</a></code>, <code><a href="survival.html#topic+survreg">survreg</a></code>, <code><a href="#topic+tobit">tobit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

grav_small &lt;- grav_small %&gt;%
  mutate(
    flow = ifelse(flow &lt; 5, 0, flow), # cutoff for testing purposes
    lgdp_o = log(gdp_o),
    lgdp_d = log(gdp_d)
  )

fit &lt;- ek_tobit(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("distw", "rta", "lgdp_o", "lgdp_d"),
  code_destination = "iso_d",
  robust = FALSE,
  data = grav_small
)
</code></pre>

<hr>
<h2 id='et_tobit'>Eaton and Tamura (1995) threshold Tobit model (ET Tobit)</h2><span id='topic+et_tobit'></span>

<h3>Description</h3>

<p><code>et_tobit</code> estimates gravity models in their additive form
by conducting a left-censored regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>et_tobit(dependent_variable, distance, additional_regressors = NULL, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="et_tobit_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. Following
Carson and Sun (2007), the smallest positive flow value is used as an estimate of the threshold, this value is is added to the <code>dependent_variable</code>,
the result is logged and taken as the dependent variable in the Tobit estimation with
lower bound equal to the log of the smallest possible flow value.</p>
</td></tr>
<tr><td><code id="et_tobit_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="et_tobit_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDP should be inserted via the arguments
<code>income_origin</code> and <code>income_destination</code>.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="et_tobit_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="et_tobit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>et_tobit</code> represents the Eaton and Tamura (1995) Tobit model
which is often used when several gravity models are compared, instead of adding number <code>1</code> to the dependent
variable as done in <code><a href="#topic+tobit">tobit</a></code>, the constant added to the data is estimated and interpreted as a
threshold.
</p>
<p>When taking the log of the gravity equation flows equal to zero constitute a problem as their
log is not defined. Therefore, a constant is added to the flows.
</p>
<p>Compared to the usual ET-Tobit approaches, in this package, the estimation
of the threshold is done before the other parameters are estimated.
</p>
<p>We follow Carson and Sun (2007), who show that taking the minimum
positive flow value as an estimate of the threshold is super-consistent and that
using this threshold estimate ensures that the parameter MLE are asymptotically normal with
the asymptotic variance identical to the variance achieved when the threshold is known. Hence, first
the threshold is estimated as the minimum positive flow. This threshold is added to the flow variable,
it is logged afterwards and taken as the dependent variable.
</p>
<p>The Tobit estimation is then conducted using the
<code><a href="censReg.html#topic+censReg">censReg</a></code> function and setting the lower bound
equal to the log of the minimum positive flow value which was added to all
observations.
</p>
<p>A Tobit regression represents a combination of a binary and a
linear regression. This procedure has to be taken into consideration when
interpreting the estimated coefficients.
</p>
<p>The marginal effects of an explanatory variable on the expected value of
the dependent variable equals the product of both the probability of the
latent variable exceeding the threshold and the marginal effect of the
explanatory variable of the expected value of the latent variable.
</p>
<p>For a more elaborate Tobit function, see <code><a href="#topic+ek_tobit">ek_tobit</a></code>
for the Eaton and Kortum (2001) Tobit model where each zero trade volume
is assigned a country specific interval with the upper
bound equal to the minimum positive trade level of the respective
importing country.
</p>
<p>The function is designed for cross-sectional data, but can be extended to panel data using the
<code><a href="censReg.html#topic+censReg">censReg</a></code> function.
</p>
<p>A robust estimations is not implemented to the present
as the <code><a href="censReg.html#topic+censReg">censReg</a></code> function is not
compatible with the <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code> function.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as a
<code><a href="censReg.html#topic+censReg">censReg</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="censReg.html#topic+censReg">censReg</a></code>, <code><a href="#topic+et_tobit">et_tobit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

grav_small &lt;- grav_small %&gt;%
  mutate(
    flow = ifelse(flow &lt; 5, 0, flow), # cutoff for testing purposes
    lgdp_o = log(gdp_o),
    lgdp_d = log(gdp_d)
  )

fit &lt;- et_tobit(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "lgdp_o", "lgdp_d"),
  data = grav_small
)
</code></pre>

<hr>
<h2 id='fixed_effects'>Fixed Effects</h2><span id='topic+fixed_effects'></span>

<h3>Description</h3>

<p><code>fixed_effects</code> estimates gravity models via
OLS and fixed effects for the countries of origin and destination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixed_effects(
  dependent_variable,
  distance,
  additional_regressors = NULL,
  code_origin,
  code_destination,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixed_effects_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This variable is logged and then used as
the dependent variable in the estimation.</p>
</td></tr>
<tr><td><code id="fixed_effects_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="fixed_effects_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDPs can be added but those variables have to be
logged first.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="fixed_effects_+3A_code_origin">code_origin</code></td>
<td>
<p>(Type: character) country of origin variable (e.g. ISO-3 country codes). The variables are grouped
using this parameter.</p>
</td></tr>
<tr><td><code id="fixed_effects_+3A_code_destination">code_destination</code></td>
<td>
<p>(Type: character) country of destination variable (e.g. country ISO-3 codes). The variables are
grouped using this parameter.</p>
</td></tr>
<tr><td><code id="fixed_effects_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fixed_effects_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="fixed_effects_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To account for MR terms, Feenstra (2002) and
Feenstra (2015) propose to use
importer and exporter fixed effects. Due to the use of these effects, all
unilateral influences such as GDPs can no longer be estimated.
</p>
<p>A disadvantage of the use of <code>fixed_effects</code> is that, when applied to
panel data, the number of country-year or country-pair fixed effects can be
too high for estimation. In addition, no comparative statistics are
possible with <code>fixed_effects</code> as the Multilateral Resistance terms are not estimated
explicitly. Nevertheless, Head and Mayer (2014) highlight the importance of
the use of fixed effects.
</p>
<p>By including country specific fixed effects, all monadic effects
are captured, including Multilateral Resistance terms.
Therefore, no other unilateral variables such as GDP can be
included as independent variables in the estimation.
</p>
<p><code>fixed_effects</code> estimation can be used for both, cross-sectional as well as
panel data.
</p>
<p>Nonetheless, the function is designed to be consistent with the
Stata code for cross-sectional data provided at the website
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.
</p>
<p>The function <code>fixed_effects</code> was therefore tested for
cross-sectional data. Its up to the user to ensure that the functions can be applied
to panel data.
</p>
<p>Also, note that by including bilateral fixed effects such as country-pair
effects, the coefficients of time-invariant observables such as distance
can no longer be estimated.
</p>
<p>Depending on the specific model, the code of the
respective function might have to be changed in order to exclude the distance
variable from the estimation.
</p>
<p>At the very least, the user should take special
care with respect to the meaning of the estimated coefficients and variances
as well as the decision about which effects to include in the estimation.
</p>
<p>When using panel data, the parameter and variance estimation of the models
may have to be changed accordingly.
</p>
<p>For a comprehensive overview of gravity models for panel data
see Egger and Pfaffermayr (2003), Gómez-Herrera (2013) and
Head et al. (2010) as well as the references therein.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- fixed_effects(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "comcur", "contig"),
  code_origin = "iso_o",
  code_destination = "iso_d",
  robust = FALSE,
  data = grav_small
)
</code></pre>

<hr>
<h2 id='gpml'>Gamma Pseudo Maximum Likelihood (GPML)</h2><span id='topic+gpml'></span>

<h3>Description</h3>

<p><code>gpml</code> estimates gravity models in their
multiplicative form via Gamma Pseudo Maximum Likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gpml(
  dependent_variable,
  distance,
  additional_regressors,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gpml_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This variable is logged and then used as
the dependent variable in the estimation.</p>
</td></tr>
<tr><td><code id="gpml_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="gpml_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDPs can be added but those variables have to be
logged first. Interaction terms can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gpml_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gpml_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="gpml_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gpml</code> is an estimation method for gravity models
belonging to generalized linear models. It is described in Silva and Tenreyro (2006) and the model
is estimated via <code><a href="glm2.html#topic+glm2">glm2</a></code> using the gamma distribution and a log-link.
</p>
<p>For similar functions, utilizing the multiplicative form via the log-link,
but different distributions, see <code><a href="#topic+ppml">ppml</a></code>, <code><a href="#topic+nls">nls</a></code>, and <code><a href="#topic+nbpml">nbpml</a></code>.
</p>
<p><code>gpml</code> estimation can be used for both, cross-sectional as well as
panel data, but its up to the user to ensure that the functions can be applied
to panel data.
</p>
<p>Depending on the panel dataset and the variables -
specifically the type of fixed effects -
included in the model, it may easily occur that the model is not computable.
</p>
<p>Also, note that by including bilateral fixed effects such as country-pair
effects, the coefficients of time-invariant observables such as distance
can no longer be estimated.
</p>
<p>Depending on the specific model, the code of the
respective function might have to be changed in order to exclude the distance
variable from the estimation.
</p>
<p>At the very least, the user should take special
care with respect to the meaning of the estimated coefficients and variances
as well as the decision about which effects to include in the estimation.
</p>
<p>When using panel data, the parameter and variance estimation of the models
may have to be changed accordingly.
</p>
<p>For a comprehensive overview of gravity models for panel data
see Egger and Pfaffermayr (2003), Gómez-Herrera (2013) and
Head et al. (2010).
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model similar to a
<code><a href="stats.html#topic+glm">glm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="glm2.html#topic+glm2">glm2</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

grav_small &lt;- grav_small %&gt;%
  mutate(
    lgdp_o = log(gdp_o),
    lgdp_d = log(gdp_d)
  )

fit &lt;- gpml(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "iso_o", "iso_d"),
  data = grav_small
)
</code></pre>

<hr>
<h2 id='gravity_no_zeros'>
Gravity dataset without zero trade flows
</h2><span id='topic+gravity_no_zeros'></span>

<h3>Description</h3>

<p>An edited version of the full gravity dataset: The &quot;square&quot; gravity dataset for all possible pairs of Countries worldwide, 1948-2006, which is used in the article: Head, K., T. Mayer and J. Ries, 2010, &quot;The erosion of colonial linkages after independence&quot;. Journal of International Economics, 81(1):1-14 (lead article).
Dataset <code>gravity_no_zeros</code> corresponds to the dataset without zero trade flows, <code>gravity_zeros</code>, on the other hand, includes zero trade flows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gravity_no_zeros")</code></pre>


<h3>Format</h3>

<p>A data frame with 17088 observations on the following 10 variables.
</p>

<dl>
<dt><code>iso_o</code></dt><dd><p>ISO-Code of country of origin</p>
</dd>
<dt><code>iso_d</code></dt><dd><p>ISO-Code of country of destination</p>
</dd>
<dt><code>distw</code></dt><dd><p>weighted distance</p>
</dd>
<dt><code>gdp_o</code></dt><dd><p>GDP of country of origin in million dollars</p>
</dd>
<dt><code>gdp_d</code></dt><dd><p>GDP of country of destination in million dollars</p>
</dd>
<dt><code>rta</code></dt><dd><p>regional trade agreement dummy</p>
</dd>
<dt><code>flow</code></dt><dd><p>trade flow in million dollars</p>
</dd>
<dt><code>contig</code></dt><dd><p>contiguity dummy</p>
</dd>
<dt><code>comlang_off</code></dt><dd><p>common official language dummy</p>
</dd>
<dt><code>comcur</code></dt><dd><p>common currency dummy</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://sites.google.com/site/hiegravity/data-sources">https://sites.google.com/site/hiegravity/data-sources</a>
</p>


<h3>References</h3>

<p>Head, K. and Mayer, T. (2014). Chapter 3 - gravity equations: 
Workhorse,toolkit, and cookbook. 
In Gita Gopinath, E. H. and Rogoff, K., editors, 
Handbook of International Economics, volume 4 of Handbook of International 
Economics, pages 131-195. Elsevier.
(<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>)
</p>
<p>Head, K., T. Mayer and J. Ries, 2010, &quot;The erosion od colonial linkages after 
independence&quot;. Journal of International Economics, 81(1):1-14 
(lead article).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(gravity_no_zeros)
  str(gravity_no_zeros)
</code></pre>

<hr>
<h2 id='gravity_zeros'>
Gravity dataset without zero trade flows
</h2><span id='topic+gravity_zeros'></span>

<h3>Description</h3>

<p>An edited version of the full gravity dataset: The &quot;square&quot; gravity dataset for all possible pairs of Countries worldwide, 1948-2006, which is used in the article: Head, K., T. Mayer and J. Ries, 2010, &quot;The erosion of colonial linkages after independence&quot;. Journal of International Economics, 81(1):1-14 (lead article).
Dataset <code>gravity_no_zeros</code> corresponds to the dataset without zero trade flows, <code>gravity_zeros</code>, on the other hand, includes zero trade flows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gravity_zeros")</code></pre>


<h3>Format</h3>

<p>A data frame with 22588 observations on the following 10 variables.
</p>

<dl>
<dt><code>iso_o</code></dt><dd><p>ISO-Code of country of origin</p>
</dd>
<dt><code>iso_d</code></dt><dd><p>ISO-Code of country of destination</p>
</dd>
<dt><code>distw</code></dt><dd><p>weighted distance</p>
</dd>
<dt><code>gdp_o</code></dt><dd><p>GDP of country of origin in million dollars</p>
</dd>
<dt><code>gdp_d</code></dt><dd><p>GDP of country of destination in million dollars</p>
</dd>
<dt><code>rta</code></dt><dd><p>regional trade agreement dummy</p>
</dd>
<dt><code>flow</code></dt><dd><p>trade flow in million dollars</p>
</dd>
<dt><code>contig</code></dt><dd><p>contiguity dummy</p>
</dd>
<dt><code>comlang_off</code></dt><dd><p>common official language dummy</p>
</dd>
<dt><code>comcur</code></dt><dd><p>common currency dummy</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://sites.google.com/site/hiegravity/data-sources">https://sites.google.com/site/hiegravity/data-sources</a>
</p>


<h3>References</h3>

<p>Head, K. and Mayer, T. (2014). Chapter 3 - gravity equations: 
Workhorse,toolkit, and cookbook. 
In Gita Gopinath, E. H. and Rogoff, K., editors, 
Handbook of International Economics, volume 4 of Handbook of International 
Economics, pages 131-195. Elsevier.
(<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>)
</p>
<p>Head, K., T. Mayer and J. Ries, 2010, &quot;The erosion od colonial linkages after 
independence&quot;. Journal of International Economics, 81(1):1-14 
(lead article).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(gravity_zeros)
  str(gravity_zeros)
</code></pre>

<hr>
<h2 id='gravity-exports'>gravity exported operators and S3 methods
The following functions are imported and then re-exported
from the gravity package to avoid listing Depends of gravity.</h2><span id='topic+gravity-exports'></span>

<h3>Description</h3>

<p>gravity exported operators and S3 methods
The following functions are imported and then re-exported
from the gravity package to avoid listing Depends of gravity.
</p>

<hr>
<h2 id='hm_summary'>Head and Mayer consistent summary statistics</h2><span id='topic+hm_summary'></span>

<h3>Description</h3>

<p>Summary of estimates function that, if is used with default options, provides estimation results are
consistent with the Stata methods used in Head and Mayer (2014). This function is adapted from the work of
<a href="https://github.com/IsidoreBeautrelet/">Isidore Beautrelet</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hm_summary(model, robust = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hm_summary_+3A_model">model</code></td>
<td>
<p>(Type: lm) Regression object obtained by using the estimation methods from this package
or a generic method such as <code>lm</code> or <code>glm</code>.
Some particular classes (<code>gpml</code>, <code>nbpml</code>, <code>negbin</code> and <code>nls</code>) don't return R squared and
F statistic.</p>
</td></tr>
<tr><td><code id="hm_summary_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) Determines whether a robust
variance-covariance matrix should be used. By default is set to <code>FALSE</code>.
</p>
<p>If set <code>TRUE</code> the estimation results are consistent with the
Stata code provided at the website
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.</p>
</td></tr>
<tr><td><code id="hm_summary_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>tobit</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary <code>lm</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

# Using OLS for testing
fit &lt;- ols(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "contig", "comcur"),
  income_origin = "gdp_o",
  income_destination = "gdp_d",
  code_origin = "iso_o",
  code_destination = "iso_d",
  uie = FALSE,
  robust = FALSE,
  data = grav_small
)

fit2 &lt;- hm_summary(fit, robust = FALSE)
</code></pre>

<hr>
<h2 id='log_distance'>Apply logarithm to distance column</h2><span id='topic+log_distance'></span>

<h3>Description</h3>

<p><code>log_distance</code> creates a new <code>dist_log</code>
column in log scale by taking the original distance column in the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_distance(data, distance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_distance_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="log_distance_+3A_distance">distance</code></td>
<td>
<p>The distance column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>log_distance(gravity_zeros, "distw")
</code></pre>

<hr>
<h2 id='nbpml'>Negative Binomial Pseudo Maximum Likelihood (NBPML)</h2><span id='topic+nbpml'></span>

<h3>Description</h3>

<p><code>nbpml</code> estimates gravity models in their
multiplicative form via Negative Binomial Pseudo Maximum Likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbpml(
  dependent_variable,
  distance,
  additional_regressors,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbpml_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This variable is logged and then used as
the dependent variable in the estimation.</p>
</td></tr>
<tr><td><code id="nbpml_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="nbpml_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDPs can be added but those variables have to be
logged first. Interaction terms can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="nbpml_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="nbpml_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="nbpml_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>nbpml</code> is an estimation method for gravity models
belonging to generalized linear models. It is estimated via <code><a href="MASS.html#topic+glm.nb">glm.nb</a></code>
using the negative binomial distribution and a log-link.
</p>
<p>For similar functions, utilizing the multiplicative form via the log-link,
but different distributions, see <code><a href="#topic+nbpml">nbpml</a></code>, <code><a href="#topic+gpml">gpml</a></code>,
and <code><a href="#topic+nls">nls</a></code>.
</p>
<p><code>gpml</code> estimation can be used for both, cross-sectional as well as
panel data, but its up to the user to ensure that the functions can be applied
to panel data.
</p>
<p>Depending on the panel dataset and the variables -
specifically the type of fixed effects -
included in the model, it may easily occur that the model is not computable.
</p>
<p>Also, note that by including bilateral fixed effects such as country-pair
effects, the coefficients of time-invariant observables such as distance
can no longer be estimated.
</p>
<p>Depending on the specific model, the code of the
respective function may has to be changed in order to exclude the distance
variable from the estimation.
</p>
<p>At the very least, the user should take special
care with respect to the meaning of the estimated coefficients and variances
as well as the decision about which effects to include in the estimation.
When using panel data, the parameter and variance estimation of the models
may have to be changed accordingly.
</p>
<p>For a comprehensive overview of gravity models for panel data
see Egger and Pfaffermayr (2003), Gómez-Herrera (2013) and
Head et al. (2010).
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model similar to a
<code><a href="stats.html#topic+glm">glm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+glm.nb">glm.nb</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 3 countries for testing
countries_chosen &lt;- c("AUS", "GBR", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- nbpml(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "iso_o", "iso_d"),
  data = grav_small
)
</code></pre>

<hr>
<h2 id='nls'>Non-linear Least Squares (NLS)</h2><span id='topic+nls'></span>

<h3>Description</h3>

<p><code>nls</code> estimates gravity models in their
multiplicative form via Nonlinear Least Squares.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nls(dependent_variable, distance, additional_regressors = NULL, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nls_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This variable is logged and then used as
the dependent variable in the estimation.</p>
</td></tr>
<tr><td><code id="nls_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="nls_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDPs can be added but those variables have to be
logged first. Interaction terms can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="nls_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="nls_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>nls</code> is an estimation method for gravity models
belonging to generalized linear models. It is estimated via <code><a href="stats.html#topic+glm">glm</a></code> using the gaussian
distribution and a log-link.
</p>
<p>As the method may not lead to convergence when poor
starting values are used, the linear predictions, fitted values,
and estimated coefficients resulting from a
<code><a href="#topic+ppml">ppml</a></code> estimation are used for the arguments
<code>etastart</code>, <code>mustart</code>, and <code>start</code>.
</p>
<p>For similar functions, utilizing the multiplicative form via the log-link,
but different distributions, see <code><a href="#topic+ppml">ppml</a></code>, <code><a href="#topic+gpml">gpml</a></code>,
and <code><a href="#topic+nbpml">nbpml</a></code>.
</p>
<p><code>nls</code> estimation can be used for both, cross-sectional as well as
panel data, but its up to the user to ensure that the functions can be applied
to panel data.
</p>
<p>Depending on the panel dataset and the variables -
specifically the type of fixed effects -
included in the model, it may easily occur that the model is not computable.
</p>
<p>Also, note that by including bilateral fixed effects such as country-pair
effects, the coefficients of time-invariant observables such as distance
can no longer be estimated.
</p>
<p>Depending on the specific model, the code of the
respective function may has to be changed in order to exclude the distance
variable from the estimation.
</p>
<p>At the very least, the user should take special
care with respect to the meaning of the estimated coefficients and variances
as well as the decision about which effects to include in the estimation.
When using panel data, the parameter and variance estimation of the models
may have to be changed accordingly.
</p>
<p>For a comprehensive overview of gravity models for panel data
see Egger and Pfaffermayr (2003), Gómez-Herrera (2013) and
Head et al. (2010) as well as the references therein.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model similar to a
<code><a href="stats.html#topic+glm">glm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

grav_small &lt;- grav_small %&gt;%
  mutate(
    lgdp_o = log(gdp_o),
    lgdp_d = log(gdp_d)
  )

fit &lt;- nls(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "lgdp_o", "lgdp_d"),
  data = grav_small
)
</code></pre>

<hr>
<h2 id='ols'>Ordinary Least Squares (OLS)</h2><span id='topic+ols'></span>

<h3>Description</h3>

<p><code>ols</code> estimates gravity models in their traditional form
via Ordinary Least Squares (ols). It does not consider Multilateral
Resistance terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ols(
  dependent_variable,
  distance,
  additional_regressors = NULL,
  income_origin,
  income_destination,
  code_origin,
  code_destination,
  uie = FALSE,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ols_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable.
</p>
<p>If <code>uie = TRUE</code> the dependent variable is divided by the product of
unilateral incomes (e.g. <code>income_origin</code> and <code>income_destination</code>) and logged afterwards.
</p>
<p>If <code>uie=FALSE</code> the dependent variable is logged directly. The transformed variable is then used as
the dependent variable and the logged income variables are used as independent variables in the
estimation.</p>
</td></tr>
<tr><td><code id="ols_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="ols_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDPs can be added but those variables have to be
logged first. Interaction terms can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ols_+3A_income_origin">income_origin</code></td>
<td>
<p>(Type: character) origin income variable (e.g. GDP) in the dataset.</p>
</td></tr>
<tr><td><code id="ols_+3A_income_destination">income_destination</code></td>
<td>
<p>(Type: character) destination income variable (e.g. GDP) in the dataset.</p>
</td></tr>
<tr><td><code id="ols_+3A_code_origin">code_origin</code></td>
<td>
<p>(Type: character) country of origin variable (e.g. ISO-3 country codes). The variables are grouped
using this parameter.</p>
</td></tr>
<tr><td><code id="ols_+3A_code_destination">code_destination</code></td>
<td>
<p>(Type: character) country of destination variable (e.g. country ISO-3 codes). The variables are
grouped using this parameter.</p>
</td></tr>
<tr><td><code id="ols_+3A_uie">uie</code></td>
<td>
<p>(Type: logical) Dtermines whether the
parameters are to be estimated assuming unitary income elasticities. The default value is set
to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ols_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ols_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="ols_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ols</code> estimates gravity models in their traditional, additive,
form via Ordinary Least Squares using the <code>lm</code> function.
Multilateral Resistance terms are not considered by this function.
</p>
<p>As the coefficients for the country's incomes were often found to be close to
unitary and unitary income elasticities are in line with some theoretical
foundations on international trade, it is sometimes assumed that the income
elasticities are equal to unity.
</p>
<p>In order to allow for the estimation with
and without the assumption of unitary income elasticities, the option
<code>uie</code> is built into <code>ols</code> with the default set to <code>FALSE</code>.
</p>
<p><code>ols</code> estimation can be used for both, cross-sectional and
panel data. Nonetheless, the function is designed to be consistent with the
Stata code for cross-sectional data provided at the website
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.
</p>
<p>The function <code>ols</code> was therefore tested for cross-sectional data. For the use with panel data
no tests were performed. Therefore, it is up to the user to ensure that the functions can be applied
to panel data.
</p>
<p>Depending on the panel dataset and the variables -
specifically the type of fixed effects -
included in the model, it may easily occur that the model is not computable.
Also, note that by including bilateral fixed effects such as country-pair
effects, the coefficients of time-invariant observables such as distance
can no longer be estimated.
</p>
<p>Depending on the specific model, the code of the
respective function may has to be changed in order to exclude the distance
variable from the estimation.
</p>
<p>At the very least, the user should take special
care with respect to the meaning of the estimated coefficients and variances
as well as the decision about which effects to include in the estimation.
When using panel data, the parameter and variance estimation of the models
may have to be changed accordingly.
</p>
<p>For a comprehensive overview of gravity models for panel data
see Egger and Pfaffermayr (2003), Gómez-Herrera (2013) and
Head et al. (2010) as well as the references therein.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- ols(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "contig", "comcur"),
  income_origin = "gdp_o",
  income_destination = "gdp_d",
  code_origin = "iso_o",
  code_destination = "iso_d",
  uie = FALSE,
  robust = FALSE,
  data = grav_small
)
</code></pre>

<hr>
<h2 id='ppml'>Poisson Pseudo Maximum Likelihood (PPML)</h2><span id='topic+ppml'></span>

<h3>Description</h3>

<p><code>ppml</code> estimates gravity models in their
multiplicative form via Poisson Pseudo Maximum Likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppml(
  dependent_variable,
  distance,
  additional_regressors,
  robust = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppml_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This variable is used as
the dependent variable in the estimation.</p>
</td></tr>
<tr><td><code id="ppml_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="ppml_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDPs can be added but those variables have to be
logged first. Interaction terms can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ppml_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ppml_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="ppml_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ppml</code> is an estimation method for gravity models
belonging to generalized linear models. It is estimated via <code><a href="stats.html#topic+glm">glm</a></code> using the quasipoisson
distribution and a log-link. <code>ppml</code> is presented in Silva and Tenreyro (2006).
</p>
<p>For similar functions, utilizing the multiplicative form via the log-link,
but different distributions, see <code><a href="#topic+gpml">gpml</a></code>, <code><a href="#topic+nls">nls</a></code>,
and <code><a href="#topic+nbpml">nbpml</a></code>.
</p>
<p><code>ppml</code> estimation can be used for both, cross-sectional as well as
panel data. The function is designed to be consistent with the
results from the Stata function <code>ppml</code> written by Silva and Tenreyro (2006).
</p>
<p>The function <code>ols</code> was therefore tested for cross-sectional data. For the use with panel data
no tests were performed. Therefore, it is up to the user to ensure that the functions can be applied
to panel data.
</p>
<p>Depending on the panel dataset and the variables -
specifically the type of fixed effects -
included in the model, it may easily occur that the model is not computable.
Also, note that by including bilateral fixed effects such as country-pair
effects, the coefficients of time-invariant observables such as distance
can no longer be estimated.
</p>
<p>Depending on the specific model, the code of the
respective function may has to be changed in order to exclude the distance
variable from the estimation.
</p>
<p>At the very least, the user should take special
care with respect to the meaning of the estimated coefficients and variances
as well as the decision about which effects to include in the estimation.
When using panel data, the parameter and variance estimation of the models
may have to be changed accordingly.
</p>
<p>For a comprehensive overview of gravity models for panel data
see Egger and Pfaffermayr (2003), Gómez-Herrera (2013) and
Head et al. (2010) as well as the references therein.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+glm">glm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- ppml(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "iso_o", "iso_d"),
  data = grav_small
)
</code></pre>

<hr>
<h2 id='sils'>Structural Iterated Least Squares (SILS)</h2><span id='topic+sils'></span>

<h3>Description</h3>

<p><code>sils</code> estimates gravity models via
Structural Iterated Least Squares and an explicit inclusion
of the Multilateral Resistance terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sils(
  dependent_variable,
  distance,
  additional_regressors = NULL,
  income_origin,
  income_destination,
  code_origin,
  code_destination,
  maxloop = 100,
  decimal_places = 4,
  robust = FALSE,
  verbose = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sils_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This dependent variable is
divided by the product of unilateral incomes such (i.e. <code>income_origin</code> and <code>income_destination</code>)
and logged afterwards.</p>
</td></tr>
<tr><td><code id="sils_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="sils_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDP should be inserted via the arguments
<code>income_origin</code> and <code>income_destination</code>. As country specific effects are subdued due to demeaning, no further unilateral variables apart from incomes can be added.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="sils_+3A_income_origin">income_origin</code></td>
<td>
<p>(Type: character) origin income variable (e.g. GDP) in the dataset.</p>
</td></tr>
<tr><td><code id="sils_+3A_income_destination">income_destination</code></td>
<td>
<p>(Type: character) destination income variable (e.g. GDP) in the dataset.</p>
</td></tr>
<tr><td><code id="sils_+3A_code_origin">code_origin</code></td>
<td>
<p>(Type: character) country of origin variable (e.g. ISO-3 country codes). The variables are grouped
using this parameter.</p>
</td></tr>
<tr><td><code id="sils_+3A_code_destination">code_destination</code></td>
<td>
<p>(Type: character) country of destination variable (e.g. country ISO-3 codes). The variables are
grouped using this parameter.</p>
</td></tr>
<tr><td><code id="sils_+3A_maxloop">maxloop</code></td>
<td>
<p>(Type: numeric) maximum number of outer loop iterations.
The default is set to 100. There will be a warning if the iterations
did not converge.</p>
</td></tr>
<tr><td><code id="sils_+3A_decimal_places">decimal_places</code></td>
<td>
<p>(Type: numeric) number of decimal places that should not change after a new
iteration for the estimation to stop. The default is set to 4.</p>
</td></tr>
<tr><td><code id="sils_+3A_robust">robust</code></td>
<td>
<p>(Type: logical) whether robust fitting should be used. By default this is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="sils_+3A_verbose">verbose</code></td>
<td>
<p>(Type: logical) determines whether the estimated coefficients
of each iteration should be printed in the console. The default is set
to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="sils_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="sils_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sils</code> is an estimation method for gravity models
developed by Head and Mayer (2014).
</p>
<p>The function <code>sils</code> utilizes the relationship between the Multilateral
Resistance terms and the transaction costs. The parameters are estimated by
an iterative procedure. The function executes loops until the parameters
stop changing significantly.
</p>
<p><code>sils</code> is designed to be consistent with the Stata code provided at
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.
</p>
<p>As, to our knowledge at the moment, there is no explicit literature covering
the estimation of a gravity equation by <code>sils</code> using panel data,
and we do not recommend to apply this method in this case.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object. It furthermore returns the resulting coefficients for each
iteration.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
<code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- sils(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = "rta",
  income_origin = "gdp_o",
  income_destination = "gdp_d",
  code_origin = "iso_o",
  code_destination = "iso_d",
  maxloop = 50,
  dec_places = 3,
  robust = FALSE,
  verbose = FALSE,
  data = grav_small
)
</code></pre>

<hr>
<h2 id='tetrads'>Tetrads</h2><span id='topic+tetrads'></span>

<h3>Description</h3>

<p><code>tetrads</code> estimates gravity models
by taking the ratio of the ratio of flows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tetrads(
  dependent_variable,
  distance,
  additional_regressors,
  code_origin,
  code_destination,
  filter_origin = NULL,
  filter_destination = NULL,
  multiway = FALSE,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tetrads_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. This variable is logged and then used as
the dependent variable in the estimation.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDP should be inserted via the arguments
<code>income_origin</code> and <code>income_destination</code>.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_code_origin">code_origin</code></td>
<td>
<p>(Type: character) country of origin variable (e.g. ISO-3 country codes). The variables are grouped
using this parameter.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_code_destination">code_destination</code></td>
<td>
<p>(Type: character) country of destination variable (e.g. country ISO-3 codes). The variables are
grouped using this parameter.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_filter_origin">filter_origin</code></td>
<td>
<p>(Type: character) Reference exporting country.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_filter_destination">filter_destination</code></td>
<td>
<p>(Type: character) Reference importing country.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_multiway">multiway</code></td>
<td>
<p>(Type: logical) in case <code>multiway = TRUE</code>, the
<code><a href="multiwayvcov.html#topic+cluster.vcov">cluster.vcov</a></code> function is used for estimation following
Cameron et al. (2011) multi-way clustering of
variance-covariance matrices. The default value is set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="tetrads_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>tetrads</code> is an estimation method for gravity models
developed by Head et al. (2010).
</p>
<p>The function <code>tetrads</code> utilizes the multiplicative form of the
gravity equation. After choosing a reference exporter <code>A</code> and
importer <code>B</code> one can eliminate importer and exporter fixed effects
by taking the ratio of ratios.
</p>
<p>Only those exporters trading with the
reference importer and importers trading with the reference exporter will
remain for the estimation. Therefore, reference countries should
preferably be countries which trade with every other country in the dataset.
</p>
<p>After restricting the data in this way, <code>tetrads</code> estimates the gravity
equation in its additive form by OLS.
</p>
<p>By taking the ratio of ratios, all monadic effects diminish, hence no
unilateral variables such as GDP can be included as independent variables.
</p>
<p><code>tetrads</code> estimation can be used for both, cross-sectional as well as
panel data. Nonetheless, the function is designed to be consistent with the
Stata code for cross-sectional data provided on the website
<a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a>
when choosing robust estimation.
</p>
<p>The function <code>tetrads</code> was therefore tested for cross-sectional data.
</p>
<p>If tetrads is used for panel data, the user may have to drop distance as an
independent variable as time-invariant effects drop.
</p>
<p>For applying <code>tetrads</code> to panel data see Head et al. (2010).
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as an
<code><a href="stats.html#topic+lm">lm</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="lmtest.html#topic+coeftest">coeftest</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

fit &lt;- tetrads(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = "rta",
  code_origin = "iso_o",
  code_destination = "iso_d",
  filter_origin = countries_chosen[1],
  filter_destination = countries_chosen[2],
  data = grav_small
)
</code></pre>

<hr>
<h2 id='tobit'>Left-censored Tobit model with known threshold</h2><span id='topic+tobit'></span>

<h3>Description</h3>

<p><code>tobit</code> estimates gravity models in their additive form
by conducting a left-censored regression, which, after adding the
constant <code>1</code> to the dependent variable, utilizes <code>log(1) = 0</code>
as the censoring value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tobit(
  dependent_variable,
  distance,
  additional_regressors = NULL,
  added_constant = 1,
  data,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tobit_+3A_dependent_variable">dependent_variable</code></td>
<td>
<p>(Type: character) name of the dependent variable. The number <code>1</code> is added and the
transformed variable is logged and taken as the dependent variable in the tobit estimation with lower bound
equal to <code>0</code> as <code>log(1) = 0</code> represents the smallest flows
in the transformed variable.</p>
</td></tr>
<tr><td><code id="tobit_+3A_distance">distance</code></td>
<td>
<p>(Type: character) name of the distance variable that should be taken as the key independent variable
in the estimation. The distance is logged automatically when the function is executed.</p>
</td></tr>
<tr><td><code id="tobit_+3A_additional_regressors">additional_regressors</code></td>
<td>
<p>(Type: character) names of the additional regressors to include in the model (e.g. a dummy
variable to indicate contiguity). Unilateral metric variables such as GDP should be inserted via the arguments
<code>income_origin</code> and <code>income_destination</code>.
</p>
<p>Write this argument as <code>c(contiguity, common currency, ...)</code>. By default this is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="tobit_+3A_added_constant">added_constant</code></td>
<td>
<p>(Type: numeric) the constant to be added to the dependent variable. The default value
is <code>1</code>. The minimum of <code>log(y + added_constant)</code> is taken as the
left boundary in the Tobit model.
</p>
<p>In the often used case of <code>added_constant = 1</code>, the dependent variable is left-censored at value <code>0</code>
as <code>log(1) = 0</code>.</p>
</td></tr>
<tr><td><code id="tobit_+3A_data">data</code></td>
<td>
<p>(Type: data.frame) the dataset to be used.</p>
</td></tr>
<tr><td><code id="tobit_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>tobit</code> represents the left-censored tobit Tobin (1958)
approach utilizing a known censoring threshold
which is often used when several gravity models are compared.
</p>
<p>When taking the log of the gravity equation flows equal to zero
constitute a problem as their log is not defined.
</p>
<p>Therefore, in the execution of the function the number <code>1</code>
is added to all flows and the <code>log(flows+1)</code> is
taken as the dependent variable.
</p>
<p>The tobit estimation is conducted using the <code><a href="censReg.html#topic+censReg">censReg</a></code>
function and setting the lower bound equal to <code>0</code> as
<code>log(1)=0</code> represents the smallest flows in the transformed
variable.
</p>
<p>A tobit regression represents a combination of a binary and a
linear regression.
</p>
<p>This procedure has to be taken into consideration when
interpreting the estimated coefficients.
</p>
<p>The marginal effects of an explanatory variable on the expected value of
the dependent variable equals the product of both the probability of the
latent variable exceeding the threshold and the marginal effect of the
explanatory variable of the expected value of the latent variable.
</p>
<p>The function is designed for cross-sectional data,
but can be easily extended to panel data using the
<code><a href="censReg.html#topic+censReg">censReg</a></code> function.
</p>
<p>A robust estimations is not implemented to the present
as the <code><a href="censReg.html#topic+censReg">censReg</a></code> function is not
compatible with the <code><a href="sandwich.html#topic+vcovHC">vcovHC</a></code> function.
</p>
<p>For a more elaborate Tobit function, see <code><a href="#topic+ek_tobit">ek_tobit</a></code>
for the Eaton and Kortum (2001) Tobit model where each zero trade volume
is assigned a country specific interval with the upper
bound equal to the minimum positive trade level of the respective
importing country.
</p>


<h3>Value</h3>

<p>The function returns the summary of the estimated gravity model as a
<code><a href="censReg.html#topic+censReg">censReg</a></code>-object.
</p>


<h3>References</h3>

<p>For more information on gravity models, theoretical foundations and
estimation methods in general see
</p>
<p>Anderson JE (1979).
&ldquo;A Theoretical Foundation for the Gravity Equation.&rdquo;
<em>The American Economic Review</em>, <b>69</b>(1), 106&ndash;116.
ISSN 00028282.
</p>
<p>Anderson JE, van Wincoop E (2001).
&ldquo;Gravity with Gravitas: A Solution to the Border Puzzle.&rdquo;
Working Paper 8079, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w8079">doi:10.3386/w8079</a>.
</p>
<p>Anderson JE (2010).
&ldquo;The Gravity Model.&rdquo;
Working Paper 16576, National Bureau of Economic Research.
<a href="https://doi.org/10.3386/w16576">doi:10.3386/w16576</a>.
</p>
<p>Baier SL, Bergstrand JH (2009).
&ldquo;Bonus vetus OLS: A simple method for approximating international trade-cost effects using the gravity equation.&rdquo;
<em>Journal of International Economics</em>, <b>77</b>(1), 77 - 85.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2008.10.004">doi:10.1016/j.jinteco.2008.10.004</a>.
</p>
<p>Baier SL, Bergstrand JH (2010).
&ldquo;The Gravity Model in International Trade: Advances and Applications.&rdquo;
In van Bergeijk PAG, Brakman S (eds.), chapter 4.
Cambridge University Press.
<a href="https://doi.org/10.1017/CBO9780511762109">doi:10.1017/CBO9780511762109</a>.
</p>
<p>Feenstra RC (2002).
&ldquo;Border effects and the gravity equation: consistent methods for estimation.&rdquo;
<em>Scottish Journal of Political Economy</em>, <b>49</b>(5), 491&ndash;506.
</p>
<p>Head K, Mayer T, Ries J (2010).
&ldquo;The erosion of colonial trade linkages after independence.&rdquo;
<em>Journal of International Economics</em>, <b>81</b>(1), 1 - 14.
ISSN 0022-1996, <a href="https://doi.org/10.1016/j.jinteco.2010.01.002">doi:10.1016/j.jinteco.2010.01.002</a>.
</p>
<p>Head K, Mayer T (2014).
&ldquo;Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.&rdquo;
In Gopinath G, Helpman E, Rogoff K (eds.), <em>Handbook of International Economics</em>, volume 4 of <em>Handbook of International Economics</em>, 131 - 195.
Elsevier.
<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">doi:10.1016/B978-0-444-54314-1.00003-3</a>.
</p>
<p>Silva JMCS, Tenreyro S (2006).
&ldquo;The Log of Gravity.&rdquo;
<em>The Review of Economics and Statistics</em>, <b>88</b>(4), 641-658.
<a href="https://doi.org/10.1162/rest.88.4.641">doi:10.1162/rest.88.4.641</a>.
</p>
<p>and the citations therein.
</p>
<p>See <a href="https://sites.google.com/site/hiegravity/">Gravity Equations: Workhorse, Toolkit, and Cookbook</a> for gravity datasets and Stata code for estimating gravity models.
</p>
<p>For estimating gravity equations using panel data see
</p>
<p>Egger P, Pfaffermayr M (2003).
&ldquo;The proper panel econometric specification of the gravity equation: A three-way model with bilateral interaction effects.&rdquo;
<em>Empirical Economics</em>, <b>28</b>(3), 571&ndash;580.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s001810200146">doi:10.1007/s001810200146</a>.
</p>
<p>Gómez-Herrera E (2013).
&ldquo;Comparing alternative methods to estimate gravity models of bilateral trade.&rdquo;
<em>Empirical Economics</em>, <b>44</b>(3), 1087&ndash;1111.
ISSN 1435-8921, <a href="https://doi.org/10.1007/s00181-012-0576-2">doi:10.1007/s00181-012-0576-2</a>.
</p>
<p>and the references therein.
</p>


<h3>See Also</h3>

<p><code><a href="censReg.html#topic+censReg">censReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for CRAN checks:
# Executable in &lt; 5 sec
library(dplyr)
data("gravity_no_zeros")

# Choose 5 countries for testing
countries_chosen &lt;- c("AUS", "CHN", "GBR", "BRA", "CAN")
grav_small &lt;- filter(gravity_no_zeros, iso_o %in% countries_chosen)

grav_small &lt;- grav_small %&gt;%
  mutate(
    lgdp_o = log(gdp_o),
    lgdp_d = log(gdp_d)
  )

fit &lt;- tobit(
  dependent_variable = "flow",
  distance = "distw",
  additional_regressors = c("rta", "lgdp_o", "lgdp_d"),
  added_constant = 1,
  data = grav_small
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
