<!DOCTYPE html><html lang="en"><head><title>Help for package capn</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {capn}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aproxdef'><p>Defining Approximation Space</p></a></li>
<li><a href='#catch'><p>catch function of GOM dataset</p></a></li>
<li><a href='#chebbasisgen'><p>Generating Unidimensional Chebyshev polynomial (monomial) basis</p></a></li>
<li><a href='#chebgrids'><p>Generating Chebyshev grids</p></a></li>
<li><a href='#chebnodegen'><p>Unidimensional Chebyshev nodes</p></a></li>
<li><a href='#dsdotds'><p>first derivative function of sdot in GOM dataset</p></a></li>
<li><a href='#dsdotdss'><p>second derivative function of sdot in GOM dataset</p></a></li>
<li><a href='#dwds'><p>first derivative function of profit in GOM dataset</p></a></li>
<li><a href='#dwdss'><p>second derivative function of profit in GOM dataset</p></a></li>
<li><a href='#effort'><p>effort function of GOM dataset</p></a></li>
<li><a href='#GOM'><p>Reef Fish example: one dimensional stock</p></a></li>
<li><a href='#LV'><p>Prey-Predator (Lotka-Volterra) example: two stocks</p></a></li>
<li><a href='#lvaproxdata'><p>Prey-Predator (Lotka-Volterra) example in LV dataset</p></a></li>
<li><a href='#lvsimdata.time'><p>Prey-Predator (Lotka-Volterra) example in LV dataset</p></a></li>
<li><a href='#paprox'><p>Calculating P-approximation coefficients</p></a></li>
<li><a href='#param'><p>the parameter vector adopted in GOM dataset</p></a></li>
<li><a href='#pdotaprox'><p>Calculating Pdot-approximation coefficients</p></a></li>
<li><a href='#pdotsim'><p>Simulation of Pdot-approximation</p></a></li>
<li><a href='#plotgen'><p>Plot Generator for Shadow Price or Value Function</p></a></li>
<li><a href='#profit'><p>profit function in GOM dataset</p></a></li>
<li><a href='#psim'><p>Simulation of P-approximation</p></a></li>
<li><a href='#sdot'><p>growth function of GOM dataset</p></a></li>
<li><a href='#unigrids'><p>Generating unifrom grids</p></a></li>
<li><a href='#vaprox'><p>Calculating V-approximation coefficients</p></a></li>
<li><a href='#vsim'><p>Simulation of V-approximation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Capital Asset Pricing for Nature</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-06-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Seong Do Yun [aut, cre],
  Eli P. Fenichel [aut, ctb],
  Joshua K. Abbott [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Seong Do Yun &lt;seongdo.yun@yale.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements approximation methods for natural capital asset prices suggested by Fenichel and Abbott (2014) &lt;<a href="https://doi.org/10.1086%2F676034">doi:10.1086/676034</a>&gt; in Journal of the Associations of Environmental and Resource Economists (JAERE), Fenichel et al. (2016) &lt;<a href="https://doi.org/10.1073%2Fpnas.1513779113">doi:10.1073/pnas.1513779113</a>&gt; in Proceedings of the National Academy of Sciences (PNAS), and Yun et al. (2017) in PNAS (accepted), and their extensions: creating Chebyshev polynomial nodes and grids, calculating basis of Chebyshev polynomials, approximation and their simulations for: V-approximation (single and multiple stocks, PNAS), P-approximation (single stock, PNAS), and Pdot-approximation (single stock, JAERE). Development of this package was generously supported by the Knobloch Family Foundation.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-06-04 15:45:59 UTC; sy382</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-06-05 17:48:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aproxdef'>Defining Approximation Space</h2><span id='topic+aproxdef'></span>

<h3>Description</h3>

<p>The function defines an approximation space for all three approximation apporoaches (V, P, and Pdot).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aproxdef(deg, lb, ub, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aproxdef_+3A_deg">deg</code></td>
<td>
<p>An array of degrees of approximation function: degrees of Chebyshev polynomials</p>
</td></tr>
<tr><td><code id="aproxdef_+3A_lb">lb</code></td>
<td>
<p>An array of lower bounds</p>
</td></tr>
<tr><td><code id="aproxdef_+3A_ub">ub</code></td>
<td>
<p>An array of upper bounds</p>
</td></tr>
<tr><td><code id="aproxdef_+3A_delta">delta</code></td>
<td>
<p>discount rate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code class="reqn">i</code>-th dimension of <code class="reqn">i = 1, 2, \cdots, d</code>, suppose a polynomial approximant
<code class="reqn">s_{i}</code> over a bounded interval <code class="reqn">[a_{i},b_{i}]</code> is defined by Chebysev nodes. Then, a <code class="reqn">d</code>-dimensional
Chebyshev grids can be defined as:<br />
<br />
<code class="reqn">\mathbf{S} = \left\{ (s_{1},s_{2},\cdots,s_{d}) \vert a_{i} \leq s_{1} \leq b_{i}, i = 1, 2, \cdots, d \right\} </code>.<br />
<br />
Suppose we impletement <code class="reqn">n_{i}</code> numbers of polynomials (i.e., <code class="reqn">(n_{i}-1)</code>-th order) for the <code class="reqn">i</code>-th dimension.
The approximation space is defined as:<br />
<br />
deg = c(<code class="reqn">n_{1},n_{2},\cdots,n_{d}</code>),<br />
lb = c(<code class="reqn">a_{1},a_{2},\cdots,a_{d}</code>), and<br />
ub = c(<code class="reqn">b_{1},b_{2},\cdots,b_{d}</code>).<br />
<br />
<code>delta</code> is the given constant discount rate.
</p>


<h3>Value</h3>

<p>A list containing the approximation space
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vaprox">vaprox</a>, <a href="#topic+vsim">vsim</a>, <a href="#topic+paprox">paprox</a>, <a href="#topic+psim">psim</a>, <a href="#topic+pdotaprox">pdotaprox</a>, <a href="#topic+pdotsim">pdotsim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Reef-fish example: see Fenichel and Abbott (2014)
delta &lt;- 0.02
upper &lt;- 359016000     # upper bound on approximation space
lower &lt;- 5*10^6        # lower bound on approximation space
myspace &lt;- aproxdef(50,lower,upper,delta)
## Two dimensional example
ub &lt;- c(1.5,1.5)
lb &lt;- c(0.1,0.1)
deg &lt;- c(20,20)
delta &lt;- 0.03
myspace &lt;- aproxdef(deg,lb,ub,delta)
</code></pre>

<hr>
<h2 id='catch'>catch function of GOM dataset</h2><span id='topic+catch'></span>

<h3>Description</h3>

<p>The function calulates the catchment in the reef-fishy example of GOM dataset (Fenichel and Abbott, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catch(s,Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="catch_+3A_s">s</code></td>
<td>
<p>stock</p>
</td></tr>
<tr><td><code id="catch_+3A_z">Z</code></td>
<td>
<p>parameter vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This catch function is adopted in <code>GOM</code> dataset.
</p>


<h3>Value</h3>

<p>Quantity of catchment
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='chebbasisgen'>Generating Unidimensional Chebyshev polynomial (monomial) basis</h2><span id='topic+chebbasisgen'></span>

<h3>Description</h3>

<p>The function calculates the monomial basis of Chebyshev polynomials for the given unidimensional nodes,
<code class="reqn">s_{i}</code>, over a bounded interval [a,b].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chebbasisgen(stock, npol, a, b, dorder = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chebbasisgen_+3A_stock">stock</code></td>
<td>
<p>An array of Chebyshev polynomial nodes <code class="reqn">s_{i}</code> <br />
(an array of stocks in <code>capn</code>-packages)</p>
</td></tr>
<tr><td><code id="chebbasisgen_+3A_npol">npol</code></td>
<td>
<p>Number of polynomials (n polynomials = (n-1)-th degree)</p>
</td></tr>
<tr><td><code id="chebbasisgen_+3A_a">a</code></td>
<td>
<p>The lower bound of inverval [a,b]</p>
</td></tr>
<tr><td><code id="chebbasisgen_+3A_b">b</code></td>
<td>
<p>The upper bound of inverval [a,b]</p>
</td></tr>
<tr><td><code id="chebbasisgen_+3A_dorder">dorder</code></td>
<td>
<p>Degree of partial derivative of the basis; Default is NULL; if dorder = 1, returns the first order partial derivative</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose there are <code class="reqn">m</code> numbers of Chebyshev nodes over a bounded interval [a,b]:<br />
<br />
<code class="reqn">s_{i} \in [a,b],</code> for <code class="reqn">i = 1,2,\cdots,m</code>.<br />
<br />
These nodes can be nomralized to the standard Chebyshev nodes over the domain [-1,1]:<br />
<br />
<code class="reqn">z_{i} = \frac{2(s_{i} - a)}{(b - a)} - 1</code>.<br />
<br />
With normalized Chebyshev nodes, the recurrence relations of Chebyshev polynomials of order <code class="reqn">n</code> is defined as:<br />
<br />
<code class="reqn">T_{0} (z_{i}) = 1</code>, <br />
<code class="reqn">T_{1} (z_{i}) = z_{i}</code>, and <br />
<code class="reqn">T_{n} (z_{i}) = 2 z_{i} T_{n-1} (z_{i}) - T_{n-2} (z_{i})</code>.<br />
<br />
The interpolation matrix (Vandermonde matrix) of (n-1)-th Chebyshev polynomials with <code class="reqn">m</code> nodes,
<code class="reqn">\Phi_{mn}</code> is:<br />
<br />
<code class="reqn"> \Phi_{mn} = \left[ \begin{array}{ccccc}
1 &amp; T_{1} (z_{1}) &amp; \cdots &amp; T_{n-1} (z_{1})\\
1 &amp; T_{1} (z_{2}) &amp; \cdots &amp; T_{n-1} (z_{2})\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
1 &amp; T_{1} (z_{m}) &amp; \cdots &amp; T_{n-1} (z_{m})
\end{array} \right] </code>.<br />
<br />
The partial derivative of the monomial basis matrix can be found by the relation:<br />
<br />
<code class="reqn">(1-z_{i}^{2}) T'_{n} (z_{i}) = n[ T_{n-1} (z_{i}) - z_{i} T_{n} (z_{i}) ]</code>.<br />
<br />
The technical details of the monomial basis of Chebyshev polynomial can be referred from Amparo et al. (2007)
and Miranda and Fackler (2012).
</p>


<h3>Value</h3>

<p>A matrix (number of nodes (<code class="reqn">m</code>) x npol (<code class="reqn">n</code>)) of (monomial) Chebyshev polynomial basis
</p>


<h3>References</h3>

<p>Amparo, Gil, Javier Segura, and Nico Temme. (2007) <em>Numerical Methods for Special Functions</em>. Cambridge: Cambridge University Press.<br />
Miranda, Mario J. and Paul L. Fackler. (2002) <em>Applied Computational Economics and Finance</em>. Cambridge: The MIT Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chebnodegen">chebnodegen</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
## An example of Chebyshev polynomial basis
chebbasisgen(nodes,20,0.1,1.5)
## The partial derivative of Chebyshev polynomial basis with the same function
chebbasisgen(nodes,20,0.1,1.5,1)
</code></pre>

<hr>
<h2 id='chebgrids'>Generating Chebyshev grids</h2><span id='topic+chebgrids'></span>

<h3>Description</h3>

<p>This function generates a grid of multi-dimensional Chebyshev nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chebgrids(nnodes, lb, ub, rtype = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chebgrids_+3A_nnodes">nnodes</code></td>
<td>
<p>An array of numbers of nodes</p>
</td></tr>
<tr><td><code id="chebgrids_+3A_lb">lb</code></td>
<td>
<p>An array of lower bounds</p>
</td></tr>
<tr><td><code id="chebgrids_+3A_ub">ub</code></td>
<td>
<p>An array of upper bounds</p>
</td></tr>
<tr><td><code id="chebgrids_+3A_rtype">rtype</code></td>
<td>
<p>A type of results; default is NULL that returns a list class; if rtype = list, returns a list class; if rtype = grid, returns a matrix class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code class="reqn">i</code>-th dimension of <code class="reqn">i = 1, 2, \cdots, d</code>, suppose a polynomial approximant
<code class="reqn">s_{i}</code> over a bounded interval <code class="reqn">[a_{i},b_{i}]</code> is defined by Chebysev nodes. Then, a <code class="reqn">d</code>-dimensional
Chebyshev grids can be defined as:<br />
<br />
<code class="reqn">\mathbf{S} = \left\{ (s_{1},s_{2},\cdots,s_{d}) \vert a_{i} \leq s_{1} \leq b_{i}, i = 1, 2, \cdots, d \right\} </code>.<br />
<br />
This is all combinations of <code class="reqn">s_{i}</code>. Two types of results are provided. '<code>rtype = list</code>' provides a list
of <code class="reqn">d</code> dimensions wherease '<code>rtype = grids</code>' creates a <code class="reqn"> \left( \displaystyle \prod_{i=1}^{d} n_{i} \right) \times d</code> matrix.
</p>


<h3>Value</h3>

<p>A list with <code class="reqn">d</code> elements of Chebyshev nodes or a <code class="reqn"> \left( \displaystyle \prod_{i=1}^{d} n_{i} \right) \times d</code> matrix of Chebyshev grids
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chebnodegen">chebnodegen</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Chebyshev grids with two-dimension
chebgrids(c(5,3), c(1,1), c(2,3))
# Returns the same results
chebgrids(c(5,3), c(1,1), c(2,3), rtype='list')
## Returns a matrix grids with the same domain
chebgrids(c(5,3), c(1,1), c(2,3), rtype='grid')
## Chebyshev grids with one-dimension
chebgrids(5,1,2)
chebnodegen(5,1,2)
## Chebyshev grids with three stock
chebgrids(c(3,4,5),c(1,1,1),c(2,3,4),rtype='grid')
</code></pre>

<hr>
<h2 id='chebnodegen'>Unidimensional Chebyshev nodes</h2><span id='topic+chebnodegen'></span>

<h3>Description</h3>

<p>The function generates uni-dimensional chebyshev nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chebnodegen(n, a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chebnodegen_+3A_n">n</code></td>
<td>
<p>A number of nodes</p>
</td></tr>
<tr><td><code id="chebnodegen_+3A_a">a</code></td>
<td>
<p>The lower bound of inverval [a,b]</p>
</td></tr>
<tr><td><code id="chebnodegen_+3A_b">b</code></td>
<td>
<p>The upper bound of interval [a,b]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A polynomial approximant <code class="reqn">s_{i}</code> over a bounded interval [a,b] is constructed by:<br />
<br />
<code class="reqn">s_{i} = \frac{b+a}{2} + \frac{b-a}{2}cos (\frac{n - i + 0.5 }{n} \pi )</code> for <code class="reqn">i = 1,2,\cdots,n</code>. <br />
<br />
More detail explanation can be refered from Miranda and Fackler (2002, p.119).
</p>


<h3>Value</h3>

<p>An array n Chebyshev nodes
</p>


<h3>References</h3>

<p>Miranda, Mario J. and Paul L. Fackler. (2002) <em>Applied Computational Economics and Finance</em>. Cambridge: The MIT Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 10 Chebyshev nodes in [-1,1]
chebnodegen(10,-1,1)
## 5 Chebyshev nodes in [1,5]
chebnodegen(5,1,5)
</code></pre>

<hr>
<h2 id='dsdotds'>first derivative function of sdot in GOM dataset</h2><span id='topic+dsdotds'></span>

<h3>Description</h3>

<p><code>dsdotds</code> evaluated <code class="reqn">\frac{dsdot}{ds}</code> in the reef-fishy example of GOM dataset (Fenichel and Abbott, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsdotds(s,Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dsdotds_+3A_s">s</code></td>
<td>
<p>stock</p>
</td></tr>
<tr><td><code id="dsdotds_+3A_z">Z</code></td>
<td>
<p>parameter vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is adopted in <code>GOM</code> dataset.
</p>


<h3>Value</h3>

<p>The first derivative of sdot with respect to s
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='dsdotdss'>second derivative function of sdot in GOM dataset</h2><span id='topic+dsdotdss'></span>

<h3>Description</h3>

<p><code>dsdotdss</code> evaluated <code class="reqn">\frac{d}{ds}(\frac{dsdot}{ds})</code> in the reef-fishy example of GOM dataset (Fenichel and Abbott, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsdotdss(s,Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dsdotdss_+3A_s">s</code></td>
<td>
<p>stock</p>
</td></tr>
<tr><td><code id="dsdotdss_+3A_z">Z</code></td>
<td>
<p>parameter vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is adopted in <code>GOM</code> dataset.
</p>


<h3>Value</h3>

<p>The second derivative of sdot with respect to s
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='dwds'>first derivative function of profit in GOM dataset</h2><span id='topic+dwds'></span>

<h3>Description</h3>

<p><code>dwds</code> evaluated <code class="reqn">\frac{dw}{ds}</code> in the reef-fishy example of GOM dataset (Fenichel and Abbott, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwds(s,Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dwds_+3A_s">s</code></td>
<td>
<p>stock</p>
</td></tr>
<tr><td><code id="dwds_+3A_z">Z</code></td>
<td>
<p>parameter vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is adopted in <code>GOM</code> dataset.
</p>


<h3>Value</h3>

<p>The first derivative of w with respect to s
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='dwdss'>second derivative function of profit in GOM dataset</h2><span id='topic+dwdss'></span>

<h3>Description</h3>

<p><code>dwdss</code> evaluated <code class="reqn">\frac{d}{ds}(\frac{dw}{ds})</code> in the reef-fishy example of GOM dataset (Fenichel and Abbott, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwdss(s,Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dwdss_+3A_s">s</code></td>
<td>
<p>stock</p>
</td></tr>
<tr><td><code id="dwdss_+3A_z">Z</code></td>
<td>
<p>parameter vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is adopted in <code>GOM</code> dataset.
</p>


<h3>Value</h3>

<p>The second derivative of w with respect to s
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='effort'>effort function of GOM dataset</h2><span id='topic+effort'></span>

<h3>Description</h3>

<p>The function calulates the catchment effort in the reef-fishy example of GOM dataset (Fenichel and Abbott, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effort(s,Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effort_+3A_s">s</code></td>
<td>
<p>stock</p>
</td></tr>
<tr><td><code id="effort_+3A_z">Z</code></td>
<td>
<p>parameter vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This effort function is adopted in <code>GOM</code> dataset.
</p>


<h3>Value</h3>

<p>catchment effort values
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='GOM'>Reef Fish example: one dimensional stock</h2><span id='topic+GOM'></span>

<h3>Description</h3>

<p>The <code>GOM</code> provides data to replicate the Gulf of Mexico Reef Fish example in <a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Fenichel and Abbott (2014)</a>.
This dataset is consisted of parameters and functions.From Fenichel and Abboott(2014),<br />
<br />
catch effort: <code class="reqn">x(s)=ys^\gamma</code>,<br />
<br />
harvest: <code class="reqn">h(s,x)=q((ys^\gamma)^\alpha)s=q(y^\alpha)(s^{\gamma\alpha})</code>,<br />
<br />
profit: <code class="reqn">w(s,x)=price \cdot h(s,x) - cost \cdot x(s)</code>, and<br />
<br />
sdot: <code class="reqn">\dot{s} = rs \left( 1 - \frac{s}{k} \right) - q(y^\alpha)(s^{\gamma \alpha + 1})</code>.<br />
<br />
The parameters in detal are in below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Load dataset
data("GOM")
## Demonstration of example
# demo(GOM, package="capn")
## R-script location
# system.file("demo", "GOM.R", package = "capn")
</code></pre>


<h3>Format</h3>

<p><strong>param</strong>: a data.frame of parameters
</p>

<ul>
<li> <p><code>r</code> intrinsic growth rate (=0.3847)
</p>
</li>
<li> <p><code>k</code> carrying capacity (=359016000)
</p>
</li>
<li> <p><code>q</code> catchability coefficient (=0.00031729344157311126)
</p>
</li>
<li> <p><code>price</code> price (=2.70)
</p>
</li>
<li> <p><code>cost</code> cost (=153.0)
</p>
</li>
<li> <p><code>alpha</code> technology parameter (=0.5436459179063678)
</p>
</li>
<li> <p><code>gamma</code> pre-ITQ management parameter (=0.7882)
</p>
</li>
<li> <p><code>y</code> system equivalence parameter (=0.15745573410462155)
</p>
</li>
<li> <p><code>delta</code> discount rate (=0.02)
</p>
</li>
<li> <p><code>order</code> Chebyshev polynomial order (=50)
</p>
</li>
<li> <p><code>upperK</code> upper bound of Chebyshev polynomial nodes (=k)
</p>
</li>
<li> <p><code>lowerK</code> lower bound of Chebyshev polynomial nodes (=5*10^6)
</p>
</li>
<li> <p><code>nodes</code> the number of Chebyshev polynomial nodes (=50)
</p>
</li></ul>

<p><strong>functions</strong>: functions for generate simulation data for each nodes
</p>

<ul>
<li> <p><code>effort</code> effort function
</p>
</li>
<li> <p><code>catch</code> catch function
</p>
</li>
<li> <p><code>profit</code> profit function (w in Fenichel and Abbott (2014))
</p>
</li>
<li> <p><code>sdot</code> evaluated <code class="reqn">\frac{dst}{dt}</code>
</p>
</li>
<li> <p><code>dsdotds</code> evaluated <code class="reqn">\frac{dsdot}{ds}</code>
</p>
</li>
<li> <p><code>dsdotdss</code> evaluated <code class="reqn">\frac{d}{ds}(\frac{dsdot}{ds})</code>
</p>
</li>
<li> <p><code>dwds</code> evaluated <code class="reqn">\frac{dw}{ds}</code>
</p>
</li>
<li> <p><code>dwdss</code> evaluated <code class="reqn">\frac{d}{ds}(\frac{dw}{ds})</code>
</p>
</li></ul>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>

<hr>
<h2 id='LV'>Prey-Predator (Lotka-Volterra) example: two stocks</h2><span id='topic+LV'></span>

<h3>Description</h3>

<p>The <code>LV</code> provides the data and functions to simulate prey-predator (Lotka-Volterra) model. The original code was written by Joshua Abbott in MATLAB and Seong Do Yun adapted it to a package example. The prey-predator model is:<br />
<br />
Prey (<code class="reqn">X</code>): <code class="reqn"> \dot{X} = rX \left( 1 - \frac{X}{K} \right) - aXY - \theta X   </code>, and<br />
<br />
Predator (<code class="reqn">Y</code>): <code class="reqn"> \dot{Y} = bXY - mY - \gamma Y   </code>.<br />
<br />
The parameters are given as:<br />
<code class="reqn">r = 0.025</code>: intrinsic growth rate for prey,<br />
<code class="reqn">K = 1</code>: carrying capacity for prey,<br />
<code class="reqn">a = 0.08</code>: predator-related mortality parameter for prey,<br />
<code class="reqn">b = 0.05</code>: predator/prey uptake parameter for predator,<br />
<code class="reqn">m = 0.01</code>: natural mortality for predator,<br />
<code class="reqn">\gamma = 0.005</code>: slope for linear predator harvest control rule, and<br />
<code class="reqn">\theta = 0.005</code>: slope for linear prey harvest control rule<br />
<br />
The predator with no economic value (unharvested) is designed for the economic program as:<br />
<br />
<code class="reqn"> W = harv.prey(p.prey-c.prey/X)\theta X + harv.pred*(p.pred-c.pred/Y)\gamma Y</code>.<br />
<br />
The paramters are:<br />
<code class="reqn">p.pred = 0</code>: price per unit harvest of predator,<br />
<code class="reqn">p.prey = 25</code>:  price per unit harvest of prey,<br />
<code class="reqn">c.prey = 0.1 p_prey</code>: cost /per unit of prey effort in Schaefer model (really c/q with q=1), and<br />
<code class="reqn">c.pred = c_prey</code>: cost per unit of predator effort in Schaefer model (really c/q with q=1).<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Load dataset
data("lvdata")
## Demonstration of example
# demo(LV, package="capn")
## R-script location
# system.file("demo", "LV.R", package = "capn")
</code></pre>


<h3>Format</h3>

<p><strong>lvaproxdata</strong>: a data.frame for approximation (evaluated on (20 x 20) Chebyshev nodes)
</p>

<ul>
<li> <p><code>xs</code> prey stock
</p>
</li>
<li> <p><code>ys</code> predator stock
</p>
</li>
<li> <p><code>xdot</code> evaluated xdot <code class="reqn">\frac{dx}{dt}</code>
</p>
</li>
<li> <p><code>ydot</code> evaluated ydot <code class="reqn">\frac{dy}{dt}</code>
</p>
</li>
<li> <p><code>wval</code> profit (W in Fenichel and Abtott (2014))
</p>
</li></ul>

<p><strong>lvsimdata.time</strong>: a data for time simulation (101 ODE solution)
</p>

<ul>
<li> <p><code>tseq</code> time sequence from 0 to 100
</p>
</li>
<li> <p><code>xs</code> prey stock
</p>
</li>
<li> <p><code>ys</code> predator stock
</p>
</li></ul>

<hr>
<h2 id='lvaproxdata'>Prey-Predator (Lotka-Volterra) example in LV dataset</h2><span id='topic+lvaproxdata'></span>

<h3>Description</h3>

<p>The <code>lvaproxdata</code> provides the data in <code>LV</code> dataset to simulate prey-predator (Lotka-Volterra) model. The original code was written by Joshua Abbott in MATLAB and Seong Do Yun adapted it to a package example. The prey-predator model is:<br />
<br />
Prey (<code class="reqn">X</code>): <code class="reqn"> \dot{X} = rX \left( 1 - \frac{X}{K} \right) - aXY - \theta X   </code>, and<br />
<br />
Predator (<code class="reqn">Y</code>): <code class="reqn"> \dot{Y} = bXY - mY - \gamma Y   </code>.<br />
<br />
The parameters are given as:<br />
<code class="reqn">r = 0.025</code>: intrinsic growth rate for prey,<br />
<code class="reqn">K = 1</code>: carrying capacity for prey,<br />
<code class="reqn">a = 0.08</code>: predator-related mortality parameter for prey,<br />
<code class="reqn">b = 0.05</code>: predator/prey uptake parameter for predator,<br />
<code class="reqn">m = 0.01</code>: natural mortality for predator,<br />
<code class="reqn">\gamma = 0.005</code>: slope for linear predator harvest control rule, and<br />
<code class="reqn">\theta = 0.005</code>: slope for linear prey harvest control rule<br />
<br />
The predator with no economic value (unharvested) is designed for the economic program as:<br />
<br />
<code class="reqn"> W = harv.prey(p.prey-c.prey/X)\theta X + harv.pred*(p.pred-c.pred/Y)\gamma Y</code>.<br />
<br />
The paramters are:<br />
<code class="reqn">p.pred = 0</code>: price per unit harvest of predator,<br />
<code class="reqn">p.prey = 25</code>:  price per unit harvest of prey,<br />
<code class="reqn">c.prey = 0.1 p_prey</code>: cost /per unit of prey effort in Schaefer model (really c/q with q=1), and<br />
<code class="reqn">c.pred = c_prey</code>: cost per unit of predator effort in Schaefer model (really c/q with q=1).<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Load dataset
data("lvdata")
</code></pre>


<h3>Format</h3>

<p><strong>lvaproxdata</strong>: a data.frame for approximation (evaluated on (20 x 20) Chebyshev nodes)
</p>

<ul>
<li> <p><code>xs</code> prey stock
</p>
</li>
<li> <p><code>ys</code> predator stock
</p>
</li>
<li> <p><code>xdot</code> evaluated xdot <code class="reqn">\frac{dx}{dt}</code>
</p>
</li>
<li> <p><code>ydot</code> evaluated ydot <code class="reqn">\frac{dy}{dt}</code>
</p>
</li>
<li> <p><code>wval</code> profit (W in Fenichel and Abtott (2014))
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+LV">LV</a>,<a href="#topic+vsim">vsim</a></code>
</p>

<hr>
<h2 id='lvsimdata.time'>Prey-Predator (Lotka-Volterra) example in LV dataset</h2><span id='topic+lvsimdata.time'></span>

<h3>Description</h3>

<p>The <code>lvsimdata.time</code> provides the time simulation data in <code>LV</code> dataset to simulate prey-predator (Lotka-Volterra) model. The original code was written by Joshua Abbott in MATLAB and Seong Do Yun adapted it to a package example. The prey-predator model is:<br />
<br />
Prey (<code class="reqn">X</code>): <code class="reqn"> \dot{X} = rX \left( 1 - \frac{X}{K} \right) - aXY - \theta X   </code>, and<br />
<br />
Predator (<code class="reqn">Y</code>): <code class="reqn"> \dot{Y} = bXY - mY - \gamma Y   </code>.<br />
<br />
The parameters are given as:<br />
<code class="reqn">r = 0.025</code>: intrinsic growth rate for prey,<br />
<code class="reqn">K = 1</code>: carrying capacity for prey,<br />
<code class="reqn">a = 0.08</code>: predator-related mortality parameter for prey,<br />
<code class="reqn">b = 0.05</code>: predator/prey uptake parameter for predator,<br />
<code class="reqn">m = 0.01</code>: natural mortality for predator,<br />
<code class="reqn">\gamma = 0.005</code>: slope for linear predator harvest control rule, and<br />
<code class="reqn">\theta = 0.005</code>: slope for linear prey harvest control rule<br />
<br />
The predator with no economic value (unharvested) is designed for the economic program as:<br />
<br />
<code class="reqn"> W = harv.prey(p.prey-c.prey/X)\theta X + harv.pred*(p.pred-c.pred/Y)\gamma Y</code>.<br />
<br />
The paramters are:<br />
<code class="reqn">p.pred = 0</code>: price per unit harvest of predator,<br />
<code class="reqn">p.prey = 25</code>:  price per unit harvest of prey,<br />
<code class="reqn">c.prey = 0.1 p_prey</code>: cost /per unit of prey effort in Schaefer model (really c/q with q=1), and<br />
<code class="reqn">c.pred = c_prey</code>: cost per unit of predator effort in Schaefer model (really c/q with q=1).<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Load dataset
data("lvdata")
</code></pre>


<h3>Format</h3>

<p><strong>lvsimdata.time</strong>: a data for time simulation (101 ODE solution)
</p>

<ul>
<li> <p><code>tseq</code> time sequence from 0 to 100
</p>
</li>
<li> <p><code>xs</code> prey stock
</p>
</li>
<li> <p><code>ys</code> predator stock
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+LV">LV</a>,<a href="#topic+vsim">vsim</a></code>
</p>

<hr>
<h2 id='paprox'>Calculating P-approximation coefficients</h2><span id='topic+paprox'></span>

<h3>Description</h3>

<p>The function provides the P-approximation coefficients of the defined Chebyshev polynomials in <code>aproxdef</code>.
For now, only unidimensional case is developed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paprox(aproxspace, stock, sdot, dsdotds, dwds)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="paprox_+3A_aproxspace">aproxspace</code></td>
<td>
<p>An approximation space defined by <code>aproxdef</code> function</p>
</td></tr>
<tr><td><code id="paprox_+3A_stock">stock</code></td>
<td>
<p>An array of stock, <code class="reqn">s</code></p>
</td></tr>
<tr><td><code id="paprox_+3A_sdot">sdot</code></td>
<td>
<p>An array of ds/dt, <code class="reqn">\dot{s}=\frac{ds}{dt}</code></p>
</td></tr>
<tr><td><code id="paprox_+3A_dsdotds">dsdotds</code></td>
<td>
<p>An array of d(sdot)/ds, <code class="reqn">\frac{d \dot{s}}{d s}</code></p>
</td></tr>
<tr><td><code id="paprox_+3A_dwds">dwds</code></td>
<td>
<p>An array of dw/ds, <code class="reqn">\frac{dW}{ds}</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The P-approximation is finding the shadow price of a stock, <code class="reqn">p</code> from the relation:<br />
<br />
<code class="reqn">p(s) = \frac{W_{s}(s) + \dot{p}(s)}{\delta - \dot{s}_{s}}</code>, <br />
<br />
where <code class="reqn">W_{s} = \frac{dW}{ds}</code>, <code class="reqn"> \dot{p}(s) = \frac{dp}{ds}</code>,
<code class="reqn">\dot{s}_{s} = \frac{d\dot{s}}{ds} </code>, and <code class="reqn">\delta</code> is the given discount rate.<br />
<br />
Consider approximation <code class="reqn">p(s) = \mathbf{\mu}(s)\mathbf{\beta}</code>, <code class="reqn">\mathbf{\mu}(s)</code>
is Chebyshev polynomials and <code class="reqn">\mathbf{\beta}</code> is their coeffcients.
Then, <code class="reqn">\dot{p} = diag (\dot{s}) \mathbf{\mu}_{s}(s)\mathbf{\beta}</code> by the orthogonality of Chebyshev basis.
Adopting the properties above, we can get the unknown coefficient vector <code class="reqn">\beta</code> from:<br />
<br />
<code class="reqn">\mathbf{\mu}\mathbf{\beta} = diag \left( \delta - \dot{s}_{s} \right)^{-1} \left( W_{s} + diag (\dot{s}) \mathbf{\mu}_{s} \mathbf{\beta} \right) </code>, and thus, <br />
<br />
<code class="reqn">\mathbf{\beta} = \left( diag \left( \delta - \dot{s}_{s} \right) \mathbf{\mu} - diag (\dot{s}) \mathbf{\mu}_{s} \right)^{-1} W_{s} </code>.<br />
<br />
In a case of over-determined (more nodes than approaximation degrees),<br />
<br />
<code class="reqn">\left( \left( diag \left( \delta - \dot{s}_{s} \right) \mathbf{\mu} - diag (\dot{s}) \mathbf{\mu}_{s} \right)^{T}
\left( diag \left( \delta - \dot{s}_{s} \right) \mathbf{\mu} - diag (\dot{s}) \mathbf{\mu}_{s} \right) \right)^{-1}
\left( diag \left( \delta - \dot{s}_{s} \right) \mathbf{\mu} - diag (\dot{s}) \mathbf{\mu}_{s} \right)^{T} W_{s}</code> <br />
<br />
For more detils see <a href="http://www.pnas.org/content/113/9/2382">Fenichel et al. (2016)</a>.
</p>


<h3>Value</h3>

<p>A list of approximation resuts: deg, lb, ub, delta, and coefficients. Use <code>results$item</code> <br /> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table role = "presentation">
<tr><td><code>degree</code></td>
<td>
<p>degree of Chebyshev polynomial</p>
</td></tr>
<tr><td><code>lowerB</code></td>
<td>
<p>lower bound of Chebyshev nodes</p>
</td></tr>
<tr><td><code>upperB</code></td>
<td>
<p>upper bound of Chebyshev nodes</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>discount rate</p>
</td></tr>
<tr><td><code>coefficient</code></td>
<td>
<p>Chebyshev polynomial coefficients</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br />
Fenichel, Eli P., Joshua K. Abbott, Jude Bayham, Whitney Boone, Erin M. K. Haacker, and Lisa Pfeiffer. (2016) &quot;<a href="http://www.pnas.org/content/113/9/2382">Measuring the Value of Groundwater and Other Forms of Natural Capital</a>.&quot;
<em>Proceedings of the National Academy of Sciences </em>.113:2382-2387.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aproxdef">aproxdef</a>,<a href="#topic+psim">psim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataP &lt;- cbind(nodes,sdot(nodes,param),
                   dsdotds(nodes,param),dwds(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
pC &lt;- paprox(Aspace,simuDataP[,1],simuDataP[,2],
             simuDataP[,3],simuDataP[,4])
</code></pre>

<hr>
<h2 id='param'>the parameter vector adopted in GOM dataset</h2><span id='topic+param'></span>

<h3>Description</h3>

<p>The <code>GOM</code> provides data to replicate the Gulf of Mexico Reef Fish example in <a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Fenichel and Abbott (2014)</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Load dataset
data("GOM")
</code></pre>


<h3>Format</h3>

<p><strong>param</strong>: a data.frame of parameters
</p>

<ul>
<li> <p><code>r</code> intrinsic growth rate (=0.3847)
</p>
</li>
<li> <p><code>k</code> carrying capacity (=359016000)
</p>
</li>
<li> <p><code>q</code> catchability coefficient (=0.00031729344157311126)
</p>
</li>
<li> <p><code>price</code> price (=2.70)
</p>
</li>
<li> <p><code>cost</code> cost (=153.0)
</p>
</li>
<li> <p><code>alpha</code> technology parameter (=0.5436459179063678)
</p>
</li>
<li> <p><code>gamma</code> pre-ITQ management parameter (=0.7882)
</p>
</li>
<li> <p><code>y</code> system equivalence parameter (=0.15745573410462155)
</p>
</li>
<li> <p><code>delta</code> discount rate (=0.02)
</p>
</li>
<li> <p><code>order</code> Chebyshev polynomial order (=50)
</p>
</li>
<li> <p><code>upperK</code> upper bound of Chebyshev polynomial nodes (=k)
</p>
</li>
<li> <p><code>lowerK</code> lower bound of Chebyshev polynomial nodes (=5*10^6)
</p>
</li>
<li> <p><code>nodes</code> the number of Chebyshev polynomial nodes (=50)
</p>
</li></ul>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='pdotaprox'>Calculating Pdot-approximation coefficients</h2><span id='topic+pdotaprox'></span>

<h3>Description</h3>

<p>The function provides the Pdot-approximation coefficients of the defined Chebyshev polynomials in <code>aproxdef</code>.
For now, only unidimensional case is developed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdotaprox(aproxspace, stock, sdot, dsdotds, dsdotdss, dwds, dwdss)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pdotaprox_+3A_aproxspace">aproxspace</code></td>
<td>
<p>An approximation space defined by <code>aproxdef</code> function</p>
</td></tr>
<tr><td><code id="pdotaprox_+3A_stock">stock</code></td>
<td>
<p>An array of stock, <code class="reqn">s</code></p>
</td></tr>
<tr><td><code id="pdotaprox_+3A_sdot">sdot</code></td>
<td>
<p>An array of ds/dt, <code class="reqn">\dot{s}=\frac{ds}{dt}</code></p>
</td></tr>
<tr><td><code id="pdotaprox_+3A_dsdotds">dsdotds</code></td>
<td>
<p>An array of d(sdot)/ds, <code class="reqn">\frac{d \dot{s}}{d s}</code></p>
</td></tr>
<tr><td><code id="pdotaprox_+3A_dsdotdss">dsdotdss</code></td>
<td>
<p>An array of d/ds(d(sdot)/ds), <code class="reqn"> \frac{d}{ds} \left( \frac{d \dot{s}}{ds} \right)</code></p>
</td></tr>
<tr><td><code id="pdotaprox_+3A_dwds">dwds</code></td>
<td>
<p>An array of dw/ds, <code class="reqn">\frac{dW}{ds}</code></p>
</td></tr>
<tr><td><code id="pdotaprox_+3A_dwdss">dwdss</code></td>
<td>
<p>An array of d/ds(dw/ds), <code class="reqn">\frac{d}{ds} \left( \frac{dW}{ds} \right)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pdot-approximation is finding the shadow price of a stock, <code class="reqn">p</code> from the relation:<br />
<br />
<code class="reqn">p(s) = \frac{W_{s}(s) + \dot{p}(s)}{\delta - \dot{s}_{s}}</code>, <br />
<br />
where <code class="reqn">W_{s} = \frac{dW}{ds}</code>, <code class="reqn"> \dot{p}(s) = \frac{dp}{ds}</code>,
<code class="reqn">\dot{s}_{s} = \frac{d\dot{s}}{ds} </code>, and <code class="reqn">\delta</code> is the given discount rate.<br />
<br />
In order to operationalize this approach, we take the time derivative of this expression:<br />
<br />
<code class="reqn"> \dot{p} = \frac{ \left( \left(W_{ss}\dot{s} + \ddot{p} \right) \left( \delta - \dot{s}_{s} \right) +
   \left( W_{s} + \dot{p} \right) \left(\dot{s}_{ss} \dot{s} \right)  \right)  }
   { \left( \delta - \dot{s}_{s} \right)^{2} } </code> <br />
<br />
Consider approximation <code class="reqn"> \dot{p}(s) = \mathbf{\mu}(s)\mathbf{\beta}</code>, <code class="reqn">\mathbf{\mu}(s)</code>
is Chebyshev polynomials and <code class="reqn">\mathbf{\beta}</code> is their coeffcients.
Then, <code class="reqn"> \ddot{p} = \frac{ d \dot{p}}{ds} \frac{ds}{dt} = diag (\dot{s}) \mathbf{\mu}_{s}(s) \mathbf{\beta}</code> by the orthogonality of Chebyshev basis.
Adopting the properties above, we can get the unknown coefficient vector <code class="reqn">\beta</code> from:<br />
<br />
<code class="reqn"> \mathbf{\mu \beta} =  diag \left( \delta - \dot{s}_{s} \right)^{-2}
   \left[ \left(W_{ss}\dot{s} + diag (\dot{s}) \mathbf{\mu}_{s} \mathbf{\beta} \right)\left( \delta - \dot{s}_{s} \right) +
   diag \left(\dot{s}_{ss} \dot{s} \right) \left( W_{s} + \mathbf{\mu \beta} \right) \right] </code>, and <br />
<br />
<code class="reqn">\mathbf{\beta} = \left[ diag \left( \delta - \dot{s}_{s} \right)^{2} \mathbf{\mu} - diag \left( \dot{s}\left( \delta - \dot{s}_{s} \right) \right) \mathbf{\mu}_{s}
    - diag (\dot{s}_{ss} \dot{s} ) \mathbf{\mu}   \right]^{-1}
    \left( W_{ss} \dot{s} \left( \delta - \dot{s}_{s} \right) + W_{s} \dot{s}_{ss} \dot{s} \right) </code>.  <br />
<br />
If we suppose <code class="reqn"> A = \left[ diag \left( \delta - \dot{s}_{s} \right)^{2} \mathbf{\mu} - diag \left( \dot{s}\left( \delta - \dot{s}_{s} \right) \right) \mathbf{\mu}_{s}
    - diag (\dot{s}_{ss} \dot{s} ) \mathbf{\mu}    \right] </code> and <br />
<code class="reqn"> B = \left( W_{ss} \dot{s} \left( \delta - \dot{s}_{s} \right) + W_{s} \dot{s}_{ss} \dot{s} \right) </code>,
then over-determined case can be calculated:<br />
<br />
<code class="reqn"> \mathbf{\beta} = \left( A^{T}A \right)^{-1} A^{T}B </code>.<br />
<br />
For more detils see <a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Fenichel and Abbott (2014)</a>.
</p>


<h3>Value</h3>

<p>A list of approximation results: deg, lb, ub, delta, and coefficients. Use <code>results$item</code> <br /> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table role = "presentation">
<tr><td><code>degree</code></td>
<td>
<p>degree of Chebyshev polynomial</p>
</td></tr>
<tr><td><code>lowerB</code></td>
<td>
<p>lower bound of Chebyshev nodes</p>
</td></tr>
<tr><td><code>upperB</code></td>
<td>
<p>upper bound of Chebyshev nodes</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>discount rate</p>
</td></tr>
<tr><td><code>coefficient</code></td>
<td>
<p>Chebyshev polynomial coefficients</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aproxdef">aproxdef</a>, <a href="#topic+pdotsim">pdotsim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataPdot &lt;- cbind(nodes,sdot(nodes,param),
                      dsdotds(nodes,param),dsdotdss(nodes,param),
                      dwds(nodes,param),dwdss(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
pdotC &lt;- pdotaprox(Aspace,simuDataPdot[,1],simuDataPdot[,2],
                   simuDataPdot[,3],simuDataPdot[,4],
                   simuDataPdot[,5],simuDataPdot[,6])
</code></pre>

<hr>
<h2 id='pdotsim'>Simulation of Pdot-approximation</h2><span id='topic+pdotsim'></span>

<h3>Description</h3>

<p>The function provides the Pdot-approximation simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdotsim(pdotcoeff, stock, sdot, dsdotds, wval, dwds)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pdotsim_+3A_pdotcoeff">pdotcoeff</code></td>
<td>
<p>An approximation result from <code>pdotaprox</code> function</p>
</td></tr>
<tr><td><code id="pdotsim_+3A_stock">stock</code></td>
<td>
<p>An array of stock</p>
</td></tr>
<tr><td><code id="pdotsim_+3A_sdot">sdot</code></td>
<td>
<p>An array of ds/dt, <code class="reqn">\dot{s}=\frac{ds}{dt}</code></p>
</td></tr>
<tr><td><code id="pdotsim_+3A_dsdotds">dsdotds</code></td>
<td>
<p>An array of d(sdot)/ds, <code class="reqn">\frac{d \dot{s}}{d s}</code></p>
</td></tr>
<tr><td><code id="pdotsim_+3A_wval">wval</code></td>
<td>
<p>An array of <code class="reqn">W</code>-value</p>
</td></tr>
<tr><td><code id="pdotsim_+3A_dwds">dwds</code></td>
<td>
<p>An array of dw/ds, <code class="reqn">\frac{dW}{ds}</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\hat{\beta}</code> be the vector of approximation coefficents from the results of <code>pdotaprox</code> function.
The estimated shadow price (accounting) price of stock over the given approximation interval of
<code class="reqn">s \in [a,b]</code>, <code class="reqn">\hat{p}</code> can be calculated as:<br />
<br />
<code class="reqn">\hat{p} = \frac{ W_{s} + \mathbf{\mu \beta} }{ \delta - \dot{s}_{s} } </code>.<br />
<br />
The estimated value function is:<br />
<br />
<code class="reqn"> \hat{V} = \frac{1}{\delta} \left( W + \hat{p} \dot{s} \right)  </code>.<br />
<br />
For more detils see <a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Fenichel and Abbott (2014)</a> and <a href="http://www.pnas.org/content/113/9/2382">Fenichel et al. (2016)</a>.
</p>


<h3>Value</h3>

<p>A list of approximation resuts: shadow (accounting) prices, inclusive wealth, and value function, stock, and W values. Use <code>results$item</code> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table role = "presentation">
<tr><td><code>shadowp</code></td>
<td>
<p>Shadow price</p>
</td></tr>
<tr><td><code>vfun</code></td>
<td>
<p>Value function</p>
</td></tr>
<tr><td><code>stock</code></td>
<td>
<p>Stock</p>
</td></tr>
<tr><td><code>wval</code></td>
<td>
<p>W-value</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br />
Fenichel, Eli P., Joshua K. Abbott, Jude Bayham, Whitney Boone, Erin M. K. Haacker, and Lisa Pfeiffer. (2016) &quot;<a href="http://www.pnas.org/content/113/9/2382">Measuring the Value of Groundwater and Other Forms of Natural Capital</a>.&quot;
<em>Proceedings of the National Academy of Sciences </em>.113:2382-2387.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pdotaprox">pdotaprox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataPdot &lt;- cbind(nodes,sdot(nodes,param),
                      dsdotds(nodes,param),dsdotdss(nodes,param),
                      dwds(nodes,param),dwdss(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
pdotC &lt;- pdotaprox(Aspace,simuDataPdot[,1],simuDataPdot[,2],
                   simuDataPdot[,3],simuDataPdot[,4],
                   simuDataPdot[,5],simuDataPdot[,6])
GOMSimPdot &lt;- pdotsim(pdotC,simuDataPdot[,1],simuDataPdot[,2],simuDataPdot[,3],
                      profit(nodes,param),simuDataPdot[,5])
# Shadow Price
plotgen(GOMSimPdot, xlabel="Stock size, s", ylabel="Shadow price")

# Value function and profit
plotgen(GOMSimPdot,ftype="vw",
        xlabel="Stock size, s",
        ylabel=c("Value Function","Profit"))
</code></pre>

<hr>
<h2 id='plotgen'>Plot Generator for Shadow Price or Value Function</h2><span id='topic+plotgen'></span>

<h3>Description</h3>

<p>The function draws shadowp or vfun-w plot from the simulation results of <code>vsim</code>, <code>psim</code>, or <code>pdotsim</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotgen(simres, ftype = NULL, whichs = NULL, tvar = NULL, xlabel = NULL,
  ylabel = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotgen_+3A_simres">simres</code></td>
<td>
<p>A simulation results from <code>vsim</code>, <code>psim</code>, or <code>pdotsim</code></p>
</td></tr>
<tr><td><code id="plotgen_+3A_ftype">ftype</code></td>
<td>
<p>Plot type (ftype=NULL (default) or ftype=&quot;p&quot; for shadow price; ftype=&quot;vw&quot; for vfun-w plot)</p>
</td></tr>
<tr><td><code id="plotgen_+3A_whichs">whichs</code></td>
<td>
<p>A pisitive integer for indicating a specific stock for multi-sotck cases (ftype=NULL (default) or 1&lt;= whichs &lt;= the number of stocks)</p>
</td></tr>
<tr><td><code id="plotgen_+3A_tvar">tvar</code></td>
<td>
<p>An array of time variable if simulation result is a time-base simulation</p>
</td></tr>
<tr><td><code id="plotgen_+3A_xlabel">xlabel</code></td>
<td>
<p>A character for x-label of a plot (xlabel=NULL (default); &quot;Stock&quot; or &quot;Time&quot;)</p>
</td></tr>
<tr><td><code id="plotgen_+3A_ylabel">ylabel</code></td>
<td>
<p>An array of characters for y-label of a plot (ylabel=NULL (default); &quot;Shadow Price&quot;, &quot;Value Function&quot; or &quot;W-value&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides an one-dimensional plot for &quot;shadow price-stock&quot;, &quot;shadow price-time&quot;, &quot;Value function-stock&quot;, &quot;Value function-time&quot;, &quot;Value function-stock-W value&quot;, or &quot;Value function-time-W value&quot; depending on input arguments.
</p>


<h3>Value</h3>

<p>A plot of approximation resuts: shadow (accounting) prices, inclusive wealth, and Value function
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vsim">vsim</a>, <a href="#topic+psim">psim</a>, <a href="#topic+pdotsim">pdotsim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataP &lt;- cbind(nodes,sdot(nodes,param),
                   dsdotds(nodes,param),dwds(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)

# p-approximation
pC &lt;- paprox(Aspace,simuDataP[,1],simuDataP[,2],
             simuDataP[,3],simuDataP[,4])

# Without prividing W-value
GOMSimP &lt;- psim(pC,simuDataP[,1])
# With W-value
GOMSimP2 &lt;- psim(pC,simuDataP[,1],profit(nodes,param),simuDataP[,2])

# Shadow price-Stock plot
plotgen(GOMSimP)
plotgen(GOMSimP,ftype="p")
plotgen(GOMSimP,xlabel="Stock Size, S", ylabel="Shadow Price (USD/Kg)")

# Value-Stock-W plot
plotgen(GOMSimP2,ftype="vw")
plotgen(GOMSimP2,ftype="vw",xlabel="Stock Size, S", ylabel="Value Function")
plotgen(GOMSimP2,ftype="vw",xlabel="Stock Size, S", ylabel="Value Function")

## 2-D Prey-Predator example
data("lvdata")
aproxdeg &lt;- c(20,20)
lower &lt;- c(0.1,0.1)
upper &lt;- c(1.5,1.5)
delta &lt;- 0.03
lvspace &lt;- aproxdef(aproxdeg,lower,upper,delta)
lvaproxc &lt;- vaprox(lvspace,lvaproxdata)
lvsim &lt;- vsim(lvaproxc,lvsimdata.time[,2:3])

# Shadow price-Stock plot
plotgen(lvsim)
plotgen(lvsim,ftype="p")
plotgen(lvsim,whichs=2,xlabel="Stock Size, S",ylabel="Shadow Price (USD/Kg)")

# Shadow price-time plot
plotgen(lvsim,whichs=2,tvar=lvsimdata.time[,1])

# Value Function-Stock plot
plotgen(lvsim,ftype="vw")
plotgen(lvsim,ftype="vw",whichs=2,
        xlabel="Stock Size, S",ylabel="Shadow Price (USD/Kg)")

# Value Function-time plot
plotgen(lvsim,ftype="vw",tvar=lvsimdata.time[,1])
plotgen(lvsim,ftype="vw",whichs=2,tvar=lvsimdata.time[,1],
        xlabel="Stock Size, S",ylabel="Shadow Price (USD/Kg)")
</code></pre>

<hr>
<h2 id='profit'>profit function in GOM dataset</h2><span id='topic+profit'></span>

<h3>Description</h3>

<p>profit (w) function in the reef-fishy example of GOM dataset (Fenichel and Abbott, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profit(s,Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profit_+3A_s">s</code></td>
<td>
<p>stock</p>
</td></tr>
<tr><td><code id="profit_+3A_z">Z</code></td>
<td>
<p>parameter vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is adopted in <code>GOM</code> dataset.
</p>


<h3>Value</h3>

<p>profit
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='psim'>Simulation of P-approximation</h2><span id='topic+psim'></span>

<h3>Description</h3>

<p>The function provides the P-approximation simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psim(pcoeff, stock, wval = NULL, sdot = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psim_+3A_pcoeff">pcoeff</code></td>
<td>
<p>An approximation result from <code>paprox</code> function</p>
</td></tr>
<tr><td><code id="psim_+3A_stock">stock</code></td>
<td>
<p>An array of stock variable</p>
</td></tr>
<tr><td><code id="psim_+3A_wval">wval</code></td>
<td>
<p>(Optional for vfun) An array of <code class="reqn">W</code>-value (need <code>sdot</code> simultaneously)</p>
</td></tr>
<tr><td><code id="psim_+3A_sdot">sdot</code></td>
<td>
<p>(Optional for vfun) An array of ds/dt, <code class="reqn">\dot{s}=\frac{ds}{dt}</code> (need <code>W</code> simultaneously)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\hat{\beta}</code> be the vector of approximation coefficents from the results of <code>paprox</code> function.
The estimated shadow price (accounting) price of stock over the given approximation interval of
<code class="reqn">s \in [a,b]</code>, <code class="reqn">\hat{p}</code> can be calculated as:<br />
<br />
<code class="reqn">\hat{p} = \mathbf{\mu}(s) \mathbf{\hat{\beta}}</code>.<br />
<br />
The estimated value function is:<br />
<br />
<code class="reqn"> \hat{V} = \frac{1}{\delta} \left( W + \hat{p} \dot{s} \right)  </code>.<br />
<br />
For more detils see <a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Fenichel and Abbott (2014)</a> and <a href="http://www.pnas.org/content/113/9/2382">Fenichel et al. (2016)</a>.
</p>


<h3>Value</h3>

<p>A list of approximation resuts: shadow (accounting) prices, inclusive wealth, value function, stock, and W values. Use <code>results$item</code> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table role = "presentation">
<tr><td><code>shadowp</code></td>
<td>
<p>Shadow price</p>
</td></tr>
<tr><td><code>vfun</code></td>
<td>
<p>Value function</p>
</td></tr>
<tr><td><code>stock</code></td>
<td>
<p>Stock</p>
</td></tr>
<tr><td><code>wval</code></td>
<td>
<p>W-value if <code>wval</code> is provided</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br />
Fenichel, Eli P., Joshua K. Abbott, Jude Bayham, Whitney Boone, Erin M. K. Haacker, and Lisa Pfeiffer. (2016) &quot;<a href="http://www.pnas.org/content/113/9/2382">Measuring the Value of Groundwater and Other Forms of Natural Capital</a>.&quot;
<em>Proceedings of the National Academy of Sciences </em>.113:2382-2387.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aproxdef">aproxdef</a>, <a href="#topic+paprox">paprox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataP &lt;- cbind(nodes,sdot(nodes,param),
                   dsdotds(nodes,param),dwds(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
pC &lt;- paprox(Aspace,simuDataP[,1],simuDataP[,2],
             simuDataP[,3],simuDataP[,4])
GOMSimP &lt;- psim(pC,simuDataP[,1],profit(nodes,param),simuDataP[,2])

# Shadow Price
plotgen(GOMSimP, xlabel="Stock size, s", ylabel="Shadow price")

# Value function and profit
plotgen(GOMSimP,ftype="vw",
        xlabel="Stock size, s",
        ylabel=c("Value Function","Profit"))
</code></pre>

<hr>
<h2 id='sdot'>growth function of GOM dataset</h2><span id='topic+sdot'></span>

<h3>Description</h3>

<p>The function calulates the growth rate in the reef-fishy example of GOM dataset (Fenichel and Abbott, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdot(s,Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sdot_+3A_s">s</code></td>
<td>
<p>stock</p>
</td></tr>
<tr><td><code id="sdot_+3A_z">Z</code></td>
<td>
<p>parameter vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is adopted in <code>GOM</code> dataset.
</p>


<h3>Value</h3>

<p>growth rate
</p>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GOM">GOM</a></code>
</p>

<hr>
<h2 id='unigrids'>Generating unifrom grids</h2><span id='topic+unigrids'></span>

<h3>Description</h3>

<p>This function generates a grid of multi-dimensional uniform grids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unigrids(nnodes, lb, ub, rtype = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unigrids_+3A_nnodes">nnodes</code></td>
<td>
<p>An array of numbers of nodes</p>
</td></tr>
<tr><td><code id="unigrids_+3A_lb">lb</code></td>
<td>
<p>An array of lower bounds</p>
</td></tr>
<tr><td><code id="unigrids_+3A_ub">ub</code></td>
<td>
<p>An array of upper bounds</p>
</td></tr>
<tr><td><code id="unigrids_+3A_rtype">rtype</code></td>
<td>
<p>A type of results; default is NULL that returns a list class; if rtype = list, returns a list class; if rtype = grid, returns a matrix class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code class="reqn">i</code>-th dimension of <code class="reqn">i = 1, 2, \cdots, d</code>, suppose a polynomial approximant
<code class="reqn">s_{i}</code> over a bounded interval <code class="reqn">[a_{i},b_{i}]</code> is defined by evenly gridded nodes. Then, a <code class="reqn">d</code>-dimensional
uniform grids can be defined as:<br />
<br />
<code class="reqn">\mathbf{S} = \left\{ (s_{1},s_{2},\cdots,s_{d}) \vert a_{i} \leq s_{1} \leq b_{i}, i = 1, 2, \cdots, d \right\} </code>.<br />
<br />
This is all combinations of <code class="reqn">s_{i}</code>. Two types of results are provided. '<code>rtype = list</code>' provides a list
of <code class="reqn">d</code> dimensions wherease '<code>rtype = grids</code>' creates a <code class="reqn"> \left( \displaystyle \prod_{i=1}^{d} n_{i} \right) \times d</code> matrix.
</p>


<h3>Value</h3>

<p>A list with <code class="reqn">d</code> elements of Chebyshev nodes or a <code class="reqn"> \left( \displaystyle \prod_{i=1}^{d} n_{i} \right) \times d</code> matrix of uniform grids
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uniform grids with two-dimension
unigrids(c(5,3), c(1,1), c(2,3))
## Returns the same results
unigrids(c(5,3), c(1,1), c(2,3), rtype='list')
## Returns a matrix grids with the same domain
unigrids(c(5,3), c(1,1), c(2,3), rtype='grid')
## Uniform grid with one-dimension
unigrids(5,1,2)
## Uniform grids with three stock
unigrids(c(3,4,5),c(1,1,1),c(2,3,4),rtype='grid')
</code></pre>

<hr>
<h2 id='vaprox'>Calculating V-approximation coefficients</h2><span id='topic+vaprox'></span>

<h3>Description</h3>

<p>The function provides the V-approximation coefficients of the defined Chebyshev polynomials in <code>aproxdef</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vaprox(aproxspace, sdata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vaprox_+3A_aproxspace">aproxspace</code></td>
<td>
<p>An approximation space defined by <code>aproxdef</code> function</p>
</td></tr>
<tr><td><code id="vaprox_+3A_sdata">sdata</code></td>
<td>
<p>A data.frame or matrix of [stock,sdot,benefit]=[<code class="reqn">\mathbf{S}</code>,<code class="reqn">\mathbf{\dot{S}}</code>,<code class="reqn">W</code>]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The V-approximation is finding the shadow price of <code class="reqn">i</code>-th stock, <code class="reqn">p_{i}</code> for <code class="reqn">i=1,\cdots,d</code>
from the relation:<br />
<br />
<code class="reqn">\delta V = W(\mathbf{S}) + p_{1}\dot{s}_{1} + p_{2}\dot{s}_{2} + \cdots + p_{d}\dot{s}_{d}</code>,<br />
<br />
where <code class="reqn">\delta</code> is the given discount rate, <code class="reqn">V</code> is the intertemporal welfare function, <code class="reqn">\mathbf{S} = (s_{1}, s_{2}, \cdots, s_{d})</code> is a vector of stocks, <code class="reqn">W(\mathbf{S})</code> is the net benefits accruing to society,
and <code class="reqn">\dot{s}_{i}</code> is the growth of stock <code class="reqn">s_{i}</code>. By the definition of the shadow price, we know:<br />
<br />
<code class="reqn">p_{i} = \frac{\partial V}{\partial s_{i}}</code>.<br />
<br />
Consider approximation <code class="reqn">V(\mathbf{S}) = \mathbf{\mu}(\mathbf{S})\mathbf{\beta}</code>, <code class="reqn">\mathbf{\mu}(\mathbf{S})</code>
is Chebyshev polynomials and <code class="reqn">\mathbf{\beta}</code> is their coeffcients.
Then, <code class="reqn">p_{i} = \mathbf{\mu}_{s_{i}}(\mathbf{S})\mathbf{\beta}</code> by the orthogonality of Chebyshev basis.
Adopting the properties above, we can get the unknown coefficient vector <code class="reqn">\beta</code> from:<br />
<br />
<code class="reqn">\delta \mathbf{\mu}(\mathbf{S})\mathbf{\beta} = W(\mathbf{S}) + \displaystyle \sum_{i=1}^{d} diag (\dot{s}_{i}) \mathbf{\mu}_{s_{i}}(\mathbf{S})\mathbf{\beta}</code>, and thus,<br />
<br />
<code class="reqn">\beta = \left( \delta \mathbf{\mu}(\mathbf{S}) - \displaystyle \sum_{i=1}^{d} diag (\dot{s}_{i}) \mathbf{\mu}_{s_{i}}(\mathbf{S}) \right)^{-1} W(\mathbf{S}) </code>.<br />
<br />
In a case of over-determined (more nodes than approaximation degrees),<br />
<br />
<code class="reqn">\beta = \left( \left( \delta \mathbf{\mu}(\mathbf{S}) - \displaystyle diag (\dot{s}_{i}) \sum_{i=1}^{d} \mathbf{\mu}_{s_{i}}(\mathbf{S}) \right)^{T}
\left( \delta \mathbf{\mu}(\mathbf{S}) - \displaystyle \sum_{i=1}^{d} diag (\dot{s}_{i}) \mathbf{\mu}_{s_{i}}(\mathbf{S}) \right) \right)^{-1}</code> <br />
<code class="reqn">\times \left( \delta \mathbf{\mu}(\mathbf{S}) - \displaystyle \sum_{i=1}^{d} diag (\dot{s}_{i}) \mathbf{\mu}_{s_{i}}(\mathbf{S}) \right)^{T} W(\mathbf{S}) </code>.<br />
<br />
For more detils see Fenichel and Abbott (2014), Fenichel et al. (2016), and Yun et al. (2017).
</p>


<h3>Value</h3>

<p>A list of approximation resuts: deg, lb, ub, delta, and coefficients. Use <code>results$item</code> <br /> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table role = "presentation">
<tr><td><code>degree</code></td>
<td>
<p>degree of Chebyshev polynomial</p>
</td></tr>
<tr><td><code>lowerB</code></td>
<td>
<p>lower bound of Chebyshev nodes</p>
</td></tr>
<tr><td><code>upperB</code></td>
<td>
<p>upper bound of Chebyshev nodes</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>discount rate</p>
</td></tr>
<tr><td><code>coefficient</code></td>
<td>
<p>Chebyshev polynomial coefficients</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br />
Fenichel, Eli P., Joshua K. Abbott, Jude Bayham, Whitney Boone, Erin M. K. Haacker, and Lisa Pfeiffer. (2016) &quot;<a href="http://www.pnas.org/content/113/9/2382">Measuring the Value of Groundwater and Other Forms of Natural Capital</a>.&quot;
<em>Proceedings of the National Academy of Sciences</em>.113:2382-2387.<br />
Yun, Seong Do, Barbara Hutniczak, Joshua K. Abbott, and Eli P. Fenichel. (2017) &quot;Ecosystem Based Management and the Welath of Ecosystems&quot; <em>Proceedings of the National Academy of Sciences</em>. (forthcoming).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aproxdef">aproxdef</a>, <a href="#topic+vsim">vsim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataV &lt;- cbind(nodes,sdot(nodes,param),profit(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
vC &lt;- vaprox(Aspace,simuDataV)

## 2-D Prey-Predator example
data("lvdata")
aproxdeg &lt;- c(20,20)
lower &lt;- c(0.1,0.1)
upper &lt;- c(1.5,1.5)
delta &lt;- 0.03
lvspace &lt;- aproxdef(aproxdeg,lower,upper,delta)
vaproxc &lt;- vaprox(lvspace,lvaproxdata)
</code></pre>

<hr>
<h2 id='vsim'>Simulation of V-approximation</h2><span id='topic+vsim'></span>

<h3>Description</h3>

<p>The function provides the V-approximation simulation by adopting the results of <code>vaprox</code>. Available for multiple stock problems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vsim(vcoeff, adata, wval = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vsim_+3A_vcoeff">vcoeff</code></td>
<td>
<p>An approximation result from <code>varpox</code> function</p>
</td></tr>
<tr><td><code id="vsim_+3A_adata">adata</code></td>
<td>
<p>A data.frame or matrix of [stock]=[<code class="reqn">\mathbf{S}</code>]</p>
</td></tr>
<tr><td><code id="vsim_+3A_wval">wval</code></td>
<td>
<p>(Optional for <code>plotgen</code>) An array of <code class="reqn">W</code>-value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\hat{\beta}</code> be the approximation coefficent from the results of <code>vaprox</code> function.
The estimated shadow (accounting) price of <code class="reqn">i</code>-th stock over the given approximation intervals of <code class="reqn">s_{i} \in [a_{i},b_{i}]</code>,
<code class="reqn">\hat{p}_{i}</code> can be calcuated as:<br />
<br />
<code class="reqn">\hat{p}_{i} = \mathbf{\mu}(\mathbf{S})\mathbf{\hat{\beta}}</code> where <code class="reqn">\mathbf{\mu}(\mathbf{S})</code> Chebyshev polynomial basis.<br />
<br />
The value function is:<br />
<br />
<code class="reqn">\hat{V} = \delta \mathbf{\mu}(\mathbf{S})\mathbf{\hat{\beta}}</code>.<br />
<br />
For more detils see Fenichel and Abbott (2014), Fenichel et al. (2016a), Fenichel et al. (2016b), and Yun et al. (2017).
</p>


<h3>Value</h3>

<p>A list of simulation resuts: shadow (accounting) prices, inclusive wealth, Value function,<br />
stock, and W values. Use <code>results$item</code> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table role = "presentation">
<tr><td><code>shadowp</code></td>
<td>
<p>Shadow price</p>
</td></tr>
<tr><td><code>iweach</code></td>
<td>
<p>Inclusive wealth for each stock for multi-stock case</p>
</td></tr>
<tr><td><code>vfun</code></td>
<td>
<p>Value function</p>
</td></tr>
<tr><td><code>stock</code></td>
<td>
<p>Stock</p>
</td></tr>
<tr><td><code>wval</code></td>
<td>
<p>W-value if <code>wval</code> is provided</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) &quot;<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>.&quot;
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br />
Fenichel, Eli P., Joshua K. Abbott, Jude Bayham, Whitney Boone, Erin M. K. Haacker, and Lisa Pfeiffer. (2016a) &quot;<a href="http://www.pnas.org/content/113/9/2382">Measuring the Value of Groundwater and Other Forms of Natural Capital</a>.&quot;
<em>Proceedings of the National Academy of Sciences</em>.113:2382-2387.<br />
Fenichel, Eli P., Simon A. Levin, Bonnie McCay, Kevin St. Martin, Joshua K. Abbott, and Malin L. Pinsky. (2016b) &quot;<a href="http://www.nature.com/nclimate/index.html">Wealth Reallocation and Sustainability under Climate Change</a>.&quot;
<em>Nature Climate change</em>.6:237-244.<br />
Yun, Seong Do, Barbara Hutniczak, Joshua K. Abbott, and Eli P. Fenichel. (2017) &quot;Ecosystem Based Management and the Welath of Ecosystems&quot; <em>Proceedings of the National Academy of Sciences</em>. (forthcoming).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aproxdef">aproxdef</a>, <a href="#topic+vsim">vsim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataV &lt;- cbind(nodes,sdot(nodes,param),profit(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
vC &lt;- vaprox(Aspace,simuDataV)
# Note vcol function requries a data.frame or matrix!
GOMSimV &lt;- vsim(vC,as.matrix(simuDataV[,1],ncol=1),profit(nodes,param))

# plot shadow (accounting) price: Figure 4 in Fenichel and Abbott (2014)
plotgen(GOMSimV, xlabel="Stock size, s", ylabel="Shadow price")

## 2-D Prey-Predator example
data("lvdata")
aproxdeg &lt;- c(20,20)
lower &lt;- c(0.1,0.1)
upper &lt;- c(1.5,1.5)
delta &lt;- 0.03
lvspace &lt;- aproxdef(aproxdeg,lower,upper,delta)
lvaproxc &lt;- vaprox(lvspace,lvaproxdata)
lvsim &lt;- vsim(lvaproxc,lvsimdata.time[,2:3])

# plot Biomass
plot(lvsimdata.time[,1], lvsimdata.time[,2], type='l', lwd=2, col="blue",
     xlab="Time",
     ylab="Biomass")
lines(lvsimdata.time[,1], lvsimdata.time[,3], lwd=2, col="red")
legend("topright", c("Prey", "Predator"), col=c("blue", "red"),
       lty=c(1,1), lwd=c(2,2), bty="n")

# plot shadow (accounting) prices
plot(lvsimdata.time[,1],lvsim[["shadowp"]][,1],type='l', lwd=2, col="blue",
     ylim = c(-5,7),
     xlab="Time",
     ylab="Shadow price")
lines(lvsimdata.time[,1],lvsim[["shadowp"]][,2], lwd=2, col="red")
legend("topright", c("Prey", "Predator"), col=c("blue", "red"),
       lty=c(1,1), lwd=c(2,2), bty="n")

# plot inclusive weath and value function
plot(lvsimdata.time[,1],lvsim[["iw"]],type='l', lwd=2, col="blue",
     ylim = c(-0.5,1.2),
     xlab="Time",
     ylab="Inclusive Wealth / Value Function ($)")
lines(lvsimdata.time[,1],lvsim[["vfun"]], lwd=2, col="red")
legend("topright", c("Inclusive Wealth", "Value Function"),
       col=c("blue", "red"), lty=c(1,1), lwd=c(2,2), bty="n")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
