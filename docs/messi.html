<!DOCTYPE html><html><head><title>Help for package messi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {messi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#constrained.unpenalized'><p>Estimate hard constraint model parameters using cyclical coordinate descent.</p></a></li>
<li><a href='#Med'><p>Simulated data with real mediation effect</p></a></li>
<li><a href='#messi'><p>Implementation of Mediation with External Summary Statistics Information (MESSI) from Boss et al. (2023).</p></a></li>
<li><a href='#nullMed'><p>Simulated data with null mediation effect</p></a></li>
<li><a href='#plot_messi'><p>Forestplot to Summarize Estimation and Inference on alpha_a and beta_m.</p></a></li>
<li><a href='#rand.eff.coord.desc.unpenalized'><p>Cyclical coordinate descent algorithm for the M-step in the EM Algorithm for the maximizing the soft constraint model likelihood.</p></a></li>
<li><a href='#rand.eff.unpenalized'><p>Estimate soft constraint model parameters using the EM algorithm.</p></a></li>
<li><a href='#unconstrained.unpenalized'><p>Estimate unconstrained model parameters.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mediation Analysis with External Summary-Level Information on
Total Effect</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits the hard constraint, soft constraint, and unconstrained models 
    in Boss et al. (2023) &lt;<a href="https://arxiv.org/abs/2306.17347">arXiv:2306.17347</a>&gt; for mediation analyses with external summary-level 
    information on the total effect.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Kleinsasser &lt;mkleinsa@umich.edu&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, ggplot2, patchwork, progress</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/umich-cphds/messi">https://github.com/umich-cphds/messi</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/umich-cphds/messi/issues">https://github.com/umich-cphds/messi/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-11 20:16:09 UTC; mk</td>
</tr>
<tr>
<td>Author:</td>
<td>Jonathan Boss [aut],
  Bhramar Mukherjee [aut],
  Michael Kleinsasser [cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-13 14:00:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='constrained.unpenalized'>Estimate hard constraint model parameters using cyclical coordinate descent.</h2><span id='topic+constrained.unpenalized'></span>

<h3>Description</h3>

<p>Estimate hard constraint model parameters using cyclical coordinate descent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constrained.unpenalized(
  Y,
  M,
  A,
  C = NULL,
  T.hat.external,
  err.tol.out = 1e-08,
  err.tol.med = 1e-08,
  max.itr = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constrained.unpenalized_+3A_y">Y</code></td>
<td>
<p>A (n x 1) continuous outcome vector.</p>
</td></tr>
<tr><td><code id="constrained.unpenalized_+3A_m">M</code></td>
<td>
<p>A (n x p_m) matrix of mediators.</p>
</td></tr>
<tr><td><code id="constrained.unpenalized_+3A_a">A</code></td>
<td>
<p>A (n x 1) vector of exposures.</p>
</td></tr>
<tr><td><code id="constrained.unpenalized_+3A_c">C</code></td>
<td>
<p>A (n x p_c) matrix of confounders and adjustment covariates. If there are no confounders or adjustment covariates set C = NULL.</p>
</td></tr>
<tr><td><code id="constrained.unpenalized_+3A_t.hat.external">T.hat.external</code></td>
<td>
<p>External estimate of the total effect.</p>
</td></tr>
<tr><td><code id="constrained.unpenalized_+3A_err.tol.out">err.tol.out</code></td>
<td>
<p>Termination condition for cyclical coordinate descent algorithm with respect to the outcome model parameters.</p>
</td></tr>
<tr><td><code id="constrained.unpenalized_+3A_err.tol.med">err.tol.med</code></td>
<td>
<p>Termination condition for cyclical coordinate descent algorithm with respect to the mediator model parameters.</p>
</td></tr>
<tr><td><code id="constrained.unpenalized_+3A_max.itr">max.itr</code></td>
<td>
<p>Maximum number of iterations for cyclical coordinate descent algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing point estimates of the hard constraint model parameters and an indicator of whether the algorithm converges.
</p>

<hr>
<h2 id='Med'>Simulated data with real mediation effect</h2><span id='topic+Med'></span>

<h3>Description</h3>

<p>Simulated data with real mediation effect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Med
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Med)
</code></pre>

<hr>
<h2 id='messi'>Implementation of Mediation with External Summary Statistics Information (MESSI) from Boss et al. (2023).</h2><span id='topic+messi'></span>

<h3>Description</h3>

<p>Implementation of Mediation with External Summary Statistics Information (MESSI) from Boss et al. (2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>messi(
  Y,
  M,
  A,
  C = NULL,
  method = "Soft EB",
  T.hat.external,
  var.T.hat.external,
  n.boot = 200,
  s2.fixed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="messi_+3A_y">Y</code></td>
<td>
<p>A (n x 1) continuous outcome vector.</p>
</td></tr>
<tr><td><code id="messi_+3A_m">M</code></td>
<td>
<p>A (n x p_m) matrix of mediators.</p>
</td></tr>
<tr><td><code id="messi_+3A_a">A</code></td>
<td>
<p>A (n x 1) vector of exposures.</p>
</td></tr>
<tr><td><code id="messi_+3A_c">C</code></td>
<td>
<p>A (n x p_c) matrix of confounders and adjustment covariates. If there are no confounders or adjustment covariates set C = NULL.</p>
</td></tr>
<tr><td><code id="messi_+3A_method">method</code></td>
<td>
<p>A string specifying which method to use. Options include 'Unconstrained', 'Hard', 'Soft EB', and 'Soft Fixed'. Default is 'Soft EB'.</p>
</td></tr>
<tr><td><code id="messi_+3A_t.hat.external">T.hat.external</code></td>
<td>
<p>External estimate of the total effect. Set to NULL if method = 'Unconstrained'.</p>
</td></tr>
<tr><td><code id="messi_+3A_var.t.hat.external">var.T.hat.external</code></td>
<td>
<p>Estimated variance of the external estimator of the total effect. Set to NULL if method = 'Unconstrained' or method = 'Hard'.</p>
</td></tr>
<tr><td><code id="messi_+3A_n.boot">n.boot</code></td>
<td>
<p>Number of parametric bootstrap draws for obtaining quantile-based confidence intervals for the TE and NDE. Relevant for method = 'Soft EB' and method = 'Soft Fixed'. Can set to NULL for method = 'Unconstrained' and method = 'Hard'.</p>
</td></tr>
<tr><td><code id="messi_+3A_s2.fixed">s2.fixed</code></td>
<td>
<p>Option to specify the tuning parameter s^2 in the soft constraint model. Only use if method = 'Soft Fixed'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Soft EB method should be the default method if the user is not sure which
method to use.
</p>


<h3>Value</h3>

<p>A list containing the (1) point estimates and confidence intervals for the natural direct effect, the natural indirect effect, and the total effect (2) point estimates for all mediation model parameters (3) the asymptotic variance covariance matrix corresponding to alpha_a and beta_m.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Med)

Y = Med$Y
M = Med$M
A = Med$A
C = Med$C
T.hat.external = Med$T.hat.external
var.T.hat.external = Med$var.T.hat.external

test &lt;- messi(Y = Y, M = M, A = A, C = C, method = 'Unconstrained', T.hat.external = T.hat.external,
              var.T.hat.external = var.T.hat.external, s2.fixed = NULL)

n = Med$n
p = Med$p

plot_messi(n = n, alpha.a.hat = test$alpha.a.hat, beta.m.hat = test$beta.m.hat, 
           labels = paste0("M",1:p), asym.var.mat = test$asym.var.mat)
              
test &lt;- messi(Y = Y, M = M, A = A, C = C, method = 'Hard', T.hat.external = T.hat.external,
              var.T.hat.external = var.T.hat.external, s2.fixed = NULL)

</code></pre>

<hr>
<h2 id='nullMed'>Simulated data with null mediation effect</h2><span id='topic+nullMed'></span>

<h3>Description</h3>

<p>Simulated data with null mediation effect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nullMed
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nullMed)
</code></pre>

<hr>
<h2 id='plot_messi'>Forestplot to Summarize Estimation and Inference on alpha_a and beta_m.</h2><span id='topic+plot_messi'></span>

<h3>Description</h3>

<p>Forestplot to Summarize Estimation and Inference on alpha_a and beta_m.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_messi(n, alpha.a.hat, beta.m.hat, labels, asym.var.mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_messi_+3A_n">n</code></td>
<td>
<p>Sample size of the analysis</p>
</td></tr>
<tr><td><code id="plot_messi_+3A_alpha.a.hat">alpha.a.hat</code></td>
<td>
<p>Estimate of alpha_a, a (p_m x 1) vector.</p>
</td></tr>
<tr><td><code id="plot_messi_+3A_beta.m.hat">beta.m.hat</code></td>
<td>
<p>Estimate of beta_m, a (p_m x 1) vector.</p>
</td></tr>
<tr><td><code id="plot_messi_+3A_labels">labels</code></td>
<td>
<p>A (p_m x 1) vector of mediator names. Make sure that the labels are in the same order as the mediators appear in the design matrix.</p>
</td></tr>
<tr><td><code id="plot_messi_+3A_asym.var.mat">asym.var.mat</code></td>
<td>
<p>Joint asymptotic variance-covariance matrix of alpha_a and beta_m, a (2p_m x 2p_m) matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frames and forestplots summarizing alpha_a and beta_m estimation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Med)

Y = Med$Y
M = Med$M
A = Med$A
C = Med$C
T.hat.external = Med$T.hat.external
var.T.hat.external = Med$var.T.hat.external

test &lt;- messi(Y = Y, M = M, A = A, C = C, method = 'Unconstrained', T.hat.external = T.hat.external,
              var.T.hat.external = var.T.hat.external, s2.fixed = NULL)

n = Med$n
p = Med$p

plot_messi(n = n, alpha.a.hat = test$alpha.a.hat, beta.m.hat = test$beta.m.hat, 
           labels = paste0("M",1:p), asym.var.mat = test$asym.var.mat)


</code></pre>

<hr>
<h2 id='rand.eff.coord.desc.unpenalized'>Cyclical coordinate descent algorithm for the M-step in the EM Algorithm for the maximizing the soft constraint model likelihood.</h2><span id='topic+rand.eff.coord.desc.unpenalized'></span>

<h3>Description</h3>

<p>Cyclical coordinate descent algorithm for the M-step in the EM Algorithm for the maximizing the soft constraint model likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand.eff.coord.desc.unpenalized(
  Y,
  M,
  A,
  C = NULL,
  first.moment,
  second.moment,
  err.tol.out = 1e-08,
  err.tol.med = 1e-08,
  max.itr = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_y">Y</code></td>
<td>
<p>A (n x 1) continuous outcome vector.</p>
</td></tr>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_m">M</code></td>
<td>
<p>A (n x p_m) matrix of mediators.</p>
</td></tr>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_a">A</code></td>
<td>
<p>A (n x 1) vector of exposures.</p>
</td></tr>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_c">C</code></td>
<td>
<p>A (n x p_c) matrix of confounders and adjustment covariates. If there are no confounders or adjustment covariates set C = NULL.</p>
</td></tr>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_first.moment">first.moment</code></td>
<td>
<p>Posterior expectation of the total effect parameter.</p>
</td></tr>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_second.moment">second.moment</code></td>
<td>
<p>Posterior expection of the squared total effect parameter.</p>
</td></tr>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_err.tol.out">err.tol.out</code></td>
<td>
<p>Termination condition for cyclical coordinate descent algorithm with respect to the outcome model parameters.</p>
</td></tr>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_err.tol.med">err.tol.med</code></td>
<td>
<p>Termination condition for cyclical coordinate descent algorithm with respect to the mediator model parameters.</p>
</td></tr>
<tr><td><code id="rand.eff.coord.desc.unpenalized_+3A_max.itr">max.itr</code></td>
<td>
<p>Maximum number of iterations for cyclical coordinate descent algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing point estimates of the soft constraint model parameters and an indicator of whether the algorithm converges.
</p>

<hr>
<h2 id='rand.eff.unpenalized'>Estimate soft constraint model parameters using the EM algorithm.</h2><span id='topic+rand.eff.unpenalized'></span>

<h3>Description</h3>

<p>Estimate soft constraint model parameters using the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand.eff.unpenalized(
  Y,
  M,
  A,
  C = NULL,
  rand.eff.mean,
  rand.eff.var,
  T.hat.external = T.hat.external,
  var.T.hat.external = var.T.hat.external,
  err.tol.out = 1e-08,
  err.tol.med = 1e-08,
  max.itr = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rand.eff.unpenalized_+3A_y">Y</code></td>
<td>
<p>A (n x 1) continuous outcome vector.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_m">M</code></td>
<td>
<p>A (n x p_m) matrix of mediators.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_a">A</code></td>
<td>
<p>A (n x 1) vector of exposures.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_c">C</code></td>
<td>
<p>A (n x p_c) matrix of confounders and adjustment covariates. If there are no confounders or adjustment covariates set C = NULL.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_rand.eff.mean">rand.eff.mean</code></td>
<td>
<p>Mean of the random effects distribution for the internal total effect parameter.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_rand.eff.var">rand.eff.var</code></td>
<td>
<p>Variance of the random effects distribution for the internal total effect parameter.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_t.hat.external">T.hat.external</code></td>
<td>
<p>External estimate of the total effect.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_var.t.hat.external">var.T.hat.external</code></td>
<td>
<p>Estimated variance of the external total effect estimator.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_err.tol.out">err.tol.out</code></td>
<td>
<p>Termination condition for cyclical coordinate descent algorithm with respect to the outcome model parameters.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_err.tol.med">err.tol.med</code></td>
<td>
<p>Termination condition for cyclical coordinate descent algorithm with respect to the mediator model parameters.</p>
</td></tr>
<tr><td><code id="rand.eff.unpenalized_+3A_max.itr">max.itr</code></td>
<td>
<p>Maximum number of iterations for cyclical coordinate descent algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing point estimates of the soft constraint model parameters and an indicator of whether the algorithm converges.
</p>

<hr>
<h2 id='unconstrained.unpenalized'>Estimate unconstrained model parameters.</h2><span id='topic+unconstrained.unpenalized'></span>

<h3>Description</h3>

<p>Estimate unconstrained model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unconstrained.unpenalized(Y, M, A, C = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unconstrained.unpenalized_+3A_y">Y</code></td>
<td>
<p>A (n x 1) continuous outcome vector.</p>
</td></tr>
<tr><td><code id="unconstrained.unpenalized_+3A_m">M</code></td>
<td>
<p>A (n x p_m) matrix of mediators.</p>
</td></tr>
<tr><td><code id="unconstrained.unpenalized_+3A_a">A</code></td>
<td>
<p>A (n x 1) vector of exposures.</p>
</td></tr>
<tr><td><code id="unconstrained.unpenalized_+3A_c">C</code></td>
<td>
<p>A (n x p_c) matrix of confounders and adjustment covariates. If there are no confounders or adjustment covariates set C = NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing point estimates of the unconstrained model parameters.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
