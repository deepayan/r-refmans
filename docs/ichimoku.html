<!DOCTYPE html><html><head><title>Help for package ichimoku</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ichimoku}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ichimoku-package'><p>ichimoku: Visualization and Tools for Ichimoku Kinko Hyo Strategies</p></a></li>
<li><a href='#.ichimoku'><p>ichimoku Technical Utility Version</p></a></li>
<li><a href='#archive'><p>Read/write Objects &lt;&gt; Archive Files with Data Verification</p></a></li>
<li><a href='#as.data.frame.ichimoku'><p>Convert ichimoku to data.frame</p></a></li>
<li><a href='#autoplot'><p>Plot Ichimoku Objects with ggplot2</p></a></li>
<li><a href='#autostrat'><p>Automated Ichimoku Strategies</p></a></li>
<li><a href='#coredata'><p>Extract the Core Data of Ichimoku Objects</p></a></li>
<li><a href='#df_append'><p>Append New Data to Dataframe</p></a></li>
<li><a href='#df_merge'><p>Merge Dataframes</p></a></li>
<li><a href='#grid_dup'><p>Duplicates of expand.grid for 2 Variables</p></a></li>
<li><a href='#hasStrat'><p>hasStrat</p></a></li>
<li><a href='#ichimoku'><p>ichimoku</p></a></li>
<li><a href='#index'><p>Extract the Index of Ichimoku Objects</p></a></li>
<li><a href='#iplot'><p>Interactive Ichimoku Cloud Plot</p></a></li>
<li><a href='#is.ichimoku'><p>is.ichimoku</p></a></li>
<li><a href='#look'><p>Look at Informational Attributes</p></a></li>
<li><a href='#matrix_df'><p>Convert matrix to data.frame</p></a></li>
<li><a href='#mlgrid'><p>mlgrid Numeric Representation</p></a></li>
<li><a href='#more'><p>Print More Rows of Ichimoku Objects</p></a></li>
<li><a href='#oanda'><p>OANDA Price Data</p></a></li>
<li><a href='#oanda_chart'><p>OANDA Real-time Cloud Charts</p></a></li>
<li><a href='#oanda_instruments'><p>Available OANDA Instruments</p></a></li>
<li><a href='#oanda_orders'><p>OANDA Order Book</p></a></li>
<li><a href='#oanda_positions'><p>OANDA Position Book</p></a></li>
<li><a href='#oanda_quote'><p>OANDA Quote Latest Price</p></a></li>
<li><a href='#oanda_set_key'><p>Set OANDA fxTrade API Key</p></a></li>
<li><a href='#oanda_stream'><p>OANDA Streaming Data</p></a></li>
<li><a href='#oanda_studio'><p>OANDA Studio Interactive Live Analysis</p></a></li>
<li><a href='#oanda_switch'><p>Switch Default OANDA Server</p></a></li>
<li><a href='#oanda_view'><p>OANDA View Market Performance</p></a></li>
<li><a href='#plot.ichimoku'><p>Plot Ichimoku Cloud Chart</p></a></li>
<li><a href='#print.ichimoku'><p>Print Ichimoku Objects</p></a></li>
<li><a href='#relative'><p>Relative Numeric Representation</p></a></li>
<li><a href='#sample_ohlc_data'><p>Sample OHLC Price Data</p></a></li>
<li><a href='#str.ichimoku'><p>Display the Structure of Ichimoku Objects</p></a></li>
<li><a href='#strat'><p>Create Ichimoku Strategies</p></a></li>
<li><a href='#stratcombine'><p>Combine Ichimoku Strategies</p></a></li>
<li><a href='#summary.ichimoku'><p>Summary of Ichimoku Objects and Strategies</p></a></li>
<li><a href='#tradingDays'><p>Select Trading Days</p></a></li>
<li><a href='#xts_df'><p>Convert xts to data.frame</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualization and Tools for Ichimoku Kinko Hyo Strategies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.3</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of 'Ichimoku Kinko Hyo', also commonly known as
    'cloud charts'. Static and interactive visualizations with tools for
    creating, backtesting and development of quantitative 'ichimoku' strategies.
    As described in Sasaki (1996, ISBN:4925152009), the technique is a refinement
    on candlestick charting, originating from Japan and now in widespread use in
    technical analysis worldwide. Translating as 'one-glance equilibrium chart',
    it allows the price action and market structure of financial securities to
    be determined 'at-a-glance'. Incorporates an interface with the OANDA
    fxTrade API <a href="https://developer.oanda.com/">https://developer.oanda.com/</a> for retrieving historical and
    live streaming price data for major currencies, metals, commodities,
    government bonds and stock indices.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/shikokuchuo/ichimoku/issues">https://github.com/shikokuchuo/ichimoku/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://shikokuchuo.net/ichimoku/">https://shikokuchuo.net/ichimoku/</a>,
<a href="https://github.com/shikokuchuo/ichimoku/">https://github.com/shikokuchuo/ichimoku/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.4.0), mirai (&ge; 1.0.0), nanonext (&ge; 1.0.0),
RcppSimdJson (&ge; 0.1.9), secretbase (&ge; 1.0.0), shiny (&ge;
1.4.0), xts, zoo</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppSimdJson, xts</td>
</tr>
<tr>
<td>Suggests:</td>
<td>keyring, knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-23 10:24:20 UTC; cg334</td>
</tr>
<tr>
<td>Author:</td>
<td>Charlie Gao <a href="https://orcid.org/0000-0002-0750-061X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Hibiki AI Limited [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Charlie Gao &lt;charlie.gao@shikokuchuo.net&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-23 10:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ichimoku-package'>ichimoku: Visualization and Tools for Ichimoku Kinko Hyo Strategies</h2><span id='topic+ichimoku-package'></span>

<h3>Description</h3>

<p>An implementation of 'Ichimoku Kinko Hyo', also commonly known as 'cloud
charts'. Static and interactive visualizations with tools for creating,
backtesting and development of quantitative 'ichimoku' strategies. As
described in Sasaki (1996, ISBN:4925152009), the technique is a
refinement on candlestick charting, originating from Japan and now in
widespread use in technical analysis worldwide. Translating as
'one-glance equilibrium chart', it allows the price action and market
structure of financial securities to be determined 'at-a-glance'.
Incorporates an interface with the OANDA fxTrade API
<a href="https://developer.oanda.com/">https://developer.oanda.com/</a> for retrieving historical and live
streaming price data for major currencies, metals, commodities,
government bonds and stock indices.
</p>


<h3>Principal ichimoku functions</h3>

<p>Data &amp; Visualization
</p>

<ul>
<li> <p><code><a href="#topic+ichimoku">ichimoku</a></code> to create an ichimoku object from price
data.
</p>
</li>
<li> <p><code><a href="#topic+plot.ichimoku">plot.ichimoku</a></code> / <code><a href="#topic+iplot">iplot</a></code> to plot
(interactive) cloud charts from ichimoku objects.
</p>
</li>
<li> <p><code><a href="#topic+archive">archive</a></code> for reading/writing objects to/from archive
files with data verification.
</p>
</li>
<li> <p><code><a href="#topic+oanda">oanda</a></code> to retrieve price data from the OANDA fxTrade
API.
</p>
</li></ul>

<p>Strategies &amp; ML
</p>

<ul>
<li> <p><code><a href="#topic+strat">strat</a></code> to augment an ichimoku object with a strategy,
including combined and asymmetric strategies.
</p>
</li>
<li> <p><code><a href="#topic+autostrat">autostrat</a></code> to automatically evaluate and rank
top-performing strategies.
</p>
</li>
<li> <p><code><a href="#topic+mlgrid">mlgrid</a></code> to generate a numeric representation of the
ichimoku cloud chart.
</p>
</li>
<li> <p><code><a href="#topic+relative">relative</a></code> to produce a statistical summary of the
latest ichimoku numeric representation relative to historical values.
</p>
</li></ul>

<p>Real-time
</p>

<ul>
<li> <p><code><a href="#topic+oanda_chart">oanda_chart</a></code> to plot real-time ichimoku cloud charts
using OANDA data.
</p>
</li>
<li> <p><code><a href="#topic+oanda_studio">oanda_studio</a></code> a complete live analysis environment
using OANDA data implemented in R Shiny.
</p>
</li>
<li> <p><code><a href="#topic+oanda_stream">oanda_stream</a></code> / <code><a href="#topic+oanda_quote">oanda_quote</a></code> to obtain
the latest live data stream / quote from the OANDA fxTrade API.
</p>
</li>
<li> <p><code><a href="#topic+oanda_view">oanda_view</a></code> for a market overview showing the
relative performance of constituents.
</p>
</li>
<li> <p><code><a href="#topic+oanda_orders">oanda_orders</a></code> / <code><a href="#topic+oanda_positions">oanda_positions</a></code> to
retrieve the aggregate OANDA fxTrade order / position book.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Charlie Gao <a href="mailto:charlie.gao@shikokuchuo.net">charlie.gao@shikokuchuo.net</a>
(<a href="https://orcid.org/0000-0002-0750-061X">ORCID</a>)
</p>


<h3>References</h3>

<p>Sasaki, H. (1996), <em>ichimoku kinkouhyou no kenkyuu</em>. Tokyo,
Japan: Toushi Radar.
</p>
<p>OANDA' and 'fxTrade' are trademarks owned by OANDA Corporation, an entity
unaffiliated with the ichimoku package, its authors or copyright holders.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://shikokuchuo.net/ichimoku/">https://shikokuchuo.net/ichimoku/</a>
</p>
</li>
<li> <p><a href="https://github.com/shikokuchuo/ichimoku/">https://github.com/shikokuchuo/ichimoku/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/shikokuchuo/ichimoku/issues">https://github.com/shikokuchuo/ichimoku/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.ichimoku'>ichimoku Technical Utility Version</h2><span id='topic+.ichimoku'></span>

<h3>Description</h3>

<p>Create an ichimoku object containing values for all components of the
Ichimoku Kinko Hyo cloud chart. The object encapsulates a date-time
index, OHLC pricing data, candle direction, the cloud lines Tenkan-sen,
Kijun-sen, Senkou span A, Senkou span B and Chikou span, as well as
values for the cloud top and cloud base.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ichimoku(x, ticker, periods = c(9L, 26L, 52L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ichimoku_+3A_x">x</code></td>
<td>
<p>a data.frame object with a POSIXct date-time index as the first
column and numeric OHLC pricing data as the second through fifth columns.</p>
</td></tr>
<tr><td><code id=".ichimoku_+3A_ticker">ticker</code></td>
<td>
<p>(optional) specify a ticker to identify the instrument,
otherwise this is set to the name of the input object.</p>
</td></tr>
<tr><td><code id=".ichimoku_+3A_periods">periods</code></td>
<td>
<p>[default c(9L, 26L, 52L)] a vector defining the length of
periods used for the cloud. This parameter shoud not normally be modified
as using other values would be invalid in the context of traditional
ichimoku analysis.</p>
</td></tr>
<tr><td><code id=".ichimoku_+3A_...">...</code></td>
<td>
<p>additional arguments, for instance 'holidays', passed along to
<code><a href="#topic+tradingDays">tradingDays</a></code> for calculating the future cloud on daily data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A faster version of <code><a href="#topic+ichimoku">ichimoku</a></code> which can be used when
the data is a dataframe in the prescribed format. Does not support the
argument 'keep.data'.
</p>


<h3>Value</h3>

<p>An ichimoku object with S3 classes of 'ichimoku', 'xts' and 'zoo'.
</p>

<hr>
<h2 id='archive'>Read/write Objects &lt;&gt; Archive Files with Data Verification</h2><span id='topic+archive'></span>

<h3>Description</h3>

<p>Read and write objects to/from archival storage in the native RData format,
with verification of data integrity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>archive(..., object, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="archive_+3A_...">...</code></td>
<td>
<p>unnamed arguments will be parsed as 'file' if there is only one
argument, 'object' and 'file' if there are two arguments.</p>
</td></tr>
<tr><td><code id="archive_+3A_object">object</code></td>
<td>
<p>(for write operations) an object.</p>
</td></tr>
<tr><td><code id="archive_+3A_file">file</code></td>
<td>
<p>the name of the file or a connection where the object is saved to
or read from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For read operations: specify only 'file', or alternatively if no
arguments are specified, a system dialog will be opened allowing a file
to be chosen interactively. 'file' is read and the return value may be
assigned to an object. A confirmation message is issued if the file read
operation has been successful.
</p>
<p>For write operations: specify both 'object' and 'file'. If only 'object'
is specified and 'file' is left empty (see examples), a system dialog
will be opened allowing the file save location to be chosen interactively.
'object' will be written to 'file'. A confirmation message is issued if
the file write operation has been successful.
</p>


<h3>Value</h3>

<p>For read operations: the object originally archived.
</p>
<p>For write operations: the filename supplied. 'object' is written to 'file'.
</p>


<h3>Data Verification</h3>

<p>A SHA256 hash of the original object is written to the archive. This
allows the data integrity of the restored object to be verified when the
archive is read back.
</p>
<p>For write operations: confirmation of the SHA256 hash written to file
is displayed.
</p>
<p>For read operations: a 'data verified' message is issued if the SHA256
hash found within the data file has been authenticated.
</p>


<h3>Further Details</h3>

<p>Please refer to the reference vignette by calling:
<code>vignette("reference", package = "ichimoku")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
file &lt;- tempfile()

archive(cloud, file)

restored &lt;- archive(file)

unlink(file)

if (interactive()) {
# Only run examples in interactive R sessions
# Read file to 'object' using system dialog:
object &lt;- archive()

# Write 'cloud' to file using system dialog:
archive(cloud, )
}

</code></pre>

<hr>
<h2 id='as.data.frame.ichimoku'>Convert ichimoku to data.frame</h2><span id='topic+as.data.frame.ichimoku'></span>

<h3>Description</h3>

<p>An optimised 'ichimoku' to 'data.frame' constructor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ichimoku'
as.data.frame(x, row.names, optional, keep.attrs = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.ichimoku_+3A_x">x</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="as.data.frame.ichimoku_+3A_row.names">row.names</code></td>
<td>
<p>not used.</p>
</td></tr>
<tr><td><code id="as.data.frame.ichimoku_+3A_optional">optional</code></td>
<td>
<p>not used.</p>
</td></tr>
<tr><td><code id="as.data.frame.ichimoku_+3A_keep.attrs">keep.attrs</code></td>
<td>
<p>[default FALSE] if set to TRUE, will preserve any custom
attributes set on the original object.</p>
</td></tr>
<tr><td><code id="as.data.frame.ichimoku_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an S3 method for the generic function
as.data.frame() for class 'ichimoku'. It can be invoked by calling
as.data.frame(x) on an object 'x' of class 'ichimoku'.
</p>


<h3>Value</h3>

<p>A 'data.frame' object. The ichimoku object index is preserved as the
first column with header 'index'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data)
df &lt;- as.data.frame(cloud)
str(df)

df2 &lt;- as.data.frame(cloud, keep.attrs = TRUE)
str(df2)

</code></pre>

<hr>
<h2 id='autoplot'>Plot Ichimoku Objects with ggplot2</h2><span id='topic+autoplot'></span><span id='topic+autoplot.ichimoku'></span>

<h3>Description</h3>

<p>Plot Ichimoku Kinko Hyo cloud charts from ichimoku objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ichimoku'
autoplot(
  object,
  window,
  ticker,
  subtitle,
  theme = c("classic", "dark", "mono", "noguchi", "okabe-ito", "solarized"),
  strat = TRUE,
  type = c("none", "r", "s", "bar", "line"),
  custom,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot_+3A_object">object</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_window">window</code></td>
<td>
<p>(optional) a date-time window to subset the plot, in ISO-8601
compatible range strings of the format used for 'xts' objects, for example
&quot;2020-02-15/2020-08-15&quot; or &quot;2020-02-15/&quot;, &quot;/2020-08&quot; or &quot;2020-07&quot;.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_ticker">ticker</code></td>
<td>
<p>(optional) specify a ticker (or other text) to include in the
chart heading. If not set, the ticker saved within the ichimoku object
will be used.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_subtitle">subtitle</code></td>
<td>
<p>(optional) specify a subtitle to display under the chart title.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_theme">theme</code></td>
<td>
<p>[default 'classic'] with further choices of 'dark', 'mono',
'noguchi', 'okabe-ito' or 'solarized'. Alternatively, supply a vector
of 12 colour values (hex codes or names) as a user-defined theme.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_strat">strat</code></td>
<td>
<p>[default TRUE] if the ichimoku object contains a strategy, the
periods for which the strategy results in a position will be shaded, and
the strategy printed as the chart subtitle (if not otherwise specified).
Set to FALSE to turn off this behaviour.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_type">type</code></td>
<td>
<p>[default 'none'] type of sub-plot to display beneath the ichimoku
cloud chart, with a choice of 'none', 'r' or 's' for the corresponding
oscillator type, and 'bar' or 'line' for custom plots.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_custom">custom</code></td>
<td>
<p>(optional) character string (containing a regular expression)
matching the column name of the variable to be displayed as sub-plot.
Specify <code>type = 'bar'</code> or <code>type = 'line'</code>, otherwise other type
settings will take precedence.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_...">...</code></td>
<td>
<p>other arguments not used by this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an S3 method for the generic function autoplot()
for class 'ichimoku'. It can be invoked by calling autoplot(x) on an
object 'x' of class 'ichimoku'.
</p>


<h3>Value</h3>

<p>A ggplot2 object with S3 classes 'gg' and 'ggplot'.
</p>

<hr>
<h2 id='autostrat'>Automated Ichimoku Strategies</h2><span id='topic+autostrat'></span>

<h3>Description</h3>

<p>Generate a list of the top performing ichimoku cloud strategies based on
simple indicator conditions of the form 'c1 &gt; c2' (level 1), complex
combined strategies of the form 'c1 &gt; c2 &amp; c3 &gt; c4' (level 2), or complex
asymmetric strategies of the form 'c1 &gt; c2 x c3 &gt; c4' (level 3).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autostrat(x, n = 8, dir = c("long", "short"), level = 1, quietly)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autostrat_+3A_x">x</code></td>
<td>
<p>an ichimoku object.</p>
</td></tr>
<tr><td><code id="autostrat_+3A_n">n</code></td>
<td>
<p>[default 8] select top 'n' number of strategies to return.</p>
</td></tr>
<tr><td><code id="autostrat_+3A_dir">dir</code></td>
<td>
<p>[default 'long'] trade direction, either 'long' or 'short'.</p>
</td></tr>
<tr><td><code id="autostrat_+3A_level">level</code></td>
<td>
<p>[default 1] to return simple strategies. For complex strategies,
set level to 2 to return combined strategies of the form 's1 &amp; s2' or
level to 3 to return asymmetric strategies of the form 's1 x s2'.</p>
</td></tr>
<tr><td><code id="autostrat_+3A_quietly">quietly</code></td>
<td>
<p>(optional) if set to TRUE, will suppress printing of additional
output to the console and return quietly.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ichimoku objects for each strategy are returned as a list. The
cumulative log returns for all strategies as well as the summaries for
the top 'n' strategies are saved as attributes to the list. This
information may be retrieved by using <code><a href="#topic+look">look</a></code> on the returned
list.
</p>
<p>Each individual ichimoku object may be accessed via its position in the
list, e.g. [[1]] for the 1st item.
</p>


<h3>Value</h3>

<p>Returned invisibly, a list of 'n' ichimoku objects containing
strategies, with attributes 'logret' (a vector of cumulative log returns
for all strategies) and 'summary' (a matrix of summaries for the top 'n'
strategies).
</p>
<p>In addition, the strategy summaries are printed to the console.
</p>


<h3>Further Details</h3>

<p>Please refer to the strategies vignette by calling:
<code>vignette("strategies", package = "ichimoku")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")

stratlist &lt;- autostrat(cloud, n = 3, quietly = TRUE)
look(stratlist)
strat &lt;- stratlist[[2]]
summary(strat)

autostrat(cloud, n = 1, dir = "short", level = 2)
autostrat(cloud, n = 1, dir = "long", level = 3)

</code></pre>

<hr>
<h2 id='coredata'>Extract the Core Data of Ichimoku Objects</h2><span id='topic+coredata'></span><span id='topic+coredata.ichimoku'></span>

<h3>Description</h3>

<p>Method for extracting the core data matrix of ichimoku objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ichimoku'
coredata(x, fmt, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coredata_+3A_x">x</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="coredata_+3A_fmt">fmt</code></td>
<td>
<p>(optional) set to TRUE to retain the index as row names of the
returned matrix, or a character string passed on to the 'format' argument
of <code>format.POSIXct()</code> to format these values in a specific way.</p>
</td></tr>
<tr><td><code id="coredata_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an S3 method for the generic function coredata()
for class 'ichimoku'. It can be invoked by calling coredata(x) on an
object 'x' of class 'ichimoku'.
</p>


<h3>Value</h3>

<p>A numeric matrix containing the ichimoku object data, stripped of the
index unless 'fmt' is specified in which case the index will be retained
as character values in the matrix row names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data)
coredata(cloud)[101:120, ]

</code></pre>

<hr>
<h2 id='df_append'>Append New Data to Dataframe</h2><span id='topic+df_append'></span>

<h3>Description</h3>

<p>Update a 'data.frame' object with new data. Can be used to append new updated
time series data to an existing dataframe, where each observation is
indexed by a unique timestamp/identifier in a key column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_append(old, new, key = "time", keep.attr = "timestamp")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_append_+3A_old">old</code></td>
<td>
<p>data.frame object containing existing data.</p>
</td></tr>
<tr><td><code id="df_append_+3A_new">new</code></td>
<td>
<p>data.frame object containing new data.</p>
</td></tr>
<tr><td><code id="df_append_+3A_key">key</code></td>
<td>
<p>[default 'time'] column name used as key, provided as a character
string.</p>
</td></tr>
<tr><td><code id="df_append_+3A_keep.attr">keep.attr</code></td>
<td>
<p>[default 'timestamp'] name of an attribute in 'new' to
retain, if present, provided as a character string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can be used to update price dataframes retrieved by <code><a href="#topic+oanda">oanda</a></code>.
The function is designed to update existing data with new values as they
become available. As opposed to <code><a href="#topic+df_merge">df_merge</a></code>, the data in 'new'
will overwrite the data in 'old' rather than create duplicates.
</p>


<h3>Value</h3>

<p>A data.frame of the existing data appended with the new data. If the
data in 'new' contains data with the same value for the key column as 'old',
the data in 'new' will overwrite the data in 'old'.
</p>
<p>If the attribute specified by 'keep.attr' is present in 'new', this is
retained. All other non-required attributes are dropped.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data1 &lt;- sample_ohlc_data[1:8, ]
data1
data2 &lt;- sample_ohlc_data[7:10, ]
data2
df_append(data1, data2)

</code></pre>

<hr>
<h2 id='df_merge'>Merge Dataframes</h2><span id='topic+df_merge'></span>

<h3>Description</h3>

<p>Full join on an arbitrary number of 'data.frame' objects passed as arguments,
preserving all unique entries. Can be used to combine historical time
series data where each observation is indexed by a unique timestamp and
all periods are complete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_merge(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_merge_+3A_...">...</code></td>
<td>
<p>data.frame objects to combine.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can be used to join price dataframes retrieved by <code><a href="#topic+oanda">oanda</a></code>.
The function is designed to join complete historical data. If the data to
be merged contains data with incomplete periods, all entries are preserved
rather than updated. If incomplete periods are detected within the data,
a warning is issued, and the resulting dataframe should be manually checked
in case it contains unwanted duplicates. Use <code><a href="#topic+df_append">df_append</a></code> for
updating dataframes with new values.
</p>


<h3>Value</h3>

<p>A data.frame containing all unique entries in the objects passed as
argument.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data1 &lt;- sample_ohlc_data[1:6, ]
data1
data2 &lt;- sample_ohlc_data[4:10, ]
data2
df_merge(data1, data2)

</code></pre>

<hr>
<h2 id='grid_dup'>Duplicates of expand.grid for 2 Variables</h2><span id='topic+grid_dup'></span>

<h3>Description</h3>

<p>Create a vector of element positions of duplicates in the output of expand.grid
on 2 identical vectors. An efficient method of creating combinations for
2 variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid_dup(n, omit.id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid_dup_+3A_n">n</code></td>
<td>
<p>the length of vector passed to <code>expand.grid()</code>.</p>
</td></tr>
<tr><td><code id="grid_dup_+3A_omit.id">omit.id</code></td>
<td>
<p>(optional) set to TRUE to also select the elements where the 2
items are identical. The output of expand.grid, subset to remove
duplicates with 'omit.id' set to TRUE would be the equivalent of
<code>utils::combn(n, 2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 3
expand.grid(1:n, 1:n)
expand.grid(1:n, 1:n)[-grid_dup(n), ]
expand.grid(1:n, 1:n)[-grid_dup(n, omit.id = TRUE), ]

</code></pre>

<hr>
<h2 id='hasStrat'>hasStrat</h2><span id='topic+hasStrat'></span>

<h3>Description</h3>

<p>A function for checking if an object contains a strategy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hasStrat(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hasStrat_+3A_x">x</code></td>
<td>
<p>an object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Designed to be used by ichimoku functions that are either S3
methods for class 'ichimoku' or after validation that 'x' is an ichimoku
object, hence there is no check on the class of 'x' within this function.
</p>


<h3>Value</h3>

<p>A logical value of TRUE if the 'strat' attribute of 'x' is set,
otherwise FALSE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data)
strat &lt;- strat(cloud)

# TRUE:
hasStrat(strat)
# FALSE:
hasStrat(cloud)

</code></pre>

<hr>
<h2 id='ichimoku'>ichimoku</h2><span id='topic+ichimoku'></span><span id='topic+ichimoku.ichimoku'></span><span id='topic+ichimoku.xts'></span><span id='topic+ichimoku.data.frame'></span><span id='topic+ichimoku.matrix'></span><span id='topic+ichimoku.default'></span>

<h3>Description</h3>

<p>Create an ichimoku object containing values for all components of the
Ichimoku Kinko Hyo cloud chart. The object encapsulates a date-time
index, OHLC pricing data, candle direction, the cloud lines Tenkan-sen,
Kijun-sen, Senkou span A, Senkou span B and Chikou span, as well as
values for the cloud top and cloud base.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ichimoku(x, ticker, periods = c(9L, 26L, 52L), keep.data = FALSE, ...)

## S3 method for class 'ichimoku'
ichimoku(x, ticker, periods = c(9L, 26L, 52L), keep.data = FALSE, ...)

## S3 method for class 'xts'
ichimoku(x, ticker, periods = c(9L, 26L, 52L), keep.data = FALSE, ...)

## S3 method for class 'data.frame'
ichimoku(x, ticker, periods = c(9L, 26L, 52L), keep.data = FALSE, ...)

## S3 method for class 'matrix'
ichimoku(x, ticker, periods = c(9L, 26L, 52L), keep.data = FALSE, ...)

## Default S3 method:
ichimoku(x, ticker, periods = c(9L, 26L, 52L), keep.data = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ichimoku_+3A_x">x</code></td>
<td>
<p>a data.frame or other compatible object, which includes xts,
data.table, tibble, and matrix.</p>
</td></tr>
<tr><td><code id="ichimoku_+3A_ticker">ticker</code></td>
<td>
<p>(optional) specify a ticker to identify the instrument,
otherwise this is set to the name of the input object.</p>
</td></tr>
<tr><td><code id="ichimoku_+3A_periods">periods</code></td>
<td>
<p>[default c(9L, 26L, 52L)] a vector defining the length of
periods used for the cloud. This parameter shoud not normally be modified
as using other values would be invalid in the context of traditional
ichimoku analysis.</p>
</td></tr>
<tr><td><code id="ichimoku_+3A_keep.data">keep.data</code></td>
<td>
<p>[default FALSE] set to TRUE to retain additional data
present in the input object as additional columns and/or attributes.</p>
</td></tr>
<tr><td><code id="ichimoku_+3A_...">...</code></td>
<td>
<p>additional arguments, for instance 'holidays', passed along to
<code><a href="#topic+tradingDays">tradingDays</a></code> for calculating the future cloud on daily data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling an ichimoku object automatically invokes its print method,
which by default produces a printout of the data to the console as well
as a plot of the cloud chart to the graphical device.
</p>
<p>For further options, use <code>plot()</code> on the returned ichimoku object to
pass further arguments for customising the chart. Use <code>iplot()</code> for
interactive charting.
</p>
<p>Where an ichimoku object is passed to <code>ichimoku()</code>, the ichimoku
object is re-calculated using the OHLC pricing data contained within.
</p>


<h3>Value</h3>

<p>An ichimoku object with S3 classes of 'ichimoku', 'xts' and 'zoo'.
</p>


<h3>Ichimoku Object Specification</h3>

<p>Index:
</p>

<ul>
<li> <p><code>index(object)</code>: date-time index [POSIXct]
</p>
</li></ul>

<p>Columns [numeric]:
</p>

<ul>
<li> <p><code>object$open</code>: opening price
</p>
</li>
<li> <p><code>$high</code>: high price
</p>
</li>
<li> <p><code>$low</code>: low price
</p>
</li>
<li> <p><code>$close</code>: closing price
</p>
</li>
<li> <p><code>$cd</code>: candle direction (-1 = down, 0 = flat, 1 = up)
</p>
</li>
<li> <p><code>$tenkan</code>: Tenkan-sen
</p>
</li>
<li> <p><code>$kijun</code>: Kijun-sen
</p>
</li>
<li> <p><code>$senkouA</code>: Senkou span A
</p>
</li>
<li> <p><code>$senkouB</code>: Senkou span B
</p>
</li>
<li> <p><code>$chikou</code>: Chikou span
</p>
</li>
<li> <p><code>$cloudT</code>: cloud Top (max of senkouA, senkouB)
</p>
</li>
<li> <p><code>$cloudB</code>: cloud Base (min of senkouA, senkouB)
</p>
</li></ul>

<p>Attributes:
</p>

<ul>
<li> <p><code>attributes(object)$periods</code>: parameters used to calculate
the cloud [integer vector of length 3]
</p>
</li>
<li> <p><code>$periodicity</code>: periodicity of the data in seconds
[numeric]
</p>
</li>
<li> <p><code>$ticker</code>: instrument identifier [character]
</p>
</li></ul>



<h3>Further Details</h3>

<p><code>ichimoku()</code> requires OHLC (or else HLC) price data as input to
calculate the cloud chart values.
</p>
<p>If only single series price data is supplied, a <em>pseudo</em> OHLC series
is generated and a <em>pseudo</em> cloud chart is returned.
</p>
<p>A faster technical utility version of this function is available in
<code><a href="#topic+.ichimoku">.ichimoku</a></code> for use when the data is already in the required
format.
</p>
<p>Please refer to the reference vignette by calling:
<code>vignette("reference", package = "ichimoku")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TKR &lt;- sample_ohlc_data

cloud &lt;- ichimoku(TKR)
cloud

kumo &lt;- ichimoku(TKR, ticker = "TKR Co.", periods = c(9, 26, 52), keep.data = TRUE)
summary(kumo)
print(kumo, plot = FALSE, rows = 10)
plot(kumo, theme = "solarized", type = "bar", custom = "volume")

</code></pre>

<hr>
<h2 id='index'>Extract the Index of Ichimoku Objects</h2><span id='topic+index'></span><span id='topic+index.ichimoku'></span>

<h3>Description</h3>

<p>Method for extracting the date-time index of ichimoku objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ichimoku'
index(x, subset, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index_+3A_x">x</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="index_+3A_subset">subset</code></td>
<td>
<p>an integer or logical value or vector by which to subset the index.</p>
</td></tr>
<tr><td><code id="index_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an S3 method for the generic function index()
for class 'ichimoku'. It can be invoked by calling index(x) on an
object 'x' of class 'ichimoku'.
</p>
<p>Subsetting by specifying the 'subset' parameter subsets using the
numerical values underlying the POSIXct times and results in a faster
operation than usual subset operators such as '['.
</p>


<h3>Value</h3>

<p>The date-time index of the ichimoku object as a vector of POSIXct
values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data)
index(cloud)[101:110]
index(cloud, 101:110)

</code></pre>

<hr>
<h2 id='iplot'>Interactive Ichimoku Cloud Plot</h2><span id='topic+iplot'></span>

<h3>Description</h3>

<p>Plot Ichimoku Kinko Hyo cloud charts from ichimoku objects in R Shiny,
allowing full customisation of chart elements in an interactive
environment. Intuitive cursor infotip provides ready access to the data
directly from the chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iplot(
  x,
  ticker,
  subtitle,
  theme = c("classic", "dark", "mono", "noguchi", "okabe-ito", "solarized"),
  strat = TRUE,
  type = c("none", "r", "s", "bar", "line"),
  custom,
  ...,
  launch.browser = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iplot_+3A_x">x</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="iplot_+3A_ticker">ticker</code></td>
<td>
<p>(optional) specify a ticker (or other text) to include in the
chart heading. If not set, the ticker saved within the ichimoku object
will be used.</p>
</td></tr>
<tr><td><code id="iplot_+3A_subtitle">subtitle</code></td>
<td>
<p>(optional) specify a subtitle to display under the chart title.</p>
</td></tr>
<tr><td><code id="iplot_+3A_theme">theme</code></td>
<td>
<p>[default 'classic'] with further choices of 'dark', 'mono',
'noguchi', 'okabe-ito' or 'solarized'.</p>
</td></tr>
<tr><td><code id="iplot_+3A_strat">strat</code></td>
<td>
<p>[default TRUE] if the ichimoku object contains a strategy, the
periods for which the strategy results in a position will be shaded, and
the strategy printed as the chart subtitle (if not otherwise specified).
Set to FALSE to turn off this behaviour.</p>
</td></tr>
<tr><td><code id="iplot_+3A_type">type</code></td>
<td>
<p>[default 'none'] type of sub-plot to display beneath the ichimoku
cloud chart, with a choice of 'none', 'r' or 's' for the corresponding
oscillator type, and 'bar' or 'line' for custom plots.</p>
</td></tr>
<tr><td><code id="iplot_+3A_custom">custom</code></td>
<td>
<p>(optional) character string (containing a regular expression)
matching the column name of the variable to be displayed as sub-plot.
Specify <code>type = 'bar'</code> or <code>type = 'line'</code>, otherwise other type
settings will take precedence.</p>
</td></tr>
<tr><td><code id="iplot_+3A_...">...</code></td>
<td>
<p>additional parameters passed along to the 'options' argument of
<code>shiny::shinyApp()</code>.</p>
</td></tr>
<tr><td><code id="iplot_+3A_launch.browser">launch.browser</code></td>
<td>
<p>[default TRUE] If TRUE, the system's default web browser
will be launched automatically after the app is started. The value of this
argument can also be a function to call with the application's URL. To use
the default Shiny viewer in RStudio, please specify
<code>getOption("shiny.launch.browser")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For further details please refer to the reference vignette by
calling: <code>vignette("reference", package = "ichimoku")</code>
</p>


<h3>Value</h3>

<p>A Shiny app object with class 'shiny.appobj'. With default arguments,
the Shiny app is launched in the default browser.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
# Only run examples in interactive R sessions
cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
iplot(cloud)

# To open in RStudio viewer instead of default browser
iplot(cloud, launch.browser = getOption("shiny.launch.browser"))
}

</code></pre>

<hr>
<h2 id='is.ichimoku'>is.ichimoku</h2><span id='topic+is.ichimoku'></span>

<h3>Description</h3>

<p>A function for checking if an object is an ichimoku object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.ichimoku(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.ichimoku_+3A_x">x</code></td>
<td>
<p>an object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value of TRUE if 'x' is of class 'ichimoku', otherwise FALSE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data)

# TRUE:
is.ichimoku(cloud)
# FALSE:
is.ichimoku(sample_ohlc_data)

</code></pre>

<hr>
<h2 id='look'>Look at Informational Attributes</h2><span id='topic+look'></span>

<h3>Description</h3>

<p>Inspect the informational attributes of objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>look(x = .Last.value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="look_+3A_x">x</code></td>
<td>
<p>an object (optional). If 'x' is not supplied, <code><a href="base.html#topic+.Last.value">.Last.value</a></code>
will be used instead.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note: autostrat list attributes may be accessed directly using
<code>look(x)$logret</code> and <code>look(x)$summary</code>.
</p>


<h3>Value</h3>

<p>For objects created by the ichimoku package, a pairlist of attributes
specific to that data type.
</p>
<p>For other objects, a pairlist of non-standard attributes for matrix /
data.frame / xts classes, or else invisible NULL if none are present.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
look(cloud)

stratlist &lt;- autostrat(cloud, n = 3)
look(stratlist)

strat &lt;- stratlist[[1]]
look(strat)

grid &lt;- mlgrid(cloud)
look(grid)

## Not run: 
# OANDA API key required to run this example
prices &lt;- oanda("USD_JPY")
look(prices)

## End(Not run)

</code></pre>

<hr>
<h2 id='matrix_df'>Convert matrix to data.frame</h2><span id='topic+matrix_df'></span>

<h3>Description</h3>

<p>An optimised 'matrix' to 'data.frame' constructor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix_df(x, keep.attrs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix_df_+3A_x">x</code></td>
<td>
<p>a matrix.</p>
</td></tr>
<tr><td><code id="matrix_df_+3A_keep.attrs">keep.attrs</code></td>
<td>
<p>[default FALSE] if set to TRUE, will preserve any custom
attributes set on the original object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optimised data.frame constructors are used internally within
the package and made available as utilities. Please note that no data
validation or checking is performed.
</p>


<h3>Value</h3>

<p>A 'data.frame' object. If the matrix has row names, these are
retained by the dataframe.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data)
mcloud &lt;- as.matrix(cloud)
df &lt;- matrix_df(mcloud)
str(df)
str(rownames(df))

</code></pre>

<hr>
<h2 id='mlgrid'>mlgrid Numeric Representation</h2><span id='topic+mlgrid'></span>

<h3>Description</h3>

<p>Create a grid of ichimoku indicator conditions and next period returns. The
grid facilitates the comparison of strategy returns and provides a basis
for use in machine learning applications. Translates the visual
representation of the relationship between cloud chart elements into a
numerical format for further analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlgrid(
  x,
  y = c("logret", "ret", "none"),
  k = 1L,
  dir = c("long", "short"),
  type = c("boolean", "numeric", "z-score"),
  format = c("dataframe", "matrix"),
  unique = TRUE,
  expr = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlgrid_+3A_x">x</code></td>
<td>
<p>an ichimoku object.</p>
</td></tr>
<tr><td><code id="mlgrid_+3A_y">y</code></td>
<td>
<p>[default 'logret'] choose target variable 'logret' (log returns),
'ret' (discrete returns), or 'none'.</p>
</td></tr>
<tr><td><code id="mlgrid_+3A_k">k</code></td>
<td>
<p>[default 1L] number of periods time horizon over which to calculate
target variable 'y'.</p>
</td></tr>
<tr><td><code id="mlgrid_+3A_dir">dir</code></td>
<td>
<p>[default 'long'] trade direction, either 'long' or 'short'.</p>
</td></tr>
<tr><td><code id="mlgrid_+3A_type">type</code></td>
<td>
<p>[default 'boolean'] choose 'boolean', 'numeric' or 'z-score'.
'boolean' creates a grid of dummy variables for ichimoku indicator
conditions of the form 1 if c1 &gt; c2, 0 otherwise. 'numeric' creates a
grid of the numeric difference c1 - c2. 'z-score' standardises the numeric
grid by the mean and standard deviation of each feature.</p>
</td></tr>
<tr><td><code id="mlgrid_+3A_format">format</code></td>
<td>
<p>[default 'dataframe'] select either 'dataframe' or 'matrix' for
the format of returned object.</p>
</td></tr>
<tr><td><code id="mlgrid_+3A_unique">unique</code></td>
<td>
<p>[default TRUE] to return only unique combinations of c1 and c2.
Set to FALSE to return both c1 &gt; c2 and c2 &gt; c1.</p>
</td></tr>
<tr><td><code id="mlgrid_+3A_expr">expr</code></td>
<td>
<p>[default list()] (for advanced use only) a named list of
quoted language objects or expressions, which are evaluated internally
within the function, referencing intermediate objects such as:
'core', the coredata matrix of the ichimoku object, 'xlen' the number of
observations, or any of the function parameters etc. Each evaluated
expression must return a vector of length 'xlen' for inclusion in the grid.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The date-time index corresponds to when the indicator condition is
met at the close for that period. The return is the k-period return
achieved by transacting at the immediately following opening price until
the next opening price.
</p>
<p>Only valid combinations are included. This excludes any combination
involving 'open' as it is in effect a lagged indicator and not
contemporaneous. The following trivial or highly-collinear pairs are also
excluded: (high, close), (low, close), (low, high), (cloudTop, Senkou A),
(cloudBase, senkou A), (cloudTop, senkouB), (cloudBase, senkouB),
(cloudBase, cloudTop).
</p>


<h3>Value</h3>

<p>A data.frame or matrix in a 'tidy' format with one observation per
row and one feature per column with the target 'y' as the first column
(unless set to 'none').
</p>
<p>The 'y' and 'k' parameters, trade direction and grid type are set as
attributes, with 'means' and 'sdevs' also populated for type 'z-score' to
return the mean and standard deviation for each column. To view these,
use <code><a href="#topic+look">look</a></code> on the returned object.
</p>


<h3>Further Details</h3>

<p>Please refer to the strategies vignette by calling:
<code>vignette("strategies", package = "ichimoku")</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autostrat">autostrat</a></code> which uses <code>mlgrid()</code> to enumerate all
valid return combinations.
</p>
<p><code><a href="#topic+relative">relative</a></code> which uses <code>mlgrid()</code> to relate the latest
observed numeric representation to historical values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
grid &lt;- mlgrid(cloud, y = "ret", k = 2, dir = "short", type = "z-score")
str(grid)

custom &lt;- mlgrid(cloud, type = "numeric", expr = list(cd = quote(core[, "cd"])))
str(custom)

</code></pre>

<hr>
<h2 id='more'>Print More Rows of Ichimoku Objects</h2><span id='topic+more'></span>

<h3>Description</h3>

<p>After calling or invoking the default print method for ichimoku objects, the
console output will display <code>-- omitted x rows</code> if the entire data
does not fit on-screen. Use <code>more()</code> to display more rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>more(rows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="more_+3A_rows">rows</code></td>
<td>
<p>(optional) specify the number of rows to print; defaults to all
rows if not supplied or non-numeric.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The ichimoku object contained in <code><a href="base.html#topic+.Last.value">.Last.value</a></code> (invisibly)
or else invisible NULL (if .Last.value is not an ichimoku object).
The ichimoku object data is printed to the console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
cloud
more(25)
more()

</code></pre>

<hr>
<h2 id='oanda'>OANDA Price Data</h2><span id='topic+oanda'></span>

<h3>Description</h3>

<p>Retrieve price data for major currencies, metals, commodities, government
bonds and stock indices from the OANDA fxTrade API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda(
  instrument,
  granularity = c("D", "W", "M", "H12", "H8", "H6", "H4", "H3", "H2", "H1", "M30", "M15",
    "M10", "M5", "M4", "M2", "M1", "S30", "S15", "S10", "S5"),
  count = NULL,
  from = NULL,
  to = NULL,
  price = c("M", "B", "A"),
  server,
  apikey,
  quietly
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_+3A_instrument">instrument</code></td>
<td>
<p>string containing the base currency and quote currency
delimited by '_' or '-' (e.g. &quot;USD_JPY&quot; or &quot;usd-jpy&quot;). Use the
<code><a href="#topic+oanda_instruments">oanda_instruments</a></code> function to return a list of all valid
instruments.</p>
</td></tr>
<tr><td><code id="oanda_+3A_granularity">granularity</code></td>
<td>
<p>[default &quot;D&quot;] the granularity of the price data to fetch,
one of &quot;M&quot;, &quot;W&quot;, &quot;D&quot;, &quot;H12&quot;, &quot;H8&quot;, &quot;H6&quot;, &quot;H4&quot;, &quot;H3&quot;, &quot;H2&quot;, &quot;H1&quot;, &quot;M30&quot;,
&quot;M15&quot;, &quot;M10&quot;, &quot;M5&quot;, &quot;M4&quot;, &quot;M2&quot;, &quot;M1&quot;, &quot;S30&quot;, &quot;S15&quot;, &quot;S10&quot;, &quot;S5&quot;.</p>
</td></tr>
<tr><td><code id="oanda_+3A_count">count</code></td>
<td>
<p>(optional) the number of periods to return. The API supports a
maximum of 5000 for each individual request, and defaults to 500 if not
specified. If both 'from' and 'to' are specified, 'count' is ignored, as
the time range combined with 'granularity' will determine the number of
periods to return.</p>
</td></tr>
<tr><td><code id="oanda_+3A_from">from</code></td>
<td>
<p>(optional) the start of the time range for which to fetch price
data, in a format convertible to POSIXct by <code>as.POSIXct()</code>, for
example &quot;2020-02-01&quot;.</p>
</td></tr>
<tr><td><code id="oanda_+3A_to">to</code></td>
<td>
<p>(optional) the end of the time range for which to fetch price data,
in a format convertible to POSIXct by <code>as.POSIXct()</code>, for example
&quot;2020-06-30&quot;.</p>
</td></tr>
<tr><td><code id="oanda_+3A_price">price</code></td>
<td>
<p>[default &quot;M&quot;] pricing component, one of &quot;M&quot; (midpoint), &quot;B&quot; (bid)
or &quot;A&quot; (ask).</p>
</td></tr>
<tr><td><code id="oanda_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
<tr><td><code id="oanda_+3A_quietly">quietly</code></td>
<td>
<p>(optional) if set to TRUE, will suppress printing of auxiliary
output to the console and return quietly.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function queries the OANDA fxTrade API.
</p>
<p>Requires an fxTrade account with OANDA <a href="https://www.oanda.com/forex-trading/">https://www.oanda.com/forex-trading/</a>.
If you do not already hold a live account, you may register for an OANDA
fxTrade practice / demo account. There is a link on your OANDA fxTrade
account profile page 'Manage API Access' (My Account -&gt; My Services -&gt;
Manage API Access). From there, a personal access token to use with the
OANDA API can be generated, as well as revoked.
</p>
<p>The <code><a href="#topic+oanda_set_key">oanda_set_key</a></code> function can be used to save the API key
in the system credential store so that it is automatically recognised in
future (requires the 'keyring' package to be installed).
</p>


<h3>Value</h3>

<p>A data.frame containing the price data requested.
</p>


<h3>Further Details</h3>

<p>Please refer to the OANDA fxTrade API vignette by calling:
<code>vignette("xoanda", package = "ichimoku")</code>.
</p>
<p>'OANDA' and 'fxTrade' are trademarks owned by OANDA Corporation, an
entity unaffiliated with the ichimoku package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run these examples
prices &lt;- oanda("USD_JPY")
ichimoku(prices)

oanda("EUR_JPY", granularity = "H1", count = 250, from = "2020-02-01", price = "B")

## End(Not run)

</code></pre>

<hr>
<h2 id='oanda_chart'>OANDA Real-time Cloud Charts</h2><span id='topic+oanda_chart'></span>

<h3>Description</h3>

<p>Plot real-time Ichimoku Kinko Hyo cloud charts for major currencies, metals,
commodities, government bonds and stock indices using OANDA fxTrade API
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_chart(
  instrument,
  granularity = c("D", "W", "M", "H12", "H8", "H6", "H4", "H3", "H2", "H1", "M30", "M15",
    "M10", "M5", "M4", "M2", "M1", "S30", "S15", "S10", "S5"),
  refresh = 5,
  count = 250,
  price = c("M", "B", "A"),
  theme = c("classic", "dark", "mono", "noguchi", "okabe-ito", "solarized"),
  type = c("none", "r", "s"),
  limit,
  server,
  apikey,
  ...,
  periods = c(9L, 26L, 52L)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_chart_+3A_instrument">instrument</code></td>
<td>
<p>string containing the base currency and quote currency
delimited by '_' or '-' (e.g. &quot;USD_JPY&quot; or &quot;usd-jpy&quot;). Use the
<code><a href="#topic+oanda_instruments">oanda_instruments</a></code> function to return a list of all valid
instruments.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_granularity">granularity</code></td>
<td>
<p>[default &quot;D&quot;] the granularity of the price data to fetch,
one of &quot;M&quot;, &quot;W&quot;, &quot;D&quot;, &quot;H12&quot;, &quot;H8&quot;, &quot;H6&quot;, &quot;H4&quot;, &quot;H3&quot;, &quot;H2&quot;, &quot;H1&quot;, &quot;M30&quot;,
&quot;M15&quot;, &quot;M10&quot;, &quot;M5&quot;, &quot;M4&quot;, &quot;M2&quot;, &quot;M1&quot;, &quot;S30&quot;, &quot;S15&quot;, &quot;S10&quot;, &quot;S5&quot;.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_refresh">refresh</code></td>
<td>
<p>[default 5] data refresh interval in seconds, with a minimum
of 1.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_count">count</code></td>
<td>
<p>[default 250] the number of periods to return. The API supports
a maximum of 5000. Note that fewer periods are actually shown on the
chart to ensure a full cloud is always displayed.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_price">price</code></td>
<td>
<p>[default &quot;M&quot;] pricing component, one of &quot;M&quot; (midpoint), &quot;B&quot; (bid)
or &quot;A&quot; (ask).</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_theme">theme</code></td>
<td>
<p>[default 'classic'] with further choices of 'dark', 'mono',
'noguchi', 'okabe-ito' or 'solarized'. Alternatively, supply a vector
of 12 colour values (hex codes or names) as a user-defined theme.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_type">type</code></td>
<td>
<p>[default 'none'] type of sub-plot to display beneath the ichimoku
cloud chart, with a choice of 'none', 'r' or 's' for the corresponding
oscillator type.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_limit">limit</code></td>
<td>
<p>(optional) specify a time in seconds by which to limit the
session. The session will end with data returned automatically after the
specified time has elapsed.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_...">...</code></td>
<td>
<p>additional arguments passed along to <code><a href="#topic+ichimoku">ichimoku</a></code> for
calculating the ichimoku cloud or <code><a href="#topic+autoplot">autoplot</a></code> to set chart
parameters.</p>
</td></tr>
<tr><td><code id="oanda_chart_+3A_periods">periods</code></td>
<td>
<p>[default c(9L, 26L, 52L)] a vector defining the length of
periods used for the cloud. This parameter shoud not normally be modified
as using other values would be invalid in the context of traditional
ichimoku analysis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function polls the OANDA fxTrade API for the latest live prices
and updates the plot in the graphical device at each refresh interval.
Use the 'Esc' key to stop updating.
</p>
<p>To access the underlying data, assign the function to an object, for
example: <code>cloud &lt;- oanda_chart("USD_JPY")</code>.
</p>


<h3>Value</h3>

<p>The ichimoku object underlying the chart (invisibly) on function exit.
A plot of the ichimoku chart for the price data requested is output to the
graphical device at each refresh interval.
</p>


<h3>Further Details</h3>

<p>Please refer to the OANDA fxTrade API vignette by calling:
<code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run these examples
oanda_chart("USD_JPY")
oanda_chart("EUR_JPY", granularity = "H1", refresh = 3, count = 300, price = "B", theme = "mono")

# Save data underlying chart at time of function exit
cloud &lt;- oanda_chart("USD_JPY")

## End(Not run)

</code></pre>

<hr>
<h2 id='oanda_instruments'>Available OANDA Instruments</h2><span id='topic+oanda_instruments'></span>

<h3>Description</h3>

<p>Return list of instruments including major currencies, metals, commodities,
government bonds and stock indices for which pricing data is available
from the OANDA fxTrade API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_instruments(server, apikey)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_instruments_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_instruments_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a data.frame listing the instrument names
available for an account associated with the supplied OANDA fxTrade API key.
</p>
<p>For further details please refer to the OANDA fxTrade API vignette by
calling: <code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Value</h3>

<p>A data.frame containing the instrument name, full display name, and type.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run this example
oanda_instruments()

## End(Not run)

</code></pre>

<hr>
<h2 id='oanda_orders'>OANDA Order Book</h2><span id='topic+oanda_orders'></span>

<h3>Description</h3>

<p>Provides a summary of the aggregate orders posted by OANDA fxTrade clients
at each price level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_orders(instrument, time, server, apikey)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_orders_+3A_instrument">instrument</code></td>
<td>
<p>string containing the base currency and quote currency
delimited by '_' or '-' (e.g. &quot;USD_JPY&quot; or &quot;usd-jpy&quot;). Use the
<code><a href="#topic+oanda_instruments">oanda_instruments</a></code> function to return a list of all valid
instruments.</p>
</td></tr>
<tr><td><code id="oanda_orders_+3A_time">time</code></td>
<td>
<p>(optional) the time for which to retrieve the order book, in a
format convertible to POSIXct by <code>as.POSIXct()</code>. If not specified,
the most recent order book will be retrieved.</p>
</td></tr>
<tr><td><code id="oanda_orders_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_orders_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This feature has been implemented by OANDA only for certain major
currency pairs and should be considered experimental.
</p>
<p>Note: as certain orders are placed far from the market price, only the
interquartile range of order levels is shown on the chart. The returned
data frame does however contain the entire order book.
</p>
<p>For further details please refer to the OANDA fxTrade API vignette by
calling: <code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Value</h3>

<p>Invisibly, a data frame of the order book with parameters saved as
attributes. A chart showing the percentage long and short orders at each
price level is output to the graphical device.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run this example
oanda_orders("USD_JPY")

## End(Not run)

</code></pre>

<hr>
<h2 id='oanda_positions'>OANDA Position Book</h2><span id='topic+oanda_positions'></span>

<h3>Description</h3>

<p>Provides a summary of the aggregate positions held by OANDA fxTrade clients
at each price level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_positions(instrument, time, server, apikey)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_positions_+3A_instrument">instrument</code></td>
<td>
<p>string containing the base currency and quote currency
delimited by '_' or '-' (e.g. &quot;USD_JPY&quot; or &quot;usd-jpy&quot;). Use the
<code><a href="#topic+oanda_instruments">oanda_instruments</a></code> function to return a list of all valid
instruments.</p>
</td></tr>
<tr><td><code id="oanda_positions_+3A_time">time</code></td>
<td>
<p>(optional) the time for which to retrieve the position book, in a
format convertible to POSIXct by <code>as.POSIXct()</code>. If not specified,
the most recent position book will be retrieved.</p>
</td></tr>
<tr><td><code id="oanda_positions_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_positions_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This feature has been implemented by OANDA only for certain major
currency pairs and should be considered experimental.
</p>
<p>For further details please refer to the OANDA fxTrade API vignette by
calling: <code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Value</h3>

<p>Invisibly, a data frame of the position book with parameters saved as
attributes. A chart showing the percentage long and short positions at
each price level is output to the graphical device.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run this example
oanda_positions("USD_JPY")

## End(Not run)

</code></pre>

<hr>
<h2 id='oanda_quote'>OANDA Quote Latest Price</h2><span id='topic+oanda_quote'></span>

<h3>Description</h3>

<p>Provides a single line price quote for an instrument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_quote(instrument, price = c("M", "B", "A"), server, apikey)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_quote_+3A_instrument">instrument</code></td>
<td>
<p>string containing the base currency and quote currency
delimited by '_' or '-' (e.g. &quot;USD_JPY&quot; or &quot;usd-jpy&quot;). Use the
<code><a href="#topic+oanda_instruments">oanda_instruments</a></code> function to return a list of all valid
instruments.</p>
</td></tr>
<tr><td><code id="oanda_quote_+3A_price">price</code></td>
<td>
<p>[default &quot;M&quot;] pricing component, one of &quot;M&quot; (midpoint), &quot;B&quot; (bid)
or &quot;A&quot; (ask).</p>
</td></tr>
<tr><td><code id="oanda_quote_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_quote_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed for interactive use.
</p>
<p>For further details please refer to the OANDA fxTrade API vignette by
calling: <code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Value</h3>

<p>Invisible NULL. The instrument, timestamp, daily open, high, low and
last prices, percentage change from the open, and the pricing component
(M for mid, B for bid, A for ask) is output to the console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run this example
oanda_quote("USD_JPY")

## End(Not run)

</code></pre>

<hr>
<h2 id='oanda_set_key'>Set OANDA fxTrade API Key</h2><span id='topic+oanda_set_key'></span>

<h3>Description</h3>

<p>Save OANDA fxTrade API key (personal access token) to the system credential
store.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_set_key()
</code></pre>


<h3>Details</h3>

<p>The key is read interactively. Separate keys can be set for practice
and live accounts - please choose the correct account type when prompted.
</p>
<p>This function only needs to be called once to set the key; it does not
need to be called each session.
</p>
<p>This function has a dependency on the 'keyring' package.
</p>


<h3>Value</h3>

<p>Invisible NULL. A key is set in the default keyring under the service
name 'OANDA_API_KEY' for practice accounts or 'OANDA_LIVE_KEY' for live
accounts.
</p>


<h3>Further Details</h3>

<p>Please refer to the OANDA fxTrade API vignette by calling:
<code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
# Only run example in interactive R sessions
oanda_set_key()
}

</code></pre>

<hr>
<h2 id='oanda_stream'>OANDA Streaming Data</h2><span id='topic+oanda_stream'></span>

<h3>Description</h3>

<p>Stream live price and liquidity data for major currencies, metals,
commodities, government bonds and stock indices from the OANDA fxTrade
Streaming API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_stream(instrument, display = 8L, limit, server, apikey)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_stream_+3A_instrument">instrument</code></td>
<td>
<p>string containing the base currency and quote currency
delimited by '_' or '-' (e.g. &quot;USD_JPY&quot; or &quot;usd-jpy&quot;). Use the
<code><a href="#topic+oanda_instruments">oanda_instruments</a></code> function to return a list of all valid
instruments.</p>
</td></tr>
<tr><td><code id="oanda_stream_+3A_display">display</code></td>
<td>
<p>[default 8L] integer rows of data to display in the console
at any one time.</p>
</td></tr>
<tr><td><code id="oanda_stream_+3A_limit">limit</code></td>
<td>
<p>(optional) specify a time in seconds by which to limit the
streaming session. The session will end with data returned automatically
after the specified time has elapsed.</p>
</td></tr>
<tr><td><code id="oanda_stream_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_stream_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function connects to the OANDA fxTrade Streaming API. Send an
interrupt using the 'Esc' key or 'Ctrl+c' to stop the stream and return
the session data.
</p>
<p>Note: only messages of type 'PRICE' are processed. Messages of type
'HEARTBEAT' consisting of only a timestamp are discarded.
</p>


<h3>Value</h3>

<p>Returned invisibly, a dataframe containing the data for the streaming
session on function exit. The latest rows of the dataframe are printed to
the console, as governed by the 'display' argument.
</p>


<h3>Streaming Data</h3>

<p>Summarised from the streaming API documentation:
</p>

<ul>
<li><p> Pricing stream does not include every single price created for the
Account
</p>
</li>
<li><p> At most 4 prices are sent per second (every 250 milliseconds) for
each instrument
</p>
</li>
<li><p> If more than one price is created during the 250 millisecond window,
only the price in effect at the end of the window is sent
</p>
</li>
<li><p> This means that during periods of rapid price movement, not every
price is sent
</p>
</li>
<li><p> Pricing windows for different connections to the stream are not all
aligned in the same way (e.g. to the top of the second)
</p>
</li>
<li><p> This means that during periods of rapid price movement, different
prices may be observed depending on the alignment for the connection
</p>
</li></ul>



<h3>Further Details</h3>

<p>Please refer to the OANDA fxTrade API vignette by calling:
<code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run this example
data &lt;- oanda_stream("USD_JPY", display = 8L)

## End(Not run)

</code></pre>

<hr>
<h2 id='oanda_studio'>OANDA Studio Interactive Live Analysis</h2><span id='topic+oanda_studio'></span>

<h3>Description</h3>

<p>Interactive and fully-customisable R Shiny environment providing real-time
Ichimoku Kinko Hyo cloud charts for major currencies, metals, commodities,
government bonds and stock indices using OANDA fxTrade API data. Intuitive
cursor infotip provides ready access to the data directly from the chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_studio(
  instrument = "USD_JPY",
  granularity = c("D", "W", "M", "H12", "H8", "H6", "H4", "H3", "H2", "H1", "M30", "M15",
    "M10", "M5", "M4", "M2", "M1", "S30", "S15", "S10", "S5"),
  refresh = 5,
  count = 300,
  price = c("M", "B", "A"),
  theme = c("classic", "dark", "mono", "noguchi", "okabe-ito", "solarized"),
  type = c("none", "r", "s"),
  server,
  apikey,
  new.process = FALSE,
  ...,
  launch.browser = TRUE,
  periods = c(9L, 26L, 52L)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_studio_+3A_instrument">instrument</code></td>
<td>
<p>[default 'USD_JPY'] string containing the base currency and
quote currency delimited by a '_'. Use the <code><a href="#topic+oanda_instruments">oanda_instruments</a></code>
function to return a list of all valid instruments.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_granularity">granularity</code></td>
<td>
<p>[default &quot;D&quot;] the granularity of the price data to fetch,
one of &quot;M&quot;, &quot;W&quot;, &quot;D&quot;, &quot;H12&quot;, &quot;H8&quot;, &quot;H6&quot;, &quot;H4&quot;, &quot;H3&quot;, &quot;H2&quot;, &quot;H1&quot;, &quot;M30&quot;,
&quot;M15&quot;, &quot;M10&quot;, &quot;M5&quot;, &quot;M4&quot;, &quot;M2&quot;, &quot;M1&quot;, &quot;S30&quot;, &quot;S15&quot;, &quot;S10&quot;, &quot;S5&quot;.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_refresh">refresh</code></td>
<td>
<p>[default 5] data refresh interval in seconds, with a minimum
of 1.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_count">count</code></td>
<td>
<p>[default 300] the number of periods to return, from 100 to 800.
Note that fewer periods are actually shown on the chart to ensure a full
cloud is always displayed.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_price">price</code></td>
<td>
<p>[default &quot;M&quot;] pricing component, one of &quot;M&quot; (midpoint), &quot;B&quot; (bid)
or &quot;A&quot; (ask).</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_theme">theme</code></td>
<td>
<p>[default 'original'] with alternative choices of 'conceptual',
'dark', 'fresh', 'mono', or 'solarized'.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_type">type</code></td>
<td>
<p>[default 'none'] type of sub-plot to display beneath the ichimoku
cloud chart, with a choice of 'none', 'r' or 's' for the corresponding
oscillator type.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_new.process">new.process</code></td>
<td>
<p>[default FALSE] if TRUE, will start the shiny session in a
new R process, unblocking the current process and allowing continued use
of the R console.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_...">...</code></td>
<td>
<p>additional arguments passed along to <code><a href="#topic+ichimoku">ichimoku</a></code> for
calculating the ichimoku cloud, <code><a href="#topic+autoplot">autoplot</a></code> to set chart
parameters, or the 'options' argument of <code>shiny::shinyApp()</code>.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_launch.browser">launch.browser</code></td>
<td>
<p>[default TRUE] If TRUE, the system's default web browser
will be launched automatically after the app is started. The value of this
argument can also be a function to call with the application's URL. To use
the default Shiny viewer in RStudio, please specify
<code>getOption("shiny.launch.browser")</code>.</p>
</td></tr>
<tr><td><code id="oanda_studio_+3A_periods">periods</code></td>
<td>
<p>[default c(9L, 26L, 52L)] a vector defining the length of
periods used for the cloud. This parameter shoud not normally be modified
as using other values would be invalid in the context of traditional
ichimoku analysis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function polls the OANDA fxTrade API for the latest prices and
updates a customisable reactive Shiny app at each refresh interval.
</p>


<h3>Value</h3>

<p>Invisible NULL, or a 'mirai' if 'new.process' is specified as TRUE.
With default arguments, a Shiny app is launched in the default browser.
</p>


<h3>Further Details</h3>

<p>Please refer to the OANDA fxTrade API vignette by calling:
<code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run these examples
oanda_studio()

# To open in RStudio viewer instead of default browser
oanda_studio(launch.browser = getOption("shiny.launch.browser"))

## End(Not run)

</code></pre>

<hr>
<h2 id='oanda_switch'>Switch Default OANDA Server</h2><span id='topic+oanda_switch'></span>

<h3>Description</h3>

<p>Switch the default OANDA fxTrade server from 'practice' to 'live' or vice versa.
Settings persist for the current session only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_switch()
</code></pre>


<h3>Details</h3>

<p>The default server at the start of a new session is the practice server.
Call this function to switch to the live server.
</p>
<p>This function can be used to toggle between the practice and live servers.
Any cached variables for API key, account or instruments list are cleared
each time this function is called.
</p>
<p>For further details please refer to the OANDA fxTrade API vignette by
calling: <code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Value</h3>

<p>Invisible NULL. A message informs the resulting default server setting.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oanda_switch()
oanda_switch()

</code></pre>

<hr>
<h2 id='oanda_view'>OANDA View Market Performance</h2><span id='topic+oanda_view'></span>

<h3>Description</h3>

<p>Provides a snapshot overview of markets on an intraday basis, showing the
relative performance of individual constituents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oanda_view(
  market = c("allfx", "bonds", "commodities", "fx", "metals", "stocks"),
  price = c("M", "B", "A"),
  server,
  apikey
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oanda_view_+3A_market">market</code></td>
<td>
<p>string specifying the market: 'allfx' for all available
currencies, 'bonds' for government bonds, 'commodities' for commodities,
'fx' for major currency pairs, 'metals' for metals and 'stocks' for
global stock markets.</p>
</td></tr>
<tr><td><code id="oanda_view_+3A_price">price</code></td>
<td>
<p>[default &quot;M&quot;] pricing component, one of &quot;M&quot; (midpoint), &quot;B&quot; (bid)
or &quot;A&quot; (ask).</p>
</td></tr>
<tr><td><code id="oanda_view_+3A_server">server</code></td>
<td>
<p>(optional) specify the &quot;practice&quot; or &quot;live&quot; server according to
the account type held. If not specified, will default to &quot;practice&quot;, unless
this has been changed by <code><a href="#topic+oanda_switch">oanda_switch</a></code>.</p>
</td></tr>
<tr><td><code id="oanda_view_+3A_apikey">apikey</code></td>
<td>
<p>(optional) string containing the OANDA fxTrade API key (personal
access token), or function that returns this string. Does not need to be
specified if already stored as the environment variable
<code>OANDA_API_KEY</code> or by <code><a href="#topic+oanda_set_key">oanda_set_key</a></code>. Can also be
entered interactively if not specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed for interactive use.
</p>
<p>For further details please refer to the OANDA fxTrade API vignette by
calling: <code>vignette("xoanda", package = "ichimoku")</code>.
</p>


<h3>Value</h3>

<p>A data.frame containing the daily open, high, low and last prices,
along with the percentage price change from the open, ordered by the
percentage change. The instrument names are set as row names.
</p>
<p>The first timestamp retrieved and the pricing component are printed to
the console as well as saved as attributes to the dataframe. The dataframe
is also printed to the console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# OANDA fxTrade API key required to run this example
oanda_view("fx")

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.ichimoku'>Plot Ichimoku Cloud Chart</h2><span id='topic+plot.ichimoku'></span>

<h3>Description</h3>

<p>Plot Ichimoku Kinko Hyo cloud charts from ichimoku objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ichimoku'
plot(
  x,
  window,
  ticker,
  subtitle,
  theme = c("classic", "dark", "mono", "noguchi", "okabe-ito", "solarized"),
  strat = TRUE,
  type = c("none", "r", "s", "bar", "line"),
  custom,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ichimoku_+3A_x">x</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="plot.ichimoku_+3A_window">window</code></td>
<td>
<p>(optional) a date-time window to subset the plot, in ISO-8601
compatible range strings of the format used for 'xts' objects, for example
&quot;2020-02-15/2020-08-15&quot; or &quot;2020-02-15/&quot;, &quot;/2020-08&quot; or &quot;2020-07&quot;.</p>
</td></tr>
<tr><td><code id="plot.ichimoku_+3A_ticker">ticker</code></td>
<td>
<p>(optional) specify a ticker (or other text) to include in the
chart heading. If not set, the ticker saved within the ichimoku object
will be used.</p>
</td></tr>
<tr><td><code id="plot.ichimoku_+3A_subtitle">subtitle</code></td>
<td>
<p>(optional) specify a subtitle to display under the chart title.</p>
</td></tr>
<tr><td><code id="plot.ichimoku_+3A_theme">theme</code></td>
<td>
<p>[default 'classic'] with further choices of 'dark', 'mono',
'noguchi', 'okabe-ito' or 'solarized'. Alternatively, supply a vector
of 12 colour values (hex codes or names) as a user-defined theme.</p>
</td></tr>
<tr><td><code id="plot.ichimoku_+3A_strat">strat</code></td>
<td>
<p>[default TRUE] if the ichimoku object contains a strategy, the
periods for which the strategy results in a position will be shaded, and
the strategy printed as the chart subtitle (if not otherwise specified).
Set to FALSE to turn off this behaviour.</p>
</td></tr>
<tr><td><code id="plot.ichimoku_+3A_type">type</code></td>
<td>
<p>[default 'none'] type of sub-plot to display beneath the ichimoku
cloud chart, with a choice of 'none', 'r' or 's' for the corresponding
oscillator type, and 'bar' or 'line' for custom plots.</p>
</td></tr>
<tr><td><code id="plot.ichimoku_+3A_custom">custom</code></td>
<td>
<p>(optional) character string (containing a regular expression)
matching the column name of the variable to be displayed as sub-plot.
Specify <code>type = 'bar'</code> or <code>type = 'line'</code>, otherwise other type
settings will take precedence.</p>
</td></tr>
<tr><td><code id="plot.ichimoku_+3A_...">...</code></td>
<td>
<p>additional arguments passed along to the print method for 'ggplot'
objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an S3 method for the generic function plot() for
class 'ichimoku'. It can be invoked by calling plot(x) on an object 'x'
of class 'ichimoku'.
</p>
<p>For further details please refer to the reference vignette by calling:
<code>vignette("reference", package = "ichimoku")</code>
</p>


<h3>Value</h3>

<p>The ichimoku object supplied (invisibly). The requested plot is output
to the graphical device.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
plot(cloud)
plot(cloud, window = "2020-05-01/2020-12-01", theme = "dark")
plot(cloud, window = "2020-05/", ticker = "TKR Co.", theme = "noguchi", type = "s")
plot(cloud, window = "/2020-11-02", subtitle = "Sample Price Data", theme = "mono", type = "r")

kumo &lt;- ichimoku(sample_ohlc_data, ticker = "TKR", keep.data = TRUE)
plot(kumo, window = "2020-05/", theme = "solarized", type = "bar", custom = "volume")
plot(kumo, window = "2020-05/", theme = "okabe-ito", type = "line", custom = "volume")

</code></pre>

<hr>
<h2 id='print.ichimoku'>Print Ichimoku Objects</h2><span id='topic+print.ichimoku'></span>

<h3>Description</h3>

<p>Default print method for ichimoku objects to enable automatic plotting of the
ichimoku cloud chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ichimoku'
print(x, plot = TRUE, rows = 26L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.ichimoku_+3A_x">x</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="print.ichimoku_+3A_plot">plot</code></td>
<td>
<p>[default TRUE] set to FALSE to prevent automatic plotting of
the ichimoku cloud chart.</p>
</td></tr>
<tr><td><code id="print.ichimoku_+3A_rows">rows</code></td>
<td>
<p>[default 26L] integer number of rows to print.</p>
</td></tr>
<tr><td><code id="print.ichimoku_+3A_...">...</code></td>
<td>
<p>additional arguments passed along to the xts print and
<code><a href="#topic+plot.ichimoku">plot.ichimoku</a></code> methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an S3 method for the generic function print() for
class 'ichimoku'. It can be invoked by calling print(x) on an object 'x'
of class 'ichimoku'.
</p>


<h3>Value</h3>

<p>The ichimoku object supplied (invisibly). The data is printed to the
console. The ichimoku cloud chart is also output to the graphical device
depending on the parameters set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")

print(cloud)
print(cloud, plot = FALSE, rows = 20L)

</code></pre>

<hr>
<h2 id='relative'>Relative Numeric Representation</h2><span id='topic+relative'></span>

<h3>Description</h3>

<p>Produce a statistical summary of the latest numeric representation of the
ichimoku cloud chart relative to historical values. For determining
whether current trading falls within or outside of normal ranges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relative(x, order = FALSE, signif = 0.2, quietly)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative_+3A_x">x</code></td>
<td>
<p>an ichimoku object.</p>
</td></tr>
<tr><td><code id="relative_+3A_order">order</code></td>
<td>
<p>[default FALSE] set to TRUE to order the results by the absolute
'z-score'.</p>
</td></tr>
<tr><td><code id="relative_+3A_signif">signif</code></td>
<td>
<p>[default 0.2] set a significance threshold for which if 'p' is
equal or lower, the element will be starred with a '*'.</p>
</td></tr>
<tr><td><code id="relative_+3A_quietly">quietly</code></td>
<td>
<p>(optional) if set to TRUE, will suppress printing of additional
output to the console and return quietly.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'mean(X)' is the mean value for each element X, 'sd(X)' the
standard deviation, and 'X[n]' the nth or latest observed values.
</p>
<p>'res' is the residual X[n] - mean(X) and represents a centred measure of
deviation for the latest observed value.
</p>
<p>The 'z-score' (or standard score) is calculated as res / sd(X) and is a
centred and scaled measure of deviation for the latest observed value.
</p>
<p>'p &gt;= |z|' represents the empirical probability of the latest observed
absolute 'z-score' or greater.
</p>
<p>'p*' will display a star if 'p &gt;= |z|' is less than or equal to the value
of the argument 'signif'.
</p>
<p>'E(|res|)|p' represents the mean or expected absolute value of 'res',
conditional upon the absolute 'z-score' being greater than equal to the
latest observed absolute 'z-score'.
</p>


<h3>Value</h3>

<p>A data frame containing a statistical summary of the latest ichimoku
cloud chart representation in relation to historical values.
</p>
<p>In addition, the time index of the latest observed values and total
number of datapoints are printed to the console.
</p>


<h3>Further Details</h3>

<p>Please refer to the strategies vignette by calling:
<code>vignette("strategies", package = "ichimoku")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
statistics &lt;- relative(cloud, quietly = TRUE)
relative(cloud, signif = 0.4)
relative(cloud, order = TRUE, signif = 0.4)

</code></pre>

<hr>
<h2 id='sample_ohlc_data'>Sample OHLC Price Data</h2><span id='topic+sample_ohlc_data'></span>

<h3>Description</h3>

<p>Simulated prices for a hypothetical financial asset. Created for the purpose
of demonstrating package functions in examples and vignettes only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_ohlc_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 256 observations of 6 variables:
</p>

<ul>
<li><p> time - timestamp of observation [POSIXct]
</p>
</li>
<li><p> open - opening price [numeric]
</p>
</li>
<li><p> low - low price [numeric]
</p>
</li>
<li><p> high - high price [numeric]
</p>
</li>
<li><p> close - closing price [numeric]
</p>
</li>
<li><p> volume - volume [integer]
</p>
</li></ul>



<h3>Source</h3>

<p>Not applicable: simulated data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(sample_ohlc_data)

</code></pre>

<hr>
<h2 id='str.ichimoku'>Display the Structure of Ichimoku Objects</h2><span id='topic+str.ichimoku'></span>

<h3>Description</h3>

<p>Compactly display the internal structure of ichimoku objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ichimoku'
str(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="str.ichimoku_+3A_object">object</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="str.ichimoku_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an S3 method for the generic function str()
for class 'ichimoku'. It can be invoked by calling str(x) on an
object 'x' of class 'ichimoku'.
</p>


<h3>Value</h3>

<p>Invisible NULL. A compact display of the structure of the object is
output to the console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
str(cloud)

strat &lt;- strat(cloud)
str(strat)

</code></pre>

<hr>
<h2 id='strat'>Create Ichimoku Strategies</h2><span id='topic+strat'></span>

<h3>Description</h3>

<p>Create ichimoku cloud strategies using the indicator condition 'long / short
while c1 &gt; c2'. Complex strategies can be formulated as combined
'c1 &gt; c2 &amp; c3 &gt; c4' (both conditions must be satisfied) or asymmetric
'c1 &gt; c2 x c3 &gt; c4' (where 'c1 &gt; c2' denotes the entry and 'c3 &gt; c4' the
exit indicator).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strat(
  x,
  c1 = c("close", "chikou", "open", "high", "low", "tenkan", "kijun", "senkouA",
    "senkouB", "cloudT", "cloudB"),
  c2 = c("tenkan", "kijun", "senkouA", "senkouB", "cloudT", "cloudB", "chikou", "close",
    "open", "high", "low"),
  c3 = c("close", "chikou", "open", "high", "low", "tenkan", "kijun", "senkouA",
    "senkouB", "cloudT", "cloudB"),
  c4 = c("tenkan", "kijun", "senkouA", "senkouB", "cloudT", "cloudB", "chikou", "close",
    "open", "high", "low"),
  dir = c("long", "short"),
  type = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strat_+3A_x">x</code></td>
<td>
<p>an ichimoku object.</p>
</td></tr>
<tr><td><code id="strat_+3A_c1">c1</code></td>
<td>
<p>[default 'close'] column name specified as a string.</p>
</td></tr>
<tr><td><code id="strat_+3A_c2">c2</code></td>
<td>
<p>[default 'tenkan'] column name specified as a string.</p>
</td></tr>
<tr><td><code id="strat_+3A_c3">c3</code></td>
<td>
<p>(optional) column name specified as a string.</p>
</td></tr>
<tr><td><code id="strat_+3A_c4">c4</code></td>
<td>
<p>(optional) column name specified as a string.</p>
</td></tr>
<tr><td><code id="strat_+3A_dir">dir</code></td>
<td>
<p>[default 'long'] trade direction, either 'long' or 'short'.</p>
</td></tr>
<tr><td><code id="strat_+3A_type">type</code></td>
<td>
<p>[default 2] if 'c3' and 'c4' are specified, type 2 will create the
combined strategy 'c1 &gt; c2 &amp; c3 &gt; c4' whilst type 3 will create the
asymmetric strategy 'c1 &gt; c2 x c3 &gt; c4'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following assumption applies to all strategies: confirmation of
whether a condition is satisfied is received at the 'close' of a particular
period, and a transaction is initiated at the immediately following 'open'.
All transactions occur at the 'open'.
</p>
<p>By default, the periods in which the strategy results in a position is
shaded on the ichimoku cloud chart and the strategy is printed as the
chart message (if not otherwise specified). To turn off this behaviour,
pass the <code>strat = FALSE</code> argument to plot() or iplot().
</p>


<h3>Value</h3>

<p>An ichimoku object augmented with the strategy.
</p>


<h3>Ichimoku Object Specification for Strategies</h3>

<p>The ichimoku object is augmented with the following additional elements:
</p>
<p>Columns [numeric]:
</p>

<ul>
<li> <p><code>$cond</code>: a boolean vector if the indicator condition is met
</p>
</li>
<li> <p><code>$posn</code>: a boolean vector indicating if a position is held
</p>
</li>
<li> <p><code>$txn</code>: a vector representing the transactions to implement
the position (1 = enter position, -1 = exit position)
</p>
</li>
<li> <p><code>$logret</code>: a vector of log returns
</p>
</li>
<li> <p><code>$slogret</code>: a vector of log returns for the strategy
</p>
</li>
<li> <p><code>$ret</code>: a vector of discrete returns
</p>
</li>
<li> <p><code>$sret</code>: a vector of of discrete returns for the strategy
</p>
</li></ul>

<p>Attributes:
</p>

<ul>
<li> <p><code>$strat</code>: the strategy summary [matrix]
</p>
</li></ul>

<p>The strategy summary may be accessed by the <code>summary()</code> method for
ichimoku objects or via <code><a href="#topic+look">look</a></code>.
</p>


<h3>Complex Strategies</h3>

<p>For complex strategies: 's1' denotes the strategy 'c1 &gt; c2' and 's2'
denotes the strategy 'c3 &gt; c4'.
</p>

<ul>
<li><p> Combined strategy 's1 &amp; s2': indicator conditions in 's1' and
's2' have to be met simulateneously for a position to be taken. The
column <code>$cond</code> will show when both conditions are met
</p>
</li>
<li><p> Asymmetric strategy 's1 x s2': indicator condition in 's1' has
to be met to enter a position, and indicator condition in 's2' to
exit a position. These rules are applied recursively over the length
of the data. The column <code>$cond</code> will show when the indicator
condition is met in 's1'
</p>
</li></ul>



<h3>Further Details</h3>

<p>Please refer to the strategies vignette by calling:
<code>vignette("strategies", package = "ichimoku")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")

strat &lt;- strat(cloud, c1 = "tenkan", c2 = "cloudB", dir = "short")
summary(strat)
plot(strat)

strat2 &lt;- strat(cloud, c1 = "cloudT", c2 = "kijun", c3 = "cloudT", c4 = "close")
summary(strat2)
plot(strat2)

</code></pre>

<hr>
<h2 id='stratcombine'>Combine Ichimoku Strategies</h2><span id='topic+stratcombine'></span>

<h3>Description</h3>

<p>Create custom strategies from combining existing strategies contained in
ichimoku objects 's1' and 's2' to form 's1 &amp; s2'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stratcombine(s1, s2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stratcombine_+3A_s1">s1</code></td>
<td>
<p>an ichimoku object containing a strategy.</p>
</td></tr>
<tr><td><code id="stratcombine_+3A_s2">s2</code></td>
<td>
<p>an ichimoku object containing a strategy.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The combined strategy 's1 &amp; s2' means indicator conditions in 's1'
and 's2' have to be met simulateneously for a trade position to be taken.
</p>
<p>The boolean values showing whether these conditions are met are stored in
the 'cond' column.
</p>
<p>The strategy summary may be accessed by the <code>summary()</code> method for
ichimoku objects or via <code><a href="#topic+look">look</a></code>.
</p>


<h3>Value</h3>

<p>An ichimoku object augmented with the combined strategy.
</p>


<h3>Further Details</h3>

<p>Please refer to the strategies vignette by calling:
<code>vignette("strategies", package = "ichimoku")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
strat1 &lt;- strat(cloud, c1 = "close", c2 = "kijun")
strat2 &lt;- strat(cloud, c1 = "cloudB", c2 = "tenkan")
cstrat &lt;- stratcombine(strat1, strat2)
summary(cstrat)
plot(cstrat)

</code></pre>

<hr>
<h2 id='summary.ichimoku'>Summary of Ichimoku Objects and Strategies</h2><span id='topic+summary.ichimoku'></span>

<h3>Description</h3>

<p>Display summary information for an ichimoku object or its strategy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ichimoku'
summary(object, strat = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ichimoku_+3A_object">object</code></td>
<td>
<p>an object of class 'ichimoku'.</p>
</td></tr>
<tr><td><code id="summary.ichimoku_+3A_strat">strat</code></td>
<td>
<p>[default TRUE] to show the strategy summary if present. Set to
FALSE to show the object summary instead.</p>
</td></tr>
<tr><td><code id="summary.ichimoku_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an S3 method for the generic function summary() for
class 'ichimoku'. It can be invoked by calling summary(x) on an object 'x'
of class 'ichimoku'.
</p>
<p>Performs basic validation for an ichimoku object and will inform if an
ichimoku object contains invalid information.
</p>


<h3>Value</h3>

<p>A matrix containing the strategy summary, if present and 'strat' is
set to TRUE, otherwise a character vector containing an abbreviated object
summary (the full object summary is output to the console).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data, ticker = "TKR")
summary(cloud)

strat &lt;- strat(cloud)
summary(strat)

</code></pre>

<hr>
<h2 id='tradingDays'>Select Trading Days</h2><span id='topic+tradingDays'></span>

<h3>Description</h3>

<p>Used by <code><a href="#topic+ichimoku">ichimoku</a></code> to subset a vector of dates to trading days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tradingDays(x, holidays, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tradingDays_+3A_x">x</code></td>
<td>
<p>a vector of POSIXct date objects.</p>
</td></tr>
<tr><td><code id="tradingDays_+3A_holidays">holidays</code></td>
<td>
<p>(optional) a vector, or function which outputs a vector, of
dates defined as holidays. Set to NULL for a continuously-traded market.</p>
</td></tr>
<tr><td><code id="tradingDays_+3A_...">...</code></td>
<td>
<p>other arguments not used by this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>New Year's Day (01-01) and Christmas Day (12-25) are defined as
holidays by default if 'holidays' is not specified.
</p>


<h3>Value</h3>

<p>A vector of logical values: TRUE if the corresponding element of 'x'
is a weekday and not a holiday, FALSE otherwise.
</p>
<p>Or, if the parameter 'holidays' is set to NULL, a vector of TRUE values
of the same length as 'x'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dates &lt;- seq(from = as.POSIXct("2020-01-01"), by = "1 day", length.out = 7)
dates
tradingDays(dates)
tradingDays(dates, holidays = c("2020-01-02", "2020-01-03"))
tradingDays(dates, holidays = NULL)

</code></pre>

<hr>
<h2 id='xts_df'>Convert xts to data.frame</h2><span id='topic+xts_df'></span>

<h3>Description</h3>

<p>An optimised 'xts' to 'data.frame' constructor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xts_df(x, keep.attrs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xts_df_+3A_x">x</code></td>
<td>
<p>an 'xts' object.</p>
</td></tr>
<tr><td><code id="xts_df_+3A_keep.attrs">keep.attrs</code></td>
<td>
<p>[default FALSE] if set to TRUE, will preserve any custom
attributes set on the original object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optimised data.frame constructors are used internally within
the package and made available as utilities. Please note that no data
validation or checking is performed.
</p>


<h3>Value</h3>

<p>A 'data.frame' object. The 'xts' index is preserved as the first
column with header 'index'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cloud &lt;- ichimoku(sample_ohlc_data)
df &lt;- xts_df(cloud)
str(df)

df2 &lt;- xts_df(cloud, keep.attrs = TRUE)
str(df2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
