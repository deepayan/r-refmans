<!DOCTYPE html><html><head><title>Help for package bpp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bpp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#basicPlot'><p>Basic plot functions to illustrate prior and posterior densities when considering a time-to-event endpoint</p></a></li>
<li><a href='#bpp'><p>Bayesian Predictive Power (BPP) for Normally Distributed Endpoint</p></a></li>
<li><a href='#bpp_1interim'><p>Bayesian Predictive Power (BPP) for Normally Distributed Endpoint</p></a></li>
<li><a href='#bpp_1interim_binary'><p>Bayesian Predictive Power (BPP) for Binary Endpoint</p></a></li>
<li><a href='#bpp_1interim_continuous'><p>Bayesian Predictive Power (BPP) for Continuous Endpoint</p></a></li>
<li><a href='#bpp_1interim_t2e'><p>Bayesian Predictive Power (BPP) for Time-to-Event Endpoint</p></a></li>
<li><a href='#bpp_2interim'><p>Bayesian Predictive Power (BPP) for Normally Distributed Endpoint</p></a></li>
<li><a href='#bpp_binary'><p>Bayesian Predictive Power (BPP) for Binary Endpoint</p></a></li>
<li><a href='#bpp_continuous'><p>Bayesian Predictive Power (BPP) for Continuous Endpoint</p></a></li>
<li><a href='#bpp_t2e'><p>Bayesian Predictive Power (BPP) for Time-To-Event Endpoint</p></a></li>
<li><a href='#bpp-package'><p>Tools for Computation of Bayesian Predictive Power for a Normally Distributed Endpoint with Known Variance</p></a></li>
<li><a href='#estimate_posterior'><p>Posterior density conditional on known interim result</p></a></li>
<li><a href='#estimate_posterior_nominator'><p>Posterior density conditional on interim result is proportional to the value of this function</p></a></li>
<li><a href='#estimate_toIntegrate'><p>Product of posterior density and conditional power for known interim result</p></a></li>
<li><a href='#FlatNormalPosterior'><p>Integrand to compute Bayesian Predictive Power when flat prior has been updated with likelihood</p></a></li>
<li><a href='#interval_posterior_nominator'><p>Posterior density conditional on interim result, only known as interval, is proportional to the value of this function</p></a></li>
<li><a href='#interval_posterior_nominator2'><p>Posterior density conditional on two interim results, both only known as intervals, is proportional to the value of this function</p></a></li>
<li><a href='#interval_toIntegrate'><p>Product of posterior density and conditional power for blinded interim result</p></a></li>
<li><a href='#interval_toIntegrate2'><p>Product of posterior density and conditional power for blinded interim result</p></a></li>
<li><a href='#NormalNormalPosterior'><p>Normal-Normal Posterior in conjugate normal model, for known sigma</p></a></li>
<li><a href='#post_power'><p>Conditional power conditioning on a blinded interim</p></a></li>
<li><a href='#UniformNormalTails'><p>Density and CDF for Uniform Distribution with Normal tails</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Computations Around Bayesian Predictive Power</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaspar Rufibach, Paul Jordan, Markus Abt</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaspar Rufibach &lt;kaspar.rufibach@roche.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm, R (&ge; 2.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements functions to update Bayesian Predictive Power Computations after not stopping a clinical trial at an interim analysis. Such an interim analysis can either be blinded or unblinded. Code is provided for Normally distributed endpoints with known variance, with a prominent example being the hazard ratio.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-13 14:01:21 UTC; rufiback</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-13 14:32:44 UTC</td>
</tr>
</table>
<hr>
<h2 id='basicPlot'>Basic plot functions to illustrate prior and posterior densities when considering a time-to-event endpoint</h2><span id='topic+basicPlot'></span>

<h3>Description</h3>

<p>Basic plot function, labels are specific to the hazard ratio, i.e. when looking at a time-to-event endpoint.</p>


<h3>Usage</h3>

<pre><code class='language-R'>basicPlot(leg = TRUE, IntEffBoundary = NA, IntFutBoundary = NA, successmean = NA, 
       priormean = NA)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basicPlot_+3A_leg">leg</code></td>
<td>
<p><code>logical</code>, display legend?</p>
</td></tr>
<tr><td><code id="basicPlot_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Interim efficacy boundary.</p>
</td></tr>
<tr><td><code id="basicPlot_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Interim futility boundary.</p>
</td></tr>
<tr><td><code id="basicPlot_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="basicPlot_+3A_priormean">priormean</code></td>
<td>
<p>Mean of the prior.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Empty generic plot.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='bpp'>Bayesian Predictive Power (BPP) for Normally Distributed Endpoint</h2><span id='topic+bpp'></span>

<h3>Description</h3>

<p>Compute BPP for a Normally distributed endpoint, e.g. log(hazard ratio).</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp(prior = c("normal", "flat"), successmean, finalSE, priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="bpp_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_+3A_finalse">finalSE</code></td>
<td>
<p>(Known) standard error at which the final analysis of the study under consideration takes place.</p>
</td></tr>
<tr><td><code id="bpp_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="bpp_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real number, the bpp.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='bpp_1interim'>Bayesian Predictive Power (BPP) for Normally Distributed Endpoint</h2><span id='topic+bpp_1interim'></span>

<h3>Description</h3>

<p>Compute BPP and posterior density for a Normally distributed endpoint, e.g. log(hazard ratio), assuming either an unblinded or blinded interim result.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp_1interim(prior = c("normal", "flat"), interimSE, finalSE, successmean, 
                            IntEffBoundary, IntFutBoundary, IntFix, priormean, 
                            propA = 0.5, thetas, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_1interim_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of estimate at interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_finalse">finalSE</code></td>
<td>
<p>(Known) standard error at which the final analysis of the study under consideration takes place.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_intfix">IntFix</code></td>
<td>
<p>Effect sizes observed at the interim analyis, to compute BPP for an unblinded interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_propa">propA</code></td>
<td>
<p>Proportion of subjects randomized to arm A.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_thetas">thetas</code></td>
<td>
<p>Grid to compute posterior density on.</p>
</td></tr>
<tr><td><code id="bpp_1interim_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp_1interim</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr><td><code>initial BPP</code></td>
<td>
<p>BPP based on the prior.</p>
</td></tr>
<tr><td><code>conditional power interval</code></td>
<td>
<p>Conditional power, updating power at design stage with interval knowledge, i.e. corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim interval</code></td>
<td>
<p>BPP after not stopping at a blinded interim, provides the results corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim exact</code></td>
<td>
<p>BPP after not stopping at an unblinded interim, provides the results corresponding to <code>IntFix</code>.</p>
</td></tr>
<tr><td><code>posterior density exact</code></td>
<td>
<p>The posterior density, exact knowledge of interim result, i.e. corresponding to <code>IntFix</code>.</p>
</td></tr>
<tr><td><code>posterior density interval</code></td>
<td>
<p>The posterior density, interval knowledge, i.e. corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ------------------------------------------------------------------------------------------
# Reproduce all the computations in Rufibach et al (2016a) for a Normal prior.
# ------------------------------------------------------------------------------------------

# ------------------------------------------
# set all parameters:
# ------------------------------------------
# prior mean / sd
hr0 &lt;- 0.85
sd0 &lt;- 0.11
priormean &lt;- log(hr0)

# specifications for pivotal study
propA &lt;- 0.5   # proportion of patients randomized to arm A
fac &lt;- (propA * (1 - propA)) ^ (-1)
nevents &lt;- c(0.5, 1) * 1600
finalSE &lt;- sqrt(fac / nevents[2])
alphas &lt;- c(0.001, 0.049)
za &lt;- qnorm(1 - alphas / 2)
hrMDD &lt;- exp(- za * sqrt(fac / nevents))
successmean &lt;- log(hrMDD[2])

# efficacy and futility interim boundary
effi &lt;- log(hrMDD[1])
futi &lt;- log(1.025)

# grid to compute densities on
thetas &lt;- seq(-0.65, 0.3, by = 0.01)

# ------------------------------------------
# compare Normal and flat prior density
# ------------------------------------------
par(las = 1, mar = c(9, 5, 2, 1), mfrow = c(1, 2))
plot(0, 0, type = "n", xlim = c(-0.6, 0.3), ylim = c(-0.1, 5), xlab = "", ylab = "density", 
     main = "")
title(expression("Normal and flat prior density for "*theta), line = 0.7)
basicPlot(leg = FALSE, IntEffBoundary = effi, IntFutBoundary = futi, successmean = successmean, 
          priormean = priormean)
lines(thetas, dnorm(thetas, mean = log(hr0), sd = sd0), col = 2, lwd = 2)

# flat prior:
hr0flat &lt;- 0.866
width1 &lt;- 0.21
height1 &lt;- 2.48

lines(thetas, dUniformNormalTails(thetas, mu = log(hr0flat), width = width1, height = height1), 
      lwd = 2, col = 3)

# ------------------------------------------
# computations for Normal prior
# ------------------------------------------

# prior probabilities to be below 0.7 or above 1:
lims &lt;- c(0.7, 1)
pnorm1 &lt;- plnorm(lims[1], meanlog = log(hr0), sdlog = sd0, lower.tail = TRUE, log.p = FALSE)   
# pnorm(log(lims[1]), mean = log(hr0), sd = sd0)
pnorm2 &lt;- plnorm(lims[2], meanlog = log(hr0), sdlog = sd0, lower.tail = FALSE, log.p = FALSE)  
# 1 - pnorm(log(lims[2]), mean = log(hr0), sd = sd0)

# initial bpp
bpp0 &lt;- bpp(prior = "normal", successmean = successmean, finalSE = finalSE, 
            priormean = log(hr0), priorsigma = sd0)

# update prior with first external study
hr1 &lt;- 0.396
sd1 &lt;- 0.837
up1 &lt;- NormalNormalPosterior(datamean = log(hr1), sigma = sd1, n = 1, 
                             nu = log(hr0), tau = sd0)
bpp1 &lt;- bpp(prior = "normal", successmean = successmean, finalSE = finalSE, 
            priormean = up1$postmean, priorsigma = up1$postsigma)

# update prior with second external study (result derived from pooled analysis: 
# Cox regression on patient level, stratified by study):
hr2 &lt;- 0.287
sd2 &lt;- 0.658
up2 &lt;- NormalNormalPosterior(datamean = log(hr2), sigma = sd2, n = 1, nu = log(hr0), tau = sd0)
bpp2 &lt;- bpp(prior = "normal", successmean = successmean, finalSE = finalSE, 
            priormean = up2$postmean, priorsigma = up2$postsigma)

# compute bpp after not stopping at interim:
# assuming both boundaries:
bpp3.tmp &lt;- bpp_1interim(prior = "normal", interimSE = sqrt(fac / nevents[1]), 
                         finalSE = finalSE, successmean = successmean, 
                         IntEffBoundary = effi, IntFutBoundary = futi, IntFix = log(1), 
                         priormean = up2$postmean, propA = 0.5, thetas, 
                         priorsigma = up2$postsigma)
bpp3 &lt;- bpp3.tmp$"BPP after not stopping at interim interval"
post3 &lt;- bpp3.tmp$"posterior density interval"

# assuming only efficacy boundary:
bpp3_effi_only &lt;- bpp_1interim(prior = "normal", interimSE = sqrt(fac / nevents[1]), 
                               finalSE = finalSE, successmean = successmean, 
                               IntEffBoundary = effi, IntFutBoundary = log(Inf), IntFix = log(1), 
                               priormean = up2$postmean, propA = 0.5, thetas = thetas, 
                               priorsigma = 
                               up2$postsigma)$"BPP after not stopping at interim interval"

# assuming only futility boundary:
bpp3_futi_only &lt;- bpp_1interim(prior = "normal", interimSE = sqrt(fac / nevents[1]), 
                               finalSE = finalSE, successmean = successmean, 
                               IntEffBoundary = log(0), IntFutBoundary = futi, IntFix = log(1), 
                               priormean = up2$postmean, propA = 0.5, thetas = thetas, 
                               priorsigma = 
                               up2$postsigma)$"BPP after not stopping at interim interval"

# assuming interim efficacy boundary: 
bpp4.tmp &lt;- bpp_1interim(prior = "normal", interimSE = sqrt(fac / nevents[1]), 
                         finalSE = finalSE, successmean = successmean, IntEffBoundary = effi, 
                         IntFutBoundary = Inf, IntFix = c(effi, futi), priormean = up2$postmean, 
                         propA = 0.5, thetas, priorsigma = up2$postsigma)
bpp4 &lt;- bpp4.tmp$"BPP after not stopping at interim exact"[2, 1]
post4 &lt;- bpp4.tmp$"posterior density exact"[, 1]

# assuming interim futility boundary: 
bpp5.tmp &lt;- bpp_1interim(prior = "normal", interimSE = sqrt(fac / nevents[1]), 
                         finalSE = finalSE, successmean = successmean, IntEffBoundary = effi, 
                         IntFutBoundary = Inf, IntFix = futi, priormean = up2$postmean, 
                         propA = 0.5, thetas, priorsigma = up2$postsigma)
bpp5 &lt;- bpp5.tmp$"BPP after not stopping at interim exact"[2, 1]
post5 &lt;- bpp5.tmp$"posterior density exact"     # same as post4[, 2]

# ------------------------------------------
# reproduce plots in paper
# ------------------------------------------

# first two updates
par(las = 1, mar = c(9, 5, 2, 1), mfrow = c(1, 2))
plot(0, 0, type = "n", xlim = c(-0.6, 0.3), ylim = c(-0.1, 5), xlab = "", ylab = "density", 
     main = "")
title(expression("Normal prior density and corresponding posteriors for "*theta), line = 0.7)
basicPlot(leg = FALSE, IntEffBoundary = effi, IntFutBoundary = futi, successmean = successmean, 
          priormean = priormean)
lines(thetas, dnorm(thetas, mean = log(hr0), sd = sd0), col = 2, lwd = 2)
lines(thetas, dnorm(thetas, mean = up1$postmean, sd = up1$postsigma), col = 3, lwd = 2)
lines(thetas, dnorm(thetas, mean = up2$postmean, sd = up2$postsigma), col = 4, lwd = 2)
lines(thetas, post3, col = 1, lwd = 2)
legend(-0.64, 5.2, c("prior", "posterior after Sub1", "posterior after Sub1 &amp; Sub2", 
                     "posterior after Sub1 &amp; Sub2 and not stopping at interim"), 
       lty = 1, col = c(2:4, 1), bty = "n", lwd = 2)

# posterior densities for interval knowledge and thetahat equal to boundaries:
plot(0, 0, type = "n", xlim = c(-0.6, 0.3), ylim = c(-0.1, 8), xlab = "", ylab = "density", 
     main = "")
title(expression("Posteriors for "*theta*" after not stopping at interim, for Normal prior"), 
      line = 0.7)
basicPlot(leg = FALSE, IntEffBoundary = effi, IntFutBoundary = futi, successmean = successmean, 
          priormean = priormean)
lines(thetas, post3, col = 1, lwd = 2)
lines(thetas, post4, col = 2, lwd = 2)
lines(thetas, post5, col = 3, lwd = 2)

leg2 &lt;- c("interval knowledge", 
          expression(hat(theta)*" = efficacy boundary"), 
          expression(hat(theta)*" = futility boundary")
)

legend(-0.62, 8.2, leg2, lty = 1, col = 1:3, lwd = 2, bty = "n", 
       title = "posterior after not stopping at interim,")

# ------------------------------------------------------------------------------------------
# Reproduce all the computations in Rufibach et al (2016a) for flat prior.
# ------------------------------------------------------------------------------------------

# ------------------------------------------
# set all parameters first:
# ------------------------------------------

# parameters of flat prior:
priormean &lt;- log(hr0flat)

# ------------------------------------------
# computations for flat prior
# ------------------------------------------

# prior probabilities to be below 0.7 or above 1:
lims &lt;- c(0.7, 1)
flat1 &lt;- pUniformNormalTails(x = log(lims[1]), mu = priormean, width = width1, height = height1)
flat2 &lt;- 1 - pUniformNormalTails(x = log(lims[2]), mu = priormean, 
                                 width = width1, height = height1)

# prior
bpp0_1 &lt;- bpp(prior = "flat", successmean = successmean, finalSE = finalSE, 
              priormean = priormean, width = width1, height = height1)

# update with first external study
hr1 &lt;- 0.396
sd1 &lt;- 0.837
bpp1_1 &lt;- integrate(FlatNormalPosterior, lower = -Inf, upper = Inf, successmean = successmean, 
                     finalSE = finalSE, interimmean = log(hr1), interimSE = sd1, 
                     priormean = priormean, width = width1, height = height1)$value

# update prior (result derived from pooled analysis: Cox regression on patient level, 
# stratified by study)
hr2 &lt;- 0.287
sd2 &lt;- 0.658
bpp2_1 &lt;- integrate(FlatNormalPosterior, -Inf, Inf, successmean = successmean, 
                     finalSE = finalSE, interimmean = log(hr2), 
                     interimSE = sd2, priormean = priormean, 
                     width = width1, height = height1)$value

# update after not stopping at interim
# first compute synthesized prior:
hr0 &lt;- 0.85
sd0 &lt;- 0.11
up2 &lt;- NormalNormalPosterior(datamean = log(hr2), sigma = sd2, n = 1, nu = log(hr0), tau = sd0)

# assuming both boundaries:
bpp3.tmp_1 &lt;- bpp_1interim(prior = "flat", interimSE = sqrt(fac / nevents[1]), 
                         finalSE = finalSE, successmean = successmean, 
                         IntEffBoundary = effi, IntFutBoundary = futi, IntFix = log(1), 
                         priormean = up2$postmean, propA = 0.5, thetas, 
                         width = width1, height = height1)
bpp3_1 &lt;- bpp3.tmp_1$"BPP after not stopping at interim interval"
post3_1 &lt;- bpp3.tmp_1$"posterior density interval"

# assuming only efficacy boundary:
bpp3_1_effi_only &lt;- bpp_1interim(prior = "flat", interimSE = sqrt(fac / nevents[1]), 
                               finalSE = finalSE, successmean = successmean, 
                               IntEffBoundary = effi, IntFutBoundary = log(Inf), IntFix = log(1), 
                               priormean = up2$postmean, propA = 0.5, thetas = thetas, 
                               width = width1, 
                               height = height1)$"BPP after not stopping at interim interval"

# assuming only futility boundary:
bpp3_1_futi_only &lt;- bpp_1interim(prior = "flat", interimSE = sqrt(fac / nevents[1]), 
                               finalSE = finalSE, successmean = successmean, 
                               IntEffBoundary = log(0), IntFutBoundary = futi, IntFix = log(1), 
                               priormean = up2$postmean, propA = 0.5, thetas = thetas, 
                               width = width1, 
                               height = height1)$"BPP after not stopping at interim interval"

# assuming interim efficacy boundary: 
bpp4_1.tmp &lt;- bpp_1interim(prior = "flat", interimSE = sqrt(fac / nevents[1]), 
                               finalSE = finalSE, successmean = successmean, 
                               IntEffBoundary = log(0), IntFutBoundary = effi, IntFix = effi, 
                               priormean = up2$postmean, propA = 0.5, thetas = thetas, 
                               width = width1, height = height1)
bpp4_1 &lt;- bpp4_1.tmp$"BPP after not stopping at interim exact"[2, 1]
post4_1 &lt;- bpp4_1.tmp$"posterior density exact"

# assuming interim futility boundary: 
bpp5_1 &lt;- integrate(Vectorize(estimate_toIntegrate), lower = -Inf, upper = Inf, prior = "flat",
                    successmean = successmean, finalSE = finalSE, interimmean = futi, 
                    interimSE = sqrt(fac / nevents[1]), priormean = up2$postmean, width = width1, 
                    height = height1)$value


bpp5_1.tmp &lt;- bpp_1interim(prior = "flat", interimSE = sqrt(fac / nevents[1]), 
                               finalSE = finalSE, successmean = successmean, 
                               IntEffBoundary = log(0), IntFutBoundary = effi, IntFix = futi, 
                               priormean = up2$postmean, propA = 0.5, thetas = thetas, 
                               width = width1, height = height1)
bpp5_1 &lt;- bpp5_1.tmp$"BPP after not stopping at interim exact"[2, 1]
post5_1 &lt;- bpp5_1.tmp$"posterior density exact"


# ------------------------------------------
# plots for flat prior
# ------------------------------------------

# first two updates with external studies
# compute posteriors
flatpost1 &lt;- rep(NA, length(thetas))
flatpost2 &lt;- flatpost1
for (i in 1:length(thetas)){
  flatpost1[i] &lt;- estimate_posterior(x = thetas[i], prior = "flat", interimmean = log(hr1), 
                                     interimSE = sd1, priormean = priormean, 
                                     width = width1, height = height1)
  flatpost2[i] &lt;- estimate_posterior(x = thetas[i], prior = "flat", interimmean = log(hr2), 
                                     interimSE = sd2, priormean = priormean, 
                                     width = width1, height = height1)
}

par(las = 1, mar = c(9, 5, 2, 1), mfrow = c(1, 2))
plot(0, 0, type = "n", xlim = c(-0.6, 0.3), ylim = c(-0.10, 5), xlab = "", ylab = "density", 
     main = "")
title(expression("Flat prior density and corresponding posteriors for "*theta), line = 0.7)
basicPlot(leg = FALSE, IntEffBoundary = effi, IntFutBoundary = futi, successmean = successmean, 
          priormean = priormean)
lines(thetas, dUniformNormalTails(thetas, mu = priormean, width = width1, height = height1), 
      lwd = 2, col = 2)
lines(thetas, flatpost1, col = 3, lwd = 2)
lines(thetas, flatpost2, col = 4, lwd = 2)
lines(thetas, post3_1, col = 1, lwd = 2)

legend(-0.64, 5.2, c("prior", "posterior after Sub1", "posterior after Sub1 &amp; Sub2", 
                     "posterior after Sub1 &amp; Sub2 and not stopping at interim"), lty = 1, 
                     col = c(2:4, 1), bty = "n", lwd = 2)

# posterior densities for interval knowledge and thetahat equal to boundaries:
plot(0, 0, type = "n", xlim = c(-0.6, 0.3), ylim = c(-0.10, 8), xlab = "", ylab = "density", 
     main = "")
title(expression("Posteriors for "*theta*" after not stopping at interim, for Flat prior"), 
      line = 0.7)
basicPlot(leg = FALSE, IntEffBoundary = effi, IntFutBoundary = futi, successmean = successmean, 
          priormean = priormean)
lines(thetas, post3_1, col = 1, lwd = 2)
lines(thetas, post4_1, col = 2, lwd = 2)
lines(thetas, post5_1, col = 3, lwd = 2)

leg.flat &lt;- c("interval knowledge", 
              expression(hat(theta)*" = efficacy boundary"), 
              expression(hat(theta)*" = futility boundary")
)

legend(-0.62, 8.2, leg.flat, lty = 1, col = 1:3, lwd = 2, bty = "n", 
       title = "posterior after not stopping at interim,")

# ------------------------------------------
# reproduce Table 1 in Rufibach et al (2016a)
# ------------------------------------------
mat &lt;- matrix(NA, ncol = 2, nrow = 10)
mat[, 1] &lt;- c(pnorm1, pnorm2, bpp0, bpp1, bpp2, bpp3, bpp3_futi_only, bpp3_effi_only, 
              bpp4, bpp5)
mat[, 2] &lt;- c(flat1, flat2, bpp0_1, bpp1_1, bpp2_1, bpp3_1, bpp3_1_futi_only, 
              bpp3_1_effi_only, bpp4_1, bpp5_1)
colnames(mat) &lt;- c("Normal prior", "Flat prior")
rownames(mat) &lt;- c(paste("Probability for hazard ratio to be $le$ ", lims[1], sep = ""), 
paste("Probability for hazard ratio to be $ge$ ", lims[2], sep = ""), 
"PoS based on prior distribution", "PoS after Sub1", "PoS after Sub1 and Sub2", 
"PoS after not stopping at interim, assuming $inte{hat theta} in [effi{theta}, futi{theta}]$", 
"PoS after not stopping at interim, assuming $inte{hat theta} in [-infty, futi{theta}]$", 
"PoS after not stopping at interim, assuming $inte{hat theta} in [effi{theta}, infty]$", 
"PoS after not stopping at interim, assuming $inte{hat theta} = effi{theta}$", 
"PoS after not stopping at interim, assuming $inte{hat theta} = futi{theta}$")
as.data.frame(format(mat, digits = 2))

</code></pre>

<hr>
<h2 id='bpp_1interim_binary'>Bayesian Predictive Power (BPP) for Binary Endpoint</h2><span id='topic+bpp_1interim_binary'></span>

<h3>Description</h3>

<p>Compute BPP and posterior density for a binary endpoint, e.g. response proportions, assuming either an unblinded or blinded interim result.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp_1interim_binary(prior = c("normal", "flat"), successdelta, pi1, n1,
                                pi2, n2, IntEffBoundary, IntFutBoundary, 
                                IntFix, priormean, propA = 0.5, thetas, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_1interim_binary_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_successdelta">successdelta</code></td>
<td>
<p>The proportion difference that defines success at the final analysis. We assume that higher proportions are better, e.g. as for response in oncology. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_pi1">pi1</code></td>
<td>
<p>Assumed response proportion in intervention arm.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_n1">n1</code></td>
<td>
<p>2-d vector of sample sizes in intervention arm, at interim and final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_pi2">pi2</code></td>
<td>
<p>Assumed response proportion in control arm.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_n2">n2</code></td>
<td>
<p>2-d vector of sample sizes in control arm, at interim and final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_intfix">IntFix</code></td>
<td>
<p>Effect sizes observed at the interim analyis, to compute BPP for an unblinded interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_propa">propA</code></td>
<td>
<p>Proportion of subjects randomized to arm A.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_thetas">thetas</code></td>
<td>
<p>Grid to compute posterior density on.</p>
</td></tr>
<tr><td><code id="bpp_1interim_binary_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp_1interim_binary</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr><td><code>initial BPP</code></td>
<td>
<p>BPP based on the prior.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim interval</code></td>
<td>
<p>BPP after not stopping at a blinded interim, provides the results corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim exact</code></td>
<td>
<p>BPP after not stopping at an unblinded interim, provides the results corresponding to <code>IntFix</code>.</p>
</td></tr>
<tr><td><code>posterior density interval</code></td>
<td>
<p>The posterior density, interval knowledge, i.e. corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>posterior power interval</code></td>
<td>
<p>The posterior power, interval knowledge, i.e. corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>posterior density exact</code></td>
<td>
<p>The posterior density, exact knowledge of interim result, i.e. corresponding to <code>IntFix</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# simple example with response proportions
pi1 &lt;- 0.6              # proportion in intervention arm
pi2 &lt;- 0.45             # proportion in control arm
n1 &lt;- 174
n2 &lt;- 174

# MDD at final analysis - proportion difference that corresponds to "success"
mdd &lt;- 0.1

n1_int &lt;- 87
n2_int &lt;- 87

# prior if normal
pi20 &lt;- 0.44
pi10 &lt;- 0.64
n0 &lt;- 50
priormean &lt;- pi10 - pi20
sd0 &lt;- sqrt(pi20 * (1 - pi20) / (n0 / 2) + pi10 * (1 - pi10) / (n0 / 2))

# efficacy boundary
effi &lt;- 0.2

# futility boundary
futi &lt;- 0

thetas &lt;- seq(-0.65, 0.3, by = 0.01)

bpp_1interim_binary(prior = "normal", successdelta = mdd, pi1 = pi1, 
                    n1 = c(n1_int, n1), n2 = c(n2_int, n2), 
                    pi2 = pi2, IntEffBoundary = effi, IntFutBoundary = futi, 
                    IntFix = 1, priormean = priormean, propA = 0.5, 
                    thetas = thetas, priorsigma = sd0)[[1]]
                             
</code></pre>

<hr>
<h2 id='bpp_1interim_continuous'>Bayesian Predictive Power (BPP) for Continuous Endpoint</h2><span id='topic+bpp_1interim_continuous'></span>

<h3>Description</h3>

<p>Compute BPP and posterior density for a continuous endpoint, e.g. mean difference, assuming either an unblinded or blinded interim result.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp_1interim_continuous(prior = c("normal", "flat"), successmean, stDev, 
                                    n1, n2, IntEffBoundary, IntFutBoundary, IntFix, 
                                    priormean, propA = 0.5, thetas, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_1interim_continuous_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_successmean">successmean</code></td>
<td>
<p>The mean difference that defines success at the final analysis. We assume that a higher mean is better. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_stdev">stDev</code></td>
<td>
<p>Standard deviation of measurements in one group. Used to compute standard error at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_n1">n1</code></td>
<td>
<p>2-d vector of sample sizes in intervention arm, at interim and final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_n2">n2</code></td>
<td>
<p>2-d vector of sample sizes in control arm, at interim and final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_intfix">IntFix</code></td>
<td>
<p>Effect sizes observed at the interim analyis, to compute BPP for an unblinded interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_propa">propA</code></td>
<td>
<p>Proportion of subjects randomized to arm A.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_thetas">thetas</code></td>
<td>
<p>Grid to compute posterior density on.</p>
</td></tr>
<tr><td><code id="bpp_1interim_continuous_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp_1interim_continuous</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr><td><code>initial BPP</code></td>
<td>
<p>BPP based on the prior.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim interval</code></td>
<td>
<p>BPP after not stopping at a blinded interim, provides the results corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim exact</code></td>
<td>
<p>BPP after not stopping at an unblinded interim, provides the results corresponding to <code>IntFix</code>.</p>
</td></tr>
<tr><td><code>posterior density interval</code></td>
<td>
<p>The posterior density, interval knowledge, i.e. corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>posterior power interval</code></td>
<td>
<p>The posterior power, interval knowledge, i.e. corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>posterior density exact</code></td>
<td>
<p>The posterior density, exact knowledge of interim result, i.e. corresponding to <code>IntFix</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# standard deviation of measurments in one group
stDev &lt;- 24

# number of patients at interim
n1_int &lt;- 46
n2_int &lt;- 46

# number of patients at final analysis
n1 &lt;- 92
n2 &lt;- 92

# MDD at final analysis (corresponds to delta = 10 for 80% power)
mdd &lt;- 7.023506

# efficacy boundary
effi &lt;- 15

# futility boundary --&gt; chosen informally
futi &lt;- 0

# prior
priormean &lt;- 12.3
sd0 &lt;- 4.2

# flat prior
width1 &lt;- 25
height1 &lt;- 0.02

thetas &lt;- seq(-0.65, 0.3, by = 0.01)

bpp_1interim_continuous(prior = "normal", successmean = mdd, stDev = stDev, 
                                 n1 = c(n1_int, n1), n2 = c(n2_int, n2), 
                                 IntEffBoundary = effi, IntFutBoundary = futi, IntFix = 1, 
                                 priormean = priormean, propA = 0.5, thetas, 
                                 priorsigma = sd0)[[1]]
bpp_1interim_continuous(prior = "flat", successmean = mdd, stDev = stDev, 
                                   n1 = c(n1_int, n1), n2 = c(n2_int, n2), IntEffBoundary = effi, 
                                   IntFutBoundary = futi, IntFix = 1, 
                                   priormean = 12.3, propA = 0.5, thetas = thetas, 
                                   width = width1, height = height1)[[1]]
</code></pre>

<hr>
<h2 id='bpp_1interim_t2e'>Bayesian Predictive Power (BPP) for Time-to-Event Endpoint</h2><span id='topic+bpp_1interim_t2e'></span>

<h3>Description</h3>

<p>Compute BPP and posterior density for a time-to-event endpoint, e.g. hazard ratio, assuming either an unblinded or blinded interim result.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp_1interim_t2e(prior = c("normal", "flat"), successHR, d,
                             IntEffBoundary, IntFutBoundary, IntFixHR, 
                             priorHR, propA = 0.5, thetas, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_1interim_t2e_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_successhr">successHR</code></td>
<td>
<p>The hazard ratio that defines success at the final analysis. We assume that hazard ratios below 1 are beneficial. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_d">d</code></td>
<td>
<p>2-d vector with number of events at interim and final analysis. Used to compute standard errors.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis, hazard ratio.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis, hazard ratio.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_intfixhr">IntFixHR</code></td>
<td>
<p>Effect sizes observed at the interim analyis, to compute BPP for an unblinded interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_priorhr">priorHR</code></td>
<td>
<p>Hazard ratio at which prior is centered.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_propa">propA</code></td>
<td>
<p>Proportion of subjects randomized to arm A.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_thetas">thetas</code></td>
<td>
<p>Grid to compute posterior density on.</p>
</td></tr>
<tr><td><code id="bpp_1interim_t2e_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp_1interim_t2e</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr><td><code>initial BPP</code></td>
<td>
<p>BPP based on the prior.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim interval</code></td>
<td>
<p>BPP after not stopping at a blinded interim, provides the results corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim exact</code></td>
<td>
<p>BPP after not stopping at an unblinded interim, provides the results corresponding to <code>IntFix</code>.</p>
</td></tr>
<tr><td><code>posterior density interval</code></td>
<td>
<p>The posterior density, interval knowledge, i.e. corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>posterior power interval</code></td>
<td>
<p>The posterior power, interval knowledge, i.e. corresponding to <code>IntEffBoundary</code> and <code>IntFutBoundary</code>.</p>
</td></tr>
<tr><td><code>posterior density exact</code></td>
<td>
<p>The posterior density, exact knowledge of interim result, i.e. corresponding to <code>IntFix</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# number of events 
nevents &lt;- c(191, 381)

# MDD at final analysis
hrMDD &lt;-  0.8172823

# efficacy boundary
hrEffi &lt;- 0.6508829

# futility boundary --&gt; chosen informally
hrFuti &lt;- 1

# prior specifications

# Normal prior corresponding to information of 50 events in 1:1 randomized trial
hr0 &lt;- 0.7
sd0 &lt;- sqrt(4 / 50)

# flat prior
width1 &lt;- 0.5
height1 &lt;- 1

# compute bpps
thetas &lt;- seq(0.5, 1.35, by = 0.01)
bpp1b &lt;- bpp_1interim_t2e(prior = "normal", successHR = hrMDD, d = nevents,
                          IntEffBoundary = hrEffi, IntFutBoundary = hrFuti, 
                          IntFixHR = 1, priorHR = hr0, propA = 0.5, thetas = thetas, 
                          priorsigma = sd0)[[1]]
bpp1_1b &lt;- bpp_1interim_t2e(prior = "flat", successHR = hrMDD, d = nevents, 
                            IntEffBoundary = hrEffi, IntFutBoundary = hrFuti, 
                            IntFixHR = 1, priorHR = hr0, propA = 0.5, thetas = thetas, 
                            width = width1, height = height1)[[1]]
</code></pre>

<hr>
<h2 id='bpp_2interim'>Bayesian Predictive Power (BPP) for Normally Distributed Endpoint</h2><span id='topic+bpp_2interim'></span>

<h3>Description</h3>

<p>Compute BPP and posterior density for a Normally distributed endpoint, e.g. log(hazard ratio), assuming the trial did not stop at two blinded interim analyses.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp_2interim(prior = "normal", interimSE, finalSE, successmean, IntEffBoundary, 
                    IntFutBoundary, priormean, thetas, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_2interim_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes. So far, this function only accomodates a Normal prior, as opposed to <code>bpp_1interim</code> where also the pessimistic prior introduced in Rufibach et al (2016a) can be specified.</p>
</td></tr>
<tr><td><code id="bpp_2interim_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of estimate at interim analysis.</p>
</td></tr>
<tr><td><code id="bpp_2interim_+3A_finalse">finalSE</code></td>
<td>
<p>(Known) standard error at which the final analysis of the study under consideration takes place.</p>
</td></tr>
<tr><td><code id="bpp_2interim_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_2interim_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>2-d vector of efficacy boundaries at the interim analyses.</p>
</td></tr>
<tr><td><code id="bpp_2interim_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>2-d vector of futility boundary at the interim analyses.</p>
</td></tr>
<tr><td><code id="bpp_2interim_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="bpp_2interim_+3A_thetas">thetas</code></td>
<td>
<p>Grid to compute posterior density on.</p>
</td></tr>
<tr><td><code id="bpp_2interim_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp_1interim</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr><td><code>initial BPP</code></td>
<td>
<p>BPP based on the prior.</p>
</td></tr>
<tr><td><code>BPP after not stopping at interim interval</code></td>
<td>
<p>BPP after not stopping at a blinded interim.</p>
</td></tr>
<tr><td><code>posterior density interval</code></td>
<td>
<p>The posterior density, interval knowledge.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# ------------------------------------------------------------------------------------------
# Illustrate the update after two passed interims using the Gallium clinical trial
# ------------------------------------------------------------------------------------------

# ------------------------------------------
# set all parameters:
# ------------------------------------------
# prior mean / sd
hr0 &lt;- 0.9288563
priormean &lt;- log(hr0)
priorsigma &lt;- sqrt(4 / 12)

# specifications for pivotal study
propA &lt;- 0.5   # proportion of patients randomized to arm A
fac &lt;- (propA * (1 - propA)) ^ (-1)
nevents &lt;- c(111, 248, 370)
interimSE &lt;- sqrt(fac / nevents[1:2])
finalSE &lt;- sqrt(fac / nevents[3])
za &lt;- c(3.9285726330559, 2.5028231888636, 1.9936294555664)
alphas &lt;- 2 * (1 - pnorm(za))
hrMDD &lt;- exp(- za * sqrt(fac / nevents))
successmean &lt;- log(hrMDD[3])

# efficacy and futility interim boundary
effi &lt;- log(c(0, hrMDD[2]))
futi &lt;- log(c(1, Inf))

# grid to compute densities on
thetas &lt;- seq(-0.65, 0.3, by = 0.01)

bpp_2interim(prior = "normal", interimSE = interimSE, finalSE = finalSE, 
             successmean = successmean, IntEffBoundary = effi, IntFutBoundary = futi, 
             priormean = priormean, thetas = thetas, priorsigma = priorsigma)
</code></pre>

<hr>
<h2 id='bpp_binary'>Bayesian Predictive Power (BPP) for Binary Endpoint</h2><span id='topic+bpp_binary'></span>

<h3>Description</h3>

<p>Compute BPP for a binary endpoint.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp_binary(prior = c("normal", "flat"), successdelta, pi1, n1,
                       pi2, n2, priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_binary_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="bpp_binary_+3A_successdelta">successdelta</code></td>
<td>
<p>The proportion difference that defines success at the final analysis. We assume that higher proportions are better, e.g. as for response in oncology. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_binary_+3A_pi1">pi1</code></td>
<td>
<p>Assumed response proportion in intervention arm. Used to compute standard error at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_binary_+3A_n1">n1</code></td>
<td>
<p>Sample size in intervention arm. Used to compute standard error at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_binary_+3A_pi2">pi2</code></td>
<td>
<p>Assumed response proportion in control arm. Used to compute standard error at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_binary_+3A_n2">n2</code></td>
<td>
<p>Sample size in control arm. Used to compute standard error at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_binary_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="bpp_binary_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp_binary</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real number, the bpp.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# simple example with response proportions
pi1 &lt;- 0.6              # proportion in intervention arm
pi2 &lt;- 0.45             # proportion in control arm
n1 &lt;- 174
n2 &lt;- 174

# MDD at final analysis - proportion difference that corresponds to "success"
mdd &lt;- 0.1

# prior if normal
pi20 &lt;- 0.44
pi10 &lt;- 0.64
n0 &lt;- 50
priormean &lt;- pi10 - pi20
sd0 &lt;- sqrt(pi20 * (1 - pi20) / (n0 / 2) + pi10 * (1 - pi10) / (n0 / 2))

bpp0 &lt;- bpp_binary(prior = "normal", successdelta = mdd, pi1 = pi1, n1 = n1,
           pi2 = pi2, n2 = n2, priormean = priormean, priorsigma = sd0)
bpp0

# prior if flat
width1 &lt;- 0.5
height1 &lt;- 1.5

bpp0_1 &lt;- bpp_binary(prior = "flat", successdelta = mdd, pi1 = pi1, n1 = n1,
                    pi2 = pi2, n2 = n2, priormean = priormean, 
                    width = width1, height = height1)
bpp0_1
</code></pre>

<hr>
<h2 id='bpp_continuous'>Bayesian Predictive Power (BPP) for Continuous Endpoint</h2><span id='topic+bpp_continuous'></span>

<h3>Description</h3>

<p>Compute BPP for a continuous endpoint.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp_continuous(prior = c("normal", "flat"), successmean, stDev, 
                      n1, n2, priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_continuous_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="bpp_continuous_+3A_successmean">successmean</code></td>
<td>
<p>The mean difference that defines success at the final analysis. We assume that a higher mean is better. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_continuous_+3A_stdev">stDev</code></td>
<td>
<p>Standard deviation of measurements in one group. Used to compute standard error at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_continuous_+3A_n1">n1</code></td>
<td>
<p>Sample size in intervention arm. Used to compute standard error at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_continuous_+3A_n2">n2</code></td>
<td>
<p>Sample size in control arm. Used to compute standard error at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_continuous_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="bpp_continuous_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp_continuous</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real number, the bpp.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# standard deviation of measurments in one group
stDev &lt;- 24

# sample size at final analysis
n1 &lt;- 92
n2 &lt;- 92

# MDD at final analysis (corresponds to delta = 10 for 80% power)
mdd &lt;- 7.023506

# prior
priormean &lt;- 12.3

# standard error for prior, based on Phase 2 data
sig1 &lt;- 26.1
n1p &lt;- 25
sig2 &lt;- 33.6
n2p &lt;- 25
sd0 &lt;- sqrt(sig1 ^ 2 / n1p + sig2 ^ 2 / n2p)

# flat prior
width1 &lt;- 25
height1 &lt;- 0.02

# bpps
bpp_continuous(prior = "normal", successmean = mdd, stDev = stDev, 
                        n1 = n1, n2 = n2, priormean = priormean, priorsigma = sd0)
bpp_continuous(prior = "flat", successmean = mdd, stDev = stDev, 
                          n1 = n1, n2 = n2, priormean = priormean, 
                          width = width1, height = height1)

</code></pre>

<hr>
<h2 id='bpp_t2e'>Bayesian Predictive Power (BPP) for Time-To-Event Endpoint</h2><span id='topic+bpp_t2e'></span>

<h3>Description</h3>

<p>Compute BPP for a time-to-event endpoint.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpp_t2e(prior = c("normal", "flat"), successHR, d, propA = 0.5,
                    priorHR, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpp_t2e_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="bpp_t2e_+3A_successhr">successHR</code></td>
<td>
<p>The hazard ratio that defines success at the final analysis. We assume that a hazard ratio below 1 corresponds to better outcome. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="bpp_t2e_+3A_d">d</code></td>
<td>
<p>Number of events at final analysis.</p>
</td></tr>
<tr><td><code id="bpp_t2e_+3A_propa">propA</code></td>
<td>
<p>Proportion of subjects randomized to arm A.</p>
</td></tr>
<tr><td><code id="bpp_t2e_+3A_priorhr">priorHR</code></td>
<td>
<p>Hazard ratio around which the prior is centered.</p>
</td></tr>
<tr><td><code id="bpp_t2e_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp_t2e</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real number, the bpp.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# hazard ratio to beat at final analysis
hrMDD &lt;- 0.8173

# number of events at final analysis
nevents &lt;- 381

# prior
hr0 &lt;- 0.7

# SE for a normal prior corresponding to information of 50 events in 1:1 randomized trial
sd0 &lt;- sqrt(4 / 50)

# parameters of flat prior
width1 &lt;- 0.5
height1 &lt;- 1

# compute bpp
bpp_t2e(prior = "normal", successHR = hrMDD, d = nevents,
                 priorHR = hr0, priorsigma = sd0)
bpp_t2e(prior = "flat", successHR = hrMDD, d = nevents,
                   priorHR = hr0, width = width1, height = height1)

</code></pre>

<hr>
<h2 id='bpp-package'>Tools for Computation of Bayesian Predictive Power for a Normally Distributed Endpoint with Known Variance</h2><span id='topic+bpp-package'></span><span id='topic+pts'></span><span id='topic+ddcp'></span>

<h3>Description</h3>

<p>Implements functions to update Bayesian Predictive Power Computations after not stopping a clinical trial at an interim analysis, whether blinded or unblinded, for a Normally distributed endpoint with known variance, with a prominent example being the hazard ratio.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package:  </td><td style="text-align: left;"> bpp  </td>
</tr>
<tr>
 <td style="text-align: left;">
Type:     </td><td style="text-align: left;"> Package    </td>
</tr>
<tr>
 <td style="text-align: left;">
Version:  </td><td style="text-align: left;"> 1.0.4      </td>
</tr>
<tr>
 <td style="text-align: left;">
Date:     </td><td style="text-align: left;"> 2022-01-13 </td>
</tr>
<tr>
 <td style="text-align: left;">
License:  </td><td style="text-align: left;"> GPL (&gt;=2)  </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes        </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> 
<a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a>
</p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>
<p>Rufibach, K., Burger, H.U., Abt, M. (2016b). 
Bayesian Predictive Power: Choice of Prior and some Recommendations for its Use as Probability of Success in Drug Development.
<em>Pharm. Stat.</em>, <b>15</b>, 438&ndash;446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='estimate_posterior'>Posterior density conditional on known interim result</h2><span id='topic+estimate_posterior'></span>

<h3>Description</h3>

<p>If we update the prior with a known estimate at an interim analysis, we get this density.</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_posterior(x, prior = c("normal", "flat"), interimmean, interimSE, priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_posterior_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="estimate_posterior_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="estimate_posterior_+3A_interimmean">interimmean</code></td>
<td>
<p>Mean of the data.</p>
</td></tr>
<tr><td><code id="estimate_posterior_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>.</p>
</td></tr>
<tr><td><code id="estimate_posterior_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="estimate_posterior_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='estimate_posterior_nominator'>Posterior density conditional on interim result is proportional to the value of this function</h2><span id='topic+estimate_posterior_nominator'></span>

<h3>Description</h3>

<p>If we update the prior with a known estimate at an interim analysis, we get a density that is proportional to the value of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_posterior_nominator(x, prior = c("normal", "flat"), interimmean, 
                                    interimSE, priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_posterior_nominator_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="estimate_posterior_nominator_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="estimate_posterior_nominator_+3A_interimmean">interimmean</code></td>
<td>
<p>Mean of the data.</p>
</td></tr>
<tr><td><code id="estimate_posterior_nominator_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>.</p>
</td></tr>
<tr><td><code id="estimate_posterior_nominator_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="estimate_posterior_nominator_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='estimate_toIntegrate'>Product of posterior density and conditional power for known interim result</h2><span id='topic+estimate_toIntegrate'></span>

<h3>Description</h3>

<p>Product of posterior density and conditional power for known interim result, integrate over this function to get BPP.</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_toIntegrate(x, prior = c("normal", "flat"), successmean, 
            finalSE, interimmean, interimSE, priormean, propA = 0.5, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_toIntegrate_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="estimate_toIntegrate_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="estimate_toIntegrate_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="estimate_toIntegrate_+3A_finalse">finalSE</code></td>
<td>
<p>(Known) standard error at which the final analysis of the study under consideration takes place.</p>
</td></tr>
<tr><td><code id="estimate_toIntegrate_+3A_interimmean">interimmean</code></td>
<td>
<p>Mean of the data.</p>
</td></tr>
<tr><td><code id="estimate_toIntegrate_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>.</p>
</td></tr>
<tr><td><code id="estimate_toIntegrate_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="estimate_toIntegrate_+3A_propa">propA</code></td>
<td>
<p>Proportion of subjects randomized to arm A.</p>
</td></tr>
<tr><td><code id="estimate_toIntegrate_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='FlatNormalPosterior'>Integrand to compute Bayesian Predictive Power when flat prior has been updated with likelihood</h2><span id='topic+FlatNormalPosterior'></span>

<h3>Description</h3>

<p>Assume we have a flat prior on our effect, update it with a Normal likelihood and then want to compute Bayesian Predictive Power. This function provides the integrand for that computation, i.e. the product of the power function and the posterior.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FlatNormalPosterior(x, successmean, finalSE, interimmean, interimSE, priormean, 
                           width, height)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FlatNormalPosterior_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="FlatNormalPosterior_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="FlatNormalPosterior_+3A_finalse">finalSE</code></td>
<td>
<p>(Known) standard error at which the final analysis of the study under consideration takes place.</p>
</td></tr>
<tr><td><code id="FlatNormalPosterior_+3A_interimmean">interimmean</code></td>
<td>
<p>Mean of the data.</p>
</td></tr>
<tr><td><code id="FlatNormalPosterior_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>.</p>
</td></tr>
<tr><td><code id="FlatNormalPosterior_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="FlatNormalPosterior_+3A_width">width</code></td>
<td>
<p>Width of the flat part of the prior.</p>
</td></tr>
<tr><td><code id="FlatNormalPosterior_+3A_height">height</code></td>
<td>
<p>Height of the flat part of the prior.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='interval_posterior_nominator'>Posterior density conditional on interim result, only known as interval, is proportional to the value of this function</h2><span id='topic+interval_posterior_nominator'></span>

<h3>Description</h3>

<p>If we update the prior with the knowledge that the interim estimate was between a futility and efficacy boundary at an interim analysis, we get a density that is proportional to the value of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval_posterior_nominator(x, prior = c("normal", "flat"), 
          IntEffBoundary, IntFutBoundary, interimSE, priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interval_posterior_nominator_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>, i.e. at interim analysis.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='interval_posterior_nominator2'>Posterior density conditional on two interim results, both only known as intervals, is proportional to the value of this function</h2><span id='topic+interval_posterior_nominator2'></span>

<h3>Description</h3>

<p>If we update the prior with the knowledge that two interim estimates were between a futility and efficacy boundary, we get a density that is proportional to the value of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval_posterior_nominator2(x, prior = "normal", 
          IntEffBoundary, IntFutBoundary, interimSE, priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interval_posterior_nominator2_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator2_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator2_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator2_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator2_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>, i.e. at interim analysis.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator2_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="interval_posterior_nominator2_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_2interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='interval_toIntegrate'>Product of posterior density and conditional power for blinded interim result</h2><span id='topic+interval_toIntegrate'></span>

<h3>Description</h3>

<p>Product of posterior density and conditional power for blinded interim result, integrate over this function to get BPP.</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval_toIntegrate(x, prior = c("normal", "flat"), interimSE, 
             finalSE, successmean, IntEffBoundary, IntFutBoundary, 
             priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interval_toIntegrate_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>, i.e. at interim analysis.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate_+3A_finalse">finalSE</code></td>
<td>
<p>(Known) standard error at which the final analysis of the study under consideration takes place.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='interval_toIntegrate2'>Product of posterior density and conditional power for blinded interim result</h2><span id='topic+interval_toIntegrate2'></span>

<h3>Description</h3>

<p>Product of posterior density and conditional power for two blinded interim results, integrate over this function to get BPP.</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval_toIntegrate2(x, prior = "normal", interimSE, finalSE, successmean, 
                             IntEffBoundary, IntFutBoundary, priormean, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interval_toIntegrate2_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate2_+3A_prior">prior</code></td>
<td>
<p>Prior density on effect sizes.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate2_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>, i.e. at interim analysis.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate2_+3A_finalse">finalSE</code></td>
<td>
<p>(Known) standard error at which the final analysis of the study under consideration takes place.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate2_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate2_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate2_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate2_+3A_priormean">priormean</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="interval_toIntegrate2_+3A_...">...</code></td>
<td>
<p>Further arguments specific to the chosen prior (see <code>bpp</code> for examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_2interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='NormalNormalPosterior'>Normal-Normal Posterior in conjugate normal model, for known sigma</h2><span id='topic+NormalNormalPosterior'></span>

<h3>Description</h3>

<p>Compute the posterior distribution in a conjugate normal model for known variance: Let <code class="reqn">X_1, \ldots, X_n</code> be a sample from a <code class="reqn">N(\mu, \sigma^2)</code> distribution, with <code class="reqn">\sigma</code> assumed known. We assume a prior distribution on <code class="reqn">\mu</code>, namely <code class="reqn">N(\nu, \tau^2)</code>. The posterior distribution is then <code class="reqn">\mu|x \sim N(\mu_p, \sigma_p^2)</code> with
</p>
<p style="text-align: center;"><code class="reqn">\mu_p = (1 / (\sigma^2 / n) + \tau^{-2})^{-1}  (\bar{x} / (\sigma^2/n) + \nu / \tau^2)</code>
</p>

<p>and 
</p>
<p style="text-align: center;"><code class="reqn">\sigma_p = (1 / (\sigma^2/n) + \tau^{-2})^{-1}.</code>
</p>

<p>These formulas are available e.g. in Held (2014, p. 182).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NormalNormalPosterior(datamean, sigma, n, nu, tau)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NormalNormalPosterior_+3A_datamean">datamean</code></td>
<td>
<p>Mean of the data.</p>
</td></tr>
<tr><td><code id="NormalNormalPosterior_+3A_sigma">sigma</code></td>
<td>
<p>(Known) standard deviation of the data.</p>
</td></tr>
<tr><td><code id="NormalNormalPosterior_+3A_n">n</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="NormalNormalPosterior_+3A_nu">nu</code></td>
<td>
<p>Prior mean.</p>
</td></tr>
<tr><td><code id="NormalNormalPosterior_+3A_tau">tau</code></td>
<td>
<p>Prior standard deviation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the entries:
</p>
<table>
<tr><td><code>postmean</code></td>
<td>
<p>Posterior mean.</p>
</td></tr>
<tr><td><code>postsigma</code></td>
<td>
<p>Posterior standard deviation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Held, L., Sabanes-Bove, D. (2014). 
<em>Applied Statistical Inference</em>.
Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data:
n &lt;- 25
sd0 &lt;- 3
x &lt;- rnorm(n, mean = 2, sd = sd0)

## prior:
nu &lt;- 0
tau &lt;- 2

## posterior:
NormalNormalPosterior(datamean = mean(x), sigma = sd0, 
                      n = n, nu = nu, tau = tau)
</code></pre>

<hr>
<h2 id='post_power'>Conditional power conditioning on a blinded interim</h2><span id='topic+post_power'></span>

<h3>Description</h3>

<p>Conditional power conditioning on a blinded interim, i.e. the estimate after the interim is only known to lie in an interval.</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_power(x, interimSE, finalSE, successmean, IntEffBoundary, IntFutBoundary)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_power_+3A_x">x</code></td>
<td>
<p>Value at which to evaluate the function.</p>
</td></tr>
<tr><td><code id="post_power_+3A_interimse">interimSE</code></td>
<td>
<p>(Known) standard error of <code>interimmean</code>.</p>
</td></tr>
<tr><td><code id="post_power_+3A_finalse">finalSE</code></td>
<td>
<p>(Known) standard error at which the final analysis of the study under consideration takes place.</p>
</td></tr>
<tr><td><code id="post_power_+3A_successmean">successmean</code></td>
<td>
<p>The mean that defines success at the final analysis. Typically chosen to be the minimal detectable difference, i.e. the critical on the scale of the effect size of interest corresponding to the significance level at the final analysis.</p>
</td></tr>
<tr><td><code id="post_power_+3A_inteffboundary">IntEffBoundary</code></td>
<td>
<p>Efficacy boundary at the interim analysis.</p>
</td></tr>
<tr><td><code id="post_power_+3A_intfutboundary">IntFutBoundary</code></td>
<td>
<p>Futility boundary at the interim analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the function, a real number.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

<hr>
<h2 id='UniformNormalTails'>Density and CDF for Uniform Distribution with Normal tails</h2><span id='topic+dUniformNormalTails'></span><span id='topic+pUniformNormalTails'></span>

<h3>Description</h3>

<p>Density function and cumulative distribution function for a Uniform density with Normal tails. Introduced in Rufibach et al (2016a) as pessimistic distribution to compute Bayesian Predictive Power.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dUniformNormalTails(x, mu, width, height)
pUniformNormalTails(x, mu, width, height)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UniformNormalTails_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="UniformNormalTails_+3A_mu">mu</code></td>
<td>
<p>Mean of the pessimistic prior.</p>
</td></tr>
<tr><td><code id="UniformNormalTails_+3A_width">width</code></td>
<td>
<p>Width of the flat part of the prior.</p>
</td></tr>
<tr><td><code id="UniformNormalTails_+3A_height">height</code></td>
<td>
<p>Height of the flat part of the prior.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density at <code>x</code>.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a></p>


<h3>References</h3>

<p>Rufibach, K., Jordan, P., Abt, M. (2016a). 
Sequentially Updating the Likelihood of Success of a Phase 3 Pivotal Time-to-Event Trial based on Interim Analyses or External Information. 
<em>J. Biopharm. Stat.</em>, <b>26</b>(2), 191&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# type ?bpp_1interim for code of all the computations in Rufibach et al (2016a).

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
