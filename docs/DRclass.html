<!DOCTYPE html><html lang="en"><head><title>Help for package DRclass</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DRclass}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DRclass-package'><p>Consider Ambiguity in Probabilistic Descriptions Using Density Ratio Classes</p></a></li>
<li><a href='#DRclass_k_Cdf'><p>Calculate lower and upper bounds of the cumulative density function for the</p>
marginals of a Density Ratio Class for which the lower and upper bounding
functions are proportional.</a></li>
<li><a href='#DRclass_k_Pdf'><p>Calculate marginal class bounding functions for a special Density Ratio</p>
Class for which the lower and upper bounding functions are proportional.</a></li>
<li><a href='#DRclass_k_Quantile'><p>Calculate lower and upper bounds of quantiles of marginals of a Density</p>
Ratio Class for which the lower and upper bounding functions are proportional.</a></li>
<li><a href='#DRclass_lu_Cdf'><p>Calculate lower and upper bounds of the cumulative density function for the</p>
marginals of a general Density Ratio Class.
The cumulative density functions for the marginals of a distributions
proportional to the lower and upper bounding functions are also provided.
See the function 'DRclass_k_Cdf' for the case in which the upper and lower
bounding functions of the class are proportional.</a></li>
<li><a href='#DRclass_lu_Pdf'><p>Calculate marginal class bounding functions for the general case of a</p>
Density Ratio Class.</a></li>
<li><a href='#DRclass_lu_Quantile'><p>Calculate lower and upper bounds of quantiles of marginals of a Density</p>
Ratio Class.
Quantiles of the marginals of distributions proportional to the lower and
upper bounding functions are also provided.
See the function 'DRclass_k_Quantile' for the case in which the upper and
lower bounding functions of the class are proportional.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Consider Ambiguity in Probabilistic Descriptions Using Density
Ratio Classes</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Consider ambiguity in probabilistic descriptions by replacing a parametric probabilistic description of uncertainty by a non-parametric set of probability distributions in the form of a Density Ratio Class. This is of particular interest in Bayesian inference.
    The Density Ratio Class is particularly suited for this purpose as it is invariant under Bayesian inference, marginalization, and propagation through a deterministic model. Here, invariant means that the result of the operation applied to a Density Ratio Class is again a Density Ratio Class. In particular the invariance under Bayesian inference thus enables iterative learning within the same framework of Density Ratio Classes.
    The use of imprecise probabilities in general, and Density Ratio Classes in particular, lead to intervals of characteristics of probability distributions, such as cumulative distribution functions, quantiles, and means.
    The package is based on a sample of the distribution proportional to the upper bound of the class. Typically this will be a sample from the posterior in Bayesian inference. Based on such a sample, the package provides functions to calculate lower and upper class boundaries and lower and upper bounds of cumulative distribution functions, and quantiles.
    Rinderknecht, S.L., Albert, C., Borsuk, M.E., Schuwirth, N., Kuensch, H.R. and Reichert, P. (2014) "The effect of ambiguous prior knowledge on Bayesian model parameter inference and prediction." Environmental Modelling &amp; Software. 62, 300-315, 2014. &lt;<a href="https://doi.org/10.1016%2Fj.envsoft.2014.08.020">doi:10.1016/j.envsoft.2014.08.020</a>&gt;.
    Sriwastava, A. and Reichert, P. "Robust Bayesian Estimation of Value Function Parameters using Imprecise Priors." Submitted. <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4973574">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4973574</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>stats</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/p.reichert/DRclass">https://gitlab.com/p.reichert/DRclass</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-07 21:23:06 UTC; peter</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Reichert [aut, cre],
  Ambuj Sriwastava [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Reichert &lt;peter.reichert@emeriti.eawag.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-10 15:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='DRclass-package'>Consider Ambiguity in Probabilistic Descriptions Using Density Ratio Classes</h2><span id='topic+DRclass-package'></span>

<h3>Description</h3>

<p>Consider ambiguity in probabilistic descriptions by replacing a parametric probabilistic description of uncertainty by a non-parametric set of probability distributions in the form of a Density Ratio Class. This is of particular interest in Bayesian inference.
</p>
<p>The Density Ratio Class is particularly suited for this purpose as it is invariant under Bayesian inference, marginalization, and propagation through a deterministic model. Here, invariant means that the result of the operation applied to a Density Ratio Class is again a Density Ratio Class. In particular the invariance under Bayesian inference thus enables iterative learning within the same framework of Density Ratio Classes.
</p>
<p>The replacement of exact priors by Density Ratio Classes makes it possible to determine the sensitivity of the posterior to the shape of the prior. 
This is an important extension of the investigation to the width of the prior.
</p>
<p>The use of imprecise probabilities in general, and Density Ratio Classes in particular, lead to intervals of characteristics of probability distributions, such as cumulative distribution functions, quantiles, and means.
</p>
<p>The package is based on a sample of distribution proportional to the upper bound of the class. Typically this will be sample from the posterior in Bayesian inference. Based on such a sample, the package provides functions to calculate<br />
- lower and upper class boundaries (<code><a href="#topic+DRclass_k_Pdf">DRclass_k_Pdf</a></code>, <code><a href="#topic+DRclass_lu_Pdf">DRclass_lu_Pdf</a></code>),<br />
- lower and upper bounds of cumulative distribution functions (<code><a href="#topic+DRclass_k_Cdf">DRclass_k_Cdf</a></code>, <code><a href="#topic+DRclass_lu_Cdf">DRclass_lu_Cdf</a></code>),<br />
- lower and upper bounds of quantiles (<code><a href="#topic+DRclass_k_Quantile">DRclass_k_Quantile</a></code>, <code><a href="#topic+DRclass_lu_Quantile">DRclass_lu_Quantile</a></code>), and<br />
for the marginals of the Density Ratio Class.<br />
</p>
<p>This sensitivity analysis to the shape of the distribution is obtained computationally very cheaply even for the results of Bayesian inference.
If the bounding functions of the prior class are proportional, this does not require any additional evaluation of the bounding functions, l and u, once a sample of the posterior of the distribution proportional to the upper bounding function is available (functions <code><a href="#topic+DRclass_k_Pdf">DRclass_k_Pdf</a></code>, <code><a href="#topic+DRclass_k_Cdf">DRclass_k_Cdf</a></code>, <code><a href="#topic+DRclass_k_Quantile">DRclass_k_Quantile</a></code>).
In the case of different shapes, the bounding functions have to be evaluated at the sample points (functions <code><a href="#topic+DRclass_lu_Pdf">DRclass_lu_Pdf</a></code>, <code><a href="#topic+DRclass_lu_Cdf">DRclass_lu_Cdf</a></code>, <code><a href="#topic+DRclass_lu_Quantile">DRclass_lu_Quantile</a></code>).
However, as only the ratio of bounding functions, l and u, is needed, in the context of Bayesian inference, the bounding functions of the prior can be provided as the likelihood, L, cancels when calculating the ratio: (l L)/(u L) = l/u.
As in most cases the evaluation of the prior is computationally much cheaper than that of the likelihood, the computational effort for the sensitivity analysis is much smaller than the effort of the preceding sampling from the posterior in Bayesian inference..
</p>
<p>The package contains a copy of the bisection algorithm from package cmna (<a href="https://cran.r-project.org/package=cmna">https://cran.r-project.org/package=cmna</a>) modified to allow for additional arguments to the function of which the root is to be found.</p>


<h3>References</h3>

<p>Direct references underlying this package:
</p>
<p>Rinderknecht, S.L., Albert, C., Borsuk, M.E., Schuwirth, N., Kuensch, H.R. and Reichert, P. The effect of ambiguous prior knowledge on Bayesian model parameter inference and prediction. Environmental Modelling &amp; Software. 62, 300-315, 2014. https://doi.org/10.1016/j.envsoft.2014.08.020.
</p>
<p>Sriwastava, A. and Reichert, P. Robust Bayesian Estimation of Value Function Parameters using Imprecise Priors. Submitted. https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4973574. 
</p>
<p>Original references to the Density Ratio Class:
</p>
<p>DeRobertis, L., Hartigan, J.A. Bayesian inference using intervals of measures. Ann. Stat. 9 (2), 235-244, 1981.
</p>
<p>Berger, J.O. Robust Bayesian analysis: sensitivity to the prior. J. Stat. Plan. Inference 25, 303-328, 1990.
</p>
<p>Wasserman, L. Invariance properties of density ratio priors. Ann. Stat. 20 (4), 2177-2182, 1992.
</p>
<p>Wasserman, L. and Kadane, J. B. Computing bounds of expectations. Journal of the Americal Statistical Association, 87(418), 483–503, 1992.
</p>
<p>Berger, J.O. An overview of robust Bayesian analysis. Test 3, 5-124, 1994.
</p>
<p>Geweke, J. and Petrella, L. Prior density-ratio class robustness in econometrics. Journal of Business &amp; Economic Statistics, 16(4), 469–478, 1998.
</p>

<hr>
<h2 id='DRclass_k_Cdf'>Calculate lower and upper bounds of the cumulative density function for the
marginals of a Density Ratio Class for which the lower and upper bounding
functions are proportional.</h2><span id='topic+DRclass_k_Cdf'></span>

<h3>Description</h3>

<p>The cumulative density functions for the marginals of a distributions
proportional to the lower and upper bounding functions are also provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DRclass_k_Cdf(sample_u, k = 1, nout = 512)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DRclass_k_Cdf_+3A_sample_u">sample_u</code></td>
<td>
<p>Sample from a distribution proportional to the upper bound
of the class, often from the posterior of the upper bound
of the prior in Bayesian inference.
Columns represent variables, rows go across the sample.</p>
</td></tr>
<tr><td><code id="DRclass_k_Cdf_+3A_k">k</code></td>
<td>
<p>Factor of proportionality between upper (u) and lower (l)
bound: u = k * l</p>
</td></tr>
<tr><td><code id="DRclass_k_Cdf_+3A_nout">nout</code></td>
<td>
<p>Number of equally spaced output intervals for the marginal
densities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is more efficient than 'DRclass_lu_Pdf' as it does not
need the evaluation of the bounding functions, l and u. 
It is thus recommended to use this function if l and u are proportional.
</p>


<h3>Value</h3>

<p>Three dimensional array with the following dimensions:
1: variable corresponding to column of the sample
2: equidistant spacing of that variable
3: five columns for
variable values,
lower bound of the cdf of the marginal of the class,
cdf of the marginal corresponding to the lower class boundary,
cdf of the marginal corresponding to the upper class boundary,
upper bound of the cdf of the marginal of the class
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example of the application of DRclass functions:
# ------------------------------------------------

# parameter values
k        &lt;- 10
sd       &lt;- 0.5
sampsize &lt;- 10000

# upper and lower class boundaries:
u &lt;- function(x) { return(    dnorm(x,0,sd)) }
l &lt;- function(x) { return(1/k*dnorm(x,0,sd)) }

# generate sample:
sample_u &lt;- cbind(rnorm(sampsize,0,sd),rnorm(sampsize,0,sd))  # example of 2d sample

# get class boundaries (back from sample):
pdf1   &lt;- DRclass_k_Pdf(sample_u,k=k,adjust=2)       # faster for l proportional to u
pdf2   &lt;- DRclass_lu_Pdf(sample_u,l=l,u=u,adjust=2)  # l and u could have different shapes

# get cdf bounds:
cdf1   &lt;- DRclass_k_Cdf(sample_u,k=k)
cdf2   &lt;- DRclass_lu_Cdf(sample_u,l=l,u=u)

# get quantile bounds:
quant1 &lt;- DRclass_k_Quantile(sample_u,k=k,probs=c(0.025,0.5,0.975))
quant2 &lt;- DRclass_lu_Quantile(sample_u,l=l,u=u,probs=c(0.025,0.5,0.975))

# plot selected features of the first component of the sample:
oldpar &lt;- par(no.readonly=TRUE)
par(mar=c(5, 4, 1, 4) + 0.1)  # c(bottom, left, top, right)
plot(pdf1[1,,c("x","u")],type="l",xaxs="i",yaxs="i",xlim=c(-2,2),xlab="x",ylab="pdf")
lines(pdf2[1,,c("x","l")])
par(new=TRUE)
plot(cdf1[1,,c("x","F_upper")],type="l",xaxs="i",yaxs="i",axes=FALSE,
     xlim=c(-2,2),ylim=c(0,1),ylab="",lty="dashed")
axis(4); mtext("cdf",4,2)
lines(cdf2[1,,c("x","F_lower")],lty="dashed")
abline(v=quant1["quant_lower_0.5",1],lty="dotted")
abline(v=quant1["quant_upper_0.5",1],lty="dotted")
abline(v=quant1["quant_lower_0.025",1],lty="dotdash")
abline(v=quant1["quant_upper_0.975",1],lty="dotdash")
par(oldpar)
</code></pre>

<hr>
<h2 id='DRclass_k_Pdf'>Calculate marginal class bounding functions for a special Density Ratio
Class for which the lower and upper bounding functions are proportional.</h2><span id='topic+DRclass_k_Pdf'></span>

<h3>Description</h3>

<p>This function is more efficient than 'DRclass_lu_Pdf' as it does not
need the evaluation of the bounding functions, l and u. 
It is thus recommended to use this function if l and u are proportional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DRclass_k_Pdf(sample_u, k = 1, nout = 512, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DRclass_k_Pdf_+3A_sample_u">sample_u</code></td>
<td>
<p>Sample from a distribution proportional to the upper bound
of the class, often from the posterior of the upper bound
of the prior in Bayesian inference.
Columns represent variables, rows go across the sample.</p>
</td></tr>
<tr><td><code id="DRclass_k_Pdf_+3A_k">k</code></td>
<td>
<p>Factor of proportionality between upper (u) and lower (l)
bound: u = k * l</p>
</td></tr>
<tr><td><code id="DRclass_k_Pdf_+3A_nout">nout</code></td>
<td>
<p>Number of equally spaced output intervals for the marginal
densities.</p>
</td></tr>
<tr><td><code id="DRclass_k_Pdf_+3A_...">...</code></td>
<td>
<p>Further arguments passed to the function 'density'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Three dimensional array with the following dimensions:
1: variable corresponding to column of the sample
2: equidistant spacing of that variable
3: three columns for
variable values,
upper normalized density of the marginal class,
lower non-normalized density of the marginal class
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example of the application of DRclass functions:
# ------------------------------------------------

# parameter values
k        &lt;- 10
sd       &lt;- 0.5
sampsize &lt;- 10000

# upper and lower class boundaries:
u &lt;- function(x) { return(    dnorm(x,0,sd)) }
l &lt;- function(x) { return(1/k*dnorm(x,0,sd)) }

# generate sample:
sample_u &lt;- cbind(rnorm(sampsize,0,sd),rnorm(sampsize,0,sd))  # example of 2d sample

# get class boundaries (back from sample):
pdf1   &lt;- DRclass_k_Pdf(sample_u,k=k,adjust=2)       # faster for l proportional to u
pdf2   &lt;- DRclass_lu_Pdf(sample_u,l=l,u=u,adjust=2)  # l and u could have different shapes

# get cdf bounds:
cdf1   &lt;- DRclass_k_Cdf(sample_u,k=k)
cdf2   &lt;- DRclass_lu_Cdf(sample_u,l=l,u=u)

# get quantile bounds:
quant1 &lt;- DRclass_k_Quantile(sample_u,k=k,probs=c(0.025,0.5,0.975))
quant2 &lt;- DRclass_lu_Quantile(sample_u,l=l,u=u,probs=c(0.025,0.5,0.975))

# plot selected features of the first component of the sample:
oldpar &lt;- par(no.readonly=TRUE)
par(mar=c(5, 4, 1, 4) + 0.1)  # c(bottom, left, top, right)
plot(pdf1[1,,c("x","u")],type="l",xaxs="i",yaxs="i",xlim=c(-2,2),xlab="x",ylab="pdf")
lines(pdf2[1,,c("x","l")])
par(new=TRUE)
plot(cdf1[1,,c("x","F_upper")],type="l",xaxs="i",yaxs="i",axes=FALSE,
     xlim=c(-2,2),ylim=c(0,1),ylab="",lty="dashed")
axis(4); mtext("cdf",4,2)
lines(cdf2[1,,c("x","F_lower")],lty="dashed")
abline(v=quant1["quant_lower_0.5",1],lty="dotted")
abline(v=quant1["quant_upper_0.5",1],lty="dotted")
abline(v=quant1["quant_lower_0.025",1],lty="dotdash")
abline(v=quant1["quant_upper_0.975",1],lty="dotdash")
par(oldpar)
</code></pre>

<hr>
<h2 id='DRclass_k_Quantile'>Calculate lower and upper bounds of quantiles of marginals of a Density
Ratio Class for which the lower and upper bounding functions are proportional.</h2><span id='topic+DRclass_k_Quantile'></span>

<h3>Description</h3>

<p>Quantiles of the marginals of distributions proportional to the lower and
upper bounding functions are also provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DRclass_k_Quantile(
  sample_u,
  k = 1,
  probs = c(0.025, 0.25, 0.5, 0.75, 0.975),
  tol = 0.001,
  maxiter = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DRclass_k_Quantile_+3A_sample_u">sample_u</code></td>
<td>
<p>Sample from a distribution proportional to the upper bound
of the class, often from the posterior of the upper bound
of the prior in Bayesian inference.
Columns represent variables, rows go across the sample.</p>
</td></tr>
<tr><td><code id="DRclass_k_Quantile_+3A_k">k</code></td>
<td>
<p>Factor of proportionality between upper (u) and lower (l)
bound: u = k * l</p>
</td></tr>
<tr><td><code id="DRclass_k_Quantile_+3A_probs">probs</code></td>
<td>
<p>Vector of probabilities for which the quantile bounds
are to be provided.</p>
</td></tr>
<tr><td><code id="DRclass_k_Quantile_+3A_tol">tol</code></td>
<td>
<p>Tolerance in quantile value for approximating the solution
of the implicit equation for quantiles with the bisection
algorithm.</p>
</td></tr>
<tr><td><code id="DRclass_k_Quantile_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations for approximating the solution
of the implicit equation for quantiles with the bisection
algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is more efficient than 'DRclass_lu_Pdf' as it does not
need the evaluation of the bounding functions, l and u. 
It is thus recommended to use this function if l and u are proportional.
</p>


<h3>Value</h3>

<p>Matrix of quantile bounds and quantiles (rows) for different
marginal variables (columns).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example of the application of DRclass functions:
# ------------------------------------------------

# parameter values
k        &lt;- 10
sd       &lt;- 0.5
sampsize &lt;- 10000

# upper and lower class boundaries:
u &lt;- function(x) { return(    dnorm(x,0,sd)) }
l &lt;- function(x) { return(1/k*dnorm(x,0,sd)) }

# generate sample:
sample_u &lt;- cbind(rnorm(sampsize,0,sd),rnorm(sampsize,0,sd))  # example of 2d sample

# get class boundaries (back from sample):
pdf1   &lt;- DRclass_k_Pdf(sample_u,k=k,adjust=2)       # faster for l proportional to u
pdf2   &lt;- DRclass_lu_Pdf(sample_u,l=l,u=u,adjust=2)  # l and u could have different shapes

# get cdf bounds:
cdf1   &lt;- DRclass_k_Cdf(sample_u,k=k)
cdf2   &lt;- DRclass_lu_Cdf(sample_u,l=l,u=u)

# get quantile bounds:
quant1 &lt;- DRclass_k_Quantile(sample_u,k=k,probs=c(0.025,0.5,0.975))
quant2 &lt;- DRclass_lu_Quantile(sample_u,l=l,u=u,probs=c(0.025,0.5,0.975))

# plot selected features of the first component of the sample:
oldpar &lt;- par(no.readonly=TRUE)
par(mar=c(5, 4, 1, 4) + 0.1)  # c(bottom, left, top, right)
plot(pdf1[1,,c("x","u")],type="l",xaxs="i",yaxs="i",xlim=c(-2,2),xlab="x",ylab="pdf")
lines(pdf2[1,,c("x","l")])
par(new=TRUE)
plot(cdf1[1,,c("x","F_upper")],type="l",xaxs="i",yaxs="i",axes=FALSE,
     xlim=c(-2,2),ylim=c(0,1),ylab="",lty="dashed")
axis(4); mtext("cdf",4,2)
lines(cdf2[1,,c("x","F_lower")],lty="dashed")
abline(v=quant1["quant_lower_0.5",1],lty="dotted")
abline(v=quant1["quant_upper_0.5",1],lty="dotted")
abline(v=quant1["quant_lower_0.025",1],lty="dotdash")
abline(v=quant1["quant_upper_0.975",1],lty="dotdash")
par(oldpar)
</code></pre>

<hr>
<h2 id='DRclass_lu_Cdf'>Calculate lower and upper bounds of the cumulative density function for the
marginals of a general Density Ratio Class.
The cumulative density functions for the marginals of a distributions
proportional to the lower and upper bounding functions are also provided.
See the function 'DRclass_k_Cdf' for the case in which the upper and lower
bounding functions of the class are proportional.</h2><span id='topic+DRclass_lu_Cdf'></span>

<h3>Description</h3>

<p>Calculate lower and upper bounds of the cumulative density function for the
marginals of a general Density Ratio Class.
The cumulative density functions for the marginals of a distributions
proportional to the lower and upper bounding functions are also provided.
See the function 'DRclass_k_Cdf' for the case in which the upper and lower
bounding functions of the class are proportional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DRclass_lu_Cdf(sample_u, l, u, nout = 512)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DRclass_lu_Cdf_+3A_sample_u">sample_u</code></td>
<td>
<p>Sample from a distribution proportional to the upper bound
of the class, often from the posterior of the upper bound
of the prior in Bayesian inference.
Columns represent variables, rows go across the sample.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Cdf_+3A_l">l</code></td>
<td>
<p>Either a function to evaluate the lower bound of the Density
Ratio Class or a vector of values of this function evaluated
for the rows of 'sample_u'.
Note that in the context of Bayesian inference the upper
bound of the prior can be provided as only the ratio of
l/u is needed and the likelihood cancels in this fraction.
This saves computation time as the prior is usually
computationally much cheaper to evaluate than the likelihood.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Cdf_+3A_u">u</code></td>
<td>
<p>Either a function to evaluate the upper bound of the Density
Ratio Class or a vector of values of this function evaluated
for the rows of 'sample_u'.
Note that in the context of Bayesian inference the lower
bound of the prior can be provided as only the ratio of
l/u is needed and the likelihood cancels in this fraction.
This saves computation time as the prior is usually
computationally much cheaper to evaluate than the likelihood.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Cdf_+3A_nout">nout</code></td>
<td>
<p>Number of equally spaced output intervals for the marginal
densities.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Three dimensional array with the following dimensions:
1: variable corresponding to column of the sample
2: equidistant spacing of that variable
3: five columns for
variable values,
lower bound of the cdf of the marginal of the class,
cdf of the marginal corresponding to the lower class boundary,
cdf of the marginal corresponding to the upper class boundary,
upper bound of the cdf of the marginal of the class
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example of the application of DRclass functions:
# ------------------------------------------------

# parameter values
k        &lt;- 10
sd       &lt;- 0.5
sampsize &lt;- 10000

# upper and lower class boundaries:
u &lt;- function(x) { return(    dnorm(x,0,sd)) }
l &lt;- function(x) { return(1/k*dnorm(x,0,sd)) }

# generate sample:
sample_u &lt;- cbind(rnorm(sampsize,0,sd),rnorm(sampsize,0,sd))  # example of 2d sample

# get class boundaries (back from sample):
pdf1   &lt;- DRclass_k_Pdf(sample_u,k=k,adjust=2)       # faster for l proportional to u
pdf2   &lt;- DRclass_lu_Pdf(sample_u,l=l,u=u,adjust=2)  # l and u could have different shapes

# get cdf bounds:
cdf1   &lt;- DRclass_k_Cdf(sample_u,k=k)
cdf2   &lt;- DRclass_lu_Cdf(sample_u,l=l,u=u)

# get quantile bounds:
quant1 &lt;- DRclass_k_Quantile(sample_u,k=k,probs=c(0.025,0.5,0.975))
quant2 &lt;- DRclass_lu_Quantile(sample_u,l=l,u=u,probs=c(0.025,0.5,0.975))

# plot selected features of the first component of the sample:
oldpar &lt;- par(no.readonly=TRUE)
par(mar=c(5, 4, 1, 4) + 0.1)  # c(bottom, left, top, right)
plot(pdf1[1,,c("x","u")],type="l",xaxs="i",yaxs="i",xlim=c(-2,2),xlab="x",ylab="pdf")
lines(pdf2[1,,c("x","l")])
par(new=TRUE)
plot(cdf1[1,,c("x","F_upper")],type="l",xaxs="i",yaxs="i",axes=FALSE,
     xlim=c(-2,2),ylim=c(0,1),ylab="",lty="dashed")
axis(4); mtext("cdf",4,2)
lines(cdf2[1,,c("x","F_lower")],lty="dashed")
abline(v=quant1["quant_lower_0.5",1],lty="dotted")
abline(v=quant1["quant_upper_0.5",1],lty="dotted")
abline(v=quant1["quant_lower_0.025",1],lty="dotdash")
abline(v=quant1["quant_upper_0.975",1],lty="dotdash")
par(oldpar)
</code></pre>

<hr>
<h2 id='DRclass_lu_Pdf'>Calculate marginal class bounding functions for the general case of a
Density Ratio Class.</h2><span id='topic+DRclass_lu_Pdf'></span>

<h3>Description</h3>

<p>See the function 'DRclass_k_Pdf' for the case in which the upper and lower
bounding functions of the class are proportional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DRclass_lu_Pdf(sample_u, l, u, nout = 512, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DRclass_lu_Pdf_+3A_sample_u">sample_u</code></td>
<td>
<p>Sample from a distribution proportional to the upper bound
of the class, often from the posterior of the upper bound
of the prior in Bayesian inference.
Columns represent variables, rows go across the sample.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Pdf_+3A_l">l</code></td>
<td>
<p>Either a function to evaluate the lower bound of the Density
Ratio Class or a vector of values of this function evaluated
for the rows of 'sample_u'.
Note that in the context of Bayesian inference the upper
bound of the prior can be provided as only the ratio of
l/u is needed and the likelihood cancels in this fraction.
This saves computation time as the prior is usually
computationally much cheaper to evaluate than the likelihood.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Pdf_+3A_u">u</code></td>
<td>
<p>Either a function to evaluate the upper bound of the Density
Ratio Class or a vector of values of this function evaluated
for the rows of 'sample_u'.
Note that in the context of Bayesian inference the lower
bound of the prior can be provided as only the ratio of
l/u is needed and the likelihood cancels in this fraction.
This saves computation time as the prior is usually
computationally much cheaper to evaluate than the likelihood.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Pdf_+3A_nout">nout</code></td>
<td>
<p>Number of equally spaced output intervals for the marginal
densities.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Pdf_+3A_...">...</code></td>
<td>
<p>Further arguments passed to the function 'density'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Three dimensional array with the following dimensions:
1: variable corresponding to column of the sample
2: equidistant spacing of that variable
3: three columns for
variable values,
upper normalized density of the marginal class,
lower non-normalized density of the marginal class
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example of the application of DRclass functions:
# ------------------------------------------------

# parameter values
k        &lt;- 10
sd       &lt;- 0.5
sampsize &lt;- 10000

# upper and lower class boundaries:
u &lt;- function(x) { return(    dnorm(x,0,sd)) }
l &lt;- function(x) { return(1/k*dnorm(x,0,sd)) }

# generate sample:
sample_u &lt;- cbind(rnorm(sampsize,0,sd),rnorm(sampsize,0,sd))  # example of 2d sample

# get class boundaries (back from sample):
pdf1   &lt;- DRclass_k_Pdf(sample_u,k=k,adjust=2)       # faster for l proportional to u
pdf2   &lt;- DRclass_lu_Pdf(sample_u,l=l,u=u,adjust=2)  # l and u could have different shapes

# get cdf bounds:
cdf1   &lt;- DRclass_k_Cdf(sample_u,k=k)
cdf2   &lt;- DRclass_lu_Cdf(sample_u,l=l,u=u)

# get quantile bounds:
quant1 &lt;- DRclass_k_Quantile(sample_u,k=k,probs=c(0.025,0.5,0.975))
quant2 &lt;- DRclass_lu_Quantile(sample_u,l=l,u=u,probs=c(0.025,0.5,0.975))

# plot selected features of the first component of the sample:
oldpar &lt;- par(no.readonly=TRUE)
par(mar=c(5, 4, 1, 4) + 0.1)  # c(bottom, left, top, right)
plot(pdf1[1,,c("x","u")],type="l",xaxs="i",yaxs="i",xlim=c(-2,2),xlab="x",ylab="pdf")
lines(pdf2[1,,c("x","l")])
par(new=TRUE)
plot(cdf1[1,,c("x","F_upper")],type="l",xaxs="i",yaxs="i",axes=FALSE,
     xlim=c(-2,2),ylim=c(0,1),ylab="",lty="dashed")
axis(4); mtext("cdf",4,2)
lines(cdf2[1,,c("x","F_lower")],lty="dashed")
abline(v=quant1["quant_lower_0.5",1],lty="dotted")
abline(v=quant1["quant_upper_0.5",1],lty="dotted")
abline(v=quant1["quant_lower_0.025",1],lty="dotdash")
abline(v=quant1["quant_upper_0.975",1],lty="dotdash")
par(oldpar)
</code></pre>

<hr>
<h2 id='DRclass_lu_Quantile'>Calculate lower and upper bounds of quantiles of marginals of a Density
Ratio Class.
Quantiles of the marginals of distributions proportional to the lower and
upper bounding functions are also provided.
See the function 'DRclass_k_Quantile' for the case in which the upper and
lower bounding functions of the class are proportional.</h2><span id='topic+DRclass_lu_Quantile'></span>

<h3>Description</h3>

<p>Calculate lower and upper bounds of quantiles of marginals of a Density
Ratio Class.
Quantiles of the marginals of distributions proportional to the lower and
upper bounding functions are also provided.
See the function 'DRclass_k_Quantile' for the case in which the upper and
lower bounding functions of the class are proportional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DRclass_lu_Quantile(
  sample_u,
  l,
  u,
  probs = c(0.025, 0.25, 0.5, 0.75, 0.975),
  tol = 0.001,
  maxiter = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DRclass_lu_Quantile_+3A_sample_u">sample_u</code></td>
<td>
<p>Sample from a distribution proportional to the upper bound
of the class, often from the posterior of the upper bound
of the prior in Bayesian inference.
Columns represent variables, rows go across the sample.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Quantile_+3A_l">l</code></td>
<td>
<p>Either a function to evaluate the lower bound of the Density
Ratio Class or a vector of values of this function evaluated
for the rows of 'sample_u'.
Note that in the context of Bayesian inference the upper
bound of the prior can be provided as only the ratio of
l/u is needed and the likelihood cancels in this fraction.
This saves computation time as the prior is usually
computationally much cheaper to evaluate than the likelihood.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Quantile_+3A_u">u</code></td>
<td>
<p>Either a function to evaluate the upper bound of the Density
Ratio Class or a vector of values of this function evaluated
for the rows of 'sample_u'.
Note that in the context of Bayesian inference the lower
bound of the prior can be provided as only the ratio of
l/u is needed and the likelihood cancels in this fraction.
This saves computation time as the prior is usually
computationally much cheaper to evaluate than the likelihood.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Quantile_+3A_probs">probs</code></td>
<td>
<p>Vector of probabilities for which the quantile bounds
are to be provided.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Quantile_+3A_tol">tol</code></td>
<td>
<p>Tolerance in quantile value for approximating the solution
of the implicit equation for quantiles with the bisection
algorithm.</p>
</td></tr>
<tr><td><code id="DRclass_lu_Quantile_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations for approximating the solution
of the implicit equation for quantiles with the bisection
algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of quantile bounds and quantiles (rows) for different
marginal variables (columns).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example of the application of DRclass functions:
# ------------------------------------------------

# parameter values
k        &lt;- 10
sd       &lt;- 0.5
sampsize &lt;- 10000

# upper and lower class boundaries:
u &lt;- function(x) { return(    dnorm(x,0,sd)) }
l &lt;- function(x) { return(1/k*dnorm(x,0,sd)) }

# generate sample:
sample_u &lt;- cbind(rnorm(sampsize,0,sd),rnorm(sampsize,0,sd))  # example of 2d sample

# get class boundaries (back from sample):
pdf1   &lt;- DRclass_k_Pdf(sample_u,k=k,adjust=2)       # faster for l proportional to u
pdf2   &lt;- DRclass_lu_Pdf(sample_u,l=l,u=u,adjust=2)  # l and u could have different shapes

# get cdf bounds:
cdf1   &lt;- DRclass_k_Cdf(sample_u,k=k)
cdf2   &lt;- DRclass_lu_Cdf(sample_u,l=l,u=u)

# get quantile bounds:
quant1 &lt;- DRclass_k_Quantile(sample_u,k=k,probs=c(0.025,0.5,0.975))
quant2 &lt;- DRclass_lu_Quantile(sample_u,l=l,u=u,probs=c(0.025,0.5,0.975))

# plot selected features of the first component of the sample:
oldpar &lt;- par(no.readonly=TRUE)
par(mar=c(5, 4, 1, 4) + 0.1)  # c(bottom, left, top, right)
plot(pdf1[1,,c("x","u")],type="l",xaxs="i",yaxs="i",xlim=c(-2,2),xlab="x",ylab="pdf")
lines(pdf2[1,,c("x","l")])
par(new=TRUE)
plot(cdf1[1,,c("x","F_upper")],type="l",xaxs="i",yaxs="i",axes=FALSE,
     xlim=c(-2,2),ylim=c(0,1),ylab="",lty="dashed")
axis(4); mtext("cdf",4,2)
lines(cdf2[1,,c("x","F_lower")],lty="dashed")
abline(v=quant1["quant_lower_0.5",1],lty="dotted")
abline(v=quant1["quant_upper_0.5",1],lty="dotted")
abline(v=quant1["quant_lower_0.025",1],lty="dotdash")
abline(v=quant1["quant_upper_0.975",1],lty="dotdash")
par(oldpar)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
