<!DOCTYPE html><html><head><title>Help for package MatrixCorrelation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MatrixCorrelation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allCorrelations'><p>All correlations</p></a></li>
<li><a href='#candy'><p>Candy data</p></a></li>
<li><a href='#cor.test_eq'><p>Test for no correlation between paired sampes</p></a></li>
<li><a href='#Coxhead'><p>Coxhead's coefficient</p></a></li>
<li><a href='#MatrixCorrelation'><p>Similiarity of Matrices Coefficients</p></a></li>
<li><a href='#PCAcv'><p>Principal Component Analysis cross-validation error</p></a></li>
<li><a href='#PCAimpute'><p>Principal Component Analysis based imputation</p></a></li>
<li><a href='#plot.SMI'><p>Result functions for the Similarity of Matrices Index (SMI)</p></a></li>
<li><a href='#PSI'><p>Procrustes Similarity Index</p></a></li>
<li><a href='#r1'><p>Correlational Measures for Matrices</p></a></li>
<li><a href='#Rozeboom'><p>Rozeboom's squared vector correlation</p></a></li>
<li><a href='#RV'><p>RV coefficients</p></a></li>
<li><a href='#significant'><p>Significance estimation for Similarity of Matrices Index (SMI)</p></a></li>
<li><a href='#SMI'><p>Similarity of Matrices Index (SMI)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Matrix Correlation Coefficients</td>
</tr>
<tr>
<td>Version:</td>
<td>0.10.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Kristian Hovde Liland</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kristian Hovde Liland &lt;kristian.liland@nmbu.no&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computation and visualization of matrix correlation coefficients.
    The main method is the Similarity of Matrices Index, while various related
    measures like r1, r2, r3, r4, Yanai's GCD, RV, RV2, adjusted RV, Rozeboom's
    linear correlation and Coxhead's coefficient are included
    for comparison and flexibility.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/khliland/MatrixCorrelation/">https://github.com/khliland/MatrixCorrelation/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/khliland/MatrixCorrelation/issues/">https://github.com/khliland/MatrixCorrelation/issues/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, plotrix, pracma, progress, RSpectra</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>progress, Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-18 18:50:46 UTC; kristian</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-18 19:24:29 UTC</td>
</tr>
</table>
<hr>
<h2 id='allCorrelations'>All correlations</h2><span id='topic+allCorrelations'></span>

<h3>Description</h3>

<p>Compare all correlation measures in the package (or a subset)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allCorrelations(
  X1,
  X2,
  ncomp1,
  ncomp2,
  methods = c("SMI", "RV", "RV2", "RVadj", "PSI", "r1", "r2", "r3", "r4", "GCD"),
  digits = 3,
  plot = TRUE,
  xlab = "",
  ylab = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allCorrelations_+3A_x1">X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_x2">X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_ncomp1">ncomp1</code></td>
<td>
<p>maximum number of subspace components from the first <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_ncomp2">ncomp2</code></td>
<td>
<p>maximum number of subspace components from the second <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_methods">methods</code></td>
<td>
<p><code>character</code> vector containing a subset of the supported methods: &quot;SMI&quot;, &quot;RV&quot;, &quot;RV2&quot;, &quot;RVadj&quot;, &quot;PSI&quot;, &quot;r1&quot;, &quot;r2&quot;, &quot;r3&quot;, &quot;r4&quot;, &quot;GCD&quot;.</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_digits">digits</code></td>
<td>
<p>number of digits for numerical output.</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_plot">plot</code></td>
<td>
<p>logical indicating if plotting should be performed (default = TRUE).</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_xlab">xlab</code></td>
<td>
<p>optional x axis label.</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_ylab">ylab</code></td>
<td>
<p>optional y axis label.</p>
</td></tr>
<tr><td><code id="allCorrelations_+3A_...">...</code></td>
<td>
<p>additional arguments for <code>SMI</code> or <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each of the coefficients a single scalar is computed to describe
the similarity between the two input matrices. Note that some methods requires setting
one or two numbers of components.
</p>


<h3>Value</h3>

<p>A single value measuring the similarity of two matrices.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>


<ul>
<li><p>SMI: Indahl, U.G.; Næs, T.; Liland, K.H.; 2018. A similarity index for comparing coupled matrices. Journal of Chemometrics; e3049.
</p>
</li>
<li><p>RV: Robert, P.; Escoufier, Y. (1976). &quot;A Unifying Tool for Linear Multivariate
Statistical Methods: The RV-Coefficient&quot;. Applied Statistics 25 (3): 257-265.
</p>
</li>
<li><p>RV2: Smilde, AK; Kiers, HA; Bijlsma, S; Rubingh, CM; van Erk, MJ (2009). &quot;Matrix correlations
for high-dimensional data: the modified RV-coefficient&quot;. Bioinformatics 25(3): 401-5.
</p>
</li>
<li><p>Adjusted RV: Mayer, CD; Lorent, J; Horgan, GW. (2011). &quot;Exploratory analysis of multiple omics
datasets using the adjusted RV coefficient&quot;. Stat Appl Genet Mol Biol. 10(14).
</p>
</li>
<li><p>PSI: Sibson, R; 1978. &quot;Studies in the Robustness of Multidimensional Scaling:
Procrustes Statistics&quot;. Journal of the Royal Statistical Society. Series B (Methodological), Vol. 40, No. 2, pp. 234-238.
</p>
</li>
<li><p>Rozeboom: Rozeboom, WW; 1965. &quot;Linear correlations between sets of variables&quot;.
Psychometrika 30(1): 57-71.
</p>
</li>
<li><p>Coxhead: Coxhead, P; 1974. &quot;Measuring the releationship between two sets of variables&quot;. British Journal of
Mathematical and Statistical Psychology 27: 205-212.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+SMI">SMI</a></code>, <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- scale( matrix( rnorm(100*300), 100,300), scale = FALSE)
usv &lt;- svd(X1)
# Remove third principal component from X1 to produce X2
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])

allCorrelations(X1,X2, ncomp1 = 5,ncomp2 = 5)

</code></pre>

<hr>
<h2 id='candy'>Candy data</h2><span id='topic+candy'></span>

<h3>Description</h3>

<p>Measurements from sensory analysis (professional tasting)
on a number of candy products obtained by sensory labs. The two labs
and the associated data sets are parts of a larger study described in Tomic et al. (2010),
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(candy)
</code></pre>


<h3>Format</h3>

<p>Two matrices of dimension 18 x 6.
</p>


<h3>References</h3>

<p>Tomic, O., Luciano, G., Nilsen, A., Hyldig, G., Lorensen, K., Næs, T. (2010). 
Analysing sensory panel performance in a proficiency test using the PanelCheck software. 
European Food Research and Technology. 230. 3, 497-511
</p>

<hr>
<h2 id='cor.test_eq'>Test for no correlation between paired sampes</h2><span id='topic+cor.test_eq'></span>

<h3>Description</h3>

<p>Permutation test for squared Pearson correlation between to vectors of samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.test_eq(x, y, B = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.test_eq_+3A_x">x</code></td>
<td>
<p>first <code>vector</code> to be compared (or two column <code>matrix/data.frame</code>).</p>
</td></tr>
<tr><td><code id="cor.test_eq_+3A_y">y</code></td>
<td>
<p>second <code>vector</code> to be compared (ommit if included in <code>x</code>).</p>
</td></tr>
<tr><td><code id="cor.test_eq_+3A_b">B</code></td>
<td>
<p>integer number of permutations, default = 10000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function combining <code>SMI</code> and <code>significant</code> for the
special case of vector vs vector comparisons. The nullhypothesis is that the correlation
between the vectors is +/-1, while significance signifies a deviance toward 0.
</p>


<h3>Value</h3>

<p>A value indicating if the two input vectors are signficantly different.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>

<p>Similarity of Matrices Index - Ulf Geir Indahl, Tormod Næs, Kristian Hovde Liland
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.SMI">plot.SMI</a></code> (print.SMI/summary.SMI), <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD), 
<code><a href="#topic+allCorrelations">allCorrelations</a></code> (matrix correlation comparison), <code><a href="#topic+PCAcv">PCAcv</a> (cross-validated PCA)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- (1:5) + rnorm(5)
b &lt;- (1:5) + rnorm(5)
cor.test_eq(a,b)

</code></pre>

<hr>
<h2 id='Coxhead'>Coxhead's coefficient</h2><span id='topic+Coxhead'></span>

<h3>Description</h3>

<p>Coxhead's coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Coxhead(X1, X2, weighting = c("sqrt", "min"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Coxhead_+3A_x1">X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="Coxhead_+3A_x2">X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="Coxhead_+3A_weighting">weighting</code></td>
<td>
<p><code>string</code> indicating if weighting should be <code>sqrt(p*q)</code> or <code>min(p,q)</code> (default = 'sqrt').</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single value measuring the similarity of two matrices. For diagnostic purposes it is accompanied by an attribute &quot;canonical.correlation&quot;.
</p>


<h3>References</h3>

<p>Coxhead, P; 1974. &quot;Measuring the releationship between two sets of variables&quot;. British Journal of Mathematical and Statistical Psychology 27: 205-212.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SMI">SMI</a></code>, <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+Rozeboom">Rozeboom</a></code>, <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(100*13),nrow=100)
X1 &lt;- X[, 1:5]  # Random normal
X2 &lt;- X[, 6:12] # Random normal
X2[,1] &lt;- X2[,1] + X[,5] # Overlap in one variable
Coxhead(X1, X2)
</code></pre>

<hr>
<h2 id='MatrixCorrelation'>Similiarity of Matrices Coefficients</h2><span id='topic+MatrixCorrelation'></span><span id='topic+MatrixCorrelation-package'></span>

<h3>Description</h3>

<p>Computation and visualization of matrix correlation coefficients.
The main method is the Similarity of Matrices Index, while various related
measures like r1, r2, r3, r4, Yanai's GCD, RV, RV2, adjusted RV, Rozeboom's
linear correlation and Coxhead's coefficient are included
for comparison and flexibility.
</p>


<h3>References</h3>


<ul>
<li><p>SMI: Indahl, U.G.; Næs, T.; Liland, K.H.; 2018. A similarity index for comparing coupled matrices. Journal of Chemometrics; e3049.
</p>
</li>
<li><p>RV: Robert, P.; Escoufier, Y. (1976). &quot;A Unifying Tool for Linear Multivariate
Statistical Methods: The RV-Coefficient&quot;. Applied Statistics 25 (3): 257-265.
</p>
</li>
<li><p>RV2: Smilde, AK; Kiers, HA; Bijlsma, S; Rubingh, CM; van Erk, MJ (2009). &quot;Matrix correlations
for high-dimensional data: the modified RV-coefficient&quot;. Bioinformatics 25(3): 401-5.
</p>
</li>
<li><p>Adjusted RV: Mayer, CD; Lorent, J; Horgan, GW. (2011). &quot;Exploratory analysis of multiple omics
datasets using the adjusted RV coefficient&quot;. Stat Appl Genet Mol Biol. 10(14).
</p>
</li>
<li><p>PSI: Sibson, R; 1978. &quot;Studies in the Robustness of Multidimensional Scaling: 
Procrustes Statistics&quot;. Journal of the Royal Statistical Society. Series B (Methodological), Vol. 40, No. 2, pp. 234-238.
</p>
</li>
<li><p>Rozeboom: Rozeboom, WW; 1965. &quot;Linear correlations between sets of variables&quot;. 
Psychometrika 30(1): 57-71.
</p>
</li>
<li><p>Coxhead: Coxhead, P; 1974. &quot;Measuring the releationship between two sets of variables&quot;. British Journal of 
Mathematical and Statistical Psychology 27: 205-212.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+SMI">SMI</a></code>, <code><a href="#topic+plot.SMI">plot.SMI</a></code> (print.SMI/summary.SMI), <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD), <code><a href="#topic+Rozeboom">Rozeboom</a></code>, <code><a href="#topic+Coxhead">Coxhead</a></code>, <code><a href="#topic+allCorrelations">allCorrelations</a></code> (matrix correlation comparison).
</p>

<hr>
<h2 id='PCAcv'>Principal Component Analysis cross-validation error</h2><span id='topic+PCAcv'></span>

<h3>Description</h3>

<p>PRESS values for PCA as implemented by Eigenvector and described by Bro et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PCAcv(X, ncomp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PCAcv_+3A_x">X</code></td>
<td>
<p><code>matrix</code> object to perform PCA on.</p>
</td></tr>
<tr><td><code id="PCAcv_+3A_ncomp">ncomp</code></td>
<td>
<p><code>integer</code> number of components.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each number of components predicted residual sum of squares are calculated
based on leave-one-out cross-validation. The implementation ensures no over-fitting or
information bleeding.
</p>


<h3>Value</h3>

<p>A vector of PRESS-values.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>

<p>R. Bro, K. Kjeldahl, A.K. Smilde, H.A.L. Kiers, Cross-validation of component models: A critical look at current methods. Anal Bioanal Chem (2008) 390: 1241-1251.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.SMI">plot.SMI</a></code> (print.SMI/summary.SMI), <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD), <code><a href="#topic+allCorrelations">allCorrelations</a></code> (matrix correlation comparison).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- scale( matrix( rnorm(100*300), 100,300), scale = FALSE)
PCAcv(X1,10)

</code></pre>

<hr>
<h2 id='PCAimpute'>Principal Component Analysis based imputation</h2><span id='topic+PCAimpute'></span>

<h3>Description</h3>

<p>Imputation of missing data, NA, using Principal Component Analysis with
iterative refitting and mean value updates. The chosen number of components
and convergence parameters (iterations and tolerance) influence the
precision of the imputation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PCAimpute(X, ncomp, center = TRUE, max_iter = 20, tol = 10^-5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PCAimpute_+3A_x">X</code></td>
<td>
<p><code>matrix</code> object to perform PCA on.</p>
</td></tr>
<tr><td><code id="PCAimpute_+3A_ncomp">ncomp</code></td>
<td>
<p><code>integer</code> number of components.</p>
</td></tr>
<tr><td><code id="PCAimpute_+3A_center">center</code></td>
<td>
<p><code>logical</code> indicating if centering (default) should be performed.</p>
</td></tr>
<tr><td><code id="PCAimpute_+3A_max_iter">max_iter</code></td>
<td>
<p><code>integer</code> number of iterations of PCA if sum of squared
change in imputed values is above <code>tol</code>.</p>
</td></tr>
<tr><td><code id="PCAimpute_+3A_tol">tol</code></td>
<td>
<p><code>numeric</code> tolerance for sum of squared cange in imputed values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Final singular value decomposition, imputed <code>X</code> matrix and
convergence metrics (sequence of sum of squared change and number of iterations).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(12),3,4)
X[c(2,6,10)] &lt;- NA
PCAimpute(X, 3)
</code></pre>

<hr>
<h2 id='plot.SMI'>Result functions for the Similarity of Matrices Index (SMI)</h2><span id='topic+plot.SMI'></span><span id='topic+print.SMI'></span><span id='topic+summary.SMI'></span><span id='topic+is.signif'></span>

<h3>Description</h3>

<p>Plotting, printing and summary functions for SMI, plus significance testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMI'
plot(
  x,
  y = NULL,
  x1lab = attr(x, "mat.names")[[1]],
  x2lab = attr(x, "mat.names")[[2]],
  main = "SMI",
  signif = 0.05,
  xlim = c(-(pq[1] + 1)/2, (pq[2] + 1)/2),
  ylim = c(0.5, (sum(pq) + 3)/2),
  B = 10000,
  cex = 1,
  cex.sym = 1,
  frame = NULL,
  frame.col = "red",
  frame.lwd = 2,
  replicates = NULL,
  ...
)

## S3 method for class 'SMI'
print(x, ...)

## S3 method for class 'SMI'
summary(object, ...)

is.signif(x, signif = 0.05, B = 10000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SMI_+3A_x">x</code></td>
<td>
<p>object of class <code>SMI</code>.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_y">y</code></td>
<td>
<p>not used.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_x1lab">x1lab</code></td>
<td>
<p>optional label for first matrix.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_x2lab">x2lab</code></td>
<td>
<p>optional label for second matrix.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_main">main</code></td>
<td>
<p>optional heading (default = SMI).</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_signif">signif</code></td>
<td>
<p>significance level for testing (default=0.05).</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_xlim">xlim</code></td>
<td>
<p>optional plotting limits.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_ylim">ylim</code></td>
<td>
<p>optional plotting limits.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_b">B</code></td>
<td>
<p>number of permutations (for significant, default=10000).</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_cex">cex</code></td>
<td>
<p>optional text scaling (default = 1)</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_cex.sym">cex.sym</code></td>
<td>
<p>optional scaling for significance symbols (default = 1)</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_frame">frame</code></td>
<td>
<p>two element integer vector indicating framed components.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_frame.col">frame.col</code></td>
<td>
<p>color for framed components.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_frame.lwd">frame.lwd</code></td>
<td>
<p>line width for framed components.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_replicates">replicates</code></td>
<td>
<p>vector of replicates for significance testing.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_...">...</code></td>
<td>
<p>additional arguments for <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.SMI_+3A_object">object</code></td>
<td>
<p>object of class <code>SMI</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For plotting a diamonad plot is used. High SMI values are light and low SMI values
are dark. If orthogonal projections have been used for calculating SMIs, significance symbols
are included in the plot unless signif=NULL.
</p>


<h3>Value</h3>

<p><code>plot</code> silently returns NULL. <code>print</code> and <code>summary</code> return the printed matrix.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>

<p>Similarity of Matrices Index - Ulf G. Indahl, Tormod Næs, Kristian Hovde Liland
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SMI">SMI</a></code>, <code><a href="#topic+PCAcv">PCAcv</a> (cross-validated PCA)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- scale( matrix( rnorm(100*300), 100,300), scale = FALSE)
usv &lt;- svd(X1)
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])

smi &lt;- SMI(X1,X2,5,5)
plot(smi, B = 1000) # default B = 10000
print(smi)
summary(smi)
is.signif(smi, B = 1000) # default B = 10000

</code></pre>

<hr>
<h2 id='PSI'>Procrustes Similarity Index</h2><span id='topic+PSI'></span>

<h3>Description</h3>

<p>An index based on the RV coefficient with Procrustes rotation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSI(X1, X2, center = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PSI_+3A_x1">X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="PSI_+3A_x2">X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="PSI_+3A_center">center</code></td>
<td>
<p><code>logical</code> indicating if input matrices should be centered (default = TRUE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Procrustes Similarity Index
</p>


<h3>References</h3>

<p>Sibson, R; 1978. &quot;Studies in the Robustness of Multidimensional Scaling: Procrustes Statistics&quot;. Journal of the Royal Statistical Society. Series B (Methodological), Vol. 40, No. 2, pp. 234-238.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- scale( matrix( rnorm(100*300), 100,300), scale = FALSE)
usv &lt;- svd(X1)
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])
PSI(X1,X2)

</code></pre>

<hr>
<h2 id='r1'>Correlational Measures for Matrices</h2><span id='topic+r1'></span><span id='topic+r2'></span><span id='topic+r3'></span><span id='topic+r4'></span><span id='topic+GCD'></span>

<h3>Description</h3>

<p>Matrix similarity as described by Ramsey et al. (1984).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r1(X1, X2, center = TRUE, impute = FALSE)

r2(
  X1,
  X2,
  center = TRUE,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)

r3(
  X1,
  X2,
  center = TRUE,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)

r4(
  X1,
  X2,
  center = TRUE,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)

GCD(
  X1,
  X2,
  ncomp1 = min(dim(X1)),
  ncomp2 = min(dim(X2)),
  center = TRUE,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r1_+3A_x1">X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="r1_+3A_x2">X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="r1_+3A_center">center</code></td>
<td>
<p><code>logical</code> indicating if input matrices should be centered (default = TRUE).</p>
</td></tr>
<tr><td><code id="r1_+3A_impute">impute</code></td>
<td>
<p><code>logical</code> indicating if missing values are expected in <code>X1</code> or <code>X2</code>.</p>
</td></tr>
<tr><td><code id="r1_+3A_impute_par">impute_par</code></td>
<td>
<p>named <code>list</code> of imputation parameters in case of NAs in X1/X2.</p>
</td></tr>
<tr><td><code id="r1_+3A_ncomp1">ncomp1</code></td>
<td>
<p>(GCD) number of subspace components from the first <code>matrix</code> (default: full subspace).</p>
</td></tr>
<tr><td><code id="r1_+3A_ncomp2">ncomp2</code></td>
<td>
<p>(GCD) number of subspace components from the second <code>matrix</code> (default: full subspace).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details can be found in Ramsey's paper:
</p>

<ul>
<li><p>r1: inner product correlation
</p>
</li>
<li><p>r2: orientation-independent inner product correlation
</p>
</li>
<li><p>r3: spectra-independent inner product correlations (including orientation)
</p>
</li>
<li><p>r4: Spectra-Independent inner product Correlations
</p>
</li>
<li><p>GCD: Yanai's Generalized Coefficient of Determination (GCD) Measure. To reproduce the original GCD, use all components. When <code>X1</code> and <code>X2</code> are dummy variables, GCD is proportional with Pillai's criterion: tr(W^-1(B+W)).
</p>
</li></ul>



<h3>Value</h3>

<p>A single value measuring the similarity of two matrices.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>

<p>Ramsay, JO; Berg, JT; Styan, GPH; 1984. &quot;Matrix Correlation&quot;. Psychometrica 49(3): 403-423.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SMI">SMI</a></code>, <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+Rozeboom">Rozeboom</a></code>, <code><a href="#topic+Coxhead">Coxhead</a></code>,
<code><a href="#topic+allCorrelations">allCorrelations</a></code> (matrix correlation comparison), <code><a href="#topic+PCAcv">PCAcv</a> (cross-validated PCA)</code>, <code><a href="#topic+PCAimpute">PCAimpute</a> (PCA based imputation)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- matrix(rnorm(100*300),100,300)
usv &lt;- svd(X1)
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])

r1(X1,X2)
r2(X1,X2)
r3(X1,X2)
r4(X1,X2)
GCD(X1,X2)
GCD(X1,X2, 5,5)

# Missing data
X1[c(1, 50, 400, 900)] &lt;- NA
X2[c(10, 200, 450, 1200)] &lt;- NA
r1(X1,X2, impute = TRUE)
r2(X1,X2, impute = TRUE)
r3(X1,X2, impute = TRUE)
r4(X1,X2, impute = TRUE)
GCD(X1,X2, impute = TRUE)
GCD(X1,X2, 5,5, impute = TRUE)


</code></pre>

<hr>
<h2 id='Rozeboom'>Rozeboom's squared vector correlation</h2><span id='topic+Rozeboom'></span><span id='topic+sqveccor'></span>

<h3>Description</h3>

<p>Rozeboom's squared vector correlation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rozeboom(X1, X2)

sqveccor(X1, X2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rozeboom_+3A_x1">X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="Rozeboom_+3A_x2">X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single value measuring the similarity of two matrices. For diagnostic purposes it is accompanied by an attribute &quot;canonical.correlation&quot;.
</p>


<h3>Author(s)</h3>

<p>Korbinian Strimmer and Kristian Hovde Liland
</p>


<h3>References</h3>

<p>Rozeboom, WW; 1965. &quot;Linear correlations between sets of variables&quot;. Psychometrika 30(1): 57-71.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SMI">SMI</a></code>, <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+Coxhead">Coxhead</a></code>, <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(100*13),nrow=100)
X1 &lt;- X[, 1:5]  # Random normal
X2 &lt;- X[, 6:12] # Random normal
X2[,1] &lt;- X2[,1] + X[,5] # Overlap in one variable
Rozeboom(X1, X2)

</code></pre>

<hr>
<h2 id='RV'>RV coefficients</h2><span id='topic+RV'></span><span id='topic+RV2'></span><span id='topic+RVadj'></span><span id='topic+RVadjMaye'></span><span id='topic+RVadjGhaziri'></span>

<h3>Description</h3>

<p>Three different RV coefficients: RV, RV2 and adusted RV.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RV(X1, X2, center = TRUE, impute = FALSE)

RV2(X1, X2, center = TRUE, impute = FALSE)

RVadjMaye(X1, X2, center = TRUE)

RVadjGhaziri(X1, X2, center = TRUE)

RVadj(X1, X2, version = c("Maye", "Ghaziri"), center = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RV_+3A_x1">X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="RV_+3A_x2">X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="RV_+3A_center">center</code></td>
<td>
<p><code>logical</code> indicating if input matrices should be centered (default = TRUE).</p>
</td></tr>
<tr><td><code id="RV_+3A_impute">impute</code></td>
<td>
<p><code>logical</code> indicating if missing values are expected in <code>X1</code> or <code>X2</code> (only for RV and RV2).</p>
</td></tr>
<tr><td><code id="RV_+3A_version">version</code></td>
<td>
<p>Which version of RV adjusted to apply: &quot;Maye&quot; (default) or &quot;Ghaziri&quot;
RV adjusted is run using the <code>RVadj</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each of the four coefficients a single scalar is computed to describe
the similarity between the two input matrices.
</p>


<h3>Value</h3>

<p>A single value measuring the similarity of two matrices.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland, Benjamin Leutner (RV2)
</p>


<h3>References</h3>


<ul>
<li><p>RV: Robert, P.; Escoufier, Y. (1976). &quot;A Unifying Tool for Linear Multivariate
Statistical Methods: The RV-Coefficient&quot;. Applied Statistics 25 (3): 257-265.
</p>
</li>
<li><p>RV2: Smilde, AK; Kiers, HA; Bijlsma, S; Rubingh, CM; van Erk, MJ (2009). &quot;Matrix correlations
for high-dimensional data: the modified RV-coefficient&quot;. Bioinformatics 25(3): 401-5.
</p>
</li>
<li><p>Adjusted RV: Maye, CD; Lorent, J; Horgan, GW. (2011). &quot;Exploratory analysis of multiple omics
datasets using the adjusted RV coefficient&quot;. Stat Appl Genet Mol Biol. 10(14).
</p>
</li>
<li><p>Adjusted RV: El Ghaziri, A; Qannari, E.M. (2015) &quot;Measures of association between
two datasets; Application to sensory data&quot;, Food Quality and Preference 40 (A): 116-124.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+SMI">SMI</a></code>, <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD), <code><a href="#topic+Rozeboom">Rozeboom</a></code>, <code><a href="#topic+Coxhead">Coxhead</a></code>,
<code><a href="#topic+allCorrelations">allCorrelations</a></code> (matrix correlation comparison), <code><a href="#topic+PCAcv">PCAcv</a> (cross-validated PCA)</code>, <code><a href="#topic+PCAimpute">PCAimpute</a> (PCA based imputation)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- matrix(rnorm(100*300),100,300)
usv &lt;- svd(X1)
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])

RV(X1,X2)
RV2(X1,X2)
RVadj(X1,X2)

# Missing data
X1[c(1, 50, 400, 900)] &lt;- NA
X2[c(10, 200, 450, 1200)] &lt;- NA
RV(X1,X2, impute = TRUE)
RV2(X1,X2, impute = TRUE)

</code></pre>

<hr>
<h2 id='significant'>Significance estimation for Similarity of Matrices Index (SMI)</h2><span id='topic+significant'></span>

<h3>Description</h3>

<p>Permutation based hypothesis testing for SMI. The nullhypothesis is that a linear function
of one matrix subspace is included in the subspace of another matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>significant(smi, B = 10000, replicates = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="significant_+3A_smi">smi</code></td>
<td>
<p><code>smi</code> object returned by call to <code>SMI</code>.</p>
</td></tr>
<tr><td><code id="significant_+3A_b">B</code></td>
<td>
<p>integer number of permutations, default = 10000.</p>
</td></tr>
<tr><td><code id="significant_+3A_replicates">replicates</code></td>
<td>
<p>integer vector of replicates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each combination of components significance is estimated by sampling from a null distribution
of no similarity, i.e. when the rows of one matrix is permuted B times and corresponding SMI values are
computed. If the vector <code>replicates</code> is included, replicates will be kept together through
permutations.
</p>


<h3>Value</h3>

<p>A matrix containing P-values for all combinations of components.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>

<p>Similarity of Matrices Index - Ulf G. Indahl, Tormod Næs Kristian Hovde Liland
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.SMI">plot.SMI</a></code> (print.SMI/summary.SMI), <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD), <code><a href="#topic+allCorrelations">allCorrelations</a></code> (matrix correlation comparison).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- scale( matrix( rnorm(100*300), 100,300), scale = FALSE)
usv &lt;- svd(X1)
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])

(smi &lt;- SMI(X1,X2,5,5))
significant(smi, B = 1000) # default B = 10000

</code></pre>

<hr>
<h2 id='SMI'>Similarity of Matrices Index (SMI)</h2><span id='topic+SMI'></span>

<h3>Description</h3>

<p>A similarity index for comparing coupled data matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMI(
  X1,
  X2,
  ncomp1 = Rank(X1) - 1,
  ncomp2 = Rank(X2) - 1,
  projection = "Orthogonal",
  Scores1 = NULL,
  Scores2 = NULL,
  impute = FALSE,
  impute_par = list(max_iter = 20, tol = 10^-5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMI_+3A_x1">X1</code></td>
<td>
<p>first <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="SMI_+3A_x2">X2</code></td>
<td>
<p>second <code>matrix</code> to be compared (<code>data.frames</code> are also accepted).</p>
</td></tr>
<tr><td><code id="SMI_+3A_ncomp1">ncomp1</code></td>
<td>
<p>maximum number of subspace components from the first <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="SMI_+3A_ncomp2">ncomp2</code></td>
<td>
<p>maximum number of subspace components from the second <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="SMI_+3A_projection">projection</code></td>
<td>
<p>type of projection to apply, defaults to &quot;Orthogonal&quot;, alternatively &quot;Procrustes&quot;.</p>
</td></tr>
<tr><td><code id="SMI_+3A_scores1">Scores1</code></td>
<td>
<p>user supplied score-<code>matrix</code> to replace singular value decomposition of first <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="SMI_+3A_scores2">Scores2</code></td>
<td>
<p>user supplied score-<code>matrix</code> to replace singular value decomposition of second <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="SMI_+3A_impute">impute</code></td>
<td>
<p><code>logical</code> for activation of PCA based imputation for X1/X2.</p>
</td></tr>
<tr><td><code id="SMI_+3A_impute_par">impute_par</code></td>
<td>
<p>named <code>list</code> of imputation parameters in case of NAs in X1/X2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A two-step process starts with extraction of stable subspaces using
Principal Component Analysis or some other method yielding two orthonormal bases. These bases
are compared using Orthogonal Projection (OP / ordinary least squares) or Procrustes
Rotation (PR). The result is a similarity measure that can be adjusted to various
data sets and contexts and which includes explorative plotting and permutation based testing
of matrix subspace equality.
</p>


<h3>Value</h3>

<p>A matrix containing all combinations of components. Its class is &quot;SMI&quot; associated
with print, plot, summary methods.
</p>


<h3>Author(s)</h3>

<p>Kristian Hovde Liland
</p>


<h3>References</h3>

<p>Ulf Geir Indahl, Tormod Næs, Kristian Hovde Liland; 2018. A similarity index for comparing coupled matrices. Journal of Chemometrics; e3049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.SMI">plot.SMI</a></code> (print.SMI/summary.SMI), <code><a href="#topic+RV">RV</a></code> (RV2/RVadj), <code><a href="#topic+r1">r1</a></code> (r2/r3/r4/GCD), <code><a href="#topic+Rozeboom">Rozeboom</a></code>, <code><a href="#topic+Coxhead">Coxhead</a></code>,
<code><a href="#topic+allCorrelations">allCorrelations</a></code> (matrix correlation comparison), <code><a href="#topic+PCAcv">PCAcv</a> (cross-validated PCA)</code>, <code><a href="#topic+PCAimpute">PCAimpute</a> (PCA based imputation)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulation
X1  &lt;- scale( matrix( rnorm(100*300), 100,300), scale = FALSE)
usv &lt;- svd(X1)
X2  &lt;- usv$u[,-3] %*% diag(usv$d[-3]) %*% t(usv$v[,-3])

(smi &lt;- SMI(X1,X2,5,5))
plot(smi, B = 1000 ) # default B = 10000

# Sensory analysis
data(candy)
plot( SMI(candy$Panel1, candy$Panel2, 3,3, projection = "Procrustes"),
    frame = c(2,2), B = 1000, x1lab = "Panel1", x2lab = "Panel2" ) # default B = 10000

# Missing data (100 missing completely at random points each)
X1[sort(round(runif(100)*29999+1))] &lt;- NA
X2[sort(round(runif(100)*29999+1))] &lt;- NA
(smi &lt;- SMI(X1,X2,5,5, impute = TRUE))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
