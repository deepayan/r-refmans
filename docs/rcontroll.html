<!DOCTYPE html><html><head><title>Help for package rcontroll</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rcontroll}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#autogif'><p>Create an animation from a TROLL simulation</p></a></li>
<li><a href='#autoplot,trollsim-method'><p>Plot TROLL simulation or stack</p></a></li>
<li><a href='#generate_climate'><p>Generate climate dataset</p></a></li>
<li><a href='#generate_lidar'><p>Generate lidar parameters</p></a></li>
<li><a href='#generate_parameters'><p>Generate global parameters</p></a></li>
<li><a href='#get_chm'><p>Extract canopy height model</p></a></li>
<li><a href='#get_forest'><p>Extract forest inventory</p></a></li>
<li><a href='#get_log'><p>Extract simulation log</p></a></li>
<li><a href='#load_output'><p>Load outputs from simulation</p></a></li>
<li><a href='#load_sim'><p>Load outputs from simulation or stack of simulations</p></a></li>
<li><a href='#load_stack'><p>Load outputs from a stack of simulations</p></a></li>
<li><a href='#option.rcontroll'><p>Options</p></a></li>
<li><a href='#print.trollsim'><p>Print a summary</p></a></li>
<li><a href='#rcontroll'><p><code>rcontroll</code>: individual-based forest growth simulator TROLL</p></a></li>
<li><a href='#stack'><p>Run a stack of <code>TROLL</code> simulations</p></a></li>
<li><a href='#troll'><p>Run a <code>TROLL</code> simulation</p></a></li>
<li><a href='#TROLL.version'><p><code>TROLL</code> version</p></a></li>
<li><a href='#trollCpp'><p>TROLL simulator</p></a></li>
<li><a href='#trollsim'><p>A <code>TROLL</code> simulations</p></a></li>
<li><a href='#trollsim-class'><p>A <code>TROLL</code> simulations</p></a></li>
<li><a href='#trollstack'><p>A stack of <code>TROLL</code> simulations</p></a></li>
<li><a href='#trollstack-class'><p>A stack of <code>TROLL</code> simulations</p></a></li>
<li><a href='#TROLLv3_climatedaytime12'><p><code>TROLL</code> climate parameters over months</p></a></li>
<li><a href='#TROLLv3_daytimevar'><p><code>TROLL</code> daytime variation parameters</p></a></li>
<li><a href='#TROLLv3_input'><p><code>TROLL</code> global parameters</p></a></li>
<li><a href='#TROLLv3_output'><p><code>TROLL</code> output</p></a></li>
<li><a href='#TROLLv3_pointcloud'><p><code>TROLL</code> lidar parameters</p></a></li>
<li><a href='#TROLLv3_species'><p><code>TROLL</code> species parameters</p></a></li>
<li><a href='#update_parameters'><p>Update global parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Individual-Based Forest Growth Simulator 'TROLL'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sylvain Schmitt &lt;sylvain.m.schmitt@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/sylvainschmitt/rcontroll">https://github.com/sylvainschmitt/rcontroll</a>,
<a href="https://sylvainschmitt.github.io/rcontroll/">https://sylvainschmitt.github.io/rcontroll/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sylvainschmitt/rcontroll/issues">https://github.com/sylvainschmitt/rcontroll/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>'TROLL' is coded in C++ and it typically simulates hundreds of
    thousands of individuals over hundreds of years. The 'rcontroll' R package 
    is a wrapper of 'TROLL'. 'rcontroll' includes functions that generate inputs 
    for simulations and run simulations. Finally, it is possible to analyse 
    the 'TROLL' outputs through tables, figures, and maps taking advantage of 
    other R visualisation packages. 'rcontroll' also offers the possibility to 
    generate a virtual LiDAR point cloud that corresponds to a snapshot of 
    the simulated forest.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods (&ge; 3.5.0), utils (&ge; 3.5.0), readr (&ge; 1.3.0), sys
(&ge; 3.2), dplyr (&ge; 1.0.0), magrittr (&ge; 2.0.0), reshape2 (&ge;
1.3.0), ggplot2 (&ge; 3.2.0), viridis (&ge; 0.4.0), parallel (&ge;
3.5.0), doParallel (&ge; 1.0.7), doSNOW (&ge; 1.0.10), foreach (&ge;
1.4.1), iterators (&ge; 1.0.5), Rcpp (&ge; 1.0.5), gganimate (&ge;
1.0.0), vroom (&ge; 1.0.0), tidyr (&ge; 1.0.0), tibble (&ge; 3.0.0),
lubridate (&ge; 1.6.0), terra (&ge; 1.5-16), lidR (&ge; 4.0.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>markdown, knitr, rmarkdown, testthat, covr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'RcppExports.R' 'TROLLv3_climatedaytime12.R'
'TROLLv3_daytimevar.R' 'TROLLv3_input.R' 'TROLLv3_output.R'
'TROLLv3_pointcloud.R' 'TROLLv3_species.R' 'zzz.R'
'TROLLversion.R' 'trollsim.R' 'load_output.R' 'troll.R'
'autogif.R' 'get_chm.trollsim.R' 'trollstack.R'
'autoplot.troll.R' 'utils-pipe.R' 'generate_climate.R'
'generate_lidar.R' 'generate_parameters.R'
'get_forest.trollsim.R' 'get_log.trollsim.R' 'load_stack.R'
'load_sim.trollsim.R' 'print.trollsim.R' 'rcontroll-package.R'
'rcontroll.R' 'stack.R' 'update_parameters.trollsim.R'</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppGSL</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-06 09:32:24 UTC; sschmitt</td>
</tr>
<tr>
<td>Author:</td>
<td>Sylvain Schmitt <a href="https://orcid.org/0000-0001-7759-7106"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Guillaume Salzet <a href="https://orcid.org/0000-0003-4548-5673"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Fabian Fischer <a href="https://orcid.org/0000-0003-2325-9886"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Isabelle Maréchaux
    <a href="https://orcid.org/0000-0002-5401-0197"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Jérôme Chave <a href="https://orcid.org/0000-0002-7766-1347"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-07 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='autogif'>Create an animation from a TROLL simulation</h2><span id='topic+autogif'></span>

<h3>Description</h3>

<p><code>autogif()</code> uses <code>ggplot2</code> and <code>gganimate</code> to render an animation from a
TROLL simulation. The animation can include a vertical cut in the forest
structure along the X-axis highlighting either tree species (<code>variables = 'species'</code>), either tree height relative to their maximum height (<code>variables = 'height_ct'</code>), or tree carbon acquisition with net over growth primary
productivity (<code>variables = 'npp_gpp'</code>). The animation can also include a top
view of the canopy representing either canopy trees height (<code>variables = 'height'</code>) or total leaf area index per pixel (<code>variables = 'lai'</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autogif(
  name = NULL,
  path = NULL,
  variables = c("species", "height_ct", "npp_gpp", "height", "lai"),
  global,
  species,
  climate,
  daily,
  forest = NULL,
  verbose = TRUE,
  overwrite = TRUE,
  thin = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autogif_+3A_name">name</code></td>
<td>
<p>char. Model name (if NULL timestamp).</p>
</td></tr>
<tr><td><code id="autogif_+3A_path">path</code></td>
<td>
<p>char. Path to save the simulation outputs, the default is null
corresponding to a simulation in memory without saved intermediary files
(based on temporary files from <a href="#topic+option.rcontroll">option.rcontroll</a>).</p>
</td></tr>
<tr><td><code id="autogif_+3A_variables">variables</code></td>
<td>
<p>char. Variables to build as a gif among 'species',
'height_ct', 'npp_gpp', 'height', or 'lai'.</p>
</td></tr>
<tr><td><code id="autogif_+3A_global">global</code></td>
<td>
<p>df. Global parameters (e.g. <a href="#topic+TROLLv3_input">TROLLv3_input</a> or using
<code><a href="#topic+generate_parameters">generate_parameters()</a></code>).</p>
</td></tr>
<tr><td><code id="autogif_+3A_species">species</code></td>
<td>
<p>df. Species parameters (e.g. <a href="#topic+TROLLv3_species">TROLLv3_species</a>).</p>
</td></tr>
<tr><td><code id="autogif_+3A_climate">climate</code></td>
<td>
<p>df. Climate parameters (e.g. <a href="#topic+TROLLv3_climatedaytime12">TROLLv3_climatedaytime12</a>).</p>
</td></tr>
<tr><td><code id="autogif_+3A_daily">daily</code></td>
<td>
<p>df. Daily variation parameters (e.g. <a href="#topic+TROLLv3_daytimevar">TROLLv3_daytimevar</a>).</p>
</td></tr>
<tr><td><code id="autogif_+3A_forest">forest</code></td>
<td>
<p>df. TROLL with forest input, if null starts from an empty grid
(default NULL) (e.g. using <a href="#topic+TROLLv3_output">TROLLv3_output</a> with <code><a href="#topic+get_forest">get_forest()</a></code>).</p>
</td></tr>
<tr><td><code id="autogif_+3A_verbose">verbose</code></td>
<td>
<p>bool. Show TROLL outputs in the console.</p>
</td></tr>
<tr><td><code id="autogif_+3A_overwrite">overwrite</code></td>
<td>
<p>bool. Overwrite previous outputs.</p>
</td></tr>
<tr><td><code id="autogif_+3A_thin">thin</code></td>
<td>
<p>int. Vector of integers corresponding to the iterations to be
kept to reduce output size, default is NULL and corresponds to no thinning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>gganimate</code> objects corresponding to chosen outputs.
</p>


<h3>See Also</h3>

<p><a href="#topic+autoplot+2Ctrollsim-method">autoplot,trollsim-method</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("TROLLv3_species")
data("TROLLv3_climatedaytime12")
data("TROLLv3_daytimevar")
autogif(
  name = "test", global = generate_parameters(
    cols = 100, rows = 100,
    iterperyear = 12, nbiter = 12 * 100,
    extent_visual = 10
  ),
  species = TROLLv3_species,
  climate = TROLLv3_climatedaytime12,
  daily = TROLLv3_daytimevar,
  verbose = FALSE
)

## End(Not run)

</code></pre>

<hr>
<h2 id='autoplot+2Ctrollsim-method'>Plot TROLL simulation or stack</h2><span id='topic+autoplot+2Ctrollsim-method'></span>

<h3>Description</h3>

<p><code>autoplot()</code> is a method that takes advantage of <code>ggplot2</code> to plot TROLL
simulations. <code>autoplot()</code> can plot either temporal trajectories of whole
ecosystem or species metrics (<code>what = 'temporal'</code>), the initial or final
pattern observed in the forest community (<code>what = 'spatial'</code> or <code>what = 'distribution'</code>), or lidar outputs (<code>what = 'lidar'</code>). Metrics includes
abundances of individuals above 1cm (N), above 10cm (N10), and above 30cm
(N30), aboveground biomass (AGB), basal area of individuals above 1cm (BA),
and above 10cm (BA10), gross primary production (GPP), net primary production
(NPP), respiration of day (Rday), night (Rnight) and stem (Rstem), and
litterfall.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'trollsim'
autoplot(
  object,
  what = "temporal",
  variables = NULL,
  species = NULL,
  iter = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot+2B2Ctrollsim-method_+3A_object">object</code></td>
<td>
<p>TROLL simulation or stack (see <code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>,
<code><a href="#topic+trollsim">trollsim()</a></code> and <code><a href="#topic+trollstack">trollstack()</a></code>).</p>
</td></tr>
<tr><td><code id="autoplot+2B2Ctrollsim-method_+3A_what">what</code></td>
<td>
<p>char. What to plot: &quot;temporal&quot;, &quot;spatial&quot; &quot;distribution&quot;, or
&quot;lidar&quot;. &quot;temporal&quot; is for temporal trajectories of the whole ecosystem or
defined species. &quot;spatial&quot; is for spatial patterns in the initial or final
forest. &quot;distribution&quot; is for metrics distribution in the initial or final
forest. &quot;lidar&quot; is for canopy height model plot.</p>
</td></tr>
<tr><td><code id="autoplot+2B2Ctrollsim-method_+3A_variables">variables</code></td>
<td>
<p>char. Which variable(s) to plot. Only one variable is
accepted when plotting &quot;spatial&quot;.</p>
</td></tr>
<tr><td><code id="autoplot+2B2Ctrollsim-method_+3A_species">species</code></td>
<td>
<p>char. Which species to plot. NULL indicates the whole
ecosystem level. &quot;all&quot; can be used to use all species.</p>
</td></tr>
<tr><td><code id="autoplot+2B2Ctrollsim-method_+3A_iter">iter</code></td>
<td>
<p>char. Which iteration(s) to plot, for temporal thinning or to
specify which forest to plot. &quot;initial&quot; or &quot;final&quot; can be used. NULL is
converted to &quot;final&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autogif">autogif()</a></code>, <a href="#topic+summary+2Ctrollsim-method">summary,trollsim-method</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("TROLLv3_output")
autoplot(TROLLv3_output)

</code></pre>

<hr>
<h2 id='generate_climate'>Generate climate dataset</h2><span id='topic+generate_climate'></span>

<h3>Description</h3>

<p><code>TROLL</code> forest simulator relies on climate tables with half-hourly variations
of a typical day and monthly variations of a typical year which are recycled
through simulation days and years. Initially, <code>TROLL</code> climate tables were
computed from the Nouraflux dataset. Variations in quantities of interests
(temperatures, ...) were averaged to the target resolution (half-hour for
daily variation or month for monthly variation). The purpose of climate
generation functions is to compute equivalent climate tables from the ERA5
land reanalysis dataset (Muñoz-Sabater et al. 2021). With these functions,
<code>rcontroll</code> users only need inventories and associated functional traits to
run <code>TROLL</code> simulations. See the corresponding vignette
<code>vignette("climate", package = "rcontroll")</code> for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_climate(
  x,
  y,
  tz,
  era5land_hour,
  era5land_month,
  daytime_start = 7,
  daytime_end = 19
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_climate_+3A_x">x</code></td>
<td>
<p>num. Longitude in UTM. Can be obtained from the location name with
<code><a href="nominatimlite.html#topic+geo_lite_sf">nominatimlite::geo_lite_sf()</a></code>.</p>
</td></tr>
<tr><td><code id="generate_climate_+3A_y">y</code></td>
<td>
<p>num. Latitude in UTM. Can be obtained from the location name with
<code><a href="nominatimlite.html#topic+geo_lite_sf">nominatimlite::geo_lite_sf()</a></code>.</p>
</td></tr>
<tr><td><code id="generate_climate_+3A_tz">tz</code></td>
<td>
<p>num. Time zone. Can be obtained from the coordinates with
<code><a href="lutz.html#topic+tz_lookup_coords">lutz::tz_lookup_coords()</a></code>.</p>
</td></tr>
<tr><td><code id="generate_climate_+3A_era5land_hour">era5land_hour</code></td>
<td>
<p>str. Path to ERA5 land data monthly averaged reanalysis
by hour of day in netCDF. See the corresponding vignette
<code>vignette("climate", package = "rcontroll")</code> to download corresponding
data from Copernicus in R.</p>
</td></tr>
<tr><td><code id="generate_climate_+3A_era5land_month">era5land_month</code></td>
<td>
<p>str. Path to ERA5 land data monthly averaged reanalysis
in netCDF. See the corresponding vignette <code>vignette("climate", package
  = "rcontroll")</code> to download corresponding data from Copernicus in R.</p>
</td></tr>
<tr><td><code id="generate_climate_+3A_daytime_start">daytime_start</code></td>
<td>
<p>int. Daytime starting hour to compute nigh and day
variables (default 7).</p>
</td></tr>
<tr><td><code id="generate_climate_+3A_daytime_end">daytime_end</code></td>
<td>
<p>int. Daytime ending hour to compute nigh and day variables
(default 19).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>TROLL</code> forest model simulates tree growth based on ecophysiological
processes, with an external climate forcing. Input climatic conditions are
provided in the form of climate tables with (i) half-hourly standardised
variation of a typical day, and (ii) monthly average values of a typical
year, which are currently recycled through simulation. Initially, TROLL
climate tables were computed from the Nouraflux dataset (Poncy et al., 1998).
The variation in quantities of interest (irradiance, temperature, vapour
pressure, rainfall, and wind speed) were averaged to the target resolution
(half-hour for daily variation or month for monthly variation).
</p>
<p>The purpose of the climate generation function is to compute equivalent
climate tables from a global climatic reanalysis dataset. With
<code>generate_climate</code>, <code>rcontroll</code> users no longer need to format complex
climate input fields, but can generate them from global and carefully
documented climate distributions to run <code>TROLL</code> simulations. The selected
input climate product for this version of <code>rcontroll</code> is ERA5-Land
(Muñoz-Sabater et al. 2021). The ERA5-Land climate reanalysis has two main
advantages over other climate reanalysis products: (1) the data are at a
spatial resolution of 9km and have been available at hourly temporal
resolution since 1950, and (2) daily or monthly averages are available and
their uncertainties are reported.
</p>


<h4>Hypotheses</h4>

<p>The following assumptions are made in the generation of climate data:
</p>

<ol>
<li><p> The temperature at 2m and its derivatives (<code>d2m</code>) from ERA5-land
corresponds to air temperature measurement used as an input in <code>TROLL</code>;
</p>
</li>
<li><p> We can calculate the  vapour pressure deficit using the Buck equation;
</p>
</li>
<li><p> The extraction of standardised half-hourly values of an average day and of
monthly average values of a year for the climate variables of interest is
based on the decomposition of the raw time series into: (i) an overall trend
over the study period, (ii) seasonal or daily variation across months or
hours depending on the study level, and (iii) the remaining variation;
</p>
</li>
<li><p> Half-hourly values are not available for ERA5-land data. Spline functions
are used to interpolate hourly values for downscaling to half-hourly
resolution.
</p>
</li></ol>




<h4>Quantities of interest</h4>



<h5><code>TROLL</code> variables</h5>

<p>TROLL climate tables summarise temporal variation of quantities of interest.
These variations are called <strong>seasonal pattern</strong> and are computed from time
series under the additive assumption :
</p>
<p><code class="reqn">X(t) = Trend_X(t)+Seasonal_{x,Period}(t  \mod p [mod Period]) +
Irregular(t)</code>
</p>
<p>With :
</p>

<ul>
<li> <p><code class="reqn">Trend_X(t)</code> a moving average covering one period;
</p>
</li>
<li> <p><code class="reqn">Seasonal_{x,Period}(t  \mod p [mod Period])</code> the seasonal pattern
contribution at t time modulo the period;
</p>
</li>
<li> <p><code class="reqn">Irregular(t)</code> the remainder part.
</p>
</li></ul>

<p>The de-seasonally average of X is defined as :
</p>
<p><code class="reqn">mean(X)=mean(Trend_X(t))</code>
</p>
<p>These values of seasonal pattern and de-seasonally average are used to
compute the climate table <a href="#topic+TROLLv3_climatedaytime12">TROLLv3_climatedaytime12</a> and
<a href="#topic+TROLLv3_daytimevar">TROLLv3_daytimevar</a>.
</p>



<h5>ERA5-Land variables</h5>

<p>There is a restricted set of variables needed to generate the TROLL climate
files:
</p>

<ul>
<li><p> t2m: Temperature at 2m in K
</p>
</li>
<li><p> d2m: Dew point temperature at 2m in K
</p>
</li>
<li><p> tp: Cumulative rainfall in m
</p>
</li>
<li><p> sp: Atmospheric pressure at the surface in Pa
</p>
</li>
<li><p> ssrd: Cumulative Net solar irradiation in J/m2
</p>
</li>
<li><p> u10: Zonal wind component at 10m in m/s
</p>
</li>
<li><p> v10: Meridional wind component at 10m in m/s
</p>
</li></ul>





<h4>Calculation of variables</h4>

<p>The transition from ERA-Land data to <code>TROLL</code> data requires several
transformations. The <code>TROLL</code> climate files correspond to seasonal components,
either daily from 7am to 7pm, or monthly. The extraction of these seasonal
components is possible by analysing the time series of the data. An additive
decomposition of the variables allows one to obtain the pattern of interest
at the original resolution (hourly or monthly). Interpolation of the pattern
using spline functions of the periodic type, ensuring the boundary conditions
(i.e. value at 0 am is the same as 12 pm), except for the <code>ssrd</code> which is not
a continuous periodic function and which requires natural type spline
interpolation. An evaluation of the quality of the pattern extraction is
possible by measuring the standard deviation of the error to the original
time series. This error can be calculated for each unit of the pattern (for
each hour for example).
</p>


<h5>Wind speed</h5>

<p>The wind speed is the norm of the vector generated by the u10 and v10
components of the wind. We can therefore deduce that the wind speed
corresponds to:
</p>
<p><code class="reqn">WindSpeed= \sqrt{u10^2+v10^2}</code>
</p>



<h5>Vapour pressure deficit</h5>

<p>The calculation of the vapour pressure deficit can be done according to three
variables (<code>t2m</code>, <code>d2m</code> and <code>sp</code>) using the formula of (Buck 1981):
</p>
<p><code class="reqn">VPD =e_{sat}(d2m,sp)-e_{obst}(2m,sp)</code>
</p>
<p><code class="reqn">e_*(t2m|d2m,sp)=611.21xf(t2m|d2m,sp)x(1)</code>
</p>
<p><code class="reqn">(1)=18.678-(t2m|d2m-273.15)/234.5x(t2m|d2m-273.15)/
(240.97+t2m|d2m-273.15)</code>
</p>
<p><code class="reqn">f(t2m|d2m,sp)=1.0007+10^{-7}xspx0.032+5.9x10^{-6}x(t2m|d2m-273.15)^2</code>
</p>



<h5>Instantaneous irradiance</h5>

<p>The measurement of irradiance in the ERA5 data corresponds to the
accumulation either at hourly or daily intervals. The instantaneous
measurement can be obtained by calculating the variation of this
accumulation:
</p>
<p><code class="reqn">\Delta ssrd(t)= ssrd(t)-ssrd(t-1)</code>
</p>




<h4>Conclusion</h4>

<p>In conclusion, despite some discrepancies between climate input generated
from local meteorological station data and the <code>generate_climate</code> function
that should be investigated further, the <code>generate_climate</code> function allows
<code>rcontroll</code> users to easily obtain relevant climate data for their study. The
discrepancies may be partly due to the unconventional situation of the
Nouraflux station, which should not be considered as the true climate.
</p>
<p><strong>Warning</strong>: As <code>TROLL</code> is under constant development, some of the variables
presented here may not be used in the current version (v 3.1.7) and may be
left over from previous versions or may be intended for future versions.
Furthermore, this supplementary information corresponds to the version 3.1.7
of <code>TROLL</code> and the climate variables used by the model may change as new
versions of <code>TROLL</code> are released. We plan to include future major
developments of <code>TROLL</code> in <code>rcontroll</code> to keep the advances of the model
accessible to the community, including the development of the
<code>generate_climate</code> function. We thus invite the reader to check the
corresponding updated vignette on GitHub
(https://sylvainschmitt.github.io/rcontroll/articles/climate.html) according
to the version of <code>TROLL</code> they are using in <code>rcontroll</code> (check with
<code><a href="#topic+TROLL.version">TROLL.version()</a></code>).
</p>



<h4>References</h4>

<p>Buck, Arden L. (1981) New equations for computing vapor pressure and
enhancement factor. Journal of Applied Meteorology and Climatology, 1981,
vol. 20, no 12, p. 1527-1532.
</p>
<p>Muñoz-Sabater, J., Dutra, E., Agustí-Panareda, A., Albergel, C., Arduini, G.,
Balsamo, G., … Thépaut, J. N. (2021). ERA5-Land: A state-of-the-art global
reanalysis dataset for land applications. Earth System Science Data, 13(9),
4349–4383. https://doi.org/10.5194/essd-13-4349-2021
</p>
<p>Poncy, O., Riéra, B., Larpin, D., Belbenoit, P., Jullien, M., Hoff, M., &amp;
Charles-Dominique, P. (1998). The permanent field research station “Les
Nouragues” in the tropical rainforest of French Guiana: current projects and
preliminary results on tree diversity, structure, and dynamics. Forest
Biodiversity in North, Central and South America, and the Caribbean: Research
and Monitoring., 385–410.
</p>



<h3>Value</h3>

<p>A list with two <code><a href="base.html#topic+data.frame">data.frame()</a></code>: daytimevar and climatedaytime12.
</p>

<hr>
<h2 id='generate_lidar'>Generate lidar parameters</h2><span id='topic+generate_lidar'></span>

<h3>Description</h3>

<p><code>generate_lidar</code> generate the lidar parameters used in <code>TROLL</code> lidar
simulation. All parameters have a default value from literature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_lidar(
  mean_beam_pc = 10,
  sd_beam_pc = 5,
  klaser_pc = 0.63,
  transmittance_laser = 0.4,
  iter_pointcloud_generation = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_lidar_+3A_mean_beam_pc">mean_beam_pc</code></td>
<td>
<p>num. Mean pulse density (pulses per m2).</p>
</td></tr>
<tr><td><code id="generate_lidar_+3A_sd_beam_pc">sd_beam_pc</code></td>
<td>
<p>num. Standard deviation of pulse density (per m2).</p>
</td></tr>
<tr><td><code id="generate_lidar_+3A_klaser_pc">klaser_pc</code></td>
<td>
<p>num. laser attenuation factor.</p>
</td></tr>
<tr><td><code id="generate_lidar_+3A_transmittance_laser">transmittance_laser</code></td>
<td>
<p>num. Percentage of pulses that continue through
the canopy after a hit.</p>
</td></tr>
<tr><td><code id="generate_lidar_+3A_iter_pointcloud_generation">iter_pointcloud_generation</code></td>
<td>
<p>num. Number of iteration for point cloud
generation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A [data.frame)] of lidar simulation parameters.
</p>
<p>[data.frame)]: R:data.frame)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>generate_lidar(iter_pointcloud_generation = 3600)

</code></pre>

<hr>
<h2 id='generate_parameters'>Generate global parameters</h2><span id='topic+generate_parameters'></span>

<h3>Description</h3>

<p><code>generate_parameters()</code> generate the global parameters used in the <code>TROLL</code>
simulation. All parameters have a default value used in French Guiana
simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_parameters(
  cols = 200,
  rows = 200,
  HEIGHT = 70,
  length_dcell = 25,
  nbiter,
  iterperyear = 12,
  NV = 1,
  NH = 1,
  nbout = 4,
  nbspp = 45,
  SWtoPPFD = 2.27,
  p_nonvert = 0.05,
  klight = 0.63,
  phi = 0.093,
  absorptance_leaves = 0.9,
  theta = 0.7,
  g1 = 3.77,
  vC = 0.021,
  DBH0 = 0.005,
  H0 = 0.95,
  CR_min = 0.3,
  CR_a = 2.13,
  CR_b = 0.63,
  CD_a = 0,
  CD_b = 0.2,
  CD0 = 0.3,
  shape_crown = 0.72,
  dens = 1,
  fallocwood = 0.35,
  falloccanopy = 0.25,
  Cseedrain = 50000,
  nbs0 = 10,
  sigma_height = 0,
  sigma_CR = 0,
  sigma_CD = 0,
  sigma_P = 0,
  sigma_N = 0,
  sigma_LMA = 0,
  sigma_wsg = 0,
  sigma_dbhmax = 0,
  corr_CR_height = 0,
  corr_N_P = 0,
  corr_N_LMA = 0,
  corr_P_LMA = 0,
  leafdem_resolution = 30,
  p_tfsecondary = 1,
  hurt_decay = 0,
  crown_gap_fraction = 0.15,
  m = 0.013,
  m1 = 0.013,
  Cair = 400,
  LL_parameterization = 1,
  LA_regulation = 2,
  sapwood = 1,
  seedsadditional = 0,
  NONRANDOM = 1,
  GPPcrown = 0,
  BASICTREEFALL = 1,
  SEEDTRADEOFF = 0,
  CROWN_MM = 0,
  OUTPUT_extended = 1,
  extent_visual = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_parameters_+3A_cols">cols</code></td>
<td>
<p>num. Number of columns.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_rows">rows</code></td>
<td>
<p>num. Number of rows.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_height">HEIGHT</code></td>
<td>
<p>num. Vertical extent of simulation.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_length_dcell">length_dcell</code></td>
<td>
<p>num. Linear size of a dcell.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_nbiter">nbiter</code></td>
<td>
<p>num. Total number of timesteps.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_iterperyear">iterperyear</code></td>
<td>
<p>num. Number of iterations per year.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_nv">NV</code></td>
<td>
<p>num. Vertical number of cells (per m).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_nh">NH</code></td>
<td>
<p>num. Horizontal number of cells (per m).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_nbout">nbout</code></td>
<td>
<p>num. Number of outputs.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_nbspp">nbspp</code></td>
<td>
<p>num. Number of species</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_swtoppfd">SWtoPPFD</code></td>
<td>
<p>num. Convert shortwave irradiance to PAR photons.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_p_nonvert">p_nonvert</code></td>
<td>
<p>num. Light incidence parameter (difference through turbid
medium).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_klight">klight</code></td>
<td>
<p>num. Light attenuation in the canopy following a Beer-Lambert
law.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_phi">phi</code></td>
<td>
<p>num. Quantum yield (in micromol C/micromol photon).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_absorptance_leaves">absorptance_leaves</code></td>
<td>
<p>num. Absorptance of individual leaves.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_theta">theta</code></td>
<td>
<p>num. Parameter of the Farquhar model.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_g1">g1</code></td>
<td>
<p>num. Parameter g1 of Medlyn et al stomatal conductance model.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_vc">vC</code></td>
<td>
<p>num. Variance of the flexion moment.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_dbh0">DBH0</code></td>
<td>
<p>num. Initial diameter at breast height (m).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_h0">H0</code></td>
<td>
<p>num. Initial height (m).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_cr_min">CR_min</code></td>
<td>
<p>num. Minimum crown radius (in m).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_cr_a">CR_a</code></td>
<td>
<p>num. Crown radius log intercept or Michaelis Menten initial
growth.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_cr_b">CR_b</code></td>
<td>
<p>num. Crown radius log slope or Michaelis Menten asymptotic CR.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_cd_a">CD_a</code></td>
<td>
<p>num. Crown depth intercept (absolute value).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_cd_b">CD_b</code></td>
<td>
<p>num. Crown depth slope (as fraction of tree height).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_cd0">CD0</code></td>
<td>
<p>num. Initial crown depth (in m).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_shape_crown">shape_crown</code></td>
<td>
<p>num. Crown shape parameter.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_dens">dens</code></td>
<td>
<p>num. Initial leaf density (m^2/m^2).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_fallocwood">fallocwood</code></td>
<td>
<p>num. Fraction of biomass allocated to above ground wood
(branch turnover+stem).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_falloccanopy">falloccanopy</code></td>
<td>
<p>num. Fraction of biomass allocated to canopy (leaves +
reproductive organs + twigs).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_cseedrain">Cseedrain</code></td>
<td>
<p>num. Constant used to scale total seed rain per hectare
across species.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_nbs0">nbs0</code></td>
<td>
<p>num. Number of seeds produced and dispersed by each mature tree
when SEEDTRADEOFF is not defined.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sigma_height">sigma_height</code></td>
<td>
<p>num. Intraspecific variation in tree height (lognormal).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sigma_cr">sigma_CR</code></td>
<td>
<p>num. Intraspecific variation in crown radius (lognormal).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sigma_cd">sigma_CD</code></td>
<td>
<p>num. Intraspecific variation in crown depth (lognormal).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sigma_p">sigma_P</code></td>
<td>
<p>num. Intraspecific variation in leaf phosphorus (lognormal).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sigma_n">sigma_N</code></td>
<td>
<p>num. Intraspecific variation in leaf nitrogen (lognormal).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sigma_lma">sigma_LMA</code></td>
<td>
<p>num. Intraspecific variation in leaf mass per area
(lognormal).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sigma_wsg">sigma_wsg</code></td>
<td>
<p>num. Intraspecific variation in wood specific gravity.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sigma_dbhmax">sigma_dbhmax</code></td>
<td>
<p>num. Intraspecific variation in maximum diameter.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_corr_cr_height">corr_CR_height</code></td>
<td>
<p>num. Correlation coefficient between crown radius and
tree height.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_corr_n_p">corr_N_P</code></td>
<td>
<p>num. Correlation coefficient between leaf nitrogen and leaf
phosphorus.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_corr_n_lma">corr_N_LMA</code></td>
<td>
<p>num. Correlation coefficient between leaf nitrogen and leaf
mass per area</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_corr_p_lma">corr_P_LMA</code></td>
<td>
<p>num. Correlation coefficient between leaf phosphorus and
leaf mass per area</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_leafdem_resolution">leafdem_resolution</code></td>
<td>
<p>num. Resolution of leaf demography model.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_p_tfsecondary">p_tfsecondary</code></td>
<td>
<p>num. Probability of secondary treefall.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_hurt_decay">hurt_decay</code></td>
<td>
<p>num. Parameter determining how tree damages are repaired.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_crown_gap_fraction">crown_gap_fraction</code></td>
<td>
<p>num. Fraction of gaps in the crown.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_m">m</code></td>
<td>
<p>num. Minimal death rate.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_m1">m1</code></td>
<td>
<p>num. Slope of death rate m1.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_cair">Cair</code></td>
<td>
<p>num. Atmospheric CO2 concentration in micromol/mol.</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_ll_parameterization">LL_parameterization</code></td>
<td>
<p>num. Leaf lifespan parameterizations: Reich
empirical, Kikuzawa model, and Kikuzawa model with leaf plasticity (0,1,2).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_la_regulation">LA_regulation</code></td>
<td>
<p>num. Dynamic LA regulation: off, 1.0, 0.75, or 0.5
(0,1,2,3).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_sapwood">sapwood</code></td>
<td>
<p>num. Sapwood parameterizations: constant thickness (0.04),
Fyllas percentage, Fyllas lower limit (0,1,2).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_seedsadditional">seedsadditional</code></td>
<td>
<p>num. Excess biomass into seeds after maturation (0,1).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_nonrandom">NONRANDOM</code></td>
<td>
<p>num. If _NONRANDOM &gt;= 1, the seeds for the random number
generators will be set using fixed seed in R, default for bug fixing (0,1).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_gppcrown">GPPcrown</code></td>
<td>
<p>num. This defines an option to compute only GPP from the
topmost value of PPFD and GPP, instead of looping within the crown (0,1).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_basictreefall">BASICTREEFALL</code></td>
<td>
<p>num. If defined: treefall is a source of tree death
(0,1).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_seedtradeoff">SEEDTRADEOFF</code></td>
<td>
<p>num. if defined: the number of seeds produced is
determined by NPP allocated to reproduction and seed mass, otherwise the
number of seeds is fixed (0,1).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_crown_mm">CROWN_MM</code></td>
<td>
<p>num. Michaelis Menten allometry for crowns instead of power
law, parameters have to be changed in other input sheets accordingly (0,1).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_output_extended">OUTPUT_extended</code></td>
<td>
<p>num. extended set of ouput files (0,1).</p>
</td></tr>
<tr><td><code id="generate_parameters_+3A_extent_visual">extent_visual</code></td>
<td>
<p>num. extent for visualization output. Unactivated when
equal 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of global parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>, <code><a href="#topic+update_parameters">update_parameters()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
generate_parameters(nbiter = 12)

</code></pre>

<hr>
<h2 id='get_chm'>Extract canopy height model</h2><span id='topic+get_chm'></span><span id='topic+get_chm+2Ctrollsim-method'></span>

<h3>Description</h3>

<p><code>get_chm()</code> extract the canopy height model from <code>TROLL</code> outputs with lidar
option.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_chm(sim, method = "smoothed", ...)

## S4 method for signature 'trollsim'
get_chm(sim, method = "smoothed", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_chm_+3A_sim">sim</code></td>
<td>
<p>trollsim.</p>
</td></tr>
<tr><td><code id="get_chm_+3A_method">method</code></td>
<td>
<p>char. method to extract the canopy height model from the point
cloud in las, either 'filled' (replacing NA by 0) or 'smoothed' (local
means, default value).</p>
</td></tr>
<tr><td><code id="get_chm_+3A_...">...</code></td>
<td>
<p>unused argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+data.frame">data.frame()</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trollsim">trollsim()</a></code>, <code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>
</p>

<hr>
<h2 id='get_forest'>Extract forest inventory</h2><span id='topic+get_forest'></span><span id='topic+get_forest+2Ctrollsim-method'></span>

<h3>Description</h3>

<p><code>get_forest()</code> extract the forest inventory from <code>TROLL</code> outputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_forest(sim, ...)

## S4 method for signature 'trollsim'
get_forest(sim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_forest_+3A_sim">sim</code></td>
<td>
<p>trollsim or trollstack.</p>
</td></tr>
<tr><td><code id="get_forest_+3A_...">...</code></td>
<td>
<p>unused argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+data.frame">data.frame()</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trollsim">trollsim()</a></code>, <code><a href="#topic+trollstack">trollstack()</a></code>, <code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("TROLLv3_output")
head(get_forest(TROLLv3_output))

</code></pre>

<hr>
<h2 id='get_log'>Extract simulation log</h2><span id='topic+get_log'></span><span id='topic+get_log+2Ctrollsim-method'></span>

<h3>Description</h3>

<p><code>get_forest()</code> extract the simulation log <code>TROLL</code> outputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_log(sim, ...)

## S4 method for signature 'trollsim'
get_log(sim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_log_+3A_sim">sim</code></td>
<td>
<p>trollsim or trollstack.</p>
</td></tr>
<tr><td><code id="get_log_+3A_...">...</code></td>
<td>
<p>unused argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the log in the console
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trollsim">trollsim()</a></code>, <code><a href="#topic+trollstack">trollstack()</a></code>, <code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("TROLLv3_output")
get_log(TROLLv3_output)

</code></pre>

<hr>
<h2 id='load_output'>Load outputs from simulation</h2><span id='topic+load_output'></span>

<h3>Description</h3>

<p><code>load_output</code> load outputs from <code>TROLL</code> simulation files using <code>TROLL</code>
simulation <code>name</code> and <code>path</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_output(name, path, thin = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_output_+3A_name">name</code></td>
<td>
<p>char. Name given to the model output.</p>
</td></tr>
<tr><td><code id="load_output_+3A_path">path</code></td>
<td>
<p>char. Path where the model is saved.</p>
</td></tr>
<tr><td><code id="load_output_+3A_thin">thin</code></td>
<td>
<p>int. Vector of integers corresponding to the iterations to be
kept to reduce output size, default is NULL and corresponds to no thinning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+trollsim">trollsim()</a></code> class object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trollsim">trollsim()</a></code>, <code><a href="#topic+trollstack">trollstack()</a></code>, <code><a href="#topic+load_sim">load_sim()</a></code>, <code><a href="#topic+load_stack">load_stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
load_output("test", "./")

## End(Not run)

</code></pre>

<hr>
<h2 id='load_sim'>Load outputs from simulation or stack of simulations</h2><span id='topic+load_sim'></span><span id='topic+load_sim+2Ctrollsim-method'></span>

<h3>Description</h3>

<p><code>load_sim</code> is a method of <code><a href="#topic+trollsim">trollsim()</a></code> or <code><a href="#topic+trollstack">trollstack()</a></code> with wirtten files
not in R memory to load them into R memory taking advantage of
<code><a href="#topic+load_output">load_output()</a></code> and <code><a href="#topic+load_stack">load_stack()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_sim(sim, ...)

## S4 method for signature 'trollsim'
load_sim(sim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_sim_+3A_sim">sim</code></td>
<td>
<p>trollsim or trollstack.</p>
</td></tr>
<tr><td><code id="load_sim_+3A_...">...</code></td>
<td>
<p>unused argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+trollsim">trollsim()</a></code> or <code><a href="#topic+trollstack">trollstack()</a></code>  class object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trollsim">trollsim()</a></code>, <code><a href="#topic+trollstack">trollstack()</a></code>, <code><a href="#topic+load_sim">load_sim()</a></code>, <code><a href="#topic+load_stack">load_stack()</a></code>
</p>

<hr>
<h2 id='load_stack'>Load outputs from a stack of simulations</h2><span id='topic+load_stack'></span>

<h3>Description</h3>

<p><code>load_stack</code> load outputs from a stack of <code>TROLL</code> simulation files using
<code>TROLL</code> stack of simulation <code>name</code> and <code>path</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_stack(name, path, thin = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_stack_+3A_name">name</code></td>
<td>
<p>char. Name given to the stack output.</p>
</td></tr>
<tr><td><code id="load_stack_+3A_path">path</code></td>
<td>
<p>char. Path where the stack is saved.</p>
</td></tr>
<tr><td><code id="load_stack_+3A_thin">thin</code></td>
<td>
<p>int. Vector of integers corresponding to the iterations to be
kept to reduce output size, default is NULL and corresponds to no thinning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S4 <code><a href="#topic+trollstack">trollstack()</a></code> class object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trollsim">trollsim()</a></code>, <code><a href="#topic+trollstack">trollstack()</a></code>, <code><a href="#topic+load_sim">load_sim()</a></code>, <code><a href="#topic+load_stack">load_stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
load_stack("test", "./")

## End(Not run)

</code></pre>

<hr>
<h2 id='option.rcontroll'>Options</h2><span id='topic+option.rcontroll'></span>

<h3>Description</h3>

<p><code>rcontroll</code> package global options including temporary files location and
'TROLL version.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="option.rcontroll_+3A_rcontroll.tmp">rcontroll.tmp</code></td>
<td>
<p>char. Path to temporary files folder used by <code><a href="#topic+troll">troll()</a></code>
and <code><a href="#topic+stack">stack()</a></code>.</p>
</td></tr>
<tr><td><code id="option.rcontroll_+3A_rcontroll.troll">rcontroll.troll</code></td>
<td>
<p>char. <code>TROLL</code>version number accessible with
<code><a href="#topic+TROLL.version">TROLL.version()</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='print.trollsim'>Print a summary</h2><span id='topic+print.trollsim'></span><span id='topic+print+2Ctrollsim-method'></span><span id='topic+show+2Ctrollsim-method'></span><span id='topic+summary+2Ctrollsim-method'></span>

<h3>Description</h3>

<p><code>print()</code> prints a summary of TROLL simulation or stack of simulations
outputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'trollsim'
print(x, ...)

## S4 method for signature 'trollsim'
show(object)

## S4 method for signature 'trollsim'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.trollsim_+3A_x">x</code></td>
<td>
<p>trollsim or trollstack.</p>
</td></tr>
<tr><td><code id="print.trollsim_+3A_...">...</code></td>
<td>
<p>unused argument.</p>
</td></tr>
<tr><td><code id="print.trollsim_+3A_object">object</code></td>
<td>
<p>trollsim  or trollstack.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print or show in console.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>, <code><a href="#topic+trollsim">trollsim()</a></code>, <code><a href="#topic+trollstack">trollstack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("TROLLv3_output")
print(TROLLv3_output)

</code></pre>

<hr>
<h2 id='rcontroll'><code>rcontroll</code>: individual-based forest growth simulator TROLL</h2><span id='topic+rcontroll'></span><span id='topic+rcontroll-package'></span>

<h3>Description</h3>

<p><code>TROLL</code> is coded in C++ and it typically simulates hundreds of thousands of
individuals over hundreds of years. The <code>rcontroll</code> R package is a wrapper of
<code>TROLL</code>. <code>rcontroll</code> includes functions that generate inputs for simulations
and run simulations. Finally, it is possible to analyse the <code>TROLL</code> outputs
through tables, figures, and maps taking advantage of other R visualisation
packages. <code>rcontroll</code> also offers the possibility to generate a virtual LIDAR
point cloud that corresponds to a snapshot of the simulated forest.
</p>


<h3>Construction and manipulation of input files</h3>

<p>As stated above, three types of input data are needed for a typical <code>TROLL</code>
simulation:   (i) climate data, (ii) plant functional traits, (iii) global
model parameters. Pre-simulation functions include global parameters
definition (<code>generate_parameters</code> function) and climate data generation
(<code>generate_climate</code> function).  <code>rcontroll</code> also includes default data for
species and climate inputs for a typical French Guiana rainforest site.  The
purpose of the <code>generate_climate</code> function with the help of the corresponding
vignette is to create <code>TROLL</code> climate inputs from ERA5-Land (Muñoz-Sabater et
al. 2021), a global climatic reanalysis dataset that is freely available. The
ERA5-Land climate reanalysis is available at 9 km spatial resolution and
hourly temporal resolution since 1950, and daily or monthly means are
available and their uncertainties reported. Therefore, <code>rcontroll</code> users only
need to input the species-specific trait data to run <code>TROLL</code> simulations,
irrespective of the site. <code>TROLL</code> was originally developed for tropical and
subtropical forests, so certain assumptions must be critically examined when
applying it outside the tropics. The input files can be used to start a
<code>TROLL</code> simulation run within the <code>rcontroll</code> environment (see below), or
saved so that the <code>TROLL</code> simulation can be started as a command line tool.
</p>


<h3>Simulations</h3>

<p>The default option is to run a <code>TROLL</code> simulation using the <code>troll</code> function
of the rcontroll package, which currently calls version 3.1.7 of <code>TROLL</code>
using the Rcpp package (Eddelbuettel &amp; François 2011). The output is stored
in a <code>trollsim</code> R class. For multiple runs, users can rely on the <code>stack</code>
function, and the output is stored in the <code>trollstack</code> class. Both <code>trollsim</code>
and <code>trollstack</code> values can be accessed using object attributes in the form
of simple R objects (with <code>@</code> in R). They consist of eight simulation
attributes: (1) name, (2) path to saved files, (3) parameters, (4) inputs,
(5) log, (6) initial and final state, (7) ecosystem output metrics, and (8)
species output metrics. The initial and final states are represented by a
table with the spatial position, size and other relevant traits of all trees
at the start and end of the simulation. The ecosystem and species metrics are
summaries of ecosystem processes and states, such as net primary production
and aboveground biomass, and they are documented at species level and
aggregated over the entire stand. Simulations can be saved using a
user-defined path when run and later loaded as a simple simulation
(<code>load_output</code> function) or a stack of simulations (<code>load_stack</code> function).
</p>


<h3>Simulated airborne lidar scanning option</h3>

<p><code>TROLL</code> also has the capacity of generating point clouds from virtual aerial
lidar scannings of simulated forest scenes. Within each cubic metre voxel of
the simulated stand, points are generated probabilistically, with the
probability depending both on the amount of light reaching the particular
voxel and the amount of leaf matter intercepting light within the voxel.
Extinction and interception of light are based on the Beer-Lambert law, but
an effective extinction factor is used to account for differences between the
near-infrared and visible light. The definition of the lidar parameters
(<code>generate_lidar</code> function) is optional but allows the user to add a virtual
aerial lidar scan for a time step of the <code>TROLL</code> simulation. When this option
is enabled, the cloud of points from simulated aerial lidar scans are stored
as LAS using the R package <code>lidR</code> (Roussel et al., 2020) as a ninth attribute
of the <code>trollsim</code> and <code>trollstack</code> objects.
</p>


<h3>Manipulation of simulation outputs</h3>

<p><code>rcontroll</code> includes functions to manipulate simulation outputs. Simulation
outputs can be retrieved directly from the <code>trollsim</code> or <code>trollstack</code>objects
and summarised or plotted in the R environment with the <code>print</code>, <code>summary</code>
and <code>autoplot</code> functions. The <code>get_chm</code> function allows users to retrieve
canopy height models from aerial lidar point clouds. In addition, a
<code>rcontroll</code> function is available to visualise TROLL simulations as an
animated figure (<code>autogif</code> function).
</p>


<h3>TROLL</h3>

<p>version 3.1.6
</p>

<hr>
<h2 id='stack'>Run a stack of <code>TROLL</code> simulations</h2><span id='topic+stack'></span>

<h3>Description</h3>

<p><code>stack()</code> run a stack of <code>TROLL</code> simulation. The minimal set of input files
required for a <code>TROLL</code> run include (i) climate data for the focal location
(<code>climate</code> and <code>daily</code>), (ii) functional traits for the list of species at
the focal location (<code>species</code>), and (iii) global parameters (<code>global</code>), i.e.
parameters that do not depend on species identity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stack(
  name = NULL,
  simulations,
  path = NULL,
  global,
  species,
  climate,
  daily,
  lidar = NULL,
  forest = NULL,
  load = TRUE,
  cores = NULL,
  verbose = TRUE,
  overwrite = TRUE,
  thin = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stack_+3A_name">name</code></td>
<td>
<p>char. Stack name (if NULL the timestamp will be used).</p>
</td></tr>
<tr><td><code id="stack_+3A_simulations">simulations</code></td>
<td>
<p>char. Simulation names (corrsponding to simulation indexes
in orresponding tables, see example below).</p>
</td></tr>
<tr><td><code id="stack_+3A_path">path</code></td>
<td>
<p>char. Path to save the stack of simulation outputs (parent
folder), the default is null corresponding to a simulation in memory
without saved intermediary files (based on temporary files from
<a href="#topic+option.rcontroll">option.rcontroll</a>).</p>
</td></tr>
<tr><td><code id="stack_+3A_global">global</code></td>
<td>
<p>df. Global parameters (e.g. <a href="#topic+TROLLv3_input">TROLLv3_input</a> or using
<code><a href="#topic+generate_parameters">generate_parameters()</a></code>).</p>
</td></tr>
<tr><td><code id="stack_+3A_species">species</code></td>
<td>
<p>df. Species parameters (e.g. <a href="#topic+TROLLv3_species">TROLLv3_species</a>).</p>
</td></tr>
<tr><td><code id="stack_+3A_climate">climate</code></td>
<td>
<p>df. Climate parameters (e.g. <a href="#topic+TROLLv3_climatedaytime12">TROLLv3_climatedaytime12</a>).</p>
</td></tr>
<tr><td><code id="stack_+3A_daily">daily</code></td>
<td>
<p>df. Daily variation parameters (e.g. <a href="#topic+TROLLv3_daytimevar">TROLLv3_daytimevar</a>).</p>
</td></tr>
<tr><td><code id="stack_+3A_lidar">lidar</code></td>
<td>
<p>df. Lidar simulation parameters (e.g. using <code><a href="#topic+generate_lidar">generate_lidar()</a></code>),
if null not computed (default NULL).</p>
</td></tr>
<tr><td><code id="stack_+3A_forest">forest</code></td>
<td>
<p>df. TROLL with forest input, if null starts from an empty grid
(default NULL) (e.g. using <a href="#topic+TROLLv3_output">TROLLv3_output</a> with <code><a href="#topic+get_forest">get_forest()</a></code>).</p>
</td></tr>
<tr><td><code id="stack_+3A_load">load</code></td>
<td>
<p>bool. TROLL outputs are loaded in R memory, if not only the path
and name of the stack of simulations is kept in the resulting
<code><a href="#topic+trollstack">trollstack()</a></code> object but the content can be accessed later using the
<code><a href="#topic+load_sim">load_sim()</a></code> method.</p>
</td></tr>
<tr><td><code id="stack_+3A_cores">cores</code></td>
<td>
<p>int. Number of cores for parallelization, if NULL available
cores - 1 (default NULL). You can use <code><a href="parallel.html#topic+detectCores">parallel::detectCores()</a></code> to know
available cores on your machine.</p>
</td></tr>
<tr><td><code id="stack_+3A_verbose">verbose</code></td>
<td>
<p>bool. Show TROLL log in the console.</p>
</td></tr>
<tr><td><code id="stack_+3A_overwrite">overwrite</code></td>
<td>
<p>bool. Overwrite previous outputs folder and files.</p>
</td></tr>
<tr><td><code id="stack_+3A_thin">thin</code></td>
<td>
<p>int. Vector of integers corresponding to the iterations to be
kept to reduce output size, default is NULL and corresponds to no thinning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+trollstack">trollstack()</a></code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+troll">troll()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("TROLLv3_species")
data("TROLLv3_climatedaytime12")
data("TROLLv3_daytimevar")
data("TROLLv3_output")
TROLLv3_input_stack &lt;- generate_parameters(
  cols = 100, rows = 100,
  iterperyear = 12, nbiter = 12 * 1
) %&gt;%
  mutate(simulation = list(c("seed50000", "seed500"))) %&gt;%
  unnest(simulation)
TROLLv3_input_stack[62, 2] &lt;- 500 # Cseedrain
stack(
  name = "teststack",
  simulations = c("seed50000", "seed500"),
  global = TROLLv3_input_stack,
  species = TROLLv3_species,
  climate = TROLLv3_climatedaytime12,
  daily = TROLLv3_daytimevar,
  load = TRUE,
  cores = 2,
  verbose = FALSE,
  thin = c(1, 5, 10)
)

## End(Not run)

</code></pre>

<hr>
<h2 id='troll'>Run a <code>TROLL</code> simulation</h2><span id='topic+troll'></span>

<h3>Description</h3>

<p><code>troll()</code> run a <code>TROLL</code> simulation. The minimal set of input files required
for a <code>TROLL</code> run include (i) climate data for the focal location (<code>climate</code>
and <code>daily</code>), (ii) functional traits for the list of species at the focal
location (<code>species</code>), and (iii) global parameters (<code>global</code>), i.e. parameters
that do not depend on species identity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>troll(
  name = NULL,
  path = NULL,
  global,
  species,
  climate,
  daily,
  lidar = NULL,
  forest = NULL,
  load = TRUE,
  verbose = TRUE,
  overwrite = TRUE,
  thin = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="troll_+3A_name">name</code></td>
<td>
<p>char. Model name (if NULL the timestamp will be used).</p>
</td></tr>
<tr><td><code id="troll_+3A_path">path</code></td>
<td>
<p>char. Path to save the simulation outputs, the default is null
corresponding to a simulation in memory without saved intermediary files
(based on temporary files from <a href="#topic+option.rcontroll">option.rcontroll</a>).</p>
</td></tr>
<tr><td><code id="troll_+3A_global">global</code></td>
<td>
<p>df. Global parameters (e.g. <a href="#topic+TROLLv3_input">TROLLv3_input</a> or using
<code><a href="#topic+generate_parameters">generate_parameters()</a></code>).</p>
</td></tr>
<tr><td><code id="troll_+3A_species">species</code></td>
<td>
<p>df. Species parameters (e.g. <a href="#topic+TROLLv3_species">TROLLv3_species</a>).</p>
</td></tr>
<tr><td><code id="troll_+3A_climate">climate</code></td>
<td>
<p>df. Climate parameters (e.g. <a href="#topic+TROLLv3_climatedaytime12">TROLLv3_climatedaytime12</a>).</p>
</td></tr>
<tr><td><code id="troll_+3A_daily">daily</code></td>
<td>
<p>df. Daily variation parameters (e.g. <a href="#topic+TROLLv3_daytimevar">TROLLv3_daytimevar</a>).</p>
</td></tr>
<tr><td><code id="troll_+3A_lidar">lidar</code></td>
<td>
<p>df. Lidar simulation parameters (e.g. using <code><a href="#topic+generate_lidar">generate_lidar()</a></code>),
if null not computed (default NULL).</p>
</td></tr>
<tr><td><code id="troll_+3A_forest">forest</code></td>
<td>
<p>df. TROLL with forest input, if null starts from an empty grid
(default NULL) (e.g. using <a href="#topic+TROLLv3_output">TROLLv3_output</a> with <code><a href="#topic+get_forest">get_forest()</a></code>).</p>
</td></tr>
<tr><td><code id="troll_+3A_load">load</code></td>
<td>
<p>bool. TROLL outputs are loaded in R memory, if not only the path
and name of the simulations is kept in the resulting <code><a href="#topic+trollsim">trollsim()</a></code> object
but the content can be accessed later using the <code><a href="#topic+load_sim">load_sim()</a></code> method.</p>
</td></tr>
<tr><td><code id="troll_+3A_verbose">verbose</code></td>
<td>
<p>bool. Show TROLL log in the console.</p>
</td></tr>
<tr><td><code id="troll_+3A_overwrite">overwrite</code></td>
<td>
<p>bool. Overwrite previous outputs folder and files.</p>
</td></tr>
<tr><td><code id="troll_+3A_thin">thin</code></td>
<td>
<p>int. Vector of integers corresponding to the iterations to be
kept to reduce output size, default is NULL and corresponds to no thinning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+trollsim">trollsim()</a></code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stack">stack()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("TROLLv3_species")
data("TROLLv3_climatedaytime12")
data("TROLLv3_daytimevar")
troll(
  name = "test",
  global = generate_parameters(
    cols = 100, rows = 100,
    iterperyear = 12, nbiter = 12 * 1
  ),
  species = TROLLv3_species,
  climate = TROLLv3_climatedaytime12,
  daily = TROLLv3_daytimevar
)


</code></pre>

<hr>
<h2 id='TROLL.version'><code>TROLL</code> version</h2><span id='topic+TROLL.version'></span>

<h3>Description</h3>

<p><code>TROLL.version()</code> prints <code>TROLL</code> version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TROLL.version()
</code></pre>


<h3>Value</h3>

<p><code>TROLL</code> version in console.
</p>


<h3>See Also</h3>

<p><a href="#topic+option.rcontroll">option.rcontroll</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
TROLL.version()

</code></pre>

<hr>
<h2 id='trollCpp'>TROLL simulator</h2><span id='topic+trollCpp'></span>

<h3>Description</h3>

<p>Wrapper of the TROLL C++ simulator with Rcpp.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trollCpp(
  global_file,
  climate_file,
  species_file,
  day_file,
  lidar_file,
  forest_file,
  output_file
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trollCpp_+3A_global_file">global_file</code></td>
<td>
<p>char. Path to the global parameters file.</p>
</td></tr>
<tr><td><code id="trollCpp_+3A_climate_file">climate_file</code></td>
<td>
<p>char. Path to the climate file.</p>
</td></tr>
<tr><td><code id="trollCpp_+3A_species_file">species_file</code></td>
<td>
<p>char. Path to the species file.</p>
</td></tr>
<tr><td><code id="trollCpp_+3A_day_file">day_file</code></td>
<td>
<p>char. Path to the daytime file.</p>
</td></tr>
<tr><td><code id="trollCpp_+3A_lidar_file">lidar_file</code></td>
<td>
<p>char. Path to the lidar file.</p>
</td></tr>
<tr><td><code id="trollCpp_+3A_forest_file">forest_file</code></td>
<td>
<p>char. Path to the forest file.</p>
</td></tr>
<tr><td><code id="trollCpp_+3A_output_file">output_file</code></td>
<td>
<p>char. Path to the output folder.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Void with outputs files written in the defined folder.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
trollCpp(global_file = "test/test_input_global.txt",
         climate_file = "test/test_input_climate.txt",
         species_file = "test/test_input_species.txt",
         day_file = "test/test_input_daily.txt",
         lidar_file = "",
         forest_file = "",
         output_file = "test")

## End(Not run)

</code></pre>

<hr>
<h2 id='trollsim'>A <code>TROLL</code> simulations</h2><span id='topic+trollsim'></span>

<h3>Description</h3>

<p><code>trollsim()</code> is an S4 class to represent a <code>TROLL</code> simulation. <code>trollsim</code>
values can be accessed using object attributes in the form of simple R
objects (with <code>@</code>). They consist of eight simulation attributes: (1) name,
(2) path to saved files, (3) parameters, (4) inputs, (5) log, (6) initial and
final state, (7) ecosystem output metrics, and (8) species output metrics.
The initial and final states are represented by a table with the spatial
position, size and other relevant traits of all trees at the start and end of
the simulation. The ecosystem and species metrics are summaries of ecosystem
processes and states, such as net primary production and aboveground biomass,
and they are documented at species level and aggregated over the entire
stand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trollsim(
  name = character(),
  path = character(),
  mem = logical(),
  parameters = numeric(),
  inputs = list(),
  log = character(),
  forest = data.frame(),
  ecosystem = data.frame(),
  species = data.frame(),
  las = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trollsim_+3A_name">name</code></td>
<td>
<p>char. Simulation name.</p>
</td></tr>
<tr><td><code id="trollsim_+3A_path">path</code></td>
<td>
<p>char. File path to the stack of simulation (parent folder).</p>
</td></tr>
<tr><td><code id="trollsim_+3A_mem">mem</code></td>
<td>
<p>bool. Is the simulation in memory, see <code><a href="#topic+load_sim">load_sim()</a></code>.</p>
</td></tr>
<tr><td><code id="trollsim_+3A_parameters">parameters</code></td>
<td>
<p>numeric. Parameters of the simulation (general inputs).</p>
</td></tr>
<tr><td><code id="trollsim_+3A_inputs">inputs</code></td>
<td>
<p>list. Simulation inputs (species, climate, daily, forest,
lidar, see <code><a href="#topic+troll">troll()</a></code>).</p>
</td></tr>
<tr><td><code id="trollsim_+3A_log">log</code></td>
<td>
<p>chr. Simulation log, see <code><a href="#topic+get_log">get_log()</a></code>.</p>
</td></tr>
<tr><td><code id="trollsim_+3A_forest">forest</code></td>
<td>
<p>df. Simulation initial and final forest, see <code><a href="#topic+get_forest">get_forest()</a></code>.</p>
</td></tr>
<tr><td><code id="trollsim_+3A_ecosystem">ecosystem</code></td>
<td>
<p>df. Ecosystem metrics.</p>
</td></tr>
<tr><td><code id="trollsim_+3A_species">species</code></td>
<td>
<p>df. Species metrics (with OUTPUT_extended option, see
<code><a href="#topic+generate_parameters">generate_parameters()</a></code>).</p>
</td></tr>
<tr><td><code id="trollsim_+3A_las">las</code></td>
<td>
<p>list. List with simulated point cloud in LAS from lidar parameters
(with lidar option, see <code><a href="#topic+generate_lidar">generate_lidar()</a></code>). The LAS format correspond to
<code><a href="lidR.html#topic+LAS-class">lidR::LAS()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An empty S4 <code><a href="#topic+trollsim">trollsim()</a></code> class object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+load_output">load_output()</a></code>, <code><a href="#topic+trollstack">trollstack()</a></code>
</p>

<hr>
<h2 id='trollsim-class'>A <code>TROLL</code> simulations</h2><span id='topic+trollsim-class'></span>

<h3>Description</h3>

<p><code>trollsim()</code> is an S4 class to represent a <code>TROLL</code> simulation. <code>trollsim</code>
values can be accessed using object attributes in the form of simple R
objects (with <code>@</code>). They consist of eight simulation attributes: (1) name,
(2) path to saved files, (3) parameters, (4) inputs, (5) log, (6) initial and
final state, (7) ecosystem output metrics, and (8) species output metrics.
The initial and final states are represented by a table with the spatial
position, size and other relevant traits of all trees at the start and end of
the simulation. The ecosystem and species metrics are summaries of ecosystem
processes and states, such as net primary production and aboveground biomass,
and they are documented at species level and aggregated over the entire
stand.
</p>


<h3>Value</h3>

<p>An empty S4 <code><a href="#topic+trollsim">trollsim()</a></code> class object.
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>char. Simulation name.</p>
</dd>
<dt><code>path</code></dt><dd><p>char. File path to the simulation.</p>
</dd>
<dt><code>mem</code></dt><dd><p>bool. Is the simulation in memory, see <code><a href="#topic+load_sim">load_sim()</a></code>.</p>
</dd>
<dt><code>parameters</code></dt><dd><p>numeric. Parameters of the simulation (general inputs).</p>
</dd>
<dt><code>inputs</code></dt><dd><p>list. Simulation inputs (species, climate, daily, forest, lidar,
see <code><a href="#topic+stack">stack()</a></code>).</p>
</dd>
<dt><code>log</code></dt><dd><p>chr. Simulation log, see <code><a href="#topic+get_log">get_log()</a></code>.</p>
</dd>
<dt><code>forest</code></dt><dd><p>df. Simulation initial and final forest, see <code><a href="#topic+get_forest">get_forest()</a></code>.</p>
</dd>
<dt><code>ecosystem</code></dt><dd><p>df. Ecosystem metrics.</p>
</dd>
<dt><code>species</code></dt><dd><p>df. Species metrics (with OUTPUT_extended option, see
<code><a href="#topic+generate_parameters">generate_parameters()</a></code>).</p>
</dd>
<dt><code>las</code></dt><dd><p>list. List with simulated point cloud in LAS from lidar parameters
(with lidar option, see <code><a href="#topic+generate_lidar">generate_lidar()</a></code>). The LAS format correspond to
<code><a href="lidR.html#topic+LAS-class">lidR::LAS()</a></code>.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+load_output">load_output()</a></code>, <code><a href="#topic+trollstack">trollstack()</a></code>
</p>

<hr>
<h2 id='trollstack'>A stack of <code>TROLL</code> simulations</h2><span id='topic+trollstack'></span>

<h3>Description</h3>

<p><code>trollstack()</code> is an S4 class to represent a stack of <code>TROLL</code> simulation.
<code>trollstack</code> values can be accessed using object attributes in the form of
simple R objects (with <code>@</code>). They consist of eight simulation attributes: (1)
name, (2) path to saved files, (3) parameters, (4) inputs, (5) log, (6)
initial and final state, (7) ecosystem output metrics, and (8) species output
metrics. The initial and final states are represented by a table with the
spatial position, size and other relevant traits of all trees at the start
and end of the simulation. The ecosystem and species metrics are summaries of
ecosystem processes and states, such as net primary production and
aboveground biomass, and they are documented at species level and aggregated
over the entire stand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trollstack(
  name = character(),
  path = character(),
  mem = logical(),
  parameters = numeric(),
  inputs = list(),
  log = character(),
  forest = data.frame(),
  ecosystem = data.frame(),
  species = data.frame(),
  las = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trollstack_+3A_name">name</code></td>
<td>
<p>char. Simulation name.</p>
</td></tr>
<tr><td><code id="trollstack_+3A_path">path</code></td>
<td>
<p>char. File path to the stack of simulation (parent folder).</p>
</td></tr>
<tr><td><code id="trollstack_+3A_mem">mem</code></td>
<td>
<p>bool. Is the simulation in memory, see <code><a href="#topic+load_sim">load_sim()</a></code>.</p>
</td></tr>
<tr><td><code id="trollstack_+3A_parameters">parameters</code></td>
<td>
<p>numeric. Parameters of the simulation (general inputs).</p>
</td></tr>
<tr><td><code id="trollstack_+3A_inputs">inputs</code></td>
<td>
<p>list. Simulation inputs (species, climate, daily, forest,
lidar, see <code><a href="#topic+stack">stack()</a></code>).</p>
</td></tr>
<tr><td><code id="trollstack_+3A_log">log</code></td>
<td>
<p>chr. Simulation log, see <code><a href="#topic+get_log">get_log()</a></code>.</p>
</td></tr>
<tr><td><code id="trollstack_+3A_forest">forest</code></td>
<td>
<p>df. Simulation initial and final forest, see <code><a href="#topic+get_forest">get_forest()</a></code>.</p>
</td></tr>
<tr><td><code id="trollstack_+3A_ecosystem">ecosystem</code></td>
<td>
<p>df. Ecosystem metrics.</p>
</td></tr>
<tr><td><code id="trollstack_+3A_species">species</code></td>
<td>
<p>df. Species metrics (with OUTPUT_extended option, see
<code><a href="#topic+generate_parameters">generate_parameters()</a></code>).</p>
</td></tr>
<tr><td><code id="trollstack_+3A_las">las</code></td>
<td>
<p>list. List with simulated point cloud in LAS from lidar parameters
(with lidar option, see <code><a href="#topic+generate_lidar">generate_lidar()</a></code>). The LAS format correspond to
<code><a href="lidR.html#topic+LAS-class">lidR::LAS()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An empty S4 <code><a href="#topic+trollstack">trollstack()</a></code> class object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stack">stack()</a></code>, <code><a href="#topic+load_stack">load_stack()</a></code>, <code><a href="#topic+trollsim">trollsim()</a></code>
</p>

<hr>
<h2 id='trollstack-class'>A stack of <code>TROLL</code> simulations</h2><span id='topic+trollstack-class'></span>

<h3>Description</h3>

<p><code>trollstack()</code> is an S4 class to represent a stack of <code>TROLL</code> simulation.
<code>trollstack</code> values can be accessed using object attributes in the form of
simple R objects (with <code>@</code>). They consist of eight simulation attributes: (1)
name, (2) path to saved files, (3) parameters, (4) inputs, (5) log, (6)
initial and final state, (7) ecosystem output metrics, and (8) species output
metrics. The initial and final states are represented by a table with the
spatial position, size and other relevant traits of all trees at the start
and end of the simulation. The ecosystem and species metrics are summaries of
ecosystem processes and states, such as net primary production and
aboveground biomass, and they are documented at species level and aggregated
over the entire stand.
</p>

<hr>
<h2 id='TROLLv3_climatedaytime12'><code>TROLL</code> climate parameters over months</h2><span id='topic+TROLLv3_climatedaytime12'></span>

<h3>Description</h3>

<p>Climate parameters used by <code>TROLL</code> model over months.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TROLLv3_climatedaytime12
</code></pre>


<h3>Format</h3>

<p>A data frame with 12 rows and 12 variables: </p>

<dl>
<dt>Temperature</dt><dd><p>monthly average of temperature (degree C)</p>
</dd>
<dt>DaytimeMeanTemperature</dt><dd><p>the monthly average of daytime temperature
(degree C, 7am-7pm)</p>
</dd> <dt>NightTemperature</dt><dd><p>the monthly average of
temperature at night  (degree C, 8pm-6am)</p>
</dd> <dt>Rainfall</dt><dd><p>monthly average
of cumulative rainfall (cm)</p>
</dd> <dt>WindSpeed</dt><dd><p>monthly average of wind speed
(m/s)</p>
</dd> <dt>DaytimeMeanIrradiance</dt><dd><p>monthly average of cumulative solar
irradiance averaged over one day (W/m2, 7am-7pm)</p>
</dd>
<dt>MeanIrradiance</dt><dd><p>monthly average of cumulative solar irradiance over
24 hours (W/m2)</p>
</dd> <dt>SaturatedVapourPressure</dt><dd><p>monthly average of
saturation vapour pressure (hPa)</p>
</dd> <dt>VapourPressure</dt><dd><p>monthly average of
vapour pressur (hPa)</p>
</dd> <dt>VaporPressureDeficit</dt><dd><p>monthly average of vapour
pressure deficit (VPD, hPa)</p>
</dd>
<dt>DayTimeVapourPressureDeficitVPDbasic</dt><dd><p>monthly average of daytime
vapour pressure deficit (7am-7pm) according to basic formula (hPa)</p>
</dd>
<dt>DaytimeMeanVapourPressureDeficit</dt><dd><p>monthly average of daytime vapour
pressure deficit (7am-7pm) according to advanced formula (hPa)</p>
</dd> </dl>



<h3>See Also</h3>

<p><code><a href="#topic+generate_climate">generate_climate()</a></code>, <a href="#topic+TROLLv3_daytimevar">TROLLv3_daytimevar</a>
</p>

<hr>
<h2 id='TROLLv3_daytimevar'><code>TROLL</code> daytime variation parameters</h2><span id='topic+TROLLv3_daytimevar'></span>

<h3>Description</h3>

<p>Daytime variation parameters used by <code>TROLL</code>s models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TROLLv3_daytimevar
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 5 variables: </p>

<dl>
<dt>starttime</dt><dd><p>starting time</p>
</dd> <dt>endtime</dt><dd><p>ending time</p>
</dd>
<dt>vardaytime_light</dt><dd><p>daily variation in irradiance relative to the mean
value of the day</p>
</dd> <dt>vardaytime_vpd</dt><dd><p>daily variation in vapour pressure
deficit relative to the mean value of the day</p>
</dd> <dt>vardaytime_T</dt><dd><p>daily
variation in temperature relative to the mean value of the day</p>
</dd></dl>



<h3>See Also</h3>

<p><code><a href="#topic+generate_climate">generate_climate()</a></code>, <a href="#topic+TROLLv3_climatedaytime12">TROLLv3_climatedaytime12</a>
</p>

<hr>
<h2 id='TROLLv3_input'><code>TROLL</code> global parameters</h2><span id='topic+TROLLv3_input'></span>

<h3>Description</h3>

<p>Global parameters definition used by <code>TROLL</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TROLLv3_input
</code></pre>


<h3>Format</h3>

<p>A data frame with 61 rows and 3 variables: </p>

<dl>
<dt>param</dt><dd><p>global parameter</p>
</dd> <dt>value</dt><dd><p>value of the parameter</p>
</dd>
<dt>description</dt><dd><p>description of the parameter</p>
</dd> </dl>



<h3>See Also</h3>

<p><code><a href="#topic+generate_parameters">generate_parameters()</a></code>
</p>

<hr>
<h2 id='TROLLv3_output'><code>TROLL</code> output</h2><span id='topic+TROLLv3_output'></span>

<h3>Description</h3>

<p><code>TROLL</code> outputs from a 100-year simulation on a 100x100 grid with the other
default parameters and using TROLLv3_species, TROLLv3_climatedaytime12, and
TROLLv3_daytimevar for use in tests and examples. Ecosystem level output has
been thinned and species output has been removed to save disk space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TROLLv3_output
</code></pre>


<h3>Format</h3>

<p>A <code><a href="#topic+trollsim">trollsim()</a></code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TROLLv3_species">TROLLv3_species()</a></code>, <code><a href="#topic+TROLLv3_climatedaytime12">TROLLv3_climatedaytime12()</a></code>,
<code><a href="#topic+TROLLv3_daytimevar">TROLLv3_daytimevar()</a></code>, <code><a href="#topic+troll">troll()</a></code>
</p>

<hr>
<h2 id='TROLLv3_pointcloud'><code>TROLL</code> lidar parameters</h2><span id='topic+TROLLv3_pointcloud'></span>

<h3>Description</h3>

<p>Lidar parameters definition used by <code>TROLL</code> for lidar simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TROLLv3_pointcloud
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 rows and 3 variables: </p>

<dl>
<dt>param</dt><dd><p>lidar parameter</p>
</dd> <dt>value</dt><dd><p>value of the parameter</p>
</dd>
<dt>description</dt><dd><p>description of the parameter</p>
</dd> </dl>



<h3>See Also</h3>

<p><code><a href="#topic+generate_lidar">generate_lidar()</a></code>
</p>

<hr>
<h2 id='TROLLv3_species'><code>TROLL</code> species parameters</h2><span id='topic+TROLLv3_species'></span>

<h3>Description</h3>

<p>Functional traits used by <code>TROLL</code> model for 45 species in French Guiana.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TROLLv3_species
</code></pre>


<h3>Format</h3>

<p>A data frame with 45 rows and 12 variables: </p>

<dl>
<dt>s_name</dt><dd><p>Species name genus_species</p>
</dd> <dt>s_LMA</dt><dd><p>leaf mass per area</p>
</dd>
<dt>s_Nmass</dt><dd><p>leaf nitrogen mass</p>
</dd> <dt>s_Pmass</dt><dd><p>leaf phosphorus mass</p>
</dd>
<dt>s_wsg</dt><dd><p>wood specific gravity</p>
</dd> <dt>s_dbhmax</dt><dd><p>maximum diameter</p>
</dd>
<dt>s_hmax</dt><dd><p>maximum height</p>
</dd> <dt>s_ah</dt><dd><p>height-diameter allometry
coefficient</p>
</dd> <dt>s_regionalfreq</dt><dd><p>regional frequency</p>
</dd> <dt>s_tlp</dt><dd><p>Turgor
loss point</p>
</dd> <dt>s_drymass</dt><dd><p>leaf dry mass</p>
</dd> <dt>s_seedmass</dt><dd><p>seed mass</p>
</dd> </dl>



<h3>See Also</h3>

<p><code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>
</p>

<hr>
<h2 id='update_parameters'>Update global parameters</h2><span id='topic+update_parameters'></span><span id='topic+update_parameters+2Ctrollsim-method'></span>

<h3>Description</h3>

<p><code>update_parameters()</code> update the global parameters used in the <code>TROLL</code>
simulation from a TROLL outputs for a next simulation. All parameters have a
default value used in French Guiana simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_parameters(sim, ...)

## S4 method for signature 'trollsim'
update_parameters(sim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_parameters_+3A_sim">sim</code></td>
<td>
<p>trollsim.</p>
</td></tr>
<tr><td><code id="update_parameters_+3A_...">...</code></td>
<td>
<p>parameters to update and their values (see <code><a href="#topic+generate_parameters">generate_parameters()</a></code>
for a complete list).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+data.frame">data.frame()</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+troll">troll()</a></code>, <code><a href="#topic+stack">stack()</a></code>, <code><a href="#topic+generate_parameters">generate_parameters()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("TROLLv3_output")
head(update_parameters(TROLLv3_output, iters = 10))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
