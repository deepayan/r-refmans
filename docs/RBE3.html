<!DOCTYPE html><html><head><title>Help for package RBE3</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RBE3}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BE3'>
<p>The Generalized Beta Distribution</p></a></li>
<li><a href='#BE3.backward'>
<p>backward stepwise regression for RBE3 model based on the AIC criterion or significance.</p></a></li>
<li><a href='#gumbel2'><p>The Gumbel2 distribution</p></a></li>
<li><a href='#ML.BE3'>
<p>Perform the parameter estimation for the Generalized beta distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation and Additional Tools for Quantile Generalized Beta
Regression Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Diego Gallardo [aut, cre],
  Marcelo Bourguignon [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Diego Gallardo &lt;dgallardo@ubiobio.cl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provide estimation and data generation tools for the quantile generalized beta 
        regression model. For details, see Bourguignon, Gallardo and Saulo &lt;<a href="https://arxiv.org/abs/2110.04428">arXiv:2110.04428</a>&gt;
        The package also provides tools to perform covariates selection.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>pracma, gtools</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-19 23:53:36 UTC; Diego</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-20 09:40:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='BE3'>
The Generalized Beta Distribution
</h2><span id='topic+dBE3'></span><span id='topic+pBE3'></span><span id='topic+qBE3'></span><span id='topic+rBE3'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the generalized beta distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dBE3(x, mu = 0.5, alpha = 1, beta = 1, tau = 0.5, log = FALSE)
pBE3(q, mu = 0.5, alpha = 1, beta = 1, tau = 0.5, lower.tail = TRUE, log.p = FALSE)
qBE3(p, mu = 0.5, alpha = 1, beta = 1, tau = 0.5)
rBE3(n, mu = 0.5, alpha = 1, beta = 1, tau = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BE3_+3A_x">x</code>, <code id="BE3_+3A_q">q</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="BE3_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="BE3_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="BE3_+3A_mu">mu</code></td>
<td>

<p>vector of <code class="reqn">\tau</code>-quantiles of the distribution.
</p>
</td></tr>
<tr><td><code id="BE3_+3A_alpha">alpha</code>, <code id="BE3_+3A_beta">beta</code></td>
<td>

<p>shape parameters of the distribution
</p>
</td></tr>
<tr><td><code id="BE3_+3A_tau">tau</code></td>
<td>

<p>corresponding quantile of the distribution (<code class="reqn">0&lt;\tau&lt;1</code>)</p>
</td></tr>
<tr><td><code id="BE3_+3A_log">log</code>, <code id="BE3_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities <code class="reqn">p</code> are given as <code class="reqn">\log p</code>.
</p>
</td></tr>
<tr><td><code id="BE3_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are <code class="reqn">P[X\leq x]</code> otherwise, <code class="reqn">P[X&gt;x]</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability density function for the generalized beta distribution is
</p>
<p style="text-align: center;"><code class="reqn">
f(y;\lambda,\alpha,\beta)=\frac{\lambda^\alpha y^{\alpha-1}(1-y)^{\beta-1}}{B(\alpha, \beta)[1-(1-\lambda)y]^{\alpha+\beta}}, \quad 0&lt;y&lt;1, 
</code>
</p>

<p>where <code class="reqn">\alpha, \beta&gt;0</code> and <code class="reqn">\lambda&gt;0</code>.
We consider the reparameterization in terms of the <code class="reqn">\tau</code>-quantile of the distribution, say <code class="reqn">0&lt;\mu&lt;1</code>, taking 
</p>
<p style="text-align: center;"><code class="reqn">
\lambda=\frac{(1-\mu)}{\mu}\frac{z_{\alpha,\beta}(\tau)}{[1-z_{\alpha,\beta}(\tau)]},
</code>
</p>

<p>with <code class="reqn">z_{\alpha,\beta}(\tau)</code> denoting the <code class="reqn">\tau</code>-quantile of the usual beta distribution with shape parameters <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>. 
The cumulative distribution function is given by
</p>
<p style="text-align: center;"><code class="reqn">
F(y;\lambda,\alpha,\beta)=I_{\lambda x/(1+\lambda x -x)}(\alpha, \beta), \quad 0&lt;y&lt;1,
</code>
</p>

<p>where <code class="reqn">I_x(\alpha,\beta)=B_x(\alpha,\beta)/B(\alpha,\beta)</code> is the incomplete beta funcion ratio, <code class="reqn">B_x(\alpha,\beta)=\int_0^x w^{\alpha-1}(1-w)^{\beta-1}dw</code> 
is the incomplete beta function and <code class="reqn">B(\alpha,\beta)=\Gamma(\alpha)\Gamma(\beta)/\Gamma(\alpha+\beta)</code> is the ordinary beta function.
The quantile of the distribution can be represented as
</p>
<p style="text-align: center;"><code class="reqn">
q(\tau;\lambda,\alpha,\beta)=\frac{z_{\alpha,\beta}(\tau)}{\lambda[1-z_{\alpha,\beta}(\tau)]+z_{\alpha,\beta}(\tau)}, \quad 0&lt;\tau&lt;1.
</code>
</p>

<p>Random generation can be performed using the stochastic representation of the model. If <code class="reqn">X_1 \sim \mbox{Gamma}(\alpha,\theta_1)</code> and 
<code class="reqn">X_2 \sim \mbox{Gamma}(\beta,\theta_2)</code>, then
</p>
<p style="text-align: center;"><code class="reqn">
\frac{X_1}{X_1+X_2}\sim GB3(\alpha,\beta,\lambda),
</code>
</p>

<p>where <code class="reqn">\lambda=\theta_1/\theta_2.</code>
</p>


<h3>Value</h3>

<p>dBE3 gives the density, pBE3 gives the distribution function, qBE3 gives the quantile function, and rBE3 generates random deviates.
</p>
<p>The length of the result is determined by n for rBE3, and is the maximum of the lengths of the numerical arguments for the other functions.
</p>
<p>The numerical arguments other than n are recycled to the length of the result. Only the first elements of the logical arguments are used.
</p>


<h3>Author(s)</h3>

<p>Diego Gallardo and Marcelo Bourguignon
</p>


<h3>References</h3>

<p>Libby, D. L. and Novick, M. R. (1982). Multivariate generalized beta-distributions with applications
to utility assessment. Journal of Educational Statistics, 7.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rBE3(20, mu=0.5, alpha=2, beta=1)
dBE3(c(0.4,0.7), mu=0.5, alpha=2, beta=1)
pBE3(c(0.4,0.7), mu=0.5, alpha=2, beta=1)
</code></pre>

<hr>
<h2 id='BE3.backward'>
backward stepwise regression for RBE3 model based on the AIC criterion or significance.
</h2><span id='topic+BE3.backward.crit'></span>

<h3>Description</h3>

<p>BE3.backward.crit implements the covariates selection based on backward and the Akaike's information criteria (AIC).
BE3.backward.sign implements the covariates selection based on backward and significance of the covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BE3.backward.crit(data, tau = 0.5, link.mu = "logit")

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BE3.backward_+3A_data">data</code></td>
<td>

<p>a list containing the response vector (<code class="reqn">y</code>), and the matrices to model <code class="reqn">\mu</code>, the <code class="reqn">\tau</code>-quantile of distribution,
and the shape parameters <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>, labeled as <code class="reqn">Z_1, Z_2</code> and <code class="reqn">Z_3</code>, respectively.
</p>
</td></tr>
<tr><td><code id="BE3.backward_+3A_tau">tau</code></td>
<td>

<p>the quantile of the distribution to be modelled (<code class="reqn">0&lt;\tau&lt;1</code>).
</p>
</td></tr>
<tr><td><code id="BE3.backward_+3A_link.mu">link.mu</code></td>
<td>

<p>link function to be used for <code class="reqn">\mu</code>: logit (default), probit, loglog or cloglog. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containg the covariates to be included for modelling <code class="reqn">\mu</code>, <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>, respectively.
</p>


<h3>Author(s)</h3>

<p>Diego Gallardo and Marcelo Bourguignon.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Simulating two covariates
set.seed(2100)
x1&lt;-rnorm(200); x2&lt;-rbinom(200, size=1, prob=0.5)
##Desing matrices: Z1 includes x1 and x2, 
##Z2 includes only x1 and Z3 includes only x2
Z1=model.matrix(~x1+x2);Z2=model.matrix(~x1);Z3=model.matrix(~x2)
##Fixing parameters
theta=c(1, 0.2, -0.5); nu=c(0.5,-0.2); eta=c(-0.5, 0.3); tau=0.4
mu=plogis(Z1%*%theta); alpha=exp(Z2%*%nu); beta=exp(Z3%*%eta)
y=rBE3(200, mu, alpha, beta, tau=tau)
data=list(y=y, Z1=Z1, Z2=Z2, Z3=Z3)
BE3.backward.crit(data, tau = tau)
</code></pre>

<hr>
<h2 id='gumbel2'>The Gumbel2 distribution
</h2><span id='topic+dgumbel2'></span><span id='topic+pgumbel2'></span><span id='topic+qgumbel2'></span>

<h3>Description</h3>

<p>Density, distribution function and quantile function for the Gumbel2 distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgumbel2(x, log=FALSE)
pgumbel2(q)
qgumbel2(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gumbel2_+3A_x">x</code>, <code id="gumbel2_+3A_q">q</code></td>
<td>

<p>Vector of quantiles.
</p>
</td></tr>
<tr><td><code id="gumbel2_+3A_p">p</code></td>
<td>

<p>Vector of probabilities.
</p>
</td></tr>
<tr><td><code id="gumbel2_+3A_log">log</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cumulative distribution function for the Gumbel2 distribution is given by <code class="reqn">F(x)=1-exp(-exp(x)).</code>
</p>


<h3>Value</h3>

<p>dgumbel2 gives the density, pgumbel2 gives the distribution function and qgumbel2 gives the quantile function.
</p>
<p>The length of the result is determined by the maximum of the lengths of the numerical arguments.
</p>


<h3>Author(s)</h3>

<p>Diego Gallardo and Marcelo Bourguignon.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dgumbel2(c(4,10))
pgumbel2(c(4,10))
qgumbel2(c(0.1, 0.5))
</code></pre>

<hr>
<h2 id='ML.BE3'>
Perform the parameter estimation for the Generalized beta distribution
</h2><span id='topic+ML.BE3'></span>

<h3>Description</h3>

<p>ML.BE3 computes the maximum likelihood estimates based on the maximum likelihood method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ML.BE3(data, tau = 0.5, link.mu = "logit")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ML.BE3_+3A_data">data</code></td>
<td>

<p>a list containing the response vector (<code class="reqn">y</code>), and the matrices to model <code class="reqn">\mu</code>, the <code class="reqn">\tau</code>-quantile of distribution,
and the shape parameters <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>, labeled as <code class="reqn">Z_1, Z_2</code> and <code class="reqn">Z_3</code>, respectively.
</p>
</td></tr>
<tr><td><code id="ML.BE3_+3A_tau">tau</code></td>
<td>

<p>the quantile of the distribution to be modelled (<code class="reqn">0&lt;\tau&lt;1</code>).
</p>
</td></tr>
<tr><td><code id="ML.BE3_+3A_link.mu">link.mu</code></td>
<td>

<p>link function to be used for <code class="reqn">\mu</code>: logit (default), probit, loglog or cloglog. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Covariates are included as <code class="reqn">g_1(\mu_i(\tau))=\mathbf{Z}_{1i}^\top {\bm \theta}(\tau)</code>, <code class="reqn">g_2(\alpha_i(\tau))=\mathbf{Z}_{2i}^\top {\bm \nu}(\tau)</code>
and <code class="reqn">g_3(\beta_i(\tau))=\mathbf{Z}_{3i}^\top {\bm \eta}(\tau)</code>, where <code class="reqn">{\bm \theta}(\tau)=(\theta_1(\tau),\ldots,\theta_{r_1}(\tau))</code>,
<code class="reqn">{\bm \nu}(\tau)=(\nu_1(\tau),\ldots,\nu_{r_2}(\tau))</code> and <code class="reqn">{\bm \eta}(\tau)=(\eta_1(\tau),\ldots,\eta_{r_3}(\tau))</code>, where <code class="reqn">r_1, r_2</code> and <code class="reqn">r_3</code>
are the dimensions of <code class="reqn">Z_1, Z_2</code> and <code class="reqn">Z_3</code>, respectively. 
Initial values for <code class="reqn">{\bm \theta}(\tau)</code> are used as the coefficients for the linear regresion in <code class="reqn">\mbox{logit}(y_i)</code> using the elements of 
<code class="reqn">\mathbf{Z}_{1i}^\top</code> as regressors. Initial values for the other coefficients are considered as zeros.
</p>


<h3>Value</h3>

<p>a list containing the following elements
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p>A matrix with the estimates </p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>The maximum likelihood values attached by the estimates parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Diego Gallardo and Marcelo Bourguignon.
</p>


<h3>References</h3>

<p>Bourguignon, M., Gallardo, D.I., Saulo, H. (2023) A parametric quantile beta regression for modeling case fatality rates of COVID-19. Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Simulating two covariates
set.seed(2100)
x1&lt;-rnorm(200); x2&lt;-rbinom(200, size=1, prob=0.5)
##Desing matrices: Z1 includes x1 and x2, 
##Z2 includes only x1 and Z3 includes only x2
Z1=model.matrix(~x1+x2);Z2=model.matrix(~x1);Z3=model.matrix(~x2)
##Fixing parameters
theta=c(1, 0.2, -0.5); nu=c(0.5,-0.2); eta=c(-0.5, 0.3); tau=0.4
mu=plogis(Z1%*%theta); alpha=exp(Z2%*%nu); beta=exp(Z3%*%eta)
y=rBE3(200, mu, alpha, beta, tau=tau)
data=list(y=y, Z1=Z1, Z2=Z2, Z3=Z3)
ML.BE3(data, tau=tau)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
