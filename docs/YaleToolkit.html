<!DOCTYPE html><html><head><title>Help for package YaleToolkit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {YaleToolkit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#big.read.table'><p>Read in chunks from a large file with row/column filtering</p>
to obtain a reasonable-sized data.frame.</a></li>
<li><a href='#getnrows'><p>Get the number of rows of the file</p></a></li>
<li><a href='#nasa'><p>Pressure and High Cloud Cover Spatially Distributed Time Series</p></a></li>
<li><a href='#sparkline'><p>Draws a sparkline</p></a></li>
<li><a href='#sparklines'><p>Draws a panel of vertically stacked sparklines</p></a></li>
<li><a href='#sparkmat'><p>Draws a sparkmat</p></a></li>
<li><a href='#whatis'><p>Data frame summary</p></a></li>
<li><a href='#YaleEnergy'><p>Monthly energy consumption of Yale residential colleges.</p></a></li>
<li><a href='#YaleToolkit'><p>Data exploration tools from the Department of Statistics at Yale University</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>4.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-09</td>
</tr>
<tr>
<td>Title:</td>
<td>Data Exploration Tools from Yale University</td>
</tr>
<tr>
<td>Author:</td>
<td>John W. Emerson and Walton A. Green</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John W. Emerson &lt;john.emerson@yale.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>grid, utils</td>
</tr>
<tr>
<td>Imports:</td>
<td>foreach, iterators</td>
</tr>
<tr>
<td>Description:</td>
<td>This collection of data exploration tools was developed at
    Yale University for the graphical exploration of complex
    multivariate data; barcode and gpairs now have their own
    packages.  The big.read.table() function provided here may be
    useful for large files when only a subset is needed (but please
    see the note in the help page for this function).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>(C) 2022 John W. Emerson and Walton Green</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-09 17:06:20 UTC; jay</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-09 17:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='big.read.table'>Read in chunks from a large file with row/column filtering
to obtain a reasonable-sized data.frame.</h2><span id='topic+big.read.table'></span>

<h3>Description</h3>

<p>Read in chunks from a large file with row/column filtering
to obtain a reasonable-sized data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>big.read.table(
  file,
  nrows = 1e+05,
  sep = ",",
  header = TRUE,
  row.names = NULL,
  cols = NULL,
  rowfilter = NULL,
  as.is = TRUE,
  estimate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="big.read.table_+3A_file">file</code></td>
<td>
<p>the name of the file, obviously</p>
</td></tr>
<tr><td><code id="big.read.table_+3A_nrows">nrows</code></td>
<td>
<p>the chunk size; consider reducing this if there are
lots of columns</p>
</td></tr>
<tr><td><code id="big.read.table_+3A_sep">sep</code></td>
<td>
<p>by default we expect a CSV file</p>
</td></tr>
<tr><td><code id="big.read.table_+3A_header">header</code></td>
<td>
<p>is <code>TRUE</code> by default</p>
</td></tr>
<tr><td><code id="big.read.table_+3A_row.names">row.names</code></td>
<td>
<p>I really dislike row names</p>
</td></tr>
<tr><td><code id="big.read.table_+3A_cols">cols</code></td>
<td>
<p>for filtering column by name or number (supporting negative indexing)</p>
</td></tr>
<tr><td><code id="big.read.table_+3A_rowfilter">rowfilter</code></td>
<td>
<p>a function that is assumed to take a chunk as a
data frame and return a smaller data frame (with fewer rows), separately
from the column filtering.</p>
</td></tr>
<tr><td><code id="big.read.table_+3A_as.is">as.is</code></td>
<td>
<p><code>TRUE</code> by default</p>
</td></tr>
<tr><td><code id="big.read.table_+3A_estimate">estimate</code></td>
<td>
<p>do a preliminary estimation of the work to be done,
and then have a chance to bail out if it looks like a bad idea</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is very much 'in development' and could be buggy.  I put it here
as I used some example in one of my courses, but then I needed to update
the package to keep CRAN happy.  So here it is.  Buyer Beware.  - Jay
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CO2)
write.csv(CO2, "CO2.csv", row.names=FALSE)
x &lt;- big.read.table("CO2.csv", nrows=10)
unlink("CO2.csv")
head(x)
</code></pre>

<hr>
<h2 id='getnrows'>Get the number of rows of the file</h2><span id='topic+getnrows'></span>

<h3>Description</h3>

<p>Use iterators to avoid the memory overhead of
obtaining the number of rows of a file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getnrows(file, n = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getnrows_+3A_file">file</code></td>
<td>
<p>the name of a file (possible with a path)</p>
</td></tr>
<tr><td><code id="getnrows_+3A_n">n</code></td>
<td>
<p>the size of the chunks used by the iterator</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an integer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CO2)
write.csv(CO2, "CO2.csv", row.names=FALSE)
getnrows("CO2.csv")
unlink("CO2.csv")
</code></pre>

<hr>
<h2 id='nasa'>Pressure and High Cloud Cover Spatially Distributed Time Series</h2><span id='topic+nasa'></span>

<h3>Description</h3>

<p>Six years of monthly pressure and high cloud cover measurements over a regular
grid of the Americas, from NASA's poster competition at the 2006 Joint Statistical Meeting (JSM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nasa)</code></pre>


<h3>Format</h3>

<p>This NASA data set is stored as a list
of 3 components: <code>data</code> (containing the pressure and high cloud cover measurements),
<code>elev</code> (the elevation data), and <code>coast</code> (the coastline data).  To see the structure, type
<code>str(nasa)</code>, and see <code>Details</code> and <code>Source</code> for more information, below.
</p>


<h3>Details</h3>

<p>The data are a subset of some geographic and atmospheric measurements on a coarse 24 by 24 grid covering Central America. The variables included are elevation, air pressure, and high cloud cover. With the exception of elevation, the variables are monthly averages, with observations for Jan., 1995 to Dec., 2000. These data were obtained from the NASA Langley Research Center Atmospheric Sciences Data Center.
</p>


<h3>Source</h3>

<p>NASA Langley Research Center Atmospheric Sciences Data Center, with permission.  The JSM poster competition was announced at:
</p>
<p>http://www.amstat-online.org/sections/graphics/dataexpo/2006.php
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # See sparkmat().
</code></pre>

<hr>
<h2 id='sparkline'>Draws a sparkline</h2><span id='topic+sparkline'></span>

<h3>Description</h3>

<p>Draws a times series or &lsquo;sparkline&rsquo; in a compact iconic fashion suitable for inclusion in more complex graphics or text.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparkline(s, times = NULL, ylim = NULL, buffer = unit(0, "lines"),
          margins = NULL, IQR = NULL, yaxis = FALSE, xaxis = FALSE,
          ptopts = list(points = NULL, labels = NULL, labels.ch = NULL,
          gp = NULL, just = NULL, pch = NULL), margin.pars = NULL,
          buffer.pars = NULL, frame.pars = NULL, line.pars = gpar(lwd = 1),
          main = NULL, sub = NULL, xlab = NULL, ylab = NULL, new = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sparkline_+3A_s">s</code></td>
<td>
<p>a vector or time series (class <code>"ts"</code> or <code>"zoo"</code>) giving the data to be plotted. If <code>s</code> is a time series, the <code>start</code>, <code>end</code>, and <code>frequency</code> found in <code>attributes(s)$tsp</code> are automatically converted into an argument to <code>times</code>.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_times">times</code></td>
<td>
<p>the times at which to plot the data; if <code>NULL</code> (the default), equal spacing is assumed, equivalent to setting <code>times = 1:length(s)</code>.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_ylim">ylim</code></td>
<td>
<p>the maximum and minimum value on the y-axis; if <code>NULL</code>, defaults to the actual maximum and minimum of the data.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_buffer">buffer</code></td>
<td>
<p>a buffer above the maximum and below the minimum values attained by the sparkline. Defaults to <code>unit(0, 'lines')</code>.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_margins">margins</code></td>
<td>
<p>margins around the sparkline-plus-buffer area. NULL (the default) provides no margins; the value passed must be a 4-vector of units giving the bottom, left, top and right margins in that order.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_iqr">IQR</code></td>
<td>
<p>a list of graphics parameters to shade or otherwise delineate the interquartile range of the sparkline. <code>NULL</code> (the default), does not show the IQR. See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_yaxis">yaxis</code></td>
<td>
<p>draws a vertical axis if <code>TRUE</code>; defaults to <code>FALSE</code> in which case no axis is drawn.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_xaxis">xaxis</code></td>
<td>
<p><code>'interior'</code> draws a horizontal axis inside the plotting frame; <code>'exterior'</code> outside the plotting frame (in the margins); defaults to <code>FALSE</code>, in which case no axis is drawn.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_ptopts">ptopts</code></td>
<td>
<p>a list of graphics parameters describing the points on the sparkline that are plotted and labelled. In particular the first and last or minimum and maximum points are labeled if <code>ptopts$labels</code> is <code>'first.last'</code> or <code>'min.max'</code>. In addition to <code>labels</code>, other relevant parameters from <code><a href="grid.html#topic+gpar">gpar</a></code> should be valid. See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_margin.pars">margin.pars</code></td>
<td>
<p>a list of graphics parameters describing the margin area. See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_buffer.pars">buffer.pars</code></td>
<td>
<p>a list of graphics parameters describing the buffer area. See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_frame.pars">frame.pars</code></td>
<td>
<p>a list of graphics parameters describing the exact area taken up by the plotted sparkline. See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_line.pars">line.pars</code></td>
<td>
<p>a list of graphics parameters describing the sparkline. See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_main">main</code></td>
<td>
<p>a main title, above the sparkline.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_sub">sub</code></td>
<td>
<p>a subtitle, to the right of the sparkline.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_xlab">xlab</code></td>
<td>
<p>a string to label the x-axis.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_ylab">ylab</code></td>
<td>
<p>a string to label the y-axis.</p>
</td></tr>
<tr><td><code id="sparkline_+3A_new">new</code></td>
<td>
<p>defaults to <code>TRUE</code>, which creates a new, empty page; otherwise adds the sparkline to an existing plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In all the cases where a list of graphics parameters is needed, the valid parameter names are the same as would be valid when passed to <code><a href="grid.html#topic+gpar">gpar</a></code> in the appropriate call. That is, passing <code>list(fill = 'blue', col = 'red')</code> to <code>margin</code> gives a margin that is blue with a red border; but adding <code>fontface = 'bold'</code> will have no effect, just as it would have no effect in a call to <code>grid.rect()</code>. In particular, note that <code>ptopts</code> takes the following non-standard parameters: <code>labels</code>, a vector indexing the points to label or the string <code>'min.max'</code> or <code>'first.last'</code>; <code>labels.ch</code>, a vector of strings giving the labels; and <code>points</code>, a vector indexing the points at which points should be plotted. Passing <code>'min.max'</code> or <code>'first.last'</code> to <code>ptopts$labels</code> overrides any values of <code>ptopts$labels.ch</code>.
</p>


<h3>Note</h3>

<p>This is primarily intended to be called by other functions (<code>sparklines()</code> and <code>sparkmat()</code>), but it can also be used as an alternative to <code>ts.plot()</code>.  Thanks to Gabor Grothendieck for suggesting the generalization that provides support of <code>"zoo"</code> objects.</p>


<h3>Author(s)</h3>

<p>John W. Emerson, Walton Green</p>


<h3>References</h3>

<p>Tufte, E. R. (2006) /it Beautiful Evidence Cheshire, Connecticut: Graphics Press.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ts.plot">ts.plot</a></code>, <code><a href="#topic+sparklines">sparklines</a></code>, <code><a href="#topic+sparkmat">sparkmat</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
### sparkline examples
data(nhtemp)

## The default behaviour of sparkline

sparkline(nhtemp)

## Creating stand-alone plots

sparkline(rnorm(10),
                buffer = unit(1, "lines"),
                ptopts = 'first.last',
                margins = unit(c(1,1,1,1), 'inches'),
                yaxis = TRUE, xaxis=TRUE,
                IQR = gpar(fill = 'grey', col = 'grey'),
                main = "Ten Random Standard Normal Numbers",
                sub = '...plotted here')

data(YaleEnergy)
y &lt;- YaleEnergy[YaleEnergy$name==YaleEnergy$name[2],]
sparkline(y$ELSQFT, times=y$year+y$month/12,
          xaxis=TRUE, yaxis=TRUE, main="Branford College Electrical Consumption",
          buffer=unit(1, "lines"), margins = unit(c(1, 1, 1, 1), 'inches'))

sparkline(Nile,
                buffer = unit(1, "lines"),
                ptopts = list(labels = 'min.max'),
                margin.pars = gpar(fill = 'lightblue'),
                buffer.pars = gpar(fill = 'lightgreen'),
                frame.pars = gpar(fill = 'lightyellow'),
                yaxis = TRUE, xaxis=TRUE,
                IQR = gpar(fill = 'grey', col = 'grey'),
                main="Nile Discharge between 1871 and 1970",
                sub='In what units?')

## Adding a sparkline to an existing plot

grid.newpage()
pushViewport(viewport(w = 0.8, h = 0.8))
sparkline(rnorm(10),
                buffer = unit(1, "lines"),
                margins = unit(c(4,4,4,4),'points'),
                ptopts = list(labels = 'min.max'),
                margin.pars = gpar(fill = 'lightblue'),
                buffer.pars = gpar(fill = 'lightgreen'),
                frame.pars = gpar(fill = 'lightyellow'),
                yaxis = TRUE, xaxis=TRUE,
                IQR = gpar(fill = 'grey', col = 'grey'),
                main="Title (plotted OUTSIDE the viewport)", new = FALSE)
popViewport()

</code></pre>

<hr>
<h2 id='sparklines'>Draws a panel of vertically stacked sparklines</h2><span id='topic+sparklines'></span>

<h3>Description</h3>

<p>Draws a panel of vertically stacked, aligned sparklines, or time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparklines(ss, times = NULL, overlap = FALSE, yscale = NULL,
           buffer = unit(0, "lines"), buffer.pars = NULL, IQR = NULL,
           ptopts = NULL, yaxis = TRUE, xaxis = "exterior",
           labeled.points = NULL, point.labels = NULL,
           label.just = c(1.2, 0.5), frame.pars = NULL,
           line.pars = gpar(lwd = 1), 
           outer.margin = unit(c(5, 4, 4, 2), "lines"), 
           outer.margin.pars = NULL, main = NULL, sub = NULL, 
           xlab = NULL, ylab = NULL, lcol = NULL, new = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sparklines_+3A_ss">ss</code></td>
<td>
<p>a data frame whose columns give the time series to be plotted</p>
</td></tr>
<tr><td><code id="sparklines_+3A_overlap">overlap</code></td>
<td>
<p><code>FALSE</code> for stacked sparklines; <code>TRUE</code> for all plotted on the same y-axis.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_times">times</code></td>
<td>
<p>the times at which to plot the data; if <code>NULL</code> (the default), equal spacing is assumed. All the sparklines must share the same <code>times</code> argument. If unaligned time series must be plotted, multiple calls to <code>sparklines()</code> are required.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_yscale">yscale</code></td>
<td>
<p>either a vector of length 2 giving the y-limits for all sparklines, or a list having the same length as the number of columns in <code>ss</code> (each component of which is a 2-vector giving the associated sparkline scales). Defaults to <code>NULL</code>, in which case the scales for each sparkline are set to the sparkline's minimum and maximum values.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_buffer">buffer</code></td>
<td>
<p>a buffer above the maximum and below the minimum values attained by the sparkline. Defaults to <code>unit(0, 'lines')</code>.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_buffer.pars">buffer.pars</code></td>
<td>
<p>a list of graphics parameters describing the buffer area.  See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_iqr">IQR</code></td>
<td>
<p>a list of graphics parameters to shade or otherwise delineate the interquartile range of the sparkline. Defaults to <code>NULL</code>, in which case the IQR is not shown. See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_ptopts">ptopts</code></td>
<td>
<p>a list of graphics parameters describing the points on the sparkline that are plotted and labelled. In particular the first and last or minimum and maximum points are labeled if <code>ptopts\$labels</code> is <code>'first.last'</code> or <code>'min.max'</code>.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_yaxis">yaxis</code></td>
<td>
<p>draws a vertical axis if <code>TRUE</code>; defaults to <code>FALSE</code>, in which case no axis is drawn.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_xaxis">xaxis</code></td>
<td>
<p><code>'interior'</code> draws horizontal axes inside the plotting frame (for each sparkline); <code>'exterior'</code> draws the common axis for all the sparklines outside the plotting frame; defaults to <code>FALSE</code> (no axis).</p>
</td></tr>
<tr><td><code id="sparklines_+3A_labeled.points">labeled.points</code></td>
<td>
<p>not implemented. See <code>ptopts</code>.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_point.labels">point.labels</code></td>
<td>
<p>not implemented. See <code>ptopts</code>.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_label.just">label.just</code></td>
<td>
<p>not implemented. See <code>ptopts</code>.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_frame.pars">frame.pars</code></td>
<td>
<p>a list of graphics parameters describing the exact area taken up by the plotted sparkline.  See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_line.pars">line.pars</code></td>
<td>
<p>a list of graphics parameters describing the sparkline.  See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_outer.margin">outer.margin</code></td>
<td>
<p>a vector of 4 units (bottom, left, top, right) giving the outer margin sizes in order (around the entire panel of sparklines). Defaults to <code>unit(c(0,0,0,0), 'lines')</code>.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_outer.margin.pars">outer.margin.pars</code></td>
<td>
<p>a list of graphics parameters describing the outer margin.  See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_main">main</code></td>
<td>
<p>a main title, above the stack of sparklines.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_sub">sub</code></td>
<td>
<p>a character vector the length of <code>length(ss)</code> providing titles for the individual sparklines, printed to the right of the sparklines.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_xlab">xlab</code></td>
<td>
<p>a string providing the label for the common x-axis or (probably a useless feature) a character vector the length of <code>length(ss)</code> providing x-axis labels for the individual sparklines.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_ylab">ylab</code></td>
<td>
<p>a character vector the length of <code>length(ss)</code> providing y-axis labels for the individual sparklines.</p>
</td></tr>
<tr><td><code id="sparklines_+3A_lcol">lcol</code></td>
<td>
<p>a vector of colors the same length as the number of columns in ss to color the line. As in base graphics, can be either a vector of strings giving the color names, a numeric vector referring to the current pallette, or the output of functions like <code><a href="grDevices.html#topic+hsv">hsv</a></code> or <code><a href="grDevices.html#topic+rgb">rgb</a></code></p>
</td></tr>
<tr><td><code id="sparklines_+3A_new">new</code></td>
<td>
<p>defaults to <code>TRUE</code>, which creates a new, empty page; otherwise adds the sparkline to the existing plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In all the cases where a list of graphics parameters is needed, the valid parameter names are the same as would be valid when passed to <code><a href="grid.html#topic+gpar">gpar</a></code> in the appropriate call. That is, passing <code>list(fill = 'blue', col = 'red')</code> to <code>margin</code> gives a margin that is blue with a red border; but adding <code>fontface = 'bold'</code> will have no effect, just as it would have no effect in a call to <code><a href="grid.html#topic+grid.rect">grid.rect</a></code>.
</p>


<h3>Note</h3>

<p>We do not support non-aligned time series plots such as <code>ts.plot(airmiles, Nile, nhtemp)</code>.
</p>


<h3>Author(s)</h3>

<p>John W. Emerson, Walton Green</p>


<h3>References</h3>

<p>Tufte, E. R. (2006) <em>Beautiful Evidence</em> Cheshire, Connecticut: Graphics Press.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ts.plot">ts.plot</a></code>, <code><a href="#topic+sparkline">sparkline</a></code>, <code><a href="#topic+sparkmat">sparkmat</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
### sparkline examples
data(beaver1)

## The default behaviour of sparklines
sparklines(beaver1)

sparklines(beaver1,
           outer.margin = unit(c(2,4,4,5), 'lines'),
           outer.margin.pars = gpar(fill = 'lightblue'),
           buffer = unit(1, "lines"),
           frame.pars = gpar(fill = 'lightyellow'),
           buffer.pars = gpar(fill = 'lightgreen'),
           yaxis = TRUE, xaxis=FALSE,
           IQR = gpar(fill = 'grey', col = 'grey'),
           main = 'Beaver 1')

data(YaleEnergy)
y &lt;- YaleEnergy[YaleEnergy$name==YaleEnergy$name[2],]
sparklines(y[,c("ELSQFT", "STEAM")], times=y$year+y$month/12,
           main="Branford Electric and Steam Consumption")

## Adding a pair of sparklines to an existing plot

grid.newpage()
pushViewport(viewport(w = 0.8, h = 0.8))
sparklines(data.frame(x = rnorm(10), y = rnorm(10, mean=5)), new = FALSE)
popViewport()

grid.newpage()
pushViewport(viewport(w = 0.8, h = 0.8))
sparklines(data.frame(x = rnorm(10), y = rnorm(10, mean=2)),
                buffer = unit(1, "lines"),
                frame.pars = gpar(fill = 'lightyellow'),
                yaxis = TRUE, xaxis=FALSE,
                IQR = gpar(fill = 'grey', col = 'grey'), new = FALSE)
popViewport()

</code></pre>

<hr>
<h2 id='sparkmat'>Draws a sparkmat</h2><span id='topic+sparkmat'></span>

<h3>Description</h3>

<p>Draws multiple time series (or sparklines) at given locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparkmat(x, locs = NULL, w = NULL, h = NULL, lcol = NULL,
         yscales = NULL, tile.shading = NULL, 
         tile.margin = unit(c(0, 0, 0, 0), "points"),
         tile.pars = NULL, just = c("right", "top"),
         new = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sparkmat_+3A_x">x</code></td>
<td>
<p>a list of data frames, all with the same dimensions, one for each panel of
vertically aligned sparklines.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_locs">locs</code></td>
<td>
<p>a data frame with x-coordinates in the first variable and y-coordinates in the second variable, giving locations of each of the <code>length(x)</code> sparkline panels.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_w">w</code></td>
<td>
<p>vector of unit widths (or native widths if not specified as units).</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_h">h</code></td>
<td>
<p>vector of unit heights (or native heights if not specified as units).</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_lcol">lcol</code></td>
<td>
<p>vector of <code>ncol(x[[1]])</code> line colors, one for each sparkline in each panel.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_yscales">yscales</code></td>
<td>
<p>either a vector of length 2 giving the y-limits for all sparklines, or a list having the same length as the number of columns in <code>ss</code> (each component of which is a 2-vector giving scales for the individual sparklines). Defaults to <code>NULL</code>, in which case the scales for each sparkline are set to its minimum and maximum value within the panel.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_tile.shading">tile.shading</code></td>
<td>
<p>vector of background shadings for the panels.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_tile.margin">tile.margin</code></td>
<td>
<p>an outer margin around each tile (panel of sparklines). A 4-vector of units giving the bottom, left, top and right margins; defaults to
<code>unit(c(0,0,0,0), 'points')</code>.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_tile.pars">tile.pars</code></td>
<td>
<p>a list of graphics parameters describing the buffer area.  See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_just">just</code></td>
<td>
<p>default is <code>c("right", "top")</code>; controls the justification
of the sparklines relative to the provided location coordinates.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_new">new</code></td>
<td>
<p>defaults to <code>TRUE</code>, which creates a new, empty page; otherwise adds the sparkline to the existing plot.</p>
</td></tr>
<tr><td><code id="sparkmat_+3A_...">...</code></td>
<td>
<p>for arguments to be passed through to <code>sparklines()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In all the cases where a list of graphics parameters is needed, the valid parameter names are the same as would be valid when passed to <a href="grid.html#topic+gpar">gpar</a> in the appropriate call. That is, passing <code>list(fill = 'blue', col = 'red')</code> to <code>margin</code> gives a margin that is blue with a red border; but adding <code>fontface = 'bold'</code> will have no effect, just as it would have no effect in a call to <code>grid.rect()</code>.
</p>


<h3>Author(s)</h3>

<p>John W. Emerson, Walton Green</p>


<h3>References</h3>

<p>Tufte, E. R. (2006) <em>Beautiful Evidence</em> Cheshire, Connecticut: Graphics Press.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ts.plot">ts.plot</a></code>, <code><a href="#topic+sparkline">sparkline</a></code>, <code><a href="#topic+sparklines">sparklines</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# An example with a time series of energy consumption at Yale colleges.
data(YaleEnergy)
y &lt;- YaleEnergy

# Need list of 12 data frames, each with one time series.

z &lt;- list(data.frame(y[y$name==y$name[1],"ELSQFT"]),
          data.frame(y[y$name==y$name[2],"ELSQFT"]),
          data.frame(y[y$name==y$name[3],"ELSQFT"]),
          data.frame(y[y$name==y$name[4],"ELSQFT"]),
          data.frame(y[y$name==y$name[5],"ELSQFT"]),
          data.frame(y[y$name==y$name[6],"ELSQFT"]),
          data.frame(y[y$name==y$name[7],"ELSQFT"]),
          data.frame(y[y$name==y$name[8],"ELSQFT"]),
          data.frame(y[y$name==y$name[9],"ELSQFT"]),
          data.frame(y[y$name==y$name[10],"ELSQFT"]),
          data.frame(y[y$name==y$name[11],"ELSQFT"]),
          data.frame(y[y$name==y$name[12],"ELSQFT"]))

sparkmat(z, locs=data.frame(y$lon, y$lat), new=TRUE,
         w=0.002, h=0.0002, just=c("left", "top"))
grid.text(y[1:12,1], unit(y$lon[1:12]+0.001, "native"),
          unit(y$lat[1:12]+0.00003, "native"),
          just=c("center", "bottom"), gp=gpar(cex=0.7))
grid.text("Degrees Longitude", 0.5, unit(-2.5, "lines"))
grid.text("Degrees Latitude", unit(-4.5, "lines"), 0.5, rot=90)
grid.text("Monthly Electrical Consumption (KwH/SqFt)",
          0.5, 0.82, gp=gpar(cex=1, font=2))
grid.text("of Yale Residential Colleges",
          0.5, 0.77, gp=gpar(cex=1, font=2))
grid.text("July 1999 - July 2006",
          0.5, 0.72, gp=gpar(cex=1, font=2))

# An example with pressure and high cloud cover over a regular grid of the
# Americas, provided by NASA ().

runexample &lt;- FALSE
if (runexample) {

data(nasa)

grid.newpage()
pushViewport(viewport(w = unit(1, "npc")-unit(2, "inches"),
                      h = unit(1, "npc")-unit(2, "inches")))
v &lt;- viewport(xscale = c(-115, -55),
              yscale = c(-22.5, 37.5))
pushViewport(v)

y &lt;- vector(mode="list", length=24*24)
locs &lt;- as.data.frame(matrix(0, 24*24, 2))
tile.shading &lt;- rep(0, 24*24)
for(i in 1:24) {     # Latitudes
  for(j in 1:24) {   # Longitudes
    y[[(i-1)*24+j]] &lt;- as.data.frame(t(nasa$data[,,i,j]))
    locs[(i-1)*24+j,] &lt;- c(as.numeric(dimnames(nasa$data)$lon[j]),
                           as.numeric(dimnames(nasa$data)$lat[i]))
    tile.shading[(i-1)*24+j] &lt;- gray( 1-.5*(nasa$elev[i,j]/max(nasa$elev)) )
  }
}

yscales &lt;- list(quantile(nasa$data["pressure",,,], c(0.01, 0.99), na.rm=TRUE),
                quantile(nasa$data["cloudhigh",,,], c(0.01, 0.99), na.rm=TRUE))

sparkmat(y, locs=locs, just='center', w=2.5, h=2.5,
         tile.shading=tile.shading, lcol=c(6,3), yscales=yscales,
         tile.margin = unit(c(2,2,2,2), 'points'), new=FALSE)

grid.xaxis(gp=gpar(fontface=2, fontsize=14))
grid.yaxis(gp=gpar(fontface=2, fontsize=14))
grid.rect()

grid.text("Degrees Latitude", x=unit(-0.75, "inches"), y=0.5, rot=90,
          gp=gpar(fontface=2, fontsize=14))
grid.text("Degrees Longitude", x=0.5, y=unit(-0.75, "inches"), rot=0,
          gp=gpar(fontface=2, fontsize=14))
grid.text("Grayscale shading reflects",
          x=unit(1, "npc")+unit(0.6, "inches"), y=0.5, rot=270,
          gp=gpar(fontface=2, fontsize=14))
grid.text("average elevation above sea level",
          x=unit(1, "npc")+unit(0.3, "inches"), y=0.5, rot=270,
          gp=gpar(fontface=2, fontsize=14))

grid.lines(nasa$coast[,1], nasa$coast[,2], default.units = 'native',
           gp = gpar(col = 'black', lwd = 1))

grid.text("Pressure",
          x=0.25, y=unit(1, "npc")+unit(1.25, "lines"),
          gp=gpar(fontface=2, fontsize=14))
grid.rect(x=0.25, y=unit(1, "npc") + unit(0.5, "lines"),
          width=0.4, height=unit(0.05, "inches"), gp=gpar(col=6, fill=6))
grid.text("High Cloud",
          x=0.75, y=unit(1, "npc")+unit(1.25, "lines"),
          gp=gpar(fontface=2, fontsize=14))
grid.rect(x=0.75, y=unit(1, "npc") + unit(0.5, "lines"),
          width=0.4, height=unit(0.05, "inches"), gp=gpar(col=3, fill=3))
}
</code></pre>

<hr>
<h2 id='whatis'>Data frame summary</h2><span id='topic+whatis'></span>

<h3>Description</h3>

<p>Summarize the characteristics of variables (columns)
in a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whatis(x, var.name.truncate = 20, type.truncate = 14)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="whatis_+3A_x">x</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="whatis_+3A_var.name.truncate">var.name.truncate</code></td>
<td>
<p>maximum length (in characters) for truncation
of variable names.  The default is 20; anything less than 12 is
less than the column label in the resulting data frame and is a
waste of information.</p>
</td></tr>
<tr><td><code id="whatis_+3A_type.truncate">type.truncate</code></td>
<td>
<p>maximum length (in characters) for truncation of
variable type; <code>14</code> is the full width, but <code>4</code> works well
if space is at a premium.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>whatis()</code> provides a basic examination of some
characteristics of each variable (column) in a data frame.
</p>


<h3>Value</h3>

<p>A list of characteristics describing the variables in the data
frame, <code>x</code>. Each component of the list has <code>length(x)</code>
values, one for each variable in the data frame <code>x</code>. 
</p>

<dl>
<dt>variable.name</dt><dd><p>from the <code>names(x)</code> attribute, possibly
truncated to <code>var.name.truncate</code> characters in length.</p>
</dd>
<dt>type</dt><dd><p>the possibilities include <code>"pure factor"</code>,
<code>"mixed factor"</code>, <code>"ordered factor"</code>, <code>"character"</code>, 
and <code>"numeric"</code>; <code>whatis()</code> considers the possibility that a 
factor or a vector could contain character and/or numeric values.  
If both character and numeric values are present, and if the variable 
is a factor, then it is called a mixed factor.  If the levels of a 
factor are purely character or numeric (but not both), it is a pure 
factor.  Non-factors must then be either character or numeric.</p>
</dd>
<dt>missing</dt><dd><p>the number of <code>NA</code>s in the variable.</p>
</dd>
<dt>distinct.values</dt><dd><p>the number of distinct values in the variable,
equal to <code>length(table(variable))</code>.</p>
</dd>
<dt>precision</dt><dd><p>the number of decimal places of precision.</p>
</dd>
<dt>min</dt><dd><p>the minumum value (if numeric) or first value (alphabetically)
as appropriate.</p>
</dd>
<dt>max</dt><dd><p>the maximum value (if numeric) or the last value
(alphabetically) as appropriate.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>John W. Emerson, Walton Green
</p>


<h3>References</h3>

<p>Special thanks to John Hartigan and the students of
'Statistical Case Studies' of 2004 for their help troubleshooting
and developing the function <code>whatis()</code>.
</p>


<h3>See Also</h3>

<p>See also <code><a href="utils.html#topic+str">str</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mydf &lt;- data.frame(a=rnorm(100),
                   b=sample(c("Cat", "Dog"), 100, replace=TRUE), 
                   c=sample(c("Apple", "Orange", "8"), 100, replace=TRUE),
                   d=sample(c("Blue", "Red"), 100, replace=TRUE))
mydf$d &lt;- as.character(mydf$d)
whatis(mydf)

data(iris)
whatis(iris)
</code></pre>

<hr>
<h2 id='YaleEnergy'>Monthly energy consumption of Yale residential colleges.</h2><span id='topic+YaleEnergy'></span>

<h3>Description</h3>

<p>The data set contains monthly energy time series for Yale residential
college, from July 1999 through July 2006
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YaleEnergy)</code></pre>


<h3>Format</h3>

<p>A data frame with 1020 observations on the following 18 variables.
</p>

<dl>
<dt><code>name</code></dt><dd><p>a factor with levels <code>BERKELEY</code> <code>BRANFORD</code> <code>CALHOUN</code> <code>DAVENPORT</code> <code>EZRA STILES</code> <code>JONATHAN EDWARDS</code> <code>MORSE</code> <code>PIERSON</code> <code>SAYBROOK</code> <code>SILLIMAN</code> <code>TIMOTHY DWIGHT</code> <code>TRUMBULL</code></p>
</dd>
<dt><code>address</code></dt><dd><p>a factor with levels <code>189 ELM ST.</code> <code>205 ELM ST.</code> <code>241 ELM ST.</code> <code>242 ELM ST.</code> <code>248 YORK ST.</code> <code>261 PARK ST.</code> <code>302 YORK ST.</code> <code>345 TEMPLE ST.</code> <code>505 COLLEGE ST.</code> <code>70 HIGH ST.</code> <code>74 HIGH ST.</code></p>
</dd>
<dt><code>gsf</code></dt><dd><p>gross square footage of the college</p>
</dd>
<dt><code>EL</code></dt><dd><p>electrical consumption in kilowatt hours</p>
</dd>
<dt><code>ELSQFT</code></dt><dd><p>electrical consumption per square foot</p>
</dd>
<dt><code>CHW</code></dt><dd><p>chilled water consumption in tons</p>
</dd>
<dt><code>SQFTCHW</code></dt><dd><p>square feet per ton of chilled water</p>
</dd>
<dt><code>STEAM</code></dt><dd><p>steam consumption in pounds</p>
</dd>
<dt><code>STEAMSQFT</code></dt><dd><p>steam per square foot</p>
</dd>
<dt><code>MBTU</code></dt><dd><p>million British Thermal Units (BTU) from chilled water and steam</p>
</dd>
<dt><code>MBTUSQFT</code></dt><dd><p>million BTUs per square foot</p>
</dd>
<dt><code>year</code></dt><dd><p>year of the record</p>
</dd>
<dt><code>month</code></dt><dd><p>month of the record</p>
</dd>
<dt><code>lon</code></dt><dd><p>degrees longitude of the college</p>
</dd>
<dt><code>lat</code></dt><dd><p>degrees latitude</p>
</dd>
</dl>



<h3>Source</h3>

<p>John W. Emerson, Yale University
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(YaleEnergy)
whatis(YaleEnergy)

y &lt;- YaleEnergy             # This is just for convenience.
esqft &lt;- list(data.frame(y[y$name==y$name[1],"ELSQFT"]),
              data.frame(y[y$name==y$name[2],"ELSQFT"]),
              data.frame(y[y$name==y$name[3],"ELSQFT"]),
              data.frame(y[y$name==y$name[4],"ELSQFT"]),
              data.frame(y[y$name==y$name[5],"ELSQFT"]),
              data.frame(y[y$name==y$name[6],"ELSQFT"]),
              data.frame(y[y$name==y$name[7],"ELSQFT"]),
              data.frame(y[y$name==y$name[8],"ELSQFT"]),
              data.frame(y[y$name==y$name[9],"ELSQFT"]),
              data.frame(y[y$name==y$name[10],"ELSQFT"]),
              data.frame(y[y$name==y$name[11],"ELSQFT"]),
              data.frame(y[y$name==y$name[12],"ELSQFT"]))

# The sparkmat() command does most of the work:
sparkmat(esqft, locs=data.frame(y$lon, y$lat), new=TRUE,
         w=0.002, h=0.0002, just=c("left", "top"))

# We'll add some text for a nice finished product:
grid.text(y[1:12,1], unit(y$lon[1:12]+0.001, "native"),
          unit(y$lat[1:12]+0.00003, "native"),
          just=c("center", "bottom"), gp=gpar(cex=0.7))
grid.text("Degrees Longitude", 0.5, unit(-2.5, "lines"))
grid.text("Degrees Latitude", unit(-4.5, "lines"), 0.5, rot=90)
grid.text("Monthly Electrical Consumption (KwH/SqFt) of Yale Colleges",
          0.5, 0.8, gp=gpar(cex=1, font=2))
grid.text("July 1999 - July 2006",
          0.5, 0.74, gp=gpar(cex=1, font=2))
</code></pre>

<hr>
<h2 id='YaleToolkit'>Data exploration tools from the Department of Statistics at Yale University</h2><span id='topic+YaleToolkit'></span>

<h3>Description</h3>

<p>This collection of data exploration tools was developed
at Yale University for the graphical exploration of complex
multivariate data. The main functions provided are <code>barcode()</code>,
<code>gpairs()</code>, <code>whatis()</code>, and <code>sparkmat()</code>, although <code>barcode()</code>
and <code>gpairs()</code> are now provided by packages of the same names, respectively.
</p>


<h3>Details</h3>

<p>The package also includes several data sets.  For more information,
please see the help files for <code>nasa</code> and <code>YaleEnergy</code>.
Please get in touch with us if you note any problems.
</p>


<h3>Author(s)</h3>

<p>John W. Emerson, Walton Green
</p>


<h3>References</h3>


<ul>
<li><p> Chambers, J.M., Cleveland, W.S., Kleiner, B., and Tukey, P.A. (1983),
<em>Graphical Methods for Data Analysis</em>, Belmont, CA: Wadsworth.
</p>
</li>
<li><p> Friendly, M. (2002) 'Corrgrams: Exploratory displays for correlation
matrices' <code>American Statistician</code> 56(4), 316&ndash;324.
</p>
</li>
<li><p> Tufte, Edward R. (2006) <em>Beautiful Evidence</em> The Graphics
Press, Cheshire, Connecticut.
See <a href="https://www.edwardtufte.com">https://www.edwardtufte.com</a> for this and other references.
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
