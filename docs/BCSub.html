<!DOCTYPE html><html><head><title>Help for package BCSub</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BCSub}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BCSub'><p>A Bayesian semiparametric factor analysis model for subtype identification</p>
(Clustering).</a></li>
<li><a href='#calSim'><p>Function to calculate the similarity matrix based on the</p>
cluster membership indicator of each iteration.</a></li>
<li><a href='#dmvnrm_arma'><p>Internal function to calculate the density of multivariate normal distribution.</p></a></li>
<li><a href='#mvrnormArma'><p>Internal function to sample from multivariate normal distribution.</p></a></li>
<li><a href='#myfind'><p>Internal function to find matched index.</p></a></li>
<li><a href='#polyurncpp'><p>Internal function to sample cluster membership indicator</p></a></li>
<li><a href='#samEta'><p>Internal function to sample eta</p></a></li>
<li><a href='#samLamV3Cpp'><p>Internal function to sample Lambda</p></a></li>
<li><a href='#samMu'><p>Internal function to sample cluster-specific means of eta</p></a></li>
<li><a href='#samRho2'><p>Internal function to sample rho</p></a></li>
<li><a href='#samSig'><p>Internal function to sample gene-specific variances</p></a></li>
<li><a href='#samSige'><p>Internal function to sample variances for eta</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Bayesian Semiparametric Factor Analysis Model for Subtype
Identification (Clustering)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-03-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiehuan Sun [aut, cre], Joshua L. Warren [aut], and Hongyu Zhao [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiehuan Sun &lt;jiehuan.sun@yale.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Gene expression profiles are commonly utilized to infer disease
             subtypes and many clustering methods can be adopted for this task.
             However, existing clustering methods may not perform well when
             genes are highly correlated and many uninformative genes are included
             for clustering. To deal with these challenges, we develop a novel
             clustering method in the Bayesian setting. This method, called BCSub,
             adopts an innovative semiparametric Bayesian factor analysis model
             to reduce the dimension of the data to a few factor scores for
             clustering. Specifically, the factor scores are assumed to follow
             the Dirichlet process mixture model in order to induce clustering.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0), MASS (&ge; 7.3-45), mcclust (&ge; 1.0), nFactors (&ge;
2.3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-03-16 18:20:40 UTC; JiehuanSun</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-03-16 23:41:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BCSub'>A Bayesian semiparametric factor analysis model for subtype identification
(Clustering).</h2><span id='topic+BCSub'></span>

<h3>Description</h3>

<p>A Bayesian semiparametric factor analysis model for subtype identification
(Clustering).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCSub(A = NULL, iter = 1000, seq = 200:1000, M = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BCSub_+3A_a">A</code></td>
<td>
<p>Data matrix with rows being subjects and columns being genes.</p>
</td></tr>
<tr><td><code id="BCSub_+3A_iter">iter</code></td>
<td>
<p>Total number of iterations (including burn-in period).</p>
</td></tr>
<tr><td><code id="BCSub_+3A_seq">seq</code></td>
<td>
<p>Posterior samples used for inference of cluster structure.</p>
</td></tr>
<tr><td><code id="BCSub_+3A_m">M</code></td>
<td>
<p>Number of factors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a list with following objects.
</p>
<table>
<tr><td><code>CL</code></td>
<td>
<p>Inferred cluster strucutre based on the posterior samples.</p>
</td></tr>
<tr><td><code>E</code></td>
<td>
<p>A matrix with each column being the cluster structre at each iteration.</p>
</td></tr>
</table>


<h3>References</h3>

<p>A Bayesian Semiparametric Factor Analysis Model for Subtype
Identification. Jiehuan Sun, Joshua L. Warren, and Hongyu Zhao.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n = 100 ## number of subjects
G = 200 ## number of genes
SNR = 0 ## ratio of noise genes
## loading matrix with four factors
lam = matrix(0,G,4)
lam[1:(G/4),1] = runif(G/4,-3,3)
lam[(G/4+1):(G/2),2] = runif(G/4,-3,3)
lam[(G/2+1):(3*G/4),3] = runif(G/4,-3,3)
lam[(3*G/4+1):(G),4] = runif(G/4,-3,3)
## generate low-rank covariance matrix
sigma &lt;- lam%*%t(lam) + diag(rep(1,G))
sigma &lt;- cov2cor(sigma)
## true cluster structure ##
e.true = c(rep(1,n/2),rep(2,n/2))

## generate data matrix ##
mu1 = rep(1,G)
mu1[sample(1:G,SNR*G)] = 0
mu2 &lt;- rep(0,G)
A = rbind(mvrnorm(n/2,mu1,sigma),mvrnorm(n/2,mu2,sigma))

## factor analysis to decide the number of factors
## Not run: 
ev = eigen(cor(A))
ap = parallel(subject=nrow(A),var=ncol(A),rep=100,cent=.05)
nS = nScree(x=ev$values, aparallel=ap$eigen$qevpea)
M = nS$Components[1,3] ## number of factors

## End(Not run)
M = 4
## run BCSub for clustering
iters = 1000 ## total number of iterations
seq = 600:1000 ## posterior samples used for inference
system.time(res &lt;- BCSub(A,iter=iters,seq=seq,M=M))
res$CL ## inferred cluster structure

## calculate and plot similarity matrix
sim = calSim(t(res$E[,seq]))

## plot similarity matrix
x &lt;- rep(1:n,times=n)
y &lt;- rep(1:n,each=n)
z &lt;- as.vector(sim)
levelplot(z~x*y,col.regions=rev(gray.colors(n^2)), xlab = "Subject ID",ylab = "Subject ID")
</code></pre>

<hr>
<h2 id='calSim'>Function to calculate the similarity matrix based on the
cluster membership indicator of each iteration.</h2><span id='topic+calSim'></span>

<h3>Description</h3>

<p>Function to calculate the similarity matrix based on the
cluster membership indicator of each iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calSim(mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calSim_+3A_mat">mat</code></td>
<td>
<p>A matrix of cluster membership indicators.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a similarity matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 90 ## number of subjects
iters = 200 ## number of iterations
## matrix of cluster membership indicators
## perfect clustering with three clusters
mat = matrix(rep(1:3,each=n/3),nrow=n,ncol=iters)
sim = calSim(t(mat))
## plot similarity matrix
x &lt;- rep(1:n,times=n)
y &lt;- rep(1:n,each=n)
z &lt;- as.vector(sim)
levelplot(z~x*y,col.regions=rev(gray.colors(n^2)), xlab = "Subject ID",ylab = "Subject ID")
</code></pre>

<hr>
<h2 id='dmvnrm_arma'>Internal function to calculate the density of multivariate normal distribution.</h2><span id='topic+dmvnrm_arma'></span>

<h3>Description</h3>

<p>Internal function to calculate the density of multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmvnrm_arma(x, mean, sigma, logd = FALSE)
</code></pre>

<hr>
<h2 id='mvrnormArma'>Internal function to sample from multivariate normal distribution.</h2><span id='topic+mvrnormArma'></span>

<h3>Description</h3>

<p>Internal function to sample from multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvrnormArma(n, mu, sigma)
</code></pre>

<hr>
<h2 id='myfind'>Internal function to find matched index.</h2><span id='topic+myfind'></span>

<h3>Description</h3>

<p>Internal function to find matched index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myfind(evec, e)
</code></pre>

<hr>
<h2 id='polyurncpp'>Internal function to sample cluster membership indicator</h2><span id='topic+polyurncpp'></span>

<h3>Description</h3>

<p>Internal function to sample cluster membership indicator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polyurncpp(e, muA0, sigma0, A, sigma, sigmaInv, sigma0Inv, c)
</code></pre>

<hr>
<h2 id='samEta'>Internal function to sample eta</h2><span id='topic+samEta'></span>

<h3>Description</h3>

<p>Internal function to sample eta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samEta(sig, A, lam, mu, e, sigmaInv)
</code></pre>

<hr>
<h2 id='samLamV3Cpp'>Internal function to sample Lambda</h2><span id='topic+samLamV3Cpp'></span>

<h3>Description</h3>

<p>Internal function to sample Lambda
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samLamV3Cpp(A, eta, sig, sigl, lam)
</code></pre>

<hr>
<h2 id='samMu'>Internal function to sample cluster-specific means of eta</h2><span id='topic+samMu'></span>

<h3>Description</h3>

<p>Internal function to sample cluster-specific means of eta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samMu(e, eta, mu0, sigma0Inv, sigmaInv)
</code></pre>

<hr>
<h2 id='samRho2'>Internal function to sample rho</h2><span id='topic+samRho2'></span>

<h3>Description</h3>

<p>Internal function to sample rho
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samRho2(mu, rho2, vv = 1, up = 1, lo = 0)
</code></pre>

<hr>
<h2 id='samSig'>Internal function to sample gene-specific variances</h2><span id='topic+samSig'></span>

<h3>Description</h3>

<p>Internal function to sample gene-specific variances
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samSig(v1, v2, A, lam, eta)
</code></pre>

<hr>
<h2 id='samSige'>Internal function to sample variances for eta</h2><span id='topic+samSige'></span>

<h3>Description</h3>

<p>Internal function to sample variances for eta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samSige(v1, v2, eta, mu, e)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
