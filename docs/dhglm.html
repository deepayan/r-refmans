<!DOCTYPE html><html><head><title>Help for package dhglm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dhglm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#crack_growth'><p>Crack-growth Data</p></a></li>
<li><a href='#dhglm-package'><p>Double Hierarchical Genearlized Linear Models</p></a></li>
<li><a href='#dhglmfit'><p>Fitting Double Hierarchical Generalized Linear Models using h-likelihood Approach</p></a></li>
<li><a href='#DHGLMMODELING'><p>Defining the Fixed and Random Models for the Mean and Dispersion parameters in DHGLMs</p></a></li>
<li><a href='#epilepsy'><p>Epilepsy Seizures Data</p></a></li>
<li><a href='#plotdhglm'><p>Produce Model-Checking Plots for a Double Hierarchical Generalized Linear Model Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Double Hierarchical Generalized Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-10-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Youngjo Lee, Maengseok Noh</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maengseok Noh &lt;msnoh@pknu.ac.kr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements double hierarchical generalized linear models in which the mean, dispersion parameters for variance of random effects, and residual variance (overdispersion) can be further modeled as random-effect models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), methods, Matrix, boot, MASS, car, sandwich</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-25 08:15:30 UTC; Noh</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-25 08:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='crack_growth'>Crack-growth Data</h2><span id='topic+crack_growth'></span>

<h3>Description</h3>

<p>Hudak et al. (1978) presented data on crack growth data, which have been listed by Lu and Meeker (1993). There are 21 metallic specimens, each
subjected to 120,000 loading cycles, with the crack lengths recorded every 10,000 cycles. We take t=no. cycles/100,000 here, so t(j)=j/1000
for j=1,...,12 coded by cycle. The crack increment sequences look rather irregular. Let l(i,j) be the crack length of the ith specimen at the jth
observation and let y(i,j)=l(i,j)-l(i,j-1) be the corresponding increment of crack length, which has always a positive value. l(i,j-1) is coded by
crack0 to use as a covariate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(crack_growth)</code></pre>


<h3>Format</h3>

<p>A data frame with 241 observations of the following 4 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>ID variable.</p>
</dd> 
<dt><code>y</code></dt><dd><p>Increment in crack length, y(i,j)=l(i,j)-l(i,j-1), where l(i,j) is the crack length of the ith 
specimen at the jth observation.</p>
</dd>
<dt><code>crack0</code></dt><dd><p>The previous crack length, l(i,j-1).</p>
</dd>
<dt><code>specimen</code></dt><dd><p>The specimen number for 21 metallic specimens.</p>
</dd>
<dt><code>cycle</code></dt><dd><p>The number of cycles/100,000; t(j)=j/100, j=1,...,12.</p>
</dd>
</dl>



<h3>References</h3>

<p>Hudak, S. J., Saxena, A. Bucci, R. J. and Malcom, R. C. (1978). Development of standard methods of testing and analyzing fatigue crack
growth rate data. Technical report. AFML-TR-78-40. Westinghouse R &amp; D Center, Wesinghouse Electric Corp., Pittsburgh, PA.
</p>
<p>Lu, C. J. and Meeker, W. Q. (1993). Using degeneration measurements
to estimate a time-to-failure distribution, Technometrics 35, 161&ndash;174.
</p>

<hr>
<h2 id='dhglm-package'>Double Hierarchical Genearlized Linear Models</h2><span id='topic+dhglm-package'></span>

<h3>Description</h3>

<p>The dhglm package is used to fit double hierarchical generalized linear models (DHGLMs) in which random effects 
can be specified in both the mean and the dispersion components (Lee and Nelder, 2006; Lee, Nelder, and Pawitan, 2006).
It can also be used to fit generalized linear models (GLMs) of Nedler and Wedderburn (1972), joint GLMs of Nelder and Lee (1991),
and hierarchical GLMs (HGLMs) of Lee and Nelder (1996, 2001). Dispersion parameters of the random effects in the mean model can also be modeled 
with random effects (Noh, Lee and Pawitan, 2005). The response variable is allowed to follow a Gaussain, binomial, Poisson, or gamma distribution. The distribution of random
effects can be specified as Gaussian, gamma, inverse-gamma or beta. It can handle complex structures such as crossed or nested designs
in which various combinations of different distributions for random effects can be specified. Fixed effects in the mean can be estimated by maximizing
the h-likelihood or a first-order Laplace approximation to the marginal likelihood. Dispersion parameters are estimated by using first-order
adjusted profile likelihood, an extension of the restricted maximum likelihood; alternatively, 
these parameters can be assigned fixed values. The dhglm package also produces model-checking plots for various component of the model.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> dhglm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-09-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unlimited</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This is version 1.6 of the dhglm package.
</p>


<h3>Author(s)</h3>

<p>Manegseok Noh, Youngjo Lee
</p>
<p>Maintainer: Maengseok Noh &lt;msnoh@pknu.ac.kr&gt;
</p>


<h3>References</h3>

<p>Lee, Y. and Nelder, J. A. (1996). Hierarchical generalised linear models (with discussion), Journal of the Royal Statistical Society B,
58, 619&ndash;678.
</p>
<p>Lee, Y. and Nelder, J. A. (2001). Hierarchical generalised linear models : A synthesis of generalised linear
models, random-effect model and structured dispersion, Biometrika, 88, 987&ndash;1006.
</p>
<p>Lee, Y. and Nelder, J. A. (2006). Double hierarchical generalized linear models (with discussion), Applied Statistics 55, 139&ndash;185.
</p>
<p>Lee, Y. Nelder, J. A. and Pawitan, Y. (2006). Generalised linear models with random effects: unified analysis via
h-likelihood. Chapman &amp; Hall: London.
</p>
<p>Nelder, J. A. and Lee, Y. (1991). Generalised linear models for the analysis of Taguchi-type experiments, 
Applied Stochastic Models and Data Analysis, 7, 107&ndash;120.
</p>
<p>Nelder, J. A. and Wedderburn, R. W. M. (1972). Generalised linear models, Journal of the Royal Statistical Society A, 135, 370&ndash;384.
</p>
<p>Noh, M., Lee, Y. and Pawitan, Y. (2005). Robust ascertainment-adjusted parameter estimation, Genetic Epidemiology, 29, 68&ndash;75.
</p>


<h3>See Also</h3>

<p>&lt;<code><a href="#topic+dhglmfit">dhglmfit</a></code>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### DHGLM introducing random effects in the overdispersion for crack growth data
data(crack_growth)
model_mu&lt;-DHGLMMODELING(Model="mean", Link="log", LinPred=y~crack0+(1|specimen),
RandDist="inverse-gamma")
model_phi&lt;-DHGLMMODELING(Model="dispersion", Link="log", 
LinPred=phi~cycle+(1|specimen), RandDist="gaussian")
res_crack&lt;-dhglmfit(RespDist="gamma",DataMain=crack_growth,
MeanModel=model_mu,DispersionModel=model_phi,Maxiter=1)
</code></pre>

<hr>
<h2 id='dhglmfit'>Fitting Double Hierarchical Generalized Linear Models using h-likelihood Approach</h2><span id='topic+dhglmfit'></span>

<h3>Description</h3>

<p>dhglmfit is used to fit a class of double hierarchical generalized linear models (DHGLMs) in which
fixed and random effects can be specified in both the mean and the dispersion components. A variety of distributions and link functions for both the 
response variables and the random effects are allowed. Fixed and random effects can also be fitted in both the mean and the dispersion components.
To call the fitting function dhglmfit, models for the mean and dispersion must be specified 
by DHGLMMODELING object preferably created by calling the DHGLMMODELING function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dhglmfit(RespDist = "gaussian", BinomialDen = NULL, DataMain,
                 MeanModel, DispersionModel, BetaFix = NULL, PhiFix =
                 NULL, LamFix = NULL, mord = 1, dord = 1, REML = TRUE,
                 Maxiter = 200, convergence = 1e-06, EstCorr = FALSE,
                 Dmethod = "deviance")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dhglmfit_+3A_respdist">RespDist</code></td>
<td>
<p>The distribution of the response is set by
the option RespDist. The user can set it to: &quot;gaussian&quot; (default), &quot;binomial&quot;, &quot;poisson&quot;, or &quot;gamma&quot;.</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_binomialden">BinomialDen</code></td>
<td>
<p>When RespDist=&quot;binomial&quot;, one should use the option BinomialDen to specify the
denominator for the binomial distribution. This should be &quot;NULL&quot; (default) or a numeric vector of length equal to the length of DataMain. 
When specified as BinomialDen=NULL and RespDist=&quot;binomial&quot;, the denominator is 1.</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_datamain">DataMain</code></td>
<td>
<p>The option DataMain determines the data frame to be used (non-optional).</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_meanmodel">MeanModel</code></td>
<td>
<p>For the mean model, this option requries DGHLMMODELING object which should specified by the option Model=&quot;mean&quot;.</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_dispersionmodel">DispersionModel</code></td>
<td>
<p>For the overdispersion model, this option requries DGHLMMODELING object which should be specified by the option Model=&quot;dispersion&quot;.</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_betafix">BetaFix</code>, <code id="dhglmfit_+3A_phifix">PhiFix</code>, <code id="dhglmfit_+3A_lamfix">LamFix</code></td>
<td>
<p>Three options that determine whether the mean parameters (beta), overdispersion parameters (phi) and random-effect variance (lambda) are 
to be estimated or maintaned constant. Specifying defaults such as BetaFix=NULL (or PhiFix =NULL or LamFix =NULL) implies that beta (or phi or lambda) is to be estimated. 
If not, beta (or phi or lambda) is fixed at a value specified by BetaFix (or PhiFix or LamFix).</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_mord">mord</code></td>
<td>
<p>The option mord specifies the order of Laplace approximation to the marginal likelihood for fitting the mean parameters.
The choice is either 0 or 1 (default).</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_dord">dord</code></td>
<td>
<p>The option dord specifies the order of Laplace approximation to the adjusted profile likelihood for fitting the dispersion
parameters. The choice is either 1 (default) or 2.</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_reml">REML</code></td>
<td>
<p>logical - indicating whether REML method if it is TRUE (default) or ML method if FALSE are used.</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_maxiter">Maxiter</code></td>
<td>
<p>Maxiter determines the maximum number of iterations for estimating all parameters. The default number is 200 iterations.</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_convergence">convergence</code></td>
<td>
<p>Setting this option determines the criterion for convergence, which is computed as the absolute
difference between the values of all the estimated parameters in the previous and current iterations. The default criterion is 1e-06.</p>
</td></tr>
<tr><td><code id="dhglmfit_+3A_estcorr">EstCorr</code></td>
<td>
<p>logical - indicating whether correlations are estimated if it is TRUE (default) or not estimated if FALSE are used.</p>
</td></tr>      
<tr><td><code id="dhglmfit_+3A_dmethod">Dmethod</code></td>
<td>
<p>Method of fitting dispersion model; &quot;deviance&quot; (default) or &quot;Pearson&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#### Analysis of crack-growth data ####
data(crack_growth)
## GLM ##
model_mu&lt;-DHGLMMODELING(Model="mean", Link="log", 
LinPred=y~crack0)
model_phi&lt;-DHGLMMODELING(Model="dispersion")
res_glm&lt;-dhglmfit(RespDist="gamma",DataMain=crack_growth,
MeanModel=model_mu,DispersionModel=model_phi,Maxiter=1)
## JGLM ##
model_mu&lt;-DHGLMMODELING(Model="mean", Link="log",
LinPred=y~crack0)
model_phi&lt;-DHGLMMODELING(Model="dispersion", Link="log", 
LinPred=phi~cycle)
res_jglm&lt;-dhglmfit(RespDist="gamma",DataMain=crack_growth,
MeanModel=model_mu,DispersionModel=model_phi,Maxiter=1)
## HGLM I ##
model_mu&lt;-DHGLMMODELING(Model="mean", Link="log", 
LinPred=y~crack0+(1|specimen),RandDist="inverse-gamma")
model_phi&lt;-DHGLMMODELING(Model="dispersion")
res_hglm1&lt;-dhglmfit(RespDist="gamma",DataMain=crack_growth,
MeanModel=model_mu,DispersionModel=model_phi,Maxiter=1)
## HGLM II ##
model_mu&lt;-DHGLMMODELING(Model="mean", Link="log", 
LinPred=y~crack0+(1|specimen),RandDist="inverse-gamma")
model_phi&lt;-DHGLMMODELING(Model="dispersion", Link="log", 
LinPred=phi~cycle)
res_hglm2&lt;-dhglmfit(RespDist="gamma",DataMain=crack_growth,
MeanModel=model_mu,DispersionModel=model_phi,Maxiter=1)
## DHGLM I ##
model_mu&lt;-DHGLMMODELING(Model="mean", Link="log",
 LinPred=y~crack0+(1|specimen),RandDist="inverse-gamma")
model_phi&lt;-DHGLMMODELING(Model="dispersion", Link="log", 
LinPred=phi~cycle+(1|specimen),RandDist="gaussian")
res_dhglm1&lt;-dhglmfit(RespDist="gamma",DataMain=crack_growth,
MeanModel=model_mu,DispersionModel=model_phi,Maxiter=1)

#### Analysis of epilepsy data ####
data(epilepsy)
model_mu&lt;-DHGLMMODELING(Model="mean", Link="log", 
LinPred=y~B+T+A+T*B+V+(1|patient),
RandDist=c("gaussian"))
model_phi&lt;-DHGLMMODELING(Model="dispersion")
# res_hglm&lt;-dhglmfit(RespDist="poisson",DataMain=epilepsy,
# MeanModel=model_mu,DispersionModel=model_phi,Maxiter=1)
</code></pre>

<hr>
<h2 id='DHGLMMODELING'>Defining the Fixed and Random Models for the Mean and Dispersion parameters in DHGLMs</h2><span id='topic+DHGLMMODELING'></span>

<h3>Description</h3>

<p>DHGLMMODELING specifies a GLM, HGLM, DHGLM model for the mean parameters (mu), and a GLM, HGLM 
model for the overdispersion parameters (phi). GLM for mu, and GLM for phi are specified by adding only fixed terms to the linear predictors 
for the mu and phi, respectively.
These are extended to HGLM for mu and HGLM for phi by adding some random terms. The DHGLM for mu is specified by allowing random effects 
for the variance of random effects in HGLM for mu.
The LMatrix argument allows correlation structures to be defined for random terms. This is done by setting LMatrix to a matrix L
that is used as a post-multiplier for the Z matrix of the corresponding random term.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DHGLMMODELING(Model = "mean", Link = NULL, LinPred = "constant",
                 RandDist = NULL, Offset = NULL, LMatrix = NULL,
                 LinkRandVariance = NULL, LinPredRandVariance = NULL,
                 RandDistRandVariance = "gaussian", LinkRandVariance2 =
                 NULL, LinPredRandVariance2 = NULL, corr = NULL,
                 spatial = NULL, longitude = NULL, latitude = NULL,
                 spline = NULL, Neighbor = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DHGLMMODELING_+3A_model">Model</code></td>
<td>
<p>This option specifies a GLM, HGLM or DHGLM model for mu when Model=&quot;mean&quot; (default), 
and a GLM or HGLM for phi when Model=&quot;dispersion&quot;.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_link">Link</code></td>
<td>
<p>The link function for the linear predictor is
specified by the option Link. For Model=&quot;mean&quot;, Link can be &quot;identity&quot;,
&quot;logit&quot;, &quot;probit&quot;, &quot;cloglog&quot;, &quot;log&quot;, or &quot;inverse&quot;. 
For Model=&quot;dispersion&quot;, the choice is either &quot;log&quot; or &quot;inverse&quot;. 
The default, specified as NULL link, is &quot;identity&quot; for Model=&quot;mean&quot; and
&quot;log&quot; for Model=&quot;dispersion&quot;.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_linpred">LinPred</code></td>
<td>
<p>The option LinPred specifies the fixed and
random terms for the linear predictor for mu when specified as Model=&quot;mean&quot;
or for phi when Model=&quot;dispersion&quot;. For Model=&quot;mean&quot;, LinPred=y~x1+x2+(1|id1)+(1|id2)
specifies y as the main response, x1 and x2 as fixed covariates and id1 and id2 as random terms.
For Model=&quot;dispersion&quot;, the main response should be phi, e.g. phi~x1+x2+(1|id1)+(1|id2). This option
can specify the model without random effects, e.g., LinPred=phi~x1+x2. The default is &quot;constant&quot;, which is set 
to intercept only the model for the corresponding linear predictors.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_randdist">RandDist</code></td>
<td>
<p>The option RandDist specifies the
distributions of the random terms represented in the option LinPred.
It is set as a vector of distribution names from &quot;gaussain&quot; (default),
&quot;beta&quot;, &quot;gamma&quot;, or &quot;inverse-gamma&quot; when Model=&quot;mean&quot;.
For Model=&quot;dispersion&quot;, the choice is &quot;gaussian&quot; (default), &quot;gamma&quot;, or &quot;inverse-gamma&quot;. 
When more than one random terms are specified, e.g., <code>y~x1+x2+(1|id1)+(1|id2)</code>
in the option LinPred, the different distributions for each random term can be specified, e.g.,
c(&quot;gaussian&quot;, &quot;gamma&quot;), which assumes normal distribution for
the random term &quot;id1&quot; and gamma distribution for the random term &quot;id2&quot;, respectively.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_offset">Offset</code></td>
<td>
<p>The option Offset can be used to
specify a known component to be included in the linear predictor specified by LinPred
during fitting. This should be the default (NULL) or a numeric
vector of length equal to that of the appropriate data.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_lmatrix">LMatrix</code></td>
<td>
<p>The option LMatrix sets a matrix that is used as a
post-multiplier for the model matrix of the corresponding random effects. This
option allows correlation structures to be defined for random effects. For
example, when specified as Model=&quot;mean&quot; and Lmatrix=L1+L2, the
linear predictor for mu takes X beta + Z1 L1 r1 + Z2 L2 r2, where
Z1 and Z2 are the model matrices for the random effects v1=L1 r1 and
v2=L2 r2, specified in the option LinPred.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_linkrandvariance">LinkRandVariance</code></td>
<td>
<p>The option LinkRandVariance
specifies the link function for the linear
predictor of the random-effect variances.
The choice is either &quot;log&quot; (default) or &quot;inverse&quot;. When more than two random terms are specified in the option LinPred,
the user can set different link functions, e.g., LinkRandVariance=c(&quot;log&quot;,&quot;inverse&quot;) for each random term.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_linpredrandvariance">LinPredRandVariance</code></td>
<td>
<p>The option LinPredRandVariance specifies the
fixed and random terms for the linear predictor of the random-effect
variances for Model=&quot;mean&quot;. When y~x1+x2+(1|id1)+(1|id2) is specified in the option LinPred, 
</p>
<p>LinPredRandVariance=c(lambda~xx1+(1|id11),lambda~xx2+(1|id12))
specifies xx1 and xx2 as fixed covariates and id11 and id12 as random terms in the lienar predictors for the variances of the random terms id1 and id2, respectively.
For Model=&quot;dispersion&quot;, the random term is not allowed in the linear predictor of the random-effect variance.
The default (NULL) is set to intercept only model for the corresponding linear predictors.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_randdistrandvariance">RandDistRandVariance</code></td>
<td>
<p>The option RandDistRandVariance specifies the
distributions for the random terms in the LinPredRandVariance.
The choice is &quot;gaussian&quot; (default), &quot;gamma&quot;, or &quot;inverse-gamma&quot;.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_linkrandvariance2">LinkRandVariance2</code></td>
<td>
<p>This option specifies the link function for the linear
predictor of the variance of random effects, which are specified in the option
LinPredRandVariance. The choice is either &quot;log&quot; (default) or &quot;inverse&quot;.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_linpredrandvariance2">LinPredRandVariance2</code></td>
<td>
<p>This option specifies the fixed terms for the linear
predictor of the variance of random effects, which is specified in the option LinPredRandVariance. 
For example, when LinPredRandVariance=c(lambda~xx1+(1|id11),lambda~xx1+(1|id12))
is specified, LinPredRandVariance2=c(~xxx1,~xxx2) specifies
xxx1 and xxx2 as fixed covariates for the linear predictor of random-effect variances for id11 and id12, respectively.
The default (NULL) is set to constant variance for the random effects in LinPredRandVariance.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_corr">corr</code></td>
<td>
<p>Speicification of correlation structures.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_spatial">spatial</code></td>
<td>
<p>Speicification of spatial model.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_longitude">longitude</code></td>
<td>
<p>variable for longitude when spatial option is TRUE.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_latitude">latitude</code></td>
<td>
<p>variable for latitude when spatial option is TRUE.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_spline">spline</code></td>
<td>
<p>option for splince smoothing.</p>
</td></tr>
<tr><td><code id="DHGLMMODELING_+3A_neighbor">Neighbor</code></td>
<td>
<p>Neiborhood matrix when spatial option is TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>&lt;<code><a href="#topic+dhglmfit">dhglmfit</a></code>&gt;
</p>

<hr>
<h2 id='epilepsy'>Epilepsy Seizures Data</h2><span id='topic+epilepsy'></span>

<h3>Description</h3>

<p>Thall and Vail (1990) presented longitudinal data from a clinical trial of
59 epileptics, who were randomized to a new drug or a placebo (T=0 or T=1). 
Baseline data were available at the start of the trial; the trial included the
logarithm of the average number of epileptic seizures recorded in the 8-week
period preceding the trial (B), the logarithm of age (A), and visit (V: a linear trend, coded (-3,-1,1,3)/10). 
A multivariate response variable (y) consists of the seizure counts during 2-week periods before each of four
visits to the clinic.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(epilepsy)</code></pre>


<h3>Format</h3>

<p>A data frame with 236 observations of the following 7 variables.
</p>

<dl>
<dt><code>y</code></dt><dd><p>The seizure counts during 2-week periods before each of four visits to the clinic.</p>
</dd>
<dt><code>T</code></dt><dd><p>Treatment(0=new drug, 1=placebo).</p>
</dd>
<dt><code>B</code></dt><dd><p>The average number of epileptic seizures in the 8-week period preceding the trial.</p>
</dd>
<dt><code>A</code></dt><dd><p>The logarithm of age (in years) of each patient.</p>
</dd>
<dt><code>V</code></dt><dd><p>Linear trend coded (-3, -1, 1, 3)/10 for four visits of each patient.</p>
</dd>
<dt><code>patient</code></dt><dd><p>Patient number for 59 epileptics.</p>
</dd>
<dt><code>id</code></dt><dd><p>Observation number for 236 observations.</p>
</dd>
</dl>



<h3>References</h3>

<p>Thall, P. F. and Vail, S. C. (1990). Some covariance models for
longitudinal count data with overdispersion, Biometrics 46, 657&ndash;671.
</p>

<hr>
<h2 id='plotdhglm'>Produce Model-Checking Plots for a Double Hierarchical Generalized Linear Model Analysis</h2><span id='topic+plotdhglm'></span>

<h3>Description</h3>

<p>Plots residuals for the mean and dispersion models</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotdhglm(OUTPUT, type="mean", random=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotdhglm_+3A_output">OUTPUT</code></td>
<td>
<p>The &lt;<code><a href="#topic+dhglmfit">dhglmfit</a></code>&gt; object to be plotted</p>
</td></tr>
<tr><td><code id="plotdhglm_+3A_type">type</code></td>
<td>
<p>Type of model required (mean, dispersion)</p>
</td></tr>
<tr><td><code id="plotdhglm_+3A_random">random</code></td>
<td>
<p>Random term whose residuals are to be plotted (mean, phi, v, alpha). Default (NULL) is the residuals from the full model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Four types of plot are available (normal probability plot for residuals, histogram of residuals, 
residuals versus fitted values and absolute values of residuals versus fitted values).
</p>


<h3>See Also</h3>

<p>&lt;<code><a href="#topic+dhglmfit">dhglmfit</a></code>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Model checking plot for crack-growth data
data(crack_growth)
model_mu&lt;-DHGLMMODELING(Model="mean", Link="log", 
LinPred=y~crack0+(1|specimen),RandDist="inverse-gamma")
model_phi&lt;-DHGLMMODELING(Model="dispersion", Link="log", 
LinPred=phi~cycle+(1|specimen),RandDist="gaussian")
res_crack_dhglm1&lt;-dhglmfit(RespDist="gamma", DataMain=crack_growth, 
MeanModel=model_mu, DispersionModel=model_phi,Maxiter=1)
plotdhglm(res_crack_dhglm1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
