<!DOCTYPE html><html><head><title>Help for package rwicc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rwicc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#build_phi_function_from_coefs'><p>convert a pair of simple logistic regression coefficients into P(Y|T) curve:</p></a></li>
<li><a href='#compute_mu'><p>compute mean window period duration from simple logistic regression coefficients</p></a></li>
<li><a href='#fit_joint_model'><p>Fit a logistic regression model with an interval-censored covariate</p></a></li>
<li><a href='#fit_midpoint_model'><p>Fit model using midpoint imputation</p></a></li>
<li><a href='#fit_uniform_model'><p>Fit model using uniform imputation</p></a></li>
<li><a href='#plot_CDF'><p>plot estimated and true CDFs for seroconversion date distribution</p></a></li>
<li><a href='#plot_phi_curves'><p>Plot true and estimated curves for P(Y=1|T=t)</p></a></li>
<li><a href='#rwicc'><p>rwicc: Regression with Interval-Censored Covariates</p></a></li>
<li><a href='#seroconversion_inverse_survival_function'><p>Inverse survival function for time-to-event variable with linear hazard function</p></a></li>
<li><a href='#simulate_interval_censoring'><p>Simulate a dataset with interval-censored seroconversion dates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Regression with Interval-Censored Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to simulate and analyze data for a regression model with an interval censored covariate, as described in Morrison et al. (2021) &lt;<a href="https://doi.org/10.1111%2Fbiom.13472">doi:10.1111/biom.13472</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>biglm, dplyr, lubridate, magrittr, stats, pryr, arm, ggplot2,
scales</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, rmarkdown, knitr, testthat, markdown, pander</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://d-morrison.github.io/rwicc/">https://d-morrison.github.io/rwicc/</a>,
<a href="https://github.com/d-morrison/rwicc">https://github.com/d-morrison/rwicc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/d-morrison/rwicc/issues">https://github.com/d-morrison/rwicc/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-09 01:15:52 UTC; dmorrison</td>
</tr>
<tr>
<td>Author:</td>
<td>Douglas Morrison <a href="https://orcid.org/0000-0002-7195-830X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Ron Brookmeyer [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Douglas Morrison &lt;dmorrison01@ucla.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-09 21:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='build_phi_function_from_coefs'>convert a pair of simple logistic regression coefficients into P(Y|T) curve:</h2><span id='topic+build_phi_function_from_coefs'></span>

<h3>Description</h3>

<p>convert a pair of simple logistic regression coefficients into P(Y|T) curve:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_phi_function_from_coefs(coefs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_phi_function_from_coefs_+3A_coefs">coefs</code></td>
<td>
<p>numeric vector of coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p>function(t) P(Y=1|T=t)
</p>

<hr>
<h2 id='compute_mu'>compute mean window period duration from simple logistic regression coefficients</h2><span id='topic+compute_mu'></span>

<h3>Description</h3>

<p>compute mean window period duration from simple logistic regression coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_mu(theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_mu_+3A_theta">theta</code></td>
<td>
<p>numeric vector of coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric scalar: mean window period duration
</p>

<hr>
<h2 id='fit_joint_model'>Fit a logistic regression model with an interval-censored covariate</h2><span id='topic+fit_joint_model'></span>

<h3>Description</h3>

<p>This function fits a logistic regression model for a binary outcome Y with an
interval-censored covariate T, using an EM algorithm, as described in Morrison et al (2021); doi: <a href="https://doi.org/10.1111/biom.13472">10.1111/biom.13472</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_joint_model(
  participant_level_data,
  obs_level_data,
  model_formula = stats::formula(Y ~ T),
  mu_function = compute_mu,
  bin_width = 1,
  denom_offset = 0.1,
  EM_toler_loglik = 0.1,
  EM_toler_est = 1e-04,
  EM_max_iterations = Inf,
  glm_tolerance = 1e-07,
  glm_maxit = 20,
  initial_S_estimate_location = 0.25,
  coef_change_metric = "max abs rel diff coefs",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_joint_model_+3A_participant_level_data">participant_level_data</code></td>
<td>
<p>a data.frame or tibble with the following variables:
</p>

<ul>
<li><p> ID: participant ID
</p>
</li>
<li><p> E: study enrollment date
</p>
</li>
<li><p> L: date of last negative test for seroconversion
</p>
</li>
<li><p> R: date of first positive test for seroconversion
</p>
</li>
<li><p> Cohort' (optional): this variable can be used to stratify the modeling of
the seroconversion distribution.
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_obs_level_data">obs_level_data</code></td>
<td>
<p>a data.frame or tibble with the following variables:
</p>

<ul>
<li><p> ID: participant ID
</p>
</li>
<li><p> O: biomarker sample collection dates
</p>
</li>
<li><p> Y: MAA classifications (binary outcomes)
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_model_formula">model_formula</code></td>
<td>
<p>the functional form for the regression model for p(y|t) (as a
formula() object)</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_mu_function">mu_function</code></td>
<td>
<p>a function taking a vector of regression coefficient estimates
as input and outputting an estimate of mu (mean duration of MAA-positive
infection).</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_bin_width">bin_width</code></td>
<td>
<p>the number of days between possible seroconversion dates (should
be an integer)</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_denom_offset">denom_offset</code></td>
<td>
<p>an offset value added to the denominator of the hazard
estimates to improve numerical stability</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_em_toler_loglik">EM_toler_loglik</code></td>
<td>
<p>the convergence cutoff for the log-likelihood criterion
(&quot;Delta_L&quot; in the paper)</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_em_toler_est">EM_toler_est</code></td>
<td>
<p>the convergence cutoff for the parameter estimate criterion
(&quot;Delta_theta&quot; in the paper)</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_em_max_iterations">EM_max_iterations</code></td>
<td>
<p>the number of EM iterations to perform before giving up
if still not converged.</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_glm_tolerance">glm_tolerance</code></td>
<td>
<p>the convergence cutoff for the glm fit in the M step</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_glm_maxit">glm_maxit</code></td>
<td>
<p>the iterations cutoff for the glm fit in the M step</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_initial_s_estimate_location">initial_S_estimate_location</code></td>
<td>
<p>determines how seroconversion date is guessed
to initialize the algorithm; can be any decimal between 0 and 1; 0.5 =
midpoint imputation, 0.25 = 1st quartile, 0 = last negative, etc.</p>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_coef_change_metric">coef_change_metric</code></td>
<td>
<p>a string indicating the type of parameter estimate
criterion to use:
</p>

<ul>
<li><p> &quot;max abs rel diff coefs&quot; is the &quot;Delta_theta&quot; criterion
described in the paper.
</p>
</li>
<li><p> &quot;max abs diff coefs&quot; is the maximum absolute change in
the coefficients (not divided by the old values); this criterion can be useful
when some parameters are close to 0.
</p>
</li>
<li><p> &quot;diff mu&quot; is the absolute change in mu,
which may be helpful in the incidence estimate calibration setting but not
elsewhere.
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_joint_model_+3A_verbose">verbose</code></td>
<td>
<p>whether to print algorithm progress details to the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following elements:
</p>

<ul>
<li> <p><code>Theta</code>: the estimated regression coefficients for the model of p(Y|T)
</p>
</li>
<li> <p><code>Mu</code>: the estimated mean window period (a transformation of <code>Theta</code>)
</p>
</li>
<li> <p><code>Omega</code>: a table with the estimated parameters for the model of p(S|E).
</p>
</li>
<li> <p><code>converged</code>: indicator of whether the algorithm reached its cutoff criteria
before reaching the specified maximum iterations. 1 = reached cutoffs, 0 = not.
</p>
</li>
<li> <p><code>iterations</code>: the number of EM iterations completed before the algorithm
stopped.
</p>
</li>
<li> <p><code>convergence_metrics</code>: the four convergence metrics
</p>
</li></ul>



<h3>References</h3>

<p>Morrison, Laeyendecker, and Brookmeyer (2021).
&quot;Regression with interval-censored covariates: Application to cross-sectional incidence estimation&quot;.
Biometrics. doi: <a href="https://doi.org/10.1111/biom.13472">10.1111/biom.13472</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# simulate data:
study_data &lt;- simulate_interval_censoring()

# fit model:
EM_algorithm_outputs &lt;- fit_joint_model(
  obs_level_data = study_data$obs_data,
  participant_level_data = study_data$pt_data
)

## End(Not run)
</code></pre>

<hr>
<h2 id='fit_midpoint_model'>Fit model using midpoint imputation</h2><span id='topic+fit_midpoint_model'></span>

<h3>Description</h3>

<p>Fit model using midpoint imputation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_midpoint_model(
  participant_level_data,
  obs_level_data,
  maxit = 1000,
  tolerance = 1e-08
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_midpoint_model_+3A_participant_level_data">participant_level_data</code></td>
<td>
<p>a data.frame or tibble with the following variables:
</p>

<ul>
<li><p> ID: participant ID
</p>
</li>
<li><p> E: study enrollment date
</p>
</li>
<li><p> L: date of last negative test for seroconversion
</p>
</li>
<li><p> R: date of first positive test for seroconversion
</p>
</li>
<li><p> Cohort' (optional): this variable can be used to stratify the modeling of
the seroconversion distribution.
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_midpoint_model_+3A_obs_level_data">obs_level_data</code></td>
<td>
<p>a data.frame or tibble with the following variables:
</p>

<ul>
<li><p> ID: participant ID
</p>
</li>
<li><p> O: biomarker sample collection dates
</p>
</li>
<li><p> Y: MAA classifications (binary outcomes)
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_midpoint_model_+3A_maxit">maxit</code></td>
<td>
<p>maximum iterations, passed to <code>bigglm</code></p>
</td></tr>
<tr><td><code id="fit_midpoint_model_+3A_tolerance">tolerance</code></td>
<td>
<p>convergence criterion, passed to <code>bigglm</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of logistic regression coefficient estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_data = simulate_interval_censoring(
  "theta" = c(0.986, -3.88),
  "study_cohort_size" = 4500,
  "preconversion_interval_length" = 365,
  "hazard_alpha" = 1,
  "hazard_beta" = 0.5)

theta_est_midpoint = fit_midpoint_model(
  obs_level_data = sim_data$obs_data,
  participant_level_data = sim_data$pt_data
)

</code></pre>

<hr>
<h2 id='fit_uniform_model'>Fit model using uniform imputation</h2><span id='topic+fit_uniform_model'></span>

<h3>Description</h3>

<p>Fit model using uniform imputation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_uniform_model(
  participant_level_data,
  obs_level_data,
  maxit = 1000,
  tolerance = 1e-08,
  n_imputations = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_uniform_model_+3A_participant_level_data">participant_level_data</code></td>
<td>
<p>a data.frame or tibble with the following variables:
</p>

<ul>
<li><p> ID: participant ID
</p>
</li>
<li><p> E: study enrollment date
</p>
</li>
<li><p> L: date of last negative test for seroconversion
</p>
</li>
<li><p> R: date of first positive test for seroconversion
</p>
</li>
<li><p> Cohort' (optional): this variable can be used to stratify the modeling of
the seroconversion distribution.
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_uniform_model_+3A_obs_level_data">obs_level_data</code></td>
<td>
<p>a data.frame or tibble with the following variables:
</p>

<ul>
<li><p> ID: participant ID
</p>
</li>
<li><p> O: biomarker sample collection dates
</p>
</li>
<li><p> Y: MAA classifications (binary outcomes)
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_uniform_model_+3A_maxit">maxit</code></td>
<td>
<p>maximum iterations, passed to <code>bigglm</code></p>
</td></tr>
<tr><td><code id="fit_uniform_model_+3A_tolerance">tolerance</code></td>
<td>
<p>convergence criterion, passed to <code>bigglm</code></p>
</td></tr>
<tr><td><code id="fit_uniform_model_+3A_n_imputations">n_imputations</code></td>
<td>
<p>number of imputed data sets to create</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of logistic regression coefficient estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_data = simulate_interval_censoring(
  "theta" = c(0.986, -3.88),
  "study_cohort_size" = 4500,
  "preconversion_interval_length" = 365,
  "hazard_alpha" = 1,
  "hazard_beta" = 0.5)

theta_est_midpoint = fit_uniform_model(
  obs_level_data = sim_data$obs_data,
  participant_level_data = sim_data$pt_data
)

</code></pre>

<hr>
<h2 id='plot_CDF'>plot estimated and true CDFs for seroconversion date distribution</h2><span id='topic+plot_CDF'></span>

<h3>Description</h3>

<p>plot estimated and true CDFs for seroconversion date distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_CDF(true_hazard_alpha, true_hazard_beta, omega.hat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_CDF_+3A_true_hazard_alpha">true_hazard_alpha</code></td>
<td>
<p>The data-generating hazard at the start of the study</p>
</td></tr>
<tr><td><code id="plot_CDF_+3A_true_hazard_beta">true_hazard_beta</code></td>
<td>
<p>The change in data-generating hazard per calendar year</p>
</td></tr>
<tr><td><code id="plot_CDF_+3A_omega.hat">omega.hat</code></td>
<td>
<p>tibble of estimated discrete hazards</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

hazard_alpha = 1
hazard_beta = 0.5
study_data &lt;- simulate_interval_censoring(
  "hazard_alpha" = hazard_alpha,
  "hazard_beta" = hazard_beta)

# fit model:
EM_algorithm_outputs &lt;- fit_joint_model(
  obs_level_data = study_data$obs_data,
  participant_level_data = study_data$pt_data
)
plot1 = plot_CDF(
  true_hazard_alpha = hazard_alpha,
  true_hazard_beta = hazard_beta,
  omega.hat = EM_algorithm_outputs$Omega)

print(plot1)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot_phi_curves'>Plot true and estimated curves for P(Y=1|T=t)</h2><span id='topic+plot_phi_curves'></span>

<h3>Description</h3>

<p>Plot true and estimated curves for P(Y=1|T=t)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_phi_curves(
  theta_true,
  theta.hat_joint,
  theta.hat_midpoint,
  theta.hat_uniform
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_phi_curves_+3A_theta_true">theta_true</code></td>
<td>
<p>the coefficients of the data-generating model P(Y=1|T=t)</p>
</td></tr>
<tr><td><code id="plot_phi_curves_+3A_theta.hat_joint">theta.hat_joint</code></td>
<td>
<p>the estimated coefficients from the joint model</p>
</td></tr>
<tr><td><code id="plot_phi_curves_+3A_theta.hat_midpoint">theta.hat_midpoint</code></td>
<td>
<p>the estimated coefficients from midpoint imputation</p>
</td></tr>
<tr><td><code id="plot_phi_curves_+3A_theta.hat_uniform">theta.hat_uniform</code></td>
<td>
<p>the estimated coefficients from uniform imputation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

theta_true = c(0.986, -3.88)
hazard_alpha = 1
hazard_beta = 0.5
sim_data = simulate_interval_censoring(
  "theta" = theta_true,
  "study_cohort_size" = 4500,
  "preconversion_interval_length" = 365,
  "hazard_alpha" = hazard_alpha,
  "hazard_beta" = hazard_beta)

# extract the participant-level and observation-level simulated data:
sim_participant_data = sim_data$pt_data
sim_obs_data = sim_data$obs_data
rm(sim_data)

# joint model:
EM_algorithm_outputs = fit_joint_model(
  obs_level_data = sim_obs_data,
  participant_level_data = sim_participant_data,
  bin_width = 7,
  verbose = FALSE)

# midpoint imputation:
theta_est_midpoint = fit_midpoint_model(
  obs_level_data = sim_obs_data,
  participant_level_data = sim_participant_data
)

# uniform imputation:
theta_est_uniform = fit_uniform_model(
  obs_level_data = sim_obs_data,
  participant_level_data = sim_participant_data
)
plot2 = plot_phi_curves(
  theta_true = theta_true,
  theta.hat_uniform = theta_est_uniform,
  theta.hat_midpoint = theta_est_midpoint,
  theta.hat_joint = EM_algorithm_outputs$Theta)

print(plot2)

## End(Not run)

</code></pre>

<hr>
<h2 id='rwicc'>rwicc: Regression with Interval-Censored Covariates</h2><span id='topic+rwicc'></span>

<h3>Description</h3>

<p>The <code>rwicc</code> package implements a regression model with an
interval-censored covariate using an EM algorithm, as described in Morrison et al (2021); doi: <a href="https://doi.org/10.1111/biom.13472">10.1111/biom.13472</a>.
</p>


<h3>rwicc functions</h3>

<p>The main <code>rwicc</code> functions are:
</p>

<ul>
<li> <p><code><a href="#topic+simulate_interval_censoring">simulate_interval_censoring</a></code>
</p>
</li>
<li> <p><code><a href="#topic+fit_joint_model">fit_joint_model</a></code>
</p>
</li></ul>



<h3>References</h3>

<p>Morrison, Laeyendecker, and Brookmeyer (2021).
&quot;Regression with interval-censored covariates: Application to cross-sectional incidence estimation&quot;.
Biometrics. doi: <a href="https://doi.org/10.1111/biom.13472">10.1111/biom.13472</a>.
</p>

<hr>
<h2 id='seroconversion_inverse_survival_function'>Inverse survival function for time-to-event variable with linear hazard function</h2><span id='topic+seroconversion_inverse_survival_function'></span>

<h3>Description</h3>

<p>This function determines the seroconversion date corresponding to a provided
probability of survival. See doi: <a href="https://doi.org/10.1111/biom.13472">10.1111/biom.13472</a>,
Supporting Information, Section A.4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seroconversion_inverse_survival_function(u, e, hazard_alpha, hazard_beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seroconversion_inverse_survival_function_+3A_u">u</code></td>
<td>
<p>a vector of seroconversion survival probabilities</p>
</td></tr>
<tr><td><code id="seroconversion_inverse_survival_function_+3A_e">e</code></td>
<td>
<p>a vector of time differences between study start and enrollment (in years)</p>
</td></tr>
<tr><td><code id="seroconversion_inverse_survival_function_+3A_hazard_alpha">hazard_alpha</code></td>
<td>
<p>the instantaneous hazard of seroconversion on the study start date</p>
</td></tr>
<tr><td><code id="seroconversion_inverse_survival_function_+3A_hazard_beta">hazard_beta</code></td>
<td>
<p>the change in hazard per year after study start date</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of time differences between study start and seroconversion (in years)
</p>


<h3>References</h3>

<p>Morrison, Laeyendecker, and Brookmeyer (2021).
&quot;Regression with interval-censored covariates: Application to cross-sectional incidence estimation&quot;.
Biometrics, doi: <a href="https://doi.org/10.1111/biom.13472">10.1111/biom.13472</a>.
</p>

<hr>
<h2 id='simulate_interval_censoring'>Simulate a dataset with interval-censored seroconversion dates</h2><span id='topic+simulate_interval_censoring'></span>

<h3>Description</h3>

<p><code>simulate_interval_censoring</code> generates a simulated data set from a
data-generating model based on the typical structure of a cohort study of HIV
biomarker progression, as described in Morrison et al (2021); doi: <a href="https://doi.org/10.1111/biom.13472">10.1111/biom.13472</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_interval_censoring(
  study_cohort_size = 4500,
  hazard_alpha = 1,
  hazard_beta = 0.5,
  preconversion_interval_length = 84,
  theta = c(0.986, -3.88),
  probability_of_ever_seroconverting = 0.05,
  years_in_study = 10,
  max_scheduling_offset = 7,
  days_from_study_start_to_recruitment_end = 365,
  study_start_date = lubridate::ymd("2001-01-01")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_interval_censoring_+3A_study_cohort_size">study_cohort_size</code></td>
<td>
<p>the number of participants to simulate (N_0 in the
paper)</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_hazard_alpha">hazard_alpha</code></td>
<td>
<p>the hazard (instantaneous risk) of seroconversion at the
start date of the cohort study for those participants at risk of
seroconversion</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_hazard_beta">hazard_beta</code></td>
<td>
<p>the change in hazard per calendar year</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_preconversion_interval_length">preconversion_interval_length</code></td>
<td>
<p>the number of days between tests for
seroconversion</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_theta">theta</code></td>
<td>
<p>the parameters of a logistic model (with linear functional from)
specifying the probability of MAA-positive biomarkers as a function of time
since seroconversion</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_probability_of_ever_seroconverting">probability_of_ever_seroconverting</code></td>
<td>
<p>the probability that each
participant is at risk of HIV seroconversion</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_years_in_study">years_in_study</code></td>
<td>
<p>the duration of follow-up for each participant</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_max_scheduling_offset">max_scheduling_offset</code></td>
<td>
<p>the maximum divergence of pre-seroconversion
followup visits from the prescribed schedule</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_days_from_study_start_to_recruitment_end">days_from_study_start_to_recruitment_end</code></td>
<td>
<p>the length of the recruitment
period</p>
</td></tr>
<tr><td><code id="simulate_interval_censoring_+3A_study_start_date">study_start_date</code></td>
<td>
<p>the date when the study starts recruitment (&quot;d_0&quot; in
the main text). The value of this parameter does not affect the simulation
results; it is only necessary as a reference point for generating E, L, R,
O, and S.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following two tibbles:
</p>

<ul>
<li> <p><code>pt_data</code>: a tibble of participant-level information, with the following columns:
</p>

<ul>
<li> <p><code>ID</code>: participant ID
</p>
</li>
<li> <p><code>E</code>: enrollment date
</p>
</li>
<li> <p><code>L</code>: date of last HIV test prior to seroconversion
</p>
</li>
<li> <p><code>R</code>: date of first HIV test after seroconversion
</p>
</li></ul>

</li>
<li> <p><code>obs_data</code>: a tibble of longitudinal observations with the following columns:
</p>

<ul>
<li> <p><code>ID</code>: participant ID
</p>
</li>
<li> <p><code>O</code>: dates of biomarker sample collection
</p>
</li>
<li> <p><code>Y</code>: MAA classifications of biomarker samples
</p>
</li></ul>
</li></ul>



<h3>References</h3>

<p>Morrison, Laeyendecker, and Brookmeyer (2021).
&quot;Regression with interval-censored covariates: Application to cross-sectional incidence estimation&quot;.
Biometrics. doi: <a href="https://doi.org/10.1111/biom.13472">10.1111/biom.13472</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>study_data &lt;- simulate_interval_censoring()
participant_characteristics &lt;- study_data$pt_data
longitudinal_observations &lt;- study_data$obs_data
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
