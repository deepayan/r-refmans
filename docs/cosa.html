<!DOCTYPE html><html><head><title>Help for package cosa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cosa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cosa-package'><p>Bound Constrained Optimal Design of MRDDs and MRTs</p></a></li>
<li><a href='#bcrd3r2'><p>Blocked (Random) Cluster-level Regression Discontinuity (Three-level Design, Discontinuity at Level 2)</p></a></li>
<li><a href='#bcrd4r2'><p>Blocked (Random) Cluster-level Regression Discontinuity (Four-level Design, Discontinuity at Level 2)</p></a></li>
<li><a href='#bcrd4r3'><p>Blocked (Random) Cluster-level Regression Discontinuity (Four-level Design, Discontinuity at Level 3)</p></a></li>
<li><a href='#bird2'><p>Blocked (Random) Individual-level Regression Discontinuity (Two-level Design, Discontinuity at Level 1)</p></a></li>
<li><a href='#bird3'><p>Blocked (Random) Individual-level Regression Discontinuity (Three-level Design, Discontinuity at Level 1)</p></a></li>
<li><a href='#bird4'><p>Blocked (Random) Individual-level Regression Discontinuity (Four-level Design, Discontinuity at Level 1)</p></a></li>
<li><a href='#cosa-deprecated'><p>Deprecated and Defunct functions in <span class="pkg">cosa</span></p></a></li>
<li><a href='#crd2'><p>Cluster-level Regression Discontinuity (Two-level Design, Discontinuity at Level 2, w/ or w/o Strata or Fixed Blocks)</p></a></li>
<li><a href='#crd3'><p>Cluster-level Regression Discontinuity (Three-level Design, Discontinuity at Level 3, w/ or w/o Strata or Fixed Blocks)</p></a></li>
<li><a href='#crd4'><p>Cluster-level Regression Discontinuity (Four-level Design, Discontinuity at Level 4)</p></a></li>
<li><a href='#inspect.score'><p>Computes Regression Discontinuity Design Effects</p></a></li>
<li><a href='#ird'><p>Simple Individual-level Regression Discontinuity (w/ or w/o Strata or Fixed Blocks)</p></a></li>
<li><a href='#moments'><p>Moments</p></a></li>
<li><a href='#plot'><p>Power and MDES Curves</p></a></li>
<li><a href='#Vectorize BCOSSA'><p>Vectorizes BCOSSA Solutions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bound Constrained Optimal Sample Size Allocation</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-20</td>
</tr>
<tr>
<td>Description:</td>
<td>
  Implements bound constrained optimal sample size allocation (BCOSSA) framework described in Bulus &amp; Dong (2021) &lt;<a href="https://doi.org/10.1080%2F00220973.2019.1636197">doi:10.1080/00220973.2019.1636197</a>&gt; for power analysis of multilevel regression discontinuity designs (MRDDs) and multilevel randomized trials (MRTs) with continuous outcomes.
  Minimum detectable effect size (MDES) and power computations for MRDDs allow polynomial functional form specification for the score variable (with or without interaction with the treatment indicator). See Bulus (2021) &lt;<a href="https://doi.org/10.1080%2F19345747.2021.1947425">doi:10.1080/19345747.2021.1947425</a>&gt;. </td>
</tr>
<tr>
<td>Imports:</td>
<td>nloptr(&ge; 1.0.4), msm(&ge; 1.6.7)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-20 19:36:17 UTC; LENOVO</td>
</tr>
<tr>
<td>Author:</td>
<td>Metin Bulus [aut, cre],
  Nianbo Dong [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Metin Bulus &lt;bulusmetin@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-20 22:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='cosa-package'>Bound Constrained Optimal Design of MRDDs and MRTs</h2><span id='topic+cosa-package'></span>

<h3>Description</h3>

<p>Bound Constrained Optimal Sample Size Allocation (BCOSSA) functions are designed to optimize sample sizes at one or more levels subject to budget, statistical power, or effect size constraints. BCOSSA can be found in the following forms; (i) under budgetary constraints given marginal costs per unit while minimizing sampling variance of the treatment effect (or, alternatively, while maximizing power rate), (ii) under statistical power or effect size (ES) constraints while minimizing the total cost, and (iii) under sample size constraints for one or more levels along with (i) or (ii). Specifying <code>rhots = 0</code> or <code>order = 0</code> produces results equivalent to corresponding random assignment designs, which means there is no relationship between the treatment [randomly assigned] and the score variable. Therefore, BCOSSA functions also allow optimization of treatment group sampling rate (<code>p</code>) under unequal marginal costs when primary constraint is placed on the total cost. Different starting values and algorithms may produce different results when marginal cost information is not provided and sample sizes at two or more levels and <code>p</code> are optimized because the design is not uniquely identified. In such cases, experimenting different starting values and/or comparing several algorithms may faciliate decisions regarding sample sizes and <code>p</code>.
</p>
<p>Designs available in the <span class="pkg">cosa</span> package:
</p>

<table>
<tr>
 <td style="text-align: right;">
    <em>Design</em>  </td><td style="text-align: center;"> <em>Total Levels</em> </td><td style="text-align: center;"> <em>Treatment Level</em>  </td><td style="text-align: center;"> <em>Top Level</em></td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>ird</code>  </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bird2</code> </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bird2f1</code> </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> fixed   </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bird3</code> </td><td style="text-align: center;"> 3 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bird4</code> </td><td style="text-align: center;"> 4 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>crd2</code>  </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bcrd3f2</code> </td><td style="text-align: center;"> 3 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> fixed   </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bcrd3r2</code> </td><td style="text-align: center;"> 3 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bcrd4r2</code> </td><td style="text-align: center;"> 4 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>crd3</code>  </td><td style="text-align: center;"> 3 </td><td style="text-align: center;"> 3 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bcrd4f3</code> </td><td style="text-align: center;"> 4 </td><td style="text-align: center;"> 3 </td><td style="text-align: center;"> fixed   </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>bcrd4r3</code> </td><td style="text-align: center;"> 4 </td><td style="text-align: center;"> 3 </td><td style="text-align: center;"> random  </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>crd4</code>  </td><td style="text-align: center;"> 4 </td><td style="text-align: center;"> 4 </td><td style="text-align: center;"> random
</td>
</tr>

</table>

<p><code>ird</code>: individual-level regression discontinuity.
<code>bird</code>: blocked individual-level regression discontinuity.
<code>crd</code>: cluster-level regression discontinuity.
<code>bcrd</code>: blocked cluster-level regression discontinuity.
</p>
<p>Design parameters follow a sequential order. Numbers at the end of a sequential parameter refers to the corresponding level. For example <code>rho2</code> is the proportion of variance in the outcome between level 2 units, <code>rho3</code> is the proportion of variance in the outcome between level 3 units. Similiarly, <code>r21</code> is the proportion of the variance in the outcome explained by level 1 covariates, <code>r22</code> is the proportion of the variance in the outcome explained by level 2 covariates and so on. Similiar naming conventions applies to other design parameters.
</p>

<hr>
<h2 id='bcrd3r2'>Blocked (Random) Cluster-level Regression Discontinuity (Three-level Design, Discontinuity at Level 2)</h2><span id='topic+bcrd3r2'></span><span id='topic+cosa.bcrd3r2'></span><span id='topic+mdes.bcrd3r2'></span><span id='topic+power.bcrd3r2'></span>

<h3>Description</h3>

<p>Use <code>mdes.bcrd3r2()</code> to calculate minimum detectable effect size, <code>power.bcrd3r2()</code> to calculate statistical power, and <code>cosa.bcrd3r2()</code> for bound constrained optimal sample size allocation (BCOSSA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bcrd3r2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             power = .80, alpha = .05, two.tailed = TRUE, df = n3 - g3 - 1,
             rho2, rho3, omega3, r21 = 0, r22 = 0, r2t3 = 0, g3 = 0,
             rate.tp = 1, rate.cc = 0, n1, n2, n3)

power.bcrd3r2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
              order = 1, interaction = FALSE,
              treat.lower = TRUE, cutoff = 0, p = NULL,
              es = .25, alpha = .05, two.tailed = TRUE, df = n3 - g3 - 1,
              rho2, rho3, omega3, r21 = 0, r22 = 0, r2t3 = 0, g3 = 0,
              rate.tp = 1, rate.cc = 0, n1, n2, n3)

cosa.bcrd3r2(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             cn1 = 0, cn2 = 0, cn3 = 0, cost = NULL,
             n1 = NULL, n2 = NULL, n3 = NULL, n0 = c(10, 3, 100), p0 = .499,
             constrain = "power", round = TRUE, max.power = FALSE,
             local.solver = c("LBFGS", "SLSQP"),
             power = .80, es = .25, alpha = .05, two.tailed = TRUE,
             rho2, rho3, omega3, g3 = 0, r21 = 0, r22 = 0, r2t3 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bcrd3r2_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_p">p</code></td>
<td>
<p>proportion of level 2 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_omega3">omega3</code></td>
<td>
<p>ratio of the treatment effect variance between level 3 units to the variance in the outcome between level 3 units.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_g3">g3</code></td>
<td>
<p>number of covariates at level 3.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_r2t3">r2t3</code></td>
<td>
<p>proportion of treatment effect variance between level 3 units explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_n2">n2</code></td>
<td>
<p>average number of level 2 units per level 3 unit.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_n3">n3</code></td>
<td>
<p>number of level 3 units (blocks).</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_cn2">cn2</code></td>
<td>
<p>marginal costs per level 2 unit in treatment and control conditions (positional), e.g. <code>c(50, 20)</code>.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_cn3">cn3</code></td>
<td>
<p>marginal cost per level 3 unit.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2, n3</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="bcrd3r2_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

power.bcrd3r2(score.obj,
              es = 0.25, rho2 = .20, rho3 = .10, omega3 = .30,
              g3 = 0, r2t3 = 0, n1 = 50, n2 = 10, n3 = 10)

# minimum required number of level 2 units for each block
cosa.bcrd3r2(score.obj,
             es = 0.25, rho2 = .20, rho3 = .10, omega3 = .30,
             g3 = 0, r2t3 = 0,
             n1 = 50, n2 = NULL, n3 = 10)
</code></pre>

<hr>
<h2 id='bcrd4r2'>Blocked (Random) Cluster-level Regression Discontinuity (Four-level Design, Discontinuity at Level 2)</h2><span id='topic+bcrd4r2'></span><span id='topic+cosa.bcrd4r2'></span><span id='topic+mdes.bcrd4r2'></span><span id='topic+power.bcrd4r2'></span>

<h3>Description</h3>

<p>Use <code>mdes.bcrd4r2()</code> to calculate minimum detectable effect size, <code>power.bcrd4r2()</code> to calculate statistical power, and use <code>cosa.bcrd4r2()</code> for bound constrained optimal sample size allocation (BCOSSA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bcrd4r2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             power = .80, alpha = .05, two.tailed = TRUE, df = n4 - g4 - 1,
             rho2, rho3, rho4, omega3, omega4,
             r21 = 0, r22 = 0, r2t3 = 0, r2t4 = 0, g4 = 0,
             rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

power.bcrd4r2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
              order = 1, interaction = FALSE,
              treat.lower = TRUE, cutoff = 0, p = NULL,
              es = .25, alpha = .05, two.tailed = TRUE, df = n4 - g4 - 1,
              rho2, rho3, rho4, omega3, omega4,
              r21 = 0, r22 = 0, r2t3 = 0, r2t4 = 0, g4 = 0,
              rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

cosa.bcrd4r2(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             cn1 = 0, cn2 = 0, cn3 = 0, cn4 = 0, cost = NULL,
             n1 = NULL, n2 = NULL, n3 = NULL, n4 = NULL,
             n0 = c(10, 3, 100, 5 + g4), p0 = .499,
             constrain = "power", round = TRUE, max.power = FALSE,
             local.solver = c("LBFGS", "SLSQP"),
             power = .80, es = .25, alpha = .05, two.tailed = TRUE,
             rho2, rho3, rho4, omega3, omega4,
             g4 = 0, r21 = 0, r22 = 0, r2t3 = 0, r2t4 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bcrd4r2_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_p">p</code></td>
<td>
<p>proportion of level 2 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_rho4">rho4</code></td>
<td>
<p>proportion of variance in the outcome between level 4 units (unconditional ICC4).</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_omega3">omega3</code></td>
<td>
<p>ratio of the treatment effect variance between level 3 units to the variance in the outcome between level 3 units.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_omega4">omega4</code></td>
<td>
<p>ratio of the treatment effect variance between level 4 units to the variance in the outcome between level 4 units.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_g4">g4</code></td>
<td>
<p>number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_r2t3">r2t3</code></td>
<td>
<p>proportion of treatment effect variance between level 3 units explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_r2t4">r2t4</code></td>
<td>
<p>proportion of treatment effect variance between level 4 units explained by level 4 covariates.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_n2">n2</code></td>
<td>
<p>average number of level 2 units per level 3 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_n3">n3</code></td>
<td>
<p>average number of level 3 units (blocks) per level 4 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_n4">n4</code></td>
<td>
<p>number of level 4 units (blocks).</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_cn2">cn2</code></td>
<td>
<p>marginal costs per level 2 unit in treatment and control conditions (positional), e.g. <code>c(50, 20)</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_cn3">cn3</code></td>
<td>
<p>marginal cost per level 3 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_cn4">cn4</code></td>
<td>
<p>marginal cost per level 4 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2, n3, n4</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r2_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

power.bcrd4r2(score.obj,
              es = 0.25, rho2 = .20, rho3 = .10, rho4 = .05,
              omega3 = .30, omega4 = .30,
              g4 = 0, r2t4 = 0,
              n1 = 20, n2 = 3, n3 = 20, n4 = 10)

# minimum required number of level 2 units for each one of the level 3 block
cosa.bcrd4r2(score.obj,
             es = 0.25, rho2 = .20, rho3 = .10, rho4 = .05,
             omega3 = .30, omega4 = .30,
             g4 = 0, r2t4 = 0,
             n1 = 20, n2 = NULL, n3 = 20, n4 = 10)
</code></pre>

<hr>
<h2 id='bcrd4r3'>Blocked (Random) Cluster-level Regression Discontinuity (Four-level Design, Discontinuity at Level 3)</h2><span id='topic+bcrd4r3'></span><span id='topic+cosa.bcrd4r3'></span><span id='topic+mdes.bcrd4r3'></span><span id='topic+power.bcrd4r3'></span>

<h3>Description</h3>

<p>Use <code>mdes.bcrd4r3()</code> to calculate minimum detectable effect size, <code>power.bcrd4r3()</code> to calculate statistical power, and <code>cosa.bcrd4r3()</code> for bound constrained optimal sample size allocation (BCOSSA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bcrd4r3(score = NULL, dists = "normal", k1 = -6, k2 = 6,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             power = .80, alpha = .05, two.tailed = TRUE, df = n4 - g4 - 1,
             rho2, rho3, rho4, omega4,
             r21 = 0, r22 = 0, r23 = 0, r2t4 = 0, g4 = 0,
             rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

power.bcrd4r3(score = NULL, dists = "normal", k1 = -6, k2 = 6,
              order = 1, interaction = FALSE,
              treat.lower = TRUE, cutoff = 0, p = NULL,
              es = .25, alpha = .05, two.tailed = TRUE, df = n4 - g4 - 1,
              rho2, rho3, rho4, omega4,
              r21 = 0, r22 = 0, r23 = 0, r2t4 = 0, g4 = 0,
              rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

cosa.bcrd4r3(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             cn1 = 0, cn2 = 0, cn3 = 0, cn4 = 0, cost = NULL,
             n1 = NULL, n2 = NULL, n3 = NULL, n4 = NULL,
             n0 = c(10, 3, 100, 5 + g4), p0 = .499,
             constrain = "power", round = TRUE, max.power = FALSE,
             local.solver = c("LBFGS", "SLSQP"),
             power = .80, es = .25, alpha = .05, two.tailed = TRUE,
             rho2, rho3, rho4, omega4,
             g4 = 0, r21 = 0, r22 = 0, r23 = 0, r2t4 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bcrd4r3_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_p">p</code></td>
<td>
<p>proportion of level 3 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_rho4">rho4</code></td>
<td>
<p>proportion of variance in the outcome between level 4 units (unconditional ICC4).</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_omega4">omega4</code></td>
<td>
<p>ratio of the treatment effect variance between level 4 units to the variance in the outcome between level 4 units.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_g4">g4</code></td>
<td>
<p>number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_r23">r23</code></td>
<td>
<p>proportion of level 3 variance in the outcome explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_r2t4">r2t4</code></td>
<td>
<p>proportion of treatment effect variance between level 4 units explained by level 4 covariates.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_n2">n2</code></td>
<td>
<p>average number of level 2 units per level 3 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_n3">n3</code></td>
<td>
<p>average number of level 3 units per level 4 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_n4">n4</code></td>
<td>
<p>number of level 4 units (blocks).</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_cn2">cn2</code></td>
<td>
<p>marginal costs per level 2 unit in treatment and control conditions (positional), e.g. <code>c(50, 20)</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_cn3">cn3</code></td>
<td>
<p>marginal costs per level 3 unit in treatment and control conditions (positional), e.g. <code>c(80, 50)</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_cn4">cn4</code></td>
<td>
<p>marginal cost per level 4 unit.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2, n3, n4</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="bcrd4r3_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

power.bcrd4r3(score.obj,
              es = 0.25, rho2 = .20, rho3 = .10, rho4 = .05,
              omega4 = .30, g4 = 0, r2t4 = 0,
              n1 = 20, n2 = 3, n3 = 20, n4 = 10)

# minimum required number of level 3 units for each one of the level 4 block
cosa.bcrd4r3(score.obj,
             es = 0.25, rho2 = .20, rho3 = .10, rho4 = .05,
             omega4 = .30, g4 = 0, r2t4 = 0,
             n1 = 20, n2 = 3, n3 = NULL, n4 = 10)
</code></pre>

<hr>
<h2 id='bird2'>Blocked (Random) Individual-level Regression Discontinuity (Two-level Design, Discontinuity at Level 1)</h2><span id='topic+bird2r1'></span><span id='topic+bird2'></span><span id='topic+cosa.bird2r1'></span><span id='topic+cosa.bird2'></span><span id='topic+mdes.bird2r1'></span><span id='topic+mdes.bird2'></span><span id='topic+power.bird2r1'></span><span id='topic+power.bird2'></span>

<h3>Description</h3>

<p>Use <code>mdes.bird2()</code> to calculate minimum detectable effect size, <code>power.bird2()</code> to calculate statistical power, and <code>cosa.bird2()</code> for bound constrained optimal sample size allocation (BCOSSA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bird2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           power = .80, alpha = .05, two.tailed = TRUE, df = n2 - g2 - 1,
           rho2, omega2, r21 = 0, r2t2 = 0, g2 = 0,
           rate.tp = 1, rate.cc = 0, n1, n2)

power.bird2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
            order = 1, interaction = FALSE,
            treat.lower = TRUE, cutoff = 0, p = NULL,
            es = .25, alpha = .05, two.tailed = TRUE, df = n2 - g2 - 1,
            rho2, omega2, r21 = 0, r2t2 = 0, g2 = 0,
            rate.tp = 1, rate.cc = 0, n1, n2)

cosa.bird2(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           cn1 = 0, cn2 = 0, cost = NULL,
           n1 = NULL, n2 = NULL, n0 = c(10, 100), p0 = .499,
           constrain = "power", round = TRUE, max.power = FALSE,
           local.solver = c("LBFGS", "SLSQP"),
           power = .80, es = .25, alpha = .05, two.tailed = TRUE,
           rho2, omega2, g2 = 0, r21 = 0, r2t2 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bird2_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="bird2_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="bird2_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bird2_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bird2_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="bird2_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="bird2_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="bird2_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="bird2_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="bird2_+3A_p">p</code></td>
<td>
<p>proportion of level 1 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="bird2_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="bird2_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="bird2_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="bird2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="bird2_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="bird2_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bird2_+3A_omega2">omega2</code></td>
<td>
<p>ratio of the treatment effect variance between level 2 units to the variance in the outcome between level 2 units.</p>
</td></tr>
<tr><td><code id="bird2_+3A_g2">g2</code></td>
<td>
<p>number of covariates at level 2.</p>
</td></tr>
<tr><td><code id="bird2_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bird2_+3A_r2t2">r2t2</code></td>
<td>
<p>proportion of treatment effect variance between level 2 units explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bird2_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="bird2_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="bird2_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 units.</p>
</td></tr>
<tr><td><code id="bird2_+3A_n2">n2</code></td>
<td>
<p>number of level 2 units (blocks).</p>
</td></tr>
<tr><td><code id="bird2_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="bird2_+3A_cn2">cn2</code></td>
<td>
<p>marginal cost per level 2 unit.</p>
</td></tr>
<tr><td><code id="bird2_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>.</p>
</td></tr>
<tr><td><code id="bird2_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="bird2_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="bird2_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="bird2_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="bird2_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="bird2_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

power.bird2(score.obj,
            es = 0.25, rho2 = .20, omega2 = .30,
            g2 = 0, r2t2 = 0, n1 = 50, n2 = 30)

# minimum required number of level 1 units for each one of the level 2 block
cosa.bird2(score.obj,
           es = 0.25, rho2 = .20, omega2 = .30,
           g2 = 0, r2t2 = 0,
           n1 = NULL, n2 = 30)
</code></pre>

<hr>
<h2 id='bird3'>Blocked (Random) Individual-level Regression Discontinuity (Three-level Design, Discontinuity at Level 1)</h2><span id='topic+bird3r1'></span><span id='topic+bird3'></span><span id='topic+cosa.bird3r1'></span><span id='topic+cosa.bird3'></span><span id='topic+mdes.bird3r1'></span><span id='topic+mdes.bird3'></span><span id='topic+power.bird3r1'></span><span id='topic+power.bird3'></span>

<h3>Description</h3>

<p>Use <code>mdes.bird3()</code> to calculate minimum detectable effect size, <code>power.bird3()</code> to calculate statistical power, and <code>cosa.bird3()</code> for bound constrained optimal sample size allocation (BCOSSA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bird3(score = NULL, dists = "normal", k1 = -6, k2 = 6,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           power = .80, alpha = .05, two.tailed = TRUE, df = n3 - g3 - 1,
           rho2, rho3, omega2, omega3, r21 = 0, r2t2 = 0, r2t3 = 0, g3 = 0,
           rate.tp = 1, rate.cc = 0, n1, n2, n3)

power.bird3(score = NULL, dists = "normal", k1 = -6, k2 = 6,
            order = 1, interaction = FALSE,
            treat.lower = TRUE, cutoff = 0, p = NULL,
            es = .25, alpha = .05, two.tailed = TRUE, df = n3 - g3 - 1,
            rho2, rho3, omega2, omega3, r21 = 0, r2t2 = 0, r2t3 = 0, g3 = 0,
            rate.tp = 1, rate.cc = 0, n1, n2, n3)

cosa.bird3(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           cn1 = 0, cn2 = 0, cn3 = 0, cost = NULL,
           n1 = NULL, n2 = NULL, n3 = NULL,
           n0 = c(10, 3, 100), p0 = .499,
           constrain = "power", round = TRUE, max.power = FALSE,
           local.solver = c("LBFGS", "SLSQP"),
           power = .80, es = .25, alpha = .05, two.tailed = TRUE,
           rho2, rho3, omega2, omega3,
           g3 = 0, r21 = 0, r2t2 = 0, r2t3 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bird3_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="bird3_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="bird3_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bird3_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bird3_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="bird3_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="bird3_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="bird3_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="bird3_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="bird3_+3A_p">p</code></td>
<td>
<p>proportion of level 1 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="bird3_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="bird3_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="bird3_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="bird3_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="bird3_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="bird3_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bird3_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bird3_+3A_omega2">omega2</code></td>
<td>
<p>ratio of the treatment effect variance between level 2 units to the variance in the outcome between level 2 units.</p>
</td></tr>
<tr><td><code id="bird3_+3A_omega3">omega3</code></td>
<td>
<p>ratio of the treatment effect variance between level 3 units to the variance in the outcome between level 3 units.</p>
</td></tr>
<tr><td><code id="bird3_+3A_g3">g3</code></td>
<td>
<p>number of covariates at level 3.</p>
</td></tr>
<tr><td><code id="bird3_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bird3_+3A_r2t2">r2t2</code></td>
<td>
<p>proportion of treatment effect variance between level 2 units explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bird3_+3A_r2t3">r2t3</code></td>
<td>
<p>proportion of treatment effect variance between level 3 units explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bird3_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="bird3_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="bird3_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td></tr>
<tr><td><code id="bird3_+3A_n2">n2</code></td>
<td>
<p>average number of level 2 units (blocks) per level 3 unit.</p>
</td></tr>
<tr><td><code id="bird3_+3A_n3">n3</code></td>
<td>
<p>number of level 3 units (blocks).</p>
</td></tr>
<tr><td><code id="bird3_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="bird3_+3A_cn2">cn2</code></td>
<td>
<p>marginal cost per level 2 unit.</p>
</td></tr>
<tr><td><code id="bird3_+3A_cn3">cn3</code></td>
<td>
<p>marginal cost per level 3 unit.</p>
</td></tr>
<tr><td><code id="bird3_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>.</p>
</td></tr>
<tr><td><code id="bird3_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="bird3_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2, n3</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="bird3_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="bird3_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="bird3_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="bird3_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

power.bird3(score.obj,
            es = 0.25, rho2 = .20, rho3 = .10,
            omega2 = .30, omega3 = .30,
            g3 = 0, r2t3 = 0,
            n1 = 20, n2 = 3, n3 = 20)

# minimum required number of level 1 units for each one of the level 2 block
cosa.bird3(score.obj,
           es = 0.25, rho2 = .20, rho3 = .10,
           omega2 = .30, omega3 = .30,
           g3 = 0, r2t3 = 0,
           n1 = NULL, n2 = 3, n3 = 20)
</code></pre>

<hr>
<h2 id='bird4'>Blocked (Random) Individual-level Regression Discontinuity (Four-level Design, Discontinuity at Level 1)</h2><span id='topic+bird4r1'></span><span id='topic+bird4'></span><span id='topic+cosa.bird4r1'></span><span id='topic+cosa.bird4'></span><span id='topic+mdes.bird4r1'></span><span id='topic+mdes.bird4'></span><span id='topic+power.bird4r1'></span><span id='topic+power.bird4'></span>

<h3>Description</h3>

<p>Use <code>mdes.bird4()</code> to calculate minimum detectable effect size, <code>power.bird4()</code> to calculate statistical power, and <code>cosa.bird4()</code> for bound constrained optimal sample size allocation (BCOSSA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.bird4(score = NULL, dists = "normal", k1 = -6, k2 = 6,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           power = .80, alpha = .05, two.tailed = TRUE, df = n4 - g4 - 1,
           rho2, rho3, rho4, omega2, omega3, omega4,
           r21 = 0, r2t2 = 0, r2t3 = 0, r2t4 = 0, g4 = 0,
           rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

power.bird4(score = NULL, dists = "normal", k1 = -6, k2 = 6,
            order = 1, interaction = FALSE,
            treat.lower = TRUE, cutoff = 0, p = NULL,
            es = .25, alpha = .05, two.tailed = TRUE, df = n4 - g4 - 1,
            rho2, rho3, rho4, omega2, omega3, omega4,
            r21 = 0, r2t2 = 0, r2t3 = 0, r2t4 = 0, g4 = 0,
            rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

cosa.bird4(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           cn1 = 0, cn2 = 0, cn3 = 0, cn4 = 0, cost = NULL,
           n1 = NULL, n2 = NULL, n3 = NULL, n4 = NULL,
           n0 = c(10, 3, 100, 5 + g4), p0 = .499,
           constrain = "power", round = TRUE, max.power = FALSE,
           local.solver = c("LBFGS", "SLSQP"),
           power = .80, es = .25, alpha = .05, two.tailed = TRUE,
           rho2, rho3, rho4, omega2, omega3, omega4,
           g4 = 0, r21 = 0, r2t2 = 0, r2t3 = 0, r2t4 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bird4_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="bird4_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="bird4_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bird4_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="bird4_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="bird4_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="bird4_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="bird4_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="bird4_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="bird4_+3A_p">p</code></td>
<td>
<p>proportion of level 1 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="bird4_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="bird4_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="bird4_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="bird4_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="bird4_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="bird4_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="bird4_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="bird4_+3A_rho4">rho4</code></td>
<td>
<p>proportion of variance in the outcome between level 4 units (unconditional ICC4).</p>
</td></tr>
<tr><td><code id="bird4_+3A_omega2">omega2</code></td>
<td>
<p>ratio of the treatment effect variance between level 2 units to the variance in the outcome between level 2 units.</p>
</td></tr>
<tr><td><code id="bird4_+3A_omega3">omega3</code></td>
<td>
<p>ratio of the treatment effect variance between level 3 units to the variance in the outcome between level 3 units.</p>
</td></tr>
<tr><td><code id="bird4_+3A_omega4">omega4</code></td>
<td>
<p>ratio of the treatment effect variance between level 4 units to the variance in the outcome between level 4 units.</p>
</td></tr>
<tr><td><code id="bird4_+3A_g4">g4</code></td>
<td>
<p>number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="bird4_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="bird4_+3A_r2t2">r2t2</code></td>
<td>
<p>proportion of treatment effect variance between level 2 units explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="bird4_+3A_r2t3">r2t3</code></td>
<td>
<p>proportion of treatment effect variance between level 3 units explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="bird4_+3A_r2t4">r2t4</code></td>
<td>
<p>proportion of treatment effect variance between level 4 units explained by level 4 covariates.</p>
</td></tr>
<tr><td><code id="bird4_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="bird4_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="bird4_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td></tr>
<tr><td><code id="bird4_+3A_n2">n2</code></td>
<td>
<p>average number of level 2 units (blocks) per level 3 unit.</p>
</td></tr>
<tr><td><code id="bird4_+3A_n3">n3</code></td>
<td>
<p>average number of level 3 units (blcoks) per level 4 unit.</p>
</td></tr>
<tr><td><code id="bird4_+3A_n4">n4</code></td>
<td>
<p>number of level 4 units (blocks).</p>
</td></tr>
<tr><td><code id="bird4_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="bird4_+3A_cn2">cn2</code></td>
<td>
<p>marginal cost per level 2 unit.</p>
</td></tr>
<tr><td><code id="bird4_+3A_cn3">cn3</code></td>
<td>
<p>marginal cost per level 3 unit.</p>
</td></tr>
<tr><td><code id="bird4_+3A_cn4">cn4</code></td>
<td>
<p>marginal cost per level 4 unit.</p>
</td></tr>
<tr><td><code id="bird4_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>.</p>
</td></tr>
<tr><td><code id="bird4_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="bird4_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2, n3, n4</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="bird4_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="bird4_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="bird4_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="bird4_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

power.bird4(score.obj,
            es = .25, rho2 = .20, rho3 = .10, rho4 = .05,
            omega2 = .30, omega3 = .30, omega4 = .30,
            g4 = 0, r2t4 = 0, n1 = 20, n2 = 3, n3 = 20, n4 = 5)

# minimum required number of level 1 units for each one of the level 2 block
cosa.bird4(score.obj, order = 2,
           es = .25, rho2 = .20, rho3 = .10, rho4 = .05,
           omega2 = .30, omega3 = .30, omega4 = .30,
           g4 = 0, r2t4 = 0, n1 = NULL, n2 = 3, n3 = 20, n4 = 5)
</code></pre>

<hr>
<h2 id='cosa-deprecated'>Deprecated and Defunct functions in <span class="pkg">cosa</span></h2><span id='topic+cosa-deprecated'></span>

<h3>Description</h3>

<p>Some function are renamed and depreciated. They may be removed in the future.
</p>


<h3>Details</h3>

<p>Depreciated function names:
</p>

<ul>
<li><p><code>power.crd2r2</code> is depreciated, use <code>power.crd2</code> instead.
</p>
</li>
<li><p><code>mdes.crd2r2</code> is depreciated, use <code>mdes.crd2</code> instead.
</p>
</li>
<li><p><code>cosa.crd2r2</code> is depreciated, use <code>cosa.crd2</code> instead.
</p>
</li>
<li><p><code>power.crd3r3</code> is depreciated, use <code>power.crd3</code> instead.
</p>
</li>
<li><p><code>mdes.crd3r3</code> is depreciated, use <code>mdes.crd3</code> instead.
</p>
</li>
<li><p><code>cosa.crd3r3</code> is depreciated, use <code>cosa.crd3</code> instead.
</p>
</li>
<li><p><code>power.crd4r4</code> is depreciated, use <code>power.crd4</code> instead.
</p>
</li>
<li><p><code>mdes.crd4r4</code> is depreciated, use <code>mdes.crd4</code> instead.
</p>
</li>
<li><p><code>cosa.crd4r4</code> is depreciated, use <code>cosa.crd4</code> instead.
</p>
</li>
<li><p><code>power.ira1r1</code> is depreciated, use <code>power.ira</code> instead.
</p>
</li>
<li><p><code>mdes.ira1r1</code> is depreciated, use <code>mdes.ira</code> instead.
</p>
</li>
<li><p><code>power.bira2r1</code> is depreciated, use <code>power.bira2</code> instead.
</p>
</li>
<li><p><code>mdes.bira2r1</code> is depreciated, use <code>mdes.bira2</code> instead.
</p>
</li>
<li><p><code>cosa.bira2r1</code> is depreciated, use <code>cosa.bira2</code> instead.
</p>
</li>
<li><p><code>power.bira3r1</code> is depreciated, use <code>power.bira3</code> instead.
</p>
</li>
<li><p><code>mdes.bira3r1</code> is depreciated, use <code>mdes.bira3</code> instead.
</p>
</li>
<li><p><code>cosa.bira3r1</code> is depreciated, use <code>cosa.bira3</code> instead.
</p>
</li>
<li><p><code>power.bira4r1</code> is depreciated, use <code>power.bira4</code> instead.
</p>
</li>
<li><p><code>mdes.bira4r1</code> is depreciated, use <code>mdes.bira4</code> instead.
</p>
</li>
<li><p><code>cosa.bira4r1</code> is depreciated, use <code>cosa.bira4</code> instead.
</p>
</li></ul>


<hr>
<h2 id='crd2'>Cluster-level Regression Discontinuity (Two-level Design, Discontinuity at Level 2, w/ or w/o Strata or Fixed Blocks)</h2><span id='topic+crd2r2'></span><span id='topic+crd2'></span><span id='topic+bcrd3f2'></span><span id='topic+cosa.crd2r2'></span><span id='topic+cosa.crd2'></span><span id='topic+cosa.bcrd3f2'></span><span id='topic+power.crd2r2'></span><span id='topic+power.crd2'></span><span id='topic+power.bcrd3f2'></span><span id='topic+mdes.crd2r2'></span><span id='topic+mdes.crd2'></span><span id='topic+mdes.bcrd3f2'></span>

<h3>Description</h3>

<p>Use <code>mdes.crd2()</code> to calculate minimum detectable effect size, <code>power.crd2()</code> to calculate statistical power, and <code>cosa.crd2()</code> for bound constrained optimal sample size allocation (BCOSSA). If higher level strata or fixed blocks exist, use <code>mdes.bcrd3f2()</code> to calculate minimum detectable effect size, <code>power.bcrd3f2()</code> to calculate statistical power, and <code>cosa.bcrd3f2()</code> for BCOSSA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.crd2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          power = .80, alpha = .05, two.tailed = TRUE,
          df = n2 - g2 - order * (1 + interaction) - 2,
          rho2, r21 = 0, r22 = 0, g2 = 0, rate.tp = 1, rate.cc = 0, n1, n2)

power.crd2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           es = .25, alpha = .05, two.tailed = TRUE,
           df = n2 - g2 - order * (1 + interaction) - 2,
           rho2, r21 = 0, r22 = 0, g2 = 0, rate.tp = 1, rate.cc = 0, n1, n2)

cosa.crd2(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          cn1 = 0, cn2 = 0, cost = NULL,
          n1 = NULL, n2 = NULL, n0 = c(10, 100), p0 = .499,
          constrain = "power", round = TRUE,
          max.power = FALSE, local.solver = c("LBFGS", "SLSQP"),
          power = .80, es = .25, alpha = .05, two.tailed = TRUE,
          rho2, g2 = 0, r21 = 0, r22 = 0)

mdes.bcrd3f2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             power = .80, alpha = .05, two.tailed = TRUE,
             df = n3 * (n2 - 2) - g2 - order * (1 + interaction),
             rho2, r21 = 0, r22 = 0, g2 = 0,
             rate.tp = 1, rate.cc = 0, n1, n2, n3)

power.bcrd3f2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
              order = 1, interaction = FALSE,
              treat.lower = TRUE, cutoff = 0, p = NULL,
              es = .25, alpha = .05, two.tailed = TRUE,
              df = n3 * (n2 - 2) - g2 - order * (1 + interaction),
              rho2, r21 = 0, r22 = 0, g2 = 0,
              rate.tp = 1, rate.cc = 0, n1, n2, n3)

cosa.bcrd3f2(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             cn1 = 0, cn2 = 0, cn3 = 0, cost = NULL,
             n1 = NULL, n2 = NULL, n3 = NULL,
             n0 = c(10, 100, 5), p0 = .499,
             constrain = "power", round = TRUE, max.power = FALSE,
             local.solver = c("LBFGS", "SLSQP"),
             power = .80, es = .25, alpha = .05, two.tailed = TRUE,
             rho2, g2 = 0, r21 = 0, r22 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crd2_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="crd2_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="crd2_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="crd2_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="crd2_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="crd2_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="crd2_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="crd2_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="crd2_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="crd2_+3A_p">p</code></td>
<td>
<p>proportion of level 2 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="crd2_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="crd2_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="crd2_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="crd2_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="crd2_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="crd2_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="crd2_+3A_g2">g2</code></td>
<td>
<p>number of covariates at level 2.</p>
</td></tr>
<tr><td><code id="crd2_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="crd2_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="crd2_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="crd2_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="crd2_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td></tr>
<tr><td><code id="crd2_+3A_n2">n2</code></td>
<td>
<p>number of level 2 units (per stratum or block, if exists).</p>
</td></tr>
<tr><td><code id="crd2_+3A_n3">n3</code></td>
<td>
<p>number of stratum or fixed blocks.</p>
</td></tr>
<tr><td><code id="crd2_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="crd2_+3A_cn2">cn2</code></td>
<td>
<p>marginal costs per level 2 unit in treatment and control conditions (positional), e.g. <code>c(50, 30)</code>.</p>
</td></tr>
<tr><td><code id="crd2_+3A_cn3">cn3</code></td>
<td>
<p>marginal cost per stratum or fixed block.</p>
</td></tr>
<tr><td><code id="crd2_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>. </p>
</td></tr>
<tr><td><code id="crd2_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2</code> or <code>n1, n2, n3</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="crd2_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> or <code>order = 0</code>, and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="crd2_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="crd2_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="crd2_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="crd2_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

# single site (no blocks)
power.crd2(score.obj,
           es = .25, rho2 = .20, g2 = 0, r22 = 0,
           n1 = 50, n2 = 30)

# with 5 blocks (note that r22 is modified but g2 remains the same)
power.bcrd3f2(score.obj,
              es = .25, rho2 = .20, g2 = 0, r22 = .30,
              n1 = 50, n2 = 30, n3 = 5)

# minimum required number of level 2 units for each block
cosa.bcrd3f2(score.obj,
             es = .25, rho2 = .20, g2 = 0, r22 = .30,
             n1 = 50, n2 = NULL, n3 = 5)

</code></pre>

<hr>
<h2 id='crd3'>Cluster-level Regression Discontinuity (Three-level Design, Discontinuity at Level 3, w/ or w/o Strata or Fixed Blocks)</h2><span id='topic+crd3r3'></span><span id='topic+crd3'></span><span id='topic+bcrd4f3'></span><span id='topic+cosa.crd3r3'></span><span id='topic+cosa.crd3'></span><span id='topic+cosa.bcrd4f3'></span><span id='topic+power.crd3r3'></span><span id='topic+power.crd3'></span><span id='topic+power.bcrd4f3'></span><span id='topic+mdes.crd3r3'></span><span id='topic+mdes.crd3'></span><span id='topic+mdes.bcrd4f3'></span>

<h3>Description</h3>

<p>Use <code>mdes.crd3()</code> to calculate minimum detectable effect size, <code>power.crd3()</code> to calculate statistical power, and <code>cosa.crd3()</code> for bound constrained optimal sample size allocation (BCOSSA). If higher level strata or fixed blocks exist, use <code>mdes.bcrd4f3()</code> to calculate minimum detectable effect size, <code>power.bcrd4f3()</code> to calculate statistical power, and <code>cosa.bcrd4f3()</code> for BCOSSA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.crd3(score = NULL, dists = "normal", k1 = -6, k2 = 6,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          power = .80, alpha = .05, two.tailed = TRUE,
          df = n3 - g3 - order * (1 + interaction) - 2,
          rho2, rho3, r21 = 0, r22 = 0, r23 = 0,
          g3 = 0, rate.tp = 1, rate.cc = 0, n1, n2, n3)

power.crd3(score = NULL, dists = "normal", k1 = -6, k2 = 6,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           es = .25, alpha = .05, two.tailed = TRUE,
           df = n3 - g3 - order * (1 + interaction) - 2,
           rho2, rho3, r21 = 0, r22 = 0, r23 = 0,
           g3 = 0, rate.tp = 1, rate.cc = 0, n1, n2, n3)

cosa.crd3(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          cn1 = 0, cn2 = 0, cn3 = 0, cost = NULL,
          n1 = NULL, n2 = NULL, n3 = NULL,
          n0 = c(10, 3, 100), p0 = .499,
          constrain = "power", round = TRUE, max.power = FALSE,
          local.solver = c("LBFGS", "SLSQP"),
          power = .80, es = .25, alpha = .05, two.tailed = TRUE,
          rho2, rho3, g3 = 0, r21 = 0, r22 = 0, r23 = 0)

mdes.bcrd4f3(score = NULL, dists = "normal", k1 = -6, k2 = 6,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             power = .80, alpha = .05, two.tailed = TRUE,
             df = n4 * (n3 - 2) - g3 - order * (1 + interaction),
             rho2, rho3, r21 = 0, r22 = 0, r23 = 0, g3 = 0,
             rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

power.bcrd4f3(score = NULL, dists = "normal", k1 = -6, k2 = 6,
              order = 1, interaction = FALSE,
              treat.lower = TRUE, cutoff = 0, p = NULL,
              es = .25, alpha = .05, two.tailed = TRUE,
              df = n4 * (n3 - 2) - g3 - order * (1 + interaction),
              rho2, rho3, r21 = 0, r22 = 0, r23 = 0, g3 = 0,
              rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

cosa.bcrd4f3(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             cn1 = 0, cn2 = 0, cn3 = 0, cn4 = 0, cost = NULL,
             n1 = NULL, n2 = NULL, n3 = NULL, n4 = NULL,
             n0 = c(10, 3, 100 + g3 + order * (1 + interaction), 5), p0 = .499,
             constrain = "power", round = TRUE, max.power = FALSE,
             local.solver = c("LBFGS", "SLSQP"),
             power = .80, es = .25, alpha = .05, two.tailed = TRUE,
             rho2, rho3, g3 = 0, r21 = 0, r22 = 0, r23 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crd3_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="crd3_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="crd3_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="crd3_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="crd3_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="crd3_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="crd3_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="crd3_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="crd3_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="crd3_+3A_p">p</code></td>
<td>
<p>proportion of level 3 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="crd3_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="crd3_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="crd3_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="crd3_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="crd3_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="crd3_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="crd3_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="crd3_+3A_g3">g3</code></td>
<td>
<p>number of covariates at level 3.</p>
</td></tr>
<tr><td><code id="crd3_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="crd3_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="crd3_+3A_r23">r23</code></td>
<td>
<p>proportion of level 3 variance in the outcome explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="crd3_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="crd3_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="crd3_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td></tr>
<tr><td><code id="crd3_+3A_n2">n2</code></td>
<td>
<p>average number of level 2 units per level 3 unit.</p>
</td></tr>
<tr><td><code id="crd3_+3A_n3">n3</code></td>
<td>
<p>number of level 3 units(per stratum or block, if exists).</p>
</td></tr>
<tr><td><code id="crd3_+3A_n4">n4</code></td>
<td>
<p>number of stratum or fixed blocks.</p>
</td></tr>
<tr><td><code id="crd3_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="crd3_+3A_cn2">cn2</code></td>
<td>
<p>marginal costs per level 2 unit in treatment and control conditions (positional), e.g. <code>c(50, 30)</code>.</p>
</td></tr>
<tr><td><code id="crd3_+3A_cn3">cn3</code></td>
<td>
<p>marginal costs per level 3 unit in treatment and control conditions (positional), e.g. <code>c(80, 50)</code>.</p>
</td></tr>
<tr><td><code id="crd3_+3A_cn4">cn4</code></td>
<td>
<p>marginal cost per stratum or fixed block.</p>
</td></tr>
<tr><td><code id="crd3_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>. </p>
</td></tr>
<tr><td><code id="crd3_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="crd3_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2, n3</code> or <code>n1, n2, n3, n4</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="crd3_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="crd3_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="crd3_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="crd3_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)
# single site (no blocks)
power.crd3(score.obj,
           es = .25, rho2 = .20, rho3 = .10,
           g3 = 0, r23 = 0, n1 = 20, n2 = 3, n3 = 40)

# with 5 blocks (note that r23 is modified but g3 remains the same)
power.bcrd4f3(score.obj,
              es = .25, rho2 = .20, rho3 = .10,
              g3 = 0, r23 = .30,
              n1 = 20, n2 = 3, n3 = 40, n4 = 5)

# minimum required number of level 3 units for each block
cosa.bcrd4f3(score.obj,
             es = .25, rho2 = .20, rho3 = .10,
             g3 = 0, r23 = .30,
             n1 = 20, n2 = 2, n3 = NULL, n4 = 5)
</code></pre>

<hr>
<h2 id='crd4'>Cluster-level Regression Discontinuity (Four-level Design, Discontinuity at Level 4)</h2><span id='topic+crd4r4'></span><span id='topic+crd4'></span><span id='topic+cosa.crd4r4'></span><span id='topic+cosa.crd4'></span><span id='topic+power.crd4r4'></span><span id='topic+power.crd4'></span><span id='topic+mdes.crd4r4'></span><span id='topic+mdes.crd4'></span>

<h3>Description</h3>

<p>Use <code>mdes.crd4()</code> to calculate minimum detectable effect size, <code>power.crd4()</code> to calculate statistical power, and <code>cosa.crd4()</code> for bound constrained optimal sample size allocation (BCOSSA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.crd4(score = NULL, dists = "normal", k1 = -6, k2 = 6,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          power = .80, alpha = .05, two.tailed = TRUE,
          df = n4 - g4 - order * (1 + interaction) - 2,
          rho2, rho3, rho4, r21 = 0, r22 = 0, r23 = 0, r24 = 0,
          g4 = 0, rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

power.crd4(score = NULL, dists = "normal", k1 = -6, k2 = 6,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           es = .25, alpha = .05, two.tailed = TRUE,
           df = n4 - g4 - order * (1 + interaction) - 2,
           rho2, rho3, rho4, r21 = 0, r22 = 0, r23 = 0, r24 = 0,
           g4 = 0, rate.tp = 1, rate.cc = 0, n1, n2, n3, n4)

cosa.crd4(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          cn1 = 0, cn2 = 0, cn3 = 0, cn4 = 0, cost = NULL,
          n1 = NULL, n2 = NULL, n3 = NULL, n4 = NULL,
          n0 = c(10, 3, 100, 5 + g4 + order * (1 + interaction)), p0 = .499,
          constrain = "power", round = TRUE, max.power = FALSE,
          local.solver = c("LBFGS", "SLSQP"),
          power = .80, es = .25, alpha = .05, two.tailed = TRUE,
          rho2, rho3, rho4, g4 = 0, r21 = 0, r22 = 0, r23 = 0, r24 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crd4_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="crd4_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="crd4_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="crd4_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="crd4_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td></tr>
<tr><td><code id="crd4_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="crd4_+3A_p">p</code></td>
<td>
<p>proportion of level 4 units in the treatment condition.</p>
</td></tr>
<tr><td><code id="crd4_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="crd4_+3A_es">es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="crd4_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="crd4_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="crd4_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="crd4_+3A_rho2">rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td></tr>
<tr><td><code id="crd4_+3A_rho3">rho3</code></td>
<td>
<p>proportion of variance in the outcome between level 3 units (unconditional ICC3).</p>
</td></tr>
<tr><td><code id="crd4_+3A_rho4">rho4</code></td>
<td>
<p>proportion of variance in the outcome between level 4 units (unconditional ICC4).</p>
</td></tr>
<tr><td><code id="crd4_+3A_g4">g4</code></td>
<td>
<p>number of covariates at level 4.</p>
</td></tr>
<tr><td><code id="crd4_+3A_r21">r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td></tr>
<tr><td><code id="crd4_+3A_r22">r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td></tr>
<tr><td><code id="crd4_+3A_r23">r23</code></td>
<td>
<p>proportion of level 3 variance in the outcome explained by level 3 covariates.</p>
</td></tr>
<tr><td><code id="crd4_+3A_r24">r24</code></td>
<td>
<p>proportion of level 4 variance in the outcome explained by level 4 covariates.</p>
</td></tr>
<tr><td><code id="crd4_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="crd4_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="crd4_+3A_n1">n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td></tr>
<tr><td><code id="crd4_+3A_n2">n2</code></td>
<td>
<p>average number of level 2 units per level 3 unit.</p>
</td></tr>
<tr><td><code id="crd4_+3A_n3">n3</code></td>
<td>
<p>average number of level 3 units per level 4 unit.</p>
</td></tr>
<tr><td><code id="crd4_+3A_n4">n4</code></td>
<td>
<p>number of level 4 units.</p>
</td></tr>
<tr><td><code id="crd4_+3A_cn1">cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_cn2">cn2</code></td>
<td>
<p>marginal costs per level 2 unit in treatment and control conditions (positional), e.g. <code>c(50, 30)</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_cn3">cn3</code></td>
<td>
<p>marginal costs per level 3 unit in treatment and control conditions (positional), e.g. <code>c(80, 50)</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_cn4">cn4</code></td>
<td>
<p>marginal costs per level 4 unit in treatment and control conditions (positional), e.g. <code>c(100, 40)</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="crd4_+3A_n0">n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2, n3, n4</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td></tr>
<tr><td><code id="crd4_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="crd4_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="crd4_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td></tr>
<tr><td><code id="crd4_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

power.crd4(score.obj,
           es = .25, rho2 = .20, rho3 = .10, rho4 = .05,
           g4 = 0, r24 = 0, n1 = 20, n2 = 3, n3 = 50, n4 = 20)

# minimum required number of level 4 units
cosa.crd4(score.obj,
          es = .25, rho2 = .20, rho3 = .10, rho4 = .05,
          g4 = 0, r24 = 0,
          n1 = 20, n2 = 3, n3 = 50, n4 = NULL)
</code></pre>

<hr>
<h2 id='inspect.score'>Computes Regression Discontinuity Design Effects</h2><span id='topic+inspect.score'></span>

<h3>Description</h3>

<p>Computes Regression Discontinuity Design Effects (RDDE) either based on analytic deviations (up to second order with interactions), an empirical score variable, or simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  inspect.score(score = NULL, p = NULL, cutoff = NULL,
              treat.lower = FALSE, order = 1, interaction = FALSE,
              mu = 0, sigma = 1, k1 = -Inf, k2 =  Inf,
              dists = "normal", sim = FALSE, ndraw = 1000, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect.score_+3A_sim">sim</code></td>
<td>
<p>logical; if <code>TRUE</code> results are based on simulation.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_score">score</code></td>
<td>
<p>vector; score variable.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_p">p</code></td>
<td>
<p>proportion of units in the treatment condition.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below cutoff are treated.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_mu">mu</code></td>
<td>
<p>mean of (uncentered) truncated normal - applies when <code>score = NULL</code> and <code>dists = "normal"</code>.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of (uncentered) truncated normal - applies when <code>score = NULL</code> and <code>dists = "normal"</code>.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_dists">dists</code></td>
<td>
<p>char; type of distribution, <code>"normal"</code> or <code>"uniform"</code>.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_ndraw">ndraw</code></td>
<td>
<p>number of draws - applies when <code>sim = TRUE</code>.</p>
</td></tr>
<tr><td><code id="inspect.score_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations - applies when <code>sim = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list; list of parameters used in the computation.</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>decision threshold (computed if <code>p</code> is provided).</p>
</td></tr>
<tr><td><code>treat.lower</code></td>
<td>
<p>if <code>TRUE</code> units below cutoff are treated.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>proportion of subjects treated (computed if <code>cutoff</code> is provided).</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>order of polynomial specification for the score variable.</p>
</td></tr>
<tr><td><code>interaction</code></td>
<td>
<p>if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>if <code>TRUE</code> the score variable is centered on the cutoff</p>
</td></tr>
<tr><td><code>rdde</code></td>
<td>
<p>regression discontinuity design effect.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  # based on an empirical score variable
  inspect.score(score = rnorm(10000), cutoff = 0)
  # based on analytic derivation
  inspect.score(cutoff = 0)
  # based on simulation
  inspect.score(sim = TRUE, cutoff = 0)
</code></pre>

<hr>
<h2 id='ird'>Simple Individual-level Regression Discontinuity (w/ or w/o Strata or Fixed Blocks)</h2><span id='topic+ird1r1'></span><span id='topic+ird'></span><span id='topic+bird2f1'></span><span id='topic+cosa.bird2f1'></span><span id='topic+mdes.ird1r1'></span><span id='topic+mdes.ird'></span><span id='topic+mdes.bird2f1'></span><span id='topic+power.ird1r1'></span><span id='topic+power.ird'></span><span id='topic+power.bird2f1'></span>

<h3>Description</h3>

<p>Use <code>mdes.ird()</code> to calculate minimum detectable effect size and <code>power.ird()</code> to calculate statistical power. If higher level strata or fixed blocks exist, use <code>mdes.bird2f1()</code> to calculate minimum detectable effect size, <code>power.bird2f1()</code> to calculate statistical power, and <code>cosa.bird2f1()</code> for bound constrained optimal sample size allocation (BCOSSA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdes.ird(score = NULL, dists = "normal", k1 = -6, k2 = 6,
         order = 1, interaction = FALSE,
         treat.lower = TRUE, cutoff = 0, p = NULL,
         power = .80, alpha = .05, two.tailed = TRUE,
         df = n1 - g1 - order * (1 + interaction) - 2,
         r21 = 0, g1 = 0, rate.tp = 1, rate.cc = 0, n1)

power.ird(score = NULL, dists = "normal", k1 = -6, k2 = 6,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          es = .25, alpha = .05, two.tailed = TRUE,
          df = n1 - g1 - order * (1 + interaction) - 2,
          r21 = 0, g1 = 0, rate.tp = 1, rate.cc = 0, n1)

mdes.bird2f1(score = NULL, dists = "normal", k1 = -6, k2 = 6,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             power = .80, alpha = .05, two.tailed = TRUE,
             df = n2 * (n1 - 2) - g1 - order * (1 + interaction),
             r21 = 0, g1 = 0, rate.tp = 1, rate.cc = 0, n1, n2 = 1)

power.bird2f1(score = NULL, dists = "normal", k1 = -6, k2 = 6,
              order = 1, interaction = FALSE,
              treat.lower = TRUE, cutoff = 0, p = NULL,
              es = .25, alpha = .05, two.tailed = TRUE,
              df = n2 * (n1 - 2) - g1 - order * (1 + interaction),
              r21 = 0, g1 = 0, rate.tp = 1, rate.cc = 0, n1, n2 = 1)

cosa.bird2f1(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             cn1 = 0, cn2 = 0, cost = NULL,
             n1 = NULL, n2 = NULL,
             n0 = c(400, 5), p0 = .499,
             constrain = "power", round = TRUE, max.power = FALSE,
             local.solver = c("LBFGS", "SLSQP"),
             power = .80, es = .25, alpha = .05, two.tailed = TRUE,
             g1 = 0, r21 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ird_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="ird_+3A_dists">dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td></tr>
<tr><td><code id="ird_+3A_k1">k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="ird_+3A_k2">k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td></tr>
<tr><td><code id="ird_+3A_order">order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td></tr>
<tr><td><code id="ird_+3A_interaction">interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td></tr>
<tr><td><code id="ird_+3A_rhots">rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td></tr>
<tr><td><code id="ird_+3A_treat.lower">treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below cutoff the are treated.</p>
</td></tr>
<tr><td><code id="ird_+3A_cutoff">cutoff</code></td>
<td>
<p>decision threshold.</p>
</td></tr>
<tr><td><code id="ird_+3A_p">p</code></td>
<td>
<p>proportion of units in the treatment condition.</p>
</td></tr>
<tr><td><code id="ird_+3A_power">power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="ird_+3A_es">es</code></td>
<td>
<p>numeric &gt; 0; effect size (Cohen's d).</p>
</td></tr>
<tr><td><code id="ird_+3A_alpha">alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="ird_+3A_two.tailed">two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td></tr>
<tr><td><code id="ird_+3A_df">df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code id="ird_+3A_g1">g1</code></td>
<td>
<p>number of covariates.</p>
</td></tr>
<tr><td><code id="ird_+3A_r21">r21</code></td>
<td>
<p>proportion of variance in the outcome explained by covariates.</p>
</td></tr>
<tr><td><code id="ird_+3A_rate.tp">rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td></tr>
<tr><td><code id="ird_+3A_rate.cc">rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td></tr>
<tr><td><code id="ird_+3A_n1">n1</code></td>
<td>
<p>sample size (per stratum or block, if exists).</p>
</td></tr>
<tr><td><code id="ird_+3A_n2">n2</code></td>
<td>
<p>number of stratum or fixed blocks.</p>
</td></tr>
<tr><td><code id="ird_+3A_cn1">cn1</code></td>
<td>
<p>marginal cost per unit in treatment and control conditions, e.g. <code>c(10, 5)</code>.</p>
</td></tr>
<tr><td><code id="ird_+3A_cn2">cn2</code></td>
<td>
<p>marginal cost per stratum or fixed block.</p>
</td></tr>
<tr><td><code id="ird_+3A_cost">cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>. </p>
</td></tr>
<tr><td><code id="ird_+3A_constrain">constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td></tr>
<tr><td><code id="ird_+3A_n0">n0</code></td>
<td>
<p>starting value for <code>n1</code> or <code>n1, n2</code>. Starting value is replaced with the average when sample size is constrained by bounds.</p>
</td></tr>
<tr><td><code id="ird_+3A_p0">p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> and <code>p = NULL</code>. Starting value is replaced with average when <code>p</code> is constrained by bounds.</p>
</td></tr>
<tr><td><code id="ird_+3A_round">round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td></tr>
<tr><td><code id="ird_+3A_max.power">max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing power instead of minimizing variance, applies when <code>constrain = "cost"</code></p>
</td></tr>
<tr><td><code id="ird_+3A_local.solver">local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td></tr>
<tr><td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td></tr>
<tr><td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

# single site (no blocks)
power.ird(score.obj, g1 = 0, r21 = 0,
          es = 0.25, n = 100)

# with 5 blocks (note that r21 is modified but g1 remains the same)
power.bird2f1(score.obj,  g1 = 0, r21 = .30,
              es = 0.25, n1 = 100, n2 = 5)

# minimum required sample size for each block
cosa.bird2f1(score.obj,  g1 = 0, r21 = .30,
             n1 = NULL, n2 = 5)
</code></pre>

<hr>
<h2 id='moments'>Moments</h2><span id='topic+tnorm.moment'></span><span id='topic+unif.moment'></span><span id='topic+emp.moment'></span>

<h3>Description</h3>

<p>If data (vector) is provided use <code>emp.moment()</code> function, otherwise for truncated normal distribution use <code>tnorm.moment()</code>, and for uniform distribution use <code>unif.moment()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  tnorm.moment(mu = 0, sigma = 1, k1 = -Inf, k2 = Inf, order = 1, central = FALSE)
  unif.moment(k1 = 0, k2 = 1, order = 1, central = FALSE)
  emp.moment(x, order = 1, central = FALSE, absolute = FALSE, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moments_+3A_mu">mu</code></td>
<td>
<p>mean of truncated normal - applies to <code>tnorm.moment()</code>.</p>
</td></tr>
<tr><td><code id="moments_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of truncated normal - applies to <code>tnorm.moment()</code>.</p>
</td></tr>
<tr><td><code id="moments_+3A_k1">k1</code></td>
<td>
<p>left truncation point for truncated normal distribution or lower bound for uniform distribution.</p>
</td></tr>
<tr><td><code id="moments_+3A_k2">k2</code></td>
<td>
<p>right truncation point for truncated normal distribution or upper bound for uniform distribution.</p>
</td></tr>
<tr><td><code id="moments_+3A_order">order</code></td>
<td>
<p>+ int; order of moment</p>
</td></tr>
<tr><td><code id="moments_+3A_x">x</code></td>
<td>
<p>a vector of values - applies to <code>emp.moment()</code>.</p>
</td></tr>
<tr><td><code id="moments_+3A_central">central</code></td>
<td>
<p>logical; if <code>TRUE</code> produces central moments.</p>
</td></tr>
<tr><td><code id="moments_+3A_absolute">absolute</code></td>
<td>
<p>logical; if <code>TRUE</code> produces absolute moments - applies to <code>emp.moment()</code>.</p>
</td></tr>
<tr><td><code id="moments_+3A_na.rm">na.rm</code></td>
<td>
<p>logical; if <code>TRUE</code> removes missing values - applies to <code>emp.moment()</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>tnorm.moment(k1 = -20, k2 = 20, order = 4, central = FALSE)
emp.moment(rnorm(10000), order = 4, central = FALSE)
unif.moment(k1 = 0, k2 = 1, order = 4, central = FALSE)
emp.moment(runif(10000), order = 4, central = FALSE)
</code></pre>

<hr>
<h2 id='plot'>Power and MDES Curves</h2><span id='topic+plot.power'></span><span id='topic+plot.mdes'></span><span id='topic+plot.cosa'></span>

<h3>Description</h3>

<p>Plots statistical power or minimum detectable effect size curves with (1-<code class="reqn">\alpha</code>)x100 % confidence interval for the design of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'power'
plot(x, score = NULL, ypar = "mdes",  xpar = NULL,
          xlim = NULL, ylim = NULL,
          xlab = NULL, ylab = NULL,
          main = NULL, sub = NULL,
          locate = FALSE, benchmark = NULL, ...)

## S3 method for class 'mdes'
plot(x, score = NULL, ypar = "mdes",  xpar = NULL,
          xlim = NULL, ylim = NULL,
          xlab = NULL, ylab = NULL,
          main = NULL, sub = NULL,
          locate = FALSE, benchmark = NULL, ...)

## S3 method for class 'cosa'
plot(x, score = NULL, ypar = "mdes",  xpar = NULL,
          xlim = NULL, ylim = NULL,
          xlab = NULL, ylab = NULL,
          main = NULL, sub = NULL,
          locate = FALSE, benchmark = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>an object returned from functions in <span class="pkg">cosa</span> package.</p>
</td></tr>
<tr><td><code id="plot_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="plot_+3A_ypar">ypar</code></td>
<td>
<p>character; <code>"mdes"</code> or  <code>"power"</code> on <code>y</code> axis.</p>
</td></tr>
<tr><td><code id="plot_+3A_xpar">xpar</code></td>
<td>
<p>character; one of the sample sizes on <code>x</code> axis.</p>
</td></tr>
<tr><td><code id="plot_+3A_xlim">xlim</code></td>
<td>
<p>limits for <code>xpar</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_ylim">ylim</code></td>
<td>
<p>limits for <code>ypar</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_xlab">xlab</code></td>
<td>
<p><code>x</code> axis label.</p>
</td></tr>
<tr><td><code id="plot_+3A_ylab">ylab</code></td>
<td>
<p><code>y</code> axis label.</p>
</td></tr>
<tr><td><code id="plot_+3A_main">main</code></td>
<td>
<p>title for the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_sub">sub</code></td>
<td>
<p>subtitle for the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_locate">locate</code></td>
<td>
<p>logical; <code>TRUE</code> locates parameter values for design <code>x</code> on the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_benchmark">benchmark</code></td>
<td>
<p>benchmark line.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>other graphical parameters to pass to <code>plot.new()</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>d1 &lt;- mdes.bcrd3r2(rho2 = .10, rho3 = .20, omega3 = .30,
                   n1 = 20, n2 = 44, n3 = 50)
plot(d1, xpar = "n3", xlim = c(30, 100))
</code></pre>

<hr>
<h2 id='Vectorize+20BCOSSA'>Vectorizes BCOSSA Solutions</h2><span id='topic+vectorize.cosa'></span>

<h3>Description</h3>

<p>Vectorizes bound constrained optimal sample size allocation (BCOSSA) solutions based on multiple sets of parameter values. This is particularly useful when multiple values of design parameters are to be considered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  vectorize.cosa(x, score = NULL,
               args.grid, args.names = NULL,
               ordered = TRUE, ncase = 10L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Vectorize+2B20BCOSSA_+3A_x">x</code></td>
<td>
<p>an object returned from one of the <code>cosa.&lt;design&gt;()</code> functions.</p>
</td></tr>
<tr><td><code id="Vectorize+2B20BCOSSA_+3A_score">score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td></tr>
<tr><td><code id="Vectorize+2B20BCOSSA_+3A_args.grid">args.grid</code></td>
<td>
<p>vector or matrix: arguments' grid consisting of sets of parameter values. A vector of values (for a single parameter) or a matrix (for multiple parameters).</p>
</td></tr>
<tr><td><code id="Vectorize+2B20BCOSSA_+3A_args.names">args.names</code></td>
<td>
<p>character list; arguments' names. Default option <code>args.names = NULL</code> uses column names from <code>args.grid</code></p>
</td></tr>
<tr><td><code id="Vectorize+2B20BCOSSA_+3A_ordered">ordered</code></td>
<td>
<p>logical: whether results should be ordered (cases with worst power rate or highest total cost are on top).</p>
</td></tr>
<tr><td><code id="Vectorize+2B20BCOSSA_+3A_ncase">ncase</code></td>
<td>
<p>integer: number of cases to be subsetted, ignored if <code>ordered = FALSE</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
design &lt;- cosa.crd2(order = 0, round = FALSE,
                    constrain = "power", power = .80,
                    cn1 = c(20, 10), cn2 = c(200, 50),
                    es = .25, rho2 = .10,
                    g2 = 3, r22 = .30,
                    n1 = NULL, n2 = NULL, p = NULL)

args.grid &lt;- expand.grid(
  rho2 = seq(.15, .25, .05)
)

vectorize.cosa(design, args.grid = args.grid, ordered = FALSE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
