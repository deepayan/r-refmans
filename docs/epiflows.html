<!DOCTYPE html><html><head><title>Help for package epiflows</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {epiflows}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#[.epiflows'><p>Subset 'epiflows' objects</p></a></li>
<li><a href='#add_coordinates'><p>Add/Retrieve location coordinates</p></a></li>
<li><a href='#as.SpatialLinesDataFrame'><p>Convert to SpatialLinesDataFrame class</p></a></li>
<li><a href='#epiflows'><p>epiflows</p></a></li>
<li><a href='#estimate_risk_spread'><p>Travel-related disease cases spreaded to other locations from an infectious</p>
location</a></li>
<li><a href='#get_flows'><p>Access flow data</p></a></li>
<li><a href='#get_id'><p>Access population identifiers in epiflows objects</p></a></li>
<li><a href='#get_locations'><p>Access flow data</p></a></li>
<li><a href='#get_n'><p>get the number of cases per flow</p></a></li>
<li><a href='#get_pop_size'><p>Get population size for each entry in locations</p></a></li>
<li><a href='#get_vars'><p>Access location metadata</p></a></li>
<li><a href='#global_vars'><p>Epiflow Global Variables</p></a></li>
<li><a href='#grid_epiflows'><p>Visualise epidemic flows using a grid</p></a></li>
<li><a href='#make_epiflows'><p>Create an epiflows object</p></a></li>
<li><a href='#map_epiflows'><p>Map flows of people between locations</p></a></li>
<li><a href='#plot.epiflows'><p>Various plots for epiflows objects</p></a></li>
<li><a href='#print.epiflows'><p>Print method from epiflows objects</p></a></li>
<li><a href='#vis_epiflows'><p>Visualise epidemic flows using visNetwork</p></a></li>
<li><a href='#YF_Brazil'><p>Yellow Fever Data from Brazil; 2016-12 to 2017-05</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Predicting Disease Spread from Flow Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions and classes designed to handle and visualise
    epidemiological flows between locations. Also contains a statistical method
    for predicting disease spread from flow data initially described in
    Dorigatti et al. (2017) &lt;<a href="https://doi.org/10.2807%2F1560-7917.ES.2017.22.28.30572">doi:10.2807/1560-7917.ES.2017.22.28.30572</a>&gt;.
    This package is part of the RECON (<a href="https://www.repidemicsconsortium.org/">https://www.repidemicsconsortium.org/</a>)
    toolkit for outbreak analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>epicontacts, leaflet, ggmap, geosphere, ggplot2, tibble, sp,
stats, htmltools, visNetwork</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, roxygen2, knitr, outbreaks, vdiffr, curl, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.repidemicsconsortium.org/epiflows/">https://www.repidemicsconsortium.org/epiflows/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/reconhub/epiflows/issues">https://github.com/reconhub/epiflows/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-08 14:16:26 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Pawel Piatkowski <a href="https://orcid.org/0000-0002-0822-5592"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Paula Moraga <a href="https://orcid.org/0000-0001-5266-0201"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Isobel Blake [ctb, dtc],
  Thibaut Jombart [aut],
  VP Nagraj [aut],
  Zhian N. Kamvar <a href="https://orcid.org/0000-0003-1458-7108"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Salla E. Toikkanen [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pawel Piatkowski &lt;pawel.piatkowski@posteo.net&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-09 18:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='+5B.epiflows'>Subset 'epiflows' objects</h2><span id='topic++5B.epiflows'></span>

<h3>Description</h3>

<p>An epiflows object inherits the epicontacts class, so the
subsetting mechanism is also inherited. The benefits is that it's
extremely flexible. However, this also means that it's possible for
the contacts to contain IDs that are not present in the locations 
metadata and vice versa. The best way to consistently subset an
epiflows object is present in the examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epiflows'
x[i, j, k = TRUE, l = TRUE, ...]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B.epiflows_+3A_x">x</code></td>
<td>
<p>An <code>epiflows</code> object.</p>
</td></tr>
<tr><td><code id="+2B5B.epiflows_+3A_i">i</code></td>
<td>
<p>An integer, logical, or character vector of one or more location.</p>
</td></tr>
<tr><td><code id="+2B5B.epiflows_+3A_j">j</code></td>
<td>
<p>An integer, logical, or character vector to subset the flows data frame.</p>
</td></tr>
<tr><td><code id="+2B5B.epiflows_+3A_k">k</code></td>
<td>
<p>A character vector of one or more columns to be retained in the location data.</p>
</td></tr>
<tr><td><code id="+2B5B.epiflows_+3A_l">l</code></td>
<td>
<p>A character vector of one or more columns to be retained in the flows data frame. Note: if using numbers, the first column stands for the first column after &quot;n&quot;.</p>
</td></tr>
<tr><td><code id="+2B5B.epiflows_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to <code><a href="epicontacts.html#topic++5B.epicontacts">[.epicontacts</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a subset of an epiflows object.
</p>


<h3>Value</h3>

<p>An <code>epiflows</code> object.
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brazil_epiflows)
# You can subset, but the flows information will still be present
Brazil_epiflows[j = "Espirito Santo"]
# To help with this, use `thin` from epiflows
epicontacts::thin(Brazil_epiflows[j = "Espirito Santo"])
epicontacts::thin(Brazil_epiflows[j = c("Espirito Santo", "Rio de Jenerio")])

</code></pre>

<hr>
<h2 id='add_coordinates'>Add/Retrieve location coordinates</h2><span id='topic+add_coordinates'></span><span id='topic+get_coordinates'></span><span id='topic+get_coordinates.epiflows'></span>

<h3>Description</h3>

<p>Adds/Retrieves longitude/latitude values to location data within an epiflows object.
Coordinates are added to object's locations slot as <code>lon</code> and <code>lat</code>
columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_coordinates(
  x,
  coordinates = c("lon", "lat"),
  loc_column = "id",
  overwrite = FALSE
)

get_coordinates(x, ...)

## S3 method for class 'epiflows'
get_coordinates(x, location = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_coordinates_+3A_x">x</code></td>
<td>
<p>An <code>epiflows</code> object.</p>
</td></tr>
<tr><td><code id="add_coordinates_+3A_coordinates">coordinates</code></td>
<td>
<p>Either names of the appended columns with longitudes
and latitudes, respectively (default: &quot;lon&quot; and &quot;lat&quot;) or a data frame with longitude and latitude columns.</p>
</td></tr>
<tr><td><code id="add_coordinates_+3A_loc_column">loc_column</code></td>
<td>
<p>Name of the column where location names are stored
(default: &quot;country&quot;).</p>
</td></tr>
<tr><td><code id="add_coordinates_+3A_overwrite">overwrite</code></td>
<td>
<p>If TRUE, retrieves all geocodes, even those already
retrieved. If FALSE (default), overwrites only NAs.</p>
</td></tr>
<tr><td><code id="add_coordinates_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="add_coordinates_+3A_location">location</code></td>
<td>
<p>a character specifying a single location to return as a vector of
coordinates. You cannot specify multiple locations with this parameter.
Defaults to 'NULL', indicating all locations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An updated <code>epiflows</code> object.
</p>


<h3>Author(s)</h3>

<p>Pawel Piatkowski, Salla Toikkanen, Zhian Kamvar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+map_epiflows">map_epiflows()</a></code>; <code><a href="#topic+plot.epiflows">plot.epiflows()</a></code>; <code><a href="#topic+get_locations">get_locations()</a></code>; <code><a href="#topic+get_vars">get_vars()</a></code>;
<code><a href="#topic+global_vars">global_vars()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Setting up the data
data("Brazil_epiflows")
data("YF_coordinates")
get_coordinates(Brazil_epiflows) # no coordinates yet
ef &lt;- add_coordinates(Brazil_epiflows, YF_coordinates[-1])
get_coordinates(ef)
get_coordinates(ef, location = "Espirito Santo") # coordinates for Espirito Santo
if (interactive()) {
  # You can use google maps' geocode functionality if you have a decent 
  # internet connection
  # NOTE: you may need to authenticate with Google Maps API beforehand
  # using ggmap::register_google()
  ef2 &lt;- add_coordinates(Brazil_epiflows, loc_column = "id")
  ef2
}

</code></pre>

<hr>
<h2 id='as.SpatialLinesDataFrame'>Convert to SpatialLinesDataFrame class</h2><span id='topic+as.SpatialLinesDataFrame'></span><span id='topic+as.SpatialLinesDataFrame.epiflows'></span>

<h3>Description</h3>

<p>Convert to SpatialLinesDataFrame class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.SpatialLinesDataFrame(x)

## S3 method for class 'epiflows'
as.SpatialLinesDataFrame(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.SpatialLinesDataFrame_+3A_x">x</code></td>
<td>
<p>an epiflows object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class [sp::SpatialLinesDataFrame]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
data("YF_coordinates")
ef &lt;- add_coordinates(Brazil_epiflows, YF_coordinates[-1])
ef2 &lt;- epicontacts::thin(ef[j = c("Espirito Santo", "Italy"), contacts = "both"])
as.SpatialLinesDataFrame(ef2)
</code></pre>

<hr>
<h2 id='epiflows'>epiflows</h2><span id='topic+epiflows'></span>

<h3>Description</h3>

<p><code>epiflows</code> is a package for predicting and visualising spread of infectious
diseases based on flows between geographical locations, e.g., countries.
<code>epiflows</code> provides functions for calculating spread estimates, handling flow
data, and visualization.
</p>


<h3>Details</h3>

<p>The main functions of the package are <code><a href="#topic+make_epiflows">make_epiflows()</a></code> for
constructing an epiflows object and <code><a href="#topic+estimate_risk_spread">estimate_risk_spread()</a></code> to estimate
potential spread. Visualization is available for maps, networks, and grids.
</p>
<p>For details, see the vignettes: <br />
<code>vignette("introduction", package = "epiflows")</code><br />
<code>vignette("epiflows-class", package = "epiflows")</code>
</p>

<hr>
<h2 id='estimate_risk_spread'>Travel-related disease cases spreaded to other locations from an infectious
location</h2><span id='topic+estimate_risk_spread'></span><span id='topic+estimate_risk_spread.default'></span><span id='topic+estimate_risk_spread.epiflows'></span>

<h3>Description</h3>

<p>Calculates the mean and 95% confidence interval of the estimated number of
disease cases that could potentially seed a disease outbreak in the locations
they are travelling to, comprising exportations (infected residents of the infectious
location travelling abroad during the incubation or infectious period), and
importations (international tourists infected by the disease during
their stay in the infectious location and returning to their home location).
The mean and 95% confidence intervals are obtained by numerically sampling
<code>n_sim</code> times from the incubation and infectious period distributions.
If parameter <code>return_all_simulations</code> is set to <code>TRUE</code>, the function returns all simulations
for each location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_risk_spread(...)

## Default S3 method:
estimate_risk_spread(
  location_code = character(0),
  location_population = numeric(0),
  num_cases_time_window = numeric(0),
  first_date_cases = character(0),
  last_date_cases = character(0),
  num_travellers_to_other_locations = numeric(0),
  num_travellers_from_other_locations = numeric(0),
  avg_length_stay_days = numeric(0),
  r_incubation = function(n) {
 },
  r_infectious = function(n) {
 },
  n_sim = 1000,
  return_all_simulations = FALSE,
  ...
)

## S3 method for class 'epiflows'
estimate_risk_spread(
  x,
  location_code = character(0),
  r_incubation = function(n) {
 },
  r_infectious = function(n) {
 },
  n_sim = 1000,
  return_all_simulations = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_risk_spread_+3A_...">...</code></td>
<td>
<p>Arguments passed onto the default method.</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_location_code">location_code</code></td>
<td>
<p>a character string denoting the infectious location code</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_location_population">location_population</code></td>
<td>
<p>population of the infectious location</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_num_cases_time_window">num_cases_time_window</code></td>
<td>
<p>cumulative number of cases in infectious
location in time window</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_first_date_cases">first_date_cases</code></td>
<td>
<p>string with the date of the first disease case in
infectious location (&quot;YYYY-MM-DD&quot;)</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_last_date_cases">last_date_cases</code></td>
<td>
<p>string with the date of the last disease case in
infectious location (&quot;YYYY-MM-DD&quot;)</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_num_travellers_to_other_locations">num_travellers_to_other_locations</code></td>
<td>
<p>number of travellers from the
infectious location visiting other locations (T_D)</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_num_travellers_from_other_locations">num_travellers_from_other_locations</code></td>
<td>
<p>number of travellers from other
locations visiting the infectious location (T_O)</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_avg_length_stay_days">avg_length_stay_days</code></td>
<td>
<p>average length of stay in days of travellers from
other locations visiting the infectious location. This can be a common
number for all locations or a vector with different numbers for each
location</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_r_incubation">r_incubation</code></td>
<td>
<p>a function with a single argument <code>n</code>
generating 'n' random incubation periods</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_r_infectious">r_infectious</code></td>
<td>
<p>a function with a single argument <code>n</code>
generating 'n' random durations of infectious period</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_n_sim">n_sim</code></td>
<td>
<p>number of simulations from the incubation and
infectious distributions</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_return_all_simulations">return_all_simulations</code></td>
<td>
<p>logical value indicating whether the returned object is a data frame with all simulations
(<code>return_all_simulations = TRUE</code>) or a data frame with the mean and lower and upper limits of a 95% confidence interval of
the number of cases spread to each location (<code>return_all_simulations = FALSE</code>)</p>
</td></tr>
<tr><td><code id="estimate_risk_spread_+3A_x">x</code></td>
<td>
<p>an epiflows object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>if <code>return_all_simulations</code> is <code>TRUE</code>, data frame with all simulations. If <code>return_all_simulations</code> is <code>FALSE</code>,
data frame with the mean and lower and upper limits of a 95% confidence interval of the number
of cases spread to each location
</p>


<h3>Author(s)</h3>

<p>Paula Moraga, Zhian Kamvar (epiflows class implementation)
</p>


<h3>References</h3>

<p>Dorigatti I, Hamlet A, Aguas R, Cattarino L, Cori A, Donnelly CA,
Garske T, Imai N, Ferguson NM. International risk of yellow fever spread from
the ongoing outbreak in Brazil, December 2016 to May 2017. Euro Surveill.
2017;22(28):pii=30572. DOI: <a href="https://doi.org/10.2807/1560-7917.ES.2017.22.28.30572">doi:10.2807/1560-7917.ES.2017.22.28.30572</a>
</p>


<h3>See Also</h3>

<p>Construction of epiflows object: <code><a href="#topic+make_epiflows">make_epiflows()</a></code><br />
Default variables used in the epiflows implementation: <code><a href="#topic+global_vars">global_vars()</a></code><br />
Access metadata from the epiflows object: <code><a href="#topic+get_vars">get_vars()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using an epiflows object --------------------------------

data("YF_flows")
data("YF_locations")
ef &lt;- make_epiflows(flows         = YF_flows, 
                    locations     = YF_locations, 
                    pop_size      = "location_population",
                    duration_stay = "length_of_stay",
                    num_cases     = "num_cases_time_window",
                    first_date    = "first_date_cases",
                    last_date     = "last_date_cases"
)
## functions generating incubation and infectious periods
incubation &lt;- function(n) {
  rlnorm(n, 1.46, 0.35)
}

infectious &lt;- function(n) {
  rnorm(n, 4.5, 1.5/1.96)
}

res &lt;- estimate_risk_spread(ef, 
                            location_code          = "Espirito Santo",
                            r_incubation           = incubation,
                            r_infectious           = infectious,
                            n_sim                  = 1e5,
                            return_all_simulations = TRUE)
boxplot(res, las = 3)

## Using other data --------------------------------------------------
data(YF_Brazil)
indstate &lt;- 1 # "Espirito Santo" (indstate = 1), 
              # "Minas Gerais" (indstate = 2), 
              # "Southeast Brazil" (indstate = 5)

res &lt;- estimate_risk_spread(
  location_code = YF_Brazil$states$location_code[indstate], 
  location_population = YF_Brazil$states$location_population[indstate], 
  num_cases_time_window = YF_Brazil$states$num_cases_time_window[indstate], 
  first_date_cases = YF_Brazil$states$first_date_cases[indstate], 
  last_date_cases = YF_Brazil$states$last_date_cases[indstate],
  num_travellers_to_other_locations = YF_Brazil$T_D[indstate,],
  num_travellers_from_other_locations = YF_Brazil$T_O[indstate,],
  avg_length_stay_days = YF_Brazil$length_of_stay,
  r_incubation = incubation,
  r_infectious = infectious,
  n_sim = 100000,
  return_all_simulations = FALSE
)
head(res)

</code></pre>

<hr>
<h2 id='get_flows'>Access flow data</h2><span id='topic+get_flows'></span><span id='topic+get_flows.epiflows'></span>

<h3>Description</h3>

<p>This accessor extract flow data from an <code>epiflows</code>
object. <code>get_flows</code> is a generic with a method defined for
<code>epiflows</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_flows(x, ...)

## S3 method for class 'epiflows'
get_flows(x, from = NULL, to = NULL, all = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_flows_+3A_x">x</code></td>
<td>
<p>An 'epiflows' object.</p>
</td></tr>
<tr><td><code id="get_flows_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="get_flows_+3A_from">from</code></td>
<td>
<p>a character string defining which regions should be included in the flows</p>
</td></tr>
<tr><td><code id="get_flows_+3A_to">to</code></td>
<td>
<p>a character string defining which regions should be included in the flows</p>
</td></tr>
<tr><td><code id="get_flows_+3A_all">all</code></td>
<td>
<p>when 'TRUE', all the columns of the flows data frame will be returned. Defaults to 'FALSE', which returns &quot;from&quot;, &quot;to&quot;, and &quot;n&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with 3 columns:
</p>

<ul>
<li> <p><code>from</code>: origin of the flow
</p>
</li>
<li> <p><code>to</code>: destination of the flow
</p>
</li>
<li> <p><code>n</code>: magnitude of the flow&mdash;can be a number of passengers per
unit of time, a rate, a probability of migration
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_n">get_n()</a></code>;
For location metadata: <code><a href="#topic+get_locations">get_locations()</a></code>; <code><a href="#topic+get_vars">get_vars()</a></code>, <code><a href="#topic+get_pop_size">get_pop_size()</a></code>, <code><a href="#topic+get_coordinates">get_coordinates()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
head(get_flows(Brazil_epiflows))
get_flows(Brazil_epiflows, from = "Minas Gerais")
get_flows(Brazil_epiflows, to = "Minas Gerais")
get_flows(Brazil_epiflows, from = "Italy", to = "Minas Gerais")
</code></pre>

<hr>
<h2 id='get_id'>Access population identifiers in epiflows objects</h2><span id='topic+get_id'></span>

<h3>Description</h3>

<p>this will return the unique population ID for your epiflows object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_id(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_id_+3A_x">x</code></td>
<td>
<p>an epiflows object</p>
</td></tr>
<tr><td><code id="get_id_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code><a href="epicontacts.html#topic+get_id">epicontacts::get_id()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector of population IDs
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>See Also</h3>

<p><code><a href="epicontacts.html#topic+get_id">epicontacts::get_id()</a></code>; <code><a href="#topic+get_vars">get_vars()</a></code>; <code><a href="#topic+get_pop_size">get_pop_size()</a></code>; <code><a href="#topic+global_vars">global_vars()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
get_id(Brazil_epiflows)

</code></pre>

<hr>
<h2 id='get_locations'>Access flow data</h2><span id='topic+get_locations'></span><span id='topic+get_locations.epiflows'></span>

<h3>Description</h3>

<p>This accessor extract location data from an <code>epiflows</code> object.
<code>get_locations</code> is a generic with a method defined for <code>epiflows</code>
objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_locations(x, ...)

## S3 method for class 'epiflows'
get_locations(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_locations_+3A_x">x</code></td>
<td>
<p>An <code>epiflows</code> object.</p>
</td></tr>
<tr><td><code id="get_locations_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with at least 1 column called <code>id</code>,
specifying the id of the location used in the <code>flows</code> data frame.
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart, Zhian Kamvar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_flows">get_flows()</a></code>; <code><a href="#topic+get_id">get_id()</a></code>; <code><a href="#topic+get_pop_size">get_pop_size()</a></code>; <code><a href="#topic+get_vars">get_vars()</a></code>;
<code><a href="#topic+get_coordinates">get_coordinates()</a></code>; <code><a href="#topic+global_vars">global_vars()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
get_locations(Brazil_epiflows)
</code></pre>

<hr>
<h2 id='get_n'>get the number of cases per flow</h2><span id='topic+get_n'></span><span id='topic+get_n.epiflows'></span>

<h3>Description</h3>

<p>This convenience function will return a named vector containing the number of
cases flowing to or from a given region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_n(x, from = NULL, to = NULL, ...)

## S3 method for class 'epiflows'
get_n(x, from = NULL, to = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_n_+3A_x">x</code></td>
<td>
<p>an epiflows object</p>
</td></tr>
<tr><td><code id="get_n_+3A_from">from</code></td>
<td>
<p>a character vector of length one specifying the location from which the flows originate</p>
</td></tr>
<tr><td><code id="get_n_+3A_to">to</code></td>
<td>
<p>a character vector of length one specifying the location to which the flows terminate</p>
</td></tr>
<tr><td><code id="get_n_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three possible outputs of this function:
</p>

<ul>
<li> <p><strong>no options specified</strong>: an un-named vector, equivalent to <code>get_flows(x)$n</code>
</p>
</li>
<li> <p><strong>from = X</strong>: a named vector of cases flowing <em>from</em> <strong>X</strong>
</p>
</li>
<li> <p><strong>to = X</strong>: a named vector of cases flowing <em>to</em> <strong>X</strong>
</p>
</li></ul>



<h3>Value</h3>

<p>a character vector
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_flows">get_flows()</a></code>;
For location metadata: <code><a href="#topic+get_vars">get_vars()</a></code>, <code><a href="#topic+get_pop_size">get_pop_size()</a></code>, <code><a href="#topic+get_coordinates">get_coordinates()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brazil_epiflows)
get_n(Brazil_epiflows, from = "Espirito Santo")
get_n(Brazil_epiflows, to   = "Espirito Santo")
</code></pre>

<hr>
<h2 id='get_pop_size'>Get population size for each entry in locations</h2><span id='topic+get_pop_size'></span><span id='topic+get_pop_size.epiflows'></span>

<h3>Description</h3>

<p>Get population size for each entry in locations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pop_size(x)

## S3 method for class 'epiflows'
get_pop_size(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_pop_size_+3A_x">x</code></td>
<td>
<p>an epiflows object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named vector of population sizes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_vars">get_vars()</a></code>, <code><a href="#topic+global_vars">global_vars()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
get_pop_size(Brazil_epiflows)
</code></pre>

<hr>
<h2 id='get_vars'>Access location metadata</h2><span id='topic+get_vars'></span><span id='topic+get_vars.epiflows'></span><span id='topic+set_vars'></span><span id='topic+set_vars+3C-'></span><span id='topic+set_vars.epiflows'></span><span id='topic+set_vars+3C-.epiflows'></span>

<h3>Description</h3>

<p>This accessor extracts variables from the <code>locations</code> data frame in an
<code>epiflow</code> object. <code>get_vars</code> is a generic with a method defined for
<code>epiflows</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_vars(x, ...)

## S3 method for class 'epiflows'
get_vars(x, what = NULL, id = TRUE, vector = FALSE, ...)

set_vars(x, ...)

set_vars(x, name) &lt;- value

## S3 method for class 'epiflows'
set_vars(x, ...)

## S3 replacement method for class 'epiflows'
set_vars(x, name) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_vars_+3A_x">x</code></td>
<td>
<p>An <code>epiflows</code> object.</p>
</td></tr>
<tr><td><code id="get_vars_+3A_...">...</code></td>
<td>
<p>For <code>set_vars()</code>, any number of variables defined in
<code><a href="#topic+global_vars">global_vars()</a></code> that can be used for mapping or modelling. This is unused
in <code>get_vars()</code></p>
</td></tr>
<tr><td><code id="get_vars_+3A_what">what</code></td>
<td>
<p>a valid character string specifying the variable desired. If
'NULL' (default), the names of the available vars will be returned.</p>
</td></tr>
<tr><td><code id="get_vars_+3A_id">id</code></td>
<td>
<p>a logical. If 'TRUE' (default), the 'id' column of the locations
will be the first column of the data frame. if 'FALSE', the variable will
be returned with identifiers as row names.</p>
</td></tr>
<tr><td><code id="get_vars_+3A_vector">vector</code></td>
<td>
<p>if 'TRUE' the result will be coerced into a vector (or a matrix in the case of coordinates)</p>
</td></tr>
<tr><td><code id="get_vars_+3A_name">name</code></td>
<td>
<p>the name of the variable in <code><a href="#topic+global_vars">global_vars()</a></code> to assign</p>
</td></tr>
<tr><td><code id="get_vars_+3A_value">value</code></td>
<td>
<p>the name of the column in the locations data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the variables requested
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart, Zhian Kamvar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+global_vars">global_vars()</a></code>; <code><a href="#topic+make_epiflows">make_epiflows()</a></code>; <code><a href="#topic+get_pop_size">get_pop_size()</a></code>; <code><a href="#topic+get_id">get_id()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
get_vars(Brazil_epiflows) # defined global variables pointint to column names
get_vars(Brazil_epiflows, "duration_stay")
get_vars(Brazil_epiflows, "duration_stay", vector = TRUE)
</code></pre>

<hr>
<h2 id='global_vars'>Epiflow Global Variables</h2><span id='topic+global_vars'></span><span id='topic+epiflows.vars'></span>

<h3>Description</h3>

<p>The metadata in <strong>locations</strong> such as population size, duration of stay in a
given location, date of first and last cases, etc. can be useful in estimating
the risk of spread, but not everyone will code their data with identical column
names. To facilitate their use in the function <code>estimate_risk_spread()</code>, the
epiflows object stores a dictionary of variables in a place called <code style="white-space: pre;">&#8288;$vars&#8288;</code>.
We can tell epiflows what variables are important when we create the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global_vars(..., set = FALSE, reset = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="global_vars_+3A_...">...</code></td>
<td>
<p>quoted varaibles to add to the default variables</p>
</td></tr>
<tr><td><code id="global_vars_+3A_set">set</code></td>
<td>
<p>when <code>TRUE</code>, the variables provided in <code>...</code> will be added to the
global variables. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="global_vars_+3A_reset">reset</code></td>
<td>
<p>when <code>TRUE</code>, the global variables are reset to the default
variables listed above. Defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default varaibles are:
</p>

<ul>
<li> <p><code>coordinates</code>: two columns specifying the lon and lat coordinates
</p>
</li>
<li> <p><code>pop_size</code>: population size of each location
</p>
</li>
<li> <p><code>duration_stay</code>: the average duration of stay for each location
</p>
</li>
<li> <p><code>first_date</code>: the date of first recorded case
</p>
</li>
<li> <p><code>last_date</code>: the date of the last recorded case
</p>
</li>
<li> <p><code>num_cases</code>: the number of cases between the first and last date
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+make_epiflows">make_epiflows()</a></code>, <code><a href="#topic+get_locations">get_locations()</a></code>, <code><a href="#topic+get_vars">get_vars()</a></code>, <code><a href="#topic+set_vars">set_vars()</a></code>, <code><a href="#topic+get_coordinates">get_coordinates()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# see the default varaibles
global_vars()

# Equivalent
getOption("epiflows.vars")

# create an object, specifying these variables
data("YF_locations")
data("YF_flows")
ef &lt;- make_epiflows(flows         = YF_flows, 
                    locations     = YF_locations, 
                    pop_size      = "location_population",
                    duration_stay = "length_of_stay",
                    num_cases     = "num_cases_time_window",
                    first_date    = "first_date_cases",
                    last_date     = "last_date_cases"
                   )
ef


# You will receive an error if a variable is specified incorrectly
YF_locations$random_variable &lt;- runif(nrow(YF_locations))
try({
  ef &lt;- make_epiflows(flows         = YF_flows, 
                      locations     = YF_locations, 
                      Pop_size      = "location_population",
                      duration_stay = "length_of_stay",
                      num_cases     = "num_cases_time_window",
                      first_date    = "first_date_cases",
                      last_date     = "last_date_cases",
                      random        = "random_variable"
                     )
   })


# If you create a new method and need other varaibles, or just want a shorter
# representation, they can be added to your options:

global_vars("random", set = TRUE)

YF_locations$random_variable &lt;- runif(nrow(YF_locations))
ef &lt;- make_epiflows(flows         = YF_flows, 
                    locations     = YF_locations, 
                    pop_size      = "location_population",
                    duration_stay = "length_of_stay",
                    num_cases     = "num_cases_time_window",
                    first_date    = "first_date_cases",
                    last_date     = "last_date_cases",
                    random        = "random_variable"
                   )

# You can also reset the variables
global_vars(reset = TRUE)
</code></pre>

<hr>
<h2 id='grid_epiflows'>Visualise epidemic flows using a grid</h2><span id='topic+grid_epiflows'></span>

<h3>Description</h3>

<p>This grid plot shows flows between locations by positioning origins and
destination in y and x axes, respectively. This function is called when
plotting <code>epiflows</code> with <code>type = "grid"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid_epiflows(x, color_by = c("from", "to", "none"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid_epiflows_+3A_x">x</code></td>
<td>
<p>An <code>epiflows</code> object.</p>
</td></tr>
<tr><td><code id="grid_epiflows_+3A_color_by">color_by</code></td>
<td>
<p>A character string indicating if flows should be colored by
origin (<code>from</code>) or destination (<code>to</code>).</p>
</td></tr>
<tr><td><code id="grid_epiflows_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code><a href="ggplot2.html#topic+geom_point">ggplot2::geom_point()</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart
</p>

<hr>
<h2 id='make_epiflows'>Create an epiflows object</h2><span id='topic+make_epiflows'></span><span id='topic+make_epiflows.data.frame'></span><span id='topic+make_epiflows.integer'></span><span id='topic+make_epiflows.numeric'></span>

<h3>Description</h3>

<p>An epiflows object contains a pair of data frames that provide information
about locations and flows between locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_epiflows(...)

## S3 method for class 'data.frame'
make_epiflows(
  flows,
  locations = NULL,
  from = 1L,
  to = 2L,
  n = 3L,
  id = 1L,
  ...
)

## S3 method for class 'integer'
make_epiflows(inflow, outflow, focus, locations, id = 1L, ...)

## S3 method for class 'numeric'
make_epiflows(inflow, outflow, focus, locations, id = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_epiflows_+3A_...">...</code></td>
<td>
<p>Any number of varaibles that can be used for mapping or modelling.
See <code><a href="#topic+global_vars">global_vars()</a></code> and <code><a href="#topic+get_vars">get_vars()</a></code> for details.</p>
</td></tr>
<tr><td><code id="make_epiflows_+3A_flows">flows</code></td>
<td>
<p>a data frame where each row represents a flow from one location
to the next. This must have at least three columns:
</p>

<ul>
<li><p> Where the flow started (as specified in <code>from</code>, below)
</p>
</li>
<li><p> Where the flow ended (as specified in <code>to</code>, below)
</p>
</li>
<li><p> How many cases were involved (as specified in <code>n</code>, below)
</p>
</li></ul>
</td></tr>
<tr><td><code id="make_epiflows_+3A_locations">locations</code></td>
<td>
<p>a data frame where each row represents a location. This can
have any number of columns specifying useful metadata about the location,
but it must contain at least one column specifying the location ID used in
the <code>flows</code> data frame (as specified by the <code>id</code> argument, below).</p>
</td></tr>
<tr><td><code id="make_epiflows_+3A_from">from</code></td>
<td>
<p>the column in the <code>flows</code> data frame indicating where the flow
started. This can be an integer or character. Default is the first column.</p>
</td></tr>
<tr><td><code id="make_epiflows_+3A_to">to</code></td>
<td>
<p>the column in the <code>flows</code> data frame indicating where the flow
terminated. This can be an integer or character. Default is the second column.</p>
</td></tr>
<tr><td><code id="make_epiflows_+3A_n">n</code></td>
<td>
<p>the column in the <code>flows</code> data frame indicating how many cases were
contained in the flow. This can be an integer or character. Default is the
third column.</p>
</td></tr>
<tr><td><code id="make_epiflows_+3A_id">id</code></td>
<td>
<p>The column to use for the identifier in the <code>locations</code> data frame.
This defaults to the first column.</p>
</td></tr>
<tr><td><code id="make_epiflows_+3A_inflow">inflow</code></td>
<td>
<p>a <strong>named</strong> integer or numeric vector specifying the number of
cases flowing into a location specified by <code>focus</code>.</p>
</td></tr>
<tr><td><code id="make_epiflows_+3A_outflow">outflow</code></td>
<td>
<p>a <strong>named</strong> integer or numeric vector specifying the number of
cases flowing from a location specified by <code>focus</code>.</p>
</td></tr>
<tr><td><code id="make_epiflows_+3A_focus">focus</code></td>
<td>
<p>a character vector specifying the focal location for integer
input. This is necessary for integer input to make clear what &quot;outflow&quot; and
&quot;inflow&quot; are relative to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>epiflows</code> object can be constructed using simply a list of locations with
optional metadata (similar to a linelist) and a list of flows that describes
the number of cases flowing from one location to another. Optional metadata
such as coordinates and duration of stay can be included in the linelist for
use in <code><a href="#topic+estimate_risk_spread">estimate_risk_spread()</a></code> or <code><a href="#topic+map_epiflows">map_epiflows()</a></code>.
</p>


<h4>Developer note: object structure</h4>

<p>Because a flow of cases from one location to another can be thought of as a
contact with a wider scope, the <code>epiflows</code> object inherits from the
<code>epicontacts</code> object, constructed via <code><a href="epicontacts.html#topic+make_epicontacts">epicontacts::make_epicontacts()</a></code>.
This means that all the methods for subsetting an object of class
<code>epicontacts</code> also applies to <code>epiflows</code>, including the use of the function
<code><a href="epicontacts.html#topic+thin">epicontacts::thin()</a></code>. One caveat is that, internally, the names of the
elements within the object do not match the terminology used in <em>epiflows</em>.
</p>



<h3>Value</h3>

<p>An <code>epiflows</code> object in list format with four elements:
</p>

<ul>
<li> <p><strong>locations</strong> (accessible via <code><a href="#topic+get_locations">get_locations()</a></code>): a data frame of
locations with first column 'id' containing character vector of unique
identifiers.
</p>
</li>
<li> <p><strong>flows</strong> (accessible via <code><a href="#topic+get_flows">get_flows()</a></code>): data.frame of flows with first
two columns named 'from' and 'to' indicating directed flows between two
locations, and a third column named 'n', specifying the number of cases in
each
</p>
</li>
<li> <p><strong>vars</strong> (accessible via <code><a href="#topic+get_vars">get_vars()</a></code>). This contains a named list of
available variables that can be used in further plotting and/or modelling.
Default variables are found in <code><a href="#topic+global_vars">global_vars()</a></code>:
</p>

<ul>
<li> <p><code>coordinates</code>: two columns specifying the lon and lat coordinates
</p>
</li>
<li> <p><code>pop_size</code>: population size of each location
</p>
</li>
<li> <p><code>duration_stay</code>: the average duration of stay for each location
</p>
</li>
<li> <p><code>first_date</code>: the date of first recorded case
</p>
</li>
<li> <p><code>last_date</code>: the date of the last recorded case
</p>
</li>
<li> <p><code>num_cases</code>: the number of cases between the first and last date
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Zhian Kamvar, Thibaut Jombart
</p>


<h3>See Also</h3>

<p><code><a href="#topic+global_vars">global_vars()</a></code> for definitions of global variables,
<code><a href="#topic+estimate_risk_spread">estimate_risk_spread()</a></code> for modelling, <code><a href="#topic+plot.epiflows">plot.epiflows()</a></code> for plotting,
<code><a href="#topic+add_coordinates">add_coordinates()</a></code> for adding coordinates, <code><a href="#topic+get_vars">get_vars()</a></code> for accession of
metadata, <code><a href="#topic+get_locations">get_locations()</a></code> to access the locations data frame,
<code><a href="#topic+get_flows">get_flows()</a></code> to access the flows data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load data
data(YF_flows)
data(YF_locations)
YF_flows
YF_locations
## Use both to create the epiflows object.
ef &lt;- make_epiflows(flows         = YF_flows, 
                    locations     = YF_locations, 
                    pop_size      = "location_population",
                    duration_stay = "length_of_stay",
                    num_cases     = "num_cases_time_window",
                    first_date    = "first_date_cases",
                    last_date     = "last_date_cases"
                   )
ef
# Access variable information
get_pop_size(ef)
get_vars(ef, "duration_stay")
get_vars(ef, "num_cases")
data(YF_Brazil)
(inflows   &lt;- YF_Brazil$T_O["Espirito Santo", , drop = TRUE])
(outflows  &lt;- YF_Brazil$T_D["Espirito Santo", , drop = TRUE])
(locations &lt;- subset(YF_Brazil$states, location_code == "Espirito Santo", drop = FALSE))
los &lt;- data.frame(location_code    = names(YF_Brazil$length_of_stay), 
                  length_of_stay   = YF_Brazil$length_of_stay,
                  stringsAsFactors = FALSE
                 )
locations &lt;- merge(x   = locations, 
                   y   = los, 
                   by  = "location_code", 
                   all = TRUE)
ef &lt;- make_epiflows(inflow = inflows, 
                    outflow = outflows, 
                    focus = "Espirito Santo", 
                    locations = locations,
                    pop_size = "location_population",
                    duration_stay = "length_of_stay",
                    num_cases = "num_cases_time_window",
                    first_date = "first_date_cases",
                    last_date = "last_date_cases"
                   )
ef
</code></pre>

<hr>
<h2 id='map_epiflows'>Map flows of people between locations</h2><span id='topic+map_epiflows'></span>

<h3>Description</h3>

<p>The function <code>map_epiflows</code> uses <code>leaflet</code> to generate an interactive map
displaying flows of people travelling between locations stored in a
<code>epiflows</code> object. Note that the object needs to possess geographic
coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_epiflows(
  x,
  title = "",
  center = NULL,
  sort = TRUE,
  pal = "YlOrBr",
  adjust_width = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_epiflows_+3A_x">x</code></td>
<td>
<p>An <code>epiflows</code> object.</p>
</td></tr>
<tr><td><code id="map_epiflows_+3A_title">title</code></td>
<td>
<p>Plot title.</p>
</td></tr>
<tr><td><code id="map_epiflows_+3A_center">center</code></td>
<td>
<p>An optional set of coordinates or character string specifying ID to use as the center of the map</p>
</td></tr>
<tr><td><code id="map_epiflows_+3A_sort">sort</code></td>
<td>
<p>a logical. When <code>TRUE</code> (default), the flows will be sorted
in order of number of cases on the map so that the largest flows appear on
top.</p>
</td></tr>
<tr><td><code id="map_epiflows_+3A_pal">pal</code></td>
<td>
<p>a color palette to pass on to <code><a href="leaflet.html#topic+colorNumeric">leaflet::colorQuantile()</a></code>. This
can be the name of a viridis or RColorBrewer palette, a vector of hex colors,
or a color-generating functon.</p>
</td></tr>
<tr><td><code id="map_epiflows_+3A_adjust_width">adjust_width</code></td>
<td>
<p>a logical specifying if the width of the flows should
be adjusted to reflect the number of flows between locations. Defaults to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="map_epiflows_+3A_...">...</code></td>
<td>
<p>Additional parameters (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>leaflet</code> object
</p>


<h3>Author(s)</h3>

<p>Paula Moraga, Pawel Piatkowski, Salla Toikkanen, Zhian Kamvar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
data("YF_coordinates")
ef &lt;- add_coordinates(Brazil_epiflows, YF_coordinates[-1])
plot(ef)
map_epiflows(ef, center = "Espirito Santo", title = "Flows to and from Brazil")
</code></pre>

<hr>
<h2 id='plot.epiflows'>Various plots for epiflows objects</h2><span id='topic+plot.epiflows'></span>

<h3>Description</h3>

<p>The <code>plot</code> method for <code>epiflows</code> objects offers types of
graphics (argument <code>type</code>):
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epiflows'
plot(x, type = c("map", "network", "grid"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.epiflows_+3A_x">x</code></td>
<td>
<p>an epiflows object.</p>
</td></tr>
<tr><td><code id="plot.epiflows_+3A_type">type</code></td>
<td>
<p>The type of plot to produce (defaults to map).</p>
</td></tr>
<tr><td><code id="plot.epiflows_+3A_...">...</code></td>
<td>
<p>arguments passed on to a given type</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>map</code>: flows are displayed on an interactive map; see <a href="#topic+map_epiflows">map_epiflows</a> for
more details
</p>
</li>
<li> <p><code>network</code>: flows are displayed as a network using the htmlwidget
<code>visNetwork</code> and the plotting method for <code>epicontacts</code> objects; see
<a href="#topic+vis_epiflows">vis_epiflows</a> for more details
</p>
</li>
<li> <p><code>grid</code>: flows are displayed as a grid between origins and destinations;
see <a href="#topic+grid_epiflows">grid_epiflows</a> for more details
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Salla Toikkanen, Thibaut Jombart, Zhian Kamvar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")

# no coordinates, defaults to network
plot(Brazil_epiflows) 

# grid bubbleplot
plot(Brazil_epiflows, "grid")

# adding coordinates defaults to map
data("YF_coordinates")
ef &lt;- add_coordinates(Brazil_epiflows, YF_coordinates[-1])
plot(ef)
</code></pre>

<hr>
<h2 id='print.epiflows'>Print method from epiflows objects</h2><span id='topic+print.epiflows'></span>

<h3>Description</h3>

<p>Displays a short summary of an <code>epiflows</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epiflows'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.epiflows_+3A_x">x</code></td>
<td>
<p>An <code>epiflows</code> object.</p>
</td></tr>
<tr><td><code id="print.epiflows_+3A_...">...</code></td>
<td>
<p>Additional parameters (not used).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar, Thibaut Jombart
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
print(Brazil_epiflows)

</code></pre>

<hr>
<h2 id='vis_epiflows'>Visualise epidemic flows using visNetwork</h2><span id='topic+vis_epiflows'></span>

<h3>Description</h3>

<p>This function shows flows between locations using a dynamic network
visualisation implemented in the package <span class="pkg">visNetwork</span>, calling the
function <code><a href="epicontacts.html#topic+vis_epicontacts">epicontacts::vis_epicontacts()</a></code> of the <span class="pkg">epicontacts</span>
package. The thickness of arrows/edges is proportional to the corresponding
flows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vis_epiflows(x, arrows = TRUE, max_width = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vis_epiflows_+3A_x">x</code></td>
<td>
<p>An <code>epiflows</code> object.</p>
</td></tr>
<tr><td><code id="vis_epiflows_+3A_arrows">arrows</code></td>
<td>
<p>A logical indicating if arrows should be used to show
directionality of the flows.</p>
</td></tr>
<tr><td><code id="vis_epiflows_+3A_max_width">max_width</code></td>
<td>
<p>A single number indicating the maximum width of an edge
(corresponding to the largest flow).</p>
</td></tr>
<tr><td><code id="vis_epiflows_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="epicontacts.html#topic+vis_epicontacts">epicontacts::vis_epicontacts()</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart
</p>

<hr>
<h2 id='YF_Brazil'>Yellow Fever Data from Brazil; 2016-12 to 2017-05</h2><span id='topic+YF_Brazil'></span><span id='topic+Brazil_epiflows'></span><span id='topic+YF_flows'></span><span id='topic+YF_locations'></span><span id='topic+YF_coordinates'></span>

<h3>Description</h3>

<p>This data set contains flows to and from five states in Brazil formatted in
a list with the following items:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Brazil_epiflows")
  data("YF_coordinates")
  data("YF_locations")
  data("YF_flows")
  data("YF_Brazil")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 4.
</p>


<h3>Details</h3>


<ul>
<li> <p><code style="white-space: pre;">&#8288;$states&#8288;</code>: a data frame containing metadata for five Brazilian States:
Espirito Santo, Minas Gerais, Rio de Janeiro, Sao Paulo, and Southeast
Brazil
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;$location_code&#8288;</code> : names of the states
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$location_population&#8288;</code> : population size for each state
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$num_cases_time_window&#8288;</code> : number of cases recorded between 2016-12 and 2017-05
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$first_date_cases&#8288;</code> : date of first disease case in the given location in ISO 8601 format
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$last_date_cases&#8288;</code> : date of last disease case in the given location in ISO 8601 format
</p>
</li></ul>

</li>
<li> <p><code style="white-space: pre;">&#8288;$T_D&#8288;</code> A matrix containing the number of travellers from the infectious
location visiting other locations
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$T_O&#8288;</code> A matrix containing the number of travellers visiting the infectious location
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$length_of_stay&#8288;</code> A named vector containing the average length of stay in
days of travellers from other locations visiting the infectious locations.
</p>
</li></ul>



<h3>References</h3>

<p>Dorigatti I, Hamlet A, Aguas R, Cattarino L, Cori A, Donnelly CA,
Garske T, Imai N, Ferguson NM. International risk of yellow fever spread from
the ongoing outbreak in Brazil, December 2016 to May 2017. Euro Surveill.
2017;22(28):pii=30572. DOI: <a href="https://doi.org/10.2807/1560-7917.ES.2017.22.28.30572">doi:10.2807/1560-7917.ES.2017.22.28.30572</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make_epiflows">make_epiflows()</a></code> for transformation to an epiflows object
<code><a href="#topic+estimate_risk_spread">estimate_risk_spread()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is an example of an epiflows object
data("Brazil_epiflows")
Brazil_epiflows

# The above data was constructed from a data frame containing flows and 
# one containing location metadata
data("YF_flows")
data("YF_locations")
ef &lt;- make_epiflows(flows         = YF_flows, 
                    locations     = YF_locations, 
                    pop_size      = "location_population",
                    duration_stay = "length_of_stay",
                    num_cases     = "num_cases_time_window",
                    first_date    = "first_date_cases",
                    last_date     = "last_date_cases"
                   )

# Both of the above data frames were constructed like so:

data("YF_Brazil")

# Create the flows data frame
from  &lt;- as.data.frame.table(YF_Brazil$T_D, stringsAsFactors = FALSE)
to    &lt;- as.data.frame.table(t(YF_Brazil$T_O), stringsAsFactors = FALSE)
flows &lt;- rbind(from, to)
colnames(flows) &lt;- c("from", "to", "n")

## Create the locations data frame
los &lt;- data.frame(location_code    = names(YF_Brazil$length_of_stay), 
                  length_of_stay   = YF_Brazil$length_of_stay,
                  stringsAsFactors = FALSE
                 )
locations &lt;- merge(x   = YF_Brazil$states, 
                   y   = los, 
                   by  = "location_code", 
                   all = TRUE)

## Use both to create the epiflows object.
ef &lt;- make_epiflows(flows, 
                    locations, 
                    pop_size = "location_population",
                    duration_stay = "length_of_stay",
                    num_cases = "num_cases_time_window",
                    first_date = "first_date_cases",
                    last_date = "last_date_cases"
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
