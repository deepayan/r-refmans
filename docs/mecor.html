<!DOCTYPE html><html><head><title>Help for package mecor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mecor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bloodpressure'><p>PDAC blood pressure data [replicates study]</p></a></li>
<li><a href='#haemoglobin'><p>Low-dose iron supplements haemoglobin data [internal outcome-validation study]</p></a></li>
<li><a href='#haemoglobin_ext'><p>Haemoglobin external data [external outcome-validation study]</p></a></li>
<li><a href='#ipwm'><p>Weighting for Confounding and Joint Misclassification of Exposure and Outcome</p></a></li>
<li><a href='#MeasError'><p>Create a Measurement Error Object</p></a></li>
<li><a href='#MeasErrorExt'><p>Create an External Measurement Error Object</p></a></li>
<li><a href='#MeasErrorRandom'><p>Create a Random Measurement Error Object</p></a></li>
<li><a href='#mecor'><p>mecor: a Measurement Error Correction Package</p></a></li>
<li><a href='#sim'><p>Simulated dataset for the ipwm function</p></a></li>
<li><a href='#sodium'><p>TONE sodium data [outcome-calibration study]</p></a></li>
<li><a href='#summary.mecor'><p>Summarizing Measurement Error Correction</p></a></li>
<li><a href='#vat'><p>NEO visceral adipose tissue data [internal covariate-validation study]</p></a></li>
<li><a href='#vat_ext'><p>Visceral adipose tissue external data [external covariate-validation study]</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Measurement Error Correction in Linear Models with a Continuous
Outcome</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Linda Nab</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Linda Nab &lt;lindanab4@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Covariate measurement error correction is implemented by means of regression calibration by Carroll RJ, Ruppert D, Stefanski LA &amp; Crainiceanu CM (2006, ISBN:1584886331), efficient regression calibration by Spiegelman D, Carroll RJ &amp; Kipnis V (2001) &lt;<a href="https://doi.org/10.1002/1097-0258(20010115)20:1%3C139::AID-SIM644%3E3.0.CO;2-K">doi:10.1002/1097-0258(20010115)20:1%3C139::AID-SIM644%3E3.0.CO;2-K</a>&gt; and maximum likelihood estimation by Bartlett JW, Stavola DBL &amp; Frost C (2009) &lt;<a href="https://doi.org/10.1002%2Fsim.3713">doi:10.1002/sim.3713</a>&gt;. Outcome measurement error correction is implemented by means of the method of moments by Buonaccorsi JP (2010, ISBN:1420066560) and efficient method of moments by Keogh RH, Carroll RJ, Tooze JA, Kirkpatrick SI &amp; Freedman LS (2014) &lt;<a href="https://doi.org/10.1002%2Fsim.7011">doi:10.1002/sim.7011</a>&gt;. Standard error estimation of the corrected estimators is implemented by means of the Delta method by Rosner B, Spiegelman D &amp; Willett WC (1990) &lt;<a href="https://doi.org/10.1093%2Foxfordjournals.aje.a115715">doi:10.1093/oxfordjournals.aje.a115715</a>&gt; and Rosner B, Spiegelman D &amp; Willett WC (1992) &lt;<a href="https://doi.org/10.1093%2Foxfordjournals.aje.a116453">doi:10.1093/oxfordjournals.aje.a116453</a>&gt;, the Fieller method described by Buonaccorsi JP (2010, ISBN:1420066560), and the Bootstrap by Carroll RJ, Ruppert D, Stefanski LA &amp; Crainiceanu CM (2006, ISBN:1584886331).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/LindaNab/mecor">https://github.com/LindaNab/mecor</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, lmerTest, numDeriv</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-01 18:59:49 UTC; lindanab</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-01 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bloodpressure'>PDAC blood pressure data [replicates study]</h2><span id='topic+bloodpressure'></span>

<h3>Description</h3>

<p>Blood pressure, age and creatinine levels of 450 pregnant women from the
Pregnancy Day Assessment Clinic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bloodpressure
</code></pre>


<h3>Format</h3>

<p>A data frame with 450 rows and 6 variables:
</p>

<dl>
<dt>creatinine</dt><dd><p>Serum creatinine (umol/L)</p>
</dd>
<dt>age</dt><dd><p>Age (years)</p>
</dd>
<dt>sbp30</dt><dd><p>Systolic blood pressure at 30 minutes (mm Hg)</p>
</dd>
<dt>sbp60</dt><dd><p>Systolic blood pressure at 60 minutes (mm Hg)</p>
</dd>
<dt>sbp90</dt><dd><p>Systolic blood pressure at 90 minutes (mm Hg)</p>
</dd>
<dt>sbp120</dt><dd><p>Systolic blood pressure at 120 minutes (mm Hg)</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a simulated dataset inspired by data that was originally published at the Dryad Digital Repository: &lt;doi:10.5061/dryad.0bq15&gt;
</p>


<h3>References</h3>

<p>Elizabeth Anne McCarthy, Thomas A Carins, Yolanda Hannigan, Nadia Bardien, Alexis Shub, and Susan P Walker. Data from: Effectiveness and safety of 1 vs 4h blood pressure profile with clinical and laboratory assessment for the exclusion of gestational hypertension and pre-eclampsia: a retrospective study in a university affiliated maternity hospital. Dryad (2015). &lt;doi:10.5061/dryad.0bq15&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("bloodpressure", package = "mecor")
</code></pre>

<hr>
<h2 id='haemoglobin'>Low-dose iron supplements haemoglobin data [internal outcome-validation study]</h2><span id='topic+haemoglobin'></span>

<h3>Description</h3>

<p>Capillary haemoglobin and venous haemoglobin levels of 400 subjects of a trial investigating the efficacy of low-dose iron supplements during pregnancy.
Venous haemoglobin levels were observed of approximately 25% of the subjects included in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>haemoglobin
</code></pre>


<h3>Format</h3>

<p>A data frame with 400 rows and 3 variables:
</p>

<dl>
<dt>capillary</dt><dd><p>Haemoglobin levels measured in capillary blood (g/L)</p>
</dd>
<dt>supplement</dt><dd><p>Low-dose iron supplement (20 mg/d) (0 = no, 1 = yes)</p>
</dd>
<dt>venous</dt><dd><p>Haemoglobin levels measured in venous blood (g/L)</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a simulated data set inspired by a trial investigating low-dose iron supplements &lt;doi:10.1093/ajcn/78.1.145&gt;. A motivating example using the example data can be found here: &lt;doi:10.1002/sim.8359&gt;
</p>


<h3>References</h3>

<p>Maria Makrides, Caroline A Crowther, Robert A Gibson, Rosalind S Gibson, and C Murray Skeaff. Efficacy and tolerability of low-dose iron supplements during pregnancy: a randomized controlled trial. The American Journal of Clinical Nutrition (2003). &lt;doi:10.1093/ajcn/78.1.145&gt;
</p>
<p>Linda Nab, Rolf HH Groenwold, Paco MJ Welsing, and Maarten van Smeden. Measurement error in continuous endpoints in randomised trials: Problems and solutions. Statistics in Medicine (2019). &lt;doi:10.1002/sim.8359&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("haemoglobin", package = "mecor")
</code></pre>

<hr>
<h2 id='haemoglobin_ext'>Haemoglobin external data [external outcome-validation study]</h2><span id='topic+haemoglobin_ext'></span>

<h3>Description</h3>

<p>Capillary haemoglobin and venous haemoglobin levels of 100 individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>haemoglobin_ext
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 rows and 2 variables:
</p>

<dl>
<dt>capillary</dt><dd><p>Haemoglobin levels measured in capillary blood (g/L)</p>
</dd>
<dt>venous</dt><dd><p>Haemoglobin levels measured in venous blood (g/L)</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a simulated data set accompanying the dataset &quot;haemoglobin&quot;, that is inspired by a trial investigating low-dose iron supplements &lt;doi:10.1093/ajcn/78.1.145&gt;. A motivating example using the example data can be found here: &lt;doi:10.1002/sim.8359&gt;
</p>


<h3>References</h3>

<p>Maria Makrides, Caroline A Crowther, Robert A Gibson, Rosalind S Gibson, and C Murray Skeaff. Efficacy and tolerability of low-dose iron supplements during pregnancy: a randomized controlled trial. The American Journal of Clinical Nutrition (2003). &lt;doi:10.1093/ajcn/78.1.145&gt;
</p>
<p>Linda Nab, Rolf HH Groenwold, Paco MJ Welsing, and Maarten van Smeden. Measurement error in continuous endpoints in randomised trials: Problems and solutions. Statistics in Medicine (2019). &lt;doi:10.1002/sim.8359&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("haemoglobin_ext", package = "mecor")
</code></pre>

<hr>
<h2 id='ipwm'>Weighting for Confounding and Joint Misclassification of Exposure and Outcome</h2><span id='topic+ipwm'></span>

<h3>Description</h3>

<p><code>ipwm</code> implements a method for estimating the marginal causal odds ratio by constructing weights (modified inverse probability weights) that address both confounding and joint misclassification of exposure and outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipwm(
  formulas,
  data,
  outcome_true,
  outcome_mis = NULL,
  exposure_true,
  exposure_mis = NULL,
  nboot = 1000,
  conf_level = 0.95,
  fix_nNAs = FALSE,
  semiparametric = FALSE,
  optim_args = list(method = "BFGS"),
  force_optim = FALSE,
  sp = Inf,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipwm_+3A_formulas">formulas</code></td>
<td>
<p>a list of objects of <a href="base.html#topic+class">class</a> <code><a href="stats.html#topic+formula">formula</a></code> specifying the probability models for the stats::terms of some factorisation of the joint conditional probability function of <code>exposure_true</code>, <code>exposure_mis</code>, <code>outcome_true</code> and <code>outcome_mis</code>, given covariates</p>
</td></tr>
<tr><td><code id="ipwm_+3A_data">data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> containing <code>exposure.true</code>, <code>exposure.mis</code>, <code>outcome.true</code>, <code>outcome.mis</code> and covariates. Missings (<code>NA</code>s) are allowed on variables <code>exposure_true</code> and <code>outcome_true</code>.</p>
</td></tr>
<tr><td><code id="ipwm_+3A_outcome_true">outcome_true</code></td>
<td>
<p>a character string specifying the name of the true outcome variable that is free of misclassification but possibly unknown (<code>NA</code>) for some (but not all) subjects</p>
</td></tr>
<tr><td><code id="ipwm_+3A_outcome_mis">outcome_mis</code></td>
<td>
<p>a character string specifying the name of the counterpart of <code>outcome_true</code> that is available on all subjects but potentially misclassifies subjects' outcomes. The default (<code>outcome_mis = NULL</code>) indicates absence of outcome misclassification</p>
</td></tr>
<tr><td><code id="ipwm_+3A_exposure_true">exposure_true</code></td>
<td>
<p>a character string specifying the name of the true exposure variable that is free of misclassification but possibly unknown (<code>NA</code>) for some (but not all) subjects</p>
</td></tr>
<tr><td><code id="ipwm_+3A_exposure_mis">exposure_mis</code></td>
<td>
<p>a character string specifying the name of the counterpart of <code>exposure_true</code> that is available on all subjects but potentially misclassifies subjects as exposed or as non-exposed. The default (<code>exposure_mis = NULL</code>) indicates absence of exposure misclassification</p>
</td></tr>
<tr><td><code id="ipwm_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap samples. Setting <code>nboot == 0</code> results in point estimation only.</p>
</td></tr>
<tr><td><code id="ipwm_+3A_conf_level">conf_level</code></td>
<td>
<p>the desired confidence level of the confidence interval</p>
</td></tr>
<tr><td><code id="ipwm_+3A_fix_nnas">fix_nNAs</code></td>
<td>
<p>logical indicator specifying whether or not to fix the joint distribution of <code>is.na(exposure_true)</code> and <code>is.na(outcome_true)</code>. If <code>TRUE</code>, stratified bootstrap sampling is done according to the missing data pattern.</p>
</td></tr>
<tr><td><code id="ipwm_+3A_semiparametric">semiparametric</code></td>
<td>
<p>logical indicator specifying whether or not to parametrically sample <code>exposure_true</code>, <code>exposure_mis</code>, <code>outcome_true</code> and <code>outcome_mis</code>. If <code>semiparametric == TRUE</code>, it is assumed that the missing data pattern is conditionally independent of these variables given covariates. Provided <code>nboot &gt; 0</code>, the missing data pattern and covariates are sampled nonparametrically. <code>semiparametric</code> is ignored if <code>nboot == 0</code>.</p>
</td></tr>
<tr><td><code id="ipwm_+3A_optim_args">optim_args</code></td>
<td>
<p>arguments passed onto <code><a href="stats.html#topic+optim">optim</a></code> if called. See Details below for more information.</p>
</td></tr>
<tr><td><code id="ipwm_+3A_force_optim">force_optim</code></td>
<td>
<p>logical indicator specifying whether or not to force the <code><a href="stats.html#topic+optim">optim</a></code> function to be called</p>
</td></tr>
<tr><td><code id="ipwm_+3A_sp">sp</code></td>
<td>
<p>scalar shrinkage parameter in the interval <code>(0, Inf)</code>. Values closer to zero result in greater shrinkage of the estimated odds ratio to unity; <code>sp == Inf</code> results in no shrinkage.</p>
</td></tr>
<tr><td><code id="ipwm_+3A_print">print</code></td>
<td>
<p>logical indicator specifying whether or not to print the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an implementation of the weighting method described by Penning de Vries et al. (2018).
The method defaults to the estimator proposed by Gravel and Platt (2018) in the absence of exposure misclassification.
</p>
<p>The function assumes that the exposure or the outcome has a misclassified version. An error is issued when both <code>outcome_mis</code> and <code>exposure_mis</code> are set to <code>NULL</code>.
</p>
<p>Provided <code>force_optim = FALSE</code>, <code>ipwm</code> is considerably more efficient when the <code><a href="stats.html#topic+optim">optim</a></code> function is not invoked; i.e., when (1) <code>exposure_mis = NULL</code> and the formula for <code>outcome_true</code> does not contain stats::terms involving <code>outcome_mis</code> or <code>exposure_true</code>, (2) <code>outcome_mis = NULL</code> and the formula for <code>exposure_true</code> does not contain stats::terms involving <code>exposure_mis</code> or <code>outcome_true</code>, or (3) <code>all(is.na(data[, exposure_true]) == is.na(data[, outcome_true]))</code> and the formulas for <code>exposure_true</code> and <code>outcome_true</code> do not contain stats::terms involving <code>exposure_mis</code> or <code>outcome_mis</code>. In these cases, <code>ipwm</code> uses iteratively reweighted least squares via the <code><a href="stats.html#topic+glm">glm</a></code> function for maximum likelihood estimation. In all other cases, <code>optim_args</code> is passed on to <code><a href="stats.html#topic+optim">optim</a></code> for optimisation of the joint likelihood of <code>outcome_true</code>, <code>outcome_mis</code>, <code>exposure_true</code> and <code>exposure_mis</code>.
</p>


<h3>Value</h3>

<p><code>ipwm</code> returns an object of <a href="base.html#topic+class">class</a> <code>ipwm</code>.
The returned object is a list containing the following elements:
</p>
<table>
<tr><td><code>logOR</code></td>
<td>
<p>the estimated log odds ratio;</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td></tr>
</table>
<p>If <code>nboot != 0</code>, the list also contains
</p>
<table>
<tr><td><code>SE</code></td>
<td>
<p>a bootstrap estimate of the standard error for the estimator of the log odds ratio;</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>a bootstrap percentile confidence interval for the log odds ratio.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bas B. L. Penning de Vries, <a href="mailto:b.b.l.penning_de_vries@lumc.nl">b.b.l.penning_de_vries@lumc.nl</a>
</p>


<h3>References</h3>

<p>Gravel, C. A., &amp; Platt, R. W. (2018). Weighted estimation for confounded binary outcomes subject to misclassification. <em>Statistics in medicine</em>, 37(3), 425-436. https://doi.org/10.1002/sim.7522
</p>
<p>Penning de Vries, B. B. L., van Smeden, M., &amp; Groenwold, R. H. H. (2020). A weighting method for simultaneous adjustment for confounding and joint exposure-outcome misclassifications. <em>Statistical Methods in Medical Research</em>, 0(0), 1-15. https://doi.org/10.1177/0962280220960172
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim) # simulated data on 10 covariates, exposure A and outcome Y.
formulas &lt;- list(
  Y ~ A + L1 + L2 + L3 + L4 + L5 + L6 + L7 + L8 + L9 + L10 + B + Z,
  A ~ L1 + L2 + L3 + L4 + L5 + L6 + L7 + L8 + L9 + L10 + B + Z,
  Z ~ L1 + L2 + L3 + L4 + L5 + L6 + L7 + L8 + L9 + L10 + B,
  B ~ L1 + L2 + L3 + L4 + L5 + L6 + L7 + L8 + L9 + L10
)
## Not run: 
ipwm_out &lt;- ipwm(
  formulas = formulas,
  data = sim,
  outcome_true = "Y",
  outcome_mis = "Z",
  exposure_true = "A",
  exposure_mis = "B",
  nboot = 200,
  sp = 1e6
)
ipwm_out

## End(Not run)

</code></pre>

<hr>
<h2 id='MeasError'>Create a Measurement Error Object</h2><span id='topic+MeasError'></span>

<h3>Description</h3>

<p>This function creates a measurement error object, usually used as a covariate
or the outcome in the <code>formula</code> argument of <a href="#topic+mecor">mecor</a> if one
wants to correct for the measurement error in that variable using a reference
variable or a replicate measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MeasError(substitute, reference, replicate, differential)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MeasError_+3A_substitute">substitute</code></td>
<td>
<p>a vector containing the error-prone measure</p>
</td></tr>
<tr><td><code id="MeasError_+3A_reference">reference</code></td>
<td>
<p>a vector containing the reference measure assumed without
measurement error</p>
</td></tr>
<tr><td><code id="MeasError_+3A_replicate">replicate</code></td>
<td>
<p>a vector or matrix with replicates of the error-prone
measure with classical measurement error. This can either be
replicates obtained by using the same measurement method as the substitute
measure (replicates study) or replicates using a different measurement method
than the substitute measure (calibration study).</p>
</td></tr>
<tr><td><code id="MeasError_+3A_differential">differential</code></td>
<td>
<p>a vector containing the variable to which the measurement
error is differential.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>MeasError</code> returns an object of <a href="base.html#topic+class">class</a> &quot;MeasError&quot;.
</p>
<p>An object of class <code>MeasError</code> is a list containing the substitute and
reference (and replicate or differential if applicable) variables and has
attributes input (the name of the substitute and reference or replicate
and differential (if applicable) variables) and call (the matched call).
</p>


<h3>Author(s)</h3>

<p>Linda Nab, <a href="mailto:l.nab@lumc.nl">l.nab@lumc.nl</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## measurement error in a covariate:
# internal covariate-validation study
data(vat)
with (vat, MeasError(substitute = wc,
                     reference = vat))
# replicates study
data(bloodpressure)
with (bloodpressure, MeasError(substitute = sbp30,
                               replicate = cbind(sbp60, sbp120)))
# outcome-calibration study
data(sodium)
with(sodium, MeasError(substitute = recall,
                       replicate = cbind(urinary1, urinary2)))
## measurement error in the outcome:
# internal outcome-validation study
data(haemoglobin)
with(haemoglobin, MeasError(substitute = capillary,
                            reference = venous))
# internal outcome- validation study with differential measurement error in
# the dependent variable
data(haemoglobin)
with(haemoglobin, MeasError(substitute = capillary,
                            reference = venous,
                            differential = supplement))
</code></pre>

<hr>
<h2 id='MeasErrorExt'>Create an External Measurement Error Object</h2><span id='topic+MeasErrorExt'></span>

<h3>Description</h3>

<p>This function creates an external measurement error object, usually used as
a covariate or the outcome in the <code>formula</code> argument of
<a href="#topic+mecor">mecor</a> if one wants to correct for the measurement error in that
variable using external data or externally estimated coefficients of the
calibration model (covariate-measurement error) or measurement error model
(outcome-measurement error)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MeasErrorExt(substitute, model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MeasErrorExt_+3A_substitute">substitute</code></td>
<td>
<p>a vector containing the error-prone measure</p>
</td></tr>
<tr><td><code id="MeasErrorExt_+3A_model">model</code></td>
<td>
<p>a fitted linear model of class <a href="stats.html#topic+lm">lm</a> or a named
<a href="base.html#topic+list">list</a>. The <a href="base.html#topic+list">list</a> contains a vector named <code>coef</code>:
the coefficients of the calibration model or measurement error model and an
optional matrix named <code>vcov</code>: the variance&ndash;covariance matrix of the
coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>MeasErrorExt</code> returns an object of <a href="base.html#topic+class">class</a>
&quot;MeasErrorExt&quot;.
</p>
<p>An object of class <code>MeasErrorExt</code> is a list containing the substitute
variable and the fitted calibration model or measurement error model and has
attributes input (the name of the substitute variable) and call (the matched
call).
</p>


<h3>Author(s)</h3>

<p>Linda Nab, <a href="mailto:l.nab@lumc.nl">l.nab@lumc.nl</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## measurement error in a outcome:
# external outcome-validation study
data(haemoglobin_ext)
# calibration model
calmod_fit &lt;- lm(capillary ~ venous, data = haemoglobin)
# the external covariate-validation study can be used to correct for the
# measurement error in X_star in the dataset 'icvs', using the fitted
# calibration model
data(haemoglobin)
with (haemoglobin, MeasErrorExt(substitute = capillary,
                                model = calmod_fit))
# identical to:
calmod_coef &lt;- coefficients(calmod_fit)
calmod_vcov &lt;- vcov(calmod_fit)
with (haemoglobin, MeasErrorExt(substitute = capillary,
                                model = list(coef = calmod_coef,
                                             vcov = calmod_vcov)))
# when no external data is available, guesstimations of the coefficients of
# the calibration model can be used instead:
with (haemoglobin, MeasErrorExt(substitute = capillary,
                                model = list(coef = c('(Intercept)' = -7,
                                                      'venous' = 1.1))))
</code></pre>

<hr>
<h2 id='MeasErrorRandom'>Create a Random Measurement Error Object</h2><span id='topic+MeasErrorRandom'></span>

<h3>Description</h3>

<p>This function creates a random measurement error object, usually used as
a covariate in the <code>formula</code> argument of <a href="#topic+mecor">mecor</a> if one
wants to correct for random measurement error in that variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MeasErrorRandom(substitute, variance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MeasErrorRandom_+3A_substitute">substitute</code></td>
<td>
<p>a vector containing the error-prone measure</p>
</td></tr>
<tr><td><code id="MeasErrorRandom_+3A_variance">variance</code></td>
<td>
<p>a numeric quantifying the assumed variance of the random measurement error</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>MeasErrorRandom</code> returns an object of <a href="base.html#topic+class">class</a>
&quot;MeasErrorRandom&quot;.
</p>
<p>An object of class <code>MeasErrorRandom</code> is a list containing the substitute
variable, the assumed variance of the random measurement error in that variable and, the
attributes input (the name of the substitute variable) and call (the matched
call).
</p>


<h3>Author(s)</h3>

<p>Linda Nab, <a href="mailto:l.nab@lumc.nl">l.nab@lumc.nl</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## random measurement error in a covariate:
# internal covariate-validation study
data(bloodpressure)
with(bloodpressure, MeasErrorRandom(sbp30, variance = 0.25))
</code></pre>

<hr>
<h2 id='mecor'>mecor: a Measurement Error Correction Package</h2><span id='topic+mecor'></span>

<h3>Description</h3>

<p>mecor provides correction methods for measurement error in a continuous
covariate or outcome in linear regression models with a continuous outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mecor(formula, data, method = "standard", B = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mecor_+3A_formula">formula</code></td>
<td>
<p>an object of class <a href="stats.html#topic+formula">formula</a> (or one that is
coerced to that class): a symbolic description of the regression model
containing a <a href="#topic+MeasError">MeasError</a>, <a href="#topic+MeasErrorExt">MeasErrorExt</a> or
<a href="#topic+MeasErrorRandom">MeasErrorRandom</a> object in one of the covariates or the outcome.</p>
</td></tr>
<tr><td><code id="mecor_+3A_data">data</code></td>
<td>
<p>a data.frame, list or environment (or object coercible by
as.data.frame to a data frame) containing the variables in the model
specified in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="mecor_+3A_method">method</code></td>
<td>
<p>a character string indicating the method used to correct for
the measurement error, either &quot;standard&quot; (regression calibration for
covariate measurement error and method of moments for outcome measurement
error), &quot;efficient&quot; (efficient regression calibration for covariate
measurement error and efficient method of moments for outcome measurement
error), &quot;valregcal&quot; (validation regression calibration) or &quot;mle&quot; (maximum
likelihood estimation). Defaults to &quot;standard&quot;.</p>
</td></tr>
<tr><td><code id="mecor_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples, defaults to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mecor</code> returns an object of <a href="base.html#topic+class">class</a> &quot;mecor&quot;.
</p>
<p>An object of class <code>mecor</code> is a list containing the following components:
</p>
<table>
<tr><td><code>corfit</code></td>
<td>
<p>a list containing the corrected fit, including the coefficients
of the corrected fit (<code>coef</code>) and the variance&ndash;covariance matrix of the
coefficients of the corrected fit obtained by the delta method (<code>vcov</code>),
and more depending on the method used.</p>
</td></tr>
<tr><td><code>uncorfit</code></td>
<td>
<p>an <a href="stats.html#topic+lm.fit">lm.fit</a> object of the uncorrected fit.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linda Nab, <a href="mailto:l.nab@lumc.nl">l.nab@lumc.nl</a>
</p>


<h3>References</h3>

<p>L. Nab, R.H.H. Groenwold, P.M.J. Welsing, and  M. van Smeden.
Measurement error in continuous endpoints in randomised trials: problems and
solutions
</p>
<p>L. Nab, M. van Smeden, R.H. Keogh, and R.H.H. Groenwold.
mecor: an R package for measurement error correction in linear models with
continuous outcomes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## measurement error in a covariate/outcome:
# internal covariate-validation study
data(vat)
out &lt;-
mecor(ir_ln ~ MeasError(wc, reference = vat) + sex + age + tbf,
      data = vat,
      method = "standard",
      B = 999)
# replicates study
data(bloodpressure)
mecor(creatinine ~ MeasError(sbp30, replicate = cbind(sbp60, sbp120)) + age,
      data = bloodpressure,
      method = "mle")
# outcome-calibration study
data(sodium)
mecor(MeasError(recall, replicate = cbind(urinary1, urinary2)) ~ diet,
      data = sodium,
      method = "efficient")
# external outcome-validation study
data(haemoglobin_ext)
calmod_fit &lt;- lm(capillary ~ venous, data = haemoglobin_ext)
data(haemoglobin) # suppose reference venous is not available
mecor(MeasErrorExt(capillary, model = calmod_fit) ~ supplement,
      data = haemoglobin)
# sensitivity analyses
data(vat) # suppose reference vat is not available
# guesstimate the coefficients of the calibration model:
mecor(ir_ln ~ MeasErrorExt(wc, model = list(coef = c(0.2, 0.5, -1.3, 0, 0.6))) + sex + age + tbf,
      data = vat)
# assume random measurement error in wc of magnitude 0.25:
mecor(ir_ln ~ MeasErrorRandom(wc, variance = 0.25) + sex + age + tbf,
      data = vat)
data(bloodpressure) # suppose replicates sbp60 and sbp60 are not available
mecor(creatinine ~ MeasErrorRandom(sbp30, variance = 25) + age,
      data = bloodpressure)

## differential measurement error in the outcome:
# internal outcome-validation study
mecor(MeasError(capillary, reference = venous, differential = supplement) ~ supplement,
      data = haemoglobin,
      method = "standard")
</code></pre>

<hr>
<h2 id='sim'>Simulated dataset for the <a href="#topic+ipwm">ipwm</a> function</h2><span id='topic+sim'></span>

<h3>Description</h3>

<p>A simulated dataset containing 5000 observations of the covariates L1-L10,
the true exposure A and true outcome Y, and the misclassified exposure B and
misclassified outcome Z.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim
</code></pre>


<h3>Format</h3>

<p>A data frame with 5000 rows and 14 variables:
</p>

<dl>
<dt>L1</dt><dd><p>covariate, binary</p>
</dd>
<dt>L2</dt><dd><p>covariate, continuous</p>
</dd>
<dt>L3</dt><dd><p>covariate, binary</p>
</dd>
<dt>L4</dt><dd><p>covariate, continuous</p>
</dd>
<dt>L5</dt><dd><p>covariate, binary</p>
</dd>
<dt>L6</dt><dd><p>covariate, binary</p>
</dd>
<dt>L7</dt><dd><p>covariate, continuous</p>
</dd>
<dt>L8</dt><dd><p>covariate, binary</p>
</dd>
<dt>L9</dt><dd><p>covariate, binary</p>
</dd>
<dt>L10</dt><dd><p>covariate, continuous</p>
</dd>
<dt>A</dt><dd><p>exposure, binary</p>
</dd>
<dt>Y</dt><dd><p>outcome, binary</p>
</dd>
<dt>B</dt><dd><p>misclassified exposure, binary</p>
</dd>
<dt>Z</dt><dd><p>misclassified outcome, binary</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data("sim", package = "mecor")
</code></pre>

<hr>
<h2 id='sodium'>TONE sodium data [outcome-calibration study]</h2><span id='topic+sodium'></span>

<h3>Description</h3>

<p>Self-reported sodium intake and urinary sodium in the TONE study, a randomized controlled trial designed to
investigate whether a reduction in sodium intake results in satisfactory blood pressure control.
Two replicate urinary sodium measures were available in 50% of the subjects included in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sodium
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 4 variables:
</p>

<dl>
<dt>recall</dt><dd><p>Sodium intake measured by a 24h recall (mg)</p>
</dd>
<dt>diet</dt><dd><p>Usual diet or sodium-lowering diet (0 = usual, 1 = sodium-lowering)</p>
</dd>
<dt>urinary1</dt><dd><p>Sodium intake measured in urine (1st measure, mg)</p>
</dd>
<dt>urinary2</dt><dd><p>Sodium intake measured in urine (2nd measure, mg)</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a simulated data set inspired by the TONE study &lt;doi: 10.1016/1047-2797(94)00056-y&gt;. A motivating example using the example data can be found here: &lt;doi:10.1002/sim.7011&gt;
</p>


<h3>References</h3>

<p>Lawrence J Appel, Mark Espeland, Paul K Whelton, Therese Dolecek, Shiriki Kumanyika, William B Applegate, Walter H Ettinger, John B Kostis, Alan C Wilson, Clifton Lacy, and Stephen T Miller. Trial of Nonpharmacologic Intervention in the Elderly (TONE). Design and rationale of a blood pressure control trial. Annals of Epidemiology (1995). &lt;doi: 10.1016/1047-2797(94)00056-y&gt;
</p>
<p>Ruth H Keogh, Raymond J Carroll, Janet A Tooze, Sharon I Kirkpatrick, Laurence S Freedman. Statistical issues related to dietary intake as the response variable in intervention trials. Statistics in Medicine (2016). &lt;doi:10.1002/sim.7011&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sodium", package = "mecor")
</code></pre>

<hr>
<h2 id='summary.mecor'>Summarizing Measurement Error Correction</h2><span id='topic+summary.mecor'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;mecor&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mecor'
summary(object, alpha = 0.05, zerovar = FALSE, fieller = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mecor_+3A_object">object</code></td>
<td>
<p>an object of class &quot;mecor&quot;, a result of a call to
<a href="#topic+mecor">mecor</a>.</p>
</td></tr>
<tr><td><code id="summary.mecor_+3A_alpha">alpha</code></td>
<td>
<p>probability of obtaining a type II error.</p>
</td></tr>
<tr><td><code id="summary.mecor_+3A_zerovar">zerovar</code></td>
<td>
<p>a boolean indicating whether standard errors and confidence
intervals using the zerovariance method must be added to the summary object.</p>
</td></tr>
<tr><td><code id="summary.mecor_+3A_fieller">fieller</code></td>
<td>
<p>a boolean indicating whether confidence intervals using the
fieller method must be added to the summary object.</p>
</td></tr>
<tr><td><code id="summary.mecor_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>summary.mecor</code> returns a list of summary statistics of the
fitted corrected model and fitted uncorrected model.
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>summary of the corrected fit</p>
</td></tr>
<tr><td><code>uc</code></td>
<td>
<p>summary of the uncorrected fit</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>number of bootstrap replicates used</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>alpha level used</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The model fitting function <a href="#topic+mecor">mecor</a>, <a href="base.html#topic+summary">summary</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## measurement error in a covariate:
# internal covariate-validation study
data(vat)
mecor_fit &lt;- mecor(ir_ln ~ MeasError(wc, reference = vat) + sex + age + tbf,
                   data = vat,
                   method = "standard")
summary(mecor_fit)
summary(mecor_fit, zerovar = TRUE, fieller = TRUE)
summary(mecor_fit, alpha = 0.10)

</code></pre>

<hr>
<h2 id='vat'>NEO visceral adipose tissue data [internal covariate-validation study]</h2><span id='topic+vat'></span>

<h3>Description</h3>

<p>Insulin resistance, waist circumference, sex, age, total body fat and visceral adipose tissue of 650 individuals from the
Netherlands Epidemiology of Obesity (NEO) study. Visceral adipose tissue measurements were taken of approximately 40% of the individuals, at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vat
</code></pre>


<h3>Format</h3>

<p>A data frame with 650 rows and 6 variables:
</p>

<dl>
<dt>ir_ln</dt><dd><p>Natural logarithm of insulin resistance (fasting glucose (mmol/L) x fasting insulin (mU/L) / 22.5)</p>
</dd>
<dt>wc</dt><dd><p>Waist circumference (standardised, cm)</p>
</dd>
<dt>sex</dt><dd><p>Sex (0 = male, 1 = female)</p>
</dd>
<dt>age</dt><dd><p>Age (years)</p>
</dd>
<dt>tbf</dt><dd><p>Total body fat (standardised, %)</p>
</dd>
<dt>vat</dt><dd><p>Visceral adipose tissue (standardised, cm^2)</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a simulated data set inspired by the NEO data &lt;doi:10.1007/s10654-013-9801-3&gt;. A motivating example using the example data can be found here: &lt;doi:10.1093/aje/kwab114&gt;
</p>


<h3>References</h3>

<p>Renee de Mutsert, Martin den Heijer, Ton J Rabelink, Johannes WA Smit, Johannes A Romijn, Johan W Jukema, Albert de Roos, Christa M Cobbaert, Margreet Kloppenburg, Saskia le Cessie, Saskia Middeldorp, Frits R Rosendaal. The Netherlands epidemiology of obesity (NEO) study: Study design and data collection. European Journal of Epidemiology (2013). &lt;doi:10.1007/s10654-013-9801-3&gt;
</p>
<p>Linda Nab, Maarten van Smeden, Renee de Mutsert, Frits R Rosendaal, and Rolf HH Groenwold. Sampling strategies for internal validation samples for exposure measurement error correction: A study of visceral adipose tissue measures replaced by waist circumference measures. American Journal of Epidemiology (2021). &lt;doi:10.1093/aje/kwab114&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("vat", package = "mecor")
</code></pre>

<hr>
<h2 id='vat_ext'>Visceral adipose tissue external data [external covariate-validation study]</h2><span id='topic+vat_ext'></span>

<h3>Description</h3>

<p>Waist circumference, visceral adipose tissue, sex, age, and total body fat of 100 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vat_ext
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 rows and 5 variables:
</p>

<dl>
<dt>wc</dt><dd><p>Waist circumference (standardised, cm)</p>
</dd>
<dt>vat</dt><dd><p>Visceral adipose tissue (standardised, cm^2)</p>
</dd>
<dt>sex</dt><dd><p>Sex (0 = male, 1 = female)</p>
</dd>
<dt>age</dt><dd><p>Age (years)</p>
</dd>
<dt>tbf</dt><dd><p>Total body fat (standardised, %)</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a simulated data set accompanying the dataset &quot;vat&quot;, that is inspired by the NEO data &lt;doi:10.1007/s10654-013-9801-3&gt;. A motivating example using the example data can be found here: &lt;doi:10.1093/aje/kwab114&gt;
</p>


<h3>References</h3>

<p>Renee de Mutsert, Martin den Heijer, Ton J Rabelink, Johannes WA Smit, Johannes A Romijn, Johan W Jukema, Albert de Roos, Christa M Cobbaert, Margreet Kloppenburg, Saskia le Cessie, Saskia Middeldorp, Frits R Rosendaal. The Netherlands epidemiology of obesity (NEO) study: Study design and data collection. European Journal of Epidemiology (2013). &lt;doi:10.1007/s10654-013-9801-3&gt;
</p>
<p>Linda Nab, Maarten van Smeden, Renee de Mutsert, Frits R Rosendaal, and Rolf HH Groenwold. Sampling strategies for internal validation samples for exposure measurement error correction: A study of visceral adipose tissue measures replaced by waist circumference measures. American Journal of Epidemiology (2021). &lt;doi:10.1093/aje/kwab114&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("vat_ext", package = "mecor")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
