<!DOCTYPE html><html><head><title>Help for package LSE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LSE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Antiquaternion'>
<p>Antiquaternion</p></a></li>
<li><a href='#Direct Elimination'>
<p>Direct Elimination for LSE problem.</p></a></li>
<li><a href='#GQR'>
<p>Generalized QR Factorization</p></a></li>
<li><a href='#Lagrange'>
<p>Lagrange multipliers for LSE problem.</p></a></li>
<li><a href='#LSE'><p>LSE package</p></a></li>
<li><a href='#LSE_GQR'>
<p>LSE and GQR Factorization</p></a></li>
<li><a href='#Nullspace'>
<p>Nullspace method for LSE problem.</p></a></li>
<li><a href='#Quaternion'>
<p>Quaternion transformation</p></a></li>
<li><a href='#RQ'>
<p>RQ Factorization of a matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Constrained Least Squares and Generalized QR Factorization</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Sergio Andrés Cabrera Miranda &lt;https://orcid.org/0000-0002-8126-8521&gt;, Juan Gabriel Triana Laverde &lt;https://orcid.org/0000-0003-2991-6082&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sergio Andrés Cabrera Miranda &lt;sergio05acm@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The solution of equality constrained least squares problem (LSE) is
    given through four analytics methods (Generalized QR Factorization, Lagrange 
    Multipliers, Direct Elimination and Null Space method). We expose the 
    orthogonal decomposition called Generalized QR Factorization (GQR) and also RQ 
    factorization. Finally some codes for the solution of LSE applied in 
    quaternions.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/sergio05acm/LSE">https://github.com/sergio05acm/LSE</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, pracma</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-02 00:25:25 UTC; Sergio</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-02 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Antiquaternion'>
Antiquaternion
</h2><span id='topic+Antiquaternion'></span>

<h3>Description</h3>

<p>A quaternion matrix obtained by the Quaternion function, can be transformed into a matrix, which contains as many quaternions as rows obtained, each column represent an imaginary axis (1,i,j,k).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Antiquaternion(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Antiquaternion_+3A_x">x</code></td>
<td>

<p>Quaternion matrix object.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function shows in each row a quaternion, and in each column an axis in the order a+bi+cj+dk.
</p>


<h3>Value</h3>

<p>Numeric matrix.
</p>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda
Statician
sergio05acm@gmail.com
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+Quaternion">Quaternion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Antiquaternion(Quaternion(1,0,1,0))


</code></pre>

<hr>
<h2 id='Direct+20Elimination'>
Direct Elimination for LSE problem.
</h2><span id='topic+Dir_Elimination'></span>

<h3>Description</h3>

<p>Direct Elimination allows to give an analytic solution for equality constrained least squares problem (LSE).
Requires MASS and pracma library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dir_Elimination(A,C,b,d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Direct+2B20Elimination_+3A_a">A</code></td>
<td>

<p>Design matrix, m rows and n columns.
</p>
</td></tr>
<tr><td><code id="Direct+2B20Elimination_+3A_c">C</code></td>
<td>

<p>Constraint matrix, p rows and n columns.
</p>
</td></tr>
<tr><td><code id="Direct+2B20Elimination_+3A_b">b</code></td>
<td>

<p>Response vector for A, Ax=b, m rows and 1 column.
</p>
</td></tr>
<tr><td><code id="Direct+2B20Elimination_+3A_d">d</code></td>
<td>

<p>Response vector for C, Cx=d, p rows and 1 column.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Direct Elimination method gives a numerical vector as the solution of a least squares problem (Ax=b), when impose some restrictions (additional information, extramuestral information or a priori information) that lead to another linear equality system (Cx=d). See significance constraint (x=0) or inclusion restriction (x+y=1), etc.
</p>


<h3>Value</h3>

<p>Numerical vector for a LSE problem.
</p>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda
Statician
sergio05acm@gmail.com
</p>


<h3>References</h3>

<p>Lawson, C. L., &amp; Hanson, R. J. (1974). Linear least squares with linear inequality constraints. Solving least squares problems, 158-173.
</p>
<p>Van Benthem, M. H., Keenan, M. R., &amp; Haaland, D. M. (2002). Application of equality constraints on variables during alternating least squares procedures. Journal of Chemometrics: A Journal of the Chemometrics Society, 16(12), 613-622.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = matrix(runif(50,-1,1),10,5)
C = matrix(runif(20,-1,1),4,5)
b = matrix(runif(10,-1,1),10,1)
d = matrix(runif(4,-1,1),4,1)

Dir_Elimination(A,C,b,d)

</code></pre>

<hr>
<h2 id='GQR'>
Generalized QR Factorization
</h2><span id='topic+GQR'></span>

<h3>Description</h3>

<p>This code provides a simultaneous orthogonal factorization for two matrices A and B.
This code requires pracma library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GQR(x,y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GQR_+3A_x">x</code></td>
<td>

<p>Numerical matrix with m rows and n columns.
</p>
</td></tr>
<tr><td><code id="GQR_+3A_y">y</code></td>
<td>

<p>Numerical matrix with p rows and n columns.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given two matrices, with the same number of rows, this algorithm provides a single factorization, such that A=QR and (Q^T)B=WS.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Q</code></td>
<td>
<p>Orthogonal matrix for A</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Trapezoidal matrix for A</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Orthogonal matrix for (Q^T)B</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Trapezoidal matrix for (Q^T)B</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda
Statician
sergio05acm@gmail.com
</p>


<h3>References</h3>

<p>Cabrera Miranda, S. A., &amp; Triana Laverde, J. G. (2021). El problema de los mínimos cuadrados con restricciones de igualdad mediante la factorización QR generalizada. Selecciones Matemáticas, 8(02), 437-443. (English Article).
</p>
<p>Anderson, E., Bai, Z., &amp; Dongarra, J. (1992). Generalized QR factorization and its applications. Linear Algebra and its Applications, 162, 243-271.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = matrix(c(1,1,1,1,3,1,1,-1,1,1,1,1),4,3,byrow=TRUE)
C = matrix(c(1,1,1,1,1,-1),2,3,byrow=TRUE)
GQR(t(A),t(C))
</code></pre>

<hr>
<h2 id='Lagrange'>
Lagrange multipliers for LSE problem.
</h2><span id='topic+Lagrange'></span>

<h3>Description</h3>

<p>Lagrange multipliers allows to give a analytic solution for equality constrained least squares problem (LSE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Lagrange(A,C,b,d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Lagrange_+3A_a">A</code></td>
<td>

<p>Design matrix, m rows and n columns.
</p>
</td></tr>
<tr><td><code id="Lagrange_+3A_c">C</code></td>
<td>

<p>Constraint matrix, p rows and n columns.
</p>
</td></tr>
<tr><td><code id="Lagrange_+3A_b">b</code></td>
<td>

<p>Response vector for A, Ax=b, m rows and 1 column.
</p>
</td></tr>
<tr><td><code id="Lagrange_+3A_d">d</code></td>
<td>

<p>Response vector for C, Cx=d, p rows and 1 column.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lagrange multipliers method gives a numerical vector as the solution of a least squares problem (Ax=b) through unification the model and their restrictions in one function, the restrictions impose in the model (additional information, extramuestral information or a priori information) lead to another linear equality system (Cx=d). See significance constraint (x=0) or inclusion restriction (x+y=1), etc.
</p>


<h3>Value</h3>

<p>Numerical vector for a LSE problem.
</p>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda
Statician
sergio05acm@gmail.com
</p>


<h3>References</h3>

<p>Rao, C. R., Toutenburg, H., Shalabh, H. C., &amp; Schomaker, M. (2008). Linear models and generalizations. Least Squares and Alternatives (3rd edition) Springer, Berlin Heidelberg New York.
</p>
<p>Theil, H. (1971). Principles of econometrics (No. 04; HB139, T44.).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = matrix(runif(50,-1,1),10,5)
C = matrix(runif(20,-1,1),4,5)
b = matrix(runif(10,-1,1),10,1)
d = matrix(runif(4,-1,1),4,1)

Lagrange(A,C,b,d)

</code></pre>

<hr>
<h2 id='LSE'>LSE package</h2><span id='topic+LSE'></span>

<h3>Description</h3>

<p>Solve the equality constrained least sqaures problem for real value and for quaternions, also allows to use the Generalized QR factorization for two matrices simlutaneously.
</p>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda <a href="mailto:sergio05acm@gmail.com">sergio05acm@gmail.com</a>
</p>

<hr>
<h2 id='LSE_GQR'>
LSE and GQR Factorization
</h2><span id='topic+LSE_GQR'></span>

<h3>Description</h3>

<p>This code provides the solution of equality constrained least squares problem through Generalized QR Factorization.
Require MASS package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LSE_GQR(A,C,b,d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LSE_GQR_+3A_a">A</code></td>
<td>

<p>Design matrix, m rows and n columns.
</p>
</td></tr>
<tr><td><code id="LSE_GQR_+3A_c">C</code></td>
<td>

<p>Constraint matrix, p rows and n columns.
</p>
</td></tr>
<tr><td><code id="LSE_GQR_+3A_b">b</code></td>
<td>

<p>Response vector for A, Ax=b, m rows and 1 column.
</p>
</td></tr>
<tr><td><code id="LSE_GQR_+3A_d">d</code></td>
<td>

<p>Response vector for C, Cx=d, p rows and 1 column.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This algorithm provides the solution of the equality constrained least squares problem through Generalized QR factorization. This algorithm requires the same number of columns for matrices A and C.
</p>


<h3>Value</h3>

<p>Numerical vector for a LSE problem.
</p>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda
Statician
sergio05acm@gmail.com
</p>


<h3>References</h3>

<p>Anderson, E., Bai, Z., &amp; Dongarra, J. (1992). Generalized QR factorization and its applications. Linear Algebra and its Applications, 162, 243-271.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = matrix(c(1,2,3,4,5,6),3,2,byrow = TRUE)
C = matrix(c(1,1),1,2,byrow=TRUE)
b = matrix(c(7,1,3),3,1,byrow=TRUE)
d = matrix(c(1),1,1,byrow=TRUE)

LSE_GQR(A,C,b,d) #You can verify that x+y=1 satisfies the constraint.
</code></pre>

<hr>
<h2 id='Nullspace'>
Nullspace method for LSE problem.
</h2><span id='topic+Nullspace'></span>

<h3>Description</h3>

<p>Null Space method allows to give an analytic solution for equality constrained least squares problem (LSE).
Requires pracma library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Nullspace(A,C,b,d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Nullspace_+3A_a">A</code></td>
<td>

<p>Design matrix, m rows and n columns.
</p>
</td></tr>
<tr><td><code id="Nullspace_+3A_c">C</code></td>
<td>

<p>Constraint matrix, p rows and n columns.
</p>
</td></tr>
<tr><td><code id="Nullspace_+3A_b">b</code></td>
<td>

<p>Response vector for A, Ax=b, m rows and 1 column.
</p>
</td></tr>
<tr><td><code id="Nullspace_+3A_d">d</code></td>
<td>

<p>Response vector for C, Cx=d, p rows and 1 column.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Null Space method gives a numerical vector as the solution of a least squares problem (Ax=b), using an unconstrained problem equivalent to the LSE proposed, this method an be applied when impose some restrictions (additional information, extramuestral information or a priori information) that lead to another linear equality system (Cx=d). See significance constraint (x=0) or inclusion restriction (x+y=1), etc.
</p>


<h3>Value</h3>

<p>Numerical vector for a LSE problem.
</p>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda
Statician
sergio05acm@gmail.com
</p>


<h3>References</h3>

<p>Lawson, C. L., &amp; Hanson, R. J. (1974). Linear least squares with linear inequality constraints. Solving least squares problems, 158-173.
</p>
<p>Van Benthem, M. H., Keenan, M. R., &amp; Haaland, D. M. (2002). Application of equality constraints on variables during alternating least squares procedures. Journal of Chemometrics: A Journal of the Chemometrics Society, 16(12), 613-622.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = matrix(runif(50,-1,1),10,5)
C = matrix(runif(20,-1,1),4,5)
b = matrix(runif(10,-1,1),10,1)
d = matrix(runif(4,-1,1),4,1)

Nullspace(A,C,b,d)
</code></pre>

<hr>
<h2 id='Quaternion'>
Quaternion transformation
</h2><span id='topic+Quaternion'></span>

<h3>Description</h3>

<p>A quaternion q=a+bi+cj+dk can be transformed into a real value matrix M(4x4).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quaternion(a,b,c,d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Quaternion_+3A_a">a</code></td>
<td>

<p>Real value coefficient.
</p>
</td></tr>
<tr><td><code id="Quaternion_+3A_b">b</code></td>
<td>

<p>Coefficient of the imaginary i-axis.
</p>
</td></tr>
<tr><td><code id="Quaternion_+3A_c">c</code></td>
<td>

<p>Coefficient of the imaginary j-axis.
</p>
</td></tr>
<tr><td><code id="Quaternion_+3A_d">d</code></td>
<td>

<p>Coefficient of the imaginary k-axis.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Real value matrix to represent a quaternion.
</p>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda
Statician
sergio05acm@gmail.com
</p>


<h3>References</h3>

<p>Al-Zhour, Z. (2019). Some new linear representations of matrix quaternions with some applications. Journal of King Saud University-Science, 31(1), 42-47.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Quaternion(1,0,1,0)

rbind(cbind(Quaternion(-1,0,1,0),Quaternion(0,0,0,-1)),
      cbind(Quaternion(0,1,0,0),Quaternion(1,0,1,0))
      )
</code></pre>

<hr>
<h2 id='RQ'>
RQ Factorization of a matrix
</h2><span id='topic+RQ'></span>

<h3>Description</h3>

<p>RQ factorization allows to develop an orthogonal transformation in a matrix through Householder reflections.
Requires pracma package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RQ(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RQ_+3A_y">y</code></td>
<td>

<p>Numeric matrix or vector.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RQ factorization make a orthogonal transformation at the rows of the matrix, beginning in the last one, and finishing with the first one row.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Q</code></td>
<td>
<p>Orthogonal matrix for x</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Triangular matrix for x</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sergio Andrés Cabrera Miranda
Statician
sergio05acm@gmail.com
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = matrix(runif(12,0,5),4,3,byrow=TRUE)
RQ(A)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
