<!DOCTYPE html><html lang="en"><head><title>Help for package fdarep</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fdarep}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fdarep'><p>fdarep: Two-Dimensional FPCA, Marginal FPCA, and Product FPCA for Repeated Functional Data</p></a></li>
<li><a href='#Dense2dFPCA'><p>Two-Dimensional Functional Principal Component Analysis for dense repeated functional data.</p></a></li>
<li><a href='#DenseMarginalFPCA'><p>Marginal Functional Principal Component Analysis for dense repeated functional data.</p></a></li>
<li><a href='#DenseProductFPCA'><p>Product Functional Principal Component Analysis for dense repeated functional data.</p></a></li>
<li><a href='#SparseMarginalFPCA'><p>Marginal Functional Principal Component Analysis for repeated sparse functional data.</p></a></li>
<li><a href='#SparseProductFPCA'><p>Product Functional Principal Component Analysis for sparse repeated functional data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Two-Dimensional FPCA, Marginal FPCA, and Product FPCA for
Repeated Functional Data</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/functionaldata/tFDArep">https://github.com/functionaldata/tFDArep</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/functionaldata/tFDArep/issues">https://github.com/functionaldata/tFDArep/issues</a></td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Poorbita Kundu &lt;pkundu@ucdavis.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides an implementation of two-dimensional functional principal component analysis (FPCA), Marginal FPCA, and Product FPCA for repeated functional data. Marginal and Product FPCA implementations are done for both dense and sparsely observed functional data. 
    References: Chen, K., Delicado, P., &amp; Müller, H. G. (2017) &lt;<a href="https://doi.org/10.1111%2Frssb.12160">doi:10.1111/rssb.12160</a>&gt;.
                Chen, K., &amp; Müller, H. G. (2012) &lt;<a href="https://doi.org/10.1080%2F01621459.2012.734196">doi:10.1080/01621459.2012.734196</a>&gt;.
                Hall, P.,  Müller, H.G. and Wang, J.L. (2006) &lt;<a href="https://doi.org/10.1214%2F009053606000000272">doi:10.1214/009053606000000272</a>&gt;.
                Yao, F., Müller, H. G., &amp; Wang, J. L. (2005) &lt;<a href="https://doi.org/10.1198%2F016214504000001745">doi:10.1198/016214504000001745</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.5), fdapace, Hmisc, stats, MASS, Matrix, pracma,
numDeriv</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-06 00:01:43 UTC; poorbita</td>
</tr>
<tr>
<td>Author:</td>
<td>Poorbita Kundu [aut, cre],
  Changbo Zhu [aut],
  Kehui Chen [aut],
  Pedro Delicado [aut],
  Su I Iao [aut],
  Hang Zhou [aut],
  Han Chen [aut],
  Muqing Cui [aut],
  Hans-Georg Müller [cph, ths, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-06 00:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fdarep'>fdarep: Two-Dimensional FPCA, Marginal FPCA, and Product FPCA for Repeated Functional Data</h2><span id='topic+fdarep-package'></span><span id='topic+fdarep'></span>

<h3>Description</h3>

<p>fdarep for Functional Data Analysis
</p>


<h3>Details</h3>

<p>fdarep is a versatile package that provides implementation of various methods
of Functional Data Analysis (FDA) for repeated functional data.
</p>
<p>References: Chen, K., Delicado, P., &amp; Müller, H. G. (2017). Modelling function-valued stochastic processes, with applications to fertility dynamics.
Journal of the Royal Statistical Society Series B: Statistical Methodology, 79(1), 177-196.
Chen, K., &amp; Müller, H. G. (2012). Modeling repeated functional observations.
Journal of the American Statistical Association, 107(500), 1599-1609.
Hall, P., Müller, H. G., &amp; Wang, J. L. (2006). Properties of principal component methods for functional and longitudinal data analysis.
Yao, F., Müller, H. G., &amp; Wang, J. L. (2005). Functional data analysis for sparse longitudinal data.
Journal of the American statistical association, 100(470), 577-590.
</p>
<p>fdarep is a comprehensive package that directly implements fitting of the following models for repeated functional data:
&ndash; Two-dimensional FPCA for dense repeated functional data
&ndash; Marginal FPCA for dense repeated functional data
&ndash; Product FPCA for dense repeated functional data
&ndash; Marginal FPCA for sparse repeated functional data
&ndash; Product FPCA for sparse repeated functional data
</p>
<p>Maintainer:  Poorbita Kundu <a href="mailto:pkundu@ucdavis.edu">pkundu@ucdavis.edu</a>
</p>


<h3>Author(s)</h3>

<p>Poorbita Kundu <a href="mailto:pkundu@ucdavis.edu">pkundu@ucdavis.edu</a>
Changbo Zhu
Kehui Chen
Pedro Delicado
Su I Iao
Hang Zhou
Han Chen
Muqing Cui
</p>
<p>Hans-Georg Müller <a href="mailto:hgmueller@ucdavis.edu">hgmueller@ucdavis.edu</a>
Jane-Ling Wang <a href="mailto:janelwang@ucdavis.edu">janelwang@ucdavis.edu</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/functionaldata/tFDArep">https://github.com/functionaldata/tFDArep</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/functionaldata/tFDArep/issues">https://github.com/functionaldata/tFDArep/issues</a>
</p>
</li></ul>


<hr>
<h2 id='Dense2dFPCA'>Two-Dimensional Functional Principal Component Analysis for dense repeated functional data.</h2><span id='topic+Dense2dFPCA'></span>

<h3>Description</h3>

<p>Note: The code works for dense functional data observed on a regular grid, missing values are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dense2dFPCA(
  X.age.year,
  n,
  num.years,
  num.ages,
  fpca.op = list(),
  pc.num = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Dense2dFPCA_+3A_x.age.year">X.age.year</code></td>
<td>
<p>An n by (num.years x num.ages) input data matrix, such that the ith row of the matrix gives the observed values for the ith individual. The values in each row are sorted first by years (dimension 1) and then by ages (dimension 2) within each year.</p>
</td></tr>
<tr><td><code id="Dense2dFPCA_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="Dense2dFPCA_+3A_num.years">num.years</code></td>
<td>
<p>Dimension 1</p>
</td></tr>
<tr><td><code id="Dense2dFPCA_+3A_num.ages">num.ages</code></td>
<td>
<p>Dimension 2</p>
</td></tr>
<tr><td><code id="Dense2dFPCA_+3A_fpca.op">fpca.op</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for the two-dimesnional FPCA; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="Dense2dFPCA_+3A_pc.num">pc.num</code></td>
<td>
<p>A scalar denoting the maximum number of components to consider for the two-dimensional FPCA; default: chosen by FVE if NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The code works for dense functional data (with missing values), with density in both the direction of (age) dimension 2 and (year) dimension 1.
</p>


<h3>Value</h3>

<p>A list containing the following fields:
</p>
<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>An num.ages by num.years matrix containing the bivariate mean function estimate.</p>
</td></tr>
<tr><td><code>pc.num</code></td>
<td>
<p>A scalar denoting the selected number of components for the two-dimensional FPCA.</p>
</td></tr>
<tr><td><code>res.2D.FPCA</code></td>
<td>
<p>A list containing the FPCA output for the fitted two-dimensional FPCA.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>An n by pc.num matrix of the estimated scores, such that the ith row of the matrix comprises estimated scores for the ith individual.</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>An (num.years x num.ages) by pc.num matrix of the estimated product eigen functions. The estimated eigenfunctions in the otput eig are in the form of a vector rather than a matrix. For example, the first column in eig gives the first estimated eigenfunction such that <code class="reqn">gamma(s,t) -&gt; eig[ ( (s-1)*num.ages + t ), 1]</code> where LHS is the bivariate function in the usual form and RHS gives the corresponding element in the output vector. The rows are sorted first by years (dimension 1) and then by ages (dimension 2) within each year.</p>
</td></tr>
<tr><td><code>FVE</code></td>
<td>
<p>A vector of length pc.num, indicating the fraction of total variance explained by each product function, with corresponding 'FVEthreshold'.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li> <p><cite>Chen, K., Delicado, P., &amp; Müller, H. G. (2017). Modelling function-valued stochastic processes, with applications to fertility dynamics. Journal of the Royal Statistical Society Series B: Statistical Methodology, 79(1), 177-196.</cite>
</p>
</li>
<li> <p><cite>Chen, K., &amp; Müller, H. G. (2012). Modeling repeated functional observations. Journal of the American Statistical Association, 107(500), 1599-1609.</cite>
</p>
</li>
<li> <p><cite>Hall, P.,  Müller, H.G. and Wang, J.L. (2006). Properties of principal component methods for functional and longitudinal data analysis. Annals of Statistics, 34(3), 1493-1517.</cite>
</p>
</li>
<li> <p><cite>Yao, F., Müller, H. G., &amp; Wang, J. L. (2005). Functional data analysis for sparse longitudinal data. Journal of the American statistical association, 100(470), 577-590.</cite>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 100 ### sample size
N &lt;- 100
num.ages &lt;- 20 ### dimension 2
num.years &lt;- 15 ### dimension 1
dense_grid &lt;- seq(0,1,length=N)
Lt &lt;- list()
Ly &lt;- list()
for (i in 1:n) {
  Lt[[i]] &lt;- dense_grid ### dense time grid
  y_temp &lt;- matrix(0,num.ages,num.years)
  for (s in 1:num.ages) {
    for (t in 1:num.years) {
      y_temp[s,t] &lt;- y_temp[s,t]+cos(Lt[[i]][t])+rnorm(1,0,0.5)
    }
  }
  Ly[[i]] &lt;- y_temp ### dense functional data
}
X.age.year &lt;- matrix(0,n,num.years*num.ages)
for (i in 1:n) {
  X.age.year[i,] &lt;- as.vector(Ly[[i]]) ### data matrix
}
res &lt;- Dense2dFPCA(X.age.year, n , 15, 20, fpca.op=NULL,pc.num=2)
# Basic output
res$mu
res$pc.num
res$res.2D.FPCA
res$eig
res$FVE
res$pc.num
cumsum(res$FVE)


</code></pre>

<hr>
<h2 id='DenseMarginalFPCA'>Marginal Functional Principal Component Analysis for dense repeated functional data.</h2><span id='topic+DenseMarginalFPCA'></span>

<h3>Description</h3>

<p>Note: The code works for dense functional data observed on a regular grid, missing values are allowed, written by Kehui Chen 10/09/2015, based on the original code by Pedro Delicado.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DenseMarginalFPCA(
  X.age.year,
  n,
  num.years,
  num.ages,
  fpca.op1 = list(),
  fpca.op2 = list(),
  pc.j = NULL,
  pc.k = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DenseMarginalFPCA_+3A_x.age.year">X.age.year</code></td>
<td>
<p>An n by (num.years*num.ages) input data matrix, such that the ith row of the matrix gives the observed values for the ith individual. The values in each row are sorted first by years (dimension 1) and then by ages (dimension 2) within each year.</p>
</td></tr>
<tr><td><code id="DenseMarginalFPCA_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="DenseMarginalFPCA_+3A_num.years">num.years</code></td>
<td>
<p>Dimension 1</p>
</td></tr>
<tr><td><code id="DenseMarginalFPCA_+3A_num.ages">num.ages</code></td>
<td>
<p>Dimension 2</p>
</td></tr>
<tr><td><code id="DenseMarginalFPCA_+3A_fpca.op1">fpca.op1</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for FPCA in direction of (age) dimension 2; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="DenseMarginalFPCA_+3A_fpca.op2">fpca.op2</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for FPCA in direction of (year) dimension 1; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="DenseMarginalFPCA_+3A_pc.j">pc.j</code></td>
<td>
<p>A scalar denoting the maximum number of components to consider for marginal FPCA in direction of (age) dimension 2; default: chosen by FVE if NULL</p>
</td></tr>
<tr><td><code id="DenseMarginalFPCA_+3A_pc.k">pc.k</code></td>
<td>
<p>A vector of length pc.j denoting the maximum number of components to consider for nested FPCA in direction of (year) dimension 1; default: chosen by FVE if NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The code works for dense functional data (with missing values), with density in both the direction of (age) dimension 2 and (year) dimension 1.
</p>


<h3>Value</h3>

<p>A list containing the following fields:
</p>
<table role = "presentation">
<tr><td><code>Xest</code></td>
<td>
<p>An n by (num.years x num.ages) estimated matrix, based on the fitted Marginal FPCA model. The ith row of the matrix gives the observed values for the ith individual. The values in each row are sorted first by years (dimension 1) and then by ages (dimension 2) within each year.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>An num.ages by num.years matrix containing the bivariate mean function estimate.</p>
</td></tr>
<tr><td><code>pc.j</code></td>
<td>
<p>A scalar denoting the selected number of components for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>pc.k</code></td>
<td>
<p>A vector of length pc.j, denoting the selected number of components for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>An n by sum(pc.k) matrix of the estimated scores, such that the ith row of the matrix comprises estimated scores <code class="reqn">chi_{1,1}</code>, <code class="reqn">chi_{1,2}</code>, ..., <code class="reqn">chi_{1,pc.k[1]}</code>, <code class="reqn">chi_{2,1}</code>, <code class="reqn">chi_{2,2}</code>, ..., <code class="reqn">chi_{2,pc.k[2]}</code>, ..., <code class="reqn">chi_{pc.j,1}</code>, <code class="reqn">chi_{pc.j,2}</code>, ..., <code class="reqn">chi_{pc.j,pc.k[j]}</code> for the ith individual.</p>
</td></tr>
<tr><td><code>res.psi</code></td>
<td>
<p>A list containing the FPCA output for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>res.phi</code></td>
<td>
<p>A list containing the FPCA output for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>An (num.years x num.ages) by sum(pc.k) matrix of the estimated product eigen functions. The rows are sorted first by years (dimension 1) and then by ages (dimension 2) within each year. The columns are sorted as in the scores.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>An num.ages by pc.j matrix containing the estimated eigenfunctions for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>An num.years by sum(pc.k) matrix, containing the estimated eigenfunctions for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>FVE</code></td>
<td>
<p>A vector of length sum(pc.k), indicating the fraction of total variance explained by each product function, with corresponding 'FVEthreshold'.</p>
</td></tr>
<tr><td><code>VarOrdered</code></td>
<td>
<p>Variance explained by each term. The terms are ordered by <code class="reqn">var(chi_{jk})</code>. One can select the best model by truncating at a desired level of FVE, and use names(VarOrdered) to see the corresponding model terms.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li> <p><cite>Chen, K., Delicado, P., &amp; Müller, H. G. (2017). Modelling function-valued stochastic processes, with applications to fertility dynamics. Journal of the Royal Statistical Society Series B: Statistical Methodology, 79(1), 177-196.</cite>
</p>
</li>
<li> <p><cite>Chen, K., &amp; Müller, H. G. (2012). Modeling repeated functional observations. Journal of the American Statistical Association, 107(500), 1599-1609.</cite>
</p>
</li>
<li> <p><cite>Hall, P.,  Müller, H.G. and Wang, J.L. (2006). Properties of principal component methods for functional and longitudinal data analysis. Annals of Statistics, 34(3), 1493-1517.</cite>
</p>
</li>
<li> <p><cite>Yao, F., Müller, H. G., &amp; Wang, J. L. (2005). Functional data analysis for sparse longitudinal data. Journal of the American statistical association, 100(470), 577-590.</cite>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 100 ### sample size
N &lt;- 100
num.ages &lt;- 20 ### dimension 2
num.years &lt;- 15 ### dimension 1
dense_grid &lt;- seq(0,1,length=N)
Lt &lt;- list()
Ly &lt;- list()
 Lt &lt;- lapply(1:n, function(i) dense_grid)
 Ly &lt;- lapply(Lt, function(grid) {
 y_temp &lt;- matrix(0, num.ages, num.years)
  lapply(1:num.ages, function(s) {
    lapply(1:num.years, function(t) {
      y_temp[s, t] &lt;&lt;- y_temp[s, t] + cos(grid[t]) + rnorm(1, 0, 0.5)
    })
  })
  y_temp
 })
X.age.year &lt;- matrix(0,n,num.years*num.ages)
lapply(1:n, function(i) {
  X.age.year[i,] &lt;&lt;- as.vector(Ly[[i]])
})
res &lt;- DenseMarginalFPCA(X.age.year, n, 15, 20,
fpca.op1=NULL, fpca.op2=NULL, pc.j = NULL, pc.k = NULL)
# Basic output
res$Xest
res$mu
res$pc.j
res$pc.k
res$scores
res$res.psi
res$psi
res$FVE
res$VarOrdered
#Additional scores
fpca_psi &lt;- res$res.psi
xi_i_j &lt;- fpca_psi$xiEst
str(fpca_psi$xiEst)
#xi scores for 1st individual
xi_i_j[1:num.years,]
#xi scores for 2nd individual
xi_i_j[(num.years+1):(2*num.years),]


</code></pre>

<hr>
<h2 id='DenseProductFPCA'>Product Functional Principal Component Analysis for dense repeated functional data.</h2><span id='topic+DenseProductFPCA'></span>

<h3>Description</h3>

<p>Note: The code works for dense functional data observed on a regular grid, missing values are allowed, written by Kehui Chen 10/09/2015, based on the original code by Pedro Delicado.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DenseProductFPCA(
  X.age.year,
  n,
  num.years,
  num.ages,
  fpca.op1 = list(),
  fpca.op2 = list(),
  pc.j = NULL,
  pc.k = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DenseProductFPCA_+3A_x.age.year">X.age.year</code></td>
<td>
<p>An n by (num.years x num.ages) input data matrix, such that the ith row of the matrix gives the observed values for the ith individual. The values in each row are sorted first by years (dimension 1) and then by ages (dimension 2) within each year.</p>
</td></tr>
<tr><td><code id="DenseProductFPCA_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="DenseProductFPCA_+3A_num.years">num.years</code></td>
<td>
<p>Dimension 1</p>
</td></tr>
<tr><td><code id="DenseProductFPCA_+3A_num.ages">num.ages</code></td>
<td>
<p>Dimension 2</p>
</td></tr>
<tr><td><code id="DenseProductFPCA_+3A_fpca.op1">fpca.op1</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for FPCA in direction of (age) dimension 2; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="DenseProductFPCA_+3A_fpca.op2">fpca.op2</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for FPCA in direction of (year) dimension 1; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="DenseProductFPCA_+3A_pc.j">pc.j</code></td>
<td>
<p>A scalar denoting the maximum number of components to consider for FPCA in direction of (age) dimension 2; default: chosen by FVE if NULL.</p>
</td></tr>
<tr><td><code id="DenseProductFPCA_+3A_pc.k">pc.k</code></td>
<td>
<p>A scalar denoting the maximum number of components to consider for FPCA in direction of (year) dimension 1; default: chosen by FVE if NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The code works for dense functional data (with missing values), with density in both the direction of (age) dimension 2 and (year) dimension 1.
</p>


<h3>Value</h3>

<p>A list containing the following fields:
</p>
<table role = "presentation">
<tr><td><code>Xest</code></td>
<td>
<p>An n by (num.years x num.ages) estimated matrix, based on the fitted Product FPCA model. The ith row of the matrix gives the observed values for the ith individual. The values in each row are sorted first by years (dimension 1) and then by ages (dimension 2) within each year.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>An num.ages by num.years matrix containing the bivariate mean function estimate.</p>
</td></tr>
<tr><td><code>pc.j</code></td>
<td>
<p>A scalar denoting the selected number of components for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>pc.k</code></td>
<td>
<p>A scalar denoting the selected number of components for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>An n by (pc.k x pc.j) matrix of the estimated scores, such that the ith row of the matrix comprises estimated scores <code class="reqn">chi_{1,1}</code>, <code class="reqn">chi_{1,2}</code>,...<code class="reqn">chi_{1,pc.k}</code>, <code class="reqn">chi_{2,1}</code>, <code class="reqn">chi_{2,2}</code>, ..., <code class="reqn">chi_{2,pc.k}</code>, ..., <code class="reqn">chi_{pc.j,1}</code>, <code class="reqn">chi_{pc.j,2}</code>, ..., <code class="reqn">chi_{pc.j,pc.k}</code> for the ith individual.</p>
</td></tr>
<tr><td><code>res.psi</code></td>
<td>
<p>A list containing the FPCA output for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>res.phi</code></td>
<td>
<p>A list containing the FPCA output for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>An (num.years x num.ages) by (pc.k x pc.j) matrix of the estimated product eigen functions. The rows are sorted first by years (dimension 1) and then by ages (dimension 2) within each year. The columns are sorted as in the scores.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>An num.ages by pc.j matrix containing the estimated eigenfunctions from FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>An num.years by pc.k matrix containing the estimated eigenfunctions from FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>FVE</code></td>
<td>
<p>A vector of length (pc.k x pc.j), indicating the fraction of total variance explained by each product function, with corresponding 'FVEthreshold'.</p>
</td></tr>
<tr><td><code>VarOrdered</code></td>
<td>
<p>Variance explained by each term. The terms are ordered by <code class="reqn">var(chi_{jk})</code>. One can select the best model by truncating at a desired level of FVE, and use names(VarOrdered) to see the corresponding model terms.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li> <p><cite>Chen, K., Delicado, P., &amp; Müller, H. G. (2017). Modelling function-valued stochastic processes, with applications to fertility dynamics. Journal of the Royal Statistical Society Series B: Statistical Methodology, 79(1), 177-196.</cite>
</p>
</li>
<li> <p><cite>Chen, K., &amp; Müller, H. G. (2012). Modeling repeated functional observations. Journal of the American Statistical Association, 107(500), 1599-1609.</cite>
</p>
</li>
<li> <p><cite>Hall, P.,  Müller, H.G. and Wang, J.L. (2006). Properties of principal component methods for functional and longitudinal data analysis. Annals of Statistics, 34(3), 1493-1517.</cite>
</p>
</li>
<li> <p><cite>Yao, F., Müller, H. G., &amp; Wang, J. L. (2005). Functional data analysis for sparse longitudinal data. Journal of the American statistical association, 100(470), 577-590.</cite>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 100 ### sample size
N &lt;- 100
num.ages &lt;- 20 ### dimension 2
num.years &lt;- 15 ### dimension 1
dense_grid &lt;- seq(0,1,length=N)
Lt &lt;- list()
Ly &lt;- list()
 Lt &lt;- lapply(1:n, function(i) dense_grid)
 Ly &lt;- lapply(Lt, function(grid) {
 y_temp &lt;- matrix(0, num.ages, num.years)
  lapply(1:num.ages, function(s) {
    lapply(1:num.years, function(t) {
      y_temp[s, t] &lt;&lt;- y_temp[s, t] + cos(grid[t]) + rnorm(1, 0, 0.5)
    })
  })
  y_temp
 })
X.age.year &lt;- matrix(0,n,num.years*num.ages)
lapply(1:n, function(i) {
  X.age.year[i,] &lt;&lt;- as.vector(Ly[[i]])
})
res&lt;-DenseProductFPCA(X.age.year, n, 15, 20, fpca.op1=NULL, fpca.op2=NULL, pc.j = NULL, pc.k = NULL)
# Basic output
res$Xest
res$mu
res$pc.j
res$pc.k
res$scores
res$res.psi
res$psi
res$FVE
res$VarOrdered


</code></pre>

<hr>
<h2 id='SparseMarginalFPCA'>Marginal Functional Principal Component Analysis for repeated sparse functional data.</h2><span id='topic+SparseMarginalFPCA'></span>

<h3>Description</h3>

<p>Note: The code works for sparse functional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SparseMarginalFPCA(
  sSup,
  Lt,
  Ly,
  fpca.op1 = list(),
  fpca.op2 = list(),
  pc.j = NULL,
  pc.k = NULL,
  bw_mu_min = NULL,
  bw_mu_max = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SparseMarginalFPCA_+3A_ssup">sSup</code></td>
<td>
<p>A vector of length num.ages representing the common grid for every individual in the direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code id="SparseMarginalFPCA_+3A_lt">Lt</code></td>
<td>
<p>A list of n vectors containing the observation time points for every individual, such that the ith element of the list comprises the num.years.i points in the direction of (year) dimension 1 at which the functional-valued stochastic process is observed for the ith individual.</p>
</td></tr>
<tr><td><code id="SparseMarginalFPCA_+3A_ly">Ly</code></td>
<td>
<p>A list of n matrices containing the observed values for every individual, such that the ith element is an num.ages by num.years.i matrix of observed values for the ith individual.</p>
</td></tr>
<tr><td><code id="SparseMarginalFPCA_+3A_fpca.op1">fpca.op1</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for FPCA in direction of (age) dimension 2; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="SparseMarginalFPCA_+3A_fpca.op2">fpca.op2</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for FPCA in direction of (year) dimension 1; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="SparseMarginalFPCA_+3A_pc.j">pc.j</code></td>
<td>
<p>A scalar denoting the maximum number of components to consider for FPCA in direction of (age) dimension 2; default: chosen by FVE if NULL.</p>
</td></tr>
<tr><td><code id="SparseMarginalFPCA_+3A_pc.k">pc.k</code></td>
<td>
<p>A vector of length pc.j denoting the maximum number of components to consider for nested FPCA in direction of (year) dimension 1; default: chosen by FVE if NULL.</p>
</td></tr>
<tr><td><code id="SparseMarginalFPCA_+3A_bw_mu_min">bw_mu_min</code></td>
<td>
<p>The minimum bandwidth value considered for bandwidth selection in mean function estimation, such that the final bandwidth chosen by 5-fold cross validation is above this minimum value; default:NULL, bandwidth chosen by 5-fold cross validation over the default range.</p>
</td></tr>
<tr><td><code id="SparseMarginalFPCA_+3A_bw_mu_max">bw_mu_max</code></td>
<td>
<p>The maximum bandwidth value considered for bandwidth selection in mean function estimation, such that the final bandwidth chosen by 5-fold cross validation is below this value; default:NULL, bandwidth chosen by 5-fold cross validation over the default range.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This code works for sparse functional data, with the notion of sparsity defined as follows. Sparsity in the year direction (dimension 1) means that the years at which the data are observed for a country (or individual unit) are sparsely distributed. However for the ith county (or individual unit), if the data are available for a particular year (dimension 1), then it is available for all the ages (dimension 2) in sSup corresponding to that specific year. Thus along (age) dimension 2, data type is dense. The 'usergrid' control option in FPCA indicates whether to use observation grid for fitting, if false FPCA will use equidistant grid. logical - default:FALSE. Along (age) dimension 2, FPCA is done for only for sSup as observation grid. Depending on the choice of usergrid for 'fpca.op2', FPCA in (year) dimension 1 is either fitted on the observed (pooled) grid or on the internal regular grid of default length 51.
</p>


<h3>Value</h3>

<p>A list containing the following fields:
</p>
<table role = "presentation">
<tr><td><code>age.grid</code></td>
<td>
<p>A vector of length num.ages, representing the grid used for fitting FPCA in the direction of (age) dimension 2, same as sSup.</p>
</td></tr>
<tr><td><code>year.grid</code></td>
<td>
<p>A vector of length nWorkGrid, representing the grid used for fitting FPCA in the direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>An num.ages by nWorkGrid matrix containing bivariate mean function estimate.</p>
</td></tr>
<tr><td><code>bwMu</code></td>
<td>
<p>The selected bandwidth for mean function estimation.</p>
</td></tr>
<tr><td><code>pc.j</code></td>
<td>
<p>A scalar denoting the selected number of components for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>pc.k</code></td>
<td>
<p>A vector of length pc.j, denoting the selected number of components for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>res.psi</code></td>
<td>
<p>A list containing the FPCA output for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>res.phi</code></td>
<td>
<p>A list containing the FPCA output for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>A list of pc.j matrices containing the estimated scores, such that the jth element of the list is an n by pc.k[j] matrix with its ith row comprising the estimated scores <code class="reqn">chi_{j,1}</code>,..., <code class="reqn">chi_{j,pc.k[j]}</code> for the ith individual.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>An num.ages by pc.j matrix containing the estimated eigenfunctions from FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>A list of pc.j matrices containing the estimated eigen functions from FPCA in direction of (year) dimension 1, such that the jth element of the list is an nWorkGrid by pc.k[j] matrix.</p>
</td></tr>
<tr><td><code>VarOrdered</code></td>
<td>
<p>A list of pc.j vectors, containing the variance explained by each term. The terms are ordered by <code class="reqn">var(chi_{jk})</code>. One can select the best model by truncating at a desired level of FVE, and use names(VarOrdered) to see the corresponding model terms.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li> <p><cite>Chen, K., Delicado, P., &amp; Müller, H. G. (2017). Modelling function-valued stochastic processes, with applications to fertility dynamics. Journal of the Royal Statistical Society Series B: Statistical Methodology, 79(1), 177-196.</cite>
</p>
</li>
<li> <p><cite>Chen, K., &amp; Müller, H. G. (2012). Modeling repeated functional observations. Journal of the American Statistical Association, 107(500), 1599-1609.</cite>
</p>
</li>
<li> <p><cite>Hall, P.,  Müller, H.G. and Wang, J.L. (2006). Properties of principal component methods for functional and longitudinal data analysis. Annals of Statistics, 34(3), 1493-1517.</cite>
</p>
</li>
<li> <p><cite>Yao, F., Müller, H. G., &amp; Wang, J. L. (2005). Functional data analysis for sparse longitudinal data. Journal of the American statistical association, 100(470), 577-590.</cite>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
Ly &lt;- lapply(1:20, function(i){matrix(rnorm(13*(i)), 13, i)})
Lt &lt;- lapply(1:20, function(i){1:(i)})
sSup &lt;- c(1:13)
pc.j &lt;- 2
pc.k &lt;- c(2,3)
fpca.op1 &lt;- NULL
fpca.op2 &lt;- NULL
bw_mu_max &lt;- NULL
bw_mu_min &lt;- NULL
res &lt;- SparseMarginalFPCA(sSup, Lt, Ly, fpca.op1, fpca.op2, pc.j, pc.k, bw_mu_min, bw_mu_max)


</code></pre>

<hr>
<h2 id='SparseProductFPCA'>Product Functional Principal Component Analysis for sparse repeated functional data.</h2><span id='topic+SparseProductFPCA'></span>

<h3>Description</h3>

<p>Note: The code works for sparse functional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SparseProductFPCA(
  sSup,
  Lt,
  Ly,
  fpca.op1 = list(),
  fpca.op2 = list(),
  pc.j = NULL,
  pc.k = NULL,
  bw_mu_min = NULL,
  bw_mu_max = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SparseProductFPCA_+3A_ssup">sSup</code></td>
<td>
<p>A vector of length num.ages representing the common grid for every individual in the direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code id="SparseProductFPCA_+3A_lt">Lt</code></td>
<td>
<p>A list of n vectors containing the observation time points for every individual, such that the ith element of the list gives the num.years.i points in the direction of (year) dimension 1 at which the functional-valued stochastic process is observed for the ith individual.</p>
</td></tr>
<tr><td><code id="SparseProductFPCA_+3A_ly">Ly</code></td>
<td>
<p>A list of n matrices containing the observed values for every individual, such that the ith element is an num.ages by num.years.i matrix of observed values for the i-th individual.</p>
</td></tr>
<tr><td><code id="SparseProductFPCA_+3A_fpca.op1">fpca.op1</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code> for FPCA in direction of (age) dimension 2; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="SparseProductFPCA_+3A_fpca.op2">fpca.op2</code></td>
<td>
<p>A list of options control parameters specified by <code>list(name=value)</code>for FPCA in direction of (year) dimension 1; check fdapace::FPCA for available control options and default settings.</p>
</td></tr>
<tr><td><code id="SparseProductFPCA_+3A_pc.j">pc.j</code></td>
<td>
<p>A scalar denoting the maximum number of components to consider for FPCA in direction of (age) dimension 2; default: chosen by FVE if NULL</p>
</td></tr>
<tr><td><code id="SparseProductFPCA_+3A_pc.k">pc.k</code></td>
<td>
<p>A scalar denoting the maximum number of components to consider for FPCA in direction of (year) dimension 1; default: chosen by FVE if NULL.</p>
</td></tr>
<tr><td><code id="SparseProductFPCA_+3A_bw_mu_min">bw_mu_min</code></td>
<td>
<p>The minimum bandwidth value considered for bandwidth selection in mean function estimation, such that the final bandwidth chosen by 5-fold cross validation is above this minimum value; default:NULL, bandwidth chosen by 5-fold cross validation over the default range.</p>
</td></tr>
<tr><td><code id="SparseProductFPCA_+3A_bw_mu_max">bw_mu_max</code></td>
<td>
<p>The maximum bandwidth value considered for bandwidth selection in mean function estimation, such that the final bandwidth chosen by 5-fold cross validation is below this value; default:NULL, bandwidth chosen by 5-fold cross validation over the default range.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This code works for sparse functional data, with the notion of sparsity defined as follows. Sparsity in the year direction (dimension 1) means that the years at which the data are observed for a country (or individual unit) are sparsely distributed. However for the ith county (or individual unit), if the data are available for a particular year (dimension 1), then it is available for all the ages (dimension 2) in sSup corresponding to that specific year. Thus along (age) dimension 2, data type is dense. The 'usergrid' control option in FPCA indicates whether to use observation grid for fitting, if false FPCA will use equidistant grid. logical - default:FALSE. Along (age) dimension 2, FPCA is done for only for sSup as observation grid. Depending on the choice of usergrid for 'fpca.op2', FPCA in (year) dimension 1 is either fitted on the observed (pooled) grid or on the internal regular grid of default length 51.
</p>


<h3>Value</h3>

<p>A list containing the following fields:
</p>
<table role = "presentation">
<tr><td><code>age.grid</code></td>
<td>
<p>A vector of length num.ages, representing the grid used for fitting FPCA in the direction of (age) dimension 2, same as sSup.</p>
</td></tr>
<tr><td><code>year.grid</code></td>
<td>
<p>A vector of length nWorkGrid, representing the grid used for fitting FPCA in the direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>An num.ages by nWorkGrid matrix containing the bivariate mean function estimate.</p>
</td></tr>
<tr><td><code>bwMu</code></td>
<td>
<p>The selected bandwidth for mean function estimation.</p>
</td></tr>
<tr><td><code>pc.j</code></td>
<td>
<p>A scalar denoting the selected number of components for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>pc.k</code></td>
<td>
<p>A scalar denoting the selected number of components for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>res.psi</code></td>
<td>
<p>A list containing the FPCA output for FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>res.phi</code></td>
<td>
<p>A list containing the FPCA output for FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>A list of pc.j matrices containing the estimated scores, such that the jth element of the list is an n by pc.k matrix with its ith row comprising the estimated scores <code class="reqn">chi_{j,1}</code>,..., <code class="reqn">chi_{j,pc.k[j]}</code> for the ith individual.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>An num.ages by pc.j matrix containing the estimated eigenfunctions from FPCA in direction of (age) dimension 2.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>An nWorkGrid by pc.k matrix, containing the estimated eigenfunctions from FPCA in direction of (year) dimension 1.</p>
</td></tr>
<tr><td><code>VarOrdered</code></td>
<td>
<p>A list of pc.j vectors each of length pc.k, containing the variance explained by each term. The terms are ordered by <code class="reqn">var(chi_{jk})</code>. One can select the best model by truncating at a desired level of FVE, and use names(VarOrdered) to see the corresponding model terms.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li> <p><cite>Chen, K., Delicado, P., &amp; Müller, H. G. (2017). Modelling function-valued stochastic processes, with applications to fertility dynamics. Journal of the Royal Statistical Society Series B: Statistical Methodology, 79(1), 177-196.</cite>
</p>
</li>
<li> <p><cite>Chen, K., &amp; Müller, H. G. (2012). Modeling repeated functional observations. Journal of the American Statistical Association, 107(500), 1599-1609.</cite>
</p>
</li>
<li> <p><cite>Hall, P.,  Müller, H.G. and Wang, J.L. (2006). Properties of principal component methods for functional and longitudinal data analysis. Annals of Statistics, 34(3), 1493-1517.</cite>
</p>
</li>
<li> <p><cite>Yao, F., Müller, H. G., &amp; Wang, J. L. (2005). Functional data analysis for sparse longitudinal data. Journal of the American statistical association, 100(470), 577-590.</cite>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
Ly &lt;- lapply(1:20, function(i){matrix(rnorm(13*(i)), 13, i)})
Lt &lt;- lapply(1:20, function(i){1:(i)})
sSup &lt;- c(1:13)
pc.j &lt;- 2
pc.k &lt;- 3
fpca.op1 &lt;- NULL
fpca.op2 &lt;- NULL
bw_mu_max &lt;- 5.625000/2
bw_mu_min &lt;- NULL
res &lt;- SparseProductFPCA(sSup, Lt, Ly, fpca.op1, fpca.op2, pc.j, pc.k, bw_mu_min, bw_mu_max)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
