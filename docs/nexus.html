<!DOCTYPE html><html><head><title>Help for package nexus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nexus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aggregate'><p>Compute Summary Statistics of Data Subsets</p></a></li>
<li><a href='#arctic'><p>Arctic Lake</p></a></li>
<li><a href='#arithmetic'><p>Operations in the Simplex</p></a></li>
<li><a href='#as_amounts'><p>Coerce to Amounts</p></a></li>
<li><a href='#as_composition'><p>Coerce to a Closed Compositional Matrix</p></a></li>
<li><a href='#as_features'><p>Coerce to Features</p></a></li>
<li><a href='#as_graph'><p>Graph of Log-ratios</p></a></li>
<li><a href='#barplot'><p>Barplot of Compositional Data</p></a></li>
<li><a href='#chemistry'><p>Can Sora Chemical Data</p></a></li>
<li><a href='#closure'><p>Closure Operation</p></a></li>
<li><a href='#CompositionMatrix-class'><p>Compositional Matrix</p></a></li>
<li><a href='#covariance'><p>Covariance Matrix</p></a></li>
<li><a href='#dist'><p>Distances</p></a></li>
<li><a href='#groups'><p>Working With Groups</p></a></li>
<li><a href='#hist'><p>Histogram of Compositional Data</p></a></li>
<li><a href='#hongite'><p>Hongite Mineralogy</p></a></li>
<li><a href='#identifiers'><p>Unique Identifiers</p></a></li>
<li><a href='#LogicalMatrix-class'><p>Logical Matrix</p></a></li>
<li><a href='#LogRatio-class'><p>Log-Ratio Matrix</p></a></li>
<li><a href='#mahalanobis'><p>Mahalanobis Distance</p></a></li>
<li><a href='#margin'><p>Marginal Compositions</p></a></li>
<li><a href='#mean'><p>Compositional Mean</p></a></li>
<li><a href='#metric_var'><p>Metric Variance and Standard Deviation</p></a></li>
<li><a href='#missing'><p>Missing Values Policy</p></a></li>
<li><a href='#mix'><p>Mixed-Mode Analysis</p></a></li>
<li><a href='#nexus-package'><p>nexus: Sourcing Archaeological Materials by Chemical Composition</p></a></li>
<li><a href='#NumericMatrix-class'><p>Numeric Matrix</p></a></li>
<li><a href='#OutlierIndex-class'><p>Outliers</p></a></li>
<li><a href='#outliers'><p>Outlier Detection</p></a></li>
<li><a href='#pca_coda'><p>Principal Components Analysis</p></a></li>
<li><a href='#perturbation'><p>Perturbation Operation</p></a></li>
<li><a href='#petrography'><p>Can Sora Petrographic Data</p></a></li>
<li><a href='#plot'><p>Plot Compositional Data</p></a></li>
<li><a href='#plot_logratio'><p>Plot Log-Ratios</p></a></li>
<li><a href='#plot_outliers'><p>Plot Outliers</p></a></li>
<li><a href='#powering'><p>Powering Operation</p></a></li>
<li><a href='#quantile'><p>Sample Quantiles</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#replace_NA'><p>Missing Values Replacement</p></a></li>
<li><a href='#replace_zero'><p>Zero-Replacement</p></a></li>
<li><a href='#samples'><p>Working With Samples</p></a></li>
<li><a href='#scalar'><p>Scalar Product</p></a></li>
<li><a href='#scale'><p>Scaling and Centering of Compositional Data</p></a></li>
<li><a href='#slides'><p>Thin Sections</p></a></li>
<li><a href='#split'><p>Divide into Groups</p></a></li>
<li><a href='#subset'><p>Extract or Replace Parts of an Object</p></a></li>
<li><a href='#totals'><p>Row Sums</p></a></li>
<li><a href='#transform_alr'><p>Additive Log-Ratios (ALR)</p></a></li>
<li><a href='#transform_clr'><p>Centered Log-Ratios (CLR)</p></a></li>
<li><a href='#transform_ilr'><p>Isometric Log-Ratios (ILR)</p></a></li>
<li><a href='#transform_inverse'><p>Inverse Log-Ratio Transformation</p></a></li>
<li><a href='#transform_lr'><p>Pairwise Log-Ratios (LR)</p></a></li>
<li><a href='#transform_plr'><p>Pivot Log-Ratios (PLR)</p></a></li>
<li><a href='#variation'><p>Variation Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Sourcing Archaeological Materials by Chemical Composition</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicolas Frerebeau &lt;nicolas.frerebeau@u-bordeaux-montaigne.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Exploration and analysis of compositional data in the
    framework of Aitchison (1986, ISBN: 978-94-010-8324-9). This package
    provides tools for chemical fingerprinting and source tracking of
    ancient materials.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://packages.tesselle.org/nexus/">https://packages.tesselle.org/nexus/</a>,
<a href="https://github.com/tesselle/nexus">https://github.com/tesselle/nexus</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tesselle/nexus/issues">https://github.com/tesselle/nexus/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), dimensio (&ge; 0.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>arkhe (&ge; 1.6.0), graphics, grDevices, isopleuros (&ge; 1.2.0),
methods, MASS, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cluster, folio (&ge; 1.4.0), igraph, knitr, markdown, rsvg,
svglite, tinysnapshot, tinytest</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>Collate:</td>
<td>'AllClasses.R' 'AllGenerics.R' 'coerce.R' 'data.R' 'graph.R'
'mix.R' 'mutators.R' 'nexus-internal.R' 'nexus-package.R'
'outliers.R' 'pca.R' 'plot.R' 'reexport.R' 'replace.R' 'show.R'
'simplex.R' 'statistics.R' 'subset.R' 'summary.R' 'transform.R'
'validate.R' 'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-26 16:38:51 UTC; nicolas</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicolas Frerebeau <a href="https://orcid.org/0000-0001-5759-4944"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre] (Université Bordeaux Montaigne),
  Anne Philippe <a href="https://orcid.org/0000-0002-5331-5087"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut] (Université de Nantes),
  Brice Lebrun <a href="https://orcid.org/0000-0001-7503-8685"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb] (Logo designer),
  Arthur Leck <a href="https://orcid.org/0009-0004-8819-9970"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]
    (Université Bordeaux Montaigne),
  Université Bordeaux Montaigne [fnd],
  CNRS [fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-26 17:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aggregate'>Compute Summary Statistics of Data Subsets</h2><span id='topic+aggregate'></span><span id='topic+aggregate+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Splits the data into subsets, computes summary statistics for each, and
returns the result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
aggregate(x, by, FUN, ..., simplify = TRUE, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggregate_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="aggregate_+3A_by">by</code></td>
<td>
<p>A vector or a list of grouping elements, each as long as the
variables in <code>x</code>. The elements are coerced to factors before use.</p>
</td></tr>
<tr><td><code id="aggregate_+3A_fun">FUN</code></td>
<td>
<p>A <code><a href="base.html#topic+function">function</a></code> to compute the summary statistics.</p>
</td></tr>
<tr><td><code id="aggregate_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="aggregate_+3A_simplify">simplify</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the results be simplified to a
matrix if possible?</p>
</td></tr>
<tr><td><code id="aggregate_+3A_drop">drop</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar indicating whether to drop unused
combinations of grouping values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a data.frame
X &lt;- data.frame(
  samples = c("A", "A", "A", "B", "B", "B", "C", "C", "C"),
  groups = c("X", "X", "X", NA, NA, NA, "Y", "Y", "Y"),
  Ca = c(7.72, 7.32, 3.11, 7.19, 7.41, 5, 4.18, 1, 4.51),
  Fe = c(6.12, 5.88, 5.12, 6.18, 6.02, 7.14, 5.25, 5.28, 5.72),
  Na = c(0.97, 1.59, 1.25, 0.86, 0.76, 0.51, 0.75, 0.52, 0.56)
)

## Coerce to a compositional matrix
Y &lt;- as_composition(X)

## Compositional mean by sample
aggregate(Y, by = get_samples(Y), FUN = mean)

## Metric variance by group
aggregate(Y, by = get_groups(Y), FUN = metric_var)
</code></pre>

<hr>
<h2 id='arctic'>Arctic Lake</h2><span id='topic+arctic'></span>

<h3>Description</h3>

<p>Sand, silt, clay compositions of 39 sediment samples at different water
depths in an Arctic lake.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arctic
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 4 variables:
</p>

<dl>
<dt>sand</dt><dd><p>Sand content (percent).</p>
</dd>
<dt>silt</dt><dd><p>Silt content (percent).</p>
</dd>
<dt>clay</dt><dd><p>Clay content (percent).</p>
</dd>
<dt>depth</dt><dd><p>Water depth (m).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+chemistry">chemistry</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+petrography">petrography</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='arithmetic'>Operations in the Simplex</h2><span id='topic+arithmetic'></span><span id='topic++25perturbe+25'></span><span id='topic++60+25perturbe+25+60-method'></span><span id='topic++25power+25'></span><span id='topic++60+25power+25+60-method'></span><span id='topic++25perturbe+25+2CCompositionMatrix+2CCompositionMatrix-method'></span><span id='topic++60+25perturbe+25+60+2CCompositionMatrix+2CCompositionMatrix-method'></span><span id='topic++25power+25+2CCompositionMatrix+2Cnumeric-method'></span><span id='topic++60+25power+25+60+2CCompositionMatrix+2Cnumeric-method'></span><span id='topic++25power+25+2Cnumeric+2CCompositionMatrix-method'></span><span id='topic++60+25power+25+60+2Cnumeric+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Operators performing operations in the simplex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %perturbe% y

x %power% y

## S4 method for signature 'CompositionMatrix,CompositionMatrix'
x %perturbe% y

## S4 method for signature 'CompositionMatrix,numeric'
x %power% y

## S4 method for signature 'numeric,CompositionMatrix'
x %power% y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arithmetic_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="arithmetic_+3A_y">y</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object or a <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code style="white-space: pre;">&#8288;%perturbe%&#8288;</code></dt><dd><p><a href="#topic+perturbation">Perturbation operation</a>.</p>
</dd>
<dt><code style="white-space: pre;">&#8288;%power%&#8288;</code></dt><dd><p><a href="#topic+powering">Powering operation</a>.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object or a <code><a href="base.html#topic+numeric">numeric</a></code> vector (same as <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+closure">closure</a>()</code>,
<code><a href="#topic+perturbation">perturbation</a>()</code>,
<code><a href="#topic+powering">powering</a>()</code>,
<code><a href="#topic+scalar">scalar</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='as_amounts'>Coerce to Amounts</h2><span id='topic+as_amounts'></span><span id='topic+as_amounts-method'></span><span id='topic+as_amounts+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Coerce to Amounts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_amounts(from, ...)

## S4 method for signature 'CompositionMatrix'
as_amounts(from)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_amounts_+3A_from">from</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="as_amounts_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other compositional data tools: 
<code><a href="#topic+as_composition">as_composition</a>()</code>,
<code><a href="#topic+as_features">as_features</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a count matrix
A1 &lt;- matrix(data = as.numeric(sample(1:100, 100, TRUE)), nrow = 20)

## Coerce to compositions
B &lt;- as_composition(A1)

## Row sums are internally stored before coercing to relative frequencies
get_totals(B)

## This allows to restore the source data
A2 &lt;- as_amounts(B)

## Coerce to a data.frame
X &lt;- data.frame(B)
head(X)
</code></pre>

<hr>
<h2 id='as_composition'>Coerce to a Closed Compositional Matrix</h2><span id='topic+as_composition'></span><span id='topic+as_composition-method'></span><span id='topic+as_composition+2Cnumeric-method'></span><span id='topic+as_composition+2Cmatrix-method'></span><span id='topic+as_composition+2Cdata.frame-method'></span>

<h3>Description</h3>

<p>Coerces an object to a <code>CompositionMatrix</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_composition(from, ...)

## S4 method for signature 'numeric'
as_composition(from)

## S4 method for signature 'matrix'
as_composition(from)

## S4 method for signature 'data.frame'
as_composition(
  from,
  codes = NULL,
  samples = NULL,
  groups = NULL,
  auto = getOption("nexus.autodetect"),
  verbose = getOption("nexus.verbose")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_composition_+3A_from">from</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> or <code><a href="base.html#topic+data.frame">data.frame</a></code> to be coerced.</p>
</td></tr>
<tr><td><code id="as_composition_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="as_composition_+3A_codes">codes</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the index of the column to be used as
laboratory codes (unique identifiers).</p>
</td></tr>
<tr><td><code id="as_composition_+3A_samples">samples</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the index of the column to be used for
sample identification: allows duplicates to identify replicated measurements.
If <code>NULL</code> (the default), row names will be used as sample IDs.</p>
</td></tr>
<tr><td><code id="as_composition_+3A_groups">groups</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the index of the column to be used to
group the samples. If <code>NULL</code> (the default), no grouping is stored.</p>
</td></tr>
<tr><td><code id="as_composition_+3A_auto">auto</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: try to automatically detect <code>codes</code>,
<code>samples</code> and <code>groups</code> columns?</p>
</td></tr>
<tr><td><code id="as_composition_+3A_verbose">verbose</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should <span class="rlang"><b>R</b></span> report extra information
on progress?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> class has special slots:
</p>

<ul>
<li> <p><code>codes</code> for <a href="#topic+identifiers">laboratory codes</a>,
</p>
</li>
<li> <p><code>samples</code> for <a href="#topic+samples">repeated measurements/observation</a>,
</p>
</li>
<li> <p><code>groups</code> to <a href="grDevices.html#topic+group">group data by site/area</a>.
</p>
</li></ul>

<p>When coercing a <code>data.frame</code> to a <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object, an
attempt is made to automatically assign values to these slots by mapping
column names (case insensitive, plural insensitive). This behavior can be
disabled by setting <code>options(nexus.autodetect = FALSE)</code> or overridden by
explicitly specifying the columns to be used.
</p>
<p>See <code>vignette("nexus")</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Note</h3>

<p>All non-numeric variable will be removed.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other compositional data tools: 
<code><a href="#topic+as_amounts">as_amounts</a>()</code>,
<code><a href="#topic+as_features">as_features</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a count matrix
A1 &lt;- matrix(data = as.numeric(sample(1:100, 100, TRUE)), nrow = 20)

## Coerce to compositions
B &lt;- as_composition(A1)

## Row sums are internally stored before coercing to relative frequencies
get_totals(B)

## This allows to restore the source data
A2 &lt;- as_amounts(B)

## Coerce to a data.frame
X &lt;- data.frame(B)
head(X)
</code></pre>

<hr>
<h2 id='as_features'>Coerce to Features</h2><span id='topic+as_features'></span><span id='topic+as_features-method'></span><span id='topic+as_features+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Converts an object to a collection of features.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_features(from, ...)

## S4 method for signature 'CompositionMatrix'
as_features(from)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_features_+3A_from">from</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="as_features_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with all informations as extra columns.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other compositional data tools: 
<code><a href="#topic+as_amounts">as_amounts</a>()</code>,
<code><a href="#topic+as_composition">as_composition</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a count matrix
A1 &lt;- matrix(data = as.numeric(sample(1:100, 100, TRUE)), nrow = 20)

## Coerce to compositions
B &lt;- as_composition(A1)

## Row sums are internally stored before coercing to relative frequencies
get_totals(B)

## This allows to restore the source data
A2 &lt;- as_amounts(B)

## Coerce to a data.frame
X &lt;- data.frame(B)
head(X)
</code></pre>

<hr>
<h2 id='as_graph'>Graph of Log-ratios</h2><span id='topic+as_graph'></span><span id='topic+as_graph-method'></span><span id='topic+as_graph+2CLR-method'></span><span id='topic+as_graph+2CALR-method'></span><span id='topic+as_graph+2CILR-method'></span>

<h3>Description</h3>

<p>Produces a graph of log-ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_graph(object, ...)

## S4 method for signature 'LR'
as_graph(object)

## S4 method for signature 'ALR'
as_graph(object)

## S4 method for signature 'ILR'
as_graph(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_graph_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object.</p>
</td></tr>
<tr><td><code id="as_graph_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <span class="pkg">igraph</span> graph object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other plot methods: 
<code><a href="#topic+barplot">barplot</a>()</code>,
<code><a href="#topic+hist">hist</a>()</code>,
<code><a href="#topic+plot_logratio">plot_logratio</a></code>,
<code><a href="#topic+plot">plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("igraph", quietly = TRUE)) {

library(igraph)

## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)
lr_graph &lt;- as_graph(lr)
plot(lr_graph)

## Additive log-ratio
alr &lt;- transform_alr(coda)
alr_graph &lt;- as_graph(alr)
plot(alr_graph)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
ilr_graph &lt;- as_graph(ilr)
plot(ilr_graph)

plr &lt;- transform_plr(coda)
plr_graph &lt;- as_graph(plr)
plot(plr_graph)

}
</code></pre>

<hr>
<h2 id='barplot'>Barplot of Compositional Data</h2><span id='topic+barplot'></span><span id='topic+barplot+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Displays a compositional bar chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
barplot(
  height,
  ...,
  order = NULL,
  decreasing = FALSE,
  groups = get_groups(height),
  horiz = TRUE,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  sub = NULL,
  ann = graphics::par("ann"),
  axes = TRUE,
  col = grDevices::hcl.colors(ncol(height), "viridis"),
  legend = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barplot_+3A_height">height</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="barplot_+3A_...">...</code></td>
<td>
<p>Further parameters to be passed to <code><a href="graphics.html#topic+barplot">graphics::barplot()</a></code>.</p>
</td></tr>
<tr><td><code id="barplot_+3A_order">order</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> vector giving the index of the column to be used
for the ordering of the data.</p>
</td></tr>
<tr><td><code id="barplot_+3A_decreasing">decreasing</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the sort order be increasing
or decreasing?</p>
</td></tr>
<tr><td><code id="barplot_+3A_groups">groups</code></td>
<td>
<p>A <code><a href="base.html#topic+factor">factor</a></code> in the sense that <code><a href="base.html#topic+as.factor">as.factor(groups)</a></code>
defines the grouping. If set, a matrix of panels defined by <code>groups</code> will be
drawn.</p>
</td></tr>
<tr><td><code id="barplot_+3A_horiz">horiz</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar. If <code>FALSE</code>, the bars are drawn vertically
with the first bar to the left. If <code>TRUE</code> (the default), the bars are drawn
horizontally with the first at the bottom.</p>
</td></tr>
<tr><td><code id="barplot_+3A_xlab">xlab</code>, <code id="barplot_+3A_ylab">ylab</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the x and y axis labels.</p>
</td></tr>
<tr><td><code id="barplot_+3A_main">main</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a main title for the plot.</p>
</td></tr>
<tr><td><code id="barplot_+3A_sub">sub</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a subtitle for the plot.</p>
</td></tr>
<tr><td><code id="barplot_+3A_ann">ann</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the default annotation (title and x
and y axis labels) appear on the plot?</p>
</td></tr>
<tr><td><code id="barplot_+3A_axes">axes</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should axes be drawn on the plot?</p>
</td></tr>
<tr><td><code id="barplot_+3A_col">col</code></td>
<td>
<p>A vector of colors for the bar components.</p>
</td></tr>
<tr><td><code id="barplot_+3A_legend">legend</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> of additional arguments to be passed to
<code><a href="graphics.html#topic+legend">graphics::legend()</a></code>; names of the list are used as argument names.
If <code>NULL</code>, no legend is displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>barplot()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>height</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other plot methods: 
<code><a href="#topic+as_graph">as_graph</a>()</code>,
<code><a href="#topic+hist">hist</a>()</code>,
<code><a href="#topic+plot_logratio">plot_logratio</a></code>,
<code><a href="#topic+plot">plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Bar plot
barplot(coda, order = 2)

## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Use ceramic types for grouping

barplot(coda, order = 1)
barplot(coda, order = 1, horiz = FALSE)
</code></pre>

<hr>
<h2 id='chemistry'>Can Sora Chemical Data</h2><span id='topic+chemistry'></span>

<h3>Description</h3>

<p>Can Sora Chemical Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chemistry
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 30 variables.
</p>


<h3>References</h3>

<p>Cau, M.-A. (1999). Importaciones de cerámica tardorromana de cocina en las
Iles Balears: el caso de Can Sora (Eivissa). In J. Capel Martinez,
<em>Arqueometria y Arqueologia</em>, p. 197-219. Granada: Editorial Universidad de
Granada. Monografica Arte y Arqueología 47.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+petrography">petrography</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='closure'>Closure Operation</h2><span id='topic+closure'></span><span id='topic+closure-method'></span><span id='topic+closure+2Cnumeric-method'></span><span id='topic+closure+2Cmatrix-method'></span>

<h3>Description</h3>

<p>Closes compositions to sum up to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closure(x, ...)

## S4 method for signature 'numeric'
closure(x, total = 1, na.rm = FALSE)

## S4 method for signature 'matrix'
closure(x, total = 1, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="closure_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector or matrix.</p>
</td></tr>
<tr><td><code id="closure_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="closure_+3A_total">total</code></td>
<td>
<p>A <a href="base.html#topic+numeric">numeric</a> vector specifying the total amount to which the
compositions should be closed (defaults to 1).</p>
</td></tr>
<tr><td><code id="closure_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should missing values be removed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector or matrix (same as <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+arithmetic">arithmetic</a></code>,
<code><a href="#topic+perturbation">perturbation</a>()</code>,
<code><a href="#topic+powering">powering</a>()</code>,
<code><a href="#topic+scalar">scalar</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='CompositionMatrix-class'>Compositional Matrix</h2><span id='topic+CompositionMatrix-class'></span><span id='topic+.CompositionMatrix'></span>

<h3>Description</h3>

<p>An S4 class to represent compositional data.
</p>


<h3>Slots</h3>


<dl>
<dt><code>totals</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector to store the absolute row sums (before
the closure of the compositions).</p>
</dd>
<dt><code>codes</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the laboratory codes
(unique identifiers).</p>
</dd>
<dt><code>samples</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the sample identifiers
(allows duplicates in case of repeated measurements).</p>
</dd>
<dt><code>groups</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the group names (if any).</p>
</dd>
</dl>


<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is a <code>CompositionMatrix</code> object.
</p>

<dl>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Subset</h3>

<p>In the code snippets below, <code>x</code> is a <code>CompositionMatrix</code> object.
</p>

<dl>
<dt><code>x[i, j]</code></dt><dd><p>Extract parts of a matrix (see <code><a href="#topic+subset">[</a></code>).</p>
</dd>
</dl>



<h3>Note</h3>

<p>This class inherits from <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as_composition">as_composition()</a></code>
</p>
<p>Other classes: 
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+LogicalMatrix-class">LogicalMatrix-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## codaccess
dim(coda) # Get the matrix dimensions
row(coda) # Get the row indexes
col(coda, as.factor = TRUE) # Get the column indexes
nrow(coda) # Get the number of rows
ncol(coda) # Get the number of columns
dimnames(coda) # Get the dimension names
rownames(coda) &lt;- LETTERS[1:25] # Set the row names
rownames(coda) # Get the rownames
colnames(coda) &lt;- letters[21:25] # Set the column names
colnames(coda) # Get the column names
</code></pre>

<hr>
<h2 id='covariance'>Covariance Matrix</h2><span id='topic+covariance'></span><span id='topic+covariance-method'></span><span id='topic+covariance+2CCompositionMatrix-method'></span><span id='topic+covariance+2CALR-method'></span><span id='topic+covariance+2CCLR-method'></span>

<h3>Description</h3>

<p>Computes the (centered) log-ratio covariance matrix (see below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covariance(x, ...)

## S4 method for signature 'CompositionMatrix'
covariance(x, center = TRUE, method = "pearson")

## S4 method for signature 'ALR'
covariance(x, method = "pearson")

## S4 method for signature 'CLR'
covariance(x, method = "pearson")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covariance_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="covariance_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="covariance_+3A_center">center</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the <em>centered</em> log-ratio
covariance matrix be computed?</p>
</td></tr>
<tr><td><code id="covariance_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string indicating which covariance is to be
computed (see <code><a href="stats.html#topic+cor">stats::cov()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>covariance(ALR)</code>: Computes the log-ratio covariance matrix
(Aitchison 1986, definition 4.5).
</p>
</li>
<li> <p><code>covariance(CLR)</code>: Computes the centered log-ratio covariance matrix
(Aitchison 1986, definition 4.6).
</p>
</li></ul>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Log-ratio covariance matrix
## (Aitchison 1986, definition 4.5)
covariance(coda, center = FALSE)

## Centered log-ratio covariance matrix
## (Aitchison 1986, definition 4.6)
covariance(coda, center = TRUE)
</code></pre>

<hr>
<h2 id='dist'>Distances</h2><span id='topic+dist'></span><span id='topic+dist+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes the log-ratio variance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
dist(x, method = "euclidean", diag = FALSE, upper = FALSE, p = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="dist_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the distance measure to be
used. See <code><a href="stats.html#topic+dist">stats::dist()</a></code> for the available distances.</p>
</td></tr>
<tr><td><code id="dist_+3A_diag">diag</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar indicating whether the diagonal of the
distance matrix should be printed.</p>
</td></tr>
<tr><td><code id="dist_+3A_upper">upper</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar indicating whether the upper triangle of
the distance matrix should be printed.</p>
</td></tr>
<tr><td><code id="dist_+3A_p">p</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the power of the Minkowski distance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Distances are computed on <a href="#topic+transform_clr">CLR-transformed</a> data.
</p>


<h3>Value</h3>

<p>A <code><a href="stats.html#topic+dist">stats::dist</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dist">stats::dist()</a></code>
</p>
<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Aitchison distance
## (euclidean distance between CLR-transformed compositions)
d &lt;- dist(coda)

## Cluster dendrogram
h &lt;- hclust(d, method = "ward.D2")
plot(h)
</code></pre>

<hr>
<h2 id='groups'>Working With Groups</h2><span id='topic+groups'></span><span id='topic+any_assigned'></span><span id='topic+any_assigned-method'></span><span id='topic+is_assigned'></span><span id='topic+is_assigned-method'></span><span id='topic+get_groups'></span><span id='topic+get_groups-method'></span><span id='topic+set_groups+3C-'></span><span id='topic+set_groups-method'></span><span id='topic+is_assigned+2CCompositionMatrix-method'></span><span id='topic+is_assigned+2CLogRatio-method'></span><span id='topic+is_assigned+2COutlierIndex-method'></span><span id='topic+any_assigned+2CCompositionMatrix-method'></span><span id='topic+any_assigned+2CLogRatio-method'></span><span id='topic+any_assigned+2COutlierIndex-method'></span><span id='topic+get_groups+2CCompositionMatrix-method'></span><span id='topic+get_groups+2CLogRatio-method'></span><span id='topic+get_groups+2COutlierIndex-method'></span><span id='topic+set_groups+3C-+2CCompositionMatrix-method'></span><span id='topic+set_groups+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Retrieves or defines the groups to which the observations belong.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>any_assigned(x)

is_assigned(x)

get_groups(x)

set_groups(x) &lt;- value

## S4 method for signature 'CompositionMatrix'
is_assigned(x)

## S4 method for signature 'LogRatio'
is_assigned(x)

## S4 method for signature 'OutlierIndex'
is_assigned(x)

## S4 method for signature 'CompositionMatrix'
any_assigned(x)

## S4 method for signature 'LogRatio'
any_assigned(x)

## S4 method for signature 'OutlierIndex'
any_assigned(x)

## S4 method for signature 'CompositionMatrix'
get_groups(x)

## S4 method for signature 'LogRatio'
get_groups(x)

## S4 method for signature 'OutlierIndex'
get_groups(x)

## S4 replacement method for signature 'CompositionMatrix'
set_groups(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="groups_+3A_x">x</code></td>
<td>
<p>An object from which to get or set <code>groups</code>.</p>
</td></tr>
<tr><td><code id="groups_+3A_value">value</code></td>
<td>
<p>A possible value for the <code>groups</code> of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>vignette("nexus")</code>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>set_groups()</code> returns an object of the same sort as <code>x</code> with the new
group names assigned.
</p>
</li>
<li> <p><code>get_groups()</code> returns a <code><a href="base.html#topic+character">character</a></code> vector giving the group names of <code>x</code>.
</p>
</li>
<li> <p><code>any_assigned()</code> returns a <code><a href="base.html#topic+logical">logical</a></code> scalar specifying whether or not <code>x</code>
has groups.
</p>
</li>
<li> <p><code>is_assigned()</code> returns a <code><a href="base.html#topic+logical">logical</a></code> vector specifying whether or not an
observation belongs to a group.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+identifiers">identifiers</a></code>,
<code><a href="#topic+samples">samples</a></code>,
<code><a href="#topic+split">split</a>()</code>,
<code><a href="#topic+subset">subset</a>()</code>,
<code><a href="#topic+totals">totals</a></code>
</p>

<hr>
<h2 id='hist'>Histogram of Compositional Data</h2><span id='topic+hist'></span><span id='topic+hist+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Produces an histogram of univariate ILR data (see Filzmoser <em>et al.</em>, 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
hist(
  x,
  ...,
  freq = FALSE,
  ncol = NULL,
  flip = FALSE,
  main = NULL,
  sub = NULL,
  ann = graphics::par("ann"),
  axes = TRUE,
  frame.plot = axes
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="hist_+3A_...">...</code></td>
<td>
<p>Further parameters to be passed to <code><a href="graphics.html#topic+hist">graphics::hist()</a></code>.</p>
</td></tr>
<tr><td><code id="hist_+3A_freq">freq</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should absolute frequencies (counts) be
displayed (see <code><a href="graphics.html#topic+hist">graphics::hist()</a></code>)?</p>
</td></tr>
<tr><td><code id="hist_+3A_ncol">ncol</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> specifying the number of columns to use when
<code>facet</code> is &quot;<code>multiple</code>&quot;. Defaults to 1 for up to 4 series, otherwise to 2.</p>
</td></tr>
<tr><td><code id="hist_+3A_flip">flip</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the y-axis (ticks and numbering) be
flipped from side 2 (left) to 4 (right) from variable to variable?</p>
</td></tr>
<tr><td><code id="hist_+3A_main">main</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a main title for the plot.</p>
</td></tr>
<tr><td><code id="hist_+3A_sub">sub</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a subtitle for the plot.</p>
</td></tr>
<tr><td><code id="hist_+3A_ann">ann</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the default annotation (title and x
and y axis labels) appear on the plot?</p>
</td></tr>
<tr><td><code id="hist_+3A_axes">axes</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should axes be drawn on the plot?</p>
</td></tr>
<tr><td><code id="hist_+3A_frame.plot">frame.plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a box be drawn around the
plot?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>hist()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2009). Univariate Statistical
Analysis of Environmental (Compositional) Data: Problems and Possibilities.
<em>Science of The Total Environment</em>, 407(23): 6100-6108.
<a href="https://doi.org/10.1016/j.scitotenv.2009.08.008">doi:10.1016/j.scitotenv.2009.08.008</a>.
</p>


<h3>See Also</h3>

<p>Other plot methods: 
<code><a href="#topic+as_graph">as_graph</a>()</code>,
<code><a href="#topic+barplot">barplot</a>()</code>,
<code><a href="#topic+plot_logratio">plot_logratio</a></code>,
<code><a href="#topic+plot">plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Boxplot plot
hist(coda)

hist(coda)
hist(coda[, 1, drop = FALSE])
</code></pre>

<hr>
<h2 id='hongite'>Hongite Mineralogy</h2><span id='topic+hongite'></span>

<h3>Description</h3>

<p>Mineral compositions of 25 rock specimens of hongite type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hongite
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 5 variables (minerals):
</p>

<dl>
<dt>A</dt><dd><p>Albite (percent).</p>
</dd>
<dt>B</dt><dd><p>Blandite (percent).</p>
</dd>
<dt>C</dt><dd><p>Cornite (percent).</p>
</dd>
<dt>D</dt><dd><p>Daubite (percent).</p>
</dd>
<dt>E</dt><dd><p>Endite (percent).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+chemistry">chemistry</a></code>,
<code><a href="#topic+petrography">petrography</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='identifiers'>Unique Identifiers</h2><span id='topic+identifiers'></span><span id='topic+get_identifiers'></span><span id='topic+get_identifiers-method'></span><span id='topic+set_identifiers+3C-'></span><span id='topic+set_identifiers-method'></span><span id='topic+get_identifiers+2CCompositionMatrix-method'></span><span id='topic+get_identifiers+2CLogRatio-method'></span><span id='topic+get_identifiers+2COutlierIndex-method'></span><span id='topic+set_identifiers+3C-+2CCompositionMatrix-method'></span><span id='topic+set_identifiers+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Retrieves or defines the unique identifier (eg. laboratory codes) of each
observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_identifiers(x)

set_identifiers(x) &lt;- value

## S4 method for signature 'CompositionMatrix'
get_identifiers(x)

## S4 method for signature 'LogRatio'
get_identifiers(x)

## S4 method for signature 'OutlierIndex'
get_identifiers(x)

## S4 replacement method for signature 'CompositionMatrix'
set_identifiers(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="identifiers_+3A_x">x</code></td>
<td>
<p>An object from which to get or set <code>codes</code>.</p>
</td></tr>
<tr><td><code id="identifiers_+3A_value">value</code></td>
<td>
<p>A possible value for the <code>codes</code> of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>vignette("nexus")</code>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>set_identifiers()</code> returns an object of the same sort as <code>x</code> with the new
identifiers assigned.
</p>
</li>
<li> <p><code>get_identifiers()</code> returns a <code><a href="base.html#topic+character">character</a></code> vector giving the unique
identifiers of <code>x</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+groups">groups</a></code>,
<code><a href="#topic+samples">samples</a></code>,
<code><a href="#topic+split">split</a>()</code>,
<code><a href="#topic+subset">subset</a>()</code>,
<code><a href="#topic+totals">totals</a></code>
</p>

<hr>
<h2 id='LogicalMatrix-class'>Logical Matrix</h2><span id='topic+LogicalMatrix-class'></span><span id='topic+.LogicalMatrix'></span>

<h3>Description</h3>

<p>S4 classes that represent a <code class="reqn">m \times p</code> logical matrix.
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code></dt><dd><p>A <code class="reqn">m \times p</code> <code>logical</code> <code><a href="base.html#topic+matrix">matrix</a></code>.</p>
</dd>
</dl>


<h3>Note</h3>

<p>This class inherits from <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>
</p>

<hr>
<h2 id='LogRatio-class'>Log-Ratio Matrix</h2><span id='topic+LogRatio-class'></span><span id='topic+.LogRatio'></span><span id='topic+LR-class'></span><span id='topic+.LR'></span><span id='topic+CLR-class'></span><span id='topic+.CLR'></span><span id='topic+ALR-class'></span><span id='topic+.ALR'></span><span id='topic+ILR-class'></span><span id='topic+.ILR'></span><span id='topic+PLR-class'></span><span id='topic+.PLR'></span>

<h3>Description</h3>

<p>S4 classes to represent log-ratio data transformations.
</p>


<h3>Slots</h3>


<dl>
<dt><code>totals</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector to store the absolute row sums (before
the closure of the compositions).</p>
</dd>
<dt><code>codes</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the laboratory codes
(unique identifiers).</p>
</dd>
<dt><code>samples</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the sample identifiers
(allows duplicates in case of repeated measurements).</p>
</dd>
<dt><code>groups</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the group names (if any).</p>
</dd>
<dt><code>parts</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the part names.</p>
</dd>
<dt><code>ratio</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the ratio names.</p>
</dd>
<dt><code>order</code></dt><dd><p>An <code><a href="base.html#topic+integer">integer</a></code> vector to store the original ordering of the
columns.</p>
</dd>
<dt><code>base</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix to store the basis of the transformation.</p>
</dd>
<dt><code>weights</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector to store the weights assigned to the
respective log-ratios.</p>
</dd>
</dl>


<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is a <code>LogRatio</code> object.
</p>

<dl>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>These classes inherit from <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_lr">transform_lr()</a></code>, <code><a href="#topic+transform_clr">transform_clr()</a></code>, <code><a href="#topic+transform_alr">transform_alr()</a></code>,
<code><a href="#topic+transform_ilr">transform_ilr()</a></code>, <code><a href="#topic+transform_plr">transform_plr()</a></code>
</p>
<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+LogicalMatrix-class">LogicalMatrix-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>
</p>

<hr>
<h2 id='mahalanobis'>Mahalanobis Distance</h2><span id='topic+mahalanobis'></span><span id='topic+mahalanobis+2CCompositionMatrix-method'></span><span id='topic+mahalanobis+2CILR-method'></span>

<h3>Description</h3>

<p>Computes the squared Mahalanobis distance of all rows in <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
mahalanobis(x, center, cov, ..., robust = TRUE, method = c("mve", "mcd"))

## S4 method for signature 'ILR'
mahalanobis(x, center, cov, ..., robust = TRUE, method = c("mve", "mcd"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mahalanobis_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> or an <code><a href="#topic+ILR-class">ILR</a></code> object.</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_center">center</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the mean vector of the
distribution. If missing, will be estimated from <code>x</code>.</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_cov">cov</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix giving the covariance of the
distribution. If missing, will be estimated from <code>x</code>.</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to <code><a href="MASS.html#topic+cov.rob">MASS::cov.rob()</a></code>.
Only used if <code>robust</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_robust">robust</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should robust location and scatter
estimation be used?</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the method to be used.
It must be one of &quot;<code>mve</code>&quot; (minimum volume ellipsoid) or &quot;<code>mcd</code>&quot; (minimum
covariance determinant). Only used if <code>robust</code> is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+mahalanobis">stats::mahalanobis()</a></code>
</p>
<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Mahalanobis distance
mahalanobis(coda)
</code></pre>

<hr>
<h2 id='margin'>Marginal Compositions</h2><span id='topic+margin'></span><span id='topic+margin-method'></span><span id='topic+margin+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Marginal Compositions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margin(x, ...)

## S4 method for signature 'CompositionMatrix'
margin(x, parts = c(1, 2), name = "*")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="margin_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="margin_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="margin_+3A_parts">parts</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> or a <code><a href="base.html#topic+character">character</a></code> vector specifying the columns
to be selected.</p>
</td></tr>
<tr><td><code id="margin_+3A_name">name</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving the name of the amalgamation
column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Marginal compositions
mar &lt;- margin(coda, parts = c("B", "D"))
head(mar)
</code></pre>

<hr>
<h2 id='mean'>Compositional Mean</h2><span id='topic+mean'></span><span id='topic+mean+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Compositional Mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
mean(x, ..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="mean_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="mean_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should missing values be removed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Closed vector of the columns geometric means.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Mean
mean(coda)

## Quantile
quantile(coda)

## Metric variance
metric_var(coda)

## Metric standard deviation
metric_sd(coda)
</code></pre>

<hr>
<h2 id='metric_var'>Metric Variance and Standard Deviation</h2><span id='topic+metric_var'></span><span id='topic+metric_var-method'></span><span id='topic+metric_sd'></span><span id='topic+metric_sd-method'></span><span id='topic+metric_var+2CCompositionMatrix-method'></span><span id='topic+metric_sd+2CCompositionMatrix-method'></span>

<h3>Description</h3>


<ul>
<li> <p><code>metric_var()</code> computes the metric variance (or total variance), i.e. a
global measure of spread.
</p>
</li>
<li> <p><code>metric_sd()</code> computes the metric standard deviation.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>metric_var(x, ...)

metric_sd(x, ...)

## S4 method for signature 'CompositionMatrix'
metric_var(x)

## S4 method for signature 'CompositionMatrix'
metric_sd(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metric_var_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="metric_var_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The metric variance is the average of the <a href="#topic+transform_clr">CLR</a> variances.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Boogaart, K. G. van den &amp; Tolosana-Delgado, R. (2013). <em>Analyzing
Compositional Data with R</em>. Berlin Heidelberg: Springer-Verlag.
<a href="https://doi.org/10.1007/978-3-642-36809-7">doi:10.1007/978-3-642-36809-7</a>.
</p>
<p>Hron, K. &amp; Kubáček. L. (2011). Statistical Properties of the Total Variation
Estimator for Compositional Data. <em>Metrika</em>, 74 (2): 221-230.
<a href="https://doi.org/10.1007/s00184-010-0299-3">doi:10.1007/s00184-010-0299-3</a>.
</p>
<p>Pawlowsky-Glahn, V. &amp; Egozcue, J. J. (2001). Geometric Approach to
Statistical Analysis on the Simplex. <em>Stochastic Environmental Research and
Risk Assessment</em>, 15(5): 384-398. <a href="https://doi.org/10.1007/s004770100077">doi:10.1007/s004770100077</a>.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Mean
mean(coda)

## Quantile
quantile(coda)

## Metric variance
metric_var(coda)

## Metric standard deviation
metric_sd(coda)
</code></pre>

<hr>
<h2 id='missing'>Missing Values Policy</h2><span id='topic+missing'></span>

<h3>Description</h3>

<p>Missing Values Policy
</p>


<h3>Details</h3>

<p>Compositional data are quantitative (positive) descriptions of the parts
of some whole, carrying relative, rather than absolute, information
(ie. only relative changes are relevant; Aitchison 1986).
</p>
<p>Basically, two situations can be outlined:
</p>

<ul>
<li><p> The presence of zeros: these are considered as observed quantities,
but which happen to be below the detection limit (thus interpreted as
small unknown values).
</p>
</li>
<li><p> The presence of missing values (<code>NA</code>): these indicate that the quantities
in question have not been observed.
</p>
</li></ul>

<p>When creating a <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object, the presence of zero
and <code><a href="base.html#topic+NA">NA</a></code> values is allowed: this makes it possible to explore and
visualize the data while preserving the missing structure. However, the
user must deal with these missing values before proceeding further (e.g.
by removing incomplete cases or replacing the values concerned): log-ratio
transformations cannot be computed in the presence of missing values.
</p>


<h3>Note</h3>

<p>If you need more advanced features (e.g. imputation of missing values),
you should consider the <span class="pkg">compositions</span> or <span class="pkg">robCompositions</span> package.
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other imputation methods: 
<code><a href="#topic+replace_NA">replace_NA</a>()</code>,
<code><a href="#topic+replace_zero">replace_zero</a>()</code>
</p>

<hr>
<h2 id='mix'>Mixed-Mode Analysis</h2><span id='topic+mix'></span><span id='topic+mix-method'></span><span id='topic+mix+2Cmatrix+2Cmatrix-method'></span><span id='topic+mix+2Cdist+2Cdist-method'></span>

<h3>Description</h3>

<p>Mixes chemical and petrographic matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix(x, y, ...)

## S4 method for signature 'matrix,matrix'
mix(x, y, lambda = 1, ...)

## S4 method for signature 'dist,dist'
mix(x, y, mu = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> of chemical compositional data or a
<a href="stats.html#topic+dist">dissimilarity matrix</a> for these chemical compositional data.</p>
</td></tr>
<tr><td><code id="mix_+3A_y">y</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> of coded mineralogical binary data or a
<a href="stats.html#topic+dist">dissimilarity matrix</a> for these mineralogical data.</p>
</td></tr>
<tr><td><code id="mix_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to <code><a href="cluster.html#topic+daisy">cluster::daisy()</a></code>.</p>
</td></tr>
<tr><td><code id="mix_+3A_lambda">lambda</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving a weighting factor.</p>
</td></tr>
<tr><td><code id="mix_+3A_mu">mu</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector that lies between 0 and 1 giving
the mixing parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="stats.html#topic+dist">stats::dist</a> object.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>mix(x = matrix, y = matrix)</code>: First approach of mixed-mode analysis.
</p>
</li>
<li> <p><code>mix(x = dist, y = dist)</code>: Second approach of mixed-mode analysis.
</p>
</li></ul>


<h3>Note</h3>

<p><strong>Experimental.</strong>
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Baxter, M. J., Beardah, C. C., Papageorgiou, I., Cau, M. A., Day, P. M. &amp;
Kilikoglou, V. (2008). On Statistical Approaches to the Study of Ceramic
Artefacts Using Geochemical and Petrographic Data. <em>Archaeometry</em>, 50(1):
142-157. <a href="https://doi.org/10.1111/j.1475-4754.2007.00359.x">doi:10.1111/j.1475-4754.2007.00359.x</a>.
</p>
<p>Beardah, C. C., Baxter, M. J., Papageorgiou, I. &amp; Cau, M. A. (2003).
&quot;Mixed-Mode&quot; Approaches to the Grouping of Ceramic Artefacts Using S-Plus.
In M. Doerr and A. Sarris, <em>The Digital Heritage of Archaeology</em>, p. 261-266.
Athens: Archive of Monuments and Publications, Hellenic Ministry of Culture.
</p>
<p>Gower, J. C. (1971). A general coefficient of similarity and some of its
properties. <em>Biometrics</em>, 27(4):857-874. <a href="https://doi.org/10.2307/2528823">doi:10.2307/2528823</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Prepare chemical data
data("chemistry")
major &lt;- c("Fe2O3", "Al2O3", "MnO", "P2O5", "TiO2", "MgO", "CaO", "Na2O", "K2O", "SiO2")
chem &lt;- chemistry[-1, major]

## Prepare petrographic data
data("petrography")
petro &lt;- petrography[-c(7, 8), -1]
petro &lt;- cdt(petro) # Get the complete disjunctive table

## First approach
mix1 &lt;- mix(as.matrix(chem), as.matrix(petro), lambda = 2)
mds1 &lt;- stats::cmdscale(mix1) # Multi-Dimensional Scaling
plot(mds1)

</code></pre>

<hr>
<h2 id='nexus-package'>nexus: Sourcing Archaeological Materials by Chemical Composition</h2><span id='topic+nexus-package'></span><span id='topic+nexus'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Exploration and analysis of compositional data in the framework of Aitchison (1986, ISBN: 978-94-010-8324-9). This package provides tools for chemical fingerprinting and source tracking of ancient materials.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
<strong>Package:</strong> </td><td style="text-align: left;"> nexus </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Type:</strong> </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Version:</strong> </td><td style="text-align: left;"> 0.2.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>License:</strong> </td><td style="text-align: left;"> GPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Zenodo:</strong> </td><td style="text-align: left;"> <a href="https://doi.org/10.5281/zenodo.10225630">doi:10.5281/zenodo.10225630</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Package options</h3>

<p><code>nexus</code> uses the following <code><a href="base.html#topic+options">options()</a></code> to configure behavior:
</p>

<ul>
<li> <p><code>nexus.autodetect</code>: a <code><a href="base.html#topic+logical">logical</a></code> scalar. Try to automatically assign
values to the corresponding slot of a <code>CompositionMatrix</code> object when
coercing a <code>data.frame</code>? Defaults to <code>TRUE</code>.
</p>
</li>
<li> <p><code>nexus.verbose</code>: a <code><a href="base.html#topic+logical">logical</a></code> scalar. Should <span class="rlang"><b>R</b></span> report extra information
on progress? Defaults to <code>TRUE</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Full list of authors and contributors</strong> (alphabetic order)
</p>

<table>
<tr>
 <td style="text-align: left;">
Nicolas Frerebeau </td><td style="text-align: left;"> <em>Université Bordeaux Montaigne, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Brice Lebrun </td><td style="text-align: left;"> <em>Université Bordeaux Montaigne, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Anne Philippe </td><td style="text-align: left;"> <em>Université de Nantes, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Package maintainer</strong>
</p>
<p>Nicolas Frerebeau<br />
<a href="mailto:nicolas.frerebeau@u-bordeaux-montaigne.fr">nicolas.frerebeau@u-bordeaux-montaigne.fr</a>
</p>
<p>Archéosciences Bordeaux (UMR 6034)<br />
Maison de l'Archéologie<br />
Université Bordeaux Montaigne<br />
F-33607 Pessac cedex<br />
France
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://packages.tesselle.org/nexus/">https://packages.tesselle.org/nexus/</a>
</p>
</li>
<li> <p><a href="https://github.com/tesselle/nexus">https://github.com/tesselle/nexus</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/tesselle/nexus/issues">https://github.com/tesselle/nexus/issues</a>
</p>
</li></ul>


<hr>
<h2 id='NumericMatrix-class'>Numeric Matrix</h2><span id='topic+NumericMatrix-class'></span><span id='topic+.NumericMatrix'></span>

<h3>Description</h3>

<p>S4 classes that represent a <code class="reqn">m \times p</code> numeric matrix.
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code></dt><dd><p>A <code class="reqn">m \times p</code> <code>numeric</code> <code><a href="base.html#topic+matrix">matrix</a></code>.</p>
</dd>
</dl>


<h3>Note</h3>

<p>This class inherits from <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+LogicalMatrix-class">LogicalMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>
</p>

<hr>
<h2 id='OutlierIndex-class'>Outliers</h2><span id='topic+OutlierIndex-class'></span><span id='topic+.OutlierIndex'></span>

<h3>Description</h3>

<p>An S4 class to store the result of outlier detection.
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code></dt><dd><p>A <code><a href="base.html#topic+logical">logical</a></code> matrix.</p>
</dd>
<dt><code>codes</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the laboratory codes
(unique identifiers).</p>
</dd>
<dt><code>samples</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the sample identifiers
(allows duplicates in case of repeated measurements).</p>
</dd>
<dt><code>groups</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the group names (if any).</p>
</dd>
<dt><code>distances</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix giving the squared Mahalanobis distance.</p>
</dd>
<dt><code>limit</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> value giving the cut-off value used for outlier
detection (quantile of the Chi-squared distribution).</p>
</dd>
<dt><code>robust</code></dt><dd><p>An <code><a href="base.html#topic+logical">logical</a></code> scalar: were robust estimators used?</p>
</dd>
<dt><code>dof</code></dt><dd><p>A (non-negative) <code><a href="base.html#topic+numeric">numeric</a></code> value giving the degrees of freedom.</p>
</dd>
</dl>


<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is an <code>OutlierIndex</code> object.
</p>

<dl>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Subset</h3>

<p>In the code snippets below, <code>x</code> is an <code>OutlierIndex</code> object.
</p>

<dl>
<dt><code>x[[i]]</code></dt><dd><p>Extract a part of an object (see <code><a href="#topic+subset">[[</a></code>).</p>
</dd>
</dl>



<h3>Note</h3>

<p>These classes inherit from <code><a href="base.html#topic+logical">logical</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+LogicalMatrix-class">LogicalMatrix-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>
</p>

<hr>
<h2 id='outliers'>Outlier Detection</h2><span id='topic+outliers'></span><span id='topic+outliers-method'></span><span id='topic+outliers+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Outlier Detection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outliers(object, ...)

## S4 method for signature 'CompositionMatrix'
outliers(
  object,
  ...,
  groups = get_groups(object),
  robust = TRUE,
  method = c("mve", "mcd"),
  quantile = 0.975
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outliers_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code>.</p>
</td></tr>
<tr><td><code id="outliers_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to <code><a href="MASS.html#topic+cov.rob">MASS::cov.rob()</a></code>.
Only used if <code>robust</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="outliers_+3A_groups">groups</code></td>
<td>
<p>A <code><a href="base.html#topic+factor">factor</a></code> in the sense that <code><a href="base.html#topic+as.factor">as.factor(groups)</a></code>
defines the grouping. If set, XXX.</p>
</td></tr>
<tr><td><code id="outliers_+3A_robust">robust</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should robust location and scatter
estimation be used?</p>
</td></tr>
<tr><td><code id="outliers_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the method to be used.
It must be one of &quot;<code>mve</code>&quot; (minimum volume ellipsoid) or &quot;<code>mcd</code>&quot; (minimum
covariance determinant). Only used if <code>robust</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="outliers_+3A_quantile">quantile</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the significance level.
<code>quantile</code> is used as a cut-off value for outlier detection: observations
with larger (squared) Mahalanobis distance are considered as potential
outliers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An outlier can be defined as having a very large Mahalanobis distance from
all observations. In this way, a certain proportion of the observations can
be identified, e.g. the top 2% of values (i.e. values above the 0.98th
percentile of the Chi-2 distribution).
</p>
<p>On the one hand, the Mahalanobis distance is likely to be strongly
affected by the presence of outliers. Rousseeuw and van Zomeren (1990) thus
recommend using robust methods (which are not excessively affected by the
presence of outliers).
</p>
<p>On the other hand, the choice of the threshold for classifying an
observation as an outlier should be discussed. There is no apparent reason
why a particular threshold should be applicable to all data sets
(Filzmoser, Garrett, and Reimann 2005).
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+OutlierIndex-class">OutlierIndex</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Garrett, R. G. &amp; Reimann, C. (2005). Multivariate outlier
detection in exploration geochemistry. <em>Computers &amp; Geosciences</em>,
31(5), 579-587. <a href="https://doi.org/10.1016/j.cageo.2004.11.013">doi:10.1016/j.cageo.2004.11.013</a>.
</p>
<p>Filzmoser, P. &amp; Hron, K. (2008). Outlier Detection for Compositional Data
Using Robust Methods. <em>Mathematical Geosciences</em>, 40(3), 233-248.
<a href="https://doi.org/10.1007/s11004-007-9141-5">doi:10.1007/s11004-007-9141-5</a>.
</p>
<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2012). Interpretation of multivariate
outliers for compositional data. <em>Computers &amp; Geosciences</em>, 39, 77-85.
<a href="https://doi.org/10.1016/j.cageo.2011.06.014">doi:10.1016/j.cageo.2011.06.014</a>.
</p>
<p>Rousseeuw, P. J. &amp; van Zomeren, B. C. (1990). Unmasking Multivariate Outliers
and Leverage Points. <em>Journal of the American Statistical Association</em>,
85(411): 633-639. <a href="https://doi.org/10.1080/01621459.1990.10474920">doi:10.1080/01621459.1990.10474920</a>.
</p>
<p>Santos, F. (2020). Modern methods for old data: An overview of some robust
methods for outliers detection with applications in osteology. <em>Journal of
Archaeological Science: Reports</em>, 32, 102423.
<a href="https://doi.org/10.1016/j.jasrep.2020.102423">doi:10.1016/j.jasrep.2020.102423</a>.
</p>


<h3>See Also</h3>

<p>Other outlier detection methods: 
<code><a href="#topic+plot_outliers">plot_outliers</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Use ceramic types for grouping

## Detect outliers
out &lt;- outliers(coda, groups = NULL, robust = FALSE)

plot(out) # Plot
plot(out, qq = TRUE) # Quantile-Quantile plot

## Detect outliers by group
out &lt;- outliers(coda[, 1:15, drop = FALSE])

plot(out, ncol = 2) # Plot
plot(out, qq = TRUE, ncol = 4) # Quantile-Quantile plot
</code></pre>

<hr>
<h2 id='pca_coda'>Principal Components Analysis</h2><span id='topic+pca_coda'></span><span id='topic+pca+2CCompositionMatrix-method'></span><span id='topic+pca+2CLogRatio-method'></span>

<h3>Description</h3>

<p>Computes a principal components analysis based on the singular value
decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
pca(
  object,
  center = TRUE,
  scale = FALSE,
  rank = NULL,
  sup_row = NULL,
  sup_col = NULL,
  weight_row = NULL,
  weight_col = NULL
)

## S4 method for signature 'LogRatio'
pca(
  object,
  center = TRUE,
  scale = FALSE,
  rank = NULL,
  sup_row = NULL,
  sup_col = NULL,
  weight_row = NULL,
  weight_col = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca_coda_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object.</p>
</td></tr>
<tr><td><code id="pca_coda_+3A_center">center</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the variables be shifted to be
zero centered?</p>
</td></tr>
<tr><td><code id="pca_coda_+3A_scale">scale</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the variables be scaled to unit
variance?</p>
</td></tr>
<tr><td><code id="pca_coda_+3A_rank">rank</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> value specifying the maximal number of components
to be kept in the results. If <code>NULL</code> (the default), <code class="reqn">p - 1</code> components
will be returned.</p>
</td></tr>
<tr><td><code id="pca_coda_+3A_sup_row">sup_row</code></td>
<td>
<p>A <code>vector</code> specifying the indices of the supplementary rows.</p>
</td></tr>
<tr><td><code id="pca_coda_+3A_sup_col">sup_col</code></td>
<td>
<p>A <code>vector</code> specifying the indices of the supplementary columns.</p>
</td></tr>
<tr><td><code id="pca_coda_+3A_weight_row">weight_row</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the active row (individual)
weights. If <code>NULL</code> (the default), uniform weights are used. Row weights are
internally normalized to sum 1</p>
</td></tr>
<tr><td><code id="pca_coda_+3A_weight_col">weight_col</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the active column
(variable) weights. If <code>NULL</code> (the default), uniform weights (1) are
used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="dimensio.html#topic+PCA-class">dimensio::PCA</a></code> object. See package <span class="pkg">dimensio</span> for details.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. and Greenacre, M. (2002). Biplots of compositional data.
<em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>,
51: 375-392. <a href="https://doi.org/10.1111/1467-9876.00275">doi:10.1111/1467-9876.00275</a>.
</p>
<p>Filzmoser, P., Hron, K. and Reimann, C. (2009). Principal component analysis
for compositional data with outliers. <em>Environmetrics</em>, 20: 621-632.
<a href="https://doi.org/10.1002/env.966">doi:10.1002/env.966</a>.
</p>


<h3>See Also</h3>

<p><code><a href="dimensio.html#topic+pca">dimensio::pca()</a></code>, <code><a href="dimensio.html#topic+biplot">dimensio::biplot()</a></code>, <code><a href="dimensio.html#topic+screeplot">dimensio::screeplot()</a></code>,
<code><a href="dimensio.html#topic+viz_individuals">dimensio::viz_individuals()</a></code>, <code><a href="dimensio.html#topic+viz_variables">dimensio::viz_variables()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Use ceramic types for grouping

## Centered log-ratio
clr &lt;- transform_clr(coda)

## PCA
X &lt;- pca(clr, scale = FALSE)

## Explore results
viz_individuals(X, highlight = get_groups(coda), pch = 16)
viz_variables(X)
</code></pre>

<hr>
<h2 id='perturbation'>Perturbation Operation</h2><span id='topic+perturbation'></span><span id='topic+perturbation-method'></span><span id='topic+perturbation+2Cnumeric+2Cnumeric-method'></span><span id='topic+perturbation+2CCompositionMatrix+2Cnumeric-method'></span><span id='topic+perturbation+2CCompositionMatrix+2Cmatrix-method'></span><span id='topic+perturbation+2CCompositionMatrix+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Perturbation of two compositions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perturbation(x, y, ...)

## S4 method for signature 'numeric,numeric'
perturbation(x, y)

## S4 method for signature 'CompositionMatrix,numeric'
perturbation(x, y)

## S4 method for signature 'CompositionMatrix,matrix'
perturbation(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perturbation_+3A_x">x</code>, <code id="perturbation_+3A_y">y</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of compositional data or a
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="perturbation_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In compositional geometry, perturbation plays the role of sum (translation).
It is the closed component-wise product of two compositions.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+arithmetic">arithmetic</a></code>,
<code><a href="#topic+closure">closure</a>()</code>,
<code><a href="#topic+powering">powering</a>()</code>,
<code><a href="#topic+scalar">scalar</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='petrography'>Can Sora Petrographic Data</h2><span id='topic+petrography'></span>

<h3>Description</h3>

<p>Can Sora Petrographic Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>petrography
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 21 variables:
</p>

<dl>
<dt>VAR1</dt><dd><p>Optical activity.</p>
</dd>
<dt>VAR2</dt><dd><p>Inclusion orientation.</p>
</dd>
<dt>VAR3</dt><dd><p>Void orientation.</p>
</dd>
<dt>VAR4</dt><dd><p>Texture.</p>
</dd>
<dt>VAR5</dt><dd><p>Special components.</p>
</dd>
<dt>VAR6</dt><dd><p>Plutonic rocks.</p>
</dd>
<dt>VAR7</dt><dd><p>Volcanic rocks.</p>
</dd>
<dt>VAR8</dt><dd><p>Metamorphic rocks.</p>
</dd>
<dt>VAR9</dt><dd><p>Sedimentary rocks.</p>
</dd>
<dt>VAR10</dt><dd><p>Quartz.</p>
</dd>
<dt>VAR11</dt><dd><p>Feldspar.</p>
</dd>
<dt>VAR12</dt><dd><p>Plagioclase.</p>
</dd>
<dt>VAR13</dt><dd><p>Pyroxenes.</p>
</dd>
<dt>VAR14</dt><dd><p>Amphiboles.</p>
</dd>
<dt>VAR15</dt><dd><p>Micas.</p>
</dd>
<dt>VAR16</dt><dd><p>Phyllosilicates.</p>
</dd>
<dt>VAR17</dt><dd><p>Carbonates.</p>
</dd>
<dt>VAR18</dt><dd><p>Other constituents.</p>
</dd>
<dt>VAR19</dt><dd><p>Packing.</p>
</dd>
</dl>



<h3>References</h3>

<p>Cau, M.-A., Day, P. M., Baxter, M. J., Papageorgiou, I., Iliopoulos, I. &amp;
Montana, G. (2004). Exploring Automatic Grouping Procedures in Ceramic
Petrology. <em>Journal of Archaeological Science</em>, 31(9): 1325-1338.
<a href="https://doi.org/10.1016/j.jas.2004.03.006">doi:10.1016/j.jas.2004.03.006</a>.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+chemistry">chemistry</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='plot'>Plot Compositional Data</h2><span id='topic+plot'></span><span id='topic+plot+2CCompositionMatrix+2Cmissing-method'></span>

<h3>Description</h3>

<p>Displays a matrix of ternary plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix,missing'
plot(x, ..., margin = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Further <a href="graphics.html#topic+par">graphical parameters</a>.</p>
</td></tr>
<tr><td><code id="plot_+3A_margin">margin</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string or an <code><a href="base.html#topic+integer">integer</a></code> giving the index of
the column to be used as the third part of the ternary plots. If <code>NULL</code>
(the default), marginal compositions will be used (i.e. the geometric mean
of the non-selected parts).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="isopleuros.html#topic+ternary_pairs">isopleuros::ternary_pairs()</a></code>, <code><a href="isopleuros.html#topic+ternary_plot">isopleuros::ternary_plot()</a></code>
</p>
<p>Other plot methods: 
<code><a href="#topic+as_graph">as_graph</a>()</code>,
<code><a href="#topic+barplot">barplot</a>()</code>,
<code><a href="#topic+hist">hist</a>()</code>,
<code><a href="#topic+plot_logratio">plot_logratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Ternary plots
plot(coda)
</code></pre>

<hr>
<h2 id='plot_logratio'>Plot Log-Ratios</h2><span id='topic+plot_logratio'></span><span id='topic+plot+2CLogRatio+2Cmissing-method'></span>

<h3>Description</h3>

<p>Displays a density plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'LogRatio,missing'
plot(
  x,
  ...,
  order = NULL,
  decreasing = FALSE,
  groups = get_groups(x),
  rug = TRUE,
  ticksize = 0.05,
  ncol = NULL,
  flip = FALSE,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  ann = graphics::par("ann"),
  axes = TRUE,
  frame.plot = axes,
  legend = list(x = "topright")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_logratio_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object.</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_...">...</code></td>
<td>
<p>Further <a href="graphics.html#topic+par">graphical parameters</a>, particularly,
<code>border</code> and <code>col</code>.</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_order">order</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the ratio be ordered?</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_decreasing">decreasing</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the sort order be increasing
or decreasing?</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_groups">groups</code></td>
<td>
<p>A <code><a href="base.html#topic+factor">factor</a></code> in the sense that <code><a href="base.html#topic+as.factor">as.factor(groups)</a></code>
defines the grouping. If set, a matrix of panels defined by <code>groups</code> will be
drawn.</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_rug">rug</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a <em>rug</em> representation (1-d plot) of
the data be added to the plot?</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_ticksize">ticksize</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the length of the
ticks making up the <em>rug</em>. Positive lengths give inwards ticks. Only used if
<code>rug</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_ncol">ncol</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> specifying the number of columns to use when
<code>facet</code> is &quot;<code>multiple</code>&quot;. Defaults to 1 for up to 4 series, otherwise to 2.</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_flip">flip</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the y-axis (ticks and numbering) be
flipped from side 2 (left) to 4 (right) from variable to variable?</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_xlab">xlab</code>, <code id="plot_logratio_+3A_ylab">ylab</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the x and y axis labels.</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_main">main</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a main title for the plot.</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_ann">ann</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the default annotation (title and x
and y axis labels) appear on the plot?</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_axes">axes</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should axes be drawn on the plot?</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_frame.plot">frame.plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a box be drawn around the
plot?</p>
</td></tr>
<tr><td><code id="plot_logratio_+3A_legend">legend</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> of additional arguments to be passed to
<code><a href="graphics.html#topic+legend">graphics::legend()</a></code>; names of the list are used as argument names.
If <code>NULL</code>, no legend is displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other plot methods: 
<code><a href="#topic+as_graph">as_graph</a>()</code>,
<code><a href="#topic+barplot">barplot</a>()</code>,
<code><a href="#topic+hist">hist</a>()</code>,
<code><a href="#topic+plot">plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Use ceramic types for grouping

## Log ratio
clr &lt;- transform_clr(coda)
plot(clr, group = NULL, flip = TRUE, border = "black", col = NA)
plot(clr, flip = TRUE)
</code></pre>

<hr>
<h2 id='plot_outliers'>Plot Outliers</h2><span id='topic+plot_outliers'></span><span id='topic+plot+2COutlierIndex+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot Outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'OutlierIndex,missing'
plot(
  x,
  ...,
  qq = FALSE,
  probs = c(0.25, 0.75),
  ncol = NULL,
  flip = FALSE,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  sub = NULL,
  ann = graphics::par("ann"),
  axes = TRUE,
  frame.plot = axes,
  panel.first = NULL,
  panel.last = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_outliers_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+OutlierIndex-class">OutlierIndex</a></code> object.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_...">...</code></td>
<td>
<p>Further <a href="graphics.html#topic+par">graphical parameters</a>.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_qq">qq</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a quantile-quantile plot be produced?</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_probs">probs</code></td>
<td>
<p>A length-two <code><a href="base.html#topic+numeric">numeric</a></code> vector representing probabilities.
Corresponding quantile pairs define the line drawn (see <code><a href="stats.html#topic+qqnorm">stats::qqline()</a></code>).
Only used if <code>qq</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_ncol">ncol</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> specifying the number of columns to use when
<code>facet</code> is &quot;<code>multiple</code>&quot;. Defaults to 1 for up to 4 series, otherwise to 2.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_flip">flip</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the y-axis (ticks and numbering) be
flipped from side 2 (left) to 4 (right) from group to group?</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_xlab">xlab</code>, <code id="plot_outliers_+3A_ylab">ylab</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the x and y axis labels.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_main">main</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a main title for the plot.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_sub">sub</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a subtitle for the plot.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_ann">ann</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the default annotation (title and x
and y axis labels) appear on the plot?</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_axes">axes</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should axes be drawn on the plot?</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_frame.plot">frame.plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a box be drawn around the
plot?</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_panel.first">panel.first</code></td>
<td>
<p>An an <code>expression</code> to be evaluated after the plot axes are
set up but before any plotting takes place. This can be useful for drawing
background grids.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_panel.last">panel.last</code></td>
<td>
<p>An <code>expression</code> to be evaluated after plotting has taken
place but before the axes, title and box are added.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Garrett, R. G. &amp; Reimann, C. (2005). Multivariate outlier
detection in exploration geochemistry. <em>Computers &amp; Geosciences</em>,
31(5), 579-587. <a href="https://doi.org/10.1016/j.cageo.2004.11.013">doi:10.1016/j.cageo.2004.11.013</a>.
</p>
<p>Filzmoser, P. &amp; Hron, K. (2008). Outlier Detection for Compositional Data
Using Robust Methods. <em>Mathematical Geosciences</em>, 40(3), 233-248.
<a href="https://doi.org/10.1007/s11004-007-9141-5">doi:10.1007/s11004-007-9141-5</a>.
</p>
<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2012). Interpretation of multivariate
outliers for compositional data. <em>Computers &amp; Geosciences</em>, 39, 77-85.
<a href="https://doi.org/10.1016/j.cageo.2011.06.014">doi:10.1016/j.cageo.2011.06.014</a>.
</p>


<h3>See Also</h3>

<p>Other outlier detection methods: 
<code><a href="#topic+outliers">outliers</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Use ceramic types for grouping

## Detect outliers
out &lt;- outliers(coda, groups = NULL, robust = FALSE)

plot(out) # Plot
plot(out, qq = TRUE) # Quantile-Quantile plot

## Detect outliers by group
out &lt;- outliers(coda[, 1:15, drop = FALSE])

plot(out, ncol = 2) # Plot
plot(out, qq = TRUE, ncol = 4) # Quantile-Quantile plot
</code></pre>

<hr>
<h2 id='powering'>Powering Operation</h2><span id='topic+powering'></span><span id='topic+powering-method'></span><span id='topic+powering+2Cnumeric+2Cnumeric-method'></span><span id='topic+powering+2CCompositionMatrix+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Perturbation of two compositions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powering(x, a, ...)

## S4 method for signature 'numeric,numeric'
powering(x, a)

## S4 method for signature 'CompositionMatrix,numeric'
powering(x, a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powering_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of compositional data or a
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="powering_+3A_a">a</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> constant.</p>
</td></tr>
<tr><td><code id="powering_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In compositional geometry, powering replaces the product of a vector by a
scalar (scaling) and is defined as the closed powering of the components by
a given scalar.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+arithmetic">arithmetic</a></code>,
<code><a href="#topic+closure">closure</a>()</code>,
<code><a href="#topic+perturbation">perturbation</a>()</code>,
<code><a href="#topic+scalar">scalar</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='quantile'>Sample Quantiles</h2><span id='topic+quantile'></span><span id='topic+quantile+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Sample Quantiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
quantile(x, ..., probs = seq(0, 1, 0.25), na.rm = FALSE, names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="quantile_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="quantile_+3A_probs">probs</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of probabilities with values in <code class="reqn">[0,1]</code>.</p>
</td></tr>
<tr><td><code id="quantile_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should missing values be removed?</p>
</td></tr>
<tr><td><code id="quantile_+3A_names">names</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should results be named?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2009). Univariate Statistical
Analysis of Environmental (Compositional) Data: Problems and Possibilities.
<em>Science of The Total Environment</em>, 407(23): 6100-6108.
<a href="https://doi.org/10.1016/j.scitotenv.2009.08.008">doi:10.1016/j.scitotenv.2009.08.008</a>.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Mean
mean(coda)

## Quantile
quantile(coda)

## Metric variance
metric_var(coda)

## Metric standard deviation
metric_sd(coda)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+remove_NA'></span><span id='topic+remove_zero'></span><span id='topic+remove_constant'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>arkhe</dt><dd><p><code><a href="arkhe.html#topic+remove_NA">remove_NA</a></code>, <code><a href="arkhe.html#topic+remove_constant">remove_constant</a></code>, <code><a href="arkhe.html#topic+remove_zero">remove_zero</a></code></p>
</dd>
</dl>

<hr>
<h2 id='replace_NA'>Missing Values Replacement</h2><span id='topic+replace_NA'></span><span id='topic+replace_NA+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Multiplicative replacement of missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
replace_NA(x, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_NA_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="replace_NA_+3A_value">value</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the replacement values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object, where all missing values have been
replaced.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Martín-Fernández, J. A., Barceló-Vidal, C. &amp; Pawlowsky-Glahn, V. (2003).
Dealing with Zeros and Missing Values in Compositional Data Sets Using
Nonparametric Imputation. <em>Mathematical Geology</em>, 35(3): 253-278.
<a href="https://doi.org/10.1023/A%3A1023866030544">doi:10.1023/A:1023866030544</a>.
</p>


<h3>See Also</h3>

<p>Other imputation methods: 
<code><a href="#topic+missing">missing</a></code>,
<code><a href="#topic+replace_zero">replace_zero</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Martín-Fernández et al. 2003
X &lt;- data.frame(
  X1 = c(0.0000, 0.1304, 0.1963),
  X2 = c(0.1250, 0.3151, NA),
  X3 = c(0.1237, NA, NA),
  X4 = c(0.7253, 0.2002, 0.0819),
  X5 = c(0.0260, 0.3543, 0.0114)
)

## Coerce to a compositional matrix
Y &lt;- as_composition(X)

## Replace zeros
Z &lt;- replace_NA(Y, value = 0.2)
Z
</code></pre>

<hr>
<h2 id='replace_zero'>Zero-Replacement</h2><span id='topic+replace_zero'></span><span id='topic+replace_zero+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Multiplicative replacement of zeros.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
replace_zero(x, value, delta = 2/3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_zero_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="replace_zero_+3A_value">value</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the detection limits of each part
(in <code class="reqn">(0,1)</code>).</p>
</td></tr>
<tr><td><code id="replace_zero_+3A_delta">delta</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the fraction of the detection
limit to be used in replacement.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object, where all zero values have been
replaced.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Martín-Fernández, J. A., Barceló-Vidal, C. &amp; Pawlowsky-Glahn, V. (2003).
Dealing with Zeros and Missing Values in Compositional Data Sets Using
Nonparametric Imputation. <em>Mathematical Geology</em>, 35(3): 253-278.
<a href="https://doi.org/10.1023/A%3A1023866030544">doi:10.1023/A:1023866030544</a>.
</p>


<h3>See Also</h3>

<p>Other imputation methods: 
<code><a href="#topic+missing">missing</a></code>,
<code><a href="#topic+replace_NA">replace_NA</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Martín-Fernández et al. 2003
X &lt;- data.frame(
  X1 = c(0.0000, 0.1304, 0.1963),
  X2 = c(0.1250, 0.3151, NA),
  X3 = c(0.1237, NA, NA),
  X4 = c(0.7253, 0.2002, 0.0819),
  X5 = c(0.0260, 0.3543, 0.0114)
)

## Coerce to a compositional matrix
Y &lt;- as_composition(X)

## Replace zeros
Z &lt;- replace_zero(Y, value = 0.02, delta = 2/3)
Z
</code></pre>

<hr>
<h2 id='samples'>Working With Samples</h2><span id='topic+samples'></span><span id='topic+any_replicated'></span><span id='topic+any_replicated-method'></span><span id='topic+is_replicated'></span><span id='topic+is_replicated-method'></span><span id='topic+get_samples'></span><span id='topic+get_samples-method'></span><span id='topic+set_samples+3C-'></span><span id='topic+set_samples-method'></span><span id='topic+is_replicated+2CCompositionMatrix-method'></span><span id='topic+is_replicated+2CLogRatio-method'></span><span id='topic+is_replicated+2COutlierIndex-method'></span><span id='topic+any_replicated+2CCompositionMatrix-method'></span><span id='topic+any_replicated+2CLogRatio-method'></span><span id='topic+any_replicated+2COutlierIndex-method'></span><span id='topic+get_samples+2CCompositionMatrix-method'></span><span id='topic+get_samples+2CLogRatio-method'></span><span id='topic+get_samples+2COutlierIndex-method'></span><span id='topic+set_samples+3C-+2CCompositionMatrix-method'></span><span id='topic+set_samples+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Retrieves or defines the sample names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>any_replicated(x)

is_replicated(x)

get_samples(x)

set_samples(x) &lt;- value

## S4 method for signature 'CompositionMatrix'
is_replicated(x)

## S4 method for signature 'LogRatio'
is_replicated(x)

## S4 method for signature 'OutlierIndex'
is_replicated(x)

## S4 method for signature 'CompositionMatrix'
any_replicated(x)

## S4 method for signature 'LogRatio'
any_replicated(x)

## S4 method for signature 'OutlierIndex'
any_replicated(x)

## S4 method for signature 'CompositionMatrix'
get_samples(x)

## S4 method for signature 'LogRatio'
get_samples(x)

## S4 method for signature 'OutlierIndex'
get_samples(x)

## S4 replacement method for signature 'CompositionMatrix'
set_samples(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samples_+3A_x">x</code></td>
<td>
<p>An object from which to get or set <code>samples</code>.</p>
</td></tr>
<tr><td><code id="samples_+3A_value">value</code></td>
<td>
<p>A possible value for the <code>samples</code> of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In some situations, measurements may have been repeated (e.g. multiple
chemical analyses on the same sample). The presence of repeated
measurements can be specified by giving several observations the same
sample name.
</p>
<p>See <code>vignette("nexus")</code>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>set_samples()</code> returns an object of the same sort as <code>x</code> with the new
sample names assigned.
</p>
</li>
<li> <p><code>get_samples()</code> returns a <code><a href="base.html#topic+character">character</a></code> vector giving the sample names of <code>x</code>.
</p>
</li>
<li> <p><code>any_replicated()</code> returns a <code><a href="base.html#topic+logical">logical</a></code> scalar specifying whether or not
<code>x</code> has replicated observations.
</p>
</li>
<li> <p><code>is_replicated()</code> returns a <code><a href="base.html#topic+logical">logical</a></code> vector specifying whether or not
an observation is a replicate.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+groups">groups</a></code>,
<code><a href="#topic+identifiers">identifiers</a></code>,
<code><a href="#topic+split">split</a>()</code>,
<code><a href="#topic+subset">subset</a>()</code>,
<code><a href="#topic+totals">totals</a></code>
</p>

<hr>
<h2 id='scalar'>Scalar Product</h2><span id='topic+scalar'></span><span id='topic+scalar-method'></span><span id='topic+scalar+2Cnumeric+2Cnumeric-method'></span><span id='topic+scalar+2CCompositionMatrix+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes the Aitchison scalar product of two compositions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scalar(x, y, ...)

## S4 method for signature 'numeric,numeric'
scalar(x, y)

## S4 method for signature 'CompositionMatrix,CompositionMatrix'
scalar(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scalar_+3A_x">x</code>, <code id="scalar_+3A_y">y</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="scalar_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+arithmetic">arithmetic</a></code>,
<code><a href="#topic+closure">closure</a>()</code>,
<code><a href="#topic+perturbation">perturbation</a>()</code>,
<code><a href="#topic+powering">powering</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='scale'>Scaling and Centering of Compositional Data</h2><span id='topic+scale'></span><span id='topic+scale+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Scaling and Centering of Compositional Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
scale(x, center = TRUE, scale = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="scale_+3A_center">center</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar or a <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the center
to be substracted.</p>
</td></tr>
<tr><td><code id="scale_+3A_scale">scale</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar or a length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving a
scaling factor for multiplication.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Boogaart, K. G. van den &amp; Tolosana-Delgado, R. (2013). <em>Analyzing
Compositional Data with R</em>. Berlin Heidelberg: Springer-Verlag.
<a href="https://doi.org/10.1007/978-3-642-36809-7">doi:10.1007/978-3-642-36809-7</a>.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Center and scale
scaled &lt;- scale(coda, center = TRUE, scale = TRUE)
mean(scaled)
head(scaled)
</code></pre>

<hr>
<h2 id='slides'>Thin Sections</h2><span id='topic+slides'></span>

<h3>Description</h3>

<p>Mineral compositions of five slides as reported by five analysts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slides
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 9 variables:
</p>

<dl>
<dt>analyst</dt><dd><p>Analyst number.</p>
</dd>
<dt>slide</dt><dd><p>Slide number.</p>
</dd>
<dt>quartz</dt><dd><p>Quartz (percent).</p>
</dd>
<dt>microcline</dt><dd><p>Microcline (percent).</p>
</dd>
<dt>plagioclass</dt><dd><p>Plagioclass (percent).</p>
</dd>
<dt>biotite</dt><dd><p>Biotite (percent).</p>
</dd>
<dt>plagioclass</dt><dd><p>Plagioclass (percent).</p>
</dd>
<dt>muscovite</dt><dd><p>Muscovite (percent).</p>
</dd>
<dt>opaques</dt><dd><p>Opaque minerals (percent).</p>
</dd>
<dt>nonopaques</dt><dd><p>Non-opaque minerals (percent).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+chemistry">chemistry</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+petrography">petrography</a></code>
</p>

<hr>
<h2 id='split'>Divide into Groups</h2><span id='topic+split'></span><span id='topic+split+2CCompositionMatrix-method'></span><span id='topic+split+2CLogRatio-method'></span>

<h3>Description</h3>

<p>Divides the compositional matrix <code>x</code> into the groups defined by <code>f</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
split(x, f, drop = FALSE, ...)

## S4 method for signature 'LogRatio'
split(x, f, drop = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="split_+3A_f">f</code></td>
<td>
<p>A 'factor' in the sense that <code><a href="base.html#topic+as.factor">as.factor(f)</a></code> defines
the grouping, or a list of such factors in which case their interaction is
used for the grouping (see <code><a href="base.html#topic+split">base::split()</a></code>).</p>
</td></tr>
<tr><td><code id="split_+3A_drop">drop</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should levels that do not occur be dropped?</p>
</td></tr>
<tr><td><code id="split_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+groups">groups</a></code>,
<code><a href="#topic+identifiers">identifiers</a></code>,
<code><a href="#topic+samples">samples</a></code>,
<code><a href="#topic+subset">subset</a>()</code>,
<code><a href="#topic+totals">totals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a data.frame
X &lt;- data.frame(
  samples = c("A", "A", "A", "B", "B", "B", "C", "C", "C"),
  groups = c("X", "X", "X", "X", NA, NA, "Y", "Y", "Y"),
  Ca = c(7.72, 7.32, 3.11, 7.19, 7.41, 5, 4.18, 1, 4.51),
  Fe = c(6.12, 5.88, 5.12, 6.18, 6.02, 7.14, 5.25, 5.28, 5.72),
  Na = c(0.97, 1.59, 1.25, 0.86, 0.76, 0.51, 0.75, 0.52, 0.56)
)

## Coerce to a compositional matrix
Y &lt;- as_composition(X)

## Split by group
split(Y, f = get_groups(Y))

## Split by sample
split(Y, f = get_samples(Y))
</code></pre>

<hr>
<h2 id='subset'>Extract or Replace Parts of an Object</h2><span id='topic+subset'></span><span id='topic++5B+2CCompositionMatrix+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic++5B+2CCompositionMatrix+2Cmissing+2Cmissing+2Clogical-method'></span><span id='topic++5B+2CCompositionMatrix+2Cindex+2Cmissing+2Cmissing-method'></span><span id='topic++5B+2CCompositionMatrix+2Cindex+2Cmissing+2Clogical-method'></span><span id='topic++5B+2CCompositionMatrix+2Cmissing+2Cindex+2Cmissing-method'></span><span id='topic++5B+2CCompositionMatrix+2Cmissing+2Cindex+2Clogical-method'></span><span id='topic++5B+2CCompositionMatrix+2Cindex+2Cindex+2Cmissing-method'></span><span id='topic++5B+2CCompositionMatrix+2Cindex+2Cindex+2Clogical-method'></span><span id='topic++5B+5B+2COutlierIndex+2Cindex+2CANY-method'></span><span id='topic++5B+5B+2COutlierIndex-method'></span><span id='topic++5B+3C-+2CCompositionMatrix-method'></span><span id='topic++5B+5B+3C-+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Operators acting on objects to extract or replace parts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix,missing,missing,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,missing,missing,logical'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,index,missing,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,index,missing,logical'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,missing,index,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,missing,index,logical'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,index,index,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,index,index,logical'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'OutlierIndex,index,ANY'
x[[i]]

## S4 replacement method for signature 'CompositionMatrix'
x[i, j, ...] &lt;- value

## S4 replacement method for signature 'CompositionMatrix'
x[[i, j, ...]] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_+3A_x">x</code></td>
<td>
<p>An object from which to extract element(s) or in which to replace
element(s).</p>
</td></tr>
<tr><td><code id="subset_+3A_i">i</code>, <code id="subset_+3A_j">j</code></td>
<td>
<p>Indices specifying elements to extract or replace. Indices are
<code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+integer">integer</a></code> or <code><a href="base.html#topic+character">character</a></code> vectors or empty (missing) or
<code>NULL</code>. Numeric values are coerced to <code><a href="base.html#topic+integer">integer</a></code> as by <code><a href="base.html#topic+as.integer">as.integer()</a></code>.
Character vectors will be matched to the name of the elements.
An empty index (a comma separated blank) indicates that all entries in that
dimension are selected.</p>
</td></tr>
<tr><td><code id="subset_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="subset_+3A_drop">drop</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the result be coerced to
the lowest possible dimension? This only works for extracting elements,
not for the replacement.</p>
</td></tr>
<tr><td><code id="subset_+3A_value">value</code></td>
<td>
<p>A possible value for the element(s) of <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subsetted object of the same sort as <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+groups">groups</a></code>,
<code><a href="#topic+identifiers">identifiers</a></code>,
<code><a href="#topic+samples">samples</a></code>,
<code><a href="#topic+split">split</a>()</code>,
<code><a href="#topic+totals">totals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)
head(coda)

## Subset
coda[[1, 1]] # Get the first value
coda[1] # Get the first value
coda[, ] # Get all values
coda[1, , drop = FALSE] # Get the first row

## Subcomposition
subcoda &lt;- coda[, 1:3, drop = FALSE] # Get the first three column
head(subcoda)
</code></pre>

<hr>
<h2 id='totals'>Row Sums</h2><span id='topic+totals'></span><span id='topic+get_totals'></span><span id='topic+get_totals-method'></span><span id='topic+set_totals+3C-'></span><span id='topic+set_totals-method'></span><span id='topic+get_totals+2CCompositionMatrix-method'></span><span id='topic+set_totals+3C-+2CCompositionMatrix-method'></span><span id='topic+set_totals+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Retrieves or defines the row sums (before closure).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_totals(x)

set_totals(x) &lt;- value

## S4 method for signature 'CompositionMatrix'
get_totals(x)

## S4 replacement method for signature 'CompositionMatrix'
set_totals(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="totals_+3A_x">x</code></td>
<td>
<p>An object from which to get or set <code>totals</code>.</p>
</td></tr>
<tr><td><code id="totals_+3A_value">value</code></td>
<td>
<p>A possible value for the <code>totals</code> of <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>set_totals()</code> returns an object of the same sort as <code>x</code> with the new
row sums assigned.
</p>
</li>
<li> <p><code>get_totals()</code> returns the row sums of <code>x</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+groups">groups</a></code>,
<code><a href="#topic+identifiers">identifiers</a></code>,
<code><a href="#topic+samples">samples</a></code>,
<code><a href="#topic+split">split</a>()</code>,
<code><a href="#topic+subset">subset</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a count matrix
A1 &lt;- matrix(data = as.numeric(sample(1:100, 100, TRUE)), nrow = 20)

## Coerce to compositions
B &lt;- as_composition(A1)

## Row sums are internally stored before coercing to relative frequencies
get_totals(B)

## This allows to restore the source data
A2 &lt;- as_amounts(B)

## Coerce to a data.frame
X &lt;- data.frame(B)
head(X)
</code></pre>

<hr>
<h2 id='transform_alr'>Additive Log-Ratios (ALR)</h2><span id='topic+transform_alr'></span><span id='topic+transform_alr-method'></span><span id='topic+transform_alr+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes ALR transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_alr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_alr(object, j = ncol(object))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_alr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_alr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="transform_alr_+3A_j">j</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the index of the rationing part (denominator).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ALR transformation is the logratio of a pair of parts with respect to a
fixed part.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+ALR-class">ALR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)

## Centered log-ratio
clr &lt;- transform_clr(coda)

## Additive log-ratio
alr &lt;- transform_alr(coda)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_clr &lt;- transform_inverse(clr)
all.equal(coda, inv_clr)

inv_alr &lt;- transform_inverse(alr)
all.equal(coda, inv_alr)

inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='transform_clr'>Centered Log-Ratios (CLR)</h2><span id='topic+transform_clr'></span><span id='topic+transform_clr-method'></span><span id='topic+transform_clr+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes CLR transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_clr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_clr(object, weights = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_clr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_clr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="transform_clr_+3A_weights">weights</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: sould a varying weight be used. If
<code>FALSE</code> (the default), equally-weighted parts are used. Alternatively, a
positive <code><a href="base.html#topic+numeric">numeric</a></code> vector of weights can be specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CLR transformation computes the log of each part relative to the
geometric mean of all parts.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+CLR-class">CLR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)

## Centered log-ratio
clr &lt;- transform_clr(coda)

## Additive log-ratio
alr &lt;- transform_alr(coda)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_clr &lt;- transform_inverse(clr)
all.equal(coda, inv_clr)

inv_alr &lt;- transform_inverse(alr)
all.equal(coda, inv_alr)

inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='transform_ilr'>Isometric Log-Ratios (ILR)</h2><span id='topic+transform_ilr'></span><span id='topic+transform_ilr-method'></span><span id='topic+transform_ilr+2CCompositionMatrix+2Cmissing-method'></span><span id='topic+transform_ilr+2CCompositionMatrix+2Cmatrix-method'></span>

<h3>Description</h3>

<p>Computes ILR transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_ilr(object, base, ...)

## S4 method for signature 'CompositionMatrix,missing'
transform_ilr(object)

## S4 method for signature 'CompositionMatrix,matrix'
transform_ilr(object, base)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_ilr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_ilr_+3A_base">base</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> giving the base of the transformation.</p>
</td></tr>
<tr><td><code id="transform_ilr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ILR transformation provides the coordinates of any composition with
respect to a given orthonormal basis. <code>transform_ilr()</code> uses the orthonormal
basis (Helmert matrix) originally defined by Egozcue <em>et al.</em> (2003).
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+ILR-class">ILR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Egozcue, J. J., Pawlowsky-Glahn, V., Mateu-Figueras, G. &amp; Barceló-Vidal, C.
(2003). Isometric Logratio Transformations for Compositional Data Analysis.
<em>Mathematical Geology</em>, 35(3), 279-300. <a href="https://doi.org/10.1023/A%3A1023818214614">doi:10.1023/A:1023818214614</a>.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)

## Centered log-ratio
clr &lt;- transform_clr(coda)

## Additive log-ratio
alr &lt;- transform_alr(coda)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_clr &lt;- transform_inverse(clr)
all.equal(coda, inv_clr)

inv_alr &lt;- transform_inverse(alr)
all.equal(coda, inv_alr)

inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='transform_inverse'>Inverse Log-Ratio Transformation</h2><span id='topic+transform_inverse'></span><span id='topic+transform_inverse-method'></span><span id='topic+transform_inverse+2CCLR+2Cmissing-method'></span><span id='topic+transform_inverse+2CALR+2Cmissing-method'></span><span id='topic+transform_inverse+2CILR+2Cmissing-method'></span><span id='topic+transform_inverse+2Cmatrix+2CILR-method'></span>

<h3>Description</h3>

<p>Computes inverse log-ratio transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_inverse(object, origin, ...)

## S4 method for signature 'CLR,missing'
transform_inverse(object)

## S4 method for signature 'ALR,missing'
transform_inverse(object)

## S4 method for signature 'ILR,missing'
transform_inverse(object)

## S4 method for signature 'matrix,ILR'
transform_inverse(object, origin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_inverse_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_inverse_+3A_origin">origin</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object to be used for the inverse
transformation.</p>
</td></tr>
<tr><td><code id="transform_inverse_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Egozcue, J. J., Pawlowsky-Glahn, V., Mateu-Figueras, G. &amp; Barceló-Vidal, C.
(2003). Isometric Logratio Transformations for Compositional Data Analysis.
<em>Mathematical Geology</em>, 35(3), 279-300. <a href="https://doi.org/10.1023/A%3A1023818214614">doi:10.1023/A:1023818214614</a>.
</p>
<p>Fišerová, E. &amp; Hron, K. (2011). On the Interpretation of Orthonormal
Coordinates for Compositional Data. <em>Mathematical Geosciences</em>, 43(4),
455‑468. <a href="https://doi.org/10.1007/s11004-011-9333-x">doi:10.1007/s11004-011-9333-x</a>.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)

## Centered log-ratio
clr &lt;- transform_clr(coda)

## Additive log-ratio
alr &lt;- transform_alr(coda)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_clr &lt;- transform_inverse(clr)
all.equal(coda, inv_clr)

inv_alr &lt;- transform_inverse(alr)
all.equal(coda, inv_alr)

inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='transform_lr'>Pairwise Log-Ratios (LR)</h2><span id='topic+transform_lr'></span><span id='topic+transform_lr-method'></span><span id='topic+transform_lr+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes all pairwise log-ratio transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_lr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_lr(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_lr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_lr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+LR-class">LR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)

## Centered log-ratio
clr &lt;- transform_clr(coda)

## Additive log-ratio
alr &lt;- transform_alr(coda)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_clr &lt;- transform_inverse(clr)
all.equal(coda, inv_clr)

inv_alr &lt;- transform_inverse(alr)
all.equal(coda, inv_alr)

inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='transform_plr'>Pivot Log-Ratios (PLR)</h2><span id='topic+transform_plr'></span><span id='topic+transform_plr-method'></span><span id='topic+transform_plr+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes PLR transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_plr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_plr(object, pivot = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_plr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_plr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="transform_plr_+3A_pivot">pivot</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the index of the pivotal variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+PLR-class">PLR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Fišerová, E. &amp; Hron, K. (2011). On the Interpretation of Orthonormal
Coordinates for Compositional Data. <em>Mathematical Geosciences</em>, 43(4),
455‑468. <a href="https://doi.org/10.1007/s11004-011-9333-x">doi:10.1007/s11004-011-9333-x</a>.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>
<p>Hron, K., Filzmoser, P., de Caritat, P., Fišerová, E. &amp; Gardlo, A. (2017).
Weighted Pivot Coordinates for Compositional Data and Their Application to
Geochemical Mapping. <em>Mathematical Geosciences</em>, 49(6), 797-814.
<a href="https://doi.org/10.1007/s11004-017-9684-z">doi:10.1007/s11004-017-9684-z</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)

## Centered log-ratio
clr &lt;- transform_clr(coda)

## Additive log-ratio
alr &lt;- transform_alr(coda)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_clr &lt;- transform_inverse(clr)
all.equal(coda, inv_clr)

inv_alr &lt;- transform_inverse(alr)
all.equal(coda, inv_alr)

inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='variation'>Variation Matrix</h2><span id='topic+variation'></span><span id='topic+variation-method'></span><span id='topic+variation+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes the variation matrix (Aitchison 1986, definition 4.4).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variation(x, ...)

## S4 method for signature 'CompositionMatrix'
variation(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variation_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="variation_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+metric_var">metric_var</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Variation matrix
## (Aitchison 1986, definition 4.4)
(varia &lt;- variation(coda))

## Cluster dendrogram
d &lt;- as.dist(varia)
h &lt;- hclust(d, method = "ward.D2")
plot(h)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
