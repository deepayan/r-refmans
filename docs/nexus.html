<!DOCTYPE html><html lang="en"><head><title>Help for package nexus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nexus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nexus-package'><p>nexus: Sourcing Archaeological Materials by Chemical Composition</p></a></li>
<li><a href='#aggregate'><p>Compute Summary Statistics of Data Subsets</p></a></li>
<li><a href='#arctic'><p>Arctic Lake</p></a></li>
<li><a href='#arithmetic'><p>Operations in the Simplex</p></a></li>
<li><a href='#as_amounts'><p>Coerce to Amounts</p></a></li>
<li><a href='#as_composition'><p>Coerce to a Closed Compositional Matrix</p></a></li>
<li><a href='#as_graph'><p>Graph of Log-ratios</p></a></li>
<li><a href='#as.data.frame'><p>Coerce to a Data Frame</p></a></li>
<li><a href='#barplot'><p>Barplot of Compositional Data</p></a></li>
<li><a href='#bind'><p>Combine Two Composition Matrices</p></a></li>
<li><a href='#boxite'><p>Boxite Mineralogy</p></a></li>
<li><a href='#chemistry'><p>Chemical Elements and Oxides</p></a></li>
<li><a href='#closure'><p>Closure Operation</p></a></li>
<li><a href='#CompositionMatrix-class'><p>Compositional Matrix</p></a></li>
<li><a href='#condense'><p>Compositional Mean of Data Subsets</p></a></li>
<li><a href='#covariance'><p>Covariance Matrix</p></a></li>
<li><a href='#coxite'><p>Coxite Mineralogy</p></a></li>
<li><a href='#describe'><p>Data Description</p></a></li>
<li><a href='#detect_outlier'><p>Outlier Detection</p></a></li>
<li><a href='#dist'><p>Distances</p></a></li>
<li><a href='#gmean'><p>Geometric Mean</p></a></li>
<li><a href='#group'><p>Working With Groups</p></a></li>
<li><a href='#group_extract'><p>Group-based Subset</p></a></li>
<li><a href='#group_metadata'><p>Grouping Metadata</p></a></li>
<li><a href='#group_split'><p>Divide into Groups</p></a></li>
<li><a href='#GroupedComposition-class'><p>Grouped Compositional Matrix</p></a></li>
<li><a href='#GroupedLogRatio-class'><p>Grouped Log-Ratio Matrix</p></a></li>
<li><a href='#hist'><p>Histogram of Compositional Data</p></a></li>
<li><a href='#hongite'><p>Hongite Mineralogy</p></a></li>
<li><a href='#kongite'><p>Kongite Mineralogy</p></a></li>
<li><a href='#lava'><p>Skye Lavas Compositions</p></a></li>
<li><a href='#LogRatio-class'><p>Log-Ratio Matrix</p></a></li>
<li><a href='#mahalanobis'><p>Mahalanobis Distance</p></a></li>
<li><a href='#margin'><p>Marginal Compositions</p></a></li>
<li><a href='#mean'><p>Compositional Mean</p></a></li>
<li><a href='#missing'><p>Missing Values Policy</p></a></li>
<li><a href='#mix'><p>Mixed-Mode Analysis</p></a></li>
<li><a href='#mutators'><p>Get or Set Parts of an Object</p></a></li>
<li><a href='#NumericMatrix-class'><p>Numeric Matrix</p></a></li>
<li><a href='#OutlierIndex-class'><p>Outliers</p></a></li>
<li><a href='#pairs'><p>Plot Compositional Data</p></a></li>
<li><a href='#pca'><p>Principal Components Analysis</p></a></li>
<li><a href='#perturbation'><p>Perturbation Operation</p></a></li>
<li><a href='#pip'><p>Proportionality Index of Parts (PIP)</p></a></li>
<li><a href='#plot'><p>Plot Log-Ratios</p></a></li>
<li><a href='#plot_outlier'><p>Plot Outliers</p></a></li>
<li><a href='#powering'><p>Powering Operation</p></a></li>
<li><a href='#predator'><p>Predator-Prey Compositions</p></a></li>
<li><a href='#quantile'><p>Sample Quantiles</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#ReferenceGroups-class'><p>Grouped Data</p></a></li>
<li><a href='#replace_NA'><p>Missing Values Replacement</p></a></li>
<li><a href='#replace_zero'><p>Zero-Replacement</p></a></li>
<li><a href='#scalar'><p>Scalar Product</p></a></li>
<li><a href='#scale'><p>Scaling and Centering of Compositional Data</p></a></li>
<li><a href='#slides'><p>Thin Sections Compositions</p></a></li>
<li><a href='#subset'><p>Extract or Replace Parts of an Object</p></a></li>
<li><a href='#t'><p>Matrix Transpose</p></a></li>
<li><a href='#totals'><p>Row Sums</p></a></li>
<li><a href='#transform_alr'><p>Additive Log-Ratios (ALR)</p></a></li>
<li><a href='#transform_clr'><p>Centered Log-Ratios (CLR)</p></a></li>
<li><a href='#transform_ilr'><p>Isometric Log-Ratios (ILR)</p></a></li>
<li><a href='#transform_inverse'><p>Inverse Log-Ratio Transformation</p></a></li>
<li><a href='#transform_lr'><p>Pairwise Log-Ratios (LR)</p></a></li>
<li><a href='#transform_plr'><p>Pivot Log-Ratios (PLR)</p></a></li>
<li><a href='#univariate_ilr'><p>Univariate Isometric Log-Ratios (ILR)</p></a></li>
<li><a href='#variance'><p>Log-Ratios Variances</p></a></li>
<li><a href='#variance_total'><p>Total Variance</p></a></li>
<li><a href='#variation'><p>Variation Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Sourcing Archaeological Materials by Chemical Composition</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicolas Frerebeau &lt;nicolas.frerebeau@u-bordeaux-montaigne.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Exploration and analysis of compositional data in the
    framework of Aitchison (1986, ISBN: 978-94-010-8324-9). This package
    provides tools for chemical fingerprinting and source tracking of
    ancient materials.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://packages.tesselle.org/nexus/">https://packages.tesselle.org/nexus/</a>,
<a href="https://github.com/tesselle/nexus">https://github.com/tesselle/nexus</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tesselle/nexus/issues">https://github.com/tesselle/nexus/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), dimensio (&ge; 0.11.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>arkhe (&ge; 1.9.0), graphics, grDevices, isopleuros (&ge; 1.3.0),
khroma (&ge; 1.15.0), methods, MASS, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cluster, folio (&ge; 1.5.0), igraph, knitr, markdown, rsvg,
svglite, tinysnapshot, tinytest</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Collate:</td>
<td>'AllClasses.R' 'AllGenerics.R' 'aggregate.R' 'barplot.R'
'chemistry.R' 'coerce.R' 'condense.R' 'covariance.R' 'data.R'
'describe.R' 'dist.R' 'graph.R' 'group.R' 'hist.R' 'margin.R'
'mean.R' 'mix.R' 'mutators.R' 'nexus-internal.R'
'nexus-package.R' 'outliers.R' 'pairs.R' 'pca.R' 'plot.R'
'quantile.R' 'reexport.R' 'replace.R' 'scale.R' 'show.R'
'simplex.R' 'split.R' 'subset.R' 'summary.R' 'transform_alr.R'
'transform_clr.R' 'transform_ilr.R' 'transform_inverse.R'
'transform_lr.R' 'transform_plr.R' 'validate.R' 'variance.R'
'variation.R' 'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-14 11:52:07 UTC; nicolas</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicolas Frerebeau <a href="https://orcid.org/0000-0001-5759-4944"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Anne Philippe <a href="https://orcid.org/0000-0002-5331-5087"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Brice Lebrun <a href="https://orcid.org/0000-0001-7503-8685"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb] (Logo designer),
  Universit√© Bordeaux Montaigne [fnd],
  CNRS [fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-14 12:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='nexus-package'>nexus: Sourcing Archaeological Materials by Chemical Composition</h2><span id='topic+nexus-package'></span><span id='topic+nexus'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Exploration and analysis of compositional data in the framework of Aitchison (1986, ISBN: 978-94-010-8324-9). This package provides tools for chemical fingerprinting and source tracking of ancient materials.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
<strong>Package:</strong> </td><td style="text-align: left;"> nexus </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Type:</strong> </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Version:</strong> </td><td style="text-align: left;"> 0.4.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>License:</strong> </td><td style="text-align: left;"> GPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Zenodo:</strong> </td><td style="text-align: left;"> <a href="https://doi.org/10.5281/zenodo.10225630">doi:10.5281/zenodo.10225630</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Package options</h3>

<p><span class="pkg">nexus</span> uses the following <code><a href="base.html#topic+options">options()</a></code> to configure behavior:
</p>

<ul>
<li> <p><code>nexus.verbose</code>: a <code><a href="base.html#topic+logical">logical</a></code> scalar. Should <span class="rlang"><b>R</b></span> report extra information
on progress? Defaults to <code><a href="base.html#topic+interactive">interactive()</a></code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Full list of authors and contributors</strong> (alphabetic order)
</p>

<table>
<tr>
 <td style="text-align: left;">
Nicolas Frerebeau </td><td style="text-align: left;"> <em>Universit√© Bordeaux Montaigne, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Brice Lebrun </td><td style="text-align: left;"> <em>Universit√© Bordeaux Montaigne, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Anne Philippe </td><td style="text-align: left;"> <em>Universit√© de Nantes, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Package maintainer</strong>
</p>
<p>Nicolas Frerebeau<br />
<a href="mailto:nicolas.frerebeau@u-bordeaux-montaigne.fr">nicolas.frerebeau@u-bordeaux-montaigne.fr</a>
</p>
<p>Arch√©osciences Bordeaux (UMR 6034)<br />
Maison de l'Arch√©ologie<br />
Universit√© Bordeaux Montaigne<br />
F-33607 Pessac cedex<br />
France
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://packages.tesselle.org/nexus/">https://packages.tesselle.org/nexus/</a>
</p>
</li>
<li> <p><a href="https://github.com/tesselle/nexus">https://github.com/tesselle/nexus</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/tesselle/nexus/issues">https://github.com/tesselle/nexus/issues</a>
</p>
</li></ul>


<hr>
<h2 id='aggregate'>Compute Summary Statistics of Data Subsets</h2><span id='topic+aggregate'></span><span id='topic+aggregate+2CCompositionMatrix-method'></span><span id='topic+aggregate+2CGroupedComposition-method'></span>

<h3>Description</h3>

<p>Splits the data into subsets, computes summary statistics for each, and
returns the result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
aggregate(x, by, FUN, ..., simplify = TRUE, drop = TRUE)

## S4 method for signature 'GroupedComposition'
aggregate(x, FUN, ..., simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aggregate_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="aggregate_+3A_by">by</code></td>
<td>
<p>A <code>vector</code> or a list of grouping elements, each as long as the
variables in <code>x</code> (see <code><a href="#topic+group">group()</a></code>).</p>
</td></tr>
<tr><td><code id="aggregate_+3A_fun">FUN</code></td>
<td>
<p>A <code><a href="base.html#topic+function">function</a></code> to compute the summary statistics.</p>
</td></tr>
<tr><td><code id="aggregate_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="aggregate_+3A_simplify">simplify</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the results be simplified to a
matrix if possible?</p>
</td></tr>
<tr><td><code id="aggregate_+3A_drop">drop</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar indicating whether to drop unused
combinations of grouping values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("slides")

## Coerce to a compositional matrix
coda &lt;- as_composition(slides)

## Compositional mean by slide
aggregate(coda, by = slides$slide, FUN = mean)

## Metric variance by slide
aggregate(coda, by = slides$slide, FUN = variance_total)
</code></pre>

<hr>
<h2 id='arctic'>Arctic Lake</h2><span id='topic+arctic'></span>

<h3>Description</h3>

<p>Sand, silt, clay compositions of 39 sediment samples at different water
depths in an Arctic lake.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arctic
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 4 variables:
</p>

<dl>
<dt><code>sand</code></dt><dd><p>Sand content (percent).</p>
</dd>
<dt><code>silt</code></dt><dd><p>Silt content (percent).</p>
</dd>
<dt><code>clay</code></dt><dd><p>Clay content (percent).</p>
</dd>
<dt><code>depth</code></dt><dd><p>Water depth (m).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+boxite">boxite</a></code>,
<code><a href="#topic+coxite">coxite</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+kongite">kongite</a></code>,
<code><a href="#topic+lava">lava</a></code>,
<code><a href="#topic+predator">predator</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='arithmetic'>Operations in the Simplex</h2><span id='topic+arithmetic'></span><span id='topic++25perturbe+25'></span><span id='topic++60+25perturbe+25+60-method'></span><span id='topic++25power+25'></span><span id='topic++60+25power+25+60-method'></span><span id='topic++25perturbe+25+2CCompositionMatrix+2CCompositionMatrix-method'></span><span id='topic++60+25perturbe+25+60+2CCompositionMatrix+2CCompositionMatrix-method'></span><span id='topic++25power+25+2CCompositionMatrix+2Cnumeric-method'></span><span id='topic++60+25power+25+60+2CCompositionMatrix+2Cnumeric-method'></span><span id='topic++25power+25+2Cnumeric+2CCompositionMatrix-method'></span><span id='topic++60+25power+25+60+2Cnumeric+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Operators performing operations in the simplex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %perturbe% y

x %power% y

## S4 method for signature 'CompositionMatrix,CompositionMatrix'
x %perturbe% y

## S4 method for signature 'CompositionMatrix,numeric'
x %power% y

## S4 method for signature 'numeric,CompositionMatrix'
x %power% y
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arithmetic_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="arithmetic_+3A_y">y</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object or a <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code style="white-space: pre;">&#8288;%perturbe%&#8288;</code></dt><dd><p><a href="#topic+perturbation">Perturbation operation</a>.</p>
</dd>
<dt><code style="white-space: pre;">&#8288;%power%&#8288;</code></dt><dd><p><a href="#topic+powering">Powering operation</a>.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object or a <code><a href="base.html#topic+numeric">numeric</a></code> vector (same as <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+closure">closure</a>()</code>,
<code><a href="#topic+perturbation">perturbation</a>()</code>,
<code><a href="#topic+powering">powering</a>()</code>,
<code><a href="#topic+scalar">scalar</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='as_amounts'>Coerce to Amounts</h2><span id='topic+as_amounts'></span><span id='topic+as_amounts-method'></span><span id='topic+as_amounts+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Coerce to Amounts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_amounts(from, ...)

## S4 method for signature 'CompositionMatrix'
as_amounts(from)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_amounts_+3A_from">from</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="as_amounts_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other compositional data tools: 
<code><a href="#topic+as_composition">as_composition</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a count matrix
A1 &lt;- matrix(data = sample(1:100, 100, TRUE), nrow = 20)

## Coerce to compositions
B &lt;- as_composition(A1)

## Row sums are internally stored before coercing to relative frequencies
totals(B)

## This allows to restore the source data
A2 &lt;- as_amounts(B)

## Coerce to a data.frame
X &lt;- as.data.frame(B)
head(X)
</code></pre>

<hr>
<h2 id='as_composition'>Coerce to a Closed Compositional Matrix</h2><span id='topic+as_composition'></span><span id='topic+as_composition-method'></span><span id='topic+as_composition+2Cnumeric-method'></span><span id='topic+as_composition+2Cmatrix-method'></span><span id='topic+as_composition+2Cdata.frame-method'></span>

<h3>Description</h3>

<p>Coerces an object to a <code>CompositionMatrix</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_composition(from, ...)

## S4 method for signature 'numeric'
as_composition(from)

## S4 method for signature 'matrix'
as_composition(from)

## S4 method for signature 'data.frame'
as_composition(
  from,
  parts = NULL,
  groups = NULL,
  autodetect = TRUE,
  verbose = getOption("nexus.verbose")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_composition_+3A_from">from</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> or <code><a href="base.html#topic+data.frame">data.frame</a></code> to be coerced.</p>
</td></tr>
<tr><td><code id="as_composition_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="as_composition_+3A_parts">parts</code></td>
<td>
<p>A <code>vector</code> giving the index of the column to be used a
compositional parts. If <code>NULL</code> and <code>autodetect</code> is <code>TRUE</code> (the default),
all <code>numeric</code> columns will be used.</p>
</td></tr>
<tr><td><code id="as_composition_+3A_groups">groups</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the index of the column to be used to
group the samples. If <code>NULL</code> (the default), no grouping is stored.</p>
</td></tr>
<tr><td><code id="as_composition_+3A_autodetect">autodetect</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should <code>numeric</code> variables be
automatically used as compositional parts?</p>
</td></tr>
<tr><td><code id="as_composition_+3A_verbose">verbose</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should <span class="rlang"><b>R</b></span> report extra information
on progress?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>vignette("nexus")</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other compositional data tools: 
<code><a href="#topic+as_amounts">as_amounts</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a count matrix
A1 &lt;- matrix(data = sample(1:100, 100, TRUE), nrow = 20)

## Coerce to compositions
B &lt;- as_composition(A1)

## Row sums are internally stored before coercing to relative frequencies
totals(B)

## This allows to restore the source data
A2 &lt;- as_amounts(B)

## Coerce to a data.frame
X &lt;- as.data.frame(B)
head(X)
</code></pre>

<hr>
<h2 id='as_graph'>Graph of Log-ratios</h2><span id='topic+as_graph'></span><span id='topic+as_graph-method'></span><span id='topic+as_graph+2CLR-method'></span><span id='topic+as_graph+2CALR-method'></span><span id='topic+as_graph+2CILR-method'></span>

<h3>Description</h3>

<p>Produces a graph of log-ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_graph(object, ...)

## S4 method for signature 'LR'
as_graph(object)

## S4 method for signature 'ALR'
as_graph(object)

## S4 method for signature 'ILR'
as_graph(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_graph_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object.</p>
</td></tr>
<tr><td><code id="as_graph_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <span class="pkg">igraph</span> graph object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other plot methods: 
<code><a href="#topic+barplot">barplot</a>()</code>,
<code><a href="#topic+hist">hist</a>()</code>,
<code><a href="#topic+pairs">pairs</a>()</code>,
<code><a href="#topic+plot">plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("igraph", quietly = TRUE)) {

library(igraph)

## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)
lr_graph &lt;- as_graph(lr)
plot(lr_graph)

## Additive log-ratio
alr &lt;- transform_alr(coda)
alr_graph &lt;- as_graph(alr)
plot(alr_graph)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
ilr_graph &lt;- as_graph(ilr)
plot(ilr_graph)

plr &lt;- transform_plr(coda)
plr_graph &lt;- as_graph(plr)
plot(plr_graph)

}
</code></pre>

<hr>
<h2 id='as.data.frame'>Coerce to a Data Frame</h2><span id='topic+as.data.frame'></span><span id='topic+as.data.frame+2CCompositionMatrix-method'></span><span id='topic+as.data.frame+2CGroupedComposition-method'></span><span id='topic+as.data.frame+2CLogRatio-method'></span><span id='topic+as.data.frame+2CGroupedLogRatio-method'></span><span id='topic+as.data.frame+2COutlierIndex-method'></span>

<h3>Description</h3>

<p>Coerce to a Data Frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
as.data.frame(x, row.names = rownames(x), optional = FALSE, ...)

## S4 method for signature 'GroupedComposition'
as.data.frame(
  x,
  row.names = rownames(x),
  optional = FALSE,
  ...,
  group_var = ".group"
)

## S4 method for signature 'LogRatio'
as.data.frame(x, row.names = rownames(x), optional = FALSE, ...)

## S4 method for signature 'GroupedLogRatio'
as.data.frame(
  x,
  row.names = rownames(x),
  optional = FALSE,
  ...,
  group_var = ".group"
)

## S4 method for signature 'OutlierIndex'
as.data.frame(x, row.names = rownames(x), optional = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.data.frame_+3A_x">x</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> object (typically, a <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object).</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_row.names">row.names</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the row names for the data
frame, or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_optional">optional</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the names of the variables in
the data frame be checked? If <code>FALSE</code> then the names of the variables in the
data frame are checked to ensure that they are syntactically valid variable
names and are not duplicated.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_group_var">group_var</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the name of the column to
create for group attribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+mutators">mutators</a></code>,
<code><a href="#topic+totals">totals</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a count matrix
A1 &lt;- matrix(data = sample(1:100, 100, TRUE), nrow = 20)

## Coerce to compositions
B &lt;- as_composition(A1)

## Row sums are internally stored before coercing to relative frequencies
totals(B)

## This allows to restore the source data
A2 &lt;- as_amounts(B)

## Coerce to a data.frame
X &lt;- as.data.frame(B)
head(X)
</code></pre>

<hr>
<h2 id='barplot'>Barplot of Compositional Data</h2><span id='topic+barplot'></span><span id='topic+barplot+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Displays a compositional bar chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
barplot(
  height,
  ...,
  order_columns = FALSE,
  order_rows = NULL,
  decreasing = TRUE,
  space = 0.2,
  offset = 0.025,
  palette_color = palette_color_discrete(),
  border = NA,
  axes = TRUE,
  legend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="barplot_+3A_height">height</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="barplot_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
<tr><td><code id="barplot_+3A_order_columns">order_columns</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should should columns be reorderd?</p>
</td></tr>
<tr><td><code id="barplot_+3A_order_rows">order_rows</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> vector giving the index of the column to be
used for the ordering of the data.</p>
</td></tr>
<tr><td><code id="barplot_+3A_decreasing">decreasing</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the sort order of rows be
increasing or decreasing?</p>
</td></tr>
<tr><td><code id="barplot_+3A_space">space</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the the amount of space
(as a fraction of the width of a bar) left between each bar
(defaults to <code class="reqn">0.2</code>).</p>
</td></tr>
<tr><td><code id="barplot_+3A_offset">offset</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the the amount of space
(as a fraction) left between groups (defaults to <code class="reqn">0.025</code>). Only used if
<code>groups</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="barplot_+3A_palette_color">palette_color</code></td>
<td>
<p>A palette <code><a href="base.html#topic+function">function</a></code> that when called with a single
argument returns a <code>character</code> vector of colors.</p>
</td></tr>
<tr><td><code id="barplot_+3A_border">border</code></td>
<td>
<p>The color to draw the borders.</p>
</td></tr>
<tr><td><code id="barplot_+3A_axes">axes</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should axes be drawn on the plot?</p>
</td></tr>
<tr><td><code id="barplot_+3A_legend">legend</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the legend be displayed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>barplot()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>height</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other plot methods: 
<code><a href="#topic+as_graph">as_graph</a>()</code>,
<code><a href="#topic+hist">hist</a>()</code>,
<code><a href="#topic+pairs">pairs</a>()</code>,
<code><a href="#topic+plot">plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Bar plot
barplot(coda)

## Data from Day et al. 2011
data("kommos", package = "folio")
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Coerce to compositional data

## Use ceramic types for grouping
barplot(coda, order_columns = TRUE)

## Display only minor elements
minor &lt;- coda[, is_element_minor(coda)]
barplot(minor, order_columns = TRUE)
</code></pre>

<hr>
<h2 id='bind'>Combine Two Composition Matrices</h2><span id='topic+bind'></span><span id='topic+rbind2+2CCompositionMatrix+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Combine Two Composition Matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix,CompositionMatrix'
rbind2(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bind_+3A_x">x</code>, <code id="bind_+3A_y">y</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rbind2()</code> combine by rows.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other subsetting methods: 
<code><a href="#topic+subset">subset</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a data.frame
X &lt;- data.frame(
  samples = c("A", "A", "A", "B", "B", "B", "C", "C", "C"),
  groups = c("X", "X", "X", "X", NA, NA, "Y", "Y", "Y"),
  Ca = c(7.72, 7.32, 3.11, 7.19, 7.41, 5, 4.18, 1, 4.51),
  Fe = c(6.12, 5.88, 5.12, 6.18, 6.02, 7.14, 5.25, 5.28, 5.72),
  Na = c(0.97, 1.59, 1.25, 0.86, 0.76, 0.51, 0.75, 0.52, 0.56)
)

## Coerce to a compositional matrix
Y &lt;- as_composition(X)

## Split by group
## /!\ Unassigned samples (NA) are discarded ! /!\
(s1 &lt;- split(Y, f = X$groups))

## Better to use grouped matrix
(s2 &lt;- group_split(Y, by = X$groups))

Z &lt;- as_composition(X, groups = 2)
(s3 &lt;- group_split(Z))

## Bind by rows
do.call(rbind, s3)
</code></pre>

<hr>
<h2 id='boxite'>Boxite Mineralogy</h2><span id='topic+boxite'></span>

<h3>Description</h3>

<p>Mineral compositions and depths of 25 specimens of boxite.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxite
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 5 variables (minerals):
</p>

<dl>
<dt><code>A</code></dt><dd><p>Albite (weight percent).</p>
</dd>
<dt><code>B</code></dt><dd><p>Blandite (weight percent).</p>
</dd>
<dt><code>C</code></dt><dd><p>Cornite (weight percent).</p>
</dd>
<dt><code>D</code></dt><dd><p>Daubite (weight percent).</p>
</dd>
<dt><code>E</code></dt><dd><p>Endite (weight percent).</p>
</dd>
<dt><code>depth</code></dt><dd><p>Depth (meter).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+coxite">coxite</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+kongite">kongite</a></code>,
<code><a href="#topic+lava">lava</a></code>,
<code><a href="#topic+predator">predator</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='chemistry'>Chemical Elements and Oxides</h2><span id='topic+chemistry'></span><span id='topic+is_element_major'></span><span id='topic+is_element_major-method'></span><span id='topic+is_element_minor'></span><span id='topic+is_element_minor-method'></span><span id='topic+is_element_trace'></span><span id='topic+is_element_trace-method'></span><span id='topic+is_oxide'></span><span id='topic+is_oxide-method'></span><span id='topic+is_oxide+2Ccharacter-method'></span><span id='topic+is_oxide+2CCompositionMatrix-method'></span><span id='topic+is_element_major+2CCompositionMatrix-method'></span><span id='topic+is_element_minor+2CCompositionMatrix-method'></span><span id='topic+is_element_trace+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Identify oxides and major, minor and traces elements in a compositional data
matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_element_major(object, ...)

is_element_minor(object, ...)

is_element_trace(object, ...)

is_oxide(object, ...)

## S4 method for signature 'character'
is_oxide(object)

## S4 method for signature 'CompositionMatrix'
is_oxide(object)

## S4 method for signature 'CompositionMatrix'
is_element_major(object, min = 1/100, max = Inf)

## S4 method for signature 'CompositionMatrix'
is_element_minor(object, min = 0.1/100, max = 1/100)

## S4 method for signature 'CompositionMatrix'
is_element_trace(object, min = -Inf, max = 0.1/100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chemistry_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="chemistry_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="chemistry_+3A_min">min</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the lower bound for
element identification.</p>
</td></tr>
<tr><td><code id="chemistry_+3A_max">max</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the upper bound for
element identification.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is no definite classification of what are the major, minor and trace
elements are. By default, the following rule of thumb is used:
</p>

<dl>
<dt>major elements</dt><dd><p>The major elements are those that define the material
under study. Major elements usually have concentrations of above 1%.</p>
</dd>
<dt>minor elements</dt><dd><p>Minor elements usually have concentrations between
1% and 0.1%</p>
</dd>
<dt>trace elements</dt><dd><p>Trace elements usually have concentrations of less
than 0.1%.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A <code><a href="base.html#topic+logical">logical</a></code> vector.
</p>


<h3>Note</h3>

<p><code>is_oxide()</code> uses a regular expression (it does not check if elements exist
or if stoichiometry is valid).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Use ceramic types for grouping

is_element_major(coda)
is_element_minor(coda)
is_element_trace(coda)

is_oxide(coda)
</code></pre>

<hr>
<h2 id='closure'>Closure Operation</h2><span id='topic+closure'></span><span id='topic+closure-method'></span><span id='topic+closure+2Cnumeric-method'></span><span id='topic+closure+2Cmatrix-method'></span>

<h3>Description</h3>

<p>Closes compositions to sum to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closure(x, ...)

## S4 method for signature 'numeric'
closure(x, total = 1, na.rm = TRUE)

## S4 method for signature 'matrix'
closure(x, total = 1, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="closure_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector or matrix.</p>
</td></tr>
<tr><td><code id="closure_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="closure_+3A_total">total</code></td>
<td>
<p>A <a href="base.html#topic+numeric">numeric</a> vector specifying the total amount to which the
compositions should be closed (defaults to 1).</p>
</td></tr>
<tr><td><code id="closure_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should missing values be removed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector or matrix (same as <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+arithmetic">arithmetic</a></code>,
<code><a href="#topic+perturbation">perturbation</a>()</code>,
<code><a href="#topic+powering">powering</a>()</code>,
<code><a href="#topic+scalar">scalar</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='CompositionMatrix-class'>Compositional Matrix</h2><span id='topic+CompositionMatrix-class'></span><span id='topic+.CompositionMatrix'></span><span id='topic+is_composition'></span>

<h3>Description</h3>

<p>An S4 class to represent compositional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_composition(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CompositionMatrix-class_+3A_object">object</code></td>
<td>
<p>A <code>CompositionMatrix</code> object.</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>totals</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector to store the absolute row sums (before
the closure of the compositions).</p>
</dd>
</dl>


<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is a <code>CompositionMatrix</code> object.
</p>

<dl>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Subset</h3>

<p>In the code snippets below, <code>x</code> is a <code>CompositionMatrix</code> object.
</p>

<dl>
<dt><code>x[i, j]</code></dt><dd><p>Extract parts of a matrix (see <code><a href="#topic+subset">[</a></code>).</p>
</dd>
</dl>



<h3>Note</h3>

<p>This class inherits from <code><a href="#topic+NumericMatrix-class">NumericMatrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as_composition">as_composition()</a></code>
</p>
<p>Other classes: 
<code><a href="#topic+GroupedComposition-class">GroupedComposition-class</a></code>,
<code><a href="#topic+GroupedLogRatio-class">GroupedLogRatio-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>,
<code><a href="#topic+ReferenceGroups-class">ReferenceGroups-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## codaccess
dim(coda) # Get the matrix dimensions
row(coda) # Get the row indexes
col(coda, as.factor = TRUE) # Get the column indexes
nrow(coda) # Get the number of rows
ncol(coda) # Get the number of columns
dimnames(coda) # Get the dimension names
rownames(coda) &lt;- LETTERS[1:25] # Set the row names
rownames(coda) # Get the rownames
colnames(coda) &lt;- letters[21:25] # Set the column names
colnames(coda) # Get the column names
</code></pre>

<hr>
<h2 id='condense'>Compositional Mean of Data Subsets</h2><span id='topic+condense'></span><span id='topic+condense-method'></span><span id='topic+condense+2CCompositionMatrix-method'></span><span id='topic+condense+2CGroupedComposition-method'></span>

<h3>Description</h3>

<p>Splits the data into subsets and computes compositional mean for each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>condense(x, ...)

## S4 method for signature 'CompositionMatrix'
condense(x, by, verbose = FALSE, ...)

## S4 method for signature 'GroupedComposition'
condense(x, by = NULL, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="condense_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="condense_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="#topic+mean">mean()</a></code>.</p>
</td></tr>
<tr><td><code id="condense_+3A_by">by</code></td>
<td>
<p>A <code>vector</code> or a list of grouping elements, each as long as the
variables in <code>x</code> (see <code><a href="#topic+group">group()</a></code>).</p>
</td></tr>
<tr><td><code id="condense_+3A_verbose">verbose</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should <span class="rlang"><b>R</b></span> report extra information
on progress?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mean">mean()</a></code>, <code><a href="#topic+aggregate">aggregate()</a></code>
</p>
<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("slides")

## Coerce to a compositional matrix
coda &lt;- as_composition(slides, groups = 2)

## Compositional mean by group
condense(coda)
</code></pre>

<hr>
<h2 id='covariance'>Covariance Matrix</h2><span id='topic+covariance'></span><span id='topic+covariance-method'></span><span id='topic+covariance+2CCompositionMatrix-method'></span><span id='topic+covariance+2CALR-method'></span><span id='topic+covariance+2CCLR-method'></span>

<h3>Description</h3>

<p>Computes the (centered) log-ratio covariance matrix (see below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covariance(x, ...)

## S4 method for signature 'CompositionMatrix'
covariance(x, center = TRUE, method = "pearson")

## S4 method for signature 'ALR'
covariance(x, method = "pearson")

## S4 method for signature 'CLR'
covariance(x, method = "pearson")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="covariance_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="covariance_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="covariance_+3A_center">center</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the <em>centered</em> log-ratio
covariance matrix be computed?</p>
</td></tr>
<tr><td><code id="covariance_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string indicating which covariance is to be
computed (see <code><a href="stats.html#topic+cor">stats::cov()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>covariance(ALR)</code>: Computes the log-ratio covariance matrix
(Aitchison 1986, definition 4.5).
</p>
</li>
<li> <p><code>covariance(CLR)</code>: Computes the centered log-ratio covariance matrix
(Aitchison 1986, definition 4.6).
</p>
</li></ul>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Log-ratio covariance matrix
## (Aitchison 1986, definition 4.5)
covariance(coda, center = FALSE)

## Centered log-ratio covariance matrix
## (Aitchison 1986, definition 4.6)
covariance(coda, center = TRUE)
</code></pre>

<hr>
<h2 id='coxite'>Coxite Mineralogy</h2><span id='topic+coxite'></span>

<h3>Description</h3>

<p>Mineral compositions, depths and porosity of 25 specimens of coxite.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxite
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 5 variables (minerals):
</p>

<dl>
<dt><code>A</code></dt><dd><p>Albite (weight percent).</p>
</dd>
<dt><code>B</code></dt><dd><p>Blandite (weight percent).</p>
</dd>
<dt><code>C</code></dt><dd><p>Cornite (weight percent).</p>
</dd>
<dt><code>D</code></dt><dd><p>Daubite (weight percent).</p>
</dd>
<dt><code>E</code></dt><dd><p>Endite (weight percent).</p>
</dd>
<dt><code>depth</code></dt><dd><p>Depth (meter).</p>
</dd>
<dt><code>porosity</code></dt><dd><p>Porosity (percent).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+boxite">boxite</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+kongite">kongite</a></code>,
<code><a href="#topic+lava">lava</a></code>,
<code><a href="#topic+predator">predator</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='describe'>Data Description</h2><span id='topic+describe'></span><span id='topic+describe+2CCompositionMatrix-method'></span><span id='topic+describe+2CGroupedComposition-method'></span>

<h3>Description</h3>

<p>Describes an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
describe(x)

## S4 method for signature 'GroupedComposition'
describe(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="describe_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>describe()</code> is called for its side-effects. Invisibly returns <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("slides")

## Coerce to compositional data
coda &lt;- as_composition(slides, groups = 2)

## Quick description
describe(coda)
</code></pre>

<hr>
<h2 id='detect_outlier'>Outlier Detection</h2><span id='topic+detect_outlier'></span><span id='topic+detect_outlier-method'></span><span id='topic+is_outlier'></span><span id='topic+is_outlier-method'></span><span id='topic+detect_outlier+2CCompositionMatrix+2Cmissing-method'></span><span id='topic+detect_outlier+2CCompositionMatrix+2CCompositionMatrix-method'></span><span id='topic+is_outlier+2COutlierIndex-method'></span>

<h3>Description</h3>

<p>Outlier Detection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_outlier(object, reference, ...)

is_outlier(object, ...)

## S4 method for signature 'CompositionMatrix,missing'
detect_outlier(
  object,
  ...,
  robust = TRUE,
  method = c("mve", "mcd"),
  quantile = 0.975
)

## S4 method for signature 'CompositionMatrix,CompositionMatrix'
detect_outlier(
  object,
  reference,
  ...,
  robust = TRUE,
  method = c("mve", "mcd"),
  quantile = 0.975
)

## S4 method for signature 'OutlierIndex'
is_outlier(object, robust = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detect_outlier_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code>.</p>
</td></tr>
<tr><td><code id="detect_outlier_+3A_reference">reference</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code>. If missing, <code>object</code> is used.</p>
</td></tr>
<tr><td><code id="detect_outlier_+3A_...">...</code></td>
<td>
<p>Further parameters to be passed to <code><a href="MASS.html#topic+cov.rob">MASS::cov.rob()</a></code>.</p>
</td></tr>
<tr><td><code id="detect_outlier_+3A_robust">robust</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should robust estimators be used?</p>
</td></tr>
<tr><td><code id="detect_outlier_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the method to be used.
It must be one of &quot;<code>mve</code>&quot; (minimum volume ellipsoid) or &quot;<code>mcd</code>&quot; (minimum
covariance determinant; see <code><a href="MASS.html#topic+cov.rob">MASS::cov.rob()</a></code>).
Only used if <code>robust</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="detect_outlier_+3A_quantile">quantile</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the significance level.
<code>quantile</code> is used as a cut-off value for outlier detection: observations
with larger (squared) Mahalanobis distance are considered as potential
outliers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An outlier can be defined as having a very large Mahalanobis distance from
all observations. In this way, a certain proportion of the observations can
be identified, e.g. the top 2% of values (i.e. values above the 0.98th
percentile of the Chi-2 distribution).
</p>
<p>On the one hand, the Mahalanobis distance is likely to be strongly
affected by the presence of outliers. Rousseeuw and van Zomeren (1990) thus
recommend using robust methods (which are not excessively affected by the
presence of outliers).
</p>
<p>On the other hand, the choice of the threshold for classifying an
observation as an outlier should be discussed. There is no apparent reason
why a particular threshold should be applicable to all data sets
(Filzmoser, Garrett, and Reimann 2005).
</p>


<h3>Value</h3>


<ul>
<li> <p><code>detect_outlier()</code> returns an <code><a href="#topic+OutlierIndex-class">OutlierIndex</a></code> object.
</p>
</li>
<li> <p><code>is_outlier()</code> returns a <code><a href="base.html#topic+logical">logical</a></code> vector.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Garrett, R. G. &amp; Reimann, C. (2005). Multivariate outlier
detection in exploration geochemistry. <em>Computers &amp; Geosciences</em>,
31(5), 579-587. <a href="https://doi.org/10.1016/j.cageo.2004.11.013">doi:10.1016/j.cageo.2004.11.013</a>.
</p>
<p>Filzmoser, P. &amp; Hron, K. (2008). Outlier Detection for Compositional Data
Using Robust Methods. <em>Mathematical Geosciences</em>, 40(3), 233-248.
<a href="https://doi.org/10.1007/s11004-007-9141-5">doi:10.1007/s11004-007-9141-5</a>.
</p>
<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2012). Interpretation of multivariate
outliers for compositional data. <em>Computers &amp; Geosciences</em>, 39, 77-85.
<a href="https://doi.org/10.1016/j.cageo.2011.06.014">doi:10.1016/j.cageo.2011.06.014</a>.
</p>
<p>Rousseeuw, P. J. &amp; van Zomeren, B. C. (1990). Unmasking Multivariate Outliers
and Leverage Points. <em>Journal of the American Statistical Association</em>,
85(411): 633-639. <a href="https://doi.org/10.1080/01621459.1990.10474920">doi:10.1080/01621459.1990.10474920</a>.
</p>
<p>Santos, F. (2020). Modern methods for old data: An overview of some robust
methods for outliers detection with applications in osteology. <em>Journal of
Archaeological Science: Reports</em>, 32, 102423.
<a href="https://doi.org/10.1016/j.jasrep.2020.102423">doi:10.1016/j.jasrep.2020.102423</a>.
</p>


<h3>See Also</h3>

<p>Other outlier detection methods: 
<code><a href="#topic+plot_outlier">plot_outlier</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, parts = 3:17, groups = 1)

## Detect outliers
out &lt;- detect_outlier(coda)

plot(out, type = "dotchart")
plot(out, type = "distance")

## Detect outliers according to CJ
ref &lt;- group_extract(coda, "CJ")
out &lt;- detect_outlier(coda, reference = ref, method = "mcd")
plot(out, type = "dotchart")
</code></pre>

<hr>
<h2 id='dist'>Distances</h2><span id='topic+dist'></span><span id='topic+dist+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes the distances between all rows of in <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
dist(x, method = "euclidean", diag = FALSE, upper = FALSE, p = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="dist_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the distance measure to be
used. See <code><a href="stats.html#topic+dist">stats::dist()</a></code> for the available distances.</p>
</td></tr>
<tr><td><code id="dist_+3A_diag">diag</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar indicating whether the diagonal of the
distance matrix should be printed.</p>
</td></tr>
<tr><td><code id="dist_+3A_upper">upper</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar indicating whether the upper triangle of
the distance matrix should be printed.</p>
</td></tr>
<tr><td><code id="dist_+3A_p">p</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the power of the Minkowski distance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Distances are computed on <a href="#topic+transform_clr">CLR-transformed</a> data.
</p>


<h3>Value</h3>

<p>A <code><a href="stats.html#topic+dist">stats::dist</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dist">stats::dist()</a></code>
</p>
<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Aitchison distance
## (euclidean distance between CLR-transformed compositions)
d &lt;- dist(coda)

## Cluster dendrogram
h &lt;- hclust(d, method = "ward.D2")
plot(h)
</code></pre>

<hr>
<h2 id='gmean'>Geometric Mean</h2><span id='topic+gmean'></span>

<h3>Description</h3>

<p>Geometric Mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmean(x, trim = 0, na.rm = FALSE, zero.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gmean_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</td></tr>
<tr><td><code id="gmean_+3A_trim">trim</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the fraction (0 to 0.5)
of observations to be trimmed from each end of <code>x</code> before the mean is
computed.</p>
</td></tr>
<tr><td><code id="gmean_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should <code>NA</code> values be stripped before the
computation proceeds?</p>
</td></tr>
<tr><td><code id="gmean_+3A_zero.rm">zero.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should zeros be stripped before the
computation proceeds?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>

<hr>
<h2 id='group'>Working With Groups</h2><span id='topic+group'></span><span id='topic+group-method'></span><span id='topic+ungroup'></span><span id='topic+group+2CCompositionMatrix-method'></span><span id='topic+group+2CGroupedComposition-method'></span><span id='topic+ungroup+2CGroupedComposition-method'></span><span id='topic+ungroup+2CGroupedLR-method'></span><span id='topic+ungroup+2CGroupedCLR-method'></span><span id='topic+ungroup+2CGroupedALR-method'></span><span id='topic+ungroup+2CGroupedILR-method'></span><span id='topic+ungroup+2CGroupedPLR-method'></span>

<h3>Description</h3>

<p>Define or remove the (reference) groups to which the observations belong.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group(object, ...)

ungroup(object, ...)

## S4 method for signature 'CompositionMatrix'
group(object, by, verbose = getOption("nexus.verbose"), ...)

## S4 method for signature 'GroupedComposition'
group(object, by, add = FALSE, verbose = getOption("nexus.verbose"), ...)

## S4 method for signature 'GroupedComposition'
ungroup(object)

## S4 method for signature 'GroupedLR'
ungroup(object)

## S4 method for signature 'GroupedCLR'
ungroup(object)

## S4 method for signature 'GroupedALR'
ungroup(object)

## S4 method for signature 'GroupedILR'
ungroup(object)

## S4 method for signature 'GroupedPLR'
ungroup(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="group_+3A_object">object</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> object (typically, a <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object).</p>
</td></tr>
<tr><td><code id="group_+3A_...">...</code></td>
<td>
<p>Further parameters to be passed to internal methods.</p>
</td></tr>
<tr><td><code id="group_+3A_by">by</code></td>
<td>
<p>A possible value for the groups of <code>object</code> (typically, a
<code><a href="base.html#topic+character">character</a></code> vector). If <code>value</code> is a <code><a href="base.html#topic+list">list</a></code>,
<code><a href="base.html#topic+interaction">interaction(by)</a></code> defines the grouping.</p>
</td></tr>
<tr><td><code id="group_+3A_verbose">verbose</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should <span class="rlang"><b>R</b></span> report extra information
on progress?</p>
</td></tr>
<tr><td><code id="group_+3A_add">add</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar. If <code>TRUE</code>, add to existing groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing values (<code>NA</code>) can be used to specify that a sample does not belong
to any group.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>group()</code> returns a grouped object of the same sort as <code>object</code>.
</p>
</li>
<li> <p><code>ungroup()</code> returns an ungrouped object of the same sort as <code>object</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other grouping methods: 
<code><a href="#topic+group_extract">group_extract</a>()</code>,
<code><a href="#topic+group_metadata">group_metadata</a></code>,
<code><a href="#topic+group_split">group_split</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("slides")

## Coerce to compositional data
coda &lt;- as_composition(slides, groups = 2)

## Grouping metadata
group_levels(coda)

group_names(coda)

group_indices(coda)

group_rows(coda)

group_length(coda)

group_size(coda)
</code></pre>

<hr>
<h2 id='group_extract'>Group-based Subset</h2><span id='topic+group_extract'></span><span id='topic+group_extract-method'></span><span id='topic+group_extract+2CGroupedComposition-method'></span>

<h3>Description</h3>

<p>Group-based Subset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_extract(object, ...)

## S4 method for signature 'GroupedComposition'
group_extract(object, which)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="group_extract_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+GroupedComposition-class">GroupedComposition</a></code> object.</p>
</td></tr>
<tr><td><code id="group_extract_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="group_extract_+3A_which">which</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector specifying the <a href="#topic+group">groups</a> of
<code>object</code> to extract.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other grouping methods: 
<code><a href="#topic+group">group</a>()</code>,
<code><a href="#topic+group_metadata">group_metadata</a></code>,
<code><a href="#topic+group_split">group_split</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("slides")

## Coerce to compositional data
coda &lt;- as_composition(slides, groups = 2)

## Grouping metadata
group_levels(coda)

group_names(coda)

group_indices(coda)

group_rows(coda)

group_length(coda)

group_size(coda)
</code></pre>

<hr>
<h2 id='group_metadata'>Grouping Metadata</h2><span id='topic+group_metadata'></span><span id='topic+group_levels'></span><span id='topic+group_levels-method'></span><span id='topic+group_names'></span><span id='topic+group_names-method'></span><span id='topic+group_rows'></span><span id='topic+group_rows-method'></span><span id='topic+group_length'></span><span id='topic+group_length-method'></span><span id='topic+group_size'></span><span id='topic+group_size-method'></span><span id='topic+group_indices'></span><span id='topic+group_indices-method'></span><span id='topic+is_assigned'></span><span id='topic+is_assigned-method'></span><span id='topic+any_assigned'></span><span id='topic+any_assigned-method'></span><span id='topic+all_assigned'></span><span id='topic+group_levels+2CReferenceGroups-method'></span><span id='topic+group_names+2CReferenceGroups-method'></span><span id='topic+group_indices+2CReferenceGroups-method'></span><span id='topic+group_rows+2CReferenceGroups-method'></span><span id='topic+group_length+2CReferenceGroups-method'></span><span id='topic+group_size+2CReferenceGroups-method'></span><span id='topic+is_assigned+2CReferenceGroups-method'></span><span id='topic+any_assigned+2CReferenceGroups-method'></span><span id='topic+all_assigned+2CReferenceGroups-method'></span>

<h3>Description</h3>

<p>Retrieve the (reference) groups to which the observations belong.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_levels(object)

group_names(object)

group_rows(object)

group_length(object)

group_size(object)

group_indices(object)

is_assigned(object)

any_assigned(object)

all_assigned(object)

## S4 method for signature 'ReferenceGroups'
group_levels(object)

## S4 method for signature 'ReferenceGroups'
group_names(object)

## S4 method for signature 'ReferenceGroups'
group_indices(object)

## S4 method for signature 'ReferenceGroups'
group_rows(object)

## S4 method for signature 'ReferenceGroups'
group_length(object)

## S4 method for signature 'ReferenceGroups'
group_size(object)

## S4 method for signature 'ReferenceGroups'
is_assigned(object)

## S4 method for signature 'ReferenceGroups'
any_assigned(object)

## S4 method for signature 'ReferenceGroups'
all_assigned(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="group_metadata_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+group">grouped</a> <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>group_levels(ReferenceGroups)</code>: returns a <code><a href="base.html#topic+character">character</a></code> vector giving the group
names.
</p>
</li>
<li> <p><code>group_names(ReferenceGroups)</code>: returns a <code><a href="base.html#topic+character">character</a></code> vector giving the name of
the group that each observation belongs to.
</p>
</li>
<li> <p><code>group_indices(ReferenceGroups)</code>: returns an <code><a href="base.html#topic+integer">integer</a></code> vector giving the group
that each value belongs to.
</p>
</li>
<li> <p><code>group_rows(ReferenceGroups)</code>: returns a <code>list</code> of <code><a href="base.html#topic+integer">integer</a></code> vectors giving the
observation that each group contains.
</p>
</li>
<li> <p><code>group_length(ReferenceGroups)</code>: gives the total number of groups.
</p>
</li>
<li> <p><code>group_size(ReferenceGroups)</code>: gives the size of each group.
</p>
</li>
<li> <p><code>is_assigned(ReferenceGroups)</code>: returns a <code><a href="base.html#topic+logical">logical</a></code> vector specifying whether or
not an observation belongs to a group.
</p>
</li>
<li> <p><code>any_assigned(ReferenceGroups)</code>: returns an <code><a href="base.html#topic+logical">logical</a></code> scalar specifying if any
observation belongs to a group.
</p>
</li>
<li> <p><code>all_assigned(ReferenceGroups)</code>: returns an <code><a href="base.html#topic+logical">logical</a></code> scalar specifying if all
observations belong to a group.
</p>
</li></ul>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other grouping methods: 
<code><a href="#topic+group">group</a>()</code>,
<code><a href="#topic+group_extract">group_extract</a>()</code>,
<code><a href="#topic+group_split">group_split</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("slides")

## Coerce to compositional data
coda &lt;- as_composition(slides, groups = 2)

## Grouping metadata
group_levels(coda)

group_names(coda)

group_indices(coda)

group_rows(coda)

group_length(coda)

group_size(coda)
</code></pre>

<hr>
<h2 id='group_split'>Divide into Groups</h2><span id='topic+group_split'></span><span id='topic+group_split-method'></span><span id='topic+group_split+2CCompositionMatrix-method'></span><span id='topic+group_split+2CGroupedComposition-method'></span><span id='topic+group_split+2CGroupedLogRatio-method'></span><span id='topic+split+2CCompositionMatrix-method'></span><span id='topic+split+2CLogRatio-method'></span>

<h3>Description</h3>

<p>Divides a compositional matrix by groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_split(object, ...)

## S4 method for signature 'CompositionMatrix'
group_split(object, by, ...)

## S4 method for signature 'GroupedComposition'
group_split(object, ...)

## S4 method for signature 'GroupedLogRatio'
group_split(object, ...)

## S4 method for signature 'CompositionMatrix'
split(x, f, drop = FALSE, ...)

## S4 method for signature 'LogRatio'
split(x, f, drop = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="group_split_+3A_object">object</code>, <code id="group_split_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="group_split_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="group_split_+3A_by">by</code></td>
<td>
<p>A <code>vector</code> or a list of grouping elements, each as long as the
variables in <code>object</code> (see <code><a href="#topic+group">group()</a></code>).</p>
</td></tr>
<tr><td><code id="group_split_+3A_f">f</code></td>
<td>
<p>A 'factor' in the sense that <code><a href="base.html#topic+as.factor">as.factor(f)</a></code> defines
the grouping, or a list of such factors in which case their interaction is
used for the grouping (see <code><a href="base.html#topic+split">base::split()</a></code>).</p>
</td></tr>
<tr><td><code id="group_split_+3A_drop">drop</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should levels that do not occur be dropped?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> objects.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other grouping methods: 
<code><a href="#topic+group">group</a>()</code>,
<code><a href="#topic+group_extract">group_extract</a>()</code>,
<code><a href="#topic+group_metadata">group_metadata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a data.frame
X &lt;- data.frame(
  samples = c("A", "A", "A", "B", "B", "B", "C", "C", "C"),
  groups = c("X", "X", "X", "X", NA, NA, "Y", "Y", "Y"),
  Ca = c(7.72, 7.32, 3.11, 7.19, 7.41, 5, 4.18, 1, 4.51),
  Fe = c(6.12, 5.88, 5.12, 6.18, 6.02, 7.14, 5.25, 5.28, 5.72),
  Na = c(0.97, 1.59, 1.25, 0.86, 0.76, 0.51, 0.75, 0.52, 0.56)
)

## Coerce to a compositional matrix
Y &lt;- as_composition(X)

## Split by group
## /!\ Unassigned samples (NA) are discarded ! /!\
(s1 &lt;- split(Y, f = X$groups))

## Better to use grouped matrix
(s2 &lt;- group_split(Y, by = X$groups))

Z &lt;- as_composition(X, groups = 2)
(s3 &lt;- group_split(Z))

## Bind by rows
do.call(rbind, s3)
</code></pre>

<hr>
<h2 id='GroupedComposition-class'>Grouped Compositional Matrix</h2><span id='topic+GroupedComposition-class'></span><span id='topic+.GroupedComposition'></span>

<h3>Description</h3>

<p>An S4 class to represent grouped compositional data.
</p>


<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is a <code>GroupedComposition</code> object.
</p>

<dl>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This class inherits from <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> and
<code><a href="#topic+ReferenceGroups-class">ReferenceGroups</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as_composition">as_composition()</a></code>
</p>
<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+GroupedLogRatio-class">GroupedLogRatio-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>,
<code><a href="#topic+ReferenceGroups-class">ReferenceGroups-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## codaccess
dim(coda) # Get the matrix dimensions
row(coda) # Get the row indexes
col(coda, as.factor = TRUE) # Get the column indexes
nrow(coda) # Get the number of rows
ncol(coda) # Get the number of columns
dimnames(coda) # Get the dimension names
rownames(coda) &lt;- LETTERS[1:25] # Set the row names
rownames(coda) # Get the rownames
colnames(coda) &lt;- letters[21:25] # Set the column names
colnames(coda) # Get the column names
</code></pre>

<hr>
<h2 id='GroupedLogRatio-class'>Grouped Log-Ratio Matrix</h2><span id='topic+GroupedLogRatio-class'></span><span id='topic+GroupedLR-class'></span><span id='topic+.GroupedLR'></span><span id='topic+GroupedCLR-class'></span><span id='topic+.GroupedCLR'></span><span id='topic+GroupedALR-class'></span><span id='topic+.GroupedALR'></span><span id='topic+GroupedILR-class'></span><span id='topic+.GroupedILR'></span><span id='topic+GroupedPLR-class'></span><span id='topic+.GroupedPLR'></span>

<h3>Description</h3>

<p>An S4 class to represent grouped log-ratio.
</p>


<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is a <code>GroupedLogRatio</code> object.
</p>

<dl>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This class inherits from <code><a href="#topic+LogRatio-class">LogRatio</a></code> and
<code><a href="#topic+ReferenceGroups-class">ReferenceGroups</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+GroupedComposition-class">GroupedComposition-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>,
<code><a href="#topic+ReferenceGroups-class">ReferenceGroups-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## codaccess
dim(coda) # Get the matrix dimensions
row(coda) # Get the row indexes
col(coda, as.factor = TRUE) # Get the column indexes
nrow(coda) # Get the number of rows
ncol(coda) # Get the number of columns
dimnames(coda) # Get the dimension names
rownames(coda) &lt;- LETTERS[1:25] # Set the row names
rownames(coda) # Get the rownames
colnames(coda) &lt;- letters[21:25] # Set the column names
colnames(coda) # Get the column names
</code></pre>

<hr>
<h2 id='hist'>Histogram of Compositional Data</h2><span id='topic+hist'></span><span id='topic+hist+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Produces an histogram of univariate ILR data (see Filzmoser <em>et al.</em>, 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
hist(
  x,
  ...,
  select = 1,
  breaks = "Sturges",
  freq = FALSE,
  labels = FALSE,
  main = NULL,
  sub = NULL,
  ann = graphics::par("ann"),
  axes = TRUE,
  frame.plot = axes
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hist_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="hist_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
<tr><td><code id="hist_+3A_select">select</code></td>
<td>
<p>A length-one <code>vector</code> of column indices.</p>
</td></tr>
<tr><td><code id="hist_+3A_breaks">breaks</code></td>
<td>
<p>An object specifying how to compute the breakpoints
(see <code><a href="graphics.html#topic+hist">graphics::hist()</a></code>).</p>
</td></tr>
<tr><td><code id="hist_+3A_freq">freq</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should absolute frequencies (counts) be
displayed? If <code>FALSE</code> (the default), relative frequencies (probabilities)
are displayed (see <code><a href="graphics.html#topic+hist">graphics::hist()</a></code>).</p>
</td></tr>
<tr><td><code id="hist_+3A_labels">labels</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should labels be drawn on top of bars?
If <code>TRUE</code>, draw the counts or rounded densities; if <code>labels</code> is a
<code>character</code> vector, draw itself.</p>
</td></tr>
<tr><td><code id="hist_+3A_main">main</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a main title for the plot.</p>
</td></tr>
<tr><td><code id="hist_+3A_sub">sub</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a subtitle for the plot.</p>
</td></tr>
<tr><td><code id="hist_+3A_ann">ann</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the default annotation (title and x
and y axis labels) appear on the plot?</p>
</td></tr>
<tr><td><code id="hist_+3A_axes">axes</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should axes be drawn on the plot?</p>
</td></tr>
<tr><td><code id="hist_+3A_frame.plot">frame.plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a box be drawn around the
plot?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>hist()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2009). Univariate Statistical
Analysis of Environmental (Compositional) Data: Problems and Possibilities.
<em>Science of The Total Environment</em>, 407(23): 6100-6108.
<a href="https://doi.org/10.1016/j.scitotenv.2009.08.008">doi:10.1016/j.scitotenv.2009.08.008</a>.
</p>


<h3>See Also</h3>

<p>Other plot methods: 
<code><a href="#topic+as_graph">as_graph</a>()</code>,
<code><a href="#topic+barplot">barplot</a>()</code>,
<code><a href="#topic+pairs">pairs</a>()</code>,
<code><a href="#topic+plot">plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Boxplot plot
hist(coda, select = "A")
hist(coda, select = "B")
</code></pre>

<hr>
<h2 id='hongite'>Hongite Mineralogy</h2><span id='topic+hongite'></span>

<h3>Description</h3>

<p>Mineral compositions of 25 specimens of hongite.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hongite
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 5 variables (minerals):
</p>

<dl>
<dt><code>A</code></dt><dd><p>Albite (weight percent).</p>
</dd>
<dt><code>B</code></dt><dd><p>Blandite (weight percent).</p>
</dd>
<dt><code>C</code></dt><dd><p>Cornite (weight percent).</p>
</dd>
<dt><code>D</code></dt><dd><p>Daubite (weight percent).</p>
</dd>
<dt><code>E</code></dt><dd><p>Endite (weight percent).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+boxite">boxite</a></code>,
<code><a href="#topic+coxite">coxite</a></code>,
<code><a href="#topic+kongite">kongite</a></code>,
<code><a href="#topic+lava">lava</a></code>,
<code><a href="#topic+predator">predator</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='kongite'>Kongite Mineralogy</h2><span id='topic+kongite'></span>

<h3>Description</h3>

<p>Mineral compositions of 25 specimens of kongite.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kongite
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 5 variables (minerals):
</p>

<dl>
<dt><code>A</code></dt><dd><p>Albite (weight percent).</p>
</dd>
<dt><code>B</code></dt><dd><p>Blandite (weight percent).</p>
</dd>
<dt><code>C</code></dt><dd><p>Cornite (weight percent).</p>
</dd>
<dt><code>D</code></dt><dd><p>Daubite (weight percent).</p>
</dd>
<dt><code>E</code></dt><dd><p>Endite (weight percent).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+boxite">boxite</a></code>,
<code><a href="#topic+coxite">coxite</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+lava">lava</a></code>,
<code><a href="#topic+predator">predator</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='lava'>Skye Lavas Compositions</h2><span id='topic+lava'></span>

<h3>Description</h3>

<p>Chemical compositions of 23 aphyric Skye lavas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lava
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 3 variables (percent):
</p>

<dl>
<dt><code>A</code></dt><dd><p>Na2O + K2O.</p>
</dd>
<dt><code>F</code></dt><dd><p>Fe2O3.</p>
</dd>
<dt><code>M</code></dt><dd><p>MgO.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall. <a href="https://doi.org/10.1007/978-94-009-4109-0">doi:10.1007/978-94-009-4109-0</a>.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+boxite">boxite</a></code>,
<code><a href="#topic+coxite">coxite</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+kongite">kongite</a></code>,
<code><a href="#topic+predator">predator</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='LogRatio-class'>Log-Ratio Matrix</h2><span id='topic+LogRatio-class'></span><span id='topic+.LogRatio'></span><span id='topic+LR-class'></span><span id='topic+.LR'></span><span id='topic+CLR-class'></span><span id='topic+.CLR'></span><span id='topic+ALR-class'></span><span id='topic+.ALR'></span><span id='topic+ILR-class'></span><span id='topic+.ILR'></span><span id='topic+PLR-class'></span><span id='topic+.PLR'></span><span id='topic+is_logratio'></span>

<h3>Description</h3>

<p>S4 classes to represent log-ratio data transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_logratio(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LogRatio-class_+3A_object">object</code></td>
<td>
<p>A <code>LogRatio</code> object.</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>totals</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector to store the absolute row sums (before
the closure of the compositions).</p>
</dd>
<dt><code>parts</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the original part names.</p>
</dd>
<dt><code>ratio</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the ratio names.</p>
</dd>
<dt><code>order</code></dt><dd><p>An <code><a href="base.html#topic+integer">integer</a></code> vector to store the original ordering of the
columns.</p>
</dd>
<dt><code>base</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix to store the basis of the transformation.</p>
</dd>
<dt><code>weights</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector to store the weights assigned to the
respective log-ratios.</p>
</dd>
</dl>


<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is a <code>LogRatio</code> object.
</p>

<dl>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>These classes inherit from <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_lr">transform_lr()</a></code>, <code><a href="#topic+transform_clr">transform_clr()</a></code>, <code><a href="#topic+transform_alr">transform_alr()</a></code>,
<code><a href="#topic+transform_ilr">transform_ilr()</a></code>, <code><a href="#topic+transform_plr">transform_plr()</a></code>
</p>
<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+GroupedComposition-class">GroupedComposition-class</a></code>,
<code><a href="#topic+GroupedLogRatio-class">GroupedLogRatio-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>,
<code><a href="#topic+ReferenceGroups-class">ReferenceGroups-class</a></code>
</p>

<hr>
<h2 id='mahalanobis'>Mahalanobis Distance</h2><span id='topic+mahalanobis'></span><span id='topic+mahalanobis+2CCompositionMatrix-method'></span><span id='topic+mahalanobis+2CILR-method'></span>

<h3>Description</h3>

<p>Computes the squared Mahalanobis distance of all rows in <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
mahalanobis(x, center, cov, ..., robust = TRUE, method = c("mve", "mcd"))

## S4 method for signature 'ILR'
mahalanobis(x, center, cov, ..., robust = TRUE, method = c("mve", "mcd"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mahalanobis_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> or an <code><a href="#topic+ILR-class">ILR</a></code> object.</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_center">center</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the mean vector of the
distribution. If missing, will be estimated from <code>x</code>.</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_cov">cov</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix giving the covariance of the
distribution. If missing, will be estimated from <code>x</code>.</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to <code><a href="MASS.html#topic+cov.rob">MASS::cov.rob()</a></code>.
Only used if <code>robust</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_robust">robust</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should robust location and scatter
estimation be used?</p>
</td></tr>
<tr><td><code id="mahalanobis_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the method to be used.
It must be one of &quot;<code>mve</code>&quot; (minimum volume ellipsoid) or &quot;<code>mcd</code>&quot; (minimum
covariance determinant). Only used if <code>robust</code> is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+mahalanobis">stats::mahalanobis()</a></code>
</p>
<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Mahalanobis distance
mahalanobis(coda)
</code></pre>

<hr>
<h2 id='margin'>Marginal Compositions</h2><span id='topic+margin'></span><span id='topic+margin-method'></span><span id='topic+margin+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Marginal Compositions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margin(x, ...)

## S4 method for signature 'CompositionMatrix'
margin(x, parts = c(1, 2), name = "*")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="margin_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="margin_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="margin_+3A_parts">parts</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> or a <code><a href="base.html#topic+character">character</a></code> vector specifying the columns
to be selected.</p>
</td></tr>
<tr><td><code id="margin_+3A_name">name</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving the name of the amalgamation
column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Marginal compositions
mar &lt;- margin(coda, parts = c("B", "D"))
head(mar)
</code></pre>

<hr>
<h2 id='mean'>Compositional Mean</h2><span id='topic+mean'></span><span id='topic+mean+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Compositional Mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
mean(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mean_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="mean_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to internal methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Closed vector of the columns geometric means.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Mean
mean(coda)

## Quantile
quantile(coda)
</code></pre>

<hr>
<h2 id='missing'>Missing Values Policy</h2><span id='topic+missing'></span>

<h3>Description</h3>

<p>Missing Values Policy
</p>


<h3>Details</h3>

<p>Compositional data are quantitative positive descriptions of the parts
of some whole, carrying relative, rather than absolute, information
(ie. only relative changes are relevant; Aitchison 1986).
</p>
<p>Basically, three situations can be outlined regarding missing values in
compositions:
</p>

<ul>
<li><p> Unobserved quantities.
</p>
</li>
<li><p> Amounts observed, but which happen to be below the detection limit
(thus interpreted as small unknown values).
</p>
</li>
<li><p> Absolutely zero quantities.
</p>
</li></ul>

<p>These situations can be represented in several ways:
</p>

<ul>
<li><p> The presence of zeros.
</p>
</li>
<li><p> The presence of missing values (<code>NA</code>).
</p>
</li></ul>

<p>When creating a <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object, the presence of zero
and <code><a href="base.html#topic+NA">NA</a></code> values is allowed: this makes it possible to explore and
visualize the data while preserving the missing structure. However, <strong>the
user must deal with these missing values before proceeding further</strong> (e.g.
by removing incomplete cases or replacing the values concerned): log-ratio
transformations cannot be computed in the presence of zeros or missing
values.
</p>


<h3>Note</h3>

<p>If you need more advanced features (e.g. imputation of missing values),
you should consider the <span class="pkg">compositions</span> or <span class="pkg">robCompositions</span> package.
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other imputation methods: 
<code><a href="#topic+replace_NA">replace_NA</a>()</code>,
<code><a href="#topic+replace_zero">replace_zero</a>()</code>
</p>

<hr>
<h2 id='mix'>Mixed-Mode Analysis</h2><span id='topic+mix'></span><span id='topic+mix-method'></span><span id='topic+mix+2Cmatrix+2Cmatrix-method'></span><span id='topic+mix+2Cdist+2Cdist-method'></span>

<h3>Description</h3>

<p>Mixes chemical and petrographic matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix(x, y, ...)

## S4 method for signature 'matrix,matrix'
mix(x, y, lambda = 1, ...)

## S4 method for signature 'dist,dist'
mix(x, y, mu = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mix_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> of chemical compositional data or a
<a href="stats.html#topic+dist">dissimilarity matrix</a> for these chemical compositional data.</p>
</td></tr>
<tr><td><code id="mix_+3A_y">y</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> of coded mineralogical binary data or a
<a href="stats.html#topic+dist">dissimilarity matrix</a> for these mineralogical data.</p>
</td></tr>
<tr><td><code id="mix_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to <code><a href="cluster.html#topic+daisy">cluster::daisy()</a></code>.</p>
</td></tr>
<tr><td><code id="mix_+3A_lambda">lambda</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving a weighting factor.</p>
</td></tr>
<tr><td><code id="mix_+3A_mu">mu</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector that lies between 0 and 1 giving
the mixing parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="stats.html#topic+dist">stats::dist</a> object.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>mix(x = matrix, y = matrix)</code>: First approach of mixed-mode analysis.
</p>
</li>
<li> <p><code>mix(x = dist, y = dist)</code>: Second approach of mixed-mode analysis.
</p>
</li></ul>


<h3>Note</h3>

<p><strong>Experimental.</strong>
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Baxter, M. J., Beardah, C. C., Papageorgiou, I., Cau, M. A., Day, P. M. &amp;
Kilikoglou, V. (2008). On Statistical Approaches to the Study of Ceramic
Artefacts Using Geochemical and Petrographic Data. <em>Archaeometry</em>, 50(1):
142-157. <a href="https://doi.org/10.1111/j.1475-4754.2007.00359.x">doi:10.1111/j.1475-4754.2007.00359.x</a>.
</p>
<p>Beardah, C. C., Baxter, M. J., Papageorgiou, I. &amp; Cau, M. A. (2003).
&quot;Mixed-Mode&quot; Approaches to the Grouping of Ceramic Artefacts Using S-Plus.
In M. Doerr and A. Sarris, <em>The Digital Heritage of Archaeology</em>, p. 261-266.
Athens: Archive of Monuments and Publications, Hellenic Ministry of Culture.
</p>
<p>Gower, J. C. (1971). A general coefficient of similarity and some of its
properties. <em>Biometrics</em>, 27(4):857-874. <a href="https://doi.org/10.2307/2528823">doi:10.2307/2528823</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Can Sora datasets
## Data from Cau (1999) and Cau et al. (2007)
path_chem &lt;- system.file("extdata", "cansora_chemistry.csv", package = "nexus")
chemistry &lt;- read.csv(path_chem, header = TRUE, row.names = 1)
path_petro &lt;- system.file("extdata", "cansora_petrography.csv", package = "nexus")
petrography &lt;- read.csv(path_petro, header = TRUE, row.names = 1)

## Prepare chemical data
major &lt;- c("Fe2O3", "Al2O3", "MnO", "P2O5", "TiO2",
           "MgO", "CaO", "Na2O", "K2O", "SiO2")
chem &lt;- chemistry[-1, major]

## Prepare petrographic data
petro &lt;- petrography[-c(7, 8), -1]
petro &lt;- cdt(petro) # Get the complete disjunctive table

## First approach
mix1 &lt;- mix(as.matrix(chem), as.matrix(petro), lambda = 2)
mds1 &lt;- stats::cmdscale(mix1) # Multi-Dimensional Scaling
plot(mds1)

</code></pre>

<hr>
<h2 id='mutators'>Get or Set Parts of an Object</h2><span id='topic+mutators'></span><span id='topic+get'></span><span id='topic+set'></span><span id='topic+labels+2CCompositionMatrix-method'></span><span id='topic+labels+2CLogRatio-method'></span><span id='topic+weights+2CALR-method'></span><span id='topic+weights+2CLR-method'></span><span id='topic+weights+2CLogRatio-method'></span>

<h3>Description</h3>

<p>Getters and setters to retrieve or set parts of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
labels(object, ...)

## S4 method for signature 'LogRatio'
labels(object, ...)

## S4 method for signature 'ALR'
weights(object, ...)

## S4 method for signature 'LR'
weights(object, ...)

## S4 method for signature 'LogRatio'
weights(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mutators_+3A_object">object</code></td>
<td>
<p>An object from which to get or set element(s).</p>
</td></tr>
<tr><td><code id="mutators_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+totals">totals</a>()</code>
</p>

<hr>
<h2 id='NumericMatrix-class'>Numeric Matrix</h2><span id='topic+NumericMatrix-class'></span><span id='topic+.NumericMatrix'></span>

<h3>Description</h3>

<p>S4 classes that represent a <code class="reqn">m \times p</code> numeric matrix.
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code></dt><dd><p>A <code class="reqn">m \times p</code> <code>numeric</code> <code><a href="base.html#topic+matrix">matrix</a></code>.</p>
</dd>
</dl>


<h3>Note</h3>

<p>This class inherits from <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+GroupedComposition-class">GroupedComposition-class</a></code>,
<code><a href="#topic+GroupedLogRatio-class">GroupedLogRatio-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>,
<code><a href="#topic+ReferenceGroups-class">ReferenceGroups-class</a></code>
</p>

<hr>
<h2 id='OutlierIndex-class'>Outliers</h2><span id='topic+OutlierIndex-class'></span><span id='topic+.OutlierIndex'></span>

<h3>Description</h3>

<p>An S4 class to store the result of outlier detection.
</p>


<h3>Slots</h3>


<dl>
<dt><code>samples</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the sample identifiers.</p>
</dd>
<dt><code>standard</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix giving the standard squared Mahalanobis
distances.</p>
</dd>
<dt><code>robust</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix giving the robust squared Mahalanobis
distances.</p>
</dd>
<dt><code>limit</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> value giving the cut-off value used for outliers
detection (quantile of the Chi-squared distribution).</p>
</dd>
<dt><code>dof</code></dt><dd><p>A (non-negative) <code><a href="base.html#topic+numeric">numeric</a></code> value giving the degrees of freedom.</p>
</dd>
</dl>


<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is an <code>OutlierIndex</code> object.
</p>

<dl>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+GroupedComposition-class">GroupedComposition-class</a></code>,
<code><a href="#topic+GroupedLogRatio-class">GroupedLogRatio-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+ReferenceGroups-class">ReferenceGroups-class</a></code>
</p>

<hr>
<h2 id='pairs'>Plot Compositional Data</h2><span id='topic+pairs'></span><span id='topic+pairs+2CCompositionMatrix-method'></span><span id='topic+pairs+2CGroupedComposition-method'></span>

<h3>Description</h3>

<p>Displays a matrix of ternary plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
pairs(x, margin = NULL, ...)

## S4 method for signature 'GroupedComposition'
pairs(
  x,
  ...,
  margin = NULL,
  palette_color = palette_color_discrete(),
  palette_symbol = palette_shape()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pairs_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="pairs_+3A_margin">margin</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string or an <code><a href="base.html#topic+integer">integer</a></code> giving the index of
the column to be used as the third part of the ternary plots. If <code>NULL</code>
(the default), marginal compositions will be used (i.e. the geometric mean
of the non-selected parts).</p>
</td></tr>
<tr><td><code id="pairs_+3A_...">...</code></td>
<td>
<p>Further <a href="graphics.html#topic+par">graphical parameters</a>.</p>
</td></tr>
<tr><td><code id="pairs_+3A_palette_color">palette_color</code></td>
<td>
<p>A palette <code><a href="base.html#topic+function">function</a></code> that when called with a single
argument returns a <code>character</code> vector of colors.</p>
</td></tr>
<tr><td><code id="pairs_+3A_palette_symbol">palette_symbol</code></td>
<td>
<p>A palette <code><a href="base.html#topic+function">function</a></code> that when called with a single
argument returns a vector of symbols.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="isopleuros.html#topic+ternary_pairs">isopleuros::ternary_pairs()</a></code>, <code><a href="isopleuros.html#topic+ternary_plot">isopleuros::ternary_plot()</a></code>
</p>
<p>Other plot methods: 
<code><a href="#topic+as_graph">as_graph</a>()</code>,
<code><a href="#topic+barplot">barplot</a>()</code>,
<code><a href="#topic+hist">hist</a>()</code>,
<code><a href="#topic+plot">plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, parts = 3:8, groups = 1)

## Use ceramic types for grouping
pairs(coda)

## Center and scale ternary plots
pairs(coda, by = NULL, center = TRUE, scale = TRUE)
</code></pre>

<hr>
<h2 id='pca'>Principal Components Analysis</h2><span id='topic+pca'></span><span id='topic+lra'></span><span id='topic+pca+2CCompositionMatrix-method'></span><span id='topic+pca+2CLogRatio-method'></span>

<h3>Description</h3>

<p>Computes a principal components analysis based on the singular value
decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
pca(
  object,
  center = TRUE,
  scale = FALSE,
  rank = NULL,
  sup_row = NULL,
  sup_col = NULL,
  weight_row = NULL,
  weight_col = NULL
)

## S4 method for signature 'LogRatio'
pca(
  object,
  center = TRUE,
  scale = FALSE,
  rank = NULL,
  sup_row = NULL,
  sup_col = NULL,
  weight_row = NULL,
  weight_col = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pca_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> or <code><a href="#topic+LogRatio-class">LogRatio</a></code> object.</p>
</td></tr>
<tr><td><code id="pca_+3A_center">center</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the variables be shifted to be
zero centered?</p>
</td></tr>
<tr><td><code id="pca_+3A_scale">scale</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the variables be scaled to unit
variance?</p>
</td></tr>
<tr><td><code id="pca_+3A_rank">rank</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> value specifying the maximal number of components
to be kept in the results. If <code>NULL</code> (the default), <code class="reqn">p - 1</code> components
will be returned.</p>
</td></tr>
<tr><td><code id="pca_+3A_sup_row">sup_row</code></td>
<td>
<p>A <code>vector</code> specifying the indices of the supplementary rows.</p>
</td></tr>
<tr><td><code id="pca_+3A_sup_col">sup_col</code></td>
<td>
<p>A <code>vector</code> specifying the indices of the supplementary columns.</p>
</td></tr>
<tr><td><code id="pca_+3A_weight_row">weight_row</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the active row (individual)
weights. If <code>NULL</code> (the default), uniform weights are used. Row weights are
internally normalized to sum 1</p>
</td></tr>
<tr><td><code id="pca_+3A_weight_col">weight_col</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the active column
(variable) weights. If <code>NULL</code> (the default), uniform weights (1) are
used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="dimensio.html#topic+PCA-class">dimensio::PCA</a></code> object. See <code><a href="dimensio.html#topic+pca">dimensio::pca()</a></code> for details.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>pca(CompositionMatrix)</code>: PCA of centered log-ratio, i.e. log-ratio analysis (LRA).
</p>
</li></ul>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. and Greenacre, M. (2002). Biplots of compositional data.
<em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>,
51: 375-392. <a href="https://doi.org/10.1111/1467-9876.00275">doi:10.1111/1467-9876.00275</a>.
</p>
<p>Filzmoser, P., Hron, K. and Reimann, C. (2009). Principal component analysis
for compositional data with outliers. <em>Environmetrics</em>, 20: 621-632.
<a href="https://doi.org/10.1002/env.966">doi:10.1002/env.966</a>.
</p>


<h3>See Also</h3>

<p><code><a href="dimensio.html#topic+pca">dimensio::pca()</a></code>, <code><a href="dimensio.html#topic+biplot">dimensio::biplot()</a></code>, <code><a href="dimensio.html#topic+screeplot">dimensio::screeplot()</a></code>,
<code><a href="dimensio.html#topic+viz_individuals">dimensio::viz_individuals()</a></code>, <code><a href="dimensio.html#topic+viz_variables">dimensio::viz_variables()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Use ceramic types for grouping

## Log-Ratio Analysis
X &lt;- pca(coda)

## Biplot
biplot(X)

## Explore results
viz_individuals(X)
viz_variables(X)
</code></pre>

<hr>
<h2 id='perturbation'>Perturbation Operation</h2><span id='topic+perturbation'></span><span id='topic+perturbation-method'></span><span id='topic+perturbation+2Cnumeric+2Cnumeric-method'></span><span id='topic+perturbation+2CCompositionMatrix+2Cnumeric-method'></span><span id='topic+perturbation+2CCompositionMatrix+2Cmatrix-method'></span><span id='topic+perturbation+2CCompositionMatrix+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Perturbation of two compositions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perturbation(x, y, ...)

## S4 method for signature 'numeric,numeric'
perturbation(x, y)

## S4 method for signature 'CompositionMatrix,numeric'
perturbation(x, y)

## S4 method for signature 'CompositionMatrix,matrix'
perturbation(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perturbation_+3A_x">x</code>, <code id="perturbation_+3A_y">y</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of compositional data or a
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="perturbation_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In compositional geometry, perturbation plays the role of sum (translation).
It is the closed component-wise product of two compositions.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+arithmetic">arithmetic</a></code>,
<code><a href="#topic+closure">closure</a>()</code>,
<code><a href="#topic+powering">powering</a>()</code>,
<code><a href="#topic+scalar">scalar</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='pip'>Proportionality Index of Parts (PIP)</h2><span id='topic+pip'></span><span id='topic+pip-method'></span><span id='topic+pip+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes an index of association between parts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pip(x, ...)

## S4 method for signature 'CompositionMatrix'
pip(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pip_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="pip_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The proportionality index of parts (PIP) is based on the
<a href="#topic+variation">variation matrix</a>, but maintains the range of values whithin
<code class="reqn">(0,1)</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Egozcue, J. J.. &amp; Pawlowsky-Glahn, V. (2023). Subcompositional Coherence
and and a Novel Proportionality Index of Parts. <em>SORT</em>, 47(2): 229-244.
<a href="https://doi.org/10.57645/20.8080.02.7">doi:10.57645/20.8080.02.7</a>.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Variation matrix
## (Aitchison 1986, definition 4.4)
(varia &lt;- variation(coda))

## Cluster dendrogram
d &lt;- as.dist(varia)
h &lt;- hclust(d, method = "ward.D2")
plot(h)

## Heatmap
stats::heatmap(
  varia,
  distfun = stats::as.dist,
  hclustfun = function(x) stats::hclust(x, method = "ward.D2"),
  symm = TRUE,
  scale = "none"
)
</code></pre>

<hr>
<h2 id='plot'>Plot Log-Ratios</h2><span id='topic+plot'></span><span id='topic+plot+2CLogRatio+2Cmissing-method'></span>

<h3>Description</h3>

<p>Displays a scatter plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'LogRatio,missing'
plot(
  x,
  ...,
  factor = 1,
  amount = NULL,
  palette_color = palette_color_discrete(),
  palette_symbol = palette_shape(),
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  sub = NULL,
  ann = graphics::par("ann"),
  axes = TRUE,
  frame.plot = axes,
  legend = list(x = "topright")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
<tr><td><code id="plot_+3A_factor">factor</code>, <code id="plot_+3A_amount">amount</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the amount of
jitter (see <code><a href="base.html#topic+jitter">jitter()</a></code>).</p>
</td></tr>
<tr><td><code id="plot_+3A_palette_color">palette_color</code></td>
<td>
<p>A palette <code><a href="base.html#topic+function">function</a></code> that when called with a single
argument returns a <code>character</code> vector of colors (only used if <code>x</code>
<a href="#topic+group">is grouped</a>).</p>
</td></tr>
<tr><td><code id="plot_+3A_palette_symbol">palette_symbol</code></td>
<td>
<p>A palette <code><a href="base.html#topic+function">function</a></code> that when called with a single
argument returns a vector of symbols (only used if <code>x</code>
<a href="#topic+group">is grouped</a>).</p>
</td></tr>
<tr><td><code id="plot_+3A_xlab">xlab</code>, <code id="plot_+3A_ylab">ylab</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the x and y axis labels.</p>
</td></tr>
<tr><td><code id="plot_+3A_main">main</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a main title for the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_sub">sub</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a subtitle for the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_ann">ann</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the default annotation (title and x
and y axis labels) appear on the plot?</p>
</td></tr>
<tr><td><code id="plot_+3A_axes">axes</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should axes be drawn on the plot?</p>
</td></tr>
<tr><td><code id="plot_+3A_frame.plot">frame.plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a box be drawn around the
plot?</p>
</td></tr>
<tr><td><code id="plot_+3A_legend">legend</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> of additional arguments to be passed to
<code><a href="graphics.html#topic+legend">graphics::legend()</a></code>; names of the list are used as argument names.
If <code>NULL</code>, no legend is displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other plot methods: 
<code><a href="#topic+as_graph">as_graph</a>()</code>,
<code><a href="#topic+barplot">barplot</a>()</code>,
<code><a href="#topic+hist">hist</a>()</code>,
<code><a href="#topic+pairs">pairs</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio")
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, groups = 1) # Coerce to compositional data

## Log ratio
clr &lt;- transform_clr(coda)

## Use ceramic types for grouping
plot(clr)
</code></pre>

<hr>
<h2 id='plot_outlier'>Plot Outliers</h2><span id='topic+plot_outlier'></span><span id='topic+plot+2COutlierIndex+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot Outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'OutlierIndex,missing'
plot(
  x,
  ...,
  type = c("dotchart", "distance"),
  robust = TRUE,
  symbols = c(16, 1, 3),
  xlim = NULL,
  ylim = NULL,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  sub = NULL,
  ann = graphics::par("ann"),
  axes = TRUE,
  frame.plot = axes,
  panel.first = NULL,
  panel.last = NULL,
  legend = list(x = "topleft")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_outlier_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+OutlierIndex-class">OutlierIndex</a></code> object.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_...">...</code></td>
<td>
<p>Further parameters to be passed to <code><a href="graphics.html#topic+points">graphics::points()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_type">type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the type of plot that should be
made. It must be one of &quot;<code>dotchart</code>&quot; or &quot;<code>distance</code>&quot;.
Any unambiguous substring can be given.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_robust">robust</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should robust Mahalanobis distances be
displayed? Only used if <code>type</code> is &quot;<code>dotchart</code>&quot;.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_symbols">symbols</code></td>
<td>
<p>A lenth-three vector of symbol specification for non-outliers
and outliers (resp.).</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_xlim">xlim</code></td>
<td>
<p>A length-two <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the x limits of the plot.
The default value, <code>NULL</code>, indicates that the range of the
<a href="base.html#topic+is.finite">finite</a> values to be plotted should be used.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_ylim">ylim</code></td>
<td>
<p>A length-two <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the y limits of the plot.
The default value, <code>NULL</code>, indicates that the range of the
<a href="base.html#topic+is.finite">finite</a> values to be plotted should be used.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_xlab">xlab</code>, <code id="plot_outlier_+3A_ylab">ylab</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the x and y axis labels.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_main">main</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a main title for the plot.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_sub">sub</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving a subtitle for the plot.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_ann">ann</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the default annotation (title and x
and y axis labels) appear on the plot?</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_axes">axes</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should axes be drawn on the plot?</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_frame.plot">frame.plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a box be drawn around the
plot?</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_panel.first">panel.first</code></td>
<td>
<p>An an <code>expression</code> to be evaluated after the plot axes are
set up but before any plotting takes place. This can be useful for drawing
background grids.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_panel.last">panel.last</code></td>
<td>
<p>An <code>expression</code> to be evaluated after plotting has taken
place but before the axes, title and box are added.</p>
</td></tr>
<tr><td><code id="plot_outlier_+3A_legend">legend</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> of additional arguments to be passed to
<code><a href="graphics.html#topic+legend">graphics::legend()</a></code>; names of the list are used as argument names.
If <code>NULL</code>, no legend is displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot()</code> is called for its side-effects: is results in a graphic being
displayed (invisibly return <code>x</code>).
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Garrett, R. G. &amp; Reimann, C. (2005). Multivariate outlier
detection in exploration geochemistry. <em>Computers &amp; Geosciences</em>,
31(5), 579-587. <a href="https://doi.org/10.1016/j.cageo.2004.11.013">doi:10.1016/j.cageo.2004.11.013</a>.
</p>
<p>Filzmoser, P. &amp; Hron, K. (2008). Outlier Detection for Compositional Data
Using Robust Methods. <em>Mathematical Geosciences</em>, 40(3), 233-248.
<a href="https://doi.org/10.1007/s11004-007-9141-5">doi:10.1007/s11004-007-9141-5</a>.
</p>
<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2012). Interpretation of multivariate
outliers for compositional data. <em>Computers &amp; Geosciences</em>, 39, 77-85.
<a href="https://doi.org/10.1016/j.cageo.2011.06.014">doi:10.1016/j.cageo.2011.06.014</a>.
</p>


<h3>See Also</h3>

<p>Other outlier detection methods: 
<code><a href="#topic+detect_outlier">detect_outlier</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Day et al. 2011
data("kommos", package = "folio") # Coerce to compositional data
kommos &lt;- remove_NA(kommos, margin = 1) # Remove cases with missing values
coda &lt;- as_composition(kommos, parts = 3:17, groups = 1)

## Detect outliers
out &lt;- detect_outlier(coda)

plot(out, type = "dotchart")
plot(out, type = "distance")

## Detect outliers according to CJ
ref &lt;- group_extract(coda, "CJ")
out &lt;- detect_outlier(coda, reference = ref, method = "mcd")
plot(out, type = "dotchart")
</code></pre>

<hr>
<h2 id='powering'>Powering Operation</h2><span id='topic+powering'></span><span id='topic+powering-method'></span><span id='topic+powering+2Cnumeric+2Cnumeric-method'></span><span id='topic+powering+2CCompositionMatrix+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Perturbation of two compositions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powering(x, a, ...)

## S4 method for signature 'numeric,numeric'
powering(x, a)

## S4 method for signature 'CompositionMatrix,numeric'
powering(x, a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powering_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of compositional data or a
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="powering_+3A_a">a</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> constant.</p>
</td></tr>
<tr><td><code id="powering_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In compositional geometry, powering replaces the product of a vector by a
scalar (scaling) and is defined as the closed powering of the components by
a given scalar.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+arithmetic">arithmetic</a></code>,
<code><a href="#topic+closure">closure</a>()</code>,
<code><a href="#topic+perturbation">perturbation</a>()</code>,
<code><a href="#topic+scalar">scalar</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='predator'>Predator-Prey Compositions</h2><span id='topic+predator'></span>

<h3>Description</h3>

<p>Predator-prey compositions at 25 different sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predator
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 3 variables (proportions):
</p>

<dl>
<dt><code>P</code></dt><dd><p>Predator.</p>
</dd>
<dt><code>Q</code></dt><dd><p>Prey of species Q.</p>
</dd>
<dt><code>R</code></dt><dd><p>Prey of species R.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall. <a href="https://doi.org/10.1007/978-94-009-4109-0">doi:10.1007/978-94-009-4109-0</a>.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+boxite">boxite</a></code>,
<code><a href="#topic+coxite">coxite</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+kongite">kongite</a></code>,
<code><a href="#topic+lava">lava</a></code>,
<code><a href="#topic+slides">slides</a></code>
</p>

<hr>
<h2 id='quantile'>Sample Quantiles</h2><span id='topic+quantile'></span><span id='topic+quantile+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Sample Quantiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
quantile(x, ..., probs = seq(0, 1, 0.25), na.rm = FALSE, names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantile_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="quantile_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="quantile_+3A_probs">probs</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of probabilities with values in <code class="reqn">[0,1]</code>.</p>
</td></tr>
<tr><td><code id="quantile_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should missing values be removed?</p>
</td></tr>
<tr><td><code id="quantile_+3A_names">names</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should results be named?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> matrix.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2009). Univariate Statistical
Analysis of Environmental (Compositional) Data: Problems and Possibilities.
<em>Science of The Total Environment</em>, 407(23): 6100-6108.
<a href="https://doi.org/10.1016/j.scitotenv.2009.08.008">doi:10.1016/j.scitotenv.2009.08.008</a>.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Mean
mean(coda)

## Quantile
quantile(coda)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+remove_NA'></span><span id='topic+remove_zero'></span><span id='topic+remove_constant'></span><span id='topic+sparsity'></span><span id='topic+color'></span><span id='topic+palette_color_continuous'></span><span id='topic+palette_color_discrete'></span><span id='topic+palette_color_picker'></span><span id='topic+palette_shape'></span><span id='topic+palette_line'></span><span id='topic+palette_size_sequential'></span><span id='topic+palette_size_diverging'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>arkhe</dt><dd><p><code><a href="arkhe.html#topic+remove_NA">remove_NA</a></code>, <code><a href="arkhe.html#topic+remove_constant">remove_constant</a></code>, <code><a href="arkhe.html#topic+remove_zero">remove_zero</a></code>, <code><a href="arkhe.html#topic+sparsity">sparsity</a></code></p>
</dd>
<dt>khroma</dt><dd><p><code><a href="khroma.html#topic+colour">color</a></code>, <code><a href="khroma.html#topic+palette_color_continuous">palette_color_continuous</a></code>, <code><a href="khroma.html#topic+palette_color_discrete">palette_color_discrete</a></code>, <code><a href="khroma.html#topic+palette_color_picker">palette_color_picker</a></code>, <code><a href="khroma.html#topic+palette_shape">palette_line</a></code>, <code><a href="khroma.html#topic+palette_shape">palette_shape</a></code>, <code><a href="khroma.html#topic+palette_size">palette_size_diverging</a></code>, <code><a href="khroma.html#topic+palette_size">palette_size_sequential</a></code></p>
</dd>
</dl>

<hr>
<h2 id='ReferenceGroups-class'>Grouped Data</h2><span id='topic+ReferenceGroups-class'></span><span id='topic+.ReferenceGroups'></span><span id='topic+is_grouped'></span>

<h3>Description</h3>

<p>A virtual S4 class to represent reference groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_grouped(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ReferenceGroups-class_+3A_object">object</code></td>
<td>
<p>A <code>ReferenceGroups</code> object.</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>group_indices</code></dt><dd><p>An <code><a href="base.html#topic+integer">integer</a></code> vector to store the group that each value
belongs to.</p>
</dd>
<dt><code>group_levels</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector to store the values of the grouping
variables.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic+CompositionMatrix-class">CompositionMatrix-class</a></code>,
<code><a href="#topic+GroupedComposition-class">GroupedComposition-class</a></code>,
<code><a href="#topic+GroupedLogRatio-class">GroupedLogRatio-class</a></code>,
<code><a href="#topic+LogRatio-class">LogRatio-class</a></code>,
<code><a href="#topic+NumericMatrix-class">NumericMatrix-class</a></code>,
<code><a href="#topic+OutlierIndex-class">OutlierIndex-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## codaccess
dim(coda) # Get the matrix dimensions
row(coda) # Get the row indexes
col(coda, as.factor = TRUE) # Get the column indexes
nrow(coda) # Get the number of rows
ncol(coda) # Get the number of columns
dimnames(coda) # Get the dimension names
rownames(coda) &lt;- LETTERS[1:25] # Set the row names
rownames(coda) # Get the rownames
colnames(coda) &lt;- letters[21:25] # Set the column names
colnames(coda) # Get the column names
</code></pre>

<hr>
<h2 id='replace_NA'>Missing Values Replacement</h2><span id='topic+replace_NA'></span><span id='topic+replace_NA+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Multiplicative replacement of missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
replace_NA(x, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="replace_NA_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="replace_NA_+3A_value">value</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the replacement values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object, where all missing values have been
replaced.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Mart√≠n-Fern√°ndez, J. A., Barcel√≥-Vidal, C. &amp; Pawlowsky-Glahn, V. (2003).
Dealing with Zeros and Missing Values in Compositional Data Sets Using
Nonparametric Imputation. <em>Mathematical Geology</em>, 35(3): 253-278.
<a href="https://doi.org/10.1023/A%3A1023866030544">doi:10.1023/A:1023866030544</a>.
</p>


<h3>See Also</h3>

<p>Other imputation methods: 
<code><a href="#topic+missing">missing</a></code>,
<code><a href="#topic+replace_zero">replace_zero</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Mart√≠n-Fern√°ndez et al. 2003
X &lt;- data.frame(
  X1 = c(0.0000, 0.1304, 0.1963),
  X2 = c(0.1250, 0.3151, NA),
  X3 = c(0.1237, NA, NA),
  X4 = c(0.7253, 0.2002, 0.0819),
  X5 = c(0.0260, 0.3543, 0.0114)
)

## Coerce to a compositional matrix
Y &lt;- as_composition(X)

## Replace zeros
Z &lt;- replace_NA(Y, value = 0.2)
Z
</code></pre>

<hr>
<h2 id='replace_zero'>Zero-Replacement</h2><span id='topic+replace_zero'></span><span id='topic+replace_zero+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Multiplicative replacement of zeros.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
replace_zero(x, value, delta = 2/3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="replace_zero_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="replace_zero_+3A_value">value</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the detection limits of each part
(in <code class="reqn">(0,1)</code>).</p>
</td></tr>
<tr><td><code id="replace_zero_+3A_delta">delta</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the fraction of the detection
limit to be used in replacement.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object, where all zero values have been
replaced.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Mart√≠n-Fern√°ndez, J. A., Barcel√≥-Vidal, C. &amp; Pawlowsky-Glahn, V. (2003).
Dealing with Zeros and Missing Values in Compositional Data Sets Using
Nonparametric Imputation. <em>Mathematical Geology</em>, 35(3): 253-278.
<a href="https://doi.org/10.1023/A%3A1023866030544">doi:10.1023/A:1023866030544</a>.
</p>


<h3>See Also</h3>

<p>Other imputation methods: 
<code><a href="#topic+missing">missing</a></code>,
<code><a href="#topic+replace_NA">replace_NA</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Mart√≠n-Fern√°ndez et al. 2003
X &lt;- data.frame(
  X1 = c(0.0000, 0.1304, 0.1963),
  X2 = c(0.1250, 0.3151, NA),
  X3 = c(0.1237, NA, NA),
  X4 = c(0.7253, 0.2002, 0.0819),
  X5 = c(0.0260, 0.3543, 0.0114)
)

## Coerce to a compositional matrix
Y &lt;- as_composition(X)

## Replace zeros
Z &lt;- replace_zero(Y, value = 0.02, delta = 2/3)
Z
</code></pre>

<hr>
<h2 id='scalar'>Scalar Product</h2><span id='topic+scalar'></span><span id='topic+scalar-method'></span><span id='topic+scalar+2Cnumeric+2Cnumeric-method'></span><span id='topic+scalar+2CCompositionMatrix+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes the Aitchison scalar product of two compositions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scalar(x, y, ...)

## S4 method for signature 'numeric,numeric'
scalar(x, y)

## S4 method for signature 'CompositionMatrix,CompositionMatrix'
scalar(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scalar_+3A_x">x</code>, <code id="scalar_+3A_y">y</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="scalar_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other operations in the simplex: 
<code><a href="#topic+arithmetic">arithmetic</a></code>,
<code><a href="#topic+closure">closure</a>()</code>,
<code><a href="#topic+perturbation">perturbation</a>()</code>,
<code><a href="#topic+powering">powering</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as_composition(c(1, 2, 3))
y &lt;- as_composition(c(1, 2, 1))

## Perturbation
perturbation(x, y)
x + y

## Powering
powering(y, 2)
y * 2

## Scalar product
scalar(x, y)
</code></pre>

<hr>
<h2 id='scale'>Scaling and Centering of Compositional Data</h2><span id='topic+scale'></span><span id='topic+scale+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Scaling and Centering of Compositional Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
scale(x, center = TRUE, scale = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scale_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="scale_+3A_center">center</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar or a <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the center
to be substracted.</p>
</td></tr>
<tr><td><code id="scale_+3A_scale">scale</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar or a length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving a
scaling factor for multiplication.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Boogaart, K. G. van den &amp; Tolosana-Delgado, R. (2013). <em>Analyzing
Compositional Data with R</em>. Berlin Heidelberg: Springer-Verlag.
<a href="https://doi.org/10.1007/978-3-642-36809-7">doi:10.1007/978-3-642-36809-7</a>.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Center and scale
scaled &lt;- scale(coda, center = TRUE, scale = TRUE)
mean(scaled)
head(scaled)
</code></pre>

<hr>
<h2 id='slides'>Thin Sections Compositions</h2><span id='topic+slides'></span>

<h3>Description</h3>

<p>Mineral compositions of five slides as reported by five analysts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slides
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with 9 variables:
</p>

<dl>
<dt><code>analyst</code></dt><dd><p>Analyst number.</p>
</dd>
<dt><code>slide</code></dt><dd><p>Slide number.</p>
</dd>
<dt><code>quartz</code></dt><dd><p>Quartz (percent).</p>
</dd>
<dt><code>microcline</code></dt><dd><p>Microcline (percent).</p>
</dd>
<dt><code>plagioclass</code></dt><dd><p>Plagioclass (percent).</p>
</dd>
<dt><code>biotite</code></dt><dd><p>Biotite (percent).</p>
</dd>
<dt><code>muscovite</code></dt><dd><p>Muscovite (percent).</p>
</dd>
<dt><code>opaques</code></dt><dd><p>Opaque minerals (percent).</p>
</dd>
<dt><code>nonopaques</code></dt><dd><p>Non-opaque minerals (percent).</p>
</dd>
</dl>



<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+arctic">arctic</a></code>,
<code><a href="#topic+boxite">boxite</a></code>,
<code><a href="#topic+coxite">coxite</a></code>,
<code><a href="#topic+hongite">hongite</a></code>,
<code><a href="#topic+kongite">kongite</a></code>,
<code><a href="#topic+lava">lava</a></code>,
<code><a href="#topic+predator">predator</a></code>
</p>

<hr>
<h2 id='subset'>Extract or Replace Parts of an Object</h2><span id='topic+subset'></span><span id='topic++5B+2CCompositionMatrix+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic++5B+2CCompositionMatrix+2Cmissing+2Cmissing+2Clogical-method'></span><span id='topic++5B+2CCompositionMatrix+2Cindex+2Cmissing+2Cmissing-method'></span><span id='topic++5B+2CCompositionMatrix+2Cindex+2Cmissing+2Clogical-method'></span><span id='topic++5B+2CCompositionMatrix+2Cmissing+2Cindex+2Cmissing-method'></span><span id='topic++5B+2CCompositionMatrix+2Cmissing+2Cindex+2Clogical-method'></span><span id='topic++5B+2CCompositionMatrix+2Cindex+2Cindex+2Cmissing-method'></span><span id='topic++5B+2CCompositionMatrix+2Cindex+2Cindex+2Clogical-method'></span><span id='topic++5B+3C-+2CCompositionMatrix-method'></span><span id='topic++5B+5B+3C-+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Operators acting on objects to extract or replace parts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix,missing,missing,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,missing,missing,logical'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,index,missing,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,index,missing,logical'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,missing,index,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,missing,index,logical'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,index,index,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'CompositionMatrix,index,index,logical'
x[i, j, ..., drop = TRUE]

## S4 replacement method for signature 'CompositionMatrix'
x[i, j, ...] &lt;- value

## S4 replacement method for signature 'CompositionMatrix'
x[[i, j, ...]] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subset_+3A_x">x</code></td>
<td>
<p>An object from which to extract element(s) or in which to replace
element(s).</p>
</td></tr>
<tr><td><code id="subset_+3A_i">i</code>, <code id="subset_+3A_j">j</code></td>
<td>
<p>Indices specifying elements to extract or replace. Indices are
<code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+integer">integer</a></code> or <code><a href="base.html#topic+character">character</a></code> vectors or empty (missing) or
<code>NULL</code>. Numeric values are coerced to <code><a href="base.html#topic+integer">integer</a></code> as by <code><a href="base.html#topic+as.integer">as.integer()</a></code>.
Character vectors will be matched to the name of the elements.
An empty index (a comma separated blank) indicates that all entries in that
dimension are selected.</p>
</td></tr>
<tr><td><code id="subset_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="subset_+3A_drop">drop</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the result be coerced to
the lowest possible dimension? This only works for extracting elements,
not for the replacement. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="subset_+3A_value">value</code></td>
<td>
<p>A possible value for the element(s) of <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subsetted object of the same sort as <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other subsetting methods: 
<code><a href="#topic+bind">bind</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)
head(coda)

## Subset
coda[[1, 1]] # Get the first value
coda[1] # Get the first value
coda[, ] # Get all values
coda[1, ] # Get the first row

## Subcomposition
subcoda &lt;- coda[, 1:3] # Get the first three column
head(subcoda)
</code></pre>

<hr>
<h2 id='t'>Matrix Transpose</h2><span id='topic+t'></span><span id='topic+t+2CCompositionMatrix-method'></span><span id='topic+t+2CLogRatio-method'></span>

<h3>Description</h3>

<p>Matrix Transpose
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompositionMatrix'
t(x)

## S4 method for signature 'LogRatio'
t(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="t_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code>, with dim and dimnames constructed appropriately from those of <code>x</code>.
</p>


<h3>Note</h3>

<p>Implemented only to ensure that <code>t()</code> always returns a base <code>matrix</code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)
head(coda)

## Subset
coda[[1, 1]] # Get the first value
coda[1] # Get the first value
coda[, ] # Get all values
coda[1, ] # Get the first row

## Subcomposition
subcoda &lt;- coda[, 1:3] # Get the first three column
head(subcoda)
</code></pre>

<hr>
<h2 id='totals'>Row Sums</h2><span id='topic+totals'></span><span id='topic+totals-method'></span><span id='topic+totals+3C-'></span><span id='topic+totals+2CCompositionMatrix-method'></span><span id='topic+totals+2CLogRatio-method'></span><span id='topic+totals+3C-+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Retrieves or defines the row sums (before <a href="#topic+closure">closure</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>totals(object)

totals(object) &lt;- value

## S4 method for signature 'CompositionMatrix'
totals(object)

## S4 method for signature 'LogRatio'
totals(object)

## S4 replacement method for signature 'CompositionMatrix'
totals(object) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="totals_+3A_object">object</code></td>
<td>
<p>An object from which to get or set <code>totals</code>.</p>
</td></tr>
<tr><td><code id="totals_+3A_value">value</code></td>
<td>
<p>A possible value for the <code>totals</code> of <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>totals() &lt;- value</code> returns an object of the same sort as <code>x</code> with the new
row sums assigned.
</p>
</li>
<li> <p><code>totals()</code> returns the row sums of <code>x</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutators: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+mutators">mutators</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a count matrix
A1 &lt;- matrix(data = sample(1:100, 100, TRUE), nrow = 20)

## Coerce to compositions
B &lt;- as_composition(A1)

## Row sums are internally stored before coercing to relative frequencies
totals(B)

## This allows to restore the source data
A2 &lt;- as_amounts(B)

## Coerce to a data.frame
X &lt;- as.data.frame(B)
head(X)
</code></pre>

<hr>
<h2 id='transform_alr'>Additive Log-Ratios (ALR)</h2><span id='topic+transform_alr'></span><span id='topic+transform_alr-method'></span><span id='topic+transform_alr+2CCompositionMatrix-method'></span><span id='topic+transform_alr+2CGroupedComposition-method'></span><span id='topic+transform_alr+2CCLR-method'></span><span id='topic+transform_alr+2CGroupedCLR-method'></span>

<h3>Description</h3>

<p>Computes ALR transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_alr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_alr(object, j = ncol(object), weights = FALSE)

## S4 method for signature 'GroupedComposition'
transform_alr(object, j = ncol(object), weights = FALSE)

## S4 method for signature 'CLR'
transform_alr(object, j = ncol(object))

## S4 method for signature 'GroupedCLR'
transform_alr(object, j = ncol(object), weights = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_alr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_alr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="transform_alr_+3A_j">j</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the index of the rationing part (denominator).</p>
</td></tr>
<tr><td><code id="transform_alr_+3A_weights">weights</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should varying weights (column means)
be computed? If <code>FALSE</code> (the default), equally-weighted parts are used.
Alternatively, a positive <code><a href="base.html#topic+numeric">numeric</a></code> vector of weights can be specified
(will be rescaled to sum to <code class="reqn">1</code>). Weights will be used internally by
other methods (e.g. <code><a href="#topic+variance">variance()</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ALR transformation is the logratio of a pair of parts with respect to a
fixed part.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+ALR-class">ALR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Additive log-ratio
alr &lt;- transform_alr(coda)

## Inverse transformation
inv_alr &lt;- transform_inverse(alr)
all.equal(coda, inv_alr)
</code></pre>

<hr>
<h2 id='transform_clr'>Centered Log-Ratios (CLR)</h2><span id='topic+transform_clr'></span><span id='topic+transform_clr-method'></span><span id='topic+transform_clr+2CCompositionMatrix-method'></span><span id='topic+transform_clr+2CGroupedComposition-method'></span><span id='topic+transform_clr+2CALR-method'></span><span id='topic+transform_clr+2CGroupedALR-method'></span>

<h3>Description</h3>

<p>Computes CLR transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_clr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_clr(object, weights = FALSE)

## S4 method for signature 'GroupedComposition'
transform_clr(object, weights = FALSE)

## S4 method for signature 'ALR'
transform_clr(object)

## S4 method for signature 'GroupedALR'
transform_clr(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_clr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_clr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="transform_clr_+3A_weights">weights</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should varying weights (column means)
be used? If <code>FALSE</code> (the default), equally-weighted parts are used.
Alternatively, a positive <code><a href="base.html#topic+numeric">numeric</a></code> vector of weights can be specified
(will be rescaled to sum to <code class="reqn">1</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CLR transformation computes the log of each part relative to the
geometric mean of all parts.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+CLR-class">CLR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Centered log-ratio
clr &lt;- transform_clr(coda)

## Inverse transformation
inv_clr &lt;- transform_inverse(clr)
all.equal(coda, inv_clr)
</code></pre>

<hr>
<h2 id='transform_ilr'>Isometric Log-Ratios (ILR)</h2><span id='topic+transform_ilr'></span><span id='topic+transform_ilr-method'></span><span id='topic+transform_ilr+2CCompositionMatrix-method'></span><span id='topic+transform_ilr+2CCompositionMatrix+2Cmissing-method'></span><span id='topic+transform_ilr+2CGroupedComposition-method'></span><span id='topic+transform_ilr+2CGroupedComposition+2Cmissing-method'></span><span id='topic+transform_ilr+2CCLR-method'></span><span id='topic+transform_ilr+2CCLR+2Cmissing-method'></span><span id='topic+transform_ilr+2CGroupedCLR-method'></span><span id='topic+transform_ilr+2CGroupedCLR+2Cmissing-method'></span><span id='topic+transform_ilr+2CALR-method'></span><span id='topic+transform_ilr+2CALR+2Cmissing-method'></span><span id='topic+transform_ilr+2CGroupedALR-method'></span><span id='topic+transform_ilr+2CGroupedALR+2Cmissing-method'></span>

<h3>Description</h3>

<p>Computes ILR transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_ilr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_ilr(object)

## S4 method for signature 'GroupedComposition'
transform_ilr(object)

## S4 method for signature 'CLR'
transform_ilr(object)

## S4 method for signature 'GroupedCLR'
transform_ilr(object)

## S4 method for signature 'ALR'
transform_ilr(object)

## S4 method for signature 'GroupedALR'
transform_ilr(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_ilr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_ilr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ILR transformation provides the coordinates of any composition with
respect to a given orthonormal basis. <code>transform_ilr()</code> uses the orthonormal
basis (Helmert matrix) originally defined by Egozcue <em>et al.</em> (2003).
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+ILR-class">ILR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Egozcue, J. J., Pawlowsky-Glahn, V., Mateu-Figueras, G. &amp; Barcel√≥-Vidal, C.
(2003). Isometric Logratio Transformations for Compositional Data Analysis.
<em>Mathematical Geology</em>, 35(3), 279-300. <a href="https://doi.org/10.1023/A%3A1023818214614">doi:10.1023/A:1023818214614</a>.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='transform_inverse'>Inverse Log-Ratio Transformation</h2><span id='topic+transform_inverse'></span><span id='topic+transform_inverse-method'></span><span id='topic+transform_inverse+2CCLR+2Cmissing-method'></span><span id='topic+transform_inverse+2CGroupedCLR+2Cmissing-method'></span><span id='topic+transform_inverse+2CALR+2Cmissing-method'></span><span id='topic+transform_inverse+2CGroupedALR+2Cmissing-method'></span><span id='topic+transform_inverse+2CILR+2Cmissing-method'></span><span id='topic+transform_inverse+2CGroupedILR+2Cmissing-method'></span><span id='topic+transform_inverse+2Cmatrix+2CILR-method'></span>

<h3>Description</h3>

<p>Computes inverse log-ratio transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_inverse(object, origin, ...)

## S4 method for signature 'CLR,missing'
transform_inverse(object)

## S4 method for signature 'GroupedCLR,missing'
transform_inverse(object)

## S4 method for signature 'ALR,missing'
transform_inverse(object)

## S4 method for signature 'GroupedALR,missing'
transform_inverse(object)

## S4 method for signature 'ILR,missing'
transform_inverse(object)

## S4 method for signature 'GroupedILR,missing'
transform_inverse(object)

## S4 method for signature 'matrix,ILR'
transform_inverse(object, origin)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_inverse_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_inverse_+3A_origin">origin</code></td>
<td>
<p>A <code><a href="#topic+LogRatio-class">LogRatio</a></code> object to be used for the inverse
transformation.</p>
</td></tr>
<tr><td><code id="transform_inverse_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Egozcue, J. J., Pawlowsky-Glahn, V., Mateu-Figueras, G. &amp; Barcel√≥-Vidal, C.
(2003). Isometric Logratio Transformations for Compositional Data Analysis.
<em>Mathematical Geology</em>, 35(3), 279-300. <a href="https://doi.org/10.1023/A%3A1023818214614">doi:10.1023/A:1023818214614</a>.
</p>
<p>Fi≈°erov√°, E. &amp; Hron, K. (2011). On the Interpretation of Orthonormal
Coordinates for Compositional Data. <em>Mathematical Geosciences</em>, 43(4),
455‚Äë468. <a href="https://doi.org/10.1007/s11004-011-9333-x">doi:10.1007/s11004-011-9333-x</a>.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Centered log-ratio
clr &lt;- transform_clr(coda)

## Inverse transformation
inv_clr &lt;- transform_inverse(clr)
all.equal(coda, inv_clr)
</code></pre>

<hr>
<h2 id='transform_lr'>Pairwise Log-Ratios (LR)</h2><span id='topic+transform_lr'></span><span id='topic+transform_lr-method'></span><span id='topic+transform_lr+2CCompositionMatrix-method'></span><span id='topic+transform_lr+2CGroupedComposition-method'></span>

<h3>Description</h3>

<p>Computes all pairwise log-ratio transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_lr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_lr(object, weights = FALSE)

## S4 method for signature 'GroupedComposition'
transform_lr(object, weights = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_lr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_lr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="transform_lr_+3A_weights">weights</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should varying weights (column means)
be computed? If <code>FALSE</code> (the default), equally-weighted parts are used.
Alternatively, a positive <code><a href="base.html#topic+numeric">numeric</a></code> vector of weights can be specified
(will be rescaled to sum to <code class="reqn">1</code>). Weights will be used internally by
other methods (e.g. <code><a href="#topic+variance">variance()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+LR-class">LR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_plr">transform_plr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Pairwise log-ratio
lr &lt;- transform_lr(coda)
</code></pre>

<hr>
<h2 id='transform_plr'>Pivot Log-Ratios (PLR)</h2><span id='topic+transform_plr'></span><span id='topic+transform_plr-method'></span><span id='topic+transform_plr+2CCompositionMatrix-method'></span><span id='topic+transform_plr+2CGroupedComposition-method'></span>

<h3>Description</h3>

<p>Computes PLR transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_plr(object, ...)

## S4 method for signature 'CompositionMatrix'
transform_plr(object, pivot = 1)

## S4 method for signature 'GroupedComposition'
transform_plr(object, pivot = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_plr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="transform_plr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="transform_plr_+3A_pivot">pivot</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the index of the pivotal variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+PLR-class">PLR</a></code> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Fi≈°erov√°, E. &amp; Hron, K. (2011). On the Interpretation of Orthonormal
Coordinates for Compositional Data. <em>Mathematical Geosciences</em>, 43(4),
455‚Äë468. <a href="https://doi.org/10.1007/s11004-011-9333-x">doi:10.1007/s11004-011-9333-x</a>.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Greenacre, M. J. (2021). Compositional Data Analysis. <em>Annual Review of
Statistics and Its Application</em>, 8(1): 271-299.
<a href="https://doi.org/10.1146/annurev-statistics-042720-124436">doi:10.1146/annurev-statistics-042720-124436</a>.
</p>
<p>Hron, K., Filzmoser, P., de Caritat, P., Fi≈°erov√°, E. &amp; Gardlo, A. (2017).
Weighted Pivot Coordinates for Compositional Data and Their Application to
Geochemical Mapping. <em>Mathematical Geosciences</em>, 49(6), 797-814.
<a href="https://doi.org/10.1007/s11004-017-9684-z">doi:10.1007/s11004-017-9684-z</a>.
</p>


<h3>See Also</h3>

<p>Other log-ratio transformations: 
<code><a href="#topic+transform_alr">transform_alr</a>()</code>,
<code><a href="#topic+transform_clr">transform_clr</a>()</code>,
<code><a href="#topic+transform_ilr">transform_ilr</a>()</code>,
<code><a href="#topic+transform_inverse">transform_inverse</a>()</code>,
<code><a href="#topic+transform_lr">transform_lr</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='univariate_ilr'>Univariate Isometric Log-Ratios (ILR)</h2><span id='topic+univariate_ilr'></span><span id='topic+univariate_ilr-method'></span><span id='topic+univariate_ilr+2Cnumeric-method'></span><span id='topic+univariate_ilr+2Cmatrix-method'></span>

<h3>Description</h3>

<p>Computes univariate ILR coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>univariate_ilr(object, ...)

## S4 method for signature 'numeric'
univariate_ilr(object)

## S4 method for signature 'matrix'
univariate_ilr(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="univariate_ilr_+3A_object">object</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="univariate_ilr_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ILR transformation provides the coordinates of any composition with
respect to a given orthonormal basis. <code>transform_ilr()</code> uses the orthonormal
basis (Helmert matrix) originally defined by Egozcue <em>et al.</em> (2003).
</p>


<h3>Value</h3>

<p>Same as <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2009). Univariate Statistical
Analysis of Environmental (Compositional) Data: Problems and Possibilities.
<em>Science of The Total Environment</em>, 407(23), 6100-6108.
<a href="https://doi.org/10.1016/j.scitotenv.2009.08.008">doi:10.1016/j.scitotenv.2009.08.008</a>.
</p>
<p>Filzmoser, P., Hron, K. &amp; Reimann, C. (2010). The Bivariate Statistical
Analysis of Environmental (Compositional) Data. <em>Science of The Total
Environment</em>, 408(19), 4230-4238. <a href="https://doi.org/10.1016/j.scitotenv.2010.05.011">doi:10.1016/j.scitotenv.2010.05.011</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Isometric log-ratio
ilr &lt;- transform_ilr(coda)
plr &lt;- transform_plr(coda)

## Inverse transformation
inv_ilr &lt;- transform_inverse(ilr)
all.equal(coda, inv_ilr)

inv_plr &lt;- transform_inverse(plr)
all.equal(coda, inv_plr)
</code></pre>

<hr>
<h2 id='variance'>Log-Ratios Variances</h2><span id='topic+variance'></span><span id='topic+variance-method'></span><span id='topic+variance+2CLogRatio-method'></span>

<h3>Description</h3>

<p>Computes log-ratio (weighted) variances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variance(x, ...)

## S4 method for signature 'LogRatio'
variance(x, row_weights = NULL, column_weights = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="variance_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="variance_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="variance_+3A_row_weights">row_weights</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of row weights. If <code>NULL</code> (the
default), equal weights are used.</p>
</td></tr>
<tr><td><code id="variance_+3A_column_weights">column_weights</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the weights of the
log-ratio be used? If <code>FALSE</code>, equally-weighted parts are used.
Alternatively, a positive <code><a href="base.html#topic+numeric">numeric</a></code> vector of weights can be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of individual variances.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Total variance (1)
variance_total(coda)

## Metric standard deviation
variance_total(coda, sd = TRUE)

## CLR transformation
clr &lt;- transform_clr(coda)

## Individual log-ratio variances
variance(clr)

## Total log-ratio variance (2)
variance_total(clr)

## Proportionality between (1) and (2)
## See Aitchison 1997
variance_total(coda) * (1 / ncol(coda)) * (1 - (1 / nrow(coda)))
</code></pre>

<hr>
<h2 id='variance_total'>Total Variance</h2><span id='topic+variance_total'></span><span id='topic+variance_total-method'></span><span id='topic+variance_total+2CCompositionMatrix-method'></span><span id='topic+variance_total+2CLogRatio-method'></span>

<h3>Description</h3>

<p>Computes the total (or metric) variance, a global measure of spread.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variance_total(x, ...)

## S4 method for signature 'CompositionMatrix'
variance_total(x, sd = FALSE)

## S4 method for signature 'LogRatio'
variance_total(x, row_weights = NULL, column_weights = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="variance_total_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="variance_total_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="variance_total_+3A_sd">sd</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the metric standard deviation be
returned instead of the metric variance?</p>
</td></tr>
<tr><td><code id="variance_total_+3A_row_weights">row_weights</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of row weights. If <code>NULL</code> (the
default), equal weights are used.</p>
</td></tr>
<tr><td><code id="variance_total_+3A_column_weights">column_weights</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the weights of the
log-ratio be used? If <code>FALSE</code>, equally-weighted parts are used.
Alternatively, a positive <code><a href="base.html#topic+numeric">numeric</a></code> vector of weights can be specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two methods are available, see below.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>variance_total(CompositionMatrix)</code>: The total variance of compositional data is the
trace of the <a href="#topic+covariance">centred log-ratio covariance</a> matrix
(i.e. <em>totvar1</em> in Aitchison 1997).
</p>
</li>
<li> <p><code>variance_total(LogRatio)</code>: Computes the total log-ratio variance. This is
identical to the weighted sum-of-squared distances between samples
(i.e. <em>totvar2</em> in Aitchison 1997).
</p>
</li></ul>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Aitchison, J. (1997). The One-Hour Course in Compositional Data Analysis or
Compositional Data Analysis Is Simple. In V. Pawlowsky-Glahn (ed.),
<em>IAMG'97</em>. Barcelona: International Center for Numerical Methods in
Engineering (CIMNE), p. 3-35.
</p>
<p>Boogaart, K. G. van den &amp; Tolosana-Delgado, R. (2013). <em>Analyzing
Compositional Data with R</em>. Berlin Heidelberg: Springer-Verlag.
<a href="https://doi.org/10.1007/978-3-642-36809-7">doi:10.1007/978-3-642-36809-7</a>.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>
<p>Hron, K. &amp; Kub√°ƒçek. L. (2011). Statistical Properties of the Total Variation
Estimator for Compositional Data. <em>Metrika</em>, 74 (2): 221-230.
<a href="https://doi.org/10.1007/s00184-010-0299-3">doi:10.1007/s00184-010-0299-3</a>.
</p>
<p>Pawlowsky-Glahn, V. &amp; Egozcue, J. J. (2001). Geometric Approach to
Statistical Analysis on the Simplex. <em>Stochastic Environmental Research and
Risk Assessment</em>, 15(5): 384-398. <a href="https://doi.org/10.1007/s004770100077">doi:10.1007/s004770100077</a>.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variation">variation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Total variance (1)
variance_total(coda)

## Metric standard deviation
variance_total(coda, sd = TRUE)

## CLR transformation
clr &lt;- transform_clr(coda)

## Individual log-ratio variances
variance(clr)

## Total log-ratio variance (2)
variance_total(clr)

## Proportionality between (1) and (2)
## See Aitchison 1997
variance_total(coda) * (1 / ncol(coda)) * (1 - (1 / nrow(coda)))
</code></pre>

<hr>
<h2 id='variation'>Variation Matrix</h2><span id='topic+variation'></span><span id='topic+variation-method'></span><span id='topic+variation+2CCompositionMatrix-method'></span>

<h3>Description</h3>

<p>Computes the variation matrix (Aitchison 1986, definition 4.4).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variation(x, ...)

## S4 method for signature 'CompositionMatrix'
variation(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="variation_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+CompositionMatrix-class">CompositionMatrix</a></code> object.</p>
</td></tr>
<tr><td><code id="variation_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitchison, J. (1986). <em>The Statistical Analysis of Compositional Data</em>.
London: Chapman and Hall, p. 64-91.
</p>
<p>Greenacre, M. J. (2019). <em>Compositional Data Analysis in Practice</em>.
Boca Raton: CRC Press.
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code><a href="#topic+aggregate">aggregate</a>()</code>,
<code><a href="#topic+condense">condense</a>()</code>,
<code><a href="#topic+covariance">covariance</a>()</code>,
<code><a href="#topic+dist">dist</a></code>,
<code><a href="#topic+mahalanobis">mahalanobis</a>()</code>,
<code><a href="#topic+margin">margin</a>()</code>,
<code><a href="#topic+mean">mean</a>()</code>,
<code><a href="#topic+pip">pip</a>()</code>,
<code><a href="#topic+quantile">quantile</a>()</code>,
<code><a href="#topic+scale">scale</a>()</code>,
<code><a href="#topic+variance">variance</a>()</code>,
<code><a href="#topic+variance_total">variance_total</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Aitchison 1986
data("hongite")

## Coerce to compositional data
coda &lt;- as_composition(hongite)

## Variation matrix
## (Aitchison 1986, definition 4.4)
(varia &lt;- variation(coda))

## Cluster dendrogram
d &lt;- as.dist(varia)
h &lt;- hclust(d, method = "ward.D2")
plot(h)

## Heatmap
stats::heatmap(
  varia,
  distfun = stats::as.dist,
  hclustfun = function(x) stats::hclust(x, method = "ward.D2"),
  symm = TRUE,
  scale = "none"
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
