<!DOCTYPE html><html lang="en"><head><title>Help for package ptmixed</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ptmixed}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#df1'><p>Example dataset with longitudinal counts</p></a></li>
<li><a href='#loglik.pt.1re'><p>Loglikelihood of Poisson-Tweedie generalized linear mixed model with random intercept</p></a></li>
<li><a href='#make.spaghetti'><p>Generate a spaghetti plot to visualize longitudinal data</p></a></li>
<li><a href='#nbglm'><p>Negative binomial generalized linear model</p></a></li>
<li><a href='#nbmixed'><p>Negative binomial generalized linear mixed model</p></a></li>
<li><a href='#pmf'><p>Probability mass function plot for a discrete variable</p></a></li>
<li><a href='#ptglm'><p>Poisson-Tweedie generalized linear model</p></a></li>
<li><a href='#ptmixed'><p>Poisson-Tweedie generalized linear mixed model</p></a></li>
<li><a href='#ranef'><p>Compute random effects for Poisson-Tweedie and negative binomial mixed model</p></a></li>
<li><a href='#simulate_ptglmm'><p>Simulate data from the Poisson-Tweedie generalized linear mixed model</p></a></li>
<li><a href='#summary.ptglm'><p>Summarizing Poisson-Tweedie and negative binomial GLM estimation results</p></a></li>
<li><a href='#summary.ptglmm'><p>Summarizing Poisson-Tweedie and negative binomial mixed model estimation results</p></a></li>
<li><a href='#wald.test'><p>Wald test for regression coefficients</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Poisson-Tweedie Generalized Linear Mixed Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits the Poisson-Tweedie generalized linear mixed model
    described in Signorelli et al. (2021, &lt;<a href="https://doi.org/10.1177%2F1471082X20936017">doi:10.1177/1471082X20936017</a>&gt;).
    Likelihood approximation based on adaptive Gauss Hermite quadrature
    rule.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mirkosignorelli.github.io/r">https://mirkosignorelli.github.io/r</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, GLMMadaptive, lme4, matrixcalc, moments, mvtnorm,
numDeriv, tweeDEseq</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-18 08:26:28 UTC; ms</td>
</tr>
<tr>
<td>Author:</td>
<td>Mirko Signorelli <a href="https://orcid.org/0000-0002-8102-3356"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Pietro Spitali [ctb],
  Roula Tsonaka [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mirko Signorelli &lt;msignorelli.rpackages@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-18 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='df1'>Example dataset with longitudinal counts</h2><span id='topic+df1'></span>

<h3>Description</h3>

<p>An example dataset of a study with longitudinal counts, used
to illustrate how 'ptmixed()' and 'nbmixed()' work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(df1)
</code></pre>


<h3>Format</h3>

<p>A data frame with 18 rows and 5 variables
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p>examples in the <code><a href="#topic+nbmixed">nbmixed</a></code> and 
<code><a href="#topic+ptmixed">ptmixed</a></code> help pages
</p>

<hr>
<h2 id='loglik.pt.1re'>Loglikelihood of Poisson-Tweedie generalized linear mixed model with random intercept</h2><span id='topic+loglik.pt.1re'></span>

<h3>Description</h3>

<p>Evaluates the loglikelihood of a Poisson-Tweedie generalized linear mixed model 
with random intercept, using the adaptive Gauss-Hermite quadrature rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik.pt.1re(beta, D, a, Sigma, y, X, Z, id, offset = NULL, GHk = 5,
  tol = 9.88131291682493e-324, GHs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loglik.pt.1re_+3A_beta">beta</code></td>
<td>
<p>Vector of regression coefficients</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_d">D</code></td>
<td>
<p>Dispersion parameter (must be &gt; 1)</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_a">a</code></td>
<td>
<p>Power parameter (must be &lt; 1)</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_sigma">Sigma</code></td>
<td>
<p>A matrix with the variance of the random intercept</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_y">y</code></td>
<td>
<p>Response vector (discrete)</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_x">X</code></td>
<td>
<p>Design matrix for the fixed effects</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_z">Z</code></td>
<td>
<p>Design matrix for the random effects</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_id">id</code></td>
<td>
<p>Id indicator (it should be numeric)</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_offset">offset</code></td>
<td>
<p>Offset term to be added to the linear predictor</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_ghk">GHk</code></td>
<td>
<p>Number of quadrature points (default is 5)</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_tol">tol</code></td>
<td>
<p>Tolerance value for the evaluation of the probability mass function of the Poisson-Tweedie distribution</p>
</td></tr>
<tr><td><code id="loglik.pt.1re_+3A_ghs">GHs</code></td>
<td>
<p>Quadrature points at which to evaluate the loglikelihood. If <code>NULL</code> (default value), 
the GH quadrature points are computed internally</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The loglikelihood value obtained using a Gauss-Hermite quadrature
approximation with <code>GHk</code> quadrature points.
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptmixed">ptmixed</a></code> and the examples therein
</p>

<hr>
<h2 id='make.spaghetti'>Generate a spaghetti plot to visualize longitudinal data</h2><span id='topic+make.spaghetti'></span>

<h3>Description</h3>

<p>A spaghetti plot, or trajectory plot, is a plot that allows
to compare across individuals or groups the trajectories 
of a longitudinal outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.spaghetti(x, y, id, group = NULL, data, col = NULL, pch = 16,
  lty = 1, lwd = 1, title = "", xlab = NA, ylab = NA,
  legend.title = "", xlim = NULL, ylim = NULL, cex.axis = 1,
  cex.title = 1, cex.lab = 1, cex.leg = 1, margins = NULL,
  legend.inset = -0.3, legend.space = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.spaghetti_+3A_x">x</code></td>
<td>
<p>the time variable (numeric vector)</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_y">y</code></td>
<td>
<p>the longitudinal outcome (numeric vector)</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_id">id</code></td>
<td>
<p>the subject indicator</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_group">group</code></td>
<td>
<p>the group that each subject belongs to (optional, 
do not specify if not relevant)</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_data">data</code></td>
<td>
<p>a data frame containing x, y, id and optionally group</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_col">col</code></td>
<td>
<p>a vector of colors (optional)</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_pch">pch</code></td>
<td>
<p>dot type</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_title">title</code></td>
<td>
<p>plot title</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_xlab">xlab</code></td>
<td>
<p>label for the x axis</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_ylab">ylab</code></td>
<td>
<p>label for the y axis</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_legend.title">legend.title</code></td>
<td>
<p>legend title</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_xlim">xlim</code></td>
<td>
<p>limits for the x axis</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_ylim">ylim</code></td>
<td>
<p>limits for the y axis</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_cex.axis">cex.axis</code></td>
<td>
<p>font size for the axes</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_cex.title">cex.title</code></td>
<td>
<p>title font size</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_cex.lab">cex.lab</code></td>
<td>
<p>font size for axis labels</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_cex.leg">cex.leg</code></td>
<td>
<p>font size for the legend</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_margins">margins</code></td>
<td>
<p>use this argument if you want to overwrite the default 
function margins</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_legend.inset">legend.inset</code></td>
<td>
<p>moves legend more to the left / right (default is -0.3)</p>
</td></tr>
<tr><td><code id="make.spaghetti_+3A_legend.space">legend.space</code></td>
<td>
<p>interspace between lines in the legend (default is 1)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate example data
set.seed(123)
n = 12; t = 6
id = rep(1:n, each = t)
rand.int = rep(rnorm(n, sd = 0.5), each = t)
group = rep(c(0,1), each = n*t/2)
time = rep(0:(t-1), n)
offset = rnorm(n*t, sd = 0.3)
beta = c(3, 0, 0.1, 0.3)
X = model.matrix(~group + time + group*time)
mu = 2^(X %*% beta + rand.int + offset)
y = rpois(n*t, lambda = mu)
group = ifelse(group == 0, 'control', 'treatment')
data.long = data.frame(y, group, time, id, offset)
rm(list = setdiff(ls(), 'data.long'))

# create plot
make.spaghetti(x = time, y, id, group, 
data = data.long, title = 'spaghetti plot')

</code></pre>

<hr>
<h2 id='nbglm'>Negative binomial generalized linear model</h2><span id='topic+nbglm'></span>

<h3>Description</h3>

<p>Estimates a negative binomial generalized linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbglm(formula, offset = NULL, data, maxit = c(500, 1e+05), trace = T,
  theta.start = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nbglm_+3A_formula">formula</code></td>
<td>
<p>A formula for the fixed effects part of the model. It should be in the form <code>y ~ x1 + x2</code></p>
</td></tr>
<tr><td><code id="nbglm_+3A_offset">offset</code></td>
<td>
<p>An offset to be added to the linear predictor. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="nbglm_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables declared in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="nbglm_+3A_maxit">maxit</code></td>
<td>
<p>Vector containing the maximum number of iterations used in optim by
the BFGS method and, if this fails, by the Nelder-Mead method</p>
</td></tr>
<tr><td><code id="nbglm_+3A_trace">trace</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, additional information is printed during the optimization. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="nbglm_+3A_theta.start">theta.start</code></td>
<td>
<p>Numeric vector comprising initial parameter values for the
vector of regression coefficients and the dispersion parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Maximum likelihood estimation of a negative binomial GLM
(the NB distribution is obtained as special case of the Poisson-Tweedie distribution when a = 0).
</p>


<h3>Value</h3>

<p>A list containing the following elements: function's call (<code>call</code>); 
maximum likelihood estimate (<code>mle</code>);  value of the
loglikelihood at the mle (<code>logl</code>); <code>convergence</code> value (if 0, the optimization converged);
the observed Fisher information (<code>fisher.info</code>) and the starting values
used in the optimization (<code>theta.init</code>)
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptmixed">ptmixed</a></code> for the Poisson-Tweedie GLMM
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df1, package = 'ptmixed')

# estimate the model
fit1 = nbglm(formula = y ~ group*time, data = df1)

# view model summary
summary(fit1)
</code></pre>

<hr>
<h2 id='nbmixed'>Negative binomial generalized linear mixed model</h2><span id='topic+nbmixed'></span>

<h3>Description</h3>

<p>Estimates the negative binomial generalized linear mixed model with random intercept
(here, the NB distribution is obtained as special case of the Poisson-Tweedie distribution when a = 0).
Likelihood approximation for the model is based on the adaptive Gauss-Hermite quadrature rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbmixed(fixef.formula, id, offset = NULL, data, npoints = 5, hessian = T,
  trace = T, theta.start = NULL, reltol = 1e-08, maxit = c(10000, 100),
  freq.updates = 200, min.var.init = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nbmixed_+3A_fixef.formula">fixef.formula</code></td>
<td>
<p>A formula for the fixed effects part of the model. It should be in the form <code>y ~ x1 + x2</code></p>
</td></tr>
<tr><td><code id="nbmixed_+3A_id">id</code></td>
<td>
<p>A variable to distinguish observations from the same subject.</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_offset">offset</code></td>
<td>
<p>An offset to be added to the linear predictor. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables declared in <code>fixef.formula</code>.</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_npoints">npoints</code></td>
<td>
<p>Number of quadrature points employed in the adaptive quadrature. Default is 5.</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_hessian">hessian</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, the hessian matrix is evaluated at the MLE to derive the observed Fisher information matrix. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_trace">trace</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, additional information is printed during the optimization. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_theta.start">theta.start</code></td>
<td>
<p>Numeric vector comprising initial parameter values for the
vector of regression coefficients, the dispersion parameter (using the same parametrization of <code>ptmixed</code>) 
and the variance of the random intercept. 
Default is <code>NULL</code>: initial
parameter estimates are computed automatically by the function.</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_reltol">reltol</code></td>
<td>
<p>Relative tolerance to be used in optim. Default to 1e-8</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_maxit">maxit</code></td>
<td>
<p>Vector containing the maximum number of iterations used in optim by
the Nelder-Mead method and, if this fails, by the BFGS method</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_freq.updates">freq.updates</code></td>
<td>
<p>Number of iterations after which the quadrature points are updated when the Nelder-Mead
algorithm is used for the optimization. Default value is 200. To update the quadrature points at every iteration 
(note that this may make the computation about 10x slower), set <code>freq.updates = 1</code> 
or <code>freq.updates = NA</code>. The function first tries to optimize the loglikelihood using the Nelder-Mead
algorithm, updating the quadrature points every <code>freq.updates</code> iterations. If this fails to converge,
a second attempt is made using the BFGS algorithm, for which the quadrature points are updated at every iteration.</p>
</td></tr>
<tr><td><code id="nbmixed_+3A_min.var.init">min.var.init</code></td>
<td>
<p>If the initial estimate of the variance of the random intercept is smaller than
this value, estimation is stopped and the user is advided to use the simpler Poisson-Tweedie GLM is used. Default is 1e-3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements: function's call (<code>call</code>); 
maximum likelihood estimate (<code>mle</code>);  value of the
loglikelihood at the mle (<code>logl</code>); <code>convergence</code> value (if 0, the optimization converged);
the observed Fisher information (<code>fisher.info</code>), if <code>hessian = T</code>; the number of quadrature points 
used (<code>quad.points</code>) and the starting value used in the optimization (<code>theta.init</code>); 
relevant warnings (<code>warnings</code>).
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.ptglmm">summary.ptglmm</a></code>, <code><a href="#topic+ranef">ranef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df1, package = 'ptmixed')
head(df1)

# 1) Quick example (hessian and SEs not computed)

# estimate the model
fit1 = nbmixed(fixef.formula = y ~ group + time, id = id,
              offset = offset, data = df1, npoints = 5, 
              freq.updates = 200, hessian = FALSE, trace = TRUE)
              
# print summary:
summary(fit1, wald = FALSE)


# 2) Full computation, including computation of SEs

# estimate the model
fit2 = nbmixed(fixef.formula = y ~ group + time, id = id,
              offset = offset, data = df1, npoints = 5, 
              freq.updates = 200, hessian = TRUE, trace = TRUE)
              
# print summary:
summary(fit2)

# extract summary:
results = summary(fit2)
ls(results)
results$coefficients

</code></pre>

<hr>
<h2 id='pmf'>Probability mass function plot for a discrete variable</h2><span id='topic+pmf'></span>

<h3>Description</h3>

<p>This function produces a simple plot of the probability mass function
of a discrete variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmf(x, absolute = T, xlim = NULL, lwd = 1, col = "black",
  title = NULL, xlab = "x", bty = "l", cex.title = NULL,
  cex.axis = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pmf_+3A_x">x</code></td>
<td>
<p>the (discrete) variable of interest</p>
</td></tr>
<tr><td><code id="pmf_+3A_absolute">absolute</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) absolute frequencies 
are plotted, if <code>FALSE</code> relative frequencies</p>
</td></tr>
<tr><td><code id="pmf_+3A_xlim">xlim</code></td>
<td>
<p>limits for the x axis</p>
</td></tr>
<tr><td><code id="pmf_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="pmf_+3A_col">col</code></td>
<td>
<p>color used for the vertical frequency bars</p>
</td></tr>
<tr><td><code id="pmf_+3A_title">title</code></td>
<td>
<p>plot title</p>
</td></tr>
<tr><td><code id="pmf_+3A_xlab">xlab</code></td>
<td>
<p>label for the x axis</p>
</td></tr>
<tr><td><code id="pmf_+3A_bty">bty</code></td>
<td>
<p>box type (default is <code>bty="l"</code>)</p>
</td></tr>
<tr><td><code id="pmf_+3A_cex.title">cex.title</code></td>
<td>
<p>title font size</p>
</td></tr>
<tr><td><code id="pmf_+3A_cex.axis">cex.axis</code></td>
<td>
<p>font size for the axes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pmf(cars$speed)
pmf(cars$speed, absolute = FALSE)
pmf(cars$speed, lwd = 2, col = 'blue')
</code></pre>

<hr>
<h2 id='ptglm'>Poisson-Tweedie generalized linear model</h2><span id='topic+ptglm'></span>

<h3>Description</h3>

<p>Estimates a Poisson-Tweedie generalized linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptglm(formula, offset = NULL, data, maxit = c(500, 1e+05), trace = T,
  theta.start = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ptglm_+3A_formula">formula</code></td>
<td>
<p>A formula for the fixed effects part of the model. It should be in the form <code>y ~ x1 + x2</code></p>
</td></tr>
<tr><td><code id="ptglm_+3A_offset">offset</code></td>
<td>
<p>An offset to be added to the linear predictor. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ptglm_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables declared in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="ptglm_+3A_maxit">maxit</code></td>
<td>
<p>Vector containing the maximum number of iterations used in optim by
the BFGS method and, if this fails, by the Nelder-Mead method</p>
</td></tr>
<tr><td><code id="ptglm_+3A_trace">trace</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, additional information is printed during the optimization. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ptglm_+3A_theta.start">theta.start</code></td>
<td>
<p>Numeric vector comprising initial parameter values for the
vector of regression coefficients, the dispersion parameter and the power parameter 
(to be specified exactlyin this order!).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements: function's call (<code>call</code>); 
maximum likelihood estimate (<code>mle</code>);  value of the
loglikelihood at the mle (<code>logl</code>); <code>convergence</code> value (if 0, the optimization converged);
the observed Fisher information (<code>fisher.info</code>) and the starting values
used in the optimization (<code>theta.init</code>)
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptmixed">ptmixed</a></code> for the Poisson-Tweedie GLMM
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df1, package = 'ptmixed')

# estimate the model
fit1 = ptglm(formula = y ~ group*time, data = df1)

# view model summary:
summary(fit1)
</code></pre>

<hr>
<h2 id='ptmixed'>Poisson-Tweedie generalized linear mixed model</h2><span id='topic+ptmixed'></span>

<h3>Description</h3>

<p>Estimates the Poisson-Tweedie generalized linear mixed model with random intercept.
Likelihood approximation for the model is based on the adaptive Gauss-Hermite quadrature rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptmixed(fixef.formula, id, offset = NULL, data, npoints = 5, hessian = T,
  trace = T, theta.start = NULL, reltol = 1e-08, maxit = c(10000, 100),
  freq.updates = 200, min.var.init = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ptmixed_+3A_fixef.formula">fixef.formula</code></td>
<td>
<p>A formula for the fixed effects part of the model. 
It should be in the form <code>y ~ x1 + x2</code></p>
</td></tr>
<tr><td><code id="ptmixed_+3A_id">id</code></td>
<td>
<p>A variable to distinguish observations from the same subject.</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_offset">offset</code></td>
<td>
<p>An offset to be added to the linear predictor. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables declared in <code>fixef.formula</code>.</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_npoints">npoints</code></td>
<td>
<p>Number of quadrature points employed in the adaptive quadrature. Default is 5.</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_hessian">hessian</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, the hessian matrix is evaluated 
at the MLE to derive the observed Fisher information matrix. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_trace">trace</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, additional information 
is printed during the optimization. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_theta.start">theta.start</code></td>
<td>
<p>Numeric vector comprising initial parameter values for the
vector of regression coefficients, the dispersion parameter, the power parameter 
and the variance of the random intercept (to be specified exactlyin this order!). 
Default is <code>NULL</code>: initial
parameter estimates are computed automatically by the function.</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_reltol">reltol</code></td>
<td>
<p>Relative tolerance to be used in optim. Default to 1e-8</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_maxit">maxit</code></td>
<td>
<p>Vector containing the maximum number of iterations used in optim by
the Nelder-Mead method and, if this fails, by the BFGS method</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_freq.updates">freq.updates</code></td>
<td>
<p>Number of iterations after which the quadrature points are updated when the Nelder-Mead
algorithm is used for the optimization. Default value is 200. To update the quadrature points at every iteration 
(note that this may make the computation about 10x slower), set <code>freq.updates = 1</code> 
or <code>freq.updates = NA</code>. The function first tries to optimize the loglikelihood using the Nelder-Mead
algorithm, updating the quadrature points every <code>freq.updates</code> iterations. If this fails to converge,
a second attempt is made using the BFGS algorithm, for which the quadrature points are updated at every iteration.</p>
</td></tr>
<tr><td><code id="ptmixed_+3A_min.var.init">min.var.init</code></td>
<td>
<p>If the initial estimate of the variance of the random intercept is smaller than
this value, estimation is stopped and the user is advided to use the simpler Poisson-Tweedie GLM is used. Default is 1e-3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements: function's call (<code>call</code>); 
maximum likelihood estimate (<code>mle</code>);  value of the
loglikelihood at the mle (<code>logl</code>); <code>convergence</code> value (if 0, the optimization converged);
the observed Fisher information (<code>fisher.info</code>), if <code>hessian = T</code>; the number of quadrature points 
used (<code>quad.points</code>) and the starting value used in the optimization (<code>theta.init</code>); 
relevant warnings (<code>warnings</code>).
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.ptglmm">summary.ptglmm</a></code>, <code><a href="#topic+ranef">ranef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(df1, package = 'ptmixed')
head(df1)

# 1) Quick example (just 1 quadrature point, hessian and SEs 
# not computed - NB: we recommend to increase the number of
# quadrature points to obtain much more accurate estimates,
# as shown in example 2 below where we use 5 quadrature points)

# estimate the model
fit1 = ptmixed(fixef.formula = y ~ group + time, id = id,
              offset = offset, data = df1, npoints = 1, 
              freq.updates = 200, hessian = FALSE, trace = TRUE)
              
# print summary:
summary(fit1, wald = FALSE)


# 2) Full computation that uses more quadrature points
# for the likelihood approximation and includes numeric
# evaluation of the hessian matrix

# estimate the model:
fit2 = ptmixed(fixef.formula = y ~ group + time, id = id,
              offset = offset, data = df1, npoints = 5, 
              freq.updates = 200, hessian = TRUE, trace = TRUE)
              
# print summary:
summary(fit2)

# extract summary:
results = summary(fit2)
ls(results)
results$coefficients

</code></pre>

<hr>
<h2 id='ranef'>Compute random effects for Poisson-Tweedie and negative binomial mixed model</h2><span id='topic+ranef'></span>

<h3>Description</h3>

<p>Compute the BLUP (best linear unbiased predictor) of the random  
effects for the Poisson-Tweedie and negative binomial generalized 
linear mixed models (fitted through <code>ptmixed</code> and 
<code>nbmixed</code> respectively)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ranef(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ranef_+3A_obj">obj</code></td>
<td>
<p>an object of class <code>ptglmm</code> (obtained from 
<code>ptmixed</code> or <code>nbmixed</code> ).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the EB estimates of the random effects
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptmixed">ptmixed</a></code>, <code><a href="#topic+nbmixed">nbmixed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(df1, package = 'ptmixed')

# estimate a Poisson-Tweedie or negative binomial GLMM (using
# ptmixed() or nbmixed())
fit0 = nbmixed(fixef.formula = y ~ group + time, id = id,
              offset = offset, data = df1, npoints = 5, 
              freq.updates = 200, hessian = FALSE, trace = TRUE)
              
# obtain random effect estimates
ranef(obj = fit0)

</code></pre>

<hr>
<h2 id='simulate_ptglmm'>Simulate data from the Poisson-Tweedie generalized linear mixed model</h2><span id='topic+simulate_ptglmm'></span>

<h3>Description</h3>

<p>Simulates a dataset comprising t repeated measurements for n subjects
from a Poisson-Tweedie GLMM. Subjects are assumed to belong to two
different groups. The linear predictor comprises an intercept,
main effects of group and of time, and the interaction between time and
group; a random intercept; and, optionally, a normally-distributed 
offset term.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_ptglmm(n = 20, t = 5, seed = 1, beta = c(3, 0, 0, 0.4),
  D = 1.5, a = -1, sigma2 = 0.8^2, offset = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_ptglmm_+3A_n">n</code></td>
<td>
<p>number of subjects</p>
</td></tr>
<tr><td><code id="simulate_ptglmm_+3A_t">t</code></td>
<td>
<p>number of time points (0, 1, ..., t-1)</p>
</td></tr>
<tr><td><code id="simulate_ptglmm_+3A_seed">seed</code></td>
<td>
<p>seed for random number generation</p>
</td></tr>
<tr><td><code id="simulate_ptglmm_+3A_beta">beta</code></td>
<td>
<p>vector of regression coefficients, to be specified in
this order: intercept, group main effect, time main effect, group*time interaction</p>
</td></tr>
<tr><td><code id="simulate_ptglmm_+3A_d">D</code></td>
<td>
<p>dispersion parameter of the Poisson-Tweedie distribution (D &gt; 1)</p>
</td></tr>
<tr><td><code id="simulate_ptglmm_+3A_a">a</code></td>
<td>
<p>power parameter of the Poisson-Tweedie distribution (a &lt; 1)</p>
</td></tr>
<tr><td><code id="simulate_ptglmm_+3A_sigma2">sigma2</code></td>
<td>
<p>Variance of the subject-specific random intercept</p>
</td></tr>
<tr><td><code id="simulate_ptglmm_+3A_offset">offset</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, a normally-distributed offset is added to the linear predictor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements: a dataframe (<code>data</code>)
containing the response y, the subject id, the group indicator and time; 
a vector with the true random intercept values (<code>true.randint</code>).
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate a simple, small dataset
example1 = simulate_ptglmm(n = 5, t = 2)
example1$data
# the function allows to set several different parameters
example2 = simulate_ptglmm(n = 20, t = 5, seed = 1,
beta = c(2.2, 1.2, 0.3, -0.5), D = 1.8, a = 0.5,
sigma2 = 0.7, offset = TRUE)
# view the distribution of the response variable:
pmf(example2$data$y)
# visualize the data with a trajectory plot:
make.spaghetti(x = time, y = y, id = id,
group = group, data = example2$data)
</code></pre>

<hr>
<h2 id='summary.ptglm'>Summarizing Poisson-Tweedie and negative binomial GLM estimation results</h2><span id='topic+summary.ptglm'></span>

<h3>Description</h3>

<p>Provides parameter estimates, standard errors and univariate Wald test
for the Poisson-Tweedie and the negative binomial generalized linear models
(fitted through <code>ptglm</code> and <code>nbglm</code> respectively)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ptglm'
summary(object, silent = F, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.ptglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>ptglm</code> 
(obtained from <code>ptglm</code> or <code>nbglm</code>).
#' @param silent logical. If <code>TRUE</code>, information on parameter estimates and
tests is not printed on screen. Default is <code>FALSE</code> (info is printed)</p>
</td></tr>
<tr><td><code id="summary.ptglm_+3A_silent">silent</code></td>
<td>
<p>logical. If <code>TRUE</code>, information on parameter estimates and
tests is not printed on screen. Default is <code>FALSE</code> (info is printed)</p>
</td></tr>
<tr><td><code id="summary.ptglm_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements: <code>logl</code>, <code>coefficients</code>, 
<code>D</code>, <code>a</code>
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptglm">ptglm</a></code>, <code><a href="#topic+nbglm">nbglm</a></code> and the examples therein
</p>

<hr>
<h2 id='summary.ptglmm'>Summarizing Poisson-Tweedie and negative binomial mixed model estimation results</h2><span id='topic+summary.ptglmm'></span>

<h3>Description</h3>

<p>Provides parameter estimates, standard errors and univariate Wald test
for the Poisson-Tweedie and negative binomial generalized
linear mixed models (fitted through <code>ptmixed</code> and 
<code>nbmixed</code> respectively)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ptglmm'
summary(object, wald = T, silent = F, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.ptglmm_+3A_object">object</code></td>
<td>
<p>an object of class <code>ptglmm</code> (obtained 
from <code>ptmixed</code> or <code>nbmixed</code>).</p>
</td></tr>
<tr><td><code id="summary.ptglmm_+3A_wald">wald</code></td>
<td>
<p>logical. If <code>TRUE</code>, standard errors and univariate Wald test are computed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="summary.ptglmm_+3A_silent">silent</code></td>
<td>
<p>logical. If <code>TRUE</code>, information on parameter estimates and
tests is not printed on screen. Default is <code>FALSE</code> (info is printed)</p>
</td></tr>
<tr><td><code id="summary.ptglmm_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements: value of the loglikelihood at the MLE (<code>logl</code>),
table with maximum likelihood estimates of the regression coefficients, SEs and Wald tests <code>coefficients</code>, 
and maximum likelihood estimates of the other parameters (<code>D</code>, <code>a</code> and <code>sigma2</code>)
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ptmixed">ptmixed</a></code>, <code><a href="#topic+nbmixed">nbmixed</a></code> and the examples therein
</p>

<hr>
<h2 id='wald.test'>Wald test for regression coefficients</h2><span id='topic+wald.test'></span>

<h3>Description</h3>

<p>Compute a multivariate Wald test for one of the following
models: Poisson-Tweedie GLMM, negative binomial GLMM, 
Poisson-Tweedie GLM, negative binomial GLM. The null
hypothesis has to be specified in the (matrix) form
$L b = k$, where $b$ is the vector of regression coefficients
and $L$ and $k$ are defined below
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wald.test(obj, L, k = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wald.test_+3A_obj">obj</code></td>
<td>
<p>an object of class <code>ptglmm</code> (obtained from 
<code>ptmixed</code> or <code>nbmixed</code>) or <code>ptglm</code> (obtained from 
<code>ptglm</code> or <code>nbglm</code>)</p>
</td></tr>
<tr><td><code id="wald.test_+3A_l">L</code></td>
<td>
<p>a matrix used to define the hypothesis to test,
in the form $L b = k$</p>
</td></tr>
<tr><td><code id="wald.test_+3A_k">k</code></td>
<td>
<p>a vector used to define the hypothesis to test,
in the form $L b = k$. Default is a null vector ($L b = 0$)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the result of the test
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate data
data(df1, package = 'ptmixed')

# estimate one of the following models: a Poisson-Tweedie or 
# negative binomial GLMM (using ptmixed() or nbmixed()), or
# a Poisson-Tweedie or negative binomial GLM (using ptglm() 
# or nbgml())
fit1 = nbglm(formula = y ~ group*time, data = df1)

# define L for beta2 = beta4 = 0
L = matrix(0, nrow = 2, ncol = 4)
L[1, 2] = L[2, 4] = 1
              
# compute multivariate Wald test
wald.test(obj = fit1, L = L, k = NULL)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
