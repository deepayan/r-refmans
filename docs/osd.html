<!DOCTYPE html><html><head><title>Help for package osd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {osd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gcms1'><p>Data from a GC-MS experiment</p></a></li>
<li><a href='#gcms2'><p>Data from a GC-MS experiment</p></a></li>
<li><a href='#normalize'><p>Matrix or vector normalization</p></a></li>
<li><a href='#osd'><p>Orthogonal Signal Deconvolution</p></a></li>
<li><a href='#plotOSDres'>
<p>Plotting OSD objects</p></a></li>
<li><a href='#ref.spects'><p>Five MS reference spectra from the MassBank MS library for spectra comparison</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Orthogonal Signal Deconvolution for Spectra Deconvolution in
GC-MS and GCxGC-MS Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-3-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Xavier Domingo-Almenara </td>
</tr>
<tr>
<td>Imports:</td>
<td>JADE, nnls</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xavier Domingo-Almenara &lt;xavier.domingo@urv.cat&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Compound deconvolution for chromatographic data, including gas chromatography - mass spectrometry (GC-MS) and comprehensive gas chromatography - mass spectrometry (GCxGC-MS). The package includes functions to perform independent component analysis - orthogonal signal deconvolution (ICA-OSD), independent component regression (ICR), multivariate curve resolution (MCR-ALS) and orthogonal signal deconvolution (OSD) alone.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-03-09 18:02:37 UTC; xavidomingoalmenara</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-03-10 00:10:22</td>
</tr>
</table>
<hr>
<h2 id='gcms1'>Data from a GC-MS experiment</h2><span id='topic+gcms1'></span>

<h3>Description</h3>

<p>A data matrix from a real pure standards GC-MS experiment.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gcms1)
</code></pre>


<h3>Details</h3>

<p>Data taken from the experiment used in [1] (See references below). This data matrix includes three compounds appearing in co-elution, concretely, the appearing compounds are: nicotinic acid, isoleucine and profile. The data in <code><a href="#topic+gcms1">gcms1</a></code> and <code><a href="#topic+gcms2">gcms2</a></code> only comprises the m/z from 35 to 600. So the first element of the column in <code>gcms1</code> corresponds to the mass m/z 35. Please, note that the fragments at m/z 73, 74, 75, 147, 148, and 149, were excluded from the analysis (have zero intensity).
</p>


<h3>Author(s)</h3>

<p>[1] Domingo-Almenara X, et al. Compound deconvolution in GC-MS-based metabolomics by blind source separation. Journal of Chromatography A (2015). Vol. 1409: 226-233. DOI: 10.1016/j.chroma.2015.07.044
</p>


<h3>See Also</h3>

<p><code><a href="#topic+osd">osd</a></code>, <code><a href="#topic+gcms2">gcms2</a></code>, <code><a href="#topic+ref.spects">ref.spects</a></code>

</p>

<hr>
<h2 id='gcms2'>Data from a GC-MS experiment</h2><span id='topic+gcms2'></span>

<h3>Description</h3>

<p>A data matrix from a real pure standards GC-MS experiment.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gcms2)
</code></pre>


<h3>Details</h3>

<p>Data taken from the experiment used in [1] (See references below). This data matrix includes two compounds appearing in co-elution, concretely, the appearing compounds are: methionine and aspartic acid. The data in <code><a href="#topic+gcms1">gcms1</a></code> and <code><a href="#topic+gcms2">gcms2</a></code> only comprises the m/z from 35 to 600. So the first element of the column in <code>gcms2</code> corresponds to the mass m/z 35. Please, note that the fragments at m/z 73, 74, 75, 147, 148, and 149, were excluded from the analysis (have zero intensity).
</p>


<h3>Author(s)</h3>

<p>[1] Domingo-Almenara X, et al. Compound deconvolution in GC-MS-based metabolomics by blind source separation. Journal of Chromatography A (2015). Vol. 1409: 226-233. DOI: 10.1016/j.chroma.2015.07.044
</p>


<h3>See Also</h3>

<p><code><a href="#topic+osd">osd</a></code>, <code><a href="#topic+gcms1">gcms1</a></code>, <code><a href="#topic+ref.spects">ref.spects</a></code>

</p>

<hr>
<h2 id='normalize'>Matrix or vector normalization</h2><span id='topic+normalize'></span>

<h3>Description</h3>

<p>Normalizes a vector o a matrix in the form of x/max(x). Is is a matrix, a column-normalization is performed, which is equivalent to apply(x,2,function(x) x/max(x)). </p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_+3A_x">x</code></td>
<td>
<p>a <code>vector</code> or a <code>matrix</code> to be normalized</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the normalized vector o matrix.




</p>

<hr>
<h2 id='osd'>Orthogonal Signal Deconvolution</h2><span id='topic+osd'></span>

<h3>Description</h3>

<p>Wrapper to use OSD, or OSD along with ICA (ICA-OSD), MCR (MCR-OSD), and also ICR.</p>


<h3>Usage</h3>

<pre><code class='language-R'>osd(D, k, y.profile, 
res.method = c("ica.osd", "osd", "icr", "mcr"), 
comp.coef = 2, noise.thr = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="osd_+3A_d">D</code></td>
<td>
<p>data matrix, where rows are the retention time and columns are the m/z.</p>
</td></tr>
<tr><td><code id="osd_+3A_k">k</code></td>
<td>
<p>number of components in the model, i.e., the number of compounds to be extracted from data. (Only when methods ICA-OSD, MCR or ICR are used.)</p>
</td></tr>
<tr><td><code id="osd_+3A_y.profile">y.profile</code></td>
<td>
<p>the vector containing the estimated elution profile of the compound which spectrum wants to be deconvolved. (Only when method OSD is used.)</p>
</td></tr>
<tr><td><code id="osd_+3A_res.method">res.method</code></td>
<td>
<p>the method to be used, including &quot;ica.osd&quot;,&quot;mcr.osd&quot;,&quot;icr&quot;,&quot;mcr&quot;. See details for more information.</p>
</td></tr>
<tr><td><code id="osd_+3A_comp.coef">comp.coef</code></td>
<td>
<p>the non-linear factor of compression. See details for more information.</p>
</td></tr>
<tr><td><code id="osd_+3A_noise.thr">noise.thr</code></td>
<td>
<p>this value can be set from 0 to 1. Data in D under this relative threshold is set to zero to reduce the computational cost. Default is 0.01.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methods are described in [1] and [2] (See references below). OSD is an improved method for spectra extraction from chromatographic data tested in GC-MS and GCxGC samples. 
</p>
<p>For tradicional multivariate curve resolution select &quot;mcr&quot; algorithm. Indepenent component regression is also implemented, and can be selected by choosing &quot;icr&quot; method. The OSD implementations using ICA can be used by &quot;ica.osd&quot;. Also, OSD can be used alone, for retrieving a purest spectrum if the estimated elution profile of the compound (which spectrum is to be deconvolved) is given. 
</p>


<h3>Value</h3>

<p><code>osd</code> returns an S3 object.
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>the original data matrix.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>the resolved profile or concentration matrix.</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>the resolved spectra matrix.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>the number of components used in the model.</p>
</td></tr>
<tr><td><code>y.profile</code></td>
<td>
<p>the estimated elution profile for OSD.</p>
</td></tr>
<tr><td><code>res.method</code></td>
<td>
<p>the method used for resolution.</p>
</td></tr>
<tr><td><code>comp.coef</code></td>
<td>
<p>the non-linear compression coeficient selected.</p>
</td></tr>
<tr><td><code>noise.thr</code></td>
<td>
<p>the noise threshold selected.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Domingo-Almenara X, et al. Compound deconvolution in GC-MS-based metabolomics by blind source separation. Journal of Chromatography A (2015). Vol. 1409: 226-233. DOI: 10.1016/j.chroma.2015.07.044
</p>
<p>[2] Domingo-Almenara X, et al. Automated resolution of chromatographic signals by independent component analysis - orthogonal signal deconvolution in comprehensive gas chromatography/mass spectrometry-based metabolomics. Computer Methods and Programs in Biomedicine (2016). DOI: 10.1016/j.cmpb.2016.03.007: 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+osd">osd</a></code>, <code><a href="#topic+plotOSDres">plotOSDres</a></code>, <code><a href="#topic+gcms1">gcms1</a></code>, <code><a href="#topic+gcms2">gcms2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#load GC-MS sample data, containing three different metabolites 
#appearing in co-elution.
data(gcms1)

#resolve the situation using ICA-OSD algorithm
resolution &lt;- osd(D=gcms1, k=3, res.method='ica.osd')

#plot the resolution, the extracted ion chromatogram (m/z) are plotted in 
#grey whereas the profile matrix appear in color.
plotOSDres(resolution, type='eic')

#plot each resolved spectra for compound 1 to 3.
plotOSDres(resolution, type='s',1)
plotOSDres(resolution, type='s',2)
plotOSDres(resolution, type='s',3)


</code></pre>

<hr>
<h2 id='plotOSDres'>
Plotting OSD objects</h2><span id='topic+plotOSDres'></span>

<h3>Description</h3>

<p>Plots the results determined by <code>osd</code> function. Profile or spectra resolution can be selected for visualization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotOSDres(OSDobj, type = c("eic", "tic", "s"), ncomp = vector(),
 comp.spectra = vector(), mztxt.top = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotOSDres_+3A_osdobj">OSDobj</code></td>
<td>
<p>the <code>osd</code> selected for plotting</p>
</td></tr>
<tr><td><code id="plotOSDres_+3A_type">type</code></td>
<td>
<p>the type of resolution to be plotted. Concentration resolution can be shown by its extracted ion chromatogram (EIC) &quot;eic&quot; or by its ion total chromatogram &quot;tic&quot;. Also, the spectra for each compound in the model can be shown by &quot;s&quot;.</p>
</td></tr>
<tr><td><code id="plotOSDres_+3A_ncomp">ncomp</code></td>
<td>
<p>vector; the compounds to be plotted. If spectra is selected for visualization, please select only one compound to plot.</p>
</td></tr>
<tr><td><code id="plotOSDres_+3A_comp.spectra">comp.spectra</code></td>
<td>
<p>a vector to compare a resolved spectra with.</p>
</td></tr>
<tr><td><code id="plotOSDres_+3A_mztxt.top">mztxt.top</code></td>
<td>
<p>integer; the number of the m/z values ordered by intensity to visualize on the spectra plot</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat</p>


<h3>See Also</h3>

<p><code><a href="#topic+osd">osd</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load GC-MS sample data, containing three different metabolites 
#appearing in co-elution.
data(gcms1)

#resolve the situation using ICA-OSD algorithm
resolution &lt;- osd(D=gcms1, k=3, res.method="ica.osd")

#plot the resolution, the extracted ion chromatogram (m/z) are plotted 
# in grey whereas the profile matrix appear in color.
plotOSDres(resolution, type="eic")
plotOSDres(resolution, type="tic")

#plot each resolved spectra for compound 1 to 3.
plotOSDres(resolution, type="s",1)
plotOSDres(resolution, type="s",2)
plotOSDres(resolution, type="s",3)
</code></pre>

<hr>
<h2 id='ref.spects'>Five MS reference spectra from the MassBank MS library for spectra comparison</h2><span id='topic+ref.spects'></span>

<h3>Description</h3>

<p>A data matrix from a real pure standards GC-MS experiment.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ref.spects)
</code></pre>


<h3>Details</h3>

<p>The data includes a list of five vectors containing 5 MS spectra from the  MassBank MS library [1]. Concretely, the spectra are Methionine 2TMS, Aspartic Acid 3TMS, Nicotinic Acid 1TMS, Isoleucine 2TMS and Proline 2TMS. These are the compounds appearing in the examples given in <code><a href="#topic+gcms1">gcms1</a></code> and <code><a href="#topic+gcms2">gcms2</a></code>.
</p>


<h3>Author(s)</h3>

<p>[1] MassBank: A public repository for sharing mass spectral data for life sciences&quot;, H. Horai, M. Arita, S. Kanaya, Y. Nihei, T. Ikeda, K. Suwa. Y. Ojima, K. Tanaka, S. Tanaka, K. Aoshima, Y. Oda, Y. Kakazu, M. Kusano, T. Tohge, F. Matsuda, Y. Sawada, M. Yokota Hirai, H. Nakanishi, K. Ikeda, N. Akimoto, T. Maoka, H. Takahashi, T. Ara, N. Sakurai, H. Suzuki, D. Shibata, S. Neumann, T. Iida, K. Tanaka, K. Funatsu, F. Matsuura, T. Soga, R. Taguchi, K. Saito and T. Nishioka, J. Mass Spectrom., 45, 703-714 (2010)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+osd">osd</a></code>, <code><a href="#topic+gcms1">gcms1</a></code>, <code><a href="#topic+gcms2">gcms2</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
	#load GC-MS sample data, containing three different metabolites
	# appearing in co-elution.
	data(gcms1)
	data(ref.spects)

	#resolve the situation using ICA-OSD algorithm
	resolution &lt;- osd(D=gcms1, k=3, res.method="ica.osd")

	#plot each resolved spectra for compound 1 to 3.
	ref.sp &lt;- ref.spects$nicotinicacid1[-c(1:34)]
	plotOSDres(resolution, type="s",1,comp.spectra=ref.sp)
	
	# note that from the spectra the first 34 
	# values are omitted, this is because the original
	# spectra given comprises the masses from 1 to 600, 
	# whereas the data in gcms1 and gcms2 
	# only comprises the m/z from 35 to 600.
	
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
