<!DOCTYPE html><html lang="en"><head><title>Help for package mcmsupply</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mcmsupply}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mcmsupply-package'><p>mcmsupply: Estimating Public and Private Sector Contraceptive Market Supply Shares</p></a></li>
<li><a href='#Country_and_area_classification'><p>The Country and area classification according to the United Nations Standaistical Division, Standard country or area codes for statistical use (M49).</p>
Adapted for use in FP2030 by the Track20 project.
A subset of data from the United Nations country classifications</a></li>
<li><a href='#country_names'><p>The names of the countries with national and subnational administration level data stored</p></a></li>
<li><a href='#DEFT_DHS_database'><p>DEFT_DHS_database</p>
A database of the design effects for some of the DHS surveys in the national and subnational datasets.
Due to due to multistage and clustering of the DHS sample, the average standard error is increased by a design effect (DEFT) factor over that in an equivalent simple random sample.</a></li>
<li><a href='#get_data'><p>Wrapper function that retrieves the DHS data used for modelling the</p>
proportion of modern contraceptives supplied by the public and private
sectors at the national and subnational administration levels.</a></li>
<li><a href='#get_posterior_P_samps'><p>Function to pull the complete posterior sample for the national method-supply share estimates. Functionality for the subnational models is still under development.</p></a></li>
<li><a href='#get_subnational_modelinputs'><p>Get JAGS model inputs</p></a></li>
<li><a href='#national_estimated_correlations_bivarlogitnormal'><p>The estimated national-level correlations between the rates of change in methods</p></a></li>
<li><a href='#national_FPsource_data'><p>DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level</p></a></li>
<li><a href='#national_FPsource_format'><p>A checklist for ensuring national-level custom data is appropriate to be used for estimation</p></a></li>
<li><a href='#national_FPsource_VARCOV_bivarlogitnormal'><p>An array of variance-covariance matrices corresponding to the DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level</p></a></li>
<li><a href='#national_inv_sigma_delta_hat_bivarlogitnorm'><p>The median estimate for the national-level variance-covariance matrix of the delta.k terms in the multi-country national model.</p></a></li>
<li><a href='#national_tau_alpha_cms_hat_bivarlogitnorm'><p>The median estimates of the precision for the national-level country, sector-, method-specific intercepts in the multi-country national model.</p>
This vector is used to inform the precision in the Normal prior of the national-level intercept in single-country national models.</a></li>
<li><a href='#national_theta_rms_hat_bivarlogitnorm'><p>The median estimates of the national-level sub-continental, sector-, method-specific intercepts in the multi-country national model.</p>
This array is used to inform the Normal prior of the country-level intercept in the single-country national model.</a></li>
<li><a href='#national_varcov_order_bivarlogitnormal'><p>The order of observations to join the variance-covariance array data and the DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level</p></a></li>
<li><a href='#plot_estimates'><p>Wrapper function to plot the JAGS estimates</p></a></li>
<li><a href='#pull_estimates'><p>Function to pull method-supply share median estimates and credible intervals for a given year and country.</p></a></li>
<li><a href='#run_jags_model'><p>Wrapper function to run the jags model for estimating the proportion of modern contraceptive methods supplied by the public &amp; private Sectors using a Bayesian hierarchical penalized spline model for the national and subnational administration levels</p></a></li>
<li><a href='#subnat_FPsource_data'><p>DHS survey observations for the proportion of modern contraceptives</p>
supplied by the public and private sectors at the subnational
administration level.</a></li>
<li><a href='#subnat_FPsource_format'><p>A checklist for ensuring subnational-level custom data is appropriate to be used for estimation</p></a></li>
<li><a href='#subnational_alpha_cms_hat'><p>The median estimates of the subnational-level country, sector-, method-specific intercepts in the multi-country subnational model.</p>
This array is used to inform the Normal prior of the subnational-level intercept in the single-country subnational model.</a></li>
<li><a href='#subnational_estimated_correlations'><p>The estimated subnational-level correlations between the rates of change in methods</p></a></li>
<li><a href='#subnational_inv.sigma_delta_hat'><p>The median estimate for the subnational-level precision matrix of the delta.k terms in the multi-country subnational model.</p>
This array is used to inform the multi-variate normal prior in the single-country subnational model.</a></li>
<li><a href='#subnational_tau_alpha_pms_hat'><p>subnational_tau_alpha_pms_hat</p>
The median estimates of the precision for the subnational-level country, sector-, method-specific intercepts in the multi-country subnational model.
This vector is used to inform the precision in the Normal prior of the subnational-level intercept in single-country subnational models.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating Public and Private Sector Contraceptive Market Supply
Shares</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Family Planning programs and initiatives typically use nationally representative surveys to estimate key indicators of a countryâ€™s family planning progress. However, in recent years, routinely collected family planning services data (Service Statistics) have been used as a supplementary data source to bridge gaps in the surveys. The use of service statistics comes with the caveat that adjustments need to be made for missing private sector contributions to the contraceptive method supply chain. Evaluating the supply source of modern contraceptives often relies on Demographic Health Surveys (DHS), where many countries do not have recent data beyond 2015/16. Fortunately, in the absence of recent surveys we can rely on statistical model-based estimates and projections to fill the knowledge gap. We present a Bayesian, hierarchical, penalized-spline model with multivariate-normal spline coefficients, to account for across method correlations, to produce country-specific,annual estimates for the proportion of modern contraceptive methods coming from the public and private sectors. This package provides a quick and convenient way for users to access the DHS modern contraceptive supply share data at national and subnational administration levels, estimate, evaluate and plot annual estimates with uncertainty for a sample of low- and middle-income countries. Methods for the estimation of method supply shares at the national level are described in Comiskey, Alkema, Cahill (2022) &lt;<a href="https://doi.org/10.48550/arXiv.2212.03844">doi:10.48550/arXiv.2212.03844</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>R2jags, magrittr, foreach, tidyverse, tidybayes, runjags,
stats, rlang, abind, dplyr, ggplot2, plyr, readxl, stringr,
tibble, tidyr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://hannahcomiskey.github.io/mcmsupply/">https://hannahcomiskey.github.io/mcmsupply/</a>,
<a href="https://hannahcomiskey.github.io/mcmsupply/">https://hannahcomiskey.github.io/mcmsupply/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-15 15:50:52 UTC; hannahcomiskey</td>
</tr>
<tr>
<td>Author:</td>
<td>Hannah Comiskey [aut, cre],
  Niamh Cahill [aut],
  Leontine Alkema [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hannah Comiskey &lt;hannah.comiskey.2015@mumail.ie&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-18 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mcmsupply-package'>mcmsupply: Estimating Public and Private Sector Contraceptive Market Supply Shares</h2><span id='topic+mcmsupply'></span><span id='topic+mcmsupply-package'></span>

<h3>Description</h3>

<p>Family Planning programs and initiatives typically use nationally representative surveys to estimate key indicators of a countryâ€™s family planning progress. However, in recent years, routinely collected family planning services data (Service Statistics) have been used as a supplementary data source to bridge gaps in the surveys. The use of service statistics comes with the caveat that adjustments need to be made for missing private sector contributions to the contraceptive method supply chain. Evaluating the supply source of modern contraceptives often relies on Demographic Health Surveys (DHS), where many countries do not have recent data beyond 2015/16. Fortunately, in the absence of recent surveys we can rely on statistical model-based estimates and projections to fill the knowledge gap. We present a Bayesian, hierarchical, penalized-spline model with multivariate-normal spline coefficients, to account for across method correlations, to produce country-specific,annual estimates for the proportion of modern contraceptive methods coming from the public and private sectors. This package provides a quick and convenient way for users to access the DHS modern contraceptive supply share data at national and subnational administration levels, estimate, evaluate and plot annual estimates with uncertainty for a sample of low- and middle-income countries. Methods for the estimation of method supply shares at the national level are described in Comiskey, Alkema, Cahill (2022) <a href="https://arxiv.org/abs/2212.03844">arXiv:2212.03844</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hannah Comiskey <a href="mailto:hannah.comiskey.2015@mumail.ie">hannah.comiskey.2015@mumail.ie</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Niamh Cahill
</p>
</li>
<li><p> Leontine Alkema
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://hannahcomiskey.github.io/mcmsupply/">https://hannahcomiskey.github.io/mcmsupply/</a>
</p>
</li>
<li> <p><a href="https://hannahcomiskey.github.io/mcmsupply/">https://hannahcomiskey.github.io/mcmsupply/</a>
</p>
</li></ul>


<hr>
<h2 id='Country_and_area_classification'>The Country and area classification according to the United Nations Standaistical Division, Standard country or area codes for statistical use (M49).
Adapted for use in FP2030 by the Track20 project.
A subset of data from the United Nations country classifications</h2><span id='topic+Country_and_area_classification'></span>

<h3>Description</h3>

<p>The Country and area classification according to the United Nations Standaistical Division, Standard country or area codes for statistical use (M49).
Adapted for use in FP2030 by the Track20 project.
A subset of data from the United Nations country classifications
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Country_and_area_classification
</code></pre>


<h3>Format</h3>

<p>A data frame with 231 rows and 8 columns:
</p>

<dl>
<dt>Country or area</dt><dd><p>Country name</p>
</dd>
<dt>ISO Code</dt><dd><p>1, 2 &amp; 3 number ISO country codes</p>
</dd>
<dt>Major area</dt><dd><p>Continent</p>
</dd>
<dt>Region</dt><dd><p>Sub-continent</p>
</dd>
<dt>Developed region</dt><dd><p>Binary indicator for development status</p>
</dd>
<dt>Least developed country</dt><dd><p>Binary indicator for least developed status</p>
</dd>
<dt>Sub-Saharan Africa</dt><dd><p>Binary indicator for whether country is in Sub-Saharan Africa</p>
</dd>
<dt>FP2020</dt><dd><p>Binary indicator for FP2020 participation status</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://unstats.un.org/unsd/methodology/m49/
</p>

<hr>
<h2 id='country_names'>The names of the countries with national and subnational administration level data stored</h2><span id='topic+country_names'></span>

<h3>Description</h3>

<p>The names of the countries with national and subnational administration level data stored
</p>


<h3>Usage</h3>

<pre><code class='language-R'>country_names
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and 3 columns:
</p>

<dl>
<dt>Country names</dt><dd><p>Country name</p>
</dd>
<dt>National level data available</dt><dd><p>Indicator for whether data at the national administration level is available in the package</p>
</dd>
<dt>Subnational level data available</dt><dd><p>Indicator for whether data at the subnational administration level is available in the package</p>
</dd>
</dl>


<hr>
<h2 id='DEFT_DHS_database'>DEFT_DHS_database
A database of the design effects for some of the DHS surveys in the national and subnational datasets.
Due to due to multistage and clustering of the DHS sample, the average standard error is increased by a design effect (DEFT) factor over that in an equivalent simple random sample.</h2><span id='topic+DEFT_DHS_database'></span>

<h3>Description</h3>

<p>DEFT_DHS_database
A database of the design effects for some of the DHS surveys in the national and subnational datasets.
Due to due to multistage and clustering of the DHS sample, the average standard error is increased by a design effect (DEFT) factor over that in an equivalent simple random sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DEFT_DHS_database
</code></pre>


<h3>Format</h3>

<p>A dataframe of Country names, survey year and design effects for DHS surveys
</p>


<h3>Source</h3>

<p>DHS final reports Appendix B, 'ESTIMATES OF SAMPLING ERRORS'.
</p>

<hr>
<h2 id='get_data'>Wrapper function that retrieves the DHS data used for modelling the
proportion of modern contraceptives supplied by the public and private
sectors at the national and subnational administration levels.</h2><span id='topic+get_data'></span>

<h3>Description</h3>

<p>Wrapper function that retrieves the DHS data used for modelling the
proportion of modern contraceptives supplied by the public and private
sectors at the national and subnational administration levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data(
  national = TRUE,
  local = FALSE,
  mycountry = NULL,
  fp2030 = TRUE,
  surveydata_filepath = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_+3A_national">national</code></td>
<td>
<p>TRUE/FALSE. Default is TRUE for national administration level
data. FALSE retrieves subnational level data.</p>
</td></tr>
<tr><td><code id="get_data_+3A_local">local</code></td>
<td>
<p>TRUE/FALSE. Default is FALSE for global runs. Decides if this is
a single-country or global run.</p>
</td></tr>
<tr><td><code id="get_data_+3A_mycountry">mycountry</code></td>
<td>
<p>The name of country of interest. Default is NULL. For the
names of potential countries, review vigentte.</p>
</td></tr>
<tr><td><code id="get_data_+3A_fp2030">fp2030</code></td>
<td>
<p>Default is TRUE. Filter raw data to only include the Family
Planning 2030 focus countries discussed in the Comiskey et al. paper.</p>
</td></tr>
<tr><td><code id="get_data_+3A_surveydata_filepath">surveydata_filepath</code></td>
<td>
<p>Path to survey data. Default is NULL. Survey data
should be a .xlsx with the following format <code><a href="#topic+national_FPsource_data">national_FPsource_data</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a list containing the DHS data set used for inputs into the
model and the arguments that specify the data set up.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
raw_data &lt;- get_data(national=FALSE, local=TRUE, mycountry="Nepal")

</code></pre>

<hr>
<h2 id='get_posterior_P_samps'>Function to pull the complete posterior sample for the national method-supply share estimates. Functionality for the subnational models is still under development.</h2><span id='topic+get_posterior_P_samps'></span>

<h3>Description</h3>

<p>Function to pull the complete posterior sample for the national method-supply share estimates. Functionality for the subnational models is still under development.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_posterior_P_samps(jagsdata, model_output, nposterior)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_posterior_P_samps_+3A_jagsdata">jagsdata</code></td>
<td>
<p>The inputs for the JAGS model</p>
</td></tr>
<tr><td><code id="get_posterior_P_samps_+3A_model_output">model_output</code></td>
<td>
<p>The output of the mcmsupply::run_jags_model() function.</p>
</td></tr>
<tr><td><code id="get_posterior_P_samps_+3A_nposterior">nposterior</code></td>
<td>
<p>The number of posterior samples you wish to pull.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the posterior samples of national method-supply share estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
raw_data &lt;- get_data(national=TRUE, local=TRUE, mycountry="Nepal")
jagsdata &lt;- get_modelinputs(startyear=1990, endyear=2025.5, nsegments=12, raw_data)
mod &lt;- run_jags_model(jagsdata = jagsdata, jagsparams = NULL, n_iter = 5, n_burnin = 1, n_thin = 1)
post_samps &lt;- get_posterior_P_samps(jagsdata = jagsdata, model_output = mod, nposterior=4)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_subnational_modelinputs'>Get JAGS model inputs</h2><span id='topic+get_subnational_modelinputs'></span><span id='topic+get_modelinputs'></span>

<h3>Description</h3>

<p>Get JAGS model inputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_modelinputs(
  startyear = 1990,
  endyear = 2030.5,
  nsegments = 12,
  raw_data,
  varcov_array_filepath = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_subnational_modelinputs_+3A_startyear">startyear</code></td>
<td>
<p>The year you wish to begin your predictions from. Default is 1990.</p>
</td></tr>
<tr><td><code id="get_subnational_modelinputs_+3A_endyear">endyear</code></td>
<td>
<p>The year you wish to finish your predictions. Default is 2030.5.</p>
</td></tr>
<tr><td><code id="get_subnational_modelinputs_+3A_nsegments">nsegments</code></td>
<td>
<p>The number of knots you wish to use in your basis functions. Default is 12.</p>
</td></tr>
<tr><td><code id="get_subnational_modelinputs_+3A_raw_data">raw_data</code></td>
<td>
<p>The list of arguments and family planning source data from the 'get_data' function.</p>
</td></tr>
<tr><td><code id="get_subnational_modelinputs_+3A_varcov_array_filepath">varcov_array_filepath</code></td>
<td>
<p>Path to calculated variance-covariance array associated with the custom supplied FP source data. Default is NULL. Covariance data should be a .RDS file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of modelling inputs for the JAGS model.
</p>

<ol>
<li><p> Tstar is the year index for the most recent survey in each province.
</p>
</li>
<li><p> Kstar is the knot index that aligns with Tstar.
</p>
</li>
<li><p> B.ik are the basis functions.
</p>
</li>
<li><p> n_years are total number of years
</p>
</li>
<li><p> n_obs  are the total number of observations
</p>
</li>
<li><p> K are the number of knots.
</p>
</li>
<li><p> H is K-1. Used in the calculation of first order differences of spline coefficients.
</p>
</li>
<li><p> P_count is the number of subnational provinces/regions.
</p>
</li>
<li><p> M_count is the number of modern contraceptive methods.
</p>
</li>
<li><p> matchsubnat is the subnational province indexing to match the observed data to the predictions.
</p>
</li>
<li><p> matchcountry is the country indexing to match the observed data to the predictions.
</p>
</li>
<li><p> matchmethod is the method indexing to match the observed data to the predictions.
</p>
</li>
<li><p> matchyears is the year indexing to match the observed data to the predictions.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
raw_data &lt;- get_data(national=FALSE, local=TRUE, mycountry="Nepal")
jagsdata &lt;- get_modelinputs(startyear=1990, endyear=2030.5, nsegments=12, raw_data)

</code></pre>

<hr>
<h2 id='national_estimated_correlations_bivarlogitnormal'>The estimated national-level correlations between the rates of change in methods</h2><span id='topic+national_estimated_correlations_bivarlogitnormal'></span>

<h3>Description</h3>

<p>The estimated national-level correlations between the rates of change in methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>national_estimated_correlations_bivarlogitnormal
</code></pre>


<h3>Format</h3>

<p>A array of 2 matrices with 5 rows and 5 columns:
</p>

<dl>
<dt>row</dt><dd><p>Contraceptive method the correlation estimate refers to</p>
</dd>
<dt>column</dt><dd><p>Contraceptive method the correlation estimate refers to</p>
</dd>
<dt>public_cor</dt><dd><p>The estimated correlation between the rates of change in methods supplied by the public sector</p>
</dd>
<dt>private_cor</dt><dd><p>The estimated correlation between the rates of change in methods supplied by the private sector</p>
</dd>
</dl>


<hr>
<h2 id='national_FPsource_data'>DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level</h2><span id='topic+national_FPsource_data'></span>

<h3>Description</h3>

<p>DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>national_FPsource_data
</code></pre>


<h3>Format</h3>



<h4><code>national_FPsource_data</code></h4>

<p>A data frame with 562 rows and 15 columns:
</p>

<dl>
<dt>Country</dt><dd><p>Country names</p>
</dd>
<dt>Method</dt><dd><p>Contraceptive method name</p>
</dd>
<dt>average_year</dt><dd><p>Average year of the survey</p>
</dd>
<dt>year</dt><dd><p>Year of the survey</p>
</dd>
<dt>country_code</dt><dd><p>ISO country codes</p>
</dd>
<dt>Public</dt><dd><p>Proportion supplied by the Public sector</p>
</dd>
<dt>se.Public</dt><dd><p>Standard error of proportion supplied by the Public sector</p>
</dd>
<dt>Public_n</dt><dd><p>Sample size used to calculate proportion supplied by the Public sector</p>
</dd>
<dt>Commercial_medical</dt><dd><p>Proportion supplied by the private Commercial medical sector</p>
</dd>
<dt>se.Commercial_medical</dt><dd><p>Standard error of proportion supplied by the private Commercial medical sector</p>
</dd>
<dt>Commercial_medical_n</dt><dd><p>Sample size used to calculate proportion supplied by the private Commercial medical sector</p>
</dd>
<dt>Other</dt><dd><p>Proportion supplied by the private Other sector</p>
</dd>
<dt>se.Other</dt><dd><p>Standard error of proportion supplied by the private Other sector</p>
</dd>
<dt>Other_n</dt><dd><p>Sample size used to calculate proportion supplied by the private Other sector</p>
</dd>
<dt>check_sum</dt><dd><p>Check to see if proportions sum to 1</p>
</dd>
</dl>




<h3>Source</h3>

<p>On request from DHS microdata - using the womens individuals recode file. Contact details found at https://dhsprogram.com/data/dataset_admin/login_main.cfm
</p>

<hr>
<h2 id='national_FPsource_format'>A checklist for ensuring national-level custom data is appropriate to be used for estimation</h2><span id='topic+national_FPsource_format'></span>

<h3>Description</h3>

<p>A checklist for ensuring national-level custom data is appropriate to be used for estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>national_FPsource_format
</code></pre>


<h3>Format</h3>

<p>A list of requirements for custom data to meet before being accepted into the model
</p>

<dl>
<dt>Country</dt><dd><p>Country name variable classification</p>
</dd>
<dt>Method</dt><dd><p>Method name variable classification</p>
</dd>
<dt>average_year</dt><dd><p>average_year variable classification</p>
</dd>
<dt>sector_category</dt><dd><p>sector_category name variable classification</p>
</dd>
<dt>proportion</dt><dd><p>proportion variable classification</p>
</dd>
<dt>SE.proportion</dt><dd><p>SE.proportion variable classification</p>
</dd>
<dt>n</dt><dd><p>n variable classification</p>
</dd>
</dl>


<hr>
<h2 id='national_FPsource_VARCOV_bivarlogitnormal'>An array of variance-covariance matrices corresponding to the DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level</h2><span id='topic+national_FPsource_VARCOV_bivarlogitnormal'></span>

<h3>Description</h3>

<p>An array of variance-covariance matrices corresponding to the DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>national_FPsource_VARCOV_bivarlogitnormal
</code></pre>


<h3>Format</h3>



<h4><code>national_FPsource_VARCOV_bivarlogitnormal</code></h4>

<p>An array of 2x2 matrices for each of the 558 observations in the national_FPsource_data.
Each 2x2 array corresponds to the variance of the public and private sectors on the diagonal and their corresponding covariances on the off-diagonal.
</p>



<h3>Source</h3>

<p>The variance-covariance matrices are calculated using the survey R package:
prop_mat &lt;- svyby(~I(sector_categories), ~I(modern_method_source), design=d.s, svymean, covmat=TRUE)
vcov_matrix &lt;- vcov(prop_mat) function.
</p>

<hr>
<h2 id='national_inv_sigma_delta_hat_bivarlogitnorm'>The median estimate for the national-level variance-covariance matrix of the delta.k terms in the multi-country national model.</h2><span id='topic+national_inv_sigma_delta_hat_bivarlogitnorm'></span>

<h3>Description</h3>

<p>The median estimate for the national-level variance-covariance matrix of the delta.k terms in the multi-country national model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>national_inv_sigma_delta_hat_bivarlogitnorm
</code></pre>


<h3>Format</h3>

<p>A array of 2 matrices with 5 rows and 5 columns:
</p>

<dl>
<dt>Array 1</dt><dd><p>Estimated public sector variance-covaraince matrix</p>
</dd>
<dt>Array 2</dt><dd><p>Estimated private sector variance-covaraince matrix</p>
</dd>
</dl>


<hr>
<h2 id='national_tau_alpha_cms_hat_bivarlogitnorm'>The median estimates of the precision for the national-level country, sector-, method-specific intercepts in the multi-country national model.
This vector is used to inform the precision in the Normal prior of the national-level intercept in single-country national models.</h2><span id='topic+national_tau_alpha_cms_hat_bivarlogitnorm'></span>

<h3>Description</h3>

<p>The median estimates of the precision for the national-level country, sector-, method-specific intercepts in the multi-country national model.
This vector is used to inform the precision in the Normal prior of the national-level intercept in single-country national models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>national_tau_alpha_cms_hat_bivarlogitnorm
</code></pre>


<h3>Format</h3>

<p>A vector of two precision estimates
</p>

<hr>
<h2 id='national_theta_rms_hat_bivarlogitnorm'>The median estimates of the national-level sub-continental, sector-, method-specific intercepts in the multi-country national model.
This array is used to inform the Normal prior of the country-level intercept in the single-country national model.</h2><span id='topic+national_theta_rms_hat_bivarlogitnorm'></span>

<h3>Description</h3>

<p>The median estimates of the national-level sub-continental, sector-, method-specific intercepts in the multi-country national model.
This array is used to inform the Normal prior of the country-level intercept in the single-country national model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>national_theta_rms_hat_bivarlogitnorm
</code></pre>


<h3>Format</h3>

<p>A array of 6 matrices with 2 rows and 5 columns
</p>

<hr>
<h2 id='national_varcov_order_bivarlogitnormal'>The order of observations to join the variance-covariance array data and the DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level</h2><span id='topic+national_varcov_order_bivarlogitnormal'></span>

<h3>Description</h3>

<p>The order of observations to join the variance-covariance array data and the DHS survey observations for the proportion of modern contraceptives supplied by the public and private sectors at the national level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>national_varcov_order_bivarlogitnormal
</code></pre>


<h3>Format</h3>



<h4><code>national_varcov_order_bivarlogitnormal</code></h4>

<p>A data frame with 558 rows and 3 columns:
</p>

<dl>
<dt>Country</dt><dd><p>Country names</p>
</dd>
<dt>average_year</dt><dd><p>Average year of the survey</p>
</dd>
<dt>Method</dt><dd><p>Contraceptive method name</p>
</dd>
</dl>




<h3>Source</h3>

<p>On request from DHS microdata - using the womens individuals recode file. Contact details found at https://dhsprogram.com/data/dataset_admin/login_main.cfm
</p>

<hr>
<h2 id='plot_estimates'>Wrapper function to plot the JAGS estimates</h2><span id='topic+plot_estimates'></span>

<h3>Description</h3>

<p>Wrapper function to plot the JAGS estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_estimates(jagsdata, model_output)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_estimates_+3A_jagsdata">jagsdata</code></td>
<td>
<p>Output of the mcmsupply::get_modelinputs() function.</p>
</td></tr>
<tr><td><code id="plot_estimates_+3A_model_output">model_output</code></td>
<td>
<p>The output of the mcmsupply::run_jags_model() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of ggplot objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
raw_data &lt;- get_data(national=TRUE, local=TRUE, mycountry="Nepal")
jagsdata &lt;- get_modelinputs(startyear=1990, endyear=2030.5, nsegments=12, raw_data)
mod &lt;- run_jags_model(jagsdata, n_iter=5, n_burnin=1, n_thin=1)
plots &lt;- plot_estimates(jagsdata = jagsdata, model_output = mod)

## End(Not run)
</code></pre>

<hr>
<h2 id='pull_estimates'>Function to pull method-supply share median estimates and credible intervals for a given year and country.</h2><span id='topic+pull_estimates'></span>

<h3>Description</h3>

<p>Function to pull method-supply share median estimates and credible intervals for a given year and country.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pull_estimates(model_output, year, country)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pull_estimates_+3A_model_output">model_output</code></td>
<td>
<p>The output of the mcmsupply::run_jags_model() function.</p>
</td></tr>
<tr><td><code id="pull_estimates_+3A_year">year</code></td>
<td>
<p>Numeric. The year of model estimated you wish to pull.</p>
</td></tr>
<tr><td><code id="pull_estimates_+3A_country">country</code></td>
<td>
<p>String. The name of the country you wish to inspect.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of model estimates for each method, with the median (50%), 80% and 95% credible intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
raw_data &lt;- get_data(national=TRUE, local=TRUE, mycountry="Nepal")
jagsdata &lt;- get_modelinputs(startyear=1990, endyear=2025.5, nsegments=12, raw_data)
mod &lt;- run_jags_model(jagsdata = jagsdata, jagsparams = NULL, n_iter = 5, n_burnin = 1, n_thin = 1)
estimates &lt;- pull_estimates(model_output = mod, year=2018, country="Nepal")

## End(Not run)
</code></pre>

<hr>
<h2 id='run_jags_model'>Wrapper function to run the jags model for estimating the proportion of modern contraceptive methods supplied by the public &amp; private Sectors using a Bayesian hierarchical penalized spline model for the national and subnational administration levels</h2><span id='topic+run_jags_model'></span>

<h3>Description</h3>

<p>Wrapper function to run the jags model for estimating the proportion of modern contraceptive methods supplied by the public &amp; private Sectors using a Bayesian hierarchical penalized spline model for the national and subnational administration levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_jags_model(
  jagsdata,
  jagsparams = NULL,
  n_iter = 80000,
  n_burnin = 10000,
  n_thin = 35,
  n_chain = 2,
  n_cores = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_jags_model_+3A_jagsdata">jagsdata</code></td>
<td>
<p>The object from the mcmsupply::get_modelinputs() function.</p>
</td></tr>
<tr><td><code id="run_jags_model_+3A_jagsparams">jagsparams</code></td>
<td>
<p>The parameters of the JAGS model you wish to review</p>
</td></tr>
<tr><td><code id="run_jags_model_+3A_n_iter">n_iter</code></td>
<td>
<p>Default is 80000. Number of itterations to do in JAGS model.</p>
</td></tr>
<tr><td><code id="run_jags_model_+3A_n_burnin">n_burnin</code></td>
<td>
<p>Default is 10000. Number of samples to burn-in in JAGS model.</p>
</td></tr>
<tr><td><code id="run_jags_model_+3A_n_thin">n_thin</code></td>
<td>
<p>Default is 35. Number of samples to thin by in JAGS model.</p>
</td></tr>
<tr><td><code id="run_jags_model_+3A_n_chain">n_chain</code></td>
<td>
<p>Default is 2. Number of chains to run in your MCMC sample.</p>
</td></tr>
<tr><td><code id="run_jags_model_+3A_n_cores">n_cores</code></td>
<td>
<p>The number of cores to use for parallel execution in subnational estimation. If not specified, the number of cores is set to the value of options(&quot;cores&quot;), if specified, or to approximately half the number of cores detected by the parallel package.</p>
</td></tr>
<tr><td><code id="run_jags_model_+3A_...">...</code></td>
<td>
<p>Arguments from the mcmsupply::get_modelinputs() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the jags model object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
raw_data &lt;- get_data(national=TRUE, local=TRUE, mycountry="Nepal")
jagsdata &lt;- get_modelinputs(startyear=1990, endyear=2025.5, nsegments=12, raw_data)
run_jags_model(jagsdata, n_iter=5, n_burnin=1, n_thin=1)

</code></pre>

<hr>
<h2 id='subnat_FPsource_data'>DHS survey observations for the proportion of modern contraceptives
supplied by the public and private sectors at the subnational
administration level.</h2><span id='topic+subnat_FPsource_data'></span>

<h3>Description</h3>

<p>Elizabeth Heger Boyle, Miriam King and Matthew Sobek.
IPUMS-Demographic and Health Surveys: Version 9 (dataset).
IPUMS and ICF, 2022. https://doi.org/10.18128/D080.V9
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subnat_FPsource_data
</code></pre>


<h3>Format</h3>



<h4><code>subnat_FPsource_data</code></h4>

<p>A data frame with 6940 rows and 8 columns:
</p>

<dl>
<dt>Country</dt><dd><p>Country names</p>
</dd>
<dt>Region</dt><dd><p>Subnational region names</p>
</dd>
<dt>Method</dt><dd><p>Contraceptive method name</p>
</dd>
<dt>average_year</dt><dd><p>Average year of the survey</p>
</dd>
<dt>sector_categories</dt><dd><p>Name of sector</p>
</dd>
<dt>proportion</dt><dd><p>Proportion supplied by the sector</p>
</dd>
<dt>SE.proportion</dt><dd><p>Standard error associated with the proportion</p>
</dd>
<dt>n</dt><dd><p>Sample size associated with the observation</p>
</dd>
</dl>




<h3>Source</h3>

<p>On request from IPUMS - https://www.idhsdata.org/idhs/index.shtml
</p>

<hr>
<h2 id='subnat_FPsource_format'>A checklist for ensuring subnational-level custom data is appropriate to be used for estimation</h2><span id='topic+subnat_FPsource_format'></span>

<h3>Description</h3>

<p>A checklist for ensuring subnational-level custom data is appropriate to be used for estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subnat_FPsource_format
</code></pre>


<h3>Format</h3>

<p>A list of requirements for custom data to meet before being accepted into the model
</p>

<dl>
<dt>Country</dt><dd><p>Country name variable classification</p>
</dd>
<dt>Region</dt><dd><p>Subnational region name variable classification</p>
</dd>
<dt>Method</dt><dd><p>Method name variable classification</p>
</dd>
<dt>average_year</dt><dd><p>average_year variable classification</p>
</dd>
<dt>sector_categories</dt><dd><p>sector_categories name variable classification</p>
</dd>
<dt>proportion</dt><dd><p>proportion variable classification</p>
</dd>
<dt>SE.proportion</dt><dd><p>SE.proportion variable classification</p>
</dd>
<dt>n</dt><dd><p>n variable classification</p>
</dd>
</dl>


<hr>
<h2 id='subnational_alpha_cms_hat'>The median estimates of the subnational-level country, sector-, method-specific intercepts in the multi-country subnational model.
This array is used to inform the Normal prior of the subnational-level intercept in the single-country subnational model.</h2><span id='topic+subnational_alpha_cms_hat'></span>

<h3>Description</h3>

<p>The median estimates of the subnational-level country, sector-, method-specific intercepts in the multi-country subnational model.
This array is used to inform the Normal prior of the subnational-level intercept in the single-country subnational model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subnational_alpha_cms_hat
</code></pre>


<h3>Format</h3>

<p>A array of 23 matrices with 2 rows and 5 columns
</p>

<hr>
<h2 id='subnational_estimated_correlations'>The estimated subnational-level correlations between the rates of change in methods</h2><span id='topic+subnational_estimated_correlations'></span>

<h3>Description</h3>

<p>The estimated subnational-level correlations between the rates of change in methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subnational_estimated_correlations
</code></pre>


<h3>Format</h3>

<p>A array of 2 matrices with 5 rows and 5 columns:
</p>

<dl>
<dt>row</dt><dd><p>Contraceptive method the correlation estimate refers to</p>
</dd>
<dt>column</dt><dd><p>Contraceptive method the correlation estimate refers to</p>
</dd>
<dt>public_cor</dt><dd><p>The estimated correlation between the rates of change in methods supplied by the public sector</p>
</dd>
<dt>private_cor</dt><dd><p>The estimated correlation between the rates of change in methods supplied by the private sector</p>
</dd>
</dl>


<hr>
<h2 id='subnational_inv.sigma_delta_hat'>The median estimate for the subnational-level precision matrix of the delta.k terms in the multi-country subnational model.
This array is used to inform the multi-variate normal prior in the single-country subnational model.</h2><span id='topic+subnational_inv.sigma_delta_hat'></span>

<h3>Description</h3>

<p>The median estimate for the subnational-level precision matrix of the delta.k terms in the multi-country subnational model.
This array is used to inform the multi-variate normal prior in the single-country subnational model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subnational_inv.sigma_delta_hat
</code></pre>


<h3>Format</h3>

<p>A array of 2 matrices with 5 rows and 5 columns:
</p>

<dl>
<dt>Array 1</dt><dd><p>Estimated public sector precision matrix</p>
</dd>
<dt>Array 2</dt><dd><p>Estimated private sector precision matrix</p>
</dd>
</dl>


<hr>
<h2 id='subnational_tau_alpha_pms_hat'>subnational_tau_alpha_pms_hat
The median estimates of the precision for the subnational-level country, sector-, method-specific intercepts in the multi-country subnational model.
This vector is used to inform the precision in the Normal prior of the subnational-level intercept in single-country subnational models.</h2><span id='topic+subnational_tau_alpha_pms_hat'></span>

<h3>Description</h3>

<p>subnational_tau_alpha_pms_hat
The median estimates of the precision for the subnational-level country, sector-, method-specific intercepts in the multi-country subnational model.
This vector is used to inform the precision in the Normal prior of the subnational-level intercept in single-country subnational models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subnational_tau_alpha_pms_hat
</code></pre>


<h3>Format</h3>

<p>A vector of two precision estimates
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
