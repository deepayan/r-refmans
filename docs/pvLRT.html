<!DOCTYPE html><html lang="en"><head><title>Help for package pvLRT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pvLRT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pvLRT-package'><p><code>pvLRT</code>: An R package implementing various Likelihood Ratio Test-based</p>
approaches to pharmacovigilance</a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#all.equal.pvlrt'><p>Test if two pvlrt objects are (Nearly) Equal</p></a></li>
<li><a href='#as.matrix.pvlrt'><p>Casting a <code>pvlrt</code> object as a matrix of log LR statistics</p></a></li>
<li><a href='#convert_raw_to_contin_table'><p>Convert raw AE-Drug incidence data into a contingency table</p></a></li>
<li><a href='#extract_AE_names'><p>Extracting and setting AE and Drug names from a pvlrt object</p></a></li>
<li><a href='#extract_lrstat_matrix'><p>Extract various summary measures from a pvlrt object</p></a></li>
<li><a href='#faers22q3raw'><p>FDA FAERS dataset for 2022 Q3</p></a></li>
<li><a href='#gbca'><p>FDA GBCA dataset with all observed 1707 adverse events</p></a></li>
<li><a href='#heatmap_pvlrt'><p>Heatmap, barplot and bubbleplot displaying likelihood ratio test results in</p>
a <code>pvlrt</code> object</a></li>
<li><a href='#logLik.pvlrt'><p>Overall Log-likelihood for a pvlrt object</p></a></li>
<li><a href='#lovastatin'><p>FDA lovastatin dataset</p></a></li>
<li><a href='#lrt_poisson'><p>Likelihood Ratio Test under the (vanilla, non-zero-inflated) Poisson model</p></a></li>
<li><a href='#lrt_zi_poisson'><p>Pseudo Likelihood Ratio Test under the</p>
zero-inflated Poisson model with relative reporting rate parametrization</a></li>
<li><a href='#plot.pvlrt'><p>Plotting method for a pvlrt object</p></a></li>
<li><a href='#print.pvlrt'><p>Print method for pvlrt objects</p></a></li>
<li><a href='#pvlrt'><p>Pseudo Likelihood Ratio Test for determining significant AE-Drug pairs under</p>
Poisson and zero-inflated Poisson models for pharmacovigilance</a></li>
<li><a href='#r_contin_table_zip'><p>Generate random contingency tables for adverse event</p>
(across rows) and drug (across columns) combinations
given row and column marginal totals, embedded signals,
and possibly with zero inflation</a></li>
<li><a href='#rv'><p>FDA rotavirus vaccine dataset with 794 adverse events observed among</p>
combined old (age &gt;= 1 year) and  young (age &lt; 1 year) individuals</a></li>
<li><a href='#rvold'><p>FDA rotavirus vaccine dataset with 727 adverse events observed among</p>
&quot;old&quot; (non-infant; age &gt;= 1 year) individuals</a></li>
<li><a href='#rvyoung'><p>FDA rotavirus vaccine dataset with 346 adverse events observed among</p>
young (infant &ndash; 1 year) individuals</a></li>
<li><a href='#statin'><p>FDA Statin dataset with 6039 adverse events</p></a></li>
<li><a href='#statin1491'><p>FDA Statin dataset with 1491 adverse events</p></a></li>
<li><a href='#statin46'><p>FDA Statin dataset with 46 adverse events</p></a></li>
<li><a href='#summary.pvlrt'><p>Summary method for a pvlrt object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Likelihood Ratio Test-Based Approaches to Pharmacovigilance</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Saptarshi Chakraborty &lt;chakra.saptarshi@gmail.com&gt;</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-06</td>
</tr>
<tr>
<td>Description:</td>
<td>A suite of likelihood ratio test based methods to use in pharmacovigilance. Contains various testing and post-processing functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, methods, utils, magrittr (&ge; 2.0.0), progress,
data.table, bit64, glue, RColorBrewer, ggplot2, ggfittext</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>furrr, plotly, patchwork</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/c7rishi/pvLRT/issues">https://github.com/c7rishi/pvLRT/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-06 23:15:31 UTC; chakrab2</td>
</tr>
<tr>
<td>Author:</td>
<td>Saptarshi Chakraborty [aut, cre],
  Marianthi Markatou [aut],
  Anran Liu [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-06 23:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pvLRT-package'><code>pvLRT</code>: An R package implementing various Likelihood Ratio Test-based
approaches to pharmacovigilance</h2><span id='topic+pvLRT-package'></span>

<h3>Description</h3>

<p><code>pvLRT</code> is an R package that implements a suite of
likelihood ratio test based methods to use in pharmacovigilance.
It can handle adverse events data on several simultaneous drugs,
with possibly zero inflated report counts. Several testing and post-processing
functions are implemented.
</p>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='all.equal.pvlrt'>Test if two pvlrt objects are (Nearly) Equal</h2><span id='topic+all.equal.pvlrt'></span>

<h3>Description</h3>

<p>Test if two pvlrt objects are (Nearly) Equal
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pvlrt'
all.equal(target, current, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="all.equal.pvlrt_+3A_target">target</code></td>
<td>
<p>First pvlrt object (output of <a href="#topic+pvlrt">pvlrt</a>).</p>
</td></tr>
<tr><td><code id="all.equal.pvlrt_+3A_current">current</code></td>
<td>
<p>Second pvlrt object.</p>
</td></tr>
<tr><td><code id="all.equal.pvlrt_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="base.html#topic+all.equal.default">all.equal.default</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compares all values and attributes of target and current <code>pvlrt</code> objects except running times.
See <a href="base.html#topic+all.equal.default">all.equal.default</a> for details on the generic function.
</p>


<h3>See Also</h3>

<p>all.equal.default
</p>

<hr>
<h2 id='as.matrix.pvlrt'>Casting a <code>pvlrt</code> object as a matrix of log LR statistics</h2><span id='topic+as.matrix.pvlrt'></span>

<h3>Description</h3>

<p>Casting a <code>pvlrt</code> object as a matrix of log LR statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pvlrt'
as.matrix(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.matrix.pvlrt_+3A_x">x</code></td>
<td>
<p>a <code>pvlrt</code> object; an output of function <code>pvlrt</code>().</p>
</td></tr>
<tr><td><code id="as.matrix.pvlrt_+3A_...">...</code></td>
<td>
<p>other input parameters. Currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix with the same dimensions as the input contingency
table in the original <code>pvlrt</code> call, with each cell providing
the corresponding value of the observed log-likelihood ratio
test statistic.
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

test1 &lt;- pvlrt(statin46, nsim = 500)
as.matrix(test1)

</code></pre>

<hr>
<h2 id='convert_raw_to_contin_table'>Convert raw AE-Drug incidence data into a contingency table</h2><span id='topic+convert_raw_to_contin_table'></span>

<h3>Description</h3>

<p>Convert raw AE-Drug incidence data into a contingency table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_raw_to_contin_table(
  rawdata,
  Drug_col_name = "DRUG",
  AE_col_name = "AE",
  id_col_name = "CASEID",
  count_col_name = "COUNT",
  aggregated = FALSE,
  create_other_Drug_col = FALSE,
  other_Drug_excludes = NULL,
  other_Drug_colname = "Other_Drug",
  create_other_AE_row = FALSE,
  other_AE_excludes = NULL,
  other_AE_rowname = "Other_AE",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_raw_to_contin_table_+3A_rawdata">rawdata</code></td>
<td>
<p>a <code>data.frame</code> or an object that can be converted to a <code>data.frame</code>.
Must contain 3 columns (i) DRUG: the drug names/labels, (ii) AE: the AE names, and
either (iii) CASEID: case ids corresponding to each combination of AE and DRUG,
(if <code>aggregated</code> is <code>FALSE</code>), or (iii') COUNT: the total number of incidences of
each AE and DRUG combination (if <code>aggregated</code> is <code>TRUE</code>). If these columns are named
differently in <code>rawdata</code>, supply the appropriate column names through <code>Drug_col_name</code>,
<code>AE_col_name</code>, <code>id_col_name</code> and <code>count_col_name</code>.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_drug_col_name">Drug_col_name</code>, <code id="convert_raw_to_contin_table_+3A_ae_col_name">AE_col_name</code>, <code id="convert_raw_to_contin_table_+3A_id_col_name">id_col_name</code>, <code id="convert_raw_to_contin_table_+3A_count_col_name">count_col_name</code></td>
<td>
<p>Drug, AE, case id and count
column names in <code>rawdata</code>. Defaults to <code>DRUG</code>, <code>AE</code>, <code>CASEID</code> and <code>COUNT</code>.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_aggregated">aggregated</code></td>
<td>
<p>logical. Has the incidences been already aggregated/summarized into counts
in <code>rawdata</code>? If <code>TRUE</code> then then <code>COUNT</code> column is used to produce the output
contingency table. If <code>FALSE</code> (default) incidences are first aggregated into counts
before converting to contingency tables.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_create_other_drug_col">create_other_Drug_col</code></td>
<td>
<p>logical. Add a column in the contingency table for &quot;Other Drugs&quot;? This
column plays the role of a &quot;baseline&quot; group of drugs that typically do not indicate an adverse event
association with the signal of interest. Care should be taken while determining which drugs to
include in this group; See Ding et al (2020) for guidance.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_other_drug_excludes">other_Drug_excludes</code></td>
<td>
<p>character vector cataloging Drugs that are NOT to be included in the
column for Other Drugs. If NULL (default) then then no Drugs are included in Other Drugs (i.e.,
<code>other_Drug_excludes</code> contains all Drugs in the raw data). Ignored if
<code>create_other_Drug_col = FALSE</code>.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_other_drug_colname">other_Drug_colname</code></td>
<td>
<p>character. Row name for the &quot;Other Drug&quot; column created. Ignored if
<code>create_other_Drug_col = FALSE</code>.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_create_other_ae_row">create_other_AE_row</code></td>
<td>
<p>logical. Add a row in the contingency table for &quot;Other AEs&quot;? This can aid computation
in situations where there are certain AEs of primary interest. See <code>other_AE_excludes</code> for details on
how to specify the &quot;Other AE&quot; row.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_other_ae_excludes">other_AE_excludes</code></td>
<td>
<p>character vector cataloging AEs that are NOT to be included in the
row for Other AEs. If NULL (default) then then no AEs are included in Other AEs (i.e.,
<code>other_AE_excludes</code> contains all AEs in the raw data). Ignored if  <code>create_other_AE_row = FALSE</code>.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_other_ae_rowname">other_AE_rowname</code></td>
<td>
<p>character. Row name for the &quot;Other AE&quot; row created. Defaults to &quot;Other AE&quot;. Ignored if
<code>create_other_AE_row = FALSE</code>.</p>
</td></tr>
<tr><td><code id="convert_raw_to_contin_table_+3A_...">...</code></td>
<td>
<p>unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function that creates a contingency table cataloging counts of
AE-Drug incidences from a raw Drug/AE incidence data frame.
It accepts both raw incidence data (each row is one incidence of a Drug-AE combination,
indexed by case ids) and summarized count data (each row catalogs the total counts of incidences
of each Drug-AE pair). The output is a matrix (contingency table) enumerating total count of cases for
each pair of AE (along the rows) and drug (along the columns) with appropriately
specified row and column names, and can be passed to a pvlrt() call. See the examples for more details.
</p>
<p>The output can be fed into <a href="#topic+pvlrt">pvlrt</a> or its wrappers as <code>contin_table</code>
</p>


<h3>References</h3>

<p>Ding, Y., Markatou, M. and Ball, R., 2020. An evaluation of statistical approaches to postmarketing surveillance. Statistics in Medicine, 39(7), pp.845-874.
</p>
<p>Chakraborty, S., Liu, A., Ball, R. and Markatou, M., 2022. On the use of the likelihood ratio test methodology in pharmacovigilance. Statistics in Medicine, 41(27), pp.5395-5420.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# convert to contingency table form incidence (non-aggregated) raw data
# AE subset = AEs in statin46
# Durg subset = union of statin46 and gbca drugs
tab1 &lt;- convert_raw_to_contin_table(
  rawdata = faers22q3raw,
  Drug_col_name = "DRUG",
  AE_col_name = "AE",
  id_col_name = "CASEID",
  aggregated = FALSE,
  other_AE_excludes = rownames(statin46),
  other_Drug_excludes = union(colnames(gbca), colnames(statin)),
  create_other_Drug_col = TRUE,
  create_other_AE_row = FALSE
)

# convert to contingency table AFTER aggregating and counting
# the total number of incidences of each (AE, Drug) pair
## Same AE and Drug subsets as before
## aggregation (counting) done using data.table dt[i, j, by] syntax
## uses magrittr %&gt;% pipe
tab2 &lt;- data.table::as.data.table(
  faers22q3raw
)[
  ,
  .(COUNT = length(unique(CASEID))),
  by = .(DRUG, AE)
] %&gt;%
  convert_raw_to_contin_table(
    Drug_col_name = "DRUG",
    AE_col_name = "AE",
    count_col_name = "COUNT",
    aggregated = TRUE,
    other_AE_excludes = rownames(statin46),
    other_Drug_excludes = union(colnames(gbca), colnames(statin)),
    create_other_Drug_col = TRUE,
    create_other_AE_row = FALSE
  )

all.equal(tab1, tab2)

# use the contingency table produced above in pvlrt()
## 500 bootstrap iterations (nsim) in the example below
## is for quick demonstration only --
## we recommended setting nsim to 10000 (default) or bigger
test1 &lt;- pvlrt(tab1, nsim = 500)

</code></pre>

<hr>
<h2 id='extract_AE_names'>Extracting and setting AE and Drug names from a pvlrt object</h2><span id='topic+extract_AE_names'></span><span id='topic+extract_Drug_names'></span><span id='topic+set_AE_names'></span><span id='topic+set_Drug_names'></span>

<h3>Description</h3>

<p>Extracting and setting AE and Drug names from a pvlrt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_AE_names(object)

extract_Drug_names(object)

set_AE_names(object, old, new)

set_Drug_names(object, old, new)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_AE_names_+3A_object">object</code></td>
<td>
<p>a <code>pvlrt</code> object, which is the output of the function
<a href="#topic+pvlrt">pvlrt</a> or one of its wrappers such as <a href="#topic+lrt_zi_poisson">lrt_zi_poisson</a>,
<a href="#topic+lrt_poisson">lrt_poisson</a> and <code>lrt_vanilla_poisson</code>.</p>
</td></tr>
<tr><td><code id="extract_AE_names_+3A_old">old</code></td>
<td>
<p>character vector containing the old names</p>
</td></tr>
<tr><td><code id="extract_AE_names_+3A_new">new</code></td>
<td>
<p>character vector containing the new names</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>extract_AE_names</code> returns a character vector of the names of the
AEs in the input <code>pvlrt</code> object
</p>
</li>
<li> <p><code>extract_Drug_names</code> returns a character vector of the names of the Drugs
in the input <code>pvlrt</code> object
</p>
</li>
<li> <p><code>set_AE_names</code> returns a new <code>pvlrt</code> object with updated AE names as
specified through the arguments <code>old</code> and <code>new</code>.
</p>
</li>
<li> <p><code>set_Drug_names</code> returns a new <code>pvlrt</code> object with updated Drug names as
specified through the arguments <code>old</code> and <code>new</code>.
</p>
</li></ul>



<h3>Note</h3>

<p>Because a <code>pvlrt</code> object is simply a reclassified matrix, the AE (rows)
and Drug (columns) names can also be extracted/modified through <a href="base.html#topic+rownames">rownames</a> and
<a href="base.html#topic+colnames">colnames</a> respectively.
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

test1 &lt;- pvlrt(statin46, test_zi = TRUE, nsim = 500)
extract_AE_names(test1)
extract_Drug_names(test1)

set_AE_names(test1, old = "Rhabdomyolysis", new = "Rhabdo")
set_Drug_names(test1, old = "Other", new = "Other-Drugs")

## can be chained with pipes `%&gt;%`:
test2 &lt;- test1 %&gt;%
  set_AE_names(old = "Rhabdomyolysis", new = "Rhabdo") %&gt;%
  set_Drug_names(old = "Other", new = "Other-Drugs")

# see the summary for changed labels
summary(test2)


</code></pre>

<hr>
<h2 id='extract_lrstat_matrix'>Extract various summary measures from a pvlrt object</h2><span id='topic+extract_lrstat_matrix'></span><span id='topic+extract_p_value_matrix'></span><span id='topic+extract_zi_probability'></span><span id='topic+extract_n_matrix'></span><span id='topic+extract_significant_pairs'></span><span id='topic+extract_run_time'></span>

<h3>Description</h3>

<p>Extract various summary measures from a pvlrt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_lrstat_matrix(object, ...)

extract_p_value_matrix(object, ...)

extract_zi_probability(object, ...)

extract_n_matrix(object, ...)

extract_significant_pairs(object, significance_level = 0.05, ...)

extract_run_time(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_lrstat_matrix_+3A_object">object</code></td>
<td>
<p>a <code>pvlrt</code> object, which is the output of the function
<a href="#topic+pvlrt">pvlrt</a> or one of its wrappers such as <a href="#topic+lrt_zi_poisson">lrt_zi_poisson</a>,
<a href="#topic+lrt_poisson">lrt_poisson</a> and <code>lrt_vanilla_poisson</code>.</p>
</td></tr>
<tr><td><code id="extract_lrstat_matrix_+3A_...">...</code></td>
<td>
<p>other input parameters. Currently unused.</p>
</td></tr>
<tr><td><code id="extract_lrstat_matrix_+3A_significance_level">significance_level</code></td>
<td>
<p>numeric. Level of significance.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>extract_lrstat_matrix</code> returns the matrix of
the computed log-likelihood ratio test statistics for signals. This produces
a result identical to applying <code>as.matrix</code>.
</p>
</li>
<li> <p><code>extract_p_value_matrix</code> returns the matrix of
computed p-values associated with the likelihood ratio tests.
</p>
</li>
<li> <p><code>extract_zi_probability</code> returns a vector of (estimated)
zero-inflation probabilities.
</p>
</li>
<li> <p><code>extract_n_matrix</code> returns the original contingency table (matrix)
used.
</p>
</li>
<li> <p><code>extract_significant_pairs</code> returns a data.table listing the AE/drug
pairs determined to be significant at the provided significance level. This
is essentially a subset of the data.table obtained through summary.pvlrt()
that satisfies the provided significance threshold.
</p>
</li>
<li> <p><code>extract_run_time</code> returns a <a href="base.html#topic+difftime">difftime</a> object measuring the
total CPU time needed to run the original <a href="#topic+pvlrt">pvlrt</a> call.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

test1 &lt;- pvlrt(statin46, test_zi = TRUE, nsim = 500)
extract_lrstat_matrix(test1)
extract_p_value_matrix(test1)
extract_zi_probability(test1)
extract_n_matrix(test1)
extract_significant_pairs(test1)


</code></pre>

<hr>
<h2 id='faers22q3raw'>FDA FAERS dataset for 2022 Q3</h2><span id='topic+faers22q3raw'></span>

<h3>Description</h3>

<p>The raw FDA FAERS dataset for 2022 Q3; downloaded from FDA's website
and then subsetted to inlcude incidences with <code>ROLE_COD == "PS"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>faers22q3raw
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 496312 rows and 3 columns.
</p>


<h3>Details</h3>

<p>obtained from the FDA FAERS database for the
quarters 2014Q3 - 2020Q4
</p>
<p>This is a raw incidence data stored as a data.table with each row corresponding
to a specific incidence index by case ids. It contains the following
columns:
</p>

<ul>
<li> <p><code>CASEID</code> - case ids for each incidence
</p>
</li>
<li> <p><code>DRUG</code> - names of the drugs
</p>
</li>
<li> <p><code>AE</code> - names of the adverse events
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html">https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html</a>
</p>

<hr>
<h2 id='gbca'>FDA GBCA dataset with all observed 1707 adverse events</h2><span id='topic+gbca'></span>

<h3>Description</h3>

<p>A Drug-Adverse event (AE) count dataset (contingency table)
obtained from the FDA FAERS database for the
quarters 2014Q3 - 2020Q4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbca
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 1707 rows and 10 columns.
</p>


<h3>Details</h3>

<p>Data are stored in the form of a contingency table, with
drugs listed across the columns and the 1707 AEs presented across
the rows. Each cell in the contingency table represents the total
report counts associated with that drug/AE pair and detected
in the FDA FAERS database during 2014Q3 - 2020Q4.
</p>
<p>The dataset contains 6 Gadolinium-Based Contrast Agents (GBCAs) as drugs:
</p>
<p>gadobenate, gadobutrol, gadodiamide, gadofosveset, gadopentetate, gadoterate,
gadoteridol, gadoversetamide, gadoxetate
</p>
<p>Corresponding to all 1707 observed adverse events (AEs) as curated in FAERS database.
</p>


<h3>Source</h3>

<p><a href="https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html">https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html</a>
</p>

<hr>
<h2 id='heatmap_pvlrt'>Heatmap, barplot and bubbleplot displaying likelihood ratio test results in
a <code>pvlrt</code> object</h2><span id='topic+heatmap_pvlrt'></span><span id='topic+barplot.pvlrt'></span><span id='topic+bubbleplot_pvlrt'></span>

<h3>Description</h3>

<p>Heatmap, barplot and bubbleplot displaying likelihood ratio test results in
a <code>pvlrt</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap_pvlrt(
  object,
  AE = NULL,
  Drug = NULL,
  grep = FALSE,
  fill_measure = "p_value",
  show_n = FALSE,
  show_lrstat = FALSE,
  show_p_value = FALSE,
  p_value_lower = 0,
  p_value_upper = 1,
  lrstat_lower = 0,
  lrstat_upper = Inf,
  n_lower = 0,
  n_upper = Inf,
  arrange_alphabetical = FALSE,
  remove_outside = FALSE,
  digits = 2,
  border_color = "black",
  fill_gradient_range = c("darkred", "white"),
  ...
)

## S3 method for class 'pvlrt'
barplot(
  height,
  AE = NULL,
  Drug = NULL,
  grep = FALSE,
  x_axis_measure = "lrstat",
  fill_measure = "p_value",
  show_n = FALSE,
  arrange_alphabetical = FALSE,
  show_p_value = FALSE,
  show_lrstat = FALSE,
  p_value_lower = 0,
  p_value_upper = 1,
  lrstat_lower = 0,
  lrstat_upper = Inf,
  n_lower = 0,
  n_upper = Inf,
  remove_outside = FALSE,
  digits = 2,
  Drug_nrow = 1,
  border_color = "black",
  x_axis_logscale = TRUE,
  fill_gradient_range = c("darkred", "white"),
  ...
)

bubbleplot_pvlrt(
  object,
  AE = NULL,
  Drug = NULL,
  grep = FALSE,
  x_axis_measure = "lrstat",
  fill_measure = "p_value",
  size_measure = "n",
  show_n = FALSE,
  arrange_alphabetical = FALSE,
  show_p_value = FALSE,
  show_lrstat = FALSE,
  p_value_lower = 0,
  p_value_upper = 1,
  lrstat_lower = 0,
  lrstat_upper = Inf,
  n_lower = 0,
  n_upper = Inf,
  remove_outside = FALSE,
  digits = 2,
  Drug_nrow = 1,
  border_color = "black",
  x_axis_logscale = TRUE,
  size_logscale = TRUE,
  fill_gradient_range = c("darkred", "white"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="heatmap_pvlrt_+3A_object">object</code>, <code id="heatmap_pvlrt_+3A_height">height</code></td>
<td>
<p>pvlrt object; output of <code>pvlrt</code>()</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_ae">AE</code></td>
<td>
<p>input parameter determining which adverse events to show in
the plot. This can be a numeric scalar  specifying the
number of <em>top</em> (in terms of computed LRT values) adverse events to show.
Alternatively, it can be a character vector, specifying the exact
adverse events to show. It can also be a vector of patterns to match
(ignores cases) against the full names of all available adverse events,
provided <code>grep</code> is set to TRUE. Defaults to adverse events
corresponding to the top M pairs where M = max(number of possible pairs, 50).
Set AE = Inf to force display of all adverse events.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_drug">Drug</code></td>
<td>
<p>input parameter determining which drugs to show in
the plot. This can be a numeric scalar  specifying the
number of <em>top</em> (in terms of computed LRT values) drugs to show.
Alternatively, it can be a character vector, specifying the exact
drugs to show. It can also be a vector of patterns to match
(ignores cases) against the full names of all available drugs,
provided <code>grep</code> is set to TRUE. Defaults to drugs
corresponding to the top M pairs where M = max(number of possible pairs, 50).
Set Drug = Inf to force display all drugs.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_grep">grep</code></td>
<td>
<p>logical. Match patterns against the supplied AE or Drug names?
Ignores if neither AE nor Drug is a character vector.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_fill_measure">fill_measure</code></td>
<td>
<p>Measure to govern the filling color in each cell
(in heatmap) or bar (in barplot) or circle/bubble (in bubbleplot) for each
drug/AE combination. Defaults to &quot;p_value&quot;. Available choices are:
&quot;p.value&quot;, &quot;lrstat&quot;, and &quot;n&quot;.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_show_n">show_n</code></td>
<td>
<p>logical. show the sample size as inscribed text on each cell?</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_show_lrstat">show_lrstat</code></td>
<td>
<p>logical. show the computed LRT statistic (on log-scale)
inscribed text on each cell?</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_show_p_value">show_p_value</code></td>
<td>
<p>logical. show the computed p-value as inscribed text on each cell?</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_p_value_lower">p_value_lower</code>, <code id="heatmap_pvlrt_+3A_p_value_upper">p_value_upper</code></td>
<td>
<p>lower and upper limits on the computed p-values to
display on the plot.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_lrstat_lower">lrstat_lower</code>, <code id="heatmap_pvlrt_+3A_lrstat_upper">lrstat_upper</code></td>
<td>
<p>lower and upper limits on the computed LRT values to
display on the plot.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_n_lower">n_lower</code>, <code id="heatmap_pvlrt_+3A_n_upper">n_upper</code></td>
<td>
<p>lower and upper limits on the computed sample sizes to
display on the plot.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_arrange_alphabetical">arrange_alphabetical</code></td>
<td>
<p>logical. should the rows (AEs) and columns (Drugs)
be arranged in alphabetical orders? Defaults to FALSE, in which case
the orderings of the computed LRT values are used.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_remove_outside">remove_outside</code></td>
<td>
<p>logical. Should the values for pairs with p-value, LRT
statistics or sample sizes falling outside of the provided ranges through p_value_lower, p_value_upper
etc., be replaced with <code>NA</code>? Defaults to FALSE. Setting this to TRUE may help
distinguish drugs or AEs which has some pairs falling within and some pairs falling
outside of the provided ranges better.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_digits">digits</code></td>
<td>
<p>numeric. Number of decimal places to show on the
inscribed texts on the plot.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_border_color">border_color</code></td>
<td>
<p>character string. Specifies the border color of cells/bars.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_fill_gradient_range">fill_gradient_range</code></td>
<td>
<p>character vector. Specifies the range of gradient colors used
for <code>fill_measure</code>. Passed into the <code>colours</code> argument of
<code>scale_fill_gradientn</code> from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_...">...</code></td>
<td>
<p>Other arguments. Currently ignored</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_x_axis_measure">x_axis_measure</code></td>
<td>
<p>measure to show on the x-axis of the (horizontal) bar
plots. Defaults to &quot;lrstat&quot; available choices are &quot;lrstat&quot;, &quot;p_value&quot; and &quot;n&quot;.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_drug_nrow">Drug_nrow</code></td>
<td>
<p>Number of rows in the panels for Drugs for the barplots.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_x_axis_logscale">x_axis_logscale</code></td>
<td>
<p>logical. Should the x axis measure in the bar plot or the bubble plot
be log transformed (more precisely, &quot;log1p&quot; transformed with the function
f(x) = log(1 + x))? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_size_measure">size_measure</code></td>
<td>
<p>measure to govern sizes of the circles in the bubble plot.
Defaults to &quot;n&quot;. Available choices are &quot;lrstat&quot;, &quot;p_value&quot; and &quot;n&quot;.</p>
</td></tr>
<tr><td><code id="heatmap_pvlrt_+3A_size_logscale">size_logscale</code></td>
<td>
<p>logical. Should the circle size measure in the the bubble plot
be log transformed (more precisely, &quot;log1p&quot; transformed with the function
f(x) = log(1 + x)). Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger
test1 &lt;- pvlrt(statin46, nsim = 500)
bubbleplot_pvlrt(test1)
heatmap_pvlrt(test1)
barplot(test1)


</code></pre>

<hr>
<h2 id='logLik.pvlrt'>Overall Log-likelihood for a pvlrt object</h2><span id='topic+logLik.pvlrt'></span>

<h3>Description</h3>

<p>Overall Log-likelihood for a pvlrt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pvlrt'
logLik(object, type = "full-zip", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.pvlrt_+3A_object">object</code></td>
<td>
<p>a <code>pvlrt</code> object, which is the output of the function
<a href="#topic+pvlrt">pvlrt</a> or one of its wrappers such as <a href="#topic+lrt_zi_poisson">lrt_zi_poisson</a>,
<a href="#topic+lrt_poisson">lrt_poisson</a> and <code>lrt_vanilla_poisson</code>.</p>
</td></tr>
<tr><td><code id="logLik.pvlrt_+3A_type">type</code></td>
<td>
<p>Type of model and hypothesis combination.
Available choices are &quot;full-poisson&quot;, &quot;null-poisson&quot;, &quot;full-zip&quot; (default), and
&quot;null-zip&quot;. See details.</p>
</td></tr>
<tr><td><code id="logLik.pvlrt_+3A_...">...</code></td>
<td>
<p>other input parameters. Currently unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function extracts the overall log-likelihood and degrees of freedom
(the number of estimated parameters) from a <code>pvlrt</code> object. There are
four possible choices of distribution and hypothesis combinations, supplied
through the argument <code>type</code>, with the default being <code>type = "full-zip"</code>.
In a &quot;full&quot; model the signal parameters lambdas are estimated for all cells
in the contingency table from the data (subject to the condition lambda &gt;= 1), whereas under a &quot;null&quot;
model each lambda is fixed at 1 for each cell. In a &quot;zip&quot; model
(type = &quot;full-zip&quot; and type = &quot;null-zip&quot;) the log-likelihood under a zero-inflated
Poisson model with estimated or supplied zero inflation parameters (
through <code>zi_prob</code> in <a href="#topic+pvlrt">pvlrt</a>) is returned. The degrees of freedom
reflects whether the zero-inflation parameters are estimated. Note that if
an ordinary Poisson LRT is run either by setting <code>zi_prob = 0</code> in
<a href="#topic+pvlrt">pvlrt</a> or equivalently through <a href="#topic+lrt_poisson">lrt_poisson</a> then &quot;full-zip&quot; and
&quot;null-zip&quot; refer to zero-inflated poisson models with presepecified
zero-inflation probabilities equal to 0. Thus, in such cases the results
with type = &quot;full-zip&quot; and type =  &quot;null-zip&quot; are identical to
type = &quot;full-poisson&quot; and type = &quot;null-poisson&quot;
respectively. See examples.
</p>


<h3>Value</h3>

<p>An object of class <a href="stats.html#topic+logLik">logLik</a>. See Details.
</p>


<h3>Note</h3>

<p>The overall log likelihood must be computed during the original pvlrt run. This is
ensured by setting  <code>return_overall_loglik = TRUE</code>, and
<code>parametrization = "lambda"</code> (or <code>parametrization = "rrr"</code>) while running pvlrt().
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>; <a href="stats.html#topic+AIC">AIC</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 500 bootstrap iterations (nsim) in each example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

set.seed(100)
# estimates zero inflation probabilities
test1 &lt;- pvlrt(statin46, nsim = 500)
logLik(test1)
AIC(test1)
BIC(test1)

# compare with and without zero inflation
BIC(logLik(test1, type = "full-zip"))
BIC(logLik(test1, type = "full-poisson"))

# ordinary poisson model
## equivalent to pvlrt(statin46, zi_prob = 0, nsim = 500)
test2 &lt;- lrt_poisson(statin46, nsim = 500)

all.equal(logLik(test2, "full-zip"), logLik(test2, "full-poisson"))

</code></pre>

<hr>
<h2 id='lovastatin'>FDA lovastatin dataset</h2><span id='topic+lovastatin'></span>

<h3>Description</h3>

<p>A Drug-Adverse event (AE) count dataset (contingency table)
obtained from the FDA FAERS database for the
quarters 2014Q3 - 2020Q4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lovastatin
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 47 rows and 3 columns.
</p>


<h3>Details</h3>

<p>Data are stored in the form of a contingency table, with
drugs listed across the columns and the 46 AEs presented across
the rows. Each cell in the contingency table represents the total
report counts associated with that drug/AE pair and detected
in the FDA FAERS database during 2014Q3 - 2020Q4.
</p>
<p>The dataset contains 1 column for the lovastatin drug,
and one column for all other drugs combined.
</p>


<h3>Source</h3>

<p><a href="https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html">https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html</a>
</p>

<hr>
<h2 id='lrt_poisson'>Likelihood Ratio Test under the (vanilla, non-zero-inflated) Poisson model</h2><span id='topic+lrt_poisson'></span><span id='topic+lrt_vanilla_poisson'></span>

<h3>Description</h3>

<p>Likelihood Ratio Test under the (vanilla, non-zero-inflated) Poisson model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrt_poisson(contin_table, nsim = 10000, parametrization = "rrr", ...)

lrt_vanilla_poisson(contin_table, nsim = 10000, parametrization = "rrr", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lrt_poisson_+3A_contin_table">contin_table</code></td>
<td>
<p>IxJ contingency table showing pairwise counts of adverse
events for I AE (along the rows) and J Drugs (along the columns)</p>
</td></tr>
<tr><td><code id="lrt_poisson_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated null contingency table to use for computing
the p-value of the test</p>
</td></tr>
<tr><td><code id="lrt_poisson_+3A_parametrization">parametrization</code></td>
<td>
<p>Type of parametrization to use in the LR test. Available choices are &quot;rrr&quot;, &quot;lambda&quot;, &quot;rr&quot;,
and &quot;p-q&quot;. The relative reporting ratio (default) parametrization of the test is used when
when <code>parametrization %in% c("rrr", "lambda")</code>, and the reporting rate parametrization is used
otherwise. NOTE: zero inflation can be handled only for the relative reporting ratio parametrization.</p>
</td></tr>
<tr><td><code id="lrt_poisson_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>pvlrt</code> object. See <a href="#topic+pvlrt">pvlrt</a> for more details.
</p>


<h3>Note</h3>

<p><code>lrt_poisson()</code> and <code>lrt_vanilla_poisson()</code>
are both wrappers for <code>pvlrt()</code> with
<code>omega_vec = rep(0, ncol(contin_table))</code>
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("statin46")

# 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

# no grouping -- each drug forms its own class
test1 &lt;- lrt_poisson(lovastatin, nsim = 500)


</code></pre>

<hr>
<h2 id='lrt_zi_poisson'>Pseudo Likelihood Ratio Test under the
zero-inflated Poisson model with relative reporting rate parametrization</h2><span id='topic+lrt_zi_poisson'></span>

<h3>Description</h3>

<p>Pseudo Likelihood Ratio Test under the
zero-inflated Poisson model with relative reporting rate parametrization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrt_zi_poisson(contin_table, nsim = 10000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lrt_zi_poisson_+3A_contin_table">contin_table</code></td>
<td>
<p>IxJ contingency table showing pairwise counts of adverse
events for I AE (along the rows) and J Drugs (along the columns)</p>
</td></tr>
<tr><td><code id="lrt_zi_poisson_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated null contingency table to use for computing
the p-value of the test</p>
</td></tr>
<tr><td><code id="lrt_zi_poisson_+3A_...">...</code></td>
<td>
<p>additional arguments passed to pvlrt</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>pvlrt</code> object. See <a href="#topic+pvlrt">pvlrt</a> for more details.
</p>


<h3>Note</h3>

<p><code>lrt_zi_poisson()</code> is a wrapper for <code>pvlrt()</code> with
<code>parametrization = "rrr"</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("statin46")

# 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger
test1 &lt;- lrt_zi_poisson(statin46, nsim = 500)
test1

</code></pre>

<hr>
<h2 id='plot.pvlrt'>Plotting method for a pvlrt object</h2><span id='topic+plot.pvlrt'></span>

<h3>Description</h3>

<p>Plotting method for a pvlrt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pvlrt'
plot(x, type = "bubbleplot", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.pvlrt_+3A_x">x</code></td>
<td>
<p>a <code>pvlrt</code> object; an output of function <code>pvlrt</code>().</p>
</td></tr>
<tr><td><code id="plot.pvlrt_+3A_type">type</code></td>
<td>
<p>character string determining the type of plot to show.
Available choices are <code>"bubbleplot"</code> which calls <a href="#topic+bubbleplot_pvlrt">bubbleplot_pvlrt</a>,
<code>"heatmap"</code> which calls <a href="#topic+heatmap_pvlrt">heatmap_pvlrt</a>, and
<code>"barplot"</code> which calls <a href="#topic+barplot.pvlrt">barplot.pvlrt</a>, with the additional arguments
supplied in ...</p>
</td></tr>
<tr><td><code id="plot.pvlrt_+3A_...">...</code></td>
<td>
<p>additional arguments passed to heatmap_pvlrt or barplot.pvlrt
depending on <code>type</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot</a> object.
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>; <a href="#topic+bubbleplot_pvlrt">bubbleplot_pvlrt</a>; <a href="#topic+heatmap_pvlrt">heatmap_pvlrt</a>; <a href="#topic+barplot.pvlrt">barplot.pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

test1 &lt;- pvlrt(statin46, nsim = 500)
plot(test1, type = "bubbleplot")
plot(test1, type = "barplot")
plot(test1, type = "heatmap")

</code></pre>

<hr>
<h2 id='print.pvlrt'>Print method for pvlrt objects</h2><span id='topic+print.pvlrt'></span>

<h3>Description</h3>

<p>Print method for pvlrt objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pvlrt'
print(
  x,
  significance_level = 0.05,
  topn = 12,
  digits = 2,
  show_test_summary = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.pvlrt_+3A_x">x</code></td>
<td>
<p>a <code>pvlrt</code> object; an output of function <code>pvlrt</code>().</p>
</td></tr>
<tr><td><code id="print.pvlrt_+3A_significance_level">significance_level</code></td>
<td>
<p>numeric. Level of significance.</p>
</td></tr>
<tr><td><code id="print.pvlrt_+3A_topn">topn</code></td>
<td>
<p>number of top (with respect to likelihood ratio statistic value)
pairs to show at the given significance level.</p>
</td></tr>
<tr><td><code id="print.pvlrt_+3A_digits">digits</code></td>
<td>
<p>number of digits to show after the decimal place.</p>
</td></tr>
<tr><td><code id="print.pvlrt_+3A_show_test_summary">show_test_summary</code></td>
<td>
<p>logical. Should a brief summary showing the top few
test results be displayed? defaults to FALSE.</p>
</td></tr>
<tr><td><code id="print.pvlrt_+3A_...">...</code></td>
<td>
<p>other input parameters. Currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the input <code>pvlrt</code> object.
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

test1 &lt;- pvlrt(statin46, nsim = 500)
print(test1)

</code></pre>

<hr>
<h2 id='pvlrt'>Pseudo Likelihood Ratio Test for determining significant AE-Drug pairs under
Poisson and zero-inflated Poisson models for pharmacovigilance</h2><span id='topic+pvlrt'></span>

<h3>Description</h3>

<p>Pseudo Likelihood Ratio Test for determining significant AE-Drug pairs under
Poisson and zero-inflated Poisson models for pharmacovigilance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pvlrt(
  contin_table,
  nsim = 10000,
  omega_vec = NULL,
  zi_prob = NULL,
  no_zi_idx = NULL,
  test_drug_idx = seq_len(max(ncol(contin_table) - 1, 0)),
  drug_class_idx = list(test_drug_idx),
  grouped_omega_est = FALSE,
  test_zi = NULL,
  test_omega = NULL,
  pval_ineq_strict = FALSE,
  parametrization = "rrr",
  null_boot_type = "parametric",
  is_zi_structural = TRUE,
  return_overall_loglik = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pvlrt_+3A_contin_table">contin_table</code></td>
<td>
<p>IxJ contingency table showing pairwise counts of adverse
events for I AE (along the rows) and J Drugs (along the columns)</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated null contingency table to use for computing
the p-value of the test</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_zi_prob">zi_prob</code>, <code id="pvlrt_+3A_omega_vec">omega_vec</code></td>
<td>
<p>Alias, determining zero inflation probabilities
in the model. Can be a vector, providing different zero inflation
probabilities for different drugs, or a scalar, providing the common zero
inflation probability for all drugs. If NULL (default), then is estimated from the data. See also the
description of the argument <code>grouped_omega_est</code>. If <code>omega_vec = rep(0, ncol(contin_table))</code>,
then test reduces to an ordinary (non-zero inflated) Poisson test. NOTE: <code>zi_prob</code> and <code>omega_vec</code>
are alias.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_no_zi_idx">no_zi_idx</code></td>
<td>
<p>List of pairs (i, j) where zero inflation is not allowed. To
specify the entirety i-th row (or j-th column) use c(i, 0) (or c(0, j)). See examples.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_test_drug_idx">test_drug_idx</code></td>
<td>
<p>integer (position) or character (names) vector indicating the columns
(drugs indices or drug labels) of contin_table to be tested for signal using LRT.
Defaults to all except the last columns (which is typically the column for &quot;Other Drugs&quot;).</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_drug_class_idx">drug_class_idx</code></td>
<td>
<p>a list, with the h-th entry providing the h-th group/class
of drugs. Relevant only for drugs used for testing (supplied through <code>test_drug_idx</code>).
By default all drugs provided in <code>test_drug_idx</code> are included in the same class, which is
ensured by supplying <code>drug_class_idx = list(test_drug_idx)</code>. If more than one drug is
present in a class, an extended LRT is performed for the class (which ensures the correct
Type I error rate is preserved). If <code>drug_class_idx</code> excludes any drug present in <code>test_drug_idx</code>,
each remaining drug is made to form its own class. See examples.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_grouped_omega_est">grouped_omega_est</code></td>
<td>
<p>Logical. When performing a test with grouped drug classes (extended LRT),
should the estimated zero-inflation parameter &quot;omega&quot; reflect
the corresponding grouping? If TRUE, then the estimated omegas are obtained by combining
columns from the same group, and if FALSE (default), then omegas are estimated separately for each drug (column)
irrespective of the groups specified through  <code>drug_class_idx</code>. Ignored if <code>omega_vec</code> is
supplied/non-<code>NULL</code> (i.e., not estimated).</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_test_zi">test_zi</code>, <code id="pvlrt_+3A_test_omega">test_omega</code></td>
<td>
<p>logical indicators specifying whether to perform a
pseudo likelihood ratio test for zero inflation. Defaults to FALSE. Ignored
if <code>omega_vec</code> is supplied (is non-NULL). Defaults to FALSE.
NOTE: <code>test_omega</code> and <code>test_zi</code> are aliases.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_pval_ineq_strict">pval_ineq_strict</code></td>
<td>
<p>logical. Use a strict inequality in the definition of the p-values?  Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_parametrization">parametrization</code></td>
<td>
<p>Type of parametrization to use in the LR test. Available choices are &quot;rrr&quot;, &quot;lambda&quot;, &quot;rr&quot;,
and &quot;p-q&quot;. The relative reporting ratio (default) parametrization of the test is used when
when <code>parametrization %in% c("rrr", "lambda")</code>, and the reporting rate parametrization is used
otherwise. NOTE: zero inflation can be handled only for the relative reporting ratio parametrization.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_null_boot_type">null_boot_type</code></td>
<td>
<p>Type of bootstrap sampling to perform for generating null resamples.
Available choices are &quot;parametric&quot; (default) and &quot;non-parametric&quot;. NOTE: zero inflation is not
handled properly in a non-parametric bootstrap resampling.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_is_zi_structural">is_zi_structural</code></td>
<td>
<p>logical. Do the inflated zeros correspond to structural
zeros (indicating impossible AE-Drug combination)? This determines how the
bootstrap null zero-inflation indicators are generated. If TRUE (default),
then then the null zero-inflation random indicators are randomly generated using the
(estimated) <em>conditional</em> probabilities of zero inflation given observed
counts. If FALSE, then they are generated using the <em>marginal</em> (drug-specific)
estimated probabilities of zero-inflation.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_return_overall_loglik">return_overall_loglik</code></td>
<td>
<p>logical. Return overall log-likelihood for the table? This is needed
if <code>logLik</code> method is to be used.</p>
</td></tr>
<tr><td><code id="pvlrt_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an S3 object of class <code>pvlrt</code> containing  test results. A <code>pvlrt</code>
object is simply a re-classified matrix containing log likelihood ratio test statistics
for cells in the input contingency table, with various other test and input data information (including
p-values, estimated zero inflation parameters, overall log-likelihood etc.) embedded
as attributes. The following S3 methods and functions are available for an <code>pvlrt</code> object:
</p>
<p>Various post processing methods for <code>pvlrt</code> objects are available. This includes:
</p>

<ul>
<li> <p><a href="#topic+bubbleplot_pvlrt">bubbleplot_pvlrt</a>
</p>
</li>
<li> <p><a href="#topic+extract_AE_names">extract_AE_names</a>
</p>
</li>
<li> <p><a href="#topic+extract_Drug_names">extract_Drug_names</a>
</p>
</li>
<li> <p><a href="#topic+extract_lrstat_matrix">extract_lrstat_matrix</a>
</p>
</li>
<li> <p><a href="#topic+extract_n_matrix">extract_n_matrix</a>
</p>
</li>
<li> <p><a href="#topic+extract_p_value_matrix">extract_p_value_matrix</a>
</p>
</li>
<li> <p><a href="#topic+extract_significant_pairs">extract_significant_pairs</a>
</p>
</li>
<li> <p><a href="#topic+extract_zi_probability">extract_zi_probability</a>
</p>
</li>
<li> <p><a href="#topic+heatmap_pvlrt">heatmap_pvlrt</a>
</p>
</li>
<li> <p><a href="#topic+lrt_poisson">lrt_poisson</a>
</p>
</li>
<li> <p><a href="#topic+lrt_vanilla_poisson">lrt_vanilla_poisson</a>
</p>
</li>
<li> <p><a href="#topic+lrt_zi_poisson">lrt_zi_poisson</a>
</p>
</li>
<li> <p><a href="#topic+r_contin_table_zip">r_contin_table_zip</a>
</p>
</li>
<li> <p><a href="#topic+set_AE_names">set_AE_names</a>
</p>
</li>
<li> <p><a href="#topic+set_Drug_names">set_Drug_names</a>
</p>
</li>
<li> <p><a href="#topic+print.pvlrt">print.pvlrt</a>
</p>
</li>
<li> <p><a href="#topic+plot.pvlrt">plot.pvlrt</a>
</p>
</li>
<li> <p><a href="#topic+summary.pvlrt">summary.pvlrt</a>
</p>
</li>
<li> <p><a href="#topic+logLik.pvlrt">logLik.pvlrt</a>
</p>
</li>
<li> <p><a href="#topic+as.matrix.pvlrt">as.matrix.pvlrt</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data("statin46")

# 500 bootstrap iterations (nsim) in each example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

# no grouping -- each drug forms its own class,
# default "rrr" (lambda) parametrization, possible zi,
# null distribution evaluated using parametric bootstrap
test1 &lt;- pvlrt(statin46, nsim = 500)
test1
## extract the observed LRT statistic
extract_lrstat_matrix(test1)
## extract the estimated omegas
extract_zi_probability(test1)

# grouped drugs --
# group 1: drug 1, drug 2
# group 2: drug 3, drug 4
# drug 5, 6, in their own groups
## 7 is not tested, so excluded from test_drug_idx (default)
## if needed, include 7 in test_drug_idx
drug_groups &lt;- list(c(1, 2), c(3, 4))
## 5, 6 not present in drug_groups, so each will form their own groups
set.seed(50)
##
test2 &lt;- pvlrt(statin46, drug_class_idx = drug_groups, nsim = 500)
test2

# instead of column positions column names can also be supplied
# in drug_class_idx and/or test_drug_idx
## column name version of drug_groups
drug_groups_colnames &lt;- lapply(drug_groups, function(i) colnames(statin46)[i])
test_drug_colnames &lt;- head(colnames(statin46), -1)
set.seed(50)
test20 &lt;- pvlrt(
  statin46,
  test_drug_idx = test_drug_colnames,
  drug_class_idx = drug_groups_colnames,
  nsim = 500
)
test20
all.equal(test2, test20)


# specify no zero inflation at the entirety of the last row and the last column
no_zi_idx &lt;- list(c(nrow(statin46), 0), c(0, ncol(statin46)))
test3 &lt;- pvlrt(statin46, no_zi_idx = no_zi_idx, nsim = 500)
test3


# use non-parametric bootstrap to evaluate the null distribution
# takes longer, due to computational costs with non-parametric
# contigency table generation
test4 &lt;- pvlrt(statin46, null_boot_type = "non-parametric", nsim = 500)
test4


# test zi probabilities (omegas)
test5 &lt;- pvlrt(statin46, test_omega = TRUE, nsim = 500)
test5


</code></pre>

<hr>
<h2 id='r_contin_table_zip'>Generate random contingency tables for adverse event
(across rows) and drug (across columns) combinations
given row and column marginal totals, embedded signals,
and possibly with zero inflation</h2><span id='topic+r_contin_table_zip'></span>

<h3>Description</h3>

<p>Generate random contingency tables for adverse event
(across rows) and drug (across columns) combinations
given row and column marginal totals, embedded signals,
and possibly with zero inflation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_contin_table_zip(
  n = 1,
  row_marginals,
  col_marginals,
  signal_mat = matrix(1, length(row_marginals), length(col_marginals)),
  omega_vec = rep(0, length(col_marginals)),
  no_zi_idx = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r_contin_table_zip_+3A_n">n</code></td>
<td>
<p>number of random matrices to generate.</p>
</td></tr>
<tr><td><code id="r_contin_table_zip_+3A_row_marginals">row_marginals</code>, <code id="r_contin_table_zip_+3A_col_marginals">col_marginals</code></td>
<td>
<p>(possibly named) vector of row and column
marginal totals. Must add up to the same total. If named, the names are passed
on to the randomly generated matrix/matrices.</p>
</td></tr>
<tr><td><code id="r_contin_table_zip_+3A_signal_mat">signal_mat</code></td>
<td>
<p>numeric matrix of dimension
length(row_marginals) x length(col_marginals). The (i, j)-th entry of
signal_mat determines the signal strength of the i-th adverse event and
j-th drug pair. The default is 1 for each pair, which means no signal for the pair.</p>
</td></tr>
<tr><td><code id="r_contin_table_zip_+3A_omega_vec">omega_vec</code></td>
<td>
<p>vector of zero inflation probabilities. Must be of the same length
as col_marginals.</p>
</td></tr>
<tr><td><code id="r_contin_table_zip_+3A_no_zi_idx">no_zi_idx</code></td>
<td>
<p>List of pairs (i, j) where zero inflation is not allowed. To
specify the entirety i-th row (or j-th column) use c(i, 0) (or c(0, j)). See examples.</p>
</td></tr>
<tr><td><code id="r_contin_table_zip_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of length <code>n</code>, with each entry being a
<code>length(row_marginal)</code> by <code>length(col_marginal)</code> matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(42)

# first load the 46 statin data
data(statin46)
# zero inflation probabilities
omega_tru &lt;- c(rep(0.15, ncol(statin46) - 1), 0)

# signal matrix
signal_mat &lt;- matrix(1, nrow(statin46), ncol(statin46))

# "positive" signal at the (1, 1) entry
# the first column
signal_mat[1, 1] &lt;- 10

# Now simulate data with the same row/column marginals
# as in statin46, with embedded signals as specified in
# the above signal_mat

# no zero inflation at (1, 1)
# (where signal is elicited) and the last row ("Other PT")
# and at the last column ("Other drugs") of the simulated matrix

sim_statin &lt;- r_contin_table_zip(
  n = 1,
  row_marginals = rowSums(statin46),
  col_marginals = colSums(statin46),
  signal_mat = signal_mat,
  omega_vec = omega_tru,
  no_zi_idx = list(
    c(1, 1),
    c(nrow(statin46), 0), # the entire last row
    c(0, ncol(statin46)) # the entire last column
  )
)[[1]]

# now analyze the above simulated data

# using a pseudo LRT with a ZIP model
test1 &lt;- pvlrt(
  contin_table = sim_statin,
  nsim = 500
  # set to 500 for demonstration purposes only,
  # we recommend the default 10000 or bigger
)
extract_zi_probability(test1)
extract_significant_pairs(test1)

# LRT with a poisson model
test2 &lt;- lrt_poisson(
  contin_table = sim_statin,
  nsim = 500
  # set to 500 for demonstration purposes only,
  # we recommend the default 10000 or bigger
)
extract_zi_probability(test2)
extract_significant_pairs(test2)

# LRT with true omega supplied
test3 &lt;- pvlrt(
  contin_table = sim_statin,
  zi_prob = omega_tru,
  nsim = 500
  # set to 500 for demonstration purposes only,
  # we recommend the default 10000 or bigger
)
extract_zi_probability(test3)
extract_significant_pairs(test3)

</code></pre>

<hr>
<h2 id='rv'>FDA rotavirus vaccine dataset with 794 adverse events observed among
combined old (age &gt;= 1 year) and  young (age &lt; 1 year) individuals</h2><span id='topic+rv'></span>

<h3>Description</h3>

<p>A vaccine-Adverse event (AE) count dataset (contingency table)
obtained from the FDA VAERS database for the year 1999
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rv
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 794 rows and 2 columns.
</p>


<h3>Details</h3>

<p>Data are stored in the forms of contingency table, with the
vaccines listed across the columns and the 794 AEs presented across
the rows. Each cell in the contingency table represents the total
report counts associated with that vaccine/AE pair and detected
in the FDA VAERS database for the year 1999.
</p>
<p>The dataset contains two columns &ndash; one for the rotavirus vaccine, and another
for other (37 vaccines combined).
</p>


<h3>Source</h3>

<p><a href="https://vaers.hhs.gov/data/datasets.html">https://vaers.hhs.gov/data/datasets.html</a>
</p>

<hr>
<h2 id='rvold'>FDA rotavirus vaccine dataset with 727 adverse events observed among
&quot;old&quot; (non-infant; age &gt;= 1 year) individuals</h2><span id='topic+rvold'></span>

<h3>Description</h3>

<p>A vaccine-Adverse event (AE) count dataset (contingency table)
obtained from the FDA VAERS database for the year 1999
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rvold
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 727 rows and 2 columns.
</p>


<h3>Details</h3>

<p>Data are stored in the forms of contingency table, with the
vaccines listed across the columns and the 727 AEs presented across
the rows. Each cell in the contingency table represents the total
report counts (from &quot;old&quot; individuals with age &gt;= 1 year) associated
with that vaccine/AE pair and detected
in the FDA VAERS database for the year 1999.
</p>
<p>The dataset contains two columns &ndash; one for the rotavirus vaccine, and another
for other (37 vaccines combined).
</p>


<h3>Source</h3>

<p><a href="https://vaers.hhs.gov/data/datasets.html">https://vaers.hhs.gov/data/datasets.html</a>
</p>

<hr>
<h2 id='rvyoung'>FDA rotavirus vaccine dataset with 346 adverse events observed among
young (infant &ndash; 1 year) individuals</h2><span id='topic+rvyoung'></span>

<h3>Description</h3>

<p>A vaccine-Adverse event (AE) count dataset (contingency table)
obtained from the FDA VAERS database for the year 1999
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rvyoung
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 346 rows and 2 columns.
</p>


<h3>Details</h3>

<p>Data are stored in the forms of contingency table, with the
vaccines listed across the columns and the 346 AEs presented across
the rows. Each cell in the contingency table represents the total
report counts from young individuals with age &lt; 1 year associated
with that vaccine/AE pair and detected
in the FDA VAERS database for the year 1999.
</p>
<p>The dataset contains two columns &ndash; one for the rotavirus vaccine, and another
for other (37 vaccines combined).
</p>


<h3>Source</h3>

<p><a href="https://vaers.hhs.gov/data/datasets.html">https://vaers.hhs.gov/data/datasets.html</a>
</p>

<hr>
<h2 id='statin'>FDA Statin dataset with 6039 adverse events</h2><span id='topic+statin'></span>

<h3>Description</h3>

<p>A Drug-Adverse event (AE) count dataset (contingency table)
obtained from the FDA FAERS database for the
quarters 2014Q3 - 2020Q4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statin
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 6039 rows and 7 columns.
</p>


<h3>Details</h3>

<p>Data are stored in the form of a contingency table, with
drugs listed across the columns and the 6039 AEs presented across
the rows. Each cell in the contingency table represents the total
report counts associated with that drug/AE pair and detected
in the FDA FAERS database during 2014Q3 - 2020Q4.
</p>
<p>The dataset catalogs 6 statin drugs (across columns):
</p>
<p>Atorvastatin, Fluvastatin, Lovastatin, Pravastatin, Rosuvastatin, Simvastatin
</p>
<p>Corresponding to all 6039 observed adverse events (AEs) observed in statins
</p>


<h3>Source</h3>

<p><a href="https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html">https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html</a>
</p>

<hr>
<h2 id='statin1491'>FDA Statin dataset with 1491 adverse events</h2><span id='topic+statin1491'></span>

<h3>Description</h3>

<p>A Drug-Adverse event (AE) count dataset (contingency table)
obtained from the FDA FAERS database for the
quarters 2014Q3 - 2020Q4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statin1491
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 1491 rows and 7 columns.
</p>


<h3>Details</h3>

<p>Data are stored in the form of a contingency table, with
drugs listed across the columns and the 1491 AEs presented across
the rows. Each cell in the contingency table represents the total
report counts associated with that drug/AE pair and detected
in the FDA FAERS database during 2014Q3 - 2020Q4.
</p>
<p>The dataset catalogs 6 statin drugs (across columns):
</p>
<p>Atorvastatin, Fluvastatin, Lovastatin, Pravastatin, Rosuvastatin, Simvastatin
</p>
<p>The 1491 AEs stored in the dataset represent the intersection
of adverse events of the statin class of drugs and the GBCA drugs
</p>


<h3>Source</h3>

<p><a href="https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html">https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+statin46">statin46</a>, <a href="#topic+statin">statin</a>, <a href="#topic+gbca">gbca</a>
</p>

<hr>
<h2 id='statin46'>FDA Statin dataset with 46 adverse events</h2><span id='topic+statin46'></span>

<h3>Description</h3>

<p>A Drug-Adverse event (AE) count dataset (contingency table)
obtained from the FDA FAERS database for the
quarters 2014Q3 - 2020Q4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statin46
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 47 rows and 7 columns.
</p>


<h3>Details</h3>

<p>Data are stored in the form of a contingency table, with
drugs listed across the columns and the 46 AEs presented across
the rows. Each cell in the contingency table represents the total
report counts associated with that drug/AE pair and detected
in the FDA FAERS database during 2014Q3 - 2020Q4.
</p>
<p>The dataset catalogs 6 statin drugs (across columns):
</p>
<p>Atorvastatin, Fluvastatin, Lovastatin, Pravastatin, Rosuvastatin, Simvastatin
</p>
<p>The 46 adverse events presented across the rows are considered
significant by FDA.
</p>


<h3>Source</h3>

<p><a href="https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html">https://fis.fda.gov/extensions/FPD-QDE-FAERS/FPD-QDE-FAERS.html</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+statin">statin</a>, <a href="#topic+statin1491">statin1491</a>, <a href="#topic+gbca">gbca</a>
</p>

<hr>
<h2 id='summary.pvlrt'>Summary method for a pvlrt object</h2><span id='topic+summary.pvlrt'></span>

<h3>Description</h3>

<p>Summary method for a pvlrt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pvlrt'
summary(object, show_zi = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.pvlrt_+3A_object">object</code></td>
<td>
<p>a <code>pvlrt</code> object, which is the output of the function
<a href="#topic+pvlrt">pvlrt</a> or one of its wrappers such as <a href="#topic+lrt_zi_poisson">lrt_zi_poisson</a>,
<a href="#topic+lrt_poisson">lrt_poisson</a> and <code>lrt_vanilla_poisson</code>.</p>
</td></tr>
<tr><td><code id="summary.pvlrt_+3A_show_zi">show_zi</code></td>
<td>
<p>logical. Should summary of the estimates and tests
(if performed) of the zero inflation parameters be returned?
Defaults to FALSE. If TRUE, then the zero inflation summary is included
as an attribute with name &quot;zi&quot;. See examples.</p>
</td></tr>
<tr><td><code id="summary.pvlrt_+3A_...">...</code></td>
<td>
<p>other input parameters. Currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.table with rows corresponding to all possible AE/Drug pairs
as obtained from the input contingency table, and columns titled &quot;AE&quot;, &quot;Drug&quot;, &quot;n&quot;, &quot;lrstat&quot; (log-likelihood ratio
test statistic) and &quot;p_value&quot;. Additionally, if <code>show_zi</code> is set to <code>TRUE</code>, then as
an attribute named &quot;zi&quot; a data.table with rows
corresponding to Drugs (columns in the input contingency table), and columns titled
&quot;AE&quot;, &quot;zi&quot;, &quot;lrstat&quot; (log-likelihood ratio test statistic for zero-inflation),
&quot;p_value&quot; and &quot;q_value&quot; (Benjamini-Hochberg adjusted p-values, as obtained through
<a href="stats.html#topic+p.adjust">p.adjust</a>) is returned.
</p>


<h3>See Also</h3>

<p><a href="#topic+pvlrt">pvlrt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger

test1 &lt;- pvlrt(statin46, test_zi = TRUE, nsim = 500)
summary(test1)
tmp &lt;- summary(test1, show_zi = TRUE)
print(tmp)
tmp_zi &lt;- attr(tmp, "zi")
print(tmp_zi)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
