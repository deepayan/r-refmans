<!DOCTYPE html><html lang="en"><head><title>Help for package sicegar</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sicegar}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#categorize'><p>Categorize input data by comparing the AIC values of the three fitted models.</p></a></li>
<li><a href='#dataCheck'><p>Checks if data is in correct format.</p></a></li>
<li><a href='#doublesigmoidalFitFormula'><p>Double Sigmoidal Formula</p></a></li>
<li><a href='#doublesigmoidalFitFunction'><p>Double sigmoidal fit function.</p></a></li>
<li><a href='#figureModelCurves'><p>Generate model associated figures.</p></a></li>
<li><a href='#fitAndCategorize'><p>Fit and categorize.</p></a></li>
<li><a href='#multipleFitFunction'><p>multiple fit function.</p></a></li>
<li><a href='#normalizeData'><p>Normalization of given data</p></a></li>
<li><a href='#parameterCalculation'><p>useful paramter calculation with help of fits</p></a></li>
<li><a href='#preCategorize'><p>Checks for signal in the data.</p></a></li>
<li><a href='#sameSourceDataCheck'><p>Check is data came from the same source.</p></a></li>
<li><a href='#sigmoidalFitFormula'><p>sigmoidalFitFormula</p></a></li>
<li><a href='#sigmoidalFitFunction'><p>Sigmoidal fit function</p></a></li>
<li><a href='#unnormalizeData'><p>Unnormalization of given data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Single-Cell Viral Growth Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Aims to quantify time intensity data by using sigmoidal and
    double sigmoidal curves. It fits straight lines, sigmoidal, 
    and double sigmoidal curves on to time vs intensity data. 
    Then all the fits are used to make decision on which model 
    best describes the data. This method was first developed 
    in the context of single-cell viral growth analysis (for
    details, see Caglar et al. (2018) &lt;<a href="https://doi.org/10.7717%2Fpeerj.4251">doi:10.7717/peerj.4251</a>&gt;),
    and the package name stands for "SIngle CEll Growth Analysis in R".</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/wilkelab/sicegar">https://github.com/wilkelab/sicegar</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, minpack.lm, fBasics, ggplot2, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, cowplot, testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/wilkelab/sicegar/issues">https://github.com/wilkelab/sicegar/issues</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'categorize.R' 'mainFunctions.R' 'multipleFitFunction.R'
'sigmoidalFitFunctions.R' 'doublesigmoidalFitFunctions.R'
'normalizationFunction.R' 'sicegar.R' 'dataInputCheck.R'
'parameterCalculation.R' 'figureGeneration.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-08 01:37:56 UTC; clauswilke</td>
</tr>
<tr>
<td>Author:</td>
<td>M. Umut Caglar [aut],
  Claus O. Wilke <a href="https://orcid.org/0000-0002-7470-9261"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Claus O. Wilke &lt;wilke@austin.utexas.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-08 08:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='categorize'>Categorize input data by comparing the AIC values of the three fitted models.</h2><span id='topic+categorize'></span>

<h3>Description</h3>

<p>Catagorizes the input data using the results of two model fitsand chosen thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>categorize(
  parameterVectorSigmoidal,
  parameterVectorDoubleSigmoidal,
  threshold_intensity_range = 0.1,
  threshold_minimum_for_intensity_maximum = 0.3,
  threshold_bonus_sigmoidal_AIC = 0,
  threshold_sm_tmax_IntensityRatio = 0.85,
  threshold_dsm_tmax_IntensityRatio = 0.75,
  threshold_AIC = -10,
  threshold_t0_max_int = 0.05,
  showDetails = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="categorize_+3A_parametervectorsigmoidal">parameterVectorSigmoidal</code></td>
<td>
<p>Output of the sigmoidalFitFunction.</p>
</td></tr>
<tr><td><code id="categorize_+3A_parametervectordoublesigmoidal">parameterVectorDoubleSigmoidal</code></td>
<td>
<p>Output of the doublesigmoidalFitFunction.</p>
</td></tr>
<tr><td><code id="categorize_+3A_threshold_intensity_range">threshold_intensity_range</code></td>
<td>
<p>Minimum for intensity range, i.e. it is the lower limit for the allowed difference between the maximum and minimum of the intensities (Default is 0.1, and the values are based on actual, not the rescaled data.).</p>
</td></tr>
<tr><td><code id="categorize_+3A_threshold_minimum_for_intensity_maximum">threshold_minimum_for_intensity_maximum</code></td>
<td>
<p>Minimum allowed value for intensity maximum. (Default is 0.3, and the values are based on actual, not the rescaled data.).</p>
</td></tr>
<tr><td><code id="categorize_+3A_threshold_bonus_sigmoidal_aic">threshold_bonus_sigmoidal_AIC</code></td>
<td>
<p>Bonus AIC points for sigmoidal fit. Negative values help the sigmoidal model to win. Only helps in competition between sigmoidal and double sigmoidal fit at decision step &quot;9&quot;, i.e. if none of the models fail in any of the tests and stay as a candidate until the last step (Default is 0).</p>
</td></tr>
<tr><td><code id="categorize_+3A_threshold_sm_tmax_intensityratio">threshold_sm_tmax_IntensityRatio</code></td>
<td>
<p>The threshold for the minimum intensity ratio between the last observed time points intensity and theoretical maximum intensity of the sigmoidal curve. If the value is below the threshold, then the data can not be represented with the sigmoidal model. (Default is 0.85)</p>
</td></tr>
<tr><td><code id="categorize_+3A_threshold_dsm_tmax_intensityratio">threshold_dsm_tmax_IntensityRatio</code></td>
<td>
<p>The threshold for the minimum intensity ratio between the last observed time points intensity and maximum intensity of the double sigmoidal curve.  If the value is above the threshold, then the data can not be represented with the double sigmoidal model. (Default is 0.75)</p>
</td></tr>
<tr><td><code id="categorize_+3A_threshold_aic">threshold_AIC</code></td>
<td>
<p>Maximum AIC values in order to have a meaningful fit (Default is -10).</p>
</td></tr>
<tr><td><code id="categorize_+3A_threshold_t0_max_int">threshold_t0_max_int</code></td>
<td>
<p>Maximum allowed intensity of the fitted curve at time is equal to zero (t=0). (Default is 0.05, and the values are based on actual, not the rescaled data.).</p>
</td></tr>
<tr><td><code id="categorize_+3A_showdetails">showDetails</code></td>
<td>
<p>Logical to chose if we want to see details or not. Default is &quot;FALSE&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The returned object contains extensive information about the decision process, but the key component is the decision variable. The decision variable can be one of the following four; &quot;no_signal&quot;, &quot;infection&quot;,&quot;infection&amp;lysis&quot; or &quot;ambugious&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1 with double sigmoidal data
time=seq(3, 24, 0.1)

#simulate intensity data and add noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- sicegar::doublesigmoidalFitFormula(time,
                                               finalAsymptoteIntensityRatio = .3,
                                               maximum = 4,
                                               slope1Param = 1,
                                               midPoint1Param = 7,
                                               slope2Param = 1,
                                               midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- sicegar::normalizeData(dataInput,
                                         dataInputName = "sample001")


# Fit sigmoidal model
sigmoidalModel &lt;- sicegar::multipleFitFunction(dataInput = normalizedInput,
                                              model = "sigmoidal",
                                              n_runs_min = 20,
                                              n_runs_max = 500,
                                              showDetails = FALSE)

# Fit double sigmoidal model
doubleSigmoidalModel &lt;- sicegar::multipleFitFunction(dataInput = normalizedInput,
                                                    model = "doublesigmoidal",
                                                    n_runs_min = 20,
                                                    n_runs_max = 500,
                                                    showDetails = FALSE)


# Calculate additional parameters
sigmoidalModel &lt;- sicegar::parameterCalculation(sigmoidalModel)
doubleSigmoidalModel &lt;- sicegar::parameterCalculation(doubleSigmoidalModel)

outputCluster &lt;- sicegar::categorize(parameterVectorSigmoidal = sigmoidalModel,
                                    parameterVectorDoubleSigmoidal = doubleSigmoidalModel)

utils::str(outputCluster)

</code></pre>

<hr>
<h2 id='dataCheck'>Checks if data is in correct format.</h2><span id='topic+dataCheck'></span>

<h3>Description</h3>

<p>Checks if the input data is appropriate and if it is not, the function converts it into a suitable form. The input data frame should contain two columns named time and intensity related to time variable and intensity variable respectively. If the data frame is in a list its name in the list should be $timeIntensityData.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataCheck(data, showDetails = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dataCheck_+3A_data">data</code></td>
<td>
<p>the input data. It can be either a list that contains a data frame in .$timeIntensityData or can be a data frame by itself.</p>
</td></tr>
<tr><td><code id="dataCheck_+3A_showdetails">showDetails</code></td>
<td>
<p>logical, if TRUE the function will provide an output &quot;check done&quot; if everything is OK. Default is FALSE</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1

# generate data frame
time &lt;- seq(3, 48, 0.5)
intensity &lt;- runif(length(time), 3.0, 7.5)
dataInput &lt;- data.frame(time, intensity)

# Apply dataCheck function
dataOutputVariable &lt;- dataCheck(dataInput)

# Example 2

# generate data frame
time &lt;- seq(3, 48, 0.5)
intensity &lt;- runif(length(time), 3.0, 7.5)
dataInput &lt;- data.frame(time, intensity)

# Normalize Data
dataOutput &lt;- normalizeData(dataInput)
dataInput2 &lt;- dataOutput

# Apply dataCheck function
dataOutputVariable2 &lt;- dataCheck(dataInput2)
</code></pre>

<hr>
<h2 id='doublesigmoidalFitFormula'>Double Sigmoidal Formula</h2><span id='topic+doublesigmoidalFitFormula'></span>

<h3>Description</h3>

<p>Calculates intensities using the double-sigmoidal model fit and the parameters (maximum, final asymptote intensity, slope1Param, midpoint1Param, slope2Param, and mid point distance).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doublesigmoidalFitFormula(
  x,
  finalAsymptoteIntensityRatio,
  maximum,
  slope1Param,
  midPoint1Param,
  slope2Param,
  midPointDistanceParam
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doublesigmoidalFitFormula_+3A_x">x</code></td>
<td>
<p>the &quot;time&quot; (time) column of the dataframe</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFormula_+3A_finalasymptoteintensityratio">finalAsymptoteIntensityRatio</code></td>
<td>
<p>This is the ratio between asymptote intensity and maximum intensity of the fitted curve.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFormula_+3A_maximum">maximum</code></td>
<td>
<p>the maximum intensity that the double sigmoidal function reach.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFormula_+3A_slope1param">slope1Param</code></td>
<td>
<p>the slope parameter of the sigmoidal function at the steppest point in the exponential phase of the viral production.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFormula_+3A_midpoint1param">midPoint1Param</code></td>
<td>
<p>the x axis value of the steppest point in the function.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFormula_+3A_slope2param">slope2Param</code></td>
<td>
<p>the slope parameter of the sigmoidal function at the steppest point in the lysis phase. i.e when the intensity is decreasing.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFormula_+3A_midpointdistanceparam">midPointDistanceParam</code></td>
<td>
<p>the distance between the time of steppest increase and steppest decrease in the intensity data. In other words the distance between the x axis values of arguments of slope1Param and slope2Param.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the predicted intensities for the given time points with the double-sigmoidal fitted parameters for the double sigmoidal fit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>time &lt;- seq(3, 24, 0.1)

#simulate intensity data and add noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- doublesigmoidalFitFormula(time,
                                      finalAsymptoteIntensityRatio = .3,
                                      maximum = 4,
                                      slope1Param = 1,
                                      midPoint1Param = 7,
                                      slope2Param = 1,
                                      midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput)
parameterVector &lt;- doublesigmoidalFitFunction(normalizedInput, tryCounter = 2)


#Check the results
if(parameterVector$isThisaFit){
 intensityTheoretical &lt;-
       doublesigmoidalFitFormula(
               time,
               finalAsymptoteIntensityRatio = parameterVector$finalAsymptoteIntensityRatio_Estimate,
               maximum = parameterVector$maximum_Estimate,
               slope1Param = parameterVector$slope1Param_Estimate,
               midPoint1Param = parameterVector$midPoint1Param_Estimate,
               slope2Param = parameterVector$slope2Param_Estimate,
               midPointDistanceParam = parameterVector$midPointDistanceParam_Estimate)

 comparisonData &lt;- cbind(dataInput, intensityTheoretical)

 require(ggplot2)
 ggplot(comparisonData) +
   geom_point(aes(x = time, y = intensity)) +
   geom_line(aes(x = time, y = intensityTheoretical)) +
   expand_limits(x = 0, y = 0)
   }

if(!parameterVector$isThisaFit){
  print(parameterVector)
  }


</code></pre>

<hr>
<h2 id='doublesigmoidalFitFunction'>Double sigmoidal fit function.</h2><span id='topic+doublesigmoidalFitFunction'></span>

<h3>Description</h3>

<p>The function fits a double sigmoidal curve to given data by using likelihood maximization (LM) algorithm and provides the parameters (maximum, final asymptote intensity, slope1Param, midpoint1Param, slope2Param, and midpoint distance) describing the double-sigmoidal fit as output. It also contains information about the goodness of fits such as AIC, BIC, residual sum of squares, and log likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doublesigmoidalFitFunction(
  dataInput,
  tryCounter,
  startList = list(finalAsymptoteIntensityRatio = 0, maximum = 1, slope1Param = 1,
    midPoint1Param = 0.33, slope2Param = 1, midPointDistanceParam = 0.29),
  lowerBounds = c(finalAsymptoteIntensityRatio = 0, maximum = 0.3, slope1Param = 0.01,
    midPoint1Param = -0.52, slope2Param = 0.01, midPointDistanceParam = 0.04),
  upperBounds = c(finalAsymptoteIntensityRatio = 1, maximum = 1.5, slope1Param = 180,
    midPoint1Param = 1.15, slope2Param = 180, midPointDistanceParam = 0.63),
  min_Factor = 1/2^20,
  n_iterations = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doublesigmoidalFitFunction_+3A_datainput">dataInput</code></td>
<td>
<p>A data frame or a list contatining the dataframe. The data frame should be composed of at least two columns. One represents time, and the other represents intensity. The data should be normalized with the normalize data function sicegar::normalizeData() before imported into this function.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFunction_+3A_trycounter">tryCounter</code></td>
<td>
<p>A counter that shows the number of times the data was fit via maximum likelihood function.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFunction_+3A_startlist">startList</code></td>
<td>
<p>The initial set of parameters vector that algorithm tries for the first fit attempt for the relevant parameters. The vector composes of six elements; 'finalAsymptoteIntensityRatio', 'maximum', 'slope1Param', 'midPoint1Param' , 'slope2Param', and 'midPointDistanceParam'. Detailed explanations of those parameters can be found in vignettes. Defaults are  finalAsymptoteIntensityRatio = 0, maximum = 1, slope1Param = 1, midPoint1Param = 0.33, slope2Param = 1, and midPointDistanceParam=0.29. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFunction_+3A_lowerbounds">lowerBounds</code></td>
<td>
<p>The lower bounds for the randomly generated start parameters.  The vector composes of six elements; 'finalAsymptoteIntensityRatio', 'maximum', 'slope1Param', 'midPoint1Param' , 'slope2Param', and 'midPointDistanceParam'. Detailed explanations of those parameters can be found in vignettes. Defaults are finalAsymptoteIntensityRatio = 0, maximum = 0.3, slope1Param = .01, midPoint1Param = -0.52, slope2Param = .01, and midPointDistanceParam = 0.04. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFunction_+3A_upperbounds">upperBounds</code></td>
<td>
<p>The upper bounds for the randomly generated start parameters.  The vector composes of six elements; 'finalAsymptoteIntensityRatio', 'maximum', 'slope1Param', 'midPoint1Param' , 'slope2Param', and 'midPointDistanceParam'. Detailed explanations of those parameters can be found in vignettes. Defaults are finalAsymptoteIntensityRatio = 1, maximum = 1.5, slope1Param = 180, midPoint1Param = 1.15, slope2Param = 180, and midPointDistanceParam = 0.63. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFunction_+3A_min_factor">min_Factor</code></td>
<td>
<p>Defines the minimum step size used by the fitting algorithm. Default is 1/2^20.</p>
</td></tr>
<tr><td><code id="doublesigmoidalFitFunction_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Define maximum number of iterations used by the fitting algorithm. Default is 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the fitted parameters and goodness of fit metrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>time=seq(3, 24, 0.1)

#simulate intensity data and add noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- doublesigmoidalFitFormula(time,
                                     finalAsymptoteIntensityRatio = .3,
                                     maximum = 4,
                                     slope1Param = 1,
                                     midPoint1Param = 7,
                                     slope2Param = 1,
                                     midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput)
parameterVector &lt;- doublesigmoidalFitFunction(normalizedInput, tryCounter = 2)


#Check the results
if(parameterVector$isThisaFit){
    intensityTheoretical &lt;-
         doublesigmoidalFitFormula(
             time,
             finalAsymptoteIntensityRatio = parameterVector$finalAsymptoteIntensityRatio_Estimate,
             maximum = parameterVector$maximum_Estimate,
             slope1Param = parameterVector$slope1Param_Estimate,
             midPoint1Param = parameterVector$midPoint1Param_Estimate,
             slope2Param = parameterVector$slope2Param_Estimate,
             midPointDistanceParam = parameterVector$midPointDistanceParam_Estimate)

 comparisonData &lt;- cbind(dataInput, intensityTheoretical)

 require(ggplot2)
 ggplot(comparisonData) +
   geom_point(aes(x = time, y = intensity)) +
   geom_line(aes(x = time, y = intensityTheoretical)) +
   expand_limits(x = 0, y = 0)}

if(!parameterVector$isThisaFit) {print(parameterVector)}

</code></pre>

<hr>
<h2 id='figureModelCurves'>Generate model associated figures.</h2><span id='topic+figureModelCurves'></span>

<h3>Description</h3>

<p>Generates figures using ggplot that shows the input data and the fitted curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>figureModelCurves(
  dataInput,
  sigmoidalFitVector = NULL,
  doubleSigmoidalFitVector = NULL,
  showParameterRelatedLines = FALSE,
  xlabelText = "time",
  ylabelText = "intensity",
  fittedXmin = 0,
  fittedXmax = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="figureModelCurves_+3A_datainput">dataInput</code></td>
<td>
<p>A data frame or a list contatining the dataframe. The data frame should be composed of at least two columns. One represents time, and the other represents intensity. The data should be normalized with the normalize data function sicegar::normalizeData() before imported into this function.</p>
</td></tr>
<tr><td><code id="figureModelCurves_+3A_sigmoidalfitvector">sigmoidalFitVector</code></td>
<td>
<p>the output of the sicegar::sigmoidalFitFunction(), or the agumented version of the output generated by the help of sicegar::parameterCalculation(), which contains parameters related with sigmoidal model. Default is NULL.</p>
</td></tr>
<tr><td><code id="figureModelCurves_+3A_doublesigmoidalfitvector">doubleSigmoidalFitVector</code></td>
<td>
<p>the output of the sicegar::doubleSigmoidalFitFunction(), or the agumented version of the output generated by the help of sicegar::parameterCalculation(), which contains parameters related with double sigmoidal model. Default is NULL.</p>
</td></tr>
<tr><td><code id="figureModelCurves_+3A_showparameterrelatedlines">showParameterRelatedLines</code></td>
<td>
<p>if equal to TRUE, figure will show parameter related lines on the curves. Default is FALSE.</p>
</td></tr>
<tr><td><code id="figureModelCurves_+3A_xlabeltext">xlabelText</code></td>
<td>
<p>the x-axis name; with default &quot;time&quot;</p>
</td></tr>
<tr><td><code id="figureModelCurves_+3A_ylabeltext">ylabelText</code></td>
<td>
<p>the y-axis name; with default &quot;intensity&quot;</p>
</td></tr>
<tr><td><code id="figureModelCurves_+3A_fittedxmin">fittedXmin</code></td>
<td>
<p>the minimum of the fitted data that will be plotted (Default 0)</p>
</td></tr>
<tr><td><code id="figureModelCurves_+3A_fittedxmax">fittedXmax</code></td>
<td>
<p>the maximum of the fitted data that will be plotted (Default timeRange)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns infection curve figures.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>time &lt;- seq(3, 24, 0.1)

#simulate intensity data and add noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- sicegar::doublesigmoidalFitFormula(time,
                                               finalAsymptoteIntensityRatio = .3,
                                               maximum = 4,
                                               slope1Param = 1,
                                               midPoint1Param = 7,
                                               slope2Param = 1,
                                               midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- sicegar::normalizeData(dataInput, dataInputName = "sample001")


# Do the double sigmoidal fit
doubleSigmoidalModel &lt;- sicegar::multipleFitFunction(dataInput = normalizedInput,
                                                    model = "doublesigmoidal",
                                                    n_runs_min = 20,
                                                    n_runs_max = 500,
                                                    showDetails = FALSE)

doubleSigmoidalModel &lt;- sicegar::parameterCalculation(doubleSigmoidalModel)

fig01 &lt;- sicegar::figureModelCurves(dataInput = normalizedInput,
                                  doubleSigmoidalFitVector = doubleSigmoidalModel,
                                  showParameterRelatedLines = TRUE)
print(fig01)


</code></pre>

<hr>
<h2 id='fitAndCategorize'>Fit and categorize.</h2><span id='topic+fitAndCategorize'></span>

<h3>Description</h3>

<p>Fits the sigmoidal and double-sigmoidal models to the data and then categorizes the data according to which model fits best.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitAndCategorize(
  dataInput,
  dataInputName = NA,
  n_runs_min_sm = 20,
  n_runs_max_sm = 500,
  n_runs_min_dsm = 20,
  n_runs_max_dsm = 500,
  showDetails = FALSE,
  startList_sm = list(maximum = 1, slopeParam = 1, midPoint = 0.33),
  lowerBounds_sm = c(maximum = 0.3, slopeParam = 0.01, midPoint = -0.52),
  upperBounds_sm = c(maximum = 1.5, slopeParam = 180, midPoint = 1.15),
  min_Factor_sm = 1/2^20,
  n_iterations_sm = 1000,
  startList_dsm = list(finalAsymptoteIntensityRatio = 0, maximum = 1, slope1Param = 1,
    midPoint1Param = 0.33, slope2Param = 1, midPointDistanceParam = 0.29),
  lowerBounds_dsm = c(finalAsymptoteIntensityRatio = 0, maximum = 0.3, slope1Param =
    0.01, midPoint1Param = -0.52, slope2Param = 0.01, midPointDistanceParam = 0.04),
  upperBounds_dsm = c(finalAsymptoteIntensityRatio = 1, maximum = 1.5, slope1Param =
    180, midPoint1Param = 1.15, slope2Param = 180, midPointDistanceParam = 0.63),
  min_Factor_dsm = 1/2^20,
  n_iterations_dsm = 1000,
  threshold_intensity_range = 0.1,
  threshold_minimum_for_intensity_maximum = 0.3,
  threshold_bonus_sigmoidal_AIC = 0,
  threshold_sm_tmax_IntensityRatio = 0.85,
  threshold_dsm_tmax_IntensityRatio = 0.75,
  threshold_AIC = -10,
  threshold_t0_max_int = 0.05,
  stepSize = 1e-05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitAndCategorize_+3A_datainput">dataInput</code></td>
<td>
<p>Un_normalized input data that will be fitted transferred into related functions</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_datainputname">dataInputName</code></td>
<td>
<p>Name of data set (Default is 'NA').</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_n_runs_min_sm">n_runs_min_sm</code></td>
<td>
<p>This number indicates the lower limit of the successful fitting attempts for sigmoidal model. It should be smaller than the upper limit of the fitting attempts (n_runs_max_sm). Default is 20</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_n_runs_max_sm">n_runs_max_sm</code></td>
<td>
<p>This number indicates the upper limit of the fitting attempts for sigmoidal model. Default is 500</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_n_runs_min_dsm">n_runs_min_dsm</code></td>
<td>
<p>This number indicates the lower limit of the successful fitting attempts for double sigmoidal model. It should be smaller than the upper limit of the fitting attempts (n_runs_max_dsm). Default is 20</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_n_runs_max_dsm">n_runs_max_dsm</code></td>
<td>
<p>This number indicates the upper limit of the fitting attempts for sigmoidal model for double sigmoidal model. Default is 500</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_showdetails">showDetails</code></td>
<td>
<p>Logical if TRUE prints details of intermediate steps of individual fits (Default is FALSE).</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_startlist_sm">startList_sm</code></td>
<td>
<p>The initial set of parameters vector that sigmoidal fit algorithm tries for the first fit attempt for the relevant parameters. The vector composes of three elements; 'maximum', 'slopeParam' and, 'midPoint'.  Detailed explanations of those parameters can be found in vignettes. Defaults are maximum = 1, slopeParam = 1 and, midPoint = 0.33. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_lowerbounds_sm">lowerBounds_sm</code></td>
<td>
<p>The lower bounds for the randomly generated start parameters for the sigmoidal fit. The vector composes of three elements; 'maximum', 'slopeParam' and, 'midPoint'. Detailed explanations of those parameters can be found in vignettes. Defaults are maximum = 0.3, slopeParam = 0.01, and midPoint = -0.52. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_upperbounds_sm">upperBounds_sm</code></td>
<td>
<p>The upper bounds for the randomly generated start parameters for the sigmoidal fit. The vector composes of three elements; 'maximum', 'slopeParam' and, 'midPoint'. Detailed explanations of those parameters can be found in vignettes. Defaults are maximum = 1.5, slopeParam = 180,  midPoint = 1.15. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_min_factor_sm">min_Factor_sm</code></td>
<td>
<p>Defines Defines the minimum step size used by the sigmoidal fit algorithm. Default is 1/2^20.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_n_iterations_sm">n_iterations_sm</code></td>
<td>
<p>Defines maximum number of iterations used by the sigmoidal fit algorithm. Default is 1000</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_startlist_dsm">startList_dsm</code></td>
<td>
<p>The initial set of parameters vector that double sigmoidal fit algorithm tries for the first fit attempt for the relevant parameters. The vector composes of six elements; 'finalAsymptoteIntensityRatio', 'maximum', 'slope1Param', 'midPoint1Param' , 'slope2Param', and 'midPointDistanceParam'. Detailed explanations of those parameters can be found in vignettes. Defaults are  finalAsymptoteIntensityRatio = 0, maximum = 1, slope1Param = 1, midPoint1Param = 0.33, slope2Param = 1, and midPointDistanceParam=0.29. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_lowerbounds_dsm">lowerBounds_dsm</code></td>
<td>
<p>The lower bounds for the randomly generated start parameters for double sigmoidal fit.  The vector composes of six elements; 'finalAsymptoteIntensityRatio', 'maximum', 'slope1Param', 'midPoint1Param' , 'slope2Param', and 'midPointDistanceParam'. Detailed explanations of those parameters can be found in vignettes. Defaults are finalAsymptoteIntensityRatio = 0, maximum = 0.3, slope1Param = .01, midPoint1Param = -0.52, slope2Param = .01, and midPointDistanceParam = 0.04. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_upperbounds_dsm">upperBounds_dsm</code></td>
<td>
<p>The upper bounds for the randomly generated start parameters for double sigmoidal fit.  The vector composes of six elements; 'finalAsymptoteIntensityRatio', 'maximum', 'slope1Param', 'midPoint1Param' , 'slope2Param', and 'midPointDistanceParam'. Detailed explanations of those parameters can be found in vignettes. Defaults are finalAsymptoteIntensityRatio = 1, maximum = 1.5, slope1Param = 180, midPoint1Param = 1.15, slope2Param = 180, and midPointDistanceParam = 0.63. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_min_factor_dsm">min_Factor_dsm</code></td>
<td>
<p>Defines the minimum step size used by the double sigmoidal fit algorithm. Default is 1/2^20.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_n_iterations_dsm">n_iterations_dsm</code></td>
<td>
<p>Define maximum number of iterations used by the double sigmoidal fit algorithm. Default is 1000</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_threshold_intensity_range">threshold_intensity_range</code></td>
<td>
<p>Minimum for intensity range, i.e. it is the lower limit for the allowed difference between the maximum and minimum of the intensities (Default is 0.1, and the values are based on actual, not the rescaled data.).</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_threshold_minimum_for_intensity_maximum">threshold_minimum_for_intensity_maximum</code></td>
<td>
<p>Minimum allowed value for intensity maximum. (Default is 0.3, and the values are based on actual, not the rescaled data.).</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_threshold_bonus_sigmoidal_aic">threshold_bonus_sigmoidal_AIC</code></td>
<td>
<p>Bonus AIC points for sigmoidal fit. Negative values help the sigmoidal model to win. Only helps in competition between sigmoidal and double sigmoidal fit at decision step &quot;9&quot;, i.e. if none of the models fail in any of the tests and stay as a candidate until the last step (Default is 0).</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_threshold_sm_tmax_intensityratio">threshold_sm_tmax_IntensityRatio</code></td>
<td>
<p>The threshold for the minimum intensity ratio between the last observed time points intensity and theoretical maximum intensity of the sigmoidal curve. If the value is below the threshold, then the data can not be represented with the sigmoidal model. (Default is 0.85)</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_threshold_dsm_tmax_intensityratio">threshold_dsm_tmax_IntensityRatio</code></td>
<td>
<p>The threshold for the minimum intensity ratio between the last observed time points intensity and maximum intensity of the double sigmoidal curve.  If the value is above the threshold, then the data can not be represented with the double sigmoidal model. (Default is 0.75)</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_threshold_aic">threshold_AIC</code></td>
<td>
<p>Maximum AIC values in order to have a meaningful fit (Default is -10).</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_threshold_t0_max_int">threshold_t0_max_int</code></td>
<td>
<p>Maximum allowed intensity of the fitted curve at time is equal to zero (t=0). (Default is 0.05, and the values are based on actual, not the rescaled data.).</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_stepsize">stepSize</code></td>
<td>
<p>Step size used by the fitting algorithm. Smaller numbers gave more accurate results than larger numbers, and larger numbers gave the results faster than small numbers. The default value is 0.00001.</p>
</td></tr>
<tr><td><code id="fitAndCategorize_+3A_...">...</code></td>
<td>
<p>All other arguments that model functions (&quot;sigmoidalFitFunction&quot; and, &quot;doublesigmoidalFitFunction&quot;) may need.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the parameters related with the curve fitted to the input data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
time &lt;- seq(3, 24, 0.5)

#simulate intensity data and add noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- sicegar::doublesigmoidalFitFormula(time,
                                               finalAsymptoteIntensityRatio = .3,
                                               maximum = 4,
                                               slope1Param = 1,
                                               midPoint1Param = 7,
                                               slope2Param = 1,
                                               midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)

fitObj &lt;- sicegar::fitAndCategorize(dataInput = dataInput)

</code></pre>

<hr>
<h2 id='multipleFitFunction'>multiple fit function.</h2><span id='topic+multipleFitFunction'></span>

<h3>Description</h3>

<p>Calls the fitting algorithms to fit the data multiple times with starting from different randomly generated initial parameters in each run. Multiple attempts at fitting the data are necessary to avoid local minima.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multipleFitFunction(
  dataInput,
  dataInputName = NA,
  model,
  n_runs_min = 20,
  n_runs_max = 500,
  showDetails = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multipleFitFunction_+3A_datainput">dataInput</code></td>
<td>
<p>A data frame or a list contatining the dataframe. The data frame should be composed of at least two columns. One represents time, and the other represents intensity. The data should be normalized with the normalize data function sicegar::normalizeData() before imported into this function.</p>
</td></tr>
<tr><td><code id="multipleFitFunction_+3A_datainputname">dataInputName</code></td>
<td>
<p>Name of data set (Default is 'NA').</p>
</td></tr>
<tr><td><code id="multipleFitFunction_+3A_model">model</code></td>
<td>
<p>Type of fit model that will be used. Can be &quot;sigmoidal&quot;, or &quot;double_sigmoidal&quot;.</p>
</td></tr>
<tr><td><code id="multipleFitFunction_+3A_n_runs_min">n_runs_min</code></td>
<td>
<p>This number indicates the lower limit of the successful fitting attempts. It should be smaller than the upper limit of the fitting attempts (n_runs_max). Default is 20.</p>
</td></tr>
<tr><td><code id="multipleFitFunction_+3A_n_runs_max">n_runs_max</code></td>
<td>
<p>This number indicates the upper limit of the fitting attempts. Default is 500.</p>
</td></tr>
<tr><td><code id="multipleFitFunction_+3A_showdetails">showDetails</code></td>
<td>
<p>Logical if TRUE prints details of intermediate steps of individual fits (Default is FALSE).</p>
</td></tr>
<tr><td><code id="multipleFitFunction_+3A_...">...</code></td>
<td>
<p>All other arguments that model functions (&quot;sigmoidalFitFunction&quot; and, &quot;doublesigmoidalFitFunction&quot;) may need.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the parameters related with the model fitted for the input data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1 (sigmoidal function with normalization)
time &lt;- seq(3, 24, 0.5)

#simulate intensity data and add noise
noise_parameter &lt;- 2.5
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- sigmoidalFitFormula(time, maximum = 4, slopeParam = 1, midPoint = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput, dataInputName = "sample001")
parameterVector &lt;- multipleFitFunction(dataInput = normalizedInput,
                                      model = "sigmoidal",
                                      n_runs_min = 20,
                                      n_runs_max = 500)

#Check the results
if(parameterVector$isThisaFit){
  intensityTheoretical &lt;- sigmoidalFitFormula(time,
                            maximum = parameterVector$maximum_Estimate,
                            slopeParam = parameterVector$slopeParam_Estimate,
                            midPoint = parameterVector$midPoint_Estimate)

 comparisonData &lt;- cbind(dataInput, intensityTheoretical)

 print(parameterVector$residual_Sum_of_Squares)

 require(ggplot2)
 ggplot(comparisonData)+
   geom_point(aes(x = time, y = intensity)) +
   geom_line(aes(x = time, y = intensityTheoretical), color = "orange") +
   expand_limits(x = 0, y = 0)
}



if(!parameterVector$isThisaFit){
  print(parameterVector)
}

# Example 2 (doublesigmoidal function with normalization)
time &lt;- seq(3, 24, 0.1)

#simulate intensity data with noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- doublesigmoidalFitFormula(time,
                                      finalAsymptoteIntensityRatio = .3,
                                      maximum = 4,
                                      slope1Param = 1,
                                      midPoint1Param = 7,
                                      slope2Param = 1,
                                      midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput)
parameterVector &lt;- multipleFitFunction(dataInput = normalizedInput,
                           dataInputName="sample001",
                           model = "doublesigmoidal",
                           n_runs_min = 20,
                           n_runs_max = 500,
                           showDetails = FALSE)


#Check the results
if(parameterVector$isThisaFit){
 intensityTheoretical &lt;-
       doublesigmoidalFitFormula(
               time,
               finalAsymptoteIntensityRatio = parameterVector$finalAsymptoteIntensityRatio_Estimate,
               maximum = parameterVector$maximum_Estimate,
               slope1Param = parameterVector$slope1Param_Estimate,
               midPoint1Param = parameterVector$midPoint1Param_Estimate,
               slope2Param = parameterVector$slope2Param_Estimate,
               midPointDistanceParam = parameterVector$midPointDistanceParam_Estimate)

 comparisonData &lt;- cbind(dataInput, intensityTheoretical)

 require(ggplot2)
 ggplot(comparisonData) +
   geom_point(aes(x = time, y = intensity)) +
   geom_line(aes(x = time, y = intensityTheoretical), color = "orange") +
   expand_limits(x = 0, y = 0)
 }

if(!parameterVector$isThisaFit){
  print(parameterVector)
  }


</code></pre>

<hr>
<h2 id='normalizeData'>Normalization of given data</h2><span id='topic+normalizeData'></span>

<h3>Description</h3>

<p>Maps the given time-intensity data into a rescaled data frame where time is scaled in a way that maximum time point is one and intensity is distributed between [0,1].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizeData(dataInput, dataInputName = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalizeData_+3A_datainput">dataInput</code></td>
<td>
<p>A data frame or a list contatining the dataframe. The data frame should be composed of at least two columns. One represents time, and the other represents intensity.</p>
</td></tr>
<tr><td><code id="normalizeData_+3A_datainputname">dataInputName</code></td>
<td>
<p>experiment name (Default is 'NA').</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function returns a new data frame, scaling factors and scaling constants that connects initial data frame to new one. The new data frame includes 2 columns one is for normalized time and the other is for noralized intensity. The whole time is distributed between 0 and 1 and similarly the whole intensity is distributed between 0 and 1. The time and intensity constants and scaling factors are the parameters to transform data from unnormalized data frame to normalized data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generateRandomData
time &lt;- seq(3, 48, 0.5)
intensity &lt;- runif(length(time), 3.0, 7.5)
dataInput &lt;- data.frame(time, intensity)

# Normalize Data
dataOutput &lt;- normalizeData(dataInput, dataInputName="sample001")

</code></pre>

<hr>
<h2 id='parameterCalculation'>useful paramter calculation with help of fits</h2><span id='topic+parameterCalculation'></span>

<h3>Description</h3>

<p>Generates useful values for external use, with the help of parameterVector's of the fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parameterCalculation(parameterVector, stepSize = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parameterCalculation_+3A_parametervector">parameterVector</code></td>
<td>
<p>Output of multiple fit function sicegar::multipleFitFunction() that gives the variables related with sigmoidal or double sigmoidal fit.</p>
</td></tr>
<tr><td><code id="parameterCalculation_+3A_stepsize">stepSize</code></td>
<td>
<p>Step size used by the fitting algorithm. Smaller numbers gave more accurate results than larger numbers, and larger numbers gave the results faster than small numbers. The default value is 0.00001.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the expanded parameter vector. This vector includes useful derived values such as time and intensity of the start point, in addition to the standard values that the fit algorithms produce that are necessary to define the curves.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>time &lt;- seq(3, 24, 0.1)

#simulate intensity data with noise
noise_parameter &lt;- 0.2
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- sicegar::doublesigmoidalFitFormula(time,
                                            finalAsymptoteIntensityRatio = .3,
                                            maximum = 4,
                                            slope1Param = 1,
                                            midPoint1Param = 7,
                                            slope2Param = 1,
                                            midPointDistanceParam = 8)
intensity &lt;- intensity+intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- sicegar::normalizeData(dataInput)
parameterVector &lt;- sicegar::multipleFitFunction(dataInput = normalizedInput,
                                            dataInputName = "sample01",
                                            model = "doublesigmoidal",
                                            n_runs_min = 20,
                                            n_runs_max = 500,
                                            showDetails = FALSE)

if(parameterVector$isThisaFit){
       parameterVector &lt;- sicegar::parameterCalculation(parameterVector)
}

print(t(parameterVector))

</code></pre>

<hr>
<h2 id='preCategorize'>Checks for signal in the data.</h2><span id='topic+preCategorize'></span>

<h3>Description</h3>

<p>Checks if the signal is present in the data. Often a high percentage of high through-put data does not contain a signal. Checking if data does not contain signal before doing a sigmoidal or double sigmoidal fit can make the analysis of data from high-throughput experiments much faster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preCategorize(
  normalizedInput,
  threshold_intensity_range = 0.1,
  threshold_minimum_for_intensity_maximum = 0.3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="preCategorize_+3A_normalizedinput">normalizedInput</code></td>
<td>
<p>is the output of the sicegar::normalizeData() function.</p>
</td></tr>
<tr><td><code id="preCategorize_+3A_threshold_intensity_range">threshold_intensity_range</code></td>
<td>
<p>minimum for intensity range, i.e. it is the lower limit for the allowed difference between the maximum and minimum of the intensities (Default is 0.1, and the values are based on actual, not the rescaled data.).</p>
</td></tr>
<tr><td><code id="preCategorize_+3A_threshold_minimum_for_intensity_maximum">threshold_minimum_for_intensity_maximum</code></td>
<td>
<p>minimum allowed value for intensity maximum. (Default is 0.3, and the values are based on actual, not the rescaled data.).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function returns a brief decision list that includes information about the decision process. Post important part of this information is decisionList$decisionwhich might be either &quot;no_signal&quot; or &quot;not_no_signal&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1 with double sigmoidal data

time=seq(3, 24, 0.1)

#simulate intensity data and add noise
noise_parameter = 0.2
intensity_noise = runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity = sicegar::doublesigmoidalFitFormula(time,
                                              finalAsymptoteIntensityRatio = .3,
                                              maximum = 4,
                                              slope1Param = 1,
                                              midPoint1Param = 7,
                                              slope2Param = 1,
                                              midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- sicegar::normalizeData(dataInput, dataInputName = "sample001")
isThis_nosignal &lt;- sicegar::preCategorize(normalizedInput = normalizedInput)



# Example 2 with no_signal data

time &lt;- seq(3, 24, 0.1)

#simulate intensity data and add noise
noise_parameter &lt;- 0.05
intensity_noise &lt;- runif(n = length(time), min = 0, max = 1) * noise_parameter * 2e-04
intensity &lt;- sicegar::doublesigmoidalFitFormula(time,
                                               finalAsymptoteIntensityRatio = .3,
                                               maximum = 2e-04,
                                               slope1Param = 1,
                                               midPoint1Param = 7,
                                               slope2Param = 1,
                                               midPointDistanceParam = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity=intensity, time=time)
normalizedInput &lt;- sicegar::normalizeData(dataInput,dataInputName = "sample001")
isThis_nosignal &lt;- sicegar::preCategorize(normalizedInput = normalizedInput)

</code></pre>

<hr>
<h2 id='sameSourceDataCheck'>Check is data came from the same source.</h2><span id='topic+sameSourceDataCheck'></span>

<h3>Description</h3>

<p>Checks if the provided data and models came from same source by looking to &quot;.dataInputName&quot; columns of the inputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sameSourceDataCheck(dataInput, sigmoidalFitVector, doubleSigmoidalFitVector)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sameSourceDataCheck_+3A_datainput">dataInput</code></td>
<td>
<p>a data frame composed of two columns. One is for time and the other is for intensity. Should be normalized data generated by normalizeData.</p>
</td></tr>
<tr><td><code id="sameSourceDataCheck_+3A_sigmoidalfitvector">sigmoidalFitVector</code></td>
<td>
<p>is the output of sigmoidalFitFunction. Default is NULL.</p>
</td></tr>
<tr><td><code id="sameSourceDataCheck_+3A_doublesigmoidalfitvector">doubleSigmoidalFitVector</code></td>
<td>
<p>is the output of double sigmoidal fit function. Default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE if models can from same source, FALSE otherwise.
</p>

<hr>
<h2 id='sigmoidalFitFormula'>sigmoidalFitFormula</h2><span id='topic+sigmoidalFitFormula'></span>

<h3>Description</h3>

<p>Calculates intesities for given time points (x) by using sigmoidal fit model and parameters (maximum, slopeParam, and midpoint).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmoidalFitFormula(x, maximum, slopeParam, midPoint)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sigmoidalFitFormula_+3A_x">x</code></td>
<td>
<p>the &quot;time&quot; (time) column of the dataframe.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFormula_+3A_maximum">maximum</code></td>
<td>
<p>the maximum intensity that the sigmoidal function can reach while time approaches infinity.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFormula_+3A_slopeparam">slopeParam</code></td>
<td>
<p>the slope parameter of the sigmoidal function at the steppest point.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFormula_+3A_midpoint">midPoint</code></td>
<td>
<p>the x axis value of the steppest point in the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the predicted intensities for given time points with the given sigmoidal fit parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
time &lt;- seq(3, 24, 0.5)

#simulate intensity data and add noise
noise_parameter &lt;- 0.1
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- sigmoidalFitFormula(time, maximum = 4, slopeParam = 1, midPoint = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput)
parameterVector &lt;- sigmoidalFitFunction(normalizedInput, tryCounter = 2)

#Check the results
if(parameterVector$isThisaFit){
 intensityTheoretical &lt;- sigmoidalFitFormula(time,
                                             maximum = parameterVector$maximum_Estimate,
                                             slopeParam = parameterVector$slopeParam_Estimate,
                                             midPoint = parameterVector$midPoint_Estimate)

 comparisonData &lt;- cbind(dataInput, intensityTheoretical)

 require(ggplot2)
 ggplot(comparisonData) +
   geom_point(aes(x = time, y = intensity)) +
   geom_line(aes(x = time, y = intensityTheoretical)) +
   expand_limits(x = 0, y = 0)
}

if(!parameterVector$isThisaFit){
  print(parameterVector)
}



</code></pre>

<hr>
<h2 id='sigmoidalFitFunction'>Sigmoidal fit function</h2><span id='topic+sigmoidalFitFunction'></span>

<h3>Description</h3>

<p>The function fits a sigmoidal curve to given data by using likelihood maximization (LM) algorithm and provides the parameters (maximum, slopeParam and, midPoint) describing the double-sigmoidal fit as output. It also contains information about the goodness of fits such as AIC, BIC, residual sum of squares, and log likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmoidalFitFunction(
  dataInput,
  tryCounter,
  startList = list(maximum = 1, slopeParam = 1, midPoint = 0.33),
  lowerBounds = c(maximum = 0.3, slopeParam = 0.01, midPoint = -0.52),
  upperBounds = c(maximum = 1.5, slopeParam = 180, midPoint = 1.15),
  min_Factor = 1/2^20,
  n_iterations = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sigmoidalFitFunction_+3A_datainput">dataInput</code></td>
<td>
<p>A data frame or a list contatining the dataframe. The data frame should be composed of at least two columns. One represents time, and the other represents intensity. The data should be normalized with the normalize data function sicegar::normalizeData() before imported into this function.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFunction_+3A_trycounter">tryCounter</code></td>
<td>
<p>A counter that shows the number of times the data was fit via maximum likelihood function.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFunction_+3A_startlist">startList</code></td>
<td>
<p>The initial set of parameters vector that algorithm tries for the first fit attempt for the relevant parameters. The vector composes of three elements; 'maximum', 'slopeParam' and, 'midPoint'.  Detailed explanations of those parameters can be found in vignettes. Defaults are maximum = 1, slopeParam = 1 and, midPoint = 0.33. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFunction_+3A_lowerbounds">lowerBounds</code></td>
<td>
<p>The lower bounds for the randomly generated start parameters.  The vector composes of three elements; 'maximum', 'slopeParam' and, 'midPoint'. Detailed explanations of those parameters can be found in vignettes. Defaults are maximum = 0.3, slopeParam = 0.01, and midPoint = -0.52. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFunction_+3A_upperbounds">upperBounds</code></td>
<td>
<p>The upper bounds for the randomly generated start parameters.  The vector composes of three elements; 'maximum', 'slopeParam' and, 'midPoint'. Detailed explanations of those parameters can be found in vignettes. Defaults are maximum = 1.5, slopeParam = 180,  midPoint = 1.15. The numbers are in normalized time intensity scale.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFunction_+3A_min_factor">min_Factor</code></td>
<td>
<p>Defines the minimum step size used by the fitting algorithm. Default is 1/2^20.</p>
</td></tr>
<tr><td><code id="sigmoidalFitFunction_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Defines maximum number of iterations used by the fitting algorithm. Default is 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns fitted parameters for the sigmoidal model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>time &lt;- seq(3, 24, 0.5)

#simulate intensity data and add noise
noise_parameter &lt;- 0.1
intensity_noise &lt;- stats::runif(n = length(time), min = 0, max = 1) * noise_parameter
intensity &lt;- sigmoidalFitFormula(time, maximum = 4, slopeParam = 1, midPoint = 8)
intensity &lt;- intensity + intensity_noise

dataInput &lt;- data.frame(intensity = intensity, time = time)
normalizedInput &lt;- normalizeData(dataInput)
parameterVector &lt;- sigmoidalFitFunction(normalizedInput, tryCounter = 2)

#Check the results
if(parameterVector$isThisaFit){
intensityTheoretical &lt;- sigmoidalFitFormula(time,
                                           maximum = parameterVector$maximum_Estimate,
                                           slopeParam = parameterVector$slopeParam_Estimate,
                                           midPoint = parameterVector$midPoint_Estimate)

comparisonData &lt;- cbind(dataInput, intensityTheoretical)

require(ggplot2)
ggplot(comparisonData) +
 geom_point(aes(x = time, y = intensity)) +
 geom_line(aes(x = time, y = intensityTheoretical)) +
 expand_limits(x = 0, y = 0)
}

if(!parameterVector$isThisaFit){
  print(parameterVector)
}

</code></pre>

<hr>
<h2 id='unnormalizeData'>Unnormalization of given data</h2><span id='topic+unnormalizeData'></span>

<h3>Description</h3>

<p>Maps the given time-intensity data into a rescaled frame where time is between [0,1] and similarly intensity is between [0,1].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unnormalizeData(dataInput)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unnormalizeData_+3A_datainput">dataInput</code></td>
<td>
<p>a list file composes of two parts
First part is the data that will be unnormalized, which is a data frame composed of two columns. One is for time and the other is for intensity
Second part is the scaling parameters of the data which is a vector that has three components. The first one of them is related with time and last two of them are related with intensity. The second value represents the min value of the intensity set. First and third values represent the difference between max and min value in the relevant column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame, scaling factors and scaling constants for time and intensity. The other data frame includes 2 columns one is for normalized time and the other is for noralized intensity. The whole time is distributed between 0 and 1 and similarly the whole intensity is distributed between 0 and 1. The time and intensity constants and scaling factors are the parameters to transform data from given set to scaled set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generateRandomData
time &lt;- seq(3, 48, 0.5)
intensity &lt;- runif(length(time), 3.0, 7.5)
dataInput &lt;- data.frame(time, intensity)
# Normalize Data
dataOutput &lt;- normalizeData(dataInput)
dataInput2 &lt;- dataOutput
# Un Normalize it
dataOutput2 &lt;- unnormalizeData(dataInput2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
