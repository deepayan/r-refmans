<!DOCTYPE html><html><head><title>Help for package qrng</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qrng}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#qrng'><p>Compute Quasi-Random Sequences</p></a></li>
<li><a href='#test_functions'><p>Test Functions</p></a></li>
<li><a href='#to_array'><p>Compute Matrices to Arrays</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.0-10</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Title:</td>
<td>(Randomized) Quasi-Random Number Generators</td>
</tr>
<tr>
<td>Description:</td>
<td>Functionality for generating (randomized) quasi-random numbers in
  high dimensions.</td>
</tr>
<tr>
<td>Author:</td>
<td>Marius Hofert [aut, cre],
  Christiane Lemieux [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marius Hofert &lt;mhofert@hku.hk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spacefillr, randtoolbox, copula</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-29 14:40:02 UTC</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-29 14:01:42 UTC; mhofert</td>
</tr>
</table>
<hr>
<h2 id='qrng'>Compute Quasi-Random Sequences</h2><span id='topic+korobov'></span><span id='topic+ghalton'></span><span id='topic+sobol'></span>

<h3>Description</h3>

<p>Computing Korobov, generalize Halton and Sobol' quasi-random sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>korobov(n, d = 1, generator, randomize = c("none", "shift"))
ghalton(n, d = 1, method = c("generalized", "halton"))
sobol  (n, d = 1, randomize = c("none", "digital.shift", "Owen", "Faure.Tezuka",
                                "Owen.Faure.Tezuka"), seed, skip = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qrng_+3A_n">n</code></td>
<td>
<p>number <code class="reqn">n</code> of points to be generated <code class="reqn">\ge 2</code>.</p>
</td></tr>
<tr><td><code id="qrng_+3A_d">d</code></td>
<td>
<p>dimension <code class="reqn">d</code>.</p>
</td></tr>
<tr><td><code id="qrng_+3A_generator">generator</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> of length <code class="reqn">d</code> or length 1
(in which case it is appropriately extended to length <code class="reqn">d</code>). All numbers
must be in <code class="reqn">\{1,\dots,n\}</code> and must be (coercible to)
integers.</p>
</td></tr>
<tr><td><code id="qrng_+3A_randomize">randomize</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> string indicating the type
of randomization for the point set.
</p>

<dl>
<dt><code>korobov()</code></dt><dd><p>one of the following:
</p>

<dl>
<dt>&quot;none&quot;</dt><dd><p>no randomization.</p>
</dd>
<dt>&quot;shift&quot;</dt><dd><p>a uniform random variate modulo 1.</p>
</dd>
</dl>

</dd>
<dt><code>sobol()</code></dt><dd><p>one of the following:
</p>

<dl>
<dt><code>"none"</code></dt><dd><p>no randomization.</p>
</dd>
<dt>&quot;digital.shift&quot;</dt><dd><p>a digital shift.</p>
</dd>
<dt>&quot;Owen&quot;</dt><dd><p>calls
<code><a href="spacefillr.html#topic+generate_sobol_owen_set">generate_sobol_owen_set</a>()</code>
from package <span class="pkg">spacefillr</span>.</p>
</dd>
<dt>&quot;Faure.Tezuka&quot;,&quot;Owen.Faure.Tezuka&quot;</dt><dd><p>calls
<code><a href="#topic+sobol">sobol</a>()</code> from package <span class="pkg">randtoolbox</span> with
<code>scrambling</code> being 2 and 3, respectively.</p>
</dd>
</dl>

<p>If <code>randomize</code> is a <code><a href="base.html#topic+logical">logical</a></code>, then
it is interpreted as <code>"none"</code> if <code>FALSE</code>
and <code>"digital.shift"</code> if <code>TRUE</code>.
</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="qrng_+3A_method">method</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> string indicating which
sequence is generated, generalized Halton or (plain) Halton.</p>
</td></tr>
<tr><td><code id="qrng_+3A_seed">seed</code></td>
<td>
<p>if provided, an integer used within
<code><a href="base.html#topic+set.seed">set.seed</a>()</code> for the non-scrambling <code>randomize</code>
methods (so <code>"none"</code> or <code>"digital.shift"</code>) or passed
to the underlying <code><a href="spacefillr.html#topic+generate_sobol_owen_set">generate_sobol_owen_set</a>()</code>
from package <span class="pkg">spacefillr</span> (for <code>"Owen"</code>) and
<code><a href="#topic+sobol">sobol</a>()</code> from package
<span class="pkg">randtoolbox</span> for the scrambling methods. If not provided,
the non-scrambling methods respect a global <code><a href="base.html#topic+set.seed">set.seed</a>()</code>
but the scrambling methods do not (they then use a randomly
generated one based on time and process identifier).</p>
</td></tr>
<tr><td><code id="qrng_+3A_skip">skip</code></td>
<td>
<p>number of initial points in the sequence to be skipped
(<code>skip = 0</code> means the sequence starts with at the origin).
Note that for the scrambling methods this simply computes <code>n +
      skip</code> points and omits the first <code>skip</code>-many.</p>
</td></tr>
<tr><td><code id="qrng_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+sobol">sobol</a>()</code>
from package <span class="pkg">randtoolbox</span> for randomization methods
<code>"Faure.Tezuka"</code> and <code>"Owen.Faure.Tezuka"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>sobol()</code> examples see <code>demo(sobol_examples)</code>.
</p>
<p>Note that these procedures call fast C code. The following
restrictions apply:
</p>

<dl>
<dt>korobov()</dt><dd><p><code>n</code>,<code>d</code> must be <code class="reqn">\le 2^{31}-1</code>.</p>
</dd>
<dt>ghalton()</dt><dd><p><code>n</code> must be <code class="reqn">\le 2^{32}-1</code> and
<code>d</code> must be <code class="reqn">\le 360</code>.</p>
</dd>
<dt>sobol()</dt><dd><p>if <code>randomize = "none"</code> or <code>randomize =
      "digital.shift"</code>, <code>n</code> must be <code class="reqn">\le 2^{31}-1</code> and
<code>d</code> must be <code class="reqn">\le 16510</code>.</p>
</dd>
</dl>

<p>The choice of parameters for <code>korobov()</code> is crucial for the quality of
this quasi-random sequence (only basic sanity checks are
conducted). For more details, see l'Ecuyer and Lemieux (2000).
</p>
<p>The generalized Halton sequence uses the scrambling factors of
Faure and Lemieux (2009).
</p>


<h3>Value</h3>

<p><code>korobov()</code> and <code>ghalton()</code> return an
<code class="reqn">(n,d)</code>-<code><a href="base.html#topic+matrix">matrix</a></code>; for <code class="reqn">d=1</code> an <code class="reqn">n</code>-vector
is returned.
</p>


<h3>Author(s)</h3>

<p>Marius Hofert and Christiane Lemieux</p>


<h3>References</h3>

<p>Faure, H., Lemieux, C. (2009). Generalized Halton Sequences in 2008:
A Comparative Study. <em>ACM-TOMACS</em> <b>19</b>(4), Article 15.
</p>
<p>l'Ecuyer, P., Lemieux, C. (2000). Variance Reduction via Lattice
Rules. <em>Stochastic Models and Simulation</em>, 1214&ndash;1235.
</p>
<p>Lemieux, C., Cieslak, M., Luttmer, K. (2004). RandQMC User's guide.
See https://www.math.uwaterloo.ca/~clemieux/randqmc/guide.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1021 # prime
d &lt;- 4 # dimension

## Korobov's sequence
generator &lt;- 76 # see l'Ecuyer and Lemieux
u &lt;- korobov(n, d = d, generator = generator)
pairs(u, gap = 0, pch = ".", labels = as.expression(
      sapply(1:d, function(j) bquote(italic(u[.(j)])))))

## Randomized Korobov's sequence
set.seed(271)
u &lt;- korobov(n, d = d, generator = generator, randomize = "shift")
pairs(u, gap = 0, pch = ".", labels = as.expression(
      sapply(1:d, function(j) bquote(italic(u[.(j)])))))

## Generalized Halton sequence (randomized by definition)
set.seed(271)
u &lt;- ghalton(n, d)
pairs(u, gap = 0, pch = ".", labels = as.expression(
      sapply(1:d, function(j) bquote(italic(u[.(j)])))))

## For sobol() examples, see demo(sobol_examples)
</code></pre>

<hr>
<h2 id='test_functions'>Test Functions</h2><span id='topic+sum_of_squares'></span><span id='topic+sobol_g'></span><span id='topic+exceedance'></span>

<h3>Description</h3>

<p>Functions for testing low-discrepancy sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_of_squares(u)
sobol_g(u, copula = copula::indepCopula(dim = ncol(u)), alpha = 1:ncol(u), ...)
exceedance(x, q, p = 0.99, method = c("indicator", "individual.given.sum.exceeds",
                                      "sum.given.sum.exceeds"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_functions_+3A_u">u</code></td>
<td>
<p><code class="reqn">(n, d)</code>-matrix containing <code class="reqn">n</code>
<code class="reqn">d</code>-dimensional realizations (of a potential quasi-random number
generator). For <code>sum_of_squares()</code> these need to be marginally
standard uniform and for <code>sobol_g()</code> they need to follow the
copula specified by <code>copula</code>.</p>
</td></tr>
<tr><td><code id="test_functions_+3A_copula">copula</code></td>
<td>
<p><code><a href="copula.html#topic+Copula">Copula</a></code> object for which the inverse
Rosenblatt transformation exists.</p>
</td></tr>
<tr><td><code id="test_functions_+3A_alpha">alpha</code></td>
<td>
<p>vector of parameters of Sobol's g test function.</p>
</td></tr>
<tr><td><code id="test_functions_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the underlying
<code><a href="copula.html#topic+cCopula">cCopula</a>()</code>.</p>
</td></tr>
<tr><td><code id="test_functions_+3A_x">x</code></td>
<td>
<p><code class="reqn">(n, d)</code>-matrix containing <code class="reqn">n</code> <code class="reqn">d</code>-dimensional
realizations.</p>
</td></tr>
<tr><td><code id="test_functions_+3A_q">q</code></td>
<td>


<dl>
<dt>&quot;indicator&quot;</dt><dd><p><code class="reqn">d</code>-vector containing the componentwise
thresholds; if a number it is recycled to a <code class="reqn">d</code>-vector.</p>
</dd>
<dt>&quot;individual.given.sum.exceeds&quot;, &quot;sum.given.sum.exceeds&quot;</dt><dd>
<p>threshold for the sum (row sums of <code>x</code>).</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="test_functions_+3A_p">p</code></td>
<td>

<p>If <code>q</code> is not provided, the probability <code>p</code> is used to
determine <code>q</code>.
</p>

<dl>
<dt>&quot;indicator&quot;</dt><dd><p><code class="reqn">d</code>-vector containing the probabilities
determining componentwise thresholds via empirical quantiles;
if a number, it is recycled to a <code class="reqn">d</code>-vector.</p>
</dd>
<dt>&quot;individual.given.sum.exceeds&quot;, &quot;sum.given.sum.exceeds&quot;</dt><dd>
<p>probability determining the threshold for the sum (row sums of
<code>x</code>) via the corresponding empirical quantile.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="test_functions_+3A_method">method</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> string indicating the type of
exceedance computed (see Section Value below).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For examples see the demo <code>man_test_functions</code>.
</p>
<p>See <code>ES_np(&lt;matrix&gt;)</code> from <span class="pkg">qrmtools</span> for another test function.
</p>


<h3>Value</h3>

<p><code>sum_of_squares()</code> returns an <code class="reqn">n</code>-vector
(<code><a href="base.html#topic+numeric">numeric</a>(n)</code>) with the rowwise computed scaled sum
of squares (theoretically integrating to 1).
</p>
<p><code>sobol_g()</code> returns an <code class="reqn">n</code>-vector (<code><a href="base.html#topic+numeric">numeric</a>(n)</code>)
with the rowwise computed Sobol' g functions.
</p>
<p><code>exceedance()</code>'s return value depends on <code>method</code>:
</p>

<dl>
<dt>&quot;indicator&quot;</dt><dd><p>returns indicators whether,
componentwise, <code>x</code> exceeds the threshold determined by <code>q</code>.</p>
</dd>
<dt>&quot;individual.given.sum.exceeds&quot;</dt><dd><p>returns all rows of <code>x</code>
whose sum exceeds the threshold determined by <code>q</code>.</p>
</dd>
<dt>&quot;sum.given.sum.exceeds&quot;</dt><dd><p>returns the row sums of those
rows of <code>x</code> whose sum exceeds the threshold determined by <code>q</code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Marius Hofert and Christiane Lemieux</p>


<h3>References</h3>

<p>Radovic, I., Sobol', I. M. and Tichy, R. F. (1996). Quasi-Monte Carlo
methods for numerical integration: Comparison of different low
discrepancy sequences. <em>Monte Carlo Methods and Applications</em>
<b>2</b>(1), 1&ndash;14.
</p>
<p>Faure, H., Lemieux, C. (2009). Generalized Halton Sequences in 2008:
A Comparative Study. <em>ACM-TOMACS</em> <b>19</b>(4), Article 15.
</p>
<p>Owen, A. B. (2003). The dimension distribution and quadrature test
functions. <em>Stat. Sinica</em> <b>13</b>, 1-–17.
</p>
<p>Sobol', I. M. and Asotsky, D. I. (2003). One more experiment on
estimating high-dimensional integrals by quasi-Monte Carlo methods.
<em>Math. Comput. Simul.</em> <b>62</b>, 255–-263.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate some (here: copula, pseudo-random) data
library(copula)
set.seed(271)
cop &lt;- claytonCopula(iTau(claytonCopula(), tau = 0.5)) # Clayton copula
U &lt;- rCopula(1000, copula = cop)

## Compute sum of squares test function
mean(sum_of_squares(U)) # estimate of E(3(sum_{j=1}^d U_j^2)/d)

## Compute the Sobol' g test function
if(packageVersion("copula") &gt;= "0.999-20")
    mean(sobol_g(U)) # estimate of E(&lt;Sobol's g function&gt;)

## Compute an exceedance probability
X &lt;- qnorm(U)
mean(exceedance(X, q = qnorm(0.99))) # fixed threshold q
mean(exceedance(X, p = 0.99)) # empirically estimated marginal p-quantiles as thresholds

## Compute 99% expected shortfall for the sum
mean(exceedance(X, p = 0.99, method = "sum.given.sum.exceeds"))
## Or use ES_np(X, level = 0.99) from 'qrmtools'
</code></pre>

<hr>
<h2 id='to_array'>Compute Matrices to Arrays</h2><span id='topic+to_array'></span>

<h3>Description</h3>

<p>Converting higher-dimensional matrices of quasi-random numbers to
arrays of specific formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_array(x, f, format = c("(n*f,d)", "(n,f,d)"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_array_+3A_x">x</code></td>
<td>
<p>(<code class="reqn">n</code>,<code class="reqn">f</code><code class="reqn">d</code>)-matrix of quasi-random numbers to
be converted.</p>
</td></tr>
<tr><td><code id="to_array_+3A_f">f</code></td>
<td>
<p>factor <code class="reqn">f\ge 1</code> dividing <code>ncol{x}</code>.</p>
</td></tr>
<tr><td><code id="to_array_+3A_format">format</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> string indicating the output format
to which <code>x</code> should be converted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>to_array()</code> is helpful for converting quasi-random numbers
to time series paths.
</p>


<h3>Value</h3>

<p><code>(n * f, d)-<a href="base.html#topic+matrix">matrix</a></code> or <code>(n, f, d)-<a href="base.html#topic+array">array</a></code>
depending on the chosen <code>format</code>.
</p>


<h3>Author(s)</h3>

<p>Marius Hofert</p>


<h3>See Also</h3>

<p><code><a href="#topic+korobov">korobov</a>()</code>, <code><a href="#topic+ghalton">ghalton</a>()</code>, <code><a href="#topic+sobol">sobol</a>()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Basic call
N &lt;- 4 # replications
n &lt;- 3 # time steps
d &lt;- 2 # dimension
set.seed(271) # note: respected for the choice of 'randomize'
x &lt;- sobol(N, d = n * d, randomize = "digital.shift") # higher-dim. Sobol'
stopifnot(dim(to_array(x, f = n)) == c(N * n, d)) # conversion and check
stopifnot(dim(to_array(x, f = n, format = "(n,f,d)")) == c(N, n, d))

## See how the conversion is done
(x &lt;- matrix(1:(N * n * d), nrow = N, byrow = TRUE))
to_array(x, f = n) # =&gt; (n * d)-column x was blocked in n groups of size d each
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
