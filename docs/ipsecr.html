<!DOCTYPE html><html lang="en"><head><title>Help for package ipsecr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ipsecr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ipsecr-package'><p>Spatially Explicit Capture&ndash;Recapture by Inverse Prediction</p></a></li>
<li><a href='#details'><p> Detail Specification for ipsecr.fit</p></a></li>
<li><a href='#Internal'><p>Internal Functions</p></a></li>
<li><a href='#ipsecr-defunct'><p>Defunct Functions in Package <span class="pkg">ipsecr</span></p></a></li>
<li><a href='#ipsecr-deprecated'><p>Deprecated Functions in Package <span class="pkg">ipsecr</span></p></a></li>
<li><a href='#ipsecr.fit'>
<p>Spatially Explicit Capture&ndash;Recapture by Inverse Prediction</p>
</p></a></li>
<li><a href='#ipsecrdemo'><p> SECR Model Fitted to Demonstration Data</p></a></li>
<li><a href='#makeNewData'>
<p>Create Default Design Data</p>
</p></a></li>
<li><a href='#plot.ipsecr'><p> Plot Detection Functions</p></a></li>
<li><a href='#plot3D.IP'>
<p>Plot design and saved simulations for one box from a model fitted with <code>ipsecr.fit</code></p>
</p></a></li>
<li><a href='#plotProxy'>
<p>Simulate and plot the relationship between a parameter and its designated proxy</p>
</p></a></li>
<li><a href='#predict.ipsecr'><p> SECR Model Predictions</p></a></li>
<li><a href='#print.ipsecr'><p> Print or Summarise ipsecr Object</p></a></li>
<li><a href='#vcov.ipsecr'><p> Variance - Covariance Matrix of SECR Parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatially Explicit Capture-Recapture by Inverse Prediction</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-23</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates the density of a spatially distributed animal population 
  sampled with an array of passive detectors, such as traps. Models incorporating 
  distance-dependent detection are fitted by simulation and inverse prediction 
  as proposed by Efford (2004) &lt;<a href="https://doi.org/10.1111%2Fj.0030-1299.2004.13043.x">doi:10.1111/j.0030-1299.2004.13043.x</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), secr (&ge; 4.5.8)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, MASS, nlme, parallel, Rcpp (&ge; 1.0.8.3),
stats, stringr, tools, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>FrF2, knitr, plot3D , rmarkdown, sf, spatstat, testthat (&ge;
0.11.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MurrayEfford/ipsecr/">https://github.com/MurrayEfford/ipsecr/</a>,
<a href="https://www.otago.ac.nz/density/">https://www.otago.ac.nz/density/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-23 06:59:06 UTC; murra</td>
</tr>
<tr>
<td>Author:</td>
<td>Murray Efford <a href="https://orcid.org/0000-0001-5231-5184"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Murray Efford &lt;murray.efford@otago.ac.nz&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-24 10:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ipsecr-package'>Spatially Explicit Capture&ndash;Recapture by Inverse Prediction </h2><span id='topic+ipsecr-package'></span><span id='topic+ipsecr'></span>

<h3>Description</h3>

<p>Functions to estimate the density of a spatially
distributed animal population sampled with an array of passive
detectors, such as traps. <span class="pkg">ipsecr</span> addresses &lsquo;difficult&rsquo; models that 
strictly cannot be fitted by maximum likelihood in the package 
<span class="pkg">secr</span> (Efford 2022). The classic example concerns discrete-time data
from single-catch traps.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> ipsecr</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.4.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2025-01-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GNU General Public License Version 2 or later</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Spatially explicit capture&ndash;recapture is a set of methods for studying
marked animals distributed in space. Data comprise the locations of
detectors (described in an object of class &lsquo;traps&rsquo;), and the 
detection histories of individually marked
animals. Individual histories are stored in an object of class
&lsquo;capthist&rsquo; that includes the relevant &lsquo;traps&rsquo; object.
</p>
<p>Models for population density (animals per hectare) and detection are defined 
in <span class="pkg">ipsecr</span> using symbolic formula notation. The set of possible models 
overlaps with <span class="pkg">secr</span> (some models for varying detection parameters are 
excluded, e.g., ~t, ~b). Density models may include spatial trend. Habitat 
is distinguished from nonhabitat with an object of class &lsquo;mask&rsquo;.
</p>
<p>Models are fitted in <span class="pkg">ipsecr</span> by simulation and inverse prediction 
(Efford 2004, 2023). A model fitted with <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code> is an object
of class <code>ipsecr</code>. Generic methods (plot, print, summary, etc.) are
provided.
</p>
<p>A link at the bottom of each help page takes you to the
help index. The vignette includes worked examples.
</p>
<p>The analyses in <span class="pkg">ipsecr</span> extend those available in the software
Density (see
<a href="https://www.otago.ac.nz/density/">www.otago.ac.nz/density/</a>
for the most recent version of Density).  Help is available on the
&lsquo;DENSITY | secr&rsquo; forum at
<a href="http://www.phidot.org/forum/">www.phidot.org</a> and
the Google group <a href="https://groups.google.com/forum/#!forum/secrgroup">secrgroup</a>. Feedback
on the software is also welcome, including suggestions for additional
documentation or new features consistent with the overall design.
</p>
<p>&lsquo;Inverse prediction&rsquo; uses methods from multivariate calibration (Brown
1982). The goal is to estimate population density (D) and the parameters
of a detection function (usually g0 or lambda0 and sigma) by &lsquo;matching&rsquo; statistics
from <code>proxyfn(capthist)</code> (the target vector) to statistics
from simulations of a 2-D population using the postulated detection
model. Statistics (see Note) are defined by the proxy function,
which should return a vector equal in length to the number of parameters
(default np = 3). Simulations of the 2-D population use either internal C++ code or <code><a href="secr.html#topic+sim.popn">sim.popn</a></code>. The simulated 2-D distribution of animals is Poisson by default.
</p>
<p>The simulated population is sampled with internal C++ code, <code><a href="secr.html#topic+sim.capthist">sim.capthist</a></code>, or a user-specified function. Simulations match the detector type (e.g., &lsquo;single&rsquo; or &lsquo;multi&rsquo;) and detector layout specified in traps(capthist), including allowance for varying effort if the layout has a <code><a href="secr.html#topic+usage">usage</a></code> attribute.
</p>
<p>Simulations are usually conducted on a factorial experimental design in
parameter space - i.e. at the vertices of a cuboid &lsquo;box&rsquo; centred on the
working values of the parameters, plus an optional number of centre
points. 
</p>
<p>A multivariate linear model is fitted to predict each vector of simulated
proxies from the known parameter values. Simulations are performed at each design point until a specified precision is reached, up to a user-specified maximum number.
</p>
<p>Once a model with sufficient precision has been obtained, a new working
vector of parameter estimates is &lsquo;predicted&rsquo; by inverting the linear
model and applying it to the target vector. A working vector
is accepted as the final estimate when it lies within the box; this
reduces the bias from using a linear approximation to extrapolate a
nonlinear function. If the working vector lies outside the box then a new
design is centred on value for each parameter in the working vector.
</p>
<p>Once a final estimate is accepted, further simulations are conducted to
estimate the variance-covariance matrix. These also provide a parametric
bootstrap sample to evaluate possible bias. 
</p>
<p>See Efford et al. (2004) for an early description of the method, and
Efford et al. (2005) for an application.
</p>
<p>If not provided, the starting values are determined automatically
with the **secr** function <code><a href="secr.html#topic+makeStart">makeStart</a></code>.
</p>
<p>Linear measurements are assumed to be in metres and density in animals
per hectare (10 000 <code class="reqn">\mbox{m}^2</code>).
</p>
<p>If <code>ncores &gt; 1</code> the <span class="pkg">parallel</span> package is used to create
worker processes on multiple cores (see <a href="secr.html#topic+Parallel">Parallel</a> for more). 
</p>


<h3>Author(s)</h3>

<p> Murray Efford <a href="mailto:murray.efford@otago.ac.nz">murray.efford@otago.ac.nz</a> </p>


<h3>References</h3>

<p>Brown, P. J. (1982) Multivariate calibration. <em>Journal of the Royal
Statistical Society, Series B</em> <b>44</b>, 287&ndash;321.
</p>
<p>Efford, M. G. (2004) Density estimation in live-trapping studies.
<em>Oikos</em> <b>106</b>, 598&ndash;610.
</p>
<p>Efford, M. G. (2022) secr: Spatially explicit capture&ndash;recapture models. 
R package version 4.5.8. https://CRAN.R-project.org/package=secr/
</p>
<p>Efford, M. G. (2023) ipsecr: An R package for awkward spatial capture&ndash;recapture data. 
<em>Methods in Ecology and Evolution</em> <b>14</b>, 1182&ndash;1189.
</p>
<p>Efford, M. G., Borchers D. L. and Byrom, A. E. (2009) Density estimation
by spatially explicit capture&ndash;recapture: likelihood-based methods. In:
D. L. Thompson, E. G. Cooch and M. J. Conroy (eds) <em>Modeling
Demographic Processes in Marked Populations</em>. Springer. Pp. 255&ndash;269.
</p>
<p>Efford, M. G., Dawson, D. K. and Robbins C. S. (2004) DENSITY: software
for analysing capture-recapture data from passive detector arrays.
<em>Animal Biodiversity and Conservation</em> <b>27</b>,
217&ndash;228.
</p>
<p>Efford, M. G., Warburton, B., Coleman, M. C. and Barker, R. J. (2005) A
field test of two methods for density estimation. <em>Wildlife Society
Bulletin</em> <b>33</b>, 731&ndash;738.
</p>
<p>Otis, D. L., Burnham, K. P., White, G. C. and Anderson, D. R. (1978)
Statistical inference from capture data on closed animal populations.
<em>Wildlife Monographs</em> <b>62</b>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+proxy.ms">proxy.ms</a></code>
<code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>,
<code><a href="secr.html#topic+secr.fit">secr.fit</a></code>,
<code><a href="secr.html#topic+capthist">capthist</a></code>,
<code><a href="secr.html#topic+mask">mask</a></code>
</p>

<hr>
<h2 id='details'> Detail Specification for ipsecr.fit </h2><span id='topic+details'></span><span id='topic+fixedbeta'></span><span id='topic+param'></span>

<h3>Description</h3>

<p>The function <code>ipsecr.fit</code> allows many options. Some of these are used
infrequently and have been bundled as a single argument <code>details</code>
to simplify the documentation. They are described here in two groups: 
tuning parameters are listed in the following table, and more exotic options 
follow, listed alphabetically.
</p>


<h3>Tuning parameters</h3>


<table>
<tr>
 <td style="text-align: left;">
Parameter </td><td style="text-align: left;"> Default </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
boxsize1 </td><td style="text-align: left;"> 0.2 </td><td style="text-align: left;">  scalar or vector of length np for size of design </td>
</tr>
<tr>
 <td style="text-align: left;">
boxsize2 </td><td style="text-align: left;"> 0.05 </td><td style="text-align: left;">  as for <code>boxsize1</code>; used from second box onwards </td>
</tr>
<tr>
 <td style="text-align: left;">
centre </td><td style="text-align: left;"> 3 </td><td style="text-align: left;">    number of centre points in simulation design </td>
</tr>
<tr>
 <td style="text-align: left;">
min.nsim </td><td style="text-align: left;"> 20 </td><td style="text-align: left;">  minimum number of simulations per point  </td>
</tr>
<tr>
 <td style="text-align: left;">
max.nsim </td><td style="text-align: left;"> 200 </td><td style="text-align: left;">  maximum number of simulations per point  </td>
</tr>
<tr>
 <td style="text-align: left;">
dev.max </td><td style="text-align: left;"> 0.002 </td><td style="text-align: left;">   tolerance for precision of points in proxy space  (see below) </td>
</tr>
<tr>
 <td style="text-align: left;">
var.nsim </td><td style="text-align: left;"> 2000 </td><td style="text-align: left;">  number of additional simulations to estimate variance-covariance matrix  </td>
</tr>
<tr>
 <td style="text-align: left;">
min.nbox </td><td style="text-align: left;"> 2 </td><td style="text-align: left;">  minimum number of attempts to `frame' solution  </td>
</tr>
<tr>
 <td style="text-align: left;">
max.nbox </td><td style="text-align: left;"> 5 </td><td style="text-align: left;">  maximum number of attempts to `frame' solution  </td>
</tr>
<tr>
 <td style="text-align: left;">
max.ntries </td><td style="text-align: left;"> 2 </td><td style="text-align: left;">  maximum number of attempts at each simulation  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><code>dev.max</code> defines a stopping rule: simulations are added in blocks of 
details$min.nsim until a measure of precision is less than dev.max for all proxies. 
If a vector of length 2, the first element applies to the first box and the second to all later boxes. The measure of precision may be the standard error on the link scale (details$boxtype = &quot;absolute&quot;) or the coefficient of variation (details$boxtype = &quot;relative&quot;).
</p>


<h3>Other &lsquo;details&rsquo; components</h3>

<p><code>binomN</code> (default 0 = Poisson) integer code for distribution of counts.
</p>
<p><code>boxtype</code> (default &quot;absolute&quot;) switches between specifying box size as additive on the transformed parameter scale (&quot;absolute&quot;) and relative on the transformed parameter scale (&quot;relative&quot;).
</p>
<p><code>CHmethod</code> (default &quot;internal&quot;) chooses between internal C++ code, the <span class="pkg">secr</span> function <code>sim.capthist</code>, and a user-provided R function with arguments &quot;traps&quot;, &quot;popn&quot;, &quot;detectfn&quot;, &quot;detectpar&quot;, and &quot;noccasions&quot;. See also popmethod.
</p>
<p><code>contrasts</code> (default NULL) bmay be used to specify the coding of factor predictors. The value should be suitable for the 'contrasts.arg' argument of <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>. See &lsquo;Trend across sessions&rsquo; in <a href="https://www.otago.ac.nz/density/pdfs/secr-multisession.pdf">secr-multisession.pdf</a> for an example.
</p>
<p><code>debug</code> (default FALSE) is used only for debugging. In ordinary use it should not be 
changed from the default.
</p>
<p><code>distribution</code> (default &quot;poisson&quot;) specifies the distribution of the number of
individuals detected <code class="reqn">n</code>; this may be conditional on the number in the
masked area (&quot;binomial&quot;) or unconditional (&quot;poisson&quot;).
<code>distribution</code> affects the sampling variance of the estimated
density. The component &lsquo;distribution&rsquo; may also
take a numeric value larger than nrow(capthist), rather than &quot;binomial&quot;
or &quot;poisson&quot;. 
</p>
<p><code>extraparam</code> is a list of starting values for extra 'real' parameters that may be needed for some user-specified models. See the vignette for explanation and an example.
</p>
<p><code>factorial</code> (default &quot;full&quot;) chooses between &quot;full&quot; or &quot;fractional&quot; design. Fractional requires the package **FrF2** (Groemping 2014).
</p>
<p><code>forkonunix</code> (default TRUE) switches the cluster type generated by <code><a href="parallel.html#topic+makeCluster">makeCluster</a></code> between FORK and PSOCK.
</p>
<p><code>FrF2args</code> (default NULL) provides a list of arguments defining a fractional design.
</p>
<p><code>ignorenontarget</code> (default FALSE) may be used to ignore
non-target information (the capthist attribute 'nontarget'). The default is to model non-target information if it is present.
</p>
<p><code>ignoreusage</code> (default FALSE) may be used to ignore usage (varying effort)
information in the traps component. The default is to include usage in the model.
</p>
<p><code>keep.sim</code> (default FALSE) when TRUE causes <code>ipsecr.fit</code> to save additional output, specifically lists (one component per box) of the simulations and parameters for each box, and the final variance simulations.
</p>
<p><code>newdetector</code> (default NULL) may be used to override the detector type of 
the traps object embedded in the capthist passed to <code>ipsecr.fit</code>.
</p>
<p><code>Nmax</code> (default 1e4) maximum allowed population size for simulations.
</p>
<p><code>nontargettype</code> (default &quot;exclusive&quot;) chooses among options &quot;exclusive&quot;, &quot;truncated&quot;, &quot;erased, &quot;independent&quot;, and &quot;dependent&quot;. See vignette.
</p>
<p><code>popmethod</code> (default &quot;internal&quot;) chooses between internal C++ code, the <span class="pkg">secr</span> function <code>sim.popn</code>, and a user-provided R function with arguments 'mask', 'D' (density per cell of mask) and 'N' (number of individuals to simulate). See also CHmethod.
</p>
<p><code>savecall</code> (default TRUE) determines whether the function call is included in the output.
</p>
<p><code>YonX</code> (default TRUE) switches between regression of simulated proxy values Y on controlled parameter values X, or the reverse (which is not fully implemented). 
</p>


<h3>References</h3>

<p>Groemping, U. (2014). R Package FrF2 for Creating and Analyzing Fractional Factorial 2-Level Designs. <em>Journal of Statistical Software</em>, <b>56</b>, 1&ndash;56. 
https://www.jstatsoft.org/article/view/v056i01.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ipsecr.fit">ipsecr.fit</a> </code>
</p>

<hr>
<h2 id='Internal'>Internal Functions</h2><span id='topic+proxyfn1'></span><span id='topic+proxy.ms'></span><span id='topic+detectionDesignData'></span><span id='topic+simpop'></span><span id='topic+simCH'></span><span id='topic+rpsv'></span><span id='topic+rpsvi'></span>

<h3>Description</h3>

 
<p>Functions called internally by <span class="pkg">ipsecr</span>. 
These are exported and may be called separately for testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
proxy.ms(capthist, model = NULL, trapdesigndata = NULL, ...)

detectionDesignData(capthist, byoccasion = FALSE, ...)

proxyfn1(capthist, N.estimator =  c("n", "null","zippin","jackknife"), ...)

simpop(mask, D, N, details = list(), ...)

simCH(traps, popn, detectfn, detparmat, noccasions, NT = NULL, details = 
    list(), ...)
      
rpsv(capthist)
rpsvi(capthist)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Internal_+3A_capthist">capthist</code></td>
<td>
<p>secr capthist object</p>
</td></tr>
<tr><td><code id="Internal_+3A_model">model</code></td>
<td>
<p>named list of model formulae (see <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>)</p>
</td></tr>
<tr><td><code id="Internal_+3A_trapdesigndata">trapdesigndata</code></td>
<td>
<p>dataframe with one row for each detector and session</p>
</td></tr>
<tr><td><code id="Internal_+3A_...">...</code></td>
<td>
<p>other arguments, mostly unused</p>
</td></tr>
<tr><td><code id="Internal_+3A_byoccasion">byoccasion</code></td>
<td>
<p>logical; if TRUE the output rows are repeated for each occasion </p>
</td></tr>
<tr><td><code id="Internal_+3A_n.estimator">N.estimator</code></td>
<td>
<p>character name of closed-population estimator</p>
</td></tr>
<tr><td><code id="Internal_+3A_mask">mask</code></td>
<td>
<p> secr mask object</p>
</td></tr>
<tr><td><code id="Internal_+3A_d">D</code></td>
<td>
<p>numeric density in each mask cell</p>
</td></tr>
<tr><td><code id="Internal_+3A_n">N</code></td>
<td>
<p>integer number of animals to simulate</p>
</td></tr>
<tr><td><code id="Internal_+3A_traps">traps</code></td>
<td>
<p>detector locations as <span class="pkg">secr</span> traps object</p>
</td></tr>
<tr><td><code id="Internal_+3A_popn">popn</code></td>
<td>
<p>animal locations as <span class="pkg">secr</span> popn object</p>
</td></tr>
<tr><td><code id="Internal_+3A_detectfn">detectfn</code></td>
<td>
<p>integer code for detection function (see <a href="secr.html#topic+detectfn">detectfn</a>)</p>
</td></tr>
<tr><td><code id="Internal_+3A_detparmat">detparmat</code></td>
<td>
<p>numeric matrix of detection parameter values</p>
</td></tr>
<tr><td><code id="Internal_+3A_noccasions">noccasions</code></td>
<td>
<p>integer number of sampling occasions</p>
</td></tr>
<tr><td><code id="Internal_+3A_nt">NT</code></td>
<td>
<p>numeric hazard of non-target interference at each detector</p>
</td></tr>
<tr><td><code id="Internal_+3A_details">details</code></td>
<td>
<p>list with optional additional named arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>proxy.ms</code> is the default proxyfn used by <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>. When used internally by <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>, &lsquo;model&rsquo; and &lsquo;trapdesigndata&rsquo; are passed automatically. The ... argument of <code>proxy.ms</code> may be used to pass arguments to <code><a href="secr.html#topic+addCovariates">addCovariates</a></code>, especially &lsquo;spatialdata&rsquo;. Function <code>detectionDesignData</code> is used internally to construct design data for non-constant detection models (lambda0, sigma), used in the glm 'data' argument. The capthist argument for <code>detectionDesignData</code> should always be a list (wrap a single-session capthist in list()).
</p>
<p><code>simpop</code> is used by <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code> for popmethod 'internal'. It is faster and simpler than the <span class="pkg">secr</span> function <code><a href="secr.html#topic+sim.popn">sim.popn</a></code>. The details component 'distribution' is a character value that may be &lsquo;poisson&rsquo; (default) or 'even.
</p>
<p><code>simCH</code> is used by <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code> for CHmethod 'internal'. It is faster and simpler than the <span class="pkg">secr</span> function <code><a href="secr.html#topic+sim.capthist">sim.capthist</a></code>, and optionally simulates non-target interference. The argument <code>detparmat</code> is an individual x parameter matrix, with parameters in the order usual for <code>detectfn</code>.
</p>
<p><code>D</code> and <code>NT</code> are matrices with one column per session. 
</p>
<p><code>proxyfn1</code> is a simple proxy function included mostly for historical reasons. It updates the function of Efford (2004) by log-transforming N, using a complementary log-log transformation instead of odds for p, and using log(RPSV(capthist)) for sigma. If you're interested, look at the code.
</p>
<p><code>rpsv(capthist)</code> is equivalent to <span class="pkg">secr</span> RPSV(capthist, CC = TRUE). <code>rpsvi(capthist)</code> returns a vector of individual-specific rpsv.
</p>


<h3>Value</h3>

<p>proxy.ms &ndash; a numeric vector of length &gt;= 3 corresponding to proxies for a wide range of models, 
including multi-session density and non-target interference models.
</p>
<p>detectionDesignData &ndash; a dataframe with one row per individual per session (byoccasion = FALSE) or one row per individual per occasion per session (byoccasion = TRUE), ordered by session, occasion and individual. Columns include x and y coordinates of the individual's centroid, session, and any individual covariates.
</p>
<p>proxyfn1 &ndash; a numeric vector of length 3 corresponding to proxies for 
population size, capture probability intercept and scale of detection.
</p>
<p>simpop &ndash; a <code><a href="secr.html#topic+popn">popn</a></code> object.
</p>
<p>simCH &ndash; a single-session <code><a href="secr.html#topic+capthist">capthist</a></code> object. 
</p>
<p>rpsv &ndash; scalar
</p>
<p>rpsvi &ndash; vector, one element per animal
</p>


<h3>Note</h3>

<p><code>proxyfn0</code> was removed in version 1.2.0.
</p>


<h3>References</h3>

<p>Efford, M. G. (2004) Density estimation in live-trapping studies. <em>Oikos</em> <b>106</b>, 598&ndash;610.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>, 
<code><a href="#topic+plotProxy">plotProxy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
proxy.ms(captdata)

</code></pre>

<hr>
<h2 id='ipsecr-defunct'>Defunct Functions in Package <span class="pkg">ipsecr</span></h2><span id='topic+ipsecr-defunct'></span><span id='topic+proxyfn0'></span>

<h3>Description</h3>

<p>These functions are no longer available in <span class="pkg">ipsecr</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
# Defunct in 1.2.0 (2022-08)

proxyfn0()

</code></pre>


<h3>Details</h3>

<p>proxyfn0 was removed without warning in ipsecr 1.2.0. 
Use <code><a href="#topic+proxyfn1">proxyfn1</a></code> or <code><a href="#topic+proxy.ms">proxy.ms</a></code>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ipsecr-deprecated">ipsecr-deprecated</a></code>
</p>

<hr>
<h2 id='ipsecr-deprecated'>Deprecated Functions in Package <span class="pkg">ipsecr</span></h2><span id='topic+ipsecr-deprecated'></span>

<h3>Description</h3>

<p>These functions will be removed from future versions of <span class="pkg">ipsecr</span>.
</p>


<h3>Details</h3>

<p>No functions are deprecated at this point.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ipsecr-defunct">ipsecr-defunct</a></code>, 
</p>

<hr>
<h2 id='ipsecr.fit'>
Spatially Explicit Capture&ndash;Recapture by Inverse Prediction
</h2><span id='topic+ipsecr.fit'></span>

<h3>Description</h3>

<p>Estimate population density by simulation and inverse prediction (Efford 2004; Efford,
Dawson &amp; Robbins 2004). A restricted range of SECR models may be fitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
ipsecr.fit(capthist, proxyfn = proxy.ms, model = list(D ~ 1, g0 ~ 1, sigma ~ 1),
    mask = NULL, buffer = 100, detectfn = "HN", binomN = NULL, start = NULL, 
    link = list(), fixed = list(), timecov = NULL, sessioncov = NULL, 
    details = list(), verify = TRUE, verbose = TRUE, ncores = NULL, 
    seed = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ipsecr.fit_+3A_capthist">capthist</code></td>
<td>
<p>secr capthist object including capture data and detector (trap) layout</p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_proxyfn">proxyfn</code></td>
<td>
<p>function to compute proxy from capthist for each coefficient (beta parameter)</p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_model">model</code></td>
<td>
<p>list with optional components each symbolically defining a linear 
predictor for one real parameter using <code>formula</code> notation </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_mask">mask</code></td>
<td>
<p><code><a href="secr.html#topic+mask">mask</a></code> object </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_buffer">buffer</code></td>
<td>
<p>scalar mask buffer radius in metres if <code>mask</code> not specified</p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_detectfn">detectfn</code></td>
<td>
<p>integer code or character string for shape of
detection function 0 = halfnormal, 1 = hazard rate etc. &ndash; see <a href="secr.html#topic+detectfn">detectfn</a></p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_binomn">binomN</code></td>
<td>
<p>integer code for distribution of counts (see Details) </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_start">start</code></td>
<td>
<p>vector of initial values for beta parameters, or <code>ipsecr</code> 
object from which they may be derived </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_link">link</code></td>
<td>
<p>list with optional components corresponding to &lsquo;real&rsquo;
parameters (e.g., &lsquo;D&rsquo;, &lsquo;g0&rsquo;, &lsquo;sigma&rsquo;), each a character string in
{&quot;log&quot;, &quot;logit&quot;, &quot;identity&quot;, &quot;sin&quot;} for the link function of one real parameter </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_fixed">fixed</code></td>
<td>
<p>list with optional components corresponding to real parameters 
giving the scalar value to which the parameter is to be fixed </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_timecov">timecov</code></td>
<td>
<p>optional dataframe of values of time (occasion-specific) covariate(s). NOT USED </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_sessioncov">sessioncov</code></td>
<td>
<p>optional dataframe of values of session-specific covariate(s)</p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_details">details</code></td>
<td>
<p>list of additional settings, to control estimation (see Details) </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_verify">verify</code></td>
<td>
<p>logical, if TRUE the input data are checked with <code><a href="secr.html#topic+verify">verify</a></code> </p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_verbose">verbose</code></td>
<td>
<p> logical, if TRUE then messages are output during execution</p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_ncores">ncores</code></td>
<td>
<p> integer number of cores to use for parallel processing</p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_seed">seed</code></td>
<td>
<p>either NULL or an integer that will be used in a call to <code>set.seed</code></p>
</td></tr>
<tr><td><code id="ipsecr.fit_+3A_...">...</code></td>
<td>
<p> other arguments passed to proxy function </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vignette should be consulted for a full exposition.
</p>


<h4>Parallel computation</h4>

<p><code>ncores</code> determines the number of worker processes in a cluster created by <code><a href="parallel.html#topic+makeCluster">makeCluster</a></code> (default type &quot;FORK&quot; on Unix platforms, otherwise &quot;PSOCK&quot;). If <code>ncores = NULL</code> this defaults to the value from <code><a href="secr.html#topic+setNumThreads">setNumThreads</a></code>. Simulations are distributed over worker processes using <code><a href="parallel.html#topic+parRapply">parRapply</a></code>. There are substantial overheads in running multiple processes: using too many will slow down fitting. With PSOCK clusters (i.e. on Windows) fitting is very often fastest with ncores = 1.
</p>



<h4>The &lsquo;details&rsquo; argument</h4>

<p><code>details</code> is used for various specialized settings listed below. These are 
also described separately - see <code><a href="#topic+details">details</a></code>.
</p>

<table>
<tr>
 <td style="text-align: left;">
  Name </td><td style="text-align: left;"> Default </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
  boxsize1 </td><td style="text-align: left;"> 0.2  </td><td style="text-align: left;"> scalar or vector of length np for size of design</td>
</tr>
<tr>
 <td style="text-align: left;"> 
  boxsize2 </td><td style="text-align: left;"> 0.05  </td><td style="text-align: left;"> as for <code>boxsize1</code>; used from second box onwards</td>
</tr>
<tr>
 <td style="text-align: left;">
  boxtype </td><td style="text-align: left;"> 'absolute' </td><td style="text-align: left;"> `absolute' or `relative' </td>
</tr>
<tr>
 <td style="text-align: left;">
  centre </td><td style="text-align: left;"> 3 </td><td style="text-align: left;"> number of centre points in simulation design</td>
</tr>
<tr>
 <td style="text-align: left;">
  dev.max </td><td style="text-align: left;">  0.002 </td><td style="text-align: left;"> tolerance for precision of points in predictor space </td>
</tr>
<tr>
 <td style="text-align: left;">
  var.nsim </td><td style="text-align: left;"> 2000 </td><td style="text-align: left;"> number of additional simulations to estimate variance-covariance matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
  keep.sim </td><td style="text-align: left;"> FALSE </td><td style="text-align: left;"> if true then the variance simulations are saved </td>
</tr>
<tr>
 <td style="text-align: left;">
  min.nsim </td><td style="text-align: left;"> 20 </td><td style="text-align: left;"> minimum number of simulations per point </td>
</tr>
<tr>
 <td style="text-align: left;">
  max.nsim </td><td style="text-align: left;"> 200 </td><td style="text-align: left;"> maximum number of simulations per point </td>
</tr>
<tr>
 <td style="text-align: left;">
  min.nbox </td><td style="text-align: left;"> 2 </td><td style="text-align: left;"> minimum number of attempts to `frame' solution </td>
</tr>
<tr>
 <td style="text-align: left;">
  max.nbox </td><td style="text-align: left;"> 5 </td><td style="text-align: left;"> maximum number of attempts to `frame' solution </td>
</tr>
<tr>
 <td style="text-align: left;">
  max.ntries </td><td style="text-align: left;"> 2 </td><td style="text-align: left;"> maximum number of attempts at each simulation </td>
</tr>
<tr>
 <td style="text-align: left;">
  distribution </td><td style="text-align: left;"> `poisson' </td><td style="text-align: left;"> `poisson', `binomial' or `even' </td>
</tr>
<tr>
 <td style="text-align: left;">
  binomN </td><td style="text-align: left;"> 0 </td><td style="text-align: left;"> integer code for distribution of counts (unused) </td>
</tr>
<tr>
 <td style="text-align: left;">
  ignorenontarget </td><td style="text-align: left;"> FALSE </td><td style="text-align: left;"> override nontarget attribute of capthist </td>
</tr>
<tr>
 <td style="text-align: left;">
  ignoreusage </td><td style="text-align: left;"> FALSE </td><td style="text-align: left;"> override usage in traps object of capthist </td>
</tr>
<tr>
 <td style="text-align: left;">
  debug </td><td style="text-align: left;"> FALSE </td><td style="text-align: left;"> stop at arbitrary points in execution (varies) </td>
</tr>
<tr>
 <td style="text-align: left;">
  savecall </td><td style="text-align: left;"> TRUE </td><td style="text-align: left;"> optionally suppress saving of call </td>
</tr>
<tr>
 <td style="text-align: left;">
  newdetector </td><td style="text-align: left;"> NULL </td><td style="text-align: left;"> detector type that overrides detector(traps(capthist)) </td>
</tr>
<tr>
 <td style="text-align: left;">
  contrasts </td><td style="text-align: left;"> NULL </td><td style="text-align: left;"> coding of factor predictors </td>
</tr>
<tr>
 <td style="text-align: left;">
  popmethod </td><td style="text-align: left;"> `internal' </td><td style="text-align: left;"> `internal' or `sim.popn' or a user-provided function </td>
</tr>
<tr>
 <td style="text-align: left;">
  CHmethod </td><td style="text-align: left;"> `internal' </td><td style="text-align: left;"> `internal' or `sim.capthist' or a user-provided function </td>
</tr>
<tr>
 <td style="text-align: left;">
  factorial </td><td style="text-align: left;"> `full' </td><td style="text-align: left;"> `full' or `fractional' design </td>
</tr>
<tr>
 <td style="text-align: left;">
  FrF2args </td><td style="text-align: left;"> NULL </td><td style="text-align: left;"> arguments for FrF2 when factorial = 'fractional' </td>
</tr>
<tr>
 <td style="text-align: left;">
  extraparam </td><td style="text-align: left;"> NULL </td><td style="text-align: left;"> list of starting values for extra parameters (see vignette) </td>
</tr>
<tr>
 <td style="text-align: left;">
  forkonunix </td><td style="text-align: left;"> TRUE </td><td style="text-align: left;"> logical choice between FORK and PSOCK cluster types (not Windows) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>




<h3>Value</h3>

<p>An object of class 'ipsecr', a list comprising:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p> the function call (if details$savecall)</p>
</td></tr>
<tr><td><code>capthist</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>proxyfn</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>input</p>
</td></tr> 
<tr><td><code>mask</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>detectfn</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>fixed</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>timecov</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>sessioncov</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>details</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code>designD</code></td>
<td>
<p>list of design data for density</p>
</td></tr>
<tr><td><code>trapdesigndata</code></td>
<td>
<p>list of design data for trap-specific models</p>
</td></tr>
<tr><td><code>parindx</code></td>
<td>
<p>mapping of coefficients (beta parameters) to real parameters</p>
</td></tr>
<tr><td><code>vars</code></td>
<td>
<p>names of covariates in model</p>
</td></tr>
<tr><td><code>betanames</code></td>
<td>
<p>names of coefficients</p>
</td></tr>
<tr><td><code>realnames</code></td>
<td>
<p>names of 'real' parameters</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>integer completion code: 
1 successful, 
2 target not within final box, 
3 exceeded maximum simulations</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>estimates of coefficients on link scale </p>
</td></tr>
<tr><td><code>beta.vcov</code></td>
<td>
<p>variance-covariance matrix of estimates </p>
</td></tr>
<tr><td><code>designbeta</code></td>
<td>
<p>vertices of final box (design points)</p>
</td></tr>
<tr><td><code>sim.lm</code></td>
<td>
<p>last lm model fit</p>
</td></tr>
<tr><td><code>ip.nsim</code></td>
<td>
<p>total number of simulations </p>
</td></tr>
<tr><td><code>var.nsim.OK</code></td>
<td>
<p>number of successful variance simulations</p>
</td></tr>
<tr><td><code>simulations</code></td>
<td>
<p> optional simulation output (see details$keep.sim)</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p> optional simulation input (see details$keep.sim)</p>
</td></tr>
<tr><td><code>variance.bootstrap</code></td>
<td>
<p> dataframe summarising simulations for variance estimation </p>
</td></tr>
<tr><td><code>version</code></td>
<td>
<p>package version</p>
</td></tr>
<tr><td><code>starttime</code></td>
<td>
<p>time execution started</p>
</td></tr>
<tr><td><code>proctime</code></td>
<td>
<p> processor time (seconds) </p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p> RNG state </p>
</td></tr>
</table>
<p>(The order and composition of the output list may change).
</p>


<h3>References</h3>

<p>Efford, M. G. (2004) Density estimation in live-trapping studies.
<em>Oikos</em> <b>106</b>, 598&ndash;610.
</p>
<p>Efford, M. G., Dawson, D. K. and Robbins C. S. (2004) DENSITY: software
for analysing capture-recapture data from passive detector arrays.
<em>Animal Biodiversity and Conservation</em> <b>27</b>,
217&ndash;228.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+proxy.ms">proxy.ms</a></code>, 
<code><a href="#topic+predict.ipsecr">predict.ipsecr</a></code>, 
<code><a href="#topic+summary.ipsecr">summary.ipsecr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


ipsecrdemo &lt;- ipsecr.fit(captdata, ncores = 1, buffer = 100, detectfn = 14, seed = 1237)



</code></pre>

<hr>
<h2 id='ipsecrdemo'> SECR Model Fitted to Demonstration Data </h2><span id='topic+ipsecrdemo'></span>

<h3>Description</h3>

<p>Demonstration data from program Density are provided as a 
<code>capthist</code> object (<code>captdata</code>) ready for input to <code>ipsecr.fit</code>.
</p>
<p>The fitted models are objects of class <code>ipsecr</code> formed by 
</p>
<p><code>ipsecrdemo &lt;- ipsecr.fit(captdata, ncores = 1, detectfn = 'HHN', 
  seed = 1237, details = list(keep.sim = TRUE))</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ipsecrdemo)</code></pre>


<h3>Details</h3>

<p>The raw data are 235 fictional captures of 76 animals over 5 occasions
in 100 single-catch traps 30 metres apart on a square grid with origin
at (365,365).
</p>
<p>The fitted model uses a hazard halfnormal detection function and default values 
of other arguments.
</p>

<table>
<tr>
 <td style="text-align: left;">
  Object </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
  ipsecrdemo </td><td style="text-align: left;"> fitted ipsecr model -- null </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Efford, M. G. (2012) <em>DENSITY 5.0: software for spatially explicit
capture&ndash;recapture</em>. Department of Mathematics and Statistics,
University of Otago, Dunedin, New Zealand. <a href="https://www.otago.ac.nz/density/">https://www.otago.ac.nz/density/</a>.
</p>


<h3>See Also</h3>

 <p><code><a href="secr.html#topic+capthist">capthist</a></code>, <code><a href="secr.html#topic+read.capthist">read.capthist</a></code>, <code><a href="secr.html#topic+secrdemo">secrdemo</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
predict(ipsecrdemo)

</code></pre>

<hr>
<h2 id='makeNewData'>
Create Default Design Data
</h2><span id='topic+newdata'></span><span id='topic+makeNewData.ipsecr'></span>

<h3>Description</h3>

<p>Internal function used to generate a dataframe containing design data
for the base levels of all predictors in an secr object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipsecr'
makeNewData(object, all.levels = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeNewData_+3A_object">object</code></td>
<td>
<p>fitted ipsecr model object</p>
</td></tr>
<tr><td><code id="makeNewData_+3A_all.levels">all.levels</code></td>
<td>
<p>logical; if TRUE then all levels of factors are included</p>
</td></tr>
<tr><td><code id="makeNewData_+3A_...">...</code></td>
<td>
<p>other arguments (not used)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>makeNewData</code> is used by <code>predict</code> in lieu of
user-specified &lsquo;newdata&rsquo;. There is seldom any need to call the function 
<code>makeNewData</code> directly.
</p>


<h3>Value</h3>

<p>A dataframe with one row for each session and group, and columns for the
predictors used by <code>object$model</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.ipsecr">predict.ipsecr</a></code>, <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## from previously fitted model
makeNewData(ipsecrdemo)

</code></pre>

<hr>
<h2 id='plot.ipsecr'> Plot Detection Functions </h2><span id='topic+plot.ipsecr'></span>

<h3>Description</h3>

<p>Plot detection functions using estimates of parameters in an ipsecr object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'ipsecr'
plot(x, newdata = NULL, add = FALSE,
    sigmatick = FALSE, rgr = FALSE, limits = FALSE, alpha = 0.05,
    xval = 0:200, ylim = NULL, xlab = NULL, ylab = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ipsecr_+3A_x">x</code></td>
<td>
<p> an <code>ipsecr</code> object </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_newdata">newdata</code></td>
<td>
<p> dataframe of data to form estimates </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_add">add</code></td>
<td>
<p> logical to add curve(s) to an existing plot </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_sigmatick">sigmatick</code></td>
<td>
<p> logical; if TRUE the scale parameter sigma is shown by a vertical line </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_rgr">rgr</code></td>
<td>
<p> logical; if TRUE a scaled curve r.g(r) is plotted instead of g(r) </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_limits">limits</code></td>
<td>
<p> logical; if TRUE pointwise confidence limits are drawn </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_alpha">alpha</code></td>
<td>
<p> alpha level for confidence intervals </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_xval">xval</code></td>
<td>
<p> vector of distances at for which detection to be plotted </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_ylim">ylim</code></td>
<td>
<p> vector length 2 giving limits of y axis </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_xlab">xlab</code></td>
<td>
<p> label for x axis </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_ylab">ylab</code></td>
<td>
<p> label for y axis </p>
</td></tr>
<tr><td><code id="plot.ipsecr_+3A_...">...</code></td>
<td>
<p> arguments to pass to <code>lines</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>newdata</code> is usually NULL, in which case one curve is plotted for
each session and group. Otherwise, <code>predict.ipsecr</code> is used to form
estimates and plot a curve for each row in <code>newdata</code>.
</p>
<p>If axis labels are not provided they default to &lsquo;Distance (m)&rsquo; and &lsquo;Detection probability&rsquo; or &lsquo;Detection lambda&rsquo;.
</p>
<p>Approximate confidence limits for g(r) are calculated using a numerical
first-order delta-method approximation to the standard error at each
<code>xval</code>. The distribution of g(r) is assumed to be normal on the logit scale for non-hazard functions (detectfn 0:13). For hazard detection functions (detectfn 14:18) the hazard is assumed (from version 3.1.1) to be distributed normally on the log scale. Limits are back-transformed to the probability scale g(r).
</p>


<h3>Value</h3>

<p><code>plot.ipsecr</code> invisibly returns a dataframe of the plotted values (or
a list of dataframes in the case that <code>newdata</code> has more than one
row).
</p>


<h3>See Also</h3>

 <p><code><a href="secr.html#topic+Detection+20functions">Detection functions</a></code>, <code><a href="base.html#topic+plot">plot</a></code>, <code><a href="#topic+ipsecr">ipsecr</a></code>, <code><a href="secr.html#topic+detectfnplot">detectfnplot</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot (ipsecrdemo, xval = 0:100, ylim = c(0, 0.4))

</code></pre>

<hr>
<h2 id='plot3D.IP'>
Plot design and saved simulations for one box from a model fitted with <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>
</h2><span id='topic+plot3D.IP'></span>

<h3>Description</h3>

<p>A 3-D depiction of the design (a box in parameter space) and the resulting simulations (in proxy space).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
plot3D.IP(object, box = 1, oldplot = NULL, plotcentre = TRUE, plotfinal = FALSE, 
    zkludge = -0.2)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot3D.IP_+3A_object">object</code></td>
<td>
<p>ipsecr object from <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code> with details$keep.sim = TRUE</p>
</td></tr>
<tr><td><code id="plot3D.IP_+3A_box">box</code></td>
<td>
<p>integer number of box to plot</p>
</td></tr>
<tr><td><code id="plot3D.IP_+3A_oldplot">oldplot</code></td>
<td>
<p>list containing transofrmations and plot limits from a previous execution</p>
</td></tr>
<tr><td><code id="plot3D.IP_+3A_plotcentre">plotcentre</code></td>
<td>
<p>logical; if TRUE the centrepoint of the design box is plotted</p>
</td></tr>
<tr><td><code id="plot3D.IP_+3A_plotfinal">plotfinal</code></td>
<td>
<p>logical; if TRUE the final estimates are plotted as a point in parameter space</p>
</td></tr>
<tr><td><code id="plot3D.IP_+3A_zkludge">zkludge</code></td>
<td>
<p>numeric adjustment for base value of z when plotfinal is TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is restricted to single-session models with 3 real parameters. 
</p>
<p>A 2-panel plot is generated, so the graphics options should allow at least 2 panels 
(e.g., <code>par(mfrow = c(1,2))</code>.
</p>
<p>Parameters are plotted on the link scale.
</p>
<p>The package <span class="pkg">plot3D</span> is used (Soetaert 2021).
</p>


<h3>Value</h3>

<p>Invisibly returns a list comprising
</p>
<table role = "presentation">
<tr><td><code>pmatparm</code></td>
<td>
<p>pmat used by <span class="pkg">plot3D</span> for parameter space</p>
</td></tr>
<tr><td><code>pmatsim</code></td>
<td>
<p>pmat used by <span class="pkg">plot3D</span> for proxy space</p>
</td></tr>
<tr><td><code>pr</code></td>
<td>
<p>2-row matrix with lower and upper plot limits of each parameter</p>
</td></tr>
<tr><td><code>sr</code></td>
<td>
<p>2-row matrix with lower and upper plot limits of each simulated proxy</p>
</td></tr>
</table>


<h3>References</h3>

<p>Soetaert, K. (2021). plot3D: Plotting Multi-Dimensional Data. R package version 1.4.
https://CRAN.R-project.org/package=plot3D
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (requireNamespace("plot3D")) {
    par(mfrow = c(2,2), oma = c(1,1,3,1))
    # plot first box, saving projection and limits for later use
    oldplot &lt;- plot3D.IP(ipsecrdemo, box = 1)
    # plot second box, using projections and limits from first box
    plot3D.IP(ipsecrdemo, box = 2, oldplot, plotfinal = TRUE, zkludge = -0.1)
    mtext(outer = TRUE, side = 3, line = 0.5, adj = c(0.2,0.8), cex = 1.1, 
        c('Parameter space', 'Proxy space'))
}



</code></pre>

<hr>
<h2 id='plotProxy'>
Simulate and plot the relationship between a parameter and its designated proxy
</h2><span id='topic+plotProxy'></span>

<h3>Description</h3>

<p>As described in the vignette, each parameter is matched to a proxy value computed 
cheaply from the rawdata by the proxy function. This function provides a visual 
check on that relationship.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
plotProxy(parameter = "sigma", proxyfn = proxy.ms, traps, mask, detectfn = "HHN", 
    noccasions = 5, basepar = list(), xvals = NULL, nrepl = 100, add = FALSE, 
    trend = TRUE, points = FALSE, boxplot = TRUE, boxplotargs = list(), 
    link = "log", details = NULL, ...)
    
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotProxy_+3A_parameter">parameter</code></td>
<td>
<p>character parameter of interest</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_proxyfn">proxyfn</code></td>
<td>
<p>function to compute vector of proxy values from a capthist object</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_traps">traps</code></td>
<td>
<p>traps object</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_mask">mask</code></td>
<td>
<p>habitat mask object</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_detectfn">detectfn</code></td>
<td>
<p>numeric or character code for detection function (see <a href="secr.html#topic+detectfn">detectfn</a>)</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_noccasions">noccasions</code></td>
<td>
<p>integer number of sampling occasions</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_basepar">basepar</code></td>
<td>
<p>named list with central values of parameters</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_xvals">xvals</code></td>
<td>
<p>specified values of focal paramater to simulate (optional)</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_nrepl">nrepl</code></td>
<td>
<p>integer number of simulations</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_add">add</code></td>
<td>
<p>logical; if TRUE any plot is added to an existing plot</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_trend">trend</code></td>
<td>
<p>logical; if TRUE a least-squares trend line is plotted</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_points">points</code></td>
<td>
<p>logical; if TRUE each simulated value is plotted</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_boxplot">boxplot</code></td>
<td>
<p>logical; if TRUE a boxplots is plotted for each level of the focal parameter</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_boxplotargs">boxplotargs</code></td>
<td>
<p>list of arguments for <code><a href="graphics.html#topic+boxplot">boxplot</a></code> (optional)</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_link">link</code></td>
<td>
<p>character link function for transforming parameter x-axis</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_details">details</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="plotProxy_+3A_...">...</code></td>
<td>
<p>other arguments passed to plot()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulation uses the internal functions <code><a href="#topic+simpop">simpop</a></code> and <code><a href="#topic+simCH">simCH</a></code>.
</p>
<p><code>boxplotargs</code> may be used to override or add to the arguments of <code><a href="graphics.html#topic+boxplot">boxplot</a></code>.
</p>
<p>This version of <code>plotProxy()</code> does not allow for interference (NT) and assumes a simple SECR model with only 3 or 4 coefficients corresponding to density D and the parameters of the detection model (lambda0 or g0, sigma and possibly z). 
</p>
<p>Matching of proxies at the level of &lsquo;beta&rsquo; parameters may be enabled in a future version.
</p>


<h3>Value</h3>

<p>The simulated proxy values are returned invisibly as a matrix (nrepl x nlevels).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+proxy.ms">proxy.ms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# try with small number of replicates
trps &lt;- traps(captdata)
msk &lt;- make.mask(trps, buffer = 100)
base &lt;- list(D = 5, lambda0 = 0.2, sigma = 25)
out &lt;- plotProxy (parameter = 'D', traps = trps, mask = msk,
     basepar = base, boxplotargs = list(col='orange'), nrepl = 20)

</code></pre>

<hr>
<h2 id='predict.ipsecr'> SECR Model Predictions </h2><span id='topic+predict.ipsecr'></span>

<h3>Description</h3>

<p>Evaluate a spatially explicit capture&ndash;recapture model. That is, compute the &lsquo;real&rsquo; parameters corresponding to the &lsquo;beta&rsquo; parameters of a fitted model for arbitrary levels of any variables in the linear predictor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'ipsecr'
predict(object, newdata = NULL, type = c("response", "link"), 
    se.fit = TRUE, alpha = 0.05, savenew = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.ipsecr_+3A_object">object</code></td>
<td>
 <p><code>ipsecr</code> object output from <code>ipsecr.fit</code> </p>
</td></tr>
<tr><td><code id="predict.ipsecr_+3A_newdata">newdata</code></td>
<td>
<p> optional dataframe of values at which to evaluate model </p>
</td></tr>
<tr><td><code id="predict.ipsecr_+3A_type">type</code></td>
<td>
<p> character; type of prediction required. The default (&quot;response&quot;) provides estimates of the &lsquo;real&rsquo; parameters.</p>
</td></tr> 
<tr><td><code id="predict.ipsecr_+3A_se.fit">se.fit</code></td>
<td>
<p> logical for whether output should include SE and confidence intervals </p>
</td></tr>
<tr><td><code id="predict.ipsecr_+3A_alpha">alpha</code></td>
<td>
<p> alpha level for confidence intervals </p>
</td></tr>
<tr><td><code id="predict.ipsecr_+3A_savenew">savenew</code></td>
<td>
<p> logical for whether newdata should be saved </p>
</td></tr>
<tr><td><code id="predict.ipsecr_+3A_...">...</code></td>
<td>
<p> other arguments passed to <code><a href="#topic+newdata">newdata</a></code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variables in the various linear predictors are described in
<a href="https://www.otago.ac.nz/density/pdfs/secr-models.pdf">secr-models.pdf</a> and listed for the particular model in the
<code>vars</code> component of <code>object</code>.
</p>
<p>Optional <code>newdata</code> should be a dataframe with a column for each of
the variables in the model (see &lsquo;vars&rsquo; component of <code>object</code>).  If
<code>newdata</code> is missing then a dataframe is constructed automatically.
</p>
<p>Default <code>newdata</code> are for a naive animal on the first occasion;
numeric covariates are set to zero and factor covariates to their base
(first) level. The argument &lsquo;all.levels&rsquo; may be passed 
to <code>newdata</code>; if TRUE then the default newdata includes 
all factor levels.
</p>
<p><code>realnames</code> may be used to select a subset of parameters.
</p>
<p>Standard errors for parameters on the response (real) scale are by the
delta method (Lebreton et al. 1992), and confidence intervals are
backtransformed from the link scale.
</p>
<p>The value of <code>newdata</code> is optionally saved as an attribute.
</p>


<h3>Value</h3>

<p>When <code>se.fit</code> = FALSE, a dataframe identical to <code>newdata</code> except for the addition of one column for each &lsquo;real&rsquo; parameter. Otherwise, a list with one component for each row in <code>newdata</code>. Each component is a dataframe with one row for each &lsquo;real&rsquo; parameter (density, g0, sigma, b) and columns as below
</p>

<table>
<tr>
 <td style="text-align: left;">
link        </td><td style="text-align: left;"> link function </td>
</tr>
<tr>
 <td style="text-align: left;"> 
estimate    </td><td style="text-align: left;"> estimate of real parameter </td>
</tr>
<tr>
 <td style="text-align: left;">
SE.estimate </td><td style="text-align: left;"> standard error of the estimate </td>
</tr>
<tr>
 <td style="text-align: left;">
lcl         </td><td style="text-align: left;"> lower 100(1--alpha)% confidence limit </td>
</tr>
<tr>
 <td style="text-align: left;">
ucl         </td><td style="text-align: left;"> upper 100(1--alpha)% confidence limit </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>When <code>newdata</code> has only one row, the structure of the list is
&lsquo;dissolved&rsquo; and the return value is one data frame.
</p>
<p>For <code>detectpar</code>, a list with the estimated values of detection
parameters (e.g., g0 and sigma if detectfn = &quot;halfnormal&quot;). In the case
of multi-session data the result is a list of lists (one list per
session).
</p>


<h3>Note</h3>

<p><code><a href="secr.html#topic+predictDsurface">predictDsurface</a></code> should be used for predicting density at many
points from a model with spatial variation. This deals automatically
with scaling of x- and y-coordinates, and is much faster than
predict.ipsecr. The resulting Dsurface object has its own plot method.
</p>
<p>The argument &lsquo;scaled&rsquo; was removed from both predict methods in version 2.10 as the scaleg0 and scalesigma features had been superceded by other parameterisations.
</p>


<h3>References</h3>

 
<p>Lebreton, J.-D., Burnham, K. P., Clobert, J. and Anderson, D. R. (1992) Modeling survival and testing biological hypotheses using marked animals: a unified approach with case studies. <em>Ecological Monographs</em> <b>62</b>, 67&ndash;118. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>, <code><a href="secr.html#topic+predictDsurface">predictDsurface</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
predict (ipsecrdemo)

</code></pre>

<hr>
<h2 id='print.ipsecr'> Print or Summarise ipsecr Object </h2><span id='topic+print.ipsecr'></span><span id='topic+summary.ipsecr'></span>

<h3>Description</h3>

<p>Print results from fitting a spatially explicit capture&ndash;recapture model or
generate a list of summary values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipsecr'
 print(x, newdata = NULL, alpha = 0.05, call = TRUE, ...)
## S3 method for class 'ipsecr'
 summary(object, newdata = NULL, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ipsecr_+3A_x">x</code></td>
<td>
 <p><code>ipsecr</code> object output from <code>ipsecr.fit</code> </p>
</td></tr>
<tr><td><code id="print.ipsecr_+3A_object">object</code></td>
<td>
 <p><code>ipsecr</code> object output from <code>ipsecr.fit</code> </p>
</td></tr>
<tr><td><code id="print.ipsecr_+3A_newdata">newdata</code></td>
<td>
<p> optional dataframe of values at which to evaluate model </p>
</td></tr>
<tr><td><code id="print.ipsecr_+3A_alpha">alpha</code></td>
<td>
<p> alpha level </p>
</td></tr>
<tr><td><code id="print.ipsecr_+3A_call">call</code></td>
<td>
<p> logical; if TRUE the call is printed </p>
</td></tr>
<tr><td><code id="print.ipsecr_+3A_...">...</code></td>
<td>
<p> other arguments (not used) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results from <code>print.ipsecr</code> are potentially complex and depend upon the analysis (see
below). Optional <code>newdata</code> should be a dataframe with a column for
each of the variables in the model. If <code>newdata</code> is missing then a
dataframe is constructed automatically.  Default <code>newdata</code> are for
a naive animal on the first occasion; numeric covariates are set to zero
and factor covariates to their base (first) level. Confidence intervals
are 100 (1 &ndash; alpha) % intervals.
</p>

<table>
<tr>
 <td style="text-align: left;">
call            </td><td style="text-align: left;"> the function call (optional) </td>
</tr>
<tr>
 <td style="text-align: left;">
version,time    </td><td style="text-align: left;"> ipsecr version, date and time fitting started, and elapsed time </td>
</tr>
<tr>
 <td style="text-align: left;">

Detector type   </td><td style="text-align: left;"> `single', `multi', `proximity' etc. </td>
</tr>
<tr>
 <td style="text-align: left;">
Detector number </td><td style="text-align: left;"> number of detectors </td>
</tr>
<tr>
 <td style="text-align: left;">
Average spacing </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
x-range         </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
y-range         </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
New detector type </td><td style="text-align: left;"> as fitted when details$newdetector specified </td>
</tr>
<tr>
 <td style="text-align: left;">
N animals       </td><td style="text-align: left;"> number of distinct animals detected </td>
</tr>
<tr>
 <td style="text-align: left;">
N detections    </td><td style="text-align: left;"> number of detections </td>
</tr>
<tr>
 <td style="text-align: left;">
N occasions     </td><td style="text-align: left;"> number of sampling occasions </td>
</tr>
<tr>
 <td style="text-align: left;">
Mask area       </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">

Model          </td><td style="text-align: left;"> model formula for each `real' parameter </td>
</tr>
<tr>
 <td style="text-align: left;">
Fixed (real)   </td><td style="text-align: left;"> fixed real parameters </td>
</tr>
<tr>
 <td style="text-align: left;">
Detection fn   </td><td style="text-align: left;"> detection function type (halfnormal or hazard-rate) </td>
</tr>
<tr>
 <td style="text-align: left;">
Distribution    </td><td style="text-align: left;"> spatial model (details$distribution) </td>
</tr>
<tr>
 <td style="text-align: left;">
N parameters   </td><td style="text-align: left;"> number of parameters estimated  </td>
</tr>
<tr>
 <td style="text-align: left;">

Design points   </td><td style="text-align: left;"> number of vertices and centre points </td>
</tr>
<tr>
 <td style="text-align: left;">
Simulations per box </td><td style="text-align: left;"> total number </td>
</tr>
<tr>
 <td style="text-align: left;">
Beta parameters </td><td style="text-align: left;"> coef of the fitted model, SE and confidence intervals </td>
</tr>
<tr>
 <td style="text-align: left;">
vcov            </td><td style="text-align: left;"> variance-covariance matrix of beta parameters  </td>
</tr>
<tr>
 <td style="text-align: left;">
Real parameters </td><td style="text-align: left;"> fitted (real) parameters evaluated at base levels of covariates </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>The <code>summary</code> method constructs a list of outputs similar to those printed by the <code>print</code> method, but somewhat more concise and re-usable:
</p>

<table>
<tr>
 <td style="text-align: left;">
versiontime     </td><td style="text-align: left;"> ipsecr version, and date and time fitting started </td>
</tr>
<tr>
 <td style="text-align: left;">

traps           </td><td style="text-align: left;"> detector summary </td>
</tr>
<tr>
 <td style="text-align: left;">
capthist        </td><td style="text-align: left;"> capthist summary </td>
</tr>
<tr>
 <td style="text-align: left;">
mask            </td><td style="text-align: left;"> mask summary </td>
</tr>
<tr>
 <td style="text-align: left;">
modeldetails    </td><td style="text-align: left;"> miscellaneous model characteristics </td>
</tr>
<tr>
 <td style="text-align: left;">
coef            </td><td style="text-align: left;"> table of fitted coefficients with CI </td>
</tr>
<tr>
 <td style="text-align: left;">
predicted       </td><td style="text-align: left;"> predicted values (`real' parameter estimates) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

 <p><code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load &amp; print previously fitted null (constant parameter) model

print(ipsecrdemo)

summary(ipsecrdemo)

</code></pre>

<hr>
<h2 id='vcov.ipsecr'> Variance - Covariance Matrix of SECR Parameters </h2><span id='topic+vcov.ipsecr'></span>

<h3>Description</h3>

<p>Variance-covariance matrix of beta or real parameters from fitted ipsecr model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipsecr'
vcov(object, realnames = NULL, newdata = NULL, 
    byrow = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.ipsecr_+3A_object">object</code></td>
<td>
<p> ipsecr object output from the function <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code> </p>
</td></tr>
<tr><td><code id="vcov.ipsecr_+3A_realnames">realnames</code></td>
<td>
<p> vector of character strings for names of &lsquo;real&rsquo; parameters </p>
</td></tr>
<tr><td><code id="vcov.ipsecr_+3A_newdata">newdata</code></td>
<td>
<p> dataframe of predictor values </p>
</td></tr>
<tr><td><code id="vcov.ipsecr_+3A_byrow">byrow</code></td>
<td>
<p> logical for whether to compute covariances among &lsquo;real&rsquo; parameters 
for each row of new data, or among rows for each real parameter</p>
</td></tr>
<tr><td><code id="vcov.ipsecr_+3A_...">...</code></td>
<td>
<p> other arguments (not used) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, returns the matrix of variances and covariances among the
estimated model coefficients (beta parameters). 
</p>
<p>If <code>realnames</code> and <code>newdata</code> are specified, the result is
either a matrix of variances and covariances for each &lsquo;real&rsquo; parameter
among the points in predictor-space given by the rows of <code>newdata</code>
or among real parameters for each row of <code>newdata</code>. Failure to
specify <code>newdata</code> results in a list of variances only.
</p>


<h3>Value</h3>

<p>A matrix containing the variances and covariances among beta parameters
on the respective link scales, or a list of among-parameter variance-covariance
matrices, one for each row of <code>newdata</code>, or a list of among-row variance-covariance
matrices, one for each &lsquo;real&rsquo; parameter.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+vcov">vcov</a></code>, <code><a href="#topic+ipsecr.fit">ipsecr.fit</a></code>, <code><a href="#topic+print.ipsecr">print.ipsecr</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## previously fitted ipsecr model
vcov(ipsecrdemo)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
