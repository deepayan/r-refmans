<!DOCTYPE html><html><head><title>Help for package quantilogram</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {quantilogram}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#quantilogram-package'><p>quantilogram: Cross-Quantilogram</p></a></li>
<li><a href='#corr.lag'><p>Correlation Function</p></a></li>
<li><a href='#corr.lag.partial'><p>Partial Cross-correlation function</p></a></li>
<li><a href='#crossq'><p>Cross-Quantilogram</p></a></li>
<li><a href='#crossq.max'><p>Corss-Quantilogram up to a Given Lag Order</p></a></li>
<li><a href='#crossq.max.partial'><p>Partial Corss-Quantilogram upto a given lag order</p></a></li>
<li><a href='#crossq.partial'><p>Paritial Cross-Quantilogram</p></a></li>
<li><a href='#crossq.partial.sb'><p>Stationary Bootstrap for the Partial Cross-Quantilogram</p></a></li>
<li><a href='#crossq.partial.sb.opt'><p>Stationary Bootstrap for the Partial Cross-Quantilogram dwith the choice of the stationary-bootstrap parameter</p></a></li>
<li><a href='#crossq.sb'><p>Stationary Bootstrap for the Cross-Quantilogram</p></a></li>
<li><a href='#crossq.sb.opt'><p>Stationary Bootstrap for the Cross-Quantilogram with the choice of the stationary-bootstrap parameter</p></a></li>
<li><a href='#crossqreg'><p>Cross-Quantilogram</p></a></li>
<li><a href='#crossqreg.max'><p>Corss-Quantilogram up to a Given Lag Order</p></a></li>
<li><a href='#crossqreg.max.partial'><p>Partial Corss-Quantilogram upto a given lag order</p></a></li>
<li><a href='#crossqreg.partial'><p>Paritial Cross-Quantilogram</p></a></li>
<li><a href='#crossqreg.sb'><p>Stationary Bootstrap for the Cross-Quantilogram</p></a></li>
<li><a href='#q.hit'><p>Quantile Hit</p></a></li>
<li><a href='#qreg.hit'><p>Quantile Hit</p></a></li>
<li><a href='#Qstat'><p>Q-statistics</p></a></li>
<li><a href='#Qstat.reg.sb'><p>Stationary Bootstrap for Q statistics</p></a></li>
<li><a href='#Qstat.sb'><p>Stationary Bootstrap for Q statistics</p></a></li>
<li><a href='#Qstat.sb.opt'><p>Stationary Bootstrap for Q statistics</p></a></li>
<li><a href='#sb.index'><p>Stationary Bootstrap Index</p></a></li>
<li><a href='#stock'><p>The Data Set of Monthly Stock Return and Sotck Variance</p></a></li>
<li><a href='#sys.risk'><p>The Data Set for Systemic Risk Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Cross-Quantilogram</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tatsushi Oka &lt;oka.econ@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation and inference methods for the cross-quantilogram.
    The cross-quantilogram is a measure of nonlinear dependence between
    two variables, based on either unconditional or conditional quantile
    functions.  The cross-quantilogram can be considered as an extension
    of the correlogram, which is a correlation function over multiple lag
    periods and mainly focuses on linear dependency.  One can use the
    cross-quantilogram to detect the presence of directional
    predictability from one time series to another.  This package provides
    a statistical inference method based on the stationary bootstrap.  See
    Linton and Whang (2007) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2007.01.004">doi:10.1016/j.jeconom.2007.01.004</a>&gt; for
    univariate time series analysis and Han, Linton, Oka and Whang (2016)
    &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2016.03.001">doi:10.1016/j.jeconom.2016.03.001</a>&gt; for multivariate time series
    analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>np, quantreg, SparseM, stats</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-01 12:55:44 UTC; student-t</td>
</tr>
<tr>
<td>Author:</td>
<td>Tatsushi Oka [aut, cre],
  Heejon Han [ctb],
  Oliver Linton [ctb],
  Yoon-Jae Whang [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-05 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='quantilogram-package'>quantilogram: Cross-Quantilogram</h2><span id='topic+quantilogram'></span><span id='topic+quantilogram-package'></span>

<h3>Description</h3>

<p>Estimation and inference methods for the cross-quantilogram. The cross-quantilogram is a measure of nonlinear dependence between two variables, based on either unconditional or conditional quantile functions. The cross-quantilogram can be considered as an extension of the correlogram, which is a correlation function over multiple lag periods and mainly focuses on linear dependency. One can use the cross-quantilogram to detect the presence of directional predictability from one time series to another. This package provides a statistical inference method based on the stationary bootstrap. See Linton and Whang (2007) &lt;doi:10.1016/j.jeconom.2007.01.004&gt; for univariate time series analysis and Han, Linton, Oka and Whang (2016) &lt;doi:10.1016/j.jeconom.2016.03.001&gt; for multivariate time series analysis.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Tatsushi Oka <a href="mailto:oka.econ@gmail.com">oka.econ@gmail.com</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Heejon Han [contributor]
</p>
</li>
<li><p> Oliver Linton [contributor]
</p>
</li>
<li><p> Yoon-Jae Whang [contributor]
</p>
</li></ul>


<hr>
<h2 id='corr.lag'>Correlation Function</h2><span id='topic+corr.lag'></span>

<h3>Description</h3>

<p>The correlation statistics for a given lag order
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr.lag(matH, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corr.lag_+3A_math">matH</code></td>
<td>
<p>The matrix with the column size of 2</p>
</td></tr>
<tr><td><code id="corr.lag_+3A_k">k</code></td>
<td>
<p>The lag order (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function obtains the simple correlation statistics. The values in the first column of input matrix
is interacted with the k-lagged values in the second column.
</p>


<h3>Value</h3>

<p>Correlation
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>

<hr>
<h2 id='corr.lag.partial'>Partial Cross-correlation function</h2><span id='topic+corr.lag.partial'></span>

<h3>Description</h3>

<p>A function used to obtain partial cross-correlation function for a give lag order
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr.lag.partial(matH, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corr.lag.partial_+3A_math">matH</code></td>
<td>
<p>A matrix with multiple columns (more than 3 columns)</p>
</td></tr>
<tr><td><code id="corr.lag.partial_+3A_k">k</code></td>
<td>
<p>The lag order (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function obtains the partial corss-correlation and the simple correlation.
To obtain the partial cross-correlation, this function uses the first column of
the input matrix and k-lagged values of the rest of the matrix.
</p>


<h3>Value</h3>

<p>Partial corss-correlation at k lags and the correlation statistics at k lags.
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>

<hr>
<h2 id='crossq'>Cross-Quantilogram</h2><span id='topic+crossq'></span>

<h3>Description</h3>

<p>Returns the cross-quantilogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossq(DATA, vecA, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossq_+3A_data">DATA</code></td>
<td>
<p>An input matrix</p>
</td></tr>
<tr><td><code id="crossq_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossq_+3A_k">k</code></td>
<td>
<p>A lag order (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function obtains the cross-quantilogram at the k lag order.
</p>


<h3>Value</h3>

<p>Cross-Quantilogram
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot; <em>Journal of Econometrics</em>, 193(1), 251-270.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data source 
data("sys.risk") 

## data: 2 variables 
D = sys.risk[,c("Market", "JPM")]

# probability levels for the 2 variables 
vecA = c(0.1, 0.5)

## cross-quantilogram with the lag of 5
crossq.max(D, vecA, 5)

</code></pre>

<hr>
<h2 id='crossq.max'>Corss-Quantilogram up to a Given Lag Order</h2><span id='topic+crossq.max'></span>

<h3>Description</h3>

<p>The cross-quantilograms from 1 to a given lag order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossq.max(DATA, vecA, Kmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossq.max_+3A_data">DATA</code></td>
<td>
<p>An input matrix</p>
</td></tr>
<tr><td><code id="crossq.max_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossq.max_+3A_kmax">Kmax</code></td>
<td>
<p>The maximum lag order (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the partial cross-quantilograms up to the lag order
users specify.
</p>


<h3>Value</h3>

<p>A vector of cross-quantilogram
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data source 
data("sys.risk") 

## data: 2 variables 
D = sys.risk[,c("Market", "JPM")]

# probability levels for the 2 variables 
vecA = c(0.1, 0.5)

## cross-quantilogram with lags between 1 and 5
crossq.max(D, vecA, 5)

</code></pre>

<hr>
<h2 id='crossq.max.partial'>Partial Corss-Quantilogram upto a given lag order</h2><span id='topic+crossq.max.partial'></span>

<h3>Description</h3>

<p>The partial cross-quantilograms from 1 to a given lag order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossq.max.partial(DATA, vecA, Kmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossq.max.partial_+3A_data">DATA</code></td>
<td>
<p>An input matrix</p>
</td></tr>
<tr><td><code id="crossq.max.partial_+3A_veca">vecA</code></td>
<td>
<p>A vector of probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossq.max.partial_+3A_kmax">Kmax</code></td>
<td>
<p>The maximum lag order (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the partial cross-quantilograms up to the lag order
users specify.
</p>


<h3>Value</h3>

<p>A vector of cross-quantilogram and a vector of partial cross-quantilograms
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot; <em>Journal of Econometrics</em>, 193(1), 251-270.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data source 
data("sys.risk") 

## data with 3 variables 
D = sys.risk[,c("Market", "JPM", "VIX")]

## probablity levels for the 3 variables 
vecA = c(0.1, 0.1, 0.1)

## partial cross-quantilogram with lags from 1 to 5
crossq.max.partial(D, vecA, 5)

</code></pre>

<hr>
<h2 id='crossq.partial'>Paritial Cross-Quantilogram</h2><span id='topic+crossq.partial'></span>

<h3>Description</h3>

<p>Returns the partial cross-quantilogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossq.partial(DATA, vecA, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossq.partial_+3A_data">DATA</code></td>
<td>
<p>A matrix</p>
</td></tr>
<tr><td><code id="crossq.partial_+3A_veca">vecA</code></td>
<td>
<p>A vector of probability values at which sample quantiles are estiamted</p>
</td></tr>
<tr><td><code id="crossq.partial_+3A_k">k</code></td>
<td>
<p>The lag order</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function obtains the partial corss-quantilogram and the cross-quantilogram.
To obtain the partial cross-correlation given an input matrix, this function interacts
the values of the first column and the k-lagged values of the rest of the matrix.
</p>


<h3>Value</h3>

<p>The partial corss-quantilogram and the cross-quantilogram
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot; <em>Journal of Econometrics</em>, 193(1), 251-270.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data source 
data("sys.risk") 

## data with 3 variables 
D = sys.risk[,c("Market", "JPM", "VIX")]

## probablity levels for the 3 variables 
vecA = c(0.1, 0.1, 0.1)

## partial cross-quantilogram with the lag of 5
crossq.max.partial(D, vecA, 5)

</code></pre>

<hr>
<h2 id='crossq.partial.sb'>Stationary Bootstrap for the Partial Cross-Quantilogram</h2><span id='topic+crossq.partial.sb'></span>

<h3>Description</h3>

<p>Returns critical values for the partial cross-quantilogram, based on the stationary bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossq.partial.sb(DATA, vecA, k, gamma, Bsize, sigLev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossq.partial.sb_+3A_data">DATA</code></td>
<td>
<p>The original data matrix</p>
</td></tr>
<tr><td><code id="crossq.partial.sb_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossq.partial.sb_+3A_k">k</code></td>
<td>
<p>A lag order</p>
</td></tr>
<tr><td><code id="crossq.partial.sb_+3A_gamma">gamma</code></td>
<td>
<p>A parameter for the stationary bootstrap</p>
</td></tr>
<tr><td><code id="crossq.partial.sb_+3A_bsize">Bsize</code></td>
<td>
<p>The number of repetition of bootstrap</p>
</td></tr>
<tr><td><code id="crossq.partial.sb_+3A_siglev">sigLev</code></td>
<td>
<p>The statistical significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates critical values for for the partial cross-quantilogram,
using the stationary bootstrap in Politis and Romano (1994).
</p>


<h3>Value</h3>

<p>The boostrap critical values
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Politis, Dimitris N., and Joseph P. Romano. &quot;The stationary bootstrap.&quot; <em>Journal of the American Statistical Association</em> 89.428 (1994): 1303-1313.
</p>

<hr>
<h2 id='crossq.partial.sb.opt'>Stationary Bootstrap for the Partial Cross-Quantilogram dwith the choice of the stationary-bootstrap parameter</h2><span id='topic+crossq.partial.sb.opt'></span>

<h3>Description</h3>

<p>Returns critical values for the partial cross-quantilogram, based on the stationary bootstrap with the choice of the stationary-bootstrap parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossq.partial.sb.opt(DATA, vecA, k, Bsize, sigLev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossq.partial.sb.opt_+3A_data">DATA</code></td>
<td>
<p>The original data matrix</p>
</td></tr>
<tr><td><code id="crossq.partial.sb.opt_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossq.partial.sb.opt_+3A_k">k</code></td>
<td>
<p>A lag order</p>
</td></tr>
<tr><td><code id="crossq.partial.sb.opt_+3A_bsize">Bsize</code></td>
<td>
<p>The number of repetition of bootstrap</p>
</td></tr>
<tr><td><code id="crossq.partial.sb.opt_+3A_siglev">sigLev</code></td>
<td>
<p>The statistical significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates critical values for for the partial cross-quantilogram,
using the stationary bootstrap in Politis and Romano (1994).
</p>


<h3>Value</h3>

<p>The boostrap critical values
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot; <em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Patton, A., Politis, D. N., and White, H. (2009).
Correction to &quot;Automatic block-length selection for the dependent bootstrap&quot;
by D. Politis and H. White. <em>Econometric Reviews</em>, 28(4), 372-375.
</p>
<p>Politis, D. N., and White, H. (2004).
&quot;Automatic block-length selection for the dependent bootstrap.&quot;
<em>Econometric Reviews</em>, 23(1), 53-70.
</p>
<p>Politis, Dimitris N., and Joseph P. Romano. (1994).
&quot;The stationary bootstrap.&quot;
<em>Journal of the American Statistical Association</em> 89.428: 1303-1313.
</p>

<hr>
<h2 id='crossq.sb'>Stationary Bootstrap for the Cross-Quantilogram</h2><span id='topic+crossq.sb'></span>

<h3>Description</h3>

<p>Returns critical values for the cross-quantilogram, based on the stationary bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossq.sb(DATA, vecA, k, gamma, Bsize, sigLev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossq.sb_+3A_data">DATA</code></td>
<td>
<p>The original data matrix</p>
</td></tr>
<tr><td><code id="crossq.sb_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossq.sb_+3A_k">k</code></td>
<td>
<p>A lag order</p>
</td></tr>
<tr><td><code id="crossq.sb_+3A_gamma">gamma</code></td>
<td>
<p>A parameter for the stationary bootstrap</p>
</td></tr>
<tr><td><code id="crossq.sb_+3A_bsize">Bsize</code></td>
<td>
<p>The number of repetition of bootstrap</p>
</td></tr>
<tr><td><code id="crossq.sb_+3A_siglev">sigLev</code></td>
<td>
<p>The statistical significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates critical values for for the cross-quantilogram,
using the stationary bootstrap in Politis and Romano (1994).
</p>


<h3>Value</h3>

<p>The boostrap critical values
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Politis, Dimitris N., and Joseph P. Romano. &quot;The stationary bootstrap.&quot; <em>Journal of the American Statistical Association</em> 89.428 (1994): 1303-1313.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sys.risk") ## data source
D = sys.risk[,c("Market", "JPM")] ## data: 2 variables

# probability levels for the 2 variables
vecA = c(0.1, 0.5)

## setup for stationary bootstrap
gamma  = 1/10 ## bootstrap parameter depending on data
Bsize  = 5    ## small size, 5, for test 
sigLev = 0.05 ## significance level

## cross-quantilogram with the lag of 5
crossq.sb(D, vecA, 5, gamma, Bsize, sigLev)

</code></pre>

<hr>
<h2 id='crossq.sb.opt'>Stationary Bootstrap for the Cross-Quantilogram with the choice of the stationary-bootstrap parameter</h2><span id='topic+crossq.sb.opt'></span>

<h3>Description</h3>

<p>Returns critical values for the cross-quantilogram, based on the stationary bootstrap with the choice of the stationary-bootstrap parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossq.sb.opt(DATA, vecA, k, Bsize, sigLev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossq.sb.opt_+3A_data">DATA</code></td>
<td>
<p>The original data matrix</p>
</td></tr>
<tr><td><code id="crossq.sb.opt_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossq.sb.opt_+3A_k">k</code></td>
<td>
<p>A lag order</p>
</td></tr>
<tr><td><code id="crossq.sb.opt_+3A_bsize">Bsize</code></td>
<td>
<p>The number of repetition of bootstrap</p>
</td></tr>
<tr><td><code id="crossq.sb.opt_+3A_siglev">sigLev</code></td>
<td>
<p>The statistical significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates critical values for for the cross-quantilogram,
using the stationary bootstrap in Politis and Romano (1994).
To choose parameter for the statioanry bootstrap, this function
first obtaines the optimal value for each time serie using the
result provided by Politis and White (2004) and Patton, Politis and White (2004)
(The R-package, &quot;np&quot;, written by  Hayfield and Racine is used).
Next, the average of the obtained values is used as the parameter value.
</p>


<h3>Value</h3>

<p>The boostrap critical values
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot; <em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Patton, A., Politis, D. N., and White, H. (2009).
Correction to &quot;Automatic block-length selection for the dependent bootstrap&quot;
by D. Politis and H. White. <em>Econometric Reviews</em>, 28(4), 372-375.
</p>
<p>Politis, D. N., and White, H. (2004).
&quot;Automatic block-length selection for the dependent bootstrap.&quot;
<em>Econometric Reviews</em>, 23(1), 53-70.
</p>
<p>Politis, Dimitris N., and Joseph P. Romano. (1994).
&quot;The stationary bootstrap.&quot;
<em>Journal of the American Statistical Association</em> 89.428: 1303-1313.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data source
data("sys.risk")

## data: 2 variables
D = sys.risk[,c("Market", "JPM")]

# probability levels for the 2 variables
vecA = c(0.1, 0.5)

## setup for stationary bootstrap
Bsize  = 5    ## small size 5 for test
sigLev = 0.05 ## significance level

## cross-quantilogram with the lag of 5
crossq.sb.opt(D, vecA, 5, Bsize, sigLev)

</code></pre>

<hr>
<h2 id='crossqreg'>Cross-Quantilogram</h2><span id='topic+crossqreg'></span>

<h3>Description</h3>

<p>Returns the cross-quantilogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossqreg(DATA1, DATA2, vecA, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossqreg_+3A_data1">DATA1</code></td>
<td>
<p>An input matrix (T x p1)</p>
</td></tr>
<tr><td><code id="crossqreg_+3A_data2">DATA2</code></td>
<td>
<p>An input matrix (T x p2)</p>
</td></tr>
<tr><td><code id="crossqreg_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossqreg_+3A_k">k</code></td>
<td>
<p>A lag order (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function obtains the cross-quantilogram at the k lag order.
</p>


<h3>Value</h3>

<p>Cross-Quantilogram
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Koenker, R., and Bassett Jr, G. (1978).
&quot;Regression quantiles.&quot; <em>Econometrica</em>, 46(1), 33-50.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data source 
data(sys.risk)

## sample size
T = nrow(sys.risk)

## matrix for quantile regressions
## - 1st column: dependent variables
## - the rest:   regressors or predictors 
D1 = cbind(sys.risk[2:T,"Market"], sys.risk[1:(T-1),"Market"])
D2 = cbind(sys.risk[2:T,"JPM"], sys.risk[1:(T-1),"JPM"])

## probability levels
vecA = c(0.1, 0.2)

## cross-quantilogram with the lag of 5, after quantile regression 
crossqreg(D1, D2, vecA, 5)

</code></pre>

<hr>
<h2 id='crossqreg.max'>Corss-Quantilogram up to a Given Lag Order</h2><span id='topic+crossqreg.max'></span>

<h3>Description</h3>

<p>The cross-quantilograms from 0 to a given lag order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossqreg.max(DATA1, DATA2, vecA, Kmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossqreg.max_+3A_data1">DATA1</code></td>
<td>
<p>An input matrix (T x p1)</p>
</td></tr>
<tr><td><code id="crossqreg.max_+3A_data2">DATA2</code></td>
<td>
<p>An input matrix (T x p2)</p>
</td></tr>
<tr><td><code id="crossqreg.max_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossqreg.max_+3A_kmax">Kmax</code></td>
<td>
<p>The maximum lag order (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the partial cross-quantilograms up to the lag order
users specify.
</p>


<h3>Value</h3>

<p>A vector of cross-quantilogram
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>

<hr>
<h2 id='crossqreg.max.partial'>Partial Corss-Quantilogram upto a given lag order</h2><span id='topic+crossqreg.max.partial'></span>

<h3>Description</h3>

<p>The partial cross-quantilograms from 1 to a given lag order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossqreg.max.partial(DATA1, DATA2, vecA, Kmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossqreg.max.partial_+3A_data1">DATA1</code></td>
<td>
<p>An input matrix (T x p1)</p>
</td></tr>
<tr><td><code id="crossqreg.max.partial_+3A_data2">DATA2</code></td>
<td>
<p>An input matrix (T x p2)</p>
</td></tr>
<tr><td><code id="crossqreg.max.partial_+3A_veca">vecA</code></td>
<td>
<p>A vector of probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossqreg.max.partial_+3A_kmax">Kmax</code></td>
<td>
<p>The maximum lag order (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the partial cross-quantilograms up to the lag order
users specify.
</p>


<h3>Value</h3>

<p>A vector of cross-quantilogram and a vector of partial cross-quantilograms
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>

<hr>
<h2 id='crossqreg.partial'>Paritial Cross-Quantilogram</h2><span id='topic+crossqreg.partial'></span>

<h3>Description</h3>

<p>Returns the partial cross-quantilogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossqreg.partial(DATA1, DATA2, vecA, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossqreg.partial_+3A_data1">DATA1</code></td>
<td>
<p>An input matrix (T x p1)</p>
</td></tr>
<tr><td><code id="crossqreg.partial_+3A_data2">DATA2</code></td>
<td>
<p>An input matrix (T x p2)</p>
</td></tr>
<tr><td><code id="crossqreg.partial_+3A_veca">vecA</code></td>
<td>
<p>A vector of probability values at which sample quantiles are estiamted</p>
</td></tr>
<tr><td><code id="crossqreg.partial_+3A_k">k</code></td>
<td>
<p>The lag order</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function obtains the partial corss-quantilogram and the cross-quantilogram.
To obtain the partial cross-correlation given an input matrix, this function interacts
the values of the first column and the k-lagged values of the rest of the matrix.
</p>


<h3>Value</h3>

<p>The partial corss-quantilogram and the cross-quantilogram
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>

<hr>
<h2 id='crossqreg.sb'>Stationary Bootstrap for the Cross-Quantilogram</h2><span id='topic+crossqreg.sb'></span>

<h3>Description</h3>

<p>Returns critical values for the cross-quantilogram, based on the stationary bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossqreg.sb(DATA1, DATA2, vecA, k, gamma, Bsize, sigLev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossqreg.sb_+3A_data1">DATA1</code></td>
<td>
<p>The original data matrix (T x p1)</p>
</td></tr>
<tr><td><code id="crossqreg.sb_+3A_data2">DATA2</code></td>
<td>
<p>The original data matrix (T x p2)</p>
</td></tr>
<tr><td><code id="crossqreg.sb_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probability values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="crossqreg.sb_+3A_k">k</code></td>
<td>
<p>A lag order</p>
</td></tr>
<tr><td><code id="crossqreg.sb_+3A_gamma">gamma</code></td>
<td>
<p>A parameter for the stationary bootstrap</p>
</td></tr>
<tr><td><code id="crossqreg.sb_+3A_bsize">Bsize</code></td>
<td>
<p>The number of repetition of bootstrap</p>
</td></tr>
<tr><td><code id="crossqreg.sb_+3A_siglev">sigLev</code></td>
<td>
<p>The statistical significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates critical values for for the cross-quantilogram,
using the stationary bootstrap in Politis and Romano (1994).
</p>


<h3>Value</h3>

<p>The boostrap critical values
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot; <em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Politis, Dimitris N., and Joseph P. Romano.
&quot;The stationary bootstrap.&quot;
<em>Journal of the American Statistical Association</em> 89.428 (1994): 1303-1313.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sys.risk) 

## sample size
T = nrow(sys.risk)

## matrix for quantile regressions
## - 1st column: dependent variables
## - the rest:   regressors or predictors 
D1 = cbind(sys.risk[2:T,"Market"], sys.risk[1:(T-1),"Market"])
D2 = cbind(sys.risk[2:T,"JPM"], sys.risk[1:(T-1),"JPM"])

## probability levels
vecA = c(0.1, 0.2)

## setup for stationary bootstrap
gamma  = 1/10 ## bootstrap parameter depending on data
Bsize  = 5    ## small size 10 for test 
sigLev = 0.05 ## significance level

## cross-quantilogram with the lag of 5, after quantile regression 
crossqreg.sb(D1, D2, vecA, 5, gamma, Bsize, sigLev)

</code></pre>

<hr>
<h2 id='q.hit'>Quantile Hit</h2><span id='topic+q.hit'></span>

<h3>Description</h3>

<p>Returns the matrix of quantil-hits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q.hit(DATA, vecA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q.hit_+3A_data">DATA</code></td>
<td>
<p>A matrix that has time-series observations in its columns</p>
</td></tr>
<tr><td><code id="q.hit_+3A_veca">vecA</code></td>
<td>
<p>A vector of probabilty values at which sample quantiles are estimated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates the quantile hits given a vector of probabilty values.
The quantile hits are obtained for each column of an input matrix.
</p>


<h3>Value</h3>

<pre> A matrix of quantile-hits
</pre>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>

<hr>
<h2 id='qreg.hit'>Quantile Hit</h2><span id='topic+qreg.hit'></span>

<h3>Description</h3>

<p>Returns the matrix of quantil-hits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qreg.hit(DATA1, DATA2, vecA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qreg.hit_+3A_data1">DATA1</code></td>
<td>
<p>An input matrix (T x p1+1) with the first column of the dependent varaible and the the rest of columns with regressors</p>
</td></tr>
<tr><td><code id="qreg.hit_+3A_data2">DATA2</code></td>
<td>
<p>An input matrix (T x p2+1) with the first column of the dependent varaible and the the rest of columns with regressors</p>
</td></tr>
<tr><td><code id="qreg.hit_+3A_veca">vecA</code></td>
<td>
<p>A vector of probabilty values at which sample quantiles are estimated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates the quantile hits based on quantile regression,
given a vector of probabilty values. The quantile regressions are esimated
for each matrix of data and a pair of quantile hits are produced.
</p>


<h3>Value</h3>

<pre> A matrix of quantile-hits
</pre>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Koenker, R., and Bassett Jr, G. (1978).
&quot;Regression quantiles.&quot; Econometrica, 46(1), 33-50.
</p>

<hr>
<h2 id='Qstat'>Q-statistics</h2><span id='topic+Qstat'></span>

<h3>Description</h3>

<p>Te Box-Pierece and Ljung-Box type Q-statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qstat(vecTest, Tsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qstat_+3A_vectest">vecTest</code></td>
<td>
<p>A vector of test statistics ordered with respect the number of lags</p>
</td></tr>
<tr><td><code id="Qstat_+3A_tsize">Tsize</code></td>
<td>
<p>A original sample size</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns Box-Pierece and Ljung-Box type Q-statistics
</p>


<h3>Value</h3>

<p>the Box-Pierece and Ljung-Box statistics
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Box, G. EP, and D. A. Pierce. (1970).
&quot;Distribution of residual autocorrelations in autoregressive-integrated moving average time series models.&quot;
<em>Journal of the American Statistical Association</em> 65.332, pp.1509-1526.
</p>
<p>Ljung, G. M., and G. EP Box. (1978).
&quot;On a measure of lack of fit in time series models.&quot;
<em>Biometrika</em> 65.2, pp.297-303.
</p>

<hr>
<h2 id='Qstat.reg.sb'>Stationary Bootstrap for Q statistics</h2><span id='topic+Qstat.reg.sb'></span>

<h3>Description</h3>

<p>Stationary Bootstrap procedure to generate critical values for both Box-Pierece and Ljung-Box type Q-statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qstat.reg.sb(DATA1, DATA2, vecA, Psize, gamma, Bsize, sigLev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qstat.reg.sb_+3A_data1">DATA1</code></td>
<td>
<p>The original data set (1)</p>
</td></tr>
<tr><td><code id="Qstat.reg.sb_+3A_data2">DATA2</code></td>
<td>
<p>The original data set (2)</p>
</td></tr>
<tr><td><code id="Qstat.reg.sb_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probabity values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="Qstat.reg.sb_+3A_psize">Psize</code></td>
<td>
<p>The maximum number of lags</p>
</td></tr>
<tr><td><code id="Qstat.reg.sb_+3A_gamma">gamma</code></td>
<td>
<p>A parameter for the stationary bootstrap</p>
</td></tr>
<tr><td><code id="Qstat.reg.sb_+3A_bsize">Bsize</code></td>
<td>
<p>The number of repetition of bootstrap</p>
</td></tr>
<tr><td><code id="Qstat.reg.sb_+3A_siglev">sigLev</code></td>
<td>
<p>The statistical significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns critical values for for both Box-Pierece and Ljung-Box type Q-statistics through the statioanry bootstrap proposed by Politis and Romano (1994).
</p>


<h3>Value</h3>

<p>The bootstrap critical values
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Politis, Dimitris N., and Joseph P. Romano. (1994).
&quot;The stationary bootstrap.&quot;
<em>Journal of the American Statistical Association</em> 89.428, pp.1303-1313.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sys.risk) 

## sample size
T = nrow(sys.risk)

## matrix for quantile regressions
## - 1st column: dependent variables
## - the rest:   regressors or predictors 
D1 = cbind(sys.risk[2:T,"Market"], sys.risk[1:(T-1),"Market"])
D2 = cbind(sys.risk[2:T,"JPM"], sys.risk[1:(T-1),"JPM"])

## probability levels
vecA = c(0.1, 0.2)

## setup for stationary bootstrap
gamma  = 1/10 ## bootstrap parameter depending on data
Bsize  = 5    ## small size, 5, for test 
sigLev = 0.05 ## significance level

## Q statistics with lags from 1 to 5, after quantile regression 
Qstat.reg.sb(D1, D2, vecA, 5, gamma, Bsize, sigLev)

</code></pre>

<hr>
<h2 id='Qstat.sb'>Stationary Bootstrap for Q statistics</h2><span id='topic+Qstat.sb'></span>

<h3>Description</h3>

<p>Stationary Bootstrap procedure to generate critical values for both Box-Pierece and Ljung-Box type Q-statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qstat.sb(DATA, vecA, Psize, gamma, Bsize, sigLev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qstat.sb_+3A_data">DATA</code></td>
<td>
<p>The original data</p>
</td></tr>
<tr><td><code id="Qstat.sb_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probabity values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="Qstat.sb_+3A_psize">Psize</code></td>
<td>
<p>The maximum number of lags</p>
</td></tr>
<tr><td><code id="Qstat.sb_+3A_gamma">gamma</code></td>
<td>
<p>A parameter for the stationary bootstrap</p>
</td></tr>
<tr><td><code id="Qstat.sb_+3A_bsize">Bsize</code></td>
<td>
<p>The number of repetition of bootstrap</p>
</td></tr>
<tr><td><code id="Qstat.sb_+3A_siglev">sigLev</code></td>
<td>
<p>The statistical significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns critical values for for both Box-Pierece and Ljung-Box type Q-statistics through the statioanry bootstrap proposed by Politis and Romano (1994).
</p>


<h3>Value</h3>

<p>The bootstrap critical values
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Politis, Dimitris N., and Joseph P. Romano. (1994).
&quot;The stationary bootstrap.&quot;
<em>Journal of the American Statistical Association</em> 89.428, pp.1303-1313.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sys.risk") ## data source 
D = sys.risk[,c("Market", "JPM")] ## data: 2 variables 

# probability levels for the 2 variables 
vecA = c(0.1, 0.5)

## setup for stationary bootstrap
gamma  = 1/10 ## bootstrap parameter depending on data
Bsize  = 5    ## small size, 5, for test 
sigLev = 0.05 ## significance level

## Q statistics with lags from 1 to5
Qstat.sb(D, vecA, 5, gamma, Bsize, sigLev)

</code></pre>

<hr>
<h2 id='Qstat.sb.opt'>Stationary Bootstrap for Q statistics</h2><span id='topic+Qstat.sb.opt'></span>

<h3>Description</h3>

<p>Stationary Bootstrap procedure to generate critical values for both Box-Pierece and Ljung-Box type Q-statistics with the choice of the stationary-bootstrap parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qstat.sb.opt(DATA, vecA, Psize, Bsize, sigLev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qstat.sb.opt_+3A_data">DATA</code></td>
<td>
<p>The original data</p>
</td></tr>
<tr><td><code id="Qstat.sb.opt_+3A_veca">vecA</code></td>
<td>
<p>A pair of two probabity values at which sample quantiles are estimated</p>
</td></tr>
<tr><td><code id="Qstat.sb.opt_+3A_psize">Psize</code></td>
<td>
<p>The maximum number of lags</p>
</td></tr>
<tr><td><code id="Qstat.sb.opt_+3A_bsize">Bsize</code></td>
<td>
<p>The number of repetition of bootstrap</p>
</td></tr>
<tr><td><code id="Qstat.sb.opt_+3A_siglev">sigLev</code></td>
<td>
<p>The statistical significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns critical values for for both Box-Pierece and Ljung-Box type
Q-statistics through the statioanry bootstrap proposed by Politis and Romano (1994).
To choose parameter for the statioanry bootstrap, this function
first obtaines the optimal value for each time serie using the
result provided by Politis and White (2004) and Patton, Politis and White (2004)
(The R-package, &quot;np&quot;, written by  Hayfield and Racine is used).
Next, the average of the obtained values is used as the parameter value.
</p>


<h3>Value</h3>

<p>The bootstrap critical values
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot; <em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Patton, A., Politis, D. N., and White, H. (2009).
Correction to &quot;Automatic block-length selection for the dependent bootstrap&quot;
by D. Politis and H. White. <em>Econometric Reviews</em>, 28(4), 372-375.
</p>
<p>Politis, D. N., and White, H. (2004).
&quot;Automatic block-length selection for the dependent bootstrap.&quot;
<em>Econometric Reviews</em>, 23(1), 53-70.
</p>
<p>Politis, Dimitris N., and Joseph P. Romano. (1994).
&quot;The stationary bootstrap.&quot;
<em>Journal of the American Statistical Association</em> 89.428: 1303-1313.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("sys.risk") ## data source 
D = sys.risk[,c("Market", "JPM")] ## data: 2 variables 

# probability levels for the 2 variables 
vecA = c(0.1, 0.5)

## setup for stationary bootstrap
Bsize  = 5    ## small size, 5, for test
sigLev = 0.05 ## significance level

## Q statistics with lags from 1 to5
Qstat.sb.opt(D, vecA, 5, Bsize, sigLev)

</code></pre>

<hr>
<h2 id='sb.index'>Stationary Bootstrap Index</h2><span id='topic+sb.index'></span>

<h3>Description</h3>

<p>A subfunction for the statioanry bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sb.index(Nsize, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sb.index_+3A_nsize">Nsize</code></td>
<td>
<p>The size of the stationary bootstrap resample</p>
</td></tr>
<tr><td><code id="sb.index_+3A_gamma">gamma</code></td>
<td>
<p>A parameter for the stationary boostrap.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function resamples blocks of indicies with random block lengths.
This code follows the MATLAB file of the Oxford MFE Toolbox written by Kevin Sheppard.
</p>


<h3>Value</h3>

<p>A vector of indicies for the stationary bootstrap
</p>


<h3>Author(s)</h3>

<p>Heejoon Han, Oliver Linton, Tatsushi Oka and Yoon-Jae Whang
</p>


<h3>References</h3>

<p>The Oxford MFE toolbox (http://www.kevinsheppard.com/wiki/MFE_Toolbox) by Kevin Sheppard
</p>

<hr>
<h2 id='stock'>The Data Set of Monthly Stock Return and Sotck Variance</h2><span id='topic+stock'></span>

<h3>Description</h3>

<p>The dataset contains monthly excess stock returns and stock varaince,
which are included in the data set analyzed in Goyal and Welch (2008).
Stock returns are measured by the S&amp;P 500 index and include dividens.
A treasury-bill rate is subtracted from stock returns to give excess stock returns
The stock variance is a volatility estimate based on daily squared returns
and is treated as an estimate of equity risk in the literature.
The sample period is from Feburary 1885 to December 2005 with sample size 1,451.
</p>

<ul>
<li><p> Date:   Year-Month-Day
</p>
</li>
<li><p> Return:   excess stock returns
</p>
</li>
<li><p> Variance: stock variance
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(stock)
</code></pre>


<h3>Format</h3>

<p>A data object with two variables
</p>


<h3>References</h3>

<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>
<p>Welch, Ivo, and Amit Goyal.
&quot;A comprehensive look at the empirical performance of equity premium prediction.&quot;
<em>Review of Financial Studies</em> 21.4 (2008): 1455-1508.
</p>

<hr>
<h2 id='sys.risk'>The Data Set for Systemic Risk Analysis</h2><span id='topic+sys.risk'></span>

<h3>Description</h3>

<p>The data set contains the daily CRSP market value weighted index returns,
which are used as the market index returns in Brownless and Engle (2012), and
also includes daily stock returns on JP Morgan Chase (JPM), Goldman Sachs (GS)
and American International Group (AIG).
The sample period is from 2 Jan. 2001 to 30 Dec. 2011 with sample size 2,767.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sys.risk)
</code></pre>


<h3>Format</h3>

<p>A data object with five variables
</p>


<h3>Details</h3>


<ul>
<li><p> date:    The time index (day)
</p>
</li>
<li><p> Market: The daily CRSP market value weighted incex returns
</p>
</li>
<li><p> JPM:    stock returns on JP Morgan Chase (JPM)
</p>
</li>
<li><p> GS:     stock returns on Goldman Sachs (GS)
</p>
</li>
<li><p> AIG:    stock returns on American International Group (AIG)
</p>
</li></ul>



<h3>References</h3>

<p>Brownlees, Christian T., and Robert F. Engle. &quot;Volatility, correlation and tails for systemic risk measurement.&quot; <em>Available at SSRN</em> 1611229 (2012).
</p>
<p>Han, H., Linton, O., Oka, T., and Whang, Y. J. (2016).
&quot;The cross-quantilogram: Measuring quantile dependence and testing directional predictability between time series.&quot;
<em>Journal of Econometrics</em>, 193(1), 251-270.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
