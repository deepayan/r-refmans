<!DOCTYPE html><html><head><title>Help for package feisr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {feisr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bsfeistest'><p>Bootstrapped Regression Test</p></a></li>
<li><a href='#detrend'><p>Detrend data by individual slopes</p></a></li>
<li><a href='#feis'><p>Fixed Effects Individual Slope Estimator</p></a></li>
<li><a href='#feisr-package'><p>Estimating Fixed Effects Individual Slope Models</p></a></li>
<li><a href='#feistest'><p>Artificial Regression Test</p></a></li>
<li><a href='#model.matrix.feis'><p>model.matrix for feis objects</p></a></li>
<li><a href='#model.response.feis'><p>A function to extract the model.response</p></a></li>
<li><a href='#mwp'><p>Panel data including wages and family status</p></a></li>
<li><a href='#predict.feis'><p>Predict method for feis models</p></a></li>
<li><a href='#slopes'><p>Extract individual slopes</p></a></li>
<li><a href='#summary.feis'><p>Summary for feis objects</p></a></li>
<li><a href='#summary.feistest'><p>Summary for feistest and bsfeistest objects</p></a></li>
<li><a href='#vcov.feis'><p>Calculate Variance-Covariance Matrix for feis models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimating Fixed Effects Individual Slope Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ruettenauer/feisr">https://github.com/ruettenauer/feisr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ruettenauer/feisr/issues">https://github.com/ruettenauer/feisr/issues</a></td>
</tr>
<tr>
<td>Author:</td>
<td>Tobias Ruettenauer
    <a href="https://orcid.org/0000-0001-5747-9735"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Volker Ludwig <a href="https://orcid.org/0000-0003-3118-3172"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tobias Ruettenauer &lt;ruettenauer@sowi.uni-kl.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the function feis() to estimate fixed effects individual 
    slope (FEIS) models. The FEIS model constitutes a more general version of 
    the often-used fixed effects (FE) panel model, as implemented in the 
    package 'plm' by Croissant and Millo (2008) &lt;<a href="https://doi.org/10.18637%2Fjss.v027.i02">doi:10.18637/jss.v027.i02</a>&gt;. 
    In FEIS models, data are not only person demeaned like in conventional 
    FE models, but detrended by the predicted individual slope of each 
    person or group. Estimation is performed by applying least squares lm() 
    to the transformed data. For more details on FEIS models see Bruederl and 
    Ludwig (2015, ISBN:1446252442); Frees (2001) &lt;<a href="https://doi.org/10.2307%2F3316008">doi:10.2307/3316008</a>&gt;; 
    Polachek and Kim (1994) &lt;<a href="https://doi.org/10.1016%2F0304-4076%2894%2990075-2">doi:10.1016/0304-4076(94)90075-2</a>&gt;; 
	Ruettenauer and Ludwig (2020) &lt;<a href="https://doi.org/10.1177%2F0049124120926211">doi:10.1177/0049124120926211</a>&gt;;
    Wooldridge (2010, ISBN:0262294354). To test consistency of conventional FE 
    and random effects estimators against heterogeneous slopes, the package 
    also provides the functions feistest() for an artificial regression test 
    and bsfeistest() for a bootstrapped version of the Hausman test.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Imports:</td>
<td>Formula, plm, Rdpack, stats, dplyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>texreg (&ge; 1.37.1), testthat, knitr, rmarkdown, ggplot2</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-01 13:52:28 UTC; tobias.ruettenauer</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-01 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bsfeistest'>Bootstrapped Regression Test</h2><span id='topic+bsfeistest'></span>

<h3>Description</h3>

<p>Estimates a bootstrapped Hausman test for fixed effects individual slope models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsfeistest(
  model = NA,
  type = c("all", "bs1", "bs2", "bs3"),
  terms = NULL,
  rep = 500,
  seed = NULL,
  prog = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bsfeistest_+3A_model">model</code></td>
<td>
<p>an object of class &quot;<code>feis</code>&quot;.</p>
</td></tr>
<tr><td><code id="bsfeistest_+3A_type">type</code></td>
<td>
<p>one of &quot;<code>all</code>&quot; (the Default), &quot;<code>bs1</code>&quot; for test of FEIS against FE only,
&quot;<code>bs2</code>&quot; for test of FE against RE only, and &quot;<code>bs3</code>&quot; for test of FEIS against RE only
(see also Details).</p>
</td></tr>
<tr><td><code id="bsfeistest_+3A_terms">terms</code></td>
<td>
<p>An optional character vector specifying which coefficients should be jointly tested.
By default, all covariates are included in the Wchi-squared test. For &quot;<code>type=art2</code>&quot;, the
slope variable is always included in &quot;<code>terms</code>&quot;.</p>
</td></tr>
<tr><td><code id="bsfeistest_+3A_rep">rep</code></td>
<td>
<p>the number of repetitions to be used in bootstrapping (default is 500).</p>
</td></tr>
<tr><td><code id="bsfeistest_+3A_seed">seed</code></td>
<td>
<p>the seed used for random sampling in bootstrapping. Needs to be a valid integer.
If not specified, the current seed is used.</p>
</td></tr>
<tr><td><code id="bsfeistest_+3A_prog">prog</code></td>
<td>
<p>...    logical. If <code>TRUE</code> (the Default) shows the progress in the output window.</p>
</td></tr>
<tr><td><code id="bsfeistest_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes a bootstrapped version of the Hausman test (Hausman 1978).
Pairs cluster bootstrapping (Cameron et al. 2008; Ruettenauer and Ludwig 2020) is used to obtain the empirical
variance-covariance matrix of the estimators, either for FEIS and conventional FE, convention FE and RE,
or FEIS and RE.
</p>
<p><code>type="bs1"</code> estimates a bootstrapped Hausman test comparing fixed effects individual slope
models and conventional fixed effects models. In this case, <code>bsfeistest</code> tests for
inconsistency of the convetional FE model due to heterogeneous slopes.
<code>type="bs2"</code> estimates a bootstrapped version of the well-known Hausman test comparing conventional
fixed effects models against random effects models.
<code>type="bs3"</code> estimates a bootstrapped Hausman directly comparing FEIS against RE, thereby testing
for inconsistency of the RE model due to either heterogeneous slopes or time-constant omitted heterogeneity.
Bootstrapping is perfomed by resampling with replacement while keeping the number of groups identical to
the number of groups in the original dataset. A wald test from aod package is used to perform a Wald
chi-squared test on the differences between coefficients.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>feistest</code>&quot;, containing the following elements:
</p>
<table>
<tr><td><code>wald_feis</code></td>
<td>
<p>an object of class &quot;<code>wald.test</code>&quot;
testing the fixed effects individual slopes model against the conventional fixed effects
model (<code>type="bs1"</code>).</p>
</td></tr>
<tr><td><code>wald_fe</code></td>
<td>
<p>an object of class &quot;<code>wald.test</code>&quot;
testing the fixed effects model against the random effects model (<code>type="bs2"</code>).</p>
</td></tr>
<tr><td><code>wald_re</code></td>
<td>
<p>an object of class &quot;<code>wald.test</code>&quot;
testing the fixed effects individual slopes model against the random effects model
(<code>type="bs3"</code>).</p>
</td></tr>
<tr><td><code>vcov1</code></td>
<td>
<p>the empirical (bootstrapped) variance-covariance matrix of the
coefficients obtained from FEIS and FE (<code>type="bs1"</code>).</p>
</td></tr>
<tr><td><code>vcov2</code></td>
<td>
<p>the empirical (bootstrapped) variance-covariance matrix of the
coefficients obtained from FE and RE (<code>type="bs2"</code>).</p>
</td></tr>
<tr><td><code>vcov3</code></td>
<td>
<p>the empirical (bootstrapped) variance-covariance matrix of the
coefficients obtained from FEIS and RE (<code>type="bs3"</code>).</p>
</td></tr>
<tr><td><code>bscoef.feis</code></td>
<td>
<p>a matrix containing the estimated FEIS coefficients of each bootstrap run.</p>
</td></tr>
<tr><td><code>bscoef.fe</code></td>
<td>
<p>a matrix containing the estimated FE coefficients of each bootstrap run.</p>
</td></tr>
<tr><td><code>bscoef.re</code></td>
<td>
<p>a matrix containing the estimated RE coefficients of each bootstrap run.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class &quot;<code>Formula</code>&quot; describing the model.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the type of performed test(s).</p>
</td></tr>
<tr><td><code>sample</code></td>
<td>
<p>a list containing the IDs sampled in each run.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>the seed used for bootstrapping.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>character vector of covariates are included in the Wchi-squared test.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cameron AC, Gelbach JB, Miller DL (2008).
&ldquo;Bootstrap-Based Improvements for Inference with Clustered Errors.&rdquo;
<em>Review of Economics and Statistics</em>, <b>90</b>(3), 414&ndash;427.
ISSN 0034-6535, doi: <a href="https://doi.org/10.1162/rest.90.3.414">10.1162/rest.90.3.414</a>.<br /><br /> Hausman JA (1978).
&ldquo;Specification Tests in Econometrics.&rdquo;
<em>Econometrica</em>, <b>46</b>(6), 1251&ndash;1271.
ISSN 00129682.<br /><br /> Ruettenauer T, Ludwig V (2020).
&ldquo;Fixed Effects Individual Slopes: Accounting and Testing for Heterogeneous Effects in Panel Data or Other Multilevel Models.&rdquo;
<em>Sociological Methods and Research</em>, <b>OnlineFirst</b>.
ISSN 0049-1241, doi: <a href="https://doi.org/10.1177/0049124120926211">10.1177/0049124120926211</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.feistest">summary.feistest</a></code>, <code><a href="#topic+feistest">feistest</a></code>,
<code><a href="#topic+feis">feis</a></code>,  <code><a href="plm.html#topic+plm">plm</a></code>,
<code><a href="plm.html#topic+phtest">phtest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")
## Not run: 
feis.mod &lt;- feis(lnw ~ marry + enrol | year,
                 data = mwp, id = "id", robust = TRUE)
bsht &lt;- bsfeistest(feis.mod, type = "bs1", rep = 100, seed = 1234)
summary(bsht)

## End(Not run)

</code></pre>

<hr>
<h2 id='detrend'>Detrend data by individual slopes</h2><span id='topic+detrend'></span>

<h3>Description</h3>

<p>Detrends the input data by the predicted values based on the slope parameters within each group
specified by id. The result is equal to the transformed data used for estimation in
<code><a href="#topic+feis">feis</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detrend(
  data,
  slopes,
  id = NULL,
  intercept = TRUE,
  na.action = c("na.exlude", "na.omit"),
  tol = .Machine$double.eps,
  predicted = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detrend_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code>, <code>matrix</code>, or <code>vector</code> of data to be detrended. If <code>id</code>
and / or <code>slopes</code> are given as character (see below), must contain <code>id</code> and / or
<code>slopes</code> as variable(s). Otherwise must be excluded.</p>
</td></tr>
<tr><td><code id="detrend_+3A_slopes">slopes</code></td>
<td>
<p>a <code>data.frame</code>, <code>matrix</code>, or <code>vector</code> of slopes to be used for detrending,
not containing an intercept. Optionally, a <code>character</code> vector of the names of slope variables
in <code>data</code>. For pure de-meaning use <code>"slopes = 1"</code>.</p>
</td></tr>
<tr><td><code id="detrend_+3A_id">id</code></td>
<td>
<p>a <code>vector</code> of a unique group / person identifier. Optionally, a <code>character</code>
of the name of the unique group / person identifier in <code>data</code>. For overall detrending,
use <code>"id = 1"</code>.</p>
</td></tr>
<tr><td><code id="detrend_+3A_intercept">intercept</code></td>
<td>
<p>logical. If <code>TRUE</code> the slopes will contain an individual
intercept (default is <code>TRUE</code>). For <code>"id = 1"</code>, this is an overall intercept.
Ignored if &quot;slopes = 1&quot;.</p>
</td></tr>
<tr><td><code id="detrend_+3A_na.action">na.action</code></td>
<td>
<p>character, either <code>na.exclude</code> (default) or <code>na.omit</code> indicates the use
of <code>NA</code>s. <code>na.exclude</code> passes <code>NA</code>s through to the output (same length as input).
<code>na.omit</code> drops <code>NA</code> rows (list-wise).</p>
</td></tr>
<tr><td><code id="detrend_+3A_tol">tol</code></td>
<td>
<p>the tolerance for detecting linear dependencies in the residual maker transformation
(see <code><a href="base.html#topic+solve">solve</a></code>).</p>
</td></tr>
<tr><td><code id="detrend_+3A_predicted">predicted</code></td>
<td>
<p>logical. If <code>TRUE</code> returns the predicted values instead of the
detrended data (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="detrend_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>detrend</code> performs within-group &quot;residual maker&quot; transformation on the origin data.
Within each group, the predicted values of the columns in data are computed based on the
slope columns plus an individual intercept if <code>intercept = TRUE</code> (the default).
Subsequently the predicted values are subtracted from the origin data. The transformed
data can, for instance, be used to obtain coefficients of a fixed effects individual slopes
estimator via <code><a href="stats.html#topic+lm">lm</a></code>
(Bruederl and Ludwig 2015; Ruettenauer and Ludwig 2020; Wooldridge 2010).
</p>
<p>Estimation requires at least <code>q+1</code> observations per unit, where <code>q</code> is the number of slope
parameters (including a constant).
<code>detrend</code> automatically selects only those groups from the current data set which have
at least <code>q+1</code> observations, and returns NA for all groups with <code>n_i</code> &lt; <code>q+1</code>.
</p>
<p><code>NA</code> values in the input data are handled by list-wise deletion based on the data to be
detrended and the slopes.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>data.frame</code>&quot; or &quot;<code>numeric</code> (if only one data column),
containing the detrended data with <code>row.names</code> equal
to the <code>row.names</code> of the origin data. If input is an unnamed vector, names are 1:length.
</p>


<h3>References</h3>

<p>Bruederl J, Ludwig V (2015).
&ldquo;Fixed-Effects Panel Regression.&rdquo;
In Best H, Wolf C (eds.), <em>The Sage Handbook of Regression Analysis and Causal Inference</em>, 327&ndash;357.
Sage, Los Angeles.
ISBN 1446252442.<br /><br /> Ruettenauer T, Ludwig V (2020).
&ldquo;Fixed Effects Individual Slopes: Accounting and Testing for Heterogeneous Effects in Panel Data or Other Multilevel Models.&rdquo;
<em>Sociological Methods and Research</em>, <b>OnlineFirst</b>.
ISSN 0049-1241, doi: <a href="https://doi.org/10.1177/0049124120926211">10.1177/0049124120926211</a>.<br /><br /> Wooldridge JM (2010).
<em>Econometric Analysis of Cross Section and Panel Data</em>.
MIT Press, Cambridge, Mass.
ISBN 0262294354.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feis">feis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")

# Detrend entire data.frame
mwp_det &lt;- detrend(data = mwp, slopes = c("exp", "expq"), id = "id")

# Detrend single variable
lnw_det &lt;- detrend(data = mwp$lnw, slopes = mwp[, c("exp", "expq")], id = mwp$id)

</code></pre>

<hr>
<h2 id='feis'>Fixed Effects Individual Slope Estimator</h2><span id='topic+feis'></span><span id='topic+formula.feis'></span><span id='topic+terms.feis'></span><span id='topic+residuals.feis'></span><span id='topic+df.residual.feis'></span><span id='topic+coef.feis'></span><span id='topic+sigma.feis'></span><span id='topic+deviance.feis'></span><span id='topic+nobs.feis'></span><span id='topic+fitted.feis'></span><span id='topic+hatvalues.feis'></span>

<h3>Description</h3>

<p>Estimates fixed effects individual slope estimators by applying linear <code>lm</code> models
to &quot;detrended&quot; data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feis(
  formula,
  data,
  id,
  weights = NULL,
  robust = FALSE,
  intercept = FALSE,
  dropgroups = FALSE,
  tol = .Machine$double.eps,
  ...
)

## S3 method for class 'feis'
formula(x, lhs = NULL, rhs = NULL, ...)

## S3 method for class 'feis'
terms(x, lhs = NULL, rhs = NULL, ...)

## S3 method for class 'feis'
residuals(object, ...)

## S3 method for class 'feis'
df.residual(object, ...)

## S3 method for class 'feis'
coef(object, ...)

## S3 method for class 'feis'
sigma(object, ...)

## S3 method for class 'feis'
deviance(object, ...)

## S3 method for class 'feis'
nobs(object, ...)

## S3 method for class 'feis'
fitted(object, ...)

## S3 method for class 'feis'
hatvalues(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feis_+3A_formula">formula</code></td>
<td>
<p>a symbolic description for the model to be fitted (see Details).</p>
</td></tr>
<tr><td><code id="feis_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> containing the specified variables.</p>
</td></tr>
<tr><td><code id="feis_+3A_id">id</code></td>
<td>
<p>the name of a unique group / person identifier (as string).</p>
</td></tr>
<tr><td><code id="feis_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. See <code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code id="feis_+3A_robust">robust</code></td>
<td>
<p>logical. If <code>TRUE</code> estimates cluster robust standard errors (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="feis_+3A_intercept">intercept</code></td>
<td>
<p>logical. If <code>TRUE</code> estimates the model with an intercept (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="feis_+3A_dropgroups">dropgroups</code></td>
<td>
<p>logical. If <code>TRUE</code> groups without any within variance on a slope variable are dropped
, if <code>FALSE</code> those variables are omitted for the respective groups only (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="feis_+3A_tol">tol</code></td>
<td>
<p>the tolerance for detecting linear dependencies in the residual maker transformation
(see <code><a href="base.html#topic+solve">solve</a></code>). The argument is forwarded to <code><a href="#topic+bsfeistest">bsfeistest</a></code>.</p>
</td></tr>
<tr><td><code id="feis_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
<tr><td><code id="feis_+3A_lhs">lhs</code>, <code id="feis_+3A_rhs">rhs</code></td>
<td>
<p>indexes of the left- and right-hand side for the methods formula and terms.</p>
</td></tr>
<tr><td><code id="feis_+3A_object">object</code>, <code id="feis_+3A_x">x</code>, <code id="feis_+3A_model">model</code></td>
<td>
<p>an object of class &quot;<code>feis</code>&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>feis</code> is a special function to estimate linear fixed effects models with individual-specific slopes.
In contrast to conventional fixed effects models, data are not person &quot;demeaned&quot;, but &quot;detrended&quot; by
the predicted individual slope of each person
(Bruederl and Ludwig 2015; Ruettenauer and Ludwig 2020; Wooldridge 2010).
</p>
<p>Estimation requires at least <code>q+1</code> observations per unit, where <code>q</code> is the number of slope
parameters (including a constant).
<code>feis</code> automatically selects only those groups from the current data set which have at least <code>q+1</code> observations.
The function returns a warning if units with <code>&lt;q+1</code> observations are dropped.
</p>
<p>The function requires a two-part formula, in which the second part indicates the slope parameter(s).
If, for example, the model is <code>y ~ x1 + x2</code>, with the slope variables <code>x3</code> and <code>x4</code>,
the model can be estimated with:
</p>

<ul>
<li> <p><code>formula = y ~ x1 + x2 | x3 + x4</code>
</p>
</li></ul>

<p>To estimate a conventional fixed effects model without individual slopes, please use
<code>y ~ x1 + x2 | 1</code> to indicate that the slopes should only contain an individual-specific intercept.
</p>
<p>If specified, <code>feis</code> estimates panel-robust standard errors. Panel-robust standard errors are
robust to arbitrary forms of serial correlation within groups formed by <code>id</code> as well as
heteroscedasticity across groups (see Wooldridge 2010, pp. 379-381).
</p>
<p>The model output can be exported using the <code><a href="texreg.html#topic+texreg">texreg</a></code> package.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>feis</code>&quot;, containing the following elements:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>the vector of coefficients.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the scaled (if specified, robust) variance-covariance matrix of the coefficients.
See <code><a href="#topic+vcov.feis">vcov.feis</a></code> for unscaled vcov</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code>residuals</code></td>
<td>
<p>the vector of residuals (computed from the &quot;detrended&quot; data).</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>degrees of freedom of the residuals.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class &quot;<code>Formula</code>&quot; describing the model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the original model frame as a <code>data.frame</code> containing the original
variables used for estimation.</p>
</td></tr>
<tr><td><code>modelhat</code></td>
<td>
<p>a constructed model frame as a <code>data.frame</code> containing the predicted
values from the first stage regression using the slope variable(s) as predictor(s).</p>
</td></tr>
<tr><td><code>modeltrans</code></td>
<td>
<p>a constructed model frame as a <code>data.frame</code> containing the &quot;detrended&quot;
variables used for the final model estimation.
Note that the weights are already used for detrending if specified.</p>
</td></tr>
<tr><td><code>response</code></td>
<td>
<p>the vector of the &quot;detrended&quot; response variable.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the vector of fitted values (computed from the &quot;detrended&quot; data).</p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>a vector containing the unique person identifier.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>a vector containing weights used in fitting, or integer 1 if not speficied in call.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>assign</code></td>
<td>
<p>assign attributes of the formula.</p>
</td></tr>
<tr><td><code>na.omit</code></td>
<td>
<p>(where relevant) a vector of the omitted observations. The only handling method
of <code>NA</code>s is &quot;<code>omit</code>&quot;.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>(only where relevant) the contrasts used.</p>
</td></tr>
<tr><td><code>arg</code></td>
<td>
<p>a list containing the used methods. Only &quot;<code>feis</code>&quot; and &quot;<code>individual</code>&quot; effects available.</p>
</td></tr>
<tr><td><code>slopevars</code></td>
<td>
<p>a character vector containing the names of the slope variables.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>R squared of the &quot;detrended&quot; model.</p>
</td></tr>
<tr><td><code>adj.r2</code></td>
<td>
<p>adjusted R squared of the &quot;detrended&quot; model.</p>
</td></tr>
<tr><td><code>vcov_arg</code></td>
<td>
<p>a character containing the method used to compute the variance-covariance matrix.</p>
</td></tr>
<tr><td><code>tol</code></td>
<td>
<p>the tolerance parameter (for use in bsfeistest).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bruederl J, Ludwig V (2015).
&ldquo;Fixed-Effects Panel Regression.&rdquo;
In Best H, Wolf C (eds.), <em>The Sage Handbook of Regression Analysis and Causal Inference</em>, 327&ndash;357.
Sage, Los Angeles.
ISBN 1446252442.<br /><br /> Ruettenauer T, Ludwig V (2020).
&ldquo;Fixed Effects Individual Slopes: Accounting and Testing for Heterogeneous Effects in Panel Data or Other Multilevel Models.&rdquo;
<em>Sociological Methods and Research</em>, <b>OnlineFirst</b>.
ISSN 0049-1241, doi: <a href="https://doi.org/10.1177/0049124120926211">10.1177/0049124120926211</a>.<br /><br /> Wooldridge JM (2010).
<em>Econometric Analysis of Cross Section and Panel Data</em>.
MIT Press, Cambridge, Mass.
ISBN 0262294354.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.feis">summary.feis</a></code>, <code><a href="plm.html#topic+plm">plm</a></code>, <code><a href="plm.html#topic+pvcm">pvcm</a></code>,
<code><a href="plm.html#topic+pmg">pmg</a></code>, <code><a href="#topic+feistest">feistest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")
feis.mod &lt;- feis(lnw ~ marry + enrol + as.factor(yeargr) | exp + I(exp^2),
                 data = mwp, id = "id", robust = TRUE)
summary(feis.mod)

</code></pre>

<hr>
<h2 id='feisr-package'>Estimating Fixed Effects Individual Slope Models</h2><span id='topic+feisr-package'></span>

<h3>Description</h3>

<p>The main purpose of the package <code>feisr</code> is the estimation of fixed
effects individual slopes models and respective test statistics.
The fixed effects individual slopes (FEIS) estimator is a more general
version of the well-known fixed effects estimator (FE), which allows to
control for heterogeneous slopes in addition to time-constant heterogeneity
(Bruederl and Ludwig 2015; Ruettenauer and Ludwig 2020; Wooldridge 2010).
This is done by running an <code>lm()</code> model on pre-transformed data, where
we (1) estimate the individual-specific predicted values for the dependent
variable and each covariate based on an individual intercept and the additional
slope variables, (2) detrend the original data by these individual-specific
predicted values, and (3) run an OLS model on the residual data. The package
also provides two specification test for heterogeneous slopes
(more details and examples can be found in Ruettenauer and Ludwig 2020).
</p>


<h3>Details</h3>

<p>The main functions of the <code>feisr</code> package are:
</p>
<p>- <code>feis()</code>: fixed effects individual slopes estimator by
applying <code>lm</code> to detrended data.
</p>
<p>- <code>feistest()</code>: regression-based Hausman test for fixed effects
individual slope models.
</p>
<p>- <code>bsfeistest()</code>: bootstrapped Hausman test for fixed effects
individual slope models.
</p>
<p>The functions included in the R package <code>feisr</code> are also available in the
xtfeis ado (<a href="https://ideas.repec.org/c/boc/bocode/s458045.html">https://ideas.repec.org/c/boc/bocode/s458045.html</a>)
for Stata. The <code><a href="plm.html#topic+plm-package">plm-package</a></code> provides functions
for estimation of related models, like the mean group (MG) or common
correlated effects mean groups (CCEMG) estimator via <code><a href="plm.html#topic+pmg">pmg</a></code> or
models with variable coefficients via <code><a href="plm.html#topic+pvcm">pvcm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Tobias Ruettenauer
</p>
<p>Volker Ludwig
</p>


<h3>References</h3>

<p>Bruederl J, Ludwig V (2015).
&ldquo;Fixed-Effects Panel Regression.&rdquo;
In Best H, Wolf C (eds.), <em>The Sage Handbook of Regression Analysis and Causal Inference</em>, 327&ndash;357.
Sage, Los Angeles.
ISBN 1446252442.<br /><br /> Ruettenauer T, Ludwig V (2020).
&ldquo;Fixed Effects Individual Slopes: Accounting and Testing for Heterogeneous Effects in Panel Data or Other Multilevel Models.&rdquo;
<em>Sociological Methods and Research</em>, <b>OnlineFirst</b>.
ISSN 0049-1241, doi: <a href="https://doi.org/10.1177/0049124120926211">10.1177/0049124120926211</a>.<br /><br /> Wooldridge JM (2010).
<em>Econometric Analysis of Cross Section and Panel Data</em>.
MIT Press, Cambridge, Mass.
ISBN 0262294354.
</p>


<h3>See Also</h3>

<p><code><a href="plm.html#topic+plm">plm</a></code>, <code><a href="plm.html#topic+pvcm">pvcm</a></code>, <code><a href="plm.html#topic+pmg">pmg</a></code>
</p>

<hr>
<h2 id='feistest'>Artificial Regression Test</h2><span id='topic+feistest'></span>

<h3>Description</h3>

<p>Estimates a regression-based Hausman test for fixed effects individual slope models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feistest(
  model = NA,
  robust = FALSE,
  type = c("all", "art1", "art2", "art3"),
  terms = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feistest_+3A_model">model</code></td>
<td>
<p>an object of class &quot;<code>feis</code>&quot;.</p>
</td></tr>
<tr><td><code id="feistest_+3A_robust">robust</code></td>
<td>
<p>logical. If <code>TRUE</code> uses cluster robust standard errors (Default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="feistest_+3A_type">type</code></td>
<td>
<p>one of &quot;<code>all</code>&quot; (the Default), &quot;<code>art1</code>&quot; for test of FEIS against FE only,
&quot;<code>art2</code>&quot; for test of FE against RE only, and &quot;<code>art3</code>&quot; for test of FEIS against RE only
(see also Details).</p>
</td></tr>
<tr><td><code id="feistest_+3A_terms">terms</code></td>
<td>
<p>An optional character vector specifying which coefficients should be jointly tested.
By default, all covariates are included in the Wchi-squared test. For &quot;<code>type=art2</code>&quot;, the
slope variable is always included in &quot;<code>terms</code>&quot;.</p>
</td></tr>
<tr><td><code id="feistest_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Hausman test can be computed by estimating a correlated random effects model
(see Wooldridge 2010, pp. 328-334, Ruettenauer and Ludwig 2020). This is achieved by
estimating a Mundlak (Mundlak 1978) specification using random effects models
with <code><a href="plm.html#topic+plm">plm</a></code>.
Subsequently, <code>feistest</code> tests whether the time-constant variables / slope variables are correlated with
the unobserved heterogeneity by using a Wald chi-squared test.
</p>
<p><code>type="art1"</code> estimates an extended regression-based Hausman test comparing fixed effects
individual slope models and conventional fixed effects models. For <code>art1</code> the
Mundlak-specification (Mundlak 1978) includes the person-specific averages,
but additionally the person-specific slope estimates used for &quot;detrending&quot; in <code><a href="#topic+feis">feis</a></code>.
This allows to test whether we can omit the estimated values based on the slopes and reduce the model
to a conventional FE model. The Wald test of <code>type="art1"</code> is applied to the slope variables only.
<code>type="art2"</code> estimates the conventional regression-based Hausman test
(as described in Wooldridge 2010, pp. 328-334) comparing conventional
fixed effects models against random effects models.
<code>type="art3"</code> estimates a regression-based Hausman test comparing FEIS directly against RE,
thereby testing for inconsistency of the RE model due to either heterogeneous slopes or time-constant
omitted heterogeneity. For <code>art3</code> the Mundlak-specification includes only the person-specific
slopes, and no averages. This allows to test whether we can omit the estimated values based on
the slopes and reduce the model to a conventional RE model.
(for a formal description please see Ruettenauer and Ludwig 2020).
</p>
<p>Currently, the <code>tol</code> option in <code>feis()</code> is only forwarded in bsfeistest,
but not in feistest.
</p>
<p>If specified (<code>robust=TRUE</code>), <code>feistest</code> uses panel-robust standard errors.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>feistest</code>&quot;, containing the following elements:
</p>
<table>
<tr><td><code>wald_feis</code></td>
<td>
<p>an object of class &quot;<code>wald.test</code>&quot; testing
the fixed effects individual slopes model against the conventional fixed effects model
(<code>type="art1"</code>).</p>
</td></tr>
<tr><td><code>wald_fe</code></td>
<td>
<p>an object of class &quot;<code>wald.test</code>&quot; testing
the fixed effects model against the random effects model (<code>type="art2"</code>).</p>
</td></tr>
<tr><td><code>wald_re</code></td>
<td>
<p>an object of class &quot;<code>wald.test</code>&quot; testing
the fixed effects individual slopes model against the random effects model (<code>type="art3"</code>).</p>
</td></tr>
<tr><td><code>vcov1</code></td>
<td>
<p>the variance-covariance matrix of CREIS (<code>type="art1"</code>).</p>
</td></tr>
<tr><td><code>vcov2</code></td>
<td>
<p>the variance-covariance matrix of CRE (<code>type="art2"</code>).</p>
</td></tr>
<tr><td><code>vcov3</code></td>
<td>
<p>the variance-covariance matrix of CREIS without the means (<code>type="art3"</code>).</p>
</td></tr>
<tr><td><code>CREIS</code></td>
<td>
<p>an object of class &quot;<code>plm</code>&quot; (see <code><a href="plm.html#topic+plm">plm</a></code>) estimating a Correlated
Random Effect Individual Slope model (<code>type="art1"</code>).</p>
</td></tr>
<tr><td><code>CRE</code></td>
<td>
<p>an object of class &quot;<code>plm</code>&quot; (see <code><a href="plm.html#topic+plm">plm</a></code>) estimating a Correlated
Random Effect model (<code>type="art2"</code>).</p>
</td></tr>
<tr><td><code>CREIS2</code></td>
<td>
<p>an object of class &quot;<code>plm</code>&quot; (see <code><a href="plm.html#topic+plm">plm</a></code>) estimating a
Correlated Random Effect Individual Slope model without including the covariates' means
(<code>type="art3"</code>).</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>robust</code></td>
<td>
<p>logical. If <code>TRUE</code> cluster robust standard errors were used
(Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>an object of class &quot;<code>Formula</code>&quot; describing the model.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the type of performed test(s).</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>character vector of covariates are included in the Wchi-squared test.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mundlak Y (1978).
&ldquo;On the Pooling of Time Series and Cross Section Data.&rdquo;
<em>Econometrica</em>, <b>46</b>(1), 69.
ISSN 00129682.<br /><br /> Ruettenauer T, Ludwig V (2020).
&ldquo;Fixed Effects Individual Slopes: Accounting and Testing for Heterogeneous Effects in Panel Data or Other Multilevel Models.&rdquo;
<em>Sociological Methods and Research</em>, <b>OnlineFirst</b>.
ISSN 0049-1241, doi: <a href="https://doi.org/10.1177/0049124120926211">10.1177/0049124120926211</a>.<br /><br /> Wooldridge JM (2010).
<em>Econometric Analysis of Cross Section and Panel Data</em>.
MIT Press, Cambridge, Mass.
ISBN 0262294354.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.feistest">summary.feistest</a></code>, <code><a href="#topic+bsfeistest">bsfeistest</a></code>,
<code><a href="#topic+feis">feis</a></code>,  <code><a href="plm.html#topic+plm">plm</a></code>,
<code><a href="plm.html#topic+phtest">phtest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")
feis.mod &lt;- feis(lnw ~ marry + enrol | year,
                 data = mwp, id = "id", robust = TRUE)
ht &lt;- feistest(feis.mod, robust = TRUE, type = "all")
summary(ht)
# Only for marry coefficient
ht2 &lt;- feistest(feis.mod, robust = TRUE, type = "all", terms = c("marry"))
summary(ht2)

</code></pre>

<hr>
<h2 id='model.matrix.feis'>model.matrix for feis objects</h2><span id='topic+model.matrix.feis'></span>

<h3>Description</h3>

<p>Methods to extract transformed model matrix for &quot;<code>feis</code>&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feis'
model.matrix(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.feis_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>feis</code>&quot;.</p>
</td></tr>
<tr><td><code id="model.matrix.feis_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>model.matrix</code> for <code>feis</code> objects returns the model or design matrix
of the respective FEIS model. This is the transformed (de-trended) data,
which is used for estimation of the model in <code>lm()</code>.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>matrix</code>&quot; for <code>model.matrix</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feis">feis</a></code>, <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")
feis.mod &lt;- feis(lnw ~ marry + as.factor(yeargr) | exp,
                 data = mwp, id = "id")
mm &lt;- model.matrix(feis.mod)

</code></pre>

<hr>
<h2 id='model.response.feis'>A function to extract the model.response</h2><span id='topic+model.response.feis'></span>

<h3>Description</h3>

<p>Returns the de-trended response variable of a <code>feis</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model.response.feis(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.response.feis_+3A_x">x</code></td>
<td>
<p>an object of class <code>feis</code>.</p>
</td></tr>
<tr><td><code id="model.response.feis_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function provides a convenient way to return the model.response of a <code>feis</code> object.
This is the transformed (de-trended) variable which is used for estimation of the final model.
</p>


<h3>Value</h3>

<p>A &quot;<code>numeric</code>&quot; of the transformed response variable of the estimation model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")
feis.mod &lt;- feis(lnw ~ marry + enrol | year,
                 data = mwp, id = "id")
y_tilde &lt;- model.response.feis(feis.mod)

</code></pre>

<hr>
<h2 id='mwp'>Panel data including wages and family status</h2><span id='topic+mwp'></span>

<h3>Description</h3>

<p>A random sample from the National Longitudinal Survey of Youth
(Bureau of Labor Statistics 2014). It contains information on wages,
family status, and work experience for a random sample of men.
For a description of the original dataset and variable construction
see Ludwig and Bruederl (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mwp
</code></pre>


<h3>Format</h3>

<p>A data frame with 3100 observations and 17 variables:
</p>

<dl>
<dt>id</dt><dd><p>unique person identifier</p>
</dd>
<dt>year</dt><dd><p>survey year</p>
</dd>
<dt>lnw</dt><dd><p>natural log of hourly wage rate</p>
</dd>
<dt>exp</dt><dd><p>work experience in current job, in years</p>
</dd>
<dt>expq</dt><dd><p>work experience in current job squared</p>
</dd>
<dt>marry</dt><dd><p>family status (=0 if not married, =1 if married)</p>
</dd>
<dt>evermarry</dt><dd><p>indicator if ever married (=0 if never married, =1 if married at some point)</p>
</dd>
<dt>enrol</dt><dd><p>current erolment in education (=0 not enroled, =1 enroled)</p>
</dd>
<dt>yeduc</dt><dd><p>years of formal education</p>
</dd>
<dt>age</dt><dd><p>respondents current age</p>
</dd>
<dt>cohort</dt><dd><p>respondents birth cohort</p>
</dd>
<dt>yeargr</dt><dd><p>grouped year (1=1979-1980, 2=1981-1985, 3=1986-1990, 4=1991-1995, 5=1996-2000)</p>
</dd>
<dt>yeargr1</dt><dd><p>dummy indicating grouped year=1</p>
</dd>
<dt>yeargr2</dt><dd><p>dummy indicating grouped year=2</p>
</dd>
<dt>yeargr3</dt><dd><p>dummy indicating grouped year=3</p>
</dd>
<dt>yeargr4</dt><dd><p>dummy indicating grouped year=4</p>
</dd>
<dt>yeargr5</dt><dd><p>dummy indicating grouped year=5</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ludwig and Bruederl (2018)
</p>


<h3>References</h3>

<p>Bureau of Labor Statistics (2014).
<em>National Longitudinal Survey of Youth 1979 Cohort, 1979-2012 (rounds 1-23)</em>.
Center for Human Resource Research, The Ohio State University, Columbus, OH.<br /><br /> Ludwig V, Bruederl J (2018).
&ldquo;Is There a Male Marital Wage Premium? New Evidence from the United States.&rdquo;
<em>American Sociological Review</em>, <b>83</b>(4), 744&ndash;770.
ISSN 0003-1224, doi: <a href="https://doi.org/10.1177/0003122418784909">10.1177/0003122418784909</a>.
</p>

<hr>
<h2 id='predict.feis'>Predict method for feis models</h2><span id='topic+predict.feis'></span>

<h3>Description</h3>

<p>Predicted values based on linear model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feis'
predict(
  object,
  newdata = NULL,
  se.fit = FALSE,
  vcov = NULL,
  interval = c("none", "confidence", "prediction"),
  level = 0.95,
  pred.var = sigma_sq,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.feis_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>feis</code>&quot;, fitted model.</p>
</td></tr>
<tr><td><code id="predict.feis_+3A_newdata">newdata</code></td>
<td>
<p>an optional data frame in which to look for variables with which to predict.
If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predict.feis_+3A_se.fit">se.fit</code></td>
<td>
<p>a switch indicating if standard errors are required.</p>
</td></tr>
<tr><td><code id="predict.feis_+3A_vcov">vcov</code></td>
<td>
<p>optional variance-covariance matrix for std.err. calculation.</p>
</td></tr>
<tr><td><code id="predict.feis_+3A_interval">interval</code></td>
<td>
<p>type of interval calculation.</p>
</td></tr>
<tr><td><code id="predict.feis_+3A_level">level</code></td>
<td>
<p>tolerance/confidence level.</p>
</td></tr>
<tr><td><code id="predict.feis_+3A_pred.var">pred.var</code></td>
<td>
<p>the variance for future observations to be assumed for prediction intervals.
By default, equals the residual variance</p>
</td></tr>
<tr><td><code id="predict.feis_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predict.lm</code> produces predicted values, obtained by evaluating the regression function
in the frame newdata (which defaults to <code>model.matrix(object)</code>). If the logical <code>se.fit</code> is
<code>TRUE</code>, standard errors of the predictions are calculated. If the <code>vcov</code> is not provided,
the <code>object$vcov</code> is used, thus allowing for robust variance-covariance matrices.
Setting intervals specifies computation of confidence or prediction (tolerance) intervals
at the specified <code>level</code>.
</p>
<p><b>Note</b>: Currently, predictions are based on the transformed (de-trended) data.
</p>


<h3>Value</h3>

<p>A vector of predictions or a matrix of predictions and bounds with column names
<code>fit</code>, <code>lwr</code>, and <code>upr</code> if <code>interval</code> is set.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+predict.lm">predict.lm</a>, <a href="stats.html#topic+predict">predict</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>feis.mod &lt;- feis(lnw ~ age | exp,
data = mwp, id = "id", robust = TRUE)

new &lt;- data.frame(age = seq(-10, 10, 1))
feis.pred &lt;- predict(feis.mod, newdata = new,
                     se.fit = TRUE, interval = "confidence")

## Not run: 
matplot(new$age, feis.pred$fit, lty = c(1,2,2),
        type = "l", ylab = "predicted y")

## End(Not run)

</code></pre>

<hr>
<h2 id='slopes'>Extract individual slopes</h2><span id='topic+slopes'></span>

<h3>Description</h3>

<p>Extracts the individual slopes (<code>alpha_i</code>) from a <code>feis</code> object created by
<code><a href="#topic+feis">feis</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes(model = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slopes_+3A_model">model</code></td>
<td>
<p>an object of class &quot;<code>feis</code>&quot;.</p>
</td></tr>
<tr><td><code id="slopes_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function extracts a matrix containing the individual slope parameters (<code>alpha_i</code>),
which equals the coefficient(s) of regressing the depenent variable on the slope parameter(s).
</p>
<p>If slope variables are perfectly collinear within a cluster, one variable is dropped
and the function returns <code>0</code> for the respective slope and cluster.
</p>


<h3>Value</h3>

<p>An <code>N x J</code> matrix containing the individual slopes for each cluster unit <code>N</code>
and slope variable <code>J</code>. Rownames indicate the cluster id.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Produc", package = "plm")
feis.mod &lt;- feis("log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp | year",
                 data = Produc, id = "state", robust = TRUE)
slps &lt;- slopes(feis.mod)

</code></pre>

<hr>
<h2 id='summary.feis'>Summary for feis objects</h2><span id='topic+summary.feis'></span><span id='topic+print.summary.feis'></span>

<h3>Description</h3>

<p>The summary method for feis objects generates some additional information
about estimated feis models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feis'
summary(object, vcov = NULL, ...)

## S3 method for class 'summary.feis'
print(
  x,
  digits = max(3, getOption("digits") - 2),
  width = getOption("width"),
  subset = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.feis_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>feis</code>&quot;.</p>
</td></tr>
<tr><td><code id="summary.feis_+3A_vcov">vcov</code></td>
<td>
<p>a variance-covariance matrix furnished by the user or a function to calculate one.</p>
</td></tr>
<tr><td><code id="summary.feis_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
<tr><td><code id="summary.feis_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>summary.feis</code>&quot;.</p>
</td></tr>
<tr><td><code id="summary.feis_+3A_digits">digits</code></td>
<td>
<p>number of digits for printed output.</p>
</td></tr>
<tr><td><code id="summary.feis_+3A_width">width</code></td>
<td>
<p>the maximum length of the lines in the printed output.</p>
</td></tr>
<tr><td><code id="summary.feis_+3A_subset">subset</code></td>
<td>
<p>a character or numeric vector indicating a subset of
the table of coefficients to be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>summary.feis</code>&quot;, containing the elements
of the feis object (see <code><a href="#topic+feis">feis</a></code>). The object is forwarded to
print method. The following objects are modified:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a matrix with the estimated coefficients, standard errors,
t-values, and p-values, if argument vcov is NULL the standard errors
are calculated by the <code>vcov</code> in the input object.</p>
</td></tr>
<tr><td><code>r.squared</code></td>
<td>
<p>a vector containing R squared and adjusted R squared.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+feis">feis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")
feis.mod &lt;- feis(lnw ~ marry | exp,
                 data = mwp, id = "id")
summary(feis.mod)

</code></pre>

<hr>
<h2 id='summary.feistest'>Summary for feistest and bsfeistest objects</h2><span id='topic+summary.feistest'></span><span id='topic+print.summary.feistest'></span><span id='topic+summary.bsfeistest'></span><span id='topic+print.summary.bsfeistest'></span>

<h3>Description</h3>

<p>The summary method for feistest and bsfeistest objects prints the results
of Artificial Regression Tests or Bootstrapped Hausman Tests for FEIS models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feistest'
summary(object, ...)

## S3 method for class 'summary.feistest'
print(
  x,
  digits = max(3, getOption("digits") - 2),
  width = getOption("width"),
  ...
)

## S3 method for class 'bsfeistest'
summary(object, ...)

## S3 method for class 'summary.bsfeistest'
print(
  x,
  digits = max(3, getOption("digits") - 2),
  width = getOption("width"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.feistest_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>feistest</code>&quot; or &quot;<code>bsfeistest</code>&quot;.</p>
</td></tr>
<tr><td><code id="summary.feistest_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
<tr><td><code id="summary.feistest_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>summary.feistest</code>&quot; or &quot;<code>summary.bsfeistest</code>&quot;.</p>
</td></tr>
<tr><td><code id="summary.feistest_+3A_digits">digits</code></td>
<td>
<p>number of digits for printed output.</p>
</td></tr>
<tr><td><code id="summary.feistest_+3A_width">width</code></td>
<td>
<p>the maximum length of the lines in the printed output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>summary.feistest</code>&quot; or &quot;<code>summary.bsfeistest</code>&quot;,
equal to the original input object (see <code><a href="#topic+feistest">feistest</a></code> and
<code><a href="#topic+bsfeistest">bsfeistest</a></code>). The object is forwarded to print method.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feistest">feistest</a></code>, <code><a href="#topic+bsfeistest">bsfeistest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")
feis.mod &lt;- feis(lnw ~ marry | exp,
                 data = mwp, id = "id")
ht &lt;- feistest(feis.mod, robust = TRUE, type = "all")
summary(ht)

</code></pre>

<hr>
<h2 id='vcov.feis'>Calculate Variance-Covariance Matrix for feis models</h2><span id='topic+vcov.feis'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the main parameters of an object of class &quot;<code>feis</code>&quot;.
By default, this is the unscaled variance-covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feis'
vcov(object, ..., scale = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.feis_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>feis</code>&quot;, fitted model.</p>
</td></tr>
<tr><td><code id="vcov.feis_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
<tr><td><code id="vcov.feis_+3A_scale">scale</code></td>
<td>
<p>logical. If <code>TRUE</code> returns scaled vcov by sigma^2 (default is <code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, <code>vcov()</code> return the unscaled variance-covariance matrix of the fitted FEIS model.
If set to <code>scale = TRUE</code>, the vcov is scaled by the nuisance parameter sigma^2
(as is <code>object$vcov</code>). Note that corrections for clustering (i.e. <code>robust = TRUE</code>
in the fitted model) are ignored in <code>vcov()</code>. In this case, <code>object$vcov</code> will return
the vcov with corrections for clustering.
</p>


<h3>Value</h3>

<p>A matrix of the estimated covariances between the parameter estimates in the fitted FEIS model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feis">feis</a></code>, <code><a href="stats.html#topic+vcov">vcov</a></code>, <code><a href="stats.html#topic+sigma">sigma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mwp", package = "feisr")
feis.mod &lt;- feis(lnw ~ marry + enrol | exp,
                 data = mwp, id = "id")
vcov(feis.mod)
all.equal(vcov(feis.mod), feis.mod$vcov) # FALSE: not equal, because vcov() unscaled
all.equal(vcov(feis.mod, scale = TRUE), feis.mod$vcov) # equal

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
