<!DOCTYPE html><html><head><title>Help for package neonSoilFlux</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {neonSoilFlux}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#neonSoilFlux-package'><p>neonSoilFlux: Compute Soil Carbon Fluxes for the National Ecological Observatory Network Sites</p></a></li>
<li><a href='#acquire_neon_data'><p>Acquire NEON data for processing</p></a></li>
<li><a href='#check_qf_flags'><p>Internal helper function to determine availability of data within a time interval</p></a></li>
<li><a href='#co2_to_umol'><p>Convert co2 concentration from ppm to µmol m-3 units</p></a></li>
<li><a href='#compute_monthly_mean'><p>Function to compute monthly means for a given month of NEON data.</p></a></li>
<li><a href='#compute_neon_flux'><p>Compute NEON fluxes at a site</p></a></li>
<li><a href='#compute_surface_flux'><p>Internal fucntion to compute CO2 surface flux</p></a></li>
<li><a href='#correct_env_data'><p>Internal function that prepares downloaded NEON data for flux processing</p></a></li>
<li><a href='#dejong_shappert_flux'><p>Internal function to compute surface co2 flux at a given timepoint via De Jong and Schappert (1972)</p></a></li>
<li><a href='#depth_interpolate'><p>Internal function to interpolate different depth measurements</p></a></li>
<li><a href='#determine_position'><p>Internal function to determine the depth of a measurement</p></a></li>
<li><a href='#diffusivity'><p>Compute soil diffusivity</p></a></li>
<li><a href='#env_fingerprint_plot'><p>Helper function to plot QF results for environmental measurements.</p></a></li>
<li><a href='#fit_function'><p>Internal function that interpolates a soil measurement to different depths</p></a></li>
<li><a href='#flux_fingerprint_plot'><p>Helper function to plot QF results for fluxes.</p></a></li>
<li><a href='#hirano_flux'><p>Internal function to compute surface co2 flux at a given timepoint via Hirano et al 2005</p></a></li>
<li><a href='#insert_mean'><p>Internal function that inserts smoothed mean value of a measurement at a site</p></a></li>
<li><a href='#inside_interval'><p>Determine if a YYYY-MM string is inside a interval</p></a></li>
<li><a href='#measurement_detect'><p>Internal function that makes sure for each time, position, and depth we have at least two data points for soil temp and soil h20, 3 for soil co2</p></a></li>
<li><a href='#measurement_merge'><p>Internal function that filters environmental data for easier processing of fluxes.</p></a></li>
<li><a href='#quadrature_error'><p>Helper function to quickly compute the quadrature error</p></a></li>
<li><a href='#sjer_env_data_2022_06'><p>Measured environmental data at a NEON site</p></a></li>
<li><a href='#sjer_flux_2022_06'><p>Computed flux values at a NEON site</p></a></li>
<li><a href='#sjer_megapit_data_2022_06'><p>Measured soil physical properties at a NEON site</p></a></li>
<li><a href='#swc_correct'><p>Internal function to correct depths for VSWC NEON data.</p></a></li>
<li><a href='#swc_corrections'><p>Corrected sensor locations for NEON soil water content data</p></a></li>
<li><a href='#tang_2003_flux'><p>Internal function to compute surface co2 flux at a given timepoint via Tang et al 2003</p></a></li>
<li><a href='#tang_2005_flux'><p>Internal function to compute surface co2 flux at a given timepoint via Tang et al 2005</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Compute Soil Carbon Fluxes for the National Ecological
Observatory Network Sites</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Acquires and synthesizes soil carbon fluxes at sites located in the National Ecological Observatory Network (NEON). Provides flux estimates and associated uncertainty as well as key environmental measurements (soil water, temperature, CO2  concentration) that are used to compute soil fluxes.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jmzobitz/neonSoilFlux">https://github.com/jmzobitz/neonSoilFlux</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jmzobitz/neonSoilFlux/issues">https://github.com/jmzobitz/neonSoilFlux/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, lubridate, neonUtilities, purrr, stats,
stringr, tibble, tidyr, tidyselect</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-23 23:21:28 UTC; zobitz</td>
</tr>
<tr>
<td>Author:</td>
<td>John Zobitz <a href="https://orcid.org/0000-0002-1830-143X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Edward Ayres <a href="https://orcid.org/0000-0003-1846-1473"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Katie O'Rourke [ctb] (LinkedIn,
    &lt;https://www.linkedin.com/in/katie-o-rourke-5a898b194/&gt;),
  Zoey Werbin [ctb],
  Lajntxiag Lee [ctb],
  Ridwan Abdi [ctb] (LinkedIn,
    &lt;https://www.linkedin.com/in/ridwaan-cabdi/&gt;),
  Dijonë Mehmeti [ctb] (LinkedIn,
    &lt;https://www.linkedin.com/in/dijon%C3%AB-mehmeti/&gt;),
  Ly Xiong [ctb] (LinkedIn,
    &lt;https://www.linkedin.com/in/ly-xiong-bb83ba1b2/&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Zobitz &lt;zobitz@augsburg.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-25 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='neonSoilFlux-package'>neonSoilFlux: Compute Soil Carbon Fluxes for the National Ecological Observatory Network Sites</h2><span id='topic+neonSoilFlux'></span><span id='topic+neonSoilFlux-package'></span>

<h3>Description</h3>

<p>Acquires and synthesizes soil carbon fluxes at sites located in the National Ecological Observatory Network (NEON). Provides flux estimates and associated uncertainty as well as key environmental measurements (soil water, temperature, CO2 concentration) that are used to compute soil fluxes.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a> (<a href="https://orcid.org/0000-0002-1830-143X">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Edward Ayres <a href="mailto:eayres@battelleecology.org">eayres@battelleecology.org</a> (<a href="https://orcid.org/0000-0003-1846-1473">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Katie O'Rourke (LinkedIn, &lt;https://www.linkedin.com/in/katie-o-rourke-5a898b194/&gt;) [contributor]
</p>
</li>
<li><p> Zoey Werbin <a href="mailto:zrwerbin@bu.edu">zrwerbin@bu.edu</a> [contributor]
</p>
</li>
<li><p> Lajntxiag Lee <a href="mailto:lajntxiag@alumni.augsburg.edu">lajntxiag@alumni.augsburg.edu</a> [contributor]
</p>
</li>
<li><p> Ridwan Abdi (LinkedIn, &lt;https://www.linkedin.com/in/ridwaan-cabdi/&gt;) [contributor]
</p>
</li>
<li><p> Dijonë Mehmeti (LinkedIn, &lt;https://www.linkedin.com/in/dijon
</p>
</li>
<li><p> Ly Xiong (LinkedIn, &lt;https://www.linkedin.com/in/ly-xiong-bb83ba1b2/&gt;) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/jmzobitz/neonSoilFlux">https://github.com/jmzobitz/neonSoilFlux</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/jmzobitz/neonSoilFlux/issues">https://github.com/jmzobitz/neonSoilFlux/issues</a>
</p>
</li></ul>


<hr>
<h2 id='acquire_neon_data'>Acquire NEON data for processing</h2><span id='topic+acquire_neon_data'></span>

<h3>Description</h3>

<p>Given a site code and dates, apply the neonUtilities package to download the data from NEON API
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acquire_neon_data(
  site_name,
  download_date,
  time_frequency = "30_minute",
  provisional = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acquire_neon_data_+3A_site_name">site_name</code></td>
<td>
<p>Required. NEON code for a particular site (a string)</p>
</td></tr>
<tr><td><code id="acquire_neon_data_+3A_download_date">download_date</code></td>
<td>
<p>Required. Date where we end getting NEON data. Format: YYYY-MM (can't specify day).  So &quot;2020-05&quot; means it will grab data for the entire 5th month of 2020. (a string). Downloads data for a given month only</p>
</td></tr>
<tr><td><code id="acquire_neon_data_+3A_time_frequency">time_frequency</code></td>
<td>
<p>Required. Will you be using 30 minute (&quot;30_minute&quot;) or 1 minute (&quot;1_minute&quot;) recorded data? Defaults to 30 minutes.</p>
</td></tr>
<tr><td><code id="acquire_neon_data_+3A_provisional">provisional</code></td>
<td>
<p>Required. Should you use provisional data when downloading? Defaults to FALSE. See <a href="https://www.neonscience.org/data-samples/data-management/data-revisions-releases">NEON Data Releases</a>. Defaults to FALSE (similar to include.provisional in <a href="neonUtilities.html#topic+loadByProduct">loadByProduct</a>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing stacked environmental data ('site_data') and soil properties ('site_megapit').
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
out_env_data &lt;- acquire_neon_data("SJER","2022-06")

</code></pre>

<hr>
<h2 id='check_qf_flags'>Internal helper function to determine availability of data within a time interval</h2><span id='topic+check_qf_flags'></span>

<h3>Description</h3>

<p>Given a data measurement, determine when a monthly mean is used and the bulk QF flags. Helps to determine when the environmental measurements produced a QF value and to be used in subsequent flux calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_qf_flags(measurement_name, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_qf_flags_+3A_measurement_name">measurement_name</code></td>
<td>
<p>The name of the measurement (staPres, soilTemp, VSWC, soilCO2Concentration)</p>
</td></tr>
<tr><td><code id="check_qf_flags_+3A_data">data</code></td>
<td>
<p>Data used to check the qf flags</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of startDateTime, horizontalPosition, and the associated QF flag.
</p>
<p># changelog and author contributions / copyrights
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>

<hr>
<h2 id='co2_to_umol'>Convert co2 concentration from ppm to µmol m-3 units</h2><span id='topic+co2_to_umol'></span>

<h3>Description</h3>

<p>Given a measurement of co2, convert it from ppm to umol m-3 based on temperature and pressure. Also compute associated error via quadrature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_to_umol(
  temperature,
  pressure,
  co2,
  temperature_err,
  pressure_err,
  co2_err,
  zOffset
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="co2_to_umol_+3A_temperature">temperature</code></td>
<td>
<p>Required. Soil temperature (degrees C)</p>
</td></tr>
<tr><td><code id="co2_to_umol_+3A_pressure">pressure</code></td>
<td>
<p>Required. Barometric air pressure (kilopascal)</p>
</td></tr>
<tr><td><code id="co2_to_umol_+3A_co2">co2</code></td>
<td>
<p>Carbon dioxide in ppm</p>
</td></tr>
<tr><td><code id="co2_to_umol_+3A_temperature_err">temperature_err</code></td>
<td>
<p>Required. Reported Soil temperature error (degrees C)</p>
</td></tr>
<tr><td><code id="co2_to_umol_+3A_pressure_err">pressure_err</code></td>
<td>
<p>Required. Reported Barometric air pressure error (kilopascal)</p>
</td></tr>
<tr><td><code id="co2_to_umol_+3A_co2_err">co2_err</code></td>
<td>
<p>Required. Carbon dioxide in ppm error</p>
</td></tr>
<tr><td><code id="co2_to_umol_+3A_zoffset">zOffset</code></td>
<td>
<p>Required. Surface depth (m). Reported as a negative number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of the converted co2
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>co2_to_umol(31,96.3,654,.15,.05,9,-.05)
</code></pre>

<hr>
<h2 id='compute_monthly_mean'>Function to compute monthly means for a given month of NEON data.</h2><span id='topic+compute_monthly_mean'></span>

<h3>Description</h3>

<p>Given a NEON measurement data frame calculate the monthly mean values across all horizontal and vertical locations. Based off code from Zoey Werbin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_monthly_mean(
  NEON_data,
  position_columns = c("horizontalPosition", "verticalPosition")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_monthly_mean_+3A_neon_data">NEON_data</code></td>
<td>
<p>Required. Input vector of neon measurements for a month</p>
</td></tr>
<tr><td><code id="compute_monthly_mean_+3A_position_columns">position_columns</code></td>
<td>
<p>Optional. Do we group by horizontalPosition, verticalPosition, and? Default is both. Added this option in case we just want to average across a given dimension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame that reports for each horiztonal and vertical position the computed mean and standard deviation from sampling (similar to a bootstrap method) as well as the sample mean and sample standard deviation
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>References</h3>

<p>Zoey Werbin (@zoey-rw): original author https://github.com/zoey-rw/microbialForecasts/blob/caa7b1a8aa8a131a5ff9340f1562cd3a3cb6667b/data_construction/covariate_prep/soil_moisture/clean_NEON_sensor_moisture_data.r
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Download the NEON data directly - here this would be soil moisture
NEON_moist_30m_orig &lt;- neonUtilities::loadByProduct(
  dpID = "DP1.00094.001",
  site = "WREF",
  startdate = "2022-06",
  enddate = "2022-06",
  timeIndex = "30",
  package = "expanded",
  check.size = FALSE,
  include.provisional = TRUE
)


# Then correct the swc
site_swc &lt;- swc_correct(NEON_moist_30m_orig, "WREF","2022-06")

# Select the columns and the time frequency
time_frequency &lt;- "30_minute"
column_selectors &lt;- c("Mean", "Minimum", "Maximum", "ExpUncert", "StdErMean")

    swc &lt;- site_swc |&gt;
    purrr::pluck(paste0("SWS_",time_frequency)) |&gt;
    dplyr::select(tidyselect::all_of(c("domainID","siteID",
    "horizontalPosition","verticalPosition","startDateTime","VSWCFinalQF")),
    tidyselect::matches(stringr::str_c("VSWC",column_selectors)))

  # Determine a data frame of the different horizontal and vertical positions
  swc_positions &lt;- site_swc |&gt;
  purrr::pluck(paste0("sensor_positions_","00094"))

  # Add on the positions for swc
  swc &lt;- determine_position(swc_positions,swc)
  
</code></pre>

<hr>
<h2 id='compute_neon_flux'>Compute NEON fluxes at a site</h2><span id='topic+compute_neon_flux'></span>

<h3>Description</h3>

<p>Given a site filename (from acquire_neon_data), process and compute fluxes.
This file takes a saved data file from acquire:
1) Takes the needed components (QF and measurement flags) for soil water, temperature, co2, binding them together in a tidy data frame
2) Interpolates across the measurements
3) Merges air pressure data into this data frame
4) Does a final QF check so we should have only timeperiods where all measurements exist
5) Adds in the megapit data so we have bulk density, porosity measurements at the interpolated depth.
6) Saves the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_neon_flux(input_site_env, input_site_megapit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_neon_flux_+3A_input_site_env">input_site_env</code></td>
<td>
<p>Required. Input list of environmental data.  Usually given from acquire_neon_data</p>
</td></tr>
<tr><td><code id="compute_neon_flux_+3A_input_site_megapit">input_site_megapit</code></td>
<td>
<p>Required. Input list of environmental soil data.  Usually given from acquire_neon_data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of fluxes and gradient from the timeperiod
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
based on code developed by Edward Ayres <a href="mailto:eayres@battelleecology.org">eayres@battelleecology.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # First acquire the NEON data at a given NEON site
out_env_data &lt;- acquire_neon_data("SJER","2020-05")

# Then process and compute the fluxes:
 out_flux &lt;- compute_neon_flux(input_site_env = sjer_env_data_2022_06,
 input_site_megapit = sjer_megapit_data_2022_06)

</code></pre>

<hr>
<h2 id='compute_surface_flux'>Internal fucntion to compute CO2 surface flux</h2><span id='topic+compute_surface_flux'></span>

<h3>Description</h3>

<p>Computation function. Given a measurement of the co2 and diffusive flux at different levels, return the surface flux
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_surface_flux(input_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_surface_flux_+3A_input_data">input_data</code></td>
<td>
<p>Required. A data frame containing zOffsets, diffusivity, and co2 (umol mol-1) and their associated errors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of the surface CO2 flux (umol m-2 s-1)
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>

<hr>
<h2 id='correct_env_data'>Internal function that prepares downloaded NEON data for flux processing</h2><span id='topic+correct_env_data'></span>

<h3>Description</h3>

<p>This file takes data frame from acquire_neon_data and:
1) Takes the needed components (QF and measurement flags) for soil water, temperature, co2, binding them together in a tidy data frame
2) Interpolates across the measurements
3) Merges air pressure data into this data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct_env_data(input_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correct_env_data_+3A_input_data">input_data</code></td>
<td>
<p>Required. Nested data frame from acquire_neon_data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of all QF flags over time period and Data frame of environmental measurements for flux computation
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Note: you may need to first aqcuire the NEON data using acquire_neon_data
# Now correct existing environmental data:
corrected_data &lt;- correct_env_data(sjer_env_data_2022_06)

</code></pre>

<hr>
<h2 id='dejong_shappert_flux'>Internal function to compute surface co2 flux at a given timepoint via De Jong and Schappert (1972)</h2><span id='topic+dejong_shappert_flux'></span>

<h3>Description</h3>

<p>Given  zOffsets, diffusivity, and co2 (umol mol-1) and their associated errors, compute the surface flux. This is done by estimating the surface concentration (through linear regression) and doing a gradient calculation. Modified from De Jong and Schappert (1972).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dejong_shappert_flux(zOffset, co2, co2_err, diffusive, diffusive_err)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dejong_shappert_flux_+3A_zoffset">zOffset</code></td>
<td>
<p>Required. depths below surface - assumed to be positive in value. Important for directionality!</p>
</td></tr>
<tr><td><code id="dejong_shappert_flux_+3A_co2">co2</code></td>
<td>
<p>Required. co2 at depth (umol m&ndash;1)</p>
</td></tr>
<tr><td><code id="dejong_shappert_flux_+3A_co2_err">co2_err</code></td>
<td>
<p>Required. Associated errors with that value of co2</p>
</td></tr>
<tr><td><code id="dejong_shappert_flux_+3A_diffusive">diffusive</code></td>
<td>
<p>Required. diffusivity at each depth</p>
</td></tr>
<tr><td><code id="dejong_shappert_flux_+3A_diffusive_err">diffusive_err</code></td>
<td>
<p>Required Associated errors with diffusivity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of fluxes associated error
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>References</h3>

<p>Jong, E. De, and H. J. V. Schappert. 1972. “Calculation of Soil Respiration and Activity from CO2 Profiles in the Soil.” Soil Science 113 (5): 328.
</p>
<p>Maier, M., and H. Schack-Kirchner. 2014. “Using the Gradient Method to Determine Soil Gas Flux: A Review.” Agricultural and Forest Meteorology 192–193 (July):78–95. https://doi.org/10.1016/j.agrformet.2014.03.006.
</p>


<h3>See Also</h3>

<p>[hirano_flux()], [tang_2003_flux()], [tang_2005_flux()] for other ways to compute surface fluxes.
</p>

<hr>
<h2 id='depth_interpolate'>Internal function to interpolate different depth measurements</h2><span id='topic+depth_interpolate'></span>

<h3>Description</h3>

<p>Definition function. Linearly interpolate a measurement across the different measurement depths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>depth_interpolate(
  input_measurements,
  measurement_name,
  measurement_interpolate
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="depth_interpolate_+3A_input_measurements">input_measurements</code></td>
<td>
<p>Required. Nested data frame (tibble of a months worth of data of co2, temperature, swc, pressure)</p>
</td></tr>
<tr><td><code id="depth_interpolate_+3A_measurement_name">measurement_name</code></td>
<td>
<p>Required. Names of measurements we are interpolating. Currently only does one column at a time.</p>
</td></tr>
<tr><td><code id="depth_interpolate_+3A_measurement_interpolate">measurement_interpolate</code></td>
<td>
<p>Required. Names of measurement whose depth is used to interpolate (typically co2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nested data frame with interpolated measurements.
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
based on code developed by Edward Ayres <a href="mailto:eayres@battelleecology.org">eayres@battelleecology.org</a>
</p>

<hr>
<h2 id='determine_position'>Internal function to determine the depth of a measurement</h2><span id='topic+determine_position'></span>

<h3>Description</h3>

<p>Given a NEON measurement data frame and measurement depth, pull out the measurement depth for a measurement - because it may vary in time based on if a sensor is replaced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>determine_position(input_positions, input_measurement)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="determine_position_+3A_input_positions">input_positions</code></td>
<td>
<p>Required. Input vector of measurements depths</p>
</td></tr>
<tr><td><code id="determine_position_+3A_input_measurement">input_measurement</code></td>
<td>
<p>Required. Input vector of measurements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame that reports the measurement depth for and associated environmental measurement.
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>

<hr>
<h2 id='diffusivity'>Compute soil diffusivity</h2><span id='topic+diffusivity'></span>

<h3>Description</h3>

<p>Given a tidied data frame of soil measurements (from interpolate.R), compute the diffusivity in a given soil layer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diffusivity(
  temperature,
  soil_water,
  pressure,
  temperature_err,
  soil_water_err,
  pressure_err,
  zOffset,
  porVol2To20
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diffusivity_+3A_temperature">temperature</code></td>
<td>
<p>Required. Soil temperature (degrees C)</p>
</td></tr>
<tr><td><code id="diffusivity_+3A_soil_water">soil_water</code></td>
<td>
<p>Required. Soil water content</p>
</td></tr>
<tr><td><code id="diffusivity_+3A_pressure">pressure</code></td>
<td>
<p>Required. Barometric air pressure (kilopascal)</p>
</td></tr>
<tr><td><code id="diffusivity_+3A_temperature_err">temperature_err</code></td>
<td>
<p>Required. Reported Soil temperature error (degrees C)</p>
</td></tr>
<tr><td><code id="diffusivity_+3A_soil_water_err">soil_water_err</code></td>
<td>
<p>Required. Reported Soil water content error</p>
</td></tr>
<tr><td><code id="diffusivity_+3A_pressure_err">pressure_err</code></td>
<td>
<p>Required. Reported Barometric air pressure error (kilopascal)</p>
</td></tr>
<tr><td><code id="diffusivity_+3A_zoffset">zOffset</code></td>
<td>
<p>Required. Measurement level in cm.</p>
</td></tr>
<tr><td><code id="diffusivity_+3A_porvol2to20">porVol2To20</code></td>
<td>
<p>Required. Porosity of the 0-20 mm fraction (cm3 cm-3). Assumes no pores within rocks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of the computed diffusivity
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>diffusivity(31,0.0102,96.3,.15,.2135,.05,-.05,0.45)
</code></pre>

<hr>
<h2 id='env_fingerprint_plot'>Helper function to plot QF results for environmental measurements.</h2><span id='topic+env_fingerprint_plot'></span>

<h3>Description</h3>

<p>Given a flux measurement data frame, show when the environmental measurements produced a QF value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>env_fingerprint_plot(input_fluxes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="env_fingerprint_plot_+3A_input_fluxes">input_fluxes</code></td>
<td>
<p>data frame of computed fluxes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot graph where we have ordered factors showing the QA values a given environmental measurement
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Make a fingerprint plot for environmental variables:
env_fingerprint_plot(sjer_flux_2022_06)
</code></pre>

<hr>
<h2 id='fit_function'>Internal function that interpolates a soil measurement to different depths</h2><span id='topic+fit_function'></span>

<h3>Description</h3>

<p>Definition function. Linearly interpolate a measurement across the different measurement depths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_function(
  input_depth,
  input_value,
  input_value_err,
  input_value_qf,
  interp_depth,
  measurement_special
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_function_+3A_input_depth">input_depth</code></td>
<td>
<p>Required. Vector of measurement depths.</p>
</td></tr>
<tr><td><code id="fit_function_+3A_input_value">input_value</code></td>
<td>
<p>Required. Vector of measured values (i.e. soil temperature and soil water) measured at depths input_depth</p>
</td></tr>
<tr><td><code id="fit_function_+3A_input_value_err">input_value_err</code></td>
<td>
<p>Required. Vector or reported measurement errors. Used to compute prediction error (via quadrature) when linear interpolation is used.</p>
</td></tr>
<tr><td><code id="fit_function_+3A_input_value_qf">input_value_qf</code></td>
<td>
<p>Required. Vector of qf values from the smoothing 0 = no smoothing, 1 = mean value used (smoothing), 2 = NA value</p>
</td></tr>
<tr><td><code id="fit_function_+3A_interp_depth">interp_depth</code></td>
<td>
<p>Depths of the sensors required for interpolation</p>
</td></tr>
<tr><td><code id="fit_function_+3A_measurement_special">measurement_special</code></td>
<td>
<p>Flag if we want to just do linear interpolation for a given measurement</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of the depth and the measured column for the measurements and reported error
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
based on code developed by Edward Ayres <a href="mailto:eayres@battelleecology.org">eayres@battelleecology.org</a>
</p>

<hr>
<h2 id='flux_fingerprint_plot'>Helper function to plot QF results for fluxes.</h2><span id='topic+flux_fingerprint_plot'></span>

<h3>Description</h3>

<p>Given a flux measurement data frame, show when the flux and diffusivity measurements produced a QF value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_fingerprint_plot(input_fluxes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flux_fingerprint_plot_+3A_input_fluxes">input_fluxes</code></td>
<td>
<p>data frame of computed fluxes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot graph where we have ordered factors showing the QA values a given flux computation
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Make a fingerprint plot for computed flux values:
flux_fingerprint_plot(sjer_flux_2022_06)
</code></pre>

<hr>
<h2 id='hirano_flux'>Internal function to compute surface co2 flux at a given timepoint via Hirano et al 2005</h2><span id='topic+hirano_flux'></span>

<h3>Description</h3>

<p>Given  zOffsets, diffusivity, and co2 (umol mol-1) and their associated errors, compute the surface flux. This is done by estimating the surface concentration through linear regression and linear extrapolation of the bottom and top surface fluxes. Modified from Hirano et al (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hirano_flux(zOffset, co2, co2_err, diffusive, diffusive_err)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hirano_flux_+3A_zoffset">zOffset</code></td>
<td>
<p>Required. depths below surface - assumed to be positive in value. Important for directionality!</p>
</td></tr>
<tr><td><code id="hirano_flux_+3A_co2">co2</code></td>
<td>
<p>Required. co2 at depth (umol m&ndash;1)</p>
</td></tr>
<tr><td><code id="hirano_flux_+3A_co2_err">co2_err</code></td>
<td>
<p>Required. Associated errors with that value of co2</p>
</td></tr>
<tr><td><code id="hirano_flux_+3A_diffusive">diffusive</code></td>
<td>
<p>Required. diffusivity at each depth</p>
</td></tr>
<tr><td><code id="hirano_flux_+3A_diffusive_err">diffusive_err</code></td>
<td>
<p>Required Associated errors with diffusivity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of fluxes associated error
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>References</h3>

<p>Hirano, Takashi, Honghyun Kim, and Yumiko Tanaka. 2003. “Long-Term Half-Hourly Measurement of Soil CO2 Concentration and Soil Respiration in a Temperate Deciduous Forest.” Journal of Geophysical Research: Atmospheres 108 (D20). https://doi.org/10.1029/2003JD003766.
</p>
<p>Maier, M., and H. Schack-Kirchner. 2014. “Using the Gradient Method to Determine Soil Gas Flux: A Review.” Agricultural and Forest Meteorology 192–193 (July):78–95. https://doi.org/10.1016/j.agrformet.2014.03.006.
</p>


<h3>See Also</h3>

<p>[dejong_shappert_flux()], [tang_2003_flux()], [tang_2005_flux()] for other ways to compute surface fluxes.
</p>

<hr>
<h2 id='insert_mean'>Internal function that inserts smoothed mean value of a measurement at a site</h2><span id='topic+insert_mean'></span>

<h3>Description</h3>

<p>Given a site measurement and monthly mean, insert in the monthly mean value when the QF flag fails.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_mean(data, monthly_mean, measurement_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_mean_+3A_data">data</code></td>
<td>
<p>Required. input data to use</p>
</td></tr>
<tr><td><code id="insert_mean_+3A_monthly_mean">monthly_mean</code></td>
<td>
<p>Required. monthly mean of input data to use</p>
</td></tr>
<tr><td><code id="insert_mean_+3A_measurement_name">measurement_name</code></td>
<td>
<p>Required. name of measurement</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nested data frame of measurements
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>

<hr>
<h2 id='inside_interval'>Determine if a YYYY-MM string is inside a interval</h2><span id='topic+inside_interval'></span>

<h3>Description</h3>

<p>Determine if a YYYY-MM string is inside a interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inside_interval(start, end, reference_time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inside_interval_+3A_start">start</code></td>
<td>
<p>starting interval time</p>
</td></tr>
<tr><td><code id="inside_interval_+3A_end">end</code></td>
<td>
<p>ending interval time</p>
</td></tr>
<tr><td><code id="inside_interval_+3A_reference_time">reference_time</code></td>
<td>
<p>time we are comparing to - YYYY-MM string</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical indicating whether or not the reference time is inside the interval. We need this when working with downloaded NEON data which usually comes in a YYYY-MM string
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define starting and ending dates:
start_date &lt;- as.POSIXct("2021-06-01 09:30:00",tz="UTC")
end_date &lt;- as.POSIXct("2023-06-01 20:00:00",tz="UTC")

# Test, should return TRUE
inside_interval(start_date,end_date,"2022-06")

# Test, should return FALSE
inside_interval(start_date,end_date,"2020-06")
</code></pre>

<hr>
<h2 id='measurement_detect'>Internal function that makes sure for each time, position, and depth we have at least two data points for soil temp and soil h20, 3 for soil co2</h2><span id='topic+measurement_detect'></span>

<h3>Description</h3>

<p>Given a merged data frame of co2, water, and temperature:
1) Filters on QF measurement flags
2) Filters if we have at least 2 soil h20 and temperature measurements, 3 co2 measurements at each time, horizontal position, and vertical depth
3) Filters if we have at least 3 distinct measurements at each time and horizontal position
4) Returns the resulting data frame.
</p>
<p>This internal function is created to speed up data processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>measurement_detect(input_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="measurement_detect_+3A_input_data">input_data</code></td>
<td>
<p>Required. Nested data frame of merged soil water, temperature, co2, and pressure across different NEON locations and depths</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of fluxes from the timeperiod
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
based on code developed by Edward Ayres <a href="mailto:eayres@battelleecology.org">eayres@battelleecology.org</a>
</p>

<hr>
<h2 id='measurement_merge'>Internal function that filters environmental data for easier processing of fluxes.</h2><span id='topic+measurement_merge'></span>

<h3>Description</h3>

<p>Internal function. Given a set of environmental measurements, create a merged data frame of measurements and positions where the QF_flag exists (either observed or a smoothed mean measurement).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>measurement_merge(
  neon_data,
  data_code,
  data_product_id,
  measurement_name,
  qf_name
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="measurement_merge_+3A_neon_data">neon_data</code></td>
<td>
<p>Required. A list of NEON data downloaded from the utilities</p>
</td></tr>
<tr><td><code id="measurement_merge_+3A_data_code">data_code</code></td>
<td>
<p>Required. Names of data product we are interpolating. (SWS = soil water, ST = soil temperature, SCO2C = soil CO2)</p>
</td></tr>
<tr><td><code id="measurement_merge_+3A_data_product_id">data_product_id</code></td>
<td>
<p>Name of the data product 00094 = soil water, 00041 = soil temperature, 00095 = soil CO2</p>
</td></tr>
<tr><td><code id="measurement_merge_+3A_measurement_name">measurement_name</code></td>
<td>
<p>Required. Names of column we are grabbing. (VSWCMean = soil water, soilTempMean = soil temperature, soilCO2concentrationMean = soil CO2)</p>
</td></tr>
<tr><td><code id="measurement_merge_+3A_qf_name">qf_name</code></td>
<td>
<p>Required. Names of qf column we are grabbing. (VSWCFinalQF = soil water, finalQF = soil temperature, finalQF = soil CO2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of the requested data.
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>

<hr>
<h2 id='quadrature_error'>Helper function to quickly compute the quadrature error</h2><span id='topic+quadrature_error'></span>

<h3>Description</h3>

<p>Assume a derived quantity y is a function of inputs x_i: y = f(x_1,x_2,x_3, ...)
</p>
<p>Given uncertainties (x_err) for each x_i, then this function will compute the corresponding y_err via quadrature.
Inputs are the vector of partial derivaties df/dx_i, evaluated at (x_1,x_2,x_3,...).
</p>
<p>Resulting y_err is the square root of the sum of (df/dx_1)^2 * (x_err)^2 + (df/dx_2)^2 * (x_err)^2 + (df/dx_3)^2 * (x_err)^2 ...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quadrature_error(x_pd, x_err)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quadrature_error_+3A_x_pd">x_pd</code></td>
<td>
<p>Required. Input vector of partial derivatives for y = f(x), evaluated at x_i</p>
</td></tr>
<tr><td><code id="quadrature_error_+3A_x_err">x_err</code></td>
<td>
<p>Required. Error vector of measurements</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of quadrature error
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Let's say we have 5 temperature measurements w/ error::
temperature &lt;- c(31.108, 30.689, 30.463, 30.381, 30.250)
temperature_error &lt;- c(0.1508,0.1507,0.1497,0.1496,0.1497)

# The sample mean is the sum of all measurements divided by the average:
sum(temperature)/5  # (Can also be computed with mean(temperature))

# The vector of partial derivatives is just 1/n for each measurement:
temperature_pd &lt;- c(1/5,1/5,1/5,1/5,1/5)
quadrature_error(temperature_pd,temperature_error)
# Note: quadrature_error(1/5,temperature_error) is also allowed.
</code></pre>

<hr>
<h2 id='sjer_env_data_2022_06'>Measured environmental data at a NEON site</h2><span id='topic+sjer_env_data_2022_06'></span>

<h3>Description</h3>

<p>A nested dataset containing environmental variables at the SJER site from June 2022. A convenience data frame to make processing fluxes easier for testing. Computed with the function acquire_neon_data.  All the variables can be used to compute fluxes (along with megapit data).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sjer_env_data_2022_06)
</code></pre>


<h3>Format</h3>

<p>A nested 3 item list
</p>


<h3>Details</h3>


<ul>
<li><p> measurement: Name of environmental measurement
</p>
</li>
<li><p> data: Nested list of data corresponding to a measurement
</p>
</li>
<li><p> monthly_mean: Monthly mean of measurement, computed in 'compute_monthly_mean'
</p>
</li></ul>


<hr>
<h2 id='sjer_flux_2022_06'>Computed flux values at a NEON site</h2><span id='topic+sjer_flux_2022_06'></span>

<h3>Description</h3>

<p>A nested dataset containing computed fluxes at the SJER site from June 2022. Fluxes were computed with  using compute_neon_flux(sjer_env_data_2022_06,sjer_megapit_data_2022_06).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sjer_flux_2022_06)
</code></pre>


<h3>Format</h3>

<p>A nested data frame item list with 7200 rows and 8 columns
</p>


<h3>Details</h3>


<ul>
<li><p> startDateTime: Time period of measurement (as POSIXct)
</p>
</li>
<li><p> horizontalPosition: Sensor location where flux is computed
</p>
</li>
<li><p> flux_compute: A nested tibble with variables (1) flux, flux_err, and method (one of 4 implemented)
</p>
</li>
<li><p> diffusivity: Computation of surface diffusivity
</p>
</li>
<li><p> VSWCMeanQF: QF flag for soil water content across all vertical depths at the given horizontal position: 0 = no issues, 1 = monthly mean used in measurement, 2 = QF fail
</p>
</li>
<li><p> soilTempMeanQF: QF flag for soil temperature across all vertical depths at the given horizontal position: 0 = no issues, 1 = monthly mean used in measurement, 2 = QF fail
</p>
</li>
<li><p> soilCO2concentrationMeanQF: QF flag for soil CO2 concentration across all vertical depths at the given horizontal position: 0 = no issues, 1 = monthly mean used in measurement, 2 = QF fail
</p>
</li>
<li><p> staPresMeanQF: QF flag for atmospheric pressure across all vertical depths at the given horizontal position: 0 = no issues, 1 = monthly mean used in measurement, 2 = QF fail
</p>
</li></ul>


<hr>
<h2 id='sjer_megapit_data_2022_06'>Measured soil physical properties at a NEON site</h2><span id='topic+sjer_megapit_data_2022_06'></span>

<h3>Description</h3>

<p>A nested dataset containing soil data properties at the SJER site from June 2022. A convenience data frame to make processing fluxes easier for testing.  Computed with using the function acquire_neon_data. Essentially what is returned when data product DP1.00096.001 is loaded from <a href="neonUtilities.html#topic+loadByProduct">loadByProduct</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sjer_megapit_data_2022_06)
</code></pre>


<h3>Format</h3>

<p>A nested 10 item list
</p>


<h3>Details</h3>


<ul>
<li><p> citation_00096_RELEASE-2024: BibTex reference
</p>
</li>
<li><p> issueLog_00096: Listing of known issues
</p>
</li>
<li><p> mgp_perarchivesample: Archived sample information
</p>
</li>
<li><p> mgp_perbiogeosample: Data collected on biogeochemistry sample
</p>
</li>
<li><p> mgp_perbulksample: Data collected on bulk density sample
</p>
</li>
<li><p> mgp_perhorizon: Per soil horizon metadata
</p>
</li>
<li><p> mgp_permegapit: Data collected per megapit
</p>
</li>
<li><p> readme_00096: Data product description, issue log, and other metadata about the data product
</p>
</li>
<li><p> validation_00096: Description of data validation applied at the points of collection and ingest
</p>
</li>
<li><p> variables_00096: Description and units for each column of data in data tables
</p>
</li></ul>



<h3>Source</h3>

<p>From <a href="https://data.neonscience.org/data-products/DP1.00096.001">https://data.neonscience.org/data-products/DP1.00096.001</a>
</p>

<hr>
<h2 id='swc_correct'>Internal function to correct depths for VSWC NEON data.</h2><span id='topic+swc_correct'></span>

<h3>Description</h3>

<p>Given the expanded SWC data, return a corrected version based on the values below
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swc_correct(input_swc, curr_site, reference_time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swc_correct_+3A_input_swc">input_swc</code></td>
<td>
<p>Required. input soil water content data from acquire_neon_data (as a list)</p>
</td></tr>
<tr><td><code id="swc_correct_+3A_curr_site">curr_site</code></td>
<td>
<p>Current site we are working with</p>
</td></tr>
<tr><td><code id="swc_correct_+3A_reference_time">reference_time</code></td>
<td>
<p>Current month we are working with</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A revised list of corrected soil water content and depths.
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Download the soil water content data:
site_swc &lt;- neonUtilities::loadByProduct(
dpID="DP1.00094.001",
site="SJER",
startdate="2020-05",
enddate="2020-05",
timeIndex = "30",
package="expanded",
check.size = FALSE,
include.provisional = TRUE
)

# Then correct the swc:
site_swc &lt;- swc_correct(site_swc,"SJER","2020-05")

</code></pre>

<hr>
<h2 id='swc_corrections'>Corrected sensor locations for NEON soil water content data</h2><span id='topic+swc_corrections'></span>

<h3>Description</h3>

<p>A dataset containing corrected NEON sensor location depths for soil water content data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swc_corrections
</code></pre>


<h3>Format</h3>

<p>A data frame with 2161 rows and 6 variables
</p>


<h3>Details</h3>


<ul>
<li><p> domainID (ecological domain of site)
</p>
</li>
<li><p> siteID NEON code to refer to site
</p>
</li>
<li><p> HOR.VER 3 digit code to refer to the horizontal and vertical position of measuring location.
</p>
</li>
<li><p> sensorDepth depth below surface (m)
</p>
</li>
<li><p> startDateTime time measurement was started
</p>
</li>
<li><p> endDateTime time measurement ended
</p>
</li></ul>



<h3>Source</h3>

<p>&lt;hhttps://data.neonscience.org/data-products/DP1.00094.001&gt;
</p>

<hr>
<h2 id='tang_2003_flux'>Internal function to compute surface co2 flux at a given timepoint via Tang et al 2003</h2><span id='topic+tang_2003_flux'></span>

<h3>Description</h3>

<p>Given  zOffsets, diffusivity, and co2 (umol mol-1) and their associated errors, compute the surface flux. This is done by computing the gradient of co2 (slope from linear regression) and linear extrapolation of surface diffusivity. Modified from Tang et al (2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tang_2003_flux(zOffset, co2, co2_err, diffusive, diffusive_err)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tang_2003_flux_+3A_zoffset">zOffset</code></td>
<td>
<p>Required. depths below surface - assumed to be positive in value. Important for directionality!</p>
</td></tr>
<tr><td><code id="tang_2003_flux_+3A_co2">co2</code></td>
<td>
<p>Required. co2 at depth (umol m&ndash;1)</p>
</td></tr>
<tr><td><code id="tang_2003_flux_+3A_co2_err">co2_err</code></td>
<td>
<p>Required. Associated errors with that value of co2</p>
</td></tr>
<tr><td><code id="tang_2003_flux_+3A_diffusive">diffusive</code></td>
<td>
<p>Required. diffusivity at each depth</p>
</td></tr>
<tr><td><code id="tang_2003_flux_+3A_diffusive_err">diffusive_err</code></td>
<td>
<p>Required Associated errors with diffusivity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of fluxes associated error
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>References</h3>

<p>Tang, Jianwu, Dennis D Baldocchi, Ye Qi, and Liukang Xu. 2003. “Assessing Soil CO2 Efflux Using Continuous Measurements of CO2 Profiles in Soils with Small Solid-State Sensors.” Agricultural and Forest Meteorology 118 (3): 207–20. https://doi.org/10.1016/S0168-1923(03)00112-6.
</p>
<p>Maier, M., and H. Schack-Kirchner. 2014. “Using the Gradient Method to Determine Soil Gas Flux: A Review.” Agricultural and Forest Meteorology 192–193 (July):78–95. https://doi.org/10.1016/j.agrformet.2014.03.006.
</p>


<h3>See Also</h3>

<p>[dejong_shappert_flux()], [hirano_flux()], [tang_2005_flux()] for other ways to compute surface fluxes.
</p>

<hr>
<h2 id='tang_2005_flux'>Internal function to compute surface co2 flux at a given timepoint via Tang et al 2005</h2><span id='topic+tang_2005_flux'></span>

<h3>Description</h3>

<p>Given  zOffsets, diffusivity, and co2 (umol mol-1) and their associated errors, compute the surface flux. This is done by linear extrapolation of surface fluxes. Modified from Tang et al (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tang_2005_flux(zOffset, co2, co2_err, diffusive, diffusive_err)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tang_2005_flux_+3A_zoffset">zOffset</code></td>
<td>
<p>Required. depths below surface - assumed to be positive in value. Important for directionality!</p>
</td></tr>
<tr><td><code id="tang_2005_flux_+3A_co2">co2</code></td>
<td>
<p>Required. co2 at depth (umol m&ndash;1)</p>
</td></tr>
<tr><td><code id="tang_2005_flux_+3A_co2_err">co2_err</code></td>
<td>
<p>Required. Associated errors with that value of co2</p>
</td></tr>
<tr><td><code id="tang_2005_flux_+3A_diffusive">diffusive</code></td>
<td>
<p>Required. diffusivity at each depth</p>
</td></tr>
<tr><td><code id="tang_2005_flux_+3A_diffusive_err">diffusive_err</code></td>
<td>
<p>Required Associated errors with diffusivity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of fluxes associated error
</p>


<h3>Author(s)</h3>

<p>John Zobitz <a href="mailto:zobitz@augsburg.edu">zobitz@augsburg.edu</a>
</p>


<h3>References</h3>

<p>Tang, Jianwu, Laurent Misson, Alexander Gershenson, Weixin Cheng, and Allen H. Goldstein. 2005. “Continuous Measurements of Soil Respiration with and without Roots in a Ponderosa Pine Plantation in the Sierra Nevada Mountains.” Agricultural and Forest Meteorology 132 (3): 212–27. https://doi.org/10.1016/j.agrformet.2005.07.011.
</p>
<p>Maier, M., and H. Schack-Kirchner. 2014. “Using the Gradient Method to Determine Soil Gas Flux: A Review.” Agricultural and Forest Meteorology 192–193 (July):78–95. https://doi.org/10.1016/j.agrformet.2014.03.006.
</p>


<h3>See Also</h3>

<p>[dejong_shappert_flux()], [hirano_flux()], [tang_2003_flux()] for other ways to compute surface fluxes.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
