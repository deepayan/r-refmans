<!DOCTYPE html><html><head><title>Help for package glmertree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {glmertree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#betamertree'><p>Beta Mixed-Effects Regression Trees</p></a></li>
<li><a href='#coef.glmertree'><p>Obtaining Fixed-Effects Coefficient Estimates of (Generalized) Linear Mixed Model Trees</p></a></li>
<li><a href='#DepressionDemo'><p>Artificial depression treatment dataset</p></a></li>
<li><a href='#glmertree'><p>(Generalized) Linear Mixed Model Trees</p></a></li>
<li><a href='#GrowthCurveDemo'><p>Artificial dataset for partitioning of linear growth curve models</p></a></li>
<li><a href='#MHserviceDemo'><p>Artificial mental-health service outcomes dataset</p></a></li>
<li><a href='#plot.glmertree'><p>Plotting (Generalized) Linear Mixed Model Trees</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Generalized Linear Mixed Model Trees</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-07</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2-4</td>
</tr>
<tr>
<td>Description:</td>
<td>Recursive partitioning based on (generalized) linear mixed models
    (GLMMs) combining lmer()/glmer() from 'lme4' and lmtree()/glmtree() from 
    'partykit'. The fitting algorithm is described in more detail in Fokkema,
    Smits, Zeileis, Hothorn &amp; Kelderman (2018; &lt;<a href="https://doi.org/10.3758%2Fs13428-017-0971-x">doi:10.3758/s13428-017-0971-x</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), lme4, partykit (&ge; 1.0-4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils, Formula</td>
</tr>
<tr>
<td>Suggests:</td>
<td>vcd, lattice, betareg, glmmTMB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-07 22:17:03 UTC; fokkemam</td>
</tr>
<tr>
<td>Author:</td>
<td>Marjolein Fokkema [aut, cre],
  Achim Zeileis [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marjolein Fokkema &lt;M.Fokkema@fsw.leidenuniv.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-09 08:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='betamertree'>Beta Mixed-Effects Regression Trees</h2><span id='topic+betamertree'></span><span id='topic+print.betamertree'></span><span id='topic+ranef.betamertree'></span><span id='topic+logLik.betamertree'></span><span id='topic+model.frame.betamertree'></span><span id='topic+predict.betamertree'></span><span id='topic+terms.betamertree'></span><span id='topic+as.party.betamertree'></span><span id='topic+residuals.betamertree'></span><span id='topic+resid.betamertree'></span><span id='topic+VarCorr.betamertree'></span>

<h3>Description</h3>

<p>Model-based recursive partitioning based on mixed-effects beta
regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betamertree(formula, data, family = NULL, weights = NULL, cluster = NULL, 
  ranefstart = NULL, offset = NULL, REML = TRUE, joint = TRUE, 
  abstol = 0.001, maxit = 100, dfsplit = TRUE, verbose = FALSE, 
  plot = FALSE, glmmTMB.control = glmmTMB::glmmTMBControl(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betamertree_+3A_formula">formula</code></td>
<td>
<p>formula specifying the response variable and a three-part
right-hand-side describing the regressors, random effects, and
partitioning variables, respectively. For details see below.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_data">data</code></td>
<td>
<p>data.frame to be used for estimating the model tree.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_family">family</code></td>
<td>
<p>currently not used. The default beta distribution parameterization 
of package <code>betareg</code> is used, see also <code>?glmmTMB::beta_family.</code></p>
</td></tr>
<tr><td><code id="betamertree_+3A_weights">weights</code></td>
<td>
<p>numeric. An optional numeric vector of weights. Can be a 
name of a column in data or a vector of length <code>nrow(data)</code>.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_cluster">cluster</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_ranefstart">ranefstart</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_offset">offset</code></td>
<td>
<p>optional numeric vector to be included in the linear predictor 
with a coeffcient of one. Note that <code>offset</code> can be a name of a column 
in <code>data</code> or a a numeric vector of length <code>nrow(data)</code>.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_joint">joint</code></td>
<td>
<p>currently not used. Fixed effects from the tree are
always (re-)estimated jointly along with the random effects.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_abstol">abstol</code></td>
<td>
<p>numeric. The convergence criterion used for estimation of the model.
When the difference in log-likelihoods of the random-effects model from two
consecutive iterations is smaller than <code>abstol</code>, estimation of the
model tree has converged.</p>
</td></tr> 
<tr><td><code id="betamertree_+3A_maxit">maxit</code></td>
<td>
<p>numeric. The maximum number of iterations to be performed in
estimation of the model tree.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_dfsplit">dfsplit</code></td>
<td>
<p>logical or numeric. <code>as.integer(dfsplit)</code> is the
degrees of freedom per selected split employed when extracting
the log-likelihood.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_verbose">verbose</code></td>
<td>
<p>Should the log-likelihood value of the estimated
random-effects model be printed for every iteration of the estimation?</p>
</td></tr> 
<tr><td><code id="betamertree_+3A_plot">plot</code></td>
<td>
<p>Should the tree be plotted at every iteration of the estimation?
Note that selecting this option slows down execution of the function.</p>
</td></tr>
<tr><td><code id="betamertree_+3A_reml">REML</code></td>
<td>
<p>logical scalar. Should the fixed-effects estimates be chosen to 
optimize the REML criterion (as opposed to the log-likelihood)? Will be 
passed to funtion <code>glmmTMB()</code>. See <code><a href="glmmTMB.html#topic+glmmTMB">glmmTMB</a></code> for details.</p>
</td></tr> 
<tr><td><code id="betamertree_+3A_glmmtmb.control">glmmTMB.control</code></td>
<td>
<p>list. An optional list with control
parameters to be passed to <code>glmmTMB()</code>.
See <code><a href="glmmTMB.html#topic+glmmTMBControl">glmmTMBControl</a></code> for details.</p>
</td></tr> 
<tr><td><code id="betamertree_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>lmtree()</code> or <code>glmtree()</code>.
See <code><a href="partykit.html#topic+mob_control">mob_control</a></code> documentation for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Experimental function.
</p>
<p>Function betamertree aims to learn a tree where each terminal node is associated with
different fixed-effects regression coefficients, while adjusting for global 
random effects (such as a random intercept). It is a generalization of the ideas
underlying function <code>glmertree</code>, to allow for detection of 
subgroups with different fixed-effects parameter estimates, keeping the 
random effects constant throughout the tree (i.e., random effects are
estimated globally). The estimation algorithm iterates between (1) estimation 
of the tree given an offset of random effects, and (2) estimation of the 
random effects given the tree structure. See Fokkema et al. (2018) for 
a detailed description.
</p>
<p>Where <code>glmertree</code> uses function <code>glmtree</code> from package partykit to 
find the subgroups, and function <code>glmer</code> from package lme4 to estimate
the mixed-effects model, <code>betamertree</code> uses function <code>betatree</code> from
package betareg to find the subgroups, and function <code>glmmTMB</code> from 
package package glmmTMB to estimate the mixed-effects model. 
</p>
<p>The code is experimental and will change in future versions.
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>
<table>
<tr><td><code>tree</code></td>
<td>
<p>The final <code>betatree</code>.</p>
</td></tr>
<tr><td><code>glmmTMB</code></td>
<td>
<p>The final <code>glmmTMB</code> random-effects model.</p>
</td></tr>
<tr><td><code>ranef</code></td>
<td>
<p>The corresponding random effects of <code>glmmTMB</code>.</p>
</td></tr> 
<tr><td><code>varcorr</code></td>
<td>
<p>The corresponding <code>VarCorr(glmmTMB)</code>.</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>The corresponding <code>attr(VarCorr(glmmTMB), "sc")^2</code>.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The dataset specified with the <code>data</code> argument
including added auxiliary variables <code>.ranef</code> and <code>.tree</code>
from the last iteration.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>The log-likelihood value of the last iteration.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>The number of iterations used to estimate the <code>betamertree</code>.</p>
</td></tr> 
<tr><td><code>maxit</code></td>
<td>
<p>The maximum number of iterations specified with the <code>maxit</code> argument.</p>
</td></tr>
<tr><td><code>ranefstart</code></td>
<td>
<p>The random effects used as an offset, as specified with
the <code>ranefstart</code> argument.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>The formula as specified with the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code>randomformula</code></td>
<td>
<p>The formula as specified with the <code>randomformula</code> argument.</p>
</td></tr>
<tr><td><code>abstol</code></td>
<td>
<p>The prespecified value for the change in log-likelihood to evaluate
convergence, as specified with the <code>abstol</code> argument.</p>
</td></tr> 
<tr><td><code>mob.control</code></td>
<td>
<p>A list containing control parameters passed to
<code>betatree()</code>, as specified with ....</p>
</td></tr>
<tr><td><code>glmmTMB.control</code></td>
<td>
<p>A list containing control parameters passed to
<code>glmmTMB()</code>, as specified in the <code>control</code> argument of
function <code>glmmTMB</code>.</p>
</td></tr>
<tr><td><code>joint</code></td>
<td>
<p>Whether the fixed effects from the tree were (re-)estimated jointly along 
with the random effects, specified with the <code>joint</code> argument.</p>
</td></tr>  
</table>


<h3>References</h3>

<p>Fokkema M, Smits N, Zeileis A, Hothorn T, Kelderman H (2018).
&ldquo;Detecting Treatment-Subgroup Interactions in Clustered Data
with Generalized Linear Mixed-Effects Model Trees&rdquo;. Behavior Research 
Methods, 50(5), 2016-2034. <a href="https://doi.org/10.3758/s13428-017-0971-x">doi:10.3758/s13428-017-0971-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="glmmTMB.html#topic+glmmTMB">glmmTMB</a></code>, 
<code><a href="betareg.html#topic+betatree">betatree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (require("betareg") &amp;&amp; require("glmmTMB")) {
## load example data
data("ReadingSkills", package = "betareg")
## add random noise (not associated with reading scores)
set.seed(1071)
ReadingSkills$x1 &lt;- rnorm(nrow(ReadingSkills))
ReadingSkills$x2 &lt;- runif(nrow(ReadingSkills))
ReadingSkills$x3 &lt;- factor(rnorm(nrow(ReadingSkills)) &gt; 0)
ReadingSkills$gr &lt;- factor(rep(letters[1:5], length.out = nrow(ReadingSkills))) 

## Fit beta mixed-effects regression tree 
betamer_form &lt;- accuracy ~ iq | gr | dyslexia + x1 + x2 + x3
bmertree &lt;- betamertree(betamer_form, data = ReadingSkills, minsize = 10)
VarCorr(bmertree)
fixef(bmertree)
coef(bmertree)
plot(bmertree)
plot(bmertree, type = "simple")
predict(bmertree, newdata = ReadingSkills[1:5,])
predict(bmertree) ## see ?predict.glmmmTMB for other arguments that can be passed
residuals(bmertree) ## see ?residuals.glmmmTMB for other arguments that can be passed
}

</code></pre>

<hr>
<h2 id='coef.glmertree'>Obtaining Fixed-Effects Coefficient Estimates of (Generalized) Linear Mixed Model Trees</h2><span id='topic+coef.lmertree'></span><span id='topic+coef.glmertree'></span><span id='topic+fixef.lmertree'></span><span id='topic+fixef.glmertree'></span>

<h3>Description</h3>

<p><code>coef</code> and <code>fixef</code> methods for <code>(g)lmertree</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmertree'
coef(object, which = "tree", drop = FALSE, ...)
## S3 method for class 'lmertree'
fixef(object, which = "tree", drop = FALSE, ...)
## S3 method for class 'glmertree'
coef(object, which = "tree", drop = FALSE, ...)
## S3 method for class 'glmertree'
fixef(object, which = "tree", drop = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.glmertree_+3A_object">object</code></td>
<td>
<p>an object of class <code>lmertree</code> or <code>glmertree</code>.</p>
</td></tr>
<tr><td><code id="coef.glmertree_+3A_which">which</code></td>
<td>
<p>character; <code>"tree"</code> (default) or <code>"global"</code>. Specifies 
whether local (tree) or global fixed-effects estimates should be returned.</p>
</td></tr>
<tr><td><code id="coef.glmertree_+3A_drop">drop</code></td>
<td>
<p>logical. Only used when <code>which = "tree"</code>; delete the 
dimensions of the resulting array if it has only one level?</p>
</td></tr>
<tr><td><code id="coef.glmertree_+3A_...">...</code></td>
<td>
<p>Additional arguments, curretnly not used.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The code is still under development and might change in future versions.
</p>


<h3>Value</h3>

<p>If <code>type = "local"</code>, returns a matrix of estimated local fixed-effects
coefficients, with a row for every terminal node and a column for every 
fixed effect. If <code>type = "global"</code>, returns a numeric vector of 
estimated global fixed-effects coefficients.
</p>


<h3>References</h3>

<p>Fokkema M, Smits N, Zeileis A, Hothorn T, Kelderman H (2018).
&ldquo;Detecting Treatment-Subgroup Interactions in Clustered Data
with Generalized Linear Mixed-Effects Model Trees&rdquo;. Behavior Research 
Methods, 50(5), 2016-2034. <a href="https://doi.org/10.3758/s13428-017-0971-x">doi:10.3758/s13428-017-0971-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmertree">lmertree</a></code>, <code><a href="#topic+glmertree">glmertree</a></code>, 
<code><a href="partykit.html#topic+party-plot">party-plot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load artificial example data
data("DepressionDemo", package = "glmertree")

## fit LMM tree with local fixed effects only
lt &lt;- lmertree(depression ~ treatment + age | cluster | anxiety + duration,
  data = DepressionDemo)
coef(lt)

## fit LMM tree including both local and global fixed effect
lt &lt;- lmertree(depression ~ treatment | (age + (1|cluster)) | anxiety + duration,
  data = DepressionDemo)
coef(lt, which = "tree") # default behaviour
coef(lt, which = "global")


## fit GLMM tree with local fixed effects only
gt &lt;- glmertree(depression_bin ~ treatment | cluster | 
  age + anxiety + duration, data = DepressionDemo)
coef(gt)

## fit GLMM tree including both local and global fixed effect
gt &lt;- glmertree(depression_bin ~ treatment | (age + (1|cluster)) | 
  anxiety + duration, data = DepressionDemo)
coef(gt, which = "tree") # default behaviour
coef(gt, which = "global")

</code></pre>

<hr>
<h2 id='DepressionDemo'>Artificial depression treatment dataset</h2><span id='topic+DepressionDemo'></span>

<h3>Description</h3>

<p>Simulated dataset of a randomized clinical trial (N = 150) to illustrate fitting 
of (G)LMM trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DepressionDemo")
</code></pre>


<h3>Format</h3>

<p>A data frame containing 150 observations on 6 variables:
</p>

<dl>
<dt>depression</dt><dd><p>numeric. Continuous treatment outcome variable 
(range: 3-16, M = 9.12, SD = 2.66).</p>
</dd>
<dt>treatment</dt><dd><p>factor. Binary treatment variable.</p>
</dd>
<dt>cluster</dt><dd><p>factor. Indicator for cluster with 10 levels.</p>
</dd>
<dt>age</dt><dd><p>numeric. Continuous partitioning variable (range: 18-69, 
M = 45, SD = 9.56).</p>
</dd>
<dt>anxiety</dt><dd><p>numeric. Continuous partitioning variable (range: 3-18, 
M = 10.26, SD = 3.05).</p>
</dd>
<dt>duration</dt><dd><p>numeric. Continuous partitioning variable (range: 1-17, 
M = 6.97, SD = 2.90).</p>
</dd>
<dt>depression_bin</dt><dd><p>factor. Binarized treatment outcome variable 
(0 = recovered, 1 = not recovered).</p>
</dd>
</dl>


<h3>Details</h3>

<p>The data were generated such that the duration and anxiety covariates 
characterized three subgroups with differences in treatment effects. The 
<code>cluster</code> variable was used to introduce a random intercept that should 
be accounted for. The treatment outcome is an index of depressive symptomatology. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmertree">lmertree</a></code>, <code><a href="#topic+glmertree">glmertree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("DepressionDemo", package = "glmertree")
summary(DepressionDemo)
lt &lt;- lmertree(depression ~ treatment | cluster | anxiety + duration + age, 
        data = DepressionDemo)
plot(lt)
gt &lt;- glmertree(depression_bin ~ treatment | cluster | anxiety + duration + age, 
        data = DepressionDemo)
plot(gt)

</code></pre>

<hr>
<h2 id='glmertree'>(Generalized) Linear Mixed Model Trees</h2><span id='topic+lmertree'></span><span id='topic+glmertree'></span><span id='topic+print.lmertree'></span><span id='topic+ranef.lmertree'></span><span id='topic+logLik.lmertree'></span><span id='topic+model.frame.lmertree'></span><span id='topic+predict.lmertree'></span><span id='topic+terms.lmertree'></span><span id='topic+as.party.lmertree'></span><span id='topic+residuals.lmertree'></span><span id='topic+resid.lmertree'></span><span id='topic+VarCorr.lmertree'></span><span id='topic+print.glmertree'></span><span id='topic+ranef.glmertree'></span><span id='topic+logLik.glmertree'></span><span id='topic+model.frame.glmertree'></span><span id='topic+predict.glmertree'></span><span id='topic+terms.glmertree'></span><span id='topic+as.party.glmertree'></span><span id='topic+residuals.glmertree'></span><span id='topic+resid.glmertree'></span><span id='topic+VarCorr.glmertree'></span>

<h3>Description</h3>

<p>Model-based recursive partitioning based on (generalized)
linear mixed models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmertree(formula, data, weights = NULL, cluster = NULL, 
  ranefstart = NULL, offset = NULL, joint = TRUE, 
  abstol = 0.001, maxit = 100, dfsplit = TRUE, verbose = FALSE, 
  plot = FALSE, REML = TRUE, lmer.control = lmerControl(), ...)

glmertree(formula, data, family = "binomial", weights = NULL,
  cluster = NULL, ranefstart = NULL, offset = NULL, joint = TRUE,
  abstol = 0.001, maxit = 100, dfsplit = TRUE, verbose = FALSE, 
  plot = FALSE, nAGQ = 1L, glmer.control = glmerControl(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmertree_+3A_formula">formula</code></td>
<td>
<p>formula specifying the response variable and a three-part
right-hand-side describing the regressors, random effects, and
partitioning variables, respectively. For details see below.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_data">data</code></td>
<td>
<p>data.frame to be used for estimating the model tree.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_family">family</code></td>
<td>
<p>family specification for <code>glmtree</code> and <code>glmer</code>.
See <code><a href="stats.html#topic+glm">glm</a></code> documentation for families.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_weights">weights</code></td>
<td>
<p>numeric. An optional numeric vector of weights. Can be a 
name of a column in data or a vector of length <code>nrow(data)</code>.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_cluster">cluster</code></td>
<td>
<p>optional vector of cluster IDs to be employed for clustered 
covariances in the parameter stability tests. Can be a name of a column 
in <code>data</code> or a vector of length <code>nrow(data)</code>. If 
<code>cluster = NULL</code> (the default), observation-level covariances 
are employed in the parameter stability tests. If 
partitioning variables are measured on the cluster level, this can
be accounted for by specifying the name of the cluster argument here, 
as a result cluster-level covariances will be employed in the parameter 
stability tests.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_ranefstart">ranefstart</code></td>
<td>
<p><code>NULL</code> (the default), <code>TRUE</code>, or a numeric 
vector of length <code>nrow(data)</code>. Specifies the offset to be used in 
estimation of the first tree. <code>NULL</code> by default, yielding a zero offset 
initialization. If <code>ranefstart = TRUE</code> is specified, the random effects 
will be estimated first and the first tree will be grown using the 
random-effects predictions as an offset.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_offset">offset</code></td>
<td>
<p>optional numeric vector to be included in the linear predictor 
with a coeffcient of one. Note that <code>offset</code> can be a name of a column 
in <code>data</code> or a a numeric vector of length <code>nrow(data)</code>.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_joint">joint</code></td>
<td>
<p>logical. Should the fixed effects from the tree be (re-)estimated
jointly along with the random effects?</p>
</td></tr>
<tr><td><code id="glmertree_+3A_abstol">abstol</code></td>
<td>
<p>numeric. The convergence criterion used for estimation of the model.
When the difference in log-likelihoods of the random-effects model from two
consecutive iterations is smaller than <code>abstol</code>, estimation of the
model tree has converged.</p>
</td></tr> 
<tr><td><code id="glmertree_+3A_maxit">maxit</code></td>
<td>
<p>numeric. The maximum number of iterations to be performed in
estimation of the model tree.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_dfsplit">dfsplit</code></td>
<td>
<p>logical or numeric. <code>as.integer(dfsplit)</code> is the
degrees of freedom per selected split employed when extracting
the log-likelihood.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_verbose">verbose</code></td>
<td>
<p>Should the log-likelihood value of the estimated
random-effects model be printed for every iteration of the estimation?</p>
</td></tr> 
<tr><td><code id="glmertree_+3A_plot">plot</code></td>
<td>
<p>Should the tree be plotted at every iteration of the estimation?
Note that selecting this option slows down execution of the function.</p>
</td></tr>
<tr><td><code id="glmertree_+3A_reml">REML</code></td>
<td>
<p>logical scalar. Should the fixed-effects estimates be chosen to 
optimize the REML criterion (as opposed to the log-likelihood)? Will be 
passed to funtion <code>lmer()</code>. See <code><a href="lme4.html#topic+lmer">lmer</a></code> for details.</p>
</td></tr> 
<tr><td><code id="glmertree_+3A_nagq">nAGQ</code></td>
<td>
<p>integer scalar. Specifies the number of points per axis for evaluating 
the adaptive Gauss-Hermite approximation to the log-likelihood, to be passed
to function <code>glmer()</code>. See <code><a href="lme4.html#topic+glmer">glmer</a></code> for details.</p>
</td></tr> 
<tr><td><code id="glmertree_+3A_lmer.control">lmer.control</code>, <code id="glmertree_+3A_glmer.control">glmer.control</code></td>
<td>
<p>list. An optional list with control
parameters to be passed to <code>lmer()</code> or <code>glmer()</code>, respectively.
See <code><a href="lme4.html#topic+lmerControl">lmerControl</a></code> for details.</p>
</td></tr> 
<tr><td><code id="glmertree_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>lmtree()</code> or <code>glmtree()</code>.
See <code><a href="partykit.html#topic+mob_control">mob_control</a></code> documentation for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>(G)LMM trees learn a tree where each terminal node is associated with
different fixed-effects regression coefficients while adjusting for global 
random effects (such as a random intercept). This allows for detection of 
subgroups with different fixed-effects parameter estimates, keeping the 
random effects constant throughout the tree (i.e., random effects are
estimated globally). The estimation algorithm iterates between (1) estimation 
of the tree given an offset of random effects, and (2) estimation of the 
random effects given the tree structure. See Fokkema et al. (2018) for 
a detailed introduction.
</p>
<p>To specify all variables in the model a <code>formula</code> such as
<code>y ~ x1 + x2 | random | z1 + z2 + z3</code> is used, where <code>y</code> is the
response, <code>x1</code> and <code>x2</code> are the regressors in every node of the
tree, <code>random</code> is the random effects, and <code>z1</code> to <code>z3</code> are
the partitioning variables considered for growing the tree. If <code>random</code>
is only a single variable such as <code>id</code> a random intercept with respect
to <code>id</code> is used. Alternatively, it may be an explicit random-effects
formula such as <code>(1 | id)</code> or a more complicated formula such as
<code>((1+time) | id)</code>. (Note that in the latter two formulas, the brackets 
are necessary to protect the pipes in the random-effects formulation.)
</p>
<p>In the random-effects model from step (2), two strategies are available:
Either the fitted values from the tree can be supplied as an offset
(<code>joint = FALSE</code>) so that only the random effects are estimated.
Or the fixed effects are (re-)estimated along with the random effects
using a nesting factor with nodes from the tree (<code>joint = TRUE</code>).
In the former case, the estimation of each random-effects model is typically
faster, but more iterations are required.
</p>
<p>The code is still under development and might change in future versions.
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>
<table>
<tr><td><code>tree</code></td>
<td>
<p>The final <code>lmtree</code>/<code>glmtree</code>.</p>
</td></tr>
<tr><td><code>lmer</code></td>
<td>
<p>The final <code>lmer</code> random-effects model.</p>
</td></tr>
<tr><td><code>ranef</code></td>
<td>
<p>The corresponding random effects of <code>lmer</code>.</p>
</td></tr> 
<tr><td><code>varcorr</code></td>
<td>
<p>The corresponding <code>VarCorr(lmer)</code>.</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>The corresponding <code>attr(VarCorr(lmer), "sc")^2</code>.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The dataset specified with the <code>data</code> argument
including added auxiliary variables <code>.ranef</code> and <code>.tree</code>
from the last iteration.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>The log-likelihood value of the last iteration.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>The number of iterations used to estimate the <code>lmertree</code>.</p>
</td></tr> 
<tr><td><code>maxit</code></td>
<td>
<p>The maximum number of iterations specified with the <code>maxit</code> argument.</p>
</td></tr>
<tr><td><code>ranefstart</code></td>
<td>
<p>The random effects used as an offset, as specified with
the <code>ranefstart</code> argument.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>The formula as specified with the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code>randomformula</code></td>
<td>
<p>The formula as specified with the <code>randomformula</code> argument.</p>
</td></tr>
<tr><td><code>abstol</code></td>
<td>
<p>The prespecified value for the change in log-likelihood to evaluate
convergence, as specified with the <code>abstol</code> argument.</p>
</td></tr> 
<tr><td><code>mob.control</code></td>
<td>
<p>A list containing control parameters passed to
<code>lmtree()</code>, as specified with ....</p>
</td></tr>
<tr><td><code>lmer.control</code></td>
<td>
<p>A list containing control parameters passed to
<code>lmer()</code>, as specified in the <code>lmer.control</code> argument.</p>
</td></tr>
<tr><td><code>joint</code></td>
<td>
<p>Whether the fixed effects from the tree were (re-)estimated jointly along 
with the random effects, specified with the <code>joint</code> argument.</p>
</td></tr>  
</table>


<h3>References</h3>

<p>Fokkema M, Smits N, Zeileis A, Hothorn T, Kelderman H (2018).
&ldquo;Detecting Treatment-Subgroup Interactions in Clustered Data
with Generalized Linear Mixed-Effects Model Trees&rdquo;. Behavior Research 
Methods, 50(5), 2016-2034. <a href="https://doi.org/10.3758/s13428-017-0971-x">doi:10.3758/s13428-017-0971-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="lme4.html#topic+lmer">lmer</a></code>, <code><a href="lme4.html#topic+glmer">glmer</a></code>,
<code><a href="partykit.html#topic+lmtree">lmtree</a></code>, <code><a href="partykit.html#topic+glmtree">glmtree</a></code>, 
<code><a href="#topic+plot.lmertree">plot.lmertree</a></code>, <code><a href="#topic+plot.glmertree">plot.glmertree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## artificial example data
data("DepressionDemo", package = "glmertree")

## fit normal linear regression LMM tree for continuous outcome
lt &lt;- lmertree(depression ~ treatment | cluster | age + anxiety + duration,
  data = DepressionDemo)
print(lt)
plot(lt, which = "all") # default behavior, may also be "tree" or "ranef" 
coef(lt)
ranef(lt)
predict(lt, type = "response") # default behavior, may also be "node"
predict(lt, re.form = NA) # excludes random effects, see ?lme4::predict.merMod
residuals(lt)
VarCorr(lt) # see lme4::VarCorr


## fit logistic regression GLMM tree for binary outcome
gt &lt;- glmertree(depression_bin ~ treatment | cluster | age + anxiety + duration,
  data = DepressionDemo)
print(gt)
plot(gt, which = "all") # default behavior, may also be "tree" or "ranef" 
coef(gt)
ranef(gt)
predict(gt, type = "response") # default behavior, may also be "node" or "link"
predict(gt, re.form = NA) # excludes random effects, see ?lme4::predict.merMod
residuals(gt)
VarCorr(gt) # see lme4::VarCorr

## Alternative specification for binomial family: no. of successes and failures
DepressionDemo$failures &lt;- as.numeric(DepressionDemo$depression_bin) - 1
DepressionDemo$successes &lt;- 1 - DepressionDemo$failures
gt &lt;- glmertree(cbind(failures, successes) ~ treatment | cluster | age + anxiety + duration,
  data = DepressionDemo, ytype = "matrix") ## see also ?partykit::mob_control

</code></pre>

<hr>
<h2 id='GrowthCurveDemo'>Artificial dataset for partitioning of linear growth curve models</h2><span id='topic+GrowthCurveDemo'></span>

<h3>Description</h3>

<p>Artificial dataset to illustrate fitting of LMM trees with growth curve models  
in the terminal nodes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GrowthCurveDemo")
</code></pre>


<h3>Format</h3>

<p>A data frame containing 1250 repeated observations on 250 persons. x1 - x8 are
time-invariant partitioning variables. Thus, they are measurements on the person
(i.e., cluster) level, not on the individual observation level.
</p>

<dl>
<dt>person</dt><dd><p>numeric. Indicator linking repeated measurements to persons.</p>
</dd>
<dt>time</dt><dd><p>factor. Indicator for timepoint.</p>
</dd>
<dt>y</dt><dd><p>numeric. Response variable.</p>
</dd>
<dt>x1</dt><dd><p>numeric. Potential partitioning variable.</p>
</dd>
<dt>x2</dt><dd><p>numeric. Potential partitioning variable.</p>
</dd>
<dt>x3</dt><dd><p>numeric. Potential partitioning variable.</p>
</dd>
<dt>x4</dt><dd><p>numeric. Potential partitioning variable.</p>
</dd>
<dt>x5</dt><dd><p>numeric. Potential partitioning variable.</p>
</dd>
<dt>x6</dt><dd><p>numeric. Potential partitioning variable.</p>
</dd>
<dt>x7</dt><dd><p>numeric. Potential partitioning variable.</p>
</dd>
<dt>x8</dt><dd><p>numeric. Potential partitioning variable.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Data were generated so that <code>x1</code>, <code>x2</code> and <code>x3</code> are
true partitioning variables, <code>x4</code> through <code>x8</code> are noise
variables. The (potential) partitioning variables are time invariant.
Time-varying covariates can also be included in the model. For partitioning
growth curves these should probably not be potential partitioning variables,
as this could result in observations from the same person ending up in 
different terminal nodes. Thus, time-varying covariates are probably
best included as predictors in the node-specific regression model. E.g.: 
<code>y ~ time + timevarying_cov | person | x1 + x2 + x3 + x4</code>.</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmertree">lmertree</a></code>, <code><a href="#topic+glmertree">glmertree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("GrowthCurveDemo", package = "glmertree")
head(GrowthCurveDemo)

## Fit LMM tree with a random intercept w.r.t. person:
form &lt;- y ~ time | person | x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8
lt.default &lt;- lmertree(form, data = GrowthCurveDemo)
plot(lt.default, which = "tree") ## yields too large tree
VarCorr(lt.default)

## Account for measurement level of the partitioning variables:
lt.cluster &lt;- lmertree(form, cluster = person, data = GrowthCurveDemo)
plot(lt.cluster, which = "tree") ## yields correct tree
plot(lt.cluster, which = "growth") ## plot individual growth curves not datapoints 
coef(lt.cluster) ## node-specific fixed effects
VarCorr(lt.cluster) ## with smaller trees random effects explain more variance

## Fit LMM tree with random intercept and random slope of time w.r.t. person:
form.s &lt;- y ~ time | (1 + time | person) | x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8
lt.s.cluster &lt;- lmertree(form.s, cluster = person, data = GrowthCurveDemo)
plot(lt.s.cluster, which = "tree") ## same tree as before
coef(lt.cluster) 
VarCorr(lt.s.cluster)

</code></pre>

<hr>
<h2 id='MHserviceDemo'>Artificial mental-health service outcomes dataset</h2><span id='topic+MHserviceDemo'></span>

<h3>Description</h3>

<p>Artificial dataset of treatment outcomes (N = 3739) of 13 mental-health
services to illustrate fitting of (G)LMM trees with constant fits in 
terminal nodes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MHserviceDemo")
</code></pre>


<h3>Format</h3>

<p>A data frame containing 3739 observations on 8 variables:
</p>

<dl>
<dt>age</dt><dd><p>numeric. Variable representing age in years (range: 4.8 - 
23.6, M = 11.46).</p>
</dd>
<dt>impact</dt><dd><p>numeric. Continuous variable representing severity of 
and impairment due to mental-health problems at baseline. Higher 
values indicate higher severity and impairment.</p>
</dd>
<dt>gender</dt><dd><p>factor. Indicator for gender.</p>
</dd>
<dt>emotional</dt><dd><p>factor. Indicator for presence of emotional disorder 
at baseline.</p>
</dd>
<dt>autism</dt><dd><p>factor. Indicator for presence of autistic disorder at 
baseline.</p>
</dd>
<dt>conduct</dt><dd><p>factor. Indicator for mental-health service provider.</p>
</dd>
<dt>cluster_id</dt><dd><p>factor. Binarized treatment outcome variable 
(0 = recovered, 1 = not recovered.</p>
</dd>
<dt>outcome</dt><dd><p>numeric. Variable representing treatment outcome as
measured by a total mental-health difficulties score assessed about
6 months after baseline, corrected for the baseline assessment. Higher
values indicate poorer outcome.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Dataset was modelled after Edbrooke-Childs et al. (2017), who analyzed a 
sample of $N = 3,739$ young people who received treatment at one of 13 
mental-health service providers in the UK. Note that the data were 
artificially generated and do not reflect actual empirical findings.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmertree">lmertree</a></code>, <code><a href="#topic+glmertree">glmertree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("MHserviceDemo", package = "glmertree")
summary(MHserviceDemo)
lt &lt;- lmertree(outcome ~ 1 | cluster_id | age + gender + emotional + 
               autism + impact + conduct, data = MHserviceDemo)
plot(lt)

gt &lt;- glmertree(factor(outcome &gt; 0) ~ 1 | cluster_id | age + gender + 
                emotional + autism + impact + conduct, 
                data = MHserviceDemo, family = "binomial")
plot(gt)

</code></pre>

<hr>
<h2 id='plot.glmertree'>Plotting (Generalized) Linear Mixed Model Trees</h2><span id='topic+plot.lmertree'></span><span id='topic+plot.glmertree'></span>

<h3>Description</h3>

<p><code>plot</code> method for <code>(g)lmertree</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmertree'
plot(x, which = "all", nodesize_level = 1L, 
    cluster = NULL, ask = TRUE, type = "extended", 
    observed = TRUE, fitted = "combined", tp_args = list(), 
    drop_terminal = TRUE, terminal_panel = NULL, dotplot_args = list(), ...)
## S3 method for class 'glmertree'
plot(x, which = "all", nodesize_level = 1L, 
    cluster = NULL, ask = TRUE, type = "extended", 
    observed = TRUE, fitted = "combined", tp_args = list(), 
    drop_terminal = TRUE, terminal_panel = NULL, dotplot_args = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.glmertree_+3A_x">x</code></td>
<td>
<p>an object of class <code>lmertree</code> or <code>glmertree</code>.</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_which">which</code></td>
<td>
<p>character; <code>"all"</code> (default), <code>"tree"</code>, 
<code>"random"</code>, <code>"tree.coef"</code> of <code>"growth"</code>. Specifies whether the tree, random          
effects, or both should be plotted. <code>"growth"</code> should only be used
in longitudinal models, it yields a tree with growth curves for each of the
subjects in the tree nodes, instead of individual datapoints, and a 
thick red curve for the estimated node-specific fixed effectsm representing the
average trajectory within the terminal node.
<code>"tree.coef"</code>           
yields caterpillar plots of the estimated fixed-effects coefficients
in every terminal node of the tree, but omits the tree structure 
(see Details).</p>
</td></tr> 
<tr><td><code id="plot.glmertree_+3A_nodesize_level">nodesize_level</code></td>
<td>
<p>numeric. At which grouping level should sample size 
printed above each terminal node be computed? Defaults to 1, which
is the lowest level of observation. If a value of 2 is specified,
sample size at the cluster level will be printed above each terminal node.
This only works if <code>x</code> (the (g)lmertree) was fitted using 
the <code>cluster</code> argument. Alternatively, a character vector of length
one can be supplied, which gives the name of the grouping indicator
in the <code>data.frame</code> used to fit <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_cluster">cluster</code></td>
<td>
<p>vector of cluster ids. Only used if <code>which = "growth"</code>.
Need not be specified if clustered covariances were used for partitioning 
(i.e., argument <code>cluster</code> was specified). If <code>cluster</code> was not
specified in the call to functions <code>(g)lmertree</code>, this argument 
should be specified for the plotting function to identify which
individual observations belong to the same subject.</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_ask">ask</code></td>
<td>
<p>logical. Should user be asked for input, before a new figure
is drawn?</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_type">type</code></td>
<td>
<p>character; <code>"extended"</code> (default) or <code>"simple"</code>.
<code>"extended"</code> yields a plotted tree with observed data and/or
fitted means plotted in the terminal nodes; <code>"simple"</code> yields a 
plotted tree with the value of fixed and/or random effects coefficients 
reported in the terminal nodes.</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_observed">observed</code></td>
<td>
<p>logical. Should observed datapoints be plotted in the tree?
Defaults to <code>TRUE</code>, <code>FALSE</code> is only supported for objects of 
class <code>lmertree</code>, not of class<code>glmertree</code>.</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_fitted">fitted</code></td>
<td>
<p>character. <code>"combined"</code> (default), <code>"marginal"</code> 
or <code>"none"</code>. Specifies whether and how fitted values should be 
computed and visualized. Only used when predictor variables for the 
node-specific (G)LMs were specified. If <code>"combined"</code>, fitted 
values will computed, using observed values of the remaining 
(random and fixed-effects) predictor variables, which can yield
very wiggly curves. If <code>"marginal"</code>, fitted values will be calculated, 
fixing all remaining predictor variables (with random and/or fixed effects) 
at the observed sample mean (or majority class).</p>
</td></tr> 
<tr><td><code id="plot.glmertree_+3A_tp_args">tp_args</code></td>
<td>
<p>list of arguments to be passed to panel generating function
<code>node_glmertree</code>. See arguments <code>node_bivplot</code> in 
<code><a href="partykit.html#topic+panelfunctions">panelfunctions</a></code>.</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_drop_terminal">drop_terminal</code></td>
<td>
<p>logical. Should all terminal nodes be plotted at the 
bottom of the plot?</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_terminal_panel">terminal_panel</code></td>
<td>
<p>an optional panel generating function to be passed to 
<code>plot.party()</code>, but will most likely be ignored. For passing 
arguments to the panel generating functions, use argument
<code>tp_args</code>. For using a custom panel generating function,
see Details.</p>
</td></tr>
<tr><td><code id="plot.glmertree_+3A_dotplot_args">dotplot_args</code></td>
<td>
<p>Optional list of additional arguments to be passed to 
<code><a href="lattice.html#topic+dotplot">dotplot</a></code>. Only relevant when random- or fixed-effects plots
are requested by specifying <code>which</code> as <code>"ranef"</code>, <code>"all"</code>, or 
<code>"ranef"</code>.</p>
</td></tr> 
<tr><td><code id="plot.glmertree_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>plot.party()</code>.
See <code><a href="partykit.html#topic+party-plot">party-plot</a></code> documentation for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the node-specific model of the <code>(g)lmertree</code> object specified by 
argument <code>x</code> is an intercept-only model, observed data distributions
will be plotted in the terminal nodes of the tree (using 
<code><a href="partykit.html#topic+node_barplot">node_barplot</a></code> (for categorical responses) or 
<code><a href="partykit.html#topic+node_boxplot">node_boxplot</a></code> (for numerical responses). Otherwise, 
fitted values will be plotted, in addition to observed datapoints, using a
function taking similar arguments as <code><a href="partykit.html#topic+node_bivplot">node_bivplot</a></code>.
</p>
<p>Exceptions:
</p>
<p>If <code>fitted = "marginal"</code>, fitted values will be plotted by assuming the
mean (continuous predictors) or mode (categorical predictors) for all 
predictor variables, except the variable on the x-axis of the current plot.
</p>
<p>If <code>which = "growth"</code>, individual growth curves will be plotted as thin grey
lines in the terminal nodes, while the node-specific fixed effect will be plotted
on top of that as a thicker red curve. 
</p>
<p>If <code>which = "tree.coef"</code>), caterpillar plot(s) are created for the local 
(node-specific) fixed effects. These depict the estimated fixed-effects 
coefficients with 95% confidence intervals, but note that these CIs do not 
account for the searching of the tree structure and are therefore likely 
too narrow. There is currently no way to adjust CIs for searching of the tree 
structure, but the CIs can be useful to obtain an indication of the variability 
of the coefficient estimates, not for statistical significance testing. 
</p>
<p>If <code>which = "ranef"</code> or <code>"all"</code>, caterpillar plot(s) for the random 
effect(s) created, depicting the predicted random effects with 95% confidence 
intervals. See also <code><a href="lme4.html#topic+ranef">ranef</a></code> for more info. Note that the CIs
do not account for the searching of the tree structure and may be too narrow.
</p>
<p>If users want to specify custom panel generating functions, it might be best to
not use the plotting method for (g)lmertrees. Instead, extract the (g)lmtree from
the fitted (g)lmertree object (which is a list containing, amongst others, an element 
<code>$tree</code>). On this tree, most of the customization options from 
<code><a href="partykit.html#topic+party-plot">party-plot</a></code> can then be applied.
</p>
<p>The code is still under development and might change in future versions.
</p>


<h3>References</h3>

<p>Fokkema M, Smits N, Zeileis A, Hothorn T, Kelderman H (2018).
&ldquo;Detecting Treatment-Subgroup Interactions in Clustered Data
with Generalized Linear Mixed-Effects Model Trees&rdquo;. Behavior Research 
Methods, 50(5), 2016-2034. <a href="https://doi.org/10.3758/s13428-017-0971-x">doi:10.3758/s13428-017-0971-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmertree">lmertree</a></code>, <code><a href="#topic+glmertree">glmertree</a></code>, 
<code><a href="partykit.html#topic+party-plot">party-plot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load artificial example data
data("DepressionDemo", package = "glmertree")

## fit linear regression LMM tree for continuous outcome
lt &lt;- lmertree(depression ~ treatment + age | cluster | anxiety + duration,
  data = DepressionDemo)
plot(lt)
plot(lt, type = "simple")
plot(lt, which = "tree", fitted = "combined")
plot(lt, which = "tree", fitted = "none")
plot(lt, which = "tree", observed = FALSE)
plot(lt, which = "tree.coef")
plot(lt, which = "ranef")

## fit logistic regression GLMM tree for binary outcome
gt &lt;- glmertree(depression_bin ~ treatment + age | cluster | 
  anxiety + duration, data = DepressionDemo)
plot(gt)  
plot(gt, type = "simple")
plot(gt, which = "tree", fitted = "combined")
plot(gt, which = "tree", fitted = "none")
plot(gt, which = "tree.coef")
plot(gt, which = "ranef")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
