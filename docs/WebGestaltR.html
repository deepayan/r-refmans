<!DOCTYPE html><html><head><title>Help for package WebGestaltR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WebGestaltR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#affinityPropagation'><p>Affinity Propagation</p></a></li>
<li><a href='#cacheUrl'><p>cacheUrl</p></a></li>
<li><a href='#createNtaReport'><p>Create HTML Report for NTA</p></a></li>
<li><a href='#createReport'><p>createReport</p></a></li>
<li><a href='#enrichResultSection'><p>enrichResultSection</p></a></li>
<li><a href='#expandDag'><p>Expand enriched GO IDs to include ancestors up to the root</p></a></li>
<li><a href='#fillInputDataFrame'><p>Fill relation data frame for GSEA input</p></a></li>
<li><a href='#formatCheck'><p>Check Format and Read Data</p></a></li>
<li><a href='#goSlimSummary'><p>GO Slim Summary</p></a></li>
<li><a href='#gseaPermutation'><p>Permutaion in GSEA algorithm</p></a></li>
<li><a href='#idMapping'><p>ID Mapping</p></a></li>
<li><a href='#jaccardSim'><p>Jaccard Similarity</p></a></li>
<li><a href='#keepRep'><p>keepRep</p></a></li>
<li><a href='#linkModification'><p>Modify the link to highlight the genes in the pathways</p></a></li>
<li><a href='#listArchiveUrl'><p>List WebGestalt Servers</p></a></li>
<li><a href='#listGeneSet'><p>List Gene Sets</p></a></li>
<li><a href='#listIdType'><p>List ID Types</p></a></li>
<li><a href='#listOrganism'><p>List Organisms</p></a></li>
<li><a href='#listReferenceSet'><p>List Reference Sets</p></a></li>
<li><a href='#loadGeneSet'><p>Load gene set data</p></a></li>
<li><a href='#prepareGseaInput'><p>Prepare input for standard GSEA</p></a></li>
<li><a href='#prepareInputMatrixGsea'><p>Prepare Input Matrix for GSEA</p></a></li>
<li><a href='#readGmt'><p>Read GMT File</p></a></li>
<li><a href='#specificParameterSummaryGsea'><p>specificParameterSummaryGsea</p></a></li>
<li><a href='#specificParameterSummaryOra'><p>specificParameterSummaryOra</p></a></li>
<li><a href='#summaryDescription'><p>summaryDescription</p></a></li>
<li><a href='#swGsea'><p>Site Weighted Gene Set Enrichment Analysis</p></a></li>
<li><a href='#WebGestaltR'><p>WebGestaltR: The R interface for enrichment analysis with WebGestalt.</p></a></li>
<li><a href='#weightedSetCover'><p>Weighted Set Cover</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Gene Set Analysis Toolkit WebGestaltR</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-31</td>
</tr>
<tr>
<td>Description:</td>
<td>The web version WebGestalt <a href="https://www.webgestalt.org">https://www.webgestalt.org</a> supports 12 organisms, 354 gene identifiers and 321,251 function categories. Users can upload the data and functional categories with their own gene identifiers. In addition to the Over-Representation Analysis, WebGestalt also supports Gene Set Enrichment Analysis and Network Topology Analysis. The user-friendly output report allows interactive and efficient exploration of enrichment results. The WebGestaltR package not only supports all above functions but also can be integrated into other pipeline or simultaneously analyze multiple gene lists.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2">LGPL-2</a> | <a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bzhanglab/WebGestaltR">https://github.com/bzhanglab/WebGestaltR</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, dplyr, doRNG, readr, parallel (&ge; 3.3.2), doParallel
(&ge; 1.0.10), foreach (&ge; 1.4.0), jsonlite, httr, rlang,
svglite, igraph, whisker, apcluster, Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-01 15:42:39 UTC; Yuxing</td>
</tr>
<tr>
<td>Author:</td>
<td>Jing Wang [aut],
  Yuxing Liao [aut, cre],
  Eric Jaehnig [ctb],
  Zhiao Shi [ctb],
  Quanhu Sheng [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yuxing Liao &lt;yuxingliao@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-01 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='affinityPropagation'>Affinity Propagation</h2><span id='topic+affinityPropagation'></span>

<h3>Description</h3>

<p>Use affinity propagation to cluster similar gene sets to reduce redundancy in report.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>affinityPropagation(idsInSet, score)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="affinityPropagation_+3A_idsinset">idsInSet</code></td>
<td>
<p>A list of set names and their member IDs.</p>
</td></tr>
<tr><td><code id="affinityPropagation_+3A_score">score</code></td>
<td>
<p>A vector of addible scores with the same length used to assign input preference;
higher score has larger weight, i.e. -logP.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>clusters</code> and <code>representatives</code> for each cluster.
</p>

<dl>
<dt>clusters</dt><dd><p>A list of character vectors of set IDs in each cluster.</p>
</dd>
<dt>representatives</dt><dd><p>A character vector of representatives for each cluster.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Zhiao Shi, Yuxing Liao
</p>

<hr>
<h2 id='cacheUrl'>cacheUrl</h2><span id='topic+cacheUrl'></span>

<h3>Description</h3>

<p>Get data from a URL or cache and optionally save in cache for reuse
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cacheUrl(dataUrl, cache = NULL, query = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cacheUrl_+3A_dataurl">dataUrl</code></td>
<td>
<p>The URL of data</p>
</td></tr>
<tr><td><code id="cacheUrl_+3A_cache">cache</code></td>
<td>
<p>The cache directory. Defaults to <code>NULL</code> and fetches data from server.</p>
</td></tr>
<tr><td><code id="cacheUrl_+3A_query">query</code></td>
<td>
<p>The list of queries passed on to httr methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>response object from httr request
</p>

<hr>
<h2 id='createNtaReport'>Create HTML Report for NTA</h2><span id='topic+createNtaReport'></span>

<h3>Description</h3>

<p>Create HTML Report for NTA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createNtaReport(
  networkName,
  method,
  sigMethod,
  fdrThr,
  topThr,
  highlightType,
  outputDirectory,
  projectDir,
  projectName,
  hostName
)
</code></pre>

<hr>
<h2 id='createReport'>createReport</h2><span id='topic+createReport'></span>

<h3>Description</h3>

<p>Generate HTML report for ORA and GSEA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createReport(
  hostName,
  outputDirectory,
  organism = "hsapiens",
  projectName,
  enrichMethod,
  geneSet,
  geneSetDes,
  geneSetDag,
  geneSetNet,
  interestingGeneMap,
  referenceGeneList,
  enrichedSig,
  geneTables,
  clusters,
  background,
  enrichDatabase = NULL,
  enrichDatabaseFile = NULL,
  enrichDatabaseType = NULL,
  enrichDatabaseDescriptionFile = NULL,
  interestGeneFile = NULL,
  interestGene = NULL,
  interestGeneType = NULL,
  collapseMethod = "mean",
  referenceGeneFile = NULL,
  referenceGene = NULL,
  referenceGeneType = NULL,
  referenceSet = NULL,
  minNum = 10,
  maxNum = 500,
  fdrMethod = "BH",
  sigMethod = "fdr",
  fdrThr = 0.05,
  topThr = 10,
  reportNum = 20,
  perNum = 1000,
  p = 1,
  dagColor = "binary"
)
</code></pre>

<hr>
<h2 id='enrichResultSection'>enrichResultSection</h2><span id='topic+enrichResultSection'></span>

<h3>Description</h3>

<p>Conditionally render template of main result section. Actual work is carried out in front end
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enrichResultSection(
  enrichMethod,
  enrichedSig,
  geneSet,
  geneSetDes,
  geneSetDag,
  geneSetNet,
  clusters
)
</code></pre>

<hr>
<h2 id='expandDag'>Expand enriched GO IDs to include ancestors up to the root</h2><span id='topic+expandDag'></span>

<h3>Description</h3>

<p>Returns expanded nodes and DAG tree edges
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expandDag(goTermList, dagEdgeList)
</code></pre>

<hr>
<h2 id='fillInputDataFrame'>Fill relation data frame for GSEA input</h2><span id='topic+fillInputDataFrame'></span>

<h3>Description</h3>

<p>Fill 1 for gene in gene set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fillInputDataFrame(gmt, genes, geneSets)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fillInputDataFrame_+3A_gmt">gmt</code></td>
<td>
<p>A Data Frame with geneSet and gene columns from the GMT file</p>
</td></tr>
<tr><td><code id="fillInputDataFrame_+3A_genes">genes</code></td>
<td>
<p>A vector of genes</p>
</td></tr>
<tr><td><code id="fillInputDataFrame_+3A_genesets">geneSets</code></td>
<td>
<p>A vector of gene sets</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Data Frame with the first column of gene and 1 or 0 for other columns of gene sets.
</p>


<h3>Author(s)</h3>

<p>Yuxing Liao
</p>

<hr>
<h2 id='formatCheck'>Check Format and Read Data</h2><span id='topic+formatCheck'></span>

<h3>Description</h3>

<p>Check Format and Read Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatCheck(dataType = "list", inputGeneFile = NULL, inputGene = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formatCheck_+3A_datatype">dataType</code></td>
<td>
<p>Type of data, either <code>list</code>, <code>rnk</code> or <code>gmt</code>.
Could be <code>list</code>, <code>rnk</code> or <code>matrix</code> for <code>idToSymbol</code>.</p>
</td></tr>
<tr><td><code id="formatCheck_+3A_inputgenefile">inputGeneFile</code></td>
<td>
<p>The data file to be mapped.</p>
</td></tr>
<tr><td><code id="formatCheck_+3A_inputgene">inputGene</code></td>
<td>
<p>Or the input could be given as an R object.
GMT file should be read with <code>readGmt</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frame
</p>

<hr>
<h2 id='goSlimSummary'>GO Slim Summary</h2><span id='topic+goSlimSummary'></span><span id='topic+GOSlimSummary'></span>

<h3>Description</h3>

<p>Outputs a brief summary of input genes based on GO Slim data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goSlimSummary(
  organism = "hsapiens",
  geneList,
  outputFile,
  outputType = "pdf",
  isOutput = TRUE,
  cache = NULL,
  hostName = "https://www.webgestalt.org"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="goSlimSummary_+3A_organism">organism</code></td>
<td>
<p>Currently, WebGestaltR supports 12 organisms. Users can use the function
<code>listOrganism</code> to check available organisms. Users can also input <code>others</code> to
perform the enrichment analysis for other organisms not supported by WebGestaltR. For
other organisms, users need to provide the functional categories, interesting list and
reference list (for ORA method). Because WebGestaltR does not perform the ID mapping for
the other organisms, the above data should have the same ID type.</p>
</td></tr>
<tr><td><code id="goSlimSummary_+3A_genelist">geneList</code></td>
<td>
<p>A list of input genes.</p>
</td></tr>
<tr><td><code id="goSlimSummary_+3A_outputfile">outputFile</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="goSlimSummary_+3A_outputtype">outputType</code></td>
<td>
<p>File format of the plot: <code>pdf</code>, <code>bmp</code> or <code>png</code>.</p>
</td></tr>
<tr><td><code id="goSlimSummary_+3A_isoutput">isOutput</code></td>
<td>
<p>Boolean if a plot is save to <code>outputFile</code>.</p>
</td></tr>
<tr><td><code id="goSlimSummary_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
<tr><td><code id="goSlimSummary_+3A_hostname">hostName</code></td>
<td>
<p>The server URL for accessing data. Mostly for development purposes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the summary result.
</p>

<hr>
<h2 id='gseaPermutation'>Permutaion in GSEA algorithm</h2><span id='topic+gseaPermutation'></span>

<h3>Description</h3>

<p>Permutaion in GSEA algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gseaPermutation(inset_scores, outset_scores, expression_value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gseaPermutation_+3A_inset_scores">inset_scores</code></td>
<td>
<p>Scaled score matrix for genes in sets</p>
</td></tr>
<tr><td><code id="gseaPermutation_+3A_outset_scores">outset_scores</code></td>
<td>
<p>Normalized score matrix for genes not in sets</p>
</td></tr>
<tr><td><code id="gseaPermutation_+3A_expression_value">expression_value</code></td>
<td>
<p>Vector of gene rank scores</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of concatenated random minimal,maimum and best running sum scores for each set.
</p>


<h3>Author(s)</h3>

<p>Yuxing Liao
</p>

<hr>
<h2 id='idMapping'>ID Mapping</h2><span id='topic+idMapping'></span><span id='topic+IDMapping'></span><span id='topic+idToSymbol'></span>

<h3>Description</h3>

<p>ID mapping utility with WebGestalt server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idMapping(
  organism = "hsapiens",
  dataType = "list",
  inputGeneFile = NULL,
  inputGene = NULL,
  sourceIdType,
  targetIdType = NULL,
  collapseMethod = "mean",
  mappingOutput = FALSE,
  outputFileName = "",
  cache = NULL,
  hostName = "https://www.webgestalt.org/"
)

idToSymbol(
  organism = "hsapiens",
  dataType = "list",
  inputGeneFile = NULL,
  inputGene = NULL,
  sourceIdType = "ensembl_gene_id",
  collapseMethod = "mean",
  mappingOutput = FALSE,
  outputFileName = NULL,
  cache = NULL,
  hostName = "https://www.webgestalt.org/"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idMapping_+3A_organism">organism</code></td>
<td>
<p>Currently, WebGestaltR supports 12 organisms. Users can use the function
<code>listOrganism</code> to check available organisms. Users can also input <code>others</code> to
perform the enrichment analysis for other organisms not supported by WebGestaltR. For
other organisms, users need to provide the functional categories, interesting list and
reference list (for ORA method). Because WebGestaltR does not perform the ID mapping for
the other organisms, the above data should have the same ID type.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_datatype">dataType</code></td>
<td>
<p>Type of data, either <code>list</code>, <code>rnk</code> or <code>gmt</code>.
Could be <code>list</code>, <code>rnk</code> or <code>matrix</code> for <code>idToSymbol</code>.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_inputgenefile">inputGeneFile</code></td>
<td>
<p>The data file to be mapped.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_inputgene">inputGene</code></td>
<td>
<p>Or the input could be given as an R object.
GMT file should be read with <code>readGmt</code>.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_sourceidtype">sourceIdType</code></td>
<td>
<p>The ID type of the data.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_targetidtype">targetIdType</code></td>
<td>
<p>The ID type of the mapped data.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_collapsemethod">collapseMethod</code></td>
<td>
<p>The method to collapse duplicate IDs with scores. <code>mean</code>,
<code>median</code>, <code>min</code> and <code>max</code> represent the mean, median, minimum and maximum
of scores for the duplicate IDs.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_mappingoutput">mappingOutput</code></td>
<td>
<p>Boolean if the mapping output is written to file.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_outputfilename">outputFileName</code></td>
<td>
<p>The output file name.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
<tr><td><code id="idMapping_+3A_hostname">hostName</code></td>
<td>
<p>The server URL for accessing data. Mostly for development purposes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>mapped</code> and <code>unmapped</code> IDs.
</p>

<hr>
<h2 id='jaccardSim'>Jaccard Similarity</h2><span id='topic+jaccardSim'></span>

<h3>Description</h3>

<p>Calculate Jaccard Similarity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jaccardSim(idsInSet, score)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jaccardSim_+3A_idsinset">idsInSet</code></td>
<td>
<p>A list of set names and their member IDs.</p>
</td></tr>
<tr><td><code id="jaccardSim_+3A_score">score</code></td>
<td>
<p>A vector of addible scores with the same length used to assign input preference;
higher score has larger weight, i.e. -logP.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of similarity matrix <code>sim.mat</code> and input preference vector <code>ip.vec</code>.
</p>


<h3>Author(s)</h3>

<p>Zhiao Shi, Yuxing Liao
</p>

<hr>
<h2 id='keepRep'>keepRep</h2><span id='topic+keepRep'></span>

<h3>Description</h3>

<p>Add representatives of redundancy-reduced clusters to
topResult if they are missing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keepRep(topResult, allResult, reps)
</code></pre>

<hr>
<h2 id='linkModification'>Modify the link to highlight the genes in the pathways</h2><span id='topic+linkModification'></span>

<h3>Description</h3>

<p>Currently, we only have wikipathway and kegg pathways that need to modify the link
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linkModification(enrichMethod, enrichPathwayLink, geneList, interestingGeneMap)
</code></pre>

<hr>
<h2 id='listArchiveUrl'>List WebGestalt Servers</h2><span id='topic+listArchiveUrl'></span><span id='topic+listArchiveURL'></span>

<h3>Description</h3>

<p>List available WebGestalt servers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listArchiveUrl()
</code></pre>


<h3>Value</h3>

<p>A data frame of available servers.
</p>

<hr>
<h2 id='listGeneSet'>List Gene Sets</h2><span id='topic+listGeneSet'></span>

<h3>Description</h3>

<p>List available gene sets for the given organism on WebGestalt server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listGeneSet(
  organism = "hsapiens",
  hostName = "https://www.webgestalt.org/",
  cache = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="listGeneSet_+3A_organism">organism</code></td>
<td>
<p>Currently, WebGestaltR supports 12 organisms. Users can use the function
<code>listOrganism</code> to check available organisms. Users can also input <code>others</code> to
perform the enrichment analysis for other organisms not supported by WebGestaltR. For
other organisms, users need to provide the functional categories, interesting list and
reference list (for ORA method). Because WebGestaltR does not perform the ID mapping for
the other organisms, the above data should have the same ID type.</p>
</td></tr>
<tr><td><code id="listGeneSet_+3A_hostname">hostName</code></td>
<td>
<p>The server URL for accessing data. Mostly for development purposes.</p>
</td></tr>
<tr><td><code id="listGeneSet_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of available gene sets.
</p>

<hr>
<h2 id='listIdType'>List ID Types</h2><span id='topic+listIdType'></span><span id='topic+listIDType'></span>

<h3>Description</h3>

<p>List supported ID types for the given organism on WebGestalt server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listIdType(
  organism = "hsapiens",
  hostName = "https://www.webgestalt.org/",
  cache = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="listIdType_+3A_organism">organism</code></td>
<td>
<p>Currently, WebGestaltR supports 12 organisms. Users can use the function
<code>listOrganism</code> to check available organisms. Users can also input <code>others</code> to
perform the enrichment analysis for other organisms not supported by WebGestaltR. For
other organisms, users need to provide the functional categories, interesting list and
reference list (for ORA method). Because WebGestaltR does not perform the ID mapping for
the other organisms, the above data should have the same ID type.</p>
</td></tr>
<tr><td><code id="listIdType_+3A_hostname">hostName</code></td>
<td>
<p>The server URL for accessing data. Mostly for development purposes.</p>
</td></tr>
<tr><td><code id="listIdType_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of supported gene sets.
</p>

<hr>
<h2 id='listOrganism'>List Organisms</h2><span id='topic+listOrganism'></span>

<h3>Description</h3>

<p>List supported organisms on WebGestalt server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listOrganism(hostName = "https://www.webgestalt.org/", cache = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="listOrganism_+3A_hostname">hostName</code></td>
<td>
<p>The server URL for accessing data. Mostly for development purposes.</p>
</td></tr>
<tr><td><code id="listOrganism_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of supported organisms.
</p>

<hr>
<h2 id='listReferenceSet'>List Reference Sets</h2><span id='topic+listReferenceSet'></span>

<h3>Description</h3>

<p>List available reference sets for the given organism on WebGestalt server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listReferenceSet(
  organism = "hsapiens",
  hostName = "https://www.webgestalt.org/",
  cache = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="listReferenceSet_+3A_organism">organism</code></td>
<td>
<p>Currently, WebGestaltR supports 12 organisms. Users can use the function
<code>listOrganism</code> to check available organisms. Users can also input <code>others</code> to
perform the enrichment analysis for other organisms not supported by WebGestaltR. For
other organisms, users need to provide the functional categories, interesting list and
reference list (for ORA method). Because WebGestaltR does not perform the ID mapping for
the other organisms, the above data should have the same ID type.</p>
</td></tr>
<tr><td><code id="listReferenceSet_+3A_hostname">hostName</code></td>
<td>
<p>The server URL for accessing data. Mostly for development purposes.</p>
</td></tr>
<tr><td><code id="listReferenceSet_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of reference sets.
</p>

<hr>
<h2 id='loadGeneSet'>Load gene set data</h2><span id='topic+loadGeneSet'></span>

<h3>Description</h3>

<p>Load gene set data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadGeneSet(
  organism = "hsapiens",
  enrichDatabase = NULL,
  enrichDatabaseFile = NULL,
  enrichDatabaseType = NULL,
  enrichDatabaseDescriptionFile = NULL,
  cache = NULL,
  hostName = "https://www.webgestalt.org/"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadGeneSet_+3A_organism">organism</code></td>
<td>
<p>Currently, WebGestaltR supports 12 organisms. Users can use the function
<code>listOrganism</code> to check available organisms. Users can also input <code>others</code> to
perform the enrichment analysis for other organisms not supported by WebGestaltR. For
other organisms, users need to provide the functional categories, interesting list and
reference list (for ORA method). Because WebGestaltR does not perform the ID mapping for
the other organisms, the above data should have the same ID type.</p>
</td></tr>
<tr><td><code id="loadGeneSet_+3A_enrichdatabase">enrichDatabase</code></td>
<td>
<p>The functional categories for the enrichment analysis. Users can use
the function <code>listGeneSet</code> to check the available functional databases for the
selected organism. Multiple databases in a vector are supported for ORA and GSEA.</p>
</td></tr>
<tr><td><code id="loadGeneSet_+3A_enrichdatabasefile">enrichDatabaseFile</code></td>
<td>
<p>Users can provide one or more GMT files as the functional
category for enrichment analysis. The extension of the file should be <code>gmt</code> and the
first column of the file is the category ID, the second one is the external link for the
category. Genes annotated to the category are from the third column. All columns are
separated by tabs. The GMT files will be combined with <code>enrichDatabase</code>.</p>
</td></tr>
<tr><td><code id="loadGeneSet_+3A_enrichdatabasetype">enrichDatabaseType</code></td>
<td>
<p>The ID type of the genes in the <code>enrichDatabaseFile</code>.
If users set <code>organism</code> as <code>others</code>, users do not need to set this ID type because
WebGestaltR will not perform ID mapping for other organisms. The supported ID types of
WebGestaltR for the selected organism can be found by the function <code>listIdType</code>.</p>
</td></tr>
<tr><td><code id="loadGeneSet_+3A_enrichdatabasedescriptionfile">enrichDatabaseDescriptionFile</code></td>
<td>
<p>Users can also provide description files for the custom
<code>enrichDatabaseFile</code>. The extension of the description file should be <code>des</code>. The
description file contains two columns: the first column is the category ID that should be
exactly the same as the category ID in the custom <code>enrichDatabaseFile</code> and the second
column is the description of the category. All columns are separated by tabs.</p>
</td></tr>
<tr><td><code id="loadGeneSet_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
<tr><td><code id="loadGeneSet_+3A_hostname">hostName</code></td>
<td>
<p>The server URL for accessing data. Mostly for development purposes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>geneSet</code>, <code>geneSetDes</code>, <code>geneSetDag</code>, <code>geneSetNet</code>, <code>standardId</code>.
</p>

<dl>
<dt>geneSet</dt><dd><p>Gene set: A data frame with columns of &quot;geneSet&quot;, &quot;description&quot;, &quot;genes&quot;</p>
</dd>
<dt>geneSetDes</dt><dd><p>Description: A data frame with columns of two columns of gene set ID and description</p>
</dd>
<dt>geneSetDag</dt><dd><p>DAG: A edge list data frame of two columns of parent and child. Or a list of data frames if multilple databases are given.</p>
</dd>
<dt>geneSetNet</dt><dd><p>Network: A edge list data frame of two columns connecting nodes. Or a list of data frames if multilple databases are given.</p>
</dd>
<dt>standardId</dt><dd><p>The standard ID of the gene set</p>
</dd>
</dl>


<hr>
<h2 id='prepareGseaInput'>Prepare input for standard GSEA</h2><span id='topic+prepareGseaInput'></span>

<h3>Description</h3>

<p>A helper to read files for performing standard GSEA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareGseaInput(rankFile, gmtFile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepareGseaInput_+3A_rankfile">rankFile</code></td>
<td>
<p>Path of the rnk file</p>
</td></tr>
<tr><td><code id="prepareGseaInput_+3A_gmtfile">gmtFile</code></td>
<td>
<p>Path of the GMT file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame to be used in <code>swGsea</code>
</p>

<hr>
<h2 id='prepareInputMatrixGsea'>Prepare Input Matrix for GSEA</h2><span id='topic+prepareInputMatrixGsea'></span>

<h3>Description</h3>

<p>Prepare Input Matrix for GSEA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareInputMatrixGsea(rank, gmt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepareInputMatrixGsea_+3A_rank">rank</code></td>
<td>
<p>A 2 column Data Frame of gene and score</p>
</td></tr>
<tr><td><code id="prepareInputMatrixGsea_+3A_gmt">gmt</code></td>
<td>
<p>3 column Data Frame of geneSet, description, and gene</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix used for input to <code>swGsea</code>.
</p>

<hr>
<h2 id='readGmt'>Read GMT File</h2><span id='topic+readGmt'></span>

<h3>Description</h3>

<p>Read GMT File
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readGmt(gmtFile, cache = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readGmt_+3A_gmtfile">gmtFile</code></td>
<td>
<p>The file path or URL of the GMT file.</p>
</td></tr>
<tr><td><code id="readGmt_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns of &quot;geneSet&quot;, &quot;description&quot;, &quot;gene&quot;.
</p>

<hr>
<h2 id='specificParameterSummaryGsea'>specificParameterSummaryGsea</h2><span id='topic+specificParameterSummaryGsea'></span>

<h3>Description</h3>

<p>Render job summary section of GSEA specific parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specificParameterSummaryGsea(
  organism,
  interestingGeneMap,
  geneSet,
  minNum,
  maxNum,
  sigMethod,
  fdrThr,
  topThr,
  perNum,
  p,
  enrichedSig,
  reportNum,
  repAdded
)
</code></pre>

<hr>
<h2 id='specificParameterSummaryOra'>specificParameterSummaryOra</h2><span id='topic+specificParameterSummaryOra'></span>

<h3>Description</h3>

<p>Render job summary section of ORA specific parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specificParameterSummaryOra(
  organism,
  referenceGeneList,
  geneSet,
  referenceGeneFile,
  referenceGene,
  referenceGeneType,
  referenceSet,
  minNum,
  maxNum,
  sigMethod,
  fdrThr,
  topThr,
  fdrMethod,
  enrichedSig,
  reportNum,
  repAdded,
  numAnnoRefUserId,
  interestingGeneMap,
  hostName
)
</code></pre>

<hr>
<h2 id='summaryDescription'>summaryDescription</h2><span id='topic+summaryDescription'></span>

<h3>Description</h3>

<p>Render job summary section
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryDescription(
  projectName,
  organism,
  interestGeneFile,
  interestGene,
  interestGeneType,
  enrichMethod,
  enrichDatabase,
  enrichDatabaseFile,
  enrichDatabaseType,
  enrichDatabaseDescriptionFile,
  interestingGeneMap,
  referenceGeneList,
  referenceGeneFile,
  referenceGene,
  referenceGeneType,
  referenceSet,
  minNum,
  maxNum,
  sigMethod,
  fdrThr,
  topThr,
  fdrMethod,
  enrichedSig,
  reportNum,
  perNum,
  p,
  geneSet,
  repAdded,
  numAnnoRefUserId,
  hostName
)
</code></pre>

<hr>
<h2 id='swGsea'>Site Weighted Gene Set Enrichment Analysis</h2><span id='topic+swGsea'></span>

<h3>Description</h3>

<p>Performs site weighted gene set enrichment analysis or standard GSEA when
likelihood/weight columns in <code>input_df</code> are 1 or 0, <code>p=1</code>,
<code>q=1</code> and <code>thresh_type="val"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swGsea(
  input_df,
  thresh_type = "percentile",
  thresh = 0.9,
  thresh_action = "exclude",
  min_set_size = 10,
  max_set_size = 500,
  max_score = "max",
  min_score = "min",
  psuedocount = 0.001,
  perms = 1000,
  p = 1,
  q = 1,
  nThreads = 1,
  rng_seed = 1,
  fork = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swGsea_+3A_input_df">input_df</code></td>
<td>
<p>A data frame in which first column is name of item of interest
(gene, protein, phosphosite, etc.), the second is the correlation of that item
of interest with the phenotype (typically log ratio of expression for phenotype
vs. normal), and the remaining columns are the scores for the likelihood that
the item belongs in each set (one column per set).</p>
</td></tr>
<tr><td><code id="swGsea_+3A_thresh_type">thresh_type</code></td>
<td>
<p>The type of <code>thresh</code>. Use 'percentile' to include all
scores over that percentile given in <code>thresh</code> (i.e., 0.9 would be all items
in 90th percentile, or top 10 percent); 'list' to include a list of set lists
where the set lists are in the same order as the corresponding set columns in
the <code>input_df</code>; 'val' to apply a single threshold value to all sets; or
'values' to use a vector of unique cutoffs for each set (needs to be in the
same order as the sets are specified in the columns of <code>input_df</code>&quot;)</p>
</td></tr>
<tr><td><code id="swGsea_+3A_thresh">thresh</code></td>
<td>
<p>Depends on <code>thresh_type</code>. A list of lists of the items in
each set (with same names as colnames of the scores); a numeric vector of
threshold scores for each set (in the same order as the colnames of the scores
in the input_df), or a single percentile value between 0 and 1 (i.e., if
<code>thresh</code>=0.9, the 90th percentile of the score or the highest scoring 10
of of the items are included in the set for each scoring regimen) (<code>thresh</code>
=&quot;all&quot; is not supported at this time, as it doesn't result in a Kolgorov-Smirnoff
statistic; this may be worked in as an alternate scoring method later on).</p>
</td></tr>
<tr><td><code id="swGsea_+3A_thresh_action">thresh_action</code></td>
<td>
<p>Either &quot;include&quot;, &quot;exclude (default)&quot;, or &quot;adjust&quot;;
this specifies how to treat each set if it doesn't contain a minimum number of
items or contains all of the items; this option cannot be used with predefined
lists of items in sets (if the number of items in a given set doesn't meet
requirements, that set will be skipped).</p>
</td></tr>
<tr><td><code id="swGsea_+3A_min_set_size">min_set_size</code>, <code id="swGsea_+3A_max_set_size">max_set_size</code></td>
<td>
<p>The minimum/maximum number of items each
set needs for the analysis to proceed.</p>
</td></tr>
<tr><td><code id="swGsea_+3A_max_score">max_score</code>, <code id="swGsea_+3A_min_score">min_score</code></td>
<td>
<p>A optional numeric vector of minimum/maximum boundaries
to clip scores for each set.</p>
</td></tr>
<tr><td><code id="swGsea_+3A_psuedocount">psuedocount</code></td>
<td>
<p>Psuedocount (pc) is used for rescaling set scores:
<code>(score - min_score + pc)/(max_score - min_score +pc)</code>; this is needed to
prevent division by 0 if <code>max_score==min_score</code> (in this case, all scores
for items in set will be 1, which is equivalent to standard GSEA); it also allows
users to adjust weights for scores that are close to the minimum for the scores in
the set (unless min_score==max_score): as psuedocount value approaches 0, scaled
minimum scores also approach 0; as psuedocount approaches infinity, scaled minimum
scores approach the scaled maximum scores (which equal 1); this value must be
larger than 0.</p>
</td></tr>
<tr><td><code id="swGsea_+3A_perms">perms</code></td>
<td>
<p>The number of permutations.</p>
</td></tr>
<tr><td><code id="swGsea_+3A_p">p</code></td>
<td>
<p>The exponential scaling factor of the phenotype score (second column in
<code>input_df</code>).</p>
</td></tr>
<tr><td><code id="swGsea_+3A_q">q</code></td>
<td>
<p>The exponential scaling factor of the likelihood score (weights).</p>
</td></tr>
<tr><td><code id="swGsea_+3A_nthreads">nThreads</code></td>
<td>
<p>The number of threads to use in calculating permutaions.</p>
</td></tr>
<tr><td><code id="swGsea_+3A_rng_seed">rng_seed</code></td>
<td>
<p>Random seed.</p>
</td></tr>
<tr><td><code id="swGsea_+3A_fork">fork</code></td>
<td>
<p>A boolean. Whether pass &quot;fork&quot; to <code>type</code> parameter of
<code>makeCluster</code> on Unix-like machines.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula for weighting is as follows
</p>
<p style="text-align: center;"><code class="reqn">\frac{s_{j}^{q}|r_{j}|^{p}}{\sum s^{q}|r|^{p}}</code>
</p>

<p>Where r is log ratio score, s is likelihood score, j is the index of the gene.
</p>


<h3>Value</h3>

<p>A list of <code>Enrichment_Results</code>, <code>Items_in_Set</code> and <code>Running_Sums</code>.
</p>

<dl>
<dt>Enrichment_Results</dt><dd><p>A data frame with row names of gene set and columns of
&quot;ES&quot;, &quot;NES&quot;, &quot;p_val&quot;, &quot;fdr&quot;.</p>
</dd>
<dt>Items_in_Set</dt><dd><p>A list of one-column data frames. Describes genes and their
ranks in each set.</p>
</dd>
<dt>Running_Sums</dt><dd><p>Running sum scores along genes sorted by ranked scores,
with gene sets as columns.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Eric Jaehnig
</p>

<hr>
<h2 id='WebGestaltR'>WebGestaltR: The R interface for enrichment analysis with WebGestalt.</h2><span id='topic+WebGestaltR'></span><span id='topic+WebGestaltRBatch'></span><span id='topic+WebGestaltR_batch'></span>

<h3>Description</h3>

<p>Main function for enrichment analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WebGestaltR(
  enrichMethod = "ORA",
  organism = "hsapiens",
  enrichDatabase = NULL,
  enrichDatabaseFile = NULL,
  enrichDatabaseType = NULL,
  enrichDatabaseDescriptionFile = NULL,
  interestGeneFile = NULL,
  interestGene = NULL,
  interestGeneType = NULL,
  collapseMethod = "mean",
  referenceGeneFile = NULL,
  referenceGene = NULL,
  referenceGeneType = NULL,
  referenceSet = NULL,
  minNum = 10,
  maxNum = 500,
  sigMethod = "fdr",
  fdrMethod = "BH",
  fdrThr = 0.05,
  topThr = 10,
  reportNum = 20,
  perNum = 1000,
  gseaP = 1,
  isOutput = TRUE,
  outputDirectory = getwd(),
  projectName = NULL,
  dagColor = "continuous",
  saveRawGseaResult = FALSE,
  gseaPlotFormat = c("png", "svg"),
  setCoverNum = 10,
  networkConstructionMethod = NULL,
  neighborNum = 10,
  highlightType = "Seeds",
  highlightSeedNum = 10,
  nThreads = 1,
  cache = NULL,
  hostName = "https://www.webgestalt.org/",
  ...
)

WebGestaltRBatch(
  interestGeneFolder = NULL,
  enrichMethod = "ORA",
  isParallel = FALSE,
  nThreads = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WebGestaltR_+3A_enrichmethod">enrichMethod</code></td>
<td>
<p>Enrichment methods: <code>ORA</code>, <code>GSEA</code> or <code>NTA</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_organism">organism</code></td>
<td>
<p>Currently, WebGestaltR supports 12 organisms. Users can use the function
<code>listOrganism</code> to check available organisms. Users can also input <code>others</code> to
perform the enrichment analysis for other organisms not supported by WebGestaltR. For
other organisms, users need to provide the functional categories, interesting list and
reference list (for ORA method). Because WebGestaltR does not perform the ID mapping for
the other organisms, the above data should have the same ID type.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_enrichdatabase">enrichDatabase</code></td>
<td>
<p>The functional categories for the enrichment analysis. Users can use
the function <code>listGeneSet</code> to check the available functional databases for the
selected organism. Multiple databases in a vector are supported for ORA and GSEA.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_enrichdatabasefile">enrichDatabaseFile</code></td>
<td>
<p>Users can provide one or more GMT files as the functional
category for enrichment analysis. The extension of the file should be <code>gmt</code> and the
first column of the file is the category ID, the second one is the external link for the
category. Genes annotated to the category are from the third column. All columns are
separated by tabs. The GMT files will be combined with <code>enrichDatabase</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_enrichdatabasetype">enrichDatabaseType</code></td>
<td>
<p>The ID type of the genes in the <code>enrichDatabaseFile</code>.
If users set <code>organism</code> as <code>others</code>, users do not need to set this ID type because
WebGestaltR will not perform ID mapping for other organisms. The supported ID types of
WebGestaltR for the selected organism can be found by the function <code>listIdType</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_enrichdatabasedescriptionfile">enrichDatabaseDescriptionFile</code></td>
<td>
<p>Users can also provide description files for the custom
<code>enrichDatabaseFile</code>. The extension of the description file should be <code>des</code>. The
description file contains two columns: the first column is the category ID that should be
exactly the same as the category ID in the custom <code>enrichDatabaseFile</code> and the second
column is the description of the category. All columns are separated by tabs.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_interestgenefile">interestGeneFile</code></td>
<td>
<p>If <code>enrichMethod</code> is <code>ORA</code> or <code>NTA</code>, the extension of
the <code>interestGeneFile</code> should be <code>txt</code> and the file can only contain one column:
the interesting gene list. If <code>enrichMethod</code> is <code>GSEA</code>, the extension of the
<code>interestGeneFile</code> should be <code>rnk</code> and the file should contain two columns
separated by tab: the gene list and the corresponding scores.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_interestgene">interestGene</code></td>
<td>
<p>Users can also use an R object as the input. If <code>enrichMethod</code> is
<code>ORA</code> or <code>NTA</code>, <code>interestGene</code> should be an R <code>vector</code> object
containing the interesting gene list. If <code>enrichMethod</code> is <code>GSEA</code>,
<code>interestGene</code> should be an R <code>data.frame</code> object containing two columns: the
gene list and the corresponding scores.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_interestgenetype">interestGeneType</code></td>
<td>
<p>The ID type of the interesting gene list. The supported ID types of
WebGestaltR for the selected organism can be found by the function <code>listIdType</code>. If
the <code>organism</code> is <code>others</code>, users do not need to set this parameter.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_collapsemethod">collapseMethod</code></td>
<td>
<p>The method to collapse duplicate IDs with scores. <code>mean</code>,
<code>median</code>, <code>min</code> and <code>max</code> represent the mean, median, minimum and maximum
of scores for the duplicate IDs.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_referencegenefile">referenceGeneFile</code></td>
<td>
<p>For the ORA method, the users need to upload the reference gene
list. The extension of the <code>referenceGeneFile</code> should be <code>txt</code> and the file can
only contain one column: the reference gene list.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_referencegene">referenceGene</code></td>
<td>
<p>For the ORA method, users can also use an R object as the reference
gene list. <code>referenceGene</code> should be an R <code>vector</code> object containing the
reference gene list.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_referencegenetype">referenceGeneType</code></td>
<td>
<p>The ID type of the reference gene list. The supported ID types
of WebGestaltR for the selected organism can be found by the function <code>listIdType</code>.
If the <code>organism</code> is <code>others</code>, users do not need to set this parameter.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_referenceset">referenceSet</code></td>
<td>
<p>Users can directly select the reference set from existing platforms in
WebGestaltR and do not need to provide the reference set through <code>referenceGeneFile</code>.
All existing platforms supported in WebGestaltR can be found by the function
<code>listReferenceSet</code>. If <code>referenceGeneFile</code> and <code>refereneceGene</code> are
<code>NULL</code>, WebGestaltR will use the <code>referenceSet</code> as the reference gene set.
Otherwise, WebGestaltR will use the user supplied reference set for enrichment analysis.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_minnum">minNum</code></td>
<td>
<p>WebGestaltR will exclude the categories with the number of annotated genes
less than <code>minNum</code> for enrichment analysis. The default is <code>10</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_maxnum">maxNum</code></td>
<td>
<p>WebGestaltR will exclude the categories with the number of annotated genes
larger than <code>maxNum</code> for enrichment analysis. The default is <code>500</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_sigmethod">sigMethod</code></td>
<td>
<p>Two methods of significance are available in WebGestaltR: <code>fdr</code> and
<code>top</code>. <code>fdr</code> means the enriched categories are identified based on the FDR and
<code>top</code> means all categories are ranked based on FDR and then select top categories
as the enriched categories. The default is <code>fdr</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_fdrmethod">fdrMethod</code></td>
<td>
<p>For the ORA method, WebGestaltR supports five FDR methods: <code>holm</code>,
<code>hochberg</code>, <code>hommel</code>, <code>bonferroni</code>, <code>BH</code> and <code>BY</code>. The default
is <code>BH</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_fdrthr">fdrThr</code></td>
<td>
<p>The significant threshold for the <code>fdr</code> method. The default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_topthr">topThr</code></td>
<td>
<p>The threshold for the <code>top</code> method. The default is <code>10</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_reportnum">reportNum</code></td>
<td>
<p>The number of enriched categories visualized in the final report. The default
is <code>20</code>. A larger <code>reportNum</code> may be slow to render in the report.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_pernum">perNum</code></td>
<td>
<p>The number of permutations for the GSEA method. The default is <code>1000</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_gseap">gseaP</code></td>
<td>
<p>The exponential scaling factor of the phenotype score. The default is <code>1</code>.
When p=0, ES reduces to standard K-S statistics (See original paper for more details).</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_isoutput">isOutput</code></td>
<td>
<p>If <code>isOutput</code> is TRUE, WebGestaltR will create a folder named by
the <code>projectName</code> and save the results in the folder. Otherwise, WebGestaltR will
only return an R <code>data.frame</code> object containing the enrichment results. If
hundreds of gene list need to be analyzed simultaneously, it is better to set
<code>isOutput</code> to <code>FALSE</code>. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_outputdirectory">outputDirectory</code></td>
<td>
<p>The output directory for the results.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_projectname">projectName</code></td>
<td>
<p>The name of the project. If <code>projectName</code> is <code>NULL</code>,
WebGestaltR will use time stamp as the project name.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_dagcolor">dagColor</code></td>
<td>
<p>If <code>dagColor</code> is <code>binary</code>, the significant terms in the DAG
structure will be colored by steel blue for ORA method or steel blue (positive related)
and dark orange (negative related) for GSEA method. If <code>dagColor</code> is <code>continous</code>,
the significant terms in the DAG structure will be colored by the color gradient based on
corresponding FDRs.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_saverawgsearesult">saveRawGseaResult</code></td>
<td>
<p>Whether the raw result from GSEA is saved as a RDS file, which can be
used for plotting. Defaults to <code>FALSE</code>. The list includes
</p>

<dl>
<dt>Enrichment_Results</dt><dd><p>A data frame of GSEA results with statistics</p>
</dd>
<dt>Running_Sums</dt><dd><p>A matrix of running sum of scores for each gene set</p>
</dd>
<dt>Items_in_Set</dt><dd><p>A list with ranks of genes for each gene set</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_gseaplotformat">gseaPlotFormat</code></td>
<td>
<p>The graphic format of GSEA enrichment plots. Either <code>svg</code>,
<code>png</code>, or <code>c("png", "svg")</code> (default).</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_setcovernum">setCoverNum</code></td>
<td>
<p>The number of expected gene sets after set cover to reduce redundancy.
It could get fewer sets if the coverage reaches 100%. The default is <code>10</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_networkconstructionmethod">networkConstructionMethod</code></td>
<td>
<p>Netowrk construction method for NTA. Either
<code>Network_Retrieval_Prioritization</code> or <code>Network_Expansion</code>. Network Retrieval &amp;
Prioritization first uses random walk analysis to calculate random walk probabilities
for the input seeds, then identifies the relationships among the seeds in the selected
network and returns a retrieval sub-network. The seeds with the top random walk
probabilities are highlighted in the sub-network. Network Expansion first uses random
walk analysis to rank all genes in the selected network based on their network
proximity to the input seeds and then return an expanded sub-network in which nodes
are the input seeds and their top ranking neighbors and edges represent their
relationships.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_neighbornum">neighborNum</code></td>
<td>
<p>The number of neighbors to include in NTA Network Expansion method.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_highlighttype">highlightType</code></td>
<td>
<p>The type of nodes to highlight in the NTA Network Expansion method,
either <code>Seeds</code> or <code>Neighbors</code>.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_highlightseednum">highlightSeedNum</code></td>
<td>
<p>The number of top input seeds to highlight in NTA Network Retrieval
&amp; Prioritizaiton method.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_nthreads">nThreads</code></td>
<td>
<p>The number of cores to use for GSEA and set cover, and in batch function.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_cache">cache</code></td>
<td>
<p>A directory to save data cache for reuse. Defaults to <code>NULL</code> and disabled.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_hostname">hostName</code></td>
<td>
<p>The server URL for accessing data. Mostly for development purposes.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_...">...</code></td>
<td>
<p>In batch function, passes parameters to WebGestaltR function.
Also handles backward compatibility for some parameters in old versions.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_interestgenefolder">interestGeneFolder</code></td>
<td>
<p>Run WebGestaltR for gene list files in the folder.</p>
</td></tr>
<tr><td><code id="WebGestaltR_+3A_isparallel">isParallel</code></td>
<td>
<p>If jobs are run parallelly in the batch.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>WebGestaltR function can perform three enrichment analyses:
ORA (Over-Representation Analysis) and GSEA (Gene Set Enrichment Analysis).and
NTA (Network Topology Analysis). Based on the user-uploaded gene list or gene list
with scores, WebGestaltR function will first map the gene list to the entrez gene
ids and then summarize the gene list based on the GO (Gene Ontology) Slim. After
performing the enrichment analysis, WebGestaltR function also returns a user-friendly
HTML report containing GO Slim summary and the enrichment analysis result. If functional
categories have DAG (directed acyclic graph) structure or genes in the functional
categories have network structure, those relationship can also be visualized in the
report.
</p>


<h3>Value</h3>

<p>The WebGestaltR function returns a data frame containing the enrichment analysis
result and also outputs an user-friendly HTML report if <code>isOutput</code> is <code>TRUE</code>.
The columns in the data frame depend on the <code>enrichMethod</code> and they are the following:
</p>

<dl>
<dt>geneSet</dt><dd><p>ID of the gene set.</p>
</dd>
<dt>description</dt><dd><p>Description of the gene set if available.</p>
</dd>
<dt>link</dt><dd><p>Link to the data source.</p>
</dd>
<dt>size</dt><dd><p>The number of genes in the set after filtering by <code>minNum</code> and <code>maxNum</code>.</p>
</dd>
<dt>overlap</dt><dd><p>The number of mapped input genes that are annotated in the gene set.</p>
</dd>
<dt>expect</dt><dd><p>Expected number of input genes that are annotated in the gene set.</p>
</dd>
<dt>enrichmentRatio</dt><dd><p>Enrichment ratio, overlap / expect.</p>
</dd>
<dt>enrichmentScore</dt><dd><p>Enrichment score, the maximum running sum of scores for the ranked list.</p>
</dd>
<dt>normalizedEnrichmentScore</dt><dd><p>Normalized enrichment score, normalized against the average
enrichment score of all permutations.</p>
</dd>
<dt>leadingEdgeNum</dt><dd><p>Number of genes/phosphosites in the leading edge.</p>
</dd>
<dt>pValue</dt><dd><p>P-value from hypergeometric test for ORA. For GSEA, please refer to its original
publication or online at <a href="https://software.broadinstitute.org/gsea/doc/GSEAUserGuideTEXT.htm">https://software.broadinstitute.org/gsea/doc/GSEAUserGuideTEXT.htm</a>.</p>
</dd>
<dt>FDR</dt><dd><p>Corrected P-value for mulilple testing with <code>fdrMethod</code> for ORA.</p>
</dd>
<dt>overlapId</dt><dd><p>The gene/phosphosite IDs of <code>overlap</code> for ORA (entrez gene IDs or
phosphosite sequence).</p>
</dd>
<dt>leadingEdgeId</dt><dd><p>Genes/phosphosites in the leading edge in entrez gene ID or
phosphosite sequence.</p>
</dd>
<dt>userId</dt><dd><p>The gene/phosphosite IDs of <code>overlap</code> for ORA or <code>leadingEdgeId</code>
for GSEA in User input IDs.</p>
</dd>
<dt>plotPath</dt><dd><p>Path of the GSEA enrichment plot.</p>
</dd>
<dt>database</dt><dd><p>Name of the source database if multiple enrichment databases are given.</p>
</dd>
<dt>goId</dt><dd><p>In NTA, like <code>geneSet</code>, the enriched GO terms of genes in the
returned subnetwork.</p>
</dd>
<dt>interestGene</dt><dd><p>In NTA, the gene IDs in the subnetwork with 0/1 annotations indicating
if it is from user input.</p>
</dd>
</dl>

<p>The WebGestaltRBatch function returns a list of enrichment results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
####### ORA example #########
geneFile &lt;- system.file("extdata", "interestingGenes.txt", package="WebGestaltR")
refFile &lt;- system.file("extdata", "referenceGenes.txt", package="WebGestaltR")
outputDirectory &lt;- getwd()
enrichResult &lt;- WebGestaltR(enrichMethod="ORA", organism="hsapiens",
  enrichDatabase="pathway_KEGG", interestGeneFile=geneFile,
  interestGeneType="genesymbol", referenceGeneFile=refFile,
  referenceGeneType="genesymbol", isOutput=TRUE,
  outputDirectory=outputDirectory, projectName=NULL)

####### GSEA example #########
rankFile &lt;- system.file("extdata", "GeneRankList.rnk", package="WebGestaltR")
outputDirectory &lt;- getwd()
enrichResult &lt;- WebGestaltR(enrichMethod="GSEA", organism="hsapiens",
  enrichDatabase="pathway_KEGG", interestGeneFile=rankFile,
  interestGeneType="genesymbol", sigMethod="top", topThr=10, minNum=5,
  outputDirectory=outputDirectory)

####### NTA example #########
enrichResult &lt;- WebGestaltR(enrichMethod="NTA", organism="hsapiens",
  enrichDatabase="network_PPI_BIOGRID", interestGeneFile=geneFile,
  interestGeneType="genesymbol", sigMethod="top", topThr=10,
  outputDirectory=getwd(), highlightSeedNum=10,
  networkConstructionMethod="Network_Retrieval_Prioritization")

## End(Not run)

</code></pre>

<hr>
<h2 id='weightedSetCover'>Weighted Set Cover</h2><span id='topic+weightedSetCover'></span>

<h3>Description</h3>

<p>Size constrained weighted set cover problem to find top N sets while
maximizing the coverage of all elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightedSetCover(idsInSet, costs, topN, nThreads = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightedSetCover_+3A_idsinset">idsInSet</code></td>
<td>
<p>A list of set names and their member IDs.</p>
</td></tr>
<tr><td><code id="weightedSetCover_+3A_costs">costs</code></td>
<td>
<p>A vector of the same length to add weights for penalty, i.e. 1/-logP.</p>
</td></tr>
<tr><td><code id="weightedSetCover_+3A_topn">topN</code></td>
<td>
<p>The number of sets (or less when it completes early) to return.</p>
</td></tr>
<tr><td><code id="weightedSetCover_+3A_nthreads">nThreads</code></td>
<td>
<p>The number of processes to use. In Windows, it fallbacks to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>topSets</code> and <code>coverage</code>.
</p>

<dl>
<dt>topSets</dt><dd><p>A list of set IDs.</p>
</dd>
<dt>coverage</dt><dd><p>The percentage of IDs covered in the top sets.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Zhiao Shi, Yuxing Liao
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
