<!DOCTYPE html><html><head><title>Help for package CopulaCenR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CopulaCenR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ACTG181'>
<p>ACTG181</p></a></li>
<li><a href='#AIC.CopulaCenR'><p>the AIC of a CopulaCenR object</p></a></li>
<li><a href='#AREDS'>
<p>AREDS</p></a></li>
<li><a href='#BIC.CopulaCenR'><p>the BIC of a CopulaCenR object</p></a></li>
<li><a href='#coef.CopulaCenR'><p>the coefficient estimates of a CopulaCenR object</p></a></li>
<li><a href='#CopulaCenR'>
<p>Copula-based regression models for bivariate censored data</p></a></li>
<li><a href='#data_scmprisk'>
<p>data_scmprisk</p></a></li>
<li><a href='#data_sim_copula'><p>Simulate bivariate time-to-event times based on specific copula and marginal distributions</p></a></li>
<li><a href='#data_sim_ic'>
<p>data_sim_ic</p></a></li>
<li><a href='#data_sim_multi_rec'>
<p>data_sim_multi_rec</p></a></li>
<li><a href='#data_sim_RC'>
<p>data_sim_RC</p></a></li>
<li><a href='#data_sim_rec'>
<p>data_sim_rec</p></a></li>
<li><a href='#data_sim_scmprisk_vs'>
<p>data_sim_scmprisk_vs</p></a></li>
<li><a href='#DRS'>
<p>DRS</p></a></li>
<li><a href='#fitted.CopulaCenR'><p>Fitted values from CopulaCenR regression models</p></a></li>
<li><a href='#ic_par_copula'><p>Copula regression models with parametric margins for bivariate interval-censored data</p></a></li>
<li><a href='#ic_scmprisk_spTran_copula'><p>Copula regression models with semi-parametric transformation margins for semi-competing risk data under interval-censoring and left-truncation</p></a></li>
<li><a href='#ic_spTran_copula'><p>Copula regression models with semiparametric margins for bivariate interval-censored data</p></a></li>
<li><a href='#IRsurv'><p>An information ratio-based goodness-of-fit test for copula models on censored data</p></a></li>
<li><a href='#Kidney'>
<p>Kidney</p></a></li>
<li><a href='#lines.CopulaCenR'><p>Plotting for CopulaCenR fits</p></a></li>
<li><a href='#logLik.CopulaCenR'><p>the log-likelihood of a CopulaCenR object</p></a></li>
<li><a href='#lrt_copula'><p>Likelihood-ratio test for covariate effect(s) in copula models</p></a></li>
<li><a href='#plot.CopulaCenR'><p>Plotting for CopulaCenR fits</p></a></li>
<li><a href='#predict.CopulaCenR'><p>Predictions from CopulaCenR regression models</p></a></li>
<li><a href='#print.CopulaCenR'><p>Printing outputs of a CopulaCenR object</p></a></li>
<li><a href='#print.summary.CopulaCenR'><p>Print the summary of a CopulaCenR object</p></a></li>
<li><a href='#rc_par_copula'><p>Copula regression models with parametric margins for bivariate right-censored data</p></a></li>
<li><a href='#rc_scmprisk_sp_copula_pen'><p>Penalized copula regression models with Cox semiparametric margins for semi-competing risk data under right-censoring.</p></a></li>
<li><a href='#rc_spCox_copula'><p>Copula regression models with Cox semiparametric margins for bivariate right-censored data</p></a></li>
<li><a href='#score_copula'><p>Generalized score test for covariate effect(s)</p></a></li>
<li><a href='#summary.CopulaCenR'><p>Summarizing outputs of a CopulaCenR object</p></a></li>
<li><a href='#tau_copula'><p>Calculate Kendall's tau</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Copula-Based Regression Models for Multivariate Censored Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Tao Sun, Ying Ding</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tao Sun &lt;sun.tao@ruc.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Copula-based regression models for multivariate censored data, including 
 bivariate right-censored data, bivariate interval-censored data, and right/interval-censored 
 semi-competing risks data. Currently supports Clayton, Gumbel, Frank, Joe, AMH and 
 Copula2 copula models. For marginal models, it supports parametric (Weibull, Loglogistic, 
 Gompertz) and semiparametric (Cox and transformation) models. Includes methods for 
 convenient prediction and plotting. Also provides a bivariate time-to-event simulation 
 function and an information ratio-based goodness-of-fit test for copula. Method details 
 can be found in Sun et.al (2019) Lifetime Data Analysis, Sun et.al (2021) Biostatistics, 
 Sun et.al (2022) Statistical Methods in Medical Research, Sun et.al (2022) Biometrics, and
 Sun et al. (2023+) JRSSC.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>boot, caret, copBasic, copula, corpcor, flexsurv, foreach,
icenReg, magrittr, plotly, pracma, survival, VineCopula</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-23 00:08:46 UTC; taosun</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-23 22:40:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='ACTG181'>
ACTG181
</h2><span id='topic+ACTG181'></span>

<h3>Description</h3>

<p>An example real dataset of bivariate interval-censored data with 204 subjects and one covariate. The data come from the AIDS Clinical Trials Group protocol ACTG 181. Two events are the shedding time (in months) of cytomegalovirus (CMV) in urine/blood and the colonization time (in months) of mycobacterium avium complex (MAC) in sputum/stool (Betensky and Finkelstein, 1999).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ACTG181")</code></pre>


<h3>Format</h3>

<p>A data frame with 408 observations on the following 6 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>ind</code></dt><dd><p>margin indicator, 1=shedding time, 2=colonization time</p>
</dd>
<dt><code>Left</code></dt><dd><p>left bound of observed interval</p>
</dd>
<dt><code>Right</code></dt><dd><p>right bound of observed interval</p>
</dd>
<dt><code>status</code></dt><dd><p>censoring indicator; 1=interval-censor, 0=right censor. All observations are interval-censored in this dataset</p>
</dd>
<dt><code>x</code></dt><dd><p>covariate</p>
</dd>
</dl>



<h3>Source</h3>

<p>Betensky and Finkelstein (1999). A non-parametric maximum likelihood estimator for bivariate interval censored data. <em>Statistics in Medicine</em> <strong>18</strong> 3089-3100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ACTG181)
clayton_sp &lt;- ic_spTran_copula(data = ACTG181,
                           copula = "Clayton",
                           l = 0, u = 25,
                           r = 3, m = 3,
                           var_list = "x")
summary(clayton_sp)
</code></pre>

<hr>
<h2 id='AIC.CopulaCenR'>the AIC of a CopulaCenR object</h2><span id='topic+AIC.CopulaCenR'></span>

<h3>Description</h3>

<p>the AIC of a CopulaCenR object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC.CopulaCenR_+3A_object">object</code></td>
<td>
<p>a CopulaCenR object</p>
</td></tr>
<tr><td><code id="AIC.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
<tr><td><code id="AIC.CopulaCenR_+3A_k">k</code></td>
<td>
<p>numeric, with k = 2 for AIC</p>
</td></tr>
</table>

<hr>
<h2 id='AREDS'>
AREDS
</h2><span id='topic+AREDS'></span>

<h3>Description</h3>

<p>A real dataset of bivariate interval-censored data with 629 subjects and 4 non-genetic covariates and 1 genetic covariate. The dataset is selected from the Age-related Eye Disease Study (AREDS) (AREDS Group, 1999). Two events are the progression times (in years) to late-AMD in the left and right eyes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("AREDS")</code></pre>


<h3>Format</h3>

<p>A data frame with 1258 observations (629 subjects with 2 eyes) on the following 8 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>ind</code></dt><dd><p>margin indicator, 1=left eye, 2=right eye</p>
</dd>
<dt><code>Left</code></dt><dd><p>left bound of observed interval</p>
</dd>
<dt><code>Right</code></dt><dd><p>right bound of observed interval</p>
</dd>
<dt><code>status</code></dt><dd><p>censoring indicator; 1=interval-censor, 0=right censor.</p>
</dd>
<dt><code>SevScaleBL</code></dt><dd><p>baseline AMD severity score, margin-specific</p>
</dd>
<dt><code>ENROLLAGE</code></dt><dd><p>age at baseline</p>
</dd>
<dt><code>rs2284665</code></dt><dd><p>a SNP covariate highly associated with late-AMD progression, coded as 0,1,2</p>
</dd>
</dl>



<h3>Source</h3>

<p>AREDS Group (1999). The Age-Related Eye Disease Study (AREDS): design implications. AREDS report no. 1. <em>Control Clinical Trials</em> <strong>20</strong>, 573-600.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AREDS)
copula2_sp &lt;- ic_spTran_copula(data = AREDS,
              copula = "Copula2",
              var_list = c("ENROLLAGE",
                           "rs2284665",
                           "SevScaleBL"),
              l = 0, u = 15, m = 3, r = 3)
summary(copula2_sp)
</code></pre>

<hr>
<h2 id='BIC.CopulaCenR'>the BIC of a CopulaCenR object</h2><span id='topic+BIC.CopulaCenR'></span>

<h3>Description</h3>

<p>the BIC of a CopulaCenR object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC.CopulaCenR_+3A_object">object</code></td>
<td>
<p>a CopulaCenR object</p>
</td></tr>
<tr><td><code id="BIC.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>

<hr>
<h2 id='coef.CopulaCenR'>the coefficient estimates of a CopulaCenR object</h2><span id='topic+coef.CopulaCenR'></span>

<h3>Description</h3>

<p>the coefficient estimates of a CopulaCenR object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.CopulaCenR_+3A_object">object</code></td>
<td>
<p>a CopulaCenR object</p>
</td></tr>
<tr><td><code id="coef.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>

<hr>
<h2 id='CopulaCenR'>
Copula-based regression models for bivariate censored data
</h2><span id='topic+CopulaCenR'></span>

<h3>Description</h3>

<p>Bivariate time-to-event data frequently arise in research areas such as clinical trials and epidemiological studies, where the occurrence of two events are correlated. In many cases, the exact event times are unknown due to censoring. Specifically, bivariate right-censored data occur when the study ends prior to the occurrence of one or both events. In another situation, bivariate interval-censored data occur when the status of both events are periodically examined at intermittent assessment times. In this case, the right censoring could also happen if the event still does not occur at the last assessment time. A special case of interval-censored data is the current status data if there is only one assessment time and the event is only known to occur or not by its assessment time. <br />
</p>
<p>The copula model is a popular approach for modeling correlated bivariate censored data. One unique feature of copula is that it models the two marginal distributions and the between-margin dependence separately, allowing flexibility in marginal models and straightforward interpretation for covariate effects. Moreover, the challenge from censoring can be naturally handled through the marginal distributions within the copula function. Besides, the joint, marginal and conditional distributions can be obtained based on the copula model. However, there is a lack of R package implementing copula-based regression models for bivariate data under both right- and interval-censoring. <br />
</p>
<p>The CopulaCenR package can build copula-based regression models for both bivariate right-censored data and bivariate interval-censored data (including the special case of bivariate current status data). The package is flexible in terms of various built-in Archimedean copulas (such as Clayton, Gumbel, Frank, Joe, AMH), together with a two-parameter copula (Copula2) that incorporates the popular Clayton and Gumbel copulas as special cases. It also allows a broad class of marginal distributions, including parametric (i.e.,Weibull, Gompertz, Loglogistic) and semiparametric (i.e., unspecified functions, such as Cox, transformation) margins. <br />
</p>
<p>The main features of CopulaCenR are: <br />
(1) Copula models with parametric margins: <code>rc_par_copula</code> and <code>ic_par_copula</code>) for bivariate right-censored data and bivariate interval-censored data, respectively. <br />
</p>
<p>(2) Copula models with semiparametric margins: <code>rc_spCox_copula</code> and <code>ic_spTran_copula</code>) for bivariate right-censored data and bivariate interval-censored data, respectively. <br />
</p>
<p>(3) Wald (performed during model fitting), score (<code>score_copula</code>) and likelihood-ratio (<code>lrt_copula</code>) tests for covariate effects. <br />
</p>
<p>(4) Calculate Kendall's tau from a fitted model: <code>tau_copula</code>. <br />
</p>
<p>(5) Calculate other model parameters using S3 methods: <code>print</code>, <code>summary</code>, <code>coef</code>, <code>logLik</code>, <code>AIC</code>, <code>BIC</code>. <br />
</p>
<p>(6) Extract fitted values (such as linear predictors and survival probabilities) from a fitted model: <code>fitted</code>. <br />
</p>
<p>(7) Predict in new observations (such as linear predictors and survival probabilities) from a fitted model: <code>predict</code>. <br />
</p>
<p>(8) Plot joint, conditional and marginal survival probability profiles for given subjects based on a fitted model: <code>plot</code>, <code>lines</code>. <br />
</p>
<p>(9) A user-friendly function to simulate bivariate event times: <code>data_sim_copula</code>. <br />
</p>


<h3>Source</h3>

<p>Tao Sun, Yi Liu, Richard J. Cook, Wei Chen and Ying Ding (2018). Copula-based Score Test for Bivariate Time-to-event Data, with Application to a Genetic Study of AMD Progression. #' <em>Lifetime Data Analysis</em> 25(3), 546???568. <br />
</p>
<p>Tao Sun and Ying Ding (In Press). Copula-based Semiparametric Regression Method for Bivariate Data under General Interval Censoring. http://arxiv.org/abs/1901.01918. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### bivariate right-censored data
data(DRS)
# fit a Clayton-Weibull model
clayton_wb &lt;- rc_par_copula(data = DRS,
                            var_list = "treat",
                            copula = "Clayton",
                            m.dist = "Weibull")
summary(clayton_wb)

### bivariate interval-censored data
data(AREDS)
copula2_sp &lt;- ic_spTran_copula(data = AREDS,
              copula = "Copula2", l = 0, u = 15,
              m = 3, r = 3, var_list =
              c("ENROLLAGE", "rs2284665",
              "SevScaleBL"))
summary(copula2_sp)
</code></pre>

<hr>
<h2 id='data_scmprisk'>
data_scmprisk
</h2><span id='topic+data_scmprisk'></span>

<h3>Description</h3>

<p>A simulated real dataset of interval-censored semi-competing risks data with 500 subjects and 10 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data_scmprisk")</code></pre>


<h3>Format</h3>

<p>A data frame with 500 subjects on the following 10 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>Left</code></dt><dd><p>left bound of observed interval of non-terminal event</p>
</dd>
<dt><code>Right</code></dt><dd><p>right bound of observed interval of non-terminal event</p>
</dd>
<dt><code>status</code></dt><dd><p>censoring indicator of non-terminal event; 1=interval-censor, 0=right censor.</p>
</dd>
<dt><code>timeD</code></dt><dd><p>observed time of non-terminal event</p>
</dd>
<dt><code>statusD</code></dt><dd><p>censoring indicator of terminal event; 1=interval-censor, 0=right censor.</p>
</dd>
<dt><code>A</code></dt><dd><p>study entry time (i.e., left truncation time).</p>
</dd>
<dt><code>x1</code></dt><dd><p>first covariate</p>
</dd>
<dt><code>x2</code></dt><dd><p>second covariate</p>
</dd>
<dt><code>x3</code></dt><dd><p>third covariate</p>
</dd>
</dl>


<hr>
<h2 id='data_sim_copula'>Simulate bivariate time-to-event times based on specific copula and marginal distributions</h2><span id='topic+data_sim_copula'></span>

<h3>Description</h3>

<p>To generate a sample of subjects with two correlated event times based on specific copula and marginal models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_sim_copula(n, copula, eta, dist, baseline, var_list, COV_beta, x1, x2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data_sim_copula_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="data_sim_copula_+3A_copula">copula</code></td>
<td>
<p>types of copula, including <code>"Clayton"</code>, <code>"Gumbel"</code>,
<code>"Frank"</code>, <code>"AMH"</code>, <code>"Joe"</code></p>
</td></tr>
<tr><td><code id="data_sim_copula_+3A_eta">eta</code></td>
<td>
<p>copula parameter <code class="reqn">\eta</code></p>
</td></tr>
<tr><td><code id="data_sim_copula_+3A_dist">dist</code></td>
<td>
<p>marginal distributions, including <code>"Weibull"</code>,
<code>"Gompertz"</code>, <code>"Loglogistic"</code></p>
</td></tr>
<tr><td><code id="data_sim_copula_+3A_baseline">baseline</code></td>
<td>
<p>marginal distribution parameters.
For <code>Weibull</code> and <code>Loglogistic</code>, it shall be <code class="reqn">\lambda</code> (scale) and <code class="reqn">k</code> (shape);
for <code>Gompertz</code>, it shall be <code class="reqn">a</code> (shape) and <code class="reqn">b</code> (rate)</p>
</td></tr>
<tr><td><code id="data_sim_copula_+3A_var_list">var_list</code></td>
<td>
<p>a vector of covariate names;
assume the same covariates for two margins</p>
</td></tr>
<tr><td><code id="data_sim_copula_+3A_cov_beta">COV_beta</code></td>
<td>
<p>a vector of regression coefficients corresponding to <code>var_list</code>;
assume the same coefficients between two margins</p>
</td></tr>
<tr><td><code id="data_sim_copula_+3A_x1">x1</code></td>
<td>
<p>a data frame of covariates for margin 1; it shall have n rows,
with columns corresponding to the <code>var_list</code></p>
</td></tr>
<tr><td><code id="data_sim_copula_+3A_x2">x2</code></td>
<td>
<p>a data frame of covariates for margin 2</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parametric generator functions of copula functions are list below:
</p>
<p>The Clayton copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1+t)^{-1/\eta},</code>
</p>

<p>with <code class="reqn">\eta &gt; 0</code> and Kendall's <code class="reqn">\tau = \eta/(2+\eta)</code>.
</p>
<p>The Gumbel copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \exp(-t^{1/\eta}),</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 1/\eta</code>.
</p>
<p>The Frank copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = -\eta^{-1}\log \{1+e^{-t}(e^{-\eta}-1)\},</code>
</p>

<p>with <code class="reqn">\eta \geq 0</code> and Kendall's <code class="reqn">\tau = 1+4\{D_1(\eta)-1\}/\eta</code>,
in which <code class="reqn">D_1(\eta) = \frac{1}{\eta} \int_{0}^{\eta} \frac{t}{e^t-1}dt</code>.
</p>
<p>The AMH copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1-\eta)/(e^{t}-\eta),</code>
</p>

<p>with <code class="reqn">\eta \in [0,1)</code> and Kendall's <code class="reqn">\tau =  1-2\{(1-\eta)^2 \log (1-\eta) + \eta\}/(3\eta^2)</code>.
</p>
<p>The Joe copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = 1-(1-e^{-t})^{1/\eta},</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 4 \sum_{k=1}^{\infty} \frac{1}{k(\eta k+2)\{\eta(k-1)+2\}}</code>. <br />
</p>
<p>The marginal survival distributions are listed below:
</p>
<p>The Weibull (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-(t/\lambda)^k  e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape.
</p>
<p>The Gompertz (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-\frac{b}{a}(e^{at}-1) e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">a &gt; 0</code> as shape and <code class="reqn">b &gt; 0</code> as rate
</p>
<p>The Loglogistic (PO) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\{1+(t/\lambda)^{k} e^{Z^{\top}\beta} \}^{-1},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape.
</p>


<h3>Value</h3>

<p>a data frame of bivariate time-to-event data with covariates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(CopulaCenR)
set.seed(1)
dat &lt;- data_sim_copula(n = 500, copula = "Clayton", eta = 3,
                       dist = "Weibull", baseline = c(0.1,2),
                       var_list = c("var1", "var2"),
                       COV_beta = c(0.1, 0.1),
                       x1 = cbind(rnorm(500, 6, 2),
                                  rbinom(500, 1, 0.5)),
                       x2 =  cbind(rnorm(500, 6, 2),
                                   rbinom(500, 1, 0.5)))
plot(x = dat$time[dat$ind == 1], y = dat$time[dat$ind == 2],
     xlab = expression(t[1]), ylab = expression(t[2]),
     cex.axis = 1, cex.lab = 1.3)
</code></pre>

<hr>
<h2 id='data_sim_ic'>
data_sim_ic
</h2><span id='topic+data_sim_ic'></span>

<h3>Description</h3>

<p>A simulated real dataset of bivariate interval-censored data with 500 subjects and 7 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data_sim_ic")</code></pre>


<h3>Format</h3>

<p>A data frame with 500 subjects on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>Left.L</code></dt><dd><p>left bound of the first event</p>
</dd>
<dt><code>Right.L</code></dt><dd><p>right bound of the first event</p>
</dd>
<dt><code>status.L</code></dt><dd><p>censoring indicator of the first event; 1=interval censor, 0=right censor.</p>
</dd>
<dt><code>Left.R</code></dt><dd><p>left bound of the second event</p>
</dd>
<dt><code>Right.R</code></dt><dd><p>right bound of the second event</p>
</dd>
<dt><code>status.R</code></dt><dd><p>censoring indicator of the second event; 1=interval censor, 0=right censor.</p>
</dd>
</dl>


<hr>
<h2 id='data_sim_multi_rec'>
data_sim_multi_rec
</h2><span id='topic+data_sim_multi_rec'></span>

<h3>Description</h3>

<p>A simulated real dataset of multivariate recurrent events data with 300 subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data_sim_multi_rec")</code></pre>


<h3>Format</h3>

<p>A list with 300 subjects on the following 2 components.
</p>

<dl>
<dt><code>gaptimes</code></dt><dd><p>a data frame with 300 subjects in row and 4 gap times in column</p>
</dd>
<dt><code>status</code></dt><dd><p>a data frame with 300 subjects in row and 4 statuses in column</p>
</dd>
</dl>


<hr>
<h2 id='data_sim_RC'>
data_sim_RC
</h2><span id='topic+data_sim_RC'></span>

<h3>Description</h3>

<p>A simulated real dataset of bivariate right-censored data with 500 subjects and 5 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data_sim_RC")</code></pre>


<h3>Format</h3>

<p>A data frame with 500 subjects on the following 5 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>event_time.L</code></dt><dd><p>observed time of the first event</p>
</dd>
<dt><code>status.L</code></dt><dd><p>censoring indicator of the first event; 1=exactly observed, 0=right censor.</p>
</dd>
<dt><code>event_time.R</code></dt><dd><p>observed time of the second event</p>
</dd>
<dt><code>status.R</code></dt><dd><p>censoring indicator of the second event; 1=exactly observed, 0=right censor.</p>
</dd>
</dl>


<hr>
<h2 id='data_sim_rec'>
data_sim_rec
</h2><span id='topic+data_sim_rec'></span>

<h3>Description</h3>

<p>A simulated real dataset of bivariate recurrent events data with 500 subjects and 6 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data_sim_rec")</code></pre>


<h3>Format</h3>

<p>A data frame with 500 subjects on the following 6 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>gap1</code></dt><dd><p>observed time of the first gap time</p>
</dd>
<dt><code>status1</code></dt><dd><p>censoring indicator of the first event; 1=exactly observed, 0=right censor.</p>
</dd>
<dt><code>gap2</code></dt><dd><p>observed time of the second gap time</p>
</dd>
<dt><code>status2</code></dt><dd><p>censoring indicator of the second event; 1=exactly observed, 0=right censor.</p>
</dd>
<dt><code>d</code></dt><dd><p>cluster size</p>
</dd>
</dl>


<hr>
<h2 id='data_sim_scmprisk_vs'>
data_sim_scmprisk_vs
</h2><span id='topic+data_sim_scmprisk_vs'></span>

<h3>Description</h3>

<p>A simulated real dataset of bivariate time-to-event data based on specific copula and marginal distributions with 500 subjects and 10 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data_sim_scmprisk_vs")</code></pre>


<h3>Format</h3>

<p>A data frame with 500 subjects on the following 10 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>ind</code></dt><dd><p>1,2 for two margins</p>
</dd>
<dt><code>x1</code></dt><dd><p>first covariate</p>
</dd>
<dt><code>x2</code></dt><dd><p>second covariate</p>
</dd>
<dt><code>x3</code></dt><dd><p>third covariate</p>
</dd>
<dt><code>x4</code></dt><dd><p>fourth covariate</p>
</dd>
<dt><code>x5</code></dt><dd><p>fifth covariate</p>
</dd>
<dt><code>time</code></dt><dd><p>time to event</p>
</dd>
<dt><code>obs_time</code></dt><dd><p>observed time</p>
</dd>
<dt><code>status</code></dt><dd><p>0 for right-censoring, 1 for event</p>
</dd>
</dl>


<hr>
<h2 id='DRS'>
DRS
</h2><span id='topic+DRS'></span>

<h3>Description</h3>

<p>A real dataset of bivariate right-censored data with 197 subjects and 3 covariates. The patients were a 50% random sample of the patients with &quot;high-risk&quot; diabetic retinopathy as defined by the Diabetic Retinopathy Study (DRS) (Huster, 1989).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DRS")</code></pre>


<h3>Format</h3>

<p>A data frame with 394 observations on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>ind</code></dt><dd><p>margin indicator, 1 for right eye, 2 for left eye</p>
</dd>
<dt><code>obs_time</code></dt><dd><p>time of blindness (in months) from treatment</p>
</dd>
<dt><code>status</code></dt><dd><p>censoring indicator, 1 = blindness, 0 = right censoring</p>
</dd>
<dt><code>treat</code></dt><dd><p>laser treatment type, 0 = no treatment, 1 = xenon, 2 = argon</p>
</dd>
<dt><code>age</code></dt><dd><p>age at diagnosis of diabetes</p>
</dd>
<dt><code>type</code></dt><dd><p>type of diabetes, 1 = juvenile (age at treatment &lt; 20), 2 = adult</p>
</dd>
</dl>



<h3>Details</h3>

<p>Each patient had one eye randomized to laser treatment and the other eye received no treatment. For each eye, the event of interest was the time from initiation of treatment to the time when visual acuity dropped below 5/200 (call it &quot;blindness&quot;). Survival times in this dataset are the actual time to blindness in months. Censoring was caused by death, dropout, or end of the study.
</p>


<h3>Source</h3>

<p>https://www.mayo.edu/research/documents/DRShtml/DOC-10027460
</p>


<h3>References</h3>

<p>Huster WJ, Brookmeyer R, Self SG (1989). Modeling paired survival data with covariates. <em>Biometrics</em> <strong>45</strong>, 145-156.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DRS)
clayton_wb &lt;- rc_par_copula(data = DRS,
              var_list = "treat",
              copula = "Clayton",
              m.dist = "Weibull")
summary(clayton_wb)
</code></pre>

<hr>
<h2 id='fitted.CopulaCenR'>Fitted values from CopulaCenR regression models</h2><span id='topic+fitted.CopulaCenR'></span>

<h3>Description</h3>

<p>Fitted values based on models from <code>ic_spTran_copula</code>, <code>rc_spCox_copula</code>,
<code>ic_par_copula</code> and <code>rc_par_copula</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
fitted(object, type = "lp", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.CopulaCenR_+3A_object">object</code></td>
<td>
<p>a <code>CopulaCenR</code> object from <code>ic_spTran_copula</code>,
<code>rc_spCox_copula</code>, <code>ic_par_copula</code> and <code>rc_par_copula</code></p>
</td></tr>
<tr><td><code id="fitted.CopulaCenR_+3A_type">type</code></td>
<td>
<p><code>"lp"</code> for linear predictors or
<code>"survival"</code> for marginal and joint survival probabilities</p>
</td></tr>
<tr><td><code id="fitted.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the argument <code>type = "lp"</code>, it gives a linear predictor for each margin
(i.e., log hazards ratio in the proportional hazards model,
log proportional odds in the proportional odds model). <br />
</p>
<p>When the argument <code>type = "survival"</code> and the fitted data is bivariate right-censored,
the marginal and joint survival values will be evaluated at the observed times.
For bivariate interval-censored, evaluation times are the interval middle points or
left bound (if right bound is infinity). <br />
</p>


<h3>Value</h3>

<p>If <code>type = "lp"</code>, it returns a data frame with <code>id</code>,
<code>lp1</code> (linear predictor for margin 1), <code>lp2</code>.
If <code>type = "survival"</code>, it returns a data frame with <code>id</code>,
<code>t1</code> (evaluated times for the margin 1), <code>t2</code>,
<code>S1</code> (predicted marginal survival probabilities for margin 1),
<code>S2</code> and <code>S12</code> (the predicted joint survival probabilities)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AREDS)
# fit a Copula2-Sieve model
copula2_sp &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
              l = 0, u = 15, m = 3, r = 3,
              var_list = c("ENROLLAGE","rs2284665","SevScaleBL"))
output &lt;- fitted(object = copula2_sp)
</code></pre>

<hr>
<h2 id='ic_par_copula'>Copula regression models with parametric margins for bivariate interval-censored data</h2><span id='topic+ic_par_copula'></span>

<h3>Description</h3>

<p>Fits a copula model with parametric margins for bivariate interval-censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ic_par_copula(
  data,
  var_list,
  copula,
  m.dist = "Weibull",
  method = "BFGS",
  iter = 300,
  stepsize = 1e-05,
  hes = TRUE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ic_par_copula_+3A_data">data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>ind</code> (1,2 for two units in each subject),
<code>Left</code> (0 if left-censoring), <code>Right</code> (Inf if right-censoring), <code>status</code> (0 for right-censoring,
1 for interval-censoring or left-censoring), and <code>covariates</code> by column.</p>
</td></tr>
<tr><td><code id="ic_par_copula_+3A_var_list">var_list</code></td>
<td>
<p>the list of covariates to be fitted into the copula model.</p>
</td></tr>
<tr><td><code id="ic_par_copula_+3A_copula">copula</code></td>
<td>
<p>Types of copula model.</p>
</td></tr>
<tr><td><code id="ic_par_copula_+3A_m.dist">m.dist</code></td>
<td>
<p>baseline marginal distribution.</p>
</td></tr>
<tr><td><code id="ic_par_copula_+3A_method">method</code></td>
<td>
<p>optimization method (see ?optim); default is &quot;BFGS&quot;;
also can be &quot;Newton&quot; (see ?nlm).</p>
</td></tr>
<tr><td><code id="ic_par_copula_+3A_iter">iter</code></td>
<td>
<p>number of iterations when method is <code>"Newton"</code>;
default is 300.</p>
</td></tr>
<tr><td><code id="ic_par_copula_+3A_stepsize">stepsize</code></td>
<td>
<p>size of optimization step when method is <code>"Newton"</code>;
default is 1e-5.</p>
</td></tr>
<tr><td><code id="ic_par_copula_+3A_hes">hes</code></td>
<td>
<p>default is <code>TRUE</code> for hessian calculation.</p>
</td></tr>
<tr><td><code id="ic_par_copula_+3A_control">control</code></td>
<td>
<p>a list of control parameters for methods other than <code>"Newton"</code>;
see <code>?optim</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data must be a data frame. with columns <code>id</code> (sample id),
<code>ind</code> (1,2 for the two units from the same id),
<code>Left</code> (0 if left-censoring), <code>Right</code> (Inf if right-censoring),
<code>status</code> (0 for right-censoring, 1 for interval-censoring or left-censoring),
and <code>covariates</code>. The function does not allow <code>Left</code> == <code>Right</code>. <br />
</p>
<p>The supported copula models are <code>"Clayton"</code>, <code>"Gumbel"</code>, <code>"Frank"</code>,
<code>"AMH"</code>, <code>"Joe"</code> and <code>"Copula2"</code>.
The <code>"Copula2"</code> model is a two-parameter copula model that incorporates <code>Clayton</code>
and <code>Gumbel</code> as special cases.
The parametric generator functions of copula functions are list below:
</p>
<p>The Clayton copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1+t)^{-1/\eta},</code>
</p>

<p>with <code class="reqn">\eta &gt; 0</code> and Kendall's <code class="reqn">\tau = \eta/(2+\eta)</code>.
</p>
<p>The Gumbel copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \exp(-t^{1/\eta}),</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 1/\eta</code>.
</p>
<p>The Frank copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = -\eta^{-1}\log \{1+e^{-t}(e^{-\eta}-1)\},</code>
</p>

<p>with <code class="reqn">\eta \geq 0</code> and Kendall's <code class="reqn">\tau = 1+4\{D_1(\eta)-1\}/\eta</code>,
in which <code class="reqn">D_1(\eta) = \frac{1}{\eta} \int_{0}^{\eta} \frac{t}{e^t-1}dt</code>.
</p>
<p>The AMH copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1-\eta)/(e^{t}-\eta),</code>
</p>

<p>with <code class="reqn">\eta \in [0,1)</code> and Kendall's <code class="reqn">\tau =  1-2\{(1-\eta)^2 \log (1-\eta) + \eta\}/(3\eta^2)</code>.
</p>
<p>The Joe copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = 1-(1-e^{-t})^{1/\eta},</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 4 \sum_{k=1}^{\infty} \frac{1}{k(\eta k+2)\{\eta(k-1)+2\}}</code>.
</p>
<p>The Two-parameter copula (Copula2) has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \{1/(1+t^{\alpha})\}^{\kappa},</code>
</p>

<p>with <code class="reqn">\alpha \in (0,1], \kappa &gt; 0</code> and Kendall's <code class="reqn">\tau = 1-2\alpha\kappa/(2\kappa+1)</code>. <br />
</p>
<p>The supported marginal distributions are <code>"Weibull"</code> (proportional hazards),
<code>"Gompertz"</code> (proportional hazards) and <code>"Loglogistic"</code> (proportional odds).
These marginal distributions are listed below
and we assume the same baseline parameters between two margins. <br />
</p>
<p>The Weibull (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-(t/\lambda)^k  e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape.
</p>
<p>The Gompertz (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-\frac{b}{a}(e^{at}-1) e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">a &gt; 0</code> as shape and <code class="reqn">b &gt; 0</code> as rate.
</p>
<p>The Loglogistic (PO) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\{1+(t/\lambda)^{k} e^{Z^{\top}\beta} \}^{-1},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape. <br />
</p>
<p>Optimization methods can be all methods (except <code>"Brent"</code>) from <code>optim</code>, such as
<code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code>.
Users can also use <code>"Newton"</code> (from <code>nlm</code>).
</p>


<h3>Value</h3>

<p>a <code>CopulaCenR</code> object summarizing the model.
Can be used as an input to general <code>S3</code> methods including
<code>summary</code>, <code>print</code>, <code>plot</code>, <code>lines</code>,
<code>coef</code>, <code>logLik</code>, <code>AIC</code>,
<code>BIC</code>, <code>fitted</code>, <code>predict</code>.
</p>


<h3>Source</h3>

<p>Tao Sun, Yi Liu, Richard J. Cook, Wei Chen and Ying Ding (2019).
Copula-based Score Test for Bivariate Time-to-event Data,
with Application to a Genetic Study of AMD Progression.
<em>Lifetime Data Analysis</em> 25(3), 546-568. <br />
Tao Sun and Ying Ding (In Press).
Copula-based Semiparametric Regression Model for Bivariate Data
under General Interval Censoring.
<em>Biostatistics</em>. DOI: 10.1093/biostatistics/kxz032.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a Copula2-Weibull model
data(AREDS)
copula2_wb &lt;- ic_par_copula(data = AREDS, copula = "Copula2",
                  m.dist = "Weibull",
                  var_list = c("ENROLLAGE","rs2284665"))
summary(copula2_wb)
</code></pre>

<hr>
<h2 id='ic_scmprisk_spTran_copula'>Copula regression models with semi-parametric transformation margins for semi-competing risk data under interval-censoring and left-truncation</h2><span id='topic+ic_scmprisk_spTran_copula'></span>

<h3>Description</h3>

<p>Fits a copula model with semi-parametric transformation margins for semi-competing risk data under interval-censoring and left-truncation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ic_scmprisk_spTran_copula(
  data,
  var_list,
  copula = "Copula2",
  l1 = 0,
  u1,
  m1 = 3,
  r1 = 1,
  l2 = 0,
  u2,
  m2 = 3,
  r2 = 1,
  method = "BFGS",
  iter = 1000,
  stepsize = 1e-05,
  control = list(),
  eta_ini = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_data">data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>Left</code> (0 if left-censoring for non-terminal event),
<code>Right</code> (Inf if right-censoring for non-terminal event), <code>status</code> (0 for right-censoring,
1 for interval-censoring or left-censoring of non-terminal event), <code>timeD</code> (observed terminal event),
<code>statusD</code> (for terminal event), <code>A</code> (left truncation time, 0 if none), and <code>covariates</code> by column.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_var_list">var_list</code></td>
<td>
<p>the list of covariates to be fitted into the copula model.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_copula">copula</code></td>
<td>
<p>Types of copula model, only Copula2 is supported at this stage.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_l1">l1</code></td>
<td>
<p>for non-terminal event, the left bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
default is 0.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_u1">u1</code></td>
<td>
<p>for non-terminal event, the right bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
has to be a finite value</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_m1">m1</code></td>
<td>
<p>for non-terminal event, integer, degree of Berstein polynomials for both margins; default is 3</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_r1">r1</code></td>
<td>
<p>for non-terminal event, postive transformation parameter for the semiparametric transformation marginal model.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_l2">l2</code></td>
<td>
<p>for terminal event, the left bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
default is 0.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_u2">u2</code></td>
<td>
<p>for terminal event, the right bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
has to be a finite value</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_m2">m2</code></td>
<td>
<p>for terminal event, integer, degree of Berstein polynomials for both margins; default is 3</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_r2">r2</code></td>
<td>
<p>for terminal event, postive transformation parameter for the semiparametric transformation marginal model.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_method">method</code></td>
<td>
<p>optimization method (see ?optim); default is &quot;BFGS&quot;;
also can be &quot;Newton&quot; (see ?nlm).</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_iter">iter</code></td>
<td>
<p>number of iterations when method is <code>"Newton"</code>;
default is 300.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_stepsize">stepsize</code></td>
<td>
<p>size of optimization step when method is <code>"Newton"</code>;
default is 1e-5.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_control">control</code></td>
<td>
<p>a list of control parameters for methods other than <code>"Newton"</code>;
see <code>?optim</code>.</p>
</td></tr>
<tr><td><code id="ic_scmprisk_spTran_copula_+3A_eta_ini">eta_ini</code></td>
<td>
<p>a vector of initial values for copula parameters, default is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data must be a data frame. with columns <code>id</code> (sample id),
<code>Left</code> (0 if left-censoring), <code>Right</code> (Inf if right-censoring),
<code>status</code> (0 for right-censoring, 1 for interval-censoring or left-censoring),
<code>timeD</code> (for terminal event), <code>statusD</code>,<code>A</code> (0 if no left truncation),
and <code>covariates</code>. The function does not allow <code>Left</code> == <code>Right</code>. <br />
</p>
<p>The supported copula model in this version is <code>"Copula2"</code>.
The <code>"Copula2"</code> model is a two-parameter copula model that incorporates <code>Clayton</code>
and <code>Gumbel</code> as special cases.
The parametric generator functions of copula functions are list below:
</p>
<p>The Two-parameter copula (Copula2) has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \{1/(1+t^{\alpha})\}^{\kappa},</code>
</p>

<p>with <code class="reqn">\alpha \in (0,1], \kappa &gt; 0</code> and Kendall's <code class="reqn">\tau = 1-2\alpha\kappa/(2\kappa+1)</code>. <br />
</p>
<p>The marginal semiparametric transformation models are built based on Bernstein polynomials, which is formulated below:
</p>
<p style="text-align: center;"><code class="reqn">S(t|Z) = \exp[-G\{\Lambda(t) e^{Z^{\top}\beta}\}],</code>
</p>
<p> where <code class="reqn">t</code> is time, <code class="reqn">Z</code> is covariate,
<code class="reqn">\beta</code> is coefficient and <code class="reqn">\Lambda(t)</code> is an unspecified function with infinite dimensions.
We approximate <code class="reqn">\Lambda(t)</code> in a sieve space constructed by Bernstein polynomials with degree <code class="reqn">m</code>. By default, <code class="reqn">m=3</code>.
In the end, all model parameters are estimated by the sieve estimators (Sun and Ding, In Press).
</p>
<p>The <code class="reqn">G(\cdot)</code> function is the transformation function with a parameter <code class="reqn">r &gt; 0</code>, which has a form of
<code class="reqn">G(x) = \frac{(1+x)^r - 1}{r}</code>, when <code class="reqn">0 &lt; r \leq 2</code> and <code class="reqn">G(x) = \frac{\log\{1 + (r-2)x\}}{r - 2}</code> when <code class="reqn">r &gt; 2</code>.
When <code class="reqn">r = 1</code>, the marginal model becomes a proportional hazards model;
when <code class="reqn">r = 3</code>, the marginal model becomes a proportional odds model.
In practice, <code>m</code> and <code>r</code> can be selected based on the AIC value. <br />
</p>
<p>Optimization methods can be all methods (except <code>"Brent"</code>) from <code>optim</code>, such as
<code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code>.
Users can also use <code>"Newton"</code> (from <code>nlm</code>).
</p>


<h3>Value</h3>

<p>a <code>CopulaCenR</code> object summarizing the model.
Can be used as an input to general <code>S3</code> methods including
<code>summary</code>, <code>print</code>, <code>coef</code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>.
</p>


<h3>Source</h3>

<p>Tao Sun, Yunlong Li, Zhengyan Xiao, Ying Ding, Xiaojun Wang (2022).
Semiparametric copula method for semi-competing risks data
subject to interval censoring and left truncation:
Application to disability in elderly. Statistical Methods in Medical Research (Accepted).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a Copula2-Semiparametric model
data("data_scmprisk")
copula2_sp &lt;- ic_scmprisk_spTran_copula(data = data_scmprisk,
              var_list = c("x1"), copula = "Copula2",
              l1=0, u1 = 21, m1 = 3, r1 = 1,
              l2=0, u2 = 21, m2 = 3, r2 = 1,
              )
summary(copula2_sp)
</code></pre>

<hr>
<h2 id='ic_spTran_copula'>Copula regression models with semiparametric margins for bivariate interval-censored data</h2><span id='topic+ic_spTran_copula'></span>

<h3>Description</h3>

<p>Fits a copula model with semiparametric margins for bivariate interval-censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ic_spTran_copula(
  data,
  var_list,
  l = 0,
  u,
  copula = "Copula2",
  m = 3,
  r = 3,
  method = "BFGS",
  iter = 300,
  stepsize = 1e-06,
  hes = TRUE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ic_spTran_copula_+3A_data">data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>ind</code> (1,2 for two units in each subject),
<code>Left</code> (0 if left-censoring), <code>Right</code> (Inf if right-censoring), <code>status</code> (0 for right-censoring,
1 for interval-censoring or left-censoring), and <code>covariates</code> by column.</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_var_list">var_list</code></td>
<td>
<p>the list of covariates to be fitted into the copula model.</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_l">l</code></td>
<td>
<p>the left bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
default is 0.</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_u">u</code></td>
<td>
<p>the right bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
has to be a finite value</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_copula">copula</code></td>
<td>
<p>Types of copula model.</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_m">m</code></td>
<td>
<p>integer, degree of Berstein polynomials for both margins; default is 3</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_r">r</code></td>
<td>
<p>postive transformation parameter for the semiparametric transformation marginal model.</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_method">method</code></td>
<td>
<p>optimization method (see <code>?optim</code>); default is <code>"BFGS"</code>;
also can be <code>"Newton"</code> (see <code>?nlm</code>).</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_iter">iter</code></td>
<td>
<p>number of iterations when <code>method = "Newton"</code>;
default is 300.</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_stepsize">stepsize</code></td>
<td>
<p>size of optimization step when method is <code>"Newton"</code>;
default is 1e-6.</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_hes">hes</code></td>
<td>
<p>default is <code>TRUE</code> for hessian calculation;
if LRT is desired, can set <code>hes = FALSE</code> to save time.</p>
</td></tr>
<tr><td><code id="ic_spTran_copula_+3A_control">control</code></td>
<td>
<p>a list of control parameters for methods other than <code>"Newton"</code>;
see ?optim.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data must be a data frame. with columns <code>id</code> (sample id),
<code>ind</code> (1,2 for the two units from the same id),
<code>Left</code> (0 if left-censoring), <code>Right</code> (Inf if right-censoring),
<code>status</code> (0 for right-censoring, 1 for interval-censoring or left-censoring),
and <code>covariates</code>. The function does not allow <code>Left</code> == <code>Right</code>. <br />
</p>
<p>The supported copula models are <code>"Clayton"</code>, <code>"Gumbel"</code>, <code>"Frank"</code>,
<code>"AMH"</code>, <code>"Joe"</code> and <code>"Copula2"</code>.
The <code>"Copula2"</code> model is a two-parameter copula model that incorporates <code>Clayton</code>
and <code>Gumbel</code> as special cases.
The parametric generator functions of copula functions are list below:
</p>
<p>The Clayton copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1+t)^{-1/\eta},</code>
</p>

<p>with <code class="reqn">\eta &gt; 0</code> and Kendall's <code class="reqn">\tau = \eta/(2+\eta)</code>.
</p>
<p>The Gumbel copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \exp(-t^{1/\eta}),</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 1/\eta</code>.
</p>
<p>The Frank copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = -\eta^{-1}\log \{1+e^{-t}(e^{-\eta}-1)\},</code>
</p>

<p>with <code class="reqn">\eta \geq 0</code> and Kendall's <code class="reqn">\tau = 1+4\{D_1(\eta)-1\}/\eta</code>,
in which <code class="reqn">D_1(\eta) = \frac{1}{\eta} \int_{0}^{\eta} \frac{t}{e^t-1}dt</code>.
</p>
<p>The AMH copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1-\eta)/(e^{t}-\eta),</code>
</p>

<p>with <code class="reqn">\eta \in [0,1)</code> and Kendall's <code class="reqn">\tau =  1-2\{(1-\eta)^2 \log (1-\eta) + \eta\}/(3\eta^2)</code>.
</p>
<p>The Joe copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = 1-(1-e^{-t})^{1/\eta},</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 4 \sum_{k=1}^{\infty} \frac{1}{k(\eta k+2)\{\eta(k-1)+2\}}</code>.
</p>
<p>The Two-parameter copula (Copula2) has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \{1/(1+t^{\alpha})\}^{\kappa},</code>
</p>

<p>with <code class="reqn">\alpha \in (0,1], \kappa &gt; 0</code> and Kendall's <code class="reqn">\tau = 1-2\alpha\kappa/(2\kappa+1)</code>. <br />
</p>
<p>The marginal semiparametric transformation models are built based on Bernstein polynomials, which is formulated below:
</p>
<p style="text-align: center;"><code class="reqn">S(t|Z) = \exp[-G\{\Lambda(t) e^{Z^{\top}\beta}\}],</code>
</p>
<p> where <code class="reqn">t</code> is time, <code class="reqn">Z</code> is covariate,
<code class="reqn">\beta</code> is coefficient and <code class="reqn">\Lambda(t)</code> is an unspecified function with infinite dimensions.
We approximate <code class="reqn">\Lambda(t)</code> in a sieve space constructed by Bernstein polynomials with degree <code class="reqn">m</code>. By default, <code class="reqn">m=3</code>.
In the end, all model parameters are estimated by the sieve estimators (Sun and Ding, In Press).
</p>
<p>The <code class="reqn">G(\cdot)</code> function is the transformation function with a parameter <code class="reqn">r &gt; 0</code>, which has a form of
<code class="reqn">G(x) = \frac{(1+x)^r - 1}{r}</code>, when <code class="reqn">0 &lt; r \leq 2</code> and <code class="reqn">G(x) = \frac{\log\{1 + (r-2)x\}}{r - 2}</code> when <code class="reqn">r &gt; 2</code>.
When <code class="reqn">r = 1</code>, the marginal model becomes a proportional hazards model;
when <code class="reqn">r = 3</code>, the marginal model becomes a proportional odds model.
In practice, <code>m</code> and <code>r</code> can be selected based on the AIC value. <br />
</p>
<p>Optimization methods can be all methods (except <code>"Brent"</code>) from <code>optim</code>, such as
<code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code>.
Users can also use <code>"Newton"</code> (from <code>nlm</code>).
</p>


<h3>Value</h3>

<p>a <code>CopulaCenR</code> object summarizing the model.
Can be used as an input to general <code>S3</code> methods including
<code>summary</code>, <code>print</code>, <code>plot</code>, <code>lines</code>,
<code>coef</code>, <code>logLik</code>, <code>AIC</code>,
<code>BIC</code>, <code>fitted</code>, <code>predict</code>.
</p>


<h3>Source</h3>

<p>Tao Sun, Yi Liu, Richard J. Cook, Wei Chen and Ying Ding (2019).
Copula-based Score Test for Bivariate Time-to-event Data,
with Application to a Genetic Study of AMD Progression.
<em>Lifetime Data Analysis</em> 25(3), 546-568. <br />
Tao Sun and Ying Ding (In Press).
Copula-based Semiparametric Regression Model for Bivariate Data
under General Interval Censoring.
<em>Biostatistics</em>. DOI: 10.1093/biostatistics/kxz032.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a Copula2-Semiparametric model
data(AREDS)
copula2_sp &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
              l = 0, u = 15, m = 3, r = 3,
              var_list = c("ENROLLAGE","rs2284665","SevScaleBL"))
summary(copula2_sp)
</code></pre>

<hr>
<h2 id='IRsurv'>An information ratio-based goodness-of-fit test for copula models on censored data</h2><span id='topic+IRsurv'></span>

<h3>Description</h3>

<p>Fits an Information ratio (IR)-based goodness-of-fit test for copula models under various censoring types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRsurv(
  data,
  censoring = "rc",
  copula = "clayton",
  fams = c(3, 3, 3),
  R = 200,
  parallel = "no",
  ncpus = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IRsurv_+3A_data">data</code></td>
<td>
<p>the input data; see examples for details.</p>
</td></tr>
<tr><td><code id="IRsurv_+3A_censoring">censoring</code></td>
<td>
<p>types of censoring, including &quot;rc&quot;, &quot;ic&quot;, &quot;rec_bivariate&quot;, &quot;rec_multivariate&quot;.</p>
</td></tr>
<tr><td><code id="IRsurv_+3A_copula">copula</code></td>
<td>
<p>specify the copula family to be tested; default is &quot;clayton&quot;; others include &quot;copula2&quot;, &quot;gumbel&quot;, &quot;frank&quot;, &quot;gaussian&quot;, and &quot;d-vine&quot;. &quot;d-vine&quot; is only for censoring = &quot;rec_multivariate&quot;.</p>
</td></tr>
<tr><td><code id="IRsurv_+3A_fams">fams</code></td>
<td>
<p>specify the unconditional copulas by following the style of the VineCopula package when copula = &quot;d-vine&quot;. Only d = 4 is supported at this stage. The conditional copulas are set as &quot;frank&quot; by default.</p>
</td></tr>
<tr><td><code id="IRsurv_+3A_r">R</code></td>
<td>
<p>number of Bootstraps; default is 200.</p>
</td></tr>
<tr><td><code id="IRsurv_+3A_parallel">parallel</code></td>
<td>
<p>indicator of parallel computing; can be &quot;no&quot; or &quot;multicore&quot;; default is &quot;no&quot;.</p>
</td></tr>
<tr><td><code id="IRsurv_+3A_ncpus">ncpus</code></td>
<td>
<p>number of cpus to be assigned for parallel computing; default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the p value of the IR test
</p>


<h3>Source</h3>

<p>Tao Sun, Yu Cheng, Ying Ding (2022). An information Ratio-based
Goodness-of-Fit Test for Copula Models on Censored Data. Biometrics (Accepted).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Goodness of fit under right censoring
data("data_sim_RC")
test_rc &lt;- IRsurv(data = data_sim_RC, censoring = "rc", copula = "clayton", R = 200)
test_rc
# Goodness of fit under interval censoring
data("data_sim_ic")
test_ic &lt;- IRsurv(data = data_sim_ic, censoring = "ic", copula = "clayton", R = 200)
test_ic
# Goodness of fit under bivariate recurrent events
data("data_sim_rec")
test_rec_bi &lt;- IRsurv(data = data_sim_rec, censoring = "rec_bivariate",
                      copula = "clayton", R = 200)
test_rec_bi
# Goodness of fit of D-vine copula under multivariate recurrent events
data("data_sim_multi_rec")
test_rec_mv &lt;- IRsurv(data = data_sim_multi_rec, censoring = "rec_multivariate",
                      fams = c(3,3,3), R = 200)
test_rec_mv

## End(Not run)
</code></pre>

<hr>
<h2 id='Kidney'>
Kidney
</h2><span id='topic+Kidney'></span>

<h3>Description</h3>

<p>A real dataset of bivariate right-censored data with 38 subjects and 3 covariates. The data are the recurrence times to infection, at the point of insertion of the catheter, for kidney patients using portable dialysis equipment. Catheters may be removed for reasons other than infection, in which case the observation is censored. Each patient has exactly 2 observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Kidney")</code></pre>


<h3>Format</h3>

<p>A data frame with 76 observations on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>ind</code></dt><dd><p>margin indicator</p>
</dd>
<dt><code>obs_time</code></dt><dd><p>observed time</p>
</dd>
<dt><code>status</code></dt><dd><p>event status</p>
</dd>
<dt><code>age</code></dt><dd><p>in years</p>
</dd>
<dt><code>sex</code></dt><dd><p>1=male, 2=female</p>
</dd>
<dt><code>disease</code></dt><dd><p>disease type with 4 levels <code>Other</code> <code>GN</code> <code>AN</code> <code>PKD</code></p>
</dd>
</dl>



<h3>Note</h3>

<p>This data has often been used to illustrate the use of random effects (frailty) in a survival model. However, one of the males (id 21) is a large outlier, with much longer survival than his peers. If this observation is removed no evidence remains for a random subject effect.
</p>


<h3>Source</h3>

<p>https://github.com/therneau/survival
</p>


<h3>References</h3>

<p>CA McGilchrist, CW Aisbett (1991), Regression with frailty in survival analysis. <em>Biometrics</em> <strong>47</strong>, 461-66.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Kidney)
clayton_cox &lt;- rc_spCox_copula(data = Kidney,
               var_list = c("age","sex","disease"),
               copula = "Clayton",
               method = "BFGS",
               B = 2)
summary(clayton_cox)
</code></pre>

<hr>
<h2 id='lines.CopulaCenR'>Plotting for CopulaCenR fits</h2><span id='topic+lines.CopulaCenR'></span>

<h3>Description</h3>

<p>Plotting for CopulaCenR fits from  <code>ic_spTran_copula</code>, <code>rc_spCox_copula</code>,
<code>ic_par_copula</code> and <code>rc_par_copula</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
lines(
  x,
  y,
  class = "joint",
  newdata,
  evalPoints = 50,
  evalTimes1 = NULL,
  evalTimes2 = NULL,
  plot_margin = 1,
  cond_time = NULL,
  cond_margin = 2,
  plotly_object = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines.CopulaCenR_+3A_x">x</code></td>
<td>
<p>an object of  <code>ic_spTran_copula</code>, <code>rc_spCox_copula</code>,
<code>ic_par_copula</code>, <code>rc_par_copula</code></p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_y">y</code></td>
<td>
<p>new data frame with colname names <code>id</code>, <code>ind</code> and <code>covariate</code></p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_class">class</code></td>
<td>
<p>one of &quot;joint&quot;, &quot;conditional&quot; or &quot;marginal&quot;</p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_newdata">newdata</code></td>
<td>
<p>new data frame (ignored if <code>y</code> is included)</p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_evalpoints">evalPoints</code></td>
<td>
<p>number of time points to be evaluated; default is 50</p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_evaltimes1">evalTimes1</code></td>
<td>
<p>a vector of times for margin 1 to be evaluated;
default is NULL; will override evalPoints if non-NULL</p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_evaltimes2">evalTimes2</code></td>
<td>
<p>a vector of times for margin 2 to be evaluated</p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_plot_margin">plot_margin</code></td>
<td>
<p>for <code>class = "marginal"</code> only; indicator of which margin to plot
(either 1 or 2); default is 1 for margin 1</p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_cond_time">cond_time</code></td>
<td>
<p>for <code>class = "conditional"</code> only; the time
by which event has occurred in the margin indicated by cond_margin;
must be smaller than the largest observed time</p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_cond_margin">cond_margin</code></td>
<td>
<p>for <code>class = "conditional"</code> only; indicator of the margin
where event has occurred (either 1 or 2); default is 2 for margin 2</p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_plotly_object">plotly_object</code></td>
<td>
<p>only for <code>class = "joint"</code>, an object of <code>plot.CopulaCenR</code></p>
</td></tr>
<tr><td><code id="lines.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>y must be a data frame with columns <code>id</code> (subject id),
<code>ind</code> (1,2 for two margins) and <code>covariates</code>. <br />
The argument <code>class</code> determines the plot:
<code>"joint"</code> for joint survival probabilities,
<code>"conditional"</code> for conditional probabilities and
<code>"marginal"</code> for marginal probabilities.
</p>
<p>The function evaluates on a series of time points
(given by <code>evalPoints</code> or <code>evalTimes</code>;
<code>evalTimes</code> will override <code>evalPoints</code>).
By default, the time points are automatically
selected by specifying the number of points (<code>evalPoints = 50</code>).
Users can also provide the specific time points through <code>evalTimes1</code> and
<code>evalTimes2</code> for the two margins, respectively.
When <code>class</code> <code>= "conditional"</code>, only <code>evalTimes1</code> is needed
and the evaluation times are actually <code>evalTimes1</code> plus <code>cond_time</code>. <br />
</p>
<p>If <code>class = "conditional"</code>, one needs to specify the margin
that has the event (by <code>cond_margin</code>)
and time when the event has occurred (by <code>cond_time</code>).
For example, if <code>cond_margin = 2</code> and <code>cond_time = 5</code>,
then the function produces the conditional survival probability
(after time 5) in margin 1 given that margin 2 has got an event by time 5.
This measurement is useful for predicting the second event
given the first event has occurred. See the example for details.<br />
</p>
<p>If <code>class = "marginal"</code>, one needs to specify which margin to plot
through the argument <code>plot_margin</code>. See the example for details. <br />
</p>
<p>If <code>class = "joint"</code>, one needs to include a <code>plot_ly</code> object
(from <code>plot.CopulaCenR</code> with <code>class</code> = <code>"joint"</code>)
through the argument <code>plotly_object</code>. See the example for details.<br />
</p>


<h3>Value</h3>

<p>a 3D joint survival distribution plot if <code>class = "joint"</code>;
a 2D survival distribution plot if <code>class</code> <code>= "marginal"</code>
or <code>"conditional"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AREDS)
# fit a Copula2-Sieve model
copula2_sp &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
              l = 0, u = 15, m = 3, r = 3,
              var_list = c("ENROLLAGE","rs2284665","SevScaleBL"))
newdata = data.frame(id = rep(1:3, each=2), ind = rep(c(1,2),3),
                     SevScaleBL = rep(3,6), ENROLLAGE = rep(60,6),
                     rs2284665 = c(0,0,1,1,2,2))
# Plot marginal survival probabilities
plot(x = copula2_sp, class = "marginal",
     newdata = newdata[newdata$id==1,],
     plot_margin = 1, ylim = c(0.6,1),
     ylab = "Marginal Survival Probability")
lines(x = copula2_sp, class = "marginal",
      newdata = newdata[newdata$id==2,],
      plot_margin = 1, lty = 2)
legend("bottomleft", c("id: 1","id: 2"), lty = c(1,2))

# Plot conditional survival probabilities
plot(x = copula2_sp, class = "conditional",
     newdata = newdata[newdata$id==1,],
     cond_margin = 2, cond_time = 5, ylim = c(0.25,1),
     xlab = "years", ylab = "Conditional Survival Probability")
lines(x = copula2_sp, class = "conditional",
      newdata = newdata[newdata$id==2,],
     cond_margin = 2, cond_time = 5, lty = 2)
legend("bottomleft", c("id: 1","id: 2"), lty = c(1,2))

# Plot joint survival probabilities
plot3d &lt;- plot(x = copula2_sp, class = "joint",
               newdata = newdata[newdata$id==1,])
plot3d &lt;- lines(x = copula2_sp, class = "joint",
                newdata = newdata[newdata$id==2,], plotly_object = plot3d)
</code></pre>

<hr>
<h2 id='logLik.CopulaCenR'>the log-likelihood of a CopulaCenR object</h2><span id='topic+logLik.CopulaCenR'></span>

<h3>Description</h3>

<p>the log-likelihood of a CopulaCenR object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.CopulaCenR_+3A_object">object</code></td>
<td>
<p>a CopulaCenR object</p>
</td></tr>
<tr><td><code id="logLik.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>

<hr>
<h2 id='lrt_copula'>Likelihood-ratio test for covariate effect(s) in copula models</h2><span id='topic+lrt_copula'></span>

<h3>Description</h3>

<p>This function (lrt_copula) is used to perform the likelihood ratio test (LRT) between two nested copula models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrt_copula(model1, model2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrt_copula_+3A_model1">model1</code></td>
<td>
<p>The output of the larger model</p>
</td></tr>
<tr><td><code id="lrt_copula_+3A_model2">model2</code></td>
<td>
<p>The output of the smaller model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the LRT statistics, p value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' # Likelihood-ratio test for "rs2284665" in AREDS data
data(AREDS)
# Fit null model without "rs2284665"
copula2_sp_null &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
                   l = 0, u = 15, m = 3, r = 3,
                   var_list = c("SevScaleBL"))
# Fit full model
copula2_sp &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
              l = 0, u = 15, m = 3, r = 3,
              var_list = c("rs2284665","SevScaleBL"))
lrt_copula(model1 = copula2_sp, model2 = copula2_sp_null)
</code></pre>

<hr>
<h2 id='plot.CopulaCenR'>Plotting for CopulaCenR fits</h2><span id='topic+plot.CopulaCenR'></span>

<h3>Description</h3>

<p>Plotting for CopulaCenR fits from  <code>ic_spTran_copula</code>, <code>rc_spCox_copula</code>,
<code>ic_par_copula</code> and <code>rc_par_copula</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
plot(
  x,
  y,
  class = "joint",
  newdata,
  evalPoints = 50,
  evalTimes1 = NULL,
  evalTimes2 = NULL,
  plot_margin = 1,
  cond_time = NULL,
  cond_margin = 2,
  type = "l",
  xlab = "years",
  ylab = "survival probability",
  cex.main = 1.4,
  cex.lab = 1.4,
  cex.axis = 1.4,
  legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.CopulaCenR_+3A_x">x</code></td>
<td>
<p>an object of <code>ic_spTran_copula</code> or <code>rc_spCox_copula</code>
or <code>ic_par_copula</code> or <code>rc_par_copula</code></p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_y">y</code></td>
<td>
<p>new data frame with colname names <code>id</code>, <code>ind</code> and <code>covariate</code></p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_class">class</code></td>
<td>
<p>one of &quot;joint&quot;, &quot;conditional&quot; or &quot;marginal&quot;</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_newdata">newdata</code></td>
<td>
<p>new data frame (ignored if <code>y</code> is included)</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_evalpoints">evalPoints</code></td>
<td>
<p>number of time points to be evaluated in both margins;
default is 50</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_evaltimes1">evalTimes1</code></td>
<td>
<p>a vector of times for margin 1 to be evaluated;
default is NULL;
will override evalPoints if non-NULL</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_evaltimes2">evalTimes2</code></td>
<td>
<p>a vector of times for margin 2 to be evaluated</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_plot_margin">plot_margin</code></td>
<td>
<p>for <code>class = "marginal"</code> only; indicator of which margin to plot
(either 1 or 2); default is 1 for margin 1</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_cond_time">cond_time</code></td>
<td>
<p>for <code>class = "conditional"</code> only; the time
by which event has occurred in the margin indicated by <code>cond_margin</code>;
must be smaller than the largest observed time</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_cond_margin">cond_margin</code></td>
<td>
<p>for <code>class = "conditional"</code> only; indicator of the margin
where event has occurred (either 1 or 2); default is 2 for margin 2</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_type">type</code></td>
<td>
<p>type of plot with default <code>type = "l"</code>.</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis.</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_ylab">ylab</code></td>
<td>
<p>a title for the x axis.</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_cex.main">cex.main</code></td>
<td>
<p>cex for main.</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_cex.lab">cex.lab</code></td>
<td>
<p>cex for lab.</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_cex.axis">cex.axis</code></td>
<td>
<p>cex for axis.</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_legend">legend</code></td>
<td>
<p>whether to show legend with default <code>legend = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>y must be a data frame with columns <code>id</code> (subject id),
<code>ind</code> (1,2 for two margins) and <code>covariates</code>. <br />
The argument class determines the plot:
<code>"joint"</code> for joint survival probabilities,
<code>"conditional"</code> for conditional probabilities and
<code>"marginal"</code> for marginal probabilities.
</p>
<p>The function evaluates on a series of time points
(given by <code>evalPoints</code> or <code>evalTimes</code>;
<code>evalTimes</code> will override <code>evalPoints</code>).
By default, the time points are automatically
selected by specifying the number of points (<code>evalPoints = 50</code>).
Users can also provide the specific time points through <code>evalTimes1</code> and
<code>evalTimes2</code> for the two margins, respectively.
When <code>class</code> <code>= "conditional"</code>, only <code>evalTimes1</code> is needed
and the evaluation times are actually <code>evalTimes1</code> plus <code>cond_time</code>. <br />
</p>
<p>If <code>class</code> <code>= "conditional"</code>, one needs to specify the margin
that has the event (by <code>cond_margin</code>)
and time when the event has occurred (by <code>cond_time</code>).
For example, if <code>cond_margin = 2</code> and <code>cond_time = 5</code>,
then the function produces the conditional survival probability
(after time 5) in margin 1 given that margin 2 has got an event by time 5.
This measurement is useful for predicting the second event
given the first event has occurred. See the example for details.<br />
</p>
<p>If <code>class = "marginal"</code>, one needs to specify which margin to plot
through the argument <code>plot_margin</code>. See the example for details. <br />
</p>


<h3>Value</h3>

<p>a 3D joint survival distribution plot if <code>class = "joint"</code>;
a 2D survival distribution plot if <code>class</code> = <code>"marginal"</code> or <code>"conditional"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AREDS)
# fit a Copula2-Sieve model
copula2_sp &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
              l = 0, u = 15, m = 3, r = 3,
              var_list = c("ENROLLAGE","rs2284665","SevScaleBL"))
newdata = data.frame(id = rep(1, each=2), ind = rep(c(1,2),1),
                     SevScaleBL = rep(3,2), ENROLLAGE = rep(60,2),
                     rs2284665 = c(0,0))
# Plot joint survival probabilities
plot(x = copula2_sp, class = "joint", newdata = newdata)

# Plot conditional survival probabilities
plot(x = copula2_sp, class = "conditional", newdata = newdata,
     cond_margin = 2, cond_time = 5, ylim = c(0.25,1),
     ylab = "Conditional Survival Probability")

# Plot marginal survival probabilities
plot(x = copula2_sp, class = "marginal", newdata = newdata,
     plot_margin = 1, ylim = c(0.6,1),
     ylab = "Marginal Survival Probability")
</code></pre>

<hr>
<h2 id='predict.CopulaCenR'>Predictions from CopulaCenR regression models</h2><span id='topic+predict.CopulaCenR'></span>

<h3>Description</h3>

<p>Predictions for new observations based on <code>ic_spTran_copula</code>, <code>rc_spCox_copula</code>,
<code>ic_par_copula</code> and <code>rc_par_copula</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
predict(object, newdata, type = "lp", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.CopulaCenR_+3A_object">object</code></td>
<td>
<p>a <code>CopulaCenR</code> object from <code>ic_spTran_copula</code>,
<code>rc_spCox_copula</code>, <code>ic_par_copula</code> and <code>rc_par_copula</code></p>
</td></tr>
<tr><td><code id="predict.CopulaCenR_+3A_newdata">newdata</code></td>
<td>
<p>a data frame (see details)</p>
</td></tr>
<tr><td><code id="predict.CopulaCenR_+3A_type">type</code></td>
<td>
<p><code>"lp"</code> for linear predictors or
<code>"survival"</code> for marginal and joint survival probabilities</p>
</td></tr>
<tr><td><code id="predict.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code>newdata</code>, when <code>type = "survival"</code>, it must be a data frame with columns
<code>id</code> (subject id), <code>ind</code> (1,2 for two margins),
<code>time</code> (to be evaluted) and <code>covariates</code>;
when <code>type = "lp"</code>, the newdata needs to have <code>id</code>,
<code>ind</code> and <code>covariates</code>, but <code>time</code> is not needed. <br />
</p>
<p>When the argument <code>type = "lp"</code>, it gives a linear predictor for
each margin (i.e., log hazards ratio in the proportional hazards model,
log proportional odds in the proportional odds model). <br />
</p>
<p>When the argument <code>type = "survival"</code>, the marginal and joint survival values
will be evaluated at the given time points in the <code>newdata</code>. <br />
</p>


<h3>Value</h3>

<p>If <code>type = "lp"</code>, it returns a data frame with <code>id</code>,
<code>lp1</code> (linear predictor for margin 1), <code>lp2</code>.
If <code>type = "survival"</code>, it returns a data frame with <code>id</code>,
<code>t1</code> (evaluated times for the margin 1), <code>t2</code>,
<code>S1</code> (predicted marginal survival probabilities for margin 1),
<code>S2</code> and
<code>S12</code> (the predicted joint survival probabilities at <code>t1, t2</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AREDS)
# fit a Copula2-Sieve model
copula2_sp &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
              l = 0, u = 15, m = 3, r = 3,
              var_list = c("ENROLLAGE","rs2284665","SevScaleBL"))
# Predicted probabilities for newdata
newdata = data.frame(id = rep(1:3, each=2), ind = rep(c(1,2),3),
                     time = c(2,3,5,6,7,8),
                    SevScaleBL = rep(3,6),
                    ENROLLAGE = rep(60,6),
                    rs2284665 = c(0,0,1,1,2,2))
output &lt;- predict(object = copula2_sp, newdata = newdata)
</code></pre>

<hr>
<h2 id='print.CopulaCenR'>Printing outputs of a CopulaCenR object</h2><span id='topic+print.CopulaCenR'></span>

<h3>Description</h3>

<p>Printing outputs of a CopulaCenR object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.CopulaCenR_+3A_x">x</code></td>
<td>
<p>a CopulaCenR object</p>
</td></tr>
<tr><td><code id="print.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.CopulaCenR'>Print the summary of a CopulaCenR object</h2><span id='topic+print.summary.CopulaCenR'></span>

<h3>Description</h3>

<p>Print the summary of a CopulaCenR object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.CopulaCenR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.CopulaCenR_+3A_x">x</code></td>
<td>
<p>a summary.CopulaCenR object</p>
</td></tr>
<tr><td><code id="print.summary.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>

<hr>
<h2 id='rc_par_copula'>Copula regression models with parametric margins for bivariate right-censored data</h2><span id='topic+rc_par_copula'></span>

<h3>Description</h3>

<p>Fits a copula model with parametric margins for bivariate right-censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_par_copula(
  data,
  var_list,
  copula = "Clayton",
  m.dist = "Weibull",
  method = "BFGS",
  iter = 500,
  stepsize = 1e-06,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rc_par_copula_+3A_data">data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>ind</code> (1,2 for two margins),
<code>obs_time</code>, <code>status</code> (0 for right-censoring, 1 for event).</p>
</td></tr>
<tr><td><code id="rc_par_copula_+3A_var_list">var_list</code></td>
<td>
<p>the list of covariates to be fitted into the model.</p>
</td></tr>
<tr><td><code id="rc_par_copula_+3A_copula">copula</code></td>
<td>
<p>specify the copula family.</p>
</td></tr>
<tr><td><code id="rc_par_copula_+3A_m.dist">m.dist</code></td>
<td>
<p>specify the marginal baseline distribution.</p>
</td></tr>
<tr><td><code id="rc_par_copula_+3A_method">method</code></td>
<td>
<p>optimization method (see <code>?optim</code>); default is <code>"BFGS"</code>;
also can be <code>"Newton"</code> (see <code>?nlm</code>).</p>
</td></tr>
<tr><td><code id="rc_par_copula_+3A_iter">iter</code></td>
<td>
<p>number of iterations when <code>method = "Newton"</code>;
default is 500.</p>
</td></tr>
<tr><td><code id="rc_par_copula_+3A_stepsize">stepsize</code></td>
<td>
<p>size of optimization step when <code>method = "Newton"</code>;
default is 1e-6.</p>
</td></tr>
<tr><td><code id="rc_par_copula_+3A_control">control</code></td>
<td>
<p>a list of control parameters for methods other than <code>"Newton"</code>;
see <code>?optim</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data must be a data frame with columns <code>id</code> (subject id),
<code>ind</code> (1,2 for two margins; each id must have both <code>ind = 1 and 2</code>),
<code>obs_time</code>, <code>status</code> (0 for right-censoring, 1 for event)
and <code>covariates</code>. <br />
</p>
<p>The supported copula models are <code>"Clayton"</code>, <code>"Gumbel"</code>, <code>"Frank"</code>,
<code>"AMH"</code>, <code>"Joe"</code> and <code>"Copula2"</code>.
The <code>"Copula2"</code> model is a two-parameter copula model that incorporates
<code>Clayton</code> and <code>Gumbel</code> as special cases.
The parametric generator functions of copula functions are list below:
</p>
<p>The Clayton copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1+t)^{-1/\eta},</code>
</p>

<p>with <code class="reqn">\eta &gt; 0</code> and Kendall's <code class="reqn">\tau = \eta/(2+\eta)</code>.
</p>
<p>The Gumbel copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \exp(-t^{1/\eta}),</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 1/\eta</code>.
</p>
<p>The Frank copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = -\eta^{-1}\log \{1+e^{-t}(e^{-\eta}-1)\},</code>
</p>

<p>with <code class="reqn">\eta \geq 0</code> and Kendall's <code class="reqn">\tau = 1+4\{D_1(\eta)-1\}/\eta</code>,
in which <code class="reqn">D_1(\eta) = \frac{1}{\eta} \int_{0}^{\eta} \frac{t}{e^t-1}dt</code>.
</p>
<p>The AMH copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1-\eta)/(e^{t}-\eta),</code>
</p>

<p>with <code class="reqn">\eta \in [0,1)</code> and Kendall's <code class="reqn">\tau =  1-2\{(1-\eta)^2 \log (1-\eta) + \eta\}/(3\eta^2)</code>.
</p>
<p>The Joe copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = 1-(1-e^{-t})^{1/\eta},</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 4 \sum_{k=1}^{\infty} \frac{1}{k(\eta k+2)\{\eta(k-1)+2\}}</code>.
</p>
<p>The Two-parameter copula (Copula2) has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \{1/(1+t^{\alpha})\}^{\kappa},</code>
</p>

<p>with <code class="reqn">\alpha \in (0,1], \kappa &gt; 0</code> and Kendall's <code class="reqn">\tau = 1-2\alpha\kappa/(2\kappa+1)</code>. <br />
</p>
<p>The supported marginal distributions are <code>"Weibull"</code> (proportional hazards),
<code>"Gompertz"</code> (proportional hazards) and <code>"Loglogistic"</code> (proportional odds).
These marginal distributions are listed below and
we also assume the same baseline parameters between two margins. <br />
</p>
<p>The Weibull (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-(t/\lambda)^k  e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape.
</p>
<p>The Gompertz (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-\frac{b}{a}(e^{at}-1) e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">a &gt; 0</code> as shape and <code class="reqn">b &gt; 0</code> as rate.
</p>
<p>The Loglogistic (PO) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\{1+(t/\lambda)^{k} e^{Z^{\top}\beta} \}^{-1},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape. <br />
</p>
<p>Optimization methods can be all methods (except <code>"Brent"</code>) from <code>optim</code>,
such as <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code>.
Users can also use <code>"Newton"</code> (from <code>nlm</code>).
</p>


<h3>Value</h3>

<p>a <code>CopulaCenR</code> object summarizing the model.
Can be used as an input to general <code>S3</code> methods including
<code>summary</code>, <code>print</code>, <code>plot</code>, <code>lines</code>,
<code>coef</code>, <code>logLik</code>, <code>AIC</code>,
<code>BIC</code>, <code>fitted</code>, <code>predict</code>.
</p>


<h3>Source</h3>

<p>Tao Sun, Yi Liu, Richard J. Cook, Wei Chen and Ying Ding (2019).
Copula-based Score Test for Bivariate Time-to-event Data,
with Application to a Genetic Study of AMD Progression.
<em>Lifetime Data Analysis</em> 25(3), 546-568. <br />
Tao Sun and Ying Ding (In Press).
Copula-based Semiparametric Regression Model for Bivariate Data
under General Interval Censoring.
<em>Biostatistics</em>. DOI: 10.1093/biostatistics/kxz032.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a Clayton-Weibull model
data(DRS)
clayton_wb &lt;- rc_par_copula(data = DRS, var_list = "treat",
                            copula = "Clayton",
                            m.dist = "Weibull")
summary(clayton_wb)
</code></pre>

<hr>
<h2 id='rc_scmprisk_sp_copula_pen'>Penalized copula regression models with Cox semiparametric margins for semi-competing risk data under right-censoring.</h2><span id='topic+rc_scmprisk_sp_copula_pen'></span>

<h3>Description</h3>

<p>Fits a penalized copula model with Cox semiparametric margins for semi-competing risk data under right-censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_scmprisk_sp_copula_pen(
  data,
  var_list1,
  var_list2,
  m1,
  m2,
  initial,
  a,
  b,
  pen1,
  pen2,
  copula
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_data">data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>ind</code> (1,2 for two margins),
<code>obs_time</code>, <code>status</code> (0 for right-censoring, 1 for event).</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_var_list1">var_list1</code></td>
<td>
<p>the list of covariates to be fitted into the copula model for non-terminal event.</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_var_list2">var_list2</code></td>
<td>
<p>the list of covariates to be fitted into the copula model for terminal event.</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_m1">m1</code></td>
<td>
<p>integer, degree of Bernstein polynomials for non-terminal event; default is 3.</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_m2">m2</code></td>
<td>
<p>integer, degree of Bernstein polynomials for terminal event; default is 3.</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_initial">initial</code></td>
<td>
<p>a vector of initial values for all parameters, including phi1 and phi2
(two Bernstein polynomials parameters), beta1 and beta2 (regression coefficients in Cox margins),
<code>eta</code> (copula parameters).</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_a">a</code></td>
<td>
<p>Tuning parameters in penalty function for non-terminal event.</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_b">b</code></td>
<td>
<p>Tuning parameters in penalty function for terminal event.</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_pen1">pen1</code></td>
<td>
<p>Types of penalty function for non-terminal event, including <code>"NOPEN"</code>, <code>"RIDGE"</code>,
<code>"BAR"</code>, <code>"LASSO"</code>, <code>"MCP"</code>, <code>"SCAD"</code>.</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_pen2">pen2</code></td>
<td>
<p>Types of penalty function for terminal event, including <code>"NOPEN"</code>, <code>"RIDGE"</code>,
<code>"BAR"</code>, <code>"LASSO"</code>, <code>"MCP"</code>, <code>"SCAD"</code>.</p>
</td></tr>
<tr><td><code id="rc_scmprisk_sp_copula_pen_+3A_copula">copula</code></td>
<td>
<p>Types of copula, including <code>"Clayton"</code>, <code>"Gumbel"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parameter estimates and BIC
</p>


<h3>Source</h3>

<p>Tao Sun, Weijie Liang, Gongzi Zhang, Danhui Yi, Ying Ding, Lihai Zhang (2023+). Penalized semiparametric
copula method for semi-competing risks data: Application to hip fracture in elderly. JRSSC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("data_sim_scmprisk_vs")
var_list = paste0('x',seq(1,5,1))
phi1_ini = c(0,0,0,0)
phi2_ini = c(0,0,0,0)
beta1_ini = c(0,0,0,0,0)
beta2_ini = c(0,0,0,0,0)
eta_ini = 1
initial = c(phi1_ini,phi2_ini,beta1_ini, beta2_ini, eta_ini)
# obtain initial parameter estimates by ridge penalty
fit0 = rc_scmprisk_sp_copula_pen(data=data_sim_scmprisk_vs,
                                 var_list1 = var_list, var_list2 = var_list,
                                 m1=3, m2=3, initial=initial,
                                 a=0.1, b=0.1, pen1='RIDGE', pen2='RIDGE',
                                 copula='Clayton')
est_ini = c(fit0$Est_phi1,fit0$Est_phi2,fit0$Est_beta1,fit0$Est_beta2,fit0$Est_eta)

fit = rc_scmprisk_sp_copula_pen(data=data_sim_scmprisk_vs,
                                var_list1 = var_list, var_list2 = var_list,
                                m1=3, m2=3, initial=est_ini,
                                a=0.2, b=0.2, pen1='MCP', pen2='MCP',
                                copula='Clayton')
fit$Est_beta1
fit$Est_beta2

## End(Not run)
</code></pre>

<hr>
<h2 id='rc_spCox_copula'>Copula regression models with Cox semiparametric margins for bivariate right-censored data</h2><span id='topic+rc_spCox_copula'></span>

<h3>Description</h3>

<p>Fits a copula model with Cox semiparametric margins for bivariate right-censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rc_spCox_copula(
  data,
  var_list,
  copula = "Clayton",
  method = "BFGS",
  iter = 500,
  stepsize = 1e-06,
  control = list(),
  B = 100,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rc_spCox_copula_+3A_data">data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>ind</code> (1,2 for two margins),
<code>obs_time</code>, <code>status</code> (0 for right-censoring, 1 for event).</p>
</td></tr>
<tr><td><code id="rc_spCox_copula_+3A_var_list">var_list</code></td>
<td>
<p>the list of covariates to be fitted into the model.</p>
</td></tr>
<tr><td><code id="rc_spCox_copula_+3A_copula">copula</code></td>
<td>
<p>specify the copula family.</p>
</td></tr>
<tr><td><code id="rc_spCox_copula_+3A_method">method</code></td>
<td>
<p>optimization method (see <code>?optim</code>); default is <code>"BFGS"</code>;
also can be <code>"Newton"</code> (see <code>?nlm</code>).</p>
</td></tr>
<tr><td><code id="rc_spCox_copula_+3A_iter">iter</code></td>
<td>
<p>number of iterations when <code>method = "Newton"</code>;
default is 500.</p>
</td></tr>
<tr><td><code id="rc_spCox_copula_+3A_stepsize">stepsize</code></td>
<td>
<p>size of optimization step when <code>method = "Newton"</code>;
default is 1e-6.</p>
</td></tr>
<tr><td><code id="rc_spCox_copula_+3A_control">control</code></td>
<td>
<p>a list of control parameters for methods other than <code>"Newton"</code>;
see <code>?optim</code>.</p>
</td></tr>
<tr><td><code id="rc_spCox_copula_+3A_b">B</code></td>
<td>
<p>number of bootstraps for estimating standard errors with default 100;</p>
</td></tr>
<tr><td><code id="rc_spCox_copula_+3A_seed">seed</code></td>
<td>
<p>the bootstrap seed; default is 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data must be a data frame with columns <code>id</code> (subject id),
<code>ind</code> (1,2 for two margins; each id must have both <code>ind = 1 and 2</code>),
<code>obs_time</code>, <code>status</code> (0 for right-censoring, 1 for event)
and <code>covariates</code>. <br />
</p>
<p>The supported copula models are <code>"Clayton"</code>, <code>"Gumbel"</code>, <code>"Frank"</code>,
<code>"AMH"</code>, <code>"Joe"</code> and <code>"Copula2"</code>.
The <code>"Copula2"</code> model is a two-parameter copula model that incorporates
<code>Clayton</code> and <code>Gumbel</code> as special cases.
The parametric generator functions of copula functions are list below:
</p>
<p>The Clayton copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1+t)^{-1/\eta},</code>
</p>

<p>with <code class="reqn">\eta &gt; 0</code> and Kendall's <code class="reqn">\tau = \eta/(2+\eta)</code>.
</p>
<p>The Gumbel copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \exp(-t^{1/\eta}),</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 1/\eta</code>.
</p>
<p>The Frank copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = -\eta^{-1}\log \{1+e^{-t}(e^{-\eta}-1)\},</code>
</p>

<p>with <code class="reqn">\eta \geq 0</code> and Kendall's <code class="reqn">\tau = 1+4\{D_1(\eta)-1\}/\eta</code>,
in which <code class="reqn">D_1(\eta) = \frac{1}{\eta} \int_{0}^{\eta} \frac{t}{e^t-1}dt</code>.
</p>
<p>The AMH copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1-\eta)/(e^{t}-\eta),</code>
</p>

<p>with <code class="reqn">\eta \in [0,1)</code> and Kendall's <code class="reqn">\tau =  1-2\{(1-\eta)^2 \log (1-\eta) + \eta\}/(3\eta^2)</code>.
</p>
<p>The Joe copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = 1-(1-e^{-t})^{1/\eta},</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 4 \sum_{k=1}^{\infty} \frac{1}{k(\eta k+2)\{\eta(k-1)+2\}}</code>.
</p>
<p>The Two-parameter copula (Copula2) has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \{1/(1+t^{\alpha})\}^{\kappa},</code>
</p>

<p>with <code class="reqn">\alpha \in (0,1], \kappa &gt; 0</code> and Kendall's <code class="reqn">\tau = 1-2\alpha\kappa/(2\kappa+1)</code>. <br />
</p>
<p>The marginal distribution is a Cox semiparametric proportional hazards model.
The copula parameter and coefficient standard errors are estimated from bootstrap. <br />
</p>
<p>Optimization methods can be all methods (except <code>"Brent"</code>) from <code>optim</code>,
such as <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code>.
Users can also use <code>"Newton"</code> (from <code>nlm</code>).
</p>


<h3>Value</h3>

<p>a <code>CopulaCenR</code> object summarizing the model.
Can be used as an input to general <code>S3</code> methods including
<code>summary</code>, <code>print</code>, <code>plot</code>, <code>lines</code>,
<code>coef</code>, <code>logLik</code>, <code>AIC</code>,
<code>BIC</code>, <code>fitted</code>, <code>predict</code>.
</p>


<h3>Source</h3>

<p>Tao Sun, Yi Liu, Richard J. Cook, Wei Chen and Ying Ding (2019).
Copula-based Score Test for Bivariate Time-to-event Data,
with Application to a Genetic Study of AMD Progression.
<em>Lifetime Data Analysis</em> 25(3), 546-568. <br />
Tao Sun and Ying Ding (In Press).
Copula-based Semiparametric Regression Model for Bivariate Data
under General Interval Censoring.
<em>Biostatistics</em>. DOI: 10.1093/biostatistics/kxz032.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a Clayton-Cox model
data(DRS)
clayton_cox &lt;- rc_spCox_copula(data = DRS, var_list = "treat",
                            copula = "Clayton", B = 2)
summary(clayton_cox)
</code></pre>

<hr>
<h2 id='score_copula'>Generalized score test for covariate effect(s)</h2><span id='topic+score_copula'></span>

<h3>Description</h3>

<p>Generalized score test on covariate effect(s) under a fitted copula model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score_copula(object, var_score)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="score_copula_+3A_object">object</code></td>
<td>
<p>The output object from the main functions
(<code>rc_par_copula</code>, <code>rc_spCox_copula</code>,
<code>ic_spTran_copula</code>, <code>ic_par_copula</code>)
under the null hypothesis</p>
</td></tr>
<tr><td><code id="score_copula_+3A_var_score">var_score</code></td>
<td>
<p>the list of covariates to be tested by the score test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the score statistics, p value
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Score test for "rs2284665" in AREDS data
# fit a Copula2-semiparametric model under NULL
data(AREDS)
copula2_sp_null &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
                   l = 0, u = 15, m = 3, r = 3,
                   var_list = c("ENROLLAGE","SevScaleBL"))
score_copula(object = copula2_sp_null, var_score = "rs2284665")
</code></pre>

<hr>
<h2 id='summary.CopulaCenR'>Summarizing outputs of a CopulaCenR object</h2><span id='topic+summary.CopulaCenR'></span>

<h3>Description</h3>

<p>Summarizing outputs of a CopulaCenR object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CopulaCenR'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.CopulaCenR_+3A_object">object</code></td>
<td>
<p>a CopulaCenR object</p>
</td></tr>
<tr><td><code id="summary.CopulaCenR_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>

<hr>
<h2 id='tau_copula'>Calculate Kendall's tau</h2><span id='topic+tau_copula'></span>

<h3>Description</h3>

<p>To obtain Kendall's tau from copula parameter(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tau_copula(eta, copula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tau_copula_+3A_eta">eta</code></td>
<td>
<p>copula parameter(s);
if <code>copula = "Coupla2"</code>, input <code class="reqn">\alpha</code> and <code class="reqn">\kappa</code></p>
</td></tr>
<tr><td><code id="tau_copula_+3A_copula">copula</code></td>
<td>
<p>specify the type of copula model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The supported copula models are <code>"Clayton"</code>, <code>"Gumbel"</code>, <code>"Frank"</code>,
<code>"AMH"</code>, <code>"Joe"</code> and <code>"Copula2"</code>.
The <code>"Copula2"</code> model is a two-parameter copula model that incorporates
<code>Clayton</code> and <code>Gumbel</code> as special cases. <br />
</p>
<p>The Kendall's <code class="reqn">\tau</code> formulas are list below:
</p>
<p>The Clayton copula Kendall's <code class="reqn">\tau = \eta/(2+\eta)</code>.
</p>
<p>The Gumbel copula Kendall's <code class="reqn">\tau = 1 - 1/\eta</code>.
</p>
<p>The Frank copula Kendall's <code class="reqn">\tau = 1+4\{D_1(\eta)-1\}/\eta</code>,
in which <code class="reqn">D_1(\eta) = \frac{1}{\eta} \int_{0}^{\eta} \frac{t}{e^t-1}dt</code>.
</p>
<p>The AMH copula Kendall's <code class="reqn">\tau =  1-2\{(1-\eta)^2 \log (1-\eta) + \eta\}/(3\eta^2)</code>.
</p>
<p>The Joe copula Kendall's <code class="reqn">\tau = 1 - 4 \sum_{k=1}^{\infty} \frac{1}{k(\eta k+2)\{\eta(k-1)+2\}}</code>.
</p>
<p>The Two-parameter copula (<code>Copula2</code>) Kendall's <code class="reqn">\tau = 1-2\alpha\kappa/(2\kappa+1)</code>. <br />
</p>


<h3>Value</h3>

<p>Kendall's <code class="reqn">\tau</code>
</p>


<h3>Source</h3>

<p>Ali MM, Mikhail NN, Haq MS (1978).
A Class of Bivariate Distributions Including the Bi- variate Logistic.
<em>Journal of Multivariate Analysis</em> doi:10.1016/0047-259X(78)90063-5. <br />
Clayton DG (1978).
A Model for Association in Bivariate Life Tables and Application in
Epidemiological Studies of Familial Tendency in Chronic Disease Incidence.
<em>Biometrika</em> doi:10.2307/2335289. <br />
Gumbel EJ (1960).
Bivariate Exponential Distributions.
<em>Journal of the American Statistical Association</em>
doi:10.2307/2281591. <br />
Joe H (1993).
Parametric Families of Multivariate Distributions with Given Margins.
<em>Journal of Multivariate Analysis</em>
doi:10.1006/jmva.1993.1061. <br />
Joe H (1997).
Multivariate Models and Dependence Concepts.
<em>Chapman &amp; Hall, London</em>. <br />
Frank MJ (1979).
On the Simultaneous Associativity of <code class="reqn">F(x, y)</code>
and <code class="reqn">x + y - F(x, y)</code>.
<em>Aequationes Mathematicae</em>. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a Copula2-Semiparametric model
data(AREDS)
copula2_sp &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
              l = 0, u = 15, m = 3, r = 3,
              var_list = c("ENROLLAGE","rs2284665","SevScaleBL"))
tau_copula(eta = as.numeric(coef(copula2_sp)[c("alpha","kappa")]),
           copula = "Copula2")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
