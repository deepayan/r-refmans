<!DOCTYPE html><html><head><title>Help for package growthPheno</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {growthPheno}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anom'><p>Tests if any values in a vector are anomalous in being outside specified limits</p></a></li>
<li><a href='#args4chosen_plot'><p>Creates a <code>list</code> of the values for the options of profile plots for the chosen smooth</p></a></li>
<li><a href='#args4chosen_smooth'><p>Creates a <code>list</code> of the values for the smoothing parameters for</p>
which a smooth is to be extracted</a></li>
<li><a href='#args4devnboxes_plot'><p>Creates a <code>list</code> of the values for the options of profile plots for comparing smooths</p></a></li>
<li><a href='#args4meddevn_plot'><p>Creates a <code>list</code> of the values for the options of median deviations plots for smooths</p></a></li>
<li><a href='#args4profile_plot'><p>Creates a <code>list</code> of the values for the options of profile plots for comparing smooths</p></a></li>
<li><a href='#args4smoothing'><p>Creates a <code>list</code> of the values for the smoothing parameters to be passed to a smoothing function</p></a></li>
<li><a href='#as.smooths.frame'><p>Forms a <code>smooths.frame</code> from a <code>data.frame</code>, ensuring that the correct</p>
columns are present.</a></li>
<li><a href='#byIndv_ValueCalc'><p>Calculates a single value that is a function of an individual's values for a response.</p></a></li>
<li><a href='#byIndv4Intvl_GRsAvg'><p>Calculates the growth rates for a specified time interval for individuals</p>
in a <code>data.frame</code> in long format by taking weighted averages of
growth rates for times within the interval.</a></li>
<li><a href='#byIndv4Intvl_GRsDiff'><p>Calculates the growth rates for a specified time interval for individuals</p>
in a <code>data.frame</code> in long format by differencing the values for
a response within the interval.</a></li>
<li><a href='#byIndv4Intvl_ValueCalc'><p>Calculates a single value that is a <code>function</code> of the values of</p>
an individual for a response in a <code>data.frame</code> in long format
over a specified time interval.</a></li>
<li><a href='#byIndv4Intvl_WaterUse'><p>Calculates, water use traits (WU, WUR, WUI) over a specified time interval</p>
for each individual in a <code>data.frame</code> in long format.</a></li>
<li><a href='#byIndv4Times_GRsDiff'><p>Adds, to a <code>data.frame</code>, the growth rates calculated for consecutive times</p>
for individuals in a <code>data.frame</code> in long format by differencing
response values.</a></li>
<li><a href='#byIndv4Times_SplinesGRs'><p>For a response in a <code>data.frame</code> in long format, computes,</p>
for a single set of smoothing parameters, smooths of the
response, possibly along with growth rates calculated from the
smooths.</a></li>
<li><a href='#calcLagged'><p>Replaces the values in a vector with the result of applying an operation to it</p>
and a lagged value</a></li>
<li><a href='#calcTimes'><p>Calculates for a set of times, the time intervals after an origin time and the position of each within a time interval</p></a></li>
<li><a href='#cumulate'><p>Calculates the cumulative sum, ignoring the first element if exclude.1st is TRUE</p></a></li>
<li><a href='#designFactors'><p>Adds the factors and covariates for a blocked, split-unit design</p></a></li>
<li><a href='#exampleData'><p>A small data set to use in function examples</p></a></li>
<li><a href='#fitSpline'><p>Fits a spline to a <code>response</code> in a <code>data.frame</code>, and growth rates can be</p>
computed using derivatives</a></li>
<li><a href='#getTimesSubset'><p>Forms a subset of <code>responses</code> in <code>data</code> that contains their values for the nominated times</p></a></li>
<li><a href='#growthPheno-deprecated'><p>Deprecated Functions in the Package growthPheno</p></a></li>
<li><a href='#growthPheno-package'>
<p>Functional Analysis of Phenotypic Growth Data to Smooth and</p>
Extract Traits</a></li>
<li><a href='#GrowthRates'><p>Calculates growth rates (AGR, PGR, RGRdiff) between pairs of values in a vector</p></a></li>
<li><a href='#importExcel'><p>Imports an Excel imaging file and allows some renaming of variables</p></a></li>
<li><a href='#intervalGRaverage'><p>Calculates the growth rates for a specified time interval by taking weighted averages of growth rates for times within the interval</p></a></li>
<li><a href='#intervalGRdiff'><p>Calculates the growth rates for a specified time interval</p></a></li>
<li><a href='#intervalPVA.data.frame'><p>Selects a subset of variables using Principal Variable Analysis (PVA), based on the observed values within a specified time interval</p></a></li>
<li><a href='#intervalValueCalculate'><p>Calculates a single value that is a function of an individual's values for a response over a specified time interval</p></a></li>
<li><a href='#intervalWUI'><p>Calculates water use indices (WUI) over a specified time interval to a</p>
data.frame</a></li>
<li><a href='#is.smooths.frame'><p>Tests whether an object is of class smooths.frame</p></a></li>
<li><a href='#longitudinalPrime'><p>Selects a set variables to be retained in a data frame of longitudinal data</p></a></li>
<li><a href='#plotAnom'><p>Identifies anomalous individuals and produces profile plots without them and with just them</p></a></li>
<li><a href='#plotCorrmatrix'><p>Calculates and plots correlation matrices for a set of responses</p></a></li>
<li><a href='#plotDeviationsBoxes'><p>Produces boxplots of the deviations of the observed values from the smoothed values over values of x.</p></a></li>
<li><a href='#plotImagetimes'><p>Plots the position of a time within an interval against the interval for each cart</p></a></li>
<li><a href='#plotLongitudinal'><p>Produces profile plots of longitudinal data for a set of individuals</p></a></li>
<li><a href='#plotMedianDeviations'><p>Calculates and plots  the median of the deviations of the smoothed values from the observed values.</p></a></li>
<li><a href='#plotProfiles'><p>Produces profile plots of longitudinal data for a set of individuals</p></a></li>
<li><a href='#plotSmoothsComparison'><p>Plots  several sets of smoothed values for a response, possibly along with growth rates and optionally including the unsmoothed values, as well as deviations boxplots.</p></a></li>
<li><a href='#plotSmoothsDevnBoxplots'><p>Produces boxplots for several sets of deviations of the smoothed values from a response, possibly along with growth rates.</p></a></li>
<li><a href='#plotSmoothsMedianDevns'><p>Calculates and plots the medians of the deviations from the observed values for</p>
several sets of smoothed values  stored in a <code>data.frame</code> in long format.</a></li>
<li><a href='#prepImageData'><p>Prepares raw imaging data for further processing</p></a></li>
<li><a href='#probeSmoothing'><p>Compares, for a set of specified values of df and different smoothing methods,</p>
a response and the smooths of it, possibly along with growth rates calculated
from the smooths</a></li>
<li><a href='#probeSmooths'><p>For a response in a <code>data.frame</code> in long format, computes and compares, for</p>
sets of smoothing parameters, smooths of the response, possibly along with
growth rates calculated from the smooths.</a></li>
<li><a href='#PVA'><p>Selects a subset of variables using Principal Variable Analysis (PVA)</p></a></li>
<li><a href='#PVA.data.frame'><p>Selects a subset of variables stored in a data.frame using Principal Variable Analysis (PVA)</p></a></li>
<li><a href='#PVA.matrix'><p>Selects a subset of variables using Principal Variable Analysis (PVA) based on a correlation matrix</p></a></li>
<li><a href='#rcontrib'><p>Computes a measure of how correlated each variable in a set is with the other variable,</p>
conditional on a nominated subset of them</a></li>
<li><a href='#rcontrib.data.frame'><p>Computes a measure of how correlated each variable in a set is with the other variable,</p>
conditional on a nominated subset of them</a></li>
<li><a href='#rcontrib.matrix'><p>Computes a measure of how correlated each variable in a set is with the other variable,</p>
conditional on a nominated subset of them</a></li>
<li><a href='#RicePrepped.dat'><p>Prepped data from an experiment to investigate a rice germplasm panel.</p></a></li>
<li><a href='#RiceRaw.dat'><p>Data for an experiment to investigate a rice germplasm panel</p></a></li>
<li><a href='#smooths.frame'><p>Description of a smooths.frame object</p></a></li>
<li><a href='#smoothSpline'><p>Fit a spline to smooth the relationship between a <code>response</code> and an <code>x</code> in a <code>data.frame</code>,</p>
optionally computing growth rates using derivatives.</a></li>
<li><a href='#splitContGRdiff'><p>Adds, to a <code>data.frame</code>, the growth rates for individuals calculated</p>
continuously over time by differencing response values.</a></li>
<li><a href='#splitSplines'><p>Adds the fits, and optionally growth rates computed from derivatives, after</p>
fitting splines to a response for an individual stored in a <code>data.frame</code>
in long format</a></li>
<li><a href='#splitValueCalculate'><p>Calculates a single value that is a function of an individual's values for a response</p></a></li>
<li><a href='#tomato.dat'><p>Longitudinal data for an experiment to investigate tomato response to mycorrhizal fungi and zinc</p></a></li>
<li><a href='#traitExtractFeatures'><p>Extract features, that are single-valued for each individual, from traits observed over time.</p></a></li>
<li><a href='#traitSmooth'><p>Obtain smooths for a trait by fitting spline functions and, having compared</p>
several smooths, allows one of them to be chosen and returned in a <code>data.frame</code>.</a></li>
<li><a href='#twoLevelOpcreate'><p>Creates a data.frame formed by applying, for each response, a binary operation</p>
to the paired values of two different treatments</a></li>
<li><a href='#validSmoothsFrame'><p>Checks that an object is a valid <code>smooths.frame</code>.</p></a></li>
<li><a href='#WUI'><p>Calculates the Water Use Index (WUI)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.1.24</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Functional Analysis of Phenotypic Growth Data to Smooth and
Extract Traits</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dae, GGally, ggplot2, grDevices, Hmisc, JOPS, methods,
RColorBrewer, readxl, reshape, stats, stringi, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, nlme, R.rsp, scales</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Description:</td>
<td>Assists in the plotting and functional smoothing of traits 
    measured over time and the extraction of features from these traits, 
    implementing the SET (Smoothing and Extraction of Traits) method 
    described in Brien et al. (2020) Plant Methods, 16. Smoothing of 
    growth trends for individual plants using natural cubic smoothing 
    splines or P-splines is available for removing transient effects and 
    segmented smoothing is available to deal with discontinuities in 
    growth trends. There are graphical tools for assessing the adequacy 
    of trait smoothing, both when using this and other packages, such as 
    those that fit nonlinear growth models. A range of per-unit (plant, 
    pot, plot) growth traits or features can be extracted from the 
    data, including single time points, interval growth rates and other 
    growth statistics, such as maximum growth or days to maximum growth. 
    The package also has tools adapted to inputting data from 
    high-throughput phenotyping facilities, such from a Lemna-Tec 
    Scananalyzer 3D (see <a href="https://www.youtube.com/watch?v=MRAF_mAEa7E/">https://www.youtube.com/watch?v=MRAF_mAEa7E/</a> 
    for more information). The package 'growthPheno' can also be 
    installed from <a href="http://chris.brien.name/rpackages/">http://chris.brien.name/rpackages/</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://chris.brien.name/">http://chris.brien.name/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/briencj/growthPheno/issues">https://github.com/briencj/growthPheno/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-29 03:00:37 UTC; briencj</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris Brien <a href="https://orcid.org/0000-0003-0581-1817"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris Brien &lt;chris.brien@adelaide.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-29 04:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anom'>Tests if any values in a vector are anomalous in being outside specified limits</h2><span id='topic+anom'></span>

<h3>Description</h3>

<p>Test whether any values in <code>x</code> are less than the value of 
<code>lower</code>, if it is not <code>NULL</code>, or are greater than the 
value of <code>upper</code>, if it is not <code>NULL</code>, or both.</p>


<h3>Usage</h3>

<pre><code class='language-R'>anom(x, lower=NULL, upper=NULL, na.rm = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anom_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+vector">vector</a></code> containing the values to be tested.</p>
</td></tr>
<tr><td><code id="anom_+3A_lower">lower</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> such that values in <code>x</code> below it are  
considered to be anomalous.</p>
</td></tr>
<tr><td><code id="anom_+3A_upper">upper</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> such that values in <code>x</code> above it are  
considered to be anomalous.</p>
</td></tr>
<tr><td><code id="anom_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether <code>NA</code> values should 
be stripped before the testing proceeds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether any values have been found to 
be outside the limits specified by <code>lower</code> or <code>upper</code> or both.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
anom.val &lt;- anom(longi.dat$sPSA.AGR, lower=2.5)
</code></pre>

<hr>
<h2 id='args4chosen_plot'>Creates a <code>list</code> of the values for the options of profile plots for the chosen smooth</h2><span id='topic+args4chosen_plot'></span>

<h3>Description</h3>

<p>Creates a <code>list</code> of the values for the options of profile plots (and boxplots facets) for comparing smooths.
Note that <code>plots.by</code>, <code>facet.x</code>, <code>facet.y</code> and <code>include.raw</code> jointly 
define the organization of the plots. The default settings are optimized for <code><a href="#topic+traitSmooth">traitSmooth</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>args4chosen_plot(plots.by = NULL, 
                 facet.x = ".", facet.y = ".", 
                 include.raw = "no", 
                 collapse.facets.x = FALSE, collapse.facets.y = FALSE, 
                 facet.labeller = NULL, facet.scales = "fixed", 
                 breaks.spacing.x = -2, angle.x = 0, 
                 colour = "black", colour.column = NULL, 
                 colour.values = NULL, alpha = 0.3, 
                 addMediansWhiskers = TRUE,
                 ggplotFuncs = NULL, 
                 ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="args4chosen_plot_+3A_plots.by">plots.by</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> that gives the names of the set of 
<code><a href="base.html#topic+factor">factor</a></code>s by which the data is to be grouped and a separate 
plot produced for each group. If <code>NULL</code>, no groups are formed. If a 
set of <code><a href="base.html#topic+factor">factor</a></code>s, such as  <code>Type</code>, <code>Tuning</code> and 
<code>Method</code>, that uniquely index the combinations of the 
smoothing-parameter values is specified, then groups are formed for each 
combination of the levels of the these <code><a href="base.html#topic+factor">factor</a></code>s, and a separate plot is 
produced for each combination.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the <code><a href="base.html#topic+factor">factor</a></code>s 
to be used to form subsets to be plotted in separate columns of the 
profiles plots. The default of <code>"."</code> results 
in no split into columns.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code><a href="base.html#topic+factor">factor</a></code>s 
to be used to form subsets to be plotted in separate rows of the 
profiles plots. The default of <code>"."</code> results 
in no split into rows.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_include.raw">include.raw</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> indicating whether plots of the 
raw (unsmoothed) trait, corresponding to the plots of the smoothed traits, 
are to be included in profile plots. The options are <code>no</code>, <code>alone</code>, 
<code>facet.x</code>, or <code>facet.y</code>. That is, the plots of the raw traits are 
plotted separately or as part of either <code>facet.x</code> or 
<code>facet.y</code>.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_collapse.facets.x">collapse.facets.x</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> to indicate whether all variables 
specified by <code>facets.x</code> are to be collapsed to a single variable. 
Note that the smoothing-parameters factors, if present, are always collapsed.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_collapse.facets.y">collapse.facets.y</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> to indicate whether all variables 
specified by <code>facets.y</code> are to be collapsed to a single variable. 
Note that the smoothing-parameters factors, if present, are always collapsed.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_facet.labeller">facet.labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_facet.scales">facet.scales</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying whether the scales are shared 
across all facets of a plot (&quot;fixed&quot;), or do they vary across rows (the 
default, &quot;free_x&quot;), columns (&quot;free_y&quot;), or both rows and columns (&quot;free&quot;)?</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_breaks.spacing.x">breaks.spacing.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> whose absolute values specifies the 
distance between major breaks for the x-axis in a sequence beginning with the 
minimum x value and continuing up to the maximum x value. If it is negative, 
the breaks that do not have x values in <code>data</code> will be omitted. 
Minor breaks will be at half major break value or, if these do not correspond to 
x-values in <code>data</code> when <code>breaks.spacing.x</code> is negative, have 
a spacing of one. Thus, when <code>breaks.spacing.x</code> is negative,  
grid lines will only be included for x-values that occur in <code>data</code>.  
These settings can be overwritten by supplying, in <code>ggplotFuncs</code>, 
a <code>scale_x_continuous</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_angle.x">angle.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 360 that gives the angle of the 
x-axis text to the x-axis. It can also be set by supplying, in 
<code>ggplotFuncs</code>, a <code>theme</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_colour">colour</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying a single colour to use in 
drawing the lines for the profiles. If colouring according to the 
values of a variable is required then use <code>colour.column</code>.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_colour.column">colour.column</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of a column 
in <code>data</code> over whose values the colours of the lines are to be 
varied. The colours can be specified using <code>colour.values</code>.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_colour.values">colour.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector specifying the values of 
the colours to use in drawing the lines for the profiles.  
If this is a named vector, then the values will be matched based 
on the names. If unnamed, values will be matched in order 
(usually alphabetical) within the limits of the scale.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_alpha">alpha</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the degrees of 
transparency to be used in plotting the responses. 
It is a ratio in which the denominator specifies the number of 
points (or lines) that must be overplotted to give a solid cover.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_addmedianswhiskers">addMediansWhiskers</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether plots over 
time of the medians and outer whiskers are to be added to the plot. 
The outer whiskers are related to the whiskers on a box-and-whisker 
and are defined as the median plus (and minus) 1.5 times the 
interquartile range (IQR). Points lying outside the whiskers are 
considered to be potential outliers.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> 
object for a profiles plot.</p>
</td></tr>
<tr><td><code id="args4chosen_plot_+3A_...">...</code></td>
<td>
<p>allows arguments to be passed to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code>, <code><a href="#topic+probeSmooths">probeSmooths</a></code>, <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code> and <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>args4chosen_plot(plots.by = "Type", 
                 facet.x = "Tuning", facet.y = c("Smarthouse", "Treatment.1"), 
                 include.raw = "facet.x", 
                 alpha  = 0.4, 
                 colour.column = "Method", 
                 colour.values = c("orange", "olivedrab"))
</code></pre>

<hr>
<h2 id='args4chosen_smooth'>Creates a <code>list</code> of the values for the smoothing parameters for 
which a smooth is to be extracted</h2><span id='topic+args4chosen_smooth'></span>

<h3>Description</h3>

<p>Creates a <code><a href="base.html#topic+list">list</a></code> of the values for the smoothing parameters for 
which a smooth is to be extracted. 
The default settings for these are optimized for <code><a href="#topic+traitSmooth">traitSmooth</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>args4chosen_smooth(smoothing.methods = "logarithmic", 
                   spline.types = "PS", 
                   df = NULL, 
                   lambdas = NULL,
                   combinations = "single")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="args4chosen_smooth_+3A_smoothing.methods">smoothing.methods</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the smoothing method 
for the chosen smooth. The two possibilites are (i) <code>"direct"</code>, for directly 
smoothing the observed <code>response</code>, and (ii) <code>"logarithmic"</code>, for 
smoothing the <code>log</code>-transformed <code>response</code>.</p>
</td></tr>
<tr><td><code id="args4chosen_smooth_+3A_spline.types">spline.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the type of spline  
for the chosen smooth. Currently, the possibilites are (i) <code>"NCSS"</code>, for natural 
cubic smoothing splines, and (ii) <code>"PS"</code>, for P-splines.</p>
</td></tr>
<tr><td><code id="args4chosen_smooth_+3A_df">df</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> with single value that specifies, for 
natural cubic smoothing splines (<code>NCSS</code>), the desired equivalent 
numbers of degrees of freedom of the chosen smooth (trace of the smoother matrix). 
Lower values result in more smoothing. </p>
</td></tr>
<tr><td><code id="args4chosen_smooth_+3A_lambdas">lambdas</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> or a <code><a href="base.html#topic+numeric">numeric</a></code> specifying 
the positive penalties for which the chosen smooth is required.</p>
</td></tr>
<tr><td><code id="args4chosen_smooth_+3A_combinations">combinations</code></td>
<td>
<p>Generally, this argument should be set to <code>single</code> so that 
ony one value should be supplied to the functions arguments. Also, only one of 
<code>df</code> or <code>lambdas</code> should be set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code> and <code><a href="#topic+probeSmooths">probeSmooths</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
args4chosen_smooth(smoothing.methods = "direct", 
                   spline.types = "NCSS", df = 4)
args4chosen_smooth(smoothing.methods = "log", 
                   spline.types = "PS", lambdas = 0.36)
</code></pre>

<hr>
<h2 id='args4devnboxes_plot'>Creates a <code>list</code> of the values for the options of profile plots for comparing smooths</h2><span id='topic+args4devnboxes_plot'></span>

<h3>Description</h3>

<p>Creates a <code>list</code> of the values for the options of deviations boxplots for comparing smooths.
Note that <code>plots.by</code>, <code>facet.x</code> and <code>facet.y</code> jointly 
define the organization of the plots. The default settings are optimized for <code><a href="#topic+traitSmooth">traitSmooth</a></code> so that, 
if you want to change any of these from their default settings when using <code>args4devnboxes_plot</code> with a function 
other than <code><a href="#topic+traitSmooth">traitSmooth</a></code>, then it is recommended that you specify all of them to ensure that the complete set 
has been correctly specified. Otherwise, the default settings will be those shown here and these may be different to the 
default settings shown for the function with which you are using <code>args4devnboxes_plot</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>args4devnboxes_plot(plots.by = "Type", 
                    facet.x = c("Method", "Tuning"), facet.y = ".", 
                    collapse.facets.x = TRUE, collapse.facets.y = FALSE, 
                    facet.labeller = NULL, facet.scales = "fixed", 
                    angle.x = 0, 
                    which.plots = "none", 
                    ggplotFuncs = NULL, 
                    ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="args4devnboxes_plot_+3A_plots.by">plots.by</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> that gives the names of the set of 
<code><a href="base.html#topic+factor">factor</a></code>s by which the data is to be grouped and a separate 
plot produced for each group. If <code>NULL</code>, no groups are formed. If a 
set of <code><a href="base.html#topic+factor">factor</a></code>s, such as  <code>Type</code>, <code>Tuning</code> and 
<code>Method</code>, that uniquely index the combinations of the 
smoothing-parameter values is specified, then groups are formed for each 
combination of the levels of the these <code><a href="base.html#topic+factor">factor</a></code>s, and a separate plot is 
produced for each combination.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the <code><a href="base.html#topic+factor">factor</a></code>s 
to be used to form subsets to be plotted in separate columns of the 
profiles plots and deviations boxplots. The default of <code>"."</code> results 
in no split into columns.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code><a href="base.html#topic+factor">factor</a></code>s 
to be used to form subsets to be plotted in separate rows of the 
profiles plots and deviations boxplots. The default of <code>"."</code> results 
in no split into rows.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_collapse.facets.x">collapse.facets.x</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> to indicate whether all variables 
specified by <code>facets.x</code> are to be collapsed to a single variable. 
Note that the smoothing-parameters factors, if present, are always collapsed.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_collapse.facets.y">collapse.facets.y</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> to indicate whether all variables 
specified by <code>facets.y</code> are to be collapsed to a single variable. 
Note that the smoothing-parameters factors, if present, are always collapsed.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_facet.labeller">facet.labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_facet.scales">facet.scales</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying whether the scales are shared 
across all facets of a plot (&quot;fixed&quot;), or do they vary across rows (the 
default, &quot;free_x&quot;), columns (&quot;free_y&quot;), or both rows and columns (&quot;free&quot;)?</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_angle.x">angle.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 360 that gives the angle of the 
x-axis text to the x-axis. It can also be set by supplying, in 
<code>ggplotFuncs</code>, a <code>theme</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_which.plots">which.plots</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating which plots are to be produced. 
The options are either <code>none</code> or <code>absolute.deviations</code> and/or 
<code>relative.deviations</code>. Boxplots of the absolute deviations 
are specified by <code>absolute.boxplots</code>, the absolute deviations being 
the values of a trait minus their smoothed values (observed - smoothed). 
Boxplots of the relative deviations are specified by <code>relative.boxplots</code>, 
the relative deviations being the absolute deviations divided by the 
smoothed values of the trait.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> 
object for a boxplots.</p>
</td></tr>
<tr><td><code id="args4devnboxes_plot_+3A_...">...</code></td>
<td>
<p>allows arguments to be passed to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code>, <code><a href="#topic+probeSmooths">probeSmooths</a></code>, <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code> and <code><a href="#topic+args4chosen_plot">args4chosen_plot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>args4devnboxes_plot(plots.by = "Type", 
                    facet.x = "Tuning", 
                    facet.y = c("Smarthouse", "Treatment.1"), 
                    which.plots = "absolute")
</code></pre>

<hr>
<h2 id='args4meddevn_plot'>Creates a <code>list</code> of the values for the options of median deviations plots for smooths</h2><span id='topic+args4meddevn_plot'></span>

<h3>Description</h3>

<p>Creates a <code>list</code> of the values for the options of median deviations plots for smooths. 
Note that the arguments <code>plots.by</code>, <code>plots.group</code>, <code>facet.x</code> and <code>facet.y</code> 
jointly define the organization of the plots. The default settings are optimized for <code><a href="#topic+traitSmooth">traitSmooth</a></code> so that, 
if you want to change any of these from their default settings when using <code>args4meddevn_plot</code> with a function 
other than <code><a href="#topic+traitSmooth">traitSmooth</a></code>, then it is recommended that you specify all of them to ensure that the complete set 
has been correctly specified. Otherwise, the default settings will be those shown here and these may be different to the 
default settings shown for the function with which you are using <code>args4meddevn_plot</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>args4meddevn_plot(plots.by = NULL, plots.group = "Tuning", 
                  facet.x = c("Method","Type"), facet.y = ".",  
                  facet.labeller = NULL, facet.scales = "free_x",
                  breaks.spacing.x = -4, angle.x = 0, 
                  colour.values = NULL, shape.values = NULL, 
                  alpha = 0.5, 
                  propn.note = TRUE, propn.types = NULL, 
                  ggplotFuncs = NULL, 
                  ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="args4meddevn_plot_+3A_plots.by">plots.by</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> that give the names of the set of 
<code><a href="base.html#topic+factor">factor</a></code>s by which medians deviations data is to be 
grouped and a separate plot produced for each group. If <code>NULL</code>, 
no groups are formed. If a set of <code><a href="base.html#topic+factor">factor</a></code>s, such as  
<code>Type</code>, <code>Tuning</code> and <code>Method</code>, that uniquely index the 
combinations of the smoothing-parameter values is specified, then 
groups are formed for each combination of the levels of the these 
<code><a href="base.html#topic+factor">factor</a></code>s, and a separate plot is produced for each combination.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_plots.group">plots.group</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> that gives the names of the set 
of <code><a href="base.html#topic+factor">factor</a></code>s by which the subset of medians deviations data 
within a single facet in a single plot is to be grouped for plotting  
as separate lines.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code><a href="base.html#topic+factor">factor</a></code>s 
to be used to form subsets to be plotted in separate columns of the 
medians deviations plots. The default of <code>"."</code> results 
in no split into columns.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code><a href="base.html#topic+factor">factor</a></code>s 
to be used to form subsets to be plotted in separate rows of the 
medians deviations plots. The default of <code>"."</code> results 
in no split into rows.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_facet.labeller">facet.labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_facet.scales">facet.scales</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying whether the scales are shared 
across all facets of a plot (&quot;fixed&quot;), or do they vary across rows (the 
default, &quot;free_x&quot;), columns (&quot;free_y&quot;), or both rows and columns (&quot;free&quot;)?</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_breaks.spacing.x">breaks.spacing.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> whose absolute values specifies the 
distance between breaks for the x-axis in a sequence beginning with the 
minimum x value and continuing up to the maximum x value. If it is negative, 
the breaks that do not have x values in <code>data</code> will be omitted. 
Minor breaks will be at half this value or, if these do not correspond to 
x-values in <code>data</code> when <code>breaks.spacing.x</code> is negative, have 
a spacing of one. Thus, when <code>breaks.spacing.x</code> is negative,  
grid lines will only be included for x-values that occur in <code>data</code>.  
These settings can be overwritten by supplying, in <code>ggplotFuncs</code>, 
a <code>scale_x_continuous</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_angle.x">angle.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 360 that gives the angle of the 
x-axis text to the x-axis. It can also be set by supplying, in 
<code>ggplotFuncs</code>, a <code>theme</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_colour.values">colour.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector specifying the values of 
the colours to use in drawing the lines for the medians deviations
within a facet. If this is a named vector, then the values will be 
matched based on the names. If unnamed, values will be matched in order 
(usually alphabetical) within the limits of the scale.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_shape.values">shape.values</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector specifying the values of 
the shapes to use in drawing the points for the medians deviations
within a facet. If this is a named vector, then the values will be 
matched based on the names. If unnamed, values will be matched in 
order.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_alpha">alpha</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the degrees of 
transparency to be used in plotting a median deviations plot. 
It is a ratio in which the denominator specifies the number of 
points (or lines) that must be overplotted to give a solid cover.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_propn.note">propn.note</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether a note giving the 
proportion of the median value of the <code>response</code> for each time is 
to be included in the <code>medians.deviations</code> plots.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_propn.types">propn.types</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving, for each of the 
<code>trait.types</code>, the proportion of the median value of the 
<code>response</code> for each time to be used to plot envelopes in the 
median deviations plots. If set to <code>NULL</code>, the plots of the 
proprotion envelopes are omitted.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element. Note that 
these functions are applied to the <code>compareian</code> deviations plots only.</p>
</td></tr>
<tr><td><code id="args4meddevn_plot_+3A_...">...</code></td>
<td>
<p>allows arguments to be passed to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code>, <code><a href="#topic+probeSmooths">probeSmooths</a></code> and <code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>args4meddevn_plot(plots.by = "Type", plots.group = "Tuning",  
                  facet.x = "Method", facet.y = ".",
                  propn.types = c(0.02,0.1, 0.2))
</code></pre>

<hr>
<h2 id='args4profile_plot'>Creates a <code>list</code> of the values for the options of profile plots for comparing smooths</h2><span id='topic+args4profile_plot'></span>

<h3>Description</h3>

<p>Creates a <code>list</code> of the values for the options of profile plots for comparing smooths.
Note that <code>plots.by</code>, <code>facet.x</code>, <code>facet.y</code> and <code>include.raw</code> jointly 
define the organization of the plots. The default settings are optimized for <code><a href="#topic+traitSmooth">traitSmooth</a></code> so that, 
if you want to change any of these from their default settings when using <code>args4profile_plot</code> with a function 
other than <code><a href="#topic+traitSmooth">traitSmooth</a></code>, then it is recommended that you specify all of them to ensure that the complete set 
has been correctly specified. Otherwise, the default settings will be those shown here and these may be different to the 
default settings shown for the function with which you are using <code>args4profile_plot</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>args4profile_plot(plots.by = "Type", 
                  facet.x = c("Method", "Tuning"), facet.y = ".", 
                  include.raw = "facet.x", 
                  collapse.facets.x = TRUE, collapse.facets.y = FALSE, 
                  facet.labeller = NULL, facet.scales = "fixed", 
                  breaks.spacing.x = -4, angle.x = 0, 
                  colour = "black", colour.column = NULL, 
                  colour.values = NULL, alpha = 0.3, 
                  addMediansWhiskers = TRUE,
                  ggplotFuncs = NULL, 
                  ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="args4profile_plot_+3A_plots.by">plots.by</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> that gives the names of the set of 
<code><a href="base.html#topic+factor">factor</a></code>s by which the data is to be grouped and a separate 
plot produced for each group. If <code>NULL</code>, no groups are formed. If a 
set of <code><a href="base.html#topic+factor">factor</a></code>s, such as  <code>Type</code>, <code>Tuning</code> and 
<code>Method</code>, that uniquely index the combinations of the 
smoothing-parameter values is specified, then groups are formed for each 
combination of the levels of the these <code><a href="base.html#topic+factor">factor</a></code>s, and a separate plot is 
produced for each combination.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the <code><a href="base.html#topic+factor">factor</a></code>s 
to be used to form subsets to be plotted in separate columns of the 
profiles plots and deviations boxplots. The default of <code>"."</code> results 
in no split into columns.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code><a href="base.html#topic+factor">factor</a></code>s 
to be used to form subsets to be plotted in separate rows of the 
profiles plots and deviations boxplots. The default of <code>"."</code> results 
in no split into rows.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_include.raw">include.raw</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> indicating whether plots of the 
raw (unsmoothed) trait, corresponding to the plots of the smoothed traits, 
are to be included in profile plots. The options are <code>no</code>, <code>alone</code>, 
<code>facet.x</code>, or <code>facet.y</code>. That is, the plots of the raw traits are 
plotted separately or as part of either <code>facet.x</code> or 
<code>facet.y</code>.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_collapse.facets.x">collapse.facets.x</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> to indicate whether all variables 
specified by <code>facets.x</code> are to be collapsed to a single variable. 
Note that the smoothing-parameters factors, if present, are always collapsed.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_collapse.facets.y">collapse.facets.y</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> to indicate whether all variables 
specified by <code>facets.y</code> are to be collapsed to a single variable. 
Note that the smoothing-parameters factors, if present, are always collapsed.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_facet.labeller">facet.labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_facet.scales">facet.scales</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying whether the scales are shared 
across all facets of a plot (&quot;fixed&quot;), or do they vary across rows (the 
default, &quot;free_x&quot;), columns (&quot;free_y&quot;), or both rows and columns (&quot;free&quot;)?</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_breaks.spacing.x">breaks.spacing.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> whose absolute values specifies the 
distance between breaks for the x-axis in a sequence beginning with the 
minimum x value and continuing up to the maximum x value. If it is negative, 
the breaks that do not have x values in <code>data</code> will be omitted. 
Minor breaks will be at half this value or, if these do not correspond to 
x-values in <code>data</code> when <code>breaks.spacing.x</code> is negative, have 
a spacing of one. Thus, when <code>breaks.spacing.x</code> is negative,  
grid lines will only be included for x-values that occur in <code>data</code>.  
These settings can be overwritten by supplying, in <code>ggplotFuncs</code>, 
a <code>scale_x_continuous</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_angle.x">angle.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 360 that gives the angle of the 
x-axis text to the x-axis. It can also be set by supplying, in 
<code>ggplotFuncs</code>, a <code>theme</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_colour">colour</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying a single colour to use in 
drawing the lines for the profiles. If colouring according to the 
values of a variable is required then use <code>colour.column</code>.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_colour.column">colour.column</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of a column 
in <code>data</code> over whose values the colours of the lines are to be 
varied. The colours can be specified using <code>colour.values</code>.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_colour.values">colour.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector specifying the values of 
the colours to use in drawing the lines for the profiles.  
If this is a named vector, then the values will be matched based 
on the names. If unnamed, values will be matched in order 
(usually alphabetical) within the limits of the scale.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_alpha">alpha</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the degrees of 
transparency to be used in plotting the responses. 
It is a ratio in which the denominator specifies the number of 
points (or lines) that must be overplotted to give a solid cover.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_addmedianswhiskers">addMediansWhiskers</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether plots over 
time of the medians and outer whiskers are to be added to the plot. 
The outer whiskers are related to the whiskers on a box-and-whisker 
and are defined as the median plus (and minus) 1.5 times the 
interquartile range (IQR). Points lying outside the whiskers are 
considered to be potential outliers.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> 
object for a profiles plot.</p>
</td></tr>
<tr><td><code id="args4profile_plot_+3A_...">...</code></td>
<td>
<p>allows arguments to be passed to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code>, <code><a href="#topic+probeSmooths">probeSmooths</a></code>, <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code> and <code><a href="#topic+args4chosen_plot">args4chosen_plot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>args4profile_plot(plots.by = "Type", 
                  facet.x = "Tuning", facet.y = c("Smarthouse", "Treatment.1"), 
                  include.raw = "facet.x", 
                  alpha  = 0.4, 
                  colour.column = "Method", 
                  colour.values = c("orange", "olivedrab"))
</code></pre>

<hr>
<h2 id='args4smoothing'>Creates a <code>list</code> of the values for the smoothing parameters to be passed to a smoothing function</h2><span id='topic+args4smoothing'></span>

<h3>Description</h3>

<p>Creates a <code><a href="base.html#topic+list">list</a></code> of the values for the smoothing parameters to be 
passed to a smoothing function. Note that <code>smoothing.methods</code>, 
<code>spline.types</code>, <code>df</code> and <code>lambdas</code> are combined to define the 
set of smooths. The default settings are optimized for <code><a href="#topic+traitSmooth">traitSmooth</a></code> so that, 
if you want to change any of these from their default settings when using <code>args4smoothing</code> with a function 
other than <code><a href="#topic+traitSmooth">traitSmooth</a></code>, then it is recommended that you specify all of them to ensure that the complete set 
has been correctly specified. Otherwise, the default settings will be those shown here and these may be different to the 
default settings shown for the function with which you are using <code>args4smoothing</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'> args4smoothing(smoothing.methods = "logarithmic", 
                spline.types = c("NCSS","PS"), 
                df = 5:7, 
                lambdas = list(PS = round(10^c(-0.5, 0, 0.5, 1), 
                                          digits = 3)),
                smoothing.segments = NULL, 
                npspline.segments = NULL, 
                na.x.action="exclude", na.y.action = "trimx", 
                external.smooths = NULL, 
                correctBoundaries = FALSE, 
                combinations = "allvalid", 
                ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="args4smoothing_+3A_smoothing.methods">smoothing.methods</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the smoothing method 
to use. The two possibilites are (i) <code>"direct"</code>, for directly 
smoothing the observed <code>response</code>, and (ii) <code>"logarithmic"</code>, for 
smoothing the <code>log</code>-transformed <code>response</code> and then 
back-transforming by taking the exponentional of the fitted values.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_spline.types">spline.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the type of spline  
to use. Currently, the possibilites are (i) <code>"NCSS"</code>, for natural 
cubic smoothing splines, and (ii) <code>"PS"</code>, for P-splines.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_df">df</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> with at least one value that specifies, for 
natural cubic smoothing splines (<code>NCSS</code>), the desired equivalent 
numbers of degrees of freedom of the smooths (trace of the smoother matrix). 
Lower values result in more smoothing. If <code>df = NULL</code>, the amount of 
smoothing can be controlled by including a component named <code>NCSS</code> 
in the <code><a href="base.html#topic+list">list</a></code> for <code>lambdas</code>. If <code>df</code> is <code>NULL</code> 
and <code>lambda</code> does not include a component named <code>NCSS</code>, 
then an error is issued.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_lambdas">lambdas</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> or a <code><a href="base.html#topic+numeric">numeric</a></code> specifying 
the positive penalties to apply in order to control the amount of smoothing. 
The amount of smoothing decreases as <code>lamda</code> decreases. 
If <code>lambdas</code> is a <code><a href="base.html#topic+list">list</a></code>, then include a 
components with <code>lambdas</code> values and  named for each of the specified 
values of <code>spline.types</code> for which <code>lambdas</code> are to be used. 
If <code>spline.types</code> includes <code>PS</code>, then a component named 
<code>PS</code> with at least one numeric value must be present. If a 
<code><a href="base.html#topic+numeric">numeric</a></code>, then it will be converted to a <code><a href="base.html#topic+list">list</a></code> 
with the single component named <code>PS</code>.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_smoothing.segments">smoothing.segments</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code>, each of whose components 
is a numeric pair specifying the first and last values of an 
<code>times</code>-interval whose data is to be subjected as an entity to smoothing 
using splines. The separate smooths will be combined to form a whole 
smooth for each individual. If <code>get.rates</code> includes <code>smoothed</code> 
or is <code>TRUE</code>, <code>rates.method</code> is <code>differences</code> and 
<code>ntimes2span</code> is 2, the smoothed growth rates will be computed over 
the set of segments; otherwise, they will be computed within segments. 
If <code>smoothing.segments</code> is <code>NULL</code>, the data is not 
segmented for smoothing.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_npspline.segments">npspline.segments</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for P-splines (<code>PS</code>), 
the number of equally spaced segments between <code>min(x)</code> and <code>max(x)</code>, 
excluding missing values, to use in constructing the B-spline basis for the 
spline fitting. If <code>npspline.segments</code> is NULL, <code>npspline.segments</code> 
is set to the maximum of 10 and <code>ceiling((nrow(data)-1)/2)</code> i.e. there will 
be at least 10 segments and, for more than 22 <code>times</code> values, there will be 
half as many segments as there are <code>times</code> values. The amount of smoothing 
decreases as <code>npspline.segments</code> increases. When the data has been 
segmented for smoothing (<code>smoothing.segments</code> is not <code>NULL</code>), 
an <code>npspline.segments</code> value can be supplied for each segment.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_na.x.action">na.x.action</code></td>
<td>
<p>A <code>character</code> string that specifies the action to 
be taken when values of <code>x</code> are <code>NA</code>. The possible 
values are <code>fail</code>, <code>exclude</code> or <code>omit</code>. 
For <code>exclude</code> and <code>omit</code>, predictions and derivatives 
will only be obtained for nonmissing values of <code>x</code>. 
The difference between these two codes is that for <code>exclude</code> the returned 
<code>data.frame</code> will have as many rows as <code>data</code>, the 
missing values have been incorporated. </p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_na.y.action">na.y.action</code></td>
<td>
<p>A <code>character</code> string that specifies the action to 
be taken when values of <code>y</code>, or the <code>response</code>, are 
<code>NA</code>.  The possible values are <code>fail</code>, <code>exclude</code>, 
<code>omit</code>, <code>allx</code>, <code>trimx</code>, <code>ltrimx</code> or 
<code>rtrimx</code>. For  all options, except <code>fail</code>, missing 
values in <code>y</code> will be removed before smoothing. 
For <code>exclude</code> and <code>omit</code>, predictions 
and derivatives will be obtained only for nonmissing values of 
<code>x</code> that do not have missing <code>y</code> values. Again, the 
difference between these two is that, only for <code>exclude</code> 
will the missing values be incorporated into the 
returned <code>data.frame</code>. For <code>allx</code>, predictions and 
derivatives will be obtained for all nonmissing <code>x</code>. 
For <code>trimx</code>, they will be obtained for all nonmissing 
<code>x</code> between the first and last nonmissing <code>y</code> values 
that have been ordered for <code>x</code>; for <code>ltrimx</code> and 
<code>utrimx</code> either the lower or upper missing <code>y</code> 
values, respectively, are trimmed.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_external.smooths">external.smooths</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the one or more smooths of 
a <code>response</code> in the column specified by <code>smoothed.response</code>. 
Multiple smoooths should be supplied in long.format with the same columns 
as the <code><a href="#topic+smooths.frame">smooths.frame</a></code> <code>data</code>, except for the 
smoothing-parameter columns <code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, 
<code>Tuning</code> and <code>Method</code>. Only those smoothing-parameter columns that 
are to be used in any of <code>plots.by</code>, <code>plots.group</code>, <code>facet.x</code> 
and <code>facet.y</code> should be included with labels appropriate to the 
<code>external.smooths</code>. Those smoothing-parameter columns not included in 
<code>external.smooths</code> will have columns of <code>"Other"</code> added to 
<code>external.smooths</code>.
</p>
<p>The growth rates will be computed by differencing according to the settings of 
<code>get.rates</code> and <code>trait.types</code> in the function that calls 
<code>args4smoothing</code>.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_correctboundaries">correctBoundaries</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether the fitted spline 
values are to have the method of Huang (2001) applied 
to them to correct for estimation bias at the end-points. Note that 
<code>spline.type</code> must be <code>NCSS</code> and <code>lambda</code> and <code>deriv</code> 
must be <code>NULL</code> for <code>correctBoundaries</code> to be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_combinations">combinations</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying how the values of the different 
smoothing parameters are to be combined to specify the smooths that are 
to be obtained. The option <code>allvalid</code> results in a smooth for each of the 
combinations of the values of <code>smoothing.methods</code>, <code>spline.types</code>, 
<code>df</code> and <code>lambdas</code> that are valid; the other smoothing.args 
will be the same for all smooths.  
</p>
<p>The option <code>parallel</code> specifies that, if set, each of four 
smoothing parameters, <code>smoothing.methods</code>, <code>spline.types</code>, 
<code>df</code> and <code>lambdas</code>, must have the same number of values and that this 
number is the number of different smooths to be produced. The values of the 
parameters in the same position within each parameter collectively specify a 
single smooth. Because the value of only one of <code>df</code> and <code>lambdas</code> 
must be specified for a smooth, one of these must be set to <code>NA</code> and the 
other to the desired value for each smooth. If all values for one of them is 
<code>NA</code>, then the argument may be omitted or set to <code>NULL</code>.
</p>
<p>The option <code>single</code> is for the specification of a single smooth. This will 
mean that only one of <code>df</code> or <code>lambdas</code> should be set.</p>
</td></tr>
<tr><td><code id="args4smoothing_+3A_...">...</code></td>
<td>
<p>allows arguments to be passed to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code> and <code><a href="#topic+probeSmooths">probeSmooths</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
args4smoothing(smoothing.methods = "direct", 
               spline.types = "NCSS", df = NULL, lambdas = NULL, 
               smoothing.segments = NULL, npspline.segments = NULL, 
               combinations = "allvalid")
args4smoothing(smoothing.methods = c("log","dir","log"), 
               spline.types = c("NCSS","NCSS","PS"), 
               df = c(4,5,NA), lambdas = c(NA,NA,0.36), 
              combinations = "parallel")
args4smoothing(smoothing.methods = "log", 
               spline.types = "PS", df = NULL, 
               lambdas = 0.36, combinations = "single")
</code></pre>

<hr>
<h2 id='as.smooths.frame'>Forms a <code><a href="#topic+smooths.frame">smooths.frame</a></code> from a <code>data.frame</code>, ensuring that the correct 
columns are present.</h2><span id='topic+as.smooths.frame'></span>

<h3>Description</h3>

<p>Creates a <code><a href="#topic+smooths.frame">smooths.frame</a></code> from a <code><a href="base.html#topic+data.frame">data.frame</a></code> by adding the 
<code>class</code> <code><a href="#topic+smooths.frame">smooths.frame</a></code> and a set of <code><a href="base.html#topic+attributes">attributes</a></code> to it.</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.smooths.frame(data, individuals = NULL, times = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.smooths.frame_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the results of smoothing the 
data on a set of <code>individuals</code> over time, the data being arranged
in long format both with respect to the times and the 
smoothing-parameter values. It must contain the columns <code>Type</code>, 
<code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code> and <code>Method</code> that 
give the smoothing-parameter values that were used to produce each 
smooth of the data, as well as the columns identifying the 
<code>individuals</code>, the observation times of the responses and 
the unsmoothed and smoothed responses. 
Each response occupies a single column.</p>
</td></tr>
<tr><td><code id="as.smooths.frame_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="as.smooths.frame_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+numeric">numeric</a></code>, or <code><a href="base.html#topic+factor">factor</a></code> with numeric levels, that 
contains the values of the predictor variable to be supplied to 
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> and to be plotted on the x-axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+smooths.frame">smooths.frame</a></code></p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+validSmoothsFrame">validSmoothsFrame</a></code>, <code><a href="#topic+as.smooths.frame">as.smooths.frame</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- read.table(header = TRUE, text = "
Type TunePar TuneVal Tuning Method       ID  DAP   PSA      sPSA
NCSS      df       4   df-4 direct 045451-C   28 57.446 51.18456
NCSS      df       4   df-4 direct 045451-C   30 89.306 87.67343
NCSS      df       7   df-7 direct 045451-C   28 57.446 57.01589
NCSS      df       7   df-7 direct 045451-C   30 89.306 87.01316
")
dat[1:7] &lt;- lapply(dat[1:6], factor)
dat &lt;- as.smooths.frame(dat, individuals = "ID", times = "DAP")
is.smooths.frame(dat)
validSmoothsFrame(dat)
</code></pre>

<hr>
<h2 id='byIndv_ValueCalc'>Calculates a single value that is a function of an individual's values for a response.</h2><span id='topic+byIndv_ValueCalc'></span>

<h3>Description</h3>

<p>Applies a <code>function</code> to calculate a single value from 
an individual's values for a response in a <code>data.frame</code> in 
long format. 
It includes the ability to calculate the observation number 
that is closest to the calculated value of the function and 
the assocated values of a <code><a href="base.html#topic+factor">factor</a></code> or <code>numeric</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>byIndv_ValueCalc(data, response, individuals = "Snapshot.ID.Tag", 
                 FUN = "max", which.obs = FALSE, which.values = NULL, 
                 addFUN2name = TRUE, sep.FUNname = ".", 
                 weights = NULL, na.rm=TRUE, sep.levels = ".", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="byIndv_ValueCalc_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
function is to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> from which the values of <code>FUN</code> are to be  
calculated.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_fun">FUN</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the <code>function</code> 
that calculates the value for each subset.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_which.obs">which.obs</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to determine 
the observation number corresponding to the observed value that is 
closest to the value of the function, in addition to the value of 
the function itself. That is, <code>FUN</code> need not return an observed 
value of the <code>reponse</code>, e.g. <code>quantile</code>. In the case of 
multiple observed response values satisfying this condition, 
the first is returned.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_which.values">which.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+numeric">numeric</a></code> whose values are 
associated with the <code>response</code> values and whose value is to be 
returned for the observation number whose <code>response</code> value 
corresponds to the observed value closest to the value of the 
function. That is, <code>FUN</code> need not return an observed value of 
the <code>reponse</code>, e.g. <code>quantile</code>. In the case of multiple 
observed response values satisfying this condition, the value of 
the <code>which.values</code> vector for the first of these is 
returned.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_addfun2name">addFUN2name</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> that, if <code>TRUE</code>, indicates that 
the <code>FUN</code> name is to be added to the names of the columns in 
the <code><a href="base.html#topic+data.frame">data.frame</a></code> returned by <code>byIndv4Intvl_ValueCalc</code>.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_sep.funname">sep.FUNname</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be used 
to separate the name of <code>FUN</code> from the <code>response</code> 
value in constructing the name for a new response. For no separator, 
set to <code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_weights">weights</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the weights to be supplied as <code>w</code> 
to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code>  indicating whether <code>NA</code> values 
should be stripped before the calculation proceeds.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_sep.levels">sep.levels</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use when the 
levels of <code>individuals</code> are combined. This is needed to avoid 
using a <code><a href="base.html#topic+character">character</a></code> that occurs in a <code><a href="base.html#topic+factor">factor</a></code> to delimit 
levels when the levels of <code>individuals</code> are combined to 
identify subsets.</p>
</td></tr>
<tr><td><code id="byIndv_ValueCalc_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>, with the same number of rows as there are 
<code>individuals</code>, containing a column for the <code>individuals</code> and 
a column with the values of the function for the <code>individuals</code>. 
It is also possible to determine observaton numbers or the values of 
another column in <code>data</code> for the <code>response</code> values that are 
closest to the <code>FUN</code> results, using either or both of 
<code>which.obs</code> and <code>which.values</code>. If <code>which.obs</code> is 
<code>TRUE</code>, a column with observation numbers is included in the  
<code><a href="base.html#topic+data.frame">data.frame</a></code>. 
If <code>which.values</code> is set to the name of a <code><a href="base.html#topic+factor">factor</a></code> or 
a <code><a href="base.html#topic+numeric">numeric</a></code>,a column containing the levels of that 
<code><a href="base.html#topic+factor">factor</a></code> or the values of that <code><a href="base.html#topic+numeric">numeric</a></code> is 
included in the  <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>
<p>The name of the column with the values of the function will be formed by  
concatenating the <code>response</code> and <code>FUN</code>, separated by a full stop. 
If <code>which.obs</code> is <code>TRUE</code>, the column name for the obervations 
numbers will have <code>.obs</code> added after <code>FUN</code> into the column name 
for the function values; if <code>which.values</code> is specified, 
the column name for these values will have a full stop followed by 
<code>which.values</code> added after <code>FUN</code> into the column name 
for the function values.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+byIndv4Intvl_ValueCalc">byIndv4Intvl_ValueCalc</a></code>, <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>,
<code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
sPSA.max.dat &lt;- byIndv_ValueCalc(data=longi.dat, response = "PSA")
AGR.max.dat &lt;- byIndv_ValueCalc(data=longi.dat, response = "sPSA.AGR", 
                                FUN="max", 
                                which.values = "DAP", which.obs = TRUE)
sPSA.dec1.dat &lt;- byIndv_ValueCalc(data=longi.dat, response = "sPSA", 
                                  FUN="quantile", 
                                  which.values = "DAP", probs = 0.1)
</code></pre>

<hr>
<h2 id='byIndv4Intvl_GRsAvg'>Calculates the growth rates for a specified time interval for individuals 
in a <code>data.frame</code> in long format by taking weighted averages of 
growth rates for times within the interval.</h2><span id='topic+byIndv4Intvl_GRsAvg'></span>

<h3>Description</h3>

<p>Using previously calculated growth rates over time, calculates 
the Absolute Growth Rates for a specified interval using the weighted 
averages of AGRs for each time point in the interval (AGR) and the 
Relative Growth Rates for a specified interval using the weighted 
geometric means of RGRs for each time point in the interval (RGR).</p>


<h3>Usage</h3>

<pre><code class='language-R'>byIndv4Intvl_GRsAvg(data, responses, 
                    individuals = "Snapshot.ID.Tag", times = "DAP", 
                    which.rates = c("AGR","RGR"), 
                    suffices.rates=c("AGR","RGR"), sep.rates = ".",
                    start.time, end.time, 
                    suffix.interval, sep.suffix.interval = ".", 
                    sep.levels=".", na.rm=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns from which the 
growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the 
<code>responses</code> for which there are columns 
in <code>data</code> that contain the growth rates that are to be 
averaged. The names of the growth rates should have 
either <code>AGR</code> or <code>RGR</code> appended to the 
<code>responses</code> names.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used in calculating growth rates and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_which.rates">which.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the growth rates that are 
to be averaged to obtain growth rates for an interval. 
It should be a combination of one or more of 
<code>"AGR"</code> and <code>"RGR"</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_suffices.rates">suffices.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffices to be 
appended to <code>response</code> to form the names of the columns 
containing the calculated the growth rates and in which growth 
rates are to be stored. Their elements will be matched with 
those of <code>which.rates</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_sep.rates">sep.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be used 
to separate the <code>suffices.rates</code> value from a <code>response</code> 
value in constructing the name for a new rate. For no separator, 
set to <code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times,
in terms of values in <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will 
be taken as the observation at the start of the interval for 
which the growth rate is to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, 
in terms of values <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will be 
taken as the observation at the end of the interval for which 
the growth rate is to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to <code>response</code>.<code>suffices.rates</code> to form the 
names of the columns containing the calculated the growth rates.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_sep.suffix.interval">sep.suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use in 
appending <code>suffix.inteval</code> to a growth rate. For no separator, set to 
<code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_sep.levels">sep.levels</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use when the 
levels of <code>individuals</code> are combined. This is needed to avoid 
using a <code><a href="base.html#topic+character">character</a></code> that occurs in a <code><a href="base.html#topic+factor">factor</a></code> to delimit 
levels when the levels of <code>individuals</code> are combined to 
identify subsets.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsAvg_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether <code>NA</code> values should be 
stripped before the calculation of weighted means proceeds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>AGR</code> for an interval is calculated as the weighted mean of the 
AGRs for times within the interval. The RGR is calculated as the weighted 
geometric mean of the RGRs for times within the interval; in fact the exponential is taken of the weighted means of the logs of the RGRs. The weights are 
obtained from the <code>times</code>. They are taken as the sum of half the time subintervals before and after each time, except for the end points; the end points are taken to be the subintervals at the start and end of the interval.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with the growth rates. 
The name of each column is the concatenation of (i) one of 
<code>responses</code>, (ii) one of <code>AGR</code>, <code>PGR</code> or <code>RGR</code>,
or the appropriate element of <code>suffices.rates</code>, and (iii) 
<code>suffix.interval</code>, the three components being separated by 
full stops.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+byIndv4Intvl_GRsDiff">byIndv4Intvl_GRsDiff</a></code>, <code><a href="#topic+byIndv4Intvl_WaterUse">byIndv4Intvl_WaterUse</a></code>, <code><a href="#topic+splitValueCalculate">splitValueCalculate</a></code>, <code><a href="#topic+getTimesSubset">getTimesSubset</a></code>, <br /> 
<code><a href="#topic+GrowthRates">GrowthRates</a></code>, <code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code>, <code><a href="#topic+splitContGRdiff">splitContGRdiff</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- byIndv4Times_SplinesGRs(data = longi.dat, 
                                     response="PSA", response.smoothed = "sPSA", 
                                     individuals = "Snapshot.ID.Tag", 
                                     times = "DAP", 
                                     df = 4, 
                                     rates.method = "deriv", 
                                     which.rates = c("AGR", "RGR"), 
                                     suffices.rates = c("AGRdv", "RGRdv"))
sPSA.GR &lt;- byIndv4Intvl_GRsAvg(data = longi.dat, 
                               response="sPSA", times = "DAP", 
                               which.rates = c("AGR","RGR"), 
                               suffices.rates = c("AGRdv","RGRdv"), 
                               start.time = 31, end.time = 35, 
                               suffix.interval = "31to35")
</code></pre>

<hr>
<h2 id='byIndv4Intvl_GRsDiff'>Calculates the growth rates for a specified time interval for individuals 
in a <code>data.frame</code> in long format by differencing the values for 
a response within the interval.</h2><span id='topic+byIndv4Intvl_GRsDiff'></span>

<h3>Description</h3>

<p>Using the values of the responses, calculates the specified 
combination of the Absolute Growth Rates 
using differences (AGR), the Proportionate Growth Rates (PGR) 
and Relative Growth Rates using log differences (RGR) between 
two nominated time points.</p>


<h3>Usage</h3>

<pre><code class='language-R'>byIndv4Intvl_GRsDiff(data, responses, 
                     individuals = "Snapshot.ID.Tag", times = "DAP", 
                     which.rates = c("AGR","PGR","RGR"), 
                     suffices.rates=NULL, sep.rates = ".", 
                     start.time, end.time, 
                     suffix.interval, sep.suffix.interval = ".")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> from which the growth rates are to be  calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used in calculating growth rates and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_which.rates">which.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the growth rates that are 
to be calculated. It should be a combination of one or more of 
<code>"AGR"</code>, <code>"PGR"</code> and <code>"RGR"</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_suffices.rates">suffices.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the responses in constructing the 
names of the columns containing the calculated growth rates.            
The order of the suffices in <code>suffices.rates</code> should 
correspond to the order of the elements of 
<code>which.rates</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_sep.rates">sep.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be used 
to separate the <code>suffices.rates</code> value from a <code>response</code> 
value in constructing the name for a new rate. For no separator, 
set to <code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times,
in terms of values in <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will 
be taken as the observation at the start of the interval for 
which the growth rate is to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, 
in terms of values <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will be 
taken as the observation at the end of the interval for which 
the growth rate is to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to <code>response</code> to form the names of the columns 
containing the calculated the growth rates.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_GRsDiff_+3A_sep.suffix.interval">sep.suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use in 
appending <code>suffix.inteval</code> to a growth rate. For no separator, set to 
<code>""</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>AGR</code> is calculated as the difference between the values of 
<code>response</code> at the <code>end.time</code>  and <code>start.time</code> divided by the 
difference between <code>end.time</code>  and <code>start.time</code>. 
The PGR is calculated as the ratio of <code>response</code> at the <code>end.time</code> 
to that at <code>start.time</code> and the ratio raised to the power of the 
reciprocal of the difference between <code>end.time</code>  and <code>start.time</code>. 
The <code>RGR</code> is calculated as the <code>log</code> of the PGR and so is equal to 
the difference between the logarithms of <code>response</code> 
at the <code>end.time</code>  and <code>start.time</code> divided by the difference 
between <code>end.time</code>  and <code>start.time</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with the growth rates. 
The name of each column is the concatenation of (i) one of 
<code>responses</code>, (ii) one of <code>AGR</code>, <code>PGR</code> or <code>RGR</code>,
or the appropriate element of <code>suffices.rates</code>, and (iii) 
<code>suffix.interval</code>, the three components being separated by 
full stops.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+byIndv4Intvl_GRsAvg">byIndv4Intvl_GRsAvg</a></code>, <code><a href="#topic+byIndv4Intvl_WaterUse">byIndv4Intvl_WaterUse</a></code>,  <code><a href="#topic+getTimesSubset">getTimesSubset</a></code>, <code><a href="#topic+GrowthRates">GrowthRates</a></code>, <br />
<code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code>, <code><a href="#topic+splitContGRdiff">splitContGRdiff</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
sPSA.GR &lt;- byIndv4Intvl_GRsDiff(data = longi.dat, 
                                responses = "sPSA", times = "DAP", 
                                which.rates = c("AGR","RGR"), 
                                start.time = 31, end.time = 35,
                                suffix.interval = "31to35")
</code></pre>

<hr>
<h2 id='byIndv4Intvl_ValueCalc'>Calculates a single value that is a <code>function</code> of the values of 
an individual for a response in a <code>data.frame</code> in long format 
over a specified time interval.</h2><span id='topic+byIndv4Intvl_ValueCalc'></span>

<h3>Description</h3>

<p>Splits the values of a response into subsets corresponding 
individuals and applies a function that calculates a single 
value from each individual's observations during a specified 
time interval.  It includes the ability to calculate the 
observation number that is closest to the calculated value of 
the function and the assocated values of a <code><a href="base.html#topic+factor">factor</a></code> or 
<code>numeric</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>byIndv4Intvl_ValueCalc(data, response, 
                       individuals = "Snapshot.ID.Tag", times = "DAP", 
                       FUN = "max", which.obs = FALSE, which.values = NULL, 
                       addFUN2name = TRUE, sep.FUNname = ".", 
                       start.time=NULL, end.time=NULL, 
                       suffix.interval=NULL, sep.suffix.interval = ".", 
                       sep.levels=".", weights=NULL, na.rm=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
function is to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> from which the values of <code>FUN</code> are to be  calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used in calculating growth rates and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_fun">FUN</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the <code>function</code> 
that calculates the value for each subset.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_which.obs">which.obs</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to determine 
the observation number corresponding to the observed value that is 
closest to the value of the function, in addition to the value of 
the function itself. That is, <code>FUN</code> need not return an observed 
value of the <code>reponse</code>, e.g. <code>quantile</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_which.values">which.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+numeric">numeric</a></code> whose values are 
associated with the <code>response</code> values and whose value is to be 
returned for the observation number whose <code>response</code> value 
corresponds to the observed value closest to the value of the 
function. That is, <code>FUN</code> need not return an observed value of 
the <code>reponse</code>, e.g. <code>quantile</code>. In the case of multiple 
observed response values satisfying this condition, the value of 
the <code>which.values</code> vector for the first of these is 
returned.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_addfun2name">addFUN2name</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> that, if <code>TRUE</code>, indicates that 
the <code>FUN</code> name is to be added to the names of the columns in 
the <code><a href="base.html#topic+data.frame">data.frame</a></code> returned by <code>byIndv4Intvl_ValueCalc</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_sep.funname">sep.FUNname</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be used 
to separate the name of <code>FUN</code> from the <code>response</code> 
value in constructing the name for a new response. For no separator, 
set to <code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, 
in terms of levels of <code>times.factor</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will 
be taken as the observation at the start of the interval for 
which a value is to be calculated. If 
<code>start.time</code> is <code>NULL</code>, the interval will start 
with the first observation. In the case of multiple 
observed response values satisfying this condition, the first is 
returned.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times,
in terms of levels of <code>times.factor</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will be 
taken as the observation at the end of the interval for which 
a value is to be calculated. If <code>end.time</code> is 
<code>NULL</code>, the interval will end with the last observation.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to <code>response</code> to form the 
name of the column containing the calculated values. If it is
<code>NULL</code> then nothing will be appended.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_sep.suffix.interval">sep.suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use in 
appending <code>suffix.inteval</code> to a growth rate. For no separator, set to 
<code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_sep.levels">sep.levels</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use when the 
levels of <code>individuals</code> are combined. This is needed to avoid 
using a <code><a href="base.html#topic+character">character</a></code> that occurs in a <code><a href="base.html#topic+factor">factor</a></code> to delimit 
levels when the levels of <code>individuals</code> are combined to 
identify subsets.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_weights">weights</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the weights to be supplied as <code>w</code> 
to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code>  indicating whether <code>NA</code> values 
should be stripped before the calculation proceeds.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_ValueCalc_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>, with the same number of rows as there are 
<code>individuals</code>, containing a column for the <code>individuals</code> and 
a column with the values of the function for the <code>individuals</code>. 
It is also possible to determine observaton numbers or the values of 
another column in <code>data</code> for the <code>response</code> values that are 
closest to the <code>FUN</code> results, using either or both of 
<code>which.obs</code> and <code>which.values</code>. If <code>which.obs</code> is 
<code>TRUE</code>, a column with observation numbers is included in the  
<code><a href="base.html#topic+data.frame">data.frame</a></code>. 
If <code>which.values</code> is set to the name of a <code><a href="base.html#topic+factor">factor</a></code> or 
a <code><a href="base.html#topic+numeric">numeric</a></code>, a column containing the levels of that 
<code><a href="base.html#topic+factor">factor</a></code> or the values of that <code><a href="base.html#topic+numeric">numeric</a></code> is 
included in the  <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>
<p>The name of the column with the values of the function will be result of 
concatenating the <code>response</code>, <code>FUN</code> and, if it is not 
<code>NULL</code>, <code>suffix.interval</code>, each separated by a full stop. 
If <code>which.obs</code> is <code>TRUE</code>, the column name for the obervations 
numbers will have <code>.obs</code> added after <code>FUN</code> into the column name 
for the function values; if <code>which.values</code> is specified, 
the column name for these values will have a full stop followed by 
<code>which.values</code> added after <code>FUN</code> into the column name 
for the function values.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+byIndv4Intvl_GRsAvg">byIndv4Intvl_GRsAvg</a></code>, <code><a href="#topic+byIndv4Intvl_GRsDiff">byIndv4Intvl_GRsDiff</a></code>, 
<code><a href="#topic+byIndv4Intvl_WaterUse">byIndv4Intvl_WaterUse</a></code>, <code><a href="#topic+splitValueCalculate">splitValueCalculate</a></code>, <br /> 
<code><a href="#topic+getTimesSubset">getTimesSubset</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
sPSA.max &lt;- byIndv4Intvl_ValueCalc(data = longi.dat, 
                                   response = "sPSA", times = "DAP", 
                                   start.time = 31, end.time = 35, 
                                   suffix.interval = "31to35")
AGR.max.dat &lt;- byIndv4Intvl_ValueCalc(data = longi.dat, 
                                      response = "sPSA", times = "DAP", 
                                      FUN="max", 
                                      start.time = 31, end.time = 35, 
                                      suffix.interval = "31to35",
                                      which.values = "DAP", 
                                      which.obs = TRUE)
</code></pre>

<hr>
<h2 id='byIndv4Intvl_WaterUse'>Calculates, water use traits (WU, WUR, WUI) over a specified time interval 
for each individual in a <code>data.frame</code> in long format.</h2><span id='topic+byIndv4Intvl_WaterUse'></span>

<h3>Description</h3>

<p>Calculates one or more of water use (WU), water use rate (WUR), and, 
for a set of responses,  water use indices (WUI)s over a specified time 
interval for each individual in a <code>data.frame</code> in long format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>byIndv4Intvl_WaterUse(data, water.use = "Water.Use", responses = NULL, 
                      individuals = "Snapshot.ID.Tag", times = "DAP", 
                      trait.types = c("WU", "WUR", "WUI"), 
                      suffix.rate = "R", suffix.index = "I", 
                      sep.water.traits = "", sep.responses = ".", 
                      start.time, end.time, 
                      suffix.interval = NULL, sep.suffix.interval = ".", 
                      na.rm = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
water use traits are to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_water.use">water.use</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the column in 
<code>data</code> that contains the water use values.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> for which <code>WUI</code>s are to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used identifying the intervals and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_trait.types">trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> listing the trait types to compute
and return. It should be some combination of <code>WU</code>, <code>WUR</code> 
and <code>WUI</code>, or be <code>all</code>. See Details for how each 
is calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_suffix.rate">suffix.rate</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the label to be appended 
to the value of <code>water.use</code> to form the name of the WUR.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_suffix.index">suffix.index</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the label to be appended 
to the value of <code>water.use</code> to form the name of the WUI.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_sep.water.traits">sep.water.traits</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be 
used to separate the <code>suffix.rate</code> and <code>suffix.index</code> values 
from the <code>responses</code> values in constructing the name for a new 
rate/index. The default of <code>""</code> results in no separator.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_sep.responses">sep.responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be used 
to separate the <code>suffix.rate</code> value from a<code>responses</code> 
value in constructing the name for a new index. For no separator, 
set to <code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times,
in terms of values in <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will 
be taken as the observation at the start of the interval for 
which the WUI is to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, 
in terms of values <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will be 
taken as the observation at the end of the interval for which 
the WUI is to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to the names of the columns for the water use traits to 
indicate the interval for which the  traits have been calculated .</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_sep.suffix.interval">sep.suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use in 
appending <code>suffix.inteval</code> to a growth rate. For no separator, set to 
<code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Intvl_WaterUse_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code>  indicating whether <code>NA</code> values 
should be stripped before the calculation proceeds.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code>WU</code></dt><dd><p> is the water use and is the sum of the water use after <code>start.time</code> 
until <code>end.time</code>. Thus, the water use up to <code>start.time</code> is not included.</p>
</dd> 
<dt><code>WUR</code></dt><dd><p> is the Water Use Rate and is <code>WU</code> divided by the difference 
between <code>end.time</code> and <code>start.time</code>.</p>
</dd>
<dt><code>WUI</code></dt><dd><p> is the Water Use Index and is calculated as a <code>response</code> difference 
between the start.time and the end.time, which s then divided by the <code>WU</code>.</p>
</dd>
</dl>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the <code>individuals</code> column, <code>WU</code> 
and/or <code>WUR</code> and, if requested, a <code>WUI</code> for each 
element of <code>responses</code>. The names of <code>WU</code> and <code>WUR</code> will have 
<code>suffix.interval</code> appended, if it is not <code>NULL</code>, separated by a 
full stop (&lsquo;.&rsquo;). The name of each <code>WUI</code> will be the concatenation of an 
element of <code>responses</code> with <code>WUI</code> and, if not <code>NULL</code>, 
<code>suffix.interval</code>, the three components being separated by a 
full stop (&lsquo;.&rsquo;).</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+byIndv4Intvl_GRsAvg">byIndv4Intvl_GRsAvg</a></code>, <code><a href="#topic+byIndv4Intvl_GRsDiff">byIndv4Intvl_GRsDiff</a></code>, 
<code><a href="#topic+splitValueCalculate">splitValueCalculate</a></code>, <code><a href="#topic+getTimesSubset">getTimesSubset</a></code>, <br />
<code><a href="#topic+GrowthRates">GrowthRates</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
WU.WUI_31_35 &lt;- byIndv4Intvl_WaterUse(data = longi.dat, 
                                      water.use = "WU", responses = "PSA", 
                                      times = "DAP", 
                                      trait.types = c("WUR","WUI"), 
                                      suffix.rate = ".Rate", 
                                      suffix.index = ".Index",
                                      start.time = 31, end.time = 35, 
                                      suffix.interval = "31to35")
</code></pre>

<hr>
<h2 id='byIndv4Times_GRsDiff'>Adds, to a <code>data.frame</code>, the growth rates calculated for consecutive times 
for individuals in a <code>data.frame</code> in long format by differencing 
response values.</h2><span id='topic+byIndv4Times_GRsDiff'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+AGRdiff">AGRdiff</a></code>, <code><a href="#topic+PGR">PGR</a></code> and 
<code><a href="#topic+RGRdiff">RGRdiff</a></code> to calculate growth rates continuously 
over time for the <code>response</code> by differencing pairs of pairs 
of <code>response</code> values  and 
stores the results in <code>data</code>. The subsets are those values 
with the same levels combinations of the <code><a href="base.html#topic+factor">factor</a></code>s listed in 
<code>individuals</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>byIndv4Times_GRsDiff(data, responses, 
                     individuals = "Snapshot.ID.Tag", times = "DAP", 
                     which.rates = c("AGR","PGR","RGR"), 
                     suffices.rates=NULL, sep.rates = ".", 
                     avail.times.diffs = FALSE, ntimes2span = 2)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns for which 
growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> for which growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name(s) of the 
<code><a href="base.html#topic+factor">factor</a></code>(s) that define the subsets of <code>response</code> 
that correspond to the <code>response</code> values for an individual 
(e.g. plant, pot, cart, plot or unit) for which growth rates are 
to be calculated continuously. If the columns corresponding to 
<code>individuals</code> are not <code><a href="base.html#topic+factor">factor</a></code>(s) then they will 
be coerced to <code><a href="base.html#topic+factor">factor</a></code>(s). The subsets are formed using 
<code><a href="base.html#topic+split">split</a></code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, 
or <code><a href="base.html#topic+character">character</a></code>. It will be used in calculating the 
growth rates. If a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, 
the values should be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_which.rates">which.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the growth rates that are 
to be calculated. It should be a combination of one or more of 
<code>"AGR"</code>, <code>"PGR"</code> and <code>"RGR"</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_suffices.rates">suffices.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the responses to provide the names of the 
columns containing the calculated growth rates. The order of the 
suffices in <code>suffices.rates</code> should correspond to the order 
of the elements of <code>which.rates</code>. If <code>NULL</code>, the values 
of <code>which.rates</code> are used.</p>
</td></tr>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_sep.rates">sep.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be used 
to separate the <code>suffices.rates</code> value from a <code>response</code> 
value in constructing the name for a new rate. For no separator, 
set to <code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_avail.times.diffs">avail.times.diffs</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether there is an 
appropriate column of <code>times</code> diffserences that can be used as 
the denominator in computing the growth rates. If <code>TRUE</code>, it will 
be assumed that the name of the column is the value of  <code>times</code> 
with <code>.diffs</code> appended. If <code>FALSE</code>, a column, whose 
column name will be the value of <code>times</code> with <code>.diffs</code> 
appended, will be formed and saved in the result, overwriting any 
existing columns with the constructed name in <code>data</code>. It will 
be calculated using the values of times in <code>data</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_GRsDiff_+3A_ntimes2span">ntimes2span</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of values in 
<code>times</code> to span in calculating growth rates by differencing. 
Each growth rate is calculated as the difference in the values of 
one of the <code>responses</code> for pairs of <code>times</code> values that 
are spanned by <code>ntimes2span</code> <code>times</code> values divided by 
the difference between this pair of <code>times</code> values. For 
<code>ntimes2span</code> set to 2, a growth rate is the  
difference between consecutive pairs of values of one of the 
<code>responses</code> divided by the difference between consecutive 
pairs of <code>times</code> values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing  <code>data</code> to which has been 
added i) a column for the differences between the <code>times</code>, 
if it is not already in <code>data</code>, and (ii) columns with growth rates. 
The name of the column for <code>times</code> differences will be the value 
of <code>times</code> with <code>".diffs"</code> appended. The name for each of 
the growth-rate columns will be either the value of <code>response</code> 
with one of <code>".AGR"</code>, <code>".PGR"</code> or <code>"RGR"</code>, or the 
corresponding value from <code>suffices.rates</code> appended. Each growth 
rate will be positioned at observation 
<code>ceiling(ntimes2span + 1) / 2</code> relative to the two times from 
which the growth rate is calculated.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+smoothSpline">smoothSpline</a></code>, <code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- byIndv4Times_GRsDiff(data = longi.dat, 
                                  response = "sPSA", 
                                  individuals = "Snapshot.ID.Tag", 
                                  times = "DAP", 
                                  which.rates=c("AGR", "RGR"), 
                                  avail.times.diffs = TRUE)
</code></pre>

<hr>
<h2 id='byIndv4Times_SplinesGRs'>For a response in a <code>data.frame</code> in long format, computes, 
for a single set of smoothing parameters, smooths of the 
response, possibly along with growth rates calculated from the 
smooths.</h2><span id='topic+byIndv4Times_SplinesGRs'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+smoothSpline">smoothSpline</a></code> to fit a spline to the values 
of <code>response</code> for each <code>individual</code> and stores the fitted 
values in <code>data</code>. The degree of smoothing is controlled by the 
tuning parameters <code>df</code> and <code>lambda</code>, related to the 
penalty, and by <code>npspline.segments</code>. The <code>smoothing.method</code> 
provides for <code>direct</code> and <code>logarithmic</code> smoothing. 
</p>
<p>The Absolute and Relative Growth Rates ( AGR and RGR) can be computed 
either using the first derivatives of the splines or by differencing 
the smooths. If using the first derivative to obtain growth rates, 
<code>correctBoundaries</code> must be <code>FALSE</code>. Derivatives other than the 
first derivative can also be produced. The function 
<code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code> is used to obtain growth rates by 
differencing.
</p>
<p>The handling of missing values in the observations is controlled via 
<code>na.x.action</code> and <code>na.y.action</code>. If there are not 
at least four distinct, nonmissing x-values, a warning is issued and 
all smoothed values and derivatives are set to <code>NA</code>. 
</p>
<p>The function <code><a href="#topic+probeSmoothing">probeSmoothing</a></code> can be used to investgate the effect 
the smoothing parameters <br /> (<code>smoothing.method</code>, <code>df</code> or  
<code>lambda</code>) on the smooth that results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>byIndv4Times_SplinesGRs(data, response, response.smoothed = NULL, 
                        individuals = "Snapshot.ID.Tag", times, 
                        smoothing.method = "direct", smoothing.segments = NULL, 
                        spline.type = "NCSS", df=NULL, lambda = NULL, 
                        npspline.segments = NULL, 
                        correctBoundaries = FALSE, 
                        rates.method = "differences", 
                        which.rates = c("AGR","RGR"), 
                        suffices.rates = NULL, sep.rates = ".", 
                        avail.times.diffs = FALSE, ntimes2span = 2, 
                        extra.derivs = NULL, suffices.extra.derivs=NULL, 
                        sep.levels = ".", 
                        na.x.action="exclude", na.y.action = "trimx", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column to be smoothed.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> that is to be smoothed.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code>. If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name(s) of the 
<code><a href="base.html#topic+factor">factor</a></code>(s) that define the subsets of <code>response</code> 
that correspond to the <code>response</code> values for an individual 
(e.g. plant, pot, cart, plot or unit) that are to be smoothed 
separately. If the columns corresponding to <code>individuals</code> are 
not <code><a href="base.html#topic+factor">factor</a></code>(s) then they will be coerced to 
<code><a href="base.html#topic+factor">factor</a></code>(s). The subsets are formed 
using <code><a href="base.html#topic+split">split</a></code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used as the values of the predictor 
variable to be supplied to <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> and in 
calculating growth rates. If a <code><a href="base.html#topic+factor">factor</a></code> or 
<code><a href="base.html#topic+character">character</a></code>, the values should be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_smoothing.method">smoothing.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the smoothing method 
to use. The two possibilites are (i) <code>"direct"</code>, for directly 
smoothing the observed <code>response</code>, and (ii) <code>"logarithmic"</code>, for 
smoothing the <code>log</code>-transformed <code>response</code> and then 
back-transforming by taking the exponentional of the fitted values.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_smoothing.segments">smoothing.segments</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code>, each of whose components 
is a numeric pair specifying the first and last values of an 
<code>times</code>-interval whose data is to be subjected as an entity to smoothing 
using splines. The separate smooths will be combined to form a whole 
smooth for each individual. If <code>get.rates</code> is <code>TRUE</code>, 
<code>rates.method</code> is <code>differences</code> and <code>ntimes2span</code> is 2, 
the smoothed growth rates will be computed over the set of segments; 
otherwise, they will be computed within segments. 
If <code>smoothing.segments</code> is <code>NULL</code>, the data is not 
segmented for smoothing.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_spline.type">spline.type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the type of spline  
to use. Currently, the possibilites are (i) <code>"NCSS"</code>, for natural 
cubic smoothing splines, and (ii) <code>"PS"</code>, for P-splines.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_df">df</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for natural cubic smoothing splines 
(<code>NCSS</code>), the desired equivalent number of degrees of freedom of the 
smooth (trace of the smoother matrix). Lower values result in more smoothing. 
If <code>df = NULL</code>, the amount of smoothing can be controlled by setting 
<code>lambda</code>. If both <code>df</code> and <code>lambda</code> are <code>NULL</code>, smoothing 
is controlled by the default arguments for <code>smooth.spline</code>, and any 
that you supply via the ellipsis (...) argument.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_lambda">lambda</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the positive penalty to apply. 
The amount of smoothing decreases as <code>lamda</code> decreases.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_npspline.segments">npspline.segments</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for P-splines (<code>PS</code>), 
the number of equally spaced segments between <code>min(times)</code> and <code>max(times)</code>, 
excluding missing values, to use in constructing the B-spline basis for the 
spline fitting. If <code>npspline.segments</code> is NULL, <code>npspline.segments</code> 
is set to the maximum of 10 and <code>ceiling((nrow(data)-1)/2)</code> i.e. there will 
be at least 10 segments and, for more than 22 <code>times</code> values, there will be 
half as many segments as there are <code>times</code> values. The amount of smoothing 
decreases as <code>npspline.segments</code> increases. When the data has been 
segmented for smoothing (<code>smoothing.segments</code> is not <code>NULL</code>), 
an <code>npspline.segments</code> value can be supplied for each segment.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_correctboundaries">correctBoundaries</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether the fitted spline 
values are to have the method of Huang (2001) applied 
to them to correct for estimation bias at the end-points. Note that 
<code>spline.type</code> must be <code>NCSS</code> and <code>lambda</code> and <code>deriv</code> 
must be <code>NULL</code> for <code>correctBoundaries</code> to be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_rates.method">rates.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the method to use in 
calculating the growth rates. The possibilities are 
<code>none</code>, <code>differences</code> and <code>derivatives</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_which.rates">which.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the growth rates that are 
to be calculated. It should be a combination of one or more of 
<code>"AGR"</code>, <code>"PGR"</code> and <code>"RGR"</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_suffices.rates">suffices.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the responses to provide the names of the 
columns containing the calculated growth rates. The order of the 
suffices in <code>suffices.rates</code> should correspond to the order 
of the elements of <code>which.rates</code>. If <code>NULL</code>, the values 
of <code>which.rates</code> are used.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_sep.rates">sep.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be used 
to separate the <code>suffices.rates</code> value from a <code>response</code> 
value in constructing the name for a new rate. For no separator, 
set to <code>""</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_avail.times.diffs">avail.times.diffs</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether there is an 
appropriate column of <code>times</code> diffserences that can be used as 
the denominator in computing the growth rates. If <code>TRUE</code>, it will 
be assumed that the name of the column is the value of  <code>times</code> 
with <code>.diffs</code> appended. If <code>FALSE</code>, a column, whose 
column name will be the value of <code>times</code> with <code>.diffs</code> 
appended, will be formed and saved in the result, overwriting any 
existing columns with the constructed name in <code>data</code>. It will 
be calculated using the values of times in <code>data</code>.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_ntimes2span">ntimes2span</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of values in 
<code>times</code> to span in calculating growth rates by differencing. 
Each growth rate is calculated as the difference in the values of 
one of the <code>responses</code> for pairs of <code>times</code> values that 
are spanned by <code>ntimes2span</code> <code>times</code> values divided by 
the difference between this pair of <code>times</code> values. For 
<code>ntimes2span</code> set to 2, a growth rate is the  
difference between consecutive pairs of values of one of the 
<code>responses</code> divided by the difference between consecutive 
pairs of <code>times</code> values.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_extra.derivs">extra.derivs</code></td>
<td>
<p>A <code>numeric</code> specifying one or more orders of derivatives 
that are required, in addition to any required for calculating the growth 
rates. When <code>rates.method</code> is <code>derivatives</code>, these can be 
derivatives other than the first. Otherwise, any derivatives can be 
specified.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_suffices.extra.derivs">suffices.extra.derivs</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to <code>response.method</code> to construct the names of the derivatives. 
If <code>NULL</code> and the derivatives are to be retained, then <code>.dv</code> 
followed by the order of the derivative is appended to 
<code>response.method</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_sep.levels">sep.levels</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use when the 
levels of <code>individuals</code> are combined. This is needed to avoid 
using a <code><a href="base.html#topic+character">character</a></code> that occurs in a <code><a href="base.html#topic+factor">factor</a></code> to delimit 
levels when the levels of <code>individuals</code> are combined to identify 
subsets.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_na.x.action">na.x.action</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string that specifies the action to 
be taken when values of <code>x</code>, or the <code>times</code>, are <code>NA</code>. 
The possible values are <code>fail</code>, <code>exclude</code> or <code>omit</code>. 
For <code>exclude</code> and <code>omit</code>, predictions and derivatives 
will only be obtained for nonmissing values of <code>x</code>. 
The difference between these two codes is that for <code>exclude</code> the returned 
<code>data.frame</code> will have as many rows as <code>data</code>, the 
missing values have been incorporated. </p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_na.y.action">na.y.action</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string that specifies the action to 
be taken when values of <code>y</code>, or the <code>response</code>, are 
<code>NA</code>.  The possible values are <code>fail</code>, <code>exclude</code>, 
<code>omit</code>, <code>allx</code>, <code>trimx</code>, <code>ltrimx</code> or 
<code>rtrimx</code>. For  all options, except <code>fail</code>, missing 
values in <code>y</code> will be removed before smoothing. 
For <code>exclude</code> and <code>omit</code>, predictions 
and derivatives will be obtained only for nonmissing values of 
<code>x</code> that do not have missing <code>y</code> values. Again, the 
difference between these two is that, only for <code>exclude</code> 
will the missing values be incorporated into the 
returned <code>data.frame</code>. For <code>allx</code>, predictions and 
derivatives will be obtained for all nonmissing <code>x</code>. 
For <code>trimx</code>, they will be obtained for all nonmissing 
<code>x</code> between the first and last nonmissing <code>y</code> values 
that have been ordered for <code>x</code>; for <code>ltrimx</code> and 
<code>utrimx</code> either the lower or upper missing <code>y</code> 
values, respectively, are trimmed.</p>
</td></tr>
<tr><td><code id="byIndv4Times_SplinesGRs_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code>smooth.spline</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing  <code>data</code> to which has been 
added a column with the fitted smooth, the name of the column being 
the value of <code>response.smoothed</code>. If <code>rates.method</code> is 
not <code>none</code>, columns for the growth rates listed in 
<code>which.rates</code> will be added to <code>data</code>; the names each of 
these columns will be the value of <code>response.smoothed</code> with 
the elements of <code>which.rates</code> appended. 
</p>
<p>When <code>rates.method</code> is <code>derivatives</code> and 
<code>smoothing.method</code> is <code>direct</code>, the <code>AGR</code> is obtained 
from the first derivative of the spline for each value of <code>times</code> 
and the <code>RGR</code> is calculated as the <code>AGR</code> divided by the 
value of the <code>response.smoothed</code> for the corresponding time. 
When <code>rates.method</code> is <code>derivatives</code> and 
<code>smoothing.method</code> is <code>logarithmic</code>, the <code>RGR</code> is 
obtained from the first derivative of the spline and the <code>AGR</code> 
is calculated as the <code>RGR</code> multiplied by the corresponding 
value of the <code>response.smoothed</code>.
</p>
<p>If <code>extra.derivs</code> is not <code>NULL</code>, the values for the 
nominated derivatives will also be added to <code>data</code>; the names 
each of these columns will be the value of <code>response.smoothed</code> 
with <code>.dvf</code> appended, where <code>f</code> is the order of the 
derivative, or  the value of <code>response.smoothed</code> 
with the corresponding element of <code>suffices.deriv</code> appended. 
</p>
<p>Any pre-existing smoothed and growth rate columns in <code>data</code> will be 
replaced. The ordering of the <code>data.frame</code> for the <code>times</code> 
values will be preserved as far as is possible; the main difficulty 
is with the handling of missing values by the function <code>merge</code>. 
Thus, if missing values in <code>times</code> are retained, they will occur at 
the bottom of each subset of <code>individuals</code> and the order will be 
problematic when there are missing values in <code>y</code> and 
<code>na.y.action</code> is set to <code>omit</code>.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Eilers, P.H.C and Marx, B.D. (2021) <em>Practical smoothing: the joys of P-splines</em>. Cambridge University Press, Cambridge.
</p>
<p>Huang, C. (2001) Boundary corrected cubic smoothing splines. <em>Journal of Statistical Computation and Simulation</em>, <b>70</b>, 107-121.</p>


<h3>See Also</h3>

<p><code><a href="#topic+smoothSpline">smoothSpline</a></code>, <code><a href="#topic+probeSmoothing">probeSmoothing</a></code>, <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>, 
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <code><a href="stats.html#topic+predict.smooth.spline">predict.smooth.spline</a></code>, <br />
<code><a href="base.html#topic+split">split</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
#smoothing with growth rates calculated using derivates
longi.dat &lt;- byIndv4Times_SplinesGRs(data = longi.dat, 
                                     response="PSA", response.smoothed = "sPSA", 
                                     times="DAP", 
                                     df = 4, rates.method = "deriv", 
                                     suffices.rates = c("AGRdv", "RGRdv"))
#Use P-splines
longi.dat &lt;- byIndv4Times_SplinesGRs(data = longi.dat, 
                                     response="PSA", response.smoothed = "sPSA", 
                                     individuals = "Snapshot.ID.Tag", times="DAP", 
                                     spline.type = "PS", lambda = 0.1, 
                                     npspline.segments = 10, 
                                     rates.method = "deriv", 
                                     suffices.rates = c("AGRdv", "RGRdv"))
#with segmented smoothing and no growth rates
longi.dat &lt;- byIndv4Times_SplinesGRs(data = longi.dat, 
                                     response="PSA", response.smoothed = "sPSA", 
                                     individuals = "Snapshot.ID.Tag", times="DAP", 
                                     smoothing.segments = list(c(28,34), c(35,42)), 
                                     df = 5, rates.method = "none")
</code></pre>

<hr>
<h2 id='calcLagged'>Replaces the values in a vector with the result of applying an operation to it 
and a lagged value</h2><span id='topic+calcLagged'></span>

<h3>Description</h3>

<p>Replaces the values in <code>x</code> with the result of applying an 
<code>operation</code> to it and the value that is <code>lag</code> positions 
either before it or after it in <code>x</code>, depending on whether 
<code>lag</code> is positive or negative. For positive <code>lag</code> 
the first <code>lag</code> values will be <code>NA</code>, while for negative 
<code>lag</code> the last <code>lag</code> values will be <code>NA</code>. 
When <code>operation</code> is <code>NULL</code>, the values are moved 
<code>lag</code> positions down the vector.</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcLagged(x, operation = NULL, lag = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcLagged_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+vector">vector</a></code> containing the values on which the calculations are to be made.</p>
</td></tr>
<tr><td><code id="calcLagged_+3A_operation">operation</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the operation to be performed on pairs of 
values in <code>x</code>. If <code>operation</code> is <code>NULL</code> then the values are moved 
<code>lag</code> positions down the vector.</p>
</td></tr>
<tr><td><code id="calcLagged_+3A_lag">lag</code></td>
<td>
<p>A <code>integer</code> specifying, for the second value in the pair to be operated on, 
the number positions it is ahead of or behind the current value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+vector">vector</a></code> containing  the result of applying <code>operation</code> to 
values in <code>x</code>. For positive <code>lag</code> the first <code>lag</code> values will 
be <code>NA</code>, while for negative <code>lag</code> the last <code>lag</code> values will be <code>NA</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="methods.html#topic+Ops">Ops</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat$DAP.diffs &lt;- calcLagged(longi.dat$xDAP, operation ="-")
</code></pre>

<hr>
<h2 id='calcTimes'>Calculates for a set of times, the time intervals after an origin time and the position of each within a time interval</h2><span id='topic+calcTimes'></span>

<h3>Description</h3>

<p>For the column specified in imageTimes, having converted it to <code>POSIXct</code> if not already converted, calculates for each value the number of <code>intervalUnits</code> between the time and the <code>startTime</code>. Then the number of <code>timePositions</code> within the <code>intervals</code> is calculated for the values in <code>imageTimes</code>. The function <code>difftimes</code> is used in doing the calculations, but the results are converted to <code>numeric</code>. For example <code>intervals</code> could correspond to the number of Days after Planting (DAP) and the <code>timePositions</code> to the hour within each day.</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcTimes(data, imageTimes = NULL, timeFormat = "%Y-%m-%d %H:%M",
          intervals = "Time.after.Planting..d.", startTime = NULL, 
          intervalUnit = "days", timePositions = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calcTimes_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing any columns specified by 
<code>imageTimes</code>, <code>intervals</code> and <code>timePositions</code>.</p>
</td></tr>
<tr><td><code id="calcTimes_+3A_imagetimes">imageTimes</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that contains
the time that each cart was imaged. Note that in importing data into R, spaces 
and nonalphanumeric characters in names are converted to full stops. 
If <code>imageTimes</code> is <code>NULL</code> then no calculations are done.</p>
</td></tr>
<tr><td><code id="calcTimes_+3A_timeformat">timeFormat</code></td>
<td>
<p>A <code>character</code> giving the <code>POSIXct</code> format of characters 
containing times, in particular <code>imageTimes</code> and <code>startTime</code>. 
Note that if fractions of seconds are required <code>options(digits.secs)</code> 
must be used to set the number of decimal places and <code>timeFormat</code> must 
use <code>%OS</code> for seconds in <code>timeFormat</code>.</p>
</td></tr> 
<tr><td><code id="calcTimes_+3A_intervals">intervals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in <code>data</code>
containing, as a <code><a href="base.html#topic+numeric">numeric</a></code> or a <code><a href="base.html#topic+factor">factor</a></code>, 
the calculated times after <code>startTime</code> to be 
plotted on the x-axis.  It is given as the number 
of <code>intervalUnits</code> between the two times. If <code>startTime</code> is 
<code>NULL</code> then <code>intervals</code> is not calculated.</p>
</td></tr>
<tr><td><code id="calcTimes_+3A_starttime">startTime</code></td>
<td>
<p>A <code>character</code> giving the time, in the <code>POSIXct</code> 
format specified by <code>timeFormat</code>, to be subtracted from 
<code>imageTimes</code> to caclualte <code>intervals</code>. For example, it might be the 
day of planting or treatment. If <code>startTime</code> is 
<code>NULL</code> then <code>intervals</code> is not calculated.</p>
</td></tr> 
<tr><td><code id="calcTimes_+3A_intervalunit">intervalUnit</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the unit in which 
the values of the intervals should be expressed. It must be one of <code>"secs"</code>, 
<code>"mins"</code>, <code>"hours"</code> or <code>"days"</code>.</p>
</td></tr>  
<tr><td><code id="calcTimes_+3A_timepositions">timePositions</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of  the column in 
<code>data</code> containing, as a <code><a href="base.html#topic+numeric">numeric</a></code>, the value of the 
time position within an interval (for example, the time of imaging during the day 
expressed in hours plus a fraction of an hour). If <code>timePositions</code> 
is <code>NULL</code> then it is not calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code>, being the unchaged data <code>data.frame</code> when 
<code>imageTimes</code> is <code>NULL</code> or containing 
either intervals and/or timePositions depending on which is not <code>NULL</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>, <code><a href="#topic+imagetimesPlot">imagetimesPlot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(exampleData)
  raw.dat &lt;- calcTimes(data = raw.dat, 
                       imageTimes = "Snapshot.Time.Stamp", timePositions = "Hour")
</code></pre>

<hr>
<h2 id='cumulate'>Calculates the cumulative sum, ignoring the first element if exclude.1st is TRUE</h2><span id='topic+cumulate'></span>

<h3>Description</h3>

<p>Uses <code>cumsum</code> to calculate the cumulative sum, ignoring the first element 
if exclude.1st is <code>TRUE</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumulate(x, exclude.1st = FALSE, na.rm = FALSE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumulate_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+vector">vector</a></code> containing the values to be cumulated.</p>
</td></tr>
<tr><td><code id="cumulate_+3A_exclude.1st">exclude.1st</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not the first value of 
the cumulative sum is to be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="cumulate_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether <code>NA</code> values should be 
stripped before the computation proceeds</p>
</td></tr>
<tr><td><code id="cumulate_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+vector">vector</a></code> containing  the cumulative sum.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+cumsum">cumsum</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
PSA.cum &lt;- cumulate(longi.dat$PSA)
</code></pre>

<hr>
<h2 id='designFactors'>Adds the factors and covariates for a blocked, split-unit design</h2><span id='topic+designFactors'></span>

<h3>Description</h3>

<p>Add the following  <code><a href="base.html#topic+factor">factor</a></code>s and covariates to a date frame containing imaging data from the Plant Accelerator: Zone, xZone, SHZone, ZLane, ZMainunit, Subunit and xMainPosn. It checks that the numbers of levels of the <code><a href="base.html#topic+factor">factor</a></code>s are consistent with the observed numbers of carts and observations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>designFactors(data, insertName = NULL, designfactorMethod = "LanePosition", 
              nzones = 6, nlanesperzone = 4, 
              nmainunitsperlane = 11, nsubunitspermain = 2)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="designFactors_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> to which are to be added the design 
<code><a href="base.html#topic+factor">factor</a></code>s and covariates and which must contain the following columns: 
</p>
<p>Smarthouse, Snapshot.ID.Tag, xDAP, and, 
</p>
<p>if <code>designfactorMethod = "LanePosition"</code>, Lane and Position.</p>
</td></tr>
<tr><td><code id="designFactors_+3A_insertname">insertName</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column 
in the <code>data.frame</code> after which the new <code><a href="base.html#topic+factor">factor</a></code>s 
and covariates are to be inserted. If <code>NULL</code>, they are added 
after the last column.</p>
</td></tr> 
<tr><td><code id="designFactors_+3A_designfactormethod">designfactorMethod</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the method to 
use to obtain the columns for the design <code><a href="base.html#topic+factor">factor</a></code>s Zone, 
ZLane, Mainunit and Subunit. For <code>LanePosition</code>, it is assumed 
that (i) Lane can be divided into Zone and ZLane, each with nzones 
and nlanesperzone levels, respectively, and (ii) Position can be 
divided into Mainunit and Subunit, each with nmainunitsperlane and 
nmainunitsperlane levels, respectively. The <code><a href="base.html#topic+factor">factor</a></code> 
SHZone is formed by combining Smarthouse and Zone and ZMainunit 
is formed by combining ZLane and Mainunit. For <code>StandardOrder</code>, 
the <code><a href="base.html#topic+factor">factor</a></code>s Zone, ZLane, Mainunit, Subunit are 
generated in standard order, with the levels of Subunit changing for 
every observation and the levels of subsequent changing only after all 
combinations of the levels of the <code><a href="base.html#topic+factor">factor</a></code>s to its right 
have been cycled through.</p>
</td></tr> 
<tr><td><code id="designFactors_+3A_nzones">nzones</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of zones in a smarthouse.</p>
</td></tr>
<tr><td><code id="designFactors_+3A_nlanesperzone">nlanesperzone</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of lanes in each zone.</p>
</td></tr>
<tr><td><code id="designFactors_+3A_nmainunitsperlane">nmainunitsperlane</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of mainunits in each lane.</p>
</td></tr>
<tr><td><code id="designFactors_+3A_nsubunitspermain">nsubunitspermain</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of subunits in a main plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="base.html#topic+factor">factor</a></code>s Zone, ZLane, ZMainunit and Subunit are derived for each Smarthouse based on the values of <code>nzones</code>, <code>nlanesperzone</code>, <code>nmainunitsperlane</code>, <code>nsubunitspermain</code>, Zone being the blocks in the split-unit design. Thus, the number of carts in each Smarthouse must be the product of these values and the number of observations must be the product of the numbers of smarthouse, carts and imagings for each cart. If this is not the case, it may be able to be achieved by including in <code>data</code> rows for extra observations that have values for the Snapshot.ID.Tag, Smarthouse, Lane, Position and Time.after.Planting..d. and the remaining columns for these rows have missing values (<code>NA</code>) Then SHZone is formed by combining Smarthouse and Zone and the covariates cZone, cMainPosn and cPosn calculated. The covariate cZone is calculated from Zone and cMainPosn is formed from the mean of cPosn for each main plot.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> including the columns:
</p>

<ol>
<li><p> Smarthouse: <code><a href="base.html#topic+factor">factor</a></code> with levels for the Smarthouse
</p>
</li>
<li><p> Zone: <code><a href="base.html#topic+factor">factor</a></code> dividing the Lanes into groups, usually of 4 lanes
</p>
</li>
<li><p> cZone: numeric corresponding to Zone, centred by subtracting the mean of the unique positions
</p>
</li>
<li><p> SHZone: <code><a href="base.html#topic+factor">factor</a></code> for the combinations of Smarthouse and Zone
</p>
</li>
<li><p> ZLane: <code><a href="base.html#topic+factor">factor</a></code> for the lanes within a Zone
</p>
</li>
<li><p> ZMainunit: <code><a href="base.html#topic+factor">factor</a></code> for the main units within a Zone
</p>
</li>
<li><p> Subunit: <code><a href="base.html#topic+factor">factor</a></code> for the subunits
</p>
</li>
<li><p> cMainPosn: numeric for the main-plot positions within a Lane, centred by subtracting the mean of the unique Positions
</p>
</li>
<li><p> cPosn: numeric for the Positions within a Lane, centred by subtracting the mean of the unique Positions</p>
</li></ol>



<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- prepImageData(data = raw.dat, smarthouse.lev = 1)
longi.dat &lt;- designFactors(data = longi.dat, insertName = "Reps",
                           nzones = 1, nlanesperzone = 1, nmainunitsperlane = 10, 
                           designfactorMethod="StandardOrder")
</code></pre>

<hr>
<h2 id='exampleData'>A small data set to use in function examples</h2><span id='topic+exampleData'></span><span id='topic+raw.dat'></span><span id='topic+longi.dat'></span><span id='topic+cart.dat'></span>

<h3>Description</h3>

<p>Imaging  data for 20 of the plants that were imaged over 14 days from an experiment in a Smarthouse in the Plant Accelerator. Producing these files is illustrated in the <code>Rice</code> vignette and the data is used as a small example in the <code>growthPheno</code> manual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exampleData)</code></pre>


<h3>Format</h3>

<p>Three <code>data.frames</code>: 
</p>

<ol>
<li> <p><code>raw.dat</code> (280 rows by 33 columns) that contains the imaging data for 20 plants by 14 imaging days as produced by the image processing software;
</p>
</li>
<li> <p><code>longi.dat</code> (280 rows by 37 columns) that contains a modified version of the imaging data for the 20 plants by 14 imaging days in <code>raw.dat</code>;
</p>
</li>
<li> <p><code>cart.dat</code> (20 rows by 14 columns) that contains data summarizing the growth features of the 20 plants produced from the data in <code>longi.dat</code>.
</p>
</li></ol>

<hr>
<h2 id='fitSpline'>Fits a spline to a <code>response</code> in a <code>data.frame</code>, and growth rates can be 
computed using derivatives</h2><span id='topic+fitSpline'></span>

<h3>Description</h3>

<p>Uses <code>smooth.spline</code> to fit a natural cubic smoothing spline  or <code>JOPS</code> to fit a 
P-spline to all the values of <code>response</code> stored in <code>data</code>. 
</p>
<p>The amount of smoothing can be controlled by tuning parameters, these being 
related to the penalty. For a natural cubic smoothing spline, these are 
<code>df</code> or <code>lambda</code> and, for a P-spline, it is <code>lambda</code>. 
For a P-spline, <code>npspline.segments</code> also influences the smoothness of the fit. 
The <code>smoothing.method</code> provides for <code>direct</code> and <code>logarithmic</code> 
smoothing. The method of Huang (2001) for correcting the fitted spline for 
estimation bias at the end-points will be applied when fitting using a 
natural cubic smoothing spline if <code>correctBoundaries</code> is <code>TRUE</code>. 
</p>
<p>The derivatives of the fitted spline can also be obtained, and the 
Absolute and Relative Growth Rates ( AGR and RGR) computed using them, provided 
<code>correctBoundaries</code> is <code>FALSE</code>. Otherwise, growth rates can be 
obtained by difference using <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>.
</p>
<p>The handling of missing values in the observations is controlled via 
<code>na.x.action</code> and <code>na.y.action</code>. If there are not 
at least four distinct, nonmissing x-values, a warning is issued and 
all smoothed values and derivatives are set to <code>NA</code>. 
</p>
<p>The function <code><a href="#topic+probeSmoothing">probeSmoothing</a></code> can be used to investgate the effect 
the smoothing parameters (<code>smoothing.method</code> and <code>df</code> or  
<code>lambda</code>) on the smooth that results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitSpline(data, response, response.smoothed, x, 
          smoothing.method = "direct", 
          spline.type = "NCSS", df = NULL, lambda = NULL, 
          npspline.segments = NULL, correctBoundaries = FALSE, 
          deriv = NULL, suffices.deriv = NULL, extra.rate = NULL, 
          na.x.action = "exclude", na.y.action = "trimx", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitSpline_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column to be smoothed.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> that is to be smoothed.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code>.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> that contains the values of the predictor variable.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_smoothing.method">smoothing.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the smoothing method 
to use. The two possibilites are (i) <code>"direct"</code>, for directly 
smoothing the observed <code>response</code>, and (ii) <code>"logarithmic"</code>, for 
smoothing the <code>log</code>-transformed <code>response</code> and then 
back-transforming by taking the exponentional of the fitted values.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_spline.type">spline.type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the type of spline  
to use. Currently, the possibilites are (i) <code>"NCSS"</code>, for natural 
cubic smoothing splines, and (ii) <code>"PS"</code>, for P-splines.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_df">df</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for natural cubic smoothing splines 
(<code>NCSS</code>), the desired equivalent number of degrees of freedom of the 
smooth (trace of the smoother matrix). Lower values result in more smoothing. 
If <code>df = NULL</code>, the amount of smoothing can be controlled by setting 
<code>lambda</code>. If both <code>df</code> and <code>lambda</code> are <code>NULL</code>, smoothing 
is controlled by the default arguments for <code>smooth.spline</code>, and any 
that you supply via the ellipsis (...) argument.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_lambda">lambda</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the positive penalty to apply. 
The amount of smoothing decreases as <code>lamda</code> decreases.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_npspline.segments">npspline.segments</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for P-splines (<code>PS</code>), 
the number of equally spaced segments between <code>min(x)</code> and <code>max(x)</code>, 
excluding missing values, to use in constructing the B-spline basis for the 
spline fitting. If <code>npspline.segments</code> is NULL, <code>npspline.segments</code> 
is set to the maximum of 10 and <code>ceiling((nrow(data)-1)/2)</code> i.e. there will 
be at least 10 segments and, for more than 22 <code>x</code> values, there will be 
half as many segments as there are <code>x</code> values. The amount of smoothing 
decreases as <code>npspline.segments</code> increases.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_correctboundaries">correctBoundaries</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether the fitted spline 
values are to have the method of Huang (2001) applied 
to them to correct for estimation bias at the end-points. Note that 
<code>spline.type</code> must be <code>NCSS</code> and <code>lambda</code> and <code>deriv</code> 
must be <code>NULL</code> for <code>correctBoundaries</code> to be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_deriv">deriv</code></td>
<td>
<p>A <code>numeric</code> specifying one or more orders of derivatives 
that are required.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_suffices.deriv">suffices.deriv</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to <code>response.method</code> to construct the names of the derivatives. 
If <code>NULL</code> and the derivatives are to be retained, then <code>.dv</code> 
followed by the order of the derivative is appended to 
<code>response.method</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="fitSpline_+3A_extra.rate">extra.rate</code></td>
<td>
<p>A named <code><a href="base.html#topic+character">character</a></code> nominating a single growth 
rate (<code>AGR</code> or <code>RGR</code>) to be computed using the first 
derivative, which one being dependent on the <code>smoothing.method</code>. 
The name of this element will used as a suffix to be appended to 
the response when naming the resulting growth rate (see Examples). 
If unamed, <code>AGR</code> or <code>RGR</code> will be used, as appropriate. 
Note that, for the <code>smoothing.method</code> set to <code>direct</code>, 
the first derivative is the AGR and so <code>extra.rate</code> must be set 
to <code>RGR</code>, which is computed as the <code>AGR / smoothed response</code>. 
For the <code>smoothing.method</code> set to <code>logarithmic</code>, 
the first derivative is the RGR and so <code>extra.rate</code> must be set 
to <code>AGR</code>, which is computed as the <code>RGR * smoothed response</code>. 
Make sure that <code>deriv</code> includes one so that the first derivative 
is available for calculating the <code>extra.rate</code>.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_na.x.action">na.x.action</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string that specifies the action to 
be taken when values of <code>x</code> are <code>NA</code>. The possible 
values are <code>fail</code>, <code>exclude</code> or <code>omit</code>. 
For <code>exclude</code> and <code>omit</code>, predictions and derivatives 
will only be obtained for nonmissing values of <code>x</code>. 
The difference between these two codes is that for <code>exclude</code> 
the returned <code>data.frame</code> will have as many rows as 
<code>data</code>, the missing values have been incorporated. </p>
</td></tr>
<tr><td><code id="fitSpline_+3A_na.y.action">na.y.action</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string that specifies the action to 
be taken when values of <code>y</code>, or the <code>response</code>, are 
<code>NA</code>.  The possible values are <code>fail</code>, <code>exclude</code>, 
<code>omit</code>, <code>allx</code>, <code>trimx</code>, <code>ltrimx</code> or 
<code>rtrimx</code>. For  all options, except <code>fail</code>, missing 
values in <code>y</code> will be removed before smoothing. 
For <code>exclude</code> and <code>omit</code>, predictions 
and derivatives will be obtained only for nonmissing values of 
<code>x</code> that do not have missing <code>y</code> values. Again, the 
difference between these two is that, only for <code>exclude</code> 
will the missing values be incorporated into the 
returned <code>data.frame</code>. For <code>allx</code>, predictions and 
derivatives will be obtained for all nonmissing <code>x</code>. 
For <code>trimx</code>, they will be obtained for all nonmissing 
<code>x</code> between the first and last nonmissing <code>y</code> values 
that have been ordered for <code>x</code>; for <code>ltrimx</code> and 
<code>utrimx</code> either the lower or upper missing <code>y</code> 
values, respectively, are trimmed.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code>smooth.spline</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> with two components named <code>predictions</code> and 
<code>fit.spline</code>.
</p>
<p>The <code>predictions</code> component is a <code>data.frame</code> containing <code>x</code> 
and the fitted smooth. The names of the columns will be the value of 
<code>x</code> and the value of <code>response.smoothed</code>. The number of rows in 
the <code>data.frame</code> will be equal to the number of pairs that have neither 
a missing <code>x</code> or <code>response</code> and the order of <code>x</code> will be the 
same as the order in <code>data</code>. If <code>deriv</code> is not <code>NULL</code>, 
columns containing the values of the derivative(s) will be added to the 
<code>data.frame</code>; the name each of these columns will be the value of 
<code>response.smoothed</code> with <code>.dvf</code> appended, where <code>f</code> is the 
order of the derivative, or  the value of <code>response.smoothed</code> and the 
corresponding element of <code>suffices.deriv</code> appended. If <code>RGR</code> is 
not <code>NULL</code>, the RGR is calculated as the ratio of value of the first 
derivative of the fitted spline and the fitted value for the spline.
</p>
<p>The <code>fit.spline</code> component is a <code><a href="base.html#topic+list">list</a></code> with components
</p>

<dl>
<dt><code>x</code>:</dt><dd><p>the distinct x values in increasing order;</p>
</dd>
<dt><code>y</code>:</dt><dd><p>the fitted values, with boundary values possibly corrected, and corresponding to <code>x</code>;</p>
</dd>
<dt><code>lev</code>:</dt><dd><p>leverages, the diagonal values of the smoother matrix (NCSS only);</p>
</dd>
<dt><code>lambda</code>:</dt><dd><p>the value of lambda (corresponding to <code>spar</code> for NCSS - see <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>);</p>
</dd> 
<dt><code>df</code>:</dt><dd><p>the efective degrees of freedom;</p>
</dd>
<dt><code>npspline.segments</code>:</dt><dd><p>the number of equally spaced segments used for smoothing method set to <code>PS</code>;</p>
</dd>
<dt><code>uncorrected.fit</code>:</dt><dd><p>the object returned by <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> for <code>smoothing method</code> set to <code>NCSS</code> or by <code>JOPS::psNormal</code> for <code>PS</code>.</p>
</dd></dl>



<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Eilers, P.H.C and Marx, B.D. (2021) <em>Practical smoothing: the joys of P-splines</em>. Cambridge University Press, Cambridge.
</p>
<p>Huang, C. (2001) Boundary corrected cubic smoothing splines. <em>Journal of Statistical Computation and Simulation</em>, <b>70</b>, 107-121.</p>


<h3>See Also</h3>

<p><code><a href="#topic+splitSplines">splitSplines</a></code>, <code><a href="#topic+probeSmoothing">probeSmoothing</a></code>, 
<code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>, <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <br />
<code><a href="stats.html#topic+predict.smooth.spline">predict.smooth.spline</a></code>, JOPS.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
fit &lt;- fitSpline(longi.dat, response="PSA", response.smoothed = "sPSA", 
                 x="xDAP", df = 4,
                 deriv=c(1,2), suffices.deriv=c("AGRdv","Acc"))
fit &lt;- fitSpline(longi.dat, response="PSA", response.smoothed = "sPSA", 
                 x="xDAP", 
                 spline.type = "PS", lambda = 0.1, npspline.segments = 10, 
                 deriv=c(1,2), suffices.deriv=c("AGRdv","Acc"))
fit &lt;- fitSpline(longi.dat, response="PSA", response.smoothed = "sPSA", 
                 x="xDAP", df = 4,
                 deriv=c(1), suffices.deriv=c("AGRdv"), 
                 extra.rate = c(RGR.dv = "RGR"))
</code></pre>

<hr>
<h2 id='getTimesSubset'>Forms a subset of <code>responses</code> in <code>data</code> that contains their values for the nominated times</h2><span id='topic+getTimesSubset'></span>

<h3>Description</h3>

<p>Forms a subset of each of the <code>responses</code> in <code>data</code> that contains their values for the 
nominated times in a single column.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTimesSubset(data, responses, 
               individuals = "Snapshot.ID.Tag", times = "DAP", 
               which.times, suffix = NULL, sep.suffix.times = ".", 
               include.times = FALSE, include.individuals = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTimesSubset_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="getTimesSubset_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> whose values are to be subsetted.</p>
</td></tr>
<tr><td><code id="getTimesSubset_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing an identifier for each individual 
(e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="getTimesSubset_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used to identify the subset and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="getTimesSubset_+3A_which.times">which.times</code></td>
<td>
<p>A <code><a href="base.html#topic+vector">vector</a></code> giving the times that are to be selected.</p>
</td></tr>
<tr><td><code id="getTimesSubset_+3A_suffix">suffix</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be appended to 
<code>responses</code> to form the names of the columns containing the 
subset.</p>
</td></tr>
<tr><td><code id="getTimesSubset_+3A_sep.suffix.times">sep.suffix.times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use in 
appending a suffix for times to a trait. For no separator, set to 
<code>""</code>.</p>
</td></tr>
<tr><td><code id="getTimesSubset_+3A_include.times">include.times</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not 
to include the <code>times</code> in the result, the name in the result 
having the <code>suffix</code> with a separating full appended.</p>
</td></tr>
<tr><td><code id="getTimesSubset_+3A_include.individuals">include.individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not 
to include the <code>individuals</code> column in the result.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the subset of <code>responses</code> ordered 
by as many of the initial columns of <code>data</code> as are required to uniquely 
identify each row (see <code><a href="base.html#topic+order">order</a></code> for more information). The names 
of the columns for each of the <code>responses</code> and for <code>times</code> in the 
subset are the concatenation of their names in <code>data</code> and <code>suffix</code>, 
separated by a full stop.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
sPSALast &lt;- getTimesSubset("sPSA", data = longi.dat, times = "DAP", 
                           which.times = c(42), suffix = "last")
</code></pre>

<hr>
<h2 id='growthPheno-deprecated'>Deprecated Functions in the Package growthPheno</h2><span id='topic+growthPheno-deprecated'></span><span id='topic+anomPlot'></span><span id='topic+corrPlot'></span><span id='topic+getDates'></span><span id='topic+imagetimesPlot'></span><span id='topic+longiPlot'></span><span id='topic+probeDF'></span>

<h3>Description</h3>

<p>These functions have been renamed and deprecated in <code>growthPheno</code>: 
</p>

<ol>
<li><p> getDates -&gt; <code><a href="#topic+getTimesSubset">getTimesSubset</a></code>
</p>
</li>
<li><p> anomPlot -&gt; <code><a href="#topic+plotAnom">plotAnom</a></code>
</p>
</li>
<li><p> corrPlot -&gt; <code><a href="#topic+plotCorrmatrix">plotCorrmatrix</a></code>
</p>
</li>
<li><p> imagetimesPlot -&gt; <code><a href="#topic+plotImagetimes">plotImagetimes</a></code>
</p>
</li>
<li><p> longiPlot -&gt; <code><a href="#topic+plotProfiles">plotProfiles</a></code>
</p>
</li>
<li><p> probeDF -&gt; <code><a href="#topic+probeSmooths">probeSmooths</a></code>
</p>
</li></ol>


<h3>Usage</h3>

<pre><code class='language-R'>getDates(...)
anomPlot(...)
corrPlot(...)
imagetimesPlot(...)
longiPlot(...)
probeDF(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="growthPheno-deprecated_+3A_...">...</code></td>
<td>
<p>absorbs arguments passed from the old functions of the style foo.bar().</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chris Brien</p>

<hr>
<h2 id='growthPheno-package'>
Functional Analysis of Phenotypic Growth Data to Smooth and
Extract Traits
</h2><span id='topic+growthPheno-package'></span><span id='topic+growthPheno'></span>

<h3>Description</h3>

<p>Assists in the plotting and functional smoothing of traits 
    measured over time and the extraction of features from these traits, 
    implementing the SET (Smoothing and Extraction of Traits) method 
    described in Brien et al. (2020) Plant Methods, 16. Smoothing of 
    growth trends for individual plants using natural cubic smoothing 
    splines or P-splines is available for removing transient effects and 
    segmented smoothing is available to deal with discontinuities in 
    growth trends. There are graphical tools for assessing the adequacy 
    of trait smoothing, both when using this and other packages, such as 
    those that fit nonlinear growth models. A range of per-unit (plant, 
    pot, plot) growth traits or features can be extracted from the 
    data, including single time points, interval growth rates and other 
    growth statistics, such as maximum growth or days to maximum growth. 
    The package also has tools adapted to inputting data from 
    high-throughput phenotyping facilities, such from a Lemna-Tec 
    Scananalyzer 3D (see &lt;https://www.youtube.com/watch?v=MRAF_mAEa7E/&gt; 
    for more information). The package 'growthPheno' can also be 
    installed from &lt;http://chris.brien.name/rpackages/&gt;.
</p>
<p><b>Version:</b> 2.1.24
</p>
<p><b>Date:</b> 2024-02-29
</p>


<h3>Index</h3>

<p>The following list of functions does not include those that are soft-deprecated, i.e. those that have been available in previous versions of <code>growthPheno</code> but will be removed in future versions. For a description of the use of the listed functions and vignettes that are available, see the Overview section below.
</p>

<table>
<tr>
 <td style="text-align: left;">
    (i) Wrapper functions    </td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+traitSmooth">traitSmooth</a></code>
    </td><td style="text-align: left;"> Obtain smooths for a trait by fitting spline </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> functions and, having compared several smooths, </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> allows one of them to be chosen and returned in </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> a <code>data.frame</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+traitExtractFeatures">traitExtractFeatures</a></code> 
    </td><td style="text-align: left;"> Extract features, that are single-valued for each </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> individual, from smoothed traits over time. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>
<tr>
 <td style="text-align: left;">    
    (ii) Helper functions  </td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+args4chosen_plot">args4chosen_plot</a></code>
    </td><td style="text-align: left;"> Creates a <code>list</code> of the values for the options of </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> profile plots for the chosen smooth. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+args4chosen_smooth">args4chosen_smooth</a></code>
    </td><td style="text-align: left;"> Creates a <code>list</code> of the values for the smoothing </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> parameters for which a smooth is to be extracted. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>
    </td><td style="text-align: left;"> Creates a <code>list</code> of the values for the options of </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> median deviations plots for smooths. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>
    </td><td style="text-align: left;"> Creates a <code>list</code> of the values for the options of </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> profile plots for comparing smooths. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+args4smoothing">args4smoothing</a></code>
    </td><td style="text-align: left;"> Creates a <code>list</code> of the values for the smoothing </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> parameters to be passed to a smoothing function. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>
<tr>
 <td style="text-align: left;">
    (iii) Data</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code><a href="#topic+exampleData">exampleData</a></code> 
    </td><td style="text-align: left;"> A small data set to use in function examples. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+RicePrepped.dat">RicePrepped.dat</a></code> 
    </td><td style="text-align: left;"> Prepped data from an experiment to investigate </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> a rice germplasm panel. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+RiceRaw.dat">RiceRaw.dat</a></code> 
    </td><td style="text-align: left;"> Data for an experiment to investigate a rice </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> germplasm panel.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+tomato.dat">tomato.dat</a></code> 
    </td><td style="text-align: left;"> Longitudinal data for an experiment to investigate </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> tomato response to mycorrhizal fungi and zinc. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>
<tr>
 <td style="text-align: left;">
    (iv) Plots</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code><a href="#topic+plotAnom">plotAnom</a></code> 
    </td><td style="text-align: left;"> Identifies anomalous individuals and produces</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> profile plots without them and with just them.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotCorrmatrix">plotCorrmatrix</a></code> 
    </td><td style="text-align: left;"> Calculates and plots correlation matrices for a</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> set of responses.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>
    </td><td style="text-align: left;"> Produces boxplots of the deviations of the observed </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> values from the smoothed values over values of x. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotImagetimes">plotImagetimes</a></code> 
    </td><td style="text-align: left;"> Plots the time within an interval versus the interval.</td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> For example, the hour of the day carts are imaged</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> against the days after planting (or some other</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> number of days after an event).</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotMedianDeviations">plotMedianDeviations</a></code> 
    </td><td style="text-align: left;"> Calculates and plots the medians of the deviations </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> of the smoothed values from the observed values. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotProfiles">plotProfiles</a></code> 
    </td><td style="text-align: left;"> Produces profile plots of longitudinal data for a set </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> of individuals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code>
    </td><td style="text-align: left;"> Plots  several sets of smoothed values for a response, </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> possibly along with growth rates and optionally including </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> the unsmoothed values, as well as deviations boxplots. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code> 
    </td><td style="text-align: left;"> Calculates and plots the medians of the deviations </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> from the observed values of several sets for smoothed </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> values stored in a <code>data.frame</code> in long format. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+probeSmooths">probeSmooths</a></code> 
    </td><td style="text-align: left;"> Computes and compares, for a set of smoothing parameters, </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> a response and the smooths of it, possibly along with </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> growth rates calculated from the smooths.</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>
<tr>
 <td style="text-align: left;">
    (v) Smoothing and calculation </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    of growth rates and water use traits </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    for each individual (Indv) </td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">

    <code><a href="#topic+byIndv4Intvl_GRsAvg">byIndv4Intvl_GRsAvg</a></code>
    </td><td style="text-align: left;"> Calculates the growth rates for a specified</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> time interval for individuals in a <code>data.frame</code> in </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> long format by taking weighted averages of growth </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> rates for times within the interval.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+byIndv4Intvl_GRsDiff">byIndv4Intvl_GRsDiff</a></code>
    </td><td style="text-align: left;"> Calculates the growth rates for a specified </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> time interval for individuals in a <code>data.frame</code> in </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> long format by differencing the values for </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> a response within the interval.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+byIndv4Intvl_ValueCalc">byIndv4Intvl_ValueCalc</a></code>
    </td><td style="text-align: left;"> Calculates a single value that is a <code>function</code> of </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> the values of an individual for a response in a </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> <code>data.frame</code> in long format over a specified </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> time interval. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+byIndv4Intvl_WaterUse">byIndv4Intvl_WaterUse</a></code>
    </td><td style="text-align: left;"> Calculates, water use traits (WU, WUR, WUI) over a </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> specified time interval for each individual in a </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>data.frame</code> in long format.   </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>
    </td><td style="text-align: left;"> Adds, to a 'data.frame', the growth rates </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> calculated for consecutive times for individuals in </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> a <code>data.frame</code> in long format by differencing </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> response values.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code>
    </td><td style="text-align: left;"> For a response in a <code>data.frame</code> in long format, </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> computes, for a single set of smoothing parameters, </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> smooths of the response, possibly along with </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> growth rates calculated from the smooths. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    <code><a href="#topic+byIndv_ValueCalc">byIndv_ValueCalc</a></code>
    </td><td style="text-align: left;"> Applies a <code>function</code> to calculate a single value from </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> an individual's values for a response in a <code>data.frame</code> in </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> long format.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+smoothSpline">smoothSpline</a></code> 
    </td><td style="text-align: left;"> Fit a spline to smooth the relationship between a </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>response</code> and an <code>x</code> in a <code>data.frame</code>, </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> optionally computing growth rates using derivatives.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+probeSmooths">probeSmooths</a></code> 
    </td><td style="text-align: left;"> For a response in a <code>data.frame</code> in long format, computes and </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> compares, for sets of smoothing parameters, smooths </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> of the response, possibly along with growth rates </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> calculated from the smooths.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
    (vi) Data frame manipulation</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code><a href="#topic+as.smooths.frame">as.smooths.frame</a></code> 
    </td><td style="text-align: left;"> Forms a <code><a href="#topic+smooths.frame">smooths.frame</a></code> from a <code>data.frame</code>, </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> ensuring that the correct columns are present. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+designFactors">designFactors</a></code> 
    </td><td style="text-align: left;"> Adds the factors and covariates for a blocked,</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> split-unit design.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+getTimesSubset">getTimesSubset</a></code> 
    </td><td style="text-align: left;"> Forms a subset of 'responses' in 'data' that</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> contains their values for the nominated times.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+importExcel">importExcel</a></code> 
    </td><td style="text-align: left;"> Imports an Excel imaging file and allows some</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> renaming of variables.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+is.smooths.frame">is.smooths.frame</a></code> 
    </td><td style="text-align: left;"> Tests whether an object is of class smooths.frame. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+prepImageData">prepImageData</a></code> 
    </td><td style="text-align: left;"> Selects a set variables to be retained in a</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> data frame of longitudinal data.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+smooths.frame">smooths.frame</a></code> 
    </td><td style="text-align: left;"> Description of a smooths.frame object, </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+twoLevelOpcreate">twoLevelOpcreate</a></code> 
    </td><td style="text-align: left;"> Creates a data.frame formed by applying, for</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> each response, a binary operation to the values of </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> two different treatments.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+validSmoothsFrame">validSmoothsFrame</a></code> 
    </td><td style="text-align: left;"> Checks that an object is a valid <code><a href="#topic+smooths.frame">smooths.frame</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>
<tr>
 <td style="text-align: left;">

    (vii) General calculations </td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code><a href="#topic+anom">anom</a></code> 
    </td><td style="text-align: left;"> Tests if any values in a vector are anomalous</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> in being outside specified limits.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+calcLagged">calcLagged</a></code> 
    </td><td style="text-align: left;"> Replaces the values in a vector with the result</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> of applying an operation to it and a lagged value.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+calcTimes">calcTimes</a></code> 
    </td><td style="text-align: left;"> Calculates for a set of times, the time intervals </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> after an origin time and the position of each </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> within a time interval</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+cumulate">cumulate</a></code> 
    </td><td style="text-align: left;"> Calculates the cumulative sum, ignoring the</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> first element if exclude.1st is TRUE.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+GrowthRates">GrowthRates</a></code> 
    </td><td style="text-align: left;"> Calculates growth rates (AGR, PGR, RGRdiff) </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> between a pair of values in a vector.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+WUI">WUI</a></code> 
    </td><td style="text-align: left;"> Calculates the Water Use Index (WUI) for a value </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    </td><td style="text-align: left;"> of the response and of the water use.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
    (viii) Principal variates analysis (PVA)</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code><a href="#topic+intervalPVA.data.frame">intervalPVA.data.frame</a></code> 
    </td><td style="text-align: left;"> Selects a subset of variables using PVA, based on </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> the observed values within a specified time interval</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+PVA.data.frame">PVA.data.frame</a></code> 
    </td><td style="text-align: left;"> Selects a subset of variables stored in a data.frame </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> using PVA.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+PVA.matrix">PVA.matrix</a></code> 
    </td><td style="text-align: left;"> Selects a subset of variables using PVA based on a </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> correlation matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+rcontrib.data.frame">rcontrib.data.frame</a></code> 
    </td><td style="text-align: left;"> Computes a measure of how correlated each</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> variable in a set is with the other variable,</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> conditional on a nominated subset of them.</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+rcontrib.matrix">rcontrib.matrix</a></code> 
    </td><td style="text-align: left;"> Computes a measure of how correlated each</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> variable in a set is with the other variable,</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> conditional on a nominated subset of them.</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<h3>Overview</h3>

<p>This package can be used to perform a functional analysis of growth data using splines to smooth the trend of individual plant traces over time and then to extract features or tertiarty traits for further analysis. This process is called smoothing and extraction 
of traits (SET) by Brien et al. (2020), who detail the use of <code>growthPheno</code> for carrying out the method. However, <code>growthPheno</code> now has the two wrapper, or primary, functions <code><a href="#topic+traitSmooth">traitSmooth</a></code> and   <code><a href="#topic+traitExtractFeatures">traitExtractFeatures</a></code> that implement the SET approach. These may be the only functions that are used in that the complete SET process can be carried out using only them. The <code>Tomato</code> vignette illustrates their use for the example presented in Brien et al. (2020). 
</p>
<p>The function <code><a href="#topic+traitSmooth">traitSmooth</a></code> utilizes the secondary functions <code><a href="#topic+probeSmooths">probeSmooths</a></code>, <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code> and <code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code> and accepts the arguments of the secondary functions. The function <code><a href="#topic+probeSmooths">probeSmooths</a></code> utilizes the tertiary functions <code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code> and <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>, which in turn call the function <code><a href="#topic+smoothSpline">smoothSpline</a></code>. The function <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code> calls <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>. All of these functions play a role in choosing the smoothing method and parameters for a data set. 
</p>
<p>The primary function <code><a href="#topic+traitExtractFeatures">traitExtractFeatures</a></code> uses the secondary functions <code><a href="#topic+getTimesSubset">getTimesSubset</a></code> and the set of <code>byIndv4Intvl_</code> functions. These functions are concerned with the extraction of traits that yield a single value for each individual in the data. 
</p>
<p>Recourse to the secondary and terriary functions may be necessary for special cases. Their use is illustrated in the <code>Rice</code> vignette.
</p>
<p>Use <code>vignette("Tomato", package = "growthPheno")</code> or <code>vignette("Rice", package = "growthPheno")</code> to access either of the vignettes.
</p>
<p>In addition to functions that implement SET approach, <code>growthPheno</code>  also has functions for importing and organizing the data that are generally applicable, although they do have defaults that  make them particularly adapted to data from a high-throughput phenotyping facility based on a Lemna-Tec Scananalyzer 3D system. 
</p>
<p>Data suitable for use with this package consists of columns of data obtained from a set of individuals (e.g. plants, pots, carts, plots or units) over time. There should be a unique identifier for each individual and a time variable, such as Days after Planting (DAP),  that contain no repeats for an individual. The combination of the identifier and a time for an individual should be unique to that individual. For imaging data, the individuals may be arranged in a grid of Lanes <code class="reqn">\times</code> Positions. That is, the minimum set of columns is an individuals, a times and one or more primary trait columns. 
</p>


<h3>Author(s)</h3>

<p>Chris Brien [aut, cre] (&lt;https://orcid.org/0000-0003-0581-1817&gt;)
</p>
<p>Maintainer: Chris Brien &lt;chris.brien@adelaide.edu.au&gt;
</p>


<h3>References</h3>

<p>Brien, C., Jewell, N., Garnett, T., Watts-Williams, S. J., &amp; Berger, B. (2020). Smoothing and extraction of traits in the growth analysis of noninvasive phenotypic data. <em>Plant Methods</em>, <b>16</b>, 36. <a href="https://doi.org/10.1186/s13007-020-00577-6">doi:10.1186/s13007-020-00577-6</a>.
</p>


<h3>See Also</h3>

<p><code><a href="dae.html#topic+dae-package">dae</a></code>
</p>

<hr>
<h2 id='GrowthRates'>Calculates growth rates (AGR, PGR, RGRdiff) between pairs of values in a vector</h2><span id='topic+GrowthRates'></span><span id='topic+AGRdiff'></span><span id='topic+PGR'></span><span id='topic+RGRdiff'></span>

<h3>Description</h3>

<p>Calculates either the Absolute Growth Rate (AGR), Proportionate Growth 
Rate (PGR) or Relative Growth Rate (RGR) between pairs of time points, 
the second of which is <code>lag</code> positions before the first. 
in <code>x</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>AGRdiff(x, time.diffs, lag=1)
PGR(x, time.diffs, lag=1)
RGRdiff(x, time.diffs, lag=1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GrowthRates_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> from which the growth rates are to 
be calculated.</p>
</td></tr>
<tr><td><code id="GrowthRates_+3A_time.diffs">time.diffs</code></td>
<td>
<p>a <code>numeric</code> giving the time differences between successive 
values in <code>x</code>.</p>
</td></tr>
<tr><td><code id="GrowthRates_+3A_lag">lag</code></td>
<td>
<p>A <code>integer</code> specifying, for the second value in the pair to be operated on, 
the number positions it is ahead of the current value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The AGRdiff is calculated as the difference between a pair of values divided by the <code>time.diffs</code>. 
The PGR is calculated as the ratio of a value to a second value which is <code>lag</code> values 
ahead of the first in <code>x</code> and the ratio raised to the 
power of the reciprocal of <code>time.diffs</code>. 
The RGRdiff is calculated as the <code>log</code> of the PGR and so is equal to the difference between 
the logarithms of a pair of values divided by the <code>time.diffs</code>.
The differences and ratios are obtained using <code><a href="#topic+calcLagged">calcLagged</a></code> with <code>lag = 1</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> containing the growth rates which is the same length as <code>x</code> 
and in which the first <code>lag</code> values <code>NA</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+byIndv4Intvl_GRsAvg">byIndv4Intvl_GRsAvg</a></code>, <code><a href="#topic+byIndv4Intvl_GRsDiff">byIndv4Intvl_GRsDiff</a></code>, <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>, <code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code>, <br />
<code><a href="#topic+calcLagged">calcLagged</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat$PSA.AGR &lt;- with(longi.dat, AGRdiff(PSA, time.diffs = DAP.diffs))
</code></pre>

<hr>
<h2 id='importExcel'>Imports an Excel imaging file and allows some renaming of variables</h2><span id='topic+importExcel'></span>

<h3>Description</h3>

<p>Uses <code>readxl</code> to import a sheet of imaging data produced by the 
Lemna Tec Scanalyzer. Basically, the data consists of imaging data obtained from a 
set of pots or carts over time. There should be a column, which by default is called 
<code>Snapshot.ID.Tag</code>, containing a unique identifier for each cart and a column, 
which by default is labelled <code>Snapshot.Time.Stamp</code>, containing 
the time of imaging for each observation in a row of the sheet. Also, if 
<code>startTime</code> is not <code>NULL</code>, <code>calcTimes</code> is called to 
calculate, or recalculate if already present, <code>timeAfterStart</code> from 
<code>imageTimes</code> by subtracting a supplied <code>startTime</code>. 
</p>
<p>Using <code>cameraType</code>, <code>keepCameraType</code>, <code>labsCamerasViews</code> and 
<code>prefix2suffix</code>, some flexibility is provided for renaming the columns with 
imaging data. For example, if the column names are prefixed with 'RGB_SV1', 'RGB_SV2' 
or 'RGB_TV', the 'RGB_' can be removed and the 'SV1', 'SV2' or 'TV' become suffices. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importExcel(file, sheet="raw data", sep = ",", 
            cartId = "Snapshot.ID.Tag", 
            imageTimes = "Snapshot.Time.Stamp", 
            timeAfterStart = "Time.after.Planting..d.", 
            cameraType = "RGB", keepCameraType = FALSE, 
            labsCamerasViews = NULL, prefix2suffix = TRUE, 
            startTime = NULL,
            timeFormat = "%Y-%m-%d %H:%M", 
            plotImagetimes = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importExcel_+3A_file">file</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the path and name of the file containing 
the data.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_sheet">sheet</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the sheet containing 
the data, that must include columns whose names are as specified by <code>cartId</code>, 
which uniquely indexes the carts in the experiment, and 
<code>imageTimes</code>, which reflects the time of the imaging from 
which a particular data value was obtained. It is also assumed that a 
column whose name is specified by <code>timeAfterStart</code> is in the sheet or that 
it will be calculated from <code>imageTimes</code> using the value of 
<code>startTime</code> supplied in the function call.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_sep">sep</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator used in a <code>csv</code> file.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_cartid">cartId</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that contains
the unique Id for each cart. Note that in importing data into R, spaces 
and nonalphanumeric characters in names are converted to full stops.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_imagetimes">imageTimes</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that contains
the time that each cart was imaged. Note that in importing data into R, spaces 
and nonalphanumeric characters in names are converted to full stops.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_timeafterstart">timeAfterStart</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that 
contains or is to contain the difference between <code>imageTimes</code> and 
<code>startTime</code>. The function <code>calcTimes</code> is called to calculate the
differences. For example, it might contain the number of days after 
planting. Note that in importing data into R, spaces 
and nonalphanumeric characters in names are converted to full stops.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_cameratype">cameraType</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string nominating the abbreviation used for the 
cameraType. A warning will be given if no variable names include this cameraType.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_keepcameratype">keepCameraType</code></td>
<td>
<p>A <code>logical</code> specifying whether to retain the <code>cameraType</code> in the 
variables names. It will be the start of the prefix or suffix and separated from 
the remander of the prefix or suffix by an underscore (_).</p>
</td></tr>
<tr><td><code id="importExcel_+3A_labscamerasviews">labsCamerasViews</code></td>
<td>
<p>A named <code><a href="base.html#topic+character">character</a></code> whose elements are new labels for the 
camera-view combinations and the name of each element is the old label for the 
camera-view combination in the data being imported. If <code>labsCamerasViews</code> 
is <code>NULL</code>, all column names beginning with <code>cameraType</code> are classed as 
imaging variables and the unique prefixes amongst them determined. If no imaging 
variables are found then no changes are made. Note that if you want to include a 
recognisable <code>cameraType</code> in a camier-view label, it should be at the start 
of the the label in <code>labsCamerasViews</code> and separated from the rest of the 
label by an underscore (_).</p>
</td></tr>
<tr><td><code id="importExcel_+3A_prefix2suffix">prefix2suffix</code></td>
<td>
<p>A <code>logical</code> specifying whether the variables names with prefixed 
camera-view labels are to have those prefixes transferred to become suffices. 
The prefix is assumed to be all the characters up to the first full stop (.) in the 
variable name and must contain <code>cameraType</code> to be moved. It is generally 
assumed that the characters up to the first underscore (_) are the camera type 
and this is removed if <code>keepCameraType</code> is <code>FALSE</code>. If there is no 
underscore (_), the whole prefix is moved. If <code>labsCamerasViews</code> is 
<code>NULL</code>, all column names beginning with <code>cameraType</code> are classed as 
imaging variables and the unique prefixes amongst them determined. 
If no imaging variables are found then no changes are made.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_starttime">startTime</code></td>
<td>
<p>A <code>character</code> giving the time of planting, in the <code>POSIXct</code> 
format timeFormat, to be subtracted from <code>imageTimes</code> 
in recalculating <code>timeAfterStart</code>. If <code>startTime</code> is 
<code>NULL</code> then <code>timeAfterStart</code> is not recalculated.</p>
</td></tr> 
<tr><td><code id="importExcel_+3A_timeformat">timeFormat</code></td>
<td>
<p>A <code>character</code> giving the <code>POSIXct</code> format of characters 
containing times, in particular <code>imageTimes</code> and <code>startTime</code>.</p>
</td></tr> 
<tr><td><code id="importExcel_+3A_plotimagetimes">plotImagetimes</code></td>
<td>
<p>A <code>logical</code> indicating whether a plot of the imaging times against 
the recalculated <code>Time.After.Planting..d.</code>. It aids in checking 
<code>Time.After.Planting..d.</code> and what occurred in imaging the plants.</p>
</td></tr>
<tr><td><code id="importExcel_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code><a href="#topic+plotImagetimes">plotImagetimes</a></code>. However, if 
<code>intervals</code> is passed an error will occur; use timeAfterStart instead.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the data.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>, <code><a href="#topic+calcTimes">calcTimes</a></code>, <code><a href="#topic+plotImagetimes">plotImagetimes</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
filename &lt;- system.file("extdata/rawdata.xlsx", package = "growthPheno", 
                        mustWork = TRUE)
raw.dat &lt;- importExcel(file = filename, 
                       startTime  = "2015-02-11 0:00 AM")


camview.labels &lt;- c("SF0", "SL0", "SU0", "TV0")
names(camview.labels) &lt;- c("RGB_Side_Far_0", "RGB_Side_Lower_0", 
                           "RGB_Side_Upper_0", "RGB_TV_0")
filename &lt;- system.file("extdata/raw19datarow.csv", package = "growthPheno", 
                        mustWork = TRUE)
raw.19.dat &lt;- suppressWarnings(importExcel(file = filename,
                                           cartId = "Snapshot.ID.Tags",
                                           startTime = "06/10/2017 0:00 AM",
                                           timeFormat = "%d/%m/%Y %H:M", 
                                           labsCamerasViews = camview.labels, 
                                           plotImagetimes = FALSE))
</code></pre>

<hr>
<h2 id='intervalGRaverage'>Calculates the growth rates for a specified time interval by taking weighted averages of growth rates for times within the interval</h2><span id='topic+intervalGRaverage'></span>

<h3>Description</h3>

<p>Using previously calculated growth rates over time, calculates 
the Absolute Growth Rates for a specified interval 
using the weighted averages of AGRs for each time point in the 
interval (AGR) and the Relative Growth Rates for a specified 
interval using the weighted geometric means of RGRs for each time 
point in the interval (RGR).
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+byIndv4Intvl_GRsAvg">byIndv4Intvl_GRsAvg</a></code>.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intervalGRaverage(responses, individuals = "Snapshot.ID.Tag", 
                  which.rates = c("AGR","RGR"), suffices.rates=c("AGR","RGR"), 
                  times = "Days", start.time, end.time, suffix.interval, 
                  data, sep=".", na.rm=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervalGRaverage_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the 
<code>responses</code> for which there are columns 
in <code>data</code> that contain the growth rates that are to be 
averaged. The names of the growth rates should have 
either <code>AGR</code> or <code>RGR</code> appended to the 
<code>responses</code> names.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_which.rates">which.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the growth rates that are 
to be averaged to obtain growth rates for an interval. 
It should be a combination of one or more of 
<code>"AGR"</code> and <code>"RGR"</code>.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_suffices.rates">suffices.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffices to be 
appended to <code>response</code> to form the names of the columns 
containing the calculated the growth rates and in which growth 
rates are to be stored. Their elements will be matched with 
those of <code>which.rates</code>.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used in calculating growth rates and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times,
in terms of values in <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will 
be taken as the observation at the start of the interval for 
which the growth rate is to be calculated.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, 
in terms of values <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will be 
taken as the observation at the end of the interval for which 
the growth rate is to be calculated.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to <code>response</code>.<code>suffices.rates</code> to form the 
names of the columns containing the calculated the growth rates.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns from which the 
growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_sep">sep</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use when the 
levels of <code>individuals</code> are combined. This is needed to avoid 
using a <code><a href="base.html#topic+character">character</a></code> that occurs in a <code><a href="base.html#topic+factor">factor</a></code> to delimit 
levels when the levels of <code>individuals</code> are combined to 
identify subsets.</p>
</td></tr>
<tr><td><code id="intervalGRaverage_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether <code>NA</code> values should be 
stripped before the calculation of weighted means proceeds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>AGR</code> for an interval is calculated as the weighted mean of the 
AGRs for times within the interval. The RGR is calculated as the weighted 
geometric mean of the RGRs for times within the interval; in fact the exponential is taken of the weighted means of the logs of the RGRs. The weights are 
obtained from the <code>times</code>. They are taken as the sum of half the time subintervals before and after each time, except for the end points; the end points are taken to be the subintervals at the start and end of the interval.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with the growth rates. 
The name of each column is the concatenation of (i) one of 
<code>responses</code>, (ii) one of <code>AGR</code>, <code>PGR</code> or <code>RGR</code>,
or the appropriate element of <code>suffices.rates</code>, and (iii) 
<code>suffix.interval</code>, the three components being separated by 
full stops.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+intervalGRdiff">intervalGRdiff</a></code>, <code><a href="#topic+intervalWUI">intervalWUI</a></code>, <code><a href="#topic+splitValueCalculate">splitValueCalculate</a></code>, <code><a href="#topic+getTimesSubset">getTimesSubset</a></code>, <code><a href="#topic+GrowthRates">GrowthRates</a></code>, <br />
<code><a href="#topic+splitSplines">splitSplines</a></code>, <code><a href="#topic+splitContGRdiff">splitContGRdiff</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- splitSplines(data = longi.dat, 
                          response = "PSA", response.smoothed = "sPSA", 
                          x="xDAP", 
                          individuals = "Snapshot.ID.Tag", 
                          df = 4, deriv=1, suffices.deriv = "AGRdv", 
                          extra.rate = c(RGRdv = "RGR"))
sPSA.GR &lt;- intervalGRaverage(data = longi.dat, 
                             responses = "sPSA", times = "DAP", 
                             which.rates = c("AGR","RGR"), 
                             suffices.rates = c("AGRdv","RGRdv"), 
                             start.time = 31, end.time = 35, 
                             suffix.interval = "31to35")
</code></pre>

<hr>
<h2 id='intervalGRdiff'>Calculates the growth rates for a specified time interval</h2><span id='topic+intervalGRdiff'></span>

<h3>Description</h3>

<p>Using the values of the responses, calculates the specified 
combination of the Absolute Growth Rates 
using differences (AGR), the Proportionate Growth Rates (PGR) 
and Relative Growth Rates using log differences (RGR) between 
two nominated time points.
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+byIndv4Intvl_GRsDiff">byIndv4Intvl_GRsDiff</a></code>.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intervalGRdiff(responses, individuals = "Snapshot.ID.Tag", 
               which.rates = c("AGR","PGR","RGR"), suffices.rates=NULL, 
               times = "Days", start.time, end.time, suffix.interval, 
               data)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervalGRdiff_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> from which the growth rates are to be  calculated.</p>
</td></tr>
<tr><td><code id="intervalGRdiff_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="intervalGRdiff_+3A_which.rates">which.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the growth rates that are 
to be calculated. It should be a combination of one or more of 
<code>"AGR"</code>, <code>"PGR"</code> and <code>"RGR"</code>.</p>
</td></tr>
<tr><td><code id="intervalGRdiff_+3A_suffices.rates">suffices.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the responses in constructing the 
names of the columns containing the calculated growth rates.            
The order of the suffices in <code>suffices.rates</code> should 
correspond to the order of the elements of 
<code>which.rates</code>.</p>
</td></tr>
<tr><td><code id="intervalGRdiff_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used in calculating growth rates and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="intervalGRdiff_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times,
in terms of values in <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will 
be taken as the observation at the start of the interval for 
which the growth rate is to be calculated.</p>
</td></tr>
<tr><td><code id="intervalGRdiff_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, 
in terms of values <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will be 
taken as the observation at the end of the interval for which 
the growth rate is to be calculated.</p>
</td></tr>
<tr><td><code id="intervalGRdiff_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to <code>response</code> to form the names of the columns 
containing the calculated the growth rates.</p>
</td></tr>
<tr><td><code id="intervalGRdiff_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
growth rates are to be calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>AGR</code> is calculated as the difference between the values of 
<code>response</code> at the <code>end.time</code>  and <code>start.time</code> divided by the 
difference between <code>end.time</code>  and <code>start.time</code>. 
The PGR is calculated as the ratio of <code>response</code> at the <code>end.time</code> 
to that at <code>start.time</code> and the ratio raised to the power of the 
reciprocal of the difference between <code>end.time</code>  and <code>start.time</code>. 
The <code>RGR</code> is calculated as the <code>log</code> of the PGR and so is equal to 
the difference between the logarithms of <code>response</code> 
at the <code>end.time</code>  and <code>start.time</code> divided by the difference 
between <code>end.time</code>  and <code>start.time</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with the growth rates. 
The name of each column is the concatenation of (i) one of 
<code>responses</code>, (ii) one of <code>AGR</code>, <code>PGR</code> or <code>RGR</code>,
or the appropriate element of <code>suffices.rates</code>, and (iii) 
<code>suffix.interval</code>, the three components being separated by 
full stops.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+intervalGRaverage">intervalGRaverage</a></code>, <code><a href="#topic+intervalWUI">intervalWUI</a></code>,  <code><a href="#topic+getTimesSubset">getTimesSubset</a></code>, <code><a href="#topic+GrowthRates">GrowthRates</a></code>, <br />
<code><a href="#topic+splitSplines">splitSplines</a></code>, <code><a href="#topic+splitContGRdiff">splitContGRdiff</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
sPSA.GR &lt;- intervalGRdiff(responses = "sPSA", times = "DAP", 
                          which.rates = c("AGR","RGR"), 
                          start.time = 31, end.time = 35,
                          suffix.interval = "31to35",
                          data = longi.dat)
</code></pre>

<hr>
<h2 id='intervalPVA.data.frame'>Selects a subset of variables using Principal Variable Analysis (PVA), based on the observed values within a specified time interval</h2><span id='topic+intervalPVA.data.frame'></span><span id='topic+intervalPVA'></span>

<h3>Description</h3>

<p>Principal Variable Analysis (PVA) (Cumming and Wooff, 2007) selects a subset 
from a set of the variables such that the variables in the subset are as 
uncorrelated as possible, in an effort to ensure that all aspects of the variation 
in the data are covered. Here, all observations in a specified time interval are 
used for calculation the correlations on which the selection is based.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
intervalPVA(obj, responses, times = "Days", start.time, end.time, 
            nvarselect = NULL, p.variance = 1, include = NULL, 
            plot = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervalPVA.data.frame_+3A_obj">obj</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns of variables from which the 
selection is to be made.</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> from which the variables are to be selected.</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used to identify the subset and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_start.time">start.time</code></td>
<td>
<p>A <code>numeric</code> giving the time,
in terms of values in <code>times</code>, at which the time interval 
begins; observations at this time and up to and including <code>end.time</code>
will be included.</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_end.time">end.time</code></td>
<td>
<p>A <code>numeric</code> giving the time,
in terms of values in <code>times</code>, at the end of the interval; 
observations after this time will not be included.</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_nvarselect">nvarselect</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the number of variables to be selected, 
which includes those listed in <code>include</code>. If <code>nvarselect = 1</code>, as 
many variables are selected as is need to satisfy <code>p.variance</code>.</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_p.variance">p.variance</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the minimum proportion of the variance 
that the selected variables must account for,</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_include">include</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> for the variables whose selection is mandatory.</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_plot">plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether a plot of the cumulative proportion 
of the variance explained is to be produced.</p>
</td></tr>
<tr><td><code id="intervalPVA.data.frame_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variable that is most correlated with the other variables is selected first for inclusion. The partial correlation for each of the remaining variables, given the first selected variable, is calculated and the most correlated of these variables is selects for inclusion next. Then the partial correlations are adjust for the second included variables. This process is repeated until the specified criteria have been satisfied. The possibilities are to:
</p>

<ol>
<li><p> the default (<code>nvarselect = NULL</code> and <code>p.variance = 1</code>) select all variables in 
increasing order of amount of information they provide;
</p>
</li>
<li><p> select exactly <code>nvarselect</code> variables;
</p>
</li>
<li><p> select just enough variables, up to a maximum of <code>nvarselect</code> variables, to explain 
at least <code>p.variance</code>*100 per cent of the total variance.
</p>
</li></ol>



<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the results of the variable selection. 
It will contain the columns <code>Variable</code>, <code>Selected</code>, 
<code>h.partial</code>, <code>Added.Propn</code> and <code>Cumulative.Propn</code>.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Cumming, J. A. and D. A. Wooff (2007) Dimension reduction via principal variables. <em>Computational Statistics
and Data Analysis</em>, <b>52</b>, 550&ndash;565.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVA">PVA</a></code>, <code><a href="#topic+rcontrib">rcontrib</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1)
longi.dat &lt;- within(longi.dat, 
                    {
                      Max.Height &lt;- pmax(Max.Dist.Above.Horizon.Line.SV1,  
                                         Max.Dist.Above.Horizon.Line.SV2)
                      Density &lt;- PSA/Max.Height
                      PSA.SV = (PSA.SV1 + PSA.SV2) / 2
                      Image.Biomass = PSA.SV * (PSA.TV^0.5)
                      Centre.Mass &lt;- (Center.Of.Mass.Y.SV1 + Center.Of.Mass.Y.SV2) / 2
                      Compactness.SV = (Compactness.SV1 + Compactness.SV2) / 2
                    })
responses &lt;- c("PSA","PSA.SV","PSA.TV", "Image.Biomass", "Max.Height","Centre.Mass",
               "Density", "Compactness.TV", "Compactness.SV")
results &lt;-  intervalPVA(longi.dat, responses, times = "DAP", 
                        start.time = "31", end.time = "31",
                        p.variance=0.9, plot = FALSE)
</code></pre>

<hr>
<h2 id='intervalValueCalculate'>Calculates a single value that is a function of an individual's values for a response over a specified time interval</h2><span id='topic+intervalValueCalculate'></span>

<h3>Description</h3>

<p>Splits the values of a response into subsets corresponding 
individuals and applies a function that calculates a single 
value from each individual's observations during a specified 
time interval.  It includes the ability to calculate the 
observation number that is closest to the calculated value of 
the function and the assocated values of a <code><a href="base.html#topic+factor">factor</a></code> or 
<code>numeric</code>.
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+byIndv4Intvl_ValueCalc">byIndv4Intvl_ValueCalc</a></code>.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intervalValueCalculate(response, weights=NULL, individuals = "Snapshot.ID.Tag",
                       FUN = "max", which.obs = FALSE, which.values = NULL, 
                       times = "Days", start.time=NULL, end.time=NULL, 
                       suffix.interval=NULL, data, sep=".", na.rm=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervalValueCalculate_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> from which the values of <code>FUN</code> are to be  calculated.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_weights">weights</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the weights to be supplied as <code>w</code> 
to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_fun">FUN</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the <code>function</code> 
that calculates the value for each subset.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_which.obs">which.obs</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to determine 
the observation number corresponding to the observed value that is 
closest to the value of the function, in addition to the value of 
the function itself. That is, <code>FUN</code> need not return an observed 
value of the <code>reponse</code>, e.g. <code>quantile</code>.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_which.values">which.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+numeric">numeric</a></code> whose values are 
associated with the <code>response</code> values and whose value is to be 
returned for the observation number whose <code>response</code> value 
corresponds to the observed value closest to the value of the 
function. That is, <code>FUN</code> need not return an observed value of 
the <code>reponse</code>, e.g. <code>quantile</code>. In the case of multiple 
observed response values satisfying this condition, the value of 
the <code>which.values</code> vector for the first of these is 
returned.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used in calculating growth rates and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, 
in terms of levels of <code>times.factor</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will 
be taken as the observation at the start of the interval for 
which a value is to be calculated. If 
<code>start.time</code> is <code>NULL</code>, the interval will start 
with the first observation. In the case of multiple 
observed response values satisfying this condition, the first is 
returned.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times,
in terms of levels of <code>times.factor</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will be 
taken as the observation at the end of the interval for which 
a value is to be calculated. If <code>end.time</code> is 
<code>NULL</code>, the interval will end with the last observation.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to <code>response</code> to form the 
name of the column containing the calculated values. If it is
<code>NULL</code> then nothing will be appended.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
function is to be calculated.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code>  indicating whether <code>NA</code> values 
should be stripped before the calculation proceeds.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_sep">sep</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use when the 
levels of <code>individuals</code> are combined. This is needed to avoid 
using a <code><a href="base.html#topic+character">character</a></code> that occurs in a <code><a href="base.html#topic+factor">factor</a></code> to delimit 
levels when the levels of <code>individuals</code> are combined to 
identify subsets.</p>
</td></tr>
<tr><td><code id="intervalValueCalculate_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>, with the same number of rows as there are 
<code>individuals</code>, containing a column for the <code>individuals</code> and 
a column with the values of the function for the <code>individuals</code>. 
It is also possible to determine observaton numbers or the values of 
another column in <code>data</code> for the <code>response</code> values that are 
closest to the <code>FUN</code> results, using either or both of 
<code>which.obs</code> and <code>which.values</code>. If <code>which.obs</code> is 
<code>TRUE</code>, a column with observation numbers is included in the  
<code><a href="base.html#topic+data.frame">data.frame</a></code>. 
If <code>which.values</code> is set to the name of a <code><a href="base.html#topic+factor">factor</a></code> or 
a <code><a href="base.html#topic+numeric">numeric</a></code>,a column containing the levels of that 
<code><a href="base.html#topic+factor">factor</a></code> or the values of that <code><a href="base.html#topic+numeric">numeric</a></code> is 
included in the  <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>
<p>The name of the column with the values of the function will be result of 
concatenating the <code>response</code>, <code>FUN</code> and, if it is not 
<code>NULL</code>, <code>suffix.interval</code>, each separated by a full stop. 
If <code>which.obs</code> is <code>TRUE</code>, the column name for the obervations 
numbers will have <code>.obs</code> added after <code>FUN</code> into the column name 
for the function values; if <code>which.values</code> is specified, 
the column name for these values will have a full stop followed by 
<code>which.values</code> added after <code>FUN</code> into the column name 
for the function values.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+intervalGRaverage">intervalGRaverage</a></code>, <code><a href="#topic+intervalGRdiff">intervalGRdiff</a></code>, <code><a href="#topic+intervalWUI">intervalWUI</a></code>, <code><a href="#topic+splitValueCalculate">splitValueCalculate</a></code>, <code><a href="#topic+getTimesSubset">getTimesSubset</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
sPSA.max &lt;- intervalValueCalculate(response = "sPSA", times = "DAP",  
                                   start.time = 31, end.time = 35, 
                                   suffix.interval = "31to35",
                                   data = longi.dat)
AGR.max.dat &lt;- intervalValueCalculate(response = "sPSA.AGR", times = "DAP", 
                                      FUN="max", 
                                      start.time = 31, end.time = 35, 
                                      suffix.interval = "31to35",
                                      which.values = "DAP", which.obs = TRUE, 
                                      data=longi.dat)
</code></pre>

<hr>
<h2 id='intervalWUI'>Calculates water use indices (WUI) over a specified time interval to a 
data.frame</h2><span id='topic+intervalWUI'></span>

<h3>Description</h3>

<p>Calculates the Water Use Index (WUI) between two time points 
for a set of responses.
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+byIndv4Intvl_WaterUse">byIndv4Intvl_WaterUse</a></code>.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intervalWUI(responses, water.use = "Water.Use", 
            individuals = "Snapshot.ID.Tag", times = "Days", 
            start.time, end.time, suffix.interval = NULL, 
            data, include.total.water = FALSE, na.rm = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervalWUI_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> from which the growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_water.use">water.use</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the column in 
<code>data</code> which contains the water use values.</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used identifying the intervals and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times,
in terms of values in <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will 
be taken as the observation at the start of the interval for 
which the WUI is to be calculated.</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, 
in terms of values <code>times</code>, that will give a 
single value for each <code>Snapshot.ID.Tag</code> and that will be 
taken as the observation at the end of the interval for which 
the WUI is to be calculated.</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to <code>response</code> to form the names of the columns 
containing the calculated the growth rates.</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_include.total.water">include.total.water</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to 
include a column in the results for the total of <code>water.use</code> 
for the interval for each individual.</p>
</td></tr>
<tr><td><code id="intervalWUI_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code>  indicating whether <code>NA</code> values 
should be stripped before the calculation proceeds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The WUI is calculated as the difference between the values of a <code>response</code> 
at the <code>end.time</code>  and <code>start.time</code> divided by the sum of the water use  
after <code>start.time</code> until <code>end.time</code>. Thus, the water use up to
<code>start.time</code> is not included.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the WUIs, the name of each 
column being the concatenation of one of <code>responses</code>,  
<code>WUI</code> and, if not <code>NULL</code>, <code>suffix.interval</code>, the three 
components being separated by a full stop. If the total water is to be 
included, the name of the column will be the concatenation of 
<code>water.use</code>, <code>Total</code> and the suffix, each separated by a full
stop(&lsquo;.&rsquo;).</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+intervalGRaverage">intervalGRaverage</a></code>, <code><a href="#topic+intervalGRdiff">intervalGRdiff</a></code>, <code><a href="#topic+splitValueCalculate">splitValueCalculate</a></code>, <code><a href="#topic+getTimesSubset">getTimesSubset</a></code>, 
<code><a href="#topic+GrowthRates">GrowthRates</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
PSA.WUI &lt;- intervalWUI(response = "PSA", water.use = "WU", 
                       times = "DAP", start.time = 31, end.time = 35, 
                       suffix = "31to35", 
                       data = longi.dat, include.total.water = TRUE)
</code></pre>

<hr>
<h2 id='is.smooths.frame'>Tests whether an object is of class smooths.frame</h2><span id='topic+is.smooths.frame'></span>

<h3>Description</h3>

<p>A single-line <code>function</code> that tests whether an object is of <code>class</code> <code><a href="#topic+smooths.frame">smooths.frame</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.smooths.frame(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.smooths.frame_+3A_object">object</code></td>
<td>
<p>An <code>object</code> to be tested.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>logical</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+validSmoothsFrame">validSmoothsFrame</a></code>, <code><a href="#topic+as.smooths.frame">as.smooths.frame</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- read.table(header = TRUE, text = "
Type TunePar TuneVal Tuning Method       ID  DAP   PSA      sPSA
NCSS      df       4   df-4 direct 045451-C   28 57.446 51.18456
NCSS      df       4   df-4 direct 045451-C   30 89.306 87.67343
NCSS      df       7   df-7 direct 045451-C   28 57.446 57.01589
NCSS      df       7   df-7 direct 045451-C   30 89.306 87.01316
")
dat[1:7] &lt;- lapply(dat[1:7], factor)
dat &lt;- as.smooths.frame(dat, individuals = "ID", times = "DAP")
is.smooths.frame(dat)
validSmoothsFrame(dat)
</code></pre>

<hr>
<h2 id='longitudinalPrime'>Selects a set variables to be retained in a data frame of longitudinal data</h2><span id='topic+longitudinalPrime'></span>

<h3>Description</h3>

<p>Forms the prime traits by selecting a subset of the traits in a data.frame of 
imaging data produced by the Lemna Tec Scanalyzer. The imaging traits to be retained 
are specified using the <code>traits</code> and <code>labsCamerasViews</code> arguments. Some imaging 
traits are divided by 1000 to convert them from pixels to kilopixels. 
Also added are <code><a href="base.html#topic+factor">factor</a></code>s and explanatory variates that might be of use in an analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>longitudinalPrime(data, cartId = "Snapshot.ID.Tag", 
                  imageTimes = "Snapshot.Time.Stamp", 
                  timeAfterStart = "Time.after.Planting..d.",
                  PSAcolumn = "Projected.Shoot.Area..pixels.", 
                  idcolumns = c("Genotype.ID","Treatment.1"), 
                  traits = list(all = c("Area", 
                                        "Boundary.Points.To.Area.Ratio", 
                                        "Caliper.Length", "Compactness", 
                                        "Convex.Hull.Area"), 
                                 side = c("Center.Of.Mass.Y", 
                                          "Max.Dist.Above.Horizon.Line")),
                  labsCamerasViews = list(all = c("SV1", "SV2", "TV"),
                                          side = c("SV1", "SV2")), 
                  smarthouse.lev = NULL, 
                  calcWaterLoss = TRUE, pixelsPERcm)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="longitudinalPrime_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns specified by <code>cartId</code>, 
<code>imageTimes</code>, <code>timeAfterStart</code>, <code>PSAcolumn</code> <code>idcolumns</code>, <code>traits</code> and 
<code>cameras</code> along with  the following columns: 
</p>
<p>Smarthouse, Lane, Position, Weight.Before, Weight.After, Water.Amount, 
</p>
<p>Projected.Shoot.Area..pixels.
</p>
<p>The defaults for the arguments to <code>longitudinalPrime</code> requires a 
<code><a href="base.html#topic+data.frame">data.frame</a></code> containing the following columns, although not necessarily 
in the order given here:
</p>
<p>Smarthouse, Lane, Position, Weight.Before, Weight.After, Water.Amount, 
</p>
<p>Projected.Shoot.Area..pixels., Area.SV1, Area.SV2, Area.TV, 
</p>
<p>Boundary.Points.To.Area.Ratio.SV1, Boundary.Points.To.Area.Ratio.SV2, 
</p>
<p>Boundary.Points.To.Area.Ratio.TV,  Caliper.Length.SV1, 
</p>
<p>Caliper.Length.SV2, Caliper.Length.TV, 
</p>
<p>Compactness.SV1, Compactness.SV2, Compactness.TV, 
</p>
<p>Convex.Hull.Area.SV1, Convex.Hull.Area.SV2, Convex.Hull.Area.TV, 
</p>
<p>Center.Of.Mass.Y.SV1, Center.Of.Mass.Y.SV2, 
</p>
<p>Max.Dist.Above.Horizon.Line.SV1, Max.Dist.Above.Horizon.Line.SV2.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_cartid">cartId</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that contains
the unique Id for each cart.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_imagetimes">imageTimes</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that contains
the time that each cart was imaged.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_timeafterstart">timeAfterStart</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that 
contains the time after some nominated starting time e.g. the number of days 
after planting.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_psacolumn">PSAcolumn</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that 
contains the projected shoot area.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_idcolumns">idcolumns</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the names of the columns that 
identify differences between the plants or carts e.g. Genotype.ID, 
Treatment.1, Treatment.2.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_traits">traits</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> or a <code><a href="base.html#topic+list">list</a></code> whose components are  
<code><a href="base.html#topic+character">character</a></code>s. Each <code><a href="base.html#topic+character">character</a></code> gives the names of the 
columns for imaging <code>traits</code> whose values are required for each of the 
camera-view combinations given in the corresponding <code><a href="base.html#topic+list">list</a></code> 
component of <code>labsCamerasViews</code>. If <code>labsCamerasViews</code> or a 
component of <code>labsCamerasViews</code> is <code>NULL</code>, then the contents of 
<code>traits</code> or the coresponding component of <code>traits</code> are merely 
treated as the names of columns to be retained.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_labscamerasviews">labsCamerasViews</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> or a <code><a href="base.html#topic+list">list</a></code> whose components are  
<code><a href="base.html#topic+character">character</a></code>s. Each <code><a href="base.html#topic+character">character</a></code> gives the labels of the  
camera-view combinations for which is required values of each of the imaging 
<code>traits</code> in the corresponding <code><a href="base.html#topic+character">character</a></code> of <code>traits</code>. 
It is assumed that the camera-view labels are appended to the trait names and 
separated from the trait names by a full stop (.). If <code>labsCamerasViews</code> 
or a component of <code>labsCamerasViews</code> is <code>NULL</code>, then the contents 
of the <code>traits</code> or the coresponding component of <code>traits</code> are 
merely treated as the names of columns to be retained.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_smarthouse.lev">smarthouse.lev</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the levels to use 
for the Smarthouse <code><a href="base.html#topic+factor">factor</a></code>. If <code>NULL</code> then the unique values in Smarthouse 
will be used.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_calcwaterloss">calcWaterLoss</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether to calculate the Water.Loss. If it is 
<code>FALSE</code>, <code>Water.Before</code>, <code>Water.After</code> and <code>Water.Amount</code> will not be in 
the returned <code><a href="base.html#topic+data.frame">data.frame</a></code>. They can be copied across by listing them in a component 
of <code>traits</code> and set the corresponding component of <code>cameras</code> to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="longitudinalPrime_+3A_pixelspercm">pixelsPERcm</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of pixels per cm 
for the images. <em>No longer used.</em></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The columns are copied from data, except for those columns in the list under <b>Value</b> that have &lsquo;(calculated)&rsquo; appended.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns specified by <code>cartId</code>, 
<code>imageTimes</code>, <code>timeAfterStart</code>, <code>idcolumns</code>, <code>traits</code> and 
<code>cameras</code>. The defaults will result in the following columns:
</p>

<ol>
<li><p> Smarthouse: <code><a href="base.html#topic+factor">factor</a></code> with levels for the Smarthouse
</p>
</li>
<li><p> Lane: <code><a href="base.html#topic+factor">factor</a></code> for lane number in a smarthouse
</p>
</li>
<li><p> Position: <code><a href="base.html#topic+factor">factor</a></code> for east/west position in a lane
</p>
</li>
<li><p> Days: <code><a href="base.html#topic+factor">factor</a></code> for the number of Days After Planting (DAP)
</p>
</li>
<li> <p><code>cartId</code>: unique code for each cart 
</p>
</li>
<li> <p><code>imageTimes</code>: time at which an image was taken in POSIXct format
</p>
</li>
<li><p> Reps: <code><a href="base.html#topic+factor">factor</a></code> indexing the replicates for each combination of the <code><a href="base.html#topic+factor">factor</a></code>s in <code>idcolumns</code> (calculated)
</p>
</li>
<li><p> xPosn: numeric for the Positions within a Lane (calculated)
</p>
</li>
<li><p> Hour: hour of the day, to 2 decimal places, at which the image was taken (calculated)
</p>
</li>
<li><p> xDays: numeric for the DAP that is centred by subtracting the mean of the unique days (calculated)
</p>
</li>
<li> <p><code>idcolumns</code>: the columns listed in <code>idcolumns</code> that have been converted to <code><a href="base.html#topic+factor">factor</a></code>s
</p>
</li>
<li><p> Weight.Before: weight of the pot before watering (only if <code>calcWaterLoss</code> is <code>TRUE</code>)
</p>
</li>
<li><p> Weight.After: weight of the pot after watering (only if <code>calcWaterLoss</code> is <code>TRUE</code>)
</p>
</li>
<li><p> Water.Amount: the weight of the water added (= Water.After - Water.Before)  (calculated)
</p>
</li>
<li><p> Water.Loss: the difference between Weight.Before for the current imaging and the Weight.After for the previous imaging (calculated unless <code>calcWaterLoss</code> is <code>FALSE</code>)
</p>
</li>
<li><p> Area: the Projected.Shoot.Area..pixels. divided by 1000 (calculated)
</p>
</li>
<li><p> Area.SV1: the Projected.Shoot.Area from Side View 1 divided by 1000 (calculated)
</p>
</li>
<li><p> Area.SV2: the Projected.Shoot.Area from Side View 2 divided by 1000 (calculated)
</p>
</li>
<li><p> Area.TV: the Projected.Shoot.Area from Top View divided by 1000 (calculated)
</p>
</li>
<li><p> Boundary.To.Area.Ratio.SV1 
</p>
</li>
<li><p> Boundary.To.Area.Ratio.SV2 
</p>
</li>
<li><p> Boundary.To.Area.Ratio.TV 
</p>
</li>
<li><p> Caliper.Length.SV1 
</p>
</li>
<li><p> Caliper.Length.SV2 
</p>
</li>
<li><p> Caliper.Length.TV
</p>
</li>
<li><p> Compactness.SV1 from Side View 1
</p>
</li>
<li><p> Compactness.SV2 from Side View 2
</p>
</li>
<li><p> Compactness.TV: from Top View 
</p>
</li>
<li><p> Convex.Hull.Area.SV1: area of Side View 1 Convex Hull divided by 1000 (calculated)
</p>
</li>
<li><p> Convex.Hull.Area.SV2: area of Side View 2 Convex Hull divided by 1000 (calculated)
</p>
</li>
<li><p> Convex.Hull.TV: Convex.Hull.Area.TV divided by 1000 (calculated)
</p>
</li>
<li><p> Center.Of.Mass.Y.SV1: Centre of Mass from Side View 1
</p>
</li>
<li><p> Center.Of.Mass.Y.SV2: Centre of Mass from Side View 2
</p>
</li>
<li><p> Max.Dist.Above.Horizon.Line.SV1: the Max.Dist.Above.Horizon.Line.SV1 converted to cm using <code>pixelsPERcm</code> (calculated)
</p>
</li>
<li><p> Max.Dist.Above.Horizon.Line.SV2: the Max.Dist.Above.Horizon.Line.SV2 converted to cm using <code>pixelsPERcm</code> (calculated)
</p>
</li></ol>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longiPrime.dat &lt;- longitudinalPrime(data=raw.dat, smarthouse.lev=1)

longiPrime.dat &lt;- longitudinalPrime(data=raw.dat, smarthouse.lev=1, 
                                    traits = list(a = "Area", c = "Compactness"),
                                    labsCamerasViews = list(all = c("SV1", "SV2", "TV"), 
                                                            t = "TV"))

longiPrime.dat &lt;- longitudinalPrime(data=raw.dat, smarthouse.lev=1, 
                                    traits = c("Area.SV1", "Area.SV2", "Area.TV", 
                                               "Compactness.TV"),
                                    labsCamerasViews = NULL)

longiPrime.dat &lt;- longitudinalPrime(data=raw.dat, smarthouse.lev=1, 
                                    calcWaterLoss = FALSE, 
                                    traits = list(img = c("Area", "Compactness"), 
                                                  H20 = c("Weight.Before","Weight.After",
                                                          "Water.Amount")),
                                    labsCamerasViews = list(all = c("SV1", "SV2", "TV"), 
                                                            H2O = NULL))
</code></pre>

<hr>
<h2 id='plotAnom'>Identifies anomalous individuals and produces profile plots without them and with just them</h2><span id='topic+plotAnom'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+byIndv4Intvl_ValueCalc">byIndv4Intvl_ValueCalc</a></code> and the function 
<code><a href="#topic+anom">anom</a></code> to identify anomalous individuals in longitudinal 
data. The user can elect to print the anomalous individuals, a 
profile plot without the anomalous individuals and/or a profile plot 
with only the anomalous individuals. The plots are produced using 
<code>ggplot</code>. The plot can be facettd so that a grid of plots is 
produced. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAnom(data, response="sPSA", 
         individuals="Snapshot.ID.Tag", 
         times = "DAP", x = NULL, 
         breaks.spacing.x = -2, angle.x = 0, 
         vertical.line=NULL, 
         groupsFactor=NULL, lower=NULL, upper=NULL, 
         start.time=NULL, end.time=NULL, 
         suffix.interval=NULL, 
         columns.retained=c("Snapshot.ID.Tag", "Smarthouse", "Lane", 
                            "Position", "Treatment.1", "Genotype.ID"),
         whichPrint=c("anomalous","innerPlot","outerPlot"), na.rm=TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAnom_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the data to be tested 
and plotted.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_response">response</code></td>
<td>
<p>A <code>character</code> specifying the response variable that 
is to be tested and plotted on the y-axis.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was collected, 
either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. If not a <code><a href="base.html#topic+numeric">numeric</a></code>, it will be 
converted to a <code><a href="base.html#topic+numeric">numeric</a></code> and used to provide the values 
to be plotted on the x-axis. If a <code><a href="base.html#topic+factor">factor</a></code> or 
<code><a href="base.html#topic+character">character</a></code>, the values should be numerics stored as 
characters.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying a variable, or a function of 
variables, to be plotted on the x-axis. If <code>NULL</code>, it will be 
set to the value of <code>times</code>, which it can be assumed will be 
converted to a <code><a href="base.html#topic+numeric">numeric</a></code>.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_breaks.spacing.x">breaks.spacing.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> whose absolute values specifies the 
distance between major breaks for the x-axis in a sequence beginning with the 
minimum x value and continuing up to the maximum x value. If it is negative, 
the breaks that do not have x values in <code>data</code> will be omitted. 
Minor breaks will be at half major break value or, if these do not correspond to 
x-values in <code>data</code> when <code>breaks.spacing.x</code> is negative, have 
a spacing of one. Thus, when <code>breaks.spacing.x</code> is negative,  
grid lines will only be included for x-values that occur in <code>data</code>.  
These settings can be overwritten by supplying, in <code>ggplotFuncs</code>, 
a <code>scale_x_continuous</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_angle.x">angle.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 360 that gives the angle of the 
x-axis text to the x-axis. It can also be set by supplying, in 
<code>ggplotFuncs</code>, a <code>theme</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_vertical.line">vertical.line</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving position on the x-axis 
at which a vertical line is to be drawn. If <code>NULL</code>, 
no line is drawn.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_groupsfactor">groupsFactor</code></td>
<td>
<p>A <code><a href="base.html#topic+factor">factor</a></code> giving the name of a 
<code><a href="base.html#topic+factor">factor</a></code> that defines groups of individuals between which the 
test for anomalous individuals can be varied by setting values for 
one or more of <code>lower</code>, <code>upper</code>, <code>start.time</code> and 
<code>end.time</code> to be <code>NULL</code>, a single value or a set of values whose number 
equals the number of levels of <code>groupsFactor</code>. If <code>NULL</code> or 
only a dingle value is supplied, 
the test is the same for all individuals.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_lower">lower</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> such that values in <code>response</code> below 
it are  considered to be anomalous. If <code>NULL</code>, there is no 
testing for values below the lower bound.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_upper">upper</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> such that values in <code>response</code> above 
it are  considered to be anomalous. If <code>NULL</code>, there is no
testing for values above the upper bound.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_start.time">start.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the start of the time interval, 
in terms of a level of <code>times</code>, 
during which testing for anomalous values is to occur. 
If <code>NULL</code>, the interval will start with the first 
observation.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_end.time">end.time</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the end of the time interval, 
in terms of a level of <code>times</code>, 
during which testing for anomalous values is to occur.
If <code>NULL</code>, the interval will end with the last 
observation.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_suffix.interval">suffix.interval</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be 
appended to <code>response</code> to form the 
name of the column containing the calculated values. If it is
<code>NULL</code> then nothing will be appended.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_columns.retained">columns.retained</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the 
columns in <code>data</code> that are to be retained in the 
<code>data.frame</code> of anomalous individuals.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_whichprint">whichPrint</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> indicating what is to be printed. 
If <code>anomalous</code> is included, the <code>columns.retained</code> 
are printed for the anomalous individuals.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether <code>NA</code> values should 
be stripped before the testing proceeds.</p>
</td></tr>
<tr><td><code id="plotAnom_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code><a href="#topic+plotLongitudinal">plotLongitudinal</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> with three components: 
</p>

<ol>
<li> <p><code>data</code>, a data frame resulting from the <code><a href="base.html#topic+merge">merge</a></code> 
of <code>data</code> and the <code><a href="base.html#topic+logical">logical</a></code> identifying whether 
or not an individual is anomalous; 
</p>
</li>
<li> <p><code>innerPlot</code>, an object of class <code>ggplot</code> storing the 
profile plot of the individuals that are not anomalous; 
</p>
</li>
<li> <p><code>outerPlot</code>, an object of class <code>ggplot</code> storing the 
profile plot of only the individuals that are anomalous.</p>
</li></ol>
 
<p>The name of the column indicating anomalous individuals will be result of 
concatenating the <code>response</code>, <code><a href="#topic+anom">anom</a></code> and, if it is not 
<code>NULL</code>,  <code>suffix.interval</code>, each separated by a full stop. 
The <code>ggplot</code> objects can be plotted using <code>print</code> and can be 
modified by adding <code>ggplot</code> functions before printing. If there are 
no observations to plot, <code>NULL</code> will be returned for the plot.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+anom">anom</a></code>, <code><a href="#topic+byIndv4Intvl_ValueCalc">byIndv4Intvl_ValueCalc</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
anomalous &lt;- plotAnom(longi.dat, response="sPSA.AGR", 
                      times = "xDAP", 
                      lower=2.5, start.time=40, 
                      vertical.line=29, 
                      breaks.spacing.x = 2, 
                      whichPrint=c("innerPlot"), 
                      y.title="sPSA AGR")
</code></pre>

<hr>
<h2 id='plotCorrmatrix'>Calculates and plots correlation matrices for a set of responses</h2><span id='topic+plotCorrmatrix'></span>

<h3>Description</h3>

<p>Having calculated the correlations a heat map indicating the magnitude of the 
correlations is produced using <code>ggplot</code>. In this heat map, the darker the red in 
a cell then the closer the correlation is to -1, while the deeper the blue in the cell,
then the closer the correlation is to 1. A matrix plot of all pairwise 
combinations of the variables can be produced. The matrix plot contains a scatter diagram 
for each pair, as well as the value of the correlation coefficient. The argument 
<code>pairs.sets</code> can be used to restrict the pairs in the matrix plot to those 
combinations within each set. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCorrmatrix(data, responses, which.plots = c("heatmap","matrixplot"), 
               title = NULL, labels = NULL, labelSize = 4, pairs.sets = NULL, 
               show.sig = FALSE, axis.text.size = 20, ggplotFuncs = NULL, 
               printPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCorrmatrix_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns of variables to be correlated.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> containing the variables to be correlated.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_which.plots">which.plots</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the plots of the correlations to be 
produced. The possibilities are one or both of <code>heatmap</code> and 
<code>matrixplot</code>.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_title">title</code></td>
<td>
<p>Title for the plots.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_labels">labels</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the labels to be used in the plots. 
If <code>labels</code> is <code>NULL</code>, <code>responses</code> is used for the <code>labels</code>.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_labelsize">labelSize</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the size of the <code>labels</code> in the 
<code>matrixplot</code>.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_pairs.sets">pairs.sets</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> each of whose components is a <code><a href="base.html#topic+numeric">numeric</a></code> giving 
the position of the variable names in <code>responses</code> that are to be included 
in the set. All pairs of variables in this pairs.set will be included in a 
<code>matrixplot</code>.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_show.sig">show.sig</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to give asterisks on the 
<code>heatmap</code> indicating the correlations are significantly different from zero.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_axis.text.size">axis.text.size</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the size of the <code>labels</code> on the axes   
of the <code>heatmap</code>.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> object.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print the 
plot.</p>
</td></tr>
<tr><td><code id="plotCorrmatrix_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The correlations and their p-values are producced using <code><a href="Hmisc.html#topic+rcorr">rcorr</a></code> 
from the <code>Hmisc</code> package. The <code>heatmap</code> is produced using 
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> and the matrixplot is produced using <code>GGally</code>.
</p>


<h3>Value</h3>

<p>The <code>heatmap</code> plot, if produced, as an object of class &quot;<code>ggplot</code>&quot;, which 
can be plotted using <code>print</code>; otherwise <code>NULL</code> is returned.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="Hmisc.html#topic+rcorr">rcorr</a></code>, <code>GGally</code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(exampleData)
longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1)
longi.dat &lt;- within(longi.dat, 
                    {
                      Max.Height &lt;- pmax(Max.Dist.Above.Horizon.Line.SV1,  
                                         Max.Dist.Above.Horizon.Line.SV2)
                      Density &lt;- PSA/Max.Height
                      PSA.SV = (PSA.SV1 + PSA.SV2) / 2
                      Image.Biomass = PSA.SV * (PSA.TV^0.5)
                      Centre.Mass &lt;- (Center.Of.Mass.Y.SV1 + Center.Of.Mass.Y.SV2) / 2
                      Compactness.SV = (Compactness.SV1 + Compactness.SV2) / 2
                    })
responses &lt;- c("PSA","PSA.SV","PSA.TV", "Image.Biomass", "Max.Height","Centre.Mass",
               "Density", "Compactness.TV", "Compactness.SV")
plotCorrmatrix(longi.dat, responses, pairs.sets=list(c(1:4),c(5:7)))

</code></pre>

<hr>
<h2 id='plotDeviationsBoxes'>Produces boxplots of the deviations of the observed values from the smoothed values over values of x.</h2><span id='topic+plotDeviationsBoxes'></span>

<h3>Description</h3>

<p>Produces boxplots of the deviations of the observed values from the smoothed values over values of x.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDeviationsBoxes(data, observed, smoothed, x.factor, 
                    x.title = NULL, y.titles = NULL,
                    facet.x = ".", facet.y = ".", 
                    facet.labeller = NULL, 
                    facet.scales = "fixed", 
                    angle.x = 0, 
                    deviations.plots = "absolute", 
                    ggplotFuncs = NULL, printPlot = TRUE, ...)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDeviationsBoxes_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the observed and smoothed values 
from which the deviations are to be computed.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_observed">observed</code></td>
<td>
<p>A <code>character</code> specifying the response variable for which the 
observed values are supplied.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_smoothed">smoothed</code></td>
<td>
<p>A <code>character</code> specifying the smoothed response variable, 
corresponding to <code>observed</code>, for which values are supplied.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_x.factor">x.factor</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code><a href="base.html#topic+factor">factor</a></code> to be 
plotted on the x-axis.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis. If <code>NULL</code> then set to <code>x</code>.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_y.titles">y.titles</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the titles for the y-axis, 
one for each plot specified <code>deviations.plots</code>.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate columns of plots. 
Use <code>"."</code> if a split into columns is not wanted. For 
<code>which.plots</code> set to <code>methodcompare</code> or <code>dfcompare</code> 
<code>facet.x.pf</code> is ignored.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate rows of plots.
Use <code>"."</code> if a split into columns is not wanted.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_facet.labeller">facet.labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_facet.scales">facet.scales</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying whether the scales are shared 
across all facets of a plot (&quot;fixed&quot;), or do they vary across rows (the 
default, &quot;free_x&quot;), columns (&quot;free_y&quot;), or both rows and columns (&quot;free&quot;)?</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_angle.x">angle.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 360 that gives the angle of the 
x-axis text to the x-axis. It can also be set by supplying, in 
<code>ggplotFuncs</code>, a <code>theme</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_deviations.plots">deviations.plots</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying whether 
<code>absolute</code> and/or <code>relative</code> deviations are to be plotted.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> object for plotting.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print the 
plots.</p>
</td></tr>
<tr><td><code id="plotDeviationsBoxes_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list whose components are named <code>absolute</code> and <code>relative</code>; a 
component will contain an object of class &quot;<code>ggplot</code>&quot; when the plot has been 
requested using the <code>deviations.plots</code> argument and a <code>NULL</code> otherwise. 
The objects can be plotted using <code>print</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotMedianDeviations">plotMedianDeviations</a></code>, <code><a href="#topic+probeSmoothing">probeSmoothing</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)

plotDeviationsBoxes(longi.dat, observed = "PSA", smoothed = "sPSA",
                    x.factor="DAP", facet.x.pf = ".", facet.y= ".", df =5)
</code></pre>

<hr>
<h2 id='plotImagetimes'>Plots the position of a time within an interval against the interval for each cart</h2><span id='topic+plotImagetimes'></span>

<h3>Description</h3>

<p>Uses <code>ggplot</code> to produce a plot of the time position within an interval
against the interval. For example, one might plot the hour of the day carts 
are imaged against the days after planting (or some other number of 
days after an event). A line is produced for each value of <code>groupVariable</code> 
and the colour is varied according to the value of the <code>colourVariable</code>. 
Each <code>Smarthouse</code> is plotted separately. It aids in checking 
whether delays  occurred in imaging the plants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotImagetimes(data, intervals = "Time.after.Planting..d.", timePositions = "Hour", 
               groupVariable = "Snapshot.ID.Tag", colourVariable = "Lane", 
               ggplotFuncs = NULL, printPlot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotImagetimes_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing any columns specified by 
<code>intervals</code>, <code>timePositions</code>, <code>groupVariable</code> and 
<code>colourVariable</code>.</p>
</td></tr>
<tr><td><code id="plotImagetimes_+3A_intervals">intervals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in <code>data</code>
containing, as a <code><a href="base.html#topic+numeric">numeric</a></code> or a <code><a href="base.html#topic+factor">factor</a></code>, 
the calculated times to be plotted on the x-axis.  For example, it could be the 
days after planting or treatment.</p>
</td></tr>
<tr><td><code id="plotImagetimes_+3A_timepositions">timePositions</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of  the column in 
<code>data</code> containing, as a <code><a href="base.html#topic+numeric">numeric</a></code>, the value of the 
time position within an interval (for example, the time of imaging during the day 
expressed in hours plus a fraction of an hour).</p>
</td></tr>
<tr><td><code id="plotImagetimes_+3A_groupvariable">groupVariable</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of  the column in 
<code>data</code> containing the variable to be used to group the 
plotting.</p>
</td></tr>
<tr><td><code id="plotImagetimes_+3A_colourvariable">colourVariable</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of  the column 
in <code>data</code> containing the variable to be used to colour 
the plotting.</p>
</td></tr>
<tr><td><code id="plotImagetimes_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> object.</p>
</td></tr>
<tr><td><code id="plotImagetimes_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print the 
plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>ggplot</code>&quot;, which can be plotted using <code>print</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+calcTimes">calcTimes</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
library(ggplot2)
longi.dat &lt;- calcTimes(longi.dat, imageTimes = "Snapshot.Time.Stamp",
                       timePositions = "Hour")
plotImagetimes(data = longi.dat, intervals = "DAP", timePositions = "Hour",
               ggplotFuncs=list(scale_colour_gradient(low="grey20", high="black"), 
                                geom_line(aes(group=Snapshot.ID.Tag, colour=Lane))))

</code></pre>

<hr>
<h2 id='plotLongitudinal'>Produces profile plots of longitudinal data for a set of individuals</h2><span id='topic+plotLongitudinal'></span>

<h3>Description</h3>

<p>Produce profile plots of longitudinal data for a response using <code>ggplot</code>. 
A line is drawn for the data for each <code>individual</code> and the plot 
can be faceted so that a grid of plots is produced. For each facet a line for 
the medians over time can be added, along with the vaue of the outer whiskers 
(median +/- 1.5 * IQR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLongitudinal(data, x = "xDays+44.5", response = "Area", 
                 individuals = "Snapshot.ID.Tag", title = NULL, 
                 x.title = "Days", y.title = "Area (kpixels)", 
                 facet.x = ".", facet.y = ".", 
                 labeller = NULL, colour = "black", 
                 colour.column = NULL, colour.values = NULL, 
                 alpha = 0.1, addMediansWhiskers = FALSE, 
                 xname = "xDays", ggplotFuncs = NULL, 
                 printPlot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLongitudinal_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the data to be plotted.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the variable to be plotted on the x-axis.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_response">response</code></td>
<td>
<p>A <code>character</code> specifying the response variable that 
is to be plotted on the y-axis.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_y.title">y.title</code></td>
<td>
<p>Title for the y-axis.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_title">title</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate columns of plots. 
Use <code>"."</code> if a split into columns is not wanted.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate rows of plots.
Use <code>"."</code> if a split into rows is not wanted.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_labeller">labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_colour">colour</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying a single colour to use in 
drawing the lines for the profiles. If colouring according to the 
values of a variable is required then use <code>colour.column</code>.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_colour.column">colour.column</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of a column 
in <code>data</code> over whose values the colours of the lines are to be 
varied. The colours can be specified using <code>colour.values</code>.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_colour.values">colour.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector specifying the values of 
the colours to use in drawing the lines for the profiles.  
If this is a named vector, then the values will be matched based 
on the names. If unnamed, values will be matched in order 
(usually alphabetical) with the limits of the scale.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_alpha">alpha</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the degrees of transparency to 
be used in plotting. It is a ratio in which the denominator 
specifies the number of points (or lines) that must be overplotted 
to give a solid cover.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_addmedianswhiskers">addMediansWhiskers</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether plots over 
time of the medians and outer whiskers are to be added to the plot. 
The outer whiskers are related to the whiskers on a box-and-whisker 
and are defined as the median plus (and minus) 1.5 times the 
interquartile range (IQR). Points lying outside the whiskers are 
considered to be potential outliers.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_xname">xname</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the
<code><a href="base.html#topic+numeric">numeric</a></code> that contains the values of the predictor 
variable from which <code>x</code> is derived, it being that <code>x</code> 
may incorporate an expression.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> object.</p>
</td></tr>
<tr><td><code id="plotLongitudinal_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print the 
plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>&quot;, which can be plotted using 
<code>print</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="ggplot2.html#topic+labeller">labeller</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
plotLongitudinal(data = longi.dat, x = "xDAP", response = "sPSA")

plt &lt;- plotLongitudinal(data = longi.dat, x = "xDAP", response = "sPSA", 
                        x.title = "DAP",  y.title = "sPSA (kpixels)", 
                        facet.x = "Treatment.1", facet.y = "Smarthouse", 
                        printPlot=FALSE)
plt &lt;- plt + ggplot2::geom_vline(xintercept=29, linetype="longdash", size=1) +
             ggplot2::scale_x_continuous(breaks=seq(28, 42, by=2)) + 
             ggplot2::scale_y_continuous(limits=c(0,750))
print(plt)

plotLongitudinal(data = longi.dat, x="xDAP", response = "sPSA", 
                 x.title = "DAP",  y.title = "sPSA (kpixels)", 
                 facet.x = "Treatment.1", facet.y = "Smarthouse", 
                 ggplotFuncs = list(ggplot2::geom_vline(xintercept=29, 
                                                        linetype="longdash", 
                                                        size=1), 
                                    ggplot2::scale_x_continuous(breaks=seq(28, 42, 
                                                                           by=2)), 
                                    ggplot2::scale_y_continuous(limits=c(0,750))))
</code></pre>

<hr>
<h2 id='plotMedianDeviations'>Calculates and plots  the median of the deviations of the smoothed values from the observed values.</h2><span id='topic+plotMedianDeviations'></span>

<h3>Description</h3>

<p>Calculates and plots the median of the deviations of the supplied smoothed values from the 
supplied observed values for traits and combinations of different smoothing methods and 
smoothing degrees of freedom, possibly for subsets of <code><a href="base.html#topic+factor">factor</a></code> combinations. 
The requisite values can be generated using <code><a href="#topic+probeSmoothing">probeSmoothing</a></code> with <code>which.plots</code> 
set to <code>none</code>. The results of smoothing methods applied externally to 
<code>growthPheno</code> can be included via the <code>extra.smooths</code> argument. Envelopes of the 
median value of a trait for each <code><a href="base.html#topic+factor">factor</a></code> combination can be added.
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code>.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMedianDeviations(data, response, response.smoothed, 
                     x = NULL, xname="xDays", 
                     individuals = "Snapshot.ID.Tag",  
                     x.title = NULL, y.titles = NULL,
                     facet.x = "Treatment.1", facet.y = "Smarthouse", 
                     labeller = NULL, 
                     trait.types = c("response", "AGR", "RGR"), 
                     propn.types = c(0.1, 0.5, 0.75), propn.note = TRUE, 
                     alpha.med.devn = 0.5, 
                     smoothing.methods = "direct", df, extra.smooths = NULL, 
                     ggplotFuncsMedDevn = NULL, printPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMedianDeviations_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the observed and smoothed values 
from which the deviations are to be computed. There should be a column 
of smoothed values for each combination of <code>smoothing.methods</code>, 
<code>df</code> and the types specified by <code>trait.types</code>. In addition, 
there should be a column of values for each element of 
<code>extra.smooths</code> in combination with the elements of 
<code>trait.types</code>. Also, there should be a column of observed values 
for each of the types specified by <code>trait.types</code></p>
</td></tr></table>
<p>. The naming of the 
columns for smoothed traits should follow the convention that a name is 
made up, in the order sepcified, of (i) a <code>response.smoothed</code>, 
(ii) the <code>trait.type</code> if not just a <code>response</code> trait type, a 
<code>smoothing.method</code> or an <code>extra.smooths</code> and, 
(iii) if a <code>smoothing.method</code>, a df.  
Each component should be separated by a period (.).
</p>
<table>
<tr><td><code id="plotMedianDeviations_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the response variable for which the 
observed values are supplied. Depending on the setting of 
<code>trait.types</code>, the observed values of related <code>trait.types</code> 
may also need to be be supplied.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code> and obtained for the combinations of 
<code>smoothing.methods</code> and <code>df</code>, usually using smoothing splines. 
If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which 
<code>.smooth</code> is added. 
Depending on the setting of <code>trait.types</code>, the smoothed 
values of related <code>trait.types</code> may also need to be be supplied.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the variable to be plotted on the 
x-axis; it may incorporate an expression. If <code>x</code> is <code>NULL</code> then 
<code>xname</code> is used.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_xname">xname</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the
<code><a href="base.html#topic+numeric">numeric</a></code> that contains the values from which
<code>x</code> is derived, it being that <code>x</code> may incorporate an 
expression.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_x.title">x.title</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the title for the x-axis. 
If <code>NULL</code> then set to <code>xname</code>.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_y.titles">y.titles</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the titles for the y-axis, 
one for each trait specified by <code>trait.types</code>. 
If <code>NULL</code> then set to the traits derived for <code>response</code> 
from <code>trait.types</code>.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate columns of plots. 
Use <code>"."</code> if a split into columns is not wanted. For 
<code>which.plots</code> set to <code>methodcompare</code> or <code>dfcompare</code> 
<code>facet.x</code> is ignored.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate rows of plots.
Use <code>"."</code> if a split into columns is not wanted.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_labeller">labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_trait.types">trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the traits types that are to be 
plotted. While <code>AGR</code> and <code>RGR</code> are commonly used, the names 
can be arbitrary, except that <code>response</code> is a special case that 
indicates that the original response is to be plotted.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_propn.types">propn.types</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the proportion of the medians 
values of each of the <code>trait.types</code> that are to be plotted 
in the median deviations plots. If set to <code>NULL</code>, the plots of 
the proprotions are omitted.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_propn.note">propn.note</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether a note giving the 
proportion of the median values plotted in the <code>compare.medians</code> 
plots.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_alpha.med.devn">alpha.med.devn</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the degrees of 
transparency to be used in plotting a median deviations plot. 
It is a ratio in which the denominator specifies the number of 
points (or lines) that must be overplotted to give a solid cover.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_smoothing.methods">smoothing.methods</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the smoothing method used in 
producing the <code>response.smoothed</code> and which is to be used in labelling 
the plot.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_df">df</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the smoothing degrees of freedom used in 
producing the <code>response.smoothed</code> and which is to be used in labelling 
the plot.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_extra.smooths">extra.smooths</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying one or more 
<code>smoothing.method</code> labels that have been used in naming of columns of 
smooths of the <code>response</code> obtained by methods other than the smoothing 
spline methods provided by <code>growthPheno</code>. Depending on the setting of 
<code>trait.types</code>, the smoothed values of related trait types must also be 
supplied, with names constructed according to the convention described under 
<code>data</code>.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_ggplotfuncsmeddevn">ggplotFuncsMedDevn</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> object.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print any 
plots.</p>
</td></tr>
<tr><td><code id="plotMedianDeviations_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to <code><a href="#topic+plotLongitudinal">plotLongitudinal</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> that consists of two components:  (i) a componenent named  
<code>plots</code> that stores a <code><a href="base.html#topic+list">list</a></code> of the median deviations plots, 
one for each <code>trait.types</code>; (ii) a component named <code>med.dev.dat</code> that stores the 
<code><a href="base.html#topic+data.frame">data.frame</a></code> containing the median deviations that have been plotted.  
Each plot in the <code>plots</code> <code><a href="base.html#topic+list">list</a></code> is in an object of class 
&quot;<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>&quot;, which can be plotted using <code>print</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>, <code><a href="#topic+probeSmoothing">probeSmoothing</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", size=1),
              ggplot2::scale_x_continuous(breaks=seq(28, 42, by=2)))
traits &lt;- probeSmoothing(data = longi.dat, xname = "xDAP", times.factor = "DAP", 
                         response = "PSA", response.smoothed = "sPSA", 
                         df = c(4:7), 
                         facet.x = ".", facet.y = ".",
                         which.plots = "none",
                         propn.types = NULL)
med &lt;- plotMedianDeviations(data = traits, 
                            response = "PSA", response.smoothed = "sPSA", 
                            x="xDAP", xname = "xDAP", 
                            df = c(4,7), x.title = "DAP", 
                            facet.x = ".", facet.y = ".",
                            trait.types = "response", propn.types = 0.05,
                            ggplotFuncsMedDevn = vline)
</code></pre>

<hr>
<h2 id='plotProfiles'>Produces profile plots of longitudinal data for a set of individuals</h2><span id='topic+plotProfiles'></span>

<h3>Description</h3>

<p>Produce profile plots of longitudinal data for a response using <code>ggplot</code>. 
A line is drawn for the data for each <code>individual</code> and the plot 
can be faceted so that a grid of plots is produced. For each facet a line for 
the medians over time can be added, along with the vaue of the outer whiskers 
(median +/- 1.5 * IQR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotProfiles(data, response = "PSA", 
             individuals = "Snapshot.ID.Tag", times = "DAP", 
             x = NULL, title = NULL, 
             x.title = "DAP", y.title = "PSA (kpixels)", 
             facet.x = ".", facet.y = ".", 
             labeller = NULL, scales = "fixed", 
             breaks.spacing.x = -2, angle.x = 0, 
             colour = "black", 
             colour.column = NULL, colour.values = NULL, 
             alpha = 0.1, addMediansWhiskers = FALSE, 
             ggplotFuncs = NULL, 
             printPlot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotProfiles_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the data to be plotted.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_response">response</code></td>
<td>
<p>A <code>character</code> specifying the response variable that 
is to be plotted on the y-axis.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was collected, 
either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. If not a <code><a href="base.html#topic+numeric">numeric</a></code>, it will be 
converted to a <code><a href="base.html#topic+numeric">numeric</a></code> and used to provide the values 
to be plotted on the x-axis. If a <code><a href="base.html#topic+factor">factor</a></code> or 
<code><a href="base.html#topic+character">character</a></code>, the values should be numerics stored as 
characters.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying a variable, or a function of 
variables, to be plotted on the x-axis. If <code>NULL</code>, it will be 
set to the value of <code>times</code>, which it can be assumed will be 
converted to a <code><a href="base.html#topic+numeric">numeric</a></code>.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_y.title">y.title</code></td>
<td>
<p>Title for the y-axis.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_title">title</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate columns of plots. 
Use <code>"."</code> if a split into columns is not wanted.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate rows of plots.
Use <code>"."</code> if a split into rows is not wanted.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_labeller">labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_scales">scales</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying whether the scales are shared 
across all facets of a plot (the default, &quot;fixed&quot;), or do they vary across 
rows (&quot;free_x&quot;), columns (&quot;free_y&quot;), or both rows and columns (&quot;free&quot;)?</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_breaks.spacing.x">breaks.spacing.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> whose absolute values specifies the 
distance between major breaks for the x-axis in a sequence beginning with the 
minimum x value and continuing up to the maximum x value. If it is negative, 
the breaks that do not have x values in <code>data</code> will be omitted. 
Minor breaks will be at half major break value or, if these do not correspond to 
x-values in <code>data</code> when <code>breaks.spacing.x</code> is negative, have 
a spacing of one. Thus, when <code>breaks.spacing.x</code> is negative,  
grid lines will only be included for x-values that occur in <code>data</code>.  
These settings can be overwritten by supplying, in <code>ggplotFuncs</code>, 
a <code>scale_x_continuous</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_angle.x">angle.x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 360 that gives the angle of the 
x-axis text to the x-axis. It can also be set by supplying, in 
<code>ggplotFuncs</code>, a <code>theme</code> function from <code>ggplot2</code>.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_colour">colour</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying a single colour to use in 
drawing the lines for the profiles. If colouring according to the 
values of a variable is required then use <code>colour.column</code>.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_colour.column">colour.column</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of a column 
in <code>data</code> over whose values the colours of the lines are to be 
varied. The colours can be specified using <code>colour.values</code>.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_colour.values">colour.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector specifying the values of 
the colours to use in drawing the lines for the profiles.  
If this is a named vector, then the values will be matched based 
on the names. If unnamed, values will be matched in order 
(usually alphabetical) with the limits of the scale.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_alpha">alpha</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the degrees of transparency to 
be used in plotting. It is a ratio in which the denominator 
specifies the number of points (or lines) that must be overplotted 
to give a solid cover.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_addmedianswhiskers">addMediansWhiskers</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether plots over 
time of the medians and outer whiskers are to be added to the plot. 
The outer whiskers are related to the whiskers on a box-and-whisker 
and are defined as the median plus (and minus) 1.5 times the 
interquartile range (IQR). Points lying outside the whiskers are 
considered to be potential outliers.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element.
These functions are applied in creating the <code>ggplot</code> object.</p>
</td></tr>
<tr><td><code id="plotProfiles_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print the 
plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>&quot;, which can be plotted using 
<code>print</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="ggplot2.html#topic+labeller">labeller</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
plotProfiles(data = longi.dat, response = "sPSA", times = "DAP")

plt &lt;- plotProfiles(data = longi.dat, response = "sPSA", 
                    y.title = "sPSA (kpixels)", 
                    facet.x = "Treatment.1", facet.y = "Smarthouse", 
                    breaks.spacing.x = 2,
                    printPlot=FALSE)
plt &lt;- plt + ggplot2::geom_vline(xintercept=29, linetype="longdash", linewidth=1) +
             ggplot2::scale_y_continuous(limits=c(0,750))
print(plt)

plotProfiles(data = longi.dat, response = "sPSA", times = "DAP", 
             x.title = "DAP", y.title = "sPSA (kpixels)", 
             facet.x = "Treatment.1", facet.y = "Smarthouse", 
                 ggplotFuncs = list(ggplot2::geom_vline(xintercept=29, 
                                                        linetype="longdash", 
                                                        size=1), 
                                    ggplot2::scale_x_continuous(breaks=seq(28, 42, 
                                                                           by=2)), 
                                    ggplot2::scale_y_continuous(limits=c(0,750))))
</code></pre>

<hr>
<h2 id='plotSmoothsComparison'>Plots  several sets of smoothed values for a response, possibly along with growth rates and optionally including the unsmoothed values, as well as deviations boxplots.</h2><span id='topic+plotSmoothsComparison'></span>

<h3>Description</h3>

<p>Plots the smoothed values for an observed <code>response</code> and, optionally, the unsmoothed 
observed <code>response</code> using <code><a href="#topic+plotProfiles">plotProfiles</a></code>. Depending on the setting of 
<code>trait.types</code> (<code>response</code>, <code>AGR</code> or <code>RGR</code>), the computed traits of the 
Absolute Growth Rates (AGR) and/or the Relative Growth Rates (RGR) are plotted.  This 
function will also calculate and produce, using <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>, boxplots 
of the deviations of the supplied smoothed values from the observed response values for the 
traits and for combinations of the different smoothing parameters and for subsets of 
non-smoothing-<code><a href="base.html#topic+factor">factor</a></code> combinations. The observed and smoothed values are 
supplied in long format i.e. with the values for each set of smoothing parameters stacked 
one under the other in the supplied <code><a href="#topic+smooths.frame">smooths.frame</a></code>. Such data can be generated 
using <code><a href="#topic+probeSmooths">probeSmooths</a></code>;  to prevent <code><a href="#topic+probeSmooths">probeSmooths</a></code> producing the 
plots, which it is does using <code>plotSmoothsComparison</code>, <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code> 
and <code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code>, set <code>which.plots</code> to <code>none</code>. 
The smoothing parameters include <code>spline.types</code>, <code>df</code>, <code>lambdas</code> and 
<code>smoothing.methods</code> (see <code><a href="#topic+probeSmooths">probeSmooths</a></code>). 
</p>
<p>Multiple plots, possibly each having multiple facets, are produced using <code>ggplot2</code>. 
The layout of these plots is controlled via the arguments <code>plots.by</code>, 
<code>facet.x</code> and <code>facet.y</code>. The basic principle is that the number of levels 
combinations of the smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s <code>Type</code>, <code>TunePar</code>, 
<code>TuneVal</code>, <code>Tuning</code> (the combination of (<code>TunePar</code> and <code>TuneVal</code>), and 
<code>Method</code> that are included  in <code>plots.by</code>, <code>facet.x</code> and 
<code>facet.y</code> must be the same as those covered by the combinations of the values 
supplied to <code>spline.types</code>, <code>df</code>, <code>lambdas</code> and <code>Method</code> and incorporated 
into the <code><a href="#topic+smooths.frame">smooths.frame</a></code> input to <code>plotSmoothsComparison</code> via the 
<code>data</code> argument. This ensures that smooths from different parameter sets are not 
pooled into the same plot. The <code><a href="base.html#topic+factor">factor</a></code>s other than the smoothing-parameter 
<code><a href="base.html#topic+factor">factor</a></code>s can be supplied to the <code>plots.by</code> and <code>facet</code> arguments.
</p>
<p>The following profiles plots can be produced: (i) separate plots of the 
smoothed traits for each combination of the smoothing parameters 
(include <code>Type</code>, <code>Tuning</code> and <code>Method</code> in <code>plots.by</code>); 
(ii) as for (i), with the corresponding plot for the unsmoothed trait 
preceeding the plots for the smoothed trait (also set <code>include.raw</code> to 
<code>alone</code>); (iii) profiles plots that compare a smoothed trait for all 
combinations of the values of the smoothing parameters, arranging the plots 
side-by-side or one above the other (include <code>Type</code>, <code>Tuning</code> and 
<code>Method</code> in <code>facet.x</code> and/or <code>facet.y</code> - to include the 
unsmoothed trait set <code>include.raw</code> to one of <code>facet.x</code> or 
<code>facet.y</code>; (iv) as for (iii), except that separate plots are 
produced for each combination of the levels of the <code><a href="base.html#topic+factor">factor</a></code>s 
in <code>plot.by</code> and each plot compares the smoothed traits for the 
smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s included in <code>facet.x</code> 
and/or <code>facet.y</code> (set both <code>plots.by</code> and one or more of 
<code>facet.x</code> and <code>facet.y</code>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSmoothsComparison(data, response, response.smoothed = NULL, 
                      individuals = "Snapshot.ID.Tag", times = "DAP", 
                      trait.types = c("response", "AGR", "RGR"), 
                      x.title = NULL, y.titles = NULL, 
                      profile.plot.args = 
                        args4profile_plot(plots.by = NULL, 
                                          facet.x = ".", facet.y = ".", 
                                          include.raw = "no"),
                      printPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSmoothsComparison_+3A_data">data</code></td>
<td>
<p>A <code><a href="#topic+smooths.frame">smooths.frame</a></code>, such as is produced by 
<code><a href="#topic+probeSmooths">probeSmooths</a></code> and that contains the data resulting from 
smoothing a response over time for a set of <code>individuals</code>, the data 
being arranged in long format both with respect to the 
times and the smoothing-parameter values used in the smoothing. That is, 
each response occupies a single column. The unsmoothed <code>response</code> and 
the <code>response.smoothed</code> are to be plotted for different sets of values 
for the smoothing parameters. The <code><a href="#topic+smooths.frame">smooths.frame</a></code> must include 
the columns <code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code> and 
<code>Method</code>, and the columns nominated using the arguments 
<code>individuals</code>, <code>times</code>, <code>plots.by</code>, <code>facet.x</code>, <code>facet.y</code>, 
<code>response</code>, <code>response.smoothed</code>, and, if requested, 
the AGR and the RGR of the <code>response</code> and <code>response.smoothed</code>. 
The names of the growth rates should be formed from <code>response</code> and 
<code>response.smoothed</code> by adding <code>.AGR</code> and <code>.RGR</code> to both of them.</p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the response variable for which the 
observed values are supplied.</p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code> and obtained for the combinations of 
<code>smoothing.methods</code> and <code>df</code>, usually using smoothing splines. 
If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>. </p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used to provide the values to be plotted 
on the x-axis. If a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, 
the values should be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_trait.types">trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code>trait.types</code> that 
are to be plotted when <code>which.plots</code> is <code>profiles</code>. 
Irrespective of the setting of <code>get.rates</code>, the nominated traits 
are plotted. If <code>all</code>, each of <code>response</code>, <code>AGR</code> and 
<code>RGR</code> is plotted.</p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis, used for all plots. If <code>NULL</code> then set to 
<code>times</code>.</p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_y.titles">y.titles</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the titles for the y-axis, 
one for each trait specified by <code>trait.types</code> and used for all plots. 
If <code>NULL</code>, then set to the traits derived for <code>response</code> 
from <code>trait.types</code>.</p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_profile.plot.args">profile.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, it documenting the 
options available for varying profile plots and boxplots. <em>Note 
that if <code><a href="#topic+args4profile_plot">args4profile_plot</a></code> is to be called to change 
from the default settings given in the default 
<code>plotSmoothsComparison</code> call 
and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>; be aware that if you call 
<code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, then the defaults for this call are 
those for <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, <b>NOT</b> the call to 
<code><a href="#topic+args4profile_plot">args4profile_plot</a></code> shown as the default for 
<code>plotSmoothsComparison</code>.</em></p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print any 
plots.</p>
</td></tr>
<tr><td><code id="plotSmoothsComparison_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to <code><a href="#topic+plotProfiles">plotProfiles</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multilevel <code><a href="base.html#topic+list">list</a></code> that contains the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> 
objects for the plots produced. The first-level <code><a href="base.html#topic+list">list</a></code> 
has a component for each <code>trait.types</code> and each of these is a 
second-level <code><a href="base.html#topic+list">list</a></code> that contains the trait 
profile plots and for a <code>trait</code>. It may contain components labelled 
<code>Unsmoothed</code>, <code>all</code> or for one of the levels of the 
<code><a href="base.html#topic+factor">factor</a></code>s in <code>plots.by</code>; each of these third-level 
<code><a href="base.html#topic+list">list</a></code>s contains a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object that can 
be plotted using <code>print</code>. 
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code>, <code><a href="#topic+probeSmooths">probeSmooths</a></code>, <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>, <code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", size=1))
traits &lt;- probeSmooths(data = longi.dat, 
                       response = "PSA", response.smoothed = "sPSA", 
                       times = "DAP", 
                       #only df is changed from the probeSmooth default
                       smoothing.args = 
                         args4smoothing(smoothing.methods = "direct", 
                                        spline.types = "NCSS", 
                                        df = c(4,7), lambdas = NULL), 
                       which.plots = "none")
plotSmoothsComparison(data = traits, 
                      response = "PSA", response.smoothed = "sPSA", 
                      times = "DAP", x.title = "DAP",
                      #only facet.x is changed from the probeSmooth default
                      profile.plot.args = 
                        args4profile_plot(plots.by = NULL, 
                                          facet.x = "Tuning", facet.y = ".", 
                                          include.raw = "no", 
                                          ggplotFuncs = vline))
</code></pre>

<hr>
<h2 id='plotSmoothsDevnBoxplots'>Produces boxplots for several sets of deviations of the smoothed values from a response, possibly along with growth rates.</h2><span id='topic+plotSmoothsDevnBoxplots'></span>

<h3>Description</h3>

<p> Calculates and produces, using <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>, boxplots 
of the deviations of the supplied smoothed values from the observed response values for the 
traits and for combinations of the different smoothing parameters and for subsets of 
non-smoothing-<code><a href="base.html#topic+factor">factor</a></code> combinations. Which traits are plotted is controlled by  
<code>trait.types</code> and may include the (<code>response</code>and the computed traits of the 
Absolute Growth Rates (AGR) and/or the Relative Growth Rates (RGR). The observed and smoothed 
values are supplied in long format i.e. with the values for each set of smoothing parameters  
stacked one under the other in the supplied <code><a href="#topic+smooths.frame">smooths.frame</a></code>. Such data can be 
generated using <code><a href="#topic+probeSmooths">probeSmooths</a></code>.
</p>
<p>Multiple plots, possibly each having multiple facets, are produced using <code>ggplot2</code>. 
The layout of these plots is controlled via the arguments <code>plots.by</code>, 
<code>facet.x</code> and <code>facet.y</code>. The basic principle is that the number of levels 
combinations of the smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s <code>Type</code>, <code>TunePar</code>, 
<code>TuneVal</code>, <code>Tuning</code> (the combination of (<code>TunePar</code> and <code>TuneVal</code>), and 
<code>Method</code> that are included  in <code>plots.by</code>, <code>facet.x</code> and <code>facet.y</code> 
must be the same as those covered by the combinations of the values incorporated 
into the <code><a href="#topic+smooths.frame">smooths.frame</a></code> input to <code>plotSmoothsDevnBoxplots</code> via the 
<code>data</code> argument. This ensures that smooths from different parameter sets are not 
pooled into the same plot. The <code><a href="base.html#topic+factor">factor</a></code>s other than the smoothing-parameter 
<code><a href="base.html#topic+factor">factor</a></code>s can be supplied to the <code>plots.by</code> and <code>facet</code> arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSmoothsDevnBoxplots(data, response, response.smoothed = NULL, 
                        individuals = "Snapshot.ID.Tag", times = "DAP", 
                        trait.types = c("response", "AGR", "RGR"), 
                        which.plots =  "absolute.boxplots", 
                        x.title = NULL, y.titles = NULL, 
                        devnboxes.plot.args = 
                          args4devnboxes_plot(plots.by = NULL, 
                                              facet.x = ".", facet.y = "."),
                        printPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_data">data</code></td>
<td>
<p>A <code><a href="#topic+smooths.frame">smooths.frame</a></code>, such as is produced by 
<code><a href="#topic+probeSmooths">probeSmooths</a></code> and that contains the data resulting from 
smoothing a response over time for a set of <code>individuals</code>, the data 
being arranged in long format both with respect to the 
times and the smoothing-parameter values used in the smoothing. That is, 
each response occupies a single column. The unsmoothed <code>response</code> and 
the <code>response.smoothed</code> are to be plotted for different sets of values 
for the smoothing parameters. The <code><a href="#topic+smooths.frame">smooths.frame</a></code> must include 
the columns <code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code> and 
<code>Method</code>, and the columns nominated using the arguments 
<code>individuals</code>, <code>times</code>, <code>plots.by</code>, <code>facet.x</code>, <code>facet.y</code>, 
<code>response</code>, <code>response.smoothed</code>, and, if requested, 
the AGR and the RGR of the <code>response</code> and <code>response.smoothed</code>. 
The names of the growth rates should be formed from <code>response</code> and 
<code>response.smoothed</code> by adding <code>.AGR</code> and <code>.RGR</code> to both of them.</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the response variable for which the 
observed values are supplied.</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code> and obtained for the combinations of 
<code>smoothing.methods</code> and <code>df</code>, usually using smoothing splines. 
If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>. </p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used to provide the values to be plotted 
on the x-axis. If a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, 
the values should be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_trait.types">trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code>trait.types</code> that 
are to be plotted. If <code>all</code>, each of <code>response</code>, <code>AGR</code> and 
<code>RGR</code> is plotted.</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_which.plots">which.plots</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating which plots are to be produced. 
The options are either <code>none</code> or <code>absolute.deviations</code> and/or 
<code>relative.deviations</code>. Boxplots of the absolute deviations 
are specified by <code>absolute.boxplots</code>, the absolute deviations being 
the values of a trait minus their smoothed values (observed - smoothed). 
Boxplots of the relative deviations are specified by <code>relative.boxplots</code>, 
the relative deviations being the absolute deviations divided by the 
smoothed values of the trait.</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis, used for all plots. If <code>NULL</code> then set to 
<code>times</code>.</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_y.titles">y.titles</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the titles for the y-axis, 
one for each trait specified by <code>trait.types</code> and used for all plots. 
If <code>NULL</code>, then set to the traits derived for <code>response</code> 
from <code>trait.types</code>.</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_devnboxes.plot.args">devnboxes.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>, it documenting the 
options available for varying the boxplots. <em>Note 
that if <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code> is to be called to change 
from the default settings given in the default <code>probeSmooths</code> 
call and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>; be aware that if you call 
<code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>, then the defaults for this call 
are those for <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>, <b>NOT</b> the call 
to <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code> shown as the default for 
<code>probeSmooths</code>.</em></p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print any 
plots.</p>
</td></tr>
<tr><td><code id="plotSmoothsDevnBoxplots_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to <code><a href="#topic+plotProfiles">plotProfiles</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multilevel <code><a href="base.html#topic+list">list</a></code> that contains the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> 
objects for the plots produced. The first-level <code><a href="base.html#topic+list">list</a></code> 
has a component for each <code>trait.types</code> and each of these is a 
second-level <code><a href="base.html#topic+list">list</a></code> with contains the deviations boxplots 
for a <code>response</code>. Each plot is in an object of class 
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, which can be plotted using <code>print</code>. 
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code>, <code><a href="#topic+probeSmooths">probeSmooths</a></code>, <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>, <code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
traits &lt;- probeSmooths(data = longi.dat, 
                       response = "PSA", response.smoothed = "sPSA", 
                       times = "DAP", 
                       #only df is changed from the probeSmooth default
                       smoothing.args = 
                         args4smoothing(smoothing.methods = "direct", 
                                        spline.types = "NCSS", 
                                        df = c(4,7), lambdas = NULL), 
                       which.plots = "none")
plotSmoothsDevnBoxplots(data = traits, 
                        response = "PSA", response.smoothed = "sPSA", 
                        times = "DAP", x.title = "DAP",
                        #only facet.x is changed from the probeSmooth default
                        devnboxes.plot.args = 
                          args4devnboxes_plot(plots.by = NULL, 
                                              facet.x = "Tuning", facet.y = "."))
</code></pre>

<hr>
<h2 id='plotSmoothsMedianDevns'>Calculates and plots the medians of the deviations from the observed values for 
several sets of smoothed values  stored in a <code>data.frame</code> in long format.</h2><span id='topic+plotSmoothsMedianDevns'></span>

<h3>Description</h3>

<p>Calculates and plots the medians of the deviations of the supplied smoothed values from the 
supplied observed values for traits and combinations of different smoothing parameters, 
possibly for subsets of non-smoothing-<code><a href="base.html#topic+factor">factor</a></code> combinations. The observed and smoothed values are supplied in 
long format i.e. with the values for each set of smoothing parameters stacked one under the other 
in the supplied <code><a href="base.html#topic+data.frame">data.frame</a></code>. Such data can be generated using <code><a href="#topic+probeSmooths">probeSmooths</a></code>;  
to prevent <code><a href="#topic+probeSmooths">probeSmooths</a></code> producing the plots, which it is does using 
<code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code>, <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code> and 
<code>plotSmoothsMedianDevns</code>, set <code>which.plots</code> to <code>none</code>. 
The smoothing parameters include <code>spline.types</code>, <code>df</code>, <code>lambdas</code> and 
<code>smoothing.methods</code> (see <code><a href="#topic+probeSmooths">probeSmooths</a></code>). 
</p>
<p>Multiple plots, possibly each having multiple facets, are produced using <code>ggplot2</code>. 
The layout of these plots is controlled via the smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s 
<code>Type</code>, <code>Tuning</code> (the combination of <code>TunePar</code> and <code>TuneVal</code>) and 
<code>Method</code> that can be supplied to the arguments <code>plots.by</code>, 
<code>plots.group</code>, <code>facet.x</code> and <code>facet.y</code>. These <code>plots</code> and 
<code>facet</code> arguments can also include <code><a href="base.html#topic+factor">factor</a></code>s other than the 
smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s, that are also associated with the data. 
The basic principle is that the number of levels combinations of the smoothing-parameter 
<code><a href="base.html#topic+factor">factor</a></code>s included in the <code>plots</code> and <code>facet</code> 
arguments must be the same as those covered by the combinations of the values supplied to 
<code>spline.types</code>, <code>df</code>, <code>lambdas</code> and <code>Method</code> and incorporated into the 
<code><a href="#topic+smooths.frame">smooths.frame</a></code> input to <code>plotSmoothsMedianDevns</code> via the <code>data</code> argument. 
This ensures that smooths from different parameter sets are not pooled in a single plot. 
Envelopes of the median value of a trait for each <code><a href="base.html#topic+factor">factor</a></code> combination can be added.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSmoothsMedianDevns(data, response, response.smoothed = NULL, 
                       individuals = "Snapshot.ID.Tag",  times = "DAP", 
                       trait.types = c("response", "AGR", "RGR"), 
                       x.title = NULL, y.titles = NULL, 
                       meddevn.plot.args = 
                         args4meddevn_plot(plots.by = NULL, plots.group = NULL,
                                           facet.x = ".", facet.y = ".", 
                                           propn.note = TRUE, 
                                           propn.types = c(0.1, 0.5, 0.75)), 
                       printPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSmoothsMedianDevns_+3A_data">data</code></td>
<td>
<p>A <code><a href="#topic+smooths.frame">smooths.frame</a></code>, such as is produced by 
<code><a href="#topic+probeSmooths">probeSmooths</a></code> and that contains the data resulting from 
smoothing a response over time for a set of <code>individuals</code>, the data 
being arranged in long format both with respect to the 
times and the smoothing-parameter values used in the smoothing. That is, 
each response occupies a single column. The <code><a href="#topic+smooths.frame">smooths.frame</a></code> 
must include the columns <code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, 
<code>Tuning</code> and <code>Method</code>, and the columns nominated using the 
arguments <code>individuals</code>, <code>times</code>, <code>plots.by</code>, 
<code>facet.x</code>, <code>facet.y</code>, <code>plots.group</code>, <code>response</code>, 
<code>response.smoothed</code>, and, if requested, the AGR and the RGR of the 
<code>response</code> and <code>response.smoothed</code>. The names of the growth 
rates should be formed from <code>response</code> and <code>response.smoothed</code> 
by adding <code>.AGR</code> and <code>.RGR</code> to both of them.</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the response variable for which the 
observed values are supplied. Depending on the setting of 
<code>trait.types</code>, the observed values of related <code>trait.types</code> 
may also need to be be supplied.</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code> and obtained for the combinations of 
<code>smoothing.methods</code> and <code>df</code>, usually using smoothing splines. 
If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>. 
Depending on the setting of <code>trait.types</code>, the smoothed 
values of related <code>trait.types</code> may also need to be be supplied.</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used to provide the values to be plotted 
on the x-axis. If a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, 
the values should be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_trait.types">trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the traits types that are to be 
plotted. While <code>AGR</code> and <code>RGR</code> are commonly used, the names 
can be arbitrary, except that <code>response</code> is a special case that 
indicates that the original response is to be plotted. If <code>all</code>, 
each of <code>response</code>, <code>AGR</code> and <code>RGR</code> is plotted.</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis. If <code>NULL</code> then set to <code>times</code>.</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_y.titles">y.titles</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the titles for the y-axis, 
one for each trait specified by <code>trait.types</code>. 
If <code>NULL</code>, then set to the traits derived for <code>response</code> 
from <code>trait.types</code>.</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_meddevn.plot.args">meddevn.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, it documenting the 
options available for varying median deviations plots. <em>Note 
that if <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code> is to be called to change 
from the default settings given in the default <code>plotSmoothsMedianDevns</code> 
call and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>; be aware that if you call 
<code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, then the defaults for this call are 
those for <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, <b>NOT</b> the call to 
<code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code> shown as the default for 
<code>plotSmoothsMedianDevns</code>.</em></p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_printplot">printPlot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to print the 
plot.</p>
</td></tr>
<tr><td><code id="plotSmoothsMedianDevns_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> that consists of two components:  (i) a componenent named  
<code>plots</code> that stores a two-level <code><a href="base.html#topic+list">list</a></code> of the median deviations 
plots; the first-level <code><a href="base.html#topic+list">list</a></code> has a component for each 
<code>trait.types</code> and each of these <code><a href="base.html#topic+list">list</a></code>(s) is a second-level 
<code><a href="base.html#topic+list">list</a></code> that contains the set of plots specified by <code>plots.by</code> 
(if <code>plots.by</code> is <code>NULL</code>, a single plot is stored); (ii) a component named 
<code>med.dev.dat</code> that stores the <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the 
median deviations that have been plotted.  Each plot in the <code>plots</code> 
<code><a href="base.html#topic+list">list</a></code> is in an object of class <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, which can be 
plotted using <code>print</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+traitSmooth">traitSmooth</a></code>, <code><a href="#topic+probeSmooths">probeSmooths</a></code>, <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code>, <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", size=1))
traits &lt;- probeSmooths(data = longi.dat, 
                       response = "PSA", response.smoothed = "sPSA", 
                       times = "DAP", 
                       get.rates = FALSE, trait.types = "response", 
                       smoothing.args = 
                         args4smoothing(smoothing.methods = "direct", 
                                        spline.types = "NCSS", 
                                        df = c(4,7), lambdas = NULL), 
                       which.plots = "none")
med &lt;- plotSmoothsMedianDevns(data = traits, 
                              response = "PSA", response.smoothed = "sPSA", 
                              times = "DAP", trait.types = "response",  
                              meddevn.plot.args = 
                                args4meddevn_plot(plots.by = NULL, 
                                                  plots.group = "Tuning", 
                                                  facet.x = ".", facet.y = ".", 
                                                  propn.types = 0.02,
                                                  ggplotFuncs = vline))
</code></pre>

<hr>
<h2 id='prepImageData'>Prepares raw imaging data for further processing</h2><span id='topic+prepImageData'></span>

<h3>Description</h3>

<p>Forms the prime traits by selecting a subset of the traits in a data.frame of 
imaging data produced by the Lemna Tec Scanalyzer. The imaging traits to be retained 
are specified using the <code>traits</code> and <code>labsCamerasViews</code> arguments. Some imaging 
traits are divided by 1000 to convert them from pixels to kilopixels. 
Also added are <code><a href="base.html#topic+factor">factor</a></code>s and explanatory variates that might be of use in an 
analysis of the data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepImageData(data, cartId = "Snapshot.ID.Tag", 
              imageTimes = "Snapshot.Time.Stamp", 
              timeAfterStart = "Time.after.Planting..d.",
              PSAcolumn = "Projected.Shoot.Area..pixels.", 
              idcolumns = c("Genotype.ID","Treatment.1"), 
              traits = list(all = c("Area", 
                                    "Boundary.Points.To.Area.Ratio", 
                                    "Caliper.Length", "Compactness", 
                                    "Convex.Hull.Area"), 
                            side = c("Center.Of.Mass.Y", 
                                     "Max.Dist.Above.Horizon.Line")),
              labsCamerasViews = list(all = c("SV1", "SV2", "TV"),
                                      side = c("SV1", "SV2")), 
              smarthouse.lev = NULL, 
              calcWaterUse = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepImageData_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns specified by <code>cartId</code>, 
<code>imageTimes</code>, <code>timeAfterStart</code>, <code>PSAcolumn</code> <code>idcolumns</code>, <code>traits</code> and 
<code>cameras</code> along with  the following columns: 
</p>
<p>Smarthouse, Lane, Position, Weight.Before, Weight.After, Water.Amount, 
</p>
<p>Projected.Shoot.Area..pixels.
</p>
<p>The defaults for the arguments to <code>prepImageData</code> requires a 
<code><a href="base.html#topic+data.frame">data.frame</a></code> containing the following columns, although not necessarily 
in the order given here:
</p>
<p>Smarthouse, Lane, Position, Weight.Before, Weight.After, Water.Amount, 
</p>
<p>Projected.Shoot.Area..pixels., Area.SV1, Area.SV2, Area.TV, 
</p>
<p>Boundary.Points.To.Area.Ratio.SV1, Boundary.Points.To.Area.Ratio.SV2, 
</p>
<p>Boundary.Points.To.Area.Ratio.TV,  Caliper.Length.SV1, 
</p>
<p>Caliper.Length.SV2, Caliper.Length.TV, 
</p>
<p>Compactness.SV1, Compactness.SV2, Compactness.TV, 
</p>
<p>Convex.Hull.Area.SV1, Convex.Hull.Area.SV2, Convex.Hull.Area.TV, 
</p>
<p>Center.Of.Mass.Y.SV1, Center.Of.Mass.Y.SV2, 
</p>
<p>Max.Dist.Above.Horizon.Line.SV1, Max.Dist.Above.Horizon.Line.SV2.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_cartid">cartId</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that contains
the unique Id for each cart.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_imagetimes">imageTimes</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that contains
the time that each cart was imaged.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_timeafterstart">timeAfterStart</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that 
contains the time after some nominated starting time e.g. the number of days 
after planting.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_psacolumn">PSAcolumn</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column that 
contains the projected shoot area.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_idcolumns">idcolumns</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the names of the columns that 
identify differences between the plants or carts e.g. Genotype.ID, 
Treatment.1, Treatment.2.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_traits">traits</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> or a <code><a href="base.html#topic+list">list</a></code> whose components are  
<code><a href="base.html#topic+character">character</a></code>s. Each <code><a href="base.html#topic+character">character</a></code> gives the names of the 
columns for imaging <code>traits</code> whose values are required for each of the 
camera-view combinations given in the corresponding <code><a href="base.html#topic+list">list</a></code> 
component of <code>labsCamerasViews</code>. If <code>labsCamerasViews</code> or a 
component of <code>labsCamerasViews</code> is <code>NULL</code>, then the contents of 
<code>traits</code> or the coresponding component of <code>traits</code> are merely 
treated as the names of columns to be retained.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_labscamerasviews">labsCamerasViews</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> or a <code><a href="base.html#topic+list">list</a></code> whose components are  
<code><a href="base.html#topic+character">character</a></code>s. Each <code><a href="base.html#topic+character">character</a></code> gives the labels of the  
camera-view combinations for which is required values of each of the imaging 
<code>traits</code> in the corresponding <code><a href="base.html#topic+character">character</a></code> of <code>traits</code>. 
It is assumed that the camera-view labels are appended to the trait names and 
separated from the trait names by a full stop (.). If <code>labsCamerasViews</code> 
or a component of <code>labsCamerasViews</code> is <code>NULL</code>, then the contents 
of the <code>traits</code> or the coresponding component of <code>traits</code> are 
merely treated as the names of columns to be retained.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_smarthouse.lev">smarthouse.lev</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the levels to use 
for the Smarthouse <code><a href="base.html#topic+factor">factor</a></code>. If <code>NULL</code> then the unique values in Smarthouse 
will be used.</p>
</td></tr>
<tr><td><code id="prepImageData_+3A_calcwateruse">calcWaterUse</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether to calculate the Water.Loss. If it is 
<code>FALSE</code>, <code>Water.Before</code>, <code>Water.After</code> and <code>Water.Amount</code> will not be in 
the returned <code><a href="base.html#topic+data.frame">data.frame</a></code>. They can be copied across by listing them in a component 
of <code>traits</code> and set the corresponding component of <code>cameras</code> to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The columns are copied from <code>data</code>, except for those columns that are calculated from the columns in <code>data</code>; those columns that are calculated have &lsquo;(calculated)&rsquo; appended in the list under <b>Value</b>.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns specified by <code>cartId</code>, 
<code>imageTimes</code>, <code>timeAfterStart</code>, <code>idcolumns</code>, <code>traits</code> and 
<code>cameras</code>. The defaults will result in the following columns:
</p>

<ol>
<li><p> Smarthouse: <code><a href="base.html#topic+factor">factor</a></code> with levels for the Smarthouse
</p>
</li>
<li><p> Lane: <code><a href="base.html#topic+factor">factor</a></code> for lane number in a smarthouse
</p>
</li>
<li><p> Position: <code><a href="base.html#topic+factor">factor</a></code> for east/west position in a lane
</p>
</li>
<li><p> DAP: <code><a href="base.html#topic+factor">factor</a></code> for the number of Days After Planting
</p>
</li>
<li><p> xDAP: numeric for the DAP (calculated)
</p>
</li>
<li> <p><code>cartId</code>: unique code for each cart 
</p>
</li>
<li> <p><code>imageTimes</code>: time at which an image was taken in POSIXct format
</p>
</li>
<li><p> Hour: hour of the day, to 2 decimal places, at which the image was taken (calculated)
</p>
</li>
<li><p> Reps: <code><a href="base.html#topic+factor">factor</a></code> indexing the replicates for each combination of the <code><a href="base.html#topic+factor">factor</a></code>s in <code>idcolumns</code> (calculated)
</p>
</li>
<li> <p><code>idcolumns</code>: the columns listed in <code>idcolumns</code> that have been converted to <code><a href="base.html#topic+factor">factor</a></code>s
</p>
</li>
<li><p> Weight.Before: weight of the pot before watering (only if <code>calcWaterUse</code> is <code>TRUE</code>)
</p>
</li>
<li><p> Weight.After: weight of the pot after watering (only if <code>calcWaterUse</code> is <code>TRUE</code>)
</p>
</li>
<li><p> Water.Amount: the weight of the water added (= Water.After - Water.Before)  (calculated)
</p>
</li>
<li><p> WU: the water use calculated as the difference between Weight.Before for the current imaging and the Weight.After for the previous imaging (calculated unless <code>calcWaterUse</code> is <code>FALSE</code>)
</p>
</li>
<li><p> PSA: the Projected.Shoot.Area..pixels. divided by 1000 (calculated)
</p>
</li>
<li><p> PSA.SV1: the Projected.Shoot.Area from Side View 1 divided by 1000 (calculated)
</p>
</li>
<li><p> PSA.SV2: the Projected.Shoot.Area from Side View 2 divided by 1000 (calculated)
</p>
</li>
<li><p> PSA.TV: the Projected.Shoot.Area from Top View divided by 1000 (calculated)
</p>
</li>
<li><p> Boundary.To.PSA.Ratio.SV1 
</p>
</li>
<li><p> Boundary.To.PSA.Ratio.SV2 
</p>
</li>
<li><p> Boundary.To.PSA.Ratio.TV 
</p>
</li>
<li><p> Caliper.Length.SV1 
</p>
</li>
<li><p> Caliper.Length.SV2 
</p>
</li>
<li><p> Caliper.Length.TV
</p>
</li>
<li><p> Compactness.SV1 from Side View 1
</p>
</li>
<li><p> Compactness.SV2 from Side View 2
</p>
</li>
<li><p> Compactness.TV: from Top View 
</p>
</li>
<li><p> Convex.Hull.PSA.SV1: area of Side View 1 Convex Hull divided by 1000 (calculated)
</p>
</li>
<li><p> Convex.Hull.PSA.SV2: area of Side View 2 Convex Hull divided by 1000 (calculated)
</p>
</li>
<li><p> Convex.Hull.PSA.TV: Convex.Hull.Area.TV divided by 1000 (calculated)
</p>
</li>
<li><p> Center.Of.Mass.Y.SV1: Centre of Mass from Side View 1
</p>
</li>
<li><p> Center.Of.Mass.Y.SV2: Centre of Mass from Side View 2
</p>
</li>
<li><p> Max.Dist.Above.Horizon.Line.SV1: the Max.Dist.Above.Horizon.Line.SV1 divided by 1000 (calculated)
</p>
</li>
<li><p> Max.Dist.Above.Horizon.Line.SV2: the Max.Dist.Above.Horizon.Line.SV2 divided by 1000 (calculated)
</p>
</li></ol>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1)

longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1, 
                           traits = list(a = "Area", c = "Compactness"),
                           labsCamerasViews = list(all = c("SV1", "SV2", "TV"), 
                                                   t = "TV"))

longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1, 
                           traits = c("Area.SV1", "Area.SV2", "Area.TV", 
                                      "Compactness.TV"),
                           labsCamerasViews = NULL)

longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1, 
                           calcWaterUse = FALSE, 
                           traits = list(img = c("Area", "Compactness"), 
                                         H20 = c("Weight.Before","Weight.After",
                                                 "Water.Amount")),
                          labsCamerasViews = list(all = c("SV1", "SV2", "TV"), 
                                                       H2O = NULL))
</code></pre>

<hr>
<h2 id='probeSmoothing'>Compares, for a set of specified values of df and different smoothing methods, 
a response and the smooths of it, possibly along with growth rates calculated 
from the smooths</h2><span id='topic+probeSmoothing'></span>

<h3>Description</h3>

<p>Takes a <code>response</code> and, for each <code>individual</code>, uses 
<code><a href="#topic+splitSplines">splitSplines</a></code> to smooth its values for each individual 
using  the degrees of freedom values in <code>df</code>. 
Provided <code>get.rates</code> is <code>TRUE</code>,
both the Absolute Growth Rates (AGR) and the Relative Growth Rates (RGR) 
are calculated for each smooth, either using differences or first 
derivatives. A combination of the unsmoothed and smoothed values, 
as well as the AGR and RGR, can be plotted for each value in 
<code>smoothing methods</code> in combination with <code>df</code>. Note that the 
arguments that modify the plots apply to all 
plots that are produced. The handling of missing values is controlled 
via <code>na.x.action</code> and <code>na.y.action</code>
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+probeSmooths">probeSmooths</a></code>.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probeSmoothing(data, response = "Area", response.smoothed = NULL, 
               x = NULL, xname="xDays", 
               times.factor = "Days", individuals="Snapshot.ID.Tag", 
               na.x.action="exclude", na.y.action = "exclude", 
               df, smoothing.methods = "direct", correctBoundaries = FALSE, 
               get.rates = TRUE, rates.method="differences", 
               facet.x = "Treatment.1", facet.y = "Smarthouse", 
               labeller = NULL, x.title = NULL, 
               colour = "black", colour.column=NULL, 
               colour.values=NULL, alpha = 0.1, 
               trait.types = c("response", "AGR", "RGR"), 
               propn.types = c(0.1, 0.5, 0.75), propn.note = TRUE, 
               which.plots = "smoothedonly", 
               deviations.plots = "none", alpha.med.devn = 0.5,
               ggplotFuncs = NULL, ggplotFuncsMedDevn = NULL, 
               ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probeSmoothing_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the data.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_response">response</code></td>
<td>
<p>A <code>character</code> specifying the response variable to be 
supplied to <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> and that is to be plotted 
on the y-axis.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code>. If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which 
<code>.smooth</code> is added.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the variable to be plotted on the 
x-axis; it may incorporate an expression. If <code>x</code> is <code>NULL</code> then 
<code>xname</code> is used.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_xname">xname</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the
<code><a href="base.html#topic+numeric">numeric</a></code> that contains the values of the predictor 
variable to be supplied to <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> and 
from which <code>x</code> is derived.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_times.factor">times.factor</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the <code><a href="base.html#topic+factor">factor</a></code> for times at which the data was 
collected. Its levels will be used in calculating growth rates and 
should be numeric values stored as characters.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_na.x.action">na.x.action</code></td>
<td>
<p>A <code>character</code> string that specifies the action to 
be taken when values of <code>x</code> are <code>NA</code>. The possible 
values are <code>fail</code>, <code>exclude</code> or <code>omit</code>. 
For <code>exclude</code> and <code>omit</code>, predictions and derivatives 
will only be obtained for nonmissing values of <code>x</code>. 
The difference between these two codes is that for <code>exclude</code> the returned 
<code>data.frame</code> will have as many rows as <code>data</code>, the 
missing values have been incorporated. </p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_na.y.action">na.y.action</code></td>
<td>
<p>A <code>character</code> string that specifies the action to 
be taken when values of <code>y</code>, or the <code>response</code>, are 
<code>NA</code>.  The possible values are <code>fail</code>, <code>exclude</code>, 
<code>omit</code>, <code>allx</code>, <code>trimx</code>, <code>ltrimx</code> or 
<code>rtrimx</code>. For  all options, except <code>fail</code>, missing 
values in <code>y</code> will be removed before smoothing. 
For <code>exclude</code> and <code>omit</code>, predictions 
and derivatives will be obtained only for nonmissing values of 
<code>x</code> that do not have missing <code>y</code> values. Again, the 
difference between these two is that, only for <code>exclude</code> 
will the missing values be incorporated into the 
returned <code>data.frame</code>. For <code>allx</code>, predictions and 
derivatives will be obtained for all nonmissing <code>x</code>. 
For <code>trimx</code>, they will be obtained for all nonmissing 
<code>x</code> between the first and last nonmissing <code>y</code> values 
that have been ordered for <code>x</code>; for <code>ltrimx</code> and 
<code>utrimx</code> either the lower or upper missing <code>y</code> 
values, respectively, are trimmed.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_df">df</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the set of degrees of freedom to 
be probed.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_smoothing.methods">smoothing.methods</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the smoothing method 
to use. The two possibilites are (i) <code>"direct"</code>, for directly 
smoothing the observed <code>response</code>, and (ii) <code>"logarithmic"</code>, for 
smoothing the <code>log</code>-transformed <code>response</code> and then 
back-transforming by taking the exponentional of the fitted values.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_correctboundaries">correctBoundaries</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether the fitted spline 
values are to have the method of Huang (2001) applied 
to them to correct for estimation bias at the end-points. Note that 
<code>spline.type</code> must be <code>NCSS</code> and <code>lambda</code> and <code>deriv</code> 
must be <code>NULL</code> for <code>correctBoundaries</code> to be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_get.rates">get.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> specifying whether or not the growth 
rates (AGR and RGR) are to be computed and stored.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_rates.method">rates.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the method to use in 
calculating the growth rates. The two possibilities are 
<code>"differences"</code> and <code>"derivates"</code>.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_facet.x">facet.x</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate columns of plots. 
Use <code>"."</code> if a split into columns is not wanted. For 
<code>which.plots</code> set to <code>methodscompare</code> or 
<code>dfcompare</code> , <code>facet.x</code> is ignored.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_facet.y">facet.y</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the variable to be used to 
form subsets to be plotted in separate rows of plots.
Use <code>"."</code> if a split into columns is not wanted.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_labeller">labeller</code></td>
<td>
<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> <code><a href="base.html#topic+function">function</a></code> for labelling the 
facets of a plot produced using the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
For more information see <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis. If <code>NULL</code> then set to <code>times.factor</code>.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_colour">colour</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying a single colour to use in 
drawing the lines for the profiles. If colouring according to the 
values of a variable is required then use <code>colour.column</code>.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_colour.column">colour.column</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of a column 
in <code>data</code> over whose values the colours of the lines are to be 
varied. The colours can be specified using <code>colour.values</code>.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_colour.values">colour.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector specifying the values of 
the colours to use in drawing the lines for the profiles.  
If this is a named vector, then the values will be matched based 
on the names. If unnamed, values will be matched in order 
(usually alphabetical) with the limits of the scale.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_alpha">alpha</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the degrees of transparency to 
be used in plotting. It is a ratio in which the denominator 
specifies the number of points (or lines) that must be overplotted 
to give a solid cover.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_trait.types">trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code>trait.types</code> that 
are to be produced, and potentially plotted. One of more of 
<code>response</code>, <code>AGR</code> and <code>RGR</code>. If <code>all</code>, all three 
traits are produced.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_propn.types">propn.types</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the proportion of the median 
values of each of the <code>trait.types</code> that are to be plotted in 
the <code>compare.medians</code> plots of the deviations of the observed 
values from the smoothed values. If set 
to <code>NULL</code>, the plots of the proportions of the median values of
the traits are omitted.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_propn.note">propn.note</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether a note giving the 
proportion of the median values plotted in the <code>compare.medians</code> 
plots.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_which.plots">which.plots</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the plots that are to be 
produced. If <code>none</code>, no plots are produced. If <code>smoothedonly</code>, 
plots of the smoothed traits are plotted. If <code>bothseparately</code>, 
plots of the unsmoothed trait followed by the smoothed traits are 
produced for each trait. If <code>methodscompare</code>, a combined plot of 
the smoothed traits for each <code>smoothing.methods</code> is produced, 
for each value of <code>df</code>. If <code>methods+rawcompare</code>, the unsmoothed 
trait is added to the combined plot. if <code>dfcompare</code>, a combined 
plot of the smoothed trait for each <code>df</code> is produced, for each
<code>smoothing.methods</code>. If <code>df+rawcompare</code>, the unsmoothed 
trait is added to the combined plot.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_deviations.plots">deviations.plots</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> is either <code>none</code> or any 
combination of <code>absolute.boxplots</code>, <code>relative.boxplots</code> and 
<code>compare.medians</code>. If <code>none</code>, no plots are produced. 
Boxplots of the absolute and relative deviations are specified by 
<code>absolute.boxplots</code> and  <code>relative.boxplots</code>. The absolute 
deviations are the values of a trait minus their smoothed values 
(observed - smoothed); the relative deviations are the absolute 
deviations divided by the smoothed values of the trait. The option 
<code>compare.medians</code> results in a plot that compares the medians 
of the deviations over the <code>times.factor</code> for each combination 
of the <code>smoothing.methods</code> and the <code>df</code>. The argument 
<code>trait.types</code> controls the traits for which boxplots are produced.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_alpha.med.devn">alpha.med.devn</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the degrees of 
transparency to be used in plotting a median deviations plot. 
It is a ratio in which the denominator specifies the number of 
points (or lines) that must be overplotted to give a solid cover.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_ggplotfuncs">ggplotFuncs</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element. Note that 
these functions are applied to all three plots produced.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_ggplotfuncsmeddevn">ggplotFuncsMedDevn</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code>, each element of which contains the 
results of evaluating a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function. 
It is created by calling the <code><a href="base.html#topic+list">list</a></code> function with 
a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> function call for each element. Note that 
these functions are applied to the <code>compare.median</code> deviations plots only.</p>
</td></tr>
<tr><td><code id="probeSmoothing_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to <code><a href="#topic+plotLongitudinal">plotLongitudinal</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing <code>individuals</code>, 
<code>times.factor</code>, <code>facet.x</code>, <code>facet.y</code>, <code>xname</code>, 
<code>response</code>, and, for each <code>df</code>, the smoothed 
response, the AGR and the RGR. It is returned invisibly. The names of 
the new data are constructed by joining elements separated by full 
stops (<code>.</code>). In all cases, the last element is the value of 
<code>df</code>. For the smoothed response, the other elements are 
<code>response</code> and <code>"smooth"</code>; for AGR and RGR, the other elements 
are the name of the smoothed response and either <code>"AGR"</code> or 
<code>"RGR"</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+splitSplines">splitSplines</a></code>, <code><a href="#topic+splitContGRdiff">splitContGRdiff</a></code>, <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", size=1),
              ggplot2::scale_x_continuous(breaks=seq(28, 42, by=2)))
probeSmoothing(data = longi.dat, response = "PSA", df = c(4,7), 
               xname = "xDAP", times = "DAP", 
               ggplotFuncs=vline)
</code></pre>

<hr>
<h2 id='probeSmooths'>For a response in a <code>data.frame</code> in long format, computes and compares, for 
sets of smoothing parameters, smooths of the response, possibly along with 
growth rates calculated from the smooths.</h2><span id='topic+probeSmooths'></span>

<h3>Description</h3>

<p>Takes an observed <code>response</code> and, for each <code>individual</code>, uses 
<code>byIndv4Times_SplinesGRs</code> to smooth its values employing the smoothing 
parameters specified by (i) <code>spline.types</code>, (ii) the tuning 
parameters, being the degrees of freedom values in <code>df</code> or the 
smoothing penalties in <code>lambdas</code>, and (iii) the 
<code>smoothing.methods</code>. The values of these, and other, smoothing 
arguments are set using the helper function 
<code><a href="#topic+args4smoothing">args4smoothing</a></code>.
</p>
<p>Provided <code>get.rates</code> is <code>TRUE</code> or includes <code>raw</code> and/or 
<code>smoothed</code> and depending on the setting 
of <code>trait.types</code>, the Absolute Growth Rates (AGR) and/or the 
Relative Growth Rates (RGR) are calculated for each individual from the 
unsmoothed, observed <code>response</code> and from the smooths of the 
<code>response</code>, using either differences or first derivatives, as 
specified by <code>rates.method</code>. 
</p>
<p>Generally, profile plots for the traits (a response, an AGR or an RGR) 
specified in <code>traits.types</code> are produced if <code>which.plots</code> is 
<code>profiles</code>; if <code>which.plots</code> specifies one or more deviations 
plots, then those deviations plots will also be produced, these being 
based on the unsmoothed data from which the smoothed data has been 
subtracted. The layout of the plots is controlled via combinations of 
one or more of the smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s <code>Type</code>, 
<code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code> (the combination 
of <code>TunePar</code> and <code>TuneVal</code>) and <code>Method</code>, as well as 
other <code><a href="base.html#topic+factor">factor</a></code>s associated with the <code>data</code>. 
The <code><a href="base.html#topic+factor">factor</a></code>s that are to be used for the profile plots 
are supplied via the argument <code>profile.plot.args</code> 
using the helper function <code><a href="#topic+args4profile_plot">args4profile_plot</a></code> and for the 
and deviations boxplots using the helper function 
<code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>. These helper functions set 
<code>plots.by</code>, <code>facet.x</code>, and <code>facet.y</code>. For the plots of 
the medians of the deviations, the <code><a href="base.html#topic+factor">factor</a></code>s are supplied via 
the argument <code>meddevn.plot.args</code> using the helper function 
<code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code> to set <code>plots.by</code>, <code>facet.x</code>, 
<code>facet.y</code> and <code>plots.group</code>. Here, the basic principle is that 
the number of levels combinations of the smoothing-parameter 
<code><a href="base.html#topic+factor">factor</a></code>s included in the set of <code>plots</code> and 
<code>facets</code> arguments to one of these helper functions must be the same 
as those covered by the combinations of the values supplied to 
<code>spline.types</code>, <code>df</code>, <code>lambdas</code> and <code>smoothing.methods</code> 
and incorporated into the <code><a href="#topic+smooths.frame">smooths.frame</a></code>, such as is 
returned by <code>probeSmooths</code>. This ensures that smooths 
from different parameter sets are not pooled together in a single plot. 
It is also possible to include <code><a href="base.html#topic+factor">factor</a></code>s that are not 
smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s in the <code>plots</code> amd 
<code>facets</code> arguments. 
</p>
<p>The following profiles plots can be produced using 
<code><a href="#topic+args4profile_plot">args4profile_plot</a></code>: (i) separate plots of the 
smoothed traits for each combination of the smoothing parameters 
(include <code>Type</code>, <code>Tuning</code> and <code>Method</code> in <code>plots.by</code>); 
(ii) as for (i), with the corresponding plot for the unsmoothed trait 
preceeding the plots for the smoothed trait (also set <code>include.raw</code> to 
<code>alone</code>); (iii) profiles plots that compare a smoothed trait for all 
combinations of the values of the smoothing parameters, arranging the plots 
side-by-side or one above the other (include <code>Type</code>, <code>Tuning</code> and 
<code>Method</code> in <code>facet.x</code> and/or <code>facet.y</code> - to include the 
unsmoothed trait set <code>include.raw</code> to one of <code>facet.x</code> or 
<code>facet.y</code>; (iv) as for (iii), except that separate plots are 
produced for each combination of the levels of the <code><a href="base.html#topic+factor">factor</a></code>s 
in <code>plot.by</code> and each plot compares the smoothed traits for the 
smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s included in <code>facet.x</code> 
and/or <code>facet.y</code> (set both <code>plots.by</code> and one or more of 
<code>facet.x</code> and <code>facet.y</code>). 
</p>
<p>Deviation plots that can be produced are the absolute and relative deviations 
boxplots and plots of medians deviations (see <code>which.plots</code>). 
</p>
<p>The handling of missing values is controlled via <code>na.x.action</code> and 
<code>na.y.action</code> supplied to the helper function <code><a href="#topic+args4smoothing">args4smoothing</a></code>.
</p>
<p>The <code>probeSmooths</code> arguments are grouped according to function in the following order:
</p>

<ol>
<li> <p><b>Data description arguments:</b> data, response, response.smoothed, 
individuals, times, keep.columns, trait.types, get.rates, 
rates.method, ntimes2span.
</p>
</li>
<li><p><b>Smoothing arguments:</b> smoothing.args (see <code><a href="#topic+args4smoothing">args4smoothing</a></code>).
</p>
</li>
<li>  <p><b>General plot control:</b> x.title, y.titles, facet.labeller, which.plots.
</p>
</li>
<li> <p><b>Profile plots (pf) features:</b> profile.plot.args (see <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>)
</p>
</li>
<li> <p><b>Median-deviations (med) plots features:</b> meddevn.plot.args (see <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>) 
</p>
</li>
<li> <p><b>Deviations boxplots (box) features:</b> devnboxes.plot.args (see <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>) 
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>probeSmooths(data, response = "PSA", response.smoothed = NULL, 
             individuals="Snapshot.ID.Tag", times = "DAP", 
             keep.columns = NULL, 
             get.rates = TRUE, 
             rates.method="differences", ntimes2span = NULL, 
             trait.types = c("response", "AGR", "RGR"), 
             smoothing.args = 
               args4smoothing(smoothing.methods = "direct", 
                              spline.types = "NCSS", 
                              df = NULL, lambdas = NULL), 
             x.title = NULL, y.titles = NULL, 
             which.plots = "profiles", 
             profile.plot.args = 
               args4profile_plot(plots.by = NULL, 
                                 facet.x = ".", facet.y = ".", 
                                 include.raw = "no"), 
             meddevn.plot.args = 
               args4meddevn_plot(plots.by = NULL, plots.group = NULL, 
                                 facet.x = ".", facet.y = ".",
                                 propn.note = TRUE, 
                                 propn.types = c(0.1, 0.5, 0.75)), 
             devnboxes.plot.args = 
               args4devnboxes_plot(plots.by = NULL, 
                                 facet.x = ".", facet.y = ".", 
                                 which.plots = "none"), 
             ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probeSmooths_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the data or a <code><a href="#topic+smooths.frame">smooths.frame</a></code> 
as is produced by <code>probeSmooths</code>. if <code>data</code> is not a 
<code><a href="#topic+smooths.frame">smooths.frame</a></code>, then smoothing will be performed. If <code>data</code> 
is a <code><a href="#topic+smooths.frame">smooths.frame</a></code>, then the plotting and selection of smooths 
will be performed as specified by <code>smoothing.args</code> and <code>which.plots</code>.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the response variable to be 
supplied to <code><a href="#topic+smoothSpline">smoothSpline</a></code> and that is to be plotted 
on the y-axis.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code>. If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used as the values of the predictor 
variable to be supplied to <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> and to be plotted 
on the x-axis. If a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, 
the values should be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_keep.columns">keep.columns</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the names of columns 
from <code>data</code> that are to be included in the 
<code><a href="#topic+smooths.frame">smooths.frame</a></code> that will be returned. Its main use is 
when no plots are being produced by <code>probeSmooths</code>, but there 
are columns in the supplied <code><a href="base.html#topic+data.frame">data.frame</a></code> that are likely 
to be needed for the <code>plots</code> and <code>facets</code> arguments when 
producing plots subsequently.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_get.rates">get.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> or a <code><a href="base.html#topic+character">character</a></code> specifying 
which of the <code>response</code> and the <code>response.smoothed</code> are to 
have growth rates (AGR and/or RGR) computed and stored. If set to 
<code>TRUE</code> or <code>c("raw", "smoothed")</code>, growth rates will be 
obtained for both. Setting to only one of <code>raw</code> or 
<code>smoothed</code>, results in the growth rates for either the 
<code>response</code> or the <code>response.smoothed</code> being computed. 
If set to <code>none</code> or <code>FALSE</code>, no growth rates ar computed. 
Which growth.rates are computed can be changed using the arguments 
<code>traits.types</code> and the method used for computing them for the 
<code>response.smooth</code> by <code>rates.method</code>. The growth rates for 
the <code>response</code> can only be computed by <code>differencing</code>.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_rates.method">rates.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the method to use in 
calculating the growth rates for <code>response.smoothed</code>. The two 
possibilities are <code>"differences"</code> and <code>"derivatives"</code>.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_ntimes2span">ntimes2span</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of values in 
<code>times</code> to span in calculating growth rates by differencing. 
For <code>ntimes2span</code> set to <code>NULL</code>, if <code>rates.method</code> 
is set to <code>differences</code> then <code>ntimes2span</code> is set to 2; 
if <code>rates.method</code> is set to <code>derivatives</code> then 
<code>ntimes2span</code> is set to 3. 
Note that when <code>get.rates</code> is includes <code>raw</code> or is 
<code>TRUE</code>, the growth rates for the unsmoothed response must be 
calculated by differencing, even if the growth rates for the 
smoothed response are computed using <code>derivatives</code>. When 
differencing, each growth rate is calculated as the difference in 
the values of one of the <code>responses</code> for pairs of <code>times</code> 
values that are spanned by <code>ntimes2span</code> <code>times</code> values 
divided by the difference between this pair of <code>times</code> values. 
For <code>ntimes2span</code> set to 2, a growth rate is the  
difference between consecutive pairs of values of one of the 
<code>responses</code> divided by the difference between consecutive 
pairs of <code>times</code> values.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_trait.types">trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code>trait.types</code> that 
are to be plotted. If growth rates are included in <code>trait.types</code>, 
then they will be computed for either the <code>response</code> and/or the 
<code>response.smoothed</code>, depending on the setting of <code>get.rates</code>. 
Any growth rates included in <code>trait.types</code> for the <code>response</code> 
that are available in <code>data</code>, but have not been specified for 
computation in <code>get.rates</code>, will be retained in the returned 
<code>smooths.frame</code>.
If <code>all</code>, the <code>response.smoothed</code>, its <code>AGR</code> and 
<code>RGR</code>, will be plotted. The <code>response</code>, and its <code>AGR</code> 
and <code>RGR</code>, will be plotted as the plotting options require it.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_smoothing.args">smoothing.args</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> that is most easily generated 
using <code><a href="#topic+args4smoothing">args4smoothing</a></code>, it documenting the 
options available for smoothing the data. It gives the settings of 
<code>smoothing.methods</code>, <code>spline.types</code>, <code>df</code>, <code>lambdas</code>, 
<code>smoothing.segments</code>, <code>npspline.segments</code>, <code>na.x.action</code>, 
<code>na.y.action</code>, <code>external.smooths</code>, and <code>correctBoundaries</code>, 
to be used in smoothing the <code>response</code> or in selecting a subset 
of the smooths in <code>data</code>, depending on whether <code>data</code> is a 
<code><a href="base.html#topic+data.frame">data.frame</a></code> or a <code><a href="#topic+smooths.frame">smooths.frame</a></code>, respectively. 
Set <code>smoothing.args</code> to <code>NULL</code> if <code>data</code> is a 
<code><a href="#topic+smooths.frame">smooths.frame</a></code> and only plotting or extraction of a chosen 
smooth is required.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis, used for all plots. If <code>NULL</code> then set to 
<code>times</code>.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_y.titles">y.titles</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the titles for the y-axis, 
one for each trait specified by <code>trait.types</code> and used for all plots. 
If <code>NULL</code> then set to the traits derived for <code>response</code> 
from <code>trait.types</code>.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_which.plots">which.plots</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating which plots are to be produced. 
The options are either <code>none</code> or some combination of <code>profiles</code>, 
<code>absolute.boxplots</code>, <code>relative.boxplots</code> and 
<code>medians.deviations</code>. The various <code>profiles</code> plots that can be 
poduced are described in the introduction to this function. 
</p>
<p>Boxplots of the absolute deviations are specified by 
<code>absolute.boxplots</code>, the absolute deviations being the values of a 
trait minus their smoothed values (observed - smoothed). Boxplots of the 
relative deviations are specified by <code>relative.boxplots</code>, the 
relative deviations being the absolute deviations divided by the smoothed 
values of the trait. 
</p>
<p>The option <code>medians.deviations</code> results 
in a plot that compares the medians of the absolute deviations over the 
values of <code>times</code> for each combination of the smoothing-parameter values. 
The arguments to <code>probeSmooths</code> that apply to <code>medians.deviations</code> 
plots have the suffix <code>med</code>.</p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_profile.plot.args">profile.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, it documenting the 
options available for varying profile plots and boxplots. <em>Note 
that if <code><a href="#topic+args4profile_plot">args4profile_plot</a></code> is to be called to change 
from the default settings given in the default <code>probeSmooths</code> call 
and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>; be aware that if you call 
<code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, then the defaults for this call are 
those for <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, <b>NOT</b> the call to 
<code><a href="#topic+args4profile_plot">args4profile_plot</a></code> shown as the default for 
<code>probeSmooths</code>.</em></p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_meddevn.plot.args">meddevn.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, it documenting the 
options available for varying median deviations plots. <em>Note 
that if <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code> is to be called to change 
from the default settings given in the default <code>probeSmooths</code> call 
and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>; be aware that if you call 
<code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, then the defaults for this call are 
those for <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, <b>NOT</b> the call to 
<code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code> shown as the default for 
<code>probeSmooths</code>.</em></p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_devnboxes.plot.args">devnboxes.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>, it documenting the 
options available for varying the boxplots. <em>Note 
that if <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code> is to be called to change 
from the default settings given in the default <code>probeSmooths</code> 
call and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>; be aware that if you call 
<code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>, then the defaults for this call 
are those for <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>, <b>NOT</b> the call 
to <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code> shown as the default for 
<code>probeSmooths</code>.</em></p>
</td></tr>
<tr><td><code id="probeSmooths_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to <code><a href="#topic+plotProfiles">plotProfiles</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+smooths.frame">smooths.frame</a></code> that contains the unsmoothed and smoothed data 
in long format. That is, all the values for either an unsmoothed or a 
smoothed trait are in a single column. The smooths for a trait for the 
different combinatons of the smoothing parameters are placed in rows one 
below the other. The columns that are included in the <code><a href="#topic+smooths.frame">smooths.frame</a></code> 
are <code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code> and <code>Method</code>, 
as well as those specified by <code>individuals</code>, <code>times</code>, <code>response</code>, and 
<code>response.smoothed</code>. and any included in the <code>keep.columns</code>, <code>plots</code> 
and <code>facet</code> arguments. 
If <code>trait.types</code> includes <code>AGR</code> or <code>RGR</code>, then the included growth 
rate(s) of the <code>response</code> and <code>response.smoothed</code> must be present, unless 
<code>get.rates</code> is TRUE or includes <code>raw</code> and/or <code>smoothed</code>. In this case, 
the growth rates specified by <code>trait.types</code> will be calculated for the responses 
nominated by <code>get.rates</code> and the differences between the <code>times</code> 
used in calculating the rates will be computed and added. Then, the names of the 
growth rates are formed from <code>response</code> and <code>response.smoothed</code> by 
appending <code>.AGR</code> and <code>.RGR</code> as appropriate; the name of the column with 
the <code>times</code> differences will be formed by appending <code>.diffs</code> to the 
value of <code>times</code>. The <code>external.smooths</code> will also be included. 
A <code><a href="#topic+smooths.frame">smooths.frame</a></code> has the attributes described in 
<code><a href="#topic+smooths.frame">smooths.frame</a></code>. 
</p>
<p>Columns in the supplied <code><a href="base.html#topic+data.frame">data.frame</a></code> that have not been used in 
<code>probeSmooths</code> will not be included in the returned <code><a href="#topic+smooths.frame">smooths.frame</a></code>. 
If they might be needed subsequently, such as when extra plots are produced, they 
can be included in the <code><a href="#topic+smooths.frame">smooths.frame</a></code> by listing them in a 
<code><a href="base.html#topic+character">character</a></code> vector for the <code>keep.columns</code> argument.
</p>
<p>The <code><a href="#topic+smooths.frame">smooths.frame</a></code> is returned invisibly.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+args4smoothing">args4smoothing</a></code>, , <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, 
<code><a href="#topic+traitSmooth">traitSmooth</a></code>, <br /> 
<code><a href="#topic+smoothSpline">smoothSpline</a></code>, <code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code>, <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>,  
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <code>psNormal</code>, <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code>, <br />
<code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- longi.dat[1:140,] #reduce to a smaller data set
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", linewidth=1))
yfacets &lt;- c("Smarthouse", "Treatment.1")
probeSmooths(data = longi.dat, 
             response = "PSA", response.smoothed = "sPSA",
             individuals = "Snapshot.ID.Tag",times = "DAP", 
             smoothing.args = 
               args4smoothing(df = c(4,7), 
                              lambda = list(PS = c(0.316,10))),
             profile.plot.args = 
               args4profile_plot(plots.by = NULL, 
                                 facet.x = "Tuning", 
                                 facet.y = c("Smarthouse", "Treatment.1"), 
                                 include.raw = "no", 
                                 alpha  = 0.4, 
                                 colour.column = "Method", 
                                 colour.values = c("orange", "olivedrab"), 
                                 ggplotFuncs = vline))

#An example that supplies three smoothing schemes to be compared
data(tomato.dat)
probeSmooths(data = tomato.dat, 
             response = "PSA", response.smoothed = "sPSA", 
             times = "DAP", 
             smoothing.args = 
               args4smoothing(spline.types      = c(  "N", "NCS",   "P"), 
                              df                = c(   4,     6,    NA), 
                              lambdas           = c(  NA,    NA,     1), 
                              smoothing.methods = c("dir", "log", "log"),
                              combinations      = "parallel"),
             which.plots = "medians.deviations",
             meddevn.plot.args = 
               args4meddevn_plot(plots.by = NULL, 
                                 plots.group = c("Type", "Tuning", "Method"),              
                                 facet.x = ".", facet.y = ".", 
                                 propn.note = FALSE, propn.types = NULL))

</code></pre>

<hr>
<h2 id='PVA'>Selects a subset of variables using Principal Variable Analysis (PVA)</h2><span id='topic+PVA'></span>

<h3>Description</h3>

<p>Principal Variable Analysis (PVA) (Cumming and Wooff, 2007) selects a subset 
from a set of the variables such that the variables in the subset are as 
uncorrelated as possible, in an effort to ensure that all aspects of the 
variation in the data are covered. </p>


<h3>Usage</h3>

<pre><code class='language-R'>PVA(obj, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PVA_+3A_obj">obj</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns of variables from which the 
selection is to be made.</p>
</td></tr>
<tr><td><code id="PVA_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PVA</code> is the generic function for the <code>PVA</code> method. 
Use methods(&quot;PVA&quot;) to get all the methods for the PVA generic.
</p>
<p><code><a href="#topic+PVA.data.frame">PVA.data.frame</a></code> is a method for a <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>
<p><code><a href="#topic+PVA.matrix">PVA.matrix</a></code> is a method for a <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the results of the variable selection. 
It will contain the columns <code>Variable</code>, <code>Selected</code>, 
<code>h.partial</code>, <code>Added.Propn</code> and <code>Cumulative.Propn</code>.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Cumming, J. A. and D. A. Wooff (2007) Dimension reduction via principal variables. <em>Computational Statistics
and Data Analysis</em>, <b>52</b>, 550&ndash;565.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVA.data.frame">PVA.data.frame</a></code>, <code><a href="#topic+PVA.matrix">PVA.matrix</a></code>, <code><a href="#topic+intervalPVA">intervalPVA</a></code>, <code><a href="#topic+rcontrib">rcontrib</a></code></p>

<hr>
<h2 id='PVA.data.frame'>Selects a subset of variables stored in a data.frame using Principal Variable Analysis (PVA)</h2><span id='topic+PVA.data.frame'></span>

<h3>Description</h3>

<p>Principal Variable Analysis (PVA) (Cumming and Wooff, 2007) selects a subset 
from a set of the variables such that the variables in the subset are as 
uncorrelated as possible, in an effort to ensure that all aspects of the 
variation in the data are covered. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
PVA(obj, responses, nvarselect = NULL, p.variance = 1, include = NULL, 
    plot = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PVA.data.frame_+3A_obj">obj</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns of variables from which the 
selection is to be made.</p>
</td></tr>
<tr><td><code id="PVA.data.frame_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> from which the variables are to be selected.</p>
</td></tr>
<tr><td><code id="PVA.data.frame_+3A_nvarselect">nvarselect</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the number of variables to be selected, 
which includes those listed in <code>include</code>. If <code>nvarselect = 1</code>, as 
many variables are selected as is need to satisfy <code>p.variance</code>.</p>
</td></tr>
<tr><td><code id="PVA.data.frame_+3A_p.variance">p.variance</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the minimum proportion of the variance 
that the selected variables must account for,</p>
</td></tr>
<tr><td><code id="PVA.data.frame_+3A_include">include</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> for the variables whose selection is mandatory.</p>
</td></tr>
<tr><td><code id="PVA.data.frame_+3A_plot">plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether a plot of the cumulative proportion 
of the variance explained is to be produced.</p>
</td></tr>
<tr><td><code id="PVA.data.frame_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variable that is most correlated with the other variables is selected first for inclusion. The partial correlation for each of the remaining variables, given the first selected variable, is calculated and the most correlated of these variables is selects for inclusion next. Then the partial correlations are adjust for the second included variables. This process is repeated until the specified criteria have been satisfied. The possibilities are:
</p>

<ol>
<li><p> the default (<code>nvarselect = NULL</code> and <code>p.variance = 1</code>), which selects all 
variables in increasing order of amount of information they provide;
</p>
</li>
<li><p> to select exactly <code>nvarselect</code> variables;
</p>
</li>
<li><p> to select just enough variables, up to a maximum of <code>nvarselect</code> variables, to explain 
at least <code>p.variance</code>*100 per cent of the total variance.
</p>
</li></ol>



<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the results of the variable selection. 
It will contain the columns <code>Variable</code>, <code>Selected</code>, 
<code>h.partial</code>, <code>Added.Propn</code> and <code>Cumulative.Propn</code>.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Cumming, J. A. and D. A. Wooff (2007) Dimension reduction via principal variables. <em>Computational Statistics
and Data Analysis</em>, <b>52</b>, 550&ndash;565.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVA">PVA</a></code>, <code><a href="#topic+PVA.matrix">PVA.matrix</a></code>, <code><a href="#topic+intervalPVA.data.frame">intervalPVA.data.frame</a></code>, <code><a href="#topic+rcontrib">rcontrib</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1)
longi.dat &lt;- within(longi.dat, 
                    {
                      Max.Height &lt;- pmax(Max.Dist.Above.Horizon.Line.SV1,  
                                         Max.Dist.Above.Horizon.Line.SV2)
                      Density &lt;- PSA/Max.Height
                      PSA.SV = (PSA.SV1 + PSA.SV2) / 2
                      Image.Biomass = PSA.SV * (PSA.TV^0.5)
                      Centre.Mass &lt;- (Center.Of.Mass.Y.SV1 + Center.Of.Mass.Y.SV2) / 2
                      Compactness.SV = (Compactness.SV1 + Compactness.SV2) / 2
                    })
responses &lt;- c("PSA","PSA.SV","PSA.TV", "Image.Biomass", "Max.Height","Centre.Mass",
               "Density", "Compactness.TV", "Compactness.SV")
results &lt;-  PVA(longi.dat, responses, p.variance=0.9, plot = FALSE)
</code></pre>

<hr>
<h2 id='PVA.matrix'>Selects a subset of variables using Principal Variable Analysis (PVA) based on a correlation matrix</h2><span id='topic+PVA.matrix'></span>

<h3>Description</h3>

<p>Principal Variable Analysis (PVA) (Cumming and Wooff, 2007) selects a subset 
from a set of the variables such that the variables in the subset are as 
uncorrelated as possible, in an effort to ensure that all aspects of the 
variation in the data are covered. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
PVA(obj, responses, nvarselect = NULL, p.variance = 1, include = NULL, 
    plot = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PVA.matrix_+3A_obj">obj</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> containing the correlation matrix for the variables from which the 
selection is to be made.</p>
</td></tr>
<tr><td><code id="PVA.matrix_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the rows and columns in 
<code>obj</code>, being the names of the variables from which the selection is to be made.</p>
</td></tr>
<tr><td><code id="PVA.matrix_+3A_nvarselect">nvarselect</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the number of variables to be selected, 
which includes those listed in <code>include</code>. If <code>nvarselect = 1</code>, as 
many variables are selected as is need to satisfy <code>p.variance</code>.</p>
</td></tr>
<tr><td><code id="PVA.matrix_+3A_p.variance">p.variance</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the minimum proportion of the variance 
that the selected variables must account for,</p>
</td></tr>
<tr><td><code id="PVA.matrix_+3A_include">include</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> for the variables whose selection is mandatory.</p>
</td></tr>
<tr><td><code id="PVA.matrix_+3A_plot">plot</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether a plot of the cumulative proportion 
of the variance explained is to be produced.</p>
</td></tr>
<tr><td><code id="PVA.matrix_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variable that is most correlated with the other variables is selected first for inclusion. The partial correlation for each of the remaining variables, given the first selected variable, is calculated and the most correlated of these variables is selects for inclusion next. Then the partial correlations are adjust for the second included variables. This process is repeated until the specified criteria have been satisfied. The possibilities are:
</p>

<ol>
<li><p> the default (<code>nvarselect = NULL</code> and <code>p.variance = 1</code>), which selects all 
variables in increasing order of amount of information they provide;
</p>
</li>
<li><p> to select exactly <code>nvarselect</code> variables;
</p>
</li>
<li><p> to select just enough variables, up to a maximum of <code>nvarselect</code> variables, to explain 
at least <code>p.variance</code>*100 per cent of the total variance.
</p>
</li></ol>



<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> giving the results of the variable selection. 
It will contain the columns <code>Variable</code>, <code>Selected</code>, 
<code>h.partial</code>, <code>Added.Propn</code> and <code>Cumulative.Propn</code>.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Cumming, J. A. and D. A. Wooff (2007) Dimension reduction via principal variables. <em>Computational Statistics
and Data Analysis</em>, <b>52</b>, 550&ndash;565.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVA">PVA</a></code>, <code><a href="#topic+PVA.data.frame">PVA.data.frame</a></code>, <code><a href="#topic+intervalPVA.data.frame">intervalPVA.data.frame</a></code>, <code><a href="#topic+rcontrib">rcontrib</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1)
longi.dat &lt;- within(longi.dat, 
                    {
                      Max.Height &lt;- pmax(Max.Dist.Above.Horizon.Line.SV1,  
                                         Max.Dist.Above.Horizon.Line.SV2)
                      Density &lt;- PSA/Max.Height
                      PSA.SV = (PSA.SV1 + PSA.SV2) / 2
                      Image.Biomass = PSA.SV * (PSA.TV^0.5)
                      Centre.Mass &lt;- (Center.Of.Mass.Y.SV1 + Center.Of.Mass.Y.SV2) / 2
                      Compactness.SV = (Compactness.SV1 + Compactness.SV2) / 2
                    })
responses &lt;- c("PSA","PSA.SV","PSA.TV", "Image.Biomass", "Max.Height","Centre.Mass",
               "Density", "Compactness.TV", "Compactness.SV")
R &lt;- Hmisc::rcorr(as.matrix(longi.dat[responses]))$r
results &lt;-  PVA(R, responses, p.variance=0.9, plot = FALSE)
</code></pre>

<hr>
<h2 id='rcontrib'>Computes a measure of how correlated each variable in a set is with the other variable, 
conditional on a nominated subset of them</h2><span id='topic+rcontrib'></span>

<h3>Description</h3>

<p>A measure of how correlated a variable is with those in a set is given by the 
square root of the sum of squares of the correlation coefficients between the 
variables and the other variables in the set (Cumming and Wooff, 2007). Here, the partial 
correlation  between the subset of the variables listed in <code>response</code> that 
are not listed in <code>include</code> is calculated from the partial correlation matrix 
for the subset, adjusting for those variables in <code>include</code>. This is useful 
for manually deciding which of the variables not in <code>include</code> should next be 
added to it.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcontrib(obj, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcontrib_+3A_obj">obj</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns of variables from which the 
correlation measure is to be calculated.</p>
</td></tr>
<tr><td><code id="rcontrib_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rcontrib</code> is the generic function for the <code>rcontrib</code> method. 
Use methods(&quot;rcontrib&quot;) to get all the methods for the rcontrib generic.
</p>
<p><code><a href="#topic+rcontrib.data.frame">rcontrib.data.frame</a></code> is a method for a <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>
<p><code><a href="#topic+rcontrib.matrix">rcontrib.matrix</a></code> is a method for a <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the correlation measures.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Cumming, J. A. and D. A. Wooff (2007) Dimension reduction via principal variables. <em>Computational Statistics
and Data Analysis</em>, <b>52</b>, 550&ndash;565.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVA">PVA</a></code>, <code><a href="#topic+intervalPVA">intervalPVA</a></code></p>

<hr>
<h2 id='rcontrib.data.frame'>Computes a measure of how correlated each variable in a set is with the other variable, 
conditional on a nominated subset of them</h2><span id='topic+rcontrib.data.frame'></span>

<h3>Description</h3>

<p>A measure of how correlated a variable is with those in a set is given by the 
square root of the sum of squares of the correlation coefficients between the 
variables and the other variables in the set (Cumming and Wooff, 2007). Here, the partial 
correlation  between the subset of the variables listed in <code>response</code> that 
are not listed in <code>include</code> is calculated from the partial correlation matrix 
for the subset, adjusting for those variables in <code>include</code>. This is useful 
for manually deciding which of the variables not in <code>include</code> should next be 
added to it.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
rcontrib(obj, responses, include = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcontrib.data.frame_+3A_obj">obj</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns of variables from which the 
correlation measure is to be calculated.</p>
</td></tr>
<tr><td><code id="rcontrib.data.frame_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> from which the correlation measure is to be calculated.</p>
</td></tr>
<tr><td><code id="rcontrib.data.frame_+3A_include">include</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> for the variables for which other variables are to be adjusted.</p>
</td></tr>
<tr><td><code id="rcontrib.data.frame_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the correlation measures.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Cumming, J. A. and D. A. Wooff (2007) Dimension reduction via principal variables. <em>Computational Statistics
and Data Analysis</em>, <b>52</b>, 550&ndash;565.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rcontrib">rcontrib</a></code>, <code><a href="#topic+rcontrib.matrix">rcontrib.matrix</a></code>, <code><a href="#topic+PVA">PVA</a></code>, <code><a href="#topic+intervalPVA.data.frame">intervalPVA.data.frame</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1)
longi.dat &lt;- within(longi.dat, 
                    {
                      Max.Height &lt;- pmax(Max.Dist.Above.Horizon.Line.SV1,  
                                         Max.Dist.Above.Horizon.Line.SV2)
                      Density &lt;- PSA/Max.Height
                      PSA.SV = (PSA.SV1 + PSA.SV2) / 2
                      Image.Biomass = PSA.SV * (PSA.TV^0.5)
                      Centre.Mass &lt;- (Center.Of.Mass.Y.SV1 + Center.Of.Mass.Y.SV2) / 2
                      Compactness.SV = (Compactness.SV1 + Compactness.SV2) / 2
                    })
responses &lt;- c("PSA","PSA.SV","PSA.TV", "Image.Biomass", "Max.Height","Centre.Mass",
               "Density", "Compactness.TV", "Compactness.SV")
h &lt;-  rcontrib(longi.dat, responses, include = "PSA")
</code></pre>

<hr>
<h2 id='rcontrib.matrix'>Computes a measure of how correlated each variable in a set is with the other variable, 
conditional on a nominated subset of them</h2><span id='topic+rcontrib.matrix'></span>

<h3>Description</h3>

<p>A measure of how correlated a variable is with those in a set is given by the 
square root of the sum of squares of the correlation coefficients between the 
variables and the other variables in the set (Cumming and Wooff, 2007). Here, the partial 
correlation  between the subset of the variables listed in <code>response</code> that 
are not listed in <code>include</code> is calculated from the partial correlation matrix 
for the subset, adjusting for those variables in <code>include</code>. This is useful 
for manually deciding which of the variables not in <code>include</code> should next be 
added to it.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
rcontrib(obj, responses, include = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcontrib.matrix_+3A_obj">obj</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> containing the correlations of the variables from which the 
correlation measure is to be calculated.</p>
</td></tr>
<tr><td><code id="rcontrib.matrix_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> from which the correlation measure is to be calculated.</p>
</td></tr>
<tr><td><code id="rcontrib.matrix_+3A_include">include</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> for the variables for which other variables are to be adjusted.</p>
</td></tr>
<tr><td><code id="rcontrib.matrix_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the correlation measures.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Cumming, J. A. and D. A. Wooff (2007) Dimension reduction via principal variables. <em>Computational Statistics
and Data Analysis</em>, <b>52</b>, 550&ndash;565.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rcontrib">rcontrib</a></code>, <code><a href="#topic+rcontrib.data.frame">rcontrib.data.frame</a></code>, <code><a href="#topic+PVA">PVA</a></code>, <code><a href="#topic+intervalPVA.data.frame">intervalPVA.data.frame</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- prepImageData(data=raw.dat, smarthouse.lev=1)
longi.dat &lt;- within(longi.dat, 
                    {
                      Max.Height &lt;- pmax(Max.Dist.Above.Horizon.Line.SV1,  
                                         Max.Dist.Above.Horizon.Line.SV2)
                      Density &lt;- PSA/Max.Height
                      PSA.SV = (PSA.SV1 + PSA.SV2) / 2
                      Image.Biomass = PSA.SV * (PSA.TV^0.5)
                      Centre.Mass &lt;- (Center.Of.Mass.Y.SV1 + Center.Of.Mass.Y.SV2) / 2
                      Compactness.SV = (Compactness.SV1 + Compactness.SV2) / 2
                    })
responses &lt;- c("PSA","PSA.SV","PSA.TV", "Image.Biomass", "Max.Height","Centre.Mass",
               "Density", "Compactness.TV", "Compactness.SV")
R &lt;- Hmisc::rcorr(as.matrix(longi.dat[responses]))$r
h &lt;- rcontrib(R, responses, include = "PSA")
</code></pre>

<hr>
<h2 id='RicePrepped.dat'>Prepped data from an experiment to investigate a rice germplasm panel.</h2><span id='topic+RicePrepped.dat'></span>

<h3>Description</h3>

<p>The data is the full set of Lanes and Positions from an experiment in a Smarthouse at the Plant Accelerator in Adelaide. It is used in the <code><a href="#topic+growthPheno-package">growthPheno-package</a></code> as an executable example to illustrate the use of <code>growthPheno</code>. The experiment and data collection are described in Al-Tamimi et al. (2016) and the data is derived from the <code><a href="base.html#topic+data.frame">data.frame</a></code> in the file <code>00-raw.0254.dat.rda</code> that is available from Al-Tamimi et al. (2017); halpf od the unprred data is in <code><a href="#topic+RiceRaw.dat">RiceRaw.dat</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RicePrepped.dat)</code></pre>


<h3>Format</h3>

<p>A data.frame containing 14784 observations on 32 variables. The names of the columns in the data.frame are: 
</p>

<table>
<tr>
 <td style="text-align: right;">
 Column </td><td style="text-align: left;"> Name        </td><td style="text-align: left;"> Class   </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>
<tr>
 <td style="text-align: right;">
  1 </td><td style="text-align: left;"> Smarthouse      </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the Smarthouse in which a cart occurs. </td>
</tr>
<tr>
 <td style="text-align: right;">
  2 </td><td style="text-align: left;"> Snapshot.ID.Tag </td><td style="text-align: left;"> character </td><td style="text-align: left;"> a unique identifier for each cart in the experiment. </td>
</tr>
<tr>
 <td style="text-align: right;">
  3 </td><td style="text-align: left;"> xDAP            </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the numbers of days after planting on which the current </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> data was observed. </td>
</tr>
<tr>
 <td style="text-align: right;">
  4 </td><td style="text-align: left;"> DAST            </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the numbers of days after the salting treatment on which </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> the current data was observed. </td>
</tr>
<tr>
 <td style="text-align: right;">
  5 </td><td style="text-align: left;"> xDAST           </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the numbers of days after the salting treatment on which </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> the current data was observed. </td>
</tr>
<tr>
 <td style="text-align: right;">
  6 </td><td style="text-align: left;"> cDAST           </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a centered numeric covariate for DAST. </td>
</tr>
<tr>
 <td style="text-align: right;">
  7 </td><td style="text-align: left;"> DAST.diffs      </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the number of days between this and the previous </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> observations (all one for this experiment). </td>
</tr>
<tr>
 <td style="text-align: right;">
  8 </td><td style="text-align: left;"> Lane            </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the Lane in the 24 Lane x 24 Positions grid. </td>
</tr>
<tr>
 <td style="text-align: right;">
  9 </td><td style="text-align: left;"> Position        </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the Position in the 24 Lane x 24 Positions grid. </td>
</tr>
<tr>
 <td style="text-align: right;">
 10 </td><td style="text-align: left;"> cPosn           </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a centered numeric covaariate for Positions. </td>
</tr>
<tr>
 <td style="text-align: right;"> 
 11 </td><td style="text-align: left;"> cMainPosn       </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a centered numeric covaariate for Main plots. </td>
</tr>
<tr>
 <td style="text-align: right;">
 12 </td><td style="text-align: left;"> Zone            </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the Zone of 4 Lanes to which the current cart belonged. </td>
</tr>
<tr>
 <td style="text-align: right;">
 13 </td><td style="text-align: left;"> cZone           </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a centered numeric covariate for Zone. </td>
</tr>
<tr>
 <td style="text-align: right;">
 14 </td><td style="text-align: left;"> SHZone          </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the Zone numbered across the two Smarthouses. </td>
</tr>
<tr>
 <td style="text-align: right;">
 15 </td><td style="text-align: left;"> ZLane           </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the number of the Lane within a Zone. </td>
</tr>
<tr>
 <td style="text-align: right;">
 16 </td><td style="text-align: left;"> ZMainunit       </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the number of the Main plot within a Zone. </td>
</tr>
<tr>
 <td style="text-align: right;">
 17 </td><td style="text-align: left;"> Subunit         </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the number of a Cart within a Main plot. </td>
</tr>
<tr>
 <td style="text-align: right;">
 18 </td><td style="text-align: left;"> Reps            </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the replicate number of each Genotype-Salinity combination. </td>
</tr>
<tr>
 <td style="text-align: right;">
 19 </td><td style="text-align: left;"> Genotype        </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the number assigned to the 298 Genotypes  in the experiment. </td>
</tr>
<tr>
 <td style="text-align: right;">
 20 </td><td style="text-align: left;"> Salinity        </td><td style="text-align: left;"> factor  </td><td style="text-align: left;"> the Salinity treatment (Control, Salt) allocated to a Cart. </td>
</tr>
<tr>
 <td style="text-align: right;">
 21 </td><td style="text-align: left;"> PSA             </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the Projected shoot area (kpixels). </td>
</tr>
<tr>
 <td style="text-align: right;">
 22 </td><td style="text-align: left;"> PSA.AGR         </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the Absolute Growth Rate for the Projected shoot area (kpixels/day). </td>
</tr>
<tr>
 <td style="text-align: right;">
 23 </td><td style="text-align: left;"> PSA.RGR         </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the Relative Growth Rate for the Projected shoot area (per day). </td>
</tr>
<tr>
 <td style="text-align: right;">
 24 </td><td style="text-align: left;"> Tr              </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the amount of water (g) transpired by a plant. </td>
</tr>
<tr>
 <td style="text-align: right;">
 25 </td><td style="text-align: left;"> TrR             </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the rate of water transpireation (g/day) for a plant. </td>
</tr>
<tr>
 <td style="text-align: right;">
 26 </td><td style="text-align: left;"> PSA.TUE         </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the Transpiration Use Efficiency for PSA (kpixels / day) </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> for a plant. </td>
</tr>
<tr>
 <td style="text-align: right;">
 27 </td><td style="text-align: left;"> sPSA            </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the smoothed Projected shoot area (kpixels). </td>
</tr>
<tr>
 <td style="text-align: right;">
 29 </td><td style="text-align: left;"> sPSA.AGR        </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the smoothed Absolute Growth Rate for the Projected shoot </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> area (kpixels/day). </td>
</tr>
<tr>
 <td style="text-align: right;">
 29 </td><td style="text-align: left;"> sPSA.RGR        </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the smoothed Relative Growth Rate for the Projected shoot </td>
</tr>
<tr>
 <td style="text-align: right;"> 
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> area (per day). </td>
</tr>
<tr>
 <td style="text-align: right;">
 30 </td><td style="text-align: left;"> sTr             </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the smoothed amount of water (g) transpired by a plant. </td>
</tr>
<tr>
 <td style="text-align: right;">
 31 </td><td style="text-align: left;"> sTrR            </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the smoothed rate of water transpireation (g/day) for a plant. </td>
</tr>
<tr>
 <td style="text-align: right;">
 32 </td><td style="text-align: left;"> sPSA.TUE        </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the smoothed Transpiration Use Efficiency for PSA (kpixels / day)  </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> for a plant. </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>


<h3>Source</h3>

<p>Al-Tamimi N, Brien C, Oakey H, Berger B, Saade S, Ho YS, Schmockel SM, Tester M, Negrao S. (2017) Data from: Salinity tolerance loci revealed in rice using high-throughput non-invasive phenotyping. Retrieved from: <a href="https://doi.org/10.5061/dryad.3118j">doi:10.5061/dryad.3118j</a>.</p>


<h3>References</h3>

<p>Al-Tamimi, N, Brien, C.J., Oakey, H., Berger, B., Saade, S., Ho, Y. S., Schmockel, S. M., Tester, M. and Negrao, S. (2016) New salinity tolerance loci revealed in rice using high-throughput non-invasive phenotyping. <em>Nature Communications</em>, <b>7</b>, 13342. Retrieved from <a href="https://doi.org/10.1038/ncomms13342">doi:10.1038/ncomms13342</a>.
</p>

<hr>
<h2 id='RiceRaw.dat'>Data for an experiment to investigate a rice germplasm panel</h2><span id='topic+RiceRaw.dat'></span>

<h3>Description</h3>

<p>The data is half (the first 12 of 24 Lanes) of that from an experiment in a Smarthouse at the Plant Accelerator in Adelaide. It is used in the <code><a href="#topic+growthPheno-package">growthPheno-package</a></code> as an executable example to illustrate the use of <code>growthPheno</code>. The experiment and data collection are described in Al-Tamimi et al. (2016) and the data is derived from the <code><a href="base.html#topic+data.frame">data.frame</a></code> in the file <code>00-raw.0255.dat.rda</code> that is available from Al-Tamimi et al. (2017). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RiceRaw.dat)</code></pre>


<h3>Format</h3>

<p>A data.frame containing 7392 observations on 33 variables.</p>


<h3>Source</h3>

<p>Al-Tamimi N, Brien C, Oakey H, Berger B, Saade S, Ho YS, Schmockel SM, Tester M, Negrao S: Data from: Salinity tolerance loci revealed in rice using high-throughput non-invasive phenotyping. Retrieved from: <a href="https://doi.org/10.5061/dryad.3118j">doi:10.5061/dryad.3118j</a>.</p>


<h3>References</h3>

<p>Al-Tamimi, N, Brien, C.J., Oakey, H., Berger, B., Saade, S., Ho, Y. S., Schmockel, S. M., Tester, M. and Negrao, S. (2016) New salinity tolerance loci revealed in rice using high-throughput non-invasive phenotyping. <em>Nature Communications</em>, <b>7</b>, 13342. Retrieved from <a href="https://doi.org/10.1038/ncomms13342">doi:10.1038/ncomms13342</a>.
</p>

<hr>
<h2 id='smooths.frame'>Description of a smooths.frame object</h2><span id='topic+smooths.frame'></span><span id='topic+smooths.frame-class'></span>

<h3>Description</h3>

<p>A <code>data.frame</code> of S3-class <code>smooths.frame</code> that stores the 
smooths of one or more responses for several sets of smoothing parameters.
</p>
<p><code><a href="#topic+as.smooths.frame">as.smooths.frame</a></code> is function that converts a 
<code><a href="base.html#topic+data.frame">data.frame</a></code> to an object of this class.
</p>
<p><code><a href="#topic+is.smooths.frame">is.smooths.frame</a></code> is the membership function for this class; it tests 
that an object has class <code>smooths.frame</code>.
</p>
<p><code><a href="#topic+validSmoothsFrame">validSmoothsFrame</a></code> can be used to test the validity of a 
<code>smooths.frame</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> that is also inherits the S3-class 
<code><a href="#topic+smooths.frame">smooths.frame</a></code>. It contains the results of smoothing a response 
over time from a set of <code>individuals</code>, the data being arranged in long 
format both with respect to the times and the smoothing-parameter values used in 
the smoothing. That is, each response occupies a single column. The 
<code><a href="#topic+smooths.frame">smooths.frame</a></code> must include the columns <code>Type</code>, <code>TunePar</code>, 
<code>TuneVal</code>, <code>Tuning</code> (the combination of <code>TunePar</code> and 
<code>TuneVal</code>) and <code>Method</code>, and the columns that would be nominated using 
the <code><a href="#topic+probeSmooths">probeSmooths</a></code> arguments <code>individuals</code>, the <code>plots</code> and 
<code>facet</code> arguments, <code>times</code>, <code>response</code>, <code>response.smoothed</code>, and, 
if requested, the AGR and the RGR of the <code>response</code> and <code>response.smoothed</code>. 
The names of the growth rates should be formed from <code>response</code> and 
<code>response.smoothed</code> by adding <code>.AGR</code> and <code>.RGR</code> to both of them. 
The function <code><a href="#topic+probeSmooths">probeSmooths</a></code> produces a <code><a href="#topic+smooths.frame">smooths.frame</a></code> 
for a response. 
</p>
<p>A <code><a href="#topic+smooths.frame">smooths.frame</a></code> has the following attributes: 
</p>

<ol>
<li> <p><code>individuals</code>, the <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that define the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual; 
</p>
</li>
<li> <p><code>n</code>, the number of unique <code>individuals</code>; 
</p>
</li>
<li> <p><code>times</code>, the <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+numeric">numeric</a></code>, or <code><a href="base.html#topic+factor">factor</a></code> with numeric levels, that 
contains the values of the predictor variable plotted on the x-axis;
</p>
</li>
<li> <p><code>t</code>, the number of unique values in the <code>times</code>; 
</p>
</li>
<li> <p><code>nschemes</code>, the number of unique combinations of the 
smoothing-parameter values in the <code>smoothsframe</code>. </p>
</li></ol>



<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+probeSmooths">probeSmooths</a></code>, <code><a href="#topic+is.smooths.frame">is.smooths.frame</a></code>, 
<code><a href="#topic+as.smooths.frame">as.smooths.frame</a></code>, <code><a href="#topic+validSmoothsFrame">validSmoothsFrame</a></code>, <code><a href="#topic+args4smoothing">args4smoothing</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- read.table(header = TRUE, text = "
Type TunePar TuneVal Tuning Method       ID  DAP   PSA      sPSA
NCSS      df       4   df-4 direct 045451-C   28 57.446 51.18456
NCSS      df       4   df-4 direct 045451-C   30 89.306 87.67343
NCSS      df       7   df-7 direct 045451-C   28 57.446 57.01589
NCSS      df       7   df-7 direct 045451-C   30 89.306 87.01316
")
dat[1:7] &lt;- lapply(dat[1:6], factor)
dat &lt;- as.smooths.frame(dat, individuals = "ID", times = "DAP")
is.smooths.frame(dat)
validSmoothsFrame(dat)

data(exampleData)
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", size=1))
smths &lt;- probeSmooths(data = longi.dat, 
                      response = "PSA", response.smoothed = "sPSA", 
                      times = "DAP", 
                      smoothing.args = 
                         args4smoothing(smoothing.methods = "direct", 
                                        spline.types = "NCSS", 
                                        df = c(4,7), lambdas = NULL), 
                      profile.plot.args = 
                        args4profile_plot(plots.by = NULL, 
                                          facet.x = "Tuning", 
                                          facet.y = "Treatment.1", 
                                          include.raw = "no", 
                                          ggplotFuncs = vline))
is.smooths.frame(smths)
validSmoothsFrame(smths)
</code></pre>

<hr>
<h2 id='smoothSpline'>Fit a spline to smooth the relationship between a <code>response</code> and an <code>x</code> in a <code>data.frame</code>, 
optionally computing growth rates using derivatives.</h2><span id='topic+smoothSpline'></span>

<h3>Description</h3>

<p>Uses <code>smooth.spline</code> to fit a natural cubic smoothing spline  or <code>JOPS</code> to fit a 
P-spline to all the values of <code>response</code> stored in <code>data</code>. 
</p>
<p>The amount of smoothing can be controlled by tuning parameters, these being 
related to the penalty. For a natural cubic smoothing spline, these are 
<code>df</code> or <code>lambda</code> and, for a P-spline, it is <code>lambda</code>. 
For a P-spline, <code>npspline.segments</code> also influences the smoothness of the fit. 
The <code>smoothing.method</code> provides for <code>direct</code> and <code>logarithmic</code> 
smoothing. The method of Huang (2001) for correcting the fitted spline for 
estimation bias at the end-points will be applied when fitting using a 
natural cubic smoothing spline if <code>correctBoundaries</code> is <code>TRUE</code>. 
</p>
<p>The derivatives of the fitted spline can also be obtained, and the 
Absolute and Relative Growth Rates ( AGR and RGR) computed using them, provided 
<code>correctBoundaries</code> is <code>FALSE</code>. Otherwise, growth rates can be 
obtained by difference using <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>.
</p>
<p>The handling of missing values in the observations is controlled via 
<code>na.x.action</code> and <code>na.y.action</code>. If there are not 
at least four distinct, nonmissing x-values, a warning is issued and 
all smoothed values and derivatives are set to <code>NA</code>. 
</p>
<p>The function <code><a href="#topic+probeSmooths">probeSmooths</a></code> can be used to investgate the effect 
the smoothing parameters (<code>smoothing.method</code> and <code>df</code> or  
<code>lambda</code>) on the smooth that results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothSpline(data, response, response.smoothed = NULL, x, 
             smoothing.method = "direct", 
             spline.type = "NCSS", df = NULL, lambda = NULL, 
             npspline.segments = NULL, correctBoundaries = FALSE, 
             rates = NULL, suffices.rates = NULL, sep.rates = ".", 
             extra.derivs = NULL, suffices.extra.derivs=NULL, 
             na.x.action = "exclude", na.y.action = "trimx", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothSpline_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column to be smoothed.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> that is to be smoothed.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code>. If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> that contains the values of the predictor variable.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_smoothing.method">smoothing.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the smoothing method 
to use. The two possibilites are (i) <code>"direct"</code>, for directly 
smoothing the observed <code>response</code>, and (ii) <code>"logarithmic"</code>, for 
smoothing the <code>log</code>-transformed <code>response</code> and then 
back-transforming by taking the exponentional of the fitted values.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_spline.type">spline.type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the type of spline  
to use. Currently, the possibilites are (i) <code>"NCSS"</code>, for natural 
cubic smoothing splines, and (ii) <code>"PS"</code>, for P-splines.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_df">df</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for natural cubic smoothing splines 
(<code>NCSS</code>), the desired equivalent number of degrees of freedom of the 
smooth (trace of the smoother matrix). Lower values result in more smoothing. 
If <code>df = NULL</code>, the amount of smoothing can be controlled by setting 
<code>lambda</code>. If both <code>df</code> and <code>lambda</code> are <code>NULL</code>, smoothing 
is controlled by the default arguments for <code>smooth.spline</code>, and any 
that you supply via the ellipsis (...) argument.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_lambda">lambda</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the positive penalty to apply. 
The amount of smoothing decreases as <code>lamda</code> decreases.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_npspline.segments">npspline.segments</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for P-splines (<code>PS</code>), 
the number of equally spaced segments between <code>min(x)</code> and <code>max(x)</code>, 
excluding missing values, to use in constructing the B-spline basis for the 
spline fitting. If <code>npspline.segments</code> is NULL, <code>npspline.segments</code> 
is set to the maximum of 10 and <code>ceiling((nrow(data)-1)/2)</code> i.e. there will 
be at least 10 segments and, for more than 22 <code>x</code> values, there will be 
half as many segments as there are <code>x</code> values. The amount of smoothing 
decreases as <code>npspline.segments</code> increases.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_correctboundaries">correctBoundaries</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether the fitted spline 
values are to have the method of Huang (2001) applied 
to them to correct for estimation bias at the end-points. Note that 
<code>spline.type</code> must be <code>NCSS</code> and <code>lambda</code> and <code>deriv</code> 
must be <code>NULL</code> for <code>correctBoundaries</code> to be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_rates">rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the growth rates that are 
to be calculated using derivative. It should be a combination of one or more 
of <code>"AGR"</code>, <code>"PGR"</code> and <code>"RGR"</code>. If <code>NULL</code>, then 
growth rates are not computed.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_suffices.rates">suffices.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the responses to provide the names of the 
columns containing the calculated growth rates. The order of the 
suffices in <code>suffices.rates</code> should correspond to the order 
of the elements of <code>which.rates</code>. If <code>NULL</code>, the values 
of <code>rates</code> are used.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_sep.rates">sep.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be used 
to separate the <code>suffices.rates</code> value from a <code>response</code> 
value in constructing the name for a new rate. For no separator, 
set to <code>""</code>.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_extra.derivs">extra.derivs</code></td>
<td>
<p>A <code>numeric</code> specifying one or more orders of derivatives 
that are required, in addition to any required for calculating the growth 
rates. When <code>rates.method</code> is <code>derivatives</code>, these can be 
derivatives other than the first. Otherwise, any derivatives can be 
specified.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_suffices.extra.derivs">suffices.extra.derivs</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to <code>response.method</code> to construct the names of the derivatives. 
If <code>NULL</code> and the derivatives are to be retained, then <code>.dv</code> 
followed by the order of the derivative is appended to 
<code>response.method</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="smoothSpline_+3A_na.x.action">na.x.action</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string that specifies the action to 
be taken when values of <code>x</code> are <code>NA</code>. The possible 
values are <code>fail</code>, <code>exclude</code> or <code>omit</code>. 
For <code>exclude</code> and <code>omit</code>, predictions and derivatives 
will only be obtained for nonmissing values of <code>x</code>. 
The difference between these two codes is that for <code>exclude</code> 
the returned <code>data.frame</code> will have as many rows as 
<code>data</code>, the missing values have been incorporated. </p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_na.y.action">na.y.action</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string that specifies the action to 
be taken when values of <code>y</code>, or the <code>response</code>, are 
<code>NA</code>.  The possible values are <code>fail</code>, <code>exclude</code>, 
<code>omit</code>, <code>allx</code>, <code>trimx</code>, <code>ltrimx</code> or 
<code>rtrimx</code>. For  all options, except <code>fail</code>, missing 
values in <code>y</code> will be removed before smoothing. 
For <code>exclude</code> and <code>omit</code>, predictions 
and derivatives will be obtained only for nonmissing values of 
<code>x</code> that do not have missing <code>y</code> values. Again, the 
difference between these two is that, only for <code>exclude</code> 
will the missing values be incorporated into the 
returned <code>data.frame</code>. For <code>allx</code>, predictions and 
derivatives will be obtained for all nonmissing <code>x</code>. 
For <code>trimx</code>, they will be obtained for all nonmissing 
<code>x</code> between the first and last nonmissing <code>y</code> values 
that have been ordered for <code>x</code>; for <code>ltrimx</code> and 
<code>utrimx</code> either the lower or upper missing <code>y</code> 
values, respectively, are trimmed.</p>
</td></tr>
<tr><td><code id="smoothSpline_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code>smooth.spline</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> with two components named <code>predictions</code> and 
<code>fit.spline</code>.
</p>
<p>The <code>predictions</code> component is a <code>data.frame</code> containing <code>x</code> 
and the fitted smooth. The names of the columns will be the value of 
<code>x</code> and the value of <code>response.smoothed</code>. The number of rows in 
the <code>data.frame</code> will be equal to the number of pairs that have neither 
a missing <code>x</code> or <code>response</code> and the order of <code>x</code> will be the 
same as the order in <code>data</code>. If <code>deriv</code> is not <code>NULL</code>, 
columns containing the values of the derivative(s) will be added to the 
<code>data.frame</code>; the name each of these columns will be the value of 
<code>response.smoothed</code> with <code>.dvf</code> appended, where <code>f</code> is the 
order of the derivative, or  the value of <code>response.smoothed</code> and the 
corresponding element of <code>suffices.deriv</code> appended. If <code>RGR</code> is 
not <code>NULL</code>, the RGR is calculated as the ratio of value of the first 
derivative of the fitted spline and the fitted value for the spline.
</p>
<p>The <code>fit.spline</code> component is a <code><a href="base.html#topic+list">list</a></code> with components
</p>

<dl>
<dt><code>x</code>:</dt><dd><p>the distinct x values in increasing order;</p>
</dd>
<dt><code>y</code>:</dt><dd><p>the fitted values, with boundary values possibly corrected, and corresponding to <code>x</code>;</p>
</dd>
<dt><code>lev</code>:</dt><dd><p>leverages, the diagonal values of the smoother matrix (NCSS only);</p>
</dd>
<dt><code>lambda</code>:</dt><dd><p>the value of lambda (corresponding to <code>spar</code> for NCSS - see <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>);</p>
</dd> 
<dt><code>df</code>:</dt><dd><p>the efective degrees of freedom;</p>
</dd>
<dt><code>npspline.segments</code>:</dt><dd><p>the number of equally spaced segments used for smoothing method set to <code>PS</code>;</p>
</dd>
<dt><code>uncorrected.fit</code>:</dt><dd><p>the object returned by <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> for <code>smoothing method</code> set to <code>NCSS</code> or by <code>JOPS::psNormal</code> for <code>PS</code>.</p>
</dd></dl>



<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Eilers, P.H.C and Marx, B.D. (2021) <em>Practical smoothing: the joys of P-splines</em>. Cambridge University Press, Cambridge.
</p>
<p>Huang, C. (2001) Boundary corrected cubic smoothing splines. <em>Journal of Statistical Computation and Simulation</em>, <b>70</b>, 107-121.</p>


<h3>See Also</h3>

<p><code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code>, <code><a href="#topic+probeSmoothing">probeSmoothing</a></code>, 
<code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>, <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <br />
<code><a href="stats.html#topic+predict.smooth.spline">predict.smooth.spline</a></code>, JOPS.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
fit &lt;- smoothSpline(longi.dat, response="PSA", response.smoothed = "sPSA", 
                    x="xDAP", df = 4,
                    rates = c("AGR", "RGR"))
fit &lt;- smoothSpline(longi.dat, response="PSA", response.smoothed = "sPSA", 
                    x="xDAP", df = 4,
                    rates = "AGR", suffices.rates = "AGRdv", 
                    extra.derivs =  2, suffices.extra.derivs = "Acc")
fit &lt;- smoothSpline(longi.dat, response="PSA", response.smoothed = "sPSA", 
                    x="xDAP", 
                    spline.type = "PS", lambda = 0.1, npspline.segments = 10, 
                    rates = "AGR", suffices.rates = "AGRdv", 
                    extra.derivs =  2, suffices.extra.derivs = "Acc")
fit &lt;- smoothSpline(longi.dat, response="PSA", response.smoothed = "sPSA", 
                    x="xDAP", df = 4,
                    rates = "AGR", suffices.rates = "AGRdv")
</code></pre>

<hr>
<h2 id='splitContGRdiff'>Adds, to a <code>data.frame</code>, the growth rates for individuals calculated 
continuously over time by differencing response values.</h2><span id='topic+splitContGRdiff'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+AGRdiff">AGRdiff</a></code>, <code><a href="#topic+PGR">PGR</a></code> and 
<code><a href="#topic+RGRdiff">RGRdiff</a></code> to calculate growth rates continuously 
over time for the <code>response</code> by differencing pairs of pairs 
of <code>response</code> values  and 
stores the results in <code>data</code>. The subsets are those values 
with the same levels combinations of the <code><a href="base.html#topic+factor">factor</a></code>s listed in 
<code>individuals</code>.
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+byIndv4Times_GRsDiff">byIndv4Times_GRsDiff</a></code>.</strong></p>


<h3>Usage</h3>

<pre><code class='language-R'>splitContGRdiff(data, responses, 
                individuals = "Snapshot.ID.Tag", INDICES = NULL,
                which.rates = c("AGR","PGR","RGR"), suffices.rates=NULL, 
                times.factor = "Days", avail.times.diffs = FALSE, 
                ntimes2span = 2)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitContGRdiff_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns for which 
growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="splitContGRdiff_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> for which growth rates are to be calculated.</p>
</td></tr>
<tr><td><code id="splitContGRdiff_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name(s) of the 
<code><a href="base.html#topic+factor">factor</a></code>(s) that define the subsets of <code>response</code> 
that correspond to the <code>response</code> values for an individual 
(e.g. plant, pot, cart, plot or unit) for which growth rates are 
to be calculated continuously. If the columns corresponding to 
<code>individuals</code> are not <code><a href="base.html#topic+factor">factor</a></code>(s) then they will 
be coerced to <code><a href="base.html#topic+factor">factor</a></code>(s). The subsets are formed using 
<code><a href="base.html#topic+split">split</a></code>.</p>
</td></tr>
<tr><td><code id="splitContGRdiff_+3A_indices">INDICES</code></td>
<td>
<p>A pseudonym for <code>individuals</code>.</p>
</td></tr>
<tr><td><code id="splitContGRdiff_+3A_which.rates">which.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the growth rates that are 
to be calculated. It should be a combination of one or more of 
<code>"AGR"</code>, <code>"PGR"</code> and <code>"RGR"</code>.</p>
</td></tr>
<tr><td><code id="splitContGRdiff_+3A_times.factor">times.factor</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the <code><a href="base.html#topic+factor">factor</a></code> for times at which the data was 
collected. Its levels will be used in calculating growth rates and 
should be numeric values stored as characters.</p>
</td></tr>
<tr><td><code id="splitContGRdiff_+3A_avail.times.diffs">avail.times.diffs</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether there is an 
appropriate column of <code>times</code> diffserences that can be used as 
the denominator in computing the growth rates. If <code>TRUE</code>, it will 
be assumed that the name of the column is the value of  <code>times</code> 
with <code>.diffs</code> appended. If <code>FALSE</code>, a column, whose 
column name will be the value of <code>times</code> with <code>.diffs</code> 
appended, will be formed and saved in the result, overwriting any 
existing columns with the constructed name in <code>data</code>. It will 
be calculated using the values of times in <code>data</code>.</p>
</td></tr>
<tr><td><code id="splitContGRdiff_+3A_ntimes2span">ntimes2span</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of values in 
<code>times</code> to span in calculating growth rates by differencing. 
Each growth rate is calculated as the difference in the values of 
one of the <code>responses</code> for pairs of <code>times</code> values that 
are spanned by <code>ntimes2span</code> <code>times</code> values divided by 
the difference between this pair of <code>times</code> values. For 
<code>ntimes2span</code> set to 2, a growth rate is the  
difference between consecutive pairs of values of one of the 
<code>responses</code> divided by the difference between consecutive 
pairs of <code>times</code> values.</p>
</td></tr>
<tr><td><code id="splitContGRdiff_+3A_suffices.rates">suffices.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the responses to provide the names of the 
columns containing the calculated growth rates. The order of the 
suffices in <code>suffices.rates</code> should correspond to the order 
of the elements of <code>which.rates</code>. If <code>NULL</code>, the values 
of <code>which.rates</code> are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing  <code>data</code> to which has been 
added 9i) a column for the differences between the <code>times</code>, 
if it is not already in <code>data</code>, and (ii) columns with growth rates. 
The name of the column for <code>times</code> differences will be the 
<code>times</code> with <code>".diffs"</code> appended. The name for each of the 
growth-rate columns will be either the value of <code>response</code> with 
one of <code>".AGR"</code>, <code>".PGR"</code> or <code>"RGR"</code>, or the 
corresponding value from <code>suffices.rates</code> appended. Each growth 
rate will be positioned at observation 
<code>ceiling(ntimes2span + 1) / 2</code> relative to the two times from 
which the growth rate is calculated.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitSpline">fitSpline</a></code>, <code><a href="#topic+splitSplines">splitSplines</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- splitContGRdiff(data = longi.dat, 
                             response="sPSA", times.factor = "DAP", 
                             individuals = "Snapshot.ID.Tag", 
                             which.rates=c("AGR", "RGR"), 
                             avail.times.diffs = TRUE)
</code></pre>

<hr>
<h2 id='splitSplines'>Adds the fits, and optionally growth rates computed from derivatives, after 
fitting splines to a response for an individual stored in a <code>data.frame</code> 
in long format</h2><span id='topic+splitSplines'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+fitSpline">fitSpline</a></code> to fit a spline to a subset of the values 
of <code>response</code> and stores the fitted values in <code>data</code>. 
The subsets are those values with the same levels combinations 
of the <code><a href="base.html#topic+factor">factor</a></code>s listed in <code>individuals</code>. The degree of smoothing 
is controlled by the tuning parameters <code>df</code> and <code>lambda</code>, 
related to the penalty, and by <code>npspline.segments</code>. The <code>smoothing.method</code> 
provides for <code>direct</code> and <code>logarithmic</code> smoothing. 
</p>
<p>The derivatives of the fitted spline can also be obtained, and the 
Absolute and Relative Growth Rates ( AGR and RGR) computed using them, provided 
<code>correctBoundaries</code> is <code>FALSE</code>. Otherwise, growth rates can be 
obtained by difference using <code><a href="#topic+splitContGRdiff">splitContGRdiff</a></code>.
</p>
<p>The handling of missing values in the observations is controlled via 
<code>na.x.action</code> and <code>na.y.action</code>. If there are not 
at least four distinct, nonmissing x-values, a warning is issued and 
all smoothed values and derivatives are set to <code>NA</code>. 
</p>
<p>The function <code><a href="#topic+probeSmoothing">probeSmoothing</a></code> can be used to investgate the effect 
the smoothing parameters (<code>smoothing.method</code>, <code>df</code> or  
<code>lambda</code>) on the smooth that results.
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+byIndv4Times_SplinesGRs">byIndv4Times_SplinesGRs</a></code>.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitSplines(data, response, response.smoothed = NULL, x, 
             individuals = "Snapshot.ID.Tag", INDICES = NULL,
             smoothing.method = "direct", smoothing.segments = NULL, 
             spline.type = "NCSS", df=NULL, lambda = NULL, 
             npspline.segments = NULL, 
             correctBoundaries = FALSE, 
             deriv = NULL, suffices.deriv = NULL, extra.rate = NULL, 
             sep = ".", 
             na.x.action="exclude", na.y.action = "exclude", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitSplines_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column to be smoothed.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> that is to be smoothed.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code>. If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which 
<code>.smooth</code> is added.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> that contains the values of the predictor variable.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name(s) of the 
<code><a href="base.html#topic+factor">factor</a></code>(s) that define the subsets of <code>response</code> 
that correspond to the <code>response</code> values for an individual 
(e.g. plant, pot, cart, plot or unit) that are to be smoothed 
separately. If the columns corresponding to <code>individuals</code> 
are not <code><a href="base.html#topic+factor">factor</a></code>(s) then they will be coerced to 
<code><a href="base.html#topic+factor">factor</a></code>(s). The subsets are formed 
using <code><a href="base.html#topic+split">split</a></code>.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_indices">INDICES</code></td>
<td>
<p>A pseudonym for <code>individuals</code>.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_smoothing.method">smoothing.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the smoothing method 
to use. The two possibilites are (i) <code>"direct"</code>, for directly 
smoothing the observed <code>response</code>, and (ii) <code>"logarithmic"</code>, for 
smoothing the <code>log</code>-transformed <code>response</code> and then 
back-transforming by taking the exponentional of the fitted values.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_smoothing.segments">smoothing.segments</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code>, each of whose components 
is a numeric pair specifying the first and last values of an 
<code>x</code>-interval whose data is to be subjected as an entity to smoothing 
using splines. The separate smooths will be combined to form a whole 
smooth for each individual. If <code>smoothing.segments</code> is <code>NULL</code>, 
the data is not segmented for smoothing.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_spline.type">spline.type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the type of spline  
to use. Currently, the possibilites are (i) <code>"NCSS"</code>, for natural 
cubic smoothing splines, and (ii) <code>"PS"</code>, for P-splines.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_df">df</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for natural cubic smoothing splines 
(<code>NCSS</code>), the desired equivalent number of degrees of freedom of the 
smooth (trace of the smoother matrix). Lower values result in more smoothing. 
If <code>df = NULL</code>, the amount of smoothing can be controlled by setting 
<code>lambda</code>. If both <code>df</code> and <code>lambda</code> are <code>NULL</code>, smoothing 
is controlled by the default arguments for <code>smooth.spline</code>, and any 
that you supply via the ellipsis (...) argument.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_lambda">lambda</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying the positive penalty to apply. 
The amount of smoothing decreases as <code>lamda</code> decreases.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_npspline.segments">npspline.segments</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> specifying, for P-splines (<code>PS</code>), 
the number of equally spaced segments between <code>min(x)</code> and <code>max(x)</code>, 
excluding missing values, to use in constructing the B-spline basis for the 
spline fitting. If <code>npspline.segments</code> is NULL, <code>npspline.segments</code> 
is set to the maximum of 10 and <code>ceiling((nrow(data)-1)/2)</code> i.e. there will 
be at least 10 segments and, for more than 22 <code>x</code> values, there will be 
half as many segments as there are <code>x</code> values. The amount of smoothing 
decreases as <code>npspline.segments</code> increases. When the data has been 
segmented for smoothing (<code>smoothing.segments</code> is not <code>NULL</code>), 
an <code>npspline.segments</code> value can be supplied for each segment.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_correctboundaries">correctBoundaries</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether the fitted spline 
values are to have the method of Huang (2001) applied 
to them to correct for estimation bias at the end-points. Note that 
<code>spline.type</code> must be <code>NCSS</code> and <code>lambda</code> and <code>deriv</code> 
must be <code>NULL</code> for <code>correctBoundaries</code> to be set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_deriv">deriv</code></td>
<td>
<p>A <code>numeric</code> specifying one or more orders of derivatives 
that are required.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_suffices.deriv">suffices.deriv</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the derivatives. If <code>NULL</code> 
and the derivative is to be retained then <code>smooth.dv</code> 
is appended.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_extra.rate">extra.rate</code></td>
<td>
<p>A named <code><a href="base.html#topic+character">character</a></code> nominating a single growth 
rate (<code>AGR</code> or <code>RGR</code>) to be computed using the first 
derivative, which one being dependent on the <code>smoothing.method</code>. 
The name of this element will used as a suffix to be appended to 
the response when naming the resulting growth rate (see Examples). 
If unamed, <code>AGR</code> or <code>RGR</code> will be used, as appropriate. 
Note that, for the <code>smoothing.method</code> set to <code>direct</code>, 
the first derivative is the AGR and so <code>extra.rate</code> must be set 
to <code>RGR</code>, which is computed as the <code>AGR / smoothed response</code>. 
For the <code>smoothing.method</code> set to <code>logarithmic</code>, 
the first derivative is the RGR and so <code>extra.rate</code> must be set 
to <code>AGR</code>, which is computed as the <code>RGR * smoothed response</code>. 
Make sure that <code>deriv</code> includes one so that the first derivative 
is available for calculating the <code>extra.rate</code>.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_sep">sep</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use when the 
levels of <code>individuals</code> are combined. This is needed to avoid 
using a <code><a href="base.html#topic+character">character</a></code> that occurs in a <code><a href="base.html#topic+factor">factor</a></code> to delimit 
levels when the levels of <code>individuals</code> are combined to identify 
subsets.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_na.x.action">na.x.action</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string that specifies the action to 
be taken when values of <code>x</code> are <code>NA</code>. The possible 
values are <code>fail</code>, <code>exclude</code> or <code>omit</code>. 
For <code>exclude</code> and <code>omit</code>, predictions and derivatives 
will only be obtained for nonmissing values of <code>x</code>. 
The difference between these two codes is that for <code>exclude</code> the returned 
<code>data.frame</code> will have as many rows as <code>data</code>, the 
missing values have been incorporated. </p>
</td></tr>
<tr><td><code id="splitSplines_+3A_na.y.action">na.y.action</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string that specifies the action to 
be taken when values of <code>y</code>, or the <code>response</code>, are 
<code>NA</code>.  The possible values are <code>fail</code>, <code>exclude</code>, 
<code>omit</code>, <code>allx</code>, <code>trimx</code>, <code>ltrimx</code> or 
<code>rtrimx</code>. For  all options, except <code>fail</code>, missing 
values in <code>y</code> will be removed before smoothing. 
For <code>exclude</code> and <code>omit</code>, predictions 
and derivatives will be obtained only for nonmissing values of 
<code>x</code> that do not have missing <code>y</code> values. Again, the 
difference between these two is that, only for <code>exclude</code> 
will the missing values be incorporated into the 
returned <code>data.frame</code>. For <code>allx</code>, predictions and 
derivatives will be obtained for all nonmissing <code>x</code>. 
For <code>trimx</code>, they will be obtained for all nonmissing 
<code>x</code> between the first and last nonmissing <code>y</code> values 
that have been ordered for <code>x</code>; for <code>ltrimx</code> and 
<code>utrimx</code> either the lower or upper missing <code>y</code> 
values, respectively, are trimmed.</p>
</td></tr>
<tr><td><code id="splitSplines_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code>smooth.spline</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing  <code>data</code> to which has been 
added a column with the fitted smooth, the name of the column being 
<code>response.smoothed</code>. If <code>deriv</code> is not <code>NULL</code>, 
columns containing the values of the derivative(s) will be added 
to <code>data</code>; the name each of these columns will be the value of 
<code>response.smoothed</code> with <code>.dvf</code> appended, where <code>f</code> 
is the order of the derivative, or  the value of <code>response.smoothed</code> 
with the corresponding element of <code>suffices.deriv</code> appended. 
If <code>RGR</code> is not <code>NULL</code>, the RGR is calculated as the ratio 
of value of the first derivative of the fitted spline and the fitted 
value for the spline. 
Any pre-existing smoothed and derivative columns in <code>data</code> will be 
replaced. The ordering of the <code>data.frame</code> for the <code>x</code> 
values will be preserved as far as is possible; the main difficulty 
is with the handling of missing values by the function <code>merge</code>. 
Thus, if missing values in <code>x</code> are retained, they will occur at 
the bottom of each subset of <code>individuals</code> and the order will be 
problematic when there are missing values in <code>y</code> and 
<code>na.y.action</code> is set to <code>omit</code>.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Eilers, P.H.C and Marx, B.D. (2021) <em>Practical smoothing: the joys of P-splines</em>. Cambridge University Press, Cambridge.
</p>
<p>Huang, C. (2001) Boundary corrected cubic smoothing splines. <em>Journal of Statistical Computation and Simulation</em>, <b>70</b>, 107-121.</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitSpline">fitSpline</a></code>, <code><a href="#topic+probeSmoothing">probeSmoothing</a></code>, <code><a href="#topic+splitContGRdiff">splitContGRdiff</a></code>, 
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>, <code><a href="stats.html#topic+predict.smooth.spline">predict.smooth.spline</a></code>, <br />
<code><a href="base.html#topic+split">split</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
#smoothing with growth rates calculated using derivates
longi.dat &lt;- splitSplines(longi.dat, response="PSA", x="xDAP", 
                          individuals = "Snapshot.ID.Tag", 
                          df = 4, deriv=1, suffices.deriv="AGRdv", 
                          extra.rate = c(RGRdv = "RGR"))
#Use P-splines
longi.dat &lt;- splitSplines(longi.dat, response="PSA", x="xDAP", 
                          individuals = "Snapshot.ID.Tag", 
                          spline.type = "PS", lambda = 0.1, npspline.segments = 10, 
                          deriv=1, suffices.deriv="AGRdv", 
                          extra.rate = c(RGRdv = "RGR"))
#with segmented smoothing
longi.dat &lt;- splitSplines(longi.dat, response="PSA", x="xDAP", 
                          individuals = "Snapshot.ID.Tag", 
                          smoothing.segments = list(c(28,34), c(35,42)), df = 5)
</code></pre>

<hr>
<h2 id='splitValueCalculate'>Calculates a single value that is a function of an individual's values for a response</h2><span id='topic+splitValueCalculate'></span>

<h3>Description</h3>

<p>Splits the values of a response into subsets corresponding 
individuals and applies a function that calculates a single 
value from each individual's observations.
It includes the ability to calculate the observation number 
that is closest to the calculated value of the function and 
the assocated values of a <code><a href="base.html#topic+factor">factor</a></code> or <code>numeric</code>.
</p>
<p><strong>Note: this function is soft deprecated and may be removed in 
future versions. <br /> Use <code><a href="#topic+byIndv_ValueCalc">byIndv_ValueCalc</a></code>.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitValueCalculate(response, weights=NULL, individuals = "Snapshot.ID.Tag", 
                    FUN = "max", which.obs = FALSE, which.values = NULL, 
                    data, na.rm=TRUE, sep=".", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitValueCalculate_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> from which the values of <code>FUN</code> are to be  
calculated.</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_weights">weights</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the weights to be supplied as <code>w</code> 
to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_fun">FUN</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the <code>function</code> 
that calculates the value for each subset.</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_which.obs">which.obs</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether or not to determine 
the observation number corresponding to the observed value that is 
closest to the value of the function, in addition to the value of 
the function itself. That is, <code>FUN</code> need not return an observed 
value of the <code>reponse</code>, e.g. <code>quantile</code>. In the case of 
multiple observed response values satisfying this condition, 
the first is returned.</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_which.values">which.values</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+numeric">numeric</a></code> whose values are 
associated with the <code>response</code> values and whose value is to be 
returned for the observation number whose <code>response</code> value 
corresponds to the observed value closest to the value of the 
function. That is, <code>FUN</code> need not return an observed value of 
the <code>reponse</code>, e.g. <code>quantile</code>. In the case of multiple 
observed response values satisfying this condition, the value of 
the <code>which.values</code> vector for the first of these is 
returned.</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the column from which the 
function is to be calculated.</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code>  indicating whether <code>NA</code> values 
should be stripped before the calculation proceeds.</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_sep">sep</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use when the 
levels of <code>individuals</code> are combined. This is needed to avoid 
using a <code><a href="base.html#topic+character">character</a></code> that occurs in a <code><a href="base.html#topic+factor">factor</a></code> to delimit 
levels when the levels of <code>individuals</code> are combined to 
identify subsets.</p>
</td></tr>
<tr><td><code id="splitValueCalculate_+3A_...">...</code></td>
<td>
<p>allows for arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>, with the same number of rows as there are 
<code>individuals</code>, containing a column for the <code>individuals</code> and 
a column with the values of the function for the <code>individuals</code>. 
It is also possible to determine observaton numbers or the values of 
another column in <code>data</code> for the <code>response</code> values that are 
closest to the <code>FUN</code> results, using either or both of 
<code>which.obs</code> and <code>which.values</code>. If <code>which.obs</code> is 
<code>TRUE</code>, a column with observation numbers is included in the  
<code><a href="base.html#topic+data.frame">data.frame</a></code>. 
If <code>which.values</code> is set to the name of a <code><a href="base.html#topic+factor">factor</a></code> or 
a <code><a href="base.html#topic+numeric">numeric</a></code>,a column containing the levels of that 
<code><a href="base.html#topic+factor">factor</a></code> or the values of that <code><a href="base.html#topic+numeric">numeric</a></code> is 
included in the  <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>
<p>The name of the column with the values of the function will be formed by  
concatenating the <code>response</code> and <code>FUN</code>, separated by a full stop. 
If <code>which.obs</code> is <code>TRUE</code>, the column name for the obervations 
numbers will have <code>.obs</code> added after <code>FUN</code> into the column name 
for the function values; if <code>which.values</code> is specified, 
the column name for these values will have a full stop followed by 
<code>which.values</code> added after <code>FUN</code> into the column name 
for the function values.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+intervalValueCalculate">intervalValueCalculate</a></code>, <code><a href="#topic+splitContGRdiff">splitContGRdiff</a></code>,
<code><a href="#topic+splitSplines">splitSplines</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
sPSA.max.dat &lt;- splitValueCalculate("sPSA", data = longi.dat)
AGR.max.dat &lt;- splitValueCalculate("sPSA.AGR", FUN="max", data=longi.dat, 
                                    which.values = "DAP", which.obs = TRUE)
sPSA.dec1.dat &lt;- splitValueCalculate("sPSA", FUN="quantile", data=longi.dat, 
                                     which.values = "DAP", probs = 0.1)
</code></pre>

<hr>
<h2 id='tomato.dat'>Longitudinal data for an experiment to investigate tomato response to mycorrhizal fungi and zinc</h2><span id='topic+tomato.dat'></span>

<h3>Description</h3>

<p>The data is from an experiment in a Smarthouse in the Plant Accelerator and is decribed by Watts-Williams et al. (2019). The experiment involves 32 plants, each placed in a pot in a cart, and the carts were assigned 8 treatments using a randomized complete-block design. The main response is Projected Shoot Area (PSA for short), being the sum of the plant pixels from three images. The eight treatments were the combinations of 4 Zinc (Zn) levels by two Arbuscular Mycorrhiza Fungi (AMF) levls.  Each plant was imaged on 35 different days after planting (DAPs). It is used to explore the analysis of growth dynamics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tomato.dat)</code></pre>


<h3>Format</h3>

<p>A data.frame containing 1120 observations on 16 variables. The names of the columns in the data.frame are: 
</p>

<table>
<tr>
 <td style="text-align: right;">
 Column </td><td style="text-align: left;"> Name        </td><td style="text-align: left;"> Class   </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>
<tr>
 <td style="text-align: right;">
  1 </td><td style="text-align: left;"> Lane            </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the Lane in the 2 Lane x 16 Positions grid. </td>
</tr>
<tr>
 <td style="text-align: right;">
  2 </td><td style="text-align: left;"> Position        </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the Position in the 2 Lane x 16 Positions grid. </td>
</tr>
<tr>
 <td style="text-align: right;">
  3 </td><td style="text-align: left;"> DAP             </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the numbers of days after planting on which the current </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">        </td><td style="text-align: left;"> data was observed. </td>
</tr>
<tr>
 <td style="text-align: right;">
  4 </td><td style="text-align: left;"> Snapshot.ID.Tag </td><td style="text-align: left;"> character </td><td style="text-align: left;"> a unique identifier for each cart in the experiment. </td>
</tr>
<tr>
 <td style="text-align: right;">
  5 </td><td style="text-align: left;"> cDAP            </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a centered numeric covariate for DAP. </td>
</tr>
<tr>
 <td style="text-align: right;">
  6 </td><td style="text-align: left;"> DAP.diffs       </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the number of days between this and the previous </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">        </td><td style="text-align: left;"> observations (all one for this experiment). </td>
</tr>
<tr>
 <td style="text-align: right;">
  7 </td><td style="text-align: left;"> cPosn           </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a centered numeric covaariate for Positions. </td>
</tr>
<tr>
 <td style="text-align: right;">
  8 </td><td style="text-align: left;"> Block           </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the block of the randomized complete-block design to </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">        </td><td style="text-align: left;"> which the current cart belonged. </td>
</tr>
<tr>
 <td style="text-align: right;">
  9 </td><td style="text-align: left;"> Cart            </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the number of the cart within a block. </td>
</tr>
<tr>
 <td style="text-align: right;">
 10 </td><td style="text-align: left;"> AMF             </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the AMF treatment (- AMF, +AMF) assigned to the </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">        </td><td style="text-align: left;"> cart. </td>
</tr>
<tr>
 <td style="text-align: right;">
 11 </td><td style="text-align: left;"> Zn              </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the Zinc level (0, 10, 40, 90) assigned to the cart. </td>
</tr>
<tr>
 <td style="text-align: right;">
 12 </td><td style="text-align: left;"> Treatments      </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> the combined factor formed from AMF and Zn with</td>
</tr>
<tr>
 <td style="text-align: right;"> 
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">        </td><td style="text-align: left;"> levels: (-,0;  -,10; -,40; -,90; +,0;  +,10; +,40; +,90). </td>
</tr>
<tr>
 <td style="text-align: right;">
 12 </td><td style="text-align: left;"> Weight.After    </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the weight of the cart after watering. </td>
</tr>
<tr>
 <td style="text-align: right;">
 13 </td><td style="text-align: left;"> Water.Amount    </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the weight of the water added to the cart. </td>
</tr>
<tr>
 <td style="text-align: right;">
 14 </td><td style="text-align: left;"> WU              </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the weight of the water used since the previous watering. </td>
</tr>
<tr>
 <td style="text-align: right;">
 15 </td><td style="text-align: left;"> PSA             </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the Projected Shoot Area, being the total number of </td>
</tr>
<tr>
 <td style="text-align: right;"> 
    </td><td style="text-align: left;">                 </td><td style="text-align: left;">         </td><td style="text-align: left;"> plant pixels in three plant images.
</td>
</tr>

</table>


<h3>References</h3>

<p>Watts-Williams SJ, Jewell N, Brien C, Berger B, Garnett T, Cavagnaro TR (2019) Using high-throughput phenotyping to explore growth responses to mycorrhizal fungi and zinc in three plant species. <em>Plant Phenomics</em>, <b>2019</b>, 12.
</p>

<hr>
<h2 id='traitExtractFeatures'>Extract features, that are single-valued for each individual, from traits observed over time.</h2><span id='topic+traitExtractFeatures'></span>

<h3>Description</h3>

<p>Extract one or more sets of features from traits observed over time, the result being 
traits that have a single value for each individual. The sets of features are:
</p>

<ol>
<li> <p><b>single times</b> &ndash; the value for each individual for a single time. 
(uses <code>getTimesSubset</code>)
</p>
</li>
<li> <p><b>growth rates for a time interval</b> &ndash; the average growth rate (AGR 
and/or RGR) over a time interval for each individual. 
(uses <code>byIndv4Intvl_GRsDiff</code> or <code>byIndv4Intvl_GRsAvg</code>)
</p>
</li>
<li> <p><b>water use traits for a time interval</b> &ndash; the total water use (WU), 
the water use rate (WUR) and the water use index (WUI) over a time 
interval for each individual. (uses <code>byIndv4Intvl_WaterUse</code>)
</p>
</li>
<li> <p><b>growth rates for the imaging period overall</b> &ndash; the average growth rate (AGR 
and/or RGR) over the whole imaging period for each individual. 
(uses <code>byIndv4Intvl_GRsDiff</code> or <code>byIndv4Intvl_GRsAvg</code>)
</p>
</li>
<li> <p><b>water use traits for the imaging period overall</b> &ndash; the total water use (WU), 
the water use rate (WUR) and the water use index (WUI) for the whole imaging 
period for each individual. (uses <code>byIndv4Intvl_WaterUse</code>)
</p>
</li>
<li> <p><b>totals for the imaging period overall</b> &ndash; the total over the whole imaging 
period of a trait for each individual. (uses <code>byIndv4Intvl_ValueCalc</code>)
</p>
</li>
<li> <p><b>maximum for the imaging period overall</b> &ndash; the maximum value over the whole 
imaging period, and the time at which it occurred, for each individual. 
(uses <code>byIndv4Intvl_ValueCalc</code>)
</p>
</li></ol>

<p>The <code>Tomato</code> vignette illustrates the use of <code><a href="#topic+traitSmooth">traitSmooth</a></code> and 
<code>traitExtractFeatures</code> to carry out the SET procedure for the example 
presented in Brien et al. (2020). 
Use <code>vignette("Tomato", package = "growthPheno")</code> to access it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traitExtractFeatures(data, individuals = "Snapshot.ID.Tag", times = "DAP", 
                     starts.intvl = NULL, stops.intvl = NULL, 
                     suffices.intvl = NULL, 
                     responses4intvl.rates = NULL, 
                     growth.rates = NULL, 
                     growth.rates.method = "differences", 
                     suffices.growth.rates = NULL, 
                     water.use4intvl.traits = NULL, 
                     responses4water = NULL, 
                     water.trait.types = c("WU", "WUR", "WUI"), 
                     suffix.water.rate = "R", suffix.water.index = "I", 
                     responses4singletimes = NULL, times.single = NULL, 
                     responses4overall.rates = NULL, 
                     water.use4overall.water = NULL, 
                     responses4overall.water = NULL, 
                     responses4overall.totals = NULL, 
                     responses4overall.max = NULL, 
                     intvl.overall = NULL, suffix.overall = NULL, 
                     sep.times.intvl = "to", sep.suffix.times = ".", 
                     sep.growth.rates = ".", sep.water.traits = "", 
                     mergedata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traitExtractFeatures_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns specified by 
<code>individuals</code>, <code>times</code>, the various <code>responses</code> 
arguments and the <code>water.use argument</code>.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+factor">factor</a></code>, or 
<code><a href="base.html#topic+character">character</a></code>. It will be used identifying the intervals and,  
if a <code><a href="base.html#topic+factor">factor</a></code> or <code><a href="base.html#topic+character">character</a></code>, the values should 
be numerics stored as characters.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_starts.intvl">starts.intvl</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, in terms of values in 
<code>times</code>, that are the initial times for a set of intervals for which 
<code>growth.rates</code> and <code>water.use</code> traits are to be obtained. 
These times may also be used to obtain values for single-time traits 
(see <code>responses4singletimes</code>).</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_stops.intvl">stops.intvl</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times, in terms of values in 
<code>times</code>, that are the end times for a set of intervals for which 
<code>growth.rates</code> and <code>water.use</code> traits are to be obtained. 
These times may also be used to obtain values for single-time traits 
(see <code>responses4singletimes</code>).</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_suffices.intvl">suffices.intvl</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffices for intervals 
specified using <code>starts.intvl</code> and <code>stops.intvl</code>. If <code>NULL</code>, 
the suffices are automatically generated using <code>starts.intvl</code>, 
<code>stops.intvl</code> and <code>sep.times.intvl</code>.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_responses4intvl.rates">responses4intvl.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the names of the columns 
containing responses for which growth rates are to be obtained for 
the intervals specified by <code>starts.intvl</code> and <code>stops.intvl</code>. 
For <code>growth.rates.method</code> set to <code>differences</code>, the growth rates will 
be computed from the column of the <code>response</code> values whose name is 
listed in <code>responses4intvl.rates</code>.  For <code>growth.rates.method</code> set to 
<code>derivatives</code>, the growth rates will be computed from a column with 
the growth rates computed for each time. The name of the column should be 
a <code>response</code> listed in <code>responses4intvl.rates</code> to which is appended an 
element of <code>suffices.growth.rates</code>.</p>
</td></tr> 
<tr><td><code id="traitExtractFeatures_+3A_growth.rates.method">growth.rates.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the method to use  
in calculating the growth rates over an interval for the responses 
specified by <code>responses4intvl.rates</code>. 
The two possibilities are <code>"differences"</code> and <code>"ratesaverages"</code>. 
For <code>differences</code>, the growth rate for an interval is computed 
by taking differences between the values of a response for pairs 
of <code>times</code>. For <code>ratesaverage</code>, the growth rate for an interval 
is computed by  taking weighted averages of growth rates for times within 
the interval. That is, <code>differences</code> operates on the  response and 
<code>ratesaverage</code> operates on the growth rates previously calculated 
from the response, so that the appropriate one of these must be in 
<code>data</code>. The <code>ratesaverage</code> option is most appropriate when the 
growth rates are calculated using the derivatives of a fitted curve. 
Note that, for responses for which the AGR has been calculated using 
differences, both methods will give the same result, but the 
<code>differences</code> option will  be more efficient than <code>ratesaverages</code>.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_growth.rates">growth.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying which growth rates are 
to be obtained for the intervals specified by <code>starts.intvl</code> and 
<code>stops.intvl</code>. It should contain one of both of <code>"AGR"</code> and 
<code>"RGR"</code>.</p>
</td></tr> 
<tr><td><code id="traitExtractFeatures_+3A_suffices.growth.rates">suffices.growth.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffices appended to  
<code>responses4intvl.rates</code> in constructung the column names for the 
storing the growth rates specified by <code>growth.rates</code>. If 
<code>suffices.growth.rates</code> is <code>NULL</code>, then <code>"AGR"</code> and 
<code>"RGR"</code> will be used.</p>
</td></tr> 
<tr><td><code id="traitExtractFeatures_+3A_water.use4intvl.traits">water.use4intvl.traits</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> that contain the water use values that are to be used 
in computing the water use traits (WU, WUR, WUI) for the intervals 
specified by <code>starts.intvl</code> and <code>stops.intvl</code>. If there is 
only one column name, then the <code>WUI</code> will be calculated using 
this name for all column names in <code>responses4water</code>. If there 
are several  column names in <code>water.use4intvl.traits</code>, then there must be 
either one or the same number of names in <code>responses4water</code>. 
If both have same number of names, then the two lists of column names 
will be processed in parallel, so that a single <code>WUI</code> will be 
produced for each pair of <code>responses4water</code> and <code>water.use4intvl.traits</code> 
values.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_responses4water">responses4water</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns  
in <code>data</code> that are to provide the numerator in calculating a 
<code>WUI</code> for the intervals specified using <code>starts.intvl</code> and 
<code>stops.intvl</code>. The denominator will be the values in the columns 
in <code>data</code> whose names are those given by <code>water.use4intvl.traits</code>. 
If there is only one column name in <code>responses4water</code>, then the 
<code>WUI</code> will be calculated using this name for all column names in 
<code>responses4water</code>. If there are several column names in 
<code>responses4water</code>, then there must be either one or the same 
number of names in <code>water.use4intvl.traits</code>. If both have same number of 
names, then the two lists of column names will be 
processed in parallel, so that a single <code>WUI</code> will be produced 
for each pair of <code>responses4water</code> and <code>water.use4intvl.traits</code> values. 
</p>
<p>See the <code>Value</code> section for a description of how 
<code>responses4water</code> is incorporated into the names constructed for 
the water use traits.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_water.trait.types">water.trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> listing the trait types to compute
and return. It should be some combination of <code>WU</code>, <code>WUR</code> 
and <code>WUI</code>. See Details in <code><a href="#topic+byIndv4Intvl_WaterUse">byIndv4Intvl_WaterUse</a></code> for 
how each is calculated.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_suffix.water.rate">suffix.water.rate</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the label to be appended 
to the value of <code>water.use4intvl.traits</code> to form the name of the WUR.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_suffix.water.index">suffix.water.index</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the label to be appended 
to the value of <code>water.use4intvl.traits</code> to form the name of the WUI.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_responses4singletimes">responses4singletimes</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the names of the 
columns containing <code>responses</code> for which a column of the values is 
to be formed for each response for each of the times values specified in 
<code>times.single</code>. If  <code>times.single</code> is <code>NULL</code>, then the  
unique values in the combined <code>starts.intvl</code> and <code>stops.intvl</code> 
will be used.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_times.single">times.single</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the times of imaging, for each of 
which, the values of each <code>responses4singletimes</code> will be stored in 
a column of the resulting <code><a href="base.html#topic+data.frame">data.frame</a></code>. If <code>NULL</code>, then 
the  unique values in the combined <code>starts.intvl</code> and <code>stops.intvl</code> 
will be used.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_responses4overall.rates">responses4overall.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the names of the  
columns containing responses for which growth rates are to be obtained 
for the whole imaging period i.e. the interval specified by 
<code>intvl.overall</code>. The settings of <code>growth.rates.method</code>, 
<code>growth.rates</code>, <code>suffices.growth.rates</code>, 
<code>sep.growth.rates</code>, <code>suffix.overall</code> and <code>intvl.overall</code> 
will be used in producing the growth rates. See <code>responses4intvl.rates</code> 
for more information about how these arguments are used.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_water.use4overall.water">water.use4overall.water</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether the overall 
water.traits are to be obtained. The settings of <code>water.trait.types</code>, 
<code>suffix.water.rate</code>, <code>suffix.water.index</code>, <code>sep.water.traits</code>, 
<code>suffix.overall</code> and <code>intvl.overall</code> will be used in producing the 
overall water traits. See <code>water.use4intvl.traits</code> for more information about 
how these arguments are used.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_responses4overall.water">responses4overall.water</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns  
in <code>data</code> that are to provide the numerator in calculating a 
<code>WUI</code> for the interval corresponding to the whole imaging period. 
See <code>response.water</code> for further details. See <code>responses4water</code> 
for more information about how this argument is processed.</p>
</td></tr> 
<tr><td><code id="traitExtractFeatures_+3A_responses4overall.totals">responses4overall.totals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the names of the 
columns containing responses for which a column of the values is 
to be formed by summing the response for each individual over the 
whole of the imaging period.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_responses4overall.max">responses4overall.max</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the names of the 
columns containing responses for which columns of the values are 
to be formed for the maximum of the response for each 
individual over the whole of the imaging period and the <code>times</code> value 
at which the maximum occurred.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_intvl.overall">intvl.overall</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the starts and stop times of imaging. 
If <code>NULL</code>, the start time will be the minimum of <code>starts.intvl</code> 
and the stop time will be the maximum of <code>stops.intvl</code>.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_suffix.overall">suffix.overall</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the suffix to be appended to  
the names of traits that apply to the whole imagng period. It applies to 
<code>overall.growth.rates</code>, <code>water.use4overall.water</code>, 
<code>responses4overall.water</code> and <code>responses4overall.totals</code>. 
If <code>NULL</code>, then nothing will be added.</p>
</td></tr> 
<tr><td><code id="traitExtractFeatures_+3A_sep.times.intvl">sep.times.intvl</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use in 
combining a <code>starts.intvl</code> with a <code>stops.intvl</code> in constructing 
the suffix to be appended to an interval trait. If set to <code>NULL</code> and 
there is only one value for each of <code>starts.intvl</code> and 
<code>stops.intvl</code>, then no suffix will be added; otherwise 
<code>sep.times.intvl</code> set to <code>NULL</code> will result in an error.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_sep.suffix.times">sep.suffix.times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the separator to use in 
appending a suffix for times to a trait. For no separator, set to 
<code>""</code>.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_sep.growth.rates">sep.growth.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be 
used to separate the <code>suffices.growth.rates</code> value from the 
<code>responses4intvl.rates</code> values in constructing the name for a 
new rate. It is also used for separating <code>responses4water</code> 
values from the <code>suffix.water.index</code>. For no separator, set to 
<code>""</code>.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_sep.water.traits">sep.water.traits</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the character(s) to be 
used to separate the <code>suffix.rate</code> and <code>suffix.index</code> values 
from the <code>response</code> value in constructing the name for a new 
rate/index. The default of <code>""</code> results in no separator.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_mergedata">mergedata</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing a column with the name given 
in <code>individuals</code> and for which there is only one row for each value 
given in this column. In general, it will be that the number of rows in 
<code>mergedata</code>  is equal to the number of unique values in the column in 
<code>data</code> labelled by the value of <code>individuals</code>, but this is not 
mandatory. If <code>mergedata</code> is not <code>NULL</code>, the values extracted by 
<code>traitExtractFeatures</code> will be <code><a href="base.html#topic+merge">merge</a></code>d with it.</p>
</td></tr>
<tr><td><code id="traitExtractFeatures_+3A_...">...</code></td>
<td>
<p>allows passing of arguments to other functions; not used at present.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> that contains an <code>individuals</code> column and a 
column for each extracted trait, in addition to any columns in <code>mergedata</code>. 
The number of rows in the <code><a href="base.html#topic+data.frame">data.frame</a></code> will equal the number of 
unique element of the  <code>individuals</code> column in <code>data</code>, except when 
there are extra values in the <code>individuals</code> column in <code>data</code>. If the 
latter applies, then the number of rows will equal the number of unique 
values in the combined <code>individuals</code> columns from <code>mergedata</code> and 
<code>data</code>. 
</p>
<p>The names of the columns produced by the function are constructed as follows: 
</p>

<ol>
<li> <p><b>single times</b> &ndash; A name for a single-time trait is formed by appending 
a full stop to an element of <code>responses4singletimes</code>, followed by the value of 
<code>times</code> at which the values were observed.
</p>
</li>
<li> <p><b>growth rates for a time interval</b> &ndash;  The name for an interval growth 
rate is constructed by concatenating the relevant element of <code>responses4intvl.rates</code>, 
<code>growth.rates</code> and a suffix for the time interval, each separated by a full 
stop. The interval suffix is formed by joining its <code>starts.intvl</code> and 
<code>stops.intvl</code> values, separating them by the value of <code>sep.times.intvl</code>.
</p>
</li>
<li> <p><b>growth rates for the whole imaging period</b> &ndash;  The name for an interval growth 
rate is constructed by concatenating the relevant element of <code>responses4intvl.rates</code>, 
<code>growth.rates</code> and <code>suffix.overall</code>, each separated by a full 
stop.
</p>
</li>
<li> <p><b>water use traits for a time interval</b> &ndash; Construction of the names for 
the three water traits begins with the value of <code>water.use4intvl.traits</code>. The rate (WUR) 
has either <code>R</code> or the value of <code>suffix.water.rate</code> added to the value of 
<code>water.use4intvl.traits</code>. Similarly the index (WUI) has either <code>I</code> or the value of 
<code>suffix.water.index</code> added to it. The WUI also has the element of 
<code>responses4water</code> used in calculating the WUI prefixed to its name. 
All three water use traits have a suffix for the interval appended to their names. 
This suffix is contructed by joining its <code>starts.intvl</code> and <code>stops.intvl</code>, 
separated by the value of <code>sep.times.intvl</code>.
</p>
</li>
<li> <p><b>water use traits for the whole imaging period</b> &ndash; Construction of the names for 
the three water traits begins with the value of <code>water.use4intvl.traits</code>. The rate (WUR) 
has either <code>R</code> or the value of <code>suffix.water.rate</code> added to the value of 
<code>water.use4intvl.traits</code>. Similarly the index (WUI) has either <code>I</code> or the value of 
<code>suffix.water.index</code> added to it. The WUI also has the element of 
<code>responses4water</code> used in calculating the WUI prefixed to its name. 
All three water use traits have <code>suffix.overall</code> appended to their names.
</p>
</li>
<li> <p><b>the total for the whole of imaging period</b> &ndash; The name for whole-of-imaging 
total is formed by combining an element of<code>responses4overall.totals</code>  with <code>suffix.overall</code>, 
separating them by a full stop.
</p>
</li>
<li> <p><b>maximum for the whole of imaging period</b> &ndash; The name of the column with the 
maximum values will be the result of concatenating the <code>responses4overall.max</code>, <code>"max"</code> 
and <code>suffix.overall</code>, each separated by a full stop. The name of the column with 
the value of <code>times</code> at which the maximum occurred will be the result of 
concatenating the <code>responses4overall.max</code>, <code>"max"</code> and the value of <code>times</code>,  
each separated by a full stop.
</p>
</li></ol>

<p>The <code><a href="base.html#topic+data.frame">data.frame</a></code> is returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Brien, C., Jewell, N., Garnett, T., Watts-Williams, S. J., &amp; Berger, B. (2020). Smoothing and extraction of traits in the growth analysis of noninvasive phenotypic data. <em>Plant Methods</em>, <b>16</b>, 36. <a href="https://doi.org/10.1186/s13007-020-00577-6">doi:10.1186/s13007-020-00577-6</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getTimesSubset">getTimesSubset</a></code>, <code><a href="#topic+byIndv4Intvl_GRsAvg">byIndv4Intvl_GRsAvg</a></code>, 
<code><a href="#topic+byIndv4Intvl_GRsDiff">byIndv4Intvl_GRsDiff</a></code>, <code><a href="#topic+byIndv4Intvl_WaterUse">byIndv4Intvl_WaterUse</a></code>, <br />
<code><a href="#topic+byIndv_ValueCalc">byIndv_ValueCalc</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'> #Load dat
 data(tomato.dat)

 #Define DAP constants 
 DAP.endpts   &lt;- c(18,22,27,33,39,43,51)
 nDAP.endpts &lt;- length(DAP.endpts)
 DAP.starts &lt;- DAP.endpts[-nDAP.endpts]
 DAP.stops   &lt;- DAP.endpts[-1]
 DAP.segs &lt;- list(c(DAP.endpts[1]-1, 39), 
                   c(40, DAP.endpts[nDAP.endpts]))
 #Add PSA rates and smooth PSA, also producing sPSA rates
 tom.dat &lt;- byIndv4Times_SplinesGRs(data = tomato.dat, 
                                    response = "PSA", response.smoothed = "sPSA", 
                                    times = "DAP", rates.method = "differences", 
                                    smoothing.method = "log", 
                                    spline.type = "PS", lambda = 1, 
                                    smoothing.segments = DAP.segs)
  
 #Smooth WU
 tom.dat &lt;- byIndv4Times_SplinesGRs(data = tom.dat, 
                                    response = "WU", response.smoothed = "sWU",
                                    rates.method = "none", 
                                    times = "DAP", 
                                    smoothing.method = "direct", 
                                    spline.type = "PS", lambda = 10^(-0.5), 
                                    smoothing.segments = DAP.segs)
 
 #Extract single-valued traits for each individual
 indv.cols &lt;- c("Snapshot.ID.Tag", "Lane", "Position", "Block", "Cart", "AMF", "Zn")
 indv.dat &lt;- subset(tom.dat, subset = DAP == DAP.endpts[1], 
                    select = indv.cols)
 indv.dat &lt;- traitExtractFeatures(data = tom.dat, 
                                  starts.intvl = DAP.starts, stops.intvl = DAP.stops, 
                                  responses4singletimes = "sPSA", 
                                  responses4intvl.rates = "sPSA", 
                                  growth.rates = c("AGR", "RGR"), 
                                  water.use4intvl.traits = "sWU", 
                                  responses4water = "sPSA", 
                                  responses4overall.totals = "sWU",
                                  responses4overall.max = "sPSA.AGR",
                                  mergedata = indv.dat)
</code></pre>

<hr>
<h2 id='traitSmooth'>Obtain smooths for a trait by fitting spline functions and, having compared 
several smooths, allows one of them to be chosen and returned in a <code>data.frame</code>.</h2><span id='topic+traitSmooth'></span>

<h3>Description</h3>

<p>Takes a <code>response</code> that has been observed for a set of 
<code>individuals</code> over a number <code>times</code> and carries out one or more of the following steps:
</p>

<dl>
<dt>Smooth:</dt><dd><p>Produces <code>response.smoothed</code> using splines for a set of 
smoothing parameter settings and, optionally, computes growth 
rates either as differences or derivatives. 
(see <code>smoothing.args</code> below and <code><a href="#topic+args4smoothing">args4smoothing</a></code>) 
This step is bypassed if a <code><a href="base.html#topic+data.frame">data.frame</a></code> that is also of 
class <code><a href="#topic+smooths.frame">smooths.frame</a></code> is supplied to <code>data</code>.</p>
</dd>
<dt>Profile plots:</dt><dd><p>Produces profile plots of <code>response.smoothed</code> and its 
growth rates that compare the smooths; also, boxplots of the 
deviations of the observed from smoothed data can be obtained. 
(see <code>profile.plot.args</code> below and <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>) 
Whether these plots are produced is controlled via <code>which.plots</code> or 
whether <code>profile.plot.args</code> is set to <code>NULL</code>.</p>
</dd> 
<dt>Median deviations plots:</dt><dd><p>Produces plots of the medians of the deviations of 
the observed <code>response</code>, and its growth rates, from <code>response.smoothed</code>,  
and its growth rates. These aid in the assessment of the different smooths. 
(see <code>meddevn.plot.args</code> below and <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>)
Whether these plots are produced is controlled via <code>which.plots</code> or 
whether <code>meddevn.plot.args</code> is set to <code>NULL</code>.</p>
</dd> 
<dt>Deviations boxplots:</dt><dd><p>Produces boxplots of the absolute or relative deviations 
of the observed <code>response</code>, and its growth rates, from <code>response.smoothed</code>,  
and its growth rates. These aid in the assessment of the different smooths. 
(see <code>devnboxes.plot.args</code> below and <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>)
Whether these plots are produced is controlled via <code>which.plots</code> or 
whether <code>devnboxes.plot.args</code> is set to <code>NULL</code>.</p>
</dd>
<dt>Choose a smooth:</dt><dd><p>Extract a single, favoured <code>response.smoothed</code>, 
and its growth rates, for a chosen set of smoothing parameter settings. 
(see <code>chosen.smooth.args</code> below and <code><a href="#topic+args4chosen_smooth">args4chosen_smooth</a></code>) 
This step will be omitted if <code>chosen.smooth.args</code> is <code>NULL</code>.</p>
</dd> 
<dt>Chosen smooth plot:</dt><dd><p>Produces profile plots of the chosen smooth and its growth rates. 
(see <code>chosen.plot.args</code> below and <code><a href="#topic+args4chosen_plot">args4chosen_plot</a></code>) 
Whether these plots are produced is controlled by whether 
<code>chosen.plot.args</code> is set to <code>NULL</code>.</p>
</dd>
</dl>

<p>Each of the '<code>args4</code>' functions has a set of defaults that will be used if 
the corresponding argument, ending in '<code>.args</code>', is omitted. The defaults 
have been optimized for <code>traitSmooth</code>. 
</p>
<p>Input to the function can be either a <code><a href="base.html#topic+data.frame">data.frame</a></code>, that contains data to 
be smoothed, or a <code><a href="#topic+smooths.frame">smooths.frame</a></code>, that contains data that has been smoothed. 
The function can be run (i) without saving any output, (ii) saving the complete set 
of smooths in a <code><a href="base.html#topic+data.frame">data.frame</a></code> that is also of class <code><a href="#topic+smooths.frame">smooths.frame</a></code>, 
(iii) saving a subset of the smooths in a supplied <code><a href="#topic+smooths.frame">smooths.frame</a></code>, or 
(iv) saving a single smooth in a <code><a href="base.html#topic+data.frame">data.frame</a></code>, which can be merged 
with a pre-existing <code><a href="base.html#topic+data.frame">data.frame</a></code> such as the <code><a href="base.html#topic+data.frame">data.frame</a></code> 
that contains the unsmoothed data.  
</p>
<p>The <code>Tomato</code> vignette illustrates the use of <code>traitSmooth</code> and 
<code><a href="#topic+traitExtractFeatures">traitExtractFeatures</a></code> to carry out the SET procedure for the example 
presented in Brien et al. (2020). 
Use <code>vignette("Tomato", package = "growthPheno")</code> to access it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traitSmooth(data, response, response.smoothed, individuals, times, 
            keep.columns = NULL, 
            get.rates = TRUE, 
            rates.method="differences", ntimes2span = NULL, 
            trait.types = c("response", "AGR", "RGR"), 
            smoothing.args = args4smoothing(), 
            x.title = NULL, y.titles = NULL, 
            which.plots = c("profiles", "medians.deviations"), 
            profile.plot.args = args4profile_plot(), 
            meddevn.plot.args = args4meddevn_plot(), 
            devnboxes.plot.args = args4devnboxes_plot(),
            chosen.smooth.args = args4chosen_smooth(), 
            chosen.plot.args = args4chosen_plot(), 
            mergedata = NULL, 
            ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traitSmooth_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the data or a <code><a href="#topic+smooths.frame">smooths.frame</a></code> 
as is produced by <code>probeSmooths</code>. if <code>data</code> is not a 
<code><a href="#topic+smooths.frame">smooths.frame</a></code>, then smoothing will be performed. If <code>data</code> 
is a <code><a href="#topic+smooths.frame">smooths.frame</a></code>, then the plotting and selection of smooths 
will be performed as specified by <code>smoothing.args</code> , <code>which.plots</code>, 
<code>chosen.smooth.args</code> and <code>chosen.plot.args</code>.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the response variable to be 
smoothed.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_response.smoothed">response.smoothed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the name of the column 
to contain the values of the smoothed response variable, corresponding 
to <code>response</code>.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_individuals">individuals</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the 
<code><a href="base.html#topic+factor">factor</a></code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_times">times</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the name of the <code><a href="base.html#topic+numeric">numeric</a></code>, 
or <code><a href="base.html#topic+factor">factor</a></code> with numeric levels, that contains the values 
of the predictor variable to be supplied to <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> 
and to be plotted on the x-axis.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_keep.columns">keep.columns</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector giving the names of columns 
from <code>data</code> that are to be included in the 
<code><a href="#topic+smooths.frame">smooths.frame</a></code> that will be returned.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_get.rates">get.rates</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> or a <code><a href="base.html#topic+character">character</a></code> specifying 
which of the <code>response</code> and the <code>response.smoothed</code> are to 
have growth rates (AGR and/or RGR) computed and stored. If set to 
<code>TRUE</code> or <code>c("raw", "smoothed")</code>, growth rates will be 
obtained for both. Setting to only one of <code>raw</code> or 
<code>smoothed</code>, results in the growth rates for either the 
<code>response</code> or the <code>response.smoothed</code> being computed. 
If set to <code>none</code> or <code>FALSE</code>, no growth rates ar computed. 
Which growth.rates are computed can be changed using the arguments 
<code>traits.types</code> and the method used for computing them for the 
<code>response.smooth</code> by <code>rates.method</code>. The growth rates for 
the <code>response</code> can only be computed by <code>differencing</code>.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_rates.method">rates.method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> specifying the method to use in 
calculating the growth rates for <code>response.smoothed</code>. The two 
possibilities are <code>"differences"</code> and <code>"derivatives"</code>.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_ntimes2span">ntimes2span</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the number of values in 
<code>times</code> to span in calculating growth rates by differencing. 
For <code>ntimes2span</code> set to <code>NULL</code>, if <code>rates.method</code> 
is set to <code>differences</code> then <code>ntimes2span</code> is set to 2; 
if <code>rates.method</code> is set to <code>derivatives</code> then 
<code>ntimes2span</code> is set to 3. 
Note that when <code>get.rates</code> is includes <code>raw</code> or is 
<code>TRUE</code>, the growth rates for the unsmoothed response must be 
calculated by differencing, even if the growth rates for the 
smoothed response are computed using <code>derivatives</code>. When 
differencing, each growth rate is calculated as the difference in 
the values of one of the <code>responses</code> for pairs of <code>times</code> 
values that are spanned by <code>ntimes2span</code> <code>times</code> values 
divided by the difference between this pair of <code>times</code> values. 
For <code>ntimes2span</code> set to 2, a growth rate is the  
difference between consecutive pairs of values of one of the 
<code>responses</code> divided by the difference between consecutive 
pairs of <code>times</code> values.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_trait.types">trait.types</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the <code>trait.types</code> that 
are to be plotted. If growth rates are included in <code>trait.types</code>, 
then they will be computed for either the <code>response</code> and/or the 
<code>response.smoothed</code>, depending on the setting of <code>get.rates</code>. 
Any growth rates included in <code>trait.types</code> for the <code>response</code> 
that are available in <code>data</code>, but have not been specified for 
computation in <code>get.rates</code>, will be retained in the returned 
<code>smooths.frame</code>.
If <code>all</code>, the <code>response.smoothed</code>, its <code>AGR</code> and 
<code>RGR</code>, will be plotted. The <code>response</code>, and its <code>AGR</code> 
and <code>RGR</code>, will be plotted as the plotting options require it.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_smoothing.args">smoothing.args</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> that is most easily generated 
using <code><a href="#topic+args4smoothing">args4smoothing</a></code>, it documenting the 
options available for smoothing the data. It gives the settings of 
<code>smoothing.methods</code>, <code>spline.types</code>, <code>df</code>, <code>lambdas</code>, 
<code>smoothing.segments</code>, <code>npspline.segments</code>, <code>na.x.action</code>, 
<code>na.y.action</code>, <code>external.smooths</code>, and <code>correctBoundaries</code>, 
to be used in smoothing the <code>response</code> or in selecting a subset 
of the smooths in <code>data</code>, depending on whether <code>data</code> is a 
<code><a href="base.html#topic+data.frame">data.frame</a></code> or a <code><a href="#topic+smooths.frame">smooths.frame</a></code>, respectively. 
If <code>data</code> is a <code><a href="base.html#topic+data.frame">data.frame</a></code>, then smoothing will be 
performed. If <code>data</code> is a <code><a href="#topic+smooths.frame">smooths.frame</a></code>, no 
smoothing will be carried out. If <code>smoothing.args</code> is <code>NULL</code> 
then a <code><a href="#topic+smooths.frame">smooths.frame</a></code> will only be used for plotting. 
Otherwise, the setting of <code>smoothing.args</code> will specifying the 
smooths that are to be extracted from the <code><a href="#topic+smooths.frame">smooths.frame</a></code>, 
in which case <code>smoothing.args</code> must specify a subset of the smooths 
in <code>data</code>.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_x.title">x.title</code></td>
<td>
<p>Title for the x-axis, used for all plots. If <code>NULL</code> then set 
to <code>times</code>.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_y.titles">y.titles</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the titles for the y-axis, one 
for each the response, the AGE and the RGR. They are used for all plots. 
If <code>NULL</code> then they are set to the <code>response</code> and the  
<code>response</code> with <code>.AGR</code> and <code>.RGR</code> appended.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_which.plots">which.plots</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> indicating which plots of the smooths 
specified by <code>smoothing.args</code> are to be produced. 
The options are either <code>none</code> or some combination of <code>profiles</code>, 
<code>absolute.boxplots</code>, <code>relative.boxplots</code> and 
<code>medians.deviations</code>. The various <code>profiles</code> plots that can be 
poduced are described in the introduction to this function. 
The plot of a chosen smooth is dealt with separately by the argument 
<code>chosen.plot.args</code>.</p>
</td></tr> 
<tr><td><code id="traitSmooth_+3A_profile.plot.args">profile.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, it documenting the 
options available for varying the profile plots. <em>Note 
that if <code><a href="#topic+args4profile_plot">args4profile_plot</a></code> is being called from 
<code>traitSmooth</code> to change some arguments from the default 
settings, then it is safest to set all of the following arguments 
in the call: <code>plots.by</code>, <code>facet.x</code> <code>facet.y</code> and 
<code>include.raw</code>.</em> If this argument is set to <code>NULL</code>, these 
plots will not be produced.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_meddevn.plot.args">meddevn.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, it documenting the 
options available for varying median deviations plots. <em>Note 
that if <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code> is being called from 
<code>traitSmooth</code> to change some arguments from the default 
settings, then it is safest to set all of the following arguments 
in the call: <code>plots.by</code>, <code>plots.group</code>, <code>facet.x</code> 
and <code>facet.y</code>.</em> If this argument is set to <code>NULL</code>, these 
plots will not be produced.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_devnboxes.plot.args">devnboxes.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code>, it documenting the 
options available for varying the boxplots. <em>Note 
that if <code><a href="#topic+args4devnboxes_plot">args4devnboxes_plot</a></code> is being called from 
<code>traitSmooth</code> to change some arguments from the default 
settings, then it is safest to set all of the following arguments in 
the call: <code>plots.by</code>, <code>facet.x</code> and <code>facet.y</code>.</em> If this 
argument is set to <code>NULL</code>, these plots will not be produced.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_chosen.smooth.args">chosen.smooth.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> with just one element or 
<code>NULL</code> for each component. It is most easily generated using 
<code><a href="#topic+args4chosen_smooth">args4chosen_smooth</a></code> with <code>combinations</code> set to 
<code>single</code>. The call to <code><a href="#topic+args4smoothing">args4smoothing</a></code> should give 
the settings of <code>smoothing.methods</code>, <code>spline.types</code>, 
<code>df</code> and <code>lambdas</code> for a single smooth that is to be 
extracted and that is amongst the smooths that have been produced 
for the settings specified in <code>smoothing.methods</code>. If both 
<code>df</code> and <code>lambda</code> in <code>chosen.smooth.args</code> are 
<code>NULL</code>, then, depending on the settings for <code>spline.type</code> 
and <code>smoothng.method</code>, the value of either <code>df</code> or 
<code>lambdas</code> that is the median value or the observed value 
immediatly below the median value will be added to 
<code>chosen.smooth.args</code>. Otherwise, one of <code>df</code> and 
<code>lambda</code> should be <code>NULL</code> and the other should be a 
single <code>numeric</code> value. If a value in 
<code>chosen.smooth.args</code> is not amongst those investigated, a 
value that was investigated will be substituted.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_chosen.plot.args">chosen.plot.args</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> that is most easily 
generated using <code><a href="#topic+args4chosen_plot">args4chosen_plot</a></code>, it documenting the 
options available for varying profile plots. Because this plot 
includes only a single smooth, the <code>chosen.smooth.args</code>, the 
smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s are unnecessary and an 
error will be given if any are included. <em>Note that if 
<code><a href="#topic+args4chosen_plot">args4chosen_plot</a></code> is to be called to change from the 
default settings given in the default <code>traitSmooth</code> call, 
then it is safest to set all of the following arguments in the call: 
<code>plots.by</code>, <code>facet.x</code>, <code>facet.y</code> and 
<code>include.raw</code>.</em> If set to <code>NULL</code>, then no chosen-smooth plot 
will be produced.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_mergedata">mergedata</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> that is to have the values for the 
<code>trait.types</code> for the smooth specified by <code>chosen.smooth.args</code> 
<code><a href="base.html#topic+merge">merge</a></code>d with it. It must contain columns with the names given 
in <code>individuals</code> and <code>times</code>, and for which there is only one 
row for each combination of unique values in these columns. In general, 
it will be that the number of rows in <code>mergedata</code> is equal to the 
number of unique combinations of the values in the columns of the 
<code>chosen.smooth.args</code> whose names are given by <code>individuals</code> and 
<code>times</code>, but this is not mandatory. If only one smooth has been 
produced, then it will be merged with <code>data</code> provided <code>mergedata</code> is 
<code>NULL</code> and <code>data</code> is not  a <code><a href="#topic+smooths.frame">smooths.frame</a></code>. Othewrwise, 
a single smooth will be be merged with <code>mergedata</code>.</p>
</td></tr>
<tr><td><code id="traitSmooth_+3A_...">...</code></td>
<td>
<p>allows arguments to be passed to <code><a href="#topic+plotProfiles">plotProfiles</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper function for <code><a href="#topic+probeSmooths">probeSmooths</a></code>, 
<code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code>, <code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code> 
and <code><a href="#topic+plotDeviationsBoxes">plotDeviationsBoxes</a></code>. It uses the helper functions 
<code><a href="#topic+args4smoothing">args4smoothing</a></code>, <code><a href="#topic+args4profile_plot">args4profile_plot</a></code> and 
<code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code> to se arguments that control the smoothing 
and plotting.
</p>
<p>It takes a <code>response</code> that has been observed for a set of 
<code>individuals</code> over a number <code>times</code> and produces 
<code>response.smoothed</code>, using <code><a href="#topic+probeSmooths">probeSmooths</a></code>, for a default 
set of smoothing parameter settings (see <code><a href="#topic+args4smoothing">args4smoothing</a></code> 
for the defaults). The settings can be varied from the defaults by 
specifying alternate values for the smoothing parameters, the parameters 
being the type of spline (<code>spline.types</code>), the degrees of freedom 
(<code>df</code>) or smoothing penalty (<code>lambdas</code>) and <code>smoothing.methods</code>. 
There are also several other smoothing arguments that can be manipulated to 
affect the smooth (for details see <code><a href="#topic+args4smoothing">args4smoothing</a></code>). 
The secondary traits of the absolute growth rate (<code>AGR</code>) and relative 
growth rate (<code>RGR</code>) are calculated from the two primary traits, the 
<code>response</code> and <code>response.smoothed</code>.
</p>
<p>Generally, profile plots for the traits (a response, an AGR or an RGR) 
specified in <code>traits.types</code> are produced if <code>which.plots</code> is 
<code>profiles</code>; if <code>which.plots</code> specifies one or more deviations 
plots, then those deviations plots will also be produced, these being 
based on the unsmoothed data from which the smoothed data has been 
subtracted. The layout of the plots is controlled via combinations of 
one or more of the smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s <code>Type</code>, 
<code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code> (the combination 
of <code>TunePar</code> and <code>TuneVal</code>) and <code>Method</code>, as well as 
other <code><a href="base.html#topic+factor">factor</a></code>s associated with the <code>data</code>. 
The <code><a href="base.html#topic+factor">factor</a></code>s that are to be used for the profile plots and 
deviations boxplots are supplied via the argument <code>profile.plot.args</code> 
using the helper function <code><a href="#topic+args4profile_plot">args4profile_plot</a></code> to set 
<code>plots.by</code>, <code>facet.x</code>, and <code>facet.y</code>; for the plots of 
the medians of the deviations, the <code><a href="base.html#topic+factor">factor</a></code>s are supplied via 
the argument <code>meddevn.plot.args</code> using the helper function 
<code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code> to set <code>plots.by</code>, <code>facet.x</code>, 
<code>facet.y</code> and <code>plots.group</code>. Here, the basic principle is that 
the number of levels combinations of the smoothing-parameter 
<code><a href="base.html#topic+factor">factor</a></code>s included in the set of <code>plots</code> and 
<code>facets</code> arguments to one of these helper functions must be the same 
as those covered by the combinations of the values supplied to 
<code>spline.types</code>, <code>df</code>, <code>lambdas</code> and <code>smoothing.methods</code> 
and incorporated into the <code><a href="#topic+smooths.frame">smooths.frame</a></code>, such as is 
returned by <code>probeSmooths</code>. This ensures that smooths 
from different parameter sets are not pooled together in a single plot. 
It is also possible to include <code><a href="base.html#topic+factor">factor</a></code>s that are not 
smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s in the <code>plots</code> amd 
<code>facets</code> arguments. 
</p>
<p>The following profiles plots can be produced using 
<code><a href="#topic+args4profile_plot">args4profile_plot</a></code>: (i) separate plots of the 
smoothed traits for each combination of the smoothing parameters 
(include <code>Type</code>, <code>Tuning</code> and <code>Method</code> in <code>plots.by</code>); 
(ii) as for (i), with the corresponding plot for the unsmoothed trait 
preceeding the plots for the smoothed trait (also set <code>include.raw</code> to 
<code>alone</code>); (iii) profiles plots that compare a smoothed trait for all 
combinations of the values of the smoothing parameters, arranging the plots 
side-by-side or one above the other (include <code>Type</code>, <code>Tuning</code> and 
<code>Method</code> in <code>facet.x</code> and/or <code>facet.y</code> - to include the 
unsmoothed trait set <code>include.raw</code> to one of <code>facet.x</code> or 
<code>facet.y</code>; (iv) as for (iii), except that separate plots are 
produced for each combination of the levels of the <code><a href="base.html#topic+factor">factor</a></code>s 
in <code>plot.by</code> and each plot compares the smoothed traits for the 
smoothing-parameter <code><a href="base.html#topic+factor">factor</a></code>s included in <code>facet.x</code> 
and/or <code>facet.y</code> (set both <code>plots.by</code> and one or more of 
<code>facet.x</code> and <code>facet.y</code>). 
</p>
<p>Deviation plots that can be produced are the absolute and relative deviations 
boxplots and plots of medians deviations (see <code>which.plots</code>). 
</p>
<p>By default, the single smooth for an arbitrarily chosen combination of the 
smoothing parameters is returned by the function. The smooth for a single 
combination other than default combination can be nominated for return 
using the <code>chosen.smooth.args</code> argument. This combination must involve 
only the supplied values of the smoothing parameters. The values for 
<code>response</code>, the <code>response.smoothed</code> and their <code>AGR</code>s 
and <code>RGR</code>s are are added to <code>data</code>, after any pre-existing  
columns of these have been removed from <code>data</code>. Profile plots of 
the three smoothed traits are produced using <code><a href="#topic+plotProfiles">plotProfiles</a></code>. 
However, if <code>chosen.smooth.args</code> is <code>NULL</code>, all of the smooths will be 
returned in a <code><a href="#topic+smooths.frame">smooths.frame</a></code>, and plots for the single 
combination of the smoothing parameters will not be produced. 
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+smooths.frame">smooths.frame</a></code> or a <code><a href="base.html#topic+data.frame">data.frame</a></code> that contains 
the unsmoothed and smoothed data in long format. That is, all the values for 
either an unsmoothed or a smoothed trait are in a single column. 
</p>
<p>A <code><a href="#topic+smooths.frame">smooths.frame</a></code> will be returned when (i) <code>chosen.smooth.args</code> 
is <code>NULL</code> and there is more than one smooth specified by the smoothing 
parameter arguments, or (ii) <code>chosen.smooth.args</code> is not <code>NULL</code> but 
<code>mergedata</code> is <code>NULL</code>. It will contain the smooths for a trait for the 
different combinatons of the smoothing parameters, the values for the different 
smooths being placed in rows one below the other. The columns that are included 
in the <code><a href="#topic+smooths.frame">smooths.frame</a></code> are <code>Type</code>, <code>TunePar</code>, 
<code>TuneVal</code>, <code>Tuning</code> and <code>Method</code>, as well as those specified by 
<code>individuals</code>, <code>times</code>, <code>response</code>, and <code>response.smoothed</code>, 
and any included in the <code>keep.columns</code>, <code>plots</code> and <code>facet</code> 
arguments when the smooths were produced. The <code>AGR</code> or <code>RGR</code> for the 
<code>response</code> and <code>response.smoothed</code>, if obtained, will also be 
included. A <code><a href="#topic+smooths.frame">smooths.frame</a></code> has the attributes described in 
<code><a href="#topic+smooths.frame">smooths.frame</a></code>. 
</p>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> will be returned when (i) <code>chosen.smooth.args</code> 
and <code>mergedata</code> are not <code>NULL</code> or (ii) <code>chosen.smooth.args</code> is 
<code>NULL</code>, <code>data</code> is not a <code>smooths.frame</code> and there is only one 
smooth specified by the smoothing parameter arguments. In either case, if 
<code>mergedata</code> is not <code>NULL</code>, the chosen smooth or the single smooth 
will be merged with the <code><a href="base.html#topic+data.frame">data.frame</a></code> specified by <code>mergedata</code>. 
When there is a single smooth and both <code>mergedata</code> and 
<code>chosen.smooth.args</code> are <code>NULL</code>, the <code><a href="base.html#topic+data.frame">data.frame</a></code> will 
include the columns <code>individuals</code>, <code>times</code>, <code>response</code>, and 
<code>response.smoothed</code>, and any included in the <code>keep.columns</code>, 
<code>plots</code> and <code>facet</code> arguments, as well as any growth rates calculated 
as a result of <code>get.rates</code> and <code>trait.type</code>.
</p>
<p>The <code><a href="#topic+smooths.frame">smooths.frame</a></code>/<code><a href="base.html#topic+data.frame">data.frame</a></code> is returned invisibly.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Brien, C., Jewell, N., Garnett, T., Watts-Williams, S. J., &amp; Berger, B. (2020). Smoothing and extraction of traits in the growth analysis of noninvasive phenotypic data. <em>Plant Methods</em>, <b>16</b>, 36. <a href="https://doi.org/10.1186/s13007-020-00577-6">doi:10.1186/s13007-020-00577-6</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+args4smoothing">args4smoothing</a></code>, <code><a href="#topic+args4meddevn_plot">args4meddevn_plot</a></code>, <code><a href="#topic+args4profile_plot">args4profile_plot</a></code>, 
<code><a href="#topic+args4chosen_smooth">args4chosen_smooth</a></code>, <br /> 
<code><a href="#topic+args4chosen_plot">args4chosen_plot</a></code>, <code><a href="#topic+probeSmooths">probeSmooths</a></code> 
<code><a href="#topic+plotSmoothsComparison">plotSmoothsComparison</a></code> and <br /> 
<code><a href="#topic+plotSmoothsMedianDevns">plotSmoothsMedianDevns</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
longi.dat &lt;- longi.dat[1:140,] #reduce to a smaller data set
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", linewidth=1))
yfacets &lt;- c("Smarthouse", "Treatment.1")
smth.dat &lt;- traitSmooth(data = longi.dat, 
                        response = "PSA", response.smoothed = "sPSA",
                        individuals = "Snapshot.ID.Tag",times = "DAP", 
                        keep.columns = yfacets, 
                        smoothing.args = 
                          args4smoothing(df = c(5,7), 
                                         lambda = list(PS = c(0.316,10))),
                        profile.plot.args = 
                          args4profile_plot(facet.y = yfacets, 
                                            ggplotFuncs = vline),
                        chosen.plot.args = 
                          args4chosen_plot(facet.y = yfacets,  
                                           ggplotFuncs = vline))
</code></pre>

<hr>
<h2 id='twoLevelOpcreate'>Creates a data.frame formed by applying, for each response, a binary operation 
to the paired values of two different treatments </h2><span id='topic+twoLevelOpcreate'></span>

<h3>Description</h3>

<p>Takes pairs of values for a set of responses indexed by a two-level 
<code>treatment.factor</code> and calculates, for each of pair, 
the result of applying a binary <code>operation</code> to their values 
for the two levels of the <code>treatment.factor</code>. The level of the 
<code>treatment.factor</code> designated the <code>control</code> will be 
on the right of the binary operator and the value for the other 
level will be on the left.</p>


<h3>Usage</h3>

<pre><code class='language-R'>twoLevelOpcreate(data, responses, treatment.factor = "Treatment.1", 
                 suffices.treatment = c("Cont","Salt"), control = 1, 
                 columns.suffixed = NULL, 
                 operations = "/", suffices.results="OST", 
                 columns.retained = c("Snapshot.ID.Tag","Smarthouse","Lane", 
                                      "Zone","cZone","SHZone","ZLane",
                                      "ZMainunit","cMainPosn", "Genotype.ID"),
                 by = c("Smarthouse","Zone","ZMainunit"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twoLevelOpcreate_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the columns specified by 
<code>treatment.factor</code>, <code>columns.retained</code> and 
<code>responses</code>.</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_responses">responses</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns 
in <code>data</code> that contain the responses to which the binary 
operations are to be applied.</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_treatment.factor">treatment.factor</code></td>
<td>
<p>A <code><a href="base.html#topic+factor">factor</a></code> with two levels corresponding to 
what is to be designated the <code>control</code> and treated 
observations .</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_suffices.treatment">suffices.treatment</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the <code>responses</code> and 
<code>columns.suffixed</code>  in constructing the 
names of the columns containing the <code>responses</code> and 
<code>columns.suffixed</code> for each 
level of the <code>treatment.factor</code>. The order of the 
suffices in <code>suffices.treatment</code> should correspond to 
the order of the levels of <code>treatment.factor</code>.</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_control">control</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code>, equal to either 1 or 2, that specifies 
the level of <code>treatment.factor</code> that is the control 
treatment. The value for the <code>control</code> level will be on 
the right of the binary operator.</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_columns.suffixed">columns.suffixed</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the 
<code>columns.retained</code> in <code>data</code> that are to be have the 
values for each treatment retained and whose names are to be 
suffixed using <code>suffices.treatment</code>. Generally, this is done 
when <code>columns.retained</code> has different values for different 
levels of the <code>treatment.factor</code>.</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_operations">operations</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the binary operations to 
perform on the values for the two different levels of the 
<code>treatment.factor</code>. It should be either of length one, 
in which case the same operation will be performed for all columns 
specified in <code>response.GR</code>, or equal in length to 
<code>response.GR</code> so its elements correspond to those of 
<code>response.GR</code>.</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_suffices.results">suffices.results</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the characters to be 
appended to the names of the responses in constructing the 
names of the columns containing the results of applying 
the operations. The order of the 
suffices in <code>suffices.results</code> should correspond to 
the order of the operators in <code>operations</code>.</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_columns.retained">columns.retained</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the 
columns in <code>data</code> that are to be retained in the 
<code>data.frame</code> being created. These are usually 
<code><a href="base.html#topic+factor">factor</a>s</code> that index the results of applying the 
operations and that might be used subsequently.</p>
</td></tr>
<tr><td><code id="twoLevelOpcreate_+3A_by">by</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> giving the names of the columns in 
<code>data</code> whose combinations will be unique for the observation 
for each treatment. It is used by <code><a href="base.html#topic+merge">merge</a></code> when combining 
the values of the two treatments in separate 
columns in the <code>data.frame</code> to be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the following columns and the values of the :
</p>

<ol>
<li><p> those from <code>data</code> nominated in <code>columns.retained</code>;
</p>
</li>
<li><p> those containing the treated values of the columns whose names 
are specified in <code>responses</code>; the treated values are 
those having the other level of <code>treatment.factor</code> to 
that specified by <code>control</code>;
</p>
</li>
<li><p> those containing the <code>control</code> values of the columns whose 
names are specified in <code>responses</code>; the control values are 
those having the level of <code>treatment.factor</code> specified 
by <code>control</code>;
</p>
</li>
<li><p> those containing the values calculated using the binary 
<code>operations</code>; the names of these columns will be 
constructed from <code>responses</code> by appending 
<code>suffices.results</code> to them.
</p>
</li></ol>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
responses &lt;- c("sPSA.AGR","sPSA.RGR")
cols.retained &lt;-  c("Snapshot.ID.Tag","Smarthouse","Lane","Position",
                    "DAP","Snapshot.Time.Stamp", "Hour", "xDAP",
                    "Zone","cZone","SHZone","ZLane","ZMainunit",
                    "cMainPosn", "Genotype.ID")
longi.SIIT.dat &lt;- 
  twoLevelOpcreate(data = longi.dat, responses = responses, 
                   suffices.treatment=c("C","S"),
                   operations = c("-", "/"), 
                   suffices.results = c("diff", "SIIT"), 
                   columns.retained = cols.retained, 
                   by = c("Smarthouse","Zone","ZMainunit","DAP"))
longi.SIIT.dat &lt;- with(longi.SIIT.dat, 
                            longi.SIIT.dat[order(Smarthouse,Zone,ZMainunit,DAP),])
</code></pre>

<hr>
<h2 id='validSmoothsFrame'>Checks that an object is a valid <code><a href="#topic+smooths.frame">smooths.frame</a></code>.</h2><span id='topic+validSmoothsFrame'></span>

<h3>Description</h3>

<p>Checks that an <code>object</code> is a <code><a href="#topic+smooths.frame">smooths.frame</a></code> 
of S3-class <code>data.frame</code> that contains the columns 
<code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code>, 
<code>Method</code>, as well as the columns specified by the 
atttributes of the <code>object</code>, namely <code>individuals</code> 
and <code>times</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>validSmoothsFrame(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validSmoothsFrame_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+smooths.frame">smooths.frame</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> or a <code>character</code> describing why the <code>object</code> 
is not a valid <code><a href="#topic+smooths.frame">smooths.frame</a></code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code><a href="#topic+is.smooths.frame">is.smooths.frame</a></code>, <code><a href="#topic+as.smooths.frame">as.smooths.frame</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- read.table(header = TRUE, text = "
Type TunePar TuneVal Tuning Method       ID  DAP   PSA      sPSA
NCSS      df       4   df-4 direct 045451-C   28 57.446 51.18456
NCSS      df       4   df-4 direct 045451-C   30 89.306 87.67343
NCSS      df       7   df-7 direct 045451-C   28 57.446 57.01589
NCSS      df       7   df-7 direct 045451-C   30 89.306 87.01316
")
dat[1:7] &lt;- lapply(dat[1:6], factor)
dat &lt;- as.smooths.frame(dat, individuals = "ID", times = "DAP")
is.smooths.frame(dat)
validSmoothsFrame(dat)
</code></pre>

<hr>
<h2 id='WUI'>Calculates the Water Use Index (WUI)</h2><span id='topic+WUI'></span>

<h3>Description</h3>

<p>Calculates the Water Use Index, returning <code>NA</code> if the water use is zero.</p>


<h3>Usage</h3>

<pre><code class='language-R'>WUI(response, water)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WUI_+3A_response">response</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the value of the response achieved.</p>
</td></tr>
<tr><td><code id="WUI_+3A_water">water</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> giving the amount of water used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> containing the response divided by the water, unless water is 
zero in which case <code>NA</code> is returned.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleData)
PSA.WUE &lt;- with(longi.dat, WUI(PSA.AGR, WU))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
