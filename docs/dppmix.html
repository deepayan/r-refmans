<!DOCTYPE html><html><head><title>Help for package dppmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dppmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dgammapois'><p>Density function for Gamma-Poisson distribution.</p></a></li>
<li><a href='#dppmix_mvnorm'><p>Fit a determinantal point process multivariate normal mixture model.</p></a></li>
<li><a href='#estimate'><p>Estimate parameter.</p></a></li>
<li><a href='#rbern'><p>Random generator for the Bernoulli distribution.</p></a></li>
<li><a href='#rbvec'><p>Generate a random binary vector.</p></a></li>
<li><a href='#rdirichlet'><p>Random generator for the Dirichlet distribution.</p></a></li>
<li><a href='#rmvnorm_clusters'><p>Generate random multivarate clusters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Determinantal Point Process Mixture Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Yanxun Xu [aut], Peter Mueller [aut], Donatello Telesca [aut], David J. H. Shih [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David J. H. Shih &lt;djh.shih@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Multivariate Gaussian mixture model with a determinant point 
  process prior to promote the discovery of parsimonious components from 
  observed data. See Xu, Mueller, Telesca (2016) &lt;<a href="https://doi.org/10.1111%2Fbiom.12482">doi:10.1111/biom.12482</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://bitbucket.org/djhshih/dppmix">https://bitbucket.org/djhshih/dppmix</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://bitbucket.org/djhshih/dppmix/issues">https://bitbucket.org/djhshih/dppmix/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, mvtnorm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-01-10 16:51:51 UTC; davids</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-14 10:00:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='dgammapois'>Density function for Gamma-Poisson distribution.</h2><span id='topic+dgammapois'></span>

<h3>Description</h3>

<p>Data follow the Poisson distribution parameterized by a mean parameter
that follows a gamma distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgammapois(x, a, b = 1, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgammapois_+3A_x">x</code></td>
<td>
<p>vector of x values</p>
</td></tr>
<tr><td><code id="dgammapois_+3A_a">a</code></td>
<td>
<p>shape parameter for gamma distribution on mean parameter</p>
</td></tr>
<tr><td><code id="dgammapois_+3A_b">b</code></td>
<td>
<p>rate parameter for gamma distribution on mean parameter</p>
</td></tr>
<tr><td><code id="dgammapois_+3A_log">log</code></td>
<td>
<p>whether to return the density in log scale</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density values
</p>

<hr>
<h2 id='dppmix_mvnorm'>Fit a determinantal point process multivariate normal mixture model.</h2><span id='topic+dppmix_mvnorm'></span>

<h3>Description</h3>

<p>Discover clusters in multidimensional data using a multivariate normal 
mixture model with a determinantal point process prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dppmix_mvnorm(
  X,
  hparams = NULL,
  store = NULL,
  control = NULL,
  fixed = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dppmix_mvnorm_+3A_x">X</code></td>
<td>
<p><code>N x J</code> data matrix of <code>N</code> observations and
<code>J</code> features</p>
</td></tr>
<tr><td><code id="dppmix_mvnorm_+3A_hparams">hparams</code></td>
<td>
<p>a list of hyperparameter values:
<code>delta, a0, b0, theta, sigma_prop_mu</code></p>
</td></tr>
<tr><td><code id="dppmix_mvnorm_+3A_store">store</code></td>
<td>
<p>a vector of character strings specifying additional vars of
interest; a value of <code>NA</code> indicates that
samples of all parameters in the model will be stored</p>
</td></tr>
<tr><td><code id="dppmix_mvnorm_+3A_control">control</code></td>
<td>
<p>a list of control parameters:
<code>niter, burnin, thin</code></p>
</td></tr>
<tr><td><code id="dppmix_mvnorm_+3A_fixed">fixed</code></td>
<td>
<p>a list of fixed parameter values</p>
</td></tr>
<tr><td><code id="dppmix_mvnorm_+3A_verbose">verbose</code></td>
<td>
<p>whether to emit verbose message</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A determinantal point process (DPP) prior is a repulsive prior.
Compare to mixture models using independent priors, a DPP mixutre model
will often discover a parsimonious set of mixture components (clusters).
</p>
<p>Model fitting is done by sampling parameters from the posterior
distribution using a reversible jump Markov chain Monte Carlo sampling
approach.
</p>
<p>Given <code class="reqn">X = [x_i]</code>, where each <code class="reqn">x_i</code> is a D-dimensional real vector,
we seek the posterior distribution the latent variable <code class="reqn">z = [z_i]</code>, where
each <code class="reqn">z_i</code> is an integer representing cluster membership.
</p>
<p style="text-align: center;"><code class="reqn"> x_i \mid z_i  \sim  Normal(\mu_k, \Sigma_k) </code>
</p>

<p style="text-align: center;"><code class="reqn"> z_i           \sim  Categorical(w) </code>
</p>

<p style="text-align: center;"><code class="reqn"> w             \sim  Dirichlet([\delta ... \delta]) </code>
</p>

<p style="text-align: center;"><code class="reqn"> \mu_k         \sim  DPP(C) </code>
</p>

<p>where <code class="reqn">C</code> is the covariance function that evaluates the distances among the
data points:
</p>
<p style="text-align: center;"><code class="reqn"> C(x_1, x_2) = exp( - \sum_d \frac{ (x_1 - x_2)^2 }{ \theta^2 } ) </code>
</p>

<p>We also define <code class="reqn">\Sigma_k = E_k \Lambda_k E_k^\top</code>, where <code class="reqn">E_k</code> is an
orthonormal matrix whose column represents eigenvectors.
We further assume that <code class="reqn">E_k = E</code> is fixed across all cluster components 
so that <code class="reqn">E</code> can be estimated as the eigenvectors of the covariance matrix of
the data matrix <code class="reqn">X</code>. Finally, we put a prior on the entries of the
<code class="reqn">\Lambda_k</code> diagonal matrix:
</p>
<p style="text-align: center;"><code class="reqn"> \lambda_{kd}^{-1}  \sim  Gamma( a_0, b_0 ) </code>
</p>

<p>Hence, the hyperameters of the model include:
<code>delta, a0, b0, theta</code>, as well as sampling hyperparameter
<code>sigma_pro_mu</code>, which controls the spread of the Gaussian
proposal distribution for the random-walk Metropolis-Hastings update of
the <code class="reqn">\mu</code> parameter.
</p>
<p>The parameters (and their dimensions) in the model include:
<code>K</code>, <code>z (N x 1)</code>, <code>w (K x 1)</code>, <code>lambda (K x J)</code>,
<code>mu (K x J)</code>, <code>Sigma (J x J x K)</code>.
If any parameter is fixed, then <code>K</code> must be fixed as well.
</p>


<h3>Value</h3>

<p>a <code>dppmix_mcmc</code> object containing posterior samples of
the parameters
</p>


<h3>References</h3>

<p>Yanxun Xu, Peter Mueller, Donatello Telesca.
Bayesian Inference for Latent Biologic Structure with
Determinantal Point Processes.
Biometrics. 2016;72(3):955-64.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
ns &lt;- c(3, 3)
means &lt;- list(c(-6, -3), c(0, 4))
d &lt;- rmvnorm_clusters(ns, means)

mcmc &lt;- dppmix_mvnorm(d$X, verbose=FALSE)
res &lt;- estimate(mcmc)
table(d$cl, res$z)

</code></pre>

<hr>
<h2 id='estimate'>Estimate parameter.</h2><span id='topic+estimate'></span>

<h3>Description</h3>

<p>Estimate parameter from fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate(object, pars, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_+3A_object">object</code></td>
<td>
<p>fitted model</p>
</td></tr>
<tr><td><code id="estimate_+3A_pars">pars</code></td>
<td>
<p>names of parameters to estimate</p>
</td></tr>
<tr><td><code id="estimate_+3A_...">...</code></td>
<td>
<p>other parameters to pass</p>
</td></tr>
</table>

<hr>
<h2 id='rbern'>Random generator for the Bernoulli distribution.</h2><span id='topic+rbern'></span>

<h3>Description</h3>

<p>Random generator for the Bernoulli distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbern(n, prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rbern_+3A_n">n</code></td>
<td>
<p>number of samples to generate</p>
</td></tr>
<tr><td><code id="rbern_+3A_prob">prob</code></td>
<td>
<p>event probability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>integer</code> vector of 0 (non-event) and 1 (event)
</p>

<hr>
<h2 id='rbvec'>Generate a random binary vector.</h2><span id='topic+rbvec'></span>

<h3>Description</h3>

<p>Generate a random binary vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbvec(n, prob, e.min = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rbvec_+3A_n">n</code></td>
<td>
<p>size of binary vector</p>
</td></tr>
<tr><td><code id="rbvec_+3A_prob">prob</code></td>
<td>
<p>event probability
(not accounting for minimum event constraint)</p>
</td></tr>
<tr><td><code id="rbvec_+3A_e.min">e.min</code></td>
<td>
<p>minimum number of events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>integer</code> vector of 0 and 1
</p>

<hr>
<h2 id='rdirichlet'>Random generator for the Dirichlet distribution.</h2><span id='topic+rdirichlet'></span>

<h3>Description</h3>

<p>Random generator for the Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdirichlet(n, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdirichlet_+3A_n">n</code></td>
<td>
<p>number of vectors to generate</p>
</td></tr>
<tr><td><code id="rdirichlet_+3A_alpha">alpha</code></td>
<td>
<p>vector of parameters of the Dirichlet distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>matrix</code> in which each row vector is Dirichlet distributed
</p>

<hr>
<h2 id='rmvnorm_clusters'>Generate random multivarate clusters</h2><span id='topic+rmvnorm_clusters'></span>

<h3>Description</h3>

<p>Generate random multivarate clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmvnorm_clusters(ns, means)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmvnorm_clusters_+3A_ns">ns</code></td>
<td>
<p>number of data points in each cluster</p>
</td></tr>
<tr><td><code id="rmvnorm_clusters_+3A_means">means</code></td>
<td>
<p>centers of each cluster</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing matrix <code>X</code> and labels <code>cl</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ns &lt;- c(5, 8, 7)
means &lt;- list(c(-6, 1), c(-1, -1), c(0, 4))
d &lt;- rmvnorm_clusters(ns, means)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
