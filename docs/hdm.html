<!DOCTYPE html><html><head><title>Help for package hdm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hdm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hdm-package'><p>hdm: High-Dimensional Metrics</p></a></li>
<li><a href='#AJR'><p>AJR data set</p></a></li>
<li><a href='#BLP'><p>BLP data set</p></a></li>
<li><a href='#coef.rlassoEffects'><p>Coefficients from S3 objects <code>rlassoEffects</code></p></a></li>
<li><a href='#coef.rlassoIV'><p>Coefficients from S3 objects <code>rlassoIV</code></p></a></li>
<li><a href='#coef.rlassoIVselectX'><p>Coefficients from S3 objects <code>rlassoIVselectX</code></p></a></li>
<li><a href='#coef.rlassoIVselectZ'><p>Coefficients from S3 objects <code>rlassoIVselectZ</code></p></a></li>
<li><a href='#cps2012'><p>cps2012 data set</p></a></li>
<li><a href='#EminentDomain'><p>Eminent Domain data set</p></a></li>
<li><a href='#Growth+20Data'><p>Growth data set</p></a></li>
<li><a href='#lambdaCalculation'><p>Function for Calculation of the penalty parameter</p></a></li>
<li><a href='#LassoShooting.fit'><p>Shooting Lasso</p></a></li>
<li><a href='#p_adjust'><p>Multiple Testing Adjustment of p-values for S3 objects <code>rlassoEffects</code></p>
and <code>lm</code></a></li>
<li><a href='#pension'><p>Pension 401(k) data set</p></a></li>
<li><a href='#predict.rlassologit'><p>Methods for S3 object <code>rlassologit</code></p></a></li>
<li><a href='#print_coef'><p>Printing coefficients from S3 objects <code>rlassoEffects</code></p></a></li>
<li><a href='#print.rlasso'><p>Methods for S3 object <code>rlasso</code></p></a></li>
<li><a href='#print.rlassoEffects'><p>Methods for S3 object <code>rlassoEffects</code></p></a></li>
<li><a href='#print.rlassoIV'><p>Methods for S3 object <code>rlassoIV</code></p></a></li>
<li><a href='#print.rlassoIVselectX'><p>Methods for S3 object <code>rlassoIVselectX</code></p></a></li>
<li><a href='#print.rlassoIVselectZ'><p>Methods for S3 object <code>rlassoIVselectZ</code></p></a></li>
<li><a href='#print.rlassologitEffects'><p>Methods for S3 object <code>rlassologitEffects</code></p></a></li>
<li><a href='#print.rlassoTE'><p>Methods for S3 object <code>rlassoTE</code></p></a></li>
<li><a href='#print.tsls'><p>Methods for S3 object <code>tsls</code></p></a></li>
<li><a href='#rlasso'><p>rlasso: Function for Lasso estimation under homoscedastic and heteroscedastic non-Gaussian</p>
disturbances</a></li>
<li><a href='#rlassoATE'><p>Functions for estimation of treatment effects</p></a></li>
<li><a href='#rlassoEffects'><p>rigorous Lasso for Linear Models: Inference</p></a></li>
<li><a href='#rlassoIV'><p>Post-Selection and Post-Regularization Inference in Linear Models with Many</p>
Controls and Instruments</a></li>
<li><a href='#rlassoIVselectX'><p>Instrumental Variable Estimation with Selection on the exogenous Variables by Lasso</p></a></li>
<li><a href='#rlassoIVselectZ'><p>Instrumental Variable Estimation with Lasso</p></a></li>
<li><a href='#rlassologit'><p>rlassologit: Function for logistic Lasso estimation</p></a></li>
<li><a href='#rlassologitEffects'><p>rigorous Lasso for Logistic Models: Inference</p></a></li>
<li><a href='#summary.rlassoEffects'><p>Summarizing rlassoEffects fits</p></a></li>
<li><a href='#tsls'><p>Two-Stage Least Squares Estimation (TSLS)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>High-Dimensional Metrics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-09</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of selected high-dimensional statistical and
    econometric methods for estimation and inference. Efficient estimators and
    uniformly valid confidence intervals for various low-dimensional causal/
    structural parameters are provided which appear in high-dimensional
    approximately sparse models. Including functions for fitting heteroscedastic
    robust Lasso regressions with non-Gaussian errors and for instrumental variable
    (IV) and treatment effect estimation in a high-dimensional setting. Moreover,
    the methods enable valid post-selection inference and rely on a theoretically
    grounded, data-driven choice of the penalty.
    Chernozhukov, Hansen, Spindler (2016) &lt;<a href="https://doi.org/10.48550/arXiv.1603.01700">doi:10.48550/arXiv.1603.01700</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, glmnet, ggplot2, checkmate, Formula, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, formatR, xtable, mvtnorm,
markdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-14 15:17:25 UTC; bachp</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Spindler [cre, aut],
  Victor Chernozhukov [aut],
  Christian Hansen [aut],
  Philipp Bach [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Spindler &lt;martin.spindler@gmx.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-14 21:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='hdm-package'>hdm: High-Dimensional Metrics</h2><span id='topic+hdm-package'></span><span id='topic+hdm'></span>

<h3>Description</h3>

<p>This package implements methods for estimation and inference in a high-dimensional setting.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> hdm</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
0.1</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2015-05-25</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>
<p> This package provides efficient estimators 
and  uniformly valid confidence intervals for various low-dimensional causal/structural parameters  
appearing in high-dimensional approximately sparse models. The package
includes functions for fitting heteroskedastic robust Lasso regressions with non-Gaussian erros and 
for instrumental variable (IV) and treatment effect estimation in a
high-dimensional setting. Moreover, the methods enable valid post-selection
inference. Moreover, a theoretically grounded, data-driven choice of the penalty level is provided.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Martin Spindler <a href="mailto:martin.spindler@gmx.de">martin.spindler@gmx.de</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Victor Chernozhukov
</p>
</li>
<li><p> Christian Hansen
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Philipp Bach <a href="mailto:philipp.bach@uni-hamburg.de">philipp.bach@uni-hamburg.de</a> [contributor]
</p>
</li></ul>


<hr>
<h2 id='AJR'>AJR data set</h2><span id='topic+AJR'></span>

<h3>Description</h3>

<p>Dataset on settler mortality.
</p>


<h3>Format</h3>

 
<dl>
<dt>Mort</dt><dd><p>Settler mortality</p>
</dd>
<dt>logMort</dt><dd><p>logarithm of Mort</p>
</dd>
<dt>Latitude</dt><dd><p>Latitude</p>
</dd>
<dt>Latitude2</dt><dd><p>Latitude^2</p>
</dd>
<dt>Africa</dt><dd><p>Africa</p>
</dd>
<dt>Asia</dt><dd><p>Asia</p>
</dd>
<dt>Namer</dt><dd><p>North America</p>
</dd>
<dt>Samer</dt><dd><p>South America</p>
</dd>
<dt>Neo</dt><dd><p>Neo-Europes</p>
</dd>
<dt>GDP</dt><dd><p>GDP</p>
</dd>
<dt>Exprop</dt><dd><p>Average protection against expropriation risk</p>
</dd> 
</dl>



<h3>Details</h3>

<p>Data set was analysed in Acemoglu et al. (2001). A detailed description of the data can be found at <a href="https://economics.mit.edu/people/faculty/daron-acemoglu/data-archive">https://economics.mit.edu/people/faculty/daron-acemoglu/data-archive</a>
</p>


<h3>References</h3>

<p>D. Acemoglu, S. Johnson, J. A. Robinson  (2001). Colonial origins of comparative development: an empirical investigation.
American Economic Review, 91, 1369&ndash;1401.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AJR)
</code></pre>

<hr>
<h2 id='BLP'>BLP data set</h2><span id='topic+BLP'></span>

<h3>Description</h3>

<p>Automobile data set from the US.
</p>


<h3>Format</h3>

 
<dl>
<dt>model.name</dt><dd><p>model name</p>
</dd>
<dt>model.id</dt><dd><p>model id</p>
</dd>
<dt>firm.id</dt><dd><p>firm id</p>
</dd>
<dt>cdid</dt><dd><p>cdid</p>
</dd>
<dt>id</dt><dd><p>id</p>
</dd>
<dt>price</dt><dd><p>log price</p>
</dd>
<dt>mpg</dt><dd><p>miles per gallon</p>
</dd>
<dt>mpd</dt><dd><p>miles per dollar</p>
</dd>
<dt>hpwt</dt><dd><p>horse power per weight</p>
</dd>
<dt>air</dt><dd><p>air conditioning (binary variable)</p>
</dd>
<dt>space</dt><dd><p>size of the car</p>
</dd>
<dt>share</dt><dd><p>market share</p>
</dd>
<dt>outshr</dt><dd><p>share s0</p>
</dd>
<dt>y</dt><dd><p>outcome variable defined as log(share) - log(outshr) </p>
</dd>
<dt>trend</dt><dd><p>time trend</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data set was analysed in Berry, Levinsohn and Pakes (1995). The data stem from annual issues of the Automotive News Market Data Book. 
The data set inlcudes information on all models marketed during the the period beginning 1971 and ending in 1990 cotaining 2217 model/years from 997 distinct models.
A detailed description is given in BLP (1995, 868&ndash;871). The internal function <code>constructIV</code> constructs instrumental variables along the lines described and used in BLP (1995).
</p>


<h3>References</h3>

<p>S. Berry, J. Levinsohn, A. Pakes (1995). Automobile Prices in Market EquilibriumD. Econometrica, 63(4), 841&ndash;890.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BLP)
</code></pre>

<hr>
<h2 id='coef.rlassoEffects'>Coefficients from S3 objects <code>rlassoEffects</code></h2><span id='topic+coef.rlassoEffects'></span>

<h3>Description</h3>

<p>Method to extract coefficients from objects of class <code>rlassoEffects</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoEffects'
coef(
  object,
  complete = TRUE,
  selection.matrix = FALSE,
  include.targets = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.rlassoEffects_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoEffects</code>, usually a result of a call <code>rlassoEffect</code> or <code>rlassoEffects</code>.</p>
</td></tr>
<tr><td><code id="coef.rlassoEffects_+3A_complete">complete</code></td>
<td>
<p>general option of the function <code>coef</code>.</p>
</td></tr>
<tr><td><code id="coef.rlassoEffects_+3A_selection.matrix">selection.matrix</code></td>
<td>
<p>if TRUE, a selection matrix is returned that indicates the selected variables from each auxiliary regression. 
Default is set to FALSE.</p>
</td></tr>
<tr><td><code id="coef.rlassoEffects_+3A_include.targets">include.targets</code></td>
<td>
<p>if FALSE (by default) only the selected control variables are listed in the <code>selection.matrix</code>. If set to TRUE, 
the selection matrix will also indicate the selection of the target coefficients that are specified in the  <code>rlassoEffects</code> call.</p>
</td></tr>
<tr><td><code id="coef.rlassoEffects_+3A_...">...</code></td>
<td>
<p>further arguments passed to functions coef or print.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Printing coefficients and selection matrix for S3 object <code>rlassoEffects</code>. Interpretation of entries in the selection matrix
</p>

<ul>
<li> <p><code>"-"</code> indicates a target variable,
</p>
</li>
<li> <p><code>"x"</code> indicates that a variable has been selected with rlassoEffects (coefficient is different from zero),
</p>
</li>
<li> <p><code>"."</code> indicates that a variable has been de-selected with rlassoEffects (coefficient is zero).
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(hdm)
set.seed(1)
n = 100 #sample size
p = 100 # number of variables
s = 7 # number of non-zero variables
X = matrix(rnorm(n*p), ncol=p)
colnames(X) &lt;- paste("X", 1:p, sep="")
beta = c(rep(3,s), rep(0,p-s))
y = 1 + X%*%beta + rnorm(n)
data = data.frame(cbind(y,X))
colnames(data)[1] &lt;- "y"
lasso.effect = rlassoEffects(X, y, index=c(1,2,3,50), 
                             method = "double selection")
coef(lasso.effect) # standard use of coef() - without selection matrix
# with selection matrix
coef(lasso.effect, selection.matrix = TRUE)
# prettier output with print_coef (identical options as coef())
print_coef(lasso.effect, selection.matrix = TRUE) 
</code></pre>

<hr>
<h2 id='coef.rlassoIV'>Coefficients from S3 objects <code>rlassoIV</code></h2><span id='topic+coef.rlassoIV'></span>

<h3>Description</h3>

<p>Method to extract coefficients from objects of class <code>rlassoIV</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoIV'
coef(object, complete = TRUE, selection.matrix = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.rlassoIV_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoIV</code>, usually a result of a call <code>rlassoIV</code> with options <code>select.X=TRUE</code> and <code>select.Z=TRUE</code>.</p>
</td></tr>
<tr><td><code id="coef.rlassoIV_+3A_complete">complete</code></td>
<td>
<p>general option of the function <code>coef</code>.</p>
</td></tr>
<tr><td><code id="coef.rlassoIV_+3A_selection.matrix">selection.matrix</code></td>
<td>
<p>if TRUE, a selection matrix is returned that indicates the selected variables from each first stage regression.
Default is set to FALSE. See section on details for more information.</p>
</td></tr>
<tr><td><code id="coef.rlassoIV_+3A_...">...</code></td>
<td>
<p>further arguments passed to function coef.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Printing coefficients and selection matrix for S3 object <code>rlassoIV</code>. <code>"x"</code> indicates that a variable has been selected, i.e., the corresponding estimated coefficient is different from zero.
The very last column collects all variables that have been selected in at least one of the lasso regressions represented in the <code>selection.matrix</code>. 
<code>rlassoIV</code> performs three lasso regression steps. A first stage lasso regression of the endogenous treatment variable <code>d</code> on the instruments <code>z</code> and exogenous covariates <code>x</code>,
a lasso regression of <code>y</code> on the exogenous variables <code>x</code>, and a lasso regression of the instrumented treatment variable, i.e., a regression of the predicted values of <code>d</code>, on controls <code>x</code>.
</p>


<h3>Value</h3>

<p>Coefficients obtained from <code>rlassoIV</code> by default. If option <code>selection.matrix</code> is <code>TRUE</code>, a list is returned with final coefficients, a matrix <code>selection.matrix</code>, and a matrix <code>selection.matrixZ</code>: 
<code>selection.matrix</code> contains the selection index for the lasso regression of <code>y</code> on <code>x</code> (first column) and the lasso regression of the predicted values of <code>d</code> on <code>x</code>
together with the union of these indizes.
<code>selection.matrixZ</code> contains the selection index from the first-stage lasso regression of <code>d</code> on <code>z</code> and <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(EminentDomain)
z &lt;- EminentDomain$logGDP$z # instruments
x &lt;- EminentDomain$logGDP$x # exogenous variables
y &lt;- EminentDomain$logGDP$y # outcome varialbe
d &lt;- EminentDomain$logGDP$d # treatment / endogenous variable
lasso.IV = rlassoIV(x=x, d=d, y=y, z=z, select.X=TRUE, select.Z=TRUE) 
coef(lasso.IV) # default behavior
coef(lasso.IV, selection.matrix = T) # print selection matrix

## End(Not run)
</code></pre>

<hr>
<h2 id='coef.rlassoIVselectX'>Coefficients from S3 objects <code>rlassoIVselectX</code></h2><span id='topic+coef.rlassoIVselectX'></span>

<h3>Description</h3>

<p>Method to extract coefficients and selection matrix from objects of class <code>rlassoIVselectX</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoIVselectX'
coef(object, complete = TRUE, selection.matrix = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.rlassoIVselectX_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoIVselectX</code>, usually a result of a call 
<code>rlassoIVselectX</code> or <code>rlassoIV</code> with options <code>select.X=TRUE</code> and
<code>select.Z=FALSE</code>.</p>
</td></tr>
<tr><td><code id="coef.rlassoIVselectX_+3A_complete">complete</code></td>
<td>
<p>general option of the function <code>coef</code>.</p>
</td></tr>
<tr><td><code id="coef.rlassoIVselectX_+3A_selection.matrix">selection.matrix</code></td>
<td>
<p>if TRUE, a selection matrix is returned that indicates the selected variables from each regression.
Default is set to FALSE. See section on details for more information.</p>
</td></tr>
<tr><td><code id="coef.rlassoIVselectX_+3A_...">...</code></td>
<td>
<p>further arguments passed to functions coef.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Printing coefficients and selection matrix for S3 object <code>rlassoIVselectX</code>. The first column of the selection matrix reports the selection index for the lasso regression of <code>y</code> on <code>x</code> in the specified
<code>rlassoIVselectX</code> command. <code>"x"</code> indicates that a variable has been selected, i.e., the corresponding estimated coefficient is different from zero.
The second column contains the selection index for the lasso regression of <code>d</code> on <code>x</code> and the remaining columns
the index of selected variables <code>x</code> for the instruments <code>z</code>. The very last column collects all variables that have been selected in at least one of the lasso regressions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(hdm)
data(AJR); y = AJR$GDP; d = AJR$Exprop; z = AJR$logMort
x = model.matrix(~ -1 + (Latitude + Latitude2 + Africa + 
                           Asia + Namer + Samer)^2, data=AJR)
AJR.Xselect = rlassoIV(GDP ~ Exprop +  (Latitude + Latitude2 + Africa + Asia + Namer + Samer)^2 |
                         logMort +  (Latitude + Latitude2 + Africa + Asia + Namer + Samer)^2,
                       data=AJR, select.X=TRUE, select.Z=FALSE)
coef(AJR.Xselect) # Default behavior
coef(AJR.Xselect, selection.matrix = TRUE) # print selection matrix

## End(Not run)
</code></pre>

<hr>
<h2 id='coef.rlassoIVselectZ'>Coefficients from S3 objects <code>rlassoIVselectZ</code></h2><span id='topic+coef.rlassoIVselectZ'></span>

<h3>Description</h3>

<p>Method to extract coefficients from objects of class <code>rlassoIVselectZ</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoIVselectZ'
coef(object, complete = TRUE, selection.matrix = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.rlassoIVselectZ_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoIVselectZ</code>, usually a result of a call 
<code>rlassoIVselectZ</code> or <code>rlassoIV</code> with options <code>select.X=FALSE</code> and
<code>select.Z=TRUE</code>.</p>
</td></tr>
<tr><td><code id="coef.rlassoIVselectZ_+3A_complete">complete</code></td>
<td>
<p>general option of the function <code>coef</code>.</p>
</td></tr>
<tr><td><code id="coef.rlassoIVselectZ_+3A_selection.matrix">selection.matrix</code></td>
<td>
<p>if TRUE, a selection matrix is returned that indicates the selected variables from each first stage regression.
Default is set to FALSE. See section on details for more information.</p>
</td></tr>
<tr><td><code id="coef.rlassoIVselectZ_+3A_...">...</code></td>
<td>
<p>further arguments passed to functions coef.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Printing coefficients and selection matrix for S3 object <code>rlassoIVselectZ</code>. The columns of the selection matrix report the selection index for the first stage lasso regressions as specified
<code>rlassoIVselectZ</code> command, i.e., the selected variables for each of the endogenous variables. <code>"x"</code> indicates that a variable has been selected, i.e., the corresponding estimated coefficient is different from zero.
The very last column collects all variables that have been selected in at least one of the lasso regressions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
lasso.IV.Z = rlassoIVselectZ(x=x, d=d, y=y, z=z)
data(EminentDomain)
z &lt;- EminentDomain$logGDP$z # instruments
x &lt;- EminentDomain$logGDP$x # exogenous variables
y &lt;- EminentDomain$logGDP$y # outcome varialbe
d &lt;- EminentDomain$logGDP$d # treatment / endogenous variable
lasso.IV.Z = rlassoIVselectZ(x=x, d=d, y=y, z=z)
coef(lasso.IV.Z) # Default behavior
coef(lasso.IV.Z, selection.matrix = T)

## End(Not run)
</code></pre>

<hr>
<h2 id='cps2012'>cps2012 data set</h2><span id='topic+cps2012'></span>

<h3>Description</h3>

<p>Census data from the US for the year 2012.
</p>


<h3>Format</h3>

 
<dl>
<dt>lnw</dt><dd><p>log of hourly wage (annual earnings / annual hours)</p>
</dd>
<dt>female</dt><dd><p>female indicator</p>
</dd>
<dt>married status</dt><dd><p> six indicators: widowed, divorced, separated, nevermarried, and married (omitted)</p>
</dd>
<dt>education attainment</dt><dd><p>six indicators: hsd08, hsd911, hsg, cg, ad, and sc (omitted)</p>
</dd>
<dt>region indicators</dt><dd><p>four indicators: mw, so, we, and ne (omitted)</p>
</dd>
<dt>potential experience</dt><dd><p>(max[0, age - years of education - 7]): exp1, exp2 (divided by 100), exp3 (divided by 1000), exp4 (divided by 10000)</p>
</dd>
<dt>weight</dt><dd><p>March Supplement sampling weight</p>
</dd>
<dt>year</dt><dd><p>CPS year</p>
</dd>
</dl>



<h3>Details</h3>

<p>The CPS is a monthly U.S. household survey conducted jointly by the U.S. Census Bureau and the Bureau of Labor Statistics. The data comprise the year 2012. 
This data set was used in Mulligan and Rubinstein (2008). 
The sample comprises white non-hipanic, ages 25-54, working full time full year (35+ hours per week at least 50 weeks), exclude living in group quarters, 
self-employed, military, agricultural, and private household sector, allocated earning, inconsistent report on earnings and employment, missing data.
</p>


<h3>References</h3>

<p>C. B. Mulligan and Y. Rubinstein (2008). Selection, investment, and women's relative wages over time. The Quarterly Journal of Economics, 1061&ndash;1110.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BLP)
</code></pre>

<hr>
<h2 id='EminentDomain'>Eminent Domain data set</h2><span id='topic+EminentDomain'></span>

<h3>Description</h3>

<p>Dataset on judicial eminent domain decisions.
</p>


<h3>Format</h3>

 
<dl>
<dt>y</dt><dd><p>economic outcome variable</p>
</dd>
<dt>x</dt><dd><p>set of exogenous variables</p>
</dd>
<dt>d</dt><dd><p>eminent domain decisions</p>
</dd>
<dt>z</dt><dd><p>set of potential instruments</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data set was analyzed in Belloni et al. (2012).  They estimate the effect of judicial eminent domain decisions on economic outcomes with instrumental variables (IV) in a setting high a large set of potential IVs. 
A detailed decription of the data can be found at 
<a href="https://www.econometricsociety.org/publications/econometrica/2012/11/01/sparse-models-and-methods-optimal-instruments-application">https://www.econometricsociety.org/publications/econometrica/2012/11/01/sparse-models-and-methods-optimal-instruments-application</a> 
The data set contains four &quot;sub-data sets&quot; which differ mainly in the dependent variables: repeat-sales FHFA/OFHEO house price index for metro (FHFA) and non-metro (NM) area, the Case-Shiller home price index (CS), 
and state-level GDP from the Bureau of Economic Analysis - all transformed with the logarithm. The structure of each subdata set is given above.
In the data set the following variables and name conventions are used:
&quot;numpanelskx_...&quot; is the number of panels with at least k members with the characteristic following the &quot;_&quot;. 
The probability controls (names start with &quot;F_prob_&quot;) follow a similar naming convention and give the probability of observing a panel with characteristic given following second &quot;_&quot; given the characteristics of the pool of judges available to be assigned to the case. 
</p>
<p>Characteristics in the data for the control variables or instruments:
</p>

<dl>
<dt>noreligion</dt><dd><p>judge reports no religious affiliation</p>
</dd>
<dt>jd_public</dt><dd><p>judge's law degree is from a public university</p>
</dd>
<dt>dem</dt><dd><p>judge reports being a democrat</p>
</dd>
<dt>female</dt><dd><p>judge is female</p>
</dd>
<dt>nonwhite</dt><dd><p>judge is nonwhite (and not black)</p>
</dd>
<dt>black</dt><dd><p>judge is black</p>
</dd>
<dt>jewish</dt><dd><p>judge is  Jewish</p>
</dd>
<dt>catholic</dt><dd><p>judge is Catholic</p>
</dd>
<dt>mainline</dt><dd><p>baseline religion</p>
</dd>
<dt>protestant</dt><dd><p>belongs to a protestant church</p>
</dd>
<dt>evangelical</dt><dd><p>belongs to an evangelical church</p>
</dd>
<dt>instate_ba</dt><dd><p>judge's undergraduate degree was obtained within state</p>
</dd>
<dt>ba_public</dt><dd><p>judge's undergraduate degree was obtained at a public university</p>
</dd>
<dt>elev</dt><dd><p>judge was elevated from a district court</p>
</dd>
<dt>year</dt><dd><p>year dummy (reference category is one year before the earliest year in the data set (excluded))</p>
</dd>
<dt>circuit</dt><dd><p>dummy for the circuit level (reference category excluded)</p>
</dd>
<dt>missing_cy_12</dt><dd><p>a dummy for whether there were no cases in that circuit-year</p>
</dd>
<dt>numcasecat_12</dt><dd><p>the number of takings appellate decisions</p>
</dd>
</dl>



<h3>References</h3>

<p>D. Belloni, D. Chen, V. Chernozhukov and C. Hansen (2012).
Sparse models and methods for optimal instruments with an application to
eminent domain. <em>Econometrica</em> 80 (6), 2369&ndash;2429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(EminentDomain)
</code></pre>

<hr>
<h2 id='Growth+20Data'>Growth data set</h2><span id='topic+Growth+20Data'></span><span id='topic+Growth'></span><span id='topic+Example'></span><span id='topic+GrowthData'></span><span id='topic+GDP'></span>

<h3>Description</h3>

<p>Data set of growth compiled by Barro Lee.
</p>


<h3>Format</h3>

<p>Dataframe with the following variables:
</p>

<dl>
<dt>outcome</dt><dd><p>dependent variable: national growth rates in GDP per capita
for the periods 1965-1975 and 1975-1985</p>
</dd>
<dt>x</dt><dd><p>covariates which might influence growth</p>
</dd></dl>



<h3>Details</h3>

<p>The data set contains growth data of Barro-Lee. The Barro Lee data consists
of a panel of 138 countries for the period 1960 to 1985. The dependent
variable is national growth rates in GDP per capita for the periods
1965-1975 and 1975-1985. The growth rate in GDP over a period from <code class="reqn">t_1</code> to <code class="reqn">t_2</code>
is commonly defined as <code class="reqn">\log(GDP_{t_1}/GDP_{t_2})</code>. The number of covariates is p=62.
The number of complete observations is 90.
</p>


<h3>Source</h3>

<p>The full data set and further details can be found at
<a href="https://www2.nber.org/pub/barro.lee/">https://www2.nber.org/pub/barro.lee/</a> and,
<a href="https://www.bristol.ac.uk//Depts//Economics//Growth//barlee.htm">https://www.bristol.ac.uk//Depts//Economics//Growth//barlee.htm</a>.
</p>


<h3>References</h3>

<p>R.J. Barro, J.W. Lee (1994). Data set for a panel of 139
countries. NBER.
</p>
<p>R.J. Barro, X. Sala-i-Martin (1995). Economic Growth. McGrwa-Hill, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GrwothData)
</code></pre>

<hr>
<h2 id='lambdaCalculation'>Function for Calculation of the penalty parameter</h2><span id='topic+lambdaCalculation'></span>

<h3>Description</h3>

<p>This function implements different methods for calculation of the penalization parameter <code class="reqn">\lambda</code>. Further details can be found under <a href="#topic+rlasso">rlasso</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambdaCalculation(
  penalty = list(homoscedastic = FALSE, X.dependent.lambda = FALSE, lambda.start = NULL,
    c = 1.1, gamma = 0.1),
  y = NULL,
  x = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambdaCalculation_+3A_penalty">penalty</code></td>
<td>
<p>list with options for the calculation of the penalty. 
</p>

<ul>
<li> <p><code>c</code> and <code>gamma</code> constants for the penalty with default <code>c=1.1</code> and <code>gamma=0.1</code>
</p>
</li>
<li> <p><code>homoscedastic</code> logical, if homoscedastic errors are considered (default <code>FALSE</code>). Option <code>none</code> is described below.
</p>
</li>
<li> <p><code>X.dependent.lambda</code> if <code>independent</code> or <code>dependent</code> design matrix <code>X</code> is assumed for calculation of the parameter <code class="reqn">\lambda</code>
</p>
</li>
<li> <p><code>numSim</code>  number of simulations for the X-dependent methods
</p>
</li>
<li> <p><code>lambda.start</code> initial penalization value, compulsory for method &quot;none&quot;
</p>
</li></ul>
</td></tr>
<tr><td><code id="lambdaCalculation_+3A_y">y</code></td>
<td>
<p>residual which is used for calculation of the variance or the data-dependent loadings</p>
</td></tr>
<tr><td><code id="lambdaCalculation_+3A_x">x</code></td>
<td>
<p>matrix of regressor variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The functions returns a list with the penalty <code>lambda</code> which is the product of <code>lambda0</code> and <code>Ups0</code>. <code>Ups0</code>
denotes either the variance (<code>independent</code> case) or the data-dependent loadings for the regressors. <code>method</code> gives the selected method for the calculation.
</p>

<hr>
<h2 id='LassoShooting.fit'>Shooting Lasso</h2><span id='topic+LassoShooting.fit'></span>

<h3>Description</h3>

<p>Implementation of the Shooting Lasso (Fu, 1998) with variable dependent
penalization weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LassoShooting.fit(
  x,
  y,
  lambda,
  control = list(maxIter = 1000, optTol = 10^(-5), zeroThreshold = 10^(-6)),
  XX = NULL,
  Xy = NULL,
  beta.start = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LassoShooting.fit_+3A_x">x</code></td>
<td>
<p>matrix of regressor variables (<code>n</code> times <code>p</code> where
<code>n</code> denotes the number of observations and <code>p</code> the number of
regressors)</p>
</td></tr>
<tr><td><code id="LassoShooting.fit_+3A_y">y</code></td>
<td>
<p>dependent variable (vector or matrix)</p>
</td></tr>
<tr><td><code id="LassoShooting.fit_+3A_lambda">lambda</code></td>
<td>
<p>vector of length <code>p</code> of penalization parameters for each
regressor</p>
</td></tr>
<tr><td><code id="LassoShooting.fit_+3A_control">control</code></td>
<td>
<p>list with control parameters: <code>maxIter</code> maximal number
of iterations, <code>optTol</code> tolerance for parameter precision,
<code>zeroThreshold</code> threshold applied to the estimated coefficients
for numerical issues.</p>
</td></tr>
<tr><td><code id="LassoShooting.fit_+3A_xx">XX</code></td>
<td>
<p>optional, precalculated matrix <code class="reqn">t(X)*X</code></p>
</td></tr>
<tr><td><code id="LassoShooting.fit_+3A_xy">Xy</code></td>
<td>
<p>optional, precalculated matrix <code class="reqn">t(X)*y</code></p>
</td></tr>
<tr><td><code id="LassoShooting.fit_+3A_beta.start">beta.start</code></td>
<td>
<p>start value for beta</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements the Shooting Lasso (Fu, 1998) with variable dependent
penalization. The arguments <code>XX</code> and <code>Xy</code> are optional and allow to use precalculated matrices which might improve performance.
</p>


<h3>Value</h3>

<table>
<tr><td><code>coefficients</code></td>
<td>
<p>estimated coefficients by the Shooting Lasso
Algorithm</p>
</td></tr> <tr><td><code>coef.list</code></td>
<td>
<p>matrix of coefficients from each iteration</p>
</td></tr>
<tr><td><code>num.it</code></td>
<td>
<p>number of iterations run</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fu, W. (1998). Penalized regressions: the bridge vs the lasso.
<em>Journal of Computational and Graphical Software</em> 7, 397-416.
</p>

<hr>
<h2 id='p_adjust'>Multiple Testing Adjustment of p-values for S3 objects <code>rlassoEffects</code>
and <code>lm</code></h2><span id='topic+p_adjust'></span><span id='topic+p_adjust.rlassoEffects'></span><span id='topic+p_adjust.lm'></span>

<h3>Description</h3>

<p>Multiple hypotheses testing adjustment of p-values from a high-dimensional
linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_adjust(x, ...)

## S3 method for class 'rlassoEffects'
p_adjust(x, method = "RW", B = 1000, ...)

## S3 method for class 'lm'
p_adjust(x, method = "RW", B = 1000, test.index = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_adjust_+3A_x">x</code></td>
<td>
<p>an object of S3 class <code>rlassoEffects</code> or <code>lm</code>.</p>
</td></tr>
<tr><td><code id="p_adjust_+3A_...">...</code></td>
<td>
<p>further arguments passed on to methods.</p>
</td></tr>
<tr><td><code id="p_adjust_+3A_method">method</code></td>
<td>
<p>the method of p-value adjustment for multiple testing.
Romano-Wolf stepdown ('<code>RW</code>') is chosen by default.</p>
</td></tr>
<tr><td><code id="p_adjust_+3A_b">B</code></td>
<td>
<p>number of bootstrap repetitions (default 1000).</p>
</td></tr>
<tr><td><code id="p_adjust_+3A_test.index">test.index</code></td>
<td>
<p>vector of integers, logicals or variables names indicating
the position of coefficients (integer case), logical vector of length of the
coefficients (TRUE or FALSE) or the coefficient names of x which should be
tested simultaneously (only for S3 class <code>lm</code>). If missing, all
coefficients are considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple testing adjustment is performed for S3 objects of class
<code>rlassoEffects</code> and <code>lm</code>. Implemented methods for multiple testing
adjustment are Romano-Wolf stepdown '<code>RW</code>' (default) and the adjustment
methods available in the <code>p.adjust</code> function of the <code>stats</code> package,
including the Bonferroni, Bonferroni-Holm, and Benjamini-Hochberg corrections,
see <code><a href="stats.html#topic+p.adjust.methods">p.adjust.methods</a></code>.
</p>
<p>Objects of class <code>rlassoEffects</code> are constructed by
<code><a href="#topic+rlassoEffects">rlassoEffects</a></code>.
</p>


<h3>Value</h3>

<p>A matrix with the estimated coefficients and the p-values that are
adjusted according to the specified method.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>p_adjust(rlassoEffects)</code>: <code><a href="#topic+rlassoEffects">rlassoEffects</a></code>.
</p>
</li>
<li> <p><code>p_adjust(lm)</code>: <code><a href="stats.html#topic+lm">lm</a></code>.
</p>
</li></ul>


<h3>References</h3>

<p>J.P. Romano, M. Wolf (2005). Exact and approximate stepdown
methods for multiple hypothesis testing. Journal of the American Statistical
Association, 100(469), 94-108.
</p>
<p>J.P. Romano, M. Wolf (2016). Efficient computation of adjusted
p-values for resampling-based stepdown multiple testing. Statistics and
Probability Letters, (113), 38-40.
</p>
<p>A. Belloni, V. Chernozhukov, K. Kato (2015). Uniform
post-selection inference for least absolute deviation regression and other
Z-estimation problems. Biometrika, 102(1), 77-94.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(hdm);
set.seed(1)
n = 100 #sample size
p = 25 # number of variables
s = 3 # nubmer of non-zero variables
X = matrix(rnorm(n*p), ncol=p)
colnames(X) &lt;- paste("X", 1:p, sep="")
beta = c(rep(3,s), rep(0,p-s))
y = 1 + X%*%beta + rnorm(n)
data = data.frame(cbind(y,X))
colnames(data)[1] &lt;- "y"
lasso.effect = rlassoEffects(X, y, index=c(1:20))
pvals.lasso.effect = p_adjust(lasso.effect, method = "RW", B = 1000)
ols = lm(y ~ -1 + X, data)
pvals.ols = p_adjust(ols, method = "RW", B = 1000)
pvals.ols = p_adjust(ols, method = "RW", B = 1000, test.index = c(1,2,5))
pvals.ols = p_adjust(ols, method = "RW", B = 1000, test.index = c(rep(TRUE, 5), rep(FALSE, p-5)))
</code></pre>

<hr>
<h2 id='pension'>Pension 401(k) data set</h2><span id='topic+pension'></span><span id='topic+401+28k+29'></span><span id='topic+plans'></span><span id='topic+wealth'></span><span id='topic+data'></span>

<h3>Description</h3>

<p>Data set on financial wealth and 401(k) plan participation
</p>


<h3>Format</h3>

<p>Dataframe with the following variables (amongst others): </p>

<dl>
<dt>p401</dt><dd><p>participation in 401(k)</p>
</dd>
<dt>e401</dt><dd><p>eligibility for 401(k)</p>
</dd>
<dt>a401</dt><dd><p>401(k) assets</p>
</dd>
<dt>tw</dt><dd><p>total wealth (in US $)</p>
</dd>
<dt>tfa</dt><dd><p>financial assets (in US $)</p>
</dd>
<dt>net_tfa</dt><dd><p>net financial assets (in US $)</p>
</dd>
<dt>nifa</dt><dd><p>non-401k financial assets (in US $)</p>
</dd>
<dt>net_nifa</dt><dd><p>net non-401k financial assets</p>
</dd>
<dt>net_n401</dt><dd><p>net non-401(k) assets (in US $)</p>
</dd>
<dt>ira</dt><dd><p>individual retirement account (IRA)</p>
</dd>
<dt>inc</dt><dd><p>income (in US $)</p>
</dd>
<dt>age</dt><dd><p>age</p>
</dd>
<dt>fsize</dt><dd><p>family size</p>
</dd>
<dt>marr</dt><dd><p>married</p>
</dd>
<dt>pira</dt><dd><p>participation in IRA</p>
</dd> <dt>db</dt><dd><p>defined benefit pension</p>
</dd>
<dt>hown</dt><dd><p>home owner</p>
</dd> <dt>educ</dt><dd><p>education (in years)</p>
</dd> <dt>male</dt><dd><p>male</p>
</dd>
<dt>twoearn</dt><dd><p>two earners</p>
</dd> 
<dt>nohs, hs, smcol, col</dt><dd><p>dummies for education: no high-school, high-school, some college, college</p>
</dd>
<dt>hmort</dt><dd><p>home mortage (in US $)</p>
</dd>
<dt>hequity</dt><dd><p>home equity (in US $)</p>
</dd> <dt>hval</dt><dd><p>home value (in US $)</p>
</dd></dl>



<h3>Details</h3>

<p>The sample is drawn from the 1991 Survey of Income and Program Participation
(SIPP) and consists of 9,915 observations. The observational units are
household reference persons aged 25-64 and spouse if present. Households are
included in the sample if at least one person is employed and no one is
self-employed. The data set was analysed in Chernozhukov and Hansen (2004)
and Belloni et al. (2014) where further details can be found. They examine
the effects of 401(k) plans on wealth using data from the Survey of Income
and Program Participation using 401(k) eligibility as an instrument for
401(k) participation.
</p>


<h3>References</h3>

<p>V. Chernohukov, C. Hansen (2004). The impact of 401(k)
participation on the wealth distribution: An instrumental quantile
regression analysis. The Review of Economic and Statistics 86 (3), 735&ndash;751.
</p>
<p>A. Belloni, V. Chernozhukov, I. Fernandez-Val, and C. Hansen (2014). Program
evaluation with high-dimensional data. Working Paper.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pension)
</code></pre>

<hr>
<h2 id='predict.rlassologit'>Methods for S3 object <code>rlassologit</code></h2><span id='topic+predict.rlassologit'></span><span id='topic+methods.rlassologit'></span><span id='topic+print.rlassologit'></span><span id='topic+summary.rlassologit'></span><span id='topic+model.matrix.rlassologit'></span>

<h3>Description</h3>

<p>Objects of class <code>rlassologit</code> are constructed by <code>rlassologit</code>.
<code>print.rlassologit</code> prints and displays some information about fitted <code>rlassologit</code> objects.
<code>summary.rlassologit</code> summarizes information of a fitted <code>rlassologit</code> object.
<code>predict.rlassologit</code> predicts values based on a <code>rlassologit</code> object.
<code>model.matrix.rlassologit</code> constructs the model matrix of a lasso object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassologit'
predict(object, newdata = NULL, type = "response", ...)

## S3 method for class 'rlassologit'
model.matrix(object, ...)

## S3 method for class 'rlassologit'
print(x, all = TRUE, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassologit'
summary(object, all = TRUE, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.rlassologit_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassologit</code></p>
</td></tr>
<tr><td><code id="predict.rlassologit_+3A_newdata">newdata</code></td>
<td>
<p>new data set for prediction</p>
</td></tr>
<tr><td><code id="predict.rlassologit_+3A_type">type</code></td>
<td>
<p>type of prediction required. The default ('response) is on the scale of the response variable; the alternative 'link' is on the scale of the linear predictors.</p>
</td></tr>
<tr><td><code id="predict.rlassologit_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods</p>
</td></tr>
<tr><td><code id="predict.rlassologit_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlassologit</code></p>
</td></tr>
<tr><td><code id="predict.rlassologit_+3A_all">all</code></td>
<td>
<p>logical, indicates if coefficients of all variables (TRUE) should be displayed or only the non-zero ones (FALSE)</p>
</td></tr>
<tr><td><code id="predict.rlassologit_+3A_digits">digits</code></td>
<td>
<p>significant digits in printout</p>
</td></tr>
</table>

<hr>
<h2 id='print_coef'>Printing coefficients from S3 objects <code>rlassoEffects</code></h2><span id='topic+print_coef'></span><span id='topic+print_coef.rlassoEffects'></span>

<h3>Description</h3>

<p>Printing coefficients for class <code>rlassoEffects</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_coef(x, ...)

## S3 method for class 'rlassoEffects'
print_coef(
  x,
  complete = TRUE,
  selection.matrix = FALSE,
  include.targets = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_coef_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlassoEffects</code>, usually a result of a call <code>rlassoEffect</code> or <code>rlassoEffects</code>.</p>
</td></tr>
<tr><td><code id="print_coef_+3A_...">...</code></td>
<td>
<p>further arguments passed to functions coef or print.</p>
</td></tr>
<tr><td><code id="print_coef_+3A_complete">complete</code></td>
<td>
<p>general option of the function <code>coef</code>.</p>
</td></tr>
<tr><td><code id="print_coef_+3A_selection.matrix">selection.matrix</code></td>
<td>
<p>if TRUE, a selection matrix is returned that indicates the selected variables from each auxiliary regression. 
Default is set to FALSE.</p>
</td></tr>
<tr><td><code id="print_coef_+3A_include.targets">include.targets</code></td>
<td>
<p>if FALSE (by default) only the selected control variables are listed in the <code>selection.matrix</code>. If set to TRUE, 
the selection matrix will also indicate the selection of the target coefficients that are specified in the  <code>rlassoEffects</code> call.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Printing coefficients and selection matrix for S3 object <code>rlassoEffects</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(hdm)
set.seed(1)
n = 100 #sample size
p = 100 # number of variables
s = 7 # number of non-zero variables
X = matrix(rnorm(n*p), ncol=p)
colnames(X) &lt;- paste("X", 1:p, sep="")
beta = c(rep(3,s), rep(0,p-s))
y = 1 + X%*%beta + rnorm(n)
data = data.frame(cbind(y,X))
colnames(data)[1] &lt;- "y"
lasso.effect = rlassoEffects(X, y, index=c(1,2,3,50), 
                             method = "double selection")
# without target coefficient estimates
print_coef(lasso.effect, selection.matrix = TRUE) 
# with target coefficient estimates
print_coef(lasso.effect, selection.matrix = TRUE, targets = TRUE) 
</code></pre>

<hr>
<h2 id='print.rlasso'>Methods for S3 object <code>rlasso</code></h2><span id='topic+print.rlasso'></span><span id='topic+methods.rlasso'></span><span id='topic+predict.rlasso'></span><span id='topic+model.matrix.rlasso'></span><span id='topic+summary.rlasso'></span>

<h3>Description</h3>

<p>Objects of class <code>rlasso</code> are constructed by <code>rlasso</code>.
<code>print.rlasso</code> prints and displays some information about fitted <code>rlasso</code> objects.
<code>summary.rlasso</code> summarizes information of a fitted <code>rlasso</code> object.
<code>predict.rlasso</code> predicts values based on a <code>rlasso</code> object.
<code>model.matrix.rlasso</code> constructs the model matrix of a <code>rlasso</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlasso'
print(x, all = TRUE, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlasso'
summary(object, all = TRUE, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlasso'
model.matrix(object, ...)

## S3 method for class 'rlasso'
predict(object, newdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rlasso_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlasso</code></p>
</td></tr>
<tr><td><code id="print.rlasso_+3A_all">all</code></td>
<td>
<p>logical, indicates if coefficients of all variables (TRUE) should be displayed or only the non-zero ones (FALSE)</p>
</td></tr>
<tr><td><code id="print.rlasso_+3A_digits">digits</code></td>
<td>
<p>significant digits in printout</p>
</td></tr>
<tr><td><code id="print.rlasso_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods</p>
</td></tr>
<tr><td><code id="print.rlasso_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlasso</code></p>
</td></tr>
<tr><td><code id="print.rlasso_+3A_newdata">newdata</code></td>
<td>
<p>new data set for prediction. An optional data frame in which to look for variables with which to predict. If omitted, the fitted values are returned.</p>
</td></tr>
</table>

<hr>
<h2 id='print.rlassoEffects'>Methods for S3 object <code>rlassoEffects</code></h2><span id='topic+print.rlassoEffects'></span><span id='topic+methods.rlassoEffects'></span><span id='topic+confint.rlassoEffects'></span><span id='topic+plot.rlassoEffects'></span>

<h3>Description</h3>

<p>Objects of class <code>rlassoEffects</code> are constructed by  <code>rlassoEffects</code>.
<code>print.rlassoEffects</code> prints and displays some information about fitted <code>rlassoEffect</code> objects.
summary.rlassoEffects summarizes information of a fitted <code>rlassoEffect</code> object and is described at <code><a href="#topic+summary.rlassoEffects">summary.rlassoEffects</a></code>.
<code>confint.rlassoEffects</code> extracts the confidence intervals.
<code>plot.rlassoEffects</code> plots the estimates with confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoEffects'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoEffects'
confint(object, parm, level = 0.95, joint = FALSE, ...)

## S3 method for class 'rlassoEffects'
plot(
  x,
  joint = FALSE,
  level = 0.95,
  main = "",
  xlab = "coef",
  ylab = "",
  xlim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rlassoEffects_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlassoEffects</code></p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_digits">digits</code></td>
<td>
<p>significant digits in printout</p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods.</p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoEffects</code></p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals among the variables for which inference was done, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_level">level</code></td>
<td>
<p>confidence level required</p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_joint">joint</code></td>
<td>
<p>logical, if <code>TRUE</code> joint confidence intervals are calculated.</p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_main">main</code></td>
<td>
<p>an overall title for the plot</p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis</p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis</p>
</td></tr>
<tr><td><code id="print.rlassoEffects_+3A_xlim">xlim</code></td>
<td>
<p>vector of length two giving lower and upper bound of x axis</p>
</td></tr>
</table>

<hr>
<h2 id='print.rlassoIV'>Methods for S3 object <code>rlassoIV</code></h2><span id='topic+print.rlassoIV'></span><span id='topic+methods.rlassoIV'></span><span id='topic+summary.rlassoIV'></span><span id='topic+confint.rlassoIV'></span>

<h3>Description</h3>

<p>Objects of class <code>rlassoIV</code> are constructed by <code>rlassoIV</code>. 
<code>print.rlassoIV</code> prints and displays some information about fitted <code>rlassoIV</code> objects.
<code>summary.rlassoIV</code> summarizes information of a fitted <code>rlassoIV</code> object.
<code>confint.rlassoIV</code> extracts the confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoIV'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoIV'
summary(object, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoIV'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rlassoIV_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlassoIV</code></p>
</td></tr>
<tr><td><code id="print.rlassoIV_+3A_digits">digits</code></td>
<td>
<p>significant digits in printout</p>
</td></tr>
<tr><td><code id="print.rlassoIV_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods</p>
</td></tr>
<tr><td><code id="print.rlassoIV_+3A_object">object</code></td>
<td>
<p>An object of class <code>rlassoIV</code></p>
</td></tr>
<tr><td><code id="print.rlassoIV_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="print.rlassoIV_+3A_level">level</code></td>
<td>
<p>confidence level required.</p>
</td></tr>
</table>

<hr>
<h2 id='print.rlassoIVselectX'>Methods for S3 object <code>rlassoIVselectX</code></h2><span id='topic+print.rlassoIVselectX'></span><span id='topic+methods.rlassoIVselectX'></span><span id='topic+summary.rlassoIVselectX'></span><span id='topic+confint.rlassoIVselectX'></span>

<h3>Description</h3>

<p>Objects of class <code>rlassoIVselectX</code> are constructed by <code>rlassoIVselectX</code>. 
<code>print.rlassoIVselectX</code> prints and displays some information about fitted <code>rlassoIVselectX</code> objects.
<code>summary.rlassoIVselectX</code> summarizes information of a fitted <code>rlassoIVselectX</code> object.
<code>confint.rlassoIVselectX</code> extracts the confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoIVselectX'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoIVselectX'
summary(object, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoIVselectX'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rlassoIVselectX_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlassoIVselectX</code></p>
</td></tr>
<tr><td><code id="print.rlassoIVselectX_+3A_digits">digits</code></td>
<td>
<p>significant digits in printout</p>
</td></tr>
<tr><td><code id="print.rlassoIVselectX_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods</p>
</td></tr>
<tr><td><code id="print.rlassoIVselectX_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoIVselectX</code></p>
</td></tr>
<tr><td><code id="print.rlassoIVselectX_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="print.rlassoIVselectX_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
</table>

<hr>
<h2 id='print.rlassoIVselectZ'>Methods for S3 object <code>rlassoIVselectZ</code></h2><span id='topic+print.rlassoIVselectZ'></span><span id='topic+methods.rlassoIVselectZ'></span><span id='topic+summary.rlassoIVselectZ'></span><span id='topic+confint.rlassoIVselectZ'></span>

<h3>Description</h3>

<p>Objects of class <code>rlassoIVselectZ</code> are constructed by <code>rlassoIVselectZ</code>. 
<code>print.rlassoIVselectZ</code> prints and displays some information about fitted <code>rlassoIVselectZ</code> objects.
<code>summary.rlassoIVselectZ</code> summarizes information of a fitted <code>rlassoIVselectZ</code> object.
<code>confint.rlassoIVselectZ</code> extracts the confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoIVselectZ'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoIVselectZ'
summary(object, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoIVselectZ'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rlassoIVselectZ_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlassoIVselectZ</code></p>
</td></tr>
<tr><td><code id="print.rlassoIVselectZ_+3A_digits">digits</code></td>
<td>
<p>significant digits in printout</p>
</td></tr>
<tr><td><code id="print.rlassoIVselectZ_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods</p>
</td></tr>
<tr><td><code id="print.rlassoIVselectZ_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoIVselectZ</code></p>
</td></tr>
<tr><td><code id="print.rlassoIVselectZ_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="print.rlassoIVselectZ_+3A_level">level</code></td>
<td>
<p>confidence level required.</p>
</td></tr>
</table>

<hr>
<h2 id='print.rlassologitEffects'>Methods for S3 object <code>rlassologitEffects</code></h2><span id='topic+print.rlassologitEffects'></span><span id='topic+methods.rlassologitEffects'></span><span id='topic+summary.rlassologitEffects'></span><span id='topic+confint.rlassologitEffects'></span>

<h3>Description</h3>

<p>Objects of class <code>rlassologitEffects</code> are construced by <code>rlassologitEffects</code> or <code>rlassologitEffect</code>. 
<code>print.rlassologitEffects</code> prints and displays some information about fitted <code>rlassologitEffect</code> objects.
<code>summary.rlassologitEffects</code> summarizes information of a fitted <code>rlassologitEffects</code> object.
<code>confint.rlassologitEffects</code> extracts the confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassologitEffects'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassologitEffects'
summary(object, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassologitEffects'
confint(object, parm, level = 0.95, joint = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rlassologitEffects_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlassologitEffects</code></p>
</td></tr>
<tr><td><code id="print.rlassologitEffects_+3A_digits">digits</code></td>
<td>
<p>number of significant digits in printout</p>
</td></tr>
<tr><td><code id="print.rlassologitEffects_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods</p>
</td></tr>
<tr><td><code id="print.rlassologitEffects_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassologitEffects</code></p>
</td></tr>
<tr><td><code id="print.rlassologitEffects_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="print.rlassologitEffects_+3A_level">level</code></td>
<td>
<p>confidence level required.</p>
</td></tr>
<tr><td><code id="print.rlassologitEffects_+3A_joint">joint</code></td>
<td>
<p>logical, if joint confidence intervals should be clalculated</p>
</td></tr>
</table>

<hr>
<h2 id='print.rlassoTE'>Methods for S3 object <code>rlassoTE</code></h2><span id='topic+print.rlassoTE'></span><span id='topic+methods.rlassoTE'></span><span id='topic+summary.rlassoTE'></span><span id='topic+confint.rlassoTE'></span>

<h3>Description</h3>

<p>Objects of class <code>rlassoTE</code> are constructed by  <code>rlassoATE</code>,  <code>rlassoATET</code>, <code>rlassoLATE</code>,  <code>rlassoLATET</code>.
<code>print.rlassoTE</code> prints and displays some information about fitted <code>rlassoTE</code> objects.
<code>summary.rlassoTE</code> summarizes information of a fitted <code>rlassoTE</code> object.
<code>confint.rlassoTE</code> extracts the confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoTE'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoTE'
summary(object, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'rlassoTE'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rlassoTE_+3A_x">x</code></td>
<td>
<p>an object of class <code>rlassoTE</code></p>
</td></tr>
<tr><td><code id="print.rlassoTE_+3A_digits">digits</code></td>
<td>
<p>number of significant digits in printout</p>
</td></tr>
<tr><td><code id="print.rlassoTE_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods</p>
</td></tr>
<tr><td><code id="print.rlassoTE_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoTE</code></p>
</td></tr>
<tr><td><code id="print.rlassoTE_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="print.rlassoTE_+3A_level">level</code></td>
<td>
<p>confidence level required.</p>
</td></tr>
</table>

<hr>
<h2 id='print.tsls'>Methods for S3 object <code>tsls</code></h2><span id='topic+print.tsls'></span><span id='topic+methods.tsls'></span><span id='topic+summary.tsls'></span>

<h3>Description</h3>

<p>Objects of class <code>tsls</code> are constructed by <code>tsls</code>. 
<code>print.tsls</code> prints and displays some information about fitted <code>tsls</code> objects.
<code>summary.tsls</code> summarizes information of a fitted <code>tsls</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsls'
print(x, digits = max(3L, getOption("digits") - 3L), ...)

## S3 method for class 'tsls'
summary(object, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.tsls_+3A_x">x</code></td>
<td>
<p>an object of class <code>tsls</code></p>
</td></tr>
<tr><td><code id="print.tsls_+3A_digits">digits</code></td>
<td>
<p>significant digits in printout</p>
</td></tr>
<tr><td><code id="print.tsls_+3A_...">...</code></td>
<td>
<p>arguments passed to the print function and other methods</p>
</td></tr>
<tr><td><code id="print.tsls_+3A_object">object</code></td>
<td>
<p>an object of class <code>tsls</code></p>
</td></tr>
</table>

<hr>
<h2 id='rlasso'>rlasso: Function for Lasso estimation under homoscedastic and heteroscedastic non-Gaussian
disturbances</h2><span id='topic+rlasso'></span><span id='topic+rlasso.formula'></span><span id='topic+rlasso.character'></span><span id='topic+rlasso.default'></span>

<h3>Description</h3>

<p>The function estimates the coefficients of a Lasso regression with
data-driven penalty under homoscedasticity and heteroscedasticity with non-Gaussian noise and X-dependent or X-independent design. The
method of the data-driven penalty can be chosen. The object which is
returned is of the S3 class <code>rlasso</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlasso(x, ...)

## S3 method for class 'formula'
rlasso(
  formula,
  data = NULL,
  post = TRUE,
  intercept = TRUE,
  model = TRUE,
  penalty = list(homoscedastic = FALSE, X.dependent.lambda = FALSE, lambda.start = NULL,
    c = 1.1, gamma = 0.1/log(n)),
  control = list(numIter = 15, tol = 10^-5, threshold = NULL),
  ...
)

## S3 method for class 'character'
rlasso(
  x,
  data = NULL,
  post = TRUE,
  intercept = TRUE,
  model = TRUE,
  penalty = list(homoscedastic = FALSE, X.dependent.lambda = FALSE, lambda.start = NULL,
    c = 1.1, gamma = 0.1/log(n)),
  control = list(numIter = 15, tol = 10^-5, threshold = NULL),
  ...
)

## Default S3 method:
rlasso(
  x,
  y,
  post = TRUE,
  intercept = TRUE,
  model = TRUE,
  penalty = list(homoscedastic = FALSE, X.dependent.lambda = FALSE, lambda.start = NULL,
    c = 1.1, gamma = 0.1/log(n)),
  control = list(numIter = 15, tol = 10^-5, threshold = NULL),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlasso_+3A_x">x</code></td>
<td>
<p>regressors (vector, matrix or object can be coerced to matrix)</p>
</td></tr>
<tr><td><code id="rlasso_+3A_...">...</code></td>
<td>
<p>further arguments (only for consistent defintion of methods)</p>
</td></tr>
<tr><td><code id="rlasso_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; (or one that can be coerced to
that class): a symbolic description of the model to be fitted in the form
<code>y~x</code></p>
</td></tr>
<tr><td><code id="rlasso_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible
by as.data.frame to a data frame) containing the variables in the model. If
not found in data, the variables are taken from environment(formula),
typically the environment from which <code>rlasso</code> is called.</p>
</td></tr>
<tr><td><code id="rlasso_+3A_post">post</code></td>
<td>
<p>logical. If <code>TRUE</code>, post-Lasso estimation is conducted.</p>
</td></tr>
<tr><td><code id="rlasso_+3A_intercept">intercept</code></td>
<td>
<p>logical. If <code>TRUE</code>, intercept is included which is not
penalized.</p>
</td></tr>
<tr><td><code id="rlasso_+3A_model">model</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), model matrix is returned.</p>
</td></tr>
<tr><td><code id="rlasso_+3A_penalty">penalty</code></td>
<td>
<p>list with options for the calculation of the penalty. 
</p>

<ul>
<li> <p><code>c</code> and <code>gamma</code> constants for the penalty with default <code>c=1.1</code> and <code>gamma=0.1</code>
</p>
</li>
<li> <p><code>homoscedastic</code> logical, if homoscedastic errors are considered (default <code>FALSE</code>). Option <code>none</code> is described below.
</p>
</li>
<li> <p><code>X.dependent.lambda</code> logical,  <code>TRUE</code>, if the penalization parameter depends on the the design of the matrix <code>x</code>. <code>FALSE</code>, if independent of the design matrix  (default).
</p>
</li>
<li> <p><code>numSim</code>  number of simulations for the dependent methods, default=5000
</p>
</li>
<li> <p><code>lambda.start</code> initial penalization value, compulsory for method &quot;none&quot;
</p>
</li></ul>
</td></tr>
<tr><td><code id="rlasso_+3A_control">control</code></td>
<td>
<p>list with control values.
<code>numIter</code> number of iterations for the algorithm for
the estimation of the variance and data-driven penalty, ie. loadings,
<code>tol</code> tolerance for improvement of the estimated variances.
<code>threshold</code> is applied to the final estimated lasso
coefficients. Absolute values below the threshold are set to zero.</p>
</td></tr>
<tr><td><code id="rlasso_+3A_y">y</code></td>
<td>
<p>dependent variable (vector, matrix or object can be coerced to matrix)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the coefficients of a Lasso regression with
data-driven penalty under homoscedasticity / heteroscedasticity and non-Gaussian noise. The options <code>homoscedastic</code> is a logical with <code>FALSE</code> by default.
Moreover, for the calculation of the penalty parameter it can be chosen, if the penalization parameter depends on the  design matrix (<code>X.dependent.lambda=TRUE</code>) or <code>independent</code> (default, <code>X.dependent.lambda=FALSE</code>).
The default value of the constant <code>c</code> is <code>1.1</code> in the post-Lasso case and <code>0.5</code> in the Lasso case. 
A <em>special</em> option is to set <code>homoscedastic</code> to <code>none</code> and to supply a values <code>lambda.start</code>. Then this value is used as penalty parameter with independent design and heteroscedastic errors to weight the regressors.
For details of the
implementation of the Algorithm for estimation of the data-driven penalty,
in particular the regressor-independent loadings, we refer to Appendix A in
Belloni et al. (2012). When the option &quot;none&quot; is chosen for <code>homoscedastic</code> (together with
<code>lambda.start</code>), lambda is set to <code>lambda.start</code> and the
regressor-independent loadings und heteroscedasticity are used. The options &quot;X-dependent&quot; and
&quot;X-independent&quot; under homoscedasticity are described in Belloni et al. (2013). 
</p>
<p>The option <code>post=TRUE</code> conducts post-lasso estimation, i.e. a refit of
the model with the selected variables.
</p>


<h3>Value</h3>

<p><code>rlasso</code> returns an object of class <code>rlasso</code>. An object of
class &quot;rlasso&quot; is a list containing at least the following components:
</p>

<ul>
<li><p> coefficients parameter estimates
</p>
</li>
<li><p> beta parameter estimates (named vector of coefficients without intercept)
</p>
</li>
<li><p> intercept value of the intercept
</p>
</li>
<li><p> index index of selected
variables (logical vector)
</p>
</li>
<li><p> lambda data-driven penalty term for each
variable, product of lambda0 (the penalization parameter) and the loadings
</p>
</li>
<li><p> lambda0 penalty term
</p>
</li>
<li><p> loadings loading for each regressor
</p>
</li>
<li><p> residuals residuals, response minus fitted values
</p>
</li>
<li><p> sigma root of the variance of
the residuals
</p>
</li>
<li><p> iter number of iterations
</p>
</li>
<li><p> call function call
</p>
</li>
<li><p> options options
</p>
</li>
<li><p> model model matrix (if <code>model = TRUE</code> in function call)
</p>
</li></ul>



<h3>References</h3>

<p>A. Belloni, D. Chen, V. Chernozhukov and C. Hansen (2012).
Sparse models and methods for optimal instruments with an application to
eminent domain. <em>Econometrica</em> 80 (6), 2369-2429.
</p>
<p>A. Belloni, V. Chernozhukov and C. Hansen (2013). Inference for
high-dimensional sparse econometric models. In Advances in Economics and
Econometrics: 10th World Congress, Vol. 3: Econometrics, Cambirdge
University Press: Cambridge, 245-295.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n = 100 #sample size
p = 100 # number of variables
s = 3 # nubmer of variables with non-zero coefficients
X = Xnames = matrix(rnorm(n*p), ncol=p)
colnames(Xnames) &lt;- paste("V", 1:p, sep="")
beta = c(rep(5,s), rep(0,p-s))
Y = X%*%beta + rnorm(n)
reg.lasso &lt;- rlasso(Y~Xnames)
Xnew = matrix(rnorm(n*p), ncol=p)  # new X
colnames(Xnew) &lt;- paste("V", 1:p, sep="")
Ynew =  Xnew%*%beta + rnorm(n)  #new Y
yhat = predict(reg.lasso, newdata = Xnew)
</code></pre>

<hr>
<h2 id='rlassoATE'>Functions for estimation of treatment effects</h2><span id='topic+rlassoATE'></span><span id='topic+late'></span><span id='topic+latet'></span><span id='topic+ate'></span><span id='topic+atet'></span><span id='topic+LATE'></span><span id='topic+LATET'></span><span id='topic+ATE'></span><span id='topic+ATET'></span><span id='topic+rlassoATE.default'></span><span id='topic+rlassoATE.formula'></span><span id='topic+rlassoATET'></span><span id='topic+rlassoATET.default'></span><span id='topic+rlassoATET.formula'></span><span id='topic+rlassoLATE'></span><span id='topic+rlassoLATE.default'></span><span id='topic+rlassoLATE.formula'></span><span id='topic+rlassoLATET'></span><span id='topic+rlassoLATET.default'></span><span id='topic+rlassoLATET.formula'></span>

<h3>Description</h3>

<p>This class of functions estimates the average treatment effect (ATE), the ATE of the tretated (ATET), the local average treatment effects (LATE) and the LATE of
the tretated (LATET). The estimation methods rely on immunized / orthogonal moment
conditions which guarantee valid post-selection inference in a high-dimensional setting. Further details can be found in Belloni et al. (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlassoATE(x, ...)

## Default S3 method:
rlassoATE(x, d, y, bootstrap = "none", nRep = 500, ...)

## S3 method for class 'formula'
rlassoATE(formula, data, bootstrap = "none", nRep = 500, ...)

rlassoATET(x, ...)

## Default S3 method:
rlassoATET(x, d, y, bootstrap = "none", nRep = 500, ...)

## S3 method for class 'formula'
rlassoATET(formula, data, bootstrap = "none", nRep = 500, ...)

rlassoLATE(x, ...)

## Default S3 method:
rlassoLATE(
  x,
  d,
  y,
  z,
  bootstrap = "none",
  nRep = 500,
  post = TRUE,
  intercept = TRUE,
  always_takers = TRUE,
  never_takers = TRUE,
  ...
)

## S3 method for class 'formula'
rlassoLATE(
  formula,
  data,
  bootstrap = "none",
  nRep = 500,
  post = TRUE,
  intercept = TRUE,
  always_takers = TRUE,
  never_takers = TRUE,
  ...
)

rlassoLATET(x, ...)

## Default S3 method:
rlassoLATET(
  x,
  d,
  y,
  z,
  bootstrap = "none",
  nRep = 500,
  post = TRUE,
  intercept = TRUE,
  always_takers = TRUE,
  ...
)

## S3 method for class 'formula'
rlassoLATET(
  formula,
  data,
  bootstrap = "none",
  nRep = 500,
  post = TRUE,
  intercept = TRUE,
  always_takers = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlassoATE_+3A_x">x</code></td>
<td>
<p>exogenous variables</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_...">...</code></td>
<td>
<p>arguments passed, e.g. <code>intercept</code> and <code>post</code></p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_d">d</code></td>
<td>
<p>treatment variable (binary)</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_y">y</code></td>
<td>
<p>outcome variable / dependent variable</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_bootstrap">bootstrap</code></td>
<td>
<p>boostrap method which should be employed: 'none', 'Bayes',
'normal', 'wild'</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_nrep">nRep</code></td>
<td>
<p>number of replications for the bootstrap</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>Formula</code> of the form &quot; y ~ x + d | x&quot; with y the outcome variable,
d treatment variable, and x exogenous variables.</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_data">data</code></td>
<td>
<p>An optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which <code>rlassoATE</code> is called.</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_z">z</code></td>
<td>
<p>instrumental variables (binary)</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_post">post</code></td>
<td>
<p>logical. If <code>TRUE</code>, post-lasso estimation is conducted.</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_intercept">intercept</code></td>
<td>
<p>logical. If <code>TRUE</code>, intercept is included which is not</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_always_takers">always_takers</code></td>
<td>
<p>option to adapt to cases with (default) and without always-takers. If <code>FALSE</code>, the estimator is adapted to a setting without always-takers.</p>
</td></tr>
<tr><td><code id="rlassoATE_+3A_never_takers">never_takers</code></td>
<td>
<p>option to adapt to cases with (default) and without never-takers. If <code>FALSE</code>, the estimator is adapted to a setting without never-takers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details can be found in Belloni et al. (2014).
</p>


<h3>Value</h3>

<p>Functions return an object of class <code>rlassoTE</code> with estimated effects, standard errors and
individual effects in the form of a <code>list</code>.
</p>


<h3>References</h3>

<p>A. Belloni, V. Chernozhukov, I. Fernandez-Val, and C. Hansen
(2014). Program evaluation with high-dimensional data. Working Paper.
</p>

<hr>
<h2 id='rlassoEffects'>rigorous Lasso for Linear Models: Inference</h2><span id='topic+rlassoEffects'></span><span id='topic+rlassoEffects.default'></span><span id='topic+rlassoEffects.formula'></span><span id='topic+rlassoEffect'></span>

<h3>Description</h3>

<p>Estimation and inference of (low-dimensional) target coefficients in a high-dimensional linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlassoEffects(x, ...)

## Default S3 method:
rlassoEffects(
  x,
  y,
  index = c(1:ncol(x)),
  method = "partialling out",
  I3 = NULL,
  post = TRUE,
  ...
)

## S3 method for class 'formula'
rlassoEffects(
  formula,
  data,
  I,
  method = "partialling out",
  included = NULL,
  post = TRUE,
  ...
)

rlassoEffect(x, y, d, method = "double selection", I3 = NULL, post = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlassoEffects_+3A_x">x</code></td>
<td>
<p>matrix of regressor variables serving as controls and potential
treatments. For <code>rlassoEffect</code> it contains only controls, for <code>rlassoEffects</code> both controls and potential treatments. For <code>rlassoEffects</code> it must have at least two columns.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_...">...</code></td>
<td>
<p>parameters passed to the <code>rlasso</code> function.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_y">y</code></td>
<td>
<p>outcome variable (vector or matrix)</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_index">index</code></td>
<td>
<p>vector of integers, logicals or variables names indicating the position (column) of
variables (integer case), logical vector of length of the variables (TRUE or FALSE) or the variable names of <code>x</code> which should be used for inference / as treatment variables.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_method">method</code></td>
<td>
<p>method for inference, either 'partialling out' (default) or 'double selection'.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_i3">I3</code></td>
<td>
<p>For the 'double selection'-method the logical vector <code>I3</code> has same length as the number of variables in <code>x</code>;
indicates if variables (TRUE) should be included in any case to the model and they are exempt from selection. These variables should not be included in the <code>index</code>; hence the intersection with <code>index</code> must be the empty set.
In the case of partialling out it is ignored.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_post">post</code></td>
<td>
<p>logical, if post Lasso is conducted with default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_formula">formula</code></td>
<td>
<p>An element of class <code>formula</code> specifying the linear model.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which the function is called.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_i">I</code></td>
<td>
<p>An one-sided formula specifying the variables for which inference is conducted.</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_included">included</code></td>
<td>
<p>One-sided formula of variables which should be included in any case (only for method=&quot;double selection&quot;).</p>
</td></tr>
<tr><td><code id="rlassoEffects_+3A_d">d</code></td>
<td>
<p>variable for which inference is conducted (treatment variable)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions estimates (low-dimensional) target coefficients in a high-dimensional linear model.
An application is e.g. estimation of a treatment effect <code class="reqn">\alpha_0</code> in a
setting of high-dimensional controls. The user can choose between the so-called post-double-selection method and partialling-out.
The idea of the double selection method is to select variables by Lasso regression of
the outcome variable on the control variables and the treatment variable on
the control variables. The final estimation is done by a regression of the
outcome on the treatment effect and the union of the selected variables in
the first two steps. In partialling-out first the effect of the regressors on the outcome and the treatment variable is taken out by Lasso and then a regression of the residuals is conducted. The resulting estimator for <code class="reqn">\alpha_0</code> is normal
distributed which allows inference on the treatment effect. It presents a wrap function for <code>rlassoEffect</code> 
which does inference for a single variable.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>rlassoEffects</code> with the following entries: </p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>vector with estimated
values of the coefficients for each selected variable</p>
</td></tr> <tr><td><code>se</code></td>
<td>
<p>standard error (vector)</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>t-statistic</p>
</td></tr> <tr><td><code>pval</code></td>
<td>
<p>p-value</p>
</td></tr> <tr><td><code>samplesize</code></td>
<td>
<p>sample size of the data set</p>
</td></tr> <tr><td><code>index</code></td>
<td>
<p>index of the variables for which inference is performed</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. Belloni, V. Chernozhukov, C. Hansen (2014). Inference on
treatment effects after selection among high-dimensional controls. The
Review of Economic Studies 81(2), 608-650.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(hdm); library(ggplot2)
set.seed(1)
n = 100 #sample size
p = 100 # number of variables
s = 3 # number of non-zero variables
X = matrix(rnorm(n*p), ncol=p)
colnames(X) &lt;- paste("X", 1:p, sep="")
beta = c(rep(3,s), rep(0,p-s))
y = 1 + X%*%beta + rnorm(n)
data = data.frame(cbind(y,X))
colnames(data)[1] &lt;- "y"
fm = paste("y ~", paste(colnames(X), collapse="+"))
fm = as.formula(fm)                 
lasso.effect = rlassoEffects(X, y, index=c(1,2,3,50))
lasso.effect = rlassoEffects(fm, I = ~ X1 + X2 + X3 + X50, data=data)
print(lasso.effect)
summary(lasso.effect)
confint(lasso.effect)
plot(lasso.effect)
</code></pre>

<hr>
<h2 id='rlassoIV'>Post-Selection and Post-Regularization Inference in Linear Models with Many
Controls and Instruments</h2><span id='topic+rlassoIV'></span><span id='topic+rlassoIVmult'></span><span id='topic+rlassoIV.default'></span><span id='topic+rlassoIV.formula'></span>

<h3>Description</h3>

<p>The function estimates a treatment effect in a setting with very many
controls and very many instruments (even larger than the sample size).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlassoIV(x, ...)

## Default S3 method:
rlassoIV(x, d, y, z, select.Z = TRUE, select.X = TRUE, post = TRUE, ...)

## S3 method for class 'formula'
rlassoIV(formula, data, select.Z = TRUE, select.X = TRUE, post = TRUE, ...)

rlassoIVmult(x, d, y, z, select.Z = TRUE, select.X = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlassoIV_+3A_x">x</code></td>
<td>
<p>matrix of exogenous variables</p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_...">...</code></td>
<td>
<p>arguments passed to the function <code>rlasso</code></p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_d">d</code></td>
<td>
<p>endogenous variable</p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_y">y</code></td>
<td>
<p>outcome / dependent variable (vector or matrix)</p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_z">z</code></td>
<td>
<p>matrix of instrumental variables</p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_select.z">select.Z</code></td>
<td>
<p>logical, indicating selection on the instruments.</p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_select.x">select.X</code></td>
<td>
<p>logical, indicating selection on the exogenous variables.</p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_post">post</code></td>
<td>
<p>logical, wheter post-Lasso should be conducted (default=<code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>Formula</code> of the form &quot; y ~ x + d | x + z&quot; with y the outcome variable,
d endogenous variable, z instrumental variables, and x exogenous variables.</p>
</td></tr>
<tr><td><code id="rlassoIV_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which <code>rlassoIV</code> is called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implementation for selection on x and z follows the procedure described in Chernozhukov et al.
(2015) and is built on 'triple selection' to achieve an orthogonal moment
function. The function returns an object of S3 class <code>rlassoIV</code>.
Moreover, it is wrap function for the case that selection should be done only with the instruments Z (<code>rlassoIVselectZ</code>) or with 
the control variables X (<code>rlassoIVselectX</code>) or without selection (<code>tsls</code>). Exogenous variables 
<code>x</code> are automatically used as instruments and added to the
instrument set <code>z</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>rlassoIV</code> containing at least the following
components: </p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>estimated parameter value</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>variance-covariance matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>V. Chernozhukov, C. Hansen, M. Spindler (2015). Post-selection
and post-regularization inference in linear models with many controls and
instruments. American Economic Review: Paper &amp; Proceedings 105(5), 486&ndash;490.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(EminentDomain)
z &lt;- EminentDomain$logGDP$z # instruments
x &lt;- EminentDomain$logGDP$x # exogenous variables
y &lt;- EminentDomain$logGDP$y # outcome varialbe
d &lt;- EminentDomain$logGDP$d # treatment / endogenous variable
lasso.IV.Z = rlassoIV(x=x, d=d, y=y, z=z, select.X=FALSE, select.Z=TRUE) 
summary(lasso.IV.Z)
confint(lasso.IV.Z)

## End(Not run)
</code></pre>

<hr>
<h2 id='rlassoIVselectX'>Instrumental Variable Estimation with Selection on the exogenous Variables by Lasso</h2><span id='topic+rlassoIVselectX'></span><span id='topic+rlassoIVselectX.default'></span><span id='topic+rlassoIVselectX.formula'></span>

<h3>Description</h3>

<p>This function estimates the coefficient of an endogenous variable by employing Instrument Variables in a setting where the exogenous variables are high-dimensional and hence
selection on the exogenous variables is required.
The function returns an element of class <code>rlassoIVselectX</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlassoIVselectX(x, ...)

## Default S3 method:
rlassoIVselectX(x, d, y, z, post = TRUE, ...)

## S3 method for class 'formula'
rlassoIVselectX(formula, data, post = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlassoIVselectX_+3A_x">x</code></td>
<td>
<p>exogenous variables in the structural equation (matrix)</p>
</td></tr>
<tr><td><code id="rlassoIVselectX_+3A_...">...</code></td>
<td>
<p>arguments passed to the function <code>rlasso</code></p>
</td></tr>
<tr><td><code id="rlassoIVselectX_+3A_d">d</code></td>
<td>
<p>endogenous variables in the structural equation (vector or matrix)</p>
</td></tr>
<tr><td><code id="rlassoIVselectX_+3A_y">y</code></td>
<td>
<p>outcome or dependent variable in the structural equation (vector or matrix)</p>
</td></tr>
<tr><td><code id="rlassoIVselectX_+3A_z">z</code></td>
<td>
<p>set of potential instruments for the endogenous variables.</p>
</td></tr>
<tr><td><code id="rlassoIVselectX_+3A_post">post</code></td>
<td>
<p>logical. If <code>TRUE</code>, post-lasso estimation is conducted.</p>
</td></tr>
<tr><td><code id="rlassoIVselectX_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>Formula</code> of the form &quot; y ~ x + d | x + z&quot; with y the outcome variable,
d endogenous variable, z instrumental variables, and x exogenous variables.</p>
</td></tr>
<tr><td><code id="rlassoIVselectX_+3A_data">data</code></td>
<td>
<p>An optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which <code>rlassoIVselectX</code> is called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implementation is a special case of of Chernozhukov et al. (2015).
The option <code>post=TRUE</code> conducts post-lasso estimation for the Lasso estimations, i.e. a refit of the
model with the selected variables. Exogenous variables 
<code>x</code> are automatically used as instruments and added to the
instrument set <code>z</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>rlassoIVselectX</code> containing at least the following
components: </p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>estimated parameter vector</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance-covariance matrix</p>
</td></tr> <tr><td><code>residuals</code></td>
<td>

<p>residuals</p>
</td></tr> <tr><td><code>samplesize</code></td>
<td>
<p>sample size</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chernozhukov, V., Hansen, C. and M. Spindler (2015). Post-Selection and Post-Regularization Inference in Linear
Models with Many Controls and Instruments
<em>American Economic Review, Papers and Proceedings</em> 105(5), 486&ndash;490.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(hdm)
data(AJR); y = AJR$GDP; d = AJR$Exprop; z = AJR$logMort
x = model.matrix(~ -1 + (Latitude + Latitude2 + Africa + 
                           Asia + Namer + Samer)^2, data=AJR)
dim(x)
  #AJR.Xselect = rlassoIV(x=x, d=d, y=y, z=z, select.X=TRUE, select.Z=FALSE)
  AJR.Xselect = rlassoIV(GDP ~ Exprop +  (Latitude + Latitude2 + Africa + Asia + Namer + Samer)^2 |
             logMort +  (Latitude + Latitude2 + Africa + Asia + Namer + Samer)^2,
             data=AJR, select.X=TRUE, select.Z=FALSE)
summary(AJR.Xselect)
confint(AJR.Xselect)
</code></pre>

<hr>
<h2 id='rlassoIVselectZ'>Instrumental Variable Estimation with Lasso</h2><span id='topic+rlassoIVselectZ'></span><span id='topic+rlassoIVselectZ.default'></span><span id='topic+rlassoIVselectZ.formula'></span>

<h3>Description</h3>

<p>This function selects the instrumental variables in the first stage by
Lasso. First stage predictions are then used in the second stage as optimal
instruments to estimate the parameter vector. The function returns an element of class <code>rlassoIVselectZ</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlassoIVselectZ(x, ...)

## Default S3 method:
rlassoIVselectZ(x, d, y, z, post = TRUE, intercept = TRUE, ...)

## S3 method for class 'formula'
rlassoIVselectZ(formula, data, post = TRUE, intercept = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlassoIVselectZ_+3A_x">x</code></td>
<td>
<p>exogenous variables in the structural equation (matrix)</p>
</td></tr>
<tr><td><code id="rlassoIVselectZ_+3A_...">...</code></td>
<td>
<p>arguments passed to the function <code>rlasso</code>.</p>
</td></tr>
<tr><td><code id="rlassoIVselectZ_+3A_d">d</code></td>
<td>
<p>endogenous variables in the structural equation (vector or matrix)</p>
</td></tr>
<tr><td><code id="rlassoIVselectZ_+3A_y">y</code></td>
<td>
<p>outcome or dependent variable in the structural equation (vector or matrix)</p>
</td></tr>
<tr><td><code id="rlassoIVselectZ_+3A_z">z</code></td>
<td>
<p>set of potential instruments for the endogenous variables.
Exogenous variables serve as their own instruments.</p>
</td></tr>
<tr><td><code id="rlassoIVselectZ_+3A_post">post</code></td>
<td>
<p>logical. If <code>TRUE</code>, post-lasso estimation is conducted.</p>
</td></tr>
<tr><td><code id="rlassoIVselectZ_+3A_intercept">intercept</code></td>
<td>
<p>logical. If <code>TRUE</code>, intercept is included in the second stage equation.</p>
</td></tr>
<tr><td><code id="rlassoIVselectZ_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>Formula</code> of the form &quot; y ~ x + d | x + z&quot; with y the outcome variable,
d endogenous variable, z instrumental variables, and x exogenous variables.</p>
</td></tr>
<tr><td><code id="rlassoIVselectZ_+3A_data">data</code></td>
<td>
<p>An optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which <code>rlassoIVselectZ</code> is called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implementation follows the procedure described in Belloni et al. (2012).
Option <code>post=TRUE</code> conducts post-lasso estimation, i.e. a refit of the
model with the selected variables, to estimate the optimal instruments. The
parameter vector of the structural equation is then fitted by two-stage
least square (tsls) estimation.
</p>


<h3>Value</h3>

<p>An object of class <code>rlassoIVselectZ</code> containing at least the following
components: </p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>estimated parameter vector</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance-covariance matrix</p>
</td></tr> <tr><td><code>residuals</code></td>
<td>

<p>residuals</p>
</td></tr> <tr><td><code>samplesize</code></td>
<td>
<p>sample size</p>
</td></tr> <tr><td><code>selection.matrix</code></td>
<td>
<p>matrix of selected variables in the first stage for each endogenous variable</p>
</td></tr>
</table>


<h3>References</h3>

<p>D. Belloni, D. Chen, V. Chernozhukov and C. Hansen (2012).
Sparse models and methods for optimal instruments with an application to
eminent domain. <em>Econometrica</em> 80 (6), 2369&ndash;2429.
</p>

<hr>
<h2 id='rlassologit'>rlassologit: Function for logistic Lasso estimation</h2><span id='topic+rlassologit'></span><span id='topic+rlassologit.formula'></span><span id='topic+rlassologit.character'></span><span id='topic+rlassologit.default'></span>

<h3>Description</h3>

<p>The function estimates the coefficients of a logistic Lasso regression with
data-driven penalty. The method of the data-driven penalty can be chosen.
The object which is returned is of the S3 class <code>rlassologit</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlassologit(x, ...)

## S3 method for class 'formula'
rlassologit(
  formula,
  data = NULL,
  post = TRUE,
  intercept = TRUE,
  model = TRUE,
  penalty = list(lambda = NULL, c = 1.1, gamma = 0.1/log(n)),
  control = list(threshold = NULL),
  ...
)

## S3 method for class 'character'
rlassologit(
  x,
  data = NULL,
  post = TRUE,
  intercept = TRUE,
  model = TRUE,
  penalty = list(lambda = NULL, c = 1.1, gamma = 0.1/log(n)),
  control = list(threshold = NULL),
  ...
)

## Default S3 method:
rlassologit(
  x,
  y,
  post = TRUE,
  intercept = TRUE,
  model = TRUE,
  penalty = list(lambda = NULL, c = 1.1, gamma = 0.1/log(n)),
  control = list(threshold = NULL),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlassologit_+3A_x">x</code></td>
<td>
<p>regressors (matrix)</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_...">...</code></td>
<td>
<p>further parameters passed to glmnet</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_formula">formula</code></td>
<td>
<p>an object of class 'formula' (or one that can be coerced to
that class): a symbolic description of the model to be fitted in the form
<code>y~x</code>.</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment.</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_post">post</code></td>
<td>
<p>logical. If <code>TRUE</code>, post-lasso estimation is conducted.</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_intercept">intercept</code></td>
<td>
<p>logical. If <code>TRUE</code>, intercept is included which is not
penalized.</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_model">model</code></td>
<td>
<p>logical. If <code>TRUE</code> (default), model matrix is returned.</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_penalty">penalty</code></td>
<td>
<p>list with options for the calculation of the penalty.  <code>c</code> and <code>gamma</code> constants for the penalty.</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_control">control</code></td>
<td>
<p>list with control values.
<code>threshold</code> is applied to the final estimated lasso
coefficients. Absolute values below the threshold are set to zero.</p>
</td></tr>
<tr><td><code id="rlassologit_+3A_y">y</code></td>
<td>
<p>dependent variable (vector or matrix)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the coefficients of a Logistic Lasso regression with
data-driven penalty. The
option <code>post=TRUE</code> conducts post-lasso estimation, i.e. a refit of the
model with the selected variables.
</p>


<h3>Value</h3>

<p><code>rlassologit</code> returns an object of class
<code>rlassologit</code>. An object of class <code>rlassologit</code> is a list
containing at least the following components: </p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>parameter
estimates</p>
</td></tr> <tr><td><code>beta</code></td>
<td>
<p>parameter
estimates (without intercept)</p>
</td></tr> <tr><td><code>intercept</code></td>
<td>
<p>value of intercept</p>
</td></tr> <tr><td><code>index</code></td>
<td>
<p>index of selected variables (logicals)</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>penalty term</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>residuals</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>root of the variance of the residuals</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
<tr><td><code>options</code></td>
<td>
<p>options</p>
</td></tr>
</table>


<h3>References</h3>

<p>Belloni, A., Chernozhukov and Y. Wei (2013). Honest confidence regions for logistic regression with a large number of controls. arXiv preprint arXiv:1304.3969.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(hdm)
## DGP
set.seed(2)
n &lt;- 250
p &lt;- 100
px &lt;- 10
X &lt;- matrix(rnorm(n*p), ncol=p)
beta &lt;- c(rep(2,px), rep(0,p-px))
intercept &lt;- 1
P &lt;- exp(intercept + X %*% beta)/(1+exp(intercept + X %*% beta))
y &lt;- rbinom(length(y), size=1, prob=P)
## fit rlassologit object
rlassologit.reg &lt;- rlassologit(y~X)
## methods
summary(rlassologit.reg, all=F)
print(rlassologit.reg)
predict(rlassologit.reg, type='response')
X3 &lt;- matrix(rnorm(n*p), ncol=p)
predict(rlassologit.reg, newdata=X3)

## End(Not run)
</code></pre>

<hr>
<h2 id='rlassologitEffects'>rigorous Lasso for Logistic Models: Inference</h2><span id='topic+rlassologitEffects'></span><span id='topic+rlassologitEffects.default'></span><span id='topic+rlassologitEffects.formula'></span><span id='topic+rlassologitEffect'></span>

<h3>Description</h3>

<p>The function estimates (low-dimensional) target coefficients in a high-dimensional logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlassologitEffects(x, ...)

## Default S3 method:
rlassologitEffects(x, y, index = c(1:ncol(x)), I3 = NULL, post = TRUE, ...)

## S3 method for class 'formula'
rlassologitEffects(formula, data, I, included = NULL, post = TRUE, ...)

rlassologitEffect(x, y, d, I3 = NULL, post = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlassologitEffects_+3A_x">x</code></td>
<td>
<p>matrix of regressor variables serving as controls and potential
treatments.  For <code>rlassologitEffect</code> it contains only controls, for <code>rlassologitEffects</code> both controls and potential treatments. For  <code>rlassologitEffects</code> it must have at least two columns.</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_y">y</code></td>
<td>
<p>outcome variable</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_index">index</code></td>
<td>
<p>vector of integers, logical or names indicating the position (column) or name of
variables of x which should be used as treatment variables.</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_i3">I3</code></td>
<td>
<p>logical vector with same length as the number of controls;
indicates if variables (TRUE) should be included in any case.</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_post">post</code></td>
<td>
<p>logical. If <code>TRUE</code>, post-Lasso estimation is conducted.</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_formula">formula</code></td>
<td>
<p>An element of class <code>formula</code> specifying the linear model.</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which the function is called.</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_i">I</code></td>
<td>
<p>An one-sided formula specifying the variables for which inference is conducted.</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_included">included</code></td>
<td>
<p>One-sided formula of variables which should be included in any case.</p>
</td></tr>
<tr><td><code id="rlassologitEffects_+3A_d">d</code></td>
<td>
<p>variable for which inference is conducted (treatment variable)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions estimates (low-dimensional) target coefficients in a high-dimensional logistic model.
An application is e.g. estimation of a treatment effect <code class="reqn">\alpha_0</code> in a
setting of high-dimensional controls. The function is a wrap function for <code>rlassologitEffect</code> which does inference for only one variable (d).
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>rlassologitEffects</code> with the following entries: </p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>estimated
value of the coefficients</p>
</td></tr> <tr><td><code>se</code></td>
<td>
<p>standard errors</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>t-statistics</p>
</td></tr> <tr><td><code>pval</code></td>
<td>
<p>p-values</p>
</td></tr> <tr><td><code>samplesize</code></td>
<td>
<p>sample size of the data set</p>
</td></tr> <tr><td><code>I</code></td>
<td>
<p>index of variables of the union of the lasso regressions</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. Belloni, V. Chernozhukov, Y. Wei (2013). Honest confidence regions for a regression parameter in logistic regression with a loarge number of controls.
cemmap working paper CWP67/13.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(hdm)
## DGP
set.seed(2)
n &lt;- 250
p &lt;- 100
px &lt;- 10
X &lt;- matrix(rnorm(n*p), ncol=p)
colnames(X) = paste("V", 1:p, sep="")
beta &lt;- c(rep(2,px), rep(0,p-px))
intercept &lt;- 1
P &lt;- exp(intercept + X %*% beta)/(1+exp(intercept + X %*% beta))
y &lt;- rbinom(n, size=1, prob=P)
xd &lt;- X[,2:50]
d &lt;- X[,1]
logit.effect &lt;- rlassologitEffect(x=xd, d=d, y=y)
logit.effects &lt;- rlassologitEffects(X,y, index=c(1,2,40))
logit.effects.f &lt;- rlassologitEffects(y ~ X, I = ~ V1 + V2)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.rlassoEffects'>Summarizing rlassoEffects fits</h2><span id='topic+summary.rlassoEffects'></span><span id='topic+print.summary.rlassoEffects'></span>

<h3>Description</h3>

<p>Summary method for class <code>rlassoEffects</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlassoEffects'
summary(object, ...)

## S3 method for class 'summary.rlassoEffects'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.rlassoEffects_+3A_object">object</code></td>
<td>
<p>an object of class <code>rlassoEffects</code>, usually a result of a call to <code>rlassoEffects</code></p>
</td></tr>
<tr><td><code id="summary.rlassoEffects_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.rlassoEffects_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.rlassoEffects</code>, usually a result of a call or <code>summary.rlassoEffects</code></p>
</td></tr>
<tr><td><code id="summary.rlassoEffects_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Summary of objects of class <code>rlassoEffects</code>
</p>

<hr>
<h2 id='tsls'>Two-Stage Least Squares Estimation (TSLS)</h2><span id='topic+tsls'></span><span id='topic+tsls.default'></span><span id='topic+tsls.formula'></span>

<h3>Description</h3>

<p>The function does Two-Stage Least Squares Estimation (TSLS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsls(x, ...)

## Default S3 method:
tsls(x, d, y, z, intercept = TRUE, homoscedastic = TRUE, ...)

## S3 method for class 'formula'
tsls(formula, data, intercept = TRUE, homoscedastic = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsls_+3A_x">x</code></td>
<td>
<p>exogenous variables</p>
</td></tr>
<tr><td><code id="tsls_+3A_...">...</code></td>
<td>
<p>further arguments (only for consistent defintion of methods)</p>
</td></tr>
<tr><td><code id="tsls_+3A_d">d</code></td>
<td>
<p>endogenous variables</p>
</td></tr>
<tr><td><code id="tsls_+3A_y">y</code></td>
<td>
<p>outcome variable</p>
</td></tr>
<tr><td><code id="tsls_+3A_z">z</code></td>
<td>
<p>instruments</p>
</td></tr>
<tr><td><code id="tsls_+3A_intercept">intercept</code></td>
<td>
<p>logical, if intercept should be included</p>
</td></tr>
<tr><td><code id="tsls_+3A_homoscedastic">homoscedastic</code></td>
<td>
<p>logical, if homoscedastic (<code>TRUE</code>, default) or heteroscedastic erros (<code>FALSE</code>) should be calculated.</p>
</td></tr>
<tr><td><code id="tsls_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>Formula</code> of the form &quot; y ~ x + d | x + z&quot; with y the outcome variable,
d endogenous variable, z instrumental variables, and x exogenous variables.</p>
</td></tr>
<tr><td><code id="tsls_+3A_data">data</code></td>
<td>
<p>An optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which <code>tsls</code> is called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes tsls estimate (coefficients) and variance-covariance-matrix assuming homoskedasticity
for outcome variable <code>y</code> where <code>d</code> are endogenous variables in structural equation, <code>x</code> are exogensous variables in
structural equation and z are instruments. It returns an object of class <code>tsls</code> for which the methods <code>print</code> and <code>summary</code> 
are provided.
</p>


<h3>Value</h3>

<p>The function returns a list with the following elements </p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>coefficients</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance-covariance matrix</p>
</td></tr> <tr><td><code>residuals</code></td>
<td>
<p>outcome minus predicted values</p>
</td></tr> <tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr> <tr><td><code>samplesize</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>standard error</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
