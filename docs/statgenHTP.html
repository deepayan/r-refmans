<!DOCTYPE html><html lang="en"><head><title>Help for package statgenHTP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {statgenHTP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#statgenHTP-package'><p>statgenHTP: High Throughput Phenotyping (HTP) Data Analysis</p></a></li>
<li><a href='#as.data.frame.TP'><p>Coerce TP object to data.frame</p></a></li>
<li><a href='#countValid'><p>Count valid observations per time point for a given trait</p></a></li>
<li><a href='#countValidPlot'><p>Count valid observations per plotId for a given trait</p></a></li>
<li><a href='#createTimePoints'><p>Create an object of class TP</p></a></li>
<li><a href='#detectSerieOut'><p>Detect outliers for series of observations</p></a></li>
<li><a href='#detectSingleOut'><p>Detect outliers for single observations</p></a></li>
<li><a href='#detectSingleOutMaize'><p>detectSingleOutMaize</p></a></li>
<li><a href='#estimateSplineParameters'><p>Extract estimates from fitted splines.</p></a></li>
<li><a href='#fitModels'><p>Fit spatial models per time point</p></a></li>
<li><a href='#fitSpline'><p>Fit Splines</p></a></li>
<li><a href='#fitSplineHDM'><p>Fit P-Spline Hierarchical Curve Data Models</p></a></li>
<li><a href='#getCorrected'><p>Extract corrected phenotypic values</p></a></li>
<li><a href='#getEffDims'><p>Extract effective dimensions</p></a></li>
<li><a href='#getGenoPred'><p>Extract predicted genotypic values</p></a></li>
<li><a href='#getHerit'><p>Extract heritabilities</p></a></li>
<li><a href='#getTimePoints'><p>Extract time points</p></a></li>
<li><a href='#getVar'><p>Extract variances</p></a></li>
<li><a href='#noCorrectedRoot'><p>Root data corrected for outliers for single observations.</p></a></li>
<li><a href='#PhenoarchDat1'><p>Greenhouse data for a maize experiment in the PhenoArch platform.</p></a></li>
<li><a href='#PhenovatorDat1'><p>Growth chamber data for an Arabidopsis experiment in the Phenovator platform.</p></a></li>
<li><a href='#plot.fitMod'><p>Plot function for class fitMod</p></a></li>
<li><a href='#plot.HTPSpline'><p>Plot the results of a fitted spline.</p></a></li>
<li><a href='#plot.psHDM'><p>Plot function for class psHDM</p></a></li>
<li><a href='#plot.serieOut'><p>Plot outliers for series of observations</p></a></li>
<li><a href='#plot.singleOut'><p>Plot outliers for single observations</p></a></li>
<li><a href='#plot.splineEst'><p>Plot the results of estimated spline parameters.</p></a></li>
<li><a href='#plot.TP'><p>Plot function for class TP</p></a></li>
<li><a href='#predict.psHDM'><p>Predict the P-Splines Hierarchical Curve Data Model</p></a></li>
<li><a href='#removeSerieOut'><p>Replace outliers for series of observations by NA</p></a></li>
<li><a href='#removeSingleOut'><p>Replace outliers for single observations by NA</p></a></li>
<li><a href='#removeTimePoints'><p>Remove time points from an object of class TP</p></a></li>
<li><a href='#RootDat1'><p>Greenhouse data for an experiment in the RootPhAir platform.</p></a></li>
<li><a href='#spatCorrectedArch'><p>Maize data corrected for spatial trends.</p></a></li>
<li><a href='#spatCorrectedVator'><p>Arabidopsis data corrected for spatial trends.</p></a></li>
<li><a href='#spatPredArch'><p>Maize data, genotypic predictions.</p></a></li>
<li><a href='#summary.fitMod'><p>Summary function for fitMod objects</p></a></li>
<li><a href='#summary.TP'><p>Summary function for TP objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>High Throughput Phenotyping (HTP) Data Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-11</td>
</tr>
<tr>
<td>Description:</td>
<td>Phenotypic analysis of data coming from high throughput 
    phenotyping (HTP) platforms, including different types of outlier detection,
    spatial analysis, and parameter estimation. The package is being developed
    within the EPPN2020 project (<a href="https://eppn2020.plant-phenotyping.eu/">https://eppn2020.plant-phenotyping.eu/</a>).
    Some functions have been created to be used in conjunction with the R 
    package 'asreml' for the 'ASReml' software, which can be obtained upon 
    purchase from 'VSN' international (<a href="https://vsni.co.uk/software/asreml-r/">https://vsni.co.uk/software/asreml-r/</a>).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>animation, factoextra, ggforce, ggplot2 (&ge; 3.3.0),
ggnewscale, grid, gridExtra, Matrix, methods, LMMsolver,
locfit, lubridate, rlang, reshape2, scales, spam, SpATS (&ge;
1.0-13)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>asreml (&ge; 4.0), knitr, rmarkdown, tinytest (&ge; 1.2.4)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://biometris.github.io/statgenHTP/index.html">https://biometris.github.io/statgenHTP/index.html</a>,
<a href="https://github.com/Biometris/statgenHTP/">https://github.com/Biometris/statgenHTP/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Biometris/statgenHTP/issues">https://github.com/Biometris/statgenHTP/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-14 10:12:11 UTC; rossu027</td>
</tr>
<tr>
<td>Author:</td>
<td>Emilie J Millet <a href="https://orcid.org/0000-0002-2913-4892"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Maria Xose Rodriguez Alvarez
    <a href="https://orcid.org/0000-0002-1329-9238"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Diana Marcela Perez Valencia
    <a href="https://orcid.org/0000-0002-9053-2929"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Isabelle Sanchez [aut],
  Nadine Hilgert [aut],
  Bart-Jan van Rossum
    <a href="https://orcid.org/0000-0002-8673-2514"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Fred van Eeuwijk <a href="https://orcid.org/0000-0003-3672-2921"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Martin Boer [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bart-Jan van Rossum &lt;bart-jan.vanrossum@wur.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-14 11:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='statgenHTP-package'>statgenHTP: High Throughput Phenotyping (HTP) Data Analysis</h2><span id='topic+statgenHTP'></span><span id='topic+statgenHTP-package'></span>

<h3>Description</h3>

<p>Phenotypic analysis of data coming from high throughput phenotyping (HTP) platforms, including different types of outlier detection, spatial analysis, and parameter estimation. The package is being developed within the EPPN2020 project (<a href="https://eppn2020.plant-phenotyping.eu/">https://eppn2020.plant-phenotyping.eu/</a>). Some functions have been created to be used in conjunction with the R package 'asreml' for the 'ASReml' software, which can be obtained upon purchase from 'VSN' international (<a href="https://vsni.co.uk/software/asreml-r/">https://vsni.co.uk/software/asreml-r/</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Bart-Jan van Rossum <a href="mailto:bart-jan.vanrossum@wur.nl">bart-jan.vanrossum@wur.nl</a> (<a href="https://orcid.org/0000-0002-8673-2514">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Emilie J Millet <a href="mailto:emilie.millet@wur.nl">emilie.millet@wur.nl</a> (<a href="https://orcid.org/0000-0002-2913-4892">ORCID</a>)
</p>
</li>
<li><p> Maria Xose Rodriguez Alvarez (<a href="https://orcid.org/0000-0002-1329-9238">ORCID</a>)
</p>
</li>
<li><p> Diana Marcela Perez Valencia (<a href="https://orcid.org/0000-0002-9053-2929">ORCID</a>)
</p>
</li>
<li><p> Isabelle Sanchez
</p>
</li>
<li><p> Nadine Hilgert
</p>
</li>
<li><p> Fred van Eeuwijk (<a href="https://orcid.org/0000-0003-3672-2921">ORCID</a>)
</p>
</li>
<li><p> Martin Boer
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://biometris.github.io/statgenHTP/index.html">https://biometris.github.io/statgenHTP/index.html</a>
</p>
</li>
<li> <p><a href="https://github.com/Biometris/statgenHTP/">https://github.com/Biometris/statgenHTP/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/Biometris/statgenHTP/issues">https://github.com/Biometris/statgenHTP/issues</a>
</p>
</li></ul>


<hr>
<h2 id='as.data.frame.TP'>Coerce TP object to data.frame</h2><span id='topic+as.data.frame.TP'></span>

<h3>Description</h3>

<p>Function for converting an object of class TP to a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TP'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.data.frame.TP_+3A_x">x</code></td>
<td>
<p>An object of class TP.</p>
</td></tr>
<tr><td><code id="as.data.frame.TP_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame containing the data.frames for all time points in the
TP object bound together.
</p>


<h3>See Also</h3>

<p>Other functions for data preparation: 
<code><a href="#topic+createTimePoints">createTimePoints</a>()</code>,
<code><a href="#topic+getTimePoints">getTimePoints</a>()</code>,
<code><a href="#topic+plot.TP">plot.TP</a>()</code>,
<code><a href="#topic+removeTimePoints">removeTimePoints</a>()</code>,
<code><a href="#topic+summary.TP">summary.TP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))
## Convert phenoTP to data.frame.
phenoDat &lt;- as.data.frame(phenoTP)

</code></pre>

<hr>
<h2 id='countValid'>Count valid observations per time point for a given trait</h2><span id='topic+countValid'></span>

<h3>Description</h3>

<p>Count valid observations per time point for a given trait.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>countValid(TP, trait)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="countValid_+3A_tp">TP</code></td>
<td>
<p>An object of class TP.</p>
</td></tr>
<tr><td><code id="countValid_+3A_trait">trait</code></td>
<td>
<p>A character string indicating the trait for which valid
observations should be counted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numerical vector with he number of valid observations per
time point .
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))
## Count valid observations for EffpsII per time point.
validPheno &lt;- countValid(phenoTP, trait = "EffpsII")
head(validPheno)

</code></pre>

<hr>
<h2 id='countValidPlot'>Count valid observations per plotId for a given trait</h2><span id='topic+countValidPlot'></span>

<h3>Description</h3>

<p>Count valid observations per plotId for a given trait.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>countValidPlot(TP, trait, plotIds = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="countValidPlot_+3A_tp">TP</code></td>
<td>
<p>An object of class TP.</p>
</td></tr>
<tr><td><code id="countValidPlot_+3A_trait">trait</code></td>
<td>
<p>A character string indicating the trait for which valid
observations should be counted.</p>
</td></tr>
<tr><td><code id="countValidPlot_+3A_plotids">plotIds</code></td>
<td>
<p>A character vector indicating the plotIds for which valid
observations should be checked. If <code>NULL</code> valid observations are
counted for all plotIds in TP.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numerical vector with he number of valid observations per
plotId.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))
## Count valid observations for EffpsII for a subset of plots.
countValidPlot(phenoTP,
               trait = "EffpsII",
               plotIds = c("c12r22", "c24r41", "c14r32"))

</code></pre>

<hr>
<h2 id='createTimePoints'>Create an object of class TP</h2><span id='topic+createTimePoints'></span>

<h3>Description</h3>

<p>Convert a data.frame to an object of class TP (Time Points).
The function converts a data.frame to an object of class TP in the following
steps:
</p>

<ul>
<li><p>Quality control on the input data. For example, warnings will be given
when more than 50% of observations are missing for a plant.
</p>
</li>
<li><p>Rename columns to default column names used by the functions in the
statgenHTP package. For example, the column in the data containing
variety/accession/genotype is renamed to “genotype.” Original column names
are stored as an attribute of the individual data.frames in the TP object.
</p>
</li>
<li><p>Convert column types to the default column types. For example, the
column “genotype” is converted to a factor and “rowNum” to a numeric column.
</p>
</li>
<li><p>Convert the column containing time into time format. If needed, the
time format can be provided in <code>timeFormat</code>. For example, with a
date/time input of the form “day/month/year hour:minute”, use
&quot;%d/%m/%Y %H:%M&quot;. For a full list of abbreviations see the R package
strptime. When the input time is a numeric value, the function will
convert it to time from 01-01-1970.
</p>
</li>
<li><p>If <code>addCheck = TRUE</code>, the genotypes listed in
<code>checkGenotypes</code> are reference genotypes (or check). It will add a
column check with a value &quot;noCheck&quot; for the genotypes that are not in
<code>checkGenotypes</code> and the name of the genotypes for the
<code>checkGenotypes</code>. A column genoCheck is also added with the names of
the genotypes that are not in <code>checkGenotypes</code> and <code>NA</code> for the
<code>checkGenotypes</code>. These columns are necessary for fitting models on
data that includes check genotypes, e.g. reference genotypes that are
highly replicated or in case of augmented design.
</p>
</li>
<li><p>Split the data into separate data.frames by time point. A TP object is
a list of data.frames where each data.frame contains the data for a single
time point. If there is only one time point the output will be a list with
only one item.
</p>
</li>
<li><p>Add a data.frame with columns timeNumber and timePoint as attribute
“timePoints” to the TP object. This data.frame can be used for referencing
time points by a unique number.
</p>
</li></ul>

<p>Note that <code>plotId</code> needs to be a unique identifier for a plot or a
plant. It cannot occur more than once per time point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createTimePoints(
  dat,
  experimentName,
  genotype,
  timePoint,
  timeFormat = NULL,
  plotId,
  repId = NULL,
  rowNum = NULL,
  colNum = NULL,
  addCheck = FALSE,
  checkGenotypes = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createTimePoints_+3A_dat">dat</code></td>
<td>
<p>A data.frame.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_experimentname">experimentName</code></td>
<td>
<p>A character string, the name of the experiment. Stored
with the data and used in default plot titles.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_genotype">genotype</code></td>
<td>
<p>A character string indicating the column in dat containing
the genotypes.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_timepoint">timePoint</code></td>
<td>
<p>A character string indicating the column in dat containing
the time points.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_timeformat">timeFormat</code></td>
<td>
<p>A character string indicating the input format of the time
points. E.g. for a date/time input of the form day/month/year hour:minute,
use &quot;%d/%m/%Y %H:%M&quot;. For a full list of abbreviations see
<code><a href="base.html#topic+strptime">strptime</a></code>. If <code>NULL</code>, a best guess is done based on
the input.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_plotid">plotId</code></td>
<td>
<p>A character string indicating the column in dat containing
the plotId. This has to be a unique identifier per plot/plant per time point.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_repid">repId</code></td>
<td>
<p>A character string indicating the column in dat containing
the replicates.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_rownum">rowNum</code></td>
<td>
<p>A character string indicating the column in dat containing
the row number of the plot.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_colnum">colNum</code></td>
<td>
<p>A character string indicating the column in dat containing
the column number of the plot.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_addcheck">addCheck</code></td>
<td>
<p>Should a column check be added to the output? If <code>TRUE</code>,
checkGenotypes cannot be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="createTimePoints_+3A_checkgenotypes">checkGenotypes</code></td>
<td>
<p>A character vector containing the genotypes used as
checks in the experiment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>TP</code>. A list with, per time point in the
input, a data.frame containing the data for that time point. A data.frame
with columns timeNumber and timePoint is added as attribute timePoints to
the data. This data.frame can be used for referencing timePoints by their
number.
</p>


<h3>See Also</h3>

<p>Other functions for data preparation: 
<code><a href="#topic+as.data.frame.TP">as.data.frame.TP</a>()</code>,
<code><a href="#topic+getTimePoints">getTimePoints</a>()</code>,
<code><a href="#topic+plot.TP">plot.TP</a>()</code>,
<code><a href="#topic+removeTimePoints">removeTimePoints</a>()</code>,
<code><a href="#topic+summary.TP">summary.TP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3","check4"))
summary(phenoTP)

</code></pre>

<hr>
<h2 id='detectSerieOut'>Detect outliers for series of observations</h2><span id='topic+detectSerieOut'></span>

<h3>Description</h3>

<p>Function for detecting strange time courses. The function uses the estimates
for the spline coefficients per time course (typically per plant).
Correlations between those coefficient vectors are calculated to identify
outlying time courses, i.e., plants. An outlying time course will have low
correlation to the majority of time courses. To support the analysis by
correlations, a principal component analysis is done on the plant
(time course) by spline coefficient matrix. A PCA plot of the plant scores
will show the outlying plants. Finally the pairwise-ratios of the slopes of
a linear model fitted through the spline coefficients are computed. Plants
are tagged when the average pairwise-ratio is lower the a given threshold
(<code>thrSlope</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detectSerieOut(
  corrDat,
  predDat,
  coefDat,
  trait,
  genotypes = NULL,
  geno.decomp = NULL,
  thrCor = 0.9,
  thrPca = 30,
  thrSlope = 0.7
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detectSerieOut_+3A_corrdat">corrDat</code></td>
<td>
<p>A data.frame with corrected spatial data.</p>
</td></tr>
<tr><td><code id="detectSerieOut_+3A_preddat">predDat</code></td>
<td>
<p>A data.frame with predicted data from a fitted spline.</p>
</td></tr>
<tr><td><code id="detectSerieOut_+3A_coefdat">coefDat</code></td>
<td>
<p>A data.frame with coefficients from a fitted spline.</p>
</td></tr>
<tr><td><code id="detectSerieOut_+3A_trait">trait</code></td>
<td>
<p>A character string indicating the trait for which to detect
outliers.</p>
</td></tr>
<tr><td><code id="detectSerieOut_+3A_genotypes">genotypes</code></td>
<td>
<p>A character vector indicating the genotypes for which to
detect outliers. If <code>NULL</code>, outlier detection will be done for all
genotypes.</p>
</td></tr>
<tr><td><code id="detectSerieOut_+3A_geno.decomp">geno.decomp</code></td>
<td>
<p>A character vector indicating the variables to use to
group the genotypic variance in the model.</p>
</td></tr>
<tr><td><code id="detectSerieOut_+3A_thrcor">thrCor</code></td>
<td>
<p>A numerical value used as threshold for determining outliers
based on correlation between plots.</p>
</td></tr>
<tr><td><code id="detectSerieOut_+3A_thrpca">thrPca</code></td>
<td>
<p>A numerical value used as threshold for determining outliers
based on angles (in degrees) between PCA scores.</p>
</td></tr>
<tr><td><code id="detectSerieOut_+3A_thrslope">thrSlope</code></td>
<td>
<p>A numerical value used as threshold for determining outliers
based on slopes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>serieOut</code>, a <code>data.frame</code> with outlying
series of observations.
</p>


<h3>See Also</h3>

<p>Other functions for detecting outliers for series of observations: 
<code><a href="#topic+plot.serieOut">plot.serieOut</a>()</code>,
<code><a href="#topic+removeSerieOut">removeSerieOut</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## Fit P-splines on a subset of genotypes
subGenoVator &lt;- c("G160", "G151")
fit.spline &lt;- fitSpline(inDat = spatCorrectedVator,
                        trait = "EffpsII_corr",
                        genotypes = subGenoVator,
                        knots = 50)

## Extract the data.frames with predicted values and P-Spline coefficients.
predDat &lt;- fit.spline$predDat
coefDat &lt;- fit.spline$coefDat

## The coefficients are then used to tag suspect time courses.
outVator &lt;- detectSerieOut(corrDat = spatCorrectedVator,
                           predDat = predDat,
                           coefDat = coefDat,
                           trait = "EffpsII_corr",
                           genotypes = subGenoVator,
                           thrCor = 0.9,
                           thrPca = 30,
                           thrSlope = 0.7)

## The `outVator` can be visualized for selected genotypes.
plot(outVator, genotypes = "G151")


</code></pre>

<hr>
<h2 id='detectSingleOut'>Detect outliers for single observations</h2><span id='topic+detectSingleOut'></span>

<h3>Description</h3>

<p>Detect outlying observations in a time series by modeling each plotId using
a local regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detectSingleOut(
  TP,
  trait,
  plotIds = NULL,
  checkEdges = TRUE,
  confIntSize = 5,
  nnLocfit = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detectSingleOut_+3A_tp">TP</code></td>
<td>
<p>An object of class <code>TP</code>.</p>
</td></tr>
<tr><td><code id="detectSingleOut_+3A_trait">trait</code></td>
<td>
<p>A character vector indicating the trait to model in <code>TP</code>.</p>
</td></tr>
<tr><td><code id="detectSingleOut_+3A_plotids">plotIds</code></td>
<td>
<p>A character vector of plotIds for which the outliers should be
detected. If <code>NULL</code>, all plotIds in <code>TP</code> are used.</p>
</td></tr>
<tr><td><code id="detectSingleOut_+3A_checkedges">checkEdges</code></td>
<td>
<p>Before fitting the local regression should a check be done
if the first and last time point for a plot are outlying observations?</p>
</td></tr>
<tr><td><code id="detectSingleOut_+3A_confintsize">confIntSize</code></td>
<td>
<p>A numeric value defining the confidence interval (see
Details).</p>
</td></tr>
<tr><td><code id="detectSingleOut_+3A_nnlocfit">nnLocfit</code></td>
<td>
<p>A numeric value defining the constant component of the
smoothing parameter nn (see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See locfit() help function from the locfit R library. The user can act on:
</p>

<dl>
<dt>nnLocfit</dt><dd><p>the constant of the smoothing parameter. Increase nnLocfit
to have a very smooth curve</p>
</dd>
<dt>confIntSize</dt><dd><p>the level to calculate the confidence interval. Increase
confIntSize to exclude less outliers</p>
</dd>
</dl>



<h3>Value</h3>

<p>An object of class singleOut, a <code>data.frame</code> with the following
columns.
</p>

<dl>
<dt>plotId</dt><dd><p>plotId</p>
</dd>
<dt>timePoint</dt><dd><p>time point</p>
</dd>
<dt>trait</dt><dd><p>modeled trait</p>
</dd>
<dt>yPred</dt><dd><p>prediction from the local regression</p>
</dd>
<dt>sd_yPred</dt><dd><p>standard deviation of the prediction</p>
</dd>
<dt>lwr</dt><dd><p>lower bound of the confidence interval</p>
</dd>
<dt>upr</dt><dd><p>upper bound of the confidence interval</p>
</dd>
<dt>outlier</dt><dd><p>flag for detected outlier (a value of 1 indicates the
observation is an outlier)</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other functions for detecting outliers for single observations: 
<code><a href="#topic+detectSingleOutMaize">detectSingleOutMaize</a>()</code>,
<code><a href="#topic+plot.singleOut">plot.singleOut</a>()</code>,
<code><a href="#topic+removeSingleOut">removeSingleOut</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
PhenovatorDat1 &lt;- PhenovatorDat1[!PhenovatorDat1$pos %in%
                                 c("c24r41", "c7r18", "c7r49"), ]
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## First select a subset of plants, for example here 9 plants
plantSel &lt;- phenoTP[[1]]$plotId[1:9]
# Then run on the subset
resuVatorHTP &lt;- detectSingleOut(TP = phenoTP,
                                trait = "EffpsII",
                                plotIds = plantSel,
                                confIntSize = 3,
                                nnLocfit = 0.1)

</code></pre>

<hr>
<h2 id='detectSingleOutMaize'>detectSingleOutMaize</h2><span id='topic+detectSingleOutMaize'></span>

<h3>Description</h3>

<p>Function to detect plant outliers in a temporal lattice experiment on Maize
which can be extended to other experiment types.
The criteria needs three phenotypes (ex for maize: the estimated biomass,
plant height and phyllocron)
</p>

<dl>
<dt>plants are identified as &quot;small outlier plant&quot;</dt><dd><p>if for biomass AND
phyllocron <code class="reqn">res_i &lt; \mu_{res} - qnorm(threshold) * sd_{res}</code></p>
</dd>
<dt>plants are identified as &quot;big outlier plant&quot;</dt><dd><p> if for biomass AND
plant height <code class="reqn">res_i &gt; \mu_{res} + qnorm(threshold) * sd_{res}</code></p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>detectSingleOutMaize(
  TP,
  timeBeforeTrt,
  trait1 = "Biomass",
  trait2 = "PlantHeight",
  trait3 = "phyllocron",
  thr = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detectSingleOutMaize_+3A_tp">TP</code></td>
<td>
<p>An object of class TP.</p>
</td></tr>
<tr><td><code id="detectSingleOutMaize_+3A_timebeforetrt">timeBeforeTrt</code></td>
<td>
<p>A character or numeric value indicating the date just
before treatment in the experiment. When using a character string to
reference a time point, the value has to be an exact match to one of the
existing timePoints. When using a number it will be matched by its number
(&quot;timeNumber&quot;) in the timePoints attribute of the TP object.</p>
</td></tr>
<tr><td><code id="detectSingleOutMaize_+3A_trait1">trait1</code></td>
<td>
<p>A character vector indicating the first trait to model in TP.</p>
</td></tr>
<tr><td><code id="detectSingleOutMaize_+3A_trait2">trait2</code></td>
<td>
<p>A character vector indicating the second trait to model in TP.</p>
</td></tr>
<tr><td><code id="detectSingleOutMaize_+3A_trait3">trait3</code></td>
<td>
<p>A character vector indicating the third trait to model in TP.</p>
</td></tr>
<tr><td><code id="detectSingleOutMaize_+3A_thr">thr</code></td>
<td>
<p>A numeric value indicating the threshold.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three data.frames, <code>modDat</code> containing the
data used for fitting the models, <code>smallPlants</code> containing the plants
identified as small plants and <code>bigPlants</code> containing the plants
identified as big plants.
</p>


<h3>See Also</h3>

<p>Other functions for detecting outliers for single observations: 
<code><a href="#topic+detectSingleOut">detectSingleOut</a>()</code>,
<code><a href="#topic+plot.singleOut">plot.singleOut</a>()</code>,
<code><a href="#topic+removeSingleOut">removeSingleOut</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Create a TP object containing the data from the PhenoArch.
phenoTParch &lt;- createTimePoints(dat = PhenoarchDat1,
                                experimentName = "Phenoarch",
                                genotype = "Genotype",
                                timePoint = "Date",
                                plotId = "pos",
                                rowNum = "Row",
                                colNum = "Col")
singleOutMaize &lt;- detectSingleOutMaize(phenoTParch,
                                       timeBeforeTrt = "2017-04-27",
                                       trait1 = "Biomass",
                                       trait2 = "PlantHeight",
                                       trait3 = "phyllocron",
                                       thr = 0.95)


</code></pre>

<hr>
<h2 id='estimateSplineParameters'>Extract estimates from fitted splines.</h2><span id='topic+estimateSplineParameters'></span>

<h3>Description</h3>

<p>Function for extracting parameter estimates from fitted splines on a
specified interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateSplineParameters(
  x,
  estimate = c("predictions", "derivatives", "derivatives2"),
  what = c("min", "max", "mean", "AUC", "p"),
  AUCScale = c("min", "hour", "day"),
  timeMin = NULL,
  timeMax = NULL,
  genotypes = NULL,
  plotIds = NULL,
  fitLevel = c("geno", "plot", "genoDev", "plotDev")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimateSplineParameters_+3A_x">x</code></td>
<td>
<p>An object of class HTPSpline, the output of the
<code><a href="#topic+fitSpline">fitSpline</a></code> function, or class splineHDm, the output of the
<code><a href="#topic+fitSplineHDM">fitSplineHDM</a></code> function</p>
</td></tr>
<tr><td><code id="estimateSplineParameters_+3A_estimate">estimate</code></td>
<td>
<p>The P-Spline component for which the estimate should be
extracted, the predictions, the first derivatives or the second derivatives
(&quot;derivatives2&quot;)</p>
</td></tr>
<tr><td><code id="estimateSplineParameters_+3A_what">what</code></td>
<td>
<p>The types of estimate that should be extracted. Either minimum
(&quot;min&quot;), maximum (&quot;max&quot;), mean, area under the curve (&quot;AUC&quot;) or a percentile.
Percentiles should be given as p + percentile. E.g. for the 10th percentile
specify what = &quot;p10&quot;. Multiple types of estimate can be extracted at once.</p>
</td></tr>
<tr><td><code id="estimateSplineParameters_+3A_aucscale">AUCScale</code></td>
<td>
<p>The area under the curve is dependent on the scale used on
the x-axis. By default the area is computed assuming a scale in minutes. This
can be changed to either hours or days.</p>
</td></tr>
<tr><td><code id="estimateSplineParameters_+3A_timemin">timeMin</code></td>
<td>
<p>The lower bound of the time interval from which the
estimates should be extracted. If <code>NULL</code> the smallest time value for
which the splines were fitted is used.</p>
</td></tr>
<tr><td><code id="estimateSplineParameters_+3A_timemax">timeMax</code></td>
<td>
<p>The upper bound of the time interval from which the
estimates should be extracted. If <code>NULL</code> the largest time value for
which the splines were fitted is used.</p>
</td></tr>
<tr><td><code id="estimateSplineParameters_+3A_genotypes">genotypes</code></td>
<td>
<p>A character vector indicating the genotypes for which
estimates should be extracted. If <code>NULL</code>, estimates will be extracted
for all genotypes for which splines where fitted.</p>
</td></tr>
<tr><td><code id="estimateSplineParameters_+3A_plotids">plotIds</code></td>
<td>
<p>A character vector indicating the plotIds for which
estimates should be extracted. If <code>NULL</code>, estimates will be extracted
for all plotIds for which splines where fitted.</p>
</td></tr>
<tr><td><code id="estimateSplineParameters_+3A_fitlevel">fitLevel</code></td>
<td>
<p>A character string indicating at which level of the data
the parameter estimates should be made. Only used for splines fitted using
<code><a href="#topic+fitSplineHDM">fitSplineHDM</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class splineEst, a data.frame containing the
estimated parameters.
</p>


<h3>See Also</h3>

<p>Other functions for spline parameter estimation: 
<code><a href="#topic+plot.splineEst">plot.splineEst</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Estimate parameters for fitted P-splines.

## Run the function to fit P-splines on a subset of genotypes.
subGeno &lt;- c("G160", "G151")
fit.spline &lt;- fitSpline(inDat = spatCorrectedVator,
                        trait = "EffpsII_corr",
                        genotypes = subGeno,
                        knots = 50)

## Estimate the maximum value of the predictions at the beginning of the time course.
paramVator &lt;- estimateSplineParameters(x = fit.spline,
                                       estimate = "predictions",
                                       what = "max",
                                       timeMin = 1527784620,
                                       timeMax = 1528500000,
                                       genotypes = subGeno)
head(paramVator)

## Create a boxplot of the estimates.
plot(paramVator, plotType = "box")

## Estimate the minimum and maximum value of the predictions.
paramVator2 &lt;- estimateSplineParameters(x = fit.spline,
                                        estimate = "predictions",
                                        what = c("min", "max"),
                                        genotypes = subGeno)
head(paramVator2)


### Estimate parameters for fitted HDM-splines.

## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## We need to specify the genotype-by-treatment interaction.
## Treatment: water regime (WW, WD).
spatCorrectedArch[["treat"]] &lt;- substr(spatCorrectedArch[["geno.decomp"]],
                                      start = 1, stop = 2)
spatCorrectedArch[["genoTreat"]] &lt;-
  interaction(spatCorrectedArch[["genotype"]],
             spatCorrectedArch[["treat"]], sep = "_")

## Fit P-Splines Hierarchical Curve Data Model for selection of genotypes.
fit.psHDM  &lt;- fitSplineHDM(inDat = spatCorrectedArch,
                          trait = "LeafArea_corr",
                          genotypes = c("GenoA14_WD", "GenoA51_WD",
                                       "GenoB11_WW", "GenoB02_WD",
                                       "GenoB02_WW"),
                          time = "timeNumber",
                          pop = "geno.decomp",
                          genotype = "genoTreat",
                          plotId = "plotId",
                          difVar = list(geno = FALSE, plot = FALSE),
                          smoothPop = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothGeno = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothPlot = list(nseg = 4, bdeg = 3, pord = 2),
                          weights = "wt",
                          trace = FALSE)

## Estimate minimum, maximum, and mean for predictions at the genotype level.
paramArch &lt;- estimateSplineParameters(x = fit.psHDM,
                                     what = c("min", "max", "mean"),
                                     fitLevel = "geno",
                                     estimate = "predictions",
                                     timeMax = 28)
head(paramArch)

## Create a boxplot of the estimates.
plot(paramArch, plotType = "box")

## Estimate area under the curve for predictions at the plot level.
paramArch2 &lt;- estimateSplineParameters(x = fit.psHDM,
                                      what = "AUC",
                                      fitLevel = "plot",
                                      estimate = "predictions")
head(paramArch2)

</code></pre>

<hr>
<h2 id='fitModels'>Fit spatial models per time point</h2><span id='topic+fitModels'></span>

<h3>Description</h3>

<p>Perform REML analysis at each time point using either SpATS or asreml. The
idea is to is to accurately separate the genetic effects from the spatial
effects at each time point. SpATS is used as a default method. See details
for the exact models fitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitModels(
  TP,
  trait,
  timePoints = names(TP),
  extraFixedFactors = NULL,
  geno.decomp = NULL,
  what = c("random", "fixed"),
  useCheck = FALSE,
  useRepId = FALSE,
  engine = c("SpATS", "asreml"),
  spatial = FALSE,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitModels_+3A_tp">TP</code></td>
<td>
<p>An object of class <code>TP</code>.</p>
</td></tr>
<tr><td><code id="fitModels_+3A_trait">trait</code></td>
<td>
<p>A character string indicating the trait used as response
variable in the model.</p>
</td></tr>
<tr><td><code id="fitModels_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time points
to be modeled. When using a character string to reference a time point, the
value has to be an exact match to one of the existing time points. When using
a number it will be matched by its number (&quot;timeNumber&quot;) in the timePoints
attribute of the <code>TP</code> object.</p>
</td></tr>
<tr><td><code id="fitModels_+3A_extrafixedfactors">extraFixedFactors</code></td>
<td>
<p>A character vector indicating the variables to use
as extra fixed effects in the model.</p>
</td></tr>
<tr><td><code id="fitModels_+3A_geno.decomp">geno.decomp</code></td>
<td>
<p>A character vector indicating the variables to use to
group the genotypic variance in the model.</p>
</td></tr>
<tr><td><code id="fitModels_+3A_what">what</code></td>
<td>
<p>A character vector specifying whether &quot;genotype&quot; should
be fitted as &quot;random&quot; or &quot;fixed&quot; effect. Note that when using
<code>geno.decomp</code>, fitting a model with genotype as &quot;fixed&quot; effect is not
possible.</p>
</td></tr>
<tr><td><code id="fitModels_+3A_usecheck">useCheck</code></td>
<td>
<p>Should check genotypes be used as an extra factor in the
model?</p>
</td></tr>
<tr><td><code id="fitModels_+3A_userepid">useRepId</code></td>
<td>
<p>Should repId be used as a fixed effect in the model? When
fitting a spatial model rowId and colId are also nested within repId in the
random part of the model.</p>
</td></tr>
<tr><td><code id="fitModels_+3A_engine">engine</code></td>
<td>
<p>A character string indicating the engine used to fit the
models.</p>
</td></tr>
<tr><td><code id="fitModels_+3A_spatial">spatial</code></td>
<td>
<p>Should a spatial model be fitted for asreml?</p>
</td></tr>
<tr><td><code id="fitModels_+3A_quiet">quiet</code></td>
<td>
<p>Should printed progress messages be suppressed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The actual model fitted depends on the function parameters specified. The
basic model is the following:<br />
trait = <strong>genotype</strong> + e<br />
In case <code>useCheck = TRUE</code>, instead of genotype, genoCheck is used as
genotype and check is used as an extra fixed effect. So then the model
becomes:<br />
trait = <em>check</em> + <strong>genoCheck</strong> + e<br />
Variables in <code>extraFixedFactors</code> are fitted as extra fixed
effects.<br /><br />
When <code>SpATS</code> is used for modeling, an extra spatial term is always
included in the model. This term is constructed using the function
<code><a href="SpATS.html#topic+PSANOVA">PSANOVA</a></code> from the SpATS package as<br />
<code>PSANOVA(colNum, rowNum, nseg = nSeg, nest.div = 2)</code>
where<br /> <code>nSeg = c(number of columns, number of rows)</code>.<br /><br />
When <code>asreml</code> is used for modeling and <code>spatial = TRUE</code>,
four models are fitted with different covariance structures.
The best model is determined based on a goodness-of-fit criterion, AIC,
on 20% of the time points or at least 10 time points. The best model is then
run on all time points.
The following combinations of random and spatial terms are fitted
</p>

<ul>
<li><p>random = repId:rowId + repId:colId, spatial = NULL
</p>
</li>
<li><p>random = repId:rowId + repId:colId, spatial = ar1(rowId):colId
</p>
</li>
<li><p>random = repId:colId + repId:colId, spatial = rowId:ar1(colId)
</p>
</li>
<li><p>random = repId:rowId + repId:colId, spatial = ar1(rowId):ar1(colId)
</p>
</li></ul>

<p>If there are no replicates in the model, repId is left out from the random
parts above.<br /><br />
When <code>geno.decomp</code> is specified, the genotypic variance is decomposed
following the variable(s) chosen. For example, when a treatment is used in
<code>geno.decomp</code>, the initial model becomes:<br />
trait = <em>treatment</em> + <strong>treatment:genotype</strong> + e<br />
</p>


<h3>Value</h3>

<p>An object of class <code>fitMod</code>, a list of fitted models.
</p>


<h3>References</h3>

<p>Maria Xose Rodriguez-Alvarez, Martin P. Boer, Fred A. van Eeuwijk, Paul H.C.
Eilers (2017). Correcting for spatial heterogeneity in plant breeding
experiments with P-splines. Spatial Statistics
<a href="https://doi.org/10.1016/j.spasta.2017.10.003">doi:10.1016/j.spasta.2017.10.003</a>
Butler, D. G., et al. (2018). ASReml-R Reference Manual Version 4. VSN
International Ltd, http://asreml.org
</p>


<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code><a href="#topic+getCorrected">getCorrected</a>()</code>,
<code><a href="#topic+getEffDims">getEffDims</a>()</code>,
<code><a href="#topic+getGenoPred">getGenoPred</a>()</code>,
<code><a href="#topic+getHerit">getHerit</a>()</code>,
<code><a href="#topic+getVar">getVar</a>()</code>,
<code><a href="#topic+plot.fitMod">plot.fitMod</a>()</code>,
<code><a href="#topic+summary.fitMod">summary.fitMod</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using the first example dataset (PhenovatorDat1):
## Fit a model using SpATS on few time points:

## Create an object of class TP.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))
## Fit a model with SpATS for three time points.
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(3, 6, 20))
summary(modPhenoSp)

## Fit a model with SpATS for a single time point with extra fixed factors
## and check genotypes:
modPhenoSpCheck &lt;- fitModels(TP = phenoTP,
                             trait = "EffpsII",
                             extraFixedFactors = c("repId", "Image_pos"),
                             useCheck = TRUE,
                             timePoints = 3)


## Fit a model with asreml on few time points with a spatial function:
if (requireNamespace("asreml", quietly = TRUE)) {
  modPhenoSpAs &lt;- fitModels(TP = phenoTP,
                            trait = "EffpsII",
                            timePoints = c(1, 6, 20),
                            engine = "asreml",
                            spatial = TRUE)
}

## Using the second example dataset (PhenoarchDat1):
## Fit a model with SpATS on one time points with two variables for
## geno.decomp:
data("PhenoarchDat1")
phenoTParch &lt;- createTimePoints(dat = PhenoarchDat1,
                                experimentName = "Phenoarch",
                                genotype = "Genotype",
                                timePoint = "Date",
                                plotId = "pos",
                                rowNum = "Row",
                                colNum = "Col")

modPhenoSpGD &lt;- fitModels(TP = phenoTParch,
                          trait = "LeafArea",
                          geno.decomp = c("Scenario", "population"),
                          timePoints = 16)



</code></pre>

<hr>
<h2 id='fitSpline'>Fit Splines</h2><span id='topic+fitSpline'></span>

<h3>Description</h3>

<p>Fit P-Splines on corrected or raw data. The number of
knots is chosen by the user. The function outputs are predicted P-Spline
values and their first and second derivatives on a dense grid. The
outputs can then be used for outlier detection for time series
(see <code><a href="#topic+detectSerieOut">detectSerieOut</a></code>) and to estimate relevant parameters from
the curve for further analysis (see <code><a href="#topic+estimateSplineParameters">estimateSplineParameters</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitSpline(
  inDat,
  trait,
  genotypes = NULL,
  plotIds = NULL,
  knots = 50,
  useTimeNumber = FALSE,
  timeNumber = NULL,
  minNoTP = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitSpline_+3A_indat">inDat</code></td>
<td>
<p>A data.frame with corrected spatial data.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_trait">trait</code></td>
<td>
<p>A character string indicating the trait for which the spline
should be fitted.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_genotypes">genotypes</code></td>
<td>
<p>A character vector indicating the genotypes for which
splines should be fitted. If <code>NULL</code>, splines will be fitted for all
genotypes.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_plotids">plotIds</code></td>
<td>
<p>A character vector indicating the plotIds for which splines
should be fitted. If <code>NULL</code>, splines will be fitted for all plotIds.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_knots">knots</code></td>
<td>
<p>The number of knots to use when fitting the spline.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_usetimenumber">useTimeNumber</code></td>
<td>
<p>Should the timeNumber be used instead of the timePoint?</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_timenumber">timeNumber</code></td>
<td>
<p>If <code>useTimeNumber = TRUE</code>, a character vector
indicating the column containing the numerical time to use.</p>
</td></tr>
<tr><td><code id="fitSpline_+3A_minnotp">minNoTP</code></td>
<td>
<p>The minimum number of time points for which data should be
available for a plant. Defaults to 80% of all time points present in the
TP object. No splines are fitted for plants with less than the minimum number
of timepoints.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>HTPSpline</code>, a list with two
<code>data.frames</code>, <code>predDat</code> with predicted values and <code>coefDat</code>
with P-Spline coefficients on a dense grid.
</p>


<h3>See Also</h3>

<p>Other functions for fitting splines: 
<code><a href="#topic+plot.HTPSpline">plot.HTPSpline</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## Fit P-Splines on a subset of genotypes
subGeno &lt;- c("G070", "G160")
fit.spline &lt;- fitSpline(inDat = spatCorrectedVator,
                        trait = "EffpsII_corr",
                        genotypes = subGeno,
                        knots = 50)

## Extract the data.frames with predicted values and P-Spline coefficients.
predDat &lt;- fit.spline$predDat
head(predDat)

coefDat &lt;- fit.spline$coefDat
head(coefDat)

## Visualize the P-Spline predictions for one genotype.
plot(fit.spline, genotypes = "G160")

## Visualize the P-Spline predictions and first derivatives for one plant.
plot(fit.spline, plotIds = "c10r29", plotType = "predictions")
plot(fit.spline, plotIds = "c10r29", plotType = "derivatives")

</code></pre>

<hr>
<h2 id='fitSplineHDM'>Fit P-Spline Hierarchical Curve Data Models</h2><span id='topic+fitSplineHDM'></span>

<h3>Description</h3>

<p>Fit the P-spline Hierarchical Curve Data Model used in the second stage of
the two-stage approach proposed by Pérez-Valencia et al. (2022). This model
assumes a three-level hierarchical structure in the data, with plants nested
in genotypes, genotypes nested in populations. The input for this function
is the spatially corrected data, as obtained from the first stage of the
approach (see <code><a href="#topic+fitModels">fitModels</a></code> and <code><a href="#topic+getCorrected">getCorrected</a></code>).
The number of segments is chosen by the user, as well as the B-spline degree,
and the penalty order for the three-levels of the hierarchy. The user can
also decide if different variances for random effects at genotype (separately
for each population) and plant (separately for each genotype) levels are
desired. The function outputs are estimated curves (time series of trajectories
and deviations) and their first and second derivatives for the three-levels
of the hierarchy. The outputs can then be used to estimate relevant parameters
from the curves for further analysis (see <code><a href="#topic+estimateSplineParameters">estimateSplineParameters</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitSplineHDM(
  inDat,
  genotypes = NULL,
  plotIds = NULL,
  trait,
  useTimeNumber = FALSE,
  timeNumber = NULL,
  pop = "pop",
  genotype = "genotype",
  plotId = "plotId",
  weights = NULL,
  difVar = list(geno = FALSE, plot = FALSE),
  smoothPop = list(nseg = 10, bdeg = 3, pord = 2),
  smoothGeno = list(nseg = 10, bdeg = 3, pord = 2),
  smoothPlot = list(nseg = 10, bdeg = 3, pord = 2),
  offset = NULL,
  family = gaussian(),
  maxit = 200,
  trace = TRUE,
  thr = 0.001,
  minNoTP = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitSplineHDM_+3A_indat">inDat</code></td>
<td>
<p>A data.frame with corrected spatial data.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_genotypes">genotypes</code></td>
<td>
<p>A character vector indicating the genotypes for which
hierarchical models should be fitted. If <code>NULL</code>, splines will be fitted
for all genotypes.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_plotids">plotIds</code></td>
<td>
<p>A character vector indicating the plotIds for which
hierarchical models should be fitted. If <code>NULL</code>, splines will be
fitted for all plotIds.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_trait">trait</code></td>
<td>
<p>A character string indicating the trait for which the spline
should be fitted.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_usetimenumber">useTimeNumber</code></td>
<td>
<p>Should the timeNumber be used instead of the timePoint?.
If <code>useTimeNumber = FALSE</code>, inDat should contain a column called timePoint
of class <code>POSIXct</code>.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_timenumber">timeNumber</code></td>
<td>
<p>If <code>useTimeNumber = TRUE</code>, a character vector
indicating the column containing the numerical time to use.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_pop">pop</code></td>
<td>
<p>A character string indicating the the populations to which each
genotype/variety belongs. This variable must be a factor in the data frame.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_genotype">genotype</code></td>
<td>
<p>A character string indicating the populations to which each
genotype/variety belongs. This variable must be a factor in the data frame.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_plotid">plotId</code></td>
<td>
<p>A character string indicating the genotypes/varieties to which
each plant/plot/individual belongs. This variable must be a factor in the
data frame.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_weights">weights</code></td>
<td>
<p>A character string indicating the column in the data containing
the weights to be used in the fitting process (for error propagation from
first stage to second stage). By default, when <code>weights = NULL</code>, the
weights are considered to be one.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_difvar">difVar</code></td>
<td>
<p>Should different variances for random effects at genotype
(separately for each population) and plant level (separately for each
genotype) be considered?.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_smoothpop">smoothPop</code></td>
<td>
<p>A list specifying the P-Spline model at the population
level (nseg: number of segments; bdeg: degree of the B-spline basis; pord:
penalty order).</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_smoothgeno">smoothGeno</code></td>
<td>
<p>A list specifying the P-Spline model at the genotype
level.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_smoothplot">smoothPlot</code></td>
<td>
<p>A list specifying the P-Spline model at the plant level.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_offset">offset</code></td>
<td>
<p>A character string indicating the column in the data with
an a priori known component to be included in the linear predictor during
fitting. By default, when <code>offset = NULL</code>, the offset is considered to
be zero.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_family">family</code></td>
<td>
<p>An object of class <code>family</code> specifying the distribution
and link function. The default is <code>gaussian()</code>.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_maxit">maxit</code></td>
<td>
<p>An optional value that controls the maximum number of iterations
of the algorithm. The default is 200.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_trace">trace</code></td>
<td>
<p>An optional value that controls the function trace.
The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_thr">thr</code></td>
<td>
<p>An optional value that controls the convergence threshold of the
algorithm. The default is 1.e-03.</p>
</td></tr>
<tr><td><code id="fitSplineHDM_+3A_minnotp">minNoTP</code></td>
<td>
<p>The minimum number of time points for which data should be
available for a plant. Defaults to 60% of all time points present in the
TP object. No splines are fitted for plants with less than the minimum number
of timepoints.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>psHDM</code>, a list with the following outputs:
<code>time</code>, a numeric vector with the timepoints.
<code>popLevs</code>, a data.frame with the names of the populations
<code>genoLevs</code>, a factor with the names of the genotypes.
<code>plotLevs</code>, a factor with the names of the plants
<code>nPlotPop</code>, a numeric vector with the number of plants per
population.
<code>nGenoPop</code>, a numeric vector with the number of genotypes per
population.
<code>nPlotGeno</code>, a numeric vector with the number of plants per
genotype.
<code>MM</code>, a list with the design matrices at plant, genotype and
population levels.
<code>ed</code>, a numeric vector with the estimated effective dimension
(or effective degrees of freedom) for each random component of the
model (intercept, slope and non-linear trend) at each level of the
hierarchy (population, genotype and plant)
<code>tot_ed</code>, a numeric value with the sum of the effective
dimensions for all components of the model.
<code>vc</code>, a numeric vector with the (REML) variance component
estimates for each random component of the model (intercept,
slope and non-linear trend) at each level of the hierarchy
(population, genotype and plant)
<code>phi</code>, a numeric value with the error variance estimate.
<code>coeff</code>, a numeric vector with the estimated fixed and random
effect coefficients.
<code>popLevel</code>, a data.frame with the estimated population trajectories
and first and second order derivatives.
<code>genoLevel</code>, a data.frame with the estimated genotype-specific
deviations and trajectories, and their respective first and second
order derivatives.
<code>plotLevel</code>, a data.frame with the estimated plant-specific
deviations and trajectories, and their respective first and second
order derivatives.
<code>deviance</code>, the (REML) deviance at convergence.
<code>convergence</code>, a logical value indicating whether the algorithm
managed to converge before the given number of iterations.
<code>dim</code>, a numeric vector with the (model) dimension of each
model component (fixed and/or random) at each level of the
hierarchy (population, genotype, and plant).
These values correspond to the number of parameters to be estimated.
<code>family</code>, an object of class family specifying the distribution
and link function.
<code>cholHn</code>, the inverse of the variance-covariance matrix for the
coefficients.
<code>smooth</code>, a list with the information about number of segments
(nseg), degree of the B-spline basis (bdeg) and penalty order (pord)
used for the three levels of the hierarchy.
</p>


<h3>References</h3>

<p>Pérez-Valencia, D.M., Rodríguez-Álvarez, M.X., Boer, M.P. et al.
A two-stage approach for the spatio-temporal analysis of high-throughput
phenotyping data. Sci Rep 12, 3177 (2022). <a href="https://doi.org/10.1038/s41598-022-06935-9">doi:10.1038/s41598-022-06935-9</a>
</p>


<h3>See Also</h3>

<p>Other functions for fitting hierarchical curve data models: 
<code><a href="#topic+plot.psHDM">plot.psHDM</a>()</code>,
<code><a href="#topic+predict.psHDM">predict.psHDM</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.
head(spatCorrectedArch)
ggplot2::ggplot(data = spatCorrectedArch,
                ggplot2::aes(x= timeNumber, y = LeafArea_corr, group = plotId)) +
  ggplot2::geom_line(na.rm = TRUE) +
  ggplot2::facet_grid(~geno.decomp)

## We need to specify the genotype-by-treatment interaction.
## Treatment: water regime (WW, WD).
spatCorrectedArch[["treat"]] &lt;- substr(spatCorrectedArch[["geno.decomp"]],
                                      start = 1, stop = 2)
spatCorrectedArch[["genoTreat"]] &lt;-
  interaction(spatCorrectedArch[["genotype"]],
             spatCorrectedArch[["treat"]], sep = "_")

## Fit P-Splines Hierarchical Curve Data Model for selection of genotypes.
fit.psHDM  &lt;- fitSplineHDM(inDat = spatCorrectedArch,
                          trait = "LeafArea_corr",
                          useTimeNumber = TRUE,
                          timeNumber = "timeNumber",
                          genotypes = c("GenoA14_WD", "GenoA51_WD",
                                       "GenoB11_WW", "GenoB02_WD",
                                       "GenoB02_WW"),
                          pop = "geno.decomp",
                          genotype = "genoTreat",
                          plotId = "plotId",
                          weights = "wt",
                          difVar = list(geno = FALSE, plot = FALSE),
                          smoothPop = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothGeno = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothPlot = list(nseg = 4, bdeg = 3, pord = 2),
                          trace = FALSE)

## Visualize the data.frames with predicted values at the three levels of
## the hierarchy.

# Population level
head(fit.psHDM$popLevel)

# Genotype level
head(fit.psHDM$genoLevel)

# Plot level
head(fit.psHDM$plotLevel)

</code></pre>

<hr>
<h2 id='getCorrected'>Extract corrected phenotypic values</h2><span id='topic+getCorrected'></span>

<h3>Description</h3>

<p>Extract corrected phenotypic values from an object of class fitMod. After
fitting a spatial model at each time point, the raw phenotypic data is
corrected by subtracting the (estimated) sources of variation (environmental,
design  effect) that are of no interest (nuisances). This allows keeping
the data resolution at the plot/plant level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCorrected(fitMod, timePoints = names(fitMod), outFile = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCorrected_+3A_fitmod">fitMod</code></td>
<td>
<p>An object of class <code>fitMod</code>.</p>
</td></tr>
<tr><td><code id="getCorrected_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time point(s)
for which the corrected values should be extracted. When using a character
string to reference a time point, the value has to be an exact match to one
of the existing time points. When using a number it will be matched by its
number (&quot;timeNumber&quot;) in the timePoints attribute of the TP object.</p>
</td></tr>
<tr><td><code id="getCorrected_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .csv file to which the
results should be written. If <code>NULL</code> no file is written.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with spatially corrected values per time point.
</p>


<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code><a href="#topic+fitModels">fitModels</a>()</code>,
<code><a href="#topic+getEffDims">getEffDims</a>()</code>,
<code><a href="#topic+getGenoPred">getGenoPred</a>()</code>,
<code><a href="#topic+getHerit">getHerit</a>()</code>,
<code><a href="#topic+getVar">getVar</a>()</code>,
<code><a href="#topic+plot.fitMod">plot.fitMod</a>()</code>,
<code><a href="#topic+summary.fitMod">summary.fitMod</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Using the first example dataset (PhenovatorDat1).
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Fit a SpATS model on few time points.
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(1, 6, 20))

## Extract the corrected values for one time point:
spatCorrSp &lt;- getCorrected(modPhenoSp,
                           timePoints = 6)
head(spatCorrSp)


</code></pre>

<hr>
<h2 id='getEffDims'>Extract effective dimensions</h2><span id='topic+getEffDims'></span>

<h3>Description</h3>

<p>Extract effective dimensions from an object of class fitMod.
The table below gives an overview of the effective dimensions and an
explanation of their meaning.</p>

<table>
<tr>
 <td style="text-align: left;">
   Effective Dimension </td><td style="text-align: left;"> Explanation </td>
</tr>
<tr>
 <td style="text-align: left;">
   colId </td><td style="text-align: left;"> Linear trend along columns </td>
</tr>
<tr>
 <td style="text-align: left;">
   rowId </td><td style="text-align: left;"> Linear trend along rows </td>
</tr>
<tr>
 <td style="text-align: left;">
   fCol </td><td style="text-align: left;"> Smooth trend along columns </td>
</tr>
<tr>
 <td style="text-align: left;">
   fRow </td><td style="text-align: left;"> Smooth trend along rows </td>
</tr>
<tr>
 <td style="text-align: left;">
   fColRow </td><td style="text-align: left;"> Linear trend in rows changing smoothly along cols </td>
</tr>
<tr>
 <td style="text-align: left;">
   colfRow </td><td style="text-align: left;"> Linear trend in cols changing smoothly along rows </td>
</tr>
<tr>
 <td style="text-align: left;">
   fColfRow </td><td style="text-align: left;"> Smooth-by-smooth interaction trend over rows and cols </td>
</tr>
<tr>
 <td style="text-align: left;">
   surface </td><td style="text-align: left;"> Sum of smooth trends </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>getEffDims(
  fitMod,
  timePoints = names(fitMod),
  EDType = c("dimension", "ratio"),
  outFile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getEffDims_+3A_fitmod">fitMod</code></td>
<td>
<p>An object of class <code>fitMod</code>.</p>
</td></tr>
<tr><td><code id="getEffDims_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time point(s)
for which the effective dimension should be extracted. When using a character
string to reference a time point, the value has to be an exact match to one
of the existing time points. When using a number it will be matched by its
number (&quot;timeNumber&quot;) in the timePoints attribute of the TP object.</p>
</td></tr>
<tr><td><code id="getEffDims_+3A_edtype">EDType</code></td>
<td>
<p>A character string specifying if the effective dimension
(&quot;dimension&quot;) or the ratio of effective dimensions (&quot;ratio&quot;) should be
returned.</p>
</td></tr>
<tr><td><code id="getEffDims_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .csv file to which the
results should be written. If <code>NULL</code> no file is written.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with effective dimensions per time point.
</p>


<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code><a href="#topic+fitModels">fitModels</a>()</code>,
<code><a href="#topic+getCorrected">getCorrected</a>()</code>,
<code><a href="#topic+getGenoPred">getGenoPred</a>()</code>,
<code><a href="#topic+getHerit">getHerit</a>()</code>,
<code><a href="#topic+getVar">getVar</a>()</code>,
<code><a href="#topic+plot.fitMod">plot.fitMod</a>()</code>,
<code><a href="#topic+summary.fitMod">summary.fitMod</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Using the first example dataset (PhenovatorDat1):
data("PhenovatorDat1")
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Fit a SpATS model on few time points:
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(1, 6, 20))

## Extract the effective dimensions for all available time points in the
## model object:
effDimSp &lt;- getEffDims(modPhenoSp)


</code></pre>

<hr>
<h2 id='getGenoPred'>Extract predicted genotypic values</h2><span id='topic+getGenoPred'></span>

<h3>Description</h3>

<p>Extract predictions of the genotypic value from an object of class
<code>fitMod</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getGenoPred(
  fitMod,
  timePoints = names(fitMod),
  predictChecks = FALSE,
  outFile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getGenoPred_+3A_fitmod">fitMod</code></td>
<td>
<p>An object of class <code>fitMod</code>.</p>
</td></tr>
<tr><td><code id="getGenoPred_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time point(s)
for which the predictions should be extracted. When using a character string
to reference a time point, the value has to be an exact match to one of the
existing time points. When using a number it will be matched by its number
(&quot;timeNumber&quot;) in the timePoints attribute of the TP object.</p>
</td></tr>
<tr><td><code id="getGenoPred_+3A_predictchecks">predictChecks</code></td>
<td>
<p>Should predictions of the check genotypes be included
in the ouptut. If <code>TRUE</code> a list of two <code>data.frames</code> is returned
from the function, one with the predictions for the regular genotypes and
one with the predictions for the checks.</p>
</td></tr>
<tr><td><code id="getGenoPred_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .csv file to which the
results should be written. If <code>NULL</code> no file is written.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two data.frames with predicted genotypic values per time
point. <code>genoPred</code> with the predicted values for the genotypes and
<code>checkPred</code> with the predicted values for the checks. If
<code>predictChecks = FALSE</code> the latter will be <code>NULL</code>.
</p>


<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code><a href="#topic+fitModels">fitModels</a>()</code>,
<code><a href="#topic+getCorrected">getCorrected</a>()</code>,
<code><a href="#topic+getEffDims">getEffDims</a>()</code>,
<code><a href="#topic+getHerit">getHerit</a>()</code>,
<code><a href="#topic+getVar">getVar</a>()</code>,
<code><a href="#topic+plot.fitMod">plot.fitMod</a>()</code>,
<code><a href="#topic+summary.fitMod">summary.fitMod</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using the first example dataset (PhenovatorDat1).

phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Fit a SpATS model on few time points.
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(1, 6, 20))

## Extract the genotypic predictions for one time point:
genoPredSp &lt;- getGenoPred(modPhenoSp,
                          timePoints = 6)
head(genoPredSp)


</code></pre>

<hr>
<h2 id='getHerit'>Extract heritabilities</h2><span id='topic+getHerit'></span>

<h3>Description</h3>

<p>Extract heritabilities from an object of class fitMod. When
<code>geno.decomp</code> is used, the heritabilities of each level
of geno.decomp are stored in separate columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHerit(fitMod, timePoints = names(fitMod), outFile = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getHerit_+3A_fitmod">fitMod</code></td>
<td>
<p>An object of class <code>fitMod</code>.</p>
</td></tr>
<tr><td><code id="getHerit_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time point(s)
for which the heritabilities should be extracted. When using a character
string to reference a time point, the value has to be an exact match to one
of the existing time points. When using a number it will be matched by its
number (&quot;timeNumber&quot;) in the timePoints attribute of the TP object.</p>
</td></tr>
<tr><td><code id="getHerit_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .csv file to which the
results should be written. If <code>NULL</code> no file is written.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with heritabilities per time point.
</p>


<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code><a href="#topic+fitModels">fitModels</a>()</code>,
<code><a href="#topic+getCorrected">getCorrected</a>()</code>,
<code><a href="#topic+getEffDims">getEffDims</a>()</code>,
<code><a href="#topic+getGenoPred">getGenoPred</a>()</code>,
<code><a href="#topic+getVar">getVar</a>()</code>,
<code><a href="#topic+plot.fitMod">plot.fitMod</a>()</code>,
<code><a href="#topic+summary.fitMod">summary.fitMod</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Using the first example dataset (PhenovatorDat1):
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Fit a SpATS model on few time points.
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(1, 6, 20))

## Extract the heritabilities for all available time points.#'
getHerit(modPhenoSp)


</code></pre>

<hr>
<h2 id='getTimePoints'>Extract time points</h2><span id='topic+getTimePoints'></span>

<h3>Description</h3>

<p>Function for extracting a data.frame with timeNumbers and timePoints from
an object of class TP or fitMod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTimePoints(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTimePoints_+3A_x">x</code></td>
<td>
<p>An object of class TP or fitMod</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with columns timeNumber and timePoint listing the
time points in x
</p>


<h3>See Also</h3>

<p>Other functions for data preparation: 
<code><a href="#topic+as.data.frame.TP">as.data.frame.TP</a>()</code>,
<code><a href="#topic+createTimePoints">createTimePoints</a>()</code>,
<code><a href="#topic+plot.TP">plot.TP</a>()</code>,
<code><a href="#topic+removeTimePoints">removeTimePoints</a>()</code>,
<code><a href="#topic+summary.TP">summary.TP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create an object of class TP.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Extract the time points from the object.
head(getTimePoints(phenoTP))

</code></pre>

<hr>
<h2 id='getVar'>Extract variances</h2><span id='topic+getVar'></span>

<h3>Description</h3>

<p>Extract variances from an object of class fitMod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVar(fitMod, timePoints = names(fitMod), outFile = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getVar_+3A_fitmod">fitMod</code></td>
<td>
<p>An object of class <code>fitMod</code>.</p>
</td></tr>
<tr><td><code id="getVar_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time point(s)
for which the variances should be extracted. When using a character
string to reference a time point, the value has to be an exact match to one
of the existing time points. When using a number it will be matched by its
number (&quot;timeNumber&quot;) in the timePoints attribute of the TP object.</p>
</td></tr>
<tr><td><code id="getVar_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .csv file to which the
results should be written. If <code>NULL</code> no file is written.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with variances per time point.
</p>


<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code><a href="#topic+fitModels">fitModels</a>()</code>,
<code><a href="#topic+getCorrected">getCorrected</a>()</code>,
<code><a href="#topic+getEffDims">getEffDims</a>()</code>,
<code><a href="#topic+getGenoPred">getGenoPred</a>()</code>,
<code><a href="#topic+getHerit">getHerit</a>()</code>,
<code><a href="#topic+plot.fitMod">plot.fitMod</a>()</code>,
<code><a href="#topic+summary.fitMod">summary.fitMod</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Using the first example dataset (PhenovatorDat1):
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Fit a SpATS model on few time points.
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(1, 6, 20))

## Extract the variances for all available time points.
getVar(modPhenoSp)


</code></pre>

<hr>
<h2 id='noCorrectedRoot'>Root data corrected for outliers for single observations.</h2><span id='topic+noCorrectedRoot'></span>

<h3>Description</h3>

<p>This dataset contains the corrected data obtained by removing outliers for
single observations on the RootDat1 dataset. See the vignettes for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noCorrectedRoot
</code></pre>


<h3>Format</h3>

<p>A data.frame with 15,934 rows and 8 columns:
</p>

<dl>
<dt>timePoint</dt><dd><p>Original time points, date and time</p>
</dd>
<dt>Date</dt><dd><p>Date</p>
</dd>
<dt>thermalTime</dt><dd><p>Thermal time cumulated</p>
</dd>
<dt>Exp</dt><dd><p>Experiment number</p>
</dd>
<dt>genotype</dt><dd><p>Genotypes</p>
</dd>
<dt>Tank</dt><dd><p>Tank in the greenhouse</p>
</dd>
<dt>plotId</dt><dd><p>Unique pot ID using rowcol coordinates</p>
</dd>
<dt>rowId</dt><dd><p>Row coordinate</p>
</dd>
<dt>colId</dt><dd><p>Column coordinate</p>
</dd>
<dt>tipPos_y</dt><dd><p>Position of the root tip in y axis</p>
</dd>
</dl>


<hr>
<h2 id='PhenoarchDat1'>Greenhouse data for a maize experiment in the PhenoArch platform.</h2><span id='topic+PhenoarchDat1'></span>

<h3>Description</h3>

<p>A dataset containing data from a greenhouse experiment with maize in the
Phenoarch platform (INRAE, France, Cabrera-Bosquet et al. 2016). It consists
of one experiment with 1,671 plants grown in a greenhouse under two water
scenarios, well-watered (WW) and water deficit (WD). There are two
populations of genotypes, panel 1 and panel 2. Panel 1 contains 60 genotypes
with 14 replicates: 7 in WW and 7 in WD. Panel 2 contains 30
genotypes with 8 replicates, 4 in WW and 4 in WD. The studied trait is the
leaf area extracted from the pictures over time (LeafArea).
Plants were pictured every day for 33 days. This dataset was kindly
provided by Llorenç Cabrera-Bosquet and Claude Welcker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PhenoarchDat1
</code></pre>


<h3>Format</h3>

<p>A data.frame with 42,536 rows and 14 columns:
</p>

<dl>
<dt>Date</dt><dd><p>Date of measurement</p>
</dd>
<dt>pos</dt><dd><p>Unique pot using rowcol coordinate</p>
</dd>
<dt>Genotype</dt><dd><p>Genotype</p>
</dd>
<dt>Scenario</dt><dd><p>Water regime, WW or WD</p>
</dd>
<dt>population</dt><dd><p>Panel 1 or 2</p>
</dd>
<dt>Row</dt><dd><p>Pot position on the conveyor belt (i.e. row coordinate)</p>
</dd>
<dt>Col</dt><dd><p>Line of conveyor belt (i.e. column coordinate)</p>
</dd>
<dt>Biomass</dt><dd><p>Biomass from the picture</p>
</dd>
<dt>LeafArea</dt><dd><p>Leaf area from the picture</p>
</dd>
<dt>PlantHeight</dt><dd><p>Plant height from the picture</p>
</dd>
<dt>LeafCount</dt><dd><p>Number of leaves manually scored</p>
</dd>
<dt>phyllocron</dt><dd><p>Leaf emission rate</p>
</dd>
</dl>



<h3>References</h3>

<p>Cabrera-Bosquet, Llorenç, Fournier Christian, Brichet Nicolas,
Welcker Claude, Suard Benoît, and Tardieu François. 2016.
“High-throughput estimation of incident light, light interception and
radiation-use efficiency of thousands of plants in a phenotyping platform.”
New Phytologist 212 (1): 269-81.
<a href="https://doi.org/10.1111/nph.14027">doi:10.1111/nph.14027</a>
</p>

<hr>
<h2 id='PhenovatorDat1'>Growth chamber data for an Arabidopsis experiment in the Phenovator platform.</h2><span id='topic+PhenovatorDat1'></span>

<h3>Description</h3>

<p>A dataset containing data from a growth chamber experiment with Arabidopsis
in the Phenovator platform (WUR, Netherlands, Flood et al. 2016). It consists
of one experiment with 1,440 plants grown in a growth chamber. The number of
tested genotypes is 192 with 6 to 7 replicates per genotype. Four reference
genotypes were also tested with 15 or 30 replicates. The studied trait is
the photosystem II efficiency (EffpsII) extracted from the pictures over
time (van Rooijen et al. 2017). This dataset was kindly provided by René Boesten
and Mark Aarts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PhenovatorDat1
</code></pre>


<h3>Format</h3>

<p>A data.frame with 103,839 rows and 10 columns:
</p>

<dl>
<dt>Genotype</dt><dd><p>Genotypes</p>
</dd>
<dt>Basin</dt><dd><p>Table of experiment</p>
</dd>
<dt>Replicate</dt><dd><p>Block define after sowing for post-blocking. They are not
full-resolvable blocks.</p>
</dd>
<dt>Image_pos</dt><dd><p>Position of the camera</p>
</dd>
<dt>x</dt><dd><p>Row coordinate</p>
</dd>
<dt>y</dt><dd><p>Column coordinate</p>
</dd>
<dt>Sowing_Position</dt><dd><p>Unique pot ID</p>
</dd>
<dt>timepoints</dt><dd><p>time of picture</p>
</dd>
<dt>EffpsII</dt><dd><p>Efficiency of the photosystem II</p>
</dd>
<dt>pos</dt><dd><p>Unique pot ID using rowcol coordinates</p>
</dd>
</dl>



<h3>References</h3>

<p>Rooijen, Roxanne van, Willem Kruijer, René Boesten,
Fred A. van Eeuwijk, Jeremy Harbinson, and Mark G. M. Aarts. 2017.
“Natural Variation of YELLOW SEEDLING1 Affects Photosynthetic Acclimation
of Arabidopsis Thaliana.” Nature Communications 8 (1).
<a href="https://doi.org/10.1038/s41467-017-01576-3">doi:10.1038/s41467-017-01576-3</a>
</p>
<p>Flood, Pádraic J., Willem Kruijer, Sabine K. Schnabel, Rob van der Schoor,
Henk Jalink, Jan F. H. Snel, Jeremy Harbinson, and Mark G. M. Aarts. 2016.
“Phenomics for Photosynthesis, Growth and Reflectance in Arabidopsis
Thaliana Reveals Circadian and Long-Term Fluctuations in Heritability.”
Plant Methods 12 (1): 14.
<a href="https://doi.org/10.1186/s13007-016-0113-y">doi:10.1186/s13007-016-0113-y</a>
</p>

<hr>
<h2 id='plot.fitMod'>Plot function for class fitMod</h2><span id='topic+plot.fitMod'></span>

<h3>Description</h3>

<p>Plotting function for objects of class <code>fitMod</code>. Seven different types
of plots can be made for an object of class <code>fitMod</code>. A detailed
description and optional extra parameters for the different plots is given
in the sections below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitMod'
plot(
  x,
  ...,
  plotType = c("rawPred", "corrPred", "herit", "effDim", "variance", "timeLapse",
    "spatial"),
  timePoints = names(x),
  title = NULL,
  output = TRUE,
  outFile = NULL,
  outFileOpts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.fitMod_+3A_x">x</code></td>
<td>
<p>An object of class fitMod.</p>
</td></tr>
<tr><td><code id="plot.fitMod_+3A_...">...</code></td>
<td>
<p>Extra plot options. Described per plotType in their respective
section.</p>
</td></tr>
<tr><td><code id="plot.fitMod_+3A_plottype">plotType</code></td>
<td>
<p>A single character string indicating which plot should be
made. See the sections below for a detailed explanation of the plots.</p>
</td></tr>
<tr><td><code id="plot.fitMod_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time points
to be plotted. When using a character string to reference a time point, the
value has to be an exact match to one of the existing timePoints. When using
a number it will be matched by its number (&quot;timeNumber&quot;) in the timePoints
attribute of the TP object.</p>
</td></tr>
<tr><td><code id="plot.fitMod_+3A_title">title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td></tr>
<tr><td><code id="plot.fitMod_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td></tr>
<tr><td><code id="plot.fitMod_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .pdf file or .gif file
(for <code>plotType</code> = &quot;timeLapse&quot;) to which the plots should be written.</p>
</td></tr>
<tr><td><code id="plot.fitMod_+3A_outfileopts">outFileOpts</code></td>
<td>
<p>A named list of extra options for the pdf outfile, e.g.
width and height. See <code><a href="grDevices.html#topic+pdf">pdf</a></code> for all possible options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the plot type either a ggplot object or a list of
ggplot objects is invisibly returned.
</p>


<h3>rawPred plot</h3>

<p>Plots the raw data (colored dots) overlayed with the predicted values from
the fitted model (black dots). For each genotype a plot is made per
plot/plant over time. These plots are put together in a 5x5 grid. By using
the parameter <code>genotypes</code> a selection of genotypes can be plotted.
Extra parameter options:
</p>

<dl>
<dt>genotypes</dt><dd><p>A character vector indicating the genotypes to be plotted.</p>
</dd>
<dt>plotChecks</dt><dd><p>Should the check genotypes be included in the plot?</p>
</dd>
<dt>plotLine</dt><dd><p>Should the data be displayed as lines? Default is
<code>FALSE</code>.</p>
</dd>
</dl>



<h3>corrPred plot</h3>

<p>Plots the spatially corrected data (colored dots) overlayed with the
predicted values from the fitted model (black dors). For each genotype a plot
is made per plot/plant over time. These plots are put together in a 5x5 grid.
By using the parameter <code>genotypes</code> a selection of genotypes can be
plotted. Extra parameter options:
</p>

<dl>
<dt>genotypes</dt><dd><p>A character vector indicating the genotypes to be plotted.</p>
</dd>
<dt>plotChecks</dt><dd><p>Should the check genotypes be included in the plot?</p>
</dd>
<dt>plotLine</dt><dd><p>Should the data be displayed as lines? Default is
<code>FALSE</code>.</p>
</dd>
</dl>



<h3>herit plot</h3>

<p>Plots the heritability over time. This plot is only available when genotype
is fitted as random factor in the model. If <code>geno.decomp</code> is used when
fitting the model, heritabilities are plotted for each level of geno.decomp
in a single plot. Extra parameter options:
</p>

<dl>
<dt>yLim</dt><dd><p>A numerical vector of length two, used for setting the limits of
the y-axis of the plot. If values outside of the plotting range are given,
then these are ignored.</p>
</dd>
</dl>



<h3>effDim plot</h3>

<p>Plots the effective dimension over time for models fitted using SpATS.
Extra parameter options:
</p>

<dl>
<dt>whichED</dt><dd><p>A character vector indicating which effective dimensions
should be plotted. This should be a subset of &quot;colId&quot;, &quot;rowId&quot;, &quot;fCol&quot;,
&quot;fRow&quot;, &quot;fColRow&quot;, &quot;colfRow&quot;, &quot;fColfRow&quot; and &quot;surface&quot;. When
<code>useRepId = TRUE</code>, the effective dimensions of &quot;colId&quot; and &quot;rowId&quot;
become &quot;RepId:colId&quot; and &quot;RepId:rowId&quot;. Default all effective dimensions
are plotted.</p>
</dd>
<dt>EDType</dt><dd><p>A character string specifying if the effective dimension
(&quot;dimension&quot;) or the ratio of effective dimensions (&quot;ratio&quot;) should be
plotted. Default the dimensions are plotted.</p>
</dd>
<dt>yLim</dt><dd><p>A numerical vector of length two, used for setting the limits of
the y-axis of the plot. If values outside of the plotting range are given,
then these are ignored.</p>
</dd>
</dl>



<h3>variance plot</h3>

<p>Plots the residual, column and row variances over time for the fitted models.
Extra parameter options:
</p>

<dl>
<dt>yLim</dt><dd><p>A numerical vector of length two, used for setting the limits of
the y-axis of the plot. If values outside of the plotting range are given,
then these are ignored.</p>
</dd>
</dl>



<h3>timeLapse plot</h3>

<p>Creates a time lapse of the spatial trends of models fitted using SpATS over
time.
</p>


<h3>spatial plot</h3>

<p>Creates five plots per time point, spatial plots of the raw data,
fitted values, residuals and either BLUEs or BLUPs, and a histogram of the
BLUEs or BLUPs. When SpATS was used for modeling an extra plot with the
fitted spatial trend is included Extra parameter options:
</p>

<dl>
<dt>spaTrend</dt><dd><p>A character string indicating how the spatial trend should
be displayed. Either &quot;raw&quot; for raw values, or &quot;percentage&quot; for displaying
as a percentage of the original phenotypic values.</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code><a href="#topic+fitModels">fitModels</a>()</code>,
<code><a href="#topic+getCorrected">getCorrected</a>()</code>,
<code><a href="#topic+getEffDims">getEffDims</a>()</code>,
<code><a href="#topic+getGenoPred">getGenoPred</a>()</code>,
<code><a href="#topic+getHerit">getHerit</a>()</code>,
<code><a href="#topic+getVar">getVar</a>()</code>,
<code><a href="#topic+summary.fitMod">summary.fitMod</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Using the first example dataset (PhenovatorDat1):
## Create an object of class TP.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Fit a SpATS model on three points:
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(1, 6, 36))

## Plot the spatial trends for one time point:
plot(modPhenoSp,
     timePoints = 36,
     plotType = "spatial",
     spaTrend = "percentage")


## Not run: 
## Create a time lapse of all available time points:
plot(modPhenoSp,
     plotType = "timeLapse",
     outFile = "TimeLapse_modPhenoSp.gif")

## End(Not run)


## Plot the corrected values for a subset of four genotypes:
plot(modPhenoSp,
     plotType = "corrPred",
     genotypes = c("check1", "check2", "G007", "G058") )

## Plot the effective dimensions of all available time points in the model
## for a subset of effective dimensions:
plot(modPhenoSp,
     plotType = "effDim",
     whichED = c("colId", "rowId", "fColRow","colfRow"),
     EDType = "ratio")


</code></pre>

<hr>
<h2 id='plot.HTPSpline'>Plot the results of a fitted spline.</h2><span id='topic+plot.HTPSpline'></span>

<h3>Description</h3>

<p>Plot the results of a fitted spline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HTPSpline'
plot(
  x,
  ...,
  plotType = c("predictions", "derivatives", "derivatives2"),
  genotypes = NULL,
  plotIds = NULL,
  title = NULL,
  output = TRUE,
  outFile = NULL,
  outFileOpts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.HTPSpline_+3A_x">x</code></td>
<td>
<p>An object of class <code>HTPSpline</code>.</p>
</td></tr>
<tr><td><code id="plot.HTPSpline_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="plot.HTPSpline_+3A_plottype">plotType</code></td>
<td>
<p>A character string indicating which spline component
should be plotted, either predictions, derivatives or second derivatives
(&quot;derivatives2&quot;).</p>
</td></tr>
<tr><td><code id="plot.HTPSpline_+3A_genotypes">genotypes</code></td>
<td>
<p>A character vector indicating the genotypes for which
spline components should be plotted.</p>
</td></tr>
<tr><td><code id="plot.HTPSpline_+3A_plotids">plotIds</code></td>
<td>
<p>A character vector indicating the plotIds for which spline
components should be plotted.</p>
</td></tr>
<tr><td><code id="plot.HTPSpline_+3A_title">title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td></tr>
<tr><td><code id="plot.HTPSpline_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td></tr>
<tr><td><code id="plot.HTPSpline_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .pdf file to which the
plots should be written. If <code>NULL</code>, no file is written.</p>
</td></tr>
<tr><td><code id="plot.HTPSpline_+3A_outfileopts">outFileOpts</code></td>
<td>
<p>A named list of extra options for the pdf outfile, e.g.
width and height. See <code><a href="grDevices.html#topic+pdf">pdf</a></code> for all possible options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of object of class ggplot is invisibly returned.
</p>


<h3>See Also</h3>

<p>Other functions for fitting splines: 
<code><a href="#topic+fitSpline">fitSpline</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## Fit P-Splines on a subset of genotypes
subGeno &lt;- c("G070", "G160")
fit.spline &lt;- fitSpline(inDat = spatCorrectedVator,
                        trait = "EffpsII_corr",
                        genotypes = subGeno,
                        knots = 50)

## Visualize the P-Spline predictions for one genotype.
plot(fit.spline, genotypes = "G160")

## Visualize the first and second derivatives of the predictions for one plant.
plot(fit.spline, plotIds = "c10r29", plotType =  "derivatives")
plot(fit.spline, plotIds = "c10r29", plotType =  "derivatives2")

</code></pre>

<hr>
<h2 id='plot.psHDM'>Plot function for class psHDM</h2><span id='topic+plot.psHDM'></span>

<h3>Description</h3>

<p>This plot function provides five plots for objects of the class <code>psHDM</code>
after fitting (<code><a href="#topic+fitSplineHDM">fitSplineHDM</a></code>) or predicting
(<code><a href="#topic+predict.psHDM">predict.psHDM</a></code>): (1) Population-specific growth curves (popTra),
(2) Population and genotype-specific growth curves (for all genotypes, popGenoTra),
(3) First-order derivative of the population and genotype-specific growth curves
(for all genotypes, popGenoDeriv), (4) Genotype-specific deviations (for all
genotypes, genoDev), and (5) Genotype- and plot-specific growth curves (for a
selection of genotypes, genoPlotTra). If standard errors are available, 95% point
wise confidence intervals are depicted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psHDM'
plot(
  x,
  ...,
  plotType = c("popTra", "popGenoTra", "popGenoDeriv", "genoDev", "genoPlotTra"),
  genotypes = NULL,
  genotypeNames = NULL,
  genotypeOrder = NULL,
  xlab = "Time",
  ylab = expression(tilde(y)[pgi](t)),
  title = NULL,
  themeSizeHDM = 15,
  output = TRUE,
  outFile = NULL,
  outFileOpts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.psHDM_+3A_x">x</code></td>
<td>
<p>An object of class &quot;psHDM&quot; as obtained after fitting
(<code><a href="#topic+fitSplineHDM">fitSplineHDM</a></code>) or predicting (<code><a href="#topic+predict.psHDM">predict.psHDM</a></code>),</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_plottype">plotType</code></td>
<td>
<p>A character string indicating which plot should be made.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_genotypes">genotypes</code></td>
<td>
<p>A character vector with the genotypes for which plots at
plot level are desired. Only used when <code>plotType == "genoPlotTra"</code>.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_genotypenames">genotypeNames</code></td>
<td>
<p>A character vector with alternative names for the
plotted genotypes (genotypes). If <code>NULL</code> the names of the genotypes
are used. Only used when <code>plotType == "genoPlotTra"</code>.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_genotypeorder">genotypeOrder</code></td>
<td>
<p>A vector with the order of the selected genotypes
(genotypes). If <code>NULL</code> then the order in the data is preserved.
Only used when <code>plotType == "genoPlotTra"</code>.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_xlab">xlab</code></td>
<td>
<p>The x-axis label of the plot.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_ylab">ylab</code></td>
<td>
<p>The y-axis label of the plot.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_title">title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_themesizehdm">themeSizeHDM</code></td>
<td>
<p>Reference size for the theme</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .pdf file to which the
plots should be written. If <code>NULL</code>, no file is written.</p>
</td></tr>
<tr><td><code id="plot.psHDM_+3A_outfileopts">outFileOpts</code></td>
<td>
<p>A named list of extra options for the pdf outfile, e.g.
width and height. See <code><a href="grDevices.html#topic+pdf">pdf</a></code> for all possible options.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pérez-Valencia, D.M., Rodríguez-Álvarez, M.X., Boer, M.P. et al.
A two-stage approach for the spatio-temporal analysis of high-throughput
phenotyping data. Sci Rep 12, 3177 (2022). <a href="https://doi.org/10.1038/s41598-022-06935-9">doi:10.1038/s41598-022-06935-9</a>
</p>


<h3>See Also</h3>

<p>Other functions for fitting hierarchical curve data models: 
<code><a href="#topic+fitSplineHDM">fitSplineHDM</a>()</code>,
<code><a href="#topic+predict.psHDM">predict.psHDM</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## We need to specify the genotype-by-treatment interaction.
## Treatment: water regime (WW, WD).
spatCorrectedArch[["treat"]] &lt;- substr(spatCorrectedArch[["geno.decomp"]],
                                      start = 1, stop = 2)
spatCorrectedArch[["genoTreat"]] &lt;-
  interaction(spatCorrectedArch[["genotype"]],
             spatCorrectedArch[["treat"]], sep = "_")

## Fit P-Splines Hierarchical Curve Data Model for selection of genotypes.
fit.psHDM  &lt;- fitSplineHDM(inDat = spatCorrectedArch,
                          trait = "LeafArea_corr",
                          genotypes = c("GenoA14_WD", "GenoA51_WD",
                                       "GenoB11_WW", "GenoB02_WD",
                                       "GenoB02_WW"),
                          time = "timeNumber",
                          pop = "geno.decomp",
                          genotype = "genoTreat",
                          plotId = "plotId",
                          difVar = list(geno = FALSE, plot = FALSE),
                          smoothPop = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothGeno = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothPlot = list(nseg = 4, bdeg = 3, pord = 2),
                          weights = "wt",
                          trace = FALSE)

## Plot the P-Spline predictions at the three levels of the hierarchy

## Population-specific growth curves.
plot(fit.psHDM,
    plotType = "popTra")

## Population and genotype-specific growth curves.
plot(fit.psHDM,
    plotType = "popGenoTra")

## First-order derivative of the population- and genotype-specific growth curves.
plot(fit.psHDM,
    plotType = "popGenoDeriv")

## Genotype-specific deviations.
plot(fit.psHDM,
    plotType = "genoDev")

## Genotype- and plot-specific growth curves.
plot(fit.psHDM,
    plotType = "genoPlotTra")

</code></pre>

<hr>
<h2 id='plot.serieOut'>Plot outliers for series of observations</h2><span id='topic+plot.serieOut'></span>

<h3>Description</h3>

<p>Plot the fitted spline, correlation matrix and PCA biplot for each of the
genotypes. Outlying series of observations are shown as filled dots in the
fitted spline plot, other observations are shown as open dots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'serieOut'
plot(
  x,
  ...,
  reason = c("mean corr", "angle", "slope"),
  genotypes = NULL,
  geno.decomp = NULL,
  useTimeNumber = FALSE,
  timeNumber = NULL,
  title = NULL,
  output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.serieOut_+3A_x">x</code></td>
<td>
<p>An object of class <code>serieOut</code>.</p>
</td></tr>
<tr><td><code id="plot.serieOut_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="plot.serieOut_+3A_reason">reason</code></td>
<td>
<p>A character vector indicating which types of outliers should
be plotted.</p>
</td></tr>
<tr><td><code id="plot.serieOut_+3A_genotypes">genotypes</code></td>
<td>
<p>A character vector indicating which genotypes should be
plotted. If <code>NULL</code> all genotypes are plotted.</p>
</td></tr>
<tr><td><code id="plot.serieOut_+3A_geno.decomp">geno.decomp</code></td>
<td>
<p>A character vector indicating which levels of
<code>geno.decomp</code> should be plotted. If <code>NULL</code> all levels are plotted.
Ignored if <code>geno.decomp</code> was not used when fitting models.</p>
</td></tr>
<tr><td><code id="plot.serieOut_+3A_usetimenumber">useTimeNumber</code></td>
<td>
<p>Should the timeNumber be used instead of the timePoint
in the labels on the x-axis?</p>
</td></tr>
<tr><td><code id="plot.serieOut_+3A_timenumber">timeNumber</code></td>
<td>
<p>If <code>useTimeNumber = TRUE</code>, a character vector
indicating the column containing the numerical time to use.</p>
</td></tr>
<tr><td><code id="plot.serieOut_+3A_title">title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td></tr>
<tr><td><code id="plot.serieOut_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of ggplot objects is invisibly returned.
</p>


<h3>See Also</h3>

<p>Other functions for detecting outliers for series of observations: 
<code><a href="#topic+detectSerieOut">detectSerieOut</a>()</code>,
<code><a href="#topic+removeSerieOut">removeSerieOut</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## Fit P-splines on a subset of genotypes
subGenoVator &lt;- c("G160", "G151")
fit.spline &lt;- fitSpline(inDat = spatCorrectedVator,
                        trait = "EffpsII_corr",
                        genotypes = subGenoVator,
                        knots = 50)

## Extract the data.frames with predicted values and P-Spline coefficients.
predDat &lt;- fit.spline$predDat
coefDat &lt;- fit.spline$coefDat

## The coefficients are then used to tag suspect time courses.
outVator &lt;- detectSerieOut(corrDat = spatCorrectedVator,
                           predDat = predDat,
                           coefDat = coefDat,
                           trait = "EffpsII_corr",
                           genotypes = subGenoVator,
                           thrCor = 0.9,
                           thrPca = 30,
                           thrSlope = 0.7)

## The `outVator` can be visualized for selected genotypes.
plot(outVator, genotypes = "G151")

## Only visualize outliers tagged because of low correlation
## between slopes of the regression.
plot(outVator, genotypes = "G151", reason = "slope")


</code></pre>

<hr>
<h2 id='plot.singleOut'>Plot outliers for single observations</h2><span id='topic+plot.singleOut'></span>

<h3>Description</h3>

<p>Plot the fitted local regression, confidence intervals and detected outliers
for each plotId.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'singleOut'
plot(x, ..., plotIds = NULL, outOnly = TRUE, output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.singleOut_+3A_x">x</code></td>
<td>
<p>An object of class singleOut.</p>
</td></tr>
<tr><td><code id="plot.singleOut_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="plot.singleOut_+3A_plotids">plotIds</code></td>
<td>
<p>A character vector of plotIds for which the outliers should be
detected. If <code>NULL</code>, all plotIds in <code>TP</code> are used.</p>
</td></tr>
<tr><td><code id="plot.singleOut_+3A_outonly">outOnly</code></td>
<td>
<p>Should only plots containing outliers be plotted?</p>
</td></tr>
<tr><td><code id="plot.singleOut_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of ggplot objects is invisibly returned.
</p>


<h3>See Also</h3>

<p>Other functions for detecting outliers for single observations: 
<code><a href="#topic+detectSingleOut">detectSingleOut</a>()</code>,
<code><a href="#topic+detectSingleOutMaize">detectSingleOutMaize</a>()</code>,
<code><a href="#topic+removeSingleOut">removeSingleOut</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
PhenovatorDat1 &lt;- PhenovatorDat1[!PhenovatorDat1$pos %in%
                                 c("c24r41", "c7r18", "c7r49"), ]
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Select a subset of plants, for example here 9 plants.
plantSel &lt;- phenoTP[[1]]$plotId[1:9]
# Then run on the subset.
resuVatorHTP &lt;- detectSingleOut(TP = phenoTP,
                               trait = "EffpsII",
                               plotIds = plantSel,
                               confIntSize = 3,
                               nnLocfit = 0.1)

## Visualize the prediction by choosing a single plant...
plot(resuVatorHTP, plotIds = "c21r24", outOnly = FALSE)
## ...or a subset of plants.
plot(resuVatorHTP, plotIds = plantSel, outOnly = FALSE)

</code></pre>

<hr>
<h2 id='plot.splineEst'>Plot the results of estimated spline parameters.</h2><span id='topic+plot.splineEst'></span>

<h3>Description</h3>

<p>Plot the results of estimated spline parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'splineEst'
plot(
  x,
  ...,
  plotType = c("box", "hist"),
  what = attr(x, "what"),
  title = NULL,
  output = TRUE,
  outFile = NULL,
  outFileOpts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.splineEst_+3A_x">x</code></td>
<td>
<p>An object of class <code>splineEst</code></p>
</td></tr>
<tr><td><code id="plot.splineEst_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="plot.splineEst_+3A_plottype">plotType</code></td>
<td>
<p>A character string indicating the type of plot to be made.</p>
</td></tr>
<tr><td><code id="plot.splineEst_+3A_what">what</code></td>
<td>
<p>The types of estimate that should be plotted.</p>
</td></tr>
<tr><td><code id="plot.splineEst_+3A_title">title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td></tr>
<tr><td><code id="plot.splineEst_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td></tr>
<tr><td><code id="plot.splineEst_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .pdf file to which the
plots should be written. If <code>NULL</code>, no file is written.</p>
</td></tr>
<tr><td><code id="plot.splineEst_+3A_outfileopts">outFileOpts</code></td>
<td>
<p>A named list of extra options for the pdf outfile, e.g.
width and height. See <code><a href="grDevices.html#topic+pdf">pdf</a></code> for all possible options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects of class ggplot is invisibly returned.
</p>


<h3>See Also</h3>

<p>Other functions for spline parameter estimation: 
<code><a href="#topic+estimateSplineParameters">estimateSplineParameters</a>()</code>
</p>

<hr>
<h2 id='plot.TP'>Plot function for class TP</h2><span id='topic+plot.TP'></span>

<h3>Description</h3>

<p>Plotting function for objects of class TP. Plots the layout of the platform
for different time points within the TP object. Also a boxplot can be made
for selected traits and time points and a plot of correlations
between time points. Finally the raw data can be displayed per
genotype. A detailed description and optional extra parameters for the
different plots are given in the sections below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TP'
plot(
  x,
  ...,
  plotType = c("layout", "box", "cor", "raw"),
  timePoints = names(x),
  title = NULL,
  traits = NULL,
  output = TRUE,
  outFile = NULL,
  outFileOpts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.TP_+3A_x">x</code></td>
<td>
<p>An object of class TP.</p>
</td></tr>
<tr><td><code id="plot.TP_+3A_...">...</code></td>
<td>
<p>Extra plot options. Described per plotType in their respective
section.</p>
</td></tr>
<tr><td><code id="plot.TP_+3A_plottype">plotType</code></td>
<td>
<p>A single character string indicating which plot should be
made. See the sections below for a detailed explanation of the plots.</p>
</td></tr>
<tr><td><code id="plot.TP_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time points
to be plotted. When using a character string to reference a time point, the
value has to be an exact match to one of the existing timePoints. When using
a number it will be matched by its number (&quot;timeNumber&quot;) in the timePoints
attribute of the TP object.</p>
</td></tr>
<tr><td><code id="plot.TP_+3A_title">title</code></td>
<td>
<p>A character string used as title for the plot. If <code>NULL</code> a
default title is added to the plot depending on <code>plotType</code>.</p>
</td></tr>
<tr><td><code id="plot.TP_+3A_traits">traits</code></td>
<td>
<p>A character vector indicating the traits to be plotted.
If <code>plotType</code> = &quot;layout&quot; only a single trait may be plotted. For the
other plotTypes, providing multiple traits will create multiple plots.</p>
</td></tr>
<tr><td><code id="plot.TP_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a (list of) ggplot object(s) is invisibly returned. Ignored if
<code>outFile</code> is specified.</p>
</td></tr>
<tr><td><code id="plot.TP_+3A_outfile">outFile</code></td>
<td>
<p>A character string indicating the .pdf file to which the
plots should be written. If <code>NULL</code>, no file is written.</p>
</td></tr>
<tr><td><code id="plot.TP_+3A_outfileopts">outFileOpts</code></td>
<td>
<p>A named list of extra options for the pdf outfile, e.g.
width and height. See <code><a href="grDevices.html#topic+pdf">pdf</a></code> for all possible options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the plot type, either a ggplot object or a list of
ggplot objects is invisibly returned.
</p>


<h3>Layout Plot</h3>

<p>Plots the layout of the platform for selected time points (all available time
points by  default). This plot can only be made for time points that contain
both row (<code>rowNum</code>) and column (<code>colNum</code>) information. If either
one of those is missing the timePoint is skipped with a warning.
If replicates (<code>repId</code>) are available, a black line is plotted between
diffent replicates. Missing plots are indicated in white. This can either be
single plots in a time point or complete missing columns or rows.<br />
Extra parameter options:
</p>

<dl>
<dt>showGeno</dt><dd><p>Should individual genotypes be labeled in the plot?
Defaults to <code>FALSE</code></p>
</dd>
<dt>highlight</dt><dd><p>A character vector of genotypes to be highlighted in the
plot.</p>
</dd>
</dl>



<h3>Box Plot</h3>

<p>Creates a boxplot per selected trait grouped by time point (all available
time points by  default). Extra parameter options:
</p>

<dl>
<dt>groupBy</dt><dd><p>A character string indicating a column in <code>TP</code> by which
the boxes in the plot should be grouped.
By default the boxes are grouped per time point.</p>
</dd>
<dt>colorBy</dt><dd><p>A character string indicating a column in <code>TP</code> by which
the boxes are colored. Coloring will be done within the groups indicated by
the <code>groupBy</code> parameter, e.g. per replicate within each time point
using <code>repId</code>.</p>
</dd>
<dt>orderBy</dt><dd><p>A character string indicating the way the boxes should be
ordered. Either &quot;alphabetic&quot; for alphabetical ordering of the groups,
&quot;ascending&quot; for ordering by ascending mean, or &quot;descending&quot; for ordering by
descending mean. By default boxes are ordered alphabetically.</p>
</dd>
</dl>



<h3>Correlation Plot</h3>

<p>Draws a heatmap of correlations of raw data between time points per selected
trait for selected time points (all available time points by default).
</p>


<h3>Raw data plot</h3>

<p>Create a plot of the raw data of the selected trait over time for selected
time points (all available time points by default). Plots are grouped by
genotype, or by genotype x treatment when the <code>geno.decomp</code> option is
specified. By default, all the genotypes will be plotted which might take
time and memory when the output is not saved in a file (see parameter
<code>outFile</code>). Extra parameter options:
</p>

<dl>
<dt>genotypes</dt><dd><p>A character vector indicating the genotypes to be plotted.</p>
</dd>
<dt>geno.decomp</dt><dd><p>A character vector indicating the grouping of the
genotypes to be plotted.</p>
</dd>
<dt>plotLine</dt><dd><p>Should the data be displayed as lines? Default is FALSE.</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other functions for data preparation: 
<code><a href="#topic+as.data.frame.TP">as.data.frame.TP</a>()</code>,
<code><a href="#topic+createTimePoints">createTimePoints</a>()</code>,
<code><a href="#topic+getTimePoints">getTimePoints</a>()</code>,
<code><a href="#topic+removeTimePoints">removeTimePoints</a>()</code>,
<code><a href="#topic+summary.TP">summary.TP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Create a TP object containing the data from the Phenovator.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Plot the layout for the third time point with the check genotypes
## highlighted
plot(phenoTP,
     plotType = "layout",
     timePoints = 3,
     highlight = c("check1", "check2", "check3", "check4"))

## Create a boxplot for "EffpsII" with 5 time points and boxes colored
## by "repId" within time point.
plot(phenoTP,
     plotType = "box",
     traits = "EffpsII",
     timePoints = 1:5,
     colorBy = "repId")

## Create a correlation plot for "EffpsII" for a selection of time points.
plot(phenoTP,
     plotType = "cor",
     traits = "EffpsII",
     timePoints = seq(from=1, to=73, by=5))

## Plot the raw data of four genotypes for the trait "EffpsII":
plot(phenoTP,
     traits = "EffpsII",
     plotType = "raw",
     genotypes = c("G001","G002","check1","check2"))


</code></pre>

<hr>
<h2 id='predict.psHDM'>Predict the P-Splines Hierarchical Curve Data Model</h2><span id='topic+predict.psHDM'></span>

<h3>Description</h3>

<p>Function that predicts the P-spline Hierarchical Curve Data Model (see
<code><a href="#topic+fitSplineHDM">fitSplineHDM</a></code>) on a dense grid. It provides standard errors
for curves at each level of the hierarchy. User has to be aware that
standard errors at the plot level demand large memory. We suggest set
that option at the <code>FALSE</code> level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psHDM'
predict(
  object,
  newtimes,
  pred = list(pop = TRUE, geno = TRUE, plot = TRUE),
  se = list(pop = TRUE, geno = TRUE, plot = FALSE),
  trace = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.psHDM_+3A_object">object</code></td>
<td>
<p>An object of class &quot;psHDM&quot; as obtained after fitting
(<code><a href="#topic+fitSplineHDM">fitSplineHDM</a></code>) the P-spline Hierarchical Curve Data Model</p>
</td></tr>
<tr><td><code id="predict.psHDM_+3A_newtimes">newtimes</code></td>
<td>
<p>A numeric vector with timepoints at which predictions are
desired</p>
</td></tr>
<tr><td><code id="predict.psHDM_+3A_pred">pred</code></td>
<td>
<p>A list that controls the hierarchical levels at which
predictions are desired (population/genotypes/plots).  The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict.psHDM_+3A_se">se</code></td>
<td>
<p>A list that controls the hierarchical levels at which standard
errors are desired (population/genotypes/plots).  The default is
<code>TRUE</code> except at the plot level.</p>
</td></tr>
<tr><td><code id="predict.psHDM_+3A_trace">trace</code></td>
<td>
<p>An optional value that controls the function trace.
The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict.psHDM_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>psHDM</code>, a list with the following outputs:
predict.psHDM
<code>newtimes</code> A numeric vector with the timepoints at which predictions
and/or standard errors have been obtained.
<code>popLevel</code> A data.frame with the estimated population trajectories
and first and second order derivatives, and if required their respective
standard errors, at the <code>newtimes</code>.
<code>genoLevel</code> A data.frame with the estimated genotype-specific
deviations and trajectories and their respective first and second order
derivatives, and if required their respective standard errors,
at the <code>newtimes</code>.
<code>plotLevel</code> A data.frame with the estimated plot-specific
deviations and trajectories and their respective first and second order
derivatives, and if required their respective standard errors,
at the <code>newtimes</code>.
<code>plotObs</code> A data.frame with the raw data at the original timepoints.
</p>


<h3>References</h3>

<p>Pérez-Valencia, D.M., Rodríguez-Álvarez, M.X., Boer, M.P. et al.
A two-stage approach for the spatio-temporal analysis of high-throughput
phenotyping data. Sci Rep 12, 3177 (2022). <a href="https://doi.org/10.1038/s41598-022-06935-9">doi:10.1038/s41598-022-06935-9</a>
</p>


<h3>See Also</h3>

<p>Other functions for fitting hierarchical curve data models: 
<code><a href="#topic+fitSplineHDM">fitSplineHDM</a>()</code>,
<code><a href="#topic+plot.psHDM">plot.psHDM</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The data from the Phenovator platform have been corrected for spatial
## trends and outliers for single observations have been removed.

## We need to specify the genotype-by-treatment interaction.
## Treatment: water regime (WW, WD).
spatCorrectedArch[["treat"]] &lt;- substr(spatCorrectedArch[["geno.decomp"]],
                                      start = 1, stop = 2)
spatCorrectedArch[["genoTreat"]] &lt;-
  interaction(spatCorrectedArch[["genotype"]],
             spatCorrectedArch[["treat"]], sep = "_")

## Fit P-Splines Hierarchical Curve Data Model for selection of genotypes.
fit.psHDM  &lt;- fitSplineHDM(inDat = spatCorrectedArch,
                          trait = "LeafArea_corr",
                          genotypes = c("GenoA14_WD", "GenoA51_WD",
                                       "GenoB11_WW", "GenoB02_WD",
                                       "GenoB02_WW"),
                          time = "timeNumber",
                          pop = "geno.decomp",
                          genotype = "genoTreat",
                          plotId = "plotId",
                          difVar = list(geno = FALSE, plot = FALSE),
                          smoothPop = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothGeno = list(nseg = 4, bdeg = 3, pord = 2),
                          smoothPlot = list(nseg = 4, bdeg = 3, pord = 2),
                          weights = "wt",
                          trace = FALSE)

## Predict the P-Splines Hierarchical Curve Data Model on a dense grid
## with standard errors at the population and genotype levels
pred.psHDM &lt;- predict(object = fit.psHDM,
                     newtimes = seq(min(fit.psHDM$time[["timeNumber"]]),
                                   max(fit.psHDM$time[["timeNumber"]]),
                                   length.out = 100),
                     pred = list(pop = TRUE, geno = TRUE, plot = TRUE),
                     se = list(pop = TRUE, geno = TRUE, plot = FALSE))

## Plot the P-Spline predictions at the three levels of the hierarchy

## Plots at population level.
plot(pred.psHDM,
    plotType = "popTra")

## Plots at genotype level.
plot(pred.psHDM,
    plotType = "popGenoTra")

## Plots of derivatives at genotype level.
plot(pred.psHDM,
    plotType = "popGenoDeriv")

## Plots of deviations at genotype level.
plot(pred.psHDM,
    plotType = "genoDev")

## Plots at plot level.
plot(pred.psHDM,
    plotType = "genoPlotTra")

</code></pre>

<hr>
<h2 id='removeSerieOut'>Replace outliers for series of observations by NA</h2><span id='topic+removeSerieOut'></span>

<h3>Description</h3>

<p>Function for replacing outliers for series of observations in the data by NA.
The input can either be a data.frame, specified in <code>dat</code>, or the output
of the <code>fitSpline</code> function, specified in <code>fitSpline</code>. Exactly one
of these should be provided as input for the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeSerieOut(
  dat = NULL,
  fitSpline = NULL,
  serieOut,
  reason = c("mean corr", "angle", "slope"),
  traits = attr(x = serieOut, which = "trait")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeSerieOut_+3A_dat">dat</code></td>
<td>
<p>A <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="removeSerieOut_+3A_fitspline">fitSpline</code></td>
<td>
<p>An object of class <code>HTPSpline</code>, the output of the
<code><a href="#topic+fitSpline">fitSpline</a></code> function.</p>
</td></tr>
<tr><td><code id="removeSerieOut_+3A_serieout">serieOut</code></td>
<td>
<p>A data.frame with at least the column plotId with
values corresponding to those in dat/fitSpline.</p>
</td></tr>
<tr><td><code id="removeSerieOut_+3A_reason">reason</code></td>
<td>
<p>A character vector indicating which types of outliers should
be replaced by NA.</p>
</td></tr>
<tr><td><code id="removeSerieOut_+3A_traits">traits</code></td>
<td>
<p>The traits that should be replaced by NA. When using the
output of <code>detectSerieOut</code> as input for <code>serieOut</code> this defaults
to the trait used for when detecting the outliers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the input either a <code>data.frame</code> or an object of
class <code>HTPSpline</code> for which the outliers specified in <code>serieOut</code>
are replaced by NA.
</p>


<h3>See Also</h3>

<p>Other functions for detecting outliers for series of observations: 
<code><a href="#topic+detectSerieOut">detectSerieOut</a>()</code>,
<code><a href="#topic+plot.serieOut">plot.serieOut</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Run the function to fit P-splines on a subset of genotypes.
subGenoVator &lt;- c("G160", "G151")
fit.spline &lt;- fitSpline(inDat = spatCorrectedVator,
                        trait = "EffpsII_corr",
                        genotypes = subGenoVator,
                        knots = 50)

## Extract the tables of predicted values and P-spline coefficients.
predDat &lt;- fit.spline$predDat
coefDat &lt;- fit.spline$coefDat

## The coefficients are then used to tag suspect time courses
outVator &lt;- detectSerieOut(corrDat = spatCorrectedVator,
                           predDat = predDat,
                           coefDat = coefDat,
                           trait = "EffpsII_corr",
                           genotypes = subGenoVator,
                           thrCor = 0.9,
                           thrPca = 30,
                           thrSlope = 0.7)

## Replace the outliers by NA in the corrected data.
spatCorrectedVatorOut &lt;- removeSerieOut(dat = spatCorrectedVator,
                                        serieOut = outVator)

## Only replace the slope outliers by NA in the corrected data.
spatCorrectedVatorOut2 &lt;- removeSerieOut(dat = spatCorrectedVator,
                                        serieOut = outVator,
                                        reason = "slope")

## Replace the outliers by NA in the corrected data.
## Replace both the corrected value and the raw trait value by NA.
spatCorrectedVatorOut3 &lt;-
  removeSerieOut(dat = spatCorrectedVator,
                 serieOut = outVator,
                 traits = c("EffpsII", "EffpsII_corr"))

</code></pre>

<hr>
<h2 id='removeSingleOut'>Replace outliers for single observations by NA</h2><span id='topic+removeSingleOut'></span>

<h3>Description</h3>

<p>Function for replacing outliers for single observations by NA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeSingleOut(TP, singleOut, trait = attr(x = singleOut, which = "trait"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeSingleOut_+3A_tp">TP</code></td>
<td>
<p>An object of class TP.</p>
</td></tr>
<tr><td><code id="removeSingleOut_+3A_singleout">singleOut</code></td>
<td>
<p>A data.frame with at least the columns plotId and
timePoint with values corresponding to those in TP. If a column outlier is
present, as in the output of <code>detectSingleOut</code>, only plotId x
timePoint combinations for which outlier = 1 will be set to NA. If no
column outlier is present, all observations in singleOut will be set to NA.</p>
</td></tr>
<tr><td><code id="removeSingleOut_+3A_trait">trait</code></td>
<td>
<p>The trait that should be set to NA. Can be ignored when using
the output of <code>detectSingleOut</code> as input.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class TP, the input with the outlier replaced by NA.
</p>


<h3>See Also</h3>

<p>Other functions for detecting outliers for single observations: 
<code><a href="#topic+detectSingleOut">detectSingleOut</a>()</code>,
<code><a href="#topic+detectSingleOutMaize">detectSingleOutMaize</a>()</code>,
<code><a href="#topic+plot.singleOut">plot.singleOut</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
PhenovatorDat1 &lt;- PhenovatorDat1[!PhenovatorDat1$pos %in%
                                 c("c24r41", "c7r18", "c7r49"), ]
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## First select a subset of plants, for example here 9 plants.
plantSel &lt;- phenoTP[[1]]$plotId[1:9]
# Then run on the subset
resuVatorHTP &lt;- detectSingleOut(TP = phenoTP,
                                trait = "EffpsII",
                                plotIds = plantSel,
                                confIntSize = 3,
                                nnLocfit = 0.1)

## Replace the studied trait by NA for the plants marked as outliers.
phenoTPOut &lt;- removeSingleOut(phenoTP, resuVatorHTP)

</code></pre>

<hr>
<h2 id='removeTimePoints'>Remove time points from an object of class TP</h2><span id='topic+removeTimePoints'></span>

<h3>Description</h3>

<p>Function for removing selected time points from an object of class TP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeTimePoints(TP, timePoints)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeTimePoints_+3A_tp">TP</code></td>
<td>
<p>An object of class TP.</p>
</td></tr>
<tr><td><code id="removeTimePoints_+3A_timepoints">timePoints</code></td>
<td>
<p>A character or numeric vector indicating the time points
to be removed. When using a character string to reference a time point, the
value has to be an exact match to one of the existing timePoints. When using
a number it will be matched by its number (&quot;timeNumber&quot;) in the timePoints
attribute of the TP object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class TP, the input with the selected time points
removed.
</p>


<h3>See Also</h3>

<p>Other functions for data preparation: 
<code><a href="#topic+as.data.frame.TP">as.data.frame.TP</a>()</code>,
<code><a href="#topic+createTimePoints">createTimePoints</a>()</code>,
<code><a href="#topic+getTimePoints">getTimePoints</a>()</code>,
<code><a href="#topic+plot.TP">plot.TP</a>()</code>,
<code><a href="#topic+summary.TP">summary.TP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3","check4"))
## Remove the first and last time point from the TP object.
phenoTPNew &lt;- removeTimePoints(phenoTP,
                               timePoints = c(1, 73))

## Compare by looking at summaries.
summary(phenoTP)
summary(phenoTPNew)

</code></pre>

<hr>
<h2 id='RootDat1'>Greenhouse data for an experiment in the RootPhAir platform.</h2><span id='topic+RootDat1'></span>

<h3>Description</h3>

<p>A dataset containing greenhouse data from the RootPhAir platform
(UCLouvain, Belgium). It consists of one experiment with one
aeroponic tanks with 340 maize plants. The studied traits are the root tip
coordinates in y and x axis, extracted from the pictures over time.
Plants were pictured every 2 hours for 10 days.
This dataset was kindly provided by Xavier Draye.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RootDat1
</code></pre>


<h3>Format</h3>

<p>A data.frame with 16,275 rows and 10 columns:
</p>

<dl>
<dt>Exp</dt><dd><p>Experiment number</p>
</dd>
<dt>thermalTime</dt><dd><p>Thermal time cumulated</p>
</dd>
<dt>Genotype</dt><dd><p>Genotype</p>
</dd>
<dt>plantId</dt><dd><p>Unique pot using tank and rowcol coordinate</p>
</dd>
<dt>Tank</dt><dd><p>Tank A or B</p>
</dd>
<dt>Strip</dt><dd><p>Number of strip of five plants (i.e. row coordinate)</p>
</dd>
<dt>Pos</dt><dd><p>Position within th strip (i.e. column coordinate)</p>
</dd>
<dt>tipPos_x</dt><dd><p>Position of the root tip in x axis</p>
</dd>
<dt>tipPos_y</dt><dd><p>Position of the root tip in y axis</p>
</dd>
<dt>Time</dt><dd><p>Time of measurement</p>
</dd>
</dl>


<hr>
<h2 id='spatCorrectedArch'>Maize data corrected for spatial trends.</h2><span id='topic+spatCorrectedArch'></span>

<h3>Description</h3>

<p>This dataset contains the corrected data obtained by (1) removing outliers
for single observations and (2) running a spatial model on the
PhenoarchDat1 dataset. See the vignettes for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatCorrectedArch
</code></pre>


<h3>Format</h3>

<p>A data.frame with 37,038 rows and 9 columns:
</p>

<dl>
<dt>timeNumber</dt><dd><p>Time number obtained after formatting the original
dataset with the function createTP.</p>
</dd>
<dt>timePoint</dt><dd><p>Original time point.</p>
</dd>
<dt>LeafArea_corr</dt><dd><p>Leaf area, corrected data</p>
</dd>
<dt>LeafArea</dt><dd><p>Leaf area from the picture, raw data</p>
</dd>
<dt>wt</dt><dd><p>Weight factor</p>
</dd>
<dt>genotype</dt><dd><p>Genotypes</p>
</dd>
<dt>geno.decomp</dt><dd><p>Combination of treatment levels to decompose the
genotypic variance (see vignettes)</p>
</dd>
<dt>colId</dt><dd><p>Column coordinate</p>
</dd>
<dt>rowId</dt><dd><p>Row coordinate</p>
</dd>
<dt>plotId</dt><dd><p>Unique pot ID using rowcol coordinates</p>
</dd>
</dl>


<hr>
<h2 id='spatCorrectedVator'>Arabidopsis data corrected for spatial trends.</h2><span id='topic+spatCorrectedVator'></span>

<h3>Description</h3>

<p>This dataset contains the corrected data obtained by (1) removing outliers
for single observations and (2) running a spatial model on the PhenovatorDat1
dataset. See the vignettes for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatCorrectedVator
</code></pre>


<h3>Format</h3>

<p>A data.frame with 103,801 rows and 11 columns:
</p>

<dl>
<dt>timeNumber</dt><dd><p>Time number obtained after formatting the original
dataset with the function createTP.</p>
</dd>
<dt>timePoint</dt><dd><p>Original time point.</p>
</dd>
<dt>EffpsII_corr</dt><dd><p>Efficiency of the photosystem II, corrected data</p>
</dd>
<dt>EffpsII</dt><dd><p>Efficiency of the photosystem II, raw data</p>
</dd>
<dt>genotype</dt><dd><p>Genotypes</p>
</dd>
<dt>repId</dt><dd><p>Block define after sowing for post-blocking.</p>
</dd>
<dt>Image_pos</dt><dd><p>Position of the camera</p>
</dd>
<dt>check</dt><dd><p>Status of the genotypes: check for the reference genotypes,
noCheck for the others.</p>
</dd>
<dt>colId</dt><dd><p>Column coordinate</p>
</dd>
<dt>rowId</dt><dd><p>Row coordinate</p>
</dd>
<dt>plotId</dt><dd><p>Unique pot ID using rowcol coordinates</p>
</dd>
</dl>


<hr>
<h2 id='spatPredArch'>Maize data, genotypic predictions.</h2><span id='topic+spatPredArch'></span>

<h3>Description</h3>

<p>This dataset contains the genotypic predictions obtained by (1) removing
outliers for single observations and (2) running a spatial model on the
PhenoarchDat1 dataset. See the vignettes for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatPredArch
</code></pre>


<h3>Format</h3>

<p>A data.frame with 6,120 rows and 6 columns:
</p>

<dl>
<dt>timeNumber</dt><dd><p>Time number obtained after formatting the original
dataset with the function createTP.</p>
</dd>
<dt>timePoint</dt><dd><p>Original time point.</p>
</dd>
<dt>geno.decomp</dt><dd><p>Combination of treatment levels to decompose the
genotypic variance (see vignettes)</p>
</dd>
<dt>genotype</dt><dd><p>Genotypes</p>
</dd>
<dt>predicted.values</dt><dd><p>Biomass, predicted values</p>
</dd>
<dt>standard.errors</dt><dd><p>Standard errors associated with the prediction</p>
</dd>
</dl>


<hr>
<h2 id='summary.fitMod'>Summary function for fitMod objects</h2><span id='topic+summary.fitMod'></span>

<h3>Description</h3>

<p>Function for creating a short summary of the contents of a TP object. The
summary consists of the name of the experiment, the number of time points,
the engine used to fit the models and, in case spatial models where fitted
using asreml, the selected spatial model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitMod'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.fitMod_+3A_object">object</code></td>
<td>
<p>An object of class fitMod.</p>
</td></tr>
<tr><td><code id="summary.fitMod_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, a summary is printed.
</p>


<h3>See Also</h3>

<p>Other functions for spatial modeling: 
<code><a href="#topic+fitModels">fitModels</a>()</code>,
<code><a href="#topic+getCorrected">getCorrected</a>()</code>,
<code><a href="#topic+getEffDims">getEffDims</a>()</code>,
<code><a href="#topic+getGenoPred">getGenoPred</a>()</code>,
<code><a href="#topic+getHerit">getHerit</a>()</code>,
<code><a href="#topic+getVar">getVar</a>()</code>,
<code><a href="#topic+plot.fitMod">plot.fitMod</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Using the first example dataset (PhenovatorDat1):
## Create an object of class TP.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3", "check4"))

## Fit a SpATS model on few time points:
modPhenoSp &lt;- fitModels(TP = phenoTP,
                        trait = "EffpsII",
                        timePoints = c(1, 6, 36))

## Create a summary.
summary(modPhenoSp)


</code></pre>

<hr>
<h2 id='summary.TP'>Summary function for TP objects</h2><span id='topic+summary.TP'></span>

<h3>Description</h3>

<p>Function for creating a short summary of the contents of a <code>TP</code> object.
The summary consists of the name of the experiment, the number of time
points, the first and last time point and the genotypes defined as checks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TP'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.TP_+3A_object">object</code></td>
<td>
<p>An object of class TP.</p>
</td></tr>
<tr><td><code id="summary.TP_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, a summary is printed.
</p>


<h3>See Also</h3>

<p>Other functions for data preparation: 
<code><a href="#topic+as.data.frame.TP">as.data.frame.TP</a>()</code>,
<code><a href="#topic+createTimePoints">createTimePoints</a>()</code>,
<code><a href="#topic+getTimePoints">getTimePoints</a>()</code>,
<code><a href="#topic+plot.TP">plot.TP</a>()</code>,
<code><a href="#topic+removeTimePoints">removeTimePoints</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a TP object containing the data from the Phenovator.
phenoTP &lt;- createTimePoints(dat = PhenovatorDat1,
                            experimentName = "Phenovator",
                            genotype = "Genotype",
                            timePoint = "timepoints",
                            repId = "Replicate",
                            plotId = "pos",
                            rowNum = "y", colNum = "x",
                            addCheck = TRUE,
                            checkGenotypes = c("check1", "check2",
                                               "check3","check4"))
## Create a summary.
summary(phenoTP)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
