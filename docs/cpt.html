<!DOCTYPE html><html lang="en"><head><title>Help for package cpt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cpt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cpt-package'>
<p>Classification Permutation Test</p></a></li>
<li><a href='#cpt'>
<p>Classification Permutation Test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Classification Permutation Test</td>
</tr>
<tr>
<td>Description:</td>
<td>Non-parametric test for equality of multivariate distributions.  Trains a classifier to classify (multivariate) observations as coming from one of several distributions.  If the classifier is able to classify the observations better than would be expected by chance (using permutation inference), then the null hypothesis that the distributions are equal is rejected.  </td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-10-30</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, nnet, randomForest, glmnet</td>
</tr>
<tr>
<td>Author:</td>
<td>Johann Gagnon-Bartsch &lt;johanngb@umich.edu&gt; </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Johann Gagnon-Bartsch &lt;johanngb@umich.edu&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://dept.stat.lsa.umich.edu/~johanngb">http://dept.stat.lsa.umich.edu/~johanngb</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-30 16:55:38 UTC; johanngb</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-30 17:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='cpt-package'>
Classification Permutation Test
</h2><span id='topic+cpt-package'></span>

<h3>Description</h3>

<p>Description: Non-parametric test for equality of multivariate distributions.  Trains a classifier to classify (multivariate) observations as coming from one of several distributions.  If the classifier is able to classify the observations better than would be expected by chance (using permutation inference), then the null hypothesis that the distributions are equal is rejected.  
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> cpt</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-10-30</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

 
<p>Johann Gagnon-Bartsch &lt;johanngb@umich.edu&gt; 
</p>


<h3>References</h3>

<p>The Classification Permutation Test:  A Nonparametric Test for Equality of Multivariate Distributions.  Gagnon-Bartsch and Shem-Tov, 2016.  Available at: <a href="https://arxiv.org/abs/1611.06408">https://arxiv.org/abs/1611.06408</a>.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+cpt">cpt</a></code>
</p>

<hr>
<h2 id='cpt'>
Classification Permutation Test
</h2><span id='topic+cpt'></span>

<h3>Description</h3>

<p>Non-parametric test for equality of multivariate distributions.  Trains a classifier to classify (multivariate) observations as coming from one of several distributions.  If the classifier is able to classify the observations better than would be expected by chance (using permutation inference), then the null hypothesis that the distributions are equal is rejected.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpt(Z, T, leaveout = 0, class.methods = "forest", 
    metric = "probability", ensemble.metric="mean.prob",
    paired=FALSE, perm.N = 1000, leaveout.N=100, 
    comb.methods=c(class.methods, "ensemble"), 
    comb.method="fisher")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpt_+3A_z">Z</code></td>
<td>

<p>The data.  An n by p matrix, where n is the number of observations, and p is the number of covariates.
</p>
</td></tr>
<tr><td><code id="cpt_+3A_t">T</code></td>
<td>

<p>The treatment variable.  Is converted to a factor.  
</p>
</td></tr>
<tr><td><code id="cpt_+3A_leaveout">leaveout</code></td>
<td>

<p>The number of observations from each treatment group to include in the test set.  If 0, no data is left out and the in-sample test statistic is used.  (See note below.)  If an integer greater than or equal to 1, the number of observations from each treatment group to leave out.  Values between 0 and 1 are converted to <code>ceiling(min(table(T))*leaveout</code>.
</p>
</td></tr>
<tr><td><code id="cpt_+3A_class.methods">class.methods</code></td>
<td>

<p>A character vector of the different classification methods to use.  Can be &quot;lda&quot;, &quot;logistic&quot;, &quot;logistic2&quot;, &quot;glmnet&quot;, &quot;glmnet2&quot;, or &quot;forest&quot;.  The &quot;logistic2&quot; and &quot;glmnet2&quot; classifiers include all two-way interactions in the model. 
</p>
</td></tr>
<tr><td><code id="cpt_+3A_metric">metric</code></td>
<td>

<p>Which test statistic to use.  Can be &quot;rate&quot; (classification accuracy rate), &quot;mse&quot;, or &quot;probability&quot;.  The default value (&quot;probability&quot;) is recommended.
</p>
</td></tr>
<tr><td><code id="cpt_+3A_ensemble.metric">ensemble.metric</code></td>
<td>

<p>Which test statistic to use for an ensemble classifier composed of all of the individual classifiers.  Can be &quot;vote&quot;, &quot;mean.mse&quot;, or &quot;mean.prob&quot;.  The default value (&quot;mean.prob&quot;) is recommended.
</p>
</td></tr>
<tr><td><code id="cpt_+3A_paired">paired</code></td>
<td>

<p>Do a paired permutation test.  The data Z must be ordered such that the first observation with T==1 is paired with the first observation with T==2, the second observation with T==1 is paired with the second observation with T==2, etc.  This can be accomplished by either letting the first n/2 rows be the treatment observations, and last n/2 rows being the control observations (in the same order), or by using the first two rows for the first pair, the second two rows for the second pair, etc.
</p>
</td></tr>
<tr><td><code id="cpt_+3A_perm.n">perm.N</code></td>
<td>

<p>The number of permutations.
</p>
</td></tr>
<tr><td><code id="cpt_+3A_leaveout.n">leaveout.N</code></td>
<td>

<p>The number of training set / test set iterations.  In each iteration, a random test set is generated.  Thus, test sets will typically overlap somewhat.  There is one exception: If leaveout = 1 and leaveout.N = n, then a traditional leave-one-out procedure is used (each obersvation is left out exactly once).
</p>
</td></tr>
<tr><td><code id="cpt_+3A_comb.methods">comb.methods</code></td>
<td>

<p>Which of the classifiers to include in the combined, overall p-value.  Can be any subset of the classifiers specified in <code>class.methods</code> in addition to &quot;ensemble&quot; for the ensemble classifier.
</p>
</td></tr>
<tr><td><code id="cpt_+3A_comb.method">comb.method</code></td>
<td>

<p>The method for combining p-values from the individual classifiers in order to produce an overall p-value.  The default (&quot;fisher&quot;) is recommended.  The other possible option is &quot;min&quot; which uses the minimum p-value.  Note that in both cases, the combined p-value itself is not returned; rather, the combined p-value is treated as a test statistic, which is itself then subject to permutation analysis; what is returned is the resulting p-value from this analysis.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>
<table role = "presentation">
<tr><td><code>pval</code></td>
<td>
<p>The overall p-value, after combining results from the individual classifiers.</p>
</td></tr>
<tr><td><code>teststat</code></td>
<td>
<p>The observed test statistics of the individual classifiers.</p>
</td></tr>
<tr><td><code>nulldist</code></td>
<td>
<p>The permutation distributions of the individual classifiers.</p>
</td></tr>
<tr><td><code>pvals</code></td>
<td>
<p>The p-values of the individual classifiers.</p>
</td></tr>  
</table>


<h3>Note</h3>

 
<p>In the special case that the classifier is &quot;forest&quot;, the metric is &quot;rate&quot;, and &quot;leaveout&quot; is 0, the out-of-bag classification accuracy rate is used rather than the true in-sample classification accuracy rate.
</p>


<h3>Author(s)</h3>

 
<p>Johann Gagnon-Bartsch &lt;johanngb@umich.edu&gt; 
</p>


<h3>References</h3>

<p>The Classification Permutation Test:  A Nonparametric Test for Equality of Multivariate Distributions.  Gagnon-Bartsch and Shem-Tov, 2016.  Available at: <a href="https://arxiv.org/abs/1611.06408">https://arxiv.org/abs/1611.06408</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create some simulated data
n = 50  # 50 observations
p = 5   # 5 covariates
T = rep(c(0,1),each=25)     # Two groups, 25 observations each
Z = matrix(rnorm(n*p),n,p)  # Random data (null is true)

## Run CPT
cpt.results = cpt(Z, T, class.methods="lda")
print(cpt.results$pval)

## False Null
Z[1:25, 1] = Z[1:25, 1] + 1  # Now the null is false 
cpt.results = cpt(Z, T, class.methods="lda")
print(cpt.results$pval)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
