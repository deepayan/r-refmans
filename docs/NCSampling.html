<!DOCTYPE html><html><head><title>Help for package NCSampling</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NCSampling}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Addz'>
<p>Addz</p></a></li>
<li><a href='#Alloc'>
<p>Allocation</p></a></li>
<li><a href='#Centroids'>
<p>Calculate centroids</p></a></li>
<li><a href='#Check.pop'>
<p>Check population file</p></a></li>
<li><a href='#DesVar'>
<p>Design variances for NC sample.</p></a></li>
<li><a href='#DVar'>
<p>Design variances for single stratum.</p></a></li>
<li><a href='#Existing'>
<p>Pre-existing plot neighbours</p></a></li>
<li><a href='#NC.sample'>
<p>Nearest Centroid (NC) Sample</p></a></li>
<li><a href='#NC.select'>
<p>Nearest Centroid (NC) Plot Selection</p></a></li>
<li><a href='#NCSampling-package'>
<p>Nearest Centroid (NC) Sampling</p></a></li>
<li><a href='#nundle.sf'>
<p>Nundle State Forest LiDAR data</p></a></li>
<li><a href='#R.sample1'>
<p>Random sample.</p></a></li>
<li><a href='#Spatial.plot'>
<p>Spatial Plot</p></a></li>
<li><a href='#training'>
<p>Nundle State Forest LiDAR data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nearest Centroid (NC) Sampling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-06-26</td>
</tr>
<tr>
<td>Author:</td>
<td>GJ Melville</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gavin Melville &lt;gavin.melville@dpi.nsw.gov.au&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>yaImpute, lattice, randomForest</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functionality for performing Nearest Centroid (NC) Sampling. The NC sampling procedure was developed for forestry applications and selects plots for ground measurement so as to maximize the efficiency of imputation estimates. It uses multiple auxiliary variables and multivariate clustering to search for an optimal sample. Further details are given in Melville G. &amp; Stone C. (2016) &lt;<a href="https://doi.org/10.1080%2F00049158.2016.1218265">doi:10.1080/00049158.2016.1218265</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-06-26 21:41:37 UTC; melvilg</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-06-27 06:14:25 UTC</td>
</tr>
</table>
<hr>
<h2 id='Addz'>
Addz
</h2><span id='topic+Addz'></span>

<h3>Description</h3>

<p>Add variable/s to the population file which are good predictors of the variables/s of interest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Addz(popfile, training, yvars, xvars, pool)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Addz_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing population data - as a minimum there must be columns named 'PID' (plot identifier), 'Strata' and 'plot_type'.
</p>
</td></tr>
<tr><td><code id="Addz_+3A_training">training</code></td>
<td>

<p>dataframe containing training data. Must contain auxiliary variables and variable/s of interest.
</p>
</td></tr>
<tr><td><code id="Addz_+3A_yvars">yvars</code></td>
<td>

<p>vector containing the name of each variable of interest (dependent variable).
</p>
</td></tr>
<tr><td><code id="Addz_+3A_xvars">xvars</code></td>
<td>

<p>vector containing the names of the auxiliary variables.</p>
</td></tr>
<tr><td><code id="Addz_+3A_pool">pool</code></td>
<td>

<p>logical value - should the training data be pooled across strata prior to fitting the regression model?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The predictor variable for the each variable of interest (dependent variable) is obtained by performing random forest regression on the training data using the designated auxiliary variables. The training data can be pooled across strata (pool=T), or fitted separately within each strata (the default). Not normally called directly.
</p>


<h3>Value</h3>

<p>A list with components:-
</p>
<table>
<tr><td><code>popfile</code></td>
<td>
<p>population file - data frame, as above, with predictor variable/s added to the file
</p>
</td></tr>
<tr><td><code>r.sqared</code></td>
<td>
<p>dataframe containing the R-squared values obtained from the random forest regression/s
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>G. Melville
</p>


<h3>References</h3>

<p>Random forest regression is performed using the randomForest package. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DesVar">DesVar</a>, randomForest</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Addz(popfile, training, yvars, xvars)
</code></pre>

<hr>
<h2 id='Alloc'>
Allocation
</h2><span id='topic+Alloc'></span>

<h3>Description</h3>

<p>Allocate sample among several strata, using proportional allocation.
Inputs population file and total sample size.
Outputs sample sizes for each stratum
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Alloc(popfile, ntotal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Alloc_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing population data - as a minimum there must be columns named 'PID' (plot identifier), 'Strata' and 'plot_type'.
</p>
</td></tr>
<tr><td><code id="Alloc_+3A_ntotal">ntotal</code></td>
<td>

<p>total sample size  - required number of reference plots for all strata combined.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs a proportional allocation, by calculating the required sample size for each stratum (i) using the formula n_i = n * N_i / N, where n is the sample size (number of reference plots) and N is the number of target plots.
</p>


<h3>Value</h3>

<p>A vector of sample sizes, one for each stratum in the population file.
</p>


<h3>Author(s)</h3>

<p>G. Melville
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Existing">Existing</a></code> and <code><a href="#topic+NC.sample">NC.sample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>popfile&lt;-data.frame(PID=1:20, Strata=rep(c('A', 'B'),c(12,8)),
 	plot_type=rep('B',20))
tot.samp&lt;-6
Alloc(popfile, tot.samp)
</code></pre>

<hr>
<h2 id='Centroids'>
Calculate centroids
</h2><span id='topic+Centroids'></span>

<h3>Description</h3>

<p>Separates a single stratum of the population file into n clusters and finds the centroid of each cluster, where n is the sample size. Not intended to be called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Centroids(popfile, nrefs, desvars, ctype, imax, nst)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Centroids_+3A_popfile">popfile</code></td>
<td>

<p>population file - dataframe containing information relating to all plots in the stratum.
</p>
</td></tr>
<tr><td><code id="Centroids_+3A_nrefs">nrefs</code></td>
<td>

<p>scalar defining the number of reference plots - required sample size for the stratum.
</p>
</td></tr>
<tr><td><code id="Centroids_+3A_desvars">desvars</code></td>
<td>

<p>character vector containing the names of the design variables.
</p>
</td></tr>
<tr><td><code id="Centroids_+3A_ctype">ctype</code></td>
<td>

<p>clustering type - either k-means ('km') or Ward's D2 ('WD').
</p>
</td></tr>
<tr><td><code id="Centroids_+3A_imax">imax</code></td>
<td>

<p>maximum number of iterations when calling the k-means clustering procedure.
</p>
</td></tr>
<tr><td><code id="Centroids_+3A_nst">nst</code></td>
<td>

<p>number of random initial centroid sets when calling the k-means clustering procedure.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The virtual plots are partitioned so as to minimise the sums of squares of distances from plots to cluster centroids. This is done by using a multivariate clustering procedure such as k-means clustering (Hartigan &amp; Wong, 1979) or Ward's D2 clustering (Murtagh &amp; Legendre, 2013), using standardized design variables and a Euclidean distance metric.
</p>


<h3>Value</h3>

<table>
<tr><td><code>centroids</code></td>
<td>

<p>dataframe containing centroids.
</p>
</td></tr>
<tr><td><code>cmns</code></td>
<td>

<p>dataframe containing centroid means.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>G Melville
</p>


<h3>References</h3>

<p>Hartigan &amp; Wong (1979) Algorithm AS 136: a K-means clustering algorithm. Applied Statistics 28, 100-108, DOI:10.2307/2346830.
</p>
<p>Murtagh, M &amp; Legendre, P. (2014) Ward's hierarchical agglomerative clustering method: which algorithms implement Ward's criterion? Journal of Classification, 31, 274-295, DOI: 10.1007/s00357-014-9161-z.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Existing">Existing</a>, <a href="#topic+NC.sample">NC.sample</a> and kmeans.
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Centroids(popfile, nrefs, desvars, ctype='km', imax=200, nst=20) 
</code></pre>

<hr>
<h2 id='Check.pop'>
Check population file
</h2><span id='topic+Check.pop'></span>

<h3>Description</h3>

<p>Carries out a range of checks on the population file to detect the most commonly encountered errors. Provides a barchart showing the population structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Check.pop(popfile, desvars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Check.pop_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing information for all plots in the population.
</p>
</td></tr>
<tr><td><code id="Check.pop_+3A_desvars">desvars</code></td>
<td>

<p>vector containing the names of the design variables.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Reports on any errors found and produces a barchart.
</p>


<h3>Author(s)</h3>

<p>G. Melville</p>


<h3>See Also</h3>

<p><code><a href="#topic+NC.sample">NC.sample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Check.pop(popfile, desvars) 
</code></pre>

<hr>
<h2 id='DesVar'>
Design variances for NC sample.
</h2><span id='topic+DesVar'></span>

<h3>Description</h3>

<p>For each stratum ,and for the population as a whole, approximate design variances are calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DesVar(popfile, nrefs, desvars, yvars, kvalue, B=1000, zvars=NULL, 

training=NULL, xvars=NULL, pool=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DesVar_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing information on all plots in the population.
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_nrefs">nrefs</code></td>
<td>

<p>vector containing the sample size of each stratum.
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_desvars">desvars</code></td>
<td>

<p>vector containing the names of the design variables.
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_yvars">yvars</code></td>
<td>

<p>character vector containing the name of each variable of interest (dependent variable) for which design variances are required.
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_kvalue">kvalue</code></td>
<td>

<p>scalar specifying the value of k for the k-nn imputation.
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_b">B</code></td>
<td>

<p>number of re-samples used to calculate the design variances.
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_zvars">zvars</code></td>
<td>

<p>character vector containing the name/s of the predictor variables.
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_training">training</code></td>
<td>

<p>dataframe containing the data needed to determine the predictor variable. Must contain the necessary yvars and xvars. If missing, predictor variables are supplied by the user (zvars)
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_xvars">xvars</code></td>
<td>

<p>character vector containing the name/s of the predictor variables.
</p>
</td></tr>
<tr><td><code id="DesVar_+3A_pool">pool</code></td>
<td>

<p>logical value - should strata be pooled prior to fitting regression model?
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Approximate design variances are calculated using a re-sampling procedure in conjunction with a predictor variable. The predictor variable can be user-supplied or determined by the program using random forest regression based on a set of training data. The regression model can be fitted separately for each strata (pool=F), the default, or based on pooled training data with stratum included in the regression model as a factor.
</p>


<h3>Value</h3>

<p>A dataframe containing the design variances for each stratum and for the whole population.
</p>


<h3>Author(s)</h3>

<p>G. Melville
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NC.sample">NC.sample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## DesVar(popfile, nrefs, desvars, yvars, B=1000, zvars=NULL, 
##   training=NULL, xvars=NULL, pool=F) 
</code></pre>

<hr>
<h2 id='DVar'>
Design variances for single stratum.
</h2><span id='topic+DVar'></span>

<h3>Description</h3>

<p>For a single stratum approximate design variances are calculated. Not intended to be called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DVar(popfile, nrefs, yvars, desvars, kvalue, B=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DVar_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing information on stratum of interest.
</p>
</td></tr>
<tr><td><code id="DVar_+3A_nrefs">nrefs</code></td>
<td>

<p>scalar containing the sample size of the stratum.
</p>
</td></tr>
<tr><td><code id="DVar_+3A_yvars">yvars</code></td>
<td>

<p>character vector containing the name of each variable of interest (dependent variable) for which design variances are required.
</p>
</td></tr>
<tr><td><code id="DVar_+3A_desvars">desvars</code></td>
<td>

<p>character vector containing the names of the design variables.
</p>
</td></tr>
<tr><td><code id="DVar_+3A_kvalue">kvalue</code></td>
<td>

<p>scalar specifying the value of k for the k-nn imputation.
</p>
</td></tr>
<tr><td><code id="DVar_+3A_b">B</code></td>
<td>

<p>number of re-samples used to calculate the design variances.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the design variances for the stratum of interest. Data used to calculate these are also returned.
</p>


<h3>Author(s)</h3>

<p>G. Melville
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NC.sample">NC.sample</a></code>, <code><a href="#topic+DesVar">DesVar</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## DesVar(popfile, nrefs, yvars, kvalue, desvars, B=1000) 
</code></pre>

<hr>
<h2 id='Existing'>
Pre-existing plot neighbours
</h2><span id='topic+Existing'></span>

<h3>Description</h3>

<p>Determines the plots which are close, in the auxiliary space, to the pre-existing plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Existing(popfile, nrefs, desvars, draw.plot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Existing_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containg information on all plots in the population file.
</p>
</td></tr>
<tr><td><code id="Existing_+3A_nrefs">nrefs</code></td>
<td>

<p>vector containing the number of reference plots in each stratum.
</p>
</td></tr>
<tr><td><code id="Existing_+3A_desvars">desvars</code></td>
<td>

<p>vector containing the names of the design variables.
</p>
</td></tr>
<tr><td><code id="Existing_+3A_draw.plot">draw.plot</code></td>
<td>

<p>logical variable - should a bar graph be drawn to show the number of neighbours for each pre-existing plot?
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:-
</p>
<table>
<tr><td><code>Nx</code></td>
<td>

<p>vector containing the number of neighbours to existing plots in each stratum.
</p>
</td></tr>
<tr><td><code>Ng</code></td>
<td>

<p>vector containing the number of target plots in each stratum. 
</p>
</td></tr>
<tr><td><code>popfile</code></td>
<td>

<p>dataframe containing the original population file with neighbours to pre-existing plots separately identified.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>G Melville.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NC.sample">NC.sample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Existing(popfile, nrefs, desvars, draw.plot=T) 
</code></pre>

<hr>
<h2 id='NC.sample'>
Nearest Centroid (NC) Sample
</h2><span id='topic+NC.sample'></span>

<h3>Description</h3>

<p>Selects NC sample in multiple strata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NC.sample(popfile, nrefs, desvars, ctype, imax, nst)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NC.sample_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing information on all plots in the population.
</p>
</td></tr>
<tr><td><code id="NC.sample_+3A_nrefs">nrefs</code></td>
<td>

<p>vector containing the sample size of each stratum.
</p>
</td></tr>
<tr><td><code id="NC.sample_+3A_desvars">desvars</code></td>
<td>

<p>vector containing the names of the design variables.
</p>
</td></tr>
<tr><td><code id="NC.sample_+3A_ctype">ctype</code></td>
<td>

<p>clustering type - either k-means ('km') or Wards D ('WD').
</p>
</td></tr>
<tr><td><code id="NC.sample_+3A_imax">imax</code></td>
<td>

<p>maximum number of iterations for the k-means procedure.
</p>
</td></tr>
<tr><td><code id="NC.sample_+3A_nst">nst</code></td>
<td>

<p>number of initial random sets of cluster means for the k-means procedure.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In each stratum the population of virtual plots is segregated into n clusters where n is the stratum sample size (number of reference plots).
The virtual plots are partitioned so as to minimise the sums of squares of distances from plots to cluster centroids. This is achieved by using a multivariate clustering procedure such as k-means clustering (Hartigan &amp; Wong, 1979) or Ward's D clustering (Murtagh &amp; Legendre, 2013), using standardized design variables and a Euclidean distance metric. Following determination of the cluster centroids, the virtual plot, in the candidate set, closest to each centroid is selected as a reference plot. 
</p>


<h3>Value</h3>

<p>A list with components:-
</p>
<table>
<tr><td><code>popfile</code></td>
<td>

<p>population file - dataframe, as above, with reference plots designated as 'R'
</p>
</td></tr>
<tr><td><code>cmns</code></td>
<td>

<p>centroid means
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>G. Melville
</p>


<h3>References</h3>

<p>G. Melville &amp; C. Stone. (2016) Optimising nearest neighbour information - a simple, efficient sampling strategy for forestry plot imputation using remotely sensed data. Australian Forestry, 79:3, 217:228, DOI: 10.1080/00049158.2016.1218265.
</p>
<p>Hartigan &amp; Wong (1979) Algorithm AS 136: a K-means clustering algorithm. Applied Statistics 28, 100-108, DOI:10.2307/2346830.
</p>
<p>Murtagh, M &amp; Legendre, P. (2013) Ward's hierarchical agglomerative clustering method: Which algorithms implement Ward's criterion? Journal of Classification.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+NC.sample">NC.sample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NC.sample(popfile, nrefs, desvars, ctype='km', imax=200, nst=20) 
</code></pre>

<hr>
<h2 id='NC.select'>
Nearest Centroid (NC) Plot Selection
</h2><span id='topic+NC.select'></span>

<h3>Description</h3>

<p>Select the reference plots closest, in the auxiliary space, to the target plot centroids. Not intended to be called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NC.select(popfile, nrefs, desvars, centroids)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NC.select_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing information on all plots in the stratum.
</p>
</td></tr>
<tr><td><code id="NC.select_+3A_nrefs">nrefs</code></td>
<td>

<p>vector containing the number of reference plots in the stratum.
</p>
</td></tr>
<tr><td><code id="NC.select_+3A_desvars">desvars</code></td>
<td>

<p>vector containing the names of the design variables.
</p>
</td></tr>
<tr><td><code id="NC.select_+3A_centroids">centroids</code></td>
<td>

<p>dataframe containing the centroids for the stratum.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:-
</p>
<table>
<tr><td><code>refs</code></td>
<td>

<p>dataframe containing reference plots</p>
</td></tr>
<tr><td><code>exist</code></td>
<td>

<p>dataframe containing pre-existing plots</p>
</td></tr>
<tr><td><code>targs</code></td>
<td>

<p>dataframe containing target plots</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>G. Melville
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NC.sample">NC.sample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NC.select(popfile, nrefs, desvars, centroids) 
</code></pre>

<hr>
<h2 id='NCSampling-package'>
Nearest Centroid (NC) Sampling
</h2><span id='topic+NCSampling-package'></span><span id='topic+NCSampling'></span>

<h3>Description</h3>

<p>Suite of functions to perform NC sampling. Used by forestry practitioners to select reference plots for imputation using remotely sensed data, for example aerial laser scanning (ALS) data. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: NCSampling </td>
</tr>
<tr>
 <td style="text-align: left;">
Type: Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: 2017-06-26</td>
</tr>
<tr>
 <td style="text-align: left;">
License: GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">

  </td>
</tr>
<tr>
 <td style="text-align: left;">

Depending on the application, the functions are usually called in the following order:- </td>
</tr>
<tr>
 <td style="text-align: left;">
   Check.pop - check population file for errors </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   Alloc - allocate sample numbers to strata </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   Existing - determine the virtual plots, in the target set, which are neighbours to pre-existing plots </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   Alloc - re-allocate sample numbers to strata, taking into account pre-existing plots and their neighbours </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   NC.sample - select reference plots from the candidate set, using the internal functions Centroids and NC.select. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   Spatial.plot - display the virtual plots, including the NC sample plots, as an x-y graph.  </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   DesVar - calculate approximate design variances for each stratum and for the whole population.   
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>G Melville
Maintainer: &lt;gavin.melville@dpi.nsw.gov.au&gt;
</p>


<h3>References</h3>

<p>G. Melville &amp; C. Stone. (2016) Optimising nearest neighbour information - a simple, efficient sampling strategy for forestry plot imputation using remotely sensed data. Australian Forestry, 79:3, 217:228, DOI: 10.1080/00049158.2016.1218265.
</p>

<hr>
<h2 id='nundle.sf'>
Nundle State Forest LiDAR data
</h2><span id='topic+nundle.sf'></span>

<h3>Description</h3>

<p>LiDAR data from two strata acquired by over-flying the Nundle State Forest (SF), NSW, Australia in 2011</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nundle.sf)</code></pre>


<h3>Format</h3>

<p>A data frame with 2068 observations on the following 12 variables.
</p>

<dl>
<dt><code>PID</code></dt><dd><p>numeric vector containing unique plot IDs</p>
</dd>
<dt><code>height</code></dt><dd><p>numeric vector containing LiDAR heights</p>
</dd>
<dt><code>meanht</code></dt><dd><p>numeric vector containing LiDAR mean heights </p>
</dd>
<dt><code>mam</code></dt><dd><p>a numeric vector containing mean above mean heights </p>
</dd>
<dt><code>mdh</code></dt><dd><p>a numeric vector containing LiDAR mean dominant heights </p>
</dd>
<dt><code>pstk</code></dt><dd><p>a numeric vector containing LiDAR stocking rate </p>
</dd>
<dt><code>cc</code></dt><dd><p>a numeric vector containing LiDAR canopy cover </p>
</dd>
<dt><code>OV</code></dt><dd><p>a numeric vector containing LiDAR occupied volume </p>
</dd>
<dt><code>var</code></dt><dd><p>a numeric vector containing LiDAR height variances </p>
</dd>
<dt><code>Strata</code></dt><dd><p>a factor with levels <code>O</code>, <code>Y</code></p>
</dd>
<dt><code>x</code></dt><dd><p>a numeric vector containing x-coordinates </p>
</dd>
<dt><code>y</code></dt><dd><p>a numeric vector containing y-coordinates </p>
</dd>
</dl>



<h3>Details</h3>

<p>The LiDAR variables were calculated as outlined in Turner et al. (2011).
</p>


<h3>Source</h3>

<p>Forestry Corporation of NSW</p>


<h3>References</h3>

<p>Melville G, Stone C, Turner R (2015). Application of LiDAR data to maximize the efficiency of inventory plots in softwood plantations. New Zealand Journal of Forestry Science, 45:9,1-16. doi:10.1186/s40490-015-0038-7. 
</p>
<p>Stone C, Penman T, Turner R (2011). Determining an optimal model for processing lidar data at the plot level: results for a Pinus radiata plantation in New SouthWales, Australia. New Zealand Journal of Forestry Science, 41, 191-205.
</p>
<p>Turner R, Kathuria A, Stone C (2011). Building a case for lidar-derived structure stratification for Australian softwood plantations. In Proceedings of the SilviLaser 2011 conference, Hobart, Tasmania, Australia.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nundle.sf)
</code></pre>

<hr>
<h2 id='R.sample1'>
Random sample.
</h2><span id='topic+R.sample1'></span>

<h3>Description</h3>

<p>Selects random sample in a single stratum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R.sample1(popfile, nrefs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="R.sample1_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing information on all plots in the stratum.
</p>
</td></tr>
<tr><td><code id="R.sample1_+3A_nrefs">nrefs</code></td>
<td>

<p>vector containing the required sample size of the stratum.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A random sample of virtual plots is selected from the candidate set in the stratum of interest. 
</p>


<h3>Value</h3>

<p>A list with components:-
</p>
<table>
<tr><td><code>popfile</code></td>
<td>

<p>population file - dataframe, as above, with plot type of reference plots set to 'R'
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>G. Melville
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NC.sample">NC.sample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## R.sample1(popfile, nrefs)
</code></pre>

<hr>
<h2 id='Spatial.plot'>
Spatial Plot
</h2><span id='topic+Spatial.plot'></span>

<h3>Description</h3>

<p>Spatial (x-y) graph of candidate plots, target plots, pre-existing plots, reference plots and neighbours to pre-existing plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Spatial.plot(popfile, sampfile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Spatial.plot_+3A_popfile">popfile</code></td>
<td>

<p>dataframe containing information on all plots in the population prior to the sample.
</p>
</td></tr>
<tr><td><code id="Spatial.plot_+3A_sampfile">sampfile</code></td>
<td>

<p>dataframe containing information on all plots in the population after the sample.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Draws an x-y plot showing the location of different plots in each stratum.
</p>


<h3>Author(s)</h3>

<p>G. Melville
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+NC.sample">NC.sample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Spatial.plot(popfile, sampfile)
</code></pre>

<hr>
<h2 id='training'>
Nundle State Forest LiDAR data
</h2><span id='topic+training'></span>

<h3>Description</h3>

<p>Contains LiDAR data for 200 plots from two strata acquired by over-flying the Nundle State Forest (SF), NSW, Australia in 2011</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(training)</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations on the following 10 variables.
</p>

<dl>
<dt><code>OV</code></dt><dd><p> a numeric vector containing LiDAR occupied volume </p>
</dd>
<dt><code>height</code></dt><dd><p> numeric vector containing LiDAR heights </p>
</dd>
<dt><code>cc</code></dt><dd><p> a numeric vector containing LiDAR canopy cover </p>
</dd>
<dt><code>pstk</code></dt><dd><p> a numeric vector containing LiDAR stocking rate </p>
</dd>
<dt><code>var</code></dt><dd><p> a numeric vector containing LiDAR height variances </p>
</dd>
<dt><code>x</code></dt><dd><p> a numeric vector containing x-coordinates </p>
</dd>
<dt><code>y</code></dt><dd><p> a numeric vector containing y-coordinates </p>
</dd>
<dt><code>Strata</code></dt><dd><p>a factor with levels <code>O</code> <code>Y</code></p>
</dd>
<dt><code>PID</code></dt><dd><p> numeric vector containing unique plot IDs </p>
</dd>
<dt><code>plot_type</code></dt><dd><p>a factor with levels <code>B</code> <code>C</code> <code>T</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>The LiDAR variables were calculated as outlined in Turner et al. (2011).
</p>


<h3>Source</h3>

<p>Forestry Corporation of NSW </p>


<h3>References</h3>

<p>Melville G, Stone C, Turner R (2015). Application of LiDAR data to maximize the efficiency of inventory plots in softwood plantations. New Zealand Journal of Forestry Science, 45:9,1-16. doi:10.1186/s40490-015-0038-7. 
</p>
<p>Stone C, Penman T, Turner R (2011). Determining an optimal model for processing lidar data at the plot level: results for a Pinus radiata plantation in New SouthWales, Australia. New Zealand Journal of Forestry Science, 41, 191-205.
</p>
<p>Turner R, Kathuria A, Stone C (2011). Building a case for lidar-derived structure stratification for Australian softwood plantations. In Proceedings of the SilviLaser 2011 conference, Hobart, Tasmania, Australia.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(training)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
