<!DOCTYPE html><html><head><title>Help for package demography</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {demography}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.data.frame.demogdata'><p>Coerce a demogdata object to a data.frame object</p></a></li>
<li><a href='#aus.fert'><p>Australian fertility data</p></a></li>
<li><a href='#cm.spline'><p>Monotonic interpolating splines</p></a></li>
<li><a href='#coherentfdm'><p>Coherent functional demographic model for grouped data</p></a></li>
<li><a href='#combine.demogdata'><p>Combine two demogdata objects into one demogdata object</p></a></li>
<li><a href='#compare.demogdata'><p>Evaluation of demographic forecast accuracy</p></a></li>
<li><a href='#demogdata'><p>Create demogdata object from raw data matrices</p></a></li>
<li><a href='#demography-package'><p>Forecasting mortality and fertility data</p></a></li>
<li><a href='#extract.ages'><p>Extract some ages from a demogdata object</p></a></li>
<li><a href='#extract.years'><p>Extract some years from a demogdata object</p></a></li>
<li><a href='#fdm'><p>Functional demographic model</p></a></li>
<li><a href='#forecast.fdm'><p>Forecast functional demographic model.</p></a></li>
<li><a href='#forecast.fdmpr'><p>Forecast coherent functional demographic model.</p></a></li>
<li><a href='#forecast.lca'><p>Forecast demogdata data using Lee-Carter method.</p></a></li>
<li><a href='#fr.mort'><p>French mortality data</p></a></li>
<li><a href='#hmd'><p>Read data from HMD and construct a mortality demogdata object</p></a></li>
<li><a href='#isfe'><p>Integrated Squared Forecast Error for models of various orders</p></a></li>
<li><a href='#lca'><p>Model mortality or fertility data using Lee-Carter approach</p></a></li>
<li><a href='#life.expectancy'><p>Estimate life expectancy from mortality rates</p></a></li>
<li><a href='#lifetable'><p>Construct lifetables from mortality rates</p></a></li>
<li><a href='#mean.demogdata'><p>Mean and median functions for data of class demogdata</p></a></li>
<li><a href='#models'><p>Show model information for the forecast coefficients in FDM models.</p></a></li>
<li><a href='#netmigration'><p>Calculate net migration from mortality and fertility data</p></a></li>
<li><a href='#plot.demogdata'><p>Plot age-specific demographic functions</p></a></li>
<li><a href='#plot.errorfdm'><p>Plot differences between actuals and estimates from fitted demographic model</p></a></li>
<li><a href='#plot.fmforecast'><p>Plot forecasts from a functional demographic modell</p></a></li>
<li><a href='#plot.lifetable'><p>Plot life expectancy from lifetable</p></a></li>
<li><a href='#pop.sim'><p>Population simulation</p></a></li>
<li><a href='#read.demogdata'><p>Read demographic data and construct demogdata object</p></a></li>
<li><a href='#residuals.fdm'><p>Compute residuals and fitted values from functional demographic model or</p>
Lee-Carter model</a></li>
<li><a href='#set.upperage'><p>Combine the upperages of a demogdata object.</p></a></li>
<li><a href='#sex.ratio'><p>Compute sex ratios from mortality rates</p></a></li>
<li><a href='#simulate.fmforecast'><p>Simulate future sample paths from functional demographic model forecasts.</p></a></li>
<li><a href='#smooth.demogdata'><p>Create smooth demogdata functions</p></a></li>
<li><a href='#summary.fdm'><p>Summary for functional demographic model or Lee-Carter model</p></a></li>
<li><a href='#tfr'><p>Compute total fertility rate from fertility rates</p></a></li>
<li><a href='#update'><p>Updating functional demographic models and coherent functional demographic models.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Forecasting Mortality, Fertility, Migration and Population Data</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for demographic analysis including lifetable
        calculations; Lee-Carter modelling; functional data analysis of
        mortality rates, fertility rates, net migration numbers; and
        stochastic population forecasting.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4), forecast (&ge; 8.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ftsa (&ge; 4.8), rainbow, cobs, mgcv, strucchange, HMDHFDplus
(&ge; 2.0.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pkg.robjhyndman.com/demography/">https://pkg.robjhyndman.com/demography/</a>,
<a href="https://github.com/robjhyndman/demography">https://github.com/robjhyndman/demography</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/robjhyndman/demography/issues">https://github.com/robjhyndman/demography/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-07 23:25:43 UTC; hyndman</td>
</tr>
<tr>
<td>Author:</td>
<td>Rob Hyndman <a href="https://orcid.org/0000-0002-2140-5352"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  Heather Booth <a href="https://orcid.org/0000-0002-8356-0534"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Leonie Tickle <a href="https://orcid.org/0000-0002-6612-2401"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  John Maindonald [ctb],
  Simon Wood [ctb],
  R Core Team [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rob Hyndman &lt;Rob.Hyndman@monash.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-08 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.data.frame.demogdata'>Coerce a demogdata object to a data.frame object</h2><span id='topic+as.data.frame.demogdata'></span>

<h3>Description</h3>

<p>Coerce a demogdata object to a data.frame object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'demogdata'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.demogdata_+3A_x">x</code></td>
<td>
<p>Object to be coerced to a data frame.</p>
</td></tr>
<tr><td><code id="as.data.frame.demogdata_+3A_...">...</code></td>
<td>
<p>Other arguments not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># coerce demogdata object to data.frame ----
as.data.frame(fr.mort)
</code></pre>

<hr>
<h2 id='aus.fert'>Australian fertility data</h2><span id='topic+aus.fert'></span>

<h3>Description</h3>

<p>Age-specific fertility rates and female child-bearing population for Australia.</p>


<h3>Format</h3>

<p>Object of class <code>demogdata</code> containing the following components:
</p>
<dl>
<dt>year</dt><dd><p>Vector of years</p>
</dd>
<dt>age</dt><dd><p>Vector of ages</p>
</dd>
<dt>rate</dt><dd><p>List containing one matrix with one age group per row and one column per year.</p>
</dd>
<dt>pop</dt><dd><p>Population data in same form as <code>rate</code>.</p>
</dd>
<dt>type</dt><dd><p>Type of object. In this case, &ldquo;fertility&rdquo;.</p>
</dd>
<dt>label</dt><dd><p>Character string giving area from which data are taken. In this case, &ldquo;Australia&rdquo;.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Australian fertility rates and populations (1921-2002) for age groups (&lt;20, 20-24, 25-29, 30-34, 35-39, 40-44, 45+).
Data taken from v3.2b of the Australian Demographic Data Bank released 10 February 2005.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman</p>


<h3>Source</h3>

<p>The Australian Demographic Data Bank (courtesy of Len Smith).</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(aus.fert)
</code></pre>

<hr>
<h2 id='cm.spline'>Monotonic interpolating splines</h2><span id='topic+cm.spline'></span><span id='topic+monotonic'></span><span id='topic+cm.splinefun'></span>

<h3>Description</h3>

<p>Perform cubic spline monotonic interpolation of given data points, returning either a list of points obtained by the interpolation or a function performing the interpolation. The splines are constrained to be monotonically increasing (i.e., the slope is never negative).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cm.spline(x, y = NULL, n = 3 * length(x), xmin = min(x), xmax = max(x), ...)

cm.splinefun(x, y = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cm.spline_+3A_x">x</code>, <code id="cm.spline_+3A_y">y</code></td>
<td>
<p>vectors giving the coordinates of the points to be interpolated. Alternatively a single plotting structure can be specified: see <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.</p>
</td></tr>
<tr><td><code id="cm.spline_+3A_n">n</code></td>
<td>
<p>interpolation takes place at n equally spaced points spanning the interval [<code>xmin</code>, <code>xmax</code>].</p>
</td></tr>
<tr><td><code id="cm.spline_+3A_xmin">xmin</code></td>
<td>
<p>left-hand endpoint of the interpolation interval.</p>
</td></tr>
<tr><td><code id="cm.spline_+3A_xmax">xmax</code></td>
<td>
<p>right-hand endpoint of the interpolation interval.</p>
</td></tr>
<tr><td><code id="cm.spline_+3A_...">...</code></td>
<td>
<p>Other arguments are ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are simply wrappers to the <code><a href="stats.html#topic+splinefun">splinefun</a></code> function family from the stats package.
</p>


<h3>Value</h3>

<table>
<tr><td><code>cm.spline</code></td>
<td>
<p>returns a list containing components <code>x</code> and <code>y</code> which give the ordinates where interpolation took place and the interpolated values.</p>
</td></tr>
<tr><td><code>cm.splinefun</code></td>
<td>
<p>returns a function which will perform cubic spline interpolation of the given data points. This is often more useful than <code>spline</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>References</h3>

<p>Forsythe, G. E., Malcolm, M. A. and Moler, C. B. (1977) <em>Computer Methods for Mathematical Computations</em>.
Hyman (1983) <em>SIAM J. Sci. Stat. Comput.</em> <b>4</b>(4):645-654.
Dougherty, Edelman and Hyman 1989 <em>Mathematics of Computation</em>, <b>52</b>: 471-494.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(0,4,l=20)
y &lt;- sort(rnorm(20))
plot(x,y)
lines(spline(x, y, n = 201), col = 2) # Not necessarily monotonic
lines(cm.spline(x, y, n = 201), col = 3) # Monotonic
</code></pre>

<hr>
<h2 id='coherentfdm'>Coherent functional demographic model for grouped data</h2><span id='topic+coherentfdm'></span>

<h3>Description</h3>

<p>Fits a coherent functional model to demographic data as described in Hyndman,
Booth &amp; Yasmeen (2012). If two of the series in <code>data</code> are named
<code>male</code> and <code>female</code>, then it will use these two groups. Otherwise
it will use all available groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coherentfdm(data, order1 = 6, order2 = 6, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coherentfdm_+3A_data">data</code></td>
<td>
<p>demogdata object containing at least two groups.</p>
</td></tr>
<tr><td><code id="coherentfdm_+3A_order1">order1</code></td>
<td>
<p>Number of basis functions to fit to the model for the geometric
mean.</p>
</td></tr>
<tr><td><code id="coherentfdm_+3A_order2">order2</code></td>
<td>
<p>Number of basis functions to fit to the models for each ratio.</p>
</td></tr>
<tr><td><code id="coherentfdm_+3A_...">...</code></td>
<td>
<p>Extra arguments passed to <code><a href="#topic+fdm">fdm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list (of class <code>fdmpr</code>) consisting of two objects:
<code>product</code> (an <code><a href="#topic+fdm">fdm</a></code> object containing a del for the
geometric mean of the data) and <code>ratio</code> (a list of <code><a href="#topic+fdm">fdm</a></code>
objects, being the models for the ratio of each series with the geometric
mean).
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>References</h3>

<p>Hyndman, R.J., Booth, H., and Yasmeen, F. (2012) Coherent
mortality forecasting: the product-ratio method with functional time series
models. <em>Demography</em>, to appear.
<a href="https://robjhyndman.com/publications/coherentfdm/">https://robjhyndman.com/publications/coherentfdm/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdm">fdm</a></code>, <code><a href="#topic+forecast.fdmpr">forecast.fdmpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fr.short &lt;- extract.years(fr.sm,1950:2006)
fr.fit &lt;- coherentfdm(fr.short)
summary(fr.fit)
plot(fr.fit$product, components=3)
</code></pre>

<hr>
<h2 id='combine.demogdata'>Combine two demogdata objects into one demogdata object</h2><span id='topic+combine.demogdata'></span>

<h3>Description</h3>

<p>Function to combine demogdata objects containing
different years but the same age structure into one demogdata
object. The standard use for this function will be combining
historical data with forecasts. The objects must be of the same type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine.demogdata(obj1, obj2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine.demogdata_+3A_obj1">obj1</code></td>
<td>
<p>First demogdata object (e.g., historical data).</p>
</td></tr>
<tr><td><code id="combine.demogdata_+3A_obj2">obj2</code></td>
<td>
<p>Second demogdata object (e.g., forecasts).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class &ldquo;demogdata&rdquo; with the following components:
</p>
<table>
<tr><td><code>year</code></td>
<td>
<p>Vector of years</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Vector of ages</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>Matrix of rates with with one age group per row and one column per year.</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>Matrix of populations in same form as <code>rate</code> and containing population numbers. This is only
produced when both objects contain a <code>pop</code> component.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of object: &ldquo;mortality&rdquo;, &ldquo;fertility&rdquo; or &ldquo;migration&rdquo;.</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>Name of area from which the data are taken.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+demogdata">demogdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- fdm(fr.mort)
fcast &lt;- forecast(fit, h=50)
france2 &lt;- combine.demogdata(fr.mort,fcast)
plot(france2)
plot(life.expectancy(france2))
lines(rep(max(fr.mort$year)+0.5,2),c(0,100),lty=3)
</code></pre>

<hr>
<h2 id='compare.demogdata'>Evaluation of demographic forecast accuracy</h2><span id='topic+compare.demogdata'></span>

<h3>Description</h3>

<p>Computes mean forecast errors and mean square forecast errors for each age
level. Computes integrated squared forecast errors and integrated absolute
percentage forecast errors for each year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare.demogdata(
  data,
  forecast,
  series = names(forecast$rate)[1],
  ages = data$age,
  max.age = min(max(data$age), max(forecast$age)),
  years = data$year,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare.demogdata_+3A_data">data</code></td>
<td>
<p>Demogdata object such as created using
<code><a href="#topic+read.demogdata">read.demogdata</a></code> containing actual demographic rates.</p>
</td></tr>
<tr><td><code id="compare.demogdata_+3A_forecast">forecast</code></td>
<td>
<p>Demogdata object such as created using
<code><a href="#topic+forecast.fdm">forecast.fdm</a></code> or <code><a href="#topic+forecast.lca">forecast.lca</a></code>.</p>
</td></tr>
<tr><td><code id="compare.demogdata_+3A_series">series</code></td>
<td>
<p>Name of series to use. Default: the first matrix within
<code>forecast$rate</code>.</p>
</td></tr>
<tr><td><code id="compare.demogdata_+3A_ages">ages</code></td>
<td>
<p>Ages to use for comparison. Default: all available ages.</p>
</td></tr>
<tr><td><code id="compare.demogdata_+3A_max.age">max.age</code></td>
<td>
<p>Upper age to use for comparison.</p>
</td></tr>
<tr><td><code id="compare.demogdata_+3A_years">years</code></td>
<td>
<p>Years to use in comparison. Default is to use all available
years that are common between data and forecast.</p>
</td></tr>
<tr><td><code id="compare.demogdata_+3A_interpolate">interpolate</code></td>
<td>
<p>If TRUE, all zeros in data are replaced by interpolated
estimates when computing the error measures on the log scale. Error
measures on the original (rate) scale are unchanged.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class &quot;errorfdm&quot; with the following components:
</p>
<table>
<tr><td><code>label</code></td>
<td>
<p>Name of region from which data taken.</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Ages from <code>data</code> object.</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>Years from <code>data</code> object.</p>
</td></tr>
<tr><td><code>&lt;error&gt;</code></td>
<td>
<p>Matrix of forecast errors on rates.</p>
</td></tr>
<tr><td><code>&lt;logerror&gt;</code></td>
<td>
<p>Matrix of forecast errors on log rates.</p>
</td></tr>
<tr><td><code>mean.error</code></td>
<td>
<p>Various measures of forecast accuracy averaged across
years. Specifically ME=mean error, MSE=mean squared error, MPE=mean
percentage error and MAPE=mean absolute percentage error.</p>
</td></tr>
<tr><td><code>int.error</code></td>
<td>
<p>Various measures of forecast accuracy integrated across
ages. Specifically IE=integrated error, ISE=integrated squared error,
IPE=integrated percentage error and IAPE=integrated absolute percentage
error.</p>
</td></tr>
<tr><td><code>life.expectancy</code></td>
<td>
<p>If <code>data$type="mortality"</code>, function
returns this component which is a matrix containing actual, forecast and
actual-forecast for life expectancies.</p>
</td></tr></table>
<p> Note that the error matrices have
different names indicating if the series forecast was male, female or
total.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><a href="#topic+forecast.fdm">forecast.fdm</a>,<a href="#topic+plot.errorfdm">plot.errorfdm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fr.test &lt;- extract.years(fr.sm,years=1921:1980)
fr.fit &lt;- fdm(fr.test,order=2)
fr.error &lt;- compare.demogdata(fr.mort, forecast(fr.fit,20))
plot(fr.error)
par(mfrow=c(2,1))
plot(fr.error$age,fr.error$mean.error[,"ME"],
     type="l",xlab="Age",ylab="Mean Forecast Error")
plot(fr.error$int.error[,"ISE"],
     xlab="Year",ylab="Integrated Square Error")

</code></pre>

<hr>
<h2 id='demogdata'>Create demogdata object from raw data matrices</h2><span id='topic+demogdata'></span>

<h3>Description</h3>

<p>Create demogdata object suitable for plotting using <code><a href="#topic+plot.demogdata">plot.demogdata</a></code> and
fitting an LC or BMS model using <code><a href="#topic+lca">lca</a></code> or an FDA model using <code><a href="#topic+fdm">fdm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demogdata(data, pop, ages, years, type, label, name, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="demogdata_+3A_data">data</code></td>
<td>
<p>Matrix of data: either mortality rates or fertility rates</p>
</td></tr>
<tr><td><code id="demogdata_+3A_pop">pop</code></td>
<td>
<p>Matrix of population values of same dimension as data.
These are population numbers as at 30 June of each year (i.e., the &quot;exposures&quot;).
So, for example, the number of deaths is data*pop if data contains mortality rates.</p>
</td></tr>
<tr><td><code id="demogdata_+3A_ages">ages</code></td>
<td>
<p>Vector of ages corresponding to rows of <code>data</code>.</p>
</td></tr>
<tr><td><code id="demogdata_+3A_years">years</code></td>
<td>
<p>Vector of years corresponding to columns of <code>data</code>.</p>
</td></tr>
<tr><td><code id="demogdata_+3A_type">type</code></td>
<td>
<p>Character string showing type of demographic series:
either &ldquo;mortality&rdquo;, &ldquo;fertility&rdquo; or &ldquo;migration&rdquo;.</p>
</td></tr>
<tr><td><code id="demogdata_+3A_label">label</code></td>
<td>
<p>Character string of the name of area from which the data are taken.</p>
</td></tr>
<tr><td><code id="demogdata_+3A_name">name</code></td>
<td>
<p>Name of series: usually male, female or total.</p>
</td></tr>
<tr><td><code id="demogdata_+3A_lambda">lambda</code></td>
<td>
<p>Box-Cox transformation parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class &ldquo;demogdata&rdquo; with the following components:
</p>
<table>
<tr><td><code>year</code></td>
<td>
<p>Vector of years</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Vector of ages</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>A list containing one or more rate matrices with one age group per row and one column per year.</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>A list of the same form as <code>rate</code> but containing population numbers instead of demographic rates.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of object: &ldquo;mortality&rdquo;, &ldquo;fertility&rdquo; or &ldquo;migration&rdquo;.</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>label</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>lambda</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.demogdata">read.demogdata</a></code>
</p>

<hr>
<h2 id='demography-package'>Forecasting mortality and fertility data</h2><span id='topic+demography-package'></span><span id='topic+demography'></span>

<h3>Description</h3>

<p>Functions for demographic analysis including lifetable calculations,
Lee-Carter modelling and functional data analysis of mortality rates.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman with contributions from Heather Booth, Leonie Tickle, John Maindonald, Simon Wood and the R Core Team.
</p>
<p>Maintainer: &lt;Rob.Hyndman@monash.edu&gt;
</p>

<hr>
<h2 id='extract.ages'>Extract some ages from a demogdata object</h2><span id='topic+extract.ages'></span>

<h3>Description</h3>

<p>Creates subset of demogdata object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract.ages(data, ages, combine.upper = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract.ages_+3A_data">data</code></td>
<td>
<p>Demogdata object such as created using <code><a href="#topic+read.demogdata">read.demogdata</a></code> or <code><a href="#topic+smooth.demogdata">smooth.demogdata</a></code>.</p>
</td></tr>
<tr><td><code id="extract.ages_+3A_ages">ages</code></td>
<td>
<p>Vector of ages to extract from data.</p>
</td></tr>
<tr><td><code id="extract.ages_+3A_combine.upper">combine.upper</code></td>
<td>
<p>If TRUE, ages beyond the maximum of <code>ages</code> are combined into the upper age group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Demogdata object with same components as <code>data</code> but with a subset of ages.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.teens &lt;- extract.ages(fr.mort,13:19,FALSE)
plot(france.teens)
</code></pre>

<hr>
<h2 id='extract.years'>Extract some years from a demogdata object</h2><span id='topic+extract.years'></span>

<h3>Description</h3>

<p>Creates subset of demogdata object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract.years(data, years)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract.years_+3A_data">data</code></td>
<td>
<p>Demogdata object such as created using <code><a href="#topic+read.demogdata">read.demogdata</a></code> or <code><a href="#topic+smooth.demogdata">smooth.demogdata</a></code>.</p>
</td></tr>
<tr><td><code id="extract.years_+3A_years">years</code></td>
<td>
<p>Vector of years to extract from data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Demogdata object with same components as <code>data</code> but with a subset of years.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.1918 &lt;- extract.years(fr.mort,1918)
</code></pre>

<hr>
<h2 id='fdm'>Functional demographic model</h2><span id='topic+fdm'></span>

<h3>Description</h3>

<p>Fits a basis function model to demographic data. The function uses optimal
orthonormal basis functions obtained from a principal components
decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdm(
  data,
  series = names(data$rate)[1],
  order = 6,
  ages = data$age,
  max.age = max(ages),
  method = c("classical", "M", "rapca"),
  lambda = 3,
  mean = TRUE,
  level = FALSE,
  transform = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdm_+3A_data">data</code></td>
<td>
<p>demogdata object. Output from read.demogdata.</p>
</td></tr>
<tr><td><code id="fdm_+3A_series">series</code></td>
<td>
<p>name of series within data holding rates (1x1).</p>
</td></tr>
<tr><td><code id="fdm_+3A_order">order</code></td>
<td>
<p>Number of basis functions to fit.</p>
</td></tr>
<tr><td><code id="fdm_+3A_ages">ages</code></td>
<td>
<p>Ages to include in fit.</p>
</td></tr>
<tr><td><code id="fdm_+3A_max.age">max.age</code></td>
<td>
<p>Maximum age to fit. Ages beyond this are collapsed into the
upper age group.</p>
</td></tr>
<tr><td><code id="fdm_+3A_method">method</code></td>
<td>
<p>Method to use for principal components decomposition.
Possibilities are &ldquo;M&rdquo;, &ldquo;rapca&rdquo; and &ldquo;classical&rdquo;. See
<code><a href="ftsa.html#topic+ftsm">ftsm</a></code> for details.</p>
</td></tr>
<tr><td><code id="fdm_+3A_lambda">lambda</code></td>
<td>
<p>Tuning parameter for robustness when <code>method="M"</code>.</p>
</td></tr>
<tr><td><code id="fdm_+3A_mean">mean</code></td>
<td>
<p>If TRUE, will estimate mean term in the model before computing
basis terms. If FALSE, the mean term is assumed to be zero.</p>
</td></tr>
<tr><td><code id="fdm_+3A_level">level</code></td>
<td>
<p>If TRUE, will include an additional (intercept) term that
depends on the year but not on ages.</p>
</td></tr>
<tr><td><code id="fdm_+3A_transform">transform</code></td>
<td>
<p>If TRUE, the data are transformed with a Box-Cox
transformation before the model is fitted.</p>
</td></tr>
<tr><td><code id="fdm_+3A_...">...</code></td>
<td>
<p>Extra arguments passed to <code><a href="ftsa.html#topic+ftsm">ftsm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class &ldquo;fdm&rdquo; with the following components:
</p>
<table>
<tr><td><code>label</code></td>
<td>
<p>Name of country</p>
</td></tr> <tr><td><code>age</code></td>
<td>
<p>Ages from <code>data</code> object.</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>Years from <code>data</code> object.</p>
</td></tr> <tr><td><code>&lt;series&gt;</code></td>
<td>
<p>Matrix of
demographic data as contained in <code>data</code>. It takes the name given by
the series argument.</p>
</td></tr> <tr><td><code>fitted</code></td>
<td>
<p>Matrix of fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Residuals (difference between observed and fitted).</p>
</td></tr>
<tr><td><code>basis</code></td>
<td>
<p>Matrix of basis functions evaluated at each age level (one
column for each basis function). The first column is the fitted mean.</p>
</td></tr>
<tr><td><code>coeffs</code></td>
<td>
<p>Matrix of coefficients (one column for each coefficient
series). The first column are all ones.</p>
</td></tr> <tr><td><code>mean.se</code></td>
<td>
<p>Standard errors for
the estimated mean function.</p>
</td></tr> <tr><td><code>varprop</code></td>
<td>
<p>Proportion of variation
explained by each basis function.</p>
</td></tr> <tr><td><code>weights</code></td>
<td>
<p>Weight associated with
each time period.</p>
</td></tr> <tr><td><code>v</code></td>
<td>
<p>Measure of variation for each time period.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Data type (mortality, fertility, etc.)</p>
</td></tr> <tr><td><code>y</code></td>
<td>
<p>The data
stored as a functional time series object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>References</h3>

<p>Hyndman, R.J., and Ullah, S. (2007) Robust forecasting of
mortality and fertility rates: a functional data approach.
<em>Computational Statistics &amp; Data Analysis</em>, <b>51</b>, 4942-4956.
<a href="https://robjhyndman.com/publications/funcfor/">https://robjhyndman.com/publications/funcfor/</a>
</p>


<h3>See Also</h3>

<p><code><a href="ftsa.html#topic+ftsm">ftsm</a></code>, <code><a href="#topic+forecast.fdm">forecast.fdm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.fit &lt;- fdm(fr.mort)
summary(france.fit)
plot(france.fit)
plot(residuals(france.fit))

</code></pre>

<hr>
<h2 id='forecast.fdm'>Forecast functional demographic model.</h2><span id='topic+forecast.fdm'></span>

<h3>Description</h3>

<p>The coefficients from the fitted object are forecast using a univariate time
series model. The forecast coefficients are then multiplied by the basis
functions to obtain a forecast demographic rate curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fdm'
forecast(
  object,
  h = 50,
  level = 80,
  jumpchoice = c("fit", "actual"),
  method = "arima",
  warnings = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forecast.fdm_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+fdm">fdm</a></code>.</p>
</td></tr>
<tr><td><code id="forecast.fdm_+3A_h">h</code></td>
<td>
<p>Forecast horizon.</p>
</td></tr>
<tr><td><code id="forecast.fdm_+3A_level">level</code></td>
<td>
<p>Confidence level for prediction intervals.</p>
</td></tr>
<tr><td><code id="forecast.fdm_+3A_jumpchoice">jumpchoice</code></td>
<td>
<p>If &quot;actual&quot;, the forecasts are bias-adjusted by the
difference between the fit and the last year of observed data. Otherwise,
no adjustment is used.</p>
</td></tr>
<tr><td><code id="forecast.fdm_+3A_method">method</code></td>
<td>
<p>Forecasting method to be used.</p>
</td></tr>
<tr><td><code id="forecast.fdm_+3A_warnings">warnings</code></td>
<td>
<p>If TRUE, warnings arising from the forecast models for
coefficients will be shown. Most of these can be ignored, so the default is
<code>warnings=FALSE</code>.</p>
</td></tr>
<tr><td><code id="forecast.fdm_+3A_...">...</code></td>
<td>
<p>Other arguments as for <code><a href="ftsa.html#topic+forecast.ftsm">forecast.ftsm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>fmforecast</code> with the following components:
</p>
<table>
<tr><td><code>label</code></td>
<td>
<p>Name of region from which the data are taken.</p>
</td></tr> <tr><td><code>age</code></td>
<td>
<p>Ages
from <code>lcaout</code> object.</p>
</td></tr> <tr><td><code>year</code></td>
<td>
<p>Years from <code>lcaout</code> object.</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>List of matrices containing forecasts, lower bound and upper
bound of prediction intervals. Point forecast matrix takes the same name as
the series that has been forecast.</p>
</td></tr> <tr><td><code>error</code></td>
<td>
<p>Matrix of one-step errors
for historical data</p>
</td></tr> <tr><td><code>fitted</code></td>
<td>
<p>Matrix of one-step forecasts for
historical data</p>
</td></tr> <tr><td><code>coeff</code></td>
<td>
<p>List of objects of type <code>forecast</code>
containing the coefficients and their forecasts.</p>
</td></tr>
<tr><td><code>coeff.error</code></td>
<td>
<p>One-step errors for each of the coefficients.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>List containing the various components of variance: model,
error, mean, total and coeff.</p>
</td></tr> <tr><td><code>model</code></td>
<td>
<p>Fitted model in <code>obj</code>.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of data: &ldquo;mortality&rdquo;, &ldquo;fertility&rdquo; or
&ldquo;migration&rdquo;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdm">fdm</a></code>, <code><a href="#topic+forecast.lca">forecast.lca</a></code>, <code><a href="ftsa.html#topic+forecast.ftsm">forecast.ftsm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.fit &lt;- fdm(fr.mort,order=2)
france.fcast &lt;- forecast(france.fit,50)
plot(france.fcast)
models(france.fcast)
</code></pre>

<hr>
<h2 id='forecast.fdmpr'>Forecast coherent functional demographic model.</h2><span id='topic+forecast.fdmpr'></span>

<h3>Description</h3>

<p>The product and ratio models from <code><a href="#topic+coherentfdm">coherentfdm</a></code> are forecast, and
the results combined to give forecasts for each group in the original data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fdmpr'
forecast(object, h = 50, level = 80, K = 100, drange = c(0, 0.5), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forecast.fdmpr_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+coherentfdm">coherentfdm</a></code>.</p>
</td></tr>
<tr><td><code id="forecast.fdmpr_+3A_h">h</code></td>
<td>
<p>Forecast horizon.</p>
</td></tr>
<tr><td><code id="forecast.fdmpr_+3A_level">level</code></td>
<td>
<p>Confidence level for prediction intervals.</p>
</td></tr>
<tr><td><code id="forecast.fdmpr_+3A_k">K</code></td>
<td>
<p>Maximum number of years to use in forecasting coefficients for ratio
components.</p>
</td></tr>
<tr><td><code id="forecast.fdmpr_+3A_drange">drange</code></td>
<td>
<p>Range of fractional differencing parameter for the ratio
coefficients.</p>
</td></tr>
<tr><td><code id="forecast.fdmpr_+3A_...">...</code></td>
<td>
<p>Other arguments as for <code><a href="#topic+forecast.fdm">forecast.fdm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>fmforecast2</code> containing a list of objects each
of class <code>fmforecast</code>. The forecasts for each group in the original
data are given first. Then the forecasts from the product model, and
finally a list of forecasts from each of the ratio models.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coherentfdm">coherentfdm</a></code>, <code><a href="#topic+forecast.fdm">forecast.fdm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fr.short &lt;- extract.years(fr.sm,1950:2006)
fr.fit &lt;- coherentfdm(fr.short)
fr.fcast &lt;- forecast(fr.fit)
plot(fr.fcast$male)
plot(fr.fcast$ratio$male, plot.type='component', components=3)
models(fr.fcast)

</code></pre>

<hr>
<h2 id='forecast.lca'>Forecast demogdata data using Lee-Carter method.</h2><span id='topic+forecast.lca'></span>

<h3>Description</h3>

<p>The kt coefficients are forecast using a random walk with drift.
The forecast coefficients are then multiplied by bx to
obtain a forecast demographic rate curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lca'
forecast(
  object,
  h = 50,
  se = c("innovdrift", "innovonly"),
  jumpchoice = c("fit", "actual"),
  level = 80,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forecast.lca_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+lca">lca</a></code>.</p>
</td></tr>
<tr><td><code id="forecast.lca_+3A_h">h</code></td>
<td>
<p>Number of years ahead to forecast.</p>
</td></tr>
<tr><td><code id="forecast.lca_+3A_se">se</code></td>
<td>
<p>Method used for computation of standard error. Possibilities: &ldquo;innovdrift&rdquo; (innovations and drift) and &ldquo;innovonly&rdquo; (innovations only).</p>
</td></tr>
<tr><td><code id="forecast.lca_+3A_jumpchoice">jumpchoice</code></td>
<td>
<p>Method used for computation of jumpchoice. Possibilities: &ldquo;actual&rdquo; (use actual rates from final year) and &ldquo;fit&rdquo; (use fitted rates).</p>
</td></tr>
<tr><td><code id="forecast.lca_+3A_level">level</code></td>
<td>
<p>Confidence level for prediction intervals.</p>
</td></tr>
<tr><td><code id="forecast.lca_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>fmforecast</code> with the following components:
</p>
<table>
<tr><td><code>label</code></td>
<td>
<p>Region from which the data are taken.</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Ages from <code>object</code>.</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>Years from <code>object</code>.</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>List of matrices containing forecasts, lower bound and upper bound of prediction intervals.
Point forecast matrix takes the same name as the series that has been forecast.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>Matrix of one-step forecasts for historical data</p>
</td></tr>
</table>
<p>Other components included are
</p>
<table>
<tr><td><code>e0</code></td>
<td>
<p>Forecasts of life expectancies (including lower and upper bounds)</p>
</td></tr>
<tr><td><code>kt.f</code></td>
<td>
<p>Forecasts of coefficients from the model.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Data type.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>Details about the fitted model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lca">lca</a></code>, <code><a href="#topic+plot.fmforecast">plot.fmforecast</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.lca &lt;- lca(fr.mort, adjust="e0")
france.fcast &lt;- forecast(france.lca, 50)
plot(france.fcast)
plot(france.fcast,'c')
</code></pre>

<hr>
<h2 id='fr.mort'>French mortality data</h2><span id='topic+fr.mort'></span><span id='topic+fr.sm'></span>

<h3>Description</h3>

<p>Age-specific mortality rates and population for France.</p>


<h3>Format</h3>

<p>Object of class <code>demogdata</code> containing the following components:
</p>

<dl>
<dt>year</dt><dd><p>Vector of years</p>
</dd>
<dt>age</dt><dd><p>Vector of ages</p>
</dd>
<dt>rate</dt><dd><p>List of matrices containing rates with with one age group per row and one column per year.
Matrices: <code>total</code>, <code>female</code>, <code>male</code>.</p>
</dd>
<dt>pop</dt><dd><p>Population data in same form as <code>rate</code>.</p>
</dd>
<dt>type</dt><dd><p>Type of object. In this case, &ldquo;mortality&rdquo;.</p>
</dd>
<dt>label</dt><dd><p>Character string giving area from which data are taken. In this case, &ldquo;France&rdquo;.</p>
</dd>
</dl>


<h3>Details</h3>

<p><code>fr.mort</code> contains French mortality rates and populations (1899-2005) for ages 0-110. Data taken from the Human Mortality Database
on 20 February 2008. <code>fr.sm</code> contains a smoothed version of <code>fr.mort</code> obtained using the <code><a href="#topic+smooth.demogdata">smooth.demogdata</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman</p>


<h3>Source</h3>

<p>The Human Mortality Database (<a href="http://www.mortality.org">http://www.mortality.org</a>).</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(fr.mort,years=1950:1997)

plot(fr.mort,years=1990,type='p',pch=1)
lines(fr.sm,years=1990)
</code></pre>

<hr>
<h2 id='hmd'>Read data from HMD and construct a mortality demogdata object</h2><span id='topic+hmd'></span><span id='topic+hmd.mx'></span><span id='topic+hmd.e0'></span><span id='topic+hmd.pop'></span>

<h3>Description</h3>

<p><code>hmd.mx</code> reads &quot;Mx&quot; (1x1) data from the Human Mortality Database (HMD
<a href="https://www.mortality.org">https://www.mortality.org</a>) and constructs a demogdata object suitable
for plotting using <code><a href="#topic+plot.demogdata">plot.demogdata</a></code> and fitting an LC or BMS
model using <code><a href="#topic+lca">lca</a></code> or an FDA model using <code><a href="#topic+fdm">fdm</a></code>.
<code>hmd.pop</code> reads &quot;Population&quot; (1x1) data from the HMD and constructs a
demogdata object suitable for plotting using <code><a href="#topic+plot.demogdata">plot.demogdata</a></code>.
<code>hmd.e0</code> reads life expectancy at birth from the HMD and returns the
result as a <code>ts</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmd.mx(country, username, password, label = country)

hmd.e0(country, username, password)

hmd.pop(country, username, password, label = country)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmd_+3A_country">country</code></td>
<td>
<p>Directory abbreviation from the HMD. For instance, Australia =
&quot;AUS&quot;.</p>
</td></tr>
<tr><td><code id="hmd_+3A_username">username</code></td>
<td>
<p>HMD username (case-sensitive)</p>
</td></tr>
<tr><td><code id="hmd_+3A_password">password</code></td>
<td>
<p>HMD password (case-sensitive)</p>
</td></tr>
<tr><td><code id="hmd_+3A_label">label</code></td>
<td>
<p>Character string giving name of country from which the data are
taken.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to read the data, users are required to create their account via the HMD website (<a href="https://www.mortality.org">https://www.mortality.org</a>),
and obtain a valid username and password.
</p>


<h3>Value</h3>

<p><code>hmd.mx</code> returns an object of class <code>demogdata</code> with the following components:
</p>
<table>
<tr><td><code>year</code></td>
<td>
<p>Vector of years</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Vector of ages</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>A list containing one or more rate matrices with one age group per row and one column per year.</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>A list of the same form as <code>rate</code> but containing population numbers instead of demographic rates.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of object: &ldquo;mortality&rdquo;, &ldquo;fertility&rdquo; or &ldquo;migration&rdquo;.</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>label</p>
</td></tr>
</table>
<p><code>hmd.pop</code> returns a similar object but without the <code>rate</code> component.
<code>hmd.e0</code> returns an object of class <code>ts</code> with columns <code>male</code>, <code>female</code> and <code>total</code>.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+demogdata">demogdata</a></code>,<code><a href="#topic+read.demogdata">read.demogdata</a></code>,<code><a href="#topic+plot.demogdata">plot.demogdata</a></code>, <code><a href="#topic+life.expectancy">life.expectancy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
norway &lt;- hmd.mx("NOR", username, password, "Norway")
summary(norway)

## End(Not run)
</code></pre>

<hr>
<h2 id='isfe'>Integrated Squared Forecast Error for models of various orders</h2><span id='topic+isfe'></span><span id='topic+isfe.demogdata'></span>

<h3>Description</h3>

<p>Computes ISFE values for functional time series models of various orders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isfe(...)

## S3 method for class 'demogdata'
isfe(
  data,
  series = names(data$rate)[1],
  max.order = N - 3,
  N = 10,
  h = 5:10,
  ages = data$age,
  max.age = max(ages),
  method = c("classical", "M", "rapca"),
  fmethod = c("arima", "ar", "arfima", "ets", "ets.na", "struct", "rwdrift", "rw"),
  lambda = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isfe_+3A_...">...</code></td>
<td>
<p>Additional arguments control the fitting procedure.</p>
</td></tr>
<tr><td><code id="isfe_+3A_data">data</code></td>
<td>
<p>demogdata object.</p>
</td></tr>
<tr><td><code id="isfe_+3A_series">series</code></td>
<td>
<p>name of series within data holding rates (1x1)</p>
</td></tr>
<tr><td><code id="isfe_+3A_max.order">max.order</code></td>
<td>
<p>Maximum number of basis functions to fit.</p>
</td></tr>
<tr><td><code id="isfe_+3A_n">N</code></td>
<td>
<p>Minimum number of functional observations to be used in fitting a
model.</p>
</td></tr>
<tr><td><code id="isfe_+3A_h">h</code></td>
<td>
<p>Forecast horizons over which to average.</p>
</td></tr>
<tr><td><code id="isfe_+3A_ages">ages</code></td>
<td>
<p>Ages to include in fit.</p>
</td></tr>
<tr><td><code id="isfe_+3A_max.age">max.age</code></td>
<td>
<p>Maximum age to fit.</p>
</td></tr>
<tr><td><code id="isfe_+3A_method">method</code></td>
<td>
<p>Method to use for principal components decomposition.
Possibilities are &ldquo;M&rdquo;, &ldquo;rapca&rdquo; and &ldquo;classical&rdquo;.</p>
</td></tr>
<tr><td><code id="isfe_+3A_fmethod">fmethod</code></td>
<td>
<p>Method used for forecasting. Current possibilities are
&ldquo;ets&rdquo;, &ldquo;arima&rdquo;, &ldquo;ets.na&rdquo;, &ldquo;struct&rdquo;,
&ldquo;rwdrift&rdquo; and &ldquo;rw&rdquo;.</p>
</td></tr>
<tr><td><code id="isfe_+3A_lambda">lambda</code></td>
<td>
<p>Tuning parameter for robustness when <code>method="M"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix with <code>(max.order+1)</code> rows and <code>length(h)</code> columns
containing ISFE values for models of orders 0:max.order.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>References</h3>

<p>Hyndman, R.J., and Ullah, S. (2007) Robust forecasting of mortality and
fertility rates: a functional data approach. <em>Computational Statistics &amp; Data Analysis</em>,
<b>51</b>, 4942-4956. <a href="https://robjhyndman.com/publications/funcfor/">https://robjhyndman.com/publications/funcfor/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdm">fdm</a></code>, <code><a href="#topic+forecast.fdm">forecast.fdm</a></code>.
</p>

<hr>
<h2 id='lca'>Model mortality or fertility data using Lee-Carter approach</h2><span id='topic+lca'></span><span id='topic+bms'></span>

<h3>Description</h3>

<p>Lee-Carter model of mortality or fertility rates. <code>lca</code> produces a
standard Lee-Carter model by default, although many other options are
available. <code>bms</code> is a wrapper for <code>lca</code> and returns a model based
on the Booth-Maindonald-Smith methodology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lca(
  data,
  series = names(data$rate)[1],
  years = data$year,
  ages = data$age,
  max.age = 100,
  adjust = c("dt", "dxt", "e0", "none"),
  chooseperiod = FALSE,
  minperiod = 20,
  breakmethod = c("bai", "bms"),
  scale = FALSE,
  restype = c("logrates", "rates", "deaths"),
  interpolate = FALSE
)

bms(
  data,
  series = names(data$rate)[1],
  years = data$year,
  ages = data$age,
  max.age = 100,
  minperiod = 20,
  breakmethod = c("bms", "bai"),
  scale = FALSE,
  restype = c("logrates", "rates", "deaths"),
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lca_+3A_data">data</code></td>
<td>
<p>demogdata object of type &ldquo;mortality&rdquo; or
&ldquo;fertility&rdquo;. Output from read.demogdata.</p>
</td></tr>
<tr><td><code id="lca_+3A_series">series</code></td>
<td>
<p>name of series within data containing mortality or fertility
values (1x1)</p>
</td></tr>
<tr><td><code id="lca_+3A_years">years</code></td>
<td>
<p>years to include in fit. Default: all available years.</p>
</td></tr>
<tr><td><code id="lca_+3A_ages">ages</code></td>
<td>
<p>ages to include in fit. Default: all available ages up to
<code>max.age</code>.</p>
</td></tr>
<tr><td><code id="lca_+3A_max.age">max.age</code></td>
<td>
<p>upper age to include in fit. Ages beyond this are collapsed
into the upper age group.</p>
</td></tr>
<tr><td><code id="lca_+3A_adjust">adjust</code></td>
<td>
<p>method to use for adjustment of coefficients <code class="reqn">k_t kt</code>.
Possibilities are &ldquo;dxt&rdquo; (BMS method), &ldquo;dt&rdquo; (Lee-Carter
method), &ldquo;e0&rdquo; (method based on life expectancy) and &ldquo;none&rdquo;.
Defaults are &ldquo;dxt&rdquo; for <code>bms()</code> and &ldquo;dt&rdquo; for
<code>lca()</code>.</p>
</td></tr>
<tr><td><code id="lca_+3A_chooseperiod">chooseperiod</code></td>
<td>
<p>If TRUE, it will choose the best fitting period.</p>
</td></tr>
<tr><td><code id="lca_+3A_minperiod">minperiod</code></td>
<td>
<p>Minimum number of years to include in fitting period if
chooseperiod=TRUE.</p>
</td></tr>
<tr><td><code id="lca_+3A_breakmethod">breakmethod</code></td>
<td>
<p>method to use for identifying breakpoints if
chooseperiod=TRUE. Possibilities are &ldquo;bai&rdquo; (Bai's method computed
using <code><a href="strucchange.html#topic+breakpoints">breakpoints</a></code> in the strucchange package)
and &ldquo;bms&rdquo; (method based on mean deviance ratios described in BMS).</p>
</td></tr>
<tr><td><code id="lca_+3A_scale">scale</code></td>
<td>
<p>If TRUE, it will rescale bx and kt so that kt has drift
parameter = 1.</p>
</td></tr>
<tr><td><code id="lca_+3A_restype">restype</code></td>
<td>
<p>method to use for calculating residuals. Possibilities are
&ldquo;logrates&rdquo;, &ldquo;rates&rdquo; and &ldquo;deaths&rdquo;.</p>
</td></tr>
<tr><td><code id="lca_+3A_interpolate">interpolate</code></td>
<td>
<p>If TRUE, it will estimate any zero mortality or fertility
rates using the same age group from nearby years.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All mortality or fertility data are assumed to be in matrices of
mortality or fertility rates within <code>data$rate</code>. Each row is one age group
(assumed to be single years). Each column is one year. The
function produces a model for the <code>series</code> mortality or fertility rate matrix
within <code>data$rate</code>. Forecasts from this model can be obtained using <code><a href="#topic+forecast.lca">forecast.lca</a></code>.
</p>


<h3>Value</h3>

<p>Object of class &ldquo;lca&rdquo; with the following components:
</p>
<table>
<tr><td><code>label</code></td>
<td>
<p>Name of region</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Ages from <code>data</code> object.</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>Years from <code>data</code> object.</p>
</td></tr>
<tr><td><code>&lt;series&gt;</code></td>
<td>
<p>Matrix of mortality or fertility data as contained in <code>data</code>. It takes the name given by the series argument.</p>
</td></tr>
<tr><td><code>ax</code></td>
<td>
<p>Average deathrates across fitting period</p>
</td></tr>
<tr><td><code>bx</code></td>
<td>
<p>First principal component in Lee-Carter model</p>
</td></tr>
<tr><td><code>kt</code></td>
<td>
<p>Coefficient of first principal component</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Functional time series of residuals.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>Functional time series containing estimated mortality or fertility rates from model</p>
</td></tr>
<tr><td><code>varprop</code></td>
<td>
<p>Proportion of variance explained by model.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The data stored as a functional time series object.</p>
</td></tr>
<tr><td><code>mdev</code></td>
<td>
<p>Mean deviance of total and base lack of fit, as described in Booth, Maindonald and Smith.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heather Booth, Leonie Tickle, John Maindonald and Rob J Hyndman.
</p>


<h3>References</h3>

<p>Booth, H., Maindonald, J., and Smith, L. (2002) Applying Lee-Carter
under conditions of variable mortality decline. <em>Population Studies</em>, <b>56</b>, 325-336.
</p>
<p>Lee, R.D., and Carter, L.R. (1992) Modeling and forecasting US mortality. <em>Journal of
the American Statistical Association</em>, <b>87</b>, 659-671.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+forecast.lca">forecast.lca</a></code>, <code><a href="#topic+plot.lca">plot.lca</a></code>, <code><a href="#topic+summary.lca">summary.lca</a></code>, <code><a href="#topic+fdm">fdm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
france.LC1 &lt;- lca(fr.mort, adjust="e0")
plot(france.LC1)
par(mfrow=c(1,2))
plot(fr.mort,years=1953:2002,ylim=c(-11,1))
plot(forecast(france.LC1,jumpchoice="actual"),ylim=c(-11,1))

france.bms &lt;- bms(fr.mort, breakmethod="bai")
fcast.bms &lt;- forecast(france.bms)
par(mfrow=c(1,1))
plot(fcast.bms$kt)

## End(Not run)
</code></pre>

<hr>
<h2 id='life.expectancy'>Estimate life expectancy from mortality rates</h2><span id='topic+life.expectancy'></span><span id='topic+flife.expectancy'></span><span id='topic+e0'></span>

<h3>Description</h3>

<p>All three functions estimate life expectancy from <code>lifetable</code>.
The function <code>flife.expectancy</code> is primarily designed for forecast life expectancies and will optionally
produce prediction intervals. Where appropriate, it will package the results as a forecast object
which makes it much easier to product nice plots of forecast life expectancies.
The <code>e0</code> function is a shorthand wrapper for <code>flife.expectancy</code> with <code>age=0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>life.expectancy(
  data,
  series = names(data$rate)[1],
  years = data$year,
  type = c("period", "cohort"),
  age = min(data$age),
  max.age = min(100, max(data$age))
)

flife.expectancy(
  data,
  series = NULL,
  years = data$year,
  type = c("period", "cohort"),
  age,
  max.age = NULL,
  PI = FALSE,
  nsim = 500,
  ...
)

e0(
  data,
  series = NULL,
  years = data$year,
  type = c("period", "cohort"),
  max.age = NULL,
  PI = FALSE,
  nsim = 500,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="life.expectancy_+3A_data">data</code></td>
<td>
<p>Demogdata object of type &ldquo;mortality&rdquo; such as obtained from <code><a href="#topic+read.demogdata">read.demogdata</a></code>,
or an object of class <code>fmforecast</code> such as the output from  <code><a href="#topic+forecast.fdm">forecast.fdm</a></code> or <code><a href="#topic+forecast.lca">forecast.lca</a></code>,
or an object of class <code>fmforecast2</code> such as the output from <code><a href="#topic+forecast.fdmpr">forecast.fdmpr</a></code>.</p>
</td></tr>
<tr><td><code id="life.expectancy_+3A_series">series</code></td>
<td>
<p>Name of mortality series to use. Default is the first demogdata series in data.</p>
</td></tr>
<tr><td><code id="life.expectancy_+3A_years">years</code></td>
<td>
<p>Vector indicating which years to use.</p>
</td></tr>
<tr><td><code id="life.expectancy_+3A_type">type</code></td>
<td>
<p>Either <code>period</code> or <code>cohort</code>.</p>
</td></tr>
<tr><td><code id="life.expectancy_+3A_age">age</code></td>
<td>
<p>Age at which life expectancy is to be calculated.</p>
</td></tr>
<tr><td><code id="life.expectancy_+3A_max.age">max.age</code></td>
<td>
<p>Maximum age for life table calculation.</p>
</td></tr>
<tr><td><code id="life.expectancy_+3A_pi">PI</code></td>
<td>
<p>If TRUE, produce a prediction interval.</p>
</td></tr>
<tr><td><code id="life.expectancy_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations to use when computing a prediction interval.</p>
</td></tr>
<tr><td><code id="life.expectancy_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>simulate</code> when producing prediction intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Time series of life expectancies (one per year), or a forecast object of life expectancies (one per year).
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lifetable">lifetable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(life.expectancy(fr.mort),ylab="Life expectancy")

france.LC &lt;- lca(fr.mort,adjust="e0",years=1950:1997)
france.fcast &lt;- forecast(france.LC,jumpchoice="actual")
france.e0.f &lt;- life.expectancy(france.fcast)

france.fdm &lt;- fdm(extract.years(fr.mort,years=1950:2006))
france.fcast &lt;- forecast(france.fdm)
## Not run: 
  e0.fcast &lt;- e0(france.fcast,PI=TRUE,nsim=200)
  plot(e0.fcast)
## End(Not run)

life.expectancy(fr.mort,type='cohort',age=50)

</code></pre>

<hr>
<h2 id='lifetable'>Construct lifetables from mortality rates</h2><span id='topic+lifetable'></span>

<h3>Description</h3>

<p>Computes period and cohort lifetables from mortality rates for multiple years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lifetable(
  data,
  series = names(data$rate)[1],
  years = data$year,
  ages = data$age,
  max.age = min(100, max(data$age)),
  type = c("period", "cohort")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lifetable_+3A_data">data</code></td>
<td>
<p>Demogdata object such as obtained from <code><a href="#topic+read.demogdata">read.demogdata</a></code>,
<code><a href="#topic+forecast.fdm">forecast.fdm</a></code> or <code><a href="#topic+forecast.lca">forecast.lca</a></code>.</p>
</td></tr>
<tr><td><code id="lifetable_+3A_series">series</code></td>
<td>
<p>Name of series to use.  Default is the first series in <code>data[["rate"]]</code>.</p>
</td></tr>
<tr><td><code id="lifetable_+3A_years">years</code></td>
<td>
<p>Vector indicating which years to include in the tables.</p>
</td></tr>
<tr><td><code id="lifetable_+3A_ages">ages</code></td>
<td>
<p>Vector indicating which ages to include in table.</p>
</td></tr>
<tr><td><code id="lifetable_+3A_max.age">max.age</code></td>
<td>
<p>Age for last row. Ages beyond this are combined.</p>
</td></tr>
<tr><td><code id="lifetable_+3A_type">type</code></td>
<td>
<p>Type of lifetable: <code>period</code> or <code>cohort</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For period lifetables, all years and all ages specified are included in the tables. For cohort lifetables,
if <code>ages</code> takes a scalar value, then the cohorts are taken to be of that age in each year contained in <code>years</code>.
But if <code>ages</code> is a vector of values, then the cohorts are taken to be of those ages in the first year contained in <code>years</code>.
</p>
<p>For example, if <code>ages=0</code> then lifetables of the birth cohorts for all years in <code>years</code> are computed. On the other hand,
if <code>ages=0:100</code> and <code>years=1950:2010</code>, then lifetables of each age cohort in 1950 are computed.
</p>
<p>In all cases, <code class="reqn">q_x = m_x/(1+[(1-a_x)m_x])</code> as per Chiang (1984).
</p>
<p>Warning: the code has only been tested for data based on single-year age groups.
</p>


<h3>Value</h3>

<p>Object of class &ldquo;lifetable&rdquo; containing the following components:
</p>
<table>
<tr><td><code>label</code></td>
<td>
<p>Name of region from which data are taken.</p>
</td></tr>
<tr><td><code>series</code></td>
<td>
<p>Name of series</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Ages for lifetable</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>Period years or cohort years</p>
</td></tr>
<tr><td><code>mx</code></td>
<td>
<p>Death rate at age x.</p>
</td></tr>
<tr><td><code>qx</code></td>
<td>
<p>The probability that an individual of exact age x will die before exact age x+1.</p>
</td></tr>
<tr><td><code>lx</code></td>
<td>
<p>Number of survivors to exact age x.  The radix is 1.</p>
</td></tr>
<tr><td><code>dx</code></td>
<td>
<p>The number of deaths between exact ages x and x+1.</p>
</td></tr>
<tr><td><code>Lx</code></td>
<td>
<p>Number of years lived between exact age x and exact age x+1.</p>
</td></tr>
<tr><td><code>Tx</code></td>
<td>
<p>Number of years lived after exact age x.</p>
</td></tr>
<tr><td><code>ex</code></td>
<td>
<p>Remaining life expectancy at exact age x.</p>
</td></tr>
</table>
<p>Note that the lifetables themselves are not returned, only their components. However, there is a print method that constructs (and returns)
the lifetables from the above components.
</p>


<h3>Author(s)</h3>

<p>Heather Booth, Leonie Tickle, Rob J Hyndman, John Maindonald and Timothy Miller
</p>


<h3>References</h3>

<p>Chiang CL. (1984) <em>The life table and its applications</em>. Robert E Krieger Publishing Company: Malabar.
</p>
<p>Keyfitz, N, and Caswell, H. (2005) <em>Applied mathematical demography</em>, Springer-Verlag: New York.
</p>
<p>Preston, S.H., Heuveline, P., and Guillot, M. (2001) <em>Demography: measuring and modeling population processes</em>. Blackwell
</p>


<h3>See Also</h3>

<p><code><a href="#topic+life.expectancy">life.expectancy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.lt &lt;- lifetable(fr.mort)
plot(france.lt)
lt1990 &lt;- print(lifetable(fr.mort,year=1990))

france.LC &lt;- lca(fr.mort)
france.fcast &lt;- forecast(france.LC)
france.lt.f &lt;- lifetable(france.fcast)
plot(france.lt.f)

# Birth cohort lifetables, 1900-1910
france.clt &lt;- lifetable(fr.mort,type="cohort",age=0, years=1900:1910)

# Partial cohort lifetables for 1950
lifetable(fr.mort, years=1950)
</code></pre>

<hr>
<h2 id='mean.demogdata'>Mean and median functions for data of class demogdata</h2><span id='topic+mean.demogdata'></span><span id='topic+median.demogdata'></span>

<h3>Description</h3>

<p>Computes mean or median of demographic rates for each age level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'demogdata'
mean(x, series = names(x$rate)[1], transform = TRUE, na.rm = TRUE, ...)

## S3 method for class 'demogdata'
median(
  x,
  na.rm = FALSE,
  series = names(x$rate)[1],
  transform = TRUE,
  method = c("hossjercroux", "coordinate"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean.demogdata_+3A_x">x</code></td>
<td>
<p>Demogdata object such as created using <code><a href="#topic+read.demogdata">read.demogdata</a></code> or <code><a href="#topic+smooth.demogdata">smooth.demogdata</a></code>.</p>
</td></tr>
<tr><td><code id="mean.demogdata_+3A_series">series</code></td>
<td>
<p>Name of demogdata series to plot..</p>
</td></tr>
<tr><td><code id="mean.demogdata_+3A_transform">transform</code></td>
<td>
<p>Should transform of data be taken first?</p>
</td></tr>
<tr><td><code id="mean.demogdata_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="mean.demogdata_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
<tr><td><code id="mean.demogdata_+3A_method">method</code></td>
<td>
<p>Method for computing the median. Either &quot;coordinate&quot; for a coordinate-wise median, or &quot;hossjercroux&quot; for the
L1-median using the Hossjer-Croux algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing <code>x</code>=ages and <code>y</code>=mean or median rates.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>References</h3>

<p>Hossjer, O., and Croux, C. (1995) Generalized univariate signed rank statistics for testing
and estimating a multivariate location parameter. <em>Nonparametric Statistics</em>, <b>4</b>, 293-308.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(fr.mort)
lines(mean(fr.mort),lwd=2)
lines(median(fr.mort),lwd=2,col=2)
</code></pre>

<hr>
<h2 id='models'>Show model information for the forecast coefficients in FDM models.</h2><span id='topic+models'></span><span id='topic+models.fmforecast'></span><span id='topic+models.fmforecast2'></span>

<h3>Description</h3>

<p>The models for the time series coefficients used in forecasting fdm models are shown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>models(object, ...)

## S3 method for class 'fmforecast'
models(object, select = 0, ...)

## S3 method for class 'fmforecast2'
models(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="models_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+forecast.fdm">forecast.fdm</a></code> or <code><a href="#topic+forecast.fdmpr">forecast.fdmpr</a></code>.</p>
</td></tr>
<tr><td><code id="models_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
<tr><td><code id="models_+3A_select">select</code></td>
<td>
<p>Indexes of coefficients to display. If select=0, all coefficients are displayed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+forecast.fdm">forecast.fdm</a></code>, <code><a href="#topic+forecast.fdmpr">forecast.fdmpr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fr.short &lt;- extract.years(fr.sm,1950:2006)
fr.fit &lt;- fdm(fr.short,series="male")
fr.fcast &lt;- forecast(fr.fit)
models(fr.fcast)

fr.fit &lt;- coherentfdm(fr.short)
fr.fcast &lt;- forecast(fr.fit)
models(fr.fcast,select=1:3)

## End(Not run)
</code></pre>

<hr>
<h2 id='netmigration'>Calculate net migration from mortality and fertility data</h2><span id='topic+netmigration'></span>

<h3>Description</h3>

<p>Function to compute the net number of migrants in each year and for each age,
based on the total population numbers, deaths and births in each year.</p>


<h3>Usage</h3>

<pre><code class='language-R'>netmigration(mort, fert, startyearpop=mort, mfratio = 1.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="netmigration_+3A_mort">mort</code></td>
<td>
<p>Demogdata object of type <code>"mortality"</code></p>
</td></tr>
<tr><td><code id="netmigration_+3A_fert">fert</code></td>
<td>
<p>Demogdata object of type <code>"fertility"</code></p>
</td></tr>
<tr><td><code id="netmigration_+3A_startyearpop">startyearpop</code></td>
<td>
<p>Demogdata object containing population data for first year of calculation.</p>
</td></tr>
<tr><td><code id="netmigration_+3A_mfratio">mfratio</code></td>
<td>
<p>Male-female ratio to be used in simulating births.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class &ldquo;demogdata&rdquo; with the following components:
</p>
<table>
<tr><td><code>year</code></td>
<td>
<p>Vector of years</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Vector of ages</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>List containing matrices of net migration numbers (not &quot;rates&quot;) with with one age group per
row and one column per year. Names of matrices are the same as for <code>mort$rate</code>.</p>
</td></tr>
<tr><td><code>pop</code></td>
<td>
<p>List containing matrices of populations in same form as <code>rate</code> and containing population numbers.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of object. In this case, &ldquo;migration&rdquo;.</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>label from <code>mort$label</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman</p>


<h3>See Also</h3>

<p><code><a href="#topic+demogdata">demogdata</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
require(addb)
aus.mig &lt;- netmigration(australia,aus.fertility)
plot(aus.mig)
## End(Not run)
</code></pre>

<hr>
<h2 id='plot.demogdata'>Plot age-specific demographic functions</h2><span id='topic+plot.demogdata'></span><span id='topic+lines.demogdata'></span><span id='topic+points.demogdata'></span>

<h3>Description</h3>

<p>If <code>plot.type="functions"</code>, then years are plotted using a rainbow palette so the
earliest years are red, followed by orange, yellow, green, blue
and indigo with the most recent years plotted in violet.
If <code>plot.type="time"</code>, then each age is shown as a separate time series in a time plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'demogdata'
plot(
  x,
  series = ifelse(!is.null(x$rate), names(x$rate)[1], names(x$pop)[1]),
  datatype = ifelse(!is.null(x$rate), "rate", "pop"),
  years = x$year,
  ages = x$age,
  max.age = max(x$age),
  transform = (x$type == "mortality"),
  plot.type = c("functions", "time", "depth", "density"),
  type = "l",
  main = NULL,
  xlab,
  ylab,
  ...
)

## S3 method for class 'demogdata'
lines(
  x,
  series = ifelse(!is.null(x$rate), names(x$rate)[1], names(x$pop)[1]),
  datatype = ifelse(!is.null(x$rate), "rate", ""),
  years = x$year,
  ages = x$age,
  max.age = max(x$age),
  transform = (x$type == "mortality"),
  plot.type = c("functions", "time", "depth", "density"),
  ...
)

## S3 method for class 'demogdata'
points(..., pch = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.demogdata_+3A_x">x</code></td>
<td>
<p>Demogdata object such as created using <code><a href="#topic+read.demogdata">read.demogdata</a></code> or <code><a href="#topic+smooth.demogdata">smooth.demogdata</a></code>.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_series">series</code></td>
<td>
<p>Name of series to plot. Default: the first matrix within <code>datatype</code>.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_datatype">datatype</code></td>
<td>
<p>Name of demogdata object which contains series. Default &ldquo;rate&rdquo;. Alternative: &ldquo;pop&rdquo;.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_years">years</code></td>
<td>
<p>Vector indicating which years to plot. Default: all available years.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_ages">ages</code></td>
<td>
<p>Vector indicating which ages to plot. Default: all available ages.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_max.age">max.age</code></td>
<td>
<p>Maximum age to plot. Default: all available ages.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_transform">transform</code></td>
<td>
<p>Should a transformation of the data be plotted? Default is TRUE if the object contains mortality data and datatype=&quot;rate&quot;, and FALSE otherwise.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_plot.type">plot.type</code></td>
<td>
<p>Type of plot: either &ldquo;functions&rdquo; or &ldquo;time&rdquo;.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_type">type</code></td>
<td>
<p>What type of plot should be drawn. See <code><a href="base.html#topic+plot">plot</a></code> for possible types.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_main">main</code></td>
<td>
<p>Main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_...">...</code></td>
<td>
<p>Other plotting parameters. In <code>points.demogdata</code>, all arguments are passed to <code>lines.demogdata</code>.</p>
</td></tr>
<tr><td><code id="plot.demogdata_+3A_pch">pch</code></td>
<td>
<p>Plotting character.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Function produces a plot
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(fr.mort)
par(mfrow=c(1,2))
plot(aus.fert,plot.type="time")
plot(aus.fert,plot.type="functions")
</code></pre>

<hr>
<h2 id='plot.errorfdm'>Plot differences between actuals and estimates from fitted demographic model</h2><span id='topic+plot.errorfdm'></span>

<h3>Description</h3>

<p>Function produces a plot of errors from a fitted demographic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'errorfdm'
plot(x, transform = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.errorfdm_+3A_x">x</code></td>
<td>
<p>Object of class <code>"errorfdm"</code> generated by <code><a href="#topic+compare.demogdata">compare.demogdata</a></code>.</p>
</td></tr>
<tr><td><code id="plot.errorfdm_+3A_transform">transform</code></td>
<td>
<p>Plot errors on transformed scale or original scale?</p>
</td></tr>
<tr><td><code id="plot.errorfdm_+3A_...">...</code></td>
<td>
<p>Plotting parameters.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><a href="#topic+compare.demogdata">compare.demogdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fr.fit &lt;- lca(extract.years(fr.mort,years=1921:1980))
fr.error &lt;- compare.demogdata(fr.mort, forecast(fr.fit,20))
plot(fr.error)

</code></pre>

<hr>
<h2 id='plot.fmforecast'>Plot forecasts from a functional demographic modell</h2><span id='topic+plot.fmforecast'></span><span id='topic+plot.lca'></span>

<h3>Description</h3>

<p>Type of plot depends on value of <code>plot.type</code>: </p>

<dl>
<dt><code>plot.type="function"</code></dt><dd><p>produces a plot of the forecast
functions;</p>
</dd> <dt><code>plot.type="components"</code></dt><dd><p>produces a plot of the basis
functions and coefficients with forecasts and prediction intervals for each
coefficient;</p>
</dd> <dt><code>plot.type="variance"</code></dt><dd><p>produces a plot of the
variance components.</p>
</dd> </dl>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fmforecast'
plot(
  x,
  plot.type = c("function", "component", "variance"),
  vcol = 1:4,
  mean.lab = "Mean",
  xlab2 = "Year",
  h = 1,
  ...
)

## S3 method for class 'lca'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fmforecast_+3A_x">x</code></td>
<td>
<p>Output from <code><a href="ftsa.html#topic+forecast.ftsm">forecast.ftsm</a></code>,
<code><a href="#topic+forecast.fdm">forecast.fdm</a></code> or <code><a href="#topic+lca">lca</a></code>.</p>
</td></tr>
<tr><td><code id="plot.fmforecast_+3A_plot.type">plot.type</code></td>
<td>
<p>Type of plot. See details.</p>
</td></tr>
<tr><td><code id="plot.fmforecast_+3A_vcol">vcol</code></td>
<td>
<p>Colors to use if <code>plot.type="variance"</code>.</p>
</td></tr>
<tr><td><code id="plot.fmforecast_+3A_mean.lab">mean.lab</code></td>
<td>
<p>Label for mean component.</p>
</td></tr>
<tr><td><code id="plot.fmforecast_+3A_xlab2">xlab2</code></td>
<td>
<p>x-axis label for coefficient time series.</p>
</td></tr>
<tr><td><code id="plot.fmforecast_+3A_h">h</code></td>
<td>
<p>If <code>plot.type="variance"</code>, h gives the forecast horizon for
which the variance is plotted.</p>
</td></tr>
<tr><td><code id="plot.fmforecast_+3A_...">...</code></td>
<td>
<p>Other arguments are passed to <code><a href="#topic+plot.demogdata">plot.demogdata</a></code> (if
<code>plot.type=="function"</code>), <code><a href="base.html#topic+plot">plot</a></code> (if
<code>plot.type=="variance"</code>) or <code><a href="ftsa.html#topic+plot.ftsf">plot.ftsf</a></code> (if
<code>plot.type=="component"</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Function produces a plot
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><a href="#topic+fdm">fdm</a>, <a href="#topic+lca">lca</a>, <a href="#topic+forecast.fdm">forecast.fdm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.fcast &lt;- forecast(fdm(fr.mort))
plot(france.fcast)
plot(france.fcast,"c")
plot(france.fcast,"v")
</code></pre>

<hr>
<h2 id='plot.lifetable'>Plot life expectancy from lifetable</h2><span id='topic+plot.lifetable'></span><span id='topic+lines.lifetable'></span>

<h3>Description</h3>

<p>plots life expectancy for each age and each year as functional time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lifetable'
plot(
  x,
  years = x$year,
  main,
  xlab = "Age",
  ylab = "Expected number of years left",
  ...
)

## S3 method for class 'lifetable'
lines(x, years = x$year, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.lifetable_+3A_x">x</code></td>
<td>
<p>Output from <code><a href="#topic+lifetable">lifetable</a></code>.</p>
</td></tr>
<tr><td><code id="plot.lifetable_+3A_years">years</code></td>
<td>
<p>Years to plot. Default: all available years.</p>
</td></tr>
<tr><td><code id="plot.lifetable_+3A_main">main</code></td>
<td>
<p>Main title.</p>
</td></tr>
<tr><td><code id="plot.lifetable_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis.</p>
</td></tr>
<tr><td><code id="plot.lifetable_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis.</p>
</td></tr>
<tr><td><code id="plot.lifetable_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="rainbow.html#topic+plot.fds">plot.fds</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+life.expectancy">life.expectancy</a></code>, <code><a href="#topic+lifetable">lifetable</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.lt &lt;- lifetable(fr.mort)
plot(france.lt)

france.LC &lt;- lca(fr.mort)
france.fcast &lt;- forecast(france.LC)
france.lt.f &lt;- lifetable(france.fcast)
plot(france.lt.f,years=2010)
</code></pre>

<hr>
<h2 id='pop.sim'>Population simulation</h2><span id='topic+pop.sim'></span>

<h3>Description</h3>

<p>Simulate future sample paths of a population using functional models for mortality, fertility and migration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pop.sim(
  mort,
  fert = NULL,
  mig = NULL,
  firstyearpop,
  N = 100,
  mfratio = 1.05,
  bootstrap = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pop.sim_+3A_mort">mort</code></td>
<td>
<p>Forecasts of class <code>fmforecast2</code> for mortality.</p>
</td></tr>
<tr><td><code id="pop.sim_+3A_fert">fert</code></td>
<td>
<p>Forecasts of class <code>fmforecast</code> for female fertility.</p>
</td></tr>
<tr><td><code id="pop.sim_+3A_mig">mig</code></td>
<td>
<p>Forecasts of class <code>fmforecast2</code> for net migration.</p>
</td></tr>
<tr><td><code id="pop.sim_+3A_firstyearpop">firstyearpop</code></td>
<td>
<p>Population for first year of simulation.</p>
</td></tr>
<tr><td><code id="pop.sim_+3A_n">N</code></td>
<td>
<p>Number of sample paths to simulate.</p>
</td></tr>
<tr><td><code id="pop.sim_+3A_mfratio">mfratio</code></td>
<td>
<p>Male-female ratio used in distributing births.</p>
</td></tr>
<tr><td><code id="pop.sim_+3A_bootstrap">bootstrap</code></td>
<td>
<p>If TRUE, simulation uses resampled errors rather than normally distributed errors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two arrays containing male and female future simulated population values.
The arrays are of dimension (p,h,N) where p is the number of age groups, h is the forecast horizon
and N is the number of simulated sample paths.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simulate.fmforecast">simulate.fmforecast</a></code>, <code><a href="#topic+simulate.fmforecast2">simulate.fmforecast2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
require(addb)
# Construct data objects
mort.sm &lt;- smooth.demogdata(set.upperage(extract.years(australia,1950:2002),100))
fert.sm &lt;- smooth.demogdata(extract.years(aus.fertility,1950:2002))
aus.mig &lt;- netmigration(set.upperage(australia,100),aus.fertility,mfratio=1.0545)
# Fit models
mort.fit &lt;- coherentfdm(mort.sm)
fert.fit &lt;- fdm(fert.sm)
mig.fit &lt;- coherentfdm(aus.mig)
# Produce forecasts
mort.fcast &lt;- forecast(mort.fit)
fert.fcast &lt;- forecast(fert.fit)
mig.fcast &lt;- forecast(mig.fit)
# Simulate
aus.sim &lt;- pop.sim(mort.fcast,fert.fcast,mig.fcast,australia)
## End(Not run)

</code></pre>

<hr>
<h2 id='read.demogdata'>Read demographic data and construct demogdata object</h2><span id='topic+read.demogdata'></span>

<h3>Description</h3>

<p>Read data from text files and construct a demogdata object suitable for
plotting using <code><a href="#topic+plot.demogdata">plot.demogdata</a></code> and fitting an LC or BMS model
using <code><a href="#topic+lca">lca</a></code> or an FDA model using <code><a href="#topic+fdm">fdm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.demogdata(
  file,
  popfile,
  type,
  label,
  max.mx = 10,
  skip = 2,
  popskip = skip,
  lambda,
  scale = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.demogdata_+3A_file">file</code></td>
<td>
<p>Filename containing demographic rates.</p>
</td></tr>
<tr><td><code id="read.demogdata_+3A_popfile">popfile</code></td>
<td>
<p>Filename containing population numbers.</p>
</td></tr>
<tr><td><code id="read.demogdata_+3A_type">type</code></td>
<td>
<p>Character string showing type of demographic series:
either &ldquo;mortality&rdquo;, &ldquo;fertility&rdquo; or &ldquo;migration&rdquo;.</p>
</td></tr>
<tr><td><code id="read.demogdata_+3A_label">label</code></td>
<td>
<p>Name of area from which the data are taken.</p>
</td></tr>
<tr><td><code id="read.demogdata_+3A_max.mx">max.mx</code></td>
<td>
<p>Maximum allowable value for demographic rate. All values greater than max.mx will be set to max.mx.</p>
</td></tr>
<tr><td><code id="read.demogdata_+3A_skip">skip</code></td>
<td>
<p>Number of lines to skip at the start of <code>file</code>.</p>
</td></tr>
<tr><td><code id="read.demogdata_+3A_popskip">popskip</code></td>
<td>
<p>Number of lines to skip at the start of <code>popfile</code>.</p>
</td></tr>
<tr><td><code id="read.demogdata_+3A_lambda">lambda</code></td>
<td>
<p>Box-Cox transformation parameter to be used in modelling and plotting. If missing, default values are 0 (for mortality), 0.4 (for fertility) and 1 (for migration).</p>
</td></tr>
<tr><td><code id="read.demogdata_+3A_scale">scale</code></td>
<td>
<p>Number of people in the rate definition. <code>scale=1</code> indicates the rates are per person; <code>scale=1000</code> indicates the rates are per 1000 people.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All data are assumed to be tab-delimited text files with the first column
containing the year of observation and the second column containing the age
level. All remaining columns are assumed to be demographic rates for sections
of the population. The first row of the text file is assumed to contain the
names of each column. Population data are assumed to have the same format but
with population numbers in place of  rates.  The columns names in the two
files should be identical. Note that this format is what is used by the Human
Mortality Database <a href="http://www.mortality.org">http://www.mortality.org</a>. If <code>popfile</code> contains
the Exposures and <code>file</code> contains the Mx rates from the HMD, then
everything will work seamlessly.
</p>


<h3>Value</h3>

<p>Object of class &ldquo;demogdata&rdquo; with the following components:
</p>
<table>
<tr><td><code>year</code></td>
<td>
<p>Vector of years</p>
</td></tr> <tr><td><code>age</code></td>
<td>
<p>Vector of ages</p>
</td></tr> <tr><td><code>rate</code></td>
<td>
<p>A list
containing one or more rate matrices with one age group per row and one
column per year.</p>
</td></tr> <tr><td><code>pop</code></td>
<td>
<p>A list of the same form as <code>rate</code> but
containing population numbers instead of demographic rates.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of object: &ldquo;mortality&rdquo;, &ldquo;fertility&rdquo; or
&ldquo;migration&rdquo;.</p>
</td></tr> <tr><td><code>label</code></td>
<td>
<p>label</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+demogdata">demogdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## Not run:  norway &lt;- read.demogdata("Mx_1x1.txt",
  "Exposures_1x1.txt", type="mortality", label="Norway")
## End(Not run)
</code></pre>

<hr>
<h2 id='residuals.fdm'>Compute residuals and fitted values from functional demographic model or
Lee-Carter model</h2><span id='topic+residuals.fdm'></span><span id='topic+fitted.fdm'></span><span id='topic+fitted.lca'></span><span id='topic+residuals.lca'></span>

<h3>Description</h3>

<p>After fitting a Lee-Carter model or functional demographic model, it is
useful to inspect the residuals or plot the fitted values. These functions
extract the relevant information from the fit object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fdm'
residuals(object, ...)

## S3 method for class 'fdm'
fitted(object, ...)

## S3 method for class 'lca'
fitted(object, ...)

## S3 method for class 'lca'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.fdm_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+fdm">fdm</a></code> or <code><a href="#topic+lca">lca</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.fdm_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>residuals.fdm</code> and <code>residuals.lca</code> produce an object of
class &ldquo;fmres&rdquo; containing the residuals from the model.
<code>fitted.fdm</code> and <code>fitted.lca</code> produce an object of class
&ldquo;fts&rdquo; containing the fitted values from the model.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdm">fdm</a></code>, <code><a href="#topic+lca">lca</a></code>, <code><a href="#topic+bms">bms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  fit1 &lt;- lca(fr.mort)
  plot(residuals(fit1))
  plot(fitted(fit1))

</code></pre>

<hr>
<h2 id='set.upperage'>Combine the upperages of a demogdata object.</h2><span id='topic+set.upperage'></span>

<h3>Description</h3>

<p>Computes demographic rates by combining age groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.upperage(data, max.age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set.upperage_+3A_data">data</code></td>
<td>
<p>Demogdata object such as created using <code><a href="#topic+read.demogdata">read.demogdata</a></code> or <code><a href="#topic+smooth.demogdata">smooth.demogdata</a></code>.</p>
</td></tr>
<tr><td><code id="set.upperage_+3A_max.age">max.age</code></td>
<td>
<p>Upper age group. Ages beyond this are combined into the upper age group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Demogdata object with same components as <code>data</code> but with a subset of ages.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.short &lt;- set.upperage(fr.mort, 85)
</code></pre>

<hr>
<h2 id='sex.ratio'>Compute sex ratios from mortality rates</h2><span id='topic+sex.ratio'></span>

<h3>Description</h3>

<p>Calculates the Male/Female ratios from historical or forecasted mortality rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sex.ratio(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sex.ratio_+3A_data">data</code></td>
<td>
<p>Demogdata object of type &ldquo;mortality&rdquo; such as obtained from <code><a href="#topic+read.demogdata">read.demogdata</a></code>,
or an object of class <code>fmforecast</code> such as the output from  <code><a href="#topic+forecast.fdm">forecast.fdm</a></code> or <code><a href="#topic+forecast.lca">forecast.lca</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Functional time series of sex ratios.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(sex.ratio(fr.mort),ylab="Sex ratios (M/F)")
</code></pre>

<hr>
<h2 id='simulate.fmforecast'>Simulate future sample paths from functional demographic model forecasts.</h2><span id='topic+simulate.fmforecast'></span><span id='topic+simulate.fmforecast2'></span>

<h3>Description</h3>

<p>This function will simulate future sample paths given forecasting models
from a functional demographic model such as those obtained using <code><a href="#topic+forecast.fdm">forecast.fdm</a></code> or <code><a href="#topic+forecast.fdmpr">forecast.fdmpr</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fmforecast'
simulate(
  object,
  nsim = 100,
  seed = NULL,
  bootstrap = FALSE,
  adjust.modelvar = TRUE,
  ...
)

## S3 method for class 'fmforecast2'
simulate(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate.fmforecast_+3A_object">object</code></td>
<td>
<p>Object of class <code>fmforecast</code>. Typically, this is output from <code><a href="#topic+forecast.fdm">forecast.fdm</a></code>.</p>
</td></tr>
<tr><td><code id="simulate.fmforecast_+3A_nsim">nsim</code></td>
<td>
<p>Number of sample paths to simulate.</p>
</td></tr>
<tr><td><code id="simulate.fmforecast_+3A_seed">seed</code></td>
<td>
<p>Either NULL or an integer that will be used in a call to set.seed before simulating the time seriers.
The default, NULL will not change the random generator state.</p>
</td></tr>
<tr><td><code id="simulate.fmforecast_+3A_bootstrap">bootstrap</code></td>
<td>
<p>If TRUE, simulation uses resampled errors rather than normally distributed errors.</p>
</td></tr>
<tr><td><code id="simulate.fmforecast_+3A_adjust.modelvar">adjust.modelvar</code></td>
<td>
<p>If TRUE, will adjust the model variance by the ratio of the empirical and theoretical variances for one-step forecasts.</p>
</td></tr>
<tr><td><code id="simulate.fmforecast_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>simulate.fmforecast</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array containing the future simulated values (in the case of a <code>fmforecast</code> object),
or a list of arrays containing the future simulated values (in the case of a <code>fmforecast2</code> object).
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+forecast.fdm">forecast.fdm</a></code>, <code><a href="#topic+forecast.lca">forecast.lca</a></code>, <code><a href="ftsa.html#topic+forecast.ftsm">forecast.ftsm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
france.fit &lt;- fdm(fr.mort,order=2)
france.fcast &lt;- forecast(france.fit,50,method="ets")
france.sim &lt;- simulate(france.fcast,nsim=100)

france.fit2 &lt;- coherentfdm(fr.sm)
france.fcast2 &lt;- forecast(france.fit2,50)
france.sim2 &lt;- simulate(france.fcast2,nsim=100)
## End(Not run)
</code></pre>

<hr>
<h2 id='smooth.demogdata'>Create smooth demogdata functions</h2><span id='topic+smooth.demogdata'></span>

<h3>Description</h3>

<p>Smooth demogdata data using one of four methods depending on the value of <code>method</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth.demogdata(
  data,
  method = switch(data$type, mortality = "mspline", fertility = "cspline", migration =
    "loess"),
  age.grid,
  power = switch(data$type, mortality = 0.4, fertility = 1, migration = 1),
  b = 65,
  k = 30,
  span = 0.2,
  lambda = 1e-10,
  interpolate = FALSE,
  weight = data$type != "migration",
  obs.var = "empirical"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smooth.demogdata_+3A_data">data</code></td>
<td>
<p>Demogdata object such as created using <code><a href="#topic+read.demogdata">read.demogdata</a></code>.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_method">method</code></td>
<td>
<p>Method of smoothing. Possibilities: <code>"mspline"</code> (monotonic regression splines),
<code>"cspline"</code> (concave regression splines),
<code>"spline"</code> (unconstrained regression splines),
<code>"loess"</code> (local quadratic using <code><a href="stats.html#topic+loess">loess</a></code>).</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_age.grid">age.grid</code></td>
<td>
<p>Ages to use for smoothed curves. Default is single years over a slightly greater range than the unsmoothed data.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_power">power</code></td>
<td>
<p>Power transformation for age variable before smoothing. Default is 0.4 for mortality data and 1 (no transformation) for fertility or migration data.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_b">b</code></td>
<td>
<p>Lower age for monotonicity if <code>method=="mspline"</code>. Above this, the smooth curve
is assumed to be monotonically increasing.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_k">k</code></td>
<td>
<p>Number of knots to use for penalized regression spline estimate. Ignored if <code>method=="loess"</code>.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_span">span</code></td>
<td>
<p>Span for loess smooth if <code>method=="loess"</code>.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_lambda">lambda</code></td>
<td>
<p>Penalty for constrained regression spline if <code>method=="cspline"</code>.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_interpolate">interpolate</code></td>
<td>
<p>If <code>interpolate==TRUE</code>, a linear interpolation is used instead of smoothing.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_weight">weight</code></td>
<td>
<p>If TRUE, uses weighted smoothing.</p>
</td></tr>
<tr><td><code id="smooth.demogdata_+3A_obs.var">obs.var</code></td>
<td>
<p>Method for computing observational variance. Possible values: &ldquo;empirical&rdquo; or &ldquo;theoretical&rdquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of <code>method</code> determines the type of smoothing used.
</p>

<dl>
<dt>method=&quot;mspline&quot;</dt><dd><p>Weighted penalized regression splines with a monotonicity constraint. The curves are monotonically
increasing for age greater than b. Smoothness controlled by <code>k</code>. Methodology based on Wood (1994). Code calls <code><a href="mgcv.html#topic+gam">gam</a></code> for the basic
computations.</p>
</dd>
<dt>method=&quot;cspline&quot;</dt><dd><p>Weighted regression B-splines with a concavity constraint. Smoothness controlled by <code>lambda</code>.
Methodology based on He and Ng (1999). Code calls <code><a href="cobs.html#topic+cobs">cobs</a></code> for the basic computations.</p>
</dd>
<dt>method=&quot;spline&quot;</dt><dd><p>Unconstrained weighted penalized regression splines. Equivalent to &quot;mspline&quot; but with <code>b=Inf</code>.</p>
</dd>
<dt>method=&quot;loess&quot;</dt><dd><p>Weighted locally quadratic regression. Smoothness controlled by span. Code calls
<code><a href="stats.html#topic+loess">loess</a></code> for the basic computations.</p>
</dd>
</dl>



<h3>Value</h3>

<p>Demogdata object identical to <code>data</code> except all
rate matrices are replaced with smooth versions and pop matrices are replaced with disaggregated population estimates obtained
using monotonic spline interpolation applied to the cumulative population data.
Weight
matrices are also added to the object showing the inverse
variances of the estimated smooth curves.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>Examples</h3>

<pre><code class='language-R'>france.sm &lt;- smooth.demogdata(extract.years(fr.mort,1980:1997))
plot(france.sm)
plot(fr.mort,years=1980,type="p",pch=1)
lines(france.sm,years=1980,col=2)


</code></pre>

<hr>
<h2 id='summary.fdm'>Summary for functional demographic model or Lee-Carter model</h2><span id='topic+summary.fdm'></span><span id='topic+summary.lca'></span>

<h3>Description</h3>

<p>Summarizes a basis function model fitted to age-specific demographic rate
data. It returns various measures of goodness-of-fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fdm'
summary(object, ...)

## S3 method for class 'lca'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.fdm_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+fdm">fdm</a></code> or <code><a href="#topic+lca">lca</a></code>.</p>
</td></tr>
<tr><td><code id="summary.fdm_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdm">fdm</a></code>, <code><a href="#topic+lca">lca</a></code>, <code><a href="#topic+bms">bms</a></code>,
<code><a href="#topic+compare.demogdata">compare.demogdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit1 &lt;- lca(fr.mort)
fit2 &lt;- bms(fr.mort,breakmethod="bai")
fit3 &lt;- fdm(fr.mort)
summary(fit1)
summary(fit2)
summary(fit3)
</code></pre>

<hr>
<h2 id='tfr'>Compute total fertility rate from fertility rates</h2><span id='topic+tfr'></span>

<h3>Description</h3>

<p>Compute total fertility rates from age-specific fertility rates contained in
a <code>demogdata</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tfr(data, PI = FALSE, nsim = 500, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tfr_+3A_data">data</code></td>
<td>
<p>Demogdata object of type <code>"fertility"</code> such as obtained from
<code><a href="#topic+read.demogdata">read.demogdata</a></code>, <code><a href="#topic+forecast.fdm">forecast.fdm</a></code>.</p>
</td></tr>
<tr><td><code id="tfr_+3A_pi">PI</code></td>
<td>
<p>If TRUE, produce a prediction interval.</p>
</td></tr>
<tr><td><code id="tfr_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations to use when computing a prediction
interval.</p>
</td></tr>
<tr><td><code id="tfr_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>simulate</code> when producing
prediction intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If data are of class <code>demogdata</code>, the function returns a time
series of fertility rates. If data are from <code><a href="#topic+forecast.fdm">forecast.fdm</a></code>, the
function returns an object of class <code>forecast</code> containing point
forecasts and (optionally) prediction intervals.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdm">fdm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(tfr(aus.fert))
ausfert.fcast &lt;- forecast(fdm(aus.fert))
plot(tfr(ausfert.fcast,PI=TRUE,nsim=400))

</code></pre>

<hr>
<h2 id='update'>Updating functional demographic models and coherent functional demographic models.</h2><span id='topic+update'></span><span id='topic+update.fmforecast'></span><span id='topic+update.fmforecast2'></span>

<h3>Description</h3>

<p><code>update.fmforecast()</code> updates <code>fdm</code> forecasts. The argument <code>object</code> is the output from <code><a href="#topic+forecast.fdm">forecast.fdm</a></code> which has been subsequently modified with new coefficient forecasts. These new forecasts are used when re-calculating the forecast of the mortality or fertility rates, or net migration numbers.
<code>update.fmforecast2()</code> updates <code>fdmpr</code> forecasts. The argument <code>object</code> is the output from <code><a href="#topic+forecast.fdmpr">forecast.fdmpr</a></code> which has been subsequently modified with new coefficient forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fmforecast'
update(object, ...)

## S3 method for class 'fmforecast2'
update(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_+3A_object">object</code></td>
<td>
<p>Output from either <code><a href="#topic+fdm">fdm</a></code> or <code><a href="#topic+coherentfdm">coherentfdm</a></code>.</p>
</td></tr>
<tr><td><code id="update_+3A_...">...</code></td>
<td>
<p>Extra arguments currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the same class as <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+forecast.fdm">forecast.fdm</a></code>, <code><a href="#topic+forecast.fdmpr">forecast.fdmpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
france.fit &lt;- fdm(fr.mort,order=2)
france.fcast &lt;- forecast(france.fit,50)
# Replace first coefficient model with ARIMA(0,1,2)+drift
france.fcast$coeff[[2]] &lt;- forecast(Arima(france.fit$coeff[,2],
                                          order=c(0,1,2), include.drift=TRUE), h=50, level=80)
france.fcast &lt;- update(france.fcast)

fr.short &lt;- extract.years(fr.sm,1950:2006)
fr.fit &lt;- coherentfdm(fr.short)
fr.fcast &lt;- forecast(fr.fit)
par(mfrow=c(1,2))
plot(fr.fcast$male)
# Replace first coefficient model in product component with a damped ETS model:
fr.fcast$product$coeff[[2]] &lt;- forecast(ets(fr.fit$product$coeff[,2], damped=TRUE),
                                        h=50, level=80)
fr.fcast &lt;- update(fr.fcast)
plot(fr.fcast$male)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
