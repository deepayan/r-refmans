<!DOCTYPE html><html><head><title>Help for package VulnToolkit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VulnToolkit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dur.bias'><p>Calculates bias in flooding duration estimates due to logger deployment time</p></a></li>
<li><a href='#dur.events'><p>Calculates the duration of the median (or other percentile) flooding event</p></a></li>
<li><a href='#fld.depth'><p>Calculates flooding depth above an elevation of interest</p></a></li>
<li><a href='#fld.dur'><p>Flooding duration</p></a></li>
<li><a href='#fld.frq'><p>Flooding frequency</p></a></li>
<li><a href='#form.no'><p>Calculate tidal form number</p></a></li>
<li><a href='#harcon'><p>Scrapes harmonic constituent data from NOAA CO-OPS website</p></a></li>
<li><a href='#HL'><p>Extracts high and low tides from a record of water levels</p></a></li>
<li><a href='#HL.plot'><p>Plots water level data and high/low tides extracted by <code>HL()</code></p></a></li>
<li><a href='#NL_6min_2013'><p>New London water levels, 2013</p></a></li>
<li><a href='#noaa'><p>Downloads NOAA CO-OPS tide data</p></a></li>
<li><a href='#noaa.datums'><p>Scrapes elevation datums from NOAA CO-OPS website</p></a></li>
<li><a href='#noaa.parameters'><p>Reports data available for a NOAA station</p></a></li>
<li><a href='#number.tides'><p>Numbers tidal cycles, flood tides, and ebb tides</p></a></li>
<li><a href='#psmsl'><p>Download sea level data from Permanent Service for Mean Sea Level</p></a></li>
<li><a href='#psmsl.stations'><p>Generates a list of active and historic PSMSL stations</p></a></li>
<li><a href='#wave.dur'><p>Find the proportion of time when water surface is near a selected elevation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Tidal Datasets</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-07-30</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/troyhill/VulnToolKit/issues">https://github.com/troyhill/VulnToolKit/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions for analysis and summary of tidal datasets. Also provides access to tidal data collected by the National Oceanic and Atmospheric Administration's Center for Operational Oceanographic Products and Services and the Permanent Service for Mean Sea Level. For detailed description and application examples, see Hill, T.D. and S.C. Anisfeld (2021) &lt;<a href="https://doi.org/10.6084%2Fm9.figshare.14161202.v1">doi:10.6084/m9.figshare.14161202.v1</a>&gt; and Hill, T.D. and S.C. Anisfeld (2015) &lt;<a href="https://doi.org/10.1016%2Fj.ecss.2015.06.004">doi:10.1016/j.ecss.2015.06.004</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/troyhill/VulnToolkit">https://github.com/troyhill/VulnToolkit</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>XML, plyr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-02 12:48:53 UTC; tdh</td>
</tr>
<tr>
<td>Author:</td>
<td>Troy Hill <a href="https://orcid.org/0000-0003-2980-4099"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Shimon Anisfeld [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Troy Hill &lt;Hill.Troy@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-02 13:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dur.bias'>Calculates bias in flooding duration estimates due to logger deployment time</h2><span id='topic+dur.bias'></span>

<h3>Description</h3>

<p>Seasonality in water levels imparts  bias to flooding duration 
datasets built from short-term water level data. <code>dur.bias</code> calculates 
and presents these biases in visual and tabular form.
</p>
<p>Using data from a nearby, user-defined NOAA station, bias is estimated by comparing the 
relationship between flooding duration and elevation in datasets covering two time periods: 
(1) the time periodof water level logger deployment, and (2) the reference time period 
(some number of years).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dur.bias(
  data,
  dateCol = 1,
  station = 8518750,
  ref.period = c("20120101", "20121231"),
  time = "GMT"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dur.bias_+3A_data">data</code></td>
<td>
<p>water level dataset. must have a time stamp column named 'datetime' with the first ten 
digits following the format <code>YYYY-MM-DD</code>.Different separators are fine, but the 
placement and number of digits for year, month, and day are critical. Date range 
must be continuous, or the &quot;estimated&quot; curve won't be accurate (datasets with gaps won't 
work well)</p>
</td></tr>
<tr><td><code id="dur.bias_+3A_datecol">dateCol</code></td>
<td>
<p>index number of the column in 'data' containing dates. Must be a date/POSIX datatype.</p>
</td></tr>
<tr><td><code id="dur.bias_+3A_station">station</code></td>
<td>
<p>name or number of NOAA station to be used for reference data. Ideally, 
use the station closest to where your water level data was collected. This is fed 
to <code><a href="#topic+noaa">noaa</a></code> so must be compatible with <code>noaa</code>'s <code>station</code> argument.</p>
</td></tr>
<tr><td><code id="dur.bias_+3A_ref.period">ref.period</code></td>
<td>
<p>downloads NOAA tide data to set reference flooding-elevation relationship. This 
is used to evaluate accuracy of flooding duration estimates determined by water level 
deployment. Use of whole years is recommended. dates must be entered in format 
<code>YYYYMMDD</code>, in the form <code>(c(start_date, end_date))</code>.</p>
</td></tr>
<tr><td><code id="dur.bias_+3A_time">time</code></td>
<td>
<p>time zone to download reference data (<code>GMT</code> is default; the NOAA website 
does not have all data available in all time zones.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Seasonality in water levels imparts  bias to flooding duration datasets 
built from short-term water level data. <code>dur.bias</code> calculates and presents 
these biases in visual and tabular form.
</p>


<h3>Value</h3>

<p>(1) A summary of root mean square errors is printed, 
(2) a data frame of elevations, flooding duration estimates, and their associated bias 
estimates is saved as output, and (3) two plots are made, graphically showing the 
relationship between predicted and reference flooding duration curves.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+noaa">noaa</a></code>,<code><a href="#topic+fld.dur">fld.dur</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
NL_extract &lt;- NL_6min_2013[NL_6min_2013[, 1] &lt; "2013-02-01", ]
dur.bias(data = NL_extract, station = 8518750, ref.period = c("20130101", "20131231"))

## End(Not run)
</code></pre>

<hr>
<h2 id='dur.events'>Calculates the duration of the median (or other percentile) flooding event</h2><span id='topic+dur.events'></span>

<h3>Description</h3>

<p>Calculates the duration of the median (or other percentile) flooding event
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dur.events(level, elevation, percentile = 0.5, units = "1 observation")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dur.events_+3A_level">level</code></td>
<td>
<p>a numeric vector of water levels or tide data</p>
</td></tr>
<tr><td><code id="dur.events_+3A_elevation">elevation</code></td>
<td>
<p>elevation(s) of interest (e.g., marsh platform, MHW). A vector 
of elevations is accepted. Elevation should be in the same vertical datum as <code>level</code></p>
</td></tr>
<tr><td><code id="dur.events_+3A_percentile">percentile</code></td>
<td>
<p>the percentile(s) to find (median flooding event is used by default)</p>
</td></tr>
<tr><td><code id="dur.events_+3A_units">units</code></td>
<td>
<p>the time interval between measurements. This argument enables conversion of 
flooding durations to hours. <code>units</code> must be a string of the form <code>XX units</code>, 
where <code>XX</code> is an integer and <code>units</code> can be <code>second</code>, <code>minute</code>, 
<code>hour</code>, or their plurals. When time units are specified, all time units are 
converted to hours in output. When units are not specified, the output reports the 
number of sequential observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The duration of individual flooding events is calculated from water level data.
<code>dur.events()</code> differs from <code>fld.dur()</code> in that the former examines 
individual flooding events, rather than cumulative inundation times.
</p>


<h3>Value</h3>

<p>the duration of the median (or other percentile) flooding event occurring at a given 
elevation. If <code>percentile</code> is of length one, the value(s) returned are the 
corresponding flooding duration percentiles for the elevation(s) of interest. To ensure 
clarity when more than one <code>percentile</code> is sought, in those cases a dataframe is 
output to report elevations and flooding durations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NL_6min_2013)
MHW &lt;- 0.9117  # New London MHW in 2013: 0.9117 m relative to MLLW

# median flooding duration at three elevations
dur.events(NL_6min_2013[, 2], elevation = c(0.5, MHW, 1.5), units = "6 minutes")

# a dataframe is output when results are more complex
dur.events(NL_6min_2013[, 2], elevation = MHW, 
           percentile = c(0.1, 0.5, 0.9), units = "6 minutes")
dur.events(NL_6min_2013[, 2], elevation = c(0.5, MHW, 1.5), 
  percentile = c(0.1, 0.5, 0.9), units = "6 minutes")

# dur.events() differs from fld.dur() in that it examines individual
# flooding events, rather than cumulative inundation

# The median flooding event at MHW lasts 2.9 hrs
dur.events(NL_6min_2013[, 2], elevation = MHW, units = "6 minutes")

# And over an entire year, MHW was flooded 13% of the time
fld.dur(z = MHW, NL_6min_2013[, 2])
</code></pre>

<hr>
<h2 id='fld.depth'>Calculates flooding depth above an elevation of interest</h2><span id='topic+fld.depth'></span>

<h3>Description</h3>

<p>Flooding depths are calculated from water level or tide data. 
If water levels are used, the median (or other percentile) flooding depth 
is calculated based on all observations of flooded conditions (when water 
depth is equal to or greater than the elevation of interest). If a high/low 
tide dataset is used, flooding depth percentiles will be just for high tides 
that flood the selected elevation. The latter case includes only peak high 
water levels, and so will yield greater flooding depths for the same elevation.
</p>
<p>Using data from a nearby, user-defined NOAA station, bias is estimated by comparing the 
relationship between flooding duration and elevation in datasets covering two time periods: 
(1) the time periodof water level logger deployment, and (2) the reference time period 
(some number of years).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fld.depth(level, elevation, percentile = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fld.depth_+3A_level">level</code></td>
<td>
<p>a numeric vector of water levels or tide data</p>
</td></tr>
<tr><td><code id="fld.depth_+3A_elevation">elevation</code></td>
<td>
<p>elevation(s) of interest (marsh platform, 
MHW). A vector of elevations is accepted. Elevation should 
be in the same vertical datum as <code>level</code></p>
</td></tr>
<tr><td><code id="fld.depth_+3A_percentile">percentile</code></td>
<td>
<p>the percentile(s) to calculate 
(median flooding depth is calculated by default). A 
vector of percentiles is accepted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>if 'percentile' argument is of length one, the value(s) 
returned are the corresponding flooding percentiles for the 
elevation(s) of interest. To ensure clarity when more than one 
'percentiles' are sought, in those cases a dataframe is output 
to report elevations and flooding depths.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+noaa">noaa</a></code>, <code><a href="#topic+fld.dur">fld.dur</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NL_6min_2013)
MHW &lt;- 0.9117  # New London MHW in 2013: 0.9117 m relative to MLLW
fld.depth(level = NL_6min_2013[, 2], elevation = MHW,
         percentile = 0.5)

fld.depth(level = NL_6min_2013[, 2], elevation = MHW, 
         percentile = c(0.25, 0.5, 0.75))

fld.depth(level = NL_6min_2013[, 2], elevation = c(0, MHW, 1.5), 
         percentile = 0.75)

fld.depth(level = NL_6min_2013[, 2], elevation = c(0, MHW, 1.5), 
         percentile = c(0.25, 0.5, 0.75))
</code></pre>

<hr>
<h2 id='fld.dur'>Flooding duration</h2><span id='topic+fld.dur'></span>

<h3>Description</h3>

<p>Calculates the percent of time an elevation is submerged
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fld.dur(z, level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fld.dur_+3A_z">z</code></td>
<td>
<p>elevation of interest</p>
</td></tr>
<tr><td><code id="fld.dur_+3A_level">level</code></td>
<td>
<p>a numeric vector of water levels. Time interval between measurements must be uniform.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the percent of time an elevation is submerged
</p>


<h3>Value</h3>

<p>value the decimal fraction of measurements in <code>level</code> that fall above <code>z</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fld.frq">fld.frq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NL_6min_2013)
a &lt;- fld.dur(0.9117, NL_6min_2013[,2]); a # flooding duration at MHW
a * length(NL_6min_2013[,2]) / 10 # convert to hours per year

b &lt;- fld.dur(0, NL_6min_2013[,2]); b # flooding duration at MLLW
b * length(NL_6min_2013[,2]) / 10 # hours per year

elev.dur &lt;- data.frame(elev = seq(from = -0.5, to = 1.25, by = 0.005))
elev.dur$dur &lt;- fld.dur(elev.dur$elev, NL_6min_2013[,2]) * length(NL_6min_2013[,2]) / 10 

plot(elev.dur$dur ~ elev.dur$elev, pch = 19, 
ylab = "flooding duration (hours per year)", xlab = "elevation (m; MLLW)")
</code></pre>

<hr>
<h2 id='fld.frq'>Flooding frequency</h2><span id='topic+fld.frq'></span>

<h3>Description</h3>

<p>Calculates the frequency of high tides flooding an elevation of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fld.frq(z, ht, units = "percent")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fld.frq_+3A_z">z</code></td>
<td>
<p>elevation of interest</p>
</td></tr>
<tr><td><code id="fld.frq_+3A_ht">ht</code></td>
<td>
<p>a numeric vector of high tide levels</p>
</td></tr>
<tr><td><code id="fld.frq_+3A_units">units</code></td>
<td>
<p>units for output. Default is <code>percent</code>; the proportion of tides 
flooding elevation <code>x</code>. Alternatively, <code>tides</code> will return the number of 
flooding tides in the dataset</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the frequency of high tides flooding an elevation of interest.
</p>


<h3>Value</h3>

<p>value the number or percent of high tides in <code>vec</code> that fall above <code>z</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fld.dur">fld.dur</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get a dataset of high/low tides
HT.NL &lt;- HL(level = NL_6min_2013[, 2], time = NL_6min_2013[, 1], tides = "H")
a &lt;- fld.frq(z = 0.9117, ht = HT.NL[, 1], units = "tides") # number of flooding tides at MHW
a / length(HT.NL[, 1]) # flooding tides as a percentage of all tides in time period

fld.frq(0.9117, HT.NL[,1], units = "percent") # check 

b &lt;- as.numeric((NL_6min_2013[nrow(NL_6min_2013), 1] - 
NL_6min_2013[1, 1])) / 365.242 # fraction of year covered by dataset

elev.frq &lt;- data.frame(elev = seq(from = 0, to = 1.5, by = 0.005))

# error thrown if units = "tides" and length(x) &gt; length(ht)
fld.frq(elev.frq$elev, HT.NL[, 1], units = "tides") 

# a work-around
elev.frq$frq &lt;- fld.frq(elev.frq$elev, HT.NL[, 1], units = "percent") * 
length(HT.NL[, 1]) / b 

plot(elev.frq$frq ~ elev.frq$elev, pch = 19, 
ylab = "flooding frequency (tides per year)", xlab = "elevation (m; MLLW)")
</code></pre>

<hr>
<h2 id='form.no'>Calculate tidal form number</h2><span id='topic+form.no'></span>

<h3>Description</h3>

<p>Uses harmonic constituent data from the NOAA 
CO-OPS website to calculate tidal form numbers as the ratio 
of the sum of K1 and O1 diurnal harmonic constituent amplitudes 
to the sum of the M2 and S2 semidiurnal amplitudes. Requires 
an internet connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>form.no(station)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="form.no_+3A_station">station</code></td>
<td>
<p>station ID number or vector of IDs, available on CO-OPS 
website (<a href="https://www.tidesandcurrents.noaa.gov/stations.html?type=Water+Levels">https://www.tidesandcurrents.noaa.gov/stations.html?type=Water+Levels</a>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe of station number(s) and corresponding tidal form number(s).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
a &lt;- form.no()
stn.list &lt;- c("8467150", "8461490", "9454240")
b &lt;- form.no(stn.list)
b

## End(Not run) 
</code></pre>

<hr>
<h2 id='harcon'>Scrapes harmonic constituent data from NOAA CO-OPS website</h2><span id='topic+harcon'></span>

<h3>Description</h3>

<p>Scrapes harmonic constituent data from NOAA CO-OPS 
website. Requires an internet connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>harcon(station)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="harcon_+3A_station">station</code></td>
<td>
<p>station ID number or vector of IDs, available on CO-OPS 
website (<a href="https://www.tidesandcurrents.noaa.gov/stations.html?type=Water+Levels">https://www.tidesandcurrents.noaa.gov/stations.html?type=Water+Levels</a>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe of harmonic constituents and their associated phases, 
amplitudes, and speeds.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
bport.cons &lt;- harcon(8467150) # Bridgeport, CT
bport.cons

## End(Not run) 
</code></pre>

<hr>
<h2 id='HL'>Extracts high and low tides from a record of water levels</h2><span id='topic+HL'></span>

<h3>Description</h3>

<p>Extracts high and low tides from a record of water levels. For reliable results, the time interval between samples must be constant throughout the dataset (e.g., 1 sample per hour, 1 sample per 6 minutes). Datasets with irregularly-spaced observations should be expanded to the smallest time interval to avoid issues.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HL(
  level,
  time,
  period = 13,
  phantom = TRUE,
  tides = "all",
  semidiurnal = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HL_+3A_level">level</code></td>
<td>
<p>a numeric vector of water levels</p>
</td></tr>
<tr><td><code id="HL_+3A_time">time</code></td>
<td>
<p>a vector (numeric or POSIX*) indicating the time of water 
level measurements. Units must be minutes.</p>
</td></tr>
<tr><td><code id="HL_+3A_period">period</code></td>
<td>
<p>a single numeric or integer estimate of tidal period 
(full tidal cycle). Units must be hours.</p>
</td></tr>
<tr><td><code id="HL_+3A_phantom">phantom</code></td>
<td>
<p>a protective measure taken to prevent the inclusion of an 
artificial ('phantom') high or low tide at the end of the dataset, which occurs because the final observation is always a local maxima/minima for the period following the previous low/high tide. If the water level 
measurements end precisely at a low or high tide, this can be changed to FALSE.</p>
</td></tr>
<tr><td><code id="HL_+3A_tides">tides</code></td>
<td>
<p>is used to optionally subset the output to include 
only high or low tides. This argument can be 'all' (default), 'H', or 'L'</p>
</td></tr>
<tr><td><code id="HL_+3A_semidiurnal">semidiurnal</code></td>
<td>
<p>logical. If TRUE, higher- and lower- high/low tides are reported in a separate column called 'tide2'. Tides are grouped by day and assigned higher- or lower- status. When a single high or low tide exists in a day, tides on adjacent days are used to make an assignment.</p>
</td></tr>
<tr><td><code id="HL_+3A_verbose">verbose</code></td>
<td>
<p>logical. If TRUE, messages are returned to console identifying the presence of NAs in the input data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe of tide levels, associated time stamps, and tide 
type ('H' or 'L'). If there are NAs present in the water level or time datasets, a message reports this information in the console but the NAs are not removed or otherwise acted upon. The column indicating semidiurnal tides ('tide2') may be NA if tides are identical or in cases where there is a single tide in the first day of the dataset.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HL.plot">HL.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>HL.NL &lt;- VulnToolkit::HL(level = NL_6min_2013[,2], time = NL_6min_2013[,1])
head(HL.NL)

## Not run: 
### Important note: Problems arise when using irregularly-spaced data.
### The best solution is for the user to ensure their data are evenly-spaced.
### An example:
### 
### pull data at 6-minute intervals
dat.hr   &lt;- noaa(begindate = "20200101", enddate = "20200630", station = "8467150",
                 interval = "hourly")

### pull data at 1-hr intervals
dat.6min &lt;- noaa(begindate = "20200701", enddate = "20201231", station = "8467150",
                 interval = "6 minute")

dat.combined &lt;- rbind(dat.hr, dat.6min)
### if time interval is inconsistent the HL output can be unreliable
HL.plot(level = dat.combined[, 2], time = dat.combined[, 1]) 

### expand 1-hr dataset using the 6-minute time interval
timeSeq &lt;- data.frame(time_GMT = seq.POSIXt(from = min(dat.hr$time_GMT), 
                                            to = max(dat.hr$time_GMT), 
                                            by = "6 min"))
### create consistently-spaced dataset
dat.hr2       &lt;- plyr::join_all(list(timeSeq, dat.hr))
dat.combined2 &lt;- rbind(dat.hr2, dat.6min)
HL.plot(level = dat.combined2[, 2], time = dat.combined2[, 1]) 

## End(Not run)

</code></pre>

<hr>
<h2 id='HL.plot'>Plots water level data and high/low tides extracted by <code>HL()</code></h2><span id='topic+HL.plot'></span>

<h3>Description</h3>

<p>Plots water level data and high/low tides extracted 
by <code>HL()</code>. Purpose is for quick and easy visual assessment 
of <code>HL()</code> output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HL.plot(
  level,
  time,
  period = 13,
  phantom = TRUE,
  tides = "all",
  semidiurnal = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HL.plot_+3A_level">level</code></td>
<td>
<p>a numeric vector of water levels</p>
</td></tr>
<tr><td><code id="HL.plot_+3A_time">time</code></td>
<td>
<p>a vector (numeric or POSIX*) indicating the time of water 
level measurements. Units must be minutes.</p>
</td></tr>
<tr><td><code id="HL.plot_+3A_period">period</code></td>
<td>
<p>a single numeric or integer estimate of tidal period 
(full tidal cycle). Units must be hours.</p>
</td></tr>
<tr><td><code id="HL.plot_+3A_phantom">phantom</code></td>
<td>
<p>a protective measure taken to prevent the inclusion of an 
artificial high or low tide at the end of the dataset. If the water level 
measurements end precisely at a low or high tide, this can be changed to FALSE.</p>
</td></tr>
<tr><td><code id="HL.plot_+3A_tides">tides</code></td>
<td>
<p>is used to optionally subset the output to include 
only high or low tides. This argument can be 'all' (default), 'H', or 'L'</p>
</td></tr>
<tr><td><code id="HL.plot_+3A_semidiurnal">semidiurnal</code></td>
<td>
<p>logical. If TRUE, higher- and lower- high/low tides are reported in a separate column called 'tide2'</p>
</td></tr>
<tr><td><code id="HL.plot_+3A_verbose">verbose</code></td>
<td>
<p>logical. If TRUE, messages are returned to console identifying the presence of NAs in the input data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of water levels, with red and blue dots superimposed on high and low tides.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HL">HL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>HL.plot(level = NL_6min_2013[,2], time = NL_6min_2013[,1])
HL.plot(level = NL_6min_2013[1:1000,2], time = NL_6min_2013[1:1000,1]) 

### HL.plot can be annotated using base graphics
abline(h = -0.3, lty = 2) 
text(x = as.POSIXct("2013-01-01 00:00", format = "%F %R"), y = -0.25, 
     "elevation of interest", pos = 4)
mtext("plot title", side = 3)

### or extended with ggplot in various ways. 
## Not run: 
library(ggplot2) # install with install.packages("ggplot2")
ggHL &lt;- function(level, time, plotVariable = "tide2", period = 13, 
        phantom = TRUE, tides = "all", semidiurnal = TRUE) {
  hl &lt;- VulnToolkit::HL(level = level, time = time, period = period,
                        phantom = phantom, tides = tides, semidiurnal = semidiurnal)
  wll.2 &lt;- data.frame(1:length(level), level, time)
  plot_return &lt;- ggplot(data = wll.2, aes(x = time, y = level)) + 
    geom_line(col = "darkgray") + xlab("") +
    geom_point(data = hl, aes(x = time, y = level, col = get(plotVariable))) +
    theme_classic() + theme(legend.title = element_blank())
  plot_return
}
newPlot &lt;- ggHL(level = NL_6min_2013[1:1000,2], time = NL_6min_2013[1:1000,1])
newPlot

## End(Not run)


</code></pre>

<hr>
<h2 id='NL_6min_2013'>New London water levels, 2013</h2><span id='topic+NL_6min_2013'></span>

<h3>Description</h3>

<p>Water levels from NOAA-COOPS station number 8461490 in New London, CT. Data recorded at 6-minute intervals, in meters relative to MHW, and in the GMT time zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(NL_6min_2013)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 87591 rows and 3 variables.
</p>


<h3>Source</h3>

<p>downloaded from National Atmospheric and Oceanic Administration's Center for Operational Oceanographic Products and Services using <code>VulnToolkit::noaa()</code> 
</p>

<hr>
<h2 id='noaa'>Downloads NOAA CO-OPS tide data</h2><span id='topic+noaa'></span>

<h3>Description</h3>

<p>Scrapes water level data (and other measurements) from NOAA CO-OPS website. NOAA's site limits the time period for data downloads, but these constraints are avoided by 'noaa()'. Requires 
internet connection and curl (check availablility using 'Sys.which(&quot;curl&quot;)').
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noaa(begindate = "begindate", enddate = "enddate", station = "8467150",
met = FALSE, units = "meters", datum = "MHW", interval = "HL", time = "GMT", 
continuous = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noaa_+3A_begindate">begindate</code></td>
<td>
<p>first day of data to download. Format must be YYYYMMDD. If 
left unspecified, the first complete day of data will be used.</p>
</td></tr>
<tr><td><code id="noaa_+3A_enddate">enddate</code></td>
<td>
<p>final day of data to download. Format must be YYYYMMDD. If left 
unspecified, the last complete day of data will be used.</p>
</td></tr>
<tr><td><code id="noaa_+3A_station">station</code></td>
<td>
<p>station number, found on the NOAA Tides and Currents website 
(https://www.tidesandcurrents.noaa.gov/stations.html?type=Water+Levels).
Station numbers can be numeric or a character string (necessary if first 
character is a zero). Default station is Bridgeport, CT.</p>
</td></tr>
<tr><td><code id="noaa_+3A_met">met</code></td>
<td>
<p>whether meteorological data should be returned. This value can be 'TRUE' or 
'FALSE'; if 'TRUE', all ancillary parameters are returned. At present, this only 
works with 6-minute and hourly data</p>
</td></tr>
<tr><td><code id="noaa_+3A_units">units</code></td>
<td>
<p>can be 'feet' or 'meters'. Default is 'meters'</p>
</td></tr>
<tr><td><code id="noaa_+3A_datum">datum</code></td>
<td>
<p>vertical reference datum, set to 'MHW' by default. Can be 'station', 'NAVD', 
'MLLW', 'MLW', 'MSL', 'MTL', 'MHW', 'MHHW', or 'IGLD' (some datums are not available 
at some sites)</p>
</td></tr>
<tr><td><code id="noaa_+3A_interval">interval</code></td>
<td>
<p>sets measurement interval; can be 'HL' (default), '6 minute', 'hourly', or 'monthly'.</p>
</td></tr>
<tr><td><code id="noaa_+3A_time">time</code></td>
<td>
<p>can be 'LST', 'GMT', or 'LST/LDT'. Not all time zones are available for all data. 
GMT appears to have wider availability than LST, so it is the default.</p>
</td></tr>
<tr><td><code id="noaa_+3A_continuous">continuous</code></td>
<td>
<p>determines whether a continuous time series is produced, with lengthy gaps 
in data filled in with NAs. By default, this is <code>FALSE</code>. This option only applies 
to data at evenly spaced intervals (i.e., <code>6 minute</code> or <code>hourly</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Download water level and other data from NOAA CO-OPS website.
</p>


<h3>Value</h3>

<p>dataset a dataframe with water levels, associated time stamps, a station ID column, 
and tide type (if interval is set to <code>HL</code>). The NOAA CO-OPS website has many odd data 
availabilty problems. Some data are not available in all time intervals or time zones.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example requires an internet connection
bport2013 &lt;- noaa(begindate = 20130101, enddate = 20131231, 
  station = "8467150", interval = "6 minute")

test2.1 &lt;- noaa(begindate = "20100101", enddate = "20120101", interval = "hourly") 
test2.2 &lt;- noaa(begindate = "20100101", enddate = "20120101", interval = "hourly", 
               continuous = TRUE) 
nrow(test2.1) # includes data on NOAA site (incomplete record)
nrow(test2.2) # fills gaps with NAs 
test2.3 &lt;- noaa(begindate = "20100101", enddate = "20120101", interval = "hourly", 
               met = TRUE) 

## End(Not run)
</code></pre>

<hr>
<h2 id='noaa.datums'>Scrapes elevation datums from NOAA CO-OPS website</h2><span id='topic+noaa.datums'></span>

<h3>Description</h3>

<p>Scrapes elevation datums from NOAA CO-OPS website
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noaa.datums(station = 8467150)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noaa.datums_+3A_station">station</code></td>
<td>
<p>station ID number, available on the CO-OPS website.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Scrapes elevation datums from NOAA CO-OPS website. 
Requires an internet connection.
</p>


<h3>Value</h3>

<p>a dataframe of vertical datum names and their elevations in meters 
relative to the station datum for the 1983-2001 epoch. Also contains a column 
of times associated with relevant datums (record maximum and minimums, lowest 
and highest astronomical tides).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+noaa">noaa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# examples require internet connection
bport.datums &lt;- noaa.datums() # Bridgeport, CT
battery.datums &lt;- noaa.datums(station = 8518750) # Battery, NYC

## End(Not run)
</code></pre>

<hr>
<h2 id='noaa.parameters'>Reports data available for a NOAA station</h2><span id='topic+noaa.parameters'></span>

<h3>Description</h3>

<p>Reports data available for a NOAA station
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noaa.parameters(stn = 8467150)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noaa.parameters_+3A_stn">stn</code></td>
<td>
<p>NOAA station number (note that station names are not 
yet acceptable inputs). Default station is Bridgeport, CT.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>noaa.parameters</code> reports the parameters (meteorological 
and tidal) available for a specified NOAA station.
</p>


<h3>Value</h3>

<p>a dataframe with parameters and associated start and end 
dates. Where a parameter's availability is not continuous, multiple
rows are reported. This function can be used to, for example, select 
meteorological parameters to include in calls to <code><a href="#topic+noaa">noaa</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+noaa">noaa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# examples require internet connection
noaa.parameters()
LA.stns &lt;- noaa.stations(state = "LA")
noaa.parameters(LA.stns$number[1])

## End(Not run)
</code></pre>

<hr>
<h2 id='number.tides'>Numbers tidal cycles, flood tides, and ebb tides</h2><span id='topic+number.tides'></span>

<h3>Description</h3>

<p>Numbers tidal cycles, flood tides, and ebb tides in a set of 
water level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>number.tides(data, datetime, hl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="number.tides_+3A_data">data</code></td>
<td>
<p>dataframe to modify (containing water levels, time stamps)</p>
</td></tr>
<tr><td><code id="number.tides_+3A_datetime">datetime</code></td>
<td>
<p>date/time column from full dataset (used as 'time' argument 
in call to <code>HL</code>)</p>
</td></tr>
<tr><td><code id="number.tides_+3A_hl">hl</code></td>
<td>
<p>output from <code>HL</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numbers tidal cycles, flood tides, and ebb tides in a set of 
water level data.
</p>


<h3>Value</h3>

<p>the dataframe noted in <code>data</code>, with additional columns 
assigning a number to each tidal cycle, ebb tide, and flood tide.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HL">HL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># build high-low dataset
HL.NL &lt;- HL(level = NL_6min_2013[,2], time = NL_6min_2013[,1])
# number tides in original
nos &lt;- number.tides(data = NL_6min_2013, datetime = NL_6min_2013[,1], HL.NL)
head(nos)
</code></pre>

<hr>
<h2 id='psmsl'>Download sea level data from Permanent Service for Mean Sea Level</h2><span id='topic+psmsl'></span>

<h3>Description</h3>

<p><code>psmsl</code> imports monthly/annual tide data from stations around the world. Dataset compiled and stewarded by the Permanent Service for Mean Sea Level (<a href="http://www.psmsl.org">http://www.psmsl.org</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psmsl(station = 12, type = "RLR", interval = "annual")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psmsl_+3A_station">station</code></td>
<td>
<p>name or ID, or a vector of station names/IDs. Elements can be 
a character string (must match actual station name identically), or numeric 
station ID (no quotes: i.e., 12 rather than &quot;12&quot;). Use <code><a href="#topic+psmsl.stations">psmsl.stations</a></code> 
to find stations, or check <a href="http://www.psmsl.org">http://www.psmsl.org</a>. If multiple stations are included, their 
data is combined using rbind, making a long (rather than wide) dataset. Default 
station is the Battery, in New York City.</p>
</td></tr>
<tr><td><code id="psmsl_+3A_type">type</code></td>
<td>
<p>data quality class; can be 'metric' (default; data has been rigorously 
standardized) or 'RLR'. See <a href="http://www.psmsl.org">http://www.psmsl.org</a> for documentation.</p>
</td></tr>
<tr><td><code id="psmsl_+3A_interval">interval</code></td>
<td>
<p>time interval over which mean sea level is calculated. Can be 
'monthly' or 'annual'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame <code>data.frame</code> containing the requested Permanent Service for Mean Sea Level data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+psmsl.stations">psmsl.stations</a></code> can be used to find stations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
battery  &lt;- psmsl()
stations &lt;- psmsl(station = c(1372, 12), interval = "monthly")

## End(Not run)
</code></pre>

<hr>
<h2 id='psmsl.stations'>Generates a list of active and historic PSMSL stations</h2><span id='topic+psmsl.stations'></span>

<h3>Description</h3>

<p>Generates a list of active and historic tide stations 
hosted by the Permanent Service for Mean Sea Level (<a href="http://www.psmsl.org">http://www.psmsl.org</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psmsl.stations(type = "RLR", country = "all", sort.by = "country")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psmsl.stations_+3A_type">type</code></td>
<td>
<p>data quality class; can be 'metric' or 'RLR' - see <a href="http://www.psmsl.org">http://www.psmsl.org</a> 
for documentation</p>
</td></tr>
<tr><td><code id="psmsl.stations_+3A_country">country</code></td>
<td>
<p>if desired, the full list of stations can be filtered by up to three 
alphabetical characters. Specific country codes can be entered (&quot;USA&quot;), or 
abbreviated codes in case the user isn't sure of the country code (&quot;U&quot;; &quot;US&quot;). 
Upper case and lower case codes are both acceptable. Default is 'all' stations.</p>
</td></tr>
<tr><td><code id="psmsl.stations_+3A_sort.by">sort.by</code></td>
<td>
<p>the criterion for sorting the final dataframe.  By default, 
output is sorted alphabetically by country code. Any column name can be used 
for sorting: 'name', 'id', 'lat', 'long', 'country', 'date', 
'coastline', or <code>stn</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code>data.frame</code> containing all Permanent Service for Mean Sea Level 
stations meeting country code criterion. Data frame is sorted by the column 
specified in argument <code>sort.by</code>
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing all Permanent Service for Mean Sea Level 
stations meeting country code criterion. Data frame is sorted by the column specified 
in argument <code>sort.by</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+psmsl">psmsl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# examples require internet connection
stn.df &lt;- psmsl.stations()
stn.df2 &lt;- psmsl.stations(country = "USA", sort.by = "date")
stn.df3 &lt;- psmsl.stations(type = "metric")

## End(Not run)
</code></pre>

<hr>
<h2 id='wave.dur'>Find the proportion of time when water surface is near a selected elevation</h2><span id='topic+wave.dur'></span>

<h3>Description</h3>

<p>Find the proportion of time when water surface is near a selected elevation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wave.dur(level, elevation, buffer = 0.050)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wave.dur_+3A_level">level</code></td>
<td>
<p>a numeric vector of water levels</p>
</td></tr>
<tr><td><code id="wave.dur_+3A_elevation">elevation</code></td>
<td>
<p>elevation(s) of interest (e.g., marsh platform, MHW). A vector of 
elevations is accepted. Elevation should be in the same vertical datum 
as <code>level</code> and have units of meters</p>
</td></tr>
<tr><td><code id="wave.dur_+3A_buffer">buffer</code></td>
<td>
<p>the vertical range used to calculate exposure. Default 
is 0.050 meters (5 cm)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of values representing the fraction of time in the entire dataset 
where the water surface is near the elevation of interest. Numerical range is from 0-1. NAs are omitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NL_6min_2013)

### an elevation of interest: 0.9117 m
MHW &lt;- 0.9117

wave.dur(NL_6min_2013[, 2], MHW)

## Not run: 
### function also accepts and returns vectors
elevs           &lt;- data.frame(elevs = c(-1000:1500) / 10^3)
elevs$wave.dur  &lt;- wave.dur(NL_6min_2013[, 2], elevs$elevs)
plot(elevs ~ wave.dur, data = elevs)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
