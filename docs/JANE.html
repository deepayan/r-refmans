<!DOCTYPE html><html lang="en"><head><title>Help for package JANE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {JANE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#JANE'><p>Fit JANE</p></a></li>
<li><a href='#plot.JANE'><p>Plot JANE fits</p></a></li>
<li><a href='#sim_A'><p>Simulate unweighted networks from latent space cluster models</p></a></li>
<li><a href='#specify_initial_values'><p>Specify starting values for EM algorithm</p></a></li>
<li><a href='#specify_priors'><p>Specify prior hyperparameters for EM algorithm</p></a></li>
<li><a href='#summary.JANE'><p>Summarizing JANE fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Just Another Latent Space Network Clustering Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and simulate latent space network cluster models using an expectation-maximization algorithm. 
    Enables flexible modeling of unweighted network data, supporting both directed and undirected networks,
    with or without degree heterogeneity. Designed to handle large networks efficiently, it allows users to explore 
    network structure through latent space representations, identify clusters within network data, and simulate models
    with varying clustering and connectivity patterns.       </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.10), Matrix, extraDistr, mclust, scales, aricode,
stringdist, utils, splines, rlang, future.apply, future,
progressr, progress, igraph, methods</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/a1arakkal/JANE">https://github.com/a1arakkal/JANE</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/a1arakkal/JANE/issues">https://github.com/a1arakkal/JANE/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-19 16:41:08 UTC; alanarakkal</td>
</tr>
<tr>
<td>Author:</td>
<td>Alan Arakkal <a href="https://orcid.org/0000-0002-7001-493X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Daniel Sewell <a href="https://orcid.org/0000-0002-9238-4026"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alan Arakkal &lt;alan-arakkal@uiowa.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-19 17:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='JANE'>Fit JANE</h2><span id='topic+JANE'></span>

<h3>Description</h3>

<p>Fit the latent space cluster model using an EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JANE(
  A,
  D = 2,
  K = 2,
  model,
  initialization = "GNN",
  case_control = FALSE,
  DA_type = "none",
  seed = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="JANE_+3A_a">A</code></td>
<td>
<p>A square matrix or sparse matrix of class 'dgCMatrix' representing the adjacency matrix of the <strong>unweighted</strong> network of interest.</p>
</td></tr>
<tr><td><code id="JANE_+3A_d">D</code></td>
<td>
<p>Integer (scalar or vector) specifying the dimension of the latent space (default is 2).</p>
</td></tr>
<tr><td><code id="JANE_+3A_k">K</code></td>
<td>
<p>Integer (scalar or vector) specifying the number of clusters to consider (default is 2).</p>
</td></tr>
<tr><td><code id="JANE_+3A_model">model</code></td>
<td>
<p>A character string specifying the model to fit:
</p>

<ul>
<li><p>'NDH': <strong>undirected</strong> network with no degree heterogeneity
</p>
</li>
<li><p>'RS': <strong>undirected</strong> network with degree heterogeneity
</p>
</li>
<li><p>'RSR': <strong>directed</strong> network with degree heterogeneity
</p>
</li></ul>
</td></tr>
<tr><td><code id="JANE_+3A_initialization">initialization</code></td>
<td>
<p>A character string or a list to specify the initial values for the EM algorithm:
</p>

<ul>
<li><p>'GNN': uses a type of graphical neural network approach to generate initial values (default)
</p>
</li>
<li><p>'random': uses random initial values
</p>
</li>
<li><p>A user supplied list of initial values. See <code><a href="#topic+specify_initial_values">specify_initial_values</a></code> on how to specify initial values
</p>
</li></ul>
</td></tr>
<tr><td><code id="JANE_+3A_case_control">case_control</code></td>
<td>
<p>A logical; if <code>TRUE</code> then uses a case-control approximation approach (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="JANE_+3A_da_type">DA_type</code></td>
<td>
<p>A character string to specify the type of deterministic annealing approach to use
</p>

<ul>
<li><p>'none': does not employ a deterministic annealing approach (default)
</p>
</li>
<li><p>'cooling': employes a traditional deterministic annealing approach where temperature decreases
</p>
</li>
<li><p>'heating': employes a deterministic anti-annealing approach where temperature increases
</p>
</li>
<li><p>'hybrid': employes a combination of the 'cooling' and 'heating' approach
</p>
</li></ul>
</td></tr>
<tr><td><code id="JANE_+3A_seed">seed</code></td>
<td>
<p>(optional) An integer value to specify the seed for reproducibility.</p>
</td></tr>
<tr><td><code id="JANE_+3A_control">control</code></td>
<td>
<p>A list of control parameters. See 'Details'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If an unsymmetric adjacency matrix A is supplied for <code>model %in% c('NDH', 'RS')</code> the user will be asked if they would like to proceed with converting A to a symmetric matrix (i.e., <code>A &lt;- 1.0 * ( (A + t(A)) &gt; 0.0 )</code>).
</p>
<p><strong><code>control</code>:</strong>
</p>
<p>The <code>control</code> argument is a named list that the user can supply containing the following components:
</p>

<dl>
<dt><code>verbose</code></dt><dd><p>A logical; if <code>TRUE</code> causes additional information to be printed out about the progress of the EM algorithm (default is <code>FALSE</code>).</p>
</dd>
<dt><code>max_its</code></dt><dd><p>An integer specifying the maximum number of iterations for the EM algorithm (default is <code>1e3</code>).</p>
</dd>
<dt><code>min_its</code></dt><dd><p>An integer specifying the minimum number of iterations for the EM algorithm (default is <code>10</code>).</p>
</dd>
<dt><code>priors</code></dt><dd><p>A list of prior hyperparameters (default is <code>NULL</code>). See <code><a href="#topic+specify_priors">specify_priors</a></code> on how to specify the hyperparameters.</p>
</dd>
<dt><code>n_interior_knots</code></dt><dd><p>(only relevant for <code>model %in% c('RS', 'RSR')</code>) An integer specifying the number of interior knots used in fitting a natural cubic spline for degree heterogeneity models (default is <code>5</code>).</p>
</dd>
<dt><code>termination_rule</code></dt><dd><p>A character string to specify the termination rule to determine the convergence of the EM algorithm: </p>

<ul>
<li><p><code>'prob_mat'</code>: uses change in the absolute difference in <code class="reqn">\hat{Z}</code> (i.e., the <code class="reqn">N \times K</code> cluster membership probability matrix) between subsequent iterations (default)
</p>
</li>
<li><p><code>'Q'</code>: uses change in the absolute difference in the objective function of the E-step evaluated using parameters from subsequent iterations
</p>
</li>
<li><p><code>'ARI'</code>: comparing the classifications between subsequent iterations using adjusted Rand index
</p>
</li>
<li><p><code>'NMI'</code>: comparing the classifications between subsequent iterations using normalized mutual information
</p>
</li>
<li><p><code>'CER'</code>: comparing the classifications between subsequent iterations using classification error rate
</p>
</li></ul>
</dd>
<dt><code>tolerance</code></dt><dd><p>A numeric specifying the tolerance used for <code>termination_rule %in% c('Q', 'prob_mat')</code> (default is <code>1e-3</code>).</p>
</dd>
<dt><code>tolerance_ARI</code></dt><dd><p>A numeric specifying the tolerance used for <code>termination_rule = 'ARI'</code> (default is <code>0.999</code>).</p>
</dd>
<dt><code>tolerance_NMI</code></dt><dd><p>A numeric specifying the tolerance used for <code>termination_rule = 'NMI'</code> (default is <code>0.999</code>).</p>
</dd>
<dt><code>tolerance_CER</code></dt><dd><p>A numeric specifying the tolerance used for <code>termination_rule = 'CER'</code> (default is <code>0.01</code>).</p>
</dd>
<dt><code>n_its_start_CA</code></dt><dd><p>An integer specifying what iteration to start computing cumulative averages (note: cumulative average of <code class="reqn">U</code>, the latent position matrix, is not tracked when <code>termination_rule = 'Q'</code>) (default is <code>20</code>).</p>
</dd>
<dt><code>tolerance_diff_CA</code></dt><dd><p>A numeric specifying the tolerance used for the change in cumulative average of <code>termination_rule</code> metric and <code class="reqn">U</code> (note: cumulative average of <code class="reqn">U</code> is not tracked when <code>termination_rule = 'Q'</code>) (default is <code>1e-3</code>).</p>
</dd>
<dt><code>consecutive_diff_CA</code></dt><dd><p>An integer specifying the tolerance for the number of consecutive instances where change in cumulative average is less than <code>tolerance_diff_CA</code> (default is <code>5</code>).</p>
</dd>
<dt><code>quantile_diff</code></dt><dd><p>A numeric in <code>[0,1]</code> specifying the quantile used in computing the change in the absolute difference of <code class="reqn">Z</code> and <code class="reqn">U</code> between subsequent iterations (default is <code>1</code>, i.e., max).</p>
</dd>
<dt><code>beta_temp_schedule</code></dt><dd><p>A numeric vector specifying the temperature schedule for deterministic annealing (default is <code>1</code>, i.e., deterministic annealing not utilized).</p>
</dd>
<dt><code>n_control</code></dt><dd><p>An integer specifying the fixed number of controls (i.e., non-links) sampled for each actor; only relevant when <code>case_control = TRUE</code> (default is <code>100</code> when <code>case_control = TRUE</code> and <code>NULL</code> when <code>case_control = FALSE</code>).</p>
</dd>
<dt><code>n_start</code></dt><dd><p>An integer specifying the maximum number of starts for the EM algorithm (default is <code>5</code>).</p>
</dd>
<dt><code>max_retry</code></dt><dd><p>An integer specifying the maximum number of re-attempts if starting values cause issues with EM algorithm (default is <code>5</code>).</p>
</dd>
<dt><code>IC_selection</code></dt><dd><p>A character string to specify the information criteria used to select the optimal fit based on the combinations of <code>K</code>, <code>D</code>, and <code>n_start</code> considered: </p>

<ul>
<li><p><code>'BIC_logit'</code>: BIC computed from logistic regression component
</p>
</li>
<li><p><code>'BIC_mbc'</code>: BIC computed from model based clustering component
</p>
</li>
<li><p><code>'ICL_mbc'</code>: ICL computed from model based clustering component
</p>
</li>
<li><p><code>'Total_BIC'</code>: sum of <code>'BIC_logit'</code> and <code>'BIC_mbc'</code>
</p>
</li>
<li><p><code>'Total_ICL'</code>: sum of <code>'BIC_logit'</code> and <code>'ICL_mbc'</code> (default)
</p>
</li></ul>
</dd>
<dt><code>sd_random_U_GNN</code></dt><dd><p>(only relevant when <code>initialization = 'GNN'</code>) A positive numeric value specifying the standard deviation for the random draws from a normal distribution to initialize <code class="reqn">U</code> (default is <code>1</code>).</p>
</dd>
<dt><code>max_retry_GNN</code></dt><dd><p>(only relevant when <code>initialization = 'GNN'</code>) An integer specifying the maximum number of re-attempts for the <code>GNN</code> approach before switching to random starting values (default is <code>10</code>).</p>
</dd>
<dt><code>n_its_GNN</code></dt><dd><p>(only relevant when <code>initialization = 'GNN'</code>) An integer specifying the maximum number of iterations for the <code>GNN</code> approach (default is <code>10</code>).</p>
</dd>
<dt><code>downsampling_GNN</code></dt><dd><p>(only relevant when <code>initialization = 'GNN'</code>) A logical; if <code>TRUE</code> employs downsampling s.t. the number of links and non-links are balanced for the <code>GNN</code> approach (default is <code>TRUE</code>).</p>
</dd>
</dl>

<p><strong>Running <code>JANE</code> in parallel:</strong>
</p>
<p><code>JANE</code> integrates the <span class="pkg">future</span> and <span class="pkg">future.apply</span> packages to fit the various combinations of <code>K</code>, <code>D</code>, and <code>n_start</code> in parallel. The 'Examples' section below provides an example of how to run <code>JANE</code> in parallel. See <code><a href="future.html#topic+plan">plan</a></code> and <code><a href="future.apply.html#topic+future.apply">future.apply</a></code> for more details.
</p>
<p><strong>Choosing the number of clusters:</strong>
</p>
<p><code>JANE</code> allows for the following model selection criteria to choose the number of clusters:
</p>

<ul>
<li><p><code>'BIC_logit'</code>: BIC computed from logistic regression component
</p>
</li>
<li><p><code>'BIC_mbc'</code>: BIC computed from model based clustering component
</p>
</li>
<li><p><code>'ICL_mbc'</code>: ICL (Biernacki et al. (2000)) computed from model based clustering component
</p>
</li>
<li><p><code>'Total_BIC'</code>: Sum of <code>'BIC_logit'</code> and <code>'BIC_mbc'</code>, this is the model selection criterion proposed by Handcock et al. (2007)
</p>
</li>
<li><p><code>'Total_ICL'</code>: (default) sum of <code>'BIC_logit'</code> and <code>'ICL_mbc'</code>, this criterion is similar to <code>'Total_BIC'</code>, but uses ICL for the model based clustering component which tends to favor more well-separated clusters.
</p>
</li></ul>

<p><em>Warning</em>: It is not certain whether it is appropriate to use the model selection criterion above to select <code>D</code>.
</p>


<h3>Value</h3>

<p>A list of S3 <code><a href="base.html#topic+class">class</a></code> &quot;<code>JANE</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>input_params</code></td>
<td>
<p> A list containing the input parameters for <code>IC_selection</code>, <code>case_control</code>, and <code>DA_type</code> used in the function call.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p> The square sparse adjacency matrix of class 'dgCMatrix' used in fitting the latent space cluster model. This matrix can be different than the input A matrix as isolates are removed.</p>
</td></tr>
<tr><td><code>IC_out</code></td>
<td>
<p> A matrix containing the relevant information criteria for all combinations of <code>K</code>, <code>D</code>, and <code>n_start</code> considered. The 'selected' column indicates the optimal fit chosen.</p>
</td></tr>
<tr><td><code>all_convergence_ind</code></td>
<td>
<p> A matrix containing the convergence information (i.e., 1 = converged, 0 = did not converge) and number of iterations for all combinations of <code>K</code>, <code>D</code>, <code>n_start</code>, and <code>beta_temperature</code> considered.</p>
</td></tr>
<tr><td><code>optimal_res</code></td>
<td>
<p> A list containing the estimated parameters of interest based on the optimal fit selected. It is recommended to use <code>summary()</code> to extract the parameters of interest. See <code><a href="#topic+summary.JANE">summary.JANE</a></code> for more details.</p>
</td></tr>
<tr><td><code>optimal_starting</code></td>
<td>
<p> A list containing the starting parameters used in the EM algorithm that resulted in the optimal fit selected. It is recommended to use <code>summary()</code> to extract the parameters of interest. See <code><a href="#topic+summary.JANE">summary.JANE</a></code> for more details.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Biernacki, C., Celeux, G., Govaert, G., 2000. Assessing a mixture model for clustering with the integrated completed likelihood. IEEE Transactions on Pattern Analysis and Machine Intelligence 22, 719–725.
</p>
<p>Handcock, M.S., Raftery, A.E., Tantrum, J.M., 2007. Model-based clustering for social networks. Journal of the Royal Statistical Society Series A: Statistics in Society 170, 301–354.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate network
mus &lt;- matrix(c(-1,-1,1,-1,1,1), 
              nrow = 3,
              ncol = 2, 
              byrow = TRUE)
omegas &lt;- array(c(diag(rep(7,2)),
                  diag(rep(7,2)), 
                  diag(rep(7,2))), 
                  dim = c(2,2,3))
p &lt;- rep(1/3, 3)
beta0 &lt;- 1.0
sim_data &lt;- JANE::sim_A(N = 100L, 
                        model = "NDH",
                        mus = mus, 
                        omegas = omegas, 
                        p = p, 
                        beta0 = beta0, 
                        remove_isolates = TRUE)
                        
# Run JANE on simulated data
res &lt;- JANE::JANE(A = sim_data$A,
                  D = 2L,
                  K = 3L,
                  initialization = "GNN", 
                  model = "NDH",
                  case_control = FALSE,
                  DA_type = "none")

# Run JANE on simulated data - consider multiple D and K
res &lt;- JANE::JANE(A = sim_data$A,
                  D = 2:5,
                  K = 2:10,
                  initialization = "GNN", 
                  model = "NDH",
                  case_control = FALSE,
                  DA_type = "none")
                  
# Run JANE on simulated data - parallel with 5 cores
future::plan(future::multisession, workers = 5)
res &lt;- JANE::JANE(A = sim_data$A,
                  D = 2L,
                  K = 3L,
                  initialization = "GNN", 
                  model = "NDH",
                  case_control = FALSE,
                  DA_type = "none")
future::plan(future::sequential)

# Run JANE on simulated data - case/control approach with 20 controls sampled for each actor
res &lt;- JANE::JANE(A = sim_data$A,
                  D = 2L,
                  K = 3L,
                  initialization = "GNN", 
                  model = "NDH",
                  case_control = TRUE,
                  DA_type = "none",
                  control = list(n_control = 20))
                   
# Reproducibility
res1 &lt;- JANE::JANE(A = sim_data$A,
                   D = 2L,
                   K = 3L,
                   initialization = "GNN", 
                   seed = 1234,
                   model = "NDH",
                   case_control = FALSE,
                   DA_type = "none")

res2 &lt;- JANE::JANE(A = sim_data$A,
                   D = 2L,
                   K = 3L,
                   initialization = "GNN", 
                   seed = 1234,
                   model = "NDH",
                   case_control = FALSE,
                   DA_type = "none")  

## Check if results match
all.equal(res1, res2)    

# Another reproducibility example where the seed was not set. 
# It is possible to replicate the results using the starting values due to 
# the nature of EM algorithms
res3 &lt;- JANE::JANE(A = sim_data$A,
                   D = 2L,
                   K = 3L,
                   initialization = "GNN", 
                   model = "NDH",
                   case_control = FALSE,
                   DA_type = "none")
## Extract starting values                    
start_vals &lt;- res3$optimal_start  

## Run JANE using extracted starting values, no need to specify D and K 
## below as function will determine those values from start_vals
res4 &lt;- JANE::JANE(A = sim_data$A,
                   initialization = start_vals, 
                   model = "NDH",
                   case_control = FALSE,
                   DA_type = "none")
                   
## Check if optimal_res are identical
all.equal(res3$optimal_res, res4$optimal_res)                   
                            
</code></pre>

<hr>
<h2 id='plot.JANE'>Plot JANE fits</h2><span id='topic+plot.JANE'></span>

<h3>Description</h3>

<p>S3 plot method for object of class &quot;<code>JANE</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'JANE'
plot(
  x,
  type = "lsnc",
  true_labels,
  initial_values = FALSE,
  zoom = 100,
  density_type = "contour",
  rotation_angle = 0,
  alpha_edge = 0.1,
  alpha_node = 1,
  swap_axes = FALSE,
  main,
  xlab,
  ylab,
  cluster_cols,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.JANE_+3A_x">x</code></td>
<td>
<p>An object of S3 <code><a href="base.html#topic+class">class</a></code> &quot;<code>JANE</code>&quot;, a result of a call to <code>JANE</code>.</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_type">type</code></td>
<td>
<p>A character string to select the type of plot:
</p>

<ul>
<li><p>'lsnc': plot the network using the estimated latent positions and color-code actors by cluster (default)
</p>
</li>
<li><p>'misclassified': (can only be used if <code>true_labels</code> is <code>!NULL</code>) similar to 'lsnc', but will color misclassified actors in black
</p>
</li>
<li><p>'uncertainty': similar to 'lsnc', but here the color gradient applied represents the actor-specific classification uncertainty
</p>
</li>
<li><p>'trace_plot': presents various trace plots across the iterations of the EM algorithm
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.JANE_+3A_true_labels">true_labels</code></td>
<td>
<p>(optional) A numeric, character, or factor vector of known true cluster labels. Must have the same length as number of actors in the fitted network. Need to account for potential isolates removed.</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_initial_values">initial_values</code></td>
<td>
<p>A logical; if <code>TRUE</code> then plots fit using the starting parameters used in the EM algorithm (default is <code>FALSE</code>, i.e., the results after the EM algorithm is run are plotted).</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_zoom">zoom</code></td>
<td>
<p>A numeric value &gt; 0 that controls the % magnification of the plot (default is 100%).</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_density_type">density_type</code></td>
<td>
<p>Choose from one of the following three options: 'contour' (default), 'hdr', 'image', and 'persp' indicating the density plot type.</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_rotation_angle">rotation_angle</code></td>
<td>
<p>A numeric value that rotates the estimated latent positions and contours of the multivariate normal distributions clockwise (or counterclockwise if <code>swap_axes = TRUE</code>) through the specified angle about the origin (default is 0 degrees). Only relevant when <code>D</code> (i.e., dimension of the latent space) <code>&gt;= 2</code> and <code>type != 'trace_plot'</code>.</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_alpha_edge">alpha_edge</code></td>
<td>
<p>A numeric value in <code>[0,1]</code> that controls the transparency of the network edges (default is 0.1).</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_alpha_node">alpha_node</code></td>
<td>
<p>A numeric value in <code>[0,1]</code> that controls the transparency of the actors in the network (default is 1).</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_swap_axes">swap_axes</code></td>
<td>
<p>A logical; if <code>TRUE</code> will swap the x and y axes (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_main">main</code></td>
<td>
<p>An optional overall title for the plot.</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_xlab">xlab</code></td>
<td>
<p>An optional title for the x axis.</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_ylab">ylab</code></td>
<td>
<p>An optional title for the y axis.</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_cluster_cols">cluster_cols</code></td>
<td>
<p>An optional vector of colors for the clusters. Must have a length of at least <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code id="plot.JANE_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The classification of actors into specific clusters is based on a hard clustering rule of <code class="reqn">\{h | Z_{ih} = max_k Z_{ik}\}</code>. Additionally, the actor-specific classification uncertainty is derived as 1 - <code class="reqn">max_k Z_{ik}</code>.
</p>
<p>The trace plot contains up to five unique plots tracking various metrics across the iterations of the EM algorithm, depending on the <code><a href="#topic+JANE">JANE</a></code> control parameter <code>termination_rule</code>:
</p>

<ul>
<li><p><code>termination_rule = 'prob_mat'</code>: Five plots will be presented. Specifically, in the top panel, the plot on the left presents the change in the absolute difference in <code class="reqn">\hat{Z}</code> (i.e., the <code class="reqn">N \times K</code> cluster membership probability matrix) between subsequent iterations. The exact quantile of the absolute difference plotted are presented in parentheses and determined by the <code><a href="#topic+JANE">JANE</a></code> control parameter <code>quantile_diff</code>. For example, the default control parameter <code>quantile_diff</code> = 1, so the values being plotted are the max absolute difference in <code class="reqn">\hat{Z}</code> between subsequent iterations. The plot on the right of the top panel presents the absolute difference in the cumulative average of the absolute change in <code class="reqn">\hat{Z}</code>  and <code class="reqn">U</code> (i.e., the <code class="reqn">N \times D</code> matrix of latent positions) across subsequent iterations (absolute change in <code class="reqn">\hat{Z}</code>  and <code class="reqn">U</code>  computed in an identical manner as described above). This metric is only tracked beginning at an iteration determined by the <code>n_its_start_CA</code> control parameter in <code><a href="#topic+JANE">JANE</a></code>. Note, this plot may be empty if the EM algorithm converges before the <code>n_its_start_CA</code>-th iteration. Finally, the bottom panel presents ARI, NMI, and CER values comparing the classifications between subsequent iterations, respectively. Specifically, at a given iteration we determine the  classification of actors in clusters based on a hard clustering rule of <code class="reqn">\{h | Z_{ih} = max_k Z_{ik}\}</code> and given these labels from two subsequent iterations, we compute and plot the ARI, NMI and CER.
</p>
</li>
<li><p><code>termination_rule = 'Q'</code>: Plots generated are similar to those described in the previous bullet point. However, instead of tracking the change in <code class="reqn">\hat{Z}</code> over iterations, here the absolute difference in the objective function of the E-step evaluated using parameters from subsequent iterations is tracked. Furthermore, the cumulative average of the absolute change in <code class="reqn">U</code> is no longer tracked.
</p>
</li>
<li><p><code>termination_rule %in% c('ARI', 'NMI', 'CER')</code>: Four plots will be presented. Specifically, the top left panel presents a plot of the absolute difference in the cumulative average of the absolute change in the specific <code>termination_rule</code>  employed and <code class="reqn">U</code> across iterations. As previously mentioned, if the EM algorithm converges before the <code>n_its_start_CA</code>-th iteration then this will be an empty plot. Furthermore, the other three plots present ARI, NMI, and CER values comparing the classifications between subsequent iterations, respectively.
</p>
</li></ul>



<h3>Value</h3>

<p>A plot of the network or trace plot of the EM run.
</p>


<h3>See Also</h3>

<p><code><a href="mclust.html#topic+surfacePlot">surfacePlot</a></code>, <code><a href="mclust.html#topic+adjustedRandIndex">adjustedRandIndex</a></code>, <code><a href="mclust.html#topic+classError">classError</a></code>,  <code><a href="aricode.html#topic+NMI">NMI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate network
mus &lt;- matrix(c(-1,-1,1,-1,1,1), 
              nrow = 3,
              ncol = 2, 
              byrow = TRUE)
omegas &lt;- array(c(diag(rep(7,2)),
                  diag(rep(7,2)), 
                  diag(rep(7,2))), 
                  dim = c(2,2,3))
p &lt;- rep(1/3, 3)
beta0 &lt;- 1.0
sim_data &lt;- JANE::sim_A(N = 100L, 
                        model = "NDH",
                        mus = mus, 
                        omegas = omegas, 
                        p = p, 
                        beta0 = beta0, 
                        remove_isolates = TRUE)
                        
# Run JANE on simulated data
res &lt;- JANE::JANE(A = sim_data$A,
                  D = 2L,
                  K = 3L,
                  initialization = "GNN", 
                  model = "NDH",
                  case_control = FALSE,
                  DA_type = "none")

# plot trace plot
plot(res, type = "trace_plot")
                   
# plot network
plot(res)

# plot network - misclassified
plot(res, type = "misclassified", true_labels = apply(sim_data$Z, 1, which.max))

# plot network - uncertainty and swap axes
plot(res, type = "uncertainty", swap_axes = TRUE)

# plot network - but only show contours of MVNs
plot(res, swap_axes = TRUE, alpha_edge = 0, alpha_node = 0)

# plot using starting values of EM algorithm
plot(res, initial_values = TRUE)

</code></pre>

<hr>
<h2 id='sim_A'>Simulate unweighted networks from latent space cluster models</h2><span id='topic+sim_A'></span>

<h3>Description</h3>

<p>Simulate an unweighted network from a <code class="reqn">D</code>-dimensional latent space cluster model with <code class="reqn">K</code> clusters and <code class="reqn">N</code> actors. The <em>squared</em> euclidean distance is used (i.e., <code class="reqn">dist(U_i,U_j)^2</code>), where <code class="reqn">U_i</code> and <code class="reqn">U_j</code> are the respective actor's positions in an unobserved social space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_A(
  N,
  mus,
  omegas,
  p,
  beta0,
  model,
  precision_R_effects,
  remove_isolates = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_A_+3A_n">N</code></td>
<td>
<p>An integer specifying the number of actors in the network.</p>
</td></tr>
<tr><td><code id="sim_A_+3A_mus">mus</code></td>
<td>
<p>A numeric <code class="reqn">K \times D</code> matrix specifying the mean vectors of the multivariate normal distribution for the latent positions of the <code class="reqn">K</code> clusters.</p>
</td></tr>
<tr><td><code id="sim_A_+3A_omegas">omegas</code></td>
<td>
<p>A numeric <code class="reqn">D \times D \times K</code> array specifying the precision matrices of the multivariate normal distribution for the latent positions of the <code class="reqn">K</code> clusters.</p>
</td></tr>
<tr><td><code id="sim_A_+3A_p">p</code></td>
<td>
<p>A numeric vector of length <code class="reqn">K</code> specifying the mixture weights of the finite multivariate normal mixture distribution for the latent positions.</p>
</td></tr>
<tr><td><code id="sim_A_+3A_beta0">beta0</code></td>
<td>
<p>A numeric value specifying the intercept parameter for the logistic regression model.</p>
</td></tr>
<tr><td><code id="sim_A_+3A_model">model</code></td>
<td>
<p>A character string to specify the model to simulate the network from:
</p>

<ul>
<li><p>'NDH': generates an <strong>undirected</strong> network with no degree heterogeneity
</p>
</li>
<li><p>'RS': generates an <strong>undirected</strong> network with degree heterogeneity, specifically by including actor specific random sociality effects
</p>
</li>
<li><p>'RSR': generates a <strong>directed</strong> network with degree heterogeneity, specifically by including actor specific random sender and receiver effects
</p>
</li></ul>
</td></tr>
<tr><td><code id="sim_A_+3A_precision_r_effects">precision_R_effects</code></td>
<td>
<p>Precision parameters for random degree heterogeneity effects:
</p>

<ul>
<li><p>'NDH': does not apply, can leave as missing
</p>
</li>
<li><p>'RS': a numeric value specifying the precision parameter of the normal distribution of the random sociality effect, if missing will generate from a gamma(shape = 1, rate = 1)
</p>
</li>
<li><p>'RSR': a numeric matrix specifying the precision matrix of the multivariate normal distribution of the random sender and receiver effects, if missing will generate from a Wishart(df = 3, Sigma = <code class="reqn">I_2</code>)
</p>
</li></ul>
</td></tr>
<tr><td><code id="sim_A_+3A_remove_isolates">remove_isolates</code></td>
<td>
<p>A logical; if <code>TRUE</code> then isolates from the network are removed (default is <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>A</code></td>
<td>
<p> A sparse adjacency matrix of class 'dgCMatrix' representing the simulated network.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p> A numeric <code class="reqn">N \times K</code> cluster assignment matrix with rows representing the cluster an actor belongs to (i.e. indicated by a value of 1.0).</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p> A numeric <code class="reqn">N \times D</code> matrix with rows representing an actor's position in a <code class="reqn">D</code>-dimensional social space. </p>
</td></tr>
<tr><td><code>RE</code></td>
<td>
<p> A numeric <code class="reqn">N \times 1</code> matrix representing the actor specific random sociality effect (i.e., s) OR a <code class="reqn">N \times 2</code> matrix representing the actor specific random sender and receiver effects (i.e., s and r, respectively).</p>
</td></tr>
<tr><td><code>precision_R_effects</code></td>
<td>
<p> The specific precision_R_effects used to simulate <code>RE</code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p> A character string representing the specific <code>model</code> used to simulate the network.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
mus &lt;- matrix(c(-1,-1,1,-1,1,1), 
              nrow = 3,
              ncol = 2, 
              byrow = TRUE)
omegas &lt;- array(c(diag(rep(7,2)),
                  diag(rep(7,2)), 
                  diag(rep(7,2))), 
                  dim = c(2,2,3))
p &lt;- rep(1/3, 3)
beta0 &lt;- 1.0
JANE::sim_A(N = 100L, 
            model = "NDH",
            mus = mus, 
            omegas = omegas, 
            p = p, 
            beta0 = beta0, 
            remove_isolates = TRUE)

</code></pre>

<hr>
<h2 id='specify_initial_values'>Specify starting values for EM algorithm</h2><span id='topic+specify_initial_values'></span>

<h3>Description</h3>

<p>A function that allows the user to specify starting values for the EM algorithm in a structure accepted by <code>JANE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specify_initial_values(
  A,
  D,
  K,
  model,
  n_interior_knots = NULL,
  U,
  omegas,
  mus,
  p,
  Z,
  beta
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="specify_initial_values_+3A_a">A</code></td>
<td>
<p>A square matrix or sparse matrix of class 'dgCMatrix' representing the adjacency matrix of the unweighted network of interest.</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_d">D</code></td>
<td>
<p>An integer specifying the dimension of the latent positions.</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_k">K</code></td>
<td>
<p>An integer specifying the total number of clusters.</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_model">model</code></td>
<td>
<p>A character string specifying the model:
</p>

<ul>
<li><p>'NDH': <strong>undirected</strong> network with no degree heterogeneity
</p>
</li>
<li><p>'RS': <strong>undirected</strong> network with degree heterogeneity
</p>
</li>
<li><p>'RSR': <strong>directed</strong> network with degree heterogeneity
</p>
</li></ul>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_n_interior_knots">n_interior_knots</code></td>
<td>
<p>An integer specifying the number of interior knots used in fitting a natural cubic spline for degree heterogeneity models (i.e., 'RS' and 'RSR' only; default is <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_u">U</code></td>
<td>
<p>A numeric <code class="reqn">N \times D</code> matrix with rows specifying an actor's position in a <code class="reqn">D</code>-dimensional social space.</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_omegas">omegas</code></td>
<td>
<p>A numeric <code class="reqn">D \times D \times K</code> array specifying the precision matrices of the multivariate normal distribution for the latent positions of the <code class="reqn">K</code> clusters.</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_mus">mus</code></td>
<td>
<p>A numeric <code class="reqn">K \times D</code> matrix specifying the mean vectors of the multivariate normal distribution for the latent positions of the <code class="reqn">K</code> clusters.</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_p">p</code></td>
<td>
<p>A numeric vector of length <code class="reqn">K</code> specifying the mixture weights of the finite multivariate normal mixture distribution for the latent positions.</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_z">Z</code></td>
<td>
<p>A numeric <code class="reqn">N \times K</code> matrix with rows representing the conditional probability that an actor belongs to the cluster <code class="reqn">K = k</code> for <code class="reqn">k = 1,\ldots,K</code>.</p>
</td></tr>
<tr><td><code id="specify_initial_values_+3A_beta">beta</code></td>
<td>
<p>A numeric vector specifying the regression coefficients for the logistic regression model. Specifically, a vector of length <code>1 + (model =="RS")*(n_interior_knots + 1) +  (model =="RSR")*2*(n_interior_knots + 1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To match <code><a href="#topic+JANE">JANE</a></code>, this function will remove isolates from the adjacency matrix A and determine the total number of actors after excluding isolates. If this is not done, errors with respect to incorrect dimensions in the starting values will be generated when executing <code><a href="#topic+JANE">JANE</a></code>.
</p>
<p>Similarly to match <code><a href="#topic+JANE">JANE</a></code>, if an unsymmetric adjacency matrix A is supplied for <code>model %in% c('NDH', 'RS')</code> the user will be asked if they would like to proceed with converting A to a symmetric matrix (i.e., <code>A &lt;- 1.0 * ( (A + t(A)) &gt; 0.0 )</code>).
</p>


<h3>Value</h3>

<p>A list of starting values for the EM algorithm generated from the input values in a structure accepted by <code>JANE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate network
mus &lt;- matrix(c(-1,-1,1,-1,1,1), 
              nrow = 3,
              ncol = 2, 
              byrow = TRUE)
omegas &lt;- array(c(diag(rep(7,2)),
                  diag(rep(7,2)), 
                  diag(rep(7,2))), 
                dim = c(2,2,3))
p &lt;- rep(1/3, 3)
beta0 &lt;- -1
sim_data &lt;- JANE::sim_A(N = 100L, 
                        model = "RSR",
                        mus = mus, 
                        omegas = omegas, 
                        p = p, 
                        beta0 = beta0, 
                        remove_isolates = TRUE)

# Specify starting values
D &lt;- 3L
K &lt;- 5L
N &lt;- nrow(sim_data$A)
n_interior_knots &lt;- 5L

U &lt;- matrix(stats::rnorm(N*D), nrow = N, ncol = D)
omegas &lt;- stats::rWishart(n = K, df = D+1, Sigma = diag(D))
mus &lt;- matrix(stats::rnorm(K*D), nrow = K, ncol = D)
p &lt;- extraDistr::rdirichlet(n = 1, rep(3,K))[1,]
Z &lt;-  extraDistr::rdirichlet(n = N, alpha = rep(1, K))
beta &lt;- stats::rnorm(n = 1 + 2*(1 + n_interior_knots))

my_starting_values &lt;- JANE::specify_initial_values(A = sim_data$A,
                                                   D = D,
                                                   K = K,
                                                   model = "RSR",
                                                   n_interior_knots = n_interior_knots,
                                                   U = U,
                                                   omegas = omegas, 
                                                   mus = mus, 
                                                   p = p, 
                                                   Z = Z,
                                                   beta = beta)         

# Run JANE using my_starting_values (no need to specify D and K as function will 
# determine those values from my_starting_values)
res &lt;- JANE::JANE(A = sim_data$A,
                  initialization = my_starting_values,
                  model = "RSR")

</code></pre>

<hr>
<h2 id='specify_priors'>Specify prior hyperparameters for EM algorithm</h2><span id='topic+specify_priors'></span>

<h3>Description</h3>

<p>A function that allows the user to specify the prior hyperparameters for the EM algorithm in a structure accepted by <code>JANE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specify_priors(D, K, model, n_interior_knots = NULL, a, b, c, G, nu, e, f)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="specify_priors_+3A_d">D</code></td>
<td>
<p>An integer specifying the dimension of the latent positions.</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_k">K</code></td>
<td>
<p>An integer specifying the total number of clusters.</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_model">model</code></td>
<td>
<p>A character string specifying the model:
</p>

<ul>
<li><p>'NDH': <strong>undirected</strong> network with no degree heterogeneity
</p>
</li>
<li><p>'RS': <strong>undirected</strong> network with degree heterogeneity
</p>
</li>
<li><p>'RSR': <strong>directed</strong> network with degree heterogeneity
</p>
</li></ul>
</td></tr>
<tr><td><code id="specify_priors_+3A_n_interior_knots">n_interior_knots</code></td>
<td>
<p>An integer specifying the number of interior knots used in fitting a natural cubic spline for degree heterogeneity models (i.e., 'RS' and 'RSR' only; default is <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_a">a</code></td>
<td>
<p>A numeric vector of length <code class="reqn">D</code> specifying the mean of the multivariate normal prior on <code class="reqn">\mu_k</code> for <code class="reqn">k = 1,\ldots,K</code>, where <code class="reqn">\mu_k</code> represents the mean of the multivariate normal distribution for the latent positions of the <code class="reqn">k^{th}</code> cluster.</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_b">b</code></td>
<td>
<p>A numeric value specifying the scaling factor on the precision of the multivariate normal prior on <code class="reqn">\mu_k</code> for <code class="reqn">k = 1,\ldots,K</code>, where <code class="reqn">\mu_k</code> represents the mean of the multivariate normal distribution for the latent positions of the <code class="reqn">k^{th}</code> cluster.</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_c">c</code></td>
<td>
<p>A numeric value specifying the degrees of freedom of the Wishart prior on <code class="reqn">\Omega_k</code> for <code class="reqn">k = 1,\ldots,K</code>, where <code class="reqn">\Omega_k</code> represents the precision of the multivariate normal distribution for the latent positions of the <code class="reqn">k^{th}</code> cluster.</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_g">G</code></td>
<td>
<p>A numeric <code class="reqn">D \times D</code> matrix specifying the inverse of the scale matrix of the Wishart prior on <code class="reqn">\Omega_k</code> for <code class="reqn">k = 1,\ldots,K</code>, where <code class="reqn">\Omega_k</code> represents the precision of the multivariate normal distribution for the latent positions of the <code class="reqn">k^{th}</code> cluster.</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_nu">nu</code></td>
<td>
<p>A numeric vector of length <code class="reqn">K</code> specifying the concentration parameters of the Dirichlet prior on <code class="reqn">p</code>, where <code class="reqn">p</code> represents the mixture weights of the finite multivariate normal mixture distribution for the latent positions.</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_e">e</code></td>
<td>
<p>A numeric vector of length <code>1 + (model =='RS')*(n_interior_knots + 1) +  (model =='RSR')*2*(n_interior_knots + 1)</code> specifying the mean of the multivariate normal prior on <code class="reqn">\beta</code>, where <code class="reqn">\beta</code> represents the coefficients of the logistic regression model.</p>
</td></tr>
<tr><td><code id="specify_priors_+3A_f">f</code></td>
<td>
<p>A numeric square matrix of dimension <code>1 + (model =='RS')*(n_interior_knots + 1) +  (model =='RSR')*2*(n_interior_knots + 1)</code> specifying the precision of the multivariate normal prior on <code class="reqn">\beta</code>, where <code class="reqn">\beta</code> represents the coefficients of the logistic regression model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Prior on <code class="reqn">\mu_k</code> and <code class="reqn">\Omega_k</code></strong> (note: the same prior is used for <code class="reqn">k = 1,\ldots,K</code>) :
</p>
<p><code class="reqn">\pi(\mu_k, \Omega_k) = \pi(\mu_k | \Omega_k) \pi(\Omega_k)</code>, thus
</p>
<p style="text-align: center;"><code class="reqn">\mu_k | \Omega_k \sim MVN(a, (b\Omega_k)^{-1})</code>
</p>

<p style="text-align: center;"><code class="reqn">\Omega_k \sim Wishart(c, G^{-1})</code>
</p>

<p><strong>Prior on <code class="reqn">p</code></strong>:
</p>
<p>For the current implementation we require that all elements of the nu vector be &gt;= 1 to prevent against negative mixture weights for empty clusters.
</p>
<p style="text-align: center;"><code class="reqn">p \sim Dirichlet(\nu_1 ,\ldots,\nu_K)</code>
</p>

<p><strong>Prior on <code class="reqn">\beta</code></strong>:
</p>
<p style="text-align: center;"><code class="reqn">\beta \sim MVN(e, f^{-1})</code>
</p>



<h3>Value</h3>

<p>A list of prior hyperparameters for the EM algorithm generated from the input values in a structure accepted by <code>JANE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate network
mus &lt;- matrix(c(-1,-1,1,-1,1,1), 
              nrow = 3,
              ncol = 2, 
              byrow = TRUE)
omegas &lt;- array(c(diag(rep(7,2)),
                  diag(rep(7,2)), 
                  diag(rep(7,2))), 
                  dim = c(2,2,3))
p &lt;- rep(1/3, 3)
beta0 &lt;- 1.0
sim_data &lt;- JANE::sim_A(N = 100L, 
                        model = "RS",
                        mus = mus, 
                        omegas = omegas, 
                        p = p, 
                        beta0 = beta0, 
                        remove_isolates = TRUE)
                        
                        
# Specify prior hyperparameters
D &lt;- 3L
K &lt;- 5L
n_interior_knots &lt;- 5L

a &lt;- rep(1, D)
b &lt;- 3
c &lt;- 4
G &lt;- 10*diag(D)
nu &lt;- rep(2, K)
e &lt;- rep(0.5, 1 + (n_interior_knots + 1))
f &lt;- diag(c(0.1, rep(0.5, n_interior_knots + 1)))

my_prior_hyperparameters &lt;- specify_priors(D = D,
                                           K = K,
                                           model = "RS",
                                           n_interior_knots = n_interior_knots,
                                           a = a,
                                           b = b,
                                           c = c,
                                           G = G,
                                           nu = nu,
                                           e = e,
                                           f = f)
                                           
# Run JANE on simulated data using supplied prior hyperparameters
res &lt;- JANE::JANE(A = sim_data$A,
                  D = D,
                  K = K,
                  initialization = "GNN",
                  model = "RS",
                  case_control = FALSE,
                  DA_type = "none",
                  control = list(priors = my_prior_hyperparameters))
                                                         

</code></pre>

<hr>
<h2 id='summary.JANE'>Summarizing JANE fits</h2><span id='topic+summary.JANE'></span>

<h3>Description</h3>

<p>S3 summary method for object of class &quot;<code>JANE</code>&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'JANE'
summary(object, true_labels = NULL, initial_values = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.JANE_+3A_object">object</code></td>
<td>
<p>An object of S3 <code><a href="base.html#topic+class">class</a></code> &quot;<code>JANE</code>&quot;, a result of a call to <code>JANE</code>.</p>
</td></tr>
<tr><td><code id="summary.JANE_+3A_true_labels">true_labels</code></td>
<td>
<p>(optional) A numeric, character, or factor vector of known true cluster labels. Must have the same length as number of actors in the fitted network (default is <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="summary.JANE_+3A_initial_values">initial_values</code></td>
<td>
<p>A logical; if <code>TRUE</code> then summarize fit using the starting parameters used in the EM algorithm (default is <code>FALSE</code>, i.e., the results after the EM algorithm is run are summarized).</p>
</td></tr>
<tr><td><code id="summary.JANE_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of S3 <code><a href="base.html#topic+class">class</a></code> &quot;<code>summary.JANE</code>&quot; containing the following components (Note: <code class="reqn">N</code> is the number of actors in the network, <code class="reqn">K</code> is the number of clusters, and <code class="reqn">D</code> is the dimension of the latent space):
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> A numeric vector representing the estimated coefficients from the logistic regression model.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p> A numeric vector of length <code class="reqn">K</code> representing the estimated mixture weights of the finite multivariate normal mixture distribution for the latent positions.</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p> A numeric <code class="reqn">N \times D</code> matrix with rows representing an actor's estimated latent position in a <code class="reqn">D</code>-dimensional social space.</p>
</td></tr>
<tr><td><code>mus</code></td>
<td>
<p> A numeric <code class="reqn">K \times D</code> matrix representing the estimated mean vectors of the multivariate normal distributions for the latent positions of the <code class="reqn">K</code> clusters.</p>
</td></tr>
<tr><td><code>omegas</code></td>
<td>
<p> A numeric <code class="reqn">D \times D \times K</code> array representing the estimated precision matrices of the multivariate normal distributions for the latent positions of the <code class="reqn">K</code> clusters.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p> A numeric <code class="reqn">N \times K</code> matrix with rows representing the estimated conditional probability that an actor belongs to the cluster <code class="reqn">K = k</code> for <code class="reqn">k = 1,\ldots,K</code>.</p>
</td></tr>
<tr><td><code>uncertainty</code></td>
<td>
<p> A numeric vector of length <code class="reqn">N</code> representing the uncertainty of the <code class="reqn">i^{th}</code> actor's classification, derived as 1 - <code class="reqn">max_k Z_{ik}</code>.</p>
</td></tr>
<tr><td><code>cluster_labels</code></td>
<td>
<p> A numeric vector of length <code class="reqn">N</code> representing the cluster assignment of each actor based on a hard clustering rule of <code class="reqn">\{h | Z_{ih} = max_k Z_{ik}\}</code>.</p>
</td></tr>
<tr><td><code>input_params</code></td>
<td>
<p> A list with the following components: </p>

<ul>
<li><p><code>model</code>: A character string representing the specific <code>model</code> used (i.e., 'NDH', 'RS', or 'RSR')
</p>
</li>
<li><p><code>IC_selection</code>: A character string representing the specific information criteria used to select the optimal fit (i.e., 'BIC_logit', 'BIC_mbc', 'ICL_mbc', 'Total_BIC', or 'Total_ICL')
</p>
</li>
<li><p><code>case_control</code>: A logical; if <code>TRUE</code> then the case/control approach was utilized
</p>
</li>
<li><p><code>DA_type</code>: A character string representing the specific deterministic annealing approach utilized (i.e., 'none', 'cooling', 'heating', or 'hybrid')
</p>
</li>
<li><p><code>priors</code>: A list of the prior hyperparameters used. See <code><a href="#topic+specify_priors">specify_priors</a></code> for definitions.
</p>
</li></ul>
</td></tr>
<tr><td><code>clustering_performance</code></td>
<td>
<p> (only if <code>true_labels</code> is <code>!NULL</code>) A list with the following components: </p>

<ul>
<li><p><code>CER</code>: A list with two components: (i) <code>misclassified</code>: The indexes of the misclassified data points in a minimum error mapping between the cluster labels and the known true cluster labels (i.e., <code>true_labels</code>) and (ii) <code>errorRate</code>: The error rate corresponding to a minimum error mapping between the cluster labels and the known true cluster labels (see <code><a href="mclust.html#topic+classError">classError</a></code> for details)
</p>
</li>
<li><p><code>ARI</code>: A numeric value representing the adjusted Rand index comparing the cluster labels and the known true cluster labels (see <code><a href="mclust.html#topic+adjustedRandIndex">adjustedRandIndex</a></code> for details)
</p>
</li>
<li><p><code>NMI</code>: A numeric value representing the normalized mutual information comparing the cluster labels and the known true cluster labels (see <code><a href="aricode.html#topic+NMI">NMI</a></code> for details)
</p>
</li>
<li><p><code>confusion_matrix</code>: A numeric table representing the confusion matrix comparing the cluster labels and the known true cluster labels.
</p>
</li></ul>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate network
mus &lt;- matrix(c(-1,-1,1,-1,1,1), 
              nrow = 3,
              ncol = 2, 
              byrow = TRUE)
omegas &lt;- array(c(diag(rep(7,2)),
                  diag(rep(7,2)), 
                  diag(rep(7,2))), 
                  dim = c(2,2,3))
p &lt;- rep(1/3, 3)
beta0 &lt;- 1.0
sim_data &lt;- JANE::sim_A(N = 100L, 
                        model = "NDH",
                        mus = mus, 
                        omegas = omegas, 
                        p = p, 
                        beta0 = beta0, 
                        remove_isolates = TRUE)
                        
# Run JANE on simulated data
res &lt;- JANE::JANE(A = sim_data$A,
                  D = 2L,
                  K = 3L,
                  initialization = "GNN", 
                  model = "NDH",
                  case_control = FALSE,
                  DA_type = "none")
                  
# Summarize fit 
summary(res)

# Summarize fit and compare to true cluster labels
summary(res, true_labels = apply(sim_data$Z, 1, which.max))

# Summarize fit using starting values of EM algorithm
summary(res, initial_values = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
