<!DOCTYPE html><html lang="en-US"><head><title>Help for package geneticae</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {geneticae}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EM.AMMI'><p>EM-AMMI imputation method</p></a></li>
<li><a href='#Gabriel.Calinski'><p>GabrielEigen imputation method</p></a></li>
<li><a href='#GGEmodel'><p>Site Regression model</p></a></li>
<li><a href='#GGEPlot'><p>GGE biplots with <span class="pkg">ggplot2</span></p></a></li>
<li><a href='#imputation'><p>Imputation of missing cells in two-way data sets</p></a></li>
<li><a href='#plrv'><p>Clones from the PLRV population</p></a></li>
<li><a href='#rAMMI'><p>AMMI biplots with <span class="pkg">ggplot2</span></p></a></li>
<li><a href='#WGabriel'><p>Weighted GabrielEigen imputation method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Statistical Tools for the Analysis of Multi Environment
Agronomic Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Data from multi environment agronomic trials, which are often 
  carried out by plant breeders, can be analyzed with the tools offered by this 
  package such as the Additive Main effects and Multiplicative Interaction model 
  or 'AMMI' ('Gauch' 1992, ISBN:9780444892409) 
  and the Site Regression model or 'SREG' ('Cornelius' 1996, 
  &lt;<a href="https://doi.org/10.1201%2F9780367802226">doi:10.1201/9780367802226</a>&gt;). Since these methods present a poor performance 
  under the presence of outliers and missing values, this package includes 
  robust versions of the 'AMMI' model ('Rodrigues' 2016, 
  &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbtv533">doi:10.1093/bioinformatics/btv533</a>&gt;), and also imputation techniques 
  specifically developed for this kind of data ('Arciniegas-Alarcón' 2014, 
  &lt;<a href="https://doi.org/10.2478%2Fbile-2014-0006">doi:10.2478/bile-2014-0006</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, GGEBiplots, ggforce, ggplot2, scales, MASS, pcaMethods,
rrcov, dplyr, missMDA, calibrate, graphics, reshape2,
matrixStats, tidyr, prettydoc, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>agridat, spelling, knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.12.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://jangelini.github.io/geneticae/">https://jangelini.github.io/geneticae/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jangelini/geneticae/issues">https://github.com/jangelini/geneticae/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-20 12:32:08 UTC; julia-fedora</td>
</tr>
<tr>
<td>Author:</td>
<td>Julia Angelini <a href="https://orcid.org/0000-0002-5815-1771"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Marcos Prunello <a href="https://orcid.org/0000-0002-9611-527X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gerardo Cervigni [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Julia Angelini &lt;jangelini_93@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-20 15:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='EM.AMMI'>EM-AMMI imputation method</h2><span id='topic+EM.AMMI'></span>

<h3>Description</h3>

<p>This function was writted by Paderewski (2013) and allow imputing
missing values by the EM-AMMI algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM.AMMI(
  X,
  PC.nb = 1,
  initial.values = NA,
  precision = 0.01,
  max.iter = 1000,
  change.factor = 1,
  simplified.model = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EM.AMMI_+3A_x">X</code></td>
<td>
<p>a data frame or matrix with genotypes in rows and
environments in columns when there are no replications of the
experiment.</p>
</td></tr>
<tr><td><code id="EM.AMMI_+3A_pc.nb">PC.nb</code></td>
<td>
<p>the number of principal components in the AMMI model that will be
used; default value is 1. For PC.nb=0 only main effects are used to
estimate cells in the data table (the interaction is ignored). The number of
principal components must not be greater than min(number of rows in the X
table, number of columns in the X table)–2.</p>
</td></tr>
<tr><td><code id="EM.AMMI_+3A_initial.values">initial.values</code></td>
<td>
<p>(optional) initial values of missing cells. It
can be a single value, which then will be used for all empty cells, or a
vector of length equal to the number of missing cells (starting from the
missing values in the first column). If omitted, initial values will be
obtained by the main effects from the corresponding model, that is, by
grand mean of observed data increased (or decreased) by row and column
main effects.</p>
</td></tr>
<tr><td><code id="EM.AMMI_+3A_precision">precision</code></td>
<td>
<p>(optional) algorithm converges if the maximal change in
the values of the missing cells in two subsequent steps is not greater than
this value (the default is 0.01).</p>
</td></tr>
<tr><td><code id="EM.AMMI_+3A_max.iter">max.iter</code></td>
<td>
<p>(optional) a maximum permissible number of iterations (that
is, number of repeats of the algorithm’s steps 2 through 5); default
value is 1000.</p>
</td></tr>
<tr><td><code id="EM.AMMI_+3A_change.factor">change.factor</code></td>
<td>
<p>(optional) introduced by analogy to step size in gradient
descent method, this parameter that can shorten the time of executing the
algorithm by decreasing the number of iterations. The change.factor=1
(default) defines that the previous approximation is changed with the new
values of missing cells (standard EM-AMMI algorithm). However, when
change.factor&lt;1, then the new approximations are computed and the values of
missing cells are changed in the direction of this new approximation but the
change is smaller. It could be useful if the changes are cyclic and thus
convergence could not be reached. Usually, this argument should not affect
the final outcome (that is, the imputed values) as compared to the default
value of change.factor=1.</p>
</td></tr>
<tr><td><code id="EM.AMMI_+3A_simplified.model">simplified.model</code></td>
<td>
<p>the AMMI model contains the general mean, effects of
rows, columns and interaction terms. So the EM-AMMI algorithm in step 2
calculates the current effects of rows and columns; these effects change
from iteration to iteration because the empty (at the outset) cells in each
iteration are filled with different values. In step 3 EM-AMMI uses those
effects to re-estimate cells marked as missed (as default,
simplified.model=FALSE). It is, however, possible that this procedure will
not converge. Thus the user is offered a simplified EM-AMMI procedure that
calculates the general mean and effects of rows and columns only in the
first iteration and in next iterations uses these values
(simplified.model=TRUE). In this simplified procedure the initial values
affect the outcome (whilst EM-AMMI results usually do not depend on initial
values). For the simplified procedure the number of iterations to
convergence is usually smaller and, furthermore, convergence will be reached
even in some cases where the regular procedure fails. If the regular
procedure does not converge for the standard initial values (see the
description of the argument initial.values), the simplified model can be
used to determine a better set of initial values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p>  X: the imputed matrix (filled in with the missing values estimated
by the EM-AMMI procedure);
</p>
</li>
<li><p> PC.SS: the sum of squares representing variation explained
by the principal components (the squares of eigenvalues of singular value
decomposition);
</p>
</li>
<li><p> iteration: the final number of iterations;
</p>
</li>
<li><p> precision.final: the maximum change of the estimated values for
missing cells in the last step of iteration (the precision of convergence)
. If the algorithm converged, this value is slightly smaller than the
argument precision;
</p>
</li>
<li><p> PC.nb.final: a number of principal components that were eventually
used by the EM.AMMI() function. The function checks if there are too many
missing cells to unambiguously compute the parameters by the SVD
decomposition (Gauch and Zobel, 1990). In that case the final number of
principal components used is smaller than that which was passed on to the
function through the argument PC.nb;
</p>
</li>
<li><p> convergence: the value TRUE means that the algorithm converged in
the last iteration.
</p>
</li></ul>



<h3>References</h3>

<p>Paderewski, J. (2013). <em>An R function for imputation of
missing cells in two-way initial.values), the simplified model can be used
to determine a better set of initial values. data sets by EM-AMMI
algorithm.</em>. Communications in Biometry and Crop Science 8, 60–69.
</p>

<hr>
<h2 id='Gabriel.Calinski'>GabrielEigen imputation method</h2><span id='topic+Gabriel.Calinski'></span>

<h3>Description</h3>

<p>GabrielEigen imputation method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gabriel.Calinski(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Gabriel.Calinski_+3A_x">X</code></td>
<td>
<p>a data frame or matrix with genotypes in rows and
environments in columns when there are no replications of the
experiment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p> NumeroIterGabriel: final number of iterations;
</p>
</li>
<li><p> CritConvergGabriel: maximum change of the estimated values for
missing cells in the last step of iteration (precision of convergence);
</p>
</li>
<li><p> GabrielImput: imputed matrix (filled in with missing values
estimated by the GabrielEigein procedure).
</p>
</li></ul>



<h3>References</h3>

<p>Arciniegas-Alarcón S., García-Peña M., Dias C.T.S., Krzanowski
W.J. (2010). <em>An alternative methodology for imputing missing data in
trials with genotype-by-environment interaction</em>. Biometrical Letters 47,
1–14.
</p>

<hr>
<h2 id='GGEmodel'>Site Regression model</h2><span id='topic+GGEmodel'></span>

<h3>Description</h3>

<p>The Site Regression model (also called genotype +
genotype-by-environment (GGE) model) is a powerful tool for effective
analysis and interpretation of data from multi-environment trials in
breeding programs. There are different functions in R to fit the SREG model,
such as the <code><a href="GGEBiplots.html#topic+GGEModel">GGEModel</a></code> from the
<a href="https://CRAN.R-project.org/package=GGEBiplots">GGEBiplots package</a>.
However, this function has the following improvements: </p>
 <ul>
<li>
<p>Includes recently published robust versions of the SREG model (Angelini et
al., 2022). </p>
</li>
<li><p> It can be used for data from trials with repetitions
(there is no need to calculate means beforehand). </p>
</li>
<li><p> Other variables not
used in the analysis can be present in the dataset.</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>GGEmodel(
  Data,
  genotype = "gen",
  environment = "env",
  response = "yield",
  rep = NULL,
  model = "SREG",
  SVP = "symmetrical"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GGEmodel_+3A_data">Data</code></td>
<td>
<p>dataframe with genotypes, environments, repetitions (if any) and
the phenotypic trait of interest. Additional variables that will not be used
in the model may be present in the data.</p>
</td></tr>
<tr><td><code id="GGEmodel_+3A_genotype">genotype</code></td>
<td>
<p>column name for genotypes.</p>
</td></tr>
<tr><td><code id="GGEmodel_+3A_environment">environment</code></td>
<td>
<p>column name for environments.</p>
</td></tr>
<tr><td><code id="GGEmodel_+3A_response">response</code></td>
<td>
<p>column name for the phenotypic trait.</p>
</td></tr>
<tr><td><code id="GGEmodel_+3A_rep">rep</code></td>
<td>
<p>column name for replications. If this argument is NULL, there are
no replications in the data. Defaults to NULL.</p>
</td></tr>
<tr><td><code id="GGEmodel_+3A_model">model</code></td>
<td>
<p>method for fitting the SREG model: '&quot;SREG&quot;','&quot;CovSREG&quot;','&quot;hSREG&quot;'
or '&quot;ppSREG&quot;' (see References). Defaults to '&quot;SREG&quot;'.</p>
</td></tr>
<tr><td><code id="GGEmodel_+3A_svp">SVP</code></td>
<td>
<p>method for singular value partitioning. Either '&quot;row&quot;', '&quot;column&quot;',
or '&quot;symmetrical&quot;'. Defaults to '&quot;symmetrical&quot;'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A linear model by robust regression using an M estimator proposed by
Huber (1964, 1973) fitted by iterated re-weighted least squares, in
combination with three robust SVD/PCA procedures, resulted in a total of
three robust SREG alternatives. The robust SVD/PCA considered were:
</p>
 <ul>
<li><p> CovSREG: robust PCA that is obtained by replacing the
classical estimates of location and covariance by their robust analogues
using Minimum Regularized Covariance Determinant (MRCD) approach; </p>
</li>
<li>
<p>hSREG: robust PCA method that tries to combine the advantages of both
approaches, PCA based on a robust covariance matrix and based on projection
pursuit; </p>
</li>
<li><p> ppSREG: robust PCA that uses the projection pursuit and
directly calculates the robust estimates of the eigenvalues and eigenvectors
without going through robust covariance estimation. It is a very attractive
method for bigdata situations, which are very common in METs (a few
genotypes tested in a large number of environments), as the principal
components can be calculated sequentially. </p>
</li></ul>



<h3>Value</h3>

<p>A list of class <code>GGE_Model</code> containing: </p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>SREG model
version.</p>
</td></tr> <tr><td><code>coordgenotype</code></td>
<td>
<p>plotting coordinates for each genotype in
every component.</p>
</td></tr> <tr><td><code>coordenviroment</code></td>
<td>
<p>plotting coordinates for each
environment in every component.</p>
</td></tr> <tr><td><code>eigenvalues</code></td>
<td>
<p>vector of eigenvalues
for each component.</p>
</td></tr> <tr><td><code>vartotal</code></td>
<td>
<p>overall variance.</p>
</td></tr>
<tr><td><code>varexpl</code></td>
<td>
<p>percentage of variance explained by each component.</p>
</td></tr>
<tr><td><code>labelgen</code></td>
<td>
<p>genotype names.</p>
</td></tr> <tr><td><code>labelenv</code></td>
<td>
<p>environment names.</p>
</td></tr>
<tr><td><code>axes</code></td>
<td>
<p>axis labels.</p>
</td></tr> <tr><td><code>Data</code></td>
<td>
<p>scaled and centered input data.</p>
</td></tr>
<tr><td><code>SVP</code></td>
<td>
<p>name of SVP method.</p>
</td></tr>
</table>
<p>A biplot of class <code>ggplot</code>
</p>


<h3>References</h3>

<p>Julia Angelini, Gabriela Faviere, Eugenia Bortolotto, Gerardo
Domingo Lucio Cervigni &amp; Marta Beatriz Quaglino (2022) Handling outliers in
multi-environment trial data analysis: in the direction of robust SREG
model, Journal of Crop Improvement, DOI: 10.1080/15427528.2022.2051217
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(geneticae)

 # Data without replication
 library(agridat)
 data(yan.winterwheat)
 GGE1 &lt;- GGEmodel(yan.winterwheat, genotype="gen", environment="env", response="yield")

 # Data with replication
 data(plrv)
 GGE2 &lt;- GGEmodel(plrv, genotype = "Genotype", environment = "Locality",
                  response = "Yield", rep = "Rep")

</code></pre>

<hr>
<h2 id='GGEPlot'>GGE biplots with <span class="pkg">ggplot2</span></h2><span id='topic+GGEPlot'></span>

<h3>Description</h3>

<p>GGE biplots are used for visual examination of the relationships
between test environments, genotypes, and genotype-by-environment
interactions. &lsquo;GGEPlot()' produces a biplot as an object of class &rsquo;ggplot',
using the output of  the <code><a href="#topic+GGEmodel">GGEmodel</a></code> function.
Several types of biplots are offered which focus on different aspects of the
analysis. Customization options are also included. This function is a
modification of <code><a href="GGEBiplots.html#topic+GGEPlot">GGEPlot</a></code> from the
<a href="https://CRAN.R-project.org/package=GGEBiplots">GGEBiplots package</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GGEPlot(
  GGEModel,
  type = "Biplot",
  d1 = 1,
  d2 = 2,
  selectedE = NA,
  selectedG = NA,
  selectedG1 = NA,
  selectedG2 = NA,
  colGen = "gray47",
  colEnv = "darkred",
  colSegment = "gray30",
  colHull = "gray30",
  sizeGen = 4,
  sizeEnv = 4,
  largeSize = 4.5,
  axis_expand = 1.2,
  axislabels = TRUE,
  axes = TRUE,
  limits = TRUE,
  titles = TRUE,
  footnote = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GGEPlot_+3A_ggemodel">GGEModel</code></td>
<td>
<p>An object of class <code>GGEModel</code>.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_type">type</code></td>
<td>
<p>type of biplot to produce.
</p>

<ul>
<li> <p><code>"Biplot"</code>: Basic biplot.
</p>
</li>
<li> <p><code>"Selected Environmen"t</code>: Ranking of cultivars based on
their performance in any given environment.
</p>
</li>
<li> <p><code>"Selected Genotype"</code>: Ranking of environments based on the
performance of any given cultivar.
</p>
</li>
<li> <p><code>"Relationship Among Environments"</code>.
</p>
</li>
<li> <p><code>"Comparison of Genotype"</code>.
</p>
</li>
<li> <p><code>"Which Won Where/What"</code>: Identifying the 'best'
cultivar in each environment.
</p>
</li>
<li> <p><code>"Discrimination vs. representativeness"</code>: Evaluating the
environments based on both discriminating ability and representativeness.
</p>
</li>
<li> <p><code>"Ranking Environments"</code>: Ranking environments with respect to
the ideal environment.
</p>
</li>
<li> <p><code>"Mean vs. stability"</code>: Evaluating cultivars based on both average
yield and stability.
</p>
</li>
<li> <p><code>"Ranking Genotypes"</code>: Ranking genotypes with respect to the
ideal genotype.</p>
</li></ul>
</td></tr>
<tr><td><code id="GGEPlot_+3A_d1">d1</code></td>
<td>
<p>PCA component to plot on x axis. Defaults to 1.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_d2">d2</code></td>
<td>
<p>PCA component to plot on y axis. Defaults to 2.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_selectede">selectedE</code></td>
<td>
<p>name of the environment to evaluate when 'type=&quot;Selected
Environment&quot;'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_selectedg">selectedG</code></td>
<td>
<p>name of the genotype to evaluate when 'type=&quot;Selected
Genotype&quot;'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_selectedg1">selectedG1</code></td>
<td>
<p>name of the genotype to compare to 'selectedG2'  when
'type=&quot;Comparison of Genotype&quot;'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_selectedg2">selectedG2</code></td>
<td>
<p>name of the genotype to compare to 'selectedG1'  when
'type=&quot;Comparison of Genotype&quot;'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_colgen">colGen</code></td>
<td>
<p>genotype attributes colour. Defaults to '&quot;gray47&quot;'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_colenv">colEnv</code></td>
<td>
<p>environment attributes colour. Defaults to '&quot;darkred&quot;'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_colsegment">colSegment</code></td>
<td>
<p>segment or circle lines colour. Defaults to '&quot;gray30&quot;'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_colhull">colHull</code></td>
<td>
<p>hull colour when 'type=&quot;Which Won Where/What&quot;'. Defaults to
&quot;gray30&quot;.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_sizegen">sizeGen</code></td>
<td>
<p>genotype labels text size. Defaults to 4.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_sizeenv">sizeEnv</code></td>
<td>
<p>environment labels text size. Defaults to 4.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_largesize">largeSize</code></td>
<td>
<p>larger labels text size to use for two selected genotypes in
'type=&quot;Comparison of Genotype&quot;', and for the outermost genotypes in
'type=&quot;Which Won Where/What&quot;'. Defaults to 4.5.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_axis_expand">axis_expand</code></td>
<td>
<p>multiplication factor to expand the axis limits by to
enable fitting of labels. Defaults to 1.2.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_axislabels">axislabels</code></td>
<td>
<p>logical, if this argument is 'TRUE' labels for axes are
included. Defaults to 'TRUE'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_axes">axes</code></td>
<td>
<p>logical, if this argument is 'TRUE' x and y axes going through the
origin are drawn. Defaults to 'TRUE'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_limits">limits</code></td>
<td>
<p>logical, if this argument is 'TRUE' the axes are re-scaled.
Defaults to 'TRUE'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_titles">titles</code></td>
<td>
<p>logical, if this argument is 'TRUE' a plot title is included.
Defaults to 'TRUE'.</p>
</td></tr>
<tr><td><code id="GGEPlot_+3A_footnote">footnote</code></td>
<td>
<p>logical, if this argument is 'TRUE' a footnote is included.
Defaults to 'TRUE'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A biplot of class <code>ggplot</code>
</p>


<h3>References</h3>

<p>Yan W, Kang M (2003). <em>GGE Biplot Analysis: A Graphical Tool
for Breeders, Geneticists, and Agronomists</em>. CRC Press.
</p>
<p>Sam Dumble (2017). GGEBiplots: GGE Biplots with 'ggplot2'. R
package version 0.1.1. <a href="https://CRAN.R-project.org/package=GGEBiplots">https://CRAN.R-project.org/package=GGEBiplots</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(geneticae)

 # Data without replication
 library(agridat)
 data(yan.winterwheat)
 GGE1 &lt;- GGEmodel(yan.winterwheat)
 GGEPlot(GGE1)

 # Data with replication
 data(plrv)
 GGE2 &lt;- GGEmodel(plrv, genotype = "Genotype", environment = "Locality",
                  response = "Yield", rep = "Rep")
 GGEPlot(GGE2)

</code></pre>

<hr>
<h2 id='imputation'>Imputation of missing cells in two-way data sets</h2><span id='topic+imputation'></span>

<h3>Description</h3>

<p>Missing values are not allowed by the AMMI or GGE methods. This function
provides several methods to impute missing observations in data from
multi-environment trials and to subsequently adjust the mentioned methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imputation(
  Data,
  genotype = "gen",
  environment = "env",
  response = "yield",
  rep = NULL,
  type = "EM-AMMI",
  nPC = 2,
  initial.values = NA,
  precision = 0.01,
  maxiter = 1000,
  change.factor = 1,
  simplified.model = FALSE,
  scale = TRUE,
  method = "EM",
  row.w = NULL,
  coeff.ridge = 1,
  seed = NULL,
  nb.init = 1,
  Winf = 0.8,
  Wsup = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imputation_+3A_data">Data</code></td>
<td>
<p>dataframe containing genotypes, environments, repetitions (if any)
and the phenotypic trait of interest. Other variables that will not be used
in the analysis can be present.</p>
</td></tr>
<tr><td><code id="imputation_+3A_genotype">genotype</code></td>
<td>
<p>column name containing genotypes.</p>
</td></tr>
<tr><td><code id="imputation_+3A_environment">environment</code></td>
<td>
<p>column name containing environments.</p>
</td></tr>
<tr><td><code id="imputation_+3A_response">response</code></td>
<td>
<p>column name containing the phenotypic trait.</p>
</td></tr>
<tr><td><code id="imputation_+3A_rep">rep</code></td>
<td>
<p>column name containing replications. If this argument is NULL,
there are no replications available in the data. Defaults to NULL.</p>
</td></tr>
<tr><td><code id="imputation_+3A_type">type</code></td>
<td>
<p>imputation method. Either &quot;EM-AMMI&quot;,
&quot;Gabriel&quot;,&quot;WGabriel&quot;,&quot;EM-PCA&quot;. Defaults to &quot;EM-AMMI&quot;.</p>
</td></tr>
<tr><td><code id="imputation_+3A_npc">nPC</code></td>
<td>
<p>number of components used to predict the missing values.
Default to 2.</p>
</td></tr>
<tr><td><code id="imputation_+3A_initial.values">initial.values</code></td>
<td>
<p>initial values of the missing cells. It can be a single
value or a vector of length equal to the number of missing cells (starting
from the missing values in the first column). If omitted, the initial values
will be obtained by the main effects from the corresponding model, that is,
by the grand mean of the observed data increased (or decreased) by row and
column main effects.</p>
</td></tr>
<tr><td><code id="imputation_+3A_precision">precision</code></td>
<td>
<p>threshold for assessing convergence.</p>
</td></tr>
<tr><td><code id="imputation_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iteration for the algorithm.</p>
</td></tr>
<tr><td><code id="imputation_+3A_change.factor">change.factor</code></td>
<td>
<p>When 'change.factor' is equal to 1, the previous
approximation is changed with the new values of missing cells (standard
EM-AMMI algorithm). However, when 'change.factor' less than 1, then the new
approximations are computed and the values of missing cells are changed in
the direction of this new approximation but the change is smaller. It could
be useful if the changes are cyclic and thus convergence could not be
reached. Usually, this argument should not affect the final outcome (that
is, the imputed values) as compared to the default value of 'change.factor'
= 1.</p>
</td></tr>
<tr><td><code id="imputation_+3A_simplified.model">simplified.model</code></td>
<td>
<p>the AMMI model contains the general mean, effects of
rows, columns and interaction terms. So the EM-AMMI algorithm in step 2
calculates the current effects of rows and columns; these effects change
from iteration to iteration because the empty (at the outset) cells in each
iteration are filled with different values. In step 3 EM-AMMI uses those
effects to re-estimate cells marked as missed (as default,
simplified.model=FALSE). It is, however, possible that this procedure will
not converge. Thus the user is offered a simplified EM-AMMI procedure that
calculates the general mean and effects of rows and columns only in the
first iteration and in next iterations uses these values
(simplified.model=TRUE). In this simplified procedure the initial values
affect the outcome (whilst EM-AMMI results usually do not depend on initial
values). For the simplified procedure the number of iterations to
convergence is usually smaller and, furthermore, convergence will be reached
even in some cases where the regular procedure fails. If the regular
procedure does not converge for the standard initial values, the simplified
model can be used to determine a better set of initial values.</p>
</td></tr>
<tr><td><code id="imputation_+3A_scale">scale</code></td>
<td>
<p>boolean. By default TRUE leading to a same weight for each
variable</p>
</td></tr>
<tr><td><code id="imputation_+3A_method">method</code></td>
<td>
<p>&quot;Regularized&quot; by default or &quot;EM&quot;</p>
</td></tr>
<tr><td><code id="imputation_+3A_row.w">row.w</code></td>
<td>
<p>row weights (by default, a vector of 1 for uniform row weights)</p>
</td></tr>
<tr><td><code id="imputation_+3A_coeff.ridge">coeff.ridge</code></td>
<td>
<p>1 by default to perform the regularized imputePCA
algorithm; useful only if method=&quot;Regularized&quot;. Other regularization terms
can be implemented by setting the value to less than 1 in order to
regularized less (to get closer to the results of the EM method</p>
</td></tr>
<tr><td><code id="imputation_+3A_seed">seed</code></td>
<td>
<p>integer, by default seed = NULL implies that missing values are
initially imputed by the mean of each variable. Other values leads to a
random initialization</p>
</td></tr>
<tr><td><code id="imputation_+3A_nb.init">nb.init</code></td>
<td>
<p>integer corresponding to the number of random initializations;
the first initialization is the initialization with the mean imputation</p>
</td></tr>
<tr><td><code id="imputation_+3A_winf">Winf</code></td>
<td>
<p>peso inferior</p>
</td></tr>
<tr><td><code id="imputation_+3A_wsup">Wsup</code></td>
<td>
<p>peso superior</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Often, multi-environment experiments are unbalanced because several genotypes
are not tested in some environments. Several methodologies have been proposed
in order to solve this lack of balance caused by missing values, some of which
are included in this function:
</p>

<ul>
<li><p> EM-AMMI: an iterative scheme built round the above procedure is used to
obtain AMMI imputations from the EM algorithm. The additive parameters are
initially set by computing the grand mean, genotype means and environment
means obtained from the observed data. The residuals for the observed cells
are initialized as the cell mean minus the genotype mean minus the environment
mean plus the grand mean, and interactions for the missing positions are
initially set to zero. The initial multiplicative parameters are obtained from
the SVD of this matrix of residuals, and the missing values are filled by the
appropriate AMMI estimates. In subsequent iterations, the usual AMMI procedure
is applied to the completed matrix and the missing values are updated by the
corresponding AMMI estimates. The arguments used for this method
are:initial.values, precision, maxiter, change.factor and simplified.model
</p>
</li>
<li><p> Gabriel: combines regression and lower-rank approximation using SVD.
This method initially replaces the missing cells by arbitrary values, and
subsequently the imputations are refined through an iterative scheme that
defines a partition of the matrix for each missing value in turn and uses a
linear regression of columns (or rows) to obtain the new imputation. The
arguments used for this method is only the dataframe.
</p>
</li>
<li><p> WGabriel: is a a modification of Gabriel method that uses weights chosen
by cross-validation. The arguments used for this method are Winf and Wsup.
</p>
</li>
<li><p> EM-PCA: impute the missing entries of a mixed data using the iterative
PCA algorithm. The algorithm first consists imputing missing values with
initial values. The second step of the iterative PCA algorithm is to perform
PCA on the completed dataset to estimate the parameters. Then, it imputes the
missing values with the reconstruction formulae of order nPC (the fitted
matrix computed with nPC components for the scores and loadings). These steps
of estimation of the parameters via PCA and imputation of the missing values
using the fitted matrix are iterate until convergence. The arguments used for
this methods are: nPC, scale, method, row.w, coeff.ridge, precision, seed,
nb.init and maxiter
</p>
</li></ul>



<h3>Value</h3>

<p>imputed data matrix
</p>


<h3>References</h3>

<p>Paderewski, J. (2013). <em>An R function for imputation of missing
cells in two-way data sets by EM-AMMI algorithm</em>. Communications in Biometry
and Crop Science 8, 60–69.
</p>
<p>Julie Josse, Francois Husson (2016). missMDA: A Package for
Handling Missing Values in Multivariate Data Analysis. Journal of
Statistical Software 70, 1-31.
</p>
<p>Arciniegas-Alarcón S., García-Peña M., Dias C.T.S., Krzanowski
W.J. (2010). <em>An alternative methodology for imputing missing data in
trials with genotype-by-environment interaction</em>. Biometrical Letters 47,
1–14.
</p>
<p>Arciniegas-Alarcón S., García-Peña M., Krzanowski W.J., Dias
C.T.S. (2014). <em>An alternative methodology for imputing missing data in
trials with genotype-byenvironment interaction: some new aspects.</em>
Biometrical Letters 51, 75-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(geneticae)
# Data without replications
library(agridat)
data(yan.winterwheat)

# generating missing values
yan.winterwheat[1,3]&lt;-NA
yan.winterwheat[3,3]&lt;-NA
yan.winterwheat[2,3]&lt;-NA

imputation(yan.winterwheat, genotype = "gen", environment = "env",
           response = "yield", type = "EM-AMMI")

# Data with replications
data(plrv)
plrv[1,3] &lt;- NA
plrv[3,3] &lt;- NA
plrv[2,3] &lt;- NA
imputation(plrv, genotype = "Genotype", environment = "Locality",
           response = "Yield", rep = "Rep", type = "EM-AMMI")

</code></pre>

<hr>
<h2 id='plrv'>Clones from the PLRV population</h2><span id='topic+plrv'></span>

<h3>Description</h3>

<p>resistance study to PLRV (Patato Leaf Roll Virus) causing leaf
curl. 28 genotypes were experimented at 6 locations in Peru. Each clone was
evaluated three times in each environment, and yield, plant weight and plot were
registered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(plrv)
</code></pre>


<h3>Format</h3>

<p>Data frame with 504 observations and 6 variables (genotype,
locality, repetition, weightPlant, weightPlot and yield).
</p>


<h3>References</h3>

<p>Felipe de Mendiburu (2020). agricolae: Statistical Procedures for
Agricultural Research. R package version 1.3-2.
<a href="https://CRAN.R-project.org/package=agricolae">https://CRAN.R-project.org/package=agricolae</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(geneticae)
data(plrv)
str(plrv)

</code></pre>

<hr>
<h2 id='rAMMI'>AMMI biplots with <span class="pkg">ggplot2</span></h2><span id='topic+rAMMI'></span>

<h3>Description</h3>

<p>Produces classical or robust AMMI biplot as an object of class 'ggplot', with
options for customization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rAMMI(
  Data,
  genotype = "gen",
  environment = "env",
  response = "Y",
  rep = NULL,
  Ncomp = 2,
  type = "AMMI",
  colGen = "gray47",
  colEnv = "darkred",
  sizeGen = 4,
  sizeEnv = 4,
  titles = TRUE,
  footnote = TRUE,
  axis_expand = 1.2,
  limits = TRUE,
  axes = TRUE,
  axislabels = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rAMMI_+3A_data">Data</code></td>
<td>
<p>a dataframe with genotypes, environments, repetitions (if any) and
the phenotypic trait of interest. Other variables that will not be used in
the analysis can be included.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_genotype">genotype</code></td>
<td>
<p>column name containing genotypes.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_environment">environment</code></td>
<td>
<p>column name containing environments.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_response">response</code></td>
<td>
<p>column name containing the phenotypic trait of interest.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_rep">rep</code></td>
<td>
<p>column name containing replications. If this argument is 'NULL'
(default), replications are not considered for the analysis.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_ncomp">Ncomp</code></td>
<td>
<p>number of principal components that will be used in the analysis.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_type">type</code></td>
<td>
<p>method for fitting the AMMI model: '&quot;AMMI&quot;', '&quot;rAMMI&quot;', '&quot;hAMMI&quot;',
'&quot;gAMMI&quot;', '&quot;lAMMI&quot;' or '&quot;ppAMMI&quot;' (see References). Defaults to '&quot;AMMI&quot;'.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_colgen">colGen</code></td>
<td>
<p>genotype attributes colour. Defaults to &quot;gray&quot;.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_colenv">colEnv</code></td>
<td>
<p>environment attributes colour. Defaults to &quot;darkred&quot;.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_sizegen">sizeGen</code></td>
<td>
<p>genotype labels text size. Defaults to 4.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_sizeenv">sizeEnv</code></td>
<td>
<p>environment labels text size. Defaults to 4.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_titles">titles</code></td>
<td>
<p>logical, if this argument is 'TRUE' a plot title is generated.
Defaults to 'TRUE'.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_footnote">footnote</code></td>
<td>
<p>logical, if this argument is 'TRUE' a footnote is generated.
Defaults to 'TRUE'.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_axis_expand">axis_expand</code></td>
<td>
<p>multiplication factor to expand the axis limits by to
enable fitting of labels. Defaults to 1.2.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_limits">limits</code></td>
<td>
<p>logical. If 'TRUE' axes are automatically rescaled. Defaults to
'TRUE'.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_axes">axes</code></td>
<td>
<p>logical, if this argument is 'TRUE' axes passing through the
origin are drawn. Defaults to 'TRUE'.</p>
</td></tr>
<tr><td><code id="rAMMI_+3A_axislabels">axislabels</code></td>
<td>
<p>logical, if this argument is 'TRUE' labels axes are included.
Defaults to 'TRUE'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To overcome the problem of data contamination with outlying observations,
Rodrigues, Monteiro and Lourenco (2015) propose a robust AMMI model based on
the M-Huber estimator and in robusts SVD/PCA procedures. Several SVD/PC
methods were considered, briefly described below, thus conveying a total of
five robust AMMI candidate models:
</p>

<ul>
<li><p> R-AMMI: uses the L1 norm instead of the more usual least squares L2
norm, to compute a robust approximation to the SVD of a rectangular matrix.
</p>
</li>
<li><p> H-AMMI: Combines projection-pursuit and robust covariance estimation
techniques to compute the robust loadings. It is most adequate for
high-dimensional data.
</p>
</li>
<li><p> G-AMMI: Uses projection-pursuit to compute PCA estimators. The
optimization is done via the grid search algorithm in the plane instead of the
p-dimensional space.
</p>
</li>
<li><p> L-AMMI: The idea behind this approach is to perform  classical PCA on
the data but projected onto a unit sphere. When the data are elliptically
distributed the estimates of the eigenvectors are consistent
</p>
</li>
<li><p> PP-AMMI: Uses projection-pursuit calculating the robust eigenvalues and
eigenvectors without going through robust covariance estimation. The principal
components can be sequentially computed and thus this method is very appealing
when few genotypes are evaluated under a wide range of environmental and/or
experimental conditions.
</p>
</li></ul>



<h3>Value</h3>

<p>A biplot of class  <code>ggplot</code>
</p>


<h3>References</h3>

<p>Rodrigues P.C., Monteiro A., Lourenco V.M. (2015). <em>A robust
AMMI model for the analysis of genotype-by-environment data</em>. Bioinformatics
32, 58–66.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(geneticae)
# Data without replication
library(agridat)
data(yan.winterwheat)
BIP_AMMI &lt;- rAMMI(yan.winterwheat, genotype = "gen", environment = "env",
                  response = "yield", type = "AMMI")
BIP_AMMI

# Data with replication
data(plrv)
BIP_AMMI2 &lt;- rAMMI(plrv, genotype = "Genotype", environment = "Locality",
                   response="Yield", rep = "Rep", type = "AMMI")
BIP_AMMI2

</code></pre>

<hr>
<h2 id='WGabriel'>Weighted GabrielEigen imputation method</h2><span id='topic+WGabriel'></span>

<h3>Description</h3>

<p>agregar descripcion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WGabriel(DBmiss, Winf, Wsup)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WGabriel_+3A_dbmiss">DBmiss</code></td>
<td>
<p>a data frame or matrix that contains the genotypes in the rows
and the environments in the columns when there are no replications of the
experiment.</p>
</td></tr>
<tr><td><code id="WGabriel_+3A_winf">Winf</code></td>
<td>
<p>inferior weight</p>
</td></tr>
<tr><td><code id="WGabriel_+3A_wsup">Wsup</code></td>
<td>
<p>superior weight</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p> Peso: weight that provides the best predictive difference;
</p>
</li>
<li><p> NumeroIterWGabriel: the final number of iterations;
</p>
</li>
<li><p> CritConvergWGabriel: the maximum change of the estimated
values for missing cells in the last step of iteration (the precision of
convergence);
</p>
</li>
<li><p> GabrielWImput: the imputed matrix (filled in with the
missing values estimated by the Weighted GabrielEigen procedure).
</p>
</li></ul>



<h3>References</h3>

<p>Arciniegas-Alarcón S., García-Peña M., Krzanowski W.J., Dias
C.T.S. (2014). An alternative methodology for imputing missing data in
trials with genotype-byenvironment interaction: some new aspects.
Biometrical Letters 51, 75-88.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
