<!DOCTYPE html><html lang="en"><head><title>Help for package LPDynR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LPDynR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#baseline_lev'><p>baseline_lev</p></a></li>
<li><a href='#clust_optim'><p>clust_optim</p></a></li>
<li><a href='#EFT_clust'><p>EFT_clust</p></a></li>
<li><a href='#LNScaling'><p>LNScaling</p></a></li>
<li><a href='#LongTermChange'><p>LongTermChange</p></a></li>
<li><a href='#LPD_CombAssess'><p>LPD_CombAssess</p></a></li>
<li><a href='#PCAs4clust'><p>PCAs4clust</p></a></li>
<li><a href='#rm_multicol'><p>rm_multicol</p></a></li>
<li><a href='#sb_cat'><p>Standing Biomass</p></a></li>
<li><a href='#sbd_cat'><p>Season Beginning Day</p></a></li>
<li><a href='#sl_cat'><p>Season Length</p></a></li>
<li><a href='#state_change'><p>state_change</p></a></li>
<li><a href='#steadiness'><p>steadiness</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Land Productivity Dynamics Indicator</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.5</td>
</tr>
<tr>
<td>Description:</td>
<td>It uses 'phenological' and productivity-related variables derived from time series of vegetation 
    indexes, such as the Normalized Difference Vegetation Index, to assess ecosystem dynamics and change, which 
    eventually might drive to land degradation. The final result of the Land Productivity Dynamics indicator 
    is a categorical map with 5 classes of land productivity dynamics, ranging from declining to increasing 
    productivity. See www.sciencedirect.com/science/article/pii/S1470160X21010517/ for a description 
    of the methods used in the package to calculate the indicator.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, dplyr, data.table, virtualspecies, magrittr, terra</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/xavi-rp/LPDynR">https://github.com/xavi-rp/LPDynR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/xavi-rp/LPDynR/issues">https://github.com/xavi-rp/LPDynR/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-10 10:36:06 UTC; xavi_rp</td>
</tr>
<tr>
<td>Author:</td>
<td>Xavier Rotllan-Puig [aut, cre],
  Eva Ivits [aut],
  Michael Cherlet [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xavier Rotllan-Puig &lt;xavier.rotllan.puig@aster-projects.cat&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-12 17:41:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='baseline_lev'>baseline_lev</h2><span id='topic+baseline_lev'></span>

<h3>Description</h3>

<p>baseline_lev() derives land productivity at the beginning of the time series on study, resulting in a 3-class SpatRaster
object with (1) low, (2) medium and (3) high productivity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baseline_lev(
  obj2process = NULL,
  yearsBaseline = 3,
  drylandProp = 0.4,
  highprodProp = 0.1,
  cores2use = 1,
  filename = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="baseline_lev_+3A_obj2process">obj2process</code></td>
<td>
<p>SpatRaster object (or its file name). If time series, each layer is one year</p>
</td></tr>
<tr><td><code id="baseline_lev_+3A_yearsbaseline">yearsBaseline</code></td>
<td>
<p>Numeric. Number of years to be averaged and used as baseline. Optional. Default is 3</p>
</td></tr>
<tr><td><code id="baseline_lev_+3A_drylandprop">drylandProp</code></td>
<td>
<p>Numeric. Proportion of drylands over total land, either expressed as a fraction of unity or percentage. Optional. Default is 0.4</p>
</td></tr>
<tr><td><code id="baseline_lev_+3A_highprodprop">highprodProp</code></td>
<td>
<p>Numeric. Proportion of land classified as 'highly productive' over total land, either expressed as a fraction of unity or percentage. Optional. Default is 0.1</p>
</td></tr>
<tr><td><code id="baseline_lev_+3A_cores2use">cores2use</code></td>
<td>
<p>Numeric. Number of cores to use for parallelization. Optional. Default is 1 (no parallelization)</p>
</td></tr>
<tr><td><code id="baseline_lev_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
</table>


<h3>Details</h3>

<p>baseline_lev() uses the proportion of drylands over the total land ('drylandProp') to classify the level of productivity into
low level. UNPD declares that 40 percent of the World’s land resources are drylands (Middleton et al., 2011) and, therefore, 40 percent
of pixels at the global level can be classified as low productivity land. This assumption is the default, but it should be adjusted for
local and regional studies. In addition, baseline_lev() classifies by default 10 percent of pixels as high level of land productivity
and the rest (100 - ('drylandProp' + 10)) as medium level. Proportion of pixels classified as 'high' can be also modified by passing the
argument 'highprodProp'
</p>


<h3>Value</h3>

<p>SpatRaster object
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>References</h3>

<p>Middleton, N., L. Stringer, A. Goudie, and D. Thomas. 2011. “The Forgotten Billion. MDG Achievement in the Drylands.” New York,
NY, 10017, USA: United Nations Development Programme.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sb &lt;- terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sb_cat.tif"))
baseline_lev(obj2process = sb,
             yearsBaseline = 3,
             drylandProp = 0.4,
             cores2use = 2)


</code></pre>

<hr>
<h2 id='clust_optim'>clust_optim</h2><span id='topic+clust_optim'></span>

<h3>Description</h3>

<p>clust_optim produces a scree plot with number of cluster at x-axis and
total within-cluster sum of squares at y-axis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clust_optim(
  obj2clust = NULL,
  num_clstrs = seq(5, 50, 5),
  standardise_vars = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clust_optim_+3A_obj2clust">obj2clust</code></td>
<td>
<p>SpatRaster object (or its file name). Each layer is one variable</p>
</td></tr>
<tr><td><code id="clust_optim_+3A_num_clstrs">num_clstrs</code></td>
<td>
<p>Numeric. Optional. Vector with a sequence of number of clusters to check for optimal</p>
</td></tr>
<tr><td><code id="clust_optim_+3A_standardise_vars">standardise_vars</code></td>
<td>
<p>Logical. Optional. If TRUE (default), variables are standardised (mean = 0; sd = 1)</p>
</td></tr>
<tr><td><code id="clust_optim_+3A_...">...</code></td>
<td>
<p>Optional. Arguments for <code><a href="stats.html#topic+kmeans">kmeans</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'scree plot method' allows the user to assess how the quality of the
K-means clustering improves when increasing the number of clusters. An elbow in the curve
indicates the optimal number of clusters. K-means are run with <code><a href="stats.html#topic+kmeans">kmeans</a></code>
</p>


<h3>Value</h3>

<p>A scree plot
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PCAs4clust">PCAs4clust</a></code>; <code><a href="#topic+EFT_clust">EFT_clust</a></code>; <code><a href="stats.html#topic+kmeans">kmeans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dirctry &lt;- paste0(system.file(package='LPDynR'), "/extdata")
variables_noCor &lt;- rm_multicol(dir2process = dirctry,
                               multicol_cutoff = 0.7)
clust_optim(obj2clust = variables_noCor,
            num_clstrs = seq(5, 50, 5))

</code></pre>

<hr>
<h2 id='EFT_clust'>EFT_clust</h2><span id='topic+EFT_clust'></span>

<h3>Description</h3>

<p>EFT_clust derives the Ecosystem Functional Types using K-means to perform a clustering on the
pixels of the SpatRaster object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EFT_clust(
  obj2clust = NULL,
  n_clust = 20,
  standardise_vars = TRUE,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EFT_clust_+3A_obj2clust">obj2clust</code></td>
<td>
<p>SpatRaster object (or its file name). Each layer is one variable</p>
</td></tr>
<tr><td><code id="EFT_clust_+3A_n_clust">n_clust</code></td>
<td>
<p>Numeric. Number of total clusters. Optional. Default = 20</p>
</td></tr>
<tr><td><code id="EFT_clust_+3A_standardise_vars">standardise_vars</code></td>
<td>
<p>Logical. Optional. If TRUE (default), variables are standardised (mean = 0; sd = 1)</p>
</td></tr>
<tr><td><code id="EFT_clust_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
<tr><td><code id="EFT_clust_+3A_...">...</code></td>
<td>
<p>Arguments for <code><a href="stats.html#topic+kmeans">kmeans</a></code>. Optional</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="stats.html#topic+kmeans">kmeans</a></code> does not optimize the final number of clusters. It needs to be set by means of 'n_clust'
(default = 20). There are several methods and statistics to determine the optimal number. <code><a href="#topic+clust_optim">clust_optim</a></code>
produces a scree plot to help the user to decide the optimal number of clusters.
</p>
<p>EFT_clust passes as default to <code><a href="stats.html#topic+kmeans">kmeans</a></code> iter.max = 500 and algorithm = &quot;MacQueen&quot;, but these can be
modified passing these arguments through '...'
</p>
<p>Please note that the variables are standardised (mean = 0; sd = 1) before running the clustering
</p>
<p>An evaluation of the clustering is provided together with the SpatRaster object.
It is calculated as model$betweenss / model$totss * 100;
where 'betweenss' and 'totss' are generated by <code><a href="stats.html#topic+kmeans">kmeans</a></code>
</p>


<h3>Value</h3>

<p>A list with two components: (1) a SpatRaster object with the clusters and (2) a vector with the clustering evaluation in percentage
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PCAs4clust">PCAs4clust</a></code>; <code><a href="#topic+clust_optim">clust_optim</a></code>; <code><a href="stats.html#topic+kmeans">kmeans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dirctry &lt;- paste0(system.file(package='LPDynR'), "/extdata")
variables_noCor &lt;- rm_multicol(dir2process = dirctry,
                               multicol_cutoff = 0.7)
EFT_clust(obj2clust = variables_noCor,
         n_clust = 10)

</code></pre>

<hr>
<h2 id='LNScaling'>LNScaling</h2><span id='topic+LNScaling'></span>

<h3>Description</h3>

<p>LNScaling (Local Net Productivity Scaling) uses a productivity variable
(SpatRaster), e.g. season growth, to calculate the actual status of land productivity
relative to its potential in homogeneous land areas or Ecosystem Functional Types
(SpatRaster). If the productivity variable 'ProdVar' is a SpatRaster
object with time series, it is calculated the average of the last 5 years
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LNScaling(EFTs = NULL, ProdVar = NULL, cores2use = 1, filename = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LNScaling_+3A_efts">EFTs</code></td>
<td>
<p>SpatRaster object (or its file name). Ecosystem Functional Types. Its first variable has the number of EFT (cluster) each pixel belongs to</p>
</td></tr>
<tr><td><code id="LNScaling_+3A_prodvar">ProdVar</code></td>
<td>
<p>SpatRaster object (or its file name). Productivity variable (e.g. Cyclic fraction -season growth-)</p>
</td></tr>
<tr><td><code id="LNScaling_+3A_cores2use">cores2use</code></td>
<td>
<p>Numeric. Number of cores to use for parallelization. Optional. Default is 1 (no parallelization)</p>
</td></tr>
<tr><td><code id="LNScaling_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Local Net Primary Production Scaling (LNS) method (Prince, 2009) calculates
the difference between the potential and actual Net Primary Production for each pixel
in homogeneous land areas. The current land production related to the local potential
reflects the current level of productivity efficiency and, therefore, it is useful for
the delineation of a land productivity status map
</p>


<h3>Value</h3>

<p>SpatRaster object
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>References</h3>

<p>Prince, S.D., Becker-Reshef, I. and Rishmawi, K. 2009. “Detection and Mapping of Long-Term Land Degradation Using Local Net Production Scaling: Application to Zimbabwe.” REMOTE SENSING OF ENVIRONMENT 113 (5): 1046–57
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EFT_clust">EFT_clust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dirctry &lt;- paste0(system.file(package='LPDynR'), "/extdata")
variables_noCor &lt;- rm_multicol(dir2process = dirctry,
                               multicol_cutoff = 0.7)
EFTs_raster &lt;- EFT_clust(obj2clust = variables_noCor,
                         n_clust = 10)
sb &lt;- terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sb_cat.tif"))

LNScaling(EFTs = EFTs_raster[[1]],
          ProdVar = sb)


</code></pre>

<hr>
<h2 id='LongTermChange'>LongTermChange</h2><span id='topic+LongTermChange'></span>

<h3>Description</h3>

<p>LongTermChange combines the Steadiness Index with the baseline levels of land productivity and with the change of
state along the time series, resulting in a 22-class object (see details)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LongTermChange(
  SteadinessIndex = NULL,
  BaselineLevels = NULL,
  StateChange = NULL,
  filename = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LongTermChange_+3A_steadinessindex">SteadinessIndex</code></td>
<td>
<p>SpatRaster object (or its file name). Steadiness Index (4-class)</p>
</td></tr>
<tr><td><code id="LongTermChange_+3A_baselinelevels">BaselineLevels</code></td>
<td>
<p>SpatRaster object (or its file name). Baseline levels of land productivity (beginning of time series; 3-class)</p>
</td></tr>
<tr><td><code id="LongTermChange_+3A_statechange">StateChange</code></td>
<td>
<p>SpatRaster object (or its file name). Change of state of land productivity (beginning minus end of time series; 3-class)</p>
</td></tr>
<tr><td><code id="LongTermChange_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
</table>


<h3>Details</h3>

<p>St1-low-No Change  &lt;- 1
</p>
<p>St1-low-Change 1 categ  &lt;- 2
</p>
<p>St1-low-Change 2 or more categs  &lt;- 3
</p>
<p>St1-medium-No Change  &lt;- 4
</p>
<p>St1-medium-Change 1 categ  &lt;- 5
</p>
<p>St1-medium-Change 2 or more categs  &lt;- 6
</p>
<p>St1-high-No Change  &lt;- 7
</p>
<p>St1-high-Change 1 categ  &lt;- 8
</p>
<p>St1-high-Change 2 or more categs  &lt;- 9
</p>
<p>St2-low-No Change  &lt;- 10
</p>
<p>St2-low-Change 1 categ  &lt;- 10
</p>
<p>St2-low-Change 2 or more categs  &lt;- 10
</p>
<p>St2-medium-No Change  &lt;- 11
</p>
<p>St2-medium-Change 1 categ  &lt;- 11
</p>
<p>St2-medium-Change 2 or more categs  &lt;- 11
</p>
<p>St2-high-No Change  &lt;- 12
</p>
<p>St2-high-Change 1 categ  &lt;- 12
</p>
<p>St2-high-Change 2 or more categs  &lt;- 12
</p>
<p>St3-low-No Change  &lt;- 13
</p>
<p>St3-low-Change 1 categ  &lt;- 13
</p>
<p>St3-low-Change 2 or more categs  &lt;- 13
</p>
<p>St3-medium-No Change  &lt;- 14
</p>
<p>St3-medium-Change 1 categ  &lt;- 14
</p>
<p>St3-medium-Change 2 or more categs  &lt;- 14
</p>
<p>St3-high-No Change  &lt;- 15
</p>
<p>St3-high-Change 1 categ  &lt;- 15
</p>
<p>St3-high-Change 2 or more categs  &lt;- 15
</p>
<p>St4-low-No Change  &lt;- 16
</p>
<p>St4-low-Change 1 categ  &lt;- 17
</p>
<p>St4-low-Change 2 or more categs  &lt;- 18
</p>
<p>St4-medium-No Change  &lt;- 19
</p>
<p>St4-medium-Change 1 categ  &lt;- 20
</p>
<p>St4-medium-Change 2 or more categs  &lt;- 21
</p>
<p>St4-high-No Change  &lt;- 22
</p>
<p>St4-high-Change 1 categ  &lt;- 22
</p>
<p>St4-high-Change 2 or more categs  &lt;- 22
</p>
<p>Values = 0 in the final map indicates that there is a scarcity of data in the productivity variable
(i.e. only 1 year with data), so that the indicator cannot be calculated
</p>


<h3>Value</h3>

<p>SpatRaster object
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>See Also</h3>

<p><code><a href="#topic+steadiness">steadiness</a></code>, <code><a href="#topic+baseline_lev">baseline_lev</a></code>, <code><a href="#topic+state_change">state_change</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sb &lt;- terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sb_cat.tif"))
SteadinessIndex_raster &lt;- steadiness(obj2process = sb)
BaselineLevels_raster &lt;- baseline_lev(obj2process = sb,
                                      yearsBaseline = 3,
                                      drylandProp = 0.4)
StateChange_raster &lt;- state_change(obj2process = sb,
                                   yearsBaseline = 3)

LongTermChange(SteadinessIndex = SteadinessIndex_raster,
               BaselineLevels = BaselineLevels_raster,
               StateChange = StateChange_raster)


</code></pre>

<hr>
<h2 id='LPD_CombAssess'>LPD_CombAssess</h2><span id='topic+LPD_CombAssess'></span>

<h3>Description</h3>

<p>LPD_CombAssess combines a 'LandProd_change' map (SpatRaster) with a 'LandProd_current'
map (SpatRaster), giving a 5-classes map ranging from declining to increasing land
productivity. 'LandProd_current' is reclassified into two classes: pixels with less than 'local_prod_threshold'
(in percentage; 50 by default) of potential local productivity (within the EFT) and pixels with more or equal to
'local_prod_threshold'.
</p>
<p>If 'LandProd_current' = NULL, 'LandProd_change' is directly reclassified into the same 5-classes map
without using 'LandProd_current'. See the ATBD for the way pixels are reclassified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LPD_CombAssess(
  LandProd_change = NULL,
  LandProd_current = NULL,
  local_prod_threshold = 50,
  filename = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LPD_CombAssess_+3A_landprod_change">LandProd_change</code></td>
<td>
<p>SpatRaster object (or its file name). Land Productivity Long Term Change Map</p>
</td></tr>
<tr><td><code id="LPD_CombAssess_+3A_landprod_current">LandProd_current</code></td>
<td>
<p>SpatRaster object (or its file name). Land Productivity Current Status Map</p>
</td></tr>
<tr><td><code id="LPD_CombAssess_+3A_local_prod_threshold">local_prod_threshold</code></td>
<td>
<p>Numeric. Potential local productivity threshold (within the Ecosystem Functional Type) in percentage. Optional. Default = 50</p>
</td></tr>
<tr><td><code id="LPD_CombAssess_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
</table>


<h3>Details</h3>

<p>LandProd_change c(1:6, 8:9)       &amp;  LandProd_current  &lt; 'local_prod_threshold'  &lt;- 1 Declining land productivity
</p>
<p>LandProd_change c(3, 6)           &amp;  LandProd_current &gt;= 'local_prod_threshold'  &lt;- 1 Declining land productivity
</p>
<p>LandProd_change c(7)              &amp;  LandProd_current  &lt; 'local_prod_threshold'  &lt;- 2 Early signs of decline of land productivity
</p>
<p>LandProd_change c(1:2, 4:5, 8:9)  &amp;  LandProd_current &gt;= 'local_prod_threshold'  &lt;- 2 Early signs of decline of land productivity
</p>
<p>LandProd_change c(7)              &amp;  LandProd_current &gt;= 'local_prod_threshold'  &lt;- 3 Negative fluctuation (stable, but stressed land prod.)
</p>
<p>LandProd_change c(10:12)                                     &lt;- 3 Negative fluctuation (stable, but stressed land prod.)
LandProd_change c(13:15)                                     &lt;- 4 Positive fluctuation (stable, not stressed land prod.)
</p>
<p>LandProd_change c(16:17, 19)      &amp;  LandProd_current  &lt; 'local_prod_threshold'  &lt;- 4 Positive fluctuation (stable, not stressed land prod.)
</p>
<p>LandProd_change c(18, 20:22)      &amp;  LandProd_current  &lt; 'local_prod_threshold'  &lt;- 5 Increasing land productivity
</p>
<p>LandProd_change c(16:22)          &amp;  LandProd_current &gt;= 'local_prod_threshold'  &lt;- 5 Increasing land productivity
</p>
<p>Values = 0 in the final map indicates that there is a scarcity of data in the productivity variable
(i.e. only 1 year with data), so that the indicator cannot be calculated
</p>
<p>'local_prod_threshold' is the threshold used to classify 'LandProd_current' into pixels with low or high
potential productivity within its Ecosystem Functional Type
</p>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LongTermChange">LongTermChange</a></code>; <code><a href="#topic+LNScaling">LNScaling</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sb &lt;- terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sb_cat.tif"))
SteadinessIndex_raster &lt;- steadiness(obj2process = sb)
BaselineLevels_raster &lt;- baseline_lev(obj2process = sb,
                                      yearsBaseline = 3,
                                      drylandProp = 0.4)
StateChange_raster &lt;- state_change(obj2process = sb,
                                   yearsBaseline = 3)
LandProd_change_raster &lt;- LongTermChange(SteadinessIndex = SteadinessIndex_raster,
                                         BaselineLevels = BaselineLevels_raster,
                                         StateChange = StateChange_raster)

dirctry &lt;- paste0(system.file(package='LPDynR'), "/extdata")
variables_noCor &lt;- rm_multicol(dir2process = dirctry,
                               multicol_cutoff = 0.7)
EFTs_raster &lt;- EFT_clust(obj2clust = variables_noCor,
                         n_clust = 10)

LandProd_current_raster &lt;- LNScaling(EFTs = EFTs_raster[[1]],
                                     ProdVar = sb)

LPD_CombAssess(LandProd_change = LandProd_change_raster,
               LandProd_current = LandProd_current_raster)


</code></pre>

<hr>
<h2 id='PCAs4clust'>PCAs4clust</h2><span id='topic+PCAs4clust'></span>

<h3>Description</h3>

<p>PCAs4clust runs a two-steps process to prepare the data to be clustered
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PCAs4clust(obj2process = NULL, cumul_var_threshold = 0.9, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PCAs4clust_+3A_obj2process">obj2process</code></td>
<td>
<p>SpatRaster object (or its file name). Each layer is one variable</p>
</td></tr>
<tr><td><code id="PCAs4clust_+3A_cumul_var_threshold">cumul_var_threshold</code></td>
<td>
<p>Numeric. Optional (default = 0.9). Threshold of cumulative variance
to select the number of useful PCs</p>
</td></tr>
<tr><td><code id="PCAs4clust_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
<tr><td><code id="PCAs4clust_+3A_...">...</code></td>
<td>
<p>Optional. Arguments for <code><a href="stats.html#topic+prcomp">prcomp</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Firstly, a Principal Component Analysis ('screening PCA') with all the variables in
'obj2process' is run in order to know the optimal number of variables to be used in a subsequent
PCA, as well as the most associated variable to those Principal Components (PCs). A threshold
of cumulative variance (cumul_var_threshold; default = 0.9) is needed. Secondly, a 'final PCA'
is run with the results of the 'screening PCA' (i.e. number of PC axes and their most associated
variables). PCAs4clust uses <code><a href="stats.html#topic+prcomp">prcomp</a></code> to run PCAs
</p>


<h3>Value</h3>

<p>SpatRaster object
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rm_multicol">rm_multicol</a></code>; <code><a href="stats.html#topic+prcomp">prcomp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dirctry &lt;- paste0(system.file(package='LPDynR'), "/extdata")
variables_noCor &lt;- rm_multicol(dir2process = dirctry,
                               multicol_cutoff = 0.7)
PCAs4clust(obj2process = variables_noCor,
            cumul_var_threshold = 0.9)


</code></pre>

<hr>
<h2 id='rm_multicol'>rm_multicol</h2><span id='topic+rm_multicol'></span>

<h3>Description</h3>

<p>rm_multicol calculates the average of each variable and removes those variables highly correlated
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rm_multicol(
  dir2process = NULL,
  yrs2use = NULL,
  multicol_cutoff = 0.7,
  cores2use = 1,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rm_multicol_+3A_dir2process">dir2process</code></td>
<td>
<p>Character. Directory where the SpatRaster objects are stored. All the .tif
files in the directory will be read in to be used</p>
</td></tr>
<tr><td><code id="rm_multicol_+3A_yrs2use">yrs2use</code></td>
<td>
<p>Numeric. A numeric vector with the years (layers positions) of the time series to be used (e.g. yrs2use = 2:21). Optional. Default (= NULL) uses all years</p>
</td></tr>
<tr><td><code id="rm_multicol_+3A_multicol_cutoff">multicol_cutoff</code></td>
<td>
<p>Numeric. Cutoff value of (Pearson's) correlation. Optional. Default is 0.70</p>
</td></tr>
<tr><td><code id="rm_multicol_+3A_cores2use">cores2use</code></td>
<td>
<p>Numeric. Number of cores to use for parallelization. Optional. Default is 1 (no parallelization)</p>
</td></tr>
<tr><td><code id="rm_multicol_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
<tr><td><code id="rm_multicol_+3A_...">...</code></td>
<td>
<p>Optional. Arguments for removeCollinearity()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Firstly, after reading in all .tif files in 'dir2process', if they are multiband (time series), averages are
calculated. Secondly, it creates a SpatRaster object with those (averaged) variables which have a Pearson's
correlation coefficient below 'multicol_cutoff'. See <code><a href="virtualspecies.html#topic+removeCollinearity">removeCollinearity</a></code> for further arguments
and functionalities
</p>


<h3>Value</h3>

<p>SpatRaster object
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>References</h3>

<p>Leroy B, Meynard CN, Bellard C, Courchamp F (2015). “virtualspecies, an R package to generate virtual species distributions”. Ecography. doi: 10.1111/ecog.01388
</p>


<h3>See Also</h3>

<p><code><a href="virtualspecies.html#topic+removeCollinearity">removeCollinearity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dirctry &lt;- paste0(system.file(package='LPDynR'), "/extdata")  # directory with variables to process
rm_multicol(dir2process = dirctry,
            multicol_cutoff = 0.7,
            plot = TRUE)

</code></pre>

<hr>
<h2 id='sb_cat'>Standing Biomass</h2><span id='topic+sb_cat'></span>

<h3>Description</h3>

<p>SpatRaster object containing time series of land productivity data (400 cells; 10 layers).
Years 2000-2009. The variable has been derived from MODIS using Timesat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sb_cat
</code></pre>


<h3>Format</h3>

<p>GeoTIFF. SpatRaster object with dimensions: 20, 20, 400, 10  (nrow, ncol, ncell, nlayers)
</p>

<dl>
<dt>sb_cat</dt><dd><p>Standing biomass</p>
</dd>
</dl>



<h3>Details</h3>

<p>Downloaded from www.eea.europa.eu (20/08/2020)
</p>
<p>Coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs
</p>
<p>Resolution  : 500, 500  (x, y)
</p>
<p>Extent      : 3640000, 3650000, 2140000, 2150000  (xmin, xmax, ymin, ymax)
</p>


<h3>Source</h3>

<p><a href="https://www.eea.europa.eu/en/analysis">https://www.eea.europa.eu/en/analysis</a>
</p>


<h3>References</h3>

<p><a href="https://www.eea.europa.eu/data-and-maps/data/annual-above-ground-vegetation-productivity">https://www.eea.europa.eu/data-and-maps/data/annual-above-ground-vegetation-productivity</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sb_cat.tif"))

</code></pre>

<hr>
<h2 id='sbd_cat'>Season Beginning Day</h2><span id='topic+sbd_cat'></span>

<h3>Description</h3>

<p>SpatRaster object containing time series of phenological data (400 cells; 10 layers).
Years 2000-2009. The variable has been derived from MODIS using Timesat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sbd_cat
</code></pre>


<h3>Format</h3>

<p>GeoTIFF. SpatRaster object with dimensions: 20, 20, 400, 10  (nrow, ncol, ncell, nlayers)
</p>

<dl>
<dt>sbd_cat</dt><dd><p>Season beginning day</p>
</dd>
</dl>



<h3>Details</h3>

<p>Downloaded from www.eea.europa.eu (20/08/2020)
</p>
<p>Coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs
</p>
<p>Resolution  : 500, 500  (x, y)
</p>
<p>Extent      : 3640000, 3650000, 2140000, 2150000  (xmin, xmax, ymin, ymax)
</p>


<h3>Source</h3>

<p><a href="https://www.eea.europa.eu/en/analysis">https://www.eea.europa.eu/en/analysis</a>
</p>


<h3>References</h3>

<p><a href="https://www.eea.europa.eu/data-and-maps/data/annual-start-of-vegetation-growing">https://www.eea.europa.eu/data-and-maps/data/annual-start-of-vegetation-growing</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sbd_cat.tif"))

</code></pre>

<hr>
<h2 id='sl_cat'>Season Length</h2><span id='topic+sl_cat'></span>

<h3>Description</h3>

<p>SpatRaster object containing time series of phenological data (400 cells; 10 layers).
Years 2000-2009. The variable has been derived from MODIS using Timesat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sl_cat
</code></pre>


<h3>Format</h3>

<p>GeoTIFF. SpatRaster object with dimensions: 20, 20, 400, 10  (nrow, ncol, ncell, nlayers)
</p>

<dl>
<dt>sl_cat</dt><dd><p>Season Length</p>
</dd>
</dl>



<h3>Details</h3>

<p>Downloaded from www.eea.europa.eu (20/08/2020)
</p>
<p>Coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs
</p>
<p>Resolution  : 500, 500  (x, y)
</p>
<p>Extent      : 3640000, 3650000, 2140000, 2150000  (xmin, xmax, ymin, ymax)
</p>


<h3>Source</h3>

<p><a href="https://www.eea.europa.eu/en/analysis">https://www.eea.europa.eu/en/analysis</a>
</p>


<h3>References</h3>

<p><a href="https://www.eea.europa.eu/data-and-maps/data/annual-above-ground-vegetation-season">https://www.eea.europa.eu/data-and-maps/data/annual-above-ground-vegetation-season</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sl_cat.tif"))

</code></pre>

<hr>
<h2 id='state_change'>state_change</h2><span id='topic+state_change'></span>

<h3>Description</h3>

<p>state_change derives land productivity state change between the beginning and the end of the time series
on study, resulting in a 3-class SpatRaster object with (1) no change, (2) changed between 1 and x classes or
(3) changed more than x classes, where x can be defined by the user (default is 1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>state_change(
  obj2process = NULL,
  yearsBaseline = 3,
  changeNclass = 1,
  cores2use = 1,
  filename = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="state_change_+3A_obj2process">obj2process</code></td>
<td>
<p>SpatRaster object (or its file name). If time series, each layer is one year</p>
</td></tr>
<tr><td><code id="state_change_+3A_yearsbaseline">yearsBaseline</code></td>
<td>
<p>Numeric. Number of years to be averaged at the beginning and end of the time series. Optional. Default is 3</p>
</td></tr>
<tr><td><code id="state_change_+3A_changenclass">changeNclass</code></td>
<td>
<p>Numeric. Number of classes changed for classification. Optional. Default is 1</p>
</td></tr>
<tr><td><code id="state_change_+3A_cores2use">cores2use</code></td>
<td>
<p>Numeric. Number of cores to use for parallelization. Optional. Default is 1 (no parallelization)</p>
</td></tr>
<tr><td><code id="state_change_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
</table>


<h3>Details</h3>

<p>state_change uses the average of 'yearsBaseline' number of years at the beginning and the end of the time series
</p>


<h3>Value</h3>

<p>SpatRaster object
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sb &lt;- terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sb_cat.tif"))
state_change(obj2process = sb,
             yearsBaseline = 3,
             changeNclass = 1,
             cores2use = 2)

</code></pre>

<hr>
<h2 id='steadiness'>steadiness</h2><span id='topic+steadiness'></span>

<h3>Description</h3>

<p>steadiness derives the Steadiness Index from a land productivity variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>steadiness(obj2process = NULL, cores2use = 1, filename = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="steadiness_+3A_obj2process">obj2process</code></td>
<td>
<p>SpatRaster object (or its file name). If time series, each layer is one year</p>
</td></tr>
<tr><td><code id="steadiness_+3A_cores2use">cores2use</code></td>
<td>
<p>Numeric. Number of cores to use for parallelization. Optional. Default is 1 (no parallelization)</p>
</td></tr>
<tr><td><code id="steadiness_+3A_filename">filename</code></td>
<td>
<p>Character. Output filename. Optional</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Steadiness Index is based on the combination of two metrics calculated per pixel: (1) the slope derived
from a linear regression of the different years of the time series and (2) the net change on the same period. It
results in a 4-class SpatRaster object ranging from (1) strong negative to (4) strong positive ecosystem dynamics.
See Ivits et al. (2013) for further explanations.
</p>
<p>Values = 0 in the final map indicates that there is a scarcity of data in the productivity variable
(i.e. only 1 year with data), so that the indicator cannot be calculated
</p>


<h3>Value</h3>

<p>SpatRaster object
</p>


<h3>Author(s)</h3>

<p>Xavier Rotllan-Puig
</p>


<h3>References</h3>

<p>Ivits, E., M. Cherlet, W. Mehl, and S. Sommer. 2013. “Ecosystem Functional Units Characterized by
Satellite Observed Phenology and Productivity Gradients: A Case Study for Europe.” Ecological Indicators 27: 17–28.
<a href="https://doi.org/10.1016/j.ecolind.2012.11.010">doi:10.1016/j.ecolind.2012.11.010</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sb &lt;- terra::rast(paste0(system.file(package='LPDynR'), "/extdata/sb_cat.tif"))
steadiness(obj2process = sb)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
