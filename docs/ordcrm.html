<!DOCTYPE html><html><head><title>Help for package ordcrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ordcrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#crmsimulations'><p>Simulations to Assess operating characteristics of proportional odds model (POM), continuation ratio (CR) Model, and binary CRM Designs</p></a></li>
<li><a href='#nextdose'><p>Estimates the updated model and next dose to be tested for the Proportional Odds Model (POM),</p>
Continuation Ratio (CR) Model CRM, or binary 2-parameter logistic model CRM.</a></li>
<li><a href='#pseudodata'><p>Pseudodata for Likelihood-Based Continual Reassessment Method (CRM) Dose Finding Designs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Likelihood-Based Continual Reassessment Method (CRM) Dose
Finding Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-11-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Emily V. Dressler, PhD
        Zhengyan Huang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emily V. Dressler &lt;EmilyVDressler@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the setup and calculations needed
        to run a likelihood-based continual reassessment method (CRM)
        dose finding trial and performs simulations to assess design
        performance under various scenarios. 3 dose finding designs
        are included in this package: ordinal proportional odds model
        (POM) CRM, ordinal continuation ratio (CR) model CRM, and the
        binary 2-parameter logistic model CRM.
        These functions allow customization of design characteristics
        to vary sample size, cohort sizes, target dose-limiting
        toxicity (DLT) rates, discrete or continuous dose levels,
        combining ordinal grades 0 and 1 into one category, and
        incorporate safety and/or stopping rules.
        For POM and CR model designs, ordinal toxicity grades are
        specified by common terminology criteria for adverse events
        (CTCAE) version 4.0.
        Function 'pseudodata' creates the necessary starting models
        for these 3 designs, and function 'nextdose' estimates the
        next dose to test in a cohort of patients for a target DLT
        rate.
        We also provide the function 'crmsimulations' to assess the
        performance of these 3 dose finding designs under various
        scenarios.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.1), stats, graphics</td>
</tr>
<tr>
<td>Imports:</td>
<td>rms</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-11-04 11:48:03 UTC; xanthehuang</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-11-04 23:54:11</td>
</tr>
</table>
<hr>
<h2 id='crmsimulations'>Simulations to Assess operating characteristics of proportional odds model (POM), continuation ratio (CR) Model, and binary CRM Designs</h2><span id='topic+crmsimulations'></span>

<h3>Description</h3>

<p>This function performs simulations to assess design performance characteristics of the proportional odds model (POM),
continuation ratio (CR) Model, and binary CRM likelihood-based dose finding designs.
There are many different options in this function
to vary sample size, cohort sizes, target dose-limiting toxicity (DLT) rates, true underlying dose-toxicity models,
discrete or continuous dose levels, combining ordianl grades 0 and 1 into one category, and the design you wish to assess.
Returns results collected over all simulations run for these specified safety and dose estimation performance criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crmsimulations(startdose, numbersims, cohortsize = 3, samplesize = 30,
  pseudoweights = NA, stopearly = FALSE, stopearlynumber = NA, pseudotox,
  pseudodose, dosetox, truedosetoxmodeltype, design, targetDLT = 0.3,
  discrete = FALSE, discretedoses = NA, numberdltrule = NA,
  lowerlimitrule = NA, upperlimitrule = NA, dltrule = NA,
  increaserule = NA, minimum = NA, maximum = NA, combine01 = FALSE,
  rounddown = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crmsimulations_+3A_startdose">startdose</code></td>
<td>
<p>Starting dose for a trial for a specified target DLT rate.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_numbersims">numbersims</code></td>
<td>
<p>Number of simulations you wish to run (We used 2000 simulations in our studies).</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_cohortsize">cohortsize</code></td>
<td>
<p>Number of patients treated in each cohort. Defaults to 3.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_samplesize">samplesize</code></td>
<td>
<p>Total sample size of each trial. Defaults to 30.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_pseudoweights">pseudoweights</code></td>
<td>
<p>Pseudoweights determine the amount of influence the pseudodata has on estimating the updated model.
Please refer to Van Meter et al (2010) for more information. We suggest setting the pseudoweights equal to the cohortsize.
When pseudoweights = X, the total pseudodata represent X individuals in the updated model. If not specified,
pseudoweights defaults to cohortsize.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_stopearly">stopearly</code></td>
<td>
<p>True/False. Allows early stopping if a certain number of patients are treated at the same dose level and
the model estimates the same dose to treat the next cohort.
Must specify stopearlynumber when stopearly = TRUE. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_stopearlynumber">stopearlynumber</code></td>
<td>
<p>Total number of patients treated at the same dose level before stopping.
Must set stopearly = TRUE when a number is specified.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_pseudotox">pseudotox</code></td>
<td>
<p>A vector of toxicity grades specified by the pseudodata.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_pseudodose">pseudodose</code></td>
<td>
<p>A vector of dose levels specified by the pseudodata.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_dosetox">dosetox</code></td>
<td>
<p>Specifies the true underlying dose-toxicity relationship model. Please refer to
Van Meter et al (2010) for specification of the POM and CR model.
Assumes 5 toxicity categories as specified by CTCAEv4.0, i.e. grades 0, 1, 2,
3, and 4. Grade 5 toxicities (death directly related to an adverse event are not considered when running simulations).<br />
If using a POM, it must be in the form:
c(<code class="reqn">\alpha1, \beta1, \alpha2, \beta2, \alpha3, \beta3, \alpha4, \beta4</code>).<br />
If using a CR model it must be in the form: c(<code class="reqn">\alpha, \gamma0, \theta1,
\gamma1, \theta2, \gamma2, \theta3, \gamma3</code>).
<strong>IMPORTANT!</strong> If combine01 is true, you still must specify the dosetox model in
terms of grades 0, 1, 2, 3, and 4 for the simulations to run correctly!!!</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_truedosetoxmodeltype">truedosetoxmodeltype</code></td>
<td>
<p>Must specify what type of true underlying dose-toxicity model you are using.
Choices are: POM, CR, or CRM.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_design">design</code></td>
<td>
<p>Specifies which dose finding design you are running simulations on. Choices are: POM, CR, or CRM.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_targetdlt">targetDLT</code></td>
<td>
<p>Target dose limiting toxicity (DLT) rate pre-specified by clinical investigators prior to the start of the trial.
Must be specified between 0 and 1. Defaults to 0.30.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_discrete">discrete</code></td>
<td>
<p>True/False. If discrete = TRUE this allows for discrete dose levels
to be specified prior to the start of the trial. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_discretedoses">discretedoses</code></td>
<td>
<p>Specified discrete dose levels if desired. They must be specified if discrete is equal to TRUE.
It is written for j dose levels as: c(d1, d2,..., dj).</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_numberdltrule">numberdltrule</code></td>
<td>
<p>Number of dose limiting toxicities (DLTs) that would be considered excessively unsafe if observed in a cohort of patients.
This would prompt the DLT constraint if there is one specified. Defaults to NA.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_lowerlimitrule">lowerlimitrule</code></td>
<td>
<p>If lowerlimitrule is specified, this constraint will stop the trial if the dose
is estimated to be under a certain level as a safety precaution. Investigators may feel any dose under
this lowerlimitrule would suggest excessive toxicity with this investigational drug and no true MTD may exist.<br />
This can be specified as a dose level or percentage.<br />
If lowerlimitrule &lt;1 (percentage), it takes the range of possible data (maximum - minimum) and makes the lower bound
when the trial would stop early as: minimum + (maximum - minimum)*lowerlimitrule.<br />
If lowerlimitrule &gt;1 (dose level) then the lower bound when the trial would stop early is the lowerlimitrule.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_upperlimitrule">upperlimitrule</code></td>
<td>
<p>If upperlimitrule is specified, this constraint will stop the trial if the dose is estimated to be higher
than a certain level. <br />
If upperlimitrule &lt;1 (percentage), it takes the range of possible data (maximum - minimum) and makes the upper bound
when the trial would stop early as: maximum - (maximum - minimum)*upperlimitrule. <br />
If upperlimitrule &gt;1 (dose level) then the upper bound
when the trial would stop early is the upperlimitrule.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_dltrule">dltrule</code></td>
<td>
<p>If the numberdltrule (i.e. 2 DLTs) occurs in the last cohort of patients tested,
the next estimated dose must decrease by an amount specified by the dltrule.
Defaults to NA.  <br />
If 0 &lt; dltrule &lt; 1 (percentage), with excessive DLTs in the last cohort,
the next estimated dose must decrease by the dltrule (percentage) of
the last tested dose level, i.e. (1-dltrule)*lastdose.<br />
If dltrule &gt;= 1 (dose level), with excessive DLTs in the last cohort
the next estimated dose must decrease by dltrule dose level, i.e. lastdose-dltrule.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_increaserule">increaserule</code></td>
<td>
<p>If increaserule is specified, then the next estimated dose
can only increase by an amount specified by the increaserule between tested cohorts. Defaults to NA.<br />
If 0 &lt; increaserule &lt; 1 (percentage), the next dose can only increase to a maximum of lastdose*(1+increaserule).<br />
If increaserule &gt;= 1 (dose level), the next dose can only increase to a maximum of lastdose + increaserule.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_minimum">minimum</code></td>
<td>
<p>Minimum dose that will be considered to test patients. Must be specified if lowerlimitrule&lt;1.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_maximum">maximum</code></td>
<td>
<p>Maximum dose that will be considered to test patients. Must be specified if upperlimitrule&lt;1.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_combine01">combine01</code></td>
<td>
<p>True/False. If combine01 = TRUE, toxicity grades 0 and 1 are combined into 1 category.
Therefore all toxicities must be coded: 0 (grades 0 and 1), 1 (grade2), 2 (grade 3),
and 3 (grade 4) according to CTCAEv4.0. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="crmsimulations_+3A_rounddown">rounddown</code></td>
<td>
<p>True/False. Only applicable when using discrete dose levels.<br />
If rounddown = TRUE, the estimate dose from specified model will round down to the more conservative discrete dose level.<br />
If rounddown = FALSE, it will select the discrete dose closest to the estimated model selection. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If using a POM CRM, this function assumes a proportional odds model as described by Harrell (Harrell, 2001).
For combine01=FALSE, y equal to toxicity grade outcomes j in c(0, 1, 2, 3, 4) as specified by CTCAEv4.0, and x equal to the dose,
this is written in the form:<br />
</p>
<p style="text-align: center;"><code class="reqn">P(y&gt;=j|x)=1/(1+exp(-(\alpha_j + \beta*x))), j = 1, 2, 3, 4</code>
</p>
<p><br />
For combine01=TRUE, toxicity grades are now 0/1, 2, 3, and 4, and y is recoded as 0 = grades 0 and 1, 1 = grade 2,
2 = grade 3, and 3 = grade 4.<br />
</p>
<p>If using a CR model design, this function assumes a continuation ratio model as described by Harrell (Harrell, 2001).
For combine01=FALSE, y equal to toxicity grade outcomes j in c(0, 1, 2, 3, 4) as specified by CTCAEv4.0, and x equal to the dose,
this is written in the form:<br />
</p>
<p style="text-align: center;"><code class="reqn">P(y=j|y&gt;=j,x)=1/(1+exp(-(\alpha + \theta_j + \gamma*x))), j = 0, 1, 2, 3</code>
</p>
<p><br />
For combine01=TRUE, toxicity grades are now 0/1, 2, 3, and 4, and y is recoded as 0 = grades 0 and 1, 1 = grade 2,
2 = grade 3, and 3 = grade 4.<br />
</p>
<p>If using a binary CRM, this assumes a standard 2-parameter logistic model.
For y equal to toxicity outcome (1 is a DLT, 0 is not a DLT) and x equal to the dose, it is written in the form:<br />
</p>
<p style="text-align: center;"><code class="reqn">P(y=1|x)=1/(1+exp(-(\alpha + \beta*x)))</code>
</p>
<p><br />
</p>
<p>Estimated next dose is calculated by Pr(3 or 4 toxicity) &lt;= targetDLT for the model utilized.
</p>


<h3>Value</h3>

<p>Returns various safety and dose estimation performance statistics collected over all simulations.
Please see the list below for details.
</p>
<table>
<tr><td><code>`Median Total Sample Size of Trials Not Stopped Early Due to Safety Concerns`</code></td>
<td>
<p>Median
total sample size of trial for all simulations not stopped early due to ANY safety constraints.</p>
</td></tr>
<tr><td><code>`Patients per Cohort`</code></td>
<td>
<p>Pre-defined cohortsize</p>
</td></tr>
<tr><td><code>`Proportion of Trials Stopped Early Due to Safety Concerns`</code></td>
<td>
<p>Proportion of trials
stopped early due to ANY safety constraints among all simulations.</p>
</td></tr>
<tr><td><code>`Proportion of Trials Stopped Early Used Constraint`</code></td>
<td>
<p>Proportion of trials stopped
early due to any constraints while estimating the final dose for all simulations.</p>
</td></tr>
<tr><td><code>`Proportion of Trials Stopped Early Used the DLT Constraint`</code></td>
<td>
<p>Proportion of trials
stopped early only due to the DLT constraint while estimating the final dose for all simulations.</p>
</td></tr>
<tr><td><code>`Proportion of Trials Stopped Early Used the Increase Constraint`</code></td>
<td>
<p>Proportion of trials
stopped early only due to the increase constraint while estimating the final dose for all simulations.</p>
</td></tr>
<tr><td><code>`25% Quantile Sample Size`</code></td>
<td>
<p>25% quantile total Sample Size of trial for all simulations.</p>
</td></tr>
<tr><td><code>`75% Quantile Sample Size`</code></td>
<td>
<p>75% quantile total Sample Size of trial for all simulations.</p>
</td></tr>
<tr><td><code>`Median Dose`</code></td>
<td>
<p>Median dose estimated from all simulations.</p>
</td></tr>
<tr><td><code>`25% Quantile Dose`</code></td>
<td>
<p>25% quantile dose estimated from all simulations.</p>
</td></tr>
<tr><td><code>`75% Quantile Dose`</code></td>
<td>
<p>75% quantile dose estimated from all simulations.</p>
</td></tr>
<tr><td><code>`Percentage of Times Each Discrete Dose Level Was Selected`</code></td>
<td>
<p>This value is only returned when &quot;discrete&quot; is TRUE and
&quot;discretedoses&quot; are pre-specified. Each discrete dose level has a percentage indicating the chance that the dose level
been selected as the final estimated dose for all simulations.</p>
</td></tr>
<tr><td><code>`Median Percent Difference Between Estimated Dose and MTD`</code></td>
<td>
<p>Median difference in percentage between the final
estimated dose and the true maximum tolerated dose (MTD) for all simulations.</p>
</td></tr>
<tr><td><code>`Median Expected DLT for the Final Estimated Dose`</code></td>
<td>
<p>Median expected DLT rate
for the final estimated dose for all simulations.</p>
</td></tr>
<tr><td><code>`Median Sample Size For All Trials`</code></td>
<td>
<p>Median total sample size of trial for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials treated at doses with &gt;40% DLT rate`</code></td>
<td>
<p>Median percentage of patients
in the trial treated at doses with a DLT rate larger than 40% for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials treated at doses with &gt;50% DLT rate`</code></td>
<td>
<p>Median percentage of patients
in the trial treated at doses with a DLT rate larger than 50% for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials treated at doses with &lt;20% DLT rate`</code></td>
<td>
<p>Median percentage of patients
in the trial treated at doses with a DLT rate less than 20% for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials treated at doses with &lt;10% DLT rate`</code></td>
<td>
<p>Median percentage of patients
in the trial treated at doses with a DLT rate less than 10% for all simulations.</p>
</td></tr>
<tr><td><code>`Median Number of patients in all trials with a DLT (grade 3 or 4)`</code></td>
<td>
<p>Median number of patients
in trial with a grade 3 or grade 4 DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials with a DLT (grade 3 or 4)`</code></td>
<td>
<p>Median percentage of patients
in trial with a grade 3 or grade 4 DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials with grade 0 and 1`</code></td>
<td>
<p>Median percentage of patients
in trial with a grade 1 or grade 2 DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials with a non-DLT (grade 1 or 2)`</code></td>
<td>
<p>Median percentage of patients
in trial with a grade 1 or grade 2 non-DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials with no toxicity`</code></td>
<td>
<p>Median percentage of patients
in trial without DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials with grade 1`</code></td>
<td>
<p>Median percentage of patients
in trial with grade 1 DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials with grade 2`</code></td>
<td>
<p>Median percentage of patients
in trial with grade 2 DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials with grade 3`</code></td>
<td>
<p>Median percentage of patients
in trial with grade 3 DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Median % of patients in all trials with grade 4`</code></td>
<td>
<p>Median percentage of patients
in trial with grade 4 DLT for all simulations.</p>
</td></tr>
<tr><td><code>`Acutal MTD`</code></td>
<td>
<p>True MTD specified from dosetox.</p>
</td></tr>
<tr><td><code>`True MTD Discrete`</code></td>
<td>
<p>This value is only returned when &quot;discrete&quot; is TRUE and
&quot;discretedoses&quot; are pre-specified. Rounds the &quot;Acutal MTD&quot; to the nearest pre-specified discrete dose.</p>
</td></tr>
<tr><td><code>Dose</code></td>
<td>
<p>A vector of final estimated dose from each simulation.</p>
</td></tr>
<tr><td><code>Listit</code></td>
<td>
<p>A matrix of estimated doses after each cohort for each simulation.
For example, if &quot;numbersims&quot; is 5 and there are 10 cohorts in each trial, this will result in a 5*10 matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emily V. Dressler, PhD <br />
Markey Cancer Center <br />
Division of Cancer Biostatistics <br />
University of Kentucky <br />
<a href="mailto:EmilyVDressler@gmail.com">EmilyVDressler@gmail.com</a>
</p>


<h3>References</h3>

<p>1. Van Meter EM, Garrett-Mayer E, Bandyopadhyay D. Proportional odds model for dose finding clinical trial designs with ordinal toxicity grading. Statistics in Medicine 2011; 30: 2070-2080. <br />
2. Van Meter EM, Garrett-Mayer E, Bandyopadhyay. Dose finding clinical trial design for ordinal toxicity grades using the continuation ratio model: an extension of the continual reassessment method. Clinical Trials 2012; 9(3): 303-313. <br />
3. Garrett-Mayer E. The continual reassessment method for dose-finding studies: a tutorial. Clinical Trials 2006; 3: 57-71. <br />
4. Piantadosi S, Fisher JD, Grossman S. Practical implementation of a modified continual reassessment method for dose-finding trials. Cancer Chemother Pharmacol 1998; 41: 429-436. <br />
5. Harrell FE, Jr. Regression Modeling Strategies with Application to Linear Models, Logistic Regression, and Survival Analysis. Springer: New York, NY, 2001. <br />
6. McCullagh P. Regression Models for Ordinal Data. Journal of the Royal Statistical Society. Series B (Methodological). 1980; 42: 109-142. <br />
7. CTCAE. Cancer Therapy Evaluation Program, Common Terminology Criteria for Adverse Events, Version 4.0, DCTD, NCI, NIH, DHHS (http://ctep/cancer.gov). In Cancer Therapy Evaluation Program, 2010.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1
#Underlying True POM dosetox
truePO1&lt;-c(-0.4, 0.0011, -1.3, 0.0011, -2.8, 0.0011, -3.9, 0.0011)
#POM Pseudodata
initial.pom.y1&lt;-c(rep(0,45),rep(1,36),rep(2,9),rep(3,8),rep(4,2),rep(0,18),
rep(1,35),rep(2,17),rep(3,24),rep(4,6),rep(0,8),rep(1,24),rep(2,18),rep(3,38),
rep(4,12),rep(0,1),rep(1,4),rep(2,5),rep(3,35),rep(4,55))
initial.pom.d1&lt;-c(rep(200,100),rep(1067,100),rep(1613,100),rep(3000,100))
#POM CRM Design Simulation run 10 times, with a true dosetox model equal to a POM
crmsimulations(startdose = 1060, numbersims = 10, cohortsize = 3, samplesize = 30,
pseudoweights = 3,pseudotox = initial.pom.y1, pseudodose = initial.pom.d1, dosetox = truePO1,
truedosetoxmodeltype = 'POM', design = 'POM', targetDLT = 0.30, discrete = FALSE,
discretedoses = NA, numberdltrule = NA, lowerlimitrule = NA, upperlimitrule = NA,
dltrule = NA, increaserule= NA, minimum = NA, maximum = NA, combine01 = FALSE)

#Example 2
#Underlying true POM dosetox
truePO1&lt;-c(-0.4, 0.0011, -1.3, 0.0011, -2.8, 0.0011, -3.9, 0.0011) #POM 1#
#CR Model Pseudodata with Grades 0 and 1 combined into one category
combine.cr.y1&lt;-c(rep(0,81),rep(1,9),rep(2,8),rep(3,2),
rep(0,55),rep(1,15),rep(2,26),rep(3,4),
rep(0,37),rep(1,13),rep(2,40),rep(3,10),
rep(0,5),rep(1,5),rep(2,35),rep(3,55))
initial.cr.d1&lt;-c(rep(200,100),rep(934,100),rep(1467,100),rep(3000,100))
#CR Model CRM Design Simulation run 10 times, with a true dosetox model equal to a POM
crmsimulations(startdose = 1060, numbersims = 10, cohortsize = 3,
samplesize = 30, pseudoweights = 3,pseudotox = combine.cr.y1,
pseudodose = initial.cr.d1, dosetox = truePO1, truedosetoxmodeltype = 'POM',
design = 'CR', targetDLT = 0.30, discrete = FALSE, discretedoses = NA,
numberdltrule = NA, lowerlimitrule = NA, upperlimitrule = NA, dltrule = NA,
increaserule = NA, minimum = NA, maximum = NA, combine01 = TRUE)

#Example 3
#Underlying True CR dosetox
crmodel1&lt;-c(1.58,-0.0018,-0.45,-0.0018,1.20,-0.0018,3.14,-0.0018) #CR Model 1#
#CRM Pseudodata
initial.crm.y1&lt;-c(rep(0,90),rep(1,10),rep(0,70),rep(1,30),
rep(0,50),rep(1,50),rep(0,10),rep(1,90))
initial.crm.d1&lt;-c(rep(200,100),rep(1060,100),rep(1600,100),rep(3000,100))
#Binary CRM Design Simulation run 10 times, with a true dosetox model equal to a CR
crmsimulations(startdose = 1060, numbersims = 10, cohortsize = 2,
samplesize = 20, pseudoweights = 3,pseudotox = initial.crm.y1,
pseudodose = initial.crm.d1, dosetox = crmodel1, truedosetoxmodeltype = 'CR',
design = 'CRM', targetDLT = 0.30, discrete=TRUE,
discretedoses=c(200,400,800,1200,1800,2500),
numberdltrule = NA, lowerlimitrule = NA, upperlimitrule = NA, dltrule = NA,
increaserule = NA, minimum = NA, maximum = NA, combine01 = FALSE)

</code></pre>

<hr>
<h2 id='nextdose'>Estimates the updated model and next dose to be tested for the Proportional Odds Model (POM),
Continuation Ratio (CR) Model CRM, or binary 2-parameter logistic model CRM.</h2><span id='topic+nextdose'></span>

<h3>Description</h3>

<p>This function incorporates pseudodata created in <code><a href="#topic+pseudodata">pseudodata</a></code> with the collected cohorts
of patient information and updates the fitted model selected (choice of POM, CR, or binary 2-parameter
logistic model). Using this newly updated model, it then re-estimates the next dose to be tested for
a specified target dose limiting toxicity (DLT) rate. It has the flexibility to add in various
safety constraints and can accommodate continuous or discrete doses. This function also has to option to
combine toxicity grades 0 and 1 as specified by CTCAEv4.0 into one category should clinical investigators
wish to do so.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nextdose(design, pseudotox, pseudodose, collectedtox, collecteddose,
  cohortsize = 3, targetDLT = 0.3, pseudoweights = NA, discrete = FALSE,
  discretedoses = NA, rounddown = FALSE, numberdltrule = NA,
  lowerlimitrule = NA, upperlimitrule = NA, dltrule = NA,
  increaserule = NA, minimum = NA, maximum = NA, combine01 = FALSE,
  plotit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nextdose_+3A_design">design</code></td>
<td>
<p>Specifies which dose finding design you are running simulations on.
Choices are: POM, CR, or CRM.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_pseudotox">pseudotox</code></td>
<td>
<p>A vector of toxicity grades specified by the pseudodata.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_pseudodose">pseudodose</code></td>
<td>
<p>A vector of dose levels specified by the pseudodata.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_collectedtox">collectedtox</code></td>
<td>
<p>A vector of treated patient toxicity outcomes.
For j patients treated up to this point in the trial, collecteddose is in the form:
c(toxicity grade patient 1, ..., toxicity grade patient j). <br />
If combine01 is false, toxicity grades range from 0, 1, 2, 3, and 4.
If combine01 is true, toxicity grades are coded 0 (grades 0 and 1), 1 (grade 2), 2 (grade 3),
and 3 (grade 4). Toxicity grades are specified according to CTCAEv4.0.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_collecteddose">collecteddose</code></td>
<td>
<p>A vector of treated patient dose levels. For j patients treated up to this point
in the trial, collecteddose is in the form: c(dose patient 1, ..., dose patient j).</p>
</td></tr>
<tr><td><code id="nextdose_+3A_cohortsize">cohortsize</code></td>
<td>
<p>Number of patients treated in a cohort. Defaults to 3.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_targetdlt">targetDLT</code></td>
<td>
<p>Target dose limiting toxicity (DLT) rate pre-specified by clinical investigators prior to the start of the trial.
Must be specified between 0 and 1. Defaults to 0.30.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_pseudoweights">pseudoweights</code></td>
<td>
<p>Pseudoweights determine the amount of influence the pseudodata has on estimating the updated model.
Please refer to Van Meter et al (2010) for more information. We suggest setting the pseudoweights equal to the cohortsize.
When pseudoweights = X, the total pseudodata represent X individuals in the updated model. If not specified,
pseudoweights defaults to cohortsize.
Must be specified between 0 and 1. Defaults to 0.30.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_discrete">discrete</code></td>
<td>
<p>True/False. If discrete = TRUE this allows for discrete dose levels
to be specified prior to the start of the trial. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_discretedoses">discretedoses</code></td>
<td>
<p>Specified discrete dose levels if desired. They must be specified if discrete is equal to TRUE.
It is written for j dose levels as: c(d1, d2,..., dj).</p>
</td></tr>
<tr><td><code id="nextdose_+3A_rounddown">rounddown</code></td>
<td>
<p>True/False. Only applicable when using discrete dose levels.<br />
If rounddown = TRUE, the estimate dose from specified model will round down to the more conservative discrete dose level.<br />
If rounddown = FALSE, it will select the discrete dose closest to the estimated model selection. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_numberdltrule">numberdltrule</code></td>
<td>
<p>Number of dose limiting toxicities (DLTs) that would be considered excessively unsafe if observed in a cohort of patients.
This would prompt the DLT constraint if there is one specified. Defaults to NA.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_lowerlimitrule">lowerlimitrule</code></td>
<td>
<p>If lowerlimitrule is specified, this constraint will stop the trial if the dose
is estimated to be under a certain level as a safety precaution. Investigators may feel any dose under
this lowerlimitrule would suggest excessive toxicity with this investigational drug and no true MTD may exist.<br />
This can be specified as a dose level or percentage.<br />
If lowerlimitrule &lt;1 (percentage), it takes the range of possible data (maximum - minimum) and makes the lower bound
when the trial would stop early as: minimum + (maximum - minimum)*lowerlimitrule.<br />
If lowerlimitrule &gt;1 (dose level) then the lower bound when the trial would stop early is the lowerlimitrule.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_upperlimitrule">upperlimitrule</code></td>
<td>
<p>If upperlimitrule is specified, this constraint will stop the trial if the dose is estimated to be higher
than a certain level. <br />
If upperlimitrule &lt;1 (percentage), it takes the range of possible data (maximum - minimum) and makes the upper bound
when the trial would stop early as: maximum - (maximum - minimum)*upperlimitrule. <br />
If upperlimitrule &gt;1 (dose level) then the upper bound
when the trial would stop early is the upperlimitrule.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_dltrule">dltrule</code></td>
<td>
<p>If the numberdltrule (i.e. 2 DLTs) occurs in the last cohort of patients tested,
the next estimated dose must decrease by an amount specified by the dltrule.
Defaults to NA.  <br />
If 0 &lt; dltrule &lt; 1 (percentage), with excessive DLTs in the last cohort,
the next estimated dose must decrease by the dltrule (percentage) of
the last tested dose level, i.e. (1-dltrule)*lastdose.<br />
If dltrule &gt;= 1 (dose level), with excessive DLTs in the last cohort
the next estimated dose must decrease by dltrule dose level, i.e. lastdose-dltrule.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_increaserule">increaserule</code></td>
<td>
<p>If increaserule is specified, then the next estimated dose
can only increase by an amount specified by the increaserule between tested cohorts. Defaults to NA.<br />
If 0 &lt; increaserule &lt; 1 (percentage), the next dose can only increase to a maximum of lastdose*(1+increaserule).<br />
If increaserule &gt;= 1 (dose level), the next dose can only increase to a maximum of lastdose + increaserule.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_minimum">minimum</code></td>
<td>
<p>Minimum dose that will be considered to test patients. Must be specified if lowerlimitrule&lt;1.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_maximum">maximum</code></td>
<td>
<p>Maximum dose that will be considered to test patients. Must be specified if upperlimitrule&lt;1.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_combine01">combine01</code></td>
<td>
<p>True/False. If combine01 = TRUE, toxicity grades 0 and 1 are combined into 1 category.
Therefore all toxicities must be coded: 0 (grades 0 and 1), 1 (grade2), 2 (grade 3),
and 3 (grade 4) according to CTCAEv4.0. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="nextdose_+3A_plotit">plotit</code></td>
<td>
<p>True/False. If true, returns a plot of the updated model with the next dose to test in a cohort identified
as well as the current accrued patient toxicity outcomes. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If using a POM CRM, this function assumes a proportional odds model as described by Harrell (Harrell, 2001).
For combine01=FALSE, y equal to toxicity grade outcomes j in c(0, 1, 2, 3, 4) as specified by CTCAEv4.0, and x equal to the dose,
this is written in the form:<br />
</p>
<p style="text-align: center;"><code class="reqn">P(y&gt;=j|x)=1/(1+exp(-(\alpha_j + \beta*x))),for j = 1, 2, 3, 4</code>
</p>
<p><br />
For combine01=Ture, toxicity grades are now 0/1, 2, 3, and 4, and y is recoded as 0 = grades 0 and 1, 1 = grade 2,
2 = grade 3, and 3 = grade 4.<br />
</p>
<p>If using a CR model design, this function assumes a continuation ratio model as described by Harrell (Harrell, 2001).
For combine01=FALSE, y equal to toxicity grade outcomes j in c(0, 1, 2, 3, 4) as specified by CTCAEv4.0, and x equal to the dose,
this is written in the form:<br />
</p>
<p style="text-align: center;"><code class="reqn">P(y=j|y&gt;=j,x)=1/(1+exp(-(\alpha + \theta_j + \gamma*x))), j = 0, 1, 2, 3</code>
</p>
<p><br />
For combine01=TURE, toxicity grades are now 0/1, 2, 3, and 4, and y is recoded as 0 = grades 0 and 1, 1 = grade 2,
2 = grade 3, and 3 = grade 4.<br />
</p>
<p>If using a binary CRM, this assumes a standard 2-parameter logistic model.
For y equal to toxicity outcome (1 is a DLT, 0 is not a DLT) and x equal to the dose, it is written in the form:<br />
</p>
<p style="text-align: center;"><code class="reqn">P(y=1|x)=1/(1+exp(-(\alpha + \beta*x)))</code>
</p>
<p><br />
</p>
<p>Estimated next dose is calculated by Pr(3 or 4 toxicity) &lt;= targetDLT for the model utilized.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Next Dose with No Used Constraints</code></td>
<td>
<p>Returns estimated dose with no safety constraints
implemented for a specified target DLT rate.</p>
</td></tr>
<tr><td><code>Next Dose with Constraints if Applicable</code></td>
<td>
<p>Returns estimated dose with safety constraints used if
applicable for a specified target DLT rate.</p>
</td></tr>
<tr><td><code>Next Dose if Using Discrete Dose Levels</code></td>
<td>
<p>Returns the next dose estimated if
discrete dose levels are requested.</p>
</td></tr>
<tr><td><code>Estimated Probability of a Grade 0 or 1 Toxicity</code></td>
<td>
<p>Using the newly re-estimated model
based on the combination of pseudodata and updated patient information,
this returns the probability of experiencing a grade 0 or 1 toxicity as specified by CTCAEv4.0.
Only applicable if combine01 = TRUE.</p>
</td></tr>
<tr><td><code>Estimated Probability of a Grade 0 Toxicity</code></td>
<td>
<p>Using the newly re-estimated model based on the combination of pseudodata and updated patient information,
this returns the probability of experiencing a grade 0 toxicity as specified by CTCAEv4.0.
Only applicable if combine01 = FALSE.</p>
</td></tr>
<tr><td><code>Estimated Probability of a Grade 1 Toxicity</code></td>
<td>
<p>Using the newly re-estimated model based on the combination of pseudodata and updated patient information,
this returns the probability of experiencing a grade 1 toxicity as specified by CTCAEv4.0.
Only applicable if combine01 = FALSE.</p>
</td></tr>
<tr><td><code>Estimated Probability of a Grade 2 Toxicity</code></td>
<td>
<p>Using the newly re-estimated model based on the combination of pseudodata and updated patient information,
this returns the probability of experiencing a grade 2 toxicity as specified by CTCAEv4.0.</p>
</td></tr>
<tr><td><code>Estimated Probability of a Grade 3 Toxicity</code></td>
<td>
<p>Using the newly re-estimated model based on the combination of pseudodata and updated patient information,
this returns the probability of experiencing a grade 3 toxicity as specified by CTCAEv4.0.</p>
</td></tr>
<tr><td><code>Estimated Probability of a Grade 4 Toxicity</code></td>
<td>
<p>Using the newly re-estimated model based on the combination of pseudodata and updated patient information,
this returns the probability of experiencing a grade 4 toxicity as specified by CTCAEv4.0.</p>
</td></tr>
<tr><td><code>Estimated Regression Model</code></td>
<td>
<p>Returns parameter estimates for the newly re-estimated model based on the combination of pseudodata and updated patient information.</p>
</td></tr>
<tr><td><code>Influence from Pseudodata</code></td>
<td>
<p>Returns the percentage of influence the pseudodata has on estimating the new model.
Please refer to Van Meter et al (2010) for more information.</p>
</td></tr>
<tr><td><code>Influence from Collected Data</code></td>
<td>
<p>Returns the percentage of influence the treated patient data has on estimating the new model.
Please refer to Van Meter et al (2010) for more information.</p>
</td></tr>
<tr><td><code>Constraints Used</code></td>
<td>
<p>Identifies which safety constraint was implemented if any. Returns: DLT Rule Used, Increase Rule Used,
Lower Bound Stop Rule Used, Upper Bound Stop Rule Used, or None Used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emily V. Dressler, PhD <br />
Markey Cancer Center<br />
Division of Cancer Biostatistics<br />
University of Kentucky<br />
<a href="mailto:EmilyVDressler@gmail.com">EmilyVDressler@gmail.com</a>
</p>


<h3>References</h3>

<p>1. Van Meter EM, Garrett-Mayer E, Bandyopadhyay D. Proportional odds model for dose finding clinical trial designs with ordinal toxicity grading. Statistics in Medicine 2011; 30: 2070-2080. <br />
2. Van Meter EM, Garrett-Mayer E, Bandyopadhyay. Dose finding clinical trial design for ordinal toxicity grades using the continuation ratio model: an extension of the continual reassessment method. Clinical Trials 2012; 9(3): 303-313. <br />
3. Garrett-Mayer E. The continual reassessment method for dose-finding studies: a tutorial. Clinical Trials 2006; 3: 57-71. <br />
4. Piantadosi S, Fisher JD, Grossman S. Practical implementation of a modified continual reassessment method for dose-finding trials. Cancer Chemother Pharmacol 1998; 41: 429-436. <br />
5. Harrell FE, Jr. Regression Modeling Strategies with Application to Linear Models, Logistic Regression, and Survival Analysis. Springer: New York, NY, 2001. <br />
6. McCullagh P. Regression Models for Ordinal Data. Journal of the Royal Statistical Society. Series B (Methodological). 1980; 42: 109-142. <br />
7. CTCAE. Cancer Therapy Evaluation Program, Common Terminology Criteria for Adverse Events, Version 4.0, DCTD, NCI, NIH, DHHS (http://ctep/cancer.gov). In Cancer Therapy Evaluation Program, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pseudodata">pseudodata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Pseudodata toxicity grades#
initial.cr.y1 &lt;- c(rep(0, 45), rep(1, 36), rep(2, 9), rep(3, 8), rep(4, 2),
                   rep(0, 24), rep(1, 31), rep(2, 15), rep(3, 26), rep(4, 4),
                   rep(0, 14), rep(1, 23), rep(2, 13), rep(3, 40), rep(4, 10),
                   rep(0, 1), rep(1, 4), rep(2, 5), rep(3, 35), rep(4, 55))

#Pseudodata dose levels#
initial.cr.d1 &lt;- c(rep(200, 100), rep(934, 100), rep(1467, 100), rep(3000, 100))

#Pseudodata toxicity grades if combining grades 0 and 1 into 1 category#
combine.cr.y1 &lt;- c(rep(0, 81), rep(1, 9), rep(2, 8), rep(3, 2),
                   rep(0, 55), rep(1, 15), rep(2, 26), rep(3, 4),
                   rep(0, 37), rep(1, 13), rep(2, 40), rep(3, 10),
                   rep(0, 5), rep(1, 5), rep(2, 35), rep(3, 55))

#6 patients already treated at doses 1060 and 800 respectively
#CR model assumption

#Example 1
nextdose(design='CR', pseudotox = initial.cr.y1, pseudodose = initial.cr.d1, cohortsize =,
         collectedtox = c(1, 4, 2, 0, 0, 1), collecteddose = c(1060, 1060, 1060, 800, 800, 800),
         targetDLT = 0.30, pseudoweights = 3, discrete = FALSE, discretedoses = NA,
         combine01 = FALSE, lowerlimitrule = 500)

#Example 2
#Discrete doses and combining grades 0 and 1
nextdose(design='CR', pseudotox = combine.cr.y1, pseudodose = initial.cr.d1, cohortsize =,
        collectedtox = c(1, 3, 2, 0, 0, 1), collecteddose = c(1060, 1060, 1060, 800, 800, 800),
        targetDLT = 0.30, pseudoweights = 3, discrete = TRUE,
        discretedoses = c(200, 500, 100, 1200, 1500, 1800), combine01 = TRUE,
        lowerlimitrule = 500)
</code></pre>

<hr>
<h2 id='pseudodata'>Pseudodata for Likelihood-Based Continual Reassessment Method (CRM) Dose Finding Designs</h2><span id='topic+pseudodata'></span>

<h3>Description</h3>

<p>This function creates 2 pseudodata vectors (toxicity and dose levels) necessary to run any of the
3 variations of the likelihood-based CRM design. If using the ordinal POM or CR model design,
ordinal toxicity grades are specified by CTCAEv4.0. This function also specifies the starting dose
for a trial with the choice of continuous or discrete dose levels for a specified target dose limiting
toxicity (DLT) rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudodata(design, dose10, dose90, percentagegradedose10 = c(45, 35, 10, 8,
  2), percentagegradedose90 = c(2, 3, 5, 40, 50), targetDLT = 0.3,
  stabilize = TRUE, discrete = FALSE, discretedoses = NA,
  rounddown = FALSE, combine01 = FALSE, plotit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pseudodata_+3A_design">design</code></td>
<td>
<p>Specifies which dose finding design you are running simulations on.
Choices are: POM, CR, or CRM.</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_dose10">dose10</code></td>
<td>
<p>Hypothesized dose level for a 10 percent dose limiting toxicity (DLT) rate as specified
by clinical investigators prior to the start of the trial.</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_dose90">dose90</code></td>
<td>
<p>Hypothesized dose level for a 90 percent dose limiting toxicity (DLT) rate as specified
by clinical investigators prior to the start of the trial.</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_percentagegradedose10">percentagegradedose10</code></td>
<td>
<p>Only applicable if using ordinal POM or CR model designs.
Expected percentage of toxicity grades at the specified dose10 in the form
c(percent grade 0, percent grade 1, grade 2, grade 3, grade 4) or
c(percent grades 0 and 1, grade 2, grade 3, grade 4) if combining grades 0 and 1 into one category.
The percentages must be specified between 0 and 100. If not specified,
it will default to c(45, 35, 10, 8, 2).</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_percentagegradedose90">percentagegradedose90</code></td>
<td>
<p>Only applicable if using ordinal POM or CR model designs.
Expected percentage of toxicity grades at the specified dose90. This is also in the form:
c(percent grade 0, percent grade 1, grade 2, grade 3, grade 4) or
c(percent grades 0 and 1, grade 2, grade 3, grade 4) if combining grades 0 and 1 into one category.
The percentages must be specified between 0 and 100. If not specified,
it will default to c(2, 3, 5, 40, 50).</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_targetdlt">targetDLT</code></td>
<td>
<p>Target dose limiting toxicity (DLT) rate pre-specified by clinical investigators
prior to the start of the trial. Must be specified between 0 and 1.
Defaults to 0.30.</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_stabilize">stabilize</code></td>
<td>
<p>True/False. If stabilize = TRUE, expected dose levels for 30 percent
and 50 percent DLT rates will be estimated from the initialized CR model and these levels will be
added into the pseudodata to help stabilize the model. This is particularly helpful when
collected data is initially sparse at the beginning of a trial. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_discrete">discrete</code></td>
<td>
<p>True/False. If discrete = TRUE, this allows for discrete dose levels to be
specified prior to the start of the trial. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_discretedoses">discretedoses</code></td>
<td>
<p>Specified discrete dose levels if desired. They must be specified if discrete is equal to TRUE.
It is written for j dose levels as: c(d1, d2,..., dj).</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_rounddown">rounddown</code></td>
<td>
<p>True/False. Only applicable when using discrete dose levels.<br />
If rounddown = TRUE, the estimate dose from specified model will round down to the more conservative discrete dose level.<br />
If rounddown = FALSE, it will select the discrete dose closest to the estimated model selection. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_combine01">combine01</code></td>
<td>
<p>True/False. If combine01 = TRUE, toxicity grades 0 and 1 are combined into 1 category.
Therefore all toxicities must be coded: 0 (grades 0 and 1), 1 (grade2), 2 (grade 3),
and 3 (grade 4) according to CTCAEv4.0. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="pseudodata_+3A_plotit">plotit</code></td>
<td>
<p>True/False. If plotit = TRUE, returns a plot of the continuation ratio model estimated by
the pseudodata with the starting dose for a specified target DLT rate.
Also identifies dose10 and dose90 on the figure. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits a POM, CR model, or 2-parameter logistic model based on the dose where 10
This outputs a vector of doses and toxicities to use as the starting model for this design (required to run
<code><a href="#topic+nextdose">nextdose</a></code> and <code><a href="#topic+crmsimulations">crmsimulations</a></code>)
</p>


<h3>Value</h3>

<table>
<tr><td><code>Pseudodata Toxicities</code></td>
<td>
<p>A vector of toxicity grades as classified by CTCAEv4.0
created from the initialized model. If using a binary CRM this will be a vector of 0 (non-DLT) and
1 (DLT) outcomes. This will be the pseudodata toxicity grades used for the rest of trial.</p>
</td></tr>
<tr><td><code>Pseudodata Doses</code></td>
<td>
<p>A vector of dose levels created from the initialized model.
This will be the pseudodata dose levels used for the rest of the trial.</p>
</td></tr>
<tr><td><code>Starting Dose</code></td>
<td>
<p>The starting dose for this trial given the specified target DLT rate assuming
continuous dose levels.</p>
</td></tr>
<tr><td><code>Starting Discrete Dose</code></td>
<td>
<p>The starting dose for this trial given the specified
target DLT rate assuming discrete dose levels.</p>
</td></tr>
<tr><td><code>Estimated Toxicity at Discrete Doses</code></td>
<td>
<p>Only applicable if using specified discrete dose levels.
Returns the expected probability of
a dose-limiting toxicity (DLT) at each discrete dose level given the initialized model.</p>
</td></tr>
<tr><td><code>discretedoses</code></td>
<td>
<p>Returns the possible ordered discrete doses if applicable.</p>
</td></tr>
<tr><td><code>Regression Model</code></td>
<td>
<p>Returns parameter estimates for the newly estimated model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emily V. Dressler, PhD <br />
Markey Cancer Center <br />
Division of Cancer Biostatistics <br />
University of Kentucky <br />
<a href="mailto:EmilyVDressler@gmail.com">EmilyVDressler@gmail.com</a>
</p>


<h3>References</h3>

<p>1. Van Meter EM, Garrett-Mayer E, Bandyopadhyay D. Proportional odds model for dose finding clinical trial designs with ordinal toxicity grading. Statistics in Medicine 2011; 30: 2070-2080. <br />
2. Van Meter EM, Garrett-Mayer E, Bandyopadhyay. Dose finding clinical trial design for ordinal toxicity grades using the continuation ratio model: an extension of the continual reassessment method. Clinical Trials 2012; 9(3): 303-313. <br />
3. Garrett-Mayer E. The continual reassessment method for dose-finding studies: a tutorial. Clinical Trials 2006; 3: 57-71. <br />
4. Piantadosi S, Fisher JD, Grossman S. Practical implementation of a modified continual reassessment method for dose-finding trials. Cancer Chemother Pharmacol 1998; 41: 429-436. <br />
5. Harrell FE, Jr. Regression Modeling Strategies with Application to Linear Models, Logistic Regression, and Survival Analysis. Springer: New York, NY, 2001. <br />
6. McCullagh P. Regression Models for Ordinal Data. Journal of the Royal Statistical Society. Series B (Methodological). 1980; 42: 109-142. <br />
7. CTCAE. Cancer Therapy Evaluation Program, Common Terminology Criteria for Adverse Events, Version 4.0, DCTD, NCI, NIH, DHHS (http://ctep/cancer.gov). In Cancer Therapy Evaluation Program, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nextdose">nextdose</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
######################
###For POM Model######
######################
#Creates pseudodata with no stabilization and continuous dose levels
pseudodata(design='POM', dose10 = 200, dose90 = 3600, targetDLT = 0.3,
           stabilize = TRUE, discrete = FALSE, discretedoses = NA,
           percentagegradedose10 = c(45, 35, 10, 8, 2),
           percentagegradedose90 = c(2, 3, 5, 40, 50), combine01 = FALSE)
#Creates pseudodata with stabilize=T and discrete dose levels
pseudodata(design='POM', dose10 = 500, dose90 = 2000, targetDLT = 0.3,
           stabilize = TRUE, discrete = TRUE,
           discretedoses = c(200, 500, 1000, 1200, 1500, 1800))
#Creates pseudodata when toxicity grades 0 and 1 are one category
pseudodata(design='POM', dose10 = 200, dose90 = 1000, targetDLT = 0.3,
           stabilize = TRUE, discrete = FALSE, discretedoses = NA,
           percentagegradedose10 = c(80, 10, 8, 2),
           percentagegradedose90 = c(5, 5, 40, 50), combine01 = TRUE)

######################
###For CR Model#######
######################
#Creates pseudodata with no stabilization and continuous dose levels
pseudodata(design='CR', dose10 = 200, dose90 = 3600, targetDLT = 0.3,
           stabilize = TRUE, discrete = FALSE, discretedoses = NA,
           percentagegradedose10 = c(45, 35, 10, 8, 2),
           percentagegradedose90 = c(2, 3, 5, 40, 50), combine01 = FALSE)
#Creates pseudodata with stabilize=T and discrete dose levels
pseudodata(design='CR', dose10 = 500, dose90 = 2000, targetDLT = 0.3,
           stabilize = TRUE, discrete = TRUE,
           discretedoses = c(200, 500, 1000, 1200, 1500, 1800))
#Creates pseudodata when toxicity grades 0 and 1 are one category
pseudodata(design='CR', dose10 = 200, dose90 = 1000, targetDLT = 0.3,
           stabilize = TRUE, discrete = FALSE, discretedoses = NA,
           percentagegradedose10 = c(80, 10, 8, 2),
           percentagegradedose90=c(5, 5, 40, 50), combine01 = TRUE)

######################
###For Binary CRM#####
######################
#Creates pseudodata with no stabilization and continuous dose levels
pseudodata(design='CRM', dose10 = 200, dose90 = 3600, targetDLT = 0.3,
           stabilize = TRUE, discrete = FALSE, discretedoses = NA)
#Creates pseudodata with stabilize=T and discrete dose levels
pseudodata(design='CRM', dose10 = 200, dose90 = 3000, targetDLT = 0.3,
           stabilize = TRUE, discrete = TRUE,
           discretedoses = c(200, 500, 1000, 1200, 1500, 1800))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
