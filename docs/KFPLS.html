<!DOCTYPE html><html lang="en"><head><title>Help for package KFPLS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {KFPLS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#KFPLS'><p>Kernel functional partial least squares method</p></a></li>
<li><a href='#predict.KFPLS'><p>Prediction by KFPLS</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Kernel Functional Partial Least Squares</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation for kernel functional partial least squares (KFPLS) method. KFPLS method is developed for functional nonlinear models, and the method does not require strict constraints for the nonlinear structures. The crucial function of this package is KFPLS().</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>fda, splines, stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-07 14:52:14 UTC; 11013</td>
</tr>
<tr>
<td>Author:</td>
<td>Rou Zhong [aut, cre],
  Jingxiao Zhang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rou Zhong &lt;zhong_rou@163.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-10 13:03:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='KFPLS'>Kernel functional partial least squares method</h2><span id='topic+KFPLS'></span>

<h3>Description</h3>

<p>Kernel functional partial least squares (KFPLS) method for functional nonlinear models with scalar response and functional predictors. The Gaussian kernel is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KFPLS(X, Y, obser_time, nfold, n_comp, sigm_list, basis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KFPLS_+3A_x">X</code></td>
<td>
<p>An <code>array</code> with three indices. The (i, j, k)-th element of it corresponds to the measurment of the i-th subject for the k-th functional predictor at j-th observation grid.</p>
</td></tr>
<tr><td><code id="KFPLS_+3A_y">Y</code></td>
<td>
<p>A <code>vector</code> with length n, where n is the sample size. The i-th element of it corresponds to the measurement of the scalar response for the i-th subject.</p>
</td></tr>
<tr><td><code id="KFPLS_+3A_obser_time">obser_time</code></td>
<td>
<p>A <code>vector</code> denoting the observation times of the functional predictors.</p>
</td></tr>
<tr><td><code id="KFPLS_+3A_nfold">nfold</code></td>
<td>
<p>An <code>integer</code> denoting the number of folds for the selection of the tuning parameters by cross-validation.</p>
</td></tr>
<tr><td><code id="KFPLS_+3A_n_comp">n_comp</code></td>
<td>
<p>A <code>vector</code> denoting the candidates of the number of components.</p>
</td></tr>
<tr><td><code id="KFPLS_+3A_sigm_list">sigm_list</code></td>
<td>
<p>A <code>vector</code> denoting the candidates of the tuning parameter for the Gaussian kernel.</p>
</td></tr>
<tr><td><code id="KFPLS_+3A_basis">basis</code></td>
<td>
<p>A basis object denoting the basis that used for the smoothing of the functional predictors. It is created by functions in <code>fda</code> package, such as <code><a href="fda.html#topic+create.bspline.basis">create.bspline.basis</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>n</code></td>
<td>
<p>A <code>scalar</code> denoting the sample size.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>A <code>scalar</code> denoting the number of functional predictors.</p>
</td></tr>
<tr><td><code>nk</code></td>
<td>
<p>A <code>scalar</code> denoting the selected number of components.</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>A <code>matrix</code> denoting the value of T at convergence.</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>A <code>matrix</code> denoting the value of U at convergence.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>A <code>matrix</code> denoting the Gram matrix.</p>
</td></tr>
<tr><td><code>K_c</code></td>
<td>
<p>A <code>matrix</code> denoting the centralized Gram matrix.</p>
</td></tr>
<tr><td><code>Xfd_list</code></td>
<td>
<p>A <code>list</code> of length <code>p</code>. The k-th entry corresponds to the functional data object of the k-th functional predictor.</p>
</td></tr>
<tr><td><code>XX_list</code></td>
<td>
<p>A <code>list</code> of length <code>p</code>. The k-th entry corresponds to the matrix that denotes the inner product of the k-th functional predictor for all subjects.</p>
</td></tr>
<tr><td><code>Y_c</code></td>
<td>
<p>A <code>vector</code> denoting the centralized scalar response.</p>
</td></tr>
<tr><td><code>meanY</code></td>
<td>
<p>A <code>scalar</code> denoting the sample mean of the scalar response.</p>
</td></tr>
<tr><td><code>Y_hat</code></td>
<td>
<p>A <code>vector</code> denoting the prediction of the scalar response.</p>
</td></tr>
<tr><td><code>obser_time</code></td>
<td>
<p>A <code>vector</code> denoting the observation times of the functional predictors.</p>
</td></tr>
<tr><td><code>basis</code></td>
<td>
<p>A basis object denoting the basis that used for the smoothing of the functional predictors.</p>
</td></tr>
<tr><td><code>sigm</code></td>
<td>
<p>A <code>scalar</code> denoting the selected tuning parameter for the Gaussian kernel.</p>
</td></tr>
<tr><td><code>CVscore</code></td>
<td>
<p>A <code>matrix</code> denoting the CV scores.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>A <code>scalar</code> denoting the computation time.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data
n &lt;- 200
t_range &lt;- c(0, 1)
obser_time &lt;- seq(0, 1, length.out = 51)
beta_fun &lt;- function(t){2 * sin(2 * pi * t)}
basis &lt;- fda::create.bspline.basis(t_range, nbasis = 13, norder = 4,
breaks = seq(0, 1, length.out = 11))
beta_fd &lt;- fda::smooth.basis(obser_time, beta_fun(obser_time), basis)$fd
X_basis &lt;- fda::create.bspline.basis(t_range, nbasis = 23, norder = 4,
breaks = seq(0, 1, length.out = 21))
Bbeta &lt;- fda::inprod(X_basis, beta_fd)
Xi_B &lt;- splines::bs(obser_time, knots = seq(0, 1, length.out = 21)[-c(1, 21)],
degree = 3, intercept = TRUE)
a &lt;- array(0, dim = c(n, 23, 1))
X &lt;- array(0, dim = c(n, 51, 1))
Y &lt;- NULL
for(i in 1:n){
a[i, , 1] &lt;- stats::rnorm(23)
X[i, , 1] &lt;- Xi_B %*% a[i, , 1]
aBbeta &lt;- as.numeric(t(a[i, , 1]) %*% Bbeta)
Y[i] &lt;- aBbeta + stats::rnorm(1, mean = 0, sd = 0.05)
}
# KFPLS
KFPLS_list &lt;- KFPLS(X, Y, obser_time, nfold = 5, n_comp = 5, sigm_list = 0.005, basis)
plot(KFPLS_list$Y_hat, Y)
lines(Y, Y)
</code></pre>

<hr>
<h2 id='predict.KFPLS'>Prediction by KFPLS</h2><span id='topic+predict.KFPLS'></span>

<h3>Description</h3>

<p>Prediction of the scalar response by KFPLS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'KFPLS'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.KFPLS_+3A_object">object</code></td>
<td>
<p>A KFPLS object obtained from <code><a href="#topic+KFPLS">KFPLS</a></code>.</p>
</td></tr>
<tr><td><code id="predict.KFPLS_+3A_newdata">newdata</code></td>
<td>
<p>An <code>array</code> with three indices denoting the new observations of the functional predictors. The (i, j, k)-th element of it corresponds to the measurment of the i-th subject for the k-th functional predictor at j-th observation grid.</p>
</td></tr>
<tr><td><code id="predict.KFPLS_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>vector</code> denoting the prediction of the scalar response.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
