<!DOCTYPE html><html><head><title>Help for package libbib</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {libbib}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#books_serials_etc_sample'><p>Small sample of books, monographs, and serials and their information</p></a></li>
<li><a href='#car'><p>Return first element of vector</p></a></li>
<li><a href='#check_isbn_10_check_digit'><p>Check the check digit of an ISBN 10</p></a></li>
<li><a href='#check_isbn_13_check_digit'><p>Check the check digit of an ISBN 13</p></a></li>
<li><a href='#check_issn_check_digit'><p>Check the check digit of an ISSN</p></a></li>
<li><a href='#convert_to_isbn_13'><p>Convert ISBN 10 to ISBN 13</p></a></li>
<li><a href='#country_code_crosswalk'><p>Country code / country crosswalk</p></a></li>
<li><a href='#cp_lb_attributes'><p>Copy special libbib attributes from one object to another</p></a></li>
<li><a href='#dewey_subject_crosswalk'><p>Dewey Decimal Classification / Subject Description crosswalk</p></a></li>
<li><a href='#dt_add_to_col_names'><p>Add string to all column names in a data.table</p></a></li>
<li><a href='#dt_counts_and_percents'><p>Group by, count, and percent count in a data.table</p></a></li>
<li><a href='#dt_del_cols'><p>Delete columns in a data.table</p></a></li>
<li><a href='#dt_keep_cols'><p>Keep columns in a data.table</p></a></li>
<li><a href='#dt_na_breakdown'><p>Get a breakdown of the NA-status of a column in a data.table</p></a></li>
<li><a href='#dt_percent_not_na'><p>Return the percentage of non-NA instances in a data.table column</p></a></li>
<li><a href='#dt_set_clean_names'><p>Takes a data.table and set to cleaned column names</p></a></li>
<li><a href='#fread_plus_date'><p>Read a file and set a special libbib date attribute</p></a></li>
<li><a href='#fwrite_plus_date'><p>Write a file with a date appended to the file name.</p></a></li>
<li><a href='#get_all_lc_call_subject_letters'><p>Get all subject letters of LC Call Number</p></a></li>
<li><a href='#get_clean_names'><p>Takes a data.frame and returns cleaned column names</p></a></li>
<li><a href='#get_country_from_code'><p>Conversion from country code to country name</p></a></li>
<li><a href='#get_dewey_decimal_subject_class'><p>Conversion from Dewey Decimal call numbers to first-level subject description</p></a></li>
<li><a href='#get_dewey_decimal_subject_division'><p>Conversion from Dewey Decimal call numbers to second-level subject description</p></a></li>
<li><a href='#get_dewey_decimal_subject_section'><p>Conversion from Dewey Decimal call numbers to third-level subject description</p></a></li>
<li><a href='#get_isbn_10_check_digit'><p>Get ISBN 10 check digit</p></a></li>
<li><a href='#get_isbn_13_check_digit'><p>Get ISBN 13 check digit</p></a></li>
<li><a href='#get_issn_check_digit'><p>Get ISSN check digit</p></a></li>
<li><a href='#get_language_from_code'><p>Conversion from language code to language name</p></a></li>
<li><a href='#get_lc_call_first_letter'><p>Get the first letter of LC Call Number</p></a></li>
<li><a href='#get_lc_call_subject_classification'><p>Conversion from Library of Congress Call number to subject</p>
classification</a></li>
<li><a href='#is_valid_isbn_10'><p>Return TRUE if valid ISBN 10</p></a></li>
<li><a href='#is_valid_isbn_13'><p>Return TRUE if valid ISBN 13</p></a></li>
<li><a href='#is_valid_issn'><p>Return TRUE if valid ISSN</p></a></li>
<li><a href='#is_valid_lc_call'><p>Check if LC Call Number is valid</p></a></li>
<li><a href='#language_code_crosswalk'><p>language code / language crosswalk</p></a></li>
<li><a href='#lc_subject_classification'><p>LC Call Subject Code Classification / Classification name crosswalk</p></a></li>
<li><a href='#lc_subject_subclassification'><p>LC Subject Subclassification / Subclassification name crosswalk</p></a></li>
<li><a href='#loc_permalink_from_lccn'><p>Get Library of Congress catalog permalinks from LCCNs</p></a></li>
<li><a href='#marc_008_get_info'><p>Get info from MARC control field 008</p></a></li>
<li><a href='#marc_leader_get_info'><p>Get info from MARC leader</p></a></li>
<li><a href='#normalize_isbn'><p>Attempt to enforce validity and canonical form to an ISBN</p></a></li>
<li><a href='#normalize_isbn_10'><p>Attempt to enforce validity and canonical form to ISBN 10</p></a></li>
<li><a href='#normalize_isbn_13'><p>Attempt to enforce validity and canonical form to ISBN 13</p></a></li>
<li><a href='#normalize_issn'><p>Attempt to enforce validity and canonical form to ISSN</p></a></li>
<li><a href='#normalize_lccn'><p>Attempt to enforce validity of LCCN and convert to normalized form</p></a></li>
<li><a href='#oclc_classify_link_from_standard_num'><p>Get OCLC Classify link from a standard number</p></a></li>
<li><a href='#recombine_with_sep_closure'><p>Return a function that will combine/contatenate a vector</p></a></li>
<li><a href='#remove_duplicates_and_nas'><p>Remove duplicate elements and NAs from a vector</p></a></li>
<li><a href='#set_lb_attribute'><p>Set special libbib attribute on object</p></a></li>
<li><a href='#set_lb_date'><p>Set special libbib date attribute on object</p></a></li>
<li><a href='#split_map_filter_reduce'><p>Split, Map, Filter, and Reduce a string vector</p></a></li>
<li><a href='#worldcat_api_bib_read_info_by'><p>Get bibliographic info from a standard number</p></a></li>
<li><a href='#worldcat_api_classify_by'><p>Search WorldCat classify API by ISBN, ISSN, or OCLC number</p></a></li>
<li><a href='#worldcat_api_locations_by'><p>Get holding libraries by standard number</p></a></li>
<li><a href='#worldcat_api_search'><p>Use the WorldCat Search API</p></a></li>
<li><a href='#worldcat_permalink_from_isbn'><p>Get WorldCat catalog permalinks from ISBNs</p></a></li>
<li><a href='#worldcat_permalink_from_issn'><p>Get WorldCat catalog permalinks from ISSNs</p></a></li>
<li><a href='#worldcat_permalink_from_oclc_number'><p>Get WorldCat catalog permalinks from OCLC numbers</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Various Utilities for Library Science/Assessment and Cataloging</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tony Fischetti &lt;tony.fischetti@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for validating and normalizing bibliographic
   codes such as ISBN, ISSN, and LCCN. Also includes functions to communicate
   with the WorldCat API, translate Call numbers (Library of Congress and
   Dewey Decimal) to their subject classifications or subclassifications,
   and provides various loadable data files such call number / subject
   crosswalks and code tables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), data.table, utils</td>
</tr>
<tr>
<td>Imports:</td>
<td>curl, methods, pbapply, stringr, xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>assertr, testthat, knitr, magrittr, rmarkdown</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-05 22:36:00 UTC; tony</td>
</tr>
<tr>
<td>Author:</td>
<td>Tony Fischetti [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-05 22:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='books_serials_etc_sample'>Small sample of books, monographs, and serials and their information</h2><span id='topic+books_serials_etc_sample'></span>

<h3>Description</h3>

<p>A very small sample of books, serials, VHSs, CDs, and Computer files
and some information including title, control numbers, call numbers, and
call number subject classifications. Somewhat messy/inconsistent
(deliberately) and mainly for testing.
Will be expanded in future versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(books_serials_etc_sample)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.table"</code>;
</p>

<hr>
<h2 id='car'>Return first element of vector</h2><span id='topic+car'></span>

<h3>Description</h3>

<p>Takes a vector and returns the first element
Equivalent to Lisp's <code>car</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>car(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="car_+3A_x">x</code></td>
<td>
<p>A vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Originally for use as a reduction function in <code>split_map_filter_reduce</code>
</p>


<h3>Value</h3>

<p>Returns first element of vector
</p>


<h3>See Also</h3>

<p><code><a href="#topic+split_map_filter_reduce">split_map_filter_reduce</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>car(c(8, 6, 7, 5, 3, 0, 9))      # 8
mt &lt;- as.data.table(mtcars)
dt_del_cols(mt, "cyl", "disp", "hp")

</code></pre>

<hr>
<h2 id='check_isbn_10_check_digit'>Check the check digit of an ISBN 10</h2><span id='topic+check_isbn_10_check_digit'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 10 and verifies that check digit
checks out
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_isbn_10_check_digit(x, allow.hyphens = TRUE, errors.as.false = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_isbn_10_check_digit_+3A_x">x</code></td>
<td>
<p>A string of 10 digits or 9 digits with terminal &quot;X&quot;</p>
</td></tr>
<tr><td><code id="check_isbn_10_check_digit_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="check_isbn_10_check_digit_+3A_errors.as.false">errors.as.false</code></td>
<td>
<p>return false if error instead of throwing error
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE if check passes, FALSE if not, and NA if NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
check_isbn_10_check_digit("012491540X")      # TRUE
check_isbn_10_check_digit("0-124-91540-X")   # TRUE

# vectorized
check_isbn_10_check_digit(c("012491540X", "9004037812"))  # TRUE FALSE

</code></pre>

<hr>
<h2 id='check_isbn_13_check_digit'>Check the check digit of an ISBN 13</h2><span id='topic+check_isbn_13_check_digit'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 13 and verifies that check digit
checks out
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_isbn_13_check_digit(x, allow.hyphens = TRUE, errors.as.false = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_isbn_13_check_digit_+3A_x">x</code></td>
<td>
<p>A string of 13 digits</p>
</td></tr>
<tr><td><code id="check_isbn_13_check_digit_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="check_isbn_13_check_digit_+3A_errors.as.false">errors.as.false</code></td>
<td>
<p>return false if error instead of throwing error
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE if check passes, FALSE if not, and NA if NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
check_isbn_13_check_digit("9780306406157")          # TRUE
check_isbn_13_check_digit("978-0-306-40615-7")      # TRUE

# vectorized
check_isbn_13_check_digit(c("978-0-306-40615-7", "9783161484103"))  # TRUE FALSE

</code></pre>

<hr>
<h2 id='check_issn_check_digit'>Check the check digit of an ISSN</h2><span id='topic+check_issn_check_digit'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISSN and verifies that check digit
checks out
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_issn_check_digit(x, allow.hyphens = TRUE, errors.as.false = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_issn_check_digit_+3A_x">x</code></td>
<td>
<p>A string of 8 digits or 7 digits with terminal &quot;X&quot;</p>
</td></tr>
<tr><td><code id="check_issn_check_digit_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="check_issn_check_digit_+3A_errors.as.false">errors.as.false</code></td>
<td>
<p>return false if error instead of throwing error
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE if check passes, FALSE if not, and NA if NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
check_issn_check_digit("2434561X")   # TRUE
check_issn_check_digit("2434-561X")  # TRUE

# vectorized
check_issn_check_digit(c("03785955", "2434561X", NA))  # TRUE TRUE NA
check_issn_check_digit(c("0378-5955", "2434-561X", NA))
# TRUE TRUE NA

</code></pre>

<hr>
<h2 id='convert_to_isbn_13'>Convert ISBN 10 to ISBN 13</h2><span id='topic+convert_to_isbn_13'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 10 and converts it to an ISBN 13.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_to_isbn_13(x, skip.validity.check = FALSE, errors.as.nas = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_to_isbn_13_+3A_x">x</code></td>
<td>
<p>A string of 10 digits or 9 digits with terminal &quot;X&quot;</p>
</td></tr>
<tr><td><code id="convert_to_isbn_13_+3A_skip.validity.check">skip.validity.check</code></td>
<td>
<p>Skip the checking for whether the ISBN 10 is valid
(default is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="convert_to_isbn_13_+3A_errors.as.nas">errors.as.nas</code></td>
<td>
<p>return NA if error instead of throwing error
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns ISBN 13 as a string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
convert_to_isbn_13("012491540X")                # 9780124915404

# vectorized
convert_to_isbn_13(c("012491540X", "9004037810"))
# "9780124915404" "9789004037816"

</code></pre>

<hr>
<h2 id='country_code_crosswalk'>Country code / country crosswalk</h2><span id='topic+country_code_crosswalk'></span>

<h3>Description</h3>

<p>A cross-walk between the country code
and it's human readable version
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(country_code_crosswalk)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.table"</code>;
</p>


<h3>Source</h3>

<p><a href="https://www.loc.gov/marc/countries/countries_code.html">https://www.loc.gov/marc/countries/countries_code.html</a>
</p>

<hr>
<h2 id='cp_lb_attributes'>Copy special libbib attributes from one object to another</h2><span id='topic+cp_lb_attributes'></span>

<h3>Description</h3>

<p>Takes two objects and copies all special libbib attributes
(attributes beginning with <code>lb.</code>) from the first object
to the second, by reference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cp_lb_attributes(a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cp_lb_attributes_+3A_a">a</code></td>
<td>
<p>The first object (the one with the attributes to copy)</p>
</td></tr>
<tr><td><code id="cp_lb_attributes_+3A_b">b</code></td>
<td>
<p>The second object (the one to copy those attributes to)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, since the object is modified by reference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tmp1 &lt;- "a"
set_lb_date(tmp1, "2021-05-08")
set_lb_attribute(tmp1, "note", "just an example")

tmp2 &lt;- "b"
cp_lb_attributes(tmp1, tmp2)
attributes(tmp2)$lb.date
# [1] "2021-05-08"
attributes(tmp2)$lb.note
# [1] "just an example"

</code></pre>

<hr>
<h2 id='dewey_subject_crosswalk'>Dewey Decimal Classification / Subject Description crosswalk</h2><span id='topic+dewey_subject_crosswalk'></span>

<h3>Description</h3>

<p>A cross-walk between the Dewey Decimal Classification code
and it's human readable subject description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dewey_subject_crosswalk)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.table"</code>;
</p>


<h3>Source</h3>

<p>Edited from <a href="https://www.oclc.org/content/dam/oclc/dewey/ddc23-summaries.pdf">https://www.oclc.org/content/dam/oclc/dewey/ddc23-summaries.pdf</a>
</p>

<hr>
<h2 id='dt_add_to_col_names'>Add string to all column names in a data.table</h2><span id='topic+dt_add_to_col_names'></span>

<h3>Description</h3>

<p>Takes a data.table and a string. The supplied string will
be added to end of the each column's name. If <code>prefix</code>
is <code>TRUE</code>, the string is added to the beginning, instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_add_to_col_names(
  DT,
  astring,
  prefix = FALSE,
  exclude = NULL,
  include = NULL,
  fix.duplicates = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_add_to_col_names_+3A_dt">DT</code></td>
<td>
<p>A data.table</p>
</td></tr>
<tr><td><code id="dt_add_to_col_names_+3A_astring">astring</code></td>
<td>
<p>A string to add to each column name</p>
</td></tr>
<tr><td><code id="dt_add_to_col_names_+3A_prefix">prefix</code></td>
<td>
<p>A logical indicating whether the string should be added
to the beginning of each column name, instead of the end.
(default is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="dt_add_to_col_names_+3A_exclude">exclude</code></td>
<td>
<p>A quoted vector or column names to exclude from renaming.
Cannot co-exist with <code>include</code></p>
</td></tr>
<tr><td><code id="dt_add_to_col_names_+3A_include">include</code></td>
<td>
<p>A quoted vector or column names. Changes names of only
these columns. Cannot co-exist with <code>exclude</code></p>
</td></tr>
<tr><td><code id="dt_add_to_col_names_+3A_fix.duplicates">fix.duplicates</code></td>
<td>
<p>A logical indicating whether to, if after the
suffix/prefixes are added to the selected column
names, correct those duplicate column names by
making them unique. If <code>FALSE</code> (default),
if any of the column names are duplicated, an
error is raised and the new names are not set.
If <code>TRUE</code>, all the column names are made unique,
potentially renaming excluded column names that
were not supposed to be changed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns data.table with string appended or prefixed to all selected
column names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DT &lt;- as.data.table(iris)

dt_add_to_col_names(DT, "_post")
names(DT)
# [1] "Sepal.Length_post" "Sepal.Width_post"  "Petal.Length_post"
# [4] "Petal.Width_post"  "Species_post"

 DT &lt;- as.data.table(iris)
dt_add_to_col_names(DT, "pre_", prefix=TRUE)
names(DT)
# [1] "pre_Sepal.Length" "pre_Sepal.Width"  "pre_Petal.Length" "pre_Petal.Width"
# [5] "pre_Species"

DT &lt;- as.data.table(iris)
dt_add_to_col_names(DT, "_post", exclude="Species")
names(DT)
# [1] "Sepal.Length_post" "Sepal.Width_post"  "Petal.Length_post"
# [4] "Petal.Width_post"  "Species"

</code></pre>

<hr>
<h2 id='dt_counts_and_percents'>Group by, count, and percent count in a data.table</h2><span id='topic+dt_counts_and_percents'></span>

<h3>Description</h3>

<p>This function takes a (quoted) column to group by, counts the
number of occurrences, sorts descending, and adds the percent
of occurrences for each level of the grouped-by column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_counts_and_percents(DT, group_by_this, percent.cutoff = 0, big.mark = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_counts_and_percents_+3A_dt">DT</code></td>
<td>
<p>The data.table object to operate on</p>
</td></tr>
<tr><td><code id="dt_counts_and_percents_+3A_group_by_this">group_by_this</code></td>
<td>
<p>A quoted column to group by</p>
</td></tr>
<tr><td><code id="dt_counts_and_percents_+3A_percent.cutoff">percent.cutoff</code></td>
<td>
<p>A percent (out of 100) such that all
the count percents lower than this number will be
grouped into &quot;OTHER&quot; in the returned data.table
(default is 0)</p>
</td></tr>
<tr><td><code id="dt_counts_and_percents_+3A_big.mark">big.mark</code></td>
<td>
<p>If <code>FALSE</code> (default) the &quot;count&quot; column is left
as an integer. If not <code>FALSE</code>, it must be a
character to separate every three digits of the count.
This turns the count column into a string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For long-tailed count distributions, a cutoff on the percent can be
placed; percent of counts lower than this percent will be grouped
into a category called &quot;OTHER&quot;.
The percent is a number out of 100
</p>
<p>The final row is a total count.
</p>
<p>The quoted group-by variable must be a character or factor. If it is
not, it will be temporarily converted into one and a warning is issued.
</p>


<h3>Value</h3>

<p>Returns a data.table with three columns:
the grouped-by column, a count column, and a
percent column (out of 100) to two decimal places
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
iris_dt &lt;- as.data.table(iris)
dt_counts_and_percents(iris_dt, "Species")
mt &lt;- as.data.table(mtcars)
mt[, cyl:=factor(cyl)]
dt_counts_and_percents(mt, "cyl")
dt_counts_and_percents(mt, "cyl", percent.cutoff=25)

</code></pre>

<hr>
<h2 id='dt_del_cols'>Delete columns in a data.table</h2><span id='topic+dt_del_cols'></span>

<h3>Description</h3>

<p>Takes a data.table and a quoted sequence of column names
and removes the specified column names from the data.table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_del_cols(DT, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_del_cols_+3A_dt">DT</code></td>
<td>
<p>A data.table</p>
</td></tr>
<tr><td><code id="dt_del_cols_+3A_...">...</code></td>
<td>
<p>arbitrary number of column names in quotes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns data.table with those columns removed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mt &lt;- as.data.table(mtcars)
dt_del_cols(mt, "cyl", "disp", "hp")

</code></pre>

<hr>
<h2 id='dt_keep_cols'>Keep columns in a data.table</h2><span id='topic+dt_keep_cols'></span>

<h3>Description</h3>

<p>Takes a data.table and a quoted sequence of column names
and removes all columns but the ones specified
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_keep_cols(DT, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_keep_cols_+3A_dt">DT</code></td>
<td>
<p>A data.table</p>
</td></tr>
<tr><td><code id="dt_keep_cols_+3A_...">...</code></td>
<td>
<p>arbitrary number of column names in quotes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns data.table with only those columns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mt &lt;- as.data.table(mtcars)
dt_keep_cols(mt, "mpg", "am", "gear", "carb")

</code></pre>

<hr>
<h2 id='dt_na_breakdown'>Get a breakdown of the NA-status of a column in a data.table</h2><span id='topic+dt_na_breakdown'></span>

<h3>Description</h3>

<p>This function takes a (quoted) column to group by, and tabulates
the count of how many of those values are not-NA and NA, and adds
the percent of occurrences. A <code>TRUE</code> in the first output
column means the data is _not_ missing; <code>FALSE</code> corresponds
to missing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_na_breakdown(DT, acolumn, big.mark = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_na_breakdown_+3A_dt">DT</code></td>
<td>
<p>The data.table object to operate on</p>
</td></tr>
<tr><td><code id="dt_na_breakdown_+3A_acolumn">acolumn</code></td>
<td>
<p>a quoted column name</p>
</td></tr>
<tr><td><code id="dt_na_breakdown_+3A_big.mark">big.mark</code></td>
<td>
<p>If <code>FALSE</code> (default) the &quot;count&quot; column is left
as an integer. If not <code>FALSE</code>, it must be a
character to separate every three digits of the count.
This turns the count column into a string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The final row is a total count
</p>
<p>The quoted group-by variable must be a character or factor
</p>


<h3>Value</h3>

<p>Returns a data.table with three columns:
the not-NA status of the column specified, a count column, and a
percent column (out of 100) to two decimal places
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
iris_dt &lt;- as.data.table(iris)
iris_dt[sample(1:.N, 10), Species:=NA_character_]
dt_na_breakdown(iris_dt, "Species")

</code></pre>

<hr>
<h2 id='dt_percent_not_na'>Return the percentage of non-NA instances in a data.table column</h2><span id='topic+dt_percent_not_na'></span>

<h3>Description</h3>

<p>This function takes a data.table and a quoted column name and
returns the percentage of the data in the column that is not
NA.
The percent is out of 100 and contains up to two decimal places
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_percent_not_na(DT, acolumn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_percent_not_na_+3A_dt">DT</code></td>
<td>
<p>A data.table object</p>
</td></tr>
<tr><td><code id="dt_percent_not_na_+3A_acolumn">acolumn</code></td>
<td>
<p>a quoted column name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns percentage of non-NA instances in column
</p>


<h3>See Also</h3>

<p><code><a href="Matrix.html#topic+is.na">is.na</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mt &lt;- as.data.table(mtcars)
mt[mpg&lt;16, mpg:=NA]
dt_percent_not_na(mt, "mpg")         # 68.75

</code></pre>

<hr>
<h2 id='dt_set_clean_names'>Takes a data.table and set to cleaned column names</h2><span id='topic+dt_set_clean_names'></span>

<h3>Description</h3>

<p>This function takes a data.table, and returns the same data.table
with column names that are cleaned and stripped of potentially
troublesome names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_set_clean_names(DT, lower = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dt_set_clean_names_+3A_dt">DT</code></td>
<td>
<p>a data.table</p>
</td></tr>
<tr><td><code id="dt_set_clean_names_+3A_lower">lower</code></td>
<td>
<p>A logical indicating whether all column names should be
made lower case (default <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All space/whitespace characters are replaced with underscores,
as are all characters not from A-Z, a-z, an underscore, or a digit
</p>


<h3>Value</h3>

<p>Returns the data.table but with cleaned names
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_clean_names">get_clean_names</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ejemplo &lt;- as.data.table(iris)
setnames(ejemplo, c("Sepal Length", "Sepal@Width", "Petal	Length",
                    "Petal\\nWidth", "Spêcies"))
dt_set_clean_names(ejemplo)

</code></pre>

<hr>
<h2 id='fread_plus_date'>Read a file and set a special libbib date attribute</h2><span id='topic+fread_plus_date'></span>

<h3>Description</h3>

<p>Takes a file name, reads it with <code>data.table::fread</code>, and
sets an attribute called <code>lb.date</code> with a date extracted
from the file name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fread_plus_date(fname, allow.fallback.date = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fread_plus_date_+3A_fname">fname</code></td>
<td>
<p>The file name to read</p>
</td></tr>
<tr><td><code id="fread_plus_date_+3A_allow.fallback.date">allow.fallback.date</code></td>
<td>
<p>A logical indicating whether, if no
matching file name with a date is found,
to use today's date as the date attribute.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="fread_plus_date_+3A_...">...</code></td>
<td>
<p>Arbitrary arguments to use with <code>fread</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The file name can be one with a valid ISO 8601 date (yyyy-mm-dd)
already in it, or it can be a file name with the date elided.
</p>
<p>For example, if there is a file you'd like to read on your disk
called &quot;iris-2021-05-08.csv&quot;, you can call this function with
either &quot;iris.csv&quot; or &quot;iris-2021-05-08.csv&quot; as the file name.
</p>
<p>When you call this function with a file name without an ISO 8601
date (e.g. &quot;iris.csv.gz&quot;),  the file name extension &quot;.csv.gz&quot; is
removed and the function looks for a file name beginning with
&quot;iris&quot;, a date, and the file extension. The file extension is
considered to be anything after the first period in the base name.
For example, if the file name given is &quot;./my.data/iris.csv.gz&quot;, the
extension is &quot;.csv.gz&quot;. This means no period can be present in
the base file name (after any directories) with the exception of
the file extension.
</p>
<p>If you call this function with &quot;iris.csv&quot; and there is no file name
with an ISO 8601 date appended to that file name on your disk, and
<code>allow.fallback.date</code> is <code>TRUE</code>, then the <code>lb.date</code>
attribute is set to the current date.
</p>


<h3>Value</h3>

<p>A <code>data.table</code> with an attribute called <code>lb.date</code> set
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  # there's a file called "iris-2021-05-08.csv" on disk
  dat &lt;- fread_plus_date("iris.csv")
  attribute(dat)$lb.date
  # [1] "2021-05-08

  # can also read the full file name
  dat &lt;- fread_plus_date("iris-2021-05-08.csv")
  attribute(dat)$lb.date
  # [1] "2021-05-08

## End(Not run)

</code></pre>

<hr>
<h2 id='fwrite_plus_date'>Write a file with a date appended to the file name.</h2><span id='topic+fwrite_plus_date'></span>

<h3>Description</h3>

<p>Takes a <code>data.table</code>, a file name, and writes it with
<code>data.table::fwrite</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fwrite_plus_date(
  DT,
  fname,
  from.attribute = TRUE,
  allow.fallback.date = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fwrite_plus_date_+3A_dt">DT</code></td>
<td>
<p>a <code>data.table</code> to write to disk</p>
</td></tr>
<tr><td><code id="fwrite_plus_date_+3A_fname">fname</code></td>
<td>
<p>The file name to write the <code>data.table</code> to. The
date will be appended between the file name and its
file extension</p>
</td></tr>
<tr><td><code id="fwrite_plus_date_+3A_from.attribute">from.attribute</code></td>
<td>
<p>A logical indicating whether the date should
be taken from the <code>lb.date</code> attribute of
the <code>data.table</code>, or whether it should be
today's date. Default (<code>TRUE</code>) takes it
from the <code>lb.date</code> attribute.</p>
</td></tr>
<tr><td><code id="fwrite_plus_date_+3A_allow.fallback.date">allow.fallback.date</code></td>
<td>
<p>A logical indicating, if there is no
<code>lb.date</code> attribute in the supplied
<code>data.table</code>, whether it is permissible
to use today's date, instead.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="fwrite_plus_date_+3A_...">...</code></td>
<td>
<p>Arbitrary arguments to pass to <code>fwrite</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The supplied file name will be modified to include an ISO 8601 date
(yyyy-mm-dd) between the file name and the file extension. Under the
default settings, the date used will be from the <code>lb.date</code>
attribute of the supplied <code>data.table</code>. If there is no <code>lb.date</code>
attribute, the current date will be used, instead.
</p>
<p>For example, if there is a <code>data.table</code> with an <code>lb.date</code>
attribute of &quot;2021-05-08&quot;, and you supply this function with the file
name &quot;iris.csv&quot;, the file name actually written to disk will be
&quot;iris-2021-05-08.csv&quot;. Under the default settings, if there is no
<code>lb.date</code> attribute, but today's date is &quot;2038-01-19&quot;, the file
name written to disk will be &quot;iris-2038-01-19.csv&quot;.
</p>
<p>The ISO 8601 date is sandwiched between the file name and the file
extension. The file extension is considered to be anything after the
first period in the base name.
For example, if the file name given is &quot;./my.data/iris.csv.gz&quot;, the
extension is &quot;.csv.gz&quot;. This means no period can be present in
the base file name (after any directories) with the exception of
the file extension.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

set_lb_date(iris, "2021-05-08")
fwrite_plus_date(iris, "iris.csv.gz")
# "iris-2021-05-08.csv.gz" is now written to disk


## End(Not run)

</code></pre>

<hr>
<h2 id='get_all_lc_call_subject_letters'>Get all subject letters of LC Call Number</h2><span id='topic+get_all_lc_call_subject_letters'></span>

<h3>Description</h3>

<p>Takes a string representation of a Library of Congress
call number and returns all the subject letters if and only if
the LC Call Number is valid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_all_lc_call_subject_letters(x, allow.bare = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_all_lc_call_subject_letters_+3A_x">x</code></td>
<td>
<p>A Library of Congress call number (string)</p>
</td></tr>
<tr><td><code id="get_all_lc_call_subject_letters_+3A_allow.bare">allow.bare</code></td>
<td>
<p>A logical indicating whether an LC Call with only
the letters should be considered valid
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns all the subject letters or NA if invalid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_all_lc_call_subject_letters("Q172.5.E77")
# Q
get_all_lc_call_subject_letters("AF172.5.E77")
# NA

# vectorized
get_all_lc_call_subject_letters(c("Q 172.5", "AF172", "PR6023.A93"))
# Q NA PR

</code></pre>

<hr>
<h2 id='get_clean_names'>Takes a data.frame and returns cleaned column names</h2><span id='topic+get_clean_names'></span>

<h3>Description</h3>

<p>This function takes a data.frame, extracts the column names,
and returns a vector of those column names but cleaned and
stripped of potentially troublesome names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_clean_names(dat, lower = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_clean_names_+3A_dat">dat</code></td>
<td>
<p>A data.frame</p>
</td></tr>
<tr><td><code id="get_clean_names_+3A_lower">lower</code></td>
<td>
<p>A logical indicating whether all column names should be
made lower case (default <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All space/whitespace characters are replaced with underscores,
as are all characters not from A-Z, a-z, an underscore, or a digit
</p>
<p>If there are duplicate column names after the cleaning, a message
will show stating such and the duplicate column names will be
make unique.
</p>


<h3>Value</h3>

<p>Returns a vector of cleaned names
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+make.unique">make.unique</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ejemplo &lt;- iris
names(ejemplo) &lt;- c("Sepal Length", "Sepal@Width", "Petal	Length",
                    "Petal\\nWidth", "Spêcies")
# c("sepal_length" "sepal_width"  "petallength"  "petal_nwidth" "sp_cies")

# c("Sepal_Length" "Sepal_Width"  "PetalLength"  "Petal_nWidth" "Sp_cies")

</code></pre>

<hr>
<h2 id='get_country_from_code'>Conversion from country code to country name</h2><span id='topic+get_country_from_code'></span>

<h3>Description</h3>

<p>Takes a country code (defined in the Marc standards)
and returns the country name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_country_from_code(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_country_from_code_+3A_x">x</code></td>
<td>
<p>A country code (defined in the Marc standards) or a vector
of country codes</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interestingly, although it's called 'country' in the Marc standard,
cities, states, and other non-countries also have codes
</p>


<h3>Value</h3>

<p>Returns the country (place) name. NA if cannot be matched
to country in standard.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_country_from_code("ck")
# Colombia

# tolerant of case and leading/trailing whitespace
get_country_from_code(c(" PE", "not-a-country", "nyu"))
# c("Peru", NA, "New York (State)")

</code></pre>

<hr>
<h2 id='get_dewey_decimal_subject_class'>Conversion from Dewey Decimal call numbers to first-level subject description</h2><span id='topic+get_dewey_decimal_subject_class'></span>

<h3>Description</h3>

<p>Takes a string representation of a Dewey Decimal
call number (DDC) and returns it's subject description.
This uses the hundreds place of the DDC number
and returns the most general subject classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dewey_decimal_subject_class(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dewey_decimal_subject_class_+3A_x">x</code></td>
<td>
<p>A Dewey Decimal call number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the most general subject classification using the
hundreds places from the DDC. Returns NA if the DDC looks
invalid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_dewey_decimal_subject_class("709.05")     # Arts

get_dewey_decimal_subject_class("823.912")
# Literature (Belles-lettres) and rhetoric

# vectorized
get_dewey_decimal_subject_class(c("709.05", "invalid", NA, "823.912"))
# c("Arts", NA, NA, "Literature (Belles-lettres) and rhetoric")

</code></pre>

<hr>
<h2 id='get_dewey_decimal_subject_division'>Conversion from Dewey Decimal call numbers to second-level subject description</h2><span id='topic+get_dewey_decimal_subject_division'></span>

<h3>Description</h3>

<p>Takes a string representation of a Dewey Decimal
call number (DDC) and returns it's subject description.
This uses the first two digits of the DDC number
and returns the second most general subject classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dewey_decimal_subject_division(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dewey_decimal_subject_division_+3A_x">x</code></td>
<td>
<p>A Dewey Decimal call number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the most general subject classification using the
first two digits from the DDC. Returns NA if the DDC looks
invalid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_dewey_decimal_subject_division("709.05")     # Arts

get_dewey_decimal_subject_division("823.912")
# "English and Old English literatures"

# vectorized
get_dewey_decimal_subject_division(c("709.05", "invalid", NA, "823.912"))
# c("Arts", NA, NA, "English and Old English literatures")

</code></pre>

<hr>
<h2 id='get_dewey_decimal_subject_section'>Conversion from Dewey Decimal call numbers to third-level subject description</h2><span id='topic+get_dewey_decimal_subject_section'></span>

<h3>Description</h3>

<p>Takes a string representation of a Dewey Decimal
call number (DDC) and returns it's subject description.
This uses the first three digits of the DDC number
and returns the third most general subject classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dewey_decimal_subject_section(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dewey_decimal_subject_section_+3A_x">x</code></td>
<td>
<p>A Dewey Decimal call number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the most general subject sectionification using the
first three digits from the DDC. Returns NA if the DDC looks
invalid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_dewey_decimal_subject_section("709.05")
# "History, geographic treatment, biography"

get_dewey_decimal_subject_section("823.912")
# "English fiction"

# vectorized
get_dewey_decimal_subject_section(c("709.05", "invalid", NA, "823.912"))
# c("History, geographic treatment, biography", NA, NA,
#   "English fiction")

</code></pre>

<hr>
<h2 id='get_isbn_10_check_digit'>Get ISBN 10 check digit</h2><span id='topic+get_isbn_10_check_digit'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 10
and returns the check digit that satisfies the necessary condition.
It can take a 10 digit string (and ignore the already extant check digit)
or a 9 digit string (without the last digit)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_isbn_10_check_digit(x, allow.hyphens = FALSE, errors.as.nas = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_isbn_10_check_digit_+3A_x">x</code></td>
<td>
<p>A string of 9 or 10 digits</p>
</td></tr>
<tr><td><code id="get_isbn_10_check_digit_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="get_isbn_10_check_digit_+3A_errors.as.nas">errors.as.nas</code></td>
<td>
<p>return NA if error instead of throwing error
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the character check digit that satifies the
mod 11 condition. Returns &quot;X&quot; if 10. Returns NA if input is NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_isbn_10_check_digit("012491540X")
get_isbn_10_check_digit("0-124-91540-X", allow.hyphens=TRUE)

# nine digit string
get_isbn_10_check_digit("900403781")

get_isbn_10_check_digit("onetwothre", errors.as.nas=TRUE)  # NA

# vectorized
get_isbn_10_check_digit(c("012491540X", "9004037810", "900403781"))

</code></pre>

<hr>
<h2 id='get_isbn_13_check_digit'>Get ISBN 13 check digit</h2><span id='topic+get_isbn_13_check_digit'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 13
and returns the check digit that satisfies the necessary condition.
It can take a 13 digit string (and ignore the already extant check digit)
or a 12 digit string (without the last digit)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_isbn_13_check_digit(x, allow.hyphens = FALSE, errors.as.nas = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_isbn_13_check_digit_+3A_x">x</code></td>
<td>
<p>A string of 12 or 13 digits</p>
</td></tr>
<tr><td><code id="get_isbn_13_check_digit_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="get_isbn_13_check_digit_+3A_errors.as.nas">errors.as.nas</code></td>
<td>
<p>return NA if error instead of throwing error
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the character check digit that satifies the
mod 10 condition. Returns NA if input is NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_isbn_13_check_digit("9780306406157")

# 12 digit string
get_isbn_13_check_digit("978030640615")

get_isbn_13_check_digit("onetwothreefo", errors.as.nas=TRUE)  # NA

# vectorized
get_isbn_13_check_digit(c("9780306406157", "9783161484100"))

</code></pre>

<hr>
<h2 id='get_issn_check_digit'>Get ISSN check digit</h2><span id='topic+get_issn_check_digit'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISSN
and returns the check digit that satisfies the necessary condition.
It can take a 8 digit string (and ignore the already extant check digit)
or a 7 digit string (without the last digit)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_issn_check_digit(x, allow.hyphens = FALSE, errors.as.nas = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_issn_check_digit_+3A_x">x</code></td>
<td>
<p>A string of 7 or 8 digits</p>
</td></tr>
<tr><td><code id="get_issn_check_digit_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="get_issn_check_digit_+3A_errors.as.nas">errors.as.nas</code></td>
<td>
<p>return NA if error instead of throwing error
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the character check digit that satifies the
mod 11 condition. Returns &quot;X&quot; if 10. Returns NA if input is NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_issn_check_digit("03785955")

get_issn_check_digit("2434-561X", allow.hyphens=TRUE)

# nine digit string
get_issn_check_digit("0378595")

# vectorized
get_issn_check_digit(c("0378595", "2434561X", NA))

</code></pre>

<hr>
<h2 id='get_language_from_code'>Conversion from language code to language name</h2><span id='topic+get_language_from_code'></span>

<h3>Description</h3>

<p>Takes a language code (defined in the Marc standards)
and returns the language name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_language_from_code(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_language_from_code_+3A_x">x</code></td>
<td>
<p>A language code (defined in the Marc standards) or a vector
of language codes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the language name. NA if cannot be matched
to language in standard.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_language_from_code("yor")
# Yoruba

# tolerant of case and leading/trailing whitespace
get_language_from_code(c("yor", " SPA ", "not-a-language", "nah", NA))
# c("Yoruba", "Spanish", NA, "Nahuatl", NA)

</code></pre>

<hr>
<h2 id='get_lc_call_first_letter'>Get the first letter of LC Call Number</h2><span id='topic+get_lc_call_first_letter'></span>

<h3>Description</h3>

<p>Takes a string representation of a Library of Congress
call number and returns the first letter if and only if
the LC Call Number is valid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_lc_call_first_letter(x, allow.bare = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_lc_call_first_letter_+3A_x">x</code></td>
<td>
<p>A Library of Congress call number (string)</p>
</td></tr>
<tr><td><code id="get_lc_call_first_letter_+3A_allow.bare">allow.bare</code></td>
<td>
<p>A logical indicating whether an LC Call with only
the letters should be considered valid
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns first letter or NA if invalid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_lc_call_first_letter("Q172.5.E77")
# Q
get_lc_call_first_letter("AF172.5.E77")
# NA

# vectorized
get_lc_call_first_letter(c("Q 172.5", "AF172", "PR6023.A93"))
# Q NA P

</code></pre>

<hr>
<h2 id='get_lc_call_subject_classification'>Conversion from Library of Congress Call number to subject
classification</h2><span id='topic+get_lc_call_subject_classification'></span>

<h3>Description</h3>

<p>Takes a string representation of a Library of Congress
call number and returns either the broad subject
classification description (default) based on the first
letter, or a second-level subclassification
description based on the all the letters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_lc_call_subject_classification(
  x,
  subclassification = FALSE,
  already.parsed = FALSE,
  allow.bare = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_lc_call_subject_classification_+3A_x">x</code></td>
<td>
<p>A Library of Congress call number (string)</p>
</td></tr>
<tr><td><code id="get_lc_call_subject_classification_+3A_subclassification">subclassification</code></td>
<td>
<p>A logical indicating whether the letters of
call number past the first should be used to match to
a subject subclassification (default is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="get_lc_call_subject_classification_+3A_already.parsed">already.parsed</code></td>
<td>
<p>Skips the extraction of the subject letters
and jumps to the subject matching (default is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="get_lc_call_subject_classification_+3A_allow.bare">allow.bare</code></td>
<td>
<p>A logical indicating whether an LC Call with only
the letters should be considered valid
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns either the broad (top-level) subject classification
description or the second level subject subclassification
description. Returns &quot;NA&quot; if no subject could not be matched
or call number is invalid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_lc_call_subject_classification("ND 237.S18 $b S87 1997")
# Fine Arts

get_lc_call_subject_classification("ND 237.S18 $b S87 1997", subclassification=TRUE)
# Painting

get_lc_call_subject_classification("PQ2246.M3")
# Language and Literature

get_lc_call_subject_classification("PQ2246.M3",
                                   subclassification=TRUE)
# "French, Italian, Spanish, and Portuguese literature"

get_lc_call_subject_classification("PQ2246.M3", already.parsed=TRUE)
# NA

get_lc_call_subject_classification("PQ", already.parsed=TRUE,
                                   subclassification=TRUE)
# "French, Italian, Spanish, and Portuguese literature"

# vectorized
get_lc_call_subject_classification(c("ND 237", "\\\\$a ND 2", "PQ2246.M3"),
                                   subclassification=TRUE)
# c("Painting", NA, "French, Italian, Spanish, and Portuguese literature")


</code></pre>

<hr>
<h2 id='is_valid_isbn_10'>Return TRUE if valid ISBN 10</h2><span id='topic+is_valid_isbn_10'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 10 verifies that it is valid.
An ISBN 10 is valid if it is a 10 digit string or a 9 digit string
with a terminal &quot;X&quot; AND the check digit matches
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_valid_isbn_10(x, allow.hyphens = TRUE, lower.x.allowed = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_valid_isbn_10_+3A_x">x</code></td>
<td>
<p>A string of 10 digits or 9 digits with terminal &quot;X&quot;</p>
</td></tr>
<tr><td><code id="is_valid_isbn_10_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="is_valid_isbn_10_+3A_lower.x.allowed">lower.x.allowed</code></td>
<td>
<p>A logical indicating whether ISBN 10s with
a check digit with a lower-case &quot;x&quot; should
be treated as valid
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE if checks pass, FALSE if not, and NA if NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
is_valid_isbn_10("012491540X")    # TRUE
is_valid_isbn_10("0-124-91540-X") # TRUE

# vectorized
is_valid_isbn_10(c("012491540X", "9004037812"))      # TRUE FALSE
is_valid_isbn_10(c("012491540X", "hubo un tiempo"))  # TRUE FALSE

</code></pre>

<hr>
<h2 id='is_valid_isbn_13'>Return TRUE if valid ISBN 13</h2><span id='topic+is_valid_isbn_13'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 13 verifies that it is valid.
An ISBN 13 is valid if it is a 13 digit string and the check digit matches
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_valid_isbn_13(x, allow.hyphens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_valid_isbn_13_+3A_x">x</code></td>
<td>
<p>A string of 13</p>
</td></tr>
<tr><td><code id="is_valid_isbn_13_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE if checks pass, FALSE if not, and NA if NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
is_valid_isbn_13("9780306406157")          # TRUE
is_valid_isbn_13("978-0-306-40615-7")      # TRUE

# vectorized
is_valid_isbn_10(c("012491540X", "9004037812"))  # TRUE FALSE
is_valid_isbn_13(c("978-0-306-40615-7", "9783161484103"))  # TRUE FALSE
is_valid_isbn_13(c("978-0-306-40615-7", "hubo un tiempo"))  # TRUE FALSE

</code></pre>

<hr>
<h2 id='is_valid_issn'>Return TRUE if valid ISSN</h2><span id='topic+is_valid_issn'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISSN verifies that it is valid.
An ISSN is valid if it is a 8 digit string or a 7 digit string
with a terminal &quot;X&quot; AND the check digit matches
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_valid_issn(x, allow.hyphens = TRUE, lower.x.allowed = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_valid_issn_+3A_x">x</code></td>
<td>
<p>A string of 8 digits or 7 digits with terminal &quot;X&quot;</p>
</td></tr>
<tr><td><code id="is_valid_issn_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>A logical indicating whether the hyphen
separator should be allowed
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="is_valid_issn_+3A_lower.x.allowed">lower.x.allowed</code></td>
<td>
<p>A logical indicating whether ISSNs with
a check digit with a lower-case &quot;x&quot; should
be treated as valid
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE if checks pass, FALSE if not, and NA if NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
is_valid_issn("2434561X")           # TRUE
is_valid_issn("2434-561X")          # TRUE

# vectorized

is_valid_issn(c("2434-561X", "2434-5611", "0378-5955", NA))
# TRUE FALSE TRUE NA

</code></pre>

<hr>
<h2 id='is_valid_lc_call'>Check if LC Call Number is valid</h2><span id='topic+is_valid_lc_call'></span>

<h3>Description</h3>

<p>Takes a string representation of a Library of Congress
call number and returns either TRUE or FALSE based on
whether or not the input fits the canonical LC Call
Number pattern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_valid_lc_call(x, allow.bare = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_valid_lc_call_+3A_x">x</code></td>
<td>
<p>A Library of Congress call number (string)</p>
</td></tr>
<tr><td><code id="is_valid_lc_call_+3A_allow.bare">allow.bare</code></td>
<td>
<p>A logical indicating whether an LC Call with only
the letters should be considered valid
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns either TRUE or FALSE based on whether the
call number is valid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
is_valid_lc_call("Q172.5.E77")
# TRUE
is_valid_lc_call("AF172.5.E77")
# FALSE

# vectorized
is_valid_lc_call(c("Q 172.5", "AF172", "PR6023.A93"))
# TRUE FALSE TRUE

</code></pre>

<hr>
<h2 id='language_code_crosswalk'>language code / language crosswalk</h2><span id='topic+language_code_crosswalk'></span>

<h3>Description</h3>

<p>A cross-walk between the language code
and it's human readable version
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(language_code_crosswalk)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.table"</code>;
</p>


<h3>Source</h3>

<p><a href="https://www.loc.gov/marc/languages/language_code.html">https://www.loc.gov/marc/languages/language_code.html</a>
</p>

<hr>
<h2 id='lc_subject_classification'>LC Call Subject Code Classification / Classification name crosswalk</h2><span id='topic+lc_subject_classification'></span>

<h3>Description</h3>

<p>A cross-walk between the LC Subject classification and
and it's human readable name (first letter of LC Call Number)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lc_subject_classification)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.table"</code>;
</p>


<h3>Source</h3>

<p><a href="https://www.loc.gov/catdir/cpso/lcco/">https://www.loc.gov/catdir/cpso/lcco/</a>
</p>

<hr>
<h2 id='lc_subject_subclassification'>LC Subject Subclassification / Subclassification name crosswalk</h2><span id='topic+lc_subject_subclassification'></span>

<h3>Description</h3>

<p>A cross-walk between the LC Subject subclassification and
and it's human readable name (all letters in an LC Call Number)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lc_subject_subclassification)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.table"</code>;
</p>


<h3>Source</h3>

<p><a href="https://www.loc.gov/catdir/cpso/lcco/">https://www.loc.gov/catdir/cpso/lcco/</a>
</p>

<hr>
<h2 id='loc_permalink_from_lccn'>Get Library of Congress catalog permalinks from LCCNs</h2><span id='topic+loc_permalink_from_lccn'></span>

<h3>Description</h3>

<p>Takes a string representation of an LCCNs. Returns permalinks
to the Library of Congress catalog entries using those LCCNs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loc_permalink_from_lccn(x, normalize = TRUE, format = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loc_permalink_from_lccn_+3A_x">x</code></td>
<td>
<p>A string (or vector of strings) of LCCNs</p>
</td></tr>
<tr><td><code id="loc_permalink_from_lccn_+3A_normalize">normalize</code></td>
<td>
<p>a logical indicating whether the LCCN should be
normalized prior to creating the permalink
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="loc_permalink_from_lccn_+3A_format">format</code></td>
<td>
<p>One of &quot;&quot;, &quot;marcxml&quot;, &quot;mods&quot;, &quot;mads&quot;, or &quot;dublin&quot; to return
the link to the main permalink page, or the link directly
to the record's MARCXml, MODS, MADS, or Dublin Core
representation, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If normalize=TRUE and the LCCN is invalid, the permalink is NA.
If normalize=FALSE, the permalink may be invalid. No validity
check on the URL is performed
</p>


<h3>Value</h3>

<p>Library of Congress permalinks using LCCNs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>loc_permalink_from_lccn("n78-890351")        # "https://lccn.loc.gov/n78890351"
loc_permalink_from_lccn("85-2 ")             # "https://lccn.loc.gov/85000002"
loc_permalink_from_lccn("75-425165//r75")    # "https://lccn.loc.gov/75425165"

# vectorized
loc_permalink_from_lccn(c("###78890351#", NA, "n78-890351"))

# MARCXML metadata format
loc_permalink_from_lccn("73167510", format="marcxml")
# "https://lccn.loc.gov/73167510/marcxml"

</code></pre>

<hr>
<h2 id='marc_008_get_info'>Get info from MARC control field 008</h2><span id='topic+marc_008_get_info'></span>

<h3>Description</h3>

<p>Takes one or more MARC 008 fields (string/strings) and returns a
<code>data.table</code> containing the publication date, publication
place code, and language code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marc_008_get_info(
  x,
  original.pub.date = FALSE,
  include.questionable.dates = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marc_008_get_info_+3A_x">x</code></td>
<td>
<p>A string (or vector of strings) of LCCNs</p>
</td></tr>
<tr><td><code id="marc_008_get_info_+3A_original.pub.date">original.pub.date</code></td>
<td>
<p>If <code>TRUE</code> and if applicable,
return the original publication date, not
the re-issue publication date. (Default
is <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="marc_008_get_info_+3A_include.questionable.dates">include.questionable.dates</code></td>
<td>
<p>A logical indicating whether &quot;questionable&quot;
dates should be replaced with <code>NA</code>.
Questionable dates are when the &quot;type of
date&quot; in character position 06 is &quot;q&quot;.
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If any date element is &quot;unknown&quot; (contains a &quot;u&quot;), the returned
date is NA. The returned date is always an integer.
</p>


<h3>Value</h3>

<p>A <code>data.table</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# reissue publication date
marc_008_get_info("950622r19701880ru            000 0 rus d")
#     pub_date pub_place_code lang_code
#        &lt;int&gt;         &lt;char&gt;    &lt;char&gt;
#  1:     1970             ru       rus

# The Brothers Karamazov (1970 reissue but original publication date)
marc_008_get_info("950622r19701880ru            000 0 rus d",
                  original.pub.date=TRUE)
#    pub_date pub_place_code lang_code
#       &lt;int&gt;         &lt;char&gt;    &lt;char&gt;
# 1:     1880             ru       rus

# vectorized
marc_008_get_info(c("101106s1992    gr            000 1 gre d", NA,
                    "180528s2017    ag            000 j spa d"))
#      pub_date pub_place_code lang_code
#         &lt;int&gt;         &lt;char&gt;    &lt;char&gt;
#   1:     1992             gr       gre
#   2:       NA           &lt;NA&gt;      &lt;NA&gt;
#   3:     2017             ag       spa

</code></pre>

<hr>
<h2 id='marc_leader_get_info'>Get info from MARC leader</h2><span id='topic+marc_leader_get_info'></span>

<h3>Description</h3>

<p>Takes one or more MARC leaders (string/strings) and returns a
<code>data.table</code> containing the record type and bib level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marc_leader_get_info(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marc_leader_get_info_+3A_x">x</code></td>
<td>
<p>A string (or vector of strings) of MARC leaders</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
marc_leader_get_info("00000cam a22000008i 4500")
#          record_type      bib_level
#               &lt;char&gt;         &lt;char&gt;
# 1: Language Material Monograph/Item

# vectorized
marc_leader_get_info(c("00000cam a2200000Ma 4500", NA,
                       "00000cem a2200000Ma 4500"))
#              record_type      bib_level
#                    &lt;char&gt;         &lt;char&gt;
#  1:     Language Material Monograph/Item
#  2:                  &lt;NA&gt;           &lt;NA&gt;
#  3: Cartographic material Monograph/Item

</code></pre>

<hr>
<h2 id='normalize_isbn'>Attempt to enforce validity and canonical form to an ISBN</h2><span id='topic+normalize_isbn'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN (10 or 13). This function uses
tries to normalize the string as a ISBN 13, then an ISBN 10. If one of
those methods are able to salvage the ISBN, the canonicalized ISBN is
returned. User can specify whether &quot;aggressive&quot;
measures should be taken to salvage the malformed ISBN string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_isbn(x, aggressive = TRUE, convert.to.isbn.13 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_isbn_+3A_x">x</code></td>
<td>
<p>A string</p>
</td></tr>
<tr><td><code id="normalize_isbn_+3A_aggressive">aggressive</code></td>
<td>
<p>A logical indicating whether aggressive measures
should be taken to try to get the &quot;ISBN 10&quot;
into a valid form. See &quot;Details&quot; for more info
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="normalize_isbn_+3A_convert.to.isbn.13">convert.to.isbn.13</code></td>
<td>
<p>A logical indicating whether the ISBN 10
should be converted into an ISBN 13
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>aggressive</code> is TRUE, aggressive measures are taken to
try to salvage the malformed ISBN string. Since this function attempts
to salvage both an ISBN 10 and 13, to learn about examples of the
aggressive methods, see <code><a href="#topic+normalize_isbn_10">normalize_isbn_10</a></code> and
<code><a href="#topic+normalize_isbn_13">normalize_isbn_13</a></code>
</p>


<h3>Value</h3>

<p>Returns valid ISBN if possible, NA if not
</p>


<h3>See Also</h3>

<p><code><a href="#topic+normalize_isbn_10">normalize_isbn_10</a></code> <code><a href="#topic+normalize_isbn_13">normalize_isbn_13</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
normalize_isbn("012491540x")                           # "012491540X"
normalize_isbn("012491540x", convert.to.isbn.13=TRUE)
"9780124915404"

# vectorized
normalize_isbn(c("513213012491540x245",
                 "978966819^*!X7918",
                 NA,
                 "97815724115799781572411579"))
# "012491540X", "9789668197918", NA, "9781572411579"

</code></pre>

<hr>
<h2 id='normalize_isbn_10'>Attempt to enforce validity and canonical form to ISBN 10</h2><span id='topic+normalize_isbn_10'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 10. Strips all non-digit
and non-&quot;X&quot; characters and checks if it is valid (whether the
check digit works out, etc). User can specify whether &quot;aggressive&quot;
measures should be taken to salvage the malformed ISBN 10 string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_isbn_10(x, aggressive = TRUE, convert.to.isbn.13 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_isbn_10_+3A_x">x</code></td>
<td>
<p>A string</p>
</td></tr>
<tr><td><code id="normalize_isbn_10_+3A_aggressive">aggressive</code></td>
<td>
<p>A logical indicating whether aggressive measures
should be taken to try to get the &quot;ISBN 10&quot;
into a valid form. See &quot;Details&quot; for more info
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="normalize_isbn_10_+3A_convert.to.isbn.13">convert.to.isbn.13</code></td>
<td>
<p>A logical indicating whether the ISBN 10
should be converted into an ISBN 13
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>aggressive</code> is TRUE, aggressive measures are taken to
try to salvage the malformed ISBN 10 string. If the ISBN 10, for example,
is 9 digits, and either adding an &quot;X&quot; to the end, or leading &quot;0&quot;s fix it,
this function will return the salvaged ISBN 10. If the ISBN 10 has
garbage digits/characters in the front and has an &quot;X&quot; check digit,
it will return the salvaged ISBN 10.
</p>


<h3>Value</h3>

<p>Returns valid ISBN 10 if possible, NA if not
</p>


<h3>See Also</h3>

<p><code><a href="#topic+normalize_isbn">normalize_isbn</a></code> <code><a href="#topic+normalize_isbn_13">normalize_isbn_13</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
normalize_isbn_10("012491540x")                    # "012491540X"
normalize_isbn_10("012491540x xe32ea")             # "012491540X"
normalize_isbn_10("012491540x", convert.to.isbn.13=TRUE)
# "9780124915404"
normalize_isbn_10("513213012491540x")              # "012491540X"

</code></pre>

<hr>
<h2 id='normalize_isbn_13'>Attempt to enforce validity and canonical form to ISBN 13</h2><span id='topic+normalize_isbn_13'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISBN 13. Strips all non-digit
characters and checks if it is valid (whether the
check digit works out, etc). User can specify whether &quot;aggressive&quot;
measures should be taken to salvage the malformed ISBN 13 string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_isbn_13(x, aggressive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_isbn_13_+3A_x">x</code></td>
<td>
<p>A string</p>
</td></tr>
<tr><td><code id="normalize_isbn_13_+3A_aggressive">aggressive</code></td>
<td>
<p>A logical indicating whether aggressive measures
should be taken to try to get the &quot;ISBN 13&quot;
into a valid form. See &quot;Details&quot; for more info
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>aggressive</code> is TRUE, aggressive measures are taken to
try to salvage the malformed ISBN 13 string. If the ISBN 13, for example,
is more than 13 characters, this function will attempt to make a valid
ISBN 13 from the first 13 digits.
</p>


<h3>Value</h3>

<p>Returns valid ISBN 13 if possible, NA if not
</p>


<h3>See Also</h3>

<p><code><a href="#topic+normalize_isbn">normalize_isbn</a></code> <code><a href="#topic+normalize_isbn_10">normalize_isbn_10</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
normalize_isbn_13("978966819^*!X7918")        # "9789668197918"

# vectorized
normalize_isbn_13(c("978-9-66-819791-8", "__9__781572411579"))
# "9789668197918" "9781572411579"

</code></pre>

<hr>
<h2 id='normalize_issn'>Attempt to enforce validity and canonical form to ISSN</h2><span id='topic+normalize_issn'></span>

<h3>Description</h3>

<p>Takes a string representation of an ISSN. Strips all non-digit
and non-&quot;X&quot; characters and checks if it is valid (whether the
check digit works out, etc). User can specify whether &quot;aggressive&quot;
measures should be taken to salvage the malformed ISSN string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_issn(x, aggressive = TRUE, pretty = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_issn_+3A_x">x</code></td>
<td>
<p>A string</p>
</td></tr>
<tr><td><code id="normalize_issn_+3A_aggressive">aggressive</code></td>
<td>
<p>A logical indicating whether aggressive measures
should be taken to try to get the &quot;ISSN&quot;
into a valid form. See &quot;Details&quot; for more info
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="normalize_issn_+3A_pretty">pretty</code></td>
<td>
<p>A logical indicating whether the ISSN should be
prettily hyphenated
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>aggressive</code> is TRUE, aggressive measures are taken to
try to salvage the malformed ISSN string. If the ISSN, for example,
is 7 digits, and either adding an &quot;X&quot; to the end, or leading &quot;0&quot;s fix it,
this function will return the salvaged ISSN. If the ISSN has
garbage digits/characters in the front and has an &quot;X&quot; check digit,
it will return the salvaged ISSN.
</p>


<h3>Value</h3>

<p>Returns valid ISSN if possible, NA if not
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# adds leading zero
normalize_issn("3785955")                          # "03785955"

# adds X to 7 digit ISSN if valid
normalize_issn("2434561")                          # "2434561X"

normalize_issn("2434561", pretty=TRUE)             # "2434-561X"

# finds correct sequence
normalize_issn("21335212434561X")                  # "2434561X"

# vectorized
normalize_issn(c("__2434__561X", "2434561", "21335212434561X"))
# "2434561X" "2434561X" "2434561X"

</code></pre>

<hr>
<h2 id='normalize_lccn'>Attempt to enforce validity of LCCN and convert to normalized form</h2><span id='topic+normalize_lccn'></span>

<h3>Description</h3>

<p>Takes a string representation of an LCCN. Returns a normalized one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_lccn(userlccns, allow.hyphens = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_lccn_+3A_userlccns">userlccns</code></td>
<td>
<p>A string (or vector of strings) of LCCNs</p>
</td></tr>
<tr><td><code id="normalize_lccn_+3A_allow.hyphens">allow.hyphens</code></td>
<td>
<p>a logical indicating whether hyphens separating
the year and serial should be handled. Adds
complexity and time to the function.
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Normalization procedure is documented here:
https://www.loc.gov/marc/lccn-namespace.html
</p>
<p>This does not include revisions or use &quot;#&quot; as a padding character
The normalized LCCN is not always the same number of characters
</p>


<h3>Value</h3>

<p>Returns valid LCCN if possible, NA if not
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
normalize_lccn("n 78890351 ")                  # "n78890351"

normalize_lccn("###78890351#")                 # "78890351"

normalize_lccn(" 79139101 /AC/r932")           #  "79139101"

normalize_lccn("85-2 ")                        #  "85000002"
normalize_lccn("85-2 ", allow.hyphens=FALSE)   #  NA

# vectorized
normalize_lccn(c("85-2 ", " 79139101 /AC/r932", "n 78890351 "))
# c("85000002", "79139101", "n78890351"))

</code></pre>

<hr>
<h2 id='oclc_classify_link_from_standard_num'>Get OCLC Classify link from a standard number</h2><span id='topic+oclc_classify_link_from_standard_num'></span>

<h3>Description</h3>

<p>Takes a string representation of ISSNs, ISBNs, UPC,
or OCLC numbers.
Returns a link to the OCLC's experimental classify
service which provides the most frequent call numbers,
FAST subject headings, etc...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oclc_classify_link_from_standard_num(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oclc_classify_link_from_standard_num_+3A_x">x</code></td>
<td>
<p>A string (or vector of strings) of a standard number.
Must be an ISSN, ISBN, UPC, and/or OCLC numbers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since this can take a variety of standard numbers, no
normalization can be performed. The numbers much be normalized
before the call to this function.
No validity check on the URL is performed
</p>


<h3>Value</h3>

<p>Links to OCLC's Classify web service
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
oclc_classify_link_from_standard_num("629725006")
# "http://classify.oclc.org/classify2/ClassifyDemo?search-standnum-txt=629725006&amp;startRec=0"

oclc_classify_link_from_standard_num(c("039333712X", NA, "629725006"))
# [1] "http://classify.oclc.org/classify2/ClassifyDemo?search-standnum-txt=039333712X&amp;startRec=0"
# [2] NA
# [3] "http://classify.oclc.org/classify2/ClassifyDemo?search-standnum-txt=629725006&amp;startRec=0"

</code></pre>

<hr>
<h2 id='recombine_with_sep_closure'>Return a function that will combine/contatenate a vector</h2><span id='topic+recombine_with_sep_closure'></span>

<h3>Description</h3>

<p>This function takes and optional separator, and returns
a function that takes a vector and <code>paste</code>s the
elements of that vector together
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recombine_with_sep_closure(sep = ";")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recombine_with_sep_closure_+3A_sep">sep</code></td>
<td>
<p>A character to use in between the elements
(default is a semicolon character)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can be used as a reduction function in <code>split_map_filter_reduce</code>
</p>


<h3>Value</h3>

<p>Returns a closure/function
</p>


<h3>See Also</h3>

<p><code><a href="#topic+split_map_filter_reduce">split_map_filter_reduce</a></code>
</p>
<p><code><a href="base.html#topic+paste">paste</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
lambda &lt;- recombine_with_sep_closure()
lambda(c(8, 6, 7))                               # "8;6;7"

# directly
recombine_with_sep_closure()(c(8,6,7))           #  "8;6;7"
lambda &lt;- recombine_with_sep_closure(" ")
lambda(c("this", "that", NA,"the-other"))        # "this that NA the-other"

</code></pre>

<hr>
<h2 id='remove_duplicates_and_nas'>Remove duplicate elements and NAs from a vector</h2><span id='topic+remove_duplicates_and_nas'></span>

<h3>Description</h3>

<p>Takes a vector and returns the same vector without duplicate
elements and without NA values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_duplicates_and_nas(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_duplicates_and_nas_+3A_x">x</code></td>
<td>
<p>A vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can be used as a filtering function in <code>split_map_filter_reduce</code>
</p>


<h3>Value</h3>

<p>Returns vector with duplicates and NAs removed
</p>


<h3>See Also</h3>

<p><code><a href="#topic+split_map_filter_reduce">split_map_filter_reduce</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
remove_duplicates_and_nas(c(8, 6, 7, 5, 3, 0, 9, 6, NA, 3))
# 8 6 7 5 3 0 9

remove_duplicates_and_nas(c(NA, NA))
# NA

</code></pre>

<hr>
<h2 id='set_lb_attribute'>Set special libbib attribute on object</h2><span id='topic+set_lb_attribute'></span>

<h3>Description</h3>

<p>Takes an object, attribute name, and a value and sets a special
libbib attribute by reference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_lb_attribute(x, type, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_lb_attribute_+3A_x">x</code></td>
<td>
<p>An object to set the attribute on</p>
</td></tr>
<tr><td><code id="set_lb_attribute_+3A_type">type</code></td>
<td>
<p>The name of the attribute to set. <code>lb.</code> will be appended
to this attribute name. For example, if this argument is
<code>source</code>, and attribute called <code>lb.source</code> will
be set on the object with the value specified</p>
</td></tr>
<tr><td><code id="set_lb_attribute_+3A_value">value</code></td>
<td>
<p>The value of the attribute</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, since the object is modified by reference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set_lb_attribute(mtcars, "source", "R built-in dataset")

versicolor &lt;- iris[iris$Species=="versicolor", ]
set_lb_attribute(versicolor, "note", "modified built-in dataset")
attributes(versicolor)$lb.note
# [1] "modified built-in dataset"

</code></pre>

<hr>
<h2 id='set_lb_date'>Set special libbib date attribute on object</h2><span id='topic+set_lb_date'></span>

<h3>Description</h3>

<p>Takes an object and a date and sets a special attribute, &quot;lb.date&quot;
by reference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_lb_date(x, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_lb_date_+3A_x">x</code></td>
<td>
<p>An object to set the attribute on</p>
</td></tr>
<tr><td><code id="set_lb_date_+3A_value">value</code></td>
<td>
<p>Either a value of class <code>Date</code> or a string in ISO 8601
date format (yyyy-mm-dd) which will be converted into a Date</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, since the object is modified by reference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set_lb_date(mtcars, "2021-05-08")
attributes(mtcars)$lb.date
# [1] "2021-05-08

set_lb_date(mtcars, Sys.Date())

</code></pre>

<hr>
<h2 id='split_map_filter_reduce'>Split, Map, Filter, and Reduce a string vector</h2><span id='topic+split_map_filter_reduce'></span>

<h3>Description</h3>

<p>This function takes a vector of strings, splits those strings
on a particular character; string; or regex patters, applies a
user-specified function to each sub-element of the now split element,
filters those sub-elements using a user-specified function, and, finally,
recombines each element's sub-elements using a user specified reduction
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_map_filter_reduce(
  x,
  sep = ";",
  fixed = TRUE,
  mapfun = identity,
  filterfun = identity,
  reduxfun = car,
  cl = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_map_filter_reduce_+3A_x">x</code></td>
<td>
<p>A vector of strings</p>
</td></tr>
<tr><td><code id="split_map_filter_reduce_+3A_sep">sep</code></td>
<td>
<p>A character to use containing a character, string, or
regular expression pattern to split each element by.
If <code>fixed=TRUE</code>, the separator will be used exactly;
If not, a Perl-compatible regular expression can be used
(default is &quot;;&quot;)</p>
</td></tr>
<tr><td><code id="split_map_filter_reduce_+3A_fixed">fixed</code></td>
<td>
<p>Should it be split by a fixed string/character or
a regular expression (default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="split_map_filter_reduce_+3A_mapfun">mapfun</code></td>
<td>
<p>A vectorized function that will be applied to the
sub-elements (after splitting) of each element in x
(default is <code>identity</code> which would leave the
sub-elements unchanged)</p>
</td></tr>
<tr><td><code id="split_map_filter_reduce_+3A_filterfun">filterfun</code></td>
<td>
<p>A vectorized function that, when given a vector
returns the same vector with un-wanted elements
removed
(default is <code>identity</code> which would not remove
any sub-elements)</p>
</td></tr>
<tr><td><code id="split_map_filter_reduce_+3A_reduxfun">reduxfun</code></td>
<td>
<p>A vectorized function that, when given a vector,
will combine all of it's elements into one value
(default is <code>car</code>, which would return the first
element only)</p>
</td></tr>
<tr><td><code id="split_map_filter_reduce_+3A_cl">cl</code></td>
<td>
<p>An integer to indicate the number of child processes
should be used to parallelize the work-load. If 0,
the workload will not be parallelized. Can also
take a cluster object created by 'makeCluster'
(default is 0)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since this operation cannot be vectorized, if the user specifies
a non-zero <code>cl</code> argument, the workload will be parallelized
and <code>cl</code> many child processes will be spawned to do the work.
The package <code>pbapply</code> will be used to do this.
</p>
<p>See <code>examples</code> for more information and ideas on why this
might be useful for, as an example, batch normalizing ISBNs that,
for each bibliographic record, is separated by a semicolon
</p>


<h3>Value</h3>

<p>Returns a vector
</p>


<h3>See Also</h3>

<p><code><a href="#topic+car">car</a></code>
</p>
<p><code><a href="#topic+remove_duplicates_and_nas">remove_duplicates_and_nas</a></code>
</p>
<p><code><a href="#topic+recombine_with_sep_closure">recombine_with_sep_closure</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
someisbns &lt;- c("9782711875177;garbage-isbn;2711875172;2844268900",
               "1861897952; 978-1-86189-795-4")

# will return only the first ISBN for each record
split_map_filter_reduce(someisbns)
# "9782711875177" "1861897952"

# will return only the first ISBN for each record, after normalizing
# each ISBN
split_map_filter_reduce(someisbns, mapfun=function(x){normalize_isbn(x, convert.to.isbn.13=TRUE)})
# "9782711875177" "9781861897954"

# will return all ISBNs, for each record, separated by a semicolon
# after applying normalize_isbn to each ISBN
# note the duplicates introduced after normalization occurs
split_map_filter_reduce(someisbns, mapfun=function(x){normalize_isbn(x, convert.to.isbn.13=TRUE)},
                        reduxfun=recombine_with_sep_closure())
# "9782711875177;NA;9782711875177;9782844268907" "9781861897954;9781861897954"

# After splitting each items ISBN list by semicolon, this runs
# normalize_isbn in each of them. Duplicates are produced when
# an ISBN 10 converts to an ISBN 13 that is already in the ISBN
# list for the item. NAs are produced when an ISBN fails to normalize.
# Then, all duplicates and NAs are removed. Finally, the remaining
# ISBNs, for each record, are pasted together using a space as a separator
split_map_filter_reduce(someisbns, mapfun=function(x){normalize_isbn(x, convert.to.isbn.13=TRUE)},
                        filterfun=remove_duplicates_and_nas,
                        reduxfun=recombine_with_sep_closure(" "))
# "9782711875177 9782844268907" "9781861897954"

</code></pre>

<hr>
<h2 id='worldcat_api_bib_read_info_by'>Get bibliographic info from a standard number</h2><span id='topic+worldcat_api_bib_read_info_by'></span><span id='topic+worldcat_api_bib_read_info_by_oclc'></span><span id='topic+worldcat_api_bib_read_info_by_isbn'></span><span id='topic+worldcat_api_bib_read_info_by_issn'></span>

<h3>Description</h3>

<p>Access the results of a WorldCat bib read API search by ISBN, ISSN,
or OCLC number. The MARCXML returned by the API is parsed and the
function returns a <code>data.table</code> containing the oclc number,
ISBN, ISSN, title, author, MARC leader, and the 008 control field,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldcat_api_bib_read_info_by_oclc(
  x,
  wskey = getOption("libbib.wskey", NULL),
  more = FALSE,
  debug = FALSE
)

worldcat_api_bib_read_info_by_isbn(
  x,
  wskey = getOption("libbib.wskey", NULL),
  more = FALSE,
  debug = FALSE
)

worldcat_api_bib_read_info_by_issn(
  x,
  wskey = getOption("libbib.wskey", NULL),
  more = FALSE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="worldcat_api_bib_read_info_by_+3A_x">x</code></td>
<td>
<p>A string representation of the standard number that the function
chosen accepts.</p>
</td></tr>
<tr><td><code id="worldcat_api_bib_read_info_by_+3A_wskey">wskey</code></td>
<td>
<p>A WorldCat API key (default is <code>getOption("libbib.wskey")</code>)</p>
</td></tr>
<tr><td><code id="worldcat_api_bib_read_info_by_+3A_more">more</code></td>
<td>
<p>A logical indicating whether more infomation from the MARCXML
should be returned (publisher, bib level etc....) In the
interest of memory consumption, the default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="worldcat_api_bib_read_info_by_+3A_debug">debug</code></td>
<td>
<p>A logical indicating whether the HTTP and bib read API
responses should be printed (for debugging)
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Though this function gets all standard numbers (OCLC, ISBN, ISSN)
from the MARCXML, the standard number that was supplied to the function
will be the one in the returned <code>data.table</code>. For example, if
you use <code>worldcat_api_bib_read_info_by_isbn</code>, the returned
<code>data.table</code> will have that ISBN in the ISBN column, not the
ISBN in the MARC record.
</p>
<p>If something went wrong, all columns (except the one corresponding to
the supplied standard number) will be NA.
</p>
<p>This function is helpful to call before attempting to use
the Location and Classify API functions as it will ensure that
the supplied standard number actually resolves to a OCLC work.
</p>
<p>As with all API access functions in this package, it's up to the
user to limit their API usage so as to not get blocked. These
functions are deliberately not vectorized for this reason; they
only accept one standard number at a time.
</p>
<p>This (and other) WorldCat API communication functions require a
WorldCat API key. The easiest way to use these functions is to
set a global options with your key:
<code>options("libbib.wskey"="YOUR KEY HERE")</code>
</p>
<p>Final note: all of these API functions seem to work better with
OCLC numbers than any other standard number. If multiple standard
numbers are available, using the OCLC number is always preferred.
</p>


<h3>Value</h3>

<p>A <code>data.table</code> containing the OCLC number, ISBN, ISSN,
title, author, MARC leader, and the 008 control field,
respectively,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
worldcat_api_bib_read_info_by_isbn("9780984201006")
#         oclc          isbn   issn                        title
#       &lt;char&gt;        &lt;char&gt; &lt;char&gt;                       &lt;char&gt;
# 1: 462894360 9780984201006   &lt;NA&gt; The Great Debate about Art /
#          author                   leader
#          &lt;char&gt;                   &lt;char&gt;
# 1: Harris, Roy, 00000cam a2200000 a 4500
#                                        oh08
#                                      &lt;char&gt;
# 1: 091031s2010    ilua     b    000 0 eng c

worldcat_api_bib_read_info_by_issn("13602365")
#        oclc   isbn     issn                        title author
#      &lt;char&gt; &lt;char&gt;   &lt;char&gt;                       &lt;char&gt; &lt;char&gt;
# 1: 37787277   &lt;NA&gt; 14664410 The journal of architecture.   &lt;NA&gt;
#                      leader                                     oh08
#                      &lt;char&gt;                                   &lt;char&gt;
# 1: 00000cas a2200000 a 4500 971015c19969999enkbx pso     0   a0eng c


## End(Not run)

</code></pre>

<hr>
<h2 id='worldcat_api_classify_by'>Search WorldCat classify API by ISBN, ISSN, or OCLC number</h2><span id='topic+worldcat_api_classify_by'></span><span id='topic+worldcat_api_classify_by_oclc'></span><span id='topic+worldcat_api_classify_by_isbn'></span><span id='topic+worldcat_api_classify_by_issn'></span>

<h3>Description</h3>

<p>Access the results of a WorldCat classify API search by ISBN, ISSN,
or OCLC number to get the most frequent call numbers (DDC and LCC)
associated with a work. Returns a <code>data.table</code> with those call
numbers and various other metadata. See &quot;Details&quot; for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldcat_api_classify_by_oclc(x, debug = FALSE)

worldcat_api_classify_by_isbn(x, debug = FALSE)

worldcat_api_classify_by_issn(x, debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="worldcat_api_classify_by_+3A_x">x</code></td>
<td>
<p>A string representation of the standard number that the function
chosen accepts.</p>
</td></tr>
<tr><td><code id="worldcat_api_classify_by_+3A_debug">debug</code></td>
<td>
<p>A logical indicating whether the HTTP and classify API
responses should be printed (for debugging)
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The returned <code>data.table</code> contains fields for various pieces of
metadata returned by the API request. These fields include the
ISBN/ISSN/OCLC number used, title of work, author, total number of
holdings, total number of electronic holdings, call number type,
call number recommendation (by most popular), number of holdings
using that call number, the HTTP status code, and the Classify
API response code.
</p>
<p>For each ISBN/ISSN/OCLC number used, two rows will be returned; one for
the DDC and one for the LCC. Common information (work metadata)
will the the same in both rows. If one of the call numbers is missing,
the recommendation and holdings fields will be NA.
</p>
<p>The API can be persnickety, and there are many things that can go
wrong. For example, the API can respond with multiple works for a
single standard number (ISBN 9780900565748, for example). If this happens,
no attempt is made to follow one of the results, and the returned
<code>data.table</code> will return no useful information.
</p>
<p>If the <code>http_status_code</code> is 200 and the <code>classify_response_code</code>
is 0, you've received good results.If the <code>classify_response_code</code> is
4, the standard number may have returned multiple works.
</p>
<p>The <code>http_status_code</code> should never not be 200.
</p>
<p>If something went wrong (for example, the status/response codes are not
200 and 0, respectively), you may want to re-run the function call with
<code>print.api.responses</code> set to <code>TRUE</code>. This will print the
HTTP status code and the raw XML text response from the API.
</p>
<p>As with all API access functions in this package, it's up to the
user to limit their API usage so as to not get blocked. These
functions are deliberately not vectorized for this reason; they
only accept one standard number at a time.
</p>
<p>Final note: all of these API functions seem to work better with
OCLC numbers than any other standard number. If multiple standard
numbers are available, using the OCLC number is always preferred.
</p>


<h3>Value</h3>

<p>A <code>data.table</code> with most popular DDC and LCC call numbers
and various other metadata. See &quot;Details&quot; for more information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
  worldcat_api_classify_by_oclc("93976650")
   #         oclc   title           author total_holdings total_eholdings call_type
   #       &lt;char&gt;  &lt;char&gt;           &lt;char&gt;          &lt;int&gt;           &lt;int&gt;    &lt;char&gt;
   # 1: 939766505 Lobster King, Richard J.            244             534       DDC
   # 2: 939766505 Lobster King, Richard J.            244             534       LCC
   #    recommendation holdings http_status_code classify_response_code
   #            &lt;char&gt;   &lt;char&gt;            &lt;int&gt;                  &lt;int&gt;
   # 1:        641.395      767              200                      0
   # 2:      QL444.M33      318              200                      0


## End(Not run)

</code></pre>

<hr>
<h2 id='worldcat_api_locations_by'>Get holding libraries by standard number</h2><span id='topic+worldcat_api_locations_by'></span><span id='topic+worldcat_api_locations_by_oclc'></span><span id='topic+worldcat_api_locations_by_isbn'></span><span id='topic+worldcat_api_locations_by_issn'></span>

<h3>Description</h3>

<p>Access the results of a WorldCat location API search by ISBN, ISSN,
or OCLC number. Returns a <code>data.table</code> with rows corresponding to
each holding institution. The columns contain the standard number
provided, the institution identifier, the institution name, number
of copies held by that insitution, and, by default, the bibliographic
information provided by <code>worldcat_api_bib_read_info_by_...</code>.
This information is helpful to ensure thaat the standard number
provided successfully resolved to a single OCLC work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldcat_api_locations_by_oclc(
  x,
  location = "10032",
  include.bib.info = TRUE,
  max_libraries = Inf,
  servicelevel = "full",
  frbrGrouping = "on",
  libtype = NULL,
  wskey = getOption("libbib.wskey", NULL),
  print.progress = TRUE,
  debug = FALSE
)

worldcat_api_locations_by_isbn(
  x,
  location = "10032",
  include.bib.info = TRUE,
  max_libraries = Inf,
  servicelevel = "full",
  frbrGrouping = "on",
  libtype = NULL,
  wskey = getOption("libbib.wskey", NULL),
  print.progress = TRUE,
  debug = FALSE
)

worldcat_api_locations_by_issn(
  x,
  location = "10032",
  include.bib.info = TRUE,
  max_libraries = Inf,
  servicelevel = "full",
  frbrGrouping = "on",
  libtype = NULL,
  wskey = getOption("libbib.wskey", NULL),
  print.progress = TRUE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="worldcat_api_locations_by_+3A_x">x</code></td>
<td>
<p>The standard number to search using. Must be a string.</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_location">location</code></td>
<td>
<p>The holding institutions are sorted roughly by geographic
proximity to this zip-code, country code, etc...
If <code>max_libraries</code> is <code>Inf</code> (the default), the
starting location doesn't matter since all holding
institutions are returned. Defaults to the zip code
of Washington Heights, NYC.</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_include.bib.info">include.bib.info</code></td>
<td>
<p>A logical indicating whether to include
bibliographic metadata associated with the
work (provided by
<code>worldcat_api_bib_read_info_by_...</code>).
This is very useful for error checking so
default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_max_libraries">max_libraries</code></td>
<td>
<p>The maximum number of libraries to return.
Must be a number between 0 and 100 or <code>Inf</code>.
If <code>Inf</code> (default), the function will
automatically make all follow-up requests to retrieve
all holding institutions. Beware that each page of
100 institutions counts as one API request. If the
bib searched for is popular, set this to non-<code>Inf</code>.</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_servicelevel">servicelevel</code></td>
<td>
<p>Either &quot;full&quot; (the default) or &quot;default&quot;. If &quot;full&quot;,
the number of holding libraries returned is the same
as if a user logged in to an institution when making
a WorldCat search. If &quot;default&quot;, the results are
a subset of WorldCat libraries, namely those that
participate in worldcat.org. In this way, the number
of holding libraries is tantamount to if a non-logged-in
user searched WorldCat. The number of results with &quot;full&quot;
is always at least as high as with &quot;default&quot;, so the
default is &quot;full&quot;. If this package is being used in
an application where a user is not logged in to an
institution, set this to &quot;default&quot;. It is up to you
to respect the WorldCat API's conditions.</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_frbrgrouping">frbrGrouping</code></td>
<td>
<p>With this parameter set to &quot;on&quot; (default),
an attempt is made by the WorldCat API to group
together similar editions and present only the top
held record as the representative record for that group.
If not, only institutions holding the exact standard
number specified will be returned.</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_libtype">libtype</code></td>
<td>
<p>One of <code>NULL</code> (default), &quot;academic&quot;, &quot;public&quot;,
&quot;government&quot;, or &quot;other&quot;. <code>NULL</code> will return all
library subsets. The others will only search for holdings
from insitutions of that library type.</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_wskey">wskey</code></td>
<td>
<p>A WorldCat API key (default is <code>getOption("libbib.wskey")</code>)</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_print.progress">print.progress</code></td>
<td>
<p>A logical indicating whether a message should be
displayed for each API request. If <code>max_libraries</code>
is <code>TRUE</code> a message will be displayed for every
group of 100 institutions the function fetches.
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="worldcat_api_locations_by_+3A_debug">debug</code></td>
<td>
<p>A logical indicating whether the HTTP and API
responses should be printed (for debugging)
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numerous parameters are provided that change the API url
parameters. See parameter section for details on each.
</p>
<p>If something went wrong, most columns (especially the bibliographic
info columns) will be NA. You should always check the output.
</p>
<p>As with all API access functions in this package, it's up to the
user to limit their API usage so as to not get blocked. These
functions are deliberately not vectorized for this reason; they
only accept one standard number at a time.
</p>
<p>This (and other) WorldCat API communication functions require a
WorldCat API key. The easiest way to use these functions is to
set a global options with your key:
<code>options("libbib.wskey"="YOUR KEY HERE")</code>
</p>
<p>Final note: all of these API functions seem to work better with
OCLC numbers than any other standard number. If multiple standard
numbers are available, using the OCLC number is always preferred.
In this function, for example, searching for ISSN: 14664410
(Journal of Architecture) will (at time of writing) return only one
insitution, whereas searching by it's OCLC number (958283020) will
yield many more (660, at time of writing, with default parameters).
</p>


<h3>Value</h3>

<p>A <code>data.table</code> with each row corresponding to a holding library.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# worldcat_api_locations_by_oclc("877749545", max_libraries=10,
#                                include.bib.info=FALSE)
#         oclc institution_identifier
#       &lt;char&gt;                 &lt;char&gt;
# 1: 877749545                    NLE
# 2: 877749545                    NLW
# 3: 877749545                    EUM
# 4: 877749545                    LTU
# 5: 877749545                    ELU
# 6: 877749545                  UKUAL
#                                 institution_name copies
#                                           &lt;char&gt; &lt;char&gt;
# 1:                  National Library of Scotland      1
# 2:                     National Library of Wales      1
# 3:              University of Manchester Library      1
# 4: University of Leicester, David Wilson Library      1
# 5:     University of London Senate House Library      1
# 6:                 University of the Arts London      1


## End(Not run)

</code></pre>

<hr>
<h2 id='worldcat_api_search'>Use the WorldCat Search API</h2><span id='topic+worldcat_api_search'></span>

<h3>Description</h3>

<p>Searches WorldCat using a CQL query. Returns a <code>data.table</code>
containing the bibliographic metadata of the results, along
with the total number of results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldcat_api_search(
  sru,
  max_records = 10,
  sru_query_assist = getOption("libbib.sru_query_assist", TRUE),
  frbrGrouping = "on",
  start_at = 1,
  wskey = getOption("libbib.wskey", NULL),
  more = TRUE,
  print.progress = TRUE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="worldcat_api_search_+3A_sru">sru</code></td>
<td>
<p>The search query (in CQL syntax). See <code>examples</code> section
for some examples.</p>
</td></tr>
<tr><td><code id="worldcat_api_search_+3A_max_records">max_records</code></td>
<td>
<p>The maximum number of search results to return.
Must be a number between 0 and 100 or <code>Inf</code>.
If <code>Inf</code>, the function will
automatically make all follow-up requests to retrieve
all search results. For safety, the default is 10.</p>
</td></tr>
<tr><td><code id="worldcat_api_search_+3A_sru_query_assist">sru_query_assist</code></td>
<td>
<p>A logical indicating whether translation from
more human-readable aliases to the SRU search
index codes should be allowed. See details for
more information. (default is <code>TRUE</code>). You
can control this parameter globally by setting
<code>options("libbib.sru_query_assist")</code>.</p>
</td></tr>
<tr><td><code id="worldcat_api_search_+3A_frbrgrouping">frbrGrouping</code></td>
<td>
<p>With this parameter set to &quot;on&quot; (default),
an attempt is made by the WorldCat API to group
together similar editions and present only the top
held record as the representative record for that group.</p>
</td></tr>
<tr><td><code id="worldcat_api_search_+3A_start_at">start_at</code></td>
<td>
<p>The search result to start at (default is 1)</p>
</td></tr>
<tr><td><code id="worldcat_api_search_+3A_wskey">wskey</code></td>
<td>
<p>A WorldCat API key (default is <code>getOption("libbib.wskey")</code>)</p>
</td></tr>
<tr><td><code id="worldcat_api_search_+3A_more">more</code></td>
<td>
<p>A logical indicating whether more information from the MARCXML
search results should be returned (publisher, bib level, etc....).
(Default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="worldcat_api_search_+3A_print.progress">print.progress</code></td>
<td>
<p>A logical indicating whether a message should be
displayed for each API request. If <code>max_records</code>
is <code>Inf</code> a message will be displayed for every
group of 100 search results the function fetches.
(default is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="worldcat_api_search_+3A_debug">debug</code></td>
<td>
<p>A logical indicating whether the HTTP and API
responses should be printed (for debugging)
(default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is an entire vignette dedicated to this function; to view it,
execute <code>vignette("using-the-worldcat-search-api")</code>
</p>
<p>By default, this function allows for the usage of more human-readable
aliases to the arcane SRU search index codes. This allows you, for
example, to search using &quot;$title&quot; instead of &quot;srw.ti&quot;. This behavior is
controlled using the 'sru_query_assist' parameter. If it is <code>TRUE</code>
(the default) you can still use the formal search index codes. See
<code>vignette("using-the-worldcat-search-api")</code> for more information.
</p>
<p>As with all API access functions in this package, it's up to the
user to limit their API usage so as to not get blocked. These
functions are deliberately not vectorized for this reason; they
only accept one standard number at a time.
</p>
<p>This (and other) WorldCat API communication functions require a
WorldCat API key. The easiest way to use these functions is to
set a global options with your key:
<code>options("libbib.wskey"="YOUR KEY HERE")</code>
</p>


<h3>Value</h3>

<p>A <code>data.table</code> containing the bibliographic metadata of the
results, along with the total number of results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# A title search for "The Brothers Karamazov"
worldcat_api_search('$title = "Brothers Karamazov"')

# An exact title search for "The Brothers Karamazov"
worldcat_api_search('$title exact "Brothers Karamazov"')

# Search for title "Madame Bovary" by author "Gustave Flaubert"
# in language Greek (all results)
# (queries may span multiple lines)
sru &lt;- '$author = "Gustave Flaubert" and $title="Madame Bovary"
          and $language=greek'
worldcat_api_search(sru, max_records=Inf)

# Hip Hop (subject) materials on Cassette, CD, or wax from years 1987 to 1990
sru &lt;- '(($material_type=cas or $material_type=cda or $material_type=lps)
           and $subject="Rap") and $year="1987-1990"'
worldcat_api_search(sru)

# all materials with keyword "Common Lisp" at The New York Public Library
sru &lt;- '$keyword="common lisp" and $holding_library=NYP'
worldcat_api_search(sru, max_records=Inf)

# 19th century materials on ethics (Dewey code 170s / LC Call prefix BJ)
sru &lt;- '($dewey="17*" or $lc_call="bj*") and $year="18*"'
worldcat_api_search(sru, max_records=Inf)

# Music (Dewey 780s) materials that are only held by The New York Public
# Library (a "cg" code of 11 means there is only one holding)
# [searching with debugging]
sru &lt;- '$dewey="78*" and $holding_library=NYP
          and $library_holdings_group=11'
worldcat_api_search(sru, debug=TRUE)

Keyword search for "danger music" from year 2010 to present
worldcat_api_search('$keyword="danger music" and $year="2010-"')


## End(Not run)
</code></pre>

<hr>
<h2 id='worldcat_permalink_from_isbn'>Get WorldCat catalog permalinks from ISBNs</h2><span id='topic+worldcat_permalink_from_isbn'></span>

<h3>Description</h3>

<p>Takes a string representation of ISBNs. Returns permalinks
to the WorldCat catalog entries using those ISBNs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldcat_permalink_from_isbn(x, normalize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="worldcat_permalink_from_isbn_+3A_x">x</code></td>
<td>
<p>A string (or vector of strings) of ISBNs</p>
</td></tr>
<tr><td><code id="worldcat_permalink_from_isbn_+3A_normalize">normalize</code></td>
<td>
<p>a logical indicating whether the ISBNs should be
normalized prior to creating the permalink
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If normalize=TRUE and the ISBN is invalid, the permalink is NA.
If normalize=FALSE, the permalink may be invalid. No validity
check on the URL is performed
</p>


<h3>Value</h3>

<p>Worldcat permalinks using ISBNs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
worldcat_permalink_from_isbn("1788393724")
# http://www.worldcat.org/isbn/1788393724

worldcat_permalink_from_isbn("0-124-91540-X")
# http://www.worldcat.org/isbn/012491540X

worldcat_permalink_from_isbn("0-124-91540-X", normalize=FALSE)
# http://www.worldcat.org/isbn/0-124-91540-X

# vectorized
worldcat_permalink_from_isbn(c("1788393724", NA, "0-124-91540-X"))

</code></pre>

<hr>
<h2 id='worldcat_permalink_from_issn'>Get WorldCat catalog permalinks from ISSNs</h2><span id='topic+worldcat_permalink_from_issn'></span>

<h3>Description</h3>

<p>Takes a string representation of ISSNs. Returns permalinks
to the WorldCat catalog entries using those ISSNs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldcat_permalink_from_issn(x, normalize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="worldcat_permalink_from_issn_+3A_x">x</code></td>
<td>
<p>A string (or vector of strings) of ISSNs</p>
</td></tr>
<tr><td><code id="worldcat_permalink_from_issn_+3A_normalize">normalize</code></td>
<td>
<p>a logical indicating whether the ISSNs should be
normalized prior to creating the permalink
(default is <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If normalize=TRUE and the ISSN is invalid, the permalink is NA.
If normalize=FALSE, the permalink may be invalid. No validity
check on the URL is performed
</p>


<h3>Value</h3>

<p>Worldcat permalinks using ISSNs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>worldcat_permalink_from_issn("0968-1221")   # http://www.worldcat.org/issn/0968-1221

worldcat_permalink_from_issn("2434-561X")   # http://www.worldcat.org/issn/2434561X

# vectorized
worldcat_permalink_from_issn(c("0968-1221", NA, "2434-561X"))

</code></pre>

<hr>
<h2 id='worldcat_permalink_from_oclc_number'>Get WorldCat catalog permalinks from OCLC numbers</h2><span id='topic+worldcat_permalink_from_oclc_number'></span>

<h3>Description</h3>

<p>Takes a string representation of OCLC numbers. Returns permalinks
to the WorldCat catalog entries using those OCLC numbers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldcat_permalink_from_oclc_number(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="worldcat_permalink_from_oclc_number_+3A_x">x</code></td>
<td>
<p>A string (or vector of strings) of OCLC numbers</p>
</td></tr>
</table>


<h3>Details</h3>

<p>No validity check on the URL is performed
</p>


<h3>Value</h3>

<p>Worldcat permalinks using the OCLC numbers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
worldcat_permalink_from_oclc_number("1005106045")
# http://www.worldcat.org/oclc/1005106045

# vectorized
worldcat_permalink_from_oclc_number(c("1049727704", NA,
                                      "1005106045"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
