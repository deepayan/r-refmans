<!DOCTYPE html><html><head><title>Help for package ALSCPC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ALSCPC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ALS.CPC'><p>minimize the objective function <code class="reqn">\Phi(\bold{D})</code> by using of the accelerated line search algorithm</p></a></li>
<li><a href='#ALSCPC-package'><p>Accelerated line search algorithm for simultaneous orthogonal transformation of several positive definite symmetric  matrices to nearly diagonal form.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2013-09-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Accelerated line search algorithm for simultaneous orthogonal
transformation of several positive definite symmetric matrices
to nearly diagonal form.</td>
</tr>
<tr>
<td>Author:</td>
<td>Dariush Najarzadeh </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dariush Najarzadeh &lt;D_Najarzadeh@sbu.ac.ir&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Using of the accelerated line search algorithm  for simultaneously diagonalize a set of symmetric positive definite matrices.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2013-09-07 10:23:31 UTC; dariush</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2013-09-07 13:54:56</td>
</tr>
</table>
<hr>
<h2 id='ALS.CPC'>minimize the objective function <code class="reqn">\Phi(\bold{D})</code> by using of the accelerated line search algorithm</h2><span id='topic+ALS.CPC'></span>

<h3>Description</h3>

<p>The <code>ALS.CPC</code> function implement 
ALS algorithm based on the update formula
</p>
<p style="text-align: center;"><code class="reqn">\bold{D_{k+1}} = R_{\bold{D_k}} (-\beta^{m_k} \ \alpha  \ grad(\Phi (\bold{D}_k)))</code>
</p>

<p>until convergence (i.e. <code class="reqn">|\Phi(\bold{D}_k)-\Phi (\bold{D}_{k+1})| \le \epsilon</code>)
and return the orthogonal  matrix 
<code class="reqn">\bold{D}_r</code>, <code class="reqn">r</code> is the smallest nonnegative integer <code class="reqn">k</code> such that
<code class="reqn">|\Phi(\bold{D}_k)-\Phi (\bold{D}_{k+1})| \le \epsilon</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ALS.CPC(alpha,beta,sigma,epsilon,G,nval,D,S)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ALS.CPC_+3A_alpha">alpha</code></td>
<td>
<p>  positive real number.</p>
</td></tr>
<tr><td><code id="ALS.CPC_+3A_beta">beta</code></td>
<td>
<p>real number belong to (0,1).</p>
</td></tr>
<tr><td><code id="ALS.CPC_+3A_sigma">sigma</code></td>
<td>
<p>real number belong to (0,1).</p>
</td></tr>
<tr><td><code id="ALS.CPC_+3A_epsilon">epsilon</code></td>
<td>
<p>small positive constant controlling error term.</p>
</td></tr>
<tr><td><code id="ALS.CPC_+3A_g">G</code></td>
<td>
<p>number of groups in common principal components analysis.</p>
</td></tr>
<tr><td><code id="ALS.CPC_+3A_nval">nval</code></td>
<td>
<p>a numeric vector containing the positive integers of sample sizes minus one in each group.</p>
</td></tr>
<tr><td><code id="ALS.CPC_+3A_d">D</code></td>
<td>
<p>an initial  square orthogonal matrix of order <code>p</code>, where <code>p</code> is group dimensionality.</p>
</td></tr>
<tr><td><code id="ALS.CPC_+3A_s">S</code></td>
<td>
<p>a list of length <code>G</code> of positive definite symmetric matrices of order <code>p</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An orthogonal matrix  such that minimize <code class="reqn">\Phi(\bold{D})</code>.</p>


<h3>Author(s)</h3>

<p>Dariush Najarzadeh</p>


<h3>References</h3>

<p>Absil, P. A., Mahony, R., &amp; Sepulchre, R. (2009). Optimization algorithms on matrix manifolds. Princeton University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nval&lt;-numeric(3) 
nval[[1]]&lt;-49
nval[[2]]&lt;-49
nval[[3]]&lt;-49
S&lt;-vector("list",length=3)
setosa&lt;-iris[1:50,1:4]; names(setosa)&lt;-NULL
versicolor&lt;-iris[51:100,1:4]; names(versicolor)&lt;-NULL
virginica&lt;-iris[101:150,1:4]; names(virginica)&lt;-NULL
S[[1]]&lt;-as.matrix(var(versicolor))
S[[2]]&lt;-as.matrix(var(virginica))
S[[3]]&lt;-as.matrix(var(setosa))
D&lt;-diag(4)
ALS.CPC(10,0.5,0.4,1e-5,G=3,nval,D,S)
</code></pre>

<hr>
<h2 id='ALSCPC-package'>Accelerated line search algorithm for simultaneous orthogonal transformation of several positive definite symmetric  matrices to nearly diagonal form.</h2><span id='topic+ALSCPC-package'></span>

<h3>Description</h3>

<p>Let
</p>
<p style="text-align: center;"><code class="reqn">
\Phi (\bold{D}) = {\sum\limits_{i = 1}^G  {{n_i}} \ log{\left[ {{{\det (diag(\bold{D}'{\bold{S}_i}\bold{D}))}}} \right]}}
                 -{\sum\limits_{i = 1}^G  {{n_i}} \ log{\left[ {{{\det (\bold{D}'{\bold{S}_i}\bold{D})}}} \right]}}
</code>
</p>

<p>where <code class="reqn">G</code>  is a positive integer and called as the number of groups, 
<code class="reqn">{n_1}+1</code>, <code class="reqn">{n_2}+1</code>, ..., <code class="reqn">{n_G}+1</code> are  positive integers and called as the sample sizes,
<code class="reqn">\bold{D}</code> is an orthonormal matrix, and
<code class="reqn">\bold{S}_1</code>, <code class="reqn">\bold{S}_2</code>, ..., <code class="reqn">\bold{S}_G</code> are positive-definite and are usually sample covariance matrices.
The minimization of the objective function <code class="reqn">\Phi (\bold{D})\ge 0</code> that depends on
a orthonormal matrix <code class="reqn">\bold{D}</code>  is required for a potpourri of statistical problems. 
<code class="reqn">\Phi (\bold{D})= 0</code> means that <code class="reqn">\bold{S}_1</code>, <code class="reqn">\bold{S}_2</code>, ..., <code class="reqn">\bold{S}_G</code> are simultaneously simultaneously diagonalizable.
This situation is encountered when looking for common principal components, for example, and the
Flury and Gautschi (1986) method is a popular approach.
Lefkomtch (2004), Boik (2007), and Browne and McNicholas (2012) report that the Flury and Gautschi method is not effective for higher dimensional problems.
Browne and  McNicholas (2013) 
obtain several simple majorization-minizmation (MM) algorithms that provide solutions
to this problem and are effective in higher dimensions. They  compare these solutions
with each others in terms of convergence and computational time.
They found that the accelerated line search (ALS) algorithm  is a computationally efficient procedure  to this problem.
Extensive review of the this algorithm and similar algorithms can be found in Absil et al. (2008).
In the following, we briefly describe the ALS algorithm  used to minimize the objective function
<code class="reqn">\Phi (\bold{D})</code>. 
ALS algorithm  is based on the update formula
</p>
<p style="text-align: center;"><code class="reqn">\bold{D_{k+1}} = R_{\bold{D_k}} (-\beta^{m_k} \ \alpha  \ grad(\Phi (\bold{D}_k)))</code>
</p>
 
<p>where
<code class="reqn">R_{\bold{D_k}}(\bold{V}) = qf({\bold{D_k}} + \bold{V})</code>, where <code class="reqn">qf(\bold{M}) = \bold{Q}</code> in the sense of the
QR decomposition of a matrix <code class="reqn">\bold{M}</code>; 
The <code class="reqn">\bold{Q}\bold{R}</code> decomposition of a matrix
<code class="reqn">\bold{M}</code> is the decomposition of <code class="reqn">\bold{M} </code> as <code class="reqn">\bold{M}=\bold{Q}\bold{R}</code>, where  <code class="reqn">\bold{Q}</code> belongs  to the orthogonal group and
<code class="reqn">\bold{R}</code> belongs to  the set of all upper triangular matrices with strictly
positive diagonal elements, 
</p>
<p style="text-align: center;"><code class="reqn">
grad(\Phi(\bold{D}_k))=\overline{grad}(\Phi(\bold{D}_k))
-\bold{D}_k\left[\frac{\bold{D}'_k\ \overline{grad}(\Phi(\bold{D}_k))+\overline{grad}(\Phi(\bold{D}_k))' \bold{D}_k  }{2}\right] 
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\overline{grad}(\Phi(\bold{D}_k))=
{\sum\limits_{i = 1}^G  2{{n_i}}{\bold{S}'_i}{\bold{D}_k}
{\left[ {{{diag(\bold{D}'_k{\bold{S}_i}\bold{D}_k)}}} \right]^{-1}}},  
</code>
</p>

<p>and for <code class="reqn">\beta, \sigma \in (0,1)</code> and <code class="reqn">\alpha&gt;0</code>, <code class="reqn">m_k</code> 
is the smallest nonnegative integer <code class="reqn">m</code> such that
</p>
<p style="text-align: center;"><code class="reqn">
\Phi(\bold{D}_k)-\Phi (\bold{D}_{k+1}) \ge -\sigma &lt;grad(\Phi(\bold{D}_k)) \ , \ -\beta^{m} \ \alpha \ grad(\Phi(\bold{D}_k))&gt;
</code>
</p>

<p>where <code class="reqn">&lt; . \ , \ . &gt;</code> is the Frobenius inner product.
Starting from initial iterate <code class="reqn">\bold{D}_0</code>, for a given <code class="reqn">\epsilon &gt; 0</code>,  
we stop the algorithm when
</p>
<p style="text-align: center;"><code class="reqn">|\Phi(\bold{D}_k)-\Phi (\bold{D}_{k+1})| \le \epsilon.</code>
</p>



<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> ALSCPC</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-09-05</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
 


<h3>Author(s)</h3>

<p>Dariush Najarzadeh
</p>
<p>Maintainer: Dariush Najarzadeh &lt;D_Najarzadeh@sbu.ac.ir&gt;
</p>


<h3>References</h3>

<p>Absil, P. A., Mahony, R., &amp; Sepulchre, R. (2009). Optimization algorithms on matrix manifolds. Princeton University Press.
</p>
<p>Boik, R. J. (2007). Spectral models for covariance matrics. Biometrika, 89, 159-182.
</p>
<p>Browne, R. P., and McNicholas, P. D. (2012). Orthogonal Stiefel manifold optimization for eigen-decomposed covariance parameter estimation in mixture models. 
Statistics and Computing, 1-8.
</p>
<p>Browne, R. P., and  McNicholas, P. D. (2013). Estimating common principal components in high dimensions. arXiv preprint arXiv:1302.2102.
</p>
<p>Flury, B. N., and Gautschi, W. (1986). An algorithm for simultaneous orthogonal transformation
of several positive definite symmetric matrices to nearly diagonal form. 
SIAM Journal on Scientific and Statistical Computing, 7(1), 169-184.
</p>
<p>Lefkomtch, L. P. (2004). Consensus principal components. Biometrical Journal, 35, 567-580.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
