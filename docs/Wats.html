<!DOCTYPE html><html><head><title>Help for package Wats</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Wats}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#annotate_data'><p>Finds midpoints and bands for the within and between cycles.</p></a></li>
<li><a href='#augment_cycle_data'><p>Calculates variables necessary for WATS Plots</p></a></li>
<li><a href='#cartesian_periodic'><p>Linear Plot with Periodic Elements</p></a></li>
<li><a href='#cartesian_rolling'><p>Linear Plot with Rolling Summaries</p></a></li>
<li><a href='#county_month_birth_rate'><p>Monthly Growth Fertility Rates (GFR) for 12 urban Oklahoma counties</p></a></li>
<li><a href='#polar_periodic'><p>Polar Plot with Periodic Elements</p></a></li>
<li><a href='#polarize_cartesian'><p>Manipulate Cartesian data to use in the WATS polar plot</p></a></li>
<li><a href='#Wats-package'><p>Wrap Around Time Series graphics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Wrap Around Time Series Graphics</td>
</tr>
<tr>
<td>Description:</td>
<td>Wrap-around Time Series (WATS) plots for interrupted time series
    designs with seasonal patterns.
    Longitudinal trajectories are shown in both Cartesian and polar coordinates.
    In many scenarios, a WATS plot more clearly shows the existence and effect size of
    of an intervention.
    This package accompanies
    "Graphical Data Analysis on the Circle: Wrap-Around Time Series Plots for (Interrupted) Time Series Designs"
    by Rodgers, Beasley, &amp; Schuelke (2014)
    &lt;<a href="https://doi.org/10.1080%2F00273171.2014.946589">doi:10.1080/00273171.2014.946589</a>&gt;;
    see 'citation("Wats")' for details.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ouhscbbmc.github.io/Wats/">https://ouhscbbmc.github.io/Wats/</a>,
<a href="https://github.com/OuhscBbmc/Wats">https://github.com/OuhscBbmc/Wats</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/OuhscBbmc/Wats/issues">https://github.com/OuhscBbmc/Wats/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>colorspace, dplyr, ggplot2, grid, lubridate, RColorBrewer,
rlang, testit, tibble, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>boot, covr, devtools, knitr, scales, testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-10 14:43:45 UTC; wibeasley</td>
</tr>
<tr>
<td>Author:</td>
<td>Will Beasley <a href="https://orcid.org/0000-0002-5613-5006"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Joe Rodgers [aut],
  Matthew Schuelke [ctb],
  Ronnie Coleman [ctb],
  Mark Joseph Lachowicz [ctb],
  Oklahoma Shared Clinical and Translational Resource (OSCTR) [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Will Beasley &lt;wibeasley@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-10 22:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='annotate_data'>Finds midpoints and bands for the within and between cycles.</h2><span id='topic+annotate_data'></span>

<h3>Description</h3>

<p>Finds midpoints and bands for the within and between cycles.
This the second of two functions
that needs to be called to produce WATS Plots.  <code>AugmentZZZ</code> is the first.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annotate_data(
  ds_linear,
  dv_name,
  center_function,
  spread_function,
  cycle_tally_name = "cycle_tally",
  stage_id_name = "stage_id",
  stage_progress_name = "stage_progress",
  proportion_through_cycle_name = "proportion_through_cycle",
  proportion_id_name = "proportion_id",
  terminal_point_in_cycle_name = "terminal_point_in_cycle"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annotate_data_+3A_ds_linear">ds_linear</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the detailed data.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_dv_name">dv_name</code></td>
<td>
<p>The name of the dependent/criterion variable.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_center_function">center_function</code></td>
<td>
<p>A function to calculate the center of a subsample.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_spread_function">spread_function</code></td>
<td>
<p>A function to calculate the bands of a subsample.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_cycle_tally_name">cycle_tally_name</code></td>
<td>
<p>The variable name indicating how many cycles have been completed.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_stage_id_name">stage_id_name</code></td>
<td>
<p>The variable name indicating the stage.
In a typical interrupted time series, these values are
&quot;1&quot; before the interruption and &quot;2&quot; after.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_stage_progress_name">stage_progress_name</code></td>
<td>
<p>The variable name indicating the stage in a decimal form.
This is mostly for internal uses.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_proportion_through_cycle_name">proportion_through_cycle_name</code></td>
<td>
<p>The variable name indicating how far the point
is through a cycle.  For example, 0 degrees would be <code>0</code>,
180 degrees would be <code>0.5</code>, 359 degrees would be <code>0.9972</code>, and
360 degrees would be <code>0</code>.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_proportion_id_name">proportion_id_name</code></td>
<td>
<p>The variable name indicating the ordinal position through a cycle.</p>
</td></tr>
<tr><td><code id="annotate_data_+3A_terminal_point_in_cycle_name">terminal_point_in_cycle_name</code></td>
<td>
<p>The variable name indicating the last point
within a given cycle.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> with additional variables.
TODO: say what the variables are.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>system.time({
library(Wats)
ds_linear &lt;-
  Wats::county_month_birth_rate_2005_version |&gt;
  dplyr::filter(county_name == "oklahoma") |&gt;
  augment_year_data_with_month_resolution(date_name = "date")

h_spread &lt;- \(scores) { quantile(x = scores, probs = c(.25, .75)) }

portfolio &lt;- annotate_data(
  ds_linear       = ds_linear,
  dv_name         = "birth_rate",
  center_function = median,
  spread_function = h_spread
)
portfolio$ds_stage_cycle
portfolio$ds_linear
portfolio$ds_periodic
})
</code></pre>

<hr>
<h2 id='augment_cycle_data'>Calculates variables necessary for WATS Plots</h2><span id='topic+augment_cycle_data'></span><span id='topic+augment_year_data_with_month_resolution'></span><span id='topic+augment_year_data_with_second_resolution'></span>

<h3>Description</h3>

<p>Calculates variables necessary for WATS Plots.  This the first of two functions
that needs to be called to produce WATS Plots.  <code><a href="#topic+annotate_data">annotate_data()</a></code> is the second.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>augment_year_data_with_month_resolution(ds_linear, date_name)
augment_year_data_with_second_resolution(ds_linear, date_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="augment_cycle_data_+3A_ds_linear">ds_linear</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the detailed data.</p>
</td></tr>
<tr><td><code id="augment_cycle_data_+3A_date_name">date_name</code></td>
<td>
<p>The variable name in <code>ds_linear</code> containing the date or datetime value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <a href="tibble.html#topic+tibble">tibble::tibble</a> with additional variables:
<code>cycle_tally</code>, <code>proportion_through_cycle</code>, <code>proportion_id</code>, and <code>terminal_point_in_cycle</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Wats)
ds_linear &lt;-
  Wats::county_month_birth_rate_2005_version |&gt;
  dplyr::filter(county_name == "oklahoma") |&gt;
  augment_year_data_with_month_resolution(date_name = "date")

head(ds_linear)

</code></pre>

<hr>
<h2 id='cartesian_periodic'>Linear Plot with Periodic Elements</h2><span id='topic+cartesian_periodic'></span>

<h3>Description</h3>

<p>Shows the interrupted time series in Cartesian coordinates and
its a periodic/cyclic components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cartesian_periodic(
  ds_linear,
  ds_periodic,
  x_name,
  y_name,
  stage_id_name,
  periodic_lower_name = "position_lower",
  periodic_upper_name = "position_upper",
  palette_dark = NULL,
  palette_light = NULL,
  change_points = NULL,
  change_point_labels = NULL,
  draw_periodic_band = TRUE,
  jagged_point_size = 2,
  jagged_line_size = 0.5,
  band_alpha_dark = 0.4,
  band_alpha_light = 0.15,
  change_line_alpha = 0.5,
  change_line_size = 3,
  title = NULL,
  x_title = NULL,
  y_title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cartesian_periodic_+3A_ds_linear">ds_linear</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the simple linear data.
There should be one record per observation.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_ds_periodic">ds_periodic</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the reoccurring/periodic bands.
There should be one record per observation per stage.
If there are three stages, this <a href="base.html#topic+data.frame">data.frame</a> should have three times as many rows as
<code>ds_linear</code>.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_x_name">x_name</code></td>
<td>
<p>The variable name containing the date.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_y_name">y_name</code></td>
<td>
<p>The variable name containing the dependent/criterion variable.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_stage_id_name">stage_id_name</code></td>
<td>
<p>The variable name indicating which stage the record belongs to.
For example, before the first interruption, the <code>stage_id</code> is &quot;1&quot;, and is &quot;2&quot; afterwards.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_periodic_lower_name">periodic_lower_name</code></td>
<td>
<p>The variable name showing the lower bound
of a stage's periodic estimate.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_periodic_upper_name">periodic_upper_name</code></td>
<td>
<p>The variable name showing the upper bound
of a stage's periodic estimate.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_palette_dark">palette_dark</code></td>
<td>
<p>A vector of colors used for the dark/heavy graphical elements.
The vector should have one color for each <code>stage_id</code> value.  If no vector is specified,
a default will be chosen, based on the number of stages.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_palette_light">palette_light</code></td>
<td>
<p>A vector of colors used for the light graphical elements.
The vector should have one color for each <code>stage_id</code> value.  If no vector is specified,
a default will be chosen, based on the number of stages.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_change_points">change_points</code></td>
<td>
<p>A vector of values indicate the interruptions between stages.
It typically works best as a Date or a POSIXct class.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_change_point_labels">change_point_labels</code></td>
<td>
<p>The text plotted above each interruption.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_draw_periodic_band">draw_periodic_band</code></td>
<td>
<p>A boolean value indicating if the bands should be plotted
(whose values are take from the <code>periodic_lower_name</code> and <code>periodic_upper_name</code>).</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_jagged_point_size">jagged_point_size</code></td>
<td>
<p>The size of the observed data points.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_jagged_line_size">jagged_line_size</code></td>
<td>
<p>The size of the line connecting the observed data points.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_band_alpha_dark">band_alpha_dark</code></td>
<td>
<p>The amount of transparency of the band appropriate
for a stage's <em>x</em> values.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_band_alpha_light">band_alpha_light</code></td>
<td>
<p>The amount of transparency of the band comparison stages
for a given <em>x</em> value.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_change_line_alpha">change_line_alpha</code></td>
<td>
<p>The amount of transparency marking each interruption.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_change_line_size">change_line_size</code></td>
<td>
<p>The width of a line marking an interruption.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_title">title</code></td>
<td>
<p>The string describing the plot.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_x_title">x_title</code></td>
<td>
<p>The string describing the <em>x</em>-axis.</p>
</td></tr>
<tr><td><code id="cartesian_periodic_+3A_y_title">y_title</code></td>
<td>
<p>The string describing the <em>y</em>-axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a ggplot2 graphing object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Wats) # Load the package
change_month &lt;- base::as.Date("1996-02-15")
ds_linear &lt;-
  Wats::county_month_birth_rate_2005_version |&gt;
  dplyr::filter(county_name == "oklahoma") |&gt;
  augment_year_data_with_month_resolution(date_name = "date")

h_spread  &lt;- function(scores) { quantile(x = scores, probs = c(.25, .75)) }

portfolio &lt;- annotate_data(
  ds_linear,
  dv_name = "birth_rate",
  center_function = median,
  spread_function = h_spread
)

cartesian_periodic(
  portfolio$ds_linear,
  portfolio$ds_periodic,
  x_name               = "date",
  y_name               = "birth_rate",
  stage_id_name        = "stage_id",
  change_points        = change_month,
  change_point_labels  = "Bombing Effect"
)
</code></pre>

<hr>
<h2 id='cartesian_rolling'>Linear Plot with Rolling Summaries</h2><span id='topic+cartesian_rolling'></span>

<h3>Description</h3>

<p>Shows the interrupted time series in Cartesian coordinates
without a periodic/cyclic components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cartesian_rolling(
  ds_linear,
  x_name,
  y_name,
  stage_id_name,
  rolling_lower_name = "rolling_lower",
  rolling_center_name = "rolling_center",
  rolling_upper_name = "rolling_upper",
  palette_dark = NULL,
  palette_light = NULL,
  color_sparse = grDevices::adjustcolor("tan1", 0.5),
  change_points = NULL,
  change_point_labels = NULL,
  draw_jagged_line = TRUE,
  draw_rolling_line = TRUE,
  draw_rolling_band = TRUE,
  draw_sparse_line_and_points = TRUE,
  jagged_point_size = 2,
  jagged_line_size = 0.5,
  rolling_line_size = 1,
  sparse_point_size = 4,
  sparse_line_size = 0.5,
  band_alpha = 0.4,
  change_line_alpha = 0.5,
  change_line_size = 3,
  title = NULL,
  x_title = NULL,
  y_title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cartesian_rolling_+3A_ds_linear">ds_linear</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the data.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_x_name">x_name</code></td>
<td>
<p>The variable name containing the date.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_y_name">y_name</code></td>
<td>
<p>The variable name containing the dependent/criterion variable.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_stage_id_name">stage_id_name</code></td>
<td>
<p>The variable name indicating which stage the record belongs to.
For example, before the first interruption, the <code>stage_id</code> is &quot;1&quot;, and is &quot;2&quot; afterwards.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_rolling_lower_name">rolling_lower_name</code></td>
<td>
<p>The variable name showing the lower bound of the rolling estimate.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_rolling_center_name">rolling_center_name</code></td>
<td>
<p>The variable name showing the rolling estimate.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_rolling_upper_name">rolling_upper_name</code></td>
<td>
<p>The variable name showing the upper bound of the rolling estimate.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_palette_dark">palette_dark</code></td>
<td>
<p>A vector of colors used for the dark/heavy graphical elements.
The vector should have one color for each <code>stage_id</code> value.
If no vector is specified, a default will be chosen, based on the number of stages.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_palette_light">palette_light</code></td>
<td>
<p>A vector of colors used for the light graphical elements.
The vector should have one color for each <code>stage_id</code> value.
If no vector is specified, a default will be chosen, based on the number of stages.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_color_sparse">color_sparse</code></td>
<td>
<p>The color of the 'slowest' trend line,
which plots only one value per cycle.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_change_points">change_points</code></td>
<td>
<p>A vector of values indicate the interruptions between stages.
It typically works best as a Date or a POSIXct class.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_change_point_labels">change_point_labels</code></td>
<td>
<p>The text plotted above each interruption.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_draw_jagged_line">draw_jagged_line</code></td>
<td>
<p>A boolean value indicating if a line should be plotted
that connects the observed data points.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_draw_rolling_line">draw_rolling_line</code></td>
<td>
<p>A boolean value indicating if a line should be plotted
that connects the rolling estimates specified by <code>rolling_center_name</code>.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_draw_rolling_band">draw_rolling_band</code></td>
<td>
<p>A boolean value indicating if a band should be plotted
that envelopes the rolling estimates (whose values are take from the
<code>rolling_lower_name</code> and <code>rolling_upper_name</code>.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_draw_sparse_line_and_points">draw_sparse_line_and_points</code></td>
<td>
<p>A boolean value indicating if the sparse line and
points should be plotted.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_jagged_point_size">jagged_point_size</code></td>
<td>
<p>The size of the observed data points.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_jagged_line_size">jagged_line_size</code></td>
<td>
<p>The size of the line connecting the observed data points.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_rolling_line_size">rolling_line_size</code></td>
<td>
<p>The size of the line connecting the rolling estimates.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_sparse_point_size">sparse_point_size</code></td>
<td>
<p>The size of the sparse estimates.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_sparse_line_size">sparse_line_size</code></td>
<td>
<p>The size of the line connecting the sparse estimates.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_band_alpha">band_alpha</code></td>
<td>
<p>The amount of transparency of the rolling estimate band.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_change_line_alpha">change_line_alpha</code></td>
<td>
<p>The amount of transparency marking each interruption.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_change_line_size">change_line_size</code></td>
<td>
<p>The width of a line marking an interruption.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_title">title</code></td>
<td>
<p>The string describing the plot.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_x_title">x_title</code></td>
<td>
<p>The string describing the <em>x</em>-axis.</p>
</td></tr>
<tr><td><code id="cartesian_rolling_+3A_y_title">y_title</code></td>
<td>
<p>The string describing the <em>y</em>-axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a ggplot2 graphing object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Wats) # Load the package
change_month &lt;- base::as.Date("1996-02-15")
ds_linear &lt;-
  Wats::county_month_birth_rate_2005_version |&gt;
  dplyr::filter(county_name == "oklahoma") |&gt;
  augment_year_data_with_month_resolution(date_name = "date")

h_spread     &lt;- function(scores) { quantile(x = scores, probs = c(.25, .75)) }

portfolio &lt;- annotate_data(
  ds_linear,
  dv_name         = "birth_rate",
  center_function = median,
  spread_function = h_spread
)

cartesian_rolling(
  portfolio$ds_linear,
  x_name               = "date",
  y_name               = "birth_rate",
  stage_id_name        = "stage_id",
  change_points        = change_month,
  change_point_labels  = "Bombing Effect"
)
</code></pre>

<hr>
<h2 id='county_month_birth_rate'>Monthly Growth Fertility Rates (GFR) for 12 urban Oklahoma counties</h2><span id='topic+county_month_birth_rate'></span><span id='topic+county_month_birth_rate_2005_version'></span><span id='topic+county_month_birth_rate_2014_version'></span>

<h3>Description</h3>

<p>Monthly Growth Fertility Rates (GFR) for 12 urban counties in Oklahoma
between January 1990 and December 1999.
The GFR is defined as the number of births divided
by the number of females (ages 15-44), multiplied by 1,000.
</p>
<p>There are two datasets in this package that are almost identical.
The 2014 version is better suited for substantive researchers
in the areas of fertility and traumatic cultural events.
The 2005 version recreates the 2005 article
and, therefore is better suited for the graphical aims of the 2014 manuscript.
</p>
<p>The difference is that the 2005 version uses constant estimate for a county population
&ndash;specifically the US Census 1990 estimates.  The 2014 version uses different estimates
for each month &ndash;specifically the US intercensal annual estimates, with linear interpolation
for February through December of each year.
</p>


<h3>Format</h3>

<p>A data frame with 1,440 observations on the following 11 variables.
</p>

<dl>
<dt>fips</dt><dd><p>The county's 5-digit value according to the Federal Information Processing Standards.  <code>integer</code></p>
</dd>
<dt>county_name</dt><dd><p>The lower case name of the county. <code>character</code></p>
</dd>
<dt>year</dt><dd><p>The year of the record, ranging from 1990 to 1999. <code>integer</code></p>
</dd>
<dt>month</dt><dd><p>The month of the record, ranging from 1 to 12. <code>integer</code></p>
</dd>
<dt>fecund_population</dt><dd><p>The number of females in the county, ages of
15 to 44. <code>numeric</code></p>
</dd>
<dt>birth_count</dt><dd><p>The number of births in a county for the given month.
<code>integer</code></p>
</dd>
<dt>date</dt><dd><p>The year and month of the record, with a date of the 15th.
Centering the date within the month makes the value a little more representative
and the graphs a little easier. <code>date</code></p>
</dd>
<dt>days_in_month</dt><dd><p>The number of days in the specific month. <code>integer</code></p>
</dd>
<dt>days_in_year</dt><dd><p>The number of days in the specific years <code>integer</code></p>
</dd>
<dt>stage_id</dt><dd><p>The &quot;Stage&quot; of the month.  The pre-bombing records are &quot;1&quot;
(accounting for 9 months of gestation); the post-bombing months are &quot;2&quot;. <code>integer</code></p>
</dd>
<dt>birth_rate</dt><dd><p>The Growth Fertility Rate (GFR). <code>numeric</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>&lt;&lt;Joe, can you please finish/edit this sentence?&gt;&gt;
The monthly birth counts were copied from county records by Ronnie Coleman during the
summer of 2001 from state vital statistics records.  It was collected
for <a href="https://pubmed.ncbi.nlm.nih.gov/16463916/">Rodgers, St. John, &amp; Coleman (2005)</a>.
</p>
<p>The US Census' intercensal estimates are used for the January values of
<code>fecund_population</code>.  Values for February-December are interpolated using
<code><a href="stats.html#topic+approx">approx()</a></code>.
</p>
<p>The datasets were manipulated to produce this data frame by the two R files
<a href="https://github.com/OuhscBbmc/Wats/blob/main/utility/isolate-census-pops-for-gfr.R">isolate-census-pops-for-gfr.R</a>
and <a href="https://github.com/OuhscBbmc/Wats/blob/main/utility/calculate-gfr.R">calculate-gfr.R</a>.
</p>


<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>


<ul>
<li><p> Rodgers, J. L., St. John, C. A. &amp; Coleman R. (2005).
<a href="https://pubmed.ncbi.nlm.nih.gov/16463916/">Did Fertility Go Up after the Oklahoma City Bombing? An Analysis of Births in Metropolitan Counties in Oklahoma, 1990-1999.</a>
<em>Demography, 42</em>, 675-692.
</p>
</li>
<li> <p><a href="https://www.census.gov/data/tables/time-series/demo/popest/intercensal-1990-2000-state-and-county-totals.html">Intercensal estimates for 199x</a>
</p>
</li>
<li> <p><a href="https://www.census.gov/data/datasets/time-series/demo/popest/intercensal-2000-2010-counties.html">Intercensal estimates for 200x</a>
</p>
</li>
<li><p> Documentation: <a href="https://www.census.gov/programs-surveys/popest/technical-documentation/file-layouts.html">US Census Intercensal Estimates</a>
for <a href="https://www.census.gov/programs-surveys/popest/technical-documentation/file-layouts/1990-2000-intercensal.html">199x</a>
and <a href="https://www.census.gov/programs-surveys/popest/technical-documentation/file-layouts/2000-2010-intercensal.html">200x</a>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# 2005 Version (see description above)
ds2005 &lt;- county_month_birth_rate_2005_version
ggplot(ds2005, aes(x = date, y = birth_rate, color = factor(fips))) +
  geom_line() +
  labs(title="County Fertility - Longitudinal")

ggplot(ds2005, aes(x = birth_rate, color = factor(fips))) +
  geom_density() +
  labs(title="Distributions of County Fertility")


# 2014 Version (see description above)
ds2014 &lt;- county_month_birth_rate_2014_version
ggplot(ds2014, aes(x = date, y = birth_rate, color = factor(fips))) +
  geom_line() +
  labs(title="County Fertility - Longitudinal")

ggplot(ds2014, aes(x = birth_rate, color = factor(fips))) +
  geom_density() +
  labs(title="Distributions of County Fertility")

</code></pre>

<hr>
<h2 id='polar_periodic'>Polar Plot with Periodic Elements</h2><span id='topic+polar_periodic'></span>

<h3>Description</h3>

<p>Shows the interrupted time series in Cartesian coordinates and its a periodic/cyclic components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polar_periodic(
  ds_linear,
  ds_stage_cycle_polar,
  x_name,
  y_name,
  stage_id_name,
  periodic_lower_name = "position_lower",
  periodic_upper_name = "position_upper",
  palette_dark = NULL,
  palette_light = NULL,
  change_points = NULL,
  change_point_labels = NULL,
  draw_observed_line = TRUE,
  draw_periodic_band = TRUE,
  draw_stage_labels = FALSE,
  draw_radius_labels = FALSE,
  jagged_point_size = 2,
  jagged_line_size = 1,
  band_alpha_dark = 0.4,
  band_alpha_light = 0.15,
  color_labels = "gray50",
  color_gridlines = "gray80",
  label_color = "orange3",
  change_line_alpha = 0.5,
  change_line_size = 3,
  tick_locations = base::pretty(x = ds_linear[[y_name]]),
  graph_floor = min(tick_locations),
  graph_ceiling = max(tick_locations),
  cardinal_labels = NULL,
  origin_label = paste0("The origin represents ", graph_floor,
    ";\nthe perimeter represents ", graph_ceiling, "."),
  plot_margins = c(3.5, 2, 0.5, 2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polar_periodic_+3A_ds_linear">ds_linear</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the simple linear data.  There should be one record per observation.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_ds_stage_cycle_polar">ds_stage_cycle_polar</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the bands for a single period.
There should be one record per theta per stage.  If there are three stages,
this <a href="base.html#topic+data.frame">data.frame</a> should have three times as many rows as <code>ds_linear</code>.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_x_name">x_name</code></td>
<td>
<p>The variable name containing the date.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_y_name">y_name</code></td>
<td>
<p>The variable name containing the dependent/criterion variable.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_stage_id_name">stage_id_name</code></td>
<td>
<p>The variable name indicating which stage the record belongs to.
For example, before the first interruption, the <code>stage_id</code> is &quot;1&quot;, and is &quot;2&quot; afterwards.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_periodic_lower_name">periodic_lower_name</code></td>
<td>
<p>The variable name showing the lower bound of a stage's periodic estimate.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_periodic_upper_name">periodic_upper_name</code></td>
<td>
<p>The variable name showing the upper bound of a stage's periodic estimate.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_palette_dark">palette_dark</code></td>
<td>
<p>A vector of colors used for the dark/heavy graphical elements.
The vector should have one color for each <code>stage_id</code> value.
If no vector is specified, a default will be chosen, based on the number of stages.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_palette_light">palette_light</code></td>
<td>
<p>A vector of colors used for the light graphical elements.
The vector should have one color for each <code>stage_id</code> value.
If no vector is specified, a default will be chosen, based on the number of stages.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_change_points">change_points</code></td>
<td>
<p>A vector of values indicate the interruptions between stages.
It typically works best as a Date or a POSIXct class.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_change_point_labels">change_point_labels</code></td>
<td>
<p>The text plotted above each interruption.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_draw_observed_line">draw_observed_line</code></td>
<td>
<p>A boolean value indicating
if the longitudinal observed line should be plotted (whose values are take from <code>ds_linear</code>).</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_draw_periodic_band">draw_periodic_band</code></td>
<td>
<p>A boolean value indicating
if the bands should be plotted (whose values are take from the <code>periodic_lower_name</code> and <code>periodic_upper_name</code> fields).</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_draw_stage_labels">draw_stage_labels</code></td>
<td>
<p>A boolean value indicating
if the stage labels should be plotted (whose values are take from <code>ds_linear</code>).</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_draw_radius_labels">draw_radius_labels</code></td>
<td>
<p>A boolean value indicating
if the gridline/radius labels should be plotted (whose values are take from <code>tick_locations</code>).</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_jagged_point_size">jagged_point_size</code></td>
<td>
<p>The size of the observed data points.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_jagged_line_size">jagged_line_size</code></td>
<td>
<p>The size of the line connecting the observed data points.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_band_alpha_dark">band_alpha_dark</code></td>
<td>
<p>The amount of transparency of the band appropriate for a stage's <em>x</em> values.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_band_alpha_light">band_alpha_light</code></td>
<td>
<p>The amount of transparency of the band comparison stages for a given <em>x</em> value.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_color_labels">color_labels</code></td>
<td>
<p>The color for <code>cardinal_labels</code> and <code>origin_label</code>.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_color_gridlines">color_gridlines</code></td>
<td>
<p>The color for the gridlines.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_label_color">label_color</code></td>
<td>
<p>The color of the text labels imposed on the line.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_change_line_alpha">change_line_alpha</code></td>
<td>
<p>The amount of transparency marking each interruption.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_change_line_size">change_line_size</code></td>
<td>
<p>The width of a line marking an interruption.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_tick_locations">tick_locations</code></td>
<td>
<p>The desired locations for ticks showing the value of the criterion/dependent variable.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_graph_floor">graph_floor</code></td>
<td>
<p>The value of the criterion/dependent variable at the center of the polar plot.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_graph_ceiling">graph_ceiling</code></td>
<td>
<p>The value of the criterion/dependent variable at the outside of the polar plot.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_cardinal_labels">cardinal_labels</code></td>
<td>
<p>The four labels placed  where &quot;North&quot;, &quot;East&quot;, &quot;South&quot;, and &quot;West&quot; typically are.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_origin_label">origin_label</code></td>
<td>
<p>Explains what the criterion variable's value is at the origin.
Use <code>NULL</code> if no explanation is desired.</p>
</td></tr>
<tr><td><code id="polar_periodic_+3A_plot_margins">plot_margins</code></td>
<td>
<p>A vector of four <code>numeric</code> values, specifying the number of lines in the
bottom, left, top and right margins.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a grid graphical object (<em>i.e.</em>, a <code><a href="grid.html#topic+grid.grob">grid::grob()</a></code>.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>requireNamespace("grid")
library(Wats)
ds_linear &lt;-
  Wats::county_month_birth_rate_2005_version |&gt;
  dplyr::filter(county_name == "oklahoma") |&gt;
  augment_year_data_with_month_resolution(date_name = "date")

h_spread &lt;- function(scores) { quantile(x = scores, probs = c(.25, .75)) }
portfolio &lt;- annotate_data(
  ds_linear       = ds_linear,
  dv_name         = "birth_rate",
  center_function = median,
  spread_function = h_spread
)
rm(ds_linear)

polarized &lt;- polarize_cartesian(
  portfolio$ds_linear,
  portfolio$ds_stage_cycle,
  y_name        = "birth_rate",
  stage_id_name = "stage_id"
)

grid::grid.newpage()
polar_periodic(
  ds_linear             = polarized$ds_observed_polar,
  ds_stage_cycle_polar  = polarized$ds_stage_cycle_polar,
  y_name                = "radius",
  stage_id_name         = "stage_id",
  cardinal_labels       = c("Jan1", "Apr1", "July1", "Oct1")
)

grid::grid.newpage()
polar_periodic(
  ds_linear              = polarized$ds_observed_polar,
  ds_stage_cycle_polar   = polarized$ds_stage_cycle_polar,
  y_name                 = "radius",
  stage_id_name          = "stage_id",
  draw_periodic_band     = FALSE
)

grid::grid.newpage()
polar_periodic(
  ds_linear            = polarized$ds_observed_polar,
  ds_stage_cycle_polar = polarized$ds_stage_cycle_polar,
  y_name               = "radius",
  stage_id_name        = "stage_id",
  draw_observed_line   = FALSE,
  cardinal_labels      = c("Jan1", "Apr1", "July1", "Oct1")
)
</code></pre>

<hr>
<h2 id='polarize_cartesian'>Manipulate Cartesian data to use in the WATS polar plot</h2><span id='topic+polarize_cartesian'></span>

<h3>Description</h3>

<p>Three operations are performed.
First, within each stage, the first row is repeated at the end, to close the loop.
Second, multiple points are interpolated (still in a Cartesian coordinates)
so that the polar graph doesn't have sharp edges.
These sharp edges would be artifacts of the conversion, and not reflect the observed data.
Third, the Cartesian points are converted to polar coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polarize_cartesian(
  ds_linear,
  ds_stage_cycle,
  y_name,
  stage_id_name,
  cycle_tally_name = "cycle_tally",
  proportion_through_cycle_name = "proportion_through_cycle",
  periodic_lower_name = "position_lower",
  periodic_center_name = "position_center",
  periodic_upper_name = "position_upper",
  plotted_point_count_per_cycle = 120,
  graph_floor = min(base::pretty(ds_linear[[y_name]]))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polarize_cartesian_+3A_ds_linear">ds_linear</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the simple linear data.
There should be one record per observation.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_ds_stage_cycle">ds_stage_cycle</code></td>
<td>
<p>The <a href="base.html#topic+data.frame">data.frame</a> to containing the reoccurring/periodic bands.
There should be one record per observation per stage.
If there are three stages, this <a href="tibble.html#topic+tibble">tibble::tibble</a> should have three times as many rows as <code>ds_linear</code>.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_y_name">y_name</code></td>
<td>
<p>The variable name containing the dependent/criterion variable.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_stage_id_name">stage_id_name</code></td>
<td>
<p>The variable name indicating which stage the record belongs to.
For example, before the first interruption, the <code>stage_id</code> is &quot;1&quot;, and is &quot;2&quot; afterwards.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_cycle_tally_name">cycle_tally_name</code></td>
<td>
<p>The variable name indicating how many <em>complete</em> cycles have occurred at that observation.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_proportion_through_cycle_name">proportion_through_cycle_name</code></td>
<td>
<p>The variable name showing how far
through a cycle the observation (or summarized observations) occurred.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_periodic_lower_name">periodic_lower_name</code></td>
<td>
<p>The variable name showing the lower bound of a stage's periodic estimate.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_periodic_center_name">periodic_center_name</code></td>
<td>
<p>The variable name showing the center estimate of a stage's periodic estimate.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_periodic_upper_name">periodic_upper_name</code></td>
<td>
<p>The variable name showing the upper bound of a stage's periodic estimate.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_plotted_point_count_per_cycle">plotted_point_count_per_cycle</code></td>
<td>
<p>The number of points that are plotted per cycle.
If the polar graph has 'sharp corners', then increase this value.</p>
</td></tr>
<tr><td><code id="polarize_cartesian_+3A_graph_floor">graph_floor</code></td>
<td>
<p>The value of the criterion/dependent variable at the center of the polar plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <a href="tibble.html#topic+tibble">tibble::tibble</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Wats)
ds_linear &lt;-
  Wats::county_month_birth_rate_2005_version |&gt;
  dplyr::filter(county_name == "oklahoma") |&gt;
  augment_year_data_with_month_resolution(date_name = "date")

h_spread &lt;- function(scores) { quantile(x = scores, probs = c(.25, .75)) }
portfolio &lt;- annotate_data(
  ds_linear        = ds_linear,
  dv_name          = "birth_rate",
  center_function  = median,
  spread_function  = h_spread
)
rm(ds_linear)

polarized &lt;- polarize_cartesian(
  ds_linear      = portfolio$ds_linear,
  ds_stage_cycle = portfolio$ds_stage_cycle,
  y_name         = "birth_rate",
  stage_id_name  = "stage_id"
)

library(ggplot2)
polarized$ds_stage_cycle_polar |&gt;
  ggplot(aes(color = factor(stage_id))) +
  geom_path(aes(x = polar_lower_x , y = polar_lower_y), linetype = 2) +
  geom_path(aes(x = polar_center_x, y = polar_center_y), linewidth = 2) +
  geom_path(aes(x = polar_upper_x , y = polar_upper_y), linetype = 2) +
  geom_path(aes(x = observed_x    , y = observed_y), data = polarized$ds_observed_polar) +
  coord_fixed(ratio = 1) +
  guides(color = NULL)
</code></pre>

<hr>
<h2 id='Wats-package'>Wrap Around Time Series graphics</h2><span id='topic+Wats-package'></span><span id='topic+Wats'></span>

<h3>Description</h3>

<p>Wrap-around Time Series (WATS) Plots for Interrupted Time Series Designs with Seasonal Patterns
</p>


<h3>Note</h3>

<p>The release version is available through
<a href="https://cran.r-project.org/package=Wats">CRAN</a> by
running <code>install.packages('Wats')</code>.
The most recent development version is available through
<a href="https://github.com/OuhscBbmc/Wats">GitHub</a> by running
<code>remotes::install_github("OuhscBbmc/Wats")</code>.
(make sure <a href="https://cran.r-project.org/package=remotes">remotes</a> is already installed).
If you're having trouble with the package, please install the development version.
If this doesn't solve your problem,
please create an <a href="https://github.com/OuhscBbmc/Wats/issues">issue</a>,
or email Will.
</p>
<p><strong>Funding</strong>
Continued development and maintenance of this package supported by the
Oklahoma Shared Clinical and Translational Resources (<a href="https://osctr.ouhsc.edu/">OSCTR</a>,
U54GM104938) with an Institutional Development Award (IDeA) from NIGMS.
The content is solely the responsibility of the authors and does not necessarily represent
the official views of the National Institutes of Health.
</p>


<h3>Author(s)</h3>

<p><a href="http://scholar.google.com/citations?user=ffsJTC0AAAAJ">William Howard Beasley</a>
&ndash;Associate Professor of Research,
<a href="https://ouhsc.edu/bbmc/team/">University of Oklahoma Health Sciences Center</a>,
<a href="https://medicine.ouhsc.edu/academic-departments/pediatrics">Dept of Pediatrics</a>,
Biomedical and Behavioral Methodology Core (<a href="http://ouhsc.edu/bbmc/">BBMC</a>)
</p>
<p><a href="https://www.vanderbilt.edu/psychological_sciences/bio/joe-rodgers">Joseph Lee Rodgers</a>
&ndash;Director, Quantitative Methods, Department of Psychology and Human Development,
Peabody College, 230 Appleton Pl #552, Hobbs 202C,
Vanderbilt University, Nashville, TN 37203.
</p>
<p><a href="https://www.slu.edu/medicine/health-and-clinical-outcomes-research/faculty/schuelke-matt.php">Matthew Schuelke</a>
&ndash;Senior Statistician, Office of the Vice President for Research
Saint Louis University
</p>


<h3>References</h3>

<p>Rodgers, J.L., Beasley, W.H., and Schuelke, M. (2014).
<a href="https://www.tandfonline.com/doi/abs/10.1080/00273171.2014.946589">Graphical Data Analysis on the Circle:  Wrap-around Time Series Plots for (Interrupted) Time Series Designs.</a>
<em>Multivariate Behavioral Research</em>.
</p>
<p>Rodgers, J.L., St. John, C. A. &amp; Coleman R. (2005).
<a href="https://pubmed.ncbi.nlm.nih.gov/16463916/">Did Fertility Go Up after the Oklahoma City Bombing?  An Analysis of Births in Metropolitan Counties in Oklahoma, 1990-1999.</a>
<em>Demography, 42</em>, 675-692.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
