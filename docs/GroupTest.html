<!DOCTYPE html><html><head><title>Help for package GroupTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GroupTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GroupTest-package'>
<p>Multiple Hypothesis Testing Procedure for the Grouped Hypotheses</p></a></li>
<li><a href='#AYP'><p> AYP of California, 2013</p></a></li>
<li><a href='#GroupTest_simulate'>
<p>Simulated data set to demonstrate the package</p></a></li>
<li><a href='#GT.decision'>
<p>Between- and within-group decisions</p></a></li>
<li><a href='#GT.em'>
<p>EM Algorithm</p></a></li>
<li><a href='#GT.localfdr'>
<p>Between and within group local fdr scores</p></a></li>
<li><a href='#GT.wrapper'>
<p>Multiple testing procedure for the grouped hypothesis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiple Testing Procedure for Grouped Hypotheses</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-11-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhigen Zhao</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhigen Zhao &lt;zhaozhg@temple.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions for a two-stage multiple testing procedure for grouped hypothesis, aiming at controlling both the total posterior false discovery rate and within-group false discovery rate. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-11-26 12:38:17 UTC; zhaozhg</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-11-26 14:25:49</td>
</tr>
</table>
<hr>
<h2 id='GroupTest-package'>
Multiple Hypothesis Testing Procedure for the Grouped Hypotheses
</h2><span id='topic+GroupTest-package'></span><span id='topic+GroupTest'></span>

<h3>Description</h3>

<p>This package provides functions for the multiple hypotheses testing when
there exists group structures. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> GroupTest</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-11-20</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package provides functions for multiple testing for the grouped
hypotheses. The data is an array of list with G list where G is the
total number of groups. Each list within this array corresponds to a
group, with the test statistic and the group size as its two
elements. Under the null hypotheses, the test statistic follows a
standard normal distribution.
</p>
<p>The main function is GT.wrapper(). One example is provided
under this function, explaining the data structure and how to use the package.
</p>


<h3>Author(s)</h3>

<p>Zhigen Zhao &lt;zhaozhg@temple.edu&gt;
</p>
<p>Maintainer: Zhigen Zhao &lt;zhaozhg@temple.edu&gt;
</p>


<h3>References</h3>

<p>Liu, Y., Sarkar, S. K., and Zhao, Z. (2015) A New Approach to
Multiple Testing of Grouped
Hypotheses
</p>
<p>He, L., Sarkar, S. K. and Zhao, Z. (2015) Capturing the severity of Type
II errors in high-dimensional multiple testing. Journal of Multivariate
Analysis. Vol. 142, 106-116. 
</p>

<hr>
<h2 id='AYP'> AYP of California, 2013
</h2><span id='topic+AYP'></span>

<h3>Description</h3>

<p>This data set is adequate yearly progress (AYP) study of California
elementary schools in 2013 comparing the academic performance for
socioeconomically advantaged (SEA) against socioeconomically
disadvantaged (SED) students in the elementary schools. 
What is compared are the success rates of SEA students and SED
students. The z-test statistic based two sample proportions test is
cacluated for each schools. After removing schools with extremely
small or large z-values, there are 4118 schools within 701 qualified
school districts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("AYP")</code></pre>


<h3>Format</h3>

<p>An array of lists.
</p>


<h3>Details</h3>

<p>AYP data set is an array of lists, with each list corresponding to one
school district. In each list, three variables are stored:
</p>
<p>X: the test statistic for each individual schools within this
school district.
</p>
<p>md:  the number of schools within this school district.
</p>
<p>School.District: the name of the school district.
</p>


<h3>Source</h3>

<p><a href="http://www.cde.ca.gov/ta/ac/ay/aypdatafiles.asp">http://www.cde.ca.gov/ta/ac/ay/aypdatafiles.asp</a>
</p>


<h3>References</h3>

<p>Liu, Y., Sarkar, S. K., and Zhao, Z. (2015) A New Approach to
Multiple Testing of Grouped
Hypotheses
</p>
<p>Efron, B. (2008) Microarrays, empirical bayes and the two-groups
model. Statisitcal Science, 23, 1-22.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AYP)

AYP.result &lt;- GT.wrapper( AYP, alpha=0.1, eta=alpha, pi1.ini=0.5,
pi2.1.ini=0.05, L=2, muL.ini=c(3,-2), sigmaL.ini=c(1,1),
cL.ini=c(0.5,0.5), DELTA=0.0001, sigma.KNOWN=TRUE )
</code></pre>

<hr>
<h2 id='GroupTest_simulate'>
Simulated data set to demonstrate the package
</h2><span id='topic+GroupTest_simulate'></span>

<h3>Description</h3>

<p>Simulated data set to demonstrate the package. In this data set,
there are three groups. There are 3, 4, and 5 hypotheses
respectively among the groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GroupTest_simulate")</code></pre>


<h3>Format</h3>

<p>An array of lists.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GroupTest_simulate)

GT.test &lt;- GT.wrapper( GroupTest_simulate, alpha=0.05, eta=alpha,
pi1.ini=0.7, pi2.1.ini=0.4, L=2, muL.ini=c(-1,1), sigmaL.ini=c(1,2),
cL.ini=c(0.4,0.6), DELTA=0.001, sigma.KNOWN=FALSE )

</code></pre>

<hr>
<h2 id='GT.decision'>
Between- and within-group decisions
</h2><span id='topic+GT.decision'></span>

<h3>Description</h3>

<p>Based on the <code class="reqn">\alpha</code>-level and the the local fdr scores, this
function provides the decision on between- and within-group levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GT.decision(TestStatistic, alpha = 0.05, eta = alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GT.decision_+3A_teststatistic">TestStatistic</code></td>
<td>
<p> An array of list. Each list of the array
corresponds to one group, containing the test statistic, stored as
X, and the group size, stored as mg. </p>
</td></tr>
<tr><td><code id="GT.decision_+3A_alpha">alpha</code></td>
<td>
<p> the targeted FDR level.</p>
</td></tr>
<tr><td><code id="GT.decision_+3A_eta">eta</code></td>
<td>
<p> the targeted FDR level within each group. The default and
recommended choice is alpha.</p>
</td></tr>  
</table>


<h3>Value</h3>

<table>
<tr><td><code>TestStatistic</code></td>
<td>
<p> An array of list. Each list of the array
corresponds to one group, two additional varialbes: within.group.rej
and between.group.rej are stored in each list.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(GroupTest_simulate)
GroupTest_simulate &lt;- GT.localfdr( GroupTest_simulate, L=2, pi1=0.5, pi2.1=0.5,
muL=c(-1, 1), sigmaL=c(1,2), cL=c(0.4,0.6) )

GroupTest.decision &lt;- GT.decision(GroupTest_simulate, alpha=0.05)
</code></pre>

<hr>
<h2 id='GT.em'>
EM Algorithm
</h2><span id='topic+GT.em'></span>

<h3>Description</h3>

<p>This function estimates all the parameters using the EM algorithm. The
iteration is termined when the sum of squared difference of the
current updated values and the previous values of the parameters is
less than DELTA. A list consisting of all the estimated values of the
parameters is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GT.em(TestStatistic, pi1.ini, pi2.1.ini, L, muL.ini, sigmaL.ini, cL.ini,
DELTA, sigma.KNOWN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GT.em_+3A_teststatistic">TestStatistic</code></td>
<td>
<p> An array of list. Each list of the array
corresponds to one group, containing the test statistic, stored as
X, and the group size, stored as mg.
</p>
</td></tr>
<tr><td><code id="GT.em_+3A_l">L</code></td>
<td>
<p> The number of Gaussian component under the alternative
hypothesis.
</p>
</td></tr>
<tr><td><code id="GT.em_+3A_pi1.ini">pi1.ini</code></td>
<td>
<p> Initial value: the probability that a group is significant.
</p>
</td></tr>
<tr><td><code id="GT.em_+3A_pi2.1.ini">pi2.1.ini</code></td>
<td>
<p> Initial value: the probability that an individual null hypothesis
is false given that the group is significant.
</p>
</td></tr>
<tr><td><code id="GT.em_+3A_mul.ini">muL.ini</code></td>
<td>
<p> Initial value: a vector of means for all the components of the
Gaussian mixture. 
</p>
</td></tr>
<tr><td><code id="GT.em_+3A_sigmal.ini">sigmaL.ini</code></td>
<td>
<p> Initial value: a vector of standard deviation of all the
components of the Gaussian mixture.
</p>
</td></tr>
<tr><td><code id="GT.em_+3A_cl.ini">cL.ini</code></td>
<td>
<p> Initial value: a vector of the probability for all the
components of the Gaussian mixture.
</p>
</td></tr>
<tr><td><code id="GT.em_+3A_delta">DELTA</code></td>
<td>
<p> The criteria to stop the EM algorithm.
</p>
</td></tr>
<tr><td><code id="GT.em_+3A_sigma.known">sigma.KNOWN</code></td>
<td>
<p> The boolean variable, indicating whether the
variance is known.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function return a list, consisting of the estimated values of all
the parameters. The variables within this list are shown as following:
</p>
<table>
<tr><td><code>pi1</code></td>
<td>
<p> estimated value of <code class="reqn">\pi_1</code>, the proportion of a
group being significant</p>
</td></tr>
<tr><td><code>pi2.1</code></td>
<td>
<p> estimated value of <code class="reqn">\pi_{2|1}</code>, the proportion of a
null hypothesis being false within a significant group.</p>
</td></tr>
<tr><td><code>muL</code></td>
<td>
<p>a vector of estimated means for all the components of the
Gaussian mixture</p>
</td></tr>
<tr><td><code>sigmaL</code></td>
<td>
<p> a vector of estimated standard deviation of all the
components of the Gaussian mixture</p>
</td></tr>
<tr><td><code>cL</code></td>
<td>
<p>a vector of the probability for all the components of the
Gaussian mixture</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p> the number of components in the Gaussian mixture</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(GroupTest_simulate)
em.estimate &lt;- GT.em( GroupTest_simulate, L=2, pi1.ini=0.7, pi2.1.ini=0.4,
muL.ini=c(-1,1), sigmaL.ini=c(1,2), cL.ini=c(0.4,0.6), DELTA=0.001,
sigma.KNOWN=FALSE )
</code></pre>

<hr>
<h2 id='GT.localfdr'>
Between and within group local fdr scores
</h2><span id='topic+GT.localfdr'></span>

<h3>Description</h3>

<p>This function calculate the between-group and within-group
local fdr scores for a given set of all the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GT.localfdr(TestStatistic, pi1, pi2.1, L, muL, sigmaL, cL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GT.localfdr_+3A_teststatistic">TestStatistic</code></td>
<td>
<p> An array of list. Each element of the array
corresponds to one group, containing the test statistic, stored
as X, and the group size, stored as mg.
</p>
</td></tr>
<tr><td><code id="GT.localfdr_+3A_l">L</code></td>
<td>
<p> The number of Gaussian component under the alternative
hypothesis.
</p>
</td></tr>
<tr><td><code id="GT.localfdr_+3A_pi1">pi1</code></td>
<td>
 <p><code class="reqn">\pi_1</code>, the probability that a group is significant.
</p>
</td></tr>
<tr><td><code id="GT.localfdr_+3A_pi2.1">pi2.1</code></td>
<td>
 <p><code class="reqn">\pi_{2|1}</code>, the probability that an individual
null hypothesis is false given that the group is significant.
</p>
</td></tr>
<tr><td><code id="GT.localfdr_+3A_mul">muL</code></td>
<td>
<p> a vector of means for all the components of the
Gaussian mixture. 
</p>
</td></tr>
<tr><td><code id="GT.localfdr_+3A_sigmal">sigmaL</code></td>
<td>
<p> a vector of standard deviation of all the
components of the Gaussian mixture.
</p>
</td></tr>
<tr><td><code id="GT.localfdr_+3A_cl">cL</code></td>
<td>
<p> a vector of the probability for all the components of
the Gaussian mixture.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns an array of G lists where G is the number
of groups.
</p>
<table>
<tr><td><code>TSGroupTest[[g]]</code></td>
<td>
<p> in each element, the individual
conditional local fdr score (<code class="reqn"> P(\theta_{gj}=0|x,
      \theta_{g}=1)</code>), the group-wise local fdr score
(<code class="reqn">P(\theta_g=0|x)</code>), are stored.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(GroupTest_simulate)
GroupTest_simulate &lt;- GT.localfdr( GroupTest_simulate, L=2, pi1=0.5,
    pi2.1=0.5, muL=c(-1, 1), sigmaL=c(1,2), cL=c(0.4,0.6) )
</code></pre>

<hr>
<h2 id='GT.wrapper'>
Multiple testing procedure for the grouped hypothesis
</h2><span id='topic+GT.wrapper'></span>

<h3>Description</h3>

<p>This function is the main function to perform the two-stage testing
for the grouped hypotheses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GT.wrapper(TestStatistic, alpha = 0.05, eta = alpha, pi1.ini = 0.7,
pi2.1.ini = 0.4, L = 2, muL.ini = c(-1, 1), sigmaL.ini = c(1, 1),
cL.ini = c(0.5, 0.5), DELTA = 0.001, sigma.KNOWN=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GT.wrapper_+3A_teststatistic">TestStatistic</code></td>
<td>
<p> An array of list. Each list of the array
corresponds to one group, containing the test statistic, stored
as X, and the group size, stored as mg.
</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_alpha">alpha</code></td>
<td>
<p> the targeted FDR level. By default, it is chosen as 0.05.</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_eta">eta</code></td>
<td>
<p> the targeted FDR level within each group. The default and
recommended choice is alpha. By default, it is chosen as <code class="reqn">\alpha</code>.</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_pi1.ini">pi1.ini</code></td>
<td>
<p> Initial value: the probability that a group is
significant. By default, it is chosen as 0.7
</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_pi2.1.ini">pi2.1.ini</code></td>
<td>
<p> Initial value: the probability that an individual
null hypothesis is false given that the group is significant. By
default, it is chosen as 0.4.
</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_l">L</code></td>
<td>
<p> The number of Gaussian component under the alternative
hypothesis. By default, it is chosen as 2.
</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_mul.ini">muL.ini</code></td>
<td>
<p> Initial value: a vector of means for all the
components of the Gaussian mixture. By default, is is chosen as -1
and 1.
</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_sigmal.ini">sigmaL.ini</code></td>
<td>
<p> Initial value: a vector of standard deviation of
all the components of the Gaussian mixture. By default, it is chosen
as 1 and 1.
</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_cl.ini">cL.ini</code></td>
<td>
<p> Initial value: a vector of the probability for all the
components of the Gaussian mixture. By default, it is chosen as 50% and 50%.
</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_delta">DELTA</code></td>
<td>
<p> The criteria to stop the EM algorithm. In this
algorithm, we calcualte the maximum of absolution difference of the
current estiamted value and its previous value for the
parameters. By default, it is chosen as 0.0001.
</p>
</td></tr>
<tr><td><code id="GT.wrapper_+3A_sigma.known">sigma.KNOWN</code></td>
<td>
<p> The boolean variable, indicating whether the
variance is known. Be default, it is chosen as FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a TSGroupTest object. It contains
</p>
<table>
<tr><td><code>parameter</code></td>
<td>
<p> this is a list, consisting of estimated parameters
based on the EM algorithm. The elements are <code class="reqn">\pi_1</code>,
<code class="reqn">\pi_{2|1}</code>, <code class="reqn">c_l</code>, <code class="reqn">\mu_l</code>, <code class="reqn">\sigma_l</code>.</p>
</td></tr>
<tr><td><code>TSGroupTest[[g]]</code></td>
<td>
<p> all the quntities regarding the g-th group,
including the test statistic within this group, the individual
conditional local fdr score (<code class="reqn"> P(\theta_{gj}=0|x,
      \theta_{g}=1)</code>), the group-wise local fdr score
(<code class="reqn">P(\theta_g=0|x)</code>), between-group decision, within-group decision</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(GroupTest_simulate)

GT.Test &lt;- GT.wrapper( GroupTest_simulate, alpha=0.05, eta=alpha,
pi1.ini=0.7, pi2.1.ini=0.4, L=2, muL.ini=c(-1,1), sigmaL.ini=c(1,2),
cL.ini=c(0.4,0.6), DELTA=0.001, sigma.KNOWN=FALSE )

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
