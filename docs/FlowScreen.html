<!DOCTYPE html><html><head><title>Help for package FlowScreen</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FlowScreen}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#axis_doy.internal'><p>Create custom axis starting on hyrologic year start month</p></a></li>
<li><a href='#bf_boughton'><p>Boughton recursive digital filter</p></a></li>
<li><a href='#bf_eckhardt'><p>Eckhardt two parameter recursive digital filter</p></a></li>
<li><a href='#bf_oneparam'><p>One parameter recursive digital filter</p></a></li>
<li><a href='#bf.seas'><p>Seasonal baseflow percentage</p></a></li>
<li><a href='#bf.stats'><p>Baseflow statistics</p></a></li>
<li><a href='#cania.sub.ts'><p>Subset of the Caniapiscau River Daily Flows</p></a></li>
<li><a href='#caniapiscau'><p>Caniapiscau River Daily Flows</p></a></li>
<li><a href='#caniapiscau.res'><p>Screening results for the Caniapiscau River</p></a></li>
<li><a href='#create.ts'><p>Create a Time Series of daily streamflow observations</p></a></li>
<li><a href='#dr.events'><p>Partial Duration Series and Event Statistics for streamflow droughts</p></a></li>
<li><a href='#dr.pds'><p>Get the partial duration series for streamflow droughts</p></a></li>
<li><a href='#dr.seas'><p>Find the start, middle, end, and duration of seasonal droughts</p></a></li>
<li><a href='#FDC'><p>Flow Duration Curve</p></a></li>
<li><a href='#FlowScreen'>
<p>Screen Daily Discharge Time Series for Temporal Trends and Change Points</p></a></li>
<li><a href='#get.station.internal'><p>Get station information for USGS or WSC hydrometric stations</p></a></li>
<li><a href='#get.titles.internal'><p>Returns plot titles and labels based on plot type and language preference</p></a></li>
<li><a href='#hyear.internal'><p>Add hydrologic Year, month, and doy columns to a daily time series</p></a></li>
<li><a href='#MAMn'><p>Calculate mean annual minimum n-day flows</p></a></li>
<li><a href='#metrics.all'><p>Streamflow metrics</p></a></li>
<li><a href='#mqt'><p>Moving quantile threshold</p></a></li>
<li><a href='#NA.runs'><p>Missing data runs for daily time series.</p></a></li>
<li><a href='#NA.sum'><p>Sum missing data points from a daily time series</p></a></li>
<li><a href='#pk.bf.stats'><p>Calculate baseflow peak statistics</p></a></li>
<li><a href='#pk.cov'><p>Center of Volume</p></a></li>
<li><a href='#pk.max'><p>Annual maximum series</p></a></li>
<li><a href='#pk.max.doy'><p>Day of year for annual maximum series</p></a></li>
<li><a href='#pks'><p>Get the flow peaks over a threshold</p></a></li>
<li><a href='#pks.dur'><p>Calculate the inter-event duration</p></a></li>
<li><a href='#Qn'><p>Calculate flow quantiles</p></a></li>
<li><a href='#read.flows'><p>Read .csv or .Rdata file of streamflows</p></a></li>
<li><a href='#regime'><p>Plot flow regime</p></a></li>
<li><a href='#screen.cpts'><p>Change point time series plot</p></a></li>
<li><a href='#screen.frames'><p>Plot one or more frames from the summary screening plot</p></a></li>
<li><a href='#screen.frames.internal'><p>Internal wrapper for creating trend and change-point plots</p></a></li>
<li><a href='#screen.metric'><p>Plot a metric with trend and change points</p></a></li>
<li><a href='#screen.series'><p>Create a plot of the daily streamflow time series</p></a></li>
<li><a href='#screen.summary'><p>Create a screening plot</p></a></li>
<li><a href='#screen.summary.internal'><p>Internal wrapper for creating trend and change-point summary plots</p></a></li>
<li><a href='#station.info'><p>Retrieve Station Info</p></a></li>
<li><a href='#YMD.internal'><p>Add calendar year, month, and day of year columns</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Daily Streamflow Trend and Change Point Screening</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Screens daily streamflow time series for temporal trends and
    change-points. This package has been primarily developed for assessing the
    quality of daily streamflow time series. It also contains tools for plotting
    and calculating many different streamflow metrics. The package can be used to
    produce summary screening plots showing change-points and significant temporal
    trends for high flow, low flow, and/or baseflow statistics, or it can be used
    to perform more detailed hydrological time series analyses. The package was
    designed for screening daily streamflow time series from Water Survey Canada
    and the United States Geological Survey but will also work with streamflow time
    series from many other agencies.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>zyp, changepoint, evir, graphics, grDevices, stats, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-05 15:51:07 UTC; Jen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jennifer Dierauer &lt;jen.r.brand@gmail.com&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Jennifer Dierauer [aut, cre],
  Paul Whitfield [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-05 16:12:52 UTC</td>
</tr>
</table>
<hr>
<h2 id='axis_doy.internal'>Create custom axis starting on hyrologic year start month</h2><span id='topic+axis_doy.internal'></span>

<h3>Description</h3>

<p>Create custom axis starting on hyrologic year start month
</p>


<h3>Usage</h3>

<pre><code class='language-R'>axis_doy.internal(hyrstart = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="axis_doy.internal_+3A_hyrstart">hyrstart</code></td>
<td>
<p>numeric indicating month for start of the hydrologic year 
(water year).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>

<hr>
<h2 id='bf_boughton'>Boughton recursive digital filter</h2><span id='topic+bf_boughton'></span>

<h3>Description</h3>

<p>This function estimates baseflow
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf_boughton(discharge, k, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bf_boughton_+3A_discharge">discharge</code></td>
<td>
<p>Nnumeric vector of daily flow data</p>
</td></tr>
<tr><td><code id="bf_boughton_+3A_k">k</code></td>
<td>
<p>Numeric value of the recession constant (dimensionless).</p>
</td></tr>
<tr><td><code id="bf_boughton_+3A_c">C</code></td>
<td>
<p>Numeric value of the partitioning factor (dimensionless).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector of the estimated baseflow.
</p>


<h3>Author(s)</h3>

<p>Paul H. Whitfield
</p>


<h3>References</h3>

<p>Boughton, WC. 1993. A hydrograph-based model for estimating the 
water yield of ungauged catchments.In Hydrology and Water Resources Symposium,
Institution of Engineers Australia, Newcastle, NSW; 317-324.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res &lt;- bf_boughton(cania.sub.ts$Flow, k=0.9, C=0.1)
plot(cania.sub.ts$Date, cania.sub.ts$Flow, xlab="", ylab="Q (m3/s)", type="l")
points(cania.sub.ts$Date, res, type="l", col="blue")
</code></pre>

<hr>
<h2 id='bf_eckhardt'>Eckhardt two parameter recursive digital filter</h2><span id='topic+bf_eckhardt'></span>

<h3>Description</h3>

<p>This function takes vector of discharge data and estimates the baseflow
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf_eckhardt(discharge, a, BFI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bf_eckhardt_+3A_discharge">discharge</code></td>
<td>
<p>vector of daily discharge observations</p>
</td></tr>
<tr><td><code id="bf_eckhardt_+3A_a">a</code></td>
<td>
<p>Numeric value.</p>
</td></tr>
<tr><td><code id="bf_eckhardt_+3A_bfi">BFI</code></td>
<td>
<p>Numeric value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Eckhardt, K. 2012. Technical note: Analytical sensitivity analysis 
of two parameter recursive digital baseflow separation filter. Hydrology and
Earth System Sciences 16: 451-455.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
bf &lt;- bf_eckhardt(cania.sub.ts$Flow, 0.97, 0.8)
plot(cania.sub.ts$Date, cania.sub.ts$Flow, type="l")
points(cania.sub.ts$Date, bf, type="l", col="blue")
</code></pre>

<hr>
<h2 id='bf_oneparam'>One parameter recursive digital filter</h2><span id='topic+bf_oneparam'></span>

<h3>Description</h3>

<p>This function estimates baseflow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf_oneparam(discharge, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bf_oneparam_+3A_discharge">discharge</code></td>
<td>
<p>Numeric vector of daily flow data</p>
</td></tr>
<tr><td><code id="bf_oneparam_+3A_k">k</code></td>
<td>
<p>Numeric value for the recession constant (dimensionless).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector of the estimated baseflow.
</p>


<h3>Author(s)</h3>

<p>Paul H. Whitfield
</p>


<h3>References</h3>

<p>Eckhardt, K. 2005. How to construct recursive digital filters
for baseflow separation methods. Journal of Hydrology 352: 168-173.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res &lt;- bf_oneparam(cania.sub.ts$Flow, k=0.9)
plot(cania.sub.ts$Date, cania.sub.ts$Flow, xlab="", ylab="Q (m3/s)", type="l")
points(cania.sub.ts$Date, res, type="l", col="blue")
</code></pre>

<hr>
<h2 id='bf.seas'>Seasonal baseflow percentage</h2><span id='topic+bf.seas'></span>

<h3>Description</h3>

<p>This function estimates the percentage of baseflow in a given period relative to the total
annual baseflow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf.seas(TS, seas = c(6:8))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bf.seas_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="bf.seas_+3A_seas">seas</code></td>
<td>
<p>Integers representing months of the year. Default is c(6:8), i.e. June-August.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls <code><a href="#topic+bf_eckhardt">bf_eckhardt</a></code> to complete the 
baseflow separation.
</p>


<h3>Value</h3>

<p>Returns a vector containing the calculated percentage for each year
in the input time series.  The &quot;times&quot; attribute provides the corresponding
year for each calculated value.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+bf.stats">bf.stats</a></code> to calculate additional baseflow metrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res &lt;- bf.seas(cania.sub.ts)
res2 &lt;- screen.metric(res, "Percent Annual Baseflow in Jun-Aug")
</code></pre>

<hr>
<h2 id='bf.stats'>Baseflow statistics</h2><span id='topic+bf.stats'></span>

<h3>Description</h3>

<p>This function estimates the baseflow and calculates the mean, max, and min
baseflow and baseflow index for a user defined time period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf.stats(TS, by = "hyear")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bf.stats_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="bf.stats_+3A_by">by</code></td>
<td>
<p>summary period.  Options are &quot;year&quot;, &quot;hyear&quot;, &quot;month&quot;, or &quot;doy&quot;.
Default is &quot;hyear&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls <code><a href="#topic+bf_eckhardt">bf_eckhardt</a></code> to complete the 
baseflow separation.
</p>


<h3>Value</h3>

<p>Returns a data.frame with the following columns:
</p>

<ul>
<li><p> By - Unique values representing the summary periods, e.g. a list of
unique years, months, or days of year 
</p>
</li>
<li><p> MeanQ - Mean daily streamflow for the summary period, in m3/s 
</p>
</li>
<li><p> MeanBF - Mean daily baseflow for the summary period, in m3/s 
</p>
</li>
<li><p> MaxBF - Maximum daily baseflow for the summary period, in m3/s 
</p>
</li>
<li><p> MinBF - Minimum daily baseflow for the summary period, in m3/s 
</p>
</li>
<li><p> BFVol - Baseflow volume for the summary period, in km3 
</p>
</li>
<li><p> MeanBFI - Mean daily baseflow index for the summary period, dimensionless 
</p>
</li>
<li><p> MaxBFI - Maximum daily baseflow index for the summary period, dimensionless 
</p>
</li>
<li><p> MinBFI - Minimum daily baseflow index for the summary period, dimensionless 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)

res &lt;- bf.stats(cania.sub.ts)
res2 &lt;- screen.metric(res[,2], "m3/s")
</code></pre>

<hr>
<h2 id='cania.sub.ts'>Subset of the Caniapiscau River Daily Flows</h2><span id='topic+cania.sub.ts'></span>

<h3>Description</h3>

<p>This data set includes a subset of the mean daily streamflow 
for the Caniapiscau Rivers. It includes observations from 1970-1995
(hydrologic years). The code used to subset and modify the original
data is shown below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(caniapiscau)
</code></pre>


<h3>Format</h3>

<p>Formatted as a data.frame with the following columns:
</p>

<ul>
<li><p> ID - Water Survey Canada Station ID
</p>
</li>
<li><p> Date - Date of observation, formatted as YYYY-mm-dd
</p>
</li>
<li><p> Flow - Mean daily streamflow, measured in m3/s
</p>
</li>
<li><p> Code - Data Quality Code
</p>
</li>
<li><p> Agency - Source Agency (Water Survey Canada)
</p>
</li>
<li><p> Year - Calendar year
</p>
</li>
<li><p> month - Calendar month
</p>
</li>
<li><p> doy - Calendar day of year
</p>
</li>
<li><p> hyear - Hydrologic year
</p>
</li>
<li><p> hmonth - Hydrologic month
</p>
</li>
<li><p> hdoy - Hydrologic day of year
</p>
</li></ul>


<h3>Source</h3>

<p>Environment Canada. 2010. EC Data Explorer V1.2.30. <br />
Water Survey of Canada V1.2.30 https://www.ec.gc.ca/rhc-wsc/
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Code used to subset and modify original Caniapiscau series:
## Not run: 
data(caniapiscau)
cania.ts &lt;- create.ts(caniapiscau, hyrstart=3)
cania.sub.ts &lt;- subset(cania.ts, cania.ts$hyear %in% c(1970:1995))

## End(Not run)
# example use of example subset flow series
data(cania.sub.ts)
head(cania.sub.ts)
str(cania.sub.ts)
</code></pre>

<hr>
<h2 id='caniapiscau'>Caniapiscau River Daily Flows</h2><span id='topic+caniapiscau'></span>

<h3>Description</h3>

<p>This data set includes the mean daily streamflow for the Caniapiscau
River. The file has been read from the original .csv format using  
<code><a href="#topic+read.flows">read.flows</a></code>. The Caniapiscau River is located in Nunavik, Quebec,
Canada, and flows northward. The headwaters (representing 45 percent of the 
total flow) were dammed to create the Caniapiscau Reservoir, which started 
filling in 1981. In 1985, the reservoir was diverted to the west into the 
La Grande hydroelectric complex.
This flow time series is used as an example of a river with a known 
change point to demonstrate the package's screening capabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(caniapiscau)
</code></pre>


<h3>Format</h3>

<p>Formatted as a data.frame with the following columns:
</p>

<ul>
<li><p> ID - Water Survey Canada Station ID
</p>
</li>
<li><p> PARAM - Parameter ID (1 indicates flow)
</p>
</li>
<li><p> Date - Date of observation, formatted as YYYY-mm-dd
</p>
</li>
<li><p> Flow - Mean daily streamflow, measured in m3/s
</p>
</li>
<li><p> Agency - Source Agency (Water Survey Canada)
</p>
</li></ul>


<h3>Source</h3>

<p>Environment Canada. 2010. EC Data Explorer V1.2.30. <br />
Water Survey of Canada V1.2.30 https://www.ec.gc.ca/rhc-wsc/
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(caniapiscau)
head(caniapiscau)
str(caniapiscau)
</code></pre>

<hr>
<h2 id='caniapiscau.res'>Screening results for the Caniapiscau River</h2><span id='topic+caniapiscau.res'></span>

<h3>Description</h3>

<p>Contains the results from <code><a href="#topic+metrics.all">metrics.all</a></code> for the full
Caniapiscau River daily flow series. Data set created as indicated below.  This 
data set is used in the example documentation for the <code><a href="#topic+screen.frames">screen.frames</a></code>, 
<code><a href="#topic+screen.summary">screen.summary</a></code>, and <code><a href="#topic+screen.cpts">screen.cpts</a></code> functions in order to 
reduce example run times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(caniapiscau)
</code></pre>


<h3>Format</h3>

<p>Formatted as indicated in the documentation for <code><a href="#topic+metrics.all">metrics.all</a></code></p>


<h3>Source</h3>

<p>Original flow series from Environment Canada. 2010. EC Data Explorer V1.2.30. <br />
Water Survey of Canada V1.2.30 https://www.ec.gc.ca/rhc-wsc/
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Code used produce this data set:
## Not run: 
data(caniapiscau)
caniapiscau.ts &lt;- create.ts(caniapiscau, hyrstart=3)
caniapiscau.ts &lt;- subset(caniapiscau.ts, caniapiscau.ts$hyear &gt; 1962)
caniapiscau.res &lt;- metrics.all(caniapiscau.ts)

## End(Not run)
# example use of example subset flow series
data(caniapiscau.res)
</code></pre>

<hr>
<h2 id='create.ts'>Create a Time Series of daily streamflow observations</h2><span id='topic+create.ts'></span>

<h3>Description</h3>

<p>This function creates a daily time series formatted
for use with the functions in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.ts(Flows, hyrstart = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.ts_+3A_flows">Flows</code></td>
<td>
<p>Data.frame containing daily streamflow time series loaded
with the <code><a href="#topic+read.flows">read.flows</a></code> function.</p>
</td></tr>
<tr><td><code id="create.ts_+3A_hyrstart">hyrstart</code></td>
<td>
<p>define start month of hydrologic year. Defaults to 10 (October).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame with year, month, doy, and hyear columns 
appended to the original input data.frame.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(caniapiscau)
# subset flow series for shorter example run time
caniapiscau.sub &lt;- caniapiscau[300:1800,]
caniapiscau.sub.ts &lt;- create.ts(caniapiscau.sub)
</code></pre>

<hr>
<h2 id='dr.events'>Partial Duration Series and Event Statistics for streamflow droughts</h2><span id='topic+dr.events'></span>

<h3>Description</h3>

<p>This function extracts the partial duration series for all streamflow droughts based
on a moving window quantile threshold.  Also returns summary information (start date,
end date, duration, deficit volume) for each drought event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dr.events(TS, Qdr = 0.2, WinSize = 30, IntEventDur = 10, EventDur = 15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dr.events_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="dr.events_+3A_qdr">Qdr</code></td>
<td>
<p>Numeric value of the drought threshold quantile.  Default is 0.2.</p>
</td></tr>
<tr><td><code id="dr.events_+3A_winsize">WinSize</code></td>
<td>
<p>Numeric value specifying the size of the moving window in
days.  Default is 30.</p>
</td></tr>
<tr><td><code id="dr.events_+3A_inteventdur">IntEventDur</code></td>
<td>
<p>Numeric value for the minimum inter-event duration in days. Drought
events with less than the specified number of days between will be pooled 
and considered as one event.</p>
</td></tr>
<tr><td><code id="dr.events_+3A_eventdur">EventDur</code></td>
<td>
<p>Numeric value for the minimum drought duration in days. Default
is 15.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<p>DroughtEvents: A data.frame with the following columns:
</p>

<ul>
<li><p> Event - Integer indicating the original event number assigned before
minor drought events were removed.
</p>
</li>
<li><p> Start - Date of the start of the drought event.
</p>
</li>
<li><p> End - Date of the end of the drought event
</p>
</li>
<li><p> maxDef - Numeric value of the maximum streamflow deficit.
</p>
</li>
<li><p> Severity - Numeric value indicating the drought severity, 
calculated as the cumulative daily streamflow deficit in m3/s.
</p>
</li>
<li><p> Duration - Numeric value of the drought duration in days.
</p>
</li>
<li><p> Magnitude - Numeric value indicating the drought magnitude, which 
is calculated as the mean daily streamflow deficit in m3/s.
</p>
</li>
<li><p> stdtotDef - Numeric value indicating the standardized cumulative
streamflow deficit, calculated as the drought severity divided by
the mean annual daily streamflow.
</p>
</li></ul>

<p>DroughtPDS: A data.frame of the original input TS that has been subset to 
include only the days on which the streamflow was below the drought threshold.
The data.frame also has the following columns appended:
</p>

<ul>
<li><p> Thresh - Numeric value indicating the streamflow drought threshold,
as calculated by <code><a href="#topic+mqt">mqt</a></code>
</p>
</li>
<li><p> BelowThresh - Logical indicating whether the observed streamflow 
was below the streamflow drought threshold.
</p>
</li>
<li><p> Def - Numeric value of the streamflow defict, calculated as the 
streamflow drought threshold (m3/s) minus the observed streamflow (m3/s).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+dr.seas">dr.seas</a></code> to calculate metrics for droughts 
occurring in a user-defined season.
</p>
<p>This function calls <code><a href="#topic+dr.pds">dr.pds</a></code> which calls <code><a href="#topic+mqt">mqt</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res1 &lt;- dr.events(cania.sub.ts)
events &lt;- res1$DroughtEvents
plot(events$Start, events$Duration, pch=19, ylab="Drought Duration (days)", xlab="")
</code></pre>

<hr>
<h2 id='dr.pds'>Get the partial duration series for streamflow droughts</h2><span id='topic+dr.pds'></span>

<h3>Description</h3>

<p>This function returns the partial duration series for streamflow droughts 
based on a moving window quantile threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dr.pds(TS, Qdr = 0.2, WinSize = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dr.pds_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="dr.pds_+3A_qdr">Qdr</code></td>
<td>
<p>Numeric value of the drought threshold quantile.  Default is 0.2.</p>
</td></tr>
<tr><td><code id="dr.pds_+3A_winsize">WinSize</code></td>
<td>
<p>Numeric value specifying the size of the moving window in
days.  Default is 30.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function defines a daily streamflow threshold and finds the 
partial duration series of streamflow droughts.  Drought events are 
identified in the daily streamflow time series with the threshold level approach.
In this function, the threshold is 
defined by a moving quantile, where daily threshold values are based on
the 80th percentile of the flow duration curve from a 30-day moving window 
(Beyene et al. 2014). With this method, every day of the year has a different
threshold based on the streamflow measured on the day, the 15 days before 
the day, and the 15 days after the day. The size of the moving window can be 
modified with the WinSize argument, and the percentile can be modified with the
Qdr argument.
</p>


<h3>Value</h3>

<p>Returns the input TS data.frame with &quot;Thresh&quot; and &quot;BelowThresh&quot; 
columns appended. The Thresh column contains the daily flow threshold, and 
the BelowThresh column is a binary indicating whether the flow on each day 
was below the drought threshold.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>References</h3>

<p>Beyene, B.S., Van Loon, A.F., Van Lanen, H.A.J., Torfs, P.J.J.F., 2014. 
Investigation of variable threshold level approaches for hydrological drought 
identification. Hydrol. Earth Syst. Sci. Discuss. 11, 12765-12797. 
http://dx.doi.org/10.5194/hessd-11-12765-2014.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+create.ts">create.ts</a></code> to format the input flow series.
</p>
<p>See <code><a href="#topic+mqt">mqt</a></code> to return only the daily moving quantile threshold.
</p>
<p>See <code><a href="#topic+dr.events">dr.events</a></code> to pool drought events, remove minor events,
and calculate metrics.
</p>
<p>See <code><a href="#topic+dr.seas">dr.seas</a></code> to calculate metrics for streamflow droughts 
that start in a specific month or months.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
pds &lt;- dr.pds(cania.sub.ts)
pds &lt;- subset(pds, pds$BelowThresh==TRUE)

# plot the flow time series with black and the drought events in red
plot(cania.sub.ts$Date, cania.sub.ts$Flow, ylab="m3/s", xlab="", type="l")
points(pds$Date, pds$Flow, pch=19, cex=0.7, col="red")
</code></pre>

<hr>
<h2 id='dr.seas'>Find the start, middle, end, and duration of seasonal droughts</h2><span id='topic+dr.seas'></span>

<h3>Description</h3>

<p>This function returns the day of year for the start, middle, and end of 
seasonal droughts.  It also returns the duration and severity of each drought
event. The function allows for seasonal analysis by defining a season 
argument which lists months during which droughts of interest may start.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dr.seas(TS, Qdr = 0.2, WinSize = 30, IntEventDur = 10, EventDur = 15,
  Season = c(4:9))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dr.seas_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="dr.seas_+3A_qdr">Qdr</code></td>
<td>
<p>Numeric value for drought quantile.  Default is 0.2.</p>
</td></tr>
<tr><td><code id="dr.seas_+3A_winsize">WinSize</code></td>
<td>
<p>Numeric value for moving window size in days.
Default is 30.</p>
</td></tr>
<tr><td><code id="dr.seas_+3A_inteventdur">IntEventDur</code></td>
<td>
<p>Numeric value for the minimum inter-event duration in 
days. Drought events with less than the specified number of days between will 
be pooled and considered as one event. Default is 10.</p>
</td></tr>
<tr><td><code id="dr.seas_+3A_eventdur">EventDur</code></td>
<td>
<p>Numeric value for the minimum drought duration in days. Default
is 15.</p>
</td></tr>
<tr><td><code id="dr.seas_+3A_season">Season</code></td>
<td>
<p>Numeric vector of months during which droughts start. Default 
is c(4:9) for non-frost season droughts.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls <code><a href="#topic+dr.events">dr.events</a></code> which calls 
<code><a href="#topic+dr.pds">dr.pds</a></code> and <code><a href="#topic+mqt">mqt</a></code>
</p>


<h3>Value</h3>

<p>Returns a data.frame of drought event metrics; the columns are:
</p>

<ul>
<li><p> StartDay - day of year that the drought event started on
</p>
</li>
<li><p> MidDay - day of year for the middle of the drought event, which is
defined as the day when the cumulative drought deficit reached 50
total cumulative daily streamflow deficit.  Total cumulative streamflow 
deficit is also referred to as drought severity in this package.
</p>
</li>
<li><p> EndDay - day of year that the drought ended on
</p>
</li>
<li><p> Duration - length of the drought event, in days
</p>
</li>
<li><p> Severity - severity of the drought event, calculated as the total
cumulative daily streamflow deficit
</p>
</li></ul>

<p>The &quot;times&quot; attribute provides the start date to preserve year information
and aid in plotting the time series.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+create.ts">create.ts</a></code> to format the input flow series. <br />
See <code><a href="#topic+dr.events">dr.events</a></code> and <code><a href="#topic+mqt">mqt</a></code> for details on how drought 
events are defined.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res &lt;- dr.seas(cania.sub.ts)
res2 &lt;- screen.metric(res[,1], "Day of Year")
</code></pre>

<hr>
<h2 id='FDC'>Flow Duration Curve</h2><span id='topic+FDC'></span>

<h3>Description</h3>

<p>Produces a flow duration curve plot with optional Gustard type-curves that 
can be used to estimate catchment permeability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FDC(flow, title = NULL, normal = FALSE, gust = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FDC_+3A_flow">flow</code></td>
<td>
<p>daily streamflow time series</p>
</td></tr>
<tr><td><code id="FDC_+3A_title">title</code></td>
<td>
<p>character string for plot title</p>
</td></tr>
<tr><td><code id="FDC_+3A_normal">normal</code></td>
<td>
<p>boolean indicating whether to plot on normal probability 
axis (normal=TRUE) or linear probability axis (default, normal=FALSE)</p>
</td></tr>
<tr><td><code id="FDC_+3A_gust">gust</code></td>
<td>
<p>boolean indicating whether to plot Gustard type curves.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Gustard, A., Bullock, A., and Dixon, J.M. (1992). Report No. 108:
Low flow estimation in the United Kingdom. 
Oxfordshire, United Kingdom: Institute of Hydrology.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(caniapiscau)
caniapiscau &lt;- subset(caniapiscau, !is.na(caniapiscau$Flow))
FDC(caniapiscau$Flow, title="Caniapiscau River")
</code></pre>

<hr>
<h2 id='FlowScreen'>
Screen Daily Discharge Time Series for Temporal Trends and Change Points
</h2><span id='topic+FlowScreen'></span><span id='topic+FlowScreen'></span>

<h3>Description</h3>

<p>This package can be used to calculate more than 30 different streamflow metrics
and identify temporal trends and changepoints. It is intended for use
as a data quality screening tool aimed at identifying streamflow records
that may have anthropogenic impacts or data inhomogeneity.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> FlowScreen</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-04-05</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Daily streamflow time series downloaded with the Environment Canada Data Explorer can be loaded with <code><a href="#topic+read.flows">read.flows</a></code>. The <code><a href="#topic+read.flows">read.flows</a></code> function can also be used to load daily streamflow time series from the USGS. The streamflow regime can be visualized with <code><a href="#topic+regime">regime</a></code>.  A list of 30 streamflow metrics that describe high flows, low flows, and baseflows can be calculated using <code><a href="#topic+metrics.all">metrics.all</a></code>. The temporal occurrence of changepoints for all metrics or for only the high flow, baseflow, or low flow metrics can be analyzed using <code><a href="#topic+screen.cpts">screen.cpts</a></code>. If the streamflow time series has multiple metrics exhibiting changepoints within the same year (or few years), the time series can be further analyzed using <code><a href="#topic+screen.summary">screen.summary</a></code> which creates a summary plot showing the significant temporal trends and changepoints for the high flow, low flow, or baseflow metrics. The <code><a href="#topic+screen.metric">screen.metric</a></code> can be used to create a time series plot for one metric at a time. The <code>screen.metric</code> function works with individual metrics output from the following functions: <code><a href="#topic+pk.max">pk.max</a></code>, <code><a href="#topic+pk.max.doy">pk.max.doy</a></code>, <code><a href="#topic+Qn">Qn</a></code>, <code><a href="#topic+pk.bf.stats">pk.bf.stats</a></code>, <code><a href="#topic+dr.seas">dr.seas</a></code>, <code><a href="#topic+MAMn">MAMn</a></code>, <code><a href="#topic+bf.stats">bf.stats</a></code>, <code><a href="#topic+pk.cov">pk.cov</a></code>, and <code><a href="#topic+bf.seas">bf.seas</a></code>.The <code><a href="#topic+screen.frames">screen.frames</a></code> function creates individual plots from the <code><a href="#topic+screen.summary">screen.summary</a></code> function. The <code><a href="#topic+screen.frames">screen.frames</a></code> function can also be used to create custom summary plots, see the example code in the function documentation. 
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer, Paul H. Whitfield
</p>
<p>Maintainer: Jennifer Dierauer &lt;jen.r.brand@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bard, A., Renard, B., Lang, M. 2011. The AdaptAlp Dataset: Description, guidance, and analyses. In AdaptAlp WP 4 Report, 15. Lyon, France: Cemagraf. <br />
</p>
<p>Bard, A., Renard, B., Lang, M., Giuntoli, I., Korck, J., Koboltschnig, G., Janza, M., d'Amico, M., Volken, D. 2015. Trends in the hydrologic regime of Alpine rivers. Journal of Hydrology online. <br />
</p>
<p>Svensson, C., Kundzewicz, Z.W., Maurer, T. 2005. Trend detection in river flow series: 2. Flood and low-flow index series. Hydrological Sciences Journal 50:811-824. <br />
</p>
<p>Whitfield, P.H. 2012. Why the provenance of data matters: Assessing &quot;Fitness for Purpose&quot; for environmental data. Canadian Water Resources Journal 37:23-36. <br />
</p>
<p>Whitfield, P.H. 2013. Is 'Center of Volume' a robust indicator of changes in snowmelt timing? Hydrological Processes 27:2691-2698. <br />
</p>


<h3>See Also</h3>

<p><code><a href="evir.html#topic+pot">pot</a></code>, <code><a href="evir.html#topic+decluster">decluster</a></code>, <code><a href="changepoint.html#topic+cpt.meanvar">cpt.meanvar</a></code>, <code><a href="zyp.html#topic+zyp.trend.vector">zyp.trend.vector</a></code>, <code><a href="Kendall.html#topic+Kendall">Kendall</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load daily streamflow time series for the Caniapiscau River
data(caniapiscau)

# summary plot of the annual flow regime
caniapiscau.ts &lt;- create.ts(caniapiscau)
regime(caniapiscau.ts)

# calculate high flow, low flow, and baseflow metrics
res &lt;- metrics.all(caniapiscau.ts)

# plot histogram of changepoints for high flow, low flow, and baseflow metrics
screen.cpts(res, type="h")
screen.cpts(res, type="l")
screen.cpts(res, type="b")

# or plot all changepoints together
cpts &lt;- screen.cpts(res)

# create screening plots for high, low, and baseflow metrics
screen.summary(res, type="h")
screen.summary(res, type="l")
screen.summary(res, type="b")

## End(Not run)

</code></pre>

<hr>
<h2 id='get.station.internal'>Get station information for USGS or WSC hydrometric stations</h2><span id='topic+get.station.internal'></span>

<h3>Description</h3>

<p>Get station information for USGS or WSC hydrometric stations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.station.internal(stnID)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.station.internal_+3A_stnid">stnID</code></td>
<td>
<p>Character string of station ID.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of station information
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>

<hr>
<h2 id='get.titles.internal'>Returns plot titles and labels based on plot type and language preference</h2><span id='topic+get.titles.internal'></span>

<h3>Description</h3>

<p>Returns plot titles and labels based on plot type and language preference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.titles.internal(type, language = "English", Qmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.titles.internal_+3A_type">type</code></td>
<td>
<p>character indicating the type of summary plot</p>
</td></tr>
<tr><td><code id="get.titles.internal_+3A_language">language</code></td>
<td>
<p>&quot;English&quot; or &quot;French&quot;</p>
</td></tr>
<tr><td><code id="get.titles.internal_+3A_qmax">Qmax</code></td>
<td>
<p>the flow quantile used to define peaks of threshold, e.g. 0.95</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>

<hr>
<h2 id='hyear.internal'>Add hydrologic Year, month, and doy columns to a daily time series</h2><span id='topic+hyear.internal'></span>

<h3>Description</h3>

<p>Add hydrologic Year, month, and doy columns to a daily time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyear.internal(TS, hyrstart = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hyear.internal_+3A_ts">TS</code></td>
<td>
<p>Output from <code><a href="#topic+create.ts">create.ts</a></code> function.</p>
</td></tr>
<tr><td><code id="hyear.internal_+3A_hyrstart">hyrstart</code></td>
<td>
<p>define start month of hydrologic year. Defaults to 10 (October).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame with hyear, hmonth, and hdoy columns 
appended to the original input data.frame.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>

<hr>
<h2 id='MAMn'>Calculate mean annual minimum n-day flows</h2><span id='topic+MAMn'></span>

<h3>Description</h3>

<p>This function calculates the calculates the mean annual minimum n-day flow by
calendar year or by hydrologic year.  This function can also be used to find
the annual minimum series by setting n=1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAMn(TS, n = 7, by = "hyear")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAMn_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="MAMn_+3A_n">n</code></td>
<td>
<p>Numeric value for the number of days in the n-day flow period. Default is 7.</p>
</td></tr>
<tr><td><code id="MAMn_+3A_by">by</code></td>
<td>
<p>Character string indicating whether to use hydrologic years or 
calendar years.  Default is &quot;hyear&quot;.  Other option is &quot;year&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector containing the calculated MAM n-day flow for each 
year in the input time series.  The &quot;times&quot; attribute provides the corresponding
year for each calculated value.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+screen.metric">screen.metric</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)

# find the annual minimum series and plot 
res &lt;- MAMn(cania.sub.ts, n=1)
res2 &lt;- screen.metric(res, "Q (m3/s)")

# do the same with MAM 7-day flow instead of annual minimum
res &lt;- MAMn(cania.sub.ts, n=7)
res2 &lt;- screen.metric(res, "Q (m3/s)")
</code></pre>

<hr>
<h2 id='metrics.all'>Streamflow metrics</h2><span id='topic+metrics.all'></span>

<h3>Description</h3>

<p>Calculates 30 different flow metrics, 10 each for high flows, low flows, and baseflow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metrics.all(TS, Qmax = 0.95, Dur = 5, Qdr = 0.2, WinSize = 30,
  Season = c(4:9), NAthresh = 0.5, language = "English")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metrics.all_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="metrics.all_+3A_qmax">Qmax</code></td>
<td>
<p>Numeric value for peaks over threshold quantile.
Default is 0.95.</p>
</td></tr>
<tr><td><code id="metrics.all_+3A_dur">Dur</code></td>
<td>
<p>Numeric value for minimum number of days between flood peaks.
Default is 5.</p>
</td></tr>
<tr><td><code id="metrics.all_+3A_qdr">Qdr</code></td>
<td>
<p>Numeric value for drought quantile.  Default is 0.2, i.e. the 80th percentile
of the flow duration curve.</p>
</td></tr>
<tr><td><code id="metrics.all_+3A_winsize">WinSize</code></td>
<td>
<p>Numeric value for moving window size (in days) for the moving
window quantile drought threshold. See <code><a href="#topic+mqt">mqt</a></code>. Default is 30.</p>
</td></tr>
<tr><td><code id="metrics.all_+3A_season">Season</code></td>
<td>
<p>Numeric vector of months during which droughts start. Default 
is c(4:9) for non-frost season droughts.</p>
</td></tr>
<tr><td><code id="metrics.all_+3A_nathresh">NAthresh</code></td>
<td>
<p>Numeric value indicating the threshold for missing data points
in any one year.  Default is 0.5, indicating that years with more than 50 percent missing data
will be omitted from the metric calculations. This value should always be set to 
greater than 0.1, as years with fewer observations than approximately 1 month will
cause errors.</p>
</td></tr>
<tr><td><code id="metrics.all_+3A_language">language</code></td>
<td>
<p>Character string indicating the language to be used for naming
the different plot metrics. These names are used in <code><a href="#topic+screen.summary">screen.summary</a></code>
to label individual plots. Options are &quot;English&quot; or &quot;French&quot;.  Default is &quot;English&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates streamflow metrics and calculates the 
prewhitened trend using <code><a href="zyp.html#topic+zyp.trend.vector">zyp.trend.vector</a></code> and looks
for changpoints in mean and variance using <code><a href="changepoint.html#topic+cpt.meanvar">cpt.meanvar</a></code>
This function is intended for use as a data quality screening tool aimed 
at identifying streamflow records with anthropogenic impacts and should not be used
to complete a temporal trend analysis, as the calculated metrics may not be 
appropriate for all catchments. See the functions linked in the following section
for details on how each metric is calculated.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<p>metricTS: a list containing a vector of each metric calculated. Each
vector has a times attribute providing either the year for metrics with 
one observation per year or a date for metrics that may have more than one 
observation per year (e.g., Peaks Over Threshold).  This 
list has the following elements:
</p>

<ul>
<li><p> Annual Maximum Series - calculated with <code><a href="#topic+pk.max">pk.max</a></code>
</p>
</li>
<li><p> Day of Annual Maximum - calculated with <code><a href="#topic+pk.max.doy">pk.max.doy</a></code>
</p>
</li>
<li><p> Peaks Over Threshold (Qmax) - calculated with <code><a href="#topic+pks">pks</a></code>
</p>
</li>
<li><p> Inter-Event Duration - calculated with <code><a href="#topic+pks.dur">pks.dur</a></code>
</p>
</li>
<li><p> Q80 - calculated with <code><a href="#topic+Qn">Qn</a></code>
</p>
</li>
<li><p> Q90 - calculated with <code><a href="#topic+Qn">Qn</a></code>
</p>
</li>
<li><p> Day of Year 25 percent Annual Volume - calculated with <code><a href="#topic+pk.cov">pk.cov</a></code>
</p>
</li>
<li><p> Center of Volume - calculated with <code><a href="#topic+pk.cov">pk.cov</a></code>
</p>
</li>
<li><p> Day of Year 75 percent Annual Volume - calculated with <code><a href="#topic+pk.cov">pk.cov</a></code>
</p>
</li>
<li><p> Duration between 25 percent and 75 percent Annual Volume - calculated with <code><a href="stats.html#topic+cov">cov</a></code>
</p>
</li>
<li><p> Q10 - calculated with <code><a href="#topic+Qn">Qn</a></code>
</p>
</li>
<li><p> Q25 - calculated with <code><a href="#topic+Qn">Qn</a></code>
</p>
</li>
<li><p> Drought Start - calculated with <code><a href="#topic+dr.seas">dr.seas</a></code>
</p>
</li>
<li><p> Drought Center - calculated with <code><a href="#topic+dr.seas">dr.seas</a></code>
</p>
</li>
<li><p> Drought End - calculated with <code><a href="#topic+dr.seas">dr.seas</a></code>
</p>
</li>
<li><p> Drought Duration - calculated with <code><a href="#topic+dr.seas">dr.seas</a></code>
</p>
</li>
<li><p> Drought Severity - calculated with <code><a href="#topic+dr.seas">dr.seas</a></code>
</p>
</li>
<li><p> Annual Minimum Flow - calculated with <code><a href="#topic+MAMn">MAMn</a></code>
</p>
</li>
<li><p> Mean Annual Minimum 7-day Flow - calculated with <code><a href="#topic+MAMn">MAMn</a></code>
</p>
</li>
<li><p> Mean Annual Minimum 10-day Flow - calculated with <code><a href="#topic+MAMn">MAMn</a></code>
</p>
</li>
<li><p> Mean Daily Discharge - calculated with <code><a href="#topic+bf.stats">bf.stats</a></code>
</p>
</li>
<li><p> Annual Baseflow Volume - calculated with <code><a href="#topic+bf.stats">bf.stats</a></code>
</p>
</li>
<li><p> Annual Mean Baseflow - calculated with <code><a href="#topic+bf.stats">bf.stats</a></code>
</p>
</li>
<li><p> Annual Maximum Baseflow - calculated with <code><a href="#topic+bf.stats">bf.stats</a></code>
</p>
</li>
<li><p> Annual Minimum Baseflow - calculated with <code><a href="#topic+bf.stats">bf.stats</a></code>
</p>
</li>
<li><p> Mean Annual Baseflow Index - calculated with <code><a href="#topic+bf.stats">bf.stats</a></code>
</p>
</li>
<li><p> Day of Year 25  percent Baseflow Volume - calculated with <code><a href="#topic+pk.bf.stats">pk.bf.stats</a></code>
</p>
</li>
<li><p> Center of Volume Baseflow - calculated with <code><a href="#topic+pk.bf.stats">pk.bf.stats</a></code>
</p>
</li>
<li><p> Day of Year 75  percent Baseflow Volume - calculated with <code><a href="#topic+pk.bf.stats">pk.bf.stats</a></code>
</p>
</li>
<li><p> Duration between 25  percent and 75  percent Baseflow Volume - calculated with <code><a href="#topic+pk.bf.stats">pk.bf.stats</a></code>
</p>
</li></ul>

<p>tcpRes: this list contains the results of the trend and changepoint analysis
for each of the metrics in the metricTS list described above. Each list 
element is a list containing the following elements:
</p>

<ul>
<li><p> MetricID - integer used to identify the metric
</p>
</li>
<li><p> MetricName - Name of the metric.
</p>
</li>
<li><p> Slope - numeric vector containing the intercept and slope of the 
prewhitened linear trend calculated using the Yue Pilon method. See
<code><a href="zyp.html#topic+zyp.trend.vector">zyp.trend.vector</a></code>
</p>
</li>
<li><p> ci1 - upper bound of the trend's 95 percent confidence interval
</p>
</li>
<li><p> ci2 - lower bound of the trend's 95 percent conficence interval
</p>
</li>
<li><p> pval - Kendall's P-value computed for the detrended time series
</p>
</li>
<li><p> cpts - Most probable location of a changepoint, if one is detected. 
</p>
</li>
<li><p> means - Mean before and after the changepoint
</p>
</li>
<li><p> NumObs - The number of data points for the metric
</p>
</li></ul>

<p>inData: A data.frame of the original input daily streamflow time series.
</p>
<p>OmitYrs: A data.frame containing the years and the number of observations for
any years omitted from the analysis due to insufficient data.  If no years were
omitted, NA is returned.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p>See the documentation for individual functions linked in the 
output description for a details on methods.
</p>
<p>See <code><a href="#topic+screen.metric">screen.metric</a></code> to create individual plots for each metric.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load subset of daily streamflow time series for the Caniapiscau River
data(cania.sub.ts)

## Not run: 
# calculate low flow, high flow, and baseflow metrics
res &lt;- metrics.all(cania.sub.ts)

## End(Not run)
</code></pre>

<hr>
<h2 id='mqt'>Moving quantile threshold</h2><span id='topic+mqt'></span>

<h3>Description</h3>

<p>This function calculates the daily moving window quantile threshold for use in 
identifying the partial duration series of streamflow droughts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mqt(TS, Qdr = 0.2, WinSize = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mqt_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="mqt_+3A_qdr">Qdr</code></td>
<td>
<p>Numeric value of the drought threshold quantile.  Default is 0.2.</p>
</td></tr>
<tr><td><code id="mqt_+3A_winsize">WinSize</code></td>
<td>
<p>Numeric value specifying the size of the moving window in
days.  Default is 30.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The threshold is defined by a moving quantile, where daily threshold 
values are based on the 80th percentile of the flow duration curve 
(i.e. 0.2 quantile) from a 30-day moving window (Beyene et al. 2014). 
With this method, every day of the year has a different threshold based on 
the streamflow measured on the day, the 15 days before 
the day, and the 15 days after the day.The size of the moving window can be 
modified with the WinSize argument, and the percentile can be modified with the
Qdr argument.
</p>


<h3>Value</h3>

<p>Returns a numeric vector containing the streamflow drought threshold
in m3/s for each day of the year.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>References</h3>

<p>Beyene, B.S., Van Loon, A.F., Van Lanen, H.A.J., Torfs, P.J.J.F., 2014. 
Investigation of variable threshold level approaches for hydrological drought 
identification. Hydrol. Earth Syst. Sci. Discuss. 11, 12765-12797. 
http://dx.doi.org/10.5194/hessd-11-12765-2014.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+create.ts">create.ts</a></code> to format the input flow series.
</p>
<p>The following functions use this function: <code><a href="#topic+dr.pds">dr.pds</a></code>, 
<code><a href="#topic+dr.events">dr.events</a></code>, <code><a href="#topic+dr.seas">dr.seas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res &lt;- mqt(cania.sub.ts)

# subset one year of the flow series
flow.sub &lt;- cania.sub.ts[cania.sub.ts$year == 1990,]

# plot the 1990 observed flows in dark blue and the daily drought threshold in red
plot(flow.sub$doy, flow.sub$Flow, ylab="Q (m3/s)", xlab="Day of Year",
 pch=19, col="darkblue", type="b")
points(res, pch=19, cex=0.7, col="red")
</code></pre>

<hr>
<h2 id='NA.runs'>Missing data runs for daily time series.</h2><span id='topic+NA.runs'></span>

<h3>Description</h3>

<p>This function takes a data.frame from create.ts and returns a data.frame of 
missing data runs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NA.runs(TS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NA.runs_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame with the following columns:
</p>

<ul>
<li><p> Start - Date of the start of the missing data period
</p>
</li>
<li><p> End - Date of the end of the missing data period
</p>
</li>
<li><p> Duration - number of days in the missing data period
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create.ts">create.ts</a></code> to create input, <code><a href="#topic+NA.sum">NA.sum</a></code> to sum the
the missing data occurrences by year or month.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(caniapiscau)
cania.sub &lt;- caniapiscau[300:1200,]
cania.ts &lt;- create.ts(cania.sub)
res &lt;- NA.runs(cania.ts)
</code></pre>

<hr>
<h2 id='NA.sum'>Sum missing data points from a daily time series</h2><span id='topic+NA.sum'></span>

<h3>Description</h3>

<p>Counts the number of missing data points by calendar year, hydrologic year, or month
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NA.sum(input, by = "hyear", hyrstart = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NA.sum_+3A_input">input</code></td>
<td>
<p>output from <code><a href="#topic+NA.runs">NA.runs</a></code></p>
</td></tr>
<tr><td><code id="NA.sum_+3A_by">by</code></td>
<td>
<p>character string identifying the time period to summarize by.
Defaults is hydrologic year (&quot;hyear&quot;), other choices are &quot;year&quot; and &quot;month&quot;.
The &quot;month&quot; option will return the number of missing data points for each
month in the time series.</p>
</td></tr>
<tr><td><code id="NA.sum_+3A_hyrstart">hyrstart</code></td>
<td>
<p>optional argument, define start month of hydrologic year</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector of the number of missing observations per
summary period.  The &quot;times&quot; attribute of the returned vector provides the
corresponding year, hyear, or month.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NA.runs">NA.runs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(caniapiscau)
cania.sub &lt;- caniapiscau[300:1200,]
cania.ts &lt;- create.ts(cania.sub)
res &lt;- NA.runs(cania.ts)
res2 &lt;- NA.sum(res)
</code></pre>

<hr>
<h2 id='pk.bf.stats'>Calculate baseflow peak statistics</h2><span id='topic+pk.bf.stats'></span>

<h3>Description</h3>

<p>This function finds the start, middle, end, and duration of the baseflow
peak based on percent of the total annual baseflow volume.
A value of 0 is returned for years with no flow. Hydrologic 
years with fewer than normal observations (outliers) are excluded from the 
analysis, and for stations with seasonal flow records, additional seasonal 
subsetting is done to include only days with observations in all years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk.bf.stats(TS, bfpct = c(25, 50, 75))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pk.bf.stats_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="pk.bf.stats_+3A_bfpct">bfpct</code></td>
<td>
<p>numeric vector of percentages used to define the 
start, middle, and end of the baseflow peak. Default is c(25, 50, 75)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates metrics intended to focus on snowmelt-related
streamflow occuring in spring and summer. For catchments in cold climates, 
the baseflow peak can be interpreted as snowmelt-induced. Baseflow is estimated with 
<code><a href="#topic+bf_eckhardt">bf_eckhardt</a></code>. If total annual flow is equal to 0, returns NA for that
year.
</p>


<h3>Value</h3>

<p>Returns a data.frame with the following columns:
</p>

<ul>
<li><p> Start - day of year defining the start of the baseflow peak
</p>
</li>
<li><p> Mid - day of year defining the middle of the baseflow peak
</p>
</li>
<li><p> End - day of year defining the end of the baseflow peak
</p>
</li>
<li><p> Dur - duration of the baseflow peak, in days
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res1 &lt;- pk.bf.stats(cania.sub.ts)

# trend and changepoint plot for baseflow peak start doy
res2 &lt;- screen.metric(res1[,1], "Day of Year")
</code></pre>

<hr>
<h2 id='pk.cov'>Center of Volume</h2><span id='topic+pk.cov'></span>

<h3>Description</h3>

<p>This function calculates center of volume metrics, including the day of the 
hydrologic year that 25 percent, 50 percent, and 75 percent of the total annual 
streamflow is reached. A value of 0 is returned for years with no flow. Hydrologic 
years with fewer than normal observations (outliers) are excluded from the 
analysis, and for stations with seasonal flow records, additional seasonal 
subsetting is done to include only days with observations in all years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk.cov(TS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pk.cov_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame with the following columns:
</p>

<ul>
<li><p> hYear - Hydrologic Years
</p>
</li>
<li><p> Q25 - day of hydrologic year for 25 percent of the total annual streamflow
</p>
</li>
<li><p> Q50 - day of hydrologic year for 50 percent of the total annual streamflow, i.e. Center of Volume
</p>
</li>
<li><p> Q75 - day of hydrologic year for 75 percent of the total annual streamflow
</p>
</li>
<li><p> Dur - duration of between the 25 percent and 75 percent day of year, in days
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res1 &lt;- pk.cov(cania.sub.ts)

# trend and changepoint plot for baseflow peak start doy
res2 &lt;- screen.metric(res1[,2], "Day of Year")
</code></pre>

<hr>
<h2 id='pk.max'>Annual maximum series</h2><span id='topic+pk.max'></span>

<h3>Description</h3>

<p>This function returns the annual maximum series from a daily streamflow time
series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk.max(TS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pk.max_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of 
the daily streamflow time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector containing the annual maximum flow (m3/s) 
series, by hydrologic year. The &quot;times&quot; attribute contains the hydrologic year 
for each element in the vector.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+create.ts">create.ts</a></code> to format the input flow series.
</p>
<p>See <code><a href="#topic+pk.max.doy">pk.max.doy</a></code> to find the day of year for each annual
maximum flow event.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res &lt;- pk.max(cania.sub.ts)
res2 &lt;- screen.metric(res, "Q (m3/s)")
</code></pre>

<hr>
<h2 id='pk.max.doy'>Day of year for annual maximum series</h2><span id='topic+pk.max.doy'></span>

<h3>Description</h3>

<p>This function returns the day of the hydrologic year for each annual maximum flow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk.max.doy(TS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pk.max.doy_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector containing the day of the (hydrologic) year for 
each annual maximum flow. The &quot;times&quot; attribute contains the 
hydrologic year for each element in the vector.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+create.ts">create.ts</a></code> to format the input flow series.
</p>
<p>See <code><a href="#topic+pk.max">pk.max</a></code> for the annual maximum flow series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res &lt;- pk.max.doy(cania.sub.ts)
res2 &lt;- screen.metric(res, "Day of Year")
</code></pre>

<hr>
<h2 id='pks'>Get the flow peaks over a threshold</h2><span id='topic+pks'></span>

<h3>Description</h3>

<p>This function finds the flow peaks over a user defined threshold and declusters to remove
dependent peaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pks(TS, Dur = 5, Qmax = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pks_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="pks_+3A_dur">Dur</code></td>
<td>
<p>numeric value of the minimum number of days between peaks</p>
</td></tr>
<tr><td><code id="pks_+3A_qmax">Qmax</code></td>
<td>
<p>numeric value for peaks over threshold quantile.
Default is 0.95.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Peaks Over Threshold values are calcuated as mean daily streamflow (m3/s)
minus the threshold streamflow value (m3/s) defined by the 
input quantile (Qmax). Peaks are identified with <code><a href="evir.html#topic+pot">pot</a></code> and 
the minimum inter-event duration (Dur) is applied by 
<code><a href="evir.html#topic+decluster">decluster</a></code>.
</p>


<h3>Value</h3>

<p>Returns a numeric vector of peaks of threshold values in m3/s. The &quot;times&quot;
attribute contains the date by calendar year, and the &quot;names&quot; attribute contains
the hydrologic year and hydrologic day of year, e.g., 2012 55.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res &lt;- pks(cania.sub.ts)
res2 &lt;- screen.metric(res, "Peak Over Threshold (m3/s)")
</code></pre>

<hr>
<h2 id='pks.dur'>Calculate the inter-event duration</h2><span id='topic+pks.dur'></span>

<h3>Description</h3>

<p>This function calculates duration (in days) between flow peaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pks.dur(Peaks)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pks.dur_+3A_peaks">Peaks</code></td>
<td>
<p>Output from <code><a href="#topic+pks">pks</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector containing the duration (in days) between peaks
over threshold from <code><a href="#topic+pks">pks</a></code>. The &quot;times&quot; attribute contains the calendar 
year date of the earlier peak. The &quot;names&quot; attribute contains the hydrologic year and
the day (1-366) of the hydrologic year.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
res1 &lt;- pks(cania.sub.ts)
res2 &lt;- pks.dur(res1)
res3 &lt;- screen.metric(res2, "Inter-Event Duration (days)")
</code></pre>

<hr>
<h2 id='Qn'>Calculate flow quantiles</h2><span id='topic+Qn'></span>

<h3>Description</h3>

<p>This function calculates flow quantiles by hydrologic year, calendar
year, month, or doy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qn(TS, n = 0.1, by = "hyear")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qn_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="Qn_+3A_n">n</code></td>
<td>
<p>Numeric value of the quantile.  Default is 0.1.</p>
</td></tr>
<tr><td><code id="Qn_+3A_by">by</code></td>
<td>
<p>Character string indicating time unit to summarize by.  Default is
&quot;hyear&quot; for hydrologic year, see <code><a href="#topic+create.ts">create.ts</a></code>.  Other options 
are &quot;year&quot; for calendar year, &quot;month&quot;, or &quot;doy&quot; for day of year.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector of the calculated flow quantile for the time
periods indicated with the &quot;by&quot; argument.  The &quot;times&quot; attribute contains the
hydrologic year, calendar year, month, or day of year for each data point.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)

# 50% quantile, i.e. mean, by calendar year
res &lt;- Qn(cania.sub.ts, n=0.5, by="year")
res2 &lt;- screen.metric(res, "Q (m3/s)")

# Default 10% quantile, by hydrologic year
res &lt;- Qn(cania.sub.ts)
res2 &lt;- screen.metric(res, "Q (m3/s)")
</code></pre>

<hr>
<h2 id='read.flows'>Read .csv or .Rdata file of streamflows</h2><span id='topic+read.flows'></span>

<h3>Description</h3>

<p>Reads .csv or .Rdata files of daily streamflow time series.  Recognizes 
several formats, including those used by Water Survey Canada and the United 
States Geological Survey. Uses read.csv() or load() functions from base package, 
returns data frame with ID, Date, and Flow, and, if available,
associated quality codes and source agency. Replaces negative values that are 
sometimes used to denote missing data with NAs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.flows(filename, convert = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.flows_+3A_filename">filename</code></td>
<td>
<p>name of .csv file to be read.</p>
</td></tr>
<tr><td><code id="read.flows_+3A_convert">convert</code></td>
<td>
<p>Boolean indicating whether or not to convert USGS flow values
from cubic feet per second to cubic meters per second. (Axes are automatically 
labeled in cubic meters per second)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>

<hr>
<h2 id='regime'>Plot flow regime</h2><span id='topic+regime'></span>

<h3>Description</h3>

<p>This function plots the min, max, mean, and two user-defined quantiles of 
daily streamflow to provide visual summary of the flow regime. Area between 
the upper and lower quantile is shaded grey, the dark blue line represents
the mean daily discharge, gray line represents the median daily discharge,
and the period of record daily maximum and minimum are
shown with the blue points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regime(TS, q = c(0.9, 0.1), text = "d", by = "hdoy", y.lims = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regime_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="regime_+3A_q">q</code></td>
<td>
<p>Numeric vector of the upper and lower quantile values.  Default
is c(0.9, 0.1).</p>
</td></tr>
<tr><td><code id="regime_+3A_text">text</code></td>
<td>
<p>optional character string for margin text, e.g. for station name, 
location, or other notes. Set to NULL if no margin text is wanted, or set to &quot;d&quot; 
to use default text containing the station ID, station name, and province/state 
returned from <code><a href="#topic+station.info">station.info</a></code>.</p>
</td></tr>
<tr><td><code id="regime_+3A_by">by</code></td>
<td>
<p>Character string indicating whether to plot the regime by day of 
the hydrologic year (defined using <code><a href="#topic+create.ts">create.ts</a></code>) or by day of 
the calendar year. Options are &quot;doy&quot; (calendar year) or &quot;hdoy&quot; (default, hydrologic year).</p>
</td></tr>
<tr><td><code id="regime_+3A_y.lims">y.lims</code></td>
<td>
<p>optional user-defined y-axis minimum and maximim. e.g. c(0, 500)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'># plot the flow regime of the Caniapiscau River
data(cania.sub.ts)
regime(cania.sub.ts)
</code></pre>

<hr>
<h2 id='screen.cpts'>Change point time series plot</h2><span id='topic+screen.cpts'></span>

<h3>Description</h3>

<p>Compiles change point information for all metrics and outputs a daily flow
time series plot overlain with a bar plot of changepoint counts by year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screen.cpts(metrics, type = "a", text = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen.cpts_+3A_metrics">metrics</code></td>
<td>
<p>output from <code><a href="#topic+metrics.all">metrics.all</a></code></p>
</td></tr>
<tr><td><code id="screen.cpts_+3A_type">type</code></td>
<td>
<p>character indicating which type of metric to compile change points for.
Options are &quot;h&quot; for high flow metrics, &quot;l&quot; for low flow metrics, &quot;b&quot; for baseflow 
metrics, or &quot;a&quot; for all 30 metrics (10 high, 10 low, 10 baseflow).</p>
</td></tr>
<tr><td><code id="screen.cpts_+3A_text">text</code></td>
<td>
<p>optional character string for margin text, e.g. for station name, 
location, or other notes. Set to NULL if no margin text is wanted, or set to &quot;d&quot; 
to use default text containing the station ID, station name, and province/state 
returned from <code><a href="#topic+station.info">station.info</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When type=&quot;a&quot;, returns a data.frame of changepoint counts by metric 
type and year.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+metrics.all">metrics.all</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load results from metrics.all function for the Caniapiscau River
data(caniapiscau.res)

# plot changepoints for all metrics
screen.cpts(caniapiscau.res, type="l")
</code></pre>

<hr>
<h2 id='screen.frames'>Plot one or more frames from the summary screening plot</h2><span id='topic+screen.frames'></span>

<h3>Description</h3>

<p>This function plots one or more frames (i.e. time series plot) from any of the three 
plot.screening summary plots at a time. It can be used to create custom
summary plots - see the example code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screen.frames(metrics, type = "h", element = NULL, language = "English",
  StnInfo = NULL, mmar = c(3, 4, 0.5, 0.5), text = "d", multi = F,
  xaxis = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen.frames_+3A_metrics">metrics</code></td>
<td>
<p>output from <code><a href="#topic+metrics.all">metrics.all</a></code></p>
</td></tr>
<tr><td><code id="screen.frames_+3A_type">type</code></td>
<td>
<p>Character string indicating the set of metrics to plot.  Options
are &quot;h&quot; for high flow metrics, &quot;l&quot; for low flow metrics, or &quot;b&quot; for baseflow
metrics.</p>
</td></tr>
<tr><td><code id="screen.frames_+3A_element">element</code></td>
<td>
<p>Numeric index(es) (1-10) of the frame(s) to plot, see details of this function
for the list of metrics for each category (high, low, baseflow). Each category has
ten different metrics that can be plotted individually. Default is NULL, which creates
individual plots for all ten metrics. A list of elements c(1, 5, 10) can be specified
or a range c(1:5).</p>
</td></tr>
<tr><td><code id="screen.frames_+3A_language">language</code></td>
<td>
<p>Language for plot labels.  Choice of either &quot;English&quot; or
&quot;French&quot;. Default is &quot;English&quot;.</p>
</td></tr>
<tr><td><code id="screen.frames_+3A_stninfo">StnInfo</code></td>
<td>
<p>Optional data.frame containing user-supplied station info for plot. 
data.frame must have 7 columns containing station info in the following order:
Station ID, Station Name, Prov/State, Country, Latitude, Longitude, Catchment Area
If any of the information is unavailabe, fill with NA. The Station ID column must
match the Station ID in column 1 of the data.frame input from <code><a href="#topic+create.ts">create.ts</a></code>.</p>
</td></tr>
<tr><td><code id="screen.frames_+3A_mmar">mmar</code></td>
<td>
<p>Numeric vector specifying plot margins. Default is c(3,4,0.5,0.5)</p>
</td></tr>
<tr><td><code id="screen.frames_+3A_text">text</code></td>
<td>
<p>Character string containing text for margin. This can be set to NULL if no
margin text is wanted, or set to &quot;d&quot; to use default text containing the station ID, station 
name, and the prov/state output from <code><a href="#topic+station.info">station.info</a></code>. Set to NULL to use this 
function in a multi-plot layout.</p>
</td></tr>
<tr><td><code id="screen.frames_+3A_multi">multi</code></td>
<td>
<p>Boolean indicating whether the function is being used to create one plot
in a multi-plot layout. Default is F. If T, suppresses the reset of plot parameter settings.
This plot function will only work for a multi-plot layout if text=F</p>
</td></tr>
<tr><td><code id="screen.frames_+3A_xaxis">xaxis</code></td>
<td>
<p>Boolean indicating whether to plot an x-axis. Default = T.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>High flow metrics include:
</p>

<ol>
<li><p> Annual Maximum Series
</p>
</li>
<li><p> Annual Maximum Day of Year
</p>
</li>
<li><p> Peaks Over Threshold (Qmax)
</p>
</li>
<li><p> Inter-Event Duration
</p>
</li>
<li><p> Q80
</p>
</li>
<li><p> Q90
</p>
</li>
<li><p> Day of Year 25 percent Annual Flow
</p>
</li>
<li><p> Center of Volume
</p>
</li>
<li><p> Day of Year 75 percent Annual Flow
</p>
</li>
<li><p> Duration between 25 percent and 75 percent Annual Flow
</p>
</li></ol>

<p>Low flow metrics include:
</p>

<ol>
<li><p> Q10
</p>
</li>
<li><p> Q25
</p>
</li>
<li><p> Drought Start
</p>
</li>
<li><p> Drought Center
</p>
</li>
<li><p> Drought End
</p>
</li>
<li><p> Drought Duration
</p>
</li>
<li><p> Drought Severity
</p>
</li>
<li><p> Annual Minimum Flow
</p>
</li>
<li><p> Mean Annual Minimum 7-day Flow
</p>
</li>
<li><p> Mean Annual Minimum 10-day Flow
</p>
</li></ol>

<p>Baseflow metrics include:
</p>

<ol>
<li><p> Mean Daily Discharge
</p>
</li>
<li><p> Annual Baseflow Volume
</p>
</li>
<li><p> Annual Mean Baseflow
</p>
</li>
<li><p> Annual Maximum Baseflow
</p>
</li>
<li><p> Annual Minimum Baseflow
</p>
</li>
<li><p> Mean Annual Baseflow Index
</p>
</li>
<li><p> Day of Year 25 percent Baseflow Volume
</p>
</li>
<li><p> Center of Volume Baseflow
</p>
</li>
<li><p> Day of Year 75 percent Baseflow Volume
</p>
</li>
<li><p> Duration between 25 percent and 75 percent Baseflow Volume
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Jennifer Dierauer and Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load results from metrics.all function for the Caniapiscau River
data(caniapiscau.res)
caniapiscau.ts &lt;- caniapiscau.res$indata

# plot one frame from the baseflow screening plot
screen.frames(caniapiscau.res, type="b", element=1)

# plot three frames from the low flow screening plot
screen.frames(caniapiscau.res, type="l", element=c(1:3))

# create a custom summary plot
opar &lt;- par(no.readonly = TRUE)
layout(matrix(c(1,2,3,4), 2, 2, byrow=TRUE))
par(oma=c(0,0,3,0))
stninfo &lt;- station.info(caniapiscau.ts, Plot=TRUE)
screen.frames(caniapiscau.res, type="h", element=1, text=NULL, multi=TRUE)
screen.frames(caniapiscau.res, type="l", element=1, text=NULL, multi=TRUE)
screen.frames(caniapiscau.res, type="b", element=1, text=NULL, multi=TRUE)
mtext(paste("Station ID: ", caniapiscau.ts[1,1], ", Agency: WSC, Country: CA", sep=""),
side=3, line=1, outer=TRUE, cex=0.9)
par &lt;- opar
layout(1,1,1)

# or plot everything!
opar &lt;- par(no.readonly = TRUE)
layout(matrix(c(1:30), 5, 6, byrow=TRUE))
screen.frames(caniapiscau.res, type="h", text=NULL, multi=TRUE)
screen.frames(caniapiscau.res, type="l", text=NULL, multi=TRUE)
screen.frames(caniapiscau.res, type="b", text=NULL, multi=TRUE)
par &lt;- opar
layout(1,1,1)
</code></pre>

<hr>
<h2 id='screen.frames.internal'>Internal wrapper for creating trend and change-point plots</h2><span id='topic+screen.frames.internal'></span>

<h3>Description</h3>

<p>Internal wrapper for creating trend and change-point plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screen.frames.internal(input, mparam, mylab, DataType, maf, mmar, text, xaxis,
  Year1, YearEnd, hyrstart)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen.frames.internal_+3A_input">input</code></td>
<td>
<p>metric time series</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_mparam">mparam</code></td>
<td>
<p>trend and change point info</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_mylab">mylab</code></td>
<td>
<p>y axis label</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_datatype">DataType</code></td>
<td>
<p>numeric indicating data type</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_maf">maf</code></td>
<td>
<p>mean annual flow series</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_mmar">mmar</code></td>
<td>
<p>plot margins</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_text">text</code></td>
<td>
<p>boolean indicating whether to add text</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_xaxis">xaxis</code></td>
<td>
<p>boolean indicating whether to plot the x axis</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_year1">Year1</code></td>
<td>
<p>start year of original time series</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_yearend">YearEnd</code></td>
<td>
<p>end year of original time series</p>
</td></tr>
<tr><td><code id="screen.frames.internal_+3A_hyrstart">hyrstart</code></td>
<td>
<p>numeric indicating month for start of the hydrologic year</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>

<hr>
<h2 id='screen.metric'>Plot a metric with trend and change points</h2><span id='topic+screen.metric'></span>

<h3>Description</h3>

<p>This function plots a time series of a streamflow metric with the prewhitened
linear trend and any detected changepoints in mean and variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screen.metric(y, ylabel = "", text = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen.metric_+3A_y">y</code></td>
<td>
<p>Numeric vector with &quot;times&quot; attribute</p>
</td></tr>
<tr><td><code id="screen.metric_+3A_ylabel">ylabel</code></td>
<td>
<p>Character string for the y-axis label</p>
</td></tr>
<tr><td><code id="screen.metric_+3A_text">text</code></td>
<td>
<p>optional character string for margin text, e.g. for station name, 
location, or other notes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots detected changepoints as a vertical dashed line.
The means on either side of a changepoint are plotted as solid black lines.
If the temporal trend is significant (p-value &lt; 0.1), the trend is plotted as 
a blue or red line for an increasing or decreasing trend, respectively.
The upper and lower 95
dotted red or blue lines.  If a trend is not significant, it is not plotted.
</p>


<h3>Value</h3>

<p>Returns a list containing results from the trend and changepoint
analysis. This list has the following elements:
</p>

<ul>
<li><p> slope - Numeric vector containing the intercept and slope of the 
prewhitened linear trend computed with <code><a href="zyp.html#topic+zyp.trend.vector">zyp.trend.vector</a></code>
using Yue Pilon's method
</p>
</li>
<li><p> ci1 - numeric vector containing the intercept and slope of the
upper confidence bound. See <code><a href="zyp.html#topic+confint.zyp">confint.zyp</a></code>
</p>
</li>
<li><p> ci2 - numeric vector of length 2 containing the intercept and slope
of the lower confidence bound. See <code><a href="zyp.html#topic+confint.zyp">confint.zyp</a></code>
</p>
</li>
<li><p> pval - numeric value indicatng the significance value of the detected
trend, Kendall test computed within <code><a href="zyp.html#topic+zyp.trend.vector">zyp.trend.vector</a></code>
</p>
</li>
<li><p> cpts - numeric vector of changepoints if any are found, computed 
with <code><a href="changepoint.html#topic+cpt.meanvar">cpt.meanvar</a></code>
</p>
</li>
<li><p> means - numeric vector of means computed with 
<code><a href="changepoint.html#topic+cpt.meanvar">cpt.meanvar</a></code>
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+screen.summary">screen.summary</a></code> to create a summary screening plot of 
high flow, low flow, or baseflow metrics.
</p>
<p>See <code><a href="#topic+metrics.all">metrics.all</a></code> to calculate 30 different streamflow metrics at once.
The <code><a href="#topic+screen.metric">screen.metric</a></code> function could then be used to loop through the metrics and 
create an individual plot for each.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)

# calculate and plot the annual maximum series
res &lt;- pk.max(cania.sub.ts)
res1 &lt;- screen.metric(res, ylabel="Q (m3/s)", 
text="Caniapiscau River, Annual Maximum Series")

# calculate and plot the annual minimum series
res &lt;- MAMn(cania.sub.ts, n=1)
res1 &lt;- screen.metric(res, ylabel="Discharge (m3/s)", 
text="Caniapiscau River, Annual Minimum Series")
</code></pre>

<hr>
<h2 id='screen.series'>Create a plot of the daily streamflow time series</h2><span id='topic+screen.series'></span>

<h3>Description</h3>

<p>Plots the daily streamflow time series and color codes points by data quality codes if 
the data are from Water Survey Canada. Also highlights date ranges with missing
observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screen.series(TS, StnInfo = NULL, text = "d")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen.series_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow
time series</p>
</td></tr>
<tr><td><code id="screen.series_+3A_stninfo">StnInfo</code></td>
<td>
<p>Optional data.frame containing user-supplied station info for plot. 
data.frame must have 7 columns containing station info in the following order:
Station ID, Station Name, Prov/State, Country, Latitude, Longitude, Catchment Area
If any of the information is unavailabe, fill with NA.  The Station ID column must
match the Station ID in column 1 of the data.frame input from <code><a href="#topic+create.ts">create.ts</a></code>.</p>
</td></tr>
<tr><td><code id="screen.series_+3A_text">text</code></td>
<td>
<p>optional character string for margin text, e.g. for station name, 
location, or other notes. Set to NULL if not margin text is wanted, or set to &quot;d&quot; 
to use default text containing the station ID, station name, and province/state 
returned from <code><a href="#topic+station.info">station.info</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jennifer Dierauer and Paul Whitfield
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load flow time series for the Caniapiscau River
data(cania.sub.ts)

# plot daily time series with default margin text
screen.series(cania.sub.ts)
</code></pre>

<hr>
<h2 id='screen.summary'>Create a screening plot</h2><span id='topic+screen.summary'></span>

<h3>Description</h3>

<p>Produces summary screening plots of high flow, low flow, or baseflow metrics.  
Each plot shows significant temporal trends and step changes. Intended for use as 
a data quality screening tool aimed at identifying streamflow records with 
anthropogenic impacts or data inhomogeneities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screen.summary(metrics, type = "h", language = "English", StnInfo = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen.summary_+3A_metrics">metrics</code></td>
<td>
<p>output from <code><a href="#topic+metrics.all">metrics.all</a></code></p>
</td></tr>
<tr><td><code id="screen.summary_+3A_type">type</code></td>
<td>
<p>Character indicating the set of metrics to plot.  Options
are &quot;h&quot; for high flow metrics, &quot;l&quot; for low flow metrics, or &quot;b&quot; for baseflow
metrics.</p>
</td></tr>
<tr><td><code id="screen.summary_+3A_language">language</code></td>
<td>
<p>Language for plot labels.  Choice of either &quot;English&quot; or
&quot;French&quot;. Default is &quot;English&quot;.</p>
</td></tr>
<tr><td><code id="screen.summary_+3A_stninfo">StnInfo</code></td>
<td>
<p>Optional data.frame containing user-supplied station info for plot. 
data.frame must have 7 columns containing station info in the following order:
Station ID, Station Name, Prov/State, Country, Latitude, Longitude, Catchment Area
If any of the information is unavailabe, fill with NA.  The Station ID column must
match the Station ID in column 1 of the data.frame input from <code><a href="#topic+create.ts">create.ts</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the center of volume (COV) plots on the high flow and baseflow screening plots,
the correlation coefficients for COV and years and for
mean annual flow (MAF) and years are added to the plot. The ratio of the correlation coefficients 
(r COV-years / r COV-MAF) is included as a rudimentary indication
of whether or not the temporal trend in COV is meaningful. See Whitfield (2013) for a
discussion of COV.
</p>
<p>Drought metrics for the low flow plot may not be applicable to intermittent streams, and
plots will be empty in this case.
</p>
<p>Important note:  If &quot;French&quot; is the language wanted for the plot labels, the language
option must also be specified in <code><a href="#topic+metrics.all">metrics.all</a></code>, as this plotting function 
pulls the metric names from the output metrics.all output.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>References</h3>

<p>Whitfield, P.H. 2013. Is 'Center of Volume' a robust indicator of changes 
in snowmelt timing? Hydrological Processes 27:2691-8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load results from metrics.all function for the Caniapiscau River
data(caniapiscau.res)

# create a summary flow screening plot of the high flow metrics
screen.summary(caniapiscau.res, type="l")
</code></pre>

<hr>
<h2 id='screen.summary.internal'>Internal wrapper for creating trend and change-point summary plots</h2><span id='topic+screen.summary.internal'></span>

<h3>Description</h3>

<p>Internal wrapper for creating trend and change-point summary plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screen.summary.internal(input, mparam, type, ylabs, i, DataType, maf, Year1,
  YearEnd, hyrstart)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen.summary.internal_+3A_input">input</code></td>
<td>
<p>metric time series</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_mparam">mparam</code></td>
<td>
<p>trend and change point info</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_type">type</code></td>
<td>
<p>character indicating type of summary plot</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_ylabs">ylabs</code></td>
<td>
<p>y axis labels</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_i">i</code></td>
<td>
<p>plot position</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_datatype">DataType</code></td>
<td>
<p>numeric indicating data type</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_maf">maf</code></td>
<td>
<p>mean annual flow series</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_year1">Year1</code></td>
<td>
<p>start year of original time series</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_yearend">YearEnd</code></td>
<td>
<p>end year of original time series</p>
</td></tr>
<tr><td><code id="screen.summary.internal_+3A_hyrstart">hyrstart</code></td>
<td>
<p>numeric indicating month for start of the hydrologic year</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>

<hr>
<h2 id='station.info'>Retrieve Station Info</h2><span id='topic+station.info'></span>

<h3>Description</h3>

<p>Returns station information for Water Survey Canada or United States Geological Survey stream 
gauges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>station.info(TS, StnInfo = NULL, Plot = F, language = "English")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="station.info_+3A_ts">TS</code></td>
<td>
<p>output from <code><a href="#topic+create.ts">create.ts</a></code> containing a data.frame of flow</p>
</td></tr>
<tr><td><code id="station.info_+3A_stninfo">StnInfo</code></td>
<td>
<p>Optional data.frame containing user-supplied station info for plot. 
data.frame must have 7 columns containing station info in the following order:
Station ID, Station Name, Prov/State, Country, Latitude, Longitude, Catchment Area
If any of the information is unavailabe, fill with NA.  The Station ID column must
match the Station ID in column 1 of the data.frame input from <code><a href="#topic+create.ts">create.ts</a></code>.</p>
</td></tr>
<tr><td><code id="station.info_+3A_plot">Plot</code></td>
<td>
<p>Boolean indicating whether a plot of station information should be created.
Default is F. Plot is intended for use as the upper-left panel of the plot produced 
by <code><a href="#topic+screen.summary">screen.summary</a></code>.</p>
</td></tr>
<tr><td><code id="station.info_+3A_language">language</code></td>
<td>
<p>Language for plotting when Plot = T.  Choice of either &quot;English&quot; or
&quot;French&quot;. Default is &quot;English&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of the following station information:
</p>

<ul>
<li><p> $StationID
</p>
</li>
<li><p> $StnName
</p>
</li>
<li><p> $Prov/State - Abbreviation for the province or state in which the station is located
</p>
</li>
<li><p> $Country - Abbreviation for the country in which the station is located
</p>
</li>
<li><p> $Lat - Latitude of the station
</p>
</li>
<li><p> $Long - Longitude of the station
</p>
</li>
<li><p> $Area - Catchment area, in square kilometers
</p>
</li>
<li><p> $RHN - Boolean indicating whether the station is part of a reference hydrologic network
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cania.sub.ts)
StnInfo &lt;- station.info(cania.sub.ts)
</code></pre>

<hr>
<h2 id='YMD.internal'>Add calendar year, month, and day of year columns</h2><span id='topic+YMD.internal'></span>

<h3>Description</h3>

<p>Add calendar year, month, and day of year columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YMD.internal(TS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="YMD.internal_+3A_ts">TS</code></td>
<td>
<p>Output from <code><a href="#topic+create.ts">create.ts</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame with year, month, and doy columns appended.
</p>


<h3>Author(s)</h3>

<p>Jennifer Dierauer
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
