<!DOCTYPE html><html lang="en-US"><head><title>Help for package grabsampling</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {grabsampling}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AOQL_grab_A'><p>Construction of  AOQ curve and calculate AOQL value based on limiting fraction</p></a></li>
<li><a href='#AOQL_grab_B'><p>Construction of  AOQ curve and calculate AOQL value based on average microbial counts</p></a></li>
<li><a href='#compare_plans'><p>Probability of detection or non detection  versus fraction nonconforming curve</p></a></li>
<li><a href='#compare_plans_oc'><p>Comparison based on OC curve</p></a></li>
<li><a href='#correlation_grab'><p>Serial correlation between grab samples</p></a></li>
<li><a href='#oc_plan'><p>Construction of  Operating Characteristic (OC) curve</p></a></li>
<li><a href='#prob_accept'><p>Probability of acceptance for grab sampling scheme</p></a></li>
<li><a href='#prob_contaminant'><p>Probability of contaminated sample</p></a></li>
<li><a href='#prob_detect'><p>Probability of detection under the grab sampling method</p></a></li>
<li><a href='#prob_detect_single_grab'><p>Probability of detection in a single grab sample</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Probability of Detection for Grab Sample Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Mayooran1987/grabsampling">https://github.com/Mayooran1987/grabsampling</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Mayooran1987/grabsampling/issues">https://github.com/Mayooran1987/grabsampling/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for obtaining the probability of detection, for grab samples selection by using two different methods such as systematic or random based on two-state Markov chain model. For detection probability calculation, we used results from Bhat, U. and Lal, R. (1988) &lt;<a href="https://doi.org/10.2307%2F1427041">doi:10.2307/1427041</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>extraDistr, ggplot2, ggthemes, plyr, reshape2, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mayooran Thevaraja &lt;mayooran@eng.jfn.ac.lk&gt;</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-02-26 18:55:11 UTC; hp</td>
</tr>
<tr>
<td>Author:</td>
<td>Mayooran Thevaraja [aut, cre],
  Kondaswamy Govindaraju [aut],
  Mark Bebbington [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-04 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AOQL_grab_A'>Construction of  AOQ curve and calculate AOQL value based on limiting fraction</h2><span id='topic+AOQL_grab_A'></span>

<h3>Description</h3>

<p><code><a href="#topic+AOQL_grab_A">AOQL_grab_A</a></code> provides the AOQ curve and calculates AOQL value based on limiting fraction of contaminated increments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AOQL_grab_A(c, r, t, d, N, method, plim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AOQL_grab_A_+3A_c">c</code></td>
<td>
<p>acceptance number</p>
</td></tr>
<tr><td><code id="AOQL_grab_A_+3A_r">r</code></td>
<td>
<p>nurber of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="AOQL_grab_A_+3A_t">t</code></td>
<td>
<p>number of grab samples</p>
</td></tr>
<tr><td><code id="AOQL_grab_A_+3A_d">d</code></td>
<td>
<p>serial correlation of contamination between the primary increments</p>
</td></tr>
<tr><td><code id="AOQL_grab_A_+3A_n">N</code></td>
<td>
<p>length of the production</p>
</td></tr>
<tr><td><code id="AOQL_grab_A_+3A_method">method</code></td>
<td>
<p>what sampling method we have applied such as <code>'systematic'</code> or <code>'random'</code> selection methods</p>
</td></tr>
<tr><td><code id="AOQL_grab_A_+3A_plim">plim</code></td>
<td>
<p>the upper limit for graphing the fraction nonconforming or proportion of contaminated increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since <code class="reqn">P_{ND}</code> is the probability of non-detection, <code class="reqn">p</code> is the limiting fraction of contaminated increments and the outgoing contaminated proportion of primary increments is given by <code class="reqn">AOQ</code> as the product <code class="reqn">pP_{ND}</code>.
The quantity <code class="reqn">AOQL</code> is defined as the maximum proportion of outgoing contaminated primary increments and is given by </p>
<p style="text-align: center;"><code class="reqn">AOQL ={\max_{0\leq p\leq 1}}{pP_{ND}}</code>
</p>



<h3>Value</h3>

<p>AOQ curve and AOQL value based on on limiting fraction
</p>


<h3>See Also</h3>

<p><a href="#topic+prob_detect">prob_detect</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  c &lt;-  0
  r &lt;-  25
  t &lt;-  30
  d &lt;-  0.99
  N &lt;-  1e9
  method &lt;- 'systematic'
  plim &lt;- 0.30
  AOQL_grab_A(c, r, t, d, N, method, plim)
</code></pre>

<hr>
<h2 id='AOQL_grab_B'>Construction of  AOQ curve and calculate AOQL value based on average microbial counts</h2><span id='topic+AOQL_grab_B'></span>

<h3>Description</h3>

<p><code><a href="#topic+AOQL_grab_B">AOQL_grab_B</a></code> provides the AOQ curve and calculates AOQL value based on average microbial counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AOQL_grab_B(c, r, t, distribution,llim, K, m, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AOQL_grab_B_+3A_c">c</code></td>
<td>
<p>acceptance number</p>
</td></tr>
<tr><td><code id="AOQL_grab_B_+3A_r">r</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="AOQL_grab_B_+3A_t">t</code></td>
<td>
<p>number of grab samples</p>
</td></tr>
<tr><td><code id="AOQL_grab_B_+3A_distribution">distribution</code></td>
<td>
<p>what suitable microbiological distribution we have used such as  <code>'Poisson gamma'</code> or <code>'Lognormal'</code>or <code>'Poisson lognormal'</code></p>
</td></tr>
<tr><td><code id="AOQL_grab_B_+3A_llim">llim</code></td>
<td>
<p>the upper limit for graphing the arithmetic mean of cell count</p>
</td></tr>
<tr><td><code id="AOQL_grab_B_+3A_k">K</code></td>
<td>
<p>dispersion parameter of the Poisson gamma distribution (default value 0.25)</p>
</td></tr>
<tr><td><code id="AOQL_grab_B_+3A_m">m</code></td>
<td>
<p>microbiological limit with default value zero, generally expressed as number of microorganisms in specific sample weight</p>
</td></tr>
<tr><td><code id="AOQL_grab_B_+3A_sd">sd</code></td>
<td>
<p>standard deviation of the lognormal and Poisson-lognormal distributions on the log10 scale (default value 0.8)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since <code class="reqn">P_a</code> is the probability of acceptance, <code class="reqn">\lambda</code> is the arithmetic mean of cell count and the outgoing contaminated arithmetic mean of cell count of primary increments is given by <code class="reqn">AOQ</code> as the product <code class="reqn">\lambda P_a</code>.
The quantity <code class="reqn">AOQL</code> is defined as the maximum proportion of outgoing contaminated primary increments and is given by </p>
<p style="text-align: center;"><code class="reqn">AOQL ={\max_{\lambda \geq 0}}{\lambda P_a}</code>
</p>



<h3>Value</h3>

<p>AOQ curve and AOQL value based on average microbial counts
</p>


<h3>See Also</h3>

<p><a href="#topic+prob_accept">prob_accept</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  c &lt;-  0
  r &lt;-  25
  t &lt;-  30
  distribution &lt;- 'Poisson lognormal'
  llim &lt;- 0.20
  AOQL_grab_B(c, r, t, distribution, llim)
</code></pre>

<hr>
<h2 id='compare_plans'>Probability of detection or non detection  versus fraction nonconforming curve</h2><span id='topic+compare_plans'></span>

<h3>Description</h3>

<p>This function allows comparison of different sampling schemes, which can be systematic and random sampling of primary increments or grab sampling of blocks of primary increments.  A graphical display of the probability of detection <code class="reqn">P_D</code> or probability of non detection <code class="reqn">P_{ND}</code> versus fraction nonconforming <code class="reqn">p</code> for up to four selected schemes will be produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_plans(d, N, plim, type, c1, r1, t1, method1, c2, r2, t2, method2,
                     c3, r3, t3, method3, c4, r4, t4, method4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_plans_+3A_d">d</code></td>
<td>
<p>serial correlation of contamination between the primary increments</p>
</td></tr>
<tr><td><code id="compare_plans_+3A_n">N</code></td>
<td>
<p>length of the production</p>
</td></tr>
<tr><td><code id="compare_plans_+3A_plim">plim</code></td>
<td>
<p>the upper limit for graphing the fraction nonconforming or proportion of contaminated increments</p>
</td></tr>
<tr><td><code id="compare_plans_+3A_type">type</code></td>
<td>
<p>what type of graph we want to produce such as <code>D</code> or <code>ND</code>. <code><a href="#topic+compare_plans">compare_plans</a></code> produces a graphical display of <code class="reqn">P_D</code> or <code class="reqn">P_{ND}</code> versus <code class="reqn">p</code> depending on the <code>D</code> or <code>ND</code> of type</p>
</td></tr>
<tr><td><code id="compare_plans_+3A_c1">c1</code>, <code id="compare_plans_+3A_c2">c2</code>, <code id="compare_plans_+3A_c3">c3</code>, <code id="compare_plans_+3A_c4">c4</code></td>
<td>
<p>acceptance numbers</p>
</td></tr>
<tr><td><code id="compare_plans_+3A_r1">r1</code>, <code id="compare_plans_+3A_r2">r2</code>, <code id="compare_plans_+3A_r3">r3</code>, <code id="compare_plans_+3A_r4">r4</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="compare_plans_+3A_t1">t1</code>, <code id="compare_plans_+3A_t2">t2</code>, <code id="compare_plans_+3A_t3">t3</code>, <code id="compare_plans_+3A_t4">t4</code></td>
<td>
<p>number of grab samples</p>
</td></tr>
<tr><td><code id="compare_plans_+3A_method1">method1</code>, <code id="compare_plans_+3A_method2">method2</code>, <code id="compare_plans_+3A_method3">method3</code>, <code id="compare_plans_+3A_method4">method4</code></td>
<td>
<p>what sampling method we have applied such as <code>'systematic'</code> or <code>'random'</code> selection methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Probability of detection or non detection vs limiting fraction curves
</p>


<h3>Examples</h3>

<pre><code class='language-R'>c1 &lt;- 0
c2 &lt;- 0
c3 &lt;- 0
c4 &lt;- 0
r1 &lt;- 1
r2 &lt;- 10
r3 &lt;- 30
r4 &lt;- 75
t1 &lt;- 750
t2 &lt;- 75
t3 &lt;- 25
t4 &lt;- 10
d &lt;- 0.99
N &lt;- 1e9
method1 &lt;- method2 &lt;- method3 &lt;- method4 &lt;- 'systematic'
plim &lt;- 0.10
compare_plans(d, N, plim, type ='D', c1, r1, t1, method1, c2, r2, t2, method2)
compare_plans(d, N, plim, type ='D', c1, r1, t1, method1, c2, r2, t2, method2,
                        c3, r3, t3, method3)
compare_plans(d, N, plim, type ='D', c1, r1, t1, method1, c2, r2, t2, method2,
                        c3, r3, t3, method3, c4, r4, t4, method4)
compare_plans(d, N, plim, type ='ND', c1, r1, t1, method1, c2, r2, t2, method2,
                        c3, r3, t3, method3, c4, r4, t4, method4)

</code></pre>

<hr>
<h2 id='compare_plans_oc'>Comparison based on OC curve</h2><span id='topic+compare_plans_oc'></span>

<h3>Description</h3>

<p>This function produces overlaid Operating Characteristic (OC) curves for any three systematic/random sampling schemes for specified parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_plans_oc(c1, c2, c3, r1, t1, r2, t2, r3, t3, distribution, K, m, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_plans_oc_+3A_c1">c1</code>, <code id="compare_plans_oc_+3A_c2">c2</code>, <code id="compare_plans_oc_+3A_c3">c3</code></td>
<td>
<p>acceptance numbers</p>
</td></tr>
<tr><td><code id="compare_plans_oc_+3A_r1">r1</code>, <code id="compare_plans_oc_+3A_r2">r2</code>, <code id="compare_plans_oc_+3A_r3">r3</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="compare_plans_oc_+3A_t1">t1</code>, <code id="compare_plans_oc_+3A_t2">t2</code>, <code id="compare_plans_oc_+3A_t3">t3</code></td>
<td>
<p>number of grab samples</p>
</td></tr>
<tr><td><code id="compare_plans_oc_+3A_distribution">distribution</code></td>
<td>
<p>what distribution we have used such as   <code>'Poisson gamma'</code> or <code>'Lognormal'</code>or <code>'Poisson lognormal'</code></p>
</td></tr>
<tr><td><code id="compare_plans_oc_+3A_k">K</code></td>
<td>
<p>dispersion parameter of the Poisson gamma distribution (default value 0.25)</p>
</td></tr>
<tr><td><code id="compare_plans_oc_+3A_m">m</code></td>
<td>
<p>microbiological limit with default value zero, generally expressed as number of microorganisms in specific sample weight</p>
</td></tr>
<tr><td><code id="compare_plans_oc_+3A_sd">sd</code></td>
<td>
<p>standard deviation of the lognormal and Poisson-lognormal distributions on the log10 scale (default value 0.8)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>overlaid OC curves
</p>


<h3>See Also</h3>

<p><a href="#topic+prob_accept">prob_accept</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>c1 &lt;- 0
c2 &lt;- 0
c3 &lt;- 0
r1 &lt;- 25
r2 &lt;- 50
r3 &lt;- 75
t1 &lt;- 10
t2 &lt;- 10
t3 &lt;- 10
distribution &lt;- 'Poisson lognormal'
compare_plans_oc(c1, c2, c3, r1, t1, r2, t2, r3, t3, distribution)
</code></pre>

<hr>
<h2 id='correlation_grab'>Serial correlation between grab samples</h2><span id='topic+correlation_grab'></span>

<h3>Description</h3>

<p>This function calculates the resulting serial correlation between grab samples each having <code>r</code> primary increments with original serial correlation <code>d</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correlation_grab(r, p, d)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correlation_grab_+3A_r">r</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="correlation_grab_+3A_p">p</code></td>
<td>
<p>limiting fraction or proportion of contaminated increments</p>
</td></tr>
<tr><td><code id="correlation_grab_+3A_d">d</code></td>
<td>
<p>serial correlation of contamination between the primary increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The serial correlation between blocks (grab samples) is given by <code class="reqn">d_g</code> as
</p>
<p style="text-align: center;"><code class="reqn">d_g = [dp(1-p(1-d))^{r-1}]/p_d</code>
</p>

<p>where <code class="reqn">p_d</code> is the probability of detection in any of the block (grab sample) which is calculated by using <a href="#topic+prob_detect_single_grab">prob_detect_single_grab</a>.
</p>


<h3>Value</h3>

<p>Serial correlation between grab samples
</p>


<h3>See Also</h3>

<p><a href="#topic+prob_detect_single_grab">prob_detect_single_grab</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r &lt;-  25
p &lt;-  0.005
d &lt;-  0.99
correlation_grab(r, p, d)
</code></pre>

<hr>
<h2 id='oc_plan'>Construction of  Operating Characteristic (OC) curve</h2><span id='topic+oc_plan'></span>

<h3>Description</h3>

<p><code><a href="#topic+oc_plan">oc_plan</a></code> provides the Operating Characteristic (OC) curve for known microbiological distribution such as lognormal. The probability of acceptance is plotted against mean log10 concentration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oc_plan(c, r, t, distribution, K, m, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oc_plan_+3A_c">c</code></td>
<td>
<p>acceptance number</p>
</td></tr>
<tr><td><code id="oc_plan_+3A_r">r</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="oc_plan_+3A_t">t</code></td>
<td>
<p>number of grab samples</p>
</td></tr>
<tr><td><code id="oc_plan_+3A_distribution">distribution</code></td>
<td>
<p>what suitable distribution we have used such as   <code>'Poisson gamma'</code> or <code>'Lognormal'</code> or <code>'Poisson lognormal'</code></p>
</td></tr>
<tr><td><code id="oc_plan_+3A_k">K</code></td>
<td>
<p>dispersion parameter of the Poisson gamma distribution (default value 0.25)</p>
</td></tr>
<tr><td><code id="oc_plan_+3A_m">m</code></td>
<td>
<p>microbiological limit with default value zero, generally expressed as number of microorganisms in specific sample weight</p>
</td></tr>
<tr><td><code id="oc_plan_+3A_sd">sd</code></td>
<td>
<p>standard deviation of the lognormal and Poisson-lognormal distributions on the log10 scale (default value 0.8)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the food safety literature, mean concentration is given by <code class="reqn">\lambda = 10^{\mu+log(10)\sigma^2/2}</code>.
</p>


<h3>Value</h3>

<p>Operating Characteristic (OC) curve
</p>


<h3>See Also</h3>

<p><a href="#topic+prob_accept">prob_accept</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  c &lt;-  0
  r &lt;-  25
  t &lt;-  30
  distribution &lt;- 'Poisson lognormal'
  oc_plan(c, r, t, distribution)
</code></pre>

<hr>
<h2 id='prob_accept'>Probability of acceptance for grab sampling scheme</h2><span id='topic+prob_accept'></span>

<h3>Description</h3>

<p>This function calculates the overall probability of acceptance for given microbiological distribution such as lognormal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_accept(c, r, t, mu, distribution, K, m, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob_accept_+3A_c">c</code></td>
<td>
<p>acceptance number</p>
</td></tr>
<tr><td><code id="prob_accept_+3A_r">r</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="prob_accept_+3A_t">t</code></td>
<td>
<p>number of grab samples</p>
</td></tr>
<tr><td><code id="prob_accept_+3A_mu">mu</code></td>
<td>
<p>location parameter (mean log) of the Lognormal and Poisson-lognormal distributions on the log10 scale</p>
</td></tr>
<tr><td><code id="prob_accept_+3A_distribution">distribution</code></td>
<td>
<p>what suitable microbiological distribution we have used such as  <code>'Poisson gamma'</code> or <code>'Lognormal'</code>or <code>'Poisson lognormal'</code></p>
</td></tr>
<tr><td><code id="prob_accept_+3A_k">K</code></td>
<td>
<p>dispersion parameter of the Poisson gamma distribution (default value 0.25)</p>
</td></tr>
<tr><td><code id="prob_accept_+3A_m">m</code></td>
<td>
<p>microbiological limit with default value zero, generally expressed as number of microorganisms in specific sample weight</p>
</td></tr>
<tr><td><code id="prob_accept_+3A_sd">sd</code></td>
<td>
<p>standard deviation of the lognormal and Poisson-lognormal distributions on the log10 scale (default value 0.8)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the food safety literature, for given values of <code>c</code>, <code>r</code> and <code>t</code>, the probability of detection in a primary increment is given by, <code class="reqn">p_d=P(X &gt; m)=1-P_{distribution}(X \le m|\mu ,\sigma)</code> and acceptance probability in <code>t</code> selected sample is given by <code class="reqn">P_a=P_{binomial}(X \le c|t,p_d)</code>.
</p>
<p>If Y be the sum of correlated and identically distributed lognormal random variables X, then the approximate distribution of Y is lognormal
distribution with mean <code class="reqn">\mu_y</code>, standard deviation <code class="reqn">\sigma_y</code> (see <a href="https://doi.org/10.1109/ICC.2006.255040">Mehta et al (2006)</a>) where <code class="reqn">E(Y)=mE(X)</code> and <code class="reqn">V(Y)=mV(X)+cov(X_i,X_j)</code> for all <code class="reqn">i \ne j =1 \cdots r</code>.
</p>
<p>The parameters <code class="reqn">\mu_y</code> and <code class="reqn">\sigma_y</code> of the grab sample unit Y is given by,
</p>
<p style="text-align: center;"><code class="reqn">\mu_y =\log_{10}{(E[Y])} - {{\sigma_y}^2}/2 \log_e(10) </code>
</p>

<p>(see <a href="https://doi.org/10.1016/j.foodcont.2013.02.021">Mussida et al (2013)</a>). For this package development, we have used fixed <code class="reqn">\sigma_y</code> value with default value 0.8.
</p>


<h3>Value</h3>

<p>Probability of acceptance
</p>


<h3>References</h3>


<ul>
<li><p> Mussida, A., Vose, D. &amp; Butler, F. Efficiency of the sampling plan for Cronobacter spp. assuming a Poisson lognormal distribution of the bacteria in powder infant formula and the implications of assuming a fixed within and between-lot variability, Food Control, Elsevier, 2013 , 33 , <a href="https://doi.org/10.1016/j.foodcont.2013.02.021">174-185</a>.
</p>
</li>
<li><p> Mehta, N.B, Molisch, A.F, Wu, J, &amp;  Zhang, J., 'Approximating the Sum of Correlated Lognormal or, Lognormal-Rice Random Variables,' 2006 IEEE International Conference on Communications, Istanbul, 2006, pp. <a href="https://doi.org/10.1109/ICC.2006.255040">1605-1610</a>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>  c &lt;-  0
  r &lt;-  25
  t &lt;-  30
  mu &lt;-  -3
  distribution &lt;- 'Poisson lognormal'
  prob_accept(c, r, t, mu, distribution)
</code></pre>

<hr>
<h2 id='prob_contaminant'>Probability of contaminated sample</h2><span id='topic+prob_contaminant'></span>

<h3>Description</h3>

<p>This function calculates the probability of exactly  <code>l</code>  contaminated samples out of <code>t</code> selected grab samples for given gram sample size <code>r</code> and serial correlation <code>d</code> at the process contamination level <code>p</code> for a production length of <code>N</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_contaminant(l, r, t, d, p, N, method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob_contaminant_+3A_l">l</code></td>
<td>
<p>number of contaminated in <code>t</code> selected samples</p>
</td></tr>
<tr><td><code id="prob_contaminant_+3A_r">r</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="prob_contaminant_+3A_t">t</code></td>
<td>
<p>number of grab samples</p>
</td></tr>
<tr><td><code id="prob_contaminant_+3A_d">d</code></td>
<td>
<p>serial correlation of contamination between the primary increments</p>
</td></tr>
<tr><td><code id="prob_contaminant_+3A_p">p</code></td>
<td>
<p>limiting fraction or proportion of contaminated increments</p>
</td></tr>
<tr><td><code id="prob_contaminant_+3A_n">N</code></td>
<td>
<p>length of the production</p>
</td></tr>
<tr><td><code id="prob_contaminant_+3A_method">method</code></td>
<td>
<p>what sampling method we have applied such as <code>'systematic'</code> or <code>'random'</code> selection methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">S_t</code> be the number of contaminated samples and <code class="reqn">S_t=\sum X_t</code> where <code class="reqn">X_t=1</code> or <code class="reqn">0</code> depending on the presence or absence of contamination, then <code class="reqn">P(S_t=l)</code> formula given in <a href="https://doi.org/10.2307/1427041">Bhat and Lal (1988)</a>, also we can use following recurrence relation formula,
</p>
<p style="text-align: center;"><code class="reqn">P(S_t=l)=P(X_t=1;S_{t-1}=l-1) + P(X_t=0;S_{t-1}=l)</code>
</p>
<p> which is given in <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/nav.1028">Vellaisamy and Sankar (2001)</a>. Both methods will be produced the same results.
For this package development, we directly applied formula which is from <a href="https://doi.org/10.2307/1427041">Bhat and Lal (1988)</a>.
</p>


<h3>Value</h3>

<p>Probability of contaminated
</p>


<h3>References</h3>


<ul>
<li><p>  Bhat, U., &amp; Lal, R. (1988). Number of successes in Markov trials. Advances in Applied Probability, 20(3), <a href="https://doi.org/10.2307/1427041">677-680</a>.
</p>
</li>
<li><p>  Vellaisamy, P., Sankar, S., (2001). Sequential and systematic sampling plans for the Markov-dependent production process. Naval Research Logistics 48, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/nav.1028">451-467</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+prob_detect_single_grab">prob_detect_single_grab</a>, <a href="#topic+correlation_grab">correlation_grab</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  l &lt;-  1
  r &lt;-  25
  t &lt;-  30
  d &lt;-  0.99
  p &lt;-  0.005
  N &lt;-  1e9
  method &lt;- 'systematic'
  prob_contaminant(l, r, t, d, p, N, method)
</code></pre>

<hr>
<h2 id='prob_detect'>Probability of detection under the grab sampling method</h2><span id='topic+prob_detect'></span>

<h3>Description</h3>

<p>This function gives the detection probability for  <code>t</code> grab samples and given acceptance number under systematic or random sampling methods. This function is also used to calculate the detection probability for primary increments selection by setting the number of primary increments as one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_detect(c, r, t, d, p, N, method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob_detect_+3A_c">c</code></td>
<td>
<p>acceptance number</p>
</td></tr>
<tr><td><code id="prob_detect_+3A_r">r</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="prob_detect_+3A_t">t</code></td>
<td>
<p>number of grab samples</p>
</td></tr>
<tr><td><code id="prob_detect_+3A_d">d</code></td>
<td>
<p>serial correlation of contamination between the primary increments</p>
</td></tr>
<tr><td><code id="prob_detect_+3A_p">p</code></td>
<td>
<p>limiting fraction or proportion of contaminated increments</p>
</td></tr>
<tr><td><code id="prob_detect_+3A_n">N</code></td>
<td>
<p>length of the production</p>
</td></tr>
<tr><td><code id="prob_detect_+3A_method">method</code></td>
<td>
<p>what sampling method we have applied such as <code>'systematic'</code> or <code>'random'</code> selection methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The detection probability of entire selected grab samples is given by,
</p>
<p style="text-align: center;"><code class="reqn">P_D=1-[P(S_t=0)+P(S_t=1)+\cdots +P(S_t=c)]</code>
</p>



<h3>Value</h3>

<p>Probability of detection in all seleceted grab samples
</p>


<h3>See Also</h3>

<p><a href="#topic+prob_contaminant">prob_contaminant</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  c &lt;-  1
  r &lt;-  25
  t &lt;-  30
  d &lt;-  0.99
  p &lt;-  0.005
  N &lt;-  1e9
  method &lt;- 'systematic'
  prob_detect(c, r, t, d, p, N, method)
</code></pre>

<hr>
<h2 id='prob_detect_single_grab'>Probability of detection in a single grab sample</h2><span id='topic+prob_detect_single_grab'></span>

<h3>Description</h3>

<p>This function calculates the probability of detection in a single grab sample comprising of <code>r</code> primary increments for given serial correlation <code>d</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_detect_single_grab(r, p, d)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob_detect_single_grab_+3A_r">r</code></td>
<td>
<p>number of primary increments in a grab sample or grab sample size</p>
</td></tr>
<tr><td><code id="prob_detect_single_grab_+3A_p">p</code></td>
<td>
<p>limiting fraction or proportion of contaminated increments</p>
</td></tr>
<tr><td><code id="prob_detect_single_grab_+3A_d">d</code></td>
<td>
<p>serial correlation of contamination between the primary increments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability of detection in any of the grab sample is given by <code class="reqn">p_d</code> as
</p>
<p style="text-align: center;"><code class="reqn">p_d = 1-(1-p)(1-p(1-d))^{r-1}</code>
</p>



<h3>Value</h3>

<p>Probability of detection in a grab sample
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   r &lt;-  25
   p &lt;-  0.005
   d &lt;-  0.99
   prob_detect_single_grab(r, p, d)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
