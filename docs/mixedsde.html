<!DOCTYPE html><html><head><title>Help for package mixedsde</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixedsde}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ad.propSd'><p>Adaptation For The Proposal Variance</p></a></li>
<li><a href='#ad.propSd_random'><p>Adaptation For The Proposal Variance</p></a></li>
<li><a href='#Bayes.fit-class'><p>S4 class for the Bayesian estimation results</p></a></li>
<li><a href='#Bayes.pred-class'><p>S4 class for the Bayesian prediction results</p></a></li>
<li><a href='#BayesianNormal'><p>Bayesian Estimation In Mixed Stochastic Differential Equations</p></a></li>
<li><a href='#bx'><p>Computation Of The Drift Coefficient</p></a></li>
<li><a href='#chain2samples'><p>Removing Of Burn-in Phase And Thinning</p></a></li>
<li><a href='#dcCIR2'><p>Likelihood Function For The CIR Model</p></a></li>
<li><a href='#diagnostic'><p>Calcucation Of Burn-in Phase And Thinning Rate</p></a></li>
<li><a href='#discr'><p>Simulation Of Random Variables</p></a></li>
<li><a href='#eigenvaluesV'><p>Matrix Of Eigenvalues Of A List Of Symetric Matrices</p></a></li>
<li><a href='#EstParamNormal'><p>Maximization Of The Log Likelihood In Mixed Stochastic Differential Equations</p></a></li>
<li><a href='#Freq.fit-class'><p>S4 class for the frequentist estimation results</p></a></li>
<li><a href='#likelihoodNormal'><p>Computation Of The Log Likelihood In Mixed Stochastic Differential Equations</p></a></li>
<li><a href='#likelihoodNormalestimfix'><p>Likelihood Function When The Fixed Effect Is Estimated</p></a></li>
<li><a href='#mixedsde.fit'><p>Estimation Of The Random Effects In Mixed Stochastic Differential Equations</p></a></li>
<li><a href='#mixedsde.sim'><p>Simulation Of A Mixed Stochastic Differential Equation</p></a></li>
<li><a href='#mixture.sim'><p>Simulation Of A Mixture Of Two Normal Or Gamma Distributions</p></a></li>
<li><a href='#neuronal.data'>
<p>Trajectories Interspike Of A Single Neuron Of A Ginea Pig</p></a></li>
<li><a href='#out'><p>Transfers the class object to a list</p></a></li>
<li><a href='#plot,Bayes.fit,ANY-method'><p>Plot method for the Bayesian estimation class object</p></a></li>
<li><a href='#plot,Bayes.pred,ANY-method'><p>Plot method for the Bayesian prediction class object</p></a></li>
<li><a href='#plot,Freq.fit,ANY-method'><p>Plot method for the frequentist estimation class object</p></a></li>
<li><a href='#plot2compare'><p>Comparing plot method</p></a></li>
<li><a href='#plot2compare,Bayes.fit-method'><p>Comparing plot method plot2compare for three Bayesian estimation class objects</p></a></li>
<li><a href='#plot2compare,Bayes.pred-method'><p>Comparing plot method plot2compare for three Bayesian prediction class objects</p></a></li>
<li><a href='#pred'><p>Prediction method</p></a></li>
<li><a href='#pred,Bayes.fit-method'><p>Bayesian prediction method for a class object Bayes.fit</p></a></li>
<li><a href='#pred,Freq.fit-method'><p>Prediction method for the Freq.fit class object</p></a></li>
<li><a href='#print,Bayes.fit-method'><p>Print of acceptance rates of the MH steps</p></a></li>
<li><a href='#print,Freq.fit-method'><p>Description of print</p></a></li>
<li><a href='#summary,Bayes.fit-method'><p>Short summary of the results of class object Bayes.fit</p></a></li>
<li><a href='#summary,Freq.fit-method'><p>Short summary of the results of class object Freq.fit</p></a></li>
<li><a href='#UV'><p>Computation Of The Sufficient Statistics</p></a></li>
<li><a href='#valid'><p>Validation of the chosen model.</p></a></li>
<li><a href='#valid,Bayes.fit-method'><p>Validation of the chosen model.</p></a></li>
<li><a href='#valid,Freq.fit-method'><p>Validation of the chosen model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>5.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-10-05</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation Methods for Stochastic Differential Mixed Effects
Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Charlotte Dion [aut, cre],
    Adeline Sansom [aut], Simone Hermann [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Charlotte Dion &lt;charlotte.dion@upmc.fr&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), sde, moments, MASS, stats, graphics, methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>plot3D, grDevices</td>
</tr>
<tr>
<td>Description:</td>
<td>Inference on stochastic differential models Ornstein-Uhlenbeck or
    Cox-Ingersoll-Ross, with one or two random effects in the drift function.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cran.r-project.org/package=mixedsde">https://cran.r-project.org/package=mixedsde</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-05 16:42:03 UTC; charlottedion</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-05 17:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='ad.propSd'>Adaptation For The Proposal Variance</h2><span id='topic+ad.propSd'></span>

<h3>Description</h3>

<p>Calculation of new proposal standard deviation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ad.propSd(chain, propSd, iteration, lower = 0.3, upper = 0.6,
  delta.n = function(n) min(0.1, 1/sqrt(n)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ad.propSd_+3A_chain">chain</code></td>
<td>
<p>vector of Markov chain samples</p>
</td></tr>
<tr><td><code id="ad.propSd_+3A_propsd">propSd</code></td>
<td>
<p>old proposal standard deviation</p>
</td></tr>
<tr><td><code id="ad.propSd_+3A_iteration">iteration</code></td>
<td>
<p>number of current iteration</p>
</td></tr>
<tr><td><code id="ad.propSd_+3A_lower">lower</code></td>
<td>
<p>lower bound</p>
</td></tr>
<tr><td><code id="ad.propSd_+3A_upper">upper</code></td>
<td>
<p>upper bound</p>
</td></tr>
<tr><td><code id="ad.propSd_+3A_delta.n">delta.n</code></td>
<td>
<p>function for adding/subtracting from the log propSd</p>
</td></tr>
</table>


<h3>References</h3>

<p>Rosenthal, J. S. (2011). Optimal proposal distributions and adaptive MCMC. Handbook of Markov Chain Monte Carlo, 93-112.
</p>

<hr>
<h2 id='ad.propSd_random'>Adaptation For The Proposal Variance</h2><span id='topic+ad.propSd_random'></span>

<h3>Description</h3>

<p>Calculation of new proposal standard deviation for the random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ad.propSd_random(chain, propSd, iteration, lower = 0.3, upper = 0.6,
  delta.n = function(n) min(0.1, 1/sqrt(n)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ad.propSd_random_+3A_chain">chain</code></td>
<td>
<p>matrix of Markov chain samples</p>
</td></tr>
<tr><td><code id="ad.propSd_random_+3A_propsd">propSd</code></td>
<td>
<p>old proposal standard deviation</p>
</td></tr>
<tr><td><code id="ad.propSd_random_+3A_iteration">iteration</code></td>
<td>
<p>number of current iteration</p>
</td></tr>
<tr><td><code id="ad.propSd_random_+3A_lower">lower</code></td>
<td>
<p>lower bound</p>
</td></tr>
<tr><td><code id="ad.propSd_random_+3A_upper">upper</code></td>
<td>
<p>upper bound</p>
</td></tr>
<tr><td><code id="ad.propSd_random_+3A_delta.n">delta.n</code></td>
<td>
<p>function for adding/subtracting from the log propSd</p>
</td></tr>
</table>


<h3>References</h3>

<p>Rosenthal, J. S. (2011). Optimal proposal distributions and adaptive MCMC. Handbook of Markov Chain Monte Carlo, 93-112.
</p>

<hr>
<h2 id='Bayes.fit-class'>S4 class for the Bayesian estimation results</h2><span id='topic+Bayes.fit-class'></span>

<h3>Description</h3>

<p>S4 class for the Bayesian estimation results
</p>


<h3>Slots</h3>


<dl>
<dt><code>sigma2</code></dt><dd><p>vector of posterior samples for <code class="reqn">\sigma^2</code></p>
</dd>
<dt><code>mu</code></dt><dd><p>matrix of posterior samples for <code class="reqn">\mu</code></p>
</dd>
<dt><code>omega</code></dt><dd><p>matrix of posterior samples for <code class="reqn">\omega</code></p>
</dd>
<dt><code>alpha</code></dt><dd><p>matrix of posterior samples for <code class="reqn">\alpha</code></p>
</dd>
<dt><code>beta</code></dt><dd><p>matrix of posterior samples for <code class="reqn">\beta</code></p>
</dd>
<dt><code>random</code></dt><dd><p>1, 2 or c(1,2)</p>
</dd>
<dt><code>burnIn</code></dt><dd><p>proposal for the burn-in phase</p>
</dd>
<dt><code>thinning</code></dt><dd><p>proposal for the thinning rate</p>
</dd>
<dt><code>model</code></dt><dd><p>'OU' or 'CIR'</p>
</dd>
<dt><code>prior</code></dt><dd><p>list of prior values, input variable or calculated by the first 10% of series</p>
</dd>
<dt><code>times</code></dt><dd><p>vector of observation times, storage of input variable</p>
</dd>
<dt><code>X</code></dt><dd><p>matrix of observations, storage of input variable</p>
</dd>
<dt><code>ind.4.prior</code></dt><dd><p>indices of series used for the prior parameter calculation, if prior knowledge is availabe it is set to M+1</p>
</dd>
</dl>

<hr>
<h2 id='Bayes.pred-class'>S4 class for the Bayesian prediction results</h2><span id='topic+Bayes.pred-class'></span>

<h3>Description</h3>

<p>S4 class for the Bayesian prediction results
</p>


<h3>Slots</h3>


<dl>
<dt><code>phi.pred</code></dt><dd><p>matrix of predictive samples for the random effect</p>
</dd>
<dt><code>Xpred</code></dt><dd><p>matrix of predictive samples for observations</p>
</dd>
<dt><code>coverage.rate</code></dt><dd><p>amount of covering prediction intervals</p>
</dd>
<dt><code>qu.u</code></dt><dd><p>upper prediction interval bound</p>
</dd>
<dt><code>qu.l</code></dt><dd><p>lower prediction interval bound</p>
</dd>
<dt><code>estim</code></dt><dd><p>list of Bayes.fit object entries, storage of input variable</p>
</dd>
</dl>

<hr>
<h2 id='BayesianNormal'>Bayesian Estimation In Mixed Stochastic Differential Equations</h2><span id='topic+BayesianNormal'></span>

<h3>Description</h3>

<p>Gibbs sampler for Bayesian estimation of the random effects <code class="reqn">(\alpha_j, \beta_j)</code> in the mixed SDE
<code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_j(t))dt + \sigma a(X_j(t)) dW_j(t)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BayesianNormal(times, X, model = c("OU", "CIR"), prior, start, random,
  nMCMC = 1000, propSd = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BayesianNormal_+3A_times">times</code></td>
<td>
<p>vector of observation times</p>
</td></tr>
<tr><td><code id="BayesianNormal_+3A_x">X</code></td>
<td>
<p>matrix of the M trajectories (each row is a trajectory with <code class="reqn">N= T/\Delta</code> column).</p>
</td></tr>
<tr><td><code id="BayesianNormal_+3A_model">model</code></td>
<td>
<p>name of the SDE: 'OU' (Ornstein-Uhlenbeck) or 'CIR' (Cox-Ingersoll-Ross).</p>
</td></tr>
<tr><td><code id="BayesianNormal_+3A_prior">prior</code></td>
<td>
<p>list of prior parameters: mean and variance of the Gaussian prior on the mean mu, shape and scale of the inverse Gamma prior for the variances omega, shape and scale of the inverse Gamma prior for sigma</p>
</td></tr>
<tr><td><code id="BayesianNormal_+3A_start">start</code></td>
<td>
<p>list of starting values: mu, sigma</p>
</td></tr>
<tr><td><code id="BayesianNormal_+3A_random">random</code></td>
<td>
<p>random effects in the drift: 1 if one additive random effect, 2 if one multiplicative random effect or c(1,2) if 2 random effects.</p>
</td></tr>
<tr><td><code id="BayesianNormal_+3A_nmcmc">nMCMC</code></td>
<td>
<p>number of iterations of the MCMC algorithm</p>
</td></tr>
<tr><td><code id="BayesianNormal_+3A_propsd">propSd</code></td>
<td>
<p>proposal standard deviation of <code class="reqn">\phi</code> is <code class="reqn">|\mu|*</code><code>propSd</code><code class="reqn">/\log(N)</code> at the beginning, is adjusted when acceptance rate is under 30% or over 60%</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\alpha</code></p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\beta</code></p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\mu</code></p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\Omega</code></p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\sigma^2</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Hermann, S., Ickstadt, K. and C. Mueller (2016). Bayesian Prediction of Crack Growth Based on a Hierarchical Diffusion Model. <em>Appearing in: Applied Stochastic Models in Business and Industry</em>. 
</p>
<p>Rosenthal, J. S. (2011). 'Optimal proposal distributions and adaptive MCMC.' Handbook of Markov Chain Monte Carlo (2011): 93-112.
</p>

<hr>
<h2 id='bx'>Computation Of The Drift Coefficient</h2><span id='topic+bx'></span>

<h3>Description</h3>

<p>Computation of the drift coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bx(x, fixed, random)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bx_+3A_x">x</code></td>
<td>
<p>vector of data</p>
</td></tr>
<tr><td><code id="bx_+3A_fixed">fixed</code></td>
<td>
<p>drift constant in front of X (when there is one additive random effect), 0 otherwise</p>
</td></tr>
<tr><td><code id="bx_+3A_random">random</code></td>
<td>
<p>1 if there is one additive random effect, 2 one multiplicative random effect or c(1,2) for 2 random effects</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>b</code></td>
<td>
<p>The drift is <code class="reqn">b(x,\phi) = \phi_1 b_1(x) + \phi_2 b_2(x)</code>, the output is <code class="reqn">b_2</code> except when random c(1,2) then the output is the vector <code class="reqn">(b_1,b_2)^t</code></p>
</td></tr>
</table>

<hr>
<h2 id='chain2samples'>Removing Of Burn-in Phase And Thinning</h2><span id='topic+chain2samples'></span>

<h3>Description</h3>

<p>Transfers class object Bayes.fit from the original to the thinned chains
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chain2samples(res, burnIn, thinning)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chain2samples_+3A_res">res</code></td>
<td>
<p>Bayes.fit class object</p>
</td></tr>
<tr><td><code id="chain2samples_+3A_burnin">burnIn</code></td>
<td>
<p>number of burn-in samples</p>
</td></tr>
<tr><td><code id="chain2samples_+3A_thinning">thinning</code></td>
<td>
<p>thinning rate</p>
</td></tr>
</table>

<hr>
<h2 id='dcCIR2'>Likelihood Function For The CIR Model</h2><span id='topic+dcCIR2'></span>

<h3>Description</h3>

<p>Likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcCIR2(x, t, x0, theta, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcCIR2_+3A_x">x</code></td>
<td>
<p>current observation</p>
</td></tr>
<tr><td><code id="dcCIR2_+3A_t">t</code></td>
<td>
<p>time of observation</p>
</td></tr>
<tr><td><code id="dcCIR2_+3A_x0">x0</code></td>
<td>
<p>starting point, i.e. observation in time 0</p>
</td></tr>
<tr><td><code id="dcCIR2_+3A_theta">theta</code></td>
<td>
<p>parameter <code class="reqn">(\alpha, \beta, \sigma)</code></p>
</td></tr>
<tr><td><code id="dcCIR2_+3A_log">log</code></td>
<td>
<p>logical(1) if TRUE, log likelihood</p>
</td></tr>
</table>


<h3>References</h3>

<p>Iacus, S. M. (2008). Simulation and Inference for Stochastic Differential Equations.
</p>

<hr>
<h2 id='diagnostic'>Calcucation Of Burn-in Phase And Thinning Rate</h2><span id='topic+diagnostic'></span>

<h3>Description</h3>

<p>Proposal for burn-in and thin rate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostic(results, random)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnostic_+3A_results">results</code></td>
<td>
<p>Bayes.fit class object</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_random">random</code></td>
<td>
<p>one out of 1, 2, c(1,2)</p>
</td></tr>
</table>

<hr>
<h2 id='discr'>Simulation Of Random Variables</h2><span id='topic+discr'></span>

<h3>Description</h3>

<p>Simulation of (discrete) random variables from a vector of probability (the nonparametrically estimated values
of the density renormalised to sum at 1) and a vectors of real values (the grid of estimation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discr(x, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discr_+3A_x">x</code></td>
<td>
<p>n real numbers</p>
</td></tr>
<tr><td><code id="discr_+3A_p">p</code></td>
<td>
<p>vector of probability, length n</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y a simulated value from the discrete distribution
</p>

<hr>
<h2 id='eigenvaluesV'>Matrix Of Eigenvalues Of A List Of Symetric Matrices</h2><span id='topic+eigenvaluesV'></span>

<h3>Description</h3>

<p>Computation of the eigenvalues of each matrix Vj in the case of two random effects (random =c(1,2)), done via <code>eigen</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenvaluesV(V)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigenvaluesV_+3A_v">V</code></td>
<td>
<p>list of matrices Vj</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>eigenvalues</code></td>
<td>
<p>Matrix of 2 rows and as much columns as matrices V</p>
</td></tr>
</table>


<h3>References</h3>

<p>See Bidimensional random effect estimation in mixed stochastic differential model, C. Dion and V. Genon-Catalot,  <em>Stochastic Inference for Stochastic Processes 2015, Springer Netherlands</em>, <b>1&ndash;28</b>
</p>

<hr>
<h2 id='EstParamNormal'>Maximization Of The Log Likelihood In Mixed Stochastic Differential Equations</h2><span id='topic+EstParamNormal'></span>

<h3>Description</h3>

<p>Maximization of the loglikelihood of the mixed SDE with Normal distribution of the random effects
<code class="reqn">dXj(t)= (\alpha_j- \beta_j Xj(t))dt + \sigma a(Xj(t)) dWj(t)</code>, done with <code>likelihoodNormal</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstParamNormal(U, V, K, random, estim.fix, fixed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EstParamNormal_+3A_u">U</code></td>
<td>
<p>matrix of M sufficient statistics U</p>
</td></tr>
<tr><td><code id="EstParamNormal_+3A_v">V</code></td>
<td>
<p>list of the M sufficient statistics matrix V</p>
</td></tr>
<tr><td><code id="EstParamNormal_+3A_k">K</code></td>
<td>
<p>number of times of observations</p>
</td></tr>
<tr><td><code id="EstParamNormal_+3A_random">random</code></td>
<td>
<p>random effects in the drift: 1 if one additive random effect, 2 if one multiplicative random effect or c(1,2) if 2 random effects.</p>
</td></tr>
<tr><td><code id="EstParamNormal_+3A_estim.fix">estim.fix</code></td>
<td>
<p>1 if the fixed parameter is estimated, when random 1 or 2 , 0 otherwise</p>
</td></tr>
<tr><td><code id="EstParamNormal_+3A_fixed">fixed</code></td>
<td>
<p>value of the fixed parameter if known (not estimated)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mu</code></td>
<td>
<p>estimated value of the mean</p>
</td></tr>
<tr><td><code>Omega</code></td>
<td>
<p>estimated value of the variance</p>
</td></tr>
<tr><td><code>BIChere</code></td>
<td>
<p>BIC indicator</p>
</td></tr>
<tr><td><code>AIChere</code></td>
<td>
<p>AIC indicator</p>
</td></tr>
</table>

<hr>
<h2 id='Freq.fit-class'>S4 class for the frequentist estimation results</h2><span id='topic+Freq.fit-class'></span>

<h3>Description</h3>

<p>S4 class for the frequentist estimation results
</p>


<h3>Slots</h3>


<dl>
<dt><code>model</code></dt><dd><p>character 'OU' or 'CIR'</p>
</dd>
<dt><code>random</code></dt><dd><p>numeric 1, 2, or c(1,2)</p>
</dd>
<dt><code>fixed</code></dt><dd><p>numeric value of the fixed effect if there is one</p>
</dd>
<dt><code>gridf</code></dt><dd><p>matrix of values on which the estimated is done</p>
</dd>
<dt><code>mu</code></dt><dd><p>numeric MLE estimator for parametric approach</p>
</dd>
<dt><code>omega</code></dt><dd><p>numeric  MLE estimator for parametric approach</p>
</dd>
<dt><code>cutoff</code></dt><dd><p>value of the cutoff if there is one</p>
</dd>
<dt><code>sigma2</code></dt><dd><p>numeric estimated value of <code class="reqn">\sigma^2</code></p>
</dd>
<dt><code>estimf.trunc</code></dt><dd><p>matrix estimator of the density of <code class="reqn">\phi</code> for the truncated estimateur of the random effects</p>
</dd>
<dt><code>estimphi.trunc</code></dt><dd><p>matrix truncated estimator of the random effects</p>
</dd>
<dt><code>index</code></dt><dd><p>index of the used trajectories</p>
</dd>
<dt><code>estimphi</code></dt><dd><p>matrix of the estimator of the random effects</p>
</dd>
<dt><code>estimf</code></dt><dd><p>estimator of the density of <code class="reqn">\phi</code></p>
</dd>
<dt><code>estim.fixed</code></dt><dd><p>estimator of the fixed parameter if option estim.fix = 1</p>
</dd>
<dt><code>estim.fix</code></dt><dd><p>1 if the user asked for the estimation of fixed parameter</p>
</dd>
<dt><code>bic</code></dt><dd><p>numeric bic</p>
</dd>
<dt><code>aic</code></dt><dd><p>numeric aic</p>
</dd>
<dt><code>times</code></dt><dd><p>vector of observation times, storage of input variable</p>
</dd>
<dt><code>X</code></dt><dd><p>matrix of observations, storage of input variable</p>
</dd>
</dl>

<hr>
<h2 id='likelihoodNormal'>Computation Of The Log Likelihood In Mixed Stochastic Differential Equations</h2><span id='topic+likelihoodNormal'></span>

<h3>Description</h3>

<p>Computation of -2 loglikelihood of the mixed SDE with Normal distribution of the random effects
<code class="reqn">dXj(t)= (\alpha_j- \beta_j Xj(t))dt + \sigma a(Xj(t)) dWj(t)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likelihoodNormal(mu, omega, U, V, estimphi, random)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="likelihoodNormal_+3A_mu">mu</code></td>
<td>
<p>current value of the mean of the normal distribution</p>
</td></tr>
<tr><td><code id="likelihoodNormal_+3A_omega">omega</code></td>
<td>
<p>current value of the standard deviation of the normal distribution</p>
</td></tr>
<tr><td><code id="likelihoodNormal_+3A_u">U</code></td>
<td>
<p>vector of the M sufficient statistics U (see <code><a href="#topic+UV">UV</a></code>)</p>
</td></tr>
<tr><td><code id="likelihoodNormal_+3A_v">V</code></td>
<td>
<p>vector of the M sufficient statistics V (see <code><a href="#topic+UV">UV</a></code>)</p>
</td></tr>
<tr><td><code id="likelihoodNormal_+3A_estimphi">estimphi</code></td>
<td>
<p>vector or matrix of estimators of the random effects</p>
</td></tr>
<tr><td><code id="likelihoodNormal_+3A_random">random</code></td>
<td>
<p>random effects in the drift: 1 if one additive random effect, 2 if one multiplicative random effect or c(1,2) if 2 random effects.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>L</code></td>
<td>
<p>value of -2 x loglikelihood</p>
</td></tr>
</table>


<h3>References</h3>

<p>Maximum likelihood estimation for stochastic differential equations with random effects, M. Delattre, V. Genon-Catalot and A. Samson, <em>Scandinavian Journal of Statistics 2012</em>, Vol 40, <b>322&ndash;343</b>
</p>

<hr>
<h2 id='likelihoodNormalestimfix'>Likelihood Function When The Fixed Effect Is Estimated</h2><span id='topic+likelihoodNormalestimfix'></span>

<h3>Description</h3>

<p>Computation of -2 loglikelihood of the mixed SDE with Normal distribution of the random effects when the fixed effect is estimated for random 1 or 2
<code class="reqn">dXj(t)= (\alpha_j- \beta_j Xj(t))dt + \sigma a(Xj(t)) dWj(t)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likelihoodNormalestimfix(mu1, mu2, omega, U, V, estimphi, random)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="likelihoodNormalestimfix_+3A_mu1">mu1</code></td>
<td>
<p>current value of the mean of the first effect</p>
</td></tr>
<tr><td><code id="likelihoodNormalestimfix_+3A_mu2">mu2</code></td>
<td>
<p>current value of the mean of the second effect</p>
</td></tr>
<tr><td><code id="likelihoodNormalestimfix_+3A_omega">omega</code></td>
<td>
<p>current value of the standard deviation of the normal distribution</p>
</td></tr>
<tr><td><code id="likelihoodNormalestimfix_+3A_u">U</code></td>
<td>
<p>vector of the M sufficient statistics U (see <code><a href="#topic+UV">UV</a></code>)</p>
</td></tr>
<tr><td><code id="likelihoodNormalestimfix_+3A_v">V</code></td>
<td>
<p>vector of the M sufficient statistics V (see <code><a href="#topic+UV">UV</a></code>)</p>
</td></tr>
<tr><td><code id="likelihoodNormalestimfix_+3A_estimphi">estimphi</code></td>
<td>
<p>vector or matrix of estimators of the random effects</p>
</td></tr>
<tr><td><code id="likelihoodNormalestimfix_+3A_random">random</code></td>
<td>
<p>random effects in the drift: 1 if one additive random effect, 2 if one multiplicative random effect or c(1,2) if 2 random effects.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>L</code></td>
<td>
<p>value of -2 x loglikelihood</p>
</td></tr>
</table>


<h3>References</h3>

<p>Maximum likelihood estimation for stochastic differential equations with random effects, M. Delattre, V. Genon-Catalot and A. Samson, <em>Scandinavian Journal of Statistics 2012</em>, Vol 40, <b>322&ndash;343</b>
</p>

<hr>
<h2 id='mixedsde.fit'>Estimation Of The Random Effects In Mixed Stochastic Differential Equations</h2><span id='topic+mixedsde.fit'></span>

<h3>Description</h3>

<p>Estimation of the random effects <code class="reqn">(\alpha_j, \beta_j)</code> and of their density, parametrically or nonparametrically in the mixed SDE
<code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_j(t))dt + \sigma a(X_j(t)) dW_j(t)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixedsde.fit(times, X, model = c("OU", "CIR"), random, fixed = 0,
  estim.fix = 0, estim.method = c("nonparam", "paramML", "paramBayes"),
  gridf = NULL, prior, nMCMC = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixedsde.fit_+3A_times">times</code></td>
<td>
<p>vector of observation times</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_x">X</code></td>
<td>
<p>matrix of the M trajectories (each row is a trajectory with as much columns as observations)</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_model">model</code></td>
<td>
<p>name of the SDE: 'OU' (Ornstein-Uhlenbeck) or 'CIR' (Cox-Ingersoll-Ross)</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_random">random</code></td>
<td>
<p>random effects in the drift: 1 if one additive random effect, 2 if one multiplicative random effect or c(1,2) if 2 random effects</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_fixed">fixed</code></td>
<td>
<p>fixed effect in the drift: value of the fixed effect when there is only one random effect and it is not estimated, 0 otherwise</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_estim.fix">estim.fix</code></td>
<td>
<p>default 0, 1 if random = 1 or 2, method = 'paramML' then the fixed parameter is estimated</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_estim.method">estim.method</code></td>
<td>
<p>estimation method: 'paramML' for a Gaussian parametric estimation by maximum likelihood, 'paramBayes' for a Gaussian parametric Bayesian estimation or 'nonparam' for a non-parametric estimation</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_gridf">gridf</code></td>
<td>
<p>if nonparametric estimation: grid of values on which the density is estimated, a matrix with two rows if two random effects; NULL by default and
then grid is chosen as a function of the estimated values of the random effects. For the plots this grid is used.</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_prior">prior</code></td>
<td>
<p>if method = 'paramBayes', list of prior parameters: mean and variance of the Gaussian prior on the mean mu, shape and scale of the inverse Gamma prior for the variances omega, shape and scale of the inverse Gamma prior for sigma</p>
</td></tr>
<tr><td><code id="mixedsde.fit_+3A_nmcmc">nMCMC</code></td>
<td>
<p>if method = 'paramBayes', number of iterations of the MCMC algorithm</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the random effects density from M independent trajectories of the SDE (the Brownian motions <code class="reqn">W_j</code> are independent), with linear drift. Two diffusions are implemented, with one or two random effects:
</p>


<h4>Ornstein-Uhlenbeck model (OU)</h4>

<p>If random = 1, <code class="reqn">\beta</code> is a fixed effect: <code class="reqn">dX_j(t)= (\alpha_j- \beta X_j(t))dt + \sigma dW_j(t)  </code> 
</p>
<p>If random = 2, <code class="reqn">\alpha</code> is a fixed effect: <code class="reqn">dX_j(t)= (\alpha - \beta_j X_j(t))dt + \sigma dW_j(t)  </code>
</p>
<p>If random = c(1,2), <code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_j(t))dt + \sigma dW_j(t)  </code> 
</p>



<h4>Cox-Ingersoll-Ross model (CIR)</h4>

<p>If random = 1, <code class="reqn">\beta</code> is a fixed effect: <code class="reqn">dX_j(t)= (\alpha_j- \beta X_j(t))dt + \sigma \sqrt{X_(t)} dWj_(t)  </code> 
</p>
<p>If random = 2, <code class="reqn">\alpha</code> is a fixed effect: <code class="reqn">dX_j(t)= (\alpha - \beta_j X_j(t))dt + \sigma \sqrt{X_j(t)} dW_j(t)  </code> 
</p>
<p>If random = c(1,2), <code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_j(t))dt + \sigma \sqrt{X_j(t)}  dW_j(t)  </code> 
</p>

<p>The nonparametric method estimates the density of the random effects with a kernel estimator (one-dimensional or two-dimensional density).
The parametric method estimates the mean and standard deviation of the Gaussian distribution of the random effects.
</p>
<p>Validation method:
For a number of trajectory numj (fixed by the user or randomly chosen) this function simulates 
Mrep =100 (by default) new trajectories with the value of the estimated random effect. 
Then it plots on the left graph the Mrep new trajectories 
<code class="reqn">(Xnumj^{k}(t1), ... Xnumj^{k}(tN)), k= 1, ... Mrep</code> with in red the true trajectory 
<code class="reqn">(Xnumj(t1), ... Xnumj(tN))</code>. The right graph is a qq-plot of the quantiles of samples 
<code class="reqn">(Xnumj^{1}(ti), ... Xnumj^{Mrep}(ti))</code>
for each time <code class="reqn">ti</code> compared with the uniform quantiles. The outputs of the function  
are: a matrix <code>Xnew</code> dimension Mrepx N+1, vector of quantiles <code>quantiles</code> length 
N and the number of the trajectory for the plot <code>numj</code> 
</p>
<p>Prediction method for the frequentist approach:
This function uses the estimation of the density function to simulate a 
new sample of random effects according to this density. If <code>plot.pred =1</code> (default)
is plots on the top the predictive random effects versus the estimated random effects
from the data. On the bottom, the left graph is the true trajectories, on the right
the predictive trajectories and the empiric prediciton intervals at level 
<code>level=0.05</code> (defaut). The function return on a list the prediction of phi 
<code>phipred</code>, the prediction of X <code>Xpred</code>, and the indexes of the 
corresponding true trajectories <code>indexpred</code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>index</code></td>
<td>
<p>is the vector of subscript in <code class="reqn">1,...,M</code> where the estimation of <code class="reqn">phi</code> has been done,  most of the time <code class="reqn">index= 1:M</code></p>
</td></tr>
<tr><td><code>estimphi</code></td>
<td>
<p>matrix of estimators of <code class="reqn">\phi=\alpha, or \beta, or (\alpha,\beta)</code> from the efficient statitics (see <code><a href="#topic+UV">UV</a></code>), matrix of two lines if random =c(1,2), numerical type otherwise</p>
</td></tr>
<tr><td><code>estim.fixed</code></td>
<td>
<p>if estim.fix is TRUE and random = 1 or 2, estimator of <code class="reqn">\phi=\alpha, or \beta</code> from the efficient statitics (see <code><a href="#topic+UV">UV</a></code>), 0 otherwise</p>
</td></tr>
<tr><td><code>gridf</code></td>
<td>
<p>grid of values on which the estimated is done for the nonparametric method, otherwise, grid used for the plots, matrix form</p>
</td></tr>
<tr><td><code>estimf</code></td>
<td>
<p>estimator of the density of <code class="reqn">\phi</code> from a kernel estimator from package: stats, function: density, or package: MASS, function: kde2D. Matrix form: one line if one random effect or square matrix otherwise</p>
</td></tr>
</table>
<p>If there is a truncation threshold in the estimator
</p>
<table>
<tr><td><code>cutoff</code></td>
<td>
<p>the binary vector of cutoff, FALSE otherwise</p>
</td></tr>
<tr><td><code>estimphi.trunc</code></td>
<td>
<p>troncated estimator of <code class="reqn">\phi</code>, vector or matrix of 0 if we do not use truncation, matrix of two lines if random =c(1,2), numerical type otherwise</p>
</td></tr>
<tr><td><code>estimf.trunc</code></td>
<td>
<p>troncated estimator of the density of <code class="reqn">\phi</code>, vector or matrix of 0 if we do not use truncation, matrix if random =c(1,2), numerical type otherwise</p>
</td></tr>
</table>
<p>For the parametric maximum likelihood estimation 
</p>
<table>
<tr><td><code>mu</code></td>
<td>
<p>estimator of the mean of the random effects normal density, 0 if we do nonparametric estimation</p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>estimator of the standard deviation of the random effects normal density, 0 if we do nonparametric estimation</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>BIC criterium, 0 if we do nonparametric estimation</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC criterium, 0 if we do nonparametric estimation</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>initial choice</p>
</td></tr>
<tr><td><code>random</code></td>
<td>
<p>initial choice</p>
</td></tr>
<tr><td><code>fixed</code></td>
<td>
<p>initial choice</p>
</td></tr>
<tr><td><code>times</code></td>
<td>
<p>initial choice</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>initial choice</p>
</td></tr>
</table>
<p>For the parametric Bayesian estimation 
</p>
<table>
<tr><td><code>alpha</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\alpha</code></p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\beta</code></p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\mu</code></p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\Omega</code></p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>posterior samples (Markov chain) of <code class="reqn">\sigma^2</code></p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>initial choice</p>
</td></tr>
<tr><td><code>random</code></td>
<td>
<p>initial choice</p>
</td></tr>
<tr><td><code>burnIn</code></td>
<td>
<p>proposal for burn-in period</p>
</td></tr>
<tr><td><code>thinning</code></td>
<td>
<p>proposal for thinning rate</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>initial choice or calculated by the first 10% of series</p>
</td></tr>
<tr><td><code>times</code></td>
<td>
<p>initial choice</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>initial choice</p>
</td></tr>
<tr><td><code>ind.4.prior</code></td>
<td>
<p>in the case of calculation of prior parameters: the indices of used series</p>
</td></tr>
</table>


<h3>References</h3>

<p>For the parametric estimation see:
Maximum likelihood estimation for stochastic differential equations with random effects, M. Delattre, V. Genon-Catalot and A. Samson, <em>Scandinavian Journal of Statistics 2012</em>, Vol 40, <b>322&ndash;343</b>
</p>
<p>Bayesian Prediction of Crack Growth Based on a Hierarchical Diffusion Model.  S. Hermann, K. Ickstadt and C. Mueller, <em>appearing in: Applied Stochastic Models in Business and Industry 2016</em>.
</p>
<p>For the nonparametric estimation see:
</p>
<p>Nonparametric estimation for stochastic differential equations with random effects, F. Comte, V. Genon-Catalot and A. Samson, <em>Stochastic Processes and Their Applications 2013</em>, Vol 7, <b>2522&ndash;2551</b>
</p>
<p>Estimation for stochastic differential equations with mixed effects, V. Genon-Catalot and C. Laredo 2014 <em>e-print: hal-00807258 </em>
</p>
<p>Bidimensional random effect estimation in mixed stochastic differential model, C. Dion and V. Genon-Catalot,  <em>Stochastic Inference for Stochastic Processes 2015, Springer Netherlands</em>, <b>1&ndash;28</b>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Frequentist estimation
# Two random effects
model = 'CIR'; T &lt;- 10
delta &lt;- 0.1; M &lt;- 100 # delta &lt;- 0.001 and M &lt;- 200 would yield good results
N &lt;- floor(T/delta); sigma &lt;- 0.01 ;
random &lt;- c(1,2); density.phi &lt;- 'gammainvgamma2'; param&lt;- c(1.8, 0.8, 8, 0.05);  
simu &lt;- mixedsde.sim(M=M, T=T, N=N, model=model,random=random, density.phi=density.phi, 
               param=param, sigma=sigma, invariant = 1)
X &lt;- simu$X ; phi &lt;- simu$phi; times &lt;- simu$times
estim.method&lt;- 'nonparam'
estim &lt;- mixedsde.fit(times=times, X=X, model=model, random=random, estim.method= 'nonparam') 
#To stock the results of the function, use method \code{out}
#which put the outputs of the function on a list according to the frequentist or 
# Bayesian approach.
outputsNP &lt;- out(estim)

## Not run: 
plot(estim)
## End(Not run)
# It represents the bidimensional density, the histogram of the first estimated random 
# effect \eqn{\alpha} with the  marginal of \eqn{\hat{f}} from the first coordonate which 
# estimates  the density of \eqn{\alpha}. And the same for the second random effect 
# \eqn{\beta}. More, it plots a qq-plot for the sample of estimator of the random effects 
# compared with the quantiles of a Gaussian sample with the same mean and standard deviation.

summary(estim)
print(estim)
# Validation 

validation &lt;- valid(estim)

# Parametric estimation
estim.method&lt;-'paramML'
estim_param &lt;- mixedsde.fit(times= times, X= X, model= model, random= random, 
           estim.method = 'paramML') 
outputsP &lt;- out(estim_param)

#plot(estim_param)
summary(estim_param)

# Not run
## Not run: 
test1 &lt;- pred(estim,  invariant  = 1)
test2 &lt;- pred(estim_param, invariant  = 1)

## End(Not run)
# More graph
fhat &lt;- outputsNP$estimf  
fhat_trunc &lt;- outputsNP$estimf.trunc 
fhat_param &lt;- outputsP$estimf

gridf &lt;- outputsNP$gridf; gridf1 &lt;- gridf[1,]; gridf2 &lt;- gridf[2,]

marg1 &lt;- ((max(gridf2)-min(gridf2))/length(gridf2))*apply(fhat,1,sum) 
marg1_trunc &lt;- ((max(gridf2)-min(gridf2))/length(gridf2))*apply(fhat_trunc,1,sum) 
marg2 &lt;- ((max(gridf1)-min(gridf1))/length(gridf1))*apply(fhat,2,sum)
marg2_trunc &lt;- ((max(gridf1)-min(gridf1))/length(gridf1))*apply(fhat_trunc,2,sum)

marg1_param &lt;- ((max(gridf2)-min(gridf2))/length(gridf2))*apply(fhat_param,1,sum) 
marg2_param &lt;- ((max(gridf1)-min(gridf1))/length(gridf1))*apply(fhat_param,2,sum)
f1 &lt;-  (gridf1^(param[1]-1))*exp(-gridf1/param[2])/((param[2])^param[1]*gamma(param[1]))
f2 &lt;-  (gridf2^(-param[3]-1)) * exp(-(1/param[4])*(1/gridf2)) * 
 ((1/param[4])^param[3])*(1/gamma(param[3]))
par(mfrow=c(1,2))
plot(gridf1,f1,type='l', lwd=1,  xlab='', ylab='')
lines(gridf1,marg1_trunc,col='blue', lwd=2)
lines(gridf1,marg1,col='blue', lwd=2, lty=2)
lines(gridf1,marg1_param,col='red', lwd=2, lty=2)
plot(gridf2,f2,type='l', lwd=1, xlab='', ylab='')
lines(gridf2,marg2_trunc,col='blue', lwd=2)
lines(gridf2,marg2,col='blue', lwd=2, lty=2)
lines(gridf2,marg2_param,col='red', lwd=2, lty=2)

cutoff &lt;- outputsNP$cutoff
phihat &lt;- outputsNP$estimphi 
phihat_trunc &lt;- outputsNP$estimphi.trunc
par(mfrow=c(1,2))
plot.ts(phi[1,], phihat[1,], xlim=c(0, 15), ylim=c(0,15), pch=18); abline(0,1)
points(phi[1,]*(1-cutoff), phihat[1,]*(1-cutoff), xlim=c(0, 20), ylim=c(0,20),pch=18, col='red'); 
abline(0,1)
plot.ts(phi[2,], phihat[2,], xlim=c(0, 15), ylim=c(0,15),pch=18); abline(0,1)
points(phi[2,]*(1-cutoff), phihat[2,]*(1-cutoff), xlim=c(0, 20), ylim=c(0,20),pch=18, col='red'); 
abline(0,1)

# one random effect: 
## Not run: 
model &lt;-'OU'
random &lt;- 1
M &lt;- 80; T &lt;- 100  ; N &lt;- 2000 
sigma &lt;- 0.1 ; X0 &lt;- 0
density.phi &lt;- 'normal'
fixed &lt;- 2 ; param &lt;- c(1, 0.2)
#-------------------
#- simulation
simu &lt;- mixedsde.sim(M,T=T,N=N,model=model,random=random, fixed=fixed,density.phi=density.phi, 
               param=param, sigma=sigma, X0=X0)
X &lt;- simu$X
phi &lt;- simu$phi
times &lt;-simu$times
plot(times, X[10,], type='l')

#- parametric estimation
estim.method&lt;-'paramML'
estim_param &lt;- mixedsde.fit(times, X=X, model=model, random=random, estim.fix= 1, 
               estim.method=estim.method)
outputsP &lt;- out(estim_param)
estim.fixed &lt;- outputsP$estim.fixed #to compare with fixed
#or 
estim_param2 &lt;- mixedsde.fit(times, X=X, model=model, random=random, fixed = fixed, 
             estim.method=estim.method)
outputsP2 &lt;- out(estim_param2)
#- nonparametric estimation
estim.method &lt;- 'nonparam'
estim &lt;- mixedsde.fit(times, X, model=model, random=random, fixed = fixed, 
           estim.method=estim.method) 
outputsNP &lt;- out(estim)

plot(estim)
print(estim)
summary(estim)

plot(estim_param)
print(estim_param)
summary(estim_param)

valid1 &lt;- valid(estim)
test1 &lt;- pred(estim )
test2 &lt;- pred(estim_param)

## End(Not run)

# Parametric Bayesian estimation 
# one random effect
random &lt;- 1; sigma &lt;- 0.1; fixed &lt;- 5; param &lt;- c(3, 0.5)
sim &lt;- mixedsde.sim(M = 20, T = 1, N = 50, model = 'OU', random = random, fixed = fixed,
       density.phi = 'normal',param= param, sigma= sigma, X0 = 0, op.plot = 1)

# here: only 100 iterations for example - should be much more!
prior &lt;- list( m = c(param[1], fixed), v = c(param[1], fixed), alpha.omega = 11,
            beta.omega = param[2]^2*10, alpha.sigma = 10, beta.sigma = sigma^2*9)
estim_Bayes &lt;- mixedsde.fit(times = sim$times, X = sim$X, model = 'OU', random, 
           estim.method = 'paramBayes', prior = prior, nMCMC = 100) 

validation &lt;- valid(estim_Bayes, numj = 10)
plot(estim_Bayes)
outputBayes &lt;- out(estim_Bayes)
summary(outputBayes)
(results_Bayes &lt;- summary(estim_Bayes))
plot(estim_Bayes, style = 'cred.int', true.phi = sim$phi)
print(estim_Bayes)
## Not run: 
pred.result &lt;- pred(estim_Bayes)
summary(out(pred.result))
plot(pred.result)

pred.result.trajectories &lt;- pred(estim_Bayes, trajectories = TRUE)

## End(Not run)
# second example
## Not run: 
random &lt;- 2; sigma &lt;- 0.2; fixed &lt;- 5; param &lt;- c(3, 0.5)
sim &lt;- mixedsde.sim(M = 20, T = 1, N = 100, model = 'CIR', random = random, 
        fixed = fixed, density.phi = 'normal',param = param, sigma = sigma, X0 = 0.1, op.plot = 1)

prior &lt;- list(m = c(fixed, param[1]), v = c(fixed, param[1]), alpha.omega = 11, 
         beta.omega = param[2]^2*10, alpha.sigma = 10, beta.sigma = sigma^2*9)

estim_Bayes &lt;- mixedsde.fit(times = sim$times, X = sim$X, model = 'CIR', random = random, 
                 estim.method = 'paramBayes', prior = prior, nMCMC = 1000) 

pred.result &lt;- pred(estim_Bayes)

## End(Not run)



# invariant case
## Not run: 
random &lt;- 1; sigma &lt;- 0.1; fixed &lt;- 5; param &lt;- c(3, 0.5)
sim &lt;- mixedsde.sim(M = 50, T = 5, N = 100, model = 'OU', random = random, fixed = fixed, 
           density.phi = 'normal',param = param, sigma = sigma, invariant = 1, op.plot = 1)

prior &lt;- list(m = c(param[1], fixed), v = c(param[1], 1e-05), alpha.omega = 11, 
       beta.omega = param[2]^2*10, alpha.sigma = 10, beta.sigma = sigma^2*9)
estim_Bayes &lt;- mixedsde.fit(times = sim$times, X = sim$X, model = 'OU', random, 
       estim.method = 'paramBayes', prior = prior, nMCMC = 100) 
plot(estim_Bayes)

pred.result &lt;- pred(estim_Bayes, invariant = 1)
pred.result.traj &lt;- pred(estim_Bayes, invariant = 1, trajectories = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='mixedsde.sim'>Simulation Of A Mixed Stochastic Differential Equation</h2><span id='topic+mixedsde.sim'></span>

<h3>Description</h3>

<p>Simulation of M independent trajectories of a mixed stochastic differential equation (SDE) with linear drift  and two random effects <code class="reqn">(\alpha_j, \beta_j)</code>
<code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_(t))dt + \sigma a(X_j(t)) dW_j(t)</code>, for <code class="reqn">j=1, ..., M</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixedsde.sim(M, T, N = 100, model, random, fixed = 0, density.phi,
  param, sigma, t0 = 0, X0 = 0.01, invariant = 0, delta = T/N,
  op.plot = 0, add.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixedsde.sim_+3A_m">M</code></td>
<td>
<p>number of trajectories</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_t">T</code></td>
<td>
<p>horizon of simulation.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_n">N</code></td>
<td>
<p>number of simulation steps, default Tx100.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_model">model</code></td>
<td>
<p>name of the SDE: 'OU' (Ornstein-Uhlenbeck) or 'CIR' (Cox-Ingersoll-Ross).</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_random">random</code></td>
<td>
<p>random effects in the drift: 1 if one additive random effect, 2 if one multiplicative random effect or c(1,2) if 2 random effects.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_fixed">fixed</code></td>
<td>
<p>fixed effects in the drift: value of the fixed effect when there is only one random effect, 0 otherwise. 
If random =2, fixed can be 0 but <code class="reqn">\beta</code> has to be a non negative random variable for the estimation.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_density.phi">density.phi</code></td>
<td>
<p>name of the density of the random effects.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_param">param</code></td>
<td>
<p>vector of parameters of the distribution of the two random effects.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_sigma">sigma</code></td>
<td>
<p>diffusion parameter</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_t0">t0</code></td>
<td>
<p>time origin, default 0.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_x0">X0</code></td>
<td>
<p>initial value of the process, default X0=0.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_invariant">invariant</code></td>
<td>
<p>1 if the initial value is simulated from the invariant distribution, default 0.01 and X0 is fixed.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_delta">delta</code></td>
<td>
<p>time step of the simulation (T/N).</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_op.plot">op.plot</code></td>
<td>
<p>1 if a plot of the trajectories is required, default 0.</p>
</td></tr>
<tr><td><code id="mixedsde.sim_+3A_add.plot">add.plot</code></td>
<td>
<p>1 for add trajectories to an existing plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulation of M independent trajectories of the SDE (the Brownian motions <code class="reqn">Wj</code> are independent), with linear drift. Two diffusions are implemented, with one or two random effects:
</p>


<h4>Ornstein-Uhlenbeck model (OU)</h4>

<p>If random = 1, <code class="reqn">\beta</code> is a fixed effect: <code class="reqn">dX_j(t)= (\alpha_j- \beta X_j(t))dt + \sigma dW_j(t)  </code> 
</p>
<p>If random = 2, <code class="reqn">\alpha</code> is a fixed effect: <code class="reqn">dX_j(t)= (\alpha - \beta_j X_j(t))dt + \sigma dW_j(t)  </code>
</p>
<p>If random = c(1,2), <code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_j(t))dt + \sigma dW_j(t)  </code> 
</p>



<h4>Cox-Ingersoll-Ross model (CIR)</h4>

<p>If random = 1, <code class="reqn">\beta</code> is a fixed effect: <code class="reqn">dX_j(t)= (\alpha_j- \beta X_j(t))dt + \sigma \sqrt{X_j(t)} dW_j(t)  </code> 
</p>
<p>If random = 2, <code class="reqn">\alpha</code> is a fixed effect: <code class="reqn">dX_j(t)= (\alpha - \beta_j X_j(t))dt + \sigma \sqrt{X_j(t)} dW_j(t)  </code> 
</p>
<p>If random = c(1,2), <code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_j(t))dt + \sigma \sqrt{X_j(t)}  dW_j(t)  </code> 
</p>

<p>The initial value of each trajectory can be simulated from the invariant distribution of the process:
Normal distribution with mean <code class="reqn">\alpha/\beta</code> and variance <code class="reqn">\sigma^2/(2 \beta)</code> for the OU,  a gamma distribution
<code class="reqn">\Gamma(2\alpha/\sigma^2,  \sigma^2/(2\beta))</code> for the C-I-R model.
</p>


<h4>Density of the random effects</h4>

<p>Several densities are implemented for the random effects, depending on the number of random effects. 
</p>
<p><em>If two random effects, choice between</em> 
</p>
<p>'normalnormal': Normal distributions for both  <code class="reqn">\alpha</code> <code class="reqn">\beta</code> and param=c(mean_<code class="reqn">\alpha</code>, sd_<code class="reqn">\alpha</code>, mean_<code class="reqn">\beta</code>, sd_<code class="reqn">\beta</code>)
</p>
<p>'gammagamma': Gamma distributions for both  <code class="reqn">\alpha</code> <code class="reqn">\beta</code> and param=c(shape_<code class="reqn">\alpha</code>, scale_<code class="reqn">\alpha</code>, shape_<code class="reqn">\beta</code>, scale_<code class="reqn">\beta</code>)
</p>
<p>'gammainvgamma': Gamma for <code class="reqn">\alpha</code>, Inverse Gamma for <code class="reqn">\beta</code> and param=c(shape_<code class="reqn">\alpha</code>, scale_<code class="reqn">\alpha</code>, shape_<code class="reqn">\beta</code>, scale_<code class="reqn">\beta</code>)
</p>
<p>'normalgamma':  Normal for <code class="reqn">\alpha</code>, Gamma for <code class="reqn">\beta</code> and param=c(mean_<code class="reqn">\alpha</code>, sd_<code class="reqn">\alpha</code>, shape_<code class="reqn">\beta</code>, scale_<code class="reqn">\beta</code>)
</p>
<p>'normalinvgamma':  Normal for <code class="reqn">\alpha</code>, Inverse Gamma for <code class="reqn">\beta</code> and param=c(mean_<code class="reqn">\alpha</code>, sd_<code class="reqn">\alpha</code>, shape_<code class="reqn">\beta</code>, scale_<code class="reqn">\beta</code>)
</p>
<p>'gammagamma2':  Gamma <code class="reqn">+2 * \sigma^2</code> for <code class="reqn">\alpha</code>,  Gamma <code class="reqn">+ 1</code> for <code class="reqn">\beta</code>  and param=c(shape_<code class="reqn">\alpha</code>, scale_<code class="reqn">\alpha</code>, shape_<code class="reqn">\beta</code>, scale_<code class="reqn">\beta</code>)
</p>
<p>'gammainvgamma2':   Gamma <code class="reqn">+2 * \sigma^2</code> for <code class="reqn">\alpha</code>, Inverse Gamma for <code class="reqn">\beta</code> and param=c(shape_<code class="reqn">\alpha</code>, scale_<code class="reqn">\alpha</code>, shape_<code class="reqn">\beta</code>, scale_<code class="reqn">\beta</code>)
</p>
<p><em>If only <code class="reqn">\alpha</code> is random, choice between</em>
</p>
<p>'normal': Normal distribution with param=c(mean, sd)
</p>
<p>lognormal': logNormal distribution with param=c(mean, sd)
</p>
<p>'mixture.normal': mixture of normal distributions <code class="reqn">p N(\mu1,\sigma1^2) + (1-p)N(\mu2, \sigma2^2)</code> with 
param=c(p, <code class="reqn">\mu1, \sigma1, \mu2, \sigma2</code>)
</p>
<p>'gamma': Gamma distribution with param=c(shape, scale) 
</p>
<p>'mixture.gamma': mixture of Gamma distribution <code class="reqn">p \Gamma(shape1,scale1) + (1-p)\Gamma(shape2,scale2)</code>
with param=c(p, shape1, scale1, shape2, scale2)
</p>
<p>'gamma2': Gamma distribution <code class="reqn">+2 * \sigma^2</code> with param=c(shape, scale) 
</p>
<p>'mixed.gamma2': mixture of Gamma distribution <code class="reqn">p \Gamma(shape1,scale1) + (1-p) \Gamma(shape2,scale2)</code> + <code class="reqn">+2 * \sigma^2</code>
with param=c(p, shape1, scale1, shape2, scale2)
</p>
<p><em>If only <code class="reqn">\beta</code> is random, choice between</em>
'normal': Normal distribution with param=c(mean, sd)
</p>
<p>'gamma': Gamma distribution with param=c(shape, scale) 
</p>
<p>'mixture.gamma': mixture of Gamma distribution <code class="reqn">p \Gamma(shape1,scale1) + (1-p) \Gamma(shape2,scale2)</code>
with param=c(p, shape1, scale1, shape2, scale2)
</p>



<h3>Value</h3>

<table>
<tr><td><code>X</code></td>
<td>
<p>matrix (M x (N+1)) of the M trajectories. </p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>vector (or matrix) of the M simulated random effects.</p>
</td></tr>
</table>


<h3>References</h3>

<p>This function mixedsde.sim is based on the package sde, function sde.sim. See Simulation and Inference for stochastic differential equation, S.Iacus, <em>Springer Series in Statistics 2008</em>
Chapter 2
</p>


<h3>See Also</h3>

<p><a href="https://cran.r-project.org/package=sde">https://cran.r-project.org/package=sde</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Simulation of 5 trajectories of the OU SDE with random =1, and a Gamma distribution.

simuOU &lt;- mixedsde.sim(M=5, T=10,N=1000,model='OU', random=1,fixed=0.5,
density.phi='gamma', param=c(1.8, 0.8) , sigma=0.1,op.plot=1)
X &lt;- simuOU$X ; 
phi &lt;- simuOU$phi
hist(phi)
</code></pre>

<hr>
<h2 id='mixture.sim'>Simulation Of A Mixture Of Two Normal Or Gamma Distributions</h2><span id='topic+mixture.sim'></span>

<h3>Description</h3>

<p>Simulation of M random variables from a mixture of two Gaussian or Gamma distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixture.sim(M, density.phi, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixture.sim_+3A_m">M</code></td>
<td>
<p>number of simulated variables</p>
</td></tr>
<tr><td><code id="mixture.sim_+3A_density.phi">density.phi</code></td>
<td>
<p>name of the chosen density 'mixture.normal' or 'mixture.gamma'</p>
</td></tr>
<tr><td><code id="mixture.sim_+3A_param">param</code></td>
<td>
<p>vector of parameters with the proportion of mixture of the two distributions and means and standard-deviations of the two normal or 
shapes and scales of the two Gamma distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If 'mixture.normal', the distribution is <code class="reqn">p N(\mu1,\sigma1^2) + (1-p)N(\mu2, \sigma2^2)</code>
</p>
<p>and param=c(p, <code class="reqn">\mu1, \sigma1, \mu2, \sigma2</code>)
</p>
<p>If 'mixture.gamma', the distribution is <code class="reqn">p Gamma(shape1,scale1) + (1-p)Gamma(shape2,scale2)</code>
</p>
<p>and param=c(p, shape1, scale1, shape2, scale2)
</p>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>vector of simulated variables</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>density.phi &lt;- 'mixture.gamma'
param &lt;- c(0.2,1.8,0.5,5.05,1); M &lt;- 200
gridf &lt;- seq(0, 8, length = 200)  
f &lt;- param[1] * 1/gamma(param[2]) * (gridf)^(param[2]-1) * 
           exp(-(gridf) / param[3]) / param[3]^param[2] + 
           (1-param[1]) * 1/gamma(param[4]) * (gridf)^(param[4]-1) * 
           exp(-(gridf) / param[5]) / param[5]^param[4]
Y &lt;- mixture.sim(M, density.phi, param)
hist(Y)
lines(gridf, f)
</code></pre>

<hr>
<h2 id='neuronal.data'>
Trajectories Interspike Of A Single Neuron Of A Ginea Pig
</h2><span id='topic+neuronal.data'></span>

<h3>Description</h3>

<p>The <code>neuronal.data</code> data has 240 measurements of the membrane potential in volts for one single neuron of a pig between the spikes, along time, with 2000 points for each. The step time is <code class="reqn">delta= 0.00015</code> s. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("neuronal.data")</code></pre>


<h3>Format</h3>

<p>This data frame has a list form of length 2. The first element in the matrix named <code>Xreal</code>. Each row is a trajectory, that one can model by a diffusion process with random effect. The realisation can be assumed independent. The second element is a vector of times of observations <code>times</code>
</p>


<h3>Source</h3>

<p>The parameters of the stochastic leaky integrate-and-fire neuronal model.
Lansky, P., Sanda, P. and He, J. (2006).
<em>Journal of Computational Neuroscience</em> Vol 21, <b>211&ndash;223</b>
</p>


<h3>References</h3>

<p>The parameters of the stochastic leaky integrate-and-fire neuronal model.
Lansky, P., Sanda, P. and He, J. (2006).
<em>Journal of Computational Neuroscience</em> Vol 21, <b>211&ndash;223</b>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- "OU"
random &lt;- c(1,2)
M &lt;- 240     # number of trajectories, number of rows of the matrix of the data
T &lt;- 0.3     # width of the interval of observation 
delta &lt;- 0.00015   # step time
N &lt;- T/delta  # number of points in the time interval 2000

data(neuronal.data)
# reduction of data for example to save running times
ind &lt;- seq(1, 2000, by = 20)
X &lt;- neuronal.data[[1]][1:100, ind]
times &lt;- neuronal.data[[2]][ind]

# plot(times, X[10, ], type = 'l', xlab = 'time', ylab = '', col = 'blue', ylim = c(0,0.016))

random &lt;- c(1,2)

#- nonparametric estimation
estim.method &lt;- 'nonparam'
estim &lt;- mixedsde.fit(times=times, X=X, model=model, random=random,  estim.method='nonparam') 

#- parametric estimation   
estim.method&lt;-'paramML'
estim_param &lt;- mixedsde.fit(times=times, X=X, model=model, random= random, estim.method= 'paramML')

#- implemented methods
# plot(estim); 
print(estim); #valid(estim)
print(estim_param); #plot(estim_param);  valid(estim_param)

#test1 &lt;- pred(estim)
#test2 &lt;- pred(estim_param) 

#- Other possible plots
par(mfrow=c(1,2))

outputsNP &lt;-  out(estim)
outputsP &lt;- out(estim_param)
fhat &lt;- outputsNP$estimf
fhat_param &lt;- outputsP$estimf 

gridf &lt;- outputsNP$gridf
gridf1 &lt;- gridf[1,]; gridf2 &lt;- gridf[2,]
marg1 &lt;- ((max(gridf2)-min(gridf2))/length(gridf2))*apply(fhat,1,sum) #with cutoff
marg2 &lt;- ((max(gridf1)-min(gridf1))/length(gridf1))*apply(fhat,2,sum)
marg1_param &lt;- ((max(gridf2)-min(gridf2))/length(gridf2))*apply(fhat_param,1,sum) 
marg2_param &lt;- ((max(gridf1)-min(gridf1))/length(gridf1))*apply(fhat_param,2,sum)

plot(gridf1,marg1,type='l', col='red')
lines(gridf1,marg1_param, lwd=2, col='red')
plot(gridf2, marg2,type='l', col='red')
lines(gridf2,marg2_param, lwd=2, col='red')


# Bayesian
# reduction of data to save running time
estim_Bayes &lt;- mixedsde.fit(times, X[1:20,], model = "OU", random = 1, 
              estim.method = "paramBayes", nMCMC = 100) 
plot(estim_Bayes)
pred_Bayes1 &lt;- pred(estim_Bayes)
pred_Bayes2 &lt;- pred(estim_Bayes, trajectories = TRUE)

</code></pre>

<hr>
<h2 id='out'>Transfers the class object to a list</h2><span id='topic+out'></span>

<h3>Description</h3>

<p>Method for the S4 classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>out(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="out_+3A_x">x</code></td>
<td>
<p>Freq.fit, Bayes.fit or Bayes.pred class</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='plot+2CBayes.fit+2CANY-method'>Plot method for the Bayesian estimation class object</h2><span id='topic+plot+2CBayes.fit+2CANY-method'></span>

<h3>Description</h3>

<p>Plot method for the S4 class Bayes.fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Bayes.fit,ANY'
plot(x, plot.priorMean = FALSE,
  reduced = FALSE, style = c("chains", "acf", "density", "cred.int"),
  level = 0.05, true.phi, newwindow = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CBayes.fit+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>Bayes.fit class</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.fit+2B2CANY-method_+3A_plot.priormean">plot.priorMean</code></td>
<td>
<p>logical(1), if TRUE, prior means are added to the plots</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.fit+2B2CANY-method_+3A_reduced">reduced</code></td>
<td>
<p>logical(1), if TRUE, the chains are reduced with the burn-in and thin rate</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.fit+2B2CANY-method_+3A_style">style</code></td>
<td>
<p>one out of 'chains', 'acf', 'density' or 'cred.int'</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.fit+2B2CANY-method_+3A_level">level</code></td>
<td>
<p>alpha for the credibility intervals, only for style 'cred.int', default = 0.05</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.fit+2B2CANY-method_+3A_true.phi">true.phi</code></td>
<td>
<p>only for style 'cred.int', for the case of known true values, e.g. for simulation</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.fit+2B2CANY-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.fit+2B2CANY-method_+3A_...">...</code></td>
<td>
<p>optional plot parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>random &lt;- c(1,2); sigma &lt;- 0.1; param &lt;- c(3, 0.5, 5, 0.2)

sim &lt;- mixedsde.sim(M = 20, T = 1, N = 50, model = 'OU', random = random, 
       density.phi = 'normalnormal', param = param, sigma = sigma, X0 = 0, op.plot = 1)

# here: only 100 iterations for example - should be much more!
prior &lt;- list(m = param[c(1,3)], v = param[c(1,3)], alpha.omega = c(11,11), 
           beta.omega = param[c(2,4)]^2*10, alpha.sigma = 10, beta.sigma = sigma^2*9)
estim_Bayes &lt;- mixedsde.fit(times = sim$times, X = sim$X, model = 'OU', random = random,
                estim.method = 'paramBayes', prior = prior, nMCMC = 100) 
plot(estim_Bayes)
plot(estim_Bayes, style = 'cred.int', true.phi = sim$phi)
plot(estim_Bayes, style = 'acf')
plot(estim_Bayes, style = 'density')

</code></pre>

<hr>
<h2 id='plot+2CBayes.pred+2CANY-method'>Plot method for the Bayesian prediction class object</h2><span id='topic+plot+2CBayes.pred+2CANY-method'></span>

<h3>Description</h3>

<p>Plot method for the S4 class Bayes.pred
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Bayes.pred,ANY'
plot(x, newwindow = FALSE,
  plot.legend = TRUE, ylim, xlab = "times", ylab = "X", col = 3,
  lwd = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>Bayes.fit class</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_plot.legend">plot.legend</code></td>
<td>
<p>logical(1)</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_ylim">ylim</code></td>
<td>
<p>optional</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_xlab">xlab</code></td>
<td>
<p>optional, default 'times'</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_ylab">ylab</code></td>
<td>
<p>optional, default 'X'</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_col">col</code></td>
<td>
<p>color for the prediction intervals, default 3</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_lwd">lwd</code></td>
<td>
<p>linewidth for the prediction intervals, default 2</p>
</td></tr>
<tr><td><code id="plot+2B2CBayes.pred+2B2CANY-method_+3A_...">...</code></td>
<td>
<p>optional plot parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='plot+2CFreq.fit+2CANY-method'>Plot method for the frequentist estimation class object</h2><span id='topic+plot+2CFreq.fit+2CANY-method'></span>

<h3>Description</h3>

<p>Plot method for the S4 class Freq.fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Freq.fit,ANY'
plot(x, newwindow = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CFreq.fit+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>Freq.fit class</p>
</td></tr>
<tr><td><code id="plot+2B2CFreq.fit+2B2CANY-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
<tr><td><code id="plot+2B2CFreq.fit+2B2CANY-method_+3A_...">...</code></td>
<td>
<p>optional plot parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='plot2compare'>Comparing plot method</h2><span id='topic+plot2compare'></span>

<h3>Description</h3>

<p>Method for classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot2compare(x, y, z, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot2compare_+3A_x">x</code></td>
<td>
<p>Bayes.fit or Bayes.pred class</p>
</td></tr>
<tr><td><code id="plot2compare_+3A_y">y</code></td>
<td>
<p>Bayes.fit or Bayes.pred class</p>
</td></tr>
<tr><td><code id="plot2compare_+3A_z">z</code></td>
<td>
<p>Bayes.fit or Bayes.pred class (optional)</p>
</td></tr>
<tr><td><code id="plot2compare_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='plot2compare+2CBayes.fit-method'>Comparing plot method plot2compare for three Bayesian estimation class objects</h2><span id='topic+plot2compare+2CBayes.fit-method'></span>

<h3>Description</h3>

<p>Comparison of the posterior densities for up to three S4 class Bayes.fit objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Bayes.fit'
plot2compare(x, y, z, names, true.values,
  reduced = TRUE, newwindow = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot2compare+2B2CBayes.fit-method_+3A_x">x</code></td>
<td>
<p>Bayes.fit class</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.fit-method_+3A_y">y</code></td>
<td>
<p>Bayes.fit class</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.fit-method_+3A_z">z</code></td>
<td>
<p>Bayes.fit class (optional)</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.fit-method_+3A_names">names</code></td>
<td>
<p>character vector of names for x, y and z</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.fit-method_+3A_true.values">true.values</code></td>
<td>
<p>list of parameters to compare with the estimations, if available</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.fit-method_+3A_reduced">reduced</code></td>
<td>
<p>logical(1), if TRUE, the chains are reduced with the burn-in and thin rate</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.fit-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='plot2compare+2CBayes.pred-method'>Comparing plot method plot2compare for three Bayesian prediction class objects</h2><span id='topic+plot2compare+2CBayes.pred-method'></span>

<h3>Description</h3>

<p>Comparison of the results for up to three S4 class Bayes.pred objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Bayes.pred'
plot2compare(x, y, z, newwindow = FALSE,
  plot.legend = TRUE, names, ylim, xlab = "times", ylab = "X", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_x">x</code></td>
<td>
<p>Bayes.pred class</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_y">y</code></td>
<td>
<p>Bayes.pred class</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_z">z</code></td>
<td>
<p>Bayes.pred class (optional)</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_plot.legend">plot.legend</code></td>
<td>
<p>logical(1), if TRUE, a legend is added</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_names">names</code></td>
<td>
<p>character vector with names for the three objects appearing in the legend</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_ylim">ylim</code></td>
<td>
<p>optional</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_xlab">xlab</code></td>
<td>
<p>optional, default 'times'</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_ylab">ylab</code></td>
<td>
<p>optional, default 'X'</p>
</td></tr>
<tr><td><code id="plot2compare+2B2CBayes.pred-method_+3A_...">...</code></td>
<td>
<p>optional plot parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>random &lt;- 1; sigma &lt;- 0.1; fixed &lt;- 5; param &lt;- c(3, 0.5)
sim &lt;- mixedsde.sim(M = 20, T = 1, N = 50, model = 'OU', random = random, fixed = fixed,
       density.phi = 'normal',param= param, sigma= sigma, X0 = 0, op.plot = 1)

# here: only 100 iterations for example - should be much more!
estim_Bayes_withoutprior &lt;- mixedsde.fit(times = sim$times, X = sim$X, model = 'OU',
             random, estim.method = 'paramBayes',  nMCMC = 100)
prior &lt;- list( m = c(param[1], fixed), v = c(param[1], fixed), alpha.omega = 11,
            beta.omega = param[2]^2*10, alpha.sigma = 10, beta.sigma = sigma^2*9)
estim_Bayes &lt;- mixedsde.fit(times = sim$times, X = sim$X, model = 'OU', random, 
           estim.method = 'paramBayes', prior = prior, nMCMC = 100) 
plot2compare(estim_Bayes, estim_Bayes_withoutprior, names = c('with prior', 'without prior'))
</code></pre>

<hr>
<h2 id='pred'>Prediction method</h2><span id='topic+pred'></span>

<h3>Description</h3>

<p>Prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_+3A_x">x</code></td>
<td>
<p>Freq.fit or Bayes.fit class</p>
</td></tr>
<tr><td><code id="pred_+3A_...">...</code></td>
<td>
<p>other optional parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='pred+2CBayes.fit-method'>Bayesian prediction method for a class object Bayes.fit</h2><span id='topic+pred+2CBayes.fit-method'></span>

<h3>Description</h3>

<p>Bayesian prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Bayes.fit'
pred(x, invariant = FALSE, level = 0.05,
  newwindow = FALSE, plot.pred = TRUE, plot.legend = TRUE, burnIn,
  thinning, only.interval = TRUE, sample.length = 500,
  cand.length = 100, trajectories = FALSE, ylim, xlab = "times",
  ylab = "X", col = 3, lwd = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_x">x</code></td>
<td>
<p>Bayes.fit class</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_invariant">invariant</code></td>
<td>
<p>logical(1), if TRUE, the initial value is from the invariant distribution <code class="reqn">X_t~N(\alpha/\beta, \sigma^2/2\beta)</code> for the OU and <code class="reqn">X_t~\Gamma(2\alpha/\sigma^2, \sigma^2/2\beta)</code> for the CIR process, if FALSE (default) X0 is fixed from the data starting points</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_level">level</code></td>
<td>
<p>alpha for the predicion intervals, default 0.05</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_plot.pred">plot.pred</code></td>
<td>
<p>logical(1), if TRUE, the results are depicted grafically</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_plot.legend">plot.legend</code></td>
<td>
<p>logical(1), if TRUE, a legend is added to the plot</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_burnin">burnIn</code></td>
<td>
<p>optional, if missing, the proposed value of the mixedsde.fit function is taken</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_thinning">thinning</code></td>
<td>
<p>optional, if missing, the proposed value of the mixedsde.fit function is taken</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_only.interval">only.interval</code></td>
<td>
<p>logical(1), if TRUE, only prediction intervals are calculated, much faster than sampling from the whole predictive distribution</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_sample.length">sample.length</code></td>
<td>
<p>number of samples to be drawn from the predictive distribution, if only.interval = FALSE</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_cand.length">cand.length</code></td>
<td>
<p>number of candidates for which the predictive density is calculated, i.e. the candidates to be drawn from</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_trajectories">trajectories</code></td>
<td>
<p>logical(1), if TRUE, only trajectories are drawn from the point estimations instead of sampling from the predictive distribution, similar to the frequentist approach</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_ylim">ylim</code></td>
<td>
<p>optional</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_xlab">xlab</code></td>
<td>
<p>optional, default 'times'</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_ylab">ylab</code></td>
<td>
<p>optional, default 'X'</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_col">col</code></td>
<td>
<p>color for the prediction intervals, default 3</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_lwd">lwd</code></td>
<td>
<p>linewidth for the prediction intervals, default 3</p>
</td></tr>
<tr><td><code id="pred+2B2CBayes.fit-method_+3A_...">...</code></td>
<td>
<p>optional plot parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='pred+2CFreq.fit-method'>Prediction method for the Freq.fit class object</h2><span id='topic+pred+2CFreq.fit-method'></span>

<h3>Description</h3>

<p>Frequentist prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Freq.fit'
pred(x, invariant = 0, level = 0.05,
  newwindow = FALSE, plot.pred = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred+2B2CFreq.fit-method_+3A_x">x</code></td>
<td>
<p>Freq.fit class</p>
</td></tr>
<tr><td><code id="pred+2B2CFreq.fit-method_+3A_invariant">invariant</code></td>
<td>
<p>1 if the initial value is from the invariant distribution, default X0 is fixed from Xtrue</p>
</td></tr>
<tr><td><code id="pred+2B2CFreq.fit-method_+3A_level">level</code></td>
<td>
<p>alpha for the predicion intervals, default 0.05</p>
</td></tr>
<tr><td><code id="pred+2B2CFreq.fit-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
<tr><td><code id="pred+2B2CFreq.fit-method_+3A_plot.pred">plot.pred</code></td>
<td>
<p>logical(1), if TRUE, the results are depicted grafically</p>
</td></tr>
<tr><td><code id="pred+2B2CFreq.fit-method_+3A_...">...</code></td>
<td>
<p>optional plot parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='print+2CBayes.fit-method'>Print of acceptance rates of the MH steps</h2><span id='topic+print+2CBayes.fit-method'></span>

<h3>Description</h3>

<p>Method for the S4 class Bayes.fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Bayes.fit'
print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B2CBayes.fit-method_+3A_x">x</code></td>
<td>
<p>Bayes.fit class</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='print+2CFreq.fit-method'>Description of print</h2><span id='topic+print+2CFreq.fit-method'></span>

<h3>Description</h3>

<p>Method for the S4 class Freq.fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Freq.fit'
print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B2CFreq.fit-method_+3A_x">x</code></td>
<td>
<p>Freq.fit class</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='summary+2CBayes.fit-method'>Short summary of the results of class object Bayes.fit</h2><span id='topic+summary+2CBayes.fit-method'></span>

<h3>Description</h3>

<p>Method for the S4 class Bayes.fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Bayes.fit'
summary(object, level = 0.05, burnIn, thinning)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2CBayes.fit-method_+3A_object">object</code></td>
<td>
<p>Bayes.fit class</p>
</td></tr>
<tr><td><code id="summary+2B2CBayes.fit-method_+3A_level">level</code></td>
<td>
<p>default is 0.05</p>
</td></tr>
<tr><td><code id="summary+2B2CBayes.fit-method_+3A_burnin">burnIn</code></td>
<td>
<p>optional</p>
</td></tr>
<tr><td><code id="summary+2B2CBayes.fit-method_+3A_thinning">thinning</code></td>
<td>
<p>optional</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='summary+2CFreq.fit-method'>Short summary of the results of class object Freq.fit</h2><span id='topic+summary+2CFreq.fit-method'></span>

<h3>Description</h3>

<p>Method for the S4 class Freq.fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Freq.fit'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2CFreq.fit-method_+3A_object">object</code></td>
<td>
<p>Freq.fit class</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='UV'>Computation Of The Sufficient Statistics</h2><span id='topic+UV'></span>

<h3>Description</h3>

<p>Computation of U and V, the two sufficient statistics of the likelihood of the mixed SDE
<code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_j(t))dt + \sigma a(X_j(t)) dW_j(t)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UV(X, model, random, fixed, times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UV_+3A_x">X</code></td>
<td>
<p>matrix of the M trajectories.</p>
</td></tr>
<tr><td><code id="UV_+3A_model">model</code></td>
<td>
<p>name of the SDE: 'OU' (Ornstein-Uhlenbeck) or 'CIR' (Cox-Ingersoll-Ross).</p>
</td></tr>
<tr><td><code id="UV_+3A_random">random</code></td>
<td>
<p>random effects in the drift: 1 if one additive random effect, 2 if one multiplicative random effect or c(1,2) if 2 random effects.</p>
</td></tr>
<tr><td><code id="UV_+3A_fixed">fixed</code></td>
<td>
<p>fixed effects in the drift: value of the fixed effect when there is only one random effect, 0 otherwise.</p>
</td></tr>
<tr><td><code id="UV_+3A_times">times</code></td>
<td>
<p>times vector of observation times.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computation of U and V, the two sufficient statistics of the likelihood of the mixed SDE
<code class="reqn">dX_j(t)= (\alpha_j- \beta_j X_j(t))dt + \sigma a(X_j(t)) dW_j(t) = (\alpha_j, \beta_j)b(X_j(t))dt + \sigma a(X_j(t)) dW_j(t)</code> with <code class="reqn">b(x)=(1,-x)^t</code>:
</p>
<p>U : <code class="reqn">U(Tend) = \int_0^{Tend} b(X(s))/a^2(X(s))dX(s) </code>
</p>
<p>V : <code class="reqn">V(Tend) = \int_0^{Tend} b(X(s))^2/a^2(X(s))ds </code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>U</code></td>
<td>
<p>vector of the M statistics U(Tend)</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>list of the M matrices V(Tend)</p>
</td></tr>
</table>


<h3>References</h3>

<p>See Bidimensional random effect estimation in mixed stochastic differential model, C. Dion and V. Genon-Catalot, <em>Stochastic Inference for Stochastic Processes 2015, Springer Netherlands</em> <b>1&ndash;28</b>
</p>

<hr>
<h2 id='valid'>Validation of the chosen model.</h2><span id='topic+valid'></span>

<h3>Description</h3>

<p>Validation of the chosen model. For the index numj, Mrep=100 new trajectories are simulated
with the value of the estimated random effect number numj. Two plots are given: on the left the simulated trajectories and the true one (red)
and one the left the corresponding qq-plot for each time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>valid(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="valid_+3A_x">x</code></td>
<td>
<p>Freq.fit or Bayes.fit class</p>
</td></tr>
<tr><td><code id="valid_+3A_...">...</code></td>
<td>
<p>other optional parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='valid+2CBayes.fit-method'>Validation of the chosen model.</h2><span id='topic+valid+2CBayes.fit-method'></span>

<h3>Description</h3>

<p>Validation of the chosen model. For the index numj, Mrep=100 new trajectories are simulated
with the value of the estimated random effect number numj. Two plots are given: on the left the simulated trajectories and the true one (red)
and one the left the corresponding qq-plot for each time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Bayes.fit'
valid(x, Mrep = 100, newwindow = FALSE,
  plot.valid = TRUE, numj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="valid+2B2CBayes.fit-method_+3A_x">x</code></td>
<td>
<p>Bayes.fit class</p>
</td></tr>
<tr><td><code id="valid+2B2CBayes.fit-method_+3A_mrep">Mrep</code></td>
<td>
<p>number of trajectories to be drawn</p>
</td></tr>
<tr><td><code id="valid+2B2CBayes.fit-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
<tr><td><code id="valid+2B2CBayes.fit-method_+3A_plot.valid">plot.valid</code></td>
<td>
<p>logical(1), if TRUE, the results are depicted grafically</p>
</td></tr>
<tr><td><code id="valid+2B2CBayes.fit-method_+3A_numj">numj</code></td>
<td>
<p>optional number of series to be validated</p>
</td></tr>
<tr><td><code id="valid+2B2CBayes.fit-method_+3A_...">...</code></td>
<td>
<p>optional plot parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

<hr>
<h2 id='valid+2CFreq.fit-method'>Validation of the chosen model.</h2><span id='topic+valid+2CFreq.fit-method'></span>

<h3>Description</h3>

<p>Validation of the chosen model. For the index numj, Mrep=100 new trajectories are simulated
with the value of the estimated random effect number numj. Two plots are given: on the left the simulated trajectories and the true one (red)
and one the left the corresponding qq-plot for each time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Freq.fit'
valid(x, Mrep = 100, newwindow = FALSE,
  plot.valid = TRUE, numj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="valid+2B2CFreq.fit-method_+3A_x">x</code></td>
<td>
<p>Freq.fit class</p>
</td></tr>
<tr><td><code id="valid+2B2CFreq.fit-method_+3A_mrep">Mrep</code></td>
<td>
<p>number of trajectories to be drawn</p>
</td></tr>
<tr><td><code id="valid+2B2CFreq.fit-method_+3A_newwindow">newwindow</code></td>
<td>
<p>logical(1), if TRUE, a new window is opened for the plot</p>
</td></tr>
<tr><td><code id="valid+2B2CFreq.fit-method_+3A_plot.valid">plot.valid</code></td>
<td>
<p>logical(1), if TRUE, the results are depicted grafically</p>
</td></tr>
<tr><td><code id="valid+2B2CFreq.fit-method_+3A_numj">numj</code></td>
<td>
<p>optional number of series to be validated</p>
</td></tr>
<tr><td><code id="valid+2B2CFreq.fit-method_+3A_...">...</code></td>
<td>
<p>optional plot parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dion, C., Hermann, S. and Samson, A. (2016). Mixedsde: a R package to fit mixed stochastic differential equations.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
