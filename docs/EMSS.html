<!DOCTYPE html><html><head><title>Help for package EMSS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EMSS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.EMSS'><p>Getting Coefficients of EM type Sample Selection Model Fits</p></a></li>
<li><a href='#confint.EMSS'><p>Getting Confidence Intervals for Parameters of EM type Sample Selection Model Fits</p></a></li>
<li><a href='#EMSS'><p>EM type Estimation Methods for the Heckman's Sample Selection Model</p></a></li>
<li><a href='#Smoke'><p>Survey Data on Smoking Behaviour</p></a></li>
<li><a href='#summary.EMSS'><p>Summarizing EM type Sample Selection Model Fits</p></a></li>
<li><a href='#vcov.EMSS'><p>Getting Variance-Covariance Matrix for Parameters of EM type Sample Selection Model Fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Some EM-Type Estimation Methods for the Heckman Selection Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Kexuan Yang &lt;717260446@qq.com&gt;, Sang Kyu Lee &lt;leesa111@msu.edu&gt;, Jun Zhao &lt;zhaojun2021@hotmail.com&gt;, and Hyoung-Moon Kim &lt;hmk966a@gmail.com &gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sang Kyu Lee &lt;leesa111@msu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Some EM-type algorithms to estimate parameters for the well-known Heckman selection model are provided in the package. Such algorithms are as follow: ECM(Expectation/Conditional Maximization), ECM(NR)(the Newton-Raphson method is adapted to the ECM) and ECME(Expectation/Conditional Maximization Either). Since the algorithms are based on the EM algorithm, they also have EMâ€™s main advantages, namely, stability and ease of implementation. Further details and explanations of the algorithms can be found in Zhao et al. (2020) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2020.106930">doi:10.1016/j.csda.2020.106930</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>sampleSelection, mvtnorm</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/SangkyuStat/EMSS/issues">https://github.com/SangkyuStat/EMSS/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/SangkyuStat/EMSS">https://github.com/SangkyuStat/EMSS</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-21 09:08:02 UTC; sangkyu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-10 17:12:42 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.EMSS'>Getting Coefficients of EM type Sample Selection Model Fits</h2><span id='topic+coef.EMSS'></span>

<h3>Description</h3>

<p><code>coef</code> method for a class &quot;EMSS&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EMSS'
coef(object, only = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.EMSS_+3A_object">object</code></td>
<td>
<p>an object of class &quot;EMSS&quot; made by the function <code>EMSS</code>.</p>
</td></tr>
<tr><td><code id="coef.EMSS_+3A_only">only</code></td>
<td>
<p>a character value for choosing specific variable's coefficients. Initial value is <code>NULL</code>,
which shows all variable's coefficients. If &quot;response&quot; is written, only coefficients for response variables
will be returned, and if &quot;selection&quot; is written, only coefficients for selection variables will be returned.</p>
</td></tr>
<tr><td><code id="coef.EMSS_+3A_...">...</code></td>
<td>
<p>not used, but exists because of the compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector or a list, containing one set or two sets, is given.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># examples continued from EMSS
data(Smoke, package = "EMSS")
ex1 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection = smoker ~ educ + age,
           data = Smoke)
coef(ex1)

data(Smoke, package = "EMSS")
ex2 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection =  smoker ~ educ + age,
           data = Smoke, method="ECMnr")
coef(ex2)

## example using random numbers with exclusion restriction

N &lt;- 1000
errps &lt;- mvtnorm::rmvnorm(N,c(0,0),matrix(c(1,0.5,0.5,1),2,2) )
xs &lt;- runif(N)
ys &lt;- xs+errps[,1]&gt;0
xo &lt;- runif(N)
yo &lt;- (xo+errps[,2])*(ys&gt;0)

ex3 &lt;- EMSS(response = yo ~ xo,
           selection = ys ~ xs,
           initial.param = c(rep(0,4), 0.3, 0.6), method="ECMnr")
coef(ex3)

</code></pre>

<hr>
<h2 id='confint.EMSS'>Getting Confidence Intervals for Parameters of EM type Sample Selection Model Fits</h2><span id='topic+confint.EMSS'></span>

<h3>Description</h3>

<p><code>confint</code> method for a class &quot;EMSS&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EMSS'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.EMSS_+3A_object">object</code></td>
<td>
<p>an object of class &quot;EMSS&quot; made by the function <code>EMSS</code>.</p>
</td></tr>
<tr><td><code id="confint.EMSS_+3A_parm">parm</code></td>
<td>
<p>not used, but exists because of the compatibility.</p>
</td></tr>
<tr><td><code id="confint.EMSS_+3A_level">level</code></td>
<td>
<p>a numeric value between 0 and 1 for controlling the significance level of confidence interval; default value is 0.95.</p>
</td></tr>
<tr><td><code id="confint.EMSS_+3A_...">...</code></td>
<td>
<p>not used, but exists because of the compatibility.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># examples continued from EMSS
data(Smoke, package = "EMSS")
ex1 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection = smoker ~ educ + age,
           data = Smoke)
confint(ex1)

data(Smoke, package = "EMSS")
ex2 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection =  smoker ~ educ + age,
           data = Smoke, method="ECMnr")
confint(ex2)

## example using random numbers with exclusion restriction

N &lt;- 1000
errps &lt;- mvtnorm::rmvnorm(N,c(0,0),matrix(c(1,0.5,0.5,1),2,2) )
xs &lt;- runif(N)
ys &lt;- xs+errps[,1]&gt;0
xo &lt;- runif(N)
yo &lt;- (xo+errps[,2])*(ys&gt;0)

ex3 &lt;- EMSS(response = yo ~ xo,
           selection = ys ~ xs,
           initial.param = c(rep(0,4), 0.3, 0.6), method="ECMnr")
confint(ex3)

</code></pre>

<hr>
<h2 id='EMSS'>EM type Estimation Methods for the Heckman's Sample Selection Model</h2><span id='topic+EMSS'></span>

<h3>Description</h3>

<p>Some algorithms: <code>ECM</code>, <code>ECMnr</code> and <code>ECME</code> can be used to estimate parameters
in Heckman selection model and contain the advantages of the <code>EM</code> algorithm: easy
implementation and numerical stability. <code>"ECMnr"</code> stands for Expectation/Conditioncal
Maximization with Newton-Raphson, and <code>"ECME"</code> for Expectation/Conditional Maximization Either.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMSS(
  response,
  selection,
  data,
  method = "ECM",
  initial.param = NULL,
  eps = 10^(-10)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMSS_+3A_response">response</code></td>
<td>
<p>a formula for the response equation.</p>
</td></tr>
<tr><td><code id="EMSS_+3A_selection">selection</code></td>
<td>
<p>a formula for the selection equation.</p>
</td></tr>
<tr><td><code id="EMSS_+3A_data">data</code></td>
<td>
<p>a data frame and data has to be included with the form of <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="EMSS_+3A_method">method</code></td>
<td>
<p>a character indicating which method to be used. <code>ECM</code> stands for Expectation Conditional Maximization, and
<code>ECMnr</code> stands for Expectation Conditioncal Maximization with Newton-Raphson, and <code>ECME</code> for Expectation Conditional Maximization Either.</p>
</td></tr>
<tr><td><code id="EMSS_+3A_initial.param">initial.param</code></td>
<td>
<p>a vector, initial parameter values for the estimation. The length of the initial parameters has to
be same as the length of parameters, which are to be estimated.</p>
</td></tr>
<tr><td><code id="EMSS_+3A_eps">eps</code></td>
<td>
<p>a numerical error value for the end of the loop. A minimum value that can be arbitrarily set
to terminate the iteration of the function, in order to find the optimal parameter estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dependent variable of the selection equation (specified by argument selection) must have exactly
two levels (e.g., 'FALSE' and 'TRUE', or '0' and '1'). The default argument method is &quot;ECM&quot; and the
default start values (&quot;NULL&quot;) are obtained by two-step estimation of this model through the command
<code>selection</code> from the package <code>sampleSelection</code>. NA's are allowed in the data. These are
ignored if the corresponding outcome is unobserved, otherwise observations which contain NA
(either in selection or outcome) are changed to 0.
</p>


<h3>Value</h3>

<p><code>ECM</code> returns an object of class <code>"ECM"</code>.
The object class <code>"ECM"</code> is a list
containing the following components.
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>a matched call.</p>
</td></tr>
<tr><td><code>estimate_response</code></td>
<td>
<p>estimated regression coefficients for the response formula.</p>
</td></tr>
<tr><td><code>estimate_selection</code></td>
<td>
<p>estimated regression coefficients for the sample selection formula.</p>
</td></tr>
<tr><td><code>estimate_sigma</code></td>
<td>
<p>an estimated scale paramter for the bivariate normal distribution.</p>
</td></tr>
<tr><td><code>estimate_rho</code></td>
<td>
<p>an estimated correlation coefficient for the bivariate normal distribution.</p>
</td></tr>
<tr><td><code>hessian_mat</code></td>
<td>
<p>hessian matrix for parameters.</p>
</td></tr>
<tr><td><code>resp_leng</code></td>
<td>
<p>the numbers of coefficients for the response formula</p>
</td></tr>
<tr><td><code>select_leng</code></td>
<td>
<p>the numbers of coefficients for the selection formula</p>
</td></tr>
<tr><td><code>Q_value</code></td>
<td>
<p>the vallue of the Q function for EM type algorithms</p>
</td></tr>
<tr><td><code>names_response</code></td>
<td>
<p>names of regression coefficients for the reponse formula.</p>
</td></tr>
<tr><td><code>names_selection</code></td>
<td>
<p>names of regression coefficients for the selection formula.</p>
</td></tr>
</table>


<h3>Background</h3>

<p>Heckman selection model is classic to deal with the data where the outcome is partially observed and
the missing part is not at random. Heckman (1979) developed <code>2-step</code> and maximum likelihood
estimation (<code>MLE</code>) to do the estimation for this selection model. And these two method are
described in R package <code>sampleSelection</code> by Toomet and Henningsen (2008). Zhelonkin et al. (2016)
developed robust 2-stage method which performs more robustly than the 2-step method to deal with the
data where outlying observations exist and <code>ssmrob</code> package is available. Zhao et al. (2020) extended
EM algorithm to more general cases resulting in three algorithms: ECM, ECM(NR), and ECME. They also own
EM algorithm's main advantages, namely, stability and ease of implementation.
</p>


<h3>References</h3>

<p>Heckman, J. (1979) Sample selection bias as a specication error. <em>Econometrica</em>, 47, 153-161.
</p>
<p>Toomet, O. and Henningsen, A. (2008) Sample selection models in R:Package sampleSelection. <em>Journal of Statistical Software</em>, 27, 1-23.
</p>
<p>Zhao,J., Kim, H.-J. and Kim, H.-M. (2020) New EM-type algorithms for the Heckman selection model. <em>Computational Statistics and Data Analysis</em>, 146, https://doi.org/10.1016/j.csda.2020.106930.
</p>
<p>Zhelonkin, M., Genton, M.G. and Ronchetti, E. (2016) Robust inference in sample selection models. <em>Journal of the Royal Statistical Society Series B</em>, 78, 805-827.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Smoke, package = "EMSS")
ex1 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection = smoker ~ educ + age,
           data = Smoke)
print(ex1)

data(Smoke, package = "EMSS")
ex2 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection =  smoker ~ educ + age,
           data = Smoke, method="ECMnr")
print(ex2)

## example using random numbers with exclusion restriction

N &lt;- 1000
errps &lt;- mvtnorm::rmvnorm(N,c(0,0),matrix(c(1,0.5,0.5,1),2,2) )
xs &lt;- runif(N)
ys &lt;- xs+errps[,1]&gt;0
xo &lt;- runif(N)
yo &lt;- (xo+errps[,2])*(ys&gt;0)
ex3 &lt;- EMSS(response = yo ~ xo,
           selection = ys ~ xs,
           initial.param = c(rep(0,4), 0.3, 0.6), method="ECMnr")
print(ex3)

</code></pre>

<hr>
<h2 id='Smoke'>Survey Data on Smoking Behaviour</h2><span id='topic+Smoke'></span>

<h3>Description</h3>

<p>The Data is the subset of the original data from Mullahy (1985) and Mullahy (1997). The dataset is from
Wooldridge (2009) used for researches on cross sectinal data studies.
The dataset is also available from <code><a href="sampleSelection.html#topic+Smoke">Smoke</a></code> from the package <code>sampleSelection</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Smoke, package = "EMSS")
</code></pre>


<h3>Format</h3>

<p>a dataframe with 807 observations and 8 variables as below:
</p>

<dl>
<dt>educ</dt><dd><p>years of schooling (numeric)</p>
</dd>
<dt>age</dt><dd><p>age of respondents (numeric)</p>
</dd>
<dt>cigpric</dt><dd><p>cigarette price(state), cents per pack (numeric)</p>
</dd>
<dt>income</dt><dd><p>annual income in us dollar (numeric)</p>
</dd>
<dt>restaurn</dt><dd><p>state smoking restrictions for restaurants exist or not (categorical)</p>
</dd>
<dt>smoker</dt><dd><p>smoked at least once or not (categorical)</p>
</dd>
<dt>cigs_intervals</dt><dd><p>number of cigarettes smoked per day, with interval boundaries: 0,5,10,20,50 (numeric)</p>
</dd>
<dt>cigs</dt><dd><p>number of cigarettes smoked per day (numeric)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Wooldridge's dataset is available on <a href="https://ideas.repec.org/p/boc/bocins/smoke.html#biblio">https://ideas.repec.org/p/boc/bocins/smoke.html#biblio</a>.
</p>


<h3>References</h3>

<p>Jeffrey, M. Wooldridge (2009) <em>Introductory Econometrics: A modern approach</em>, Canada: South-Western Cengage Learning.
</p>
<p>Mullahy, John (1985) <em>Cigarette Smoking: Habits, Health Concerns, and Heterogeneous Unobservables in a Microeconometric Analysis of Consumer Demand</em>,
Ph.D. dissertation, University of Virginia.
</p>
<p>Mullahy, John (1997), Instrumental-Variable Estimation of Count Data Models: Applications to Models of Cigarette Smoking Behavior,
<em>Review of Economics and Statistics</em>, 79, 596-593.
</p>

<hr>
<h2 id='summary.EMSS'>Summarizing EM type Sample Selection Model Fits</h2><span id='topic+summary.EMSS'></span><span id='topic+print.summary.EMSS'></span>

<h3>Description</h3>

<p><code>summary</code> method for a class &quot;EMSS&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EMSS'
summary(object, tidy = FALSE, conf.int = FALSE, conf.level = 0.95, ...)

## S3 method for class 'summary.EMSS'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.EMSS_+3A_object">object</code></td>
<td>
<p>an object of class &quot;EMSS&quot; made by the function <code>EMSS</code>.</p>
</td></tr>
<tr><td><code id="summary.EMSS_+3A_tidy">tidy</code></td>
<td>
<p>a logical value stands for whether the summary format is in tidy format or not, if <code>TRUE</code>, the summary function will return a tidy format.</p>
</td></tr>
<tr><td><code id="summary.EMSS_+3A_conf.int">conf.int</code></td>
<td>
<p>a logical value stands for whether the confidence interval is included in the tiny format or not. If <code>TRUE</code>, confidence intervals are included.
If <code>tidy = FALSE</code>, this parameter does not control anything.</p>
</td></tr>
<tr><td><code id="summary.EMSS_+3A_conf.level">conf.level</code></td>
<td>
<p>a numeric value between 0 and 1 for controlling the significance level of confidence interval; default value is 0.95.</p>
</td></tr>
<tr><td><code id="summary.EMSS_+3A_...">...</code></td>
<td>
<p>not used, but exists because of the compatibility.</p>
</td></tr>
<tr><td><code id="summary.EMSS_+3A_x">x</code></td>
<td>
<p>an object of class &quot;summary.EMSS&quot;.</p>
</td></tr>
<tr><td><code id="summary.EMSS_+3A_digits">digits</code></td>
<td>
<p>a numeric number of significant digits.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># examples continued from EMSS
data(Smoke, package = "EMSS")
ex1 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection = smoker ~ educ + age,
           data = Smoke)
summary(ex1)

data(Smoke, package = "EMSS")
ex2 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection =  smoker ~ educ + age,
           data = Smoke, method="ECMnr")
summary(ex2)

## example using random numbers with exclusion restriction

N &lt;- 1000
errps &lt;- mvtnorm::rmvnorm(N,c(0,0),matrix(c(1,0.5,0.5,1),2,2) )
xs &lt;- runif(N)
ys &lt;- xs+errps[,1]&gt;0
xo &lt;- runif(N)
yo &lt;- (xo+errps[,2])*(ys&gt;0)

ex3 &lt;- EMSS(response = yo ~ xo,
           selection = ys ~ xs,
           initial.param = c(rep(0,4), 0.3, 0.6), method="ECMnr")
summary(ex3)

</code></pre>

<hr>
<h2 id='vcov.EMSS'>Getting Variance-Covariance Matrix for Parameters of EM type Sample Selection Model Fits</h2><span id='topic+vcov.EMSS'></span>

<h3>Description</h3>

<p><code>vcov</code> method for a class &quot;EMSS&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EMSS'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.EMSS_+3A_object">object</code></td>
<td>
<p>an object of class &quot;EMSS&quot; made by the function <code>EMSS</code>.</p>
</td></tr>
<tr><td><code id="vcov.EMSS_+3A_...">...</code></td>
<td>
<p>not used, but exists because of the compatibility.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># examples continued from EMSS
data(Smoke, package = "EMSS")
ex1 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection = smoker ~ educ + age,
           data = Smoke)
vcov(ex1)

data(Smoke, package = "EMSS")
ex2 &lt;- EMSS(response = cigs_intervals ~ educ,
           selection =  smoker ~ educ + age,
           data = Smoke, method="ECMnr")
vcov(ex2)

## example using random numbers with exclusion restriction

N &lt;- 1000
errps &lt;- mvtnorm::rmvnorm(N,c(0,0),matrix(c(1,0.5,0.5,1),2,2) )
xs &lt;- runif(N)
ys &lt;- xs+errps[,1]&gt;0
xo &lt;- runif(N)
yo &lt;- (xo+errps[,2])*(ys&gt;0)

ex3 &lt;- EMSS(response = yo ~ xo,
           selection = ys ~ xs,
           initial.param = c(rep(0,4), 0.3, 0.6), method="ECMnr")
vcov(ex3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
