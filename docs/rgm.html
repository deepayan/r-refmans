<!DOCTYPE html><html lang="en"><head><title>Help for package rgm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rgm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bpr'><p>Bayesian Probit Regression (BPR)</p></a></li>
<li><a href='#Gmcmc'><p>Graph MCMC Sampler</p></a></li>
<li><a href='#post_processing_rgm'><p>Post-Processing for RGM (Random Graph Model)</p></a></li>
<li><a href='#rgm'><p>Random Graphical Model</p></a></li>
<li><a href='#rot'><p>Rotate Locations</p></a></li>
<li><a href='#sample.data'><p>Sample Data</p></a></li>
<li><a href='#sim.rgm'>
<p>Simulate Data from a Random Graphical Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Advanced Inference with Random Graphical Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements state-of-the-art Random Graphical Models (RGMs) for multivariate data analysis across multiple environments, offering tools for exploring network interactions and structural relationships. Capabilities include joint inference across environments, integration of external covariates, and a Bayesian framework for uncertainty quantification. Applicable in various fields, including microbiome analysis. Methods based on Vinciotti, V., Wit, E., &amp; Richter, F. (2023). "Random Graphical Model of Microbiome Interactions in Related Environments." &lt;<a href="https://doi.org/10.48550/arXiv.2304.01956">doi:10.48550/arXiv.2304.01956</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>truncnorm, BDgraph, MASS, huge, ggplot2, stats, pROC, reshape2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/franciscorichter/rgm/issues">https://github.com/franciscorichter/rgm/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-21 14:58:35 UTC; pancho</td>
</tr>
<tr>
<td>Author:</td>
<td>Francisco Richter [aut, cre],
  Veronica Vinciotti [ctb],
  Ernst Wit [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francisco Richter &lt;richtf@usi.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-21 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bpr'>Bayesian Probit Regression (BPR)</h2><span id='topic+bpr'></span>

<h3>Description</h3>

<p>Performs Bayesian Probit Regression given the predictors and response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpr(y, X, offset = 0, theta, theta_0 = c(0, 0, 0), N_sim = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bpr_+3A_y">y</code></td>
<td>
<p>Vector of binary responses.</p>
</td></tr>
<tr><td><code id="bpr_+3A_x">X</code></td>
<td>
<p>Matrix of predictors.</p>
</td></tr>
<tr><td><code id="bpr_+3A_offset">offset</code></td>
<td>
<p>Optional offset for the linear predictor.</p>
</td></tr>
<tr><td><code id="bpr_+3A_theta">theta</code></td>
<td>
<p>Initial values for the regression coefficients.</p>
</td></tr>
<tr><td><code id="bpr_+3A_theta_0">theta_0</code></td>
<td>
<p>Prior mean for the regression coefficients.</p>
</td></tr>
<tr><td><code id="bpr_+3A_n_sim">N_sim</code></td>
<td>
<p>Number of simulations to perform.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of simulated values for the regression coefficients.
</p>

<hr>
<h2 id='Gmcmc'>Graph MCMC Sampler</h2><span id='topic+Gmcmc'></span>

<h3>Description</h3>

<p>Performs Markov Chain Monte Carlo (MCMC) sampling on a graph model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gmcmc(
  G,
  X = NULL,
  iter = 1000,
  alpha = NULL,
  theta = NULL,
  loc = NULL,
  burnin = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Gmcmc_+3A_g">G</code></td>
<td>
<p>Graph adjacency matrix.</p>
</td></tr>
<tr><td><code id="Gmcmc_+3A_x">X</code></td>
<td>
<p>Optional matrix of covariates.</p>
</td></tr>
<tr><td><code id="Gmcmc_+3A_iter">iter</code></td>
<td>
<p>Number of MCMC iterations to perform.</p>
</td></tr>
<tr><td><code id="Gmcmc_+3A_alpha">alpha</code></td>
<td>
<p>Initial values for alpha parameters.</p>
</td></tr>
<tr><td><code id="Gmcmc_+3A_theta">theta</code></td>
<td>
<p>Initial values for theta parameters.</p>
</td></tr>
<tr><td><code id="Gmcmc_+3A_loc">loc</code></td>
<td>
<p>Initial locations for nodes in the graph.</p>
</td></tr>
<tr><td><code id="Gmcmc_+3A_burnin">burnin</code></td>
<td>
<p>Number of burn-in iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing samples of alpha, loc, and possibly theta.
</p>

<hr>
<h2 id='post_processing_rgm'>Post-Processing for RGM (Random Graph Model)</h2><span id='topic+post_processing_rgm'></span>

<h3>Description</h3>

<p>This function performs post-processing on simulated data and results from a Random Graph Model (RGM).
It calculates mean posterior estimates, compares true and estimated edge probabilities, generates
various diagnostic plots, and returns a list of these plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_processing_rgm(simulated_data, results)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="post_processing_rgm_+3A_simulated_data">simulated_data</code></td>
<td>
<p>A list containing simulated data from an RGM.</p>
</td></tr>
<tr><td><code id="post_processing_rgm_+3A_results">results</code></td>
<td>
<p>A list containing results from fitting an RGM to 'simulated_data'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing ggplot objects for different diagnostics:
- 'rgm_recovery': A plot comparing true and estimated probit values.
- 'estimation_of_alpha': A plot comparing true and estimated alpha values.
- 'posterior_distribution': A density plot of the posterior distribution of the beta parameter.
- 'beta_convergence': A trace plot of the beta parameter across MCMC iterations.
- 'roc_plot': A ROC plot for graph recovery performance.
- 'edge_prob': A heatmap of posterior edge probabilities for each environment.
</p>

<hr>
<h2 id='rgm'>Random Graphical Model</h2><span id='topic+rgm'></span>

<h3>Description</h3>

<p>The function implements Bayesian inference of a random graphical model for multivariate data across multiple environments. The random graph prior assumes that there exists an underlying 2D latent space where the environments are located. Their vicinity in this space relates to structural similaries between the conditions. The model estimates these latent positions, the sparsity levels for each network, the regression coefficients of edge covariates associated to the propensity of two nodes ot connect (if available) and the network structures for each environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  rgm(data, X=NULL, iter = 1000, burnin = 0,
  initial.graphs = NULL, D = 2, initial.loc = NULL,
  initial.alpha = NULL, initial.theta = NULL,
  bd.iter = 20, bd.jump = 10,
  method = c("ggm", "gcgm"), gcgm.dwpar = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rgm_+3A_data">data</code></td>
<td>
<p>a list of B multivariate datasets measuring p variables across B number of environments.</p>
</td></tr>
<tr><td><code id="rgm_+3A_x">X</code></td>
<td>
<p>an n.edge x ncol(X) data matrix for the edge covariates. Default is <code>NULL</code>, corresponding to the absence of edge covariates.</p>
</td></tr>
<tr><td><code id="rgm_+3A_iter">iter</code></td>
<td>
<p>number of iterations for the MCMC sampler. Default is 1000.</p>
</td></tr>
<tr><td><code id="rgm_+3A_burnin">burnin</code></td>
<td>
<p>number of burn-in iterations to discard. Default is 0.</p>
</td></tr>
<tr><td><code id="rgm_+3A_initial.graphs">initial.graphs</code></td>
<td>
<p>an optional matrix of binary adjacency matrices for the initial graphs, with dimension n.edge x B. Default is <code>NULL</code> and in this case the initial graphs are constructed using graphical lasso (function huge).</p>
</td></tr>
<tr><td><code id="rgm_+3A_d">D</code></td>
<td>
<p>number of dimensions in the latent space. Default is 2.</p>
</td></tr>
<tr><td><code id="rgm_+3A_initial.loc">initial.loc</code></td>
<td>
<p>initial values for the B x D matrix of latent node positions. Default is <code>NULL</code> and in this case the initial values are drawn from a N(0,1) distribution.</p>
</td></tr>
<tr><td><code id="rgm_+3A_initial.alpha">initial.alpha</code></td>
<td>
<p>initial values for the B-dimensional intercepts. Default is <code>NULL</code> and in this case they are set to 0.</p>
</td></tr>
<tr><td><code id="rgm_+3A_initial.theta">initial.theta</code></td>
<td>
<p>initial values for the regression coefficients associated to the covariates in X. Default is <code>NULL</code> and in this case they are set via a probit regression of the initial graphs on the edge covariates.</p>
</td></tr>
<tr><td><code id="rgm_+3A_bd.iter">bd.iter</code></td>
<td>
<p>number of iterations for the BDgraph function. Default is 20.</p>
</td></tr>
<tr><td><code id="rgm_+3A_bd.jump">bd.jump</code></td>
<td>
<p>number of links to be updated simulateneously for the BDgraph function. Default is 10.</p>
</td></tr>
<tr><td><code id="rgm_+3A_method">method</code></td>
<td>
<p>method used for network estimation. Options are &quot;ggm&quot; (Gaussian graphical model) or &quot;gcgm&quot; (Gaussian copula graphical model). Default is &quot;ggm&quot;.</p>
</td></tr>
<tr><td><code id="rgm_+3A_gcgm.dwpar">gcgm.dwpar</code></td>
<td>
<p>a list of B elements, each containing the parameters of the discrete Weibull marginal fitting within each environment. This input is required only for method &quot;gcgm&quot; and is passed on to the function &quot;sample.data&quot;. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>rgm is a Bayesian random graphical model that infers the location of each environment in a 2-dimensional latent space. The probability of a link between two nodes in one environment is related to the distance of this environment to the other environments in the latent space as well as to the presence of an edge in the related environments. The model also allows for network-specific intercepts and regression coefficients for covariates measured at the edge level.
</p>
<p>The function first initializes the latent positions, intercepts, regression coefficients and the initial graphs, if not provided. It then loops through the iterations and updates the latent positions, regression coefficients and intercepts using the Gmcmc function. Next, it calculates the probability of edge connections for each condition. Finally, it updates the network structure for each condition using the BDgraph package. The function returns the posterior samples of the parameters after discarding the burn-in period.
</p>


<h3>Value</h3>

<p>A list containing the posterior samples of the model parameters. The list includes:
</p>
<table role = "presentation">
<tr><td><code>sample.alpha</code></td>
<td>
<p>a B x (iter - burnin) matrix of the <code>alpha</code> posterior samples of the network-specific intercepts</p>
</td></tr>
<tr><td><code>sample.theta</code></td>
<td>
<p>an ncol(X) x (iter - burnin) matrix of the posterior samples of the regression coefficients for the covariates in X. This is only returned if X is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>sample.loc</code></td>
<td>
<p>a B x D x (iter - burnin) array of the posterior samples of the latent positions of the conditions.</p>
</td></tr>
<tr><td><code>sample.graphs</code></td>
<td>
<p>an n.edge x B x (iter - burnin) array of the posterior samples of the network structures.</p>
</td></tr>
<tr><td><code>sample.K</code></td>
<td>
<p>an (n.edge+p) x B x (iter - burnin) array of the posterior samples of the precision matrices.</p>
</td></tr>
<tr><td><code>sample.pi</code></td>
<td>
<p>an n.edge x B x (iter - burnin) array of the posterior edge probabilities in each network.</p>
</td></tr>
<tr><td><code>pi.probit</code></td>
<td>
<p>an n.edge x B x (iter - burnin) array of the estimated probit probabilities of the edge connections in each network.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Veronica Vinciotti, Ernst C. Wit and Francisco Richter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # simulate data
  sim_data &lt;- sim.rgm(n = 10, D = 2, p = 7, B = 5)

  # run inference
  rgm(sim_data$data,X=sim_data$X,iter=1000)

</code></pre>

<hr>
<h2 id='rot'>Rotate Locations</h2><span id='topic+rot'></span>

<h3>Description</h3>

<p>Rotates locations to align with the mean vector direction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rot(loc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rot_+3A_loc">loc</code></td>
<td>
<p>Matrix of locations to rotate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of rotated locations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage with a 2-column matrix representing locations.
loc &lt;- matrix(rnorm(20), ncol = 2)
rotated_loc &lt;- rot(loc)
</code></pre>

<hr>
<h2 id='sample.data'>Sample Data</h2><span id='topic+sample.data'></span>

<h3>Description</h3>

<p>This function generates sample data based on the provided parameters and truncation points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample.data(data, K, tpoints)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample.data_+3A_data">data</code></td>
<td>
<p>A list of matrices representing the data.</p>
</td></tr>
<tr><td><code id="sample.data_+3A_k">K</code></td>
<td>
<p>A list of matrices representing the precision matrices for each data matrix in 'data'.</p>
</td></tr>
<tr><td><code id="sample.data_+3A_tpoints">tpoints</code></td>
<td>
<p>A list containing two lists of matrices for lower and upper truncation points, respectively.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of matrices with the sampled data.
</p>

<hr>
<h2 id='sim.rgm'>
Simulate Data from a Random Graphical Model
</h2><span id='topic+sim.rgm'></span>

<h3>Description</h3>

<p>This function simulates data from a random graphical model. The graphical model is a Gaussian graphical model, with a mean zero vector and condition-specific precision matrices. The random graph model is a latent probit model, which includes condition-specific intercepts, a 2D latent space model and an edge specific covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>#sim.rgm(n = 1000, D = 2, p = 81, B = 10,
#seed = 123, mcmc_iter = 50, alpha = NULL,
#theta = NULL, loc = NULL, X = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.rgm_+3A_n">n</code></td>
<td>
<p>The number of observations for each environment. Default is 1000.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_d">D</code></td>
<td>
<p>The dimension of the latent space. Default is 2.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_p">p</code></td>
<td>
<p>The number of nodes in each graph. Default is 81.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_b">B</code></td>
<td>
<p>The number of conditions. Default is 10.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_seed">seed</code></td>
<td>
<p>The random seed. Default is 123.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_mcmc_iter">mcmc_iter</code></td>
<td>
<p>The number of MCMC sampling for the generation of the graphs from the joint random graph distribution. Default is 50.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_alpha">alpha</code></td>
<td>
<p>The true values of the condition-specific intercepts. If <code>NULL</code>, these are drawn from a N(-2,1) distribution.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_theta">theta</code></td>
<td>
<p>The true values of the regression coefficients associated to the covariates in X. If <code>NULL</code>, this is set to 2.5.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_loc">loc</code></td>
<td>
<p>The true coordinates of the B locations in the latent space. If <code>NULL</code>, these are drawn from a N(0,0.3) distribution.</p>
</td></tr>
<tr><td><code id="sim.rgm_+3A_x">X</code></td>
<td>
<p>The edge specific covariates. If <code>NULL</code>, the data for one covariates is drawn from a Uniform(-0.5,0.5) distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>A list of B elements, where each element contains an n x p matrix of simulated Gaussian data.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>An n.edge x ncol(X) data matrix of edge covariates.</p>
</td></tr>
<tr><td><code>loc</code></td>
<td>
<p>A B x D matrix of the true condition-specific coordinates. </p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>A B-dimensional vector of the true condition-specific intercepts. </p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>A vector of the true regression coefficients associated to the covariates in X.</p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>An n.edge x B matrix of the true graphs.</p>
</td></tr>
<tr><td><code>diagnostic</code></td>
<td>
<p>The sparsity of the graphs generated across the <code>mcmc_iter</code> iterations, as a diagnostic tool for convergence.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>sim_data &lt;- sim.rgm(n = 10, D = 2, p = 7, B = 5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
