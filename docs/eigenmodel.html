<!DOCTYPE html><html><head><title>Help for package eigenmodel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eigenmodel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addlines'><p>Adds lines between nodes to an existing plot of nodes</p></a></li>
<li><a href='#eigenmodel_mcmc'><p>Approximate the posterior distribution of parameters in an eigenmodel</p></a></li>
<li><a href='#eigenmodel_setup'><p>Setup constants and starting values for an eigenmodel fit</p></a></li>
<li><a href='#eigenmodel-package'><p>Semiparametric Factor and Regression Models for Symmetric Relational Data</p></a></li>
<li><a href='#plot.eigenmodel_post'><p>Plot the output of an eigenmodel fit</p></a></li>
<li><a href='#rb_fc'><p>Sample from the full conditional distribution of the regression coefficients</p></a></li>
<li><a href='#rmvnorm'><p>Sample from the multivariate normal distribution</p></a></li>
<li><a href='#rUL_fc'><p>Sample UL from its full conditional distribution</p></a></li>
<li><a href='#rZ_fc'><p>Sample from the full conditional distribution of the probit latent variables</p></a></li>
<li><a href='#ULU'><p>Computes a matrix from its eigenvalue decomposition</p></a></li>
<li><a href='#XB'><p>Computes a sociomatrix of regression effects</p></a></li>
<li><a href='#Y_Gen'><p>Relations between words in the 1st chapter of Genesis</p></a></li>
<li><a href='#Y_impute'><p>Impute missing values of a sociomatrix</p></a></li>
<li><a href='#Y_Pro'><p>Butland's protein-protein interaction data</p></a></li>
<li><a href='#YX_Friend'><p>Sex, race and friendship data from a 12th grade classroom</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Semiparametric Factor and Regression Models for Symmetric
Relational Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.11</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-05-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Hoff</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Hoff &lt;peter.hoff@duke.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of the parameters in a model for
        symmetric relational data (e.g., the above-diagonal part of a
        square matrix), using a model-based eigenvalue decomposition
        and regression. Missing data is accommodated, and a posterior
        mean for missing data is calculated under the assumption that
        the data are missing at random. The marginal distribution of
        the relational data can be arbitrary, and is fit with an
        ordered probit specification. See Hoff (2007) &lt;<a href="https://arxiv.org/abs/0711.1146">arXiv:0711.1146</a>&gt; 
        for details on the model.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pdhoff.github.io/">https://pdhoff.github.io/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-28 14:48:11 UTC; pdh10</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-28 15:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='addlines'>Adds lines between nodes to an existing plot of nodes</h2><span id='topic+addlines'></span>

<h3>Description</h3>

<p>Adds lines between nodes to an existing plot of nodes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addlines(U, Y, col = "green", lwd = 1, lty = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addlines_+3A_u">U</code></td>
<td>
<p>an n x 2 matrix of node locations</p>
</td></tr>
<tr><td><code id="addlines_+3A_y">Y</code></td>
<td>
<p>a symmetric matrix</p>
</td></tr>
<tr><td><code id="addlines_+3A_col">col</code></td>
<td>
<p>color of the lines</p>
</td></tr>
<tr><td><code id="addlines_+3A_lwd">lwd</code></td>
<td>
<p>width of the lines</p>
</td></tr>
<tr><td><code id="addlines_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='eigenmodel_mcmc'>Approximate the posterior distribution of parameters in an eigenmodel</h2><span id='topic+eigenmodel_mcmc'></span>

<h3>Description</h3>

<p>Construct approximate samples from the posterior distribution of the
parameters and latent variables in an eigenmodel for symmetric relational
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenmodel_mcmc(Y, X = NULL, R = 2, S = 1000, seed = 1, Nss = min(S,
  1000), burn = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigenmodel_mcmc_+3A_y">Y</code></td>
<td>
<p>an n x n symmetric matrix with missing diagonal entries.
Off-diagonal missing values are allowed.</p>
</td></tr>
<tr><td><code id="eigenmodel_mcmc_+3A_x">X</code></td>
<td>
<p>an n x n x p array of regressors</p>
</td></tr>
<tr><td><code id="eigenmodel_mcmc_+3A_r">R</code></td>
<td>
<p>the rank of the approximating factor matrix</p>
</td></tr>
<tr><td><code id="eigenmodel_mcmc_+3A_s">S</code></td>
<td>
<p>number of samples from the Markov chain</p>
</td></tr>
<tr><td><code id="eigenmodel_mcmc_+3A_seed">seed</code></td>
<td>
<p>a random seed</p>
</td></tr>
<tr><td><code id="eigenmodel_mcmc_+3A_nss">Nss</code></td>
<td>
<p>number of samples to be saved</p>
</td></tr>
<tr><td><code id="eigenmodel_mcmc_+3A_burn">burn</code></td>
<td>
<p>number of initial scans of the Markov chain to be dropped</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following components: </p>
<table>
<tr><td><code>Z_postmean</code></td>
<td>
<p>posterior
mean of the latent variable in the probit specification</p>
</td></tr>
<tr><td><code>ULU_postmean</code></td>
<td>
<p>posterior mean of the reduced-rank approximating matrix</p>
</td></tr>
<tr><td><code>Y_postmean</code></td>
<td>
<p>the original data matrix with missing values replaced by
posterior means</p>
</td></tr> <tr><td><code>L_postsamp</code></td>
<td>
<p>samples of the eigenvalues</p>
</td></tr>
<tr><td><code>b_postsamp</code></td>
<td>
<p>samples of the regression coefficients</p>
</td></tr> <tr><td><code>Y</code></td>
<td>
<p>original
data matrix</p>
</td></tr> <tr><td><code>X</code></td>
<td>
<p>original regressor array</p>
</td></tr> <tr><td><code>S</code></td>
<td>
<p>number of scans of
the Markov chain</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(YX_Friend)

fit&lt;-eigenmodel_mcmc(Y=YX_Friend$Y,X=YX_Friend$X,R=2,S=50,burn=50)

# in general you  should run the Markov chain longer than 50 scans

plot(fit)

#fit&lt;-eigenmodel_mcmc(Y=Y_Gen,R=3,S=10000)

#fit&lt;-eigenmodel_mcmc(Y=Y_Pro,R=3,S=10000)


</code></pre>

<hr>
<h2 id='eigenmodel_setup'>Setup constants and starting values for an eigenmodel fit</h2><span id='topic+eigenmodel_setup'></span>

<h3>Description</h3>

<p>Setup constants and starting values for an eigenmodel fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenmodel_setup(R = 0, seed = 1, em_env = .GlobalEnv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigenmodel_setup_+3A_r">R</code></td>
<td>
<p>non-negative integer rank of the approximating matrix</p>
</td></tr>
<tr><td><code id="eigenmodel_setup_+3A_seed">seed</code></td>
<td>
<p>a random seed</p>
</td></tr>
<tr><td><code id="eigenmodel_setup_+3A_em_env">em_env</code></td>
<td>
<p>enviromnemt within which to do the fitting</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='eigenmodel-package'>Semiparametric Factor and Regression Models for Symmetric Relational Data</h2><span id='topic+eigenmodel-package'></span><span id='topic+eigenmodel'></span>

<h3>Description</h3>

<p>Estimation of the parameters in a model for symmetric relational
data (e.g., the above-diagonal part of a square matrix), using a model-based
eigenvalue decomposition and regression. Missing data is accomodated, and a
posterior mean for missing data is calculated under the assumption that the
data are missing at random. The marginal distribution of the relational data
can be arbitrary, and is fit with an ordered probit specification. See Hoff (2007) &lt;arXiv:0711.1146&gt; for details on the model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> eigenmodel</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version:
</td><td style="text-align: left;"> 1.11</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2019-05-28</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL Version 2 </td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Peter Hoff &lt;peter.hoff@duke.edu&gt;
</p>


<h3>References</h3>

<p>Hoff (2007) &ldquo;Modeling homophily and stochastic equivalence in
symmetric relational data&rdquo;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(YX_Friend)

fit&lt;-eigenmodel_mcmc(Y=YX_Friend$Y,X=YX_Friend$X,R=2,S=50,burn=50)

# in general you should run the Markov chain longer than 50 scans

plot(fit)


# people familiar with MCMC might want to implement 
# their own Markov chains: 

Y&lt;-YX_Friend$Y
X&lt;-YX_Friend$X

eigenmodel_setup(R=2)

for(s in 1:50) {   # you should run your chain longer than 50 scans

    Z&lt;-rZ_fc() 
    UL&lt;-rUL_fc()
    b&lt;-rb_fc()  

                 }


#fit_Gen&lt;-eigenmodel_mcmc(Y=Y_Gen,R=3,S=10000)

#fit_Pro&lt;-eigenmodel_mcmc(Y=Y_Pro,R=3,S=10000)




</code></pre>

<hr>
<h2 id='plot.eigenmodel_post'>Plot the output of an eigenmodel fit</h2><span id='topic+plot.eigenmodel_post'></span>

<h3>Description</h3>

<p>A graphical display of MCMC output and posterior estimates of model
parameters in an eigenmodel fit. Includes 95 percent quantile-based
posterior confidence intervals of regression coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eigenmodel_post'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.eigenmodel_post_+3A_x">x</code></td>
<td>
<p>an object of class <code>eigenmodel_post</code></p>
</td></tr>
<tr><td><code id="plot.eigenmodel_post_+3A_...">...</code></td>
<td>
<p>additional plotting options</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rb_fc'>Sample from the full conditional distribution of the regression coefficients</h2><span id='topic+rb_fc'></span>

<h3>Description</h3>

<p>Sample from the full conditional distribution of the regression coefficients
in an eigenmodel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rb_fc(E = Z - ULU(UL))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rb_fc_+3A_e">E</code></td>
<td>
<p>a symmetric matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a p x 1 vector
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rmvnorm'>Sample from the multivariate normal distribution</h2><span id='topic+rmvnorm'></span>

<h3>Description</h3>

<p>Sample from the multivariate normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmvnorm(mu, Sig2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmvnorm_+3A_mu">mu</code></td>
<td>
<p>a p x 1 vector</p>
</td></tr>
<tr><td><code id="rmvnorm_+3A_sig2">Sig2</code></td>
<td>
<p>a p x p positive definite matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a p x 1 vector
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rmvnorm( c(0,0,0),diag(rep(3,1)) )   
</code></pre>

<hr>
<h2 id='rUL_fc'>Sample UL from its full conditional distribution</h2><span id='topic+rUL_fc'></span>

<h3>Description</h3>

<p>Samples the components of a reduced rank approximating matrix from their
full conditional distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rUL_fc(E = Z - XB(X, b))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rUL_fc_+3A_e">E</code></td>
<td>
<p>an n x n symmetric matrix to be modeled with a reduced rank matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: </p>
<table>
<tr><td><code>U</code></td>
<td>
<p>an n x r matrix of
eigenvectors </p>
</td></tr> <tr><td><code>L</code></td>
<td>
<p>an r x r diagonal matrix of eigenvalues</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='rZ_fc'>Sample from the full conditional distribution of the probit latent variables</h2><span id='topic+rZ_fc'></span>

<h3>Description</h3>

<p>Sample from the full conditional distribution of the latent variables in the
ordered probit model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rZ_fc(EZ = XB(X, b) + ULU(UL), MH = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rZ_fc_+3A_ez">EZ</code></td>
<td>
<p>a symmetric matrix with elements equal to the expected values of
the latent variables</p>
</td></tr>
<tr><td><code id="rZ_fc_+3A_mh">MH</code></td>
<td>
<p>whether or not to do a Metropolis update in addition to the Gibbs
sampling</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a symmetric matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='ULU'>Computes a matrix from its eigenvalue decomposition</h2><span id='topic+ULU'></span>

<h3>Description</h3>

<p>Computes a matrix from its eigenvalue decomposition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ULU(UL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ULU_+3A_ul">UL</code></td>
<td>
<p>a list with first component &ldquo;U&rdquo;, an n x r matrix and the second
component &ldquo;L&rdquo; an r x r diagonal matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an n x n matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='XB'>Computes a sociomatrix of regression effects</h2><span id='topic+XB'></span>

<h3>Description</h3>

<p>Computes a sociomatrix of regression effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XB(X, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="XB_+3A_x">X</code></td>
<td>
<p>an n x n x p array</p>
</td></tr>
<tr><td><code id="XB_+3A_b">b</code></td>
<td>
<p>a p x 1 vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an n x n matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='Y_Gen'>Relations between words in the 1st chapter of Genesis</h2><span id='topic+Y_Gen'></span>

<h3>Description</h3>

<p>The i,j th entry of this matrix is the numerical count of the number of
times word i was next to word j in the first chapter of Genesis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Y_Gen)

</code></pre>

<hr>
<h2 id='Y_impute'>Impute missing values of a sociomatrix</h2><span id='topic+Y_impute'></span>

<h3>Description</h3>

<p>Impute missing values of a sociomatrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Y_impute()
</code></pre>


<h3>Details</h3>

<p>Imputes missing values of a sociomatrix from a matrix of latent variables
and an ordered-probit specification.
</p>


<h3>Value</h3>

<p>symmetric matrix
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>

<hr>
<h2 id='Y_Pro'>Butland's protein-protein interaction data</h2><span id='topic+Y_Pro'></span>

<h3>Description</h3>

<p>Butland's protein-protein interaction data
</p>


<h3>References</h3>

<p>Butland et al (2005) &ldquo;Interaction network containing conserved
and essential protein complexes in Escherichia coli&rdquo;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Y_Pro)

</code></pre>

<hr>
<h2 id='YX_Friend'>Sex, race and friendship data from a 12th grade classroom</h2><span id='topic+YX_Friend'></span>

<h3>Description</h3>

<p>A list in which <code>Y</code> encodes the presence of a friendship tie between 90
12th graders. The array <code>X</code> indicates pairs of the same sex and of the
same race.
</p>


<h3>Source</h3>

<p>http://www.cpc.unc.edu/projects/addhealth/design
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(YX_Friend)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
