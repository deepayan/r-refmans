<!DOCTYPE html><html lang="en"><head><title>Help for package fixes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fixes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot_es'><p>Plot Event Study Results</p></a></li>
<li><a href='#run_es'><p>Run Event Study with Fixed Effects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Creating and Visualizing Fixed-Effects Event Study
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for creating, analyzing, and visualizing event study models using fixed-effects regression.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, fixest, broom, tibble, rlang</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-17 11:35:50 UTC; yo5uk</td>
</tr>
<tr>
<td>Author:</td>
<td>Yosuke Abe [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yosuke Abe &lt;yosuke.abe0507@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-18 15:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot_es'>Plot Event Study Results</h2><span id='topic+plot_es'></span>

<h3>Description</h3>

<p>This function creates a plot for event study results using 'ggplot2'.
Users can choose between ribbon-style confidence intervals or error bars
to visualize the estimates and their uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_es(
  data,
  type = "ribbon",
  vline_val = 0,
  vline_color = "#000",
  hline_val = 0,
  hline_color = "#000",
  linewidth = 1,
  pointsize = 2,
  alpha = 0.2,
  barwidth = 0.2,
  color = "#B25D91FF",
  fill = "#B25D91FF"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_es_+3A_data">data</code></td>
<td>
<p>A dataframe containing the results from the 'run_es' function.
The dataframe must include the following columns:
- 'relative_time': The scaled time relative to the treatment.
- 'estimate': The estimated coefficients.
- 'conf_low': The lower bound of the 95
- 'conf_high': The upper bound of the 95
- 'std.error': The standard errors (required if 'type = &quot;errorbar&quot;').</p>
</td></tr>
<tr><td><code id="plot_es_+3A_type">type</code></td>
<td>
<p>The type of confidence interval visualization: &quot;ribbon&quot; (default) or &quot;errorbar&quot;.
- &quot;ribbon&quot;: Shaded area representing the confidence intervals.
- &quot;errorbar&quot;: Vertical error bars for each estimate.</p>
</td></tr>
<tr><td><code id="plot_es_+3A_vline_val">vline_val</code></td>
<td>
<p>The x-intercept for the vertical reference line (default: 0).
Typically represents the time of treatment.</p>
</td></tr>
<tr><td><code id="plot_es_+3A_vline_color">vline_color</code></td>
<td>
<p>The color of the vertical reference line (default: &quot;#000&quot;).</p>
</td></tr>
<tr><td><code id="plot_es_+3A_hline_val">hline_val</code></td>
<td>
<p>The y-intercept for the horizontal reference line (default: 0).
Usually represents the null effect line.</p>
</td></tr>
<tr><td><code id="plot_es_+3A_hline_color">hline_color</code></td>
<td>
<p>The color of the horizontal reference line (default: &quot;#000&quot;).</p>
</td></tr>
<tr><td><code id="plot_es_+3A_linewidth">linewidth</code></td>
<td>
<p>The width of the lines in the plot (default: 1).</p>
</td></tr>
<tr><td><code id="plot_es_+3A_pointsize">pointsize</code></td>
<td>
<p>The size of the points for the estimates (default: 2).</p>
</td></tr>
<tr><td><code id="plot_es_+3A_alpha">alpha</code></td>
<td>
<p>The transparency level for the ribbon (default: 0.2).</p>
</td></tr>
<tr><td><code id="plot_es_+3A_barwidth">barwidth</code></td>
<td>
<p>The width of the error bars (default: 0.2).</p>
</td></tr>
<tr><td><code id="plot_es_+3A_color">color</code></td>
<td>
<p>The color of the lines and points (default: &quot;#B25D91FF&quot;).</p>
</td></tr>
<tr><td><code id="plot_es_+3A_fill">fill</code></td>
<td>
<p>The fill color for the ribbon (default: &quot;#B25D91FF&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides a flexible visualization tool for event study results.
Users can customize the appearance of the plot by adjusting the parameters
for line styles, point sizes, colors, and confidence interval types.
</p>
<p>**Column Requirements**:
The input dataframe ('data') must include:
- 'relative_time': A numeric column for the time relative to the treatment.
- 'estimate': The estimated coefficients for each relative time.
- 'conf_low' and 'conf_high': The bounds of the confidence intervals.
- 'std.error': The standard errors (only required if 'type = &quot;errorbar&quot;').
</p>
<p>**Type Options**:
- '&quot;ribbon&quot;': A shaded area to represent the confidence intervals.
- '&quot;errorbar&quot;': Error bars for each point. Standard errors ('std.error') are required.
</p>


<h3>Value</h3>

<p>A ggplot object displaying the event study results. The plot includes:
- A line connecting the estimates over relative time.
- Points for the estimated coefficients.
- Either ribbon-style confidence intervals or error bars, depending on 'type'.
- Vertical and horizontal reference lines for better interpretability.
</p>


<h3>Note</h3>

<p>If 'type = &quot;errorbar&quot;', ensure that the 'std.error' column is present in the input dataframe.
Missing values in the 'std.error' column for any term will result in incomplete confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate panel data
df &lt;- tibble::tibble(
  firm_id = rep(1:50, each = 10),  # 50 firms over 10 years
  state_id = rep(sample(1:10, size = 50, replace = TRUE), each = 10),
  year = rep(2000:2009, times = 50),
  is_treated = rep(sample(c(1, 0), size = 50, replace = TRUE, prob = c(0.5, 0.5)), each = 10),
  y = rnorm(500, mean = 0, sd = 1)  # Simulated outcome variable
)

# Run event study
event_study &lt;- run_es(
  data       = df,
  outcome    = y,
  treatment  = is_treated,
  time       = year,
  timing     = 2005,
  lead_range = 5,              # Corresponds to years 2000-2004 (relative time: -5 to -1)
  lag_range  = 4,              # Corresponds to years 2006-2009 (relative time: 1 to 4)
  fe         = firm_id + year,
  cluster    = "state_id",
  baseline   = -1,
  interval   = 1
)

# Basic plot
plot_es(event_study)

# Use error bars instead of ribbon confidence intervals
plot_es(event_study, type = "errorbar")

# Adjust vertical reference line
plot_es(event_study, type = "errorbar", vline_val = -0.5)

# Customize axis breaks and title
library(ggplot2)
plot_es(event_study, type = "errorbar") +
  ggplot2::scale_x_continuous(breaks = seq(-5, 4, by = 1)) +
  ggplot2::ggtitle("Result of Event Study")

</code></pre>

<hr>
<h2 id='run_es'>Run Event Study with Fixed Effects</h2><span id='topic+run_es'></span>

<h3>Description</h3>

<p>This function performs an event study using fixed effects regression.
It first generates lead and lag dummy variables relative to the treatment timing,
scales the time intervals if specified, and then estimates the regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_es(
  data,
  outcome,
  treatment,
  time,
  timing,
  lead_range,
  lag_range,
  fe,
  cluster = NULL,
  baseline = -1,
  interval = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_es_+3A_data">data</code></td>
<td>
<p>A dataframe containing the dataset.</p>
</td></tr>
<tr><td><code id="run_es_+3A_outcome">outcome</code></td>
<td>
<p>The name of the outcome variable (e.g., &quot;y&quot;). Should be unquoted.</p>
</td></tr>
<tr><td><code id="run_es_+3A_treatment">treatment</code></td>
<td>
<p>The name of the treatment variable (e.g., &quot;treated&quot;). Should be unquoted.</p>
</td></tr>
<tr><td><code id="run_es_+3A_time">time</code></td>
<td>
<p>The name of the time variable (e.g., &quot;year&quot;). Should be unquoted.</p>
</td></tr>
<tr><td><code id="run_es_+3A_timing">timing</code></td>
<td>
<p>The time period when the treatment occurred. For example, if the treatment was implemented in 1995, set 'timing = 1995'.</p>
</td></tr>
<tr><td><code id="run_es_+3A_lead_range">lead_range</code></td>
<td>
<p>Number of time periods to include before the treatment (negative leads). For example, 'lead_range = 3' includes 3 periods before the treatment.</p>
</td></tr>
<tr><td><code id="run_es_+3A_lag_range">lag_range</code></td>
<td>
<p>Number of time periods to include after the treatment (positive lags). For example, 'lag_range = 2' includes 2 periods after the treatment.</p>
</td></tr>
<tr><td><code id="run_es_+3A_fe">fe</code></td>
<td>
<p>A vector of fixed effects variables or an additive expression (e.g., firm_id + year). These variables account for unobserved heterogeneity.</p>
</td></tr>
<tr><td><code id="run_es_+3A_cluster">cluster</code></td>
<td>
<p>An optional variable for clustering standard errors. For example, 'cluster = &quot;state&quot;'.</p>
</td></tr>
<tr><td><code id="run_es_+3A_baseline">baseline</code></td>
<td>
<p>The relative time period to use as the baseline (default: -1). The corresponding dummy variable is excluded from the regression and treated as the reference group. For example, if 'baseline = 0', the treatment year is the baseline.</p>
</td></tr>
<tr><td><code id="run_es_+3A_interval">interval</code></td>
<td>
<p>The time interval between observations (default: 1). For example, use 'interval = 5' for datasets where time steps are in 5-year intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed for panel data and supports time intervals other than 1 (e.g., 5-year intervals).
It automatically scales the relative time variable using the 'interval' parameter.
</p>
<p>Steps:
1. Compute the relative time for each observation as '(time - timing) / interval'.
2. Generate lead and lag dummy variables within the specified ranges ('lead_range', 'lag_range').
3. Construct and estimate the fixed effects regression model using 'fixest::feols'.
4. Format the regression results into a tidy dataframe.
</p>
<p>If 'interval &gt; 1', ensure that the specified 'lead_range' and 'lag_range' correspond to the number of time intervals, not the absolute number of years.
</p>


<h3>Value</h3>

<p>A tidy dataframe with regression results. This includes:
- 'term': The lead or lag variable names.
- 'estimate': Estimated coefficients.
- 'std.error': Standard errors.
- 'conf.high': Upper bound of the 95
- 'conf.low': Lower bound of the 95
- 'relative_time': Scaled relative time based on the specified 'interval'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate panel data
df &lt;- tibble::tibble(
  firm_id = rep(1:50, each = 10),  # 50 firms over 10 years
  state_id = rep(sample(1:10, size = 50, replace = TRUE), each = 10),
  year = rep(2000:2009, times = 50),
  is_treated = rep(sample(c(1, 0), size = 50, replace = TRUE, prob = c(0.5, 0.5)), each = 10),
  y = rnorm(500, mean = 0, sd = 1)  # Simulated outcome variable
)

# Run event study
event_study &lt;- run_es(
  data       = df,
  outcome    = y,
  treatment  = is_treated,
  time       = year,
  timing     = 2005,
  lead_range = 5,              # Corresponds to years 2000-2004 (relative time: -5 to -1)
  lag_range  = 4,              # Corresponds to years 2006-2009 (relative time: 1 to 4)
  fe         = firm_id + year,
  cluster    = "state_id",
  baseline   = -1,
  interval   = 1
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
