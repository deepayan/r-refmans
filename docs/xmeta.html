<!DOCTYPE html><html lang="en"><head><title>Help for package xmeta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {xmeta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#xmeta-package'>
<p>A Tool Box for Multivariate Meta-Analysis</p></a></li>
<li><a href='#ca125'><p>Recurrent ovarian carcinoma study</p></a></li>
<li><a href='#dat.gen'><p>Generate  bivariate meta analysis studies</p></a></li>
<li><a href='#galaxy'><p>Galaxy Plot: A New Visualization Tool of Bivariate Meta-Analysis Studies</p></a></li>
<li><a href='#galaxy.trimfill'><p>Bivariate trim&amp;fill method</p></a></li>
<li><a href='#mmeta'><p>Methods for multiviarate random-effects meta-analysis</p></a></li>
<li><a href='#msset'><p>Testing and correcting for small study effects of multivariate meta-analysis</p></a></li>
<li><a href='#nat2'><p>A meta-analysis of the association between N-acetyltransterase 2 acetylation status and colorectal cancer</p></a></li>
<li><a href='#prostate'><p>Comparison between overall survival and disease-free survival for prostate cancer</p></a></li>
<li><a href='#sim_dat'><p>Simulated data</p></a></li>
<li><a href='#summary.mmeta'><p>Summarize the objects <code>mmeta</code></p></a></li>
<li><a href='#summary.msset'><p>Summarize the objects <code>msset</code></p></a></li>
<li><a href='#trimfill_rma'><p>Trim&amp;fill method for univariate meta analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Toolbox for Multivariate Meta-Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-03-10</td>
</tr>
<tr>
<td>Imports:</td>
<td>plotrix, aod, glmmML, numDeriv, metafor, mvmeta, stats, MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>A toolbox for meta-analysis. This package includes: 1,a robust multivariate meta-analysis of continuous or binary outcomes; 2, a bivariate Egger's test for detecting small study effects; 3, Galaxy Plot: A New Visualization Tool of Bivariate Meta-Analysis Studies; 4, a bivariate T&amp;F method accounting for publication bias in bivariate meta-analysis, based on symmetry of the galaxy plot. Hong C. et al(2020) &lt;<a href="https://doi.org/10.1093%2Faje%2Fkwz286">doi:10.1093/aje/kwz286</a>&gt;, Chongliang L. et al(2020) &lt;<a href="https://doi.org/10.1101%2F2020.07.27.20161562">doi:10.1101/2020.07.27.20161562</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-10 12:07:39 UTC; cjiajie</td>
</tr>
<tr>
<td>Author:</td>
<td>Chuan Hong [aut],
  Chongliang Luo [aut],
  Jiayi Tong [aut],
  Rui Duan [ctb],
  Haitao Chu [ctb],
  Yulun Liu [ctb],
  Yuqing Lei [cre],
  Yong Chen [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yuqing Lei &lt;lyqlei@pennmedicine.upenn.edu&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Penncil/xmeta">https://github.com/Penncil/xmeta</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Penncil/xmeta/issues">https://github.com/Penncil/xmeta/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-10 13:00:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='xmeta-package'>
A Tool Box for Multivariate Meta-Analysis
</h2><span id='topic+xmeta-package'></span><span id='topic+xmeta'></span>

<h3>Description</h3>

<p>The package <span class="pkg">xmeta</span> consists of a collection of functions for making inference and detecting publication bias in multivariate meta-analysis (MMA).
</p>


<h3>Inference</h3>

<p>The aim of the estimation methods is to estimate the coefficients 
<code class="reqn">\boldsymbol{\beta}</code> and the components of the between-study (co)variance matrix <code class="reqn">\boldsymbol{\Psi}</code> 
for multivariate random-effects meta-analysis. 
One major challenge in MMA is the standard inference procedures, such as the maximum likelihood or maximum restricted likelihood inference,
require the within-study correlations, which are usually unavailable. 
Different estimators with and without the knowledge of within study correlation are implemented in the package <span class="pkg">xmeta</span>. The estimation methods available in function <code><a href="#topic+mmeta">mmeta</a></code> are:
</p>

<ul>
<li> <p><b>Restricted maximum likelihood for MMA with continuous outcomes</b> 
</p>
</li>
<li> <p><b>Composite likelihood method for MMA with continuous outcomes</b> 
</p>
</li>
<li> <p><b>Method of moment for MMA with continuous outocmes</b> 
</p>
</li>
<li> <p><b>Improved method for Riley model for MMA with continuous outcomes</b> 
</p>
</li>
<li> <p><b>Marginal bivariate normal model for MMA with binary outcomes</b> 
</p>
</li>
<li> <p><b>Marginal beta-binomial model for MMA with binary outcomes</b>
</p>
</li>
<li> <p><b>Hybrid model for disease prevalence along with sensitivity and specificity for diagnostic test accuracy</b> 
</p>
</li>
<li> <p><b>Trivariate model for multivariate meta-analysis of diagnostic test accuracy</b>
</p>
</li></ul>



<h3>Small study effects</h3>

<p>Detecting and accounting for small study effects are challenging in MMA setting. The multivariate nature is often not fully accounted for by the existing univariate methods. 
The score test for detecting small study effects in MMA when the within-study correlations are unknown is implemented in the function <code><a href="#topic+msset">msset</a></code>. 
</p>


<h3>Galaxy Plot</h3>

<p>A New Visualization Tool of Bivariate Meta-Analysis Studies. This function <code><a href="#topic+galaxy">galaxy</a></code> returns the galaxy plot to visualize bivariate meta-analysis data, which faithfully retains the information in two separate funnel plots, while providing 
useful insights into outcome correlations, between-study heterogeneity and joint asymmetry. 
Galaxy plot is the counterpart of the funnel plot in the multivariate setting. 
The galaxy plot is an intuitive visualization tool that can aid in interpretation 
of results of multivariate meta-analysis. It preserves all of the information presented 
by separate funnel plots for each outcome while elucidating more complex features that 
may only be revealed by examining the joint distribution of the bivariate outcomes.
</p>


<h3>Publication bias in bivariate meta-analysis</h3>

<p>The function <code>galaxy.trimfill</code> implements a bivariate T&amp;F method accounting for publication bias in bivariate meta-analysis, based on symmetry of the galaxy plot. The bivariate T&amp;F method assumes studies are suppressed based on a weighted sum of the two outcomes. 
We use a searching algorithm to find the optimal direction which gives the most trimmed studies. This is based on the observation that the closer a direction is 
to the truth, the more studies are expected to be trimmed along that direction.   
</p>

<hr>
<h2 id='ca125'>Recurrent ovarian carcinoma study</h2><span id='topic+ca125'></span>

<h3>Description</h3>

<p>A meta-analysis of 52 studies that were reported between January 1995 and November 2007.</p>


<h3>Format</h3>

<p>The data frame contains the following columns:
</p>

<dl>
<dt>n</dt><dd><p>total number of subjects</p>
</dd>
<dt>PiY</dt><dd><p>disease prevalence</p>
</dd>
<dt>SeY</dt><dd><p>true positive</p>
</dd>
<dt>n1</dt><dd><p>subjects with disease</p>
</dd>
<dt>SpY</dt><dd><p>true negative</p>
</dd>
<dt>n1</dt><dd><p>health individuals</p>
</dd>  
</dl>



<h3>Note</h3>

<p>The dataset <code>ca125</code> is used to conduct multivariate meta-analysis of diagnostic test accuracy.
</p>


<h3>References</h3>

<p>Chen, Y., Liu, Y., Chu, H., Lee, M. and Schmid, C. (2017) A simple and robust method for multivariate meta-analysis of diagnostic test accuracy, Statistics in Medicine, 36, 105-121.
</p>
<p>Gu P, Pan L, Wu S, Sun L, Huang G. CA 125, PET alone, PET-CT, CT and MRI in diagnosing recurrent ovarian carcinoma: a systematic review and meta-analysis. European journal of radiology 2009; 71(1):164-174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mmeta">mmeta</a></code>,
<code><a href="#topic+summary.mmeta">summary.mmeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ca125)
summary(ca125)
</code></pre>

<hr>
<h2 id='dat.gen'>Generate  bivariate meta analysis studies</h2><span id='topic+dat.gen'></span>

<h3>Description</h3>

<p>Generate  bivariate meta analysis studies based on random-effects model, 
some studies with smallest weighted sum of the two outcomes are suppressed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dat.gen(
  m.o,
  m.m,
  s.m,
  angle.LC = pi/4,
  mybeta,
  tau.sq,
  rho.w,
  rho.b,
  s.min = 0.01,
  m.m.o = 0,
  s2.dist = 2,
  verbose = F
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dat.gen_+3A_m.o">m.o</code></td>
<td>
<p>number of observed studies</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_m.m">m.m</code></td>
<td>
<p>number of missing / suppressed studies</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_s.m">s.m</code></td>
<td>
<p>vector of the mean of the variances of the two outcomes</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_angle.lc">angle.LC</code></td>
<td>
<p>direction of suppressing line, default is pi/4, i.e. the studies on the left bottom corner are missing</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_mybeta">mybeta</code></td>
<td>
<p>the true center of the effect sizes</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_tau.sq">tau.sq</code></td>
<td>
<p>between-study variance, the larger it is the more heterogeneity.</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_rho.w">rho.w</code></td>
<td>
<p>within-study correlation of the two outcomes</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_rho.b">rho.b</code></td>
<td>
<p>between-study correlation of the two outcomes</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_s.min">s.min</code></td>
<td>
<p>minimum of the variances of the outcomes, default is 0.01</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_m.m.o">m.m.o</code></td>
<td>
<p>number of studies on one side of the suppressing line been observed, 
i.e. non-deterministic suppressing, default is 0, i.e. deterministic suppressing</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_s2.dist">s2.dist</code></td>
<td>
<p>options for generating the outcomes' variances. 1=runif, 2=runif^2, 3=runif^4, 4=rnorm</p>
</td></tr>
<tr><td><code id="dat.gen_+3A_verbose">verbose</code></td>
<td>
<p>logical, galaxy plot the studies? Default FALSE</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chongliang Luo, Yong Chen
</p>


<h3>References</h3>

<p>Luo C, Marks-Anglin AK, Duan R, Lin L, Hong C, Chu H, Chen Y. Accounting for small-study effects 
using a bivariate trim and fill meta-analysis procedure. medRxiv. 2020 Jan 1.
</p>

<hr>
<h2 id='galaxy'>Galaxy Plot: A New Visualization Tool of Bivariate Meta-Analysis Studies</h2><span id='topic+galaxy'></span>

<h3>Description</h3>

<p>A new visualization method that simultaneously presents the effect sizes of bivariate outcomes and their standard errors in a two-dimensional space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galaxy(data, y1, s1, y2, s2, scale1, scale2, scale.adj, 
              corr, group, study.label, annotate, xlab, ylab, main, legend.pos)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="galaxy_+3A_data">data</code></td>
<td>
<p>dataset with at least 4 columns for the effect sizes of the two outcomes and their standard errors</p>
</td></tr>
<tr><td><code id="galaxy_+3A_y1">y1</code></td>
<td>
<p>column name for outcome 1, default is 'y1'</p>
</td></tr>
<tr><td><code id="galaxy_+3A_s1">s1</code></td>
<td>
<p>column name for standard error of <code>y1</code>, default is 's1'</p>
</td></tr>
<tr><td><code id="galaxy_+3A_y2">y2</code></td>
<td>
<p>column name for outcome 2, default is 'y2'</p>
</td></tr>
<tr><td><code id="galaxy_+3A_s2">s2</code></td>
<td>
<p>column name for standard error of <code>y2</code>, default is 's2'</p>
</td></tr>
<tr><td><code id="galaxy_+3A_scale1">scale1</code></td>
<td>
<p>parameter for the length of the cross hair: the ellipse width is scale1 / s1 * scale.adj</p>
</td></tr>
<tr><td><code id="galaxy_+3A_scale2">scale2</code></td>
<td>
<p>parameter for the length of the cross hair: the ellipse height is scale2 / s2 * scale.adj</p>
</td></tr>
<tr><td><code id="galaxy_+3A_scale.adj">scale.adj</code></td>
<td>
<p>a pre-specified parameter to adjust for <code>scale1</code> and <code>scale2</code></p>
</td></tr>
<tr><td><code id="galaxy_+3A_corr">corr</code></td>
<td>
<p>column name for within-study correlation</p>
</td></tr>
<tr><td><code id="galaxy_+3A_group">group</code></td>
<td>
<p>column name for study group</p>
</td></tr>
<tr><td><code id="galaxy_+3A_study.label">study.label</code></td>
<td>
<p>column name for study label</p>
</td></tr>
<tr><td><code id="galaxy_+3A_annotate">annotate</code></td>
<td>
<p>logical specifying whether study label should be added to the plot, default is FALSE.</p>
</td></tr>
<tr><td><code id="galaxy_+3A_xlab">xlab</code></td>
<td>
<p>x axis label, default <code>y1</code></p>
</td></tr>
<tr><td><code id="galaxy_+3A_ylab">ylab</code></td>
<td>
<p>y axis label, default <code>y2</code></p>
</td></tr>
<tr><td><code id="galaxy_+3A_main">main</code></td>
<td>
<p>main title</p>
</td></tr>
<tr><td><code id="galaxy_+3A_legend.pos">legend.pos</code></td>
<td>
<p>The position of the legend for study groups if <code>group</code> is specified, see <code>legend</code>, default is 'bottomright'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns the galaxy plot to visualize bivariate meta-analysis data, 
which faithfully retains the information in two separate funnel plots, while providing 
useful insights into outcome correlations, between-study heterogeneity and joint asymmetry. 
Galaxy plot: a new visualization tool of bivariate meta-analysis studies.
Funnel plots have been widely used to detect small study effects in the results of 
univariate meta-analyses. However, there is no existing visualization tool that is 
the counterpart of the funnel plot in the multivariate setting. We propose a new 
visualization method, the galaxy plot, which can simultaneously present the effect sizes 
of bivariate outcomes and their standard errors in a two-dimensional space. 
The galaxy plot is an intuitive visualization tool that can aid in interpretation 
of results of multivariate meta-analysis. It preserves all of the information presented 
by separate funnel plots for each outcome while elucidating more complex features that 
may only be revealed by examining the joint distribution of the bivariate outcomes.
</p>


<h3>Author(s)</h3>

<p>Chuan Hong, Chongliang Luo, Yong Chen
</p>


<h3>References</h3>

<p>Hong, C., Duan, R., Zeng, L., Hubbard, R., Lumley, T., Riley, R., Chu, H., Kimmel, S., and Chen, Y. (2020) 
Galaxy Plot: A New Visualization Tool of Bivariate Meta-Analysis Studies, American Journal of Epidemiology, https://doi.org/10.1093/aje/kwz286.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim_dat)
galaxy(data=sim_dat, scale.adj = 0.9, corr = 'corr', group = 'subgroup', 
        study.label = 'study.id', annotate = TRUE, main = 'galaxy plot')

</code></pre>

<hr>
<h2 id='galaxy.trimfill'>Bivariate trim&amp;fill method</h2><span id='topic+galaxy.trimfill'></span>

<h3>Description</h3>

<p>Bivariate T&amp;F method accounting for small-study effects in bivariate meta-analysis, based on symmetry of the galaxy plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galaxy.trimfill(
  y1,
  v1,
  y2,
  v2,
  n.grid = 12,
  angle,
  estimator,
  side,
  rho = 0,
  method = "mm",
  method.uni = "DL",
  maxiter = 20,
  var.names = c("y1", "y2"),
  scale = 0.02,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="galaxy.trimfill_+3A_y1">y1</code></td>
<td>
<p>vector of the effect size estimates of the first outcome</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_v1">v1</code></td>
<td>
<p>estimated variance of <code>y1</code></p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_y2">y2</code></td>
<td>
<p>vector of the effect size estimates of the second outcome</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_v2">v2</code></td>
<td>
<p>estimated variance of <code>y2</code></p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_n.grid">n.grid</code></td>
<td>
<p>number of grid (equally spaced) candidate directions that the optimal projection direction are searched among, see Details</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_angle">angle</code></td>
<td>
<p>angles of candidate projection directions not by grid, this will overwrite n.grid</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_estimator">estimator</code></td>
<td>
<p>estimator used for the number of trimmed studies in univariate T&amp;F on the projected studies, one of c('R0', 'L0', 'Q0')</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_side">side</code></td>
<td>
<p>either &quot;left&quot; or &quot;right&quot;, indicating on which side of the galaxy plot 
the missing studies should be imputed. If null determined by the univariate T&amp;F</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_rho">rho</code></td>
<td>
<p>correlation between y1 and y2 when computing the variance of the projected studies. Default is the estimated cor(y1, y2)</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_method">method</code></td>
<td>
<p>method to estimate the center for the bivariate outcomes. Default is 'mm', i.e. random-effects model</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_method.uni">method.uni</code></td>
<td>
<p>method to estimate the center for the univariate projected studies using a univariate T&amp;F procedure. Default is 'DL', i.e. fixed-effects model</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_maxiter">maxiter</code></td>
<td>
<p>max number of iterations used in the univariate T&amp;F. Default is 20.</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_var.names">var.names</code></td>
<td>
<p>names of the two outcomes used in the galaxy plot (if plotted). Default is c('y1', 'y2')</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_scale">scale</code></td>
<td>
<p>constant scale for plotting the galaxy plot for the bivariate studies, Default is 0.02.</p>
</td></tr>
<tr><td><code id="galaxy.trimfill_+3A_verbose">verbose</code></td>
<td>
<p>plot the galaxy plot? Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bivariate T&amp;F method assumes studies are suppressed based on a weighted sum of the two outcomes, i.e. the studies with smallest values 
of z_i = c_1 * y_1i + c_2 * y_2i, i=1,...,N  are suppressed. We use a searching algorithm to find the optimal ratio of c_1  and c_2 (i.e. a direction), 
which gives the most trimmed studies. This is based on the observation that the closer a direction is to the truth, the more studies 
are expected to be trimmed along that direction. We set a sequence of equally-spaced candidate directions with angle a_m = m*pi/M, 
and (c_1, c_2) = (cos(a_m), sin(a_m)), m=1,...,M.
</p>


<h3>Value</h3>

<p>List with component:
</p>
<p>res  a data.frame of 9 columns and n.grid rows. Each row is the result for projection along one candidate grid direction, and the columns are named: 
'y1.c', 'y2.c' for projected bivariate center, 'y1.f', 'y2.f' for bivariate center using filled studies,
'k0', 'se.k0' for estimated number of trimmed studies and its standard error, 'se.y1.f', 'se.y2.f' for standard errors of 'y1.f', 'y2.f', 
'side.left' for the estimated side
</p>
<p>ID.trim list of vectors of ids of studies been trimmed along each of the candidate direction.
</p>


<h3>Author(s)</h3>

<p>Chongliang Luo, Yong Chen
</p>


<h3>References</h3>

<p>Luo C, Marks-Anglin AK, Duan R, Lin L, Hong C, Chu H, Chen Y. Accounting for small-study effects 
using a bivariate trim and fill meta-analysis procedure. medRxiv. 2020 Jan 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## Not run: 
require(MASS)
require(mvmeta)
require(metafor)
set.seed(123)
mydata &lt;- dat.gen(m.o=50, m.m=20,       # # observed studies, # missing studies
                  s.m= c(0.5, 0.5),     #  c(mean(s1), mean(s2))
                  angle.LC = pi/4,      # suppress line direction 
                  mybeta=c(2,2),        # true effect size
                  tau.sq=c(0.1, 0.1),   # true between-study var
                  rho.w=0.5, rho.b=0.5, # true within-study and between-study corr
                  s.min = 0.1,          # s1i ~ Unif(s.min, 2*s.m[1]-s.min) 
                  verbose = TRUE)

y1 &lt;- mydata$mydat.sps$y1
y2 &lt;- mydata$mydat.sps$y2
v1 &lt;- mydata$mydat.sps$s1^2
v2 &lt;- mydata$mydat.sps$s2^2

## unadjusted est 
mv_obs &lt;- mvmeta(cbind(y1, y2), cbind(v1, v2), method='mm')
c(mv_obs$coef)
# 2.142687 2.237741

estimator &lt;- 'R0' 
## univariate T&amp;F based on y1 or y2
y1.rma &lt;- rma(y1, v1, method='FE')
y2.rma &lt;- rma(y2, v2, method='FE')
y1.tf &lt;- trimfill.rma(y1.rma, estimator = estimator, method.fill = 'DL') 
y2.tf &lt;- trimfill.rma(y2.rma, estimator = estimator, method.fill = 'DL') 
c(y1.tf$beta, y2.tf$beta)
# 2.122231 2.181333
c(y1.tf$k0, y2.tf$k0)
# 2 8

## bivariate T&amp;F method (based on galaxy plot)
tf.grid &lt;- galaxy.trimfill(y1, v1, y2, v2, n.grid = 12,  
                           estimator=estimator, side='left',
                           method.uni = 'FE',
                           method = 'mm', 
                           rho=0.5, maxiter=100, verbose=FALSE) 
tf.grid$res
tf.grid$res[which(tf.grid$res$k0==max(tf.grid$res$k0)),3:5] 
#     y1.f     y2.f k0
# 2.053306 2.162347 14  

## less bias by the proposed bivariate T&amp;F method
rbind(true = c(2,2),
      unadjusted=c(mv_obs$coef), 
      tf.uni = c(y1.tf$beta, y2.tf$beta),
      tf.biv = tf.grid$res[which(tf.grid$res$k0==max(tf.grid$res$k0)),3:4])

## unlike the univariate T&amp;Fs, biv T&amp;F obtains one estimate of # missing studies
c(k0.true = 20,
  k0.tf.uni.y1 = y1.tf$k0, 
  k0.tf.uni.y2 = y2.tf$k0, 
  k0.tf.biv = tf.grid$res[which(tf.grid$res$k0==max(tf.grid$res$k0)),5])
# k0.true k0.tf.uni.y1 k0.tf.uni.y2    k0.tf.biv 
# 20            2            8           14

## End(Not run)
</code></pre>

<hr>
<h2 id='mmeta'>Methods for multiviarate random-effects meta-analysis</h2><span id='topic+mmeta'></span>

<h3>Description</h3>

<p>Methods for multiviarate random-effects meta-analysis</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmeta(data, rhow, type, k, method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mmeta_+3A_data">data</code></td>
<td>
<p>dataset</p>
</td></tr>
<tr><td><code id="mmeta_+3A_rhow">rhow</code></td>
<td>
<p>within-study correlation</p>
</td></tr>
<tr><td><code id="mmeta_+3A_type">type</code></td>
<td>
<p>either &quot;continuous&quot; or &quot;binary&quot;, indicating the type of outcomes.</p>
</td></tr>
<tr><td><code id="mmeta_+3A_k">k</code></td>
<td>
<p>integer indicating the number of outcomes</p>
</td></tr>
<tr><td><code id="mmeta_+3A_method">method</code></td>
<td>
<p>either &quot;nn.reml&quot;, &quot;nn.cl&quot;, &quot;nn.mom&quot;, &quot;nn.rs&quot;, &quot;bb.cl&quot;, &quot;bn.cl&quot;, &quot;tb.cl&quot; or &quot;tn.cl&quot;, indicating the estimation method. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Inference on the multivariate random-effects meta-analysis for both continuous and binary outcomes</b><br />
The function can be used in meta-analyses with continous outcomes and binary outcomes (e.g., mean differences, diagnostic test results in diagnostic accuracy studies, the exposure status of both cases and controls in case-control studies and so on). 
Different estimators with and without the knowledge of within-study correlations are implemented in this function. The estimation methods include <br />
</p>

<ul>
<li> <p><b>Restricted maximum likelihood for MMA with continuous outcomes</b>(nn.reml)
</p>
</li>
<li> <p><b>Composite likelihood method for MMA with continuous outcomes</b> (nn.cl)
</p>
</li>
<li> <p><b>Moment of method for MMA with continuous outocmes</b> (nn.mom)
</p>
</li>
<li> <p><b>Improved method for Riley model for MMA with continuous outcomes</b> (nn.rs)
</p>
</li>
<li> <p><b>Marginal bivariate normal model for MMA with binary outcomes</b> (bn.cl)
</p>
</li>
<li> <p><b>Marginal beta-binomial model for MMA with binary outcomes</b>(bb.cl)
</p>
</li>
<li> <p><b>Hybrid model for disease prevalence along with sensitivity and specificity for diagnostic test accuracy</b> (tb.cl)
</p>
</li>
<li> <p><b>Trivariate model for multivariate meta-analysis of diagnostic test accuracy</b>(tn.cl)
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>"mmeta"</code>. The object is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>estimated coefficients of the model.</p>
</td></tr>
<tr><td><code>beta.cov</code></td>
<td>
<p>covariance matrix of the coefficients.</p>
</td></tr>
</table>


<h3>Multivariate random-effects meta analysis</h3>

<p>We consider a meta-analysis with <code class="reqn">m</code> studies where two outcomes in each study are of interest. 
For the <code class="reqn">i</code>th study, denote <code class="reqn">Y_{ij}</code> and <code class="reqn">s_{ij}</code> the summary measure for the <code class="reqn">j</code>th outcome of interest and associated standard error respectively, both assumed known, <code class="reqn">i=1, \ldots, m</code>, and <code class="reqn">j=1,2</code>. 
Each summary measure <code class="reqn">Y_{ij}</code> is an estimate of the true effect size <code class="reqn">\theta_{ij}</code>. 
To account for heterogeneity in effect size across studies, we assume <code class="reqn">\theta_{ij}</code> to be independently drawn from a common distribution with overall effect size <code class="reqn">\beta_j</code> and between study variance <code class="reqn">\tau_j^2, j=1,2</code>. 
Under normal distribution assumption for <code class="reqn">Y_{ij}</code> and <code class="reqn">\theta_{ij}</code>, the general bivariate random-effects meta-analysis can be written as 
</p>
<p style="text-align: center;"><code class="reqn">
\left(\begin{array}{c}Y_{i1} \\ Y_{i2} \end{array} \right)\sim N\left( \left(\begin{array}{c}\theta_{i1} \\ \theta_{i2} \end{array} \right), {{\Delta_i}}\right),\quad
{{\Delta_i}}=\left(\begin{array}{cc} s_{i1}^2 &amp; s_{i1}s_{i2}\rho_{\textrm{W}i}\\ s_{i1}s_{i2}\rho_{\textrm{W}i} &amp; s_{i2}^2 \end{array} \right),
</code>
</p>

<p style="text-align: center;"><code class="reqn">
\left(\begin{array}{c}\theta_{i1} \\ \theta_{i2} \end{array} \right)\sim N\left(\left(\begin{array}{c}\beta_{1} \\ \beta_{2} \end{array} \right), {{\Omega}}\right),\quad
{{\Omega}}=\left(\begin{array}{cc} \tau_{1}^2 &amp; \tau_{1}\tau_{2}\rho_{\textrm{B}}\\ \tau_{1}\tau_{2}\rho_{\textrm{B}} &amp; \tau_{2}^2 \end{array} \right),
</code>
</p>

<p>where <code class="reqn">\Delta_i</code> and <code class="reqn">\Omega</code> are the respective within-study and between-study covariance matrices, and <code class="reqn">\rho_{\textrm{W}i}</code> and <code class="reqn">\rho_{\textrm{B}}</code> are the respective within-study and between-study correlations.
</p>


<h3>Restricted maximum likelihood for MMA</h3>

<p>When the within-study correlations are known, inference on the overall effect sizes <code class="reqn">\beta_1</code> and <code class="reqn">\beta_2</code> or their comparative measures (e.g., <code class="reqn">\beta_1-\beta_2</code>) 
can be based on the marginal distribution of <code class="reqn">\left(Y_{i1}, Y_{i2}\right)</code>
</p>
<p style="text-align: center;"><code class="reqn">
\left(\begin{array}{c}Y_{i1} \\ Y_{i2} \end{array} \right)\sim N\left(\left(\begin{array}{c}\beta_{1} \\ \beta_{2} \end{array} \right), \bf{V_i}\right),
\bf{V_i}=\Delta_i+\Omega=\left(\begin{array}{cc} s_{i1}^2+\tau_{1}^2 &amp; s_{i1}s_{i2}\rho_{wi}+\tau_{1}\tau_{2}\rho_{\textrm{B}}\\ s_{i1}s_{i2}\rho_{wi}+\tau_{1}\tau_{2}\rho_{\textrm{B}} &amp; s_{i2}^2+\tau_{2}^2 \end{array} \right).
</code>
</p>

<p>For simplicity of notation, denote <code class="reqn">\bf{Y_i}=(Y_{i1}, Y_{i2})^{T}</code>, <code class="reqn">{{\beta}}=(\beta_1, \beta_2)^T</code>, 
<code class="reqn">\eta_1=(\beta_1,\tau_1^2)^{T}</code> and <code class="reqn">\eta_2=(\beta_2,\tau_2^2)^{T}</code>. 
The restricted likelihood of <code class="reqn">(\eta_1, \eta_2, \rho_{\textrm{B}})</code> can be written as
</p>
<p style="text-align: center;"><code class="reqn">
\log L({{\eta}}_1, {{\eta}}_2, \rho_{\textrm{B}})
=-{1\over 2} \left[ \log \left( \Bigl| \sum_{i=1}^m \bf{V_i}^{-1}\Bigr| \right)+ \sum_{i=1}^m\left\{ \log |\bf{V_i}| + (\bf{Y_i}-{{\beta}})^T \bf{V_i}^{-1} (\bf{Y_i}-{{\beta}}) \right\}\right].
</code>
</p>

<p>The parameters <code class="reqn">(\eta_1, \eta_2, \rho_{\textrm{B}})</code> can be estimated by the restricted maximum likelihood (REML) approach as described in Van Houwelingen et al. (2002). The REML method for 
MMA is specified via <code>method</code> argument (<code>method="nn.reml"</code>). 
</p>
<p>The standard inference procedures, such as the maximum likelihood or maximum restricted likelihood inference, require the within-study correlations, which are usually unavailable.
In case within-study correlations are unknown, then one can leave the <code class="reqn">\rho_w</code> argument unspecified, and specify a method that does not require the within-study correlations via <code>method</code> argument. 
</p>


<h3>Composite likelihood method for MMA with continuous outcomes</h3>

<p>Chen et al. (2014) proposed a pseudolikelihood method for MMA with unknown within-study correlation. 
The pseudolikelihood method does not require within-study correlations, and is not prone to singular covariance matrix problem. 
In addition, it can properly estimate the covariance between pooled estimates for different outcomes, 
which enables valid inference on functions of pooled estimates, and can be applied to meta-analysis where some studies have outcomes MCAR. 
This composite likelihood method for MMA is specified via <code>method</code> argument (<code>method="nn.cl"</code>). 
</p>


<h3>Moment of method for MMA with continuous outocmes</h3>

<p>Chen et al. (2015) proposed a simple non-iterative method that can be used for the analysis of multivariate meta-analysis datasets 
that has no convergence problems and does not require the use of within-study correlations. 
The strategy is to use standard univariate methods for the marginal effects but also provides valid joint inference for multiple parameters. 
This method method can directly handle missing outcomes under missing completely at random assumption. 
This moment of method for MMA is specified via <code>method</code> argument (<code>method="nn.mom"</code>)
</p>


<h3>Improved method for Riley model for MMA with continuous outcomes</h3>

<p>Riley et al.(2008) proposed a working model and an overall synthesis correlation parameter to account for the marginal correlation between outcomes, 
where the only data needed are those required for a separate univariate random-effects meta-analysis. As within-study correlations are not required, 
the Riley method is applicable to a wide variety of evidence synthesis situations. 
However, the standard variance estimator of the Riley method is not entirely correct under many important settings. 
As a consequence, the coverage of a function of pooled estimates may not reach the nominal level even when the number of studies in the multivariate meta-analysis is large. 
Hong et al. (2015) improved the Riley method by proposing a robust variance estimator, 
which is asymptotically correct even when the model is misspecified (i.e., when the likelihood function is incorrect).  
The improved method for Riley model MMA is specified via <code>method</code> argument (<code>method="nn.rs"</code>)
</p>


<h3>Marginal bivariate normal model for MMA with binary outcomes</h3>

<p>Diagnostic systematic review is a vital step in the evaluation of diagnostic technologies. In many applications, it invovles pooling paris of sensitivity and specificity
of a dichotomized diagnostic test from multiple studies. 
Chen et al. (2014) proposed a composite likelihood method for bivariate meta-analysis in diagnostic systematic reviews.
The idea of marginal bivariate normal model for MMA with binary outcomes is to construct a composite likelihood (CL) funciton by using an independent working assumption between sensitivity and specificity.
There are three immediate advantages of using this CL method. First, the non-convergence or non positive definite covariance matrix problem is resolved since there is no correlation parameter involved in the CL. 
Secondly, because the two-dimensional integration involved in the standard likelihood is substituted by one-dimensional integrals, the approximation errors are substantially reduced. Thirdly, the inference based on the CL only relies on the marginal normality of logit sensitivity and specificity. 
Hence the proposed method can be more robust than the standard likelihood inference to mis-specifications of the joint distribution assumption. 
This method is specified via <code>method</code> argument (<code>method="bn.cl"</code>)
</p>


<h3>Marginal beta-binomial model for MMA with binary outcomes</h3>

<p>When conducting a meta-analysis of studies with bivariate binary outcomes, challenges arise when the within-study correlation and between-study heterogeneity should be taken into account. 
Chen et al. (2015) proposed a marginal beta-binomial model for the meta-analysis of studies with binary outcomes. 
This model is based on the composite likelihood approach, and has several attractive features compared to the existing models such as bivariate generalized linear mixed model (Chu and Cole, 2006) and Sarmanov beta-binomial model (Chen et al., 2012). 
The advantages of the proposed marginal model include modeling the probabilities in the original scale, not requiring any transformation of probabilities or any link function, having closed-form expression of likelihood function, and no constraints on the correlation parameter. 
More importantly, since the marginal beta-binomial model is only based on the marginal distributions, 
it does not suffer from potential misspecification of the joint distribution of bivariate study-specific probabilities. 
Such misspecification is difficult to detect and can lead to biased inference using currents methods. 
This method is specified via <code>method</code> argument (<code>method="bb.cl"</code>)
</p>


<h3>Hybrid model for disease prevalence along with sensitivity and specificity for diagnostic test accuracy</h3>

<p>Meta-analysis of diagnostic test accuracy often involves mixture of case-control and cohort studies. 
The existing bivariate random effects models, which jointly model bivariate accuracy indices (e.g., sensitivity and specificity), 
do not differentiate cohort studies from case-control studies, and thus do not utilize the prevalence information contained in the cohort studies. 
The trivariate generalized linear mixed models are only applicable to cohort studies, and more importantly, they assume the common correlation structure across studies, and the trivariate normality on disease prevalence, test sensitivity and specificity after transformation by some pre-specified link functions. 
In practice, very few studies provide justifications of these assumptions, and sometimes these assumptions are violated. 
Chen et al. (2015) evaluated the performance of the commonly used random effects model under violations of these assumptions and propose a simple and robust method to fully utilize 
the information contained in case-control and cohort studies. 
The proposed method avoids making the aforementioned assumptions and can provide valid joint inferences for any functions of overall summary measures of diagnostic accuracy. 
This method is specified via <code>method</code> argument (<code>method="tb.cl"</code>)
</p>


<h3>Trivariate model for multivariate meta-analysis of diagnostic test accuracy</h3>

<p>The standard methods for evaluating diagnostic accuracy only focus on sensitivity and specificity and ignore the information on disease prevalence contained in cohort studies. 
Consequently, such methods cannot provide estimates of measures related to disease prevalence, such as population averaged or overall positive and negative predictive values, 
which reflect the clinical utility of a diagnostic test. 
Chen et al. (2014) proposed a hybrid approach that jointly models the disease prevalence along with the diagnostic test sensitivity and specificity in cohort studies, 
and the sensitivity and specificity in case-control studies. In order to overcome the potential computational difficulties in the standard full likelihood inference of the proposed hybrid model, 
an alternative inference procedure was proposed based on the composite likelihood. Such composite likelihood based inference does not suffer computational problems and maintains high relative efficiency. 
In addition, it is more robust to model mis-specifications compared to the standard full likelihood inference. 
This method is specified via <code>method</code> argument (<code>method="tn.cl"</code>)
</p>


<h3>Author(s)</h3>

<p>Yong Chen, Yulun Liu</p>


<h3>References</h3>

<p>Chen, Y., Hong, C. and Riley, R. D. (2015). An alternative pseudolikelihood method for multivariate random-effects meta-analysis. Statistics in medicine, 34(3), 361-380.
</p>
<p>Chen, Y., Hong, C., Ning, Y. and Su, X. (2015). Meta-analysis of studies with bivariate binary outcomes: a marginal beta-binomial model approach, Statistics in Medicine (in press).
</p>
<p>Hong, C., Riley, R. D. and Chen, Y. (2015). An improved method for multivariate random-effects meta-analysis (in preparation).
</p>
<p>Chen, Y., Liu, Y., Ning, J., Nie, L., Zhu, H. and Chu, H. (2014). A composite likelihood method for bivariate meta-analysis in diagnostic systematic reviews. Statistical methods in medical research (in press).
</p>
<p>Chen, Y., Cai, Y., Hong, C. and Jackson, D. (2015). Inference for correlated effect sizes using multiple univariate meta-analyses, Statistics in Medicine (provisional acceptance).
</p>
<p>Chen, Y., Liu, Y., Ning, J., Cormier J. and Chu H. (2014). A hybrid model for combining case-control and cohort studies in systematic reviews of diagnostic tests, Journal
of the Royal Statistical Society: Series C (Applied Statistics) 64.3 (2015): 469-489.
</p>
<p>Chen, Y., Liu, Y., Chu, H., Lee, M. and Schmid, C. (2017) A simple and robust method for multivariate meta-analysis of diagnostic test accuracy, Statistics in Medicine, 36, 105-121.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prostate)
fit.nn=mmeta(data=prostate, type="continuous", k=2, method="nn.cl") 
summary(fit.nn)

rhow=runif(dim(prostate)[1], -0.2, 0.8)
fit.reml=mmeta(data=prostate, rhow=rhow, type="continuous", k=2, method="nn.reml") 
print(fit.reml)

data(nat2)
fit.bb=mmeta(data=nat2, type="binary", k=2, method="bb.cl") 
summary(fit.bb)

data(ca125)
fit.tb=mmeta(data=ca125, type="binary", k=2, method="tb.cl") 
summary(fit.tb)
</code></pre>

<hr>
<h2 id='msset'>Testing and correcting for small study effects of multivariate meta-analysis</h2><span id='topic+msset'></span>

<h3>Description</h3>

<p>Testing and correcting for small study effects of multivariate meta-analysis</p>


<h3>Usage</h3>

<pre><code class='language-R'>msset(data, nm.y1, nm.s1, nm.y2, nm.s2, method, type, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msset_+3A_data">data</code></td>
<td>
<p>dataset</p>
</td></tr>
<tr><td><code id="msset_+3A_nm.y1">nm.y1</code></td>
<td>
<p>column name for outcome 1</p>
</td></tr>
<tr><td><code id="msset_+3A_nm.s1">nm.s1</code></td>
<td>
<p>column name for standard error of outcome 1</p>
</td></tr>
<tr><td><code id="msset_+3A_nm.y2">nm.y2</code></td>
<td>
<p>column name for outcome 2</p>
</td></tr>
<tr><td><code id="msset_+3A_nm.s2">nm.s2</code></td>
<td>
<p>column name for standard error of outcome 2</p>
</td></tr>
<tr><td><code id="msset_+3A_method">method</code></td>
<td>
<p>&quot;nn.cl&quot; indicating the score test for detecting small study effects of MMA</p>
</td></tr>
<tr><td><code id="msset_+3A_type">type</code></td>
<td>
<p>either &quot;continuous&quot; or &quot;binary&quot; indicating the type of outcomes</p>
</td></tr>
<tr><td><code id="msset_+3A_k">k</code></td>
<td>
<p>integer indicating the number of outcomes</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns the test statistics for testing small study effects of multivariate
meta-analysis using regression method.</p>


<h3>Value</h3>

<p><code>msset.TS</code> returns the test statistic and p value of the score test.
</p>


<h3>A score test for detecting small study effects in multivariate meta-analysis</h3>

<p>Small study effects occur when smaller studies show different, often larger, treatment effects than large ones, which may threaten the validity of systematic reviews and meta-analyses. Detecting small study effects in a multivariate meta-analysis setting remains an untouched research area. Hong et al. (2019) propose a pseudolikelihood-based score test for detecting small study effects in multivariate random-effects meta-analysis. 
This is the first test for detecting small study effects in multivariate meta-analysis setting.
</p>


<h3>Author(s)</h3>

<p>Chuan Hong</p>


<h3>References</h3>

<p>Hong, C., Salanti, G., Morton, S., Riley, R., Chu, H., Kimmel, S.E. and Chen Y. (2019). Testing small study effects in multivariate meta-analysis (Biometrics).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prostate)
fit.msset=msset(data=prostate, nm.y1="y1", nm.s1="s1", nm.y2="y2", nm.s2="s2", 
method = "nn.cl", type = "continuous", k=2)
summary(fit.msset)
</code></pre>

<hr>
<h2 id='nat2'>A meta-analysis of the association between N-acetyltransterase 2 acetylation status and colorectal cancer</h2><span id='topic+nat2'></span>

<h3>Description</h3>

<p>A meta-analysis of 20 published case-control studies from January 1985 to October 2001</p>


<h3>Format</h3>

<p>The data frame contains the following columns:
</p>

<dl>
<dt>y1</dt><dd><p>acetylator status (exposed) in control group</p>
</dd>
<dt>n1</dt><dd><p>total number of subjects in control group</p>
</dd>
<dt>y2</dt><dd><p>acetylator status (exposed) in case group</p>
</dd>
<dt>n2</dt><dd><p>total number of subjects in case group</p>
</dd>
</dl>



<h3>Note</h3>

<p>The dataset <code>nat2</code> is used to conduct marginal bivariate normal model for MMA with binary outcomes
</p>


<h3>References</h3>

<p>Chen, Y., Hong, C., Ning, Y. and Su, X. (2015). Meta-analysis of studies with bivariate binary outcomes: a marginal beta-binomial model approach, Statistics in Medicine (in press).
</p>
<p>Ye Z, Parry JM. Meta-analysis of 20 case-control studies on the n-acetyltransferase 2 acetylation status and colorectal cancer risk.
Medical Science Review 2002; 8(8):CR558-CR565. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mmeta">mmeta</a></code>,
<code><a href="#topic+summary.mmeta">summary.mmeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nat2)
summary(nat2)
</code></pre>

<hr>
<h2 id='prostate'>Comparison between overall survival and disease-free survival for prostate cancer</h2><span id='topic+prostate'></span>

<h3>Description</h3>

<p>Results from five randomized clinical trials published between 1988 and 2011</p>


<h3>Format</h3>

<p>The data frame contains the following columns:
</p>

<dl>
<dt>y1</dt><dd><p>log-hazard ratio estimates comparing combined therapy using Goserelin acetate with radiotherapy with respect to
overall survival</p>
</dd>
<dt>s1</dt><dd><p>within-study standard error for outcome 1</p>
</dd>
<dt>y2</dt><dd><p>log-hazard ratio estimates comparing combined therapy using Goserelin acetate with radiotherapy with respect to
disease-free survival</p>
</dd>
<dt>s2</dt><dd><p>within-study stamdard error for outcome 2</p>
</dd>
</dl>



<h3>Note</h3>

<p>The dataset <code>prostate</code> is used to conduct bivariate random-effects meta-analysis when the within-study correlations are unknown.
</p>


<h3>References</h3>

<p>Chen, Y., Hong, C. and Riley, R. D. (2015). An alternative pseudolikelihood method for multivariate random-effects meta-analysis. Statistics in medicine, 34(3), 361-380.
</p>
<p>Sasse A, Sasse E, Carvalho A, Macedo L. Androgenic suppression combined with radiotherapy for the treatment of prostate
adenocarcinoma: a systematic review. BMC cancer 2012; 12(1):54.
30. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mmeta">mmeta</a></code>,
<code><a href="#topic+summary.mmeta">summary.mmeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prostate)
summary(prostate)
</code></pre>

<hr>
<h2 id='sim_dat'>Simulated data</h2><span id='topic+sim_dat'></span>

<h3>Description</h3>

<p>A simulated dataset for galaxy function</p>


<h3>Format</h3>

<p>The data frame contains the following columns:
</p>

<dl>
<dt>study.id</dt><dd><p>study id</p>
</dd>
<dt>y1</dt><dd><p>effect size for the first outcome</p>
</dd>
<dt>s1</dt><dd><p>within-study standard error for the first outcome</p>
</dd>
<dt>y2</dt><dd><p>effect size for the second outcome</p>
</dd>
<dt>s2</dt><dd><p>within-study stamdard error for the second outcome</p>
</dd>
<dt>corr</dt><dd><p>within-study correlation</p>
</dd>
<dt>subgroup</dt><dd><p>subgroup of the studies</p>
</dd>
</dl>



<h3>Note</h3>

<p>The dataset <code>sim_dat</code> is used to illustrate the galaxy plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+galaxy">galaxy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim_dat)
summary(sim_dat)
</code></pre>

<hr>
<h2 id='summary.mmeta'>Summarize the objects <code>mmeta</code></h2><span id='topic+summary.mmeta'></span>

<h3>Description</h3>

<p>Summarize a model of class <code>mmeta</code> fitted by <code>mmeta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>      ## S3 method for class 'mmeta'
summary(object,...) 
</code></pre>


<h3>Arguments</h3>

  
<table role = "presentation">
<tr><td><code id="summary.mmeta_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>mmeta</code>.</p>
</td></tr>
<tr><td><code id="summary.mmeta_+3A_...">...</code></td>
<td>
<p> additional arguments; currently none is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: coefficients, covariance matrix.
</p>


<h3>References</h3>

<p>Chen, Y., Hong, C. and Riley, R. D. (2015). An alternative pseudolikelihood method for multivariate random-effects meta-analysis. Statistics in medicine, 34(3), 361-380.
</p>
<p>Chen, Y., Hong, C., Ning, Y. and Su, X. (2015). Meta-analysis of studies with bivariate binary outcomes: a marginal beta-binomial model approach, Statistics in Medicine (in press).
</p>
<p>Hong, C., Riley, R. D. and Chen, Y. (2015). An improved method for multivariate random-effects meta-analysis (in preparation).
</p>
<p>Chen, Y., Liu, Y., Ning, J., Nie, L., Zhu, H. and Chu, H. (2014). A composite likelihood method for bivariate meta-analysis in diagnostic systematic reviews. Statistical methods in medical research (in press).
</p>
<p>Chen, Y., Cai, Y., Hong, C. and Jackson, D. (2015). Inference for correlated effect sizes using multiple univariate meta-analyses, Statistics in Medicine (provisional acceptance).
</p>
<p>Chen, Y., Liu, Y., Ning, J., Cormier J. and Chu H. (2014). A hybrid model for combining case-control and cohort studies in systematic reviews of diagnostic tests, Journal
of the Royal Statistical Society: Series C (Applied Statistics) 64.3 (2015): 469-489.
</p>
<p>Chen, Y., Liu, Y., Chu, H., Lee, M. and Schmid, C. (2017) A simple and robust method for multivariate meta-analysis of diagnostic test accuracy, Statistics in Medicine, 36, 105-121.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mmeta">mmeta</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prostate)
fit.nn=mmeta(data=prostate, type="continuous", k=2, method="nn.cl") 
summary(fit.nn)
</code></pre>

<hr>
<h2 id='summary.msset'>Summarize the objects <code>msset</code></h2><span id='topic+summary.msset'></span>

<h3>Description</h3>

<p>Summarize a model of class <code>msset</code> fitted by <code>msset</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>      ## S3 method for class 'msset'
summary(object,...) 
</code></pre>


<h3>Arguments</h3>

  
<table role = "presentation">
<tr><td><code id="summary.msset_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>msset</code>.</p>
</td></tr>
<tr><td><code id="summary.msset_+3A_...">...</code></td>
<td>
<p> additional arguments; currently none is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: test statistics (msset) and p-value.
</p>


<h3>References</h3>

<p>Hong, C., Salanti, G., Morton, S., Riley, R., Chu, H., Kimmel, S.E. and Chen Y. (2019). Testing small study effects in multivariate meta-analysis (Biometrics).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msset">msset</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prostate)
fit.msset=msset(data=prostate, nm.y1="y1", nm.s1="s1", nm.y2="y2", nm.s2="s2", 
method = "nn.cl", type = "continuous", k=2)
summary(fit.msset)
</code></pre>

<hr>
<h2 id='trimfill_rma'>Trim&amp;fill method for univariate meta analysis</h2><span id='topic+trimfill_rma'></span>

<h3>Description</h3>

<p>Modified metafor::trimfill.rma.uni to avoid the invalid sqrt in k0 calculation when estimator == &quot;Q0&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trimfill_rma(
  x,
  side,
  estimator = "L0",
  maxiter = 100,
  method.trim = NULL,
  method.fill = NULL,
  verbose = FALSE,
  ilim
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trimfill_rma_+3A_x">x</code></td>
<td>
<p>an object of class &quot;rma.uni&quot;.</p>
</td></tr>
<tr><td><code id="trimfill_rma_+3A_side">side</code></td>
<td>
<p>the same as in metafor::trimfill</p>
</td></tr>
<tr><td><code id="trimfill_rma_+3A_estimator">estimator</code></td>
<td>
<p>the same as in metafor::trimfill</p>
</td></tr>
<tr><td><code id="trimfill_rma_+3A_maxiter">maxiter</code></td>
<td>
<p>the same as in metafor::trimfill</p>
</td></tr>
<tr><td><code id="trimfill_rma_+3A_method.trim">method.trim</code></td>
<td>
<p>the model used in rma.uni() for estimating the center when trimming studies, default is x$method</p>
</td></tr>
<tr><td><code id="trimfill_rma_+3A_method.fill">method.fill</code></td>
<td>
<p>the model used in rma.uni() for estimating the center after filling studies, default is x$method</p>
</td></tr>
<tr><td><code id="trimfill_rma_+3A_verbose">verbose</code></td>
<td>
<p>the same as in metafor::trimfill</p>
</td></tr>
<tr><td><code id="trimfill_rma_+3A_ilim">ilim</code></td>
<td>
<p>limits for the imputed values as in metafor::trimfill. If unspecified, no limits are used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is recommend using fixed-effects for method.trim and random-effects for method.fill when heterogeneity exists.
</p>


<h3>Value</h3>

<p>the same as in metafor::trimfill
</p>


<h3>Author(s)</h3>

<p>Chongliang Luo, Yong Chen
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
