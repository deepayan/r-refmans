<!DOCTYPE html><html lang="en"><head><title>Help for package rechaRge</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rechaRge}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.as.data.table'><p>Make a data.table from input: coerce it or read it (if it is a file path) and ensure column names</p></a></li>
<li><a href='#.is.verbose'><p>Make a data.table from input: coerce it or read it (if it is a file path) and ensure column names</p></a></li>
<li><a href='#compute_potential_evapotranspiration_cell'><p>Compute PET based on the Oudin formula</p></a></li>
<li><a href='#compute_recharge'><p>Simulation using a recharge model</p></a></li>
<li><a href='#compute_vertical_inflow'><p>Determine if precipitation is rain or snow and simulate the snowpack (accumulation</p>
and melt) to compute the vertical inflow (vi), the liquid water available per day (rainfall + melt water).</a></li>
<li><a href='#compute_vertical_inflow_cell'><p>Compute the vertical inflow and the potential evapotranspiration (PET) for a single cell</p></a></li>
<li><a href='#compute_water_budget'><p>Compute the water budget</p></a></li>
<li><a href='#compute_water_budget_cell'><p>Compute the water budget for a single cell</p></a></li>
<li><a href='#evaluate_simulation_quality'><p>Evaluate the quality of the simulation result</p></a></li>
<li><a href='#KGE'><p>KGE computation</p></a></li>
<li><a href='#new_hydrobudget'><p>HydroBudget object</p></a></li>
<li><a href='#process_river_flow'><p>River flow processing</p></a></li>
<li><a href='#with_progress'><p>Progress option</p></a></li>
<li><a href='#with_verbose'><p>Verbose option</p></a></li>
<li><a href='#write_recharge_rasters'><p>Write result as raster files</p></a></li>
<li><a href='#write_recharge_results'><p>Write result as data files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>HydroBudget – Groundwater Recharge Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>HydroBudget is a spatially distributed
  groundwater recharge model that computes a superficial water
  budget on grid cells with outputs aggregated into monthly time steps.
  It was developed as an accessible and computationally affordable model
  to simulate groundwater recharge over large areas (thousands of km2,
  regional-scale watersheds) and for long time periods (decades), in cold
  and humid climates. Model algorithms are based on the research of
  Dubois, E. et al. (2021a) &lt;<a href="https://doi.org/10.5683%2FSP3%2FEUDV3H">doi:10.5683/SP3/EUDV3H</a>&gt; and 
  Dubois, E. et al. (2021b) &lt;<a href="https://doi.org/10.5194%2Fhess-25-6567-2021">doi:10.5194/hess-25-6567-2021</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>airGR, data.table, future, doFuture, foreach, hydrostats,
lubridate, ncdf4, plyr, progressr, raster, stats, sp, zoo,
R.utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), curl</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gwrecharge/rechaRge/">https://github.com/gwrecharge/rechaRge/</a>,
<a href="https://gwrecharge.github.io/rechaRge-book/">https://gwrecharge.github.io/rechaRge-book/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gwrecharge/rechaRge/issues/">https://github.com/gwrecharge/rechaRge/issues/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-13 14:47:40 UTC; ymarcon</td>
</tr>
<tr>
<td>Author:</td>
<td>Yannick Marcon <a href="https://orcid.org/0000-0003-0138-2023"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, ctb],
  Emmanuel Dubois <a href="https://orcid.org/0000-0003-4896-6368"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yannick Marcon &lt;yannick.marcon@epfl.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-14 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.as.data.table'>Make a data.table from input: coerce it or read it (if it is a file path) and ensure column names</h2><span id='topic+.as.data.table'></span>

<h3>Description</h3>

<p>Make a data.table from input: coerce it or read it (if it is a file path) and ensure column names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.as.data.table(input, colmap = NULL)
</code></pre>

<hr>
<h2 id='.is.verbose'>Make a data.table from input: coerce it or read it (if it is a file path) and ensure column names</h2><span id='topic+.is.verbose'></span>

<h3>Description</h3>

<p>Make a data.table from input: coerce it or read it (if it is a file path) and ensure column names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.is.verbose()
</code></pre>

<hr>
<h2 id='compute_potential_evapotranspiration_cell'>Compute PET based on the Oudin formula</h2><span id='topic+compute_potential_evapotranspiration_cell'></span>

<h3>Description</h3>

<p>Compute PET based on the Oudin formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_potential_evapotranspiration_cell(obj, input_dd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_potential_evapotranspiration_cell_+3A_obj">obj</code></td>
<td>
<p>The HydroBudget object.</p>
</td></tr>
<tr><td><code id="compute_potential_evapotranspiration_cell_+3A_input_dd">input_dd</code></td>
<td>
<p>Spatially distributed daily precipitation and mean temperature time series in a single cell.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Spatially distributed daily PET
</p>

<hr>
<h2 id='compute_recharge'>Simulation using a recharge model</h2><span id='topic+compute_recharge'></span><span id='topic+compute_recharge.default'></span><span id='topic+compute_recharge.hydrobudget'></span>

<h3>Description</h3>

<p>Performs a simulation of water recharge using a specific model.
</p>
<p>HydroBudget is a spatially distributed GWR model that computes a superficial water budget on
grid cells of regional-scale watersheds. Runoff, actual evapotranspiration (AET), and potential
GWR are simulated for each grid cell, with a monthly time step, and fluxes do not
transfer from a cell to another (no water routing). The model inputs are distributed daily
precipitation and temperature as well as distributed data of pedology, land cover, and slope.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_recharge(
  obj,
  rcn,
  climate,
  rcn_climate,
  period = NULL,
  workers = 1,
  ...
)

## Default S3 method:
compute_recharge(
  obj,
  rcn,
  climate,
  rcn_climate,
  period = NULL,
  workers = 1,
  ...
)

## S3 method for class 'hydrobudget'
compute_recharge(
  obj,
  rcn,
  climate,
  rcn_climate,
  period = NULL,
  workers = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_recharge_+3A_obj">obj</code></td>
<td>
<p>The recharge object.</p>
</td></tr>
<tr><td><code id="compute_recharge_+3A_rcn">rcn</code></td>
<td>
<p>The RCN values. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="compute_recharge_+3A_climate">climate</code></td>
<td>
<p>The daily total precipitation (mm/d) and average daily temperature (°C). Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="compute_recharge_+3A_rcn_climate">rcn_climate</code></td>
<td>
<p>The relation between the RCN and climate cells. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="compute_recharge_+3A_period">period</code></td>
<td>
<p>The start and end years. If not provided, the start/end years will be extracted from the climate data.</p>
</td></tr>
<tr><td><code id="compute_recharge_+3A_workers">workers</code></td>
<td>
<p>The number of workers to use in the parallel computations. If NULL, an optimal number of cores will be used. This optimal number is also the maximum value. Default value is 1 (no parallelization).</p>
</td></tr>
<tr><td><code id="compute_recharge_+3A_...">...</code></td>
<td>
<p>Other arguments passed to methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The expected columns for the RCN data set input are:
</p>

<ul>
<li> <p><strong>rcn_id</strong>, the RCN cell ID
</p>
</li>
<li> <p><strong>RCNII</strong>
</p>
</li>
<li> <p><strong>lon</strong>
</p>
</li>
<li> <p><strong>lat</strong>
</p>
</li></ul>

<p>The expected columns for the climate data set input are:
</p>

<ul>
<li> <p><strong>climate_id</strong> the climate cell ID
</p>
</li>
<li> <p><strong>day</strong>
</p>
</li>
<li> <p><strong>month</strong>
</p>
</li>
<li> <p><strong>year</strong>
</p>
</li>
<li> <p><strong>t_mean</strong>
</p>
</li>
<li> <p><strong>p_tot</strong>
</p>
</li>
<li> <p><strong>lat</strong>
</p>
</li></ul>

<p>The expected columns for the RCN-climate data set input are:
</p>

<ul>
<li> <p><strong>climate_id</strong> the climate cell ID
</p>
</li>
<li> <p><strong>rcn_id</strong>, the RCN cell ID
</p>
</li></ul>

<p>The columns of the water budget data set output are:
</p>

<ul>
<li> <p><strong>year</strong>
</p>
</li>
<li> <p><strong>month</strong>
</p>
</li>
<li> <p><strong>vi</strong>
</p>
</li>
<li> <p><strong>t_mean</strong>
</p>
</li>
<li> <p><strong>runoff</strong>
</p>
</li>
<li> <p><strong>pet</strong>
</p>
</li>
<li> <p><strong>aet</strong>
</p>
</li>
<li> <p><strong>gwr</strong>
</p>
</li>
<li> <p><strong>runoff_2</strong>
</p>
</li>
<li> <p><strong>delta_reservoir</strong>
</p>
</li>
<li> <p><strong>rcn_id</strong>
</p>
</li></ul>



<h3>Value</h3>

<p>The water budget
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Use input example files provided by the package
base_url &lt;- "https://github.com/gwrecharge/rechaRge-book/raw/main/examples/input/"
input_rcn &lt;- paste0(base_url, "rcn.csv.gz")
input_climate &lt;- paste0(base_url, "climate.csv.gz")
input_rcn_climate &lt;- paste0(base_url, "rcn_climate.csv.gz")

# Calibration parameters
HB &lt;- rechaRge::new_hydrobudget(
  T_m = 2.1, # melting temperature (°C)
  C_m = 6.2, # melting coefficient (mm/°C/d)
  TT_F = -17.6, # Threshold temperature for soil frost (°C)
  F_T = 16.4, # Freezing time (d)
  t_API = 3.9, # Antecedent precipitation index time (d)
  f_runoff = 0.63, # Runoff factor (-)
  sw_m = 431, # Maximum soil water content (mm)
  f_inf = 0.07 # infiltration factor (-)
)

# Simulation period
simul_period &lt;- c(2010, 2017)

# Parallel computing option
# workers &lt;- 6

# Simulation with the HydroBudget model
water_budget &lt;- rechaRge::compute_recharge(
  HB,
  rcn = input_rcn,
  climate = input_climate,
  rcn_climate = input_rcn_climate,
  period = simul_period
  # workers = workers
)
head(water_budget)

## End(Not run)
</code></pre>

<hr>
<h2 id='compute_vertical_inflow'>Determine if precipitation is rain or snow and simulate the snowpack (accumulation
and melt) to compute the vertical inflow (vi), the liquid water available per day (rainfall + melt water).</h2><span id='topic+compute_vertical_inflow'></span>

<h3>Description</h3>

<p>Determine if precipitation is rain or snow and simulate the snowpack (accumulation
and melt) to compute the vertical inflow (vi), the liquid water available per day (rainfall + melt water).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_vertical_inflow(obj, climate_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_vertical_inflow_+3A_obj">obj</code></td>
<td>
<p>The HydroBudget object.</p>
</td></tr>
<tr><td><code id="compute_vertical_inflow_+3A_climate_data">climate_data</code></td>
<td>
<p>The daily total precipitation (mm/d) and average daily temperature (°C).</p>
</td></tr>
</table>

<hr>
<h2 id='compute_vertical_inflow_cell'>Compute the vertical inflow and the potential evapotranspiration (PET) for a single cell</h2><span id='topic+compute_vertical_inflow_cell'></span>

<h3>Description</h3>

<p>Compute the vertical inflow and the potential evapotranspiration (PET) for a single cell
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_vertical_inflow_cell(obj, input_dd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_vertical_inflow_cell_+3A_obj">obj</code></td>
<td>
<p>The HydroBudget object.</p>
</td></tr>
<tr><td><code id="compute_vertical_inflow_cell_+3A_input_dd">input_dd</code></td>
<td>
<p>Spatially distributed daily precipitation and mean temperature time series in a single cell.</p>
</td></tr>
</table>

<hr>
<h2 id='compute_water_budget'>Compute the water budget</h2><span id='topic+compute_water_budget'></span>

<h3>Description</h3>

<p>Compute the water budget
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_water_budget(obj, rcn_data, climate_data, workers)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_water_budget_+3A_obj">obj</code></td>
<td>
<p>The HydroBudget object.</p>
</td></tr>
<tr><td><code id="compute_water_budget_+3A_rcn_data">rcn_data</code></td>
<td>
<p>The RCN values.</p>
</td></tr>
<tr><td><code id="compute_water_budget_+3A_climate_data">climate_data</code></td>
<td>
<p>The daily total precipitation (mm/d) and average daily temperature (°C).</p>
</td></tr>
<tr><td><code id="compute_water_budget_+3A_workers">workers</code></td>
<td>
<p>The number of workers to use in the parallel computations.</p>
</td></tr>
</table>

<hr>
<h2 id='compute_water_budget_cell'>Compute the water budget for a single cell</h2><span id='topic+compute_water_budget_cell'></span>

<h3>Description</h3>

<p>Compute the water budget for a single cell
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_water_budget_cell(obj, rcn_climate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_water_budget_cell_+3A_obj">obj</code></td>
<td>
<p>The HydroBudget object.</p>
</td></tr>
<tr><td><code id="compute_water_budget_cell_+3A_rcn_climate">rcn_climate</code></td>
<td>
<p>The RCN values with the climate data (daily total precipitation (mm/d) and average daily temperature (°C)) for a single cell.</p>
</td></tr>
</table>

<hr>
<h2 id='evaluate_simulation_quality'>Evaluate the quality of the simulation result</h2><span id='topic+evaluate_simulation_quality'></span><span id='topic+evaluate_simulation_quality.default'></span><span id='topic+evaluate_simulation_quality.hydrobudget'></span>

<h3>Description</h3>

<p>From a simulation result, evaluate the quality by comparing with observations. The quality
measurement can be used for model calibration (e.g. caRamel package) or sensitivity evaluation
(e.g. sensitivity package).
</p>
<p>Evaluates the simulated water budget with the average KGE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_simulation_quality(obj, water_budget, ...)

## Default S3 method:
evaluate_simulation_quality(obj, water_budget, ...)

## S3 method for class 'hydrobudget'
evaluate_simulation_quality(
  obj,
  water_budget,
  rcn_gauging,
  observed_flow,
  alpha_lyne_hollick,
  period = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluate_simulation_quality_+3A_obj">obj</code></td>
<td>
<p>The HydroBudget object with calibration parameters and column names mappings.</p>
</td></tr>
<tr><td><code id="evaluate_simulation_quality_+3A_water_budget">water_budget</code></td>
<td>
<p>The computed water budget. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="evaluate_simulation_quality_+3A_...">...</code></td>
<td>
<p>Other arguments passed to methods</p>
</td></tr>
<tr><td><code id="evaluate_simulation_quality_+3A_rcn_gauging">rcn_gauging</code></td>
<td>
<p>The table with the list of RCN cells located in each gauging station watershed. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="evaluate_simulation_quality_+3A_observed_flow">observed_flow</code></td>
<td>
<p>The flow rates in mm/day. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="evaluate_simulation_quality_+3A_alpha_lyne_hollick">alpha_lyne_hollick</code></td>
<td>
<p>The Lyne and Hollick filter. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="evaluate_simulation_quality_+3A_period">period</code></td>
<td>
<p>The start and end years. If not provided, the start/end years will be extracted from the water budget data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The columns of the water budget data set input are:
</p>

<ul>
<li> <p><strong>year</strong>
</p>
</li>
<li> <p><strong>month</strong>
</p>
</li>
<li> <p><strong>vi</strong>
</p>
</li>
<li> <p><strong>t_mean</strong>
</p>
</li>
<li> <p><strong>runoff</strong>
</p>
</li>
<li> <p><strong>pet</strong>
</p>
</li>
<li> <p><strong>aet</strong>
</p>
</li>
<li> <p><strong>gwr</strong>
</p>
</li>
<li> <p><strong>runoff_2</strong>
</p>
</li>
<li> <p><strong>delta_reservoir</strong>
</p>
</li>
<li> <p><strong>rcn_id</strong>
</p>
</li></ul>

<p>The columns of the observed flow data set input are:
</p>

<ul>
<li> <p><strong>year</strong>
</p>
</li>
<li> <p><strong>month</strong>
</p>
</li>
<li> <p><strong>day</strong>
</p>
</li>
<li> <p><strong>one column per station</strong> (named by the station ID), the flow rates in mm/day
</p>
</li></ul>

<p>The columns of the RCN gauging stations data set input are:
</p>

<ul>
<li> <p><strong>rcn_id</strong>, the cell ID
</p>
</li>
<li> <p><strong>station_id</strong>, the station ID
</p>
</li></ul>

<p>The columns of the Lyne and Hollick filter data set input are:
</p>

<ul>
<li> <p><strong>station_id</strong>, the station ID
</p>
</li>
<li> <p><strong>alpha</strong>
</p>
</li></ul>



<h3>Value</h3>

<p>The model-specific quality assessment.
</p>
<p>The HydroBudget quality assessment.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Use input example files provided by the package
base_url &lt;- "https://github.com/gwrecharge/rechaRge-book/raw/main/examples/input/"
input_rcn_gauging &lt;- paste0(base_url, "rcn_gauging.csv.gz")
input_observed_flow &lt;- paste0(base_url, "observed_flow.csv.gz")
input_alpha_lyne_hollick &lt;- paste0(base_url, "alpha_lyne_hollick.csv.gz")

# Calibration parameters
HB &lt;- rechaRge::new_hydrobudget(
  T_m = 2.1, # melting temperature (°C)
  C_m = 6.2, # melting coefficient (mm/°C/d)
  TT_F = -17.6, # Threshold temperature for soil frost (°C)
  F_T = 16.4, # Freezing time (d)
  t_API = 3.9, # Antecedent precipitation index time (d)
  f_runoff = 0.63, # Runoff factor (-)
  sw_m = 431, # Maximum soil water content (mm)
  f_inf = 0.07 # infiltration factor (-)
)

# ... compute the water budget ...

result &lt;- evaluate_simulation_quality(
  HB,
  water_budget = water_budget,
  rcn_gauging = input_rcn_gauging,
  observed_flow = input_observed_flow,
  alpha_lyne_hollick = input_alpha_lyne_hollick,
  period = simul_period
)

## End(Not run)
</code></pre>

<hr>
<h2 id='KGE'>KGE computation</h2><span id='topic+KGE'></span>

<h3>Description</h3>

<p>Compute the Kling-Gupta Efficiency coefficient which summarizes the discrepancy
between observed values and the values expected under the model in question.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KGE(sim, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KGE_+3A_sim">sim</code></td>
<td>
<p>Simulated values</p>
</td></tr>
<tr><td><code id="KGE_+3A_obs">obs</code></td>
<td>
<p>Observed values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Kling-Gupta Efficiency between 'sim' and 'obs'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim &lt;- c(0.5, 0.5, 10, 15, 0.5, 20, 25, 0.1, 15, 10)
obs &lt;- c(1, 0.1, 0.1, 20, 0.6, 30, 20, 0.5, 30, 8)
rechaRge::KGE(sim, obs)
</code></pre>

<hr>
<h2 id='new_hydrobudget'>HydroBudget object</h2><span id='topic+new_hydrobudget'></span>

<h3>Description</h3>

<p>Make a new HydroBudget object, by providing the calibration parameters for the
model computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_hydrobudget(T_m, C_m, TT_F, F_T, t_API, f_runoff, sw_m, f_inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_hydrobudget_+3A_t_m">T_m</code></td>
<td>
<p>The melting temperature (°C)</p>
</td></tr>
<tr><td><code id="new_hydrobudget_+3A_c_m">C_m</code></td>
<td>
<p>The melting coefficient (mm/°C/d)</p>
</td></tr>
<tr><td><code id="new_hydrobudget_+3A_tt_f">TT_F</code></td>
<td>
<p>The Threshold temperature for soil frost (°C)</p>
</td></tr>
<tr><td><code id="new_hydrobudget_+3A_f_t">F_T</code></td>
<td>
<p>The freezing time (d)</p>
</td></tr>
<tr><td><code id="new_hydrobudget_+3A_t_api">t_API</code></td>
<td>
<p>The antecedent precipitation index time (d)</p>
</td></tr>
<tr><td><code id="new_hydrobudget_+3A_f_runoff">f_runoff</code></td>
<td>
<p>The runoff factor (-)</p>
</td></tr>
<tr><td><code id="new_hydrobudget_+3A_sw_m">sw_m</code></td>
<td>
<p>The maximum soil water content (mm)</p>
</td></tr>
<tr><td><code id="new_hydrobudget_+3A_f_inf">f_inf</code></td>
<td>
<p>The infiltration factor (-)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class hydrobudget
</p>

<hr>
<h2 id='process_river_flow'>River flow processing</h2><span id='topic+process_river_flow'></span>

<h3>Description</h3>

<p>Processing of the river flow to compute the baseflow with Lyne and Hollick and resample them into monthly observations by:
</p>

<ol>
<li><p> select the available river flow observations for the simulation period and fill the gaps (up to 5 missing days),
</p>
</li>
<li><p> extract the list of the available gauging stations for the simulation period (list of the names),
</p>
</li>
<li><p> compute the Lyne and Hollick baseflow and resample river flow and baseflow with a monthly time step.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>process_river_flow(obj, observed_flow, alpha_lyne_hollick)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_river_flow_+3A_obj">obj</code></td>
<td>
<p>The HydroBudget object with calibration parameters and column names mappings.</p>
</td></tr>
<tr><td><code id="process_river_flow_+3A_observed_flow">observed_flow</code></td>
<td>
<p>The flow rates in mm/day. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="process_river_flow_+3A_alpha_lyne_hollick">alpha_lyne_hollick</code></td>
<td>
<p>The Lyne and Hollick filter. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of observed_flow_month and gauging
</p>

<hr>
<h2 id='with_progress'>Progress option</h2><span id='topic+with_progress'></span>

<h3>Description</h3>

<p>Progress option
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_progress(progress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="with_progress_+3A_progress">progress</code></td>
<td>
<p>Logical to set for having a progress bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(Invisible) the return value of <a href="progressr.html#topic+handlers">handlers</a>
</p>

<hr>
<h2 id='with_verbose'>Verbose option</h2><span id='topic+with_verbose'></span>

<h3>Description</h3>

<p>Verbose option
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_verbose(verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="with_verbose_+3A_verbose">verbose</code></td>
<td>
<p>Logical to set for having verbose messages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(Invisible) the return value of <a href="base.html#topic+options">options</a>
</p>

<hr>
<h2 id='write_recharge_rasters'>Write result as raster files</h2><span id='topic+write_recharge_rasters'></span><span id='topic+write_recharge_rasters.default'></span><span id='topic+write_recharge_rasters.hydrobudget'></span>

<h3>Description</h3>

<p>Export raster for interannual runoff, aet and GWR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_recharge_rasters(
  obj,
  water_budget,
  input_rcn,
  crs,
  output_dir = tempdir(),
  ...
)

## Default S3 method:
write_recharge_rasters(
  obj,
  water_budget,
  input_rcn,
  crs,
  output_dir = tempdir(),
  ...
)

## S3 method for class 'hydrobudget'
write_recharge_rasters(
  obj,
  water_budget,
  input_rcn,
  crs,
  output_dir = tempdir(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_recharge_rasters_+3A_obj">obj</code></td>
<td>
<p>The recharge object.</p>
</td></tr>
<tr><td><code id="write_recharge_rasters_+3A_water_budget">water_budget</code></td>
<td>
<p>The computed water budget. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="write_recharge_rasters_+3A_input_rcn">input_rcn</code></td>
<td>
<p>The RCN values. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="write_recharge_rasters_+3A_crs">crs</code></td>
<td>
<p>The coordinate reference systems.</p>
</td></tr>
<tr><td><code id="write_recharge_rasters_+3A_output_dir">output_dir</code></td>
<td>
<p>The output directory where result files will be written. Default is a temporary directory.</p>
</td></tr>
<tr><td><code id="write_recharge_rasters_+3A_...">...</code></td>
<td>
<p>Other arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(Invisible) the output directory.
</p>

<hr>
<h2 id='write_recharge_results'>Write result as data files</h2><span id='topic+write_recharge_results'></span><span id='topic+write_recharge_results.default'></span><span id='topic+write_recharge_results.hydrobudget'></span>

<h3>Description</h3>

<p>Export water budget.
</p>
<p>Supported formats are &quot;csv&quot; (default) or &quot;nc&quot; (NetCDF).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_recharge_results(obj, water_budget, output_dir = tempdir(), ...)

## Default S3 method:
write_recharge_results(obj, water_budget, output_dir = tempdir(), ...)

## S3 method for class 'hydrobudget'
write_recharge_results(
  obj,
  water_budget,
  output_dir = tempdir(),
  format = "csv",
  input_rcn = NULL,
  names = list(lon = list(longname = "Longitude", unit = "deg"), lat = list(longname =
    "Lattitude", unit = "deg"), time = list(longname =
    "Month since start of the water budget", unit = "month")),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_recharge_results_+3A_obj">obj</code></td>
<td>
<p>The recharge object.</p>
</td></tr>
<tr><td><code id="write_recharge_results_+3A_water_budget">water_budget</code></td>
<td>
<p>The computed water budget.</p>
</td></tr>
<tr><td><code id="write_recharge_results_+3A_output_dir">output_dir</code></td>
<td>
<p>The output directory where result files will be written. Default is a temporary directory.</p>
</td></tr>
<tr><td><code id="write_recharge_results_+3A_...">...</code></td>
<td>
<p>Other arguments passed to methods</p>
</td></tr>
<tr><td><code id="write_recharge_results_+3A_format">format</code></td>
<td>
<p>The file output format. Use &quot;nc&quot; for NetCDF format. Default is &quot;csv&quot;.</p>
</td></tr>
<tr><td><code id="write_recharge_results_+3A_input_rcn">input_rcn</code></td>
<td>
<p>The RCN values. Input can be a data.frame/data.table or a path to a data file.</p>
</td></tr>
<tr><td><code id="write_recharge_results_+3A_names">names</code></td>
<td>
<p>The long names and units of the NetCDF dimensions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(Invisible) the output directory.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
