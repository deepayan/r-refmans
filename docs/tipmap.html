<!DOCTYPE html><html><head><title>Help for package tipmap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tipmap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tipmap-package'><p>tipmap: Tipping Point Analysis for Bayesian Dynamic Borrowing</p></a></li>
<li><a href='#create_new_trial_data'><p>Data on new trial in target population</p></a></li>
<li><a href='#create_posterior_data'><p>Creates posterior distributions for a range of weights on the informative component of the robust MAP prior</p></a></li>
<li><a href='#create_prior_data'><p>Creates input data frame for construction of MAP prior</p></a></li>
<li><a href='#create_tipmap_data'><p>Create data frame ready to use for tipping point analysis</p></a></li>
<li><a href='#default_quantiles'><p>Default quantiles</p></a></li>
<li><a href='#default_weights'><p>Default weights</p></a></li>
<li><a href='#draw_beta_mixture_nsamples'><p>Draw samples from a mixture of beta distributions</p></a></li>
<li><a href='#fit_beta_1exp'><p>Fit beta distribution for one expert</p></a></li>
<li><a href='#fit_beta_mult_exp'><p>Fit beta distributions for multiple experts</p></a></li>
<li><a href='#get_cum_probs_1exp'><p>Get cumulative probabilities from distribution of chips of one expert</p></a></li>
<li><a href='#get_model_input_1exp'><p>Transform cumulative probabilities to fit beta distributions</p></a></li>
<li><a href='#get_posterior_by_weight'><p>Filter posterior by given weights</p></a></li>
<li><a href='#get_summary_mult_exp'><p>Summarize expert weights</p></a></li>
<li><a href='#get_tipping_points'><p>Identify tipping point for a specific quantile.</p></a></li>
<li><a href='#load_tipmap_data'><p>Load exemplary datasets</p></a></li>
<li><a href='#oc_bias'><p>Assessing bias</p></a></li>
<li><a href='#oc_coverage'><p>Assessing coverage</p></a></li>
<li><a href='#oc_pos'><p>Assessing probability of success</p></a></li>
<li><a href='#tipmap_darkblue'><p>Custom dark blue</p></a></li>
<li><a href='#tipmap_lightred'><p>Custom light red</p></a></li>
<li><a href='#tipmap_plot'><p>Visualize tipping point analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tipping Point Analysis for Bayesian Dynamic Borrowing</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Tipping point analysis for clinical trials that employ Bayesian dynamic borrowing via robust meta-analytic predictive (MAP) priors. Further functions facilitate expert elicitation of a primary weight of the informative component of the robust MAP prior and computation of operating characteristics. Intended use is the planning, analysis and interpretation of extrapolation studies in pediatric drug development, but applicability is generally wider.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Boehringer-Ingelheim/tipmap">https://github.com/Boehringer-Ingelheim/tipmap</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Boehringer-Ingelheim/tipmap/issues">https://github.com/Boehringer-Ingelheim/tipmap/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, magrittr, purrr, ggplot2, RBesT, assertthat, stats,
furrr, future</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, tidyr, tibble, testthat (&ge; 3.0.0),</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-13 22:13:56 UTC; stockch</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian Stock <a href="https://orcid.org/0000-0002-3493-3234"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Morten Dreher [aut],
  Emma Torrini [ctb],
  Boehringer Ingelheim Pharma GmbH &amp; Co. KG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian Stock &lt;christian.stock@boehringer-ingelheim.com&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-14 10:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='tipmap-package'>tipmap: Tipping Point Analysis for Bayesian Dynamic Borrowing</h2><span id='topic+tipmap'></span><span id='topic+tipmap-package'></span>

<h3>Description</h3>

<p>Tipping point analysis for clinical trials that employ Bayesian dynamic borrowing via robust meta-analytic predictive (MAP) priors. Further functions facilitate expert elicitation of a primary weight of the informative component of the robust MAP prior and computation of operating characteristics. Intended use is the planning, analysis and interpretation of extrapolation studies in pediatric drug development, but applicability is generally wider.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Christian Stock <a href="mailto:christian.stock@boehringer-ingelheim.com">christian.stock@boehringer-ingelheim.com</a> (<a href="https://orcid.org/0000-0002-3493-3234">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Morten Dreher
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Emma Torrini [contributor]
</p>
</li>
<li><p>  Boehringer Ingelheim Pharma GmbH &amp; Co. KG [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/Boehringer-Ingelheim/tipmap">https://github.com/Boehringer-Ingelheim/tipmap</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/Boehringer-Ingelheim/tipmap/issues">https://github.com/Boehringer-Ingelheim/tipmap/issues</a>
</p>
</li></ul>


<hr>
<h2 id='create_new_trial_data'>Data on new trial in target population</h2><span id='topic+create_new_trial_data'></span>

<h3>Description</h3>

<p>Creates a vector containing data on the new trial in the target population. This may be hypothetical data in the planning stage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_new_trial_data(n_total, est, se)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_new_trial_data_+3A_n_total">n_total</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="create_new_trial_data_+3A_est">est</code></td>
<td>
<p>Treatment effect estimate.</p>
</td></tr>
<tr><td><code id="create_new_trial_data_+3A_se">se</code></td>
<td>
<p>Standard error of the treatment effect estimate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with data on the new trial, incl. quantiles of an assumed normal data likelihood.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_posterior_data">create_posterior_data</a></code>, <code><a href="#topic+create_tipmap_data">create_tipmap_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>new_trial_data &lt;- create_new_trial_data(
  n_total = 30, est = 1.27, se = 0.95
)

</code></pre>

<hr>
<h2 id='create_posterior_data'>Creates posterior distributions for a range of weights on the informative component of the robust MAP prior</h2><span id='topic+create_posterior_data'></span>

<h3>Description</h3>

<p>Returns a data frame containing the default quantiles of posterior mixture distributions
generated with varying weights on the informative component of the MAP prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_posterior_data(map_prior, new_trial_data, sigma, null_effect = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_posterior_data_+3A_map_prior">map_prior</code></td>
<td>
<p>A MAP prior containing information about the trial(s) in the source population, created using <code>RBesT</code>.</p>
</td></tr>
<tr><td><code id="create_posterior_data_+3A_new_trial_data">new_trial_data</code></td>
<td>
<p>A vector containing information about the new trial. See <code>create_new_trial_data()</code>.</p>
</td></tr>
<tr><td><code id="create_posterior_data_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation to be used for the weakly informative component of the MAP prior, recommended to be the unit-information standard deviation.</p>
</td></tr>
<tr><td><code id="create_posterior_data_+3A_null_effect">null_effect</code></td>
<td>
<p>The mean of the robust component of the MAP prior. Defaults to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing posterior distributions for varying weights
</p>


<h3>References</h3>

<p>Best, N., Price, R. G., Pouliquen, I. J., &amp; Keene, O. N. (2021).
Assessing efficacy in important subgroups in confirmatory trials: An example
using Bayesian dynamic borrowing. Pharm Stat, 20(3), 551â€“562.
https://doi.org/10.1002/pst.2093
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_new_trial_data">create_new_trial_data</a></code>, <code><a href="#topic+create_prior_data">create_prior_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# create vector containing data on new trial
new_trial_data &lt;- create_new_trial_data(
  n_total = 30,
  est = 1.27,
  se = 0.95
)

# read MAP prior created by RBesT
map_prior &lt;- load_tipmap_data("tipmapPrior.rds")

# create posterior data
## Not run: 
posterior_data &lt;- create_posterior_data(
  map_prior = map_prior,
  new_trial_data = new_trial_data,
  sigma = 12
)

## End(Not run)
</code></pre>

<hr>
<h2 id='create_prior_data'>Creates input data frame for construction of MAP prior</h2><span id='topic+create_prior_data'></span>

<h3>Description</h3>

<p>Assembling information from trials in the source population in a structured way (required as a pre-processing step for MAP prior creation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_prior_data(study_label = NULL, n_total, est, se)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_prior_data_+3A_study_label">study_label</code></td>
<td>
<p>An optional vector containing trial labels.</p>
</td></tr>
<tr><td><code id="create_prior_data_+3A_n_total">n_total</code></td>
<td>
<p>A vector containing total sample sizes.</p>
</td></tr>
<tr><td><code id="create_prior_data_+3A_est">est</code></td>
<td>
<p>A vector containing treatment effect estimates.</p>
</td></tr>
<tr><td><code id="create_prior_data_+3A_se">se</code></td>
<td>
<p>A vector containing standard errors of the effect estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing data on the trials in the source population.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_new_trial_data">create_new_trial_data</a></code>, <code><a href="#topic+create_posterior_data">create_posterior_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior_data &lt;- create_prior_data(
  n_total = c(160, 240, 320),
  est = c(1.23, 1.40, 1.51),
  se = c(0.4, 0.36, 0.31)
)
</code></pre>

<hr>
<h2 id='create_tipmap_data'>Create data frame ready to use for tipping point analysis</h2><span id='topic+create_tipmap_data'></span>

<h3>Description</h3>

<p>Combines new trial data created by <code>createTargetData()</code>, a posterior distribution created by <code>create_posterior_data()</code> and a
robust MAP prior using <code>RBesT::automixfit()</code> and an optional meta-analysis, e.g. created using the <code>meta</code> package, into a data frame
needed for the functions <code>tipmap_plot()</code> and <code>get_tipping_point()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_tipmap_data(new_trial_data, posterior, map_prior, meta_analysis = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_tipmap_data_+3A_new_trial_data">new_trial_data</code></td>
<td>
<p>A data frame containing data on the new trial in the target population. See <code>create_new_trial_data()</code>.</p>
</td></tr>
<tr><td><code id="create_tipmap_data_+3A_posterior">posterior</code></td>
<td>
<p>A mixture combining MAP prior and target population. See <code>create_posterior_data()</code>.</p>
</td></tr>
<tr><td><code id="create_tipmap_data_+3A_map_prior">map_prior</code></td>
<td>
<p>A robust MAP prior created by <code>RBesT::automixfit()</code>.</p>
</td></tr>
<tr><td><code id="create_tipmap_data_+3A_meta_analysis">meta_analysis</code></td>
<td>
<p>A data frame containing a meta-analysis of trial(s) to be borrowed from. See <code>createPriorData()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame ready to be used for <code>tipmap_plot()</code> and <code>get_tipping_point()</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_new_trial_data">create_new_trial_data</a></code>, <code><a href="#topic+create_posterior_data">create_posterior_data</a></code>, <code><a href="#topic+tipmap_plot">tipmap_plot</a></code>, <code><a href="#topic+get_tipping_points">get_tipping_points</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# specify new trial data
new_trial_data &lt;- create_new_trial_data(n_total = 30, est = 1.5, se = 2.1)

# read MAP prior data
map_prior &lt;- load_tipmap_data("tipmapPrior.rds")

# read posterior data
posterior &lt;- load_tipmap_data("tipPost.rds")

tip_dat &lt;- create_tipmap_data(
  new_trial_data = new_trial_data,
  posterior = posterior,
  map_prior = map_prior
)

</code></pre>

<hr>
<h2 id='default_quantiles'>Default quantiles</h2><span id='topic+default_quantiles'></span>

<h3>Description</h3>

<p>Default quantiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_quantiles
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 13.
</p>

<hr>
<h2 id='default_weights'>Default weights</h2><span id='topic+default_weights'></span>

<h3>Description</h3>

<p>Default weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_weights
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 201.
</p>

<hr>
<h2 id='draw_beta_mixture_nsamples'>Draw samples from a mixture of beta distributions</h2><span id='topic+draw_beta_mixture_nsamples'></span>

<h3>Description</h3>

<p>Draws samples from a mixture of beta distributions, representing pooled weights on the informative component of a robust MAP prior, as elicited from experts via the roulette method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_beta_mixture_nsamples(n, chips_mult, expert_weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_beta_mixture_nsamples_+3A_n">n</code></td>
<td>
<p>Numeric value, the number of samples to be drawn.</p>
</td></tr>
<tr><td><code id="draw_beta_mixture_nsamples_+3A_chips_mult">chips_mult</code></td>
<td>
<p>Numeric matrix, containing expert weighting (distributions of chips). Rows should represent experts, columns should represent bins / weight intervals.</p>
</td></tr>
<tr><td><code id="draw_beta_mixture_nsamples_+3A_expert_weight">expert_weight</code></td>
<td>
<p>An optional numeric vector, containing the weight assigned to each expert (defaults to equal weights).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing samples from a pooled distribution of expert opinions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_beta_mult_exp">fit_beta_mult_exp</a></code> and <code><a href="#topic+get_summary_mult_exp">get_summary_mult_exp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rweights &lt;- draw_beta_mixture_nsamples(
  n = 50,
  chips_mult = rbind(
    c(0, 0, 0, 0, 2, 3, 3, 2, 0, 0),
    c(0, 0, 0, 1, 2, 4, 2, 1, 0, 0),
    c(0, 0, 0, 2, 2, 2, 2, 2, 0, 0)
  ),
  expert_weight = rep(1/3, 3)
)
print(rweights)
## Not run: 
hist(rweights)

## End(Not run)
</code></pre>

<hr>
<h2 id='fit_beta_1exp'>Fit beta distribution for one expert</h2><span id='topic+fit_beta_1exp'></span>

<h3>Description</h3>

<p>Fit beta distribution to data elicited from one expert via the roulette method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_beta_1exp(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_beta_1exp_+3A_df">df</code></td>
<td>
<p>A dataframe generated by <code><a href="#topic+get_model_input_1exp">get_model_input_1exp</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is based on <code>SHELF::fitdist</code> and yields identical results.
</p>


<h3>Value</h3>

<p>Parameters (<code>alpha</code> and <code>beta</code>) of a beta fit.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_model_input_1exp">get_model_input_1exp</a></code> and <code><a href="#topic+fit_beta_mult_exp">fit_beta_mult_exp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>chips &lt;- c(0, 2, 3, 2, 1, 1, 1, 0, 0, 0)
x &lt;- get_cum_probs_1exp(chips)
y &lt;- get_model_input_1exp(x)
fit_beta_1exp(df = y)["par"] 

</code></pre>

<hr>
<h2 id='fit_beta_mult_exp'>Fit beta distributions for multiple experts</h2><span id='topic+fit_beta_mult_exp'></span>

<h3>Description</h3>

<p>Fit beta distributions to data elicited from multiple experts via the roulette method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_beta_mult_exp(chips_mult)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_beta_mult_exp_+3A_chips_mult">chips_mult</code></td>
<td>
<p>A dataframe or matrix containing weights.
It should contain one row per expert and 10 columns, one for each bin, representing weights from 0 to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the parameters of the individual beta distributions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_beta_1exp">fit_beta_1exp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>beta_fits &lt;- fit_beta_mult_exp(
  chips_mult = rbind(
    c(0, 0, 0, 0, 2, 3, 3, 2, 0, 0),
    c(0, 0, 0, 1, 2, 4, 2, 1, 0, 0),
    c(0, 0, 0, 2, 2, 2, 2, 2, 0, 0)
  )
)
print(beta_fits)

</code></pre>

<hr>
<h2 id='get_cum_probs_1exp'>Get cumulative probabilities from distribution of chips of one expert</h2><span id='topic+get_cum_probs_1exp'></span>

<h3>Description</h3>

<p>Get cumulative probabilities from distribution of chips of one expert
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cum_probs_1exp(chips)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_cum_probs_1exp_+3A_chips">chips</code></td>
<td>
<p>Vector of integers, representing the distribution of chips assigned by one expert, as elicited through the roulette method.
Each element of the vector represents one bin in the grid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with the cumulative distribution of chips.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_model_input_1exp">get_model_input_1exp</a></code> and <code><a href="#topic+fit_beta_1exp">fit_beta_1exp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>chips &lt;- c(0, 2, 3, 2, 1, 1, 1, 0, 0, 0)
x &lt;- get_cum_probs_1exp(chips)
print(x)

</code></pre>

<hr>
<h2 id='get_model_input_1exp'>Transform cumulative probabilities to fit beta distributions</h2><span id='topic+get_model_input_1exp'></span>

<h3>Description</h3>

<p>Transform cumulative probabilities to fit beta distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_model_input_1exp(cum_probs, w = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_model_input_1exp_+3A_cum_probs">cum_probs</code></td>
<td>
<p>Numeric vector, containing cumulative probabilities of weights for one expert, as elicited through the roulette method. Each element of the vector represents one bin in the grid.</p>
</td></tr>
<tr><td><code id="get_model_input_1exp_+3A_w">w</code></td>
<td>
<p>Numeric vector, upper interval limit of bin (defaults to <code>1:length(cum_probs) / length(cum_probs)</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe to be used as input to fit beta distributions by <code><a href="#topic+fit_beta_1exp">fit_beta_1exp</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_cum_probs_1exp">get_cum_probs_1exp</a></code> and <code><a href="#topic+fit_beta_1exp">fit_beta_1exp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>chips &lt;- c(0, 2, 3, 2, 1, 1, 1, 0, 0, 0)
x &lt;- get_cum_probs_1exp(chips)
print(x)
y &lt;- get_model_input_1exp(x)
print(y)

</code></pre>

<hr>
<h2 id='get_posterior_by_weight'>Filter posterior by given weights</h2><span id='topic+get_posterior_by_weight'></span>

<h3>Description</h3>

<p>Returns quantiles of the posterior distribution of the treatment effect for one or more specified weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_posterior_by_weight(posterior, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_posterior_by_weight_+3A_posterior">posterior</code></td>
<td>
<p>The posterior data to be filtered (see <code>create_posterior_data()</code>).</p>
</td></tr>
<tr><td><code id="get_posterior_by_weight_+3A_weight">weight</code></td>
<td>
<p>The weight(s) to be filtered by.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The filtered posterior values
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_posterior_data">create_posterior_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_posterior_by_weight(
  posterior = load_tipmap_data("tipPost.rds"),
  weight = c(0.05, 0.1)
)

</code></pre>

<hr>
<h2 id='get_summary_mult_exp'>Summarize expert weights</h2><span id='topic+get_summary_mult_exp'></span>

<h3>Description</h3>

<p>Computes minimum, maximum, mean and quartiles for expert weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_summary_mult_exp(chips_mult, n = 500, expert_weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_summary_mult_exp_+3A_chips_mult">chips_mult</code></td>
<td>
<p>Numeric matrix, containing expert weights.</p>
</td></tr>
<tr><td><code id="get_summary_mult_exp_+3A_n">n</code></td>
<td>
<p>Number of samples to be drawn to obtain summary statistics (defaults to 500).</p>
</td></tr>
<tr><td><code id="get_summary_mult_exp_+3A_expert_weight">expert_weight</code></td>
<td>
<p>Weights assigned to each expert (defaults to equal weights).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing summary statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_summary_mult_exp(
  chips_mult = rbind(
    c(0, 0, 0, 0, 2, 3, 3, 2, 0, 0),
    c(0, 0, 0, 1, 2, 4, 2, 1, 0, 0),
    c(0, 0, 0, 2, 2, 2, 2, 2, 0, 0)
  ), 
  n = 50
)

</code></pre>

<hr>
<h2 id='get_tipping_points'>Identify tipping point for a specific quantile.</h2><span id='topic+get_tipping_points'></span>

<h3>Description</h3>

<p>Identifies the weights closest to tipping points for specified quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_tipping_points(tipmap_data, quantile, null_effect = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_tipping_points_+3A_tipmap_data">tipmap_data</code></td>
<td>
<p>A data frame created by <code>create_tipmap_data()</code>.</p>
</td></tr>
<tr><td><code id="get_tipping_points_+3A_quantile">quantile</code></td>
<td>
<p>The quantile(s) of the tipping point. Possible values are 0.025, 0.05, 0.1, 0.2, 0.8, 0.9, 0.95 and 0.975.</p>
</td></tr>
<tr><td><code id="get_tipping_points_+3A_null_effect">null_effect</code></td>
<td>
<p>The null treatment effect. Defaults to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The weight closest to the tipping point for the specified quantile
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_tipmap_data">create_tipmap_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tip_dat &lt;- load_tipmap_data("tipdat.rds")#'
get_tipping_points(tip_dat, quantile = 0.025)
get_tipping_points(tip_dat, quantile = c(0.025, 0.05, 0.1, 0.2), null_effect = 0.1)

</code></pre>

<hr>
<h2 id='load_tipmap_data'>Load exemplary datasets</h2><span id='topic+load_tipmap_data'></span>

<h3>Description</h3>

<p>Loads one of three exemplary datasets in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_tipmap_data(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_tipmap_data_+3A_file">file</code></td>
<td>
<p>The dataset to be loaded.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pre-saved dataset.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
load_tipmap_data(file = "tipdat.rds")
load_tipmap_data(file = "tipmapPrior.rds")
load_tipmap_data(file = "tipPost.rds")

</code></pre>

<hr>
<h2 id='oc_bias'>Assessing bias</h2><span id='topic+oc_bias'></span>

<h3>Description</h3>

<p>Assessment of absolute bias in posterior means and medians for a given weight and evidence level, using simulated data as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oc_bias(
  m,
  se,
  true_effect,
  weights = seq(0, 1, by = 0.01),
  map_prior,
  sigma,
  n_cores = 1,
  eval_strategy = "sequential"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oc_bias_+3A_m">m</code></td>
<td>
<p>Numerical vector of simulated effect estimates.</p>
</td></tr>
<tr><td><code id="oc_bias_+3A_se">se</code></td>
<td>
<p>Numerical vector of simulated standard errors (<code>m</code> and <code>se</code> need to have the same length).</p>
</td></tr>
<tr><td><code id="oc_bias_+3A_true_effect">true_effect</code></td>
<td>
<p>Numerical value, representing the true treatment effect (usually the mean of the simulated <code>m</code>).</p>
</td></tr>
<tr><td><code id="oc_bias_+3A_weights">weights</code></td>
<td>
<p>Vector of weights of the informative component of the MAP prior (defaults to <code>seq(0, 1, by = 0.01)</code>).</p>
</td></tr>
<tr><td><code id="oc_bias_+3A_map_prior">map_prior</code></td>
<td>
<p>A MAP prior containing information about the trials in the source population, created using <code>RBesT</code>; a mixture of normal distributions is required.</p>
</td></tr>
<tr><td><code id="oc_bias_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the weakly informative component of the MAP prior, recommended to be the unit-information standard deviation.</p>
</td></tr>
<tr><td><code id="oc_bias_+3A_n_cores">n_cores</code></td>
<td>
<p>Integer value, representing the number of cores to be used (defaults to 1); only applies if <code>eval_strategy</code> is not &quot;sequential&quot;.</p>
</td></tr>
<tr><td><code id="oc_bias_+3A_eval_strategy">eval_strategy</code></td>
<td>
<p>Character variable, representing the evaluation strategy, either &quot;sequential&quot;, &quot;multisession&quot;, or &quot;multicore&quot; (see documentation of <code>future::plan</code>, defaults to &quot;sequential&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 2-dimensional array containing results on bias.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oc_pos">oc_pos</a></code> and <code><a href="#topic+oc_coverage">oc_coverage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n_sims &lt;- 5 # small number for exemplary application 
sim_dat &lt;- list(
  "m" = rnorm(n = n_sims, mean = 1.15, sd = 0.1),
  "se" = rnorm(n = n_sims, mean = 1.8, sd = 0.3)
)
results &lt;- oc_bias(
  m = sim_dat[["m"]],
  se = sim_dat[["se"]],
  true_effect = 1.15,
  weights = seq(0, 1, by = 0.01), 
  map_prior = load_tipmap_data("tipmapPrior.rds"), 
  sigma = 16.23,
  eval_strategy = "sequential",
  n_cores = 1
) 
print(results)
</code></pre>

<hr>
<h2 id='oc_coverage'>Assessing coverage</h2><span id='topic+oc_coverage'></span>

<h3>Description</h3>

<p>Assessment of coverage of posterior intervals for a given weight and evidence level, using simulated data as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oc_coverage(
  m,
  se,
  true_effect,
  weights = seq(0, 1, by = 0.01),
  map_prior,
  sigma,
  n_cores = 1,
  eval_strategy = "sequential"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oc_coverage_+3A_m">m</code></td>
<td>
<p>Numerical vector of simulated effect estimates.</p>
</td></tr>
<tr><td><code id="oc_coverage_+3A_se">se</code></td>
<td>
<p>Numerical vector of simulated standard errors (<code>m</code> and <code>se</code> need to have the same length).</p>
</td></tr>
<tr><td><code id="oc_coverage_+3A_true_effect">true_effect</code></td>
<td>
<p>Numerical value, representing the true treatment effect (usually the mean of the simulated <code>m</code>).</p>
</td></tr>
<tr><td><code id="oc_coverage_+3A_weights">weights</code></td>
<td>
<p>Vector of weights of the informative component of the MAP prior (defaults to <code>seq(0, 1, by = 0.01)</code>).</p>
</td></tr>
<tr><td><code id="oc_coverage_+3A_map_prior">map_prior</code></td>
<td>
<p>A MAP prior containing information about the trials in the source population, created using <code>RBesT</code>; a mixture of normal distributions is required.</p>
</td></tr>
<tr><td><code id="oc_coverage_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the weakly informative component of the MAP prior, recommended to be the unit-information standard deviation.</p>
</td></tr>
<tr><td><code id="oc_coverage_+3A_n_cores">n_cores</code></td>
<td>
<p>Integer value, representing the number of cores to be used (defaults to 1); only applies if <code>eval_strategy</code> is not &quot;sequential&quot;.</p>
</td></tr>
<tr><td><code id="oc_coverage_+3A_eval_strategy">eval_strategy</code></td>
<td>
<p>Character variable, representing the evaluation strategy, either &quot;sequential&quot;, &quot;multisession&quot;, or &quot;multicore&quot; (see documentation of <code>future::plan</code>, defaults to &quot;sequential&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 2-dimensional array containing results on coverage.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oc_pos">oc_pos</a></code> and <code><a href="#topic+oc_bias">oc_bias</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n_sims &lt;- 5 # small number for exemplary application 
sim_dat &lt;- list(
  "m" = rnorm(n = n_sims, mean = 1.15, sd = 0.1),
  "se" = rnorm(n = n_sims, mean = 1.8, sd = 0.3)
)
results &lt;- oc_coverage(
  m = sim_dat[["m"]],
  se = sim_dat[["se"]],
  true_effect = 1.15,
  weights = seq(0, 1, by = 0.01), 
  map_prior = load_tipmap_data("tipmapPrior.rds"), 
  sigma = 16.23
) 
print(results)
</code></pre>

<hr>
<h2 id='oc_pos'>Assessing probability of success</h2><span id='topic+oc_pos'></span>

<h3>Description</h3>

<p>Assessment of the probability of truly or falsely (depending on simulated scenario) rejecting the null hypothesis of interest for a given weight and evidence level, using simulated data as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oc_pos(
  m,
  se,
  probs,
  weights = seq(0, 1, by = 0.01),
  map_prior,
  sigma,
  null_effect = 0,
  direction_pos = T,
  n_cores = 1,
  eval_strategy = "sequential"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oc_pos_+3A_m">m</code></td>
<td>
<p>Numerical vector of simulated effect estimates.</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_se">se</code></td>
<td>
<p>Numerical vector of simulated standard errors (<code>m</code> and <code>se</code> need to have the same length).</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_probs">probs</code></td>
<td>
<p>Vector of quantiles q, with 1 minus q representing an evidence level of interest (where positive effect estimate indicate a beneficial treatment).</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_weights">weights</code></td>
<td>
<p>Vector of weights of the informative component of the MAP prior (defaults to <code>seq(0, 1, by = 0.01)</code>).</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_map_prior">map_prior</code></td>
<td>
<p>A MAP prior containing information about the trials in the source population, created using <code>RBesT</code>; a mixture of normal distributions is required.</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the weakly informative component of the MAP prior, recommended to be the unit-information standard deviation.</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_null_effect">null_effect</code></td>
<td>
<p>Numerical value, representing the null effect (defaults to 0).</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_direction_pos">direction_pos</code></td>
<td>
<p>Logical value, <code>TRUE</code> (default) if effects greater that the <code>null_effect</code> indicate a beneficial treatment and <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_n_cores">n_cores</code></td>
<td>
<p>Integer value, representing the number of cores to be used (defaults to 1); only applies if <code>eval_strategy</code> is not &quot;sequential&quot;.</p>
</td></tr>
<tr><td><code id="oc_pos_+3A_eval_strategy">eval_strategy</code></td>
<td>
<p>Character variable, representing the evaluation strategy, either &quot;sequential&quot;, &quot;multisession&quot;, or &quot;multicore&quot; (see documentation of <code>future::plan</code>, defaults to &quot;sequential&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 2-dimensional array containing probabilities, either of truly (probability of success) or falsely rejecting the null hypothesis of interest for a given weight and evidence level.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oc_bias">oc_bias</a></code> and <code><a href="#topic+oc_coverage">oc_coverage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n_sims &lt;- 5 # small number for exemplary application
sim_dat &lt;- list(
  "m" = rnorm(n = n_sims, mean = 1.15, sd = 0.1),
  "se" = rnorm(n = n_sims, mean = 1.8, sd = 0.3)
)
results &lt;- oc_pos(
  m = sim_dat[["m"]],
  se = sim_dat[["se"]],
  probs = c(0.025, 0.05, 0.1, 0.2), 
  weights = seq(0, 1, by = 0.01), 
  map_prior = load_tipmap_data("tipmapPrior.rds"), 
  sigma = 16.23,
  null_effect = 0,
  direction_pos = TRUE, 
  eval_strategy = "sequential",
  n_cores = 1
) 
print(results)
</code></pre>

<hr>
<h2 id='tipmap_darkblue'>Custom dark blue</h2><span id='topic+tipmap_darkblue'></span>

<h3>Description</h3>

<p>Custom dark blue
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tipmap_darkblue
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 1.
</p>

<hr>
<h2 id='tipmap_lightred'>Custom light red</h2><span id='topic+tipmap_lightred'></span>

<h3>Description</h3>

<p>Custom light red
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tipmap_lightred
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 1.
</p>

<hr>
<h2 id='tipmap_plot'>Visualize tipping point analysis</h2><span id='topic+tipmap_plot'></span>

<h3>Description</h3>

<p>Uses a data frame created by <code>create_tipmap_data()</code> to visualize the tipping point analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tipmap_plot(
  tipmap_data,
  target_pop_lab = "Trial in target\n population",
  y_range = NULL,
  y_breaks = NULL,
  title = NULL,
  y_lab = "Mean difference",
  x_lab = "Weight on informative component of MAP prior",
  map_prior_lab = "MAP\nprior",
  meta_analysis_lab = "MA",
  legend_title = "Posterior quantile",
  null_effect = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tipmap_plot_+3A_tipmap_data">tipmap_data</code></td>
<td>
<p>A data frame containing tipping point data, generated by <code>create_tipmap_data()</code>.</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_target_pop_lab">target_pop_lab</code></td>
<td>
<p>A label for the trial in the target population.</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_y_range">y_range</code></td>
<td>
<p>An optional argument specifying range of the y-axis.</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_y_breaks">y_breaks</code></td>
<td>
<p>An optional vector specifying breaks on the y-axis.</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_title">title</code></td>
<td>
<p>The plot title.</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_y_lab">y_lab</code></td>
<td>
<p>The label for the y axis. Defaults to &quot;Mean difference&quot;.</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_x_lab">x_lab</code></td>
<td>
<p>The label for the x axis. Defaults to &quot;Weight on informative component of MAP prior&quot;.</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_map_prior_lab">map_prior_lab</code></td>
<td>
<p>The label for the MAP prior. Defaults to &quot;MAP prior&quot;</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_meta_analysis_lab">meta_analysis_lab</code></td>
<td>
<p>An optional label for a meta-analysis (if included).</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_legend_title">legend_title</code></td>
<td>
<p>An optional title for the plot legend. Defaults to &quot;Posterior quantiles&quot;.</p>
</td></tr>
<tr><td><code id="tipmap_plot_+3A_null_effect">null_effect</code></td>
<td>
<p>The null treatment effect, determining where tipping points are calculated. Defaults to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object of the tipping point plot
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_tipmap_data">create_tipmap_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tipmap_data &lt;- load_tipmap_data("tipdat.rds")
tipmap_plot(tipmap_data)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
