<!DOCTYPE html><html><head><title>Help for package Rata</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rata}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ata'><p>Automated Test Assembly (ATA)</p></a></li>
<li><a href='#ata_glpk'><p>Helper functions for ATA</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Automated Test Assembly</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-10-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiao Luo [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiao Luo &lt;xluo1986@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Automated test assembly of linear and adaptive tests using the 
    mixed-integer programming. The full documentation and tutorials are at 
    <a href="https://github.com/xluo11/Rata">https://github.com/xluo11/Rata</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/xluo11/Rata">https://github.com/xluo11/Rata</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/xluo11/Rata/issues">https://github.com/xluo11/Rata/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, glpkAPI, lpSolveAPI, Rirt, reshape2, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-23 18:28:11 UTC; Luo.Xiao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-24 05:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ata'>Automated Test Assembly (ATA)</h2><span id='topic+ata'></span><span id='topic+ata_relative_objective'></span><span id='topic+ata_absolute_objective'></span><span id='topic+ata_constraint'></span><span id='topic+ata_item_use'></span><span id='topic+ata_item_enemy'></span><span id='topic+ata_item_fix'></span><span id='topic+ata_solve'></span><span id='topic+print.ata'></span><span id='topic+plot.ata'></span>

<h3>Description</h3>

<p><code>ata</code> creates a basic ATA model
</p>
<p><code>ata_relative_objective</code> adds a relative objective to the model
</p>
<p><code>ata_absolute_objective</code> adds an absolute objective to the model
</p>
<p><code>ata_constraint</code> adds a constraint to the model
</p>
<p><code>ata_item_use</code> limits the minimum and maximum usage for items
</p>
<p><code>ata_item_enemy</code> adds an enemy-item constraint to the model
</p>
<p><code>ata_item_fix</code> forces an item to be selected or not selected
</p>
<p><code>ata_solve</code> solves the MIP model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ata(pool, n_forms = 1, test_len = NULL, max_use = NULL, ...)

ata_relative_objective(x, coef, mode = c("max", "min"), tol = NULL,
  negative = FALSE, forms = NULL, collapse = FALSE,
  internal_index = FALSE)

ata_absolute_objective(x, coef, target, equal_tol = FALSE,
  tol_up = NULL, tol_down = NULL, forms = NULL, collapse = FALSE,
  internal_index = FALSE)

ata_constraint(x, coef, min = NA, max = NA, level = NULL,
  forms = NULL, collapse = FALSE, internal_index = FALSE)

ata_item_use(x, min = NA, max = NA, items = NULL)

ata_item_enemy(x, items)

ata_item_fix(x, items, min = NA, max = NA, forms)

ata_solve(x, solver = c("lpsolve", "glpk"), return_format = c("model",
  "form", "simple"), silent = FALSE, time_limit = 10,
  message = FALSE, ...)

## S3 method for class 'ata'
print(x, ...)

## S3 method for class 'ata'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ata_+3A_pool">pool</code></td>
<td>
<p>the item pool(s), a list of '3pl', 'gpcm', and 'grm' items</p>
</td></tr>
<tr><td><code id="ata_+3A_n_forms">n_forms</code></td>
<td>
<p>the number of forms to be assembled</p>
</td></tr>
<tr><td><code id="ata_+3A_test_len">test_len</code></td>
<td>
<p>test length of each form</p>
</td></tr>
<tr><td><code id="ata_+3A_max_use">max_use</code></td>
<td>
<p>maximum use of each item</p>
</td></tr>
<tr><td><code id="ata_+3A_...">...</code></td>
<td>
<p>options, e.g. group, common_items, overlap_items</p>
</td></tr>
<tr><td><code id="ata_+3A_x">x</code></td>
<td>
<p>an ATA object</p>
</td></tr>
<tr><td><code id="ata_+3A_coef">coef</code></td>
<td>
<p>the coefficients of the objective function</p>
</td></tr>
<tr><td><code id="ata_+3A_mode">mode</code></td>
<td>
<p>optimization direction: 'max' for maximization and 'min' for minimization</p>
</td></tr>
<tr><td><code id="ata_+3A_tol">tol</code></td>
<td>
<p>the tolerance paraemter</p>
</td></tr>
<tr><td><code id="ata_+3A_negative">negative</code></td>
<td>
<p><code>TRUE</code> when the objective function is expected to be negative</p>
</td></tr>
<tr><td><code id="ata_+3A_forms">forms</code></td>
<td>
<p>forms where objectives are added. <code>NULL</code> for all forms</p>
</td></tr>
<tr><td><code id="ata_+3A_collapse">collapse</code></td>
<td>
<p><code>TRUE</code> to collapse into one objective function</p>
</td></tr>
<tr><td><code id="ata_+3A_internal_index">internal_index</code></td>
<td>
<p><code>TRUE</code> to use internal form indices</p>
</td></tr>
<tr><td><code id="ata_+3A_target">target</code></td>
<td>
<p>the target values of the objective function</p>
</td></tr>
<tr><td><code id="ata_+3A_equal_tol">equal_tol</code></td>
<td>
<p><code>TRUE</code> to force upward and downward tolerance to be equal</p>
</td></tr>
<tr><td><code id="ata_+3A_tol_up">tol_up</code></td>
<td>
<p>the range of upward tolerance</p>
</td></tr>
<tr><td><code id="ata_+3A_tol_down">tol_down</code></td>
<td>
<p>the range of downward tolerance</p>
</td></tr>
<tr><td><code id="ata_+3A_min">min</code></td>
<td>
<p>the lower bound of the constraint</p>
</td></tr>
<tr><td><code id="ata_+3A_max">max</code></td>
<td>
<p>the upper bound of the constraint</p>
</td></tr>
<tr><td><code id="ata_+3A_level">level</code></td>
<td>
<p>the level of a categorical variable to be constrained</p>
</td></tr>
<tr><td><code id="ata_+3A_items">items</code></td>
<td>
<p>a vector of item indices, <code>NULL</code> for all items</p>
</td></tr>
<tr><td><code id="ata_+3A_solver">solver</code></td>
<td>
<p>use 'lpsolve' for lp_solve 5.5 or 'glpk' for GLPK</p>
</td></tr>
<tr><td><code id="ata_+3A_return_format">return_format</code></td>
<td>
<p>the format of the results: use <code>'form'</code> to organize results in a list of forms,
<code>'model'</code> to organize results in a list of models, use <code>'simple'</code> to organize results in
data.frame after removing item paraemters.</p>
</td></tr>
<tr><td><code id="ata_+3A_silent">silent</code></td>
<td>
<p><code>TRUE</code> to mute solution information</p>
</td></tr>
<tr><td><code id="ata_+3A_time_limit">time_limit</code></td>
<td>
<p>the time limit in seconds passed along to solvers</p>
</td></tr>
<tr><td><code id="ata_+3A_message">message</code></td>
<td>
<p><code>TRUE</code> to print messages from solvers</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ATA model stores the definitions of a MIP model. When <code>ata_solve</code>
is called, a real MIP object is created from the definitions.
</p>
<p><code>ata_obj_relative</code>:
when mode='max', maximize (y-tol), subject to y &lt;= sum(x) &lt;= y+tol;
when mode='min', minimize (y+tol), subject to y-tol &lt;= sum(x) &lt;= y.
When <code>negative</code> is <code>TRUE</code>, y &lt; 0, tol &gt; 0.
<code>coef</code> can be a numeric vector that has the same length with the pool,
or a variable name in the pool, or a numeric vector of theta points.
When <code>tol</code> is <code>NULL</code>, it is optimized; when it's <code>FALSE</code>, ignored;
when it's a number, fixed; when it's a range, constrained with lower and upper bounds.
</p>
<p><code>ata_obj_absolute</code> minimizes y0+y1 subject to t-y0 &lt;= sum(x) &lt;= t+y1.
</p>
<p>When <code>level</code> is <code>NA</code>, it is assumed that the constraint is on
a quantitative item property; otherwise, a categorical item property.
<code>coef</code> can be a variable name, a constant, or a numeric vector that has
the same size as the pool.
</p>
<p><code>ata_solve</code> takes control options in <code>...</code>.
For lpsolve, see <code>lpSolveAPI::lp.control.options</code>.
For glpk, see <code>glpkAPI::glpkConstants</code><br />
Once the model is solved, additional data are added to the model.
<code>status</code> shows the status of the solution, <code>optimum</code>
the optimal value of the objective fucntion found in the solution,
<code>obj_vars</code> the values of two critical variables in the objective
function, <code>result</code> the assembly results in a binary matrix, and
<code>items</code> the assembled items
</p>


<h3>Value</h3>

<p><code>ata</code> returns a <code>ata</code> object
</p>
<p><code>ata_solve</code> returns a solved <code>ata</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate a pool of 100 items
library(Rirt)
n_items &lt;- 100
pool &lt;- with(model_3pl_gendata(1, n_items), data.frame(id=1:n_items, a=a, b=b, c=c))
pool$content &lt;- sample(1:3, n_items, replace=TRUE)
pool$time &lt;- round(rlnorm(n_items, log(60), .2))
pool$group &lt;- sort(sample(1:round(n_items/3), n_items, replace=TRUE))
pool &lt;- list('3pl'=pool)

## ex. 1: four 10-item forms, maximize b parameter
x &lt;- ata(pool, 4, test_len=10, max_use=1)
x &lt;- ata_relative_objective(x, "b", "max")
x &lt;- ata_solve(x, time_limit=2)
with(x$items$'3pl', aggregate(b, by=list(form=form), mean))
with(x$items$'3pl', table(form))


## ex. 2: four 10-item forms, minimize b parameter
x &lt;- ata(pool, 4, test_len=10, max_use=1)
x &lt;- ata_relative_objective(x, "b", "min", negative=TRUE)
x &lt;- ata_solve(x, time_limit=5)
with(x$items$'3pl', aggregate(b, by=list(form=form), mean))
with(x$items$'3pl', table(form))

## ex. 3: two 10-item forms, mean(b)=0, sd(b)=1
## content = (3, 3, 4), avg. time = 55--65 seconds
constr &lt;- data.frame(name='content',level=1:3, min=c(3,3,4), max=c(3,3,4), stringsAsFactors=FALSE)
constr &lt;- rbind(constr, c('time', NA, 55*10, 65*10))
x &lt;- ata(pool, 2, test_len=10, max_use=1)
x &lt;- ata_absolute_objective(x, pool$'3pl'$b, target=0*10)
x &lt;- ata_absolute_objective(x, (pool$'3pl'$b-0)^2, target=1*10)
for(i in 1:nrow(constr))
  x &lt;- with(constr, ata_constraint(x, name[i], min[i], max[i], level=level[i]))
x &lt;- ata_solve(x)
with(x$items$'3pl', aggregate(b, by=list(form=form), mean))
with(x$items$'3pl', aggregate(b, by=list(form=form), sd))
with(x$items$'3pl', aggregate(time, by=list(form=form), mean))
with(x$items$'3pl', aggregate(content, by=list(form=form), function(x) freq(x, 1:3)$freq))

## ex. 4: two 10-item forms, max TIF over (-1, 1), consider item sets
x &lt;- ata(pool, 2, test_len=10, max_use=1, group="group")
x &lt;- ata_relative_objective(x, seq(-1, 1, .5), 'max')
x &lt;- ata_solve(x, time_limit=5)
plot(x)

</code></pre>

<hr>
<h2 id='ata_glpk'>Helper functions for ATA</h2><span id='topic+ata_glpk'></span><span id='topic+helpers'></span><span id='topic+ata_check_item_pool'></span><span id='topic+ata_item_set_groups'></span><span id='topic+ata_form_map'></span><span id='topic+ata_get_form_index'></span><span id='topic+ata_get_obj_coef'></span><span id='topic+ata_append'></span><span id='topic+ata_extract_items'></span><span id='topic+ata_results_to_model'></span><span id='topic+ata_results_to_dataframe'></span><span id='topic+ata_lpsolve'></span>

<h3>Description</h3>

<p><code>ata_glpk</code> solves the the MIP model using GLPK
</p>
<p>helper functions for ATA
</p>
<p><code>ata_check_item_pool</code> checks the input of the item pool
</p>
<p><code>ata_item_set_groups</code> creates grouping indices for item sets
</p>
<p><code>ata_form_map</code> creates a map of external and internal forms
</p>
<p><code>ata_get_form_index</code> finds the internal form indices for the form input
</p>
<p><code>ata_get_obj_coef</code> finds real coefficients for the coefficient input
</p>
<p><code>ata_append</code> appends constraints to the ATA model
</p>
<p><code>x</code> retrieves items from the result matrix
</p>
<p><code>ata_results_to_model</code> converts results from the 'by-form' format to the 'by-model' format
</p>
<p><code>ata_results_to_dataframe</code> converts results from the 'by-model' format to the 'data.frame' format
</p>
<p><code>ata_lpsolve</code> solves the the MIP model using lp_solve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ata_glpk(x, time_limit, message, ...)

ata_check_item_pool(pool)

ata_item_set_groups(pool, opts)

ata_form_map(n_forms, opts)

ata_get_form_index(x, forms, collapse, internal_index)

ata_get_obj_coef(x, coef, compensate)

ata_append(x, mat, dir, rhs)

ata_extract_items(x)

ata_results_to_model(items)

ata_results_to_dataframe(items)

ata_lpsolve(x, time_limit, message, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ata_glpk_+3A_x">x</code></td>
<td>
<p>an ATA object</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_time_limit">time_limit</code></td>
<td>
<p>the time limit in seconds passed along to the solver</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_message">message</code></td>
<td>
<p><code>TRUE</code> to print messages from the solver</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_...">...</code></td>
<td>
<p>additional control parameters for the solver</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_pool">pool</code></td>
<td>
<p>the item pool, a list of 3pl, gpcm, and grm items</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_opts">opts</code></td>
<td>
<p>the options, a list</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_n_forms">n_forms</code></td>
<td>
<p>the nubmer of forms to be assembled</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_forms">forms</code></td>
<td>
<p>form indices</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_collapse">collapse</code></td>
<td>
<p><code>TRUE</code> to collaspe forms into one form</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_internal_index">internal_index</code></td>
<td>
<p><code>TRUE</code> to use internal form index</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_coef">coef</code></td>
<td>
<p>coefficients</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_compensate">compensate</code></td>
<td>
<p><code>TRUE</code> to combine coefficients</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_mat">mat</code></td>
<td>
<p>coefficient matrix</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_dir">dir</code></td>
<td>
<p>direction</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_rhs">rhs</code></td>
<td>
<p>right-hand-side value</p>
</td></tr>
<tr><td><code id="ata_glpk_+3A_items">items</code></td>
<td>
<p>the assembled items</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
