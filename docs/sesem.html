<!DOCTYPE html><html><head><title>Help for package sesem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sesem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#sesem-package'>
<p>Spatial structural equation modeling (SESEM)</p></a></li>
<li><a href='#alexfiord'><p>Alexandra Fiord transect dataset</p></a></li>
<li><a href='#avg.modindices'>
<p>Function to display averaged modification indices for a spatial SEM</p></a></li>
<li><a href='#bin.results'>
<p>Extract results for a particular bin</p></a></li>
<li><a href='#bin.rsquare'>
<p>Extract r-square values for dependant variables a spatial SEM for a particular lag distance bin</p></a></li>
<li><a href='#calc.dist'>
<p>Calculate intersample distances for a set of X-Y coordinates</p></a></li>
<li><a href='#gam.path'>
<p>Prints and displays spatial sem results using gam models</p></a></li>
<li><a href='#make.bin'>
<p>Function to make lag distance bins</p></a></li>
<li><a href='#make.covar'>
<p>Function to calculate covariance matrices for a set of lag distance bins</p></a></li>
<li><a href='#modelsummary'>
<p>Function to extract and display basic summary information for a spatial SEM analysis</p></a></li>
<li><a href='#plantcomp'><p>Plant Competition dataset</p></a></li>
<li><a href='#plotbin'>
<p>Function to plot the distribution of lag distance bin sizes</p></a></li>
<li><a href='#plotmodelfit'>
<p>Function to plot model fit indices for spatial SEM analyses</p></a></li>
<li><a href='#plotpath'>
<p>Function to plot spatial SEM results for individual paths</p></a></li>
<li><a href='#runModels'>
<p>Run a spatial SEM analysis</p></a></li>
<li><a href='#truelove'><p>Truelove lowland transect dataset</p></a></li>
<li><a href='#truelove_covar'><p>Truelove lowland example covariances</p></a></li>
<li><a href='#truelove_results'><p>Truelove lowland example sesem output</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatially Explicit Structural Equation Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-06-09</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Lamb &lt;eric.lamb@usask.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Structural equation modeling is a powerful statistical approach for the testing of networks of direct and indirect theoretical causal relationships in complex data sets with inter-correlated dependent and independent variables. Here we implement a simple method for spatially explicit structural equation modeling based on the analysis of variance co-variance matrices calculated across a range of lag distances. This method provides readily interpreted plots of the change in path coefficients across scale.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.8.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lavaan, mgcv, gplots</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.r-project.org">http://www.r-project.org</a>,
<a href="http://homepage.usask.ca/~egl388/index.html">http://homepage.usask.ca/~egl388/index.html</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-06-10 17:29:33 UTC; Eric Lamb</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Lamb [aut, cre],
  Kerrie Mengersen [aut],
  Katherine Stewart [aut],
  Udayanga Attanayake [aut],
  Steven Siciliano [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-06-10 23:12:40</td>
</tr>
</table>
<hr>
<h2 id='sesem-package'>
Spatial structural equation modeling (SESEM)
</h2><span id='topic+sesem-package'></span><span id='topic+sesem'></span>

<h3>Description</h3>

<p>Structural equation modeling (SEM) is a powerful statistical approach for the testing of networks of direct and indirect theoretical causal relationships in complex datasets with intercorrelated dependent and independent variables. Here we implement a simple method for spatially explicit SEM (SE-SEM) based on the analysis of variance covariance matrices calculated across a range of lag distances. This method provides readily interpretable plots of the change in path coefficients across scale.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> sesem</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-06-09</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Package sesem allows spatially explicit structural equation modeling. It allows a structural equation model to be fit to a number of spatially explicit covariance matrices to explore how the strength of structural path coefficients changes with scale. In brief an SESEM analysis involves:
calculating pairwise differences among samples
selecting a series of lag distance bins
generating spatially explicit variance - covariance matrices for each lag distance bin
fitting a structural equation model to each of those bins
comparing and examining how the strength of path coefficients change with scale
</p>


<h3>Author(s)</h3>

<p>Eric G. Lamb, Kerrie Mengersen, Katherine J. Stewart, Udayanga Attanayake, and Steven D. Siciliano
</p>
<p>Maintainer: Eric Lamb &lt;eric.lamb@usask.ca&gt;
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>
<p>Rosseel, Y. 2012 lavaan: an R package for structural equation modeling. <em>Journal of Statistical Software</em> <b>48</b>:1-36.
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="lavaan.html#topic+lavaan">lavaan</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=truelove
truelove_red&lt;-truelove[c(1:60),c(1:7)]
distancematrix&lt;-calc.dist(truelove_red)
Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=10)
binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

plotbin(distancematrix,binsize)

covariances&lt;-make.covar(truelove_red,distancematrix,binsize,binname)
covariances

# reduced path model for the truelove dataset

spatial_model&lt;-'
	N_Fix ~ Bryoph + Lich + SoilCrust
	SoilCrust ~ Bryoph + Lich	
	Lich ~ Bryoph + Moisture
	Bryoph ~ Moisture
	'

results&lt;-runModels(spatial_model,covariances)
modelsummary(results)
plotmodelfit(results)
plotpath(results)

</code></pre>

<hr>
<h2 id='alexfiord'>Alexandra Fiord transect dataset</h2><span id='topic+alexfiord'></span>

<h3>Description</h3>

<p>This dataset summarizes ground cover and nitrogen fixation activity along
a 93 point variably spaced transect at Alexandra Fiord, Ellesmere Island, 
Nunavut, Canada.
</p>


<h3>Format</h3>

<p>A data frame with 93 rows and 10 variables.</p>


<h3>Details</h3>

<p>Variables are: X, Y, Moisture, N_Fix, SoilCrust, Bryoph, 
Lich, Forbs, Gram, Shrubs
</p>


<h3>Source</h3>

<p>Stewart, K. J., E. G. Lamb, D. S. Coxon, and S. D. Siciliano. 2011b. Bryophyte-cyanobacterial associations as a key factor in N2-fixation across the Canadian Arctic. <em>Plant and Soil</em> <b> 344</b>:335-346.
</p>

<hr>
<h2 id='avg.modindices'>
Function to display averaged modification indices for a spatial SEM
</h2><span id='topic+avg.modindices'></span>

<h3>Description</h3>

<p>Modification indices averaged across all lag distance bins (the non-spatial bin is not included) are calculated for each potential path addition to the structural model. Option modcut suppresses the printing of modification indices of less than that value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>avg.modindices(spatial_model_results, modcut = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="avg.modindices_+3A_spatial_model_results">spatial_model_results</code></td>
<td>

<p>a list object produced by function runModels
</p>
</td></tr>
<tr><td><code id="avg.modindices_+3A_modcut">modcut</code></td>
<td>

<p>The minimum averaged modification index to print. Default is 4. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>
<p>Rosseel, Y. 2012 lavaan: an R package for structural equation modeling. <em>Journal of Statistical Software</em> <b>48</b>:1-36.
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="#topic+modelsummary">modelsummary</a></code>, <code><a href="#topic+runModels">runModels</a></code>, <code><a href="#topic+plotmodelfit">plotmodelfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data=truelove
#distancematrix&lt;-calc.dist(truelove)
#Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)
#binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
#binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

#covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)
#covariances

# path model for the truelove dataset
#spatial_model&lt;-'
#	Gram ~ Moisture
#	N_Fix ~ Bryoph + Lich + SoilCrust
#	SoilCrust ~ Bryoph + Lich + Gram + Shrubs + Forbs	
#	Bryoph ~ Gram + Shrubs + Forbs + Moisture
#	Lich ~ Moisture + Forbs + Gram + Shrubs + Bryoph
#	Forbs ~ Moisture
#	Gram ~~ Forbs
#	Shrubs ~ Moisture	
#	Gram ~~ Shrubs
#	Shrubs ~~ Forbs
#	'
#
#results&lt;-runModels(spatial_model,covariances)

#The above script produces the sesem object stored as truelove_results

data=truelove_results

modelsummary(truelove_results)
avg.modindices(truelove_results)
avg.modindices(truelove_results,modcut=10)
</code></pre>

<hr>
<h2 id='bin.results'>
Extract results for a particular bin</h2><span id='topic+bin.results'></span>

<h3>Description</h3>

<p>Function to extract path coefficients, standard errors, and standardized coefficients for a particular bin in a readable format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin.results(spatial_model_results, bin = "binflat")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin.results_+3A_spatial_model_results">spatial_model_results</code></td>
<td>

<p>a list object produced by function run.Models
</p>
</td></tr>
<tr><td><code id="bin.results_+3A_bin">bin</code></td>
<td>

<p>Name of the bin that results are desired for. Defaults to flat model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a spatial SEM object produced by runModels, bin.results allows the results for a particular lag distance bin to be inspected in a readable format.
</p>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+runModels">runModels</a></code>, <code><a href="#topic+modelsummary">modelsummary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#data=truelove
#distancematrix&lt;-calc.dist(truelove)
#Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)
#binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
#binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

#covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)
#covariances

# path model for the truelove dataset
#spatial_model&lt;-'
#	Gram ~ Moisture
#	N_Fix ~ Bryoph + Lich + SoilCrust
#	SoilCrust ~ Bryoph + Lich + Gram + Shrubs + Forbs	
#	Bryoph ~ Gram + Shrubs + Forbs + Moisture
#	Lich ~ Moisture + Forbs + Gram + Shrubs + Bryoph
#	Forbs ~ Moisture
#	Gram ~~ Forbs
#	Shrubs ~ Moisture	
#	Gram ~~ Shrubs
#	Shrubs ~~ Forbs
#	'
#
#results&lt;-runModels(spatial_model,covariances)

#The above script produces the sesem object stored as truelove_results

data=truelove_results

bin.results(truelove_results)
bin.results(truelove_results,bin="Bin2")
</code></pre>

<hr>
<h2 id='bin.rsquare'>
Extract r-square values for dependant variables a spatial SEM for a particular lag distance bin
</h2><span id='topic+bin.rsquare'></span>

<h3>Description</h3>

<p>extracts rsquare values from for dependent variables in a spatial SEM object for a particular lag distance bin in a readable format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin.rsquare(spatial_model_results, bin = "binflat")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin.rsquare_+3A_spatial_model_results">spatial_model_results</code></td>
<td>

<p>a list object produced by function run.Models
</p>
</td></tr>
<tr><td><code id="bin.rsquare_+3A_bin">bin</code></td>
<td>

<p>Name of the bin that results are desired for. Defaults to flat (nonspatial) model
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+runModels">runModels</a></code>, <code><a href="#topic+modelsummary">modelsummary</a></code>, <code><a href="#topic+bin.results">bin.results</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data=truelove
#distancematrix&lt;-calc.dist(truelove)
#Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)
#binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
#binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

#covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)
#covariances

# path model for the truelove dataset
#spatial_model&lt;-'
#	Gram ~ Moisture
#	N_Fix ~ Bryoph + Lich + SoilCrust
#	SoilCrust ~ Bryoph + Lich + Gram + Shrubs + Forbs	
#	Bryoph ~ Gram + Shrubs + Forbs + Moisture
#	Lich ~ Moisture + Forbs + Gram + Shrubs + Bryoph
#	Forbs ~ Moisture
#	Gram ~~ Forbs
#	Shrubs ~ Moisture	
#	Gram ~~ Shrubs
#	Shrubs ~~ Forbs
#	'
#
#results&lt;-runModels(spatial_model,covariances)

#The above script produces the sesem object stored as truelove_results

data=truelove_results

bin.rsquare(truelove_results)
bin.rsquare(truelove_results,bin="Bin2")
</code></pre>

<hr>
<h2 id='calc.dist'>
Calculate intersample distances for a set of X-Y coordinates
</h2><span id='topic+calc.dist'></span>

<h3>Description</h3>

<p>calc.dist calculates and stores the distance matrix for all X-Y pairs. It works on a dataset where the first two columns are x and y coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.dist(datafile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc.dist_+3A_datafile">datafile</code></td>
<td>

<p>a dataset where the first two columns are x and y coordinates. Further columns can contain observed variables for subsequent modeling; these are ignored here. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>datafile is a dataset where the first two columns are x and y coordinates. If data are distributed on only one dimension (i.e. along a linear transect) one of the columns should contain zeroes.
</p>


<h3>Value</h3>

<p>a vector containing distances between each pair of samples in the input data
</p>


<h3>Author(s)</h3>

<p>Kerrie Mengersen, Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.covar">make.covar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=truelove
distdata&lt;-truelove[c(1:60),]
distances&lt;-calc.dist(distdata)
distances
</code></pre>

<hr>
<h2 id='gam.path'>
Prints and displays spatial sem results using gam models
</h2><span id='topic+gam.path'></span>

<h3>Description</h3>

<p>This function fits generalized additive models (gam) of the path coefficient vs. lag 
distance relationship for each path in the spatial SEM model. Gam functions and figures 
are produced. Requires function mgcv
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gam.path(spatial_model_results, path.type = "directed",selectpath = "none selected", 
	plot.points = T, se.plot = T, lwd.pred = 2, lty.pred = 1, lwd.se = 2, lty.se = 3, 
	cex = 1, cex.axis = 1, cex.lab = 1, xlab = "Lag Distance", 
	ylab = "Unst. Path Coeff.", yaxt = "s", xaxt = "s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gam.path_+3A_spatial_model_results">spatial_model_results</code></td>
<td>

<p>a list object produced by function runModels
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_path.type">path.type</code></td>
<td>

<p>An option to select the paths to be plotted. &quot;directed&quot; = only directed paths plotted; 
&quot;undirected&quot; = only undirected correlations plotted; &quot;both&quot; = all paths plotted; 
&quot;user&quot; = allows user to specify particular paths and a particular order for plotting. 
Argument selectpath must also be provided with path.type=&quot;user&quot;
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_selectpath">selectpath</code></td>
<td>

<p>An option to select specific paths for plotting. Usage is as follows: 
selectpath==c(5,18,16,23,29) where values refer to path numbers. Path numbers 
can be obtained using spatial_model_results[[2]]
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_plot.points">plot.points</code></td>
<td>

<p>Should points for individual models be plotted?
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_se.plot">se.plot</code></td>
<td>

<p>Should standard error lines for each gam model be plotted?
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_lwd.pred">lwd.pred</code></td>
<td>

<p>width of the predicted line from the gam model
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_lty.pred">lty.pred</code></td>
<td>

<p>format of the predicted line from the gam model
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_lwd.se">lwd.se</code></td>
<td>

<p>width of the standard error line
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_lty.se">lty.se</code></td>
<td>

<p>format of the standard error line
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_cex">cex</code></td>
<td>

<p>point size
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_cex.axis">cex.axis</code></td>
<td>

<p>axis font size
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_cex.lab">cex.lab</code></td>
<td>

<p>label font size
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_ylab">ylab</code></td>
<td>

<p>y-axis label
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_yaxt">yaxt</code></td>
<td>

<p>argument to suppress plotting of y-axis if set to &quot;n&quot;
</p>
</td></tr>
<tr><td><code id="gam.path_+3A_xaxt">xaxt</code></td>
<td>

<p>argument to suppress plotting of x-axis if set to &quot;n&quot;
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generalized additive models (gam) allow flexible modeling of nonlinear relationships 
with minimal assumptions about the shape of those relationships. This function 
utilizes the gam fitting function in library mgcv to fit and display gam models of the 
relationships between lag distance and unstandardized path coefficients. This is an 
alternative to the lowess smoothed lines available in function plot.path. Potential 
advantages of the gam models include the ability to obtain predictions for lag distance 
values intermediate between modeled lag distances.
</p>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>
<p>Rosseel, Y. 2012 lavaan: an R package for structural equation modeling. <em>Journal of Statistical Software</em> <b>48</b>:1-36
</p>
<p>Wood, S.N. 2011 Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models. <em>Journal of the Royal Statistical Society (B)</em> <b>73(1)</b>:3-36
</p>
<p>Wood, S.N. 2006 Generalized Additive Models: An Introduction with R. Chapman and Hall/CRC
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="mgcv.html#topic+gam">gam</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+runModels">runModels</a></code>, 
<code><a href="#topic+modelsummary">modelsummary</a></code>, <code><a href="#topic+plotmodelfit">plotmodelfit</a></code>, <code><a href="#topic+plotpath">plotpath</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data=truelove
#distancematrix&lt;-calc.dist(truelove)
#Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)
#binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
#binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

#covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)
#covariances

# path model for the truelove dataset
#spatial_model&lt;-'
#	Gram ~ Moisture
#	N_Fix ~ Bryoph + Lich + SoilCrust
#	SoilCrust ~ Bryoph + Lich + Gram + Shrubs + Forbs	
#	Bryoph ~ Gram + Shrubs + Forbs + Moisture
#	Lich ~ Moisture + Forbs + Gram + Shrubs + Bryoph
#	Forbs ~ Moisture
#	Gram ~~ Forbs
#	Shrubs ~ Moisture	
#	Gram ~~ Shrubs
#	Shrubs ~~ Forbs
#	'
#
#results&lt;-runModels(spatial_model,covariances)

#The above script produces the sesem object stored as truelove_results

data=truelove_results

gam.path(truelove_results)
truelove_results[[2]]# list of path names
gam.path(truelove_results,path.type="user",selectpath=c(5,7,8))
</code></pre>

<hr>
<h2 id='make.bin'>
Function to make lag distance bins
</h2><span id='topic+make.bin'></span>

<h3>Description</h3>

<p>For spatial SEM, lag distance bins need to be described by 2 vectors: binsize and 
binname. make.bin is a function to automatically generate lag distance bins for a 
given dataset. Options to automatically specify bins based on desired within bin sample 
size, or desired number of bins are available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.bin(dist.mat, type = "n.bins", p.dist = 50, n.bins = 10, s.size = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.bin_+3A_dist.mat">dist.mat</code></td>
<td>

<p>a vector containing distances between all X-Y sample pairs in a dataset. 
Produced by function calc.dist
</p>
</td></tr>
<tr><td><code id="make.bin_+3A_type">type</code></td>
<td>

<p>should a particular number of bins be created (&quot;n.bins&quot;), or should bins each contain 
a particular number of sample pairs (&quot;s.size&quot;), or should all possible bins be created 
(&quot;ALL&quot;). Note that &quot;ALL&quot; will only yield sensible results for regular sampling designs.
</p>
</td></tr>
<tr><td><code id="make.bin_+3A_p.dist">p.dist</code></td>
<td>

<p>Inference distance (i.e. upper limit of largest lag distance bin) as a percentage 
of the maximum distance sampled 
</p>
</td></tr>
<tr><td><code id="make.bin_+3A_n.bins">n.bins</code></td>
<td>

<p>number of bins to be generated if type=&quot;n.bins&quot;
</p>
</td></tr>
<tr><td><code id="make.bin_+3A_s.size">s.size</code></td>
<td>

<p>sample size within each bin to be used if type=&quot;s.size&quot;
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>make.bin generates cut off values for lag distance bins and corresponding bin names	The function has three default parameter values available, if user does not want to specify:
</p>
<p>(1) Inference distance as a percentage(p.dist) = 50. This sets the upper limit of the largest bin. Normally lag distances greater than 50
</p>
<p>You can use type=&quot;ALL&quot;,&quot;n.bins&quot; OR &quot;s.size&quot; to control parameter values. ALL will only produce sensible results for regular sampling designs. The function produces a list object containing (1.)binsize and (2.)binname. These two vectors (binsize and binname) will be used by make.covar to calculate variance covariance matrices for each lag distance bin
</p>
<p>Special note: User specified number of lag distance bins OR sample size will be used to calculate initial cutoff value of each lag distance bin. However, if the cutoff point is in between a lag distance bin, real cutoff will apply at the upper margin of the particular bin. Therefore, resulting number of bins are less than or equal AND resulting sample sizes are greater than or equal to the value specified by the user.
</p>


<h3>Value</h3>

<p>a List with two components: 
</p>
<table>
<tr><td><code>comp1</code></td>
<td>
<p>a vector of bin size cutoff distances starting with zero</p>
</td></tr>
<tr><td><code>comp2</code></td>
<td>
<p>a character vector of bin names. This vector has one element 
less than component 1</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Udayanga Attanayake, Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc.dist">calc.dist</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+plotbin">plotbin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data=truelove
distdata&lt;-truelove[c(1:60),]
distances&lt;-calc.dist(distdata)
Truelove_bins&lt;-make.bin(distances,type="ALL") 
#	inference distance=50% AND number of bins=ALL
#	note the need to extract sizes and names from the bin size object 
#	as shown below for use in function make.covar
binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
binsize
binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names
binname

# function make.bin to generate bins with 120 samples each to a maximum inference 
# distance of 20% note the need to extract sizes and names from the bin size object 
# as shown below for use in make.covar

data=plantcomp
distdata&lt;-plantcomp[c(1:60),]
distances&lt;-calc.dist(distdata)
#using subset of plantcomp dataset to cut computation time
Plant_bins&lt;-make.bin(distances,type="s.size",s.size=60,p.dist=20) 
#inference distance=20% AND sample size=120
#	note the need to extract sizes and names from the bin size object 
#	as shown below for use in function make.covar
binsize&lt;-Plant_bins[1][[1]] #plant competition bin sizes
binsize
binname&lt;-Plant_bins[2][[1]] #plant competition bin names
binname

# if manual bin sizes are needed use the following approach. 
# Note that the bin name vector must have one fewer elements than bin size
	
binsize = c(0,1,2,2.2,4,5,8,16,32,64,96,128,160)
binsize
binname=c("Bin1","Bin2","Bin3","Bin4","Bin5","Bin6","Bin7","Bin8",
	"Bin9","Bin10","Bin11","Bin12")
binname
</code></pre>

<hr>
<h2 id='make.covar'>
Function to calculate covariance matrices for a set of lag distance bins
</h2><span id='topic+make.covar'></span>

<h3>Description</h3>

<p>calculates variance covariance matrices for each lag distance bin and for a flat (non-spatial) bin
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.covar(datafile,dist.mat,binsize,binname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.covar_+3A_datafile">datafile</code></td>
<td>

<p>a dataset where the first two columns are x and y coordinates. Further columns contain observed variables for subsequent sesem modeling. 
</p>
</td></tr>
<tr><td><code id="make.covar_+3A_dist.mat">dist.mat</code></td>
<td>

<p>a vector containing distances between all X-Y sample pairs in a dataset. Produced by function calc.dist.
</p>
</td></tr>
<tr><td><code id="make.covar_+3A_binsize">binsize</code></td>
<td>

<p>A vector of bin size cutoff distances starting with zero. Produced using make.bin
</p>
</td></tr>
<tr><td><code id="make.covar_+3A_binname">binname</code></td>
<td>

<p>A character vector of bin names. This vector has one element less than binsize.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates variance-covariance matrices for a series of lag distance bins and for a flat (non-spatial) bin. This function produces a list object with four components: [[1]]bin.summary, [[2]] variable names [[3]] flat covariance matrix, [[4]][,,i] covariance matrices for each bin i. A summary of the bins is printed.
</p>


<h3>Value</h3>

<table>
<tr><td><code>1</code></td>
<td>
<p>A bin summary with colums binname, lower cutoff distance, upper cutoff distance, and sample size</p>
</td></tr>
<tr><td><code>2</code></td>
<td>
<p>A list of observed variable names</p>
</td></tr>
<tr><td><code>3</code></td>
<td>
<p>the flat (non-spatial) variance-covariance matrix</p>
</td></tr>
<tr><td><code>4</code></td>
<td>
<p>contains elements [[4]][,,i] where each i is the variance - covariance matrix for a particular lag distance bin</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kerrie Mengersen, Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.bin">make.bin</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+runModels">runModels</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=truelove
truelove_red&lt;-truelove[c(1:60),c(1:5)]
distancematrix&lt;-calc.dist(truelove_red)

#calc.dist and make.covar can be time consuming to run, 
# therefore only a small dataset utilized here

Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=5)
binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

covariances&lt;-make.covar(truelove_red,distancematrix,binsize,binname)
covariances
</code></pre>

<hr>
<h2 id='modelsummary'>
Function to extract and display basic summary information for a spatial SEM analysis
</h2><span id='topic+modelsummary'></span>

<h3>Description</h3>

<p>extracts basic model summary information from the bin.summary file and the object created by run.Models in a readable format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelsummary(spatial_model_results)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelsummary_+3A_spatial_model_results">spatial_model_results</code></td>
<td>

<p>a list object produced by runModels
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>
<p>Rosseel, Y. 2012 lavaan: an R package for structural equation modeling. <em>Journal of Statistical Software</em> <b>48</b>:1-36.
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+runModels">runModels</a></code>, <code><a href="#topic+plotmodelfit">plotmodelfit</a></code>, <code><a href="#topic+plotpath">plotpath</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data=truelove
#distancematrix&lt;-calc.dist(truelove)
#Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)
#binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
#binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

#covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)
#covariances

# path model for the truelove dataset
#spatial_model&lt;-'
#	Gram ~ Moisture
#	N_Fix ~ Bryoph + Lich + SoilCrust
#	SoilCrust ~ Bryoph + Lich + Gram + Shrubs + Forbs	
#	Bryoph ~ Gram + Shrubs + Forbs + Moisture
#	Lich ~ Moisture + Forbs + Gram + Shrubs + Bryoph
#	Forbs ~ Moisture
#	Gram ~~ Forbs
#	Shrubs ~ Moisture	
#	Gram ~~ Shrubs
#	Shrubs ~~ Forbs
#	'
#
#results&lt;-runModels(spatial_model,covariances)

#The above script produces the sesem object stored as truelove_results

data=truelove_results

modelsummary(truelove_results)
</code></pre>

<hr>
<h2 id='plantcomp'>Plant Competition dataset</h2><span id='topic+plantcomp'></span>

<h3>Description</h3>

<p>This dataset summarizes plant community characteristics, competition
intensity, and topographic features in a mesic grassland in central
Alberta, Canada.
</p>


<h3>Format</h3>

<p>A data frame with 192 rows and 10 variables.</p>


<h3>Details</h3>

<p>Variables are: Easting ,Northing ,Comp.Intensity ,ShootBio ,RootBio ,SpRich ,
SoilMoist ,LightInt ,Topog.Pos ,TotalN 
</p>


<h3>Source</h3>

<p>Lamb, E. G. and J. F. Cahill. 2008. When competition does not matter: grassland diversity and community composition. <em>American Naturalist</em> <b>171</b>:777-787
</p>

<hr>
<h2 id='plotbin'>
Function to plot the distribution of lag distance bin sizes
</h2><span id='topic+plotbin'></span>

<h3>Description</h3>

<p>A convenience function that provides a histogram of distances among of all sample pairs and a plot of sample sizes for each the selected bin size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotbin(dist.mat,binsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotbin_+3A_dist.mat">dist.mat</code></td>
<td>

<p>a vector of x-y distances among all sample pairs as produced by calc.dist
</p>
</td></tr>
<tr><td><code id="plotbin_+3A_binsize">binsize</code></td>
<td>

<p>A vector of bin sizes as produced by make.bin, or of the form c(0,2,3,4,....) where the values are the desired bin cutoffs beginning with zero.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is to assist in visualization of both the distribution of x-y distances in the dataset and sample sizes resulting from the selected lag distance bins. See the help files for calc.dist and make.bin for the inputs to this function.
</p>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.bin">make.bin</a></code>, <code><a href="#topic+calc.dist">calc.dist</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=plantcomp
distancematrix&lt;-calc.dist(plantcomp[c(1:100),])
#using subset of plantcomp dataset to cut computation time
Plant_bins&lt;-make.bin(distancematrix,type="s.size",s.size=200) 
#inference distance=50% AND sample size=200
binsize&lt;-Plant_bins[1][[1]] #plant competition bin sizes

plotbin(distancematrix,binsize)

</code></pre>

<hr>
<h2 id='plotmodelfit'>
Function to plot model fit indices for spatial SEM analyses
</h2><span id='topic+plotmodelfit'></span>

<h3>Description</h3>

<p>A function to plot model fit indices across lag distances. The default is to plot all of the chi square, cfi, rmsea (including confidence intervals), and srmr indices. Horizontal lines indicating significant cutoffs for each index are plotted (chi square p=0.05, cfi=0.9, rmsea=0.05, and srmr=0.08). Options to add trend lines are available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmodelfit(spatial_model_results, plots = "all", add.line = "none", rmsea_err = T, 
     pch = 16, lwd = 2, lty = 1, cex = 1, cex.lab = 1, cex.axis = 1, cex.main = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotmodelfit_+3A_spatial_model_results">spatial_model_results</code></td>
<td>

<p>a list object produced by function runModels
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_plots">plots</code></td>
<td>

<p>Indicates which indices should be plotted. The default &quot;all&quot; produces plots of all of the chi square, cfi, rmsea (including confidence intervals), and srmr indices. plot=&quot;chi&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, or &quot;srmr&quot; will produce only a single plot.
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_add.line">add.line</code></td>
<td>

<p>Indicates whether a trendline should be added connecting the points. The default &quot;none&quot; indicates no line, &quot;step&quot; plots straight line segments between points, and &quot;smooth&quot; plots a smoothed curve fit using function lowess. Smoothed lines do not include the flat model (lag distance zero).
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_rmsea_err">rmsea_err</code></td>
<td>

<p>Should the rmsea index be plotted with confidence intervals? rmsea_err=T is the default, rmsea_err=F will suppress confidence intervals. Note that warnings will likely arise if rmsea_err=T is used and there are confidence intervals of zero. All these warnings indicate is that that particular confidence interval is equal to the estimated value and will not be plotted.
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_pch">pch</code></td>
<td>

<p>plotting symbol
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_lwd">lwd</code></td>
<td>

<p>line width
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_lty">lty</code></td>
<td>

<p>line format
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_cex">cex</code></td>
<td>

<p>symbol size
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_cex.lab">cex.lab</code></td>
<td>

<p>label font size
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_cex.axis">cex.axis</code></td>
<td>

<p>axis label font size
</p>
</td></tr>
<tr><td><code id="plotmodelfit_+3A_cex.main">cex.main</code></td>
<td>

<p>plot title font size
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Warnings may arise from the plotting of the rsmea error bars if rmsea_err=T is used and there are confidence intervals of zero. All these warnings indicate is that that particular confidence interval is equal to the estimated value and will not be plotted.
</p>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+runModels">runModels</a></code>, <code><a href="#topic+modelsummary">modelsummary</a></code>, <code><a href="#topic+avg.modindices">avg.modindices</a></code>, <code><a href="#topic+plotpath">plotpath</a></code>, <code><a href="#topic+gam.path">gam.path</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data=truelove
#distancematrix&lt;-calc.dist(truelove)
#Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)
#binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
#binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

#covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)
#covariances

# path model for the truelove dataset
#spatial_model&lt;-'
#	Gram ~ Moisture
#	N_Fix ~ Bryoph + Lich + SoilCrust
#	SoilCrust ~ Bryoph + Lich + Gram + Shrubs + Forbs	
#	Bryoph ~ Gram + Shrubs + Forbs + Moisture
#	Lich ~ Moisture + Forbs + Gram + Shrubs + Bryoph
#	Forbs ~ Moisture
#	Gram ~~ Forbs
#	Shrubs ~ Moisture	
#	Gram ~~ Shrubs
#	Shrubs ~~ Forbs
#	'
#
#results&lt;-runModels(spatial_model,covariances)

#The above script produces the sesem object stored as truelove_results

data=truelove_results

plotmodelfit(truelove_results) #note that the warnings that arise here can be ignored
plotmodelfit(truelove_results,rmsea_err=FALSE)
plotmodelfit(truelove_results,plots="chi")


</code></pre>

<hr>
<h2 id='plotpath'>
Function to plot spatial SEM results for individual paths
</h2><span id='topic+plotpath'></span>

<h3>Description</h3>

<p>A function to plot unstandardized path coefficients across lag distances. The default is to plot all directed paths with standard error bars, and greyed bars to indicate nonsignificant paths (z&gt;0.05). A range of options are available to change the paths plotted, to add trendlines, and to alter the look of the plots.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotpath(spatial_model_results, path.type = "directed", selectpath = "none selected",
	add.line = "none", add.error = T, pcut = 0.05, pch = 16, 
	lwd = 2, lty = 1,cex.main=1.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotpath_+3A_spatial_model_results">spatial_model_results</code></td>
<td>

<p>a list object produced by function runModels
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_path.type">path.type</code></td>
<td>

<p>An option to select the paths to be plotted. &quot;directed&quot; = only directed paths plotted; &quot;undirected&quot; = only undirected correlations plotted; &quot;both&quot; = all paths plotted; &quot;user&quot; = allows user to specify particular paths and a particular order for plotting. Argument selectpath must also be provided with path.type=&quot;user&quot;
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_selectpath">selectpath</code></td>
<td>

<p>An option to select specific paths for plotting. Usage is as follows: selectpath==c(5,18,16,23,29) where values refer to path numbers. Path numbers can be obtained using spatial_model_results[[2]]
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_add.line">add.line</code></td>
<td>

<p>Options for plotting a fit line. &quot;none&quot; indicates no line; &quot;step&quot; plots straight line segments between points; &quot;smooth&quot; plots a smoothed curve fit using function lowess
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_add.error">add.error</code></td>
<td>

<p>Should standard error bars be added for each path coefficient
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_pcut">pcut</code></td>
<td>

<p>p-value cutoff above which points with non significant p-values are shaded grey. Set pcut=1 to have all points black.
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_pch">pch</code></td>
<td>

<p>Selects plotting symbols
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_lwd">lwd</code></td>
<td>

<p>Sets trendline width
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_lty">lty</code></td>
<td>

<p>Sets trendline format
</p>
</td></tr>
<tr><td><code id="plotpath_+3A_cex.main">cex.main</code></td>
<td>

<p>Sets plot title font
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>
<p>Rosseel, Y. 2012 lavaan: an R package for structural equation modeling. <em>Journal of Statistical Software</em> <b>48</b>:1-36.
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+runModels">runModels</a></code>, <code><a href="#topic+modelsummary">modelsummary</a></code>, <code><a href="#topic+plotmodelfit">plotmodelfit</a></code>, <code><a href="#topic+gam.path">gam.path</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data=truelove
#distancematrix&lt;-calc.dist(truelove)
#Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)
#binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
#binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

#covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)
#covariances

# path model for the truelove dataset
#spatial_model&lt;-'
#	Gram ~ Moisture
#	N_Fix ~ Bryoph + Lich + SoilCrust
#	SoilCrust ~ Bryoph + Lich + Gram + Shrubs + Forbs	
#	Bryoph ~ Gram + Shrubs + Forbs + Moisture
#	Lich ~ Moisture + Forbs + Gram + Shrubs + Bryoph
#	Forbs ~ Moisture
#	Gram ~~ Forbs
#	Shrubs ~ Moisture	
#	Gram ~~ Shrubs
#	Shrubs ~~ Forbs
#	'
#
#results&lt;-runModels(spatial_model,covariances)

#The above script produces the sesem object stored as truelove_results

data=truelove_results

plotpath(truelove_results)
truelove_results[[2]]# list of path names
plotpath(truelove_results,path.type="user",selectpath=c(5,7,8))


</code></pre>

<hr>
<h2 id='runModels'>
Run a spatial SEM analysis
</h2><span id='topic+runModels'></span>

<h3>Description</h3>

<p>Given a path model (spatial_model) specified using lavaan syntax, and a list object containing covariance matrices generated by make.covar, runs an sem model using function sem from the lavaan package for each lag distance bin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runModels(spatial_model,covdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runModels_+3A_spatial_model">spatial_model</code></td>
<td>

<p>a path model specified using lavaan syntax. See the <code><a href="lavaan.html#topic+lavaan">lavaan</a></code> help pages for details.
</p>
</td></tr>
<tr><td><code id="runModels_+3A_covdata">covdata</code></td>
<td>

<p>a list object containing covariance matrices and other descriptors as produced by make.covar
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a path model (spatial_model) specified using lavaan syntax, and a list object containing covariance matrices generated by make.covar, runs an sem model using function sem from the lavaan package for each lag distance bin. Produces a list object containing the model results.
</p>


<h3>Value</h3>

<table>
<tr><td><code>1</code></td>
<td>
<p>a table of model fit estimates for each model. See the lavaan documentation for an explanation of each value.</p>
</td></tr>
<tr><td><code>2</code></td>
<td>
<p>table containing a vector of parameter numbers and a character vector containing the names of the paths included in each model.</p>
</td></tr>
<tr><td><code>3</code></td>
<td>
<p>a table of unstandardized path coefficient estimates for each path in each model</p>
</td></tr>
<tr><td><code>4</code></td>
<td>
<p>standard error of unstandardized path coefficient estimates for each path in each model</p>
</td></tr>
<tr><td><code>5</code></td>
<td>
<p>p-values for each unstandardized path coefficient estimate for each path in each model</p>
</td></tr>
<tr><td><code>6</code></td>
<td>
<p>standardized parameter estimates for each path in each model</p>
</td></tr>
<tr><td><code>7</code></td>
<td>
<p>character vector containing list of names of dependent variables within the models</p>
</td></tr>
<tr><td><code>8</code></td>
<td>
<p>r-square values for each dependent variable in each model</p>
</td></tr>
<tr><td><code>9</code></td>
<td>
<p>names of each path for which there is a modification index value</p>
</td></tr>
<tr><td><code>10</code></td>
<td>
<p>modification index values for each potential path addition for each model</p>
</td></tr>
<tr><td><code>11</code></td>
<td>
<p>a copy of the bin.summary table in the input covdata object</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Should model convergence fail for certain lag bins, those bins will be skipped and no results written.
</p>


<h3>Author(s)</h3>

<p>Eric Lamb
</p>


<h3>References</h3>

<p>Lamb, E. G., K. Mengersen, K. J. Stewart, U. Attanayake, and S. D. Siciliano. 2014. Spatially explicit structural equation modeling. <em>Ecology</em> <b>95</b>:2434-2442.
</p>
<p>Rosseel, Y. 2012 lavaan: an R package for structural equation modeling. <em>Journal of Statistical Software</em> <b>48</b>:1-36.
</p>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+sem">sem</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+modelsummary">modelsummary</a></code>, <code><a href="#topic+plotmodelfit">plotmodelfit</a></code>, <code><a href="#topic+plotpath">plotpath</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data=truelove
truelove_red&lt;-truelove[c(1:60),c(1:7)]
distancematrix&lt;-calc.dist(truelove_red)
Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=10)
binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes
binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names

plotbin(distancematrix,binsize)

covariances&lt;-make.covar(truelove_red,distancematrix,binsize,binname)
covariances

# reduced path model for the truelove dataset

spatial_model&lt;-'
	N_Fix ~ Bryoph + Lich + SoilCrust
	SoilCrust ~ Bryoph + Lich	
	Lich ~ Bryoph + Moisture
	Bryoph ~ Moisture
	'

results&lt;-runModels(spatial_model,covariances)
plotmodelfit(results,rmsea_err=FALSE)
</code></pre>

<hr>
<h2 id='truelove'>Truelove lowland transect dataset</h2><span id='topic+truelove'></span>

<h3>Description</h3>

<p>This dataset summarizes ground cover and nitrogen fixation activity along
a 129 point regularly spaced transect on Truelove Lowland, Devon Island, Nunavut, Canada.
</p>


<h3>Format</h3>

<p>A data frame with 129 rows and 10 variables.</p>


<h3>Details</h3>

<p>Variables are: X, Y, Moisture, N_Fix, SoilCrust, Bryoph, 
Lich, Forbs, Gram, Shrubs
</p>


<h3>Source</h3>

<p>Stewart, K. J., E. G. Lamb, D. S. Coxon, and S. D. Siciliano. 2011. Bryophyte-cyanobacterial associations as a key factor in N2-fixation across the Canadian Arctic. <em>Plant and Soil</em> <b> 344</b>:335-346.
</p>

<hr>
<h2 id='truelove_covar'>Truelove lowland example covariances</h2><span id='topic+truelove_covar'></span>

<h3>Description</h3>

<p>This list object is an example of the output produced by function <code>make.covar</code>. It was produced by the following script, and is provided to reduce the computation load of some of the examples in this library.
</p>
<p><code>data=truelove</code>
</p>
<p><code>distancematrix&lt;-calc.dist(truelove)</code>
</p>
<p><code>Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)</code>
</p>
<p><code>binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes</code>
</p>
<p><code>binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names</code>
</p>
<p><code>covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)</code>
</p>


<h3>Format</h3>

<p>A list object with covariances for 11 lag distance bins.</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc.dist">calc.dist</a></code>, <code><a href="#topic+make.bin">make.bin</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>
</p>

<hr>
<h2 id='truelove_results'>Truelove lowland example sesem output</h2><span id='topic+truelove_results'></span>

<h3>Description</h3>

<p>This list object is an example of the output produced by function runModels. It was produced by the following script, and is provided to reduce the computation load of some of the examples in this library.
</p>
<p><code>data=truelove</code>
</p>
<p><code>distancematrix&lt;-calc.dist(truelove)</code>
</p>
<p><code>Truelove_bins&lt;-make.bin(distancematrix,type="ALL",p.dist=20)</code>
</p>
<p><code>binsize&lt;-Truelove_bins[1][[1]] #truelove lowland bin sizes</code>
</p>
<p><code>binname&lt;-Truelove_bins[2][[1]] #truelove lowland bin names</code>
</p>
<p><code>covariances&lt;-make.covar(truelove,distancematrix,binsize,binname)</code>
</p>
<p>path model for the truelove dataset:
</p>
<p>spatial_model&lt;-'
</p>
<p>Gram ~ Moisture
</p>
<p>N_Fix ~ Bryoph + Lich + SoilCrust
</p>
<p>SoilCrust ~ Bryoph + Lich + Gram + Shrubs + Forbs
</p>
<p>Bryoph ~ Gram + Shrubs + Forbs + Moisture
</p>
<p>Lich ~ Moisture + Forbs + Gram + Shrubs + Bryoph
</p>
<p>Forbs ~ Moisture
</p>
<p>Gram ~~ Forbs
</p>
<p>Shrubs ~ Moisture	
</p>
<p>Gram ~~ Shrubs
</p>
<p>Shrubs ~~ Forbs'
</p>
<p><code>results&lt;-runModels(spatial_model,covariances)</code>
</p>


<h3>Format</h3>

<p>A list object sesem results for the truelove path model and 11 lag distance bins.</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc.dist">calc.dist</a></code>, <code><a href="#topic+make.bin">make.bin</a></code>, <code><a href="#topic+make.covar">make.covar</a></code>, <code><a href="#topic+runModels">runModels</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
