<!DOCTYPE html><html><head><title>Help for package ImputeRobust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ImputeRobust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ImpGamlssBootstrap'><p>GAMLSS bootstrap method</p></a></li>
<li><a href='#ImpGamlssFit'><p>GAMLSS imputation fit</p></a></li>
<li><a href='#ImputeRobust-package'><p>Multiple Imputation with Generalized Additive Models for Location,</p>
Scale, and Shape</a></li>
<li><a href='#mice.impute.gamlss'><p>Multiple Imputation with Generalized Additive Models for Location,</p>
Scale, and Shape.</a></li>
<li><a href='#ModelCreator'><p>Model creator</p></a></li>
<li><a href='#sample.data'><p>Sample data set with a monotone missing pattern</p></a></li>
<li><a href='#tao'><p>Tropical Atmosphere Ocean (TAO) project data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Multiple Imputation with Generalized Additive Models for
Location Scale and Shape</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-11-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Salfran [aut, cre],
  Martin Spieß [aut, ths]</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides new imputation methods for the 'mice' package based on generalized additive models for location, scale, and shape (GAMLSS) as described in de Jong, van Buuren and Spiess &lt;<a href="https://doi.org/10.1080%2F03610918.2014.911894">doi:10.1080/03610918.2014.911894</a>&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Salfran &lt;danielsalfran@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>gamlss, mice, R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>purrr, extremevalues, gamlss.dist, lattice</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-11-30 11:46:49 UTC; daniel</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-11-30 12:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='ImpGamlssBootstrap'>GAMLSS bootstrap method</h2><span id='topic+ImpGamlssBootstrap'></span>

<h3>Description</h3>

<p>Creates a random generation function for the missing
values with bootstrap sample from the fitted GAMLSS model for the
completely observed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ImpGamlssBootstrap(incomplete.data, fit, R, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ImpGamlssBootstrap_+3A_incomplete.data">incomplete.data</code></td>
<td>
<p>Data frame with missings on one variable.</p>
</td></tr>
<tr><td><code id="ImpGamlssBootstrap_+3A_fit">fit</code></td>
<td>
<p>Random sample generator method.</p>
</td></tr>
<tr><td><code id="ImpGamlssBootstrap_+3A_r">R</code></td>
<td>
<p>Boolean matrix with the response indicator.</p>
</td></tr>
<tr><td><code id="ImpGamlssBootstrap_+3A_...">...</code></td>
<td>
<p>extra arguments for the control of the gamlss fitting
function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a imputation sample generator.
</p>

<hr>
<h2 id='ImpGamlssFit'>GAMLSS imputation fit</h2><span id='topic+ImpGamlssFit'></span>

<h3>Description</h3>

<p>This function takes a data set to fit a gamlss model and
another to predict the expected parameters values. It returns a
function that will generate a vector of random observations for the
predicted parameters. The amount of random observations is the
number of units on the dataset used to get such predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ImpGamlssFit(data, new.data, family, n.ind.par, gam.mod,
  mod.planb = list(type = "pb", par = list(degree = 1, order = 1)),
  n.par.planb = n.ind.par, lin.terms = NULL, n.cyc = 5, bf.cyc = 5,
  cyc = 5, forceNormal = FALSE, trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ImpGamlssFit_+3A_data">data</code></td>
<td>
<p>Completely observed data frame to be used to fit a
gamlss model estimate.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_new.data">new.data</code></td>
<td>
<p>Data frame used to predict the parameter values for
some given right side x-values on the gamlss model.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_family">family</code></td>
<td>
<p>Family to be used for the response variable on the
GAMLSS estimation.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_n.ind.par">n.ind.par</code></td>
<td>
<p>Number of individual parameters to be
fitted. Currently it only allows one or two because of stability
issues for more parameters.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_gam.mod">gam.mod</code></td>
<td>
<p>list with the parameters of the GAMLSS imputation
model.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_mod.planb">mod.planb</code></td>
<td>
<p>list with the parameters of the alternative GAMLSS
imputation model.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_n.par.planb">n.par.planb</code></td>
<td>
<p>number of individual parameters in the
alternative model.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_lin.terms">lin.terms</code></td>
<td>
<p>Character vector specifying which (if any)
predictor variables should enter the model linearly.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_n.cyc">n.cyc</code></td>
<td>
<p>number of cycles of the gamlss algorithm</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_bf.cyc">bf.cyc</code></td>
<td>
<p>number of cycles in the backfitting algorithm</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_cyc">cyc</code></td>
<td>
<p>number of cycles of the fitting algorithm</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_forcenormal">forceNormal</code></td>
<td>
<p>Flag that if set to 'TRUE' will use a normal
family for the gamlss estimation as a last resource.</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_trace">trace</code></td>
<td>
<p>whether to print at each iteration (TRUE) or not
(FALSE)</p>
</td></tr>
<tr><td><code id="ImpGamlssFit_+3A_...">...</code></td>
<td>
<p>extra arguments for the control of the gamlss fitting
function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a method to generate random samples for the fitted
gamlss model using &quot;new.data&quot; as covariates.
</p>

<hr>
<h2 id='ImputeRobust-package'>Multiple Imputation with Generalized Additive Models for Location,
Scale, and Shape</h2><span id='topic+ImputeRobust'></span><span id='topic+ImputeRobust-package'></span>

<h3>Description</h3>

<p>De Jong (2012), De Jong, van Buuren and Spiess (2016) introduced a
new imputation method based on generalized additive models for
location, scale, and shape (Rigby and Stasinopoulos, 2005), which
is a class of univariate regression models, where the assumption of
an exponential family is relaxed and replaced by a general
distribution family. This allows the a more flexible modelling than
standard parametric imputation models of not only the location
(e.g. the mean), but also the scale (e.g. variance), and the
shape (e.g., skewness and kurtosis) of the conditional distribution
of the dependent variable given all other variables.
</p>


<h3>Author(s)</h3>

<p>Daniel Salfran <a href="mailto:daniel.salfran@uni-hamburg.de">daniel.salfran@uni-hamburg.de</a>
</p>
<p>Martin Spiess <a href="mailto:martin.spiess@uni-hamburg.de">martin.spiess@uni-hamburg.de</a>
</p>


<h3>References</h3>

<p>de Jong, R., van Buuren, S. &amp; Spiess, M. (2016)
Multiple Imputation of Predictor Variables Using Generalized
Additive Models. Communications in Statistics &ndash; Simulation and
Computation, 45(3), 968&ndash;985.
</p>
<p>de Jong, Roel. (2012). “Robust Multiple Imputation.” Universität
Hamburg. <a href="http://ediss.sub.uni-hamburg.de/volltexte/2012/5971/">http://ediss.sub.uni-hamburg.de/volltexte/2012/5971/</a>.
</p>
<p>Rigby, R. A., and Stasinopoulos,
D. M. (2005). Generalized Additive Models for Location, Scale and
Shape. Journal of the Royal Statistical Society: Series C
(Applied Statistics) 54 (3): 507–54.
</p>

<hr>
<h2 id='mice.impute.gamlss'>Multiple Imputation with Generalized Additive Models for Location,
Scale, and Shape.</h2><span id='topic+mice.impute.gamlss'></span><span id='topic+mice.impute.gamlssNO'></span><span id='topic+mice.impute.gamlssBI'></span><span id='topic+mice.impute.gamlssJSU'></span><span id='topic+mice.impute.gamlssPO'></span><span id='topic+mice.impute.gamlssTF'></span><span id='topic+mice.impute.gamlssGA'></span><span id='topic+mice.impute.gamlssZIBI'></span><span id='topic+mice.impute.gamlssZIP'></span><span id='topic+fit.gamlss'></span>

<h3>Description</h3>

<p>Imputes univariate missing data using a generalized
model for location, scale and shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mice.impute.gamlss(y, ry, x, family = NO, n.ind.par = 2,
  fitted.gam = NULL, gam.mod = list(type = "pb"), EV = TRUE, ...)

mice.impute.gamlssNO(y, ry, x, fitted.gam = NULL, EV = TRUE, ...)

mice.impute.gamlssBI(y, ry, x, fitted.gam = NULL, EV = TRUE, ...)

mice.impute.gamlssJSU(y, ry, x, fitted.gam = NULL, EV = TRUE, ...)

mice.impute.gamlssPO(y, ry, x, fitted.gam = NULL, EV = TRUE, ...)

mice.impute.gamlssTF(y, ry, x, fitted.gam = NULL, EV = TRUE, ...)

mice.impute.gamlssGA(y, ry, x, fitted.gam = NULL, EV = TRUE, ...)

mice.impute.gamlssZIBI(y, ry, x, fitted.gam = NULL, EV = TRUE, ...)

mice.impute.gamlssZIP(y, ry, x, fitted.gam = NULL, EV = TRUE, ...)

fit.gamlss(y, ry, x, family = NO, n.ind.par = 2, gam.mod = list(type
  = "pb"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mice.impute.gamlss_+3A_y">y</code></td>
<td>
<p>Numeric vector with incomplete data.</p>
</td></tr>
<tr><td><code id="mice.impute.gamlss_+3A_ry">ry</code></td>
<td>
<p>Response pattern of 'y' ('TRUE'=observed,
'FALSE'=missing).</p>
</td></tr>
<tr><td><code id="mice.impute.gamlss_+3A_x">x</code></td>
<td>
<p>Design matrix with 'length(y)' rows and 'p' columns
containing complete covariates.</p>
</td></tr>
<tr><td><code id="mice.impute.gamlss_+3A_family">family</code></td>
<td>
<p>Distribution family to be used by GAMLSS. It defaults
to NO but a range of families can be defined by calling the
corresponding &quot;gamlssFAMILY&quot; method.</p>
</td></tr>
<tr><td><code id="mice.impute.gamlss_+3A_n.ind.par">n.ind.par</code></td>
<td>
<p>Number of parameters from the distribution family
to be individually estimated.</p>
</td></tr>
<tr><td><code id="mice.impute.gamlss_+3A_fitted.gam">fitted.gam</code></td>
<td>
<p>A predefined bootstrap gamlss method returned by
<code>fit.gamlss</code>. Mice by default refits the model with each
imputation. The parameter is here for a future faster modified
mice function.</p>
</td></tr>
<tr><td><code id="mice.impute.gamlss_+3A_gam.mod">gam.mod</code></td>
<td>
<p>list with the parameters of the GAMLSS imputation
model.</p>
</td></tr>
<tr><td><code id="mice.impute.gamlss_+3A_ev">EV</code></td>
<td>
<p>Logical value to determine whether to correct or not
extreme imputed values. This can arise due to too much
flexibility of the gamlss model.</p>
</td></tr>
<tr><td><code id="mice.impute.gamlss_+3A_...">...</code></td>
<td>
<p>extra arguments for the control of the gamlss fitting
function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Imputation of <code>y</code> using generalized additive models
for location, scale, and shape. A model is fitted with the
observed part of the data set. Then a bootstrap sample is
generated and used to refit the model and generate imputations.
</p>
<p>The function <code>fit.gamlss</code> handles the fitting and the
bootstrap and returns a method to generated imputations.
</p>
<p>Being gamlss a flexible non parametric method, there may be
problems with the fitting and imputation depending on the sample
size. The imputation functions try to handle anomalies
automatically, but results should be still inspected.
</p>


<h3>Value</h3>

<p>Numeric vector with imputed values for missing <code>y</code>
values
</p>


<h3>Author(s)</h3>

<p>Daniel Salfran <a href="mailto:daniel.salfran@uni-hamburg.de">daniel.salfran@uni-hamburg.de</a>
</p>


<h3>References</h3>

<p>de Jong, R., van Buuren, S. &amp; Spiess, M. (2016)
Multiple Imputation of Predictor Variables Using Generalized
Additive Models. Communications in Statistics &ndash; Simulation and
Computation, 45(3), 968&ndash;985.
</p>
<p>de Jong, Roel. (2012). “Robust Multiple Imputation.” Universität
Hamburg. <a href="http://ediss.sub.uni-hamburg.de/volltexte/2012/5971/">http://ediss.sub.uni-hamburg.de/volltexte/2012/5971/</a>.
</p>
<p>Rigby, R. A., and Stasinopoulos,
D. M. (2005). Generalized Additive Models for Location, Scale and
Shape. Journal of the Royal Statistical Society: Series C
(Applied Statistics) 54 (3): 507–54.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(lattice)
# Create the imputed data sets

predMat &lt;- matrix(rep(0,25), ncol = 5)
predMat[4,1] &lt;- 1
predMat[4,5] &lt;- 1
predMat[2,1] &lt;- 1
predMat[2,5] &lt;- 1
predMat[2,4] &lt;- 1
predMat[3,1] &lt;- 1
predMat[3,5] &lt;- 1
predMat[3,4] &lt;- 1
predMat[3,2] &lt;- 1
imputed.sets &lt;- mice(sample.data, m = 2,
                     method = c("", "gamlssPO",
                                "gamlss", "gamlssBI", ""),
                     visitSequence = "monotone",
                     predictorMatrix = predMat,
                     maxit = 1, seed = 973,
                     n.cyc = 1, bf.cyc = 1,
                     cyc = 1)

fit &lt;- with(imputed.sets, lm(y ~ X.1 + X.2 + X.3 + X.4))
summary(pool(fit))

stripplot(imputed.sets)

</code></pre>

<hr>
<h2 id='ModelCreator'>Model creator</h2><span id='topic+ModelCreator'></span>

<h3>Description</h3>

<p>This is a helper function to be used within the gamlss
fitting procedure. It creates automatically a formula object for
the variables named a given data frame. The dependent variable is
the one in the first column and the rest are treated as
independent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModelCreator(data, gam.model, lin.terms = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModelCreator_+3A_data">data</code></td>
<td>
<p>Data frame that will provide the named variables.</p>
</td></tr>
<tr><td><code id="ModelCreator_+3A_gam.model">gam.model</code></td>
<td>
<p>List of mode parameter, containing the &quot;type&quot; with
c(&quot;linear&quot;, &quot;cs&quot;, &quot;pb&quot;) as available choices and &quot;par&quot;, an
optional list parameter if the model is not linear.</p>
</td></tr>
<tr><td><code id="ModelCreator_+3A_lin.terms">lin.terms</code></td>
<td>
<p>Specify which predictors should be included
linearly. For example, binary variables can be added directly as
an additive term instead of defining a spline.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a formula object.
</p>

<hr>
<h2 id='sample.data'>Sample data set with a monotone missing pattern</h2><span id='topic+sample.data'></span>

<h3>Description</h3>

<p>A simple data set with monotone missing pattern
</p>


<h3>Format</h3>

<p>A data frame with 200 rows on the following 5 variables
</p>

<dl>
<dt>X.1</dt><dd><p>Numeric variable from a Normal distribution</p>
</dd>
<dt>X.2</dt><dd><p>Count data from a Poisson distribution</p>
</dd>
<dt>X.3</dt><dd><p>Numeric variable from a Normal distribution</p>
</dd>
<dt>X.4</dt><dd><p>Binary variable from a Binomial distribution</p>
</dd>
<dt>y</dt><dd><p>Response variable</p>
</dd>
</dl>


<h3>Details</h3>

<p>Sample data set with four predictors and a dependent variable. A
missing monotone pattern was generated in three predictors to
illustrate the gamlss imputation method.
</p>
<p>For the data generation process a parameter beta equal to
<code>c(1.3, .8, 1.5, 2.5)</code> and a predictor matrix <code>X &lt;-
cbind(X.1, X.2, X.3, X.4)</code> are defined. Then, the sample data set
is created with the model <code>y ~ X.1 + X.2 + X.3 + X.4</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
head(sample.data)

</code></pre>

<hr>
<h2 id='tao'>Tropical Atmosphere Ocean (TAO) project data</h2><span id='topic+tao'></span>

<h3>Description</h3>

<p>A sample from the Tropical Atmosphere Ocean (TAO) project data,
downloaded from the <code>GGOBI</code> project.
</p>


<h3>Format</h3>

<p>A data frame with 736 observations on the following 8 variables.
</p>
 <dl>
<dt>Year</dt><dd><p>a numeric vector</p>
</dd> <dt>Latitude</dt><dd><p>a
numeric vector</p>
</dd> <dt>Longitude</dt><dd><p>a numeric vector</p>
</dd>
<dt>Sea.Surface.Temp</dt><dd><p>a numeric vector</p>
</dd> <dt>Air.Temp</dt><dd><p>a
numeric vector</p>
</dd> <dt>Humidity</dt><dd><p>a numeric vector</p>
</dd>
<dt>UWind</dt><dd><p>a numeric vector</p>
</dd> <dt>VWind</dt><dd><p>a numeric
vector</p>
</dd> </dl>


<h3>Details</h3>

<p>All cases recorded for five locations and two time periods.
</p>


<h3>Source</h3>

<p><a href="https://github.com/ggobi/ggobi/blob/master/data/tao.csv">https://github.com/ggobi/ggobi/blob/master/data/tao.csv</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
head(tao)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
