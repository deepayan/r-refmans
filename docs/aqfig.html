<!DOCTYPE html><html><head><title>Help for package aqfig</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aqfig}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aqfig-package'><p>Functions to help draw figures displaying air quality data</p>
and model output</a></li>
<li><a href='#kristen.colors'><p>Sets up a color palette which is particularly appropriate for</p>
use with the scatterplot.density function</a></li>
<li><a href='#ozone1'><p>Daily maximum ozone concentrations</p></a></li>
<li><a href='#ozone2'><p>Daily maximum ozone concentrations</p></a></li>
<li><a href='#plot3d.points'><p>Make 3-D scatterplot (using colored or differently-sized points)</p></a></li>
<li><a href='#ragged.image'><p>Produces a &quot;ragged&quot; image plot</p></a></li>
<li><a href='#scatterplot.density'><p>Use color to show the density of points in a scatterplot</p></a></li>
<li><a href='#vertical.image.legend'><p>Put color bar legend in the right plot margin.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-27</td>
</tr>
<tr>
<td>Title:</td>
<td>Display Air Quality Model Output and Monitoring Data</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, stats, geoR</td>
</tr>
<tr>
<td>Suggests:</td>
<td>maps</td>
</tr>
<tr>
<td>Description:</td>
<td>Display air quality model output and monitoring data using scatterplots, grids, and legends.</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-30 21:15:56 UTC; jenise</td>
</tr>
<tr>
<td>Author:</td>
<td>Jenise Swall [aut, cre],
  Kristen Foley [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jenise Swall &lt;jswall@vcu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-02 06:20:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='aqfig-package'>Functions to help draw figures displaying air quality data
and model output</h2><span id='topic+aqfig-package'></span><span id='topic+aqfig'></span>

<h3>Description</h3>

<p>This package contains several functions to help users draw
figures to display air pollution measurements and air quality model
output.  These include functions to place a color legend to the right
of a plot, to draw a scatterplot with the points' colors or sizes
reflecting the value of a response variable, etc.</p>

<hr>
<h2 id='kristen.colors'>Sets up a color palette which is particularly appropriate for
use with the scatterplot.density function</h2><span id='topic+kristen.colors'></span>

<h3>Description</h3>

<p>This function sets up a color palette with <code>n</code> colors,
with gradually changing hues of grey, purple, blue, green, yellow,
orange, red, and brown (in this order).  This palette is a
particularly good choice for <code><a href="#topic+scatterplot.density">scatterplot.density</a></code>
function, for which it is the default choice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kristen.colors(n=64)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kristen.colors_+3A_n">n</code></td>
<td>
<p>Number of colors to include in palette.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls <code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code> and returns
<code>n</code> colors from this palette.
</p>


<h3>Value</h3>

<p>Returns <code>n</code> colors (in hexadecimal).</p>


<h3>Note</h3>

<p>This function is called by default by the function
<code><a href="#topic+scatterplot.density">scatterplot.density</a></code>, which is included in this
package.</p>


<h3>Author(s)</h3>

<p>Original code was authored by Kristen Foley and included in the
precursor to <code><a href="#topic+scatterplot.density">scatterplot.density</a></code>.  Packaged into a new
function by Jenise Swall.</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code></p>

<hr>
<h2 id='ozone1'>Daily maximum ozone concentrations</h2><span id='topic+ozone1'></span>

<h3>Description</h3>

<p>This data set gives the daily maximum ozone
concentrations (in ppb) observed at a subset of 23 Clean Air
Status and Trends Network (CASTNET) monitoring sites on
August 9, 2004.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>ozone1</code></pre>


<h3>Format</h3>

<p>A file in CSV format containing 23 records.</p>


<h3>Source</h3>

<p>Hourly ozone data at CASTNET sites can be obtained from EPA's
Clean Air Status and Trends Network program at 
http://www.epa.gov/castnet.  Thanks to Steven Howard for his help
collating and summarizing these hourly data.</p>

<hr>
<h2 id='ozone2'>Daily maximum ozone concentrations</h2><span id='topic+ozone2'></span>

<h3>Description</h3>

<p>This data set gives the daily maximum ozone
concentrations (in ppb) observed at a subset of 23 Clean Air
Status and Trends Network (CASTNET) monitoring sites on
August 10, 2004.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>ozone2</code></pre>


<h3>Format</h3>

<p>A file in CSV format containing 23 records.</p>


<h3>Source</h3>

<p>Hourly ozone data at CASTNET sites can be obtained from EPA's
Clean Air Status and Trends Network program at 
http://www.epa.gov/castnet.  Thanks to Steven Howard for his help
collating and summarizing these hourly data.</p>

<hr>
<h2 id='plot3d.points'>Make 3-D scatterplot (using colored or differently-sized points)</h2><span id='topic+plot3d.points'></span>

<h3>Description</h3>

<p>Given a list of points' coordinates and the values
observed at those points, return a scatterplot with points located
as specified by the coordinates and coded by color and/or size to
represnt the observed value at the location.  This code is basically
a wrapper for a call to the function <code><a href="geoR.html#topic+points.geodata">points.geodata</a></code> in
the geoR package.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot3d.points(x, y, z, zlim = range(z, na.rm = TRUE),
   add = FALSE, col = heat.colors(12), xlab, ylab,
   pch = 21, cex.min = 1, cex.max = 1,
   symbol.border.col = "black",
   plt.beyond.zlim = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot3d.points_+3A_x">x</code></td>
<td>
<p>x-coordinates of locations at which response values <code>z</code>
are recorded.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_y">y</code></td>
<td>
<p>y-coordinates of locations at which response values <code>z</code>
are recorded.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_z">z</code></td>
<td>
<p>Response values <code>z</code> observed at locations whose coordinates
are given by (<code>x</code>, <code>y</code>).</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_zlim">zlim</code></td>
<td>
<p>Vector of minimum and maximum values of <code>z</code> to which
to assign the two most extreme colors in the <code>col</code> argument
(col[1] and col[length(col)]).  Default is to use the range of
<code>z</code>.  This is very much like the <code>zlim</code> argument to the
<code><a href="graphics.html#topic+image">image</a></code> function.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_add">add</code></td>
<td>
<p>If FALSE (default), the function will begin a new plot. If
TRUE, adds scatterplot to a pre-existing plot.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_col">col</code></td>
<td>
<p>Color range to use for the scatterplot, with the first
color assigned to zlim[1] and last color assigned to zlim[2].
Default is &ldquo;heat.colors(12)&rdquo;, as it is for <code><a href="graphics.html#topic+image">image</a></code>.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_xlab">xlab</code></td>
<td>
<p>The label for the x-axis.  If not specified by the user,
defaults to the expression the user named as parameter <code>x</code>.
This behavior is similar to that for <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_ylab">ylab</code></td>
<td>
<p>The label for the y-axis.  If not specified by the user,
defaults to the expression the user named as parameter <code>y</code>.
This behavior is similar to that for <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_pch">pch</code></td>
<td>
<p>The point symbol to use.  Possible values are 21, 22, 23,
24, and 25.  This is because <code><a href="geoR.html#topic+points.geodata">points.geodata</a></code>
requires these points, which have outlines around them.  Default is
a circle (&lsquo;pch=21&rsquo;).</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_cex.min">cex.min</code></td>
<td>
<p>Minimum amount to shrink/expand the point symbols.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_cex.max">cex.max</code></td>
<td>
<p>Maximum amount to shrink/expand the point symbols.</p>
</td></tr>
</table>
<p>Parameters <code>cex.min</code> and <code>cex.max</code> control the minimum
and maximum amounts to shrink/expland the points, based on the
value of <code>z</code>.  By default, these are both set to one, which
makes all the points the same size. For more information, see
the help page for <code><a href="geoR.html#topic+points.geodata">points.geodata</a></code>.
</p>
<table>
<tr><td><code id="plot3d.points_+3A_symbol.border.col">symbol.border.col</code></td>
<td>
<p>This controls the color of the border around
the plotting symbol.  By default, it is black.  If a border is not
desired, use &lsquo;symbol.border.col=&ldquo;transparent&rdquo;&rsquo;.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_plt.beyond.zlim">plt.beyond.zlim</code></td>
<td>
<p>IF TRUE, and if <code>zlim</code> is specified by the
user, z values beyond the limits given in <code>zlim</code> are
plotted. Values less than zlim[1] are plotted in the same color as
zlim[1]; values greater than zlim[2] are plotted in the same color as
zlim[2].  If TRUE, and <code>zlim</code> is not specified by the user,
zlim[1] and zlim[2] will be assigned the minimum and maximum values of
<code>z</code>.  In this case, user is warned and plt.beyond.zlim is set to
FALSE.  Default is plt.beyond.zlim==FALSE.</p>
</td></tr>
<tr><td><code id="plot3d.points_+3A_...">...</code></td>
<td>
<p>Any other parameters the user adds will be passed to the
<code><a href="base.html#topic+plot">plot</a></code> function if &lsquo;add=FALSE&rsquo;, and may include
options for axis labels, titles, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper to the <code><a href="geoR.html#topic+points.geodata">points.geodata</a></code>
function in the geoR package.
</p>


<h3>Value</h3>

<p>A scatterplot with points at (<code>x</code>,<code>y</code>).  These points
are colored according to the correspoinding value of <code>z</code> and
the colors specified in <code>col</code>.  They are sized according to the
corresponding value of <code>z</code> and the minimum and maximum sizes
specified by <code>cex.min</code> and <code>cex.max</code>.
</p>


<h3>Author(s)</h3>

<p>Jenise Swall</p>


<h3>See Also</h3>

<p><code><a href="geoR.html#topic+points.geodata">points.geodata</a></code>, <code><a href="graphics.html#topic+points">points</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Plot ozone at each location using colors from rainbow.colors
# and differently-sized points.  Add a legend using function
# vertical.image.legend (included in this package).
data(ozone1)
col.rng &lt;- rev(rainbow(n=10, start=0, end=4/6))
z.rng &lt;- c(40, 90)
plot3d.points(x=ozone1$longitude, y=ozone1$latitude, z=ozone1$daily.max,
              xlab="longitude", ylab="latitude", col=col.rng,
              zlim=z.rng, cex.min=0.5, cex.max=1.5)
# To verify, label the points with their concentrations.
text(ozone1$longitude, ozone1$latitude+0.15, ozone1$daily.max, cex=0.7)
# If maps package is available, put on state lines.
if (require("maps"))  map("state", add=TRUE, col="lightgray")
# Put on legend.
vertical.image.legend(col=col.rng, zlim=z.rng)


# Plot second day of ozone data.  Note that day 2 experienced a smaller
# range of concentrations, so we plot day 2 on same scale as day 1.
data(ozone1)
data(ozone2)
z.rng &lt;- c(40, 90)
col.rng &lt;- rev(rainbow(n=10, start=0, end=4/6))
plot3d.points(x=ozone2$longitude, y=ozone2$latitude, z=ozone2$daily.max,
              xlab="longitude", ylab="latitude", col=col.rng,
              zlim=z.rng, cex.min=0.5, cex.max=1.5)
# To verify, label the points with their concentrations.
text(ozone2$longitude, ozone2$latitude+0.15, ozone2$daily.max, cex=0.7)
# If maps package is available, put on state lines.
if (require("maps"))  map("state", add=TRUE, col="lightgray")
vertical.image.legend(col=col.rng, zlim=z.rng)



# When some z value(s) is/are much lower/higher than the others,
# the outlying value(s) may appear in color at the extent
# of the range, with the remainder of the data clustered in one (or
# just a few) color bin(s).
x &lt;- 1:9
y &lt;- 1:9
z &lt;- c(0, 47:53, 100)
col.rng &lt;- rev(rainbow(n=7, start=0, end=4/6))
plot3d.points(x, y, z, col=col.rng)
text(x, y+0.2, z, cex=0.8)

# In vain, you might try to "fix" this by setting zlim so that the
# color range reflects the main portion of the z values.  You may
# assume that the outlying value(s) will show up in the extreme edges
# of the color range, but what will actually happen is that the
# outlying values won't be plotted.
plot3d.points(x, y, z, col=col.rng, zlim=c(47, 53))
text(x, y+0.2, z, cex=0.8)

# Instead, specify zlim to reflect the main porition of the z values,
# and set plt.beyond.zlim=TRUE.  Now, z values below zlim[1] will be
# plotted in the same color as zlim[1]; those above zlim[2] will be
# plotted like z values of zlim[2].  But, remember, now there are
# outlying values whose maginitudes cannot be easily ascertained!
plot3d.points(x, y, z, zlim=c(47, 53), col=col.rng, plt.beyond.zlim=TRUE)
text(x, y+0.2, z, cex=0.8)
</code></pre>

<hr>
<h2 id='ragged.image'>Produces a &quot;ragged&quot; image plot</h2><span id='topic+ragged.image'></span>

<h3>Description</h3>

<p>This code produces an image plot in the case in which there
is not a known response value <code>z</code> for every possible combination
of <code>x</code> and <code>y</code>.  This ragged image plot is a variant of an
image plot which is not complete across the entire rectangle of the
gridded area.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ragged.image(x, y, z, zlim = range(z, na.rm = TRUE), add = FALSE,
   col = heat.colors(12), xlab, ylab, plt.beyond.zlim = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ragged.image_+3A_x">x</code></td>
<td>
<p>x-coordinates of grid cell centers at which response values
<code>z</code> are available.</p>
</td></tr>
<tr><td><code id="ragged.image_+3A_y">y</code></td>
<td>
<p>y-coordinates of grid cell centers at which response values
<code>z</code> are available.</p>
</td></tr>
<tr><td><code id="ragged.image_+3A_z">z</code></td>
<td>
<p>Response values recorded at the grid cell centers whose
coordinates are given by (<code>x</code>, <code>y</code>).</p>
</td></tr>
<tr><td><code id="ragged.image_+3A_zlim">zlim</code></td>
<td>
<p>Vector of minimum and maximum values of <code>z</code> to which to
assign the two most extreme colors in the 'col' argument (col[1] and
col[length(col)]).  Default is to use the range of <code>z</code>.  This is very
much like the 'zlim' argument to the <code><a href="graphics.html#topic+image">image</a></code> function.</p>
</td></tr>
<tr><td><code id="ragged.image_+3A_add">add</code></td>
<td>
<p>If FALSE (default), the ragged image will begin a new plot.
If TRUE, adds ragged image to a pre-existing plot. </p>
</td></tr>
<tr><td><code id="ragged.image_+3A_col">col</code></td>
<td>
<p>Color range to use for the ragged image, with the first
color assigned to zlim[1] and last color assigned to zlim[2].
Default is &quot;heat.colors(12)&quot;, as it is for <code><a href="graphics.html#topic+image">image</a></code>.</p>
</td></tr>
<tr><td><code id="ragged.image_+3A_xlab">xlab</code></td>
<td>
<p>The label for the x-axis.  If not specified by the user,
defaults to the expression the user named as parameter <code>x</code>.
This behavior is similar to that for <code><a href="graphics.html#topic+image">image</a></code>.</p>
</td></tr>
<tr><td><code id="ragged.image_+3A_ylab">ylab</code></td>
<td>
<p>The label for the y-axis.  If not specified by the user,
defaults to the expression the user named as parameter <code>y</code>.
This behavior is similar to that for <code><a href="graphics.html#topic+image">image</a></code>.</p>
</td></tr>
<tr><td><code id="ragged.image_+3A_plt.beyond.zlim">plt.beyond.zlim</code></td>
<td>
<p>IF TRUE, and if <code>zlim</code> is specified by the
user, z values beyond the limits given in <code>zlim</code> are
plotted. Values less than zlim[1] are plotted in the same color as
zlim[1]; values greater than zlim[2] are plotted in the same color as
zlim[2].  If TRUE, and <code>zlim</code> is not specified by the user,
zlim[1] and zlim[2] will be assigned the minimum and maximum values of
<code>z</code>.  In this case, user is warned and plt.beyond.zlim is set to
FALSE.  Default is plt.beyond.zlim==FALSE.</p>
</td></tr>
<tr><td><code id="ragged.image_+3A_...">...</code></td>
<td>
<p>Any additional parameters to be passed to the
<code><a href="graphics.html#topic+image">image</a></code> function, if add=FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This code produces a ragged image plot.  This is in contrast to
the standard <code><a href="graphics.html#topic+image">image</a></code> function, which assumes that there is a
known response value <code>z</code> for every combination of the elements of
<code>x</code> and <code>y</code>, i.e. that there is a complete rectangular grid,
or image.  A ragged image plot is a variant of the regular image plot
which is not complete across the entire rectangle.  The user specifies
vectors <code>x</code>, <code>y</code>, and <code>z</code>, such that <code>x</code> and
<code>y</code> identify a portion of the grid. This function maps the vector
<code>z</code> onto a matrix of the type needed for the <code><a href="graphics.html#topic+image">image</a></code>
function, but has NA entries for combinations of <code>x</code> and <code>y</code>
that are not listed.  The NA values are not plotted by
<code><a href="graphics.html#topic+image">image</a></code>, so a ragged image will appear.</p>


<h3>Value</h3>

<p>A ragged image, i.e. a portion of an image for which we have
specified grid cell centers <code>x</code> and <code>y</code>.</p>


<h3>Note</h3>

<p>This function is slow if <code>x</code>, <code>y</code>, and <code>z</code> are long
vectors.</p>


<h3>Author(s)</h3>

<p>Jenise Swall</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+image">image</a></code>, <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Build x, y, and z.
x &lt;- c(1, 2, 3, 1, 2, 3)
y &lt;- c(1, 1, 1, 2, 2, 2)
z &lt;- 1:6
z.mat &lt;- matrix(c(1:6), ncol=2)
col.rng &lt;- terrain.colors(6)
# Show complete matrix.
image(x=unique(x), y=unique(y), z.mat, zlim=range(z), col=col.rng,
      xlab="x", ylab="y")
# Plot only part of this as a ragged image.  Set z range so that this
# image will use colors consistent with the previous one.
ragged.image(x=x[1:4], y=y[1:4], z=z[1:4], zlim=range(z), col=col.rng,
             xlab="x", ylab="y")



# When some z value(s) is/are much lower/higher than the others,
# the outlying value(s) may appear in color at the extent
# of the range, with the remainder of the data clustered in one (or
# just a few) color bin(s).
x &lt;- c(1, 2, 3, 1, 3, 2, 3, 1, 3)
y &lt;- c(4, 4, 4, 3, 3, 2, 2, 1, 1)
z &lt;- c(0, 47:53, 100)
col.rng &lt;- rev(rainbow(n=7, start=0, end=4/6))
ragged.image(x, y, z, col=col.rng)
text(x, y, z, cex=0.8)

# In vain, you might try to "fix" this by setting zlim so that the
# color range reflects the main portion of the z values.  You may
# assume that the outlying value(s) will show up in the extreme edges
# of the color range, but what will actually happen is that the
# outlying values won't be plotted.
ragged.image(x, y, z, col=col.rng, zlim=c(47, 53))
text(x, y, z, cex=0.8)

# Instead, specify zlim to reflect the main porition of the z values,
# and set plt.beyond.zlim=TRUE.  Now, z values below zlim[1] will be
# plotted in the same color as zlim[1]; those above zlim[2] will be
# plotted like z values of zlim[2].  But, remember, now there are
# outlying values whose maginitudes cannot be easily ascertained!
ragged.image(x, y, z, zlim=c(47, 53), col=col.rng, plt.beyond.zlim=TRUE)
text(x, y, z, cex=0.8)
</code></pre>

<hr>
<h2 id='scatterplot.density'>Use color to show the density of points in a scatterplot</h2><span id='topic+scatterplot.density'></span>

<h3>Description</h3>

<p>The plotting region of the scatterplot is divided into
bins. The number of data points falling within each bin is summed and
then plotted using the image function.  This is particularly useful when
there are so many points that each point cannot be distinctly
identified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatterplot.density(x, y, zlim, xylim, num.bins=64,
   col=kristen.colors(32), xlab, ylab, main, density.in.percent=TRUE,
   col.regression.line=1, col.one.to.one.line=grey(0.4),
   col.bar.legend=TRUE, plt.beyond.zlim=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scatterplot.density_+3A_x">x</code></td>
<td>
<p>Vector or matrix of x-coordinates of points to be plotted.
Missing values are not permitted.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_y">y</code></td>
<td>
<p>Vector or matrix of y-coordinates of points to be plotted.
Missing values are not permitted.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_zlim">zlim</code></td>
<td>
<p>Vector defining the minimum and maximum of the data
density values, to which to assign the two most extreme colors in the
<code>col</code> argument.  If not specified, the range of the calculated
density values to be plotted is used.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_xylim">xylim</code></td>
<td>
<p>Specification of extreme values that the first and last
bins are expected to contain in the x- and y-directions.  May be a
single vector of the limits for the x and y axes; e.g., using
&lsquo;<span class="samp">&#8288;xylim=c(0,120)&#8288;</span>&rsquo; specifies that, in both the x- and
y-directions, the first bin should contain 0 and the last contain
120.  May also be a list in the form: &lsquo;<span class="samp">&#8288;xylim=list(xlim=c(x1
    ,x2), ylim=c(y1, y2))&#8288;</span>&rsquo;, allowing for the different ranges on the
axes.  If not specified, xlim is the range of <code>x</code> and ylim is
the range of <code>y</code>.
</p>
<p>Note that <code>xylim</code> and <code>num.bins</code> together determine how
the bins are defined.  For more information, see &ldquo;Details&rdquo;
below.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_num.bins">num.bins</code></td>
<td>
<p>Number of bins to be used when calculating the data
density in both the x- and y-directions.  May be a single number,
e.g. &lsquo;<span class="samp">&#8288;num.bins=50&#8288;</span>&rsquo;, which produces 50 bins in each direction.
May also be a list in the form
&lsquo;<span class="samp">&#8288;num.bins=list(num.bins.x=n1, num.bins.y=n2)&#8288;</span>&rsquo; to specify
differing numbering of bins for the x- and y-directions.  The
default is to use 64 bins for both axes (&lsquo;<span class="samp">&#8288;num.bins=64&#8288;</span>&rsquo;).
</p>
<p>Note that <code>xylim</code> and <code>num.bins</code> together determine how
the bins are defined.  For more information, see &ldquo;Details&rdquo;
below.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_col">col</code></td>
<td>
<p>Color range to use when drawing bins, with the first color
assigned to &lsquo;<span class="samp">&#8288;zlim[1]&#8288;</span>&rsquo; and last color assigned to
&lsquo;<span class="samp">&#8288;zlim[2]&#8288;</span>&rsquo;.  Default is &lsquo;<span class="samp">&#8288;kristen.colors(32)&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_xlab">xlab</code></td>
<td>
<p>The label for the x-axis.  If not specified by the user,
defaults to the expression the user named as parameter <code>x</code>.
This behavior is similar to that for <code><a href="graphics.html#topic+image">image</a></code>.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_ylab">ylab</code></td>
<td>
<p>The label for the y-axis.  If not specified by the user,
defaults to the expression the user named as parameter <code>y</code>.
This behavior is similar to that for <code><a href="graphics.html#topic+image">image</a></code>.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_main">main</code></td>
<td>
<p>The main title for the density scatterplot.  If not
specified, the default is &ldquo;Data Density Plot (%)&rdquo; when
&lsquo;<span class="samp">&#8288;density.in.percent=TRUE&#8288;</span>&rsquo;, and &ldquo;Data Frequency Plot
(counts)&rdquo; otherwise.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_density.in.percent">density.in.percent</code></td>
<td>
<p>A logical indicating whether the density
values should represent a percentage of the total number of data
points, rather than a count value.  Default is
&lsquo;<span class="samp">&#8288;density.in.percent=TRUE&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_col.regression.line">col.regression.line</code></td>
<td>
<p>A color number or color name for the
regression line and estimated regression equation (<code>y</code> as a
linear function of <code>x</code>) to be overlaid on density scatterplot.
If NULL, the regression line and equation are not displayed.
Defaults to a black line and equation text.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_col.one.to.one.line">col.one.to.one.line</code></td>
<td>
<p>A color number or color name for the
regression one-to-one line to be overlaid on density scatterplot.  If
NULL, the one-to-one line is not displayed.  Defaults to a dark grey
line.  If the one-to-one line is displayed, it will be as a dashed
line (&lsquo;<span class="samp">&#8288;lty=3&#8288;</span>&rsquo;).
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_col.bar.legend">col.bar.legend</code></td>
<td>
<p>A logical indicating whether a
&ldquo;color legend&rdquo; of the form given by
<code><a href="#topic+vertical.image.legend">vertical.image.legend</a></code> should be displayed.  The
default is &lsquo;<span class="samp">&#8288;col.bar.legend=TRUE&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_plt.beyond.zlim">plt.beyond.zlim</code></td>
<td>
<p>IF TRUE, and if <code>zlim</code> is specified by
the user, density values beyond the limits given in <code>zlim</code>
are plotted. Values less than &lsquo;<span class="samp">&#8288;zlim[1]&#8288;</span>&rsquo; are plotted in the same
color as &lsquo;<span class="samp">&#8288;zlim[1]&#8288;</span>&rsquo;; values greater than &lsquo;<span class="samp">&#8288;zlim[2]&#8288;</span>&rsquo; are
plotted in the same color as &lsquo;<span class="samp">&#8288;zlim[2]&#8288;</span>&rsquo;.  If TRUE, and
<code>zlim</code> is not specified by the user, &lsquo;<span class="samp">&#8288;zlim[1]&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;zlim[2]&#8288;</span>&rsquo; will be assigned the minimum and maximum values of
<code>z</code>.  In this case, user is warned and <code>plt.beyond.zlim</code>
is set to FALSE.  Default is &lsquo;<span class="samp">&#8288;plt.beyond.zlim=FALSE&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="scatterplot.density_+3A_...">...</code></td>
<td>
<p>Any additional parameters to be passed to the
<code><a href="graphics.html#topic+image">image</a></code> function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plotting region of the scatterplot is divided into bins.
The number of data points falling within each bin is summed and then
plotted using the <code><a href="graphics.html#topic+image">image</a></code> function. The default is to
plot the percent of the data falling within each bin, rather than a
raw count value. The arguments xylim and num.bins can include
different settings for the x- and y-axis.  This makes it easier to
plot different variables on each axis, e.g. temperature
vs. ozone. Note that <code>xylim</code> and <code>num.bins</code> together
determine how the bins are defined.
</p>
<p>Note that <code>xylim</code> and <code>num.bins</code> together determine how the
bins are defined.  This is done using the <code><a href="base.html#topic+cut">cut</a></code> function.
Assigning values to bins is more complicated than might be expected.
For example, values that fall at cutoff points between bins are
difficult to deal with.  This function accepts the default setting for
<code><a href="base.html#topic+cut">cut</a></code>, which assigns values which fall on a cutoff point
to the bin on the left; that is, the intervals are open on the left
and closed on the right.  This means that a point with x-value equal
to &lsquo;<span class="samp">&#8288;xlim[1]&#8288;</span>&rsquo; and/or y-value equal to &lsquo;<span class="samp">&#8288;ylim[1]&#8288;</span>&rsquo; would not be
assigned to any interval, which is probably not what the user intends
in this circumstance.  Therefore, this code determines the number of
bins in the x-direction so that &lsquo;<span class="samp">&#8288;xlim[1]&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;xlim[2]&#8288;</span>&rsquo; are
at the center of the first and last bin in the x-direction (and
similarly for the y-direction).  This means that the first and last
bins actually extend a bit past the limits specified.  For most
applicatons, which use large numbers of data points and bins, this
shouldn't be noticeable, but it may be in smalled examples like the
first one given below.</p>


<h3>Value</h3>

<p>A density scatterplot; that is, a pattern of shaded squares
representing the counts/percentages of the points falling in each
square.</p>


<h3>Author(s)</h3>

<p>Original version (<code>plot.density.scatter.plot</code>) by Kristen
Foley, adapted for <span class="pkg">aqfig</span> by Jenise Swall</p>


<h3>See Also</h3>

<p><code><a href="#topic+vertical.image.legend">vertical.image.legend</a></code>,
<code><a href="#topic+kristen.colors">kristen.colors</a></code>, <code><a href="graphics.html#topic+image">image</a></code>, <code><a href="base.html#topic+cut">cut</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># As a simple test case, build x and y vectors consisting only of the
# integers 1-3.
x &lt;- c( rep(1, 7), rep(2, 12), rep(3, 6) )
y &lt;- c( rep(1, 5), rep(2, 2), rep(1, 2), rep(2, 8), rep(3, 2),
        rep(2, 2), rep(3, 4) )

# For this test case, I've totaled the counts below.
count.df &lt;- data.frame(x=rep(1:3, each=3), y=rep(1:3, times=3), ct=c(5,
2, 0, 2, 8, 2, 0, 2, 4) )

# Make a density scatterplot with counts.
scatterplot.density(x, y, num.bins=3, col=heat.colors(7),
                    density.in.percent=FALSE,
                    col.one.to.one.line="green")
text(count.df$x, count.df$y, count.df$ct, col="purple")

# Make a density scatterplot with percentages.
scatterplot.density(x, y, num.bins=3, col=heat.colors(7), col.one.to.one.line=1)
text(count.df$x, count.df$y, count.df$ct/sum(count.df$ct))


# An example closer to actual usage.
x &lt;- rnorm(100000,50,5)
y &lt;- 3 + (.89*x) + rnorm(100000,0,5)
scatterplot.density(x, y)
</code></pre>

<hr>
<h2 id='vertical.image.legend'>Put color bar legend in the right plot margin.</h2><span id='topic+vertical.image.legend'></span>

<h3>Description</h3>

<p> Put color bar legend in the right-hand side margin of an
existing plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vertical.image.legend(zlim, col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vertical.image.legend_+3A_zlim">zlim</code></td>
<td>
<p>Gives the range of z values to which the colors specified
in <code>col</code> are assigned.</p>
</td></tr>
<tr><td><code id="vertical.image.legend_+3A_col">col</code></td>
<td>
<p> Gives the range of colors to use.  To keep multiple plots
consistent in terms of the colors assigned to various values, keep
<code>zlim</code> and <code>col</code> the same for each of the plots and the legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function works best when there is only one plot on the
device, in which case the margin space is straightforward (no
confusion between <code>oma</code>/<code>omi</code> and <code>mar</code>/<code>mai</code>,
etc.  The user should finish making the main portion of the plot before adding
the legend; i.e., the user should <strong>add the legend last</strong>.  This function
alters the <code><a href="graphics.html#topic+par">par</a></code> settings to draw the legend.  Upon exit, it
resets them back to what they were before the function call.</p>


<h3>Value</h3>

<p>Puts vertical color bar legend to the right of the plot.</p>


<h3>Note</h3>

<p>Putting a legend on a plot is harder than it might seem.  The user may
have to experiment with this function a bit to get it to work well for a
specific application.  The user may also want to try the
<code><a href="fields.html#topic+imagePlot">imagePlot</a></code> function in the fields package.</p>


<h3>Author(s)</h3>

<p>Jenise Swall</p>


<h3>See Also</h3>

<p><code><a href="fields.html#topic+image.plot">image.plot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot ozone at each location using colors from rainbow.colors
# and differently-sized points.  Add a legend using function
# vertical.image.legend (included in this package).
data(ozone1)
col.rng &lt;- rev(rainbow(n=10, start=0, end=4/6))
z.rng &lt;- c(40, 90)
plot3d.points(x=ozone1$longitude, y=ozone1$latitude, z=ozone1$daily.max,
              xlab="longitude", ylab="latitude", zlim=z.rng, col=col.rng,
              cex.min=0.5, cex.max=1.5)
# To verify, label the points with their concentrations.
text(ozone1$longitude, ozone1$latitude+0.15, ozone1$daily.max, cex=0.7)
# If maps package is available, put on state lines.
if (require("maps"))  map("state", add=TRUE, col="lightgray")
# Put on legend.
vertical.image.legend(col=col.rng, zlim=z.rng)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
