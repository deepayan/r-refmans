<!DOCTYPE html><html lang="en"><head><title>Help for package rTwig</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rTwig}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rTwig-package'><p>rTwig: Realistic Quantitative Structure Models</p></a></li>
<li><a href='#box_dimension'><p>Box Dimension</p></a></li>
<li><a href='#cluster_cloud'><p>Cluster Cloud</p></a></li>
<li><a href='#correct_radii'><p>Correct Radii</p></a></li>
<li><a href='#export_mat'><p>Export MAT</p></a></li>
<li><a href='#export_mesh'><p>Export Mesh</p></a></li>
<li><a href='#import_leaves'><p>Import Leaves</p></a></li>
<li><a href='#import_qsm'><p>Import TreeQSM</p></a></li>
<li><a href='#import_treegraph'><p>Import Treegraph</p></a></li>
<li><a href='#import_treeqsm'><p>Import TreeQSM</p></a></li>
<li><a href='#plot_qsm'><p>Plot QSM</p></a></li>
<li><a href='#prune_qsm'><p>Prune QSM</p></a></li>
<li><a href='#qsm_summary'><p>QSM Summary</p></a></li>
<li><a href='#run_rtwig'><p>Run Real Twig</p></a></li>
<li><a href='#smooth_qsm'><p>Smooth QSM</p></a></li>
<li><a href='#standardise_qsm'><p>Standardise QSM</p></a></li>
<li><a href='#summarise_qsm'><p>Summarise QSM</p></a></li>
<li><a href='#tree_metrics'><p>Tree Metrics</p></a></li>
<li><a href='#twigs'><p>Twig Species Database</p></a></li>
<li><a href='#twigs_index'><p>Twig Index Database</p></a></li>
<li><a href='#update_cylinders'><p>Update Cylinders</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Realistic Quantitative Structure Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Real Twig is a method to correct branch overestimation in quantitative structure models. Overestimated cylinders are correctly tapered using measured twig diameters of corresponding tree species. Supported quantitative structure modeling software includes 'TreeQSM', 'SimpleForest', 'Treegraph', and 'aRchi'. Also included is a novel database of twig diameters and tools for fractal analysis of point clouds.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Imports:</td>
<td>R.matlab, rmatio, tidytable, cobs, igraph, rgl, colourvalues,
Rdpack, rlang, Rcpp, RcppSimdJson, geometry</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggplot2, ggpmisc, ggpubr, gt, yardstick,
dplyr, tidyr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-03 16:46:51 UTC; moral169</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aidan Morales &lt;moral169@msu.edu&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://aidanmorales.github.io/rTwig/">https://aidanmorales.github.io/rTwig/</a>,
<a href="https://github.com/aidanmorales/rTwig">https://github.com/aidanmorales/rTwig</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/aidanmorales/rTwig/issues">https://github.com/aidanmorales/rTwig/issues</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Author:</td>
<td>Aidan Morales <a href="https://orcid.org/0009-0000-4513-4908"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  David W. MacFarlane [aut, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-03 17:10:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='rTwig-package'>rTwig: Realistic Quantitative Structure Models</h2><span id='topic+rTwig'></span><span id='topic+rTwig-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Real Twig is a method to correct branch overestimation in quantitative structure models. Overestimated cylinders are correctly tapered using measured twig diameters of corresponding tree species. Supported quantitative structure modeling software includes 'TreeQSM', 'SimpleForest', 'Treegraph', and 'aRchi'. Also included is a novel database of twig diameters and tools for fractal analysis of point clouds.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Aidan Morales <a href="mailto:moral169@msu.edu">moral169@msu.edu</a> (<a href="https://orcid.org/0009-0000-4513-4908">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> David W. MacFarlane <a href="mailto:macfar24@msu.edu">macfar24@msu.edu</a> [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://aidanmorales.github.io/rTwig/">https://aidanmorales.github.io/rTwig/</a>
</p>
</li>
<li> <p><a href="https://github.com/aidanmorales/rTwig">https://github.com/aidanmorales/rTwig</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/aidanmorales/rTwig/issues">https://github.com/aidanmorales/rTwig/issues</a>
</p>
</li></ul>


<hr>
<h2 id='box_dimension'>Box Dimension</h2><span id='topic+box_dimension'></span>

<h3>Description</h3>

<p>R port of Dominik Seidel's fractal analysis &quot;box-dimension&quot; metric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>box_dimension(cloud, lowercutoff = 0.01, rm_int_box = FALSE, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="box_dimension_+3A_cloud">cloud</code></td>
<td>
<p>A point cloud matrix size n x 3.
Non-matrices are automatically converted to a matrix.</p>
</td></tr>
<tr><td><code id="box_dimension_+3A_lowercutoff">lowercutoff</code></td>
<td>
<p>The smallest box size determined by the point spacing of
the cloud in meters. Defaults to 1 cm.</p>
</td></tr>
<tr><td><code id="box_dimension_+3A_rm_int_box">rm_int_box</code></td>
<td>
<p>Remove the initial box as TRUE or FALSE. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="box_dimension_+3A_plot">plot</code></td>
<td>
<p>Plot the results. The user can specify &quot;2D&quot;, &quot;3D&quot;, or &quot;ALL&quot; plots.
FALSE disables plotting. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list
</p>


<h3>References</h3>

<p>Arseniou G, MacFarlane DW, Seidel D (2021).
&ldquo;Measuring the Contribution of Leaves to the Structural Complexity of Urban Tree Crowns with Terrestrial Laser Scanning.&rdquo;
<em>Remote Sensing</em>, <b>13</b>(14).
<a href="https://doi.org/10.3390/rs13142773">doi:10.3390/rs13142773</a>.
</p>
<p>Mandelbrot BB (1983).
<em>The fractal geometry of nature</em>.
Freeman.
</p>
<p>Saarinen N, Calders K, Kankare V, Yrttimaa T, Junttila S, Luoma V, Huuskonen S, Hynynen J, Verbeeck H (2021).
&ldquo;Understanding 3D structural complexity of individual Scots pine trees with different management history.&rdquo;
<em>Ecology and Evolution</em>, <b>11</b>(6), 2561-2572.
<a href="https://doi.org/10.1002/ece3.7216">doi:10.1002/ece3.7216</a>.
</p>
<p>Seidel D (2018).
&ldquo;A holistic approach to determine tree structural complexity based on laser scanning data and fractal analysis.&rdquo;
<em>Ecology and Evolution</em>, <b>8</b>(1), 128-134.
<a href="https://doi.org/10.1002/ece3.3661">doi:10.1002/ece3.3661</a>.
</p>
<p>Seidel D, Annighöfer P, Stiers M, Zemp CD, Burkardt K, Ehbrecht M, Willim K, Kreft H, Hölscher D, Ammer C (2019).
&ldquo;How a measure of tree structural complexity relates to architectural benefit-to-cost ratio, light availability, and growth of trees.&rdquo;
<em>Ecology and Evolution</em>, <b>9</b>(12), 7134-7142.
<a href="https://doi.org/10.1002/ece3.5281">doi:10.1002/ece3.5281</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate Box Dimension
file &lt;- system.file("extdata/cloud.txt", package = "rTwig")
cloud &lt;- read.table(file, header = FALSE)
output &lt;- box_dimension(cloud, plot = "ALL")
output

</code></pre>

<hr>
<h2 id='cluster_cloud'>Cluster Cloud</h2><span id='topic+cluster_cloud'></span>

<h3>Description</h3>

<p>Cluster a point cloud or simulate a point cloud based on its QSM.
If using the input point cloud, the cylinder ids are transferred to the
cloud using the nearest neighbors. If simulating a cloud, the points are built
directly from the cylinders with user controlled spacing. The cylinder id can
be used to easily join the desired variables from the QSM to the cloud.
The nearest neighbor search uses the C++ nanoflann library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_cloud(cylinder, cloud = NULL, spacing = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster_cloud_+3A_cylinder">cylinder</code></td>
<td>
<p>A QSM cylinder data frame.</p>
</td></tr>
<tr><td><code id="cluster_cloud_+3A_cloud">cloud</code></td>
<td>
<p>The input point cloud for the QSM to cluster.
If NULL (default), the simulated cloud is returned.</p>
</td></tr>
<tr><td><code id="cluster_cloud_+3A_spacing">spacing</code></td>
<td>
<p>The point spacing in meters for the simulated cloud.
Defaults to 0.02 meters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A point cloud data frame
</p>


<h3>References</h3>

<p>Blanco JL, Rai PK (2014).
&ldquo;nanoflann: a C++ header-only fork of FLANN, a library for Nearest Neighbor (NN) with KD-trees.&rdquo;
<a href="https://github.com/jlblancoc/nanoflann">https://github.com/jlblancoc/nanoflann</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load Data
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
file2 &lt;- system.file("extdata/cloud.txt", package = "rTwig")

qsm &lt;- run_rtwig(file, twig_radius = 4.23, metrics = FALSE)
cloud &lt;- read.table(file2)

## Clustered Cloud
clustered_cloud &lt;- cluster_cloud(cylinder = qsm, cloud = cloud)

# # Join QSM variables and export
# filename &lt;- tempfile(pattern = "clustered_cloud", fileext = ".txt")
# clustered_cloud %&gt;%
#   left_join(qsm) %&gt;%
#   fwrite(file = filename)

## Simulated Cloud
simulated_cloud &lt;- cluster_cloud(cylinder = qsm, spacing = 0.01)

# Plot Simulated Cloud
plot_qsm(cloud = simulated_cloud)

# # Join QSM variables and export
# filename2 &lt;- tempfile(pattern = "simulated_cloud", fileext = ".txt")
# simulated_cloud %&gt;%
#   left_join(qsm) %&gt;%
#   fwrite(file = filename2)

</code></pre>

<hr>
<h2 id='correct_radii'>Correct Radii</h2><span id='topic+correct_radii'></span>

<h3>Description</h3>

<p>Corrects cylinder radii
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct_radii(cylinder, twig_radius, broken_branch = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correct_radii_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame</p>
</td></tr>
<tr><td><code id="correct_radii_+3A_twig_radius">twig_radius</code></td>
<td>
<p>Twig radius in millimeters</p>
</td></tr>
<tr><td><code id="correct_radii_+3A_broken_branch">broken_branch</code></td>
<td>
<p>Enable or disable the broken branch filter.
Defaults to enabled (TRUE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## TreeQSM Processing Chain
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- update_cylinders(cylinder)
cylinder &lt;- correct_radii(cylinder, twig_radius = 4.23)
str(cylinder)

</code></pre>

<hr>
<h2 id='export_mat'>Export MAT</h2><span id='topic+export_mat'></span>

<h3>Description</h3>

<p>Exports the cylinder data to the format used by TreeQSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_mat(cylinder, filename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="export_mat_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame</p>
</td></tr>
<tr><td><code id="export_mat_+3A_filename">filename</code></td>
<td>
<p>Desired name of file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a .mat file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## TreeQSM Processing Chain
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- update_cylinders(cylinder)

filename &lt;- tempfile(pattern = "TreeQSM_QSM", fileext = ".mat")
export_mat(cylinder, filename)

## SimpleForest Processing Chain
file &lt;- system.file("extdata/QSM.csv", package = "rTwig")
cylinder &lt;- read.csv(file)
cylinder &lt;- update_cylinders(cylinder)

filename &lt;- tempfile(pattern = "SimpleForest_QSM", fileext = ".mat")
export_mat(cylinder, filename)

</code></pre>

<hr>
<h2 id='export_mesh'>Export Mesh</h2><span id='topic+export_mesh'></span>

<h3>Description</h3>

<p>Exports a QSM cylinder mesh in various formats
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_mesh(
  cylinder,
  filename,
  format = "ply",
  radius = NULL,
  color = NULL,
  palette = NULL,
  facets = 6,
  normals = FALSE,
  alpha = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="export_mesh_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame.</p>
</td></tr>
<tr><td><code id="export_mesh_+3A_filename">filename</code></td>
<td>
<p>File name and path for exporting.
The file extension is automatically added if not present.</p>
</td></tr>
<tr><td><code id="export_mesh_+3A_format">format</code></td>
<td>
<p>Mesh file format. Defaults to <code>ply</code>.
Supported formats include <code>ply</code>, <code>obj</code>, <code>stl</code>, and <code>blender</code>.
<code>format = "blender"</code> exports the mesh in the qsm-blender-addons format.</p>
</td></tr>
<tr><td><code id="export_mesh_+3A_radius">radius</code></td>
<td>
<p>Radius column name either quoted or unquoted.
Defaults to the modified radii.</p>
</td></tr>
<tr><td><code id="export_mesh_+3A_color">color</code></td>
<td>
<p>Optional cylinder color parameter.
<code>color</code> must be a single hex color string, a <code>grDevices::colors()</code>, a vector
of hex colors, or a quoted/unquoted column name.
Vectors must have the same length as the cylinder data frame.
<code>color = "random"</code> will generate a random color applied to all cylinders.
Defaults to branching order.</p>
</td></tr>
<tr><td><code id="export_mesh_+3A_palette">palette</code></td>
<td>
<p>Optional cylinder color palette for numerical data.
Palettes include <code>colourvalues::color_palettes()</code> or a user supplied RGB
palette matrix with the length of cylinder. It can also be set to &quot;random&quot;
to generate a random palette. If combined with <code>color = "random"</code>, each
cylinder will have a random, distinct color.</p>
</td></tr>
<tr><td><code id="export_mesh_+3A_facets">facets</code></td>
<td>
<p>The number of facets in the polygon cross section.
Defaults to 6. A higher number of facets improves visual smoothness at the
cost of plotting speed, performance and memory.</p>
</td></tr>
<tr><td><code id="export_mesh_+3A_normals">normals</code></td>
<td>
<p>Export surface normals per vertex. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="export_mesh_+3A_alpha">alpha</code></td>
<td>
<p>Set the transparency of the cylinders used in the &quot;ply&quot; format.
Defaults to 1. 1 is opaque and 0 is fully transparent.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A mesh file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load QSM
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- update_cylinders(cylinder)

# PLY
filename &lt;- tempfile(pattern = "QSM_ply")
export_mesh(
  cylinder = cylinder,
  filename = filename,
  format = "ply",
  color = "distanceToTwig",
  palette = "viridis",
  normals = TRUE
)

# OBJ
filename &lt;- tempfile(pattern = "QSM_obj")
export_mesh(
  cylinder = cylinder,
  filename = filename,
  format = "obj",
  normals = TRUE
)

# STL
filename &lt;- tempfile(pattern = "QSM_stl")
export_mesh(
  cylinder = cylinder,
  filename = filename,
  format = "stl",
  normals = TRUE
)

# QSM Blender Addons
filename &lt;- tempfile(pattern = "QSM_blender")
export_mesh(
  cylinder = cylinder,
  filename = filename,
  format = "blender",
  normals = TRUE
)

</code></pre>

<hr>
<h2 id='import_leaves'>Import Leaves</h2><span id='topic+import_leaves'></span>

<h3>Description</h3>

<p>Imports leaves created by the QSM foliage and needles naive
insertion (QSM-FaNNI) algorithm. The leaves are stored as a triangular mesh,
compatible with both rTwig and RGL functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_leaves(filename, format = "obj", simplify = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_leaves_+3A_filename">filename</code></td>
<td>
<p>a QSM-FaNNI .obj file</p>
</td></tr>
<tr><td><code id="import_leaves_+3A_format">format</code></td>
<td>
<p>.obj file format. Valid formats include <code>obj</code> and <code>obj_ext</code>.
Defaults to <code>obj</code>.</p>
</td></tr>
<tr><td><code id="import_leaves_+3A_simplify">simplify</code></td>
<td>
<p>simplify the mesh by removing duplicate vertices. This can
reduce memory usage at the cost of import speed. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rgl::mesh3d object
</p>


<h3>References</h3>

<p>Åkerblom M, Raumonen P, Casella E, Disney MI, Danson FM, Gaulton R, Schofield LA, Kaasalainen M (2018).
&ldquo;An algorithm to insert leaves into quantitative structure models of trees.&rdquo;
<em>Interface Focus</em>, <b>8</b>(2), 20170045.
ISSN 2042-8898, <a href="https://doi.org/10.1098/rsfs.2017.0045">doi:10.1098/rsfs.2017.0045</a>, 20180216.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## Import FaNNI leaves from the standard obj format
file &lt;- "path_to_leaves.obj"
qsm &lt;- import_leaves(file, format = "obj")

## Import FaNNI leaves from the extended obj format
file &lt;- "path_to_leaves_extended.obj"
qsm &lt;- import_leaves(file, format = "obj_ext")

## End(Not run)

</code></pre>

<hr>
<h2 id='import_qsm'>Import TreeQSM</h2><span id='topic+import_qsm'></span>

<h3>Description</h3>

<p><code>import_qsm()</code> is deprecated and will be removed in a future version. Use <code>import_treeqsm()</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_qsm(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_qsm_+3A_...">...</code></td>
<td>
<p>function inputs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list
</p>

<hr>
<h2 id='import_treegraph'>Import Treegraph</h2><span id='topic+import_treegraph'></span>

<h3>Description</h3>

<p>Imports a QSM created by treegraph
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_treegraph(filename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_treegraph_+3A_filename">filename</code></td>
<td>
<p>a treegraph .json file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list
</p>


<h3>References</h3>

<p>Yang W, Wilkes P, Vicari MB, Hand K, Calders K, Disney M (2024).
&ldquo;Treegraph: tree architecture from terrestrial laser scanning point clouds.&rdquo;
<em>Remote Sensing in Ecology and Conservation</em>.
ISSN 2056-3485, <a href="https://doi.org/10.1002/rse2.399">doi:10.1002/rse2.399</a>.
</p>
<p>Wilkes P, Shenkin A, Disney M, Malhi Y, Bentley LP, Vicari MB (2021).
&ldquo;Terrestrial laser scanning to reconstruct branch architecture from harvested branches.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>12</b>, 2487-2500.
<a href="https://doi.org/10.1111/2041-210X.13709">doi:10.1111/2041-210X.13709</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Import a treegraph QSM
qsm &lt;- import_treegraph("path/to/json/file")

## End(Not run)

</code></pre>

<hr>
<h2 id='import_treeqsm'>Import TreeQSM</h2><span id='topic+import_treeqsm'></span>

<h3>Description</h3>

<p>Imports a QSM created by TreeQSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_treeqsm(filename, version = "2.x.x")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_treeqsm_+3A_filename">filename</code></td>
<td>
<p>a TreeQSM .mat MATLAB file</p>
</td></tr>
<tr><td><code id="import_treeqsm_+3A_version">version</code></td>
<td>
<p>TreeQSM version. Valid versions include <code style="white-space: pre;">&#8288;2.3.0&#8288;</code> - <code style="white-space: pre;">&#8288;2.4.1&#8288;</code> and
<code>2.0</code>. Defaults to the most recent format of <code style="white-space: pre;">&#8288;2.x.x&#8288;</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list
</p>


<h3>References</h3>

<p>Raumonen P, Kaasalainen M, Åkerblom M, Kaasalainen S, Kaartinen H, Vastaranta M, Holopainen M, Disney M, Lewis P (2013).
&ldquo;Fast Automatic Precision Tree Models from Terrestrial Laser Scanner Data.&rdquo;
<em>Remote Sensing</em>, <b>5</b>(2), 491&ndash;520.
<a href="https://doi.org/10.3390/rs5020491">doi:10.3390/rs5020491</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Read a TreeQSM MATLAB file in the 2.3.x - 2.4.x format
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file, version = "2.x.x")
summary(qsm)

## Read a TreeQSM MATLAB file in the 2.0 format
file &lt;- system.file("extdata/QSM_2.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file, version = "2.0")
names(qsm)

</code></pre>

<hr>
<h2 id='plot_qsm'>Plot QSM</h2><span id='topic+plot_qsm'></span>

<h3>Description</h3>

<p>Efficiently plot QSMs, point clouds, leaves, and stem
triangulation meshes. Plots can be combined and extensively customized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_qsm(
  cylinder = NULL,
  radius = NULL,
  color = NULL,
  palette = NULL,
  alpha = 1,
  facets = 6,
  skeleton = FALSE,
  skeleton_lwd = 1,
  cloud = NULL,
  pt_color = "#000000",
  pt_palette = NULL,
  pt_size = NULL,
  pt_alpha = 1,
  triangulation = NULL,
  tri_color = NULL,
  tri_palette = NULL,
  tri_alpha = 1,
  leaves = NULL,
  lf_color = "#5BA803",
  lf_alpha = 1,
  axes = TRUE,
  axes_color = "#000000",
  grid = FALSE,
  grid_color = "#D3D3D3",
  hover = FALSE,
  bg_color = "#FFFFFF",
  lit = FALSE,
  pan = TRUE,
  normalize = FALSE,
  mesh = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_qsm_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_radius">radius</code></td>
<td>
<p>Radius column name either quoted or unquoted.
Defaults to the modified radii.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_color">color</code></td>
<td>
<p>Optional cylinder color parameter.
<code>color</code> must be a single hex color string, a <code>grDevices::colors()</code>, a vector
of hex colors, or a quoted/unquoted column name.
Vectors must have the same length as the cylinder data frame.
<code>color = "random"</code> will generate a random color applied to all cylinders.
Defaults to branching order.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_palette">palette</code></td>
<td>
<p>Optional cylinder color palette for numerical data.
Palettes include <code>colourvalues::color_palettes()</code> or a user supplied RGB
palette matrix with the length of cylinder. It can also be set to &quot;random&quot;
to generate a random palette. If combined with <code>color = "random"</code>, each
cylinder will have a random, distinct color.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_alpha">alpha</code></td>
<td>
<p>Set the transparency of the cylinders.
Defaults to 1. 1 is opaque and 0 is fully transparent.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_facets">facets</code></td>
<td>
<p>The number of facets in the polygon cross section.
Defaults to 6. A higher number of facets improves visual smoothness at the
cost of plotting speed, performance and memory.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_skeleton">skeleton</code></td>
<td>
<p>Plot the QSM skeleton instead of cylinders. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_skeleton_lwd">skeleton_lwd</code></td>
<td>
<p>Skeleton line width. Defaults to 1.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_cloud">cloud</code></td>
<td>
<p>Point cloud data frame or matrix where the first three columns
are the x, y, and z coordinates.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_pt_color">pt_color</code></td>
<td>
<p>Optional point cloud color parameter.
<code>pt_color</code> must be a single hex color string, a <code>grDevices::colors()</code>, a vector
of hex colors, or a quoted/unquoted column name.
<code>pt_color = "random"</code> will generate a random color for all points.
Vectors must have the same length as the point cloud data frame.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_pt_palette">pt_palette</code></td>
<td>
<p>Optional point cloud color palette for numerical data.
<code>pt_palette</code> includes <code>colourvalues::color_palettes()</code> or a user supplied RGB
palette matrix with the length of the points. It can also be set to &quot;random&quot;
to generate a random palette. If combined with <code>color = "random"</code>, each
point will have a random, distinct color.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_pt_size">pt_size</code></td>
<td>
<p>Size of the points. Defaults to 0.1.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_pt_alpha">pt_alpha</code></td>
<td>
<p>Set the transparency of the point cloud.
Defaults to 1. 1 is opaque and 0 is fully transparent.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_triangulation">triangulation</code></td>
<td>
<p>Stem triangulation mesh from TreeQSM. Defaults to NULL.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_tri_color">tri_color</code></td>
<td>
<p>Color of the triangulation mesh.
Accepts hex colors, <code>grDevices::colors()</code>, or &quot;random&quot;.
Defaults to rainbow z-axis.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_tri_palette">tri_palette</code></td>
<td>
<p>Optional triangulation color palette for z values.
Supports the same inputs as palette.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_tri_alpha">tri_alpha</code></td>
<td>
<p>Set the transparency of the triangulation mesh.
Defaults to 1. 1 is opaque and 0 is fully transparent.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_leaves">leaves</code></td>
<td>
<p>Leaf mesh in the <code>rgl::mesh3d()</code> format. Defaults to NULL.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_lf_color">lf_color</code></td>
<td>
<p>Color of the leaves. Defaults to leaf green.
Accepts hex colors, <code>grDevices::colors()</code>,&quot;random&quot;, or &quot;random_vertex&quot;.
<code>lf_color = "random"</code> assigns a random color to all leaves, while
<code>lf_color = "random_vertex"</code> which assigns a random color to each vertex.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_lf_alpha">lf_alpha</code></td>
<td>
<p>Set the transparency of the leaves.
Defaults to 1. 1 is opaque and 0 is fully transparent.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_axes">axes</code></td>
<td>
<p>Show plot axes. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_axes_color">axes_color</code></td>
<td>
<p>Set the axes color. Defaults to black.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_grid">grid</code></td>
<td>
<p>Show plot grid lines. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_grid_color">grid_color</code></td>
<td>
<p>Set grid lines color. Defaults to grey.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_hover">hover</code></td>
<td>
<p>Show cylinder and branch id on mouse hover. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_bg_color">bg_color</code></td>
<td>
<p>Set the background color of the plot.
Accepts hex colors or <code>grDevices::colors()</code>. Defaults to white.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_lit">lit</code></td>
<td>
<p>Enable light source in plot. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_pan">pan</code></td>
<td>
<p>Use right mouse button to pan the plot. Defaults to TRUE.
Panning is disabled when <code>hover = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_normalize">normalize</code></td>
<td>
<p>Normalize the cylinders to 0,0,0. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot_qsm_+3A_mesh">mesh</code></td>
<td>
<p>Plot any <code>rgl::mesh3d()</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>rgl::open3d()</code> plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## TreeQSM
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- update_cylinders(cylinder)
plot_qsm(cylinder)

triangulation &lt;- qsm$triangulation
plot_qsm(triangulation = triangulation)

</code></pre>

<hr>
<h2 id='prune_qsm'>Prune QSM</h2><span id='topic+prune_qsm'></span>

<h3>Description</h3>

<p>Efficiently prune a QSM. The user can prune by cylinder, branch,
and segment ids, or by height or diameter classes, individually, or all at
the same time, and return either the pruned data, the remaining data, or a
binary index of which cylinders are pruned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prune_qsm(
  cylinder,
  cylinder_ids = NULL,
  branch_ids = NULL,
  segment_ids = NULL,
  height_m = NULL,
  diameter_cm = NULL,
  invert = FALSE,
  index = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prune_qsm_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame</p>
</td></tr>
<tr><td><code id="prune_qsm_+3A_cylinder_ids">cylinder_ids</code></td>
<td>
<p>A single or vector of cylinder ids.
Everything connected above the cylinder is pruned.</p>
</td></tr>
<tr><td><code id="prune_qsm_+3A_branch_ids">branch_ids</code></td>
<td>
<p>A single or vector of branch ids.
Everything connected to the branch is pruned.</p>
</td></tr>
<tr><td><code id="prune_qsm_+3A_segment_ids">segment_ids</code></td>
<td>
<p>A single or vector of segment ids.
Everything connected above the segment is pruned.</p>
</td></tr>
<tr><td><code id="prune_qsm_+3A_height_m">height_m</code></td>
<td>
<p>Height class in meters below which all cylinders are pruned.
Valid inputs are numeric to one decimal.</p>
</td></tr>
<tr><td><code id="prune_qsm_+3A_diameter_cm">diameter_cm</code></td>
<td>
<p>Branch diameter class in centimeters below which all
cylinders are pruned. Valid inputs are numeric to one decimal.</p>
</td></tr>
<tr><td><code id="prune_qsm_+3A_invert">invert</code></td>
<td>
<p>Return the remaining or pruned data.
Defaults to TRUE (the remaining data), but can be set to FALSE.</p>
</td></tr>
<tr><td><code id="prune_qsm_+3A_index">index</code></td>
<td>
<p>Returns a column index called <code>pruning</code> indicating if the
cylinder is pruned (1) or un-pruned (0).
Defaults to FALSE, but can be set to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load QSM
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- update_cylinders(cylinder)

## Pruning Index
prune1 &lt;- prune_qsm(cylinder, height_m = 2, index = TRUE)
plot_qsm(prune1, color = pruning, palette = "blue2red")

## Remaining
prune2 &lt;- prune_qsm(cylinder, height_m = 2, invert = FALSE)
plot_qsm(prune2)

## Pruned
prune3 &lt;- prune_qsm(cylinder, height_m = 2, invert = TRUE)
plot_qsm(prune3)

</code></pre>

<hr>
<h2 id='qsm_summary'>QSM Summary</h2><span id='topic+qsm_summary'></span>

<h3>Description</h3>

<p><code>qsm_summary</code> is deprecated and will be removed in a future version. Use <code>summarise_qsm()</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qsm_summary(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qsm_summary_+3A_...">...</code></td>
<td>
<p>function inputs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list
</p>

<hr>
<h2 id='run_rtwig'>Run Real Twig</h2><span id='topic+run_rtwig'></span>

<h3>Description</h3>

<p>Run the Real Twig correction and calculate tree metrics for
supported QSM formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_rtwig(
  filename,
  twig_radius,
  metrics = TRUE,
  version = NULL,
  smooth = TRUE,
  standardise = FALSE,
  broken_branch = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_rtwig_+3A_filename">filename</code></td>
<td>
<p>file path to QSM (.mat, .csv, .json)</p>
</td></tr>
<tr><td><code id="run_rtwig_+3A_twig_radius">twig_radius</code></td>
<td>
<p>Twig radius in millimeters</p>
</td></tr>
<tr><td><code id="run_rtwig_+3A_metrics">metrics</code></td>
<td>
<p>Calculate tree metrics. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="run_rtwig_+3A_version">version</code></td>
<td>
<p>If using a specific version of TreeQSM, the user can specify
the version (e.g. 2.4.1, 2.0, etc.).</p>
</td></tr>
<tr><td><code id="run_rtwig_+3A_smooth">smooth</code></td>
<td>
<p>Defaults to TRUE if using TreeQSM. Can be set to FALSE.</p>
</td></tr>
<tr><td><code id="run_rtwig_+3A_standardise">standardise</code></td>
<td>
<p>Standardise QSM cylinder data.
Defaults to FALSE, but can be set to TRUE.</p>
</td></tr>
<tr><td><code id="run_rtwig_+3A_broken_branch">broken_branch</code></td>
<td>
<p>Enable or disable the broken branch filter.
Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="run_rtwig_+3A_...">...</code></td>
<td>
<p>Additional arguments allowing standardise and standardize to be
used as synonyms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns cylinder data frame or list if metrics is true.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## TreeQSM
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- run_rtwig(file, twig_radius = 4.23)
str(qsm$cylinder)

</code></pre>

<hr>
<h2 id='smooth_qsm'>Smooth QSM</h2><span id='topic+smooth_qsm'></span>

<h3>Description</h3>

<p>Visually smooth a QSM by ensuring the midpoints of all cylinders
are connected. Only TreeQSM is supported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth_qsm(cylinder)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smooth_qsm_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- update_cylinders(cylinder)

## Before Smoothing
plot_qsm(cylinder)

## After Smoothing
cylinder &lt;- smooth_qsm(cylinder)
plot_qsm(cylinder)

</code></pre>

<hr>
<h2 id='standardise_qsm'>Standardise QSM</h2><span id='topic+standardise_qsm'></span><span id='topic+standardize_qsm'></span>

<h3>Description</h3>

<p>All QSM variables are renamed and reordered a standardised
format across the supported QSM software for a consistent experience.
All internal rTwig functions use these standardised names for consistency.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standardise_qsm(cylinder)

standardize_qsm(cylinder)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="standardise_qsm_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Renames supported QSM software output columns to be consistent.
All names are lower case and underscore delimited. See the dictionary
vignette for a detailed description of column names. A consistent QSM format
ensures maximum compatibility when analyzing QSMs made with different
software. This function can be run either before or after
<code>update_cylinders()</code> has been run, or at any stage.
</p>
<p><code>standardise_qsm()</code> and <code>standardise_qsm()</code> are synonyms.
</p>


<h3>Value</h3>

<p>Returns a data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## TreeQSM Processing Chain
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- standardise_qsm(cylinder)
str(cylinder)

## SimpleForest Processing Chain
file &lt;- system.file("extdata/QSM.csv", package = "rTwig")
cylinder &lt;- read.csv(file)
cylinder &lt;- standardise_qsm(cylinder)
str(cylinder)

## aRchi Processing Chain
file &lt;- system.file("extdata/QSM2.csv", package = "rTwig")
cylinder &lt;- read.csv(file)
cylinder &lt;- standardise_qsm(cylinder)
str(cylinder)

</code></pre>

<hr>
<h2 id='summarise_qsm'>Summarise QSM</h2><span id='topic+summarise_qsm'></span><span id='topic+summarize_qsm'></span>

<h3>Description</h3>

<p>Generates a simple QSM summary. The summary includes basic tree
metrics, such as DBH, total height, and also volume and surface area
arranged by totals and branching order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_qsm(cylinder, radius, triangulation = NULL)

summarize_qsm(cylinder, radius, triangulation = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarise_qsm_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame</p>
</td></tr>
<tr><td><code id="summarise_qsm_+3A_radius">radius</code></td>
<td>
<p>Radius column name either quoted or unquoted.</p>
</td></tr>
<tr><td><code id="summarise_qsm_+3A_triangulation">triangulation</code></td>
<td>
<p>Optional QSM triangulation list. Only supports TreeQSM.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summarise_qsm()</code> and <code>summarize_qsm()</code> are synonyms.
</p>


<h3>Value</h3>

<p>Returns a list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## SimpleForest Processing Chain
file &lt;- system.file("extdata/QSM.csv", package = "rTwig")
cylinder &lt;- read.csv(file)
cylinder &lt;- update_cylinders(cylinder)
summarise_qsm(cylinder, radius)

# TreeQSM Triangulation
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- update_cylinders(cylinder)
summarise_qsm(cylinder, radius, triangulation = qsm$triangulation)

</code></pre>

<hr>
<h2 id='tree_metrics'>Tree Metrics</h2><span id='topic+tree_metrics'></span>

<h3>Description</h3>

<p>Calculates tree metrics from a QSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tree_metrics(cylinder, verify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tree_metrics_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame</p>
</td></tr>
<tr><td><code id="tree_metrics_+3A_verify">verify</code></td>
<td>
<p>Verify QSM topology. Defaults to TRUE. If <code>verify = TRUE</code>,
only topologically connected structures (e.g. a whole a tree or an
individual branch) are eligible to run. This ensures all metrics are correct
and verified. If <code>verify = FALSE</code>, the metrics are  run, but not verified.
This is strongly discouraged, but can enable the calculation of tree metrics
on topologically disconnected structures.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates detailed tree, branch, and segment metrics from a QSM.
Valid inputs require a connected QSM, which can be a whole tree or an
individual branch. The outputs include all of the standard outputs from
TreeQSM, and also additional variables, including, but not limited to,
growth length, reverse branch order, branch segment or node relationships,
and distances from twigs and the base of the tree, across various
distribution metrics. Also included is a simulated point cloud of the tree,
based on the QSM cylinder radii. When corrected with Real Twig, this allows
for the testing and validation of point cloud diameter overestimation
throughout the tree.
</p>


<h3>Value</h3>

<p>Returns a list of tree metric data frames and a synthetic point cloud
</p>


<h3>References</h3>

<p>Raumonen P, Kaasalainen M, Åkerblom M, Kaasalainen S, Kaartinen H, Vastaranta M, Holopainen M, Disney M, Lewis P (2013).
&ldquo;Fast Automatic Precision Tree Models from Terrestrial Laser Scanner Data.&rdquo;
<em>Remote Sensing</em>, <b>5</b>(2), 491&ndash;520.
<a href="https://doi.org/10.3390/rs5020491">doi:10.3390/rs5020491</a>.
</p>
<p>Hackenberg J, Spiecker H, Calders K, Disney M, Raumonen P (2015).
&ldquo;SimpleTree —An Efficient Open Source Tool to Build Tree Models from TLS Clouds.&rdquo;
<em>Forests</em>, <b>6</b>(11), 4245&ndash;4294.
<a href="https://doi.org/10.3390/f6114245">doi:10.3390/f6114245</a>.
</p>
<p>Hackenberg J, Bontemps J (2023).
&ldquo;Improving quantitative structure models with filters based on allometric scaling theory.&rdquo;
<em>Applied Geomatics</em>, <b>15</b>.
<a href="https://doi.org/10.1007/s12518-023-00537-4">doi:10.1007/s12518-023-00537-4</a>.
</p>
<p>Yang W, Wilkes P, Vicari MB, Hand K, Calders K, Disney M (2024).
&ldquo;Treegraph: tree architecture from terrestrial laser scanning point clouds.&rdquo;
<em>Remote Sensing in Ecology and Conservation</em>.
ISSN 2056-3485, <a href="https://doi.org/10.1002/rse2.399">doi:10.1002/rse2.399</a>.
</p>
<p>Smith D, Sperry J, Enquist B, Savage V, McCulloh K, Bentley L (2013).
&ldquo;Deviation from symmetrically self-similar branching in trees predicts altered hydraulics, mechanics, light interception and metabolic scaling.&rdquo;
<em>The New phytologist</em>, <b>201</b>.
<a href="https://doi.org/10.1111/nph.12487">doi:10.1111/nph.12487</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## TreeQSM Processing Chain
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
cylinder &lt;- import_treeqsm(file)$cylinder
cylinder &lt;- update_cylinders(cylinder)
metrics &lt;- tree_metrics(cylinder)
names(metrics)

## SimpleForest Processing Chain
file &lt;- system.file("extdata/QSM.csv", package = "rTwig")
cylinder &lt;- read.csv(file)
cylinder &lt;- update_cylinders(cylinder)
metrics &lt;- tree_metrics(cylinder)
names(metrics)

</code></pre>

<hr>
<h2 id='twigs'>Twig Species Database</h2><span id='topic+twigs'></span>

<h3>Description</h3>

<p>Database of twig radii by tree species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twigs
</code></pre>


<h3>Format</h3>



<h4><code>twigs</code></h4>

<p>A data frame containing twig radii measurements
</p>

<dl>
<dt>scientific_name</dt><dd><p>The tree's genus and species</p>
</dd>
<dt>radius_mm</dt><dd><p>The average twig radius in millimeters</p>
</dd>
<dt>n</dt><dd><p>The twig measurement sample size</p>
</dd>
<dt>min</dt><dd><p>The minimum twig radii from the samples</p>
</dd>
<dt>max</dt><dd><p>The maximum twig radii from the samples</p>
</dd>
<dt>std</dt><dd><p>The standard deviation of twig radii</p>
</dd>
<dt>cv</dt><dd><p>The coefficient of variation of twig radii</p>
</dd>
</dl>



<hr>
<h2 id='twigs_index'>Twig Index Database</h2><span id='topic+twigs_index'></span>

<h3>Description</h3>

<p>Database of twig radii by size index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twigs_index
</code></pre>


<h3>Format</h3>



<h4><code>twigs_index</code></h4>

<p>A data frame containing twig radii measurements
</p>

<dl>
<dt>size_index</dt><dd><p>The twig size index</p>
</dd>
<dt>radius_mm</dt><dd><p>The average twig radius in millimeters</p>
</dd>
<dt>n</dt><dd><p>The twig measurement sample size</p>
</dd>
<dt>min</dt><dd><p>The minimum twig radii from the samples</p>
</dd>
<dt>max</dt><dd><p>The maximum twig radii from the samples</p>
</dd>
<dt>std</dt><dd><p>The standard deviation of twig radii</p>
</dd>
<dt>cv</dt><dd><p>The coefficient of variation of twig radii</p>
</dd>
</dl>



<hr>
<h2 id='update_cylinders'>Update Cylinders</h2><span id='topic+update_cylinders'></span>

<h3>Description</h3>

<p>Updates the QSM cylinder data in preparation for radii correction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_cylinders(cylinder)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_cylinders_+3A_cylinder">cylinder</code></td>
<td>
<p>QSM cylinder data frame</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Updates and verifies parent-child cylinder relationships and
calculates new variables and metrics found throughout the supported QSM
software. <code>update_cylinders()</code> is required to run all rTwig functions, and
is run automatically if rTwig detects a new QSM.
</p>


<h3>Value</h3>

<p>Returns a data frame
</p>


<h3>References</h3>

<p>Hackenberg J, Spiecker H, Calders K, Disney M, Raumonen P (2015).
&ldquo;SimpleTree —An Efficient Open Source Tool to Build Tree Models from TLS Clouds.&rdquo;
<em>Forests</em>, <b>6</b>(11), 4245&ndash;4294.
<a href="https://doi.org/10.3390/f6114245">doi:10.3390/f6114245</a>.
</p>
<p>Hackenberg J, Bontemps J (2023).
&ldquo;Improving quantitative structure models with filters based on allometric scaling theory.&rdquo;
<em>Applied Geomatics</em>, <b>15</b>.
<a href="https://doi.org/10.1007/s12518-023-00537-4">doi:10.1007/s12518-023-00537-4</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## TreeQSM Processing Chain
file &lt;- system.file("extdata/QSM.mat", package = "rTwig")
qsm &lt;- import_treeqsm(file)
cylinder &lt;- qsm$cylinder
cylinder &lt;- update_cylinders(cylinder)
str(cylinder)

## SimpleForest Processing Chain
file &lt;- system.file("extdata/QSM.csv", package = "rTwig")
cylinder &lt;- read.csv(file)
cylinder &lt;- update_cylinders(cylinder)
str(cylinder)

## aRchi Processing Chain
file &lt;- system.file("extdata/QSM2.csv", package = "rTwig")
cylinder &lt;- read.csv(file)
cylinder &lt;- update_cylinders(cylinder)
str(cylinder)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
