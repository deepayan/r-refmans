<!DOCTYPE html><html lang="en"><head><title>Help for package ecipex</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ecipex}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ecipex-package'><p>Efficient Calculation of Fine Structure Isotope Patterns via Fourier Transforms of Simplex-Based Elemental Models</p></a></li>
<li><a href='#ecipex'><p>Calculate fine structure isotope pattern</p></a></li>
<li><a href='#nistiso'><p>Masses, isotope patterns and nucleon numbers of the elements</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Efficient Calculation of Fine Structure Isotope Patterns via
Fourier Transforms of Simplex-Based Elemental Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Andreas Ipsen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andreas Ipsen &lt;andreas.b.ipsen@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>CHNOSZ</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a function that quickly computes the fine structure
    isotope patterns of a set of chemical formulas to a given degree of
    accuracy (up to the limit set by errors in floating point arithmetic). A
    data-set comprising the masses and isotopic abundances of individual
    elements is also provided and calculation of isotopic gross structures
    is also supported.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-12</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-13 12:45:41 UTC; Andreas</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-13 23:00:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='ecipex-package'>Efficient Calculation of Fine Structure Isotope Patterns via Fourier Transforms of Simplex-Based Elemental Models</h2><span id='topic+ecipex-package'></span>

<h3>Description</h3>

<p>Provides a function that quickly computes the fine structure
isotope patterns of a set of chemical formulas to a given degree of
accuracy (up to the limit set by errors in floating point arithmetic). A
data-set comprising the masses and isotopic abundances of individual
elements is also provided and calculation of isotopic gross structures
is also supported.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> ecipex</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;">
  Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2020-03-12</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;"> LazyLoad: </td><td style="text-align: left;"> true</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andreas Ipsen
</p>

<hr>
<h2 id='ecipex'>Calculate fine structure isotope pattern</h2><span id='topic+ecipex'></span>

<h3>Description</h3>

<p>This function can calculate either the fine structure isotope
patterns or the gross structure isotope patterns for a given set 
of chemical formulas. It returns the isotope patterns as a list 
of data frames which may be sorted by mass or abundance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ecipex(formulas, isoinfo = ecipex::nistiso, limit = 1e-12,
    id = FALSE, sortby = "abundance", gross = FALSE, groupby = "mass")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecipex_+3A_formulas">formulas</code></td>
<td>
<p>a character vector specifying the
chemical formulas whose isotope patterns are to be
calculated. The elements specified must be present in
<code>isoinfo</code> and must be compatible with
<code>count.elements</code>.</p>
</td></tr>
<tr><td><code id="ecipex_+3A_isoinfo">isoinfo</code></td>
<td>
<p>a data frame that specifies the masses and
isotopic abundances of the elements to be used in the
calculations. Must include the variables <code>element</code>
(the chemical symbol), <code>mass</code> and <code>abundance</code>
so that each row specifies a unique isotope. Defaults to
<code><a href="#topic+nistiso">nistiso</a></code>.</p>
</td></tr>
<tr><td><code id="ecipex_+3A_limit">limit</code></td>
<td>
<p>isotopologues with abundances below this
value are ignored.</p>
</td></tr>
<tr><td><code id="ecipex_+3A_id">id</code></td>
<td>
<p>determines whether the full isotopic
composition of each isotopic variant should be specified
in the output. Setting this to <code>TRUE</code> can increase
memory requirements substantially. This argument has no
effect if <code>gross</code> is set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ecipex_+3A_sortby">sortby</code></td>
<td>
<p>should be one of <code>"abundance"</code> or
<code>"mass"</code>, depending on whether the output should be
sorted by abundance (high to low) or mass (low to high).</p>
</td></tr>
<tr><td><code id="ecipex_+3A_gross">gross</code></td>
<td>
<p>if <code>TRUE</code> the gross isotope
patterns will be returned instead of the fine structure ones.
</p>
</td></tr>
<tr><td><code id="ecipex_+3A_groupby">groupby</code></td>
<td>
<p>determines how the fine structure
isotope patterns are grouped together when the gross structure
isotope patterns are calculated. If it is equal to <code>"mass"</code>
then isotopologues whose masses get rounded to the same integer number are 
grouped together. If it is equal to <code>"nucleons"</code> then 
isotopologues with the same number of nucleons get grouped 
together.  This argument is only used if <code>gross</code> 
is set to <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fine structure isotope pattern of each formula is calculated by
applying the multi-dimensional fast Fourier transform to
a simplex-based representation of each element's isotopic
abundance. The algorithm is most efficient when the atom
counts of the same elements in different formulas are
roughly similar. Performance can also be improved by
increasing <code>limit</code> although this should be done with
care. It is generally not advisable to reduce
<code>limit</code> below its default value, as this can
increase memory requirements significantly and is
unlikely to provide information of any value, since the
natural isotopic abundances can be quite variable. If <code>gross</code> 
is set to <code>TRUE</code> then the gross structure isotope patterns 
are calculated directly from the fine structure isotope patterns.
Note that for centroids with extremely low abundances (say less than
one billionth of the total) the centroided masses
can be somewhat inaccurate due to floating point errors.
</p>


<h3>Value</h3>

<p>A list of data frames containing the fine structure
isotope patterns of each formula in <code>formulas</code>. The
list names are determined by <code>formulas</code>, so that the
isotope pattern of any given formula is easily extracted.
If <code>id</code> is set to <code>TRUE</code>, the output will
include additional columns listing the counts of each
distinct isotope of each element. If <code>gross</code>
is set to <code>TRUE</code>, the output will instead contain the
gross structure isotope patterns of each formula in <code>formulas</code>.
</p>


<h3>References</h3>

<p>Ipsen, A., Efficient Calculation of Exact Fine Structure Isotope Patterns via the Multidimensional Fourier Transform, Anal. Chem., 2014, 86 (11), pp 5316-5322
</p>
<p><a href="http://pubs.acs.org/doi/abs/10.1021/ac500108n">http://pubs.acs.org/doi/abs/10.1021/ac500108n</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nistiso">nistiso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a simple molecule
iso_H2O &lt;- ecipex("H2O")[[1]]
iso_H2O

# reduce limit for larger molecule and sort output by mass
iso_C254H338N65O75S6 &lt;- ecipex("C254H338N65O75S6", limit=1e-8, sortby="mass")[[1]]
head(iso_C254H338N65O75S6)

# check that sum of all abundances is still close to 1
sum(iso_C254H338N65O75S6$abundance)

# inspect the full isotope pattern, the fine structure, and the full pattern on a log scale
par(mfrow=c(1,3))
plot(iso_C254H338N65O75S6, t="h")
plot(iso_C254H338N65O75S6, t="h", xlim=c(5691.29, 5691.31))
plot(iso_C254H338N65O75S6, t="h", log="y")

# calculate isotopic abundances with enriched Carbon-13
modifiediso &lt;- nistiso 
modifiediso[modifiediso$element=="C",3] &lt;- c(0.9, 0.1)
ecipex("C2", isoinfo=modifiediso)

# the isotope pattern can be calculated quickly if the elements only have 2 stable isotopes
system.time(iso_C10000H10000 &lt;- ecipex("C10000H10000", limit=1e-8)[[1]])

# this is typically a more demanding calculation because S has 4 stable isotopes
system.time(iso_S50 &lt;- ecipex("S50", limit=1e-8)[[1]])

# if the limit is greater than the most abundant isotopologue the output is uninformative
iso_C10000H10000_useless &lt;- ecipex("C10000H10000", limit=0.015)

# calculate the isotope patterns of multiple formulas, and include the detailed isotopic composition
multisopatterns &lt;- ecipex(c("H2O", "CO2", "O2", "C8H18", "C60"), sortby="mass", id=TRUE)

# inspect C8H18 in particular
multisopatterns$C8H18

# make sure all abundances are close to 1
sapply(multisopatterns, function(x){sum(x$abundance)})

# due to floating point errors, the following are not identical
iso_C60_almostComplete &lt;- ecipex("C60", limit= 0)[[1]]
iso_C60_reallyComplete &lt;- ecipex("C60", limit= -1)[[1]]
# the latter includes negative isotopic abundances because the floating point errors are orders of 
# magnitude greater than the "true" abundances. The variations in natural isotopic abundances will
# typically be much greater than floating point errors.

# calculate the gross structure isotope pattern, grouping the fine structure isotopologues by mass
ecipex("C6H14N4O2", sortby="mass", gross=TRUE, groupby="mass")
</code></pre>

<hr>
<h2 id='nistiso'>Masses, isotope patterns and nucleon numbers of the elements</h2><span id='topic+nistiso'></span>

<h3>Description</h3>

<p>A data frame giving the masses, standard isotopic
abundances and nucleon numbers of most chemical elements
as provided by the Physical Measurement Laboratory of the
National Institute of Standards and Technology (but taken
from separate publications). It includes the four
variables <code>element</code> (the chemical symbol),
<code>mass</code>, <code>abundance</code> and <code>nucleons</code>,
arranged so that each isotope is uniquely specified by
one row.
</p>


<h3>References</h3>

<p><a href="http://www.nist.gov/pml/data/comp.cfm">http://www.nist.gov/pml/data/comp.cfm</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
