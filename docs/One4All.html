<!DOCTYPE html><html><head><title>Help for package One4All</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {One4All}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#certificate_df'><p>Generate a data frame with certificate information</p></a></li>
<li><a href='#check_exists_in_zip'><p>Check if a file exists in a zip file</p></a></li>
<li><a href='#check_for_malicious_files'><p>Check for Malicious Files</p></a></li>
<li><a href='#check_images'><p>Check and format image URLs</p></a></li>
<li><a href='#check_other_hyperlinks'><p>Check and format non-image hyperlinks</p></a></li>
<li><a href='#checkLuhn'><p>Check if a number passes the Luhn algorithm</p></a></li>
<li><a href='#create_valid_excel'><p>Create a formatted Excel file based on validation rules</p></a></li>
<li><a href='#invalid_example'><p>Invalid Example Data</p></a></li>
<li><a href='#is.POSIXct'><p>Check if an object is of class POSIXct</p></a></li>
<li><a href='#name_data'><p>Name datasets</p></a></li>
<li><a href='#query_document_by_object_id'><p>Query MongoDB Document by ObjectID</p></a></li>
<li><a href='#read_data'><p>Read and format data from csv or xlsx files</p></a></li>
<li><a href='#read_rules'><p>Read rules from a file</p></a></li>
<li><a href='#reformat_rules'><p>Reformats the rules</p></a></li>
<li><a href='#remote_download'><p>Download Structured Data from Remote Sources</p></a></li>
<li><a href='#remote_raw_download'><p>Download Raw Data from Remote Sources</p></a></li>
<li><a href='#remote_share'><p>Remote Share Function</p></a></li>
<li><a href='#rows_for_rules'><p>Rows for rules</p></a></li>
<li><a href='#rules_broken'><p>Broken rules</p></a></li>
<li><a href='#run_app'><p>Run Validator app</p></a></li>
<li><a href='#test_profanity'><p>Test for profanity in a string</p></a></li>
<li><a href='#test_rules'><p>Rules data</p></a></li>
<li><a href='#valid_example'><p>Valid Example Data</p></a></li>
<li><a href='#validate_data'><p>Validate data based on specified rules</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Validate, Share, and Download Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-29</td>
</tr>
<tr>
<td>Description:</td>
<td>Designed to enhance data validation and management processes by employing a set of functions that read a set of rules from a 'CSV' or 'Excel' file and apply them to a dataset. Funded by the National Renewable Energy Laboratory and Possibility Lab, maintained by the Moore Institute for Plastic Pollution Research.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Moore-Institute-4-Plastic-Pollution-Res/One4All">https://github.com/Moore-Institute-4-Plastic-Pollution-Res/One4All</a>,
<a href="https://moore-institute-4-plastic-pollution-res.github.io/One4All/">https://moore-institute-4-plastic-pollution-res.github.io/One4All/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Moore-Institute-4-Plastic-Pollution-Res/One4All/issues">https://github.com/Moore-Institute-4-Plastic-Pollution-Res/One4All/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>shiny, dplyr, validate, digest, data.table, ckanr, openxlsx,
lexicon, readr, readxl, tibble, aws.s3, rlang, jsonlite,
mongolite, httr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), config, DT,
shinythemes, shinyWidgets, bs4Dash, shinyjs, listviewer, RCurl,
purrr, stringr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-29 22:37:45 UTC; hannahsherrod</td>
</tr>
<tr>
<td>Author:</td>
<td>Hannah Sherrod <a href="https://orcid.org/0009-0001-0497-8693"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Nick Leong <a href="https://orcid.org/0009-0008-3313-4132"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Hannah Hapich <a href="https://orcid.org/0000-0003-0000-6632"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Fabian Gomez [aut],
  Shelly Moore [aut],
  Win Cowger <a href="https://orcid.org/0000-0001-9226-3104"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Scott Coffin [ctb],
  Tony Hale [ctb],
  Diana Lin [ctb],
  Gemma Shusterman [ctb],
  Rebecca Sutton [ctb],
  Adam Wong [ctb],
  Haig Minasian [ctb],
  Holden Ford [ctb],
  Anja Oca [ctb],
  Richard Nelson [ctb],
  Leah Thornton Hampton [ctb],
  Libby Heeren [ctb],
  Gabriel Daiess [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hannah Sherrod &lt;hannah@mooreplasticresearch.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-29 23:22:35 UTC</td>
</tr>
</table>
<hr>
<h2 id='certificate_df'>Generate a data frame with certificate information</h2><span id='topic+certificate_df'></span>

<h3>Description</h3>

<p>This function creates a data frame with certificate information including the current time,
data and rule hashes, package version, and web hash.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>certificate_df(x, time = Sys.time())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="certificate_df_+3A_x">x</code></td>
<td>
<p>A list containing 'data_formatted' and 'rules' elements.</p>
</td></tr>
<tr><td><code id="certificate_df_+3A_time">time</code></td>
<td>
<p>the time the certificate is generated, can be passed a value or uses current system time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with certificate information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
certificate_df(x = list(data_formatted = data.frame(a = 1:3, b = 4:6),
                        rules = validate::validator(a &gt; 0, b &gt; 0)),
               time = Sys.time())

</code></pre>

<hr>
<h2 id='check_exists_in_zip'>Check if a file exists in a zip file</h2><span id='topic+check_exists_in_zip'></span>

<h3>Description</h3>

<p>This function checks if a file with a given name exists in a specified zip file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_exists_in_zip(zip_path, file_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_exists_in_zip_+3A_zip_path">zip_path</code></td>
<td>
<p>A character string representing the path of the zip file.</p>
</td></tr>
<tr><td><code id="check_exists_in_zip_+3A_file_name">file_name</code></td>
<td>
<p>A character string representing the name of the file to check.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating whether the file exists in the zip file (TRUE) or not (FALSE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
check_exists_in_zip(zip_path = "/path/to/your.zip", file_name = "file/in/zip.csv")

## End(Not run)
</code></pre>

<hr>
<h2 id='check_for_malicious_files'>Check for Malicious Files</h2><span id='topic+check_for_malicious_files'></span>

<h3>Description</h3>

<p>This function checks for the presence of files with extensions known to be associated with malicious activities. 
The function can be used to screen zip files or individual files for these potentially dangerous file types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_for_malicious_files(files)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_for_malicious_files_+3A_files">files</code></td>
<td>
<p>A character vector of file paths. These can be paths to zip files or individual files.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating if any of the files in the input have a malicious file extension. Returns 'TRUE' if any malicious file is found, otherwise 'FALSE'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  check_for_malicious_files("path'(s)'/to/your/files")
  check_for_malicious_files(utils::unzip("path/to/your/file.zip", list = TRUE)$Name)

## End(Not run)

</code></pre>

<hr>
<h2 id='check_images'>Check and format image URLs</h2><span id='topic+check_images'></span>

<h3>Description</h3>

<p>This function checks if the input string contains an image URL (PNG or JPG) and formats it as an HTML img tag with a specified height.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_images(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_images_+3A_x">x</code></td>
<td>
<p>A character string to check for image URLs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with the HTML img tag if an image URL is found, otherwise the input string.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>check_images("https://example.com/image.png")
check_images("https://example.com/image.jpg")
check_images("https://example.com/text")
</code></pre>

<hr>
<h2 id='check_other_hyperlinks'>Check and format non-image hyperlinks</h2><span id='topic+check_other_hyperlinks'></span>

<h3>Description</h3>

<p>This function checks if the input string contains a non-image hyperlink and formats it as an HTML anchor tag.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_other_hyperlinks(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_other_hyperlinks_+3A_x">x</code></td>
<td>
<p>A character string to check for non-image hyperlinks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with the HTML anchor tag if a non-image hyperlink is found, otherwise the input string.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>check_other_hyperlinks("https://example.com/page")
check_other_hyperlinks("https://example.com/image.png")
check_other_hyperlinks("https://example.com/image.jpg")
</code></pre>

<hr>
<h2 id='checkLuhn'>Check if a number passes the Luhn algorithm</h2><span id='topic+checkLuhn'></span>

<h3>Description</h3>

<p>This function checks if a given number passes the Luhn algorithm. It is commonly used to validate credit card numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkLuhn(number)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkLuhn_+3A_number">number</code></td>
<td>
<p>A character string of the number to check against the Luhn algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating whether the number passes the Luhn algorithm (TRUE) or not (FALSE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>checkLuhn("4532015112830366") # TRUE
checkLuhn("4532015112830367") # FALSE
</code></pre>

<hr>
<h2 id='create_valid_excel'>Create a formatted Excel file based on validation rules</h2><span id='topic+create_valid_excel'></span>

<h3>Description</h3>

<p>This function creates an Excel file with conditional formatting and data validation
based on the given validation rules in a CSV or Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_valid_excel(
  file_rules,
  negStyle = createStyle(fontColour = "#9C0006", bgFill = "#FFC7CE"),
  posStyle = createStyle(fontColour = "#006100", bgFill = "#C6EFCE"),
  row_num = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_valid_excel_+3A_file_rules">file_rules</code></td>
<td>
<p>A CSV or Excel file containing validation rules.</p>
</td></tr>
<tr><td><code id="create_valid_excel_+3A_negstyle">negStyle</code></td>
<td>
<p>Style to apply for negative conditions (default is red text on a pink background).</p>
</td></tr>
<tr><td><code id="create_valid_excel_+3A_posstyle">posStyle</code></td>
<td>
<p>Style to apply for positive conditions (default is green text on a light green background).</p>
</td></tr>
<tr><td><code id="create_valid_excel_+3A_row_num">row_num</code></td>
<td>
<p>Number of rows to create in the output file (default is 1000).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A workbook object containing the formatted Excel file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("test_rules")
create_valid_excel(file_rules = test_rules)
</code></pre>

<hr>
<h2 id='invalid_example'>Invalid Example Data</h2><span id='topic+invalid_example'></span>

<h3>Description</h3>

<p>This is a list containing three data frames as an example of invalid_example.
</p>


<h3>Format</h3>

<p>A list with 3 data frames:
</p>

<dl>
<dt>data_frame_1</dt><dd><p>A data frame with 18 variables: MethodologyID, SamplingDevice, AirFiltration, AirFiltrationType, ClothingPolicy, NonplasticPolicy, SealedEnvironment, SealedEnvironmentType, SieveMeshSizes, FilterType, FilterDiameter, FilterPoreSize, VisIDMethod, VisualSoftware, PickingStrategy, VisMagnification, MatIDMethod, MatIDSoftware</p>
</dd>
<dt>data_frame_2</dt><dd><p>A data frame with 8 variables: SampleID, OwnerOrganization, AnalysisOrganization, ReportingOrganization, Latitude, Longitude, CollectionDate, SampleVolume</p>
</dd>
<dt>data_frame_3</dt><dd><p>A data frame with 17 variables: ParticleID, MethodologyID, SampleID, PhotoID, SpectraID, FinalAnalysisDate, Comments, Polymer, Morphology, Color, Length, Width, Height, Mass, SurfaceArea, Volume, Tactile</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data("invalid_example")

</code></pre>

<hr>
<h2 id='is.POSIXct'>Check if an object is of class POSIXct</h2><span id='topic+is.POSIXct'></span>

<h3>Description</h3>

<p>This function checks if the given object is of class POSIXct.
It returns TRUE if the object inherits the POSIXct class, otherwise FALSE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.POSIXct(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.POSIXct_+3A_x">x</code></td>
<td>
<p>An object to be tested for POSIXct class inheritance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating if the input object is of class POSIXct.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- as.POSIXct("2021-01-01")
is.POSIXct(x) # TRUE

y &lt;- Sys.Date()
is.POSIXct(y) # FALSE

</code></pre>

<hr>
<h2 id='name_data'>Name datasets</h2><span id='topic+name_data'></span>

<h3>Description</h3>

<p>This function extracts the names of the datasets provided in the input files.
If specific data names are provided, they are used, otherwise the function tries
to extract the names from the files themselves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>name_data(files_data, data_names = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="name_data_+3A_files_data">files_data</code></td>
<td>
<p>A vector of file paths or list of data frames.</p>
</td></tr>
<tr><td><code id="name_data_+3A_data_names">data_names</code></td>
<td>
<p>A vector of names to be assigned to datasets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of dataset names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>name_data(files_data = c("path/to/data1.csv", "path/to/data2.csv"))
name_data(files_data = c("path/to/data.xlsx"), data_names = c("sheet1", "sheet2"))

</code></pre>

<hr>
<h2 id='query_document_by_object_id'>Query MongoDB Document by ObjectID</h2><span id='topic+query_document_by_object_id'></span>

<h3>Description</h3>

<p>This function queries a mongodb database using its API to retrieve a document by its ObjectID.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>query_document_by_object_id(apiKey, collection, database, dataSource, objectId)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="query_document_by_object_id_+3A_apikey">apiKey</code></td>
<td>
<p>The API key for accessing the MongoDB API.</p>
</td></tr>
<tr><td><code id="query_document_by_object_id_+3A_collection">collection</code></td>
<td>
<p>The name of the collection in the MongoDB database.</p>
</td></tr>
<tr><td><code id="query_document_by_object_id_+3A_database">database</code></td>
<td>
<p>The name of the MongoDB database.</p>
</td></tr>
<tr><td><code id="query_document_by_object_id_+3A_datasource">dataSource</code></td>
<td>
<p>The data source in MongoDB.</p>
</td></tr>
<tr><td><code id="query_document_by_object_id_+3A_objectid">objectId</code></td>
<td>
<p>The object ID of the document to query.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The queried document.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
result &lt;- query_document_by_object_id(
        apiKey = 'your_mongodb_api_key',
        collection = 'your_mongodb_collection',
        database = 'your_database',
        dataSource = 'your_dataSource',
        objectId = 'example_object_id'
    )

## End(Not run)
</code></pre>

<hr>
<h2 id='read_data'>Read and format data from csv or xlsx files</h2><span id='topic+read_data'></span>

<h3>Description</h3>

<p>Read and format data from csv or xlsx files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_data(files_data, data_names = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_data_+3A_files_data">files_data</code></td>
<td>
<p>List of files to be read</p>
</td></tr>
<tr><td><code id="read_data_+3A_data_names">data_names</code></td>
<td>
<p>Optional vector of names for the data frames</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read_data(files_data = valid_example, data_names = c("methodology", "particles", "samples"))
</code></pre>

<hr>
<h2 id='read_rules'>Read rules from a file</h2><span id='topic+read_rules'></span>

<h3>Description</h3>

<p>This function reads rules from a file or a data frame. 
The file can be in csv or xlsx format. 
The data should have the column names &quot;name&quot;, &quot;description&quot;, &quot;dataset&quot;, &quot;valid example&quot;, &quot;severity&quot;, &quot;rule&quot;.
The function also checks that the rules do not contain sensitive words and that 
all the rules fields are character type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_rules(file_rules)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_rules_+3A_file_rules">file_rules</code></td>
<td>
<p>The file containing the rules. Can be a CSV or XLSX file, or a data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the rules.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
read_rules("path/to/rules") 

## End(Not run)

</code></pre>

<hr>
<h2 id='reformat_rules'>Reformats the rules</h2><span id='topic+reformat_rules'></span>

<h3>Description</h3>

<p>This function is responsible for handling the rule reformating, dataset handling
and foreign key checks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reformat_rules(rules, data_formatted, zip_data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reformat_rules_+3A_rules">rules</code></td>
<td>
<p>A data.frame containing rules to be reformatted.</p>
</td></tr>
<tr><td><code id="reformat_rules_+3A_data_formatted">data_formatted</code></td>
<td>
<p>A named list of data.frames with data.</p>
</td></tr>
<tr><td><code id="reformat_rules_+3A_zip_data">zip_data</code></td>
<td>
<p>A file path to a zip folder with additional data to check.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with reformatted rules.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("test_rules")
data("valid_example")
reformat_rules(rules = test_rules, data_formatted = valid_example)
</code></pre>

<hr>
<h2 id='remote_download'>Download Structured Data from Remote Sources</h2><span id='topic+remote_download'></span>

<h3>Description</h3>

<p>This function downloads data from remote sources like CKAN, AWS S3, and MongoDB.
It retrieves the data based on the hashed_data identifier and assumes the data is stored using the same naming conventions provided in the 'remote_share' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remote_download(
  hashed_data = NULL,
  ckan_url,
  ckan_key,
  ckan_package,
  s3_key_id,
  s3_secret_key,
  s3_region,
  s3_bucket,
  mongo_key,
  mongo_collection
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remote_download_+3A_hashed_data">hashed_data</code></td>
<td>
<p>A character string representing the hashed identifier of the data to be downloaded.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_ckan_url">ckan_url</code></td>
<td>
<p>A character string representing the CKAN base URL.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_ckan_key">ckan_key</code></td>
<td>
<p>A character string representing the CKAN API key.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_ckan_package">ckan_package</code></td>
<td>
<p>A character string representing the CKAN package identifier.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_s3_key_id">s3_key_id</code></td>
<td>
<p>A character string representing the AWS S3 access key ID.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_s3_secret_key">s3_secret_key</code></td>
<td>
<p>A character string representing the AWS S3 secret access key.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_s3_region">s3_region</code></td>
<td>
<p>A character string representing the AWS S3 region.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_s3_bucket">s3_bucket</code></td>
<td>
<p>A character string representing the AWS S3 bucket name.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_mongo_key">mongo_key</code></td>
<td>
<p>A character string representing the mongo key.</p>
</td></tr>
<tr><td><code id="remote_download_+3A_mongo_collection">mongo_collection</code></td>
<td>
<p>A character string representing the mongo collection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list containing the downloaded datasets.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  downloaded_data &lt;- remote_download(hashed_data = "example_hash",
                                     ckan_url = "https://example.com",
                                     ckan_key = "your_ckan_key",
                                     ckan_package = "your_ckan_package",
                                     s3_key_id = "your_s3_key_id",
                                     s3_secret_key = "your_s3_secret_key",
                                     s3_region = "your_s3_region",
                                     s3_bucket = "your_s3_bucket",
                                     mongo_key = "mongo_key",
                                     mongo_collection = "mongo_collection")

## End(Not run)

</code></pre>

<hr>
<h2 id='remote_raw_download'>Download Raw Data from Remote Sources</h2><span id='topic+remote_raw_download'></span>

<h3>Description</h3>

<p>This function downloads data from remote sources like CKAN and AWS S3.
It retrieves the data based on the hashed_data identifier and assumes the data is stored using the same naming conventions provided in the 'remote_share' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remote_raw_download(
  hashed_data = NULL,
  file_path = NULL,
  ckan_url = NULL,
  ckan_key = NULL,
  ckan_package = NULL,
  s3_key_id = NULL,
  s3_secret_key = NULL,
  s3_region = NULL,
  s3_bucket = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remote_raw_download_+3A_hashed_data">hashed_data</code></td>
<td>
<p>A character string representing the hashed identifier of the data to be downloaded.</p>
</td></tr>
<tr><td><code id="remote_raw_download_+3A_file_path">file_path</code></td>
<td>
<p>location and name of the zip file to create.</p>
</td></tr>
<tr><td><code id="remote_raw_download_+3A_ckan_url">ckan_url</code></td>
<td>
<p>A character string representing the CKAN base URL.</p>
</td></tr>
<tr><td><code id="remote_raw_download_+3A_ckan_key">ckan_key</code></td>
<td>
<p>A character string representing the CKAN API key.</p>
</td></tr>
<tr><td><code id="remote_raw_download_+3A_ckan_package">ckan_package</code></td>
<td>
<p>A character string representing the CKAN package identifier.</p>
</td></tr>
<tr><td><code id="remote_raw_download_+3A_s3_key_id">s3_key_id</code></td>
<td>
<p>A character string representing the AWS S3 access key ID.</p>
</td></tr>
<tr><td><code id="remote_raw_download_+3A_s3_secret_key">s3_secret_key</code></td>
<td>
<p>A character string representing the AWS S3 secret access key.</p>
</td></tr>
<tr><td><code id="remote_raw_download_+3A_s3_region">s3_region</code></td>
<td>
<p>A character string representing the AWS S3 region.</p>
</td></tr>
<tr><td><code id="remote_raw_download_+3A_s3_bucket">s3_bucket</code></td>
<td>
<p>A character string representing the AWS S3 bucket name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Any return objects from the downloads.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  downloaded_data &lt;- remote_raw_download(hashed_data = "example_hash",
                                     file_path = "your/path/file.zip",
                                     ckan_url = "https://example.com",
                                     ckan_key = "your_ckan_key",
                                     ckan_package = "your_ckan_package",
                                     s3_key_id = "your_s3_key_id",
                                     s3_secret_key = "your_s3_secret_key",
                                     s3_region = "your_s3_region",
                                     s3_bucket = "your_s3_bucket")

## End(Not run)

</code></pre>

<hr>
<h2 id='remote_share'>Remote Share Function</h2><span id='topic+remote_share'></span>

<h3>Description</h3>

<p>This function uploads validated data to specified remote repositories,
such as CKAN, Amazon S3, and/or MongoDB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remote_share(
  validation,
  data_formatted,
  files,
  verified,
  valid_rules,
  valid_key,
  ckan_url,
  ckan_key,
  ckan_package,
  url_to_send,
  rules,
  results,
  s3_key_id,
  s3_secret_key,
  s3_region,
  s3_bucket,
  mongo_key,
  mongo_collection,
  old_cert = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remote_share_+3A_validation">validation</code></td>
<td>
<p>A list containing validation information.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_data_formatted">data_formatted</code></td>
<td>
<p>A list containing formatted data.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_files">files</code></td>
<td>
<p>A vector of file paths to upload.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_verified">verified</code></td>
<td>
<p>The secret key provided by the portal maintainer.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_valid_rules">valid_rules</code></td>
<td>
<p>A list of valid rules for the dataset.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_valid_key">valid_key</code></td>
<td>
<p>A list of valid keys.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_ckan_url">ckan_url</code></td>
<td>
<p>The URL of the CKAN instance.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_ckan_key">ckan_key</code></td>
<td>
<p>The API key for the CKAN instance.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_ckan_package">ckan_package</code></td>
<td>
<p>The CKAN package to which the data will be uploaded.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_url_to_send">url_to_send</code></td>
<td>
<p>The URL to send the data.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_rules">rules</code></td>
<td>
<p>A set of rules used for validation.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_results">results</code></td>
<td>
<p>A list containing results of the validation.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_s3_key_id">s3_key_id</code></td>
<td>
<p>AWS ACCESS KEY ID</p>
</td></tr>
<tr><td><code id="remote_share_+3A_s3_secret_key">s3_secret_key</code></td>
<td>
<p>AWS SECRET ACCESS KEY</p>
</td></tr>
<tr><td><code id="remote_share_+3A_s3_region">s3_region</code></td>
<td>
<p>AWS DEFAULT REGION</p>
</td></tr>
<tr><td><code id="remote_share_+3A_s3_bucket">s3_bucket</code></td>
<td>
<p>The name of the Amazon S3 bucket.</p>
</td></tr>
<tr><td><code id="remote_share_+3A_mongo_key">mongo_key</code></td>
<td>
<p>mongo connection url</p>
</td></tr>
<tr><td><code id="remote_share_+3A_mongo_collection">mongo_collection</code></td>
<td>
<p>collection name</p>
</td></tr>
<tr><td><code id="remote_share_+3A_old_cert">old_cert</code></td>
<td>
<p>(Optional) An old certificate to be uploaded alongside the new one to override the previous submission with.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the status and message of the operation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
shared_data &lt;- remote_share(validation = result_valid,
                            data_formatted = result_valid$data_formatted,
                            files = test_file,
                            verified = "your_verified_key",
                            valid_key = "your_valid_key",
                            valid_rules = digest::digest(test_rules),
                            ckan_url = "https://example.com",
                            ckan_key = "your_ckan_key",
                            ckan_package = "your_ckan_package",
                            url_to_send = "https://your-url-to-send.com",
                            rules = test_rules,
                            results = valid_example$results,
                            s3_key_id = "your_s3_key_id",
                            s3_secret_key = "your_s3_secret_key",
                            s3_region = "your_s3_region",
                            s3_bucket = "your_s3_bucket",
                            mongo_key = "your_mongo_key",
                            mongo_collection = "your_mongo_collection",
                            old_cert = NULL
)

## End(Not run)
</code></pre>

<hr>
<h2 id='rows_for_rules'>Rows for rules</h2><span id='topic+rows_for_rules'></span>

<h3>Description</h3>

<p>Get the rows in the data that violate the specified rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rows_for_rules(data_formatted, report, broken_rules, rows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rows_for_rules_+3A_data_formatted">data_formatted</code></td>
<td>
<p>A formatted data frame.</p>
</td></tr>
<tr><td><code id="rows_for_rules_+3A_report">report</code></td>
<td>
<p>A validation report generated by the 'validate' function.</p>
</td></tr>
<tr><td><code id="rows_for_rules_+3A_broken_rules">broken_rules</code></td>
<td>
<p>A data frame with broken rules information.</p>
</td></tr>
<tr><td><code id="rows_for_rules_+3A_rows">rows</code></td>
<td>
<p>A vector of row indices specifying which rules from the suite of rules with errors to check for violations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with rows in the data that violate the specified rules.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("invalid_example")
data("test_rules")
# Generate a validation report
result_invalid &lt;- validate_data(files_data = invalid_example,
                        data_names = c("methodology", "particles", "samples"),
                        file_rules = test_rules)

# Find the broken rules
broken_rules &lt;- rules_broken(results = result_invalid$results[[1]], show_decision = TRUE)

# Get rows for the specified rules
violating_rows &lt;- rows_for_rules(data_formatted = result_invalid$data_formatted[[1]], 
                                 report = result_invalid$report[[1]],
                                 broken_rules = broken_rules,
                                 rows = 1)
</code></pre>

<hr>
<h2 id='rules_broken'>Broken rules</h2><span id='topic+rules_broken'></span>

<h3>Description</h3>

<p>Filter the results of validation to show only broken rules, optionally including successful decisions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rules_broken(results, show_decision)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rules_broken_+3A_results">results</code></td>
<td>
<p>A data frame with validation results.</p>
</td></tr>
<tr><td><code id="rules_broken_+3A_show_decision">show_decision</code></td>
<td>
<p>A logical value to indicate if successful decisions should be included in the output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the filtered results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample validation results data frame
sample_results &lt;- data.frame(
  description = c("Rule 1", "Rule 2", "Rule 3"),
  status = c("error", "success", "error"),
  name = c("rule1", "rule2", "rule3"),
  expression = c("col1 &gt; 0", "col2 &lt;= 5", "col3 != 10"),
  stringsAsFactors = FALSE
)

# Show only broken rules
broken_rules &lt;- rules_broken(sample_results, show_decision = FALSE)
</code></pre>

<hr>
<h2 id='run_app'>Run Validator app</h2><span id='topic+run_app'></span>

<h3>Description</h3>

<p>This wrapper function starts the graphical user interface of the One4All.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_app(path = "system", log = TRUE, ref = "main", test_mode = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_app_+3A_path">path</code></td>
<td>
<p>to store the downloaded app files; defaults to <code>"system"</code>
pointing to <code>system.file(package = "One4All")</code>.</p>
</td></tr>
<tr><td><code id="run_app_+3A_log">log</code></td>
<td>
<p>logical; enables/disables logging to <code><a href="base.html#topic+tempdir">tempdir</a>()</code></p>
</td></tr>
<tr><td><code id="run_app_+3A_ref">ref</code></td>
<td>
<p>git reference; could be a commit, tag, or branch name. Defaults to
&quot;main&quot;. Only change this in case of errors.</p>
</td></tr>
<tr><td><code id="run_app_+3A_test_mode">test_mode</code></td>
<td>
<p>logical; for internal testing only.</p>
</td></tr>
<tr><td><code id="run_app_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="shiny.html#topic+runApp">runApp</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After running this function the One4All GUI should open in a separate
window or in your computer browser.
</p>


<h3>Value</h3>

<p>This function normally does not return any value, see
<code><a href="shiny.html#topic+runGitHub">runGitHub</a>()</code>.
</p>


<h3>Author(s)</h3>

<p>Hannah Sherrod, Nick Leong, Hannah Hapich, Fabian Gomez, Win Cowger
</p>


<h3>See Also</h3>

<p><code><a href="shiny.html#topic+runGitHub">runGitHub</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
run_app()

## End(Not run)

</code></pre>

<hr>
<h2 id='test_profanity'>Test for profanity in a string</h2><span id='topic+test_profanity'></span>

<h3>Description</h3>

<p>This function checks if the input string contains any profane words.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_profanity(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_profanity_+3A_x">x</code></td>
<td>
<p>A character string to check for profanity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating whether the input string contains no profane words.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test_profanity("This is a clean sentence.")
test_profanity("This sentence contains a badword.")
</code></pre>

<hr>
<h2 id='test_rules'>Rules data</h2><span id='topic+test_rules'></span>

<h3>Description</h3>

<p>A dataset containing rules and their descriptions, datasets, valid examples, severity, and rules.
</p>


<h3>Format</h3>

<p>A data frame with 6 columns:
</p>

<dl>
<dt>name</dt><dd><p>Name of the rule (e.g., &quot;MethodologyID_valid&quot;)</p>
</dd>
<dt>description</dt><dd><p>Description of the rule (e.g., &quot;URL address is valid and can be found on the internet.&quot;)</p>
</dd>
<dt>dataset</dt><dd><p>Dataset associated with the rule (e.g., &quot;methodology&quot;)</p>
</dd>
<dt>valid_example</dt><dd><p>A valid example of the rule (e.g., &quot;https://www.waterboards.ca.gov/drinking_water/certlic/drinkingwater/documents/microplastics/mcrplsts_plcy_drft.pdf&quot;)</p>
</dd>
<dt>severity</dt><dd><p>Severity of the rule (e.g., &quot;error&quot;)</p>
</dd>
<dt>rule</dt><dd><p>The actual rule (e.g., &quot;check_uploadable(MethodologyID) == TRUE&quot;)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data("test_rules")

</code></pre>

<hr>
<h2 id='valid_example'>Valid Example Data</h2><span id='topic+valid_example'></span>

<h3>Description</h3>

<p>This is a list containing three data frames as an example of valid_example.
</p>


<h3>Format</h3>

<p>A list with 3 data frames:
</p>

<dl>
<dt>data_frame_1</dt><dd><p>A data frame with 15 variables: MethodID, MatIDMethod, Equipment, Magnification, MethodComments, Protocols, Deployment, SamplingDevice, SmallestParticle, TopParticle, FilterType, FilterDiameter, FilterPoreSize, ImageFile, ImageType</p>
</dd>
<dt>data_frame_2</dt><dd><p>A data frame with 131 variables: SampleID, SampleSize, Project, Affiliation, Citation, OwnerContributor, AnalysisContributor, ReportingContributor, SiteName, Location, Compartment, SampleComments, SamplingDepth, SamplingVolume, SamplingWeight, BlankContamination, Latitude, Longitude, Matrix, CollectionStartDateTime, CollectionEndDateTime, SpatialFile, Concentration, ConcentrationUnits, StandardizedConcentration, StandardizedConcentrationUnits, Color_Transparent, Color_Blue, Color_Red, Color_Brown, Color_Green, Color_Orange, Color_White, Color_Yellow, Color_Pink, Color_Black, Color_Other, Material_PEST, Material_PE, Material_PP, Material_PA, Material_PE_PS, Material_PS, Material_CA, Material_PVC, Material_ER, Material_PAM, Material_PET, Material_PlasticAdditive, Material_PBT, Material_PU, Material_PET_PEST, Material_PAN, Material_Silicone, Material_Acrylic, Material_Vinyl, Material_Vinyon, Material_Other, Material_PA_ER, Material_PTT, Material_PE_PP, Material_PPS, Material_Rayon, Material_PAA, Material_PMPS, Material_PI, Material_Olefin, Material_Styrene_Butadiene, Material_PBA, Material_PMMA, Material_Cellophane, Material_SAN, Material_PC, Material_PDMS, Material_PLA, Material_PTFE, Material_SBR, Material_PET_Olefin, Material_PES, Material_ABS, Material_LDPE, Material_PEVA, Material_AR, Material_PVA, Material_PPE, Morphology_Fragment, Morphology_Fiber, Morphology_Nurdle, Morphology_Film, Morphology_Foam, Morphology_Sphere, Morphology_Line, Morphology_Bead, Morphology_Sheet, Morphology_Film_Fragment, Morphology_Rubbery_Fragment, Size_3000um, Size_2_5mm, Size_1_5mm, Size_1_2mm, Size_0.5_1mm, Size_less_than_0.5mm, Size_500um, Size_300_500um, Size_125_300um, Size_100_500um, Size_greater_than_100um, Size_50_150um, Size_50_100um, Size_50um, Size_45_125um, Size_greater_than_25um, Size_20um_5mm, Size_20_100um, Size_20_50um, Size_10_50um, Size_10_45um, Size_10_20um, Size_greater_than_10um, Size_8_316um, Size_5_100um, Size_5_10um, Size_4_10um, Size_1.5_5um, Size_less_than_1.5um, Size_1_100um, Size_1_50um, Size_1_10um, Size_1_5um, Size_110_124nm, Size_0_20um</p>
</dd>
<dt>data_frame_3</dt><dd><p>A data frame with 19 variables: ParticleID, Amount, Color, Polymer, Shape, PhotoID, ParticleComments, PlasticType, Length, Width, Height, Units, Mass, SurfaceArea, SizeDimension, Volume, Tactile, ArrivalDate, AnalysisDate</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data("valid_example")

</code></pre>

<hr>
<h2 id='validate_data'>Validate data based on specified rules</h2><span id='topic+validate_data'></span>

<h3>Description</h3>

<p>Validate_data: Validate data based on specified rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_data(
  files_data,
  data_names = NULL,
  file_rules = NULL,
  zip_data = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_data_+3A_files_data">files_data</code></td>
<td>
<p>A list of file paths for the datasets to be validated.</p>
</td></tr>
<tr><td><code id="validate_data_+3A_data_names">data_names</code></td>
<td>
<p>(Optional) A character vector of names for the datasets. If not provided, names will be extracted from the file paths.</p>
</td></tr>
<tr><td><code id="validate_data_+3A_file_rules">file_rules</code></td>
<td>
<p>A file path for the rules file, either in .csv or .xlsx format.</p>
</td></tr>
<tr><td><code id="validate_data_+3A_zip_data">zip_data</code></td>
<td>
<p>A file path to a zip folder for validating unstructured data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
- data_formatted: A list of data frames with the validated data.
- data_names: A character vector of dataset names.
- report: A list of validation report objects for each dataset.
- results: A list of validation result data frames for each dataset.
- rules: A list of validator objects for each dataset.
- status: A character string indicating the overall validation status (&quot;success&quot; or &quot;error&quot;).
- issues: A logical vector indicating if there are any issues in the validation results.
- message: A data.table containing information about any issues encountered.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Validate data with specified rules
data("valid_example")
data("invalid_example")
data("test_rules")

result_valid &lt;- validate_data(files_data = valid_example,
                        data_names = c("methodology", "particles", "samples"),
                        file_rules = test_rules)
                        
result_invalid &lt;- validate_data(files_data = invalid_example,
                        data_names = c("methodology", "particles", "samples"),
                        file_rules = test_rules)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
