<!DOCTYPE html><html><head><title>Help for package paramDemo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {paramDemo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#paramDemo-package'>
<p>Parametric and Non-Parametric Demographic Functions and Applications</p></a></li>
<li><a href='#CalcAgeingRateMort'>
<p>Calculating actuarial and reproduction aging rates.</p></a></li>
<li><a href='#CalcAgeMaxFert'>
<p>Calculating Age at Maximum Fertility and Maximum Fertility.</p></a></li>
<li><a href='#CalcDemo'>
<p>Calculating Parametric Age-Specific Mortality, Survival, and Fertility</p></a></li>
<li><a href='#CalcDiscrDemo'>
<p>Calculating Demographic Rates on Discrete Age Intervals from Parametric Age-Specific Mortality</p></a></li>
<li><a href='#CalcFert'>
<p>Calculating Parametric Age-Specific Fertility.</p></a></li>
<li><a href='#CalcLifeHist'>
<p>Calculating life history variables from parametric models of age-specific demographic rates.</p></a></li>
<li><a href='#CalcLifeTable'>
<p>Calculating a Life Table from Data.</p></a></li>
<li><a href='#CalcMort'>
<p>Calculating Parametric Age-Specific Mortality and survival.</p></a></li>
<li><a href='#CalcProductLimitEst'>
<p>Calculating the product limit estimator from Data.</p></a></li>
<li><a href='#CalcRemainLifeExp'>
<p>Calculating Remaining Life Expectancy.</p></a></li>
<li><a href='#plot.paramDemo'>
<p>Functions to plot parametric demographic functions</p></a></li>
<li><a href='#plot.paramDemoLT'>
<p>Functions to plot life tables and product limit estimators</p></a></li>
<li><a href='#plot.PDlifeHist'>
<p>Summarizing and plotting life history variables from parametric demographic models.</p></a></li>
<li><a href='#SampleRandAge'>
<p>Sampling Ages at Death from a Parametric Mortality model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Parametric and Non-Parametric Demographic Functions and
Applications</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-07-03</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate parametric mortality and Fertility models, following packages 'BaSTA' in Colchero, Jones and Rebke (2012) &lt;<a href="https://doi.org/10.1111%2Fj.2041-210X.2012.00186.x">doi:10.1111/j.2041-210X.2012.00186.x</a>&gt; and 'BaFTA' <a href="https://github.com/fercol/BaFTA">https://github.com/fercol/BaFTA</a>, summary statistics (e.g. ageing rates, life expectancy, lifespan equality, etc.), life table and product limit estimators from census data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fercol/paramDemo/issues">https://github.com/fercol/paramDemo/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-08 08:26:27 UTC; fernando_colchero</td>
</tr>
<tr>
<td>Author:</td>
<td>Fernando Colchero [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fernando Colchero &lt;fernando_colchero@eva.mpg.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-09 15:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='paramDemo-package'>
Parametric and Non-Parametric Demographic Functions and Applications
</h2><span id='topic+paramDemo-package'></span><span id='topic+paramDemo'></span>

<h3>Description</h3>

<p>Functions for parametric and non-parametric calculations of survival, mortality and fertility
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
	Package: </td><td style="text-align: left;"> paramDemo </td>
</tr>
<tr>
 <td style="text-align: left;">
	Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
	Version: </td><td style="text-align: left;"> 1.0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
	Date: </td><td style="text-align: left;"> 2024-07-03</td>
</tr>
<tr>
 <td style="text-align: left;">
	License: </td><td style="text-align: left;"> GNU General Public Licence</td>
</tr>
<tr>
 <td style="text-align: left;">
	LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package contains functions for calculations of parametric mortality, survival and fertility models, as well as non-parametric methods for life tables and product limit estimators.
</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>

<hr>
<h2 id='CalcAgeingRateMort'>
Calculating actuarial and reproduction aging rates.
</h2><span id='topic+CalcAgeingRateMort'></span><span id='topic+CalcAgeingRateFert'></span>

<h3>Description</h3>

<p><code>CalcAgeingRateMort</code> and <code>CalcAgeingRateFert</code> are used to calculate actuarial and reproductive ageing rates from parametric models of mortality and fertility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcAgeingRateMort(theta, x, model = "GO", shape = "simple", 
                   checkTheta = TRUE)

CalcAgeingRateFert(beta, x, modelFert = "quadratic", ageMatur = 0,
                   checkBeta = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcAgeingRateMort_+3A_theta">theta</code></td>
<td>
<p>Numerical vector of age-specific mortality parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcAgeingRateMort_+3A_beta">beta</code></td>
<td>
<p>Numerical vector of age-specific fertility parameters (see details.)</p>
</td></tr>
<tr><td><code id="CalcAgeingRateMort_+3A_x">x</code></td>
<td>
<p>Numerical vector of ages at which to calculate mortality.</p>
</td></tr>
<tr><td><code id="CalcAgeingRateMort_+3A_model">model</code></td>
<td>
<p>The underlying mortality model to be used. <code>"EX"</code> = exponential,<code>"GO"</code> = Gompertz, <code>"WE"</code> = Weibull and <code>"LO"</code> = logistic (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcAgeingRateMort_+3A_shape">shape</code></td>
<td>
<p>The overall shape of the model. Values are: <code>simple</code> = no extra parameters added; <code>Makeham</code> = a constant parameter is added to the mortality; and <code>bathtub</code> = a Gompertz declining mortality for early ages and a constant parameter are added to the mortality model (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcAgeingRateMort_+3A_modelfert">modelFert</code></td>
<td>
<p>Age-specific fertility model. Options are &ldquo;<code>quadratic</code>&rdquo; (default), &ldquo;<code>PeristeraKostaki</code>&rdquo;, &ldquo;<code>ColcheroMuller</code>&rdquo;, &ldquo;<code>Hadwiger</code>&rdquo;, &ldquo;<code>gamma</code>&rdquo;, &ldquo;<code>beta</code>&rdquo;, &ldquo;<code>skewNormal</code>&rdquo;, &ldquo;<code>gammaMixture</code>&rdquo;, &ldquo;<code>HadwigerMixture</code>&rdquo;, &ldquo;<code>skewSymmetric</code>&rdquo;, &ldquo;<code>skewLogistic</code>&rdquo; (see details)</p>
</td></tr>
<tr><td><code id="CalcAgeingRateMort_+3A_agematur">ageMatur</code></td>
<td>
<p>Numerical value for the age at sexual maturity.</p>
</td></tr>
<tr><td><code id="CalcAgeingRateMort_+3A_checktheta">checkTheta</code></td>
<td>
<p>Logical to verify that the <code>theta</code> parameters conform with the mortality model's specification (see details).</p>
</td></tr>
<tr><td><code id="CalcAgeingRateMort_+3A_checkbeta">checkBeta</code></td>
<td>
<p>Logical to verify that the <code>beta</code> parameters conform with the fertility model's specification (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>CalcAgeingRateMort</code> uses parametric functions to calculate the actuarial (i.e., mortality) rate of ageing. The function follows the conventions from package BaSTA (Colchero and Clark 2012, Colchero <em>et al.</em> 2012, Colchero <em>et al.</em> 2021) to select the parametric model of mortality. The mortality function describes how the risk of mortality changes with age, and is defined as 
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \theta) = \lim_{\Delta x \rightarrow 0} \frac{\Pr[x &lt; X &lt; x + \Delta x | X &gt; x]}{\Delta x},
</code>
</p>

<p>where <code class="reqn">X</code> is a random variable for ages at death, <code class="reqn">x \geq 0</code> are ages and <code class="reqn">\theta</code> is the vector of mortality parameters. (For further details on the mortality and survival models see <code><a href="#topic+CalcMort">CalcMort</a></code>). 
</p>
<p>Given a vector of ages <code class="reqn">x_1, x_2, \dots, x_n</code> specified by the user with argument <code>x</code>, the function calculates ageing rates at age <code class="reqn">x_i</code> as
</p>
<p style="text-align: center;"><code class="reqn">
\frac{d}{dx}\ln [\mu(x)] |_{x = x_i}, 
</code>
</p>

<p>for <code class="reqn">i = 1, 2, \dots, n</code>.
</p>
<p>Similarly, function <code>CalcAgeingRatesFert</code> calculate reproductive ageing rates from parametric models of age-specific fertility, <code class="reqn">g(x)</code>. It uses a numerical approximation to 
</p>
<p style="text-align: center;"><code class="reqn">
\frac{d}{dx}\ln [g(x)] |_{x = x_i}, 
</code>
</p>

<p>for <code class="reqn">i = 1, 2, \dots, n</code>.
</p>


<h3>Value</h3>

<p>The functions output a matrix with the ages at which ageing rates were calculated, the estimated actuarial rate of ageing, and the level of survival at that age. 
</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcSurv">CalcSurv</a></code> to calculate age-specific survival, <code><a href="#topic+CalcMort">CalcMort</a></code> to calculate age-specific mortality, <code><a href="#topic+CalcFert">CalcFert</a></code> to calculate age-specific fertility.
</p>
<p><code><a href="#topic+CalcAgeMaxFert">CalcAgeMaxFert</a></code> to calculate the age at maximum fertility from parametric models of age-specific fertility. <code><a href="#topic+CalcRemainLifeExp">CalcRemainLifeExp</a></code> to calculate remaining life expectancy from parametric models of age-specific mortality.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate actuarial ageing rate from Gompertz model:
arm &lt;- CalcAgeingRateMort(theta = c(b0 = -5, b1 = 0.1), x = 10)

# Calculate reproductive ageing rate from quadratic model:
arf &lt;- CalcAgeingRateFert(beta = c(b0 = 2, b1 = 0.0025, b2 = 2), x = 10,
                          modelFert = "quadratic")

</code></pre>

<hr>
<h2 id='CalcAgeMaxFert'>
Calculating Age at Maximum Fertility and Maximum Fertility.
</h2><span id='topic+CalcAgeMaxFert'></span>

<h3>Description</h3>

<p><code>CalcAgeMaxFert</code> is used to calculate the age at maximum fertility, and the maximum fertility level from parametric models of fertility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcAgeMaxFert (beta, modelFert = "quadratic", ageMatur = 0, 
                           maxAge = 100)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcAgeMaxFert_+3A_beta">beta</code></td>
<td>
<p>Numerical vector of age-specific fertility parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcAgeMaxFert_+3A_modelfert">modelFert</code></td>
<td>
<p>Age-specific fertility model. Options are &ldquo;<code>quadratic</code>&rdquo; (default), &ldquo;<code>PeristeraKostaki</code>&rdquo;, &ldquo;<code>ColcheroMuller</code>&rdquo;, &ldquo;<code>Hadwiger</code>&rdquo;, &ldquo;<code>gamma</code>&rdquo;, &ldquo;<code>beta</code>&rdquo;, &ldquo;<code>skewNormal</code>&rdquo;, &ldquo;<code>gammaMixture</code>&rdquo;, &ldquo;<code>HadwigerMixture</code>&rdquo;, &ldquo;<code>skewSymmetric</code>&rdquo;, &ldquo;<code>skewLogistic</code>&rdquo; (see details)</p>
</td></tr>
<tr><td><code id="CalcAgeMaxFert_+3A_agematur">ageMatur</code></td>
<td>
<p>Numerical value for the age at sexual maturity.</p>
</td></tr>
<tr><td><code id="CalcAgeMaxFert_+3A_maxage">maxAge</code></td>
<td>
<p>Numerical value for the maximum possible age of reproduction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given function <code class="reqn">g</code> of age-specific fertility, <code>CalcAgeMaxFert</code> uses either an analytical solution to 
</p>
<p style="text-align: center;"><code class="reqn">
\frac{dg}{dx} = 0
</code>
</p>

<p>or a numerical approximation. For details of the parametric models available see <code><a href="#topic+CalcFert">CalcFert</a></code>.
</p>


<h3>Value</h3>

<p>The function outputs a vector with the calculated or estimated age at maximum fertility, the maximum level of fertility, the error in the estimation and the number of iterations (for numerical approximations),  and the age at maturity as specified by the user. 
</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcSurv">CalcSurv</a></code> to calculate age-specific survival, <code><a href="#topic+CalcMort">CalcMort</a></code> to calculate age-specific mortality, <code><a href="#topic+CalcFert">CalcFert</a></code> to calculate age-specific fertility.
</p>
<p><code><a href="#topic+CalcAgeingRateMort">CalcAgeingRateMort</a></code> to calculate ageing rates from parametric models of age-specific mortality. <code><a href="#topic+CalcRemainLifeExp">CalcRemainLifeExp</a></code> to calculate remaining life expectancy from parametric models of age-specific mortality.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate age at maximum fertility from quadratic model:
maxg &lt;- CalcAgeMaxFert(beta = c(b0 = 0.5, b1 = 0.01, b2 = 10))

# Calculate age at maximum fertility from gamma model:
maxg &lt;- CalcAgeMaxFert(beta = c(b0 = 13, b1 = 2, b2 = 0.15),
                     modelFert = "gamma")

</code></pre>

<hr>
<h2 id='CalcDemo'>
Calculating Parametric Age-Specific Mortality, Survival, and Fertility
</h2><span id='topic+CalcDemo'></span>

<h3>Description</h3>

<p><code>CalcDemo</code> is used to calculate age-specific demographic rates and summary statistics from parametric models of survival and fertility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcDemo(theta = NULL, beta = NULL, x = NULL, dx = NULL, 
          model = "GO",  shape = "simple", modelFert = "quadratic", 
          type = "both", minSx = 0.01,  summarStats = TRUE, 
          ageMatur = 0, maxAge = NULL, agesAR = NULL,  
          SxValsAR = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcDemo_+3A_theta">theta</code></td>
<td>
<p>Numerical vector of age-specific mortality parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_beta">beta</code></td>
<td>
<p>Numerical vector of age-specific fertility parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_x">x</code></td>
<td>
<p>Numerical vector of ages. If <code>NULL</code> (default), ages are constructed from age 0 to the age when the survival function reaches 0.0001.</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_dx">dx</code></td>
<td>
<p>Numerical value for age increments. If <code>NULL</code>, the default value is 0.01.</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_model">model</code></td>
<td>
<p>Mortality model, options are &ldquo;<code>EX</code>&rdquo; = exponential (i.e., constant mortality with age), &ldquo;<code>GO</code>&rdquo; = Gompertz (default), &ldquo;<code>WE</code>&rdquo; = Weibull, or &ldquo;<code>LO</code>&rdquo; = logistic.</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_shape">shape</code></td>
<td>
<p>The overall shape of the mortality model. Values are: &ldquo;<code>simple</code>&rdquo; = no extra parameters added; &ldquo;<code>Makeham</code>&rdquo; = a constant parameter is added to the mortality; and &ldquo;<code>bathtub</code>&rdquo; = a Gompertz declining mortality for early ages and a constant parameter are added to the mortality model (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_modelfert">modelFert</code></td>
<td>
<p>Age-specific fertility model. Options are &ldquo;<code>quadratic</code>&rdquo; (default), &ldquo;<code>PeristeraKostaki</code>&rdquo;, &ldquo;<code>ColcheroMuller</code>&rdquo;, &ldquo;<code>Hadwiger</code>&rdquo;, &ldquo;<code>gamma</code>&rdquo;, &ldquo;<code>beta</code>&rdquo;, &ldquo;<code>skewNormal</code>&rdquo;, &ldquo;<code>gammaMixture</code>&rdquo;, &ldquo;<code>HadwigerMixture</code>&rdquo;, &ldquo;<code>skewSymmetric</code>&rdquo;, &ldquo;<code>skewLogistic</code>&rdquo; (see details)</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_type">type</code></td>
<td>
<p>Character string specifying the demographic rates to be calculated. Options are &ldquo;<code>both</code>&rdquo; (default), &ldquo;<code>survival</code>&rdquo;, &ldquo;<code>fertility</code>&rdquo;.</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_minsx">minSx</code></td>
<td>
<p>Numerical value specifying the lower bound of the survival function to find the maximum age. The default is 0.01.</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_summarstats">summarStats</code></td>
<td>
<p>Logical specifying whether summary statistics such as life expectancy, lifespan equality and ageing rates at the specified ages should be calculated.</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_agematur">ageMatur</code></td>
<td>
<p>Numerical value specifying the age at sexual maturity, used as the lower bound for the age-specific fertility. Default is 0.</p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_maxage">maxAge</code></td>
<td>
<p>Numerical values for the maximum age for survival and fertility demographic rates. If <code>NULL</code> (default), the maximum age is calculated when the survival function reaches <code>minSx</code>. </p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_agesar">agesAR</code></td>
<td>
<p>Numerical vector of ages at which ageing rates should be calculated. If <code>NULL</code> (default) they are calculated at the ages when the survival function reaches 0.5, 0.2, and 0.05. </p>
</td></tr>
<tr><td><code id="CalcDemo_+3A_sxvalsar">SxValsAR</code></td>
<td>
<p>Alternative to <code>agesAR</code>, numerical value for the levels of survival at which ageing rates should be calculated. If <code>NULL</code> (default) they are calculated at the ages when the survival function reaches 0.5, 0.2, and 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>1) Age-specific mortality and survival models:</b>
</p>
<p>The function <code>CalcDemo</code> uses parametric functions to calculate age-specific survival, defined as the probability of surviving to a given age. The function follows the conventions from package BaSTA (Colchero and Clark 2012, Colchero <em>et al.</em> 2012, Colchero <em>et al.</em> 2021). The mortality function describes how the risk of mortality changes with age, and is defined as 
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \theta) = \lim_{\Delta x \rightarrow 0} \frac{\Pr[x &lt; X &lt; x + \Delta x | X &gt; x]}{\Delta x},
</code>
</p>

<p>where <code class="reqn">X</code> is a random variable for ages at death, <code class="reqn">x \geq 0</code> are ages and <code class="reqn">\theta</code> is the vector of mortality parameters. From the mortality function, the survival function is then given by
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = \exp[-\int_0^x \mu(t | \bm{\theta}) dt].
</code>
</p>

<p><code>1.1)</code><code>Argument </code>&ldquo;<code>model</code>&rdquo;<code>:</code>
</p>
<p>The <code>model</code> argument allows the user to choose between four basic mortality functions, namely 
</p>
<p>(a) <code>model = </code>&ldquo;<code>EX</code>&rdquo;: The exponential model (Cox and Oakes 1974), with constant mortality with age, specified as
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = b,</code>
</p>

<p>where <code class="reqn">b &gt; 0</code>, with survival 
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp[-b x].
</code>
</p>

<p>(b) <code>model = </code>&ldquo;<code>GO</code>&rdquo;: The Gompertz mortality model (Gompertz 1925, Pletcher 1999), calculated as 
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = \exp(b_0 + b_1 x),</code>
</p>

<p>where <code class="reqn">-\infty &lt; b_0, b_1 &lt; \infty</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp\left[\frac{e^{b_0}}{b_1}\left(1 - e^{b_1 x}\right)\right].
</code>
</p>

<p>(c) <code>model = </code>&ldquo;<code>WE</code>&rdquo;: The Weibull mortality model (Pinder III <em>et al.</em> 1978) calculated as
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = b_0 b_1^{b_0} x^{b_0 -1},</code>
</p>

<p>where <code class="reqn">b_0, b_1 &gt; 0</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp\left[-(b_1 x)^{b_0}\right].
</code>
</p>

<p>(d) <code>model = </code>&ldquo;<code>LO</code>&rdquo;: The logistic mortality model (Pletcher 1999), calculated as 
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = \frac{\exp(b_0 + b_1 x)}{1 + b_2 \frac{e^{b_0}}{b_1} \left(e^{b_1 x}-1\right)},</code>
</p>

<p>where <code class="reqn">b_0, b_1, b_2 &gt; 0</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \left[1 + b_2 \frac{e^{b_0}}{b_1} \left(e^{b_1 x} - 1\right)\right]^{-1 / b_2}.
</code>
</p>

<p><code>1.2)</code><code>Argument </code>&ldquo;<code>shape</code>&rdquo;<code>:</code>
</p>
<p>The <code>shape</code> argument allows the user to extend these models in order to explore more complex mortality shapes. 
</p>
<p>(a) <code>shape = </code>&ldquo;<code>simple</code>&rdquo;: (default) Leaves the model as defined above, with mortality given by
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = \mu_b(x | \bm{\theta})
</code>
</p>

<p>and survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = S_b(x | \bm{\theta}.
</code>
</p>

<p>(b) <code>shape = </code>&ldquo;<code>Makeham</code>&rdquo;: A constant is added to the mortality, such that the mortality is given by
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = c + \mu_b(x | \bm{\theta}_1),
</code>
</p>

<p>where <code class="reqn">\bm{\theta} = [c, \bm{\theta}_1]</code>, and with survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = e^{-cx} S_b(x | \bm{\theta}_1)
</code>
</p>

<p>The most common models with this shape is the Gompertz-Makeham model (Gompertz 1825, Makeham 1866).
</p>
<p>(c) <code>shape = </code>&ldquo;<code>bathtub</code>&rdquo;: produces a concave shapes in mortality by adding a declining Gompertz term and a constant parameter to the basic mortality model, where the mortality function is
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = \exp(a_0 - a_1 x) + c + \mu_b(x | \bm{\theta}_1),
</code>
</p>

<p>where <code class="reqn">a_0 \in \mathbb{R}</code>, <code class="reqn">a_1, c \geq 0</code> and <code class="reqn">\bm{\theta}_1 \subset \bm{\theta}</code> are specified based on argument <code>model</code>, and with survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \theta) = \exp\left[\frac{e^{a_0}}{a_1}\left(e^{a_1 x} - 1\right)-cx\right] S_b(x | \theta_1).
</code>
</p>

<p>The most widely use &ldquo;<code>bathtub</code>&rdquo; shaped model is the <b>Siler mortality model</b> (Siler 1979), which provides considerably good fits to mammalian data. The arguments for the Siler model are:
</p>
<pre>CalcDemo(..., model = "GO", shape = "bathtub", ...)</pre>
<p><b>2) Specifying theta parameters:</b>
</p>
<p>Argument <code>theta</code> requires a numerical vector of parameters. For instance, for a Gompertz model with simple shape and with parameter vector <code class="reqn">\bm{\theta}^{\top} = [b_0, b_1]</code> where <code class="reqn">b_0 = -5</code> and <code class="reqn">b_1 = 0.1</code>, the argument should be specified as 
</p>
<p><code>CalcDemo(theta = c(b0 = -5, b1 = 0.1), ...)</code> 
</p>
<p>Note that in this example the parameter names are specified directly, this is required when <code>checkTheta = FALSE</code>. Although assigning the names to each parameter is not necessary when <code>checkTheta = TRUE</code>, it is advisable to ensure that the right values are assigned to the right parameter.  
</p>
<p>If argument <code>checkTheta</code> is set to <code>TRUE</code>, then the vector of <code>theta</code> parameters is verified for consistency with the requirements of the model and shape selected. 
</p>
<p><b><em>3) Age-specific fertility models:</em></b>
</p>
<p>The age-specific fertility models correspond to the expected number of offspring produced by adults of a given age. Therefore, for a random variable <code class="reqn">Y_{x}</code> with realizations <code class="reqn">y_x</code> for the number of offspring produced by adults of age <code class="reqn">x</code>, we have that <code class="reqn">E(Y_x) = g(x | \bm{\beta})</code>, where <code class="reqn">g: \mathbb{R}_{\ge 0} \rightarrow \mathbb{R}_{\ge 0}</code> is a non-negative smooth fertility function and <code class="reqn">\bm{\beta}</code> is a vector of parameters to be estimated. The functional forms of function <code class="reqn">g</code> fall in two main categories, namely polynomial and distributional models.
</p>
<p>3.a) Polynomial:
</p>
<p>Of the models available in <code>paramDemo</code>, the &ldquo;<code>quadratic</code>&rdquo;, &ldquo;<code>PeristeraKostaki</code>&rdquo; (Peristera and Kostaki 2007), and &ldquo;<code>ColcheroMuller</code>&rdquo; (Colchero  <em>et al.</em> 2021, Muller <em>et al.</em> 2020) fall within the polynomial category. Both, the &ldquo;<code>PeristeraKostaki</code>&rdquo; and &ldquo;<code>ColcheroMuller</code>&rdquo; are non-symmetric around the age at maximum fertility.
</p>
<p>3.b) Distributional:
</p>
<p>The distributional models are of the form
</p>
<p style="text-align: center;"><code class="reqn">g(x | \bm{\beta}) = R f(x | \bm{\beta}_1),</code>
</p>

<p>where <code class="reqn">f: \mathbb{R}_{\ge 0} \rightarrow \mathbb{R}_{\ge 0}</code> is a probability density function, <code class="reqn">R &gt; 0</code> is a parameter for the total fertility rate, and <code class="reqn">\bm{\beta}_1 \subset \bm{\beta}</code> is a vector of parameters. The
&ldquo;<code>Hadwiger</code>&rdquo; (Hadwiger 1940), &ldquo;<code>gamma</code>&rdquo; (Hoem <em>et al.</em> 1981), &ldquo;<code>beta</code>&rdquo;  (Hoem <em>et al.</em> 1981), &ldquo;<code>skewNormal</code>&rdquo; (Mazzuco and Scarpa 2011, 2015), &ldquo;<code>gammaMixture</code>&rdquo; (Hoem <em>et al.</em> 1981), &ldquo;<code>HadwigerMixture</code>&rdquo; (Chandola <em>et al.</em> 1991), &ldquo;<code>skewSymmetric</code>&rdquo; (Mazzuco and Scarpa 2011, 2015), and &ldquo;<code>skewLogistic</code>&rdquo; (Asili <em>et al.</em> 2014) all fall in this category. Notably, the &ldquo;<code>gammaMixture</code>&rdquo;, &ldquo;<code>HadwigerMixture</code>&rdquo;, &ldquo;<code>skewSymmetric</code>&rdquo;, &ldquo;<code>skewLogistic</code>&rdquo; are appropriate when fertility might be bimodal (Hoem <em>et al.</em> 1981, Chandola <em>et al.</em> 1999, Mazzuco and Scarpa 2011, 2015, Asili <em>et al.</em> 2014). 
</p>
<p><b>4) Specifiying beta parameters:</b>
</p>
<p>Argument <code>beta</code> requires a vector of parameters. For instance, for a quadratic model with parameter vector <code class="reqn">\bm{\beta}^{\top} = [b_0, b_1, b_2]</code> where <code class="reqn">b_0 = 0.5</code>, <code class="reqn">b_1 = 0.01</code> and <code class="reqn">b_2 = 10</code>, the argument should be specified as
</p>
<p><code>CalcDemo(..., beta = c(b0 = 0.5, b1 = 0.01, b2 = 10), ...)</code>
</p>
<p>Note that in this example the parameter names are specified directly, this is required when <code>checkBeta = FALSE</code>. Although assigning the names to each parameter is not necessary when <code>checkBeta = TRUE</code>, it is advisable to ensure that the right values are assigned to the right parameter.  
</p>
<p>If argument <code>checkBeta</code> is set to <code>TRUE</code>, then the vector of <code>beta</code> parameters is verified for consistency with the requirements of the fertility model selected. 
</p>
<p><b>5) Summary statistics:</b>
</p>
<p><code>5.1) Ageing rates:</code>
</p>
<p>Given a vector of ages <code class="reqn">x_1, x_2, \dots, x_n</code> specified by the user with argument <code>agesAR</code>, the function calculates ageing rates at age <code class="reqn">x_i</code> as
</p>
<p style="text-align: center;"><code class="reqn">
\frac{d}{dx}\ln [\mu(x)] |_{x = x_i}, 
</code>
</p>

<p>for <code class="reqn">i = 1, 2, \dots, n</code>.
</p>
<p><code>5.2) Ages at different levels of survival:</code>
</p>
<p>The function calculates the ages when the survival function reaches specific values(default at 0.2, 0.1, 0.05), commonly used as population measures of old age. Thus, for a given value <code class="reqn">s = S(x)</code>, the function computes the inverse function
</p>
<p style="text-align: center;"><code class="reqn">
x = S^{-1}(s).
</code>
</p>

<p><code>5.3) Remaining life expectancy:</code>
</p>
<p>The function calculates the life expectancy at birth as
</p>
<p style="text-align: center;"><code class="reqn">
e_{0} = \int_{0}^{\infty} S(t) dt.
</code>
</p>

<p><code>5.4) Measures of inequality and equality:</code>
</p>
<p>The function calculates different measures of inequality and equality in the distribution of ages at death that results from the parametric model:
</p>
<p>- <code>Lifespan inequality:</code> (Demetrius 1974, Keyfitz and Caswell 2005) given by
</p>
<p style="text-align: center;"><code class="reqn">
H = -\frac{\int_{0}^{\infty} S(x) \ln [S(x)] dx}{e_0}
</code>
</p>

<p>- <code>Lifespan equality:</code> (Colchero <em>et al.</em> 2016, Colchero <em>et al.</em> 2021) given by
</p>
<p style="text-align: center;"><code class="reqn">
\varepsilon = - \ln H.
</code>
</p>

<p>- <code>Gini coefficient:</code> (Gini 1912, Shkolnikov <em>et al.</em> 2003) given by
</p>
<p style="text-align: center;"><code class="reqn">
G = 1 - \frac{1}{e_0} \int_0^{\infty} [l(x)]^2 dx
</code>
</p>

<p>- <code>Coefficient of variation:</code> given by
</p>
<p style="text-align: center;"><code class="reqn">
CV = \frac{\sqrt{\sigma^2}}{e_0},
</code>
</p>

<p>where <code class="reqn">\sigma^2</code> is the variance in ages at death.
</p>


<h3>Value</h3>

<p><code>CalcDemo</code> returns an object of class &ldquo;<code>paramDemo</code>&rdquo; with output consisting of two lists, one for survival and one for fertility. The survival list can be called as <code>object$surv</code> while the fertility list is in <code>object$fert</code>. Both include the following outputs:
</p>
<table>
<tr><td><code>functs</code></td>
<td>
<p>data.frame including the follwing columns for survival: <code>age</code>, <code>mort</code> for the mortality function, <code>surv</code> for the survival, <code>pdf</code> for the probability density function of ages at death, and <code>cumhaz</code> for the cumulative hazards. For fertility it includes columns for <code>age</code> and <code>fert</code> for the age-specific fertility.</p>
</td></tr> 
<tr><td><code>summStats</code></td>
<td>
<p>list with elements: <code>calculated</code> indicating whether summary statistics were calculated, <code>ageingRates</code> with the resulting actuarial ageing rates, and <code>summStatsMort</code> with ages at which the survival function reaches different levels (default 0.5, 0.2, 0.05) (e.g., <code>AgeSx=0.5</code>), with the life expectancy <code>lifeExp</code>, <code>lifespIneq</code> for the lifespan inequality (see Demetrius 1974), <code>lifespEqual</code> with the lifespan equality as in Colchero <em>et al.</em> (2021), <code>Gini</code> for the Gini coefficient, and <code>CoeffVar</code> for the coefficient of variation in the distribution of ages at death. For fertility, the list includes a logical <code>calculated</code> to indicate if summary statistics were calculated, and <code>summStatsFert</code> with the age at maximum fertility calculations (see <code><a href="#topic+CalcAgeMaxFert">CalcAgeMaxFert</a></code>).</p>
</td></tr> 
<tr><td><code>settings</code></td>
<td>
<p>list with the details of the parameters and the models used.</p>
</td></tr> 
<tr><td><code>analyzed</code></td>
<td>
<p>logical indicating whether <code>surv</code> or <code>fert</code> were calculated.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>References</h3>

<p>Asili S., Rezaei S., Najjar, L. (2014) Using Skew-Logistic Probability Density Function as a Model for Age-Specific Fertility Rate Pattern. <em>BioMed Research International</em>, 2014, 790294.
</p>
<p>Azzalini, A. (1985) A Class of Distributions Which Includes the Normal Ones. <em>Scandinavian Journal of Statistics</em>, 2, 171-178.
</p>
<p>Chandola, T., Coleman D.A., Hiorns R.W. (1999) Recent European fertility patterns: Fitting curves to &lsquo;distorted&rsquo; distributions. <em>Population Studies</em>, 53, 317-329.
</p>
<p>Colchero, F. (<em>In prep.</em>) Inference on age-specific fertility in ecology and evolution. Learning from other disciplines and improving the state of the art. 
</p>
<p>Colchero, F., Eckardt, W., Stoinski, T. (2021) Evidence of demographic buffering in an endangered great ape: Social buffering on immature survival and the role of refined sex-age classes on population growth rate. <em>Journal of Animal Ecology</em>, 90, 1701-1713.
</p>
<p>Colchero, F., J.S. Clark (2012) Bayesian inference on age-specific survival from capture-recapture data for censored and truncated data. <em>Journal of Animal Ecology</em>. 81, 139-149.
</p>
<p>Colchero, F., O.R. Jones, M. Rebke. (2012) BaSTA: an R package for Bayesian estimation of age-specific survival from incomplete mark-recapture/recovery data with covariates. <em>Method in Ecology and Evolution</em>. 3, 466-470. 
</p>
<p>Colchero, F., <em>et al.</em> (2021) The long lives of primates and the &ldquo;invariant rate of aging&rdquo; hypothesis. <em>Nature Communications</em> 12:3666
</p>
<p>Cox, D. R., and Oakes D. (1984) <em>Analysis of Survival Data</em>. Chapman and Hall, London.
</p>
<p>Demetrius, L. (1974) Demographic parameters and natural selection. <em>PNAS</em> 71, 4645-4647.
</p>
<p>Gompertz, B. (1825) On the nature of the function expressive of the law of human mortality, and on a new mode of determining the value of life contingencies. <em>Philosophical Transactions of the Royal Society of London</em>, 115, 513-583.
</p>
<p>Hadwiger, H. (1940) Eine analytische Reproduktionssunktion fur biologische Gesamtheiten. <em>Scandinavian Actuarial Journal</em>, 1940, 101-113.
</p>
<p>Hoem, J.M., Madien, D., Nielsen, J.L., Ohlsen, E.M., Hansen, H.O., Rennermalm, B. (1981) Experiments in modelling recent Danish fertility curves. <em>Demography</em>, 18, 231-244.
</p>
<p>Keyfitz, N., Caswell, H. (2005) Applied Mathematical Demography. (Springer-Verlag).
</p>
<p>Makeham, W. M. (1866) On the law of mortality <em>Journal of the Institute of Actuaries</em> 13, 1-34.
</p>
<p>Mazzuco, S., Scarpa, B. (2011) Fitting age-specific fertility rates by a skew- symmetric probability density function. (Working paper 10), University of Padua.
</p>
<p>Mazzuco, S., Scarpa, B. (2015) Fitting age-specific fertility rates by a flexible generalized skew normal probability density function. <em>Journal of the Royal Statistical Society: Series A</em>, 178, 187-203.
</p>
<p>Muller M. N., Blurton Jones N. G, Colchero F., Thompson M. E., Enigk D. K. (2020) Sexual dimorphism in chimpanzee (<em>Pan troglodytes schweinfurthii</em>) and human age-specific fertility. <em>Journal of human evolution</em>, 144, 102795.
</p>
<p>Peristera P., Kostaki A. (2007) Modeling fertility in modern populations. <em>Demographic Research</em>, 16, 141-194.
</p>
<p>Pinder III, J.E., Wiener, J.G. and Smith, M.H. (1978) The Weibull distribution: a new method of summarizing survivorship data. <em>Ecology</em>, 59, 175-179.
</p>
<p>Shkolnikov, V., Andreev, E., Begun, A. Z. (2003) Gini coefficient as a life table function. <em>Demographic Research</em> 8, 305-358.
</p>
<p>Siler W. A (1979) competing-risk model for animal mortality. <em>Ecology</em> 60, 750-757.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcSurv">CalcSurv</a></code> to calculate age-specific survival, <code><a href="#topic+CalcMort">CalcMort</a></code> to calculate age-specific mortality, <code><a href="#topic+CalcFert">CalcFert</a></code> to calculate age-specific fertility.
</p>
<p><code><a href="#topic+CalcAgeingRateMort">CalcAgeingRateMort</a></code> to calculate ageing rates from parametric models of age-specific mortality. <code><a href="#topic+CalcRemainLifeExp">CalcRemainLifeExp</a></code> to calculate remaining life expectancy from parametric models of age-specific mortality. <code><a href="#topic+CalcAgeMaxFert">CalcAgeMaxFert</a></code> to calculate the age at maximum fertility from parametric models of age-specific fertility.
</p>
<p><code><a href="#topic+CalcLifeHist">CalcLifeHist</a></code> to calculate life history variables from parametric demographic models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create paramDemo object from Gompertz mortality and
# quadratic fertility:
dem &lt;- CalcDemo(theta = c(b0 = -5, b1 = 0.1), 
                 beta = c(b0 = 0.5, b1 = 0.01, b2 = 10),
                 summarStats = TRUE, agesAR = c(5, 10))

# Plot demographic object:
plot(dem)

</code></pre>

<hr>
<h2 id='CalcDiscrDemo'>
Calculating Demographic Rates on Discrete Age Intervals from Parametric Age-Specific Mortality
</h2><span id='topic+CalcDiscrDemo'></span>

<h3>Description</h3>

<p><code>CalcDiscrDemo</code> is used to calculate survival and fertility functions (i.e., <code>lx</code>, <code>px</code>, and <code>qx</code>) on discrete age intervals from an object of class &ldquo;<code>paramDemo</code>&rdquo; created with function <code>CalcDemo</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcDiscrDemo(demo, dx = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcDiscrDemo_+3A_demo">demo</code></td>
<td>
<p>Object of class &ldquo;<code>paramDemo</code>&rdquo; created with function <code>CalcDemo</code></p>
</td></tr>
<tr><td><code id="CalcDiscrDemo_+3A_dx">dx</code></td>
<td>
<p>Numeric value for the age increments. Default is <code>dx = 1</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CalcDiscrDemo</code> takes the continuous survival functions from an object of class &ldquo;<code>paramDemo</code>&rdquo; and calculates the basic survival probabilities and, if available, fertility rates on discrete age intervals. 
</p>
<p>Let <code class="reqn">x \geq 0</code> and <code class="reqn">\omega \in \mathbb{N}</code> be the next integer of the age when the survival function <code class="reqn">S(x)</code> reaches the minimum. Given the age increments, <code class="reqn">\Delta x</code>, specified with argument <code>dx</code>, the function creates a partition of <code class="reqn">[0, \omega]</code> such that <code class="reqn">[x_i, x_i + \Delta x) \subset [0, \omega]</code> for <code class="reqn">i = 1, \dots, n</code>. At each age interval it calculates the discrete survival, <code>lx</code>, as 
</p>
<p style="text-align: center;"><code class="reqn">
l_{x_i} = S(x_i).
</code>
</p>
 
<p>The age- or stage-specific survival probability, <code>px</code>, is calculated as 
</p>
<p style="text-align: center;"><code class="reqn">
p_{x_i} = \frac{S(x_i + \Delta x)}{S(x_i)},
</code>
</p>

<p>while the age- or stage-specific mortality probability, <code>qx</code>, is <code class="reqn">q_{x_i} = 1 - p_{x_i}</code>.
</p>
<p>If fertility was also calculated with function <code>CalcDemo</code>, then the function includes the discrete age- or stage-specific fertility, <code>bx</code>, as
</p>
<p style="text-align: center;"><code class="reqn">
b_{x_i} = b\left(x_i + \frac{\Delta x}{2}\right) \Delta x,
</code>
</p>

<p>where <code class="reqn">b(x)</code> is the continuous fertility function.
</p>


<h3>Value</h3>

<p><code>CalcDiscrDemo</code> returns an object of class &ldquo;<code>discrDemo</code>&rdquo; that consist of a matrix with the following columns:
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p>Partition of the full age subset into discrete intervals</p>
</td></tr>
<tr><td><code>lx</code></td>
<td>
<p>Survival or cumulative survival</p>
</td></tr>
<tr><td><code>px</code></td>
<td>
<p>The age- or stage-specific survival probability</p>
</td></tr>
<tr><td><code>qx</code></td>
<td>
<p>The age- or stage-specific mortality probability</p>
</td></tr>
<tr><td><code>bx</code></td>
<td>
<p>If available, the age- or stage-specific fertility</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcDemo">CalcDemo</a></code> to create an object of class &ldquo;<code>paramDemo</code>&rdquo;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create paramDemo object from Gompertz mortality and
# quadratic fertility:
dem &lt;- CalcDemo(theta = c(b0 = -5, b1 = 0.1), 
                 beta = c(b0 = 0.5, b1 = 0.01, b2 = 10),
                 summarStats = TRUE, agesAR = c(5, 10))

# Create discrete demographic object:
demDisc &lt;- CalcDiscrDemo(dem, dx = 1)

</code></pre>

<hr>
<h2 id='CalcFert'>
Calculating Parametric Age-Specific Fertility.
</h2><span id='topic+CalcFert'></span>

<h3>Description</h3>

<p><code>CalcFert</code> is used to calculate age-specific fertility from different parametric models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcFert(beta, x, modelFert = "quadratic", checkBeta = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcFert_+3A_beta">beta</code></td>
<td>
<p>Numerical vector of age-specific fertility parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcFert_+3A_x">x</code></td>
<td>
<p>Numerical vector of ages at which to calculate fertility.</p>
</td></tr>
<tr><td><code id="CalcFert_+3A_modelfert">modelFert</code></td>
<td>
<p>Age-specific fertility model. Options are &ldquo;<code>quadratic</code>&rdquo; (default), &ldquo;<code>PeristeraKostaki</code>&rdquo;, &ldquo;<code>ColcheroMuller</code>&rdquo;, &ldquo;<code>Hadwiger</code>&rdquo;, &ldquo;<code>gamma</code>&rdquo;, &ldquo;<code>beta</code>&rdquo;, &ldquo;<code>skewNormal</code>&rdquo;, &ldquo;<code>gammaMixture</code>&rdquo;, &ldquo;<code>HadwigerMixture</code>&rdquo;, &ldquo;<code>skewSymmetric</code>&rdquo;, &ldquo;<code>skewLogistic</code>&rdquo; (see details)</p>
</td></tr>
<tr><td><code id="CalcFert_+3A_checkbeta">checkBeta</code></td>
<td>
<p>Logical to verify that the <code>beta</code> parameters conform with the model's specification (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>1) Age-specific fertility models:</b>
</p>
<p>The age-specific fertility models correspond to the expected number of offspring produced by adults of a given age. Therefore, for a random variable <code class="reqn">Y_{x}</code> with realizations <code class="reqn">y_x</code> for the number of offspring produced by adults of age <code class="reqn">x</code>, we have that <code class="reqn">E(Y_x) = g(x | \beta)</code>, where <code class="reqn">g: \mathbb{R}_{\ge 0} \rightarrow \mathbb{R}_{\ge 0}</code> is a non-negative smooth fertility function and <code class="reqn">\beta</code> is a vector of parameters to be estimated. The functional forms of function <code class="reqn">g</code> fall in two main categories, namely polynomial and distributional models.
</p>
<p>2.a) Polynomial:
</p>
<p>Of the models available in <code>paramDemo</code>, the &ldquo;<code>quadratic</code>&rdquo;, &ldquo;<code>PeristeraKostaki</code>&rdquo; (Peristera and Kostaki 2007), and &ldquo;<code>ColcheroMuller</code>&rdquo; (Colchero  <em>et al.</em> 2021, Muller <em>et al.</em> 2020) fall within the polynomial category. Both, the &ldquo;<code>PeristeraKostaki</code>&rdquo; and &ldquo;<code>ColcheroMuller</code>&rdquo; are non-symmetric around the age at maximum fertility.
</p>
<p>2.b) Distributional:
</p>
<p>The distributional models are of the form
</p>
<p style="text-align: center;"><code class="reqn">g(x | \beta) = R f(x | \beta_1),</code>
</p>

<p>where <code class="reqn">f: \mathbb{R}_{\ge 0} \rightarrow \mathbb{R}_{\ge 0}</code> is a probability density function, <code class="reqn">R &gt; 0</code> is a parameter for the total fertility rate, and <code class="reqn">\beta_1 \in \beta</code> is a vector of parameters. The
&ldquo;<code>Hadwiger</code>&rdquo; (Hadwiger 1940), &ldquo;<code>gamma</code>&rdquo; (Hoem <em>et al.</em> 1981), &ldquo;<code>beta</code>&rdquo;  (Hoem <em>et al.</em> 1981), &ldquo;<code>skewNormal</code>&rdquo; (Mazzuco and Scarpa 2011, 2015), &ldquo;<code>gammaMixture</code>&rdquo; (Hoem <em>et al.</em> 1981), &ldquo;<code>HadwigerMixture</code>&rdquo; (Chandola <em>et al.</em> 1991), &ldquo;<code>skewSymmetric</code>&rdquo; (Mazzuco and Scarpa 2011, 2015), and &ldquo;<code>skewLogistic</code>&rdquo; (Asili <em>et al.</em> 2014) all fall in this category. Notably, the &ldquo;<code>gammaMixture</code>&rdquo;, &ldquo;<code>HadwigerMixture</code>&rdquo;, &ldquo;<code>skewSymmetric</code>&rdquo;, &ldquo;<code>skewLogistic</code>&rdquo; are appropriate when fertility might be bimodal (Hoem <em>et al.</em> 1981, Chandola <em>et al.</em> 1999, Mazzuco and Scarpa 2011, 2015, Asili <em>et al.</em> 2014). 
</p>
<p><b>2) Specifying beta parameters:</b>
</p>
<p>Argument <code>beta</code> requires a vector of parameters. For instance, for a quadratic model with parameter vector <code class="reqn">\beta^{\top} = [0.5, 0.01, 10]</code>, the argument should be specified as <code>theta = c(b0 = 0.5, b1 = 0.01, b2 = 10)</code>. Note that in this example the parameter names are specified directly, this is required when <code>checkBeta = FALSE</code>. Although assigning the names to each parameter is not necessary when <code>checkBeta = TRUE</code>, it is advisable to ensure that the right values are assigned to the right parameter.  
</p>
<p>If argument <code>checkBeta</code> is set to <code>TRUE</code>, then the vector of <code>beta</code> parameters is verified for consistency with the requirements of the model and shape selected. 
</p>


<h3>Value</h3>

<p><code>CalcFert</code> returns a vector of class &ldquo;<code>numeric</code>&rdquo; with the fertility values at the specified ages.
</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>References</h3>

<p>Asili, S., Rezaei, S. &amp; Najjar, L. (2014) Using Skew-Logistic Probability Density Function as a Model for Age-Specific Fertility Rate Pattern. <em>BioMed Research International</em>, 2014, 790294.
</p>
<p>Azzalini, A. (1985) A Class of Distributions Which Includes the Normal Ones. <em>Scandinavian Journal of Statistics</em>, 2, 171-178.
</p>
<p>Chandola, T., Coleman, D.A. &amp; Hiorns, R.W. (1999) Recent European fertility patterns: Fitting curves to &lsquo;distorted&rsquo; distributions. <em>Population Studies</em>, 53, 317-329.
</p>
<p>Colchero, F. (<em>In prep.</em>) Inference on age-specific fertility in ecology and evolution. Learning from other disciplines and improving the state of the art. 
</p>
<p>Colchero, F., Eckardt, W. &amp; Stoinski, T. (2021) Evidence of demographic buffering in an endangered great ape: Social buffering on immature survival and the role of refined sex-age classes on population growth rate. <em>Journal of Animal Ecology</em>, 90, 1701-1713.
</p>
<p>Hadwiger, H. (1940) Eine analytische Reproduktionssunktion fur biologische Gesamtheiten. <em>Scandinavian Actuarial Journal</em>, 1940, 101-113.
</p>
<p>Hoem, J.M., Madien, D., Nielsen, J.L., Ohlsen, E.M., Hansen, H.O. &amp; Rennermalm, B. (1981) Experiments in modelling recent Danish fertility curves. <em>Demography</em>, 18, 231-244.
</p>
<p>Mazzuco, S. &amp; Scarpa, B. (2011) Fitting age-specific fertility rates by a skew- symmetric probability density function. (Working paper 10), University of Padua.
</p>
<p>Mazzuco, S. &amp; Scarpa, B. (2015) Fitting age-specific fertility rates by a flexible generalized skew normal probability density function. <em>Journal of the Royal Statistical Society: Series A</em>, 178, 187-203.
</p>
<p>Muller, M. N., Blurton Jones, N. G, Colchero, F., Thompson, M. E., Enigk, D. K. (2020) Sexual dimorphism in chimpanzee (<em>Pan troglodytes schweinfurthii</em>) and human age-specific fertility. <em>Journal of human evolution</em>, 144, 102795.
</p>
<p>Peristera, P. &amp; Kostaki, A. (2007) Modeling fertility in modern populations. <em>Demographic Research</em>, 16, 141-194.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcMort">CalcMort</a></code> to calculate age-specific mortality, <code><a href="#topic+CalcSurv">CalcSurv</a></code> to calculate age-specific survival</p>


<h3>Examples</h3>

<pre><code class='language-R'># Age specific fertility based on quadratic model (default):
fert &lt;- CalcFert(beta = c(b0 = 0.5, b1 = 0.01, b2 = 10), x = 10)

# Age specific fertility based on gamma model:
fert &lt;- CalcFert(beta = c(b0 = 13, b1 = 2, b2 = 0.15), x = 10,
                  modelFert = "gamma")
</code></pre>

<hr>
<h2 id='CalcLifeHist'>
Calculating life history variables from parametric models of age-specific demographic rates.
</h2><span id='topic+CalcLifeHist'></span>

<h3>Description</h3>

<p><code>CalcLifeHist</code> uses parametric models of survival and fertility to calculate age-specific demographic rates, stable age structure, reproductive values, sensitivity and elasticities of the stable population growth rate to demographic rates, as well as different life history variables such as generation time or population entropy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcLifeHist(theta = NULL, beta = NULL, dx = NULL,
             model = "GO", shape = "simple",
             modelFert = "quadratic", ageMatur = 0, 
             maxAge = NULL, lambdaMethod = "matrix")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcLifeHist_+3A_theta">theta</code></td>
<td>
<p>Numerical vector of age-specific mortality parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcLifeHist_+3A_beta">beta</code></td>
<td>
<p>Numerical vector of age-specific fertility parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcLifeHist_+3A_dx">dx</code></td>
<td>
<p>Numerical value for the age-interval increments, default is 1.</p>
</td></tr>
<tr><td><code id="CalcLifeHist_+3A_model">model</code></td>
<td>
<p>Mortality model, options are &ldquo;<code>EX</code>&rdquo; = exponential (i.e., constant mortality with age), &ldquo;<code>GO</code>&rdquo; = Gompertz (default), &ldquo;<code>WE</code>&rdquo; = Weibull, or &ldquo;<code>LO</code>&rdquo; = logistic.</p>
</td></tr>
<tr><td><code id="CalcLifeHist_+3A_shape">shape</code></td>
<td>
<p>The overall shape of the mortality model. Values are: &ldquo;<code>simple</code>&rdquo; = no extra parameters added; &ldquo;<code>Makeham</code>&rdquo; = a constant parameter is added to the mortality; and &ldquo;<code>bathtub</code>&rdquo; = a Gompertz declining mortality for early ages and a constant parameter are added to the mortality model (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcLifeHist_+3A_modelfert">modelFert</code></td>
<td>
<p>Age-specific fertility model. Options are &ldquo;<code>quadratic</code>&rdquo; (default), &ldquo;<code>PeristeraKostaki</code>&rdquo;, &ldquo;<code>ColcheroMuller</code>&rdquo;, &ldquo;<code>Hadwiger</code>&rdquo;, &ldquo;<code>gamma</code>&rdquo;, &ldquo;<code>beta</code>&rdquo;, &ldquo;<code>skewNormal</code>&rdquo;, &ldquo;<code>gammaMixture</code>&rdquo;, &ldquo;<code>HadwigerMixture</code>&rdquo;, &ldquo;<code>skewSymmetric</code>&rdquo;, &ldquo;<code>skewLogistic</code>&rdquo; (see details)</p>
</td></tr>
<tr><td><code id="CalcLifeHist_+3A_agematur">ageMatur</code></td>
<td>
<p>Numerical value for the age at maturity.</p>
</td></tr>
<tr><td><code id="CalcLifeHist_+3A_maxage">maxAge</code></td>
<td>
<p>Numerical value for the maximum age. If <code>NULL</code> (default),
it is calculated from the survival (see details).</p>
</td></tr>
<tr><td><code id="CalcLifeHist_+3A_lambdamethod">lambdaMethod</code></td>
<td>
<p>Character string specifying the method to calculate the intrinsic population growth rate. Values are &ldquo;<code>matrix</code>&rdquo; for methods based on population projection matrices, or &ldquo;<code>Lotka</code>&rdquo; for numerical approximation of the root of the Lotka equation (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>1) Age-specific mortality and survival models:</b>
</p>
<p>The function <code>CalcDemo</code> uses parametric functions to calculate age-specific survival, defined as the probability of surviving to a given age. The function follows the conventions from package BaSTA (Colchero and Clark 2012, Colchero <em>et al.</em> 2012, Colchero <em>et al.</em> 2021). The mortality function describes how the risk of mortality changes with age, and is defined as 
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \theta) = \lim_{\Delta x \rightarrow 0} \frac{\Pr[x &lt; X &lt; x + \Delta x | X &gt; x]}{\Delta x},
</code>
</p>

<p>where <code class="reqn">X</code> is a random variable for ages at death, <code class="reqn">x \geq 0</code> are ages and <code class="reqn">\theta</code> is the vector of mortality parameters. From the mortality function, the survival function is then given by
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = \exp[-\int_0^x \mu(t | \bm{\theta}) dt].
</code>
</p>

<p><code>1.1)</code><code>Argument </code>&ldquo;<code>model</code>&rdquo;<code>:</code>
</p>
<p>The <code>model</code> argument allows the user to choose between four basic mortality functions, namely 
</p>
<p>(a) <code>model = </code>&ldquo;<code>EX</code>&rdquo;: The exponential model (Cox and Oakes 1974), with constant mortality with age, specified as
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = b,</code>
</p>

<p>where <code class="reqn">b &gt; 0</code>, with survival 
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp[-b x].
</code>
</p>

<p>(b) <code>model = </code>&ldquo;<code>GO</code>&rdquo;: The Gompertz mortality model (Gompertz 1925, Pletcher 1999), calculated as 
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = \exp(b_0 + b_1 x),</code>
</p>

<p>where <code class="reqn">-\infty &lt; b_0, b_1 &lt; \infty</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp\left[\frac{e^{b_0}}{b_1}\left(1 - e^{b_1 x}\right)\right].
</code>
</p>

<p>(c) <code>model = </code>&ldquo;<code>WE</code>&rdquo;: The Weibull mortality model (Pinder III <em>et al.</em> 1978) calculated as
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = b_0 b_1^{b_0} x^{b_0 -1},</code>
</p>

<p>where <code class="reqn">b_0, b_1 &gt; 0</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp\left[-(b_1 x)^{b_0}\right].
</code>
</p>

<p>(d) <code>model = </code>&ldquo;<code>LO</code>&rdquo;: The logistic mortality model (Pletcher 1999), calculated as 
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = \frac{\exp(b_0 + b_1 x)}{1 + b_2 \frac{e^{b_0}}{b_1} \left(e^{b_1 x}-1\right)},</code>
</p>

<p>where <code class="reqn">b_0, b_1, b_2 &gt; 0</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \left[1 + b_2 \frac{e^{b_0}}{b_1} \left(e^{b_1 x} - 1\right)\right]^{-1 / b_2}.
</code>
</p>

<p><code>1.2)</code><code>Argument </code>&ldquo;<code>shape</code>&rdquo;<code>:</code>
</p>
<p>The <code>shape</code> argument allows the user to extend these models in order to explore more complex mortality shapes. 
</p>
<p>(a) <code>shape = </code>&ldquo;<code>simple</code>&rdquo;: (default) Leaves the model as defined above, with mortality given by
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = \mu_b(x | \bm{\theta})
</code>
</p>

<p>and survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = S_b(x | \bm{\theta}.
</code>
</p>

<p>(b) <code>shape = </code>&ldquo;<code>Makeham</code>&rdquo;: A constant is added to the mortality, such that the mortality is given by
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = c + \mu_b(x | \bm{\theta}_1),
</code>
</p>

<p>where <code class="reqn">\bm{\theta} = [c, \bm{\theta}_1]</code>, and with survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = e^{-cx} S_b(x | \bm{\theta}_1)
</code>
</p>

<p>The most common models with this shape is the Gompertz-Makeham model (Gompertz 1825, Makeham 1866).
</p>
<p>(c) <code>shape = </code>&ldquo;<code>bathtub</code>&rdquo;: produces a concave shapes in mortality by adding a declining Gompertz term and a constant parameter to the basic mortality model, where the mortality function is
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = \exp(a_0 - a_1 x) + c + \mu_b(x | \bm{\theta}_1),
</code>
</p>

<p>where <code class="reqn">a_0 \in \mathbb{R}</code>, <code class="reqn">a_1, c \geq 0</code> and <code class="reqn">\bm{\theta}_1 \subset \bm{\theta}</code> are specified based on argument <code>model</code>, and with survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \theta) = \exp\left[\frac{e^{a_0}}{a_1}\left(e^{a_1 x} - 1\right)-cx\right] S_b(x | \theta_1).
</code>
</p>

<p>The most widely use &ldquo;<code>bathtub</code>&rdquo; shaped model is the <b>Siler mortality model</b> (Siler 1979), which provides considerably good fits to mammalian data. The arguments for the Siler model are:
</p>
<pre>CalcLifeHist(..., model = "GO", shape = "bathtub", ...)</pre>
<p><b>2) Specifying theta parameters:</b>
</p>
<p>Argument <code>theta</code> requires a numerical vector of parameters. For instance, for a Gompertz model with simple shape and with parameter vector <code class="reqn">\bm{\theta}^{\top} = [b_0, b_1]</code> where <code class="reqn">b_0 = -5</code> and <code class="reqn">b_1 = 0.1</code>, the argument should be specified as 
</p>
<p><code>CalcDemo(theta = c(b0 = -5, b1 = 0.1), ...)</code> 
</p>
<p>Note that in this example the parameter names are specified directly, this is required when <code>checkTheta = FALSE</code>. Although assigning the names to each parameter is not necessary when <code>checkTheta = TRUE</code>, it is advisable to ensure that the right values are assigned to the right parameter.  
</p>
<p>If argument <code>checkTheta</code> is set to <code>TRUE</code>, then the vector of <code>theta</code> parameters is verified for consistency with the requirements of the model and shape selected. 
</p>
<p><b><em>3) Age-specific fertility models:</em></b>
</p>
<p>The age-specific fertility models correspond to the expected number of offspring produced by adults of a given age. Therefore, for a random variable <code class="reqn">Y_{x}</code> with realizations <code class="reqn">y_x</code> for the number of offspring produced by adults of age <code class="reqn">x</code>, we have that <code class="reqn">E(Y_x) = g(x | \bm{\beta})</code>, where <code class="reqn">g: \mathbb{R}_{\ge 0} \rightarrow \mathbb{R}_{\ge 0}</code> is a non-negative smooth fertility function and <code class="reqn">\bm{\beta}</code> is a vector of parameters to be estimated. The functional forms of function <code class="reqn">g</code> fall in two main categories, namely polynomial and distributional models.
</p>
<p>3.a) Polynomial:
</p>
<p>Of the models available in <code>paramDemo</code>, the &ldquo;<code>quadratic</code>&rdquo;, &ldquo;<code>PeristeraKostaki</code>&rdquo; (Peristera and Kostaki 2007), and &ldquo;<code>ColcheroMuller</code>&rdquo; (Colchero  <em>et al.</em> 2021, Muller <em>et al.</em> 2020) fall within the polynomial category. Both, the &ldquo;<code>PeristeraKostaki</code>&rdquo; and &ldquo;<code>ColcheroMuller</code>&rdquo; are non-symmetric around the age at maximum fertility.
</p>
<p>3.b) Distributional:
</p>
<p>The distributional models are of the form
</p>
<p style="text-align: center;"><code class="reqn">g(x | \bm{\beta}) = R f(x | \bm{\beta}_1),</code>
</p>

<p>where <code class="reqn">f: \mathbb{R}_{\ge 0} \rightarrow \mathbb{R}_{\ge 0}</code> is a probability density function, <code class="reqn">R &gt; 0</code> is a parameter for the total fertility rate, and <code class="reqn">\bm{\beta}_1 \subset \bm{\beta}</code> is a vector of parameters. The
&ldquo;<code>Hadwiger</code>&rdquo; (Hadwiger 1940), &ldquo;<code>gamma</code>&rdquo; (Hoem <em>et al.</em> 1981), &ldquo;<code>beta</code>&rdquo;  (Hoem <em>et al.</em> 1981), &ldquo;<code>skewNormal</code>&rdquo; (Mazzuco and Scarpa 2011, 2015), &ldquo;<code>gammaMixture</code>&rdquo; (Hoem <em>et al.</em> 1981), &ldquo;<code>HadwigerMixture</code>&rdquo; (Chandola <em>et al.</em> 1991), &ldquo;<code>skewSymmetric</code>&rdquo; (Mazzuco and Scarpa 2011, 2015), and &ldquo;<code>skewLogistic</code>&rdquo; (Asili <em>et al.</em> 2014) all fall in this category. Notably, the &ldquo;<code>gammaMixture</code>&rdquo;, &ldquo;<code>HadwigerMixture</code>&rdquo;, &ldquo;<code>skewSymmetric</code>&rdquo;, &ldquo;<code>skewLogistic</code>&rdquo; are appropriate when fertility might be bimodal (Hoem <em>et al.</em> 1981, Chandola <em>et al.</em> 1999, Mazzuco and Scarpa 2011, 2015, Asili <em>et al.</em> 2014). 
</p>
<p><b>4) Specifiying beta parameters:</b>
</p>
<p>Argument <code>beta</code> requires a vector of parameters. For instance, for a quadratic model with parameter vector <code class="reqn">\bm{\beta}^{\top} = [b_0, b_1, b_2]</code> where <code class="reqn">b_0 = 0.5</code>, <code class="reqn">b_1 = 0.01</code> and <code class="reqn">b_2 = 10</code>, the argument should be specified as
</p>
<p><code>CalcLifeHist(..., beta = c(b0 = 0.5, b1 = 0.01, b2 = 10), ...)</code>
</p>
<p>Note that in this example the parameter names are specified directly, this is required when <code>checkBeta = FALSE</code>. Although assigning the names to each parameter is not necessary when <code>checkBeta = TRUE</code>, it is advisable to ensure that the right values are assigned to the right parameter.  
</p>
<p>If argument <code>checkBeta</code> is set to <code>TRUE</code>, then the vector of <code>beta</code> parameters is verified for consistency with the requirements of the fertility model selected. 
</p>
<p><b>5) Methods to estimate lambda, r, stable age structure and reproductive values:</b>
</p>
<p>If argument <code>lambdaMethod</code> is set to &ldquo;<code>matrix</code>&rdquo;, the function calculates the assymptotic population growth rate <code class="reqn">\lambda</code> as the dominant eigen-value of the resulting population projection matrix <code class="reqn">\bm{A}</code> (Caswell and Wegner 1978, Kroon <em>et al.</em> 1986, Caswell 2001). The intrinsing population growth rate is then <code class="reqn">r = \log \lambda</code>, while the stable age-structure, <code class="reqn">\bm{\omega}^{\top}=[\omega_0, \omega_1, \dots, \omega_\tau]</code>, where <code class="reqn">\tau</code> is the maximum age of the population, is given by the corresponding right eigen vector, standardized by its norm. The reproductive value is the corresponding left eigen vector, <code class="reqn">\bm{\nu}^{\top} = [\nu_0, \nu_1, \dots, \nu_\tau]</code>, standardized such that <code class="reqn">\nu_0 = 1</code>.
</p>
<p>If argument <code>lambdaMethod</code> is set to &ldquo;<code>Lotka</code>&rdquo;, the function estimates the intrinsic population growth rate, <code class="reqn">r</code>, by finding the real root of Lotka' (1913) equation, given by
</p>
<p style="text-align: center;"><code class="reqn">
\int_0^\tau e^{-rx} S(x) m(x) dx = 1.
</code>
</p>

<p>The stable population structure is then calculated as
</p>
<p style="text-align: center;"><code class="reqn">
\omega_x = \frac{e^{-rx} S(x)}{\sum_{k=0}^\tau e^{-rk} S(k)},
</code>
</p>

<p>while the reproductive value is given by
</p>
<p style="text-align: center;"><code class="reqn">
\nu_x = \frac{\int_x^\tau{e^{-r(k - x)}} S(k) m(k) dk}{S(x)}.
</code>
</p>

<p>The function then calculates the sensitivities of lambda to age-specific survival as
</p>
<p style="text-align: center;"><code class="reqn">
s_{p,x} = \frac{\nu_{x}\omega_{x+1}}{&lt;\bm{\nu}\bm{\omega}&gt;}, \quad \text{for } x&lt;\tau
</code>
</p>

<p>where the denominator is the inner product, and the sensitivity of lambda to the reproductive value at <code class="reqn">x</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
s_{m,x} = \frac{\nu_{1}\omega_{x+1}}{&lt;\bm{\nu}\bm{\omega}&gt;}, \quad \text{for } x&lt;\tau
</code>
</p>

<p>Elasticities are calculated as
</p>
<p style="text-align: center;"><code class="reqn">
e_{p,x} = \frac{p_x}{\lambda} s_{p,x} \text{ and } e_{m,x} = \frac{m_x}{\lambda} s_{m,x}.
</code>
</p>

<p><b>6) Calculation of life history variables</b>
</p>
<p>The first life history variables are the intrinsic population growth rate <code class="reqn">r</code> and the stable population growth rate <code class="reqn">\lambda = e^r</code>, described in the previous section. 
</p>
<p>The function also provides a number of life history variables described by Tuljapurkar <em>et al.</em> (2009). For instance, it provides the generation time for the stable population as
</p>
<p style="text-align: center;"><code class="reqn">
T_s = \int_0^{\tau} x e^{-rx} S(x) m(x) dx,
</code>
</p>

<p>as well as the cohort generation time, given by
</p>
<p style="text-align: center;"><code class="reqn">
T_c = \frac{\int_0^{\tau} x S(x) m(x) dx}{R_0},
</code>
</p>

<p>where <code class="reqn">R_0</code> is the net reproductive rate, given by
</p>
<p style="text-align: center;"><code class="reqn">
R_0 = \int_0^{\tau} S(x) m(x) dx.
</code>
</p>

<p>It provides the demographic dispersion given by
</p>
<p style="text-align: center;"><code class="reqn">
\sigma^2_d = \frac{\int_0^\tau (x - T_c)^2 S(x) m(x) dx}{R_0}
</code>
</p>

<p>which measures the dispersion of reproduction across ages. 
</p>
<p>Finally, it calculates the population entropy as proposed by Demetrius (1974), given by
</p>
<p style="text-align: center;"><code class="reqn">
H = - \frac{\int_0^{\tau} \rho(x) \log \rho(x) dx}{T_s}
</code>
</p>

<p>where <code class="reqn">\rho(x) = e^{-r x} S(x) m(x)</code>.
</p>


<h3>Value</h3>

<p>The function produces an object of class &ldquo;<code>PDlifeHist</code>&rdquo;, which consists of a list with the following elements:
</p>
<table>
<tr><td><code>demoTab</code></td>
<td>
<p>A data frame with the resulting individual ages, the survival <code class="reqn">S(x)</code>, the age-specific survival probability <code class="reqn">p_x</code>, the age-specific mortality probability <code class="reqn">q_x</code>, the age-specific fertility rate <code class="reqn">m_x</code>, the stable age structure <code class="reqn">omega_x</code>, the age specific reproductive value <code class="reqn">nu_x</code>, and the sensitivities and elasticities.</p>
</td></tr>
<tr><td><code>lifeHist</code></td>
<td>
<p>A data frame with the life history variables described in details, including a description.</p>
</td></tr>
<tr><td><code>settings</code></td>
<td>
<p>A list with the information of the models and parameters as provided by the user.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>References</h3>

<p>Asili S., Rezaei S., Najjar, L. (2014) Using Skew-Logistic Probability Density Function as a Model for Age-Specific Fertility Rate Pattern. <em>BioMed Research International</em>, 2014, 790294.
</p>
<p>Azzalini, A. (1985) A Class of Distributions Which Includes the Normal Ones. <em>Scandinavian Journal of Statistics</em>, 2, 171-178.
</p>
<p>Caswell, H. &amp; Werner, P. A. (1978) Transient Behavior and Life History Analysis of Teasel (Dipsacus Sylvestris Huds.). Ecology 59, 53-66.
</p>
<p>Caswell, H. (2001) Matrix Population Models: Construction, Analysis and Interpretation. (Sinauer Associates).
</p>
<p>Chandola, T., Coleman D.A., Hiorns R.W. (1999) Recent European fertility patterns: Fitting curves to &lsquo;distorted&rsquo; distributions. <em>Population Studies</em>, 53, 317-329.
</p>
<p>Colchero, F. (<em>In prep.</em>) Inference on age-specific fertility in ecology and evolution. Learning from other disciplines and improving the state of the art. 
</p>
<p>Colchero, F., Eckardt, W., Stoinski, T. (2021) Evidence of demographic buffering in an endangered great ape: Social buffering on immature survival and the role of refined sex-age classes on population growth rate. <em>Journal of Animal Ecology</em>, 90, 1701-1713.
</p>
<p>Colchero, F., J.S. Clark (2012) Bayesian inference on age-specific survival from capture-recapture data for censored and truncated data. <em>Journal of Animal Ecology</em>. 81, 139-149.
</p>
<p>Colchero, F., O.R. Jones, M. Rebke. (2012) BaSTA: an R package for Bayesian estimation of age-specific survival from incomplete mark-recapture/recovery data with covariates. <em>Method in Ecology and Evolution</em>. 3, 466-470. 
</p>
<p>Colchero, F., <em>et al.</em> (2021) The long lives of primates and the &ldquo;invariant rate of aging&rdquo; hypothesis. <em>Nature Communications</em> 12:3666
</p>
<p>Cox, D. R., and Oakes D. (1984) <em>Analysis of Survival Data</em>. Chapman and Hall, London.
</p>
<p>Demetrius, L. (1974) Demographic parameters and natural selection. <em>PNAS</em> 71, 4645-4647.
</p>
<p>Gompertz, B. (1825) On the nature of the function expressive of the law of human mortality, and on a new mode of determining the value of life contingencies. <em>Philosophical Transactions of the Royal Society of London</em>, 115, 513-583.
</p>
<p>Hadwiger, H. (1940) Eine analytische Reproduktionssunktion fur biologische Gesamtheiten. <em>Scandinavian Actuarial Journal</em>, 1940, 101-113.
</p>
<p>Hoem, J.M., Madien, D., Nielsen, J.L., Ohlsen, E.M., Hansen, H.O., Rennermalm, B. (1981) Experiments in modelling recent Danish fertility curves. <em>Demography</em>, 18, 231-244.
</p>
<p>Keyfitz, N., Caswell, H. (2005) Applied Mathematical Demography. (Springer-Verlag).
</p>
<p>Kroon, H. de, Plaisier, A., Groenendael, J. van &amp; Ecology, H. C. (1986) Elasticity: the relative contribution of demographic parameters to population growth rate. Ecology 67, 1427-1431.
</p>
<p>Lotka, A. J. (1913) A natural population norm. II. Journal of the Washington Academy of Sciences 3, 289-293.
</p>
<p>Makeham, W. M. (1866) On the law of mortality <em>Journal of the Institute of Actuaries</em> 13, 1-34.
</p>
<p>Mazzuco, S., Scarpa, B. (2011) Fitting age-specific fertility rates by a skew- symmetric probability density function. (Working paper 10), University of Padua.
</p>
<p>Mazzuco, S., Scarpa, B. (2015) Fitting age-specific fertility rates by a flexible generalized skew normal probability density function. <em>Journal of the Royal Statistical Society: Series A</em>, 178, 187-203.
</p>
<p>Muller M. N., Blurton Jones N. G, Colchero F., Thompson M. E., Enigk D. K. (2020) Sexual dimorphism in chimpanzee (<em>Pan troglodytes schweinfurthii</em>) and human age-specific fertility. <em>Journal of human evolution</em>, 144, 102795.
</p>
<p>Peristera P., Kostaki A. (2007) Modeling fertility in modern populations. <em>Demographic Research</em>, 16, 141-194.
</p>
<p>Pinder III, J.E., Wiener, J.G. and Smith, M.H. (1978) The Weibull distribution: a new method of summarizing survivorship data. <em>Ecology</em>, 59, 175-179.
</p>
<p>Shkolnikov, V., Andreev, E., Begun, A. Z. (2003) Gini coefficient as a life table function. <em>Demographic Research</em> 8, 305-358.
</p>
<p>Siler W. A (1979) competing-risk model for animal mortality. <em>Ecology</em> 60, 750-757.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcDemo">CalcDemo</a></code> to calculate parametric demographic functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate life histories on the defalult models:
test &lt;- CalcLifeHist(theta = c(b0 = -3, b1 = 0.1), 
                     beta = c(b0 = 1, b1 = 0.01, b2 = 5),
                     ageMatur = 2)
                     
# Print results:
test

# Plot results:
plot(test, type = "all")
</code></pre>

<hr>
<h2 id='CalcLifeTable'>
Calculating a Life Table from Data.
</h2><span id='topic+CalcLifeTable'></span>

<h3>Description</h3>

<p><code>CalcLifeTable</code> uses non-parametric methods to calculate life tables and confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcLifeTable(ageLast, ageFirst = NULL, departType, dx = 1, 
                          calcCIs = FALSE, nboot = 1000, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcLifeTable_+3A_agelast">ageLast</code></td>
<td>
<p>Numerical vector with the ages at last detection (i.e., death and censoring) (see <code>details</code>)</p>
</td></tr>
<tr><td><code id="CalcLifeTable_+3A_agefirst">ageFirst</code></td>
<td>
<p>Numerical vector of ages at first detection (i.e., truncation). If <code>NULL</code> then all values are set to 0 (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcLifeTable_+3A_departtype">departType</code></td>
<td>
<p>Character string vector for the type of departure (i.e., last detection), with values &ldquo;<code>D</code>&rdquo; for death and &ldquo;<code>C</code>&rdquo; for censoring (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcLifeTable_+3A_dx">dx</code></td>
<td>
<p>Age interval size, default set at 1 (see <code>details</code>)</p>
</td></tr>
<tr><td><code id="CalcLifeTable_+3A_calccis">calcCIs</code></td>
<td>
<p>Logical indicating whether confidence intervals should be calculated</p>
</td></tr>
<tr><td><code id="CalcLifeTable_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap iterations</p>
</td></tr>
<tr><td><code id="CalcLifeTable_+3A_alpha">alpha</code></td>
<td>
<p>Alpha level. Default is 0.05 for 95% CIs</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>1) Data structure:</b>
</p>
<p><code>CalcLifeTable</code> allows to construct life tables for data that includes the following types of records:
</p>
 
<ul>
<li><p><b>Uncensored</b>: individuals with known ages at death;
</p>
</li>
<li><p><b>right-censored</b>: individuals last seen alive;
</p>
</li>
<li><p><b>left-truncated</b>: individuals born before the start of the study and are truncated at the age of entry. 
</p>
</li></ul>

<p>The data required are the ages at last detection (i.e., <em>uncensored</em> or <em>right-censored</em>) passed through argument &ldquo;<code>ageLast</code>&rdquo;, the type of departure via argument &ldquo;<code>departType</code>&rdquo;, which takes two values, namely &ldquo;<code>D</code>&rdquo; for death, and &ldquo;<code>C</code>&rdquo; for censored (i.e., right-censored). 
</p>
<p>In addition, if there is <em>left-truncation</em>, it takes the ages at entry to the study by means of argument &ldquo;<code>ageFirst</code>&rdquo;. If all the individuals were born during the study, the value of &ldquo;<code>ageFirst</code>&rdquo; can be left as <code>NULL</code>, which will make them all equal to 0. 
</p>
<p><b>2) Computing life tables</b>
</p>
<p>To calculate life tables, the function uses conventional formal demgraphic methods as depicted by Preston <em>et al.</em> (2001). Argument &ldquo;<code>ageLast</code>&rdquo; provides a vector of ages at last detection, <code class="reqn">\bold{x}^{\top} = [x_1, x_2, \dots, x_n]</code>, while argument &ldquo;<code>ageFirst</code>&rdquo; provides a vector of ages at first detection <code class="reqn">\bold{y}^{\top} = [y_1, y_2, \dots, y_n]</code>. From argument &ldquo;<code>departType</code>&rdquo; the function produces an indicator vector for censoring <code class="reqn">\bold{v} = \{v_i\}_{i \in \mathbb{N}_n}</code> where <code class="reqn">v_i = 1</code> if individual <code class="reqn">i</code> is censored and 0 otherwise. 
</p>
<p>The function creates a partition of the interval of ages between 0 and <code class="reqn">\max(x)</code>, for age intervals <code class="reqn">[x, x + \Delta x)</code> where <code class="reqn">\Delta x</code> is specified by argument &ldquo;<code>dx</code>&rdquo;. As default <code>dx = 1</code>. At each age interval, the function calculates the following variables:
</p>

<ul>
<li> <p><code>Nx</code>: which corresponds to number of individuals that entered the interval, but considering the proportion of time they were present within the interval as a function of left-truncation. It is given by
</p>
<p style="text-align: center;"><code class="reqn">
N_x = \sum_{i \in I_x} \lambda_{i,x},
</code>
</p>

<p>where <code class="reqn">I_x</code> is the subset of individuals recorded within the interval, and <code class="reqn">\lambda_{i, x}</code> is the proportion of time during the age interval each individual was present in the study. For individuals that entered the study before <code class="reqn">x</code> then <code class="reqn">\lambda_{i,x} = 1</code>, while for those that were truncated within the interval <code class="reqn">\lambda_{i,x} = (x + \Delta x - y_i) / \Delta x</code>. 
</p>
</li>
<li> <p><code>Dx</code>: the number of individuals dying in the interval.
</p>
</li>
<li> <p><code>qx</code>: the age-specific mortality probability, calculated as <code class="reqn">q_x = D_x / N_x</code>. 
</p>
</li>
<li> <p><code>px</code>: the age-specific survival probability, given by <code class="reqn">p_x = 1 - q_x</code>.
</p>
</li>
<li> <p><code>lx</code>: the life table survival calculated as 
</p>
<p style="text-align: center;"><code class="reqn">
l_x = \prod_{j = 0}^{x-1} p_j
</code>
</p>

<p>where <code class="reqn">l_0 = 1</code>. 
</p>
</li>
<li> <p><code>ax</code>: Proportion of the interval lived by those that died in the interval, given by
</p>
<p style="text-align: center;"><code class="reqn">
a_x = \frac{\sum_{i\in J_{x}} \delta_{i,x}}{D_x}
</code>
</p>

<p>where <code class="reqn">J_{x}</code> is the subset of individuals that died within the interval, and <code class="reqn">\delta_{i,x}</code> is the proportion lived by those individuals from the start of the interval to their deaths, this is <code class="reqn">\delta_{i,x} = (x_i - x) / \Delta x</code>. 
</p>
</li>
<li> <p><code>Lx</code>: The number of individual years lived within the interval, given by
</p>
<p style="text-align: center;"><code class="reqn">
L_x = l_x (1 - a_x q_x)
</code>
</p>

</li>
<li> <p><code>Tx</code>: The total number of individual years lived after age <code class="reqn">x</code>, given by <code class="reqn">T_x = \sum_{j = x}^{\infty} L_j \Delta x</code>
</p>
</li>
<li> <p><code>ex</code>: the remaining life expectancy at the beginning of each age interval, calculated as <code class="reqn">e_x = T_x / l_x</code>.
</p>
</li></ul>

<p><b>3) Calculating confidence intervals</b>
If argument &ldquo;<code>calcCIs</code>&rdquo; is set to <code>TRUE</code>, the function uses a non-parametric bootstrap by sampling with replacement the data. Argument <code>nboot</code> specifies the number of bootstrap steps, with default <code>nboot = 2000</code>. From each re-sampled dataset, it uses function <code><a href="#topic+CalcLifeTable">CalcLifeTable</a></code> to construct the corresponding life table and stores the values of $l_x$, $q_x$, $p_x$, and $e_x$ from each iteration. From these, it calculates quantiles at the given alpha level. 
</p>


<h3>Value</h3>

<p><code>CalcLifeTable</code> returns an object of class &ldquo;<code>paramDemoLT</code>&rdquo; with output consisting of a list with the life table and, if indicated by the user, with the confidence interval information. The life table in matrix format includes the following columns:
</p>
<table>
<tr><td><code>Ages</code></td>
<td>
<p>Ages with increments given by <code>dx</code></p>
</td></tr>
<tr><td><code>Nx</code></td>
<td>
<p>Number of individuals entering the interval, does not need to be an integer since it considers truncation</p>
</td></tr>
<tr><td><code>Dx</code></td>
<td>
<p>Number of individuals that died within the age interval</p>
</td></tr>
<tr><td><code>lx</code></td>
<td>
<p>Survival (i.e., cumulative survival)</p>
</td></tr>
<tr><td><code>px</code></td>
<td>
<p>Age-specific survival probability</p>
</td></tr>
<tr><td><code>qx</code></td>
<td>
<p>Age-specific mortality probability</p>
</td></tr>
<tr><td><code>Lx</code></td>
<td>
<p>Number of individual years lived within the interval</p>
</td></tr>
<tr><td><code>Tx</code></td>
<td>
<p>Number of individual years lived after age x</p>
</td></tr>
<tr><td><code>ex</code></td>
<td>
<p>Remaining life expectancy at each age</p>
</td></tr>
</table>
<p>If argument <code>calcCIs = TRUE</code>, the function also returns a list containing the following components:
</p>
<table>
<tr><td><code>lx</code></td>
<td>
<p>Matrix with Ages and mean and upper and lower CIs for the life table survival</p>
</td></tr>
<tr><td><code>qx</code></td>
<td>
<p>Matrix with Ages and mean and upper and lower CIs for the age-specific mortality probability</p>
</td></tr>
<tr><td><code>px</code></td>
<td>
<p>Matrix with Ages and mean and upper and lower CIs for the age-specific survival probability</p>
</td></tr>
<tr><td><code>ex</code></td>
<td>
<p>Matrix with Ages and mean and upper and lower CIs for the remaining life expectancy</p>
</td></tr>
<tr><td><code>Settings</code></td>
<td>
<p>Numerical vector including whether CIs were calculated, the number of bootstrap iterations, &ldquo;<code>nboot</code>&rdquo; and the alpha level &ldquo;<code>alpha</code>&rdquo;</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>References</h3>

<p>Preston, S.H., Heuveline, P. and Guillot, M. (2001) Demography: Measuring and Modeling Population Processes. Blackwell, Oxford.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcProductLimitEst">CalcProductLimitEst</a></code> to calculate product limit estimators.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate age at death data from Gompertz model:
ages &lt;- SampleRandAge(n = 100, theta = c(b0 = -5, b1 = 0.1))

# Calculate life table:
lt &lt;- CalcLifeTable(ageLast = ages, departType = rep("D", 100))

# Calculate life table with 95% CIs:
ltCIs &lt;- CalcLifeTable(ageLast = ages, departType = rep("D", 100), 
                       calcCIs = TRUE, nboot = 100)

</code></pre>

<hr>
<h2 id='CalcMort'>
Calculating Parametric Age-Specific Mortality and survival.
</h2><span id='topic+CalcMort'></span><span id='topic+CalcSurv'></span>

<h3>Description</h3>

<p><code>CalcMort</code> and <code>CalcSurv</code> are used to calculate the age-specific mortality and survival functions from different parametric models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcMort(theta, x, model = "GO", shape = "simple", 
          checkTheta = TRUE)

CalcSurv(theta, x, model = "GO", shape = "simple", 
          checkTheta = TRUE)          
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcMort_+3A_theta">theta</code></td>
<td>
<p>Numerical vector of age-specific mortality parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcMort_+3A_x">x</code></td>
<td>
<p>Numerical vector of ages at which to calculate mortality.</p>
</td></tr>
<tr><td><code id="CalcMort_+3A_model">model</code></td>
<td>
<p>The underlying mortality model to be used. <code>"EX"</code> = exponential,<code>"GO"</code> = Gompertz, <code>"WE"</code> = Weibull and <code>"LO"</code> = logistic (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcMort_+3A_shape">shape</code></td>
<td>
<p>The overall shape of the model. Values are: <code>simple</code> = no extra parameters added; <code>Makeham</code> = a constant parameter is added to the mortality; and <code>bathtub</code> = a Gompertz declining mortality for early ages and a constant parameter are added to the mortality model (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcMort_+3A_checktheta">checkTheta</code></td>
<td>
<p>Logical to verify that the <code>beta</code> parameters conform with the model's specification (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>1) Age-specific mortality and survival models:</b>
</p>
<p>The function <code>CalcMort</code> uses parametric functions to calculate age-specific survival, defined as the probability of surviving to a given age. The function follows the conventions from package BaSTA (Colchero and Clark 2012, Colchero <em>et al.</em> 2012, Colchero <em>et al.</em> 2021). The mortality function or hazard rate describes how the risk of mortality changes with age, and is defined as 
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \theta) = \lim_{\Delta x \rightarrow 0} \frac{\Pr[x &lt; X &lt; x + \Delta x | X &gt; x]}{\Delta x},
</code>
</p>

<p>where <code class="reqn">X</code> is a random variable for ages at death, <code class="reqn">x \geq 0</code> are ages and <code class="reqn">\theta</code> is the vector of mortality parameters. From the mortality function, the survival function is then given by
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = \Pr[X &gt; x] = \exp[-\int_0^x \mu(t | \bm{\theta}) dt],
</code>
</p>

<p>with the cumulative distribution function <code class="reqn">F(x | \bm{\theta}) = 1 - S(x | \bm{\theta})</code>. The probability density function of ages at death is 
</p>
<p style="text-align: center;"><code class="reqn">
f(x | \bm{\theta}) = \mu(x | \bm{\theta}) S(x | \bm{\theta}), 
</code>
</p>

<p>for <code class="reqn">x \geq 0</code>. 
</p>
<p><code>1.1)</code><code>Argument </code>&ldquo;<code>model</code>&rdquo;<code>:</code>
</p>
<p>The <code>model</code> argument allows the user to choose between four basic mortality functions, namely 
</p>
<p>(a) <code>model = </code>&ldquo;<code>EX</code>&rdquo;: The exponential model (Cox and Oakes 1974), with constant mortality with age, specified as
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = b,</code>
</p>

<p>where <code class="reqn">b &gt; 0</code>, with survival 
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp[-b x].
</code>
</p>

<p>(b) <code>model = </code>&ldquo;<code>GO</code>&rdquo;: The Gompertz mortality model (Gompertz 1925, Pletcher 1999), calculated as 
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = \exp(b_0 + b_1 x),</code>
</p>

<p>where <code class="reqn">-\infty &lt; b_0, b_1 &lt; \infty</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp\left[\frac{e^{b_0}}{b_1}\left(1 - e^{b_1 x}\right)\right].
</code>
</p>

<p>(c) <code>model = </code>&ldquo;<code>WE</code>&rdquo;: The Weibull mortality model (Pinder III <em>et al.</em> 1978) calculated as
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = b_0 b_1^{b_0} x^{b_0 -1},</code>
</p>

<p>where <code class="reqn">b_0, b_1 &gt; 0</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \exp\left[-(b_1 x)^{b_0}\right].
</code>
</p>

<p>(d) <code>model = </code>&ldquo;<code>LO</code>&rdquo;: The logistic mortality model (Pletcher 1999), calculated as 
</p>
<p style="text-align: center;"><code class="reqn">\mu_b(x | \bm{\theta}) = \frac{\exp(b_0 + b_1 x)}{1 + b_2 \frac{e^{b_0}}{b_1} \left(e^{b_1 x}-1\right)},</code>
</p>

<p>where <code class="reqn">b_0, b_1, b_2 &gt; 0</code>, with survival
</p>
<p style="text-align: center;"><code class="reqn">
S_b(x | \bm{\theta}) = \left[1 + b_2 \frac{e^{b_0}}{b_1} \left(e^{b_1 x} - 1\right)\right]^{-1 / b_2}.
</code>
</p>

<p><code>1.2)</code><code>Argument </code>&ldquo;<code>shape</code>&rdquo;<code>:</code>
</p>
<p>The <code>shape</code> argument allows the user to extend these models in order to explore more complex mortality shapes. 
</p>
<p>(a) <code>shape = </code>&ldquo;<code>simple</code>&rdquo;: (default) Leaves the model as defined above, with mortality given by
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = \mu_b(x | \bm{\theta})
</code>
</p>

<p>and survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = S_b(x | \bm{\theta}.
</code>
</p>

<p>(b) <code>shape = </code>&ldquo;<code>Makeham</code>&rdquo;: A constant is added to the mortality, such that the mortality is given by
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = c + \mu_b(x | \bm{\theta}_1),
</code>
</p>

<p>where <code class="reqn">\bm{\theta} = [c, \bm{\theta}_1]</code>, and with survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \bm{\theta}) = e^{-cx} S_b(x | \bm{\theta}_1)
</code>
</p>

<p>The most common models with this shape is the Gompertz-Makeham model (Gompertz 1825, Makeham 1866).
</p>
<p>(c) <code>shape = </code>&ldquo;<code>bathtub</code>&rdquo;: produces a concave shapes in mortality by adding a declining Gompertz term and a constant parameter to the basic mortality model, where the mortality function is
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \bm{\theta}) = \exp(a_0 - a_1 x) + c + \mu_b(x | \bm{\theta}_1),
</code>
</p>

<p>where <code class="reqn">a_0 \in \mathbb{R}</code>, <code class="reqn">a_1, c \geq 0</code> and <code class="reqn">\bm{\theta}_1 \subset \bm{\theta}</code> are specified based on argument <code>model</code>, and with survival
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \theta) = \exp\left[\frac{e^{a_0}}{a_1}\left(e^{a_1 x} - 1\right)-cx\right] S_b(x | \theta_1).
</code>
</p>

<p>The most widely use &ldquo;<code>bathtub</code>&rdquo; shaped model is the <b>Siler mortality model</b> (Siler 1979), which provides considerably good fits to mammalian data. The arguments for the Siler model are:
</p>
<pre>CalcMort(..., model = "GO", shape = "bathtub", ...)</pre>
<p><b>2) Specifying theta parameters:</b>
</p>
<p>Argument <code>theta</code> requires a numerical vector of parameters. For instance, for a Gompertz model with simple shape and with parameter vector <code class="reqn">\bm{\theta}^{\top} = [b_0, b_1]</code> where <code class="reqn">b_0 = -5</code> and <code class="reqn">b_1 = 0.1</code>, the argument should be specified as 
</p>
<p><code>CalcMort(theta = c(b0 = -5, b1 = 0.1), ...)</code> 
</p>
<p>Note that in this example the parameter names are specified directly, this is required when <code>checkTheta = FALSE</code>. Although assigning the names to each parameter is not necessary when <code>checkTheta = TRUE</code>, it is advisable to ensure that the right values are assigned to the right parameter.  
</p>
<p>If argument <code>checkTheta</code> is set to <code>TRUE</code>, then the vector of <code>theta</code> parameters is verified for consistency with the requirements of the model and shape selected. 
</p>


<h3>Value</h3>

<p><code>CalcMort</code> and <code>CalcSur</code> return a vector of class &ldquo;<code>numeric</code>&rdquo; with the hazard rate or cumulative survival values at the specified ages, respectively.
</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>References</h3>

<p>Colchero, F. and J.S. Clark (2012) Bayesian inference on age-specific survival from capture-recapture data for censored and truncated data. <em>Journal of Animal Ecology</em>. 81, 139-149.
</p>
<p>Colchero, F., O.R. Jones and M. Rebke. (2012) BaSTA: an R package for Bayesian estimation of age-specific survival from incomplete mark-recapture/recovery data with covariates. <em>Method in Ecology and Evolution</em>. 3, 466-470. 
</p>
<p>Colchero, F., <em>et al.</em> (2021) The long lives of primates and the &quot;invariant rate of aging&quot; hypothesis. <em>Nature Communications</em> 12:3666
</p>
<p>Cox, D. R., and Oakes D. (1984) <em>Analysis of Survival Data</em>. Chapman and Hall, London.
</p>
<p>Gompertz, B. (1825) On the nature of the function expressive of the law of human mortality, and on a new mode of determining the value of life contingencies. <em>Philosophical Transactions of the Royal Society of London</em>, 115, 513-583.
</p>
<p>Makeham, W. M. On the law of mortality (1866). <em>Journal of the Institute of Actuaries</em> 13, 1-34.
</p>
<p>Pinder III, J.E., Wiener, J.G. and Smith, M.H. (1978) The Weibull distribution: a new method of summarizing survivorship data. <em>Ecology</em>, 59, 175-179.
</p>
<p>Siler, W. A (1979) competing-risk model for animal mortality. <em>Ecology</em> 60, 750-757.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcSurv">CalcSurv</a></code> to calculate age-specific survival, <code><a href="#topic+CalcFert">CalcFert</a></code> to calculate age-specific fertility.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Gompertz age specific mortality (default):
mort &lt;- CalcMort(theta = c(b0 = -5, b1 = 0.1), x = 10)

# Siler age specific mortality:
mort &lt;- CalcMort(theta = c(a0 = -1, a1 = 1, c = 0.0001, 
                          b0 = -6, b1 = 0.15), x = 10,
                  model = "GO", shape = "bathtub")

# Gompertz age specific survival (default):
surv &lt;- CalcSurv(theta = c(b0 = -5, b1 = 0.1), x = 10)

# Siler age specific survival:
surv &lt;- CalcSurv(theta = c(a0 = -1, a1 = 1, c = 0.0001, 
                          b0 = -6, b1 = 0.15), x = 10,
                  model = "GO", shape = "bathtub")


</code></pre>

<hr>
<h2 id='CalcProductLimitEst'>
Calculating the product limit estimator from Data.
</h2><span id='topic+CalcProductLimitEst'></span>

<h3>Description</h3>

<p><code>CalcProductLimitEst</code> uses non-parametric methods to calculate the product limit estimator and confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcProductLimitEst(ageLast, ageFirst = NULL, departType,
                     calcCIs = FALSE, nboot = 1000, alpha = 0.05)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcProductLimitEst_+3A_agelast">ageLast</code></td>
<td>
<p>Numerical vector with the ages at last detection (i.e., death and censoring) (see <code>details</code>)</p>
</td></tr>
<tr><td><code id="CalcProductLimitEst_+3A_agefirst">ageFirst</code></td>
<td>
<p>Numerical vector of ages at first detection (i.e., truncation). If <code>NULL</code> then all values are set to 0 (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcProductLimitEst_+3A_departtype">departType</code></td>
<td>
<p>Character string vector for the type of departure (i.e., last detection), with values &ldquo;<code>D</code>&rdquo; for death and &ldquo;<code>C</code>&rdquo; for censoring (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcProductLimitEst_+3A_calccis">calcCIs</code></td>
<td>
<p>Logical indicating whether confidence intervals should be calculated</p>
</td></tr>
<tr><td><code id="CalcProductLimitEst_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap iterations</p>
</td></tr>
<tr><td><code id="CalcProductLimitEst_+3A_alpha">alpha</code></td>
<td>
<p>Alpha level. Default is 0.05 for 95% CIs</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>1) Data structure:</b>
</p>
<p>The function allows to calculate product limit estimator (Wann <em>et al.</em> 1987) for data that includes the following types of records:
</p>
 
<ul>
<li><p><b>Uncensored</b>: individuals with known ages at death;
</p>
</li>
<li><p><b>right-censored</b>: individuals last seen alive;
</p>
</li>
<li><p><b>left-truncated</b>: individuals born before the start of the study and are truncated at the age of entry. 
</p>
</li></ul>

<p>The data required are the ages at last detection (i.e., <em>uncensored</em> or <em>right-censored</em>) passed through argument &ldquo;<code>ageLast</code>&rdquo;, the type of departure via argument &ldquo;<code>departType</code>&rdquo;, which takes two values, namely &ldquo;<code>D</code>&rdquo; for death, and &ldquo;<code>C</code>&rdquo; for censored (i.e., right-censored). 
</p>
<p>In addition, if there is <em>left-truncation</em>, it takes the ages at entry to the study by means of argument &ldquo;<code>ageFirst</code>&rdquo;. If all the individuals were born during the study, the value of &ldquo;<code>ageFirst</code>&rdquo; can be left as <code>NULL</code>, which will make them all equal to 0. 
</p>


<h3>Value</h3>

<p><code>CalcProductLimitEst</code> returns an object of class &ldquo;<code>paramDemoPLE</code>&rdquo; with consists of a data frame and, if indicated by the user, the confidence interval of the PLE. The data frame includes the following numerical columns:
</p>
<table>
<tr><td><code>Ages</code></td>
<td>
<p>ages when individuals died</p>
</td></tr>
<tr><td><code>ple</code></td>
<td>
<p>product limit estimator</p>
</td></tr>
<tr><td><code>Lower</code></td>
<td>
<p>If indicated with argument <code>calcCIs</code>, the lower <code class="reqn">\alpha / 2</code> confidence bound</p>
</td></tr>
<tr><td><code>Lower</code></td>
<td>
<p>If indicated with argument <code>calcCIs</code>, the upper <code class="reqn">1 - \alpha / 2</code> confidence bound</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcLifeTable">CalcLifeTable</a></code> to calculate life tables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate age at death data from Gompertz model:
ages &lt;- SampleRandAge(n = 100, theta = c(b0 = -5, b1 = 0.1))

# Calculate life table:
lt &lt;- CalcLifeTable(ageLast = ages, departType = rep("D", 100))

</code></pre>

<hr>
<h2 id='CalcRemainLifeExp'>
Calculating Remaining Life Expectancy.
</h2><span id='topic+CalcRemainLifeExp'></span>

<h3>Description</h3>

<p><code>CalcRemainingLifeExp</code> calculates remaining life expectancy from parametric models of age-specific mortality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcRemainLifeExp (theta, x = NULL, dx = NULL, xmax = NULL,
                              atAllAges = FALSE, model = "GO", 
                              shape = "simple", checkTheta = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcRemainLifeExp_+3A_theta">theta</code></td>
<td>
<p>Numerical vector of age-specific mortality parameters (see details).</p>
</td></tr>
<tr><td><code id="CalcRemainLifeExp_+3A_x">x</code></td>
<td>
<p>Numerical vector of ages at which to calculate mortality.</p>
</td></tr>
<tr><td><code id="CalcRemainLifeExp_+3A_dx">dx</code></td>
<td>
<p>Numerical value for the width of age intervals used for integration. If <code>NULL</code>, default is <code>dx = 0.01</code></p>
</td></tr>
<tr><td><code id="CalcRemainLifeExp_+3A_xmax">xmax</code></td>
<td>
<p>Numerical value for the maximum age. If <code>NULL</code>, the value is obtain as the age when the surviva</p>
</td></tr>
<tr><td><code id="CalcRemainLifeExp_+3A_atallages">atAllAges</code></td>
<td>
<p>Logical to indicate whether ageing rates should be provided between ages 0 and <code>xmax</code></p>
</td></tr>
<tr><td><code id="CalcRemainLifeExp_+3A_model">model</code></td>
<td>
<p>The underlying mortality model to be used. <code>"EX"</code> = exponential,<code>"GO"</code> = Gompertz, <code>"WE"</code> = Weibull and <code>"LO"</code> = logistic (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcRemainLifeExp_+3A_shape">shape</code></td>
<td>
<p>The overall shape of the model. Values are: <code>simple</code> = no extra parameters added; <code>Makeham</code> = a constant parameter is added to the mortality; and <code>bathtub</code> = a Gompertz declining mortality for early ages and a constant parameter are added to the mortality model (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="CalcRemainLifeExp_+3A_checktheta">checkTheta</code></td>
<td>
<p>Logical to verify that the <code>beta</code> parameters conform with the model's specification (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>CalcAgeingRate</code> uses parametric functions to calculate the actuarial (i.e., survival) rate of ageing. The function follows the conventions from package BaSTA (Colchero and Clark 2012, Colchero <em>et al.</em> 2012, Colchero <em>et al.</em> 2021) to select the parametric model of mortality. The mortality function describes how the risk of mortality changes with age, and is defined as 
</p>
<p style="text-align: center;"><code class="reqn">
\mu(x | \theta) = \lim_{\Delta x \rightarrow 0} \frac{\Pr[x &lt; X &lt; x + \Delta x | X &gt; x]}{\Delta x},
</code>
</p>

<p>where <code class="reqn">X</code> is a random variable for ages at death, <code class="reqn">x \geq 0</code> are ages and <code class="reqn">\theta</code> is the vector of mortality parameters. From the mortality function, the survival function is then given by
</p>
<p style="text-align: center;"><code class="reqn">
S(x | \theta) = \exp[-\int_0^x \mu(t | \theta) dt].
</code>
</p>

<p>(For further details on the mortality and survival models see <code><a href="#topic+CalcMort">CalcMort</a></code>). 
</p>
<p>Given a vector of ages <code class="reqn">x_1, x_2, \dots, x_n</code> specified by the user with argument <code>x</code>, the function calculates the remaining life expectancy at age <code class="reqn">x_i</code> as
</p>
<p style="text-align: center;"><code class="reqn">
e_{x_i} = \frac{\int_{x_i}^{\infty} S(t) dt}{S(x_i)}
</code>
</p>

<p>for <code class="reqn">i = 1, 2, \dots, n</code>. 
</p>


<h3>Value</h3>

<p>The function outputs a matrix with the ages from which remaining life expectancies were calculated, and the values for the remaining life expectancy. 
</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcSurv">CalcSurv</a></code> to calculate age-specific survival, <code><a href="#topic+CalcMort">CalcMort</a></code> to calculate age-specific mortality, <code><a href="#topic+CalcFert">CalcFert</a></code> to calculate age-specific fertility.
</p>
<p><code><a href="#topic+CalcAgeMaxFert">CalcAgeMaxFert</a></code> to calculate the age at maximum fertility from parametric models of age-specific fertility. <code><a href="#topic+CalcAgeingRateMort">CalcAgeingRateMort</a></code> to calculate ageing rates from parametric models of age-specific mortality.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate ageing rate from Gompertz model:
rle &lt;- CalcRemainLifeExp(theta = c(b0 = -5, b1 = 0.1), x = 10)

# Calculate ageing rate from Siler model:
rle &lt;- CalcRemainLifeExp(theta = c(a0 = -1, a1 = 1, c = 0.0001, 
                          b0 = -6, b1 = 0.15), x = 10,
                     model = "GO", shape = "bathtub")

</code></pre>

<hr>
<h2 id='plot.paramDemo'>
Functions to plot parametric demographic functions
</h2><span id='topic+plot.paramDemo'></span>

<h3>Description</h3>

<p>Draw a plot of demographic functions produced with function <code>CalcDemo</code> 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'paramDemo'
plot(x, demofun = "all", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.paramDemo_+3A_x">x</code></td>
<td>
<p>Object of class &ldquo;<code>paramDemo</code>&rdquo;</p>
</td></tr>
<tr><td><code id="plot.paramDemo_+3A_demofun">demofun</code></td>
<td>
<p>Character string for the demographic function to be ploted</p>
</td></tr>
<tr><td><code id="plot.paramDemo_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to function <code>plot</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for plotting objects of class &ldquo;<code>paramDemo</code>&rdquo;</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcDemo">CalcDemo</a></code> to calculate parametric demographic functions. </p>


<h3>Examples</h3>

<pre><code class='language-R'># Create paramDemo object from Gompertz mortality and
# quadratic fertility:
dem &lt;- CalcDemo(theta = c(b0 = -5, b1 = 0.1), 
                 beta = c(b0 = 0.5, b1 = 0.01, b2 = 10),
                 summarStats = TRUE, agesAR = c(5, 10))

# Plot demographic object:
plot(dem)

</code></pre>

<hr>
<h2 id='plot.paramDemoLT'>
Functions to plot life tables and product limit estimators
</h2><span id='topic+plot.paramDemoLT'></span><span id='topic+plot.paramDemoPLE'></span>

<h3>Description</h3>

<p>Draw a plot of demographic rates from a life table produced with function <code>CalcLifeTable</code> or of product limit estimator produced with function <code>CalcProductLimitEst</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'paramDemoLT'
plot(x, demorate = "lx", inclCIs = FALSE, ...)

## S3 method for class 'paramDemoPLE'
plot(x, inclCIs = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.paramDemoLT_+3A_x">x</code></td>
<td>
<p>Object of class <code>paramDemoLT</code> or <code>paramDemoPLE</code> produced with functions <code>CalcLifeTable</code> or <code>CalcProductLimitEst</code></p>
</td></tr>
<tr><td><code id="plot.paramDemoLT_+3A_demorate">demorate</code></td>
<td>
<p>Demographic rate to be plotted, choices are &ldquo;<code>lx</code>&rdquo; for the survival, &ldquo;<code>px</code>&rdquo; for the age-specific survival probability, &ldquo;<code>qx</code>&rdquo; for the age-specific mortality probability, and &ldquo;<code>ex</code>&rdquo; for the remaining life expectancy</p>
</td></tr>
<tr><td><code id="plot.paramDemoLT_+3A_inclcis">inclCIs</code></td>
<td>
<p>Logical indicating whether confidence intervals should be ploted in case they were calculated with function <code>CalcLifeTable</code> or <code>CalcProductLimitEst</code></p>
</td></tr>
<tr><td><code id="plot.paramDemoLT_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to function <code>plot</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for plotting objects of class &ldquo;<code>paramDemoLT</code>&rdquo;</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcLifeTable">CalcLifeTable</a></code> to calculate life tables. <code><a href="#topic+CalcProductLimitEst">CalcProductLimitEst</a></code> to calculate product limit estimators.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate age at death data from Gompertz model:
ages &lt;- SampleRandAge(n = 100, theta = c(b0 = -5, b1 = 0.1))

# Calculate life table:
lt &lt;- CalcLifeTable(ageLast = ages, departType = rep("D", 100))

# Plot life table:
plot(lt)
</code></pre>

<hr>
<h2 id='plot.PDlifeHist'>
Summarizing and plotting life history variables from parametric demographic models.
</h2><span id='topic+plot.PDlifeHist'></span><span id='topic+summary.PDlifeHist'></span><span id='topic+print.PDlifeHist'></span>

<h3>Description</h3>

<p>These functions are all generic methods for class <code>PDlifeHist</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PDlifeHist'
plot(x, type = "rates", ...)

## S3 method for class 'PDlifeHist'
summary(object, ...)

## S3 method for class 'PDlifeHist'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.PDlifeHist_+3A_x">x</code></td>
<td>
<p>Object of class &ldquo;<code>PDlifeHist</code>&rdquo; obtained from function <code><a href="#topic+CalcLifeHist">CalcLifeHist</a></code></p>
</td></tr>
<tr><td><code id="plot.PDlifeHist_+3A_object">object</code></td>
<td>
<p>Object of class &ldquo;<code>PDlifeHist</code>&rdquo; obtained from function <code><a href="#topic+CalcLifeHist">CalcLifeHist</a></code></p>
</td></tr>
<tr><td><code id="plot.PDlifeHist_+3A_type">type</code></td>
<td>
<p>Character string specifying the type of plot to be drawn, options are &ldquo;<code>rates</code>&rdquo;, &ldquo;<code>sensitivities</code>&rdquo;, &ldquo;<code>all</code>&rdquo;</p>
</td></tr>
<tr><td><code id="plot.PDlifeHist_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to functions <code>plot</code>, <code>print</code>, and <code>summary</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For objects of class &ldquo;<code>PDlifeHist</code>&rdquo;, function <code>print</code> displays on the console the data frame of life history variables produced by function <code><a href="#topic+CalcLifeHist">CalcLifeHist</a></code>. 
</p>
<p>Function <code>summary</code> prints to the console, first the settings as specified by the user (i.e., <code>theta</code> and <code>beta</code> parameters, and the types of models used), and then, as function <code>print</code>, the table of life history variables. 
</p>
<p>Function <code>plot</code> with argument <code>type</code> = &ldquo;<code>rates</code>&rdquo; produces plots of the age-specific demographic rates (i.e., <code class="reqn">p_x</code> and <code class="reqn">m_x</code>) and the stable age structure and reproductive values (i.e., <code class="reqn">\omega_x</code> and <code class="reqn">\nu_x</code>). If argument <code>type</code> = &ldquo;<code>sensitivity</code>&rdquo;, then it produces plots of the sensitivities and elasticities of <code class="reqn">\lambda</code> to <code class="reqn">p_x</code> and <code class="reqn">m_x</code>. 
</p>


<h3>Value</h3>

<p>No return value, called for plotting objects of class &ldquo;<code>PDlifeHist</code>&rdquo;</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+CalcLifeHist">CalcLifeHist</a></code> to calculate life history variables from parametric demographic models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate life histories on the defalult models:
test &lt;- CalcLifeHist(theta = c(b0 = -3, b1 = 0.1), 
                     beta = c(b0 = 1, b1 = 0.01, b2 = 5),
                     ageMatur = 2)
                     
# Print results:
test

# Summary:
summary(test)

# Plot results:
plot(test, type = "all")

</code></pre>

<hr>
<h2 id='SampleRandAge'>
Sampling Ages at Death from a Parametric Mortality model
</h2><span id='topic+SampleRandAge'></span>

<h3>Description</h3>

<p><code>SampleRandAge</code> is used to randomly sample ages at death from a parametric mortality model 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SampleRandAge(n, theta, dx = 0.001, model = "GO", 
               shape = "simple",  minSx = 1e-04)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SampleRandAge_+3A_n">n</code></td>
<td>
<p>Number of individual ages at death to sample</p>
</td></tr>
<tr><td><code id="SampleRandAge_+3A_theta">theta</code></td>
<td>
<p>Numerical vector of age-specific mortality parameters (see details).</p>
</td></tr>
<tr><td><code id="SampleRandAge_+3A_dx">dx</code></td>
<td>
<p>Numeric value for the age increments (see details).</p>
</td></tr>
<tr><td><code id="SampleRandAge_+3A_model">model</code></td>
<td>
<p>The underlying mortality model to be used. <code>"EX"</code> = exponential,<code>"GO"</code> = Gompertz, <code>"WE"</code> = Weibull and <code>"LO"</code> = logistic (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="SampleRandAge_+3A_shape">shape</code></td>
<td>
<p>The overall shape of the model. Values are: <code>simple</code> = no extra parameters added; <code>Makeham</code> = a constant parameter is added to the mortality; and <code>bathtub</code> = a Gompertz declining mortality for early ages and a constant parameter are added to the mortality model (see <code>details</code>).</p>
</td></tr>
<tr><td><code id="SampleRandAge_+3A_minsx">minSx</code></td>
<td>
<p>Minimum value for the survival function to set the maximum age (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>SampleRandAge</code> arguments &ldquo;<code>model</code>&rdquo; and &ldquo;<code>shape</code>&rdquo;, to calculate the survival function, <code class="reqn">S(x)</code> for <code class="reqn">x \geq 0</code>, at discrete age intervals <code class="reqn">[x, x + \Delta x)</code> where <code class="reqn">\Delta x</code> is specfied with argument &ldquo;<code>dx</code>&rdquo;. It then calculates the CDF of ages at death, <code class="reqn">F(x)</code>, and uses inverse sampling to sample <code class="reqn">n</code> ages at death by random sampling from a uniform distribution bound as 
</p>
<p style="text-align: center;"><code class="reqn">
u_i \sim Unif[F(x_m), F(x_M)],
</code>
</p>

<p>where <code class="reqn">x_m = min(x)</code> and <code class="reqn">x_M = max(x)</code>. It then finds the corresponding ages at death as </p>
<p style="text-align: center;"><code class="reqn">
x_i = F^{-1}(u_i).
</code>
</p>

<p>In most cases, this is acheived numerically and thus the lower the value for argument &ldquo;<code>dx</code>&rdquo; the higher the precision.
</p>


<h3>Value</h3>

<p><code>SampleRandAge</code> returns a vector of class &ldquo;<code>numeric</code>&rdquo; with randmly generated ages at death.
</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate age at death data from Gompertz model:
ages &lt;- SampleRandAge(n = 100, theta = c(b0 = -5, b1 = 0.1))

# Simulate age at death data from Siler model:
ages &lt;- SampleRandAge(n = 100, theta = c(a0 = 0, a1 = 1, c = 0.001, 
                      b0 = -5, b1 = 0.1), model = "GO", 
                      shape = "bathtub")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
