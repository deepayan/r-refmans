<!DOCTYPE html><html><head><title>Help for package dilp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dilp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dilp-package'><p>dilp: Reconstruct Paleoclimate and Paleoecology with Leaf Physiognomy</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#calc_lma'><p>Generate leaf mass per area results</p></a></li>
<li><a href='#climate_calibration_data'><p>Climate Calibration Data</p></a></li>
<li><a href='#dilp'><p>Generate DiLP results</p></a></li>
<li><a href='#dilp_cca'><p>Test if site leaf physiognomy falls within the physiognomic space of the DiLP calibration dataset</p></a></li>
<li><a href='#dilp_errors'><p>Check for common errors in DiLP measurements</p></a></li>
<li><a href='#dilp_outliers'><p>Identify outlier specimens</p></a></li>
<li><a href='#dilp_processing'><p>Process raw leaf physiognomic data</p></a></li>
<li><a href='#lma'><p>Generate a suite of leaf mass per area results</p></a></li>
<li><a href='#McAbeeExample'><p>McAbee Example Data</p></a></li>
<li><a href='#physiognomy_calibration_data'><p>Physiognomy Calibration Data</p></a></li>
<li><a href='#precip_slr'><p>Estimate precipitation with simple linear regression</p></a></li>
<li><a href='#temp_slr'><p>Estimate temperature with simple linear regression</p></a></li>
<li><a href='#view_regressions'><p>View preloaded regressions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Reconstruct Paleoclimate and Paleoecology with Leaf Physiognomy</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Use leaf physiognomic methods to reconstruct mean annual
    temperature (MAT), mean annual precipitation (MAP), and leaf dry mass
    per area (Ma), along with other useful quantitative leaf traits. Methods
    in this package described in Lowe et al. (in review).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mjbutrim/dilp">https://github.com/mjbutrim/dilp</a>, <a href="https://mjbutrim.github.io/dilp/">https://mjbutrim.github.io/dilp/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mjbutrim/dilp/issues">https://github.com/mjbutrim/dilp/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, ggrepel, grDevices, magrittr, rlang, stats,
stringr, tidyr, utils, vegan</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-05 23:38:40 UTC; UW-User</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew J. Butrim [aut, cre, cph],
  Alexander J. Lowe [aut],
  Andrew G. Flynn [aut],
  Aly Baumgartner [aut],
  Daniel J. Peppe [aut],
  Dana L. Royer [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew J. Butrim &lt;mbutrim@uwyo.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-05 23:53:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='dilp-package'>dilp: Reconstruct Paleoclimate and Paleoecology with Leaf Physiognomy</h2><span id='topic+dilp-package'></span>

<h3>Description</h3>

<p>Use leaf physiognomic methods to reconstruct mean annual temperature (MAT), mean annual precipitation (MAP), and leaf dry mass per area (Ma), along with other useful quantitative leaf traits. Methods in this package described in Lowe et al. (in review).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Matthew J. Butrim <a href="mailto:mbutrim@uwyo.edu">mbutrim@uwyo.edu</a> [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Alexander J. Lowe
</p>
</li>
<li><p> Andrew G. Flynn
</p>
</li>
<li><p> Aly Baumgartner
</p>
</li>
<li><p> Daniel J. Peppe
</p>
</li>
<li><p> Dana L. Royer
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/mjbutrim/dilp">https://github.com/mjbutrim/dilp</a>
</p>
</li>
<li> <p><a href="https://mjbutrim.github.io/dilp/">https://mjbutrim.github.io/dilp/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/mjbutrim/dilp/issues">https://github.com/mjbutrim/dilp/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='calc_lma'>Generate leaf mass per area results</h2><span id='topic+calc_lma'></span>

<h3>Description</h3>

<p><code>calc_lma()</code> will typically only be called internally by <code><a href="#topic+lma">lma()</a></code>. It provides
the flexibility to use custom regression parameters to calculate leaf mass
per area (LMA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_lma(data, params, resolution = "species")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_lma_+3A_data">data</code></td>
<td>
<p>Must include &quot;petiole metric&quot; or some combination of columns to
calculate petiole metric such as &quot;Blade Area&quot;, &quot;Petiole Area&quot;, and &quot;Petiole Width&quot;,
or &quot;Leaf Area&quot; and &quot;Petiole Width&quot;.  If calculating morphospecies-mean LMA,
must include &quot;Site&quot; and &quot;Morphotype&quot; columns. If calculating species-mean LMA,
only needs to include a &quot;Site' column.</p>
</td></tr>
<tr><td><code id="calc_lma_+3A_params">params</code></td>
<td>
<p>A list of regression parameters. Must contain &quot;stat&quot; (= &quot;mean&quot; or = &quot;variance&quot;),
&quot;regression_slope&quot;, &quot;y_intercept&quot;, &quot;unexplained_mean_square&quot;, &quot;sample_size_calibration&quot;
&quot;mean_log_petiole_metric_calibration&quot;, &quot;sum_of_squares_calibration&quot;, and &quot;critical_value&quot;.
</p>
<p>Pre-loaded sets of parameters:
</p>

<dl>
<dt>&quot;royer_species_mean_ma&quot;:</dt><dd>

<ul>
<li><p> stat = &quot;mean&quot;,
</p>
</li>
<li><p> regression_slope = 0.382,
</p>
</li>
<li><p> y_intercept = 3.070,
</p>
</li>
<li><p> unexplained_mean_square = 0.032237,
</p>
</li>
<li><p> sample_size_calibration = 667,
</p>
</li>
<li><p> mean_log_petiole_metric_calibration = -3.011,
</p>
</li>
<li><p> sum_of_squares_calibration = 182.1,
</p>
</li>
<li><p> critical_value = 1.964</p>
</li></ul>

</dd>
<dt>&quot;royer_site_mean_ma&quot;:</dt><dd>

<ul>
<li><p> stat = &quot;mean&quot;,
</p>
</li>
<li><p> regression_slope = 0.429,
</p>
</li>
<li><p> y_intercept = 3.214,
</p>
</li>
<li><p> unexplained_mean_square = 0.005285,
</p>
</li>
<li><p> sample_size_calibration = 25,
</p>
</li>
<li><p> mean_log_petiole_metric_calibration = -2.857,
</p>
</li>
<li><p> sum_of_squares_calibration = 5.331,
</p>
</li>
<li><p> critical_value = 2.069</p>
</li></ul>

</dd>
<dt>&quot;lowe_site_mean_ma&quot;:</dt><dd>

<ul>
<li><p> stat = &quot;mean&quot;,
</p>
</li>
<li><p> regression_slope = 0.345,
</p>
</li>
<li><p> y_intercept = 2.954,
</p>
</li>
<li><p> unexplained_mean_square = 0.01212861,
</p>
</li>
<li><p> sample_size_calibration = 70,
</p>
</li>
<li><p> mean_log_petiole_metric_calibration = -2.902972,
</p>
</li>
<li><p> sum_of_squares_calibration = 1.154691,
</p>
</li>
<li><p> critical_value = 1.995469</p>
</li></ul>

</dd>
<dt>&quot;lowe_site_variance_ma&quot;:</dt><dd>

<ul>
<li><p> stat = &quot;variance&quot;,
</p>
</li>
<li><p> regression_slope = 0.302,
</p>
</li>
<li><p> y_intercept = 5.028,
</p>
</li>
<li><p> unexplained_mean_square = 0.1713672,
</p>
</li>
<li><p> sample_size_calibration = 70,
</p>
</li>
<li><p> mean_log_petiole_metric_calibration = -5.97104,
</p>
</li>
<li><p> sum_of_squares_calibration = 5.085184,
</p>
</li>
<li><p> critical_value = 1.995469</p>
</li></ul>

</dd>
</dl>
</td></tr>
<tr><td><code id="calc_lma_+3A_resolution">resolution</code></td>
<td>
<p>Either &quot;species&quot; or &quot;site&quot;.  Informs whether the function
should calculate morphospecies-mean LMA values (&quot;species&quot;) or site-mean/site-
variance LMA values (&quot;site&quot;).  If resolution = &quot;site&quot;, data must already be
in the form of species-mean LMA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with LMA results
</p>


<h3>References</h3>


<ul>
<li><p> Royer, D. L., L. Sack, P. Wilf, C. H. Lusk, G. J. Jordan, Ulo Niinemets, I. J. Wright, et al. 2007. Fossil Leaf Economics Quantified: Calibration, Eocene Case Study, and Implications. Paleobiology 33: 574–589
</p>
</li>
<li><p> Lowe, A. J., D. L. Royer, D. J. Wieczynski, M. J. Butrim, T. Reichgelt, L. Azevedo-Schmidt, D. J. Peppe, et al. 2024. Global patterns in community-scale leaf mass per area distributions of woody non-monocot angiosperms and their utility in the fossil record. In review.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Calculate morphospecies-mean LMA values with the parameters from Royer et al. (2007)
results &lt;- calc_lma(McAbeeExample,
  params = list(
    stat = "mean",
    regression_slope = 0.382,
    y_intercept = 3.070,
    unexplained_mean_square = 0.032237,
    sample_size_calibration = 667,
    mean_log_petiole_metric_calibration = -3.011,
    sum_of_squares_calibration = 182.1,
    critical_value = 1.964
  ),
  resolution = "species"
)
results

# Calculate site-mean LMA values with the parameters from Lowe et al. (2024) entered from scratch
site_results &lt;- calc_lma(results,
  params = list(
    stat = "mean",
    regression_slope = 0.345,
    y_intercept = 2.954,
    unexplained_mean_square = 0.01212861,
    sample_size_calibration = 70,
    mean_log_petiole_metric_calibration = -2.902972,
    sum_of_squares_calibration = 1.154691,
    critical_value = 1.995469
  ),
  resolution = "site"
)
site_results

</code></pre>

<hr>
<h2 id='climate_calibration_data'>Climate Calibration Data</h2><span id='topic+climate_calibration_data'></span>

<h3>Description</h3>

<p>Temperature and precipitation data associated with the modern localities used to calibrate the DiLP model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climate_calibration_data
</code></pre>


<h3>Format</h3>



<h4><code>climate_calibration_data</code></h4>

<p>A data frame with 92 rows and 3 columns:
</p>

<dl>
<dt>Site</dt><dd><p>Locality name</p>
</dd>
<dt>MAT</dt><dd><p>Mean Annual Temperature (celsius)</p>
</dd>
<dt>MAP</dt><dd><p>Mean Annual Precipitation (mm)</p>
</dd>
</dl>




<h3>Source</h3>

<p>Peppe et al. 2011
</p>


<h3>References</h3>


<ul>
<li><p> Peppe, D.J., Royer, D.L., Cariglino, B., Oliver, S.Y., Newman, S., Leight, E., Enikolopov, G., Fernandez-Burgos, M., Herrera, F., Adams, J.M., Correa, E., Currano, E.D., Erickson, J.M., Hinojosa, L.F., Hoganson, J.W., Iglesias, A., Jaramillo, C.A., Johnson, K.R., Jordan, G.J., Kraft, N.J.B., Lovelock, E.C., Lusk, C.H., Niinemets, Ü., Peñuelas, J., Rapson, G., Wing, S.L. and Wright, I.J. (2011), Sensitivity of leaf size and shape to climate: global patterns and paleoclimatic applications. New Phytologist, 190: 724-739. https://doi.org/10.1111/j.1469-8137.2010.03615.x
</p>
</li></ul>


<hr>
<h2 id='dilp'>Generate DiLP results</h2><span id='topic+dilp'></span>

<h3>Description</h3>

<p><code>dilp()</code> processes raw leaf physiognomic data, checks for common
errors/outliers, and returns the processed data, keys to finding potential
errors or outliers, and paleoclimate reconstructions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dilp(specimen_data, params = "PeppeGlobal", subsite_cols = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dilp_+3A_specimen_data">specimen_data</code></td>
<td>
<p>A data frame containing specimen level leaf physiognomic
data. See Lowe et al. 2024 for more information on how to collect this data.
A good reference for how to put together the data: <code><a href="#topic+McAbeeExample">McAbeeExample</a></code>
</p>
<p>Required columns:
</p>

<ul>
<li><p> site
</p>
</li>
<li><p> specimen_number
</p>
</li>
<li><p> morphotype
</p>
</li>
<li><p> margin
</p>
</li>
<li><p> feret
</p>
</li>
<li><p> blade_area
</p>
</li>
<li><p> raw_blade_perimeter
</p>
</li>
<li><p> internal_raw_blade_perimeter
</p>
</li>
<li><p> length_of_cut_perimeter
</p>
</li>
<li><p> no_of_primary_teeth
</p>
</li>
<li><p> no_of_subsidiary_teeth
</p>
</li></ul>

<p>Recommended columns:
</p>

<ul>
<li><p> petiole_width
</p>
</li>
<li><p> petiole_area
</p>
</li>
<li><p> blade_perimeter
</p>
</li>
<li><p> minimum_feret
</p>
</li>
<li><p> raw_blade_area
</p>
</li>
<li><p> internal_raw_blade_area
</p>
</li></ul>
</td></tr>
<tr><td><code id="dilp_+3A_params">params</code></td>
<td>
<p>Either a string referring to one of two preloaded parameter sets
of a list of custom parameters (same format as the list below).
</p>
<p>Preloaded parameter sets are &quot;PeppeGlobal&quot; and &quot;PeppeNH&quot; which are calibrated based on
global and northern hemisphere data respectively. Allen et al. (2020) illustrates a situation
in which the northern hemisphere parameters may be preferable.  The &quot;PeppeNH&quot; parameters
only estimate MAT.  Use &quot;PeppeGlobal&quot; for all MAP estimates. Defaults to &quot;PeppeGlobal&quot; as follows (Peppe et al. 2011):
</p>

<ul>
<li><p> MAT.MLR.M = 0.21,
</p>
</li>
<li><p> MAT.MLR.FDR = 42.296,
</p>
</li>
<li><p> MAT.MLR.TC.IP = -2.609,
</p>
</li>
<li><p> MAT.MLR.constant = -16.004,
</p>
</li>
<li><p> MAT.MLR.error = 4,
</p>
</li>
<li><p> MAT.SLR.M = 0.204,
</p>
</li>
<li><p> MAT.SLR.constant = 4.6,
</p>
</li>
<li><p> MAT.SLR.error = 4.9,
</p>
</li>
<li><p> MAP.MLR.LA = 0.298,
</p>
</li>
<li><p> MAP.MLR.TC.IP = 0.279,
</p>
</li>
<li><p> MAP.MLR.PR = -2.717,
</p>
</li>
<li><p> MAP.MLR.constant = 3.033,
</p>
</li>
<li><p> MAP.MLR.SE = 0.6,
</p>
</li>
<li><p> MAP.SLR.LA = 0.283,
</p>
</li>
<li><p> MAP.SLR.constant = 2.92,
</p>
</li>
<li><p> MAP.SLR.SE = 0.61
</p>
</li></ul>
</td></tr>
<tr><td><code id="dilp_+3A_subsite_cols">subsite_cols</code></td>
<td>
<p>A vector or list of columns present in <code>specimen_data</code> to calculate
paleoclimate estimates for.  A completely optional parameter - allows different groupings of
specimens to be tested, or comparisons of paleoclimate estimates at different levels of grouping.
Adds additional estimates to $results.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of tables that includes all pertinent DiLP
information:
</p>

<ul>
<li><p> processed_leaf_data: the full set of cleaned and newly calculated leaf
physiognomic data that is necessary for DiLP analysis. See <code><a href="#topic+dilp_processing">dilp_processing()</a></code>
for more information.
</p>
</li>
<li><p> processed_morphotype_data: morphospecies-site pair means for all leaf
physiognomic data.
</p>
</li>
<li><p> processed_site_data: site means for all leaf physiognomic data.
</p>
</li>
<li><p> errors: lists any specimens that may be causing common errors in DiLP
calculations. See <code><a href="#topic+dilp_errors">dilp_errors()</a></code> for more information.
</p>
</li>
<li><p> outliers: flags outliers in variables used for DiLP analysis that may
represent incorrect data.  See <code><a href="#topic+dilp_outliers">dilp_outliers()</a></code> for more information.
</p>
</li>
<li><p> results: climate reconstructions of MAT and MAP using single and multi-linear
regressions.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Allen, S. E., Lowe, A. J., Peppe, D. J., &amp; Meyer, H. W. (2020). Paleoclimate and paleoecology of the latest Eocene Florissant flora of central Colorado, USA. Palaeogeography, Palaeoclimatology, Palaeoecology, 551, 109678.
</p>
</li>
<li><p> Peppe, D.J., Royer, D.L., Cariglino, B., Oliver, S.Y., Newman, S., Leight, E., Enikolopov, G., Fernandez-Burgos, M., Herrera, F., Adams, J.M., Correa, E., Currano, E.D., Erickson, J.M., Hinojosa, L.F., Hoganson, J.W., Iglesias, A., Jaramillo, C.A., Johnson, K.R., Jordan, G.J., Kraft, N.J.B., Lovelock, E.C., Lusk, C.H., Niinemets, Ü., Peñuelas, J., Rapson, G., Wing, S.L. and Wright, I.J. (2011), Sensitivity of leaf size and shape to climate: global patterns and paleoclimatic applications. New Phytologist, 190: 724-739. https://doi.org/10.1111/j.1469-8137.2010.03615.x
</p>
</li>
<li><p> Lowe. A.J., Flynn, A.G., Butrim, M.J., Baumgartner, A., Peppe, D.J., and Royer, D.L. (2024), Reconstructing terrestrial paleoclimate and paleoecology with fossil leaves using Digital Leaf Physiognomy and leaf mass per area.  JoVE.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>dilp_results &lt;- dilp(McAbeeExample)
dilp_results$processed_leaf_data
dilp_results$processed_morphotype_data
dilp_results$processed_site_data
dilp_results$errors
dilp_results$outliers
dilp_results$results
</code></pre>

<hr>
<h2 id='dilp_cca'>Test if site leaf physiognomy falls within the physiognomic space of the DiLP calibration dataset</h2><span id='topic+dilp_cca'></span>

<h3>Description</h3>

<p><code>dilp_cca</code> plots a canonical correspondence analysis (CCA) ordination of the leaf
physiognomic space represented in the calibration dataset of Peppe et al. (2011).
The fossil sites being tested are placed along the CCA axes.  If a fossil site
falls outside of the plotted calibration space, paleoclimate reconstructions
for that fossil site should be treated with caution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dilp_cca(
  dilp_table,
  physiognomy_calibration = physiognomyCalibration,
  climate_calibration = climateCalibration
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dilp_cca_+3A_dilp_table">dilp_table</code></td>
<td>
<p>The results of a call to <code><a href="#topic+dilp">dilp()</a></code></p>
</td></tr>
<tr><td><code id="dilp_cca_+3A_physiognomy_calibration">physiognomy_calibration</code></td>
<td>
<p>A physiognomic calibration dataset. Defaults to an internal version of
<code><a href="#topic+physiognomy_calibration_data">physiognomy_calibration_data</a></code>.</p>
</td></tr>
<tr><td><code id="dilp_cca_+3A_climate_calibration">climate_calibration</code></td>
<td>
<p>A climate calibration dataset. Defaults to an internal version of
<code><a href="#topic+climate_calibration_data">climate_calibration_data</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 plot
</p>


<h3>References</h3>


<ul>
<li><p> Peppe, D.J., Royer, D.L., Cariglino, B., Oliver, S.Y., Newman, S., Leight, E., Enikolopov, G., Fernandez-Burgos, M., Herrera, F., Adams, J.M., Correa, E., Currano, E.D., Erickson, J.M., Hinojosa, L.F., Hoganson, J.W., Iglesias, A., Jaramillo, C.A., Johnson, K.R., Jordan, G.J., Kraft, N.J.B., Lovelock, E.C., Lusk, C.H., Niinemets, Ü., Peñuelas, J., Rapson, G., Wing, S.L. and Wright, I.J. (2011), Sensitivity of leaf size and shape to climate: global patterns and paleoclimatic applications. New Phytologist, 190: 724-739. https://doi.org/10.1111/j.1469-8137.2010.03615.x
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- dilp(McAbeeExample)
dilp_cca(results)

</code></pre>

<hr>
<h2 id='dilp_errors'>Check for common errors in DiLP measurements</h2><span id='topic+dilp_errors'></span>

<h3>Description</h3>

<p><code>dilp_errors()</code> will typically only be called internally by <code><a href="#topic+dilp">dilp()</a></code>.
However, it can be used on its own to evaluate errors that commonly occur
during the data collection and processing steps.  A <code>dilp_errors()</code> call
will nearly always follow a <code><a href="#topic+dilp_processing">dilp_processing()</a></code> call.  Returns a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dilp_errors(specimen_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dilp_errors_+3A_specimen_data">specimen_data</code></td>
<td>
<p>Processed specimen level leaf physiognomic data.  The
structure should match the structure of the output from <code><a href="#topic+dilp_processing">dilp_processing()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 7 by X data frame.  Each row shows a common error, and which specimens
from the input dataset are tripping it.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Check for errors in the provided McAbeeExample dataset.
dilp_dataset &lt;- dilp_processing(McAbeeExample)
dilp_errors &lt;- dilp_errors(dilp_dataset)
dilp_errors
</code></pre>

<hr>
<h2 id='dilp_outliers'>Identify outlier specimens</h2><span id='topic+dilp_outliers'></span>

<h3>Description</h3>

<p><code>dilp_outliers()</code> will typically only be called internally by <code><a href="#topic+dilp">dilp()</a></code>.
However, it can be used on its own to locate specimens that may have been
misreported or measured incorrectly.  <code>dilp_outliers()</code> returns a data frame
listing specimens that have unusually high or low values for the four key
parameters used in DiLP analyses.  If flagged, it may be worth taking a look at the
raw measurements and evaluating if the specimen should be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dilp_outliers(specimen_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dilp_outliers_+3A_specimen_data">specimen_data</code></td>
<td>
<p>Processed specimen level leaf physiognomic data.  The
structure should match the structure of the output from <code><a href="#topic+dilp_processing">dilp_processing()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 4 by X data frame. Each row represents one of the DiLP parameters,
and the specimens that are outliers for that parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Check for outliers in the provided McAbeeExample dataset. Each
# of these outliers has been manually re-examined and was found acceptable.
dilp_dataset &lt;- dilp_processing(McAbeeExample)
dilp_outliers &lt;- dilp_outliers(dilp_dataset)
dilp_outliers
</code></pre>

<hr>
<h2 id='dilp_processing'>Process raw leaf physiognomic data</h2><span id='topic+dilp_processing'></span>

<h3>Description</h3>

<p><code>dilp_processing()</code> will typically only be called internally by <code>dilp()</code>.
However, it can be used on its own to generate and view a processed DiLP
dataset that includes raw and derived physiognomic values useful for DiLP and
other physiognomic analyses.  Returns a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dilp_processing(specimen_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dilp_processing_+3A_specimen_data">specimen_data</code></td>
<td>
<p>A data frame containing specimen level leaf physiognomic
data. A good reference for how to put together the data: <code><a href="#topic+McAbeeExample">McAbeeExample</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing cleaned and processed specimen level leaf
physiognomic data.  New variables calculated are:
</p>

<ul>
<li><p> Leaf area
</p>
</li>
<li><p> Feret diameter
</p>
</li>
<li><p> Feret diameter ratio (FDR)
</p>
</li>
<li><p> Raw blade perimeter corrected (Raw blade perimeter - length of cut perimeter)
</p>
</li>
<li><p> Internal raw blade perimeter corrected (Internal raw blade perimeter - length of cut perimeter)
</p>
</li>
<li><p> Total tooth count
</p>
</li>
<li><p> Total tooth count : internal perimeter (TC:IP)
</p>
</li>
<li><p> Perimeter ratio
</p>
</li>
<li><p> Petiole metric
</p>
</li>
<li><p> Aspect ratio
</p>
</li>
<li><p> Shape factor
</p>
</li>
<li><p> Compactness
</p>
</li>
<li><p> Tooth area
</p>
</li>
<li><p> Tooth area : perimeter (TA:P)
</p>
</li>
<li><p> Tooth area: internal perimeter (TA:IP)
</p>
</li>
<li><p> Tooth area : blade area (TA:BA)
</p>
</li>
<li><p> Average primary tooth area (Avg TA)
</p>
</li>
<li><p> Tooth count : blade area (TC:BA)
</p>
</li>
<li><p> Tooth count : perimeter (TC:P)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>dilp_dataset &lt;- dilp_processing(McAbeeExample)
dilp_dataset
</code></pre>

<hr>
<h2 id='lma'>Generate a suite of leaf mass per area results</h2><span id='topic+lma'></span>

<h3>Description</h3>

<p><code>lma()</code> takes either raw or processed leaf physiognomic data and returns
leaf mass per area (LMA) reconstructions of species-mean, site-mean, and site-
variance.
</p>
<p><code>lma()</code> calls <code><a href="#topic+calc_lma">calc_lma()</a></code> multiple times with different sets of
parameters.  See <code><a href="#topic+calc_lma">calc_lma()</a></code> for more control over LMA reconstructions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lma(specimen_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lma_+3A_specimen_data">specimen_data</code></td>
<td>
<p>A table that must include &quot;Site&quot;, &quot;Morphotype&quot;, and
either &quot;Petiole Metric&quot;, or &quot;Blade Area&quot;, &quot;Petiole Area&quot;, and &quot;Petiole Width&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of tables containing leaf mass per area reconstructions.
</p>

<ul>
<li><p> species_mean_lma contains the average LMA for each morphospecies-site pair.
Values calculated using the regression from Royer et al. (2007).
</p>
</li>
<li><p> royer_site_mean_lma contains the average LMA for each site. Values calculated
using the regression from Royer et al. (2007)
</p>
</li>
<li><p> lowe_site_lma contains the average LMA for each site. Values calculated using
the regression from Lowe et al. (2024)
</p>
</li>
<li><p> lowe_variance contains the variance in LMA for each site. Values calculated
using the regression from Lowe et al. (2024)
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Royer, D. L., L. Sack, P. Wilf, C. H. Lusk, G. J. Jordan, Ulo Niinemets, I. J. Wright, et al. 2007. Fossil Leaf Economics Quantified: Calibration, Eocene Case Study, and Implications. Paleobiology 33: 574–589
</p>
</li>
<li><p> Lowe, A. J., D. L. Royer, D. J. Wieczynski, M. J. Butrim, T. Reichgelt, L. Azevedo-Schmidt, D. J. Peppe, et al. 2024. Global patterns in community-scale leaf mass per area distributions of woody non-monocot angiosperms and their utility in the fossil record. In review.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- lma(McAbeeExample)
results
</code></pre>

<hr>
<h2 id='McAbeeExample'>McAbee Example Data</h2><span id='topic+McAbeeExample'></span>

<h3>Description</h3>

<p>Leaf physiognomic data of specimens collected from the McAbee Fossil Beds
in British Columbia, Canada (Lowe et al. 2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>McAbeeExample
</code></pre>


<h3>Format</h3>



<h4><code>McAbeeExample</code></h4>

<p>A data frame with 192 rows and 18 columns:
</p>

<dl>
<dt>Site</dt><dd><p>Stratigraphic layer or locality</p>
</dd>
<dt>Specimen Number</dt><dd><p>Repository number for individual specimen</p>
</dd>
<dt>Morphotype</dt><dd><p>Morphotype the specimen belongs to</p>
</dd>
<dt>Measurer comments</dt><dd><p>Additional notes about the specimen or its measurements</p>
</dd>
<dt>Margin</dt><dd><p>Whether the margin is toothed (0) or entire (1)</p>
</dd>
<dt>Petiole Width</dt><dd><p>The width of the petiole at the basalmost point of insertion into the leaf lamina</p>
</dd>
<dt>Blade area</dt><dd><p>The reconstructed area of the leaf lamina, not including the petiole</p>
</dd>
<dt>Blade perimeter</dt><dd><p>The length of the perimeter of the leaf lamina, not including the petiole</p>
</dd>
<dt>Feret</dt><dd><p>The diameter of a circle with the same area as the leaf lamina, not including the petiole</p>
</dd>
<dt>Minimum Feret</dt><dd><p>The longest line that can be drawn between two points on the perimeter of a selection that is perpendicular to Feret length.  Approximates blade width.</p>
</dd>
<dt>Raw blade area</dt><dd><p>The area of a leaf prepared for tooth measurements that still has its teeth.</p>
</dd>
<dt>Raw blade perimeter</dt><dd><p>The perimeter of a leaf prepared for tooth measurements that still has its teeth.</p>
</dd>
<dt>Internal raw blade area</dt><dd><p>The area of a leaf prepared for tooth measurements with teeth digitally removed.</p>
</dd>
<dt>Internal raw blade perimeter</dt><dd><p>The perimeter of a leaf prepared for tooth measurements with teeth digitally removed.</p>
</dd>
<dt>Length of cut perimeter</dt><dd><p>The total length of all segments of leaf removed from the leaf blade while removing damage during preparation of the leaf.</p>
</dd>
<dt>no. of primary teeth</dt><dd><p>The number of primary teeth along the undamaged perimeter</p>
</dd>
<dt>no. of secondary teeth</dt><dd><p>The number of secondary teeth along the undamaged perimeter</p>
</dd>
</dl>




<h3>Source</h3>

<p>Lowe et al. 2018
</p>


<h3>References</h3>


<ul>
<li><p> Lowe, A. J., D. R. Greenwood, C. K. West, J. M. Galloway, M. Sudermann, and T. Reichgelt. 2018. Plant community ecology and climate on an upland volcanic landscape during the Early Eocene Climatic Optimum: McAbee Fossil Beds, British Columbia, Canada. Palaeogeography, Palaeoclimatology, Palaeoecology 511: 433–448.
</p>
</li></ul>


<hr>
<h2 id='physiognomy_calibration_data'>Physiognomy Calibration Data</h2><span id='topic+physiognomy_calibration_data'></span>

<h3>Description</h3>

<p>Leaf physiognomic data taken from the modern localities used to calibrate the DiLP model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>physiognomy_calibration_data
</code></pre>


<h3>Format</h3>



<h4><code>physiognomy_calibration_data</code></h4>

<p>A data frame with 92 rows and 12 columns:
</p>

<dl>
<dt>Site</dt><dd><p>Locality name</p>
</dd>
<dt>Leaf.area</dt><dd><p>Average leaf area at site</p>
</dd>
<dt>FDR</dt><dd><p>Feret diameter:Feret length. Describes leaf linearity compared to a circle</p>
</dd>
<dt>Perimeter.ratio</dt><dd><p>Ratio - Raw blade perimeter:Internal raw blade perimeter</p>
</dd>
<dt>TC.P</dt><dd><p>Ratio - Tooth count:Perimeter</p>
</dd>
<dt>TC.IP</dt><dd><p>Ratio - Tooth count:Internal perimeter</p>
</dd>
<dt>Avg.TA</dt><dd><p>Average area of a primary tooth</p>
</dd>
<dt>TA.BA</dt><dd><p>Ratio - Tooth area:Blade area</p>
</dd>
<dt>TA.P</dt><dd><p>Ratio - Tooth area:Perimeter</p>
</dd>
<dt>TA.IP</dt><dd><p>Ratio - Tooth area:Internal perimeter</p>
</dd>
<dt>TC.BA</dt><dd><p>Ratio - Tooth count:Blade area</p>
</dd>
<dt>Margin</dt><dd><p>Percentage of untoothed species at the site</p>
</dd>
</dl>




<h3>Source</h3>

<p>Peppe et al. 2011
</p>


<h3>References</h3>


<ul>
<li><p> Peppe, D.J., Royer, D.L., Cariglino, B., Oliver, S.Y., Newman, S., Leight, E., Enikolopov, G., Fernandez-Burgos, M., Herrera, F., Adams, J.M., Correa, E., Currano, E.D., Erickson, J.M., Hinojosa, L.F., Hoganson, J.W., Iglesias, A., Jaramillo, C.A., Johnson, K.R., Jordan, G.J., Kraft, N.J.B., Lovelock, E.C., Lusk, C.H., Niinemets, Ü., Peñuelas, J., Rapson, G., Wing, S.L. and Wright, I.J. (2011), Sensitivity of leaf size and shape to climate: global patterns and paleoclimatic applications. New Phytologist, 190: 724-739. https://doi.org/10.1111/j.1469-8137.2010.03615.x
</p>
</li></ul>


<hr>
<h2 id='precip_slr'>Estimate precipitation with simple linear regression</h2><span id='topic+precip_slr'></span>

<h3>Description</h3>

<p><code>precip_slr()</code> will produce estimates of mean annual precipitation and standard error
using leaf area analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>precip_slr(
  data,
  regression = "Peppe2018",
  slope = NULL,
  constant = NULL,
  error = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="precip_slr_+3A_data">data</code></td>
<td>
<p>A data frame that must include the columns &quot;morphotype&quot;, &quot;leaf_area&quot;, and &quot;specimen_number&quot;.
Must be species level data.</p>
</td></tr>
<tr><td><code id="precip_slr_+3A_regression">regression</code></td>
<td>
<p>A string representing one of the following pre-loaded regressions:
</p>

<ul>
<li><p> &quot;Peppe2018&quot; - for global precipitation estimates
</p>
</li>
<li><p> &quot;Peppe2011&quot; - The Americas, Japan, and Oceania
</p>
</li>
<li><p> &quot;Jacobs2002&quot; - Africa
</p>
</li>
<li><p> &quot;Wilf1998&quot; - The Americas and Africa
</p>
</li></ul>
</td></tr>
<tr><td><code id="precip_slr_+3A_slope">slope</code></td>
<td>
<p>Slope, if using a custom regression</p>
</td></tr>
<tr><td><code id="precip_slr_+3A_constant">constant</code></td>
<td>
<p>Constant, if using a custom regression</p>
</td></tr>
<tr><td><code id="precip_slr_+3A_error">error</code></td>
<td>
<p>Standard error, if using a custom regression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with MAP estimates for each site
</p>


<h3>References</h3>


<ul>
<li><p> Peppe, D. J., Baumgartner, A., Flynn, A., &amp; Blonder, B. (2018). Reconstructing paleoclimate and paleoecology using fossil leaves. Methods in paleoecology: Reconstructing Cenozoic terrestrial environments and ecological communities, 289-317.
</p>
</li>
<li><p> Peppe, D.J., Royer, D.L., Cariglino, B., Oliver, S.Y., Newman, S., Leight, E., Enikolopov, G., Fernandez-Burgos, M., Herrera, F., Adams, J.M., Correa, E., Currano, E.D., Erickson, J.M., Hinojosa, L.F., Hoganson, J.W., Iglesias, A., Jaramillo, C.A., Johnson, K.R., Jordan, G.J., Kraft, N.J.B., Lovelock, E.C., Lusk, C.H., Niinemets, Ü., Peñuelas, J., Rapson, G., Wing, S.L. and Wright, I.J. (2011), Sensitivity of leaf size and shape to climate: global patterns and paleoclimatic applications. New Phytologist, 190: 724-739. https://doi.org/10.1111/j.1469-8137.2010.03615.x
</p>
</li>
<li><p> Jacobs, B. F. (2002). Estimation of low-latitude paleoclimates using fossil angiosperm leaves: examples from the Miocene Tugen Hills, Kenya. Paleobiology, 28, 399–421.
</p>
</li>
<li><p> Wilf, P. (2008). Fossil angiosperm leaves: paleobotany’s difficult children prove themselves. Paleontological Society Papers, 14, 319–333.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>precip_slr(McAbeeExample, regression = "Peppe2011")
</code></pre>

<hr>
<h2 id='temp_slr'>Estimate temperature with simple linear regression</h2><span id='topic+temp_slr'></span>

<h3>Description</h3>

<p><code>temp_slr()</code> will produce estimates of mean annual temperature and standard error
using leaf margin analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temp_slr(
  data,
  regression = "Peppe2018",
  slope = NULL,
  constant = NULL,
  error = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temp_slr_+3A_data">data</code></td>
<td>
<p>A data frame that must include the columns &quot;morphotype&quot; and &quot;margin&quot;.
Can be species or site level data.</p>
</td></tr>
<tr><td><code id="temp_slr_+3A_regression">regression</code></td>
<td>
<p>A string representing one of the following pre-loaded regressions:
</p>

<ul>
<li><p> &quot;Peppe2018&quot; - for global temperature estimates
</p>
</li>
<li><p> &quot;Peppe2011&quot; - The Americas, Japan, and Oceania
</p>
</li>
<li><p> &quot;Peppe2011NH&quot; - Peppe 2011 (Northern Hemisphere only)
</p>
</li>
<li><p> &quot;Miller2006&quot; - North and Central America
</p>
</li>
<li><p> &quot;WingGreenwood&quot; - East Asia - original leaf margin analysis regression
</p>
</li>
<li><p> &quot;Wilf1997&quot; - The Americas
</p>
</li></ul>
</td></tr>
<tr><td><code id="temp_slr_+3A_slope">slope</code></td>
<td>
<p>Slope, if using a custom regression</p>
</td></tr>
<tr><td><code id="temp_slr_+3A_constant">constant</code></td>
<td>
<p>Constant, if using a custom regression</p>
</td></tr>
<tr><td><code id="temp_slr_+3A_error">error</code></td>
<td>
<p>Standard error, if using a custom regression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with MAT estimates for each site
</p>


<h3>References</h3>


<ul>
<li><p> Miller, I. M., Brandon, M. T., &amp; Hickey, L. J. (2006). Using leaf margin analysis to estimate mid-Cretaceous (Albian) paleolatitude of the Baja BC block. Earth and Planetary Science Letters, 245, 95–114.
</p>
</li>
<li><p> Peppe, D. J., Baumgartner, A., Flynn, A., &amp; Blonder, B. (2018). Reconstructing paleoclimate and paleoecology using fossil leaves. Methods in paleoecology: Reconstructing Cenozoic terrestrial environments and ecological communities, 289-317.
</p>
</li>
<li><p> Peppe, D.J., Royer, D.L., Cariglino, B., Oliver, S.Y., Newman, S., Leight, E., Enikolopov, G., Fernandez-Burgos, M., Herrera, F., Adams, J.M., Correa, E., Currano, E.D., Erickson, J.M., Hinojosa, L.F., Hoganson, J.W., Iglesias, A., Jaramillo, C.A., Johnson, K.R., Jordan, G.J., Kraft, N.J.B., Lovelock, E.C., Lusk, C.H., Niinemets, Ü., Peñuelas, J., Rapson, G., Wing, S.L. and Wright, I.J. (2011), Sensitivity of leaf size and shape to climate: global patterns and paleoclimatic applications. New Phytologist, 190: 724-739. https://doi.org/10.1111/j.1469-8137.2010.03615.x
</p>
</li>
<li><p> Wing, S., &amp; Greenwood, D. R. (1993). Fossils and fossil climate: the case for equable continental interiors in the Eocene. Philosophical Transactions of the Royal Society of London Series B, 341, 243–252.
</p>
</li>
<li><p> Wilf, P. (1997). When are leaves good thermometers? A new case for leaf margin analysis. Paleobiology, 23, 373–390.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>temp_slr(McAbeeExample, regression = "Peppe2011")
</code></pre>

<hr>
<h2 id='view_regressions'>View preloaded regressions</h2><span id='topic+view_regressions'></span>

<h3>Description</h3>

<p>View preloaded regressions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_regressions(type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_regressions_+3A_type">type</code></td>
<td>
<p>Must be either &quot;dilp&quot;, &quot;lma&quot;, temp&quot;, or &quot;precip&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the parameters for each available regression of the selected type.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>view_regressions("dilp")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
