<!DOCTYPE html><html><head><title>Help for package lmDiallel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmDiallel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#blockMatrixDiagonal'>
<p>Creates block diagonal matrix. It is used internally.</p></a></li>
<li><a href='#DD'>
<p>Dominant Deviation effect</p></a></li>
<li><a href='#diallelMET'>
<p>Factitious dataset for Diallel analysis</p></a></li>
<li><a href='#diallelMod-methods'><p>Functions to retreive full list of genetical effects</p></a></li>
<li><a href='#expand.diallel'>
<p>Create a Data Frame from All Combinations of Parentals</p></a></li>
<li><a href='#GCA'>
<p>General Combining Ability effect</p></a></li>
<li><a href='#GCAC'>
<p>General Combining Ability without considering the selfed parents</p></a></li>
<li><a href='#griffing56'>
<p>Griffing's dataset for diallel analysis</p></a></li>
<li><a href='#H.BAR'>
<p>Average heterosis effect</p></a></li>
<li><a href='#hayman54'>
<p>Hayman dataset for diallel analysis</p></a></li>
<li><a href='#Hi'>
<p>Average heterosis effect</p></a></li>
<li><a href='#int.matrix'>
<p>Utilities for fitting diallel models.</p></a></li>
<li><a href='#lm.diallel'>
<p>Fitting diallel linear models</p></a></li>
<li><a href='#lmDiallel-methods'><p> Methods for diallel model fitting</p></a></li>
<li><a href='#lonnquist61'>
<p>Half diallel of maize dataset</p></a></li>
<li><a href='#matBlock'>
<p>Design matrix for blocks</p></a></li>
<li><a href='#MDD'>
<p>Mean Dominance Deviation effect</p></a></li>
<li><a href='#mmer.diallel'>
<p>Fitting random diallel linear models</p></a></li>
<li><a href='#model.matrixDiallel'>
<p>Incidence matrices for Diallel model parametrisation</p></a></li>
<li><a href='#REC'>
<p>Reciprocal Effect not parted into RGCA and RSCA</p></a></li>
<li><a href='#RGCA'>
<p>Reciprocal General Combining Ability</p></a></li>
<li><a href='#RSCA'>
<p>Reciprocal Specific Combining Ability</p></a></li>
<li><a href='#SCA'>
<p>Specific Combining Ability</p></a></li>
<li><a href='#SP'>
<p>Selfed Parents effect</p></a></li>
<li><a href='#tSCA'>
<p>Total Specific Combining Ability</p></a></li>
<li><a href='#VEi'>
<p>Variety Effect</p></a></li>
<li><a href='#zhang05'>
<p>Data for diallel analysis from Zhang (2005)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-14</td>
</tr>
<tr>
<td>Title:</td>
<td>Linear Fixed/Mixed Effects Models for Diallel Crosses</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrea Onofri &lt;andrea.onofri@unipg.it&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>multcomp, plyr, sommer, tidyr</td>
</tr>
<tr>
<td>Description:</td>
<td>Several service functions to be used to analyse datasets obtained from diallel experiments within the frame of linear models in R, as described in  Onofri et al (2020) &lt;<a href="https://doi.org/10.1007%2Fs00122-020-03716-8">doi:10.1007/s00122-020-03716-8</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.statforbiology.com/lmDiallel/">https://www.statforbiology.com/lmDiallel/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-19 15:46:45 UTC; andrea</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrea Onofri [aut, cre],
  Niccolo Terzaroli [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-19 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='blockMatrixDiagonal'>
Creates block diagonal matrix. It is used internally.
</h2><span id='topic+blockMatrixDiagonal'></span>

<h3>Description</h3>

<p>This function takes a list of matrices and creates a block diagonal matrix. It is used to fit multi-environment diallel models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blockMatrixDiagonal(matList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blockMatrixDiagonal_+3A_matlist">matList</code></td>
<td>

<p>It is a list of matrices to be combined
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix object
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theoretical Applied Genetics (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- matrix(1:16, 8, 2)
b &lt;- matrix(1:9, 3, 3)
c &lt;- list(a, b)
blockMatrixDiagonal(c)
</code></pre>

<hr>
<h2 id='DD'>
Dominant Deviation effect
</h2><span id='topic+DD'></span>

<h3>Description</h3>

<p>DD effect to fit Hayman2 model with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DD(P1, P2, type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DD_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="DD_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="DD_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="DD_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of n-1 parentals
</p>


<h3>Value</h3>

<p>A design matrix for the DD effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli , Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
contrasts(hayman54$Block) &lt;- "contr.sum"
dMod &lt;- lm(Ftime ~ Block + GCA(Par1, Par2) + MDD(Par1, Par2) +
             DD(Par1, Par2) + SCA(Par1, Par2) +
             RGCA(Par1, Par2) + RSCA(Par1, Par2), data = hayman54)
summary(dMod)
</code></pre>

<hr>
<h2 id='diallelMET'>
Factitious dataset for Diallel analysis
</h2><span id='topic+diallelMET'></span>

<h3>Description</h3>

<p>Multi-environment half-diallel dataset with six parentals, in five blocks and ten environments; the dataset is factitious and was obtained by Monte Carlo simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("diallelMET")</code></pre>


<h3>Format</h3>

<p>A data.frame with 1050 observations on the following 5 variables.
</p>

<dl>
<dt><code>Env</code></dt><dd><p>environment, a factor with 10 levels</p>
</dd>
<dt><code>Block</code></dt><dd><p>block, a factor with 5 levels</p>
</dd>
<dt><code>Par1</code></dt><dd><p>male parent, a factor with 6 levels</p>
</dd>
<dt><code>Par2</code></dt><dd><p>female parent, a factor with 6 levels</p>
</dd>
<dt><code>Yield</code></dt><dd><p>yield, a numeric vector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>Source</h3>

<p>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8
</p>


<h3>References</h3>

<p>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("diallelMET")
</code></pre>

<hr>
<h2 id='diallelMod-methods'>Functions to retreive full list of genetical effects</h2><span id='topic+glht.diallelMod'></span><span id='topic+diallel.eff'></span><span id='topic+G1.eff'></span><span id='topic+G2.eff'></span><span id='topic+G3.eff'></span><span id='topic+G4.eff'></span><span id='topic+GE2.eff'></span><span id='topic+GE3.eff'></span><span id='topic+GE2r.eff'></span><span id='topic+GE3r.eff'></span><span id='topic+hayman1.eff'></span><span id='topic+hayman2.eff'></span><span id='topic+MET1.eff'></span><span id='topic+MET2.eff'></span><span id='topic+MET3.eff'></span>

<h3>Description</h3>

<p>Diallel model parameters are estimated under a set of restrictions and, therefore, the methods 'coef' and 'summary' do not return the full list of genetical parameters. Therefore, the 'glht.diallelMod' method can be used, which works by way of a series of helper functions, providing the necessary contrast matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'diallelMod'
glht(model, linfct, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diallelMod-methods_+3A_model">model</code></td>
<td>
<p>a model object (OPTIONAL)</p>
</td></tr>
<tr><td><code id="diallelMod-methods_+3A_linfct">linfct</code></td>
<td>
<p> a diellel.eff() function</p>
</td></tr>
<tr><td><code id="diallelMod-methods_+3A_...">...</code></td>
<td>
<p> Other optional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>...
</p>


<h3>Value</h3>

<p><code>summary</code> Returns the full list of genetical parameters
</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lmDiallel)
library(multcomp)

# Data with replicates
data("hayman54")

fit &lt;- lm.diallel(Ftime ~ Par1 + Par2, data = hayman54,
                  fct = "HAYMAN1")
summary(fit)
anova(fit)
gh &lt;- glht(linfct = diallel.eff(fit))
</code></pre>

<hr>
<h2 id='expand.diallel'>
Create a Data Frame from All Combinations of Parentals
</h2><span id='topic+expand.diallel'></span>

<h3>Description</h3>

<p>This is a modification of the 'expand.grid()' function working specifically with diallel experiments. It creates a data frame from all combinations of the supplied vector of parents, depending on the mating scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand.diallel(pars, mating = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand.diallel_+3A_pars">pars</code></td>
<td>
<p><code>pars</code> a vector of parentals</p>
</td></tr>
<tr><td><code id="expand.diallel_+3A_mating">mating</code></td>
<td>
<p>The type of mating scheme. 1: full diallel experiment; 2: no reciprocals; 3: no selfs; 4: no reciprocals and no selfs</p>
</td></tr></table>


<h3>Value</h3>

<p>returns a data.frame object</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pars &lt;- LETTERS[1:4]
expand.diallel(pars, mating = 3)
</code></pre>

<hr>
<h2 id='GCA'>
General Combining Ability effect
</h2><span id='topic+GCA'></span><span id='topic+GCAmis'></span>

<h3>Description</h3>

<p>GCA effect to fit Hayman1 &amp; 2 and Griffing 1 &amp; 2 models with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GCA(P1,P2,type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GCA_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="GCA_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="GCA_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="GCA_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of n-1 parentals
</p>


<h3>Value</h3>

<p>A design matrix for the GCA effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli , Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
contrasts(hayman54$Block) &lt;- "contr.sum"
dMod&lt;-lm(Ftime ~ Block + GCA(Par1,Par2)
         + tSCA(Par1, Par2) + RGCA(Par1, Par2)
         + RSCA(Par1,Par2), data = hayman54)
anova(dMod)
</code></pre>

<hr>
<h2 id='GCAC'>
General Combining Ability without considering the selfed parents
</h2><span id='topic+GCAC'></span>

<h3>Description</h3>

<p>Design matrix for GCAC, useful to fit Gardner &amp; Eberhart model 3 (GE3) with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GCAC(P1,P2,type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GCAC_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="GCAC_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="GCAC_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="GCAC_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of n-1 parentals
</p>


<h3>Value</h3>

<p>A design matrix for the GCAC effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi
</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
GCAC(Par1,Par2, data=hayman54)
</code></pre>

<hr>
<h2 id='griffing56'>
Griffing's dataset for diallel analysis
</h2><span id='topic+griffing56'></span>

<h3>Description</h3>

<p>Data for a diallel in maize, with no selfs and no selfed parents. Data are the means of several replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("griffing56")
</code></pre>


<h3>Format</h3>

<p>A data.frame with 36 observations on the following 5 variables
</p>

<dl>
<dt><code>Par1</code></dt><dd><p>male parent, a factor with 8 levels</p>
</dd>
<dt><code>Par2</code></dt><dd><p>female parent, a factor with 8 levels</p>
</dd>
<dt><code>Yield</code></dt><dd><p>Maize Yield</p>
</dd>
<dt><code>Cob</code></dt><dd><p>Cob weight</p>
</dd>
<dt><code>Shelled</code></dt><dd><p>Shelled corn weight</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>Source</h3>

<p><cite>Griffing, B., 1956. Concept of general and specific combining ability in relation to diallel crossing systems. Australian Journal of Biological Science 9, 463&ndash;493.</cite>
</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("griffing56")
dMod2 &lt;- lm.diallel(Yield ~ Par1 + Par2,
                    data = griffing56, fct = "GRIFFING4")
anova(dMod2, MSE = 21.05, dfr = 2558)
summary(dMod2, MSE = 21.05, dfr = 2558)
</code></pre>

<hr>
<h2 id='H.BAR'>
Average heterosis effect
</h2><span id='topic+H.BAR'></span>

<h3>Description</h3>

<p>H.BAR effect to fit GE2 and GE3 models with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H.BAR(P1, P2, type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="H.BAR_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="H.BAR_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="H.BAR_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="H.BAR_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A design matrix for the H.BAR effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli , Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("zhang05")
dMod &lt;- lm(Yield ~ Env/Block + H.BAR(Par1, Par2) + VEi(Par1, Par2) +
                   Hi(Par1, Par2) + SCA(Par1, Par2) +
                   H.BAR(Par1, Par2):Env + VEi(Par1, Par2):Env +
                   Hi(Par1, Par2):Env + SCA(Par1, Par2):Env, data = zhang05)
anova(dMod)
</code></pre>

<hr>
<h2 id='hayman54'>
Hayman dataset for diallel analysis
</h2><span id='topic+hayman54'></span>

<h3>Description</h3>

<p>Data for a diallel in tobacco with 2 reps
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hayman54)</code></pre>


<h3>Format</h3>

<p>A data.frame with 128 observations on the following 4 variables
</p>

<dl>
<dt><code>Block</code></dt><dd><p>block, a factor with 2 levels</p>
</dd>
<dt><code>Par1</code></dt><dd><p>male parent, a factor with 8 levels</p>
</dd>
<dt><code>Par2</code></dt><dd><p>female parent, a factor with 8 levels</p>
</dd>
<dt><code>Ftime</code></dt><dd><p>mean flowering time (days), a numeric vector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>Source</h3>

<p><cite>B. I. Hayman (1954a). The Analysis of Variance of Diallel Tables. Biometrics, 10, 235-244. Table 5, page 241. http://doi.org/10.2307/3001877</cite>
</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")

contrasts(hayman54$Block) &lt;- c("contr.sum")
dMod &lt;- lm(Ftime ~ Block  + GCA(Par1, Par2)
             + tSCA(Par1, Par2) + RGCA(Par1, Par2)
             + RSCA(Par1, Par2), data = hayman54)
anova(dMod)
#or
dMod2 &lt;- lm.diallel(Ftime ~ Par1 + Par2, Block = Block,
                  data = hayman54,
                  fct = "HAYMAN1")
anova(dMod2)
</code></pre>

<hr>
<h2 id='Hi'>
Average heterosis effect
</h2><span id='topic+Hi'></span>

<h3>Description</h3>

<p>H.i effect to fit GE2 Model with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hi(P1, P2, type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hi_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="Hi_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="Hi_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="Hi_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of n-1 parentals
</p>


<h3>Value</h3>

<p>A design matrix for the Hi effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli , Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("zhang05")
dMod &lt;- lm(Yield ~ Env/Block + H.BAR(Par1, Par2) + VEi(Par1, Par2) +
                   Hi(Par1, Par2) + SCA(Par1, Par2) +
                   H.BAR(Par1, Par2):Env + VEi(Par1, Par2):Env +
                   Hi(Par1, Par2):Env + SCA(Par1, Par2):Env, data = zhang05)
anova(dMod)
</code></pre>

<hr>
<h2 id='int.matrix'>
Utilities for fitting diallel models.
</h2><span id='topic+int.matrix'></span><span id='topic+checkScheme'></span><span id='topic+emm.diallel'></span>

<h3>Description</h3>

<p>These functions are used internally by the package, but they can also called from the outside, to fit specific needs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>int.matrix(Xa, Xb)
checkScheme(P1, P2)
emm.diallel(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="int.matrix_+3A_xa">Xa</code></td>
<td>
<p>Incidence matrix of genetic effects</p>
</td></tr>
<tr><td><code id="int.matrix_+3A_xb">Xb</code></td>
<td>
<p>Incidence matrix for an external factor</p>
</td></tr>
<tr><td><code id="int.matrix_+3A_p1">P1</code></td>
<td>
<p>A vector with parentals</p>
</td></tr>
<tr><td><code id="int.matrix_+3A_p2">P2</code></td>
<td>
<p>A vector with parentals</p>
</td></tr>
<tr><td><code id="int.matrix_+3A_obj">obj</code></td>
<td>
<p>A glht object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function 'int.matrix()' produces the incidence matrix for the interaction between two main effects; 'Xa' and 'Xb' are two incidence matrices for two main effects.
The function 'checkScheme()' takes two vectors containing the codings for parentals (P1 and P2), retrieves the mating scheme and detects whether there are missing crosses.
The function 'emm.diallel()' is used with multi-environment diallel experiments to obtain the expected marginal means for genetic effects across environments.
</p>


<h3>Value</h3>

<p>The function 'int.matrix()' returns an incidence matrix. The function 'checkScheme()' returns a list, containing the main traits of the mating scheme. The function 'emm.diallel()' retrns a data.frame with the marginal means, standard errors and t-test statistics.
</p>


<h3>Note</h3>

<p>No further notes
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri
</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(griffing56)
head(griffing56)
checkScheme(griffing56$Par1, griffing56$Par2)
</code></pre>

<hr>
<h2 id='lm.diallel'>
Fitting diallel linear models
</h2><span id='topic+lm.diallel'></span>

<h3>Description</h3>

<p>Wrapper function for lm.fit and diallel models. It can be used to carry out several powerful methods for linear models, such as 'summary()', anova() or 'glht()' in the 'multcomp' package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lm.diallel(formula, Block, Env, fct = "GRIFFING2", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lm.diallel_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.'formula' uses the regular R syntax to specify the response variable and the two variables for parentals <code>(e.g., Yield ~ Par1 + Par2)</code>
</p>
</td></tr>
<tr><td><code id="lm.diallel_+3A_block">Block</code></td>
<td>
<p>used to specify an optional variable coding for blocks</p>
</td></tr>
<tr><td><code id="lm.diallel_+3A_env">Env</code></td>
<td>
<p>used to specify an optional variable coding for environments</p>
</td></tr>
<tr><td><code id="lm.diallel_+3A_fct">fct</code></td>
<td>
<p>a string variable coding for the selected model. 8 main diallel models: Hayman's model 1 (=&quot;HAYMAN1&quot;), Hayman's model 2 (=&quot;HAYMAN2&quot;), Griffing's model 1 (=&quot;GRIFFING1&quot;), Griffing's model 2 (=&quot;GRIFFING2&quot;), Griffing's model 3 (=&quot;GRIFFING3&quot;), Griffing's model 4 (=&quot;GRIFFING4&quot;), Gardner-Eberhart model 2 (=&quot;GE2&quot;)  and Gardner-Eberhart model 3 (=&quot;GE3&quot;). The strings &quot;GE2r&quot; and &quot;GE3r&quot; can be used to specify the 'enhanced' GE2 and GE3 models, including the effect of reciprocals (REC).</p>
</td></tr>
<tr><td><code id="lm.diallel_+3A_data">data</code></td>
<td>
<p>a 'data.frame' where to look for explanatory variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Notations for the 8 models
</p>

<table>
<tr>
 <td style="text-align: left;">
Model name in 'lm.diallel()' </td><td style="text-align: left;"> 	Model notation in 'lm()' </td>
</tr>
<tr>
 <td style="text-align: left;">
HAYMAN1 	</td><td style="text-align: left;"> Y ~ GCA(Par1, Par2) + tSCA(Par1, Par2) + RGCA(Par1, Par2) + RSCA(Par1, Par2) </td>
</tr>
<tr>
 <td style="text-align: left;">
GRIFFING1	</td><td style="text-align: left;"> Y ~ GCA(Par1, Par2) + tSCA(Par1, Par2) + REC(Par1, Par2) </td>
</tr>
<tr>
 <td style="text-align: left;">
GRIFFING2	</td><td style="text-align: left;"> Y ~ GCA(Par1, Par2) + tSCA(Par1, Par2) </td>
</tr>
<tr>
 <td style="text-align: left;">
HAYMAN2	</td><td style="text-align: left;"> Y ~ GCA(Par1, Par2) + MDD(Par1, Par2) + DD(Par1, Par2) + SCA(Par1, Par2) + RGCA(Par1, Par2) + RSCA(Par1, Par2) </td>
</tr>
<tr>
 <td style="text-align: left;">
GE2	</td><td style="text-align: left;"> Y ~ H.BAR(Par1, Par2) + VE.i(Par1, Par2) + H.i(Par1, Par2) + SCA(Par1, Par2) </td>
</tr>
<tr>
 <td style="text-align: left;">
GE3	</td><td style="text-align: left;"> Y ~ H.BAR(Par1, Par2) + SP(Par1, Par2) + GCAC(Par1, Par2) + SCA(Par1, Par2) </td>
</tr>
<tr>
 <td style="text-align: left;">
GE2r </td><td style="text-align: left;"> Y ~ H.BAR(Par1, Par2) + VE.i(Par1, Par2) + H.i(Par1, Par2) + SCA(Par1, Par2) + RGCA(Par1, Par2) + RSCA(Par1, Par2) </td>
</tr>
<tr>
 <td style="text-align: left;">
GE3r	</td><td style="text-align: left;"> Y ~ H.BAR(Par1, Par2) + SP(Par1, Par2) + GCAC(Par1, Par2) + SCA(Par1, Par2) + RGCA(Par1, Par2) + RSCA(Par1, Par2)</td>
</tr>

</table>



<h3>Value</h3>

<p>lm.diallel returns an object of class  c(&quot;diallel&quot;, &quot;lm&quot;), that is a list containing at least the following components:
</p>

<dl>
<dt><code>coefficients</code></dt><dd><p>a named vector of coefficients</p>
</dd>
<dt><code>residuals</code></dt><dd><p>the residuals, that is response minus fitted values</p>
</dd>
<dt><code>fitted.values</code></dt><dd><p>the fitted mean values</p>
</dd>
<dt><code>rank</code></dt><dd><p>the numeric rank of the fitted linear models</p>
</dd>
<dt><code>weights</code></dt><dd><p>(only for weighted fits) the specified weights</p>
</dd>
<dt><code>df.residual</code></dt><dd><p>the residual degrees of freedom</p>
</dd>
<dt><code>call</code></dt><dd><p>the matched call</p>
</dd>
<dt><code>terms</code></dt><dd><p>the terms object used</p>
</dd>
<dt><code>contrasts	</code></dt><dd><p>(only where relevant) the contrasts used</p>
</dd>
<dt><code>xlevels</code></dt><dd><p>(only where relevant) a record of the levels of the factors used in fitting</p>
</dd>
<dt><code>call</code></dt><dd><p>the matched call</p>
</dd>
<dt><code>offset</code></dt><dd><p>the offset used (missing if none were used)</p>
</dd>
<dt><code>y</code></dt><dd><p>if requested, the response used</p>
</dd>
<dt><code>x</code></dt><dd><p>if requested, the model matrix used</p>
</dd>
<dt><code>model</code></dt><dd><p>if requested (the default), the model frame used</p>
</dd>
<dt><code>na.action</code></dt><dd><p>(where relevant) information returned by model.frame on the special handling of NAs</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
dMod &lt;- lm.diallel(Ftime ~ Par1 + Par2, Block = Block,
                  data = hayman54,
                  fct = "HAYMAN1")
anova(dMod)

#or
data("zhang05")
contrasts(zhang05$Block) &lt;- c("contr.sum")
dMod2 &lt;- lm.diallel(Yield ~ Par1 + Par2, Env = Env, Block = Block,
            data = zhang05, fct = "GE2")

#or
data("lonnquist61")
dMod3 &lt;- lm.diallel(Yield ~ Par1 + Par2,
                  data = lonnquist61,
                  fct = "GE2")
summary(dMod3, MSE = 7.10, dfr = 60)
anova(dMod3, MSE = 7.10, dfr = 60)
</code></pre>

<hr>
<h2 id='lmDiallel-methods'> Methods for diallel model fitting </h2><span id='topic+vcov.diallel'></span><span id='topic+summary.diallel'></span><span id='topic+anova.diallel'></span><span id='topic+predict.diallel'></span><span id='topic+model.matrix.diallel'></span><span id='topic+glht.diallel'></span>

<h3>Description</h3>

<p>The object returned by the 'lm.diallel()' function is of classes 'lm' and 'diallel'. Specific methods were devised to explore the 'diallel' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'diallel'
summary(object, MSE, dfr, ...)
## S3 method for class 'diallel'
vcov(object, MSE, ...)
## S3 method for class 'diallel'
anova(object, MSE, dfr, type = 1, ...)
## S3 method for class 'diallel'
model.matrix(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmDiallel-methods_+3A_object">object</code></td>
<td>
<p> an object of class diallel.</p>
</td></tr>
<tr><td><code id="lmDiallel-methods_+3A_mse">MSE</code></td>
<td>
<p> Mean Square Error, when it cannot be derived from model fit</p>
</td></tr>
<tr><td><code id="lmDiallel-methods_+3A_dfr">dfr</code></td>
<td>
<p> Residual degrees of freedom, when they cannot be derived from model fit</p>
</td></tr>
<tr><td><code id="lmDiallel-methods_+3A_type">type</code></td>
<td>
<p> It is used to select between Type I (sequential) or Type III (marginal) F tests in ANOVA</p>
</td></tr>
<tr><td><code id="lmDiallel-methods_+3A_...">...</code></td>
<td>
<p> Other optional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To be defined
</p>


<h3>Value</h3>

<p><code>vcov.diallel</code>: a variance-covariance matrix
<code>summary.diallel</code>: a data.frame of estimated parameters with standard errors
<code>anova.diallel</code>: an ANOVA table
<code>predict.diallel</code>: a vector of predictions from a diallel model
<code>model.matrix.diallel</code>: a design matrix for the fitted diallel model
</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lmDiallel)
library(multcomp)
# Data with replicates
data("hayman54")

fit &lt;- lm.diallel(Ftime ~ Par1 + Par2, data = hayman54,
                  fct = "HAYMAN1")
summary(fit)
anova(fit)
gh &lt;- glht(linfct = diallel.eff(fit), adjust = "none")
</code></pre>

<hr>
<h2 id='lonnquist61'>
Half diallel of maize dataset
</h2><span id='topic+lonnquist61'></span>

<h3>Description</h3>

<p>Diallel experiment with six maize varieties and no reciprocals. The data here are means adjusted for block effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lonnquist61")</code></pre>


<h3>Format</h3>

<p>A data.frame with 21 observations on the following 3 variables.
</p>

<dl>
<dt><code>Par1</code></dt><dd><p>male parent, a factor with 6 levels</p>
</dd>
<dt><code>Par2</code></dt><dd><p>female parent, a factor with 6 levels</p>
</dd>
<dt><code>Yield</code></dt><dd><p>mean across blocks, a numeric vector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>Source</h3>

<p><cite>J. H. Lonnquist, C. O. Gardner. (1961) Heterosis in Intervarietal Crosses in Maize and Its Implication in Breeding Procedures. Crop Science, 1, 179-183. Table 1.</cite>
</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>
<p><cite>Mohring, Melchinger, Piepho. (2011). REML-Based Diallel Analysis. Crop Science, 51, 470-478. http://doi.org/10.2135/cropsci2010.05.0272</cite>
</p>
<p><cite>C. O. Gardner and S. A. Eberhart. 1966. Analysis and Interpretation of the Variety Cross Diallel and Related Populations. Biometrics, 22, 439-452. http://doi.org/10.2307/2528181</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("lonnquist61")
dMod &lt;- lm(Yield ~ H.BAR(Par1, Par2) + VEi(Par1, Par2) +
             Hi(Par1, Par2) + SCA(Par1, Par2),
                  data = lonnquist61)
summary.diallel(dMod, MSE = 7.10, dfr = 60)
anova.diallel(dMod, MSE = 7.10, dfr = 60)
</code></pre>

<hr>
<h2 id='matBlock'>
Design matrix for blocks
</h2><span id='topic+matBlock'></span>

<h3>Description</h3>

<p>It creates a disign matrix for block effects (with sum-to-zero constraint). It is used internally
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matBlock(formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matBlock_+3A_formula">formula</code></td>
<td>
<p><code>a formula containing the block variables</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A design matrix for the block effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
matBlock(~hayman54$Block)
</code></pre>

<hr>
<h2 id='MDD'>
Mean Dominance Deviation effect
</h2><span id='topic+MDD'></span>

<h3>Description</h3>

<p>It relates to the difference between the average yield of selfed parents and the average yield of crosses. DD effect to fit Hayman2 model with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MDD(P1, P2, type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MDD_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="MDD_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="MDD_+3A_type">type</code></td>
<td>
<p><code>a variable for the model</code></p>
</td></tr>
<tr><td><code id="MDD_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A design matrix for the MDD effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
MDD(Par1, Par2, data = hayman54)
</code></pre>

<hr>
<h2 id='mmer.diallel'>
Fitting random diallel linear models
</h2><span id='topic+mmer.diallel'></span>

<h3>Description</h3>

<p>Wrapper function for the function 'mmer()' in the 'sommer' package. It can be used to fit random diallel models and retreive variance components for main effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmer.diallel(formula, Block, Env, fct, data, type = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmer.diallel_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.'formula' uses the regular R syntax to specify the response variable and the two variables for parentals <code>(e.g., Yield ~ Par1 + Par2)</code>
</p>
</td></tr>
<tr><td><code id="mmer.diallel_+3A_block">Block</code></td>
<td>
<p>used to specify an optional variable coding for blocks</p>
</td></tr>
<tr><td><code id="mmer.diallel_+3A_env">Env</code></td>
<td>
<p>used to specify an optional variable coding for environments</p>
</td></tr>
<tr><td><code id="mmer.diallel_+3A_data">data</code></td>
<td>
<p>a 'data.frame' where to look for explanatory variables</p>
</td></tr>
<tr><td><code id="mmer.diallel_+3A_fct">fct</code></td>
<td>
<p>a string variable coding for the selected model. 8 main diallel models: Hayman's model 1 (=&quot;HAYMAN1&quot;), Hayman's model 2 (=&quot;HAYMAN2&quot;), Griffing's model 1 (=&quot;GRIFFING1&quot;), Griffing's model 2 (=&quot;GRIFFING2&quot;), Griffing's model 3 (=&quot;GRIFFING3&quot;), Griffing's model 4 (=&quot;GRIFFING4&quot;), Gardner-Eberhart model 2 (=&quot;GE2&quot;)  and Gardner-Eberhart model 3 (=&quot;GE3&quot;). The strings &quot;GE2r&quot; and &quot;GE3r&quot; can be used to specify the 'enhanced' GE2 and GE3 models, including the effect of reciprocals (REC).</p>
</td></tr>
<tr><td><code id="mmer.diallel_+3A_type">type</code></td>
<td>
<p>a string variable coding for the selected model. It is only used for multi-environment experiments and it is equal to &quot;all&quot; when both the environment and genetical effects are random or &quot;environment&quot; when the environment is random and genetical effects are fixed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame of variance components with standard errors
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Covarrubias-Pazaran, G., 2016. Genome-Assisted Prediction of Quantitative Traits Using the R Package sommer. PLOS ONE 11, e0156744. https://doi.org/10.1371/journal.pone.0156744</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
rMod &lt;- mmer.diallel(Ftime ~ Par1 + Par2, Block = Block,
                  data = hayman54,
                  fct = "HAYMAN1")
rMod
</code></pre>

<hr>
<h2 id='model.matrixDiallel'>
Incidence matrices for Diallel model parametrisation
</h2><span id='topic+model.matrixDiallel'></span><span id='topic+model.matrixDiallel.MET'></span>

<h3>Description</h3>

<p><code>model.matrixDiallel</code> is useful to build design matrices, according to the user-defined (or default) parameterisation for <code>lm</code> function. It shares the same syntax of the <code>lm.diallel</code> function.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrixDiallel_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.'formula' uses the regular R syntax to specify the response variable and the two variables for parentals <code>(e.g., Yield ~ Par1 + Par2)</code>
</p>
</td></tr>
<tr><td><code id="model.matrixDiallel_+3A_block">Block</code></td>
<td>
<p>used to specify an optional variable coding for blocks</p>
</td></tr>
<tr><td><code id="model.matrixDiallel_+3A_env">Env</code></td>
<td>
<p>used to specify an optional variable coding for environments</p>
</td></tr>
<tr><td><code id="model.matrixDiallel_+3A_data">data</code></td>
<td>
<p>a 'data.frame' where to look for explanatory variables</p>
</td></tr>
<tr><td><code id="model.matrixDiallel_+3A_fct">fct</code></td>
<td>
<p>a string variable coding for the selected model. 6 main diallel models: Hayman's model 1 (=&quot;HAYMAN1&quot;), Hayman's model 2 (=&quot;HAYMAN2&quot;), Griffing's model 1 (=&quot;GRIFFING1&quot;), Griffing's model 2 (=&quot;GRIFFING2&quot;), Gardner-Eberhart model 2 (=&quot;GE2&quot;)  and Gardner-Eberhart model 3 (=&quot;GE3&quot;). The strings &quot;GE2r&quot; and &quot;GE3r&quot; can be used to specify the 'enhanced' GE2 and GE3 models, including the effect of reciprocals (REC).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>model.matrixDiallel creates a design matrix for a diallel model, as specified in the 'fct' argument.
</p>


<h3>Value</h3>

<p>The design matrix for a diallel model as specified in the 'fct' argument.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("diallelMET")
ModMat &lt;- model.matrixDiallel(Yield ~ Par1 + Par2,
                   Env, Block, fct= "GE3",
                   data = diallelMET)
</code></pre>

<hr>
<h2 id='REC'>
Reciprocal Effect not parted into RGCA and RSCA
</h2><span id='topic+REC'></span><span id='topic+REC.G3'></span>

<h3>Description</h3>

<p>Build incidence matrix to fit reciprocal effects in Griffing's model 1, 2, 4 (REC) and 3 (REC.G3) with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REC(P1, P2, type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="REC_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="REC_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="REC_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="REC_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr></table>


<h3>Details</h3>

<p>a design matrix of n-1 parentals
</p>


<h3>Value</h3>

<p>A design matrix for the reciprocal (REC) effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
dMod&lt;-lm(Ftime~ Block + GCA(Par1,Par2)
         +tSCA(Par1, Par2)+REC(Par1, Par2)
         , data = hayman54)
anova(dMod)
</code></pre>

<hr>
<h2 id='RGCA'>
Reciprocal General Combining Ability
</h2><span id='topic+RGCA'></span>

<h3>Description</h3>

<p>RGCA effect to fit Hayman1 &amp; 2 models with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RGCA(P1,P2,type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RGCA_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="RGCA_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="RGCA_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="RGCA_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of n-1 parentals
</p>


<h3>Value</h3>

<p>A design matrix for the RGCA effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
dMod&lt;-lm(Ftime~ Block + GCA(Par1,Par2)
         + tSCA(Par1, Par2) + RGCA(Par1, Par2)
         + RSCA(Par1,Par2), data = hayman54)
anova(dMod)
</code></pre>

<hr>
<h2 id='RSCA'>
Reciprocal Specific Combining Ability
</h2><span id='topic+RSCA'></span>

<h3>Description</h3>

<p>RSCA effect to fit Hayman 1 &amp; 2 models with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RSCA(P1,P2,type = "fix",data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RSCA_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="RSCA_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="RSCA_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="RSCA_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of all possible combinations between parentals with no selfs and no reciprocals
</p>


<h3>Value</h3>

<p>A design matrix for the RSCA effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
dMod&lt;-lm(Ftime~ Block + GCA(Par1,Par2)
         + tSCA(Par1, Par2) + RGCA(Par1, Par2)
         + RSCA(Par1,Par2), data = hayman54)
anova(dMod)
</code></pre>

<hr>
<h2 id='SCA'>
Specific Combining Ability
</h2><span id='topic+SCA'></span><span id='topic+SCA.G3'></span><span id='topic+SCA.GE'></span><span id='topic+SCAmis'></span>

<h3>Description</h3>

<p>SCA effect to fit Hayman2, Griffing3 (SCA.G3), GE2 and GE3 (SCA.GE) models with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCA(P1, P2, type = "fix", data)
SCA.G3(P1, P2,  type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SCA_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="SCA_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="SCA_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="SCA_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of all possible combinations between parentals with no selfs and no reciprocals
</p>


<h3>Value</h3>

<p>A design matrix for the SCA effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("zhang05")
dMod &lt;- lm(Yield ~ Env/Block + H.BAR(Par1, Par2) + VEi(Par1, Par2) +
                   Hi(Par1, Par2) + SCA(Par1, Par2) +
                   H.BAR(Par1, Par2):Env + VEi(Par1, Par2):Env +
                   Hi(Par1, Par2):Env + SCA(Par1, Par2):Env, data = zhang05)
anova(dMod)
</code></pre>

<hr>
<h2 id='SP'>
Selfed Parents effect
</h2><span id='topic+SP'></span>

<h3>Description</h3>

<p>SP effect to fit GE3 model with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SP(P1, P2, type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SP_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="SP_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="SP_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="SP_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of n-1 parentals
</p>


<h3>Value</h3>

<p>A design matrix for the SP effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
SP(Par1,Par2, data=hayman54)
</code></pre>

<hr>
<h2 id='tSCA'>
Total Specific Combining Ability
</h2><span id='topic+tSCA'></span>

<h3>Description</h3>

<p>Total SCA to fit Hayman1, Griffing1 and Griffing2 models with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tSCA(P1,P2,type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tSCA_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="tSCA_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="tSCA_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="tSCA_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of all possible combinations between parentals with selfs but no reciprocals
</p>


<h3>Value</h3>

<p>A design matrix for the tSCA effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hayman54")
dMod&lt;-lm(Ftime~ Block + GCA(Par1,Par2)
         + tSCA(Par1, Par2) + RGCA(Par1, Par2)
         + RSCA(Par1,Par2), data = hayman54)
anova(dMod)
</code></pre>

<hr>
<h2 id='VEi'>
Variety Effect
</h2><span id='topic+VEi'></span>

<h3>Description</h3>

<p>VE.i effect to fit GE2 model with <code>lm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VEi(P1, P2, type = "fix", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VEi_+3A_p1">P1</code></td>
<td>
<p><code>a variable for the first parent</code></p>
</td></tr>
<tr><td><code id="VEi_+3A_p2">P2</code></td>
<td>
<p><code>a variable for the second parent</code></p>
</td></tr>
<tr><td><code id="VEi_+3A_type">type</code></td>
<td>
<p><code>a variable for model selection. May be "fix" (fixed model) or "random" (random model).</code></p>
</td></tr>
<tr><td><code id="VEi_+3A_data">data</code></td>
<td>
<p><code>a 'data.frame' where to look for explanatory variables</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>a design matrix of n-1 parentals
</p>


<h3>Value</h3>

<p>A design matrix for the VEi effect
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("zhang05")
dMod &lt;- lm(Yield ~ Env/Block + H.BAR(Par1, Par2) + VEi(Par1, Par2) +
                   Hi(Par1, Par2) + SCA(Par1, Par2) +
                   H.BAR(Par1, Par2):Env + VEi(Par1, Par2):Env +
                   Hi(Par1, Par2):Env + SCA(Par1, Par2):Env, data = zhang05)
anova(dMod)
</code></pre>

<hr>
<h2 id='zhang05'>
Data for diallel analysis from Zhang (2005)
</h2><span id='topic+zhang05'></span>

<h3>Description</h3>

<p>Data collected in XXX with 5 parents, 2 reps and 2 environments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("zhang05")</code></pre>


<h3>Format</h3>

<p>A data.frame with 60 observations on the following 6 variables.
</p>

<dl>
<dt><code>Par1</code></dt><dd><p>male parent, a factor with 5 levels</p>
</dd>
<dt><code>Par2</code></dt><dd><p>female parent, a factor with 5 levels</p>
</dd>
<dt><code>Block</code></dt><dd><p>block, a factor with 2 levels</p>
</dd>
<dt><code>Combination</code></dt><dd><p>combination between environment and block,  an integer vector</p>
</dd>
<dt><code>Env</code></dt><dd><p>environment, a factor with 2 levels</p>
</dd>
<dt><code>Yield</code></dt><dd><p>yield, a numeric vector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Onofri, Niccolo' Terzaroli, Luigi Russi</p>


<h3>Source</h3>

<p><cite>Zhang, Y., Kang, M.S. and Lamkey, K.R. (2005), DIALLEL-SAS05: A Comprehensive Program for Griffing's and Gardner&amp;Eberhart Analyses. Agron. J., 97: 1097-1106. https://doi.org/10.2134/agronj2004.0260</cite>
</p>


<h3>References</h3>

<p><cite>Onofri, A., Terzaroli, N. &amp; Russi, L. Linear models for diallel crosses: a review with R functions. Theor Appl Genet (2020). https://doi.org/10.1007/s00122-020-03716-8</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("zhang05")
contrasts(zhang05$Block) &lt;- c("contr.sum")
contrasts(zhang05$Env) &lt;- c("contr.sum")
dMod &lt;- lm(Yield ~ Env/Block + H.BAR(Par1, Par2) + VEi(Par1, Par2) +
                   Hi(Par1, Par2) + SCA(Par1, Par2) +
                   H.BAR(Par1, Par2):Env + GCA(Par1, Par2):Env +
                   Hi(Par1, Par2):Env + SCA(Par1, Par2):Env, data = zhang05)
anova(dMod)
#or
dMod2 &lt;- lm(Yield ~ Env/Block + H.BAR(Par1, Par2) + VEi(Par1, Par2) +
                   Hi(Par1, Par2) + SCA(Par1, Par2), data = zhang05)
summary(dMod2)$coefficients
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
