<!DOCTYPE html><html lang="en"><head><title>Help for package fasano.franceschini.test</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fasano.franceschini.test}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fasano.franceschini.test'><p>Fasano-Franceschini Test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fasano-Franceschini Test: A Multivariate Kolmogorov-Smirnov
Two-Sample Test</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of the two-sample multivariate
    Kolmogorov-Smirnov test described by Fasano and Franceschini (1987)
    &lt;<a href="https://doi.org/10.1093%2Fmnras%2F225.1.155">doi:10.1093/mnras/225.1.155</a>&gt;. This test evaluates the null hypothesis
    that two i.i.d. random samples were drawn from the same underlying
    probability distribution. The data can be of any dimension, and can be
    of any type (continuous, discrete, or mixed).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/braunlab-nu/fasano.franceschini.test">https://github.com/braunlab-nu/fasano.franceschini.test</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/braunlab-nu/fasano.franceschini.test/issues">https://github.com/braunlab-nu/fasano.franceschini.test/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.0), RcppParallel (&ge; 5.0.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp (&ge; 1.0.0), RcppParallel (&ge; 5.0.1)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-07 03:05:26 UTC; connorpuritz</td>
</tr>
<tr>
<td>Author:</td>
<td>Connor Puritz <a href="https://orcid.org/0000-0001-7602-0444"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Elan Ness-Cohn <a href="https://orcid.org/0000-0002-3935-6667"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Rosemary Braun <a href="https://orcid.org/0000-0001-9668-9866"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, ths],
  Luca Weihs [cph] (Copyright holder and author of 'RangeTree' class.)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Connor Puritz &lt;connorpuritz2025@u.northwestern.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-07 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fasano.franceschini.test'>Fasano-Franceschini Test</h2><span id='topic+fasano.franceschini.test'></span>

<h3>Description</h3>

<p>Performs a two-sample multivariate Kolmogorov-Smirnov test as described
by Fasano and Franceschini (1987). This test evaluates the null hypothesis
that two i.i.d. random samples were drawn from the same underlying
probability distribution. The data can be of any dimension and of any
type (continuous, discrete, or mixed).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fasano.franceschini.test(
  S1,
  S2,
  nPermute = 100,
  threads = 1,
  seed = NULL,
  verbose = TRUE,
  method = c("r", "b")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fasano.franceschini.test_+3A_s1">S1</code></td>
<td>
<p><code>matrix</code> or <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="fasano.franceschini.test_+3A_s2">S2</code></td>
<td>
<p><code>matrix</code> or <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="fasano.franceschini.test_+3A_npermute">nPermute</code></td>
<td>
<p>A nonnegative <code>integer</code> setting the number of permutations
to use for performing the permutation test. Default is <code>100</code>. If set to
<code>0</code>, only the test statistic is computed.</p>
</td></tr>
<tr><td><code id="fasano.franceschini.test_+3A_threads">threads</code></td>
<td>
<p>A positive <code>integer</code> or <code>"auto"</code> setting the number
of threads to use during the permutation test. If set to <code>"auto"</code>, the
number of threads is determined by <code>RcppParallel::defaultNumThreads()</code>.
Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="fasano.franceschini.test_+3A_seed">seed</code></td>
<td>
<p>An optional integer to seed the PRNG used for the permutation test.
A seed must be passed to reproducibly compute p-values.</p>
</td></tr>
<tr><td><code id="fasano.franceschini.test_+3A_verbose">verbose</code></td>
<td>
<p>A <code>boolean</code> indicating whether to display a progress bar.
Default is <code>TRUE</code>. Only available when <code>threads = 1</code>.</p>
</td></tr>
<tr><td><code id="fasano.franceschini.test_+3A_method">method</code></td>
<td>
<p>An optional <code>character</code> indicating which method to use to
compute the test statistic. The two methods are <code>'r'</code> (range tree) and
<code>'b'</code> (brute force). Both methods return the same results but may vary in
computation speed. If this argument is not passed, the sample sizes and dimension
of the data are used to infer which method is likely faster. See the Details
section for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic can be computed using two different methods.
Both methods return identical results, but have different time complexities:
</p>

<ul>
<li><p> Range tree method: This method has a time complexity of
<em>O(N*log(N)^(d-1))</em>, where <em>N</em> is the size of the larger sample
and <em>d</em> is the dimension of the data.
</p>
</li>
<li><p> Brute force method: This method has a time complexity of <em>O(N^2)</em>.
</p>
</li></ul>

<p>The range tree method tends to be faster for low dimensional data or large
sample sizes, while the brute force method tends to be faster for high
dimensional data or small sample sizes. When <code>method</code> is not passed,
the sample sizes and dimension of the data are used to infer which method will
likely be faster. However, as the geometry of the samples can influence
computation time, the method inferred to be faster may not actually be faster. To
perform more comprehensive benchmarking for a specific dataset, <code>nPermute</code>
can be set equal to <code>0</code>, which bypasses the permutation test and only
computes the test statistic.
</p>


<h3>Value</h3>

<p>A list of class <code>htest</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The permutation test p-value.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The name of the test.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>The names of the original data objects.</p>
</td></tr>
</table>


<h3>References</h3>



<ul>
<li><p>Fasano, G. &amp; Franceschini, A. (1987). A multidimensional version of the
Kolmogorov-Smirnov test. <em>Monthly Notices of the Royal Astronomical Society</em>,
225:155-170. <a href="https://doi.org/10.1093/mnras/225.1.155">doi:10.1093/mnras/225.1.155</a>.
</p>
</li></ul>
 


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)

# create 2-D samples
S1 &lt;- data.frame(x = rnorm(n = 20, mean = 0, sd = 1),
                 y = rnorm(n = 20, mean = 1, sd = 2))
S2 &lt;- data.frame(x = rnorm(n = 40, mean = 0, sd = 1),
                 y = rnorm(n = 40, mean = 1, sd = 2))

# perform test
fasano.franceschini.test(S1, S2)

# perform test with more permutations
fasano.franceschini.test(S1, S2, nPermute = 150)

# set seed for reproducible p-value
fasano.franceschini.test(S1, S2, seed = 0)$p.value
fasano.franceschini.test(S1, S2, seed = 0)$p.value

# perform test using range tree method
fasano.franceschini.test(S1, S2, method = 'r')

# perform test using brute force method
fasano.franceschini.test(S1, S2, method = 'b')

# perform test using multiple threads to speed up p-value computation
## Not run: 
fasano.franceschini.test(S1, S2, threads = 2)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
