<!DOCTYPE html><html><head><title>Help for package mdatools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mdatools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.matrix.classres'><p>as.matrix method for classification results</p></a></li>
<li><a href='#as.matrix.ldecomp'><p>as.matrix method for ldecomp object</p></a></li>
<li><a href='#as.matrix.plsdares'><p>as.matrix method for PLS-DA results</p></a></li>
<li><a href='#as.matrix.plsres'><p>as.matrix method for PLS results</p></a></li>
<li><a href='#as.matrix.regcoeffs'><p>as.matrix method for regression coefficients class</p></a></li>
<li><a href='#as.matrix.regres'><p>as.matrix method for regression results</p></a></li>
<li><a href='#as.matrix.simcamres'><p>as.matrix method for SIMCAM results</p></a></li>
<li><a href='#as.matrix.simcares'><p>as.matrix method for SIMCA classification results</p></a></li>
<li><a href='#capitalize'><p>Capitalize text or vector with text values</p></a></li>
<li><a href='#carbs'>
<p>Raman spectra of carbonhydrates</p></a></li>
<li><a href='#categorize'><p>Categorize PCA results</p></a></li>
<li><a href='#categorize.pca'><p>Categorize PCA results based on orthogonal and score distances.</p></a></li>
<li><a href='#categorize.pls'><p>Categorize data rows based on PLS results and critical limits for total distance.</p></a></li>
<li><a href='#chisq.crit'><p>Calculates critical limits for distance values using Chi-square distribution</p></a></li>
<li><a href='#chisq.prob'><p>Calculate probabilities for distance values using Chi-square distribution</p></a></li>
<li><a href='#classify.plsda'><p>PLS-DA classification</p></a></li>
<li><a href='#classify.simca'><p>SIMCA classification</p></a></li>
<li><a href='#classmodel.processRefValues'><p>Check reference class values and convert it to a factor if necessary</p></a></li>
<li><a href='#classres'><p>Results of classification</p></a></li>
<li><a href='#classres.getPerformance'><p>Calculation of  classification performance parameters</p></a></li>
<li><a href='#confint.regcoeffs'><p>Confidence intervals for regression coefficients</p></a></li>
<li><a href='#constraint'><p>Class for MCR-ALS constraint</p></a></li>
<li><a href='#constraintAngle'><p>Method for angle constraint</p></a></li>
<li><a href='#constraintClosure'><p>Method for closure constraint</p></a></li>
<li><a href='#constraintNonNegativity'><p>Method for non-negativity constraint</p></a></li>
<li><a href='#constraintNorm'><p>Method for normalization constraint</p></a></li>
<li><a href='#constraints.list'><p>Shows information about all implemented constraints</p></a></li>
<li><a href='#constraintUnimod'><p>Method for unimodality constraint</p></a></li>
<li><a href='#crossval'><p>Generate sequence of indices for cross-validation</p></a></li>
<li><a href='#crossval.getParams'><p>Define parameters based on 'cv' value</p></a></li>
<li><a href='#crossval.regmodel'><p>Cross-validation of a regression model</p></a></li>
<li><a href='#crossval.simca'><p>Cross-validation of a SIMCA model</p></a></li>
<li><a href='#crossval.str'><p>String with description of cross-validation method</p></a></li>
<li><a href='#dd.crit'><p>Calculates critical limits for distance values using Data Driven moments approach</p></a></li>
<li><a href='#ddmoments.param'><p>Calculates critical limits for distance values using Data Driven moments approach</p></a></li>
<li><a href='#ddrobust.param'><p>Calculates critical limits for distance values using Data Driven robust approach</p></a></li>
<li><a href='#ellipse'><p>Create ellipse on the current plot</p></a></li>
<li><a href='#employ.constraint'><p>Applies constraint to a dataset</p></a></li>
<li><a href='#employ.prep'><p>Applies a list with preprocessing methods to a dataset</p></a></li>
<li><a href='#fprintf'><p>Imitation of fprinf() function</p></a></li>
<li><a href='#getCalibrationData'><p>Calibration data</p></a></li>
<li><a href='#getCalibrationData.pca'><p>Returns matrix with original calibration data</p></a></li>
<li><a href='#getCalibrationData.simcam'><p>Get calibration data</p></a></li>
<li><a href='#getConfidenceEllipse'><p>Compute confidence ellipse for a set of points</p></a></li>
<li><a href='#getConfusionMatrix'><p>Confusion matrix for classification results</p></a></li>
<li><a href='#getConfusionMatrix.classres'><p>Confusion matrix for classification results</p></a></li>
<li><a href='#getConvexHull'><p>Compute coordinates of a closed convex hull for data points</p></a></li>
<li><a href='#getDataLabels'><p>Create a vector with labels for plot series</p></a></li>
<li><a href='#getImplementedConstraints'><p>Shows a list with implemented constraints</p></a></li>
<li><a href='#getImplementedPrepMethods'><p>Shows a list with implemented preprocessing methods</p></a></li>
<li><a href='#getLabelsAsIndices'><p>Create labels as column or row indices</p></a></li>
<li><a href='#getLabelsAsValues'><p>Create labels from data values</p></a></li>
<li><a href='#getMainTitle'><p>Get main title</p></a></li>
<li><a href='#getPlotColors'><p>Define colors for plot series</p></a></li>
<li><a href='#getProbabilities'><p>Get class belonging probability</p></a></li>
<li><a href='#getProbabilities.pca'><p>Probabilities for residual distances</p></a></li>
<li><a href='#getProbabilities.simca'><p>Probabilities of class belonging for PCA/SIMCA results</p></a></li>
<li><a href='#getPureVariables'><p>Identifies pure variables</p></a></li>
<li><a href='#getRegcoeffs'><p>Get regression coefficients</p></a></li>
<li><a href='#getRegcoeffs.regmodel'><p>Regression coefficients for PLS model'</p></a></li>
<li><a href='#getRes'><p>Return list with valid results</p></a></li>
<li><a href='#getSelectedComponents'><p>Get selected components</p></a></li>
<li><a href='#getSelectivityRatio'><p>Selectivity ratio</p></a></li>
<li><a href='#getSelectivityRatio.pls'><p>Selectivity ratio for PLS model</p></a></li>
<li><a href='#getVariance.mcr'><p>Compute explained variance for MCR case</p></a></li>
<li><a href='#getVIPScores'><p>VIP scores</p></a></li>
<li><a href='#getVIPScores.pls'><p>VIP scores for PLS model</p></a></li>
<li><a href='#hotelling.crit'><p>Calculate critical limits for distance values using Hotelling T2 distribution</p></a></li>
<li><a href='#hotelling.prob'><p>Calculate probabilities for distance values and given parameters using Hotelling T2 distribution</p></a></li>
<li><a href='#imshow'><p>show image data as an image</p></a></li>
<li><a href='#ipls'><p>Variable selection with interval PLS</p></a></li>
<li><a href='#ipls.backward'><p>Runs the backward iPLS algorithm</p></a></li>
<li><a href='#ipls.forward'><p>Runs the forward iPLS algorithm</p></a></li>
<li><a href='#jm.crit'><p>Calculate critical limits for distance values using Jackson-Mudholkar approach</p></a></li>
<li><a href='#jm.prob'><p>Calculate probabilities for distance values and given parameters using Hotelling T2 distribution</p></a></li>
<li><a href='#ldecomp'><p>Class for storing and visualising linear decomposition of dataset (X = TP' + E)</p></a></li>
<li><a href='#ldecomp.getDistances'><p>Compute score and residual distances</p></a></li>
<li><a href='#ldecomp.getLimitsCoordinates'><p>Compute coordinates of lines or curves with critical limits</p></a></li>
<li><a href='#ldecomp.getLimParams'><p>Compute parameters for critical limits based on calibration results</p></a></li>
<li><a href='#ldecomp.getQLimits'><p>Compute critical limits for orthogonal distances (Q)</p></a></li>
<li><a href='#ldecomp.getT2Limits'><p>Compute critical limits for score distances (T2)</p></a></li>
<li><a href='#ldecomp.getVariances'><p>Compute explained variance</p></a></li>
<li><a href='#ldecomp.plotResiduals'><p>Residuals distance plot for a set of ldecomp objects</p></a></li>
<li><a href='#mcr'><p>General class for Multivariate Curve Resolution model</p></a></li>
<li><a href='#mcrals'><p>Multivariate curve resolution using Alternating Least Squares</p></a></li>
<li><a href='#mcrals.cal'><p>Identifies pure variables</p></a></li>
<li><a href='#mcrals.fcnnls'><p>Fast combinatorial non-negative least squares</p></a></li>
<li><a href='#mcrals.nnls'><p>Non-negative least squares</p></a></li>
<li><a href='#mcrals.ols'><p>Ordinary least squares</p></a></li>
<li><a href='#mcrpure'><p>Multivariate curve resolution based on pure variables</p></a></li>
<li><a href='#mda.cbind'><p>A wrapper for cbind() method with proper set of attributes</p></a></li>
<li><a href='#mda.data2im'><p>Convert data matrix to an image</p></a></li>
<li><a href='#mda.df2mat'><p>Convert data frame to a matrix</p></a></li>
<li><a href='#mda.exclcols'><p>Exclude/hide columns in a dataset</p></a></li>
<li><a href='#mda.exclrows'><p>Exclude/hide rows in a dataset</p></a></li>
<li><a href='#mda.getattr'><p>Get data attributes</p></a></li>
<li><a href='#mda.getexclind'><p>Get indices of excluded rows or columns</p></a></li>
<li><a href='#mda.im2data'><p>Convert image to data matrix</p></a></li>
<li><a href='#mda.inclcols'><p>Include/unhide the excluded columns</p></a></li>
<li><a href='#mda.inclrows'><p>include/unhide the excluded rows</p></a></li>
<li><a href='#mda.purge'><p>Removes excluded (hidden) rows and colmns from data</p></a></li>
<li><a href='#mda.purgeCols'><p>Removes excluded (hidden) colmns from data</p></a></li>
<li><a href='#mda.purgeRows'><p>Removes excluded (hidden) rows from data</p></a></li>
<li><a href='#mda.rbind'><p>A wrapper for rbind() method with proper set of attributes</p></a></li>
<li><a href='#mda.setattr'><p>Set data attributes</p></a></li>
<li><a href='#mda.setimbg'><p>Remove background pixels from image data</p></a></li>
<li><a href='#mda.show'><p>Wrapper for show() method</p></a></li>
<li><a href='#mda.subset'><p>A wrapper for subset() method with proper set of attributed</p></a></li>
<li><a href='#mda.t'><p>A wrapper for t() method with proper set of attributes</p></a></li>
<li><a href='#mdaplot'><p>Plotting function for a single set of objects</p></a></li>
<li><a href='#mdaplot.areColors'><p>Check color values</p></a></li>
<li><a href='#mdaplot.formatValues'><p>Format vector with numeric values</p></a></li>
<li><a href='#mdaplot.getColors'><p>Color values for plot elements</p></a></li>
<li><a href='#mdaplot.getXAxisLim'><p>Calculate limits for x-axis.</p></a></li>
<li><a href='#mdaplot.getXTickLabels'><p>Prepare xticklabels for plot</p></a></li>
<li><a href='#mdaplot.getXTicks'><p>Prepare xticks for plot</p></a></li>
<li><a href='#mdaplot.getYAxisLim'><p>Calculate limits for y-axis.</p></a></li>
<li><a href='#mdaplot.getYTickLabels'><p>Prepare yticklabels for plot</p></a></li>
<li><a href='#mdaplot.getYTicks'><p>Prepare yticks for plot</p></a></li>
<li><a href='#mdaplot.plotAxes'><p>Create axes plane</p></a></li>
<li><a href='#mdaplot.prepareColors'><p>Prepare colors based on palette and opacity value</p></a></li>
<li><a href='#mdaplot.showColorbar'><p>Plot colorbar</p></a></li>
<li><a href='#mdaplot.showLines'><p>Plot lines</p></a></li>
<li><a href='#mdaplotg'><p>Plotting function for several plot series</p></a></li>
<li><a href='#mdaplotg.getLegend'><p>Create and return vector with legend values</p></a></li>
<li><a href='#mdaplotg.getXLim'><p>Compute x-axis limits for mdaplotg</p></a></li>
<li><a href='#mdaplotg.getYLim'><p>Compute y-axis limits for mdaplotg</p></a></li>
<li><a href='#mdaplotg.prepareData'><p>Prepare data for mdaplotg</p></a></li>
<li><a href='#mdaplotg.processParam'><p>Check mdaplotg parameters and replicate them if necessary</p></a></li>
<li><a href='#mdaplotg.showLegend'><p>Show legend for mdaplotg</p></a></li>
<li><a href='#mdaplotyy'><p>Create line plot with double y-axis</p></a></li>
<li><a href='#mdatools'>
<p>Package for Multivariate Data Analysis (Chemometrics)</p></a></li>
<li><a href='#pca'><p>Principal Component Analysis</p></a></li>
<li><a href='#pca.cal'><p>PCA model calibration</p></a></li>
<li><a href='#pca.getB'><p>Low-dimensional approximation of data matrix X</p></a></li>
<li><a href='#pca.mvreplace'><p>Replace missing values in data</p></a></li>
<li><a href='#pca.nipals'><p>NIPALS based PCA algorithm</p></a></li>
<li><a href='#pca.run'><p>Runs one of the selected PCA methods</p></a></li>
<li><a href='#pca.svd'><p>Singular Values Decomposition based PCA algorithm</p></a></li>
<li><a href='#pcares'><p>Results of PCA decomposition</p></a></li>
<li><a href='#pellets'>
<p>Image data</p></a></li>
<li><a href='#people'>
<p>People data</p></a></li>
<li><a href='#pinv'><p>Pseudo-inverse matrix</p></a></li>
<li><a href='#plot.classres'><p>Plot function for classification results</p></a></li>
<li><a href='#plot.ipls'><p>Overview plot for iPLS results</p></a></li>
<li><a href='#plot.mcr'><p>Plot summary for MCR model</p></a></li>
<li><a href='#plot.pca'><p>Model overview plot for PCA</p></a></li>
<li><a href='#plot.pcares'><p>Plot method for PCA results object</p></a></li>
<li><a href='#plot.pls'><p>Model overview plot for PLS</p></a></li>
<li><a href='#plot.plsda'><p>Model overview plot for PLS-DA</p></a></li>
<li><a href='#plot.plsdares'><p>Overview plot for PLS-DA results</p></a></li>
<li><a href='#plot.plsres'><p>Overview plot for PLS results</p></a></li>
<li><a href='#plot.randtest'><p>Plot for randomization test results</p></a></li>
<li><a href='#plot.regcoeffs'><p>Regression coefficients plot</p></a></li>
<li><a href='#plot.regres'><p>Plot method for regression results</p></a></li>
<li><a href='#plot.simca'><p>Model overview plot for SIMCA</p></a></li>
<li><a href='#plot.simcam'><p>Model overview plot for SIMCAM</p></a></li>
<li><a href='#plot.simcamres'><p>Model overview plot for SIMCAM results</p></a></li>
<li><a href='#plotBars'><p>Show plot series as bars</p></a></li>
<li><a href='#plotBiplot'><p>Biplot</p></a></li>
<li><a href='#plotBiplot.pca'><p>PCA biplot</p></a></li>
<li><a href='#plotConfidenceEllipse'><p>Add confidence ellipse for groups of points on scatter plot</p></a></li>
<li><a href='#plotContributions'><p>Plot resolved contributions</p></a></li>
<li><a href='#plotContributions.mcr'><p>Show plot with resolved contributions</p></a></li>
<li><a href='#plotConvexHull'><p>Add convex hull for groups of points on scatter plot</p></a></li>
<li><a href='#plotCooman'><p>Cooman's plot</p></a></li>
<li><a href='#plotCooman.simcam'><p>Cooman's plot for SIMCAM model</p></a></li>
<li><a href='#plotCooman.simcamres'><p>Cooman's plot for SIMCAM results</p></a></li>
<li><a href='#plotCorr'><p>Correlation plot</p></a></li>
<li><a href='#plotCorr.randtest'><p>Correlation plot for randomization test results</p></a></li>
<li><a href='#plotCumVariance'><p>Variance plot</p></a></li>
<li><a href='#plotCumVariance.ldecomp'><p>Cumulative explained variance plot</p></a></li>
<li><a href='#plotCumVariance.mcr'><p>Show plot with cumulative explained variance</p></a></li>
<li><a href='#plotCumVariance.pca'><p>Cumulative explained variance plot for PCA model</p></a></li>
<li><a href='#plotDensity'><p>Show plot series as density plot (using hex binning)</p></a></li>
<li><a href='#plotDiscriminationPower'><p>Discrimination power plot</p></a></li>
<li><a href='#plotDiscriminationPower.simcam'><p>Discrimination power plot for SIMCAM model</p></a></li>
<li><a href='#plotDistDoF'><p>Degrees of freedom plot for both distances</p></a></li>
<li><a href='#plotErrorbars'><p>Show plot series as error bars</p></a></li>
<li><a href='#plotExtreme'><p>Shows extreme plot for SIMCA model</p></a></li>
<li><a href='#plotExtreme.pca'><p>Extreme plot</p></a></li>
<li><a href='#plotHist'><p>Statistic histogram</p></a></li>
<li><a href='#plotHist.randtest'><p>Histogram plot for randomization test results</p></a></li>
<li><a href='#plotHotellingEllipse'><p>Hotelling ellipse</p></a></li>
<li><a href='#plotLines'><p>Show plot series as set of lines</p></a></li>
<li><a href='#plotLoadings'><p>Loadings plot</p></a></li>
<li><a href='#plotLoadings.pca'><p>Loadings plot for PCA model</p></a></li>
<li><a href='#plotMisclassified'><p>Misclassification ratio plot</p></a></li>
<li><a href='#plotMisclassified.classmodel'><p>Misclassified ratio plot for classification model</p></a></li>
<li><a href='#plotMisclassified.classres'><p>Misclassified ratio plot for classification results</p></a></li>
<li><a href='#plotModelDistance'><p>Model distance plot</p></a></li>
<li><a href='#plotModelDistance.simcam'><p>Model distance plot for SIMCAM model</p></a></li>
<li><a href='#plotModellingPower'><p>Modelling power plot</p></a></li>
<li><a href='#plotPerformance'><p>Classification performance plot</p></a></li>
<li><a href='#plotPerformance.classmodel'><p>Performance plot for classification model</p></a></li>
<li><a href='#plotPerformance.classres'><p>Performance plot for classification results</p></a></li>
<li><a href='#plotPointsShape'><p>Add confidence ellipse or convex hull for group of points</p></a></li>
<li><a href='#plotPredictions'><p>Predictions plot</p></a></li>
<li><a href='#plotPredictions.classmodel'><p>Predictions plot for classification model</p></a></li>
<li><a href='#plotPredictions.classres'><p>Prediction plot for classification results</p></a></li>
<li><a href='#plotPredictions.regmodel'><p>Predictions plot for regression model</p></a></li>
<li><a href='#plotPredictions.regres'><p>Predictions plot for regression results</p></a></li>
<li><a href='#plotPredictions.simcam'><p>Predictions plot for SIMCAM model</p></a></li>
<li><a href='#plotPredictions.simcamres'><p>Prediction plot for SIMCAM results</p></a></li>
<li><a href='#plotProbabilities'><p>Plot for class belonging probability</p></a></li>
<li><a href='#plotProbabilities.classres'><p>Plot for class belonging probability</p></a></li>
<li><a href='#plotPurity'><p>Plot purity values</p></a></li>
<li><a href='#plotPurity.mcrpure'><p>Purity values plot</p></a></li>
<li><a href='#plotPuritySpectra'><p>Plot purity spectra</p></a></li>
<li><a href='#plotPuritySpectra.mcrpure'><p>Purity spectra plot</p></a></li>
<li><a href='#plotQDoF'><p>Degrees of freedom plot for orthogonal distance (Nh)</p></a></li>
<li><a href='#plotRegcoeffs'><p>Regression coefficients plot</p></a></li>
<li><a href='#plotRegcoeffs.regmodel'><p>Regression coefficient plot for regression model</p></a></li>
<li><a href='#plotRegressionLine'><p>Add regression line for data points</p></a></li>
<li><a href='#plotResiduals'><p>Residuals plot</p></a></li>
<li><a href='#plotResiduals.ldecomp'><p>Residual distance plot</p></a></li>
<li><a href='#plotResiduals.pca'><p>Residuals distance plot for PCA model</p></a></li>
<li><a href='#plotResiduals.regres'><p>Residuals plot for regression results</p></a></li>
<li><a href='#plotRMSE'><p>RMSE plot</p></a></li>
<li><a href='#plotRMSE.ipls'><p>RMSE development plot</p></a></li>
<li><a href='#plotRMSE.regmodel'><p>RMSE plot for regression model</p></a></li>
<li><a href='#plotRMSE.regres'><p>RMSE plot for regression results</p></a></li>
<li><a href='#plotRMSERatio'><p>Plot for ratio RMSEC/RMSECV vs RMSECV</p></a></li>
<li><a href='#plotRMSERatio.regmodel'><p>RMSECV/RMSEC ratio plot for regression model</p></a></li>
<li><a href='#plotScatter'><p>Show plot series as set of points</p></a></li>
<li><a href='#plotScores'><p>Scores plot</p></a></li>
<li><a href='#plotScores.ldecomp'><p>Scores plot</p></a></li>
<li><a href='#plotScores.pca'><p>Scores plot for PCA model</p></a></li>
<li><a href='#plotSelection'><p>Selected intervals plot</p></a></li>
<li><a href='#plotSelection.ipls'><p>iPLS performance plot</p></a></li>
<li><a href='#plotSelectivityRatio'><p>Selectivity ratio plot</p></a></li>
<li><a href='#plotSelectivityRatio.pls'><p>Selectivity ratio plot for PLS model</p></a></li>
<li><a href='#plotSensitivity'><p>Sensitivity plot</p></a></li>
<li><a href='#plotSensitivity.classmodel'><p>Sensitivity plot for classification model</p></a></li>
<li><a href='#plotSensitivity.classres'><p>Sensitivity plot for classification results</p></a></li>
<li><a href='#plotseries'><p>Create plot series object based on data, plot type and parameters</p></a></li>
<li><a href='#plotSpecificity'><p>Specificity plot</p></a></li>
<li><a href='#plotSpecificity.classmodel'><p>Specificity plot for classification model</p></a></li>
<li><a href='#plotSpecificity.classres'><p>Specificity plot for classification results</p></a></li>
<li><a href='#plotSpectra'><p>Plot resolved spectra</p></a></li>
<li><a href='#plotSpectra.mcr'><p>Show plot with resolved spectra</p></a></li>
<li><a href='#plotT2DoF'><p>Degrees of freedom plot for score distance (Nh)</p></a></li>
<li><a href='#plotVariance'><p>Variance plot</p></a></li>
<li><a href='#plotVariance.ldecomp'><p>Explained variance plot</p></a></li>
<li><a href='#plotVariance.mcr'><p>Show plot with explained variance</p></a></li>
<li><a href='#plotVariance.pca'><p>Explained variance plot for PCA model</p></a></li>
<li><a href='#plotVariance.pls'><p>Variance plot for PLS</p></a></li>
<li><a href='#plotVariance.plsres'><p>Explained X variance plot for PLS results</p></a></li>
<li><a href='#plotVIPScores'><p>VIP scores plot</p></a></li>
<li><a href='#plotVIPScores.pls'><p>VIP scores plot for PLS model</p></a></li>
<li><a href='#plotWeights'><p>Plot for PLS weights</p></a></li>
<li><a href='#plotWeights.pls'><p>X loadings plot for PLS</p></a></li>
<li><a href='#plotXCumVariance'><p>X cumulative variance plot</p></a></li>
<li><a href='#plotXCumVariance.pls'><p>Cumulative explained X variance plot for PLS</p></a></li>
<li><a href='#plotXCumVariance.plsres'><p>Explained cumulative X variance plot for PLS results</p></a></li>
<li><a href='#plotXLoadings'><p>X loadings plot</p></a></li>
<li><a href='#plotXLoadings.pls'><p>X loadings plot for PLS</p></a></li>
<li><a href='#plotXResiduals'><p>X residuals plot</p></a></li>
<li><a href='#plotXResiduals.pls'><p>Residual distance plot for decomposition of X data</p></a></li>
<li><a href='#plotXResiduals.plsres'><p>X residuals plot for PLS results</p></a></li>
<li><a href='#plotXScores'><p>X scores plot</p></a></li>
<li><a href='#plotXScores.pls'><p>X scores plot for PLS</p></a></li>
<li><a href='#plotXScores.plsres'><p>X scores plot for PLS results</p></a></li>
<li><a href='#plotXVariance'><p>X variance plot</p></a></li>
<li><a href='#plotXVariance.pls'><p>Explained X variance plot for PLS</p></a></li>
<li><a href='#plotXVariance.plsres'><p>Explained X variance plot for PLS results</p></a></li>
<li><a href='#plotXYLoadings'><p>X loadings plot</p></a></li>
<li><a href='#plotXYLoadings.pls'><p>XY loadings plot for PLS</p></a></li>
<li><a href='#plotXYResiduals'><p>Plot for XY-residuals</p></a></li>
<li><a href='#plotXYResiduals.pls'><p>Residual XY-distance plot</p></a></li>
<li><a href='#plotXYResiduals.plsres'><p>Residual distance plot</p></a></li>
<li><a href='#plotXYScores'><p>XY scores plot</p></a></li>
<li><a href='#plotXYScores.pls'><p>XY scores plot for PLS</p></a></li>
<li><a href='#plotXYScores.plsres'><p>XY scores plot for PLS results</p></a></li>
<li><a href='#plotYCumVariance'><p>Y cumulative variance plot</p></a></li>
<li><a href='#plotYCumVariance.pls'><p>Cumulative explained Y variance plot for PLS</p></a></li>
<li><a href='#plotYCumVariance.plsres'><p>Explained cumulative Y variance plot for PLS results</p></a></li>
<li><a href='#plotYResiduals'><p>Y residuals plot</p></a></li>
<li><a href='#plotYResiduals.plsres'><p>Y residuals plot for PLS results</p></a></li>
<li><a href='#plotYResiduals.regmodel'><p>Y residuals plot for regression model</p></a></li>
<li><a href='#plotYVariance'><p>Y variance plot</p></a></li>
<li><a href='#plotYVariance.pls'><p>Explained Y variance plot for PLS</p></a></li>
<li><a href='#plotYVariance.plsres'><p>Explained Y variance plot for PLS results</p></a></li>
<li><a href='#pls'><p>Partial Least Squares regression</p></a></li>
<li><a href='#pls.cal'><p>PLS model calibration</p></a></li>
<li><a href='#pls.getLimitsCoordinates'><p>Compute coordinates of lines or curves with critical limits</p></a></li>
<li><a href='#pls.getpredictions'><p>Compute predictions for response values</p></a></li>
<li><a href='#pls.getxdecomp'><p>Compute object with decomposition of x-values</p></a></li>
<li><a href='#pls.getxscores'><p>Compute matrix with X-scores</p></a></li>
<li><a href='#pls.getydecomp'><p>Compute object with decomposition of y-values</p></a></li>
<li><a href='#pls.getyscores'><p>Compute and orthogonalize matrix with Y-scores</p></a></li>
<li><a href='#pls.getZLimits'><p>Compute critical limits for orthogonal distances (Q)</p></a></li>
<li><a href='#pls.run'><p>Runs selected PLS algorithm</p></a></li>
<li><a href='#pls.simpls'><p>SIMPLS algorithm</p></a></li>
<li><a href='#pls.simplsold'><p>SIMPLS algorithm (old implementation)</p></a></li>
<li><a href='#plsda'><p>Partial Least Squares Discriminant Analysis</p></a></li>
<li><a href='#plsdares'><p>PLS-DA results</p></a></li>
<li><a href='#plsres'><p>PLS results</p></a></li>
<li><a href='#predict.mcrals'><p>MCR ALS predictions</p></a></li>
<li><a href='#predict.mcrpure'><p>MCR predictions</p></a></li>
<li><a href='#predict.pca'><p>PCA predictions</p></a></li>
<li><a href='#predict.pls'><p>PLS predictions</p></a></li>
<li><a href='#predict.plsda'><p>PLS-DA predictions</p></a></li>
<li><a href='#predict.simca'><p>SIMCA predictions</p></a></li>
<li><a href='#predict.simcam'><p>SIMCA multiple classes predictions</p></a></li>
<li><a href='#prep'><p>Class for preprocessing object</p></a></li>
<li><a href='#prep.alsbasecorr'><p>Baseline correction using asymetric least squares</p></a></li>
<li><a href='#prep.autoscale'><p>Autoscale values</p></a></li>
<li><a href='#prep.generic'><p>Generic function for preprocessing</p></a></li>
<li><a href='#prep.list'><p>Shows information about all implemented preprocessing methods.</p></a></li>
<li><a href='#prep.msc'><p>Multiplicative Scatter Correction transformation</p></a></li>
<li><a href='#prep.norm'><p>Normalization</p></a></li>
<li><a href='#prep.ref2km'><p>Kubelka-Munk transformation</p></a></li>
<li><a href='#prep.savgol'><p>Savytzky-Golay filter</p></a></li>
<li><a href='#prep.snv'><p>Standard Normal Variate transformation</p></a></li>
<li><a href='#prep.transform'><p>Transformation</p></a></li>
<li><a href='#prep.varsel'><p>Variable selection</p></a></li>
<li><a href='#preparePlotData'><p>Take dataset and prepare them for plot</p></a></li>
<li><a href='#prepCalData'><p>Prepares calibration data</p></a></li>
<li><a href='#print.classres'><p>Print information about classification result object</p></a></li>
<li><a href='#print.ipls'><p>Print method for iPLS</p></a></li>
<li><a href='#print.ldecomp'><p>Print method for linear decomposition</p></a></li>
<li><a href='#print.mcrals'><p>Print method for mcrpure object</p></a></li>
<li><a href='#print.mcrpure'><p>Print method for mcrpure object</p></a></li>
<li><a href='#print.pca'><p>Print method for PCA model object</p></a></li>
<li><a href='#print.pcares'><p>Print method for PCA results object</p></a></li>
<li><a href='#print.pls'><p>Print method for PLS model object</p></a></li>
<li><a href='#print.plsda'><p>Print method for PLS-DA model object</p></a></li>
<li><a href='#print.plsdares'><p>Print method for PLS-DA results object</p></a></li>
<li><a href='#print.plsres'><p>print method for PLS results object</p></a></li>
<li><a href='#print.randtest'><p>Print method for randtest object</p></a></li>
<li><a href='#print.regcoeffs'><p>print method for regression coefficients class</p></a></li>
<li><a href='#print.regmodel'><p>Print method for PLS model object</p></a></li>
<li><a href='#print.regres'><p>print method for regression results object</p></a></li>
<li><a href='#print.simca'><p>Print method for SIMCA model object</p></a></li>
<li><a href='#print.simcam'><p>Print method for SIMCAM model object</p></a></li>
<li><a href='#print.simcamres'><p>Print method for SIMCAM results object</p></a></li>
<li><a href='#print.simcares'><p>Print method for SIMCA results object</p></a></li>
<li><a href='#randtest'><p>Randomization test for PLS regression</p></a></li>
<li><a href='#regcoeffs'><p>Regression coefficients</p></a></li>
<li><a href='#regcoeffs.getStats'><p>Distribution statistics for regression coeffificents</p></a></li>
<li><a href='#regres'><p>Regression results</p></a></li>
<li><a href='#regres.bias'><p>Prediction bias</p></a></li>
<li><a href='#regres.err'><p>Error of prediction</p></a></li>
<li><a href='#regres.r2'><p>Determination coefficient</p></a></li>
<li><a href='#regres.rmse'><p>RMSE</p></a></li>
<li><a href='#regres.slope'><p>Slope</p></a></li>
<li><a href='#regress.addattrs'><p>Add names and attributes to matrix with statistics</p></a></li>
<li><a href='#repmat'><p>Replicate matric x</p></a></li>
<li><a href='#selectCompNum'><p>Select optimal number of components for a model</p></a></li>
<li><a href='#selectCompNum.pca'><p>Select optimal number of components for PCA model</p></a></li>
<li><a href='#selectCompNum.pls'><p>Select optimal number of components for PLS model</p></a></li>
<li><a href='#selratio'><p>Selectivity ratio calculation</p></a></li>
<li><a href='#setDistanceLimits'><p>Set residual distance limits</p></a></li>
<li><a href='#setDistanceLimits.pca'><p>Compute and set statistical limits for Q and T2 residual distances.</p></a></li>
<li><a href='#setDistanceLimits.pls'><p>Compute and set statistical limits for residual distances.</p></a></li>
<li><a href='#showDistanceLimits'><p>Show residual distance limits</p></a></li>
<li><a href='#showLabels'><p>Show labels on plot</p></a></li>
<li><a href='#showPredictions'><p>Predictions</p></a></li>
<li><a href='#showPredictions.classres'><p>Show predicted class values</p></a></li>
<li><a href='#simca'><p>SIMCA one-class classification</p></a></li>
<li><a href='#simcam'><p>SIMCA multiclass classification</p></a></li>
<li><a href='#simcam.getPerformanceStats'><p>Performance statistics for SIMCAM model</p></a></li>
<li><a href='#simcamres'><p>Results of SIMCA multiclass classification</p></a></li>
<li><a href='#simcares'><p>Results of SIMCA one-class classification</p></a></li>
<li><a href='#simdata'>
<p>Spectral data of polyaromatic hydrocarbons mixing</p></a></li>
<li><a href='#splitExcludedData'><p>Split the excluded part of data</p></a></li>
<li><a href='#splitPlotData'><p>Split dataset to x and y values depending on plot type</p></a></li>
<li><a href='#summary.classres'><p>Summary statistics about classification result object</p></a></li>
<li><a href='#summary.ipls'><p>Summary for iPLS results</p></a></li>
<li><a href='#summary.ldecomp'><p>Summary statistics for linear decomposition</p></a></li>
<li><a href='#summary.mcrals'><p>Summary method for mcrals object</p></a></li>
<li><a href='#summary.mcrpure'><p>Summary method for mcrpure object</p></a></li>
<li><a href='#summary.pca'><p>Summary method for PCA model object</p></a></li>
<li><a href='#summary.pcares'><p>Summary method for PCA results object</p></a></li>
<li><a href='#summary.pls'><p>Summary method for PLS model object</p></a></li>
<li><a href='#summary.plsda'><p>Summary method for PLS-DA model object</p></a></li>
<li><a href='#summary.plsdares'><p>Summary method for PLS-DA results object</p></a></li>
<li><a href='#summary.plsres'><p>summary method for PLS results object</p></a></li>
<li><a href='#summary.randtest'><p>Summary method for randtest object</p></a></li>
<li><a href='#summary.regcoeffs'><p>Summary method for regcoeffs object</p></a></li>
<li><a href='#summary.regmodel'><p>Summary method for regression model object</p></a></li>
<li><a href='#summary.regres'><p>summary method for regression results object</p></a></li>
<li><a href='#summary.simca'><p>Summary method for SIMCA model object</p></a></li>
<li><a href='#summary.simcam'><p>Summary method for SIMCAM model object</p></a></li>
<li><a href='#summary.simcamres'><p>Summary method for SIMCAM results object</p></a></li>
<li><a href='#summary.simcares'><p>Summary method for SIMCA results object</p></a></li>
<li><a href='#unmix.mcrpure'><p>Unmix spectral data using pure variables estimated before</p></a></li>
<li><a href='#vipscores'><p>VIP scores for PLS model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.14.1</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Data Analysis for Chemometrics</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-12</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sergey Kucheryavskiy &lt;svkucheryavski@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Projection based methods for preprocessing, exploring and analysis of multivariate data used in chemometrics. S. Kucheryavskiy (2020) &lt;<a href="https://doi.org/10.1016%2Fj.chemolab.2020.103937">doi:10.1016/j.chemolab.2020.103937</a>&gt;.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, graphics, grDevices, stats, Matrix</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, pcv</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-12 14:46:18 UTC; svkucheryavski</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mda.tools">https://mda.tools</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/svkucheryavski/mdatools/issues">https://github.com/svkucheryavski/mdatools/issues</a></td>
</tr>
<tr>
<td>Author:</td>
<td>Sergey Kucheryavskiy
    <a href="https://orcid.org/0000-0002-3145-7244"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-12 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.matrix.classres'>as.matrix method for classification results</h2><span id='topic+as.matrix.classres'></span>

<h3>Description</h3>

<p>Generic <code>as.matrix</code> function for classification results. Returns matrix with performance
values for specific class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
as.matrix(x, ncomp = NULL, nc = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.classres_+3A_x">x</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="as.matrix.classres_+3A_ncomp">ncomp</code></td>
<td>
<p>model complexity (number of components) to show the parameters for.</p>
</td></tr>
<tr><td><code id="as.matrix.classres_+3A_nc">nc</code></td>
<td>
<p>if there are several classes, which class to show the parameters for.</p>
</td></tr>
<tr><td><code id="as.matrix.classres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='as.matrix.ldecomp'>as.matrix method for ldecomp object</h2><span id='topic+as.matrix.ldecomp'></span>

<h3>Description</h3>

<p>Generic <code>as.matrix</code> function for linear decomposition. Returns a matrix with information
about the decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ldecomp'
as.matrix(x, ncomp = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.ldecomp_+3A_x">x</code></td>
<td>
<p>object of class <code>ldecomp</code></p>
</td></tr>
<tr><td><code id="as.matrix.ldecomp_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to get the result for (if NULL will return for each available)</p>
</td></tr>
<tr><td><code id="as.matrix.ldecomp_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='as.matrix.plsdares'>as.matrix method for PLS-DA results</h2><span id='topic+as.matrix.plsdares'></span>

<h3>Description</h3>

<p>Returns a matrix with model performance statistics for PLS-DA results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsdares'
as.matrix(x, ncomp = NULL, nc = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.plsdares_+3A_x">x</code></td>
<td>
<p>PLS-DA results (object of class <code>plsdares</code>)</p>
</td></tr>
<tr><td><code id="as.matrix.plsdares_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to calculate the statistics for (if NULL gets for all components)</p>
</td></tr>
<tr><td><code id="as.matrix.plsdares_+3A_nc">nc</code></td>
<td>
<p>for which class to calculate the statistics for</p>
</td></tr>
<tr><td><code id="as.matrix.plsdares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='as.matrix.plsres'>as.matrix method for PLS results</h2><span id='topic+as.matrix.plsres'></span>

<h3>Description</h3>

<p>Returns a matrix with model performance statistics for PLS results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
as.matrix(x, ncomp = NULL, ny = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.plsres_+3A_x">x</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="as.matrix.plsres_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to calculate the statistics for</p>
</td></tr>
<tr><td><code id="as.matrix.plsres_+3A_ny">ny</code></td>
<td>
<p>for which response variable calculate the statistics for</p>
</td></tr>
<tr><td><code id="as.matrix.plsres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='as.matrix.regcoeffs'>as.matrix method for regression coefficients class</h2><span id='topic+as.matrix.regcoeffs'></span>

<h3>Description</h3>

<p>returns matrix with regression coeffocoents for given response number and amount of components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regcoeffs'
as.matrix(x, ncomp = 1, ny = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.regcoeffs_+3A_x">x</code></td>
<td>
<p>regression coefficients object (class <code>regcoeffs</code>)</p>
</td></tr>
<tr><td><code id="as.matrix.regcoeffs_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to return the coefficients for</p>
</td></tr>
<tr><td><code id="as.matrix.regcoeffs_+3A_ny">ny</code></td>
<td>
<p>number of response variable to return the coefficients for</p>
</td></tr>
<tr><td><code id="as.matrix.regcoeffs_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='as.matrix.regres'>as.matrix method for regression results</h2><span id='topic+as.matrix.regres'></span>

<h3>Description</h3>

<p>Returns a matrix with model performance statistics for regression results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regres'
as.matrix(x, ncomp = NULL, ny = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.regres_+3A_x">x</code></td>
<td>
<p>regression results (object of class <code>regres</code>)</p>
</td></tr>
<tr><td><code id="as.matrix.regres_+3A_ncomp">ncomp</code></td>
<td>
<p>model complexity (number of components) to calculate the statistics for (can be a vector)</p>
</td></tr>
<tr><td><code id="as.matrix.regres_+3A_ny">ny</code></td>
<td>
<p>for which response variable calculate the statistics for</p>
</td></tr>
<tr><td><code id="as.matrix.regres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='as.matrix.simcamres'>as.matrix method for SIMCAM results</h2><span id='topic+as.matrix.simcamres'></span>

<h3>Description</h3>

<p>Generic <code>as.matrix</code> function for SIMCAM results. Returns matrix with performance
values for specific class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcamres'
as.matrix(x, nc = seq_len(x$nclasses), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.simcamres_+3A_x">x</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="as.matrix.simcamres_+3A_nc">nc</code></td>
<td>
<p>vector with classes to use.</p>
</td></tr>
<tr><td><code id="as.matrix.simcamres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='as.matrix.simcares'>as.matrix method for SIMCA classification results</h2><span id='topic+as.matrix.simcares'></span>

<h3>Description</h3>

<p>Generic <code>as.matrix</code> function for classification results. Returns matrix with performance
values for specific class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcares'
as.matrix(x, ncomp = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.simcares_+3A_x">x</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="as.matrix.simcares_+3A_ncomp">ncomp</code></td>
<td>
<p>model complexity (number of components) to show the parameters for.</p>
</td></tr>
<tr><td><code id="as.matrix.simcares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='capitalize'>Capitalize text or vector with text values</h2><span id='topic+capitalize'></span>

<h3>Description</h3>

<p>Capitalize text or vector with text values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capitalize(str)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="capitalize_+3A_str">str</code></td>
<td>
<p>text of vector with text values</p>
</td></tr>
</table>

<hr>
<h2 id='carbs'>
Raman spectra of carbonhydrates
</h2><span id='topic+carbs'></span>

<h3>Description</h3>

<p>The dataset consists of Raman spectra of fructose, lactose, and ribose as well as spectra of their
mixtures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdata)</code></pre>


<h3>Format</h3>

<p>The data is a list (<code>carbs</code>) with the following fields:
</p>

<table>
<tr>
 <td style="text-align: right;">
    <code>$D</code> </td><td style="text-align: left;"> a matrix (21x1401) with spectral values for the mixtures. </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>$S</code> </td><td style="text-align: left;"> a matrix (1401x3) with spectral values for the pure components. </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>$C</code> </td><td style="text-align: left;"> a matrix (21x3) with concentration of the pure components. </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>The dataset consists of Raman spectra of fructose, lactose, and ribose as well as spectra of their
mixtures. The original spectra were downloaded from publicly available SPECARB library [1], created
by S.B. Engelsen. The specta were truncated to the range from 200 to 1600 cm-1.
</p>
<p>The spectra of mixtures were created by linear combinations of the original spectra:
</p>
<p>D = CS' + E
</p>
<p>Concentrations of the components, C, follow a simplex lattice design with four levels. Some noise calculated as a random number uniformly distributed between 0% and 3% of maximum initial intensity (E) was added to each spectrum of the dataset, D, individually.
</p>


<h3>References</h3>

<p>1. Engelsen S.B., Database on Raman spectra of carbohydrates. Available at: http://www.models.life.ku.dk/~specarb/specarb.html [visited 31.05.2020]
</p>

<hr>
<h2 id='categorize'>Categorize PCA results</h2><span id='topic+categorize'></span>

<h3>Description</h3>

<p>Categorize PCA results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>categorize(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="categorize_+3A_obj">obj</code></td>
<td>
<p>object with PCA model</p>
</td></tr>
<tr><td><code id="categorize_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='categorize.pca'>Categorize PCA results based on orthogonal and score distances.</h2><span id='topic+categorize.pca'></span>

<h3>Description</h3>

<p>The method compares score and orthogonal distances of PCA results from <code>res</code> with
critical limits computed for the PCA model and categorizes the corresponding objects as
&quot;regular&quot;, &quot;extreme&quot; or &quot;outlier&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
categorize(obj, res = obj$res$cal, ncomp = obj$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="categorize.pca_+3A_obj">obj</code></td>
<td>
<p>object with PCA model</p>
</td></tr>
<tr><td><code id="categorize.pca_+3A_res">res</code></td>
<td>
<p>object with PCA results</p>
</td></tr>
<tr><td><code id="categorize.pca_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to use for the categorization</p>
</td></tr>
<tr><td><code id="categorize.pca_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method does not categorize hidden values if any.
</p>


<h3>Value</h3>

<p>vector (factor) with results of categorization.
</p>

<hr>
<h2 id='categorize.pls'>Categorize data rows based on PLS results and critical limits for total distance.</h2><span id='topic+categorize.pls'></span>

<h3>Description</h3>

<p>The method uses full distance for decomposition of X-data and squared Y-residuals of PLS results
from <code>res</code> with critical limits computed for the PLS model and categorizes the
corresponding objects as &quot;regular&quot;, &quot;extreme&quot; or &quot;outlier&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
categorize(obj, res = obj$res$cal, ncomp = obj$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="categorize.pls_+3A_obj">obj</code></td>
<td>
<p>object with PCA model</p>
</td></tr>
<tr><td><code id="categorize.pls_+3A_res">res</code></td>
<td>
<p>object with PCA results</p>
</td></tr>
<tr><td><code id="categorize.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to use for the categorization</p>
</td></tr>
<tr><td><code id="categorize.pls_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method does not categorize hidden values if any. It is based on the approach described in
[1] and works only if data driven approach is used for computing critical limits.
</p>


<h3>Value</h3>

<p>vector (factor) with results of categorization.
</p>


<h3>References</h3>

<p>1. Rodionova O. Ye., Pomerantsev A. L. Detection of Outliers in Projection-Based Modeling.
Analytical Chemistry (2020, in publish). doi: 10.1021/acs.analchem.9b04611
</p>

<hr>
<h2 id='chisq.crit'>Calculates critical limits for distance values using Chi-square distribution</h2><span id='topic+chisq.crit'></span>

<h3>Description</h3>

<p>The method is based on Chi-squared distribution with DF = 2 * (m(u)/s(u)^2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.crit(param, alpha = 0.05, gamma = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chisq.crit_+3A_param">param</code></td>
<td>
<p>matrix with distribution parameters</p>
</td></tr>
<tr><td><code id="chisq.crit_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme objects</p>
</td></tr>
<tr><td><code id="chisq.crit_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outliers</p>
</td></tr>
</table>

<hr>
<h2 id='chisq.prob'>Calculate probabilities for distance values using Chi-square distribution</h2><span id='topic+chisq.prob'></span>

<h3>Description</h3>

<p>Calculate probabilities for distance values using Chi-square distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.prob(u, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chisq.prob_+3A_u">u</code></td>
<td>
<p>vector with distances</p>
</td></tr>
<tr><td><code id="chisq.prob_+3A_param">param</code></td>
<td>
<p>vector with distribution parameters</p>
</td></tr>
</table>

<hr>
<h2 id='classify.plsda'>PLS-DA classification</h2><span id='topic+classify.plsda'></span>

<h3>Description</h3>

<p>Converts PLS predictions of y values to predictions of classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classify.plsda(model, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classify.plsda_+3A_model">model</code></td>
<td>
<p>a PLS-DA model (object of class <code>plsda</code>)</p>
</td></tr>
<tr><td><code id="classify.plsda_+3A_y">y</code></td>
<td>
<p>a matrix with predicted y values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a service function for PLS-DA class, do not use it manually.
</p>


<h3>Value</h3>

<p>Classification results (an object of class <code>classres</code>)
</p>

<hr>
<h2 id='classify.simca'>SIMCA classification</h2><span id='topic+classify.simca'></span>

<h3>Description</h3>

<p>Make classification based on calculated T2 and Q values and corresponding limits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classify.simca(obj, pca.res, c.ref = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classify.simca_+3A_obj">obj</code></td>
<td>
<p>a SIMCA model (object of class <code>simca</code>)</p>
</td></tr>
<tr><td><code id="classify.simca_+3A_pca.res">pca.res</code></td>
<td>
<p>results of projection data to PCA space</p>
</td></tr>
<tr><td><code id="classify.simca_+3A_c.ref">c.ref</code></td>
<td>
<p>vector with class reference values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a service function for SIMCA class, do not use it manually.
</p>


<h3>Value</h3>

<p>vector with predicted class values (<code>c.pred</code>)
</p>

<hr>
<h2 id='classmodel.processRefValues'>Check reference class values and convert it to a factor if necessary</h2><span id='topic+classmodel.processRefValues'></span>

<h3>Description</h3>

<p>Check reference class values and convert it to a factor if necessary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classmodel.processRefValues(c.ref, classnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classmodel.processRefValues_+3A_c.ref">c.ref</code></td>
<td>
<p>class reference values provided by user</p>
</td></tr>
<tr><td><code id="classmodel.processRefValues_+3A_classnames">classnames</code></td>
<td>
<p>text with class name in case of logical reference values</p>
</td></tr>
</table>

<hr>
<h2 id='classres'>Results of classification</h2><span id='topic+classres'></span>

<h3>Description</h3>

<p><code>classres</code> is used to store results classification for one or multiple classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classres(c.pred, c.ref = NULL, p.pred = NULL, ncomp.selected = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classres_+3A_c.pred">c.pred</code></td>
<td>
<p>matrix with predicted values (+1 or -1) for each class.</p>
</td></tr>
<tr><td><code id="classres_+3A_c.ref">c.ref</code></td>
<td>
<p>matrix with reference values for each class.</p>
</td></tr>
<tr><td><code id="classres_+3A_p.pred">p.pred</code></td>
<td>
<p>matrix with probability values for each class.</p>
</td></tr>
<tr><td><code id="classres_+3A_ncomp.selected">ncomp.selected</code></td>
<td>
<p>vector with selected number of components for each class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is no need to create a <code>classres</code> object manually, it is created automatically when
build a classification model (e.g. using <code><a href="#topic+simca">simca</a></code> or <code><a href="#topic+plsda">plsda</a></code>) or apply
the model to new data. For any classification method from <code>mdatools</code>, a class using to
represent results of classification (e.g. <code><a href="#topic+simcares">simcares</a></code>) inherits fields and methods of
<code>classres</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>c.pred</code></td>
<td>
<p>predicted class values (+1 or -1).</p>
</td></tr>
<tr><td><code>p.pred</code></td>
<td>
<p>predicted class probabilities.</p>
</td></tr>
<tr><td><code>c.ref</code></td>
<td>
<p>reference (true) class values if provided.</p>
</td></tr>
</table>
<p>The following fields are available only if reference values were provided.
</p>
<table>
<tr><td><code>tp</code></td>
<td>
<p>number of true positives.</p>
</td></tr>
<tr><td><code>tn</code></td>
<td>
<p>number of true negatives.</p>
</td></tr>
<tr><td><code>fp</code></td>
<td>
<p>nmber of false positives.</p>
</td></tr>
<tr><td><code>fn</code></td>
<td>
<p>number of false negatives.</p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p>specificity of predictions.</p>
</td></tr>
<tr><td><code>sensitivity</code></td>
<td>
<p>sensitivity of predictions.</p>
</td></tr>
<tr><td><code>misclassified</code></td>
<td>
<p>ratio of misclassified objects.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Methods <code>classres</code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+showPredictions.classres">showPredictions.classres</a></code> </td><td style="text-align: left;"> shows table with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPredictions.classres">plotPredictions.classres</a></code> </td><td style="text-align: left;"> makes plot with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSensitivity.classres">plotSensitivity.classres</a></code> </td><td style="text-align: left;"> makes sn plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSpecificity.classres">plotSpecificity.classres</a></code> </td><td style="text-align: left;"> makes specificity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotMisclassified.classres">plotMisclassified.classres</a></code> </td><td style="text-align: left;"> makes ms ratio plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPerformance.classres">plotPerformance.classres</a></code> </td><td style="text-align: left;"> makes plot with misclassified ratio, specificity
 and sensitivity values.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<hr>
<h2 id='classres.getPerformance'>Calculation of  classification performance parameters</h2><span id='topic+classres.getPerformance'></span>

<h3>Description</h3>

<p>Calculates and returns performance parameters for classification result (e.g. number of false
negatives, false positives, sn, specificity, etc.).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classres.getPerformance(c.ref, c.pred)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classres.getPerformance_+3A_c.ref">c.ref</code></td>
<td>
<p>reference class values for objects (vector with numeric or text values)</p>
</td></tr>
<tr><td><code id="classres.getPerformance_+3A_c.pred">c.pred</code></td>
<td>
<p>predicted class values for objects (array nobj x ncomponents x nclasses)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is called automatically when a classification result with reference values is
created, for example when applying a <code>plsda</code> or <code>simca</code> models.
</p>


<h3>Value</h3>

<p>Returns a list with following fields:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>$fn</code> </td><td style="text-align: left;"> number of false negatives (nclasses x ncomponents) </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>$fp</code> </td><td style="text-align: left;"> number of false positives (nclasses x ncomponents) </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>$tp</code> </td><td style="text-align: left;"> number of true positives (nclasses x ncomponents) </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>$sensitivity</code> </td><td style="text-align: left;"> sn values (nclasses x ncomponents) </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>$specificity</code> </td><td style="text-align: left;"> specificity values (nclasses x ncomponents) </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>$specificity</code> </td><td style="text-align: left;"> ms ratio values (nclasses x ncomponents) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<hr>
<h2 id='confint.regcoeffs'>Confidence intervals for regression coefficients</h2><span id='topic+confint.regcoeffs'></span>

<h3>Description</h3>

<p>returns matrix with confidence intervals for regression coeffocoents
for given response number and number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regcoeffs'
confint(object, parm = NULL, level = 0.95, ncomp = 1, ny = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.regcoeffs_+3A_object">object</code></td>
<td>
<p>regression coefficients object (class <code>regcoeffs</code>)</p>
</td></tr>
<tr><td><code id="confint.regcoeffs_+3A_parm">parm</code></td>
<td>
<p>not used, needed for compatiility with general method</p>
</td></tr>
<tr><td><code id="confint.regcoeffs_+3A_level">level</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="confint.regcoeffs_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components (one value)</p>
</td></tr>
<tr><td><code id="confint.regcoeffs_+3A_ny">ny</code></td>
<td>
<p>index of response variable (one value)</p>
</td></tr>
<tr><td><code id="confint.regcoeffs_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='constraint'>Class for MCR-ALS constraint</h2><span id='topic+constraint'></span>

<h3>Description</h3>

<p>Class for MCR-ALS constraint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constraint(name, params = NULL, method = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constraint_+3A_name">name</code></td>
<td>
<p>short text with name for the constraint</p>
</td></tr>
<tr><td><code id="constraint_+3A_params">params</code></td>
<td>
<p>a list with parameters for the constraint method (if NULL - default parameters will be used)</p>
</td></tr>
<tr><td><code id="constraint_+3A_method">method</code></td>
<td>
<p>method to call when applying the constraint, provide it only for user defined constraints</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use this class to create constraints and add them to a list for MCR-ALS curve resuliton (see
<code><a href="#topic+mcrals">mcrals</a></code>). Either provide name and parameters to one of the existing constraint
implementations or make your own. See the list of implemented constraints by running
<code>constraints()</code>
</p>
<p>For your own constraint you need to create a method, which takes matrix with values (either
spectra or contributions being resolved) as the first argument, does something and then return
a matrix with the same dimension as the result. The method can have any number of optional
parameters.
</p>
<p>See help for <code><a href="#topic+mcrals">mcrals</a></code> or Bookdown tutorial for details.
</p>

<hr>
<h2 id='constraintAngle'>Method for angle constraint</h2><span id='topic+constraintAngle'></span>

<h3>Description</h3>

<p>Adds a small portion of mean to contributions or spectra to increase contrast
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constraintAngle(x, d, weight = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constraintAngle_+3A_x">x</code></td>
<td>
<p>data matrix (spectra or contributions)</p>
</td></tr>
<tr><td><code id="constraintAngle_+3A_d">d</code></td>
<td>
<p>matrix with the original spectral values</p>
</td></tr>
<tr><td><code id="constraintAngle_+3A_weight">weight</code></td>
<td>
<p>how many percent of mean to add (between 0 and 1)</p>
</td></tr>
</table>

<hr>
<h2 id='constraintClosure'>Method for closure constraint</h2><span id='topic+constraintClosure'></span>

<h3>Description</h3>

<p>Force rows of data sum up to given value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constraintClosure(x, d, sum = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constraintClosure_+3A_x">x</code></td>
<td>
<p>data matrix (spectra or contributions)</p>
</td></tr>
<tr><td><code id="constraintClosure_+3A_d">d</code></td>
<td>
<p>matrix with the original spectral values</p>
</td></tr>
<tr><td><code id="constraintClosure_+3A_sum">sum</code></td>
<td>
<p>which value the specra or contributions should sum up to</p>
</td></tr>
</table>

<hr>
<h2 id='constraintNonNegativity'>Method for non-negativity constraint</h2><span id='topic+constraintNonNegativity'></span>

<h3>Description</h3>

<p>Set all negative values in the matrix to 0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constraintNonNegativity(x, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constraintNonNegativity_+3A_x">x</code></td>
<td>
<p>data matrix (spectra or contributions)</p>
</td></tr>
<tr><td><code id="constraintNonNegativity_+3A_d">d</code></td>
<td>
<p>matrix with the original spectral values</p>
</td></tr>
</table>

<hr>
<h2 id='constraintNorm'>Method for normalization constraint</h2><span id='topic+constraintNorm'></span>

<h3>Description</h3>

<p>Normalize rows of matrix to unit length or area
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constraintNorm(x, d, type = "length")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constraintNorm_+3A_x">x</code></td>
<td>
<p>data matrix (spectra or contributions)</p>
</td></tr>
<tr><td><code id="constraintNorm_+3A_d">d</code></td>
<td>
<p>matrix with the original spectral values</p>
</td></tr>
<tr><td><code id="constraintNorm_+3A_type">type</code></td>
<td>
<p>type of normalization (&quot;area&quot;, &quot;length&quot; or &quot;sum&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='constraints.list'>Shows information about all implemented constraints</h2><span id='topic+constraints.list'></span>

<h3>Description</h3>

<p>Shows information about all implemented constraints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constraints.list()
</code></pre>

<hr>
<h2 id='constraintUnimod'>Method for unimodality constraint</h2><span id='topic+constraintUnimod'></span>

<h3>Description</h3>

<p>forces column of matrix to have one maximum each
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constraintUnimod(x, d, tol = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constraintUnimod_+3A_x">x</code></td>
<td>
<p>data matrix (spectra or contributions)</p>
</td></tr>
<tr><td><code id="constraintUnimod_+3A_d">d</code></td>
<td>
<p>matrix with the original spectral values</p>
</td></tr>
<tr><td><code id="constraintUnimod_+3A_tol">tol</code></td>
<td>
<p>tolerance (value between 0 and 1) to take make method stable to small fluctuations</p>
</td></tr>
</table>

<hr>
<h2 id='crossval'>Generate sequence of indices for cross-validation</h2><span id='topic+crossval'></span>

<h3>Description</h3>

<p>Generates and returns sequence of object indices for each segment in random segmented
cross-validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossval(cv = 1, nobj = NULL, resp = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossval_+3A_cv">cv</code></td>
<td>
<p>cross-validation settings, can be a number or a list. If cv is a number, it will be
used as a number of segments for random cross-validation (if cv = 1, full cross-validation
will be preformed), if it is a list, the following syntax can be used:
cv = list('rand', nseg, nrep) for random repeated cross-validation with nseg segments and nrep
repetitions or cv = list('ven', nseg) for systematic splits to nseg segments ('venetian blinds').</p>
</td></tr>
<tr><td><code id="crossval_+3A_nobj">nobj</code></td>
<td>
<p>number of objects in a dataset</p>
</td></tr>
<tr><td><code id="crossval_+3A_resp">resp</code></td>
<td>
<p>vector with response values to use in case of venetian blinds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with object indices for each segment
</p>

<hr>
<h2 id='crossval.getParams'>Define parameters based on 'cv' value</h2><span id='topic+crossval.getParams'></span>

<h3>Description</h3>

<p>Define parameters based on 'cv' value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossval.getParams(cv, nobj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossval.getParams_+3A_cv">cv</code></td>
<td>
<p>settings for cross-validation provided by user</p>
</td></tr>
<tr><td><code id="crossval.getParams_+3A_nobj">nobj</code></td>
<td>
<p>number of objects in calibration set</p>
</td></tr>
</table>

<hr>
<h2 id='crossval.regmodel'>Cross-validation of a regression model</h2><span id='topic+crossval.regmodel'></span>

<h3>Description</h3>

<p>Does cross-validation of a regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossval.regmodel(obj, x, y, cv, cal.fun, pred.fun, cv.scope = "local")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossval.regmodel_+3A_obj">obj</code></td>
<td>
<p>a regression model (object of class <code>regmodel</code>)</p>
</td></tr>
<tr><td><code id="crossval.regmodel_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors from calibration set)</p>
</td></tr>
<tr><td><code id="crossval.regmodel_+3A_y">y</code></td>
<td>
<p>a matrix with y values (responses from calibration set)</p>
</td></tr>
<tr><td><code id="crossval.regmodel_+3A_cv">cv</code></td>
<td>
<p>number of segments (if cv = 1, full cross-validation will be used)</p>
</td></tr>
<tr><td><code id="crossval.regmodel_+3A_cal.fun">cal.fun</code></td>
<td>
<p>reference to function for model calibration</p>
</td></tr>
<tr><td><code id="crossval.regmodel_+3A_pred.fun">pred.fun</code></td>
<td>
<p>reference to function for getting predicted y-values (see description)</p>
</td></tr>
<tr><td><code id="crossval.regmodel_+3A_cv.scope">cv.scope</code></td>
<td>
<p>scope for center/scale operations inside CV loop: 'global' using globally computed mean and std
or 'local'  recompute new for each local calibration set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>plsres</code> with results of cross-validation
</p>
<p>Function 'pred.fun' must take four agruments: autoscaled x-values, array with regression
coefficients, vectors for centring and scaling of y-values (if used). The function must
return predicted y-values in original units (unscaled and uncentered).
</p>

<hr>
<h2 id='crossval.simca'>Cross-validation of a SIMCA model</h2><span id='topic+crossval.simca'></span>

<h3>Description</h3>

<p>Does the cross-validation of a SIMCA model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossval.simca(obj, x, cv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossval.simca_+3A_obj">obj</code></td>
<td>
<p>a SIMCA model (object of class <code>simca</code>)</p>
</td></tr>
<tr><td><code id="crossval.simca_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors from calibration set)</p>
</td></tr>
<tr><td><code id="crossval.simca_+3A_cv">cv</code></td>
<td>
<p>number of segments (if cv = 1, full cross-validation will be used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>simcares</code> with results of cross-validation
</p>

<hr>
<h2 id='crossval.str'>String with description of cross-validation method</h2><span id='topic+crossval.str'></span>

<h3>Description</h3>

<p>String with description of cross-validation method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossval.str(cv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossval.str_+3A_cv">cv</code></td>
<td>
<p>a list with cross-validation settings</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string with the description text
</p>

<hr>
<h2 id='dd.crit'>Calculates critical limits for distance values using Data Driven moments approach</h2><span id='topic+dd.crit'></span>

<h3>Description</h3>

<p>Calculates critical limits for distance values using Data Driven moments approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dd.crit(paramQ, paramT2, alpha = 0.05, gamma = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dd.crit_+3A_paramq">paramQ</code></td>
<td>
<p>matrix with parameters for distribution of Q distances</p>
</td></tr>
<tr><td><code id="dd.crit_+3A_paramt2">paramT2</code></td>
<td>
<p>matrix with parameters for distribution of T2 distances</p>
</td></tr>
<tr><td><code id="dd.crit_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme objects</p>
</td></tr>
<tr><td><code id="dd.crit_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outliers</p>
</td></tr>
</table>

<hr>
<h2 id='ddmoments.param'>Calculates critical limits for distance values using Data Driven moments approach</h2><span id='topic+ddmoments.param'></span>

<h3>Description</h3>

<p>Calculates critical limits for distance values using Data Driven moments approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddmoments.param(U)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ddmoments.param_+3A_u">U</code></td>
<td>
<p>matrix or vector with distance values</p>
</td></tr>
</table>

<hr>
<h2 id='ddrobust.param'>Calculates critical limits for distance values using Data Driven robust approach</h2><span id='topic+ddrobust.param'></span>

<h3>Description</h3>

<p>Calculates critical limits for distance values using Data Driven robust approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddrobust.param(U, ncomp, alpha, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ddrobust.param_+3A_u">U</code></td>
<td>
<p>matrix or vector with distance values</p>
</td></tr>
<tr><td><code id="ddrobust.param_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
<tr><td><code id="ddrobust.param_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme objects</p>
</td></tr>
<tr><td><code id="ddrobust.param_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outliers</p>
</td></tr>
</table>

<hr>
<h2 id='ellipse'>Create ellipse on the current plot</h2><span id='topic+ellipse'></span>

<h3>Description</h3>

<p>Create ellipse on the current plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipse(xc = 0, yc = 0, a, b, col = "black", lty = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse_+3A_xc">xc</code></td>
<td>
<p>coordinate of center (x)</p>
</td></tr>
<tr><td><code id="ellipse_+3A_yc">yc</code></td>
<td>
<p>coordinate of center (y)</p>
</td></tr>
<tr><td><code id="ellipse_+3A_a">a</code></td>
<td>
<p>major axis</p>
</td></tr>
<tr><td><code id="ellipse_+3A_b">b</code></td>
<td>
<p>minor axis</p>
</td></tr>
<tr><td><code id="ellipse_+3A_col">col</code></td>
<td>
<p>color of the ellipse line</p>
</td></tr>
<tr><td><code id="ellipse_+3A_lty">lty</code></td>
<td>
<p>type of the ellipse line</p>
</td></tr>
<tr><td><code id="ellipse_+3A_...">...</code></td>
<td>
<p>any argument suitable for <code>lines</code> function</p>
</td></tr>
</table>

<hr>
<h2 id='employ.constraint'>Applies constraint to a dataset</h2><span id='topic+employ.constraint'></span>

<h3>Description</h3>

<p>Applies constraint to a dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>employ.constraint(obj, x, d, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="employ.constraint_+3A_obj">obj</code></td>
<td>
<p>object with constraint</p>
</td></tr>
<tr><td><code id="employ.constraint_+3A_x">x</code></td>
<td>
<p>matrix with pure spectra or contributions</p>
</td></tr>
<tr><td><code id="employ.constraint_+3A_d">d</code></td>
<td>
<p>matrix with original spectral values</p>
</td></tr>
<tr><td><code id="employ.constraint_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='employ.prep'>Applies a list with preprocessing methods to a dataset</h2><span id='topic+employ.prep'></span>

<h3>Description</h3>

<p>Applies a list with preprocessing methods to a dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>employ.prep(obj, x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="employ.prep_+3A_obj">obj</code></td>
<td>
<p>list with preprocssing methods (created using <code>prep</code> function).</p>
</td></tr>
<tr><td><code id="employ.prep_+3A_x">x</code></td>
<td>
<p>matrix with dataset</p>
</td></tr>
<tr><td><code id="employ.prep_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='fprintf'>Imitation of fprinf() function</h2><span id='topic+fprintf'></span>

<h3>Description</h3>

<p>Imitation of fprinf() function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fprintf(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fprintf_+3A_...">...</code></td>
<td>
<p>arguments for sprintf function</p>
</td></tr>
</table>

<hr>
<h2 id='getCalibrationData'>Calibration data</h2><span id='topic+getCalibrationData'></span>

<h3>Description</h3>

<p>Calibration data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCalibrationData(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCalibrationData_+3A_obj">obj</code></td>
<td>
<p>a model object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function getting calibration data from a linear decomposition model (e.g. PCA)
</p>

<hr>
<h2 id='getCalibrationData.pca'>Returns matrix with original calibration data</h2><span id='topic+getCalibrationData.pca'></span>

<h3>Description</h3>

<p>Returns matrix with original calibration data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
getCalibrationData(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCalibrationData.pca_+3A_obj">obj</code></td>
<td>
<p>object with PCA model</p>
</td></tr>
</table>

<hr>
<h2 id='getCalibrationData.simcam'>Get calibration data</h2><span id='topic+getCalibrationData.simcam'></span>

<h3>Description</h3>

<p>Get data, used for calibration of the SIMCAM individual models and combine to one dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
getCalibrationData(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCalibrationData.simcam_+3A_obj">obj</code></td>
<td>
<p>SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+simcam">simcam</a></code> function.
</p>

<hr>
<h2 id='getConfidenceEllipse'>Compute confidence ellipse for a set of points</h2><span id='topic+getConfidenceEllipse'></span>

<h3>Description</h3>

<p>Compute confidence ellipse for a set of points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getConfidenceEllipse(points, conf.level = 0.95, n = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getConfidenceEllipse_+3A_points">points</code></td>
<td>
<p>matrix of data frame with coordinates of the points</p>
</td></tr>
<tr><td><code id="getConfidenceEllipse_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for the ellipse</p>
</td></tr>
<tr><td><code id="getConfidenceEllipse_+3A_n">n</code></td>
<td>
<p>number of points in the ellipse coordinates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with coordinates of the ellipse points (x and y)
</p>

<hr>
<h2 id='getConfusionMatrix'>Confusion matrix for classification results</h2><span id='topic+getConfusionMatrix'></span>

<h3>Description</h3>

<p>Confusion matrix for classification results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getConfusionMatrix(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getConfusionMatrix_+3A_obj">obj</code></td>
<td>
<p>classification results (object of class <code>simcares</code>, <code>simcamres</code>, etc)</p>
</td></tr>
<tr><td><code id="getConfusionMatrix_+3A_...">...</code></td>
<td>
<p>other parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns confusion matrix for classification results represented by the object.
</p>

<hr>
<h2 id='getConfusionMatrix.classres'>Confusion matrix for classification results</h2><span id='topic+getConfusionMatrix.classres'></span>

<h3>Description</h3>

<p>The columns of the matrix correspond to classification results, rows - to the real classes. In
case of soft classification with multiple classes (e.g. SIMCAM) sum of values for every row
will not correspond to the total number of class members as the same object can be classified
as a member of several classes or non of them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
getConfusionMatrix(obj, ncomp = obj$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getConfusionMatrix.classres_+3A_obj">obj</code></td>
<td>
<p>classification results (object of class <code>simcares</code>, <code>simcamres</code>, etc)</p>
</td></tr>
<tr><td><code id="getConfusionMatrix.classres_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to make the matrix for (NULL - use selected for a model).</p>
</td></tr>
<tr><td><code id="getConfusionMatrix.classres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns confusion matrix for classification results represented by the object.
</p>

<hr>
<h2 id='getConvexHull'>Compute coordinates of a closed convex hull for data points</h2><span id='topic+getConvexHull'></span>

<h3>Description</h3>

<p>Compute coordinates of a closed convex hull for data points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getConvexHull(points)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getConvexHull_+3A_points">points</code></td>
<td>
<p>matrix of data frame with coordinates of the points</p>
</td></tr>
</table>

<hr>
<h2 id='getDataLabels'>Create a vector with labels for plot series</h2><span id='topic+getDataLabels'></span>

<h3>Description</h3>

<p>For scatter plots labels correspond to rows of the data (names, values, indices, etc.). For
non-scatter plots labels correspond to the columns (names, indices or max value for each column)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDataLabels(ps, labels = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDataLabels_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
<tr><td><code id="getDataLabels_+3A_labels">labels</code></td>
<td>
<p>vector with user defined labels or type of labels to show (&quot;values&quot;, &quot;names&quot;, &quot;indices&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='getImplementedConstraints'>Shows a list with implemented constraints</h2><span id='topic+getImplementedConstraints'></span>

<h3>Description</h3>

<p>Shows a list with implemented constraints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getImplementedConstraints()
</code></pre>

<hr>
<h2 id='getImplementedPrepMethods'>Shows a list with implemented preprocessing methods</h2><span id='topic+getImplementedPrepMethods'></span>

<h3>Description</h3>

<p>Shows a list with implemented preprocessing methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getImplementedPrepMethods()
</code></pre>

<hr>
<h2 id='getLabelsAsIndices'>Create labels as column or row indices</h2><span id='topic+getLabelsAsIndices'></span>

<h3>Description</h3>

<p>Create labels as column or row indices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLabelsAsIndices(ps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLabelsAsIndices_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
</table>

<hr>
<h2 id='getLabelsAsValues'>Create labels from data values</h2><span id='topic+getLabelsAsValues'></span>

<h3>Description</h3>

<p>Create labels from data values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLabelsAsValues(ps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLabelsAsValues_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
</table>

<hr>
<h2 id='getMainTitle'>Get main title</h2><span id='topic+getMainTitle'></span>

<h3>Description</h3>

<p>returns main title for a plot depending on a user choice
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMainTitle(main, ncomp, default)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMainTitle_+3A_main">main</code></td>
<td>
<p>main title of a plot, provided by user</p>
</td></tr>
<tr><td><code id="getMainTitle_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to select, provided by user</p>
</td></tr>
<tr><td><code id="getMainTitle_+3A_default">default</code></td>
<td>
<p>default title for the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depedning on a user choice it returns main title for a plot
</p>

<hr>
<h2 id='getPlotColors'>Define colors for plot series</h2><span id='topic+getPlotColors'></span>

<h3>Description</h3>

<p>Define colors for plot series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPlotColors(ps, col, opacity, cgroup, colmap)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPlotColors_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
<tr><td><code id="getPlotColors_+3A_col">col</code></td>
<td>
<p>color specified by user (if any)</p>
</td></tr>
<tr><td><code id="getPlotColors_+3A_opacity">opacity</code></td>
<td>
<p>opacity for the color</p>
</td></tr>
<tr><td><code id="getPlotColors_+3A_cgroup">cgroup</code></td>
<td>
<p>vector for color grouping (if any)</p>
</td></tr>
<tr><td><code id="getPlotColors_+3A_colmap">colmap</code></td>
<td>
<p>name or values for colormap</p>
</td></tr>
</table>

<hr>
<h2 id='getProbabilities'>Get class belonging probability</h2><span id='topic+getProbabilities'></span>

<h3>Description</h3>

<p>Compute class belonging probabilities for classification results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getProbabilities(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getProbabilities_+3A_obj">obj</code></td>
<td>
<p>an object with classification results (e.g. SIMCA)</p>
</td></tr>
<tr><td><code id="getProbabilities_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='getProbabilities.pca'>Probabilities for residual distances</h2><span id='topic+getProbabilities.pca'></span>

<h3>Description</h3>

<p>Probabilities for residual distances
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
getProbabilities(obj, ncomp, q, h, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getProbabilities.pca_+3A_obj">obj</code></td>
<td>
<p>object with PCA model</p>
</td></tr>
<tr><td><code id="getProbabilities.pca_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to compute the probability for</p>
</td></tr>
<tr><td><code id="getProbabilities.pca_+3A_q">q</code></td>
<td>
<p>vector with squared orthogonal distances for given number of components</p>
</td></tr>
<tr><td><code id="getProbabilities.pca_+3A_h">h</code></td>
<td>
<p>vector with score distances for given number of components</p>
</td></tr>
<tr><td><code id="getProbabilities.pca_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes p-value for every object being from the same populaion as calibration set
based on its orthogonal and score distances.
</p>

<hr>
<h2 id='getProbabilities.simca'>Probabilities of class belonging for PCA/SIMCA results</h2><span id='topic+getProbabilities.simca'></span>

<h3>Description</h3>

<p>Probabilities of class belonging for PCA/SIMCA results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simca'
getProbabilities(obj, ncomp, q, h, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getProbabilities.simca_+3A_obj">obj</code></td>
<td>
<p>object with PCA model</p>
</td></tr>
<tr><td><code id="getProbabilities.simca_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to compute the probability for</p>
</td></tr>
<tr><td><code id="getProbabilities.simca_+3A_q">q</code></td>
<td>
<p>vector with squared orthogonal distances for given number of components</p>
</td></tr>
<tr><td><code id="getProbabilities.simca_+3A_h">h</code></td>
<td>
<p>vector with score distances for given number of components</p>
</td></tr>
<tr><td><code id="getProbabilities.simca_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes p-value for every object being from the same populaion as calibration set
based on its orthogonal and score distances.
</p>

<hr>
<h2 id='getPureVariables'>Identifies pure variables</h2><span id='topic+getPureVariables'></span>

<h3>Description</h3>

<p>The method identifies indices of pure variables using the SIMPLISMA
algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPureVariables(D, ncomp, purevars, offset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPureVariables_+3A_d">D</code></td>
<td>
<p>matrix with the spectra</p>
</td></tr>
<tr><td><code id="getPureVariables_+3A_ncomp">ncomp</code></td>
<td>
<p>number of pure components</p>
</td></tr>
<tr><td><code id="getPureVariables_+3A_purevars">purevars</code></td>
<td>
<p>user provided values gor pure variables (no calculation will be run in this case)</p>
</td></tr>
<tr><td><code id="getPureVariables_+3A_offset">offset</code></td>
<td>
<p>offset (between 0 and 1) for calculation of parameter alpha</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with with following fields:
</p>
<table>
<tr><td><code>ncomp</code></td>
<td>
<p>number of pure components.</p>
</td></tr>
<tr><td><code>purvars</code></td>
<td>
<p>vector with indices for pure variables.</p>
</td></tr>
<tr><td><code>purityspec</code></td>
<td>
<p>matrix with purity values for each resolved components.</p>
</td></tr>
<tr><td><code>purity</code></td>
<td>
<p>vector with purity values for resolved components.</p>
</td></tr>
</table>

<hr>
<h2 id='getRegcoeffs'>Get regression coefficients</h2><span id='topic+getRegcoeffs'></span>

<h3>Description</h3>

<p>Generic function for getting regression coefficients from PLS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRegcoeffs(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRegcoeffs_+3A_obj">obj</code></td>
<td>
<p>a PLS model</p>
</td></tr>
<tr><td><code id="getRegcoeffs_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='getRegcoeffs.regmodel'>Regression coefficients for PLS model'</h2><span id='topic+getRegcoeffs.regmodel'></span>

<h3>Description</h3>

<p>Returns a matrix with regression coefficients for
the PLS model which can be applied to a data directly
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmodel'
getRegcoeffs(
  obj,
  ncomp = obj$ncomp.selected,
  ny = 1,
  full = FALSE,
  alpha = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRegcoeffs.regmodel_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="getRegcoeffs.regmodel_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to return the coefficients for</p>
</td></tr>
<tr><td><code id="getRegcoeffs.regmodel_+3A_ny">ny</code></td>
<td>
<p>if y is multivariate which variables you want to see the coefficients for</p>
</td></tr>
<tr><td><code id="getRegcoeffs.regmodel_+3A_full">full</code></td>
<td>
<p>if TRUE the method also shows p-values and t-values as well as confidence intervals for the
coefficients (if available)</p>
</td></tr>
<tr><td><code id="getRegcoeffs.regmodel_+3A_alpha">alpha</code></td>
<td>
<p>significance level for confidence intervals (a number between 0 and 1, e.g. 0.05)</p>
</td></tr>
<tr><td><code id="getRegcoeffs.regmodel_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method recalculates the regression coefficients found by the PLS algorithm
taking into account centering and scaling of predictors and responses, so the
matrix with coefficients can be applied directly to original data (yp = Xb).
</p>
<p>If number of components is not specified, the optimal number, selected by user
or identified by a model will be used.
</p>
<p>If Jack-knifing method was used to get statistics for the coefficient the method
returns all statistics as well (p-value, t-value, confidence interval). In this case user
has to specified a number of y-variable (if there are many) to get the statistics and
the coefficients for. The confidence interval is computed for unstandardized coefficients.
</p>


<h3>Value</h3>

<p>A matrix  with regression coefficients and (optinally) statistics.
</p>

<hr>
<h2 id='getRes'>Return list with valid results</h2><span id='topic+getRes'></span>

<h3>Description</h3>

<p>Return list with valid results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRes(res, classname = "ldecomp")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRes_+3A_res">res</code></td>
<td>
<p>list with results</p>
</td></tr>
<tr><td><code id="getRes_+3A_classname">classname</code></td>
<td>
<p>name of class (for result object) to look for</p>
</td></tr>
</table>

<hr>
<h2 id='getSelectedComponents'>Get selected components</h2><span id='topic+getSelectedComponents'></span>

<h3>Description</h3>

<p>returns number of components depending on a user choice
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSelectedComponents(obj, ncomp = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSelectedComponents_+3A_obj">obj</code></td>
<td>
<p>an MDA model or result object (e.g. <code>pca</code>, <code>pls</code>, <code>simca</code>, etc)</p>
</td></tr>
<tr><td><code id="getSelectedComponents_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to select, provided by user</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depedning on a user choice it returns optimal number of component for the model (if
use did not provide any value) or check the user choice for correctness and returns
it back
</p>

<hr>
<h2 id='getSelectivityRatio'>Selectivity ratio</h2><span id='topic+getSelectivityRatio'></span>

<h3>Description</h3>

<p>Generic function for returning selectivity ratio values for regression model (PCR, PLS, etc)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSelectivityRatio(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSelectivityRatio_+3A_obj">obj</code></td>
<td>
<p>a regression model</p>
</td></tr>
<tr><td><code id="getSelectivityRatio_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='getSelectivityRatio.pls'>Selectivity ratio for PLS model</h2><span id='topic+getSelectivityRatio.pls'></span>

<h3>Description</h3>

<p>Returns vector with Selectivity ratio values. This function is a proxy for <code><a href="#topic+selratio">selratio</a></code>
and will be removed in future releases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
getSelectivityRatio(obj, ncomp = obj$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSelectivityRatio.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="getSelectivityRatio.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to get the values for (if NULL user selected as optimal will be used)</p>
</td></tr>
<tr><td><code id="getSelectivityRatio.pls_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with selectivity ratio values
</p>


<h3>References</h3>

<p>[1] Tarja Rajalahti et al. Chemometrics and Laboratory Systems, 95 (2009), pp. 35-48.
</p>

<hr>
<h2 id='getVariance.mcr'>Compute explained variance for MCR case</h2><span id='topic+getVariance.mcr'></span>

<h3>Description</h3>

<p>Compute explained variance for MCR case
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVariance.mcr(obj, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getVariance.mcr_+3A_obj">obj</code></td>
<td>
<p>object of class <code>mcr</code></p>
</td></tr>
<tr><td><code id="getVariance.mcr_+3A_x">x</code></td>
<td>
<p>original spectral data</p>
</td></tr>
</table>

<hr>
<h2 id='getVIPScores'>VIP scores</h2><span id='topic+getVIPScores'></span>

<h3>Description</h3>

<p>Generic function for returning VIP scores values for regression model (PCR, PLS, etc)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVIPScores(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getVIPScores_+3A_obj">obj</code></td>
<td>
<p>a regression model</p>
</td></tr>
<tr><td><code id="getVIPScores_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='getVIPScores.pls'>VIP scores for PLS model</h2><span id='topic+getVIPScores.pls'></span>

<h3>Description</h3>

<p>Returns vector with VIP scores values. This function is a proxy for <code><a href="#topic+vipscores">vipscores</a></code>
and will be removed in future releases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
getVIPScores(obj, ncomp = obj$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getVIPScores.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="getVIPScores.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to count</p>
</td></tr>
<tr><td><code id="getVIPScores.pls_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix <code>nvar x 1</code> with VIP score values
</p>

<hr>
<h2 id='hotelling.crit'>Calculate critical limits for distance values using Hotelling T2 distribution</h2><span id='topic+hotelling.crit'></span>

<h3>Description</h3>

<p>Calculate critical limits for distance values using Hotelling T2 distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hotelling.crit(nobj, ncomp, alpha = 0.05, gamma = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hotelling.crit_+3A_nobj">nobj</code></td>
<td>
<p>number of objects in calibration set</p>
</td></tr>
<tr><td><code id="hotelling.crit_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
<tr><td><code id="hotelling.crit_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme objects</p>
</td></tr>
<tr><td><code id="hotelling.crit_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outliers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with four values: critical limits for given alpha and gamma, mean distance and DoF.
</p>

<hr>
<h2 id='hotelling.prob'>Calculate probabilities for distance values and given parameters using Hotelling T2 distribution</h2><span id='topic+hotelling.prob'></span>

<h3>Description</h3>

<p>Calculate probabilities for distance values and given parameters using Hotelling T2 distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hotelling.prob(u, ncomp, nobj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hotelling.prob_+3A_u">u</code></td>
<td>
<p>vector with distances</p>
</td></tr>
<tr><td><code id="hotelling.prob_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
<tr><td><code id="hotelling.prob_+3A_nobj">nobj</code></td>
<td>
<p>number of objects in calibration set</p>
</td></tr>
</table>

<hr>
<h2 id='imshow'>show image data as an image</h2><span id='topic+imshow'></span>

<h3>Description</h3>

<p>show image data as an image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imshow(
  data,
  channels = 1,
  show.excluded = FALSE,
  main = paste0(" ", colnames(data)[channels]),
  colmap = "jet"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imshow_+3A_data">data</code></td>
<td>
<p>data with image</p>
</td></tr>
<tr><td><code id="imshow_+3A_channels">channels</code></td>
<td>
<p>indices for one or three columns to show as image channels</p>
</td></tr>
<tr><td><code id="imshow_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, if TRUE the method also shows the excluded (hidden) pixels</p>
</td></tr>
<tr><td><code id="imshow_+3A_main">main</code></td>
<td>
<p>main title for the image</p>
</td></tr>
<tr><td><code id="imshow_+3A_colmap">colmap</code></td>
<td>
<p>colormap using to show the intensity levels</p>
</td></tr>
</table>

<hr>
<h2 id='ipls'>Variable selection with interval PLS</h2><span id='topic+ipls'></span>

<h3>Description</h3>

<p>Applies iPLS algorithm to find variable intervals most important for
prediction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipls(
  x,
  y,
  glob.ncomp = 10,
  center = TRUE,
  scale = FALSE,
  cv = list("ven", 10),
  exclcols = NULL,
  exclrows = NULL,
  int.ncomp = glob.ncomp,
  int.num = NULL,
  int.width = NULL,
  int.limits = NULL,
  int.niter = NULL,
  ncomp.selcrit = "min",
  method = "forward",
  x.test = NULL,
  y.test = NULL,
  silent = FALSE,
  full = FALSE,
  cv.scope = "local"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipls_+3A_x">x</code></td>
<td>
<p>a matrix with predictor values.</p>
</td></tr>
<tr><td><code id="ipls_+3A_y">y</code></td>
<td>
<p>a vector with response values.</p>
</td></tr>
<tr><td><code id="ipls_+3A_glob.ncomp">glob.ncomp</code></td>
<td>
<p>maximum number of components for a global PLS model.</p>
</td></tr>
<tr><td><code id="ipls_+3A_center">center</code></td>
<td>
<p>logical, center or not the data values.</p>
</td></tr>
<tr><td><code id="ipls_+3A_scale">scale</code></td>
<td>
<p>logical, standardize or not the data values.</p>
</td></tr>
<tr><td><code id="ipls_+3A_cv">cv</code></td>
<td>
<p>cross-validation settings (see details).</p>
</td></tr>
<tr><td><code id="ipls_+3A_exclcols">exclcols</code></td>
<td>
<p>columns of x to be excluded from calculations (numbers, names or vector with logical values).</p>
</td></tr>
<tr><td><code id="ipls_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values).</p>
</td></tr>
<tr><td><code id="ipls_+3A_int.ncomp">int.ncomp</code></td>
<td>
<p>maximum number of components for interval PLS models.</p>
</td></tr>
<tr><td><code id="ipls_+3A_int.num">int.num</code></td>
<td>
<p>number of intervals.</p>
</td></tr>
<tr><td><code id="ipls_+3A_int.width">int.width</code></td>
<td>
<p>width of intervals.</p>
</td></tr>
<tr><td><code id="ipls_+3A_int.limits">int.limits</code></td>
<td>
<p>a two column matrix with manual intervals specification.</p>
</td></tr>
<tr><td><code id="ipls_+3A_int.niter">int.niter</code></td>
<td>
<p>maximum number of iterations (if NULL it will be the smallest of two values: number of intervals and 30).</p>
</td></tr>
<tr><td><code id="ipls_+3A_ncomp.selcrit">ncomp.selcrit</code></td>
<td>
<p>criterion for selecting optimal number of components ('min' for minimum of RMSECV).</p>
</td></tr>
<tr><td><code id="ipls_+3A_method">method</code></td>
<td>
<p>iPLS method (<code>'forward'</code> or <code>'backward'</code>).</p>
</td></tr>
<tr><td><code id="ipls_+3A_x.test">x.test</code></td>
<td>
<p>matrix with predictors for test set (by default is NULL, if specified, is used instead of cv).</p>
</td></tr>
<tr><td><code id="ipls_+3A_y.test">y.test</code></td>
<td>
<p>matrix with responses for test set.</p>
</td></tr>
<tr><td><code id="ipls_+3A_silent">silent</code></td>
<td>
<p>logical, show or not information about selection process.</p>
</td></tr>
<tr><td><code id="ipls_+3A_full">full</code></td>
<td>
<p>logical, if TRUE the procedure will continue even if no improvements is observed.</p>
</td></tr>
<tr><td><code id="ipls_+3A_cv.scope">cv.scope</code></td>
<td>
<p>scope for center/scale operations inside CV loop: 'global' using globally computed mean and std
or 'local'  recompute new for each local calibration set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm splits the predictors into several intervals and tries to find a combination
of the intervals, which gives best prediction performance. There are two selection methods:
&quot;forward&quot; when the intervals are successively included, and &quot;backward&quot; when the intervals
are successively excluded from a model. On the first step the algorithm finds the best
(forward) or the worst (backward) individual interval. Then it tests the others to find the
one which gives the best model in a combination with the already selected/excluded one. The
procedure continues until no improvements is observed or the maximum number of iteration
is reached.
</p>
<p>There are several ways to specify the intervals. First of all either number of intervals
(<code>int.num</code>) or width of the intervals (<code>int.width</code>) can be provided. Alternatively
one can specify the limits (first and last variable number) of the intervals manually
with <code>int.limits</code>.
</p>
<p>Cross-validation settings, <code>cv</code>, can be a number or a list. If <code>cv</code> is a number, it
will be used as a number of segments for random cross-validation (if <code>cv = 1</code>, full
cross-validation will be preformed). If it is a list, the following syntax can be used:
<code>cv = list('rand', nseg, nrep)</code> for random repeated cross-validation with <code>nseg</code>
segments and <code>nrep</code> repetitions or <code>cv = list('ven', nseg)</code> for systematic splits
to <code>nseg</code> segments ('venetian blinds').
</p>


<h3>Value</h3>

<p>object of 'ipls' class with several fields, including:
</p>
<table>
<tr><td><code>var.selected</code></td>
<td>
<p>a vector with indices of selected variables</p>
</td></tr>
<tr><td><code>int.selected</code></td>
<td>
<p>a vector with indices of selected intervals </p>
</td></tr>
<tr><td><code>int.num</code></td>
<td>
<p>total number of intervals</p>
</td></tr>
<tr><td><code>int.width</code></td>
<td>
<p>width of the intervals</p>
</td></tr>
<tr><td><code>int.limits</code></td>
<td>
<p>a matrix with limits for each interval</p>
</td></tr>
<tr><td><code>int.stat</code></td>
<td>
<p>a data frame with statistics for the selection algorithm</p>
</td></tr>
<tr><td><code>glob.stat</code></td>
<td>
<p>a data frame with statistics for the first step (individual intervals)</p>
</td></tr>
<tr><td><code>gm</code></td>
<td>
<p>global PLS model with all variables included</p>
</td></tr>
<tr><td><code>om</code></td>
<td>
<p>optimized PLS model with selected variables</p>
</td></tr>
</table>


<h3>References</h3>

<p>[1] Lars Noergaard at al.  Interval partial least-squares regression (iPLS): a
comparative chemometric study with an example from near-infrared spectroscopy.
Appl.Spec. 2000; 54: 413-419
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mdatools)

## forward selection for simdata

data(simdata)
Xc = simdata$spectra.c
yc = simdata$conc.c[, 3, drop = FALSE]

# run iPLS and show results
im = ipls(Xc, yc, int.ncomp = 5, int.num = 10, cv = 4, method = "forward")
summary(im)
plot(im)

# show "developing" of RMSECV during the algorithm execution
plotRMSE(im)

# plot predictions before and after selection
par(mfrow = c(1, 2))
plotPredictions(im$gm)
plotPredictions(im$om)

# show selected intervals on spectral plot
ind = im$var.selected
mspectrum = apply(Xc, 2, mean)
plot(simdata$wavelength, mspectrum, type = 'l', col = 'lightblue')
points(simdata$wavelength[ind], mspectrum[ind], pch = 16, col = 'blue')

</code></pre>

<hr>
<h2 id='ipls.backward'>Runs the backward iPLS algorithm</h2><span id='topic+ipls.backward'></span>

<h3>Description</h3>

<p>Runs the backward iPLS algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipls.backward(x, y, obj, int.stat, glob.stat, full, cv.scope)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipls.backward_+3A_x">x</code></td>
<td>
<p>a matrix with predictor values.</p>
</td></tr>
<tr><td><code id="ipls.backward_+3A_y">y</code></td>
<td>
<p>a vector with response values.</p>
</td></tr>
<tr><td><code id="ipls.backward_+3A_obj">obj</code></td>
<td>
<p>object with initial settings for iPLS algorithm.</p>
</td></tr>
<tr><td><code id="ipls.backward_+3A_int.stat">int.stat</code></td>
<td>
<p>data frame with initial interval statistics.</p>
</td></tr>
<tr><td><code id="ipls.backward_+3A_glob.stat">glob.stat</code></td>
<td>
<p>data frame with initial global statistics.</p>
</td></tr>
<tr><td><code id="ipls.backward_+3A_full">full</code></td>
<td>
<p>logical, if TRUE the procedure will continue even if no improvements is observed.</p>
</td></tr>
<tr><td><code id="ipls.backward_+3A_cv.scope">cv.scope</code></td>
<td>
<p>scope for center/scale operations inside CV loop: 'global' using globally computed mean and std
or 'local'  recompute new for each local calibration set.</p>
</td></tr>
</table>

<hr>
<h2 id='ipls.forward'>Runs the forward iPLS algorithm</h2><span id='topic+ipls.forward'></span>

<h3>Description</h3>

<p>Runs the forward iPLS algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipls.forward(x, y, obj, int.stat, glob.stat, full, cv.scope)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipls.forward_+3A_x">x</code></td>
<td>
<p>a matrix with predictor values.</p>
</td></tr>
<tr><td><code id="ipls.forward_+3A_y">y</code></td>
<td>
<p>a vector with response values.</p>
</td></tr>
<tr><td><code id="ipls.forward_+3A_obj">obj</code></td>
<td>
<p>object with initial settings for iPLS algorithm.</p>
</td></tr>
<tr><td><code id="ipls.forward_+3A_int.stat">int.stat</code></td>
<td>
<p>data frame with initial interval statistics.</p>
</td></tr>
<tr><td><code id="ipls.forward_+3A_glob.stat">glob.stat</code></td>
<td>
<p>data frame with initial global statistics.</p>
</td></tr>
<tr><td><code id="ipls.forward_+3A_full">full</code></td>
<td>
<p>logical, if TRUE the procedure will continue even if no improvements is observed.</p>
</td></tr>
<tr><td><code id="ipls.forward_+3A_cv.scope">cv.scope</code></td>
<td>
<p>scope for center/scale operations inside CV loop: 'global' using globally computed mean and std
or 'local'  recompute new for each local calibration set.</p>
</td></tr>
</table>

<hr>
<h2 id='jm.crit'>Calculate critical limits for distance values using Jackson-Mudholkar approach</h2><span id='topic+jm.crit'></span>

<h3>Description</h3>

<p>Calculate critical limits for distance values using Jackson-Mudholkar approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jm.crit(residuals, eigenvals, alpha = 0.05, gamma = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jm.crit_+3A_residuals">residuals</code></td>
<td>
<p>matrix with PCA residuals</p>
</td></tr>
<tr><td><code id="jm.crit_+3A_eigenvals">eigenvals</code></td>
<td>
<p>vector with eigenvalues for PCA components</p>
</td></tr>
<tr><td><code id="jm.crit_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme objects</p>
</td></tr>
<tr><td><code id="jm.crit_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outliers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with four values: critical limits for given alpha and gamma, mean distance and DoF.
</p>

<hr>
<h2 id='jm.prob'>Calculate probabilities for distance values and given parameters using Hotelling T2 distribution</h2><span id='topic+jm.prob'></span>

<h3>Description</h3>

<p>Calculate probabilities for distance values and given parameters using Hotelling T2 distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jm.prob(u, eigenvals, ncomp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jm.prob_+3A_u">u</code></td>
<td>
<p>vector with distances</p>
</td></tr>
<tr><td><code id="jm.prob_+3A_eigenvals">eigenvals</code></td>
<td>
<p>vector with eigenvalues for PCA components</p>
</td></tr>
<tr><td><code id="jm.prob_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
</table>

<hr>
<h2 id='ldecomp'>Class for storing and visualising linear decomposition of dataset (X = TP' + E)</h2><span id='topic+ldecomp'></span>

<h3>Description</h3>

<p>Creates an object of ldecomp class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldecomp(scores, loadings, residuals, eigenvals, ncomp.selected = ncol(scores))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldecomp_+3A_scores">scores</code></td>
<td>
<p>matrix with score values (I x A).</p>
</td></tr>
<tr><td><code id="ldecomp_+3A_loadings">loadings</code></td>
<td>
<p>matrix with loading values (J x A).</p>
</td></tr>
<tr><td><code id="ldecomp_+3A_residuals">residuals</code></td>
<td>
<p>matrix with data residuals (I x J)</p>
</td></tr>
<tr><td><code id="ldecomp_+3A_eigenvals">eigenvals</code></td>
<td>
<p>vector with eigenvalues for the loadings</p>
</td></tr>
<tr><td><code id="ldecomp_+3A_ncomp.selected">ncomp.selected</code></td>
<td>
<p>number of selected components</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ldecomp</code> is a general class for storing results of decomposition of dataset in
form X = TP' + E. Here, X is a data matrix, T - matrix with scores, P - matrix with
loadings and E - matrix with residuals. It is used, for example, for PCA results
(<code><a href="#topic+pcares">pcares</a></code>), in PLS and other methods. The class also includes methods for
calculation of residual distances and explained variance.
</p>
<p>There is no need to use the <code>ldecomp</code> manually. For example, when build PCA model
with <code><a href="#topic+pca">pca</a></code> or apply it to a new data, the results will automatically inherit
all methods of <code>ldecomp</code>.
</p>


<h3>Value</h3>

<p>Returns an object (list) of <code>ldecomp</code> class with following fields:
</p>
<table>
<tr><td><code>scores</code></td>
<td>
<p>matrix with score values (I x A).</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>matrix with data residuals (I x J).</p>
</td></tr>
<tr><td><code>T2</code></td>
<td>
<p>matrix with score distances (I x A).</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>matrix with orthogonal distances (I x A).</p>
</td></tr>
<tr><td><code>ncomp.selected</code></td>
<td>
<p>selected number of components.</p>
</td></tr>
<tr><td><code>expvar</code></td>
<td>
<p>explained variance for each component.</p>
</td></tr>
<tr><td><code>cumexpvar</code></td>
<td>
<p>cumulative explained variance.</p>
</td></tr>
</table>

<hr>
<h2 id='ldecomp.getDistances'>Compute score and residual distances</h2><span id='topic+ldecomp.getDistances'></span>

<h3>Description</h3>

<p>Compute orthogonal Euclidean distance from object to PC space (Q, q) and Mahalanobis
squared distance between projection of the object to the space and its origin (T2, h).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldecomp.getDistances(scores, loadings, residuals, eigenvals)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldecomp.getDistances_+3A_scores">scores</code></td>
<td>
<p>matrix with scores (T).</p>
</td></tr>
<tr><td><code id="ldecomp.getDistances_+3A_loadings">loadings</code></td>
<td>
<p>matrix with loadings (P).</p>
</td></tr>
<tr><td><code id="ldecomp.getDistances_+3A_residuals">residuals</code></td>
<td>
<p>matrix with residuals (E).</p>
</td></tr>
<tr><td><code id="ldecomp.getDistances_+3A_eigenvals">eigenvals</code></td>
<td>
<p>vector with eigenvalues for the components</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The distances are calculated for every 1:n components, where n goes from 1 to ncomp
(number of columns in scores and loadings).
</p>


<h3>Value</h3>

<p>Returns a list with Q, T2 and tnorm values for each component.
</p>

<hr>
<h2 id='ldecomp.getLimitsCoordinates'>Compute coordinates of lines or curves with critical limits</h2><span id='topic+ldecomp.getLimitsCoordinates'></span>

<h3>Description</h3>

<p>Compute coordinates of lines or curves with critical limits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldecomp.getLimitsCoordinates(
  Qlim,
  T2lim,
  ncomp,
  norm,
  log,
  show.limits = c(TRUE, TRUE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldecomp.getLimitsCoordinates_+3A_qlim">Qlim</code></td>
<td>
<p>matrix with critical limits for orthogonal distances</p>
</td></tr>
<tr><td><code id="ldecomp.getLimitsCoordinates_+3A_t2lim">T2lim</code></td>
<td>
<p>matrix with critical limits for score distances</p>
</td></tr>
<tr><td><code id="ldecomp.getLimitsCoordinates_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components for computing the coordinates</p>
</td></tr>
<tr><td><code id="ldecomp.getLimitsCoordinates_+3A_norm">norm</code></td>
<td>
<p>logical, shall distance values be normalized or not</p>
</td></tr>
<tr><td><code id="ldecomp.getLimitsCoordinates_+3A_log">log</code></td>
<td>
<p>logical, shall log transformation be applied or not</p>
</td></tr>
<tr><td><code id="ldecomp.getLimitsCoordinates_+3A_show.limits">show.limits</code></td>
<td>
<p>vector with two logical values defining if limits for extreme and/or outliers must be shown</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with two matrices (x and y coordinates of corresponding limits)
</p>

<hr>
<h2 id='ldecomp.getLimParams'>Compute parameters for critical limits based on calibration results</h2><span id='topic+ldecomp.getLimParams'></span>

<h3>Description</h3>

<p>Compute parameters for critical limits based on calibration results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldecomp.getLimParams(U)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldecomp.getLimParams_+3A_u">U</code></td>
<td>
<p>matrix with residual distances</p>
</td></tr>
</table>

<hr>
<h2 id='ldecomp.getQLimits'>Compute critical limits for orthogonal distances (Q)</h2><span id='topic+ldecomp.getQLimits'></span>

<h3>Description</h3>

<p>Compute critical limits for orthogonal distances (Q)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldecomp.getQLimits(lim.type, alpha, gamma, params, residuals, eigenvals)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldecomp.getQLimits_+3A_lim.type">lim.type</code></td>
<td>
<p>which method to use for calculation of critical limits for residuals</p>
</td></tr>
<tr><td><code id="ldecomp.getQLimits_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme limits.</p>
</td></tr>
<tr><td><code id="ldecomp.getQLimits_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outlier limits.</p>
</td></tr>
<tr><td><code id="ldecomp.getQLimits_+3A_params">params</code></td>
<td>
<p>distribution parameters returned by ldecomp.getLimParams</p>
</td></tr>
<tr><td><code id="ldecomp.getQLimits_+3A_residuals">residuals</code></td>
<td>
<p>matrix with residuals (E)</p>
</td></tr>
<tr><td><code id="ldecomp.getQLimits_+3A_eigenvals">eigenvals</code></td>
<td>
<p>egenvalues for the components used to decompose the data</p>
</td></tr>
</table>

<hr>
<h2 id='ldecomp.getT2Limits'>Compute critical limits for score distances (T2)</h2><span id='topic+ldecomp.getT2Limits'></span>

<h3>Description</h3>

<p>Compute critical limits for score distances (T2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldecomp.getT2Limits(lim.type, alpha, gamma, params)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldecomp.getT2Limits_+3A_lim.type">lim.type</code></td>
<td>
<p>which method to use for calculation (&quot;chisq&quot;, &quot;ddmoments&quot;, &quot;ddrobust&quot;)</p>
</td></tr>
<tr><td><code id="ldecomp.getT2Limits_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme limits.</p>
</td></tr>
<tr><td><code id="ldecomp.getT2Limits_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outlier limits.</p>
</td></tr>
<tr><td><code id="ldecomp.getT2Limits_+3A_params">params</code></td>
<td>
<p>distribution parameters returned by ldecomp.getLimParams</p>
</td></tr>
</table>

<hr>
<h2 id='ldecomp.getVariances'>Compute explained variance</h2><span id='topic+ldecomp.getVariances'></span>

<h3>Description</h3>

<p>Computes explained variance and cumulative explained variance for data decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldecomp.getVariances(scores, loadings, residuals, Q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldecomp.getVariances_+3A_scores">scores</code></td>
<td>
<p>matrix with scores (T).</p>
</td></tr>
<tr><td><code id="ldecomp.getVariances_+3A_loadings">loadings</code></td>
<td>
<p>matrix with loadings (P).</p>
</td></tr>
<tr><td><code id="ldecomp.getVariances_+3A_residuals">residuals</code></td>
<td>
<p>matrix with residuals (E).</p>
</td></tr>
<tr><td><code id="ldecomp.getVariances_+3A_q">Q</code></td>
<td>
<p>matrix with squared orthogonal distances.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with two vectors.
</p>

<hr>
<h2 id='ldecomp.plotResiduals'>Residuals distance plot for a set of ldecomp objects</h2><span id='topic+ldecomp.plotResiduals'></span>

<h3>Description</h3>

<p>Shows a plot with score (T2, h) vs orthogonal (Q, q) distances and corresponding critical
limits for given number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldecomp.plotResiduals(
  res,
  Qlim,
  T2lim,
  ncomp,
  log = FALSE,
  norm = FALSE,
  cgroup = NULL,
  xlim = NULL,
  ylim = NULL,
  show.limits = c(TRUE, TRUE),
  lim.col = c("darkgray", "darkgray"),
  lim.lwd = c(1, 1),
  lim.lty = c(2, 3),
  show.legend = TRUE,
  legend.position = "topright",
  show.excluded = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldecomp.plotResiduals_+3A_res">res</code></td>
<td>
<p>list with result objects to show the plot for</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_qlim">Qlim</code></td>
<td>
<p>matrix with critical limits for orthogonal distance</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_t2lim">T2lim</code></td>
<td>
<p>matrix with critical limits for score distance</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (by default optimal value selected for the model will be used)</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_log">log</code></td>
<td>
<p>logical, apply log tranformation to the distances or not (see details)</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_norm">norm</code></td>
<td>
<p>logical, normalize distance values or not (see details)</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_cgroup">cgroup</code></td>
<td>
<p>color grouping of plot points (works only if one result object is available)</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_xlim">xlim</code></td>
<td>
<p>limits for x-axis (if NULL will be computed automatically)</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_ylim">ylim</code></td>
<td>
<p>limits for y-axis (if NULL will be computed automatically)</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_show.limits">show.limits</code></td>
<td>
<p>vector with two logical values defining if limits for extreme and/or outliers must be shown</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_lim.col">lim.col</code></td>
<td>
<p>vector with two values - line color for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_lim.lwd">lim.lwd</code></td>
<td>
<p>vector with two values - line width for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_lim.lty">lim.lty</code></td>
<td>
<p>vector with two values - line type for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not legend on the plot (if more than one result object)</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_legend.position">legend.position</code></td>
<td>
<p>if legend must be shown, where it should be</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, show or hide rows marked as excluded (attribute 'exclrows').</p>
</td></tr>
<tr><td><code id="ldecomp.plotResiduals_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is a bit more advanced version of <code><a href="#topic+plotResiduals.ldecomp">plotResiduals.ldecomp</a></code>. It allows to
show distance values for several result objects (e.g. calibration and test set or calibration
and new prediction set) as well as display the correspondng critical limits in form of lines
or curves.
</p>
<p>Depending on how many result objects your model has or how many you specified manually,
using the <code>res</code> parameter, the plot behaves in a bit different way.
</p>
<p>If only one result object is provided, then it allows to colorise the points using <code>cgroup</code>
parameter. If two or more result objects are provided, then the function show
distances in groups, and adds corresponding legend.
</p>
<p>The function can show distance values normalised (h/h0 and q/q0) as well as with log
transformation (log(1 + h/h0), log(1 + q/q0)). The latter is useful if distribution of the
points is skewed and most of them are densely located around bottom left corner.
</p>

<hr>
<h2 id='mcr'>General class for Multivariate Curve Resolution model</h2><span id='topic+mcr'></span>

<h3>Description</h3>

<p><code>mcr</code> is used to store and visualise general MCR data and results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcr(x, ncomp, method, exclrows = NULL, exclcols = NULL, info = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcr_+3A_x">x</code></td>
<td>
<p>spectra of mixtures (as matrix or data frame)</p>
</td></tr>
<tr><td><code id="mcr_+3A_ncomp">ncomp</code></td>
<td>
<p>number of pure components to resolve</p>
</td></tr>
<tr><td><code id="mcr_+3A_method">method</code></td>
<td>
<p>function for computing spectra of pure components</p>
</td></tr>
<tr><td><code id="mcr_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="mcr_+3A_exclcols">exclcols</code></td>
<td>
<p>columns to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="mcr_+3A_info">info</code></td>
<td>
<p>text with information about the MCR model</p>
</td></tr>
<tr><td><code id="mcr_+3A_...">...</code></td>
<td>
<p>other parameters realted to specific method</p>
</td></tr>
</table>

<hr>
<h2 id='mcrals'>Multivariate curve resolution using Alternating Least Squares</h2><span id='topic+mcrals'></span>

<h3>Description</h3>

<p><code>mcralls</code> allows to resolve spectroscopic data to linear combination of individual spectra
and contributions using the alternating least squares (ALS) algorithm with constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcrals(
  x,
  ncomp,
  cont.constraints = list(),
  spec.constraints = list(),
  spec.ini = matrix(runif(ncol(x) * ncomp), ncol(x), ncomp),
  cont.forced = matrix(NA, nrow(x), ncomp),
  spec.forced = matrix(NA, ncol(x), ncomp),
  cont.solver = mcrals.nnls,
  spec.solver = mcrals.nnls,
  exclrows = NULL,
  exclcols = NULL,
  verbose = FALSE,
  max.niter = 100,
  tol = 10^-6,
  info = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcrals_+3A_x">x</code></td>
<td>
<p>spectra of mixtures (matrix or data frame).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to calculate.</p>
</td></tr>
<tr><td><code id="mcrals_+3A_cont.constraints">cont.constraints</code></td>
<td>
<p>a list with constraints to be applied to contributions  (see details).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_spec.constraints">spec.constraints</code></td>
<td>
<p>a list with constraints to be applied to spectra  (see details).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_spec.ini">spec.ini</code></td>
<td>
<p>a matrix with initial estimation of the pure components spectra.</p>
</td></tr>
<tr><td><code id="mcrals_+3A_cont.forced">cont.forced</code></td>
<td>
<p>a matrix which allows to force some of the concentration values (see details).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_spec.forced">spec.forced</code></td>
<td>
<p>a matrix which allows to force some of the spectra values (see details).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_cont.solver">cont.solver</code></td>
<td>
<p>which function to use as a solver for resolving of pure components contributions (see detials).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_spec.solver">spec.solver</code></td>
<td>
<p>which function to use as a solver for resolving of pure components spectra (see detials).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_exclcols">exclcols</code></td>
<td>
<p>columns to be excluded from calculations (numbers, names or vector with logical values).</p>
</td></tr>
<tr><td><code id="mcrals_+3A_verbose">verbose</code></td>
<td>
<p>logical, if TRUE information about every iteration will be shown.</p>
</td></tr>
<tr><td><code id="mcrals_+3A_max.niter">max.niter</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="mcrals_+3A_tol">tol</code></td>
<td>
<p>tolerance, when explained variance change is smaller than this value, iterations stop.</p>
</td></tr>
<tr><td><code id="mcrals_+3A_info">info</code></td>
<td>
<p>a short text with description of the case (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method implements the iterative ALS algorithm, where, at each iteration, spectra and
contributions of each chemical component are estimated and then a set of constraints is
applied to each. The method is well described in [1, 2].
</p>
<p>The method assumes that the spectra (D) is a linear combination of pure components spectra (S)
and pure component concentrations (C):
</p>
<p>D = CS' + E
</p>
<p>So the task is to get C and S by knowing D. In order to do that you need to provide:
</p>
<p>1. Constraints for spectra and contributions. The constraints should be provided as a list
with name of the constraint and all necessary parameters. You can see which constraints and
parameters are currently supported by running <code>constraintList()</code>. See the code examples
below or a Bookdown tutorial for more details.
</p>
<p>2. Initial estimation of the pure components spectra, S. By default method uses a matrix with
random numbers but you can provide a better guess (for example by running <code><a href="#topic+mcrpure">mcrpure</a></code>)
as a first step.
</p>
<p>3. Which solver to use for resolving spectra and concentrations. There are two built in solvers:
<code>mcrals.nnls</code> (default) and <code>mcrals.ols</code>. The first implements non-negative least
squares method which gives non-negative (thus physically meaningful) solutions. The second is
ordinary least squares and if you want to get non-negative spectra and/or contributions in this
case you need to provide a non-negativity constraint.
</p>
<p>The algorithm iteratively resolves C and S and checks how well CS' is to D. The iterations stop
either when number exceeds value in <code>max.niter</code> or when improvements (difference between
explained variance on current and previous steps) is smaller than <code>tol</code> value.
</p>
<p>Parameters <code>cont.force</code> and <code>spec.force</code> allows you to force some parts of the
contributions or the spectra to be equal to particular pre-defined values. In this case you need
to provide the parameters (or just one of them) in form of a matrix. For example <code>cont.force</code>
should have as many rows as many you have in the original spectral data <code>x</code> and as many
columns as many pure components you want to resolve. Feel all values of this matrix with
<code>NA</code> and the values you want to force with real numbers. For example if you know that in
the first measurement concentration of 2 and 3 components was zero, set the corresponding
values of <code>cont.force</code> to zero. See also the last case in the examples section.
</p>


<h3>Value</h3>

<p>Returns an object of <code><a href="#topic+mcrpure">mcrpure</a></code> class with the following fields:
</p>
<table>
<tr><td><code>resspec</code></td>
<td>
<p>matrix with resolved spectra.</p>
</td></tr>
<tr><td><code>rescont</code></td>
<td>
<p>matrix with resolved contributions.</p>
</td></tr>
<tr><td><code>cont.constraints</code></td>
<td>
<p>list with contribution constraints provided by user.</p>
</td></tr>
<tr><td><code>spec.constraints</code></td>
<td>
<p>list with spectra constraints provided by user.</p>
</td></tr>
<tr><td><code>expvar</code></td>
<td>
<p>vector with explained variance for each component (in percent).</p>
</td></tr>
<tr><td><code>cumexpvar</code></td>
<td>
<p>vector with cumulative explained variance for each component (in percent).</p>
</td></tr>
<tr><td><code>ncomp</code></td>
<td>
<p>number of resolved components</p>
</td></tr>
<tr><td><code>max.niter</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information about the model, provided by user when build the model.</p>
</td></tr>
</table>
<p>More details and examples can be found in the Bookdown tutorial.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>References</h3>

<p>1. J. Jaumot, R. Gargallo, A. de Juan, and R. Tauler, &quot;A graphical user-friendly interface for
MCR-ALS: a new tool for multivariate curve resolution in MATLAB&quot;, Chemometrics and Intelligent #' Laboratory Systems 76, 101-110 (2005).
</p>


<h3>See Also</h3>

<p>Methods for <code>mcrals</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>summary.mcrals</code> </td><td style="text-align: left;"> shows some statistics for the case.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+predict.mcrals">predict.mcrals</a></code> </td><td style="text-align: left;"> computes contributions by projection of new spectra to
   the resolved ones.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Plotting methods for <code>mcrals</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotSpectra.mcr">plotSpectra.mcr</a></code> </td><td style="text-align: left;"> shows plot with resolved spectra.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotContributions.mcr">plotContributions.mcr</a></code> </td><td style="text-align: left;"> shows plot with resolved contributions.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotVariance.mcr">plotVariance.mcr</a></code> </td><td style="text-align: left;"> shows plot with explained variance.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotCumVariance.mcr">plotCumVariance.mcr</a></code> </td><td style="text-align: left;"> shows plot with cumulative explained variance.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>


library(mdatools)

# resolve mixture of carbonhydrates Raman spectra

data(carbs)

# define constraints for contributions
cc &lt;- list(
   constraint("nonneg")
)

# define constraints for spectra
cs &lt;- list(
   constraint("nonneg"),
   constraint("norm", params = list(type = "area"))
)

# because by default initial approximation is made by using random numbers
# we need to seed the generator in order to get reproducable results
set.seed(6)

# run ALS
m &lt;- mcrals(carbs$D, ncomp = 3, cont.constraints = cc, spec.constraints = cs)
summary(m)

# plot cumulative and individual explained variance
par(mfrow = c(1, 2))
plotVariance(m)
plotCumVariance(m)

# plot resolved spectra (all of them or individually)
par(mfrow = c(2, 1))
plotSpectra(m)
plotSpectra(m, comp = 2:3)

# plot resolved contributions (all of them or individually)
par(mfrow = c(2, 1))
plotContributions(m)
plotContributions(m, comp = 2:3)

# of course you can do this manually as well, e.g. show original
# and resolved spectra
par(mfrow = c(1, 1))
mdaplotg(
   list(
      "original" = prep.norm(carbs$D, "area"),
      "resolved" = prep.norm(mda.subset(mda.t(m$resspec), 1), "area")
   ), col = c("gray", "red"), type = "l"
)

# in case if you have reference spectra of components you can compare them with
# the resolved ones:
par(mfrow = c(3, 1))
for (i in 1:3) {
   mdaplotg(
      list(
         "pure" = prep.norm(mda.subset(mda.t(carbs$S), 1), "area"),
         "resolved" = prep.norm(mda.subset(mda.t(m$resspec), 1), "area")
      ), col = c("gray", "red"), type = "l", lwd = c(3, 1)
   )
}

# This example shows how to force some of the contribution values
# First of all we combine the matrix with mixtures and the pure spectra, so the pure
# spectra are on top of the combined matrix
Dplus &lt;- mda.rbind(mda.t(carbs$S), carbs$D)

# since we know that concentration of C2 and C3 is zero in the first row (it is a pure
# spectrum of first component), we can force them to be zero in the optimization procedure.
# Similarly we can do this for second and third rows.

cont.forced &lt;- matrix(NA, nrow(Dplus), 3)
cont.forced[1, ] &lt;- c(NA, 0, 0)
cont.forced[2, ] &lt;- c(0, NA, 0)
cont.forced[3, ] &lt;- c(0, 0, NA)

m &lt;- mcrals(Dplus, 3, cont.forced = cont.forced, cont.constraints = cc, spec.constraints = cs)
plot(m)

# See bookdown tutorial for more details.



</code></pre>

<hr>
<h2 id='mcrals.cal'>Identifies pure variables</h2><span id='topic+mcrals.cal'></span>

<h3>Description</h3>

<p>The method identifies indices of pure variables using the SIMPLISMA
algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcrals.cal(
  D,
  ncomp,
  cont.constraints,
  spec.constraints,
  spec.ini,
  cont.forced,
  spec.forced,
  cont.solver,
  spec.solver,
  max.niter,
  tol,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcrals.cal_+3A_d">D</code></td>
<td>
<p>matrix with the spectra</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_ncomp">ncomp</code></td>
<td>
<p>number of pure components</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_cont.constraints">cont.constraints</code></td>
<td>
<p>a list with constraints to be applied to contributions  (see details).</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_spec.constraints">spec.constraints</code></td>
<td>
<p>a list with constraints to be applied to spectra  (see details).</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_spec.ini">spec.ini</code></td>
<td>
<p>a matrix with initial estimation of the pure components spectra.</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_cont.forced">cont.forced</code></td>
<td>
<p>a matrix which allows to force some of the concentration values (see details).</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_spec.forced">spec.forced</code></td>
<td>
<p>a matrix which allows to force some of the spectra values (see details).</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_cont.solver">cont.solver</code></td>
<td>
<p>which function to use as a solver for resolving of pure components contributions (see detials).</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_spec.solver">spec.solver</code></td>
<td>
<p>which function to use as a solver for resolving of pure components spectra (see detials).</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_max.niter">max.niter</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_tol">tol</code></td>
<td>
<p>tolerance, when explained variance change is smaller than this value, iterations stop.</p>
</td></tr>
<tr><td><code id="mcrals.cal_+3A_verbose">verbose</code></td>
<td>
<p>logical, if TRUE information about every iteration will be shown.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with with following fields:
</p>
<table>
<tr><td><code>ncomp</code></td>
<td>
<p>number of pure components.</p>
</td></tr>
<tr><td><code>resspec</code></td>
<td>
<p>matrix with resolved spectra.</p>
</td></tr>
<tr><td><code>rescont</code></td>
<td>
<p>matrix with resolved contributions.</p>
</td></tr>
<tr><td><code>cont.constraints</code></td>
<td>
<p>list with contribution constraints provided by user.</p>
</td></tr>
<tr><td><code>spec.constraints</code></td>
<td>
<p>list with spectra constraints provided by user.</p>
</td></tr>
<tr><td><code>max.niter</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
</table>

<hr>
<h2 id='mcrals.fcnnls'>Fast combinatorial non-negative least squares</h2><span id='topic+mcrals.fcnnls'></span>

<h3>Description</h3>

<p>Fast combinatorial non-negative least squares
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcrals.fcnnls(
  D,
  A,
  tol = 10 * .Machine$double.eps * as.numeric(sqrt(crossprod(A[, 1]))) * nrow(A)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcrals.fcnnls_+3A_d">D</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="mcrals.fcnnls_+3A_a">A</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="mcrals.fcnnls_+3A_tol">tol</code></td>
<td>
<p>tolerance parameter for algorithm convergence</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes Fast combinatorial NNLS solution for B: D = AB' subject to B &gt;= 0. Implements
the method described in [1].
</p>


<h3>References</h3>

<p>1. Van Benthem, M.H. and Keenan, M.R. (2004), Fast algorithm for the solution of large scale
non-negativity-constrained least squares problems. J. Chemometrics, 18: 441-450.
doi:10.1002/cem.889
</p>

<hr>
<h2 id='mcrals.nnls'>Non-negative least squares</h2><span id='topic+mcrals.nnls'></span>

<h3>Description</h3>

<p>Non-negative least squares
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcrals.nnls(
  D,
  A,
  tol = 10 * .Machine$double.eps * as.numeric(sqrt(crossprod(A[, 1]))) * nrow(A)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcrals.nnls_+3A_d">D</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="mcrals.nnls_+3A_a">A</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="mcrals.nnls_+3A_tol">tol</code></td>
<td>
<p>tolerance parameter for algorithm convergence</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes NNLS solution for B: D = AB' subject to B &gt;= 0. Implements
the active-set based algorithm proposed by Lawson and Hanson [1].
</p>


<h3>References</h3>

<p>1.  Lawson, Charles L.; Hanson, Richard J. (1995). Solving Least Squares Problems. SIAM.
</p>

<hr>
<h2 id='mcrals.ols'>Ordinary least squares</h2><span id='topic+mcrals.ols'></span>

<h3>Description</h3>

<p>Ordinary least squares
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcrals.ols(D, A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcrals.ols_+3A_d">D</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="mcrals.ols_+3A_a">A</code></td>
<td>
<p>a matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes OLS solution for D = AB' (or D' = AB'), where D, A are known
</p>

<hr>
<h2 id='mcrpure'>Multivariate curve resolution based on pure variables</h2><span id='topic+mcrpure'></span>

<h3>Description</h3>

<p><code>mcrpure</code> allows to resolve spectroscopic data to linear combination of individual spectra
and contributions using the pure variables approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcrpure(
  x,
  ncomp,
  purevars = NULL,
  offset = 0.05,
  exclrows = NULL,
  exclcols = NULL,
  info = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcrpure_+3A_x">x</code></td>
<td>
<p>spectra of mixtures (matrix or data frame).</p>
</td></tr>
<tr><td><code id="mcrpure_+3A_ncomp">ncomp</code></td>
<td>
<p>maximum number of components to calculate.</p>
</td></tr>
<tr><td><code id="mcrpure_+3A_purevars">purevars</code></td>
<td>
<p>vector with indices for pure variables (optional, if you want to provide the variables directly).</p>
</td></tr>
<tr><td><code id="mcrpure_+3A_offset">offset</code></td>
<td>
<p>offset for correcting noise in computing maximum angles (should be value within [0, 1)).</p>
</td></tr>
<tr><td><code id="mcrpure_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values).</p>
</td></tr>
<tr><td><code id="mcrpure_+3A_exclcols">exclcols</code></td>
<td>
<p>columns to be excluded from calculations (numbers, names or vector with logical values).</p>
</td></tr>
<tr><td><code id="mcrpure_+3A_info">info</code></td>
<td>
<p>a short text with description of the case (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method estimates purity of each variable and then uses the purest ones to decompose the
spectral data into spectra ('resspec') and contributions ('rescont') of individual
chemical components by ordinary least squares.
</p>
<p>The pure variabes are identified using stepwise maximum angle calculations and described in
detail in [1]. So the purity of a spectral variable (wavelength, wavenumber) is actually an
angle (measured in degrees) between the variable and vector of ones for the first component;
and between the variable and space formed by previously found pure variables for the other
components.
</p>


<h3>Value</h3>

<p>Returns an object of <code><a href="#topic+mcrpure">mcrpure</a></code> class with the following fields:
</p>
<table>
<tr><td><code>resspec</code></td>
<td>
<p>matrix with resolved spectra.</p>
</td></tr>
<tr><td><code>rescont</code></td>
<td>
<p>matrix with resolved contributions.</p>
</td></tr>
<tr><td><code>purevars</code></td>
<td>
<p>indices of the selected pure variables.</p>
</td></tr>
<tr><td><code>purevals</code></td>
<td>
<p>purity values for the selected pure variables.</p>
</td></tr>
<tr><td><code>purityspec</code></td>
<td>
<p>purity spectra (matrix with purity values for each variable and component).</p>
</td></tr>
<tr><td><code>expvar</code></td>
<td>
<p>vector with explained variance for each component (in percent).</p>
</td></tr>
<tr><td><code>cumexpvar</code></td>
<td>
<p>vector with cumulative explained variance for each component (in percent).</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p>offset value used to compute the purity</p>
</td></tr>
<tr><td><code>ncomp</code></td>
<td>
<p>number of resolved components</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information about the model, provided by user when build the model.</p>
</td></tr>
</table>
<p>More details and examples can be found in the Bookdown tutorial.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>References</h3>

<p>1. Willem Windig, Neal B. Gallagher, Jeremy M. Shaver, Barry M. Wise. A new approach for
interactive self-modeling mixture analysis. Chemometrics and Intelligent Laboratory Systems,
77 (2005) 8596. DOI: 10.1016/j.chemolab.2004.06.009
</p>


<h3>See Also</h3>

<p>Methods for <code>mcrpure</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>summary.mcrpure</code> </td><td style="text-align: left;"> shows some statistics for the case.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+unmix.mcrpure">unmix.mcrpure</a></code> </td><td style="text-align: left;"> makes unmixing of new set of spectra.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+predict.mcrpure">predict.mcrpure</a></code> </td><td style="text-align: left;"> computes contributions by projection of new spectra to
   the resolved ones.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Plotting methods for <code>mcrpure</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotPurity.mcrpure">plotPurity.mcrpure</a></code> </td><td style="text-align: left;"> shows plot with maximum purity of each component.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotPuritySpectra.mcrpure">plotPuritySpectra.mcrpure</a></code> </td><td style="text-align: left;"> shows plot with purity spectra.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotSpectra.mcr">plotSpectra.mcr</a></code> </td><td style="text-align: left;"> shows plot with resolved spectra.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotContributions.mcr">plotContributions.mcr</a></code> </td><td style="text-align: left;"> shows plot with resolved contributions.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotVariance.mcr">plotVariance.mcr</a></code> </td><td style="text-align: left;"> shows plot with explained variance.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotCumVariance.mcr">plotCumVariance.mcr</a></code> </td><td style="text-align: left;"> shows plot with cumulative explained variance.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>library(mdatools)

# resolve mixture of carbonhydrates Raman spectra

data(carbs)
m = mcrpure(carbs$D, ncomp = 3)

# examples for purity spectra plot (you can select which components to show)
par(mfrow = c(2, 1))
plotPuritySpectra(m)
plotPuritySpectra(m, comp = 2:3)

# you can do it manually and combine e.g. with original spectra
par(mfrow = c(1, 1))
mdaplotg(
   list(
      "spectra" = prep.norm(carbs$D, "area"),
      "purity" = prep.norm(mda.subset(mda.t(m$resspec), 1), "area")
   ), col = c("gray", "red"), type = "l"
)

# show the maximum purity for each component
par(mfrow = c(1, 1))
plotPurity(m)

# plot cumulative and individual explained variance
par(mfrow = c(1, 2))
plotVariance(m)
plotCumVariance(m)

# plot resolved spectra (all of them or individually)
par(mfrow = c(2, 1))
plotSpectra(m)
plotSpectra(m, comp = 2:3)

# plot resolved contributions (all of them or individually)
par(mfrow = c(2, 1))
plotContributions(m)
plotContributions(m, comp = 2:3)

# of course you can do this manually as well, e.g. show original
# and resolved spectra
par(mfrow = c(1, 1))
mdaplotg(
   list(
      "original" = prep.norm(carbs$D, "area"),
      "resolved" = prep.norm(mda.subset(mda.t(m$resspec), 1), "area")
   ), col = c("gray", "red"), type = "l"
)

# in case if you have reference spectra of components you can compare them with
# the resolved ones:
par(mfrow = c(3, 1))
for (i in 1:3) {
   mdaplotg(
      list(
         "pure" = prep.norm(mda.subset(mda.t(carbs$S), 1), "area"),
         "resolved" = prep.norm(mda.subset(mda.t(m$resspec), 1), "area")
      ), col = c("gray", "red"), type = "l", lwd = c(3, 1)
   )
}

# See bookdown tutorial for more details.

</code></pre>

<hr>
<h2 id='mda.cbind'>A wrapper for cbind() method with proper set of attributes</h2><span id='topic+mda.cbind'></span>

<h3>Description</h3>

<p>A wrapper for cbind() method with proper set of attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.cbind(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.cbind_+3A_...">...</code></td>
<td>
<p>datasets (data frames or matrices) to bind</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the merged datasets
</p>

<hr>
<h2 id='mda.data2im'>Convert data matrix to an image</h2><span id='topic+mda.data2im'></span>

<h3>Description</h3>

<p>Convert data matrix to an image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.data2im(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.data2im_+3A_data">data</code></td>
<td>
<p>data matrix</p>
</td></tr>
</table>

<hr>
<h2 id='mda.df2mat'>Convert data frame to a matrix</h2><span id='topic+mda.df2mat'></span>

<h3>Description</h3>

<p>The function converts data frame to a numeric matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.df2mat(x, full = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.df2mat_+3A_x">x</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="mda.df2mat_+3A_full">full</code></td>
<td>
<p>logical, if TRUE number of dummy variables for a factor will be the same as number of levels,
otherwise by one smaller</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If one or several columns of the data frame are factors they will be converted to a set of dummy
variables. If any columns/rows were hidden in the data frame they will remain hidden in the
matrix. If there are factors among the hidden columns, the corresponding dummy variables will be
hidden as well.
</p>
<p>All other attributes (names, axis names, etc.) will be inherited.
</p>


<h3>Value</h3>

<p>a numeric matrix
</p>

<hr>
<h2 id='mda.exclcols'>Exclude/hide columns in a dataset</h2><span id='topic+mda.exclcols'></span>

<h3>Description</h3>

<p>Exclude/hide columns in a dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.exclcols(x, ind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.exclcols_+3A_x">x</code></td>
<td>
<p>dataset (data frame or matrix).</p>
</td></tr>
<tr><td><code id="mda.exclcols_+3A_ind">ind</code></td>
<td>
<p>indices of columns to exclude (numbers, names or logical values)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method assign attribute 'exclcols', which contains number of columns, which should be
excluded/hidden from calculations and plots (without removing them physically). The argument
<code>ind</code> should contain column numbers (excluding already hidden), names or logical values.
</p>


<h3>Value</h3>

<p>dataset with excluded columns
</p>

<hr>
<h2 id='mda.exclrows'>Exclude/hide rows in a dataset</h2><span id='topic+mda.exclrows'></span>

<h3>Description</h3>

<p>Exclude/hide rows in a dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.exclrows(x, ind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.exclrows_+3A_x">x</code></td>
<td>
<p>dataset (data frame or matrix).</p>
</td></tr>
<tr><td><code id="mda.exclrows_+3A_ind">ind</code></td>
<td>
<p>indices of rows to exclude (numbers, names or logical values)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method assign attribute 'exclrows', which contains number of rows, which should be
excluded/hidden from calculations and plots (without removing them physically). The
argument <code>ind</code> should contain rows numbers (excluding already hidden), names or logical
values.
</p>


<h3>Value</h3>

<p>dataset with excluded rows
</p>

<hr>
<h2 id='mda.getattr'>Get data attributes</h2><span id='topic+mda.getattr'></span>

<h3>Description</h3>

<p>Returns a list with important data attributes (name, xvalues, excluded rows and columns, etc.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.getattr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.getattr_+3A_x">x</code></td>
<td>
<p>a dataset</p>
</td></tr>
</table>

<hr>
<h2 id='mda.getexclind'>Get indices of excluded rows or columns</h2><span id='topic+mda.getexclind'></span>

<h3>Description</h3>

<p>Get indices of excluded rows or columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.getexclind(excl, names, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.getexclind_+3A_excl">excl</code></td>
<td>
<p>vector with excluded values (logical, text or numbers)</p>
</td></tr>
<tr><td><code id="mda.getexclind_+3A_names">names</code></td>
<td>
<p>vector with names for rows or columns</p>
</td></tr>
<tr><td><code id="mda.getexclind_+3A_n">n</code></td>
<td>
<p>number of rows or columns</p>
</td></tr>
</table>

<hr>
<h2 id='mda.im2data'>Convert image to data matrix</h2><span id='topic+mda.im2data'></span>

<h3>Description</h3>

<p>Convert image to data matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.im2data(img)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.im2data_+3A_img">img</code></td>
<td>
<p>an image (3-way array)</p>
</td></tr>
</table>

<hr>
<h2 id='mda.inclcols'>Include/unhide the excluded columns</h2><span id='topic+mda.inclcols'></span>

<h3>Description</h3>

<p>include colmns specified by user (earlier excluded using mda.exclcols)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.inclcols(x, ind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.inclcols_+3A_x">x</code></td>
<td>
<p>dataset (data frame or matrix).</p>
</td></tr>
<tr><td><code id="mda.inclcols_+3A_ind">ind</code></td>
<td>
<p>number of excluded columns to include</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataset with included columns.
</p>

<hr>
<h2 id='mda.inclrows'>include/unhide the excluded rows</h2><span id='topic+mda.inclrows'></span>

<h3>Description</h3>

<p>include rows specified by user (earlier excluded using mda.exclrows)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.inclrows(x, ind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.inclrows_+3A_x">x</code></td>
<td>
<p>dataset (data frame or matrix).</p>
</td></tr>
<tr><td><code id="mda.inclrows_+3A_ind">ind</code></td>
<td>
<p>number of excluded rows to include</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataset with included rows
</p>

<hr>
<h2 id='mda.purge'>Removes excluded (hidden) rows and colmns from data</h2><span id='topic+mda.purge'></span>

<h3>Description</h3>

<p>Removes excluded (hidden) rows and colmns from data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.purge(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.purge_+3A_data">data</code></td>
<td>
<p>data frame or matrix with data</p>
</td></tr>
</table>

<hr>
<h2 id='mda.purgeCols'>Removes excluded (hidden) colmns from data</h2><span id='topic+mda.purgeCols'></span>

<h3>Description</h3>

<p>Removes excluded (hidden) colmns from data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.purgeCols(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.purgeCols_+3A_data">data</code></td>
<td>
<p>data frame or matrix with data</p>
</td></tr>
</table>

<hr>
<h2 id='mda.purgeRows'>Removes excluded (hidden) rows from data</h2><span id='topic+mda.purgeRows'></span>

<h3>Description</h3>

<p>Removes excluded (hidden) rows from data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.purgeRows(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.purgeRows_+3A_data">data</code></td>
<td>
<p>data frame or matrix with data</p>
</td></tr>
</table>

<hr>
<h2 id='mda.rbind'>A wrapper for rbind() method with proper set of attributes</h2><span id='topic+mda.rbind'></span>

<h3>Description</h3>

<p>A wrapper for rbind() method with proper set of attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.rbind(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.rbind_+3A_...">...</code></td>
<td>
<p>datasets (data frames or matrices) to bind</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the merged datasets
</p>

<hr>
<h2 id='mda.setattr'>Set data attributes</h2><span id='topic+mda.setattr'></span>

<h3>Description</h3>

<p>Set most important data attributes (name, xvalues, excluded rows and columns, etc.) to a dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.setattr(x, attrs, type = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.setattr_+3A_x">x</code></td>
<td>
<p>a dataset</p>
</td></tr>
<tr><td><code id="mda.setattr_+3A_attrs">attrs</code></td>
<td>
<p>list with attributes</p>
</td></tr>
<tr><td><code id="mda.setattr_+3A_type">type</code></td>
<td>
<p>a text variable telling which attributes to set ('all', 'row', 'col')</p>
</td></tr>
</table>

<hr>
<h2 id='mda.setimbg'>Remove background pixels from image data</h2><span id='topic+mda.setimbg'></span>

<h3>Description</h3>

<p>Remove background pixels from image data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.setimbg(data, bgpixels)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.setimbg_+3A_data">data</code></td>
<td>
<p>a matrix with image data</p>
</td></tr>
<tr><td><code id="mda.setimbg_+3A_bgpixels">bgpixels</code></td>
<td>
<p>vector with indices or logical values corresponding to background pixels</p>
</td></tr>
</table>

<hr>
<h2 id='mda.show'>Wrapper for show() method</h2><span id='topic+mda.show'></span>

<h3>Description</h3>

<p>Wrapper for show() method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.show(x, n = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.show_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="mda.show_+3A_n">n</code></td>
<td>
<p>number of rows to show</p>
</td></tr>
</table>

<hr>
<h2 id='mda.subset'>A wrapper for subset() method with proper set of attributed</h2><span id='topic+mda.subset'></span>

<h3>Description</h3>

<p>A wrapper for subset() method with proper set of attributed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.subset(x, subset = NULL, select = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.subset_+3A_x">x</code></td>
<td>
<p>dataset (data frame or matrix)</p>
</td></tr>
<tr><td><code id="mda.subset_+3A_subset">subset</code></td>
<td>
<p>which rows to keep (indices, names or logical values)</p>
</td></tr>
<tr><td><code id="mda.subset_+3A_select">select</code></td>
<td>
<p>which columns to select (indices, names or logical values)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method works similar to the standard <code>subset()</code> method, with minor differences. First
of all it keeps (and correct, if necessary) all important attributes. If only columns are
selected, it keeps all excluded rows as excluded. If only rows are selected, it keeps all
excluded columns. If both rows and columns are selected it removed all excluded elements first
and then makes the subset.
</p>
<p>The parameters <code>subset</code> and <code>select</code> may each be a vector with numbers or nanes
without excluded elements, or a logical expression.
</p>


<h3>Value</h3>

<p>a data with the subset
</p>

<hr>
<h2 id='mda.t'>A wrapper for t() method with proper set of attributes</h2><span id='topic+mda.t'></span>

<h3>Description</h3>

<p>A wrapper for t() method with proper set of attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mda.t(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mda.t_+3A_x">x</code></td>
<td>
<p>dataset (data frames or matrices) to transpose</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the transposed dataset
</p>

<hr>
<h2 id='mdaplot'>Plotting function for a single set of objects</h2><span id='topic+mdaplot'></span>

<h3>Description</h3>

<p><code>mdaplot</code> is used to make different kinds of plot for one set of data objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot(
  data = NULL,
  ps = NULL,
  type = "p",
  pch = 16,
  col = NULL,
  bg = par("bg"),
  bwd = 0.8,
  border = NA,
  lty = 1,
  lwd = 1,
  cex = 1,
  cgroup = NULL,
  xlim = NULL,
  ylim = NULL,
  colmap = "default",
  labels = NULL,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  show.labels = FALSE,
  show.colorbar = !is.null(cgroup),
  show.lines = FALSE,
  show.grid = TRUE,
  grid.lwd = 0.5,
  grid.col = "lightgray",
  show.axes = TRUE,
  xticks = NULL,
  yticks = NULL,
  xticklabels = NULL,
  yticklabels = NULL,
  xlas = 0,
  ylas = 0,
  lab.col = "darkgray",
  lab.cex = 0.65,
  show.excluded = FALSE,
  col.excluded = "#C0C0C0",
  nbins = 60,
  force.x.values = NA,
  opacity = 1,
  pch.colinv = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot_+3A_data">data</code></td>
<td>
<p>a vector, matrix or a data.frame with data values.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object, if NULL will be created based on the provided data values</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_type">type</code></td>
<td>
<p>type of the plot (&quot;p&quot;, &quot;d&quot;, &quot;l&quot;, &quot;b&quot;, &quot;h&quot;, &quot;e&quot;).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_pch">pch</code></td>
<td>
<p>a character for markers (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_col">col</code></td>
<td>
<p>a color for markers or lines (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_bg">bg</code></td>
<td>
<p>background color for scatter plots wich 'pch=21:25'.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_bwd">bwd</code></td>
<td>
<p>a width of a bar as a percent of a maximum space available for each bar.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_border">border</code></td>
<td>
<p>color for border of bars (if barplot is used)</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_cex">cex</code></td>
<td>
<p>scale factor for the marker</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_cgroup">cgroup</code></td>
<td>
<p>a vector with values to use for make color groups.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_xlim">xlim</code></td>
<td>
<p>limits for the x axis (if NULL, will be calculated automatically).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_ylim">ylim</code></td>
<td>
<p>limits for the y axis (if NULL, will be calculated automatically).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_colmap">colmap</code></td>
<td>
<p>a colormap to use for coloring the plot items.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_labels">labels</code></td>
<td>
<p>a vector with text labels for data points or one of the following: &quot;names&quot;, &quot;indices&quot;, &quot;values&quot;.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_main">main</code></td>
<td>
<p>an overall title for the plot (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the data objects.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_show.colorbar">show.colorbar</code></td>
<td>
<p>logical, show or not colorbar legend if color grouping is on.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_show.lines">show.lines</code></td>
<td>
<p>vector with two coordinates (x, y) to show horizontal and vertical line cross the point.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_show.grid">show.grid</code></td>
<td>
<p>logical, show or not a grid for the plot.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_grid.lwd">grid.lwd</code></td>
<td>
<p>line thinckness (width) for the grid.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_grid.col">grid.col</code></td>
<td>
<p>line color for the grid.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, make a normal plot or show only elements (markers, lines, bars) without axes.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_xticks">xticks</code></td>
<td>
<p>values for x ticks.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_yticks">yticks</code></td>
<td>
<p>values for y ticks.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_xticklabels">xticklabels</code></td>
<td>
<p>labels for x ticks.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_yticklabels">yticklabels</code></td>
<td>
<p>labels for y ticks.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_xlas">xlas</code></td>
<td>
<p>orientation of xticklabels.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_ylas">ylas</code></td>
<td>
<p>orientation of yticklabels.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_lab.col">lab.col</code></td>
<td>
<p>color for data point labels.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_lab.cex">lab.cex</code></td>
<td>
<p>size for data point labels.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, show or hide rows marked as excluded (attribute 'exclrows').</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_col.excluded">col.excluded</code></td>
<td>
<p>color for the excluded objects (rows).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_nbins">nbins</code></td>
<td>
<p>if scatter density plot is shown, number of segments to split the plot area into.
(see also ?smoothScatter)</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_force.x.values">force.x.values</code></td>
<td>
<p>vector with corrected x-values for a bar plot (do not specify this manually).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_opacity">opacity</code></td>
<td>
<p>opacity for plot colors (value between 0 and 1).</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_pch.colinv">pch.colinv</code></td>
<td>
<p>allows to swap values for 'col' and 'bg' for scatter plots with 'pch' valyes from 21 to 25.</p>
</td></tr>
<tr><td><code id="mdaplot_+3A_...">...</code></td>
<td>
<p>other plotting arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most of the parameters are similar to what are used with standard <code>plot</code> function. The
differences are described below.
</p>
<p>The function makes a plot of one set of objects. It can be a set of points (scatter plot),
bars, lines, scatter-lines, errorbars og an image. The data is organized as a data frame,
matrix or vector. For scatter and only first two columns will be used, for bar plot only
values from the first row. It is recommended to use <code><a href="#topic+mda.subset">mda.subset</a></code> method if plot
should be made only for a subset of the data, especially if you have any excluded rows or
columns or other special attributed, described in the Bookdown tutorial.
</p>
<p>If data is a data frame and contains one or more factors, they will be converted to a dummy
variables (using function <code><a href="#topic+mda.df2mat">mda.df2mat</a></code>) and appears at the end (last columns) if
line or bar plot is selected.
</p>
<p>The function allows to colorize lines and points according to values of a parameter
<code>cgroup</code>. The parameter must be a vector with the same elements as number of objects (rows)
in the data. The values are divided into up to eight intervals and for each interval a
particular color from a selected color scheme is assigned. Parameter <code>show.colorbar</code>
allows to turn off and on a color bar legend for this option.
</p>
<p>The used color scheme is defined by the <code>colmap</code> parameter. The default scheme is based
on color brewer (colorbrewer2.org) diverging scheme with eight colors. There is also a gray
scheme (<code>colmap = "gray"</code>) and user can define its own just by specifing the needed
sequence of colors (e.g. <code>colmap = c("red", "yellow", "green")</code>, two colors is minimum).
The scheme will then be generated automatically as a gradient among the colors.
</p>
<p>Besides that the function allows to change tick values and corresponding tick labels for x and
y axis, see Bookdown tutorial for more details.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mdaplotg">mdaplotg</a></code> - to make plots for several sets of data objects (groups of objects).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See all examples in the tutorial.

</code></pre>

<hr>
<h2 id='mdaplot.areColors'>Check color values</h2><span id='topic+mdaplot.areColors'></span>

<h3>Description</h3>

<p>Checks if elements of argument are valid color values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.areColors(palette)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.areColors_+3A_palette">palette</code></td>
<td>
<p>vector with possibly color values (names, RGB, etc.)</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplot.formatValues'>Format vector with numeric values</h2><span id='topic+mdaplot.formatValues'></span>

<h3>Description</h3>

<p>Format vector with values, so only significant decimal numbers are left.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.formatValues(data, round.only = FALSE, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.formatValues_+3A_data">data</code></td>
<td>
<p>vector or matrix with values</p>
</td></tr>
<tr><td><code id="mdaplot.formatValues_+3A_round.only">round.only</code></td>
<td>
<p>logical, do formatting or only round the values</p>
</td></tr>
<tr><td><code id="mdaplot.formatValues_+3A_digits">digits</code></td>
<td>
<p>how many significant digits take into account</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function takes into accound difference between values and the values themselves.
</p>


<h3>Value</h3>

<p>matrix with formatted values
</p>

<hr>
<h2 id='mdaplot.getColors'>Color values for plot elements</h2><span id='topic+mdaplot.getColors'></span>

<h3>Description</h3>

<p>Generate vector with color values for plot objects (lines, points, bars), depending
on number of groups for the objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.getColors(
  ngroups = NULL,
  cgroup = NULL,
  colmap = "default",
  opacity = 1,
  maxsplits = 64
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.getColors_+3A_ngroups">ngroups</code></td>
<td>
<p>number of colors to create.</p>
</td></tr>
<tr><td><code id="mdaplot.getColors_+3A_cgroup">cgroup</code></td>
<td>
<p>vector of values, used for color grouping of plot points or lines.</p>
</td></tr>
<tr><td><code id="mdaplot.getColors_+3A_colmap">colmap</code></td>
<td>
<p>which colormap to use ('default', 'gray', 'old', or user defined in form c('col1', 'col2', ...)).</p>
</td></tr>
<tr><td><code id="mdaplot.getColors_+3A_opacity">opacity</code></td>
<td>
<p>opacity for colors (between 0 and 1)</p>
</td></tr>
<tr><td><code id="mdaplot.getColors_+3A_maxsplits">maxsplits</code></td>
<td>
<p>if contenuous values are used for color gruping - how many groups to create?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns vector with generated color values
</p>

<hr>
<h2 id='mdaplot.getXAxisLim'>Calculate limits for x-axis.</h2><span id='topic+mdaplot.getXAxisLim'></span>

<h3>Description</h3>

<p>Calculates limits for x-axis depending on data values that have to be plotted,
extra plot elements that have to be shown and margins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.getXAxisLim(
  ps,
  xlim,
  show.labels = FALSE,
  show.lines = FALSE,
  show.excluded = FALSE,
  bwd = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.getXAxisLim_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object.</p>
</td></tr>
<tr><td><code id="mdaplot.getXAxisLim_+3A_xlim">xlim</code></td>
<td>
<p>limits provided by user</p>
</td></tr>
<tr><td><code id="mdaplot.getXAxisLim_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, will data labels be shown on the plot</p>
</td></tr>
<tr><td><code id="mdaplot.getXAxisLim_+3A_show.lines">show.lines</code></td>
<td>
<p>logical or numeric with line coordinates to be shown on the plot.</p>
</td></tr>
<tr><td><code id="mdaplot.getXAxisLim_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, will excluded values be shown on the plot</p>
</td></tr>
<tr><td><code id="mdaplot.getXAxisLim_+3A_bwd">bwd</code></td>
<td>
<p>if limits are computed for bar plot, this is a bar width (otherwise NULL)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector with two limits.
</p>

<hr>
<h2 id='mdaplot.getXTickLabels'>Prepare xticklabels for plot</h2><span id='topic+mdaplot.getXTickLabels'></span>

<h3>Description</h3>

<p>Prepare xticklabels for plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.getXTickLabels(xticklabels, xticks, excluded_cols)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.getXTickLabels_+3A_xticklabels">xticklabels</code></td>
<td>
<p>xticklables provided by user (if any)</p>
</td></tr>
<tr><td><code id="mdaplot.getXTickLabels_+3A_xticks">xticks</code></td>
<td>
<p>xticks (provided or computed)</p>
</td></tr>
<tr><td><code id="mdaplot.getXTickLabels_+3A_excluded_cols">excluded_cols</code></td>
<td>
<p>columns excluded from plot data (if any)</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplot.getXTicks'>Prepare xticks for plot</h2><span id='topic+mdaplot.getXTicks'></span>

<h3>Description</h3>

<p>Prepare xticks for plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.getXTicks(xticks, xlim, x_values = NULL, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.getXTicks_+3A_xticks">xticks</code></td>
<td>
<p>xticks provided by user (if any)</p>
</td></tr>
<tr><td><code id="mdaplot.getXTicks_+3A_xlim">xlim</code></td>
<td>
<p>limits for x axis</p>
</td></tr>
<tr><td><code id="mdaplot.getXTicks_+3A_x_values">x_values</code></td>
<td>
<p>x values for the plot data object</p>
</td></tr>
<tr><td><code id="mdaplot.getXTicks_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplot.getYAxisLim'>Calculate limits for y-axis.</h2><span id='topic+mdaplot.getYAxisLim'></span>

<h3>Description</h3>

<p>Calculates limits for y-axis depending on data values that have to be plotted,
extra plot elements that have to be shown and margins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.getYAxisLim(
  ps,
  ylim,
  show.lines = FALSE,
  show.excluded = FALSE,
  show.labels = FALSE,
  show.colorbar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.getYAxisLim_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object.</p>
</td></tr>
<tr><td><code id="mdaplot.getYAxisLim_+3A_ylim">ylim</code></td>
<td>
<p>limits provided by user</p>
</td></tr>
<tr><td><code id="mdaplot.getYAxisLim_+3A_show.lines">show.lines</code></td>
<td>
<p>logical or numeric with line coordinates to be shown on the plot.</p>
</td></tr>
<tr><td><code id="mdaplot.getYAxisLim_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, will excluded values be shown on the plot</p>
</td></tr>
<tr><td><code id="mdaplot.getYAxisLim_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, will data labels be shown on the plot</p>
</td></tr>
<tr><td><code id="mdaplot.getYAxisLim_+3A_show.colorbar">show.colorbar</code></td>
<td>
<p>logical, will colorbar be shown on the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector with two limits.
</p>

<hr>
<h2 id='mdaplot.getYTickLabels'>Prepare yticklabels for plot</h2><span id='topic+mdaplot.getYTickLabels'></span>

<h3>Description</h3>

<p>Prepare yticklabels for plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.getYTickLabels(yticklabels, yticks, excluded_rows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.getYTickLabels_+3A_yticklabels">yticklabels</code></td>
<td>
<p>yticklables provided by user (if any)</p>
</td></tr>
<tr><td><code id="mdaplot.getYTickLabels_+3A_yticks">yticks</code></td>
<td>
<p>yticks (provided or computed)</p>
</td></tr>
<tr><td><code id="mdaplot.getYTickLabels_+3A_excluded_rows">excluded_rows</code></td>
<td>
<p>rows excluded from plot data (if any)</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplot.getYTicks'>Prepare yticks for plot</h2><span id='topic+mdaplot.getYTicks'></span>

<h3>Description</h3>

<p>Prepare yticks for plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.getYTicks(yticks, ylim, y_values = NULL, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.getYTicks_+3A_yticks">yticks</code></td>
<td>
<p>yticks provided by user (if any)</p>
</td></tr>
<tr><td><code id="mdaplot.getYTicks_+3A_ylim">ylim</code></td>
<td>
<p>limits for y axis</p>
</td></tr>
<tr><td><code id="mdaplot.getYTicks_+3A_y_values">y_values</code></td>
<td>
<p>y values for the plot data object</p>
</td></tr>
<tr><td><code id="mdaplot.getYTicks_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplot.plotAxes'>Create axes plane</h2><span id='topic+mdaplot.plotAxes'></span>

<h3>Description</h3>

<p>Creates an empty axes plane for given parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.plotAxes(
  xticklabels = NULL,
  yticklabels = NULL,
  xlim = xlim,
  ylim = ylim,
  xticks = NULL,
  yticks = NULL,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  xlas = 0,
  ylas = 0,
  show.grid = TRUE,
  grid.lwd = 0.5,
  grid.col = "lightgray"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.plotAxes_+3A_xticklabels">xticklabels</code></td>
<td>
<p>labels for x ticks</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_yticklabels">yticklabels</code></td>
<td>
<p>labels for y ticks</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_xlim">xlim</code></td>
<td>
<p>vector with limits for x axis</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_ylim">ylim</code></td>
<td>
<p>vector with limits for y axis</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_xticks">xticks</code></td>
<td>
<p>values for x ticks</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_yticks">yticks</code></td>
<td>
<p>values for y ticks</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_xlab">xlab</code></td>
<td>
<p>label for x axis</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_xlas">xlas</code></td>
<td>
<p>orientation of xticklabels</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_ylas">ylas</code></td>
<td>
<p>orientation of yticklabels</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_show.grid">show.grid</code></td>
<td>
<p>logical, show or not axes grid</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_grid.lwd">grid.lwd</code></td>
<td>
<p>line thinckness (width) for the grid</p>
</td></tr>
<tr><td><code id="mdaplot.plotAxes_+3A_grid.col">grid.col</code></td>
<td>
<p>line color for the grid</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplot.prepareColors'>Prepare colors based on palette and opacity value</h2><span id='topic+mdaplot.prepareColors'></span>

<h3>Description</h3>

<p>Prepare colors based on palette and opacity value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.prepareColors(palette, ncolors, opacity)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.prepareColors_+3A_palette">palette</code></td>
<td>
<p>vector with main colors for current pallette</p>
</td></tr>
<tr><td><code id="mdaplot.prepareColors_+3A_ncolors">ncolors</code></td>
<td>
<p>number of colors to generate</p>
</td></tr>
<tr><td><code id="mdaplot.prepareColors_+3A_opacity">opacity</code></td>
<td>
<p>opacity for the colors (one value or individual for each color)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with colors
</p>

<hr>
<h2 id='mdaplot.showColorbar'>Plot colorbar</h2><span id='topic+mdaplot.showColorbar'></span>

<h3>Description</h3>

<p>Shows a colorbar if plot has color grouping of elements (points or lines).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.showColorbar(
  cgroup,
  colmap = "default",
  lab.col = "darkgray",
  lab.cex = 0.65
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.showColorbar_+3A_cgroup">cgroup</code></td>
<td>
<p>a vector with values used to make color grouping of the elements</p>
</td></tr>
<tr><td><code id="mdaplot.showColorbar_+3A_colmap">colmap</code></td>
<td>
<p>a colormap to be used for color generation</p>
</td></tr>
<tr><td><code id="mdaplot.showColorbar_+3A_lab.col">lab.col</code></td>
<td>
<p>color for legend labels</p>
</td></tr>
<tr><td><code id="mdaplot.showColorbar_+3A_lab.cex">lab.cex</code></td>
<td>
<p>size for legend labels</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplot.showLines'>Plot lines</h2><span id='topic+mdaplot.showLines'></span>

<h3>Description</h3>

<p>Shows horisontal and vertical lines on a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplot.showLines(point, lty = 2, lwd = 0.75, col = rgb(0.2, 0.2, 0.2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplot.showLines_+3A_point">point</code></td>
<td>
<p>vector with two values: x coordinate for vertical point y for horizontal</p>
</td></tr>
<tr><td><code id="mdaplot.showLines_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="mdaplot.showLines_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="mdaplot.showLines_+3A_col">col</code></td>
<td>
<p>color of lines</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If it is needed to show only one line, the other coordinate shall be set to NA.
</p>

<hr>
<h2 id='mdaplotg'>Plotting function for several plot series</h2><span id='topic+mdaplotg'></span>

<h3>Description</h3>

<p><code>mdaplotg</code> is used to make different kinds of plots or their combination for several sets
of objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplotg(
  data,
  groupby = NULL,
  type = "p",
  pch = 16,
  lty = 1,
  lwd = 1,
  cex = 1,
  col = NULL,
  bwd = 0.8,
  legend = NULL,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  labels = NULL,
  ylim = NULL,
  xlim = NULL,
  colmap = "default",
  legend.position = "topright",
  show.legend = TRUE,
  show.labels = FALSE,
  show.lines = FALSE,
  show.grid = TRUE,
  grid.lwd = 0.5,
  grid.col = "lightgray",
  xticks = NULL,
  xticklabels = NULL,
  yticks = NULL,
  yticklabels = NULL,
  show.excluded = FALSE,
  lab.col = "darkgray",
  lab.cex = 0.65,
  xlas = 1,
  ylas = 1,
  opacity = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplotg_+3A_data">data</code></td>
<td>
<p>a matrix, data frame or a list with data values (see details below).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_groupby">groupby</code></td>
<td>
<p>one or several factors used to create groups of data matrix rows (works if data is a matrix)</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_type">type</code></td>
<td>
<p>type of the plot ('p', 'l', 'b', 'h', 'e').</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_pch">pch</code></td>
<td>
<p>a character for markers (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_lty">lty</code></td>
<td>
<p>the line type (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_lwd">lwd</code></td>
<td>
<p>the line width (thickness) (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_cex">cex</code></td>
<td>
<p>the cex factor for the markers (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_col">col</code></td>
<td>
<p>colors for the plot series</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_bwd">bwd</code></td>
<td>
<p>a width of a bar as a percent of a maximum space available for each bar.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_legend">legend</code></td>
<td>
<p>a vector with legend elements (if NULL, no legend will be shown).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_main">main</code></td>
<td>
<p>an overall title for the plot (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_labels">labels</code></td>
<td>
<p>what to use as labels ('names' - row names, 'indices' - row indices, 'values' - values).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_ylim">ylim</code></td>
<td>
<p>limits for the y axis (if NULL, will be calculated automatically).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_xlim">xlim</code></td>
<td>
<p>limits for the x axis (if NULL, will be calculated automatically).</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_colmap">colmap</code></td>
<td>
<p>a colormap to generate colors if <code>col</code> is not provided</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_legend.position">legend.position</code></td>
<td>
<p>position of the legend ('topleft', 'topright', 'top', 'bottomleft', 'bottomright', 'bottom').</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not legend for the data objects.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the data objects.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_show.lines">show.lines</code></td>
<td>
<p>vector with two coordinates (x, y) to show horizontal and vertical line cross the point.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_show.grid">show.grid</code></td>
<td>
<p>logical, show or not a grid for the plot.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_grid.lwd">grid.lwd</code></td>
<td>
<p>line thinckness (width) for the grid</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_grid.col">grid.col</code></td>
<td>
<p>line color for the grid</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_xticks">xticks</code></td>
<td>
<p>tick values for x axis.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_xticklabels">xticklabels</code></td>
<td>
<p>labels for x ticks.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_yticks">yticks</code></td>
<td>
<p>tick values for y axis.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_yticklabels">yticklabels</code></td>
<td>
<p>labels for y ticks.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, show or hide rows marked as excluded (attribute 'exclrows')</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_lab.col">lab.col</code></td>
<td>
<p>color for data point labels.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_lab.cex">lab.cex</code></td>
<td>
<p>size for data point labels.</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_xlas">xlas</code></td>
<td>
<p>orientation of xticklabels</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_ylas">ylas</code></td>
<td>
<p>orientation of yticklabels</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_opacity">opacity</code></td>
<td>
<p>opacity for plot colors (value between 0 and 1)</p>
</td></tr>
<tr><td><code id="mdaplotg_+3A_...">...</code></td>
<td>
<p>other plotting arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>mdaplotg</code> function is used to make a plot with several sets of objects. Simply
speaking, use it when you need a plot with legend. For example to show line plot with spectra
from calibration and test set, scatter plot with height and weight values for women and men, and
so on.
</p>
<p>Most of the parameters are similar to <code><a href="#topic+mdaplot">mdaplot</a></code>, the difference is described below.
</p>
<p>The data should be organized as a list, every item is a matrix (or data frame) with data for one
set of objects. Alternatively you can provide data as a matrix and use parameter
<code>groupby</code> to create the groups. See tutorial for more details.
</p>
<p>There is no color grouping option, because color is used to separate the sets. Marker symbol,
line style and type, etc. can be defined as a single value (one for all sets) and as a vector
with one value for each set.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>

<hr>
<h2 id='mdaplotg.getLegend'>Create and return vector with legend values</h2><span id='topic+mdaplotg.getLegend'></span>

<h3>Description</h3>

<p>Create and return vector with legend values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplotg.getLegend(ps, data.names, legend = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplotg.getLegend_+3A_ps">ps</code></td>
<td>
<p>list with plot series</p>
</td></tr>
<tr><td><code id="mdaplotg.getLegend_+3A_data.names">data.names</code></td>
<td>
<p>names of the data sets</p>
</td></tr>
<tr><td><code id="mdaplotg.getLegend_+3A_legend">legend</code></td>
<td>
<p>legend values provided by user</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of text values for the legend
</p>

<hr>
<h2 id='mdaplotg.getXLim'>Compute x-axis limits for mdaplotg</h2><span id='topic+mdaplotg.getXLim'></span>

<h3>Description</h3>

<p>Compute x-axis limits for mdaplotg
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplotg.getXLim(
  ps,
  xlim,
  show.excluded,
  show.legend,
  show.labels,
  legend.position,
  bwd = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplotg.getXLim_+3A_ps">ps</code></td>
<td>
<p>list with plotseries</p>
</td></tr>
<tr><td><code id="mdaplotg.getXLim_+3A_xlim">xlim</code></td>
<td>
<p>limits provided by user</p>
</td></tr>
<tr><td><code id="mdaplotg.getXLim_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, will excluded values also be shown</p>
</td></tr>
<tr><td><code id="mdaplotg.getXLim_+3A_show.legend">show.legend</code></td>
<td>
<p>will legend be shown on the plot</p>
</td></tr>
<tr><td><code id="mdaplotg.getXLim_+3A_show.labels">show.labels</code></td>
<td>
<p>will labels be shown on the plot</p>
</td></tr>
<tr><td><code id="mdaplotg.getXLim_+3A_legend.position">legend.position</code></td>
<td>
<p>position of legend on the plot (if shown)</p>
</td></tr>
<tr><td><code id="mdaplotg.getXLim_+3A_bwd">bwd</code></td>
<td>
<p>size of bar for bar plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with two values
</p>

<hr>
<h2 id='mdaplotg.getYLim'>Compute y-axis limits for mdaplotg</h2><span id='topic+mdaplotg.getYLim'></span>

<h3>Description</h3>

<p>Compute y-axis limits for mdaplotg
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplotg.getYLim(
  ps,
  ylim,
  show.excluded,
  show.legend,
  legend.position,
  show.labels
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplotg.getYLim_+3A_ps">ps</code></td>
<td>
<p>list with plotseries</p>
</td></tr>
<tr><td><code id="mdaplotg.getYLim_+3A_ylim">ylim</code></td>
<td>
<p>limits provided by user</p>
</td></tr>
<tr><td><code id="mdaplotg.getYLim_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, will excluded values also be shown</p>
</td></tr>
<tr><td><code id="mdaplotg.getYLim_+3A_show.legend">show.legend</code></td>
<td>
<p>will legend be shown on the plot</p>
</td></tr>
<tr><td><code id="mdaplotg.getYLim_+3A_legend.position">legend.position</code></td>
<td>
<p>position of legend on the plot (if shown)</p>
</td></tr>
<tr><td><code id="mdaplotg.getYLim_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, will data ponit labels also be shown</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with two values
</p>

<hr>
<h2 id='mdaplotg.prepareData'>Prepare data for mdaplotg</h2><span id='topic+mdaplotg.prepareData'></span>

<h3>Description</h3>

<p>Prepare data for mdaplotg
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplotg.prepareData(data, type, groupby)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplotg.prepareData_+3A_data">data</code></td>
<td>
<p>datasets (in form of list, matrix or data frame)</p>
</td></tr>
<tr><td><code id="mdaplotg.prepareData_+3A_type">type</code></td>
<td>
<p>vector with type for dataset</p>
</td></tr>
<tr><td><code id="mdaplotg.prepareData_+3A_groupby">groupby</code></td>
<td>
<p>factor or  data frame with factors - used to split data matrix into groups</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of datasets
</p>
<p>The method should prepare data as a list of datasets (matrices or data frames). One list
element will be used to create one plot series.
</p>
<p>If 'data' is matrix or data frame and not 'groupby' parameter is provided, then every row
will be taken as separate set. This option is available only for line or bar plots.
</p>

<hr>
<h2 id='mdaplotg.processParam'>Check mdaplotg parameters and replicate them if necessary</h2><span id='topic+mdaplotg.processParam'></span>

<h3>Description</h3>

<p>Check mdaplotg parameters and replicate them if necessary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplotg.processParam(param, name, is.type, ngroups)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplotg.processParam_+3A_param">param</code></td>
<td>
<p>A parameter to check</p>
</td></tr>
<tr><td><code id="mdaplotg.processParam_+3A_name">name</code></td>
<td>
<p>name of the parameter (needed for error message)</p>
</td></tr>
<tr><td><code id="mdaplotg.processParam_+3A_is.type">is.type</code></td>
<td>
<p>function to use for checking parameter type</p>
</td></tr>
<tr><td><code id="mdaplotg.processParam_+3A_ngroups">ngroups</code></td>
<td>
<p>number of groups (plot series)</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplotg.showLegend'>Show legend for mdaplotg</h2><span id='topic+mdaplotg.showLegend'></span>

<h3>Description</h3>

<p>Shows a legend for plot elements or their groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplotg.showLegend(
  legend,
  col,
  pt.bg = NA,
  pch = NULL,
  lty = NULL,
  lwd = NULL,
  cex = 1,
  bty = "o",
  position = "topright",
  plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplotg.showLegend_+3A_legend">legend</code></td>
<td>
<p>vector with text elements for the legend items</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_col">col</code></td>
<td>
<p>vector with color values for the legend items</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_pt.bg">pt.bg</code></td>
<td>
<p>vector with background colors for the legend items (e.g. for pch = 21:25)</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_pch">pch</code></td>
<td>
<p>vector with marker symbols for the legend items</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_lty">lty</code></td>
<td>
<p>vector with line types for the legend items</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_lwd">lwd</code></td>
<td>
<p>vector with line width values for the legend items</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_cex">cex</code></td>
<td>
<p>vector with cex factor for the points</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_bty">bty</code></td>
<td>
<p>border type for the legend</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_position">position</code></td>
<td>
<p>legend position (&quot;topright&quot;, &quot;topleft', &quot;bottomright&quot;, &quot;bottomleft&quot;, &quot;top&quot;, &quot;bottom&quot;)</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_plot">plot</code></td>
<td>
<p>logical, show legend or just calculate and return its size</p>
</td></tr>
<tr><td><code id="mdaplotg.showLegend_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='mdaplotyy'>Create line plot with double y-axis</h2><span id='topic+mdaplotyy'></span>

<h3>Description</h3>

<p><code>mdaplotyy</code> create line plot for two plot series and uses separate y-axis for each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdaplotyy(
  data,
  type = "l",
  col = mdaplot.getColors(2),
  lty = c(1, 1),
  lwd = c(1, 1),
  pch = (if (type == "b") c(16, 16) else c(NA, NA)),
  cex = 1,
  xlim = NULL,
  ylim = NULL,
  main = attr(data, "name"),
  xlab = attr(data, "xaxis.name"),
  ylab = rownames(data),
  labels = "values",
  show.labels = FALSE,
  lab.cex = 0.65,
  lab.col = "darkgray",
  show.grid = TRUE,
  grid.lwd = 0.5,
  grid.col = "lightgray",
  xticks = NULL,
  xticklabels = NULL,
  xlas = 0,
  ylas = 0,
  show.legend = TRUE,
  legend.position = "topright",
  legend = ylab,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdaplotyy_+3A_data">data</code></td>
<td>
<p>a matrix or a data.frame with two rows of values.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_type">type</code></td>
<td>
<p>type of the plot (&quot;l&quot; or &quot;b&quot;).</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_col">col</code></td>
<td>
<p>a color for markers or lines (same as <code>plot</code> parameter) for each series.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_lty">lty</code></td>
<td>
<p>line type for each series (two values)</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_lwd">lwd</code></td>
<td>
<p>line width for each series (two values)</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_pch">pch</code></td>
<td>
<p>a character for markers (same as <code>plot</code> parameter) for each series (two values).</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_cex">cex</code></td>
<td>
<p>scale factor for the markers</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_xlim">xlim</code></td>
<td>
<p>limits for the x axis (if NULL, will be calculated automatically).</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_ylim">ylim</code></td>
<td>
<p>limits for the y axis, either list with two vectors (one for each series) or NULL.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_main">main</code></td>
<td>
<p>an overall title for the plot (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_ylab">ylab</code></td>
<td>
<p>a title for each of the two y axis (as a vector of two text values).</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_labels">labels</code></td>
<td>
<p>a vector with text labels for data points or one of the following: &quot;names&quot;, &quot;indices&quot;, &quot;values&quot;.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the data objects.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_lab.cex">lab.cex</code></td>
<td>
<p>size for data point labels.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_lab.col">lab.col</code></td>
<td>
<p>color for data point labels.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_show.grid">show.grid</code></td>
<td>
<p>logical, show or not a grid for the plot.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_grid.lwd">grid.lwd</code></td>
<td>
<p>line thinckness (width) for the grid.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_grid.col">grid.col</code></td>
<td>
<p>line color for the grid.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_xticks">xticks</code></td>
<td>
<p>values for x ticks.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_xticklabels">xticklabels</code></td>
<td>
<p>labels for x ticks.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_xlas">xlas</code></td>
<td>
<p>orientation of xticklabels.</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_ylas">ylas</code></td>
<td>
<p>orientation of yticklabels (will be applied to both y axes).</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_show.legend">show.legend</code></td>
<td>
<p>logical show legend with name of each plot series or not</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_legend.position">legend.position</code></td>
<td>
<p>position of legend if it must be shown</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_legend">legend</code></td>
<td>
<p>values for the legend</p>
</td></tr>
<tr><td><code id="mdaplotyy_+3A_...">...</code></td>
<td>
<p>other plotting arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot has properties both <code>mdaplot</code> and <code>mdaplotg</code>, so when you specify color,
line properties etc. you have to do it for both plot series.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mdaplotg">mdaplotg</a></code> - to make plots for several sets of data objects (groups of objects).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See all examples in the tutorial.

</code></pre>

<hr>
<h2 id='mdatools'>
Package for Multivariate Data Analysis (Chemometrics)
</h2><span id='topic+mdatools'></span>

<h3>Description</h3>

<p>This package contains classes and functions for most common methods used in Chemometrics. For a complete list of functions, use <code>library(help = 'mdatools')</code>.
</p>


<h3>Details</h3>

<p>The project is hosted on GitHub (https://svkucheryavski.github.io/mdatools/), there you can also find a Bookdown user tutorial explaining most important features of the package. There is also a dedicated YouTube channel (https://www.youtube.com/channel/UCox0H4utfMq4FIu2kymuyTA) with introductory Chemometric course with examples based on mdatools functionality.
</p>
<p>Every method is represented by two classes: a model class for keeping all parameters and information about the model, and a class for keeping and visualising results of applying the model to particular data values.
</p>
<p>Every model class, e.g. <code><a href="#topic+pls">pls</a></code>, has all needed functionality implemented as class methods, including model calibration, validation (test set and cross-validation), visualisation of the calibration and validation results with various plots and summary statistics.
</p>
<p>So far the following modelling and validation methods are implemented:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+pca">pca</a></code>, <code><a href="#topic+pcares">pcares</a></code> </td><td style="text-align: left;"> Principal Component Analysis (PCA).</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+pls">pls</a></code>, <code><a href="#topic+plsres">plsres</a></code> </td><td style="text-align: left;"> Partial Least Squares regression (PLS).</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+simca">simca</a></code>, <code><a href="#topic+simcares">simcares</a></code> </td><td style="text-align: left;"> Soft Independent Modelling of Class Analogues (SIMCA)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+simcam">simcam</a></code>, <code><a href="#topic+simcamres">simcamres</a></code> </td><td style="text-align: left;"> SIMCA for multiple classes case (SIMCA)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+plsda">plsda</a></code>, <code><a href="#topic+plsdares">plsdares</a></code> </td><td style="text-align: left;"> Partial Least Squares Dscriminant Analysis (PLS-DA).</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+randtest">randtest</a></code> </td><td style="text-align: left;"> Randomization test for PLS-regression.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+ipls">ipls</a></code> </td><td style="text-align: left;"> Interval PLS variable.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+mcrals">mcrals</a></code> </td><td style="text-align: left;"> Multivariate Curve Resolution with Alternating Least Squares.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+mcrpure">mcrpure</a></code> </td><td style="text-align: left;"> Multivariate Curve Resolution with Purity approach.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods for data preprocessing:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+prep.autoscale">prep.autoscale</a></code> </td><td style="text-align: left;"> data mean centering and/or standardization.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+prep.savgol">prep.savgol</a></code> </td><td style="text-align: left;"> Savitzky-Golay transformation.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+prep.snv">prep.snv</a></code> </td><td style="text-align: left;"> Standard normal variate.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+prep.msc">prep.msc</a></code> </td><td style="text-align: left;"> Multiplicative scatter correction.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+prep.norm">prep.norm</a></code> </td><td style="text-align: left;"> Spectra normalization.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code><a href="#topic+prep.alsbasecorr">prep.alsbasecorr</a></code> </td><td style="text-align: left;"> Baseline correction with Asymmetric Least Squares.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>All plotting methods are based on two functions, <code><a href="#topic+mdaplot">mdaplot</a></code> and <code><a href="#topic+mdaplotg">mdaplotg</a></code>. The functions extend the basic functionality of R plots and allow to make automatic legend and color grouping of data points or lines with colorbar legend, automatically adjust axes limits when several data groups are plotted and so on.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>

<hr>
<h2 id='pca'>Principal Component Analysis</h2><span id='topic+pca'></span>

<h3>Description</h3>

<p><code>pca</code> is used to build and explore a principal component analysis (PCA) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca(
  x,
  ncomp = min(nrow(x) - 1, ncol(x), 20),
  center = TRUE,
  scale = FALSE,
  exclrows = NULL,
  exclcols = NULL,
  x.test = NULL,
  method = "svd",
  rand = NULL,
  lim.type = "ddmoments",
  alpha = 0.05,
  gamma = 0.01,
  info = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca_+3A_x">x</code></td>
<td>
<p>calibration data (matrix or data frame).</p>
</td></tr>
<tr><td><code id="pca_+3A_ncomp">ncomp</code></td>
<td>
<p>maximum number of components to calculate.</p>
</td></tr>
<tr><td><code id="pca_+3A_center">center</code></td>
<td>
<p>logical, do mean centering of data or not.</p>
</td></tr>
<tr><td><code id="pca_+3A_scale">scale</code></td>
<td>
<p>logical, do standardization of data or not.</p>
</td></tr>
<tr><td><code id="pca_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="pca_+3A_exclcols">exclcols</code></td>
<td>
<p>columns to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="pca_+3A_x.test">x.test</code></td>
<td>
<p>test data (matrix or data frame).</p>
</td></tr>
<tr><td><code id="pca_+3A_method">method</code></td>
<td>
<p>method to compute principal components (&quot;svd&quot;, &quot;nipals&quot;).</p>
</td></tr>
<tr><td><code id="pca_+3A_rand">rand</code></td>
<td>
<p>vector with parameters for randomized PCA methods (if NULL, conventional PCA is used instead)</p>
</td></tr>
<tr><td><code id="pca_+3A_lim.type">lim.type</code></td>
<td>
<p>which method to use for calculation of critical limits for residual distances (see details)</p>
</td></tr>
<tr><td><code id="pca_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme limits for T2 and Q disances.</p>
</td></tr>
<tr><td><code id="pca_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outlier limits for T2 and Q distances.</p>
</td></tr>
<tr><td><code id="pca_+3A_info">info</code></td>
<td>
<p>a short text with model description.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note, that from v. 0.10.0 cross-validation is no more supported in PCA.
</p>
<p>If number of components is not specified, a minimum of number of objects - 1 and number of
variables in calibration set is used. One can also specified an optimal number of component,
once model is calibrated (<code>ncomp.selected</code>). The optimal number of components is used to
build a residuals distance plot, as well as for SIMCA classification.
</p>
<p>If some of rows of calibration set should be excluded from calculations (e.g. because they are
outliers) you can provide row numbers, names, or logical values as parameter <code>exclrows</code>. In
this case they will be completely ignored we model is calibrated. However, score and residuls
distances will be computed for these rows as well and then hidden. You can show them
on corresponding plots by using parameter <code>show.excluded = TRUE</code>.
</p>
<p>It is also possible to exclude selected columns from calculations by provideing parameter
<code>exclcols</code> in form of column numbers, names or logical values. In this case loading matrix
will have zeros for these columns. This allows to compute PCA models for selected variables
without removing them physically from a dataset.
</p>
<p>Take into account that if you see other packages to make plots (e.g. ggplot2) you will
not be able to distinguish between hidden and normal objects.
</p>
<p>By default loadings are computed for the original dataset using either SVD or NIPALS algorithm.
However, for datasets with large number of rows (e.g. hyperspectral images), there is a
possibility to run algorithms based on random permutations [1, 2]. In this case you have
to define parameter <code>rand</code> as a vector with two values: <code>p</code> - oversampling parameter
and <code>k</code> - number of iterations. Usually <code>rand = c(15, 0)</code> or  <code>rand = c(5, 1)</code>
are good options, which give quite almost precise solution but much faster.
</p>
<p>There are several ways to calculate critical limits for orthogonal (Q, q) and score (T2, h)
distances. In <code>mdatools</code> you can specify one of the following methods via parameter
<code>lim.type</code>: <code>"jm"</code> Jackson-Mudholkar approach [3], <code>"chisq"</code> - method based on
chi-square distribution [4], <code>"ddmoments"</code> and <code>"ddrobust"</code> - related to data
driven method proposed in [5]. The <code>"ddmoments"</code> is based on method of moments for
estimation of distribution parameters (also known as &quot;classical&quot; approach) while
<code>"ddrobust"</code> is based in robust estimation.
</p>
<p>If <code>lim.type="chisq"</code> or <code>lim.type="jm"</code> is used, only limits for Q-distances are
computed based on corresponding approach, limits for T2-distances are computed using
Hotelling's T-squared distribution. The methods utilizing the data driven approach calculate
limits for combination of the distances bases on chi-square distribution and parameters
estimated from the calibration data.
</p>
<p>The critical limits are calculated for a significance level defined by parameter <code>'alpha'</code>.
You can also specify another parameter, <code>'gamma'</code>, which is used to calculate acceptance
limit for outliers (shown as dashed line on residual distance plot).
</p>
<p>You can also recalculate the limits for existent model by using different values for alpha and
gamme, without recomputing the model itself. In this case use the following code (it is assumed
that you current PCA/SIMCA model is stored in variable <code>m</code>):
<code>m = setDistanceLimits(m, lim.type, alpha, gamma)</code>.
</p>
<p>In case of PCA the critical limits are just shown on residual plot as lines and can be used for
detection of extreme objects (solid line) and outliers (dashed line). When PCA model is used for
classification in SIMCA (see <code><a href="#topic+simca">simca</a></code>) the limits are also employed for
classification of objects.
</p>


<h3>Value</h3>

<p>Returns an object of <code>pca</code> class with following fields:
</p>
<table>
<tr><td><code>ncomp</code></td>
<td>
<p>number of components included to the model.</p>
</td></tr>
<tr><td><code>ncomp.selected</code></td>
<td>
<p>selected (optimal) number of components.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>matrix with loading values (nvar x ncomp).</p>
</td></tr>
<tr><td><code>eigenvals</code></td>
<td>
<p>vector with eigenvalues for all existent components.</p>
</td></tr>
<tr><td><code>expvar</code></td>
<td>
<p>vector with explained variance for each component (in percent).</p>
</td></tr>
<tr><td><code>cumexpvar</code></td>
<td>
<p>vector with cumulative explained variance for each component (in percent).</p>
</td></tr>
<tr><td><code>T2lim</code></td>
<td>
<p>statistical limit for T2 distance.</p>
</td></tr>
<tr><td><code>Qlim</code></td>
<td>
<p>statistical limit for Q residuals.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information about the model, provided by user when build the model.</p>
</td></tr>
<tr><td><code>calres</code></td>
<td>
<p>an object of class <code><a href="#topic+pcares">pcares</a></code> with PCA results for a calibration data.</p>
</td></tr>
<tr><td><code>testres</code></td>
<td>
<p>an object of class <code><a href="#topic+pcares">pcares</a></code> with PCA results for a test data, if it
was provided.</p>
</td></tr>
</table>
<p>More details and examples can be found in the Bookdown tutorial.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>References</h3>

<p>1. N. Halko, P.G. Martinsson, J.A. Tropp. Finding structure with randomness: probabilistic
algorithms for constructing approximate matrix decompositions. SIAM Review, 53 (2010) pp.
217-288.
</p>
<p>2. S. Kucheryavskiy, Blessing of randomness against the curse of dimensionality,
Journal of Chemometrics, 32 (2018).
</p>
<p>3. J.E. Jackson, A User's Guide to Principal Components, John Wiley &amp; Sons, New York, NY (1991).
</p>
<p>4. A.L. Pomerantsev, Acceptance areas for multivariate classification derived by projection
methods, Journal of Chemometrics, 22 (2008) pp. 601-609.
</p>
<p>5. A.L. Pomerantsev, O.Ye. Rodionova, Concept and role of extreme objects in PCA/SIMCA,
Journal of Chemometrics, 28 (2014) pp. 429-438.
</p>


<h3>See Also</h3>

<p>Methods for <code>pca</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>plot.pca</code> </td><td style="text-align: left;"> makes an overview of PCA model with four plots.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>summary.pca</code> </td><td style="text-align: left;"> shows some statistics for the model.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>categorize.pca</code> </td><td style="text-align: left;"> categorize data rows as "normal", "extreme" or "outliers".</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+selectCompNum.pca">selectCompNum.pca</a></code> </td><td style="text-align: left;"> set number of optimal components in the model</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+setDistanceLimits.pca">setDistanceLimits.pca</a></code> </td><td style="text-align: left;"> set critical limits for residuals</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+predict.pca">predict.pca</a></code> </td><td style="text-align: left;"> applies PCA model to a new data.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Plotting methods for <code>pca</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotScores.pca">plotScores.pca</a></code> </td><td style="text-align: left;"> shows scores plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotLoadings.pca">plotLoadings.pca</a></code> </td><td style="text-align: left;"> shows loadings plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotVariance.pca">plotVariance.pca</a></code> </td><td style="text-align: left;"> shows explained variance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotCumVariance.pca">plotCumVariance.pca</a></code> </td><td style="text-align: left;"> shows cumulative explained variance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotResiduals.pca">plotResiduals.pca</a></code> </td><td style="text-align: left;"> shows plot for residual distances (Q vs. T2).</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotBiplot.pca">plotBiplot.pca</a></code> </td><td style="text-align: left;"> shows bi-plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotExtreme.pca">plotExtreme.pca</a></code> </td><td style="text-align: left;"> shows extreme plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotT2DoF">plotT2DoF</a></code> </td><td style="text-align: left;"> plot with degrees of freedom for score distance.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotQDoF">plotQDoF</a></code> </td><td style="text-align: left;"> plot with degrees of freedom for orthogonal distance.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotDistDoF">plotDistDoF</a></code> </td><td style="text-align: left;"> plot with degrees of freedom for both distances.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Most of the methods for plotting data are also available for PCA results (<code><a href="#topic+pcares">pcares</a></code>)
objects. Also check <code><a href="#topic+pca.mvreplace">pca.mvreplace</a></code>, which replaces missing values in a data matrix
with approximated using iterative PCA decomposition.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mdatools)
### Examples for PCA class

## 1. Make PCA model for People data with autoscaling

data(people)
model = pca(people, scale = TRUE, info = "Simple PCA model")
model = selectCompNum(model, 4)
summary(model)
plot(model, show.labels = TRUE)

## 2. Show scores and loadings plots for the model

par(mfrow = c(2, 2))
plotScores(model, comp = c(1, 3), show.labels = TRUE)
plotScores(model, comp = 2, type = "h", show.labels = TRUE)
plotLoadings(model, comp = c(1, 3), show.labels = TRUE)
plotLoadings(model, comp = c(1, 2), type = "h", show.labels = TRUE)
par(mfrow = c(1, 1))

## 3. Show residual distance and variance plots for the model
par(mfrow = c(2, 2))
plotVariance(model, type = "h")
plotCumVariance(model, show.labels = TRUE, legend.position = "bottomright")
plotResiduals(model, show.labels = TRUE)
plotResiduals(model, ncomp = 2, show.labels = TRUE)
par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='pca.cal'>PCA model calibration</h2><span id='topic+pca.cal'></span>

<h3>Description</h3>

<p>Calibrates (builds) a PCA model for given data and parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca.cal(x, ncomp, center, scale, method, rand = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca.cal_+3A_x">x</code></td>
<td>
<p>matrix with data values</p>
</td></tr>
<tr><td><code id="pca.cal_+3A_ncomp">ncomp</code></td>
<td>
<p>number of principal components to calculate</p>
</td></tr>
<tr><td><code id="pca.cal_+3A_center">center</code></td>
<td>
<p>logical, do mean centering or not</p>
</td></tr>
<tr><td><code id="pca.cal_+3A_scale">scale</code></td>
<td>
<p>logical, do standardization or not</p>
</td></tr>
<tr><td><code id="pca.cal_+3A_method">method</code></td>
<td>
<p>algorithm for compiting PC space (only 'svd' and 'nipals' are supported so far)</p>
</td></tr>
<tr><td><code id="pca.cal_+3A_rand">rand</code></td>
<td>
<p>vector with parameters for randomized PCA methods (if NULL, conventional PCA is used instead)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object with calibrated PCA model
</p>

<hr>
<h2 id='pca.getB'>Low-dimensional approximation of data matrix X</h2><span id='topic+pca.getB'></span>

<h3>Description</h3>

<p>Low-dimensional approximation of data matrix X
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca.getB(X, k = NULL, rand = NULL, dist = "unif")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca.getB_+3A_x">X</code></td>
<td>
<p>data matrix</p>
</td></tr>
<tr><td><code id="pca.getB_+3A_k">k</code></td>
<td>
<p>rank of X (number of components)</p>
</td></tr>
<tr><td><code id="pca.getB_+3A_rand">rand</code></td>
<td>
<p>a vector with two values - number of iterations (q) and oversmapling parameter (p)</p>
</td></tr>
<tr><td><code id="pca.getB_+3A_dist">dist</code></td>
<td>
<p>distribution for generating random numbers, 'unif' or 'norm'</p>
</td></tr>
</table>

<hr>
<h2 id='pca.mvreplace'>Replace missing values in data</h2><span id='topic+pca.mvreplace'></span>

<h3>Description</h3>

<p><code>pca.mvreplace</code> is used to replace missing values in a data matrix with
approximated by iterative PCA decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca.mvreplace(
  x,
  center = TRUE,
  scale = FALSE,
  maxncomp = 10,
  expvarlim = 0.95,
  covlim = 10^-6,
  maxiter = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca.mvreplace_+3A_x">x</code></td>
<td>
<p>a matrix with data, containing missing values.</p>
</td></tr>
<tr><td><code id="pca.mvreplace_+3A_center">center</code></td>
<td>
<p>logical, do centering of data values or not.</p>
</td></tr>
<tr><td><code id="pca.mvreplace_+3A_scale">scale</code></td>
<td>
<p>logical, do standardization of data values or not.</p>
</td></tr>
<tr><td><code id="pca.mvreplace_+3A_maxncomp">maxncomp</code></td>
<td>
<p>maximum number of components in PCA model.</p>
</td></tr>
<tr><td><code id="pca.mvreplace_+3A_expvarlim">expvarlim</code></td>
<td>
<p>minimum amount of variance, explained by chosen components (used for selection of optimal number
of components in PCA models).</p>
</td></tr>
<tr><td><code id="pca.mvreplace_+3A_covlim">covlim</code></td>
<td>
<p>convergence criterion.</p>
</td></tr>
<tr><td><code id="pca.mvreplace_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations if convergence criterion is not met.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses iterative PCA modeling of the data to approximate and impute missing values.
The result is most optimal for data sets with low or moderate level of noise and with number of
missing values less than 10% for small dataset and up to 20% for large data.
</p>


<h3>Value</h3>

<p>Returns the same matrix <code>x</code> where missing values are replaced with approximated.
</p>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>References</h3>

<p>Philip R.C. Nelson, Paul A. Taylor, John F. MacGregor. Missing data methods in PCA and PLS:
Score calculations with incomplete observations. Chemometrics and Intelligent Laboratory
Systems, 35 (1), 1996.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mdatools)

## A very simple example of imputing missing values in a data with no noise

# generate a matrix with values
s = 1:6
odata = cbind(s, 2*s, 4*s)

# make a matrix with missing values
mdata = odata
mdata[5, 2] = mdata[2, 3] = NA

# replace missing values with approximated
rdata = pca.mvreplace(mdata, scale = TRUE)

# show all matrices together
show(cbind(odata, mdata, round(rdata, 2)))

</code></pre>

<hr>
<h2 id='pca.nipals'>NIPALS based PCA algorithm</h2><span id='topic+pca.nipals'></span>

<h3>Description</h3>

<p>Calculates principal component space using non-linear iterative partial least squares algorithm
(NIPALS)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca.nipals(x, ncomp = min(ncol(x), nrow(x) - 1), tol = 10^-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca.nipals_+3A_x">x</code></td>
<td>
<p>a matrix with data values (preprocessed)</p>
</td></tr>
<tr><td><code id="pca.nipals_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to calculate</p>
</td></tr>
<tr><td><code id="pca.nipals_+3A_tol">tol</code></td>
<td>
<p>tolerance (if difference in eigenvalues is smaller - convergence achieved)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with scores, loadings and eigenvalues for the components
</p>


<h3>References</h3>

<p>Geladi, Paul; Kowalski, Bruce (1986), &quot;Partial Least Squares
Regression:A Tutorial&quot;, Analytica Chimica Acta 185: 1-17
</p>

<hr>
<h2 id='pca.run'>Runs one of the selected PCA methods</h2><span id='topic+pca.run'></span>

<h3>Description</h3>

<p>Runs one of the selected PCA methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca.run(x, ncomp, method, rand = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca.run_+3A_x">x</code></td>
<td>
<p>data matrix</p>
</td></tr>
<tr><td><code id="pca.run_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
<tr><td><code id="pca.run_+3A_method">method</code></td>
<td>
<p>name of PCA methods ('svd', 'nipals')</p>
</td></tr>
<tr><td><code id="pca.run_+3A_rand">rand</code></td>
<td>
<p>parameters for randomized algorithm (if not NULL)</p>
</td></tr>
</table>

<hr>
<h2 id='pca.svd'>Singular Values Decomposition based PCA algorithm</h2><span id='topic+pca.svd'></span>

<h3>Description</h3>

<p>Computes principal component space using Singular Values Decomposition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca.svd(x, ncomp = min(ncol(x), nrow(x) - 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca.svd_+3A_x">x</code></td>
<td>
<p>a matrix with data values (preprocessed)</p>
</td></tr>
<tr><td><code id="pca.svd_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to calculate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with scores, loadings and eigenvalues for the components
</p>

<hr>
<h2 id='pcares'>Results of PCA decomposition</h2><span id='topic+pcares'></span>

<h3>Description</h3>

<p><code>pcares</code> is used to store and visualise results for PCA decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcares(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcares_+3A_...">...</code></td>
<td>
<p>all arguments supported by <code>ldecomp</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In fact <code>pcares</code> is a wrapper for <code><a href="#topic+ldecomp">ldecomp</a></code> - general class for storing
results for linear decomposition X = TP' + E. So, most of the methods, arguments and
returned values are inherited from <code>ldecomp</code>.
</p>
<p>There is no need to create a <code>pcares</code> object manually, it is created automatically when
build a PCA model (see <code><a href="#topic+pca">pca</a></code>) or apply the model to a new data (see
<code><a href="#topic+predict.pca">predict.pca</a></code>). The object can be used to show summary and plots for the results.
</p>
<p>It is assumed that data is a matrix or data frame with I rows and J columns.
</p>


<h3>Value</h3>

<p>Returns an object (list) of class <code>pcares</code> and <code>ldecomp</code> with following fields:
</p>
<table>
<tr><td><code>scores</code></td>
<td>
<p>matrix with score values (I x A).</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>matrix with data residuals (I x J).</p>
</td></tr>
<tr><td><code>T2</code></td>
<td>
<p>matrix with score distances (I x A).</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>matrix with orthogonal distances (I x A).</p>
</td></tr>
<tr><td><code>ncomp.selected</code></td>
<td>
<p>selected number of components.</p>
</td></tr>
<tr><td><code>expvar</code></td>
<td>
<p>explained variance for each component.</p>
</td></tr>
<tr><td><code>cumexpvar</code></td>
<td>
<p>cumulative explained variance.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Methods for <code>pcares</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print.pcares</code> </td><td style="text-align: left;"> shows information about the object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>summary.pcares</code> </td><td style="text-align: left;"> shows statistics for the PCA results.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code><a href="#topic+ldecomp">ldecomp</a></code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotScores.ldecomp">plotScores.ldecomp</a></code> </td><td style="text-align: left;"> makes scores plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotVariance.ldecomp">plotVariance.ldecomp</a></code> </td><td style="text-align: left;"> makes explained variance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotCumVariance.ldecomp">plotCumVariance.ldecomp</a></code> </td><td style="text-align: left;"> makes cumulative explained variance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotResiduals.ldecomp">plotResiduals.ldecomp</a></code> </td><td style="text-align: left;"> makes Q vs. T2 distance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Check also <code><a href="#topic+pca">pca</a></code> and <code><a href="#topic+ldecomp">ldecomp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Examples for PCA results class

library(mdatools)

## 1. Make a model for every odd row of People data
## and apply it to the objects from every even row

data(people)
x = people[seq(1, 32, 2), ]
x.new = people[seq(1, 32, 2), ]

model = pca(people, scale = TRUE, info = "Simple PCA model")
model = selectCompNum(model, 4)

res = predict(model, x.new)
summary(res)
plot(res)

## 1. Make PCA model for People data with autoscaling
## and full cross-validation and get calibration results

data(people)
model = pca(people, scale = TRUE, info = "Simple PCA model")
model = selectCompNum(model, 4)

res = model$calres
summary(res)
plot(res)

## 2. Show scores plots for the results
par(mfrow = c(2, 2))
plotScores(res)
plotScores(res, cgroup = people[, "Beer"], show.labels = TRUE)
plotScores(res, comp = c(1, 3), show.labels = TRUE)
plotScores(res, comp = 2, type = "h", show.labels = TRUE)
par(mfrow = c(1, 1))

## 3. Show residuals and variance plots for the results
par(mfrow = c(2, 2))
plotVariance(res, type = "h")
plotCumVariance(res, show.labels = TRUE)
plotResiduals(res, show.labels = TRUE, cgroup = people[, "Sex"])
plotResiduals(res, ncomp = 2, show.labels = TRUE)
par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='pellets'>
Image data
</h2><span id='topic+pellets'></span>

<h3>Description</h3>

<p>Dataset for showing how mdatools works with images. It is an RGB image represented as 3-way array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(people)</code></pre>


<h3>Format</h3>

<p>a 3-way array (height x width x channels).
</p>


<h3>Details</h3>

<p>This is an image with pellets of four different colours mixed in a glas volume.
</p>

<hr>
<h2 id='people'>
People data
</h2><span id='topic+people'></span>

<h3>Description</h3>

<p>Dataset for exploratory analysis with 32 objects (male and female persons) and 12 variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(people)</code></pre>


<h3>Format</h3>

<p>a matrix with 32 observations (persons) and 12 variables.
</p>

<table>
<tr>
 <td style="text-align: right;">
      <code>[, 1]</code> </td><td style="text-align: left;"> Height in cm. </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 2]</code> </td><td style="text-align: left;"> Weight in kg. </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 3]</code> </td><td style="text-align: left;"> Hair length (-1 for short, +1 for long). </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 4]</code> </td><td style="text-align: left;"> Shoe size (EU standard). </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 5]</code> </td><td style="text-align: left;"> Age, years. </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 6]</code> </td><td style="text-align: left;"> Income, euro per year. </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 7]</code> </td><td style="text-align: left;"> Beer consumption, liters per year. </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 8]</code> </td><td style="text-align: left;"> Wine consumption, liters per year. </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 9]</code> </td><td style="text-align: left;"> Sex (-1 for male, +1 for female). </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 10]</code> </td><td style="text-align: left;"> Swimming ability (index, based on 500 m swimming time). </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 11]</code> </td><td style="text-align: left;"> Region (-1 for Scandinavia, +1 for Mediterranean. </td>
</tr>
<tr>
 <td style="text-align: right;">
      <code>[, 12]</code> </td><td style="text-align: left;"> IQ (European standardized test). </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>The data was taken from the book [1] and is in fact a small subset of a pan-European demographic survey. It includes information about 32 persons, 16 represent northern Europe (Scandinavians) and 16 are from the Mediterranean regions. In both groups there are 8 male and 8 female persons. The data includes both quantitative and qualitative variables and is particularly useful for benchmarking exploratory data analysis methods.   
</p>


<h3>Source</h3>

<p>1. K. Esbensen. Multivariate Data Analysis in Practice. Camo, 2002.
</p>

<hr>
<h2 id='pinv'>Pseudo-inverse matrix</h2><span id='topic+pinv'></span>

<h3>Description</h3>

<p>Computes pseudo-inverse matrix using SVD
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pinv(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pinv_+3A_data">data</code></td>
<td>
<p>a matrix with data values to compute inverse for</p>
</td></tr>
</table>

<hr>
<h2 id='plot.classres'>Plot function for classification results</h2><span id='topic+plot.classres'></span>

<h3>Description</h3>

<p>Generic plot function for classification results.
Alias for <code><a href="#topic+plotPredictions.classres">plotPredictions.classres</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.classres_+3A_x">x</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="plot.classres_+3A_...">...</code></td>
<td>
<p>other arguments for <code>plotPredictions()</code> method.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.ipls'>Overview plot for iPLS results</h2><span id='topic+plot.ipls'></span>

<h3>Description</h3>

<p>Shows a plot for iPLS results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipls'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ipls_+3A_x">x</code></td>
<td>
<p>a  (object of class <code>pca</code>).</p>
</td></tr>
<tr><td><code id="plot.ipls_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See details for <code><a href="#topic+plotSelection.ipls">plotSelection.ipls</a></code>.
</p>

<hr>
<h2 id='plot.mcr'>Plot summary for MCR model</h2><span id='topic+plot.mcr'></span>

<h3>Description</h3>

<p>Plot summary for MCR model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcr'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mcr_+3A_x">x</code></td>
<td>
<p><code>mcr</code> model object</p>
</td></tr>
<tr><td><code id="plot.mcr_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plot.pca'>Model overview plot for PCA</h2><span id='topic+plot.pca'></span>

<h3>Description</h3>

<p>Shows a set of plots (scores, loadings, residuals and explained variance) for PCA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
plot(
  x,
  comp = c(1, 2),
  ncomp = x$ncomp.selected,
  show.labels = FALSE,
  show.legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pca_+3A_x">x</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plot.pca_+3A_comp">comp</code></td>
<td>
<p>vector with two values - number of components to show the scores and loadings plots for</p>
</td></tr>
<tr><td><code id="plot.pca_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to show the residuals plot for</p>
</td></tr>
<tr><td><code id="plot.pca_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the plot objects</p>
</td></tr>
<tr><td><code id="plot.pca_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend on the plot</p>
</td></tr>
<tr><td><code id="plot.pca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pca">pca</a></code> function.
</p>

<hr>
<h2 id='plot.pcares'>Plot method for PCA results object</h2><span id='topic+plot.pcares'></span>

<h3>Description</h3>

<p>Show several plots to give an overview about the PCA results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcares'
plot(x, comp = c(1, 2), ncomp = x$ncomp.selected, show.labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pcares_+3A_x">x</code></td>
<td>
<p>PCA results (object of class <code>pcares</code>)</p>
</td></tr>
<tr><td><code id="plot.pcares_+3A_comp">comp</code></td>
<td>
<p>which components to show the scores plot for (can be one value or vector with two values).</p>
</td></tr>
<tr><td><code id="plot.pcares_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use for showing the residual distance plot</p>
</td></tr>
<tr><td><code id="plot.pcares_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the plot objects</p>
</td></tr>
<tr><td><code id="plot.pcares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='plot.pls'>Model overview plot for PLS</h2><span id='topic+plot.pls'></span>

<h3>Description</h3>

<p>Shows a set of plots (x residuals, regression coefficients, RMSE and predictions) for PLS model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plot(x, ncomp = x$ncomp.selected, ny = 1, show.legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pls_+3A_x">x</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plot.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="plot.pls_+3A_ny">ny</code></td>
<td>
<p>which y variable to show the summary for (if NULL, will be shown for all)</p>
</td></tr>
<tr><td><code id="plot.pls_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend on the plot</p>
</td></tr>
<tr><td><code id="plot.pls_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plot.plsda'>Model overview plot for PLS-DA</h2><span id='topic+plot.plsda'></span>

<h3>Description</h3>

<p>Shows a set of plots (x residuals, regression coefficients, misclassification ratio and
predictions) for PLS-DA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsda'
plot(x, ncomp = x$ncomp.selected, nc = 1, show.legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.plsda_+3A_x">x</code></td>
<td>
<p>a PLS-DA model (object of class <code>plsda</code>)</p>
</td></tr>
<tr><td><code id="plot.plsda_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="plot.plsda_+3A_nc">nc</code></td>
<td>
<p>which class to show the plots</p>
</td></tr>
<tr><td><code id="plot.plsda_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend on the plot</p>
</td></tr>
<tr><td><code id="plot.plsda_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsda">plsda</a></code> function.
</p>

<hr>
<h2 id='plot.plsdares'>Overview plot for PLS-DA results</h2><span id='topic+plot.plsdares'></span>

<h3>Description</h3>

<p>Shows a set of plots (x residuals, y variance, classification performance and predictions)
for PLS-DA results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsdares'
plot(x, nc = 1, ncomp = x$ncomp.selected, show.labels = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.plsdares_+3A_x">x</code></td>
<td>
<p>PLS-DA results (object of class <code>plsdares</code>)</p>
</td></tr>
<tr><td><code id="plot.plsdares_+3A_nc">nc</code></td>
<td>
<p>which class to show the plot for</p>
</td></tr>
<tr><td><code id="plot.plsdares_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use</p>
</td></tr>
<tr><td><code id="plot.plsdares_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the plot objects</p>
</td></tr>
<tr><td><code id="plot.plsdares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plot.plsres'>Overview plot for PLS results</h2><span id='topic+plot.plsres'></span>

<h3>Description</h3>

<p>Shows a set of plots for PLS results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plot(x, ncomp = x$ncomp.selected, ny = 1, show.labels = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.plsres_+3A_x">x</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plot.plsres_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="plot.plsres_+3A_ny">ny</code></td>
<td>
<p>which y variable to show the summary for (if NULL, will be shown for all)</p>
</td></tr>
<tr><td><code id="plot.plsres_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the plot objects</p>
</td></tr>
<tr><td><code id="plot.plsres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='plot.randtest'>Plot for randomization test results</h2><span id='topic+plot.randtest'></span>

<h3>Description</h3>

<p>Makes a bar plot with alpha values for each component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randtest'
plot(x, main = "Alpha", xlab = "Components", ylab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.randtest_+3A_x">x</code></td>
<td>
<p>results of randomization test (object of class 'randtest')</p>
</td></tr>
<tr><td><code id="plot.randtest_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plot.randtest_+3A_xlab">xlab</code></td>
<td>
<p>label for x axis</p>
</td></tr>
<tr><td><code id="plot.randtest_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="plot.randtest_+3A_...">...</code></td>
<td>
<p>other optional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+randtest">randtest</a></code> function.
</p>

<hr>
<h2 id='plot.regcoeffs'>Regression coefficients plot</h2><span id='topic+plot.regcoeffs'></span>

<h3>Description</h3>

<p>Shows plot with regression coefficient values for every predictor variable (x)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regcoeffs'
plot(
  x,
  ncomp = 1,
  ny = 1,
  type = (if (x$nvar &gt; 30) "l" else "h"),
  col = c(mdaplot.getColors(1), "lightgray"),
  show.lines = c(NA, 0),
  show.ci = FALSE,
  alpha = 0.05,
  ylab = paste0("Coefficients (", x$respnames[ny], ")"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.regcoeffs_+3A_x">x</code></td>
<td>
<p>regression coefficients object (class <code>regcoeffs</code>)</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to use for creating the plot</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_ny">ny</code></td>
<td>
<p>index of response variable to make the plot for</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_col">col</code></td>
<td>
<p>vector with two colors for the plot (one is used to show real coefficient and another one to
show confidence intervals)</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_show.lines">show.lines</code></td>
<td>
<p>allows to show horizontal line at c(NA, 0)</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_show.ci">show.ci</code></td>
<td>
<p>logical, show or not confidence intervals if they are available</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_alpha">alpha</code></td>
<td>
<p>significance level for confidence intervals (a number between 0 and 1, e.g.
for 95% alpha = 0.05)</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plot.regcoeffs_+3A_...">...</code></td>
<td>
<p>other arguments for plotting methods (e.g. main, xlab, etc)</p>
</td></tr>
</table>

<hr>
<h2 id='plot.regres'>Plot method for regression results</h2><span id='topic+plot.regres'></span>

<h3>Description</h3>

<p>Plot method for regression results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regres'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.regres_+3A_x">x</code></td>
<td>
<p>regression results (object of class <code>regres</code>)</p>
</td></tr>
<tr><td><code id="plot.regres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a shortcut for <code><a href="#topic+plotPredictions.regres">plotPredictions.regres</a></code>
</p>

<hr>
<h2 id='plot.simca'>Model overview plot for SIMCA</h2><span id='topic+plot.simca'></span>

<h3>Description</h3>

<p>Shows a set of plots for SIMCA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simca'
plot(x, comp = c(1, 2), ncomp = x$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.simca_+3A_x">x</code></td>
<td>
<p>a SIMCA model (object of class <code>simca</code>)</p>
</td></tr>
<tr><td><code id="plot.simca_+3A_comp">comp</code></td>
<td>
<p>which components to show on scores and loadings plot</p>
</td></tr>
<tr><td><code id="plot.simca_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use for residuals plot</p>
</td></tr>
<tr><td><code id="plot.simca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+simcam">simcam</a></code> function.
</p>

<hr>
<h2 id='plot.simcam'>Model overview plot for SIMCAM</h2><span id='topic+plot.simcam'></span>

<h3>Description</h3>

<p>Shows a set of plots for SIMCAM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
plot(x, nc = c(1, 2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.simcam_+3A_x">x</code></td>
<td>
<p>a SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
<tr><td><code id="plot.simcam_+3A_nc">nc</code></td>
<td>
<p>vector with two values - classes (SIMCA models) to show the plot for</p>
</td></tr>
<tr><td><code id="plot.simcam_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+simcam">simcam</a></code> function.
</p>

<hr>
<h2 id='plot.simcamres'>Model overview plot for SIMCAM results</h2><span id='topic+plot.simcamres'></span>

<h3>Description</h3>

<p>Just shows a prediction plot for SIMCAM results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcamres'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.simcamres_+3A_x">x</code></td>
<td>
<p>SIMCAM results (object of class <code>simcamres</code>)</p>
</td></tr>
<tr><td><code id="plot.simcamres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+simcamres">simcamres</a></code> function.
</p>

<hr>
<h2 id='plotBars'>Show plot series as bars</h2><span id='topic+plotBars'></span>

<h3>Description</h3>

<p>First row of the data matrix is taken for creating the bar series. In case of barplot
color grouping is made based on columns (not rows as for all other plots).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBars(ps, col = ps$col, bwd = 0.8, border = NA, force.x.values = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotBars_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
<tr><td><code id="plotBars_+3A_col">col</code></td>
<td>
<p>colors of the bars</p>
</td></tr>
<tr><td><code id="plotBars_+3A_bwd">bwd</code></td>
<td>
<p>width of the bars (as a ratio for max width)</p>
</td></tr>
<tr><td><code id="plotBars_+3A_border">border</code></td>
<td>
<p>color of bar edges</p>
</td></tr>
<tr><td><code id="plotBars_+3A_force.x.values">force.x.values</code></td>
<td>
<p>vector with corrected x-values for a bar plot (needed for group plots, do not change manually).</p>
</td></tr>
</table>

<hr>
<h2 id='plotBiplot'>Biplot</h2><span id='topic+plotBiplot'></span>

<h3>Description</h3>

<p>Biplot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBiplot(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotBiplot_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotBiplot_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for biplot
</p>

<hr>
<h2 id='plotBiplot.pca'>PCA biplot</h2><span id='topic+plotBiplot.pca'></span>

<h3>Description</h3>

<p>Shows a biplot for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
plotBiplot(
  obj,
  comp = c(1, 2),
  pch = c(16, NA),
  col = mdaplot.getColors(2),
  main = "Biplot",
  lty = 1,
  lwd = 1,
  show.labels = FALSE,
  show.axes = TRUE,
  show.excluded = FALSE,
  lab.col = adjustcolor(col, alpha.f = 0.5),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotBiplot.pca_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_comp">comp</code></td>
<td>
<p>a value or vector with several values - number of components to show the plot for</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_pch">pch</code></td>
<td>
<p>a vector with two values - markers for scores and loadings</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_col">col</code></td>
<td>
<p>a vector with two colors for scores and loadings</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_lty">lty</code></td>
<td>
<p>line type for loadings</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_lwd">lwd</code></td>
<td>
<p>line width for loadings</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the plot objects</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, show or hide rows marked as excluded (attribute 'exclrows')</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_lab.col">lab.col</code></td>
<td>
<p>a vector with two colors for scores and loadings labels</p>
</td></tr>
<tr><td><code id="plotBiplot.pca_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>

<hr>
<h2 id='plotConfidenceEllipse'>Add confidence ellipse for groups of points on scatter plot</h2><span id='topic+plotConfidenceEllipse'></span>

<h3>Description</h3>

<p>The method shows confidence ellipse for groups of points on a scatter plot made using
'mdaplot()' function with 'cgroup' parameter. It will work only if 'cgroup' is a factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConfidenceEllipse(p, conf.level = 0.95, lwd = 1, lty = 1, opacity = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConfidenceEllipse_+3A_p">p</code></td>
<td>
<p>plot data returned by function 'mdaplot()'.</p>
</td></tr>
<tr><td><code id="plotConfidenceEllipse_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level to make the ellipse for (between 0 and 1).</p>
</td></tr>
<tr><td><code id="plotConfidenceEllipse_+3A_lwd">lwd</code></td>
<td>
<p>thickness of line used to show the hull.</p>
</td></tr>
<tr><td><code id="plotConfidenceEllipse_+3A_lty">lty</code></td>
<td>
<p>type of line used to show the hull.</p>
</td></tr>
<tr><td><code id="plotConfidenceEllipse_+3A_opacity">opacity</code></td>
<td>
<p>of opacity is 0 ellipse is transparent otherwise semi-transparent.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># adds 90% confidence ellipse with semi-transparent area over two clusters of points

library(mdatools)
data(people)
group &lt;- factor(people[, "Sex"], labels = c("Male", "Female"))

# first make plot and then add confidence ellipse
p &lt;- mdaplot(people, type = "p", cgroup = group)
plotConfidenceEllipse(p, conf.level = 0.90, opacity = 0.2)

</code></pre>

<hr>
<h2 id='plotContributions'>Plot resolved contributions</h2><span id='topic+plotContributions'></span>

<h3>Description</h3>

<p>Plot resolved contributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotContributions(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotContributions_+3A_obj">obj</code></td>
<td>
<p>object with mcr case</p>
</td></tr>
<tr><td><code id="plotContributions_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotContributions.mcr'>Show plot with resolved contributions</h2><span id='topic+plotContributions.mcr'></span>

<h3>Description</h3>

<p>Show plot with resolved contributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcr'
plotContributions(
  obj,
  comp = seq_len(obj$ncomp),
  type = "l",
  col = mdaplot.getColors(obj$ncomp),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotContributions.mcr_+3A_obj">obj</code></td>
<td>
<p>object of clacc <code>mcr</code></p>
</td></tr>
<tr><td><code id="plotContributions.mcr_+3A_comp">comp</code></td>
<td>
<p>vector with number of components to make the plot for</p>
</td></tr>
<tr><td><code id="plotContributions.mcr_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotContributions.mcr_+3A_col">col</code></td>
<td>
<p>vector with colors for individual components</p>
</td></tr>
<tr><td><code id="plotContributions.mcr_+3A_...">...</code></td>
<td>
<p>other parameters suitable for <code>mdaplotg</code></p>
</td></tr>
</table>

<hr>
<h2 id='plotConvexHull'>Add convex hull for groups of points on scatter plot</h2><span id='topic+plotConvexHull'></span>

<h3>Description</h3>

<p>The method shows convex hull for groups of points on a scatter plot made using
'mdaplot()' function with 'cgroup' parameter. It will work only if 'cgroup' is a factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConvexHull(p, lwd = 1, lty = 1, opacity = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConvexHull_+3A_p">p</code></td>
<td>
<p>plot data returned by function 'mdaplot()'.</p>
</td></tr>
<tr><td><code id="plotConvexHull_+3A_lwd">lwd</code></td>
<td>
<p>thickness of line used to show the hull.</p>
</td></tr>
<tr><td><code id="plotConvexHull_+3A_lty">lty</code></td>
<td>
<p>type of line used to show the hull.</p>
</td></tr>
<tr><td><code id="plotConvexHull_+3A_opacity">opacity</code></td>
<td>
<p>of opacity is larger than 0 a semi-transparent polygon is shown over points.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># adds convex hull with semi-transparent area over two clusters of points

library(mdatools)
data(people)
group &lt;- factor(people[, "Sex"], labels = c("Male", "Female"))

p &lt;- mdaplot(people, type = "p", cgroup = group)
plotConvexHull(p)

</code></pre>

<hr>
<h2 id='plotCooman'>Cooman's plot</h2><span id='topic+plotCooman'></span>

<h3>Description</h3>

<p>Cooman's plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCooman(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCooman_+3A_obj">obj</code></td>
<td>
<p>classification model or result object</p>
</td></tr>
<tr><td><code id="plotCooman_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for Cooman's plot
</p>

<hr>
<h2 id='plotCooman.simcam'>Cooman's plot for SIMCAM model</h2><span id='topic+plotCooman.simcam'></span>

<h3>Description</h3>

<p>Shows a Cooman's plot for a pair of SIMCA models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
plotCooman(
  obj,
  nc = c(1, 2),
  res = list(cal = obj$res[["cal"]]),
  groupby = res[[1]]$c.ref,
  main = "Cooman's plot",
  show.limits = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCooman.simcam_+3A_obj">obj</code></td>
<td>
<p>a SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
<tr><td><code id="plotCooman.simcam_+3A_nc">nc</code></td>
<td>
<p>vector with two values - classes (SIMCA models) to show the plot for</p>
</td></tr>
<tr><td><code id="plotCooman.simcam_+3A_res">res</code></td>
<td>
<p>list with results to show the plot for</p>
</td></tr>
<tr><td><code id="plotCooman.simcam_+3A_groupby">groupby</code></td>
<td>
<p>factor to use for grouping points on the plot</p>
</td></tr>
<tr><td><code id="plotCooman.simcam_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
<tr><td><code id="plotCooman.simcam_+3A_show.limits">show.limits</code></td>
<td>
<p>logical, show or not critical limits</p>
</td></tr>
<tr><td><code id="plotCooman.simcam_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cooman's plot shows squared orthogonal distance from data points to two selected SIMCA models
as well as critical limits for the distance (optional). In case if critical limits must be shown
they are computed using chi-square distribution regardless which type of limits is employed for
classification.
</p>
<p>If only one result object is provided (e.g. results for calibration set or new predictions),
then the points can be color grouped using 'groupby' parameter (by default reference class values
are used to make the groups). In case of multiple result objects, the points are color grouped
according to the objects (e.g. calibration set and test set).
</p>

<hr>
<h2 id='plotCooman.simcamres'>Cooman's plot for SIMCAM results</h2><span id='topic+plotCooman.simcamres'></span>

<h3>Description</h3>

<p>Shows a Cooman's plot for a pair of SIMCA models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcamres'
plotCooman(
  obj,
  nc = c(1, 2),
  main = "Cooman's plot",
  cgroup = obj$c.ref,
  show.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCooman.simcamres_+3A_obj">obj</code></td>
<td>
<p>SIMCAM results (object of class <code>simcamres</code>)</p>
</td></tr>
<tr><td><code id="plotCooman.simcamres_+3A_nc">nc</code></td>
<td>
<p>vector with two values - classes (SIMCA models) to show the plot for</p>
</td></tr>
<tr><td><code id="plotCooman.simcamres_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotCooman.simcamres_+3A_cgroup">cgroup</code></td>
<td>
<p>vector of values to use for color grouping of plot points</p>
</td></tr>
<tr><td><code id="plotCooman.simcamres_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, show plot or just return plot data</p>
</td></tr>
<tr><td><code id="plotCooman.simcamres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot is similar to <code><a href="#topic+plotCooman.simcam">plotCooman.simcam</a></code> but shows points only for this result
object and does not show critical limits (which are part of a model).
</p>

<hr>
<h2 id='plotCorr'>Correlation plot</h2><span id='topic+plotCorr'></span>

<h3>Description</h3>

<p>Correlation plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCorr(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCorr_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotCorr_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for correlation plot
</p>

<hr>
<h2 id='plotCorr.randtest'>Correlation plot for randomization test results</h2><span id='topic+plotCorr.randtest'></span>

<h3>Description</h3>

<p>Makes a plot with statistic values vs. coefficient of determination between permuted
and reference y-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randtest'
plotCorr(
  obj,
  ncomp = obj$ncomp.selected,
  ylim = NULL,
  xlab = expression(r^2),
  ylab = "Test statistic",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCorr.randtest_+3A_obj">obj</code></td>
<td>
<p>results of randomization test (object of class 'randtest')</p>
</td></tr>
<tr><td><code id="plotCorr.randtest_+3A_ncomp">ncomp</code></td>
<td>
<p>number of component to make the plot for</p>
</td></tr>
<tr><td><code id="plotCorr.randtest_+3A_ylim">ylim</code></td>
<td>
<p>limits for y axis</p>
</td></tr>
<tr><td><code id="plotCorr.randtest_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis</p>
</td></tr>
<tr><td><code id="plotCorr.randtest_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotCorr.randtest_+3A_...">...</code></td>
<td>
<p>other optional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+randtest">randtest</a></code> function.
</p>

<hr>
<h2 id='plotCumVariance'>Variance plot</h2><span id='topic+plotCumVariance'></span>

<h3>Description</h3>

<p>Variance plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCumVariance(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCumVariance_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotCumVariance_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting explained variance for data decomposition
</p>

<hr>
<h2 id='plotCumVariance.ldecomp'>Cumulative explained variance plot</h2><span id='topic+plotCumVariance.ldecomp'></span>

<h3>Description</h3>

<p>Shows a plot with cumulative explained variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ldecomp'
plotCumVariance(obj, type = "b", labels = "values", show.plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCumVariance.ldecomp_+3A_obj">obj</code></td>
<td>
<p>object of <code>ldecomp</code> class.</p>
</td></tr>
<tr><td><code id="plotCumVariance.ldecomp_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotCumVariance.ldecomp_+3A_labels">labels</code></td>
<td>
<p>what to show as labels for plot objects</p>
</td></tr>
<tr><td><code id="plotCumVariance.ldecomp_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, shall plot be created or just plot series object is needed</p>
</td></tr>
<tr><td><code id="plotCumVariance.ldecomp_+3A_...">...</code></td>
<td>
<p>most of graphical parameters from <code><a href="#topic+mdaplot">mdaplot</a></code> function can be used.</p>
</td></tr>
</table>

<hr>
<h2 id='plotCumVariance.mcr'>Show plot with cumulative explained variance</h2><span id='topic+plotCumVariance.mcr'></span>

<h3>Description</h3>

<p>Show plot with cumulative explained variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcr'
plotCumVariance(
  obj,
  type = "b",
  labels = "values",
  main = "Cumulative variance",
  xticks = seq_len(obj$ncomp),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCumVariance.mcr_+3A_obj">obj</code></td>
<td>
<p>object of clacc <code>mcr</code></p>
</td></tr>
<tr><td><code id="plotCumVariance.mcr_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotCumVariance.mcr_+3A_labels">labels</code></td>
<td>
<p>what to use as data labels</p>
</td></tr>
<tr><td><code id="plotCumVariance.mcr_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
<tr><td><code id="plotCumVariance.mcr_+3A_xticks">xticks</code></td>
<td>
<p>vector with ticks for x-axis</p>
</td></tr>
<tr><td><code id="plotCumVariance.mcr_+3A_...">...</code></td>
<td>
<p>other parameters suitable for <code>mdaplot</code></p>
</td></tr>
</table>

<hr>
<h2 id='plotCumVariance.pca'>Cumulative explained variance plot for PCA model</h2><span id='topic+plotCumVariance.pca'></span>

<h3>Description</h3>

<p>Shows a plot with cumulative explained variance for components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
plotCumVariance(obj, legend.position = "bottomright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCumVariance.pca_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotCumVariance.pca_+3A_legend.position">legend.position</code></td>
<td>
<p>position of the legend</p>
</td></tr>
<tr><td><code id="plotCumVariance.pca_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pca">pca</a></code> function.
</p>

<hr>
<h2 id='plotDensity'>Show plot series as density plot (using hex binning)</h2><span id='topic+plotDensity'></span>

<h3>Description</h3>

<p>Show plot series as density plot (using hex binning)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDensity(ps, nbins = 60, colmap = ps$colmap)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDensity_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
<tr><td><code id="plotDensity_+3A_nbins">nbins</code></td>
<td>
<p>number of bins in one dimension</p>
</td></tr>
<tr><td><code id="plotDensity_+3A_colmap">colmap</code></td>
<td>
<p>colormap name or values used to create color gradient</p>
</td></tr>
</table>

<hr>
<h2 id='plotDiscriminationPower'>Discrimination power plot</h2><span id='topic+plotDiscriminationPower'></span>

<h3>Description</h3>

<p>Discrimination power plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDiscriminationPower(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDiscriminationPower_+3A_obj">obj</code></td>
<td>
<p>a model object</p>
</td></tr>
<tr><td><code id="plotDiscriminationPower_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting discrimination power values for classification model
</p>

<hr>
<h2 id='plotDiscriminationPower.simcam'>Discrimination power plot for SIMCAM model</h2><span id='topic+plotDiscriminationPower.simcam'></span>

<h3>Description</h3>

<p>Shows a plot with discrimination power of predictors for a pair of SIMCA models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
plotDiscriminationPower(
  obj,
  nc = c(1, 2),
  type = "h",
  main = paste0("Discrimination power: ", obj$classnames[nc[1]], " vs. ",
    obj$classname[nc[2]]),
  xlab = attr(obj$dispower, "xaxis.name"),
  ylab = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDiscriminationPower.simcam_+3A_obj">obj</code></td>
<td>
<p>a SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
<tr><td><code id="plotDiscriminationPower.simcam_+3A_nc">nc</code></td>
<td>
<p>vector with two values - classes (SIMCA models) to show the plot for</p>
</td></tr>
<tr><td><code id="plotDiscriminationPower.simcam_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotDiscriminationPower.simcam_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotDiscriminationPower.simcam_+3A_xlab">xlab</code></td>
<td>
<p>label for x axis</p>
</td></tr>
<tr><td><code id="plotDiscriminationPower.simcam_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="plotDiscriminationPower.simcam_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Discrimination power shows an ability of variables to separate classes. The power is computed
similar to model distance, using variance of residuals. However in this case instead of sum the
variance across all variables, we take the ratio separately for individual variables.
</p>
<p>Discrimination power equal or above 3 is considered as high.
</p>

<hr>
<h2 id='plotDistDoF'>Degrees of freedom plot for both distances</h2><span id='topic+plotDistDoF'></span>

<h3>Description</h3>

<p>Shows a plot with degrees of freedom computed for score and orthogonal distances at given number
of components using data driven approach (&quot;ddmoments&quot; or &quot;ddrobust&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDistDoF(
  obj,
  type = "b",
  labels = "values",
  xticks = seq_len(obj$ncomp),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDistDoF_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotDistDoF_+3A_type">type</code></td>
<td>
<p>type of the plot (&quot;b&quot;, &quot;l&quot;, &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotDistDoF_+3A_labels">labels</code></td>
<td>
<p>what to show as data points labels</p>
</td></tr>
<tr><td><code id="plotDistDoF_+3A_xticks">xticks</code></td>
<td>
<p>vector with tick values for x-axis</p>
</td></tr>
<tr><td><code id="plotDistDoF_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Work only if parameter <code>lim.type</code> equal to &quot;ddmoments&quot; or &quot;ddrobust&quot;.
</p>

<hr>
<h2 id='plotErrorbars'>Show plot series as error bars</h2><span id='topic+plotErrorbars'></span>

<h3>Description</h3>

<p>It is assumed that first row of dataset contains the y-coordinates of points,
second rows contains size of lower error bar and third - size for upper error bar. If
only two rows are provided it is assumed that error bars are symmetric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotErrorbars(ps, col = ps$col, pch = 16, lwd = 1, cex = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotErrorbars_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
<tr><td><code id="plotErrorbars_+3A_col">col</code></td>
<td>
<p>color for the error bars</p>
</td></tr>
<tr><td><code id="plotErrorbars_+3A_pch">pch</code></td>
<td>
<p>marker symbol for the plot</p>
</td></tr>
<tr><td><code id="plotErrorbars_+3A_lwd">lwd</code></td>
<td>
<p>line width for the error bars</p>
</td></tr>
<tr><td><code id="plotErrorbars_+3A_cex">cex</code></td>
<td>
<p>scale factor for the marker</p>
</td></tr>
<tr><td><code id="plotErrorbars_+3A_...">...</code></td>
<td>
<p>other arguments for function 'points()'.</p>
</td></tr>
</table>

<hr>
<h2 id='plotExtreme'>Shows extreme plot for SIMCA model</h2><span id='topic+plotExtreme'></span>

<h3>Description</h3>

<p>Generic function for creating extreme plot for SIMCA model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotExtreme(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotExtreme_+3A_obj">obj</code></td>
<td>
<p>a SIMCA model</p>
</td></tr>
<tr><td><code id="plotExtreme_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotExtreme.pca'>Extreme plot</h2><span id='topic+plotExtreme.pca'></span>

<h3>Description</h3>

<p>Shows a plot with number of expected vs. number of observed extreme objects for different
significance levels (alpha values)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
plotExtreme(
  obj,
  res = obj$res[["cal"]],
  comp = obj$ncomp.selected,
  main = "Extreme plot",
  xlab = "Expected",
  ylab = "Observed",
  pch = rep(21, length(comp)),
  bg = mdaplot.getColors(length(comp)),
  col = rep("white", length(comp)),
  lwd = ifelse(pch %in% 21:25, 0.25, 1),
  cex = rep(1.2, length(comp)),
  ellipse.col = "#cceeff",
  legend.position = "bottomright",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotExtreme.pca_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_res">res</code></td>
<td>
<p>object with PCA results to show the plot for (e.g. calibration, test, etc)</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_comp">comp</code></td>
<td>
<p>vector, number of components to show the plot for</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_main">main</code></td>
<td>
<p>plot title</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_pch">pch</code></td>
<td>
<p>vector with values for <code>pch</code> parameter for each number of components</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_bg">bg</code></td>
<td>
<p>vector with background color values for series of points (if pch=21:25)</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_col">col</code></td>
<td>
<p>vector with color values for series of points</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_lwd">lwd</code></td>
<td>
<p>line width for point symbols</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_cex">cex</code></td>
<td>
<p>scale factor for data points</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_ellipse.col">ellipse.col</code></td>
<td>
<p>color for tolerance ellipse</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_legend.position">legend.position</code></td>
<td>
<p>position of the legend</p>
</td></tr>
<tr><td><code id="plotExtreme.pca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='plotHist'>Statistic histogram</h2><span id='topic+plotHist'></span>

<h3>Description</h3>

<p>Statistic histogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHist(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotHist_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotHist_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting statistic histogram plot
</p>

<hr>
<h2 id='plotHist.randtest'>Histogram plot for randomization test results</h2><span id='topic+plotHist.randtest'></span>

<h3>Description</h3>

<p>Makes a histogram for statistic values distribution for particular component, also
show critical value as a vertical line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randtest'
plotHist(obj, ncomp = obj$ncomp.selected, bwd = 0.9, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotHist.randtest_+3A_obj">obj</code></td>
<td>
<p>results of randomization test (object of class 'randtest')</p>
</td></tr>
<tr><td><code id="plotHist.randtest_+3A_ncomp">ncomp</code></td>
<td>
<p>number of component to make the plot for</p>
</td></tr>
<tr><td><code id="plotHist.randtest_+3A_bwd">bwd</code></td>
<td>
<p>width of bars (between 0 and 1)</p>
</td></tr>
<tr><td><code id="plotHist.randtest_+3A_...">...</code></td>
<td>
<p>other optional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+randtest">randtest</a></code> function.
</p>

<hr>
<h2 id='plotHotellingEllipse'>Hotelling ellipse</h2><span id='topic+plotHotellingEllipse'></span>

<h3>Description</h3>

<p>Add Hotelling ellipse to a scatter plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHotellingEllipse(p, conf.lim = 0.95, col = "#a0a0a0", lty = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotHotellingEllipse_+3A_p">p</code></td>
<td>
<p>plot series (e.g. from PCA scores plot)</p>
</td></tr>
<tr><td><code id="plotHotellingEllipse_+3A_conf.lim">conf.lim</code></td>
<td>
<p>confidence limit</p>
</td></tr>
<tr><td><code id="plotHotellingEllipse_+3A_col">col</code></td>
<td>
<p>color of the ellipse line</p>
</td></tr>
<tr><td><code id="plotHotellingEllipse_+3A_lty">lty</code></td>
<td>
<p>line type (e.g. 1 for solid, 2 for dashed, etc.)</p>
</td></tr>
<tr><td><code id="plotHotellingEllipse_+3A_...">...</code></td>
<td>
<p>any argument suitable for <code>lines</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method is created to be used with PCA and PLS scores plots, so it shows the statistical
limits computed using Hotelling T^2 distribution in form of ellipse. The function works similar
to <code><a href="#topic+plotConvexHull">plotConvexHull</a></code> and <code><a href="#topic+plotConfidenceEllipse">plotConfidenceEllipse</a></code> but does not require
grouping of data points. Can be used together with functions <code><a href="#topic+plotScores.pca">plotScores.pca</a></code>,
<code><a href="#topic+plotScores.ldecomp">plotScores.ldecomp</a></code>, <code><a href="#topic+plotXScores.pls">plotXScores.pls</a></code>,
<code><a href="#topic+plotXScores.plsres">plotXScores.plsres</a></code>.
</p>
<p>See examples for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# create PCA model for People data
data(people)
m &lt;- pca(people, 4, scale = TRUE)

# make scores plot and show Hotelling ellipse with default settings
p &lt;- plotScores(m, xlim = c(-8, 8), ylim = c(-8, 8))
plotHotellingEllipse(p)

# make scores plot and show Hotelling ellipse with manual settings
p &lt;- plotScores(m, xlim = c(-8, 8), ylim = c(-8, 8))
plotHotellingEllipse(p, conf.lim = 0.99, col = "red")

# in case if you have both calibration and test set, 'plotScores()' returns
# plot series data for both, so you have to subset it and take the first series
# (calibration set) as shown below.
ind &lt;- seq(1, 32, by = 4)
xc &lt;- people[-ind, , drop = FALSE]
xt &lt;- people[ind, , drop = FALSE]
m &lt;- pca(xc, 4, scale = TRUE, x.test = xt)

p &lt;- plotScores(m, xlim = c(-8, 8), ylim = c(-8, 8))
plotHotellingEllipse(p[[1]])

</code></pre>

<hr>
<h2 id='plotLines'>Show plot series as set of lines</h2><span id='topic+plotLines'></span>

<h3>Description</h3>

<p>Show plot series as set of lines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLines(
  ps,
  col = ps$col,
  lty = 1,
  lwd = 1,
  cex = 1,
  col.excluded = "darkgray",
  show.excluded = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLines_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
<tr><td><code id="plotLines_+3A_col">col</code></td>
<td>
<p>a color for markers or lines (same as <code>plot</code> parameter).</p>
</td></tr>
<tr><td><code id="plotLines_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="plotLines_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="plotLines_+3A_cex">cex</code></td>
<td>
<p>scale factor for the marker</p>
</td></tr>
<tr><td><code id="plotLines_+3A_col.excluded">col.excluded</code></td>
<td>
<p>color for the excluded lines.</p>
</td></tr>
<tr><td><code id="plotLines_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, show or not the excluded data points</p>
</td></tr>
<tr><td><code id="plotLines_+3A_...">...</code></td>
<td>
<p>other arguments for function 'lines()'.</p>
</td></tr>
</table>

<hr>
<h2 id='plotLoadings'>Loadings plot</h2><span id='topic+plotLoadings'></span>

<h3>Description</h3>

<p>Loadings plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLoadings(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLoadings_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotLoadings_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting loadings values for data decomposition
</p>

<hr>
<h2 id='plotLoadings.pca'>Loadings plot for PCA model</h2><span id='topic+plotLoadings.pca'></span>

<h3>Description</h3>

<p>Shows a loadings plot for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
plotLoadings(
  obj,
  comp = if (obj$ncomp &gt; 1) c(1, 2) else 1,
  type = (if (length(comp == 2)) "p" else "l"),
  show.legend = TRUE,
  show.axes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLoadings.pca_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotLoadings.pca_+3A_comp">comp</code></td>
<td>
<p>a value or vector with several values - number of components to show the plot for</p>
</td></tr>
<tr><td><code id="plotLoadings.pca_+3A_type">type</code></td>
<td>
<p>type of the plot ('b', 'l', 'h')</p>
</td></tr>
<tr><td><code id="plotLoadings.pca_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend on the plot</p>
</td></tr>
<tr><td><code id="plotLoadings.pca_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotLoadings.pca_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pca">pca</a></code> function.
</p>

<hr>
<h2 id='plotMisclassified'>Misclassification ratio plot</h2><span id='topic+plotMisclassified'></span>

<h3>Description</h3>

<p>Misclassification ratio plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMisclassified(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMisclassified_+3A_obj">obj</code></td>
<td>
<p>a model or a result object</p>
</td></tr>
<tr><td><code id="plotMisclassified_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting missclassification values for classification model or results
</p>

<hr>
<h2 id='plotMisclassified.classmodel'>Misclassified ratio plot for classification model</h2><span id='topic+plotMisclassified.classmodel'></span>

<h3>Description</h3>

<p>Makes a plot with misclassified ratio values vs. model complexity (e.g. number of components)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classmodel'
plotMisclassified(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMisclassified.classmodel_+3A_obj">obj</code></td>
<td>
<p>classification model (object of class <code>plsda</code>, <code>simca</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotMisclassified.classmodel_+3A_...">...</code></td>
<td>
<p>parameters for <code><a href="#topic+plotPerformance.classmodel">plotPerformance.classmodel</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsda">plsda</a></code>, <code><a href="#topic+simca">simca</a></code> or <code><a href="#topic+simcam">simcam</a></code>.
</p>

<hr>
<h2 id='plotMisclassified.classres'>Misclassified ratio plot for classification results</h2><span id='topic+plotMisclassified.classres'></span>

<h3>Description</h3>

<p>Makes a plot with ms ratio values vs. model complexity (e.g. number of components) for
classification results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
plotMisclassified(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMisclassified.classres_+3A_obj">obj</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotMisclassified.classres_+3A_...">...</code></td>
<td>
<p>other parameters for <code><a href="#topic+plotPerformance.classres">plotPerformance.classres</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsdares">plsdares</a></code>, <code><a href="#topic+simcamres">simcamres</a></code>, etc.
</p>

<hr>
<h2 id='plotModelDistance'>Model distance plot</h2><span id='topic+plotModelDistance'></span>

<h3>Description</h3>

<p>Model distance plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotModelDistance(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotModelDistance_+3A_obj">obj</code></td>
<td>
<p>a model object</p>
</td></tr>
<tr><td><code id="plotModelDistance_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting distance from object to a multivariate model
</p>

<hr>
<h2 id='plotModelDistance.simcam'>Model distance plot for SIMCAM model</h2><span id='topic+plotModelDistance.simcam'></span>

<h3>Description</h3>

<p>Shows a plot with distance between one SIMCA model to others.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
plotModelDistance(
  obj,
  nc = 1,
  type = "h",
  xticks = seq_len(obj$nclasses),
  xticklabels = obj$classnames,
  main = paste0("Model distance (", obj$classnames[nc], ")"),
  xlab = "Models",
  ylab = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotModelDistance.simcam_+3A_obj">obj</code></td>
<td>
<p>a SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
<tr><td><code id="plotModelDistance.simcam_+3A_nc">nc</code></td>
<td>
<p>one value - number of class (SIMCA model) to show the plot for</p>
</td></tr>
<tr><td><code id="plotModelDistance.simcam_+3A_type">type</code></td>
<td>
<p>type of the plot (&quot;h&quot;, &quot;l&quot; or &quot;b&quot;)</p>
</td></tr>
<tr><td><code id="plotModelDistance.simcam_+3A_xticks">xticks</code></td>
<td>
<p>vector with tick values for x-axis</p>
</td></tr>
<tr><td><code id="plotModelDistance.simcam_+3A_xticklabels">xticklabels</code></td>
<td>
<p>vector with tick labels for x-axis</p>
</td></tr>
<tr><td><code id="plotModelDistance.simcam_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotModelDistance.simcam_+3A_xlab">xlab</code></td>
<td>
<p>label for x axis</p>
</td></tr>
<tr><td><code id="plotModelDistance.simcam_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="plotModelDistance.simcam_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot shows similarity between a selected model and the others as a ratio of residual
variance using the following algorithm. Let's take two SIMCA/PCA models, m1 and m2, which
have optimal number of components A1 and A2. The models have been calibrated
using calibration sets X1 and X2 with number of rows n1 and n2.
Then we do the following:
</p>

<ol>
<li><p> Project X2 to model m1 and compute residuals, E12
</p>
</li>
<li><p> Compute variance of the residuals as s12 = sum(E12^2) / n1
</p>
</li>
<li><p> Project X1 to model m2 and compute residuals, E21
</p>
</li>
<li><p> Compute variance of the residuals as s21 = sum(E21^2) / n2
</p>
</li>
<li><p> Compute variance of residuals for m1 as s1 = sum(E1^2) / (n1 - A1 - 1)
</p>
</li>
<li><p> Compute variance of residuals for m2 as s2 = sum(E2^2) / (n2 - A2 - 1)
</p>
</li></ol>

<p>The model distance then can be computed as: d = sqrt((s12 + s21) / (s1 + s2))
</p>
<p>As one can see, if the two models and corresponding calibration sets are identical, then the
distance will be sqrt((n - A - 1) / n). For example, if n = 25 and A = 2, then the distance
between the model and itself is sqrt(22/25) = sqrt(0.88) = 0.938. This case is demonstrated
in the example section.
</p>
<p>In general, if distance between models is below one classes are overlapping. If it is above 3
the classes are well separated.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create two calibration sets with n = 25 objects in each
data(iris)
x1 &lt;- iris[1:25, 1:4]
x2 &lt;- iris[51:75, 1:4]

# create to SIMCA models with A = 2
m1 &lt;- simca(x1, 'setosa', ncomp = 2)
m2 &lt;- simca(x2, 'versicolor', ncomp = 2)

# combine the models into SIMCAM class
m &lt;- simcam(list(m1, m2))

# show the model distance plot with distance values as labels
# note, that distance between setosa and setosa is 0.938
plotModelDistance(m, show.labels = TRUE, labels = "values")

</code></pre>

<hr>
<h2 id='plotModellingPower'>Modelling power plot</h2><span id='topic+plotModellingPower'></span>

<h3>Description</h3>

<p>Modelling power plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotModellingPower(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotModellingPower_+3A_obj">obj</code></td>
<td>
<p>a model object</p>
</td></tr>
<tr><td><code id="plotModellingPower_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting modelling power values for classification model
</p>

<hr>
<h2 id='plotPerformance'>Classification performance plot</h2><span id='topic+plotPerformance'></span>

<h3>Description</h3>

<p>Classification performance plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPerformance(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPerformance_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotPerformance_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting classification performance for model or results
</p>

<hr>
<h2 id='plotPerformance.classmodel'>Performance plot for classification model</h2><span id='topic+plotPerformance.classmodel'></span>

<h3>Description</h3>

<p>Makes a plot with sensitivity values vs. model complexity (e.g. number of components)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classmodel'
plotPerformance(
  obj,
  nc = 1,
  param = "misclassified",
  type = "b",
  labels = "values",
  ylab = "",
  ylim = c(0, 1.15),
  xticks = seq_len(dim(obj$res$cal$c.pred)[2]),
  res = obj$res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPerformance.classmodel_+3A_obj">obj</code></td>
<td>
<p>classification model (object of class <code>plsda</code>, <code>simca</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_nc">nc</code></td>
<td>
<p>class number to make the plot for.</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_param">param</code></td>
<td>
<p>which parameter to make the plot for (<code>"specificity"</code>, <code>"sensitivity"</code>,
or <code>"misclassified"</code>)</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_labels">labels</code></td>
<td>
<p>what to show as labels for plot objects.</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_ylim">ylim</code></td>
<td>
<p>vector with two values - limits for y axis</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_xticks">xticks</code></td>
<td>
<p>vector with tick values for x-axis</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_res">res</code></td>
<td>
<p>list with result objects to show the plot for</p>
</td></tr>
<tr><td><code id="plotPerformance.classmodel_+3A_...">...</code></td>
<td>
<p>most of the graphical parameters from <code><a href="#topic+mdaplotg">mdaplotg</a></code> function can be used.</p>
</td></tr>
</table>

<hr>
<h2 id='plotPerformance.classres'>Performance plot for classification results</h2><span id='topic+plotPerformance.classres'></span>

<h3>Description</h3>

<p>Makes a plot with classification performance parameters vs. model complexity (e.g. number of
components) for classification results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
plotPerformance(
  obj,
  nc = 1,
  type = "b",
  param = c("sensitivity", "specificity", "misclassified"),
  labels = "values",
  ylab = "",
  ylim = c(0, 1.1),
  xticks = seq_len(obj$ncomp),
  show.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPerformance.classres_+3A_obj">obj</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_nc">nc</code></td>
<td>
<p>if there are several classes, which class to make the plot for.</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_param">param</code></td>
<td>
<p>which performance parameter to make the plot for (can be a vector with several values).</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_labels">labels</code></td>
<td>
<p>what to show as labels for plot objects.</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_ylim">ylim</code></td>
<td>
<p>vector with two values - limits for y axis</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_xticks">xticks</code></td>
<td>
<p>vector with x-axis tick values</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, shall plot be created or just plot series object is needed</p>
</td></tr>
<tr><td><code id="plotPerformance.classres_+3A_...">...</code></td>
<td>
<p>most of the graphical parameters from <code><a href="#topic+mdaplot">mdaplot</a></code> function can be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsdares">plsdares</a></code>, <code><a href="#topic+simcamres">simcamres</a></code>, etc.
</p>

<hr>
<h2 id='plotPointsShape'>Add confidence ellipse or convex hull for group of points</h2><span id='topic+plotPointsShape'></span>

<h3>Description</h3>

<p>Add confidence ellipse or convex hull for group of points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPointsShape(p, lwd, lty, opacity, shape_function, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPointsShape_+3A_p">p</code></td>
<td>
<p>plot data returned by function 'mdaplot()'</p>
</td></tr>
<tr><td><code id="plotPointsShape_+3A_lwd">lwd</code></td>
<td>
<p>thickness of line used to show the hull</p>
</td></tr>
<tr><td><code id="plotPointsShape_+3A_lty">lty</code></td>
<td>
<p>type of line used to show the hull</p>
</td></tr>
<tr><td><code id="plotPointsShape_+3A_opacity">opacity</code></td>
<td>
<p>of opacity is larger than 0 a semi-transparent polygon is shown over points</p>
</td></tr>
<tr><td><code id="plotPointsShape_+3A_shape_function">shape_function</code></td>
<td>
<p>function which calculates and return coordinates of the shape</p>
</td></tr>
<tr><td><code id="plotPointsShape_+3A_...">...</code></td>
<td>
<p>extra parameters for shape_function</p>
</td></tr>
</table>

<hr>
<h2 id='plotPredictions'>Predictions plot</h2><span id='topic+plotPredictions'></span>

<h3>Description</h3>

<p>Predictions plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPredictions(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPredictions_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotPredictions_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting predicted values for classification or regression model or results
</p>

<hr>
<h2 id='plotPredictions.classmodel'>Predictions plot for classification model</h2><span id='topic+plotPredictions.classmodel'></span>

<h3>Description</h3>

<p>Makes a plot with class predictions for a classification model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classmodel'
plotPredictions(
  obj,
  res.name = NULL,
  nc = seq_len(obj$nclasses),
  ncomp = NULL,
  main = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPredictions.classmodel_+3A_obj">obj</code></td>
<td>
<p>a classification model (object of class <code>simca</code>, <code>plsda</code>, etc.). if <code>NULL</code> value
is specified, the result will be selected automatically by checking the nearest available from
test, cv and calibration results.</p>
</td></tr>
<tr><td><code id="plotPredictions.classmodel_+3A_res.name">res.name</code></td>
<td>
<p>name of result object to make the plot for (&quot;test&quot;, &quot;cv&quot; or &quot;cal&quot;).</p>
</td></tr>
<tr><td><code id="plotPredictions.classmodel_+3A_nc">nc</code></td>
<td>
<p>vector with class numbers to make the plot for.</p>
</td></tr>
<tr><td><code id="plotPredictions.classmodel_+3A_ncomp">ncomp</code></td>
<td>
<p>what number of components to make the plot for.</p>
</td></tr>
<tr><td><code id="plotPredictions.classmodel_+3A_main">main</code></td>
<td>
<p>title of the plot (if NULL will be set automatically)</p>
</td></tr>
<tr><td><code id="plotPredictions.classmodel_+3A_...">...</code></td>
<td>
<p>most of the graphical parameters from <code><a href="#topic+mdaplotg">mdaplotg</a></code> function can be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsda">plsda</a></code>, <code><a href="#topic+simca">simca</a></code> or <code><a href="#topic+simcam">simcam</a></code>.
</p>

<hr>
<h2 id='plotPredictions.classres'>Prediction plot for classification results</h2><span id='topic+plotPredictions.classres'></span>

<h3>Description</h3>

<p>Makes a plot with predicted class values for classification results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
plotPredictions(
  obj,
  nc = seq_len(obj$nclasses),
  ncomp = obj$ncomp.selected,
  ylab = "",
  show.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPredictions.classres_+3A_obj">obj</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotPredictions.classres_+3A_nc">nc</code></td>
<td>
<p>vector with classes to show predictions for.</p>
</td></tr>
<tr><td><code id="plotPredictions.classres_+3A_ncomp">ncomp</code></td>
<td>
<p>model complexity (number of components) to make the plot for.</p>
</td></tr>
<tr><td><code id="plotPredictions.classres_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="plotPredictions.classres_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, shall plot be created or just plot series object is needed</p>
</td></tr>
<tr><td><code id="plotPredictions.classres_+3A_...">...</code></td>
<td>
<p>most of the graphical parameters from <code><a href="#topic+mdaplotg">mdaplotg</a></code> or <code><a href="#topic+mdaplot">mdaplot</a></code> function
can be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsdares">plsdares</a></code>, <code><a href="#topic+simcamres">simcamres</a></code>, etc.
</p>

<hr>
<h2 id='plotPredictions.regmodel'>Predictions plot for regression model</h2><span id='topic+plotPredictions.regmodel'></span>

<h3>Description</h3>

<p>Shows plot with predicted vs. reference (measured) y values for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmodel'
plotPredictions(
  obj,
  ncomp = obj$ncomp.selected,
  ny = 1,
  legend.position = "topleft",
  show.line = TRUE,
  res = obj$res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPredictions.regmodel_+3A_obj">obj</code></td>
<td>
<p>a regression model (object of class <code>regmodel</code>)</p>
</td></tr>
<tr><td><code id="plotPredictions.regmodel_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="plotPredictions.regmodel_+3A_ny">ny</code></td>
<td>
<p>number of response variable to make the plot for (if y is multivariate)</p>
</td></tr>
<tr><td><code id="plotPredictions.regmodel_+3A_legend.position">legend.position</code></td>
<td>
<p>position of legend on the plot (if shown)</p>
</td></tr>
<tr><td><code id="plotPredictions.regmodel_+3A_show.line">show.line</code></td>
<td>
<p>logical, show or not line fit for the plot points</p>
</td></tr>
<tr><td><code id="plotPredictions.regmodel_+3A_res">res</code></td>
<td>
<p>list with result objects</p>
</td></tr>
<tr><td><code id="plotPredictions.regmodel_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>

<hr>
<h2 id='plotPredictions.regres'>Predictions plot for regression results</h2><span id='topic+plotPredictions.regres'></span>

<h3>Description</h3>

<p>Shows plot with predicted y values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regres'
plotPredictions(
  obj,
  ny = 1,
  ncomp = obj$ncomp.selected,
  show.line = TRUE,
  show.stat = FALSE,
  stat.col = "#606060",
  stat.cex = 0.85,
  xlim = NULL,
  ylim = NULL,
  axes.equal = TRUE,
  show.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPredictions.regres_+3A_obj">obj</code></td>
<td>
<p>regression results (object of class <code>regres</code>)</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_ny">ny</code></td>
<td>
<p>number of predictor to show the plot for (if y is multivariate)</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_ncomp">ncomp</code></td>
<td>
<p>complexity of model (e.g. number of components) to show the plot for</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_show.line">show.line</code></td>
<td>
<p>logical, show or not line fit for the plot points</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_show.stat">show.stat</code></td>
<td>
<p>logical, show or not legend with statistics on the plot</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_stat.col">stat.col</code></td>
<td>
<p>color of text in legend with statistics</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_stat.cex">stat.cex</code></td>
<td>
<p>size of text in legend with statistics</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_xlim">xlim</code></td>
<td>
<p>limits for x-axis (if NULL will be computed automatically)</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_ylim">ylim</code></td>
<td>
<p>limits for y-axis (if NULL will be computed automatically)</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_axes.equal">axes.equal</code></td>
<td>
<p>logical, make limits for x and y axes equal or not</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, show plot or just return plot data</p>
</td></tr>
<tr><td><code id="plotPredictions.regres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If reference values are available, the function shows a scatter plot with predicted vs.
reference values, otherwise predicted values are shown vs. object numbers.
</p>

<hr>
<h2 id='plotPredictions.simcam'>Predictions plot for SIMCAM model</h2><span id='topic+plotPredictions.simcam'></span>

<h3>Description</h3>

<p>Makes a plot with class predictions for calibration dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
plotPredictions(
  obj,
  nc = seq_len(obj$nclasses),
  main = "SIMCAM Predictions (cal)",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPredictions.simcam_+3A_obj">obj</code></td>
<td>
<p>a SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
<tr><td><code id="plotPredictions.simcam_+3A_nc">nc</code></td>
<td>
<p>vector with class numbers to make the plot for.</p>
</td></tr>
<tr><td><code id="plotPredictions.simcam_+3A_main">main</code></td>
<td>
<p>plot title.</p>
</td></tr>
<tr><td><code id="plotPredictions.simcam_+3A_...">...</code></td>
<td>
<p>most of the graphical parameters from <code><a href="#topic+mdaplotg">mdaplotg</a></code> function can be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsda">plsda</a></code>, <code><a href="#topic+simca">simca</a></code> or <code><a href="#topic+simcam">simcam</a></code>.
</p>

<hr>
<h2 id='plotPredictions.simcamres'>Prediction plot for SIMCAM results</h2><span id='topic+plotPredictions.simcamres'></span>

<h3>Description</h3>

<p>Makes a plot with predicted class values for classification results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcamres'
plotPredictions(obj, nc = seq_len(obj$nclasses), main = "Predictions", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPredictions.simcamres_+3A_obj">obj</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotPredictions.simcamres_+3A_nc">nc</code></td>
<td>
<p>vector with classes to show predictions for.</p>
</td></tr>
<tr><td><code id="plotPredictions.simcamres_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
<tr><td><code id="plotPredictions.simcamres_+3A_...">...</code></td>
<td>
<p>most of the graphical parameters from <code><a href="#topic+mdaplotg">mdaplotg</a></code> or <code><a href="#topic+mdaplot">mdaplot</a></code> function
can be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsdares">plsdares</a></code>, <code><a href="#topic+simcamres">simcamres</a></code>, etc.
</p>

<hr>
<h2 id='plotProbabilities'>Plot for class belonging probability</h2><span id='topic+plotProbabilities'></span>

<h3>Description</h3>

<p>Makes a plot with class belonging probabilities for each object of the classification results.
Works only with classification methods, which compute this probability (e.g. SIMCA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotProbabilities(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotProbabilities_+3A_obj">obj</code></td>
<td>
<p>an object with classification results (e.g. SIMCA)</p>
</td></tr>
<tr><td><code id="plotProbabilities_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotProbabilities.classres'>Plot for class belonging probability</h2><span id='topic+plotProbabilities.classres'></span>

<h3>Description</h3>

<p>Makes a plot with class belonging probabilities for each object of the classification results.
Works only with classification methods, which compute this probability (e.g. SIMCA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
plotProbabilities(
  obj,
  ncomp = obj$ncomp.selected,
  nc = 1,
  type = "h",
  ylim = c(0, 1.1),
  show.lines = c(NA, 0.5),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotProbabilities.classres_+3A_obj">obj</code></td>
<td>
<p>classification results (e.g. object of class <code>simcamres</code>).</p>
</td></tr>
<tr><td><code id="plotProbabilities.classres_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to use the probabilities for.</p>
</td></tr>
<tr><td><code id="plotProbabilities.classres_+3A_nc">nc</code></td>
<td>
<p>if there are several classes, which class to make the plot for.</p>
</td></tr>
<tr><td><code id="plotProbabilities.classres_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotProbabilities.classres_+3A_ylim">ylim</code></td>
<td>
<p>vector with limits for y-axis</p>
</td></tr>
<tr><td><code id="plotProbabilities.classres_+3A_show.lines">show.lines</code></td>
<td>
<p>shows a horizontal line at p = 0.5</p>
</td></tr>
<tr><td><code id="plotProbabilities.classres_+3A_...">...</code></td>
<td>
<p>most of the graphical parameters from <code><a href="#topic+mdaplot">mdaplot</a></code> function can be used.</p>
</td></tr>
</table>

<hr>
<h2 id='plotPurity'>Plot purity values</h2><span id='topic+plotPurity'></span>

<h3>Description</h3>

<p>Plot purity values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPurity(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPurity_+3A_obj">obj</code></td>
<td>
<p>object with mcr pure case</p>
</td></tr>
<tr><td><code id="plotPurity_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotPurity.mcrpure'>Purity values plot</h2><span id='topic+plotPurity.mcrpure'></span>

<h3>Description</h3>

<p>Purity values plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcrpure'
plotPurity(
  obj,
  xticks = seq_len(obj$ncomp),
  type = "h",
  labels = "values",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPurity.mcrpure_+3A_obj">obj</code></td>
<td>
<p><code>mcrpure</code> object</p>
</td></tr>
<tr><td><code id="plotPurity.mcrpure_+3A_xticks">xticks</code></td>
<td>
<p>ticks for x axis</p>
</td></tr>
<tr><td><code id="plotPurity.mcrpure_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotPurity.mcrpure_+3A_labels">labels</code></td>
<td>
<p>what to use as data labels</p>
</td></tr>
<tr><td><code id="plotPurity.mcrpure_+3A_...">...</code></td>
<td>
<p>other parameters suitable for <code>mdaplot</code>
</p>
<p>The plot shows largest weighted purity value for each component graphically.</p>
</td></tr>
</table>

<hr>
<h2 id='plotPuritySpectra'>Plot purity spectra</h2><span id='topic+plotPuritySpectra'></span>

<h3>Description</h3>

<p>Plot purity spectra
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPuritySpectra(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPuritySpectra_+3A_obj">obj</code></td>
<td>
<p>object with mcr pure case</p>
</td></tr>
<tr><td><code id="plotPuritySpectra_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotPuritySpectra.mcrpure'>Purity spectra plot</h2><span id='topic+plotPuritySpectra.mcrpure'></span>

<h3>Description</h3>

<p>Purity spectra plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcrpure'
plotPuritySpectra(
  obj,
  comp = seq_len(obj$ncomp),
  type = "l",
  col = mdaplot.getColors(obj$ncomp),
  show.lines = TRUE,
  lines.col = adjustcolor(col, alpha.f = 0.75),
  lines.lty = 3,
  lines.lwd = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_obj">obj</code></td>
<td>
<p><code>mcrpure</code> object</p>
</td></tr>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_comp">comp</code></td>
<td>
<p>vector of components to show the purity spectra for</p>
</td></tr>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_col">col</code></td>
<td>
<p>colors for the plot (should be a vector with one value for each component in <code>obj</code>)</p>
</td></tr>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_show.lines">show.lines</code></td>
<td>
<p>if <code>TRUE</code> show the selected pure variables as vertical lines</p>
</td></tr>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_lines.col">lines.col</code></td>
<td>
<p>color for the selected pure variable lines (by default same as for plots but semitransparent)</p>
</td></tr>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_lines.lty">lines.lty</code></td>
<td>
<p>line type for the purity lines</p>
</td></tr>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_lines.lwd">lines.lwd</code></td>
<td>
<p>line width for the purity lines</p>
</td></tr>
<tr><td><code id="plotPuritySpectra.mcrpure_+3A_...">...</code></td>
<td>
<p>other parameters suitable for <code>mdaplotg</code>
</p>
<p>The plot shows weighted purity value of each variable separately for each specified component.</p>
</td></tr>
</table>

<hr>
<h2 id='plotQDoF'>Degrees of freedom plot for orthogonal distance (Nh)</h2><span id='topic+plotQDoF'></span>

<h3>Description</h3>

<p>Shows a plot with degrees of freedom computed for score distances at given number
of components using data driven approach (&quot;ddmoments&quot; or &quot;ddrobust&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQDoF(
  obj,
  type = "b",
  labels = "values",
  xticks = seq_len(obj$ncomp),
  ylab = "Nq",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQDoF_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotQDoF_+3A_type">type</code></td>
<td>
<p>type of the plot (&quot;b&quot;, &quot;l&quot;, &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotQDoF_+3A_labels">labels</code></td>
<td>
<p>what to show as data points labels</p>
</td></tr>
<tr><td><code id="plotQDoF_+3A_xticks">xticks</code></td>
<td>
<p>vector with tick values for x-axis</p>
</td></tr>
<tr><td><code id="plotQDoF_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotQDoF_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Work only if parameter <code>lim.type</code> equal to &quot;ddmoments&quot; or &quot;ddrobust&quot;.
</p>

<hr>
<h2 id='plotRegcoeffs'>Regression coefficients plot</h2><span id='topic+plotRegcoeffs'></span>

<h3>Description</h3>

<p>Regression coefficients plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRegcoeffs(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRegcoeffs_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotRegcoeffs_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting regression coefficients values for a regression model
</p>

<hr>
<h2 id='plotRegcoeffs.regmodel'>Regression coefficient plot for regression model</h2><span id='topic+plotRegcoeffs.regmodel'></span>

<h3>Description</h3>

<p>Shows plot with regression coefficient values. Is a proxy for <code>link{plot.regcoeffs}</code> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmodel'
plotRegcoeffs(obj, ncomp = obj$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRegcoeffs.regmodel_+3A_obj">obj</code></td>
<td>
<p>a regression model (object of class <code>regmodel</code>)</p>
</td></tr>
<tr><td><code id="plotRegcoeffs.regmodel_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to show the plot for</p>
</td></tr>
<tr><td><code id="plotRegcoeffs.regmodel_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>link{plot.regcoeffs}</code> for details)</p>
</td></tr>
</table>

<hr>
<h2 id='plotRegressionLine'>Add regression line for data points</h2><span id='topic+plotRegressionLine'></span>

<h3>Description</h3>

<p>Shows linear fit line for data points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRegressionLine(p, col = p$col, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRegressionLine_+3A_p">p</code></td>
<td>
<p>plot data returned by function 'mdaplot()'</p>
</td></tr>
<tr><td><code id="plotRegressionLine_+3A_col">col</code></td>
<td>
<p>color of line</p>
</td></tr>
<tr><td><code id="plotRegressionLine_+3A_...">...</code></td>
<td>
<p>other parameters available for 'abline()' function</p>
</td></tr>
</table>

<hr>
<h2 id='plotResiduals'>Residuals plot</h2><span id='topic+plotResiduals'></span>

<h3>Description</h3>

<p>Residuals plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotResiduals(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotResiduals_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotResiduals_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting residual values for data decomposition
</p>

<hr>
<h2 id='plotResiduals.ldecomp'>Residual distance plot</h2><span id='topic+plotResiduals.ldecomp'></span>

<h3>Description</h3>

<p>Shows a plot with orthogonal (Q, q) vs. score (T2, h) distances for data objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ldecomp'
plotResiduals(
  obj,
  ncomp = obj$ncomp.selected,
  norm = FALSE,
  log = FALSE,
  show.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotResiduals.ldecomp_+3A_obj">obj</code></td>
<td>
<p>object of <code>ldecomp</code> class.</p>
</td></tr>
<tr><td><code id="plotResiduals.ldecomp_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to show the plot for (if NULL, selected by model value will be used).</p>
</td></tr>
<tr><td><code id="plotResiduals.ldecomp_+3A_norm">norm</code></td>
<td>
<p>logical, normalize distance values or not (see details)</p>
</td></tr>
<tr><td><code id="plotResiduals.ldecomp_+3A_log">log</code></td>
<td>
<p>logical, apply log tranformation to the distances or not (see details)</p>
</td></tr>
<tr><td><code id="plotResiduals.ldecomp_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, shall plot be created or just plot series object is needed</p>
</td></tr>
<tr><td><code id="plotResiduals.ldecomp_+3A_...">...</code></td>
<td>
<p>most of graphical parameters from <code><a href="#topic+mdaplot">mdaplot</a></code> function can be used.</p>
</td></tr>
</table>

<hr>
<h2 id='plotResiduals.pca'>Residuals distance plot for PCA model</h2><span id='topic+plotResiduals.pca'></span>

<h3>Description</h3>

<p>Shows a plot with score (T2, h) vs orthogonal (Q, q) distances and corresponding critical
limits for given number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
plotResiduals(
  obj,
  ncomp = obj$ncomp.selected,
  log = FALSE,
  norm = TRUE,
  cgroup = NULL,
  xlim = NULL,
  ylim = NULL,
  show.limits = TRUE,
  lim.col = c("darkgray", "darkgray"),
  lim.lwd = c(1, 1),
  lim.lty = c(2, 3),
  res = obj$res,
  show.legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotResiduals.pca_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (by default optimal value selected for the model will be used)</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_log">log</code></td>
<td>
<p>logical, apply log tranformation to the distances or not (see details)</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_norm">norm</code></td>
<td>
<p>logical, normalize distance values or not (see details)</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_cgroup">cgroup</code></td>
<td>
<p>color grouping of plot points (works only if one result object is available)</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_xlim">xlim</code></td>
<td>
<p>limits for x-axis</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_ylim">ylim</code></td>
<td>
<p>limits for y-axis</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_show.limits">show.limits</code></td>
<td>
<p>logical, show or not lines/curves with critical limits for the distances</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_lim.col">lim.col</code></td>
<td>
<p>vector with two values - line color for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_lim.lwd">lim.lwd</code></td>
<td>
<p>vector with two values - line width for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_lim.lty">lim.lty</code></td>
<td>
<p>vector with two values - line type for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_res">res</code></td>
<td>
<p>list with result objects to show the plot for (by defaul, model results are used)</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend on the plot (needed if several result objects are available)</p>
</td></tr>
<tr><td><code id="plotResiduals.pca_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is a bit more advanced version of <code><a href="#topic+plotResiduals.ldecomp">plotResiduals.ldecomp</a></code>. It allows to
show distance values for several result objects (e.g. calibration and test set or calibration
and new prediction set) as well as display the correspondng critical limits in form of lines
or curves.
</p>
<p>Depending on how many result objects your model has or how many you specified manually,
using the <code>res</code> parameter, the plot behaves in a bit different way.
</p>
<p>If only one result object is provided, then it allows to colorise the points using <code>cgroup</code>
parameter. If you specify <code>cgroup = "categories"</code> then it will show points as three groups:
normal, extreme and outliers. If two or more result objects are provided, then the function show
distances in groups, and adds corresponding legend.
</p>
<p>The function can show distance values normalised (h/h0 and q/q0) as well as with log
transformation (log(1 + h/h0), log(1 + q/q0)). The latter is useful if distribution of the
points is skewed and most of them are densely located around bottom left corner.
</p>
<p>See examples in help for <code><a href="#topic+pca">pca</a></code> function.
</p>

<hr>
<h2 id='plotResiduals.regres'>Residuals plot for regression results</h2><span id='topic+plotResiduals.regres'></span>

<h3>Description</h3>

<p>Shows plot with Y residuals (difference between predicted and reference values) for selected
response variable and complexity (number of components).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regres'
plotResiduals(
  obj,
  ny = 1,
  ncomp = obj$ncomp.selected,
  show.lines = c(NA, 0),
  show.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotResiduals.regres_+3A_obj">obj</code></td>
<td>
<p>regression results (object of class <code>regres</code>)</p>
</td></tr>
<tr><td><code id="plotResiduals.regres_+3A_ny">ny</code></td>
<td>
<p>number of predictor to show the plot for (if y is multivariate)</p>
</td></tr>
<tr><td><code id="plotResiduals.regres_+3A_ncomp">ncomp</code></td>
<td>
<p>complexity of model (e.g. number of components) to show the plot for</p>
</td></tr>
<tr><td><code id="plotResiduals.regres_+3A_show.lines">show.lines</code></td>
<td>
<p>allows to show the horisontal line at y = 0</p>
</td></tr>
<tr><td><code id="plotResiduals.regres_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, show plot or just return plot data</p>
</td></tr>
<tr><td><code id="plotResiduals.regres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>

<hr>
<h2 id='plotRMSE'>RMSE plot</h2><span id='topic+plotRMSE'></span>

<h3>Description</h3>

<p>RMSE plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRMSE(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRMSE_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotRMSE_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting RMSE values vs. complexity of a regression model
</p>

<hr>
<h2 id='plotRMSE.ipls'>RMSE development plot</h2><span id='topic+plotRMSE.ipls'></span>

<h3>Description</h3>

<p>Shows how RMSE develops for each iteration of iPLS selection
algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipls'
plotRMSE(
  obj,
  glob.ncomp = obj$gm$ncomp.selected,
  main = "RMSE development",
  xlab = "Iterations",
  ylab = if (is.null(obj$cv)) "RMSEP" else "RMSECV",
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRMSE.ipls_+3A_obj">obj</code></td>
<td>
<p>iPLS results (object of class ipls).</p>
</td></tr>
<tr><td><code id="plotRMSE.ipls_+3A_glob.ncomp">glob.ncomp</code></td>
<td>
<p>number of components for global PLS model with all intervals.</p>
</td></tr>
<tr><td><code id="plotRMSE.ipls_+3A_main">main</code></td>
<td>
<p>main title for the plot.</p>
</td></tr>
<tr><td><code id="plotRMSE.ipls_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis.</p>
</td></tr>
<tr><td><code id="plotRMSE.ipls_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis.</p>
</td></tr>
<tr><td><code id="plotRMSE.ipls_+3A_xlim">xlim</code></td>
<td>
<p>limits for x-axis.</p>
</td></tr>
<tr><td><code id="plotRMSE.ipls_+3A_ylim">ylim</code></td>
<td>
<p>limits for y-axis.</p>
</td></tr>
<tr><td><code id="plotRMSE.ipls_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot shows RMSE values obtained at each iteration of the iPLS algorithm as bars. The first
bar correspond to the global model with all variables included, second - to the model obtained
at the first iteration and so on. Number at the bottom of each bar corresponds to the interval
included or excluded at the particular iteration.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.ipls">summary.ipls</a></code>, <code><a href="#topic+plotSelection.ipls">plotSelection.ipls</a></code>
</p>

<hr>
<h2 id='plotRMSE.regmodel'>RMSE plot for regression model</h2><span id='topic+plotRMSE.regmodel'></span>

<h3>Description</h3>

<p>Shows plot with root mean squared error values vs. number of components for PLS model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmodel'
plotRMSE(
  obj,
  ny = 1,
  type = "b",
  labels = "values",
  xticks = seq_len(obj$ncomp),
  res = obj$res,
  ylab = paste0("RMSE (", obj$res$cal$respnames[ny], ")"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRMSE.regmodel_+3A_obj">obj</code></td>
<td>
<p>a regression model (object of class <code>regmodel</code>)</p>
</td></tr>
<tr><td><code id="plotRMSE.regmodel_+3A_ny">ny</code></td>
<td>
<p>number of response variable to make the plot for (if y is multivariate)</p>
</td></tr>
<tr><td><code id="plotRMSE.regmodel_+3A_type">type</code></td>
<td>
<p>type of the plot(&quot;b&quot;, &quot;l&quot; or &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotRMSE.regmodel_+3A_labels">labels</code></td>
<td>
<p>what to show as labels (vector or name, e.g. &quot;names&quot;, &quot;values&quot;, &quot;indices&quot;)</p>
</td></tr>
<tr><td><code id="plotRMSE.regmodel_+3A_xticks">xticks</code></td>
<td>
<p>vector with ticks for x-axis values</p>
</td></tr>
<tr><td><code id="plotRMSE.regmodel_+3A_res">res</code></td>
<td>
<p>list with result objects</p>
</td></tr>
<tr><td><code id="plotRMSE.regmodel_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotRMSE.regmodel_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>

<hr>
<h2 id='plotRMSE.regres'>RMSE plot for regression results</h2><span id='topic+plotRMSE.regres'></span>

<h3>Description</h3>

<p>Shows plot with RMSE values vs. model complexity (e.g. number of components).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regres'
plotRMSE(
  obj,
  ny = 1,
  type = "b",
  xticks = seq_len(obj$ncomp),
  labels = "values",
  show.plot = TRUE,
  ylab = paste0("RMSE (", obj$respnames[ny], ")"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRMSE.regres_+3A_obj">obj</code></td>
<td>
<p>regression results (object of class <code>regres</code>)</p>
</td></tr>
<tr><td><code id="plotRMSE.regres_+3A_ny">ny</code></td>
<td>
<p>number of predictor to show the plot for (if y is multivariate)</p>
</td></tr>
<tr><td><code id="plotRMSE.regres_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotRMSE.regres_+3A_xticks">xticks</code></td>
<td>
<p>vector with ticks for x-axis</p>
</td></tr>
<tr><td><code id="plotRMSE.regres_+3A_labels">labels</code></td>
<td>
<p>what to use as labels (&quot;names&quot;, &quot;values&quot; or &quot;indices&quot;)</p>
</td></tr>
<tr><td><code id="plotRMSE.regres_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, show plot or just return plot data</p>
</td></tr>
<tr><td><code id="plotRMSE.regres_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotRMSE.regres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>

<hr>
<h2 id='plotRMSERatio'>Plot for ratio RMSEC/RMSECV vs RMSECV</h2><span id='topic+plotRMSERatio'></span>

<h3>Description</h3>

<p>Plot for ratio RMSEC/RMSECV vs RMSECV
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRMSERatio(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRMSERatio_+3A_obj">obj</code></td>
<td>
<p>object with any regression model</p>
</td></tr>
<tr><td><code id="plotRMSERatio_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotRMSERatio.regmodel'>RMSECV/RMSEC ratio plot for regression model</h2><span id='topic+plotRMSERatio.regmodel'></span>

<h3>Description</h3>

<p>Shows plot with RMSECV/RMSEC values vs. RMSECV for each component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmodel'
plotRMSERatio(
  obj,
  ny = 1,
  type = "b",
  show.labels = TRUE,
  labels = seq_len(obj$ncomp),
  main = paste0("RMSECV/RMSEC ratio (", obj$res$cal$respnames[ny], ")"),
  ylab = "RMSECV/RMSEC ratio",
  xlab = "RMSECV",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRMSERatio.regmodel_+3A_obj">obj</code></td>
<td>
<p>a regression model (object of class <code>regmodel</code>)</p>
</td></tr>
<tr><td><code id="plotRMSERatio.regmodel_+3A_ny">ny</code></td>
<td>
<p>number of response variable to make the plot for (if y is multivariate)</p>
</td></tr>
<tr><td><code id="plotRMSERatio.regmodel_+3A_type">type</code></td>
<td>
<p>type of the plot (use only &quot;b&quot; or &quot;l&quot;)</p>
</td></tr>
<tr><td><code id="plotRMSERatio.regmodel_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for plot points</p>
</td></tr>
<tr><td><code id="plotRMSERatio.regmodel_+3A_labels">labels</code></td>
<td>
<p>vector with point labels (by default number of components)</p>
</td></tr>
<tr><td><code id="plotRMSERatio.regmodel_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotRMSERatio.regmodel_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotRMSERatio.regmodel_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis</p>
</td></tr>
<tr><td><code id="plotRMSERatio.regmodel_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>

<hr>
<h2 id='plotScatter'>Show plot series as set of points</h2><span id='topic+plotScatter'></span>

<h3>Description</h3>

<p>Show plot series as set of points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotScatter(
  ps,
  pch = 16,
  col = ps$col,
  bg = "white",
  lwd = 1,
  cex = 1,
  col.excluded = "lightgray",
  pch.colinv = FALSE,
  show.excluded = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotScatter_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_pch">pch</code></td>
<td>
<p>size of point markers</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_col">col</code></td>
<td>
<p>color of the points</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_bg">bg</code></td>
<td>
<p>background color of the points if 'pch=21:25'</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_lwd">lwd</code></td>
<td>
<p>line width for the error bars</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_cex">cex</code></td>
<td>
<p>scale factor for the marker</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_col.excluded">col.excluded</code></td>
<td>
<p>color for excluded values (if must be shown)</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_pch.colinv">pch.colinv</code></td>
<td>
<p>logical, should 'col' and 'bg' be switched if 'pch=21:25' and 'cgroup' is used to create colors.</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, show or not the excluded data points</p>
</td></tr>
<tr><td><code id="plotScatter_+3A_...">...</code></td>
<td>
<p>other arguments for function 'points()'.</p>
</td></tr>
</table>

<hr>
<h2 id='plotScores'>Scores plot</h2><span id='topic+plotScores'></span>

<h3>Description</h3>

<p>Scores plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotScores(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotScores_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotScores_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for scores values for data decomposition
</p>

<hr>
<h2 id='plotScores.ldecomp'>Scores plot</h2><span id='topic+plotScores.ldecomp'></span>

<h3>Description</h3>

<p>Shows a plot with scores values for data objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ldecomp'
plotScores(
  obj,
  comp = if (obj$ncomp &gt; 1) c(1, 2) else 1,
  type = "p",
  show.axes = TRUE,
  show.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotScores.ldecomp_+3A_obj">obj</code></td>
<td>
<p>object of <code>ldecomp</code> class.</p>
</td></tr>
<tr><td><code id="plotScores.ldecomp_+3A_comp">comp</code></td>
<td>
<p>which components to show the plot for (can be one value or vector with two values).</p>
</td></tr>
<tr><td><code id="plotScores.ldecomp_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotScores.ldecomp_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotScores.ldecomp_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, shall plot be created or just plot series object is needed</p>
</td></tr>
<tr><td><code id="plotScores.ldecomp_+3A_...">...</code></td>
<td>
<p>most of graphical parameters from <code><a href="#topic+mdaplot">mdaplot</a></code> function can be used.</p>
</td></tr>
</table>

<hr>
<h2 id='plotScores.pca'>Scores plot for PCA model</h2><span id='topic+plotScores.pca'></span>

<h3>Description</h3>

<p>Shows a scores plot for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
plotScores(
  obj,
  comp = if (obj$ncomp &gt; 1) c(1, 2) else 1,
  type = "p",
  show.axes = TRUE,
  show.legend = TRUE,
  res = obj$res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotScores.pca_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotScores.pca_+3A_comp">comp</code></td>
<td>
<p>a value or vector with several values - number of components to show the plot for</p>
</td></tr>
<tr><td><code id="plotScores.pca_+3A_type">type</code></td>
<td>
<p>type of the plot (&quot;p&quot;, &quot;l&quot;, &quot;b&quot;, &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotScores.pca_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotScores.pca_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend on the plot</p>
</td></tr>
<tr><td><code id="plotScores.pca_+3A_res">res</code></td>
<td>
<p>list with result objects to show the variance for</p>
</td></tr>
<tr><td><code id="plotScores.pca_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If plot is created only for one result object (e.g. calibration set), then the behaviour and
all settings for the scores plot are identical to <code><a href="#topic+plotScores.ldecomp">plotScores.ldecomp</a></code>. In this case
you can show scores as a scatter, line or bar plot for any number of components.
</p>
<p>Otherwise (e.g. if model contains results for calibration and test set) the plot is a group
plot created using <code><a href="#topic+mdaplotg">mdaplotg</a></code> method and only scatter plot can be used.
</p>
<p>See examples in help for <code><a href="#topic+pca">pca</a></code> function.
</p>

<hr>
<h2 id='plotSelection'>Selected intervals plot</h2><span id='topic+plotSelection'></span>

<h3>Description</h3>

<p>Selected intervals plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSelection(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSelection_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotSelection_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting selected intervals or variables
</p>

<hr>
<h2 id='plotSelection.ipls'>iPLS performance plot</h2><span id='topic+plotSelection.ipls'></span>

<h3>Description</h3>

<p>Shows PLS performance for each selected or excluded intervals at the
first iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipls'
plotSelection(
  obj,
  glob.ncomp = obj$gm$ncomp.selected,
  main = "iPLS results",
  xlab = obj$xaxis.name,
  ylab = if (is.null(obj$cv)) "RMSEP" else "RMSECV",
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSelection.ipls_+3A_obj">obj</code></td>
<td>
<p>iPLS results (object of class ipls).</p>
</td></tr>
<tr><td><code id="plotSelection.ipls_+3A_glob.ncomp">glob.ncomp</code></td>
<td>
<p>number of components for global PLS model with all intervals.</p>
</td></tr>
<tr><td><code id="plotSelection.ipls_+3A_main">main</code></td>
<td>
<p>main title for the plot.</p>
</td></tr>
<tr><td><code id="plotSelection.ipls_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis.</p>
</td></tr>
<tr><td><code id="plotSelection.ipls_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis.</p>
</td></tr>
<tr><td><code id="plotSelection.ipls_+3A_xlim">xlim</code></td>
<td>
<p>limits for x-axis.</p>
</td></tr>
<tr><td><code id="plotSelection.ipls_+3A_ylim">ylim</code></td>
<td>
<p>limits for y-axis.</p>
</td></tr>
<tr><td><code id="plotSelection.ipls_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot shows intervals as bars, which height corresponds to RMSECV obtained when particular
interval was selected (forward) or excluded (backward) from a model at the first iteration.
The intervals found optimal after backward/forward iPLS selection are shown with green color
while the other intervals are gray.
</p>
<p>See examples in help for <code><a href="#topic+ipls">ipls</a></code> function.
</p>
<p>@seealso
<code><a href="#topic+summary.ipls">summary.ipls</a></code>, <code><a href="#topic+plotRMSE.ipls">plotRMSE.ipls</a></code>
</p>

<hr>
<h2 id='plotSelectivityRatio'>Selectivity ratio plot</h2><span id='topic+plotSelectivityRatio'></span>

<h3>Description</h3>

<p>Generic function for plotting selectivity ratio values for regression model (PCR, PLS, etc)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSelectivityRatio(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSelectivityRatio_+3A_obj">obj</code></td>
<td>
<p>a regression model</p>
</td></tr>
<tr><td><code id="plotSelectivityRatio_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotSelectivityRatio.pls'>Selectivity ratio plot for PLS model</h2><span id='topic+plotSelectivityRatio.pls'></span>

<h3>Description</h3>

<p>Computes and shows a plot for Selectivity ratio values for given number of components
and response variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotSelectivityRatio(obj, ny = 1, ncomp = obj$ncomp.selected, type = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSelectivityRatio.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotSelectivityRatio.pls_+3A_ny">ny</code></td>
<td>
<p>which response to plot the values for (if y is multivariate), can be a vector.</p>
</td></tr>
<tr><td><code id="plotSelectivityRatio.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to count</p>
</td></tr>
<tr><td><code id="plotSelectivityRatio.pls_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotSelectivityRatio.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+vipscores">vipscores</a></code> for more details.
</p>

<hr>
<h2 id='plotSensitivity'>Sensitivity plot</h2><span id='topic+plotSensitivity'></span>

<h3>Description</h3>

<p>Sensitivity plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSensitivity(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSensitivity_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotSensitivity_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting sensitivity values for classification model or results
</p>

<hr>
<h2 id='plotSensitivity.classmodel'>Sensitivity plot for classification model</h2><span id='topic+plotSensitivity.classmodel'></span>

<h3>Description</h3>

<p>Makes a plot with sensitivity values vs. model complexity (e.g. number of components)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classmodel'
plotSensitivity(obj, legend.position = "bottomright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSensitivity.classmodel_+3A_obj">obj</code></td>
<td>
<p>classification model (object of class <code>plsda</code>, <code>simca</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotSensitivity.classmodel_+3A_legend.position">legend.position</code></td>
<td>
<p>position of the legend (as in <code>mdaplotg</code>).</p>
</td></tr>
<tr><td><code id="plotSensitivity.classmodel_+3A_...">...</code></td>
<td>
<p>parameters for <code><a href="#topic+plotPerformance.classmodel">plotPerformance.classmodel</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsda">plsda</a></code>, <code><a href="#topic+simca">simca</a></code> or <code><a href="#topic+simcam">simcam</a></code>.
</p>

<hr>
<h2 id='plotSensitivity.classres'>Sensitivity plot for classification results</h2><span id='topic+plotSensitivity.classres'></span>

<h3>Description</h3>

<p>Makes a plot with sn values vs. model complexity (e.g. number of components) for
classification results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
plotSensitivity(obj, legend.position = "bottomright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSensitivity.classres_+3A_obj">obj</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotSensitivity.classres_+3A_legend.position">legend.position</code></td>
<td>
<p>position of the legend (as in <code>mdaplotg</code>).</p>
</td></tr>
<tr><td><code id="plotSensitivity.classres_+3A_...">...</code></td>
<td>
<p>other parameters for <code><a href="#topic+plotPerformance.classres">plotPerformance.classres</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsdares">plsdares</a></code>, <code><a href="#topic+simcamres">simcamres</a></code>, etc.
</p>

<hr>
<h2 id='plotseries'>Create plot series object based on data, plot type and parameters</h2><span id='topic+plotseries'></span>

<h3>Description</h3>

<p>The 'plotseries' object contains all necessary paremeters to create main plots
from data values, including values for x and y, correct handling of excluded rows
and columns, color grouping (if any), limits and labels.
</p>
<p>If both 'col' and 'cgroup' are specified, 'cgroup' will be ignored.
</p>
<p>Labels can be either provided by user or generated automatically based on values, names or
indices of data rows and columns. If series is made for scatter plot 'type=&quot;p&quot;' then labels
are required for each row of the original dataset. Otherwise (for line, bar and errobar plot)
labels correspond to data columns (variables).
</p>
<p>The object has the following plotting methods once created:
<code><a href="#topic+plotScatter">plotScatter</a></code>
<code><a href="#topic+plotLines">plotLines</a></code>
<code><a href="#topic+plotBars">plotBars</a></code>
<code><a href="#topic+plotDensity">plotDensity</a></code>
<code><a href="#topic+plotErrorbars">plotErrorbars</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotseries(
  data,
  type,
  cgroup = NULL,
  col = NULL,
  opacity = 1,
  colmap = "default",
  labels = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotseries_+3A_data">data</code></td>
<td>
<p>data to make the plot for (vector, matrix or data frame).</p>
</td></tr>
<tr><td><code id="plotseries_+3A_type">type</code></td>
<td>
<p>type of the plot.</p>
</td></tr>
<tr><td><code id="plotseries_+3A_cgroup">cgroup</code></td>
<td>
<p>vector with values used to create a color grouping of the series instances.</p>
</td></tr>
<tr><td><code id="plotseries_+3A_col">col</code></td>
<td>
<p>color to show the series on plot with (user defined).</p>
</td></tr>
<tr><td><code id="plotseries_+3A_opacity">opacity</code></td>
<td>
<p>opacity of the colors (between 0 and 1).</p>
</td></tr>
<tr><td><code id="plotseries_+3A_colmap">colmap</code></td>
<td>
<p>colormap name to generate color/colors if they are not specified by user. See
<code>link{mdaplot.getColors}</code> for details.</p>
</td></tr>
<tr><td><code id="plotseries_+3A_labels">labels</code></td>
<td>
<p>either vector with labels for the series instances or string (&quot;names&quot;, &quot;values&quot;, or &quot;indices&quot;)
if labels should be generated automatically.</p>
</td></tr>
</table>

<hr>
<h2 id='plotSpecificity'>Specificity plot</h2><span id='topic+plotSpecificity'></span>

<h3>Description</h3>

<p>Specificity plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSpecificity(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSpecificity_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotSpecificity_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting specificity values for classification model or results
</p>

<hr>
<h2 id='plotSpecificity.classmodel'>Specificity plot for classification model</h2><span id='topic+plotSpecificity.classmodel'></span>

<h3>Description</h3>

<p>Makes a plot with specificity values vs. model complexity (e.g. number of components)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classmodel'
plotSpecificity(obj, legend.position = "bottomright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSpecificity.classmodel_+3A_obj">obj</code></td>
<td>
<p>classification model (object of class <code>plsda</code>, <code>simca</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotSpecificity.classmodel_+3A_legend.position">legend.position</code></td>
<td>
<p>position of the legend (as in <code>mdaplotg</code>).</p>
</td></tr>
<tr><td><code id="plotSpecificity.classmodel_+3A_...">...</code></td>
<td>
<p>parameters for <code><a href="#topic+plotPerformance.classmodel">plotPerformance.classmodel</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsda">plsda</a></code>, <code><a href="#topic+simca">simca</a></code> or <code><a href="#topic+simcam">simcam</a></code>.
</p>

<hr>
<h2 id='plotSpecificity.classres'>Specificity plot for classification results</h2><span id='topic+plotSpecificity.classres'></span>

<h3>Description</h3>

<p>Makes a plot with specificity values vs. model complexity (e.g. number of components) for
classification results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
plotSpecificity(obj, legend.position = "bottomright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSpecificity.classres_+3A_obj">obj</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="plotSpecificity.classres_+3A_legend.position">legend.position</code></td>
<td>
<p>position of the legend (as in <code>mdaplotg</code>).</p>
</td></tr>
<tr><td><code id="plotSpecificity.classres_+3A_...">...</code></td>
<td>
<p>other parameters for <code><a href="#topic+plotPerformance.classres">plotPerformance.classres</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in description of <code><a href="#topic+plsdares">plsdares</a></code>, <code><a href="#topic+simcamres">simcamres</a></code>, etc.
</p>

<hr>
<h2 id='plotSpectra'>Plot resolved spectra</h2><span id='topic+plotSpectra'></span>

<h3>Description</h3>

<p>Plot resolved spectra
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSpectra(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSpectra_+3A_obj">obj</code></td>
<td>
<p>object with mcr case</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotSpectra.mcr'>Show plot with resolved spectra</h2><span id='topic+plotSpectra.mcr'></span>

<h3>Description</h3>

<p>Show plot with resolved spectra
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcr'
plotSpectra(
  obj,
  comp = seq_len(obj$ncomp),
  type = "l",
  col = mdaplot.getColors(obj$ncomp),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSpectra.mcr_+3A_obj">obj</code></td>
<td>
<p>object of clacc <code>mcr</code></p>
</td></tr>
<tr><td><code id="plotSpectra.mcr_+3A_comp">comp</code></td>
<td>
<p>vector with number of components to make the plot for</p>
</td></tr>
<tr><td><code id="plotSpectra.mcr_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotSpectra.mcr_+3A_col">col</code></td>
<td>
<p>vector with colors for individual components</p>
</td></tr>
<tr><td><code id="plotSpectra.mcr_+3A_...">...</code></td>
<td>
<p>other parameters suitable for <code>mdaplotg</code></p>
</td></tr>
</table>

<hr>
<h2 id='plotT2DoF'>Degrees of freedom plot for score distance (Nh)</h2><span id='topic+plotT2DoF'></span>

<h3>Description</h3>

<p>Shows a plot with degrees of freedom computed for score distances at given number
of components using data driven approach (&quot;ddmoments&quot; or &quot;ddrobust&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotT2DoF(
  obj,
  type = "b",
  labels = "values",
  xticks = seq_len(obj$ncomp),
  ylab = "Nh",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotT2DoF_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotT2DoF_+3A_type">type</code></td>
<td>
<p>type of the plot (&quot;b&quot;, &quot;l&quot;, &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotT2DoF_+3A_labels">labels</code></td>
<td>
<p>what to show as data points labels</p>
</td></tr>
<tr><td><code id="plotT2DoF_+3A_xticks">xticks</code></td>
<td>
<p>vector with tick values for x-axis</p>
</td></tr>
<tr><td><code id="plotT2DoF_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotT2DoF_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Work only if parameter <code>lim.type</code> equal to &quot;ddmoments&quot; or &quot;ddrobust&quot;.
</p>

<hr>
<h2 id='plotVariance'>Variance plot</h2><span id='topic+plotVariance'></span>

<h3>Description</h3>

<p>Variance plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotVariance(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVariance_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotVariance_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting explained variance for data decomposition
</p>

<hr>
<h2 id='plotVariance.ldecomp'>Explained variance plot</h2><span id='topic+plotVariance.ldecomp'></span>

<h3>Description</h3>

<p>Shows a plot with explained variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ldecomp'
plotVariance(
  obj,
  type = "b",
  variance = "expvar",
  labels = "values",
  xticks = seq_len(obj$ncomp),
  show.plot = TRUE,
  ylab = "Explained variance, %",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVariance.ldecomp_+3A_obj">obj</code></td>
<td>
<p>object of <code>ldecomp</code> class.</p>
</td></tr>
<tr><td><code id="plotVariance.ldecomp_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotVariance.ldecomp_+3A_variance">variance</code></td>
<td>
<p>string, which variance to make the plot for (&quot;expvar&quot;, &quot;cumexpvar&quot;)</p>
</td></tr>
<tr><td><code id="plotVariance.ldecomp_+3A_labels">labels</code></td>
<td>
<p>what to show as labels for plot objects.</p>
</td></tr>
<tr><td><code id="plotVariance.ldecomp_+3A_xticks">xticks</code></td>
<td>
<p>vector with ticks for x-axis</p>
</td></tr>
<tr><td><code id="plotVariance.ldecomp_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, shall plot be created or just plot series object is needed</p>
</td></tr>
<tr><td><code id="plotVariance.ldecomp_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotVariance.ldecomp_+3A_...">...</code></td>
<td>
<p>most of graphical parameters from <code><a href="#topic+mdaplot">mdaplot</a></code> function can be used.</p>
</td></tr>
</table>

<hr>
<h2 id='plotVariance.mcr'>Show plot with explained variance</h2><span id='topic+plotVariance.mcr'></span>

<h3>Description</h3>

<p>Show plot with explained variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcr'
plotVariance(
  obj,
  type = "h",
  labels = "values",
  main = "Variance",
  xticks = seq_len(obj$ncomp),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVariance.mcr_+3A_obj">obj</code></td>
<td>
<p>object of clacc <code>mcr</code></p>
</td></tr>
<tr><td><code id="plotVariance.mcr_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotVariance.mcr_+3A_labels">labels</code></td>
<td>
<p>what to use as data labels</p>
</td></tr>
<tr><td><code id="plotVariance.mcr_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
<tr><td><code id="plotVariance.mcr_+3A_xticks">xticks</code></td>
<td>
<p>vector with ticks for x-axis</p>
</td></tr>
<tr><td><code id="plotVariance.mcr_+3A_...">...</code></td>
<td>
<p>other parameters suitable for <code>mdaplot</code></p>
</td></tr>
</table>

<hr>
<h2 id='plotVariance.pca'>Explained variance plot for PCA model</h2><span id='topic+plotVariance.pca'></span>

<h3>Description</h3>

<p>Shows a plot with explained variance or cumulative explained variance for components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
plotVariance(
  obj,
  type = "b",
  labels = "values",
  variance = "expvar",
  xticks = seq_len(obj$ncomp),
  res = obj$res,
  ylab = "Explained variance, %",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVariance.pca_+3A_obj">obj</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="plotVariance.pca_+3A_type">type</code></td>
<td>
<p>type of the plot (&quot;b&quot;, &quot;l&quot;, &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotVariance.pca_+3A_labels">labels</code></td>
<td>
<p>what to use as labels (if <code>show.labels = TRUE</code>)</p>
</td></tr>
<tr><td><code id="plotVariance.pca_+3A_variance">variance</code></td>
<td>
<p>which variance to show</p>
</td></tr>
<tr><td><code id="plotVariance.pca_+3A_xticks">xticks</code></td>
<td>
<p>vector with ticks for x-axis</p>
</td></tr>
<tr><td><code id="plotVariance.pca_+3A_res">res</code></td>
<td>
<p>list with result objects to show the variance for</p>
</td></tr>
<tr><td><code id="plotVariance.pca_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotVariance.pca_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pca">pca</a></code> function.
</p>

<hr>
<h2 id='plotVariance.pls'>Variance plot for PLS</h2><span id='topic+plotVariance.pls'></span>

<h3>Description</h3>

<p>Shows plot with variance values vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotVariance(
  obj,
  decomp = "xdecomp",
  variance = "expvar",
  type = "b",
  labels = "values",
  res = obj$res,
  ylab = "Explained variance, %",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVariance.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotVariance.pls_+3A_decomp">decomp</code></td>
<td>
<p>which decomposition to use (&quot;xdecomp&quot; for x or &quot;ydecomp&quot; for y)</p>
</td></tr>
<tr><td><code id="plotVariance.pls_+3A_variance">variance</code></td>
<td>
<p>which variance to use (&quot;expvar&quot;, &quot;cumexpvar&quot;)</p>
</td></tr>
<tr><td><code id="plotVariance.pls_+3A_type">type</code></td>
<td>
<p>type of the plot(&quot;b&quot;, &quot;l&quot; or &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotVariance.pls_+3A_labels">labels</code></td>
<td>
<p>what to show as labels for plot objects.</p>
</td></tr>
<tr><td><code id="plotVariance.pls_+3A_res">res</code></td>
<td>
<p>list with result objects to show the plot for (by defaul, model results are used)</p>
</td></tr>
<tr><td><code id="plotVariance.pls_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotVariance.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotVariance.plsres'>Explained X variance plot for PLS results</h2><span id='topic+plotVariance.plsres'></span>

<h3>Description</h3>

<p>Shows plot with explained X variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotVariance(obj, decomp = "xdecomp", variance = "expvar", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVariance.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotVariance.plsres_+3A_decomp">decomp</code></td>
<td>
<p>which dcomposition to use (&quot;xdecomp&quot; or &quot;ydecomp&quot;)</p>
</td></tr>
<tr><td><code id="plotVariance.plsres_+3A_variance">variance</code></td>
<td>
<p>which variance to use (&quot;expvar&quot;, &quot;cumexpvar&quot;)</p>
</td></tr>
<tr><td><code id="plotVariance.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='plotVIPScores'>VIP scores plot</h2><span id='topic+plotVIPScores'></span>

<h3>Description</h3>

<p>Generic function for plotting VIP scores values for regression model (PCR, PLS, etc)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotVIPScores(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVIPScores_+3A_obj">obj</code></td>
<td>
<p>a regression model</p>
</td></tr>
<tr><td><code id="plotVIPScores_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plotVIPScores.pls'>VIP scores plot for PLS model</h2><span id='topic+plotVIPScores.pls'></span>

<h3>Description</h3>

<p>Shows a plot with VIP scores values for given number of components
and response variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotVIPScores(obj, ny = 1, ncomp = obj$ncomp.selected, type = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVIPScores.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotVIPScores.pls_+3A_ny">ny</code></td>
<td>
<p>which response to plot the values for (if y is multivariate), can be a vector.</p>
</td></tr>
<tr><td><code id="plotVIPScores.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to count</p>
</td></tr>
<tr><td><code id="plotVIPScores.pls_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotVIPScores.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+vipscores">vipscores</a></code> for more details.
</p>

<hr>
<h2 id='plotWeights'>Plot for PLS weights</h2><span id='topic+plotWeights'></span>

<h3>Description</h3>

<p>Plot for PLS weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotWeights(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotWeights_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotWeights_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for weight plot
</p>

<hr>
<h2 id='plotWeights.pls'>X loadings plot for PLS</h2><span id='topic+plotWeights.pls'></span>

<h3>Description</h3>

<p>Shows plot with X loading values for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotWeights(
  obj,
  comp = 1,
  type = (if (nrow(obj$weights) &lt; 20) "h" else "l"),
  show.axes = TRUE,
  show.legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotWeights.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotWeights.pls_+3A_comp">comp</code></td>
<td>
<p>which components to show the plot for (one or vector with several values)</p>
</td></tr>
<tr><td><code id="plotWeights.pls_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotWeights.pls_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotWeights.pls_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend</p>
</td></tr>
<tr><td><code id="plotWeights.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotXCumVariance'>X cumulative variance plot</h2><span id='topic+plotXCumVariance'></span>

<h3>Description</h3>

<p>X cumulative variance plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotXCumVariance(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXCumVariance_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotXCumVariance_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting cumulative explained variance for decomposition of x data
</p>

<hr>
<h2 id='plotXCumVariance.pls'>Cumulative explained X variance plot for PLS</h2><span id='topic+plotXCumVariance.pls'></span>

<h3>Description</h3>

<p>Shows plot with cumulative explained X variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotXCumVariance(obj, type = "b", main = "Cumulative variance (X)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXCumVariance.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotXCumVariance.pls_+3A_type">type</code></td>
<td>
<p>type of the plot(&quot;b&quot;, &quot;l&quot; or &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotXCumVariance.pls_+3A_main">main</code></td>
<td>
<p>title for the plot</p>
</td></tr>
<tr><td><code id="plotXCumVariance.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotXCumVariance.plsres'>Explained cumulative X variance plot for PLS results</h2><span id='topic+plotXCumVariance.plsres'></span>

<h3>Description</h3>

<p>Shows plot with cumulative explained X variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotXCumVariance(obj, main = "Cumulative variance (X)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXCumVariance.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotXCumVariance.plsres_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotXCumVariance.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='plotXLoadings'>X loadings plot</h2><span id='topic+plotXLoadings'></span>

<h3>Description</h3>

<p>X loadings plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotXLoadings(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXLoadings_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotXLoadings_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting loadings values for decomposition of x data
</p>

<hr>
<h2 id='plotXLoadings.pls'>X loadings plot for PLS</h2><span id='topic+plotXLoadings.pls'></span>

<h3>Description</h3>

<p>Shows plot with X loading values for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotXLoadings(
  obj,
  comp = if (obj$ncomp &gt; 1) c(1, 2) else 1,
  type = "p",
  show.axes = TRUE,
  show.legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXLoadings.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotXLoadings.pls_+3A_comp">comp</code></td>
<td>
<p>which components to show the plot for (one or vector with several values)</p>
</td></tr>
<tr><td><code id="plotXLoadings.pls_+3A_type">type</code></td>
<td>
<p>type of the plot</p>
</td></tr>
<tr><td><code id="plotXLoadings.pls_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotXLoadings.pls_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not legend on the plot (when it is available)</p>
</td></tr>
<tr><td><code id="plotXLoadings.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotXResiduals'>X residuals plot</h2><span id='topic+plotXResiduals'></span>

<h3>Description</h3>

<p>X residuals plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotXResiduals(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXResiduals_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotXResiduals_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting x residuals for classification or regression model or results
</p>

<hr>
<h2 id='plotXResiduals.pls'>Residual distance plot for decomposition of X data</h2><span id='topic+plotXResiduals.pls'></span>

<h3>Description</h3>

<p>Shows a plot with orthogonal distance vs score distance for PLS decomposition of X data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotXResiduals(
  obj,
  ncomp = obj$ncomp.selected,
  norm = TRUE,
  log = FALSE,
  main = sprintf("X-distances (ncomp = %d)", ncomp),
  cgroup = NULL,
  xlim = NULL,
  ylim = NULL,
  show.limits = c(TRUE, TRUE),
  lim.col = c("darkgray", "darkgray"),
  lim.lwd = c(1, 1),
  lim.lty = c(2, 3),
  show.legend = TRUE,
  legend.position = "topright",
  res = obj$res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXResiduals.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (by default optimal value selected for the model will be used)</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_norm">norm</code></td>
<td>
<p>logical, normalize distance values or not (see details)</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_log">log</code></td>
<td>
<p>logical, apply log tranformation to the distances or not (see details)</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_main">main</code></td>
<td>
<p>title for the plot</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_cgroup">cgroup</code></td>
<td>
<p>color grouping of plot points (works only if one result object is available)</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_xlim">xlim</code></td>
<td>
<p>limits for x-axis</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_ylim">ylim</code></td>
<td>
<p>limits for y-axis</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_show.limits">show.limits</code></td>
<td>
<p>vector with two logical values defining if limits for extreme and/or outliers must be shown</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_lim.col">lim.col</code></td>
<td>
<p>vector with two values - line color for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_lim.lwd">lim.lwd</code></td>
<td>
<p>vector with two values - line width for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_lim.lty">lim.lty</code></td>
<td>
<p>vector with two values - line type for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend on the plot (needed if several result objects are available)</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_legend.position">legend.position</code></td>
<td>
<p>position of legend (if shown)</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_res">res</code></td>
<td>
<p>list with result objects to show the plot for (by defaul, model results are used)</p>
</td></tr>
<tr><td><code id="plotXResiduals.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is almost identical to <code><a href="#topic+plotResiduals.pca">plotResiduals.pca</a></code>.
</p>

<hr>
<h2 id='plotXResiduals.plsres'>X residuals plot for PLS results</h2><span id='topic+plotXResiduals.plsres'></span>

<h3>Description</h3>

<p>Shows a plot with Q residuals vs. Hotelling T2 values for PLS decomposition of x data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotXResiduals(
  obj,
  ncomp = obj$ncomp.selected,
  norm = TRUE,
  log = FALSE,
  main = sprintf("X-distances (ncomp = %d)", ncomp),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXResiduals.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotXResiduals.plsres_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="plotXResiduals.plsres_+3A_norm">norm</code></td>
<td>
<p>logical, normalize distance values or not (see details)</p>
</td></tr>
<tr><td><code id="plotXResiduals.plsres_+3A_log">log</code></td>
<td>
<p>logical, apply log tranformation to the distances or not (see details)</p>
</td></tr>
<tr><td><code id="plotXResiduals.plsres_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plotXResiduals.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='plotXScores'>X scores plot</h2><span id='topic+plotXScores'></span>

<h3>Description</h3>

<p>X scores plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotXScores(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXScores_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotXScores_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting scores values for decomposition of x data
</p>

<hr>
<h2 id='plotXScores.pls'>X scores plot for PLS</h2><span id='topic+plotXScores.pls'></span>

<h3>Description</h3>

<p>Shows plot with X scores values for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotXScores(
  obj,
  comp = if (obj$ncomp &gt; 1) c(1, 2) else 1,
  show.axes = TRUE,
  main = "Scores (X)",
  res = obj$res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXScores.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotXScores.pls_+3A_comp">comp</code></td>
<td>
<p>which components to show the plot for (one or vector with several values)</p>
</td></tr>
<tr><td><code id="plotXScores.pls_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotXScores.pls_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotXScores.pls_+3A_res">res</code></td>
<td>
<p>list with result objects to show the plot for (by defaul, model results are used)</p>
</td></tr>
<tr><td><code id="plotXScores.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotXScores.plsres'>X scores plot for PLS results</h2><span id='topic+plotXScores.plsres'></span>

<h3>Description</h3>

<p>Shows plot with scores values for PLS decomposition of x data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotXScores(obj, comp = c(1, 2), main = "Scores (X)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXScores.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotXScores.plsres_+3A_comp">comp</code></td>
<td>
<p>which components to show the plot for (one or vector with several values)</p>
</td></tr>
<tr><td><code id="plotXScores.plsres_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotXScores.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='plotXVariance'>X variance plot</h2><span id='topic+plotXVariance'></span>

<h3>Description</h3>

<p>X variance plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotXVariance(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXVariance_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotXVariance_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting explained variance for decomposition of x data
</p>

<hr>
<h2 id='plotXVariance.pls'>Explained X variance plot for PLS</h2><span id='topic+plotXVariance.pls'></span>

<h3>Description</h3>

<p>Shows plot with explained X variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotXVariance(obj, type = "b", main = "Variance (X)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXVariance.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotXVariance.pls_+3A_type">type</code></td>
<td>
<p>type of the plot(&quot;b&quot;, &quot;l&quot; or &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotXVariance.pls_+3A_main">main</code></td>
<td>
<p>title for the plot</p>
</td></tr>
<tr><td><code id="plotXVariance.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotXVariance.plsres'>Explained X variance plot for PLS results</h2><span id='topic+plotXVariance.plsres'></span>

<h3>Description</h3>

<p>Shows plot with explained X variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotXVariance(obj, main = "Variance (X)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXVariance.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotXVariance.plsres_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotXVariance.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='plotXYLoadings'>X loadings plot</h2><span id='topic+plotXYLoadings'></span>

<h3>Description</h3>

<p>X loadings plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotXYLoadings(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXYLoadings_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotXYLoadings_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting loadings values for decomposition of x and y data
</p>

<hr>
<h2 id='plotXYLoadings.pls'>XY loadings plot for PLS</h2><span id='topic+plotXYLoadings.pls'></span>

<h3>Description</h3>

<p>Shows plot with X and Y loading values for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotXYLoadings(obj, comp = c(1, 2), show.axes = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXYLoadings.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotXYLoadings.pls_+3A_comp">comp</code></td>
<td>
<p>which components to show the plot for (one or vector with several values)</p>
</td></tr>
<tr><td><code id="plotXYLoadings.pls_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotXYLoadings.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotXYResiduals'>Plot for XY-residuals</h2><span id='topic+plotXYResiduals'></span>

<h3>Description</h3>

<p>Plot for XY-residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotXYResiduals(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXYResiduals_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotXYResiduals_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for XY-residuals plot
</p>

<hr>
<h2 id='plotXYResiduals.pls'>Residual XY-distance plot</h2><span id='topic+plotXYResiduals.pls'></span>

<h3>Description</h3>

<p>Shows a plot with full X-distance (f) vs. orthogonal Y-distance (z) for PLS model results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotXYResiduals(
  obj,
  ncomp = obj$ncomp.selected,
  norm = TRUE,
  log = FALSE,
  main = sprintf("XY-distances (ncomp = %d)", ncomp),
  cgroup = NULL,
  xlim = NULL,
  ylim = NULL,
  show.limits = c(TRUE, TRUE),
  lim.col = c("darkgray", "darkgray"),
  lim.lwd = c(1, 1),
  lim.lty = c(2, 3),
  show.legend = TRUE,
  legend.position = "topright",
  res = obj$res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXYResiduals.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (by default optimal value selected for the model will be used)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_norm">norm</code></td>
<td>
<p>logical, normalize distance values or not (see details)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_log">log</code></td>
<td>
<p>logical, apply log tranformation to the distances or not (see details)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_main">main</code></td>
<td>
<p>title for the plot</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_cgroup">cgroup</code></td>
<td>
<p>color grouping of plot points (works only if one result object is available)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_xlim">xlim</code></td>
<td>
<p>limits for x-axis</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_ylim">ylim</code></td>
<td>
<p>limits for y-axis</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_show.limits">show.limits</code></td>
<td>
<p>vector with two logical values defining if limits for extreme and/or outliers must be shown</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_lim.col">lim.col</code></td>
<td>
<p>vector with two values - line color for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_lim.lwd">lim.lwd</code></td>
<td>
<p>vector with two values - line width for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_lim.lty">lim.lty</code></td>
<td>
<p>vector with two values - line type for extreme and outlier limits</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_show.legend">show.legend</code></td>
<td>
<p>logical, show or not a legend on the plot (needed if several result objects are available)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_legend.position">legend.position</code></td>
<td>
<p>position of legend (if shown)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_res">res</code></td>
<td>
<p>list with result objects to show the plot for (by defaul, model results are used)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function presents a way to identify extreme objects and outliers based on both full distance
for X-decomposition (known as f) and squared residual distance for Y-decomposition (z). The
approach has been proposed in [1].
</p>
<p>The plot is available only if data driven methods (classic or robust) have been used for
computing of critical limits.
</p>


<h3>References</h3>

<p>1. Rodionova O. Ye., Pomerantsev A. L. Detection of Outliers in Projection-Based Modeling.
Analytical Chemistry (2020, in publish). doi: 10.1021/acs.analchem.9b04611
</p>

<hr>
<h2 id='plotXYResiduals.plsres'>Residual distance plot</h2><span id='topic+plotXYResiduals.plsres'></span>

<h3>Description</h3>

<p>Shows a plot with orthogonal (Q, q) vs. score (T2, h) distances for data objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotXYResiduals(
  obj,
  ncomp = obj$ncomp.selected,
  norm = TRUE,
  log = FALSE,
  show.labels = FALSE,
  labels = "names",
  show.plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXYResiduals.plsres_+3A_obj">obj</code></td>
<td>
<p>object of <code>ldecomp</code> class.</p>
</td></tr>
<tr><td><code id="plotXYResiduals.plsres_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to show the plot for (if NULL, selected by model value will be used).</p>
</td></tr>
<tr><td><code id="plotXYResiduals.plsres_+3A_norm">norm</code></td>
<td>
<p>logical, normalize distance values or not (see details)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.plsres_+3A_log">log</code></td>
<td>
<p>logical, apply log tranformation to the distances or not (see details)</p>
</td></tr>
<tr><td><code id="plotXYResiduals.plsres_+3A_show.labels">show.labels</code></td>
<td>
<p>logical, show or not labels for the plot objects</p>
</td></tr>
<tr><td><code id="plotXYResiduals.plsres_+3A_labels">labels</code></td>
<td>
<p>what to show as labels if necessary</p>
</td></tr>
<tr><td><code id="plotXYResiduals.plsres_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, shall plot be created or just plot series object is needed</p>
</td></tr>
<tr><td><code id="plotXYResiduals.plsres_+3A_...">...</code></td>
<td>
<p>most of graphical parameters from <code><a href="#topic+mdaplot">mdaplot</a></code> function can be used.</p>
</td></tr>
</table>

<hr>
<h2 id='plotXYScores'>XY scores plot</h2><span id='topic+plotXYScores'></span>

<h3>Description</h3>

<p>XY scores plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotXYScores(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXYScores_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotXYScores_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting scores values for decomposition of x and y data
</p>

<hr>
<h2 id='plotXYScores.pls'>XY scores plot for PLS</h2><span id='topic+plotXYScores.pls'></span>

<h3>Description</h3>

<p>Shows plot with X vs. Y scores values for selected component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotXYScores(obj, ncomp = 1, show.axes = TRUE, res = obj$res, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXYScores.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotXYScores.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>which component to show the plot for</p>
</td></tr>
<tr><td><code id="plotXYScores.pls_+3A_show.axes">show.axes</code></td>
<td>
<p>logical, show or not a axes lines crossing origin (0,0)</p>
</td></tr>
<tr><td><code id="plotXYScores.pls_+3A_res">res</code></td>
<td>
<p>list with result objects to show the plot for (by defaul, model results are used)</p>
</td></tr>
<tr><td><code id="plotXYScores.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotXYScores.plsres'>XY scores plot for PLS results</h2><span id='topic+plotXYScores.plsres'></span>

<h3>Description</h3>

<p>Shows plot with X vs. Y scores values for PLS results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotXYScores(obj, ncomp = 1, show.plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotXYScores.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotXYScores.plsres_+3A_ncomp">ncomp</code></td>
<td>
<p>which component to show the plot for</p>
</td></tr>
<tr><td><code id="plotXYScores.plsres_+3A_show.plot">show.plot</code></td>
<td>
<p>logical, show plot or just return plot data</p>
</td></tr>
<tr><td><code id="plotXYScores.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='plotYCumVariance'>Y cumulative variance plot</h2><span id='topic+plotYCumVariance'></span>

<h3>Description</h3>

<p>Y cumulative variance plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotYCumVariance(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYCumVariance_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotYCumVariance_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting cumulative explained variance for decomposition of y data
</p>

<hr>
<h2 id='plotYCumVariance.pls'>Cumulative explained Y variance plot for PLS</h2><span id='topic+plotYCumVariance.pls'></span>

<h3>Description</h3>

<p>Shows plot with cumulative explained Y variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotYCumVariance(obj, type = "b", main = "Cumulative variance (Y)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYCumVariance.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotYCumVariance.pls_+3A_type">type</code></td>
<td>
<p>type of the plot(&quot;b&quot;, &quot;l&quot; or &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotYCumVariance.pls_+3A_main">main</code></td>
<td>
<p>title for the plot</p>
</td></tr>
<tr><td><code id="plotYCumVariance.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotYCumVariance.plsres'>Explained cumulative Y variance plot for PLS results</h2><span id='topic+plotYCumVariance.plsres'></span>

<h3>Description</h3>

<p>Shows plot with cumulative explained Y variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotYCumVariance(obj, main = "Cumulative variance (Y)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYCumVariance.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotYCumVariance.plsres_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotYCumVariance.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='plotYResiduals'>Y residuals plot</h2><span id='topic+plotYResiduals'></span>

<h3>Description</h3>

<p>Y residuals plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotYResiduals(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYResiduals_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotYResiduals_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting y residuals for classification or regression model or results
</p>

<hr>
<h2 id='plotYResiduals.plsres'>Y residuals plot for PLS results</h2><span id='topic+plotYResiduals.plsres'></span>

<h3>Description</h3>

<p>Shows a plot with Y residuals vs reference Y values for selected component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotYResiduals(obj, ncomp = obj$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYResiduals.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotYResiduals.plsres_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="plotYResiduals.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Proxy for <code><a href="#topic+plotResiduals.regres">plotResiduals.regres</a></code> function.
</p>

<hr>
<h2 id='plotYResiduals.regmodel'>Y residuals plot for regression model</h2><span id='topic+plotYResiduals.regmodel'></span>

<h3>Description</h3>

<p>Shows plot with y residuals (predicted vs. reference values) for selected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmodel'
plotYResiduals(
  obj,
  ncomp = obj$ncomp.selected,
  ny = 1,
  show.lines = c(NA, 0),
  res = obj$res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYResiduals.regmodel_+3A_obj">obj</code></td>
<td>
<p>a regression model (object of class <code>regmodel</code>)</p>
</td></tr>
<tr><td><code id="plotYResiduals.regmodel_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="plotYResiduals.regmodel_+3A_ny">ny</code></td>
<td>
<p>number of response variable to make the plot for (if y is multivariate)</p>
</td></tr>
<tr><td><code id="plotYResiduals.regmodel_+3A_show.lines">show.lines</code></td>
<td>
<p>allows to show the horizonta line at 0 level</p>
</td></tr>
<tr><td><code id="plotYResiduals.regmodel_+3A_res">res</code></td>
<td>
<p>list with result objects</p>
</td></tr>
<tr><td><code id="plotYResiduals.regmodel_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>

<hr>
<h2 id='plotYVariance'>Y variance plot</h2><span id='topic+plotYVariance'></span>

<h3>Description</h3>

<p>Y variance plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotYVariance(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYVariance_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="plotYVariance_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for plotting explained variance for decomposition of y data
</p>

<hr>
<h2 id='plotYVariance.pls'>Explained Y variance plot for PLS</h2><span id='topic+plotYVariance.pls'></span>

<h3>Description</h3>

<p>Shows plot with explained Y variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
plotYVariance(obj, type = "b", main = "Variance (Y)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYVariance.pls_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="plotYVariance.pls_+3A_type">type</code></td>
<td>
<p>type of the plot(&quot;b&quot;, &quot;l&quot; or &quot;h&quot;)</p>
</td></tr>
<tr><td><code id="plotYVariance.pls_+3A_main">main</code></td>
<td>
<p>title for the plot</p>
</td></tr>
<tr><td><code id="plotYVariance.pls_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplotg</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>

<hr>
<h2 id='plotYVariance.plsres'>Explained Y variance plot for PLS results</h2><span id='topic+plotYVariance.plsres'></span>

<h3>Description</h3>

<p>Shows plot with explained Y variance vs. number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
plotYVariance(obj, main = "Variance (Y)", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotYVariance.plsres_+3A_obj">obj</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="plotYVariance.plsres_+3A_main">main</code></td>
<td>
<p>main plot title</p>
</td></tr>
<tr><td><code id="plotYVariance.plsres_+3A_...">...</code></td>
<td>
<p>other plot parameters (see <code>mdaplot</code> for details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsres">plsres</a></code> function.
</p>

<hr>
<h2 id='pls'>Partial Least Squares regression</h2><span id='topic+pls'></span>

<h3>Description</h3>

<p><code>pls</code> is used to calibrate, validate and use of partial least squares (PLS)
regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls(
  x,
  y,
  ncomp = min(nrow(x) - 1, ncol(x), 20),
  center = TRUE,
  scale = FALSE,
  cv = NULL,
  exclcols = NULL,
  exclrows = NULL,
  x.test = NULL,
  y.test = NULL,
  method = "simpls",
  info = "",
  ncomp.selcrit = "min",
  lim.type = "ddmoments",
  alpha = 0.05,
  gamma = 0.01,
  cv.scope = "local"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls_+3A_x">x</code></td>
<td>
<p>matrix with predictors.</p>
</td></tr>
<tr><td><code id="pls_+3A_y">y</code></td>
<td>
<p>matrix with responses.</p>
</td></tr>
<tr><td><code id="pls_+3A_ncomp">ncomp</code></td>
<td>
<p>maximum number of components to calculate.</p>
</td></tr>
<tr><td><code id="pls_+3A_center">center</code></td>
<td>
<p>logical, center or not predictors and response values.</p>
</td></tr>
<tr><td><code id="pls_+3A_scale">scale</code></td>
<td>
<p>logical, scale (standardize) or not predictors and response values.</p>
</td></tr>
<tr><td><code id="pls_+3A_cv">cv</code></td>
<td>
<p>cross-validation settings (see details).</p>
</td></tr>
<tr><td><code id="pls_+3A_exclcols">exclcols</code></td>
<td>
<p>columns of x to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="pls_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="pls_+3A_x.test">x.test</code></td>
<td>
<p>matrix with predictors for test set.</p>
</td></tr>
<tr><td><code id="pls_+3A_y.test">y.test</code></td>
<td>
<p>matrix with responses for test set.</p>
</td></tr>
<tr><td><code id="pls_+3A_method">method</code></td>
<td>
<p>algorithm for computing PLS model (only 'simpls' is supported so far)</p>
</td></tr>
<tr><td><code id="pls_+3A_info">info</code></td>
<td>
<p>short text with information about the model.</p>
</td></tr>
<tr><td><code id="pls_+3A_ncomp.selcrit">ncomp.selcrit</code></td>
<td>
<p>criterion for selecting optimal number of components (<code>'min'</code> for
first local minimum of RMSECV and <code>'wold'</code> for Wold's rule.)</p>
</td></tr>
<tr><td><code id="pls_+3A_lim.type">lim.type</code></td>
<td>
<p>which method to use for calculation of critical limits for residual distances (see details)</p>
</td></tr>
<tr><td><code id="pls_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme limits for T2 and Q disances.</p>
</td></tr>
<tr><td><code id="pls_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outlier limits for T2 and Q distances.</p>
</td></tr>
<tr><td><code id="pls_+3A_cv.scope">cv.scope</code></td>
<td>
<p>scope for center/scale operations inside CV loop: 'global' using globally computed mean and std
or 'local'  recompute new for each local calibration set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>So far only SIMPLS method [1] is available. Implementation works both with one
and multiple response variables.
</p>
<p>Like in <code><a href="#topic+pca">pca</a></code>, <code>pls</code> uses number of components (<code>ncomp</code>) as a minimum of
number of objects - 1, number of x variables and the default or provided value. Regression
coefficients, predictions and other results are calculated for each set of components from 1
to <code>ncomp</code>: 1, 1:2, 1:3, etc. The optimal number of components, (<code>ncomp.selected</code>),
is found using first local minumum, but can be also forced to user defined value using function
(<code><a href="#topic+selectCompNum.pls">selectCompNum.pls</a></code>). The selected optimal number of components is used for all
default operations - predictions, plots, etc.
</p>
<p>Cross-validation settings, <code>cv</code>, can be a number or a list. If <code>cv</code> is a number, it
will be used as a number of segments for random cross-validation (if <code>cv = 1</code>, full
cross-validation will be preformed). If it is a list, the following syntax can be used:
<code>cv = list("rand", nseg, nrep)</code> for random repeated cross-validation with <code>nseg</code>
segments and <code>nrep</code> repetitions or <code>cv = list("ven", nseg)</code> for systematic splits
to <code>nseg</code> segments ('venetian blinds').
</p>
<p>Calculation of confidence intervals and p-values for regression coefficients can by done
based on Jack-Knifing resampling. This is done automatically if cross-validation is used.
However it is recommended to use at least 10 segments for stable JK result. See help for
<code><a href="#topic+regcoeffs">regcoeffs</a></code> objects for more details.
</p>


<h3>Value</h3>

<p>Returns an object of <code>pls</code> class with following fields:
</p>
<table>
<tr><td><code>ncomp</code></td>
<td>
<p>number of components included to the model.</p>
</td></tr>
<tr><td><code>ncomp.selected</code></td>
<td>
<p>selected (optimal) number of components.</p>
</td></tr>
<tr><td><code>xcenter</code></td>
<td>
<p>vector with values used to center the predictors (x).</p>
</td></tr>
<tr><td><code>ycenter</code></td>
<td>
<p>vector with values used to center the responses (y).</p>
</td></tr>
<tr><td><code>xscale</code></td>
<td>
<p>vector with values used to scale the predictors (x).</p>
</td></tr>
<tr><td><code>yscale</code></td>
<td>
<p>vector with values used to scale the responses (y).</p>
</td></tr>
<tr><td><code>xloadings</code></td>
<td>
<p>matrix with loading values for x decomposition.</p>
</td></tr>
<tr><td><code>yloadings</code></td>
<td>
<p>matrix with loading values for y decomposition.</p>
</td></tr>
<tr><td><code>xeigenvals</code></td>
<td>
<p>vector with eigenvalues of components (variance of x-scores).</p>
</td></tr>
<tr><td><code>yeigenvals</code></td>
<td>
<p>vector with eigenvalues of components (variance of y-scores).</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>matrix with PLS weights.</p>
</td></tr>
<tr><td><code>coeffs</code></td>
<td>
<p>object of class <code><a href="#topic+regcoeffs">regcoeffs</a></code> with regression coefficients calculated
for each component.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information about the model, provided by user when build the model.</p>
</td></tr>
<tr><td><code>cv</code></td>
<td>
<p>information cross-validation method used (if any).</p>
</td></tr>
<tr><td><code>res</code></td>
<td>
<p>a list with result objects (e.g. calibration, cv, etc.)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>References</h3>

<p>1. S. de Jong, Chemometrics and Intelligent Laboratory Systems 18 (1993) 251-263.
2. Tarja Rajalahti et al. Chemometrics and Laboratory Systems, 95 (2009), 35-48.
3. Il-Gyo Chong, Chi-Hyuck Jun. Chemometrics and Laboratory Systems, 78 (2005), 103-112.
</p>


<h3>See Also</h3>

<p>Main methods for <code>pls</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print</code> </td><td style="text-align: left;"> prints information about a <code>pls</code> object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+summary.pls">summary.pls</a></code> </td><td style="text-align: left;"> shows performance statistics for the model.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plot.pls">plot.pls</a></code> </td><td style="text-align: left;"> shows plot overview of the model.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+pls.simpls">pls.simpls</a></code> </td><td style="text-align: left;"> implementation of SIMPLS algorithm.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+predict.pls">predict.pls</a></code> </td><td style="text-align: left;"> applies PLS model to a new data.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+selectCompNum.pls">selectCompNum.pls</a></code> </td><td style="text-align: left;"> set number of optimal components in the model.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+setDistanceLimits.pls">setDistanceLimits.pls</a></code> </td><td style="text-align: left;"> allows to change parameters for critical limits.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+categorize.pls">categorize.pls</a></code> </td><td style="text-align: left;"> categorize data rows similar to
   <code><a href="#topic+categorize.pca">categorize.pca</a></code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+selratio">selratio</a></code> </td><td style="text-align: left;"> computes matrix with selectivity ratio values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+vipscores">vipscores</a></code> </td><td style="text-align: left;"> computes matrix with VIP scores values.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Plotting methods for <code>pls</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotXScores.pls">plotXScores.pls</a></code> </td><td style="text-align: left;"> shows scores plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotXYScores.pls">plotXYScores.pls</a></code> </td><td style="text-align: left;"> shows scores plot for x and y decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotXLoadings.pls">plotXLoadings.pls</a></code> </td><td style="text-align: left;"> shows loadings plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotXYLoadings.pls">plotXYLoadings.pls</a></code> </td><td style="text-align: left;"> shows loadings plot for x and y decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotXVariance.pls">plotXVariance.pls</a></code> </td><td style="text-align: left;"> shows explained variance plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotYVariance.pls">plotYVariance.pls</a></code> </td><td style="text-align: left;"> shows explained variance plot for y decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotXCumVariance.pls">plotXCumVariance.pls</a></code> </td><td style="text-align: left;"> shows cumulative explained variance plot for y
 decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotYCumVariance.pls">plotYCumVariance.pls</a></code> </td><td style="text-align: left;"> shows cumulative explained variance plot for y
 decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotXResiduals.pls">plotXResiduals.pls</a></code> </td><td style="text-align: left;"> shows distance/residuals plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotXYResiduals.pls">plotXYResiduals.pls</a></code> </td><td style="text-align: left;"> shows joint distance plot for x and y decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotWeights.pls">plotWeights.pls</a></code> </td><td style="text-align: left;"> shows plot with weights.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSelectivityRatio.pls">plotSelectivityRatio.pls</a></code> </td><td style="text-align: left;"> shows plot with selectivity ratio values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotVIPScores.pls">plotVIPScores.pls</a></code> </td><td style="text-align: left;"> shows plot with VIP scores values.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods inherited from <code>regmodel</code> object (parent class for <code>pls</code>):
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPredictions.regmodel">plotPredictions.regmodel</a></code> </td><td style="text-align: left;"> shows predicted vs. measured plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotRMSE.regmodel">plotRMSE.regmodel</a></code> </td><td style="text-align: left;"> shows RMSE plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotRMSERatio.regmodel">plotRMSERatio.regmodel</a></code> </td><td style="text-align: left;"> shows plot for ratio RMSECV/RMSEC values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotYResiduals.regmodel">plotYResiduals.regmodel</a></code> </td><td style="text-align: left;"> shows residuals plot for y values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+getRegcoeffs.regmodel">getRegcoeffs.regmodel</a></code> </td><td style="text-align: left;"> returns matrix with regression coefficients.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Most of the methods for plotting data (except loadings and regression coefficients) are also
available for PLS results (<code><a href="#topic+plsres">plsres</a></code>) objects. There is also a randomization test
for PLS-regression (<code><a href="#topic+randtest">randtest</a></code>) and implementation of interval PLS algorithm
for variable selection (<code><a href="#topic+ipls">ipls</a></code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Examples of using PLS model class
library(mdatools)

## 1. Make a PLS model for concentration of first component
## using full-cross validation and automatic detection of
## optimal number of components and show an overview

data(simdata)
x = simdata$spectra.c
y = simdata$conc.c[, 1]

model = pls(x, y, ncomp = 8, cv = 1)
summary(model)
plot(model)

## 2. Make a PLS model for concentration of first component
## using test set and 10 segment cross-validation and show overview

data(simdata)
x = simdata$spectra.c
y = simdata$conc.c[, 1]
x.t = simdata$spectra.t
y.t = simdata$conc.t[, 1]

model = pls(x, y, ncomp = 8, cv = 10, x.test = x.t, y.test = y.t)
model = selectCompNum(model, 2)
summary(model)
plot(model)

## 3. Make a PLS model for concentration of first component
## using only test set validation and show overview

data(simdata)
x = simdata$spectra.c
y = simdata$conc.c[, 1]
x.t = simdata$spectra.t
y.t = simdata$conc.t[, 1]

model = pls(x, y, ncomp = 6, x.test = x.t, y.test = y.t)
model = selectCompNum(model, 2)
summary(model)
plot(model)

## 4. Show variance and error plots for a PLS model
par(mfrow = c(2, 2))
plotXCumVariance(model, type = 'h')
plotYCumVariance(model, type = 'b', show.labels = TRUE, legend.position = 'bottomright')
plotRMSE(model)
plotRMSE(model, type = 'h', show.labels = TRUE)
par(mfrow = c(1, 1))

## 5. Show scores plots for a PLS model
par(mfrow = c(2, 2))
plotXScores(model)
plotXScores(model, comp = c(1, 3), show.labels = TRUE)
plotXYScores(model)
plotXYScores(model, comp = 2, show.labels = TRUE)
par(mfrow = c(1, 1))

## 6. Show loadings and coefficients plots for a PLS model
par(mfrow = c(2, 2))
plotXLoadings(model)
plotXLoadings(model, comp = c(1, 2), type = 'l')
plotXYLoadings(model, comp = c(1, 2), legend.position = 'topleft')
plotRegcoeffs(model)
par(mfrow = c(1, 1))

## 7. Show predictions and residuals plots for a PLS model
par(mfrow = c(2, 2))
plotXResiduals(model, show.label = TRUE)
plotYResiduals(model, show.label = TRUE)
plotPredictions(model)
plotPredictions(model, ncomp = 4, xlab = 'C, reference', ylab = 'C, predictions')
par(mfrow = c(1, 1))

## 8. Selectivity ratio and VIP scores plots
par(mfrow = c(2, 2))
plotSelectivityRatio(model)
plotSelectivityRatio(model, ncomp = 1)
par(mfrow = c(1, 1))

## 9. Variable selection with selectivity ratio
selratio = getSelectivityRatio(model)
selvar = !(selratio &lt; 8)

xsel = x[, selvar]
modelsel = pls(xsel, y, ncomp = 6, cv = 1)
modelsel = selectCompNum(modelsel, 3)

summary(model)
summary(modelsel)

## 10. Calculate average spectrum and show the selected variables
i = 1:ncol(x)
ms = apply(x, 2, mean)

par(mfrow = c(2, 2))

plot(i, ms, type = 'p', pch = 16, col = 'red', main = 'Original variables')
plotPredictions(model)

plot(i, ms, type = 'p', pch = 16, col = 'lightgray', main = 'Selected variables')
points(i[selvar], ms[selvar], col = 'red', pch = 16)
plotPredictions(modelsel)

par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='pls.cal'>PLS model calibration</h2><span id='topic+pls.cal'></span>

<h3>Description</h3>

<p>Calibrates (builds) a PLS model for given data and parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.cal(x, y, ncomp, center, scale, method = "simpls", cv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.cal_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors)</p>
</td></tr>
<tr><td><code id="pls.cal_+3A_y">y</code></td>
<td>
<p>a matrix with y values (responses)</p>
</td></tr>
<tr><td><code id="pls.cal_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to calculate</p>
</td></tr>
<tr><td><code id="pls.cal_+3A_center">center</code></td>
<td>
<p>logical, do mean centering or not</p>
</td></tr>
<tr><td><code id="pls.cal_+3A_scale">scale</code></td>
<td>
<p>logical, do standardization or not</p>
</td></tr>
<tr><td><code id="pls.cal_+3A_method">method</code></td>
<td>
<p>algorithm for computing PLS model (only 'simpls' is supported so far)</p>
</td></tr>
<tr><td><code id="pls.cal_+3A_cv">cv</code></td>
<td>
<p>logical, is model calibrated during cross-validation or not (or cv settings for calibration)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model
an object with calibrated PLS model
</p>

<hr>
<h2 id='pls.getLimitsCoordinates'>Compute coordinates of lines or curves with critical limits</h2><span id='topic+pls.getLimitsCoordinates'></span>

<h3>Description</h3>

<p>Compute coordinates of lines or curves with critical limits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.getLimitsCoordinates(Qlim, T2lim, Zlim, nobj, ncomp, norm, log)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.getLimitsCoordinates_+3A_qlim">Qlim</code></td>
<td>
<p>matrix with critical limits for orthogonal distances (X)</p>
</td></tr>
<tr><td><code id="pls.getLimitsCoordinates_+3A_t2lim">T2lim</code></td>
<td>
<p>matrix with critical limits for score distances (X)</p>
</td></tr>
<tr><td><code id="pls.getLimitsCoordinates_+3A_zlim">Zlim</code></td>
<td>
<p>matrix with critical limits for orthogonal distances (Y)</p>
</td></tr>
<tr><td><code id="pls.getLimitsCoordinates_+3A_nobj">nobj</code></td>
<td>
<p>number of objects to compute the limits for</p>
</td></tr>
<tr><td><code id="pls.getLimitsCoordinates_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components for computing the coordinates</p>
</td></tr>
<tr><td><code id="pls.getLimitsCoordinates_+3A_norm">norm</code></td>
<td>
<p>logical, shall distance values be normalized or not</p>
</td></tr>
<tr><td><code id="pls.getLimitsCoordinates_+3A_log">log</code></td>
<td>
<p>logical, shall log transformation be applied or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with two matrices (x and y coordinates of corresponding limits)
</p>

<hr>
<h2 id='pls.getpredictions'>Compute predictions for response values</h2><span id='topic+pls.getpredictions'></span>

<h3>Description</h3>

<p>Compute predictions for response values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.getpredictions(
  x,
  coeffs,
  ycenter,
  yscale,
  ynames = NULL,
  y.attrs = NULL,
  objnames = NULL,
  compnames = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.getpredictions_+3A_x">x</code></td>
<td>
<p>matrix with predictors, already preprocessed (e.g. mean centered) and cleaned</p>
</td></tr>
<tr><td><code id="pls.getpredictions_+3A_coeffs">coeffs</code></td>
<td>
<p>array with regression coefficients</p>
</td></tr>
<tr><td><code id="pls.getpredictions_+3A_ycenter">ycenter</code></td>
<td>
<p>'ycenter' property of PLS model</p>
</td></tr>
<tr><td><code id="pls.getpredictions_+3A_yscale">yscale</code></td>
<td>
<p>'yscale' property of PLS model</p>
</td></tr>
<tr><td><code id="pls.getpredictions_+3A_ynames">ynames</code></td>
<td>
<p>vector with names of the responses</p>
</td></tr>
<tr><td><code id="pls.getpredictions_+3A_y.attrs">y.attrs</code></td>
<td>
<p>list with response attributes (e.g. from reference values if any)</p>
</td></tr>
<tr><td><code id="pls.getpredictions_+3A_objnames">objnames</code></td>
<td>
<p>vector with names of objects (rows of x)</p>
</td></tr>
<tr><td><code id="pls.getpredictions_+3A_compnames">compnames</code></td>
<td>
<p>vector with names used for components</p>
</td></tr>
</table>


<h3>Value</h3>

<p>array with predicted y-values
</p>

<hr>
<h2 id='pls.getxdecomp'>Compute object with decomposition of x-values</h2><span id='topic+pls.getxdecomp'></span>

<h3>Description</h3>

<p>Compute object with decomposition of x-values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.getxdecomp(
  x,
  xscores,
  xloadings,
  xeigenvals,
  xnames = NULL,
  x.attrs = NULL,
  objnames = NULL,
  compnames = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.getxdecomp_+3A_x">x</code></td>
<td>
<p>matrix with predictors, already preprocessed (e.g. mean centered) and cleaned</p>
</td></tr>
<tr><td><code id="pls.getxdecomp_+3A_xscores">xscores</code></td>
<td>
<p>matrix with X-scores</p>
</td></tr>
<tr><td><code id="pls.getxdecomp_+3A_xloadings">xloadings</code></td>
<td>
<p>matrix with X-loadings</p>
</td></tr>
<tr><td><code id="pls.getxdecomp_+3A_xeigenvals">xeigenvals</code></td>
<td>
<p>matrix with eigenvalues for X</p>
</td></tr>
<tr><td><code id="pls.getxdecomp_+3A_xnames">xnames</code></td>
<td>
<p>vector with names of the predictors</p>
</td></tr>
<tr><td><code id="pls.getxdecomp_+3A_x.attrs">x.attrs</code></td>
<td>
<p>list with preditors attributes</p>
</td></tr>
<tr><td><code id="pls.getxdecomp_+3A_objnames">objnames</code></td>
<td>
<p>vector with names of objects (rows of x)</p>
</td></tr>
<tr><td><code id="pls.getxdecomp_+3A_compnames">compnames</code></td>
<td>
<p>vector with names used for components</p>
</td></tr>
</table>


<h3>Value</h3>

<p>array 'ldecomp' object for x-values
</p>

<hr>
<h2 id='pls.getxscores'>Compute matrix with X-scores</h2><span id='topic+pls.getxscores'></span>

<h3>Description</h3>

<p>Compute matrix with X-scores
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.getxscores(x, weights, xloadings)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.getxscores_+3A_x">x</code></td>
<td>
<p>matrix with predictors, already preprocessed and cleaned</p>
</td></tr>
<tr><td><code id="pls.getxscores_+3A_weights">weights</code></td>
<td>
<p>matrix with PLS weights</p>
</td></tr>
<tr><td><code id="pls.getxscores_+3A_xloadings">xloadings</code></td>
<td>
<p>matrix with X-loadings</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with X-scores
</p>

<hr>
<h2 id='pls.getydecomp'>Compute object with decomposition of y-values</h2><span id='topic+pls.getydecomp'></span>

<h3>Description</h3>

<p>Compute object with decomposition of y-values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.getydecomp(
  y,
  yscores,
  xscores,
  yloadings,
  yeigenvals,
  ynames = NULL,
  y.attrs = NULL,
  x.attrs = NULL,
  objnames = NULL,
  compnames = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.getydecomp_+3A_y">y</code></td>
<td>
<p>matrix with responses, already preprocessed (e.g. mean centered) and cleaned</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_yscores">yscores</code></td>
<td>
<p>matrix with Y-scores</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_xscores">xscores</code></td>
<td>
<p>matrix with X-scores</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_yloadings">yloadings</code></td>
<td>
<p>matrix with Y-loadings</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_yeigenvals">yeigenvals</code></td>
<td>
<p>matrix with eigenvalues for Y</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_ynames">ynames</code></td>
<td>
<p>vector with names of the responses</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_y.attrs">y.attrs</code></td>
<td>
<p>list with response attributes (e.g. from reference values if any)</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_x.attrs">x.attrs</code></td>
<td>
<p>list with preditors attributes</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_objnames">objnames</code></td>
<td>
<p>vector with names of objects (rows of x)</p>
</td></tr>
<tr><td><code id="pls.getydecomp_+3A_compnames">compnames</code></td>
<td>
<p>vector with names used for components</p>
</td></tr>
</table>


<h3>Value</h3>

<p>array 'ldecomp' object for y-values (or NULL if y is not provided)
</p>

<hr>
<h2 id='pls.getyscores'>Compute and orthogonalize matrix with Y-scores</h2><span id='topic+pls.getyscores'></span>

<h3>Description</h3>

<p>Compute and orthogonalize matrix with Y-scores
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.getyscores(y, yloadings, xscores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.getyscores_+3A_y">y</code></td>
<td>
<p>matrix with response values, already preprocessed and cleaned</p>
</td></tr>
<tr><td><code id="pls.getyscores_+3A_yloadings">yloadings</code></td>
<td>
<p>matrix with Y-loadings</p>
</td></tr>
<tr><td><code id="pls.getyscores_+3A_xscores">xscores</code></td>
<td>
<p>matrix with X-scores (needed for orthogonalization)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with Y-scores
</p>

<hr>
<h2 id='pls.getZLimits'>Compute critical limits for orthogonal distances (Q)</h2><span id='topic+pls.getZLimits'></span>

<h3>Description</h3>

<p>Compute critical limits for orthogonal distances (Q)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.getZLimits(lim.type, alpha, gamma, params)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.getZLimits_+3A_lim.type">lim.type</code></td>
<td>
<p>which method to use for calculation of critical limits for residuals</p>
</td></tr>
<tr><td><code id="pls.getZLimits_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme limits.</p>
</td></tr>
<tr><td><code id="pls.getZLimits_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outlier limits.</p>
</td></tr>
<tr><td><code id="pls.getZLimits_+3A_params">params</code></td>
<td>
<p>distribution parameters returned by ldecomp.getLimParams</p>
</td></tr>
</table>

<hr>
<h2 id='pls.run'>Runs selected PLS algorithm</h2><span id='topic+pls.run'></span>

<h3>Description</h3>

<p>Runs selected PLS algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.run(x, y, ncomp = min(nrow(x) - 1, ncol(x)), method = "simpls", cv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.run_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors from calibration set)</p>
</td></tr>
<tr><td><code id="pls.run_+3A_y">y</code></td>
<td>
<p>a matrix with y values (responses from calibration set)</p>
</td></tr>
<tr><td><code id="pls.run_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to compute</p>
</td></tr>
<tr><td><code id="pls.run_+3A_method">method</code></td>
<td>
<p>algorithm for computing PLS model</p>
</td></tr>
<tr><td><code id="pls.run_+3A_cv">cv</code></td>
<td>
<p>logical, is this for CV or not</p>
</td></tr>
</table>

<hr>
<h2 id='pls.simpls'>SIMPLS algorithm</h2><span id='topic+pls.simpls'></span>

<h3>Description</h3>

<p>SIMPLS algorithm for calibration of PLS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.simpls(x, y, ncomp, cv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.simpls_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors)</p>
</td></tr>
<tr><td><code id="pls.simpls_+3A_y">y</code></td>
<td>
<p>a matrix with y values (responses)</p>
</td></tr>
<tr><td><code id="pls.simpls_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to calculate</p>
</td></tr>
<tr><td><code id="pls.simpls_+3A_cv">cv</code></td>
<td>
<p>logical, is model calibrated during cross-validation or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with computed regression coefficients, loadings and scores for x and y matrices,
and weights.
</p>


<h3>References</h3>

<p>[1]. S. de Jong. SIMPLS: An Alternative approach to partial least squares regression.
Chemometrics and Intelligent Laboratory Systems, 18, 1993 (251-263).
</p>

<hr>
<h2 id='pls.simplsold'>SIMPLS algorithm (old implementation)</h2><span id='topic+pls.simplsold'></span>

<h3>Description</h3>

<p>SIMPLS algorithm for calibration of PLS model (old version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls.simplsold(x, y, ncomp, cv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls.simplsold_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors)</p>
</td></tr>
<tr><td><code id="pls.simplsold_+3A_y">y</code></td>
<td>
<p>a matrix with y values (responses)</p>
</td></tr>
<tr><td><code id="pls.simplsold_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to calculate</p>
</td></tr>
<tr><td><code id="pls.simplsold_+3A_cv">cv</code></td>
<td>
<p>logical, is model calibrated during cross-validation or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with computed regression coefficients, loadings and scores for x and y matrices,
and weights.
</p>


<h3>References</h3>

<p>[1]. S. de Jong. SIMPLS: An Alternative approach to partial least squares regression.
Chemometrics and Intelligent Laboratory Systems, 18, 1993 (251-263).
</p>

<hr>
<h2 id='plsda'>Partial Least Squares Discriminant Analysis</h2><span id='topic+plsda'></span>

<h3>Description</h3>

<p><code>plsda</code> is used to calibrate, validate and use of partial least squares discrimination
analysis (PLS-DA) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plsda(
  x,
  c,
  ncomp = min(nrow(x) - 1, ncol(x), 20),
  center = TRUE,
  scale = FALSE,
  cv = NULL,
  exclcols = NULL,
  exclrows = NULL,
  x.test = NULL,
  c.test = NULL,
  method = "simpls",
  lim.type = "ddmoments",
  alpha = 0.05,
  gamma = 0.01,
  info = "",
  ncomp.selcrit = "min",
  classname = NULL,
  cv.scope = "local"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plsda_+3A_x">x</code></td>
<td>
<p>matrix with predictors.</p>
</td></tr>
<tr><td><code id="plsda_+3A_c">c</code></td>
<td>
<p>vector with class membership (should be either a factor with class names/numbers in case of
multiple classes or a vector with logical values in case of one class model).</p>
</td></tr>
<tr><td><code id="plsda_+3A_ncomp">ncomp</code></td>
<td>
<p>maximum number of components to calculate.</p>
</td></tr>
<tr><td><code id="plsda_+3A_center">center</code></td>
<td>
<p>logical, center or not predictors and response values.</p>
</td></tr>
<tr><td><code id="plsda_+3A_scale">scale</code></td>
<td>
<p>logical, scale (standardize) or not predictors and response values.</p>
</td></tr>
<tr><td><code id="plsda_+3A_cv">cv</code></td>
<td>
<p>cross-validation settings (see details).</p>
</td></tr>
<tr><td><code id="plsda_+3A_exclcols">exclcols</code></td>
<td>
<p>columns of x to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="plsda_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="plsda_+3A_x.test">x.test</code></td>
<td>
<p>matrix with predictors for test set.</p>
</td></tr>
<tr><td><code id="plsda_+3A_c.test">c.test</code></td>
<td>
<p>vector with reference class values for test set (same format as calibration values).</p>
</td></tr>
<tr><td><code id="plsda_+3A_method">method</code></td>
<td>
<p>method for calculating PLS model.</p>
</td></tr>
<tr><td><code id="plsda_+3A_lim.type">lim.type</code></td>
<td>
<p>which method to use for calculation of critical limits for residual distances (see details)</p>
</td></tr>
<tr><td><code id="plsda_+3A_alpha">alpha</code></td>
<td>
<p>significance level for extreme limits for T2 and Q disances.</p>
</td></tr>
<tr><td><code id="plsda_+3A_gamma">gamma</code></td>
<td>
<p>significance level for outlier limits for T2 and Q distances.</p>
</td></tr>
<tr><td><code id="plsda_+3A_info">info</code></td>
<td>
<p>short text with information about the model.</p>
</td></tr>
<tr><td><code id="plsda_+3A_ncomp.selcrit">ncomp.selcrit</code></td>
<td>
<p>criterion for selecting optimal number of components (<code>'min'</code> for first local minimum of
RMSECV and <code>'wold'</code> for Wold's rule.)</p>
</td></tr>
<tr><td><code id="plsda_+3A_classname">classname</code></td>
<td>
<p>name (label) of class in case if PLS-DA is used for one-class discrimination model. In this case
it is expected that parameter 'c' will be a vector with logical values.</p>
</td></tr>
<tr><td><code id="plsda_+3A_cv.scope">cv.scope</code></td>
<td>
<p>scope for center/scale operations inside CV loop: 'global' using globally computed mean and std
or 'local'  recompute new for each local calibration set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plsda</code> class is based on <code>pls</code> with extra functions and plots covering
classification functionality. All plots for <code>pls</code> can be used. E.g. of you want to see the
real predicted values (y in PLS) instead of classes use <code>plotPredictions.pls(model)</code> instead
of <code>plotPredictions(model)</code>.
</p>
<p>Cross-validation settings, <code>cv</code>, can be a number or a list. If <code>cv</code> is a number, it
will be used as a number of segments for random cross-validation (if <code>cv = 1</code>, full
cross-validation will be preformed). If it is a list, the following syntax can be used:
<code>cv = list('rand', nseg, nrep)</code> for random repeated cross-validation with <code>nseg</code>
segments and <code>nrep</code> repetitions or <code>cv = list('ven', nseg)</code> for systematic splits
to <code>nseg</code> segments ('venetian blinds').
</p>
<p>Calculation of confidence intervals and p-values for regression coefficients are available
only by jack-knifing so far. See help for <code><a href="#topic+regcoeffs">regcoeffs</a></code> objects for details.
</p>


<h3>Value</h3>

<p>Returns an object of <code>plsda</code> class with following fields (most inherited from class
<code>pls</code>):
</p>
<table>
<tr><td><code>ncomp</code></td>
<td>
<p>number of components included to the model.</p>
</td></tr>
<tr><td><code>ncomp.selected</code></td>
<td>
<p>selected (optimal) number of components.</p>
</td></tr>
<tr><td><code>xloadings</code></td>
<td>
<p>matrix with loading values for x decomposition.</p>
</td></tr>
<tr><td><code>yloadings</code></td>
<td>
<p>matrix with loading values for y (c)  decomposition.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>matrix with PLS weights.</p>
</td></tr>
<tr><td><code>coeffs</code></td>
<td>
<p>matrix with regression coefficients calculated for each component.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information about the model, provided by user when build the model.</p>
</td></tr>
<tr><td><code>calres</code></td>
<td>
<p>an object of class <code><a href="#topic+plsdares">plsdares</a></code> with PLS-DA results for a calibration
data.</p>
</td></tr>
<tr><td><code>testres</code></td>
<td>
<p>an object of class <code><a href="#topic+plsdares">plsdares</a></code> with PLS-DA results for a test data,
if it was provided.</p>
</td></tr>
<tr><td><code>cvres</code></td>
<td>
<p>an object of class <code><a href="#topic+plsdares">plsdares</a></code> with PLS-DA results for cross-validation,
if this option was chosen.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>See Also</h3>

<p>Specific methods for <code>plsda</code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print.plsda</code> </td><td style="text-align: left;"> prints information about a <code>pls</code> object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>summary.plsda</code> </td><td style="text-align: left;"> shows performance statistics for the model.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>plot.plsda</code> </td><td style="text-align: left;"> shows plot overview of the model.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+predict.plsda">predict.plsda</a></code> </td><td style="text-align: left;"> applies PLS-DA model to a new data.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code>classmodel</code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPredictions.classmodel">plotPredictions.classmodel</a></code> </td><td style="text-align: left;"> shows plot with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSensitivity.classmodel">plotSensitivity.classmodel</a></code> </td><td style="text-align: left;"> shows sensitivity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSpecificity.classmodel">plotSpecificity.classmodel</a></code> </td><td style="text-align: left;"> shows specificity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotMisclassified.classmodel">plotMisclassified.classmodel</a></code> </td><td style="text-align: left;"> shows misclassified ratio plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>See also methods for class <code><a href="#topic+pls">pls</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Examples for PLS-DA model class

library(mdatools)

## 1. Make a PLS-DA model with full cross-validation and show model overview

# make a calibration set from iris data (3 classes)
# use names of classes as class vector
x.cal = iris[seq(1, nrow(iris), 2), 1:4]
c.cal = iris[seq(1, nrow(iris), 2), 5]

model = plsda(x.cal, c.cal, ncomp = 3, cv = 1, info = 'IRIS data example')
model = selectCompNum(model, 1)

# show summary and basic model plots
# misclassification will be shown only for first class
summary(model)
plot(model)

# summary and model plots for second class
summary(model, nc = 2)
plot(model, nc = 2)

# summary and model plot for specific class and number of components
summary(model, nc = 3, ncomp = 3)
plot(model, nc = 3, ncomp = 3)

## 2. Show performance plots for a model
par(mfrow = c(2, 2))
plotSpecificity(model)
plotSensitivity(model)
plotMisclassified(model)
plotMisclassified(model, nc = 2)
par(mfrow = c(1, 1))

## 3. Show both class and y values predictions
par(mfrow = c(2, 2))
plotPredictions(model)
plotPredictions(model, res = "cal", ncomp = 2, nc = 2)
plotPredictions(structure(model, class = "regmodel"))
plotPredictions(structure(model, class = "regmodel"), ncomp = 2, ny = 2)
par(mfrow = c(1, 1))

## 4. All plots from ordinary PLS can be used, e.g.:
par(mfrow = c(2, 2))
plotXYScores(model)
plotYVariance(model)
plotXResiduals(model)
plotRegcoeffs(model, ny = 2)
par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='plsdares'>PLS-DA results</h2><span id='topic+plsdares'></span>

<h3>Description</h3>

<p><code>plsdares</code> is used to store and visualize results of applying a PLS-DA model to a new data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plsdares(plsres, cres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plsdares_+3A_plsres">plsres</code></td>
<td>
<p>PLS results for the data.</p>
</td></tr>
<tr><td><code id="plsdares_+3A_cres">cres</code></td>
<td>
<p>Classification results for the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Do not use <code>plsdares</code> manually, the object is created automatically when one applies a
PLS-DA model to a new data set, e.g. when calibrate and validate a PLS-DA model (all calibration
and validation results in PLS-DA model are stored as objects of <code>plsdares</code> class) or use
function <code><a href="#topic+predict.plsda">predict.plsda</a></code>.
</p>
<p>The object gives access to all PLS-DA results as well as to the plotting methods for
visualisation of the results. The <code>plsidares</code> class also inherits all properties and methods
of <code>classres</code> and <code>plsres</code> classes.
</p>
<p>If no reference values provided, classification statistics will not be calculated and
performance plots will not be available.
</p>


<h3>Value</h3>

<p>Returns an object of <code>plsdares</code> class with fields, inherited from <code><a href="#topic+classres">classres</a></code>
and <code><a href="#topic+plsres">plsres</a></code>.
</p>


<h3>See Also</h3>

<p>Methods for <code>plsda</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print.plsda</code> </td><td style="text-align: left;"> shows information about the object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>summary.plsda</code> </td><td style="text-align: left;"> shows statistics for results of classification.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>plot.plsda</code> </td><td style="text-align: left;"> shows plots for overview of the results.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code><a href="#topic+classres">classres</a></code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+showPredictions.classres">showPredictions.classres</a></code> </td><td style="text-align: left;"> show table with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPredictions.classres">plotPredictions.classres</a></code> </td><td style="text-align: left;"> makes plot with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSensitivity.classres">plotSensitivity.classres</a></code> </td><td style="text-align: left;"> makes plot with sensitivity vs. components
values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSpecificity.classres">plotSpecificity.classres</a></code> </td><td style="text-align: left;"> makes plot with specificity vs. components
values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPerformance.classres">plotPerformance.classres</a></code> </td><td style="text-align: left;"> makes plot with both specificity and sensitivity
  values.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods for <code>plsres</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>print</code> </td><td style="text-align: left;"> prints information about a <code>plsres</code> object.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+summary.plsres">summary.plsres</a></code> </td><td style="text-align: left;"> shows performance statistics for the results.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plot.plsres">plot.plsres</a></code> </td><td style="text-align: left;"> shows plot overview of the results.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXScores.plsres">plotXScores.plsres</a></code> </td><td style="text-align: left;"> shows scores plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXYScores.plsres">plotXYScores.plsres</a></code> </td><td style="text-align: left;"> shows scores plot for x and y decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXVariance.plsres">plotXVariance.plsres</a></code> </td><td style="text-align: left;"> shows explained variance plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotYVariance.plsres">plotYVariance.plsres</a></code> </td><td style="text-align: left;"> shows explained variance plot for y decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXCumVariance.plsres">plotXCumVariance.plsres</a></code> </td><td style="text-align: left;"> shows cumulative explained variance plot for y
   decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotYCumVariance.plsres">plotYCumVariance.plsres</a></code> </td><td style="text-align: left;"> shows cumulative explained variance plot for y
   decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXResiduals.plsres">plotXResiduals.plsres</a></code> </td><td style="text-align: left;"> shows T2 vs. Q plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotYResiduals.plsres">plotYResiduals.plsres</a></code> </td><td style="text-align: left;"> shows residuals plot for y values.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods inherited from <code>regres</code> class (parent class for <code>plsres</code>):
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotPredictions.regres">plotPredictions.regres</a></code> </td><td style="text-align: left;"> shows predicted vs. measured plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotRMSE.regres">plotRMSE.regres</a></code> </td><td style="text-align: left;"> shows RMSE plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>See also <code><a href="#topic+plsda">plsda</a></code> - a class for PLS-DA models, <code><a href="#topic+predict.plsda">predict.plsda</a></code> applying
PLS-DA model for a new dataset.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Examples for PLS-DA results class

library(mdatools)

## 1. Make a PLS-DA model with full cross-validation, get
## calibration results and show overview

# make a calibration set from iris data (3 classes)
# use names of classes as class vector
x.cal = iris[seq(1, nrow(iris), 2), 1:4]
c.cal = iris[seq(1, nrow(iris), 2), 5]

model = plsda(x.cal, c.cal, ncomp = 3, cv = 1, info = 'IRIS data example')
model = selectCompNum(model, 1)

res = model$calres

# show summary and basic plots for calibration results
summary(res)
plot(res)

## 2. Apply the calibrated PLS-DA model to a new dataset

# make a new data
x.new = iris[seq(2, nrow(iris), 2), 1:4]
c.new = iris[seq(2, nrow(iris), 2), 5]

res = predict(model, x.new, c.new)
summary(res)
plot(res)

## 3. Show performance plots for the results
par(mfrow = c(2, 2))
plotSpecificity(res)
plotSensitivity(res)
plotMisclassified(res)
plotMisclassified(res, nc = 2)
par(mfrow = c(1, 1))

## 3. Show both class and y values predictions
par(mfrow = c(2, 2))
plotPredictions(res)
plotPredictions(res, ncomp = 2, nc = 2)
plotPredictions(structure(res, class = "regres"))
plotPredictions(structure(res, class = "regres"), ncomp = 2, ny = 2)
par(mfrow = c(1, 1))

## 4. All plots from ordinary PLS results can be used, e.g.:
par(mfrow = c(2, 2))
plotXYScores(res)
plotYVariance(res, type = 'h')
plotXVariance(res, type = 'h')
plotXResiduals(res)
par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='plsres'>PLS results</h2><span id='topic+plsres'></span>

<h3>Description</h3>

<p><code>plsres</code> is used to store and visualize results of applying a PLS model to a new data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plsres(
  y.pred,
  y.ref = NULL,
  ncomp.selected = dim(y.pred)[2],
  xdecomp = NULL,
  ydecomp = NULL,
  info = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plsres_+3A_y.pred">y.pred</code></td>
<td>
<p>predicted y values.</p>
</td></tr>
<tr><td><code id="plsres_+3A_y.ref">y.ref</code></td>
<td>
<p>reference (measured) y values.</p>
</td></tr>
<tr><td><code id="plsres_+3A_ncomp.selected">ncomp.selected</code></td>
<td>
<p>selected (optimal) number of components.</p>
</td></tr>
<tr><td><code id="plsres_+3A_xdecomp">xdecomp</code></td>
<td>
<p>PLS decomposition of X data (object of class <code>ldecomp</code>).</p>
</td></tr>
<tr><td><code id="plsres_+3A_ydecomp">ydecomp</code></td>
<td>
<p>PLS decomposition of Y data (object of class <code>ldecomp</code>).</p>
</td></tr>
<tr><td><code id="plsres_+3A_info">info</code></td>
<td>
<p>information about the object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Do not use <code>plsres</code> manually, the object is created automatically when one applies a PLS
model to a new data set, e.g. when calibrate and validate a PLS model (all calibration and
validation results in PLS model are stored as objects of <code>plsres</code> class) or use function
<code><a href="#topic+predict.pls">predict.pls</a></code>.
</p>
<p>The object gives access to all PLS results as well as to the plotting methods for visualisation
of the results. The <code>plsres</code> class also inherits all properties and methods of <code>regres</code>
- general class for regression results.
</p>
<p>If no reference values provided, regression statistics will not be calculated and most of the
plots not available. The class is also used for cross-validation results, in this case some of
the values and methods are not available (e.g. scores and scores plot, etc.).
</p>
<p>All plots are based on <code><a href="#topic+mdaplot">mdaplot</a></code> function, so most of its options can be used (e.g.
color grouping, etc.).
</p>
<p>RPD is ratio of standard deviation of response values to standard error of prediction (SDy/SEP).
</p>


<h3>Value</h3>

<p>Returns an object of <code>plsres</code> class with following fields:
</p>
<table>
<tr><td><code>ncomp</code></td>
<td>
<p>number of components included to the model.</p>
</td></tr>
<tr><td><code>ncomp.selected</code></td>
<td>
<p>selected (optimal) number of components.</p>
</td></tr>
<tr><td><code>y.ref</code></td>
<td>
<p>a matrix with reference values for responses.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>a matrix with predicted values for responses.</p>
</td></tr>
<tr><td><code>rmse</code></td>
<td>
<p>a matrix with root mean squared error values for each response and component.</p>
</td></tr>
<tr><td><code>slope</code></td>
<td>
<p>a matrix with slope values for each response and component.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>a matrix with determination coefficients for each response and component.</p>
</td></tr>
<tr><td><code>bias</code></td>
<td>
<p>a matrix with bias values for each response and component.</p>
</td></tr>
<tr><td><code>sep</code></td>
<td>
<p>a matrix with standard error values for each response and component.</p>
</td></tr>
<tr><td><code>rpd</code></td>
<td>
<p>a matrix with RPD values for each response and component.</p>
</td></tr>
<tr><td><code>xdecomp</code></td>
<td>
<p>decomposition of predictors (object of class <code>ldecomp</code>).</p>
</td></tr>
<tr><td><code>ydecomp</code></td>
<td>
<p>decomposition of responses (object of class <code>ldecomp</code>).</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information about the object.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Methods for <code>plsres</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>print</code> </td><td style="text-align: left;"> prints information about a <code>plsres</code> object.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+summary.plsres">summary.plsres</a></code> </td><td style="text-align: left;"> shows performance statistics for the results.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plot.plsres">plot.plsres</a></code> </td><td style="text-align: left;"> shows plot overview of the results.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXScores.plsres">plotXScores.plsres</a></code> </td><td style="text-align: left;"> shows scores plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXYScores.plsres">plotXYScores.plsres</a></code> </td><td style="text-align: left;"> shows scores plot for x and y decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXVariance.plsres">plotXVariance.plsres</a></code> </td><td style="text-align: left;"> shows explained variance plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotYVariance.plsres">plotYVariance.plsres</a></code> </td><td style="text-align: left;"> shows explained variance plot for y decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXCumVariance.plsres">plotXCumVariance.plsres</a></code> </td><td style="text-align: left;"> shows cumulative explained variance plot for y
   decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotYCumVariance.plsres">plotYCumVariance.plsres</a></code> </td><td style="text-align: left;"> shows cumulative explained variance plot for y
   decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotXResiduals.plsres">plotXResiduals.plsres</a></code> </td><td style="text-align: left;"> shows T2 vs. Q plot for x decomposition.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotYResiduals.plsres">plotYResiduals.plsres</a></code> </td><td style="text-align: left;"> shows residuals plot for y values.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods inherited from <code>regres</code> class (parent class for <code>plsres</code>):
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotPredictions.regres">plotPredictions.regres</a></code> </td><td style="text-align: left;"> shows predicted vs. measured plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+plotRMSE.regres">plotRMSE.regres</a></code> </td><td style="text-align: left;"> shows RMSE plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>See also <code><a href="#topic+pls">pls</a></code> - a class for PLS models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Examples of using PLS result class
library(mdatools)
## 1. Make a PLS model for concentration of first component
## using full-cross validation and get calibration results

data(simdata)
x = simdata$spectra.c
y = simdata$conc.c[, 1]

model = pls(x, y, ncomp = 8, cv = 1)
model = selectCompNum(model, 2)
res = model$calres

summary(res)
plot(res)

## 2. Make a PLS model for concentration of first component
## and apply model to a new dataset

data(simdata)
x = simdata$spectra.c
y = simdata$conc.c[, 1]

model = pls(x, y, ncomp = 6, cv = 1)
model = selectCompNum(model, 2)

x.new = simdata$spectra.t
y.new = simdata$conc.t[, 1]
res = predict(model, x.new, y.new)

summary(res)
plot(res)

## 3. Show variance and error plots for PLS results
par(mfrow = c(2, 2))
plotXCumVariance(res, type = 'h')
plotYCumVariance(res, type = 'b', show.labels = TRUE, legend.position = 'bottomright')
plotRMSE(res)
plotRMSE(res, type = 'h', show.labels = TRUE)
par(mfrow = c(1, 1))

## 4. Show scores plots for PLS results
## (for results plot we can use color grouping)
par(mfrow = c(2, 2))
plotXScores(res)
plotXScores(res, show.labels = TRUE, cgroup = y.new)
plotXYScores(res)
plotXYScores(res, comp = 2, show.labels = TRUE)
par(mfrow = c(1, 1))

## 5. Show predictions and residuals plots for PLS results
par(mfrow = c(2, 2))
plotXResiduals(res, show.label = TRUE, cgroup = y.new)
plotYResiduals(res, show.label = TRUE)
plotPredictions(res)
plotPredictions(res, ncomp = 4, xlab = 'C, reference', ylab = 'C, predictions')
par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='predict.mcrals'>MCR ALS predictions</h2><span id='topic+predict.mcrals'></span>

<h3>Description</h3>

<p>Applies MCR-ALS model to a new set of spectra and returns matrix with contributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcrals'
predict(object, x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mcrals_+3A_object">object</code></td>
<td>
<p>an MCR model (object of class <code>mcr</code>).</p>
</td></tr>
<tr><td><code id="predict.mcrals_+3A_x">x</code></td>
<td>
<p>spectral values (matrix or data frame).</p>
</td></tr>
<tr><td><code id="predict.mcrals_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with contributions
</p>

<hr>
<h2 id='predict.mcrpure'>MCR predictions</h2><span id='topic+predict.mcrpure'></span>

<h3>Description</h3>

<p>Applies MCR model to a new set of spectra and returns matrix with contributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcrpure'
predict(object, x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mcrpure_+3A_object">object</code></td>
<td>
<p>an MCR model (object of class <code>mcr</code>).</p>
</td></tr>
<tr><td><code id="predict.mcrpure_+3A_x">x</code></td>
<td>
<p>spectral values (matrix or data frame).</p>
</td></tr>
<tr><td><code id="predict.mcrpure_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with contributions
</p>

<hr>
<h2 id='predict.pca'>PCA predictions</h2><span id='topic+predict.pca'></span>

<h3>Description</h3>

<p>Applies PCA model to a new data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
predict(object, x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.pca_+3A_object">object</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>).</p>
</td></tr>
<tr><td><code id="predict.pca_+3A_x">x</code></td>
<td>
<p>data values (matrix or data frame).</p>
</td></tr>
<tr><td><code id="predict.pca_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>PCA results (an object of class <code>pcares</code>)
</p>

<hr>
<h2 id='predict.pls'>PLS predictions</h2><span id='topic+predict.pls'></span>

<h3>Description</h3>

<p>Applies PLS model to a new data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
predict(object, x, y = NULL, cv = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.pls_+3A_object">object</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="predict.pls_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors)</p>
</td></tr>
<tr><td><code id="predict.pls_+3A_y">y</code></td>
<td>
<p>a matrix with reference y values (responses)</p>
</td></tr>
<tr><td><code id="predict.pls_+3A_cv">cv</code></td>
<td>
<p>logical, shall predictions be made for cross-validation procedure or not</p>
</td></tr>
<tr><td><code id="predict.pls_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>


<h3>Value</h3>

<p>PLS results (an object of class <code><a href="#topic+plsres">plsres</a></code>)
</p>

<hr>
<h2 id='predict.plsda'>PLS-DA predictions</h2><span id='topic+predict.plsda'></span>

<h3>Description</h3>

<p>Applies PLS-DA model to a new data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsda'
predict(object, x, c.ref = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.plsda_+3A_object">object</code></td>
<td>
<p>a PLS-DA model (object of class <code>plsda</code>)</p>
</td></tr>
<tr><td><code id="predict.plsda_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors)</p>
</td></tr>
<tr><td><code id="predict.plsda_+3A_c.ref">c.ref</code></td>
<td>
<p>a vector with reference class values (should be a factor)</p>
</td></tr>
<tr><td><code id="predict.plsda_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+plsda">plsda</a></code> function.
</p>


<h3>Value</h3>

<p>PLS-DA results (an object of class <code>plsdares</code>)
</p>

<hr>
<h2 id='predict.simca'>SIMCA predictions</h2><span id='topic+predict.simca'></span>

<h3>Description</h3>

<p>Applies SIMCA model to a new data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simca'
predict(object, x, c.ref = NULL, cal = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.simca_+3A_object">object</code></td>
<td>
<p>a SIMCA model (object of class <code>simca</code>)</p>
</td></tr>
<tr><td><code id="predict.simca_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors)</p>
</td></tr>
<tr><td><code id="predict.simca_+3A_c.ref">c.ref</code></td>
<td>
<p>a vector with reference class names (same as class names for models)</p>
</td></tr>
<tr><td><code id="predict.simca_+3A_cal">cal</code></td>
<td>
<p>logical, are predictions for calibration set or not</p>
</td></tr>
<tr><td><code id="predict.simca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+simca">simca</a></code> function.
</p>


<h3>Value</h3>

<p>SIMCA results (an object of class <code>simcares</code>)
</p>

<hr>
<h2 id='predict.simcam'>SIMCA multiple classes predictions</h2><span id='topic+predict.simcam'></span>

<h3>Description</h3>

<p>Applies SIMCAM model (SIMCA for multiple classes) to a new data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
predict(object, x, c.ref = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.simcam_+3A_object">object</code></td>
<td>
<p>a SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
<tr><td><code id="predict.simcam_+3A_x">x</code></td>
<td>
<p>a matrix with x values (predictors)</p>
</td></tr>
<tr><td><code id="predict.simcam_+3A_c.ref">c.ref</code></td>
<td>
<p>a vector with reference class names (same as class names in models)</p>
</td></tr>
<tr><td><code id="predict.simcam_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples in help for <code><a href="#topic+simcam">simcam</a></code> function.
</p>


<h3>Value</h3>

<p>SIMCAM results (an object of class <code>simcamres</code>)
</p>

<hr>
<h2 id='prep'>Class for preprocessing object</h2><span id='topic+prep'></span>

<h3>Description</h3>

<p>Class for preprocessing object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep(name, params = NULL, method = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_+3A_name">name</code></td>
<td>
<p>short text with name for the preprocessing method.</p>
</td></tr>
<tr><td><code id="prep_+3A_params">params</code></td>
<td>
<p>a list with parameters for the method (if NULL - default parameters will be used).</p>
</td></tr>
<tr><td><code id="prep_+3A_method">method</code></td>
<td>
<p>method to call when applying the preprocessing, provide it only for user defined methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use this class to create a list with a sequence of preprocessing methods to keep them together
in right order and with defined parameters. The list/object can be provided as an extra argument
to any modelling function (e.g. <code>pca</code>, <code>pls</code>, etc), so the optimal model parameters and
the optimal preprocessing will be stored together and can be applied to a raw data by using
method <code>predict</code>.
</p>
<p>For your own preprocessing method you need to create a function, which takes matrix with values
(dataset) as the first argument, does something and then return a matrix with the same dimension
and same attributes as the result. The method can have any number of optional  parameters.
</p>
<p>See Bookdown tutorial for details.
</p>

<hr>
<h2 id='prep.alsbasecorr'>Baseline correction using asymetric least squares</h2><span id='topic+prep.alsbasecorr'></span>

<h3>Description</h3>

<p>Baseline correction using asymetric least squares
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.alsbasecorr(data, plambda = 5, p = 0.1, max.niter = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.alsbasecorr_+3A_data">data</code></td>
<td>
<p>matrix with spectra (rows correspond to individual spectra)</p>
</td></tr>
<tr><td><code id="prep.alsbasecorr_+3A_plambda">plambda</code></td>
<td>
<p>power of the penalty parameter (e.g. if plambda = 5, lambda = 10^5)</p>
</td></tr>
<tr><td><code id="prep.alsbasecorr_+3A_p">p</code></td>
<td>
<p>assymetry ratio (should be between 0 and 1)</p>
</td></tr>
<tr><td><code id="prep.alsbasecorr_+3A_max.niter">max.niter</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements baseline correction algorithm based on Whittaker smoother. The method
was first shown in [1]. The function has two main parameters - power of a penalty parameter
(usually varies betwen 2 and 9) and the ratio of assymetry (usually between 0.1 and 0.001). The
choice of the parameters depends on how broad the disturbances of the baseline are and how
narrow the original spectral peaks are.
</p>


<h3>Value</h3>

<p>preprocessed spectra.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># take spectra from carbs dataset
data(carbs)
spectra = mda.t(carbs$S)

# apply the correction
pspectra = prep.alsbasecorr(spectra, plambda = 3, p = 0.01)

# show the original and the corrected spectra individually
par(mfrow = c(3, 1))
for (i in 1:3) {
   mdaplotg(list(
      original = mda.subset(spectra, i),
      corrected = mda.subset(pspectra, i)
   ), type = "l", col = c("black", "red"), lwd = c(2, 1), main = rownames(spectra)[i])
}

</code></pre>

<hr>
<h2 id='prep.autoscale'>Autoscale values</h2><span id='topic+prep.autoscale'></span>

<h3>Description</h3>

<p>Autoscale (mean center and standardize) values in columns of data matrix.
</p>
<p>The use of 'max.cov' allows to avoid overestimation of inert variables, which vary
very little. Note, that the 'max.cov' value is already in percent, e.g. if 'max.cov = 0.1' it
will compare the coefficient of variation of every variable with 0.1
want to use this option simply keep 'max.cov = 0'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.autoscale(data, center = TRUE, scale = FALSE, max.cov = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.autoscale_+3A_data">data</code></td>
<td>
<p>a matrix with data values</p>
</td></tr>
<tr><td><code id="prep.autoscale_+3A_center">center</code></td>
<td>
<p>a logical value or vector with numbers for centering</p>
</td></tr>
<tr><td><code id="prep.autoscale_+3A_scale">scale</code></td>
<td>
<p>a logical value or vector with numbers for weighting</p>
</td></tr>
<tr><td><code id="prep.autoscale_+3A_max.cov">max.cov</code></td>
<td>
<p>columns that have coefficient of variation (in percent) below or equal to 'max.cov' will not
be scaled</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data matrix with processed values
</p>

<hr>
<h2 id='prep.generic'>Generic function for preprocessing</h2><span id='topic+prep.generic'></span>

<h3>Description</h3>

<p>Generic function for preprocessing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.generic(x, f, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.generic_+3A_x">x</code></td>
<td>
<p>data matrix to be preprocessed</p>
</td></tr>
<tr><td><code id="prep.generic_+3A_f">f</code></td>
<td>
<p>function for preprocessing</p>
</td></tr>
<tr><td><code id="prep.generic_+3A_...">...</code></td>
<td>
<p>arguments for the function f</p>
</td></tr>
</table>

<hr>
<h2 id='prep.list'>Shows information about all implemented preprocessing methods.</h2><span id='topic+prep.list'></span>

<h3>Description</h3>

<p>Shows information about all implemented preprocessing methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.list()
</code></pre>

<hr>
<h2 id='prep.msc'>Multiplicative Scatter Correction transformation</h2><span id='topic+prep.msc'></span>

<h3>Description</h3>

<p>Applies Multiplicative Scatter Correction (MSC) transformation to data matrix (spectra)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.msc(data, mspectrum = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.msc_+3A_data">data</code></td>
<td>
<p>a matrix with data values (spectra)</p>
</td></tr>
<tr><td><code id="prep.msc_+3A_mspectrum">mspectrum</code></td>
<td>
<p>mean spectrum (if NULL will be calculated from <code>spectra</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MSC is used to remove scatter effects (baseline offset and slope) from
spectral data, e.g. NIR spectra.
</p>
<p>@examples
</p>
<p>### Apply MSC to spectra from simdata
</p>
<p>library(mdatools)
data(simdata)
</p>
<p>spectra = simdata$spectra.c
cspectra = prep.msc(spectra)
</p>
<p>par(mfrow = c(2, 1))
mdaplot(spectra, type = &quot;l&quot;, main = &quot;Before MSC&quot;)
mdaplot(cspectra, type = &quot;l&quot;, main = &quot;After MSC&quot;)
</p>


<h3>Value</h3>

<p>preprocessed spectra (calculated mean spectrum is assigned as attribut 'mspectrum')
</p>

<hr>
<h2 id='prep.norm'>Normalization</h2><span id='topic+prep.norm'></span>

<h3>Description</h3>

<p>Normalizes signals (rows of data matrix).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.norm(data, type = "area", col.ind = NULL, ref.spectrum = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.norm_+3A_data">data</code></td>
<td>
<p>a matrix with data values</p>
</td></tr>
<tr><td><code id="prep.norm_+3A_type">type</code></td>
<td>
<p>type of normalization <code>"area"</code>, <code>"length"</code>, <code>"sum"</code>, <code>"snv"</code>, <code>"is"</code>, or <code>"pqn"</code>.</p>
</td></tr>
<tr><td><code id="prep.norm_+3A_col.ind">col.ind</code></td>
<td>
<p>indices of columns (can be either integer or logical valuws) for normalization to internal
standard peak.</p>
</td></tr>
<tr><td><code id="prep.norm_+3A_ref.spectrum">ref.spectrum</code></td>
<td>
<p>reference spectrum for PQN normalization, if not provided a mean spectrum for data is used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>"area"</code>, <code>"length"</code>, <code>"sum"</code> types do preprocessing to unit area (sum of
absolute values), length or sum of all values in every row of data matrix. Type <code>"snv"</code>
does the Standard Normal Variate normalization, similar to <code><a href="#topic+prep.snv">prep.snv</a></code>. Type
<code>"is"</code> does the normalization to internal standard peak, whose position is defined by
parameter 'col.ind'. If the position is a single value, the rows are normalized to the height
of this peak. If 'col.ind' points on several adjucent vales, the rows are normalized to the area
under the peak - sum of the intensities.
</p>
<p>The <code>"pqn"</code> is Probabilistic Quotient Normalization as described in [1]. In this case you also
need to provide a reference spectrum (e.g. mean or median of spectra for some reference samples). If
reference spectrum is not provided it will be computed as mean of the spectra to be
preprocessed (parameter <code>data</code>).
</p>


<h3>Value</h3>

<p>data matrix with normalized values
</p>


<h3>References</h3>

<p>1. F. Dieterle, A. Ross, H. Senn. Probabilistic Quotient Normalization as Robust Method to
Account for Dilution of Complex Biological Mixtures. Application in 1 H NMR Metabonomics.
Anal. Chem. 2006, 78, 42814290.
</p>

<hr>
<h2 id='prep.ref2km'>Kubelka-Munk transformation</h2><span id='topic+prep.ref2km'></span>

<h3>Description</h3>

<p>Applies Kubelka-Munk (km) transformation to data matrix (spectra)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.ref2km(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.ref2km_+3A_data">data</code></td>
<td>
<p>a matrix with spectra values (absolute reflectance values)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kubelka-Munk is useful preprocessing method for diffuse reflection spectra (e.g. taken for
powders or rough surface). It transforms the reflectance spectra R to K/M units as follows:
(1 - R)^2 / 2R
</p>


<h3>Value</h3>

<p>preprocessed spectra.
</p>

<hr>
<h2 id='prep.savgol'>Savytzky-Golay filter</h2><span id='topic+prep.savgol'></span>

<h3>Description</h3>

<p>Applies Savytzky-Golay filter to the rows of data matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.savgol(data, width = 3, porder = 1, dorder = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.savgol_+3A_data">data</code></td>
<td>
<p>a matrix with data values</p>
</td></tr>
<tr><td><code id="prep.savgol_+3A_width">width</code></td>
<td>
<p>width of the filter window</p>
</td></tr>
<tr><td><code id="prep.savgol_+3A_porder">porder</code></td>
<td>
<p>order of polynomial used for smoothing</p>
</td></tr>
<tr><td><code id="prep.savgol_+3A_dorder">dorder</code></td>
<td>
<p>order of derivative to take (0 - no derivative)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements algorithm described in [1] which handles the edge points correctly and
does not require to cut the spectra.
</p>


<h3>References</h3>

<p>1. Peter A. Gorry. General least-squares smoothing and differentiation by the convolution
(Savitzky-Golay) method. Anal. Chem. 1990, 62, 6, 570573, https://doi.org/10.1021/ac00205a007.
</p>

<hr>
<h2 id='prep.snv'>Standard Normal Variate transformation</h2><span id='topic+prep.snv'></span>

<h3>Description</h3>

<p>Applies Standard Normal Variate (SNV) transformation to the rows of data matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.snv(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.snv_+3A_data">data</code></td>
<td>
<p>a matrix with data values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>SNV is a simple preprocessing to remove scatter effects (baseline offset and slope) from
spectral data, e.g. NIR spectra.
</p>
<p>@examples
</p>
<p>### Apply SNV to spectra from simdata
</p>
<p>library(mdatools)
data(simdata)
</p>
<p>spectra = simdata$spectra.c
wavelength = simdata$wavelength
</p>
<p>cspectra = prep.snv(spectra)
</p>
<p>par(mfrow = c(2, 1))
mdaplot(cbind(wavelength, t(spectra)), type = 'l', main = 'Before SNV')
mdaplot(cbind(wavelength, t(cspectra)), type = 'l', main = 'After SNV')
</p>


<h3>Value</h3>

<p>data matrix with processed values
</p>

<hr>
<h2 id='prep.transform'>Transformation</h2><span id='topic+prep.transform'></span>

<h3>Description</h3>

<p>Transforms values from using any mathematical function (e.g. log).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.transform(data, fun, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.transform_+3A_data">data</code></td>
<td>
<p>a matrix with data values</p>
</td></tr>
<tr><td><code id="prep.transform_+3A_fun">fun</code></td>
<td>
<p>reference to a transformation function, e.g. 'log' or 'function(x) x^2'.</p>
</td></tr>
<tr><td><code id="prep.transform_+3A_...">...</code></td>
<td>
<p>optional parameters for the transformation function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data matrix with transformed values
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate a matrix with two columns
y &lt;- cbind(rnorm(100, 10, 1), rnorm(100, 20, 2))

# apply log transformation
py1 = prep.transform(y, log)

# apply power transformation
py2 = prep.transform(y, function(x) x^-1.25)

# show distributions
par(mfrow = c(2, 3))
for (i in 1:2) {
   hist(y[, i], main = paste0("Original values, column #", i))
   hist(py1[, i], main = paste0("Log-transformed, column #", i))
   hist(py2[, i], main = paste0("Power-transformed, column #", i))
}

</code></pre>

<hr>
<h2 id='prep.varsel'>Variable selection</h2><span id='topic+prep.varsel'></span>

<h3>Description</h3>

<p>Returns dataset with selected variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.varsel(data, var.ind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.varsel_+3A_data">data</code></td>
<td>
<p>a matrix with data values</p>
</td></tr>
<tr><td><code id="prep.varsel_+3A_var.ind">var.ind</code></td>
<td>
<p>indices of variables (columns) to select, can bet either numeric or logical</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data matrix with the selected variables (columns)
</p>

<hr>
<h2 id='preparePlotData'>Take dataset and prepare them for plot</h2><span id='topic+preparePlotData'></span>

<h3>Description</h3>

<p>The function checks that 'data' contains correct numeric values, check for
mandatory attributes (row and column names, x- and y-axis values and names, etc.)
and add them if necessary.
</p>
<p>Another things is to remove hidden columns and split the rest to visible and hidden
values (if excluded rows are present).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preparePlotData(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preparePlotData_+3A_data">data</code></td>
<td>
<p>dataset (vector, matrix or data frame)</p>
</td></tr>
</table>

<hr>
<h2 id='prepCalData'>Prepares calibration data</h2><span id='topic+prepCalData'></span>

<h3>Description</h3>

<p>Prepares calibration data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepCalData(x, exclrows = NULL, exclcols = NULL, min.nrows = 1, min.ncols = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepCalData_+3A_x">x</code></td>
<td>
<p>matrix or data frame with values (calibration set)</p>
</td></tr>
<tr><td><code id="prepCalData_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="prepCalData_+3A_exclcols">exclcols</code></td>
<td>
<p>columns to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="prepCalData_+3A_min.nrows">min.nrows</code></td>
<td>
<p>smallest number of rows which must be in the dataset</p>
</td></tr>
<tr><td><code id="prepCalData_+3A_min.ncols">min.ncols</code></td>
<td>
<p>smallest number of columns which must be in the dataset</p>
</td></tr>
</table>

<hr>
<h2 id='print.classres'>Print information about classification result object</h2><span id='topic+print.classres'></span>

<h3>Description</h3>

<p>Generic <code>print</code> function for classification results. Prints information about major fields
of the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
print(x, str = "Classification results (class classres)\nMajor fields:", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.classres_+3A_x">x</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="print.classres_+3A_str">str</code></td>
<td>
<p>User specified text (e.g. to be used for particular method, like PLS-DA, etc).</p>
</td></tr>
<tr><td><code id="print.classres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.ipls'>Print method for iPLS</h2><span id='topic+print.ipls'></span>

<h3>Description</h3>

<p>Prints information about the iPLS object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipls'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.ipls_+3A_x">x</code></td>
<td>
<p>a iPLS (object of class <code>ipls</code>)</p>
</td></tr>
<tr><td><code id="print.ipls_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.ldecomp'>Print method for linear decomposition</h2><span id='topic+print.ldecomp'></span>

<h3>Description</h3>

<p>Generic <code>print</code> function for linear decomposition. Prints information about
the <code>ldecomp</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ldecomp'
print(x, str = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.ldecomp_+3A_x">x</code></td>
<td>
<p>object of class <code>ldecomp</code></p>
</td></tr>
<tr><td><code id="print.ldecomp_+3A_str">str</code></td>
<td>
<p>user specified text to show as a description of the object</p>
</td></tr>
<tr><td><code id="print.ldecomp_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.mcrals'>Print method for mcrpure object</h2><span id='topic+print.mcrals'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcrals'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mcrals_+3A_x">x</code></td>
<td>
<p><code>mcrpure</code> object</p>
</td></tr>
<tr><td><code id="print.mcrals_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.mcrpure'>Print method for mcrpure object</h2><span id='topic+print.mcrpure'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcrpure'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mcrpure_+3A_x">x</code></td>
<td>
<p><code>mcrpure</code> object</p>
</td></tr>
<tr><td><code id="print.mcrpure_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.pca'>Print method for PCA model object</h2><span id='topic+print.pca'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.pca_+3A_x">x</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="print.pca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.pcares'>Print method for PCA results object</h2><span id='topic+print.pcares'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcares'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.pcares_+3A_x">x</code></td>
<td>
<p>PCA results (object of class <code>pcares</code>)</p>
</td></tr>
<tr><td><code id="print.pcares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.pls'>Print method for PLS model object</h2><span id='topic+print.pls'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.pls_+3A_x">x</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="print.pls_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.plsda'>Print method for PLS-DA model object</h2><span id='topic+print.plsda'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsda'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.plsda_+3A_x">x</code></td>
<td>
<p>a PLS-DA model (object of class <code>plsda</code>)</p>
</td></tr>
<tr><td><code id="print.plsda_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.plsdares'>Print method for PLS-DA results object</h2><span id='topic+print.plsdares'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsdares'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.plsdares_+3A_x">x</code></td>
<td>
<p>PLS-DA results (object of class <code>plsdares</code>)</p>
</td></tr>
<tr><td><code id="print.plsdares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.plsres'>print method for PLS results object</h2><span id='topic+print.plsres'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.plsres_+3A_x">x</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="print.plsres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.randtest'>Print method for randtest object</h2><span id='topic+print.randtest'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randtest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.randtest_+3A_x">x</code></td>
<td>
<p>a randomization test results (object of class <code>randtest</code>)</p>
</td></tr>
<tr><td><code id="print.randtest_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.regcoeffs'>print method for regression coefficients class</h2><span id='topic+print.regcoeffs'></span>

<h3>Description</h3>

<p>prints regression coeffocoent values for given response number and amount of components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regcoeffs'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.regcoeffs_+3A_x">x</code></td>
<td>
<p>regression coefficients object (class <code>regcoeffs</code>)</p>
</td></tr>
<tr><td><code id="print.regcoeffs_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.regmodel'>Print method for PLS model object</h2><span id='topic+print.regmodel'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmodel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.regmodel_+3A_x">x</code></td>
<td>
<p>a regression model (object of class <code>regmodel</code>)</p>
</td></tr>
<tr><td><code id="print.regmodel_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.regres'>print method for regression results object</h2><span id='topic+print.regres'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regres'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.regres_+3A_x">x</code></td>
<td>
<p>regression results (object of class <code>regres</code>)</p>
</td></tr>
<tr><td><code id="print.regres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.simca'>Print method for SIMCA model object</h2><span id='topic+print.simca'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simca'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.simca_+3A_x">x</code></td>
<td>
<p>a SIMCA model (object of class <code>simca</code>)</p>
</td></tr>
<tr><td><code id="print.simca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.simcam'>Print method for SIMCAM model object</h2><span id='topic+print.simcam'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.simcam_+3A_x">x</code></td>
<td>
<p>a SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
<tr><td><code id="print.simcam_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.simcamres'>Print method for SIMCAM results object</h2><span id='topic+print.simcamres'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcamres'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.simcamres_+3A_x">x</code></td>
<td>
<p>SIMCAM results (object of class <code>simcamres</code>)</p>
</td></tr>
<tr><td><code id="print.simcamres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='print.simcares'>Print method for SIMCA results object</h2><span id='topic+print.simcares'></span>

<h3>Description</h3>

<p>Prints information about the object structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcares'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.simcares_+3A_x">x</code></td>
<td>
<p>SIMCA results (object of class <code>simcares</code>)</p>
</td></tr>
<tr><td><code id="print.simcares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='randtest'>Randomization test for PLS regression</h2><span id='topic+randtest'></span>

<h3>Description</h3>

<p><code>randtest</code> is used to carry out randomization/permutation test for a PLS regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randtest(
  x,
  y,
  ncomp = 15,
  center = TRUE,
  scale = FALSE,
  nperm = 1000,
  sig.level = 0.05,
  silent = TRUE,
  exclcols = NULL,
  exclrows = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randtest_+3A_x">x</code></td>
<td>
<p>matrix with predictors.</p>
</td></tr>
<tr><td><code id="randtest_+3A_y">y</code></td>
<td>
<p>vector or one-column matrix with response.</p>
</td></tr>
<tr><td><code id="randtest_+3A_ncomp">ncomp</code></td>
<td>
<p>maximum number of components to test.</p>
</td></tr>
<tr><td><code id="randtest_+3A_center">center</code></td>
<td>
<p>logical, center or not predictors and response values.</p>
</td></tr>
<tr><td><code id="randtest_+3A_scale">scale</code></td>
<td>
<p>logical, scale (standardize) or not predictors and response values.</p>
</td></tr>
<tr><td><code id="randtest_+3A_nperm">nperm</code></td>
<td>
<p>number of permutations.</p>
</td></tr>
<tr><td><code id="randtest_+3A_sig.level">sig.level</code></td>
<td>
<p>significance level.</p>
</td></tr>
<tr><td><code id="randtest_+3A_silent">silent</code></td>
<td>
<p>logical, show or not test progress.</p>
</td></tr>
<tr><td><code id="randtest_+3A_exclcols">exclcols</code></td>
<td>
<p>columns of x to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
<tr><td><code id="randtest_+3A_exclrows">exclrows</code></td>
<td>
<p>rows to be excluded from calculations (numbers, names or vector with logical values)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The class implements a method for selection of optimal number of components in PLS1 regression
based on the randomization test [1]. The basic idea is that for each component from 1 to
<code>ncomp</code> a statistic T, which is a covariance between t-score (X score, derived from a PLS
model) and the reference Y values, is calculated. By repeating this for randomly permuted
Y-values a distribution of the statistic is obtained. A parameter <code>alpha</code> is computed to
show how often the statistic T, calculated for permuted Y-values, is the same or higher than
the same statistic, calculated for original data without permutations.
</p>
<p>If a component is important, then the covariance for unpermuted data should be larger than the
covariance for permuted data and therefore the value for <code>alpha</code> will be quie small (there
is still a small chance to get similar covariance). This makes <code>alpha</code> very similar to
p-value in a statistical test.
</p>
<p>The <code>randtest</code> procedure calculates alpha for each component, the values can be observed
using <code>summary</code> or <code>plot</code> functions. There are also several function, allowing e.g.
to show distribution of statistics and the critical value for each component.
</p>


<h3>Value</h3>

<p>Returns an object of <code>randtest</code> class with following fields:
</p>
<table>
<tr><td><code>nperm</code></td>
<td>
<p>number of permutations used for the test.</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>statistic values calculated for each component.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>alpha values calculated for each component.</p>
</td></tr>
<tr><td><code>statperm</code></td>
<td>
<p>matrix with statistic values for each permutation.</p>
</td></tr>
<tr><td><code>corrperm</code></td>
<td>
<p>matrix with correlation between predicted and reference y-vales for each
permutation.</p>
</td></tr>
<tr><td><code>ncomp.selected</code></td>
<td>
<p>suggested number of components.</p>
</td></tr>
</table>


<h3>References</h3>

<p>S. Wiklund et al. Journal of Chemometrics 21 (2007) 427-439.
</p>


<h3>See Also</h3>

<p>Methods for <code>randtest</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print.randtest</code> </td><td style="text-align: left;"> prints information about a <code>randtest</code> object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+summary.randtest">summary.randtest</a></code> </td><td style="text-align: left;"> shows summary statistics for the test.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plot.randtest">plot.randtest</a></code> </td><td style="text-align: left;"> shows bar plot for alpha values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotHist.randtest">plotHist.randtest</a></code> </td><td style="text-align: left;"> shows distribution of statistic plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotCorr.randtest">plotCorr.randtest</a></code> </td><td style="text-align: left;"> shows determination coefficient plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>### Examples of using the test

## Get the spectral data from Simdata set and apply SNV transformation

data(simdata)

y = simdata$conc.c[, 3]
x = simdata$spectra.c
x = prep.snv(x)

## Run the test and show summary
## (normally use higher nperm values &gt; 1000)
r = randtest(x, y, ncomp = 4, nperm = 200, silent = FALSE)
summary(r)

## Show plots

par( mfrow = c(3, 2))
plot(r)
plotHist(r, ncomp = 3)
plotHist(r, ncomp = 4)
plotCorr(r, 3)
plotCorr(r, 4)
par( mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='regcoeffs'>Regression coefficients</h2><span id='topic+regcoeffs'></span>

<h3>Description</h3>

<p>class for storing and visualisation of regression coefficients
for regression models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regcoeffs(coeffs, ci.coeffs = NULL, use.mean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regcoeffs_+3A_coeffs">coeffs</code></td>
<td>
<p>array (npred x ncomp x nresp) with regression coefficients</p>
</td></tr>
<tr><td><code id="regcoeffs_+3A_ci.coeffs">ci.coeffs</code></td>
<td>
<p>array (npred x ncomp x nresp x cv) with regression coefficients for
computing confidence intervals (e.g. from cross-validation) using Jack-Knifing method</p>
</td></tr>
<tr><td><code id="regcoeffs_+3A_use.mean">use.mean</code></td>
<td>
<p>logical, tells how to compute standard error for regression coefficients. If <code>TRUE</code>
mean values for ci.coeffs is computed first. If <code>FALSE</code>, <code>values</code> (coefficients
computed for global model) are used as mean.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list (object of <code>regcoeffs</code> class) with fields, including:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>values</code> </td><td style="text-align: left;"> an array (nvar x ncomp x ny) with regression coefficients </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>se</code> </td><td style="text-align: left;"> an array (nvar x ncomp x ny) with standard errors for the coefficients </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>t.values</code> </td><td style="text-align: left;"> an array (nvar x ncomp x ny) with t-values for the coefficients </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>p.values</code> </td><td style="text-align: left;"> an array (nvar x ncomp x ny) with p-values for coefficients </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>last three fields are available if parameter <code>ci.coeffs</code> was provided.
</p>
<p>Check also <code><a href="#topic+confint.regcoeffs">confint.regcoeffs</a></code>, <code><a href="#topic+summary.regcoeffs">summary.regcoeffs</a></code> and
<code><a href="#topic+plot.regcoeffs">plot.regcoeffs</a></code>.
</p>

<hr>
<h2 id='regcoeffs.getStats'>Distribution statistics for regression coeffificents</h2><span id='topic+regcoeffs.getStats'></span>

<h3>Description</h3>

<p>calculates standard error, t-values and p-values for
regression coefficients based on Jack-Knifing method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regcoeffs.getStats(coeffs, ci.coeffs = NULL, use.mean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regcoeffs.getStats_+3A_coeffs">coeffs</code></td>
<td>
<p>array (npred x ncomp x nresp) with regression coefficients</p>
</td></tr>
<tr><td><code id="regcoeffs.getStats_+3A_ci.coeffs">ci.coeffs</code></td>
<td>
<p>array (npred x ncomp x nresp x cv) with regression coefficients for
computing confidence intervals (e.g. from cross-validation) using Jack-Knifing method</p>
</td></tr>
<tr><td><code id="regcoeffs.getStats_+3A_use.mean">use.mean</code></td>
<td>
<p>logical, tells how to compute standard error for regression coefficients. If <code>TRUE</code>
mean values for ci.coeffs is computed first. If <code>FALSE</code>, <code>values</code> (coefficients
computed for global model) are used as mean.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with statistics three arrays: srandard error, t-values and p-values computed for
each regression coefficient.
</p>

<hr>
<h2 id='regres'>Regression results</h2><span id='topic+regres'></span>

<h3>Description</h3>

<p>Class for storing and visualisation of regression predictions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regres(y.pred, y.ref = NULL, ncomp.selected = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regres_+3A_y.pred">y.pred</code></td>
<td>
<p>vector or matrix with y predicted values</p>
</td></tr>
<tr><td><code id="regres_+3A_y.ref">y.ref</code></td>
<td>
<p>vector with reference (measured) y values</p>
</td></tr>
<tr><td><code id="regres_+3A_ncomp.selected">ncomp.selected</code></td>
<td>
<p>if y.pred calculated for different components, which to use as default</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list (object of <code>regres</code> class) with fields, including:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>y.pred</code> </td><td style="text-align: left;"> a matrix with predicted values </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>y.ref</code> </td><td style="text-align: left;"> a vector with reference (measured) values </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>ncomp.selected</code> </td><td style="text-align: left;"> selected column/number of components for predictions </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>rmse</code> </td><td style="text-align: left;"> root mean squared error for predicted vs measured values </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>slope</code> </td><td style="text-align: left;"> slope for predicted vs measured values </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>r2</code> </td><td style="text-align: left;"> coefficient of determination for predicted vs measured values </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>bias</code> </td><td style="text-align: left;"> bias for predicted vs measured values </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>rpd</code> </td><td style="text-align: left;"> RPD values </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<hr>
<h2 id='regres.bias'>Prediction bias</h2><span id='topic+regres.bias'></span>

<h3>Description</h3>

<p>Calculates matrix with bias (average prediction error) for every response and components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regres.bias(err)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regres.bias_+3A_err">err</code></td>
<td>
<p>vector with difference between reference and predicted y-values</p>
</td></tr>
</table>

<hr>
<h2 id='regres.err'>Error of prediction</h2><span id='topic+regres.err'></span>

<h3>Description</h3>

<p>Calculates array of differences between predicted and reference values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regres.err(y.pred, y.ref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regres.err_+3A_y.pred">y.pred</code></td>
<td>
<p>matrix with predicted values</p>
</td></tr>
<tr><td><code id="regres.err_+3A_y.ref">y.ref</code></td>
<td>
<p>vector with reference values</p>
</td></tr>
</table>

<hr>
<h2 id='regres.r2'>Determination coefficient</h2><span id='topic+regres.r2'></span>

<h3>Description</h3>

<p>Calculates matrix with coeffient of determination for every response and components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regres.r2(err, ytot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regres.r2_+3A_err">err</code></td>
<td>
<p>vector with difference between reference and predicted y-values</p>
</td></tr>
<tr><td><code id="regres.r2_+3A_ytot">ytot</code></td>
<td>
<p>total variance for y-values</p>
</td></tr>
</table>

<hr>
<h2 id='regres.rmse'>RMSE</h2><span id='topic+regres.rmse'></span>

<h3>Description</h3>

<p>Calculates matrix with root mean squared error of prediction for every response and components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regres.rmse(err)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regres.rmse_+3A_err">err</code></td>
<td>
<p>vector with difference between reference and predicted y-values</p>
</td></tr>
</table>

<hr>
<h2 id='regres.slope'>Slope</h2><span id='topic+regres.slope'></span>

<h3>Description</h3>

<p>Calculates matrix with slope of predicted and measured values for every response and components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regres.slope(y.pred, y.ref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regres.slope_+3A_y.pred">y.pred</code></td>
<td>
<p>matrix with predicted values</p>
</td></tr>
<tr><td><code id="regres.slope_+3A_y.ref">y.ref</code></td>
<td>
<p>vector with reference values</p>
</td></tr>
</table>

<hr>
<h2 id='regress.addattrs'>Add names and attributes to matrix with statistics</h2><span id='topic+regress.addattrs'></span>

<h3>Description</h3>

<p>Add names and attributes to matrix with statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regress.addattrs(stat, attrs, name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regress.addattrs_+3A_stat">stat</code></td>
<td>
<p>matrix with statistics</p>
</td></tr>
<tr><td><code id="regress.addattrs_+3A_attrs">attrs</code></td>
<td>
<p>attributes from error matrix</p>
</td></tr>
<tr><td><code id="regress.addattrs_+3A_name">name</code></td>
<td>
<p>name of statistic</p>
</td></tr>
</table>

<hr>
<h2 id='repmat'>Replicate matric x</h2><span id='topic+repmat'></span>

<h3>Description</h3>

<p>Replicate matric x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>repmat(x, nrows, ncols = nrows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="repmat_+3A_x">x</code></td>
<td>
<p>original matrix</p>
</td></tr>
<tr><td><code id="repmat_+3A_nrows">nrows</code></td>
<td>
<p>number of times replicate matrix row wise</p>
</td></tr>
<tr><td><code id="repmat_+3A_ncols">ncols</code></td>
<td>
<p>number of times replicate matrix columns wise</p>
</td></tr>
</table>

<hr>
<h2 id='selectCompNum'>Select optimal number of components for a model</h2><span id='topic+selectCompNum'></span>

<h3>Description</h3>

<p>Generic function for selecting number of components for multivariate models (e.g. PCA, PLS, ...)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectCompNum(obj, ncomp = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selectCompNum_+3A_obj">obj</code></td>
<td>
<p>a model object</p>
</td></tr>
<tr><td><code id="selectCompNum_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to select</p>
</td></tr>
<tr><td><code id="selectCompNum_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='selectCompNum.pca'>Select optimal number of components for PCA model</h2><span id='topic+selectCompNum.pca'></span>

<h3>Description</h3>

<p>Allows user to select optimal number of components for a PCA model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
selectCompNum(obj, ncomp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selectCompNum.pca_+3A_obj">obj</code></td>
<td>
<p>PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="selectCompNum.pca_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to select</p>
</td></tr>
<tr><td><code id="selectCompNum.pca_+3A_...">...</code></td>
<td>
<p>other parameters if any</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the same model with selected number of components
</p>

<hr>
<h2 id='selectCompNum.pls'>Select optimal number of components for PLS model</h2><span id='topic+selectCompNum.pls'></span>

<h3>Description</h3>

<p>Allows user to select optimal number of components for PLS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
selectCompNum(obj, ncomp = NULL, selcrit = obj$ncomp.selcrit, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selectCompNum.pls_+3A_obj">obj</code></td>
<td>
<p>PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="selectCompNum.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to select</p>
</td></tr>
<tr><td><code id="selectCompNum.pls_+3A_selcrit">selcrit</code></td>
<td>
<p>criterion for selecting optimal number of components (<code>'min'</code> for
first local minimum of RMSECV and <code>'wold'</code> for Wold's rule.)</p>
</td></tr>
<tr><td><code id="selectCompNum.pls_+3A_...">...</code></td>
<td>
<p>other parameters if any</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method sets <code>ncomp.selected</code> parameter for the model and return it back. The parameter
points out to the optimal number of components in the model. You can either specify it manually,
as argument <code>ncomp</code>, or use one of the algorithms for automatic selection.
</p>
<p>Automatic selection by default based on cross-validation statistics. If no cross-validation
results are found in the model, the method will use test set validation results. If they are
not available as well, the model will use calibration results and give a warning as in this case
the selected number of components will lead to overfitted model.
</p>
<p>There are two algorithms for automatic selection you can chose between: either first local
minimum of RMSE (&lsquo;selcrit=&quot;min&quot;') or Wold&rsquo;s rule ('selcrit=&quot;wold&quot;').
</p>
<p>The first local minimum criterion finds at which component, A, error of prediction starts
raising and selects (A - 1) as the optimal number. The Wold's criterion finds which component A
does not make error smaller at least by 5
as the optimal number.
</p>
<p>If model is PLS2 model (has several response variables) the method computes optimal number of
components for each response and returns the smallest value. For example, if for the first
response 2 components give the smallest error and for the second response this number is 3,
A = 2 will be selected as a final result.
</p>
<p>It is not recommended to use automatic selection for real applications, always investigate
your model (via RMSE, Y-variance plot, regression coefficients) to make correct decision.
</p>
<p>See examples in help for <code><a href="#topic+pls">pls</a></code> function.
</p>


<h3>Value</h3>

<p>the same model with selected number of components
</p>

<hr>
<h2 id='selratio'>Selectivity ratio calculation</h2><span id='topic+selratio'></span>

<h3>Description</h3>

<p>Calculates selectivity ratio for each component and response variable in
the PLS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selratio(obj, ncomp = obj$ncomp.selected)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selratio_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="selratio_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to count</p>
</td></tr>
</table>


<h3>Value</h3>

<p>array <code>nvar x ncomp x ny</code> with selectivity ratio values
</p>


<h3>References</h3>

<p>[1] Tarja Rajalahti et al. Chemometrics and Laboratory Systems, 95 (2009), pp. 35-48.
</p>

<hr>
<h2 id='setDistanceLimits'>Set residual distance limits</h2><span id='topic+setDistanceLimits'></span>

<h3>Description</h3>

<p>Calculates and set critical limits for residuals of PCA model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setDistanceLimits(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setDistanceLimits_+3A_obj">obj</code></td>
<td>
<p>a model object</p>
</td></tr>
<tr><td><code id="setDistanceLimits_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='setDistanceLimits.pca'>Compute and set statistical limits for Q and T2 residual distances.</h2><span id='topic+setDistanceLimits.pca'></span>

<h3>Description</h3>

<p>Computes statisticsl limits for orthogonal and score distances (based on calibration set)
and assign the calculated values as model properties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
setDistanceLimits(
  obj,
  lim.type = obj$lim.type,
  alpha = obj$alpha,
  gamma = obj$gamma,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setDistanceLimits.pca_+3A_obj">obj</code></td>
<td>
<p>object with PCA model</p>
</td></tr>
<tr><td><code id="setDistanceLimits.pca_+3A_lim.type">lim.type</code></td>
<td>
<p>type of limits (&quot;jm&quot;, &quot;chisq&quot;, &quot;ddmoments&quot;, &quot;ddrobust&quot;)</p>
</td></tr>
<tr><td><code id="setDistanceLimits.pca_+3A_alpha">alpha</code></td>
<td>
<p>significance level for detection of extreme objects</p>
</td></tr>
<tr><td><code id="setDistanceLimits.pca_+3A_gamma">gamma</code></td>
<td>
<p>significance level for detection of outliers (for data driven approach)</p>
</td></tr>
<tr><td><code id="setDistanceLimits.pca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The limits can be accessed as fields of model objects: <code>$Qlim</code> and <code>$T2lim</code>. Each
is a matrix with four rows and <code>ncomp</code> columns. First row contains critical limits for
extremes, second row - for outliers, third row contains mean value for corresponding distance
(or its robust estimate in case of <code>lim.type = "ddrobust"</code>) and last row contains the
degrees of freedom.
</p>


<h3>Value</h3>

<p>Object models with the two fields updated.
</p>

<hr>
<h2 id='setDistanceLimits.pls'>Compute and set statistical limits for residual distances.</h2><span id='topic+setDistanceLimits.pls'></span>

<h3>Description</h3>

<p>Computes statisticsl limits for orthogonal and score distances (x-decomposition) and
orthogonal distance (y-decomposition) based on calibration set and assign the calculated
values as model properties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
setDistanceLimits(
  obj,
  lim.type = obj$lim.type,
  alpha = obj$alpha,
  gamma = obj$gamma,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setDistanceLimits.pls_+3A_obj">obj</code></td>
<td>
<p>object with PLS model</p>
</td></tr>
<tr><td><code id="setDistanceLimits.pls_+3A_lim.type">lim.type</code></td>
<td>
<p>type of limits (&quot;jm&quot;, &quot;chisq&quot;, &quot;ddmoments&quot;, &quot;ddrobust&quot;)</p>
</td></tr>
<tr><td><code id="setDistanceLimits.pls_+3A_alpha">alpha</code></td>
<td>
<p>significance level for detection of extreme objects</p>
</td></tr>
<tr><td><code id="setDistanceLimits.pls_+3A_gamma">gamma</code></td>
<td>
<p>significance level for detection of outliers (for data driven approach)</p>
</td></tr>
<tr><td><code id="setDistanceLimits.pls_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The limits can be accessed as fields of model objects: <code>$Qlim</code>, <code>$T2lim</code>, and
<code>$Zlim</code>. Each is a matrix with four rows and <code>ncomp</code> columns. In case of limits
for x-decomposition, first row contains critical limits for extremes, second row - for outliers,
third row contains mean value for corresponding distances (or its robust estimate in case of
<code>lim.type = "ddrobust"</code>) and last row contains the degrees of freedom.
</p>


<h3>Value</h3>

<p>Object models with the three fields updated.
</p>

<hr>
<h2 id='showDistanceLimits'>Show residual distance limits</h2><span id='topic+showDistanceLimits'></span>

<h3>Description</h3>

<p>Calculates and set critical limits for residuals of PCA model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showDistanceLimits(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showDistanceLimits_+3A_obj">obj</code></td>
<td>
<p>a model object</p>
</td></tr>
<tr><td><code id="showDistanceLimits_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='showLabels'>Show labels on plot</h2><span id='topic+showLabels'></span>

<h3>Description</h3>

<p>Show labels on plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showLabels(
  ps,
  show.excluded = FALSE,
  pos = 3,
  cex = 0.65,
  col = "darkgray",
  force.x.values = NULL,
  bwd = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showLabels_+3A_ps">ps</code></td>
<td>
<p>'plotseries' object</p>
</td></tr>
<tr><td><code id="showLabels_+3A_show.excluded">show.excluded</code></td>
<td>
<p>logical, are excluded rows also shown on the plot</p>
</td></tr>
<tr><td><code id="showLabels_+3A_pos">pos</code></td>
<td>
<p>position of the labels relative to the data points</p>
</td></tr>
<tr><td><code id="showLabels_+3A_cex">cex</code></td>
<td>
<p>size of the labels text</p>
</td></tr>
<tr><td><code id="showLabels_+3A_col">col</code></td>
<td>
<p>color of the labels text</p>
</td></tr>
<tr><td><code id="showLabels_+3A_force.x.values">force.x.values</code></td>
<td>
<p>vector with forced x-values (or NULL)</p>
</td></tr>
<tr><td><code id="showLabels_+3A_bwd">bwd</code></td>
<td>
<p>bar width in case of bar plot</p>
</td></tr>
</table>

<hr>
<h2 id='showPredictions'>Predictions</h2><span id='topic+showPredictions'></span>

<h3>Description</h3>

<p>Predictions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showPredictions(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showPredictions_+3A_obj">obj</code></td>
<td>
<p>a model or result object</p>
</td></tr>
<tr><td><code id="showPredictions_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generic function for showing predicted values for classification or regression model or results
</p>

<hr>
<h2 id='showPredictions.classres'>Show predicted class values</h2><span id='topic+showPredictions.classres'></span>

<h3>Description</h3>

<p>Shows a table with predicted class values for classification result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
showPredictions(obj, ncomp = obj$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showPredictions.classres_+3A_obj">obj</code></td>
<td>
<p>object with classification results (e.g. <code>plsdares</code> or <code>simcamres</code>).</p>
</td></tr>
<tr><td><code id="showPredictions.classres_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to show the predictions for (NULL - use selected for a model).</p>
</td></tr>
<tr><td><code id="showPredictions.classres_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints a matrix where every column is a class and every row is an data object.
The matrix has either -1 (does not belong to the class) or +1 (belongs to the class) values.
</p>

<hr>
<h2 id='simca'>SIMCA one-class classification</h2><span id='topic+simca'></span>

<h3>Description</h3>

<p><code>simca</code> is used to make SIMCA (Soft Independent Modelling of Class Analogies) model for
one-class classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simca(
  x,
  classname,
  ncomp = min(nrow(x) - 1, ncol(x) - 1, 20),
  x.test = NULL,
  c.test = NULL,
  cv = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simca_+3A_x">x</code></td>
<td>
<p>a numerical matrix with data values.</p>
</td></tr>
<tr><td><code id="simca_+3A_classname">classname</code></td>
<td>
<p>short text (up to 20 symbols) with class name.</p>
</td></tr>
<tr><td><code id="simca_+3A_ncomp">ncomp</code></td>
<td>
<p>maximum number of components to calculate.</p>
</td></tr>
<tr><td><code id="simca_+3A_x.test">x.test</code></td>
<td>
<p>a numerical matrix with test data.</p>
</td></tr>
<tr><td><code id="simca_+3A_c.test">c.test</code></td>
<td>
<p>a vector with classes of test data objects (can be text with names of classes or logical).</p>
</td></tr>
<tr><td><code id="simca_+3A_cv">cv</code></td>
<td>
<p>cross-validation settings (see details).</p>
</td></tr>
<tr><td><code id="simca_+3A_...">...</code></td>
<td>
<p>any other parameters suitable for <code><a href="#topic+pca">pca</a></code> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>SIMCA is in fact PCA model with additional functionality, so <code>simca</code> class inherits most
of the functionality of <code><a href="#topic+pca">pca</a></code> class. It uses critical limits calculated for Q and T2
residuals calculated for PCA model for making classification decistion.
</p>
<p>Cross-validation settings, <code>cv</code>, can be a number or a list. If <code>cv</code> is a number, it
will be used as a number of segments for random cross-validation (if <code>cv = 1</code>, full
cross-validation will be preformed). If it is a list, the following syntax can be used:
<code>cv = list('rand', nseg, nrep)</code> for random repeated cross-validation with <code>nseg</code>
segments and <code>nrep</code> repetitions or <code>cv = list('ven', nseg)</code> for systematic splits
to <code>nseg</code> segments ('venetian blinds').
</p>


<h3>Value</h3>

<p>Returns an object of <code>simca</code> class with following fields:
</p>
<table>
<tr><td><code>classname</code></td>
<td>
<p>a short text with class name.</p>
</td></tr>
<tr><td><code>calres</code></td>
<td>
<p>an object of class <code><a href="#topic+simcares">simcares</a></code> with classification results for a
calibration data.</p>
</td></tr>
<tr><td><code>testres</code></td>
<td>
<p>an object of class <code><a href="#topic+simcares">simcares</a></code> with classification results for a test
data, if it was provided.</p>
</td></tr>
<tr><td><code>cvres</code></td>
<td>
<p>an object of class <code><a href="#topic+simcares">simcares</a></code> with classification results for
cross-validation, if this option was chosen.</p>
</td></tr>
</table>
<p>Fields, inherited from <code><a href="#topic+pca">pca</a></code> class:
</p>
<table>
<tr><td><code>ncomp</code></td>
<td>
<p>number of components included to the model.</p>
</td></tr>
<tr><td><code>ncomp.selected</code></td>
<td>
<p>selected (optimal) number of components.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>matrix with loading values (nvar x ncomp).</p>
</td></tr>
<tr><td><code>eigenvals</code></td>
<td>
<p>vector with eigenvalues for all existent components.</p>
</td></tr>
<tr><td><code>expvar</code></td>
<td>
<p>vector with explained variance for each component (in percent).</p>
</td></tr>
<tr><td><code>cumexpvar</code></td>
<td>
<p>vector with cumulative explained variance for each component (in percent).</p>
</td></tr>
<tr><td><code>T2lim</code></td>
<td>
<p>statistical limit for T2 distance.</p>
</td></tr>
<tr><td><code>Qlim</code></td>
<td>
<p>statistical limit for Q residuals.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information about the model, provided by user when build the model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sergey Kucheryavskiy (svkucheryavski@gmail.com)
</p>


<h3>References</h3>

<p>S. Wold, M. Sjostrom. &quot;SIMCA: A method for analyzing chemical data in terms of similarity and
analogy&quot; in B.R. Kowalski (ed.), Chemometrics Theory and Application, American Chemical Society
Symposium Series 52, Wash., D.C., American Chemical Society, p. 243-282.
</p>


<h3>See Also</h3>

<p>Methods for <code>simca</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print.simca</code> </td><td style="text-align: left;"> shows information about the object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>summary.simca</code> </td><td style="text-align: left;"> shows summary statistics for the model.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>plot.simca</code> </td><td style="text-align: left;"> makes an overview of SIMCA model with four plots.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+predict.simca">predict.simca</a></code> </td><td style="text-align: left;"> applies SIMCA model to a new data.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code>classmodel</code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPredictions.classmodel">plotPredictions.classmodel</a></code> </td><td style="text-align: left;"> shows plot with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSensitivity.classmodel">plotSensitivity.classmodel</a></code> </td><td style="text-align: left;"> shows sensitivity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSpecificity.classmodel">plotSpecificity.classmodel</a></code> </td><td style="text-align: left;"> shows specificity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotMisclassified.classmodel">plotMisclassified.classmodel</a></code> </td><td style="text-align: left;"> shows misclassified ratio plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code><a href="#topic+pca">pca</a></code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+selectCompNum.pca">selectCompNum.pca</a></code> </td><td style="text-align: left;"> set number of optimal components in the model</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotScores.pca">plotScores.pca</a></code> </td><td style="text-align: left;"> shows scores plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotLoadings.pca">plotLoadings.pca</a></code> </td><td style="text-align: left;"> shows loadings plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotVariance.pca">plotVariance.pca</a></code> </td><td style="text-align: left;"> shows explained variance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotCumVariance.pca">plotCumVariance.pca</a></code> </td><td style="text-align: left;"> shows cumulative explained variance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotResiduals.pca">plotResiduals.pca</a></code> </td><td style="text-align: left;"> shows Q vs. T2 residuals plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>## make a SIMCA model for Iris setosa class with full cross-validation
library(mdatools)

data = iris[, 1:4]
class = iris[, 5]

# take first 20 objects of setosa as calibration set
se = data[1:20, ]

# make SIMCA model and apply to test set
model = simca(se, "setosa", cv = 1)
model = selectCompNum(model, 1)

# show infromation, summary and plot overview
print(model)
summary(model)
plot(model)

# show predictions
par(mfrow = c(2, 1))
plotPredictions(model, show.labels = TRUE)
plotPredictions(model, res = "cal", ncomp = 2, show.labels = TRUE)
par(mfrow = c(1, 1))

# show performance, modelling power and residuals for ncomp = 2
par(mfrow = c(2, 2))
plotSensitivity(model)
plotMisclassified(model)
plotLoadings(model, comp = c(1, 2), show.labels = TRUE)
plotResiduals(model, ncomp = 2)
par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='simcam'>SIMCA multiclass classification</h2><span id='topic+simcam'></span>

<h3>Description</h3>

<p><code>simcam</code> is used to combine several one-class SIMCA models for multiclass classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcam(models, info = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcam_+3A_models">models</code></td>
<td>
<p>list with SIMCA models (<code>simca</code> objects).</p>
</td></tr>
<tr><td><code id="simcam_+3A_info">info</code></td>
<td>
<p>optional text with information about the the object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Besides the possibility for multiclass classification, SIMCAM also provides tools for
investigation of relationship among individual models (classes), such as discrimination power of
variables, Cooman's plot, model distance, etc.
</p>
<p>When create <code>simcam</code> object, the calibration data from all individual SIMCA models is
extracted and combined for making predictions and calculate performance of the multi-class model.
The results are stored in <code>$calres</code> field of the model object.
</p>


<h3>Value</h3>

<p>Returns an object of <code>simcam</code> class with following fields:
</p>
<table>
<tr><td><code>models</code></td>
<td>
<p>a list with provided SIMCA models.</p>
</td></tr>
<tr><td><code>dispower</code></td>
<td>
<p>an array with discrimination power of variables for each pair of individual
models.</p>
</td></tr>
<tr><td><code>moddist</code></td>
<td>
<p>a matrix with distance between each each pair of individual models.</p>
</td></tr>
<tr><td><code>classnames</code></td>
<td>
<p>vector with names of individual classes.</p>
</td></tr>
<tr><td><code>nclasses</code></td>
<td>
<p>number of classes in the object.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>information provided by user when create the object.</p>
</td></tr>
<tr><td><code>calres</code></td>
<td>
<p>an object of class <code><a href="#topic+simcamres">simcamres</a></code> with classification results for a
calibration data.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Methods for <code>simca</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print.simcam</code> </td><td style="text-align: left;"> shows information about the object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>summary.simcam</code> </td><td style="text-align: left;"> shows summary statistics for the models.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>plot.simcam</code> </td><td style="text-align: left;"> makes an overview of SIMCAM model with two plots.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+predict.simcam">predict.simcam</a></code> </td><td style="text-align: left;"> applies SIMCAM model to a new data.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotModelDistance.simcam">plotModelDistance.simcam</a></code> </td><td style="text-align: left;"> shows plot with distance between individual
 models.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotDiscriminationPower.simcam">plotDiscriminationPower.simcam</a></code> </td><td style="text-align: left;"> shows plot with discrimination power.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotCooman.simcam">plotCooman.simcam</a></code> </td><td style="text-align: left;"> shows Cooman's plot for calibration data.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code>classmodel</code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPredictions.classmodel">plotPredictions.classmodel</a></code> </td><td style="text-align: left;"> shows plot with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSensitivity.classmodel">plotSensitivity.classmodel</a></code> </td><td style="text-align: left;"> shows sensitivity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSpecificity.classmodel">plotSpecificity.classmodel</a></code> </td><td style="text-align: left;"> shows specificity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotMisclassified.classmodel">plotMisclassified.classmodel</a></code> </td><td style="text-align: left;"> shows misclassified ratio plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Since SIMCAM objects and results are calculated only for optimal number of components, there is
no sense to show such plots like sensitivity or specificity vs. number of components. However
they are available as for any other classification model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## make a multiclass SIMCA model for Iris data
library(mdatools)

# split data
caldata = iris[seq(1, nrow(iris), 2), 1:4]
x.se = caldata[1:25, ]
x.ve = caldata[26:50, ]
x.vi = caldata[51:75, ]

x.test = iris[seq(2, nrow(iris), 2), 1:4]
c.test = iris[seq(2, nrow(iris), 2), 5]

# create individual models
m.se = simca(x.se, classname = "setosa")
m.se = selectCompNum(m.se, 1)

m.vi = simca(x.vi, classname = "virginica")
m.vi = selectCompNum(m.vi, 2)

m.ve = simca(x.ve, classname = "versicolor")
m.ve = selectCompNum(m.ve, 1)

# combine models into SIMCAM objects, show statistics and plots
m = simcam(list(m.se, m.vi, m.ve), info = "simcam model for Iris data")
summary(m)

# show predictions and residuals for calibration data
par(mfrow = c(2, 2))
plotPredictions(m)
plotCooman(m, nc = c(1, 2))
plotModelDistance(m, nc = 1)
plotDiscriminationPower(m, nc = c(1, 2))
par(mfrow = c(1, 1))

# apply the SIMCAM model to test set and show statistics and plots
res = predict(m, x.test, c.test)
summary(res)
plotPredictions(res)

</code></pre>

<hr>
<h2 id='simcam.getPerformanceStats'>Performance statistics for SIMCAM model</h2><span id='topic+simcam.getPerformanceStats'></span>

<h3>Description</h3>

<p>Calculates discrimination power and distance between individual SIMCA models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcam.getPerformanceStats(models, classnames)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcam.getPerformanceStats_+3A_models">models</code></td>
<td>
<p>list with SIMCA models (as provided to simcam class)</p>
</td></tr>
<tr><td><code id="simcam.getPerformanceStats_+3A_classnames">classnames</code></td>
<td>
<p>names of the classes for each model</p>
</td></tr>
</table>

<hr>
<h2 id='simcamres'>Results of SIMCA multiclass classification</h2><span id='topic+simcamres'></span>

<h3>Description</h3>

<p><code>simcamres</code> is used to store results for SIMCA multiclass classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcamres(cres, pred.res)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcamres_+3A_cres">cres</code></td>
<td>
<p>results of classification (class <code>classres</code>).</p>
</td></tr>
<tr><td><code id="simcamres_+3A_pred.res">pred.res</code></td>
<td>
<p>list with prediction results from each model (pcares objects)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Class <code>simcamres</code> inherits all properties and methods of class <code><a href="#topic+classres">classres</a></code>, plus
store values necessary to visualise prediction decisions (e.g. Cooman's plot or Residuals plot).
</p>
<p>In cotrast to <code>simcares</code> here only values for optimal (selected) number of components in
each individual SIMCA models are presented.
</p>
<p>There is no need to create a <code>simcamres</code> object manually, it is created automatically when
make a SIMCAM model (see <code><a href="#topic+simcam">simcam</a></code>) or apply the model to a new data (see
<code><a href="#topic+predict.simcam">predict.simcam</a></code>). The object can be used to show summary and plots for the results.
</p>


<h3>Value</h3>

<p>Returns an object (list) of class <code>simcamres</code> with the same fields as <code><a href="#topic+classres">classres</a></code>
plus extra fields for Q and T2 values and limits:
</p>
<table>
<tr><td><code>c.pred</code></td>
<td>
<p>predicted class values.</p>
</td></tr>
<tr><td><code>c.ref</code></td>
<td>
<p>reference (true) class values if provided.</p>
</td></tr>
<tr><td><code>T2</code></td>
<td>
<p>matrix with T2 values for each object and class.</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>matrix with Q values for each object and class.</p>
</td></tr>
<tr><td><code>T2lim</code></td>
<td>
<p>vector with T2 statistical limits for each class.</p>
</td></tr>
<tr><td><code>Qlim</code></td>
<td>
<p>vector with Q statistical limits for each class.</p>
</td></tr>
</table>
<p>The following fields are available only if reference values were provided.
</p>
<table>
<tr><td><code>tp</code></td>
<td>
<p>number of true positives.</p>
</td></tr>
<tr><td><code>fp</code></td>
<td>
<p>nmber of false positives.</p>
</td></tr>
<tr><td><code>fn</code></td>
<td>
<p>number of false negatives.</p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p>specificity of predictions.</p>
</td></tr>
<tr><td><code>sensitivity</code></td>
<td>
<p>sensitivity of predictions.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Methods for <code>simcamres</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print.simcamres</code> </td><td style="text-align: left;"> shows information about the object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>summary.simcamres</code> </td><td style="text-align: left;"> shows statistics for results of classification.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotCooman.simcamres">plotCooman.simcamres</a></code> </td><td style="text-align: left;"> makes Cooman's plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code><a href="#topic+classres">classres</a></code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+showPredictions.classres">showPredictions.classres</a></code> </td><td style="text-align: left;"> show table with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPredictions.classres">plotPredictions.classres</a></code> </td><td style="text-align: left;"> makes plot with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Check also <code><a href="#topic+simcam">simcam</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see examples for simcam method.

</code></pre>

<hr>
<h2 id='simcares'>Results of SIMCA one-class classification</h2><span id='topic+simcares'></span>

<h3>Description</h3>

<p>@description
<code>simcares</code> is used to store results for SIMCA one-class classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcares(class.res, pca.res = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcares_+3A_class.res">class.res</code></td>
<td>
<p>results of classification (class <code>classres</code>).</p>
</td></tr>
<tr><td><code id="simcares_+3A_pca.res">pca.res</code></td>
<td>
<p>results of PCA decomposition of data (class <code>pcares</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Class <code>simcares</code> inherits all properties and methods of class <code><a href="#topic+pcares">pcares</a></code>, and
has additional properties and functions for representing of classification results, inherited
from class <code><a href="#topic+classres">classres</a></code>.
</p>
<p>There is no need to create a <code>simcares</code> object manually, it is created automatically when
build a SIMCA model (see <code><a href="#topic+simca">simca</a></code>) or apply the model to a new data (see
<code><a href="#topic+predict.simca">predict.simca</a></code>). The object can be used to show summary and plots for the results.
</p>


<h3>Value</h3>

<p>Returns an object (list) of class <code>simcares</code> with the same fields as <code><a href="#topic+pcares">pcares</a></code>
plus extra fields, inherited from <code><a href="#topic+classres">classres</a></code>:
</p>
<table>
<tr><td><code>c.pred</code></td>
<td>
<p>predicted class values (+1 or -1).</p>
</td></tr>
<tr><td><code>c.ref</code></td>
<td>
<p>reference (true) class values if provided.</p>
</td></tr>
</table>
<p>The following fields are available only if reference values were provided.
</p>
<table>
<tr><td><code>tp</code></td>
<td>
<p>number of true positives.</p>
</td></tr>
<tr><td><code>fp</code></td>
<td>
<p>nmber of false positives.</p>
</td></tr>
<tr><td><code>fn</code></td>
<td>
<p>number of false negatives.</p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p>specificity of predictions.</p>
</td></tr>
<tr><td><code>sensitivity</code></td>
<td>
<p>sensitivity of predictions.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Methods for <code>simcares</code> objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>print.simcares</code> </td><td style="text-align: left;"> shows information about the object.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>summary.simcares</code> </td><td style="text-align: left;"> shows statistics for results of classification.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code><a href="#topic+classres">classres</a></code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+showPredictions.classres">showPredictions.classres</a></code> </td><td style="text-align: left;"> show table with predicted values.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPredictions.classres">plotPredictions.classres</a></code> </td><td style="text-align: left;"> predicted classes plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSensitivity.classres">plotSensitivity.classres</a></code> </td><td style="text-align: left;"> sensitivity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotSpecificity.classres">plotSpecificity.classres</a></code> </td><td style="text-align: left;"> specificity plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotPerformance.classres">plotPerformance.classres</a></code> </td><td style="text-align: left;"> performance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Methods, inherited from <code><a href="#topic+ldecomp">ldecomp</a></code> class:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotResiduals.ldecomp">plotResiduals.ldecomp</a></code> </td><td style="text-align: left;"> makes Q2 vs. T2 residuals plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotScores.ldecomp">plotScores.ldecomp</a></code> </td><td style="text-align: left;"> makes scores plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotVariance.ldecomp">plotVariance.ldecomp</a></code> </td><td style="text-align: left;"> makes explained variance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code><a href="#topic+plotCumVariance.ldecomp">plotCumVariance.ldecomp</a></code> </td><td style="text-align: left;"> makes cumulative explained variance plot.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Check also <code><a href="#topic+simca">simca</a></code> and <code><a href="#topic+pcares">pcares</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## make a SIMCA model for Iris setosa class and show results for calibration set
library(mdatools)

data = iris[, 1:4]
class = iris[, 5]

# take first 30 objects of setosa as calibration set
se = data[1:30, ]

# make SIMCA model and apply to test set
model = simca(se, 'Se')
model = selectCompNum(model, 1)

# show infromation and summary
print(model$calres)
summary(model$calres)

# show plots
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))
plotPredictions(model$calres, show.labels = TRUE)
plotResiduals(model$calres, show.labels = TRUE)
plotPerformance(model$calres, show.labels = TRUE, legend.position = 'bottomright')
layout(1, 1, 1)

# show predictions table
showPredictions(model$calres)
</code></pre>

<hr>
<h2 id='simdata'>
Spectral data of polyaromatic hydrocarbons mixing
</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>Simdata contains training and test set with spectra and concentration values of polyaromatic hydrocarbons mixings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdata)</code></pre>


<h3>Format</h3>

<p>The data is a list with following fields:
</p>

<table>
<tr>
 <td style="text-align: right;">
    <code>$spectra.c</code> </td><td style="text-align: left;"> a matrix (100x150) with spectral values for the training set. </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>$spectra.t</code> </td><td style="text-align: left;"> a matrix (100x150) with spectral values for the test set. </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>$conc.c</code> </td><td style="text-align: left;"> a matrix (100x3) with concentration of components for the training set. </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>$conc.t</code> </td><td style="text-align: left;"> a matrix (100x3) with concentration of components for the test set. </td>
</tr>
<tr>
 <td style="text-align: right;">
    <code>$wavelength</code> </td><td style="text-align: left;"> a vector with spectra wavelength in nm. </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>This is a simulated data containing UV/Vis spectra of three component (polyaromatic hydrocarbons) mixings - C1, C2 and C3. The spectral range is betwen 210 and 360 nm. The spectra were simulated as a linear combination of pure component spectra plus 5% of random noise. The concentration range is (in moles): C1 [0, 1], C2 [0, 0.5], C3 [0, 0.1].
</p>
<p>There are 100 mixings in a training set and 50 mixings in a test set. The data can be used for multivariate regression examples.
</p>

<hr>
<h2 id='splitExcludedData'>Split the excluded part of data</h2><span id='topic+splitExcludedData'></span>

<h3>Description</h3>

<p>Split the excluded part of data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitExcludedData(data, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitExcludedData_+3A_data">data</code></td>
<td>
<p>matrix with hidden data values</p>
</td></tr>
<tr><td><code id="splitExcludedData_+3A_type">type</code></td>
<td>
<p>type of plot</p>
</td></tr>
</table>

<hr>
<h2 id='splitPlotData'>Split dataset to x and y values depending on plot type</h2><span id='topic+splitPlotData'></span>

<h3>Description</h3>

<p>Split dataset to x and y values depending on plot type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitPlotData(data, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitPlotData_+3A_data">data</code></td>
<td>
<p>matrix with data values (visible or hidden)</p>
</td></tr>
<tr><td><code id="splitPlotData_+3A_type">type</code></td>
<td>
<p>type of plot</p>
</td></tr>
</table>

<hr>
<h2 id='summary.classres'>Summary statistics about classification result object</h2><span id='topic+summary.classres'></span>

<h3>Description</h3>

<p>Generic <code>summary</code> function for classification results. Prints performance values for the
results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'classres'
summary(
  object,
  ncomp = object$ncomp.selected,
  nc = seq_len(object$nclasses),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.classres_+3A_object">object</code></td>
<td>
<p>classification results (object of class <code>plsdares</code>, <code>simcamres</code>, etc.).</p>
</td></tr>
<tr><td><code id="summary.classres_+3A_ncomp">ncomp</code></td>
<td>
<p>which number of components to make the plot for (use NULL to show results for all available).</p>
</td></tr>
<tr><td><code id="summary.classres_+3A_nc">nc</code></td>
<td>
<p>vector with class numbers to show the summary for.</p>
</td></tr>
<tr><td><code id="summary.classres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.ipls'>Summary for iPLS results</h2><span id='topic+summary.ipls'></span>

<h3>Description</h3>

<p>Shows statistics and algorithm parameters for iPLS results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipls'
summary(object, glob.ncomp = object$gm$ncomp.selected, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ipls_+3A_object">object</code></td>
<td>
<p>a iPLS (object of class <code>ipls</code>).</p>
</td></tr>
<tr><td><code id="summary.ipls_+3A_glob.ncomp">glob.ncomp</code></td>
<td>
<p>number of components for global PLS model with all intervals.</p>
</td></tr>
<tr><td><code id="summary.ipls_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method shows information on the algorithm parameters as well as a table with selected or
excluded interval. The table has the following columns: 'step' showing on which iteration
an interval was selected or excluded, 'start and 'end' show variable indices for the interval,
'nComp' is a number of components used in a model, 'RMSE' is RMSECV for the model and 'R2' is
coefficient of determination for the same model.
</p>

<hr>
<h2 id='summary.ldecomp'>Summary statistics for linear decomposition</h2><span id='topic+summary.ldecomp'></span>

<h3>Description</h3>

<p>Generic <code>summary</code> function for linear decomposition. Prints statistic about
the decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ldecomp'
summary(object, str = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ldecomp_+3A_object">object</code></td>
<td>
<p>object of class <code>ldecomp</code></p>
</td></tr>
<tr><td><code id="summary.ldecomp_+3A_str">str</code></td>
<td>
<p>user specified text to show as a description of the object</p>
</td></tr>
<tr><td><code id="summary.ldecomp_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.mcrals'>Summary method for mcrals object</h2><span id='topic+summary.mcrals'></span>

<h3>Description</h3>

<p>Shows some statistics (explained variance, etc) for the case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcrals'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mcrals_+3A_object">object</code></td>
<td>
<p><code>mcrals</code> object</p>
</td></tr>
<tr><td><code id="summary.mcrals_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.mcrpure'>Summary method for mcrpure object</h2><span id='topic+summary.mcrpure'></span>

<h3>Description</h3>

<p>Shows some statistics (explained variance, etc) for the case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcrpure'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mcrpure_+3A_object">object</code></td>
<td>
<p><code>mcrpure</code> object</p>
</td></tr>
<tr><td><code id="summary.mcrpure_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.pca'>Summary method for PCA model object</h2><span id='topic+summary.pca'></span>

<h3>Description</h3>

<p>Shows some statistics (explained variance, eigenvalues) for the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pca'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.pca_+3A_object">object</code></td>
<td>
<p>a PCA model (object of class <code>pca</code>)</p>
</td></tr>
<tr><td><code id="summary.pca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.pcares'>Summary method for PCA results object</h2><span id='topic+summary.pcares'></span>

<h3>Description</h3>

<p>Shows some statistics (explained variance, eigenvalues) about the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcares'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.pcares_+3A_object">object</code></td>
<td>
<p>PCA results (object of class <code>pcares</code>)</p>
</td></tr>
<tr><td><code id="summary.pcares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.pls'>Summary method for PLS model object</h2><span id='topic+summary.pls'></span>

<h3>Description</h3>

<p>Shows performance statistics for the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pls'
summary(
  object,
  ncomp = object$ncomp.selected,
  ny = seq_len(nrow(object$yloadings)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.pls_+3A_object">object</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="summary.pls_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to count.</p>
</td></tr>
<tr><td><code id="summary.pls_+3A_ny">ny</code></td>
<td>
<p>which y variables to show the summary for (can be a vector)</p>
</td></tr>
<tr><td><code id="summary.pls_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.plsda'>Summary method for PLS-DA model object</h2><span id='topic+summary.plsda'></span>

<h3>Description</h3>

<p>Shows some statistics for the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsda'
summary(
  object,
  ncomp = object$ncomp.selected,
  nc = seq_len(object$nclasses),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.plsda_+3A_object">object</code></td>
<td>
<p>a PLS-DA model (object of class <code>plsda</code>)</p>
</td></tr>
<tr><td><code id="summary.plsda_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="summary.plsda_+3A_nc">nc</code></td>
<td>
<p>which class to show the summary for (if NULL, will be shown for all)</p>
</td></tr>
<tr><td><code id="summary.plsda_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.plsdares'>Summary method for PLS-DA results object</h2><span id='topic+summary.plsdares'></span>

<h3>Description</h3>

<p>Shows performance statistics for the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsdares'
summary(object, nc = seq_len(object$nclasses), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.plsdares_+3A_object">object</code></td>
<td>
<p>PLS-DA results (object of class <code>plsdares</code>)</p>
</td></tr>
<tr><td><code id="summary.plsdares_+3A_nc">nc</code></td>
<td>
<p>which class to show the summary for (if NULL, will be shown for all)</p>
</td></tr>
<tr><td><code id="summary.plsdares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.plsres'>summary method for PLS results object</h2><span id='topic+summary.plsres'></span>

<h3>Description</h3>

<p>Shows performance statistics for the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plsres'
summary(object, ny = seq_len(object$nresp), ncomp = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.plsres_+3A_object">object</code></td>
<td>
<p>PLS results (object of class <code>plsres</code>)</p>
</td></tr>
<tr><td><code id="summary.plsres_+3A_ny">ny</code></td>
<td>
<p>for which response variable show the summary for</p>
</td></tr>
<tr><td><code id="summary.plsres_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use (if NULL - user selected optimal value will be used)</p>
</td></tr>
<tr><td><code id="summary.plsres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.randtest'>Summary method for randtest object</h2><span id='topic+summary.randtest'></span>

<h3>Description</h3>

<p>Shows summary for randomization test results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'randtest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.randtest_+3A_object">object</code></td>
<td>
<p>randomization test results (object of class <code>randtest</code>)</p>
</td></tr>
<tr><td><code id="summary.randtest_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.regcoeffs'>Summary method for regcoeffs object</h2><span id='topic+summary.regcoeffs'></span>

<h3>Description</h3>

<p>Shows estimated coefficients and statistics (if available).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regcoeffs'
summary(object, ncomp = 1, ny = 1, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.regcoeffs_+3A_object">object</code></td>
<td>
<p>object of class <code>regcoeffs</code></p>
</td></tr>
<tr><td><code id="summary.regcoeffs_+3A_ncomp">ncomp</code></td>
<td>
<p>how many components to use</p>
</td></tr>
<tr><td><code id="summary.regcoeffs_+3A_ny">ny</code></td>
<td>
<p>which y variable to show the summary for</p>
</td></tr>
<tr><td><code id="summary.regcoeffs_+3A_alpha">alpha</code></td>
<td>
<p>significance level for confidence interval (if statistics available)</p>
</td></tr>
<tr><td><code id="summary.regcoeffs_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Statistcs are shown if Jack-Knifing was used when model is calibrated.
</p>

<hr>
<h2 id='summary.regmodel'>Summary method for regression model object</h2><span id='topic+summary.regmodel'></span>

<h3>Description</h3>

<p>Shows performance statistics for the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmodel'
summary(
  object,
  ncomp = object$ncomp.selected,
  ny = seq_len(object$res$cal$nresp),
  res = object$res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.regmodel_+3A_object">object</code></td>
<td>
<p>a regression model (object of class <code>regmodel</code>)</p>
</td></tr>
<tr><td><code id="summary.regmodel_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to show summary for</p>
</td></tr>
<tr><td><code id="summary.regmodel_+3A_ny">ny</code></td>
<td>
<p>which y variables to show the summary for (can be a vector)</p>
</td></tr>
<tr><td><code id="summary.regmodel_+3A_res">res</code></td>
<td>
<p>list of results to show summary for</p>
</td></tr>
<tr><td><code id="summary.regmodel_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.regres'>summary method for regression results object</h2><span id='topic+summary.regres'></span>

<h3>Description</h3>

<p>Shows performance statistics for the regression results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regres'
summary(object, ncomp = object$ncomp.selected, ny = seq_len(object$nresp), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.regres_+3A_object">object</code></td>
<td>
<p>regression results (object of class <code>regres</code>)</p>
</td></tr>
<tr><td><code id="summary.regres_+3A_ncomp">ncomp</code></td>
<td>
<p>model complexity to show the summary for (if NULL - shows for all available values)</p>
</td></tr>
<tr><td><code id="summary.regres_+3A_ny">ny</code></td>
<td>
<p>for which response variable show the summary for (one value or a vector)</p>
</td></tr>
<tr><td><code id="summary.regres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.simca'>Summary method for SIMCA model object</h2><span id='topic+summary.simca'></span>

<h3>Description</h3>

<p>Shows performance statistics for the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simca'
summary(object, ncomp = object$ncomp.selected, res = object$res, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.simca_+3A_object">object</code></td>
<td>
<p>a SIMCA model (object of class <code>simca</code>)</p>
</td></tr>
<tr><td><code id="summary.simca_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to show summary for</p>
</td></tr>
<tr><td><code id="summary.simca_+3A_res">res</code></td>
<td>
<p>list of result objects to show summary for</p>
</td></tr>
<tr><td><code id="summary.simca_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.simcam'>Summary method for SIMCAM model object</h2><span id='topic+summary.simcam'></span>

<h3>Description</h3>

<p>Shows performance statistics for the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcam'
summary(object, nc = seq_len(object$nclasses), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.simcam_+3A_object">object</code></td>
<td>
<p>a SIMCAM model (object of class <code>simcam</code>)</p>
</td></tr>
<tr><td><code id="summary.simcam_+3A_nc">nc</code></td>
<td>
<p>number of class to show summary for (can be vector)</p>
</td></tr>
<tr><td><code id="summary.simcam_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.simcamres'>Summary method for SIMCAM results object</h2><span id='topic+summary.simcamres'></span>

<h3>Description</h3>

<p>Shows performance statistics for the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcamres'
summary(object, nc = seq_len(object$nclasses), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.simcamres_+3A_object">object</code></td>
<td>
<p>SIMCAM results (object of class <code>simcamres</code>)</p>
</td></tr>
<tr><td><code id="summary.simcamres_+3A_nc">nc</code></td>
<td>
<p>number of class to show summary for (can be vector)</p>
</td></tr>
<tr><td><code id="summary.simcamres_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.simcares'>Summary method for SIMCA results object</h2><span id='topic+summary.simcares'></span>

<h3>Description</h3>

<p>Shows performance statistics for the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simcares'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.simcares_+3A_object">object</code></td>
<td>
<p>SIMCA results (object of class <code>simcares</code>)</p>
</td></tr>
<tr><td><code id="summary.simcares_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>

<hr>
<h2 id='unmix.mcrpure'>Unmix spectral data using pure variables estimated before</h2><span id='topic+unmix.mcrpure'></span>

<h3>Description</h3>

<p>Unmix spectral data using pure variables estimated before
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unmix.mcrpure(obj, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unmix.mcrpure_+3A_obj">obj</code></td>
<td>
<p><code>mcrpure</code> object</p>
</td></tr>
<tr><td><code id="unmix.mcrpure_+3A_x">x</code></td>
<td>
<p>matrix with spectra</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with resolved spectra and contributions (matrices).
</p>

<hr>
<h2 id='vipscores'>VIP scores for PLS model</h2><span id='topic+vipscores'></span>

<h3>Description</h3>

<p>Calculates VIP (Variable Importance in Projection) scores for predictors for given number
of components and response variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vipscores(obj, ncomp = obj$ncomp.selected)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vipscores_+3A_obj">obj</code></td>
<td>
<p>a PLS model (object of class <code>pls</code>)</p>
</td></tr>
<tr><td><code id="vipscores_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components to count</p>
</td></tr>
</table>


<h3>Details</h3>

<p>May take some time in case of large number of predictors Returns results as a column-vector,
with all necessary attributes inherited (e.g. xaxis.values, excluded variables, etc.). If you
want to make a plot use for example: <code>mdaplot(mda.t(v), type = "l")</code>, where <code>v</code> is
a vector with computed VIP scores. Or just try <code><a href="#topic+plotVIPScores.pls">plotVIPScores.pls</a></code>.
</p>


<h3>Value</h3>

<p>matrix <code>nvar x ny</code> with VIP score values (columns correspond to responses).
</p>


<h3>References</h3>

<p>[1] Il-Gyo Chong, Chi-Hyuck Jun. Chemometrics and Laboratory Systems, 78 (2005), pp. 103-112.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
