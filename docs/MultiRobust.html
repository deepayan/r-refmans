<!DOCTYPE html><html lang="en"><head><title>Help for package MultiRobust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiRobust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#glm.work'><p>Define a Generalized Linear Model</p></a></li>
<li><a href='#MR.mean'><p>Multiply Robust Estimation of the Marginal Mean</p></a></li>
<li><a href='#MR.quantile'><p>Multiply Robust Estimation of the Marginal Quantile</p></a></li>
<li><a href='#MR.quantreg'><p>Multiply Robust Estimation for Quantile Regression</p></a></li>
<li><a href='#MR.reg'><p>Multiply Robust Estimation for (Mean) Regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiply Robust Methods for Missing Data Problems</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Shixiao Zhang and Peisong Han</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shixiao Zhang &lt;praetere@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Multiply robust estimation for population mean (Han and Wang 2013) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fass087">doi:10.1093/biomet/ass087</a>&gt;, regression analysis (Han 2014) &lt;<a href="https://doi.org/10.1080%2F01621459.2014.880058">doi:10.1080/01621459.2014.880058</a>&gt; (Han 2016) &lt;<a href="https://doi.org/10.1111%2Fsjos.12177">doi:10.1111/sjos.12177</a>&gt; and quantile regression (Han et al. 2019) &lt;<a href="https://doi.org/10.1111%2Frssb.12309">doi:10.1111/rssb.12309</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, SuppDists, quantreg</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-19 20:40:11 UTC; Administrator</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-03 22:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='glm.work'>Define a Generalized Linear Model</h2><span id='topic+glm.work'></span>

<h3>Description</h3>

<p>Define a generalized linear model. All the arguments in <code><a href="stats.html#topic+glm">glm</a></code> are allowed except for <code>data</code>. Supported types of <code>family</code> include <code>gaussian</code>, <code>binomial</code>, <code>poisson</code>, <code>Gamma</code> and <code>inverse.gaussian</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm.work(formula, family = gaussian, weights = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glm.work_+3A_formula">formula</code></td>
<td>
<p>The formula of the model to be fitted.</p>
</td></tr>
<tr><td><code id="glm.work_+3A_family">family</code></td>
<td>
<p>The distribution of the response variable and the link function to be used in the model.</p>
</td></tr>
<tr><td><code id="glm.work_+3A_weights">weights</code></td>
<td>
<p>The prior weights to be used in the model.</p>
</td></tr>
<tr><td><code id="glm.work_+3A_...">...</code></td>
<td>
<p>Addition arguments for the function <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A logistic regression with response R and covariates X1 and X2
mis1 &lt;- glm.work(formula = R ~ X1 + X2, family = binomial(link = logit))
</code></pre>

<hr>
<h2 id='MR.mean'>Multiply Robust Estimation of the Marginal Mean</h2><span id='topic+MR.mean'></span>

<h3>Description</h3>

<p><code>MR.mean()</code> is used to estimate the marginal mean of a variable which is subject to missingness. Multiple missingness probability models and outcome regression models can be accommodated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MR.mean(response, reg.model = NULL, mis.model = NULL, moment = NULL,
  order = 1, data, bootstrap = FALSE, bootstrap.size = 300,
  alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MR.mean_+3A_response">response</code></td>
<td>
<p>The response variable of interest whose marginal mean is to be estimated.</p>
</td></tr>
<tr><td><code id="MR.mean_+3A_reg.model">reg.model</code></td>
<td>
<p>A list of outcome regression models defined by <code><a href="#topic+glm.work">glm.work</a></code>.</p>
</td></tr>
<tr><td><code id="MR.mean_+3A_mis.model">mis.model</code></td>
<td>
<p>A list of missingness probability models defined by <code><a href="#topic+glm.work">glm.work</a></code>. The dependent variable is always specified as <code>R</code>.</p>
</td></tr>
<tr><td><code id="MR.mean_+3A_moment">moment</code></td>
<td>
<p>A vector of auxiliary variables whose moments are to be calibrated.</p>
</td></tr>
<tr><td><code id="MR.mean_+3A_order">order</code></td>
<td>
<p>A numeric value. The order of moments up to which to be calibrated.</p>
</td></tr>
<tr><td><code id="MR.mean_+3A_data">data</code></td>
<td>
<p>A data frame with missing data encoded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="MR.mean_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Logical. If <code>bootstrap = TRUE</code>, the bootstrap will be applied to calculate the standard error and construct a Wald confidence interval.</p>
</td></tr>
<tr><td><code id="MR.mean_+3A_bootstrap.size">bootstrap.size</code></td>
<td>
<p>A numeric value. Number of bootstrap resamples generated if <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MR.mean_+3A_alpha">alpha</code></td>
<td>
<p>Significance level used to construct the 100(1 - <code>alpha</code>)% Wald confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>The estimated value of the marginal mean.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>The bootstrap standard error of <code>mu</code> when <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A Wald-type confidence interval based on <code>mu</code> and <code>SE</code> when <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>The calibration weights if any <code>reg.model</code>, <code>mis.model</code> or <code>moment</code> is specified.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Han, P. and Wang, L. (2013). Estimation with missing data: beyond double robustness. <em>Biometrika</em>, <strong>100</strong>(2), 417&ndash;430.
</p>
<p>Han, P. (2014). A further study of the multiply robust estimator in missing data analysis. <em>Journal of Statistical Planning and Inference</em>, <strong>148</strong>, 101&ndash;110.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulated data set
set.seed(123)
n &lt;- 400
gamma0 &lt;- c(1, 2, 3)
alpha0 &lt;- c(-0.8, -0.5, 0.3)
X &lt;- runif(n, min = -2.5, max = 2.5)
p.mis &lt;- 1 / (1 + exp(alpha0[1] + alpha0[2] * X + alpha0[3] * X ^ 2))
R &lt;- rbinom(n, size = 1, prob = 1 - p.mis)
a.x &lt;- gamma0[1] + gamma0[2] * X + gamma0[3] * exp(X)
Y &lt;- rnorm(n, a.x, sd = sqrt(4 * X ^ 2 + 2))
dat &lt;- data.frame(X, Y)
dat[R == 0, 2] &lt;- NA

# Define the outcome regression models and missingness probability models
reg1 &lt;- glm.work(formula = Y ~ X + exp(X), family = gaussian)
reg2 &lt;- glm.work(formula = Y ~ X + I(X ^ 2), family = gaussian)
mis1 &lt;- glm.work(formula = R ~ X + I(X ^ 2), family = binomial(link = logit))
mis2 &lt;- glm.work(formula = R ~ X + exp(X), family = binomial(link = cloglog))
MR.mean(response = Y, reg.model = list(reg1, reg2), 
        mis.model = list(mis1, mis2), data = dat)
MR.mean(response = Y, moment = c(X), order = 2, data = dat)

</code></pre>

<hr>
<h2 id='MR.quantile'>Multiply Robust Estimation of the Marginal Quantile</h2><span id='topic+MR.quantile'></span>

<h3>Description</h3>

<p><code>MR.quantile()</code> is used to estimate the marginal quantile of a variable which is subject to missingness. Multiple missingness probability models and imputation models are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MR.quantile(response, tau = 0.5, imp.model = NULL, mis.model = NULL,
  moment = NULL, order = 1, L = 30, data, bootstrap = FALSE,
  bootstrap.size = 300, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MR.quantile_+3A_response">response</code></td>
<td>
<p>The response variable of interest whose marginal quantile is to be estimated.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_tau">tau</code></td>
<td>
<p>A numeric value in (0,1). The quantile to be estimated.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_imp.model">imp.model</code></td>
<td>
<p>A list of imputation models defined by <code><a href="#topic+glm.work">glm.work</a></code>.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_mis.model">mis.model</code></td>
<td>
<p>A list of missingness probability models defined by <code><a href="#topic+glm.work">glm.work</a></code>. The dependent variable is always specified as <code>R</code>.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_moment">moment</code></td>
<td>
<p>A vector of auxiliary variables whose moments are to be calibrated.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_order">order</code></td>
<td>
<p>A numeric value. The order of moments up to which to be calibrated.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_l">L</code></td>
<td>
<p>Number of imputations.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_data">data</code></td>
<td>
<p>A data frame with missing data encoded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Logical. If <code>bootstrap = TRUE</code>, the bootstrap will be applied to calculate the standard error and construct a Wald confidence interval.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_bootstrap.size">bootstrap.size</code></td>
<td>
<p>A numeric value. Number of bootstrap resamples generated if <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MR.quantile_+3A_alpha">alpha</code></td>
<td>
<p>Significance level used to construct the 100(1 - <code>alpha</code>)% Wald confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>The estimated value of the marginal quantile.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>The bootstrap standard error of <code>q</code> when <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A Wald-type confidence interval based on <code>q</code> and <code>SE</code> when <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>The calibration weights if any <code>imp.model</code>, <code>mis.model</code> or <code>moment</code> is specified.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Han, P., Kong, L., Zhao, J. and Zhou, X. (2019). A general framework for quantile estimation with incomplete data. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>. <strong>81</strong>(2), 305&ndash;333.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulated data set
set.seed(123)
n &lt;- 400
gamma0 &lt;- c(1, 2, 3)
alpha0 &lt;- c(-0.8, -0.5, 0.3)
X &lt;- runif(n, min = -2.5, max = 2.5)
p.mis &lt;- 1 / (1 + exp(alpha0[1] + alpha0[2] * X + alpha0[3] * X ^ 2))
R &lt;- rbinom(n, size = 1, prob = 1 - p.mis)
a.x &lt;- gamma0[1] + gamma0[2] * X + gamma0[3] * exp(X)
Y &lt;- rnorm(n, a.x, sd = sqrt(4 * X ^ 2 + 2))
dat &lt;- data.frame(X, Y)
dat[R == 0, 2] &lt;- NA

# Define the outcome regression models and missingness probability models
imp1 &lt;- glm.work(formula = Y ~ X + exp(X), family = gaussian)
imp2 &lt;- glm.work(formula = Y ~ X + I(X ^ 2), family = gaussian)
mis1 &lt;- glm.work(formula = R ~ X + I(X ^ 2), family = binomial(link = logit))
mis2 &lt;- glm.work(formula = R ~ X + exp(X), family = binomial(link = cloglog))
MR.quantile(response = Y, tau = 0.25, imp.model = list(imp1, imp2),
            mis.model = list(mis1, mis2), L = 10, data = dat)
MR.quantile(response = Y, tau = 0.25, moment = c(X), order = 2, data = dat)
</code></pre>

<hr>
<h2 id='MR.quantreg'>Multiply Robust Estimation for Quantile Regression</h2><span id='topic+MR.quantreg'></span>

<h3>Description</h3>

<p><code>MR.quantreg()</code> is used for quantile regression with missing responses and/or missing covariates. Multiple missingness probability models and imputation models are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MR.quantreg(formula, tau = 0.5, imp.model = NULL, mis.model = NULL,
  moment = NULL, order = 1, L = 30, data, bootstrap = FALSE,
  bootstrap.size = 300, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MR.quantreg_+3A_formula">formula</code></td>
<td>
<p>The <code><a href="stats.html#topic+formula">formula</a></code> of the linear quantile regression model of interest.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_tau">tau</code></td>
<td>
<p>A numeric value in (0,1). The quantile to be estimated.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_imp.model">imp.model</code></td>
<td>
<p>A list of possibly multiple lists of the form <code>list(list.1, list.2, ..., list.K)</code>, where <code>K</code> is the total number of different imputation models. For the <em>k</em>-th imputation model, <code>list.k</code> is a list of possibly multiple models, each of which is defined by <code><a href="#topic+glm.work">glm.work</a></code> and imputes one single missing variable marginally. See details.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_mis.model">mis.model</code></td>
<td>
<p>A list of missingness probability models defined by <code><a href="#topic+glm.work">glm.work</a></code>. The dependent variable is always specified as <code>R</code>.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_moment">moment</code></td>
<td>
<p>A vector of auxiliary variables whose moments are to be calibrated.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_order">order</code></td>
<td>
<p>A numeric value. The order of moments up to which to be calibrated.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_l">L</code></td>
<td>
<p>Number of imputations.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_data">data</code></td>
<td>
<p>A data frame with missing data encoded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Logical. If <code>bootstrap = TRUE</code>, the bootstrap will be applied to calculate the standard error and construct a Wald confidence interval.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_bootstrap.size">bootstrap.size</code></td>
<td>
<p>A numeric value. Number of bootstrap resamples generated if <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_alpha">alpha</code></td>
<td>
<p>Significance level used to construct the 100(1 - <code>alpha</code>)% Wald confidence interval.</p>
</td></tr>
<tr><td><code id="MR.quantreg_+3A_...">...</code></td>
<td>
<p>Addition arguments for the function <code><a href="quantreg.html#topic+rq">rq</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>MR.quantreg()</code> currently deals with data with one missingness pattern. When multiple variables are subject to missingness, their values are missing simultaneously. The method in Han et al. (2019) specifies an imputation model by modeling the joint distribution of the missing variables conditional on the fully observed variables. In contrast, the function <code>MR.quantreg()</code> specifies an imputation model by separately modeling the marginal distribution of each missing variable conditional on the fully observed variables. These marginal distribution models for different missing variables constitute one joint imputation model. Different imputation models do not need to model the marginal distribution of each missing variable differently.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>The estimated quantile regression coefficients.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>The bootstrap standard error of <code>coefficients</code> when <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A Wald-type confidence interval based on <code>coefficients</code> and <code>SE</code> when <code>bootstrap = TRUE</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Han, P., Kong, L., Zhao, J. and Zhou, X. (2019). A general framework for quantile estimation with incomplete data. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>. <strong>81</strong>(2), 305&ndash;333.
</p>


<h3>See Also</h3>

<p><code><a href="quantreg.html#topic+rq">rq</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulated data set
set.seed(123)
n &lt;- 400
gamma0 &lt;- c(1, 2, 3)
alpha0 &lt;- c(-0.8, -0.5, 0.3)
S &lt;- runif(n, min = -2.5, max = 2.5) # auxiliary variables
X1 &lt;- rbinom(n, size = 1, prob = 0.5) # covariate X1
X2 &lt;- rexp(n) # covariate X2
p.obs &lt;- 1 / (1 + exp(alpha0[1] + alpha0[2] * S + alpha0[3] * S ^ 2)) # non-missingness probability
R &lt;- rbinom(n, size = 1, prob = p.obs)
a.x &lt;- gamma0[1] + gamma0[2] * X1 + gamma0[3] * X2
Y &lt;- rnorm(n, a.x)
dat &lt;- data.frame(S, X1, X2, Y)
dat[R == 0, c(2, 4)] &lt;- NA # X1 and Y may be missing

# marginal imputation models for X1
impX1.1 &lt;- glm.work(formula = X1 ~ S, family = binomial(link = logit))
impX1.2 &lt;- glm.work(formula = X1 ~ S + X2, family = binomial(link = cloglog))
# marginal imputation models for Y
impY.1 &lt;- glm.work(formula = Y ~ S, family = gaussian)
impY.2 &lt;- glm.work(formula = Y ~ S + X2, family = gaussian)
# missingness probability models
mis1 &lt;- glm.work(formula = R ~ S + I(S ^ 2), family = binomial(link = logit))
mis2 &lt;- glm.work(formula = R ~ I(S ^ 2), family = binomial(link = cloglog))
# this example considers the following K = 3 imputation models for imputing the missing (X1, Y)
imp1 &lt;- list(impX1.1, impY.1)
imp2 &lt;- list(impX1.1, impY.2)
imp3 &lt;- list(impX1.2, impY.1)

results &lt;- MR.quantreg(formula = Y ~ X1 + X2, tau = 0.75, imp.model = list(imp1, imp2, imp3),
                       mis.model = list(mis1, mis2), L = 10, data = dat)
results$coefficients
MR.quantreg(formula = Y ~ X1 + X2, tau = 0.75, 
            moment = c(S, X2), order = 2, data = dat)$coefficients
</code></pre>

<hr>
<h2 id='MR.reg'>Multiply Robust Estimation for (Mean) Regression</h2><span id='topic+MR.reg'></span>

<h3>Description</h3>

<p><code>MR.reg()</code> is used for (mean) regression under generalized linear models with missing responses and/or missing covariates. Multiple missingness probability models and imputation models are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MR.reg(formula, family = gaussian, imp.model = NULL,
  mis.model = NULL, moment = NULL, order = 1, L = 30, data,
  bootstrap = FALSE, bootstrap.size = 300, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MR.reg_+3A_formula">formula</code></td>
<td>
<p>The <code><a href="stats.html#topic+formula">formula</a></code> of the regression model of interest.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used for the GLM of interest.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_imp.model">imp.model</code></td>
<td>
<p>A list of possibly multiple lists of the form <code>list(list.1, list.2, ..., list.K)</code>, where <code>K</code> is the total number of different imputation models. For the <em>k</em>-th imputation model, <code>list.k</code> is a list of possibly multiple models, each of which is defined by <code><a href="#topic+glm.work">glm.work</a></code> and imputes one single missing variable marginally. See details.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_mis.model">mis.model</code></td>
<td>
<p>A list of missingness probability models defined by <code><a href="#topic+glm.work">glm.work</a></code>. The dependent variable is always specified as <code>R</code>.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_moment">moment</code></td>
<td>
<p>A vector of auxiliary variables whose moments are to be calibrated.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_order">order</code></td>
<td>
<p>A numeric value. The order of moments up to which to be calibrated.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_l">L</code></td>
<td>
<p>Number of imputations.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_data">data</code></td>
<td>
<p>A data frame with missing data encoded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Logical. If <code>bootstrap = TRUE</code>, the bootstrap will be applied to calculate the standard error and construct a Wald confidence interval.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_bootstrap.size">bootstrap.size</code></td>
<td>
<p>A numeric value. Number of bootstrap resamples generated if <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_alpha">alpha</code></td>
<td>
<p>Significance level used to construct the 100(1 - <code>alpha</code>)% Wald confidence interval.</p>
</td></tr>
<tr><td><code id="MR.reg_+3A_...">...</code></td>
<td>
<p>Addition arguments for the function <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>MR.reg()</code> currently deals with data with one missingness pattern. When multiple variables are subject to missingness, their values are missing simultaneously. The methods in Han (2016) and Zhang and Han (2019) specify an imputation model by modeling the joint distribution of the missing variables conditional on the fully observed variables. In contrast, the function <code>MR.reg()</code> specifies an imputation model by separately modeling the marginal distribution of each missing variable conditional on the fully observed variables. These marginal distribution models for different missing variables constitute one joint imputation model. Different imputation models do not need to model the marginal distribution of each missing variable differently.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>The estimated regression coefficients.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>The bootstrap standard error of <code>coefficients</code> when <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A Wald-type confidence interval based on <code>coefficients</code> and <code>SE</code> when <code>bootstrap = TRUE</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Han, P. (2014). Multiply robust estimation in regression analysis with missing data. <em>Journal of the American Statistical Association</em>, <strong>109</strong>(507), 1159&ndash;1173.
</p>
<p>Han, P. (2016). Combining inverse probability weighting and multiple imputation to improve robustness of estimation. <em>Scandinavian Journal of Statistics</em>, <strong>43</strong>, 246&ndash;260.
</p>
<p>Zhang, S. and Han, P. (2019). A simple implementation of multiply robust estimation for GLMs with missing data. Unpublished manuscript.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulated data set
set.seed(123)
n &lt;- 400
gamma0 &lt;- c(1, 2, 3)
alpha0 &lt;- c(-0.8, -0.5, 0.3)
S &lt;- runif(n, min = -2.5, max = 2.5) # auxiliary variables
X1 &lt;- rbinom(n, size = 1, prob = 0.5) # covariate X1
X2 &lt;- rexp(n) # covariate X2
p.obs &lt;- 1 / (1 + exp(alpha0[1] + alpha0[2] * S + alpha0[3] * S ^ 2)) # non-missingness probability
R &lt;- rbinom(n, size = 1, prob = p.obs)
a.x &lt;- gamma0[1] + gamma0[2] * X1 + gamma0[3] * X2
Y &lt;- rnorm(n, a.x)
dat &lt;- data.frame(S, X1, X2, Y)
dat[R == 0, c(2, 4)] &lt;- NA # X1 and Y may be missing

# marginal imputation models for X1
impX1.1 &lt;- glm.work(formula = X1 ~ S, family = binomial(link = logit))
impX1.2 &lt;- glm.work(formula = X1 ~ S + X2, family = binomial(link = cloglog))
# marginal imputation models for Y
impY.1 &lt;- glm.work(formula = Y ~ S, family = gaussian)
impY.2 &lt;- glm.work(formula = Y ~ S + X2, family = gaussian)
# missingness probability models
mis1 &lt;- glm.work(formula = R ~ S + I(S ^ 2), family = binomial(link = logit))
mis2 &lt;- glm.work(formula = R ~ I(S ^ 2), family = binomial(link = cloglog))
# this example considers the following K = 3 imputation models for imputing the missing (X1, Y)
imp1 &lt;- list(impX1.1, impY.1)
imp2 &lt;- list(impX1.1, impY.2)
imp3 &lt;- list(impX1.2, impY.1)

results &lt;- MR.reg(formula = Y ~ X1 + X2, family = gaussian, imp.model = list(imp1, imp2, imp3),
                  mis.model = list(mis1, mis2), L = 10, data = dat)
results$coefficients
MR.reg(formula = Y ~ X1 + X2, family = gaussian, 
       moment = c(S, X2), order = 2, data = dat)$coefficients
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
