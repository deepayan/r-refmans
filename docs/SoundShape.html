<!DOCTYPE html><html><head><title>Help for package SoundShape</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SoundShape}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SoundShape'><p>Sound Waves Onto Morphometric Data</p></a></li>
<li><a href='#align.wave'><p>Automatic placement of calls at beggining of sound window</p></a></li>
<li><a href='#centralis'><p>Vocalization of the frog <em>Physalaemus centralis</em></p></a></li>
<li><a href='#cuvieri'><p>Vocalization of the frog <em>Physalaemus cuvieri</em></p></a></li>
<li><a href='#eig.sample'><p>Sample of 3D point coordinates (semilandmarks) acquired with <code>eigensound</code> function</p></a></li>
<li><a href='#eigensound'><p>Sound waves onto morphometric data</p></a></li>
<li><a href='#hypo.surf'><p>Hypothetical 3D sound surfaces representing a sample of sound waves</p></a></li>
<li><a href='#kroyeri'><p>Vocalization of the frog <em>Physalaemus kroyeri</em></p></a></li>
<li><a href='#pca.plot'><p>Plot ordination of Principal Components with convex hulls</p></a></li>
<li><a href='#raven.list'><p>Sample of tables containing selection boxes from Raven Pro software</p></a></li>
<li><a href='#raven.to.wave'><p>Export sample <code>".wav"</code> files using selections from Raven Pro software.</p></a></li>
<li><a href='#threeDspectro'><p>3D spectrogram plots from <code>"Wave"</code> objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Sound Waves Onto Morphometric Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-23</td>
</tr>
<tr>
<td>Description:</td>
<td>Implement a promising, and yet little explored protocol for bioacoustical analysis, the eigensound method by MacLeod, Krieger and Jones (2013) &lt;<a href="https://doi.org/10.4404%2Fhystrix-24.1-6299">doi:10.4404/hystrix-24.1-6299</a>&gt;. Eigensound is a multidisciplinary method focused on the direct comparison between stereotyped sounds from different species. 'SoundShape', in turn, provide the tools required for anyone to go from sound waves to Principal Components Analysis, using tools extracted from traditional bioacoustics (i.e. 'tuneR' and 'seewave' packages), geometric morphometrics (i.e. 'geomorph' package) and multivariate analysis (e.g. 'stats' package). For more information, please see Rocha and Romano (2021) and check 'SoundShape' repository on GitHub for news and updates <a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>abind, geomorph (&ge; 3.0.2), graphics, grDevices, plot3D,
reshape2, seewave, stats, tuneR, utils, stringr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>vegan, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-24 02:51:27 UTC; n10832777</td>
</tr>
<tr>
<td>Author:</td>
<td>Pedro Rocha [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pedro Rocha &lt;p.rocha1990@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-24 03:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SoundShape'>Sound Waves Onto Morphometric Data</h2><span id='topic+SoundShape'></span><span id='topic+SoundShape-package'></span>

<h3>Description</h3>

<p><code>SoundShape</code> package provide the tools required to implement a promising, and yet little explored method for bioacoustical analysis, the so called eigensound protocol developed by MacLeod, Krieger, &amp; Jones (2013). Eigensound was developed for taxonomy-based bioacoustics and focuses on the comparison between acoustic units from different species. The method consists on applying a sampling grid over the 3D representation of sound (i.e. spectrogram data) and then translate the spectrogram into a dataset that can be analyzed similarly to 3D coordinate sets used in Geometric Morphometrics Methods, thus enabling the direct comparison between stereotyped calls from different species. For more information on <code>SoundShape</code> and the eigensound method, see Rocha &amp; Romano (2021) and MacLeod et al. (2013).
</p>
<p>The following set of functions crosses the bridge between Bioacoustics and Geometric Morphometrics:
</p>

<ul>
<li><p><code><a href="#topic+raven.to.wave">raven.to.wave</a></code>: Export sample <code>".wav"</code> files using selections from Raven Pro software.
</p>
</li>
<li><p><code><a href="#topic+align.wave">align.wave</a></code>: Automatic placement of calls at the beginning of a sound window.
</p>
</li>
<li><p><code><a href="#topic+eigensound">eigensound</a></code>: Calculate spectrogram data for each <code>".wav"</code> file on a given folder and acquire semilandmarks using a 3D representation of sound.
</p>
</li>
<li><p><code><a href="#topic+pca.plot">pca.plot</a></code>: Plot ordination of Principal Components with convex hulls.
</p>
</li>
<li><p><code><a href="#topic+hypo.surf">hypo.surf</a></code>: Hypothetical 3D plots of sound surfaces representing a sample of sounds submitted to <code><a href="#topic+eigensound">eigensound</a></code>.
</p>
</li>
<li><p><code><a href="#topic+threeDspectro">threeDspectro</a></code>: 3D spectrograms from a single object of class <code>"Wave"</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pedro Rocha <a href="mailto:p.rocha1990@gmail.com">p.rocha1990@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a>
</p>
</li></ul>


<hr>
<h2 id='align.wave'>Automatic placement of calls at beggining of sound window</h2><span id='topic+align.wave'></span>

<h3>Description</h3>

<p>Recreate each <code>".wav"</code> file on a given folder while placing calls at the beginning of sound window. New <code>".wav"</code> files will be stored on a new folder, which is automatically created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>align.wave(
  wav.at = NULL,
  wav.to = "Aligned",
  time.length = 1,
  time.perc = 0.005,
  flim = NULL,
  dBlevel = 25,
  f = 44100,
  wl = 512,
  ovlp = 70
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="align.wave_+3A_wav.at">wav.at</code></td>
<td>
<p>filepath to the folder where <code>".wav"</code> files are stored. Should be presented between quotation marks. By default: <code>wav.at = NULL</code> (i.e. user must specify the filepath to <code>".wav"</code> files)</p>
</td></tr>
<tr><td><code id="align.wave_+3A_wav.to">wav.to</code></td>
<td>
<p>name of the folder where new <code>".wav"</code> files will be stored. Should be presented between quotation marks. By default: <code>wav.to = "Aligned"</code></p>
</td></tr>
<tr><td><code id="align.wave_+3A_time.length">time.length</code></td>
<td>
<p>intended length for the time (X-axis) in seconds. Should be a value that encompasses all sounds in the study. By default: <code>time.length = 1</code></p>
</td></tr>
<tr><td><code id="align.wave_+3A_time.perc">time.perc</code></td>
<td>
<p>slight time gap (in percentage) relative to the intended length that encompass all sounds in the study (i.e. <code>time.length</code>). Intervals are added before and after the minimum and maximum time coordinates (X-values) from the selected curve of relative amplitude (<code>dBlevel</code>). By default: <code>time.perc = 0.005</code> (i.e. 0.5%)</p>
</td></tr>
<tr><td><code id="align.wave_+3A_flim">flim</code></td>
<td>
<p>modifications of the frequency limits (Y-axis) to focus on acoustic units. Useful for recordings with low signal-to-noise ratio. Vector with two values in kHz. By default: <code>flim = NULL</code></p>
</td></tr>
<tr><td><code id="align.wave_+3A_dblevel">dBlevel</code></td>
<td>
<p>absolute amplitude value to be used as relative amplitude contour, which will serve as reference for call placement. By default: <code>dBlevel = 25</code></p>
</td></tr>
<tr><td><code id="align.wave_+3A_f">f</code></td>
<td>
<p>sampling frequency of <code>".wav"</code> files (in Hz). By default: <code>f = 44100</code></p>
</td></tr>
<tr><td><code id="align.wave_+3A_wl">wl</code></td>
<td>
<p>length of the window for the analysis. By default: <code>wl = 512</code></p>
</td></tr>
<tr><td><code id="align.wave_+3A_ovlp">ovlp</code></td>
<td>
<p>overlap between two successive windows (in %) for increased spectrogram resolution. By default: <code>ovlp = 70</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>MacLeod, N., Krieger, J. &amp; Jones, K. E. (2013). Geometric morphometric approaches to acoustic signal analysis in mammalian biology. <em>Hystrix, the Italian Journal of Mammalogy, 24</em>(1), 110-125.
</p>
<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eigensound">eigensound</a></code>
</p>
<p>Useful links:
</p>

<ul>
<li><p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li><p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
library(seewave)
library(tuneR)

# Create temporary folder to store ".wav" files
wav.at &lt;- file.path(base::tempdir(), "align.wave")
if(!dir.exists(wav.at)) dir.create(wav.at)

# Create temporary folder to store results
store.at &lt;- file.path(base::tempdir(), "align.wave-output")
if(!dir.exists(store.at)) dir.create(store.at)

# Select acoustic units to be analyzed
data(cuvieri)
spectro(cuvieri, flim = c(0,3)) # Visualize sound data that will be used

# Cut acoustic units from original Wave
cut.cuvieri1 &lt;- cutw(cuvieri, f=44100, from=0, to=0.5, output = "Wave")
cut.cuvieri2 &lt;- cutw(cuvieri, f=44100, from=0.7, to=1.2, output = "Wave")
cut.cuvieri3 &lt;- cutw(cuvieri, f=44100, from=1.4, to=1.9, output = "Wave")

# Export ".wav" files containing selected acoustic units and store on previosly created folder
writeWave(cut.cuvieri1, filename = file.path(wav.at, "cut.cuvieri1.wav"), extensible = FALSE)
writeWave(cut.cuvieri2, filename = file.path(wav.at, "cut.cuvieri2.wav"), extensible = FALSE)
writeWave(cut.cuvieri3, filename = file.path(wav.at, "cut.cuvieri3.wav"), extensible = FALSE)

# Align acoustic units selected at 1% of time lenght
align.wave(wav.at = wav.at, wav.to = "Aligned",
           time.length = 0.5, time.perc = 0.01, dBlevel = 25)

# Verify alignment using eigensound function featuring analysis.type = "twoDshape"
eigensound(analysis.type = "twoDshape", wav.at = file.path(wav.at, "Aligned"), store.at = store.at,
           flim=c(0, 3), tlim=c(0,0.5), dBlevel = 25, plot.exp = TRUE, plot.as = "jpeg")
# To see jpeg files created, check folder specified by store.at



</code></pre>

<hr>
<h2 id='centralis'>Vocalization of the frog <em>Physalaemus centralis</em></h2><span id='topic+centralis'></span>

<h3>Description</h3>

<p>Recording of a series of three stereotyped calls emitted by a male frog <em>Physalaemus centralis</em> (Amphibia, Anura, Leptodactylidae). Edited from original <code>".wav"</code> file for optimal sinal to noise ratio and reduced time duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(centralis)
</code></pre>


<h3>Format</h3>

<p>An object of the class <code>"Wave"</code> (<code><a href="tuneR.html#topic+tuneR">tuneR</a></code> package).
</p>


<h3>Details</h3>

<p>Duration = 2.89 s. Sampling Frequency = 44100 Hz.
</p>
<p>Recorded at Formoso do Araguaia Municipality, Tocantins State, Brazil, on 9 December 1992. Air temperature 25ºC.
</p>


<h3>Source</h3>

<p>Original recording housed at Fonoteca Neotropical Jacques Vielliard (FNJV-0031188). Recorded by Adão José Cardoso.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(centralis)

seewave::oscillo(centralis)
seewave::spectro(centralis)
threeDspectro(centralis,tlim=c(0, 0.8), flim=c(0, 4), samp.grid=FALSE, dBlevel=25)
</code></pre>

<hr>
<h2 id='cuvieri'>Vocalization of the frog <em>Physalaemus cuvieri</em></h2><span id='topic+cuvieri'></span>

<h3>Description</h3>

<p>Recording of a series of three stereotyped calls emitted by a male frog <em>Physalaemus cuvieri</em> (Amphibia, Anura, Leptodactylidae). Edited from original <code>".wav"</code> file for optimal sinal to noise ratio and reduced time duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cuvieri)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"Wave"</code>; see (<code><a href="tuneR.html#topic+tuneR">tuneR</a></code> package).
</p>


<h3>Details</h3>

<p>Duration = 1.96 s. Sampling Frequency = 44100 Hz.
</p>
<p>Recorded at São José dos Campos Municipality, São Paulo State, Brazil, on 24 September 2013. Air temperature 22ºC.
</p>


<h3>Source</h3>

<p>Original recording housed at Coleção Bioacústica da Universidade Federal de Minas Gerais (CBUFMG-00196). Recorded by Pedro Rocha.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cuvieri)

seewave::oscillo(cuvieri)
seewave::spectro(cuvieri)
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4), samp.grid=FALSE)
</code></pre>

<hr>
<h2 id='eig.sample'>Sample of 3D point coordinates (semilandmarks) acquired with <code>eigensound</code> function</h2><span id='topic+eig.sample'></span>

<h3>Description</h3>

<p>This sample file was acquired using <code>eigensound(analysis.type = "threeDshape")</code> and features 3D point coordinates (i.e. semilandmarks) from the calls of three frog species: <em>Physalaemus centralis</em>, <em>P. cuvieri</em> and <em>P. kroyeri</em> (Amphibia, Anura, Leptodactylidae).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(eig.sample)
</code></pre>


<h3>Format</h3>

<p>An object of the class <code>"array"</code> (<code><a href="base.html#topic+base">base</a></code> package).
</p>
<p><code>"array"</code> is a special type of <code>"list"</code> that can be thought as a filing cabinet, in which the <code>array</code> is the cabinet and each element is an arquive. This special <code>list</code> can be used in the subsequent steps of the eigensound protocol (MacLeod et al., 2013; Rocha &amp; Romano <em>in prep</em>).
</p>


<h3>Details</h3>

<p>Each species is represented by three stereotyped acoustic units (i.e. notes from their advertisement calls), which are available as sample data from <code><a href="#topic+SoundShape">SoundShape</a></code> (<code>"Wave"</code> objects: <code><a href="#topic+centralis">centralis</a></code>, <code><a href="#topic+cuvieri">cuvieri</a></code> and <code><a href="#topic+kroyeri">kroyeri</a></code>). See Rocha &amp; Romano (<em>in prep</em>) for details.
</p>
<p>Prior to <code><a href="#topic+eigensound">eigensound</a></code> analysis, each of the sample calls had the acoustic units selected, stored as separate <code>".wav"</code> files, and aligned at beggining of sound window using <code>align.wave</code> (see <code>Examples</code> section).
</p>
<p><code>eig.sample</code> is composed of 9 elements (i.e. three species, each represented by three acoustic units). Each element is a matrix with 3200 rows and 3 columns (i.e. X, Y and Z coordinates of 3200 semilandmarks). The number of semilandmarks acquired will depend on the number of cells per side on the sound window (i.e. <code>x.length</code> and <code>y.length</code> arguments from <code><a href="#topic+eigensound">eigensound</a></code> function).
</p>
<p>The analysis itself (<code><a href="#topic+eigensound">eigensound</a></code> function) featured relative amplitude backgroud at 25 dB (<code>dBlevel = 25</code>), sampling grid of 70 cells on the time (X-axis) and 47 cells on the frequency (Y-axis) (<code>x.length = 70</code>, <code>y.length = 47</code>, respectively). Sound window ranged from 0 to 0.8 s (X-axis), and from 0 to 4 kHz (Y-axis) (<code>tlim = c(0, 0.8)</code>, <code>flim = c(0, 4)</code>, respectively).
</p>
<p>Spectrogram parameters were the same as <code>eigensound</code> default: <code>f = 44100</code>, <code>wl = 512</code>, <code>ovlp = 70</code>.
</p>


<h3>Source</h3>

<p>Sample data of <code>"Wave"</code> objects employed on <code>eigensound</code> analysis:
</p>

<ul>
<li><p><code><a href="#topic+centralis">centralis</a></code>: Advertisement call of <em>Physalaemus centralis</em>; original recording housed at Fonoteca Neotropical Jacques Vielliard (FNJV-0031188). Recorded by Adão José Cardoso.
</p>
</li>
<li><p><code><a href="#topic+cuvieri">cuvieri</a></code>: Advertisement call of <em>Physalaemus cuvieri</em>; original recording housed at Coleção Bioacústica da Universidade Federal de Minas Gerais (CBUFMG-00196). Recorded by Pedro Rocha.
</p>
</li>
<li><p><code><a href="#topic+kroyeri">kroyeri</a></code>: Advertisement call of <em>Physalaemus kroyeri</em>; Original recording housed at Fonoteca Neotropical Jacques Vielliard (FNJV-0032047). Recorded by Werner Bokermann.
</p>
</li></ul>



<h3>References</h3>

<p>MacLeod, N., Krieger, J. &amp; Jones, K. E. (2013). Geometric morphometric approaches to acoustic signal analysis in mammalian biology. <em>Hystrix, the Italian Journal of Mammalogy, 24</em>(1), 110-125.
</p>
<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eig.sample)

# PCA using 3D semilandmark coordinates
pca.eig.sample &lt;- stats::prcomp(geomorph::two.d.array(eig.sample))

# Verify names for each acoustic unit and the order in which they appear
dimnames(eig.sample)[[3]]

# Create factor to use as groups in subsequent ordination plot
sample.gr &lt;- factor(c(rep("centralis", 3), rep("cuvieri", 3), rep("kroyeri", 3)))

# Plot result of Principal Components Analysis
pca.plot(PCA.out = pca.eig.sample, groups = sample.gr, conv.hulls = sample.gr,
         main="PCA of 3D coordinates", leg=TRUE, leg.pos = "top")

# Verify hypothetical sound surfaces for each Principal Component
hypo.surf(threeD.out=eig.sample, PC=1, flim=c(0, 4), tlim=c(0, 0.8),
          x.length=70, y.length=47, plot.exp = FALSE)


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#                      Recreate eig.sample object                        #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#


library(seewave)
library(tuneR)

# Create temporary folder to store ".wav" files
wav.at &lt;- file.path(base::tempdir(), "eig.sample")
if(!dir.exists(wav.at)) dir.create(wav.at)

# Create temporary folder to store results
store.at &lt;- file.path(base::tempdir(), "eig.sample-output")
if(!dir.exists(store.at)) dir.create(store.at)

# Select three acoustic units within each sound data
data(cuvieri)
spectro(cuvieri, flim = c(0,4))
cut.cuvieri1 &lt;- cutw(cuvieri, f=44100, from=0, to=0.5, output = "Wave")
cut.cuvieri2 &lt;- cutw(cuvieri, f=44100, from=0.7, to=1.2, output = "Wave")
cut.cuvieri3 &lt;- cutw(cuvieri, f=44100, from=1.4, to=1.9, output = "Wave")

data("centralis")
spectro(centralis, flim = c(0,4))
cut.centralis1 &lt;- cutw(centralis, f=44100, from=0.1, to=0.8, output = "Wave")
cut.centralis2 &lt;- cutw(centralis, f=44100, from=1.05, to=1.75, output = "Wave")
cut.centralis3 &lt;- cutw(centralis, f=44100, from=2.1, to=2.8, output = "Wave")

data("kroyeri")
spectro(kroyeri, flim = c(0,4))
cut.kroyeri1 &lt;- cutw(kroyeri, f=44100, from=0.1, to=1, output = "Wave")
cut.kroyeri2 &lt;- cutw(kroyeri, f=44100, from=1.5, to=2.3, output = "Wave")
cut.kroyeri3 &lt;- cutw(kroyeri, f=44100, from=2.9, to=3.8, output = "Wave")

# Export new wave files containing acoustic units and store on previosly created folder
writeWave(cut.cuvieri1, filename = file.path(wav.at, "cut.cuvieri1.wav"), extensible = FALSE)
writeWave(cut.cuvieri2, filename = file.path(wav.at, "cut.cuvieri2.wav"), extensible = FALSE)
writeWave(cut.cuvieri3, filename = file.path(wav.at, "cut.cuvieri3.wav"), extensible = FALSE)
writeWave(cut.centralis1, filename = file.path(wav.at, "cut.centralis1.wav"), extensible = FALSE)
writeWave(cut.centralis2, filename = file.path(wav.at, "cut.centralis2.wav"), extensible = FALSE)
writeWave(cut.centralis3, filename = file.path(wav.at, "cut.centralis3.wav"), extensible = FALSE)
writeWave(cut.kroyeri1, filename = file.path(wav.at, "cut.kroyeri1.wav"), extensible = FALSE)
writeWave(cut.kroyeri2, filename = file.path(wav.at, "cut.kroyeri2.wav"), extensible = FALSE)
writeWave(cut.kroyeri3, filename = file.path(wav.at, "cut.kroyeri3.wav"), extensible = FALSE)

# Place sounds at beggining of sound window before analysis
align.wave(wav.at = wav.at, wav.to = "Aligned",
           time.length = 0.8, time.perc = 0.005, dBlevel = 25)

# Verify alignment using analysis.type = "twoDshape"
eigensound(analysis.type = "twoDshape", wav.at = file.path(wav.at, "Aligned"),
           store.at = store.at, flim=c(0, 4), tlim=c(0, 0.8),
           plot.exp = TRUE, plot.as = "jpeg", dBlevel = 25)
# Go to folder specified by store.at and check jpeg files created

# Run eigensound function using analysis.type = "threeDshape" on aligned wave files
# Store results as R object
eig.sample &lt;- eigensound(analysis.type="threeDshape", wav.at = file.path(wav.at, "Aligned"),
                         flim=c(0, 4), tlim=c(0, 0.8), dBlevel=25, plot.exp = FALSE,
                         x.length=70, y.length = 47, log.scale = TRUE)




</code></pre>

<hr>
<h2 id='eigensound'>Sound waves onto morphometric data</h2><span id='topic+eigensound'></span>

<h3>Description</h3>

<p><code>eigensound</code> is the main feature of <code>SoundShape</code> package. For each <code>".wav"</code> file on a given folder, the fuction will compute spectrogram data and acquire semilandmarks using a 3D representation of sound (<code>analysis.type = "threeDshape"</code>), allowing its users to acquire, and simultaneously store point coordinates (i.e. semilandmarks) as an R object, and/or in TPS format – the native file format of James Rohlf’s TPS series (Rohlf, 2015).
</p>
<p>Moreover, <code>eigensound</code> also allow its user to export 2D and 3D spectrogram images (<code>plot.exp = TRUE</code>) that are helpful during the protocol for error verification and for illustrative purposes (see Rocha &amp; Romano <em>in prep</em>). Alternativaly, <code>eigensound</code> feature the option of acquiring semilandmarks as the cross-correlation between energy quantiles and a curve of relative amplitude from 2D spectrograms (<code>analysis.type = "twoDshape"</code>; see <code>Details</code> section).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigensound(
  analysis.type = NULL,
  wav.at = NULL,
  store.at = wav.at,
  dBlevel = 25,
  flim = c(0, 10),
  tlim = c(0, 1),
  x.length = 80,
  y.length = 60,
  log.scale = TRUE,
  back.amp = 35,
  add.points = FALSE,
  add.contour = TRUE,
  lwd = 1,
  EQ = c(0.05, 0.15, 0.3, 0.5, 0.7, 0.85, 0.95),
  mag.time = 1,
  f = 44100,
  wl = 512,
  ovlp = 70,
  plot.exp = TRUE,
  plot.as = "jpeg",
  plot.type = "surface",
  rotate.Xaxis = 60,
  rotate.Yaxis = 40,
  TPS.file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigensound_+3A_analysis.type">analysis.type</code></td>
<td>
<p>type of analysis intended. If <code>analysis.type = "threeDshape"</code>, semilandmarks are acquired from spectrogram data using a 3D representation of sound (same as in MacLeod et al., 2013). If <code>analysis.type = "twoDshape"</code> and <code>add.points = TRUE</code>, semilandmarks are acquired using energy quantiles and a 2D curve of relative amplitude. By default: <code>analysis.type = NULL</code> (i.e. method must be specified before the analysis).</p>
</td></tr>
<tr><td><code id="eigensound_+3A_wav.at">wav.at</code></td>
<td>
<p>filepath to the folder where <code>".wav"</code> files are stored. Should be presented between quotation marks. By default: <code>wav.at = NULL</code> (i.e. user must specify the filepath to <code>".wav"</code> files)</p>
</td></tr>
<tr><td><code id="eigensound_+3A_store.at">store.at</code></td>
<td>
<p>filepath to the folder where spectrogram plots and <code>tps</code> file will be stored. Should be presented between quotation marks. By default: <code>store.at = wav.at</code> (i.e. store outputs in the same folder as <code>".wav"</code> files)</p>
</td></tr>
<tr><td><code id="eigensound_+3A_dblevel">dBlevel</code></td>
<td>
<p>absolute amplitude value to be used as relative amplitude contour, which will serve as reference for semilandmark acquisition in both <code>analysis.type = "threeDshape"</code> and <code>"twoDshape"</code>. By default: <code>dBlevel = 25</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_flim">flim</code></td>
<td>
<p>modifications of the frequency limits (Y-axis). Vector with two values in kHz. By default: <code>flim = c(0, 10)</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_tlim">tlim</code></td>
<td>
<p>modifications of the time limits (X-axis). Vector with two values in seconds. By default: <code>tlim = c(0, 1)</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_x.length">x.length</code></td>
<td>
<p>only applies when <code>analysis.type = "threeDshape"</code>. Length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the time (X-axis).  By default: <code>x.length = 80</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_y.length">y.length</code></td>
<td>
<p>only applies when <code>analysis.type = "threeDshape"</code>. Length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the frequency (Y-axis). By default: <code>y.length = 60</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_log.scale">log.scale</code></td>
<td>
<p>only applies when <code>analysis.type = "threeDshape"</code>. A logical. If <code>TRUE</code>, <code>eigensound</code> will use a logarithmic scale on the time (X-axis), which is recommeded when the analyzed sounds present great variation on this axis (e.g. emphasize short duration sounds). If <code>FALSE</code>, a linear scale is used instead (same as MacLeod et al., 2013). By default: <code>log.scale = TRUE</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_back.amp">back.amp</code></td>
<td>
<p>only applies when <code>analysis.type = "twoDshape"</code> and  <code>plot.exp = TRUE</code>. Absolute amplitude value to be used as background in the 2D spectrogram plot. By default: <code>back.amp = 35</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_add.points">add.points</code></td>
<td>
<p>only applies when <code>analysis.type = "twoDshape"</code>. A logical. If <code>TRUE</code>, <code>eigensound</code> will compute semilandmarks acquired by cross-correlation between energy quantiles (i.e. <code>EQ</code>) and a curve of relative amplitude (i.e. <code>dBlevel</code>). If <code>plot.exp = TRUE</code>, semilandmarks will be included in spectrogram plots. By default: <code>add.points = FALSE</code> (see <code>Details</code>)</p>
</td></tr>
<tr><td><code id="eigensound_+3A_add.contour">add.contour</code></td>
<td>
<p>only applies when <code>analysis.type = "twoDshape"</code> and  <code>plot.exp = TRUE</code>. A logical. If <code>TRUE</code>, exported spectrogram plots will include the curves of relative amplitude at the level specified by <code>dBlevel</code>. By default: <code>add.contour = TRUE</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_lwd">lwd</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code> and <code>add.contour = TRUE</code>. The line width for the curves of relative amplitude at the level specified by <code>dBlevel</code>. Same as in <code><a href="graphics.html#topic+par">par</a></code>. By default: <code>lwd = 1</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_eq">EQ</code></td>
<td>
<p>only applies when <code>analysis.type = "twoDshape"</code> and <code>add.points = TRUE</code>. A vector of energy quantiles intended (with <code>0 &lt; EQ &lt; 1</code>). By default: <code>EQ = c(0.05, 0.15, 0.3, 0.5, 0.7, 0.85, 0.95)</code> <strong>Note:</strong> When dealing with narrow banded calls, consider reducing the number of quantiles to prevent errors in the analysis.</p>
</td></tr>
<tr><td><code id="eigensound_+3A_mag.time">mag.time</code></td>
<td>
<p>only applies when <code>analysis.type = "twoDshape"</code>. Optional argument for magnifying the time coordinates (X-axis). This is sometimes desired for small sound windows (e.g. less than 1 s), in which the time coordinates will be on a different scale than that of frequency coordinates. In those cases, it is recommended to include <code>mag.time = 10</code> or <code>mag.time = 100</code>, depending on the lenght of sound window. By default: <code>mag.time = 1</code> (i.e. no magnification is performed)</p>
</td></tr>
<tr><td><code id="eigensound_+3A_f">f</code></td>
<td>
<p>sampling frequency of <code>Wave</code>'s for the analysis (in Hz). By default: <code>f = 44100</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_wl">wl</code></td>
<td>
<p>length of the window for the analysis. By default: <code>wl = 512</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_ovlp">ovlp</code></td>
<td>
<p>overlap between two successive windows (in %) for increased spectrogram resolution. By default: <code>ovlp = 70</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_plot.exp">plot.exp</code></td>
<td>
<p>a logical. If <code>TRUE</code>, for each <code>".wav"</code> file on the folder indicated by <code>wav.at</code>, <code>eigensound</code> will store a spectrogram image on the folder indicated by <code>store.at</code>. Depending on the <code>analysis.type</code>, plots may consist of 2D or 3D spectrogram images. By default: <code>plot.exp = TRUE</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_plot.as">plot.as</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. <code>plot.as = "jpeg"</code> will generate compressed images for quick inspection of semilandmarks; <code>plot.as = "tiff"</code> or <code>"tif"</code> will generate uncompressed high resolution images that can be edited and used for publication. By default: <code>plot.as = "jpeg"</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_plot.type">plot.type</code></td>
<td>
<p>only applies when <code>analysis.type = "threeDshape"</code> and  <code>plot.exp = TRUE</code>. <code>plot.type = "surface"</code> will produce simplified 3D sound surfaces from the calculated semilandmarks (same output employed by MacLeod et al., 2013); <code>plot.type = "points"</code> will produce 3D graphs with semilandmarks as points. By default: <code>plot.type = "surface"</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_rotate.xaxis">rotate.Xaxis</code></td>
<td>
<p>only applies when <code>analysis.type = "threeDshape"</code> and  <code>plot.exp = TRUE</code>. Rotation of the X-axis. Same as <code>theta</code> from <code><a href="plot3D.html#topic+persp3D">persp3D</a></code> (<code><a href="plot3D.html#topic+plot3D">plot3D</a></code> package). By default: <code>rotate.Xaxis = 60</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_rotate.yaxis">rotate.Yaxis</code></td>
<td>
<p>only applies when <code>analysis.type = "threeDshape"</code> and  <code>plot.exp = TRUE</code>. Rotation of the Y-axis. Same as <code>phi</code> from <code><a href="plot3D.html#topic+persp3D">persp3D</a></code> (<code><a href="plot3D.html#topic+plot3D">plot3D</a></code> package). By default: <code>rotate.Yaxis = 40</code></p>
</td></tr>
<tr><td><code id="eigensound_+3A_tps.file">TPS.file</code></td>
<td>
<p>Desired name for the <code>tps</code> file containing semilandmark coordinates. Should be presented between quotation marks. <strong>Note:</strong> Whenever <code>analysis.type = "twoDshape"</code>, it will only work if <code>add.points = TRUE</code>. By default: <code>TPS.file = NULL</code> (i.e. prevents <code>eigensound</code> from creating a <code>tps</code> file)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>analysis.type = "twoDshape"</code> and <code>add.points = TRUE</code>, <code>eigensound</code> will compute semilandmarks acquired by cross-correlation between energy quantiles (i.e. <code>EQ</code>) and a curve of relative amplitude (i.e. <code>dBlevel</code>). However, this is often subtle and prone to incur in errors (e.g. bad alignment of acoustic units; inappropriate X and Y coordinates for the sound window; narrow banded calls). Therefore, a more robust protocol of error verification is achieved using <code>add.points = FALSE</code> and <code>add.contour = TRUE</code> (default), which allow for quick verification of acoustic units alignment and the shape of each curve of relative amplitude (specified by <code>dBlevel</code>).
</p>


<h3>Note</h3>

<p>In order to store the results from <code>eigensound</code> function and proceed with the Geometric Morphometric steps of the analysis (e.g. <code><a href="geomorph.html#topic+geomorph">geomorph</a></code> package; Adams et al., 2017), one can simultaneosly assign the function's output to an <code>R</code> object and/or store them as a <code>tps</code> file to be used by numerous softwares of geometric analysis of shape, such as the TPS series (Rohlf, 2015).
</p>
<p>Additionally, one may also export 2D or 3D plots as <code>jpeg</code> (compressed image) or <code>tiff</code> (uncompressed image) file formats, which can be edited for publication purposes.
</p>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>Adams, D. C., M. L. Collyer, A. Kaliontzopoulou &amp; Sherratt, E. (2017) <em>Geomorph: Software for geometric morphometric analyses</em>. R package version 3.0.5. https://cran.r-project.org/package=geomorph.
</p>
<p>MacLeod, N., Krieger, J. &amp; Jones, K. E. (2013). Geometric morphometric approaches to acoustic signal analysis in mammalian biology. <em>Hystrix, the Italian Journal of Mammalogy, 24</em>(1), 110-125.
</p>
<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>
<p>Rohlf, F.J. (2015) The tps series of software. <em>Hystrix 26</em>, 9-12.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+align.wave">align.wave</a></code>, <code><a href="geomorph.html#topic+geomorph">geomorph</a></code>, <code><a href="seewave.html#topic+seewave">seewave</a></code>
</p>
<p>Useful links:
</p>

<ul>
<li><p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li><p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(seewave)
library(tuneR)

# Create temporary folder to store ".wav" files
wav.at &lt;- file.path(base::tempdir(), "eigensound")
if(!dir.exists(wav.at)) dir.create(wav.at)

# Create temporary folder to store results
store.at &lt;- file.path(base::tempdir(), "eigensound-output")
if(!dir.exists(store.at)) dir.create(store.at)

# Cut acoustic units from original Wave
cut.cuvieri &lt;- cutw(cuvieri, f=44100, from=0, to=0.9, output = "Wave")
cut.centralis &lt;- cutw(centralis, f=44100, from=0, to=0.9, output = "Wave")
cut.kroyeri &lt;- cutw(kroyeri, f=44100, from=0.2, to=1.1, output = "Wave")

# Export ".wav" files containing acoustic units and store on previosly created folder
writeWave(cut.cuvieri, filename = file.path(wav.at, "cut.cuvieri.wav"), extensible = FALSE)
writeWave(cut.centralis, filename = file.path(wav.at, "cut.centralis.wav"), extensible = FALSE)
writeWave(cut.kroyeri, filename = file.path(wav.at, "cut.kroyeri.wav"), extensible = FALSE)



# Create 2D spectrograms using analysis.type = "twoDshape"
eigensound(analysis.type = "twoDshape", flim=c(0, 4), tlim=c(0, 0.8),
           plot.exp=TRUE, wav.at = wav.at, store.at = store.at)

# Create 3D spectrograms using analysis.type = "threeDshape" and store point coordinates
eig.data &lt;- eigensound(analysis.type = "threeDshape", plot.exp=TRUE,
              wav.at = wav.at, store.at = store.at, flim=c(0, 4), tlim=c(0, 0.8))


</code></pre>

<hr>
<h2 id='hypo.surf'>Hypothetical 3D sound surfaces representing a sample of sound waves</h2><span id='topic+hypo.surf'></span>

<h3>Description</h3>

<p>Using the coordinates acquired by <code>eigensound(analysis.type = "threeDshape")</code>, this function creates 3D plots containing hypothetical sound surfaces that represent either the mean shape configuration (consensus), or minimum and maximum deformations relative to Principal Components in a Principal Components Analysis (PCA).
</p>
<p><strong>Note:</strong> The output of <code>hypo.surf</code> must be interpreted along with the ordination of Principal Components (e.g. <code><a href="#topic+pca.plot">pca.plot</a></code>), both featuring the same object used for <code>threeD.out</code> argument. By doing so, <code>hypo.surf</code> enhance the comprehension on how sound shape changed along the ordination plot .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hypo.surf(
  threeD.out = NULL,
  PC = 1,
  flim = c(0, 4),
  tlim = c(0, 0.8),
  x.length = 70,
  y.length = 47,
  log.scale = TRUE,
  f = 44100,
  wl = 512,
  ovlp = 70,
  plot.exp = FALSE,
  plot.as = "jpeg",
  store.at = NULL,
  rotate.Xaxis = 60,
  rotate.Yaxis = 40,
  cex.axis = 0.5,
  cex.lab = 0.9,
  cex.main = 1.1,
  lwd = 0.1,
  xlab = "Time coordinates",
  ylab = "Frequency coordinates",
  zlab = "Amplitude",
  colkey = list(plot = TRUE, cex.clab = 0.9, cex.axis = 0.8, side = 4, length = 0.5,
    width = 0.7, labels = TRUE, tick = TRUE, lty = 1, lwd = 1, lwd.ticks = 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hypo.surf_+3A_threed.out">threeD.out</code></td>
<td>
<p>the output of <code><a href="#topic+eigensound">eigensound</a></code> analysis with <code>analysis.type = "threeDshape"</code>. By default: <code>threeD.out = NULL</code> (i.e. output must be specified before ploting)</p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_pc">PC</code></td>
<td>
<p>Principal Component intended for the plot. Alternativaly, it is also possible to create mean shape configuration (consensus) from sample <code>PC = "mean"</code>. By default: <code>PC = 1</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_flim">flim</code></td>
<td>
<p>modifications of the frequency limits (Y-axis). Vector with two values in kHz. Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code> By default: <code>flim = c(0, 10)</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_tlim">tlim</code></td>
<td>
<p>modifications of the time limits (X-axis). Vector with two values in seconds. Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>tlim = c(0, 1)</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_x.length">x.length</code></td>
<td>
<p>length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the time (X-axis). Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>x.length = 70</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_y.length">y.length</code></td>
<td>
<p>length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the frequency (Y-axis). Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>y.length = 47</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_log.scale">log.scale</code></td>
<td>
<p>a logical. If <code>TRUE</code>, <code>hypo.surf</code> will use a logarithmic scale on the time (X-axis), which is recommeded when the analyzed sounds present great variation on this axis (e.g. emphasize short duration sounds). If <code>FALSE</code>, a linear scale is used instead (same as MacLeod et al., 2013). Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>log.scale = TRUE</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_f">f</code></td>
<td>
<p>sampling frequency of <code>".wav"</code> files (in Hz). Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>f = 44100</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_wl">wl</code></td>
<td>
<p>length of the window for the analysis. Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>wl = 512</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_ovlp">ovlp</code></td>
<td>
<p>overlap between two successive windows (in %) for increased spectrogram resolution. Should be the same employed on <code>eigensound(analysis.type="threeDshape")</code>. By default: <code>ovlp = 70</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_plot.exp">plot.exp</code></td>
<td>
<p>a logical. If <code>TRUE</code>, exports the 3D output plot containing mean shape (<code>PC = "mean"</code>), or minimum and maximum deformations for the desired Principal Component (e.g. <code>PC = 1</code>). Exported plot will be stored on the folder indicated by <code>store.at</code>. By default: <code>plot.exp = FALSE</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_plot.as">plot.as</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. <code>plot.as = "jpeg"</code> will generate compressed images for quick inspection; <code>plot.as = "tiff"</code> or <code>"tif"</code> will generate uncompressed high resolution images that can be edited and used for publication. By default: <code>plot.as = "jpeg"</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_store.at">store.at</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. Filepath to the folder where output plots will be stored. Should be presented between quotation marks. By default: <code>store.at = NULL</code> (i.e. user must specify the filepath where plots of hypothetical sound surfaces will be stored)</p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_rotate.xaxis">rotate.Xaxis</code></td>
<td>
<p>rotation of the X-axis. Same as <code>theta</code> from <code><a href="plot3D.html#topic+persp3D">persp3D</a></code> (<code><a href="plot3D.html#topic+plot3D">plot3D</a></code> package). By default: <code>rotate.Xaxis = 60</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_rotate.yaxis">rotate.Yaxis</code></td>
<td>
<p>rotation of the Y-axis. Same as <code>phi</code> from <code><a href="plot3D.html#topic+persp3D">persp3D</a></code> (<code><a href="plot3D.html#topic+plot3D">plot3D</a></code> package). By default: <code>rotate.Yaxis = 40</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_cex.axis">cex.axis</code></td>
<td>
<p>similarly as in <code><a href="graphics.html#topic+par">par</a></code>, magnification to be used for axis values. By default: <code>cex.axis = 0.9</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_cex.lab">cex.lab</code></td>
<td>
<p>similarly as in <code><a href="graphics.html#topic+par">par</a></code>, magnification to be used for x and y labels. By default: <code>cex.lab = 1.2</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_cex.main">cex.main</code></td>
<td>
<p>similarly as in <code><a href="graphics.html#topic+par">par</a></code>, magnification to be used for main titles. By default: <code>cex.main = 1.3</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_lwd">lwd</code></td>
<td>
<p>Similarly as in <code><a href="graphics.html#topic+par">par</a></code>, intended line width for sampling grid. By default: <code>lwd = 0.1</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_xlab">xlab</code></td>
<td>
<p>a character string indicating the label to be written on the <em>x</em>-axis. By default: <code>xlab="Time coordinates"</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_ylab">ylab</code></td>
<td>
<p>a character string indicating the label to be written on the <em>y</em>-axis. By default: <code>ylab="Frequency coordinates"</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_zlab">zlab</code></td>
<td>
<p>a character string indicating the label to be written on the <em>z</em>-axis. By default: <code>zlab="Amplitude"</code></p>
</td></tr>
<tr><td><code id="hypo.surf_+3A_colkey">colkey</code></td>
<td>
<p>Similarly as <code><a href="plot3D.html#topic+plot3D">plot3D</a></code>, a list with parameters for the color key (legend). By default: <code>colkey = list(plot = TRUE, cex.clab = 0.9, cex.axis = 0.8, side = 4, length = 0.5, width = 0.7, labels = TRUE, tick = TRUE, lty = 1, lwd = 1, lwd.ticks = 1)</code>. See also <code><a href="plot3D.html#topic+colkey">colkey</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>Some codes from <code>hypo.surf</code> were adapted from <code>plotTangentSpace</code> function (<code><a href="geomorph.html#topic+geomorph">geomorph</a></code> package version 3.1.2), which is now deprecated and replaced by current functions <code><a href="geomorph.html#topic+gm.prcomp">gm.prcomp</a></code>, <code><a href="geomorph.html#topic+summary.gm.prcomp">summary.gm.prcomp</a></code> and <code><a href="geomorph.html#topic+plot.gm.prcomp">plot.gm.prcomp</a></code>. More specifically, the code chunk related to the acquisition of hypothetical point configurations from each PC (i.e. warp grids) was the same as in <code>plotTangentSpace</code>. However, the hypothetical configurations from <code>plotTangentSpace</code> were plotted along with ordination of PCs, whereas <code>hypo.surf</code> focuses solely on hypothetical 3D surfaces that represent minimum, maximum and mean deformations relative to each PCs.
</p>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>MacLeod, N., Krieger, J. &amp; Jones, K. E. (2013). Geometric morphometric approaches to acoustic signal analysis in mammalian biology. <em>Hystrix, the Italian Journal of Mammalogy, 24</em>(1), 110-125.
</p>
<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code><a href="geomorph.html#topic+gm.prcomp">gm.prcomp</a></code>, <code><a href="geomorph.html#topic+summary.gm.prcomp">summary.gm.prcomp</a></code>, <code><a href="geomorph.html#topic+plot.gm.prcomp">plot.gm.prcomp</a></code>, <code><a href="geomorph.html#topic+geomorph">geomorph</a></code>, <code><a href="#topic+eigensound">eigensound</a></code>, <code><a href="#topic+pca.plot">pca.plot</a></code>
</p>
<p>Useful links:
</p>

<ul>
<li><p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li><p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(eig.sample)

# PCA using three-dimensional semilandmark coordinates
pca.eig.sample &lt;- stats::prcomp(geomorph::two.d.array(eig.sample))

# Verify names for each acoustic unit and the order in which they appear
dimnames(eig.sample)[[3]]

# Create factor to use as groups in subsequent ordination plot
sample.gr &lt;- factor(c(rep("centralis", 3), rep("cuvieri", 3), rep("kroyeri", 3)))

# Clear current R plot to prevent errors
grDevices::dev.off()

# Plot result of Principal Components Analysis
pca.plot(PCA.out = pca.eig.sample, groups = sample.gr, conv.hulls = sample.gr,
         main="PCA of 3D coordinates", leg=TRUE, leg.pos = "top")

# Verify hypothetical sound surfaces using hypo.surf
hypo.surf(threeD.out=eig.sample, PC=1, flim=c(0, 4), tlim=c(0, 0.8), x.length=70, y.length=47)


</code></pre>

<hr>
<h2 id='kroyeri'>Vocalization of the frog <em>Physalaemus kroyeri</em></h2><span id='topic+kroyeri'></span>

<h3>Description</h3>

<p>Recording of a series of three stereotyped calls emitted by a male frog <em>Physalaemus kroyeri</em> (Amphibia, Anura, Leptodactylidae). Edited from original <code>".wav"</code> file for optimal sinal to noise ratio and reduced time duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(kroyeri)
</code></pre>


<h3>Format</h3>

<p>An object of the class <code>"Wave"</code> (<code><a href="tuneR.html#topic+tuneR">tuneR</a></code> package).
</p>


<h3>Details</h3>

<p>Duration = 3.91 s. Sampling Frequency = 44100 Hz.
</p>
<p>Recorded at Ilhéus Municipality, Bahia State, Brazil, on 05 August 1972. Air temperature 24ºC.
</p>


<h3>Source</h3>

<p>Original recording housed at Fonoteca Neotropical Jacques Vielliard (FNJV-0032047). Recorded by Werner Bokermann.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kroyeri)

seewave::oscillo(kroyeri)
seewave::spectro(kroyeri)
threeDspectro(kroyeri,tlim=c(0, 1), flim=c(0, 4), samp.grid=FALSE, dBlevel=25)
</code></pre>

<hr>
<h2 id='pca.plot'>Plot ordination of Principal Components with convex hulls</h2><span id='topic+pca.plot'></span>

<h3>Description</h3>

<p>Ordination of Principal Components from the output of a Principal Components Analysis performed by <code><a href="stats.html#topic+prcomp">prcomp</a></code> function (<code><a href="stats.html#topic+stats">stats</a></code> package). Require a <code>factor</code> object with <code>groups</code>, which enable the plot to feature colored groups and convex hulls (if desired).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pca.plot(
  PCA.out = NULL,
  groups = NULL,
  col.gp = grDevices::rainbow(length(levels(groups))),
  conv.hulls = NULL,
  col.conv = grDevices::rainbow(length(levels(conv.hulls))),
  PCs = c(1, 2),
  main = "Ordination of PCA coordinates",
  sp.as = "points",
  sp.text = NULL,
  cross.origin = TRUE,
  lwd = 1,
  lty = "dotted",
  leg = TRUE,
  leg.labels = groups,
  leg.pos = "topright",
  cex.leg = 1,
  cex = 1,
  cex.axis = 1,
  cex.lab = 1,
  cex.main = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pca.plot_+3A_pca.out">PCA.out</code></td>
<td>
<p>the output of a Principal Components Analysis performed by <code><a href="stats.html#topic+prcomp">prcomp</a></code> (<code><a href="stats.html#topic+stats">stats</a></code> package). By default: <code>PCA.out = NULL</code> (i.e. output must be specified before ploting)</p>
</td></tr>
<tr><td><code id="pca.plot_+3A_groups">groups</code></td>
<td>
<p>groups to use as colors and/or convex hulls. Must be a <code>factor</code> object with the same length as the number of rows in the coordinates of <code>PCA.out</code> (i.e. <code>length(groups) == nrow(PCA.out$x)</code>). By default: <code>groups = NULL</code> (i.e. <code>factor</code> must be specified before ploting)</p>
</td></tr>
<tr><td><code id="pca.plot_+3A_col.gp">col.gp</code></td>
<td>
<p>a <code>factor</code> object with the colours intended for <code>groups</code>. Must be the same length as the number of levels from <code>groups</code> (i.e. <code>length(col.gp) == length(levels(groups))</code>). By default: <code>col.gp = grDevices::rainbow(length(levels(groups)))</code> (i.e. colors defined automatically)</p>
</td></tr>
<tr><td><code id="pca.plot_+3A_conv.hulls">conv.hulls</code></td>
<td>
<p>groups to use for convex hulls. Must be a <code>factor</code> object with the same length as the number of rows in the coordinates of <code>PCA.out</code> (i.e. <code>length(conv.hulls) == nrow(PCA.out$x)</code>). By default: <code>conv.hulls = NULL</code> (i.e. plot without convex hulls)</p>
</td></tr>
<tr><td><code id="pca.plot_+3A_col.conv">col.conv</code></td>
<td>
<p>a <code>factor</code> object with the colours intended for <code>conv.hulls</code>. Must be the same length as the number of levels in <code>conv.hulls</code> (i.e. <code>length(col.conv) == length(levels(conv.hulls))</code>). By default: <code>col.conv = grDevices::rainbow(length(levels(conv.hulls)))</code> (i.e. colors defined automatically)</p>
</td></tr>
<tr><td><code id="pca.plot_+3A_pcs">PCs</code></td>
<td>
<p>a vector of length two with the Principal Components intended for the plot. By default: <code>PCs = c(1, 2)</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_main">main</code></td>
<td>
<p>main title of output plot. Should be presented between quotation marks. By default: <code>main = "Ordination of PCA coordinates"</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_sp.as">sp.as</code></td>
<td>
<p>enables one to choose between ploting elements as <code>"points"</code> or <code>"text"</code>. If <code>sp.as = "text"</code>, also input a <code>factor</code> of characters to use as text (i.e. <code>sp.text</code>). By default: <code>sp.as = "points"</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_sp.text">sp.text</code></td>
<td>
<p>only applies when <code>sp.as = "text"</code>. A <code>factor</code> including elements as texts intended in the plot. Has to be the same length as the number of rows in the coordinates of <code>PCA.out</code> (i.e. <code>length(sp.text) == nrow(PCA.out$x)</code>) . By default: <code>sp.text = NULL</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_cross.origin">cross.origin</code></td>
<td>
<p>A logical. If <code>TRUE</code>, the ordination plot will include lines crossing at the origin (i.e. x = 0, y = 0). By default: <code>cross.origin = TRUE</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_lwd">lwd</code></td>
<td>
<p>only applies when <code>cross.origin = TRUE</code>. The width for lines crossing at the origin. Same as in <code><a href="graphics.html#topic+par">par</a></code>. By default: <code>lwd = 1</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_lty">lty</code></td>
<td>
<p>only applies when <code>cross.origin = TRUE</code>. The type of lines crossing at the origin. Same as in <code><a href="graphics.html#topic+par">par</a></code>: &quot;Line types can either be specified as an integer (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash) or as one of the character strings &quot;blank&quot;, &quot;solid&quot;, &quot;dashed&quot;, &quot;dotted&quot;, &quot;dotdash&quot;, &quot;longdash&quot;, or &quot;twodash&quot;, where &quot;blank&quot; uses ‘invisible lines’ (i.e., does not draw them).&quot; By default: <code>lty = "dotted"</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_leg">leg</code></td>
<td>
<p>a logical. If <code>TRUE</code>, a legend is added to plot. By default: <code>leg = TRUE</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_leg.labels">leg.labels</code></td>
<td>
<p>only applies when <code>leg = TRUE</code>. Must be the same length of levels in <code>groups</code> (i.e. <code>length(leg.labels) == length(levels(groups))</code>). By default: <code>leg.labels = groups</code> (i.e. labels will be the same as the levels from <code>groups</code>)</p>
</td></tr>
<tr><td><code id="pca.plot_+3A_leg.pos">leg.pos</code></td>
<td>
<p>only applies when <code>leg = TRUE</code>. Specify legend location in the plot by using a keyword from the list: <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and <code>"center"</code>. Alternatively, a single value can be provided and used for both margins, or two values, in which the first is used for X distance, and the second for Y distance. See also <code><a href="graphics.html#topic+legend">legend</a></code> for details. By default: <code>leg.pos = "topright"</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_cex.leg">cex.leg</code></td>
<td>
<p>only applies when <code>leg = TRUE</code>. The magnification to be used in the legend. By default: <code>cex.leg = 1</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_cex">cex</code></td>
<td>
<p>same as in <code><a href="graphics.html#topic+par">par</a></code>: &quot;A numerical value giving the amount by which plotting text and symbols should be magnified relative to the default&quot;. By default: <code>cex = 1</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>same as in <code><a href="graphics.html#topic+par">par</a></code>. Relative to <code>cex</code>. The magnification to be used for axis annotation. By default: <code>cex.axix = 1</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_cex.lab">cex.lab</code></td>
<td>
<p>same as in <code><a href="graphics.html#topic+par">par</a></code>. Relative to <code>cex</code>. The magnification to be used for x and y labels. By default: <code>cex.lab = 1</code></p>
</td></tr>
<tr><td><code id="pca.plot_+3A_cex.main">cex.main</code></td>
<td>
<p>same as in <code><a href="graphics.html#topic+par">par</a></code>. Relative to <code>cex</code>. The magnification to be used for main title. By default: <code>cex.main = 1</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Require the output of <code><a href="stats.html#topic+prcomp">prcomp</a></code> and a vector with <code>groups</code> to plot. In addition, it is also possible to include convex hulls around each group (i.e. <code>conv.hulls</code>) and to control the colors intended for each group (i.e. <code>col.gp</code>) and for each convex hull (i.e. <code>col.conv</code>).
</p>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+prcomp">prcomp</a></code>, <code><a href="grDevices.html#topic+palette">palette</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>, <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>, <code><a href="graphics.html#topic+legend">legend</a></code>
</p>
<p>Useful links:
</p>

<ul>
<li><p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li><p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(eig.sample)

# PCA using 3D semilandmark coordinates
pca.eig.sample &lt;- stats::prcomp(geomorph::two.d.array(eig.sample))

# Verify names for each acoustic unit and the order in which they appear
dimnames(eig.sample)[[3]]

# Create factor to use as groups in subsequent ordination plot
sample.gr &lt;- factor(c(rep("centralis", 3), rep("cuvieri", 3), rep("kroyeri", 3)))

# Clear current R plot to prevent errors
grDevices::dev.off()

# Plot result of Principal Components Analysis
pca.plot(PCA.out = pca.eig.sample, groups = sample.gr, conv.hulls = sample.gr,
         main="PCA of 3D coordinates", leg=TRUE, leg.pos = "top")

</code></pre>

<hr>
<h2 id='raven.list'>Sample of tables containing selection boxes from Raven Pro software</h2><span id='topic+raven.list'></span>

<h3>Description</h3>

<p>This sample file features a list of three <code>data.frame</code> objects containing the selection boxes for the acoustic units of <code><a href="#topic+centralis">centralis</a></code>, <code><a href="#topic+cuvieri">cuvieri</a></code> and <code><a href="#topic+kroyeri">kroyeri</a></code>. The selection was performed manually using <a href="https://ravensoundsoftware.com/software/raven-pro/">Raven Pro</a> software, which is commonplace in bioacoustic analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(raven.list)
</code></pre>


<h3>Format</h3>

<p>An object of the class <code>"list"</code> (<code><a href="base.html#topic+base">base</a></code> package).
</p>


<h3>Details</h3>

<p>This sample list was built to illustrate the usage of <code><a href="#topic+raven.to.wave">raven.to.wave</a></code> function.
Each <code>data.frame</code> in the list represent selection boxes from <a href="https://ravensoundsoftware.com/software/raven-pro/">Raven Pro</a> software featuring either <code><a href="#topic+centralis">centralis</a></code>, <code><a href="#topic+cuvieri">cuvieri</a></code> or <code><a href="#topic+kroyeri">kroyeri</a></code> samples. These, in turn, are acoustic recordings containing three stereotyped calls emitted by a male frog <em>Physalaemus cuvieri</em>, <em>P. centralis</em> or <em>P. kroyeri</em>  (Amphibia, Anura, Leptodactylidae), respectively.
</p>


<h3>Source</h3>

<p>Sample data of <code>"Wave"</code> objects:
</p>

<ul>
<li><p><code><a href="#topic+centralis">centralis</a></code>: Advertisement call of <em>Physalaemus centralis</em>; original recording housed at Fonoteca Neotropical Jacques Vielliard (FNJV-0031188). Recorded by Adão José Cardoso.
</p>
</li>
<li><p><code><a href="#topic+cuvieri">cuvieri</a></code>: Advertisement call of <em>Physalaemus cuvieri</em>; original recording housed at Coleção Bioacústica da Universidade Federal de Minas Gerais (CBUFMG-00196). Recorded by Pedro Rocha.
</p>
</li>
<li><p><code><a href="#topic+kroyeri">kroyeri</a></code>: Advertisement call of <em>Physalaemus kroyeri</em>; Original recording housed at Fonoteca Neotropical Jacques Vielliard (FNJV-0032047). Recorded by Werner Bokermann.
</p>
</li></ul>



<h3>References</h3>

<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+raven.to.wave">raven.to.wave</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#  Create folders on your console  #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Create temporary folder to store original ".wav" files containing multiple units
orig.wav &lt;- file.path(base::tempdir(), "original wave")
if(!dir.exists(orig.wav)) dir.create(orig.wav)

# Create temporary folder to store sample ".wav" files from original recordings
wav.at &lt;- file.path(base::tempdir(), "wav samples")
if(!dir.exists(wav.at)) dir.create(wav.at)

# Create temporary folder to store results
store.at &lt;- file.path(base::tempdir(), "output")
if(!dir.exists(store.at)) dir.create(store.at)


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#   Select acoustic units based on Raven Pro selections   #
#                                                         #
#              Using raven.to.wave function                #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Export original sample ".wav" files from SoundShape examples
tuneR::writeWave(centralis, extensible = TRUE,
                filename = file.path(orig.wav, "centralis.wav"))
tuneR::writeWave(cuvieri, extensible = TRUE,
                filename = file.path(orig.wav, "cuvieri.wav"))
tuneR::writeWave(kroyeri, extensible = TRUE,
                filename = file.path(orig.wav, "kroyeri.wav"))

# Store Raven Pro selection tables at same folder from original ".wav" files
for(i in 1:length(raven.list)){
 write.table(raven.list[i], file=file.path(orig.wav, names(raven.list)[i]),
               quote=FALSE, sep="\t", row.names = FALSE,
               col.names = colnames(raven.list[[i]]))  } # end loop


# Verify if folder has both original ".wav" files and Raven's selections
dir(orig.wav)

###
## Start here when using your own recordings

# Export a ".wav" sample for each selection made in Raven Pro
raven.to.wave(orig.wav.folder = orig.wav, wav.samples = wav.at)

# Verify samples
dir(wav.at)


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#  Align acoustic units using align.wave  #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Place sounds at the beginning of a sound window
align.wave(wav.at=wav.at, wav.to="Aligned",
          time.length = 0.8, time.perc = 0.005, dBlevel = 25)

# Verify alignment using analysis.type = "twoDshape"
eigensound(analysis.type = "twoDshape", wav.at = file.path(wav.at, "Aligned"),
          dBlevel = 25, store.at=store.at, plot.exp=TRUE,
          flim=c(0, 4), tlim=c(0, 0.8), add.contour = TRUE)
# Go to folder specified by store.at and check jpeg files created
# If alignment/window dimensions are not ideal, repeat the process with new settings



</code></pre>

<hr>
<h2 id='raven.to.wave'>Export sample <code>".wav"</code> files using selections from Raven Pro software.</h2><span id='topic+raven.to.wave'></span>

<h3>Description</h3>

<p>Create one <code>".wav"</code> file for each selection created using <a href="https://ravensoundsoftware.com/software/raven-pro/">Raven Pro</a> software, which is commonplace in bioacoustical analysis. Each selection (i.e. line in table) should represent an acoustic unit from the sample study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raven.to.wave(
  orig.wav.folder = NULL,
  raven.at = orig.wav.folder,
  wav.samples = "wav samples"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raven.to.wave_+3A_orig.wav.folder">orig.wav.folder</code></td>
<td>
<p>filepath to the folder where original <code>".wav"</code> files are stored. Should be presented between quotation marks. By default: <code>orig.wav.folder = NULL</code> (i.e. user must specify the filepath to <code>".wav"</code> files)</p>
</td></tr>
<tr><td><code id="raven.to.wave_+3A_raven.at">raven.at</code></td>
<td>
<p>filepath to the folder where selection tables from <a href="https://ravensoundsoftware.com/software/raven-pro/">Raven Pro</a> software are stored. Should be presented between quotation marks. File name should end with <code>"selections.txt"</code>. By default: <code>raven.at = orig.wav.folder</code> (i.e. raven tables stored in the same folder as original  <code>".wav"</code> files)</p>
</td></tr>
<tr><td><code id="raven.to.wave_+3A_wav.samples">wav.samples</code></td>
<td>
<p>folder where new <code>".wav"</code> files will be stored. Can be either a filepath to the intended folder, or the name of the folder i.e.(<code>wav.samples = "wav samples"</code>). In the later case, a new folder will be created within the one specified by <code>orig.wav.folder</code>. Should be presented between quotation marks. By default: <code>wav.samples = "wav samples"</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+align.wave">align.wave</a></code>, <code><a href="#topic+raven.list">raven.list</a></code>,
</p>
<p>Useful links:
</p>

<ul>
<li><p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li><p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a>
</p>
</li>
<li><p>Raven Pro software <a href="https://ravensoundsoftware.com/software/raven-pro/">https://ravensoundsoftware.com/software/raven-pro/</a></p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#  Create folders on your console  #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Create temporary folder to store original ".wav" files containing multiple units
orig.wav &lt;- file.path(base::tempdir(), "original wave")
if(!dir.exists(orig.wav)) dir.create(orig.wav)

# Create temporary folder to store sample ".wav" files from original recordings
wav.at &lt;- file.path(base::tempdir(), "wav samples")
if(!dir.exists(wav.at)) dir.create(wav.at)

# Create temporary folder to store results
store.at &lt;- file.path(base::tempdir(), "output")
if(!dir.exists(store.at)) dir.create(store.at)


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#   Select acoustic units based on Raven Pro selections   #
#                                                         #
#              Using raven.to.wav function                #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Export original sample ".wav" files from SoundShape examples
tuneR::writeWave(centralis, extensible = TRUE,
                filename = file.path(orig.wav, "centralis.wav"))
tuneR::writeWave(cuvieri, extensible = TRUE,
                filename = file.path(orig.wav, "cuvieri.wav"))
tuneR::writeWave(kroyeri, extensible = TRUE,
                filename = file.path(orig.wav, "kroyeri.wav"))

# Store Raven Pro selection tables at same folder from original ".wav" files
for(i in 1:length(raven.list)){
 write.table(raven.list[i], file=file.path(orig.wav, names(raven.list)[i]),
               quote=FALSE, sep="\t", row.names = FALSE,
               col.names = colnames(raven.list[[i]]))  } # end loop


# Verify if folder has both original ".wav" files and Raven's selections
dir(orig.wav)

###
## Start here when using your own recordings

# Export a ".wav" sample for each selection made in Raven Pro
raven.to.wave(orig.wav.folder = orig.wav, wav.samples = wav.at)

# Verify samples
dir(wav.at)


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#  Align acoustic units using align.wave  #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

# Place sounds at the beginning of a sound window
align.wave(wav.at=wav.at, wav.to="Aligned",
          time.length = 0.8, time.perc = 0.005, dBlevel = 25)

# Verify alignment using analysis.type = "twoDshape"
eigensound(analysis.type = "twoDshape", wav.at = file.path(wav.at, "Aligned"),
          dBlevel = 25, store.at=store.at, plot.exp=TRUE,
          flim=c(0, 4), tlim=c(0, 0.8), add.contour = TRUE)
# Go to folder specified by store.at and check jpeg files created
# If alignment/window dimensions are not ideal, repeat process with new settings




</code></pre>

<hr>
<h2 id='threeDspectro'>3D spectrogram plots from <code>"Wave"</code> objects</h2><span id='topic+threeDspectro'></span>

<h3>Description</h3>

<p>Create 3D spectrograms from a single object of class <code>"Wave"</code>.
</p>
<p>This function works similarly as <code><a href="seewave.html#topic+spectro">spectro</a></code> (<code><a href="seewave.html#topic+seewave">seewave</a></code> package), with spectrogram data internally computed by <code><a href="seewave.html#topic+spectro">spectro</a></code>. However, the 3D plot is generated by <code><a href="plot3D.html#topic+persp3D">persp3D</a></code> (<code><a href="plot3D.html#topic+plot3D">plot3D</a></code> package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threeDspectro(
  wave,
  tlim = NULL,
  flim = NULL,
  samp.grid = FALSE,
  plot.type = "surface",
  along = "x",
  skip.lines = 5,
  space.lines = 0.6,
  x.length = 100,
  y.length = 70,
  lwd = 0.1,
  plot.exp = FALSE,
  log.scale = FALSE,
  cex = 0.5,
  cex.axis = 0.5,
  cex.lab = 0.9,
  cex.main = 1,
  store.at = NULL,
  plot.as = "jpeg",
  color = seewave::spectro.colors(80),
  f = 44100,
  wl = 512,
  ovlp = 70,
  dBlevel = 30,
  resfac = 1,
  rotate.Xaxis = 60,
  rotate.Yaxis = 40,
  main = "Spectrogram 3D",
  scalelab = expression("Amplitude (dB)"),
  colkey = list(plot = TRUE, cex.clab = 0.8, cex.axis = 1, side = 4, length = 1, width =
    1, labels = TRUE, tick = TRUE, lty = 1, lwd = 1, lwd.ticks = 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="threeDspectro_+3A_wave">wave</code></td>
<td>
<p>an <code>R</code> object of the class <code>"Wave"</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_tlim">tlim</code></td>
<td>
<p>modifications of the time limits (X-axis). Vector with two values in seconds. By default: <code>tlim = NULL</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_flim">flim</code></td>
<td>
<p>modifications of the frequency limits (Y-axis). Vector with two values in kHz. By default: <code>flim = NULL</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_samp.grid">samp.grid</code></td>
<td>
<p>a logical. If <code>TRUE</code>, a sampling grid with dimensions <code>x.length</code> and <code>y.length</code> is applied over the three-dimensional surface. An amplitude value is collected at each node in the grid and a new matrix of amplitude coordinates is used in the plot. Recommended for faster plots and as protocol for error verification in point acquisition. See also <code>plot.type</code>. By default: <code>samp.grid = FALSE</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_plot.type">plot.type</code></td>
<td>
<p>allows the choice between <code>"lines"</code>, <code>"surface"</code> or <code>"points"</code>. Beware that <code>"points"</code> only applies when <code>samp.grid = TRUE</code>. <code>plot.type = "surface"</code> will produce a simplified 3D spectrogram surface using the amplitude values colected by the sampling grid (same output employed by MacLeod et al., 2013). <code>plot.type = "points"</code> will produce 3D graphs with semilandmarks as points. <code>plot.type = "lines"</code> will generate profile lines along X or Y-axis (see argument <code>along</code>). Number and space between lines are controled by arguments <code>skip.lines</code> and <code>space.lines</code>, respectively. By default: <code>plot.type = "surface"</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_along">along</code></td>
<td>
<p>only applies when <code>plot.type = "lines"</code>. Lines along X or Y-axis (<code>"x"</code> or <code>"y"</code>). By default: <code>along = "x"</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_skip.lines">skip.lines</code></td>
<td>
<p>only applies when <code>plot.type = "lines"</code>. How many lines to skip between each plotted line. Larger numbers imply on less lines plotted. By default: <code>skip.lines = 5</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_space.lines">space.lines</code></td>
<td>
<p>only applies when <code>plot.type = "lines"</code>. Controls the space between lines, which makes lines wider or narrower. Has to be a number between 0.1 and 0.9. By default: <code>space.lines = 0.6</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_x.length">x.length</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code>. Length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the time (X-axis).  By default: <code>x.length = 100</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_y.length">y.length</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code>. Length of sequence (i.e. number of cells per side on sound window) to be used as sampling grid coordinates on the frequency (Y-axis). By default: <code>y.length = 70</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_lwd">lwd</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code> and <code>plot.type = "surface"</code>. Similarly as in <code><a href="graphics.html#topic+par">par</a></code>, intended line width for sampling grid. By default: <code>lwd = 0.1</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_plot.exp">plot.exp</code></td>
<td>
<p>a logical. If <code>TRUE</code>, 3D spectrogram plot from <code>wave</code> object is exported and stored on the folder indicated by <code>store.at</code>. By default: <code>plot.exp = FALSE</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_log.scale">log.scale</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code>. A logical. If <code>TRUE</code>, <code>threeDspectro</code> will use a logarithmic scale on the time (X-axis), which is recommeded when the analyzed sounds present great variation on this axis (e.g. emphasize short duration sounds). If <code>FALSE</code>, a linear scale is used instead (same as MacLeod et al., 2013). By default: <code>log.scale = FALSE</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_cex">cex</code></td>
<td>
<p>only applies when <code>samp.grid = TRUE</code> and <code>plot.type = "points"</code>. Similarly as in <code><a href="graphics.html#topic+par">par</a></code>, intended size for points. By default: <code>cex = 0.5</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Similarly as in <code><a href="graphics.html#topic+par">par</a></code>, the magnification to be used for axis annotation. By default: <code>cex.axis = 0.5</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_cex.lab">cex.lab</code></td>
<td>
<p>Similarly as in <code><a href="graphics.html#topic+par">par</a></code>, the magnification to be used for x and y labels. By default: <code>cex.lab = 0.9</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_cex.main">cex.main</code></td>
<td>
<p>Similarly as in <code><a href="graphics.html#topic+par">par</a></code>, the magnification to be used for main titles. By default: <code>cex.main = 1</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_store.at">store.at</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. Filepath to the folder where 3D plot will be stored. Should be presented between quotation marks. By default: <code>store.at = NULL</code> (i.e. user must specify the filepath where spectrogram plots will be stored)</p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_plot.as">plot.as</code></td>
<td>
<p>only applies when <code>plot.exp = TRUE</code>. <code>plot.as = "jpeg"</code> will generate compressed images for quick inspection; <code>plot.as = "tiff"</code> or <code>"tif"</code> will generate uncompressed high resolution images that can be edited and used for publication. By default: <code>plot.as = "jpeg"</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_color">color</code></td>
<td>
<p>Color palette to be used for the amplitude (Z-axis). Same default as <code><a href="seewave.html#topic+spectro">spectro</a></code>: <code>color=spectro.colors(80)</code>. See also <code>Details</code> section.</p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_f">f</code></td>
<td>
<p>sampling frequency of <code>Wave</code> object (in Hz). By default: <code>f = 44100</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_wl">wl</code></td>
<td>
<p>length of the window for spectrogram calculation. By default: <code>wl = 512</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_ovlp">ovlp</code></td>
<td>
<p>overlap between two successive windows (in %) for increased spectrogram resolution. By default: <code>ovlp = 70</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_dblevel">dBlevel</code></td>
<td>
<p>absolute amplitude value to be used as relative background on 3D plot. Same as <code>dBlevel</code> from <code><a href="#topic+eigensound">eigensound</a></code> and <code><a href="#topic+align.wave">align.wave</a></code>. By default: <code>dBlevel = 30</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_resfac">resfac</code></td>
<td>
<p>resolution factor, in which an value &gt; 1 will increase the resolution. Can be one value or a vector of two numbers, for the x and y values, respectively. <strong>Note:</strong> Same as in <code><a href="plot3D.html#topic+persp3D">persp3D</a></code> (<code><a href="plot3D.html#topic+plot3D">plot3D</a></code> package). By default: <code>resfac = 1</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_rotate.xaxis">rotate.Xaxis</code></td>
<td>
<p>rotation of the X-axis. Same as <code>theta</code> from <code><a href="plot3D.html#topic+persp3D">persp3D</a></code> (<code><a href="plot3D.html#topic+plot3D">plot3D</a></code> package). By default: <code>rotate.Xaxis = 60</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_rotate.yaxis">rotate.Yaxis</code></td>
<td>
<p>rotation of the Y-axis. Same as <code>phi</code> from <code><a href="plot3D.html#topic+persp3D">persp3D</a></code> (<code><a href="plot3D.html#topic+plot3D">plot3D</a></code> package). By default: <code>rotate.Yaxis = 40</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_main">main</code></td>
<td>
<p>main title of output plot. Should be presented between quotation marks. By default: <code>main = "3D spectrogram"</code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_scalelab">scalelab</code></td>
<td>
<p>Similarly as <code><a href="plot3D.html#topic+plot3D">plot3D</a></code>, the label to be written on top of the color key. Should be a character string wrapped by <code>expression()</code>. By default: <code>scalelab = expression("Amplitude (dB)")</code>. See also <code><a href="plot3D.html#topic+colkey">colkey</a></code></p>
</td></tr>
<tr><td><code id="threeDspectro_+3A_colkey">colkey</code></td>
<td>
<p>Similarly as <code><a href="plot3D.html#topic+plot3D">plot3D</a></code>, a list with parameters for the color key (legend). By default: <code>colkey = list(plot = TRUE, cex.clab = 0.8, cex.axis = 1, side = 4, length = 1, width = 1, labels = TRUE, tick = TRUE, lty = 1, lwd = 1, lwd.ticks = 1)</code>. See also <code><a href="plot3D.html#topic+colkey">colkey</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similarly as <code><a href="seewave.html#topic+spectro">spectro</a></code> (<code><a href="seewave.html#topic+seewave">seewave</a></code> package), any colour palette can be used to describe the amplitude (Z-axis). Some suggestions: <code>seewave::temp.colors, seewave::spectro.colors, seewave::reverse.heat.colors, seewave::reverse.cm.colors, seewave::reverse.topo.colors, grDevices::cm.colors, grDevices::grey.colors, grDevices::heat.colors, grDevices::topo.colors</code>.
</p>


<h3>Author(s)</h3>

<p>Pedro Rocha
</p>


<h3>References</h3>

<p>MacLeod, N., Krieger, J. &amp; Jones, K. E. (2013). Geometric morphometric approaches to acoustic signal analysis in mammalian biology. <em>Hystrix, the Italian Journal of Mammalogy, 24</em>(1), 110-125.
</p>
<p>Rocha, P. &amp; Romano, P. (2021) The shape of sound: A new <code>R</code> package that crosses the bridge between Bioacoustics and Geometric Morphometrics. <em>Methods in Ecology and Evolution, 12</em>(6), 1115-1121.
</p>


<h3>See Also</h3>

<p><code><a href="seewave.html#topic+spectro">spectro</a></code>, <code><a href="seewave.html#topic+seewave">seewave</a></code>, <code><a href="#topic+eigensound">eigensound</a></code>, <code><a href="#topic+align.wave">align.wave</a></code>, <code><a href="plot3D.html#topic+persp3D">persp3D</a></code>, <code><a href="plot3D.html#topic+plot3D">plot3D</a></code>, <code><a href="#topic+align.wave">align.wave</a></code>
</p>
<p>Useful links:
</p>

<ul>
<li><p><a href="https://github.com/p-rocha/SoundShape">https://github.com/p-rocha/SoundShape</a>
</p>
</li>
<li><p>Report bugs at <a href="https://github.com/p-rocha/SoundShape/issues">https://github.com/p-rocha/SoundShape/issues</a></p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

# As simple as this
threeDspectro(centralis)
threeDspectro(cuvieri)
threeDspectro(kroyeri)

# Controling some arguments
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4))
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4), dBlevel=50)

# As points
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4),
              samp.grid=TRUE, plot.type="points")
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4),
              samp.grid=TRUE, plot.type="points", x.length = 20, y.length = 50)

# As lines
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4), plot.type = "lines")
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4),
              plot.type = "lines", along="y")
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4),
              plot.type = "lines", along="y", skip.lines=18, space.lines=0.8)

# Try different colors
threeDspectro(cuvieri, color=seewave::reverse.terrain.colors(80),
              samp.grid=FALSE, tlim=c(0, 0.5), flim=c(0, 4))
threeDspectro(cuvieri, color=seewave::reverse.cm.colors(80),
              samp.grid=FALSE, tlim=c(0, 0.5), flim=c(0, 4))
threeDspectro(cuvieri, color=grDevices::heat.colors(80),
              samp.grid=FALSE, tlim=c(0, 0.5), flim=c(0, 4))

# Rotation
threeDspectro(cuvieri, tlim=c(0, 0.5), flim=c(0, 4), rotate.Xaxis=40, rotate.Yaxis=50)

# Export your graph
threeDspectro(cuvieri, plot.exp=TRUE, store.at=tempdir(), tlim=c(0,0.5), flim=c(0,4))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
