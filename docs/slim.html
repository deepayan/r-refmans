<!DOCTYPE html><html lang="en"><head><title>Help for package slim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {slim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#slim-package'><p>Singular linear models for longitudinal data.</p></a></li>
<li><a href='#coef.slim'><p>Extract Model Coefficients from Singular Linear Model</p></a></li>
<li><a href='#compute_laurent'><p>Laurent Expansion of Inverse of Linear Matrix Function</p></a></li>
<li><a href='#confint.slim'><p>Confidence Intervals for Model Parameters from Singular Linear Model</p></a></li>
<li><a href='#dialysis'><p>Renal Function in Three Groups of Peritoneal Dialysis Patients</p></a></li>
<li><a href='#fit_slim'><p>Fitter Function for Singular Linear Models</p></a></li>
<li><a href='#fitted.slim'><p>Extract Model Fitted Values from Singular Linear Model</p></a></li>
<li><a href='#list_covariances'><p>List Covariance Matrices for Every Subject</p></a></li>
<li><a href='#predict.slim'><p>Model Predictions from Singular Linear Model</p></a></li>
<li><a href='#print.slim'><p>Print 'slim' Objects</p></a></li>
<li><a href='#residuals.slim'><p>Extract Model Residuals from Singular Linear Model</p></a></li>
<li><a href='#slim'><p>Fit Singular Linear Models</p></a></li>
<li><a href='#slim.methods'><p>Methods for Singular Linear Model Fits</p></a></li>
<li><a href='#summary.slim'><p>Summarizing Singular Linear Model Fits</p></a></li>
<li><a href='#vcov.slim'><p>Extract Variance-Covariance Matrix from a 'slim' Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Singular Linear Models for Longitudinal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits singular linear models to longitudinal data. Singular linear
    models are useful when the number, or timing, of longitudinal observations
    may be informative about the observations themselves. They are described
    in Farewell (2010) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fasp068">doi:10.1093/biomet/asp068</a>&gt;, and are extensions of the
    linear increments model &lt;<a href="https://doi.org/10.1111%2Fj.1467-9876.2007.00590.x">doi:10.1111/j.1467-9876.2007.00590.x</a>&gt; to general
    longitudinal data.   </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), data.table (&ge; 1.9.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, MASS (&ge; 7.3)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lme4 (&ge; 1.1), jmcm (&ge; 0.1.6.0), gee (&ge; 4.13-19), ggplot2
(&ge; 2.1.0), testthat (&ge; 1.0.2), knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-05-15 06:33:18 UTC; daniel</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Farewell [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Farewell &lt;farewelld@cf.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-05-15 06:39:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='slim-package'>Singular linear models for longitudinal data.</h2><span id='topic+slim-package'></span>

<h3>Description</h3>

<p>The slim package fits singular linear models to longitudinal data. Singular
linear models are useful when the number, or timing, of longitudinal
observations may be informative about the observations themselves. They are
described in Farewell (2010) &lt;doi:10.1093/biomet/asp068&gt;, and are extensions
of the linear increments model of Diggle et al. (2007)
&lt;doi:10.1111/j.1467-9876.2007.00590.x&gt; to general longitudinal data.
</p>


<h3>Details</h3>

<p>The most important function is slim, whose formula interface is similar to
that of lm.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slim">slim</a></code>
</p>

<hr>
<h2 id='coef.slim'>Extract Model Coefficients from Singular Linear Model</h2><span id='topic+coef.slim'></span>

<h3>Description</h3>

<p>Extract Model Coefficients from Singular Linear Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slim'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.slim_+3A_object">object</code></td>
<td>
<p>an object of class 'slim', usually, a result of a call to
'slim'.</p>
</td></tr>
<tr><td><code id="coef.slim_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of model coefficients.
</p>

<hr>
<h2 id='compute_laurent'>Laurent Expansion of Inverse of Linear Matrix Function</h2><span id='topic+compute_laurent'></span>

<h3>Description</h3>

<p>This function computes the first two terms of the Laurent expansion of the
inverse of a linear matrix function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_laurent(V, zapsmall = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_laurent_+3A_v">V</code></td>
<td>
<p>for some integer m &gt;= 1, an array of dimension (m, m, 2), where V[,
, 1] is the intercept and V[, , 2] is the slope of the linear matrix
function.</p>
</td></tr>
<tr><td><code id="compute_laurent_+3A_zapsmall">zapsmall</code></td>
<td>
<p>logical: should zapsmall be called on the result? Default TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>array of dimension (m, m, 2), where W[, , 1] corresponds to the
exponent -1, and W[, , 2] corresponds to the exponent 0.
</p>

<hr>
<h2 id='confint.slim'>Confidence Intervals for Model Parameters from Singular Linear Model</h2><span id='topic+confint.slim'></span>

<h3>Description</h3>

<p>Confidence Intervals for Model Parameters from Singular Linear Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slim'
confint(object, parm, level = 0.95, empirical = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.slim_+3A_object">object</code></td>
<td>
<p>an object of class 'slim', usually, a result of a call to
'slim'.</p>
</td></tr>
<tr><td><code id="confint.slim_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
confidence intervals, either a vector of numbers or a vector of
names.  If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.slim_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.slim_+3A_empirical">empirical</code></td>
<td>
<p>logical indicating if empirical variances of y should be
used in estimating standard errors (the default). Empirical standard errors
should be used unless covariances have been well modelled.</p>
</td></tr>
<tr><td><code id="confint.slim_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix (or vector) with columns giving lower and upper confidence
limits for each parameter.
</p>

<hr>
<h2 id='dialysis'>Renal Function in Three Groups of Peritoneal Dialysis Patients</h2><span id='topic+dialysis'></span>

<h3>Description</h3>

<p>Longitudinal data on the renal function of 116 patients observed on up to
five different occasions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dialysis
</code></pre>


<h3>Format</h3>

<p>A data.table with 116 rows and 5 variables:
</p>

<table>
<tr>
 <td style="text-align: left;">
id </td><td style="text-align: left;"> patient identifier, a character string </td>
</tr>
<tr>
 <td style="text-align: left;">
group </td><td style="text-align: left;"> treatment group identifier, a character string </td>
</tr>
<tr>
 <td style="text-align: left;">
vintage </td><td style="text-align: left;"> days since starting dialysis, an integer </td>
</tr>
<tr>
 <td style="text-align: left;">
month </td><td style="text-align: left;"> month of observation, an integer </td>
</tr>
<tr>
 <td style="text-align: left;">
renalfn </td><td style="text-align: left;"> renal function of the patient at that month, numeric </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<h3>Source</h3>

<p>This data is derived from the Global Fluid Study. This part of the
study was led by Dr James Chess and Prof. Nick Topley.
</p>


<h3>References</h3>

<p>Lambie, M., Chess, J. et al. (2013). Independent effects of
systemic and peritoneal inflammation on peritoneal dialysis survival. J Am
Soc Nephrol, 24, 2071&ndash;80.
</p>

<hr>
<h2 id='fit_slim'>Fitter Function for Singular Linear Models</h2><span id='topic+fit_slim'></span>

<h3>Description</h3>

<p>This function computes the limiting solution to the estimating equation
sum(x' V^-1 (y - x beta)) = 0 as the covariance V tends from V[, , 1] +
V[, , 2] to V[, , 1].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_slim(x, V, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_slim_+3A_x">x</code></td>
<td>
<p>list of design matrices, one for each subject, all having the same
number of columns.</p>
</td></tr>
<tr><td><code id="fit_slim_+3A_v">V</code></td>
<td>
<p>list of covariance arrays, one for each subject, matching the
dimensions of y.</p>
</td></tr>
<tr><td><code id="fit_slim_+3A_y">y</code></td>
<td>
<p>list of response vectors, one for each subject.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with components coefficients (the limiting solution),
residuals, fitted_values, vcov_empirical and vcov_modelled.
</p>

<hr>
<h2 id='fitted.slim'>Extract Model Fitted Values from Singular Linear Model</h2><span id='topic+fitted.slim'></span>

<h3>Description</h3>

<p>Extract Model Fitted Values from Singular Linear Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slim'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.slim_+3A_object">object</code></td>
<td>
<p>an object of class 'slim', usually, a result of a call to
'slim'.</p>
</td></tr>
<tr><td><code id="fitted.slim_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of fitted values from the model fit.
</p>

<hr>
<h2 id='list_covariances'>List Covariance Matrices for Every Subject</h2><span id='topic+list_covariances'></span><span id='topic+list_covariances.character'></span><span id='topic+list_covariances.list'></span><span id='topic+list_covariances.function'></span><span id='topic+list_covariances.jmcmMod'></span><span id='topic+list_covariances.lmerMod'></span>

<h3>Description</h3>

<p>This function is generic, and methods exists for character, list, function,
and various model fit classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_covariances(obj, t)

## S3 method for class 'character'
list_covariances(obj, t)

## S3 method for class 'list'
list_covariances(obj, t)

## S3 method for class 'function'
list_covariances(obj, t)

## S3 method for class 'jmcmMod'
list_covariances(obj, t)

## S3 method for class 'lmerMod'
list_covariances(obj, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_covariances_+3A_obj">obj</code></td>
<td>
<p>an R object of class character, function, or a model fit</p>
</td></tr>
<tr><td><code id="list_covariances_+3A_t">t</code></td>
<td>
<p>list of vectors of observation times, one for each subject</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing covariance matrices of appropriate dimensions
</p>

<hr>
<h2 id='predict.slim'>Model Predictions from Singular Linear Model</h2><span id='topic+predict.slim'></span>

<h3>Description</h3>

<p>Model Predictions from Singular Linear Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slim'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.slim_+3A_object">object</code></td>
<td>
<p>an object of class 'slim', usually, a result of a call to
'slim'.</p>
</td></tr>
<tr><td><code id="predict.slim_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with
which to predict.  If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predict.slim_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of model predictions.
</p>

<hr>
<h2 id='print.slim'>Print 'slim' Objects</h2><span id='topic+print.slim'></span><span id='topic+print.slim_summary'></span>

<h3>Description</h3>

<p>'print' methods for class 'slim' and 'slim_summary'. 'print.slim_summary'
differs only in its default value of 'empirical'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slim'
print(x, empirical = TRUE, digits = max(3,
  getOption("digits") - 3), signif.stars = getOption("show.signif.stars"),
  ...)

## S3 method for class 'slim_summary'
print(x, empirical = x$empirical, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.slim_+3A_x">x</code></td>
<td>
<p>an object of class 'slim' or 'slim_summary', as appropriate.</p>
</td></tr>
<tr><td><code id="print.slim_+3A_empirical">empirical</code></td>
<td>
<p>logical indicating if empirical variances of y should be
used in estimating standard errors (the default). Empirical standard errors
should be used unless covariances have been well modelled.</p>
</td></tr>
<tr><td><code id="print.slim_+3A_digits">digits</code></td>
<td>
<p>minimal number of <em>significant</em> digits, see
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="print.slim_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If <code>TRUE</code>, &lsquo;significance stars&rsquo;
are printed for each coefficient.</p>
</td></tr>
<tr><td><code id="print.slim_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x, invisibly.
</p>

<hr>
<h2 id='residuals.slim'>Extract Model Residuals from Singular Linear Model</h2><span id='topic+residuals.slim'></span>

<h3>Description</h3>

<p>Extract Model Residuals from Singular Linear Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slim'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.slim_+3A_object">object</code></td>
<td>
<p>an object of class 'slim', usually, a result of a call to
'slim'.</p>
</td></tr>
<tr><td><code id="residuals.slim_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of model residuals.
</p>

<hr>
<h2 id='slim'>Fit Singular Linear Models</h2><span id='topic+slim'></span>

<h3>Description</h3>

<p>Fit a singular linear model to longitudinal data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slim(formula, data, covariance = "randomwalk", limit = ~1,
  contrasts = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slim_+3A_formula">formula</code></td>
<td>
<p>a model formula for the fixed effects</p>
</td></tr>
<tr><td><code id="slim_+3A_data">data</code></td>
<td>
<p>a 'data.table' with two keys, respectively identifying subjects
and observation times</p>
</td></tr>
<tr><td><code id="slim_+3A_covariance">covariance</code></td>
<td>
<p>an R object for which a 'list_covariances' method exists.
Options include a character string such as &quot;identity&quot;, &quot;randomwalk&quot; (the
default), &quot;brownian&quot; or &quot;pascal&quot;; a list of covariance matrices; a function
to be used in 'outer' and applied to the observation times; or a 'jmcmMod'
or 'lmerMod' model fit.</p>
</td></tr>
<tr><td><code id="slim_+3A_limit">limit</code></td>
<td>
<p>a one-sided model formula for the (thin) Cholesky factor of the
limiting covariance matrix (default ~ 1, so the limiting covariance matrix
is the matrix of ones)</p>
</td></tr>
<tr><td><code id="slim_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the 'contrasts.arg' argument of
'model.matrix.default'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class 'slim'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>slim_fit &lt;- slim(renalfn ~ group + month, dialysis)
summary(slim_fit)

if(require("lme4")) {
  lmer_fit &lt;- lmer(renalfn ~ group + month + (1 + month | id), dialysis)
  slim_fit &lt;- slim(renalfn ~ 1 + group + month, dialysis, covariance = lmer_fit)
  summary(slim_fit)
  summary(slim_fit, empirical = FALSE)
}

if(require("jmcm")) {
  jmcm_fit &lt;- jmcm(renalfn | id | month ~ group | 1, dialysis,
    triple = rep(2L, 3), cov.method = "mcd")
  slim_fit &lt;- slim(renalfn ~ group + month, dialysis, covariance = jmcm_fit)
  summary(slim_fit)
  summary(slim_fit, empirical = FALSE)
}
</code></pre>

<hr>
<h2 id='slim.methods'>Methods for Singular Linear Model Fits</h2><span id='topic+slim.methods'></span>

<h3>Description</h3>

<p>Methods for Singular Linear Model Fits
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slim.methods_+3A_object">object</code></td>
<td>
<p>an object of class 'slim', usually, a result of a call to
'slim'.</p>
</td></tr>
<tr><td><code id="slim.methods_+3A_empirical">empirical</code></td>
<td>
<p>logical indicating if empirical variances of y should be
used in estimating standard errors (the default). Empirical standard errors
should be used unless covariances have been well modelled.</p>
</td></tr>
<tr><td><code id="slim.methods_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.slim'>Summarizing Singular Linear Model Fits</h2><span id='topic+summary.slim'></span>

<h3>Description</h3>

<p>'summary' method for class 'slim'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slim'
summary(object, empirical = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.slim_+3A_object">object</code></td>
<td>
<p>an object of class 'slim', usually, a result of a call to
'slim'.</p>
</td></tr>
<tr><td><code id="summary.slim_+3A_empirical">empirical</code></td>
<td>
<p>logical indicating if empirical variances of y should be
used in estimating standard errors (the default). Empirical standard errors
should be used unless covariances have been well modelled.</p>
</td></tr>
<tr><td><code id="summary.slim_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object with class c(&quot;slim_summary&quot;, &quot;slim&quot;) and, in addition to
the usual 'slim' components, coefficient_matrix (the matrix of estimated
coefficients, standard errors, z- and p-values) and empirical (logical
indicating if empirical standard errors have been used)
</p>

<hr>
<h2 id='vcov.slim'>Extract Variance-Covariance Matrix from a 'slim' Object</h2><span id='topic+vcov.slim'></span>

<h3>Description</h3>

<p>'vcov' method for class 'slim'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slim'
vcov(object, empirical = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.slim_+3A_object">object</code></td>
<td>
<p>an object of class 'slim', usually, a result of a call to
'slim'.</p>
</td></tr>
<tr><td><code id="vcov.slim_+3A_empirical">empirical</code></td>
<td>
<p>logical indicating if empirical variances of y should be
used in estimating standard errors (the default). Empirical standard errors
should be used unless covariances have been well modelled.</p>
</td></tr>
<tr><td><code id="vcov.slim_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of the estimated covariances between the parameter
estimates.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
