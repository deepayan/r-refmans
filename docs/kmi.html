<!DOCTYPE html><html><head><title>Help for package kmi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kmi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cox.kmi'><p>Cox proportional hazards model applied to imputed data sets</p></a></li>
<li><a href='#icu.pneu'><p>Hospital acquired penumonia in ICU</p></a></li>
<li><a href='#kmi'><p>Kaplan-Meier Multiple Imputation for Competing Risks</p></a></li>
<li><a href='#print.cox.kmi'><p>Print method for cox.kmi objects</p></a></li>
<li><a href='#print.summary.cox.kmi'><p>Print method for summary.cox.kmi objects</p></a></li>
<li><a href='#summary.cox.kmi'><p>Summary method for cox.kmi objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.5.5</td>
</tr>
<tr>
<td>Title:</td>
<td>Kaplan-Meier Multiple Imputation for the Analysis of Cumulative
Incidence Functions in the Competing Risks Setting</td>
</tr>
<tr>
<td>Author:</td>
<td>Arthur Allignol &lt;arthur.allignol@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arthur Allignol &lt;arthur.allignol@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>mitools,survival,stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs a Kaplan-Meier multiple imputation to recover the missing potential censoring information from competing risks events, so that standard right-censored methods could be applied to the imputed data sets to perform analyses of the cumulative incidence functions (Allignol and Beyersmann, 2010 &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxq018">doi:10.1093/biostatistics/kxq018</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/aallignol/kmi">https://github.com/aallignol/kmi</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/aallignol/kmi/issues">https://github.com/aallignol/kmi/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-27 20:17:42 UTC; arthur</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-27 21:10:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='cox.kmi'>Cox proportional hazards model applied to imputed data sets</h2><span id='topic+cox.kmi'></span>

<h3>Description</h3>

<p>This function fits Cox proportional hazards models to each imputed
data set to estimate the regression coefficients in a proportional
subdistribution hazards model, and pools the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cox.kmi(formula, imp.data, df.complete = Inf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cox.kmi_+3A_formula">formula</code></td>
<td>
<p>A formula object, with the response on the left of a
<code>~</code> operator, and the terms on the right. The response must be
a survival object as returned by the <code><a href="survival.html#topic+Surv">Surv</a></code>
function.</p>
</td></tr>
<tr><td><code id="cox.kmi_+3A_imp.data">imp.data</code></td>
<td>
<p>An object of class <code>kmi</code>.</p>
</td></tr>
<tr><td><code id="cox.kmi_+3A_df.complete">df.complete</code></td>
<td>
<p>Complete data degrees of freedom.</p>
</td></tr>
<tr><td><code id="cox.kmi_+3A_...">...</code></td>
<td>
<p>Further arguments for the <code><a href="survival.html#topic+coxph">coxph</a></code>
function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits a Cox proportional hazards model on each imputed data set to
estimate the regression coefficients in a proportional
subdistribution hazards model, and pools the results, using the
<code><a href="mitools.html#topic+MIcombine">MIcombine</a></code> function of the mitools package.
</p>


<h3>Value</h3>

<p>An object of class <code>cox.kmi</code> including the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>Pooled regression coefficient estimates</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>Pooled variance estimate</p>
</td></tr>
<tr><td><code>nimp</code></td>
<td>
<p>Number of multiple imputations</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
<tr><td><code>individual.fit</code></td>
<td>
<p>A list of <code>coxph</code> objects. One for each
imputed data set.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="mitools.html#topic+MIcombine">MIcombine</a></code>, <code><a href="#topic+print.cox.kmi">print.cox.kmi</a></code>,
<code><a href="#topic+summary.cox.kmi">summary.cox.kmi</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(icu.pneu)


if (require(survival)) {
    
    set.seed(1313)
    imp.dat &lt;- kmi(Surv(start, stop, status) ~ 1, data = icu.pneu,
                   etype = event, id = id, failcode = 2, nimp = 5)
    
    fit.kmi &lt;- cox.kmi(Surv(start, stop, event == 2) ~ pneu, imp.dat)
    
    summary(fit.kmi)
    
### Now using the censoring-complete data
    fit &lt;- coxph(Surv(start, adm.cens.exit, event == 2) ~ pneu, icu.pneu)
    
    summary(fit)
    
    ## estimation of the censoring distribution adjusted on covariates
    dat.cova &lt;- kmi(Surv(start, stop, status) ~ age + sex,
                    data = icu.pneu, etype = event, id = id,
                    failcode = 2, nimp = 5)
    
    fit.kmi2 &lt;- cox.kmi(Surv(start, adm.cens.exit, event == 2) ~ pneu + age,
                        dat.cova)
    
    summary(fit.kmi2)
}
</code></pre>

<hr>
<h2 id='icu.pneu'>Hospital acquired penumonia in ICU</h2><span id='topic+icu.pneu'></span>

<h3>Description</h3>

<p>This data set is a random sample drawn from the SIR-3 study that aimed
at analysing the effect of nosocomial infections on the length of ICU
stay. Patients were included in the study if they had stayed at least
1 day in the unit. The sample includes information to assess the
effect of nosocomial pneumonia on the length of stay. The endpoint is
either discharge alive from the ICU or dead in the unit. These data
are censoring complete as the censoring time is known for all patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(icu.pneu)</code></pre>


<h3>Format</h3>

<p>A data frame with 1421 observations on the following 8 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Individual patient id.</p>
</dd>
<dt><code>start</code></dt><dd><p>Start of the observation time.</p>
</dd>
<dt><code>stop</code></dt><dd><p>Failure time.</p>
</dd>
<dt><code>status</code></dt><dd><p>Censoring status. 0 if the observation is
censored, 1 otherwise.</p>
</dd>
<dt><code>event</code></dt><dd><p>Event type. 2 is death in
ICU, 3 is discharge alive</p>
</dd>
<dt><code>pneu</code></dt><dd><p>Nosocomial pneumonia indicator.</p>
</dd>
<dt><code>adm.cens.exit</code></dt><dd><p>Exit times for patients discharged alive
are replaced by their administrative censoring times.</p>
</dd>
<dt><code>age</code></dt><dd><p>Age at inclusion</p>
</dd>
<dt><code>sex</code></dt><dd><p>Sex. <code>F</code> for female and <code>M</code> for male</p>
</dd>
</dl>



<h3>Source</h3>

<p>Beyersmann, J., Gastmeier, P., Grundmann, H.,
Baerwolff, S., Geffers, C., Behnke, M.,
Rueden, H., and Schumacher, M. Use of multistate
models to assess prolongation of intensive care unit stay due to
nosocomial infection. <em>Infection Control and Hospital
Epidemiology</em>, 27:493-499, 2006.
</p>


<h3>References</h3>

<p>Beyersmann, J. and Schumacher, M. (2008). Time-dependent covariates in
the proportional hazards model for competing
risks. <em>Biostatistics</em>, 9:765&ndash;776.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(icu.pneu)
</code></pre>

<hr>
<h2 id='kmi'>Kaplan-Meier Multiple Imputation for Competing Risks</h2><span id='topic+kmi'></span>

<h3>Description</h3>

<p>The function performs a non parametric multiple imputation that aims
at recovering the missing potential censoring times from competing
events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmi(formula, data, id = NULL, etype, failcode = 1, nimp = 10,
    epsilon = 1, bootstrap = FALSE, nboot = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmi_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> object, that must have a <code>Surv</code>
object on the left of a <code>~</code> operator. Covariates could be added
on the right hand side of the formula. They will be used to model
the censoring distribution. See Details.</p>
</td></tr>
<tr><td><code id="kmi_+3A_data">data</code></td>
<td>
<p>A data.frame in which to interpret the variables given in
the formula, <code>etype</code> and <code>id</code>. It is mandatory.</p>
</td></tr>
<tr><td><code id="kmi_+3A_id">id</code></td>
<td>
<p>Used to identify individual subjects when one subject can
have several rows of data, e.g., with time-dependent covariates. Set
to <code>NULL</code> when there is only one raw of data per subject.</p>
</td></tr>
<tr><td><code id="kmi_+3A_etype">etype</code></td>
<td>
<p>Variable specifying the type of competing event. When
<code>status == 1</code> in <code>formula</code>, <code>etype</code> describes the
type of event, otherwise, for censored observation, (<code>status ==
      0</code>), the value of <code>etype</code> is ignored.</p>
</td></tr>
<tr><td><code id="kmi_+3A_failcode">failcode</code></td>
<td>
<p>Indicates the failure cause of interest. Imputation
will be performed on the other competing events. Default is 1.</p>
</td></tr>
<tr><td><code id="kmi_+3A_nimp">nimp</code></td>
<td>
<p>Number of multiple imputation. Default is 10.</p>
</td></tr>
<tr><td><code id="kmi_+3A_epsilon">epsilon</code></td>
<td>
<p>When the last time is an event, a censoring time equal
to <code>max(time) + epsilon</code> is added. By default, <code>epsilon</code>
is set to 1.</p>
</td></tr>
<tr><td><code id="kmi_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Logical. Whether to estimate the censoring
distribution using bootstrap samples. Default is FALSE.</p>
</td></tr>
<tr><td><code id="kmi_+3A_nboot">nboot</code></td>
<td>
<p>If <code>bootstrap</code> is set to TRUE, <code>nboot</code>
determines the number of bootstrap samples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It was shown that if censoring times are observed for all individuals,
methods for standard right-censored survival data can be used to
analyse cumulative incidence functions from competing risks (Fine and
Gray 1999). Therefore the idea proposed by Ruan and Gray (2008) is to
impute potential censoring times for individuals who have failed from
the competing events. The censoring times are imputed from the
conditional Kaplan-Meier estimator of the censoring distribution.
</p>
<p>Estimation of the censoring distribution may be improved through
bootstrapping. Estimation might also be improved fitting a model for
the censoring distribution. When covariates are given, a proportional
hazards model on the hazard of censoring is fit. The censoring
times are then imputed from the estimated model.
</p>
<p>The competing risks model formulation in <code>formula</code> mimics the one
in <code><a href="survival.html#topic+survfit">survfit</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>kmi</code> with the following components:
</p>
<table>
<tr><td><code>imputed.data</code></td>
<td>
<p>A list of matrices giving the imputed times in the
first column and imputed event type in the second column. The event
status for imputed times take value 0 (censored).</p>
</td></tr>
<tr><td><code>original.data</code></td>
<td>
<p>The original data set</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>Gives the names of the time and event indicator column in
the original data set.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>When a proportional hazards model is fit for modelling the censoring
distribution, the censoring times are imputed from the imputed model.
When there is missing covariate information for the prediction, mean
imputation is used.
</p>


<h3>Note</h3>

<p>This multiple imputation technique does not work for left-truncated
data.
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>References</h3>

<p>Ruan, P.K. and Gray, R.J. (2008). Analyses of cumulative
incidence functions via non-parametric multiple
imputation. <em>Statistics in Medicine</em>, 27(27):5709&ndash;5724.
</p>
<p>Allignol, A. and Beyersmann, J. (2010). Software for fitting
nonstandard proportional subdistribution hazards
models. <em>Biostatistics</em>, doi:10.1093/biostatistics/kxq018 
</p>
<p>Fine, J.P. and Gray, R.J. (1999). A Proportional Hazards Model for the
Subdistribution of a Competing Risk. <em>Journal of the American
Statistical Association</em>. 94(446):496&ndash;509.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icu.pneu">icu.pneu</a></code>, <code><a href="#topic+cox.kmi">cox.kmi</a></code>,
<code><a href="survival.html#topic+Surv">Surv</a></code>,  <code><a href="survival.html#topic+survfit">survfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(icu.pneu)

if (require(survival)) {
    
    dat &lt;- kmi(Surv(start, stop, status) ~ 1, data = icu.pneu,
               etype = event, id= id, failcode = 2, nimp = 5)
    
    ## another way to specify the formula if there is no status
    ## variable
    icu.pneu$ev &lt;- icu.pneu$event
    icu.pneu$ev[icu.pneu$status == 0] &lt;- 0
    
    dat &lt;- kmi(Surv(start, stop, ev != 0) ~ 1, data = icu.pneu,
               etype = ev, id= id, failcode = 2, nimp = 5)
    
    ## with covariates to model the censoring distribution
    dat.cova &lt;- kmi(Surv(start, stop, status) ~ age + sex,
                    data = icu.pneu, etype = event, id = id,
                    failcode = 2, nimp = 5)
    
}
</code></pre>

<hr>
<h2 id='print.cox.kmi'>Print method for cox.kmi objects</h2><span id='topic+print.cox.kmi'></span>

<h3>Description</h3>

<p>Print method for <code>cox.kmi</code> objects. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cox.kmi'
print(x, print.ind = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cox.kmi_+3A_x">x</code></td>
<td>
<p>An object of class <code>cox.kmi</code>.</p>
</td></tr>
<tr><td><code id="print.cox.kmi_+3A_print.ind">print.ind</code></td>
<td>
<p>A logical specifying whether to print the results of
the analyses performed on each imputed data set. By default, only
the pooled estimates are printed.</p>
</td></tr>
<tr><td><code id="print.cox.kmi_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+cox.kmi">cox.kmi</a></code>, <code><a href="#topic+summary.cox.kmi">summary.cox.kmi</a></code></p>

<hr>
<h2 id='print.summary.cox.kmi'>Print method for summary.cox.kmi objects</h2><span id='topic+print.summary.cox.kmi'></span>

<h3>Description</h3>

<p>Print method for <code>summary.cox.kmi</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.cox.kmi'
print(x,
digits = max(getOption("digits") - 3, 3),
signif.stars = getOption("show.signif.stars"),
print.ind = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.cox.kmi_+3A_x">x</code></td>
<td>
<p>An object of class <code>summary.cox.kmi</code>.</p>
</td></tr>
<tr><td><code id="print.summary.cox.kmi_+3A_digits">digits</code></td>
<td>
<p>Significant digits to print.</p>
</td></tr>
<tr><td><code id="print.summary.cox.kmi_+3A_signif.stars">signif.stars</code></td>
<td>
<p>Logical. If TRUE, 'significance stars' are
printed for each coefficient.</p>
</td></tr>
<tr><td><code id="print.summary.cox.kmi_+3A_print.ind">print.ind</code></td>
<td>
<p>Logical specifying whether to print a summary of the
models fitted on each imputed data set. Default is FALSE</p>
</td></tr>
<tr><td><code id="print.summary.cox.kmi_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.cox.kmi">summary.cox.kmi</a></code></p>

<hr>
<h2 id='summary.cox.kmi'>Summary method for cox.kmi objects</h2><span id='topic+summary.cox.kmi'></span>

<h3>Description</h3>

<p>Provides a summary of the fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cox.kmi'
summary(object, conf.int = 0.95, scale = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cox.kmi_+3A_object">object</code></td>
<td>
<p>An object of class <code>cox.kmi</code>.</p>
</td></tr>
<tr><td><code id="summary.cox.kmi_+3A_conf.int">conf.int</code></td>
<td>
<p>Level of the confidence intervals. Default is 0.95</p>
</td></tr>
<tr><td><code id="summary.cox.kmi_+3A_scale">scale</code></td>
<td>
<p>Vector of scale factors for the coefficients, default to
1. The confidence limits are for the risk change associated with one
scale unit.</p>
</td></tr>
<tr><td><code id="summary.cox.kmi_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>summary.cox.kmi</code> with the following
components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>A matrix with 5 columns including the regression
coefficients, subdistribution hazard ratios, standard-errors,
t-statistics and corresponding two-sided p-values.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>A matrix with 4 columns that consists of the
subdistribution hazard ratios, exp(-coef) and the lower and upper
bounds of the confidence interval.</p>
</td></tr>
<tr><td><code>individual.fit</code></td>
<td>
<p>A list of <code>summary.coxph</code> objects for each
imputed data set</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+cox.kmi">cox.kmi</a></code>, <code><a href="#topic+print.summary.cox.kmi">print.summary.cox.kmi</a></code>,
<code><a href="survival.html#topic+summary.coxph">summary.coxph</a></code></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
