<!DOCTYPE html><html><head><title>Help for package brunnermunzel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {brunnermunzel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#brunnermunzel.permutation.test'><p>permuted Brunner-Munzel test</p></a></li>
<li><a href='#brunnermunzel.test'><p>brunnermunzel.test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>(Permuted) Brunner-Munzel Test</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-8-7</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the functions for Brunner-Munzel test and
    permuted Brunner-Munzel test,
    which enable to use formula, matrix, and table as argument.
    These functions are based on Brunner and Munzel (2000)
     &lt;<a href="https://doi.org/10.1002/(SICI)1521-4036(200001)42:1%3C17::AID-BIMJ17%3E3.0.CO;2-U">doi:10.1002/(SICI)1521-4036(200001)42:1%3C17::AID-BIMJ17%3E3.0.CO;2-U</a>&gt;
    and Neubert and Brunner (2007) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2006.05.024">doi:10.1016/j.csda.2006.05.024</a>&gt;,
    and are written with FORTRAN.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/toshi-ara/brunnermunzel">https://github.com/toshi-ara/brunnermunzel</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/toshi-ara/brunnermunzel/issues/">https://github.com/toshi-ara/brunnermunzel/issues/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, dplyr, ggplot2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-07 10:59:11 UTC; ara</td>
</tr>
<tr>
<td>Author:</td>
<td>Toshiaki Ara [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Toshiaki Ara &lt;toshiaki.ara@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-07 15:40:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='brunnermunzel.permutation.test'>permuted Brunner-Munzel test</h2><span id='topic+brunnermunzel.permutation.test'></span><span id='topic+brunnermunzel.permutation.test.default'></span><span id='topic+brunnermunzel.permutation.test.formula'></span><span id='topic+brunnermunzel.permutation.test.matrix'></span><span id='topic+brunnermunzel.permutation.test.table'></span>

<h3>Description</h3>

<p>This function performs the permuted Brunner-Munzel test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brunnermunzel.permutation.test(x, ...)

## Default S3 method:
brunnermunzel.permutation.test(
  x,
  y,
  alternative = c("two.sided", "greater", "less"),
  force = FALSE,
  est = c("original", "difference"),
  ...
)

## S3 method for class 'formula'
brunnermunzel.permutation.test(formula, data, subset = NULL, na.action, ...)

## S3 method for class 'matrix'
brunnermunzel.permutation.test(x, ...)

## S3 method for class 'table'
brunnermunzel.permutation.test(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brunnermunzel.permutation.test_+3A_x">x</code></td>
<td>
<p>the numeric vector of data values from the sample 1,
or 2 x n matrix of table
(number of row must be 2 and column is ordinal variables).</p>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods
(This argument is for only formula).</p>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_y">y</code></td>
<td>
<p>the numeric vector of data values from the sample 2.
If x is matrix or table, y must be missing.</p>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative
hypothesis, must be one of <code>two.sided</code> (default), <code>greater</code> or
<code>less</code>. User can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_force">force</code></td>
<td>

<dl>
<dt>FALSE</dt><dd><p>(default): If sample size is too large
[number of combinations &gt; 40116600 = choose(28, 14)],
use <code>brunnermunzel.test</code>.</p>
</dd>
<dt>TRUE</dt><dd><p>: perform permuted Brunner-Munzel test
regardless sample size.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_est">est</code></td>
<td>
<p>a method to calculate estimate and confidence interval,
must be either <code>original</code> (default) or <code>difference</code>.
</p>

<dl>
<dt>original</dt><dd><p>(default): return <code class="reqn">p = P(X &lt; Y) + 0.5 * P(X = Y)</code></p>
</dd>
<dt>difference</dt><dd><p>: return mean difference.
i.e. <code class="reqn">P(X &lt; Y) - P(X &gt; Y)</code> = 2 * p - 1</p>
</dd>
</dl>

<p>This change is proposed by Dr. Julian D. Karch.</p>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>lhs ~ rhs</code> where <code>lhs</code>
is a numeric variable giving the data values and <code>rhs</code> a factor
with two levels giving the corresponding groups.</p>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code><a href="stats.html#topic+model.frame">model.frame</a></code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td></tr>
<tr><td><code id="brunnermunzel.permutation.test_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to
<code>getOption("na.action")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>the characters &ldquo;permuted Brunner-Munzel Test&rdquo;</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the <code class="reqn">p</code>-value of the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>an estimate of the effect size</p>
</td></tr>
</table>


<h3>Note</h3>

<p>FORTRAN subroutine 'combination' in combination.f is derived from
the program by shikino (<a href="http://slpr.sakura.ne.jp/qp/combination">http://slpr.sakura.ne.jp/qp/combination</a>)
(CC-BY-4.0).
Thanks to shikono for your useful subroutine.
</p>


<h3>References</h3>

<p>Karin Neubert and Edgar Brunner,
&ldquo;A studentized permutation test for the non-parametric
Behrens-Fisher problem&rdquo;,
Computational Statistics and Data Analysis, Vol. 51, pp. 5192-5204 (2007).
</p>


<h3>See Also</h3>

<p>This function is made in reference to following cite (in Japanese):
Prof. Haruhiko Okumura
(<a href="https://oku.edu.mie-u.ac.jp/~okumura/stat/brunner-munzel.html">https://oku.edu.mie-u.ac.jp/~okumura/stat/brunner-munzel.html</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Hollander &amp; Wolfe (1973), 29f.
## Hamilton depression scale factor measurements in 9 patients with
##  mixed anxiety and depression, taken at the first (x) and second
##  (y) visit after initiation of a therapy (administration of a
##  tranquilizer).
x &lt;- c(1.83,  0.50,  1.62,  2.48, 1.68, 1.88, 1.55, 3.06, 1.30)
y &lt;- c(0.878, 0.647, 0.598, 2.05, 1.06, 1.29, 1.06, 3.14, 1.29)

brunnermunzel.permutation.test(x, y)
##
##       permuted Brunner-Munzel Test
##
## data:  x and y
## p-value = 0.158
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##        0.2839506

## 'est' option
## if 'est = "difference"' return P(X&lt;Y) - P(X&gt;Y)
brunnermunzel.permutation.test(x, y, est = "difference")
##
##       permuted Brunner-Munzel Test
##
## data:  x and y
## p-value = 0.158
## sample estimates:
## P(X&lt;Y)-P(X&gt;Y)
##    -0.4320988


## Formula interface.
dat &lt;- data.frame(
    value = c(x, y),
    group = factor(rep(c("x", "y"), c(length(x), length(y))),
                   levels = c("x", "y"))
)

brunnermunzel.permutation.test(value ~ group, data = dat)
##
##       permuted Brunner-Munzel Test
##
## data:  value by group
## p-value = 0.158
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##        0.2839506


## Pain score on the third day after surgery for 14 patients under
## the treatment Y and 11 patients under the treatment N
## (see Brunner and Munzel, 2000; Neubert and Brunner, 2007).

Y &lt;- c(1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 4, 1, 1)
N &lt;- c(3, 3, 4, 3, 1, 2, 3, 1, 1, 5, 4)


brunnermunzel.permutation.test(Y, N)

##
##       permuted Brunner-Munzel Test
##
## data:  Y and N
## p-value = 0.008038
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##         0.788961

## Formula interface.
dat &lt;- data.frame(
    value = c(Y, N),
    group = factor(rep(c("Y", "N"), c(length(Y), length(N))),
                   levels = c("Y", "N"))
)


brunnermunzel.permutation.test(value ~ group, data = dat)

##
##       permuted Brunner-Munzel Test
##
## data:  value by group
## p-value = 0.008038
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##         0.788961


## Matrix or Table interface.
##
dat1 &lt;- matrix(c(4, 4, 2, 1, 5, 4), nr = 2, byrow = TRUE)
dat2 &lt;- as.table(dat1)

brunnermunzel.permutation.test(dat1)  # matrix
##
##       permuted Brunner-Munzel Test
##
## data:  Group1 and Group2
## p-value = 0.1593
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##             0.68

brunnermunzel.permutation.test(dat2)  # table
##
##       Brunner-Munzel Test
##
##       permuted Brunner-Munzel Test
##
## data:  A and B
## p-value = 0.1593
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##             0.68

</code></pre>

<hr>
<h2 id='brunnermunzel.test'>brunnermunzel.test</h2><span id='topic+brunnermunzel.test'></span><span id='topic+brunnermunzel.test.default'></span><span id='topic+brunnermunzel.test.formula'></span><span id='topic+brunnermunzel.test.matrix'></span><span id='topic+brunnermunzel.test.table'></span>

<h3>Description</h3>

<p>This function performs the Brunner&ndash;Munzel test for stochastic
equality of two samples, which is also known as the Generalized Wilcoxon
Test. <code>NA</code>s from the data are omitted.
This function enables to use formula as argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brunnermunzel.test(x, ...)

## Default S3 method:
brunnermunzel.test(
  x,
  y,
  alternative = c("two.sided", "greater", "less"),
  alpha = 0.05,
  perm = FALSE,
  est = c("original", "difference"),
  ...
)

## S3 method for class 'formula'
brunnermunzel.test(formula, data, subset = NULL, na.action, ...)

## S3 method for class 'matrix'
brunnermunzel.test(x, ...)

## S3 method for class 'table'
brunnermunzel.test(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brunnermunzel.test_+3A_x">x</code></td>
<td>
<p>the numeric vector of data values from the sample 1,
or 2 x n matrix of table
(number of row must be 2 and column is ordinal variables).</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods
(This argument is for only formula).</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_y">y</code></td>
<td>
<p>the numeric vector of data values from the sample 2.
If x is matrix or table, y must be missing.</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative
hypothesis, must be one of <code>two.sided</code> (default), <code>greater</code> or
<code>less</code>. User can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_alpha">alpha</code></td>
<td>
<p>significance level, default is 0.05 for 95% confidence
interval.</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_perm">perm</code></td>
<td>
<p>logical
</p>

<dl>
<dt>FALSE</dt><dd><p>(default): perform Brunner-Munzel test.</p>
</dd>
<dt>TRUE</dt><dd><p>: perform permuted Brunner-Munzel test.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_est">est</code></td>
<td>
<p>a method to calculate estimate and confidence interval,
must be either <code>original</code> (default) or <code>difference</code>.
</p>

<dl>
<dt>original</dt><dd><p>(default): return <code class="reqn">p = P(X &lt; Y) + 0.5 * P(X = Y)</code></p>
</dd>
<dt>difference</dt><dd><p>: return mean difference.
i.e. <code class="reqn">P(X &lt; Y) - P(X &gt; Y) = 2 * p - 1</code></p>
</dd>
</dl>

<p>This change is proposed by Dr. Julian D. Karch.</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>lhs ~ rhs</code> where <code>lhs</code>
is a numeric variable giving the data values and <code>rhs</code> a factor
with two levels giving the corresponding groups.</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code><a href="stats.html#topic+model.frame">model.frame</a></code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td></tr>
<tr><td><code id="brunnermunzel.test_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to
<code>getOption("na.action")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the Brunner&ndash;Munzel test statistic.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the degrees of freedom.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the <code class="reqn">p</code>-value of the test.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>the confidence interval.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>an estimate of the effect size</p>
</td></tr>
</table>


<h3>Note</h3>

<p>There exist discrepancies with Brunner and Munzel (2000)
because there is a typo in the paper. The corrected version is
in Neubert and Brunner (2007) (e.g., compare the estimates for
the case study on pain scores).
The current R function follows Neubert and Brunner (2007).
</p>


<h3>See Also</h3>

<p>The R script of brunnermunzel.test.default is
derived from that of <code>brunner.munzel.test</code>
in <code>lawstat</code> package,
and is rewritten with FORTRAN.
Thanks to authors of <code>lawstat</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Hollander &amp; Wolfe (1973), 29f.
## Hamilton depression scale factor measurements in 9 patients with
##  mixed anxiety and depression, taken at the first (x) and second
##  (y) visit after initiation of a therapy (administration of a
##  tranquilizer).
x &lt;- c(1.83,  0.50,  1.62,  2.48, 1.68, 1.88, 1.55, 3.06, 1.30)
y &lt;- c(0.878, 0.647, 0.598, 2.05, 1.06, 1.29, 1.06, 3.14, 1.29)

brunnermunzel.test(x, y)
##
##       Brunner-Munzel Test
##
## data:  x and y
## Brunner-Munzel Test Statistic = -1.4673, df = 15.147, p-value = 0.1628
## 95 percent confidence interval:
##  -0.02962941  0.59753064
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##        0.2839506

## 'est' option
## if 'est = "difference"' return P(X&lt;Y) - P(X&gt;Y)
brunnermunzel.test(x, y, est = "difference")
##
##       Brunner-Munzel Test
##
## data:  x and y
## Brunner-Munzel Test Statistic = -1.4673, df = 15.147, p-value = 0.1628
## 95 percent confidence interval:
##  -1.0592588  0.1950613
## sample estimates:
## P(X&lt;Y)-P(X&gt;Y)
##    -0.4320988


## Formula interface.
dat &lt;- data.frame(
    value = c(x, y),
    group = factor(rep(c("x", "y"), c(length(x), length(y))),
                   levels = c("x", "y"))
)

brunnermunzel.test(value ~ group, data = dat)
##
##       Brunner-Munzel Test
##
## data:  value by group
## Brunner-Munzel Test Statistic = -1.4673, df = 15.147, p-value = 0.1628
## 95 percent confidence interval:
##  -0.02962941  0.59753064
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y) 
##        0.2839506 


## Pain score on the third day after surgery for 14 patients under
## the treatment Y and 11 patients under the treatment N
## (see Brunner and Munzel, 2000; Neubert and Brunner, 2007).

Y &lt;- c(1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 4, 1, 1)
N &lt;- c(3, 3, 4, 3, 1, 2, 3, 1, 1, 5, 4)

brunnermunzel.test(Y, N)
##
##       Brunner-Munzel Test
##
## data: Y and N
## Brunner-Munzel Test Statistic = 3.1375,  df = 17.683, p-value = 0.005786
## 95 percent confidence interval:
##  0.5952169 0.9827052
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##        0.788961

## Formula interface.
dat &lt;- data.frame(
    value = c(Y, N),
    group = factor(rep(c("Y", "N"), c(length(Y), length(N))),
                   levels = c("Y", "N"))
)

brunnermunzel.test(value ~ group, data = dat)
##
##       Brunner-Munzel Test
##
## data:  value by group
## Brunner-Munzel Test Statistic = 3.1375, df = 17.683, p-value =
## 0.005786
## 95 percent confidence interval:
##  0.5952169 0.9827052
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##         0.788961


## Matrix or Table interface.
##
dat1 &lt;- matrix(c(4, 4, 2, 1, 5, 4), nr = 2, byrow = TRUE)
dat2 &lt;- as.table(dat1)

brunnermunzel.test(dat1)  # matrix
##
##       Brunner-Munzel Test
##
## data:  Group1 and Group2
## Brunner-Munzel Test Statistic = 1.5511, df = 16.961, p-value =
## 0.1393
## 95 percent confidence interval:
##  0.4351213 0.9248787
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##             0.68

brunnermunzel.test(dat2)  # table
##
##       Brunner-Munzel Test
##
## data:  A and B
## Brunner-Munzel Test Statistic = 1.5511, df = 16.961, p-value =
## 0.1393
## 95 percent confidence interval:
##  0.4351213 0.9248787
## sample estimates:
## P(X&lt;Y)+.5*P(X=Y)
##             0.68

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
