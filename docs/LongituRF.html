<!DOCTYPE html><html><head><title>Help for package LongituRF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LongituRF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bay'><p>Title</p></a></li>
<li><a href='#bay_sto'><p>Title</p></a></li>
<li><a href='#bay.exp'><p>Title</p></a></li>
<li><a href='#bay.fbm'><p>Title</p></a></li>
<li><a href='#cov.exp'><p>Title</p></a></li>
<li><a href='#cov.fbm'><p>Title</p></a></li>
<li><a href='#DataLongGenerator'><p>Longitudinal data generator</p></a></li>
<li><a href='#gam_exp'><p>Title</p></a></li>
<li><a href='#gam_fbm'><p>Title</p></a></li>
<li><a href='#gam_sto'><p>Title</p></a></li>
<li><a href='#logV'><p>Title</p></a></li>
<li><a href='#logV.exp'><p>Title</p></a></li>
<li><a href='#logV.fbm'><p>Title</p></a></li>
<li><a href='#MERF'><p>(S)MERF algorithm</p></a></li>
<li><a href='#MERT'><p>(S)MERT algorithm</p></a></li>
<li><a href='#Moy'><p>Title</p></a></li>
<li><a href='#Moy_exp'><p>Title</p></a></li>
<li><a href='#Moy_fbm'><p>Title</p></a></li>
<li><a href='#Moy_sto'><p>Title</p></a></li>
<li><a href='#opti.exp'><p>Title</p></a></li>
<li><a href='#opti.FBM'><p>Title</p></a></li>
<li><a href='#opti.FBMreem'><p>Title</p></a></li>
<li><a href='#predict.exp'><p>blabla</p></a></li>
<li><a href='#predict.fbm'><p>Title</p></a></li>
<li><a href='#predict.longituRF'><p>Predict with longitudinal trees and random forests.</p></a></li>
<li><a href='#predict.sto'><p>Title</p></a></li>
<li><a href='#REEMforest'><p>(S)REEMforest algorithm</p></a></li>
<li><a href='#REEMtree'><p>(S)REEMtree algorithm</p></a></li>
<li><a href='#sig'><p>Title</p></a></li>
<li><a href='#sig_sto'><p>Title</p></a></li>
<li><a href='#sig.exp'><p>Title</p></a></li>
<li><a href='#sig.fbm'><p>Title</p></a></li>
<li><a href='#sto_analysis'><p>Title</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Random Forests for Longitudinal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9</td>
</tr>
<tr>
<td>Description:</td>
<td>Random forests are a statistical learning method widely used in many areas of scientific research essentially for its ability to learn complex relationships between input and output variables and also its capacity to handle high-dimensional data. However, current random forests approaches are not flexible enough to handle longitudinal data.  In this package, we propose a general approach of random forests for high-dimensional longitudinal data. It includes a flexible stochastic model which allows the covariance structure to vary over time. Furthermore, we introduce a new method which takes intra-individual covariance into consideration to build random forests. The method is fully detailled in Capitaine et.al. (2020) &lt;<a href="https://doi.org/10.1177%2F0962280220946080">doi:10.1177/0962280220946080</a>&gt; Random forests for high-dimensional longitudinal data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, randomForest, rpart, mvtnorm, latex2exp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-08-25 22:24:05 UTC; capitainelouis</td>
</tr>
<tr>
<td>Author:</td>
<td>Louis Capitaine <a href="https://orcid.org/0000-0001-6800-2342"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Louis Capitaine &lt;Louis.capitaine@u-bordeaux.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-08-31 09:10:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='bay'>Title</h2><span id='topic+bay'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bay(bhat, Bhat, Z, id, sigmahat)
</code></pre>

<hr>
<h2 id='bay_sto'>Title</h2><span id='topic+bay_sto'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bay_sto(bhat, Bhat, Z, id, sigmahat, time, sigma2, sto)
</code></pre>

<hr>
<h2 id='bay.exp'>Title</h2><span id='topic+bay.exp'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bay.exp(bhat, Bhat, Z, id, sigmahat, time, sigma2, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bay.exp_+3A_alpha">alpha</code></td>
<td>
<p>@import stats</p>
</td></tr>
</table>

<hr>
<h2 id='bay.fbm'>Title</h2><span id='topic+bay.fbm'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bay.fbm(bhat, Bhat, Z, id, sigmahat, time, sigma2, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bay.fbm_+3A_h">h</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='cov.exp'>Title</h2><span id='topic+cov.exp'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov.exp(time, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cov.exp_+3A_alpha">alpha</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='cov.fbm'>Title</h2><span id='topic+cov.fbm'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov.fbm(time, H)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cov.fbm_+3A_h">H</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='DataLongGenerator'>Longitudinal data generator</h2><span id='topic+DataLongGenerator'></span>

<h3>Description</h3>

<p>Simulate longitudinal data according to the semi-parametric stochastic mixed-effects model given by: </p>
<p style="text-align: center;"><code class="reqn">Y_i(t)=f(X_i(t))+Z_i(t)\beta_i + \omega_i(t)+\epsilon_i</code>
</p>

<p>with <code class="reqn">Y_i(t)</code> the output at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">X_i(t)</code> the input predictors (fixed effects) at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual;
<code class="reqn">Z_i(t)</code> are the random effects at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">\omega_i(t)</code> is a Brownian motion with volatility <code class="reqn">\gamma^2=0.8</code> at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">\epsilon_i</code> is the residual error with
variance <code class="reqn">\sigma^2=0.5</code>.
The data are simulated according to the simulations in low dimensional in the low dimensional scheme of the paper &lt;doi:10.1177/0962280220946080&gt;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DataLongGenerator(n = 50, p = 6, G = 6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DataLongGenerator_+3A_n">n</code></td>
<td>
<p>[numeric]: Number of individuals. The default value is <code>n=50</code>.</p>
</td></tr>
<tr><td><code id="DataLongGenerator_+3A_p">p</code></td>
<td>
<p>[numeric]: Number of predictors. The default value is <code>p=6</code>.</p>
</td></tr>
<tr><td><code id="DataLongGenerator_+3A_g">G</code></td>
<td>
<p>[numeric]: Number of groups of predictors with temporal behavior, generates <code>p-G</code> input variables with no temporal behavior.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of the following elements: </p>

<ul>
<li> <p><code>Y:</code> vector of the output trajectories.
</p>
</li>
<li> <p><code>X :</code> matrix of the fixed-effects predictors.
</p>
</li>
<li> <p><code>Z:</code> matrix of the random-effects predictors.
</p>
</li>
<li> <p><code>id: </code> vector of the identifiers for each individual.
</p>
</li>
<li> <p><code>time: </code> vector the the time measurements for each individual.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>oldpar &lt;- par()
oldopt &lt;- options()
data &lt;- DataLongGenerator(n=17, p=6,G=6) # Generate the data
# Let's see the output :
w &lt;- which(data$id==1)
plot(data$time[w],data$Y[w],type="l",ylim=c(min(data$Y),max(data$Y)), col="grey")
for (i in unique(data$id)){
  w &lt;- which(data$id==i)
  lines(data$time[w],data$Y[w], col='grey')
}
# Let's see the fixed effects predictors:
par(mfrow=c(2,3), mar=c(2,3,3,2))
for (i in 1:ncol(data$X)){
  w &lt;- which(data$id==1)
  plot(data$time[w],data$X[w,i], col="grey",ylim=c(min(data$X[,i]),
  max(data$X[,i])),xlim=c(1,max(data$time)),main=latex2exp::TeX(paste0("$X^{(",i,")}$")))
  for (k in unique(data$id)){
    w &lt;- which(data$id==k)
    lines(data$time[w],data$X[w,i], col="grey")
  }
}
par(oldpar)
options(oldopt)

</code></pre>

<hr>
<h2 id='gam_exp'>Title</h2><span id='topic+gam_exp'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gam_exp(Y, sigm, id, Z, Btilde, time, sigma2, omega, id_omega, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gam_exp_+3A_alpha">alpha</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='gam_fbm'>Title</h2><span id='topic+gam_fbm'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gam_fbm(Y, sigm, id, Z, Btilde, time, sigma2, omega, id_omega, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gam_fbm_+3A_h">h</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='gam_sto'>Title</h2><span id='topic+gam_sto'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gam_sto(sigma, id, Z, Btilde, time, sigma2, sto, omega)
</code></pre>

<hr>
<h2 id='logV'>Title</h2><span id='topic+logV'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logV(Y, f, Z, time, id, B, gamma, sigma, sto)
</code></pre>

<hr>
<h2 id='logV.exp'>Title</h2><span id='topic+logV.exp'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logV.exp(Y, fhat, Z, time, id, B, sigma2, sigmahat, H)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logV.exp_+3A_b">B</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='logV.fbm'>Title</h2><span id='topic+logV.fbm'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logV.fbm(Y, fhat, Z, time, id, B, sigma2, sigmahat, H)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logV.fbm_+3A_b">B</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='MERF'>(S)MERF algorithm</h2><span id='topic+MERF'></span>

<h3>Description</h3>

<p>(S)MERF is an adaptation of the random forest regression method to longitudinal data introduced by Hajjem et. al. (2014) &lt;doi:10.1080/00949655.2012.741599&gt;.
The model has been improved by Capitaine et. al. (2020) &lt;doi:10.1177/0962280220946080&gt; with the addition of a stochastic process.
The algorithm will estimate the parameters of the following semi-parametric stochastic mixed-effects model: </p>
<p style="text-align: center;"><code class="reqn">Y_i(t)=f(X_i(t))+Z_i(t)\beta_i + \omega_i(t)+\epsilon_i</code>
</p>

<p>with <code class="reqn">Y_i(t)</code> the output at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">X_i(t)</code> the input predictors (fixed effects) at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual;
<code class="reqn">Z_i(t)</code> are the random effects at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">\omega_i(t)</code> is the stochastic process at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual
which model the serial correlations of the output measurements; <code class="reqn">\epsilon_i</code> is the residual error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MERF(
  X,
  Y,
  id,
  Z,
  iter = 100,
  mtry = ceiling(ncol(X)/3),
  ntree = 500,
  time,
  sto,
  delta = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MERF_+3A_x">X</code></td>
<td>
<p>[matrix]: A <code>N</code>x<code>p</code> matrix containing the <code>p</code> predictors of the fixed effects, column codes for a predictor.</p>
</td></tr>
<tr><td><code id="MERF_+3A_y">Y</code></td>
<td>
<p>[vector]: A vector containing the output trajectories.</p>
</td></tr>
<tr><td><code id="MERF_+3A_id">id</code></td>
<td>
<p>[vector]: Is the vector of the identifiers for the different trajectories.</p>
</td></tr>
<tr><td><code id="MERF_+3A_z">Z</code></td>
<td>
<p>[matrix]: A <code>N</code>x<code>q</code> matrix containing the <code>q</code> predictor of the random effects.</p>
</td></tr>
<tr><td><code id="MERF_+3A_iter">iter</code></td>
<td>
<p>[numeric]: Maximal number of iterations of the algorithm. The default is set to <code>iter=100</code></p>
</td></tr>
<tr><td><code id="MERF_+3A_mtry">mtry</code></td>
<td>
<p>[numeric]: Number of variables randomly sampled as candidates at each split. The default value is <code>p/3</code>.</p>
</td></tr>
<tr><td><code id="MERF_+3A_ntree">ntree</code></td>
<td>
<p>[numeric]: Number of trees to grow. This should not be set to too small a number, to ensure that every input row gets predicted at least a few times. The default value is <code>ntree=500</code>.</p>
</td></tr>
<tr><td><code id="MERF_+3A_time">time</code></td>
<td>
<p>[vector]: Is the vector of the measurement times associated with the trajectories in <code>Y</code>,<code>Z</code> and <code>X</code>.</p>
</td></tr>
<tr><td><code id="MERF_+3A_sto">sto</code></td>
<td>
<p>[character]: Defines the covariance function of the stochastic process, can be either <code>"none"</code> for no stochastic process, <code>"BM"</code> for Brownian motion, <code>OrnUhl</code> for standard Ornstein-Uhlenbeck process, <code>BBridge</code> for Brownian Bridge, <code>fbm</code> for Fractional Brownian motion; can also be a function defined by the user.</p>
</td></tr>
<tr><td><code id="MERF_+3A_delta">delta</code></td>
<td>
<p>[numeric]: The algorithm stops when the difference in log likelihood between two iterations is smaller than <code>delta</code>. The default value is set to O.O01</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A fitted (S)MERF model which is a list of the following elements: </p>

<ul>
<li> <p><code>forest:</code> Random forest obtained at the last iteration.
</p>
</li>
<li> <p><code>random_effects :</code> Predictions of random effects for different trajectories.
</p>
</li>
<li> <p><code>id_btilde:</code> Identifiers of individuals associated with the predictions <code>random_effects</code>.
</p>
</li>
<li> <p><code>var_random_effects: </code> Estimation of the variance covariance matrix of random effects.
</p>
</li>
<li> <p><code>sigma_sto: </code> Estimation of the volatility parameter of the stochastic process.
</p>
</li>
<li> <p><code>sigma: </code> Estimation of the residual variance parameter.
</p>
</li>
<li> <p><code>time: </code> The vector of the measurement times associated with the trajectories in <code>Y</code>,<code>Z</code> and <code>X</code>.
</p>
</li>
<li> <p><code>sto: </code> Stochastic process used in the model.
</p>
</li>
<li> <p><code>Vraisemblance:</code> Log-likelihood of the different iterations.
</p>
</li>
<li> <p><code>id: </code> Vector of the identifiers for the different trajectories.
</p>
</li>
<li> <p><code>OOB: </code> OOB error of the fitted random forest at each iteration.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
data &lt;- DataLongGenerator(n=20) # Generate the data composed by n=20 individuals.
# Train a SMERF model on the generated data. Should take ~ 50 seconds
# The data are generated with a Brownian motion,
# so we use the parameter sto="BM" to specify a Brownian motion as stochastic process
smerf &lt;- MERF(X=data$X,Y=data$Y,Z=data$Z,id=data$id,time=data$time,mtry=2,ntree=500,sto="BM")
smerf$forest # is the fitted random forest (obtained at the last iteration).
smerf$random_effects # are the predicted random effects for each individual.
smerf$omega # are the predicted stochastic processes.
plot(smerf$Vraisemblance) # evolution of the log-likelihood.
smerf$OOB # OOB error at each iteration.


</code></pre>

<hr>
<h2 id='MERT'>(S)MERT algorithm</h2><span id='topic+MERT'></span>

<h3>Description</h3>

<p>(S)MERT is an adaptation of the random forest regression method to longitudinal data introduced by Hajjem et. al. (2011) &lt;doi:10.1016/j.spl.2010.12.003&gt;.
The model has been improved by Capitaine et. al. (2020) &lt;doi:10.1177/0962280220946080&gt; with the addition of a stochastic process.
The algorithm will estimate the parameters of the following semi-parametric stochastic mixed-effects model: </p>
<p style="text-align: center;"><code class="reqn">Y_i(t)=f(X_i(t))+Z_i(t)\beta_i + \omega_i(t)+\epsilon_i</code>
</p>

<p>with <code class="reqn">Y_i(t)</code> the output at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">X_i(t)</code> the input predictors (fixed effects) at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual;
<code class="reqn">Z_i(t)</code> are the random effects at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">\omega_i(t)</code> is the stochastic process at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual
which model the serial correlations of the output measurements; <code class="reqn">\epsilon_i</code> is the residual error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MERT(X, Y, id, Z, iter = 100, time, sto, delta = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MERT_+3A_x">X</code></td>
<td>
<p>[matrix]: A <code>N</code>x<code>p</code> matrix containing the <code>p</code> predictors of the fixed effects, column codes for a predictor.</p>
</td></tr>
<tr><td><code id="MERT_+3A_y">Y</code></td>
<td>
<p>[vector]: A vector containing the output trajectories.</p>
</td></tr>
<tr><td><code id="MERT_+3A_id">id</code></td>
<td>
<p>[vector]: Is the vector of the identifiers for the different trajectories.</p>
</td></tr>
<tr><td><code id="MERT_+3A_z">Z</code></td>
<td>
<p>[matrix]: A <code>N</code>x<code>q</code> matrix containing the <code>q</code> predictor of the random effects.</p>
</td></tr>
<tr><td><code id="MERT_+3A_iter">iter</code></td>
<td>
<p>[numeric]: Maximal number of iterations of the algorithm. The default is set to <code>iter=100</code></p>
</td></tr>
<tr><td><code id="MERT_+3A_time">time</code></td>
<td>
<p>[vector]: Is the vector of the measurement times associated with the trajectories in <code>Y</code>,<code>Z</code> and <code>X</code>.</p>
</td></tr>
<tr><td><code id="MERT_+3A_sto">sto</code></td>
<td>
<p>[character]: Defines the covariance function of the stochastic process, can be either <code>"none"</code> for no stochastic process, <code>"BM"</code> for Brownian motion, <code>OrnUhl</code> for standard Ornstein-Uhlenbeck process, <code>BBridge</code> for Brownian Bridge, <code>fbm</code> for Fractional Brownian motion; can also be a function defined by the user.</p>
</td></tr>
<tr><td><code id="MERT_+3A_delta">delta</code></td>
<td>
<p>[numeric]: The algorithm stops when the difference in log likelihood between two iterations is smaller than <code>delta</code>. The default value is set to O.O01</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A fitted (S)MERF model which is a list of the following elements: </p>

<ul>
<li> <p><code>forest:</code> Tree obtained at the last iteration.
</p>
</li>
<li> <p><code>random_effects :</code> Predictions of random effects for different trajectories.
</p>
</li>
<li> <p><code>id_btilde:</code> Identifiers of individuals associated with the predictions <code>random_effects</code>.
</p>
</li>
<li> <p><code>var_random_effects: </code> Estimation of the variance covariance matrix of random effects.
</p>
</li>
<li> <p><code>sigma_sto: </code> Estimation of the volatility parameter of the stochastic process.
</p>
</li>
<li> <p><code>sigma: </code> Estimation of the residual variance parameter.
</p>
</li>
<li> <p><code>time: </code> The vector of the measurement times associated with the trajectories in <code>Y</code>,<code>Z</code> and <code>X</code>.
</p>
</li>
<li> <p><code>sto: </code> Stochastic process used in the model.
</p>
</li>
<li> <p><code>Vraisemblance:</code> Log-likelihood of the different iterations.
</p>
</li>
<li> <p><code>id: </code> Vector of the identifiers for the different trajectories.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
data &lt;- DataLongGenerator(n=20) # Generate the data composed by n=20 individuals.
# Train a SMERF model on the generated data. Should take ~ 50 secondes
# The data are generated with a Brownian motion,
# so we use the parameter sto="BM" to specify a Brownian motion as stochastic process
smert &lt;- MERF(X=data$X,Y=data$Y,Z=data$Z,id=data$id,time=data$time,sto="BM")
smert$forest # is the fitted random forest (obtained at the last iteration).
smert$random_effects # are the predicted random effects for each individual.
smert$omega # are the predicted stochastic processes.
plot(smert$Vraisemblance) #evolution of the log-likelihood.


</code></pre>

<hr>
<h2 id='Moy'>Title</h2><span id='topic+Moy'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Moy(id, Btilde, sigmahat, Phi, Y, Z)
</code></pre>

<hr>
<h2 id='Moy_exp'>Title</h2><span id='topic+Moy_exp'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Moy_exp(id, Btilde, sigmahat, Phi, Y, Z, alpha, time, sigma2)
</code></pre>

<hr>
<h2 id='Moy_fbm'>Title</h2><span id='topic+Moy_fbm'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Moy_fbm(id, Btilde, sigmahat, Phi, Y, Z, H, time, sigma2)
</code></pre>

<hr>
<h2 id='Moy_sto'>Title</h2><span id='topic+Moy_sto'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Moy_sto(id, Btilde, sigmahat, Phi, Y, Z, sto, time, sigma2)
</code></pre>

<hr>
<h2 id='opti.exp'>Title</h2><span id='topic+opti.exp'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opti.exp(X, Y, id, Z, iter, mtry, ntree, time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="opti.exp_+3A_time">time</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='opti.FBM'>Title</h2><span id='topic+opti.FBM'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opti.FBM(X, Y, id, Z, iter, mtry, ntree, time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="opti.FBM_+3A_time">time</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='opti.FBMreem'>Title</h2><span id='topic+opti.FBMreem'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opti.FBMreem(X, Y, id, Z, iter, mtry, ntree, time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="opti.FBMreem_+3A_time">time</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='predict.exp'>blabla</h2><span id='topic+predict.exp'></span>

<h3>Description</h3>

<p>blabla
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'exp'
predict(omega, time.app, time.test, alpha)
</code></pre>

<hr>
<h2 id='predict.fbm'>Title</h2><span id='topic+predict.fbm'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fbm'
predict(omega, time.app, time.test, h)
</code></pre>

<hr>
<h2 id='predict.longituRF'>Predict with longitudinal trees and random forests.</h2><span id='topic+predict.longituRF'></span>

<h3>Description</h3>

<p>Predict with longitudinal trees and random forests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'longituRF'
predict(object, X, Z, id, time, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.longituRF_+3A_object">object</code></td>
<td>
<p>: a <code>longituRF</code> output of (S)MERF; (S)REEMforest; (S)MERT or (S)REEMtree function.</p>
</td></tr>
<tr><td><code id="predict.longituRF_+3A_x">X</code></td>
<td>
<p>[matrix]: matrix of the fixed effects for the new observations to be predicted.</p>
</td></tr>
<tr><td><code id="predict.longituRF_+3A_z">Z</code></td>
<td>
<p>[matrix]: matrix of the random effects for the new observations to be predicted.</p>
</td></tr>
<tr><td><code id="predict.longituRF_+3A_id">id</code></td>
<td>
<p>[vector]: vector of the identifiers of the new observations to be predicted.</p>
</td></tr>
<tr><td><code id="predict.longituRF_+3A_time">time</code></td>
<td>
<p>[vector]: vector of the time measurements of the new observations to be predicted.</p>
</td></tr>
<tr><td><code id="predict.longituRF_+3A_...">...</code></td>
<td>
<p>: low levels arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of the predicted output for the new observations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
data &lt;- DataLongGenerator(n=20) # Generate the data composed by n=20 individuals.
REEMF &lt;- REEMforest(X=data$X,Y=data$Y,Z=data$Z,id=data$id,time=data$time,mtry=2,ntree=500,sto="BM")
# Then we predict on the learning sample :
pred.REEMF &lt;- predict(REEMF, X=data$X,Z=data$Z,id=data$id, time=data$time)
# Let's have a look at the predictions
# the predictions are in red while the real output trajectories are in blue:
par(mfrow=c(4,5),mar=c(2,2,2,2))
for (i in unique(data$id)){
  w &lt;- which(data$id==i)
  plot(data$time[w],data$Y[w],type="l",col="blue")
  lines(data$time[w],pred.REEMF[w], col="red")
}
# Train error :
mean((pred.REEMF-data$Y)^2)

# The same function can be used with a fitted SMERF model:
smerf &lt;-MERF(X=data$X,Y=data$Y,Z=data$Z,id=data$id,time=data$time,mtry=2,ntree=500,sto="BM")
pred.smerf &lt;- predict(smerf, X=data$X,Z=data$Z,id=data$id, time=data$time)
# Train error :
mean((pred.smerf-data$Y)^2)
# This function can be used even on a MERF model (when no stochastic process is specified)
merf &lt;-MERF(X=data$X,Y=data$Y,Z=data$Z,id=data$id,time=data$time,mtry=2,ntree=500,sto="none")
pred.merf &lt;- predict(merf, X=data$X,Z=data$Z,id=data$id, time=data$time)
# Train error :
mean((pred.merf-data$Y)^2)


</code></pre>

<hr>
<h2 id='predict.sto'>Title</h2><span id='topic+predict.sto'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sto'
predict(omega, time.app, time.test, sto)
</code></pre>

<hr>
<h2 id='REEMforest'>(S)REEMforest algorithm</h2><span id='topic+REEMforest'></span>

<h3>Description</h3>

<p>(S)REEMforest algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REEMforest(
  X,
  Y,
  id,
  Z,
  iter = 100,
  mtry,
  ntree = 500,
  time,
  sto,
  delta = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="REEMforest_+3A_x">X</code></td>
<td>
<p>[matrix]: A <code>N</code>x<code>p</code> matrix containing the <code>p</code> predictors of the fixed effects, column codes for a predictor.</p>
</td></tr>
<tr><td><code id="REEMforest_+3A_y">Y</code></td>
<td>
<p>[vector]: A vector containing the output trajectories.</p>
</td></tr>
<tr><td><code id="REEMforest_+3A_id">id</code></td>
<td>
<p>[vector]: Is the vector of the identifiers for the different trajectories.</p>
</td></tr>
<tr><td><code id="REEMforest_+3A_z">Z</code></td>
<td>
<p>[matrix]: A <code>N</code>x<code>q</code> matrix containing the <code>q</code> predictor of the random effects.</p>
</td></tr>
<tr><td><code id="REEMforest_+3A_iter">iter</code></td>
<td>
<p>[numeric]: Maximal number of iterations of the algorithm. The default is set to <code>iter=100</code></p>
</td></tr>
<tr><td><code id="REEMforest_+3A_mtry">mtry</code></td>
<td>
<p>[numeric]: Number of variables randomly sampled as candidates at each split. The default value is <code>p/3</code>.</p>
</td></tr>
<tr><td><code id="REEMforest_+3A_ntree">ntree</code></td>
<td>
<p>[numeric]: Number of trees to grow. This should not be set to too small a number, to ensure that every input row gets predicted at least a few times. The default value is <code>ntree=500</code>.</p>
</td></tr>
<tr><td><code id="REEMforest_+3A_time">time</code></td>
<td>
<p>[time]: Is the vector of the measurement times associated with the trajectories in <code>Y</code>,<code>Z</code> and <code>X</code>.</p>
</td></tr>
<tr><td><code id="REEMforest_+3A_sto">sto</code></td>
<td>
<p>[character]: Defines the covariance function of the stochastic process, can be either <code>"none"</code> for no stochastic process, <code>"BM"</code> for Brownian motion, <code>OrnUhl</code> for standard Ornstein-Uhlenbeck process, <code>BBridge</code> for Brownian Bridge, <code>fbm</code> for Fractional Brownian motion; can also be a function defined by the user.</p>
</td></tr>
<tr><td><code id="REEMforest_+3A_delta">delta</code></td>
<td>
<p>[numeric]: The algorithm stops when the difference in log likelihood between two iterations is smaller than <code>delta</code>. The default value is set to O.O01</p>
</td></tr>
</table>


<h3>Details</h3>

<p>(S)REEMforest is an adaptation of the random forest regression method to longitudinal data introduced by Capitaine et. al. (2020) &lt;doi:10.1177/0962280220946080&gt;.
The algorithm will estimate the parameters of the following semi-parametric stochastic mixed-effects model: </p>
<p style="text-align: center;"><code class="reqn">Y_i(t)=f(X_i(t))+Z_i(t)\beta_i + \omega_i(t)+\epsilon_i</code>
</p>

<p>with <code class="reqn">Y_i(t)</code> the output at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">X_i(t)</code> the input predictors (fixed effects) at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual;
<code class="reqn">Z_i(t)</code> are the random effects at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">\omega_i(t)</code> is the stochastic process at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual
which model the serial correlations of the output measurements; <code class="reqn">\epsilon_i</code> is the residual error.
</p>


<h3>Value</h3>

<p>A fitted (S)REEMforest model which is a list of the following elements: </p>

<ul>
<li> <p><code>forest:</code> Random forest obtained at the last iteration.
</p>
</li>
<li> <p><code>random_effects :</code> Predictions of random effects for different trajectories.
</p>
</li>
<li> <p><code>id_btilde:</code> Identifiers of individuals associated with the predictions <code>random_effects</code>.
</p>
</li>
<li> <p><code>var_random_effects: </code> Estimation of the variance covariance matrix of random effects.
</p>
</li>
<li> <p><code>sigma_sto: </code> Estimation of the volatility parameter of the stochastic process.
</p>
</li>
<li> <p><code>sigma: </code> Estimation of the residual variance parameter.
</p>
</li>
<li> <p><code>time: </code> The vector of the measurement times associated with the trajectories in <code>Y</code>,<code>Z</code> and <code>X</code>.
</p>
</li>
<li> <p><code>sto: </code> Stochastic process used in the model.
</p>
</li>
<li> <p><code>Vraisemblance:</code> Log-likelihood of the different iterations.
</p>
</li>
<li> <p><code>id: </code> Vector of the identifiers for the different trajectories.
</p>
</li>
<li> <p><code>OOB: </code> OOB error of the fitted random forest at each iteration.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
data &lt;- DataLongGenerator(n=20) # Generate the data composed by n=20 individuals.
# Train a SREEMforest model on the generated data. Should take ~ 50 secondes
# The data are generated with a Brownian motion
#  so we use the parameter sto="BM" to specify a Brownian motion as stochastic process
SREEMF &lt;- REEMforest(X=data$X,Y=data$Y,Z=data$Z,id=data$id,time=data$time,mtry=2,ntree=500,sto="BM")
SREEMF$forest # is the fitted random forest (obtained at the last iteration).
SREEMF$random_effects # are the predicted random effects for each individual.
SREEMF$omega # are the predicted stochastic processes.
plot(SREEMF$Vraisemblance) #evolution of the log-likelihood.
SREEMF$OOB # OOB error at each iteration.


</code></pre>

<hr>
<h2 id='REEMtree'>(S)REEMtree algorithm</h2><span id='topic+REEMtree'></span>

<h3>Description</h3>

<p>(S)REEMtree is an adaptation of the random forest regression method to longitudinal data introduced by Sela and Simonoff. (2012) &lt;doi:10.1007/s10994-011-5258-3&gt;.
The algorithm will estimate the parameters of the following semi-parametric stochastic mixed-effects model: </p>
<p style="text-align: center;"><code class="reqn">Y_i(t)=f(X_i(t))+Z_i(t)\beta_i + \omega_i(t)+\epsilon_i</code>
</p>

<p>with <code class="reqn">Y_i(t)</code> the output at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">X_i(t)</code> the input predictors (fixed effects) at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual;
<code class="reqn">Z_i(t)</code> are the random effects at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual; <code class="reqn">\omega_i(t)</code> is the stochastic process at time <code class="reqn">t</code> for the <code class="reqn">i</code>th individual
which model the serial correlations of the output measurements; <code class="reqn">\epsilon_i</code> is the residual error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REEMtree(X, Y, id, Z, iter = 10, time, sto, delta = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="REEMtree_+3A_x">X</code></td>
<td>
<p>[matrix]: A <code>N</code>x<code>p</code> matrix containing the <code>p</code> predictors of the fixed effects, column codes for a predictor.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_y">Y</code></td>
<td>
<p>[vector]: A vector containing the output trajectories.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_id">id</code></td>
<td>
<p>[vector]: Is the vector of the identifiers for the different trajectories.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_z">Z</code></td>
<td>
<p>[matrix]: A <code>N</code>x<code>q</code> matrix containing the <code>q</code> predictor of the random effects.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_iter">iter</code></td>
<td>
<p>[numeric]: Maximal number of iterations of the algorithm. The default is set to <code>iter=100</code></p>
</td></tr>
<tr><td><code id="REEMtree_+3A_time">time</code></td>
<td>
<p>[vector]: Is the vector of the measurement times associated with the trajectories in <code>Y</code>,<code>Z</code> and <code>X</code>.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_sto">sto</code></td>
<td>
<p>[character]: Defines the covariance function of the stochastic process, can be either <code>"none"</code> for no stochastic process, <code>"BM"</code> for Brownian motion, <code>OrnUhl</code> for standard Ornstein-Uhlenbeck process, <code>BBridge</code> for Brownian Bridge, <code>fbm</code> for Fractional Brownian motion; can also be a function defined by the user.</p>
</td></tr>
<tr><td><code id="REEMtree_+3A_delta">delta</code></td>
<td>
<p>[numeric]: The algorithm stops when the difference in log likelihood between two iterations is smaller than <code>delta</code>. The default value is set to O.O01</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A fitted (S)MERF model which is a list of the following elements: </p>

<ul>
<li> <p><code>forest:</code> Tree obtained at the last iteration.
</p>
</li>
<li> <p><code>random_effects :</code> Predictions of random effects for different trajectories.
</p>
</li>
<li> <p><code>id_btilde:</code> Identifiers of individuals associated with the predictions <code>random_effects</code>.
</p>
</li>
<li> <p><code>var_random_effects: </code> Estimation of the variance covariance matrix of random effects.
</p>
</li>
<li> <p><code>sigma_sto: </code> Estimation of the volatility parameter of the stochastic process.
</p>
</li>
<li> <p><code>sigma: </code> Estimation of the residual variance parameter.
</p>
</li>
<li> <p><code>time: </code> The vector of the measurement times associated with the trajectories in <code>Y</code>,<code>Z</code> and <code>X</code>.
</p>
</li>
<li> <p><code>sto: </code> Stochastic process used in the model.
</p>
</li>
<li> <p><code>Vraisemblance:</code> Log-likelihood of the different iterations.
</p>
</li>
<li> <p><code>id: </code> Vector of the identifiers for the different trajectories.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
data &lt;- DataLongGenerator(n=20) # Generate the data composed by n=20 individuals.
# Train a SREEMtree model on the generated data.
# The data are generated with a Brownian motion,
# so we use the parameter sto="BM" to specify a Brownian motion as stochastic process
X.fixed.effects &lt;- as.data.frame(data$X)
sreemt &lt;- REEMtree(X=X.fixed.effects,Y=data$Y,Z=data$Z,id=data$id,time=data$time,
sto="BM", delta=0.0001)
sreemt$forest # is the fitted random forest (obtained at the last iteration).
sreemt$random_effects # are the predicted random effects for each individual.
sreemt$omega # are the predicted stochastic processes.
plot(sreemt$Vraisemblance) #evolution of the log-likelihood.

</code></pre>

<hr>
<h2 id='sig'>Title</h2><span id='topic+sig'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sig(sigma, id, Z, epsilon, Btilde)
</code></pre>

<hr>
<h2 id='sig_sto'>Title</h2><span id='topic+sig_sto'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sig_sto(sigma, id, Z, epsilon, Btilde, time, sigma2, sto)
</code></pre>

<hr>
<h2 id='sig.exp'>Title</h2><span id='topic+sig.exp'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sig.exp(Y, sigma, id, Z, epsilon, Btilde, time, sigma2, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sig.exp_+3A_alpha">alpha</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='sig.fbm'>Title</h2><span id='topic+sig.fbm'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sig.fbm(Y, sigma, id, Z, epsilon, Btilde, time, sigma2, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sig.fbm_+3A_h">h</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='sto_analysis'>Title</h2><span id='topic+sto_analysis'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sto_analysis(sto, time)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
