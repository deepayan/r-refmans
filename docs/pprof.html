<!DOCTYPE html><html lang="en"><head><title>Help for package pprof</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pprof}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bar_plot'><p>Get a bar plot for flagging percentage overall and stratified by provider sizes</p></a></li>
<li><a href='#caterpillar_plot'><p>Get a caterpillar plot to display confidence intervals for standardized measures</p></a></li>
<li><a href='#confint.linear_fe'><p>Get confidence intervals for provider effects or standardized measures from a fitted <code>linear_fe</code> object</p></a></li>
<li><a href='#confint.linear_re'><p>Get confidence intervals for provider effects or standardized measures from a fitted <code>linear_re</code> object</p></a></li>
<li><a href='#confint.logis_fe'><p>Get confidence intervals for provider effects or standardized measures from a fitted <code>logis_fe</code> object</p></a></li>
<li><a href='#data_check'><p>Data quality check function</p></a></li>
<li><a href='#ecls_data'><p>Early Childhood Longitudinal Study Dataset</p></a></li>
<li><a href='#ExampleDataBinary'><p>Example data with binary outcomes</p></a></li>
<li><a href='#ExampleDataLinear'><p>Example data with continuous outcomes</p></a></li>
<li><a href='#linear_fe'><p>Main function for fitting the fixed effect linear model</p></a></li>
<li><a href='#linear_re'><p>Main Function for fitting the random effect linear model</p></a></li>
<li><a href='#logis_fe'><p>Main function for fitting the fixed effect logistic model</p></a></li>
<li><a href='#plot.linear_fe'><p>Get funnel plot from a fitted <code>linear_fe</code> object for institutional comparisons</p></a></li>
<li><a href='#plot.logis_fe'><p>Get funnel plot from a fitted <code>logis_fe</code> object for institutional comparisons</p></a></li>
<li><a href='#SM_output'><p>Generic function for calculating standardized measures</p></a></li>
<li><a href='#SM_output.linear_fe'><p>Calculate direct/indirect standardized differences from a fitted <code>linear_fe</code> object</p></a></li>
<li><a href='#SM_output.linear_re'><p>Calculate direct/indirect standardized differences from a fitted <code>linear_re</code> object</p></a></li>
<li><a href='#SM_output.logis_fe'><p>Calculate direct/indirect standardized ratios/rates from a fitted <code>logis_fe</code> object</p></a></li>
<li><a href='#summary.linear_fe'><p>Result Summaries of Covariate Estimates from a fitted <code>linear_fe</code> or <code>linear_re</code> object</p></a></li>
<li><a href='#summary.logis_fe'><p>Result Summaries of Covariate Estimates from a fitted <code>logis_fe</code> object</p></a></li>
<li><a href='#test'><p>Generic function for hypothesis testing of provider effects</p></a></li>
<li><a href='#test.linear_fe'><p>Conduct hypothesis testing for provider effects from a fitted <code>linear_fe</code> object</p></a></li>
<li><a href='#test.linear_re'><p>Conduct hypothesis testing for provider effects from a fitted <code>linear_re</code> object</p></a></li>
<li><a href='#test.logis_fe'><p>Conduct hypothesis testing for provider effects from a fitted <code>logis_fe</code> object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Modeling, Standardization and Testing for Provider Profiling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-18</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements linear and generalized linear models for provider profiling,
    incorporating both fixed and random effects. For large-scale providers, the linear 
    profiled-based method and the SerBIN method for binary data 
    reduce the computational burden. Provides post-modeling features, such as 
    indirect and direct standardization measures, hypothesis testing, 
    confidence intervals, and post-estimation visualization. 
    For more information, see Wu et al. (2022) &lt;<a href="https://doi.org/10.1002%2Fsim.9387">doi:10.1002/sim.9387</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, RcppParallel, stats, caret, olsrr, pROC, poibin, dplyr,
ggplot2, Matrix, lme4, magrittr, scales, tibble, rlang</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppParallel</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/UM-KevinHe/pprof">https://github.com/UM-KevinHe/pprof</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-11 16:15:37 UTC; emily</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiaohan Liu [aut, cre],
  Lingfeng Luo [aut],
  Yubo Shao [aut],
  Xiangeng Fang [aut],
  Wenbo Wu [aut],
  Kevin He [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiaohan Liu &lt;xhliuu@umich.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-12 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bar_plot'>Get a bar plot for flagging percentage overall and stratified by provider sizes</h2><span id='topic+bar_plot'></span>

<h3>Description</h3>

<p>Generate a bar plot for flagging percentage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bar_plot(
  flag_df,
  group_num = 4,
  bar_colors = c("#66c2a5", "#fc8d62", "#8da0cb"),
  bar_width = 0.7,
  label_color = "black",
  label_size = 4
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bar_plot_+3A_flag_df">flag_df</code></td>
<td>
<p>a data frame from <code>test</code> function containing the flag of each provider.</p>
</td></tr>
<tr><td><code id="bar_plot_+3A_group_num">group_num</code></td>
<td>
<p>number of groups into which providers are divided based on their sample sizes. The default is 4.</p>
</td></tr>
<tr><td><code id="bar_plot_+3A_bar_colors">bar_colors</code></td>
<td>
<p>a vector of colors used to fill the bars representing the categories. The default is c(&quot;#66c2a5&quot;, &quot;#fc8d62&quot;, &quot;#8da0cb&quot;).</p>
</td></tr>
<tr><td><code id="bar_plot_+3A_bar_width">bar_width</code></td>
<td>
<p>width of the bars in the bar chart. The default is 0.7.</p>
</td></tr>
<tr><td><code id="bar_plot_+3A_label_color">label_color</code></td>
<td>
<p>color of the text labels inside the bars. The default is &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="bar_plot_+3A_label_size">label_size</code></td>
<td>
<p>size of the text labels inside the bars. The default is 4.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a bar chart to visualize the percentage of flagging results based on provider sizes.
The input data frame <code>test_df</code> must be the output from package <code>pprof</code>'s <code>test</code> function.
Providers are grouped into a specified number of groups (<code>group_num</code>) based on their sample sizes, where
the number of providers are approximately equal across groups. An additional &quot;overall&quot; group is
included to show the flagging results across all providers.
</p>


<h3>Value</h3>

<p>A ggplot object representing the bar chart of flagging results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+test.linear_fe">test.linear_fe</a></code>, <code><a href="#topic+test.linear_re">test.linear_re</a></code>, <code><a href="#topic+test.logis_fe">test.logis_fe</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_linear &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
test_linear &lt;- test(fit_linear)
bar_plot(test_linear)

data(ExampleDataBinary)
fit_logis &lt;- logis_fe(Y = ExampleDataBinary$Y,
                      Z = ExampleDataBinary$Z,
                      ID = ExampleDataBinary$ID, message = FALSE)
test_logis &lt;- test(fit_logis)
bar_plot(test_logis)

</code></pre>

<hr>
<h2 id='caterpillar_plot'>Get a caterpillar plot to display confidence intervals for standardized measures</h2><span id='topic+caterpillar_plot'></span>

<h3>Description</h3>

<p>Generate a caterpillar plot for standardized measures from different models using a provided CI dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caterpillar_plot(
  CI,
  point_size = 2,
  point_color = "#475569",
  refline_value = NULL,
  refline_color = "#64748b",
  refline_size = 1,
  refline_type = "dashed",
  errorbar_width = 0,
  errorbar_size = 0.5,
  errorbar_alpha = 0.5,
  errorbar_color = "#94a3b8",
  use_flag = FALSE,
  flag_color = c("#E69F00", "#56B4E9", "#009E73")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="caterpillar_plot_+3A_ci">CI</code></td>
<td>
<p>a dataframe from <code>confint</code> function containing the standardized measure values, along with their confidence intervals lower and upper bounds.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_point_size">point_size</code></td>
<td>
<p>size of the points in the caterpillar plot. The default value is 2.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_point_color">point_color</code></td>
<td>
<p>color of the points in the plot. The default value is &quot;#475569&quot;.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_refline_value">refline_value</code></td>
<td>
<p>value of the horizontal reference line, for which the standardized measures are compared. The default value is NULL.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_refline_color">refline_color</code></td>
<td>
<p>color of the reference line. The default value is &quot;#64748b&quot;.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_refline_size">refline_size</code></td>
<td>
<p>size of the reference line. The default value is 1.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_refline_type">refline_type</code></td>
<td>
<p>line type for the reference line. The default value is &quot;dashed&quot;.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_errorbar_width">errorbar_width</code></td>
<td>
<p>the width of the error bars (horizontal ends of the CI bars). The default value is 0.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_errorbar_size">errorbar_size</code></td>
<td>
<p>the thickness of the error bars. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_errorbar_alpha">errorbar_alpha</code></td>
<td>
<p>transparency level for the error bars. A value between 0 and 1, where 0 is completely transparent and 1 is fully opaque. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_errorbar_color">errorbar_color</code></td>
<td>
<p>color of the error bars. The default value is &quot;#94a3b8&quot;.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_use_flag">use_flag</code></td>
<td>
<p>logical; if <code>TRUE</code>, the error bars are colored to show providers' flags based on their performance. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="caterpillar_plot_+3A_flag_color">flag_color</code></td>
<td>
<p>vector of colors used for flagging providers when <code>use_flag = TRUE</code>. The default value is <code>c("#E69F00", "#56B4E9", "#009E73")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a caterpillar plot to visualize the standardized measures (indirect or direct).
The input <code>CI</code> must be a dataframe output from package <code>pprof</code>'s <code>confint</code> function.
Each provider's standardized measure value is represented as a point, and a reference line is shown at the value specified by <code>refline_value</code> (default is NULL).
If <code>refline_value</code> is not specified, for linear FE or RE models with indirect or direct standardized differences, it will be set to 0;
for logistic FE models with indirect or direct ratios, it will be set to 1;
and for logistic FE with indirect or direct rates, it will be set to the population rate, which represents the average rate across all observations.
</p>
<p>Confidence intervals (CI) are displayed as error bars: for <code>alternative = "two.sided"</code>, two-sided confidence intervals are shown;
for <code>alternative = "greater"</code>, error bars extend from the lower bound to the standardized measure values;
and for <code>alternative = "less"</code>, they extend from the standardized measure values to the upper bound.
For cases where one side of the confidence interval is infinite, that side only extends to the standardized measure.
For example, in a logistic fixed effect model, if a provider has all 0s or all 1s, one side of the confidence interval will be infinite.
</p>
<p>When <code>use_flag = TRUE</code>, the plot will use colors specified by <code>flag_color</code> to show the flags of providers.
Each error bar will be colored to reflect the flag, making it easy to identify providers with different performance levels.
When <code>use_flag = FALSE</code>, all error bars will have the same color, specified by <code>errorbar_color</code>.
This provides a simpler visualization without flagging individual providers.
</p>


<h3>Value</h3>

<p>A ggplot object which is a caterpillar plot for the standardized measures.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+confint.linear_fe">confint.linear_fe</a></code>, <code><a href="#topic+confint.linear_re">confint.linear_re</a></code>, <code><a href="#topic+confint.logis_fe">confint.logis_fe</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_linear &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
CI_linear &lt;- confint(fit_linear)
caterpillar_plot(CI_linear$CI.indirect, use_flag = TRUE,
                 errorbar_width = 0.5, errorbar_size = 1)

data(ExampleDataBinary)
fit_logis &lt;- logis_fe(Y = ExampleDataBinary$Y,
                      Z = ExampleDataBinary$Z,
                      ID = ExampleDataBinary$ID, message = FALSE)
CI_logis &lt;- confint(fit_logis)
caterpillar_plot(CI_logis$CI.indirect_ratio, use_flag = TRUE,
                 errorbar_width = 0.5, errorbar_size = 1)

</code></pre>

<hr>
<h2 id='confint.linear_fe'>Get confidence intervals for provider effects or standardized measures from a fitted <code>linear_fe</code> object</h2><span id='topic+confint.linear_fe'></span>

<h3>Description</h3>

<p>Provide confidence intervals for provider effects or standardized measures from from a fixed effect linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'linear_fe'
confint(
  object,
  parm,
  level = 0.95,
  option = "SM",
  stdz = "indirect",
  null = "median",
  alternative = "two.sided",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.linear_fe_+3A_object">object</code></td>
<td>
<p>a model fitted from <code>linear_fe</code>.</p>
</td></tr>
<tr><td><code id="confint.linear_fe_+3A_parm">parm</code></td>
<td>
<p>specify a subset of providers for which confidence intervals are given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="confint.linear_fe_+3A_level">level</code></td>
<td>
<p>the confidence level. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="confint.linear_fe_+3A_option">option</code></td>
<td>
<p>a character string specifying whether the confidence intervals
should be provided for provider effects or standardized measures:
</p>

<ul>
<li> <p><code>"gamma"</code> provider effect (only supports <code>"two.sided"</code> confidence interval).
</p>
</li>
<li> <p><code>"SM"</code> standardized measures.
</p>
</li></ul>
</td></tr>
<tr><td><code id="confint.linear_fe_+3A_stdz">stdz</code></td>
<td>
<p>a character string or a vector specifying the standardization method
if <code>option</code> includes <code>"SM"</code>. See <code>stdz</code> argument in <code><a href="#topic+SM_output.linear_fe">SM_output.linear_fe</a></code>.</p>
</td></tr>
<tr><td><code id="confint.linear_fe_+3A_null">null</code></td>
<td>
<p>a character string or a number specifying the population norm for calculating standardized measures
if <code>option</code> includes <code>"SM"</code>. See <code>null</code> argument in <code><a href="#topic+SM_output.linear_fe">SM_output.linear_fe</a></code>.</p>
</td></tr>
<tr><td><code id="confint.linear_fe_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.
Note that <code>"gamma"</code> for argument <code>option</code> only supports <code>"two.sided"</code>.</p>
</td></tr>
<tr><td><code id="confint.linear_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames containing the confidence intervals based on the values of <code>option</code> and <code>stdz</code>.
</p>
<table role = "presentation">
<tr><td><code>CI.gamma</code></td>
<td>
<p>Confidence intervals for provider effects if <code>option</code> includes <code>"gamma"</code>.</p>
</td></tr>
<tr><td><code>CI.indirect</code></td>
<td>
<p>Confidence intervals for indirect standardized differences if <code>option</code> includes <code>"SM"</code> and <code>stdz</code> includes <code>"indirect"</code>.</p>
</td></tr>
<tr><td><code>CI.direct</code></td>
<td>
<p>Confidence intervals for direct standardized differences if <code>option</code> includes <code>"SM"</code> and <code>stdz</code> includes <code>"direct"</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_linear &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
confint(fit_linear)

</code></pre>

<hr>
<h2 id='confint.linear_re'>Get confidence intervals for provider effects or standardized measures from a fitted <code>linear_re</code> object</h2><span id='topic+confint.linear_re'></span>

<h3>Description</h3>

<p>Provide confidence intervals for provider effects or standardized measures from a random effect linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'linear_re'
confint(
  object,
  parm,
  level = 0.95,
  option = "SM",
  stdz = "indirect",
  alternative = "two.sided",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.linear_re_+3A_object">object</code></td>
<td>
<p>a model fitted from <code>linear_re</code>.</p>
</td></tr>
<tr><td><code id="confint.linear_re_+3A_parm">parm</code></td>
<td>
<p>specify a subset of providers for which confidence intervals are given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="confint.linear_re_+3A_level">level</code></td>
<td>
<p>the confidence level. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="confint.linear_re_+3A_option">option</code></td>
<td>
<p>a character string specifying whether the confidence intervals
should be provided for provider effects or standardized measures:
</p>

<ul>
<li> <p><code>"alpha"</code> provider effect.
</p>
</li>
<li> <p><code>"SM"</code> standardized measures.
</p>
</li></ul>
</td></tr>
<tr><td><code id="confint.linear_re_+3A_stdz">stdz</code></td>
<td>
<p>a character string or a vector specifying the standardization method
if <code>option</code> includes <code>"SM"</code>. See <code>stdz</code> argument in <code><a href="#topic+SM_output.linear_re">SM_output.linear_re</a></code>.</p>
</td></tr>
<tr><td><code id="confint.linear_re_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.
Note that <code>"alpha"</code> for argument <code>option</code> only supports <code>"two.sided"</code>.</p>
</td></tr>
<tr><td><code id="confint.linear_re_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames containing the confidence intervals based on the values of <code>option</code> and <code>stdz</code>.
</p>
<table role = "presentation">
<tr><td><code>CI.alpha</code></td>
<td>
<p>Confidence intervals for provider effects if <code>option</code> includes <code>"alpha"</code>.</p>
</td></tr>
<tr><td><code>CI.indirect</code></td>
<td>
<p>Confidence intervals for indirect standardized differences if <code>option</code> includes <code>"SM"</code> and <code>stdz</code> includes <code>"indirect"</code>.</p>
</td></tr>
<tr><td><code>CI.direct</code></td>
<td>
<p>Confidence intervals for direct standardized differences if <code>option</code> includes <code>"SM"</code> and <code>stdz</code> includes <code>"direct"</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
ID &lt;- ExampleDataLinear$ID
covar &lt;- ExampleDataLinear$Z
fit_re &lt;- linear_re(Y = outcome, Z = covar, ID = ID)
confint(fit_re)

</code></pre>

<hr>
<h2 id='confint.logis_fe'>Get confidence intervals for provider effects or standardized measures from a fitted <code>logis_fe</code> object</h2><span id='topic+confint.logis_fe'></span>

<h3>Description</h3>

<p>Provide confidence intervals for provider effects or standardized measures from a fixed effect logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logis_fe'
confint(
  object,
  parm,
  level = 0.95,
  test = "exact",
  option = "SM",
  stdz = "indirect",
  null = "median",
  measure = c("rate", "ratio"),
  alternative = "two.sided",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.logis_fe_+3A_object">object</code></td>
<td>
<p>a model fitted from <code>logis_fe</code>.</p>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_parm">parm</code></td>
<td>
<p>specify a subset of providers for which confidence intervals are given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_level">level</code></td>
<td>
<p>the confidence level. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_test">test</code></td>
<td>
<p>a character string specifying the type of testing method. The default is &quot;exact&quot;.
</p>

<ul>
<li> <p><code>"exact"</code> exact test.
</p>
</li>
<li> <p><code>"wald"</code> wald test.
</p>
</li>
<li> <p><code>"score"</code> score test.
</p>
</li></ul>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_option">option</code></td>
<td>
<p>a character string specifying whether the confidence intervals
should be provided for provider effects or standardized measures:
</p>

<ul>
<li> <p><code>"gamma"</code> provider effect.
</p>
</li>
<li> <p><code>"SM"</code> standardized measures.
</p>
</li></ul>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_stdz">stdz</code></td>
<td>
<p>a character string or a vector specifying the standardization method
if <code>option = "SM"</code>. See <code>stdz</code> argument in <code><a href="#topic+SM_output.logis_fe">SM_output.logis_fe</a></code>.</p>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_null">null</code></td>
<td>
<p>a character string or a number defining the population norm if <code>option = "SM"</code>.</p>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_measure">measure</code></td>
<td>
<p>a character string or a vector indicating whether the output measure is &quot;ratio&quot; or &quot;rate&quot; if <code>option = "SM"</code>.
Both &quot;rate&quot; and &quot;ratio&quot; will be provided by default.
</p>

<ul>
<li> <p><code>"rate"</code> output the standardized rate. The &quot;rate&quot; has been restricted to 0% - 100%.
</p>
</li>
<li> <p><code>"ratio"</code>  output the standardized ratio.
</p>
</li>
<li> <p><code>c("ratio", "rate")</code> output both the standardized rate and ratio.
</p>
</li></ul>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.
Note that <code>"gamma"</code> for argument <code>option</code> only supports <code>"two.sided"</code>.</p>
</td></tr>
<tr><td><code id="confint.logis_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The wald test is invalid for extreme providers (i.e. when provider effect goes to infinity).
We suggest using score or exact test to generate confidence intervals.
</p>


<h3>Value</h3>

<p>A dataframe (<code>option = "gamma"</code>) or a list of data frames (<code>option = "SM"</code>) containing the point estimate, and lower and upper bounds of the estimate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
outcome = ExampleDataBinary$Y
covar = ExampleDataBinary$Z
ID = ExampleDataBinary$ID
fit_fe &lt;- logis_fe(Y = outcome, Z = covar, ID = ID, message = FALSE)
confint(fit_fe, option = "gamma")
confint(fit_fe, option = "SM")

</code></pre>

<hr>
<h2 id='data_check'>Data quality check function</h2><span id='topic+data_check'></span>

<h3>Description</h3>

<p>Conduct data quality check including checking missingness, variation, correlation and VIF of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_check(Y, Z, ID)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_check_+3A_y">Y</code></td>
<td>
<p>a numeric vector indicating the outcome variable.</p>
</td></tr>
<tr><td><code id="data_check_+3A_z">Z</code></td>
<td>
<p>a matrix or data frame representing covariates.</p>
</td></tr>
<tr><td><code id="data_check_+3A_id">ID</code></td>
<td>
<p>a numeric vector representing the provider identifier.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs the following checks:
</p>

<ul>
<li> <p><strong>Missingness:</strong> Checks for any missing values in the dataset and provides a summary of missing data.
</p>
</li>
<li> <p><strong>Variation:</strong> Identifies covariates with zero or near-zero variance which might affect model stability.
</p>
</li>
<li> <p><strong>Correlation:</strong> Analyzes pairwise correlation among covariates and highlights highly correlated pairs.
</p>
</li>
<li> <p><strong>VIF:</strong> Computes the Variable Inflation Factors to identify covariates with potential multicollinearity issues.
</p>
</li></ul>

<p>If issues arise when using the model functions <code>logis_fe</code>, <code>linear_fe</code> and <code>linear_re</code>,
this function can be called for data quality checking purposes.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
outcome = ExampleDataBinary$Y
covar = ExampleDataBinary$Z
ID = ExampleDataBinary$ID
data_check(outcome, covar, ID)

</code></pre>

<hr>
<h2 id='ecls_data'>Early Childhood Longitudinal Study Dataset</h2><span id='topic+ecls_data'></span>

<h3>Description</h3>

<p>The Early Childhood Longitudinal Study (ECLS) dataset tracks more than 18,000 children
from kindergarten through fifth grade, providing comprehensive student-level information. See Tourangeau et al. (2015) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ecls_data)
</code></pre>


<h3>Format</h3>

<p>A data frame with 9,101 observations, including:
</p>

<dl>
<dt>Child_ID</dt><dd><p>Unique identifier for each child in the dataset.</p>
</dd>
<dt>School_ID</dt><dd><p>Identifier for each school in the dataset.</p>
</dd>
<dt>Math_Score</dt><dd><p>Continuous variable representing the consolidated math proficiency score.</p>
</dd>
<dt>Income</dt><dd><p>Household income, categorized into 18 ordinal levels, from $5,000 or less to $200,000 or more. Treated as a continuous variable in the analysis.</p>
</dd>
<dt>Child_Sex</dt><dd><p>Binary variable indicating the gender of each student.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset includes fifth-grade cross-sectional data, focusing on students' mathematical
assessment scores as the primary outcome measure. The mathematical assessment covers 18 topics
such as number sense, properties, operations, measurement, geometry, data analysis, and algebra.
These items evaluate students' competencies in conceptual knowledge, procedural knowledge, and
problem-solving, consolidated into a single &quot;Math score.&quot; A higher score indicates greater proficiency.
The primary predictors are household income and gender, where gender is a categorical variable.
Household income is categorized into 18 ordinal levels, ranging from $5,000 or less (level 1) to
$200,000 or more (level 18). In the analysis, the income variable is treated as a continuous variable.
The dataset removes all records with missing values and consists of 9,101 complete observations from 2,275 schools.
</p>


<h3>Source</h3>

<p>Available at the following website: <a href="https://nces.ed.gov/ecls/">https://nces.ed.gov/ecls/</a>.
</p>


<h3>References</h3>

<p>Tourangeau, K., Nord, C., Lê, T., Sorongon, A. G., Hagedorn, M. C., Daly, P.,
&amp; Najarian, M. (2015). Early Childhood Longitudinal Study, Kindergarten Class of
2010-11 (ECLS-K:2011): User’s manual for the ECLS-K:2011 kindergarten data file
and electronic codebook, public version (NCES 2015-074). National Center for
Education Statistics.
<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ecls_data)
formula_FE &lt;- as.formula("Math_Score ~ Income + id(School_ID) + Child_Sex")
fit_FE &lt;- linear_fe(formula = formula_FE, data = ecls_data)

formula_RE &lt;- as.formula("Math_Score ~ Income + (1|School_ID) + Child_Sex")
fit_RE &lt;- linear_re(formula = formula_RE, data = ecls_data)
</code></pre>

<hr>
<h2 id='ExampleDataBinary'>Example data with binary outcomes</h2><span id='topic+ExampleDataBinary'></span>

<h3>Description</h3>

<p>A simulated data set containing 7994 observations, 5 continuous covariates and 100 providers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
</code></pre>


<h3>Format</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>Y</dt><dd><p>a vector representing binary outcomes with 0 or 1.
Generated from a Bernoulli distribution with the probability of success (<code class="reqn">\boldsymbol{\mu}</code>), which is
determined by applying the logistic function to the linear combination of provider effects and covariates.</p>
</dd>
<dt>ID</dt><dd><p>a vector representing identifier for each provider.
The number of individuals per provider is generated from a
Poisson distribution with mean 80, with a minimum value of 11.</p>
</dd>
<dt>Z</dt><dd><p>a data frame containing 5 continuous variables.
Generated from a multivariate normal distribution, where the mean is calculated as
<code class="reqn">(\gamma_i - \mu_{\gamma}) \cdot \rho / \sigma_{\gamma}</code> with <code class="reqn">\mu_{\gamma} = \log(4/11)</code> and <code class="reqn">\sigma_{\gamma} = 0.4</code>,
and the correlation between covariates and provider effects is 0.1.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
head(ExampleDataBinary$Y)
head(ExampleDataBinary$ID)
head(ExampleDataBinary$Z)
</code></pre>

<hr>
<h2 id='ExampleDataLinear'>Example data with continuous outcomes</h2><span id='topic+ExampleDataLinear'></span>

<h3>Description</h3>

<p>A simulated data set containing 7901 observations, 5 continuous covariates and 100 providers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
</code></pre>


<h3>Format</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>Y</dt><dd><p>a vector representing continuous outcomes.
Generated as a linear combination of provider-specific effects, covariates, and a random error term (<code class="reqn">\epsilon</code>),
where <code class="reqn">\epsilon</code> follows a normal distribution with mean 0 and standard deviation 1.</p>
</dd>
<dt>ID</dt><dd><p>a vector representing identifier for each provider.
The number of individuals per provider is generated from a Poisson distribution with mean 80.</p>
</dd>
<dt>Z</dt><dd><p>a data frame containing 5 continuous variables.
Generated from a multivariate normal distribution, where the mean is calculated as
<code class="reqn">(\gamma_i - \mu_{\gamma}) \cdot \rho / \sigma_{\gamma}</code> with <code class="reqn">\mu_{\gamma} = \log(4/11)</code> and <code class="reqn">\sigma_{\gamma} = 0.4</code>,
and the correlation between covariates and provider effects is 0.1.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
head(ExampleDataLinear$Y)
head(ExampleDataLinear$ID)
head(ExampleDataLinear$Z)
</code></pre>

<hr>
<h2 id='linear_fe'>Main function for fitting the fixed effect linear model</h2><span id='topic+linear_fe'></span>

<h3>Description</h3>

<p>Fit a fixed effect linear model via profile likelihood or dummy encoding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linear_fe(
  formula = NULL,
  data = NULL,
  Y = NULL,
  Z = NULL,
  ID = NULL,
  Y.char = NULL,
  Z.char = NULL,
  ID.char = NULL,
  method = "pl"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linear_fe_+3A_formula">formula</code></td>
<td>
<p>a two-sided formula object describing the model to be fitted,
with the response variable on the left of a ~ operator and covariates on the right,
separated by + operators. The fixed effect of the provider identifier is specified using <code>id()</code>.</p>
</td></tr>
<tr><td><code id="linear_fe_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables named in the <code>formula</code>,
or the columns specified by <code>Y.char</code>, <code>Z.char</code>, and <code>ID.char</code>.</p>
</td></tr>
<tr><td><code id="linear_fe_+3A_y">Y</code></td>
<td>
<p>a numeric vector representing the response variable.</p>
</td></tr>
<tr><td><code id="linear_fe_+3A_z">Z</code></td>
<td>
<p>a matrix or data frame representing the covariates, which can include both numeric and categorical variables.</p>
</td></tr>
<tr><td><code id="linear_fe_+3A_id">ID</code></td>
<td>
<p>a numeric vector representing the provider identifier.</p>
</td></tr>
<tr><td><code id="linear_fe_+3A_y.char">Y.char</code></td>
<td>
<p>a character string specifying the column name of the response variable in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="linear_fe_+3A_z.char">Z.char</code></td>
<td>
<p>a character vector specifying the column names of the covariates in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="linear_fe_+3A_id.char">ID.char</code></td>
<td>
<p>a character string specifying the column name of the provider identifier in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="linear_fe_+3A_method">method</code></td>
<td>
<p>a character string specifying the method to fit the model.
</p>

<ul>
<li><p><code>"pl"</code> (default) uses profile likelihood to fit the model.
</p>
</li>
<li><p><code>"dummy"</code> calls <code><a href="stats.html#topic+lm">lm</a></code> to fit the model using dummy variables for the provider identifier.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to fit a fixed effect linear model of the form:
</p>
<p style="text-align: center;"><code class="reqn">Y_{ij} = \gamma_i + \mathbf{Z}_{ij}^\top\boldsymbol\beta + \epsilon_{ij}</code>
</p>

<p>where <code class="reqn">Y_{ij}</code> is the continuous outcome for individual <code class="reqn">j</code> in provider <code class="reqn">i</code>, <code class="reqn">\gamma_i</code> is the provider-specific effect, <code class="reqn">\mathbf{Z}_{ij}</code> are the covariates, and <code class="reqn">\boldsymbol\beta</code> is the vector of coefficients for the covariates.
The default method for fitting the model is profile likelihood, but dummy encoding can also be used by specifying the appropriate method.
When the number of providers is very large, we recommend using the profile likelihood method, as it is computationally efficient and requires
less memory usage.
</p>
<p>The function accepts three different input formats:
a formula and dataset, where the formula is of the form <code>response ~ covariates + id(provider)</code>, with <code>provider</code> representing the provider identifier;
a dataset along with the column names of the response, covariates, and provider identifier;
or the outcome vector <code class="reqn">\boldsymbol{Y}</code>, the covariate matrix or data frame <code class="reqn">\mathbf{Z}</code>, and the provider identifier vector.
</p>
<p>If issues arise during model fitting, consider using the <code>data_check</code> function to perform a data quality check,
which can help identify missing values, low variation in covariates, high-pairwise correlation, and multicollinearity.
For datasets with missing values, this function automatically removes observations (rows) with any missing values before fitting the model.
</p>


<h3>Value</h3>

<p>A list of objects with S3 class <code>"linear_fe"</code>:
</p>
<table role = "presentation">
<tr><td><code>coefficient</code></td>
<td>
<p>a list containing the estimated coefficients:
<code>beta</code>, the fixed effects for each predictor, and <code>gamma</code>, the effect for each provider.</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>a list containing the variance estimates:
<code>beta</code>, the variance-covariance matrix of the predictor coefficients, and <code>gamma</code>, the variance of the provider effects.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the residual standard error.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted values of each individual.</p>
</td></tr>
<tr><td><code>observation</code></td>
<td>
<p>the original response of each individual.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals of each individual, that is response minus fitted values.</p>
</td></tr>
<tr><td><code>linear_pred</code></td>
<td>
<p>the linear predictor of each individual.</p>
</td></tr>
<tr><td><code>data_include</code></td>
<td>
<p>the data used to fit the model, sorted by the provider identifier.
For categorical covariates, this includes the dummy variables created for
all categories except the reference level.</p>
</td></tr>
<tr><td><code>char_list</code></td>
<td>
<p>a list of the character vectors representing the column names for
the response variable, covariates, and provider identifier.
For categorical variables, the names reflect the dummy variables created for each category.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the method used for model fitting, either <code>"Profile Likelihood"</code> or <code>"Dummy"</code>.</p>
</td></tr>
<tr><td><code>Loglkd</code></td>
<td>
<p>log likelihood.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hsiao, C. (2022). Analysis of panel data (No. 64). Cambridge university press.
<br />
</p>
<p>R Core Team (2023). <em>The R Stats Package: lm</em>.
Available at: <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html">https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html</a>
<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data_check">data_check</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
data &lt;- data.frame(outcome, ID, covar)
covar.char &lt;- colnames(covar)
outcome.char &lt;- colnames(data)[1]
ID.char &lt;- colnames(data)[2]
formula &lt;- as.formula(paste("outcome ~", paste(covar.char, collapse = " + "), "+ id(ID)"))

# Fit fixed linear effect model using three input formats
fit_fe1 &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
fit_fe2 &lt;- linear_fe(data = data, Y.char = outcome.char, Z.char = covar.char, ID.char = ID.char)
fit_fe3 &lt;- linear_fe(formula, data)

</code></pre>

<hr>
<h2 id='linear_re'>Main Function for fitting the random effect linear model</h2><span id='topic+linear_re'></span>

<h3>Description</h3>

<p>Fit a random effect linear model via <code><a href="lme4.html#topic+lmer">lmer</a></code> from the <code>lme4</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linear_re(
  formula = NULL,
  data = NULL,
  Y = NULL,
  Z = NULL,
  ID = NULL,
  Y.char = NULL,
  Z.char = NULL,
  ID.char = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linear_re_+3A_formula">formula</code></td>
<td>
<p>a two-sided formula object describing the model to be fitted,
with the response variable on the left of a ~ operator and covariates on the right,
separated by + operators. The random effect of the provider identifier is specified using <code>(1 | )</code>.</p>
</td></tr>
<tr><td><code id="linear_re_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables named in the <code>formula</code>,
or the columns specified by <code>Y.char</code>, <code>Z.char</code>, and <code>ID.char</code>.</p>
</td></tr>
<tr><td><code id="linear_re_+3A_y">Y</code></td>
<td>
<p>a numeric vector representing the response variable.</p>
</td></tr>
<tr><td><code id="linear_re_+3A_z">Z</code></td>
<td>
<p>a matrix or data frame representing the covariates, which can include both numeric and categorical variables.</p>
</td></tr>
<tr><td><code id="linear_re_+3A_id">ID</code></td>
<td>
<p>a numeric vector representing the provider identifier.</p>
</td></tr>
<tr><td><code id="linear_re_+3A_y.char">Y.char</code></td>
<td>
<p>a character string specifying the column name of the response variable in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="linear_re_+3A_z.char">Z.char</code></td>
<td>
<p>a character vector specifying the column names of the covariates in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="linear_re_+3A_id.char">ID.char</code></td>
<td>
<p>a character string specifying the column name of the provider identifier in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="linear_re_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="lme4.html#topic+lmer">lmer</a></code> for further customization.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to fit a random effect linear model of the form:
</p>
<p style="text-align: center;"><code class="reqn">Y_{ij} = \mu + \alpha_i + \mathbf{Z}_{ij}^\top\boldsymbol\beta + \epsilon_{ij}</code>
</p>

<p>where <code class="reqn">Y_{ij}</code> is the continuous outcome for individual <code class="reqn">j</code> in provider <code class="reqn">i</code>,
<code class="reqn">\mu</code> is the overall intercept, <code class="reqn">\alpha_i</code> is the random effect for provider <code class="reqn">i</code>,
<code class="reqn">\mathbf{Z}_{ij}</code> are the covariates, and <code class="reqn">\boldsymbol\beta</code> is the vector of coefficients for the covariates.
</p>
<p>The model is fitted by overloading the <code><a href="lme4.html#topic+lmer">lmer</a></code> function from the <code>lme4</code> package.
Three different input formats are accepted:
a formula and dataset, where the formula is of the form <code>response ~ covariates + (1 | provider)</code>, with <code>provider</code> representing the provider identifier;
a dataset along with the column names of the response, covariates, and provider identifier;
or the outcome vector <code class="reqn">\boldsymbol{Y}</code>, the covariate matrix or data frame <code class="reqn">\mathbf{Z}</code>, and the provider identifier vector.
</p>
<p>In addition to these input formats, all arguments from the <code><a href="lme4.html#topic+lmer">lmer</a></code> function can be modified via <code>...</code>,
allowing for customization of model fitting options such as controlling the optimization method or adjusting convergence criteria.
By default, the model is fitted using REML (restricted maximum likelihood).
</p>
<p>If issues arise during model fitting, consider using the <code>data_check</code> function to perform a data quality check,
which can help identify missing values, low variation in covariates, high-pairwise correlation, and multicollinearity.
For datasets with missing values, this function automatically removes observations (rows) with any missing values before fitting the model.
</p>


<h3>Value</h3>

<p>A list of objects with S3 class <code>"random_re"</code>:
</p>
<table role = "presentation">
<tr><td><code>coefficient</code></td>
<td>
<p>a list containing the estimated coefficients:
<code>FE</code>, the fixed effects for each predictor and the intercept, and <code>RE</code>, the random effects for each provider.</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>a list containing the variance estimates:
<code>FE</code>, the variance-covariance matrix of the fixed effect coefficients, and <code>RE</code>, the variance of the random effects.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the residual standard error.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted values of each individual.</p>
</td></tr>
<tr><td><code>observation</code></td>
<td>
<p>the original response of each individual.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals of each individual, that is response minus fitted values.</p>
</td></tr>
<tr><td><code>linear_pred</code></td>
<td>
<p>the linear predictor of each individual.</p>
</td></tr>
<tr><td><code>data_include</code></td>
<td>
<p>the data used to fit the model, sorted by the provider identifier.
For categorical covariates, this includes the dummy variables created for
all categories except the reference level.</p>
</td></tr>
<tr><td><code>char_list</code></td>
<td>
<p>a list of the character vectors representing the column names for
the response variable, covariates, and provider identifier.
For categorical variables, the names reflect the dummy variables created for each category.</p>
</td></tr>
<tr><td><code>Loglkd</code></td>
<td>
<p>the log-likelihood.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bates D, Maechler M, Bolker B, Walker S (2015). <em>Fitting Linear Mixed-Effects Models Using lme4</em>.
Journal of Statistical Software, 67(1), 1-48.
<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data_check">data_check</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
data &lt;- data.frame(outcome, ID, covar)
covar.char &lt;- colnames(covar)
outcome.char &lt;- colnames(data)[1]
ID.char &lt;- colnames(data)[2]
formula &lt;- as.formula(paste("outcome ~", paste(covar.char, collapse = " + "), "+ (1|ID)"))

# Fit random effect linear model using three input formats
fit_re1 &lt;- linear_re(Y = outcome, Z = covar, ID = ID)
fit_re2 &lt;- linear_re(data = data, Y.char = outcome.char, Z.char = covar.char, ID.char = ID.char)
fit_re3 &lt;- linear_re(formula, data)

</code></pre>

<hr>
<h2 id='logis_fe'>Main function for fitting the fixed effect logistic model</h2><span id='topic+logis_fe'></span>

<h3>Description</h3>

<p>Fit a fixed effect logistic model via Serial blockwise inversion Newton (SerBIN) or block ascent Newton (BAN) algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logis_fe(
  formula = NULL,
  data = NULL,
  Y.char = NULL,
  Z.char = NULL,
  ID.char = NULL,
  Y = NULL,
  Z = NULL,
  ID = NULL,
  method = "SerBIN",
  max.iter = 1000,
  tol = 1e-05,
  bound = 10,
  cutoff = 10,
  backtrack = TRUE,
  stop = "or",
  threads = 1,
  message = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logis_fe_+3A_formula">formula</code></td>
<td>
<p>a two-sided formula object describing the model to be fitted,
with the response variable on the left of a ~ operator and covariates on the right,
separated by + operators. The fixed effect of the provider identifier is specified using <code>id()</code>.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables named in the <code>formula</code>,
or the columns specified by <code>Y.char</code>, <code>Z.char</code>, and <code>ID.char</code>.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_y.char">Y.char</code></td>
<td>
<p>a character string specifying the column name of the response variable in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_z.char">Z.char</code></td>
<td>
<p>a character vector specifying the column names of the covariates in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_id.char">ID.char</code></td>
<td>
<p>a character string specifying the column name of the provider identifier in the <code>data</code>.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_y">Y</code></td>
<td>
<p>a numeric vector representing the response variable.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_z">Z</code></td>
<td>
<p>a matrix or data frame representing the covariates, which can include both numeric and categorical variables.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_id">ID</code></td>
<td>
<p>a numeric vector representing the provider identifier.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_method">method</code></td>
<td>
<p>a string specifying the algorithm to be used. The default value is &quot;SerBIN&quot;.
</p>

<ul>
<li><p><code>"SerBIN"</code> uses the Serial blockwise inversion Newton algorithm to fit the model (See <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/sim.9387">Wu et al. (2022)</a>).
</p>
</li>
<li><p><code>"BAN"</code> uses the block ascent Newton algorithm to fit the model (See <a href="https://link.springer.com/article/10.1007/s10985-013-9264-6">He et al. (2013)</a>).
</p>
</li></ul>
</td></tr>
<tr><td><code id="logis_fe_+3A_max.iter">max.iter</code></td>
<td>
<p>maximum iteration number if the stopping criterion specified by <code>stop</code> is not satisfied. The default value is 10,000.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_tol">tol</code></td>
<td>
<p>tolerance used for stopping the algorithm. See details in <code>stop</code> below. The default value is 1e-5.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_bound">bound</code></td>
<td>
<p>a positive number to avoid inflation of provider effects. The default value is 10.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_cutoff">cutoff</code></td>
<td>
<p>An integer specifying the minimum number of observations required for providers.
Providers with fewer observations than the cutoff will be labeled as <code>"include = 0"</code> and excluded from model fitting. The default is 10.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_backtrack">backtrack</code></td>
<td>
<p>a Boolean indicating whether backtracking line search is implemented. The default is FALSE.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_stop">stop</code></td>
<td>
<p>a character string specifying the stopping rule to determine convergence.
</p>

<ul>
<li><p><code>"beta"</code> stop the algorithm when the infinity norm of the difference between current and previous beta coefficients is less than the <code>tol</code>.
</p>
</li>
<li><p><code>"relch"</code> stop the algorithm when the <code class="reqn">(loglik(m)-loglik(m-1))/(loglik(m))</code> (the difference between the log-likelihood of
the current iteration and the previous iteration divided by the log-likelihood of the current iteration) is less than the <code>tol</code>.
</p>
</li>
<li><p><code>"ratch"</code> stop the algorithm when <code class="reqn">(loglik(m)-loglik(m-1))/(loglik(m)-loglik(0))</code> (the difference between the log-likelihood of
the current iteration and the previous iteration divided by the difference of the log-likelihood of the current iteration and the initial iteration)
is less than the <code>tol</code>.
</p>
</li>
<li><p><code>"all"</code> stop the algorithm when all the stopping rules (<code>"beta"</code>, <code>"relch"</code>, <code>"ratch"</code>) are met.
</p>
</li>
<li><p><code>"or"</code> stop the algorithm if any one of the rules (<code>"beta"</code>, <code>"relch"</code>, <code>"ratch"</code>) is met.
</p>
</li></ul>

<p>The default value is <code>or</code>. If <code>iter.max</code> is achieved, it overrides any stop rule for algorithm termination.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_threads">threads</code></td>
<td>
<p>a positive integer specifying the number of threads to be used. The default value is 1.</p>
</td></tr>
<tr><td><code id="logis_fe_+3A_message">message</code></td>
<td>
<p>a Boolean indicating whether to print the progress of the fitting process. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function accepts three different input formats:
a formula and dataset, where the formula is of the form <code>response ~ covariates + id(provider)</code>, with <code>provider</code> representing the provider identifier;
a dataset along with the column names of the response, covariates, and provider identifier;
or the binary outcome vector <code class="reqn">\boldsymbol{Y}</code>, the covariate matrix or data frame <code class="reqn">\mathbf{Z}</code>, and the provider identifier vector.
</p>
<p>The default algorithm is based on Serial blockwise inversion Newton (SerBIN) proposed by
<a href="https://onlinelibrary.wiley.com/doi/full/10.1002/sim.9387">Wu et al. (2022)</a>,
but users can also choose to use the block ascent Newton (BAN) algorithm proposed by
<a href="https://link.springer.com/article/10.1007/s10985-013-9264-6">He et al. (2013)</a> to fit the model.
Both methodologies build upon the Newton-Raphson method, yet SerBIN simultaneously updates both the provider effect and covariate coefficient.
This concurrent update necessitates the inversion of the whole information matrix at each iteration.
In contrast, BAN adopts a two-layer updating approach, where the covariate coefficient is sequentially fixed to update the provider effect,
followed by fixing the provider effect to update the covariate coefficient.
</p>
<p>We suggest using the default <code>"SerBIN"</code> option as it typically converges subsequently much faster for most datasets.
However, in rare cases where the SerBIN algorithm encounters second-order derivative irreversibility leading to an error,
users can consider using the <code>"BAN"</code> option as an alternative.
For a deeper understanding, please consult the original article for detailed insights.
</p>
<p>If issues arise during model fitting, consider using the <code>data_check</code> function to perform a data quality check,
which can help identify missing values, low variation in covariates, high-pairwise correlation, and multicollinearity.
For datasets with missing values, this function automatically removes observations (rows) with any missing values before fitting the model.
</p>


<h3>Value</h3>

<p>A list of objects with S3 class <code>"logis_fe"</code>:
</p>
<table role = "presentation">
<tr><td><code>coefficient</code></td>
<td>
<p>a list containing the estimated coefficients:
<code>beta</code>, the fixed effects for each predictor, and <code>gamma</code>, the effect for each provider.</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>a list containing the variance estimates:
<code>beta</code>, the variance-covariance matrix of the predictor coefficients, and <code>gamma</code>, the variance of the provider effects.</p>
</td></tr>
<tr><td><code>linear_pred</code></td>
<td>
<p>the linear predictor of each individual.</p>
</td></tr>
<tr><td><code>prediction</code></td>
<td>
<p>predicted probability of each individual</p>
</td></tr>
<tr><td><code>observation</code></td>
<td>
<p>the original response of each individual.</p>
</td></tr>
<tr><td><code>Loglkd</code></td>
<td>
<p>the log-likelihood.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike info criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian info criterion.</p>
</td></tr>
<tr><td><code>AUC</code></td>
<td>
<p>area under the ROC curve.</p>
</td></tr>
<tr><td><code>char_list</code></td>
<td>
<p>a list of the character vectors representing the column names for
the response variable, covariates, and provider identifier.
For categorical variables, the names reflect the dummy variables created for each category.</p>
</td></tr>
<tr><td><code>data_include</code></td>
<td>
<p>the data used to fit the model, sorted by the provider identifier.
For categorical covariates, this includes the dummy variables created for
all categories except the reference level. Additionally, it contains three extra columns:
<code>included</code>, indicating whether the provider is included based on the <code>cutoff</code> argument;
<code>all.events</code>, indicating if all observations in the provider are 1;
<code>no.events</code>, indicating if all observations in the provider are 0.</p>
</td></tr>
</table>


<h3>References</h3>

<p>He K, Kalbfleisch, J, Li, Y, and et al. (2013) Evaluating hospital readmission rates in dialysis providers; adjusting for hospital effects.
<em>Lifetime Data Analysis</em>, <strong>19</strong>: 490-512.
<br />
</p>
<p>Wu, W, Yang, Y, Kang, J, He, K. (2022) Improving large-scale estimation and inference for profiling health care providers.
<em>Statistics in Medicine</em>, <strong>41(15)</strong>: 2840-2853.
<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data_check">data_check</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
outcome &lt;- ExampleDataBinary$Y
covar &lt;- ExampleDataBinary$Z
ID &lt;- ExampleDataBinary$ID
data &lt;- data.frame(outcome, ID, covar)
covar.char &lt;- colnames(covar)
outcome.char &lt;- colnames(data)[1]
ID.char &lt;- colnames(data)[2]
formula &lt;- as.formula(paste("outcome ~", paste(covar.char, collapse = " + "), "+ id(ID)"))

# Fit logistic linear effect model using three input formats
fit_fe1 &lt;- logis_fe(Y = outcome, Z = covar, ID = ID)
fit_fe2 &lt;- logis_fe(data = data, Y.char = outcome.char, Z.char = covar.char, ID.char = ID.char)
fit_fe3 &lt;- logis_fe(formula, data)

</code></pre>

<hr>
<h2 id='plot.linear_fe'>Get funnel plot from a fitted <code>linear_fe</code> object for institutional comparisons</h2><span id='topic+plot.linear_fe'></span>

<h3>Description</h3>

<p>Creates a funnel plot from a linear fixed effect model to compare provider performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'linear_fe'
plot(
  x,
  null = "median",
  target = 0,
  alpha = 0.05,
  labels = c("lower", "expected", "higher"),
  point_colors = c("#E69F00", "#56B4E9", "#009E73"),
  point_shapes = c(15, 17, 19),
  point_size = 2,
  point_alpha = 0.8,
  line_size = 0.8,
  target_line_type = "longdash",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.linear_fe_+3A_x">x</code></td>
<td>
<p>a model fitted from <code>linear_fe</code>.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_null">null</code></td>
<td>
<p>a character string or a number specifying null hypotheses of fixed provider effects. The default is <code>"median"</code>.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_target">target</code></td>
<td>
<p>a numeric value representing the target outcome. The default value is 0.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_alpha">alpha</code></td>
<td>
<p>a number or a vector of significance levels. The default is 0.05.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_labels">labels</code></td>
<td>
<p>a vector of labels for the plot.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_point_colors">point_colors</code></td>
<td>
<p>a vector of colors representing different provider flags. The default is <code>c("#E69F00", "#56B4E9", "#009E73")</code>.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_point_shapes">point_shapes</code></td>
<td>
<p>a vector of shapes representing different provider flags. The default is <code>c(15, 17, 19)</code>.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_point_size">point_size</code></td>
<td>
<p>size of the points. The default is 2.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_point_alpha">point_alpha</code></td>
<td>
<p>transparency level of the points. The default is 0.8.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_line_size">line_size</code></td>
<td>
<p>size of all lines, including control limits and the target line. The default is 0.8.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_target_line_type">target_line_type</code></td>
<td>
<p>line type for the target line. The default is &quot;longdash&quot;.</p>
</td></tr>
<tr><td><code id="plot.linear_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a funnel plot from a linear fixed effect model. Currently, it only supports the indirect standardized difference.
The parameter <code>alpha</code> is a vector used to calculate control limits at different significance levels.
The first value in the vector is used as the significance level for flagging each provider, utilizing the <code><a href="#topic+test.linear_fe">test.linear_fe</a></code> function.
</p>


<h3>Value</h3>

<p>A ggplot object representing the funnel plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+linear_fe">linear_fe</a></code>, <code><a href="#topic+linear_fe">linear_fe</a></code>, <code><a href="#topic+linear_fe">linear_fe</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_fe &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
plot(fit_fe)

</code></pre>

<hr>
<h2 id='plot.logis_fe'>Get funnel plot from a fitted <code>logis_fe</code> object for institutional comparisons</h2><span id='topic+plot.logis_fe'></span>

<h3>Description</h3>

<p>Creates a funnel plot from a logistic fixed effect model to compare provider performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logis_fe'
plot(
  x,
  null = "median",
  test = "score",
  target = 1,
  alpha = 0.05,
  labels = c("lower", "expected", "higher"),
  point_colors = c("#E69F00", "#56B4E9", "#009E73"),
  point_shapes = c(15, 17, 19),
  point_size = 2,
  point_alpha = 0.8,
  line_size = 0.8,
  target_line_type = "longdash",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.logis_fe_+3A_x">x</code></td>
<td>
<p>a model fitted from <code>logis_fe</code>.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_null">null</code></td>
<td>
<p>a character string or a number specifying null hypotheses of fixed provider effects. The default is <code>"median"</code>.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_test">test</code></td>
<td>
<p>a character string specifying the type of testing methods to be conducted. The default is &quot;score&quot;.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_target">target</code></td>
<td>
<p>a numeric value representing the target outcome. The default value is 1.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_alpha">alpha</code></td>
<td>
<p>a number or a vector of significance levels. The default is 0.05.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_labels">labels</code></td>
<td>
<p>a vector of labels for the plot.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_point_colors">point_colors</code></td>
<td>
<p>a vector of colors representing different provider flags. The default is <code>c("#E69F00", "#56B4E9", "#009E73")</code>.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_point_shapes">point_shapes</code></td>
<td>
<p>a vector of shapes representing different provider flags. The default is <code>c(15, 17, 19)</code>.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_point_size">point_size</code></td>
<td>
<p>size of the points. The default is 2.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_point_alpha">point_alpha</code></td>
<td>
<p>transparency level of the points. The default is 0.8.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_line_size">line_size</code></td>
<td>
<p>size of all lines, including control limits and the target line. The default is 0.8.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_target_line_type">target_line_type</code></td>
<td>
<p>line type for the target line. The default is &quot;longdash&quot;.</p>
</td></tr>
<tr><td><code id="plot.logis_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a funnel plot from a logistic fixed-effect model. Currently, it only supports the indirect standardized ratio.
The parameter <code>alpha</code> is a vector used to calculate control limits at different significance levels.
The first value in the vector is used as the significance level for flagging each provider, utilizing the <code><a href="#topic+test.logis_fe">test.logis_fe</a></code> function.
</p>


<h3>Value</h3>

<p>A ggplot object representing the funnel plot.
</p>


<h3>References</h3>

<p>Wu, W., Kuriakose, J. P., Weng, W., Burney, R. E., &amp; He, K. (2023). Test-specific funnel plots for healthcare provider profiling leveraging
individual- and summary-level information. <em>Health Services and Outcomes Research Methodology</em>, <strong>23(1)</strong>, 45-58.
<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logis_fe">logis_fe</a></code>, <code><a href="#topic+SM_output.linear_re">SM_output.linear_re</a></code>, <code><a href="#topic+test.logis_fe">test.logis_fe</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
outcome &lt;- ExampleDataBinary$Y
covar &lt;- ExampleDataBinary$Z
ID &lt;- ExampleDataBinary$ID
fit_fe &lt;- logis_fe(Y = outcome, Z = covar, ID = ID)
plot(fit_fe)

</code></pre>

<hr>
<h2 id='SM_output'>Generic function for calculating standardized measures</h2><span id='topic+SM_output'></span>

<h3>Description</h3>

<p><code>SM_output</code> is an S3 generic function designed to calculate standardized
measures. It dispatches to the appropriate method based on the class of the
input (<code>fit</code>), ensuring the correct method is applied for different types of models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SM_output(fit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SM_output_+3A_fit">fit</code></td>
<td>
<p>the input object, typically a fitted model, for which standardized measures
are calculated. The method applied depends on the class of this object.</p>
</td></tr>
<tr><td><code id="SM_output_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to specific methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the return varies depending on the method implemented for the
class of the input object.
</p>

<hr>
<h2 id='SM_output.linear_fe'>Calculate direct/indirect standardized differences from a fitted <code>linear_fe</code> object</h2><span id='topic+SM_output.linear_fe'></span>

<h3>Description</h3>

<p>Provide direct/indirect standardized differences for a fixed effect linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'linear_fe'
SM_output(fit, parm, stdz = "indirect", null = "median", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SM_output.linear_fe_+3A_fit">fit</code></td>
<td>
<p>a model fitted from <code>linear_fe</code>.</p>
</td></tr>
<tr><td><code id="SM_output.linear_fe_+3A_parm">parm</code></td>
<td>
<p>specifies a subset of providers for which confidence intervals are to be given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="SM_output.linear_fe_+3A_stdz">stdz</code></td>
<td>
<p>a character string or a vector specifying the standardization method(s).
The possible values are:
</p>

<ul>
<li><p><code>"indirect"</code> (default) indirect standardization method.
</p>
</li>
<li><p><code>"direct"</code> direct standardization method.
</p>
</li>
<li><p><code>c("indirect", "direct")</code> outputs both direct and indirect standardized measures.
</p>
</li></ul>
</td></tr>
<tr><td><code id="SM_output.linear_fe_+3A_null">null</code></td>
<td>
<p>a character string or a number defining the population norm.
The default value is <code>"median"</code>. The possible values are:
</p>

<ul>
<li><p><code>"median"</code> the median of the provider effect estimates (<code class="reqn">\hat{\gamma}_i</code>).
</p>
</li>
<li><p><code>"mean"</code> the weighted average of the provider effect estimates (<code class="reqn">\hat{\gamma}_i</code>), where the weights correspond to the sample size of each provider.
</p>
</li>
<li><p>numeric a user-defined numeric value representing the population norm.
</p>
</li></ul>
</td></tr>
<tr><td><code id="SM_output.linear_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes standardized differences for a fixed effect linear model
using either direct or indirect methods, or both when specified.
For each method, the population norm is determined by the <code>null</code> argument.
The population norm can be the median of the estimates, their weighted mean
(with weights corresponding to provider sizes), or a user-defined numeric value.
</p>


<h3>Value</h3>

<p>A list containing the standardized differences based on the method(s) specified in <code>stdz</code>,
as well as the observed and expected outcomes used to calculate the standardized measures:
</p>
<table role = "presentation">
<tr><td><code>indirect.difference</code></td>
<td>
<p>indirect standardized differences, if <code>stdz</code> includes <code>"indirect"</code>.</p>
</td></tr>
<tr><td><code>direct.difference</code></td>
<td>
<p>direct standardized differences, if <code>stdz</code> includes <code>"direct"</code>.</p>
</td></tr>
<tr><td><code>OE</code></td>
<td>
<p>a list of data frames containing the observed and expected outcomes used for calculating standardized measures.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_linear &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
SM_output(fit_linear)
SM_output(fit_linear, stdz = "direct", null = "mean")

</code></pre>

<hr>
<h2 id='SM_output.linear_re'>Calculate direct/indirect standardized differences from a fitted <code>linear_re</code> object</h2><span id='topic+SM_output.linear_re'></span>

<h3>Description</h3>

<p>Provide direct/indirect standardized differences for a random effect linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'linear_re'
SM_output(fit, parm, stdz = "indirect", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SM_output.linear_re_+3A_fit">fit</code></td>
<td>
<p>a model fitted from <code>linear_re</code>.</p>
</td></tr>
<tr><td><code id="SM_output.linear_re_+3A_parm">parm</code></td>
<td>
<p>specifies a subset of providers for which confidence intervals are to be given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="SM_output.linear_re_+3A_stdz">stdz</code></td>
<td>
<p>a character string or a vector specifying the standardization method(s).
The possible values are:
</p>

<ul>
<li><p><code>"indirect"</code> (default) indirect standardization method.
</p>
</li>
<li><p><code>"direct"</code> direct standardization method.
</p>
</li>
<li><p><code>c("indirect", "direct")</code> outputs both direct and indirect standardized measures.
</p>
</li></ul>
</td></tr>
<tr><td><code id="SM_output.linear_re_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes standardized differences for a random effect linear model
using either direct or indirect methods, or both when specified.
The function returns both the standardized differences and the observed and expected outcomes
used for their calculation.
</p>


<h3>Value</h3>

<p>A list containing the standardized differences based on the method(s) specified in <code>stdz</code>,
as well as the observed and expected outcomes used to calculate the standardized measures:
</p>
<table role = "presentation">
<tr><td><code>indirect.difference</code></td>
<td>
<p>indirect standardized differences, if <code>stdz</code> includes <code>"indirect"</code>.</p>
</td></tr>
<tr><td><code>direct.difference</code></td>
<td>
<p>direct standardized differences, if <code>stdz</code> includes <code>"direct"</code>.</p>
</td></tr>
<tr><td><code>OE</code></td>
<td>
<p>a list of data frames containing the observed and expected outcomes used for calculating standardized measures.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_linear &lt;- linear_re(Y = outcome, Z = covar, ID = ID)
SM_output(fit_linear)

</code></pre>

<hr>
<h2 id='SM_output.logis_fe'>Calculate direct/indirect standardized ratios/rates from a fitted <code>logis_fe</code> object</h2><span id='topic+SM_output.logis_fe'></span>

<h3>Description</h3>

<p>Provide direct/indirect standardized ratios/rates for a fixed effect logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logis_fe'
SM_output(
  fit,
  parm,
  stdz = "indirect",
  measure = c("rate", "ratio"),
  null = "median",
  threads = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SM_output.logis_fe_+3A_fit">fit</code></td>
<td>
<p>a model fitted from <code>logis_fe</code>.</p>
</td></tr>
<tr><td><code id="SM_output.logis_fe_+3A_parm">parm</code></td>
<td>
<p>specifies a subset of providers for which confidence intervals are to be given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="SM_output.logis_fe_+3A_stdz">stdz</code></td>
<td>
<p>a character string or a vector specifying the standardization method(s).
The possible values are:
</p>

<ul>
<li><p><code>"indirect"</code> (default) indirect standardization method.
</p>
</li>
<li><p><code>"direct"</code> direct standardization method.
</p>
</li>
<li><p><code>c("indirect", "direct")</code> outputs both direct and indirect standardized measures.
</p>
</li></ul>
</td></tr>
<tr><td><code id="SM_output.logis_fe_+3A_measure">measure</code></td>
<td>
<p>a character string or a vector indicating whether the output measure is &quot;ratio&quot; or &quot;rate&quot;
</p>

<ul>
<li><p><code>"rate"</code> output the standardized rate. The &quot;rate&quot; has been restricted to 0% - 100%.
</p>
</li>
<li><p><code>"ratio"</code> output the standardized ratio.
</p>
</li>
<li><p><code>c("ratio", "rate")</code> (default) output both the ratio and rate.
</p>
</li></ul>
</td></tr>
<tr><td><code id="SM_output.logis_fe_+3A_null">null</code></td>
<td>
<p>if <code>"stdz = indirect"</code>, a character string or a number defining the population norm. The default is &quot;median&quot;.</p>
</td></tr>
<tr><td><code id="SM_output.logis_fe_+3A_threads">threads</code></td>
<td>
<p>an integer specifying the number of threads to use. The default value is 2.</p>
</td></tr>
<tr><td><code id="SM_output.logis_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains standardized measures, as well as the observed and expected outcomes used for calculation,
depending on the user's choice of standardization method (<code>stdz</code>) and measure type (<code>measure</code>).
</p>
<table role = "presentation">
<tr><td><code>indirect.ratio</code></td>
<td>
<p>standardization ratio using indirect method if <code>stdz</code> includes <code>"indirect"</code> and <code>measure</code> includes <code>"ratio"</code>.</p>
</td></tr>
<tr><td><code>direct.ratio</code></td>
<td>
<p>standardization ratio using direct method if <code>stdz</code> includes <code>"direct"</code> and <code>measure</code> includes <code>"ratio"</code>.</p>
</td></tr>
<tr><td><code>indirect.rate</code></td>
<td>
<p>standardization rate using indirect method if <code>stdz</code> includes <code>"indirect"</code> and <code>measure</code> includes <code>"rate"</code>.</p>
</td></tr>
<tr><td><code>direct.rate</code></td>
<td>
<p>standardization rate using direct method if <code>stdz</code> includes <code>"direct"</code> and <code>measure</code> includes <code>"rate"</code>.</p>
</td></tr>
<tr><td><code>OE</code></td>
<td>
<p>a list of data frames containing the observed and expected outcomes used for calculating standardized measures.</p>
</td></tr>
</table>


<h3>References</h3>

<p>He, K. (2019). Indirect and direct standardization for evaluating transplant centers. <em>Journal of Hospital Administration</em>, <strong>8(1)</strong>, 9-14.
<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
outcome = ExampleDataBinary$Y
covar = ExampleDataBinary$Z
ID = ExampleDataBinary$ID
fit_fe &lt;- logis_fe(Y = outcome, Z = covar, ID = ID, message = FALSE)
SR &lt;- SM_output(fit_fe, stdz = "direct", measure = "rate")
SR$direct.rate

</code></pre>

<hr>
<h2 id='summary.linear_fe'>Result Summaries of Covariate Estimates from a fitted <code>linear_fe</code> or <code>linear_re</code> object</h2><span id='topic+summary.linear_fe'></span><span id='topic+summary.linear_re'></span>

<h3>Description</h3>

<p>Provide the summary statistics for the covariate estimates for a fixed/random effect linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'linear_fe'
summary(object, parm, level = 0.95, null = 0, alternative = "two.sided", ...)

## S3 method for class 'linear_re'
summary(object, parm, level = 0.95, null = 0, alternative = "two.sided", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.linear_fe_+3A_object">object</code></td>
<td>
<p>a model fitted from <code>linear_fe</code> or <code>linear_re</code>.</p>
</td></tr>
<tr><td><code id="summary.linear_fe_+3A_parm">parm</code></td>
<td>
<p>Specifies a subset of covariates for which the result summaries should be output.
By default, all covariates are included.</p>
</td></tr>
<tr><td><code id="summary.linear_fe_+3A_level">level</code></td>
<td>
<p>the confidence level during the hypothesis test, meaning a significance level of <code class="reqn">1 - \text{level}</code>.
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="summary.linear_fe_+3A_null">null</code></td>
<td>
<p>a number defining the null hypothesis for the covariate estimates. The default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="summary.linear_fe_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.</p>
</td></tr>
<tr><td><code id="summary.linear_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing summary statistics for covariate estimates, with the following columns:
</p>
<table role = "presentation">
<tr><td><code>Estimate</code></td>
<td>
<p>the estimates of covariate coefficients.</p>
</td></tr>
<tr><td><code>Std.Error</code></td>
<td>
<p>the standard error of the estimate.</p>
</td></tr>
<tr><td><code>Stat</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>p value</code></td>
<td>
<p>the p-value for the hypothesis test.</p>
</td></tr>
<tr><td><code>CI.upper</code></td>
<td>
<p>the lower bound of the confidence interval.</p>
</td></tr>
<tr><td><code>CI.lower</code></td>
<td>
<p>the upper bound of the confidence interval.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_fe &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
summary(fit_fe)

data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_re &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
summary(fit_re)

</code></pre>

<hr>
<h2 id='summary.logis_fe'>Result Summaries of Covariate Estimates from a fitted <code>logis_fe</code> object</h2><span id='topic+summary.logis_fe'></span>

<h3>Description</h3>

<p>Provide the summary statistics for the covariate estimates for a fixed effect logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logis_fe'
summary(
  object,
  parm,
  level = 0.95,
  test = "wald",
  null = 0,
  alternative = "two.sided",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.logis_fe_+3A_object">object</code></td>
<td>
<p>a model fitted from <code>logis_fe</code>.</p>
</td></tr>
<tr><td><code id="summary.logis_fe_+3A_parm">parm</code></td>
<td>
<p>Specifies a subset of covariates for which the result summaries should be output.
By default, all covariates are included.</p>
</td></tr>
<tr><td><code id="summary.logis_fe_+3A_level">level</code></td>
<td>
<p>the confidence level during the hypothesis test, meaning a significance level of <code class="reqn">1 - \text{level}</code>.
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="summary.logis_fe_+3A_test">test</code></td>
<td>
<p>a character string specifying the type of testing method. The default is &quot;wald&quot;.
</p>

<ul>
<li><p><code>"wald"</code>: wald test.
</p>
</li>
<li><p><code>"lr"</code>: likelihood ratio test.
</p>
</li>
<li><p><code>"score"</code>: score test.
</p>
</li></ul>
</td></tr>
<tr><td><code id="summary.logis_fe_+3A_null">null</code></td>
<td>
<p>a number defining the null hypothesis for the covariate estimates. The default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="summary.logis_fe_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis when <code>test = "wald"</code>, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.</p>
</td></tr>
<tr><td><code id="summary.logis_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing summary statistics for covariate estimates, with the following columns:
</p>
<table role = "presentation">
<tr><td><code>Estimate</code></td>
<td>
<p>the estimates of covariate coefficients.</p>
</td></tr>
<tr><td><code>Std.Error</code></td>
<td>
<p>the standard error of the estimate, included only when <code>test = "wald"</code>.</p>
</td></tr>
<tr><td><code>Stat</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>p value</code></td>
<td>
<p>the p-value for the hypothesis test.</p>
</td></tr>
<tr><td><code>CI.upper</code></td>
<td>
<p>the lower bound of the confidence interval, included only when <code>test = "wald"</code>.</p>
</td></tr>
<tr><td><code>CI.lower</code></td>
<td>
<p>the upper bound of the confidence interval, included only when <code>test = "wald"</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
outcome = ExampleDataBinary$Y
covar = ExampleDataBinary$Z
ID = ExampleDataBinary$ID

fit_fe &lt;- logis_fe(Y = outcome, Z = covar, ID = ID, message = FALSE)
summary.wald &lt;- summary(fit_fe, level = 0.95, test = "wald")
summary.wald

</code></pre>

<hr>
<h2 id='test'>Generic function for hypothesis testing of provider effects</h2><span id='topic+test'></span>

<h3>Description</h3>

<p><code>test</code> is an S3 generic function used to conduct hypothesis tests on provider effect coefficients
and detect outlying provider. The function dispatches to the appropriate method
based on the class of the input model (<code>fit</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test(fit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_+3A_fit">fit</code></td>
<td>
<p>the input object, typically a fitted model, for which provider
effects are tested. The method applied depends on the class of this object.</p>
</td></tr>
<tr><td><code id="test_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to specific methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the return depends on the method implemented for the
class of the input object, typically including statistical outputs for
provider effect coefficients and identification of outlier providers.
</p>

<hr>
<h2 id='test.linear_fe'>Conduct hypothesis testing for provider effects from a fitted <code>linear_fe</code> object</h2><span id='topic+test.linear_fe'></span>

<h3>Description</h3>

<p>Conduct hypothesis tests on provider effects and identify outlying providers for a fixed effect linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'linear_fe'
test(fit, parm, level = 0.95, null = "median", alternative = "two.sided", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test.linear_fe_+3A_fit">fit</code></td>
<td>
<p>a model fitted from <code>linear_fe</code>.</p>
</td></tr>
<tr><td><code id="test.linear_fe_+3A_parm">parm</code></td>
<td>
<p>specifies a subset of providers for which confidence intervals are to be given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="test.linear_fe_+3A_level">level</code></td>
<td>
<p>the confidence level during the hypothesis test, meaning a significance level of <code class="reqn">1 - \text{level}</code>.
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="test.linear_fe_+3A_null">null</code></td>
<td>
<p>a character string or a number defining the null hypothesis for the provider effects.
The default value is <code>"median"</code>. The possible values are:
</p>

<ul>
<li><p><code>"median"</code>: The median of the provider effect estimates (<code class="reqn">\hat{\gamma}_i</code>).
</p>
</li>
<li><p><code>"mean"</code>: The weighted average of the provider effect estimates (<code class="reqn">\hat{\gamma}_i</code>), where the weights correspond to the sample size of each provider.
</p>
</li>
<li><p>numeric: A user-defined numeric value representing the null hypothesis.
</p>
</li></ul>
</td></tr>
<tr><td><code id="test.linear_fe_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.</p>
</td></tr>
<tr><td><code id="test.linear_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function identifies outlying providers based on hypothesis test results.
For two-sided tests, <code>1</code> indicates performance significantly higher than expected, <code>-1</code> indicates lower,
For one-sided tests, <code>1</code> (right-tailed) or <code>-1</code> (left-tailed) flags are used.
Providers whose performance falls within the central range are flagged as <code>0</code>.
Outlying providers are determined by the test statistic falling beyond the threshold based on the significance level <code class="reqn">1 - \text{level}</code>.
</p>


<h3>Value</h3>

<p>A data frame containing the results of the hypothesis test, with the following columns:
</p>
<table role = "presentation">
<tr><td><code>flag</code></td>
<td>
<p>a flagging indicator where <code>1</code> means statistically higher than expected
and <code>-1</code> means statistically lower than expected.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>the p-value of the hypothesis test.</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>Std.Error</code></td>
<td>
<p>the standard error of the provider effect estimate.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
covar &lt;- ExampleDataLinear$Z
ID &lt;- ExampleDataLinear$ID
fit_linear &lt;- linear_fe(Y = outcome, Z = covar, ID = ID)
test(fit_linear)

</code></pre>

<hr>
<h2 id='test.linear_re'>Conduct hypothesis testing for provider effects from a fitted <code>linear_re</code> object</h2><span id='topic+test.linear_re'></span>

<h3>Description</h3>

<p>Conduct hypothesis tests on provider effects and identify outlying providers for a random effect linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'linear_re'
test(fit, parm, level = 0.95, null = 0, alternative = "two.sided", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test.linear_re_+3A_fit">fit</code></td>
<td>
<p>a model fitted from <code>linear_re</code>.</p>
</td></tr>
<tr><td><code id="test.linear_re_+3A_parm">parm</code></td>
<td>
<p>specifies a subset of providers for which confidence intervals are to be given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="test.linear_re_+3A_level">level</code></td>
<td>
<p>the confidence level during the hypothesis test, meaning a significance level of <code class="reqn">1 - \text{level}</code>.
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="test.linear_re_+3A_null">null</code></td>
<td>
<p>a number defining the null hypothesis for the provider effects.
The default value is 0.</p>
</td></tr>
<tr><td><code id="test.linear_re_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.</p>
</td></tr>
<tr><td><code id="test.linear_re_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function identifies outlying providers based on hypothesis test results.
For two-sided tests, <code>1</code> indicates performance significantly higher than expected, <code>-1</code> indicates lower,
For one-sided tests, <code>1</code> (right-tailed) or <code>-1</code> (left-tailed) flags are used.
Providers whose performance falls within the central range are flagged as <code>0</code>.
Outlying providers are determined by the test statistic falling beyond the threshold based on the significance level <code class="reqn">1 - \text{level}</code>.
</p>


<h3>Value</h3>

<p>A data frame containing the results of the hypothesis test, with the following columns:
</p>
<table role = "presentation">
<tr><td><code>flag</code></td>
<td>
<p>a flagging indicator where <code>1</code> means statistically higher than expected
and <code>-1</code> means statistically lower than expected.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>the p-value of the hypothesis test.</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>Std.Error</code></td>
<td>
<p>the standard error of the provider effect estimate.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataLinear)
outcome &lt;- ExampleDataLinear$Y
ID &lt;- ExampleDataLinear$ID
covar &lt;- ExampleDataLinear$Z
fit_re &lt;- linear_re(Y = outcome, Z = covar, ID = ID)
test(fit_re)

</code></pre>

<hr>
<h2 id='test.logis_fe'>Conduct hypothesis testing for provider effects from a fitted <code>logis_fe</code> object</h2><span id='topic+test.logis_fe'></span>

<h3>Description</h3>

<p>Conduct hypothesis tests on provider effects and identify outlying providers for a fixed effect logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logis_fe'
test(
  fit,
  parm,
  level = 0.95,
  test = "exact.poisbinom",
  score_modified = TRUE,
  null = "median",
  n = 10000,
  threads = 1,
  alternative = "two.sided",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test.logis_fe_+3A_fit">fit</code></td>
<td>
<p>a model fitted from <code>logis_fe</code>.</p>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_parm">parm</code></td>
<td>
<p>specifies a subset of providers for which confidence intervals are to be given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_level">level</code></td>
<td>
<p>the confidence level during the hypothesis test, meaning a significance level of <code class="reqn">1 - \text{level}</code>.
The default value is 0.95.</p>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_test">test</code></td>
<td>
<p>a character string specifying the type of testing method to be conducted. The default is &quot;exact.poisbinom&quot;.
</p>

<ul>
<li><p><code>"exact.poisbinom"</code>: exact test based on Poisson-binomial distribution of <code class="reqn">O_i|Z_i</code>.
</p>
</li>
<li><p><code>"exact.bootstrap"</code>: exact test based on bootstrap procedure.
</p>
</li>
<li><p><code>"wald"</code>: wald test.
</p>
</li>
<li><p><code>"score"</code>: score test.
</p>
</li></ul>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_score_modified">score_modified</code></td>
<td>
<p>a logical indicating whether to use the modified score test
ignoring the randomness of covariate coefficient for score teat (<code>"test = score"</code>). The default value is TRUE.</p>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_null">null</code></td>
<td>
<p>a character string or a number specifying null hypotheses of fixed provider effects. The default is <code>"median"</code>.</p>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_n">n</code></td>
<td>
<p>resample size for bootstrapping when (<code>"test = exact.bootstrap"</code>). The default value is 10,000.</p>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_threads">threads</code></td>
<td>
<p>an integer specifying the number of threads to use. The default value is 1.</p>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.</p>
</td></tr>
<tr><td><code id="test.logis_fe_+3A_...">...</code></td>
<td>
<p>additional arguments that can be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, the function uses the <code>"exact.poisbinom"</code> method.
The wald test is invalid for extreme providers (i.e. when provider effect goes to infinity).
For the score test, consider that when the number of tested providers is large,
refitting the models to get the restricted MLEs will take a long time.
Therefore, we use unrestricted MLEs to replace the restricted MLEs during the testing procedure by default.
However, the user can specify <code>score_modified = FALSE</code> to perform a standard score test.
</p>


<h3>Value</h3>

<p>A data frame containing the results of the hypothesis test, with the following columns:
</p>
<table role = "presentation">
<tr><td><code>flag</code></td>
<td>
<p>a flagging indicator where <code>1</code> means statistically higher than expected
and <code>-1</code> means statistically lower than expected.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>the p-value of the hypothesis test.</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>Std.Error</code></td>
<td>
<p>The standard error of the provider effect estimate, included only when <code>test = "wald"</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wu, W, Yang, Y, Kang, J, He, K. (2022) Improving large-scale estimation and inference for profiling health care providers.
<em>Statistics in Medicine</em>, <strong>41(15)</strong>: 2840-2853.
<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleDataBinary)
outcome = ExampleDataBinary$Y
covar = ExampleDataBinary$Z
ID = ExampleDataBinary$ID
fit_fe &lt;- logis_fe(Y = outcome, Z = covar, ID = ID, message = FALSE)
test(fit_fe, test = "score")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
