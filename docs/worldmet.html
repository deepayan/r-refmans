<!DOCTYPE html><html><head><title>Help for package worldmet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {worldmet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#exportADMS'><p>Export a meteorological data frame in ADMS format</p></a></li>
<li><a href='#getMeta'><p>Find a ISD site code and other meta data</p></a></li>
<li><a href='#getMetaLive'><p>Obtain site meta data from NOAA server</p></a></li>
<li><a href='#importNOAA'><p>Import Meteorological data from the NOAA Integrated Surface Database (ISD)</p></a></li>
<li><a href='#weatherCodes'><p>Codes for weather types</p></a></li>
<li><a href='#worldmet-package'><p>worldmet: Import Surface Meteorological Data from NOAA Integrated Surface Database (ISD)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Import Surface Meteorological Data from NOAA Integrated Surface
Database (ISD)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-05</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>openair, doParallel, parallel, foreach, purrr (&ge; 1.0.0),
dplyr, leaflet, tidyr, readr, magrittr, tibble</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Carslaw &lt;david.carslaw@york.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to import data from more than 30,000 surface
    meteorological sites around the world managed by the National Oceanic and Atmospheric Administration (NOAA) Integrated Surface
    Database (ISD).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://davidcarslaw.github.io/worldmet/index.html">https://davidcarslaw.github.io/worldmet/index.html</a>,
<a href="http://davidcarslaw.github.io/worldmet/">http://davidcarslaw.github.io/worldmet/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/davidcarslaw/worldmet/issues">https://github.com/davidcarslaw/worldmet/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-05 14:45:54 UTC; davidcarslaw</td>
</tr>
<tr>
<td>Author:</td>
<td>David Carslaw [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-05 18:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='exportADMS'>Export a meteorological data frame in ADMS format</h2><span id='topic+exportADMS'></span>

<h3>Description</h3>

<p>Writes a text file in the ADMS format to a location of the user's choosing,
with optional interpolation of missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exportADMS(dat, out = "./ADMS_met.MET", interp = FALSE, maxgap = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exportADMS_+3A_dat">dat</code></td>
<td>
<p>A data frame imported by <code><a href="#topic+importNOAA">importNOAA()</a></code>.</p>
</td></tr>
<tr><td><code id="exportADMS_+3A_out">out</code></td>
<td>
<p>A file name for the ADMS file. The file is written to the working
directory by default.</p>
</td></tr>
<tr><td><code id="exportADMS_+3A_interp">interp</code></td>
<td>
<p>Should interpolation of missing values be undertaken? If <code>TRUE</code>
linear interpolation is carried out for gaps of up to and including
<code>maxgap</code>.</p>
</td></tr>
<tr><td><code id="exportADMS_+3A_maxgap">maxgap</code></td>
<td>
<p>The maximum gap in hours that should be interpolated where
there are missing data when <code>interp = TRUE.</code> Data with gaps more than
<code>maxgap</code> are left as missing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>exportADMS()</code> returns the input <code>dat</code> invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## import some data then export it
dat &lt;- importNOAA(year = 2012)
exportADMS(dat, out = "~/adms_met.MET")

## End(Not run)
</code></pre>

<hr>
<h2 id='getMeta'>Find a ISD site code and other meta data</h2><span id='topic+getMeta'></span>

<h3>Description</h3>

<p>Get information on meteorological sites
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMeta(
  site = "heathrow",
  lat = NA,
  lon = NA,
  country = NA,
  state = NA,
  n = 10,
  end.year = "current",
  provider = c("OpenStreetMap", "Esri.WorldImagery"),
  plot = TRUE,
  returnMap = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMeta_+3A_site">site</code></td>
<td>
<p>A site name search string e.g. <code>site = "heathrow"</code>. The search
strings and be partial and can be upper or lower case e.g. <code>site = "HEATHR"</code>.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_lat">lat</code></td>
<td>
<p>A latitude in decimal degrees to search. Takes the values -90 to
90.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_lon">lon</code></td>
<td>
<p>A longitude in decimal degrees to search. Takes values -180 to
180. Negative numbers are west of the Greenwich meridian.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_country">country</code></td>
<td>
<p>The country code. This is a two letter code. For a full
listing see <a href="https://www1.ncdc.noaa.gov/pub/data/noaa/isd-history.csv">https://www1.ncdc.noaa.gov/pub/data/noaa/isd-history.csv</a>.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_state">state</code></td>
<td>
<p>The state code. This is a two letter code.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_n">n</code></td>
<td>
<p>The number of nearest sites to search based on <code>latitude</code> and
<code>longitude</code>.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_end.year">end.year</code></td>
<td>
<p>To help filter sites based on how recent the available data
are. <code>end.year</code> can be &quot;current&quot;, &quot;any&quot; or a numeric year such as 2016, or
a range of years e.g. 1990:2016 (which would select any site that had an
end date in that range. <strong>By default only sites that have some data for the
current year are returned</strong>.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_provider">provider</code></td>
<td>
<p>By default a map will be created in which readers may toggle
between a vector base map and a satellite/aerial image. <code>provider</code> allows
users to override this default; see
<a href="http://leaflet-extras.github.io/leaflet-providers/preview/">http://leaflet-extras.github.io/leaflet-providers/preview/</a> for a list
of all base maps that can be used. If multiple base maps are provided, they
can be toggled between using a &quot;layer control&quot; interface.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code> will plot sites on an interactive leaflet map.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_returnmap">returnMap</code></td>
<td>
<p>Should the leaflet map be returned instead of the meta data?
Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is primarily used to find a site code that can be used to
access data using <code><a href="#topic+importNOAA">importNOAA()</a></code>. Sites searches of approximately 30,000
sites can be carried out based on the site name and based on the nearest
locations based on user-supplied latitude and longitude.
</p>


<h3>Value</h3>

<p>A data frame is returned with all available meta data, mostly
importantly including a <code>code</code> that can be supplied to <code><a href="#topic+importNOAA">importNOAA()</a></code>. If
latitude and longitude searches are made an approximate distance, <code>dist</code> in
km is also returned.
</p>


<h3>Author(s)</h3>

<p>David Carslaw
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getMetaLive">getMetaLive()</a></code> to download the all meta data to allow re-use and
direct querying.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## search for sites with name beijing
getMeta(site = "beijing")

## End(Not run)

## Not run: 
## search for near a specified lat/lon - near Beijing airport
## returns 'n' nearest by default
getMeta(lat = 40, lon = 116.9)

## End(Not run)
</code></pre>

<hr>
<h2 id='getMetaLive'>Obtain site meta data from NOAA server</h2><span id='topic+getMetaLive'></span>

<h3>Description</h3>

<p>Download all NOAA meta data, allowing for re-use and direct querying.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMetaLive(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMetaLive_+3A_...">...</code></td>
<td>
<p>Currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="tibble.html#topic+tibble-package">tibble</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
meta &lt;- getMetaLive()
head(meta)

## End(Not run)
</code></pre>

<hr>
<h2 id='importNOAA'>Import Meteorological data from the NOAA Integrated Surface Database (ISD)</h2><span id='topic+importNOAA'></span>

<h3>Description</h3>

<p>This is the main function to import data from the NOAA Integrated Surface
Database (ISD). The ISD contains detailed surface meteorological data from
around the world for over 30,000 locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importNOAA(
  code = "037720-99999",
  year = 2014,
  hourly = TRUE,
  n.cores = 1,
  quiet = FALSE,
  path = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importNOAA_+3A_code">code</code></td>
<td>
<p>The identifying code as a character string. The code is a
combination of the USAF and the WBAN unique identifiers. The codes are
separated by a &ldquo;-&rdquo; e.g. <code>code = "037720-99999"</code>.</p>
</td></tr>
<tr><td><code id="importNOAA_+3A_year">year</code></td>
<td>
<p>The year to import. This can be a vector of years e.g. <code>year = 2000:2005</code>.</p>
</td></tr>
<tr><td><code id="importNOAA_+3A_hourly">hourly</code></td>
<td>
<p>Should hourly means be calculated? The default is <code>TRUE</code>. If
<code>FALSE</code> then the raw data are returned.</p>
</td></tr>
<tr><td><code id="importNOAA_+3A_n.cores">n.cores</code></td>
<td>
<p>Number of cores to use for parallel processing. Default is 1
and hence no parallelism.</p>
</td></tr>
<tr><td><code id="importNOAA_+3A_quiet">quiet</code></td>
<td>
<p>If FALSE, print missing sites / years to the screen.</p>
</td></tr>
<tr><td><code id="importNOAA_+3A_path">path</code></td>
<td>
<p>If a file path is provided, the data are saved as an rds file at
the chosen location e.g.  <code>path = "C:/Users/David"</code>. Files are saved by
year and site.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note the following units for the main variables:
</p>

<dl>
<dt>date</dt><dd><p>Date/time in POSIXct format. <strong>Note the time zone is GMT (UTC)
and may need to be adjusted to merge with other local data. See details
below.</strong></p>
</dd>
<dt>latitude</dt><dd><p>Latitude in decimal degrees (-90 to 90).</p>
</dd>
<dt>longitude</dt><dd><p>Longitude in decimal degrees (-180 to 180). Negative numbers
are west of the Greenwich Meridian.</p>
</dd>
<dt>elevation</dt><dd><p>Elevation of site in metres.</p>
</dd>
<dt>wd</dt><dd><p>Wind direction in degrees. 90 is from the east.</p>
</dd>
<dt>ws</dt><dd><p>Wind speed in m/s.</p>
</dd>
<dt>ceil_hgt</dt><dd><p>The height above ground level (AGL) of the lowest cloud or
obscuring phenomena layer aloft with 5/8 or more summation total sky cover,
which may be predominantly opaque, or the vertical visibility into a
surface-based obstruction.</p>
</dd>
<dt>visibility</dt><dd><p>The visibility in metres.</p>
</dd>
<dt>air_temp</dt><dd><p>Air temperature in degrees Celcius.</p>
</dd>
<dt>dew_point</dt><dd><p>The dew point temperature in degrees Celcius.</p>
</dd>
<dt>atmos_pres</dt><dd><p>The sea level pressure in millibars.</p>
</dd>
<dt>RH</dt><dd><p>The relative humidity (%).</p>
</dd>
<dt>cl_1,  ...,  cl_3</dt><dd><p>Cloud cover for different layers in Oktas (1-8).</p>
</dd>
<dt>cl</dt><dd><p>Maximum of cl_1 to cl_3 cloud cover in Oktas (1-8).</p>
</dd>
<dt>cl_1_height, ..., cl_3_height</dt><dd><p>Height of the cloud base for each later
in metres.</p>
</dd>
<dt>precip_12</dt><dd><p>12-hour precipitation in mm. The sum of this column should
give the annual precipitation.</p>
</dd>
<dt>precip_6</dt><dd><p>6-hour precipitation in mm.</p>
</dd>
<dt>precip</dt><dd><p>This value of precipitation spreads the 12-hour total across
the previous 12 hours.</p>
</dd>
<dt>pwc</dt><dd><p>The description of the present weather description (if
available).</p>
</dd>
</dl>

<p>The data are returned in GMT (UTC). It may be necessary to adjust the time
zone when combining with other data. For example, if air quality data were
available for Beijing with time zone set to &quot;Etc/GMT-8&quot; (note the negative
offset even though Beijing is ahead of GMT. See the <code>openair</code> package and
manual for more details), then the time zone of the met data can be changed
to be the same. One way of doing this would be <code>attr(met$date, "tzone") &lt;- "Etc/GMT-8"</code> for a meteorological data frame called <code>met</code>. The two data sets
could then be merged based on <code>date</code>.
</p>


<h3>Value</h3>

<p>Returns a data frame of surface observations. The data frame is
consistent for use with the <code>openair</code> package. Note that the data are
returned in GMT (UTC) time zone format. Users may wish to express the data
in other time zones, e.g., to merge with air pollution data. The
<a href="lubridate.html#topic+lubridate-package">lubridate</a> package is useful in this
respect.
</p>


<h3>Author(s)</h3>

<p>David Carslaw
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getMeta">getMeta()</a></code> to obtain the codes based on various site search
approaches.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## use Beijing airport code (see getMeta example)
dat &lt;- importNOAA(code = "545110-99999", year = 2010:2011)

## End(Not run)
</code></pre>

<hr>
<h2 id='weatherCodes'>Codes for weather types</h2><span id='topic+weatherCodes'></span>

<h3>Description</h3>

<p>This data frame consists of the weather description codes used in the ISD. It
is not of general use to most users.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## basic structure
head(weatherCodes)
</code></pre>

<hr>
<h2 id='worldmet-package'>worldmet: Import Surface Meteorological Data from NOAA Integrated Surface Database (ISD)</h2><span id='topic+worldmet'></span><span id='topic+worldmet-package'></span>

<h3>Description</h3>

<p>Functions to import data from more than 30,000 surface meteorological sites around the world managed by the National Oceanic and Atmospheric Administration (NOAA) Integrated Surface Database (ISD).
</p>


<h3>Details</h3>

<p>This package contains functions to import surface meteorological
data from over 30,000 sites around the world. These data are curated by
NOAA as part of the Integrated Surface Database (ISD).
</p>
<p>If you access these data using the <code>worldmet</code> package please give full
acknowledgement to NOAA ISD. Users should also take a note of the usage
restrictions.
</p>
<p>These data work well with the <code>openair</code> package that has been developed to
analyse air pollution data.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: David Carslaw <a href="mailto:david.carslaw@york.ac.uk">david.carslaw@york.ac.uk</a>
</p>


<h3>References</h3>

<p>Search for NOAA ISD for more information.
</p>


<h3>See Also</h3>

<p>See <a href="https://github.com/davidcarslaw/openair">https://github.com/davidcarslaw/openair</a> for information on the
related <code>openair</code> package.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
