<!DOCTYPE html><html lang="en"><head><title>Help for package KnowBR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {KnowBR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adworld'><p>Geographical coordinates</p></a></li>
<li><a href='#Beetles'><p>Individual counts of species of beetles</p></a></li>
<li><a href='#Estimators'><p>Estimators obtained with the function KnowBPolygon</p></a></li>
<li><a href='#FishIrelandUK'><p>Estimators obtained with the function KnowB</p></a></li>
<li><a href='#KnowB'><p>Discriminating well surveyed cell units from exhaustive biodiversity databases</p></a></li>
<li><a href='#KnowBPolygon'><p>Discriminating well surveyed polygon units from exhaustive biodiversity databases</p></a></li>
<li><a href='#MapCell'><p>Cell maps</p></a></li>
<li><a href='#MapPolygon'><p>Choropleth maps</p></a></li>
<li><a href='#RFishes'><p>Species richness of freshwater fishes</p></a></li>
<li><a href='#States'><p>States of USA</p></a></li>
<li><a href='#SurveyQ'><p>Survey quality</p></a></li>
<li><a href='#SurveyQCZ'><p>Survey quality of climate zones</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Title:</td>
<td>Discriminating Well Surveyed Spatial Units from Exhaustive
Biodiversity Databases</td>
</tr>
<tr>
<td>Author:</td>
<td>Castor Guisande Gonzalez and Jorge M. Lobo</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Castor Guisande Gonzalez &lt;castor@uvigo.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It uses species accumulation curves and diverse estimators to assess, at the same time, the levels of survey coverage in multiple geographic cells of a size defined by the user or polygons. It also enables the geographical depiction of observed species richness, survey effort and completeness values including a background with administrative areas.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0), fossil, mgcv, plotrix, sp, vegan</td>
</tr>
<tr>
<td>Suggests:</td>
<td>raster, rgbif, usdm, car, IDPmisc, psych, candisc</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-06 21:18:54 UTC; castor</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-07 06:30:28 UTC</td>
</tr>
</table>
<hr>
<h2 id='adworld'>Geographical coordinates</h2><span id='topic+adworld'></span>

<h3>Description</h3>

<p>Latitude and longitude of all administrative areas.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(adworld)</code></pre>


<h3>Format</h3>

<p>A matrix of many rows and 3 columns (Latitude, Longitude and name of the administrative area)</p>


<h3>Source</h3>

<p>Latitude and longitude coordinates of the administrative areas were obtained from the web page <a href="https://www.openstreetmap.org">https://www.openstreetmap.org</a>.</p>

<hr>
<h2 id='Beetles'>Individual counts of species of beetles</h2><span id='topic+Beetles'></span>

<h3>Description</h3>

<p>This database includes 15,142 records belonging to 54 Iberian species of the Scarabaeidae (Coleoptera) previously compiled in the so called BANDASCA database (Lobo &amp; Martín-Piera, 2002) also freely available in GBIF (<a href="https://www.gbif.org/">https://www.gbif.org/</a>). Individual counts, longitude and latitude of species occurrences of the family Scarabaeidae in the Iberian Peninsula are provided.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Beetles)</code></pre>


<h3>Format</h3>

<p>A matrix with four columns: species, longitude, latitude and individual counts.</p>


<h3>References</h3>

<p>Lobo, J.M. &amp; Martín-Piera, F. 2002. Searching for a predictive model for Iberian dung beetle species richness based on spatial and environmental variables. <em>Conservation Biology</em> 16: 158-173.
</p>

<hr>
<h2 id='Estimators'>Estimators obtained with the function KnowBPolygon</h2><span id='topic+Estimators'></span>

<h3>Description</h3>

<p>Estimators obtained with the function <a href="#topic+KnowBPolygon">KnowBPolygon</a> using species of freshwater fish species in all the countries of the world (Guisande et al., 2010).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Estimators)</code></pre>


<h3>References</h3>

<p>Guisande, C., Manjarrés-Hernández, A., Pelayo-Villamil, P., Granado-Lorencio, C., Riveiro, I., Acuña, A., Prieto-Piraquive, E., Janeiro, E., Matías, J.M., Patti, C., Patti, B., Mazzola, S., Jiménez, L.F., Duque, S. &amp; Salmerón, F. (2010) IPez: An expert system for the taxonomic identification of fishes based on machine learning techniques. <em>Fisheries Research</em>, 102, 240-247.</p>

<hr>
<h2 id='FishIrelandUK'>Estimators obtained with the function KnowB</h2><span id='topic+FishIrelandUK'></span>

<h3>Description</h3>

<p>Estimators obtained with the function <a href="#topic+KnowB">KnowB</a> using a database that includes 121,709 records of freshwater fishes obtained from Pelayo-Villamil et al. (2015), with the Clench estimator and a cell resolution of 5'.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(FishIrelandUK)</code></pre>


<h3>References</h3>

<p>Pelayo-Villamil, P., Guisande, C., Vari, R.P., Manjarrés-Hernández, A., García-Roselló, E., González-Dacosta, J., Heine, J., González-Vilas, L., Patti, B., Quinci, E.M., Jiménez, L.F., Granado-Lorencio, C., Tedesco, P.A., Lobo, J.M. (2015) Global diversity patterns of freshwater fishes-Potential victims of their own success. <em>Diversity and Distributions</em>, 21: 345-356.
</p>

<hr>
<h2 id='KnowB'>Discriminating well surveyed cell units from exhaustive biodiversity databases</h2><span id='topic+KnowB'></span>

<h3>Description</h3>

<p>Advances during the last decades in information technology allow us to store, retrieve, transmit and manipulate an unprecedented magnitude of massive information about species distributions (Guralnick <em>et al</em>., 2007). Unfortunately, this compilation process suffers from three main shortcomings:
</p>
<p>i) <em>Unknown survey effort</em>. A lack of knowledge of the effort devoted to survey each territorial unit that is due to most occurrence records lacking any associated measure of the effort carried out to obtain them.
</p>
<p>ii) <em>Unknown absences</em>. As almost all the available information involves only species occurrences (i.e., the localities in which a species has been collected), without any indication of the likelihood that a species is actually absent from the localities where it was not collected (whether these have been surveyed or not).
</p>
<p>iii) <em>Unknown recurrence</em>. Which results from the incomplete compilation of species occurrences in many biodiversity databases, as multiple records of the same species in the same site or territorial unit are considered redundant and not reported (Hortal <em>et al</em>. 2007); this prevents teasing apart occasional records from the continued presence of the species in an area.
</p>
<p>These three limitations are mutually interrelated, so when all known occurrences are compiled exhaustively it is possible to estimate survey effort with some reliability. Therefore, a biodiversity database that compiles exhaustively all available information on the identity and distribution of a group of species would enable both identifying well-surveyed areas (e.g. Hortal and Lobo 2005) and obtaining estimates of the repeated occurrence and/or the probability of absence of particular species (e.g. Guillera-Arroita <em>et al</em>. 2010).
</p>
<p>Employing statistical shortcuts on data with unknown levels of error and bias can generate unreliable results. Consequently, good practice in biodiversity informatics requires knowledge about the number, location and degree of completeness of surveys for those territorial units that have been, at least relatively, well inventoried. Such knowledge would facilitate identifying localities where the lack of records for a target species can be reliably assumed to correspond to its actual absence. Nonetheless, it can be used to guide the location of future surveys and/or determine uncertain or ignorance areas in which biodiversity data are insufficiently consistent (Hortal and Lobo 2005, Ladle and Hortal 2013, Hortal <em>et al</em>. 2015, Ruete 2015, Meyer <em>et al</em>. 2015, 2016).
</p>
<p>Despite the widely recognized importance of evaluating data quality as a preliminary step in any biodiversity study, this process is often neglected. Arguably, this is in part because such evaluation process is highly time-consuming, for it requires using analyses spread over several software applications and/or R packages, and repeating the same process for each one of the territorial units or sites considered (or, in general, for any type of spatial unit). Here we present KnowBR, a freely available R package to estimate the survey coverage of species inventories across an unlimited number of territorial units or sites simultaneously. Starting with any biodiversity database, KnowBR calculates the survey coverage per spatial unit as the final slope of the relationship between the number of collected species and the number of database records, which is used as a surrogate of the survey effort. To do this, KnowBR estimates the accumulation curve (the accumulated increase in the number of species with the addition of database records) for each one of the spatial units according to the <em>exact</em> estimator of Ugland <em>et al</em>. (2003), as well as performing 200 permutations of the observed data (<em>random</em> estimator) to obtain a smoothed accumulation curve. This curve is subsequently adjusted to four different functions with three or less parameters, and the obtained extrapolated asymptotic value used to obtain a completeness percentage (the percentage representing the observed number of species against the predicted one) that also may be used to estimate the territorial units with probable reliable inventories.
</p>
<p>These territorial units can be regular cells of any resolution (<em>cell</em> option) but also irregular polygons (<em>polygon</em> option) according to user preferences. RWizard includes in the &quot;Area&quot; argument the possibility of select the administrative spatial units (countries, regions, departments and/or provinces) or the rivers basins of different levels in which to perform the calculations. Instead of using the polygons available in RWizard, the user may also include any shapefile containing the desired irregular polygons (e.g. protected areas, countries, etc) by means of the &quot;shape&quot; argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KnowB(data, format="A", cell=60, curve= "Rational", estimator=1, cutoff=1,
cutoffCompleteness= 0, cutoffSlope= 1, largematrix=FALSE, Area="World",
extent=TRUE, minLon, maxLon, minLat, maxLat, colbg="transparent",
colcon="transparent", colf="black", pro=TRUE, inc=0.005, exclude=NULL,
colexc=NULL, colfexc="black", colscale=c("#C8FFFFFF","#64FFFFFF","#00FFFFFF",
"#64FF64FF","#C8FF00FF","#FFFF00FF","#FFC800FF","#FF6400FF","#FF0000FF"),
legend.pos="y", breaks=9, xl=0, xr=0, yb=0, yt=0, asp, lab=NULL, xlab="Longitude",
ylab="Latitude", main1="Observed richness", main2="Records", main3="Completeness",
main4="Slope", cex.main=1.6, cex.lab=1.4, cex.axis=1.2, cex.legend=1.2,
family="sans", font.main=2, font.lab=1, font.axis=1, lwdP=0.6, lwdC=0.1,
trans=c(1,1), log=c(0,0), ndigits=0, save="CSV", file1="Observed richness",
file2="List of species", file3="Species per site", file4="Estimators",
file5="Species per record", file6="Records", file7="Completeness", file8="Slope",
file9="Standard error of the estimators", na="NA", dec=",", row.names=FALSE,
jpg=TRUE, jpg1="Observed richness.jpg", jpg2="Records.jpg", jpg3="Completeness.jpg",
jpg4="Slope.jpg",cex=1.5, pch=15, cex.labels=1.5, pchcol="red", ask=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KnowB_+3A_data">data</code></td>
<td>
<p>The data is introduced as a CSV, TXT or RData file following two simple formats: one in which only four columns are included (see format A; species name, longitude, latitude and a number reflecting the incidence of the species) and another one including the longitude and latitude of each spatial unit and as many columns as species (see format B in the following table). The CSV file with the format A may be obtained using ModestR (see details).
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F1.jpg" width="50" alt="F1.jpg" />

</td>
</tr>

</table>

<p>The primary matrix used in <em>KnowBR</em> has a special characteristic - it must be derived from an exhaustive database including all the available georeferenced information including even those apparently redundant records of a species from the same locality provided that is a difference in some of the collection conditions for a species at a locality (i.e. date of capture, food source, collector, type of microhabitat, etc.). Thus, any difference in any database field value yields a new database record regardless of the number of individuals (see for example Lobo &amp; Martín-Piera, 2002). As biodiversity data can derive from heterogeneous sources with different collector methodologies, no universal sampling effort measure capable of offering  reliable comparisons exists and the number of database records is used as a surrogate (see Soberón <em>et al</em>., 2007; Lobo, 2008). This approach is particularly appropriate for poorly surveyed groups and/or regions lacking sufficient information to correct unequal sampling efforts arising from standardized survey protocols.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_format">format</code></td>
<td>
<p>If it is &quot;A&quot; (default), the format of the data frame is species, longitude, latitude and a count value (format A of the table showed above). If it is &quot;B&quot; the format of the data frame is longitude, latitude and the rest of columns are the presence of the species in each site (format B of the table showed above). If numeric values higher than 1 are included in these data a (Count or Sp columns), a database record is considered for each unit. This in the example of format A, four different records are included for the Sp3 with same geographical coordinates.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cell">cell</code></td>
<td>
<p>Resolution of the cells (spatial units) in minutes on which calculations were carried out. In the present version the user can select any resolution between 1 and 60 minutes.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_curve">curve</code></td>
<td>
<p>The smoothed accumulation curve generated by the accumulation curve can be adjusted to a &quot;Clench&quot;, &quot;Exponential&quot;, &quot;Saturation&quot; or &quot;Rational&quot; function (see equations in details section), calculating the asymptotic extrapolated values to further derive a completeness percentage (the percentage representing the observed number of species against the predicted one).</p>
</td></tr>
<tr><td><code id="KnowB_+3A_estimator">estimator</code></td>
<td>
<p>Vector that defines the used estimator:
</p>
<p>0 The data for the estimation of the accumulation curve and the final slope are obtained with both the &quot;exact&quot; and &quot;random&quot; procedures. When the predicted richness is estimated with the type of curve selected by the user (&quot;Clench&quot;, &quot;Nexponential&quot;, &quot;Saturation&quot; or &quot;Rational&quot;) using the data generated by the methods &quot;exact&quot; and &quot;random&quot; at the same time, the mean of both richness values is used to calculate completeness (the percentage representing the observed number of species against the predicted one).
</p>
<p>1 It is the &quot;exact&quot; estimator of Ugland <em>et al.</em> (2003) (default option) to obtain a smoothed accumulation curve.
</p>
<p>2 If the chosen option is &quot;random&quot;. It adds records at random performing 200 permutations in the order of records entry to generate the accumulation curve.
</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cutoff">cutoff</code></td>
<td>
<p>This number reflects the ratio between the number of database records and the number of species. If this ratio is lower than the selected threshold value in each considered spatial unit, any one of the estimators will be calculated and these spatial units are considered as lacking information.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cutoffcompleteness">cutoffCompleteness</code></td>
<td>
<p>If the value of completeness is lower than this threshold, the completeness is not calculated.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cutoffslope">cutoffSlope</code></td>
<td>
<p>If the slope is higher than this threshold, the completeness is not calculated.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_largematrix">largematrix</code></td>
<td>
<p>When there many species and/or many records resulting in a species per record matrix with more than <code class="reqn">2^{31}</code> cells, it is impossible to create the CSV or RData file with the species per record due to memory limits in R. If this argument is TRUE, the function creates a TXT file with the species per record, but the process is computationally intensive, so it may takes several hours and it may create a large TXT file. The default value is FALSE.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_area">Area</code></td>
<td>
<p>A character with the name of the administrative area or a vector with several administrative areas. If a vector with several administrative areas are used, it is necessary to use RWizard (see details).</p>
</td></tr>
<tr><td><code id="KnowB_+3A_extent">extent</code></td>
<td>
<p>If TRUE the minimum and maximum longitudes and latitudes are delimited by the minimum and maximum of the data (default). If FALSE the minimum and maximum longitudes and latitudes are delimited by the arguments Area and, minLat, maxLat, minLon and maxLon.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_minlon">minLon</code>, <code id="KnowB_+3A_maxlon">maxLon</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum longitude (see details).</p>
</td></tr>
<tr><td><code id="KnowB_+3A_minlat">minLat</code>, <code id="KnowB_+3A_maxlat">maxLat</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum latitude (see details).</p>
</td></tr>
<tr><td><code id="KnowB_+3A_colbg">colbg</code></td>
<td>
<p>Background color of the map (in some cases this is the sea).</p>
</td></tr>
<tr><td><code id="KnowB_+3A_colcon">colcon</code></td>
<td>
<p>Background color of the administrative areas.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_colf">colf</code></td>
<td>
<p>Color of administrative areas border.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_pro">pro</code></td>
<td>
<p>If it is TRUE an automatic calculation is made in order to correct the
aspect ratio y/x along latitude.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_inc">inc</code></td>
<td>
<p>Adds some room along the map margins with the limits x and y thus not exactly the limits of the selected areas.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_exclude">exclude</code></td>
<td>
<p>A character with the name of the administrative area or a vector with several administrative areas that can be plotted with a different color on the map.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_colexc">colexc</code></td>
<td>
<p>Background color of areas selected in the argument exclude.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_colfexc">colfexc</code></td>
<td>
<p>Color of borders of the areas selected in the argument exclude.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_colscale">colscale</code></td>
<td>
<p>Palette color.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_legend.pos">legend.pos</code></td>
<td>
<p>Whether to have a horizontal (x) or vertical (y) color gradient.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_breaks">breaks</code></td>
<td>
<p>Number of breakpoints of the color legend.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_xl">xl</code>, <code id="KnowB_+3A_xr">xr</code>, <code id="KnowB_+3A_yb">yb</code>, <code id="KnowB_+3A_yt">yt</code></td>
<td>
<p>The lower left and upper right coordinates of the color legend in user coordinates.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_asp">asp</code></td>
<td>
<p>The y/x aspect ratio.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_lab">lab</code></td>
<td>
<p>A numerical vector of the form c(x. Y) which modified the default method by which axes are annotated. The values of x and y give the (approximate) number of tick marks on the x and y axes.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_main1">main1</code></td>
<td>
<p>An overall title for the plot of the observed species richness.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_main2">main2</code></td>
<td>
<p>An overall title for the plot of the records.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_main3">main3</code></td>
<td>
<p>An overall title for the plot of the completeness.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_main4">main4</code></td>
<td>
<p>An overall title for the plot of the slope between the last species richness value and the previous value for each one of the accumulation methods.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cex.main">cex.main</code></td>
<td>
<p>The magnification to be used for main titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cex.lab">cex.lab</code></td>
<td>
<p>The magnification to be used for x and y labels relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cex.legend">cex.legend</code></td>
<td>
<p>The magnification to be used in the numbers of the color legend relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_family">family</code></td>
<td>
<p>The name of a font family for drawing text.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_font.main">font.main</code></td>
<td>
<p>The font to be used for plot main titles.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_font.lab">font.lab</code></td>
<td>
<p>The font to be used for x and y labels.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_font.axis">font.axis</code></td>
<td>
<p>The font to be used for axis annotation.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_lwdp">lwdP</code></td>
<td>
<p>Line width of the plot.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_lwdc">lwdC</code></td>
<td>
<p>Line width of the borders.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_trans">trans</code></td>
<td>
<p>It is possible to multiply or divide the dataset by a value. For a vector with two values, the first may be 0 (divide) or 1 (multiply), and the second number is the value of the division or multiplication.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_log">log</code></td>
<td>
<p>It is possible to apply a logarithmic transformation to the dataset. For a vector with two values, the first may be 0 (do not log transform) or 1 (log transformation), and the second number is the value to be added in case of log transformation.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_ndigits">ndigits</code></td>
<td>
<p>Number of decimals in legend of the color scale.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_save">save</code></td>
<td>
<p>If &quot;CSV&quot; the files are save as CSV and if &quot;RData&quot; the files are save as RData.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file1">file1</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the observed richness.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file2">file2</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the list of species.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file3">file3</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the species incidences per site.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file4">file4</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the estimators per site.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file5">file5</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the species per records.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file6">file6</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the records.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file7">file7</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the completeness.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file8">file8</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the slopes of the accumulation analyses.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_file9">file9</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the standard error of the estimators.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_na">na</code></td>
<td>
<p>CSV FILE. Text that is used in the cells without data.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_dec">dec</code></td>
<td>
<p>CSV FILE. It defines if the comma &quot;,&quot; is used as decimal separator or the dot &quot;.&quot;.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_row.names">row.names</code></td>
<td>
<p>CSV FILE. Logical value that defines if identifiers are put in rows or a vector with a text for each of the rows.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_jpg">jpg</code></td>
<td>
<p>If TRUE the plots are exported to jpg files instead of using the windows device.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_jpg1">jpg1</code></td>
<td>
<p>Name of the jpg file with the values of the observed richness.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_jpg2">jpg2</code></td>
<td>
<p>Name of the jpg file with the records.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_jpg3">jpg3</code></td>
<td>
<p>Name of the jpg file with the completeness.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_jpg4">jpg4</code></td>
<td>
<p>Name of the jpg file with the slopes of the accumulation analyses.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cex">cex</code></td>
<td>
<p>A numerical value giving the amount by which plotting symbols should be magnified relative to the default in the correlation matrix plot.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_pch">pch</code></td>
<td>
<p>Either an integer specifying a symbol or a single character to be used as the default in plotting points in the correlation matrix plot.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_cex.labels">cex.labels</code></td>
<td>
<p>Size of labels in the correlation matrix plot.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_pchcol">pchcol</code></td>
<td>
<p>Color of the symbols in the correlation matrix plot.</p>
</td></tr>
<tr><td><code id="KnowB_+3A_ask">ask</code></td>
<td>
<p>If TRUE (and the R session is interactive) the user is asked for input before a new figure is drawn.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CSV file required in the argument <em>data</em> with the format A (species, longitude, latitude and count) may be obtained using ModestR (available at the web site www.ipez.es/ModestR) juast selecting Export/Export maps of the select branch/To RWizard Applications/To KnowBR.
</p>
<p>In ModestR is possible to export the valid samples or pseudosamples. The pseudosamples are grid cells for instance of 5' x 5', 30' x 30', 1º x 1º, etc. Therefore, the output of ModestR is a list of species within each of the grid cells with the cell size defined by the user. It is therefore possible to obtain the number of records for each species within the grid cell or just the records available for all the species, with the format described above.
</p>
<p>Area = &quot;World&quot; to plot the entire world. If the coordinates minLon, maxLon, minLat and maxLat are not specified, they are calculated automatically based on the selected administrative areas. If some administrative areas are selected, e.g. some countries, so the argument is not &quot;World&quot;, it only works with RWizard.
</p>
<p>It is important to emphasize that the quality of the geographical records of the administrative areas is lower if it is used the entire world(<em>Area=&quot;World&quot;</em>, because the file adworld is used), than if it is selected some countries, departments, etc., because the geographical records of the administrative areas available in RWizard are used. It means that the records inside the polygons may vary depending on the selection specified in the argument <em>Area</em>.
</p>
<p>The type of curves are:
</p>
<p>1) The curve of Clench (Clench, 1979), which is a modification of the function of Monod (Monod, 1950), and was proposed to butterflies.
</p>
<p>2) The exponential (Miller &amp; Wiegert, 1989) that was proposed for rare plant species.
</p>
<p>3) The saturation curve that was used to show the relationship between growth of phytoplankton, a toxic algae of the genus <em>Alexandrium</em> and the concentration of phosphate (Frangópulos et al., 2004), which is similar to von Bertalanffy growth curve but adapting the coefficients to better explain the pattern of accumulation function.
</p>
<p>4) The rational function (Ratkowski, 1990) that can be used when there is no clear criterion which model to use (Falther, 1996).
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Name</strong> </td><td style="text-align: left;"> <strong>Function</strong> </td><td style="text-align: left;"> <strong>Reference</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
Clench </td><td style="text-align: left;"> <code class="reqn">y=\frac{ax}{1+bx}</code> </td><td style="text-align: left;"> (Clench, 1979)</td>
</tr>
<tr>
 <td style="text-align: left;">
Negative exponential </td><td style="text-align: left;"> <code class="reqn">y=a\left(1-e^{-bx}\right)</code> </td><td style="text-align: left;"> (Miller &amp; Wiegert, 1989)</td>
</tr>
<tr>
 <td style="text-align: left;">
Saturation </td><td style="text-align: left;"> <code class="reqn">y=a\left(1-e^{-b(x-c)}\right)</code> </td><td style="text-align: left;"> (Frangópulos et al., 2004)</td>
</tr>
<tr>
 <td style="text-align: left;">
Rational </td><td style="text-align: left;"> <code class="reqn">y=\frac{(a+bx)}{(1+cx)}</code> </td><td style="text-align: left;"> (Ratkowski, 1990)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>FUNCTIONS</strong>
</p>
<p>The estimators exact and random were estimated with the function <a href="vegan.html#topic+specaccum">specaccum</a> of the package vegan (Oksanen <em>et al</em>., 2014).
</p>
<p>The color legend of the maps is depicted with the function <a href="plotrix.html#topic+color.legend">color.legend</a> of the package plotrix (Lemon et al., 2014).
</p>
<p><strong>EXAMPLE</strong>
</p>
<p>The database of the example includes 15,142 records for the 54 Iberian species of the Scarabaeidae (Coleoptera) previously compiled in the so called BANDASCA database (Lobo &amp; Martín-Piera, 2002). The following map show the slopes obtained in cells of 60ºx 60º using the estimator exact and the Rational's curve.
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F2.jpg" width="50" alt="F2.jpg" />

</td>
</tr>
<tr>
 <td style="text-align: center;">
</td>
</tr>

</table>

<p>The maps may be easily modified using the function <a href="#topic+MapCell">MapCell</a> using the exported CSV or RData files detailing the observed species richness (with alias ObservedRichness), the records (with alias Records), the completeness (with alias Completeness) and the slope (with alias Slope).
</p>


<h3>Value</h3>

<p>RData or CSV files: 1) Observed richness, 2) List of species, 3) Species per site, 4) Estimators, 5) Species per record, 6) Records, 7) Completeness, Slope and 9) Standard error of the estimators.
</p>
<p>JPG files with maps: 1) Observed richness, 2) Records, 3) Completeness and 4) Slope.
</p>


<h3>Source</h3>

<p>Spatial database of the location of the world's administrative areas (or administrative boundaries) was obtained from the Web Site http://www.openstreet.org/.</p>


<h3>References</h3>

<p>Clench, H.K. (1979) How to make regional lists of butterflies: some invoking empirically based criteria in selecting among thoughts. <em>The Journal of the Lepidopterists' Society</em>, 33: 216-231.
</p>
<p>Flather, C.H. (1996) Fitting species-accumulation functions and assessing regional land use impacts on avian diversity. <em>Journal of Biogeography</em>, 23: 155-168.
</p>
<p>Frangópulos, M., Guisande, C., deBlas, E. y Maneiro, I. (2004) Toxin production and competitive abilities under phosphorus limitation of <em>Alexandrium</em> species. <em>Harmful Algae</em>, 3: 131-139.
</p>
<p>Guillera-Arroita, G., Ridout, M.S &amp; Morgan, B.J.T. (2010)Design of occupancy studies with imperfect detection. <em>Methods in Ecology and Evolution</em>, 1: 131-139. 
</p>
<p>Guralnick, R.P., Hill, A.W. &amp; Lane, M. 2007. Towards a collaborative, global infrastructure for biodiversity assessment. <em>Ecology Letters</em> 10: 663-672.
</p>
<p>Hortal, J., de Bello, F., Diniz-Filho, J.A.F., Lewinsohn, T.M., Lobo, J.M. &amp; Ladle, R.J. (2015) Seven shortfalls that beset large-scale knowledge of biodiversity. <em>Annual Review Ecology and Systematics</em>, 46: 523-549.
</p>
<p>Hortal, J. &amp; Lobo, J.M. 2005. An ED-based protocol for the optimal sampling of biodiversity. <em>Biodiversity and Conservation</em>, 14: 2913-2947.
</p>
<p>Hortal, J., Lobo, J.M. &amp; Jiménez-Valverde, A., 2007. Limitations of biodiversity databases: case study on seed-plant diversity in Tenerife (Canary Islands). <em>Conservation Biology</em> 21, 853-863.
</p>
<p>Ladle, R. &amp; Hortal, J. (2013) Mapping species distributions: living with uncertainty. <em>Frontiers of Biogeography</em>, 5: 8-9. 
</p>
<p>Lemon, J., Bolker, B., Oom, S., Klein, E., Rowlingson, B., Wickham, H., Tyagi, A., Eterradossi, O., Grothendieck, G., Toews, M., Kane, J., Turner, R., Witthoft, C., Stander, J., Petzoldt, T., Duursma, R., Biancotto, E., Levy, O., Dutang, C., Solymos, P., Engelmann, R., Hecker, M., Steinbeck, F., Borchers, H., Singmann, H., Toal, T. &amp; Ogle, D. (2017). Various plotting functions. R package version 3.6-5. Available at: http://CRAN.R-project.org/package=plotrix.
</p>
<p>Lobo, J.M., Baselga, A., Hortal, J., Jiménez-Valverde, A. &amp; Gómez, J.F. 2007. How does the knowledge about the spatial distribution of Iberian dung beetle species accumulate over time? <em>Diversity and Distributions</em> 13:772-780.
</p>
<p>Lobo, J.M. 2008. Database records as a surrogate for sampling effort provide higher species richness estimations. <em>Biodiversity and Conservation</em> 17: 873-881.
</p>
<p>Meyer, C., Kreft, H., Guralnick, R. &amp; Jetz, W. (2015) Global priorities for an effective information basis of biodiversity distributions. <em>Nature Communications</em>6: 8221.
</p>
<p>Meyer, C., Weigelt, P. &amp; Kreft, H. (2016) Multidimensional biases, gaps and uncertainties in global plant occurrence information. <em>Ecoly Letters</em>, 19: 992-1006.
</p>
<p>Miller, R.I. &amp; Wiegert, R.G. (1989) Documenting completeness species-area relations, and the species-abundance distribution of a regional flora. <em>Ecology</em>, 70: 16-22.
</p>
<p>Oksanen, J., Blanchet, F.G., Kindt, R., Legendre, P., Minchin, P.R., O'Hara, R.B., Simpson, G.L., Solymos, P., Henry, M., Stevens, H. &amp; Wagner, H. 2014. Community Ecology Package. R package version 2.0-10. Available at: https://CRAN.R-project.org/package=vegan.
</p>
<p>Ratkowski, D.A. (1990) <em>Handbook of nonlinear regression models</em>. Marcel Dekker, New York, 241 pp.
</p>
<p>Ruete, A. (2015) Displaying bias in sampling effort of data accessed from biodiversity databases using ignorance maps.  <em>Biodiversity Data Journal</em>3: e5361.
</p>
<p>Soberón, J., Jiménez, R., Golubov, J. &amp; Koleff, P., 2007. Assessing completeness of biodiversity databases at different spatial scales. <em>Ecography</em> 30, 152-160.
</p>
<p>Ugland, K.I., Gray J. S. &amp; Ellingsen, K.E. 2003. The species-accumulation curve and estimation of species richness. <em>Journal of Animal Ecology</em> 72: 888-897.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

#Example 1. Default conditions using estimator 1 (method exact)
#but only slopes lower than 0.1 are selected for depicting
#and, therefore, only the completeness is depicted for those
#cells with the slope lower than 0.1.
#If using RWizard, for a better quality of the geographic
#coordinates, replace data(adworld) by @_Build_AdWorld_

data(adworld)
data(Beetles)
KnowB(data=Beetles, save="RData", jpg=FALSE, cutoffSlope=0.1, xl=6.1, xr=6.3)

#Only to be used with RWizard. 
#Example 2. Using @_Build_AdWorld_

data(Beetles)
@_Build_AdWorld_
KnowB(Beetles, cell=15, save="RData")


## End(Not run)
</code></pre>

<hr>
<h2 id='KnowBPolygon'>Discriminating well surveyed polygon units from exhaustive biodiversity databases</h2><span id='topic+KnowBPolygon'></span>

<h3>Description</h3>

<p>It is the same function than <a href="#topic+KnowB">KnowB</a> but the estimation of the well surveyed units is on polygons instead of on cells.</p>


<h3>Usage</h3>

<pre><code class='language-R'>KnowBPolygon(data, format="A", shape=NULL, shapenames=NULL, admAreas=FALSE,
Area="World", curve="Rational", estimator=1, cutoff=1, cutoffCompleteness=0,
cutoffSlope=1, extent=TRUE, minLon, maxLon, minLat, maxLat, int=30, colbg="#FFFFFF",
colcon="#C8C8C8", colf="black", pro = TRUE, inc=0.005, exclude=NULL, colexc=NULL,
colfexc="black", colscale=c("#C8FFFFFF","#64FFFFFF",
"#00FFFFFF","#64FF64FF","#C8FF00FF","#FFFF00FF","#FFC800FF","#FF6400FF","#FF0000FF"),
legend.pos="y", breaks=9, xl=0, xr=0, yb=0, yt=0, asp, lab=NULL,
xlab="Longitude", ylab="Latitude", main1="Records", main2="Observed richness",
main3="Completeness", main4="Slope", cex.main=1.6, cex.lab=1.4, cex.axis=1.2,
cex.legend=0.9, family="sans", font.main=2, font.lab=1, font.axis=1,
lwdP=0.6, lwdC=0.1, trans=c(1,1), ndigits=0, save="CSV", file1="Species per site",
file2="Estimators", file3="Standard error of the estimators", na="NA",
dec=",", row.names=FALSE, Maps=TRUE, jpg=TRUE, jpg1="Records.jpg",
jpg2="Observed richness.jpg",  jpg3="Completeness.jpg", jpg4="Slope.jpg",
cex=1.5, pch=15,cex.labels=1.5, pchcol="red", ask=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KnowBPolygon_+3A_data">data</code></td>
<td>
<p>The data is introduced as a CSV, TXT or RData file following two simple formats (for further details see the description of the same argument in the function <a href="#topic+KnowB">KnowB</a>.): one in which only four columns are included (format A; species name, longitude, latitude and a number reflecting the incidence of the species) and another one including the longitude and latitude of each spatial unit and as many columns as species (format B). The CSV file with the format A may be obtained using ModestR (see details).</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_format">format</code></td>
<td>
<p>If it is &quot;A&quot; (default), the format of the data frame is species, longitude, latitude and a count value. If it is &quot;B&quot; the format of the data frame is longitude, latitude and the rest of columns are the presence of the species in each site (for further details see the description of the same argument in the function <a href="#topic+KnowB">KnowB</a>).</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_shape">shape</code></td>
<td>
<p>Optionally it may be used a shape file with the information of the polygons.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_shapenames">shapenames</code></td>
<td>
<p>Variable in the shapefile with the names of the polygons.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_admareas">admAreas</code></td>
<td>
<p>If it is TRUE the border lines of the countries are depicted in the map.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_area">Area</code></td>
<td>
<p>A character with the name of the administrative area or a vector with several administrative areas (see details). If a vector with several administrative areas are used, it is necessary to use RWizard (see details section in the function <a href="#topic+KnowB">KnowB</a>).</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_curve">curve</code></td>
<td>
<p>The smoothed accumulation curve generated by the accumulation curve can be adjusted to a &quot;Clench&quot;, &quot;Exponential&quot;, &quot;Saturation&quot; or &quot;Rational&quot; function (see equations in details section of function <a href="#topic+KnowB">KnowB</a>), calculating the asymptotic extrapolated values to further derive a completeness percentage (the percentage representing the observed number of species against the predicted one).</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_estimator">estimator</code></td>
<td>
<p>Vector that defines the used estimator (see the same argument in the function <a href="#topic+KnowB">KnowB</a>).</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cutoff">cutoff</code></td>
<td>
<p>This number reflects the ratio between the number of database records and the number of species. If this ratio is lower than the selected threshold value in each considered spatial unit, any one of the estimators will be calculated and these spatial units are considered as lacking information.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cutoffcompleteness">cutoffCompleteness</code></td>
<td>
<p>If the value of completeness is lower than this threshold, the completeness is not calculated.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cutoffslope">cutoffSlope</code></td>
<td>
<p>If the slope is higher than this threshold, the completeness is not calculated.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_extent">extent</code></td>
<td>
<p>If TRUE the minimum and maximum longitudes and latitudes are delimited by the minimum and maximum of the data (default). If FALSE the minimum and maximum longitudes and latitudes are delimited by the arguments Area and, minLat, maxLat, minLon and maxLon.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_minlon">minLon</code>, <code id="KnowBPolygon_+3A_maxlon">maxLon</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum longitude (see details).</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_minlat">minLat</code>, <code id="KnowBPolygon_+3A_maxlat">maxLat</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum latitude (see details).</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_int">int</code></td>
<td>
<p>Number of intervals of the color ramp.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_colbg">colbg</code></td>
<td>
<p>Background color of the map (in some cases this is the sea).</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_colcon">colcon</code></td>
<td>
<p>Background color of the administrative areas.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_colf">colf</code></td>
<td>
<p>Color of administrative areas border.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_pro">pro</code></td>
<td>
<p>If it is TRUE an automatic calculation is made in order to correct the spect ratio y/x along latitude.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_inc">inc</code></td>
<td>
<p>Adds some room along the map margins with the limits x and y thus not exactly the limits of the selected areas.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_exclude">exclude</code></td>
<td>
<p>A character with the name of the administrative area or a vector with several administrative areas that can be plotted with a different color on the map.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_colexc">colexc</code></td>
<td>
<p>Background color of areas selected in the argument exclude.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_colfexc">colfexc</code></td>
<td>
<p>Color of borders of the areas selected in the argument exclude.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_colscale">colscale</code></td>
<td>
<p>Palette color.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_legend.pos">legend.pos</code></td>
<td>
<p>Whether to have a horizontal (x) or vertical (y) color gradient.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_breaks">breaks</code></td>
<td>
<p>Number of breakpoints of the color legend.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_xl">xl</code>, <code id="KnowBPolygon_+3A_xr">xr</code>, <code id="KnowBPolygon_+3A_yb">yb</code>, <code id="KnowBPolygon_+3A_yt">yt</code></td>
<td>
<p>The lower left and upper right coordinates of the color legend in user coordinates.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_asp">asp</code></td>
<td>
<p>The y/x aspect ratio.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_lab">lab</code></td>
<td>
<p>A numerical vector of the form c(x. Y) which modified the default method by which axes are annotated. The values of x and y give the (approximate) number of tick marks on the x and y axes.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_main1">main1</code></td>
<td>
<p>An overall title for the plot of the observed species richness.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_main2">main2</code></td>
<td>
<p>An overall title for the plot of the records.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_main3">main3</code></td>
<td>
<p>An overall title for the plot of the completeness.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_main4">main4</code></td>
<td>
<p>An overall title for the plot of the slope between the last species richness value and the previous value for each one of the accumulation methods.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cex.main">cex.main</code></td>
<td>
<p>The magnification to be used for main titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cex.lab">cex.lab</code></td>
<td>
<p>The magnification to be used for x and y labels relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cex.legend">cex.legend</code></td>
<td>
<p>The magnification to be used in the numbers of the color legend relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_family">family</code></td>
<td>
<p>The name of a font family for drawing text.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_font.main">font.main</code></td>
<td>
<p>The font to be used for plot main titles.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_font.lab">font.lab</code></td>
<td>
<p>The font to be used for x and y labels.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_font.axis">font.axis</code></td>
<td>
<p>The font to be used for axis annotation.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_lwdp">lwdP</code></td>
<td>
<p>Line width of the plot.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_lwdc">lwdC</code></td>
<td>
<p>Line width of the borders.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_trans">trans</code></td>
<td>
<p>It is possible to multiply or divide the dataset by a value. For a vector with two values, the first may be 0 (divide) or 1 (multiply), and the second number is the value of the division or multiplication.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_ndigits">ndigits</code></td>
<td>
<p>Number of decimals in legend of the color scale.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_save">save</code></td>
<td>
<p>If &quot;CSV&quot; the files are save as CSV and if &quot;RData&quot; the files are save as RData.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_file1">file1</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the species or CSV per site.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_file2">file2</code></td>
<td>
<p>RData file or CSV file. A character string naming the file with the estimators per shape.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_file3">file3</code></td>
<td>
<p>RData or CSV file. A character string naming the file with the standard error of the estimators.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_na">na</code></td>
<td>
<p>CSV FILE. Text that is used in the cells without data.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_dec">dec</code></td>
<td>
<p>CSV FILE. It defines if the comma &quot;,&quot; is used as decimal separator or the dot &quot;.&quot;.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_row.names">row.names</code></td>
<td>
<p>CSV FILE. Logical value that defines if identifiers are put in rows or a vector with a text for each of the rows.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_maps">Maps</code></td>
<td>
<p>If it is TRUE the maps are depicted.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_jpg">jpg</code></td>
<td>
<p>If TRUE the plots are exported to jpg files instead of using the windows device.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_jpg1">jpg1</code></td>
<td>
<p>Name of the jpg file with the records.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_jpg2">jpg2</code></td>
<td>
<p>Name of the jpg file with of the values of observed richness.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_jpg3">jpg3</code></td>
<td>
<p>Name of the jpg file with the completeness.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_jpg4">jpg4</code></td>
<td>
<p>Name of the jpg file with the slopes of the accumulation analyses.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cex">cex</code></td>
<td>
<p>A numerical value giving the amount by which plotting symbols should be magnified relative to the default in the correlation matrix plot.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_pch">pch</code></td>
<td>
<p>Either an integer specifying a symbol or a single character to be used as the default in plotting points in the correlation matrix plot.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_cex.labels">cex.labels</code></td>
<td>
<p>Size of labels in the correlation matrix plot.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_pchcol">pchcol</code></td>
<td>
<p>Color of the symbols in the correlation matrix plot.</p>
</td></tr>
<tr><td><code id="KnowBPolygon_+3A_ask">ask</code></td>
<td>
<p>If TRUE (and the R session is interactive) the user is asked for input before a new figure is drawn.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>FUNCTIONS</strong>
</p>
<p>The estimators exact and random were estimated with the function <a href="vegan.html#topic+specaccum">specaccum</a> of the package vegan (Oksanen <em>et al</em>., 2014).
</p>
<p>The color legend of the maps is depicted with the function <a href="plotrix.html#topic+color.legend">color.legend</a> of the package plotrix (Lemon et al., 2014).
</p>
<p>The polygons are depicted with the function <a href="sp.html#topic+spplot">spplot</a> of the package sp (Edzer <em>et al</em>. 2005; Bivand <em>et al</em>., 2013; Pebesma <em>et al</em>. 2017).
</p>
<p><strong>EXAMPLE</strong>
</p>
<p><strong>Example 1.</strong> The database of the example includes 15,142 records for the 54 Iberian species of the Scarabaeidae (Coleoptera) previously compiled in the so called BANDASCA database (Lobo &amp; MartÃ­n-Piera, 2002). The following maps show the records obtained in provinces of Spain using the estimator exact and the Rational function to adjust the data. 
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F3.jpg" width="50" alt="F3.jpg" />

</td>
</tr>
<tr>
 <td style="text-align: center;">
</td>
</tr>

</table>

<p><strong>Example 2.</strong> An example using an external shape uploaded by the user (in this case the states of USA). The dataset are the records downloaded from GBIF of the flowering plants of the family Polygonaceae.The states with a grey background had no records, species and/or it was not possible to estimate the slope and/or completeness.
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F4.jpg" width="50" alt="F4.jpg" />


</td>
</tr>
<tr>
 <td style="text-align: center;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>The folowing files are obtained:
</p>
<p>RData or CSV files: 1) Species per site, 2) Estimators and 3) Standard error and R2 of the functions.
</p>
<p>JPG files with maps: 1)Records, 2) Observed richness, 3) Completeness and 4) Slope.
</p>


<h3>Source</h3>

<p>Spatial database of the location of the world's administrative areas (or administrative boundaries) was obtained from the Web Site http://www.openstreet.org/.</p>


<h3>References</h3>

<p>Bivand, R.S., Pebesma, E. &amp; Gomez-Rubio, V. 2013. <em>Applied spatial data analysis with R</em>. Springer, NY.
</p>
<p>Edzer J. Pebesma, E.J. &amp; Bivand, R.S. 2005. Classes and methods for spatial data in R. <em>R News</em>, 5: 9-13.
</p>
<p>Lobo, J.M. &amp; MartÃ­n-Piera, F. 2002. Searching for a predictive model for Iberian dung beetle species richness based on spatial and environmental variables. <em>Conservation Biology</em>, 16: 158-173.
</p>
<p>Miller, R.I. &amp; Wiegert, R.G. (1989) Documenting completeness species-area relations, and the species-abundance distribution of a regional flora. <em>Ecology</em>, 70: 16-22.
</p>
<p>Monod, J. (1950) La technique de culture continue, theorie et applications. <em> Annales de l'Institut Pasteur (Paris)</em>,  79: 390-410.
</p>
<p>Oksanen, J., Blanchet, F.G., Kindt, R., Legendre, P., Minchin, P.R., O'Hara, R.B., Simpson, G.L., Solymos, P., Henry, M., Stevens, H. &amp; Wagner, H. 2014. Community Ecology Package. R package version 2.0-10. Available at: https://CRAN.R-project.org/package=vegan.
</p>
<p>Pebesma, E., Bivand, R.S., Rowlingson, B., Gomez-Rubio, V., Hijmans, R., Sumner, M., MacQueen, D., Lemon, J. &amp; O'Brien, J. 2017. Classes and Methods for Spatial Data. R package version 1.2-5. Available at: http://CRAN.R-project.org/package=sp.
</p>
<p>SoberÃ³n, J. &amp; Llorente, B.J. 1993. The use of species accumulation functions for the prediction of species richness. <em>Conservation Biology</em>, 7: 480-488.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

#Download records from GBIF of the flowering plants of the family Polygonaceae

library(rgbif)
records&lt;-occ_search(scientificName = "Polygonaceae", limit=5000, return='data',
hasCoordinate=TRUE)

#Data frame with the format A required by the function KnowBPolygon

records&lt;-data.frame(records$species,records$decimalLongitude, records$decimalLatitude)
names(records)&lt;-c("Species","Longitude","Latitude")

#A column is added to the records with the number of counts
#(format A), assuming 1 count per record

dim&lt;-dim(records)
Counts&lt;-rep(1,dim[1])
records&lt;-cbind(records,Counts)

#Running the function

data(States) #State Boundaries of the United States
data(adworld)
KnowBPolygon(data=records, shape=States, admAreas=TRUE, shapenames="NAME", minLon=-130,
maxLon=-70, minLat=25, maxLat=50, colscale=rev(heat.colors(100)), jpg=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='MapCell'>Cell maps</h2><span id='topic+MapCell'></span>

<h3>Description</h3>

<p>It allows to depict on a map any of the variables  (records richness, observed richess, predicted richness, completeness and the slope) exported by the function <a href="#topic+KnowB">KnowB</a> using a CSV, RData or raster file, and with the spatial resolution (cell size) specified in the file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MapCell(data, Area="World", minLon, maxLon, minLat, maxLat, colbg="#FFFFFF",
colcon="#C8C8C8", colf="black", pro=TRUE, inc=0.005, exclude=NULL,
colexc=NULL, colfexc="black", colscale=c("#C8FFFFFF","#64FFFFFF","#00FFFFFF","#64FF64FF",
"#C8FF00FF","#FFFF00FF","#FFC800FF","#FF6400FF","#FF0000FF"),
legend.pos="y", breaks=9, xl=0, xr=0, yb=0, yt=0, asp, lab=NULL, xlab="Longitude",
ylab="Latitude", main=NULL,cex.main=1.2, cex.lab=1, cex.axis=0.9, cex.legend=0.9,
family="sans", font.main=2, font.lab=1, font.axis=1, lwdP=0.6, lwdC=0.1, trans=c(1,1),
log=c(0,0), ndigits=0, ini=NULL, end=NULL, jpg=FALSE, filejpg="Map.jpg")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MapCell_+3A_data">data</code></td>
<td>
<p>A CSV or RData file exported by the function <a href="#topic+KnowB">KnowB</a> (see details) or an ESRI ASCII raster file with the variable (richness, records, etc.).</p>
</td></tr>
<tr><td><code id="MapCell_+3A_area">Area</code></td>
<td>
<p>Only if using RWizard. A character with the name of the administrative area or a vector with several administrative areas (countries, regions, etc.) or river basins. If it is &quot;World&quot; (default) the entire world is plotted. For using administrative areas or river basins, in addition to use RWizard, it is also necessary to replace data(adworld) by @_Build_AdWorld_ (see example 2).</p>
</td></tr>
<tr><td><code id="MapCell_+3A_minlon">minLon</code>, <code id="MapCell_+3A_maxlon">maxLon</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum longitude.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_minlat">minLat</code>, <code id="MapCell_+3A_maxlat">maxLat</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum latitude.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_colbg">colbg</code></td>
<td>
<p>Background color of the map (in some cases this is the sea).</p>
</td></tr>
<tr><td><code id="MapCell_+3A_colcon">colcon</code></td>
<td>
<p>Background color of the administrative areas.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_colf">colf</code></td>
<td>
<p>Color of administrative areas border.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_pro">pro</code></td>
<td>
<p>If it is TRUE an automatic calculation is made in order to correct the aspect ratio y/x along latitude.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_inc">inc</code></td>
<td>
<p>Adds some room along the map margins with the limits x and y thus not exactly the limits of the selected areas.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_exclude">exclude</code></td>
<td>
<p>A character with the name of the administrative area or a vector with several administrative areas that may be plotted with a different color on the map (only if using RWizard).</p>
</td></tr>
<tr><td><code id="MapCell_+3A_colexc">colexc</code></td>
<td>
<p>Background color of areas selected in the argument exclude.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_colfexc">colfexc</code></td>
<td>
<p>Color of borders of the areas selected in the argument exclude.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_colscale">colscale</code></td>
<td>
<p>Palette color.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_legend.pos">legend.pos</code></td>
<td>
<p>Whether to have a horizontal &quot;x&quot; or vertical &quot;y&quot; color scale.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_breaks">breaks</code></td>
<td>
<p>Number of breakpoints of the color legend.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_xl">xl</code>, <code id="MapCell_+3A_xr">xr</code>, <code id="MapCell_+3A_yb">yb</code>, <code id="MapCell_+3A_yt">yt</code></td>
<td>
<p>The lower left and upper right coordinates of the color legend in user coordinates.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_asp">asp</code></td>
<td>
<p>The y/x aspect ratio.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_lab">lab</code></td>
<td>
<p>A numerical vector of the form c(x, y) which modifies the default way that axes are annotated. The values of x and y give the (approximate) number of tickmarks on the x and y axes.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_xlab">xlab</code></td>
<td>
<p>A title for the X axis.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_ylab">ylab</code></td>
<td>
<p>A title for the Y axis.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_main">main</code></td>
<td>
<p>An overall title for the plot.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_cex.main">cex.main</code></td>
<td>
<p>The magnification to be used for main titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_cex.lab">cex.lab</code></td>
<td>
<p>The magnification to be used for X and Y labels relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_cex.legend">cex.legend</code></td>
<td>
<p>The magnification to be used for the color scale relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_family">family</code></td>
<td>
<p>The name of a font family for drawing text.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_font.main">font.main</code></td>
<td>
<p>The font to be used for plot main titles.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_font.lab">font.lab</code></td>
<td>
<p>The font to be used for x and y labels.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_font.axis">font.axis</code></td>
<td>
<p>The font to be used for axis annotation.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_lwdp">lwdP</code></td>
<td>
<p>Line width of the plot.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_lwdc">lwdC</code></td>
<td>
<p>Line width of the borders.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_trans">trans</code></td>
<td>
<p>It is possible to multiply or divide the dataset by a value. For a vector with two values, the first may be 0 (divide) or 1 (multiply), and the second number is the value of the division or multiplication.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_log">log</code></td>
<td>
<p>It is possible to apply a logarithmic transformation to the dataset. For a vector with two values, the first may be 0 (do not log transform) or 1 (log transformation), and the second number is the value to be added in case of log transformation.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_ndigits">ndigits</code></td>
<td>
<p>Number of decimals in legend of the color scale.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_ini">ini</code></td>
<td>
<p>Minimum to be considered in the color scale.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_end">end</code></td>
<td>
<p>Maximum to be considered in the color scale.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_jpg">jpg</code></td>
<td>
<p>If TRUE the plots are exported to jpg files instead of using the windows device.</p>
</td></tr>
<tr><td><code id="MapCell_+3A_filejpg">filejpg</code></td>
<td>
<p>Name of the jpg file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It allows to depict on a map any of the files (CSV or RData) exported by the function <a href="#topic+KnowB">KnowB</a>: records, observed richness, completeness and slope.
</p>
<p><strong>FUNCTIONS</strong>
</p>
<p>The function <a href="plotrix.html#topic+color.legend">color.legend</a> of the package plotrix (Lemon et al., 2014) is used for building the map.
</p>


<h3>Value</h3>

<p>A map is obtained.</p>


<h3>References</h3>

<p>Lemon, J. (2006) Plotrix: a package in the red light district of R. <em>R-News</em>, 6(4):8-12.
</p>
<p>Lemon, J., Bolker, B., Oom, S., Klein, E., Rowlingson, B., Wickham, H., Tyagi, A., Eterradossi, O., Grothendieck, G., Toews, M., Kane, J., Turner, R., Witthoft, C., Stander, J., Petzoldt, T., Duursma, R., Biancotto, E., Levy, O., Dutang, C., Solymos, P., Engelmann, R., Hecker, M., Steinbeck, F., Borchers, H., Singmann, H., Toal, T. &amp; Ogle, D. (2015). Various plotting functions. R package version 3.6-1. Available at: https://CRAN.R-project.org/package=plotrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

#Example 1. Observed pecies richness of freshwater fishes around the world.

data(RFishes)
data(adworld)
MapCell(data=RFishes, main= "Species richness of freshwater fishes")



#Example 2. Only to be used with RWizard.

data(RFishes)
@_Build_AdWorld_
MapCell(data = RFishes , Area = c("Argentina", "Bolivia", "Brazil", "Chile",
"Colombia", "Ecuador", "French Guiana", "Guyana", "Paraguay", "Peru", "Suriname",
"Uruguay", "Venezuela","Panama","Nicaragua","Costa Rica"),
main = "Species richness of freshwater fishes in South America")

## End(Not run)
</code></pre>

<hr>
<h2 id='MapPolygon'>Choropleth maps</h2><span id='topic+MapPolygon'></span>

<h3>Description</h3>

<p>It allows to shade the polygons in proportion to any of the variables (records richness, observed richess, predicted richness, completeness and the slope) exported by the function <a href="#topic+KnowBPolygon">KnowBPolygon</a> in the file &quot;Estimators&quot;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MapPolygon(data, polygonname, var, shape=NULL, shapenames=NULL, admAreas=TRUE,
Area="World", minLon, maxLon, minLat, maxLat, int=30, colbg="#FFFFFF",
colcon="#C8C8C8", colf="black", pro=TRUE, inc=0.005, exclude=NULL, colexc=NULL,
colfexc="black", colscale=c("#C8FFFFFF","#64FFFFFF","#00FFFFFF","#64FF64FF",
"#C8FF00FF","#FFFF00FF","#FFC800FF","#FF6400FF","#FF0000FF"), colm="black",
legend.pos="y", breaks=9, xl=0, xr=0, yb=0, yt=0, asp, lab=NULL, xlab="Longitude",
ylab="Latitude", main=NULL, cex.main=1.6, cex.lab=1.4, cex.axis=1.2, cex.legend=0.9,
family="sans", font.main=2, font.lab=1, font.axis=1, lwdP=0.6, lwdC=0.1,
trans=c(1,1), log=c(0,0), ndigits=0, ini=NULL, end=NULL, jpg=FALSE, filejpg="Map.jpg")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MapPolygon_+3A_data">data</code></td>
<td>
<p>Data file exported by the function <a href="#topic+KnowBPolygon">KnowBPolygon</a> named &quot;Estimators&quot; with the values of records, observed richness, predicted richness, completeness and slope for each area polygon.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_polygonname">polygonname</code></td>
<td>
<p>A variable available in the data file with the names of the polygons.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_var">var</code></td>
<td>
<p>A variable available in the data file with the values to be used for shading the polygons.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_shape">shape</code></td>
<td>
<p>If the estimators in the function link[KnowBR]KnowBPolygon were calculated using an external shape file, it is necessary to indicate the file in this argument. It is not necessary to select any polygon within the file, just to load the whole shape file.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_shapenames">shapenames</code></td>
<td>
<p>Variable in the shapefile with the names of the polygons.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_admareas">admAreas</code></td>
<td>
<p>If it is TRUE the border lines of the countries are depicted in the map.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_area">Area</code></td>
<td>
<p>Only if using RWizard. A character with the name of the administrative area or a vector with several administrative areas (countries, regions, etc.) or river basins. If it is &quot;World&quot; (default) the entire world is plotted. For using administrative areas or river basins, in addition to use RWizard, it is also necessary to replace data(world) by @_Build_AdWorld_ (see examples).</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_minlon">minLon</code>, <code id="MapPolygon_+3A_maxlon">maxLon</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum longitude.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_minlat">minLat</code>, <code id="MapPolygon_+3A_maxlat">maxLat</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum latitude.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_int">int</code></td>
<td>
<p>Number of intervals into which the variable is splited.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_colbg">colbg</code></td>
<td>
<p>Background color of the map (in some cases this is the sea).</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_colcon">colcon</code></td>
<td>
<p>Background color of the administrative areas.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_colf">colf</code></td>
<td>
<p>Color of administrative areas border.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_pro">pro</code></td>
<td>
<p>If it is TRUE an automatic calculation is made in order to correct the aspect ratio y/x along latitude.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_inc">inc</code></td>
<td>
<p>Adds some room along the map margins with the limits x and y thus not exactly the limits of the selected areas.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_exclude">exclude</code></td>
<td>
<p>A character with the name of the administrative area or a vector with several administrative areas that may be plotted with a different color on the map (only if using RWizard).</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_colexc">colexc</code></td>
<td>
<p>Background color of areas selected in the argument exclude.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_colfexc">colfexc</code></td>
<td>
<p>Color of borders of the areas selected in the argument exclude.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_colscale">colscale</code></td>
<td>
<p>Palette color.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_colm">colm</code></td>
<td>
<p>Color of the polygons without information when using when using an external shape file.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_legend.pos">legend.pos</code></td>
<td>
<p>Whether to have a horizontal &quot;x&quot; or vertical &quot;y&quot; color scale.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_breaks">breaks</code></td>
<td>
<p>Number of breakpoints of the color legend.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_xl">xl</code>, <code id="MapPolygon_+3A_xr">xr</code>, <code id="MapPolygon_+3A_yb">yb</code>, <code id="MapPolygon_+3A_yt">yt</code></td>
<td>
<p>The lower left and upper right coordinates of the color legend in user coordinates.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_asp">asp</code></td>
<td>
<p>The y/x aspect ratio.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_lab">lab</code></td>
<td>
<p>A numerical vector of the form c(x, y) which modifies the default way that axes are annotated. The values of x and y give the (approximate) number of tickmarks on the x and y axes.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_xlab">xlab</code></td>
<td>
<p>A title for the X axis.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_ylab">ylab</code></td>
<td>
<p>A title for the Y axis.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_main">main</code></td>
<td>
<p>An overall title for the plot.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_cex.main">cex.main</code></td>
<td>
<p>The magnification to be used for main titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_cex.lab">cex.lab</code></td>
<td>
<p>The magnification to be used for X and Y labels relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_cex.legend">cex.legend</code></td>
<td>
<p>The magnification to be used for the color scale relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_family">family</code></td>
<td>
<p>The name of a font family for drawing text.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_font.main">font.main</code></td>
<td>
<p>The font to be used for plot main titles.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_font.lab">font.lab</code></td>
<td>
<p>The font to be used for x and y labels.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_font.axis">font.axis</code></td>
<td>
<p>The font to be used for axis annotation.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_lwdp">lwdP</code></td>
<td>
<p>Line width of the plot.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_lwdc">lwdC</code></td>
<td>
<p>Line width of the borders.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_trans">trans</code></td>
<td>
<p>It is possible to multiply or divide the dataset by a value. For a vector with two values, the first may be 0 (divide) or 1 (multiply), and the second number is the value of the division or multiplication.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_log">log</code></td>
<td>
<p>It is possible to apply a logarithmic transformation to the dataset. For a vector with two values, the first may be 0 (do not log transform) or 1 (log transformation), and the second number is the value to be added in case of log transformation.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_ndigits">ndigits</code></td>
<td>
<p>Number of decimals in legend of the color scale.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_ini">ini</code></td>
<td>
<p>Minimum to be considered in the color scale.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_end">end</code></td>
<td>
<p>Maximum to be considered in the color scale.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_jpg">jpg</code></td>
<td>
<p>If TRUE the plots are exported to jpg files instead of using the windows device.</p>
</td></tr>
<tr><td><code id="MapPolygon_+3A_filejpg">filejpg</code></td>
<td>
<p>Name of the jpg file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>FUNCTIONS</strong>
</p>
<p>The function <a href="plotrix.html#topic+color.legend">color.legend</a> of the package plotrix (Lemon et al., 2014) is used for building the map.
</p>
<p><strong>EXAMPLE</strong>
</p>
<p>Completeness of the records of freshwater fish species in all countries of the world.
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F5.jpg" width="50" alt="F5.jpg" />

</td>
</tr>

</table>



<h3>Value</h3>

<p>A map is obtained.</p>


<h3>References</h3>

<p>Lemon, J. (2006) Plotrix: a package in the red light district of R. <em>R-News</em>, 6(4):8-12.
</p>
<p>Lemon, J., Bolker, B., Oom, S., Klein, E., Rowlingson, B., Wickham, H., Tyagi, A., Eterradossi, O., Grothendieck, G., Toews, M., Kane, J., Turner, R., Witthoft, C., Stander, J., Petzoldt, T., Duursma, R., Biancotto, E., Levy, O., Dutang, C., Solymos, P., Engelmann, R., Hecker, M., Steinbeck, F., Borchers, H., Singmann, H., Toal, T. &amp; Ogle, D. (2015). Various plotting functions. R package version 3.6-1. Available at: https://CRAN.R-project.org/package=plotrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(Estimators)
data(adworld)
MapPolygon(data=Estimators, polygonname="Area", var="Completeness",
colscale=rev(heat.colors(100)))

</code></pre>

<hr>
<h2 id='RFishes'>Species richness of freshwater fishes</h2><span id='topic+RFishes'></span>

<h3>Description</h3>

<p>Species richness of freshwater fish species in cells of 1 degree around the world (Guisande et al., 2010).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RFishes)</code></pre>


<h3>References</h3>

<p>Guisande, C., Manjarrés-Hernández, A., Pelayo-Villamil, P., Granado-Lorencio, C., Riveiro, I., Acuña, A., Prieto-Piraquive, E., Janeiro, E., Matías, J.M., Patti, C., Patti, B., Mazzola, S., Jiménez, L.F., Duque, S. &amp; Salmerón, F. (2010) IPez: An expert system for the taxonomic identification of fishes based on machine learning techniques. <em>Fisheries Research</em>, 102, 240-247.</p>

<hr>
<h2 id='States'>States of USA</h2><span id='topic+States'></span>

<h3>Description</h3>

<p>A file with information about the state boundaries of the United States.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(States)</code></pre>


<h3>Source</h3>

<p>https://www.census.gov/</p>

<hr>
<h2 id='SurveyQ'>Survey quality</h2><span id='topic+SurveyQ'></span>

<h3>Description</h3>

<p>Discriminations among good, fair and poor quality of surveys in cells and polygons.</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurveyQ(data, Longitude=NULL, Latitude=NULL, cell=60, Areas=NULL,
variables=c("Slope","Completeness","Ratio"), completeness=c(50,90),
slope=c(0.02,0.3), ratio=c(3,15), shape=NULL, shapenames=NULL, admAreas=TRUE,
Area="World", minLon, maxLon, minLat, maxLat, main=NULL, PLOTP=NULL,
PLOTB=NULL, POINTS=NULL, XLAB=NULL, YLAB=NULL, XLIM=NULL, YLIM=NULL,
palette=c("blue","green","red"), COLOR=c("red","green","blue"), colm="black",
labels=TRUE, sizelabels=1, LEGENDP=NULL, LEGENDM=NULL, file="Polar coordinates.csv",
na="NA", dec=",", row.names=FALSE, jpg=FALSE, filejpg="Map.jpg")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurveyQ_+3A_data">data</code></td>
<td>
<p>Data file exported by the functions <a href="#topic+KnowBPolygon">KnowBPolygon</a> or <a href="#topic+KnowB">KnowB</a> named &quot;Estimators&quot; with the values of records, observed richness, predicted richness, completeness and slope for each area polygon.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_longitude">Longitude</code></td>
<td>
<p>Variable with the longitude of the cells if the file &quot;Estimators&quot; was obtained with the function <a href="#topic+KnowB">KnowB</a>, so it is the case when working with cells.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_latitude">Latitude</code></td>
<td>
<p>Variable with the latitude of the cells if the file &quot;Estimators&quot; was obtained with the function <a href="#topic+KnowB">KnowB</a>, so it is the case when working with cells.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_cell">cell</code></td>
<td>
<p>Resolution of the cells (spatial units) in minutes on which calculations were carried out. In the present version the user can select any resolution between 1 and 60 minutes.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_areas">Areas</code></td>
<td>
<p>Variable with the names of the polygons, if the file &quot;Estimators&quot; was obtained with the function <a href="#topic+KnowBPolygon">KnowBPolygon</a>, so it is the case when working with polygons.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_variables">variables</code></td>
<td>
<p>The slope, completeness and ratio obtained in the file &quot;Estimators&quot;, in that order.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_completeness">completeness</code></td>
<td>
<p>Values of the completeness to define the thresholds for poor, fair and good quality surveys of the cells or polygons.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_slope">slope</code></td>
<td>
<p>Values of the slope to define the thresholds for poor, fair and good quality surveys of the cells or polygons.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_ratio">ratio</code></td>
<td>
<p>Values of the ratio to define the thresholds for poor, fair and good quality surveys of the cells or polygons.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_shape">shape</code></td>
<td>
<p>If the estimators in the function link[KnowBR]KnowBPolygon were calculated using an external shape file, it is necessary to indicate the file in this argument. It is not necessary to select any polygon within the file, just to load the whole shape file.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_shapenames">shapenames</code></td>
<td>
<p>Variable in the shapefile with the names of the polygons.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_admareas">admAreas</code></td>
<td>
<p>If it is TRUE the border lines of the countries are depicted in the map.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_area">Area</code></td>
<td>
<p>Only if using RWizard. A character with the name of the administrative area or a vector with several administrative areas (countries, regions, etc.) or river basins. If it is &quot;World&quot; (default) the entire world is plotted. For using administrative areas or river basins, in addition to use RWizard, it is also necessary to replace data(world) by @_Build_AdWorld_ (see examples of function <a href="#topic+KnowBPolygon">KnowBPolygon</a>).</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_minlon">minLon</code>, <code id="SurveyQ_+3A_maxlon">maxLon</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum longitude.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_minlat">minLat</code>, <code id="SurveyQ_+3A_maxlat">maxLat</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum latitude.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_main">main</code></td>
<td>
<p>Main title of the map.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_plotp">PLOTP</code></td>
<td>
<p>It allows to specify the characteristics of the function <a href="graphics.html#topic+plot.default">plot.default</a> of the polar coordinates plot.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_plotb">PLOTB</code></td>
<td>
<p>It allows to specify the characteristics of the function <a href="graphics.html#topic+plot.default">plot.default</a> of the bubble chart.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_points">POINTS</code></td>
<td>
<p>It allows to modify the points of the bubble chart with the function <a href="graphics.html#topic+points">points</a>.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_xlab">XLAB</code></td>
<td>
<p>Legend of the X axis.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_ylab">YLAB</code></td>
<td>
<p>Legend of the Y axis.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_xlim">XLIM</code></td>
<td>
<p>Vector with the limits of the X axis.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_ylim">YLIM</code></td>
<td>
<p>Vector with the limits of the Y axis.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_palette">palette</code></td>
<td>
<p>The color gradient of the bubble chart may be one of these palettes: &quot;heat.colors&quot;, &quot;terrain.colors&quot;, &quot;gray.colors&quot;, &quot;topo.colors&quot; or &quot;cm.colors&quot;.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_color">COLOR</code></td>
<td>
<p>It allows to modify the colors of the map and polar coordinates plot. It must be three colors.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_colm">colm</code></td>
<td>
<p>Color of the polygons without information when using when using an external shape file.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_labels">labels</code></td>
<td>
<p>If it is FALSE, points are depicted instead of the labels of the polygons in the polar coordinates plot.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_sizelabels">sizelabels</code></td>
<td>
<p>Text size of the labels of the polygons in the polar coordinates plot.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_legendp">LEGENDP</code></td>
<td>
<p>It allows to modify the legend of the polar coordinates plot.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_legendm">LEGENDM</code></td>
<td>
<p>It allows to modify the legend of the map.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_file">file</code></td>
<td>
<p>CSV FILES. Filename with the polar coordinates.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_na">na</code></td>
<td>
<p>CSV FILE. Text that is used in the cells without data.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_dec">dec</code></td>
<td>
<p>CSV FILE. It defines if the comma &quot;,&quot; is used as decimal separator or the dot &quot;.&quot;.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_row.names">row.names</code></td>
<td>
<p>CSV FILE. Logical value that defines if identifiers are put in rows or a vector with a text for each of the rows.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_jpg">jpg</code></td>
<td>
<p>If TRUE the map is exported to jpg files instead of using the windows device.</p>
</td></tr>
<tr><td><code id="SurveyQ_+3A_filejpg">filejpg</code></td>
<td>
<p>Name of the jpg file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has been designed to identify and plot the cells or polygons with good, fair and poor quality surveys. This function uses the file called &quot;Estimators&quot; obtained from the functions <a href="#topic+KnowBPolygon">KnowBPolygon</a> or <a href="#topic+KnowB">KnowB</a> to estimate the polar coordinates of all cells or polygons and to discriminate among cells or polygons according to the quality of the survey.
</p>
<p>The variables used by this function are slope, completeness and ratio (number of records/species observed). The default values to identify the cells or polygons with good, fair and poor quality surveys are: slope lower than 0.02, completeness higher than 90% and ratio higher than 15 for good quality surveys, and slope higher than 0.3, completeness lower than 50% and ratio lower than 3 for poor quality surveys.
</p>
<p>The order of the variables is important for the estimation of the polar coordinates because a different angle is assigned to each variable. Therefore, the variables must be introduced in this order: slope, completeness and ratio.
</p>
<p>All variables are transformed to a scale ranged between -1 and 1. For each value the X and Y polar coordinates are estimated using the following equations:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code class="reqn">X=\displaystyle\sum_{i=1}^{3}|z_j|cos(\alpha)</code> </td><td style="text-align: left;"> <code class="reqn">Y=\displaystyle\sum_{i=1}^{3}|z_j|sin(\alpha)</code>
</td>
</tr>

</table>

<p>where <em>z</em> is the value of the variable <em>j</em>.
</p>
<p>Each variable is assigned an angle (<code class="reqn">\alpha</code>). The increment value of the angle is always 60. Therefore, the first variable (slope) if the transformed value is <code class="reqn">\geq0</code> the <code class="reqn">\alpha</code> value is 60 and if the transformed value is <code class="reqn">&lt;0</code> the value is 240.
</p>
<p>For the second variable (completeness) if the transformed value is <code class="reqn">\geq0</code> the <code class="reqn">\alpha</code> value is 120 and if the value is <code class="reqn">&lt;0</code> the value is 300.
</p>
<p>For the third variable (ratio) if the value is <code class="reqn">\geq0</code> the <code class="reqn">\alpha</code> value is 180 and if the transformed value is <code class="reqn">&lt;0</code> the value is 360.
</p>
<p>Degrees to radians angle conversion is carried out assuming that 1 degree = pi/180 radians.
</p>
<p><strong>EXAMPLES</strong>
Polar coordinates of the records of freshwater fish species in all countries of the world.
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F6.jpg" width="50" alt="F6.jpg" />

</td>
</tr>

</table>

<p>Quality survey of the records of freshwater fish species in all countries of the world.
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F7.jpg" width="50" alt="F7.jpg" />

</td>
</tr>

</table>

<p>Bubble chart of the relationship between log(Ratio) and completeness, being the color gradient the slope value.
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F8.jpg" width="50" alt="F8.jpg" />

</td>
</tr>

</table>



<h3>Value</h3>

<p>It is depicted a plot with the polar coordinates of each polygon or cell, a map with the quality survey of the cells or polygons and a file with the polar coordinates of the cells or polygons.</p>


<h3>References</h3>

<p>Guisande, C., Manjarrés-Hernández, A., Pelayo-Villamil, P., Granado-Lorencio, C., Riveiro, I., Acuña, A., Prieto-Piraquive, E., Janeiro, E., Matías, J.M., Patti, C., Patti, B., Mazzola, S., Jiménez, S., Duque, V. &amp; Salmerón, F. (2010) IPez: An expert system for the taxonomic identification of fishes based on machine learning techniques. <em>Fisheries Research</em>, 102, 240-247.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(adworld)
data(Estimators)
SurveyQ(data=Estimators, Areas="Area")

## End(Not run)

</code></pre>

<hr>
<h2 id='SurveyQCZ'>Survey quality of climate zones</h2><span id='topic+SurveyQCZ'></span>

<h3>Description</h3>

<p>Estimation of the survey quality of different climate zones.</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurveyQCZ(data, Longitude="Longitude", Latitude="Latitude", cell=NULL, hull=TRUE,
Area="World", shape=NULL, shapenames=NULL, aprox=TRUE, VIDTAXA=NULL, por=80, k=NULL,
VIF=FALSE, VARSEDIG=FALSE, BUBBLE=FALSE, variables=c("Slope","Completeness","Ratio"),
completeness=c(50,90), slope=c(0.02,0.3), ratio=c(3,15), minLon=NULL,
maxLon=NULL, minLat=NULL, maxLat=NULL, xlab="Longitude", ylab="Latitude",
colscale=c("#C8FFFFFF","#64FFFFFF","#00FFFFFF","#64FF64FF","#C8FF00FF",
"#FFFF00FF","#FFC800FF","#FF6400FF","#FF0000FF"), colcon="transparent",
breaks=10, ndigits=0, xl=0, xr=0, mfrowBOXPLOT=NULL, mfrowMAP=NULL,
main="Percentage of ignorance/poor\n cells in each cluster", cexCM=0.5,
legpos="bottomleft", jpg=FALSE, filejpg="Survey Quality CZ.jpg", dec=",")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurveyQCZ_+3A_data">data</code></td>
<td>
<p>Data file exported by the function <a href="#topic+KnowB">KnowB</a> named &quot;Estimators&quot; with the values of records, observed richness, predicted richness, completeness and slope for each area polygon. This file may include the values of the environmental variables for each cell.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_longitude">Longitude</code></td>
<td>
<p>Variable with the longitude.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_latitude">Latitude</code></td>
<td>
<p>Variable with the latitude.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_cell">cell</code></td>
<td>
<p>Resolution of the cells (spatial units) in minutes. In the present version the user can select any resolution between 1 and 60 minutes. If it is NULL (default), it is used the resolution of the ASC files with the environmental variables. It is not NULL, the ASC files are rescaled to the resolution selected by the user.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_hull">hull</code></td>
<td>
<p>If it is TRUE, the extent is estimated as the convex null of the data. It is FALSE, it is used as extent the polygons defined in the arguments <em>shape</em> of <em>Area</em>.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_area">Area</code></td>
<td>
<p>Only if using RWizard. It allows to plot countries, regions, river basins, etc., as extentd. A character with the name of the administrative area or a vector with several administrative areas (countries, regions, etc.) or river basins. If it is &quot;World&quot; (default) the entire world is plotted. For using administrative areas or river basins, in addition to use RWizard, it is also necessary to replace data(world) by @_Build_AdWorld_.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_shape">shape</code></td>
<td>
<p>Optionally it may be used a shape file with the information of the polygons.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_shapenames">shapenames</code></td>
<td>
<p>Variable in the shapefile with the names of the polygons.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_aprox">aprox</code></td>
<td>
<p>If it is TRUE and there is not environmental data available in the cell, it is used the nearest cell available in the environmental data set.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_vidtaxa">VIDTAXA</code></td>
<td>
<p>It accesses the VIDTAXA function of the VARSEDIG package.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_por">por</code></td>
<td>
<p>Cut-off threshold specifying the cumulative variance percentage, to determine how many axes are selected from the Principal Components or Correspondence analyses. By default it is 80%, which means that the axes are selected until reaching an accumulated variance percentage of 80%.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_k">k</code></td>
<td>
<p>Number of clusters in which the Dendrogram is divided. If it is NULL, the algorithm select automatically the maximum number of clusters in which the Dendrogram can be divided, which are those groups that are statistically different in at least one variable according to the U Mann-Whitney test. If the are is large, there may be many different climate zones, so with NULL option running time may be long.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_vif">VIF</code></td>
<td>
<p>If it is TRUE, the inflation factor of the variance (VIF) is used to select the highly correlated variables and, therefore, not correlated variables are excluded from the Principal Components analysis.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_varsedig">VARSEDIG</code></td>
<td>
<p>If it is TRUE, the VARSEDIG algorithm is performed.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_variables">variables</code></td>
<td>
<p>The slope, completeness and ratio obtained in the file &quot;Estimators&quot;, in that order.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_bubble">BUBBLE</code></td>
<td>
<p>If it is TRUE, the BUBBLE plot the VARSEDIG function is depicted.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_completeness">completeness</code></td>
<td>
<p>Values of the completeness to define the thresholds for poor, fair and good quality surveys of the cells.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_slope">slope</code></td>
<td>
<p>Values of the slope to define the thresholds for poor, fair and good quality surveys of the cells.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_ratio">ratio</code></td>
<td>
<p>Values of the ratio to define the thresholds for poor, fair and good quality surveys of the cells.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_minlon">minLon</code>, <code id="SurveyQCZ_+3A_maxlon">maxLon</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum longitude.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_minlat">minLat</code>, <code id="SurveyQCZ_+3A_maxlat">maxLat</code></td>
<td>
<p>Optionally it is possible to define the minimum and maximum latitude.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_xlab">xlab</code></td>
<td>
<p>Legend of the X axis in the map.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_ylab">ylab</code></td>
<td>
<p>Legend of the Y axis in the map.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_colscale">colscale</code></td>
<td>
<p>Color of the bar scale.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_colcon">colcon</code></td>
<td>
<p>Background color of the administrative areas.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_breaks">breaks</code></td>
<td>
<p>Number of breakpoints of the color legend.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_ndigits">ndigits</code></td>
<td>
<p>Number of decimals in legend of the color scale.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_xl">xl</code>, <code id="SurveyQCZ_+3A_xr">xr</code></td>
<td>
<p>The lower left and right coordinates of the color legend in user coordinates.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_mfrowboxplot">mfrowBOXPLOT</code></td>
<td>
<p>It allows to specify the boxplot panel. It is a vector with two numbers, for example c(2,5) which means that the boxplots are put in 2 rows and 5 columns.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_mfrowmap">mfrowMAP</code></td>
<td>
<p>It allows to specify the map panel. It is a vector with two numbers, for example c(3,2) which means that the map panel are put in 3 rows and 2 columns.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_main">main</code></td>
<td>
<p>Main title of the map with the percentage of ignorance/poor cells.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_cexcm">cexCM</code></td>
<td>
<p>Size of the points in the maps of the climate clusters.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_legpos">legpos</code></td>
<td>
<p>Legend position with the number of the cluster in the maps of the climate clusters.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_jpg">jpg</code></td>
<td>
<p>If TRUE the plots are exported to jpg files instead of using the windows device.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_filejpg">filejpg</code></td>
<td>
<p>Name of the jpg file.</p>
</td></tr>
<tr><td><code id="SurveyQCZ_+3A_dec">dec</code></td>
<td>
<p>CSV FILE. It defines if the comma &quot;,&quot; is used as decimal separator or the dot &quot;.&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The aim of this algorithm is to identify different climate zones and to estimate survey quality of these zones. The climate zones are classified from those with higher percentage of ignorance/poor survey quality cells (poor surveyed climate zones), to those with the lower percentage of ignorance/poor survey quality cells (better surveyed climate zones). This function uses the algorithm of the VARSEDIG function (Guisande et al., 2016; 2019; Guisande, 2019, which is briefly summarized as follows.
</p>
<p>This function only works if there are ASC files with the environmental variables in the working directory.
</p>
<p>In the first step of the algorithm, a Principal Components analysis is performed, being the cases the different cells and the variables the environmental variables. The aim is to determine the environmental variables responsible for the variability observed among the cells.
</p>
<p>To detect the potential groups being formed in the Principal Components analysis, a Dendrogram is applied to the scores obtained from the axes that absorb a greater variance. By default, the axes that absorb 80% of the variability are chosen, but this value can be modified by the user.
</p>
<p>Subsequently, a Discriminant Analysis is carried out to determine if the clusters that have been generated are well discriminated, that is, to determine the number of correctly identified cases in each cluster.
</p>
<p>Next, a U Mann-Whitney test is performed to determine if there are significant differences in the variables between the clusters.
</p>
<p>The idea of this function is to find the largest possible number of clusters with the highest discrimination percentage. To do this, the user should perform tests modifying the cut-off threshold by specifying the cumulative variance percentage to determine how many axes are selected from the Main Components (by default <em>por=80</em>) and the variables to be included, eliminating those that are not correlated and are not useful in the Principal Components analyses, as well as those that have little discrimination power in the Discriminant Analysis.
</p>
<p>Once the different climate zones have been identified, with the file Estimators.CSV obtained from the function KnowB (Lobo et al., 2018; Guisande &amp; Lobo, 2019), with the values of the slope, completeness and the ratio between the number of records and the observed species (R/S) for different cells, it is estimated the percentage of ignorance/poor cells in each climate zone. Ignorance cell are those for which was not possible to estimate the slope, completeness and/or R/S, because there are not records or the number of records in small. Poor quality surveys cells are those that slope &gt; 0.3, completeness &lt; 50
</p>
<p><strong>FUNCTIONS</strong>
</p>
<p>This function uses the algorithm of the VIDTAX function of the VARSEDIG package (Guisande et al., 2016; 2019). The Principal Components Analysis was performed with the <a href="stats.html#topic+prcomp">prcomp</a> function of the stats package. The <a href="usdm.html#topic+vif">vif</a> function of the usdm package was used for the calculation of VIF (Naimi et al., 2014; Naimi, 2017). To perform the <em>biplot</em> graph the <a href="car.html#topic+scatterplot">scatterplot</a> function of the car package was used (Fox et al., 2018). The arrows are depicted with the function <a href="IDPmisc.html#topic+Arrows">Arrows</a> of the package IDPmisc (Locher &amp; Ruckstuhl, 2014). The convex hull is estimated with the function <a href="grDevices.html#topic+chull">chull</a> of the package grDevices. KMO test was performed with the function <a href="psych.html#topic+KMO">KMO</a> of the package psych (Revelle, 2018).  The U Mann-Whitney test is performed with the <em>wilcox.test</em> function of the base stats package. The comparison between clusters with the VARSEDIG algorithm is done with the VARSEDIG function  (Guisande et al., 2016). The Linear Discriminant Analysis was performed with the functions <a href="candisc.html#topic+candisc">candisc</a> of the candisc package (Friendly, 2007; Friendly &amp; Fox, 2017) and <a href="MASS.html#topic+lda">lda</a> of the MASS package (Venables &amp; Ripley, 2002; Ripley et al., 2018). The Quadratic Discriminant Analysis was performed with the function <a href="MASS.html#topic+qda">qda</a> of the MASS package (Venables &amp; Ripley, 2002; Ripley et al., 2018). The graph with one dimension in the Discriminant analysis was performed with the function <a href="candisc.html#topic+plot.cancor">plot.cancor</a> of the candisc package (Friendly, 2007; Friendly &amp; Fox, 2017).
</p>
<p><strong>EXAMPLE</strong>
</p>
<p>We used the file Estimators obtained with the function <a href="#topic+KnowB">KnowB</a> using a database that includes 121,709 records of freshwater fishes obtained from Pelayo-Villamil et al. (2015), with the Clench estimator and a cell resolution of 5'.
</p>
<p>In the working directory, there are the environmental variables BIO1, BO2, BIO4, BIO8, BIO12, BIO14, BIO15, BIO18 and BIO19 of the WorldClim data set (Hijmans et al., 2005), as ASC raster files. 
</p>
<p>As the argument <em>VIF=FALSE</em>, there is not information about VIF, and the first statistic obtained is the KMO test, which tells us if the variables are adequate for the Principal Components. The value must be greater than 0.5. Therefore, all variables that do not have a value greater than 0.5, could be eliminated from the analysis. In the case that the value is exactly 0.5, it means that it is not possible to estimate the KMO. The minimum value was 0.73 for BIO12, so all variables are adequate for the Principal Components.
</p>
<p>The next statistic that appears is Bartlett's test of sphericity, which tests whether the correlation matrix is an identity matrix, which would indicate that the factor model is inappropriate. A value <em>p</em> of the contrast smaller than the level of significance allows rejecting the hypothesis and concluding that there is correlation. Therefore, for the Principal Components analysis to be valid, the probability must be less than 0.05, as it is in this case, with a p&lt;0.001.
</p>
<p>The first figure is the Principal Components. The first axis accounts for 62.9%, the second for 16.5% and the third for 7% of the variance observed. The first three axes explain 86.5% of the variance. Since the default value of <em>por=80</em> was selected, these three Principal Component axes are selected.
</p>
<p>In the Dendrogram there were 22 clusters statistically different, because the argument <em>k=NULL</em> in the script (default option), which means that the algorithm finds the maximum number of statistically different climate zones. The results obtained in the files U Mann-Whitney test.CSV and Descriptive statistics of clusters.CSV show that there are statistical differences among all 22 clusters in at least one variable (U Mann-Whitney test, p&lt;0.001).
</p>
<p>Other plots and statistics are obtained, which are fully explained in the manuscript that describes the algorithm VIDTAXA (Guisande et al., 2019).
</p>
<p>The final plot is the map with the percentage of ignorance/poor cells (see map below). It is clear that the area with a better survey quality is in South-East of United Kingdom.
</p>

<table>
<tr>
 <td style="text-align: center;">
<img src="../help/figures/F9.jpg" width="50" alt="F9.jpg" />

</td>
</tr>

</table>



<h3>Value</h3>

<p>It is obtained:
</p>
<p>1. A TXT file with the VIF (if the argument <em>VIF=TRUE</em>), the correlations between variables, the Kaiser-Meyer-Olkin (KMO) test, the Bartlett sphericity test and the results of the Principal Components or Correspondence analyses. The file is called by default &quot;Output.TXT&quot;.
</p>
<p>2. A CSV FILE with the coordinates for each case of the Principal Components or Correspondence analyses. The file is called by default &quot;Cat loadings.CSV&quot;.
</p>
<p>3. A CSV FILE with the descriptive statistics of each variable for each of the clusters obtained in the Dendrogram. The file is called by default &quot;Descriptive statistics of clusters.CSV&quot;.
</p>
<p>4. A CSV FILE with the original data of the variables and the cluster to which each case belongs. The file is called by default &quot;Original data and cluster number.CSV&quot;.
</p>
<p>5. A CSV FILE with the coordinates of the variables in the Linear Discriminant Analysis plot. The file is called by default &quot;Var loadings-Linear.csv&quot;
</p>
<p>6. A CSV FILE with the coordinates of the categories in the Linear Discriminant Analysis plot. The file is called by default &quot;Cat loadings-Linear.csv&quot;.
</p>
<p>7. A CSV FILE with the predictions table using the cross-validation of Linear Discriminant Analysis. The file is called by default &quot;Table cross-validation-Linear.csv&quot;.
</p>
<p>8. A CSV FILE with the group to which each case belongs and the prediction of the Discriminant Analysis using the cross-validation of the Linear Discriminant Analysis. The file is called by default &quot;Cases cross-validation-Linear.csv&quot;.
</p>
<p>9. A CSV file with the predictions table using the cross-validation of the Quadratic Discriminant Analysis. The file is called by default &quot;Table cross-validation-Quadratic.csv&quot;.
</p>
<p>10. A CSV file with the group to which each case belongs and the prediction of the Discriminant Analysis using the cross-validation of the Quadratic Discriminant Analysis. The file is called by default &quot;Cases cross-validation-Quadratic.csv&quot;.
</p>
<p>11. A CSV file with the obtained probabilities of comparing all the variables among all the clusters with the U Mann-Whitney test. The file is called by default &quot;U Mann-Whitney test.csv&quot;.
</p>
<p>12. A CSV file called by default &quot;Priorization.csv&quot;, with the clusters of the different climate zones arranged from the cluster with the higher percentage of cells catalogued as ignorance/poor (lowest quality survey) to the cluster with the lower percentage of cells catalogued as ignorance/poor (highest quality survey).
</p>
<p>13. A scatterplot of the Principal Components or Correspondence analyses.
</p>
<p>14. A Dendrogram grouping by clusters according to the scores of the Principal Components or Correspondence analyses.
</p>
<p>15. A graphic panel with a boxplot for each variable comparing the values of these variables between each of the clusters obtained in the Dendrogram.
</p>
<p>16. A Graph of the Discriminant Analysis showing the influence of the variables on the discriminant axis I, differentiating the different clusters.
</p>
<p>17. A graph of the Discriminant Analysis showing the scores of the discriminant axes I and II, differentiating the different clusters.
</p>
<p>18. If the argument <em>BUBBLE=TRUE</em>, a bubble chart with the number of variables that are statistically different between clusters.
</p>
<p>19. The maps with the climate zones.
</p>
<p>20. The map with the percentage of ignorance/poor cells.
</p>


<h3>References</h3>

<p>Fox, J., Weisberg, S., Adler, D., Bates, D., Baud-Bovy, G., Ellison, S., Firth, D., Friendly, M., Gorjanc, G., Graves, S., Heiberger, R., Laboissiere, R., Monette, G., Murdoch, D., Nilsson, H., Ogle, D., Ripley, B., Venables, W. &amp; Zeileis, A. (2018) Companion to Applied Regression. R package version 3.0-0. Available at: <a href="https://CRAN.R-project.org/package=car">https://CRAN.R-project.org/package=car</a>.
</p>
<p>Friendly, M. &amp; Fox, J. (2017) Visualizing Generalized Canonical Discriminant and Canonical Correlation Analysis. R package version 0.8-0. Available at: <a href="https://CRAN.R-project.org/package=candisc">https://CRAN.R-project.org/package=candisc</a>.
</p>
<p>Friendly, M. (2007). HE plots for Multivariate General Linear Models. <em>Journal of Computational and Graphical Statistics</em>, 16: 421-444.
</p>
<p>Guisande, C., Vari, R.P., Heine, J., GarcÃ­a-RosellÃ³, E., GonzÃ¡lez-Dacosta, J., PÃ©rez-Schofield, B.J., GonzÃ¡lez-Vilas, L. &amp; Pelayo-Villamil, P. (2016) VARSEDIG: an algorithm for morphometric characters selection and statistical validation in morphological taxonomy. <em>Zootaxa</em>, 4162: 571-580.
</p>
<p>Guisande, C., Rueda-Quecho, A.J., Rangel-Silva, F.A., Heine, J., GarcÃ­a-RosellÃ³, E., GonzÃ¡lez-Dacosta, J. &amp; Pelayo-Villamil, P. (2019) VIDTAXA: an algorithm for the identification of statistically different groups based on variability obtained in factorial analyses. <em>Ecological Informatics</em>, 46: 62-68.
</p>
<p>Hijmans, R.J., Cameron, S.E., Parra, J.L., Jones, P.G. &amp; Jarvis, A. (2005) Very high resolution interpolated climate surfaces for global land areas. <em>International Journal of Climatology</em>, 25: 1965-1978.
</p>
<p>Locher, R. &amp; Ruckstuhl, A. (2014) Utilities of Institute of Data Analyses and Process Design. R package version 1.1.17. Available at: <a href="https://CRAN.R-project.org/package=IDPmisc">https://CRAN.R-project.org/package=IDPmisc</a>.
</p>
<p>Naimi, B. (2017) Uncertainty analysis for species distribution models. R package version 1.1-18. Available at: <a href="https://CRAN.R-project.org/package=usdm">https://CRAN.R-project.org/package=usdm</a>.
</p>
<p>Naimi, B., Hamm, N.A.S., Groen, T.A., Skidmore, A.K., &amp; Toxopeus, A.G. (2014) Where is positional uncertainty a problem for species distribution modelling? <em>Ecography</em>, 37: 191-203.
</p>
<p>Pelayo-Villamil, P., Guisande, C., Vari, R.P., ManjarrÃ©s-HernÃ¡ndez, A., GarcÃ­a-RosellÃ³, E., GonzÃ¡lez-Dacosta, J., Heine, J., GonzÃ¡lez-Vilas, L., Patti, B., Quinci, E.M., JimÃ©nez, L.F., Granado-Lorencio, C., Tedesco, P.A., Lobo, J.M. (2015) Global diversity patterns of freshwater fishes-Potential victims of their own success. <em>Diversity and Distributions</em>, 21: 345-356.
</p>
<p>Revelle,W. (2018) Procedures for Psychological, Psychometric, and Personality Research. R package version 1.8.4. Available at: <a href="https://CRAN.R-project.org/package=psych">https://CRAN.R-project.org/package=psych</a>.
</p>
<p>Ripley, B., Venables, B., Bates, D.M., Hornik, K., Gebhardt, A. &amp; Firth, D. (2018) Support Functions and Datasets for Venables and Ripley's MASS. R package version 7.3-50. Available at: <a href="https://CRAN.R-project.org/package=MASS">https://CRAN.R-project.org/package=MASS</a>.
</p>
<p>Venables, W.N. &amp; Ripley, B.D. (2002) <em>Modern Applied Statistics with S</em>. Springer, fourth edition, New York. <a href="https://www.stats.ox.ac.uk/pub/MASS4/">https://www.stats.ox.ac.uk/pub/MASS4/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
####This script only works if there are ASC files, with
####environmental variables, in the working directory

data(FishIrelandUK)

data(adworld)

SurveyQCZ(data=FishIrelandUK, maxLon=3, mfrowBOXPLOT=c(3,3), cexCM=0.2)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
