<!DOCTYPE html><html><head><title>Help for package psidread</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {psidread}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#psid_read'><p>Read PSID data from the packaged data file or customized data file</p></a></li>
<li><a href='#psid_reshape'><p>Rename and reshape your PSID dataset</p></a></li>
<li><a href='#psid_str'><p>Construct the table of PSID data structure</p></a></li>
<li><a href='#psid_unzip'><p>Unzip and transfer the downloaded PSID data files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Streamline Building Panel Data from Panel Study of Income
Dynamics ('PSID') Raw Files</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Streamline the management, creation, and formatting of panel data from the Panel Study of Income Dynamics ('PSID') <a href="https://psidonline.isr.umich.edu">https://psidonline.isr.umich.edu</a> using this user-friendly tool. Simply define variable names and input code book details directly from the 'PSID' official website, and this toolbox will efficiently facilitate the data preparation process, transforming raw 'PSID' files into a well-organized format ready for further analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Qcrates/psidread">https://github.com/Qcrates/psidread</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Qcrates/psidread/issues">https://github.com/Qcrates/psidread/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>asciiSetupReader, dplyr, stringr, tidyr, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), DiagrammeR, spelling</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-05 15:32:46 UTC; RachelChiu</td>
</tr>
<tr>
<td>Author:</td>
<td>Shuyi Qiu <a href="https://orcid.org/0009-0000-9730-5262"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shuyi Qiu &lt;shuyi.qiu@duke.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-05 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='psid_read'>Read PSID data from the packaged data file or customized data file</h2><span id='topic+psid_read'></span>

<h3>Description</h3>

<p><code>psid_read()</code> is the core function which enables the user to read variables from multiple packaged PSID data files using just one line of code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psid_read(indir, str_df, idvars = NA, type, filename = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psid_read_+3A_indir">indir</code></td>
<td>
<p>A character value of the directory path where the user store the .rda data files. This value should be the same as the <code>exdir</code> in the <code>psid_unzip()</code></p>
</td></tr>
<tr><td><code id="psid_read_+3A_str_df">str_df</code></td>
<td>
<p>A data frame of the data structure, generated from the <code>psid_str()</code> function.</p>
</td></tr>
<tr><td><code id="psid_read_+3A_idvars">idvars</code></td>
<td>
<p>A vector of character values, including the variables that do not change across years. Labelled as &quot;ALL YEAR&quot; in PSID website.</p>
</td></tr>
<tr><td><code id="psid_read_+3A_type">type</code></td>
<td>
<p>The type of data that the user downloaded from PSID. Set to &quot;package&quot; if the user downloaded packaged dataset, &quot;single&quot; if the user downloaded selected data set.</p>
</td></tr>
<tr><td><code id="psid_read_+3A_filename">filename</code></td>
<td>
<p>A character value of the name of the file. You can use the filename value you used when you run <code>psid_unzip()</code>, or a filename without any file extension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function also offers the option to read a customized single data files with selected variables.
It is important to note that <code>psid_read()</code> does not change the original variable names as they are in the source data.
To execute it effectively, please make sure that:
</p>

<ul>
<li> <p><code>psid_str()</code> has been executed beforehand and the table of data structure has been in the environment.
</p>
</li>
<li> <p><code>psid_unzip()</code> has been executed to prepare the data in <code>.rda</code> format.
</p>
</li></ul>



<h3>Value</h3>

<p>A data frame with all the selected variables inside but name unchanged.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Read from multiple package data files (Whole procedure)
psid_varlist = c(" hh_age || [13]ER53017 [17]ER66017",
                            " p_age || [13]ER34204")
str_df &lt;- psid_str(varlist = psid_varlist,
                   type = "separated")
# Below is the file path for the package test data, set this to your own directory
indir &lt;- system.file(package = "psidread","extdata")
psid_read(indir = indir,
          str_df = str_df,
          idvars = c("ER30000"),
          type = "package",
          filename = NA)

# Example 2: Read from your customized data file (Whole procedure)
filename = "J327825.zip"
psid_read(indir = indir,
          str_df = str_df,
          idvars = c("ER30000"),
          type = "single",
          filename = filename)
</code></pre>

<hr>
<h2 id='psid_reshape'>Rename and reshape your PSID dataset</h2><span id='topic+psid_reshape'></span>

<h3>Description</h3>

<p><code>psid_reshape()</code> serves as the final step in processing your PSID data which helps the user rename and reshape the data frame to produce output in your desired format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psid_reshape(psid_df, str_df, shape = "wide", level = "individual")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psid_reshape_+3A_psid_df">psid_df</code></td>
<td>
<p>The data frame generated from psid_read() function. The user should not change anything on the data frame.</p>
</td></tr>
<tr><td><code id="psid_reshape_+3A_str_df">str_df</code></td>
<td>
<p>The structure data frame generated from psid_str() function.</p>
</td></tr>
<tr><td><code id="psid_reshape_+3A_shape">shape</code></td>
<td>
<p>The shape you would like the data frame to be.
&quot;long&quot; if you want to have each line represent the data for each person at each year;
&quot;wide&quot; if you want to have each line represent the data for all waves for each person;</p>
</td></tr>
<tr><td><code id="psid_reshape_+3A_level">level</code></td>
<td>
<p>The level of output. Default value is set to 'individual'.
The user can also set this value to 'household' if needed. Deduplication will be performed and leave only the record of household head for each household.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function offers options in data output at both the household and individual levels.
When the user specifies for household-level output, the output will only retain the household head's record for each household.
This option will be useful if the user aims to conduct family-level analysis.
In contrast, individual-level output includes details for all family members.
</p>
<p>Additionally, <code>psid_reshape()</code> allows for choosing between wide and long formats.
In the wide format, variables are named as <code>VARNAME_YYYY</code>.
</p>


<h3>Value</h3>

<p>A data frame with self-defined variable name
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import dataset use `psid_str()`, `psid_unzip()` and `psid_read()`
psid_varlist = c(" hh_age || [13]ER53017 [17]ER66017"," p_age || [13]ER34204")
str_df &lt;- psid_str(varlist = psid_varlist, type = "separated")
# Below is the file path for the package test data, set this to your own directory
indir &lt;- system.file(package = "psidread","extdata")
df &lt;- psid_read(indir = indir,
                str_df = str_df,
                idvars = c("ER30000"),
                type = "package",
                filename = NA)
# Example 1: Individual-level output in long format
ind_long_df &lt;- psid_reshape(psid_df = df,
                          str_df = str_df,
                          shape = "long",
                          level = "individual")
# Example 2: Household-level output in wide format
fam_wide_df &lt;- psid_reshape(psid_df = df,
                            str_df = str_df,
                            shape = "wide",
                            level = "household")
</code></pre>

<hr>
<h2 id='psid_str'>Construct the table of PSID data structure</h2><span id='topic+psid_str'></span>

<h3>Description</h3>

<p>The <code>psid_str()</code> function provides a simplified solution to build a table of data structure for your PSID dataset with your customized variable names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psid_str(varlist, type = "separated")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psid_str_+3A_varlist">varlist</code></td>
<td>
<p>A vector of string values or a single string value, including user's self-defined variable name and the year and variable code from PSID website.</p>
</td></tr>
<tr><td><code id="psid_str_+3A_type">type</code></td>
<td>
<p>A string value of either &quot;separated&quot; or &quot;integrated&quot;, indicating the type of varlist</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is influenced by the methodology implemented in the <code>psidtools</code> package developed by Professor Ulrich Kohler.
To utilize it, users only need to provide either a string vector (which is recommended) or a single value (if copying and pasting from their .do file).
Minimal additional formatting is needed, and users can easily copy and paste year-variable names directly from the PSID website's codebook.
</p>

<ul>
<li><p> This data frame only contains cross-year variables selected by the user to include in their panel dataset.
Do not specify ALL-YEAR variables here (e.g., individual's sex, individual's birth order).
</p>
</li>
<li><p> The recommended approach for providing the variable list is to separate them into distinct character values and then wrap them within a vector.
For example: <code>c(" hh_age || [13]ER53017  [17]ER66017", " p_age || [13]ER34204")</code>
<code>hh_age</code> and <code>p_age</code> are self-defined variable name. It is up to you! The final data output will show this variable name instead of the variable code like <code>ER34204</code>.
The <code style="white-space: pre;">&#8288;[YY]VARCODE&#8288;</code> sequence can be found from the code book of PSID. You do not need to make any changes on them.
Please ensure proper separation between the user-defined variable name and the <code style="white-space: pre;">&#8288;[YY]VARCODE&#8288;</code> using &quot;||&quot;.
Each variable sequence should be placed in a separate string value.
If this method is used, users should set the <code>type</code> argument to &quot;separated&quot;.
</p>
</li>
<li><p> This function also offers an option for users who wish to copy and paste their code directly from Stata.
Simply copy and paste your code into a single string value without making any alterations.
For instance: <code>"|| hh_age /// [13]ER53017  [17]ER66017 /// || p_age /// [13]ER34204///"</code>
Note the different position of &quot;||&quot; between the two input methods.
If you utilize this input method, please specify the <code>type</code> argument as &quot;integrated.&quot;
</p>
</li></ul>

<p>The output of this function will be utilized by <code>psid_read()</code> for reading the dataset into the environment and by <code>psid_reshape()</code> for renaming and reshaping the panel dataset.
Therefore, it is recommended to execute this function prior to running other functions within this package.
</p>


<h3>Value</h3>

<p>A data frame of the data structure of your PSID dataset, with each row represents the year and each column represents the variable
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: Separated string input
psid_varlist = c(" hh_age || [13]ER53017 [17]ER66017",
                 " p_age || [13]ER34204")
psid_str(varlist = psid_varlist, type = "separated")

# Example 2: Integrated string input
psid_varlist &lt;- "|| hh_age ///
                [13]ER53017  [17]ER66017 ///
                || p_age ///
                [13]ER34204///" # DO NOT CHANGE ANYTHING
psid_str(varlist = psid_varlist, type = "integrated")
</code></pre>

<hr>
<h2 id='psid_unzip'>Unzip and transfer the downloaded PSID data files</h2><span id='topic+psid_unzip'></span>

<h3>Description</h3>

<p>This <code>psid_unzip()</code> function streamlines the process of transforming ASCII data downloaded from the PSID website to R data files (.rda).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psid_unzip(indir, exdir, zipped = TRUE, type = "package", filename = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psid_unzip_+3A_indir">indir</code></td>
<td>
<p>A string value of the directory path where the user store the downloaded data files.</p>
</td></tr>
<tr><td><code id="psid_unzip_+3A_exdir">exdir</code></td>
<td>
<p>A string value of the directory path where the user wish to put the generated <code>.rda</code> files.</p>
</td></tr>
<tr><td><code id="psid_unzip_+3A_zipped">zipped</code></td>
<td>
<p>A logic value indicating whether the data files are zipped or not.</p>
</td></tr>
<tr><td><code id="psid_unzip_+3A_type">type</code></td>
<td>
<p>A string value of either &quot;package&quot; or &quot;single&quot;, indicating whether the data files are packaged data file or a single customized dataset with only selected variables.</p>
</td></tr>
<tr><td><code id="psid_unzip_+3A_filename">filename</code></td>
<td>
<p>A string value of the name of the single file. Default to be NA, but requires to be specified if the type is &quot;single&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function executes two primary operations:
</p>

<ul>
<li><p> Unzip the zipped data files
</p>
</li>
<li><p> Converts the ASCII file into a <code>.rda</code> format for the reading steps
</p>
</li></ul>

<p>For optimal functionality, please ensure that you have satisfied the following prerequisites:
</p>

<ul>
<li><p> If you are using packaged data files, please do not make any changes to the name of the data files
</p>
</li>
<li><p> If you download the dataset with only selected variables, please choose <code style="white-space: pre;">&#8288;ASCII Data With SAS Statements&#8288;</code> as the data output type
</p>
</li></ul>

<p>The user will only need to execute this function once.
If you have already executed this function before and have all the <code>.rda</code> files settled down, you do not have to run this again.
This function may take several minutes if you have multiple packaged file to unzip and convert.
</p>


<h3>Value</h3>

<p><code>.rda</code> data files stored in the specified directory file folder
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#' # Example 1: Unzip and convert packaged files
exdir &lt;- tempdir()
indir &lt;- system.file(package = "psidread","extdata") # Define the input directory
psid_unzip(indir = indir, exdir = exdir, zipped = TRUE, type = "package", filename = NA)
# Example 2: Unzip and convert customized single data files
exdir &lt;- tempdir()
indir &lt;- system.file(package = "psidread","extdata") # Define the output directory
filename = "J327825.zip"
psid_unzip(indir = indir, exdir = exdir, zipped = TRUE, type = "single", filename = filename)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
