<!DOCTYPE html><html><head><title>Help for package gen3sis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gen3sis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apply_ecology'><p>Allows the user to define the ecological consequences for species within each site,</p>
defining thus species survival and abundance</a></li>
<li><a href='#apply_evolution'><p>Allows defining the function that changes the values of traits of a given</p>
species at each time-step and in each site. If no operations are provided, traits are not changing</a></li>
<li><a href='#color_richness'><p>Define gen3sis richness color scale which is colour-vision deficient and colour-blind people safe based on scientific colour maps by Fabio Crameri</p></a></li>
<li><a href='#color_richness_non_CVDCBP'><p>Define gen3sis richness color scale for non colour-vision deficient and colour-blind people</p></a></li>
<li><a href='#create_ancestor_species'><p>Allows the user to populate the world at the beginning of a simulation</p></a></li>
<li><a href='#create_input_config'><p>Creates either an empty configuration or a pre-filled configuration object from a config file</p></a></li>
<li><a href='#create_input_landscape'><p>create an landscape input from a named list of rasters or raster files</p></a></li>
<li><a href='#create_species'><p>Creates a new species</p></a></li>
<li><a href='#evolution_mode_none'><p>No evolution considered</p></a></li>
<li><a href='#gen3sis'><p>gen3sis: General Engine for Eco-Evolutionary Simulations</p></a></li>
<li><a href='#get_dispersal_values'><p>Allows the user to generate dispersal value(s) for a given species. The simulation request the user</p>
to return a vector of dispersal values with length specified by the num_draws parameter</a></li>
<li><a href='#get_divergence_factor'><p>Allows the user to define the rate at which geographic clusters accumulate differentiation</p>
with each other.</a></li>
<li><a href='#get_divergence_matrix'><p>Returns the full divergence matrix for a given species (site x site).</p></a></li>
<li><a href='#get_geo_richness'><p>calculate the richness of a list of species over a given landscape</p></a></li>
<li><a href='#plot_landscape'><p>Plot the environment variable of a given landscape</p></a></li>
<li><a href='#plot_landscape_overview'><p>Plot the outline of a given landscape over time</p></a></li>
<li><a href='#plot_ranges'><p>Plot species ranges of the given list of species on a landscape</p></a></li>
<li><a href='#plot_raster_multiple'><p>Plot a set of values onto a given landscape</p></a></li>
<li><a href='#plot_raster_single'><p>Plot a single set of values onto a given landscape</p></a></li>
<li><a href='#plot_richness'><p>Plot the richness of the given list of species on a landscape</p></a></li>
<li><a href='#plot_species_abundance'><p>Plot a species' abundance on a given landscape</p></a></li>
<li><a href='#plot_species_presence'><p>Plot a species' presence on a given landscape</p></a></li>
<li><a href='#plot_summary'><p>Plot simulation default summary object</p></a></li>
<li><a href='#prepare_directories'><p>Checks if the necessary directories exist, and otherwise creates them</p></a></li>
<li><a href='#run_simulation'><p>Run a simulation in gen3sis and return a summary object possibly saving outputs and plots to the output folder</p></a></li>
<li><a href='#save_abundance'><p>This function can be called within the observer function to save the species abundances.</p></a></li>
<li><a href='#save_divergence'><p>This function can be called within the observer function to save the compressed species divergence.</p></a></li>
<li><a href='#save_landscape'><p>This function can be called within the observer function to save</p>
the current landscape, can be called independently by the user and is called by
other observer functions relying on the landscape to be present (e.g. save_species)</a></li>
<li><a href='#save_occupancy'><p>This function can be called within the observer function to save the current occupancy pattern</p></a></li>
<li><a href='#save_phylogeny'><p>This function can be called within the observer function to save the current phylogeny.</p></a></li>
<li><a href='#save_richness'><p>This function can be called within the observer function to save the current richness pattern</p></a></li>
<li><a href='#save_species'><p>This function can be called within the observer function to save the full species list.</p></a></li>
<li><a href='#save_traits'><p>This function can be called within the observer function to save the species traits.</p></a></li>
<li><a href='#skeleton_config'><p>empty skeleton config</p></a></li>
<li><a href='#verify_config'><p>Verifies if all required config fields are provided</p></a></li>
<li><a href='#write_config_skeleton'><p>Writes out a config skeleton</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>General Engine for Eco-Evolutionary Simulations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.11</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-21</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains an engine for spatially-explicit eco-evolutionary mechanistic models with a modular implementation and several support functions. It allows exploring the consequences of ecological and macroevolutionary processes across realistic or theoretical spatio-temporal landscapes on biodiversity patterns as a general term. Reference: Oskar Hagen, Benjamin Flueck, Fabian Fopp, Juliano S. Cabral, Florian Hartig, Mikael Pontarp, Thiago F. Rangel, Loic Pellissier (2021) "gen3sis: A general engine for eco-evolutionary simulations of the processes that shape Earth's biodiversity" &lt;<a href="https://doi.org/10.1371%2Fjournal.pbio.3001340">doi:10.1371/journal.pbio.3001340</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.16), Matrix, methods, utils, raster, gdistance,
stringr, tools, grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, markdown, testthat (&ge; 2.1.0), rmarkdown, formatR</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, BH</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/project-Gen3sis/R-package">https://github.com/project-Gen3sis/R-package</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/project-Gen3sis/R-package/issues">https://github.com/project-Gen3sis/R-package/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-21 13:40:32 UTC; benjamin</td>
</tr>
<tr>
<td>Author:</td>
<td>ETH Zürich [cph],
  Oskar Hagen [aut, cre] (Landscape Ecology, WSL and ETH Zürich,
    Switzerland),
  Benjamin Flück [aut] (Landscape Ecology, WSL and ETH Zürich,
    Switzerland),
  Fabian Fopp [aut] (Landscape Ecology, WSL and ETH Zürich, Switzerland),
  Juliano S. Cabral [aut] (Ecosystem Modeling, Center for Computational
    and Theoretical Biology, University of Würzburg, Würzburg, Germany),
  Florian Hartig [aut] (Theoretical Ecology, University of Regensburg,
    Regensburg, Germany),
  Mikael Pontarp [aut] (Department of Biology, Lund University, Lund,
    Sweden),
  Charles Novaes de Santana [ctb] (Landscape Ecology, WSL and ETH Zürich,
    Switzerland),
  Thiago F. Rangel [aut] (Department of Ecology, Universidade Federal de
    Goiás, Goiás, Brazil),
  Theo Gaboriau [ctb] (Depatment of Computational Biology, Lausanne
    University, Switzerland),
  Loïc Pellissier [aut, ths] (Landscape Ecology, WSL and ETH Zürich,
    Switzerland)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oskar Hagen &lt;oskar@hagen.bio&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-22 15:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='apply_ecology'>Allows the user to define the ecological consequences for species within each site,
defining thus species survival and abundance</h2><span id='topic+apply_ecology'></span>

<h3>Description</h3>

<p>Allows the user to define the ecological consequences for species within each site,
defining thus species survival and abundance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_ecology(abundance, traits, local_environment, config)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_ecology_+3A_abundance">abundance</code></td>
<td>
<p>a named vector of abundances with one abundance value per species</p>
</td></tr>
<tr><td><code id="apply_ecology_+3A_traits">traits</code></td>
<td>
<p>a named matrix containing the species traits, one row per species</p>
</td></tr>
<tr><td><code id="apply_ecology_+3A_local_environment">local_environment</code></td>
<td>
<p>the environmental values for the given site</p>
</td></tr>
<tr><td><code id="apply_ecology_+3A_config">config</code></td>
<td>
<p>the config of the simulation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments of the function allows to apply abiotic and biotic ecological rules to species in each 
site. Based on those rules, the function updates the abundance of each species in each site. If the abundance 
is null, the species is absent or extinct. Ecology can account for local environmental conditions, the abundance of
species, and/or their traits.
</p>


<h3>Value</h3>

<p>an abundance vector with the new abundance values for every species.
An abundance value of 0 indicates species death, any other values indicates survival.
</p>

<hr>
<h2 id='apply_evolution'>Allows defining the function that changes the values of traits of a given
species at each time-step and in each site. If no operations are provided, traits are not changing</h2><span id='topic+apply_evolution'></span>

<h3>Description</h3>

<p>Allows defining the function that changes the values of traits of a given
species at each time-step and in each site. If no operations are provided, traits are not changing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_evolution(species, cluster_indices, landscape, config)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_evolution_+3A_species">species</code></td>
<td>
<p>the target species object whose traits will be changed</p>
</td></tr>
<tr><td><code id="apply_evolution_+3A_cluster_indices">cluster_indices</code></td>
<td>
<p>an index vector indicating the cluster every occupied site is part of</p>
</td></tr>
<tr><td><code id="apply_evolution_+3A_landscape">landscape</code></td>
<td>
<p>the current landscape which can co-determine the rate of trait changes</p>
</td></tr>
<tr><td><code id="apply_evolution_+3A_config">config</code></td>
<td>
<p>the current config</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called for any single species alongside an index for
the geographical clusters within the species
</p>


<h3>Value</h3>

<p>the mutated species traits matrix
</p>

<hr>
<h2 id='color_richness'>Define gen3sis richness color scale which is colour-vision deficient and colour-blind people safe based on scientific colour maps by Fabio Crameri</h2><span id='topic+color_richness'></span>

<h3>Description</h3>

<p>Define gen3sis richness color scale which is colour-vision deficient and colour-blind people safe based on scientific colour maps by Fabio Crameri
</p>


<h3>Usage</h3>

<pre><code class='language-R'>color_richness(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color_richness_+3A_n">n</code></td>
<td>
<p>corresponds to the <a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a> parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a <a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a> function with the gen3sis richness colors
</p>

<hr>
<h2 id='color_richness_non_CVDCBP'>Define gen3sis richness color scale for non colour-vision deficient and colour-blind people</h2><span id='topic+color_richness_non_CVDCBP'></span>

<h3>Description</h3>

<p>Define gen3sis richness color scale for non colour-vision deficient and colour-blind people
</p>


<h3>Usage</h3>

<pre><code class='language-R'>color_richness_non_CVDCBP(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color_richness_non_CVDCBP_+3A_n">n</code></td>
<td>
<p>corresponds to the <a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a> parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a <a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a> function with the gen3sis richness colors
</p>

<hr>
<h2 id='create_ancestor_species'>Allows the user to populate the world at the beginning of a simulation</h2><span id='topic+create_ancestor_species'></span>

<h3>Description</h3>

<p>Allows the user to populate the world at the beginning of a simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_ancestor_species(landscape, config)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_ancestor_species_+3A_landscape">landscape</code></td>
<td>
<p>the landscape over which to create the species</p>
</td></tr>
<tr><td><code id="create_ancestor_species_+3A_config">config</code></td>
<td>
<p>the configuration information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using this function, any number of new species can be created. For every species, a number of
habitable sites from the landscape are selected and call 'create_species'. In another step, the user must initialize 
the species[[&quot;traits&quot;]] matrix with the desired initial traits values
</p>


<h3>Value</h3>

<p>a list of species
</p>

<hr>
<h2 id='create_input_config'>Creates either an empty configuration or a pre-filled configuration object from a config file</h2><span id='topic+create_input_config'></span>

<h3>Description</h3>

<p>Creates either an empty configuration or a pre-filled configuration object from a config file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_input_config(config_file = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_input_config_+3A_config_file">config_file</code></td>
<td>
<p>the path to a valid configuration file. if NA it creates an empty config</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of configuration elements, similar generated from reading a config_file.R. The internal elements 
of this list are: &quot;general&quot;, &quot;initialization&quot;, &quot;dispersal&quot;, &quot;speciation&quot;, &quot;mutation&quot; and &quot;ecology&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create empty config object
config_empty &lt;- create_input_config(config_file = NA)

# create a config object from config_file
# get path to example config
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package = "gen3sis")
path_config &lt;- file.path(datapath, "config/config_worldcenter.R")
config_object &lt;- create_input_config(config_file = path_config)

# change seed of config_worldcenter config object
config_object$gen3sis$general$random_seed &lt;- 2020

# run the model for config_object

  sim &lt;- run_simulation(config = config_object, 
                        landscape = file.path(datapath, "landscape"), 
                        output_directory = tempdir())

</code></pre>

<hr>
<h2 id='create_input_landscape'>create an landscape input from a named list of rasters or raster files</h2><span id='topic+create_input_landscape'></span>

<h3>Description</h3>

<p>create an landscape input from a named list of rasters or raster files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_input_landscape(
  landscapes,
  cost_function,
  directions,
  output_directory,
  timesteps = NULL,
  calculate_full_distance_matrices = FALSE,
  crs = NULL,
  overwrite_output = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_input_landscape_+3A_landscapes">landscapes</code></td>
<td>
<p>list of named list(s) of raster(s) or raster file(s) name(s). Starting from the present towards the past.
NOTE: the list names are important since these are the environmental names</p>
</td></tr>
<tr><td><code id="create_input_landscape_+3A_cost_function">cost_function</code></td>
<td>
<p>function that returns a cost value between a pair of sites (neighbors) that should have the following signature:
<code>cost_function &lt;- 
 function(src, src_habitable, dest, dest_habitable){
 rules for environmental factors to be considered (e.g. elevation)
 return(cost value)
}</code>
where: **src** is a vector of environmental conditions for the origin sites, 
**src_habitable** (TRUE or FALSE) for habitable condition of the origin sites, 
**dest** is a vector of environmental conditions for the destination site, dest_habitable  (TRUE or FALSE) for habitable condition of the destination cell</p>
</td></tr>
<tr><td><code id="create_input_landscape_+3A_directions">directions</code></td>
<td>
<p>4, 8 or 16 neighbors, dictates the connection of cell neighbors on adjacency matrix (see gistance package)</p>
</td></tr>
<tr><td><code id="create_input_landscape_+3A_output_directory">output_directory</code></td>
<td>
<p>path for storing the gen3sis ready landscape (i.e. landscape.rds, metadata.txt and full- and/or local_distance folders)</p>
</td></tr>
<tr><td><code id="create_input_landscape_+3A_timesteps">timesteps</code></td>
<td>
<p>vector of names for every time-step to represent the time-step at gen3sis ready landscape. 
If timesteps=NULL (default), time-steps are sequentially numbered from 0 to the latest time-step.</p>
</td></tr>
<tr><td><code id="create_input_landscape_+3A_calculate_full_distance_matrices">calculate_full_distance_matrices</code></td>
<td>
<p>should a full distance matrix be calculated? TRUE or FALSE? 
If TRUE calculates the entire distance matrix for every time-step and between all habitable cells 
(faster CPU time, higher storage required). 
If FALSE (default), only local distances are calculated (slower CPU time when simulating but smaller gen3sis landscape size)</p>
</td></tr>
<tr><td><code id="create_input_landscape_+3A_crs">crs</code></td>
<td>
<p>the coordinate reference system in crs format (see raster::crs)</p>
</td></tr>
<tr><td><code id="create_input_landscape_+3A_overwrite_output">overwrite_output</code></td>
<td>
<p>TRUE or FALSE</p>
</td></tr>
<tr><td><code id="create_input_landscape_+3A_verbose">verbose</code></td>
<td>
<p>print distance calculation progress (default: FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates the input landscapes files needed by the run_simulation function. 
It uses as input the dynamic landscape rasters and user defined geodesimal corrections as well as rules to define the connection costs between sites
</p>


<h3>Value</h3>

<p>no return object. This function saves the landscape input files for gen3sis at the output_directory
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_simulation">run_simulation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load needed library
library(raster)

# get path containing example rasters
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package="gen3sis")

# create raster bricks
temperature_brick &lt;- brick(file.path(datapath, "input_rasters/temp_rasters.grd"))
aridity_brick &lt;-  brick(file.path(datapath, "input_rasters/arid_rasters.grd"))
area_brick &lt;-  brick(file.path(datapath, "input_rasters/area_rasters.grd"))

# create sub-list of environmental variables for fast example 
# (i.e. 4 time-steps)
landscapes_sub_list &lt;- list(temp=NULL, arid=NULL, area=NULL)
for(i in 1:4){
  landscapes_sub_list$temp &lt;- c(landscapes_sub_list$temp, temperature_brick[[i]])
  landscapes_sub_list$arid &lt;- c(landscapes_sub_list$arid, aridity_brick[[i]])
  landscapes_sub_list$area &lt;- c(landscapes_sub_list$area, area_brick[[i]])
}

# define cost function, crossing water as double as land sites
cost_function_water &lt;- function(source, habitable_src, dest, habitable_dest) {
  if(!all(habitable_src, habitable_dest)) {
    return(2/1000)
  } else {
    return(1/1000)
  }
}

## Not run: 
# create input landscape ready for gen3sis from sub-list 
# (i.e. 10 time-steps) and only local-distances.
create_input_landscape(
  landscapes = landscapes_sub_list,
  cost_function = cost_function_water,
  output_directory = file.path(tempdir(), "landscape_sub"),
  directions = 8, # surrounding sites for each site
  timesteps = paste0(round(150:147,2), "Ma"),
  calculate_full_distance_matrices = FALSE) # full distance matrix


# create list of all environmental variables available
landscapes_list &lt;- list(temp=NULL, arid=NULL, area=NULL)
for(i in 1:nlayers(temperature_brick)){
  landscapes_list$temp &lt;- c(landscapes_list$temp, temperature_brick[[i]])
  landscapes_list$arid &lt;- c(landscapes_list$arid, aridity_brick[[i]])
  landscapes_list$area &lt;- c(landscapes_list$area, area_brick[[i]])
}

# create input landscape ready for gen3sis (~ 3min run-time)
# and full distance matrix
create_input_landscape(
  landscapes = landscapes_list,
  cost_function = cost_function_water,
  output_directory = file.path(tempdir(), "landscape_WorldCenter_5"),
  directions = 8, # surrounding sites for each site
  timesteps = paste0(round(150:100,2), "Ma"),
  crs="+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0",
  calculate_full_distance_matrices = FALSE) # full distance matrix

## End(Not run)
</code></pre>

<hr>
<h2 id='create_species'>Creates a new species</h2><span id='topic+create_species'></span>

<h3>Description</h3>

<p>Creates a new species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_species(initial_cells, config)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_species_+3A_initial_cells">initial_cells</code></td>
<td>
<p>a list of initial sites (strings) to occupy</p>
</td></tr>
<tr><td><code id="create_species_+3A_config">config</code></td>
<td>
<p>the configuration information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is to be used in the create_ancestor_species function at the configuration 
of a simulation. It will create a species object representing one species in the simulation occupying the 
given list of initial sites
</p>


<h3>Value</h3>

<p>returns a newly created species occupying the provided initial cells
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# inside a create_ancestor_species function of a config taking a landscape and a config
# create_species creates a new species

# define range of species for the entire world in this case lat long system
range &lt;- c(-180, 180, -90, 90)

## select coordinates within the range stipulated above
# takes landscape coordinates
co &lt;- landscape$coordinates
# select coordinates within the range
selection &lt;- co[, "x"] &gt;= range[1] &amp;
  co[, "x"] &lt;= range[2] &amp;
  co[, "y"] &gt;= range[3] &amp;
  co[, "y"] &lt;= range[4]
# get the initial cells
initial_cells &lt;- rownames(co)[selection]

# call create_species
new_species &lt;- create_species(initial_cells, config)

# extra: set local adaptation to max optimal temp equals local temp
new_species$traits[ , "temp"] &lt;- landscape$environment[,"temp"]

# extra: set a certaintrait (e.g. traitX) to one on all populations of this species
new_species$traits[ , "tratiX"] &lt;- 1
  

## End(Not run)
</code></pre>

<hr>
<h2 id='evolution_mode_none'>No evolution considered</h2><span id='topic+evolution_mode_none'></span>

<h3>Description</h3>

<p>No evolution considered
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolution_mode_none(species, cluster_indices, landscape, config)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evolution_mode_none_+3A_species">species</code></td>
<td>
<p>the current species</p>
</td></tr>
<tr><td><code id="evolution_mode_none_+3A_cluster_indices">cluster_indices</code></td>
<td>
<p>indices to assign cells to geographic clusters</p>
</td></tr>
<tr><td><code id="evolution_mode_none_+3A_landscape">landscape</code></td>
<td>
<p>the current landscape</p>
</td></tr>
<tr><td><code id="evolution_mode_none_+3A_config">config</code></td>
<td>
<p>the general config</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an invisible empty species traits when no evolution is considered
</p>

<hr>
<h2 id='gen3sis'>gen3sis: General Engine for Eco-Evolutionary Simulations</h2><span id='topic+gen3sis'></span>

<h3>Description</h3>

<p>Contains an engine for spatially-explicit eco-evolutionary mechanistic models with a modular implementation and several support functions. It allows exploring the consequences of ecological and macroevolutionary processes across realistic or theoretical spatio-temporal landscapes on biodiversity patterns as a general term.
</p>


<h3>Details</h3>

<p>Gen3sis is implemented in a mix of R and C++ code, and wrapped into an R-package. All high-level functions that the user may interact with are written in R, and are documented via the standard R / Roxygen help files for R-packages. Runtime-critical functions are implemented in C++ and coupled to R via the Rcpp framework. Additionally, the package provides several convenience functions to generate input data, configuration files and plots, as well as tutorials in the form of vignettes that illustrate how to declare models and run simulations.
</p>


<h3>References</h3>

<p>O. Hagen, B. Flück, F. Fopp, J.S. Cabral, F. Hartig, M. Pontarp, T.F. Rangel, L. Pellissier. (2021). gen3sis: A general engine for eco-evolutionary simulations of the processes that shape Earth’s biodiversity. PLoS biology
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_input_config">create_input_config</a></code>   <code><a href="#topic+create_input_landscape">create_input_landscape</a></code>  <code><a href="#topic+run_simulation">run_simulation</a></code>  <code><a href="#topic+plot_summary">plot_summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# 1. Load gen3sis and all necessary input data is set (landscape and config).

library(gen3sis)

# get path to example input inside package
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package = "gen3sis")
path_config &lt;- file.path(datapath, "config/config_worldcenter.R")
path_landscape &lt;- file.path(datapath, "landscape")

# 2. Run simulation

sim &lt;- run_simulation(config = path_config, landscape = path_landscape)

# 3. Visualize the outputs

# plot summary of entire simulation
plot_summary(sim)

# plot richness at a given time-step 
# this only works if species is saved for this time-step
landscape_t_150 &lt;- readRDS(file.path(datapath, 
"output", "config_worldcenter", "landscapes", "landscape_t_150.rds"))   
species_t_150 &lt;- readRDS(file.path(datapath, 
"output", "config_worldcenter", "species", "species_t_150.rds"))   
plot_richness(species_t_150, landscape_t_150)   


## End(Not run)
</code></pre>

<hr>
<h2 id='get_dispersal_values'>Allows the user to generate dispersal value(s) for a given species. The simulation request the user 
to return a vector of dispersal values with length specified by the num_draws parameter</h2><span id='topic+get_dispersal_values'></span>

<h3>Description</h3>

<p>Allows the user to generate dispersal value(s) for a given species. The simulation request the user 
to return a vector of dispersal values with length specified by the num_draws parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dispersal_values(num_draws, species, landscape, config)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dispersal_values_+3A_num_draws">num_draws</code></td>
<td>
<p>the number of dispersal values drawn</p>
</td></tr>
<tr><td><code id="get_dispersal_values_+3A_species">species</code></td>
<td>
<p>the species for which the values are to be produced</p>
</td></tr>
<tr><td><code id="get_dispersal_values_+3A_landscape">landscape</code></td>
<td>
<p>the landscape of the current time step</p>
</td></tr>
<tr><td><code id="get_dispersal_values_+3A_config">config</code></td>
<td>
<p>the config of the simulation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dispersal values are used for two different operations. 
First, for colonization, dispersal values are used to evaluate pairwise dispersal
events between colonized and uninhabited sites. 
Second, for geographic clustering, dispersal values are used during the clustering of
species populations when determining which sites 
are in range of each other and belong to the same geographic cluster.
</p>
<p>num_draws tells the user how many dispersal values are requested by the simulation when this function is called and must 
be returned. It can be of varying length depending on the operation calling it, i.e. colonization or geographic clustering. 
If the dispersal is considered as fixed the function should return a vector of length num_draws with repeated identical
values, or varying values in case of more complex dispersal kernels.
</p>
<p>Note: if the distances are randomized the cluster formation may be asymmetrical. Therefore the ordering of all
clustering operations is randomized.
</p>


<h3>Value</h3>

<p>a numerical vector of length num_draws with dispersal values
</p>

<hr>
<h2 id='get_divergence_factor'>Allows the user to define the rate at which geographic clusters accumulate differentiation
with each other.</h2><span id='topic+get_divergence_factor'></span>

<h3>Description</h3>

<p>Allows the user to define the rate at which geographic clusters accumulate differentiation
with each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_divergence_factor(species, cluster_indices, landscape, config)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_divergence_factor_+3A_species">species</code></td>
<td>
<p>the species of the current time step</p>
</td></tr>
<tr><td><code id="get_divergence_factor_+3A_cluster_indices">cluster_indices</code></td>
<td>
<p>an index vector indicating the cluster every occupied site is part of</p>
</td></tr>
<tr><td><code id="get_divergence_factor_+3A_landscape">landscape</code></td>
<td>
<p>the landscape of the current time step</p>
</td></tr>
<tr><td><code id="get_divergence_factor_+3A_config">config</code></td>
<td>
<p>the config of the simulation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function determines the increase in divergence between separated clusters of a species. This function
should return either (i) a single value if there is an homogeneous divergence, or (ii) a matrix indicating the divergence that
should be accumulated between specific pairwise geographic clusters.
</p>
<p>The function can either return a single value or a full cluster by cluster matrix. If only one value is returned it will be used 
to increment divergence between any given distinct cluster pairs. If a matrix is returned it has to be in the dimension of
cluster x cluster, in which case the divergence values will be increased according to the cluster membership of any cell pairs.
</p>
<p>For every time step, the divergence between geographic clusters can increase by a defined number. The divergence values can be 
scaled optionally using the species or landscape information. For instance, the divergence between clusters could be higher under
warmer temperature, or difference in ecological traits could promote faster divergence between clusters.
</p>
<p>Oppositely, for every time-step, if cluster are merged their divergence is reduced by one (1).
</p>


<h3>Value</h3>

<p>a single value or a matrix of divergences between all clusters occurring in clusters_indices
</p>

<hr>
<h2 id='get_divergence_matrix'>Returns the full divergence matrix for a given species (site x site).</h2><span id='topic+get_divergence_matrix'></span>

<h3>Description</h3>

<p>Returns the full divergence matrix for a given species (site x site).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_divergence_matrix(species)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_divergence_matrix_+3A_species">species</code></td>
<td>
<p>the species for which the divergence matrix should be produced</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions allows to extract the full divergence matrix representing the accumulated differentiation
between all the sites that are occupied by the species. The input is a species object for any time step.
</p>


<h3>Value</h3>

<p>the full decompressed divergence matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get path containing example rasters
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package="gen3sis")
# get species at t0
species_t_0 &lt;- readRDS(file.path(datapath, "output/config_worldcenter/species/species_t_0.rds"))
# get divergence matrix from species 1
divergence_sp1_t0 &lt;- get_divergence_matrix(species_t_0[[1]])
# get divergence matrix from species 12
divergence_sp12_t0 &lt;- get_divergence_matrix(species_t_0[[12]])
# note that species 1 has no divergence between it's populations, while 12 has.
</code></pre>

<hr>
<h2 id='get_geo_richness'>calculate the richness of a list of species over a given landscape</h2><span id='topic+get_geo_richness'></span>

<h3>Description</h3>

<p>calculate the richness of a list of species over a given landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_geo_richness(species_list, landscape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_geo_richness_+3A_species_list">species_list</code></td>
<td>
<p>a list of species to include in the richness calculations</p>
</td></tr>
<tr><td><code id="get_geo_richness_+3A_landscape">landscape</code></td>
<td>
<p>the landscape to calculate the richnness over</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with the richness for every cell in the input landscape
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_richness">plot_richness</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get path containing example rasters
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package="gen3sis")
# get species at t0
species_t_0 &lt;- readRDS(file.path(datapath, 
                        "output/config_worldcenter/species/species_t_0.rds"))
# get landscape at t0
landscape_t_0 &lt;- readRDS(file.path(datapath, 
                          "output/config_worldcenter/landscapes/landscape_t_0.rds"))
# get geo richness
richness_t_0 &lt;- get_geo_richness(species_t_0, landscape_t_0)

# histogram of richness at t0
hist(richness_t_0)

## plot richness using raster and gen3sis color_richness (see plot_richness for alternative)
# combine richness and geographical coordinates
geo_richness_t_0 &lt;- cbind(landscape_t_0$coordinates, richness_t_0)
library(raster)
plot(rasterFromXYZ(geo_richness_t_0), col=color_richness(20))
</code></pre>

<hr>
<h2 id='plot_landscape'>Plot the environment variable of a given landscape</h2><span id='topic+plot_landscape'></span>

<h3>Description</h3>

<p>Plot the environment variable of a given landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_landscape(landscape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_landscape_+3A_landscape">landscape</code></td>
<td>
<p>the landscape to plot the environment from</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>

<hr>
<h2 id='plot_landscape_overview'>Plot the outline of a given landscape over time</h2><span id='topic+plot_landscape_overview'></span>

<h3>Description</h3>

<p>Plot the outline of a given landscape over time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_landscape_overview(landscape, slices = 2, start_end_times = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_landscape_overview_+3A_landscape">landscape</code></td>
<td>
<p>the input landscape to be plotted</p>
</td></tr>
<tr><td><code id="plot_landscape_overview_+3A_slices">slices</code></td>
<td>
<p>the amount of slices though time between start and end (default value is 2).</p>
</td></tr>
<tr><td><code id="plot_landscape_overview_+3A_start_end_times">start_end_times</code></td>
<td>
<p>the stating and ending times of the simulation (default is NULL, takes the oldest and most recent available)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>

<hr>
<h2 id='plot_ranges'>Plot species ranges of the given list of species on a landscape</h2><span id='topic+plot_ranges'></span>

<h3>Description</h3>

<p>Plot species ranges of the given list of species on a landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ranges(species_list, landscape, disturb = 0, max_sps = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_ranges_+3A_species_list">species_list</code></td>
<td>
<p>a list of species to use in the richness calculation</p>
</td></tr>
<tr><td><code id="plot_ranges_+3A_landscape">landscape</code></td>
<td>
<p>a corresponding landscape object</p>
</td></tr>
<tr><td><code id="plot_ranges_+3A_disturb">disturb</code></td>
<td>
<p>value randomly added to shift each species symbol. Useful to enhance visualization in case of multiple species overlaps</p>
</td></tr>
<tr><td><code id="plot_ranges_+3A_max_sps">max_sps</code></td>
<td>
<p>maximum number of plotted species, not recommended above 20</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## plot from saved outputs
# get path containing outputs
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package="gen3sis")
# get species at t0
species_t_50 &lt;- readRDS(file.path(datapath,
                        "output/config_worldcenter/species/species_t_50.rds"))
# get landscape at t0
landscape_t_50 &lt;- readRDS(file.path(datapath,
                          "output/config_worldcenter/landscapes/landscape_t_50.rds"))
# plot range
plot_ranges(species_t_50, landscape_t_50)

# get species at t0
species_t_25 &lt;- readRDS(file.path(datapath, 
                        "output/config_worldcenter/species/species_t_25.rds"))
# get landscape at t0
landscape_t_25 &lt;- readRDS(file.path(datapath, 
                        "output/config_worldcenter/landscapes/landscape_t_25.rds"))
# plot ranges at intermediate time-step
plot_ranges(species_t_25, landscape_t_25, disturb = 2, max_sps = 20)

## plot from within observer
# call plot_richness from inside the end_of_timestep_observer function 
# at the config file:
## Not run: 
plot_ranges(data$all_species, data$landscape)

## End(Not run) 
</code></pre>

<hr>
<h2 id='plot_raster_multiple'>Plot a set of values onto a given landscape</h2><span id='topic+plot_raster_multiple'></span>

<h3>Description</h3>

<p>Plot a set of values onto a given landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_raster_multiple(values, landscape, no_data = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_raster_multiple_+3A_values">values</code></td>
<td>
<p>a matrix of values with columns corresponding to sets of values, and rows corresponding to grid cells,
this will result in ncol(values) raster plots.</p>
</td></tr>
<tr><td><code id="plot_raster_multiple_+3A_landscape">landscape</code></td>
<td>
<p>a landscape to plot the values onto</p>
</td></tr>
<tr><td><code id="plot_raster_multiple_+3A_no_data">no_data</code></td>
<td>
<p>what value should be used for missing data present in the values parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>

<hr>
<h2 id='plot_raster_single'>Plot a single set of values onto a given landscape</h2><span id='topic+plot_raster_single'></span>

<h3>Description</h3>

<p>Plot a single set of values onto a given landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_raster_single(values, landscape, title, no_data = 0, col, legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_raster_single_+3A_values">values</code></td>
<td>
<p>a named list of values, the names must correspond to cells in the landscape</p>
</td></tr>
<tr><td><code id="plot_raster_single_+3A_landscape">landscape</code></td>
<td>
<p>a landscape to plot the values onto</p>
</td></tr>
<tr><td><code id="plot_raster_single_+3A_title">title</code></td>
<td>
<p>a title string for resulting plot, the time information will be taken and appended from the landscape id</p>
</td></tr>
<tr><td><code id="plot_raster_single_+3A_no_data">no_data</code></td>
<td>
<p>what value should be used for missing values in values</p>
</td></tr>
<tr><td><code id="plot_raster_single_+3A_col">col</code></td>
<td>
<p>corresponds to the <a href="raster.html#topic+raster">raster</a> col plot parameter. This can be omitted and colors are handled by raster::plot</p>
</td></tr>
<tr><td><code id="plot_raster_single_+3A_legend">legend</code></td>
<td>
<p>corresponds to the <a href="raster.html#topic+raster">raster</a> legend plot parameter. This can be omitted and legend is handled by raster::plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get path to output objects
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package = "gen3sis")

# plot environmental variables at a given step
landscape_t_25 &lt;- readRDS(
  file.path(datapath, "output", "config_worldcenter", "landscapes", "landscape_t_25.rds"))
oldpar &lt;- par(no.readonly = TRUE)
par(mfrow=c(1,2))
plot_raster_single(landscape_t_25$environment[,"temp"], landscape_t_25, "Temperature", NA)
# use col to change the color
plot_raster_single(landscape_t_25$environment[,"arid"], landscape_t_25, "Aridity", NA, 
                   col=topo.colors(5))
par(oldpar)
# note that these values were scaled by the configuration object
</code></pre>

<hr>
<h2 id='plot_richness'>Plot the richness of the given list of species on a landscape</h2><span id='topic+plot_richness'></span>

<h3>Description</h3>

<p>Plot the richness of the given list of species on a landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_richness(species_list, landscape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_richness_+3A_species_list">species_list</code></td>
<td>
<p>a list of species to use in the richness calculation</p>
</td></tr>
<tr><td><code id="plot_richness_+3A_landscape">landscape</code></td>
<td>
<p>a corresponding landscape object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## plot from saved outputs
# get path containing example rasters
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package="gen3sis")
# get species at t0
species_t_0 &lt;- readRDS(file.path(datapath, 
                        "output/config_worldcenter/species/species_t_0.rds"))
# get landscape at t0
landscape_t_0 &lt;- readRDS(file.path(datapath, 
                          "output/config_worldcenter/landscapes/landscape_t_0.rds"))
# plot richness
plot_richness(species_t_0, landscape_t_0)


## plot from within observer
# call plot_richness from inside the end_of_timestep_observer function 
# at the config file:
## Not run: 
plot_richness(data$all_species, data$landscape)

## End(Not run) 
</code></pre>

<hr>
<h2 id='plot_species_abundance'>Plot a species' abundance on a given landscape</h2><span id='topic+plot_species_abundance'></span>

<h3>Description</h3>

<p>Plot a species' abundance on a given landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_species_abundance(species, landscape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_species_abundance_+3A_species">species</code></td>
<td>
<p>a single species object</p>
</td></tr>
<tr><td><code id="plot_species_abundance_+3A_landscape">landscape</code></td>
<td>
<p>a landscape object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get path to output objects
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package = "gen3sis")

# load landscape and species at time step zero
landscape_t_0 &lt;- readRDS(
  file.path(datapath, "output/config_worldcenter", "landscapes", "landscape_t_0.rds"))
species_t_0 &lt;- readRDS(
  file.path(datapath, "output/config_worldcenter", "species", "species_t_0.rds"))

# plot species 13 range and abundances
plot_species_abundance(species_t_0[[13]], landscape_t_0)
# oh, a South American one!

# plot ranges and abundances of 3 species (i.e. 1, 21 and 32)
oldpar &lt;- par(no.readonly = TRUE)
par(mfrow=c(1,3))
plot_species_abundance(species_t_0[[1]], landscape_t_0)
plot_species_abundance(species_t_0[[7]], landscape_t_0)
plot_species_abundance(species_t_0[[11]], landscape_t_0)
par(oldpar)
</code></pre>

<hr>
<h2 id='plot_species_presence'>Plot a species' presence on a given landscape</h2><span id='topic+plot_species_presence'></span>

<h3>Description</h3>

<p>Plot a species' presence on a given landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_species_presence(species, landscape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_species_presence_+3A_species">species</code></td>
<td>
<p>a single species object</p>
</td></tr>
<tr><td><code id="plot_species_presence_+3A_landscape">landscape</code></td>
<td>
<p>a landscape object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get path to output objects
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package = "gen3sis")

# load landscape and species at time step zero
landscape_t_0 &lt;- readRDS(
  file.path(datapath, "output/config_worldcenter", "landscapes", "landscape_t_0.rds"))
species_t_0 &lt;- readRDS(
  file.path(datapath, "output/config_worldcenter", "species", "species_t_0.rds"))

# plot species 13 range
plot_species_presence(species_t_0[[13]], landscape_t_0)
# oh, a South American one!

# plot ranges of 3 species (i.e. 1, 21 and 32)
oldpar &lt;- par(no.readonly = TRUE)
par(mfrow=c(1,3))
plot_species_presence(species_t_0[[1]], landscape_t_0)
plot_species_presence(species_t_0[[7]], landscape_t_0)
plot_species_presence(species_t_0[[11]], landscape_t_0)
par(oldpar)
</code></pre>

<hr>
<h2 id='plot_summary'>Plot simulation default summary object</h2><span id='topic+plot_summary'></span>

<h3>Description</h3>

<p>Plot simulation default summary object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_summary(output, summary_title = NULL, summary_legend = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_summary_+3A_output">output</code></td>
<td>
<p>a sgen3sis output object resulting from a gen3sis simulation (i.e. run_simulation)</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_summary_title">summary_title</code></td>
<td>
<p>summary plot title as character. If NULL, title is computed from input name.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_summary_legend">summary_legend</code></td>
<td>
<p>either a string using \n for new lines or NULL. If NULL, provides default summary and simulation information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for plot
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_simulation">run_simulation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load existing summary example
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package = "gen3sis")
output &lt;- readRDS(file.path(datapath, "output/config_worldcenter/sgen3sis.rds"))
# plot output summary
plot_summary(output)

plot_summary(output, summary_title="Example")


## run simulation and plot summary
# get path or correct input objects
datapath &lt;- system.file(file.path("extdata", "CaseStudy1"), package="gen3sis")
# run simulation and store summary object to output
output &lt;- run_simulation(config = file.path(datapath,"config/config_fast.R"), 
                      landscape = file.path(datapath,"landscape"),
                      output_directory = tempdir())
# plot output summary
plot_summary(output)

</code></pre>

<hr>
<h2 id='prepare_directories'>Checks if the necessary directories exist, and otherwise creates them</h2><span id='topic+prepare_directories'></span>

<h3>Description</h3>

<p>Checks if the necessary directories exist, and otherwise creates them
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_directories(
  config_file = NA,
  input_directory = NA,
  output_directory = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare_directories_+3A_config_file">config_file</code></td>
<td>
<p>path to the config file, if NA the default config will be used</p>
</td></tr>
<tr><td><code id="prepare_directories_+3A_input_directory">input_directory</code></td>
<td>
<p>path to input directory, if NA it will be derived from the config file path</p>
</td></tr>
<tr><td><code id="prepare_directories_+3A_output_directory">output_directory</code></td>
<td>
<p>path to output directory, if NA it will be derived from the config file path</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will be called by the simulation, but is made available if the directories should be created
manually beforehand, for example to redirect the stdout to a file in the output directory.
</p>


<h3>Value</h3>

<p>returns a named list with the paths for the input and output directories
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  # this is an internal function used to attribute directories by deduction
  # called at the start of a simulation run
  datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package = "gen3sis")
  # deducing input directory and setting output directory
  prepare_directories(config_file = file.path(datapath, "config/config_worldcenter.R"))
  # setting output directory
  prepare_directories(config_file = file.path(datapath, "config/config_worldcenter.R"), 
                      input_directory = file.path(datapath, "landscape"))

## End(Not run)
</code></pre>

<hr>
<h2 id='run_simulation'>Run a simulation in gen3sis and return a summary object possibly saving outputs and plots to the output folder</h2><span id='topic+run_simulation'></span>

<h3>Description</h3>

<p>Run a simulation in gen3sis and return a summary object possibly saving outputs and plots to the output folder
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_simulation(
  config = NA,
  landscape = NA,
  output_directory = NA,
  timestep_restart = NA,
  save_state = NA,
  call_observer = "all",
  enable_gc = FALSE,
  verbose = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_simulation_+3A_config">config</code></td>
<td>
<p>configuration file for the simulation or configuration object derived from a config file</p>
</td></tr>
<tr><td><code id="run_simulation_+3A_landscape">landscape</code></td>
<td>
<p>directory where the all_geo_hab and distance_matrices reside</p>
</td></tr>
<tr><td><code id="run_simulation_+3A_output_directory">output_directory</code></td>
<td>
<p>directory for the simulation output</p>
</td></tr>
<tr><td><code id="run_simulation_+3A_timestep_restart">timestep_restart</code></td>
<td>
<p>set the start time time-step. 
If timestep_restart=NA (default), start at the oldest available landscape. 
If timestep_restart=&quot;ti&quot;, start from the last available time-step. 
If a number &quot;x&quot;, start at time-step x (e.g. timestep_restartstart=6)</p>
</td></tr>
<tr><td><code id="run_simulation_+3A_save_state">save_state</code></td>
<td>
<p>save the internal state of the simulation for restarts.
If save_state=NA (default), do not save any internal state of the simulation.
If save_state=&quot;all&quot;, save all time-step. 
If save_state=&quot;last&quot;, saves only last time-step.
If a vector, saves the desired time-steps (e.g. save_state=c(1,3,5))</p>
</td></tr>
<tr><td><code id="run_simulation_+3A_call_observer">call_observer</code></td>
<td>
<p>call observer functions.
If call_observer=&quot;all&quot; (default), call all time-steps.
If call_observer=NA, calls the start and end times.
If a number &quot;X&quot;, call call_observer at x time-steps equally spaced between start and end steps. 
For example, on a simulation with start time of 1 and end time of 20, call_observer=1 calls the observer function at time-steps 1, 11 and 20.</p>
</td></tr>
<tr><td><code id="run_simulation_+3A_enable_gc">enable_gc</code></td>
<td>
<p>enable gc in case of memory shortages</p>
</td></tr>
<tr><td><code id="run_simulation_+3A_verbose">verbose</code></td>
<td>
<p>integer value (i.e. 0, 1 ,2 or 3). 
If verbose=0, no printed statement.
If verbose=1 (default), print time-step progress.
If verbose=2, enable additional progress outputs regarding current time-step.
If verbose=3, enable additional information from within modules</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs a simulation with defined landscape and config objects. 
Possibly plot and save specified outputs as defined in the end_of_timestep_observer function inside the config object
</p>


<h3>Value</h3>

<p>a summary object containing a minimal summary on simulation and dynamics progress (alive, speciations, extinctions) as well as useful simulation data
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_summary">plot_summary</a></code>   <code><a href="#topic+create_input_config">create_input_config</a></code>   <code><a href="#topic+create_input_landscape">create_input_landscape</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get path or correct input objects
datapath &lt;- system.file(file.path("extdata", "CaseStudy1"), package="gen3sis")

# run simulation and store summary obejct to sim
sim &lt;- run_simulation(config = file.path(datapath,"config/config_fast.R"), 
                landscape = file.path(datapath,"landscape"),
                output_directory = tempdir())

# plot summary object
plot_summary(sim)

</code></pre>

<hr>
<h2 id='save_abundance'>This function can be called within the observer function to save the species abundances.</h2><span id='topic+save_abundance'></span>

<h3>Description</h3>

<p>This function can be called within the observer function to save the species abundances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_abundance()
</code></pre>


<h3>Value</h3>

<p>no return value, called for side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+save_species">save_species</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## save abundances from within observer
  # this functions should be called inside the end_of_timestep_observer function at the config file:
  save_abundance()

## End(Not run)
</code></pre>

<hr>
<h2 id='save_divergence'>This function can be called within the observer function to save the compressed species divergence.</h2><span id='topic+save_divergence'></span>

<h3>Description</h3>

<p>This function can be called within the observer function to save the compressed species divergence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_divergence()
</code></pre>


<h3>Value</h3>

<p>no return value, called for side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+save_species">save_species</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## save divergences from within observer for each species
  # this functions should be called inside the end_of_timestep_observer function at the config file:
  save_divergence()

## End(Not run)
</code></pre>

<hr>
<h2 id='save_landscape'>This function can be called within the observer function to save 
the current landscape, can be called independently by the user and is called by 
other observer functions relying on the landscape to be present (e.g. save_species)</h2><span id='topic+save_landscape'></span>

<h3>Description</h3>

<p>This function can be called within the observer function to save 
the current landscape, can be called independently by the user and is called by 
other observer functions relying on the landscape to be present (e.g. save_species)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_landscape()
</code></pre>


<h3>Value</h3>

<p>no return value, called for side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+save_species">save_species</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## save landscape from within observer for each species
  # this functions should be called inside the end_of_timestep_observer function at the config file:
  save_landscape()

## End(Not run)
</code></pre>

<hr>
<h2 id='save_occupancy'>This function can be called within the observer function to save the current occupancy pattern</h2><span id='topic+save_occupancy'></span>

<h3>Description</h3>

<p>This function can be called within the observer function to save the current occupancy pattern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_occupancy()
</code></pre>


<h3>Value</h3>

<p>no return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## save occupancies from within observer
  # this functions should be called inside the end_of_timestep_observer function at the config file:
  save_occupancy()

## End(Not run)
</code></pre>

<hr>
<h2 id='save_phylogeny'>This function can be called within the observer function to save the current phylogeny.</h2><span id='topic+save_phylogeny'></span>

<h3>Description</h3>

<p>This function can be called within the observer function to save the current phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_phylogeny()
</code></pre>


<h3>Value</h3>

<p>no return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## save phylogeny as a nexus tree from within observer for each species
  # this functions should be called inside the end_of_timestep_observer function at the config file:
  save_phylogeny()

## End(Not run)
</code></pre>

<hr>
<h2 id='save_richness'>This function can be called within the observer function to save the current richness pattern</h2><span id='topic+save_richness'></span>

<h3>Description</h3>

<p>This function can be called within the observer function to save the current richness pattern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_richness()
</code></pre>


<h3>Value</h3>

<p>no return value, called for side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+save_species">save_species</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## save the current richness pattern from within observer for each species
  # this functions should be called inside the end_of_timestep_observer function at the config file:
  save_richness()

## End(Not run)
</code></pre>

<hr>
<h2 id='save_species'>This function can be called within the observer function to save the full species list.</h2><span id='topic+save_species'></span>

<h3>Description</h3>

<p>This function can be called within the observer function to save the full species list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_species()
</code></pre>


<h3>Value</h3>

<p>no return value, called for side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+save_landscape">save_landscape</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#adding the call to the end_of_timestep_observer function at the config file or object 
#will automatically save all the species at an rds file at the outputfolder/species folder
# and the respective landscape at outputfolder/landscapes for the times steps the observer 
# function is called (i.e. call_observer parameter at the run_simulation function)
save_species()

## End(Not run)
</code></pre>

<hr>
<h2 id='save_traits'>This function can be called within the observer function to save the species traits.</h2><span id='topic+save_traits'></span>

<h3>Description</h3>

<p>This function can be called within the observer function to save the species traits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_traits()
</code></pre>


<h3>Value</h3>

<p>no return value, called for side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+save_species">save_species</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## save the current traits pattern from within observer for each population of each species
  # this functions should be called inside the end_of_timestep_observer function at the config file:
  save_traits()

## End(Not run)
</code></pre>

<hr>
<h2 id='skeleton_config'>empty skeleton config</h2><span id='topic+skeleton_config'></span>

<h3>Description</h3>

<p>empty skeleton config
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skeleton_config()
</code></pre>


<h3>Value</h3>

<p>compiled string
</p>

<hr>
<h2 id='verify_config'>Verifies if all required config fields are provided</h2><span id='topic+verify_config'></span>

<h3>Description</h3>

<p>Verifies if all required config fields are provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify_config(config)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verify_config_+3A_config">config</code></td>
<td>
<p>a config object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE for a valid config, FALSE otherwise, in which case a list of
missing parameters will be printed out as well
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_input_config">create_input_config</a></code>    <code><a href="#topic+write_config_skeleton">write_config_skeleton</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get path to input config
datapath &lt;- system.file(file.path("extdata", "WorldCenter"), package="gen3sis")
path_config &lt;- file.path(datapath, "config/config_worldcenter.R")
# create config object
config_object &lt;- create_input_config(path_config)
# check class
class(config_object)
# verify config
verify_config(config_object) # TRUE! this is a valid config

# break config_object, change name random_seed to r4nd0m_s33d
names(config_object$gen3sis$general)[1] &lt;- "r4nd0m_s33d"
verify_config(config_object) # FALSE! this is an invalid config
</code></pre>

<hr>
<h2 id='write_config_skeleton'>Writes out a config skeleton</h2><span id='topic+write_config_skeleton'></span>

<h3>Description</h3>

<p>Writes out a config skeleton
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_config_skeleton(file_path = "./config_skeleton.R", overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_config_skeleton_+3A_file_path">file_path</code></td>
<td>
<p>file path to write the file into</p>
</td></tr>
<tr><td><code id="write_config_skeleton_+3A_overwrite">overwrite</code></td>
<td>
<p>overwrite existing file defaults to FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes out a config skeleton, that is, an empty config file to be edited by the user.
</p>


<h3>Value</h3>

<p>returns a boolean indicating success or failure
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set config_empty.R file path
config_file_path &lt;- file.path(tempdir(), "config_empty.R")
#writes out a config skeleton
write_config_skeleton(config_file_path)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
