<!DOCTYPE html><html><head><title>Help for package semidist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {semidist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MINTsemiperm'><p>Mutual information independence test (categorical-continuous case)</p></a></li>
<li><a href='#mv'><p>Mean Variance (MV) statistics</p></a></li>
<li><a href='#mv_sis'><p>Feature screening via MV Index</p></a></li>
<li><a href='#mv_test'><p>MV independence test</p></a></li>
<li><a href='#print.indtest'><p>Print Method for Independence Tests Between Categorical and Continuous Variables</p></a></li>
<li><a href='#sd_sis'><p>Feature screening via semi-distance correlation</p></a></li>
<li><a href='#sd_test'><p>Semi-distance independence test</p></a></li>
<li><a href='#sdcov'><p>Semi-distance covariance and correlation statistics</p></a></li>
<li><a href='#semidist-package'><p>semidist: Measure Dependence Between Categorical and Continuous Variables</p></a></li>
<li><a href='#switch_cat_repr'><p>Switch the representation of a categorical object</p></a></li>
<li><a href='#tr_estimate'><p>Estimate the trace of the covariance matrix and its square</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Measure Dependence Between Categorical and Continuous Variables</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Semi-distance and mean-variance (MV) index are proposed to measure the dependence between a categorical random variable and a continuous variable.
    Test of independence and feature screening for classification problems can be implemented via the two dependence measures.
    For the details of the methods, see Zhong et al. (2023) &lt;<a href="https://doi.org/10.1080%2F01621459.2023.2284988">doi:10.1080/01621459.2023.2284988</a>&gt;;
    Cui and Zhong (2019) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2019.05.004">doi:10.1016/j.csda.2019.05.004</a>&gt;;
    Cui, Li and Zhong (2015) &lt;<a href="https://doi.org/10.1080%2F01621459.2014.920256">doi:10.1080/01621459.2014.920256</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>energy, FNN, furrr, purrr, Rcpp, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/wzhong41/semidist">https://github.com/wzhong41/semidist</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/wzhong41/semidist/issues">https://github.com/wzhong41/semidist/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-20 19:43:13 UTC; Chain</td>
</tr>
<tr>
<td>Author:</td>
<td>Wei Zhong [aut],
  Zhuoxi Li [aut, cre, cph],
  Wenwen Guo [aut],
  Hengjian Cui [aut],
  Runze Li [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhuoxi Li &lt;chainchei@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-21 06:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='MINTsemiperm'>Mutual information independence test (categorical-continuous case)</h2><span id='topic+MINTsemiperm'></span><span id='topic+MINTsemiauto'></span>

<h3>Description</h3>

<p>Implement the mutual information independence test (MINT)
(Berrett and Samworth, 2019), but with some modification in estimating the
mutual informaion (MI) between a categorical random variable and a
continuous variable. The modification is based on the idea of Ross (2014).
</p>
<p><code>MINTsemiperm()</code> implements the permutation independence test via
mutual information, but the parameter <code>k</code> should be pre-specified.
</p>
<p><code>MINTsemiauto()</code> automatically selects an appropriate <code>k</code> based on a
data-driven procedure, and conducts <code>MINTsemiperm()</code> with the <code>k</code> chosen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MINTsemiperm(X, y, k, B = 1000)

MINTsemiauto(X, y, kmax, B1 = 1000, B2 = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MINTsemiperm_+3A_x">X</code></td>
<td>
<p>Data of multivariate continuous variables, which should be an
<code class="reqn">n</code>-by-<code class="reqn">p</code> matrix, or, a vector of length <code class="reqn">n</code> (for univariate
variable).</p>
</td></tr>
<tr><td><code id="MINTsemiperm_+3A_y">y</code></td>
<td>
<p>Data of categorical variables, which should be a factor of length
<code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="MINTsemiperm_+3A_k">k</code></td>
<td>
<p>Number of nearest neighbor. See References for details.</p>
</td></tr>
<tr><td><code id="MINTsemiperm_+3A_b">B</code>, <code id="MINTsemiperm_+3A_b1">B1</code>, <code id="MINTsemiperm_+3A_b2">B2</code></td>
<td>
<p>Number of permutations to use. Defaults to 1000.</p>
</td></tr>
<tr><td><code id="MINTsemiperm_+3A_kmax">kmax</code></td>
<td>
<p>Maximum <code>k</code> in the automatic search for optimal <code>k</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with class <code>"indtest"</code> containing the following components
</p>

<ul>
<li> <p><code>method</code>: name of the test;
</p>
</li>
<li> <p><code>name_data</code>: names of the <code>X</code> and <code>y</code>;
</p>
</li>
<li> <p><code>n</code>: sample size of the data;
</p>
</li>
<li> <p><code>num_perm</code>: number of replications in permutation test;
</p>
</li>
<li> <p><code>stat</code>: test statistic;
</p>
</li>
<li> <p><code>pvalue</code>: computed p-value.
</p>
</li></ul>

<p>For <code>MINTsemiauto()</code>, the list also contains
</p>

<ul>
<li> <p><code>kmax</code>: maximum <code>k</code> in the automatic search for optimal <code>k</code>;
</p>
</li>
<li> <p><code>kopt</code>: optimal <code>k</code> chosen.
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> Berrett, Thomas B., and Richard J. Samworth. &quot;Nonparametric
independence testing via mutual information.&quot; <em>Biometrika</em> 106, no. 3
(2019): 547-566.
</p>
</li>
<li><p> Ross, Brian C. &quot;Mutual information between discrete and
continuous data sets.&quot; <em>PloS one</em> 9, no. 2 (2014): e87357.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- mtcars[, c("mpg", "disp", "drat", "wt")]
y &lt;- factor(mtcars[, "am"])

MINTsemiperm(X, y, 5)
MINTsemiauto(X, y, kmax = 32)

</code></pre>

<hr>
<h2 id='mv'>Mean Variance (MV) statistics</h2><span id='topic+mv'></span>

<h3>Description</h3>

<p>Compute the statistics of mean variance (MV) index, which can
measure the dependence between a univariate continuous variable and a
categorical variable. See Cui, Li and Zhong (2015); Cui and Zhong (2019)
for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mv(x, y, return_mat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mv_+3A_x">x</code></td>
<td>
<p>Data of univariate continuous variables, which should be a vector of
length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="mv_+3A_y">y</code></td>
<td>
<p>Data of categorical variables, which should be a factor of length
<code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="mv_+3A_return_mat">return_mat</code></td>
<td>
<p>A boolean. If <code>FALSE</code> (the default), only the calculated
statistic is returned. If <code>TRUE</code>, also return the matrix of the indicator
for x &lt;= x_i, which is useful for the permutation test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the corresponding sample statistic.
</p>
<p>If the argument <code>return_mat</code> of <code>mv()</code> is set as <code>TRUE</code>, a list with
elements
</p>

<ul>
<li> <p><code>mv</code>: the MV index statistic;
</p>
</li>
<li> <p><code>mat_x</code>: the matrices of the distances of the indicator for x &lt;= x_i;
</p>
</li></ul>

<p>will be returned.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+mv_test">mv_test()</a></code> for implementing independence test via MV index;
</p>
</li>
<li> <p><code><a href="#topic+mv_sis">mv_sis()</a></code> for implementing feature screening via MV index.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- mtcars[, "mpg"]
y &lt;- factor(mtcars[, "am"])
print(mv(x, y))

# Man-made independent data -------------------------------------------------
n &lt;- 30; R &lt;- 5; prob &lt;- rep(1/R, R)
x &lt;- rnorm(n)
y &lt;- factor(sample(1:R, size = n, replace = TRUE, prob = prob), levels = 1:R)
print(mv(x, y))

# Man-made functionally dependent data --------------------------------------
n &lt;- 30; R &lt;- 3
x &lt;- rep(0, n)
x[1:10] &lt;- 0.3; x[11:20] &lt;- 0.2; x[21:30] &lt;- -0.1
y &lt;- factor(rep(1:3, each = 10))
print(mv(x, y))

</code></pre>

<hr>
<h2 id='mv_sis'>Feature screening via MV Index</h2><span id='topic+mv_sis'></span>

<h3>Description</h3>

<p>Implement the feature screening for the classification problem
via MV index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mv_sis(X, y, d = NULL, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mv_sis_+3A_x">X</code></td>
<td>
<p>Data of multivariate covariates, which should be an
<code class="reqn">n</code>-by-<code class="reqn">p</code> matrix.</p>
</td></tr>
<tr><td><code id="mv_sis_+3A_y">y</code></td>
<td>
<p>Data of categorical response, which should be a factor of length
<code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="mv_sis_+3A_d">d</code></td>
<td>
<p>An integer specifying how many features should be kept after
screening. Defaults to <code>NULL</code>. If <code>NULL</code>, then it will be set as <code class="reqn">[n /
  log(n)]</code>, where <code class="reqn">[x]</code> denotes the integer part of x.</p>
</td></tr>
<tr><td><code id="mv_sis_+3A_parallel">parallel</code></td>
<td>
<p>A boolean indicating whether to calculate parallelly via
<code>furrr::future_map</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the objects about the implemented feature screening:
</p>

<ul>
<li> <p><code>measurement</code>: sample MV index calculated for each single covariate;
</p>
</li>
<li> <p><code>selected</code>: indicies or names (if avaiable as colnames of <code>X</code>) of
covariates that are selected after feature screening;
</p>
</li>
<li> <p><code>ordering</code>: order of the calculated measurements of each single covariate.
The first one is the largest, and the last is the smallest.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- mtcars[, c("mpg", "disp", "hp", "drat", "wt", "qsec")]
y &lt;- factor(mtcars[, "am"])

mv_sis(X, y, d = 4)

</code></pre>

<hr>
<h2 id='mv_test'>MV independence test</h2><span id='topic+mv_test'></span>

<h3>Description</h3>

<p>Implement the MV independence test via permutation test, or via
the asymptotic approximation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mv_test(x, y, test_type = "perm", num_perm = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mv_test_+3A_x">x</code></td>
<td>
<p>Data of univariate continuous variables, which should be a vector of
length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="mv_test_+3A_y">y</code></td>
<td>
<p>Data of categorical variables, which should be a factor of length
<code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="mv_test_+3A_test_type">test_type</code></td>
<td>
<p>Type of the test:
</p>

<ul>
<li> <p><code>"perm"</code> (the default): Implement the test via permutation test;
</p>
</li>
<li> <p><code>"asym"</code>: Implement the test via the asymptotic approximation.
</p>
</li></ul>

<p>See the Reference for details.</p>
</td></tr>
<tr><td><code id="mv_test_+3A_num_perm">num_perm</code></td>
<td>
<p>The number of replications in permutation test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with class <code>"indtest"</code> containing the following components
</p>

<ul>
<li> <p><code>method</code>: name of the test;
</p>
</li>
<li> <p><code>name_data</code>: names of the <code>x</code> and <code>y</code>;
</p>
</li>
<li> <p><code>n</code>: sample size of the data;
</p>
</li>
<li> <p><code>num_perm</code>: number of replications in permutation test;
</p>
</li>
<li> <p><code>stat</code>: test statistic;
</p>
</li>
<li> <p><code>pvalue</code>: computed p-value. (Notice: asymptotic test cannot return a p-value, but only the critical values <code>crit_vals</code> for 90%, 95% and 99% confidence levels.)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- mtcars[, "mpg"]
y &lt;- factor(mtcars[, "am"])
test &lt;- mv_test(x, y)
print(test)
test_asym &lt;- mv_test(x, y, test_type = "asym")
print(test_asym)

# Man-made independent data -------------------------------------------------
n &lt;- 30; R &lt;- 5; prob &lt;- rep(1/R, R)
x &lt;- rnorm(n)
y &lt;- factor(sample(1:R, size = n, replace = TRUE, prob = prob), levels = 1:R)
test &lt;- mv_test(x, y)
print(test)
test_asym &lt;- mv_test(x, y, test_type = "asym")
print(test_asym)

# Man-made functionally dependent data --------------------------------------
n &lt;- 30; R &lt;- 3
x &lt;- rep(0, n)
x[1:10] &lt;- 0.3; x[11:20] &lt;- 0.2; x[21:30] &lt;- -0.1
y &lt;- factor(rep(1:3, each = 10))
test &lt;- mv_test(x, y)
print(test)
test_asym &lt;- mv_test(x, y, test_type = "asym")
print(test_asym)

</code></pre>

<hr>
<h2 id='print.indtest'>Print Method for Independence Tests Between Categorical and Continuous Variables</h2><span id='topic+print.indtest'></span>

<h3>Description</h3>

<p>Printing object of class <code>"indtest"</code>, by simple <a href="base.html#topic+print">print</a> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'indtest'
print(x, digits = getOption("digits"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.indtest_+3A_x">x</code></td>
<td>
<p><code>"indtest"</code> class object.</p>
</td></tr>
<tr><td><code id="print.indtest_+3A_digits">digits</code></td>
<td>
<p>minimal number of <em>significant</em> digits.</p>
</td></tr>
<tr><td><code id="print.indtest_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Man-made functionally dependent data --------------------------------------
n &lt;- 30; R &lt;- 3
x &lt;- rep(0, n)
x[1:10] &lt;- 0.3; x[11:20] &lt;- 0.2; x[21:30] &lt;- -0.1
y &lt;- factor(rep(1:3, each = 10))
test &lt;- mv_test(x, y)
print(test)
test_asym &lt;- mv_test(x, y, test_type = "asym")
print(test_asym)

</code></pre>

<hr>
<h2 id='sd_sis'>Feature screening via semi-distance correlation</h2><span id='topic+sd_sis'></span>

<h3>Description</h3>

<p>Implement the (grouped) feature screening for the classification
problem via semi-distance correlation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sd_sis(X, y, group_info = NULL, d = NULL, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sd_sis_+3A_x">X</code></td>
<td>
<p>Data of multivariate covariates, which should be an
<code class="reqn">n</code>-by-<code class="reqn">p</code> matrix.</p>
</td></tr>
<tr><td><code id="sd_sis_+3A_y">y</code></td>
<td>
<p>Data of categorical response, which should be a factor of length
<code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="sd_sis_+3A_group_info">group_info</code></td>
<td>
<p>A list specifying the group information, with elements
being sets of indicies of covariates in a same group. For example,
<code>list(c(1, 2, 3), c(4, 5))</code> specifies that covariates 1, 2, 3 are in a
group and covariates 4, 5 are in another group.
</p>
<p>Defaults to <code>NULL</code>. If <code>NULL</code>, then it will be set as <code>list(1, 2, ..., p)</code>,
that is, treat each single covariate as a group.
</p>
<p>If <code>X</code> has colnames, then the colnames can be used to specified the
<code>group_info</code>. For example, <code>list(c("a", "b"), c("c", "d"))</code>.
</p>
<p>The names of the list can help recoginize the group. For example,
<code>list(grp_ab = c("a", "b"), grp_cd = c("c", "d"))</code>. If names of the list
are not specified, <code>c("Grp 1", "Grp 2", ..., "Grp J")</code> will be applied.</p>
</td></tr>
<tr><td><code id="sd_sis_+3A_d">d</code></td>
<td>
<p>An integer specifying <em>at least</em> how many (single) features should
be kept after screening. For example, if <code>group_info = list(c(1, 2), c(3, 4))</code> and <code>d = 3</code>, then all features 1, 2, 3, 4 must be selected since it
should guarantee at least 3 features are kept.
</p>
<p>Defaults to <code>NULL</code>. If <code>NULL</code>, then it will be set as <code class="reqn">[n / log(n)]</code>,
where <code class="reqn">[x]</code> denotes the integer part of x.</p>
</td></tr>
<tr><td><code id="sd_sis_+3A_parallel">parallel</code></td>
<td>
<p>A boolean indicating whether to calculate parallelly via
<code>furrr::future_map</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the objects about the implemented feature screening:
</p>

<ul>
<li> <p><code>group_info</code>: group information;
</p>
</li>
<li> <p><code>measurement</code>: sample semi-distance correlations calculated for the groups
specified in <code>group_info</code>;
</p>
</li>
<li> <p><code>selected</code>: indicies/names of (single) covariates that are selected after
feature screening;
</p>
</li>
<li> <p><code>ordering</code>: order of the calculated measurements of the groups specified in
<code>group_info</code>. The first one is the largest, and the last is the smallest.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+sdcor">sdcor()</a></code> for calculating the sample semi-distance correlation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- mtcars[, c("mpg", "disp", "hp", "drat", "wt", "qsec")]
y &lt;- factor(mtcars[, "am"])

sd_sis(X, y, d = 4)

# Suppose we have prior information for the group structure as
# ("mpg", "drat"), ("disp", "hp") and ("wt", "qsec")
group_info &lt;- list(
  mpg_drat = c("mpg", "drat"),
  disp_hp = c("disp", "hp"),
  wt_qsec = c("wt", "qsec")
)
sd_sis(X, y, group_info, d = 4)

</code></pre>

<hr>
<h2 id='sd_test'>Semi-distance independence test</h2><span id='topic+sd_test'></span>

<h3>Description</h3>

<p>Implement the semi-distance independence test via permutation
test, or via the asymptotic approximation when the dimensionality of
continuous variables <code class="reqn">p</code> is high.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sd_test(X, y, test_type = "perm", num_perm = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sd_test_+3A_x">X</code></td>
<td>
<p>Data of multivariate continuous variables, which should be an
<code class="reqn">n</code>-by-<code class="reqn">p</code> matrix, or, a vector of length <code class="reqn">n</code> (for univariate
variable).</p>
</td></tr>
<tr><td><code id="sd_test_+3A_y">y</code></td>
<td>
<p>Data of categorical variables, which should be a factor of length
<code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="sd_test_+3A_test_type">test_type</code></td>
<td>
<p>Type of the test:
</p>

<ul>
<li> <p><code>"perm"</code> (the default): Implement the test via permutation test;
</p>
</li>
<li> <p><code>"asym"</code>: Implement the test via the asymptotic approximation when the
dimension of continuous variables <code class="reqn">p</code> is high.
</p>
</li></ul>

<p>See the Reference for details.</p>
</td></tr>
<tr><td><code id="sd_test_+3A_num_perm">num_perm</code></td>
<td>
<p>The number of replications in permutation test. Defaults to
10000. See Details and Reference.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The semi-distance independence test statistic is </p>
<p style="text-align: center;"><code class="reqn">T_n = n \cdot
  \widetilde{\text{SDcov}}_n(X, y),</code>
</p>
<p> where the
<code class="reqn">\widetilde{\text{SDcov}}_n(X, y)</code> can be computed by <code>sdcov(X, y, type = "U")</code>.
</p>
<p>For the permutation test (<code>test_type = "perm"</code>), totally <code class="reqn">K</code>
replications of permutation will be conducted, and the argument <code>num_perm</code>
specifies the <code class="reqn">K</code> here. The p-value of permutation test is computed by
</p>
<p style="text-align: center;"><code class="reqn">\text{p-value} = (\sum_{k=1}^K I(T^{\ast (k)}_{n} \ge T_{n}) + 1) /
  (K + 1),</code>
</p>
<p> where <code class="reqn">T_{n}</code> is the semi-distance test statistic and
<code class="reqn">T^{\ast (k)}_{n}</code> is the test statistic with <code class="reqn">k</code>-th permutation
sample.
</p>
<p>When the dimension of the continuous variables is high, the asymptotic
approximation approach can be applied (<code>test_type = "asym"</code>), which is
computationally faster since no permutation is needed.
</p>


<h3>Value</h3>

<p>A list with class <code>"indtest"</code> containing the following components
</p>

<ul>
<li> <p><code>method</code>: name of the test;
</p>
</li>
<li> <p><code>name_data</code>: names of the <code>X</code> and <code>y</code>;
</p>
</li>
<li> <p><code>n</code>: sample size of the data;
</p>
</li>
<li> <p><code>test_type</code>: type of the test;
</p>
</li>
<li> <p><code>num_perm</code>: number of replications in permutation test, if
<code>test_type = "perm"</code>;
</p>
</li>
<li> <p><code>stat</code>: test statistic;
</p>
</li>
<li> <p><code>pvalue</code>: computed p-value.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+sdcov">sdcov()</a></code> for computing the statistic of semi-distance covariance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- mtcars[, c("mpg", "disp", "drat", "wt")]
y &lt;- factor(mtcars[, "am"])
test &lt;- sd_test(X, y)
print(test)

# Man-made independent data -------------------------------------------------
n &lt;- 30; R &lt;- 5; p &lt;- 3; prob &lt;- rep(1/R, R)
X &lt;- matrix(rnorm(n*p), n, p)
y &lt;- factor(sample(1:R, size = n, replace = TRUE, prob = prob), levels = 1:R)
test &lt;- sd_test(X, y)
print(test)

# Man-made functionally dependent data --------------------------------------
n &lt;- 30; R &lt;- 3; p &lt;- 3
X &lt;- matrix(0, n, p)
X[1:10, 1] &lt;- 1; X[11:20, 2] &lt;- 1; X[21:30, 3] &lt;- 1
y &lt;- factor(rep(1:3, each = 10))
test &lt;- sd_test(X, y)
print(test)

#' Man-made high-dimensionally independent data -----------------------------
n &lt;- 30; R &lt;- 3; p &lt;- 100
X &lt;- matrix(rnorm(n*p), n, p)
y &lt;- factor(rep(1:3, each = 10))
test &lt;- sd_test(X, y)
print(test)

test &lt;- sd_test(X, y, test_type = "asym")
print(test)

# Man-made high-dimensionally dependent data --------------------------------
n &lt;- 30; R &lt;- 3; p &lt;- 100
X &lt;- matrix(0, n, p)
X[1:10, 1] &lt;- 1; X[11:20, 2] &lt;- 1; X[21:30, 3] &lt;- 1
y &lt;- factor(rep(1:3, each = 10))
test &lt;- sd_test(X, y)
print(test)

test &lt;- sd_test(X, y, test_type = "asym")
print(test)

</code></pre>

<hr>
<h2 id='sdcov'>Semi-distance covariance and correlation statistics</h2><span id='topic+sdcov'></span><span id='topic+sdcor'></span>

<h3>Description</h3>

<p>Compute the statistics (or sample estimates) of semi-distance
covariance and correlation. The semi-distance correlation is a standardized
version of semi-distance covariance, and it can measure the dependence
between a <em>multivariate</em> continuous variable and a categorical variable.
See Details for the definition of semi-distance covariance and
semi-distance correlation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdcov(X, y, type = "V", return_mat = FALSE)

sdcor(X, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sdcov_+3A_x">X</code></td>
<td>
<p>Data of multivariate continuous variables, which should be an
<code class="reqn">n</code>-by-<code class="reqn">p</code> matrix, or, a vector of length <code class="reqn">n</code> (for univariate
variable).</p>
</td></tr>
<tr><td><code id="sdcov_+3A_y">y</code></td>
<td>
<p>Data of categorical variables, which should be a factor of length
<code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="sdcov_+3A_type">type</code></td>
<td>
<p>Type of statistic: <code>"V"</code> (the default) or <code>"U"</code>. See Details.</p>
</td></tr>
<tr><td><code id="sdcov_+3A_return_mat">return_mat</code></td>
<td>
<p>A boolean. If <code>FALSE</code> (the default), only the calculated
statistic is returned. If <code>TRUE</code>, also return the matrix of the distances
of X and the divergences of y, which is useful for the permutation test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code class="reqn">\bm{X} \in \mathbb{R}^{p}</code> and <code class="reqn">Y \in \{1, 2, \cdots,
  R\}</code>, the (population-level) semi-distance covariance is defined as
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{SDcov}(\bm{X}, Y) =
  \mathrm{E}\left[\|\bm{X}-\widetilde{\bm{X}}\|\left(1-\sum_{r=1}^R
  I(Y=r,\widetilde{Y}=r)/p_r\right)\right],</code>
</p>
<p> where <code class="reqn">p_r = P(Y = r)</code> and
<code class="reqn">(\widetilde{\bm{X}}, \widetilde{Y})</code> is an iid copy of <code class="reqn">(\bm{X},
  Y)</code>.
The (population-level) semi-distance correlation is defined as
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{SDcor}(\bm{X}, Y) = \dfrac{\mathrm{SDcov}(\bm{X},
  Y)}{\mathrm{dvar}(\bm{X})\sqrt{R-1}},</code>
</p>
<p> where <code class="reqn">\mathrm{dvar}(\bm{X})</code> is
the distance variance (Szekely, Rizzo, and Bakirov 2007) of <code class="reqn">\bm{X}</code>.
</p>
<p>With <code class="reqn">n</code> observations <code class="reqn">\{(\bm{X}_i, Y_i)\}_{i=1}^{n}</code>, <code>sdcov()</code>
and <code>sdcor()</code> can compute the sample estimates for the semi-distance
covariance and correlation.
</p>
<p>If <code>type = "V"</code>, the semi-distance covariance statistic is computed as a
V-statistic, which takes a very similar form as the energy-based statistic
with double centering, and is always non-negative. Specifically,
</p>
<p style="text-align: center;"><code class="reqn">\text{SDcov}_n(\bm{X}, y) = \frac{1}{n^2} \sum_{k=1}^{n}
  \sum_{l=1}^{n} A_{kl} B_{kl},</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">A_{kl} = a_{kl} - \bar{a}_{k.} - \bar{a}_{.l} + \bar{a}_{..}</code>
</p>

<p>is the double centering (Szekely, Rizzo, and Bakirov 2007) of
<code class="reqn">a_{kl} = \| \bm{X}_k - \bm{X}_l \|,</code> and </p>
<p style="text-align: center;"><code class="reqn">B_{kl} =
  1 - \sum_{r=1}^{R} I(Y_k = r) I(Y_l = r) / \hat{p}_r</code>
</p>
<p> with <code class="reqn">\hat{p}_r =
  n_r / n = n^{-1}\sum_{i=1}^{n} I(Y_i = r)</code>.
The semi-distance correlation statistic is </p>
<p style="text-align: center;"><code class="reqn">\text{SDcor}_n(\bm{X}, y)
  = \dfrac{\text{SDcov}_n(\bm{X}, y)}{\text{dvar}_n(\bm{X})\sqrt{R - 1}},</code>
</p>

<p>where <code class="reqn">\text{dvar}_n(\bm{X})</code> is the V-statistic of distance variance
of <code class="reqn">\bm{X}</code>.
</p>
<p>If <code>type = "U"</code>, then the semi-distance covariance statistic is computed as
an &ldquo;estimated U-statistic&rdquo;, which is utilized in the independence test
statistic and is not necessarily non-negative. Specifically,
</p>
<p style="text-align: center;"><code class="reqn">\widetilde{\text{SDcov}}_n(\bm{X}, y) = \frac{1}{n(n-1)}
  \sum_{i \ne j} \| \bm{X}_i - \bm{X}_j \| \left(1 - \sum_{r=1}^{R}
  I(Y_i = r) I(Y_j = r) / \tilde{p}_r\right),</code>
</p>

<p>where <code class="reqn">\tilde{p}_r = (n_r-1) / (n-1) = (n-1)^{-1}(\sum_{i=1}^{n} I(Y_i
  = r) - 1)</code>. Note that the test statistic of the semi-distance independence
test is </p>
<p style="text-align: center;"><code class="reqn">T_n = n \cdot \widetilde{\text{SDcov}}_n(\bm{X}, y).</code>
</p>



<h3>Value</h3>

<p>The value of the corresponding sample statistic.
</p>
<p>If the argument <code>return_mat</code> of <code>sdcov()</code> is set as <code>TRUE</code>, a list with
elements
</p>

<ul>
<li> <p><code>sdcov</code>: the semi-distance covariance statistic;
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;mat_x, mat_y&#8288;</code>: the matrices of the distances of X and the divergences
of y, respectively;
</p>
</li></ul>

<p>will be returned.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+sd_test">sd_test()</a></code> for implementing independence test via semi-distance
covariance;
</p>
</li>
<li> <p><code><a href="#topic+sd_sis">sd_sis()</a></code> for implementing groupwise feature screening via
semi-distance correlation.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- mtcars[, c("mpg", "disp", "drat", "wt")]
y &lt;- factor(mtcars[, "am"])
print(sdcov(X, y))
print(sdcor(X, y))

# Man-made independent data -------------------------------------------------
n &lt;- 30; R &lt;- 5; p &lt;- 3; prob &lt;- rep(1/R, R)
X &lt;- matrix(rnorm(n*p), n, p)
y &lt;- factor(sample(1:R, size = n, replace = TRUE, prob = prob), levels = 1:R)
print(sdcov(X, y))
print(sdcor(X, y))

# Man-made functionally dependent data --------------------------------------
n &lt;- 30; R &lt;- 3; p &lt;- 3
X &lt;- matrix(0, n, p)
X[1:10, 1] &lt;- 1; X[11:20, 2] &lt;- 1; X[21:30, 3] &lt;- 1
y &lt;- factor(rep(1:3, each = 10))
print(sdcov(X, y))
print(sdcor(X, y))

</code></pre>

<hr>
<h2 id='semidist-package'>semidist: Measure Dependence Between Categorical and Continuous Variables</h2><span id='topic+semidist'></span><span id='topic+semidist-package'></span>

<h3>Description</h3>

<p>Semi-distance and mean-variance (MV) index are proposed to measure the dependence between a categorical random variable and a continuous variable. Test of independence and feature screening for classification problems can be implemented via the two dependence measures. For the details of the methods, see Zhong et al. (2023) <a href="https://doi.org/10.1080/01621459.2023.2284988">doi:10.1080/01621459.2023.2284988</a>; Cui and Zhong (2019) <a href="https://doi.org/10.1016/j.csda.2019.05.004">doi:10.1016/j.csda.2019.05.004</a>; Cui, Li and Zhong (2015) <a href="https://doi.org/10.1080/01621459.2014.920256">doi:10.1080/01621459.2014.920256</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Zhuoxi Li <a href="mailto:chainchei@gmail.com">chainchei@gmail.com</a> [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Wei Zhong <a href="mailto:wzhong@xmu.edu.cn">wzhong@xmu.edu.cn</a>
</p>
</li>
<li><p> Wenwen Guo <a href="mailto:guowenwen114@163.com">guowenwen114@163.com</a>
</p>
</li>
<li><p> Hengjian Cui <a href="mailto:hjcui@bnu.edu.cn">hjcui@bnu.edu.cn</a>
</p>
</li>
<li><p> Runze Li <a href="mailto:ril4@psu.edu">ril4@psu.edu</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/wzhong41/semidist">https://github.com/wzhong41/semidist</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/wzhong41/semidist/issues">https://github.com/wzhong41/semidist/issues</a>
</p>
</li></ul>


<hr>
<h2 id='switch_cat_repr'>Switch the representation of a categorical object</h2><span id='topic+switch_cat_repr'></span>

<h3>Description</h3>

<p>Categorical data with n observations and R levels can typically be represented as two forms in R:
a factor with length n, or an n by K indicator matrix with elements being 0 or 1.
This function is to switch the form of a categorical object from one to the another.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>switch_cat_repr(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="switch_cat_repr_+3A_obj">obj</code></td>
<td>
<p>an object representing categorical data,
either a factor or an indicator matrix with each row representing an observation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>categorical object in the another form.
</p>

<hr>
<h2 id='tr_estimate'>Estimate the trace of the covariance matrix and its square</h2><span id='topic+tr_estimate'></span>

<h3>Description</h3>

<p>For a design matrix <code class="reqn">\mathbf{X}</code>, estimate the trace of its covariance matrix <code class="reqn">\Sigma = \mathrm{cov}(\mathbf{X})</code>,
and the square of covariance matrix <code class="reqn">\Sigma^2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tr_estimate(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tr_estimate_+3A_x">X</code></td>
<td>
<p>The design matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li> <p><code>tr_S</code>: estimate for trace of <code class="reqn">\Sigma</code>;
</p>
</li>
<li> <p><code>tr_S2</code>: estimate for trace of <code class="reqn">\Sigma^2</code>.
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
