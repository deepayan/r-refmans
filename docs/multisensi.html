<!DOCTYPE html><html><head><title>Help for package multisensi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multisensi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#multisensi-package'><p>Multivariate sensitivity Analysis</p></a></li>
<li><a href='#analysis.anoasg'>
<p>Runs a series of analyses of variance</p></a></li>
<li><a href='#analysis.sensitivity'>
<p>Runs a series of sensitivity analyses by a function from the <span class="pkg">sensitivity</span> package</p></a></li>
<li><a href='#basis.ACP'>
<p>A function to decompose multivariate data by principal components analysis (PCA)</p></a></li>
<li><a href='#basis.bsplines'>
<p>A function to decompose multivariate data on a B-spline basis</p></a></li>
<li><a href='#basis.mine'>
<p>A function to decompose multivariate data on a user-defined basis</p></a></li>
<li><a href='#basis.osplines'>
<p>A function to decompose multivariate data on an orthogonal B-spline basis (O-spline)</p></a></li>
<li><a href='#basis.poly'>
<p>A function to decompose multivariate data on a polynomial basis</p></a></li>
<li><a href='#biomasse'><p>The Winter Wheat Dynamic Model</p></a></li>
<li><a href='#biomasseX'><p>A factorial input design for the main example</p></a></li>
<li><a href='#biomasseY'><p>Output of the biomasse model for the plan provided in the package</p></a></li>
<li><a href='#bspline'>
<p>function to evaluate B-spline basis functions</p></a></li>
<li><a href='#Climat'><p>Climate data</p></a></li>
<li><a href='#dynsi'><p>Dynamic Sensitivity Indices: DSI</p></a></li>
<li><a href='#graph.bar'><p>Sensitivity index bar plot</p></a></li>
<li><a href='#graph.pc'><p>Principal Components graph for gsi objects</p></a></li>
<li><a href='#grpe.gsi'><p>Group factor GSI, obsolete function</p></a></li>
<li><a href='#gsi'><p>Generalised Sensitivity Indices: GSI</p></a></li>
<li><a href='#multisensi'>
<p>A function with multiple options to perform multivariate sensitivity analysis</p></a></li>
<li><a href='#multivar'>
<p>A function to decompose the output data set and reduce its dimension</p></a></li>
<li><a href='#planfact'><p>Complete factorial design in lexical order</p></a></li>
<li><a href='#planfact.as'><p>Complete factorial design</p></a></li>
<li><a href='#plot.dynsi'><p>Plot method for dynamic sensitivity results</p></a></li>
<li><a href='#plot.gsi'><p>Plot method for generalised sensitivity analysis</p></a></li>
<li><a href='#predict.gsi'>
<p>A function to predict multivariate output</p></a></li>
<li><a href='#print.dynsi'><p>print DYNSI</p></a></li>
<li><a href='#print.gsi'><p>print GSI</p></a></li>
<li><a href='#quality'><p>quality of any approximation</p></a></li>
<li><a href='#sesBsplinesNORM'>
<p>normalized B-splines basis functions</p></a></li>
<li><a href='#sesBsplinesORTHONORM'>
<p>orthogonalized B-splines basis functions</p></a></li>
<li><a href='#simulmodel'><p>Model simulation</p></a></li>
<li><a href='#summary.dynsi'><p>dynsi summary</p></a></li>
<li><a href='#summary.gsi'><p>summary of GSI results</p></a></li>
<li><a href='#yapprox'><p>Prediction based on PCA and anovas (NOT ONLY)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Sensitivity Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-04-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Caroline Bidot &lt;caroline.bidot@inra.fr&gt;, Matieyendou Lamboni &lt;matieyendou.lamboni@gmail.com&gt;, Hervé Monod &lt;herve.monod@inra.fr&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hervé Monod &lt;herve.monod@inra.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to perform sensitivity analysis on a model with multivariate output.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.cecill.info/licences/Licence_CeCILL_V2-en.txt">CeCILL-2</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.8.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, utils, grDevices, sensitivity, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-04-04 09:16:47 UTC; cbidot</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-04-10 10:27:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='multisensi-package'>Multivariate sensitivity Analysis</h2><span id='topic+multisensi-package'></span>

<h3>Description</h3>

<p>Sensitivity Analysis (SA) for models with multivariate output</p>


<h3>Details</h3>

<p>This package generalises sensitivity analysis to simulation models with multivariate output. It makes it easy to run a series of independent sensitivity analyses on a set of output variables and to plot the results. Alternatively, it allows to apply sensitivity analyses to the variables resulting from the application of a multivariate method (such as PCA or splines or polynomial regression) to the output data (Lamboni et al., 2009).
</p>
<p>The function <code><a href="#topic+multisensi">multisensi</a></code> integrates all the different possible methods implemented in the package. Besides, the user may consider the functions which have existed since the first version of the package:
</p>
<p>i) <code><a href="#topic+gsi">gsi</a></code> function for the Generalised Sensitivity Analysis  (Lamboni et al., 2011, Xiao and Li, 2016) based on inertia decomposition. This method synthesizes the
information that is spread between the time outputs or between the
principal components and produces a unique sensitivity index for each
factor.
</p>
<p>ii) <code><a href="#topic+gsi">gsi</a></code> function for the componentwise sensitivity analysis obtained by
computing sensitivity indices on principal components (Campbell et al., 2006)
</p>
<p>iii) <code><a href="#topic+dynsi">dynsi</a></code> function for the dynamic sensitivity analysis obtained by
computing sensitivity indices on each output variable.
</p>
<p>In the first version of <span class="pkg">multisensi</span>, sensitivity indices were based on using a factorial design and a classical ANOVA decomposition. It is now possible to use other methods for the design and for the sensitivity analysis.
</p>
<p>Simulation model management
</p>
<p>The <span class="pkg">multisensi</span> package works on simulation models coded either in <span class="rlang"><b>R</b></span> or
using an external language (typically as an executable file). Models
coded in <span class="rlang"><b>R</b></span> must be either functions or objects that have a predict
method, such as lm objects. Models defined as functions will be called
once with an expression of the form <code>y &lt;- f(X)</code> where <code>X</code> is a vector
containing a combination of levels of the input factors, and <code>y</code> is the
output vector of length <code class="reqn">q</code>, where <code class="reqn">q</code> is the number of output variables. If
the model is external to <span class="rlang"><b>R</b></span>, for instance a computational code, it must
be analyzed with the decoupled approach: the methods require an input
data frame (<code>X</code>) containing all the combinations of the input levels and
the outputs data frame (<code>Y</code>) containing the response of the model
corresponding to these combinations.  The size of <code>X</code> is <code class="reqn">n*p</code> and the size
of <code>Y</code> is <code class="reqn">n*q</code> where <code class="reqn">p</code> is the number of the input factor, <code class="reqn">q</code> is the number
of the model outputs and <code class="reqn">n</code> is the number of all the combinations of the
input levels.  This approach can also be used on <span class="rlang"><b>R</b></span> models that do not
fit the required specifications.  
</p>


<h3>References</h3>

<p>Lamboni, M., Makowski, D., Monod, H., 2009. Multivariate global sensitivity analysis for dynamic crop models. Field Crops Research, volume 113, pp. 312-320.
</p>
<p>Lamboni, M., Makowski, D., Monod, H., 2011. Multivariate sensitivity analysis to measure global contribution of input factors in dynamic models. Reliability Engineering &amp; System Safety, volume 96, pp. 450-459.
</p>
<p>Xiao, H., Li, L., 2016. Discussion of paper by M. Lamboni, H. Monod, D. Makowski Multivariate sensitivity analysis to measure global contribution of input factors in dynamic models, Reliab. Eng. Syst. Saf. 96 (2011) 450-459. Reliability Engineering &amp; System Safety, volume 147, pp. 194-195.
</p>
<p>Saltelli, A., Chan, K., Scott, E.M. eds, 2000. <em>Sensitivity
Analysis</em> Wiley, New York.  
</p>

<hr>
<h2 id='analysis.anoasg'>
Runs a series of analyses of variance</h2><span id='topic+analysis.anoasg'></span>

<h3>Description</h3>

<p>The <code>analysis.anoasg</code> function runs a series of analyses of variance on the columns of a data.frame, by using the <code><a href="stats.html#topic+aov">aov</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analysis.anoasg(Y, plan, nbcomp = 2, sigma.car = NULL,
                analysis.args = list(formula = 2,
                                     keep.outputs = FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analysis.anoasg_+3A_y">Y</code></td>
<td>
<p>a data.frame of output variables or principal components.
</p>
</td></tr>
<tr><td><code id="analysis.anoasg_+3A_plan">plan</code></td>
<td>
<p>a data.frame containing the design.
</p>
</td></tr>
<tr><td><code id="analysis.anoasg_+3A_nbcomp">nbcomp</code></td>
<td>
<p>the number of <code>Y</code> variables to analyse (the first <code>nbcomp</code> variables of <code>Y</code> will be analysed).
</p>
</td></tr>
<tr><td><code id="analysis.anoasg_+3A_sigma.car">sigma.car</code></td>
<td>
<p>NULL or sum of squares of Y. If not NULL, compute the Generalised Sensitivity Indices (saved in the last column of the data.frame mSI/tSI/iSI outputs.
</p>
</td></tr>
<tr><td><code id="analysis.anoasg_+3A_analysis.args">analysis.args</code></td>
<td>
<p>a list of arguments. The <code>formula</code> component is for ANOVA formula like <code>"A+B+c+A:B"</code> OR an integer giving the maximum interaction order (1 for main effects). If it contains <code>keep.outputs=TRUE</code>, the outputs associated with the analysis of each variable are returned (see section <code>Value</code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>SI</code></td>
<td>
<p>data.frame of sensitivity indices</p>
</td></tr>
<tr><td><code>mSI</code></td>
<td>
<p>data.frame of first-order sensitivity indices</p>
</td></tr>
<tr><td><code>tSI</code></td>
<td>
<p>data.frame of total sensitivity indices</p>
</td></tr>
<tr><td><code>iSI</code></td>
<td>
<p>data.frame of interaction sensitivity indices</p>
</td></tr>
<tr><td><code>inertia</code></td>
<td>
<p>vector of Inertia explained by the variables</p>
</td></tr>
<tr><td><code>indic.fact</code></td>
<td>
<p>0-1 matrix to indicate the factors associated with each factorial effect</p>
</td></tr>
<tr><td><code>Hpredict</code></td>
<td>
<p>prediction of outputs</p>
</td></tr>
<tr><td><code>outputkept</code></td>
<td>
<p>if <code> analysis.args$keep.outputs=TRUE</code>, list of the outputs returned by the sensitivity analysis performed on each variable</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>list with first element <code>analysis="anova"</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+aov">aov</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Test case : the Winter Wheat Dynamic Models (WWDM)
#  input factors design
 data(biomasseX)
# output variables (precalculated to speed up the example)
 data(biomasseY)

 res &lt;- analysis.anoasg(biomasseY, biomasseX, 
                        nbcomp = 2, sigma.car = NULL,
                        analysis.args = list(formula = 2,
                                             keep.outputs = FALSE))

</code></pre>

<hr>
<h2 id='analysis.sensitivity'>
Runs a series of sensitivity analyses by a function from the <span class="pkg">sensitivity</span> package
</h2><span id='topic+analysis.sensitivity'></span>

<h3>Description</h3>

<p>The <code>analysis.sensitivity</code> function runs a series of sensitivity analyses on the columns of a data.frame, using a method implemented in the <span class="pkg">sensitivity</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analysis.sensitivity(Y, plan, nbcomp = 2, sigma.car = NULL,
                     analysis.args = list(keep.outputs = FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analysis.sensitivity_+3A_y">Y</code></td>
<td>
<p>a data.frame of output variables or principal components.
</p>
</td></tr>
<tr><td><code id="analysis.sensitivity_+3A_plan">plan</code></td>
<td>
<p>an object containing the design. It must be created by a function from the <span class="pkg">sensitivity</span> package with argument <code>model=NULL</code>.
</p>
</td></tr>
<tr><td><code id="analysis.sensitivity_+3A_nbcomp">nbcomp</code></td>
<td>
<p>the number of <code>Y</code> variables to analyse (the first <code>nbcomp</code> variables of <code>Y</code> will be analysed).
</p>
</td></tr>
<tr><td><code id="analysis.sensitivity_+3A_sigma.car">sigma.car</code></td>
<td>
<p>NULL or sum of squares of Y. If not NULL, compute the Generalised Sensitivity Indices (saved in the last column of the data.frame mSI/tSI/iSI outputs.
</p>
</td></tr>
<tr><td><code id="analysis.sensitivity_+3A_analysis.args">analysis.args</code></td>
<td>
<p>a list of arguments. If it contains <code>keep.outputs=TRUE</code>, the outputs associated with the analysis of each variable are returned (see section <code>Value</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>plan</code> must be an object created by a method implemented in the <span class="pkg">sensitivity</span> package. Thus it belongs to a class such as <code>morris</code> or <code>fast99</code>. The name of the class is stored in the element <code>call.info$fct</code> of the output returned by <code>analysis.sensitivity</code>.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>SI</code></td>
<td>
<p>data.frame of sensitivity indices or other importance measures returned by the function from the <span class="pkg">sensitivity</span> package used. Sometimes empty but kept for compatibility reasons.</p>
</td></tr>
<tr><td><code>mSI</code></td>
<td>
<p>data.frame of first-order sensitivity indices</p>
</td></tr>
<tr><td><code>tSI</code></td>
<td>
<p>data.frame of total sensitivity indices</p>
</td></tr>
<tr><td><code>iSI</code></td>
<td>
<p>data.frame of interaction sensitivity indices</p>
</td></tr>
<tr><td><code>inertia</code></td>
<td>
<p>empty (kept for compatibility reasons)</p>
</td></tr>
<tr><td><code>indic.fact</code></td>
<td>
<p>0-1 matrix to indicate the factors associated with each factorial effect</p>
</td></tr>
<tr><td><code>Hpredict</code></td>
<td>
<p>empty (kept for compatibility reasons)</p>
</td></tr>
<tr><td><code>outputkept</code></td>
<td>
<p>if <code> analysis.args$keep.outputs=TRUE</code>, list of the outputs returned by the sensitivity analysis performed on each variable</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>list with first element <code>analysis="sensitivity"</code> and second element <code>fct</code> storing the class name of the argument <code>plan</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Test case : the Winter Wheat Dynamic Models (WWDM)
library(sensitivity) # to use fast99
# input factors design
data(biomasseX)
# input climate variable
data(Climat)

# example of the sensitivity:fast99 function
# design
newplan &lt;- fast99(model = NULL, factors = names(biomasseX), n = 100, 
            q = "qunif", q.arg = list(list(min = 0.9, max = 2.8),
                         list(min = 0.9, max = 0.99),
                         list(min = 0.6, max = 0.8),
                         list(min = 3, max = 12),
                         list(min = 0.0035, max = 0.01),
                         list(min = 0.0011, max = 0.0025),
                         list(min = 700, max = 1100)))
# simulations
wwdm.Y &lt;- simulmodel(model=biomasse, plan=newplan$X, climdata=Climat)
# analysis
res &lt;- analysis.sensitivity(data.frame(wwdm.Y), plan=newplan, nbcomp=4)
</code></pre>

<hr>
<h2 id='basis.ACP'>
A function to decompose multivariate data by principal components analysis (PCA)
</h2><span id='topic+basis.ACP'></span>

<h3>Description</h3>

<p>The <code>basis.ACP</code> function decomposes a multivariate data set according to principal components analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basis.ACP(simuls, basis.args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basis.ACP_+3A_simuls">simuls</code></td>
<td>
<p>a data.frame of size <code>N x T</code>, typically a set of <code>N</code> simulation outputs  of length <code>T</code>.
</p>
</td></tr>
<tr><td><code id="basis.ACP_+3A_basis.args">basis.args</code></td>
<td>
<p>an empty list of arguments for the PCA decomposition. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses <code><a href="stats.html#topic+prcomp">prcomp</a></code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>H</code></td>
<td>
<p>a data.frame of size <code>N x T</code>, containing the coefficients of the PCA decomposition. It is equal to the <code>x</code> output of function <code><a href="stats.html#topic+prcomp">prcomp</a></code>.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>a matrix of size <code>T x T</code>. It contains the eigenvectors of the PCA decomposition.</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>list with the element <code>reduction="pca"</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+prcomp">prcomp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biomasseY)
res &lt;- basis.ACP(biomasseY)

</code></pre>

<hr>
<h2 id='basis.bsplines'>
A function to decompose multivariate data on a B-spline basis
</h2><span id='topic+basis.bsplines'></span>

<h3>Description</h3>

<p>The <code>basis.bsplines</code> function decomposes a multivariate data set on a B-spline basis defined by its knots and mdegree parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basis.bsplines(simuls, basis.args = list(knots = 5, mdegree = 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basis.bsplines_+3A_simuls">simuls</code></td>
<td>
<p>a data.frame of size <code>N x T</code>, typically a set of <code>N</code> simulation outputs of length <code>T</code>.
</p>
</td></tr>
<tr><td><code id="basis.bsplines_+3A_basis.args">basis.args</code></td>
<td>
<p>a list of arguments for the B-spline decomposition. The <code>knots</code> argument is the number of knots or the vector of knot positions. The <code>mdegree</code> argument is the polynomial degree. For the optional <code>x.coord</code> argument, see the Details section.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optional <code>x.coord</code> element of the list in <code>basis.args</code> can
be used to specify the support of the B-spline decomposition, if
different from <code>1:T</code>. It must be a vector of length <code>T</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>H</code></td>
<td>
<p>a data.frame of size <code>N x d</code>, where <code>d</code> is the dimension of the B-spline decomposition. It contains the coefficients of the decomposition for each row of the <code>simuls</code> data.frame.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>a matrix of size <code>T x d</code>. It contains the vectors of the B-spline basis.</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>list with the element <code>reduction="b-splines"</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+bspline">bspline</a></code>, <code><a href="#topic+sesBsplinesNORM">sesBsplinesNORM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biomasseY)

res &lt;- basis.bsplines(biomasseY,basis.args=list(knots=7,mdegree=3))

</code></pre>

<hr>
<h2 id='basis.mine'>
A function to decompose multivariate data on a user-defined basis
</h2><span id='topic+basis.mine'></span>

<h3>Description</h3>

<p>The <code>basis.mine</code> function decomposes a multivariate data set on a user-defined basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basis.mine(simuls, basis.args = list(
        baseL=1*outer(sort(0:(ncol(simuls)-1)%%5),0:4,"==") ) )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basis.mine_+3A_simuls">simuls</code></td>
<td>
<p>a data.frame of size <code>N x T</code>, typically a set of <code>N</code> simulation outputs of length <code>T</code>.
</p>
</td></tr>
<tr><td><code id="basis.mine_+3A_basis.args">basis.args</code></td>
<td>
<p>a list of arguments for the polynomial decomposition. The <code>baseL</code> argument is a matrix of size <code>T x d</code> containing the coordinates of the <code>d</code> basis vectors.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The default <code>basis.args</code> argument generates a projection on a moving-average basis. But if in the <code><a href="#topic+multisensi">multisensi</a></code> function this <code>basis.args</code> argument is not given for <code>reduction=basis.mine</code>, the execution will be stopped.
</p>


<h3>Value</h3>

<table>
<tr><td><code>H</code></td>
<td>
<p>a data.frame of size <code>N x d</code>, where <code>d</code> is the number of basis vectors. It contains the coefficients of the decomposition for each row of the <code>simuls</code> data.frame.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>a matrix of size <code>T x d</code>. It contains the vectors of the user-defined basis.</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>list with the element <code>reduction="matrix"</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(biomasseY)
M &lt;- 1*outer(sort(0:(ncol(biomasseY)-1)%%5),0:4,"==")
norm.M &lt;- sqrt(colSums(M^2)) 
for (i in 1:ncol(M)){
    M[,i]=M[,i]/norm.M[i]
}

res &lt;- basis.mine(biomasseY, basis.args=list(baseL=M))

</code></pre>

<hr>
<h2 id='basis.osplines'>
A function to decompose multivariate data on an orthogonal B-spline basis (O-spline)
</h2><span id='topic+basis.osplines'></span>

<h3>Description</h3>

<p>The <code>basis.osplines</code> function decomposes a multivariate data set on an orthogonalised B-spline (or O-spline) basis defined by its knots and mdegree parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basis.osplines(simuls, basis.args = list(knots = 5, mdegree = 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basis.osplines_+3A_simuls">simuls</code></td>
<td>
<p>a data.frame of size <code>N x T</code>, typically a set of <code>N</code> simulation outputs of length <code>T</code>.
</p>
</td></tr>
<tr><td><code id="basis.osplines_+3A_basis.args">basis.args</code></td>
<td>
<p>a list of arguments for the O-spline decomposition. The <code>knots</code> argument is the number of knots or the vector of knot positions. The <code>mdegree</code> argument is the polynomial degree. For the optional <code>x.coord</code> argument, see the Details section.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optional <code>x.coord</code> element of the list in <code>basis.args</code> can be used to specify the support of the O-spline decomposition, if different from <code>1:T</code>. It must be a vector of length <code>T</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>H</code></td>
<td>
<p>a data.frame of size <code>N x d</code>, where <code>d</code> is the dimension of the O-spline decomposition. It contains the coefficients of the decomposition for each row of the <code>simuls</code> data.frame.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>a matrix of size <code>T x d</code>. It contains the vectors of the O-spline basis.</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>list with the element <code>reduction="o-splines"</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+bspline">bspline</a></code>,
<code><a href="#topic+sesBsplinesORTHONORM">sesBsplinesORTHONORM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biomasseY)

res &lt;- basis.osplines(biomasseY,basis.args=list(knots=7,mdegree=3))

</code></pre>

<hr>
<h2 id='basis.poly'>
A function to decompose multivariate data on a polynomial basis
</h2><span id='topic+basis.poly'></span>

<h3>Description</h3>

<p>The <code>basis.poly</code> function decomposes a multivariate data set on a polynomial basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basis.poly(simuls, basis.args = list(degree = 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basis.poly_+3A_simuls">simuls</code></td>
<td>
<p>a data.frame of size <code>N x T</code>, typically a set of <code>N</code> simulation outputs of length <code>T</code>.
</p>
</td></tr>
<tr><td><code id="basis.poly_+3A_basis.args">basis.args</code></td>
<td>
<p>a list of arguments for the polynomial decomposition. The <code>degree</code> argument is the maximum degree of the polynomial basis. For the optional <code>x.coord</code> argument, see the Details section.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses <code><a href="stats.html#topic+poly">poly</a></code>. The optional <code>x.coord</code> element of the list in <code>basis.args</code> can be used to specify the support of the polynomial decomposition, if different from <code>1:T</code>. It must be a vector of length <code>T</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>H</code></td>
<td>
<p>a data.frame of size <code>N x (d+1)</code>, where <code>d</code> is the degree of the polynomial decomposition. It contains the coefficients of the decomposition for each row of the <code>simuls</code> data.frame.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>a matrix of size <code>T x (d+1)</code>. It contains the vectors of the polynomial basis.</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>list with the element <code>reduction="polynomial"</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+poly">poly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biomasseY)

res &lt;- basis.poly(biomasseY,basis.args=list(degree=3))

</code></pre>

<hr>
<h2 id='biomasse'>The Winter Wheat Dynamic Model</h2><span id='topic+biomasse'></span>

<h3>Description</h3>

<p>The Winter Wheat Dynamic Model, a toy model to illustrate the main
multisensi methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biomasse(input, climdata, annee = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="biomasse_+3A_input">input</code></td>
<td>
<p>vector of input values.</p>
</td></tr>
<tr><td><code id="biomasse_+3A_annee">annee</code></td>
<td>
<p>year.</p>
</td></tr>
<tr><td><code id="biomasse_+3A_climdata">climdata</code></td>
<td>
<p>a meteorological data.frame specific to biomasse.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Winter Wheat Dry Matter model (WWDM) is a dynamic crop model
running at a daily time step (Makowski et al, 2004). It has two state
variables, the above-ground winter wheat dry matter <code class="reqn">U(t)</code>, in <code class="reqn">g/m^2</code>
and the leaf area index LAI(<code class="reqn">t</code>) with <code class="reqn">t</code> the day number from sowing
(<code class="reqn">t=1</code>) to harvest (<code class="reqn">t=223</code>). In the <span class="pkg">multisensi</span> package implementation, the
<code>biomasse</code> function simulates the output for only one parameter set (the
first row of <code>input</code> if it is a matrix or a data.frame).
</p>


<h3>Value</h3>

<p>a vector of daily dry matter increase of the Winter Wheat biomass, over
223 days
</p>


<h3>References</h3>

<p>Makowski, D., Jeuffroy, M.-H., Gu\'erif, M., 2004 Bayesian methods for
updating crop model predictions, applications for predicting biomass and
grain protein content. In: Bayesian Statistics and Quality Modelling in
the Agro-Food Production Chain (van Boeakel et al. eds), pp. 57-68.
Kluwer, Dordrecht
</p>
<p>Monod, H., Naud, C., Makowski, D., 2006 Uncertainty and sensitivity
analysis for crop models. In: Working with Dynamic Crop Models (Wallach
D., Makowski D. and Jones J. eds), pp. 55-100. Elsevier, Amsterdam</p>

<hr>
<h2 id='biomasseX'>A factorial input design for the main example</h2><span id='topic+biomasseX'></span>

<h3>Description</h3>

<p>Factorial design (resolution V) data for the 7 WWDM model input factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(biomasseX)</code></pre>


<h3>Format</h3>

<p>A data frame with 2187 observations on the following 7 variables.
</p>

<dl>
<dt><code>Eb</code></dt><dd><p>First WWDM input factor name</p>
</dd>
<dt><code>Eimax</code></dt><dd><p>Second WWDM input factor name</p>
</dd>
<dt><code>K</code></dt><dd><p>Thirth WWDM input factor name</p>
</dd>
<dt><code>Lmax</code></dt><dd><p>Fourth WWDM input factor name</p>
</dd>
<dt><code>A</code></dt><dd><p>Fifth WWDM input factor name</p>
</dd>
<dt><code>B</code></dt><dd><p>Sixth WWDM input factor name</p>
</dd>
<dt><code>TI</code></dt><dd><p>Seventh WWDM input factor name</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+biomasse">biomasse</a></code>, <code><a href="#topic+biomasseY">biomasseY</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biomasseX)
## maybe str(biomasseX) ; plot(biomasseX) ...
</code></pre>

<hr>
<h2 id='biomasseY'>Output of the biomasse model for the plan provided in the package</h2><span id='topic+biomasseY'></span>

<h3>Description</h3>

<p>Simplified output of the biomasse model (one column per
decade), especially generated for examples in the package help files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(biomasseY)</code></pre>


<h3>Format</h3>

<p>A data frame with 2187 rows and 22 output variables (one per decade).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+biomasse">biomasse</a></code>, <code><a href="#topic+biomasseX">biomasseX</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biomasseY)
dim(biomasseY)
</code></pre>

<hr>
<h2 id='bspline'>
function to evaluate B-spline basis functions
</h2><span id='topic+bspline'></span>

<h3>Description</h3>

<p>The <code>bspline</code> function evaluates ith B-spline basis function of order m at the values in x, given knot locations in k
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bspline(x = seq(0, 1, len = 101), k = knots, i = 1, m = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bspline_+3A_x">x</code></td>
<td>

<p>vector or scalar, coordinate where to calculate the B-spline functions
</p>
</td></tr>
<tr><td><code id="bspline_+3A_k">k</code></td>
<td>

<p>vector of knot locations
</p>
</td></tr>
<tr><td><code id="bspline_+3A_i">i</code></td>
<td>
<p>integer; from 0 to length(knots)+1-m
</p>
</td></tr>
<tr><td><code id="bspline_+3A_m">m</code></td>
<td>
<p>integer, degree of the B-Splines
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> B-splines are defined by recursion :
<code class="reqn">b_{i,0}(x) = 1</code> if <code class="reqn">k_j \leq x &lt; k_{j+1}</code> ; 0 else. 
</p>
<p style="text-align: center;"><code class="reqn">b_{i,m}(x) = \frac{x-k_i}{k_{i+m}-k_i} b_{i,m-1}(x) + \frac{k_{i+m+1}-x}{k_{i+m+1}-k_{i+1}} b_{i+1,m-1}(x)</code>
</p>



<h3>Value</h3>

<p>values in x of the ith B-spline basis function of order m
</p>


<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span> package</p>


<h3>References</h3>

<p>Wood Simon, 2006. <em>Generalized Additive Models: An Introduction with R</em> Chapman and Hall/CRC.
</p>

<hr>
<h2 id='Climat'>Climate data</h2><span id='topic+Climat'></span>

<h3>Description</h3>

<p>Climate data for the WWDM model (needed by the <code>biomasse</code> function)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Climat)</code></pre>


<h3>Format</h3>

<p>A data frame with 3126 observations on the following 4 variables.
</p>

<dl>
<dt><code>ANNEE</code></dt><dd><p>a factor with levels 1 to 14, indicating 14
different years</p>
</dd>
<dt><code>RG</code></dt><dd><p>daily radiation variable</p>
</dd>
<dt><code>Tmin</code></dt><dd><p>daily maximum temperature</p>
</dd>
<dt><code>Tmax</code></dt><dd><p>daily minimum temperature</p>
</dd>
</dl>



<h3>Source</h3>

<p>Makowski, D., Jeuffroy, M.-H., Gu\'erif, M., 2004 Bayesian methods for
updating crop model predictions, applications for predicting biomass and
grain protein content. In: Bayesian Statistics and Quality Modelling in
the Agro-Food Production Chain (van Boeakel et al. eds), pp. 57-68.
Kluwer, Dordrecht.
</p>
<p>Monod, H., Naud, C., Makowski, D., 2006 Uncertainty and sensitivity
analysis for crop models. In: Working with Dynamic Crop Models (Wallach
D., Makowski D. and Jones J. eds), pp. 55-100. Elsevier, Amsterdam
</p>

<hr>
<h2 id='dynsi'>Dynamic Sensitivity Indices: DSI</h2><span id='topic+dynsi'></span>

<h3>Description</h3>

<p>dynsi implements the Dynamic Sensitivity Indices. This method
allows to compute classical Sensitivity Indices on each output
variable of a dynamic or multivariate model by using the ANOVA
decomposition</p>


<h3>Usage</h3>

<pre><code class='language-R'>dynsi(formula, model, factors, cumul = FALSE, simulonly=FALSE,
      nb.outp = NULL, Name.File=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dynsi_+3A_formula">formula</code></td>
<td>
<p>ANOVA formula like <code>"A+B+c+A:B"</code> OR an integer equal to the
maximum interaction order in the sensitivity model.</p>
</td></tr>
<tr><td><code id="dynsi_+3A_model">model</code></td>
<td>
<p>output data.frame OR the name of the R-function which
calculates the model output. The only argument of this function
must be a vector containing the input factors values.</p>
</td></tr>
<tr><td><code id="dynsi_+3A_factors">factors</code></td>
<td>
<p>input data.frame (the design) if model is a data.frame
OR a list of factors levels such as
<code>factor.example &lt;- list(A=c(0,1),B=c(0,1,4))</code>.</p>
</td></tr>
<tr><td><code id="dynsi_+3A_cumul">cumul</code></td>
<td>
<p>logical value. If TRUE the sensitivity analysis will be
done on the cumalative outputs.</p>
</td></tr>
<tr><td><code id="dynsi_+3A_simulonly">simulonly</code></td>
<td>
<p>logical value. If TRUE the program stops after
calculating the design and the model outputs.</p>
</td></tr>
<tr><td><code id="dynsi_+3A_nb.outp">nb.outp</code></td>
<td>
<p>The first nb.outp number of model outputs to be
considered. If NULL all the outputs are considered.</p>
</td></tr>
<tr><td><code id="dynsi_+3A_name.file">Name.File</code></td>
<td>
<p>optional name of a R script file containing the
R-function that calculates the simulation model. e.g  <code>"exc.ssc"</code>.</p>
</td></tr>
<tr><td><code id="dynsi_+3A_...">...</code></td>
<td>
<p>possible fixed parameters of the model function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>factors</code> is a list of factors, the dynsi function generates a complete
factorial design. If it is a data.frame, dynsi expects that each column is
associated with an input factor.
</p>


<h3>Value</h3>

<p>dynsi returns a list of class &quot;dynsi&quot; containing the following components:
</p>
<table>
<tr><td><code>X</code></td>
<td>
<p>a data.frame containing the experimental design (input samples)</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>a data.frame containing the output (response)</p>
</td></tr>
<tr><td><code>SI</code></td>
<td>
<p>a data.frame containing  the Sensitivity Indices (SI) on each
output variable of the model and the Generalised SI (GSI)</p>
</td></tr>
<tr><td><code>mSI</code></td>
<td>
<p>a data.frame of first order SI on each output variable and first order GSI</p>
</td></tr>
<tr><td><code>tSI</code></td>
<td>
<p>a data.frame containing the total SI on each output variable and the total GSI</p>
</td></tr>
<tr><td><code>iSI</code></td>
<td>
<p>a data.frame of interaction SI on each output variable and interaction GSI</p>
</td></tr>
<tr><td><code>Att</code></td>
<td>
<p>0-1 matrix of association between input factors and
factorial terms in the anovas</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>a list containing informations on the process (reduction=NULL, analysis, fct, call)</p>
</td></tr>
<tr><td><code>inputdesign</code></td>
<td>
<p>either the input data.frame or the sensitivity object used</p>
</td></tr>
<tr><td><code>outputs</code></td>
<td>
<p>a list of results on each output variable</p>
</td></tr>
</table>
<p>...
</p>


<h3>Note</h3>

<p>This function can now be replaced by a call to the <code><a href="#topic+multisensi">multisensi</a></code> function. It is kept for compatibility with Version 1 of the <span class="pkg">multisensi</span> package.</p>


<h3>References</h3>

<p>M. Lamboni, D. Makowski and H. Monod, 2009. Multivariate
global sensitivity analysis for dynamic crop models.
Field Crops Research, 113, 312-320.
</p>
<p>A. Saltelli, K. Chan and E. M. Scott eds, 2000. <em>Sensitivity
Analysis</em>. Wiley, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gsi">gsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Test case : the Winter Wheat Dynamic Models (WWDM)
# input factors design,
 data(biomasseX)
# input Climate variables
 data(Climat)
# output variables (precalculated to speed up the example)
 data(biomasseY)
#
 DYNSI &lt;- dynsi(2, biomasseY, biomasseX)
 summary(DYNSI)
 print(DYNSI)
 plot(DYNSI, color=heat.colors)
 #graph.bar(DYNSI,col=1, beside=F)  # sensitivity bar plot
                                    # for the first output (col=1)
 #graph.bar(DYNSI,col=2, xmax=1)    #
  </code></pre>

<hr>
<h2 id='graph.bar'>Sensitivity index bar plot</h2><span id='topic+graph.bar'></span>

<h3>Description</h3>

<p>A function that plots sensitivity indices by a bar graph
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graph.bar(x, col = 1, nb.plot = 15, xmax = NULL,
          beside = TRUE, xlab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graph.bar_+3A_x">x</code></td>
<td>
<p>an object of class gsi or dynsi</p>
</td></tr>
<tr><td><code id="graph.bar_+3A_col">col</code></td>
<td>
<p>the column number of GSI to represent in the bar graph</p>
</td></tr>
<tr><td><code id="graph.bar_+3A_nb.plot">nb.plot</code></td>
<td>
<p>number of input factors to be considered</p>
</td></tr>
<tr><td><code id="graph.bar_+3A_xmax">xmax</code></td>
<td>
<p>a user-defined maximal <code class="reqn">x</code> value (<code class="reqn">x\leq 1</code>) in
all the bar graphs that show sensitivity indices; or NULL if the user
wants to keep default values</p>
</td></tr>
<tr><td><code id="graph.bar_+3A_beside">beside</code></td>
<td>
<p>if TRUE, the main and total sensitivity indices are
represented by two bars; if FALSE, they are represented by the same bar</p>
</td></tr>
<tr><td><code id="graph.bar_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis</p>
</td></tr>
<tr><td><code id="graph.bar_+3A_...">...</code></td>
<td>
<p>graphical parameters</p>
</td></tr>
</table>

<hr>
<h2 id='graph.pc'>Principal Components graph for gsi objects</h2><span id='topic+graph.pc'></span>

<h3>Description</h3>

<p>A function that plots the Principal Components (PCs) and the
sensitivity indices on each PC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graph.pc(x, nb.plot = 15, nb.comp = NULL, xmax = NULL,
         beside = TRUE, cor.plot=FALSE, xtick=TRUE, type="l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graph.pc_+3A_x">x</code></td>
<td>
<p>gsi object.</p>
</td></tr>
<tr><td><code id="graph.pc_+3A_nb.plot">nb.plot</code></td>
<td>
<p>number of input factors to be considered.</p>
</td></tr>
<tr><td><code id="graph.pc_+3A_nb.comp">nb.comp</code></td>
<td>
<p>number of PCs.</p>
</td></tr>
<tr><td><code id="graph.pc_+3A_xmax">xmax</code></td>
<td>
<p>a user-defined maximal <code class="reqn">x</code> value (<code class="reqn">x\leq 1</code>) in
all the bar graphs that show sensitivity indices; or NULL if the user
wants to keep default values.</p>
</td></tr>
<tr><td><code id="graph.pc_+3A_beside">beside</code></td>
<td>
<p>if TRUE, the main and total sensitivity indices are
represented by two bars; if FALSE, they are represented by the same bar.</p>
</td></tr>
<tr><td><code id="graph.pc_+3A_cor.plot">cor.plot</code></td>
<td>
<p>if TRUE a correlation graph is made to represent the PCs ; if FALSE (default) a functionnal boxplot of the PCs is plotted.</p>
</td></tr>
<tr><td><code id="graph.pc_+3A_xtick">xtick</code></td>
<td>
<p>if TRUE, put column names of outputs (Y) as ticks for the x axis.</p>
</td></tr>
<tr><td><code id="graph.pc_+3A_type">type</code></td>
<td>
<p>what type of plot should be drawn for correlation graph (&quot;l&quot; for lines).</p>
</td></tr>
<tr><td><code id="graph.pc_+3A_...">...</code></td>
<td>
<p>graphical parameters.</p>
</td></tr>
</table>

<hr>
<h2 id='grpe.gsi'>Group factor GSI, obsolete function</h2><span id='topic+grpe.gsi'></span>

<h3>Description</h3>

<p>An obsolete function that computed the GSI of a group factor as one factor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grpe.gsi(GSI, fact.interet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grpe.gsi_+3A_gsi">GSI</code></td>
<td>
<p>a gsi or dynsi object</p>
</td></tr>
<tr><td><code id="grpe.gsi_+3A_fact.interet">fact.interet</code></td>
<td>
<p>input factor to be grouped</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span> package</p>

<hr>
<h2 id='gsi'>Generalised Sensitivity Indices: GSI</h2><span id='topic+gsi'></span>

<h3>Description</h3>

<p>The gsi function implements the calculation of Generalised Sensitivity
Indices. This method allows to compute a synthetic Sensitivity Index for
the dynamic or multivariate models by using factorial designs and the
MANOVA decomposition of inertia. It computes also the Sensitivity
Indices on principal components</p>


<h3>Usage</h3>

<pre><code class='language-R'>gsi(formula, model, factors, inertia = 0.95, normalized = TRUE,
    cumul = FALSE, simulonly = FALSE, Name.File = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gsi_+3A_formula">formula</code></td>
<td>
<p>ANOVA formula like <code>"A+B+C+A:B"</code> OR an integer equal to the
maximum interaction order in the sensitivity model</p>
</td></tr>
<tr><td><code id="gsi_+3A_model">model</code></td>
<td>
<p>output data.frame OR the name of the R-function which
calculates the model output. The only argument of this function
must be a vector containing the input factors values</p>
</td></tr>
<tr><td><code id="gsi_+3A_factors">factors</code></td>
<td>
<p>input data.frame (the design) if model is a data.frame
OR a list of factors levels such as :
<code>factor.example &lt;- list(A=c(0,1),B=c(0,1,4))</code></p>
</td></tr>
<tr><td><code id="gsi_+3A_inertia">inertia</code></td>
<td>
<p>cumulated proportion of inertia (a scalar <code class="reqn">&lt; 1</code>) to be
explained by the selected Principal components OR number of PCs to
be used (e.g 3)</p>
</td></tr>
<tr><td><code id="gsi_+3A_normalized">normalized</code></td>
<td>
<p>logical value. TRUE (default) computes a normalized
Principal Component analysis.</p>
</td></tr>
<tr><td><code id="gsi_+3A_cumul">cumul</code></td>
<td>
<p>logical value. If TRUE the PCA will be done on the cumulative outputs</p>
</td></tr>
<tr><td><code id="gsi_+3A_simulonly">simulonly</code></td>
<td>
<p>logical value.  If TRUE the program stops after
calculating the design and the model outputs</p>
</td></tr>
<tr><td><code id="gsi_+3A_name.file">Name.File</code></td>
<td>
<p>optional name of a R script file containing the
R-function that calculates the simulation model. e.g  <code>"exc.ssc"</code></p>
</td></tr>
<tr><td><code id="gsi_+3A_...">...</code></td>
<td>
<p>possible fixed parameters of the model function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If factors is a list of factors, the gsi function generates a complete
factorial design. If it is a data.frame, gsi expects that each column is
associated with an input factor.
</p>


<h3>Value</h3>

<p>gsi returns a list of class &quot;gsi&quot;, containing all the input arguments detailed before, plus
the following components:
</p>
<table>
<tr><td><code>X</code></td>
<td>
<p>a data.frame containing the experimental design (input samples)</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>a data.frame containing the output matrix (response)</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>a data.frame containing the principal components</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>a data.frame whose columns contain the basis eigenvectors (the variable loadings)</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>the variances of the principal components</p>
</td></tr>
<tr><td><code>inertia</code></td>
<td>
<p>vector of inertia percentages per PCs and global criterion</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>a data.frame of correlation between PCs and outputs</p>
</td></tr>
<tr><td><code>SI</code></td>
<td>
<p>a data.frame containing  the Sensitivity Indices (SI) on PCs
and the Generalised SI (GSI)</p>
</td></tr>
<tr><td><code>mSI</code></td>
<td>
<p>a data.frame of first order SI on PCs and first order GSI</p>
</td></tr>
<tr><td><code>tSI</code></td>
<td>
<p>a data.frame containing the total SI on PCs and the total GSI</p>
</td></tr>
<tr><td><code>iSI</code></td>
<td>
<p>a data.frame of interaction SI on PCs and interaction GSI</p>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>a data.frame containing the output predicted by the
metamodel arising from the PCA and anova decompositions</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>a data.frame containing the residuals between actual
and predicted outputs</p>
</td></tr>
<tr><td><code>Rsquare</code></td>
<td>
<p>vector of dynamic coefficient of determination</p>
</td></tr>
<tr><td><code>Att</code></td>
<td>
<p>0-1 matrix of association between input factors and
factorial terms in the anovas</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>logical value, see the arguments</p>
</td></tr>
<tr><td><code>normalized</code></td>
<td>
<p>logical value, see the arguments</p>
</td></tr>
<tr><td><code>cumul</code></td>
<td>
<p>logical value, see the arguments</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>a list containing informations on the process (reduction, analysis, fct, call)</p>
</td></tr>
<tr><td><code>inputdesign</code></td>
<td>
<p>either the input data.frame or the sensitivity object used</p>
</td></tr>
<tr><td><code>outputs</code></td>
<td>
<p>a list of results on each output variable</p>
</td></tr>
</table>
<p>...
</p>


<h3>Note</h3>

<p>This function can now be replaced by a call to the <code><a href="#topic+multisensi">multisensi</a></code> function. It is kept for compatibility with Version 1 of the <span class="pkg">multisensi</span> package.</p>


<h3>References</h3>

<p>M. Lamboni, D. Makowski and H. Monod, 2009. Multivariate
global sensitivity analysis for dynamic
crop models. Field Crops Research, volume 113.  pp. 312-320
</p>
<p>M. Lamboni, D. Makowski and H. Monod, 2009. Multivariate sensitivity analysis to measure global
contribution of input factors in dynamic models. Submitted
to Reliability Engineering  and System Safety.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dynsi">dynsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Test case : the Winter Wheat Dynamic Models (WWDM)
#  input factors design
 data(biomasseX)
# input climate variable
 data(Climat)
# output variables (precalculated to speed up the example)
 data(biomasseY)
#
 GSI &lt;- gsi(2, biomasseY, biomasseX, inertia=3, normalized=TRUE, cumul=FALSE,
            climdata=Climat)
 summary(GSI)
 print(GSI)
 plot(x=GSI, beside=FALSE)
 #plot(GSI, nb.plot=4)         # the 'nb.plot' most influent factors
                               # are represented in the plots
 #plot(GSI,nb.comp=2, xmax=1)  # nb.comp = number of principal components
 #plot(GSI,nb.comp=3, graph=1) # graph=1 for first figure; 2 for 2nd one
                               # and 3 for 3rd one; or 1:3 etc.
 #graph.bar(GSI,col=1, beside=F)  # sensitivity bar plot on the first PC
 #graph.bar(GSI,col=2, xmax=1)    #
  </code></pre>

<hr>
<h2 id='multisensi'>
A function with multiple options to perform multivariate sensitivity analysis
</h2><span id='topic+multisensi'></span>

<h3>Description</h3>

<p>The <code>multisensi</code> function can conduct the different steps of a multivariate sensitivity analysis (design, simulation, dimension reduction, analysis, plots). It includes different options for each of these steps. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multisensi(design = expand.grid, model, reduction = basis.ACP, 
           dimension = 0.95, center = TRUE, scale = TRUE, 
           analysis = analysis.anoasg, cumul = FALSE, 
           simulonly = FALSE, Name.File = NULL, 
           design.args = list(), basis.args = list(), 
           analysis.args = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multisensi_+3A_design">design</code></td>
<td>
<p>EITHER a function such as expand.grid to generate the design OR a data.frame of size <code>N x P</code> containing <code>N</code> combinations of levels of the <code>P</code> input factors OR a function from the <span class="pkg">sensitivity</span> package such as fast99 OR an object generated by a function from the <span class="pkg">sensitivity</span> package. The first and third cases require additional information to be given in the <code>design.args</code> argument. 
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_model">model</code></td>
<td>
<p>EITHER a function to run the model simulations OR a data.frame of size <code>N x T</code> containing <code>N</code> realizations of <code>T</code> output variables.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_reduction">reduction</code></td>
<td>
<p>EITHER a function to decompose the multivariate output on a basis of smaller dimension OR <code>NULL</code>. The first case requires additional information to be given in the <code>basis.args</code> argument. In the second case, sensitivity analyses are performed on the raw output variables.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_dimension">dimension</code></td>
<td>
<p>EITHER the number of variables to analyse, specified by an integer or by the minimal proportion of inertia (a scalar &lt; 1) to keep in the output decomposition OR a vector specifying a subset of columns in the output data.frame OR NULL if all variables must be analysed. 
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_center">center</code></td>
<td>
<p>logical value. If TRUE (default value) the output variables are centred.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_scale">scale</code></td>
<td>
<p>logical value. If TRUE (default value) the output variables are normalized before applying the reduction function.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_analysis">analysis</code></td>
<td>
<p>a function to run the sensitivity analysis. Additional information can be given in the <code>analysis.args</code> argument. 
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_cumul">cumul</code></td>
<td>
<p>logical value. If TRUE the output variables are replaced by their cumulative sums.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_simulonly">simulonly</code></td>
<td>
<p>logical value.  If TRUE the program stops after the model simulations.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_name.file">Name.File</code></td>
<td>
<p>Name of file containing the R-function model.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_design.args">design.args</code></td>
<td>
<p>a list of arguments for the function possibly given in the <code>design</code> argument.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_basis.args">basis.args</code></td>
<td>
<p>a list of arguments for the function given in the <code>reduction</code> argument. See the function help for more precision.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_analysis.args">analysis.args</code></td>
<td>
<p>a list of arguments for the function possibly given in the <code>analysis</code> argument. See the function help for more precision.
</p>
</td></tr>
<tr><td><code id="multisensi_+3A_...">...</code></td>
<td>
<p>optional parameters of the function possibly given in the <code>model</code> argument.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code><a href="#topic+dynsi">dynsi</a></code> if <code>reduction=NULL</code>, otherwise an object of class <code><a href="#topic+gsi">gsi</a></code>. See the functions <code><a href="#topic+dynsi">dynsi</a></code>  and <code><a href="#topic+gsi">gsi</a></code> for more information.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dynsi">dynsi</a></code>, <code><a href="#topic+gsi">gsi</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Test case : the Winter Wheat Dynamic Models (WWDM)
#  input factors design
 data(biomasseX)
# input climate variable
 data(Climat)
# output variables (precalculated to speed up the example)
 data(biomasseY)

# to do dynsi process
# argument reduction=NULL
resD &lt;- multisensi(design=biomasseX, model=biomasseY, reduction=NULL,
                 dimension=NULL, analysis=analysis.anoasg,
                 analysis.args=list(formula=2,keep.outputs = FALSE))
summary(resD)


# to do gsi process
#------------
# with dimension reduction by PCA
# argument reduction=basis.ACP
resG1 &lt;- multisensi(design=biomasseX, model=biomasseY, reduction=basis.ACP,
                   dimension=0.95, analysis=analysis.anoasg,
                   analysis.args=list(formula=2,keep.outputs = FALSE))
summary(resG1)

plot(x=resG1, beside=FALSE)

#------------
# with dimension reduction by o-splines basis
# arguments reduction=basis.osplines
# and basis.args=list(knots= ... , mdegree= ... )

resG2 &lt;- multisensi(design=biomasseX, model=biomasseY, reduction=basis.osplines,
                   dimension=NULL, center=FALSE, scale=FALSE,
                   basis.args=list(knots=11, mdegree=3), analysis=analysis.anoasg, 
                   analysis.args=list(formula=2,keep.outputs = FALSE))
summary(resG2)

#------------
library(sensitivity) # to use fast99

# with dimension reduction by o-splines basis
# and sensitivity analysis with sensitivity:fast99
resG3 &lt;- multisensi(design=fast99, model=biomasse,
                   analysis=analysis.sensitivity, 
                   design.args=list(factors = names(biomasseX), n = 100,
                   q = "qunif", q.arg = list(list(min = 0.9, max = 2.8),
                   list(min = 0.9, max = 0.99), list(min = 0.6, max = 0.8), 
                   list(min = 3, max = 12), list(min = 0.0035, max = 0.01),
                   list(min = 0.0011, max = 0.0025),
                   list(min = 700, max = 1100))), climdata=Climat,
                   reduction=basis.osplines,
                   basis.args=list(knots=7, mdegree=3),
                   center=FALSE,scale=FALSE,dimension=NULL)
summary(resG3)

</code></pre>

<hr>
<h2 id='multivar'>
A function to decompose the output data set and reduce its dimension
</h2><span id='topic+multivar'></span>

<h3>Description</h3>

<p>The function <code>multivar</code> applies a multivariate method
to decompose the output variables on a given basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multivar(simuls, dimension = NULL, reduction, centered = TRUE, 
         scale = TRUE, basis.args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multivar_+3A_simuls">simuls</code></td>
<td>
<p>a data.frame of size <code>N x T</code>, typically a set of <code>N</code> simulation outputs of length <code>T</code>
</p>
</td></tr>
<tr><td><code id="multivar_+3A_dimension">dimension</code></td>
<td>
<p>the number of variables to analyse, specified by an integer (for example 3) or by the minimal proportion of inertia (for example 0.95) to keep in the output decomposition
</p>
</td></tr>
<tr><td><code id="multivar_+3A_reduction">reduction</code></td>
<td>
<p>a function to decompose the multivariate output on a basis of smaller dimension
</p>
</td></tr>
<tr><td><code id="multivar_+3A_centered">centered</code></td>
<td>
<p>logical value. If TRUE the output variables are centred.</p>
</td></tr>
<tr><td><code id="multivar_+3A_scale">scale</code></td>
<td>
<p>logical value. If TRUE the output variables are normalized.</p>
</td></tr>
<tr><td><code id="multivar_+3A_basis.args">basis.args</code></td>
<td>

<p>a list of arguments for the function given in the <code>reduction</code> argument. See the function help for more precision.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>H</code></td>
<td>
<p>a data.frame of size <code>N x d</code>, where <code>d</code> is the number of basis vectors. It contains the coefficients of the decomposition for each row of the <code>simuls</code> data.frame.
</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>a matrix of size <code>T x d</code>. It contains the vectors of the user-defined basis.</p>
</td></tr>
<tr><td><code>sdev</code></td>
<td>
<p>standard deviations of the columns of <code>H</code> </p>
</td></tr>
<tr><td><code>nbcomp</code></td>
<td>
<p>number of components kept from the decomposition</p>
</td></tr>
<tr><td><code>SStot</code></td>
<td>
<p>total sums of squares of the simulations (after application of <code>centered</code> and <code>scale</code>)</p>
</td></tr>
<tr><td><code>centering</code></td>
<td>
<p>either 0 or the column averages of <code>simuls</code></p>
</td></tr>
<tr><td><code>scaling</code></td>
<td>
<p>either 1 or <code>sdY</code>, depending on the <code>scale</code> argument</p>
</td></tr>
<tr><td><code>sdY</code></td>
<td>
<p>standard deviations of the columns of <code>simuls</code></p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>correlation matrix (L*sdev), of size <code>T x nbcomp</code></p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>kept in case the option scale has been changed in the function</p>
</td></tr>
<tr><td><code>importance</code></td>
<td>
<p>cumulated percentage of SS_H (sdev^2) with respect to SStot</p>
</td></tr>
<tr><td><code>call.info</code></td>
<td>
<p>list with the element <code>reduction</code> storing the name of the argument <code>reduction</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+basis.ACP">basis.ACP</a></code>, <code><a href="#topic+basis.bsplines">basis.bsplines</a></code>, <code><a href="#topic+basis.poly">basis.poly</a></code>, <code><a href="#topic+basis.osplines">basis.osplines</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(biomasseY)

res &lt;- multivar(biomasseY, dimension=0.95, reduction=basis.ACP)

</code></pre>

<hr>
<h2 id='planfact'>Complete factorial design in lexical order</h2><span id='topic+planfact'></span>

<h3>Description</h3>

<p>Function that generates a complete factorial design in lexical order
</p>


<h3>Usage</h3>

<pre><code class='language-R'>planfact(nb.niv, make.factor = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="planfact_+3A_nb.niv">nb.niv</code></td>
<td>
<p>vector containing the number of each input levels</p>
</td></tr>
<tr><td><code id="planfact_+3A_make.factor">make.factor</code></td>
<td>
<p>logical value. If TRUE the columns of the output
are of class factor</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>plan</code></td>
<td>
<p>data frame of the complete factorial design</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span> package</p>

<hr>
<h2 id='planfact.as'>Complete factorial design</h2><span id='topic+planfact.as'></span>

<h3>Description</h3>

<p>Computation of a complete factorial design for model input factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>planfact.as(input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="planfact.as_+3A_input">input</code></td>
<td>
<p>list of factor levels</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>comp2</code></td>
<td>
<p>complete factorial design of model input</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span>
package. It is almost equivalent to the function <code><a href="base.html#topic+expand.grid">expand.grid</a></code>.</p>

<hr>
<h2 id='plot.dynsi'>Plot method for dynamic sensitivity results</h2><span id='topic+plot.dynsi'></span>

<h3>Description</h3>

<p>Plot method for dynamic sensitivity results of class dynsi
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dynsi'
plot(x, normalized=FALSE, text.tuning = NULL, shade=FALSE,
                     color=NULL, xtick=TRUE, total.plot=FALSE, gsi.plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dynsi_+3A_x">x</code></td>
<td>
<p>a dynsi object.</p>
</td></tr>
<tr><td><code id="plot.dynsi_+3A_normalized">normalized</code></td>
<td>
<p>logical value, FALSE =&gt; SI plotted within var(Y).</p>
</td></tr>
<tr><td><code id="plot.dynsi_+3A_text.tuning">text.tuning</code></td>
<td>
<p>NULL or a small integer to improve the position of
input factor labels.</p>
</td></tr>
<tr><td><code id="plot.dynsi_+3A_shade">shade</code></td>
<td>
<p>if TRUE, put different shadings to enhance the different
factorial effects in the plot (long).</p>
</td></tr>
<tr><td><code id="plot.dynsi_+3A_color">color</code></td>
<td>
<p>a palette of colors to enhance the different
factorial effects in the plot (for example <code>color=heat.colors</code>).</p>
</td></tr>
<tr><td><code id="plot.dynsi_+3A_xtick">xtick</code></td>
<td>
<p>if TRUE, put column names of outputs (Y) as ticks for the x axis.</p>
</td></tr>
<tr><td><code id="plot.dynsi_+3A_total.plot">total.plot</code></td>
<td>
<p>logical value, TRUE =&gt; a new plot is produced with the total SI.</p>
</td></tr>
<tr><td><code id="plot.dynsi_+3A_gsi.plot">gsi.plot</code></td>
<td>
<p>logical value, TRUE =&gt; a new plot is produced for the Generalised Sensitivity Indice.</p>
</td></tr>
<tr><td><code id="plot.dynsi_+3A_...">...</code></td>
<td>
<p>graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For labels that would be partly positioned outside the plot frame, the argument
&quot;text.tuning&quot; may allow to get a better positioning. If it is equal to
<code class="reqn">n</code>, say, these labels are moved by <code class="reqn">n</code> positions inside the
frame, where 1 position corresponds to 1 output variable on the x-axis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dynsi">dynsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code></p>

<hr>
<h2 id='plot.gsi'>Plot method for generalised sensitivity analysis</h2><span id='topic+plot.gsi'></span>

<h3>Description</h3>

<p>Plot method for generalised sensitivity analysis of class gsi
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gsi'
plot(x, nb.plot = 10, nb.comp = 3, graph = 1:3, xmax=NULL,
                   beside=TRUE, cor.plot=FALSE, xtick=TRUE, type="l",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gsi_+3A_x">x</code></td>
<td>
<p>a gsi object.</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_nb.plot">nb.plot</code></td>
<td>
<p>number of input factors to be considered.</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_nb.comp">nb.comp</code></td>
<td>
<p>number of Principal Components to be plotted.</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_graph">graph</code></td>
<td>
<p>figures number: 1 or 2 or 3. 1 is for plotting the PCs and their sensitivity indices, 2 is for plotting the Generalised Sensitivity Indice, 3 is for plotting the Rsquare.</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_xmax">xmax</code></td>
<td>
<p>a user-defined maximal <code class="reqn">x</code> value (<code class="reqn">x\leq 1</code>) in
all the bar graphs that show sensitivity indices; or NULL if the user
wants to keep default values.</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_beside">beside</code></td>
<td>
<p>if TRUE, the main and total sensitivity indices are
represented by two bars; if FALSE, they are represented by the same bar.</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_cor.plot">cor.plot</code></td>
<td>
<p>if TRUE a correlation graph is made to represent the PCs ; if FALSE (default) a functionnal boxplot of the PCs is plotted.</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_xtick">xtick</code></td>
<td>
<p>if TRUE, put column names of outputs (Y) as ticks for the x axis.</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_type">type</code></td>
<td>
<p>what type of plot should be drawn for correlation graph (&quot;l&quot; for lines).</p>
</td></tr>
<tr><td><code id="plot.gsi_+3A_...">...</code></td>
<td>
<p>graphical parameters.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gsi">gsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code>, <code><a href="#topic+graph.bar">graph.bar</a></code>, <code><a href="#topic+graph.pc">graph.pc</a></code></p>

<hr>
<h2 id='predict.gsi'>
A function to predict multivariate output 
</h2><span id='topic+predict.gsi'></span>

<h3>Description</h3>

<p>The function <code>predict.gsi</code> generates predicted multivariate output for user-specified combinations of levels of the input factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gsi'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.gsi_+3A_object">object</code></td>
<td>
<p>Object of class gsi.</p>
</td></tr>
<tr><td><code id="predict.gsi_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with
which to predict. If omitted, the fitted values are used.
need to be same factors and levels as for obtained the gsi object.</p>
</td></tr>
<tr><td><code id="predict.gsi_+3A_...">...</code></td>
<td>
<p>others parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only available if the <code>gsi</code> object was obtained with analysis.anoasg and analysis.args$keep.outputs=TRUE.</p>


<h3>Value</h3>

<p> a data.frame of predicted values for newdata</p>


<h3>See Also</h3>

<p><code><a href="#topic+gsi">gsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code>, <code><a href="#topic+analysis.anoasg">analysis.anoasg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(biomasseX)
  data(biomasseY)
  x=multisensi(design=biomasseX,model=biomasseY,basis=basis.ACP,
               analysis=analysis.anoasg,
               analysis.args=list(formula=2, keep.outputs=TRUE))
  newdata=as.data.frame(apply(biomasseX,2,unique))
  predict(x,newdata)
</code></pre>

<hr>
<h2 id='print.dynsi'>print DYNSI </h2><span id='topic+print.dynsi'></span>

<h3>Description</h3>

<p>A function to print DYNSI results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dynsi'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.dynsi_+3A_x">x</code></td>
<td>
<p>a dynsi object</p>
</td></tr>
<tr><td><code id="print.dynsi_+3A_...">...</code></td>
<td>
<p>print parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+dynsi">dynsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code></p>

<hr>
<h2 id='print.gsi'>print GSI </h2><span id='topic+print.gsi'></span>

<h3>Description</h3>

<p>function to print GSI results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gsi'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.gsi_+3A_x">x</code></td>
<td>
<p>a gsi object</p>
</td></tr>
<tr><td><code id="print.gsi_+3A_...">...</code></td>
<td>
<p>print parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gsi">gsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code></p>

<hr>
<h2 id='quality'>quality of any approximation</h2><span id='topic+quality'></span>

<h3>Description</h3>

<p>Function that computes the sensitivity quality after making some assumptions about the number of PCs and the number of interactions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quality(echsimul, echsimul.app)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quality_+3A_echsimul">echsimul</code></td>
<td>
<p>model outputs</p>
</td></tr>
<tr><td><code id="quality_+3A_echsimul.app">echsimul.app</code></td>
<td>
<p>Predicted model output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: 
</p>

<dl>
<dt>moy.biais</dt><dd><p>mean of the residuals</p>
</dd>
<dt>residuals</dt><dd><p>biais</p>
</dd>
<dt>coef.det</dt><dd><p>R-square</p>
</dd>
</dl>



<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span> package</p>

<hr>
<h2 id='sesBsplinesNORM'>
normalized B-splines basis functions
</h2><span id='topic+sesBsplinesNORM'></span>

<h3>Description</h3>

<p>The <code>sesBsplinesNORM</code> evaluates B-Splines basis functions at some points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesBsplinesNORM(x = seq(0, 1, len = 101), knots = 5, m = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sesBsplinesNORM_+3A_x">x</code></td>
<td>

<p>vector, coordinates where to calculate the B-spline functions
</p>
</td></tr>
<tr><td><code id="sesBsplinesNORM_+3A_knots">knots</code></td>
<td>

<p>number of knots or vector of knots locations
</p>
</td></tr>
<tr><td><code id="sesBsplinesNORM_+3A_m">m</code></td>
<td>

<p>integer, degree of the B-Splines
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>bsplines</code></td>
<td>
<p>matrix, values in x of all B-spline basis functions of order m</p>
</td></tr>
<tr><td><code>knots</code></td>
<td>
<p>vector of knots locations</p>
</td></tr>
<tr><td><code>projecteur</code></td>
<td>
<p>inverse matrix of <code>bsplines</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span> package</p>


<h3>See Also</h3>

<p><code><a href="#topic+bspline">bspline</a></code>, <code><a href="#topic+basis.bsplines">basis.bsplines</a></code></p>

<hr>
<h2 id='sesBsplinesORTHONORM'>
orthogonalized B-splines basis functions
</h2><span id='topic+sesBsplinesORTHONORM'></span>

<h3>Description</h3>

<p>The <code>sesBsplinesORTHONORM</code> evaluates O-Splines basis functions at some points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesBsplinesORTHONORM(x = seq(0, 1, len = 101), knots = 5, m = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sesBsplinesORTHONORM_+3A_x">x</code></td>
<td>

<p>vector, coordinates where to calculate the B-spline functions
</p>
</td></tr>
<tr><td><code id="sesBsplinesORTHONORM_+3A_knots">knots</code></td>
<td>

<p>number of knots or vector of knots locations
</p>
</td></tr>
<tr><td><code id="sesBsplinesORTHONORM_+3A_m">m</code></td>
<td>

<p>integer, degree of the B-Splines
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>osplines</code></td>
<td>
<p>matrix, values in x of all O-spline basis functions of order m</p>
</td></tr>
<tr><td><code>knots</code></td>
<td>
<p>vector of knots locations</p>
</td></tr>
<tr><td><code>projecteur</code></td>
<td>
<p>inverse matrix of <code>osplines</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span> package</p>


<h3>See Also</h3>

<p><code><a href="#topic+bspline">bspline</a></code>, <code><a href="#topic+basis.osplines">basis.osplines</a></code></p>

<hr>
<h2 id='simulmodel'>Model simulation</h2><span id='topic+simulmodel'></span>

<h3>Description</h3>

<p>Function that simulates the model outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulmodel(model, plan, nomFic = NULL, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulmodel_+3A_model">model</code></td>
<td>
<p>name of R-function</p>
</td></tr>
<tr><td><code id="simulmodel_+3A_plan">plan</code></td>
<td>
<p>data frame of input design</p>
</td></tr>
<tr><td><code id="simulmodel_+3A_nomfic">nomFic</code></td>
<td>
<p>name of file that contains the model function</p>
</td></tr>
<tr><td><code id="simulmodel_+3A_verbose">verbose</code></td>
<td>
<p>verbose</p>
</td></tr>
<tr><td><code id="simulmodel_+3A_...">...</code></td>
<td>
<p>... </p>
</td></tr></table>
<p>possible fixed parameters of the R-function
</p>


<h3>Details</h3>

<p>The model function must be a R-function. Models defined as functions
will be called once with an expression of the form <code>y &lt;- f(X)</code> where <code>X</code> is
a vector containing a combination of levels of the input factors, and <code>y</code>
is the output vector of length <code class="reqn">q</code>, where <code class="reqn">q</code> is the number of output
variables</p>


<h3>Value</h3>

<p>data frame of model outputs</p>


<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span> package</p>

<hr>
<h2 id='summary.dynsi'>dynsi summary</h2><span id='topic+summary.dynsi'></span>

<h3>Description</h3>

<p>Function to summarize the dynamic sensitivity results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dynsi'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.dynsi_+3A_object">object</code></td>
<td>
<p>a dynsi object</p>
</td></tr>
<tr><td><code id="summary.dynsi_+3A_...">...</code></td>
<td>
<p>summary parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+dynsi">dynsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code></p>

<hr>
<h2 id='summary.gsi'>summary of GSI results</h2><span id='topic+summary.gsi'></span>

<h3>Description</h3>

<p>function to summarize the GSI results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gsi'
summary(object, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.gsi_+3A_object">object</code></td>
<td>
<p>a GSI object</p>
</td></tr>
<tr><td><code id="summary.gsi_+3A_...">...</code></td>
<td>
<p>summary parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gsi">gsi</a></code>, <code><a href="#topic+multisensi">multisensi</a></code></p>

<hr>
<h2 id='yapprox'>Prediction based on PCA and anovas (NOT ONLY)</h2><span id='topic+yapprox'></span>

<h3>Description</h3>

<p>A function that predicts the model output after PCA and aov analyses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yapprox(multivar.obj, nbcomp = 2, aov.obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yapprox_+3A_multivar.obj">multivar.obj</code></td>
<td>
<p>output of the multivar function</p>
</td></tr>
<tr><td><code id="yapprox_+3A_nbcomp">nbcomp</code></td>
<td>
<p>number of columns </p>
</td></tr>
<tr><td><code id="yapprox_+3A_aov.obj">aov.obj</code></td>
<td>
<p>aov object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model output predictions</p>


<h3>Note</h3>

<p>This is essentially an internal function for the <span class="pkg">multisensi</span> package</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
