<!DOCTYPE html><html lang="en"><head><title>Help for package surveynnet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {surveynnet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#body_fat'><p>Simple body fat example data</p></a></li>
<li><a href='#nhanes.demo'><p>Nhanes example</p></a></li>
<li><a href='#predict.surveynnet'><p>Predict response from fitted nnet, using new data</p></a></li>
<li><a href='#surveynnet'><p>Neural Net for Complex Survey Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Neural Network for Complex Survey Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>The goal of 'surveynnet' is to extend the functionality of 'nnet', 
  which already supports survey weights, by enabling it to handle clustered
  and stratified data. It achieves this by incorporating design effects 
  through the use of effective sample sizes as outlined by Chen
  and Rust (2017), &lt;<a href="https://doi.org/10.1093%2Fjssam%2Fsmw036">doi:10.1093/jssam/smw036</a>&gt;, and performed by  
  'deffCR' in the package 'PracTools' (Valliant, Dever, and Kreuter (2018), 
  &lt;<a href="https://doi.org/10.1007%2F978-3-319-93632-1">doi:10.1007/978-3-319-93632-1</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/237triangle/surveynnet">https://github.com/237triangle/surveynnet</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/237triangle/surveynnet/issues">https://github.com/237triangle/surveynnet/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, nnet, PracTools, stats, survey, survival</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-06 18:16:37 UTC; aaroncohen</td>
</tr>
<tr>
<td>Author:</td>
<td>Aaron Cohen <a href="https://orcid.org/0009-0003-1971-1072"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Raul Cruz-Cano <a href="https://orcid.org/0000-0001-7715-1198"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aaron Cohen &lt;cohenaa@iu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-09 13:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='body_fat'>Simple body fat example data</h2><span id='topic+body_fat'></span>

<h3>Description</h3>

<p>Simple body fat example data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_fat
</code></pre>


<h3>Format</h3>



<h4><code>body_fat</code></h4>

<p>A data frame with 12 rows and 9 columns:
</p>

<dl>
<dt>Subject</dt><dd><p>Subject ID</p>
</dd>
<dt>group</dt><dd><p>group</p>
</dd>
<dt>Weight_kg</dt><dd><p>weight</p>
</dd>
<dt>Height_cm</dt><dd><p>height</p>
</dd>
<dt>Age</dt><dd><p>age</p>
</dd>
<dt>pct_body_fat</dt><dd><p>percent body fat</p>
</dd>
<dt>survey_wt</dt><dd><p>survey weight</p>
</dd>
<dt>stratum</dt><dd><p>stratum</p>
</dd>
<dt>cluster</dt><dd><p>cluster</p>
</dd>
</dl>



<hr>
<h2 id='nhanes.demo'>Nhanes example</h2><span id='topic+nhanes.demo'></span>

<h3>Description</h3>

<p>Nhanes example
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhanes.demo
</code></pre>


<h3>Format</h3>



<h4><code>nhanes.demo</code></h4>

<p>A data frame with 6230 rows and 9 columns:
</p>

<dl>
<dt>SEQN</dt><dd><p>Respondent sequence number</p>
</dd>
<dt>SDMVPSU</dt><dd><p>Masked variance pseudo-PSU</p>
</dd>
<dt>SDMVSTRA</dt><dd><p>Masked variance pseudo-stratum</p>
</dd>
<dt>WTMEC2YR</dt><dd><p>Full sample 2 year MEC exam weight</p>
</dd>
<dt>BMXHT</dt><dd><p>Standing height (cm)</p>
</dd>
<dt>BMXWT</dt><dd><p>Weight (kg)</p>
</dd>
<dt>BMXBMI</dt><dd><p>Body maxx index (kg/m**2)</p>
</dd>
<dt>BPXSY1</dt><dd><p>Systolic blood pressure</p>
</dd>
<dt>BPXDI1</dt><dd><p>Diastolic blood pressure</p>
</dd>
</dl>



<hr>
<h2 id='predict.surveynnet'>Predict response from fitted nnet, using new data</h2><span id='topic+predict.surveynnet'></span>

<h3>Description</h3>

<p>Predict response from fitted nnet, using new data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'surveynnet'
predict(object, newdat, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.surveynnet_+3A_object">object</code></td>
<td>
<p>The surveynnet object (returned by <code>surveynnet()</code>)</p>
</td></tr>
<tr><td><code id="predict.surveynnet_+3A_newdat">newdat</code></td>
<td>
<p>The matrix or data frame of test examples. Must be of the same structure
as the data matrix used to fit the surveynnet object.</p>
</td></tr>
<tr><td><code id="predict.surveynnet_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix/vector of values returned by the trained network. Note: it is possible
to pass type = &quot;raw&quot; or type = &quot;class&quot; as appropriate. See <code>predict.nnet()</code> for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># From the example in `surveynnet` help file:
y &lt;- body_fat$pct_body_fat
x &lt;- body_fat[,c("Weight_kg", "Height_cm", "Age")]
weight &lt;- body_fat$survey_wt
strat &lt;- body_fat$stratum
clust &lt;- body_fat$cluster
y[strat==1] &lt;- y[strat==1] + 30*0.00015*rnorm(sum(strat==1))
y[strat==2] &lt;- y[strat==2] + 30*0.15*rnorm(sum(strat==2))
myout &lt;- surveynnet(x,y,weight = weight, strat = strat, clust=clust)
newdat &lt;-  2*x+rnorm(dim(x)[1])
predict(myout, newdat = newdat)

</code></pre>

<hr>
<h2 id='surveynnet'>Neural Net for Complex Survey Data</h2><span id='topic+surveynnet'></span>

<h3>Description</h3>

<p>The surveynnet package extends the functionality of nnet (Venables and Ripley, 2002),
which already supports survey weights, by enabling it to handle clustered and stratified data.
It achieves this by incorporating design effects through the use of effective sample sizes in
the calculations, performed by the package described in Valliant et al. (2023), by following
the methods outlined by Chen and Rust (2017) and Valliant et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surveynnet(x, y, weight, strat, clust, comp_cases = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="surveynnet_+3A_x">x</code></td>
<td>
<p>Matrix or data frame of predictors. Must not contain any missing values.</p>
</td></tr>
<tr><td><code id="surveynnet_+3A_y">y</code></td>
<td>
<p>Vector of targets / response values. Must not contain any missing values.</p>
</td></tr>
<tr><td><code id="surveynnet_+3A_weight">weight</code></td>
<td>
<p>The weights for each sample.</p>
</td></tr>
<tr><td><code id="surveynnet_+3A_strat">strat</code></td>
<td>
<p>The stratum for each sample.</p>
</td></tr>
<tr><td><code id="surveynnet_+3A_clust">clust</code></td>
<td>
<p>The cluster for each sample.</p>
</td></tr>
<tr><td><code id="surveynnet_+3A_comp_cases">comp_cases</code></td>
<td>
<p>If TRUE, filter out missing values from x, y, weight, strat, and clust. Default FALSE.
Note that in either case, the dimensions of all data mentioned above must agree.</p>
</td></tr>
<tr><td><code id="surveynnet_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed into <code>PracTools::deffCR</code> or <code>nnet::nnet</code>. See
documentation of those packages and functions for more details. Note that for the neural net (<code>nnet</code>),
the default here is set to 3 layers (&quot;size&quot; parameter) and maximum iterations (&quot;maxit&quot; parameter) is
set to 2000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two objects:
</p>

<ul>
<li><p> A dataframe with the fitted values of the neural nets, using:
no weights (&quot;fitted&quot;), the user-inputted weights (&quot;fitted_weighted&quot;), and the new method that adjusts the weights by using a design
effect incorporating cluster and strata (&quot;fitted_deff&quot;).
</p>
</li>
<li><p> The fitted neural network object (from <code>nnet</code>), using the novel design-effect based weights; this
can be used to predict the outcomes for new observations.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Chen, S., and K. F. Rust. 2017.&quot;An Extension of Kish’s Formula for Design Effects to
Two- and Three-Stage Designs with Stratification.”, Journal of Survey Statistics and
Methodology,5 (2): 111–30.
</p>
</li>
<li><p> Valliant, R., J. A. Dever, and F. Kreuter. 2018. Practical Tools for Designing
and Weighting Survey Samples .2nd ed. New York: Springer-Verlag.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# short example with body fat dataset
y &lt;- body_fat$pct_body_fat
x &lt;- body_fat[,c("Weight_kg", "Height_cm", "Age")]
weight &lt;- body_fat$survey_wt
strat &lt;- body_fat$stratum
clust &lt;- body_fat$cluster
y[strat==1] &lt;- y[strat==1] + 30*0.00015*rnorm(sum(strat==1))
y[strat==2] &lt;- y[strat==2] + 30*0.15*rnorm(sum(strat==2))

myout &lt;- surveynnet(x,y,weight = weight, strat = strat, clust=clust)
myout


# NHANES example
# Predicting Diastolic BP from BMI, Systolic BP and Height
# PLEASE NOTE: for this example, pass "nest=TRUE" into the
# "..." parameters of the main function `surveynnet`

x &lt;- nhanes.demo[,c("BMXBMI", "BPXSY1", "BMXHT")]
weight &lt;- nhanes.demo$WTMEC2YR
strat &lt;- nhanes.demo$SDMVSTRA
clust &lt;- nhanes.demo$SDMVPSU
y &lt;- nhanes.demo$BPXDI1
myout &lt;- surveynnet(x,y,weight = weight, strat = strat, clust=clust, nest=TRUE)
head(myout$results, 15)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
