<!DOCTYPE html><html><head><title>Help for package TrendTM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TrendTM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Data_Series'><p>Example of data</p></a></li>
<li><a href='#FM_kt'><p>It performs the factorization for a fixed rank k and a temporal structure with a fixed tau</p></a></li>
<li><a href='#OurSlope'><p>It performs the slope heuristic for the selection of a penalty constant</p></a></li>
<li><a href='#TrendTM'><p>Matrix Factorization for Multivariate Time Series Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Trend of High-Dimensional Time Series Matrix Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.19</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Emilie Lebarbier  [aut, cre], Nicolas Marie [aut], Am√©lie Rosier [aut, cre]. </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emilie Lebarbier &lt;emilie.lebarbier@parisnanterre.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Matrix factorization for multivariate time series with both low rank and temporal structures. The procedure is the one proposed by Alquier, P. and Marie, N. Matrix factorization for multivariate time series analysis. Electronic journal of statistics, 13(2), 4346-4366 (2019). </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>softImpute, capushe, fda</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-15 21:02:56 UTC; lebarbier</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-16 14:33:55 UTC</td>
</tr>
</table>
<hr>
<h2 id='Data_Series'>Example of data</h2><span id='topic+Data_Series'></span>

<h3>Description</h3>

<p>A simulated matrix with a low rank k and with temporal structure based on independent Gaussian.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Data_Series)
</code></pre>


<h3>Format</h3>

<p>A matrix with 30 rows (30 times series) and 100 columns (size of each temporal series).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(TrendTM)
data(Data_Series)
head(Data_Series)
TrendTM(Data_Series,k_max=3)
</code></pre>

<hr>
<h2 id='FM_kt'>It performs the factorization for a fixed rank k and a temporal structure with a fixed tau</h2><span id='topic+FM_kt'></span>

<h3>Description</h3>

<p>It performs the factorization for a fixed rank k and a temporal structure with a fixed tau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FM_kt(
  Data_Series,
  k = 2,
  tau = floor(n/2),
  struct_temp = "none",
  type_soft = "als"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FM_kt_+3A_data_series">Data_Series</code></td>
<td>
<p>the data matrix with d rows and n columns containing the d temporal series with size n.</p>
</td></tr>
<tr><td><code id="FM_kt_+3A_k">k</code></td>
<td>
<p>the fixed rank of X. Default is 2.</p>
</td></tr>
<tr><td><code id="FM_kt_+3A_tau">tau</code></td>
<td>
<p>the fixed value for tau . Default is <code>floor(n/2)</code>.</p>
</td></tr>
<tr><td><code id="FM_kt_+3A_struct_temp">struct_temp</code></td>
<td>
<p>a name indicating the temporal structure. Could be <code>none</code>, <code>periodic</code> or <code>smooth</code>. Default is <code>none</code>.</p>
</td></tr>
<tr><td><code id="FM_kt_+3A_type_soft">type_soft</code></td>
<td>
<p>the option <code>type</code> of the function softImpute. Default is <code>als</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li> <p><code>M_est</code> the estimation of M.
</p>
</li>
<li> <p><code>U_est</code> the component U of the decomposition of <code>M_est</code>.
</p>
</li>
<li> <p><code>V_est</code> the component V of the decomposition of <code>M_est</code>.
</p>
</li>
<li> <p><code>contrast</code> the Frobenius norm of X-M_est.
</p>
</li></ul>


<hr>
<h2 id='OurSlope'>It performs the slope heuristic for the selection of a penalty constant</h2><span id='topic+OurSlope'></span>

<h3>Description</h3>

<p>It performs the slope heuristic for the selection of a penalty constant
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OurSlope(contrast, grille, penalty)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OurSlope_+3A_contrast">contrast</code></td>
<td>
<p>the Frobenius norm of X-M_est for all the value of the grid <code>grille</code></p>
</td></tr>
<tr><td><code id="OurSlope_+3A_grille">grille</code></td>
<td>
<p>the ordered grid of potential values for the penalty constant</p>
</td></tr>
<tr><td><code id="OurSlope_+3A_penalty">penalty</code></td>
<td>
<p>the penalty calculated for each value of the grid <code>grille</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Model_Selected</code> the selected parameter
</p>

<hr>
<h2 id='TrendTM'>Matrix Factorization for Multivariate Time Series Analysis</h2><span id='topic+TrendTM'></span>

<h3>Description</h3>

<p>It is the main function. It performs the factorization for a selected rank and a temporal structure with a selected tau if the selection is requested otherwise it is fixed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TrendTM(
  Data_Series,
  k_select = FALSE,
  k_max = 20,
  struct_temp = "none",
  tau_select = FALSE,
  tau_max = floor(n/2),
  type_soft = "als"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TrendTM_+3A_data_series">Data_Series</code></td>
<td>
<p>the data matrix with d rows and n columns containing the d temporal series with size n.</p>
</td></tr>
<tr><td><code id="TrendTM_+3A_k_select">k_select</code></td>
<td>
<p>a boolean indicating if the rank of the matrix Data_Series will be selected. Default is FALSE.</p>
</td></tr>
<tr><td><code id="TrendTM_+3A_k_max">k_max</code></td>
<td>
<p>the fixed rank of Data_Series if <code>k_select=FALSE</code>. The maximal value of the rank if <code>k_select=TRUE</code> (must be lower than the minimum between d and n). Default is 20.</p>
</td></tr>
<tr><td><code id="TrendTM_+3A_struct_temp">struct_temp</code></td>
<td>
<p>a name indicating the temporal structure. Could be <code>none</code>, <code>periodic</code> or <code>smooth</code>. Default is <code>none</code>.</p>
</td></tr>
<tr><td><code id="TrendTM_+3A_tau_select">tau_select</code></td>
<td>
<p>a boolean indicating if the parameter tau will be selected. This can be possible only when <code>struct_temp=smooth</code>. Default is FALSE.</p>
</td></tr>
<tr><td><code id="TrendTM_+3A_tau_max">tau_max</code></td>
<td>
<p>the fixed value for tau if <code>tau_select=FALSE</code>. The maximal value of tau if <code>tau_select=TRUE</code> (must be lower than n). Default is <code>floor(n/2)</code>.</p>
</td></tr>
<tr><td><code id="TrendTM_+3A_type_soft">type_soft</code></td>
<td>
<p>the option <code>type</code> of the function softImpute. Default is <code>als</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The penalty constant(s) is(are) calibrated using the slope heuristic from package capushe. We adapt this heuristic as follows: the final dimension is the one correspind to the majority of the selected dimension for the considered different penalties.
</p>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li> <p><code>k_est</code> the selected rank if <code>k_select==TRUE</code> or <code>k_max</code> if <code>k_select==FALSE</code>.
</p>
</li>
<li> <p><code>tau_est</code> the selected tau if <code>tau_select==TRUE</code> or <code>tau_max</code> if <code>tau_select==FALSE</code>.
</p>
</li>
<li> <p><code>U_est</code> the component U of the decomposition of the final estimator <code>M_est</code>.
</p>
</li>
<li> <p><code>V_est</code> the component V of the decomposition of the final estimator <code>M_est</code>.
</p>
</li>
<li> <p><code>M_est</code> the estimation of M.
</p>
</li>
<li> <p><code>contrast</code> the Frobenius norm of Data_Series-M_est. This is a value when <code>k_select==FALSE</code> and <code>tau_select==FALSE</code>, a vector when <code>k_select==TRUE</code> or <code>tau_select==TRUE</code>, and a matrix when <code>k_select==TRUE</code> and <code>tau_select==TRUE</code> with <code>k_max</code> rows and <code>tau_max</code> columns.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(Data_Series)
result &lt;- TrendTM(Data_Series, k_max = 3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
