<!DOCTYPE html><html><head><title>Help for package satdad</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {satdad}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#copArchimaxMevlog'><p>cop-ell-psi-psiinv- functions for Archimax Mevlog models.</p></a></li>
<li><a href='#ec'><p>Extremal coefficients for  Mevlog models.</p></a></li>
<li><a href='#ecEmp'><p>Empirical Extremal coefficients.</p></a></li>
<li><a href='#ellEmp'><p>Empirical stable tail dependence function.</p></a></li>
<li><a href='#France'><p>Dataset. Yearly Maxima of Temperature and coordinates of 21 French cities 1946-2000.</p></a></li>
<li><a href='#gen.ds'><p>Generate a Mevlog tail dependence structure.</p></a></li>
<li><a href='#graphs'><p>Graphs of the tail dependence structure for Mevlog models.</p></a></li>
<li><a href='#graphsEmp'><p>Empirical graphs of the tail dependence structure.</p></a></li>
<li><a href='#graphsMapEmp'><p>Empirical graphs drawn on geographical maps of the tail dependence structure.</p></a></li>
<li><a href='#plotClev'><p>Cleveland's Dot Plots of the tail dependence structure.</p></a></li>
<li><a href='#plotClevEmp'><p>Empirical Cleveland's Dot Plots of the tail dependence structure.</p></a></li>
<li><a href='#rArchimaxMevlog'><p>r function for Archimax Mevlog models.</p></a></li>
<li><a href='#rMevlog'><p>r-p-d-ell- functions for Mevlog models.</p></a></li>
<li><a href='#Stock'><p>Dataset. Yearly maxima of Log Returns of ten stock indices 1990-2015.</p></a></li>
<li><a href='#tic'><p>Tail importance coefficients for Mevlog models.</p></a></li>
<li><a href='#ticEmp'><p>Empirical tail importance coefficients.</p></a></li>
<li><a href='#tsic'><p>Tail superset importance coefficients for Mevlog models.</p></a></li>
<li><a href='#tsicEmp'><p>Empirical tail superset importance coefficients.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sensitivity Analysis Tools for Dependence and Asymptotic
Dependence</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cécile Mercadier &lt;mercadier@math.univ-lyon1.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for analyzing tail dependence in any sample or in particular theoretical models.  The package uses only theoretical and non parametric methods, without inference.  The primary goals of the package are to provide: (a)symmetric multivariate extreme value models in any dimension;  theoretical and empirical indices to order tail dependence;  theoretical and empirical graphical methods to visualize tail dependence. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.10)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, BH</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>igraph, maps, partitions, graphicalExtremes, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-29 13:43:34 UTC; cecile</td>
</tr>
<tr>
<td>Author:</td>
<td>Cécile Mercadier [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-29 15:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='copArchimaxMevlog'>cop-ell-psi-psiinv- functions for Archimax Mevlog models.</h2><span id='topic+copArchimaxMevlog'></span><span id='topic+ellArchimaxMevlog'></span><span id='topic+psiArchimaxMevlog'></span><span id='topic+psiinvArchimaxMevlog'></span>

<h3>Description</h3>

<p>Copula function, stable tail dependence function, psi function, psi inverse function for Archimax Mevlog models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copArchimaxMevlog(x, ds,  dist = "exp", dist.param = 1)
ellArchimaxMevlog(x, ds)
psiArchimaxMevlog(t, dist = "exp", dist.param = 1)
psiinvArchimaxMevlog(t, dist = "exp", dist.param = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="copArchimaxMevlog_+3A_x">x</code></td>
<td>
<p>A vector of size <code>d</code> or a <code>(N.x times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="copArchimaxMevlog_+3A_ds">ds</code></td>
<td>
<p>An object of class <code>ds</code>.</p>
</td></tr>
<tr><td><code id="copArchimaxMevlog_+3A_dist">dist</code></td>
<td>
<p>The underlying distribution. A character string among <code>"exp"</code> (the default value), <code>"gamma"</code> and <code>"ext"</code>.</p>
</td></tr>
<tr><td><code id="copArchimaxMevlog_+3A_dist.param">dist.param</code></td>
<td>
<p>The parameter associated with the choice <code>dist</code>.  If <code>dist</code> is <code>"exp"</code>, then <code>dist.param</code> is a postive real, the parameter of an exponential distribution. The default value is 1. If <code>dist</code> is <code>"gamma"</code>, then <code>dist.param</code> is a vector that concatenates the shape  and  scale parameters (in this order) of a gamma distribution.</p>
</td></tr>
<tr><td><code id="copArchimaxMevlog_+3A_t">t</code></td>
<td>
<p>A non negative scalar or vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tail dependence structure is set by a <code>ds</code> object.  See Section <b>Value</b> in <code><a href="#topic+gen.ds">gen.ds</a></code>.
</p>
<p>Turning to Archimax structures, we follow Charpentier et al. (2014). Their algorithm (4.1 of p. 124) has been applied in <code><a href="#topic+rArchimaxMevlog">rArchimaxMevlog</a></code> to generate observations sampled from the copula
</p>
<p><code class="reqn">C(x_1,...,x_d) = \psi(\ell(\psi^{-1}(x_1),...,\psi^{-1}(x_d)))</code>
</p>
<p>when <code class="reqn">\ell</code> is here the stable tail dependence function of a Mevlog model. In this package, the stdf function <code class="reqn">\ell</code> is completely characterized by the <code>ds</code> object. See <code><a href="#topic+ellMevlog">ellMevlog</a></code>.
</p>


<h3>Value</h3>

<p>When the underlying distribution <code>dist</code> is
</p>

<ul>
<li><p> &quot;exp&quot; ; For a positive <code class="reqn">\lambda</code> given by <code>dist.param</code>, <code class="reqn">\psi(t)=\frac{\lambda}{t+\lambda}</code> and <code class="reqn">\psi^{-1}(t)=\lambda \frac{1-t}{t}</code>.
</p>
</li>
<li><p> &quot;gamma&quot; ; For positive scale <code class="reqn">\sigma</code> and shape <code class="reqn">a</code> given by <code>dist.param</code>, <code class="reqn">\psi(t)=\frac{1}{(t+\sigma)^a}</code> and <code class="reqn">\psi^{-1}(t)=\frac{t^{-1/a}-1}{\sigma}</code>.
</p>
</li>
<li><p> &quot;ext&quot; ; <code class="reqn">\psi(t)=\exp(-t)</code> and <code class="reqn">\psi^{-1}(t)=-\ln(t)</code>.
</p>
</li></ul>

<p><code>copArchimaxMevlog</code> returns the copula function <code class="reqn">C(x_1,...,x_d) = \psi(\ell(\psi^{-1}(x_1),...,\psi^{-1}(x_d)))</code>.
</p>
<p><code>ellArchimaxMevlog</code> returns the stable tail dependence function  <code class="reqn">\ell(x_1,...,x_d)</code>.
</p>
<p><code>psiArchimaxMevlog</code> returns the psi function  <code class="reqn">\psi(t)</code>.
</p>
<p><code>psiinvArchimaxMevlog</code> returns the psi inverse function  <code class="reqn">\psi^{-1}(t)</code>.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Charpentier, A.,   Fougères,  A.-L.,  Genest, C. and  Nešlehová, J.G. (2014)
Multivariate Archimax copulas.
<em>Journal of Multivariate Analysis</em>, <b>126</b>, 118&ndash;136.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rArchimaxMevlog">rArchimaxMevlog</a></code>,  <code><a href="#topic+gen.ds">gen.ds</a></code>, <code><a href="#topic+ellMevlog">ellMevlog</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 7-dimensional tail dependence structure
ds7 &lt;- gen.ds(d = 7)

## Fix the parameters for the underlying distribution
(lambda &lt;- runif(1, 0.01, 5))
(shape &lt;- runif(1, 0.01, 5))
(scale &lt;- runif(1, 0.01, 5))

## Fix x and t
x &lt;- c(0.8, 0.9, 0.5, 0.8, 0.4, 0.9, 0.9)
t &lt;- 2

## Evaluate the functions under the underlying exponential construction
copArchimaxMevlog(x = x, ds = ds7, dist = "exp", dist.param = lambda)
ellArchimaxMevlog(x = x, ds = ds7)
psiArchimaxMevlog(t = t, dist = "exp", dist.param = lambda)
psiinvArchimaxMevlog(t = t, dist = "exp", dist.param = lambda)

## Evaluate the functions under the underlying gamma construction
copArchimaxMevlog(x = x, ds = ds7, dist = "gamma", dist.param = c(shape, scale))
ellArchimaxMevlog(x = x, ds = ds7)
psiArchimaxMevlog(t = t, dist = "gamma", dist.param = c(shape, scale))
psiinvArchimaxMevlog(t = t, dist = "gamma", dist.param = c(shape, scale))

</code></pre>

<hr>
<h2 id='ec'>Extremal coefficients for  Mevlog models.</h2><span id='topic+ec'></span>

<h3>Description</h3>

<p>Theoretical extremal coefficients for  Mevlog models. A <code>Mevlog</code> model is a multivariate extreme value (symmetric or asymmetric) logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec(ds, ind = 2, norm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec_+3A_ds">ds</code></td>
<td>
<p>An object of class <code>ds</code>.</p>
</td></tr>
<tr><td><code id="ec_+3A_ind">ind</code></td>
<td>
<p>A character string among &quot;with.singletons&quot; and &quot;all&quot; (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = 2</code>, all pairwise coefficients are computed.</p>
</td></tr>
<tr><td><code id="ec_+3A_norm">norm</code></td>
<td>
<p>A boolean. 'FALSE' (the default): ec is computed. 'TRUE':  inverse normalized ec is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tail dependence structure is set by a <code>ds</code> object. It thus corresponds to the stable tail dependence function <code class="reqn">\ell</code>. The way to deduce the stable tail dependence function <code class="reqn">\ell</code> from <code>ds</code> is explained in the Details section of <code><a href="#topic+gen.ds">gen.ds</a></code>.
</p>


<h3>Value</h3>

<p>The function returns a list of two elements:
</p>

<ul>
<li><p><code>subsets</code> A list of subsets from  <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind</code> is given as an integer, <code>subsets</code> is the list of subsets from  <code class="reqn">\{1,...,d\}</code> with cardinality <code>ind</code>. When <code>ind</code> is the list, it corresponds to <code>subsets</code>.
</p>
<p>When <code>ind = "with.singletons"</code>  subsets is the list of all non empty subsets in <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind = "all"</code>   subsets is the list of all subsets in <code class="reqn">\{1,...,d\}</code> with cardinality larger or equal to 2.
</p>
</li>
<li><p><code>ec</code> A vector of theoretical extremal coefficients associated with the list <code>subsets</code>.
</p>
<p>An extremal coefficient associated with the subset <code class="reqn">I</code> is <code class="reqn">\ell(1_I,0_{I^c})</code>. Its value lies in <code class="reqn">(1, |I|)</code>.
</p>
<p>When <code>norm = TRUE</code>, then inverse normalized ec are computed by  <code class="reqn">\dfrac{|I|-ec}{|I|-1}</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>
<p>Tiago de Oliveira, J. (1962/63)
Structure theory of bivariate extremes, extensions.
<em>Estudos de Matematica, Estatistica, e Economicos</em>, 7:165&ndash;195.
</p>
<p>Smith, R. L. (1990)
Max-stable processes and spatial extremes.
<em>Dept. of Math., Univ. of Surrey</em>, Guildford GU2 5XH, England.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellMevlog">ellMevlog</a></code>,  <code><a href="#topic+gen.ds">gen.ds</a></code>, <code><a href="#topic+graphs">graphs</a></code>,  <code><a href="#topic+tsic">tsic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 4-dimensional asymmetric tail dependence structure
ds4 &lt;-  gen.ds(d = 4)
## Compute all theoretical extremal coefficients
ec(ds = ds4, ind = "with.singletons")
## Compute theoretical extremal coefficients associated with the support of ds4
ec(ds = ds4, ind = ds4$sub)

## Fix a 6-dimensional asymmetric tail dependence structure
ds6 &lt;- gen.ds(d = 6, sub = list(1:2,2:5,5:6))
## Compute all theoretical extremal coefficients on subsets with cardinality 5
ec(ds = ds6, ind = 5)
## Compute inverse renormalized ec
ec(ds = ds6, ind = list(1:2,1:4,1:6), norm = TRUE)

</code></pre>

<hr>
<h2 id='ecEmp'>Empirical Extremal coefficients.</h2><span id='topic+ecEmp'></span>

<h3>Description</h3>

<p>Computes on a sample the extremal coefficients associated with threshold <code>k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecEmp(sample, ind = 2, k, norm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecEmp_+3A_sample">sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="ecEmp_+3A_ind">ind</code></td>
<td>
<p>A character string among &quot;with.singletons&quot; and &quot;all&quot; (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = 2</code>, all pairwise coefficients are computed.</p>
</td></tr>
<tr><td><code id="ecEmp_+3A_k">k</code></td>
<td>
<p>An integer smaller or equal to <code>n</code>.</p>
</td></tr>
<tr><td><code id="ecEmp_+3A_norm">norm</code></td>
<td>
<p>A boolean. 'FALSE' (the default): empirical ec is computed. 'TRUE':  inverse normalized empirical ec is computed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list of two elements:
</p>

<ul>
<li><p><code>subsets</code> A list of subsets from  <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind</code> is given as an integer, <code>subsets</code> is the list of subsets from  <code class="reqn">\{1,...,d\}</code> with cardinality <code>ind</code>. When <code>ind</code> is the list, it corresponds to <code>subsets</code>.
</p>
<p>When <code>ind = "with.singletons"</code>  subsets is the list of all non empty subsets in <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind = "all"</code>   subsets is the list of all subsets in <code class="reqn">\{1,...,d\}</code> with cardinality larger or equal to 2.
</p>
</li>
<li><p><code>ec</code> A vector of empirical  extremal coefficients.
</p>
<p>An empirical extremal coefficient associated with the subset <code class="reqn">I</code> is <code class="reqn">\hat{\ell}_{k,n}(1_I,0_{I^c})</code>. Its value lies in <code class="reqn">(1, |I|)</code>.
</p>
<p>When <code>norm = TRUE</code>, then inverse normalized empirical ec are computed by <code class="reqn">1 - \dfrac{\hat{\ell}_{k,n}(1_I,0_{I^c})}{|I|}</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ec">ec</a></code>, <code><a href="#topic+ellEmp">ellEmp</a></code>,  <code><a href="#topic+graphsEmp">graphsEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## We produce below a figure on the dataset used in Mercadier  and Roustant (2019).

data(France)

ec_ymt &lt;- ecEmp(sample = France$ymt, ind = 2, k = 25)

## The 9 largest inverse empirical pairwise extremal coefficients.
 graphsMapEmp(France$ymt, region='france', coord=France$coord, k=25, which="iecgraph", select=9)

## The 30 largest inverse empirical pairwise extremal coefficients.
graphsMapEmp(France$ymt, region='france', coord=France$coord, k=25, which="iecgraph", select=30)

## All the inverse empirical pairwise extremal coefficients.
graphsMapEmp(France$ymt, region='france', coord=France$coord, k=25, which="iecgraph")

</code></pre>

<hr>
<h2 id='ellEmp'>Empirical stable tail dependence function.</h2><span id='topic+ellEmp'></span>

<h3>Description</h3>

<p>The stable tail dependence function of <code>sample</code> is estimated at each row of <code>x</code> and for all values of the threshold parameter <code>k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellEmp(sample, x, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellEmp_+3A_sample">sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="ellEmp_+3A_x">x</code></td>
<td>
<p>A <code>(N.x times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="ellEmp_+3A_k">k</code></td>
<td>
<p>A vector of <code>N.k</code> integers smaller or equal to <code>n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>(N.k times N.x)</code> matrix is returned.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Huang, X. (1992).
Statistics of bivariate extremes.
PhD Thesis, Erasmus University Rotterdam, Tinbergen Institute Research series No. 22.
</p>
<p>de Haan, L. and Resnick, S. I. (1993).
Estimating the limit distribution of multivariate extremes. Communications in Statistics.
Stochastic Models 9, 275&ndash;309.
</p>
<p>Fougeres, A.-L., de Haan, L. and  Mercadier, C.  (2015).
Bias correction in multivariate extremes.
Annals of Statistics 43 (2), 903&ndash;934.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellMevlog">ellMevlog</a></code>, <code><a href="#topic+gen.ds">gen.ds</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 5-dimensional asymmetric tail dependence structure
ds5 &lt;- gen.ds(d = 5)

## Construct a 1000-sample of Mevlog random vector associated with ds5
sample5 &lt;- rMevlog(n = 1000, ds = ds5)

## Select 3 vectors in R^5
x5 &lt;- matrix(runif(5*3), ncol = 5)

## Select 4 values for the threshold parameter
k5 &lt;- (2:5)*10

## Estimation of the stable tail dependence function
# We thus get a 4 x 3 matrix
ellEmp(sample = sample5, x = x5, k = k5)

## Theoretical values of the stable tail dependence function inherited from ds5
ellMevlog(x = x5, ds = ds5)

</code></pre>

<hr>
<h2 id='France'>Dataset. Yearly Maxima of Temperature and coordinates of 21 French cities 1946-2000.</h2><span id='topic+France'></span>

<h3>Description</h3>

<p>The <code>France</code> dataset is a list of two elements
</p>

<ul>
<li><p>$ymt a data frame of 55 rows and 21 columns, constructed after extraction from www.ecad.eu. The value at row <code class="reqn">i</code> and colum <code class="reqn">j</code> is the yearly maximum of temperature for the year <code class="reqn">1946+i-1</code> in the <code class="reqn">j-th</code> French city.
</p>
</li>
<li><p>$coord a list of two elements: Latitude <code>$lat</code> and Longitude <code>$lon</code> of 21 French cities.
</p>
</li></ul>

<p>The name of the rows of <code>$ymt</code> are the year of the study: 1946&ndash;2000. The column names of <code>$ymt</code> are those of 21 French cities listed below.
</p>
<p>[1] &quot;MARSEILLE OBS. PALAIS-LONCHAMP&quot;
[2] &quot;BOURGES AERODROME&quot;
[3] &quot;BLAGNAC AEROP. TOULOUSE-BLAGNAC&quot;
[4] &quot;MERIGNAC AEROPORT DE BORDEAUX&quot;
[5] &quot;DEOLS CHATEAUROUX AERODROME DE DEOLS&quot;
[6] &quot;PERPIGNAN&quot;
[7] &quot;BRON LYON AEROPORT&quot;
[8] &quot;PARIS-14E PARC MONTSOURIS&quot;
[9] &quot;RENNES&quot;
[10] &quot;STRASBOURG-ENTZHEIM&quot;
[11] &quot;NANCY&quot;
[12] &quot;ORLEANS&quot;
[13] &quot;BESANCON&quot;
[14] &quot;LA-ROCHELLE&quot;
[15] &quot;BEAUVAIS-TILLE&quot;
[16] &quot;LE MANS&quot;
[17] &quot;METZ-FRESCATY&quot;
[18] &quot;MONTELIMAR&quot;
[19] &quot;NIMES&quot;
[20] &quot;VICHY-CHARMEIL&quot;
[21] &quot;COGNAC&quot;
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Klein Tank, A.M.G. and Coauthors, (2002).
Daily dataset of 20th-century surface air temperature and precipitation series for the European Climate Assessment.
<em>Int. J. of Climatol.</em>, <b>22</b>, 1441&ndash;1453.
Data and metadata available at www.ecad.eu
</p>
<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsicEmp">tsicEmp</a></code>, <code><a href="#topic+ecEmp">ecEmp</a></code>,  <code><a href="#topic+graphsMapEmp">graphsMapEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(France)
maps::map('france',col='gray')
points(France$coord$lon,France$coord$lat, pch = 20, col = 1)
text(France$coord$lon,France$coord$lat+0.3,labels=1:21,cex=.8)
</code></pre>

<hr>
<h2 id='gen.ds'>Generate a Mevlog tail dependence structure.</h2><span id='topic+gen.ds'></span>

<h3>Description</h3>

<p>The function <code>gen.ds</code> creates (possibly randomly) a tail dependence structure for a multivariate extreme value logistic (Mevlog) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.ds(d, type = "alog", sub = NULL, dep = NULL, asy = NULL, mnns = d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.ds_+3A_d">d</code></td>
<td>
<p>The dimension.</p>
</td></tr>
<tr><td><code id="gen.ds_+3A_type">type</code></td>
<td>
<p>The type of the model; represented by a character string.  This is similar to the  option <code>model</code> of <code><a href="evd.html#topic+rmvevd">rmvevd</a></code>. It must be either <code>"log"</code> or <code>"alog"</code>  (the default), for the symmetric logistic and the asymmetric logistic model respectively.</p>
</td></tr>
<tr><td><code id="gen.ds_+3A_sub">sub</code></td>
<td>
<p>An optional list of subsets of <code class="reqn">\{1,...,d\}</code> involved in the tail dependence structure. If <code>type = "log"</code>, then <code>sub</code> should be given by <code class="reqn">(1,\ldots,d)</code>, which is the way the code <code>NULL</code> will be interpreted. If <code>type = "alog"</code> and <code>sub = NULL</code> then  a random  list of vectors,  subsets of  <code class="reqn">\{1,...,d\}</code>, is created. The cardinality of non singleton subsets in <code>sub</code> is given by <code>mnns</code>.  If the user provides <code>sub</code>, it has to be a list of vectors,  subsets of <code class="reqn">\{1,...,d\}</code>, where each component from <code class="reqn">\{1,...,d\}</code> appears at least once; Otherwise, one should add the missing singleton(s).</p>
</td></tr>
<tr><td><code id="gen.ds_+3A_dep">dep</code></td>
<td>
<p>An optional vector of dependence parameter(s). If <code>type = "log"</code>, <code>dep</code> should be a single value. Otherwise, if <code>type = "alog"</code> and if the list <code>sub</code> is provided, then the length of the vector <code>dep</code> should be equal to that of the list <code>sub</code> (or a single value that will be replicated the length of <code>sub</code> times). Among these values, the dependence parameters associated singletons have to be equal to one. Otherwise, the values of <code>dep</code> associated to singleton will be ignored (and set to one).  When  <code>dep = NULL</code> its values are randomly generated.</p>
</td></tr>
<tr><td><code id="gen.ds_+3A_asy">asy</code></td>
<td>
<p>An optional list of asymmetric weights. If <code>type = "log"</code>, then <code>asy</code> should be the vector <code class="reqn">(1,\ldots,1)</code>, which is the way the code <code>NULL</code> will be interpreted. If <code>type = "alog"</code> and if <code>sub</code> is provided, the length of the list <code>asy</code> should be in accordance with the length of <code>sub</code>.   If <code>asy = NULL</code> then the values are randomly generated. Note that <code>asy</code> satisfies the sum-to-one constraints.</p>
</td></tr>
<tr><td><code id="gen.ds_+3A_mnns">mnns</code></td>
<td>
<p>The default value is arbitrarily equal to <code class="reqn">d</code>. When <code>sub = NULL</code>, the list <code>sub</code> is randomly generated, and its size is closely related to <code>mnns</code>. The latter represents the number of non singletons subsets included in <code>sub</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A multivariate extreme value logistic (Mevlog) model is symmetric or asymmetric.
</p>

<ul>
<li><p><code>type = "log". </code> It generates a multivariate symmetric logistic model. Such model is a well-known generalization of the bivariate extreme value logistic model introduced by Gumbel (1960). The parameter 'dep'  (with <code class="reqn">0 &lt; `dep` \leq 1</code>) is the only parameter needed to write the following equation
</p>
<p style="text-align: center;"><code class="reqn">\ell(u) = ( \sum_{i=1}^d u_i^{1/\code{dep}} )^{\code{dep}}.</code>
</p>

<p>If the parameter <code>dep</code> is missing, the function <code>gen.ds</code>  will randomly generate its value from a standard uniform distribution.
The list <code>asy</code> is reduced to a vector of ones whereas the list <code>sub</code> only contains the maximal vector <code class="reqn">(1, \ldots, d)</code>.
</p>
<p>This is a special case of the multivariate asymmetric logistic model (<code>alog</code> case).
</p>
</li>
<li><p><code>type = "alog". </code>It generates a  multivariate asymmetric logistic model, which has been first introduced by Tawn (1990). We have
</p>
<p style="text-align: center;"><code class="reqn">\ell(u)=\sum_{b\in B}  (\sum_{i \in b} (\beta_{i,b}u_i)^{1/\alpha_b})^{\alpha_b}</code>
</p>

<p>where <code class="reqn">B</code> is the power set of <code class="reqn">\{1,...,d\}</code> (or a strict subset of the power set), the dependence parameters <code class="reqn">\alpha_b</code> lie in <code class="reqn">(0,1]</code> and the collection of asymmetric weights <code class="reqn">\beta_{i,b}</code> are coefficients from [0,1] satisfying <code class="reqn">\forall i \in \{1,\ldots,d\}, \sum_{b\in B: i \in b} \beta_{i,b}=1</code>.
Missing asymmetric weights <code class="reqn">\beta_{i,b}</code> are assumed to be zero. 
</p>
</li></ul>

<p>The function <code>gen.ds</code>  generates here an object of class <code>ds</code> which corresponds in this package to the stable tail dependence function <code class="reqn">\ell</code>. The class <code>ds</code> consists of:
</p>

<ul>
<li><p>the dimension <code>d</code>.
</p>
</li>
<li><p>the type <code>"log"</code> or <code>alog</code>.
</p>
</li>
<li><p>the list <code>sub</code> that corresponds to <code class="reqn">B</code>.
When <code>sub</code> is provided, the same list of subsets is returned, eventually sorted. When <code>sub = NULL</code> then <code>sub</code> is a list of subsets of the power set of <code class="reqn">\{1,...,d\}</code>. When the option <code>mnns</code> is used, the latter integer indicates the cardinality of non singleton subsets in <code class="reqn">B</code>.
</p>
<p>the dependence parameter <code>dep</code> or the vector of dependence parameters <code>dep</code>. When missing, these coefficients are obtained from independent standard uniform sampling.

</p>
<p>the list <code>asy</code> of asymmetric weights <code class="reqn">\beta_{i,b}</code> for <code class="reqn">b \in B</code>  and <code class="reqn">i \in b</code>. When missing, these coefficients are obtained from independent standard uniform sampling followed by renormalization in order to satisfy the sum-to-one constraints.

</p>
</li></ul>



<h3>Value</h3>

<p><code>gen.ds</code> returns an object representing a tail dependence structure for Mevlog models.
Such object is a list containing  the following components:
</p>

<ul>
<li><p><code>d</code> The dimension.
</p>
</li>
<li><p><code>type</code> The type of the model either <code>"log"</code> or <code>"alog"</code>.
</p>
</li>
<li><p><code>sub</code> The list of subsets of <code class="reqn">\{1,...,d\}</code> involved in the tail dependence support.
</p>
</li>
<li><p><code>dep</code>  The vector of dependence parameter(s).
</p>
</li>
<li><p><code>asy</code> The list of asymmetric weights.
</p>
</li></ul>



<h3>Note</h3>

<p>The first interest of the <code>gen.ds</code> function is to generate randomly a tail dependence structure. Since <code>sub</code> and <code>asy</code> become quickly very large lists as <code class="reqn">d</code> increases, it is very convenient to obtain automatically well-defined tail dependence structures for  multivariate extreme value logistic models.
</p>
<p>The second interest of the <code>gen.ds</code> function is to produce partial models where all subsets do not necessarily contribute to the tail dependence support.
</p>
<p>The function <code>gen.ds</code> does not manage margins characteristics which will be handle by the option <code>mar</code> in the  <code>r-d-p-Mevlog</code> functions.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Gumbel, E. J. (1960)
Distributions des valeurs extremes en plusieurs dimensions.
<em>Publ. Inst. Statist. Univ. Paris</em>, <b>9</b>, 171&ndash;173.
</p>
<p>Stephenson, A. (2002)
evd: Extreme Value Distributions.
<em>R News</em>, 2(2):31&ndash;32.
</p>
<p>Tawn, J. A. (1990)
Modelling multivariate extreme value distributions.
<em>Biometrika</em>, <b>77</b>, 245&ndash;253.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ellMevlog">ellMevlog</a></code>, <code><a href="#topic+graphs">graphs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 5-dimensional symmetric tail dependence structure
## The dependence paramater is fixed to .7
(ds5 &lt;- gen.ds(d = 5, dep = .7, type = "log"))

## Fix a 3-dimensional asymmetric tail dependence structure
## The list sub and asy are provided ; The vector dep is randomly generated
(ds3 &lt;- gen.ds(d = 3, sub = list(c(1,2), c(1,2,3)), asy = list(c(0.4,0.6), c(0.6,0.4,1))))
graphs(ds = ds3)

## Fix a 8-dimensional asymmetric tail dependence structure
## The lists sub and asy, as the vector dep, are randomly generated
(ds8 &lt;- gen.ds(d = 8))
graphs(ds = ds8)

</code></pre>

<hr>
<h2 id='graphs'>Graphs of the tail dependence structure for Mevlog models.</h2><span id='topic+graphs'></span>

<h3>Description</h3>

<p>Tail dependograph and Inverse extremal coefficients graph  for Mevlog models.   A <code>Mevlog</code> model is a multivariate extreme value (symmetric or asymmetric) logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphs(
  ds,
  names = NULL,
  n.MC = 1000,
  which = "taildependograph",
  random = FALSE,
  thick.td = 5,
  thick.ec = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphs_+3A_ds">ds</code></td>
<td>
<p>An object of class <code>ds</code>.</p>
</td></tr>
<tr><td><code id="graphs_+3A_names">names</code></td>
<td>
<p>A character vector of length <code>d</code> which replaces <code>as.character(1:d)</code> (the default ones).</p>
</td></tr>
<tr><td><code id="graphs_+3A_n.mc">n.MC</code></td>
<td>
<p>Monte Carlo sample size. Default value is 1000. See details in  <code><a href="#topic+tsic">tsic</a></code>.</p>
</td></tr>
<tr><td><code id="graphs_+3A_which">which</code></td>
<td>
<p>A character string:  <code>taildependograph</code> (the default), <code>iecgraph</code>, or <code>both</code>,</p>
</td></tr>
<tr><td><code id="graphs_+3A_random">random</code></td>
<td>
<p>A boolean. 'FALSE' (the default): the vertex positions are fixed along a circle.  'TRUE': some randomness is applied for positioning the vertices.</p>
</td></tr>
<tr><td><code id="graphs_+3A_thick.td">thick.td</code></td>
<td>
<p>A numeric value for the maximal thickness of edges in <code>taildependograph</code>. Default value is 5.</p>
</td></tr>
<tr><td><code id="graphs_+3A_thick.ec">thick.ec</code></td>
<td>
<p>A numeric value for the maximal thickness of edges in <code>iecgraph</code>. Default value is 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tail dependence structure is set by a <code>ds</code> object. It thus corresponds to the stable tail dependence function <code class="reqn">\ell</code>. The way to deduce the stable tail dependence function <code class="reqn">\ell</code> from <code>ds</code> is explained in the Details section of <code><a href="#topic+gen.ds">gen.ds</a></code>.
</p>


<h3>Value</h3>

<p>The function returns either the tail dependograph or the inverse extremal coefficients graph, or both, for the tail dependence structure 'ds'.
</p>
<p>The tail dependograph displays pairwise tail superset importance coefficients, which measure the extent to which pairs of components (and their supersets) contribute to the overall variance of the stable tail dependence function.
We refer to  Mercadier, C. and Roustant, O. (2019) for more details. These coefficients are computed using the 'tsic' function with the '&quot;ind = 2&quot;' option.
</p>
<p>The inverse extremal coefficients graph shows the inverse renormalized pairwise coefficients computed as <code class="reqn">\theta_{ij}=1-\ell(1_i,1_j,\bold{0})/2</code>.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>
<p>Tiago de Oliveira, J. (1962/63)
Structure theory of bivariate extremes, extensions.
<em>Estudos de Matematica, Estatistica, e Economicos</em>, 7:165&ndash;195.
</p>
<p>Smith, R. L. (1990)
Max-stable processes and spatial extremes.
<em>Dept. of Math., Univ. of Surrey</em>, Guildford GU2 5XH, England.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsic">tsic</a></code>, <code><a href="#topic+ec">ec</a></code>, <code><a href="#topic+ellMevlog">ellMevlog</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 8-dimensional asymmetric tail dependence structure
ds8 &lt;- gen.ds(d = 8)

## Plot the graphs that illustrate  characteristics of the tail dependence structure
graphs(ds = ds8, which = "both")

</code></pre>

<hr>
<h2 id='graphsEmp'>Empirical graphs of the tail dependence structure.</h2><span id='topic+graphsEmp'></span>

<h3>Description</h3>

<p>Empirical tail dependograph and  empirical inverse extremal coefficients graph of the tail dependence structure on a <code>sample</code> associated with threshold k.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphsEmp(
  sample,
  layout = NULL,
  names = NULL,
  k,
  which = "taildependograph",
  select = NULL,
  simplify = FALSE,
  random = FALSE,
  thick.td = 5,
  thick.ec = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphsEmp_+3A_sample">sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_layout">layout</code></td>
<td>
<p>The vertex coordinates as a <code>(d times 2)</code> matrix. The default is NULL. See also the parameter <code>random</code>.</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_names">names</code></td>
<td>
<p>A character vector of length <code>d</code> which replaces <code>as.character(1:d)</code> (the default ones).</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_k">k</code></td>
<td>
<p>An integer smaller or equal to <code>n</code>.</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_which">which</code></td>
<td>
<p>A character string: <code>taildependograph</code> (the default), <code>iecgraph</code> or  <code>both</code>.</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_select">select</code></td>
<td>
<p>If select = NULL (default) all edges are plotted. If select is an integer between 1 and the number of possible pairs of components of sample, then only the select largest edges are plotted.</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_simplify">simplify</code></td>
<td>
<p>If select is not NULL, and if a vertex is not associated with one of the selected edges, this vertex is not printed.</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_random">random</code></td>
<td>
<p>A boolean. 'FALSE' (the default): the vertex positions are fixed along a circle when layout is NULL.  'TRUE': some randomness is applied for positioning the vertices.</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_thick.td">thick.td</code></td>
<td>
<p>A numeric value for the maximal thickness of edges in <code>taildependograph</code>. Default value is 5.</p>
</td></tr>
<tr><td><code id="graphsEmp_+3A_thick.ec">thick.ec</code></td>
<td>
<p>A numeric value for the maximal thickness of edges in <code>iecgraph</code>. Default value is 5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns both (or one among) the empirical tail dependograph and the empirical inverse extremal coefficients graph of the  <code>sample</code>.
</p>
<p>The empirical tail dependograph represents the pairwise empirical  tail superset importance coefficients, see  Mercadier, C. and Roustant, O. (2019).
These indices are computed by the function <code>tsicEmp</code>.
It measures how much a pair of components (included supersets of this pair of components) is involved in the asymptotic dependence of the sample.
</p>
<p>The empirical Inverse extremal coefficients graph represents empirical pairwise coefficients that estimate <code class="reqn">1-\ell(1_i,1_j,\bold{0})/2</code>.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecEmp">ecEmp</a></code>, <code><a href="#topic+tsicEmp">tsicEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 8-dimensional asymmetric tail dependence structure
ds8 &lt;- gen.ds(d = 8)

## Generate a 200-sample of Frechet margins Mevlog model associated with ds8
sample8 &lt;- rMevlog(n = 200 , ds = ds8)

## Plot the tail dependograph of ds8
graphs(ds = ds8)

## Its empirical version for k = 20
graphsEmp(sample = sample8, k = 20)

## Its empirical version for k = 20 restricted to the 3 largest edges
graphsEmp(sample = sample8, k = 20, select = 3)

## Plot the Inverse extremal coefficients graph of ds8
graphs(ds = ds8, which = "iecgraph")

## Its empirical version for k = 20
graphsEmp(sample = sample8, k = 20, which = "iecgraph")

## Its empirical version for k = 20 restricted to the 3 largest edges
graphsEmp(sample = sample8, k = 20, which = "iecgraph", select = 3)

## Plot the empirical tail dependograph
## on river discharge data for tributaries
## of the Danube extracted from
##  Asadi P., Davison A.C., Engelke S. (2015).
## “Extremes on river networks.”
## The Annals of Applied Statistics, 9(4), 2023 – 2050.
#NOT RUN dan &lt;- graphicalExtremes::danube$data_clustered
#NOT loc &lt;- as.matrix(graphicalExtremes::danube$info[,c('PlotCoordX', 'PlotCoordY')])
#NOT graphsEmp(dan,  k=50, layout = loc)

</code></pre>

<hr>
<h2 id='graphsMapEmp'>Empirical graphs drawn on geographical maps of the tail dependence structure.</h2><span id='topic+graphsMapEmp'></span>

<h3>Description</h3>

<p>Empirical tail dependograph and  Empirical inverse extremal coefficients graph drawn on geographical maps for the tail dependence structure of <code>sample</code> associated with threshold k.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphsMapEmp(
  sample,
  k,
  which = "taildependograph",
  names = NULL,
  coord,
  region = NULL,
  select = NULL,
  thick.td = 5,
  thick.ec = 5,
  eps = 0.03
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphsMapEmp_+3A_sample">sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_k">k</code></td>
<td>
<p>An integer smaller or equal to <code>n</code>.</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_which">which</code></td>
<td>
<p>A character string: <code>both</code>, <code>taildependograph</code> (the default) or <code>iecgraph</code>.</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_names">names</code></td>
<td>
<p>A character vector for <code>sample</code> columns which replaces <code>as.character(1:d)</code> (the default ones).</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_coord">coord</code></td>
<td>
<p>Latitudes and Longitudes associated with <code>sample</code> columns associated to <code>region</code> map when <code>region</code> is furnished.</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_region">region</code></td>
<td>
<p>A geographical region from <code>maps</code> package. The default value is NULL.</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_select">select</code></td>
<td>
<p>If select is NULL (the default) all edges are plotted. If select is an integer between 1 and the number of possible pairs of components of sample, then only the select largest edges are plotted.</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_thick.td">thick.td</code></td>
<td>
<p>A numeric value for the maximal thickness of edges in <code>taildependograph</code>. Default value is 5.</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_thick.ec">thick.ec</code></td>
<td>
<p>A numeric value for the maximal thickness of edges in <code>iecgraph</code>. Default value is 5.</p>
</td></tr>
<tr><td><code id="graphsMapEmp_+3A_eps">eps</code></td>
<td>
<p>A numerical graphical value fixing the distance between the plotted point and its names.  The default value is 0.03.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns both (or one among) the empirical tail dependograph and the empirical inverse extremal coefficients graph on a geographical map of the  <code>sample</code>.
</p>
<p>The empirical tail dependograph on a geographical map represents the pairwise empirical  tail superset importance coefficients of the locations associated with <code>sample</code> columns, see  Mercadier, C. and Roustant, O. (2019).
These indices are computed by the function <code>tsicEmp</code>.
It measures how much a pair of components (included supersets of this pair of components) is involved in the asymptotic dependence of the sample.
</p>
<p>The empirical inverse extremal coefficients graph  on a geographical map represents empirical pairwise coefficients of the locations associated with <code>sample</code> columns that estimate <code class="reqn">1-\ell(1_i,1_j,\bold{0})/2</code>.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>
<p>Becker, R. A.,  Wilks, A. R. (Original S code),  Brownrigg, R. (R version),  Minka, T. P. and  Deckmyn A. (Enhancements).  (2022)
maps : Draw Geographical Maps.
<em>R package version 3.4.1.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+graphsEmp">graphsEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(France)

## Figure 9 (a) of Mercadier  and Roustant (2019).
graphsMapEmp(France$ymt, k = 55,
 coord = France$coord,  region = 'France', select = 9)

## Figure 9 (b) of Mercadier  and Roustant (2019).
graphsMapEmp(France$ymt, k = 55,
 coord = France$coord,  region = 'France', select = 30)

## Figure 9 (c) of Mercadier  and Roustant (2019).
graphsMapEmp(France$ymt, k = 55,
 coord = France$coord,  region = 'France')

</code></pre>

<hr>
<h2 id='plotClev'>Cleveland's Dot Plots of the tail dependence structure.</h2><span id='topic+plotClev'></span>

<h3>Description</h3>

<p>Global comparison of the theoretical tail superset importance coefficients (tsic) via a Cleveland's Dot Plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotClev(ds, ind = "all", which = "tsic", labels = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotClev_+3A_ds">ds</code></td>
<td>
<p>An object of class <code>ds</code>.</p>
</td></tr>
<tr><td><code id="plotClev_+3A_ind">ind</code></td>
<td>
<p>A character string among &quot;with.singletons&quot; and &quot;all&quot; (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = "all"</code>.</p>
</td></tr>
<tr><td><code id="plotClev_+3A_which">which</code></td>
<td>
<p>A character string among &quot;tsic&quot; (normalized tsic plot), and &quot;ec&quot; (normalized ec plot).</p>
</td></tr>
<tr><td><code id="plotClev_+3A_labels">labels</code></td>
<td>
<p>A boolean. 'TRUE' the default indicates that the names of the subsets are printed. 'FALSE' if only points are drawn.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Draws a Cleveland dot plot of the normalized theoretical tsic when <code>superset = TRUE</code>, the default value.
</p>
<p>Otherwise theoretical normalized ec are drawn.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotClevEmp">plotClevEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fix a 6-dimensional asymmetric tail dependence structure
## Two blocks of components are specified
ds6 &lt;- gen.ds(d = 6, sub = list(1:4,5:6))

## Plot the associated Cleveland dot plot
plotClev(ds6)

</code></pre>

<hr>
<h2 id='plotClevEmp'>Empirical Cleveland's Dot Plots of the tail dependence structure.</h2><span id='topic+plotClevEmp'></span>

<h3>Description</h3>

<p>Global comparison of the empirical tail superset importance coefficients (tsicEmp) via a Cleveland's Dot Plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotClevEmp(sample, k, ind = "all", which = "tsic", labels = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotClevEmp_+3A_sample">sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="plotClevEmp_+3A_k">k</code></td>
<td>
<p>An integer smaller or equal to <code>n</code>.</p>
</td></tr>
<tr><td><code id="plotClevEmp_+3A_ind">ind</code></td>
<td>
<p>A character string among &quot;with.singletons&quot; and &quot;all&quot; (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = "all"</code>.</p>
</td></tr>
<tr><td><code id="plotClevEmp_+3A_which">which</code></td>
<td>
<p>A character string among &quot;tsic&quot; (empirical normalized tsic plot), and &quot;ec&quot; (empirical normalized ec plot).</p>
</td></tr>
<tr><td><code id="plotClevEmp_+3A_labels">labels</code></td>
<td>
<p>A boolean. 'TRUE' the default indicates that the names of the subsets are printed. 'FALSE' if only points are drawn.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Draws a Cleveland dot plot of the normalized empirical tsic when <code>superset = TRUE</code>, the default value.
</p>
<p>Otherwise empirical normalized ec are drawn.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotClev">plotClev</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 5-dimensional asymmetric tail dependence structure
(ds5 &lt;- gen.ds(d = 5))

## Generate a 1000-sample of Mevlog random vectors associated with ds5
sample5 &lt;- rMevlog(n = 1000, ds = ds5)

## Plot the empirical Cleveland dot plot (restricted to pairs)
plotClevEmp(sample5,  k = 100,  ind = 2)

</code></pre>

<hr>
<h2 id='rArchimaxMevlog'>r function for Archimax Mevlog models.</h2><span id='topic+rArchimaxMevlog'></span>

<h3>Description</h3>

<p>Random vectors generation for some Archimax Mevlog models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rArchimaxMevlog(n, ds, dist = "exp", dist.param = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rArchimaxMevlog_+3A_n">n</code></td>
<td>
<p>The number of observations.</p>
</td></tr>
<tr><td><code id="rArchimaxMevlog_+3A_ds">ds</code></td>
<td>
<p>An object of class <code>ds</code>.</p>
</td></tr>
<tr><td><code id="rArchimaxMevlog_+3A_dist">dist</code></td>
<td>
<p>The underlying distribution. A character string among <code>"exp"</code> (the default value), <code>"gamma"</code> and <code>"ext"</code>.</p>
</td></tr>
<tr><td><code id="rArchimaxMevlog_+3A_dist.param">dist.param</code></td>
<td>
<p>The parameter associated with the choice <code>dist</code>.  If <code>dist</code> is <code>"exp"</code>, then <code>dist.param</code> is a postive real, the parameter of an exponential distribution. The default value is 1. If <code>dist</code> is <code>"gamma"</code>, then <code>dist.param</code> is a vector that concatenates the shape  and  scale parameters (in this order) of a gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We follow below  Algorithm 4.1 of p. 124 in Charpentier et al. (2014). Let <code class="reqn">\psi</code> defined by <code class="reqn">\psi(x)=\int_0^\infty \exp(-x t) dF(t)</code>, the Laplace transform of a positive random variable with  cumulative distribution function <code class="reqn">F</code>.
</p>
<p>Define the random vector <code class="reqn">(U_1,...,U_d)</code> as <code class="reqn">U_i=\psi(-\log(Y_i)/V)</code> where
</p>

<ul>
<li> <p><code class="reqn">Z</code> has a multivariate extreme value distribution with stable tail dependence function <code class="reqn">\ell</code> ; here <code class="reqn">Z</code> has standard Frechet margins,
</p>
</li>
<li> <p><code class="reqn">(Y_1,...,Y_d)=(\exp(-1/Z_1),...,\exp(-1/Z_d))</code> the margin transform of <code class="reqn">Z</code> so that <code class="reqn">Y</code> is sampled from the extreme value copula associated with <code class="reqn">\ell</code>,
</p>
</li>
<li> <p><code class="reqn">V</code> has the distribution function <code class="reqn">F</code>,
</p>
</li>
<li> <p><code class="reqn">Y</code> and <code class="reqn">V</code> are independent.
</p>
</li></ul>

<p>Then,  <code class="reqn">U</code> is sampled from the Archimax copula <code class="reqn">C(u_1,...,u_d) = \psi(\ell(\psi^{-1}(u_1),...,\psi^{-1}(u_d)))</code>.
</p>
<p>We restrict here the function <code class="reqn">\ell</code> to those associated with Mevlog models. See <code><a href="#topic+ellMevlog">ellMevlog</a></code> and <code><a href="#topic+gen.ds">gen.ds</a></code>.
</p>
<p>We restrict also the distribution of <code class="reqn">V</code> to
</p>

<ul>
<li><p> exponential ; For a positive <code class="reqn">\lambda</code>, set <code class="reqn">dF(t)=\lambda \exp(-\lambda t) 1_{t&gt;0} dt</code>,  then <code class="reqn">\psi(x)=\frac{\lambda}{x+\lambda}</code> and <code class="reqn">\psi^{-1}(x)=\lambda \frac{1-x}{x}</code>.
</p>
</li>
<li><p> gamma ; For positive scale <code class="reqn">\sigma</code> and shape <code class="reqn">a</code>, set <code class="reqn">dF(t)= \frac{1}{\sigma^a \Gamma(a)}t^{a-1}\exp(-t/\sigma)1_{t&gt;0}</code>, then <code class="reqn">\psi(x)=\frac{1}{(x+\sigma)^a}</code> and <code class="reqn">\psi^{-1}(x)=\frac{x^{-1/a}-1}{\sigma}</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>returns a <code>n x d</code> matrix containing <code>n</code> realizations of a <code>d</code>-variate Archimax Mevlog random vector.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Charpentier, A.,   Fougères,  A.-L.,  Genest, C. and  Nešlehová, J.G. (2014)
Multivariate Archimax copulas.
<em>Journal of Multivariate Analysis</em>, <b>126</b>, 118&ndash;136.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rMevlog">rMevlog</a></code>,    <code><a href="#topic+copArchimaxMevlog">copArchimaxMevlog</a></code>, <code><a href="#topic+psiArchimaxMevlog">psiArchimaxMevlog</a></code>,  <code><a href="#topic+psiinvArchimaxMevlog">psiinvArchimaxMevlog</a></code>, <code><a href="#topic+gen.ds">gen.ds</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a  5-dimensional asymmetric tail dependence structure
(ds5 &lt;- gen.ds(d = 5))

## Generate a 1000-sample of Archimax Mevlog random vectors
## associated with ds5 and underlying distribution gamma
(shape5 &lt;- runif(1, 0.01, 5))
(scale5 &lt;- runif(1, 0.01, 5))
sample5.gamma &lt;- rArchimaxMevlog(n = 1000, ds = ds5, dist = "gamma", dist.param = c(shape5, scale5))

## Compare theoretical (left) and empirical (right) tail dependographs
oldpar &lt;- par(mfrow = c(1,2))
graphs(ds = ds5)
graphsEmp(sample = sample5.gamma, k = 100)
par(oldpar)

## Generate a 1000-sample of Archimax Mevlog random vectors
## associated with ds5 and underlying distribution exp
(lambda &lt;- runif(1, 0.01, 5))
sample5.exp &lt;- rArchimaxMevlog(n = 1000, ds = ds5, dist = "exp", dist.param = lambda)
## Compare theoretical (left) and empirical (right) tail dependographs
graphs(ds = ds5)
graphsEmp(sample = sample5.exp, k = 100)

</code></pre>

<hr>
<h2 id='rMevlog'>r-p-d-ell- functions for Mevlog models.</h2><span id='topic+rMevlog'></span><span id='topic+pMevlog'></span><span id='topic+dMevlog'></span><span id='topic+ellMevlog'></span>

<h3>Description</h3>

<p>Random vectors generation (<code>rMevlog</code>),  cumulative distribution function (<code>pMevlog</code>), probability density function (<code>dMevlog</code>), stable tail dependence function (<code>ellMevlog</code>) for Mevlog models. A <code>Mevlog</code> model is a multivariate extreme value (symmetric or asymmetric) logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rMevlog(n, ds, mar = c(1,1,1))
pMevlog(x, ds, mar = c(1,1,1))
dMevlog(x, ds, mar = c(1,1,1))
ellMevlog(x, ds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rMevlog_+3A_n">n</code></td>
<td>
<p>The number of observations.</p>
</td></tr>
<tr><td><code id="rMevlog_+3A_ds">ds</code></td>
<td>
<p>An object of class <code>ds</code>.</p>
</td></tr>
<tr><td><code id="rMevlog_+3A_mar">mar</code></td>
<td>
<p>A vector of length 3 or a <code>(d times 3)</code> matrix.  See details.</p>
</td></tr>
<tr><td><code id="rMevlog_+3A_x">x</code></td>
<td>
<p>A vector of size <code>d</code> or a matrix with <code>d</code> columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tail dependence structure is set by a <code>ds</code> object.  See Section <b>Value</b> in <code><a href="#topic+gen.ds">gen.ds</a></code>.
</p>
<p>The marginal information <code>mar</code> is given by a 3-dimensional vector (the order should be location, scale and shape) or a matrix with 3 columns depending on whether the components share the same characteristics or not.   When the marginal parameters differ, <code>mar</code> is a matrix containing <code class="reqn">d</code> locations in the first column, <code class="reqn">d</code> scales in the second column and <code class="reqn">d</code> shapes in the third column.
</p>
<p>The (a)symmetric logistic models respectively are simulated in 'rMevlog' using Algorithms 2.1 and 2.2 in Stephenson(2003).
</p>


<h3>Value</h3>

<p><code>rMevlog</code>  returns a <code>(n times d)</code>  matrix  containing <code>n</code> realizations of a <code>d</code>-variate Mevlog random vector with margins <code>mar</code> and tail dependence structure <code>ds</code>.
</p>
<p><code>pMevlog</code> returns a  scalar (when <code>x</code> is a numeric vector) or a vector (when <code>x</code> is a numeric matrix, in which case the evaluation is done across the rows). The margins are provided by <code>mar</code> and the tail dependence structure through a <code>ds</code> object.
</p>
<p><code>dMevlog</code> returns a  scalar (when <code>x</code> is a numeric vector) or a vector (when <code>x</code> is a numeric matrix, in which case the evaluation is done across the rows). The margins are provided by <code>mar</code> and the tail  dependence structure through a <code>ds</code> object.
</p>
<p><code>ellMevlog</code> returns a  scalar (when <code>x</code> is a numeric vector) or a vector (when <code>x</code> is a numeric matrix, in which case the evaluation is done across the rows). The tail dependence structure is provided by a <code>ds</code> object.
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Gumbel, E. J. (1960)
Distributions des valeurs extremes en plusieurs dimensions.
<em>Publ. Inst. Statist. Univ. Paris</em>, <b>9</b>, 171&ndash;173.
</p>
<p>Stephenson, A. (2002)
evd: Extreme Value Distributions.
<em>R News</em>, 2(2):31&ndash;32.
</p>
<p>Stephenson, A. (2003)
Simulating Multivariate Extreme Value Distributions of Logistic Type.
<em>Extremes</em>, <b>6</b>, 49&ndash;59.
</p>
<p>Tawn, J. A. (1990)
Modelling multivariate extreme value distributions.
<em>Biometrika</em>, <b>77</b>, 245&ndash;253.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gen.ds">gen.ds</a></code>, <code><a href="#topic+tsic">tsic</a></code>,  <code><a href="#topic+ec">ec</a></code>, <code><a href="#topic+graphs">graphs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fix a 3-dimensional symmetric tail dependence structure
ds3 &lt;- gen.ds(d = 3, type = "log")

## The dependence parameter is given by
ds3$dep

## Generate a 1000-sample of Mevlog random vectors associated with ds3
## The margins are kept as standard  Frechet
sample3 &lt;- rMevlog(n = 1000, ds = ds3)

## Fix a 10-dimensional asymmetric tail dependence structure
# The option \cdoe{mns = 4} produces a support involving subsets of cardinality 4 plus singletons.
ds10 &lt;- gen.ds(d = 10,  mnns = 4)
## Margins differ from one to another
mar10 &lt;- matrix(runif(10*3), ncol = 3)

## Generate a 50-sample of Mevlog random vectors associated with ds10 and mar10
sample10 &lt;- rMevlog(n = 50, ds = ds10, mar = mar10)

## Continuing with ds3 ; we compute other attributes
## The cumulative distribution function
pMevlog(x = rep(1,3), ds = ds3)
# should be similar to :
# evd::pmvevd(q = rep(1,3), dep = ds3$dep, model = "log", d = 3, mar = c(1,1,1))
## The probability density function:
dMevlog(x = rep(1,3), ds = ds3, mar = c(1.2,1,0.5))
# should be similar to :
# evd::dmvevd(x = rep(1,3), dep = ds3$dep, model = "log", d = 3, mar = c(1.2,1,0.5))
## The stable tail dependence function:
ellMevlog(x = rep(1,3), ds = ds3)

</code></pre>

<hr>
<h2 id='Stock'>Dataset. Yearly maxima of Log Returns of ten stock indices 1990-2015.</h2><span id='topic+Stock'></span>

<h3>Description</h3>

<p>This dataset consists of a matrix with years as rows and columns as stock indices. They appear in the following order: &quot;SP500&quot;, &quot;DJ&quot;, &quot;NASD&quot;, &quot;SMI&quot;, &quot;EURS&quot;, &quot;CAC&quot;, &quot;DAX&quot;,  &quot;HSI&quot;,  &quot;SSEC&quot;,  &quot;NIKK&quot;. A cell gives the yearly maximum of Log Returns of the associated stock indices. The latter values have been extracted from the R package <code>qrmdata</code> of Hofert, M., Hornik, K. and McNeil, A.J. (2019).
</p>


<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Hofert, M., Hornik, K. and McNeil, A.J. (2019).
qrmdata: Data Sets for Quantitative Risk Management Practice.
R package version 2019-12-03-1
URL https://CRAN.R-project.org/package=qrmdata.
</p>
<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+graphsEmp">graphsEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Stock)

## We reproduce below Figure 7(a) of Mercadier and Roustant (2019).

graphsEmp(Stock, k = 26, which = "taildependograph", names = colnames(Stock))

## We reproduce below Figure 8(a) of Mercadier and Roustant (2019).

graphsEmp(Stock, k = 26, which = "taildependograph", names = colnames(Stock), select = 9)

## We reproduce below Figure 8(b) of Mercadier and Roustant (2019).

graphsEmp(Stock, k = 26, which = "taildependograph", names = colnames(Stock), select = 20)
</code></pre>

<hr>
<h2 id='tic'>Tail importance coefficients for Mevlog models.</h2><span id='topic+tic'></span>

<h3>Description</h3>

<p>Computes  the tail  importance coefficients (tic) on a <code>Mevlog</code> model which is a multivariate extreme value (symmetric or asymmetric) logistic model, descibed here by its dependence structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tic(ds, ind = 2, n.MC = 1000, sobol = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tic_+3A_ds">ds</code></td>
<td>
<p>An object of class <code>ds</code>.</p>
</td></tr>
<tr><td><code id="tic_+3A_ind">ind</code></td>
<td>
<p>A character string among &quot;with.singletons&quot; and &quot;all&quot; (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = 2</code>, all pairwise coefficients are computed.</p>
</td></tr>
<tr><td><code id="tic_+3A_n.mc">n.MC</code></td>
<td>
<p>Monte Carlo sample size. Default value is 1000. See details in  <code><a href="#topic+tsic">tsic</a></code>.</p>
</td></tr>
<tr><td><code id="tic_+3A_sobol">sobol</code></td>
<td>
<p>A boolean. 'FALSE' (the default). If 'TRUE':  the index is normalized by the theoretical global variance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tail dependence structure is specified using a <code>ds</code> object, which corresponds to the stable tail dependence function  <code class="reqn">\ell</code>.
The process for deducing  the stable tail dependence function <code class="reqn">\ell</code> from <code>ds</code> is explained in the Details section of <code><a href="#topic+gen.ds">gen.ds</a></code>.
</p>
<p>The theoretical functional decomposition of the variance of the stdf <code class="reqn">\ell</code> consists in writing <code class="reqn">D(\ell) = \sum_{I \subseteq \{1,...,d\}} D_I(\ell) </code> where <code class="reqn">D_I(\ell)</code> measures the variance of <code class="reqn">\ell_I(U_I)</code> the term associated with subset <code class="reqn">I</code> in the Hoeffding-Sobol decomposition of <code class="reqn">\ell</code>
; note that <code class="reqn">U_I</code> represents  a random vector with independent standard uniform entries.
The theoretical tail importance coefficient (tic) is thus <code class="reqn">D_I(\ell)</code> and  its sobol version is <code class="reqn">S_I(\ell)=\dfrac{D_I(\ell)}{D(\ell)}</code>.
</p>
<p>The function <code>tic</code> uses the Mobius inversion formula, see Formula (8) in Liu and Owen (2006), to derive the tic from the tsic. The latter are the tail superset importance coefficients obtained by the function <code><a href="#topic+tsic">tsic</a></code>.
</p>


<h3>Value</h3>

<p>The function returns a list of two elements:
</p>

<ul>
<li><p><code>subsets</code> A list of subsets from  <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind</code> is given as an integer, <code>subsets</code> is the list of subsets from  <code class="reqn">\{1,...,d\}</code> with cardinality <code>ind</code>.
</p>
<p>When <code>ind</code> is a list, it corresponds to <code>subsets</code>.
</p>
<p>When <code>ind = "with.singletons"</code>  subsets is the list of all non empty subsets in <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind = "all"</code>   subsets is the list of all subsets in <code class="reqn">\{1,...,d\}</code> with cardinality larger or equal to 2.
</p>
</li>
<li><p><code>tic</code> A vector of tail importance coefficients, or their Sobol versions when <code>sobol = "TRUE"</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Liu, R. and Owen, A. B. (2006)
Estimating mean dimensionality of analysis of variance decompositions.
<em>J. Amer. Statist. Assoc.</em>, <b>101(474)</b>:712&ndash;721.
</p>
<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsic">tsic</a></code>, <code><a href="#topic+ticEmp">ticEmp</a></code>
</p>
<p><code><a href="#topic+ticEmp">ticEmp</a></code> and <code><a href="#topic+tsic">tsic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 4-dimensional asymmetric tail dependence structure
ds4 &lt;- gen.ds(d = 4, sub = list(1:2,3:4,1:3))

## Compute all tic values
res4 &lt;- tic(ds4, ind = "with.singletons", sobol = TRUE)

## Check the sum-to-one constraint of tail Sobol indices
sum(res4$tic)

</code></pre>

<hr>
<h2 id='ticEmp'>Empirical tail importance coefficients.</h2><span id='topic+ticEmp'></span>

<h3>Description</h3>

<p>Computes on a sample the tail  importance coefficients (tic) associated with threshold <code>k</code>. The value may be renormalized by the empirical global variance (Sobol version).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ticEmp(sample, ind = 2, k, sobol = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ticEmp_+3A_sample">sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="ticEmp_+3A_ind">ind</code></td>
<td>
<p>A character string among &quot;with.singletons&quot; and &quot;all&quot; (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = 2</code>, all pairwise coefficients are computed.</p>
</td></tr>
<tr><td><code id="ticEmp_+3A_k">k</code></td>
<td>
<p>An integer smaller or equal to <code>n</code>.</p>
</td></tr>
<tr><td><code id="ticEmp_+3A_sobol">sobol</code></td>
<td>
<p>A boolean. 'FALSE' (the default). If 'TRUE':  the index is normalized by the empirical global variance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The theoretical functional decomposition of the variance of the stdf <code class="reqn">\ell</code> consists in writing <code class="reqn">D(\ell) = \sum_{I \subseteq \{1,...,d\}} D_I(\ell) </code> where <code class="reqn">D_I(\ell)</code> measures the variance of <code class="reqn">\ell_I(U_I)</code> the term associated with subset <code class="reqn">I</code> in the Hoeffding-Sobol decomposition of <code class="reqn">\ell</code>
; note that <code class="reqn">U_I</code> represents  a random vector with independent standard uniform entries. The theoretical tail variance contribution is thus <code class="reqn">D_I(\ell)</code> and the theoretical tail sobol index is <code class="reqn">S_I(\ell)=\dfrac{D_I(\ell)}{D(\ell)}</code>.
</p>
<p>Here, the function <code>ticEmp</code> evaluates  <code class="reqn">\hat{D}_{I,k,n}</code> the empirical counterpart of <code class="reqn">D_I(\ell)</code> under the option <code>sobol = FALSE</code>, and <code class="reqn">\hat{S}_{I,k,n}</code> the empirical counterpart of <code class="reqn">S_I(\ell)</code> under the option <code>sobol = TRUE</code>.
</p>
<p>Proposition 1 and Theorem 2 of Mercadier and Roustant (2019) furnish their rank-based expressions. For the subset of components <code class="reqn">I</code>,
</p>
<p><code class="reqn">\hat{D}_{I,k,n}=\frac{1}{k^2}\sum_{s=1}^n\sum_{s^\prime=1}^n \prod_{t\in I}(\min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})-\overline{R}^{(t)}_{s}\overline{R}^{(t)}_{s^\prime}) \prod_{t\notin I} \overline{R}^{(t)}_s\overline{R}^{(t)}_{s^\prime}</code>
</p>
<p><code class="reqn">\hat{D}_{k,n}=\frac{1}{k^2}\sum_{s=1}^n\sum_{s^\prime=1}^n \prod_{t\in I}\min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})- \prod_{t\in I}\overline{R}^{(t)}_{s}\overline{R}^{(t)}_{s^\prime}</code>
</p>
<p>and <code class="reqn">\hat{S}_{I,k,n}=\dfrac{\hat{D}_{I,k,n}}{\hat{D}_{k,n}}</code>
</p>
<p>where
</p>

<ul>
<li> <p><code class="reqn">k</code> is the threshold parameter,
</p>
</li>
<li> <p><code class="reqn">n</code> is the sample size,
</p>
</li>
<li> <p><code class="reqn">X_1,...,X_n</code> describes the <code>sample</code>, each <code class="reqn">X_s</code> is a d-dimensional vector <code class="reqn">X_s^{(t)}</code> for <code class="reqn">t=1,...,d</code>,
</p>
</li>
<li> <p><code class="reqn">R^{(t)}_s</code> denotes the rank of <code class="reqn">X^{(t)}_s</code> among <code class="reqn">X^{(t)}_1, ..., X^{(t)}_n</code>,
</p>
</li>
<li><p> and  <code class="reqn">\overline{R}^{(t)}_s = \min((n- R^{(t)}_s+1)/k,1)</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a list of two elements:
</p>

<ul>
<li><p><code>subsets</code> A list of subsets from  <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind</code> is given as an integer, <code>subsets</code> is the list of subsets from  <code class="reqn">\{1,...,d\}</code> with cardinality <code>ind</code>. When <code>ind</code> is the list, it corresponds to <code>subsets</code>.
</p>
<p>When <code>ind = "with.singletons"</code>  subsets is the list of all non empty subsets in <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind = "all"</code>   subsets is the list of all subsets in <code class="reqn">\{1,...,d\}</code> with cardinality larger or equal to 2.
</p>
</li>
<li><p><code>tic</code> A vector of tail importance coefficients, or their sobol versions when <code>sobol = "TRUE"</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tic">tic</a></code> and <code><a href="#topic+tsicEmp">tsicEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 5-dimensional asymmetric tail dependence structure
(ds5 &lt;- gen.ds(d = 5))

## Generate a 1000-sample of Mevlog random vectors associated with ds5
sample5 &lt;- rMevlog(n = 1000, ds = ds5)

## Compute empirical tic values according cardinality
res2 &lt;- ticEmp(sample5, ind = 2, k = 100, sobol = TRUE)
res3 &lt;- ticEmp(sample5, ind = 3, k = 100, sobol = TRUE)
res4 &lt;- ticEmp(sample5, ind = 4, k = 100, sobol = TRUE)

## Represent the empirical indices associated with pairs
barplot(res2$tic ~ as.character(res2$subsets), las = 2,
     xlab = "", ylab = "", main = "Tail Sobol Indices (cardinality 2)")

## Represent the empirical indices associated with triplets
barplot(res3$tic ~ as.character(res3$subsets), las = 2,
     xlab = "", ylab = "", main = "Tail Sobol Indices (cardinality 3)")

## Represent the empirical indices associated with quadriplets
barplot(res4$tic ~ as.character(res4$subsets), las = 2,
     xlab = "", ylab ="", main = "Tail Sobol Indices (cardinality 4)")

## Check the sum-to-one constraint of empirical tail Sobol indices
sum(ticEmp(sample5, ind = "with.singletons", k = 100,  sobol = TRUE)$tic)

</code></pre>

<hr>
<h2 id='tsic'>Tail superset importance coefficients for Mevlog models.</h2><span id='topic+tsic'></span>

<h3>Description</h3>

<p>Tail superset importance coefficients  for Mevlog models.  A <code>Mevlog</code> model is a multivariate extreme value (symmetric or asymmetric) logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsic(ds, ind = 2, n.MC = 1000, sobol = FALSE, norm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsic_+3A_ds">ds</code></td>
<td>
<p>An object of class <code>ds</code>.</p>
</td></tr>
<tr><td><code id="tsic_+3A_ind">ind</code></td>
<td>
<p>A character string among &quot;with.singletons&quot; and &quot;all&quot; (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = 2</code>, all pairwise coefficients are computed.</p>
</td></tr>
<tr><td><code id="tsic_+3A_n.mc">n.MC</code></td>
<td>
<p>Monte Carlo sample size. Default value is 1000. See Details.</p>
</td></tr>
<tr><td><code id="tsic_+3A_sobol">sobol</code></td>
<td>
<p>A boolean. 'FALSE' (the default). If 'TRUE':  the index is normalized by the theoretical global variance.</p>
</td></tr>
<tr><td><code id="tsic_+3A_norm">norm</code></td>
<td>
<p>A boolean. 'FALSE' (the default): original tsic is computed. 'TRUE':  tsic is normalized by its upper bound.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tail dependence structure is specified using a <code>ds</code> object, which corresponds to the stable tail dependence function  <code class="reqn">\ell</code>.
The process for deducing  the stable tail dependence function <code class="reqn">\ell</code> from <code>ds</code> is explained in the Details section of <code><a href="#topic+gen.ds">gen.ds</a></code>.
</p>
<p>A tail superset importance coefficient (tsic) is a measure of the importance of a subset of components (and their supersets) in contributing to the global variance decomposition of  <code class="reqn">\ell</code>.
The tsic  is computed using Monte Carlo methods based on the integral formula (3) in Mercadier and Roustant (2019).
Recall that Formula (9) in Liu and Owen (2006) provides an integral representation of the superset importance coefficient.
</p>
<p>The tail dependograph is plotted using pairwise tsic values, which are computed using the function <code>tsic</code> and the <code>ind = 2</code> option.
</p>
<p>The upper bound for a tsic associated with subset  <code class="reqn">I</code> is given by Theorem 2 in Mercadier and Ressel (2021).
If  <code class="reqn">|I|</code> is the cardinality of subset  <code class="reqn">I</code>, then the upper bound is  <code class="reqn">2 (|I| !)^2</code>/<code class="reqn">((2|I|+2)!)</code>.
</p>
<p>The tail dependence structure is set by a <code>ds</code> object. It thus corresponds to the stable tail dependence function <code class="reqn">\ell</code>.
</p>


<h3>Value</h3>

<p>The function returns a list of two elements
</p>

<ul>
<li><p><code>subsets</code> A list of subsets from  <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind</code> is given as an integer, <code>subsets</code> is the list of subsets from  <code class="reqn">\{1,...,d\}</code> with cardinality <code>ind</code>.
</p>
<p>When <code>ind</code> is a list, it corresponds to <code>subsets</code>.
</p>
<p>When <code>ind = "with.singletons"</code>  subsets is the list of all non empty subsets in <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind = "all"</code>   subsets is the list of all subsets in <code class="reqn">\{1,...,d\}</code> with cardinality larger or equal to 2.
</p>
</li>
<li><p><code>tsic</code> A vector of tail superset importance coefficients associated with the list <code>subsets</code>. When <code>norm = TRUE</code>, then tsic  are normalized in the sense that the original values are divided by corresponding upper bounds.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Liu, R. and Owen, A. B. (2006)
Estimating mean dimensionality of analysis of variance decompositions.
<em>J. Amer. Statist. Assoc.</em>, <b>101(474)</b>:712&ndash;721.
</p>
<p>Mercadier, C. and Ressel, P. (2021)
Hoeffding–Sobol decomposition of homogeneous co-survival functions: from Choquet representation to extreme value theory application.
Dependence Modeling, <b>9(1)</b>, 179&ndash;198.
</p>
<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>
<p>Smith, R. L. (1990)
Max-stable processes and spatial extremes.
<em>Dept. of Math., Univ. of Surrey</em>, Guildford GU2 5XH, England.
</p>
<p>Tiago de Oliveira, J. (1962/63)
Structure theory of bivariate extremes, extensions.
<em>Estudos de Matematica, Estatistica, e Economicos</em>, 7:165&ndash;195.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+graphs">graphs</a></code>, <code><a href="#topic+ellMevlog">ellMevlog</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 5-dimensional asymmetric tail dependence structure
ds5 &lt;- gen.ds(d = 5)

## Compute pairwise tsic
tsic(ds = ds5, ind = 2)

## Plot the tail dependograph
graphs(ds = ds5)

## Compute tsic on two specific subsets
tsic(ds = ds5, ind = list(1:4, 3:5))

## Compute normalized version of tsic
tsic(ds5,  ind = list(1:4, 3:5), norm = TRUE)

## Compute Sobol and normalized version of tsic
tsic(ds5,  ind = list(1:4, 3:5), norm = TRUE, sobol = TRUE)

</code></pre>

<hr>
<h2 id='tsicEmp'>Empirical tail superset importance coefficients.</h2><span id='topic+tsicEmp'></span>

<h3>Description</h3>

<p>Computes on a sample the tail superset importance coefficients (tsic) associated with threshold <code>k</code>. The value may be renormalized by the empirical global variance (Sobol version) and/or by its theoretical upper bound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsicEmp(sample, ind = 2, k, sobol = FALSE, norm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsicEmp_+3A_sample">sample</code></td>
<td>
<p>A <code>(n times d)</code> matrix.</p>
</td></tr>
<tr><td><code id="tsicEmp_+3A_ind">ind</code></td>
<td>
<p>A character string among &quot;with.singletons&quot; and &quot;all&quot; (without singletons), or an integer in <code class="reqn">\{2,...,d\}</code> or a list of subsets from  <code class="reqn">\{1,...,d\}</code>. The default is <code>ind = 2</code>, all pairwise coefficients are computed.</p>
</td></tr>
<tr><td><code id="tsicEmp_+3A_k">k</code></td>
<td>
<p>An integer smaller or equal to <code>n</code>.</p>
</td></tr>
<tr><td><code id="tsicEmp_+3A_sobol">sobol</code></td>
<td>
<p>A boolean. 'FALSE' (the default). If 'TRUE':  the index is normalized by the empirical global variance.</p>
</td></tr>
<tr><td><code id="tsicEmp_+3A_norm">norm</code></td>
<td>
<p>A boolean. 'FALSE' (the default). If 'TRUE': the index is normalized by its theoretical upper bound.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The theoretical functional decomposition of the variance of the stdf <code class="reqn">\ell</code> consists in writing <code class="reqn">D(\ell) = \sum_{I \subseteq \{1,...,d\}} D_I(\ell) </code> where <code class="reqn">D_I(\ell)</code> measures the variance of <code class="reqn">\ell_I(U_I)</code> the term associated with subset <code class="reqn">I</code> in the Hoeffding-Sobol decomposition of <code class="reqn">\ell</code>
; note that <code class="reqn">U_I</code> represents a random vector with independent standard uniform entries.
</p>
<p>Fixing a subset of components <code class="reqn">I</code>, the theoretical tail superset importance coefficient is defined by <code class="reqn">\Upsilon_I(\ell)=\sum_{J \supseteq I} D_J(\ell)</code>.
A theoretical upper bound for tsic <code class="reqn">\Upsilon_I(\ell)</code> is given by Theorem 2 in Mercadier and Ressel (2021)
which states that <code class="reqn">\Upsilon_I(\ell)\leq 2(|I|!)^2/((2|I|+2)!)</code>.
</p>
<p>Here, the function <code>tsicEmp</code> evaluates, on a <code class="reqn">n</code>-sample and threshold <code class="reqn">k</code>,  the empirical tail superset  importance coefficient <code class="reqn">\hat{\Upsilon}_{I,k,n}</code> the empirical counterpart of <code class="reqn">\Upsilon_I(\ell)</code>.
</p>
<p>Under the option <code>sobol = TRUE</code>, the function <code>tsicEmp</code> returns  <code class="reqn">\dfrac{\hat{\Upsilon}_{I,k,n}}{\hat{D}_{k,n}}</code> the empirical counterpart of <code class="reqn">\dfrac{\Upsilon_I(\ell)}{D_I(\ell)}</code>.
</p>
<p>Under the option <code>norm = TRUE</code>, the quantities are multiplied by <code class="reqn">\dfrac{(2|I|+2)!}{2(|I|!)^2}</code>.
</p>
<p>Proposition 1 and Theorem 2 of Mercadier and Roustant (2019) provide several rank-based expressions
</p>
<p><code class="reqn">\hat{\Upsilon}_{I,k,n}=\frac{1}{k^2}\sum_{s=1}^n\sum_{s^\prime=1}^n \prod_{t\in I}(\min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})-\overline{R}^{(t)}_{s}\overline{R}^{(t)}_{s^\prime}) \prod_{t\notin I} \min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})</code>
</p>
<p><code class="reqn">\hat{D}_{k,n}=\frac{1}{k^2}\sum_{s=1}^n\sum_{s^\prime=1}^n \prod_{t\in I}\min(\overline{R}^{(t)}_s,\overline{R}^{(t)}_{s^\prime})- \prod_{t\in I}\overline{R}^{(t)}_{s}\overline{R}^{(t)}_{s^\prime}</code>
</p>
<p>where
</p>

<ul>
<li> <p><code class="reqn">k</code> is the threshold parameter,
</p>
</li>
<li> <p><code class="reqn">n</code> is the sample size,
</p>
</li>
<li> <p><code class="reqn">X_1,...,X_n</code> describes the <code>sample</code>, each <code class="reqn">X_s</code> is a d-dimensional vector <code class="reqn">X_s^{(t)}</code> for <code class="reqn">t=1,...,d</code>,
</p>
</li>
<li> <p><code class="reqn">R^{(t)}_s</code> denotes the rank of <code class="reqn">X^{(t)}_s</code> among <code class="reqn">X^{(t)}_1, ..., X^{(t)}_n</code>,
</p>
</li>
<li><p> and  <code class="reqn">\overline{R}^{(t)}_s = \min((n- R^{(t)}_s+1)/k,1)</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a list of two elements:
</p>

<ul>
<li><p><code>subsets</code> A list of subsets from  <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind</code> is given as an integer, <code>subsets</code> is the list of subsets from  <code class="reqn">\{1,...,d\}</code> with cardinality <code>ind</code>. When <code>ind</code> is the list, it corresponds to <code>subsets</code>.
</p>
<p>When <code>ind = "with.singletons"</code>  subsets is the list of all non empty subsets in <code class="reqn">\{1,...,d\}</code>.
</p>
<p>When <code>ind = "all"</code>   subsets is the list of all subsets in <code class="reqn">\{1,...,d\}</code> with cardinality larger or equal to 2.
</p>
</li>
<li><p><code>tsic</code> A vector of empirical tail superset importance coefficients associated with the list <code>subsets</code>. When <code>norm = TRUE</code>, then tsic  are normalized in the sense that the original values are divided by corresponding upper bounds.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Cécile Mercadier (<code>mercadier@math.univ-lyon1.fr</code>)
</p>


<h3>References</h3>

<p>Mercadier, C. and Ressel, P. (2021)
Hoeffding–Sobol decomposition of homogeneous co-survival functions: from Choquet representation to extreme value theory application.
Dependence Modeling, <b>9(1)</b>, 179&ndash;198.
</p>
<p>Mercadier, C. and Roustant, O. (2019)
The tail dependograph.
<em>Extremes</em>, <b>22</b>, 343&ndash;372.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+graphsEmp">graphsEmp</a></code>, <code><a href="#topic+ellEmp">ellEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fix a 6-dimensional asymmetric tail dependence structure
ds &lt;- gen.ds(d = 6, sub = list(1:4,5:6))

## Plot the  tail dependograph
graphs(ds)

## Generate a 1000-sample of Archimax Mevlog random vectors
## associated with ds and underlying distribution exp
sample &lt;- rArchimaxMevlog(n = 1000, ds = ds, dist = "exp", dist.param = 1.3)

## Compute tsic values associated with subsets
## of cardinality 2 or more \code{ind = "all"}
res &lt;- tsicEmp(sample = sample, ind = "all", k = 100, sobol = TRUE, norm = TRUE)

## Select the significative tsic
indices_nonzero &lt;- which(res$tsic %in% boxplot.stats(res$tsic)$out == TRUE)

## Subsets associated with significative tsic reflecting the tail support
as.character(res$subsets[indices_nonzero])

## Pairwise tsic are obtained by
res_pairs &lt;- tsicEmp(sample = sample, ind = 2, k = 100, sobol = TRUE, norm = TRUE)

## and plotted in the tail dependograph
graphsEmp(sample, k = 100)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
