<!DOCTYPE html><html lang="en"><head><title>Help for package pkgbuild</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pkgbuild}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pkgbuild-package'><p>pkgbuild: Find Tools Needed to Build R Packages</p></a></li>
<li><a href='#build'><p>Build package</p></a></li>
<li><a href='#clean_dll'><p>Remove compiled objects from /src/ directory</p></a></li>
<li><a href='#compile_dll'><p>Compile a .dll/.so from source.</p></a></li>
<li><a href='#compiler_flags'><p>Default compiler flags used by devtools.</p></a></li>
<li><a href='#has_build_tools'><p>Are build tools are available?</p></a></li>
<li><a href='#has_compiler'><p>Is a compiler available?</p></a></li>
<li><a href='#has_latex'><p>Is latex installed?</p></a></li>
<li><a href='#needs_compile'><p>Does the package need recompiling?</p>
(i.e. is there a source or header file newer than the dll)</a></li>
<li><a href='#pkg_has_src'><p>Does a source package have <code style="white-space: pre;">&#8288;src/&#8288;</code> directory?</p></a></li>
<li><a href='#pkg_links_to_rcpp'><p>Test if a package path is linking to Rcpp or cpp11</p></a></li>
<li><a href='#pkgbuild_process'><p>Build package in the background</p></a></li>
<li><a href='#rcmd_build_tools'><p>Call R CMD 'command' with build tools active</p></a></li>
<li><a href='#rtools_needed'><p>Retrieve a text string with the rtools version needed</p></a></li>
<li><a href='#rtools_path'><p>Is Rtools installed?</p></a></li>
<li><a href='#with_debug'><p>Temporarily set debugging compilation flags.</p></a></li>
<li><a href='#without_compiler'><p>Tools for testing pkgbuild</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Find Tools Needed to Build R Packages</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions used to build R packages. Locates
    compilers needed to build R packages on various platforms and ensures
    the PATH is configured appropriately so R can use them.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/r-lib/pkgbuild">https://github.com/r-lib/pkgbuild</a>, <a href="https://pkgbuild.r-lib.org">https://pkgbuild.r-lib.org</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-lib/pkgbuild/issues">https://github.com/r-lib/pkgbuild/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>callr (&ge; 3.2.0), cli (&ge; 3.4.0), desc, processx, R6</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, cpp11, knitr, Rcpp, rmarkdown, testthat (&ge; 3.2.0),
withr (&ge; 2.3.0)</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-16 17:45:57 UTC; gaborcsardi</td>
</tr>
<tr>
<td>Author:</td>
<td>Hadley Wickham [aut],
  Jim Hester [aut],
  Gábor Csárdi [aut, cre],
  Posit Software, PBC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gábor Csárdi &lt;csardi.gabor@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-16 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pkgbuild-package'>pkgbuild: Find Tools Needed to Build R Packages</h2><span id='topic+pkgbuild'></span><span id='topic+pkgbuild-package'></span>

<h3>Description</h3>

<p>Provides functions used to build R packages. Locates compilers needed to build R packages on various platforms and ensures the PATH is configured appropriately so R can use them.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Gábor Csárdi <a href="mailto:csardi.gabor@gmail.com">csardi.gabor@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Hadley Wickham
</p>
</li>
<li><p> Jim Hester
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Posit Software, PBC [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/r-lib/pkgbuild">https://github.com/r-lib/pkgbuild</a>
</p>
</li>
<li> <p><a href="https://pkgbuild.r-lib.org">https://pkgbuild.r-lib.org</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/r-lib/pkgbuild/issues">https://github.com/r-lib/pkgbuild/issues</a>
</p>
</li></ul>


<hr>
<h2 id='build'>Build package</h2><span id='topic+build'></span>

<h3>Description</h3>

<p>Building converts a package source directory into a single bundled file.
If <code>binary = FALSE</code> this creates a <code>tar.gz</code> package that can
be installed on any platform, provided they have a full development
environment (although packages without source code can typically be
installed out of the box). If <code>binary = TRUE</code>, the package will have
a platform specific extension (e.g. <code>.zip</code> for windows), and will
only be installable on the current platform, but no development
environment is needed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build(
  path = ".",
  dest_path = NULL,
  binary = FALSE,
  vignettes = TRUE,
  manual = FALSE,
  clean_doc = NULL,
  args = NULL,
  quiet = FALSE,
  needs_compilation = pkg_has_src(path),
  compile_attributes = FALSE,
  register_routines = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_+3A_path">path</code></td>
<td>
<p>Path to a package, or within a package.</p>
</td></tr>
<tr><td><code id="build_+3A_dest_path">dest_path</code></td>
<td>
<p>path in which to produce package. If it is an existing
directory, then the output file is placed in <code>dest_path</code> and named
according to the current R conversions (e.g. <code>.zip</code> for Windows binary
packages, <code>.tgz</code> for macOS binary packages, etc).
If it is an existing file, then it will be overwritten.
If <code>dest_path</code> does not exist, then it is used as a file name.
If <code>NULL</code>, it defaults to the parent directory of the package.</p>
</td></tr>
<tr><td><code id="build_+3A_binary">binary</code></td>
<td>
<p>Produce a binary (<code>--binary</code>) or source (
<code>--no-manual --no-resave-data</code>) version of the package.</p>
</td></tr>
<tr><td><code id="build_+3A_vignettes">vignettes</code>, <code id="build_+3A_manual">manual</code></td>
<td>
<p>For source packages: if <code>FALSE</code>, don't build PDF
vignettes (<code>--no-build-vignettes</code>) or manual (<code>--no-manual</code>).</p>
</td></tr>
<tr><td><code id="build_+3A_clean_doc">clean_doc</code></td>
<td>
<p>If <code>TRUE</code>, clean the files in <code>inst/doc</code> before building
the package. If <code>NULL</code> and the <code>Config/build/clean-inst-doc</code> entry is
present in <code>DESCRIPTION</code>, then that is used. Otherwise, if <code>NULL</code>,
and interactive, ask to remove the files prior to cleaning. In most
cases cleaning the files is the correct behavior to avoid stale
vignette outputs in the built package.</p>
</td></tr>
<tr><td><code id="build_+3A_args">args</code></td>
<td>
<p>An optional character vector of additional command
line arguments to be passed to <code style="white-space: pre;">&#8288;R CMD build&#8288;</code> if <code>binary = FALSE</code>,
or <code style="white-space: pre;">&#8288;R CMD install&#8288;</code> if <code>binary = TRUE</code>.</p>
</td></tr>
<tr><td><code id="build_+3A_quiet">quiet</code></td>
<td>
<p>if <code>TRUE</code> suppresses output from this function.</p>
</td></tr>
<tr><td><code id="build_+3A_needs_compilation">needs_compilation</code></td>
<td>
<p>Usually only needed if the packages has
C/C++/Fortran code. By default this is autodetected.</p>
</td></tr>
<tr><td><code id="build_+3A_compile_attributes">compile_attributes</code></td>
<td>
<p>if <code>TRUE</code> and the package uses Rcpp, call
<code><a href="Rcpp.html#topic+compileAttributes">Rcpp::compileAttributes()</a></code> before building the package. It is ignored
if package does not need compilation.</p>
</td></tr>
<tr><td><code id="build_+3A_register_routines">register_routines</code></td>
<td>
<p>if <code>TRUE</code> and the package does not use Rcpp, call
register routines with
<code>tools::package_native_routine_registration_skeleton()</code> before building
the package. It is ignored if package does not need compilation.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Configuration</h4>



<h5><code>DESCRIPTION</code> entries</h5>


<ul>
<li> <p><code>Config/build/clean-inst-doc</code> can be set to <code>FALSE</code> to avoid cleaning up
<code>inst/doc</code> when building a source package. Set it to <code>TRUE</code> to force a
cleanup. See the <code>clean_doc</code> argument.
</p>
</li>
<li> <p><code>Config/build/copy-method</code> can be used to avoid copying large
directories in <code style="white-space: pre;">&#8288;R CMD build&#8288;</code>. It works by copying (or linking) the
files of the package to a temporary directory, leaving out the
(possibly large) files that are not part of the package. Possible
values:
</p>

<ul>
<li> <p><code>none</code>: pkgbuild does not copy the package tree. This is the default.
</p>
</li>
<li> <p><code>copy</code>: the package files are copied to a temporary directory before
<code style="white-space: pre;">&#8288; R CMD build&#8288;</code>.
</p>
</li>
<li> <p><code>link</code>: the package files are symbolic linked to a temporary
directory before <code style="white-space: pre;">&#8288;R CMD build&#8288;</code>. Windows does not have symbolic
links, so on Windows this is equivalent to <code>copy</code>.
</p>
</li></ul>

<p>You can also use the <code>pkg.build_copy_method</code> option or the
<code>PKG_BUILD_COPY_METHOD</code> environment variable to set the copy method.
The option is consulted first, then the <code>DESCRIPTION</code> entry, then the
environment variable.
</p>
</li>
<li> <p><code>Config/build/extra-sources</code> can be used to define extra source files
for pkgbuild to decide whether a package DLL needs to be recompiled in
<code>needs_compile()</code>. The syntax is a comma separated list of file names,
or globs. (See <code><a href="utils.html#topic+glob2rx">utils::glob2rx()</a></code>.) E.g. <code style="white-space: pre;">&#8288;src/rust/src/*.rs&#8288;</code> or
<code style="white-space: pre;">&#8288;configure*&#8288;</code>.
</p>
</li>
<li> <p><code>Config/build/bootstrap</code> can be set to <code>TRUE</code> to run
<code style="white-space: pre;">&#8288;Rscript bootstrap.R&#8288;</code> in the source directory prior to running subsequent
build steps.
</p>
</li></ul>




<h5>Options</h5>


<ul>
<li> <p><code>pkg.build_copy_method</code>: use this option to avoid copying large
directories when building a package. See possible values above, at the
<code>Config/build/copy-method</code> <code>DESCRIPTION</code> entry.
</p>
</li>
<li> <p><code>pkg.build_stop_for_warnings</code>: if it is set to <code>TRUE</code>, then pkgbuild
will stop for <code style="white-space: pre;">&#8288;R CMD build&#8288;</code> errors. It takes precedence over the
<code>PKG_BUILD_STOP_FOR_WARNINGS</code> environment variable.
</p>
</li></ul>




<h5>Environment variables</h5>


<ul>
<li> <p><code>PKG_BUILD_COLOR_DIAGNOSTICS</code>: set it to <code>false</code> to opt out of colored
compiler diagnostics. Set it to <code>true</code> to force colored compiler
diagnostics.
</p>
</li>
<li> <p><code>PKG_BUILD_COPY_METHOD</code>: use this environment variable to avoid copying
large directories when building a package. See possible values above,
at the <code>Config/build/copy-method</code> <code>DESCRIPTION</code> entry.
</p>
</li></ul>

<p>will stop for <code style="white-space: pre;">&#8288;R CMD build&#8288;</code> errors. The <code>pkg.build_stop_for_warnings</code>
option takes precedence over this environment variable.
</p>




<h3>Value</h3>

<p>a string giving the location (including file name) of the built
package
</p>

<hr>
<h2 id='clean_dll'>Remove compiled objects from /src/ directory</h2><span id='topic+clean_dll'></span>

<h3>Description</h3>

<p>Invisibly returns the names of the deleted files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_dll(path = ".")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clean_dll_+3A_path">path</code></td>
<td>
<p>Path to a package, or within a package.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+compile_dll">compile_dll()</a></code>
</p>

<hr>
<h2 id='compile_dll'>Compile a .dll/.so from source.</h2><span id='topic+compile_dll'></span>

<h3>Description</h3>

<p><code>compile_dll</code> performs a fake R CMD install so code that
works here should work with a regular install (and vice versa).
During compilation, debug flags are set with
<code><a href="#topic+compiler_flags">compiler_flags</a>(TRUE)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compile_dll(
  path = ".",
  force = FALSE,
  compile_attributes = pkg_links_to_cpp11(path) || pkg_links_to_rcpp(path),
  register_routines = FALSE,
  quiet = FALSE,
  debug = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compile_dll_+3A_path">path</code></td>
<td>
<p>Path to a package, or within a package.</p>
</td></tr>
<tr><td><code id="compile_dll_+3A_force">force</code></td>
<td>
<p>If <code>TRUE</code>, for compilation even if <code><a href="#topic+needs_compile">needs_compile()</a></code> is
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="compile_dll_+3A_compile_attributes">compile_attributes</code></td>
<td>
<p>if <code>TRUE</code> and the package uses Rcpp, call
<code><a href="Rcpp.html#topic+compileAttributes">Rcpp::compileAttributes()</a></code> before building the package. It is ignored
if package does not need compilation.</p>
</td></tr>
<tr><td><code id="compile_dll_+3A_register_routines">register_routines</code></td>
<td>
<p>if <code>TRUE</code> and the package does not use Rcpp, call
register routines with
<code>tools::package_native_routine_registration_skeleton()</code> before building
the package. It is ignored if package does not need compilation.</p>
</td></tr>
<tr><td><code id="compile_dll_+3A_quiet">quiet</code></td>
<td>
<p>if <code>TRUE</code> suppresses output from this function.</p>
</td></tr>
<tr><td><code id="compile_dll_+3A_debug">debug</code></td>
<td>
<p>If <code>TRUE</code>, and if no user Makevars is found, then the build
runs without optimisation (<code>-O0</code>) and with debug symbols (<code>-g</code>). See
<code><a href="#topic+compiler_flags">compiler_flags()</a></code> for details. If you have a user Makevars (e.g.,
<code style="white-space: pre;">&#8288;~/.R/Makevars&#8288;</code>) then this argument is ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Invisibly returns the names of the DLL.
</p>


<h4>Configuration</h4>



<h5>Options</h5>


<ul>
<li> <p><code>pkg.build_extra_flags</code>: set this to <code>FALSE</code> to to opt out from adding
debug compiler flags in <code>compile_dll()</code>. Takes precedence over the
<code>PKG_BUILD_EXTRA_FLAGS</code> environment variable. Possible values:
</p>

<ul>
<li> <p><code>TRUE</code>: add extra flags,
</p>
</li>
<li> <p><code>FALSE</code>: do not add extra flags,
</p>
</li>
<li> <p><code>"missing"</code>: add extra flags if the user does not have a
<code style="white-space: pre;">&#8288;$HOME/.R/Makevars&#8288;</code> file.
</p>
</li></ul>

</li></ul>




<h5>Environment variables</h5>


<ul>
<li> <p><code>PKG_BUILD_EXTRA_FLAGS</code>: set this to <code>false</code> to to opt out from adding
debug compiler flags in <code>compile_dll()</code>. The <code>pkg.build_extra_flags</code> option
takes precedence over this environment variable. Possible values:
</p>

<ul>
<li> <p><code>"true"</code>: add extra flags,
</p>
</li>
<li> <p><code>"false"</code>: do not add extra flags,
</p>
</li>
<li> <p><code>"missing"</code>: add extra flags if the user does not have a
<code style="white-space: pre;">&#8288;$HOME/.R/Makevars&#8288;</code> file.
</p>
</li></ul>

</li></ul>





<h3>Note</h3>

<p>If this is used to compile code that uses Rcpp, you will need to
add the following line to your <code>Makevars</code> file so that it
knows where to find the Rcpp headers:
</p>
<div class="sourceCode"><pre>PKG_CPPFLAGS=`$(R_HOME)/bin/Rscript -e 'Rcpp:::CxxFlags()'`
</pre></div>


<h3>See Also</h3>

<p><code><a href="#topic+clean_dll">clean_dll()</a></code> to delete the compiled files.
</p>

<hr>
<h2 id='compiler_flags'>Default compiler flags used by devtools.</h2><span id='topic+compiler_flags'></span>

<h3>Description</h3>

<p>These default flags enforce good coding practice by ensuring that
<span class="env">CFLAGS</span> and <span class="env">CXXFLAGS</span> are set to <code>-Wall -pedantic</code>.
These tests are run by cran and are generally considered to be good practice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compiler_flags(debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compiler_flags_+3A_debug">debug</code></td>
<td>
<p>If <code>TRUE</code> adds <code>-g -O0</code> to all flags
(Adding <span class="env">FFLAGS</span> and <span class="env">FCFLAGS</span>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default <code><a href="#topic+compile_dll">compile_dll()</a></code> is run with <code>compiler_flags(TRUE)</code>,
and check with <code>compiler_flags(FALSE)</code>.  If you want to avoid the
possible performance penalty from the debug flags, install the package.
</p>


<h3>See Also</h3>

<p>Other debugging flags: 
<code><a href="#topic+with_debug">with_debug</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>compiler_flags()
compiler_flags(TRUE)
</code></pre>

<hr>
<h2 id='has_build_tools'>Are build tools are available?</h2><span id='topic+has_build_tools'></span><span id='topic+check_build_tools'></span><span id='topic+with_build_tools'></span><span id='topic+local_build_tools'></span>

<h3>Description</h3>

<p><code>has_build_tools</code> returns a logical, <code>check_build_tools</code> throws
an error. <code>with_build_tools</code> checks that build tools are available,
then runs <code>code</code> in an correctly staged environment.
If run interactively from RStudio, and the build tools are not
available these functions will trigger an automated install.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has_build_tools(debug = FALSE)

check_build_tools(debug = FALSE, quiet = FALSE)

with_build_tools(code, debug = FALSE, required = TRUE)

local_build_tools(
  debug = FALSE,
  required = TRUE,
  .local_envir = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="has_build_tools_+3A_debug">debug</code></td>
<td>
<p>If <code>TRUE</code>, will print out extra information useful for
debugging. If <code>FALSE</code>, it will use result cached from a previous run.</p>
</td></tr>
<tr><td><code id="has_build_tools_+3A_quiet">quiet</code></td>
<td>
<p>if <code>TRUE</code> suppresses output from this function.</p>
</td></tr>
<tr><td><code id="has_build_tools_+3A_code">code</code></td>
<td>
<p>Code to rerun in environment where build tools are guaranteed to
exist.</p>
</td></tr>
<tr><td><code id="has_build_tools_+3A_required">required</code></td>
<td>
<p>If <code>TRUE</code>, and build tools are not available,
will throw an error. Otherwise will attempt to run <code>code</code> without
them.</p>
</td></tr>
<tr><td><code id="has_build_tools_+3A_.local_envir">.local_envir</code></td>
<td>
<p>The environment to use for scoping.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Errors like <code style="white-space: pre;">&#8288;running command '"C:/PROGRA~1/R/R-34~1.2/bin/x64/R" CMD config CC' had status 127&#8288;</code>
indicate the code expected Rtools to be on the system PATH. You can
then verify you have rtools installed with <code>has_build_tools()</code> and
temporarily add Rtools to the PATH <code>with_build_tools({ code })</code>.
</p>
<p>It is possible to add Rtools to your system PATH manually; you can use
<code><a href="#topic+rtools_path">rtools_path()</a></code> to show the installed location. However because this
requires manual updating when a new version of Rtools is installed and the
binaries in Rtools may conflict with existing binaries elsewhere on the PATH it
is better practice to use <code>with_build_tools()</code> as needed.
</p>


<h3>See Also</h3>

<p>has_rtools
</p>


<h3>Examples</h3>

<pre><code class='language-R'>has_build_tools(debug = TRUE)
check_build_tools()
</code></pre>

<hr>
<h2 id='has_compiler'>Is a compiler available?</h2><span id='topic+has_compiler'></span><span id='topic+check_compiler'></span><span id='topic+has_devel'></span>

<h3>Description</h3>

<p>These functions check if a small C file can be compiled, linked, loaded
and executed.
</p>
<p><code>has_compiler()</code> and <code>has_devel()</code> return <code>TRUE</code> or <code>FALSE</code>.
<code>check_compiler()</code> and <code>check_devel()</code>
throw an error if you don't have developer tools installed.
If the <code>"pkgbuild.has_compiler"</code> option is set to <code>TRUE</code> or <code>FALSE</code>,
no check is carried out, and the value of the option is used.
</p>
<p>The implementation is  based on a suggestion by Simon Urbanek.
End-users (particularly those on Windows) should generally run
<code><a href="#topic+check_build_tools">check_build_tools()</a></code> rather than <code><a href="#topic+check_compiler">check_compiler()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has_compiler(debug = FALSE)

check_compiler(debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="has_compiler_+3A_debug">debug</code></td>
<td>
<p>If <code>TRUE</code>, will print out extra information useful for
debugging. If <code>FALSE</code>, it will use result cached from a previous run.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+check_build_tools">check_build_tools()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>has_compiler()
check_compiler()

with_build_tools(has_compiler())
</code></pre>

<hr>
<h2 id='has_latex'>Is latex installed?</h2><span id='topic+has_latex'></span><span id='topic+check_latex'></span>

<h3>Description</h3>

<p>Checks for presence of pdflatex on path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has_latex()

check_latex()
</code></pre>

<hr>
<h2 id='needs_compile'>Does the package need recompiling?
(i.e. is there a source or header file newer than the dll)</h2><span id='topic+needs_compile'></span>

<h3>Description</h3>

<p>Does the package need recompiling?
(i.e. is there a source or header file newer than the dll)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>needs_compile(path = ".")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="needs_compile_+3A_path">path</code></td>
<td>
<p>Path to a package, or within a package.</p>
</td></tr>
</table>

<hr>
<h2 id='pkg_has_src'>Does a source package have <code style="white-space: pre;">&#8288;src/&#8288;</code> directory?</h2><span id='topic+pkg_has_src'></span>

<h3>Description</h3>

<p>If it does, you definitely need build tools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkg_has_src(path = ".")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pkg_has_src_+3A_path">path</code></td>
<td>
<p>Path to package (or directory within package).</p>
</td></tr>
</table>

<hr>
<h2 id='pkg_links_to_rcpp'>Test if a package path is linking to Rcpp or cpp11</h2><span id='topic+pkg_links_to_rcpp'></span><span id='topic+pkg_links_to_cpp11'></span>

<h3>Description</h3>

<p>Test if a package path is linking to Rcpp or cpp11
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkg_links_to_rcpp(path)

pkg_links_to_cpp11(path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pkg_links_to_rcpp_+3A_path">path</code></td>
<td>
<p>Path to a package, or within a package.</p>
</td></tr>
</table>

<hr>
<h2 id='pkgbuild_process'>Build package in the background</h2><span id='topic+pkgbuild_process'></span>

<h3>Description</h3>

<p>This R6 class is a counterpart of the <code><a href="#topic+build">build()</a></code> function, and
represents a background process that builds an R package.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>bp &lt;- pkgbuild_process$new(path = ".", dest_path = NULL,
         binary = FALSE, vignettes = TRUE, manual = FALSE, args = NULL)
bp$get_dest_path()
</pre></div>
<p>Other methods are inherited from <a href="callr.html#topic+rcmd_process">callr::rcmd_process</a> and
<code>processx::process</code>.
</p>


<h3>Arguments</h3>

<p>See the corresponding arguments of <code><a href="#topic+build">build()</a></code>.
</p>


<h3>Details</h3>

<p>Most methods are inherited from <a href="callr.html#topic+rcmd_process">callr::rcmd_process</a> and
<code>processx::process</code>.
</p>
<p><code>bp$get_dest_path()</code> returns the path to the built package.
</p>


<h3>Examples</h3>

<div class="sourceCode"><pre>## Here we are just waiting, but in a more realistic example, you
## would probably run some other code instead...
bp &lt;- pkgbuild_process$new("mypackage", dest_path = tempdir())
bp$is_alive()
bp$get_pid()
bp$wait()
bp$read_all_output_lines()
bp$read_all_error_lines()
bp$get_exit_status()
bp$get_dest_path()
</pre></div>

<hr>
<h2 id='rcmd_build_tools'>Call R CMD 'command' with build tools active</h2><span id='topic+rcmd_build_tools'></span>

<h3>Description</h3>

<p>This is a wrapper around <code>callr::rcmd_safe()</code> that checks
that you have build tools available, and on Windows, automatically sets
the path to include Rtools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcmd_build_tools(..., env = character(), required = TRUE, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rcmd_build_tools_+3A_...">...</code></td>
<td>
<p>Parameters passed on to <code>rcmd_safe</code>.</p>
</td></tr>
<tr><td><code id="rcmd_build_tools_+3A_env">env</code></td>
<td>
<p>Additional environment variables to set. The defaults from
<code>callr::rcmd_safe_env()</code> are always set.</p>
</td></tr>
<tr><td><code id="rcmd_build_tools_+3A_required">required</code></td>
<td>
<p>If <code>TRUE</code>, and build tools are not available,
will throw an error. Otherwise will attempt to run <code>code</code> without
them.</p>
</td></tr>
<tr><td><code id="rcmd_build_tools_+3A_quiet">quiet</code></td>
<td>
<p>if <code>TRUE</code> suppresses output from this function.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># These env vars are always set
callr::rcmd_safe_env()

if (has_build_tools()) {
  rcmd_build_tools("CONFIG", "CC")$stdout
  rcmd_build_tools("CC", "--version")$stdout
}
</code></pre>

<hr>
<h2 id='rtools_needed'>Retrieve a text string with the rtools version needed</h2><span id='topic+rtools_needed'></span>

<h3>Description</h3>

<p>Retrieve a text string with the rtools version needed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtools_needed(r_version = getRversion())
</code></pre>

<hr>
<h2 id='rtools_path'>Is Rtools installed?</h2><span id='topic+rtools_path'></span><span id='topic+has_rtools'></span><span id='topic+find_rtools'></span><span id='topic+setup_rtools'></span><span id='topic+check_rtools'></span>

<h3>Description</h3>

<p>To build binary packages on windows, Rtools (found at
<a href="https://CRAN.R-project.org/bin/windows/Rtools/">https://CRAN.R-project.org/bin/windows/Rtools/</a>) needs to be on
the path. The default installation process does not add it, so this
script finds it (looking first on the path, then in the registry).
It also checks that the version of rtools matches the version of R.
<code>has_rtools()</code> determines if Rtools is installed, caching the results.
Afterward, run <code>rtools_path()</code> to find out where it's installed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtools_path()

has_rtools(debug = FALSE)

check_rtools(debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rtools_path_+3A_debug">debug</code></td>
<td>
<p>If <code>TRUE</code>, will print out extra information useful for
debugging. If <code>FALSE</code>, it will use result cached from a previous run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either a visible <code>TRUE</code> if rtools is found, or an invisible
<code>FALSE</code> with a diagnostic <code><a href="base.html#topic+message">message()</a></code>.
As a side-effect the internal package variable <code>rtools_path</code> is
updated to the paths to rtools binaries.
</p>


<h3>Acknowledgements</h3>

<p>This code borrows heavily from RStudio's code for finding Rtools.
Thanks JJ!
</p>


<h3>Examples</h3>

<pre><code class='language-R'>has_rtools()
</code></pre>

<hr>
<h2 id='with_debug'>Temporarily set debugging compilation flags.</h2><span id='topic+with_debug'></span>

<h3>Description</h3>

<p>Temporarily set debugging compilation flags.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_debug(
  code,
  CFLAGS = NULL,
  CXXFLAGS = NULL,
  FFLAGS = NULL,
  FCFLAGS = NULL,
  debug = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="with_debug_+3A_code">code</code></td>
<td>
<p>to execute.</p>
</td></tr>
<tr><td><code id="with_debug_+3A_cflags">CFLAGS</code></td>
<td>
<p>flags for compiling C code</p>
</td></tr>
<tr><td><code id="with_debug_+3A_cxxflags">CXXFLAGS</code></td>
<td>
<p>flags for compiling C++ code</p>
</td></tr>
<tr><td><code id="with_debug_+3A_fflags">FFLAGS</code></td>
<td>
<p>flags for compiling Fortran code.</p>
</td></tr>
<tr><td><code id="with_debug_+3A_fcflags">FCFLAGS</code></td>
<td>
<p>flags for Fortran 9x code.</p>
</td></tr>
<tr><td><code id="with_debug_+3A_debug">debug</code></td>
<td>
<p>If <code>TRUE</code> adds <code>-g -O0</code> to all flags
(Adding <span class="env">FFLAGS</span> and <span class="env">FCFLAGS</span>)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other debugging flags: 
<code><a href="#topic+compiler_flags">compiler_flags</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>flags &lt;- names(compiler_flags(TRUE))
with_debug(Sys.getenv(flags))
## Not run: 
install("mypkg")
with_debug(install("mypkg"))

## End(Not run)
</code></pre>

<hr>
<h2 id='without_compiler'>Tools for testing pkgbuild</h2><span id='topic+without_compiler'></span><span id='topic+without_cache'></span><span id='topic+without_latex'></span><span id='topic+with_latex'></span>

<h3>Description</h3>

<p><code>with_compiler</code> temporarily disables code compilation by setting
<code>CC</code>, <code>CXX</code>, makevars to <code>test</code>. <code>without_cache</code>
resets the cache before and after running <code>code</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>without_compiler(code)

without_cache(code)

without_latex(code)

with_latex(code)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="without_compiler_+3A_code">code</code></td>
<td>
<p>Code to execute with broken compilers</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
