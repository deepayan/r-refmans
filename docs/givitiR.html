<!DOCTYPE html><html><head><title>Help for package givitiR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {givitiR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calibrationBeltIntersections'><p>Calibration Belt Significant Deviations</p></a></li>
<li><a href='#calibrationBeltPoints'><p>Calibration Belt Confidence Region</p></a></li>
<li><a href='#givitiCalibrationBelt'><p>Calibration Belt</p></a></li>
<li><a href='#givitiCalibrationBeltTable'><p>Table of the Calibration Belt Significant Deviations</p></a></li>
<li><a href='#givitiCalibrationTest'><p>Calibration Test</p></a></li>
<li><a href='#givitiCalibrationTestComp'><p>Computation of the Calibration Test</p></a></li>
<li><a href='#givitiCheckArgs'><p>Check of the argument's values</p></a></li>
<li><a href='#givitiCheckData'><p>Check of data</p></a></li>
<li><a href='#givitiR'><p>givitiR: assessing the calibration of binary outcome models with the GiViTI calibration belt.</p></a></li>
<li><a href='#givitiStatCdf'><p>CDF of the Calibration Statistic Under the Null Hypothesis</p></a></li>
<li><a href='#icuData'><p>Information of SAPS II score and outcome of 1,000 ICU patients.</p></a></li>
<li><a href='#logit'><p>Logit and logistic functions</p></a></li>
<li><a href='#plot.givitiCalibrationBelt'><p>Calibration Belt Plot</p></a></li>
<li><a href='#polynomialLogRegrFw'><p>Forward Selection in Polynomial Logistic Regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The GiViTI Calibration Test and Belt</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-01-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to assess the calibration of logistic regression models with the GiViTI (Gruppo Italiano per la Valutazione degli interventi in Terapia Intensiva, Italian Group for the Evaluation of the Interventions in Intensive Care Units - see <a href="http://www.giviti.marionegri.it/">http://www.giviti.marionegri.it/</a>) approach. The approach consists in a graphical tool, namely the GiViTI calibration belt, and in the associated statistical test. These tools can be used both to evaluate the internal calibration (i.e. the goodness of fit) and to assess the validity of an externally developed model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>alabama, rootSolve, grDevices, graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-01-24 02:38:19 UTC; Giovanni</td>
</tr>
<tr>
<td>Author:</td>
<td>Giovanni Nattino [cre, aut],
  Stefano Finazzi [aut],
  Guido Bertolini [aut],
  Carlotta Rossi [aut],
  Greta Carrara [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giovanni Nattino &lt;giovanni.nattino@marionegri.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-01-24 08:12:25</td>
</tr>
</table>
<hr>
<h2 id='calibrationBeltIntersections'>Calibration Belt Significant Deviations</h2><span id='topic+calibrationBeltIntersections'></span>

<h3>Description</h3>

<p><code>calibrationBeltIntersections</code> returns the
intervals where the calibration belt significantly deviates
from the bisector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrationBeltIntersections(cbBound, seqP, minMax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrationBeltIntersections_+3A_cbbound">cbBound</code></td>
<td>
<p>A <code>data.frame</code> object with the numeric variables &quot;U&quot;
and &quot;L&quot;, representing the upper and lower boundary of the calibration belt.</p>
</td></tr>
<tr><td><code id="calibrationBeltIntersections_+3A_seqp">seqP</code></td>
<td>
<p>The vector of the the probabilities where the points
of the calibration belt have been evaluated.</p>
</td></tr>
<tr><td><code id="calibrationBeltIntersections_+3A_minmax">minMax</code></td>
<td>
<p>A list with two elements, named <code>min</code> and <code>max</code>,
representing the minimum and maximum probabilities in the model under evaluation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components, <code>overBisector</code> and <code>underBisector</code>.
Each component is a list containing all the intervals where the calibration
belt is significantly over/under the bisector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+givitiCalibrationBelt">givitiCalibrationBelt</a></code> and <code><a href="#topic+plot.givitiCalibrationBelt">plot.givitiCalibrationBelt</a></code>
to compute and plot the calibaration belt, and
<code><a href="#topic+givitiCalibrationTest">givitiCalibrationTest</a></code> to perform the
associated calibration test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e &lt;- runif(1000)
logite &lt;- logit(e)
eMod &lt;- logistic(logit(e) +  (logit(e))^2)
o &lt;- rbinom(1000, size = 1, prob = eMod)
data &lt;- data.frame(e = e, o = o, logite = logite)

seqP &lt;- seq(from = .01, to =.99, by = .01)
seqG &lt;- logit(seqP)

minMax &lt;- list(min = min(e), max = max(e))

fwLR &lt;- polynomialLogRegrFw(data, .95, 4, 1)
cbBound &lt;- calibrationBeltPoints(data, seqG, fwLR$m, fwLR$fit, .95, .90, "external")
calibrationBeltIntersections(cbBound, seqP, minMax)
</code></pre>

<hr>
<h2 id='calibrationBeltPoints'>Calibration Belt Confidence Region</h2><span id='topic+calibrationBeltPoints'></span>

<h3>Description</h3>

<p><code>calibrationBeltPoints</code> computes the points defining the boundary
of the confidence region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrationBeltPoints(data, seqG, m, fit, thres, cLevel, devel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrationBeltPoints_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object with the numeric variables &quot;o&quot;, &quot;e&quot;
and &quot;logite&quot;, representing the binary outcomes, the probabilities of the
model under evaluation and the logit of the probabilities, respectively.
The variable &quot;e&quot; must contain values between 0 and 1. The variable
&quot;o&quot; must assume only the values 0 and 1.</p>
</td></tr>
<tr><td><code id="calibrationBeltPoints_+3A_seqg">seqG</code></td>
<td>
<p>A vector containing the logit of the probabilities where the points
of the calibration belt will be evaluated.</p>
</td></tr>
<tr><td><code id="calibrationBeltPoints_+3A_m">m</code></td>
<td>
<p>A scalar integer representing the degree of the polynomial
at the end of the forward selection.</p>
</td></tr>
<tr><td><code id="calibrationBeltPoints_+3A_fit">fit</code></td>
<td>
<p>An object of class <code>glm</code> containig the output of the fit
of the logistic regression model at the end of the iterative
forward selection.</p>
</td></tr>
<tr><td><code id="calibrationBeltPoints_+3A_thres">thres</code></td>
<td>
<p>A numeric scalar between 0 and 1 representing 1 - the significance level
adopted in the forward selection.</p>
</td></tr>
<tr><td><code id="calibrationBeltPoints_+3A_clevel">cLevel</code></td>
<td>
<p>A numeric scalar between 0 and 1 representing the confidence level
that will be used for the confidence region.</p>
</td></tr>
<tr><td><code id="calibrationBeltPoints_+3A_devel">devel</code></td>
<td>
<p>A character string specifying if the model has been fit on
the same dataset under evaluation (<code>internal</code>) or if the model has
been developed on an external sample (<code>external</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> object with two columns, &quot;U&quot; and &quot;L&quot;, containing
the points of the upper and lower boundary of the <code>cLevel</code>*100%-level calibration belt evaluated
at values <code>seqG</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+givitiCalibrationBelt">givitiCalibrationBelt</a></code> and <code><a href="#topic+plot.givitiCalibrationBelt">plot.givitiCalibrationBelt</a></code>
to compute and plot the calibaration belt, and
<code><a href="#topic+givitiCalibrationTest">givitiCalibrationTest</a></code> to perform the
associated calibration test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e &lt;- runif(100)
logite &lt;- logit(e)
o &lt;- rbinom(100, size = 1, prob = e)
data &lt;- data.frame(e = e, o = o, logite = logite)

seqG &lt;- logit(seq(from = .01, to =.99, by = .01))

fwLR &lt;- polynomialLogRegrFw(data, .95, 4, 1)

calibrationBeltPoints(data, seqG, fwLR$m, fwLR$fit, .95, .90, "external")
</code></pre>

<hr>
<h2 id='givitiCalibrationBelt'>Calibration Belt</h2><span id='topic+givitiCalibrationBelt'></span>

<h3>Description</h3>

<p><code>givitiCalibrationBelt</code> implements the computations necessary
to plot the calibration belt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>givitiCalibrationBelt(o, e, devel, subset = NULL, confLevels = c(0.8, 0.95),
  thres = 0.95, maxDeg = 4, nPoints = 200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="givitiCalibrationBelt_+3A_o">o</code></td>
<td>
<p>A numeric vector representing the binary outcomes.
The elements must assume only the values 0 or 1. The predictions
in <code>e</code> must represent the probability of the event
coded as 1.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBelt_+3A_e">e</code></td>
<td>
<p>A numeric vector containing the predictions of the
model under evaluation. The elements must be numeric and between 0 and 1.
The lenght of the vector must be equal to the length of the vector <code>o</code>.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBelt_+3A_devel">devel</code></td>
<td>
<p>A character string specifying if the model has been fit on
the same dataset under evaluation (<code>internal</code>) or if the model has
been developed on an external sample (<code>external</code>). See also the 'Details' section.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBelt_+3A_subset">subset</code></td>
<td>
<p>An optional boolean vector specifying the subset of observations
to be considered.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBelt_+3A_conflevels">confLevels</code></td>
<td>
<p>A numeric vector containing the confidence levels
of the calibration belt. The default values are set to .80 and .95.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBelt_+3A_thres">thres</code></td>
<td>
<p>A numeric scalar between 0 and 1 representing 1 - the significance level
adopted in the forward selection. By default is set to 0.95.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBelt_+3A_maxdeg">maxDeg</code></td>
<td>
<p>The maximum degree considered in the forward selection.
By default is set to 4.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBelt_+3A_npoints">nPoints</code></td>
<td>
<p>A numeric scalar indicating the number of points to be considered
to plot the calibration belt. The default value is 200.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calibration belt and the associated test can be used both to evaluate
the calibration of the model in external samples or in the development dataset. However,
the two cases have different requirements. When a model is evaluated on independent
samples, the calibration belt and the related test can be applied whatever is the
method used to fit the model. Conversely, they can be used on the development set
only if the model is fitted with logistic regression.
</p>


<h3>Value</h3>

<p>An object of class <code>givitiCalibrationBelt</code>.
After computing the calibration belt with the present function,
the <code>plot</code> method can be used to plot
the calibration belt. The object returned is a list that contains the
following components:
</p>

<dl>
<dt>n</dt><dd><p>The size of the sample evaluated in the analysis, after discarding
missing values from the vectors <code>o</code> and <code>e</code>.</p>
</dd>
<dt>resultCheck</dt><dd><p>Result of the check on the data. If the data are compatible with the
construction of the calibration belt, the value is the boolean
<code>TRUE</code>. Otherwise, the element contain a character string
describing the problem found.</p>
</dd>
<dt>m</dt><dd><p>The degree of the polynomial at the end of the forward selection.</p>
</dd>
<dt>statistic</dt><dd><p>The value of the test's statistic.</p>
</dd>
<dt>p.value</dt><dd><p>The p-value of the test.</p>
</dd>
<dt>seqP</dt><dd><p>The vector of the probabilities where the points
of the calibration belt has been evaluated.</p>
</dd>
<dt>minMax</dt><dd><p>A list with two elements named <code>min</code> and <code>max</code>
representing the minimum and maximum probabilities in the model under evaluation</p>
</dd>
<dt>confLevels</dt><dd><p>The vector containing the confidence levels of the
calibration belt.</p>
</dd>
<dt>intersByConfLevel</dt><dd><p>A list whose elements report the intervals where the
calibration belt is significantly over/under the bisector
for each confidence level in <code>confLevels</code>.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+plot.givitiCalibrationBelt">plot.givitiCalibrationBelt</a></code>
to plot the calibaration belt and
<code><a href="#topic+givitiCalibrationTest">givitiCalibrationTest</a></code> to perform the
associated calibration test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Random by-construction well calibrated model
e &lt;- runif(100)
o &lt;- rbinom(100, size = 1, prob = e)
cb &lt;- givitiCalibrationBelt(o, e, "external")
plot(cb)

#Random by-construction poorly calibrated model
e &lt;- runif(100)
o &lt;- rbinom(100, size = 1, prob = logistic(logit(e)+2))
cb &lt;- givitiCalibrationBelt(o, e, "external")
plot(cb)
</code></pre>

<hr>
<h2 id='givitiCalibrationBeltTable'>Table of the Calibration Belt Significant Deviations</h2><span id='topic+givitiCalibrationBeltTable'></span>

<h3>Description</h3>

<p><code>givitiCalibrationBeltTable</code> prints on the graphical area of the calibration
belt plot the table that summarizes the significant deviations from the
line of perfect calibration (i.e. the bisector of the I quadrant).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>givitiCalibrationBeltTable(cb, tableStrings, grayLevels, xlim, ylim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="givitiCalibrationBeltTable_+3A_cb">cb</code></td>
<td>
<p>A <code>givitiCalibrationBelt</code> object, to be generated with
the function <code>givitiCalibrationBelt</code>.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBeltTable_+3A_tablestrings">tableStrings</code></td>
<td>
<p>Optional. A list with four character elements named
<code>overBisString</code>,<code>underBisString</code>,<code>confLevelString</code>,
<code>neverString</code>. The four strings of the list are printed instead of the
texts &quot;Over the bisector&quot;/&quot;Under the bisector&quot;/&quot;Confidence level&quot;/&quot;NEVER&quot;
in the table reporting the intersections of the calibration belt with
the bisector.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBeltTable_+3A_graylevels">grayLevels</code></td>
<td>
<p>A vector containing the code of the
gray levels used in the plot of the calibration belt.</p>
</td></tr>
<tr><td><code id="givitiCalibrationBeltTable_+3A_xlim">xlim</code>, <code id="givitiCalibrationBeltTable_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vectors of length 2, giving the
x and y coordinates ranges. Default values are <code>c(0,1)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function prints the table on the graphical area.
</p>

<hr>
<h2 id='givitiCalibrationTest'>Calibration Test</h2><span id='topic+givitiCalibrationTest'></span>

<h3>Description</h3>

<p><code>givitiCalibrationTest</code> performs the calibration test associated to the
calibration belt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>givitiCalibrationTest(o, e, devel, subset = NULL, thres = 0.95,
  maxDeg = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="givitiCalibrationTest_+3A_o">o</code></td>
<td>
<p>A numeric vector representing the binary outcomes.
The elements must assume only the values 0 or 1. The predictions
in <code>e</code> must represent the probability of the event
coded as 1.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTest_+3A_e">e</code></td>
<td>
<p>A numeric vector containing the probabilities of the
model under evaluation. The elements must be numeric and between 0 and 1.
The lenght of the vector must be equal to the length of the vector <code>o</code>.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTest_+3A_devel">devel</code></td>
<td>
<p>A character string specifying if the model has been fit on
the same dataset under evaluation (<code>internal</code>) or if the model has
been developed on an external sample (<code>external</code>). See also the 'Details' section.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTest_+3A_subset">subset</code></td>
<td>
<p>An optional boolean vector specifying the subset of observations
to be considered.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTest_+3A_thres">thres</code></td>
<td>
<p>A numeric scalar between 0 and 1 representing 1 - the significance level
adopted in the forward selection. By default is set to 0.95.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTest_+3A_maxdeg">maxDeg</code></td>
<td>
<p>The maximum degree considered in the forward selection.
By default is set to 4.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calibration belt and the associated test can be used both to evaluate
the calibration of the model in external samples or in the development dataset. However,
the two cases have different requirements. When a model is evaluated on independent
samples, the calibration belt and the related test can be applied whatever is the
method used to fit the model. Conversely, they can be used on the development set
only if the model is fitted with logistic regression.
</p>


<h3>Value</h3>

<p>A list of class <code>htest</code> containing the following components:
</p>

<dl>
<dt>statistic</dt><dd><p>The value of the test's statistic.</p>
</dd>
<dt>p.value</dt><dd><p>The p-value of the test.</p>
</dd>
<dt>null.value</dt><dd><p>The vector of coefficients hypothesized under the null hypothesis,
that is, the parameters corresponding to the bisector.</p>
</dd>
<dt>alternative</dt><dd><p>A character string describing the alternative hypothesis.</p>
</dd>
<dt>method</dt><dd><p>A character string indicating what type of calibration
test (internal or external) was performed.</p>
</dd>
<dt>estimate</dt><dd><p>The estimate of the coefficients of the polynomial logistic
regression.</p>
</dd>
<dt>data.name</dt><dd><p>A character string giving the name(s) of the data.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+givitiCalibrationBelt">givitiCalibrationBelt</a></code> and <code><a href="#topic+plot.givitiCalibrationBelt">plot.givitiCalibrationBelt</a></code>
to compute and plot the calibaration belt.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Random by-construction well calibrated model
e &lt;- runif(100)
o &lt;- rbinom(100, size = 1, prob = e)
givitiCalibrationTest(o, e, "external")

#Random by-construction poorly calibrated model
e &lt;- runif(100)
o &lt;- rbinom(100, size = 1, prob = logistic(logit(e)+2))
givitiCalibrationTest(o, e, "external")
</code></pre>

<hr>
<h2 id='givitiCalibrationTestComp'>Computation of the Calibration Test</h2><span id='topic+givitiCalibrationTestComp'></span>

<h3>Description</h3>

<p><code>givitiCalibrationTestComp</code> implements the computations necessary to
perform the calibration test associated to the calibration belt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>givitiCalibrationTestComp(o, e, devel, thres, maxDeg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="givitiCalibrationTestComp_+3A_o">o</code></td>
<td>
<p>A numeric vector representing the binary outcomes.
The elements must assume only the values 0 or 1. The predictions
in <code>e</code> must represent the probability of the event
coded as 1.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTestComp_+3A_e">e</code></td>
<td>
<p>A numeric vector containing the probabilities of the
model under evaluation. The elements must be numeric and between 0 and 1.
The lenght of the vector must be equal to the length of the vector <code>o</code>.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTestComp_+3A_devel">devel</code></td>
<td>
<p>A character string specifying if the model has been fit on
the same dataset under evaluation (<code>internal</code>) or if the model has
been developed on an external sample (<code>external</code>). See also the 'Details' sections.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTestComp_+3A_thres">thres</code></td>
<td>
<p>A numeric scalar between 0 and 1 representing 1 - the significance level
adopted in the forward selection.</p>
</td></tr>
<tr><td><code id="givitiCalibrationTestComp_+3A_maxdeg">maxDeg</code></td>
<td>
<p>The maximum degree considered in the forward selection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calibration belt and the associated test can be used both to evaluate
the calibration of the model in external samples or in the development dataset. However,
the two cases have different requirements. When a model is evaluated on independent
samples, the calibration belt and the related test can be applied whatever is the
method used to fit the model. Conversely, they can be used on the development set
only if the model is fitted with logistic regression.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt>data</dt><dd><p>A <code>data.frame</code> object with the numeric variables &quot;o&quot;, &quot;e&quot; provided
in the input and the variable &quot;logite&quot;, the logit of the probabilities.</p>
</dd>
<dt>nrowOrigData</dt><dd><p>The size of the original sample, i.e. the length of the
vectors <code>e</code> and <code>o</code>.</p>
</dd>
<dt>calibrationStat</dt><dd><p>The value of the test's statistic.</p>
</dd>
<dt>calibrationP</dt><dd><p>The p-value of the test.</p>
</dd>
<dt>m</dt><dd><p>The degree of the polynomial at the end of the forward selection.</p>
</dd>
<dt>fit</dt><dd><p>An object of class <code>glm</code> containig the output of the fit
of the logistic regression model at the end of the iterative
forward selection.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+givitiCalibrationBelt">givitiCalibrationBelt</a></code> and <code><a href="#topic+plot.givitiCalibrationBelt">plot.givitiCalibrationBelt</a></code>
to compute and plot the calibaration belt, and
<code><a href="#topic+givitiCalibrationTest">givitiCalibrationTest</a></code> to perform the
associated calibration test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e &lt;- runif(100)
o &lt;- rbinom(100, size = 1, prob = e)
givitiCalibrationTestComp(o, e, "external", .95, 4)
</code></pre>

<hr>
<h2 id='givitiCheckArgs'>Check of the argument's values</h2><span id='topic+givitiCheckArgs'></span>

<h3>Description</h3>

<p>Check of the coherence of the values passed to the functions
<code>givitiCalibrationTest</code> and <code>givitiCalibrationBelt</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>givitiCheckArgs(o, e, devel, thres, maxDeg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="givitiCheckArgs_+3A_o">o</code></td>
<td>
<p>A numeric vector representing the binary outcomes.
The elements must assume only the values 0 or 1. The predictions
in <code>e</code> must represent the probability of the event
coded as 1.</p>
</td></tr>
<tr><td><code id="givitiCheckArgs_+3A_e">e</code></td>
<td>
<p>A numeric vector containing the probabilities of the
model under evaluation. The elements must be numeric and between 0 and 1.
The lenght of the vector must be equal to the length of the vector <code>o</code>.</p>
</td></tr>
<tr><td><code id="givitiCheckArgs_+3A_devel">devel</code></td>
<td>
<p>A character string specifying if the model has been fit on
the same dataset under evaluation (<code>internal</code>) or if the model has
been developed on an external sample (<code>external</code>).</p>
</td></tr>
<tr><td><code id="givitiCheckArgs_+3A_thres">thres</code></td>
<td>
<p>A numeric scalar between 0 and 1 representing 1 - the significance level
adopted in the forward selection.</p>
</td></tr>
<tr><td><code id="givitiCheckArgs_+3A_maxdeg">maxDeg</code></td>
<td>
<p>The maximum degree considered in the forward selection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function produce an error if the elements provided
through the arguments do not meet the constraints reported.
</p>

<hr>
<h2 id='givitiCheckData'>Check of data</h2><span id='topic+givitiCheckData'></span>

<h3>Description</h3>

<p>The function verifies that the data are compatible with the
construction of the calibration belt. In particular,
the function checks that the predictions provided do not
complete separate the outcomes and that at least two events and non-events
are present in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>givitiCheckData(o, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="givitiCheckData_+3A_o">o</code></td>
<td>
<p>A numeric vector representing the binary outcomes.
The elements must assume only the values 0 or 1. The predictions
in <code>e</code> must represent the probability of the event
coded as 1.</p>
</td></tr>
<tr><td><code id="givitiCheckData_+3A_e">e</code></td>
<td>
<p>A numeric vector containing the probabilities of the
model under evaluation. The elements must be numeric and between 0 and 1.
The lenght of the vector must be equal to the length of the vector <code>o</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is <code>TRUE</code> if the data do not show any of the
reported problems. Otherwise, the function returns a string describing the
problem found.
</p>

<hr>
<h2 id='givitiR'>givitiR: assessing the calibration of binary outcome models with the GiViTI calibration belt.</h2><span id='topic+givitiR'></span><span id='topic+givitiR-package'></span>

<h3>Description</h3>

<p>The package 'givitiR' provides the functions to plot the
GiViTI calibration belt and to compute the associated statistical test.
</p>


<h3>Details</h3>

<p>The name of the approach derives from the GiViTI (Gruppo Italiano per la valutazione
degli interventi in Terapia Intensiva,
Italian Group for the Evaluation of the Interventions in Intensive Care Units), an
international network of intensive care units (ICU) established in Italy in 1992.
The group counts more than 400 ICUs from 7 countries, with about the half of the participating
centers continuosly collecting data on the admitted patients through the PROSAFE project (PROmoting patient SAFEty
and quality improvement in critical care). For further information, see the
package vignette and the references therein.
</p>
<p>The GiViTI calibration belt has been developed within the methodological research
promoted by the GiViTI network, with the purposes of a) enhancing the quality of the
logistic regression models built in the group's projects b) providing the participating ICUs
with a detailed feedback about their quality of care. A description of the approach
and examples of applications are reported in the package vignette.
</p>
<p>The main functions of the package are listed below.
</p>


<h3>Fitting the calibration belt</h3>

<p><code><a href="#topic+givitiCalibrationBelt">givitiCalibrationBelt</a></code> implements the computations necessary
to plot the calibration belt.
</p>


<h3>Plotting the calibration belt</h3>

<p><code><a href="#topic+plot.givitiCalibrationBelt">plot.givitiCalibrationBelt</a></code> plots the calibration belt.
</p>


<h3>Computing the calibration test</h3>

<p><code><a href="#topic+givitiCalibrationTest">givitiCalibrationTest</a></code> performs the calibration test associated to the
calibration belt.
</p>

<hr>
<h2 id='givitiStatCdf'>CDF of the Calibration Statistic Under the Null Hypothesis</h2><span id='topic+givitiStatCdf'></span>

<h3>Description</h3>

<p><code>givitiStatCdf</code> returns the cumulative density function of the
calibration statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>givitiStatCdf(t, m, devel, thres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="givitiStatCdf_+3A_t">t</code></td>
<td>
<p>The argument of the CDF. Must be a scalar value.</p>
</td></tr>
<tr><td><code id="givitiStatCdf_+3A_m">m</code></td>
<td>
<p>The scalar integer representing the degree of the polynomial
at the end of the forward selection.</p>
</td></tr>
<tr><td><code id="givitiStatCdf_+3A_devel">devel</code></td>
<td>
<p>A character string specifying if the model has been fit on
the same dataset under evaluation (<code>internal</code>) or if the model has
been developed on an external sample (<code>external</code>).</p>
</td></tr>
<tr><td><code id="givitiStatCdf_+3A_thres">thres</code></td>
<td>
<p>A numeric scalar between 0 and 1 representing the
significance level adopted in the forward selection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number representing the value of the CDF evaluated in t.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+givitiCalibrationBelt">givitiCalibrationBelt</a></code> and <code><a href="#topic+plot.givitiCalibrationBelt">plot.givitiCalibrationBelt</a></code>
to compute and plot the calibaration belt, and
<code><a href="#topic+givitiCalibrationTest">givitiCalibrationTest</a></code> to perform the
associated calibration test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>givitiStatCdf(3, 1, "external", .95)
givitiStatCdf(3, 2, "internal", .95)
</code></pre>

<hr>
<h2 id='icuData'>Information of SAPS II score and outcome of 1,000 ICU patients.</h2><span id='topic+icuData'></span>

<h3>Description</h3>

<p>A dataset containing clinical information of 1,000 patients admitted to Italian Intesive Care Units
joining the GiViTI network (<em>Gruppo Italiano per la valutazione degli interventi in Terapia Intensiva</em>,
Italian Group for the Evaluation of the Interventions in Intensive Care Units). The data has
been collected within the ProSAFE project, an Italian observational study based on a continuous
data collection of clinical data in more than 200 Italian ICUs. The purpose of the project is a
continuous surveillance of the quality of care provided in the participating centres.
The actual values of the variables have been modified to protect subject confidentiality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icuData
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 33 variables. The dataset contains, for each predictor of the SAPSII score,
both the clinical information and the weight of that variable in the score (the variable with the suffix '_NUM').
</p>

<dl>
<dt>outcome</dt><dd><p>hospital outcome, numeric binary variable with values 1 (deceased) and 0 (alive).</p>
</dd>
<dt>probSaps</dt><dd><p>probability estimated by the SAPSII prognostic model.</p>
</dd>
<dt>sapsScore</dt><dd><p>SAPSII score.</p>
</dd>
<dt>age,age_NUM</dt><dd><p>age, factor variable with levels (in years): '&lt;40', '40-59', '60-69', '70-74', '75-80', '&gt;=80'.</p>
</dd>
<dt>adm,adm_NUM</dt><dd><p>type of admission, factor variable with 3 levels: 'unschSurg' (unscheduled surgery), 'med' (medical), 'schSurg' (scheduled surgery).</p>
</dd>
<dt>chronic,chronic_NUM</dt><dd><p>chronic diseases, factor variable with 4 levels: 'noChronDis' (no chronic disease), 'metCarc' (metastatic carcinoma), 'hemMalig' (hematologic malignancy), 'aids' (AIDS).</p>
</dd>
<dt>gcs,gcs_NUM</dt><dd><p>Glasgow Coma Scale, factor variable with 5 levels: '3-5', '6-8', '9-10', '11-13', '14-15'.</p>
</dd>
<dt>BP,BP_NUM</dt><dd><p>systolic blood pressure, factor variable with 4 levels (in mmHg): '&lt;70', '70-99', '100-199', '&gt;=200'.</p>
</dd>
<dt>HR,HR_NUM</dt><dd><p>heart rate, factor variable with 5 levels: '&lt;40', '40-69', '70-119', '120-159', '&gt;=160'</p>
</dd>
<dt>temp,temp_NUM</dt><dd><p>temperature, factor variable with 2 levels (in Celsius degree): '&lt;39', '&gt;=39'.</p>
</dd>
<dt>urine,urine_NUM</dt><dd><p>urine output, factor variable with 3 levels (in L/24h): '&lt;0.5', '0.5-0.99', '&gt;=1'.</p>
</dd>
<dt>urea,urea_NUM</dt><dd><p>serum urea, factor variable with 3 levels (in g/L): '&lt;0.60', '0.60-1.79', '&gt;=1.80'.</p>
</dd>
<dt>WBC,WBC_NUM</dt><dd><p>wbc, factor variable with 3 levels (in 1/mm3): '&lt;1', '1-19', '&gt;=20'.</p>
</dd>
<dt>potassium,potassium_NUM</dt><dd><p>potassium, factor variable with 3 levels (in mEq/L): '&lt;3', '3-4.9', '&gt;=5'.</p>
</dd>
<dt>sodium,sodium_NUM</dt><dd><p>sodium, factor variable with 3 levels (in mEq/L): '&lt;125', '125-144', '&gt;=145'.</p>
</dd>
<dt>HCO3,HCO3_NUM</dt><dd><p>HCO3, factor variable with 3 levels (in mEq/L): '&lt;15',  '15-19',  '&gt;=20'.</p>
</dd>
<dt>bili,bili_NUM</dt><dd><p>bilirubin, factor variable with 3 levels (in mg/dL): '&lt;4', '4-5.9', '&gt;=6'.</p>
</dd>
<dt>paFiIfVent,paFiIfVent_NUM</dt><dd><p>mechanical ventilation and CPAP PaO2/FIO2, factor variable with 4 levels (PaO2/FIO2 in mmHg): 'noVent' (not ventilated), 'vent_&lt;100' (ventialated and Pa02/FI02 &lt;100), 'vent_100-199' (ventialated and Pa02/FI02 in 100-199), 'vent_&gt;=200' (ventialated and Pa02/FI02 &gt;= 200).</p>
</dd>
</dl>


<h3>Details</h3>

<p>The data contain the information to apply the SAPSII model, a prognostic model developed to
predict hospital mortality (Le Gall et al., 1993).
Both the computed SAPSII score and the associated probability of death are variables of the dataset.
The score is an integer number ranging from 0 to 163 describing the severity of the patient (the higher
the score, the more severe the patient). The probability is computed from the score through the formula
reported in the original paper. The dataset contains also the hospital survival of the patients.
</p>


<h3>Source</h3>

<p><a href="http://www.giviti.marionegri.it/Default.asp">http://www.giviti.marionegri.it/Default.asp</a> (in Italian only)
</p>


<h3>References</h3>

<p>Le Gall, Jean-Roger, Stanley Lemeshow, and Fabienne Saulnier. &quot;A new simplified acute physiology score (SAPS II) based on a European/North American multicenter study.&quot; <em>Jama</em> 270, no. 24 (1993): 2957-2963.
</p>
<p>The GiViTI Network, <em>Prosafe Project - 2014 report</em>. Sestante Edizioni: Bergamo, 2015. <a href="http://www.giviti.marionegri.it/Download/ReportPROSAFE_2014_EN_Polivalenti_ITALIA.pdf">http://www.giviti.marionegri.it/Download/ReportPROSAFE_2014_EN_Polivalenti_ITALIA.pdf</a>.
</p>

<hr>
<h2 id='logit'>Logit and logistic functions</h2><span id='topic+logistic'></span><span id='topic+logit'></span>

<h3>Description</h3>

<p><code>logit</code> and <code>logistic</code> implement the logit and logistic transformations, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logit(p)

logistic(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logit_+3A_p">p</code></td>
<td>
<p>A numeric vector whose components are numbers between 0 and 1.</p>
</td></tr>
<tr><td><code id="logit_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The functions apply the logit and logistic transformation to each element of the vector
passed as argument.
In particular, logit(p)=ln(p/(1-p)) and logistic(x)=exp(x)/(1+exp(x)).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logit(0.1)
logit(0.5)
logistic(0)
logistic(logit(0.25))
logit(logistic(2))
</code></pre>

<hr>
<h2 id='plot.givitiCalibrationBelt'>Calibration Belt Plot</h2><span id='topic+plot.givitiCalibrationBelt'></span>

<h3>Description</h3>

<p>The <code>plot</code> method for calibration belt objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'givitiCalibrationBelt'
plot(x, xlim = c(0, 1), ylim = c(0, 1),
  colBis = "red", xlab = "e", ylab = "o",
  main = "GiViTI Calibration Belt", polynomialString = T,
  pvalueString = T, nString = T, table = T, tableStrings = NULL,
  unableToFitString = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_x">x</code></td>
<td>
<p>A <code>givitiCalibrationBelt</code> object, to be generated with
the function <code>givitiCalibrationBelt</code>.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_xlim">xlim</code>, <code id="plot.givitiCalibrationBelt_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vectors of length 2, giving the
x and y coordinates ranges. Default values are <code>c(0,1)</code>.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_colbis">colBis</code></td>
<td>
<p>The color to be used for the bisector. The default
value is red.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_xlab">xlab</code>, <code id="plot.givitiCalibrationBelt_+3A_ylab">ylab</code></td>
<td>
<p>Titles for the x and y axis. Default values are &quot;e&quot; and
&quot;o&quot;, repectively.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_main">main</code></td>
<td>
<p>The main title of the plot. The default value is &quot;GiViTI Calibration Belt&quot;.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_polynomialstring">polynomialString</code></td>
<td>
<p>If the value is FALSE, the degree of the polynomial is
not printed on the graphical area. If the value is TRUE, the degree m is reported.
If a string is passed to this argument, the string is reported instead of the
text &quot;Polynomial degree&quot;. The default value is TRUE.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_pvaluestring">pvalueString</code></td>
<td>
<p>If the value is FALSE, the p-value of the test is
not printed on the graphical area. If the value is TRUE, the p-value is reported.
If a string is passed to this argument, the string is reported instead of the
text &quot;p-value&quot;. The default value is TRUE.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_nstring">nString</code></td>
<td>
<p>If the value is FALSE, the sample size is
not printed on the graphical area. If the value is TRUE, the sample size is reported.
If a string is passed to this argument, the string is reported instead of the
text &quot;n&quot;. The default value is TRUE.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_table">table</code></td>
<td>
<p>A boolean value indicating whether the table reporting the
intersections of the calibration belt with the bisector should be
printed on the plot.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_tablestrings">tableStrings</code></td>
<td>
<p>Optional. A list with four character elements named
<code>overBisString</code>,<code>underBisString</code>,<code>confLevelString</code>,
<code>neverString</code>. The four strings of the list are printed instead of the
texts &quot;Over the bisector&quot;/&quot;Under the bisector&quot;/&quot;Confidence level&quot;/&quot;NEVER&quot;
in the table reporting the intersections of the calibration belt with
the bisector.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_unabletofitstring">unableToFitString</code></td>
<td>
<p>Optional. If a string is passed to this argument,
this string is reported in the plot area when the dataset is not compatible
with the fit of the calibration belt (e.g. data separation or no positive events).
By default, in such cases the text &quot;Unable to fit the Calibration Belt&quot; is
reported.</p>
</td></tr>
<tr><td><code id="plot.givitiCalibrationBelt_+3A_...">...</code></td>
<td>
<p>Other graphical parameters passed to the generic <code>plot</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function generates the calibration belt plot. In addition,
a list containing the following components is returned:
</p>

<dl>
<dt>p.value</dt><dd><p>The p-value of the test.</p>
</dd>
<dt>m</dt><dd><p>The degree of the polynomial at the end of the forward selection.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+givitiCalibrationBelt">givitiCalibrationBelt</a></code>
to compute the calibaration belt and
<code><a href="#topic+givitiCalibrationTest">givitiCalibrationTest</a></code> to perform the
associated calibration test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Random by-construction well calibrated model
e &lt;- runif(100)
o &lt;- rbinom(100, size = 1, prob = e)
cb &lt;- givitiCalibrationBelt(o, e, "external")
plot(cb)

#Random by-construction poorly calibrated model
e &lt;- runif(100)
o &lt;- rbinom(100, size = 1, prob = logistic(logit(e)+2))
cb &lt;- givitiCalibrationBelt(o, e, "external")
plot(cb)
</code></pre>

<hr>
<h2 id='polynomialLogRegrFw'>Forward Selection in Polynomial Logistic Regression</h2><span id='topic+polynomialLogRegrFw'></span>

<h3>Description</h3>

<p><code>polynomialLogRegrFw</code> implements a forward selection in a
polynomial logistic regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polynomialLogRegrFw(data, thres, maxDeg, startDeg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polynomialLogRegrFw_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> object with the numeric variables &quot;o&quot;, &quot;e&quot;
and &quot;logite&quot;, representing the binary outcomes, the probabilities of the
model under evaluation and the logit of the probabilities.
The variable &quot;e&quot; must contain values between 0 and 1. The variable
&quot;o&quot; must assume only the value 0 and 1.</p>
</td></tr>
<tr><td><code id="polynomialLogRegrFw_+3A_thres">thres</code></td>
<td>
<p>A numeric scalar between 0 and 1 representing the significance level
adopted in the forward selection.</p>
</td></tr>
<tr><td><code id="polynomialLogRegrFw_+3A_maxdeg">maxDeg</code></td>
<td>
<p>The maximum degree considered in the forward selection.</p>
</td></tr>
<tr><td><code id="polynomialLogRegrFw_+3A_startdeg">startDeg</code></td>
<td>
<p>The starting degree in the forward selection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt>fit</dt><dd><p>An object of class <code>glm</code> containig the output of the fit
of the logistic regression model at the end of the iterative
forward selection.</p>
</dd>
<dt>m</dt><dd><p>The degree of the polynomial at the end of the forward selection.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>e &lt;- runif(100)
logite &lt;- logit(e)
o &lt;- rbinom(100, size = 1, prob = e)
data &lt;- data.frame(e = e, o = o, logite = logite)
polynomialLogRegrFw(data, .95, 4, 1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
