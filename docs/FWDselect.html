<!DOCTYPE html><html lang="en"><head><title>Help for package FWDselect</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FWDselect}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FWDselect'><p><code>FWDselect</code>: Selecting Variables in Regression Models.</p></a></li>
<li><a href='#diabetes'><p>Diabetes data.</p></a></li>
<li><a href='#episode'><p>Episode of SO2. Pollution incident data.</p></a></li>
<li><a href='#plot.qselection'><p>Visualization of <code>qselection</code> object</p></a></li>
<li><a href='#pollution'><p>Emission of SO2. Pollution incident data.</p></a></li>
<li><a href='#print.qselection'><p>Short <code>qselection</code> summary</p></a></li>
<li><a href='#print.selection'><p>Short <code>selection</code> summary</p></a></li>
<li><a href='#qselection'><p>Selecting variables for several subset sizes</p></a></li>
<li><a href='#selection'><p>Selecting a subset of <code>q</code> variables</p></a></li>
<li><a href='#test'><p>Bootstrap based test for covariate selection</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Selecting Variables in Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-12-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Marta Sestelo [aut, cre],
  Nora M. Villanueva [aut],
  Javier Roca-Pardinas [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marta Sestelo &lt;sestelo@uvigo.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A simple method
    to select the best model or best subset of variables using
    different types of data (binary, Gaussian or Poisson) and
    applying it in different contexts (parametric or non-parametric).</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://cran.r-project.org/package=FWDselect">http://cran.r-project.org/package=FWDselect</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://github.com/sestelo/fwdselect/issues">http://github.com/sestelo/fwdselect/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>cvTools, mgcv, parallel, graphics, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-12-18 18:21:53 UTC; Sestelo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-12-19 09:34:15</td>
</tr>
</table>
<hr>
<h2 id='FWDselect'><code>FWDselect</code>: Selecting Variables in Regression Models.</h2><span id='topic+FWDselect'></span><span id='topic+FWDselect-package'></span>

<h3>Description</h3>

<p>This package introduces a simple method to select the best model
using different types of data (binary, Gaussian or Poisson) and applying it
in different contexts (parametric or non-parametric). The proposed method is a
new forward stepwise-based selection procedure that  selects a model
containing a subset of variables according to an optimal criterion (obtained
by cross-validation) and also takes into account the computational cost.
Additionally,  bootstrap resampling techniques are used to implement tests
capable of detecting whether significant effects of the unselected variables
are present in the model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> FWDselect</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1.0</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2015-12-18</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> MIT + file LICENSE</td>
</tr>

</table>

<p><code>FWDselect</code> is just a shortcut for &ldquo;Forward selection&rdquo; and is a very
good summary of one of the package's major functionalities, i.e., that of
providing a forward stepwise-based selection procedure. This software helps
the user select relevant variables and evaluate how many of these need to be
included in a regression model. In addition, it enables both numerical and
graphical outputs to be displayed. The package includes several functions
that enable users to select the variables to be included in linear,
generalized linear or generalized additive regression models. Users can
obtain the best combinations of <code>q</code> variables by means of the main
function <code><a href="#topic+selection">selection</a></code>. Additionally, if one wants to obtain the
results for more than one size of subset, it is possible to apply the
<code><a href="#topic+qselection">qselection</a></code> function, which returns a summary table showing the
different subsets, selected variables and information criterion values. The
object obtained when using this last function is the argument required for
<code><a href="#topic+plot.qselection">plot.qselection</a></code>, which provides a graphical output. Finally, to
determine the number of variables that should be introduced into the model,
only the <code><a href="#topic+test">test</a></code> function needs to be applied.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Burnham, K., Anderson, D. (2002). Model selection and multimodel
inference: a practical information-theoretic approach. 2nd Edition
Springer.
</p>
<p>Efron, B. (1979). Bootstrap methods: another look at the jackknife. Annals
of Statistics, 7:1-26.
</p>
<p>Efron, B. and Tibshirani, R. J. (1993). An introduction to the Bootstrap.
Chapman and Hall, London.
</p>
<p>Miller, A. (2002). Subset selection in regression. Champman and Hall.
</p>
<p>Sestelo, M., Villanueva, N. M. and Roca-Pardinas, J. (2013). FWDselect:
Variable selection algorithm in regression models. Discussion Papers in
Statistics and Operation Research, University of Vigo, 13/02.
</p>

<hr>
<h2 id='diabetes'>Diabetes data.</h2><span id='topic+diabetes'></span>

<h3>Description</h3>

<p>The diabetes data is a data frame with 11 variables and 442 measurements.
These are the data used in the Efron et al. (2004) paper. The data has been
standardized to have unit L2 norm in each column and zero mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diabetes
</code></pre>


<h3>Format</h3>

<p><code>diabetes</code> is a data frame with 11 variables (columns).
The first column of the data frame contains the response variable
(<code>diabetes$y</code>) which is a quantitative measure of disease progression
one year after baseline. The rest of the columns contain the measurements of
the ten explanatory variables (age, sex, body mass index, average blood
pressure and six blood serum registers) obtained from each of the 442
diabetes patients.</p>


<h3>Source</h3>

<p>The orginal data are available in the lars package,
see http://cran.r-project.org/web/packages/lars/.
</p>


<h3>References</h3>

<p>Efron, B., Hastie, T., Johnstone, I. and Tibshirani, R. (2004).
Least angle regression (with discussion). Annals of Statistics, 32:407&ndash;499.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FWDselect)
data(diabetes)
head(diabetes)

</code></pre>

<hr>
<h2 id='episode'>Episode of SO2. Pollution incident data.</h2><span id='topic+episode'></span>

<h3>Description</h3>

<p>Registered values of SO2 in different
temporal instant. Each column of the dataset corresponds with the value
obtained by the series of bi-hourly means for SO2 in the instant <code>t</code>
(5-min temporal instant). The values of this dataset are greater than the
maximum value permitted for SO2 atmospheric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>episode
</code></pre>


<h3>Format</h3>

<p><code>episode</code> is a data frame with 19 variables (columns).
</p>

<dl>
<dt>Y</dt><dd><p>response variable, registered values of SO2 at a specific temporal
instant, in  microg/m3N. This is the value that we want to predict.</p>
</dd>
<dt>In0</dt><dd><p>registered values of SO2 at a specific temporal instant, in this
case instant zero, in  microg/m3N.</p>
</dd> <dt>In1</dt><dd><p>registered values of SO2 at a
specific temporal instant, in this case 5-min instant temporal before, in
microg/m3N.</p>
</dd> <dt>In2</dt><dd><p>registered values of SO2 at a specific temporal instant,
in this case 10-min instant temporal before, in microg/m3N.</p>
</dd></dl>
<p> ... </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(episode)
head(episode)

</code></pre>

<hr>
<h2 id='plot.qselection'>Visualization of <code>qselection</code> object</h2><span id='topic+plot.qselection'></span>

<h3>Description</h3>

<p>This function plots the cross-validation information criterion for several
subsets of size <code class="reqn">q</code> chosen by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qselection'
plot(x = object, y = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.qselection_+3A_x">x</code></td>
<td>
<p><code>qselection</code> object.</p>
</td></tr>
<tr><td><code id="plot.qselection_+3A_y">y</code></td>
<td>
<p>NULL</p>
</td></tr>
<tr><td><code id="plot.qselection_+3A_ylab">ylab</code></td>
<td>
<p>NULL</p>
</td></tr>
<tr><td><code id="plot.qselection_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Simply returns a plot.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FWDselect)
data(diabetes)
x = diabetes[ ,2:11]
y = diabetes[ ,1]
obj2 = qselection(x, y, qvector = c(1:9), method = "lm", criterion = "variance", cluster = FALSE)
plot(obj2)
</code></pre>

<hr>
<h2 id='pollution'>Emission of SO2. Pollution incident data.</h2><span id='topic+pollution'></span>

<h3>Description</h3>

<p>Registered values of SO2 in different temporal instant. Each column of the
dataset corresponds with the value obtained by the series of bi-hourly means
for SO2 in the instant <code class="reqn">t</code> (5-min temporal instant).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pollution
</code></pre>


<h3>Format</h3>

<p><code>pollution</code> is a data frame with 19 variables (columns).
</p>

<dl>
<dt>Y</dt><dd><p>response variable, registered values of SO2 at a
specific temporal instant, in  microg/m3N. This is the value that we want to
predict.</p>
</dd>
<dt>In0</dt><dd><p>registered values of SO2 at a specific temporal
instant, in this case instant zero, in  microg/m3N.</p>
</dd>
<dt>In1</dt><dd><p>registered
values of SO2 at a specific temporal instant, in this case 5-min instant
temporal before, in  microg/m3N.</p>
</dd>
<dt>In2</dt><dd><p>registered values of SO2 at a
specific temporal instant, in this case 10-min instant temporal before, in
microg/m3N.</p>
</dd>
</dl>
<p>...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pollution)
head(pollution)

</code></pre>

<hr>
<h2 id='print.qselection'>Short <code>qselection</code> summary</h2><span id='topic+print.qselection'></span>

<h3>Description</h3>

<p><code><a href="#topic+qselection">qselection</a></code> summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qselection'
print(x = object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.qselection_+3A_x">x</code></td>
<td>
<p><code>qselection</code> object.</p>
</td></tr>
<tr><td><code id="print.qselection_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a summary table with the subsets of size
<code class="reqn">q</code>, their information criterion values and the chosen variables for
each one. Additionally, an asterisk is shown next to the size of subset
which minimizes the information criterion.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FWDselect)
data(diabetes)
x = diabetes[ ,2:11]
y = diabetes[ ,1]
obj2 = qselection(x, y, qvector = c(1:9), method = "lm", criterion = "variance", cluster = FALSE)
obj2
</code></pre>

<hr>
<h2 id='print.selection'>Short <code>selection</code> summary</h2><span id='topic+print.selection'></span>

<h3>Description</h3>

<p><code><a href="#topic+selection">selection</a></code> summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'selection'
print(x = model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.selection_+3A_x">x</code></td>
<td>
<p><code>selection</code> object.</p>
</td></tr>
<tr><td><code id="print.selection_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the best subset of size q and its information
criterion value. In the case of <code>seconds=TRUE</code> this information is
returned for each alternative model.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FWDselect)
data(diabetes)
x = diabetes[ ,2:11]
y = diabetes[ ,1]
obj1 = selection(x, y, q = 1, method = "lm", criterion = "variance", cluster = FALSE)
obj1
</code></pre>

<hr>
<h2 id='qselection'>Selecting variables for several subset sizes</h2><span id='topic+qselection'></span>

<h3>Description</h3>

<p>Function that enables to obtain the best variables for more than
one size of subset. Returns a table with the chosen covariates to be
introduced into the models and their information criteria. Additionally, an
asterisk is shown next to the size of subset which minimizes the
information criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qselection(x, y, qvector, criterion = "deviance", method = "lm",
  family = "gaussian", nfolds = 5, cluster = TRUE, ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qselection_+3A_x">x</code></td>
<td>
<p>A data frame containing all the covariates.</p>
</td></tr>
<tr><td><code id="qselection_+3A_y">y</code></td>
<td>
<p>A vector with the response values.</p>
</td></tr>
<tr><td><code id="qselection_+3A_qvector">qvector</code></td>
<td>
<p>A vector with more than one variable-subset size to be
selected.</p>
</td></tr>
<tr><td><code id="qselection_+3A_criterion">criterion</code></td>
<td>
<p>The information criterion to be used.
Default is the deviance. Other functions provided
are the coefficient of determination (<code>"R2"</code>), the residual
variance (<code>"variance"</code>), the Akaike information criterion (<code>"aic"</code>),
AIC with a correction for finite sample sizes (<code>"aicc"</code>)
and the Bayesian information criterion (<code>"bic"</code>). The deviance,
coefficient of determination and variance are calculated by cross-validation.</p>
</td></tr>
<tr><td><code id="qselection_+3A_method">method</code></td>
<td>
<p>A character string specifying which regression method is used,
i.e., linear models (<code>"lm"</code>), generalized additive models
(<code>"glm"</code>) or generalized additive models (<code>"gam"</code>).</p>
</td></tr>
<tr><td><code id="qselection_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be
used in the model: (<code>"gaussian"</code>), (<code>"binomial"</code>) or
(<code>"poisson"</code>).</p>
</td></tr>
<tr><td><code id="qselection_+3A_nfolds">nfolds</code></td>
<td>
<p>Number of folds for the cross-validation procedure, for
<code>deviance</code>, <code>R2</code> or <code>variance</code> criterion.</p>
</td></tr>
<tr><td><code id="qselection_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If  <code>TRUE</code> (default), the
procedure is  parallelized. Note that there are cases without enough
repetitions (e.g., a low number of initial variables) that R will gain in
performance through serial computation. R takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing, it does
not worth parallelize.</p>
</td></tr>
<tr><td><code id="qselection_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used
in the parallelized procedure. If <code>NULL</code> (default), the number of cores to be used
is equal to the number of cores of the machine - 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>A vector of subset sizes.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>A vector of Information criterion values.</p>
</td></tr>
<tr><td><code>selection</code></td>
<td>
<p>Selected variables for each size.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code> <code><a href="#topic+plot.qselection">plot.qselection</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FWDselect)
data(diabetes)
x = diabetes[ ,2:11]
y = diabetes[ ,1]
obj2 = qselection(x, y, qvector = c(1:9), method = "lm", criterion = "variance", cluster = FALSE)
obj2

</code></pre>

<hr>
<h2 id='selection'>Selecting a subset of <code>q</code> variables</h2><span id='topic+selection'></span>

<h3>Description</h3>

<p>Main function for selecting the best subset of <code class="reqn">q</code> variables.
Note that the selection procedure can be used with lm, glm or gam functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selection(x, y, q, prevar = NULL, criterion = "deviance", method = "lm",
  family = "gaussian", seconds = FALSE, nmodels = 1, nfolds = 5,
  cluster = TRUE, ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selection_+3A_x">x</code></td>
<td>
<p>A data frame containing all the covariates.</p>
</td></tr>
<tr><td><code id="selection_+3A_y">y</code></td>
<td>
<p>A vector with the response values.</p>
</td></tr>
<tr><td><code id="selection_+3A_q">q</code></td>
<td>
<p>An integer specifying the size of the subset of variables to be
selected.</p>
</td></tr>
<tr><td><code id="selection_+3A_prevar">prevar</code></td>
<td>
<p>A vector containing the number of the best subset of
<code>q-1</code> variables. <code>NULL</code>, by default.</p>
</td></tr>
<tr><td><code id="selection_+3A_criterion">criterion</code></td>
<td>
<p>The information criterion to be used.
Default is the deviance. Other functions provided
are the coefficient of determination (<code>"R2"</code>), the residual
variance (<code>"variance"</code>), the Akaike information criterion (<code>"aic"</code>),
AIC with a correction for finite sample sizes (<code>"aicc"</code>)
and the Bayesian information criterion (<code>"bic"</code>). The deviance,
coefficient of determination and variance are calculated by cross-validation.</p>
</td></tr>
<tr><td><code id="selection_+3A_method">method</code></td>
<td>
<p>A character string specifying which regression method is used,
i.e., linear models (<code>"lm"</code>), generalized additive models
(<code>"glm"</code>) or generalized additive models (<code>"gam"</code>).</p>
</td></tr>
<tr><td><code id="selection_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be
used in the model: (<code>"gaussian"</code>), (<code>"binomial"</code>) or
(<code>"poisson"</code>).</p>
</td></tr>
<tr><td><code id="selection_+3A_seconds">seconds</code></td>
<td>
<p>A logical value. By default, <code>FALSE</code>.  If <code>TRUE</code>
then, rather than returning the single best model only, the function returns
a few of the best models (equivalent).</p>
</td></tr>
<tr><td><code id="selection_+3A_nmodels">nmodels</code></td>
<td>
<p>Number of secondary models to be returned.</p>
</td></tr>
<tr><td><code id="selection_+3A_nfolds">nfolds</code></td>
<td>
<p>Number of folds for the cross-validation procedure, for
<code>deviance</code>, <code>R2</code> or <code>variance</code> criterion.</p>
</td></tr>
<tr><td><code id="selection_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If  <code>TRUE</code> (default), the
procedure is  parallelized. Note that there are cases without enough
repetitions (e.g., a low number of initial variables) that R will gain in
performance through serial computation. R takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing, it does
not worth parallelize.</p>
</td></tr>
<tr><td><code id="selection_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used
in the parallelized procedure. If <code>NULL</code> (default), the number of cores to be used
is equal to the number of cores of the machine - 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Best model</code></td>
<td>
<p>The best model. If <code>seconds=TRUE</code>, it returns
also the best alternative models.</p>
</td></tr>
<tr><td><code>Variable name</code></td>
<td>
<p>Names of the variable.</p>
</td></tr>
<tr><td><code>Variable number</code></td>
<td>
<p>Number of the variables.</p>
</td></tr>
<tr><td><code>Information criterion</code></td>
<td>
<p>Information criterion used and its value.</p>
</td></tr>
<tr><td><code>Prediction</code></td>
<td>
<p>The prediction of the best model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FWDselect)
data(diabetes)
x = diabetes[ ,2:11]
y = diabetes[ ,1]
obj1 = selection(x, y, q = 1, method = "lm", criterion = "variance", cluster = FALSE)
obj1

# second models
obj11 = selection(x, y, q = 1, method = "lm", criterion = "variance",
seconds = TRUE, nmodels = 2, cluster = FALSE)
obj11

# prevar argument
obj2 = selection(x, y, q = 2, method = "lm", criterion = "variance", cluster = FALSE)
obj2
obj3 = selection(x, y, q = 3, prevar = obj2$Variable_numbers,
method = "lm", criterion = "variance", cluster = FALSE)


</code></pre>

<hr>
<h2 id='test'>Bootstrap based test for covariate selection</h2><span id='topic+test'></span>

<h3>Description</h3>

<p>Function that applies a bootstrap based test for covariate
selection. It helps to determine the number of variables to be included in
the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test(x, y, method = "lm", family = "gaussian", nboot = 50,
  speedup = TRUE, qmin = NULL, unique = FALSE, q = NULL,
  bootseed = NULL, cluster = TRUE, ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_+3A_x">x</code></td>
<td>
<p>A data frame containing all the covariates.</p>
</td></tr>
<tr><td><code id="test_+3A_y">y</code></td>
<td>
<p>A vector with the response values.</p>
</td></tr>
<tr><td><code id="test_+3A_method">method</code></td>
<td>
<p>A character string specifying which regression method is used,
i.e., linear models (<code>"lm"</code>), generalized additive models.</p>
</td></tr>
<tr><td><code id="test_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be
used in the model: (<code>"gaussian"</code>), (<code>"binomial"</code>) or
(<code>"poisson"</code>).</p>
</td></tr>
<tr><td><code id="test_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repeats.</p>
</td></tr>
<tr><td><code id="test_+3A_speedup">speedup</code></td>
<td>
<p>A logical value. If  <code>TRUE</code> (default), the testing procedure
is  computationally efficient since it considers one more variable to fit
the alternative model than the number of variables used to fit the null.
If <code>FALSE</code>, the fit of the alternative model is based on considering
the best subset of variables of size greater than <code>q</code>, the one that minimizes an
information criterion. The size of this subset must be given by the user
filling the argument <code>qmin</code>.</p>
</td></tr>
<tr><td><code id="test_+3A_qmin">qmin</code></td>
<td>
<p>By default <code>NULL</code>. If <code>speedup</code> is <code>FALSE</code>,
<code>qmin</code> is an integer number selected by the user. To help you select
this argument, it is recommended to visualize the graphical output of the
<code>plot</code> function and choose the number <code>q</code> which minimizes the curve.</p>
</td></tr>
<tr><td><code id="test_+3A_unique">unique</code></td>
<td>
<p>A logical value. By default <code>FALSE</code>. If  <code>TRUE</code>,
the test is performed only for one null hypothesis, given by the argument  <code>q</code>.</p>
</td></tr>
<tr><td><code id="test_+3A_q">q</code></td>
<td>
<p>By default <code>NULL</code>. If  <code>unique</code> is <code>TRUE</code>, <code>q</code>
is the size of the subset of variables to be tested.</p>
</td></tr>
<tr><td><code id="test_+3A_bootseed">bootseed</code></td>
<td>
<p>Seed to be used in the bootstrap procedure.</p>
</td></tr>
<tr><td><code id="test_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If  <code>TRUE</code> (default), the testing
procedure is  parallelized.</p>
</td></tr>
<tr><td><code id="test_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used
in the parallelized procedure. If <code>NULL</code> (default), the number of cores to be used
is equal to the number of cores of the machine - 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In a regression framework, let <code class="reqn">X_1, X_2, \ldots, X_p</code>,  a set of
<code class="reqn">p</code> initial variables and <code class="reqn">Y</code> the response variable, we propose a
procedure to test the null hypothesis of <code class="reqn">q</code> significant variables  in
the model &ndash;<code class="reqn">q</code>  effects not equal to zero&ndash; versus the alternative in
which the model contains more than <code class="reqn">q</code> variables. Based on the general
model </p>
<p style="text-align: center;"><code class="reqn">Y=m(\textbf{X})+\varepsilon  \quad {\rm{where}} \quad
 m(\textbf{X})= m_{1}(X_{1})+m_{2}(X_{2})+\ldots+m_{p}(X_{p})</code>
</p>
<p> the following
strategy is considered: for a subset of size <code class="reqn">q</code>, considerations will be
given to a test for the null hypothesis </p>
<p style="text-align: center;"><code class="reqn">H_{0} (q): \sum_{j=1}^p
 I_{\{m_j \ne 0\}} \le q</code>
</p>
<p> vs. the general hypothesis </p>
<p style="text-align: center;"><code class="reqn">H_{1} :
 \sum_{j=1}^p I_{\{m_j \ne 0\}} &gt; q</code>
</p>



<h3>Value</h3>

<p>A list with two objects. The first one is a table containing
</p>
<table role = "presentation">
<tr><td><code>Hypothesis</code></td>
<td>
<p>Number of the null hypothesis tested</p>
</td></tr>
<tr><td><code>Statistic</code></td>
<td>
<p>Value of the T statistic</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>pvalue obtained in the testing procedure</p>
</td></tr>
<tr><td><code>Decision</code></td>
<td>
<p>Result of the test for a significance level of 0.05</p>
</td></tr>
</table>
<p>The second argument <code>nvar</code> indicates the number of variables that
have to be included in the model.
</p>


<h3>Note</h3>

<p>The detailed expression of the formulas are described in HTML help
<a href="http://cran.r-project.org/web/packages/FWDselect/FWDselect.pdf">http://cran.r-project.org/web/packages/FWDselect/FWDselect.pdf</a>
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Sestelo, M., Villanueva, N. M. and Roca-Pardinas, J. (2013).
FWDselect: an R package for selecting variables in regression models.
Discussion Papers in Statistics and Operation Research, University of Vigo, 13/01.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FWDselect)
data(diabetes)
x = diabetes[ ,2:11]
y = diabetes[ ,1]
test(x, y, method = "lm", cluster = FALSE, nboot = 5)

## for speedup = FALSE
# obj2 = qselection(x, y, qvector = c(1:9), method = "lm",
# cluster = FALSE)
# plot(obj2) # we choose q = 7 for the argument qmin
# test(x, y, method = "lm", cluster = FALSE, nboot = 5,
# speedup = FALSE, qmin = 7)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
