<!DOCTYPE html><html lang="en"><head><title>Help for package catsim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {catsim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#catsim-package'><p>CatSIM: Binary and Categorical Image Structural Similarity Metric</p></a></li>
<li><a href='#besag'><p>A hand-constructed image from Besag (1986)</p></a></li>
<li><a href='#binssim'><p>Categorical Structural Similarity Index Metric (whole image)</p></a></li>
<li><a href='#catmssim_2d'><p>Multiscale Categorical Structural Similarity Index Measure (2D)</p></a></li>
<li><a href='#catmssim_3d_cube'><p>Multiscale Categorical Structural Similarity Index Measure for a Cube (3D)</p></a></li>
<li><a href='#catmssim_3d_slice'><p>Multiscale Categorical Structural Similarity Index Measure by Slice (3D)</p></a></li>
<li><a href='#catsim'><p>Multiscale Categorical Structural Similarity Index Measure</p></a></li>
<li><a href='#gini'><p>Diversity Indices</p></a></li>
<li><a href='#hoffmanphantom'><p>An example fMRI phantom</p></a></li>
<li><a href='#rand'><p>Similarity Indices</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Binary and Categorical Image Similarity Index</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes a structural similarity metric (after the style of
    MS-SSIM for images) for binary and categorical 2D and 3D images. Can be
    based on accuracy (simple matching), Cohen's kappa, Rand index, adjusted
    Rand index, Jaccard index, Dice index, normalized mutual information, or
    adjusted mutual information. In addition, has fast computation
    of Cohen's kappa, the Rand indices, and the two mutual informations.
    Implements the methods of Thompson and Maitra (2020) &lt;<a href="https://doi.org/10.48550%2FarXiv.2004.09073">doi:10.48550/arXiv.2004.09073</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gzt.github.io/catsim/">https://gzt.github.io/catsim/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gzt/catsim/issues">https://github.com/gzt/catsim/issues</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, testthat</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, covr, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-30 20:22:18 UTC; gzt</td>
</tr>
<tr>
<td>Author:</td>
<td>Geoffrey Thompson <a href="https://orcid.org/0000-0003-2436-8822"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Geoffrey Thompson &lt;gzthompson@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-01 05:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='catsim-package'>CatSIM: Binary and Categorical Image Structural Similarity Metric</h2><span id='topic+catsim-package'></span>

<h3>Description</h3>

<p>Computes a structural similarity metric (after the style of MS-SSIM for images)
for binary and categorical 2D and 3D images. Can be based on accuracy (simple matching),
Cohen's kappa, Rand index, adjusted Rand index, Jaccard index, Dice index, normalized
mutual information, or adjusted mutual information. In addition, has fast computation
of Cohen's kappa, the Rand indices, and the two mutual informations.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Geoffrey Thompson <a href="mailto:gzthompson@gmail.com">gzthompson@gmail.com</a> (<a href="https://orcid.org/0000-0003-2436-8822">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/gzt/catsim">https://github.com/gzt/catsim</a>
</p>
</li>
<li> <p><a href="https://gzt.github.io/catsim/">https://gzt.github.io/catsim/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/gzt/catsim/issues">https://github.com/gzt/catsim/issues</a>
</p>
</li></ul>


<hr>
<h2 id='besag'>A hand-constructed image from Besag (1986)</h2><span id='topic+besag'></span>

<h3>Description</h3>

<p>An <code class="reqn">100 \times 88</code> matrix representing a two-color
hand-drawn scene designed specifically to contain some
awkward features for an image reconstruction method
evaluated in the paper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(besag)
</code></pre>


<h3>Format</h3>

<p>an <code class="reqn">100 \times 88</code> matrix with entries <code>1</code> and <code>2</code>
denoting the color of the corresponding pixels. The example code will
produce the image as it is in the original paper. To use as a <code>0-1</code> binary
dataset, either use <code>besag - 1</code> or <code>besag %% 2</code>.
</p>


<h3>References</h3>

<p>J. Besag, “On the statistical analysis of dirty pictures,”
Journal of the Royal Statistical Society: Series B (Methodological),
vol. 48, no. 3, pp. 259–279, 1986. <a href="https://doi.org/10.1111/j.2517-6161.1986.tb01412.x">doi:10.1111/j.2517-6161.1986.tb01412.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>image(besag[, 88:1])
</code></pre>

<hr>
<h2 id='binssim'>Categorical Structural Similarity Index Metric (whole image)</h2><span id='topic+binssim'></span>

<h3>Description</h3>

<p>This computes the categorical or binary structural similarity index metric
on a whole-image scale. The difference between this and the default 2-D
method is that this considers the whole image at once and one scale rather
than computing the index over a sliding window and downsampling to consider
it at other scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binssim(
  x,
  y,
  alpha = 1,
  beta = 1,
  gamma = 1,
  c1 = 0.01,
  c2 = 0.01,
  method = "Cohen",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binssim_+3A_x">x</code>, <code id="binssim_+3A_y">y</code></td>
<td>
<p>binary or categorical image</p>
</td></tr>
<tr><td><code id="binssim_+3A_alpha">alpha</code></td>
<td>
<p>normalizing parameter, by default 1</p>
</td></tr>
<tr><td><code id="binssim_+3A_beta">beta</code></td>
<td>
<p>normalizing parameter, by default 1</p>
</td></tr>
<tr><td><code id="binssim_+3A_gamma">gamma</code></td>
<td>
<p>normalizing parameter, by default 1</p>
</td></tr>
<tr><td><code id="binssim_+3A_c1">c1</code></td>
<td>
<p>small normalization constant for the <code>c</code> function,
by default 0.01</p>
</td></tr>
<tr><td><code id="binssim_+3A_c2">c2</code></td>
<td>
<p>small normalization constant for the <code>s</code> function,
by default 0.01</p>
</td></tr>
<tr><td><code id="binssim_+3A_method">method</code></td>
<td>
<p>whether to use Cohen's kappa (<code>Cohen</code>),
Jaccard Index (<code>Jaccard</code>), Dice index (<code>Dice</code>),
accuracy (<code>accuracy</code>),  Rand index (<code>Rand</code>),
Adjusted Rand Index (<code>AdjRand</code> or <code>ARI</code>), or normalized mutual
information (<code>NMI</code> or <code>MI</code>) as the similarity index.
Note Jaccard and Dice should only be used on binary data.</p>
</td></tr>
<tr><td><code id="binssim_+3A_...">...</code></td>
<td>
<p>Constants can be passed to the components of the index.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Structural similarity index.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20181207)
x &lt;- matrix(sample(1:4, 10000, replace = TRUE), nrow = 100)
y &lt;- x
for (i in 1:100) y[i, i] &lt;- 1
for (i in 1:99) y[i, i + 1] &lt;- 1
binssim(x, y)
</code></pre>

<hr>
<h2 id='catmssim_2d'>Multiscale Categorical Structural Similarity Index Measure (2D)</h2><span id='topic+catmssim_2d'></span>

<h3>Description</h3>

<p>The categorical structural similarity index measure for 2D categorical or
binary images for multiple scales. The default is to compute over 5 scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catmssim_2d(
  x,
  y,
  levels = NULL,
  weights = NULL,
  window = 11,
  method = "Cohen",
  ...,
  random = "random"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="catmssim_2d_+3A_x">x</code>, <code id="catmssim_2d_+3A_y">y</code></td>
<td>
<p>a binary or categorical image</p>
</td></tr>
<tr><td><code id="catmssim_2d_+3A_levels">levels</code></td>
<td>
<p>how many levels of downsampling to use. By default, 5. If
<code>weights</code> is specified and this is left blank, the argument
will be inferred from the number of weights specified.</p>
</td></tr>
<tr><td><code id="catmssim_2d_+3A_weights">weights</code></td>
<td>
<p>a vector of weights for the different scales. By default,
equal to <code>rep(1,levels)/levels</code>. If specified, there must
at least as many  weights as there are levels and the first
<code>levels</code> weights will be used.</p>
</td></tr>
<tr><td><code id="catmssim_2d_+3A_window">window</code></td>
<td>
<p>by default 11 for 2D and 5 for 3D images,
but can be specified as a
vector if the window sizes differ by dimension.
The vector must have the same number of
dimensions as the inputted <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="catmssim_2d_+3A_method">method</code></td>
<td>
<p>whether to use Cohen's kappa (<code>Cohen</code>),
Jaccard Index (<code>Jaccard</code>), Dice index (<code>Dice</code>),
accuracy (<code>accuracy</code>),  Rand index (<code>Rand</code>),
Adjusted Rand Index (<code>AdjRand</code> or <code>ARI</code>), normalized mutual
information (<code>NMI</code> or <code>MI</code>) or the adjusted mutual
information, <code>AMI</code> and <code>ami</code>, as
the similarity index. Note Jaccard and Dice should only be used on
binary data.</p>
</td></tr>
<tr><td><code id="catmssim_2d_+3A_...">...</code></td>
<td>
<p>additional constants can be passed to internal functions.</p>
</td></tr>
<tr><td><code id="catmssim_2d_+3A_random">random</code></td>
<td>
<p>whether to have deterministic PRNG (<code>pseudo</code>)
or to use <code><a href="base.html#topic+sample">sample()</a></code> (<code>random</code>). If <code>NULL</code>,
will choose the first mode. For complete reproducibility,
use <code>pseudo</code> or <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a value less than 1 indicating the similarity between the images.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20181207)
x &lt;- matrix(sample(0:3, 128^2, replace = TRUE), nrow = 128)
y &lt;- x
for (i in 1:128) y[i, i] &lt;- 0
for (i in 1:127) y[i, i + 1] &lt;- 0
catmssim_2d(x, y, method = "Cohen", levels = 2) # the default
# now using a different similarity score (Jaccard Index)
catmssim_2d(x, y, method = "NMI")
</code></pre>

<hr>
<h2 id='catmssim_3d_cube'>Multiscale Categorical Structural Similarity Index Measure for a Cube (3D)</h2><span id='topic+catmssim_3d_cube'></span>

<h3>Description</h3>

<p>The categorical structural similarity index measure for 3D
categorical or binary images for multiple scales.
The default is to compute over 5 scales.
This computes a 3D measure based on <code class="reqn">5 \times 5 \times 5</code>
windows by default with 5 levels of downsampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catmssim_3d_cube(
  x,
  y,
  levels = NULL,
  weights = NULL,
  window = 5,
  method = "Cohen",
  ...,
  random = "random"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="catmssim_3d_cube_+3A_x">x</code>, <code id="catmssim_3d_cube_+3A_y">y</code></td>
<td>
<p>a binary or categorical image</p>
</td></tr>
<tr><td><code id="catmssim_3d_cube_+3A_levels">levels</code></td>
<td>
<p>how many levels of downsampling to use. By default, 5. If
<code>weights</code> is specified and this is left blank, the argument
will be inferred from the number of weights specified.</p>
</td></tr>
<tr><td><code id="catmssim_3d_cube_+3A_weights">weights</code></td>
<td>
<p>a vector of weights for the different scales. By default,
equal to <code>rep(1,levels)/levels</code>. If specified, there must
at least as many  weights as there are levels and the first
<code>levels</code> weights will be used.</p>
</td></tr>
<tr><td><code id="catmssim_3d_cube_+3A_window">window</code></td>
<td>
<p>by default 11 for 2D and 5 for 3D images,
but can be specified as a
vector if the window sizes differ by dimension.
The vector must have the same number of
dimensions as the inputted <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="catmssim_3d_cube_+3A_method">method</code></td>
<td>
<p>whether to use Cohen's kappa (<code>Cohen</code>),
Jaccard Index (<code>Jaccard</code>), Dice index (<code>Dice</code>),
accuracy (<code>accuracy</code>),  Rand index (<code>Rand</code>),
Adjusted Rand Index (<code>AdjRand</code> or <code>ARI</code>), normalized mutual
information (<code>NMI</code> or <code>MI</code>) or the adjusted mutual
information, <code>AMI</code> and <code>ami</code>, as
the similarity index. Note Jaccard and Dice should only be used on
binary data.</p>
</td></tr>
<tr><td><code id="catmssim_3d_cube_+3A_...">...</code></td>
<td>
<p>additional constants can be passed to internal functions.</p>
</td></tr>
<tr><td><code id="catmssim_3d_cube_+3A_random">random</code></td>
<td>
<p>whether to have deterministic PRNG (<code>pseudo</code>)
or to use <code><a href="base.html#topic+sample">sample()</a></code> (<code>random</code>). If <code>NULL</code>,
will choose the first mode. For complete reproducibility,
use <code>pseudo</code> or <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a value less than 1 indicating the similarity between the images.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20181207)
dim &lt;- 16
x &lt;- array(sample(0:4, dim^3, replace = TRUE), dim = c(dim, dim, dim))
y &lt;- x
for (j in 1:dim) {
  for (i in 1:dim) y[i, i, j] &lt;- 0
  for (i in 1:(dim - 1)) y[i, i + 1, j] &lt;- 0
}
catmssim_3d_cube(x, y, weights = c(.75, .25))
# Now using a different similarity score
catmssim_3d_cube(x, y, weights = c(.75, .25), method = "Accuracy")
</code></pre>

<hr>
<h2 id='catmssim_3d_slice'>Multiscale Categorical Structural Similarity Index Measure by Slice (3D)</h2><span id='topic+catmssim_3d_slice'></span>

<h3>Description</h3>

<p>The categorical structural similarity index measure for 3D categorical or
binary images for multiple scales. The default is to compute over 5 scales.
This computes a 2D measure for each x-y slice of the z-axis
and then averages over the z-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catmssim_3d_slice(
  x,
  y,
  levels = NULL,
  weights = NULL,
  window = 11,
  method = "Cohen",
  ...,
  random = "random"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="catmssim_3d_slice_+3A_x">x</code>, <code id="catmssim_3d_slice_+3A_y">y</code></td>
<td>
<p>a binary or categorical image</p>
</td></tr>
<tr><td><code id="catmssim_3d_slice_+3A_levels">levels</code></td>
<td>
<p>how many levels of downsampling to use. By default, 5. If
<code>weights</code> is specified and this is left blank, the argument
will be inferred from the number of weights specified.</p>
</td></tr>
<tr><td><code id="catmssim_3d_slice_+3A_weights">weights</code></td>
<td>
<p>a vector of weights for the different scales. By default,
equal to <code>rep(1,levels)/levels</code>. If specified, there must
at least as many  weights as there are levels and the first
<code>levels</code> weights will be used.</p>
</td></tr>
<tr><td><code id="catmssim_3d_slice_+3A_window">window</code></td>
<td>
<p>by default 11 for 2D and 5 for 3D images,
but can be specified as a
vector if the window sizes differ by dimension.
The vector must have the same number of
dimensions as the inputted <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="catmssim_3d_slice_+3A_method">method</code></td>
<td>
<p>whether to use Cohen's kappa (<code>Cohen</code>),
Jaccard Index (<code>Jaccard</code>), Dice index (<code>Dice</code>),
accuracy (<code>accuracy</code>),  Rand index (<code>Rand</code>),
Adjusted Rand Index (<code>AdjRand</code> or <code>ARI</code>), normalized mutual
information (<code>NMI</code> or <code>MI</code>) or the adjusted mutual
information, <code>AMI</code> and <code>ami</code>, as
the similarity index. Note Jaccard and Dice should only be used on
binary data.</p>
</td></tr>
<tr><td><code id="catmssim_3d_slice_+3A_...">...</code></td>
<td>
<p>additional constants can be passed to internal functions.</p>
</td></tr>
<tr><td><code id="catmssim_3d_slice_+3A_random">random</code></td>
<td>
<p>whether to have deterministic PRNG (<code>pseudo</code>)
or to use <code><a href="base.html#topic+sample">sample()</a></code> (<code>random</code>). If <code>NULL</code>,
will choose the first mode. For complete reproducibility,
use <code>pseudo</code> or <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a value less than 1 indicating the similarity between the images.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20181207)
dim &lt;- 8
x &lt;- array(sample(0:4, dim^5, replace = TRUE), dim = c(dim^2, dim^2, dim))
y &lt;- x
for (j in 1:(dim)) {
  for (i in 1:(dim^2)) y[i, i, j] &lt;- 0
  for (i in 1:(dim^2 - 1)) y[i, i + 1, j] &lt;- 0
}
catmssim_3d_slice(x, y, weights = c(.75, .25)) # by default method = "Cohen"
# compare to some simple metric:
mean(x == y)
</code></pre>

<hr>
<h2 id='catsim'>Multiscale Categorical Structural Similarity Index Measure</h2><span id='topic+catsim'></span>

<h3>Description</h3>

<p>The categorical structural similarity index measure for 2D or 3D categorical or
binary images for multiple scales. The default is to compute over 5 scales.
This determines whether this is a 2D or 3D image and applies the appropriate
windowing, weighting, and scaling. Additional arguments can be passed.
This is a wrapper function for the 2D and 3D functions whose functionality
can be accessed through the ... arguments. This function is a wrapper for the
<code><a href="#topic+catmssim_2d">catmssim_2d()</a></code>, <code><a href="#topic+catmssim_3d_slice">catmssim_3d_slice()</a></code>, and
<code><a href="#topic+catmssim_3d_cube">catmssim_3d_cube()</a></code>
functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catsim(
  x,
  y,
  ...,
  cube = TRUE,
  levels = NULL,
  weights = NULL,
  method = "Cohen",
  window = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="catsim_+3A_x">x</code>, <code id="catsim_+3A_y">y</code></td>
<td>
<p>a binary or categorical image</p>
</td></tr>
<tr><td><code id="catsim_+3A_...">...</code></td>
<td>
<p>additional arguments, such as window, can be passed
as well as arguments for internal functions.</p>
</td></tr>
<tr><td><code id="catsim_+3A_cube">cube</code></td>
<td>
<p>for the 3D method, whether to use the true 3D method
(cube or <code><a href="#topic+catmssim_3d_cube">catmssim_3d_cube()</a></code>)
or compute the metric using 2D slices which are then averaged
(<code><a href="#topic+catmssim_3d_slice">catmssim_3d_slice()</a></code>). By default, <code>TRUE</code>,
which evaluates as a cube. <code>FALSE</code> will treat it as
2D slices.</p>
</td></tr>
<tr><td><code id="catsim_+3A_levels">levels</code></td>
<td>
<p>how many levels of downsampling to use. By default, 5. If
<code>weights</code> is specified and this is left blank, the argument
will be inferred from the number of weights specified.</p>
</td></tr>
<tr><td><code id="catsim_+3A_weights">weights</code></td>
<td>
<p>a vector of weights for the different scales. By default,
equal to <code>rep(1,levels)/levels</code>. If specified, there must
at least as many  weights as there are levels and the first
<code>levels</code> weights will be used.</p>
</td></tr>
<tr><td><code id="catsim_+3A_method">method</code></td>
<td>
<p>whether to use Cohen's kappa (<code>Cohen</code>),
Jaccard Index (<code>Jaccard</code>), Dice index (<code>Dice</code>),
accuracy (<code>accuracy</code>),  Rand index (<code>Rand</code>),
Adjusted Rand Index (<code>AdjRand</code> or <code>ARI</code>), normalized mutual
information (<code>NMI</code> or <code>MI</code>), or adjusted mutual information
(<code>AMI</code>) as the similarity index.
Note Jaccard and Dice should only be used on binary data.</p>
</td></tr>
<tr><td><code id="catsim_+3A_window">window</code></td>
<td>
<p>by default 11 for 2D and 5 for 3D images, but can be
specified as a vector if the window sizes differ by dimension.
The vector must have the same number of
dimensions as the inputted <code>x</code> and <code>y</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a value less than 1 indicating the similarity between the images.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20181207)
dim &lt;- 16
x &lt;- array(sample(0:4, dim^3, replace = TRUE), dim = c(dim, dim, dim))
y &lt;- x
for (j in 1:dim) {
  for (i in 1:dim) y[i, i, j] &lt;- 0
  for (i in 1:(dim - 1)) y[i, i + 1, j] &lt;- 0
}
catsim(x, y, weights = c(.75, .25))
# Now using a different similarity score
catsim(x, y, levels = 2, method = "accuracy")
# with the slice method:
catsim(x, y, weights = c(.75, .25), cube = FALSE, window = 8)
</code></pre>

<hr>
<h2 id='gini'>Diversity Indices</h2><span id='topic+gini'></span><span id='topic+Corrected+20Gini-Simpson+20index'></span><span id='topic+ginicorr'></span><span id='topic+Modified+20Gini-Simpson+20index'></span><span id='topic+sqrtgini'></span><span id='topic+Modified+20Corrected+20Gini+20index'></span><span id='topic+sqrtginicorr'></span>

<h3>Description</h3>

<p><code>gini()</code> is a measure of diversity that goes by a
number of different names, such as the probability of interspecific encounter
or the Gibbs-Martin index. It is <code class="reqn">1 - sum(p_i^2)</code>, where <code class="reqn">p_i</code> is the
probability of observing class i.
</p>
<p>The corrected Gini-Simpson index, <code>ginicorr</code> takes the
index and  corrects it so that the maximum possible is 1. If there are
<code>k</code> categories, the maximum possible of the uncorrected index is
<code class="reqn">1-1/k</code>. It corrects the index by dividing by the maximum.
<code>k</code> must be specified.
</p>
<p>The modified Gini-Simpson index is similar to the unmodified,
except it uses the square root of the summed squared
probabilities, that is, <code class="reqn">1 - \sqrt{ sum(p_i^2)}</code>, where <code class="reqn">p_i</code> is the
probability of observing class i.
</p>
<p>The modified corrected Gini index then
corrects the modified index for the number of categories, <code>k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gini(x)

ginicorr(x, k)

sqrtgini(x)

sqrtginicorr(x, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gini_+3A_x">x</code></td>
<td>
<p>binary or categorical image or vector</p>
</td></tr>
<tr><td><code id="gini_+3A_k">k</code></td>
<td>
<p>number of categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The index (between 0 and 1), with 0 indicating no variation and 1
being maximal. The Gini index is bounded above by <code class="reqn">1-1/k</code> for a group
with <code>k</code> categories. The modified index is bounded above by
<code class="reqn">1-1/\sqrt{k}</code>.  The corrected indices fix this by dividing by the
maximum.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rep(c(1:4), 5)
gini(x)

x &lt;- rep(c(1:4), 5)
ginicorr(x, 4)

x &lt;- rep(c(1:4), 5)
sqrtgini(x)

x &lt;- rep(c(1:4), 5)
sqrtginicorr(x, 4)
</code></pre>

<hr>
<h2 id='hoffmanphantom'>An example fMRI phantom</h2><span id='topic+hoffmanphantom'></span>

<h3>Description</h3>

<p>A <code class="reqn">128 \times 128</code> activation map for a slice of an fMRI
phantom and an anatomical reference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hoffmanphantom)
</code></pre>


<h3>Format</h3>

<p>a <code class="reqn">128 \times 128 \times 2</code> array with the
first slice an activation map for an MRI phantom and the second an
anatomical overlay. <code>NA</code> values are outside the surface. The
activation map (<code>hoffmanphantom[,,1]</code>) is 1 if activated,
0 otherwise. The second layer  (<code>hoffmanphantom[,,2]</code>)
indicates the anatomical structure. Approximately 3.8 percent of the
pixels are activated in this slice.
</p>


<h3>References</h3>

<p>E. Hoffman, P. Cutler, W. Digby, and J. Mazziotta, “3-D phantom
to simulate cerebral blood flow and metabolic images for PET,”
Nuclear Science, IEEE Transactions on, vol. 37, pp. 616 – 620, 05
1990.
</p>
<p>I. A. Almodóvar-Rivera and R. Maitra, “FAST adaptive smoothed
thresholding for improved activation detection in low-signal
fMRI,” IEEE Transactions on Medical Imaging, vol. 38, no. 12, pp.
2821–2828, 2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>image(hoffmanphantom[, , 2], col = rev(gray(0:15 / 16))[1:4], axes = FALSE)
image(hoffmanphantom[, , 1],
  add = TRUE, zlim = c(0.01, 1),
  col = c("yellow", "maroon")
)
</code></pre>

<hr>
<h2 id='rand'>Similarity Indices</h2><span id='topic+rand'></span><span id='topic+rand_index'></span><span id='topic+Adjusted+20Rand+20Index'></span><span id='topic+adj_rand'></span><span id='topic+Cohen+27s+20kappa'></span><span id='topic+cohen_kappa'></span><span id='topic+Normalized+20Mutual+20Information'></span><span id='topic+normalized_mi'></span><span id='topic+Adjusted+20Mutual+20Information'></span><span id='topic+adjusted_mi'></span>

<h3>Description</h3>

<p>The Rand index, <a href="#topic+rand_index">rand_index</a>, computes the agreement
between two different clusterings or partitions of the same  set of objects.
The inputs to the function should be binary or categorical and of the same
length.
</p>
<p>The adjusted Rand index,  <code>adj_rand</code>,
computes a corrected version
of the Rand index, adjusting for the probability
of chance agreement of clusterings. A small constant is added to the
numerator and denominator of the adjusted Rand index to ensure stability
when there is a small or 0 denominator, as it is possible to have a zero
denominator.
</p>
<p>Cohen's kappa, <code>cohen_kappa</code>,
is an inter-rater agreement metric for two raters which
corrects for the probability of chance agreement. Note
there is a difference here
between this measure and the Rand indices and mutual information:
those consider the similarities of the groupings of points,
while this considers how often the
raters agreed on individual points.
</p>
<p>Like the Rand index, the mutual information
computes the agreement between two different clusterings or
partitions of the same set of objects. If <code class="reqn">H(X)</code> is the
entropy of some probability distribution <code class="reqn">X</code>, then
the mutual information of two distributions is
<code class="reqn">I(X;Y) = -H(X,Y) +H(X) + H(Y)</code>.
The normalized mutual information, <code>normalized_mi</code>, is defined here as:
<code class="reqn">2I(X;Y)/(H(X)+H(Y)),</code> but is set to be 0 if both H(X) and H(Y) are 0.
</p>
<p>The adjusted mutual information, <code>adjusted_mi</code>,
is a correction of the mutual information to account
for the probability of chance agreement in a manner similar to the
adjusted Rand index
or Cohen's kappa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand_index(x, y, na.rm = FALSE)

adj_rand(x, y, na.rm = FALSE)

cohen_kappa(x, y, na.rm = FALSE)

normalized_mi(x, y, na.rm = FALSE)

adjusted_mi(x, y, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rand_+3A_x">x</code>, <code id="rand_+3A_y">y</code></td>
<td>
<p>a numeric or factor vector or array</p>
</td></tr>
<tr><td><code id="rand_+3A_na.rm">na.rm</code></td>
<td>
<p>whether to remove <code>NA</code> values. By default, <code>FALSE</code>.
If <code>TRUE</code>, will perform pair-wise deletion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the similarity index, which is between 0 and 1 for most of the
options. The adjusted Rand and Cohen's kappa can be negative, but are
bounded above by 1.
</p>


<h3>References</h3>

<p>W. M. Rand (1971). &quot;Objective criteria for the evaluation of clustering
methods&quot;. Journal of the American Statistical Association.
American Statistical Association. 66 (336): 846–850.
<a href="https://doi.org/10.2307/2284239">doi:10.2307/2284239</a>
</p>
<p>Lawrence Hubert and Phipps Arabie (1985).
&quot;Comparing partitions&quot;. Journal of Classification. 2 (1): 193–218.
<a href="https://doi.org/10.1007/BF01908075">doi:10.1007/BF01908075</a>
</p>
<p>Cohen, Jacob (1960). &quot;A coefficient of agreement for nominal scales&quot;.
Educational and Psychological Measurement. 20 (1): 37–46.
<a href="https://doi.org/10.1177/001316446002000104">doi:10.1177/001316446002000104</a>
</p>
<p>Jaccard, Paul (1912). &quot;The distribution of the flora in the alpine zone,”
New Phytologist, vol. 11, no. 2, pp. 37–50.
<a href="https://doi.org/10.1111/j.1469-8137.1912.tb05611.x">doi:10.1111/j.1469-8137.1912.tb05611.x</a>
</p>
<p>Nguyen Xuan Vinh, Julien Epps, and James Bailey (2010).
Information Theoretic Measures for Clusterings Comparison:
Variants, Properties, Normalization and Correction for Chance.
J. Mach. Learn. Res. 11 (December 2010), 2837–2854.
<a href="https://jmlr.org/papers/v11/vinh10a.html">https://jmlr.org/papers/v11/vinh10a.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rep(0:5, 5)
y &lt;- c(rep(0:5, 4), rep(0, 6))
# Simple Matching, or Accuracy
mean(x == y)
# Hamming distance
sum(x != y)
rand_index(x, y)
adj_rand(x, y)
cohen_kappa(x, y)
normalized_mi(x, y)
adjusted_mi(x, y)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
