<!DOCTYPE html><html><head><title>Help for package flood</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {flood}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confInt_sTL'><p>Estimated confidence intervals using sTL</p></a></li>
<li><a href='#confInt_TL'><p>Estimated confidence intervals using TL</p></a></li>
<li><a href='#confInt_W'><p>Estimated confidence intervals using W</p></a></li>
<li><a href='#dGEVxGEV'><p>Two-component generalized extreme value distribution (GEV)</p></a></li>
<li><a href='#hill'><p>Hill's estimator</p></a></li>
<li><a href='#qBM'><p>Block maxima distribution</p></a></li>
<li><a href='#RegioGEV'><p>Regional (or local) parameter and quantile estimation</p></a></li>
<li><a href='#RegioGEVSeas'><p>Seasonal regional (or local) parameter and quantile estimation</p></a></li>
<li><a href='#RegioHill'><p>Regional EVI estimator</p></a></li>
<li><a href='#RegioWeissman'><p>Quantile estimation: Weissman's extrapolation</p></a></li>
<li><a href='#RegioWeissmanSeas'><p>Quantile estimation: Weissman's extrapolation for seasonal data</p></a></li>
<li><a href='#seas2ann'><p>Annual maxima from seasonal maxima</p></a></li>
<li><a href='#TailAnova'><p>Heavy-tail ANOVA</p></a></li>
<li><a href='#xiAnova'><p>Homogeneity test for the shape</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Methods for the (Regional) Analysis of Flood
Frequency</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Includes several statistical methods for the estimation of parameters and high quantiles of river flow distributions. The focus is on regional estimation based on homogeneity assumptions and computed from multivariate observations (multiple measurement stations).
	For details see Kinsvater et al. (2017) &lt;<a href="https://doi.org/10.48550/arXiv.1701.06455">doi:10.48550/arXiv.1701.06455</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>evd, TLMoments, magrittr, copula</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-01-30 13:41:31 UTC; ligges</td>
</tr>
<tr>
<td>Author:</td>
<td>Friederike Deiters [aut, cre],
  Paul Kinsvater [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Friederike Deiters &lt;deiters@statistik.tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-01-30 14:50:01</td>
</tr>
</table>
<hr>
<h2 id='confInt_sTL'>Estimated confidence intervals using sTL</h2><span id='topic+confInt_sTL'></span>

<h3>Description</h3>

<p>Estimated regional (or local) (1-alpha)-confidence intervals for an estimated
quantile by using seasonal TL(0,1)-moments (sTL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confInt_sTL(x1, x2, p, j = 1, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confInt_sTL_+3A_x1">x1</code></td>
<td>
<p>vector or matrix of observations from season 1 (rows: observations, columns: stations).</p>
</td></tr>
<tr><td><code id="confInt_sTL_+3A_x2">x2</code></td>
<td>
<p>vector or matrix of observations from season 2 (rows: observations, columns: stations).</p>
</td></tr>
<tr><td><code id="confInt_sTL_+3A_p">p</code></td>
<td>
<p>a probability.</p>
</td></tr>
<tr><td><code id="confInt_sTL_+3A_j">j</code></td>
<td>
<p>quantile and parameter estimation for the jth station (jth column of <code>x</code>).
Irrelevant if is <code>x1</code> and <code>x2</code> are vectors.</p>
</td></tr>
<tr><td><code id="confInt_sTL_+3A_alpha">alpha</code></td>
<td>
<p>confidence level for confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of </p>

<ul>
<li> <p><code>ci</code> confidence interval.
</p>
</li>
<li> <p><code>quant</code> estimated quantile from a two-component GEV using trimmed L-moments (leftrim=0, rightrim=1).
</p>
</li>
<li> <p><code>var</code> variance of the estimated quantile.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
# Seasonal observations of 80 years at one station:
x1 &lt;- rgev(80, 2, 1, 0.2) # observations from season 1
x2 &lt;- rgev(80, 3, 1, 0.3) # observations from season 2
confInt_sTL(x1=x1, x2=x2, p=0.95, alpha=0.05)

# Seasonal observations of 100 years at 4 stations:
x1 &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4)
x2 &lt;- matrix(rgev(400, 4, 1, 0.2), ncol=4)
confInt_sTL(x1=x1, x2=x2, j=2, p=0.95, alpha=0.05)
</code></pre>

<hr>
<h2 id='confInt_TL'>Estimated confidence intervals using TL</h2><span id='topic+confInt_TL'></span>

<h3>Description</h3>

<p>Estimated regional (or local) (1-alpha)-confidence intervals for an estimated
quantile by using annual TL(0,1)-moments (TL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confInt_TL(x, p, j = 1, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confInt_TL_+3A_x">x</code></td>
<td>
<p>vector or matrix of annual observations.</p>
</td></tr>
<tr><td><code id="confInt_TL_+3A_p">p</code></td>
<td>
<p>a probability.</p>
</td></tr>
<tr><td><code id="confInt_TL_+3A_j">j</code></td>
<td>
<p>quantile and parameter estimation for the jth station (jth column of <code>x</code>).
Irrelevant if is <code>x</code> is a vector.</p>
</td></tr>
<tr><td><code id="confInt_TL_+3A_alpha">alpha</code></td>
<td>
<p>confidence level for confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of </p>

<ul>
<li> <p><code>ci</code> confidence interval.
</p>
</li>
<li> <p><code>quant</code> estimated quantile from a GEV using trimmed L-moments (<code class="reqn">leftrim=0, rightrim=1</code>).</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
# Seasonal observations of 80 years at one station:
x1 &lt;- rgev(80, 2, 1, 0.2) # observations from season 1
x2 &lt;- rgev(80, 3, 1, 0.3) # observations from season 2
x &lt;- seas2ann(x1, x2) # calculaes annual maxima of the two seasons
confInt_TL(x=x, p=0.95, alpha=0.05)

# Seasonal observations of 100 years at 4 stations:
x1 &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4) # observations from season 1
x2 &lt;- matrix(rgev(400, 2, 1, 0.2), ncol=4) # observations from season 2
x &lt;- seas2ann(x1, x2) # calculaes annual maxima of the two seasons
confInt_TL(x=x, j=2, p=0.95, alpha=0.05)
</code></pre>

<hr>
<h2 id='confInt_W'>Estimated confidence intervals using W</h2><span id='topic+confInt_W'></span>

<h3>Description</h3>

<p>Estimated regional (or local) (1-alpha)-confidence intervals for an estimated
quantile by using the annual Weissman estimator (W).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confInt_W(x, p, j = 1, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confInt_W_+3A_x">x</code></td>
<td>
<p>vector or matrix of annual observations.</p>
</td></tr>
<tr><td><code id="confInt_W_+3A_p">p</code></td>
<td>
<p>a probability. Should be between <code class="reqn">1-k_j/n_j</code> and 1, where <code class="reqn">n_j</code> is the
sample length of the <code>j</code>-th column.</p>
</td></tr>
<tr><td><code id="confInt_W_+3A_j">j</code></td>
<td>
<p>quantile and parameter estimation for the jth station (jth column of <code>x</code>).
Irrelevant if is <code>x1</code> and <code>x2</code> are vectors.</p>
</td></tr>
<tr><td><code id="confInt_W_+3A_alpha">alpha</code></td>
<td>
<p>confidence level for confidence interval.</p>
</td></tr>
<tr><td><code id="confInt_W_+3A_...">...</code></td>
<td>
<p>additional arguments, see <a href="#topic+RegioWeissman">RegioWeissman</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of </p>

<ul>
<li> <p><code>ci</code> confidence interval.
</p>
</li>
<li> <p><code>quant</code> estimated quantile using Weissman's estimator.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
# Seasonal observations of 80 years at one station:
x1 &lt;- rgev(80, 2, 1, 0.2) # observations from season 1
x2 &lt;- rgev(80, 3, 1, 0.3) # observations from season 2
x &lt;- seas2ann(x1, x2) # calculaes annual maxima of the two seasons
confInt_W(x=x, p=0.95, alpha=0.05)

# Seasonal observations of 100 years at 4 stations:
x1 &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4) # observations from season 1
x2 &lt;- matrix(rgev(400, 2, 1, 0.2), ncol=4) # observations from season 2
x &lt;- seas2ann(x1, x2) # calculaes annual maxima of the two seasons
confInt_W(x=x, j=2, p=0.95, alpha=0.05)
</code></pre>

<hr>
<h2 id='dGEVxGEV'>Two-component generalized extreme value distribution (GEV)</h2><span id='topic+dGEVxGEV'></span><span id='topic+pGEVxGEV'></span><span id='topic+qGEVxGEV'></span><span id='topic+rGEVxGEV'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and
random generation for a two-component GEV distribution (product of two GEVs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dGEVxGEV(x, param1, param2)

pGEVxGEV(q, param1, param2)

qGEVxGEV(p, param1, param2)

rGEVxGEV(n, param1, param2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dGEVxGEV_+3A_x">x</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dGEVxGEV_+3A_param1">param1</code></td>
<td>
<p>three-dimensional vector (loc, scale, shape)' of a GEV from season 1.</p>
</td></tr>
<tr><td><code id="dGEVxGEV_+3A_param2">param2</code></td>
<td>
<p>three-dimensional vector (loc, scale, shape)' of a GEV from season 2.</p>
</td></tr>
<tr><td><code id="dGEVxGEV_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dGEVxGEV_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="dGEVxGEV_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions use the parametrization of the <a href="evd.html#topic+gev">gev</a>-functions from the package 'evd'.
The distribution <code class="reqn">F</code> of a two-component GEV is:
<code class="reqn">F=F_1 \cdot F_2</code>, where <code class="reqn">F_1</code> and <code class="reqn">F_2</code> are two
distribution functions of a GEV.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># density and distribution function of a two-component GEV:
par(mfrow=c(3,1))
curve(dGEVxGEV(x, c(2,1,0.2), c(3,2,0.4)), from=0, to=20, ylab="Density", n=1000)
curve(pGEVxGEV(x, c(2,1,0.2), c(3,2,0.4)), from=0, to=20, ylab="Probability", n=1000)

# quantiles of a two-component GEV:
qGEVxGEV(p=c(0.9, 0.99), c(2,1,0.2), c(3,2,0.4))

# random numbers of a two-component GEV:
set.seed(23764)
rn &lt;- rGEVxGEV(1000, c(2,1,0.1), c(3,2,0))
hist(rn, breaks=40, freq=FALSE, main="")
curve(dGEVxGEV(x, c(2,1,0.1), c(3,2,0)), from=0, to=20,
ylab="density", n=1000, col="red", add=TRUE)
</code></pre>

<hr>
<h2 id='hill'>Hill's estimator</h2><span id='topic+hill'></span>

<h3>Description</h3>

<p>Estimation of heavy tails with Hill's estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hill(x, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hill_+3A_x">x</code></td>
<td>
<p>Vector or matrix of observations</p>
</td></tr>
<tr><td><code id="hill_+3A_k">k</code></td>
<td>
<p>Number of relative excesses involved in the estimation of the extreme value
index gamma. If <code>k</code> is missing, it will be set to </p>

<ul>
<li> <p><code class="reqn">k=\left\lfloor 2n^{2/3}\right\rfloor</code>, where n is the
sample length of the vector <code>x</code> after removing missing values
</p>
</li>
<li> <p><code class="reqn">k=\left\lfloor \frac{2n^{2/3}}{d^{1/3}}\right\rfloor</code>, where d is the number of
columns of the matrix <code>x</code> and n the length of each column after removing missing values.</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Hill's estimator for each sample.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
x1 &lt;- rgev(100, loc = 2, scale = 1, shape=0.4)
hill(x1, k=20)
x2 &lt;- rgev(100, loc = 2, scale = 1, shape=0.5)
hill(cbind(x1, x2), k = c(20, 25))
x2[c(4,8,39)] &lt;- NA
hill(cbind(x1, x2), k=c(20, 25))
# if leaving out k, it will be set to floor(2*n^(2/3)/d^(1/3)) = c(34,33):
hill(cbind(x1, x2)) # is the same as:
hill(cbind(x1, x2), k=c(34,33))
</code></pre>

<hr>
<h2 id='qBM'>Block maxima distribution</h2><span id='topic+qBM'></span>

<h3>Description</h3>

<p>Calculates quantiles of a block maxima distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qBM(p, b, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qBM_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="qBM_+3A_b">b</code></td>
<td>
<p>block length (in general <code>b</code> <code class="reqn">\ge 2</code>).</p>
</td></tr>
<tr><td><code id="qBM_+3A_param">param</code></td>
<td>
<p>three-dimensional vector with location (mu), scale (sigma)
and shape (xi) parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Formular of a block maxima distribution function:
</p>
<p style="text-align: center;"><code class="reqn">F_j(x)=F_j^{(b)}(x)=\left[2\cdot T_{1/\xi}\left(\left\{1+\xi\frac{x-\mu_j}{\sigma_j}\right\}\cdot T_{1/\xi}^{-1}\left(1-\frac{1}{2b}\right)\right)-1\right]^b,</code>
</p>

<p>where <code class="reqn">T_{\nu}</code> denote the t-distribution function with <code class="reqn">\nu</code> degrees of freedom.
</p>


<h3>Value</h3>

<p>Quantile of a block maxima distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>qBM(p=c(0.75, 0.99), b=12, param=c(2,1,0.2))
</code></pre>

<hr>
<h2 id='RegioGEV'>Regional (or local) parameter and quantile estimation</h2><span id='topic+RegioGEV'></span>

<h3>Description</h3>

<p>Calculates regional (or local) parameters of a generalized extreme value (GEV) distribution
using (trimmed) L-moments
(see <a href="TLMoments.html#topic+TLMoments">TLMoments</a> and <a href="TLMoments.html#topic+parameters">parameters</a>) from a vector or matrix of observation.
Based on these parameters, a p-quantile of the GEV will be calculated for the jth station.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RegioGEV(x, p, j = 1, leftrim = 0, rightrim = 0, na.rm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RegioGEV_+3A_x">x</code></td>
<td>
<p>vector or matrix of observations (rows: observations, d columns: stations).</p>
</td></tr>
<tr><td><code id="RegioGEV_+3A_p">p</code></td>
<td>
<p>a probability.</p>
</td></tr>
<tr><td><code id="RegioGEV_+3A_j">j</code></td>
<td>
<p>quantile and parameter estimation for the jth
station (jth column of <code>x</code>). Irrelevant if is <code>x</code> is a vector.</p>
</td></tr>
<tr><td><code id="RegioGEV_+3A_leftrim">leftrim</code></td>
<td>
<p>integer indicating lower trimming parameter (<code class="reqn">\ge 0</code>).</p>
</td></tr>
<tr><td><code id="RegioGEV_+3A_rightrim">rightrim</code></td>
<td>
<p>integer indicating upper trimming parameter (<code class="reqn">\ge 0</code>).</p>
</td></tr>
<tr><td><code id="RegioGEV_+3A_na.rm">na.rm</code></td>
<td>
<p>Should missing values be removed?</p>
</td></tr>
<tr><td><code id="RegioGEV_+3A_...">...</code></td>
<td>
<p>additional arguments, see <a href="TLMoments.html#topic+TLMoments">TLMoments</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optimal weights will be calculated as described in &quot;Kinsvater, Fried and Lilienthal (2015):
Regional extreme value index estimation and a test of tail homogeneity,
Environmetrics, DOI: 10.1002/env.2376, Section 3.2&quot;. If it's not possible to calculate
optimal weights (negative eigenvaules of an estimated covarinace matrix), simple weights
will be calculated: <code class="reqn">w_j=\frac{n_j}{sum_{j=1}^d n_j}</code>
</p>


<h3>Value</h3>

<p>List of </p>

<ul>
<li> <p><code>quant</code> quantile calculation from an estimated GEV with a regional shape-parameter.
</p>
</li>
<li> <p><code>param</code> estimated parameter vector from a GEV (using L-moments or trimmed L-moments).
</p>
</li>
<li> <p><code>w</code> optimal or simple weighting (just returned if <code>x</code> is a matrix).</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
# sample observations of 75 years at one station:
x &lt;- rgev(75) # x is a vector
RegioGEV(x=x, p=0.95)

x2 &lt;- c(NA, NA, x[1:60], NA, x[61:75]) # vector of observations with missing values
RegioGEV(x=x2, p=0.95) # NAs will be removed

# sample observations of 100 years at 4 stations:
set.seed(1053)
x &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4)
RegioGEV(x=x, p=0.9, j=3, leftrim=0, rightrim=0) # optimal weighting
RegioGEV(x=x, p=0.9, j=3, leftrim=0, rightrim=1) # optimal weighting

# With missing values:
x2 &lt;- x
x2[c(54, 89, 300)] &lt;- NA
RegioGEV(x=x2, p=0.9, j=3, leftrim=0, rightrim=0)

# sample again observations of 100 years at 4 stations:
set.seed(958)
x &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4)
RegioGEV(x=x, p=0.9, j=3, leftrim=0, rightrim=0) # simple weighting
</code></pre>

<hr>
<h2 id='RegioGEVSeas'>Seasonal regional (or local) parameter and quantile estimation</h2><span id='topic+RegioGEVSeas'></span>

<h3>Description</h3>

<p>Calculates regional (or local) parameters of a two-component GEV distribution (product of two GEVs)
using (trimmed) L-moments (see <a href="TLMoments.html#topic+TLMoments">TLMoments</a> and <a href="TLMoments.html#topic+parameters">parameters</a>)
from two vectors or two matrices of observation, e.g. winter and summer observations
from one or more than one station.
Based on these two parameter vectors, a p-quantile of the two-component GEV will
be calculated for the jth station.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RegioGEVSeas(x1, x2, p, j = 1, leftrim = 0, rightrim = 0, na.rm = TRUE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RegioGEVSeas_+3A_x1">x1</code></td>
<td>
<p>vector or matrix of observations from season 1 (rows: observations, columns: stations).</p>
</td></tr>
<tr><td><code id="RegioGEVSeas_+3A_x2">x2</code></td>
<td>
<p>vector or matrix of observations from season 2 (rows: observations, columns: stations).</p>
</td></tr>
<tr><td><code id="RegioGEVSeas_+3A_p">p</code></td>
<td>
<p>a probability.</p>
</td></tr>
<tr><td><code id="RegioGEVSeas_+3A_j">j</code></td>
<td>
<p>quantile and parameter estimation for the jth station (jth column of <code>x</code>).
Irrelevant if is <code>x1</code> and <code>x2</code> are vectors.</p>
</td></tr>
<tr><td><code id="RegioGEVSeas_+3A_leftrim">leftrim</code></td>
<td>
<p>integer indicating lower trimming parameter (<code class="reqn">\ge 0</code>).</p>
</td></tr>
<tr><td><code id="RegioGEVSeas_+3A_rightrim">rightrim</code></td>
<td>
<p>integer indicating upper trimming parameter (<code class="reqn">\ge 0</code>).</p>
</td></tr>
<tr><td><code id="RegioGEVSeas_+3A_na.rm">na.rm</code></td>
<td>
<p>Should missing values be removed?</p>
</td></tr>
<tr><td><code id="RegioGEVSeas_+3A_...">...</code></td>
<td>
<p>additional arguments, see <a href="TLMoments.html#topic+TLMoments">TLMoments</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of </p>

<ul>
<li> <p><code>quant</code> quantile calculation from an estimated two-component GEV with a
regional (or local) shape-parameters.
</p>
</li>
<li> <p><code>param1</code> estimated parameter vector from season 1 from a GEV (using L-moments or trimmed L-moments).
</p>
</li>
<li> <p><code>param2</code> estimated parameter vector from season 2 from a GEV (using L-moments or trimmed L-moments).</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
# Seasonal observations of 80 years at one station:
x1 &lt;- rgev(80, 2, 1, 0.2) # observations from season 1
x2 &lt;- rgev(80, 3, 1, 0.3) # observations from season 2
RegioGEVSeas(x1=x1, x2=x2, p=0.95)

# Missing values in both seasons in the same year(s):
x1a &lt;- c(NA, x1, NA)
x2a &lt;- c(NA, x2, NA)
RegioGEVSeas(x1a, x2a, p=0.99, leftrim=0, rightrim=0, na.rm=TRUE)

# Missing values in both seasons in different year(s):
x1b &lt;- x1
x1b[c(4,19)] &lt;- NA
x2b &lt;- x2
x2b[77] &lt;- NA
RegioGEVSeas(x1b, x2b, p=0.99, leftrim=0, rightrim=0, na.rm=TRUE)

# Seasonal observations of 100 years at 4 stations:
x1 &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4)
x2 &lt;- matrix(rgev(400, 4, 1, 0.2), ncol=4)
# estimate quantile for station 1 and 2 (consider the same shape-parameters):
RegioGEVSeas(x1, x2, p=0.99, j=1, leftrim=0, rightrim=0)
RegioGEVSeas(x1, x2, p=0.99, j=2, leftrim=0, rightrim=0)

# With missing values:
x3 &lt;- x1
x4 &lt;- x2
x3[c(54, 89, 300)] &lt;- NA
RegioGEVSeas(x3, x4, p=0.99, j=1, leftrim=0, rightrim=0)
</code></pre>

<hr>
<h2 id='RegioHill'>Regional EVI estimator</h2><span id='topic+RegioHill'></span>

<h3>Description</h3>

<p>Estimation of the positive extreme value index (EVI) based on multiple local Hill estimators. We assume heavy-tail homogeneity, i.e., all local EVI's are the same.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RegioHill(x, k, k.qu = 20, type = "evopt", alpha = 0.05, ci = "nonlog")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RegioHill_+3A_x">x</code></td>
<td>
<p>Vector or matrix of observations</p>
</td></tr>
<tr><td><code id="RegioHill_+3A_k">k</code></td>
<td>
<p>Number of relative excesses involved in the estimation of the extreme value
index gamma. If <code>k</code> is missing, it will be set to </p>

<ul>
<li> <p><code class="reqn">k=\left\lfloor 2n^{2/3}\right\rfloor</code>, where n is the
sample length of the vector <code>x</code> after removing missing values
</p>
</li>
<li> <p><code class="reqn">k=\left\lfloor \frac{2n^{2/3}}{d^{1/3}}\right\rfloor</code>, where d is the number of
columns of the matrix <code>x</code> and n the length of each column after removing missing values.</p>
</li></ul>
</td></tr>
<tr><td><code id="RegioHill_+3A_k.qu">k.qu</code></td>
<td>
<p>Tuning parameter for estimation of empirical variance; only needed if <code>type="opt"</code>.</p>
</td></tr>
<tr><td><code id="RegioHill_+3A_type">type</code></td>
<td>
<p>Choose either <code>"evopt"</code> if extreme value dependent, <code>"ind"</code> if independent or <code>"opt"</code> for arbitrarily dependent components.</p>
</td></tr>
<tr><td><code id="RegioHill_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level for confidence interval.</p>
</td></tr>
<tr><td><code id="RegioHill_+3A_ci">ci</code></td>
<td>
<p>Either <code>"nonlog"</code> for standart or <code>"log"</code> for non-standart confidence interval based on log-transformed hill estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of </p>

<ul>
<li> <p><code>est</code> a weighted average of local Hill estimates.
</p>
</li>
<li> <p><code>Sigma</code> an estimate of the corresponding variance matrix.
</p>
</li>
<li> <p><code>CI</code> a confidence interval.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
x1 &lt;- rgev(150, loc = 2, scale = 1, shape=0.4)
hill(x1, k=20)
x2 &lt;- rgev(100, loc = 2.5, scale = 1, shape=0.4)
x2 &lt;- c(x2, rep(NA, 50))
x &lt;- cbind(x1, x2)
k &lt;- c(40, 30)
RegioHill(x, k)
</code></pre>

<hr>
<h2 id='RegioWeissman'>Quantile estimation: Weissman's extrapolation</h2><span id='topic+RegioWeissman'></span>

<h3>Description</h3>

<p>Estimation of the p-quantile based on multiple local Hill estimators and Weissman's extrapolation formula. We assume heavy-tail homogeneity, i.e., all local EVI's are the same.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RegioWeissman(x, j = 1, p, k, k.qu = 20, type = "evopt", alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RegioWeissman_+3A_x">x</code></td>
<td>
<p>Vector or matrix of observations</p>
</td></tr>
<tr><td><code id="RegioWeissman_+3A_j">j</code></td>
<td>
<p>The number of the target site, i.e., if <code>j=2</code> the p-quantile of the second column of <code>x</code> is estimated.</p>
</td></tr>
<tr><td><code id="RegioWeissman_+3A_p">p</code></td>
<td>
<p>The probability of interest; should be between <code class="reqn">1-k_j/n_j</code> and 1, where <code class="reqn">n_j</code> is the sample length of the j-th column.</p>
</td></tr>
<tr><td><code id="RegioWeissman_+3A_k">k</code></td>
<td>
<p>Number of relative excesses involved in the estimation of the extreme value
index gamma. If <code>k</code> is missing, it will be set to </p>

<ul>
<li> <p><code class="reqn">k=\left\lfloor 2n^{2/3}\right\rfloor</code>, where n is the
sample length of the vector <code>x</code> after removing missing values
</p>
</li>
<li> <p><code class="reqn">k=\left\lfloor \frac{2n^{2/3}}{d^{1/3}}\right\rfloor</code>, where d is the number of
columns of the matrix <code>x</code> and n the length of each column after removing missing values.</p>
</li></ul>
</td></tr>
<tr><td><code id="RegioWeissman_+3A_k.qu">k.qu</code></td>
<td>
<p>Tuning parameter for estimation of empirical variance; only needed if <code>type="opt"</code>.</p>
</td></tr>
<tr><td><code id="RegioWeissman_+3A_type">type</code></td>
<td>
<p>Choose either <code>"evopt"</code> if extreme value dependent, <code>"ind"</code> if independent or <code>"opt"</code> for arbitrarily dependent components.</p>
</td></tr>
<tr><td><code id="RegioWeissman_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level for confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of </p>

<ul>
<li> <p><code>est</code> Point estimate of p-quantile of column j
</p>
</li>
<li> <p><code>CI</code> the corresponding alpha-confidence interval
</p>
</li>
<li> <p><code>EVI</code> estimate of the extreme value index
</p>
</li>
<li> <p><code>k</code> tail sample size
</p>
</li>
<li> <p><code>p</code> a probability
</p>
</li>
<li> <p><code>u.kn</code> (n-k)-th largest observation, where n is the sample length at station j after removing missing values
</p>
</li>
<li> <p><code>description</code> a short description.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
# sample observations of 75 years at one station:
x &lt;- rgev(75, 0, 1, 0) # x is a vector
RegioWeissman(x=x, p=0.95)

x2 &lt;- c(NA, NA, x[1:60], NA, x[61:75]) # vector of observations with missing values
RegioWeissman(x=x2, p=0.95) # NAs will be removed

# sample observations of 100 years at 4 stations:
set.seed(1053)
x &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4)
RegioWeissman(x=x, p=0.9, j=3)

# With missing values:
x2 &lt;- x
x2[sample(100, 12),2] &lt;- NA
RegioWeissman(x=x2, p=0.9, j=3)
</code></pre>

<hr>
<h2 id='RegioWeissmanSeas'>Quantile estimation: Weissman's extrapolation for seasonal data</h2><span id='topic+RegioWeissmanSeas'></span>

<h3>Description</h3>

<p>Estimation of the p-quantile based on multiple local Hill estimators and Weissman's extrapolation
formula with seasonality. We assume heavy-tail homogeneity within each season, i.e., all local EVI's are the same.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RegioWeissmanSeas(x, j = 1, p, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RegioWeissmanSeas_+3A_x">x</code></td>
<td>
<p>List of 2 elements: each element is consistent a vector or matrix of observations</p>
</td></tr>
<tr><td><code id="RegioWeissmanSeas_+3A_j">j</code></td>
<td>
<p>The number of the target site, i.e., if <code>j=2</code> the p-quantile of the second station is estimated.</p>
</td></tr>
<tr><td><code id="RegioWeissmanSeas_+3A_p">p</code></td>
<td>
<p>The probability of interest; should be between <code class="reqn">1-k_j/n_j</code> and 1, where <code class="reqn">n_j</code> is the
sample length of the <code>j</code>-th column.</p>
</td></tr>
<tr><td><code id="RegioWeissmanSeas_+3A_...">...</code></td>
<td>
<p>additional arguments, see <a href="#topic+RegioWeissman">RegioWeissman</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Point estimate of seasonal p-quantile of column <code>j</code> and a short description.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
# Local &amp; seasonal (observations of 80 years at one station):
x1 &lt;- rgev(80, 2, 1, 0.2) # observations from season 1
x2 &lt;- rgev(80, 3, 1, 0.3) # observations from season 2
x &lt;- list(x1, x2)
RegioWeissmanSeas(x=x, j=1, p=0.99)

x1 &lt;- matrix(rgev(400, 3, 1, 0.1), ncol=4) # observations of season 1 at 4 stations
x2 &lt;- matrix(rgev(400, 2, 1, 0.3), ncol=4) # observations of season 2 at 4 stations
x &lt;- list(x1, x2)
RegioWeissmanSeas(x=x, j=1, p=0.99)
</code></pre>

<hr>
<h2 id='seas2ann'>Annual maxima from seasonal maxima</h2><span id='topic+seas2ann'></span>

<h3>Description</h3>

<p>Calculates annual maxima from seasonal maxima of two seasons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seas2ann(x1, x2, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seas2ann_+3A_x1">x1</code></td>
<td>
<p>vector or matrix of observations from season 1 (rows: observations, columns: stations).</p>
</td></tr>
<tr><td><code id="seas2ann_+3A_x2">x2</code></td>
<td>
<p>vector or matrix of observations from season 2 (rows: observations, columns: stations).</p>
</td></tr>
<tr><td><code id="seas2ann_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. <code>TRUE</code>: the annual maximum will be calculated even if one
observation of the two seasons is a missing value, e.g. winter maximum is 58 and summer
maximum is <code>NA</code> the annual maximum is 58. If both observations are NA, the annual maximum is set to <code>NA</code>, too.
<code>FALSE</code>: the annual maximum will be set to <code>NA</code> if one
observation of the two seasons is a missing value, e.g. winter maximum is 58 and summer maximum
is <code>NA</code> the annual maximum is <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of annual observations (rows: observations, columns: stations).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(28379)
x1 &lt;- matrix(round(rnorm(8, 20, 25)), ncol=2)
x1[2] &lt;- NA
x2 &lt;- matrix(round(rnorm(8, 20, 25)), ncol=2)
x2[c(2,5,6)] &lt;- NA
x1
x2
seas2ann(x1,x2,TRUE)
seas2ann(x1,x2,FALSE)
</code></pre>

<hr>
<h2 id='TailAnova'>Heavy-tail ANOVA</h2><span id='topic+TailAnova'></span>

<h3>Description</h3>

<p>A test of heavy-tail homogeneity, that is, equality of the positive extreme value index for all d columns of <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TailAnova(x, k, k.qu = 20, type = "evopt", cf = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TailAnova_+3A_x">x</code></td>
<td>
<p>Matrix of observations</p>
</td></tr>
<tr><td><code id="TailAnova_+3A_k">k</code></td>
<td>
<p>Number of relative excesses involved in the estimation of the extreme value
index gamma. If <code>k</code> is missing, it will be set to
<code class="reqn">k=\left\lfloor \frac{2n^{2/3}}{d^{1/3}}\right\rfloor</code>, where d is the number of
columns of the matrix <code>x</code> and n the length of each column after removing missing values.</p>
</td></tr>
<tr><td><code id="TailAnova_+3A_k.qu">k.qu</code></td>
<td>
<p>Tuning parameter for estimation of empirical variance; only needed if <code>type="opt"</code>.</p>
</td></tr>
<tr><td><code id="TailAnova_+3A_type">type</code></td>
<td>
<p>Choose either <code>"evopt"</code> if extreme value dependent, <code>"ind"</code> if independent or <code>"opt"</code> for arbitrarily dependent components.</p>
</td></tr>
<tr><td><code id="TailAnova_+3A_cf">cf</code></td>
<td>
<p>If <code>TRUE</code>, a correctur factor is used, which improves the size at the cost of power.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Test statistic and p-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
set.seed(6754)
x1 &lt;- rgev(150, loc = 2, scale = 1, shape=0.4)
x2 &lt;- rgev(150, loc = 2.5, scale = 1, shape=0.1) # H_0 violated because of different shapes
x &lt;- cbind(x1, x2)
TailAnova(x)

x1 &lt;- rgev(150, loc = 2, scale = 1, shape=0.3)
x2 &lt;- rgev(150, loc = 2.5, scale = 1, shape=0.3) # H_0 not violated because of same shapes
x &lt;- cbind(x1, x2)
TailAnova(x)
</code></pre>

<hr>
<h2 id='xiAnova'>Homogeneity test for the shape</h2><span id='topic+xiAnova'></span>

<h3>Description</h3>

<p>A test for assumption <code class="reqn">H_0</code>: &quot;shape parameter is equal for all d GEV margins&quot;
with test statistic based on (trimmed) L-moments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xiAnova(x, leftrim = 0, rightrim = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xiAnova_+3A_x">x</code></td>
<td>
<p>matrix of observations (rows: observations, d columns: stations).</p>
</td></tr>
<tr><td><code id="xiAnova_+3A_leftrim">leftrim</code></td>
<td>
<p>integer indicating lower trimming parameter (<code class="reqn">\ge 0</code>).</p>
</td></tr>
<tr><td><code id="xiAnova_+3A_rightrim">rightrim</code></td>
<td>
<p>integer indicating upper trimming parameter (<code class="reqn">\ge 0</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value of the test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("evd")
# sample observations of 100 years at 5 stations:
set.seed(1053)
x19 &lt;- matrix(rgev(400, 2, 1, 0.1), ncol=4) # 4 stations with the same shape
x10 &lt;- rgev(100, 2, 1, 0.4) # one station with a different shape
x &lt;- cbind(x19, x10)
xiAnova(x=x, leftrim=0, rightrim=1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
