<!DOCTYPE html><html lang="en"><head><title>Help for package BSPADATA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BSPADATA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hetero_general'><p> Bayesian fitting of Spatial General Model with heteroscedastic normal error term.</p></a></li>
<li><a href='#hetero_general_int'><p>Hello</p></a></li>
<li><a href='#hetero_sar'><p> Bayesian fitting of Spatial AutoRegressive (SAR) model with heteroscedastic normal error term.</p></a></li>
<li><a href='#hetero_sar_int'><p>Hello</p></a></li>
<li><a href='#hetero_sem'><p> Bayesian fitting of Spatial Error Model (SEM) model with heteroscedastic normal error term.</p></a></li>
<li><a href='#hetero_sem_int'><p>Hello</p></a></li>
<li><a href='#hom_general'><p> Bayesian fitting of Spatial General Model with homoscedastic normal error term.</p></a></li>
<li><a href='#hom_general_int'><p>Hello</p></a></li>
<li><a href='#hom_sar'><p> Bayesian fitting of Spatial AutoRegressive (SAR) model with homoscedastic normal error term.</p></a></li>
<li><a href='#hom_sar_int'><p>Hello</p></a></li>
<li><a href='#hom_sem'><p> Bayesian fitting of Spatial Error Model (SEM) with homoscedastic normal error term.</p></a></li>
<li><a href='#hom_sem_int'><p>Hello</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Proposal to Fit Spatial Econometric Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Jorge Sicacha-Parada and Edilberto Cepeda-Cuervo</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jorge Sicacha-Parada &lt;jasicachap@unal.edu.co&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), stats, mvtnorm, spdep, pscl, pbapply, coda</td>
</tr>
<tr>
<td>Description:</td>
<td>The purpose of this package is to fit the three Spatial Econometric Models proposed
  in Anselin (1988, ISBN:9024737354) in the homoscedastic and the heteroscedatic case. The fit is made through MCMC algorithms
  and observational working variables approach.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-16 14:00:09 UTC; jorgespa</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-16 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='hetero_general'> Bayesian fitting of Spatial General Model with heteroscedastic normal error term.
</h2><span id='topic+hetero_general'></span>

<h3>Description</h3>

<p>Performs the Bayesian fitting of Heterocedastic Spatial General Model with normal error term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetero_general(formulamean,formulavar,data,W1,W2=NULL,nsim,burn,step,prior,initial,
               kernel="normal",mateq=TRUE,seed=0,impacts=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hetero_general_+3A_formulamean">formulamean</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted for the mean.
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_formulavar">formulavar</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted for the variance.
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_data">data</code></td>
<td>
<p> Data frame object with covariates of model
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_w1">W1</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix for response variable, Anselin(1988)
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_w2">W2</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix for disturbance terms, Anselin(1988)
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_nsim">nsim</code></td>
<td>

<p>A number that indicates the amount of iterations
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_burn">burn</code></td>
<td>

<p>A number that indicates the amount of iterations to be burn at the beginning of the chain
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_step">step</code></td>
<td>

<p>A number that indicates the length between samples in chain that generate the point estimates for each parameter.
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_prior">prior</code></td>
<td>

<p>List with prior distributions of the parameters in the hom_sem model
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_initial">initial</code></td>
<td>

<p>List with the initial values for the chains of each the parameters of the hom_sem model
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_kernel">kernel</code></td>
<td>

<p>Distribution used in transition kernel to get samples of lambda, it can be  &quot;uniform&quot; or &quot;normal&quot;
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_mateq">mateq</code></td>
<td>

<p>Logical variable indicating whether W1=w2 or not.
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_impacts">impacts</code></td>
<td>

<p>If impacts=TRUE then impacts for the model are computed, as suggested in Le Sage and Pace (2009).
</p>
</td></tr>
<tr><td><code id="hetero_general_+3A_seed">seed</code></td>
<td>

<p>Random seed for generating the samples of the posterior distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>hetero_general is a function made in order to fit Spatial General Model with a normal heteroscedatic disturbance term through MCMC methods as Metropolis-Hastings algorithm, under two proposals for trasition kernel to get samples of spatial lag parameters, rho and lambda, and aided by working variables approach to get samples of conditional posterior distribution of gamma vector.
</p>


<h3>Value</h3>

<p>List with the following:
</p>
<table role = "presentation">
<tr><td><code>summary</code></td>
<td>
<p>Data frame with summary statistics of the marginal posterior distributions of the parameters of the model</p>
</td></tr>
<tr><td><code>Acceptance_Rate</code></td>
<td>
<p>Acceptance rate for the samples of rho, lambda and gamma.</p>
</td></tr>
<tr><td><code>Criteria</code></td>
<td>
<p>List with values of both the Bayesian Information Criterion (BIC) and the Deviance Information Criterion (DIC)</p>
</td></tr>
<tr><td><code>chains</code></td>
<td>
<p>Object of class mcmc with the samples of the marginal posterior distribution of each of the parameters of the model</p>
</td></tr>
<tr><td><code>impacts</code></td>
<td>
<p>Summary of the impacts for each explanatory variable of the model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge  Sicacha-Parada &lt;jasicachap@unal.edu.co&gt;, Edilberto Cepeda-Cuervo &lt;ecepedac@unal.edu.co&gt;
</p>


<h3>References</h3>

<p>1. Cepeda C. E. (2001). Modelagem da variabilidade em modelos lineares generalizados. Unpublished Ph.D. tesis. Instituto de Matematicas.
Universidade Federal do Rio do Janeiro.
</p>
<p>2.Cepeda, E. and Gamerman D. (2005). Bayesian Methodology for modeling parameters in the two-parameter exponential family. Estadistica 57, 93 105.
</p>
<p>3.Cepeda C., E. and Gamerman D. (2001). Bayesian Modeling of Variance Heterogeneity in Normal Regression Models. Brazilian Journal of Probability and Statistics. 14, 207-221.
</p>
<p>4.Luc Anselin, Spatial Econometrics: Methods and Models, Kluwer Academic, Boston, 1988.
</p>
<p>5. D. Gamerman, Markov Chains Monte Carlo: Stochastic Simulation for bayesian Inference, Chapman and Hall, 1997.
</p>
<p>6. James Le Sage and Kelley Pace, Introduction to Spatial Econometrics, Chapman &amp; Hall/CRC, Boca Raton, 2009.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oldcol)
n=49
x0=rep(1,n)
x1=runif(n,0,400)
x2=runif(n,10,23)
x3=runif(n,0,10)
X=cbind(x0,x1,x2)
Z=cbind(x0,x1,x3)
gammas=c(-8,0.026,-0.4)
Sigma=diag(c(exp(Z%*%gammas)))
W1=COL.nb
matstand=nb2mat(W1)
A=diag(n)-0.70*matstand
B=diag(n)-0.20*matstand
mu=solve(A)%*%(-35+0.35*x1-1.7*x2)
Sigma2=t(solve(A)%*%solve(B))%*%Sigma%*%solve(A)%*%solve(B)
y=t(rmvnorm(1,mu,Sigma2))


formulamean &lt;- y ~ x0 + x1 + x2
formulavar &lt;-  ~ x0 + x1 + x3
data &lt;- data.frame(y=y,x0=x0,x1=x1,x2=x2,x3=x3)
prior &lt;- list(b_pri=rep(0,3),B_pri=diag(rep(1000,3)),
              g_pri=rep(0,3),G_pri=diag(rep(1000,3)))
initial &lt;- list(beta_0=rep(0,3),gamma_0=c(0,0,0),rho_0=0.5,lambda_0=0.5)
hetero_general(formulamean=formulamean,formulavar=formulavar,data=data,W1=W1,
               nsim=500,burn=25,step=5,prior=prior,initial=initial,
               kernel="normal",mateq=TRUE)

</code></pre>

<hr>
<h2 id='hetero_general_int'>Hello</h2><span id='topic+hetero_general_int'></span>

<h3>Description</h3>

<p>Hello
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetero_general_int(
  y,
  X,
  Z,
  W1,
  W2 = NULL,
  nsim,
  burn,
  step,
  b_pri,
  B_pri,
  g_pri,
  G_pri,
  beta_0,
  gammas_0,
  rho_0,
  lambda_0,
  kernel = "normal",
  seed = 0,
  mateq = TRUE,
  impacts = TRUE
)
</code></pre>

<hr>
<h2 id='hetero_sar'> Bayesian fitting of Spatial AutoRegressive (SAR) model with heteroscedastic normal error term.
</h2><span id='topic+hetero_sar'></span>

<h3>Description</h3>

<p>Performs the Bayesian fitting of Heterocedastic Spatial AutoRegressive (SAR) model with normal error term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetero_sar(formulamean,formulavar,data,W,nsim,burn,step,prior,
           initial,kernel="normal",seed=0,impacts=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hetero_sar_+3A_formulamean">formulamean</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted for the mean.
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_formulavar">formulavar</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted for the variance.
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_data">data</code></td>
<td>
<p> Data frame object with covariates of model
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_w">W</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix, Anselin(1988)
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_nsim">nsim</code></td>
<td>

<p>A number that indicates the amount of iterations
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_burn">burn</code></td>
<td>

<p>A number that indicates the amount of iterations to be burn at the beginning of the chain
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_step">step</code></td>
<td>

<p>A number that indicates the length between samples in chain that generate the point estimates for each parameter.
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_prior">prior</code></td>
<td>

<p>List with prior distributions of the parameters in the hom_sem model
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_initial">initial</code></td>
<td>

<p>List with the initial values for the chains of each the parameters of the hom_sem model
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_kernel">kernel</code></td>
<td>

<p>Distribution used in transition kernel to get samples of lambda, it can be  &quot;uniform&quot; or &quot;normal&quot;
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_impacts">impacts</code></td>
<td>

<p>If impacts=TRUE then impacts for the model are computed, as suggested in Le Sage and Pace (2009).
</p>
</td></tr>
<tr><td><code id="hetero_sar_+3A_seed">seed</code></td>
<td>

<p>Random seed for generating the samples of the posterior distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>hetero_sar is a function made in order to fit Spatial AutoRegressive (SAR) model with a normal heteroscedatic disturbance term through MCMC methods as Metropolis-Hastings algorithm, under two proposals for trasition kernel to get samples of spatial lag parameter, rho and aided by working variables approach to get samples of conditional posterior distribution of gamma vector.
</p>


<h3>Value</h3>

<p>List with the following:
</p>
<table role = "presentation">
<tr><td><code>summary</code></td>
<td>
<p>Data frame with summary statistics of the marginal posterior distributions of the parameters of the model</p>
</td></tr>
<tr><td><code>Acceptance_Rate</code></td>
<td>
<p>List with the acceptance rate for the samples of gamma and rho </p>
</td></tr>
<tr><td><code>Criteria</code></td>
<td>
<p>List with values of both the Bayesian Information Criterion (BIC) and the Deviance Information Criterion (DIC)</p>
</td></tr>
<tr><td><code>chains</code></td>
<td>
<p>Object of class mcmc with the samples of the marginal posterior distribution of each of the parameters of the model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge  Sicacha-Parada &lt;jasicachap@unal.edu.co&gt;, Edilberto Cepeda-Cuervo &lt;ecepedac@unal.edu.co&gt;
</p>


<h3>References</h3>

<p>1. Cepeda C. E. (2001). Modelagem da variabilidade em modelos lineares generalizados. Unpublished Ph.D. tesis. Instituto de Matematicas.
Universidade Federal do Rio do Janeiro.
</p>
<p>2.Cepeda, E. and Gamerman D. (2005). Bayesian Methodology for modeling parameters in the two-parameter exponential family. Estadistica 57, 93 105.
</p>
<p>3.Cepeda C., E. and Gamerman D. (2001). Bayesian Modeling of Variance Heterogeneity in Normal Regression Models. Brazilian Journal of Probability and Statistics. 14, 207-221.
</p>
<p>4.Luc Anselin, Spatial Econometrics: Methods and Models, Kluwer Academic, Boston, 1988.
</p>
<p>5. D. Gamerman, Markov Chains Monte Carlo: Stochastic Simulation for bayesian Inference, Chapman and Hall, 1997.
</p>
<p>6. James Le Sage and Kelley Pace, Introduction to Spatial Econometrics, Chapman &amp; Hall/CRC, Boca Raton, 2009.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
data(oldcol)
n=49
x0=rep(1,n)
x1=runif(n,0,400)
x2=runif(n,10,23)
x3=runif(n,0,10)
X=cbind(x0,x1,x2)
Z=cbind(x0,x1,x3)
gammas=c(-8,0.026,-0.4)
Sigma=diag(c(exp(Z%*%gammas)))
W=COL.nb
matstand=nb2mat(W)
A=diag(n)-0.75*matstand
mu=solve(A)%*%(-35+0.35*x1-1.7*x2)
Sigma2=t(solve(A))%*%Sigma%*%solve(A)
y=t(rmvnorm(1,mu,Sigma2))
data = data.frame(y=y,x0=x0,x1=x1,x2=x2,x3=x3)
formulamean &lt;- y ~ x0+x1+x2
formulavar &lt;- ~ x0 + x1 + x3
prior = list(b_pri=rep(0,3),B_pri=diag(rep(1000,3)),g_pri=rep(0,3),G_pri=diag(rep(1000,3)))
initial = list(beta_0=rep(0,3),gamma_0=rep(0,3),rho_0=0.5)
hetero_sar(formulamean,formulavar,data,W=W,nsim=500,burn=25,step=5,prior=prior,
           initial=initial,kernel="normal",seed=0,impacts=TRUE)
  </code></pre>

<hr>
<h2 id='hetero_sar_int'>Hello</h2><span id='topic+hetero_sar_int'></span>

<h3>Description</h3>

<p>Hello
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetero_sar_int(
  y,
  X,
  Z,
  W,
  nsim,
  burn,
  step,
  b_pri,
  B_pri,
  g_pri,
  G_pri,
  beta_0,
  gammas_0,
  rho_0,
  kernel = "normal",
  seed = 0,
  impacts = TRUE
)
</code></pre>

<hr>
<h2 id='hetero_sem'> Bayesian fitting of Spatial Error Model (SEM) model with heteroscedastic normal error term.
</h2><span id='topic+hetero_sem'></span>

<h3>Description</h3>

<p>Performs the Bayesian fitting of Heterocedastic Spatial Error Model (SEM) model with normal error term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetero_sem(formulamean,formulavar,data,W,nsim,burn,step,prior,
           initial,kernel="normal",seed=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hetero_sem_+3A_formulamean">formulamean</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted for the mean.
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_formulavar">formulavar</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted for the variance.
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_data">data</code></td>
<td>
<p> Data frame object with covariates of model
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_w">W</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix, Anselin(1988)
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_nsim">nsim</code></td>
<td>

<p>A number that indicates the amount of iterations
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_burn">burn</code></td>
<td>

<p>A number that indicates the amount of iterations to be burn at the beginning of the chain
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_step">step</code></td>
<td>

<p>A number that indicates the length between samples in chain that generate the point estimates for each parameter.
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_prior">prior</code></td>
<td>

<p>List with prior distributions of the parameters in the hom_sem model
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_initial">initial</code></td>
<td>

<p>List with the initial values for the chains of each the parameters of the hom_sem model
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_kernel">kernel</code></td>
<td>

<p>Distribution used in transition kernel to get samples of lambda, it can be  &quot;uniform&quot; or &quot;normal&quot;
</p>
</td></tr>
<tr><td><code id="hetero_sem_+3A_seed">seed</code></td>
<td>

<p>Random seed for generating the samples of the posterior distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>hetero_sem is a function made in order to fit Spatial Error Model (SEM) with a normal heteroscedatic disturbance term through MCMC methods as Metropolis-Hastings algorithm, under two proposals for trasition kernel to get samples of spatial lag parameter, lambda, and aided by working variables approach to get samples of conditional posterior distribution of gamma vector.
</p>


<h3>Value</h3>

<p>List with the following:
</p>
<table role = "presentation">
<tr><td><code>summary</code></td>
<td>
<p>Data frame with summary statistics of the marginal posterior distributions of the parameters of the model</p>
</td></tr>
<tr><td><code>Acceptance_Rate</code></td>
<td>
<p>List with the acceptance rate for the samples of gamma and lambda </p>
</td></tr>
<tr><td><code>Criteria</code></td>
<td>
<p>List with values of both the Bayesian Information Criterion (BIC) and the Deviance Information Criterion (DIC)</p>
</td></tr>
<tr><td><code>chains</code></td>
<td>
<p>Object of class mcmc with the samples of the marginal posterior distribution of each of the parameters of the model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge  Sicacha-Parada &lt;jasicachap@unal.edu.co&gt;, Edilberto Cepeda-Cuervo &lt;ecepedac@unal.edu.co&gt;
</p>


<h3>References</h3>

<p>1. Cepeda C. E. (2001). Modelagem da variabilidade em modelos lineares generalizados. Unpublished Ph.D. tesis. Instituto de Matematicas.
Universidade Federal do Rio do Janeiro.
</p>
<p>2.Cepeda, E. and Gamerman D. (2005). Bayesian Methodology for modeling parameters in the two-parameter exponential family. Estadistica 57, 93 105.
</p>
<p>3.Cepeda C., E. and Gamerman D. (2001). Bayesian Modeling of Variance Heterogeneity in Normal Regression Models. Brazilian Journal of Probability and Statistics. 14, 207-221.
</p>
<p>4.Luc Anselin, Spatial Econometrics: Methods and Models, Kluwer Academic, Boston, 1988.
</p>
<p>5. D. Gamerman, Markov Chains Monte Carlo: Stochastic Simulation for bayesian Inference, Chapman and Hall, 1997.
</p>
<p>6. James Le Sage and Kelley Pace, Introduction to Spatial Econometrics, Chapman &amp; Hall/CRC, Boca Raton, 2009.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oldcol)
n=49
x0=rep(1,n)
x1=runif(n,0,400)
x2=runif(n,10,23)
x3=runif(n,0,10)
X=cbind(x0,x1,x2)
Z=cbind(x0,x1,x3)
gammas=c(-8,0.026,-0.4)
Sigma=diag(c(exp(Z%*%gammas)))
W=COL.nb
matstand=nb2mat(W)
A=diag(n)-0.75*matstand
mu=-35+0.35*x1-1.7*x2
Sigma2=t(solve(A))%*%Sigma%*%solve(A)
y=t(rmvnorm(1,mu,Sigma2))

formulamean &lt;- y ~ x0 + x1 + x2
formulavar &lt;- ~ x0 + x1 +x3
data &lt;- data.frame(y=y,x0=x0,x1=x1,x2=x2,x3=x3)
prior = list(b_pri=rep(0,3),B_pri=diag(rep(1000,3)),g_pri=rep(0,3),
             G_pri=diag(rep(1000,3)))
initial = list(beta_0=rep(0,3),gamma_0=c(0,0,0),lambda_0=0.5)

hetero_sem(formulamean,formulavar,data,W=W,nsim=500,burn=25,step=5,prior = prior,
           initial = initial,kernel="normal")

</code></pre>

<hr>
<h2 id='hetero_sem_int'>Hello</h2><span id='topic+hetero_sem_int'></span>

<h3>Description</h3>

<p>Hello
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetero_sem_int(
  y,
  X,
  Z,
  W,
  nsim,
  burn,
  step,
  b_pri,
  B_pri,
  g_pri,
  G_pri,
  beta_0,
  gammas_0,
  lambda_0,
  kernel = "normal",
  seed = 0
)
</code></pre>

<hr>
<h2 id='hom_general'> Bayesian fitting of Spatial General Model with homoscedastic normal error term.
</h2><span id='topic+hom_general'></span>

<h3>Description</h3>

<p>Performs the Bayesian fitting of Homoscedastic General Model with normal error term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hom_general(formula, data,W1,W2=NULL, nsim, burn, step,prior,
            initial, kernel = "normal",mateq=TRUE,impacts=TRUE,seed=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hom_general_+3A_formula">formula</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_data">data</code></td>
<td>
<p> Data frame object with covariates of model
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_w1">W1</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix for response variable, Anselin(1988)
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_w2">W2</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix for disturbance terms, Anselin(1988)
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_nsim">nsim</code></td>
<td>

<p>A number that indicates the amount of iterations
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_burn">burn</code></td>
<td>

<p>A number that indicates the amount of iterations to be burn at the beginning of the chain
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_step">step</code></td>
<td>

<p>A number that indicates the length between samples in chain that generate the point estimates for each parameter.
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_prior">prior</code></td>
<td>

<p>List with prior distributions of the parameters in the hom_sem model
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_initial">initial</code></td>
<td>

<p>List with the initial values for the chains of each the parameters of the hom_sem model
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_kernel">kernel</code></td>
<td>

<p>Distribution used in transition kernel to get samples of lambda, it can be  &quot;uniform&quot; or &quot;normal&quot;
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_mateq">mateq</code></td>
<td>

<p>Logical variable indicating whether W1=w2 or not.
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_impacts">impacts</code></td>
<td>

<p>If impacts=TRUE then impacts for the model are computed, as suggested in Le Sage and Pace (2009).
</p>
</td></tr>
<tr><td><code id="hom_general_+3A_seed">seed</code></td>
<td>

<p>Random seed for generating the samples of the posterior distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>hom_general is a function made in order to fit Spatial General Model with a normal homoscedatic disturbance term through MCMC methods as Metropolis-Hastings algorithm, under two proposals for trasition kernel to get samples of spatial responde and error lag parameters, rho and lambda, respectively.
</p>


<h3>Value</h3>

<p>List with the following:
</p>
<table role = "presentation">
<tr><td><code>summary</code></td>
<td>
<p>Data frame with summary statistics of the marginal posterior distributions of the parameters of the model</p>
</td></tr>
<tr><td><code>Acceptance_Rate</code></td>
<td>
<p>Acceptance rate for the samples of rho and lambda</p>
</td></tr>
<tr><td><code>Criteria</code></td>
<td>
<p>List with values of both the Bayesian Information Criterion (BIC) and the Deviance Information Criterion (DIC)</p>
</td></tr>
<tr><td><code>chains</code></td>
<td>
<p>Object of class mcmc with the samples of the marginal posterior distribution of each of the parameters of the model</p>
</td></tr>
<tr><td><code>impacts</code></td>
<td>
<p>Summary of the impacts for each explanatory variable of the model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge  Sicacha-Parada &lt;jasicachap@unal.edu.co&gt;, Edilberto Cepeda-Cuervo &lt;ecepedac@unal.edu.co&gt;
</p>


<h3>References</h3>

<p>1. Cepeda C. E. (2001). Modelagem da variabilidade em modelos lineares generalizados. Unpublished Ph.D. tesis. Instituto de Matematicas.
Universidade Federal do Rio do Janeiro.
</p>
<p>2.Cepeda, E. and Gamerman D. (2005). Bayesian Methodology for modeling parameters in the two-parameter exponential family. Estadistica 57, 93 105.
</p>
<p>3.Cepeda C., E. and Gamerman D. (2001). Bayesian Modeling of Variance Heterogeneity in Normal Regression Models. Brazilian Journal of Probability and Statistics. 14, 207-221.
</p>
<p>4.Luc Anselin, Spatial Econometrics: Methods and Models, Kluwer Academic, Boston, 1988.
</p>
<p>5. D. Gamerman, Markov Chains Monte Carlo: Stochastic Simulation for bayesian Inference, Chapman and Hall, 1997.
</p>
<p>6. James Le Sage and Kelley Pace, Introduction to Spatial Econometrics, Chapman &amp; Hall/CRC, Boca Raton, 2009.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(oldcol)
n=49
x0=rep(1,n)
x1=runif(n,0,400)
x2=runif(n,10,23)
X=cbind(x0,x1,x2)
sigma2=rep(45,n)
Sigma=diag(sigma2)
W1=COL.nb
matstand=nb2mat(W1)
A=diag(n)-0.75*matstand
B=diag(n)-0.20*matstand
miu=solve(A)%*%(18+0.026*x1-0.4*x2)
Sigma2=t(solve(A)%*%solve(B))%*%Sigma%*%solve(A)%*%solve(B)
y=t(rmvnorm(1,miu,Sigma2))

formula &lt;- y ~ x0 + x1 + x2
data &lt;- data.frame(y=y,x0=x0,x1=x1,x2=x2)
prior &lt;- list(b_pri=rep(0,3),B_pri=diag(rep(1000,3)),
              r_pri=0.01,lambda_pri=0.01)
initial &lt;- list(beta_0=rep(0,3),
                sigma2_0=90,rho_0=0.5,lambda_0=0.5)
hom_general(formula=formula,data=data,W1=COL.nb,nsim=500,burn=25,step=5,
              prior=prior,initial=initial,kernel="normal",mateq=TRUE)


</code></pre>

<hr>
<h2 id='hom_general_int'>Hello</h2><span id='topic+hom_general_int'></span>

<h3>Description</h3>

<p>Hello
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hom_general_int(
  y,
  X,
  W1,
  W2 = NULL,
  nsim,
  burn,
  step,
  b_pri,
  B_pri,
  r_pri,
  lambda_pri,
  beta_0,
  sigma2_0,
  rho_0,
  lambda_0,
  kernel = "normal",
  seed = 0,
  mateq = TRUE,
  impacts = TRUE
)
</code></pre>

<hr>
<h2 id='hom_sar'> Bayesian fitting of Spatial AutoRegressive (SAR) model with homoscedastic normal error term.
</h2><span id='topic+hom_sar'></span>

<h3>Description</h3>

<p>Performs the Bayesian fitting of Homoscedastic Spatial AutoRegressive (SAR) model with normal error term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hom_sar(formula, data, W, nsim, burn, step,prior, initial,
        kernel = "normal",impacts=TRUE,seed=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hom_sar_+3A_formula">formula</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_data">data</code></td>
<td>
<p> Data frame object with covariates of model
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_w">W</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix, Anselin(1988)
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_nsim">nsim</code></td>
<td>

<p>A number that indicates the amount of iterations
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_burn">burn</code></td>
<td>

<p>A number that indicates the amount of iterations to be burn at the beginning of the chain
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_step">step</code></td>
<td>

<p>A number that indicates the length between samples in chain that generate the point estimates for each parameter.
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_prior">prior</code></td>
<td>

<p>List with prior distributions of the parameters in the hom_sem model
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_initial">initial</code></td>
<td>

<p>List with the initial values for the chains of each the parameters of the hom_sem model
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_kernel">kernel</code></td>
<td>

<p>Distribution used in transition kernel to get samples of lambda, it can be  &quot;uniform&quot; or &quot;normal&quot;
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_impacts">impacts</code></td>
<td>

<p>If impacts=TRUE then impacts for the model are computed, as suggested in Le Sage and Pace (2009).
</p>
</td></tr>
<tr><td><code id="hom_sar_+3A_seed">seed</code></td>
<td>

<p>Random seed for generating the samples of the posterior distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>hom_sar is a function made in order to fit Spatial AutoRegressive (SAR) model with a normal homoscedatic disturbance term through MCMC methods as Metropolis-Hastings algorithm, under two proposals for trasition kernel to get samples of spatial lag parameter, rho.
</p>


<h3>Value</h3>

<p>List with the following:
</p>
<table role = "presentation">
<tr><td><code>summary</code></td>
<td>
<p>Data frame with summary statistics of the marginal posterior distributions of the parameters of the model</p>
</td></tr>
<tr><td><code>Acceptance_Rate</code></td>
<td>
<p>Acceptance rate for the samples of rho</p>
</td></tr>
<tr><td><code>Criteria</code></td>
<td>
<p>List with values of both the Bayesian Information Criterion (BIC) and the Deviance Information Criterion (DIC)</p>
</td></tr>
<tr><td><code>chains</code></td>
<td>
<p>Object of class mcmc with the samples of the marginal posterior distribution of each of the parameters of the model</p>
</td></tr>
<tr><td><code>impacts</code></td>
<td>
<p>Summary of the impacts for each explanatory variable of the model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge  Sicacha-Parada &lt;jasicachap@unal.edu.co&gt;, Edilberto Cepeda-Cuervo &lt;ecepedac@unal.edu.co&gt;
</p>


<h3>References</h3>

<p>1. Cepeda C. E. (2001). Modelagem da variabilidade em modelos lineares generalizados. Unpublished Ph.D. tesis. Instituto de Matematicas.
Universidade Federal do Rio do Janeiro.
</p>
<p>2.Cepeda, E. and Gamerman D. (2005). Bayesian Methodology for modeling parameters in the two-parameter exponential family. Estadistica 57, 93 105.
</p>
<p>3.Cepeda C., E. and Gamerman D. (2001). Bayesian Modeling of Variance Heterogeneity in Normal Regression Models. Brazilian Journal of Probability and Statistics. 14, 207-221.
</p>
<p>4.Luc Anselin, Spatial Econometrics: Methods and Models, Kluwer Academic, Boston, 1988.
</p>
<p>5. D. Gamerman, Markov Chains Monte Carlo: Stochastic Simulation for bayesian Inference, Chapman and Hall, 1997.
</p>
<p>6. James Le Sage and Kelley Pace, Introduction to Spatial Econometrics, Chapman &amp; Hall/CRC, Boca Raton, 2009.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BSPADATA)
## Generate data ##
data(oldcol)
n=49
x0=rep(1,n)
x1=runif(n,0,400)
x2=runif(n,10,23)
X=data.frame(x0=x0,x1=x1,x2=x2)
sigma2=rep(45,n)
Sigma=diag(sigma2)
W=COL.nb
matstand=nb2mat(W)
A=diag(n)-0.90*matstand
mu=solve(A)%*%(18+0.478*x1-1.3*x2)
Sigma2=t(solve(A))%*%Sigma%*%solve(A)
y=t(rmvnorm(1,mu,Sigma2))
data = data.frame(y=y,x0=x0,x1=x1,x2=x2)

## Fit the model ##
formula &lt;- y ~ x0+x1+x2
prior = list(b_pri=rep(0,3),B_pri=diag(rep(1000,3)),r_pri=0.01,
lambda_pri=0.01)
initial = list(beta_0=rep(0,3),sigma2_0=90,rho_0=0.5)
model &lt;- hom_sar(formula=formula,data=data,W,nsim=500,burn=25,step=5,prior=prior,
                 initial=initial,kernel="normal")
</code></pre>

<hr>
<h2 id='hom_sar_int'>Hello</h2><span id='topic+hom_sar_int'></span>

<h3>Description</h3>

<p>Hello
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hom_sar_int(
  y,
  X,
  W,
  nsim,
  burn,
  step,
  b_pri,
  B_pri,
  r_pri,
  lambda_pri,
  beta_0,
  sigma2_0,
  rho_0,
  kernel = "normal",
  seed = 0,
  impacts = TRUE
)
</code></pre>

<hr>
<h2 id='hom_sem'> Bayesian fitting of Spatial Error Model (SEM) with homoscedastic normal error term.
</h2><span id='topic+hom_sem'></span>

<h3>Description</h3>

<p>Performs the Bayesian fitting of Homoscedastic Spatial Error Model (SEM) with normal error term
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hom_sem(formula, data, W, nsim, burn, step,prior, initial, kernel = "normal",seed=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hom_sem_+3A_formula">formula</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_data">data</code></td>
<td>
<p> Data frame object with covariates of model
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_w">W</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix, Anselin(1988)
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_nsim">nsim</code></td>
<td>

<p>A number that indicates the amount of iterations
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_burn">burn</code></td>
<td>

<p>A number that indicates the amount of iterations to be burn at the beginning of the chain
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_step">step</code></td>
<td>

<p>A number that indicates the length between samples in chain that generate the point estimates for each parameter.
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_prior">prior</code></td>
<td>

<p>List with prior distributions of the parameters in the hom_sem model
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_initial">initial</code></td>
<td>

<p>List with the initial values for the chains of each the parameters of the hom_sem model
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_kernel">kernel</code></td>
<td>

<p>Distribution used in transition kernel to get samples of lambda, it can be  &quot;uniform&quot; or &quot;normal&quot;
</p>
</td></tr>
<tr><td><code id="hom_sem_+3A_seed">seed</code></td>
<td>

<p>Random seed for generating the samples of the posterior distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>hom_sem is a function made in order to fit Spatial Error Model (SEM) with a normal homoscedatic disturbance term through MCMC methods as Metropolis-Hastings algorithm, under two proposals for trasition kernel to get samples of spatial error lag parameter, lambda.
</p>


<h3>Value</h3>

<p>List with the following:
</p>
<table role = "presentation">
<tr><td><code>summary</code></td>
<td>
<p>Data frame with summary statistics of the marginal posterior distributions of the parameters of the model</p>
</td></tr>
<tr><td><code>Acceptance_Rate</code></td>
<td>
<p>Acceptance rate for the samples of lambda</p>
</td></tr>
<tr><td><code>Criteria</code></td>
<td>
<p>List with values of both the Bayesian Information Criterion (BIC) and the Deviance Information Criterion (DIC)</p>
</td></tr>
<tr><td><code>chains</code></td>
<td>
<p>Object of class mcmc with the samples of the marginal posterior distribution of each of the parameters of the model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jorge  Sicacha-Parada &lt;jasicachap@unal.edu.co&gt;, Edilberto Cepeda-Cuervo &lt;ecepedac@unal.edu.co&gt;
</p>


<h3>References</h3>

<p>1. Cepeda C. E. (2001). Modelagem da variabilidade em modelos lineares generalizados. Unpublished Ph.D. tesis. Instituto de Matematicas.
Universidade Federal do Rio do Janeiro.
</p>
<p>2.Cepeda, E. and Gamerman D. (2005). Bayesian Methodology for modeling parameters in the two-parameter exponential family. Estadistica 57, 93 105.
</p>
<p>3.Cepeda C., E. and Gamerman D. (2001). Bayesian Modeling of Variance Heterogeneity in Normal Regression Models. Brazilian Journal of Probability and Statistics. 14, 207-221.
</p>
<p>4.Luc Anselin, Spatial Econometrics: Methods and Models, Kluwer Academic, Boston, 1988.
</p>
<p>5. D. Gamerman, Markov Chains Monte Carlo: Stochastic Simulation for bayesian Inference, Chapman and Hall, 1997.
</p>
<p>6. James Le Sage and Kelley Pace, Introduction to Spatial Econometrics, Chapman &amp; Hall/CRC, Boca Raton, 2009.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oldcol)
n=49
x0=rep(1,n)
x1=runif(n,0,400)
x2=runif(n,10,23)
X=cbind(x0,x1,x2)
sigma2=rep(45,n)
Sigma=diag(sigma2)
W=COL.nb
matstand=nb2mat(W)
A=diag(n)-0.85*matstand
mu=(18+0.026*x1-0.4*x2)
Sigma2=t(solve(A))%*%Sigma%*%solve(A)
y=t(rmvnorm(1,mu,Sigma2))
formula &lt;- y ~ x0+x1+x2
data &lt;- data.frame(y=y,x0=x0,x1=x1,x2=x2)
prior &lt;- list(b_pri=rep(0,3),B_pri=diag(rep(1000,3)),r_pri=0.01,lambda_pri=0.01)
initial &lt;- list(beta_0=rep(0,3),sigma2_0=90,lambda_0=0.5)

hom_sem(formula=formula,data=data,W=W,nsim=500,burn=25,step=5,prior=prior,
        initial=initial,kernel="normal")

</code></pre>

<hr>
<h2 id='hom_sem_int'>Hello</h2><span id='topic+hom_sem_int'></span>

<h3>Description</h3>

<p>Hello
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hom_sem_int(
  y,
  X,
  W,
  nsim,
  burn,
  step,
  b_pri,
  B_pri,
  r_pri,
  lambda_pri,
  beta_0,
  sigma2_0,
  lambda_0,
  kernel = "normal",
  seed = 0
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
