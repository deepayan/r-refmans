<!DOCTYPE html><html><head><title>Help for package sscor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sscor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#sscor-package'>
<p>Correlation estimation by spatial signs</p></a></li>
<li><a href='#evShape2evSSCM'>
<p>Calculation of the eigenvalues of the Spatial Sign Covariance Matrix</p></a></li>
<li><a href='#evSSCM2evShape'>
<p>Calculation of the eigenvalues of the shape matrix</p></a></li>
<li><a href='#Shape2SSCM'>
<p>Calculation of the Spatial Sign Covariance Matrix</p></a></li>
<li><a href='#SSCM2Shape'>
<p>Calculation of the shape matrix</p></a></li>
<li><a href='#sscor'>
<p>Spatial sign correlation</p></a></li>
<li><a href='#sscor.test'>
<p>Correlation test based on spatial signs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Correlation Estimation and Testing Based on Spatial Signs</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-01-19</td>
</tr>
<tr>
<td>Depends:</td>
<td>pcaPP, robustbase, mvtnorm</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the spatial sign correlation and the two-stage spatial sign correlation as well as a one-sample test for the correlation coefficient.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-01-28 10:58:55 UTC; alexander</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Duerre [aut, cre],
  Daniel Vogel [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Duerre &lt;alexander.duerre@tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-01-28 20:45:58</td>
</tr>
</table>
<hr>
<h2 id='sscor-package'>
Correlation estimation by spatial signs
</h2><span id='topic+sscor-package'></span>

<h3>Description</h3>

<p>R functions for correlation estimation based on spatial signs. Including spatial sign correlation and two stage spatial sign correlation.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> sscor</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-4-22</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Alexander Dürre, Daniel Vogel
</p>
<p>Maintainer: Alexander Dürre &lt;alexander.duerre@udo.edu&gt;
</p>


<h3>References</h3>

<p>Dürre, A., Vogel, D., Fried, R. (2015): Spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 135, 89&ndash;105. 
<a href="http://arxiv.org/abs/1403.7635">arvix 1403.7635</a>
</p>
<p>Dürre, A., Vogel, D. (2016): Asymptotics of the two-stage spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 144, 54&ndash;67. <a href="http://arxiv.org/abs/1506.02578">arxiv 1506.02578</a>
</p>
<p>Dürre, A., Tyler, D. E., Vogel, D. (2016): On the eigenvalues of the spatial sign covariance matrix in more than two dimensions, to appear in: <em>Statistics and Probability Letters</em>. <a href="http://arxiv.org/abs/1512.02863">arvix 1512.02863</a>
</p>

<hr>
<h2 id='evShape2evSSCM'>
Calculation of the eigenvalues of the Spatial Sign Covariance Matrix
</h2><span id='topic+evShape2evSSCM'></span>

<h3>Description</h3>

<p><code>evShape2evSSCM</code> transforms the eigenvalues of the shape matrix of an elliptical distribution into that of the spatial sign covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evShape2evSSCM(evShape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evShape2evSSCM_+3A_evshape">evShape</code></td>
<td>
<p> (required) p-dimensional numeric, representing the eigenvalues of the shape matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The eigenvalues of the SSCM can be calculated from the eigenvalues of the shape matrix by numerical evaluation of onedimensional integrals, see Proposition 3 of Dürre, Tyler, Vogel (2016). We use the substitution </p>
<p style="text-align: center;"><code class="reqn">x=\frac{1+t}{1-t}</code>
</p>
<p> and Gaussian quadrature with Jacobi polynomials up to order 500 and <code class="reqn">\beta=0</code> as well as <code class="reqn">\alpha=p/2-1</code>, see chapter 2.4 (iv) of Gautschi (1997) for details.
</p>
<p>The nodes and weights of the Gauss-Jacobi-quadrature are originally computed by the <code>gaussquad</code> package and saved in the file <code>jacobiquad</code> for faster computation.
</p>


<h3>Value</h3>

<p>p-dimensional numeric, representing the eigenvalues of the corresponding spatial sign covariance matrix.
</p>


<h3>References</h3>

<p>Dürre, A., Vogel, D., Fried, R. (2015): Spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 135, 89&ndash;105. 
<a href="http://arxiv.org/abs/1403.7635">arvix 1403.7635</a>
</p>
<p>Dürre, A., Tyler, D. E., Vogel, D. (2016): On the eigenvalues of the spatial sign covariance matrix in more than two dimensions, to appear in: <em>Statistics and Probability Letters</em>. <a href="http://arxiv.org/abs/1512.02863">arvix 1512.02863</a>
</p>
<p>Gautschi, W. (1997): <em>Numerical Analysis - An Introduction</em>, Birkhäuser, Basel.
</p>
<p>Novomestky, F. (2013): gaussquad: Collection of functions for Gaussian quadrature. R package version 1.0-2.
</p>


<h3>See Also</h3>

<p>Calculating the theoretical SSCM from the theoretical shape matrix <code><a href="#topic+Shape2SSCM">Shape2SSCM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# defining eigenvalues of the shape matrix
evShape &lt;- seq(from=0,to=1,by=0.1)

# standardized to have sum 1
evShape &lt;- evShape/sum(evShape)

# calculating the related eigenvalues of the SSCM
evSSCM &lt;- evShape2evSSCM(evShape)

plot(evShape,evSSCM)

# recalculate the eigenvalues of the shape matrix
evShape2 &lt;- evSSCM2evShape(evSSCM)

# error is negligible
sum(abs(evShape-evShape2))
</code></pre>

<hr>
<h2 id='evSSCM2evShape'>
Calculation of the eigenvalues of the shape matrix
</h2><span id='topic+evSSCM2evShape'></span>

<h3>Description</h3>

<p><code>evSSCM2evShape</code> transforms the eigenvalues of the SSCM of an elliptical distribution into that of the shape matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evSSCM2evShape(delta,tol=10^(-10),itermax=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evSSCM2evShape_+3A_delta">delta</code></td>
<td>
<p> (required) p-dimensional numeric representing the eigenvalues of the SSCM.</p>
</td></tr>
<tr><td><code id="evSSCM2evShape_+3A_tol">tol</code></td>
<td>
<p> (optional) numeric, defines the stopping rule of the approximation procedure, see details.</p>
</td></tr>
<tr><td><code id="evSSCM2evShape_+3A_itermax">itermax</code></td>
<td>
<p> (optional) numeric, defines the maximal number of iterations, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The eigenvalues of the SSCM given that of the shape matrix can be calculated by evaluations of numerical integrals, see the help of <code><a href="#topic+evShape2evSSCM">evShape2evSSCM</a></code> or Dürre, Tyler, Vogel (2016). There is no expression for the inverse relationshop known. Though one can apply a fixed point iteration to get an approximation of the eigenvalues of the shape matrix. The iteration stops if either the maximal number of iterations is reached, which produces a warning, or if the error between the eigenvalues of the SSCM and the ones calculated from the actual fixed point iteration in L1 norm is smaller than the given tolerance. Since the mapping between the sets of eigenvalues is injective, see Dürre, Tyler, Vogel (2016), this gives a reasonable approximation of the eigenvalues of the shape matrix.
</p>


<h3>Value</h3>

<p>p-dimensional numerical, representing the eigenvalues of the shape matrix. They are standardized to sum to 1.
</p>


<h3>References</h3>

<p>Dürre, A., Vogel, D., Fried, R. (2015): Spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 135, 89&ndash;105. 
<a href="http://arxiv.org/abs/1403.7635">arvix 1403.7635</a>
</p>
<p>Dürre, A., Tyler, D. E., Vogel, D. (2016): On the eigenvalues of the spatial sign covariance matrix in more than two dimensions, to appear in: <em>Statistics and Probability Letters</em>. <a href="http://arxiv.org/abs/1512.02863">arvix 1512.02863</a>
</p>


<h3>See Also</h3>

<p>Calculating the theoretical shape from the theoretical SSCM <code><a href="#topic+SSCM2Shape">SSCM2Shape</a></code>
</p>
<p>Calculating the eigenvalues of the SSCM from the eigenvalues of the shape matrix <code><a href="#topic+evShape2evSSCM">evShape2evSSCM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# defining eigenvalues of the shape matrix
evShape &lt;- seq(from=0,to=1,by=0.1)

# standardized to have sum 1
evShape &lt;- evShape/sum(evShape)

# calculating the related eigenvalues of the SSCM
evSSCM &lt;- evShape2evSSCM(evShape)

plot(evShape,evSSCM)

# recalculate the eigenvalues of the shape matrix
evShape2 &lt;- evSSCM2evShape(evSSCM)

# error is negligible
sum(abs(evShape-evShape2))
</code></pre>

<hr>
<h2 id='Shape2SSCM'>
Calculation of the Spatial Sign Covariance Matrix
</h2><span id='topic+Shape2SSCM'></span>

<h3>Description</h3>

<p><code>Shape2SSCM</code> transforms the theoretical shape matrix of an elliptical distribution into the spatial sign covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Shape2SSCM(V)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Shape2SSCM_+3A_v">V</code></td>
<td>
<p> (required) p x p matrix representing the theoretical shape matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation consists of three steps. First one calculates eigenvectors and eigenvalues of the shape matrix by the function <code>eigen</code>. Then one determines the related eigenvalues of the SSCM using the function <code><a href="#topic+evShape2evSSCM">evShape2evSSCM</a></code> and finally one expands the resulting eigendecomposition consisting of the eigenvectors of the Shape matrix and the eigenvalues of the SSCM. Note that this procedure only works for elliptical distributions.
</p>


<h3>Value</h3>

<p>p x p symmetric numerical matrix, representing the spatial sign covariance matrix, which corresponds to the given shape matrix.
</p>


<h3>References</h3>

<p>Dürre, A., Vogel, D., Fried, R. (2015): Spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 135, 89&ndash;105. 
<a href="http://arxiv.org/abs/1403.7635">arvix 1403.7635</a>
</p>
<p>Dürre, A., Tyler, D. E., Vogel, D. (2016): On the eigenvalues of the spatial sign covariance matrix in more than two dimensions, to appear in: <em>Statistics and Probability Letters</em>. <a href="http://arxiv.org/abs/1512.02863">arvix 1512.02863</a>
</p>


<h3>See Also</h3>

<p>Calculating the theoretical shape from the theoretical SSCM <code><a href="#topic+SSCM2Shape">SSCM2Shape</a></code>
</p>
<p>Calculating the eigenvalues of the SSCM <code><a href="#topic+evShape2evSSCM">evShape2evSSCM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# defining a shape matrix with trace 1
V &lt;- matrix(c(1,0.8,-0.2,0.8,1,0,-0.2,0,1),ncol=3)/3
V

# calculating the related SSCM
SSCM &lt;- Shape2SSCM(V)

# recalculate the shape based on the SSCM
V2 &lt;- SSCM2Shape(SSCM)
V2

# error is negligible
sum(abs(V-V2))
</code></pre>

<hr>
<h2 id='SSCM2Shape'>
Calculation of the shape matrix
</h2><span id='topic+SSCM2Shape'></span>

<h3>Description</h3>

<p><code>SSCM2Shape</code> transforms the spatial sign covariance matrix of an elliptical distribution into its standardized shape matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSCM2Shape(V,itermax=100,tol=10^(-10))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSCM2Shape_+3A_v">V</code></td>
<td>
<p> (required) p x p matrix representing the theoretical SSCM.</p>
</td></tr>
<tr><td><code id="SSCM2Shape_+3A_tol">tol</code></td>
<td>
<p> (optional) numeric, defines the stopping rule of the approximation procedure, see the help of <code><a href="#topic+evSSCM2evShape">evSSCM2evShape</a></code> for details.</p>
</td></tr>
<tr><td><code id="SSCM2Shape_+3A_itermax">itermax</code></td>
<td>
<p> (optional) numeric, defines the maximal number of iterations, see the help of <code><a href="#topic+evSSCM2evShape">evSSCM2evShape</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation consists of three steps. First one calculates eigenvectors and eigenvalues of the SSCM matrix by the function <code>eigen</code>. Then one determines the eigenvalues of the related Shape matrix using the function <code><a href="#topic+evSSCM2evShape">evSSCM2evShape</a></code>. Finally one expands the eigendecomposition consisting of the eigenvectors of the SSCM and the eigenvalues of the shape matrix. The resulting shape matrix is standardized to have a trace of 1. Note that this procedure only works for elliptical distributions.
</p>


<h3>Value</h3>

<p>p x p symmetric numerical matrix, representing the shape matrix with trace 1, which corresponds to the spatial sign covariance matrix.
</p>


<h3>References</h3>

<p>Dürre, A., Vogel, D., Fried, R. (2015): Spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 135, 89&ndash;105. 
<a href="http://arxiv.org/abs/1403.7635">arvix 1403.7635</a>
</p>
<p>Dürre, A., Tyler, D. E., Vogel, D. (2016): On the eigenvalues of the spatial sign covariance matrix in more than two dimensions, to appear in: <em>Statistics and Probability Letters</em>. <a href="http://arxiv.org/abs/1512.02863">arvix 1512.02863</a>
</p>


<h3>See Also</h3>

<p>Calculating the theoretical shape from the theoretical SSCM <code><a href="#topic+SSCM2Shape">SSCM2Shape</a></code>
</p>
<p>Calculating the eigenvalues of the SSCM <code><a href="#topic+evShape2evSSCM">evShape2evSSCM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# defining a shape matrix with trace 1
V &lt;- matrix(c(1,0.8,-0.2,0.8,1,0,-0.2,0,1),ncol=3)/3
V

# calculating the related SSCM
SSCM &lt;- Shape2SSCM(V)

# recalculate the shape based on the SSCM
V2 &lt;- SSCM2Shape(SSCM)
V2

# error is negligible
sum(abs(V-V2))
</code></pre>

<hr>
<h2 id='sscor'>
Spatial sign correlation
</h2><span id='topic+sscor'></span>

<h3>Description</h3>

<p><code>sscor</code> computes a robust correlation matrix estimate based on spatial signs, as described in Dürre et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sscor(X, location=c("2dim-median","1dim-median","pdim-median","mean"),
scale=c("mad","Qn","sd"), standardized=TRUE, pdim=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sscor_+3A_x">X</code></td>
<td>
<p> (required) p x n data matrix, number of colums is the dimension p and the number of rows is the number of observations n.</p>
</td></tr>
<tr><td><code id="sscor_+3A_location">location</code></td>
<td>
<p> (optional) either a p-dimensional numeric vector specifying the location or a character string indicating the location estimator to be used. Possible values are <code>"2dim-median"</code>,<code>"1dim-median"</code>,<code>"pdim-median"</code>,<code>"mean"</code>. The default is <code>"2dim-median"</code>. See details below.</p>
</td></tr>
<tr><td><code id="sscor_+3A_scale">scale</code></td>
<td>
<p> (optional) either a p-dimensional numeric vector specifying the p marginal scales or a character string indicating the scale estimator to be used. Possible values are <code>"mad"</code>,<code>"Qn"</code>,<code>"sd"</code>. The default is  <code>"mad"</code>. See details below.</p>
</td></tr>
<tr><td><code id="sscor_+3A_standardized">standardized</code></td>
<td>
<p> (optional) logical; indicating whether the data should be standardized by marginal scale estimates prior to computing the spatial sign correlation. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="sscor_+3A_pdim">pdim</code></td>
<td>
<p> (optional) logical; indicating whether the correlation matrix consists of pairwise correlation estimates or is estimated at once by the p-dimensional spatial sign correlation, see details.</p>
</td></tr>
<tr><td><code id="sscor_+3A_...">...</code></td>
<td>
<p> (optional) arguments passed to <code><a href="#topic+evSSCM2evShape">evSSCM2evShape</a></code> if <code>pdim=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The spatial sign correlation is a highly robust estimator of the correlation matrix. It is consistent under elliptical distributions for the generalized correlation matrix (derived from the shape matrix instead of the correlation matrix, i.e., it is also defined when second moments are not finite).
</p>
<p>There are two possibilities to calculate this matrix, one can either estimate all pairwise correlations by the two-dimensional spatial sign correlation or calculate the whole matrix at once by the p-dimensional spatial sign correlation. Both approaches have advantages and disadvantages. The first method should be more robust, especially if only some components of the observations are corrupted. Furthermore the consistency transformation is explicitly known only for the bivariate spatial sign correlation, whereas one has to apply an approximation procedure for the p-dimensional one. Additional argments can be passed to this algorithm using the <code>...</code> argument, see the help page of <code><a href="#topic+SSCM2Shape">SSCM2Shape</a></code> for details. On the other hand, the p-dimensional spatial sign correlation is more efficient under the normal distribution and always yields a positive semidefinite estimation.
</p>
<p>The correlation estimator is computed in three steps: the data is standardized marginally, i.e., each variable is divided by a scale estimate. (This step is optional, but recommended, and hence the default.)
Then, if <code>pdim=FALSE</code>, for each pair of variables the 2x2 spatial sign covariance matrix (SSCM) is computed, and then from the SSCM a univariate correlation estimate given by the formulas (5) and (6) in Dürre et al. (2015). These pairwise correlation estimates are the off-diagonal elements of the returned matrix estimate.
Otherwise, if pdim=TRUE, the pxp SSCM is computed, and then from the SSCM an estimator of the correlation matrix, which is done by the function <code><a href="#topic+SSCM2Shape">SSCM2Shape</a></code>, see there for details.
</p>
<p>Scale estimation:
</p>
<p>The scale estimates may either be computed outside the function <code>sscor</code> and passed on to <code>sscor</code> as a p-variate numeric vector, or they may be computed by <code>sscor</code>, using one of the following options: 
</p>
<p><code>"mad"</code>: applies <code><a href="stats.html#topic+mad">mad</a></code> from the standard package <code>stats</code>.  This is the default.
</p>
<p><code>"Qn"</code>: applies <code><a href="robustbase.html#topic+Qn">Qn</a></code> from the package <code>robustbase</code>.
</p>
<p><code>"sd"</code>: applies the standard deviation <code><a href="stats.html#topic+sd">sd</a></code>. 
</p>
<p>Standardizing the data is recommended (and is hence done by default), particularly so if the marginal scales largly differ. In this case, estimation without prior marginal standardization may become inefficient.
</p>
<p>Location estimation:
</p>
<p>The SSCM requires a multivariate location estimate. The location may be computed outside the function <code>sscor</code> and the result passed on to <code>sscor</code> as a p-variate numeric vector. Alternatively it may be computed by <code>sscor</code>, using one of the following options: 
</p>
<p><code>"2dim-median"</code>: two-dimensional spatial median, individually for every 2x2 SSCM. This is the default if <code>pdim=FALSE</code>.
</p>
<p><code>"1dim-median"</code>: the usual, one-dimensional median applied component-wise.
</p>
<p><code>"pdim-median"</code>: the p-dimensional spatial median for all variables. This is the default if <code>pdim=TRUE</code>.
</p>
<p><code>"mean"</code>: the p-dimensional mean. In light of robustness, it is not recommended to use the mean.
</p>
<p>There is no handling of missing values.
</p>


<h3>Value</h3>

<p>p x p symmetric numerical matrix, the diagonal entries are 1, the off-diagonal entries are the pairwise spatial sign correlation estimates.
</p>


<h3>References</h3>

<p>Dürre, A., Vogel, D., Fried, R. (2015): Spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 135, 89&ndash;105. 
<a href="http://arxiv.org/abs/1403.7635">arvix 1403.7635</a>
</p>
<p>Dürre, A., Vogel, D. (2016): Asymptotics of the two-stage spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 144, 54&ndash;67. <a href="http://arxiv.org/abs/1506.02578">arxiv 1506.02578</a>
</p>


<h3>See Also</h3>

<p>Ordinary, non-robust correlation matrix: <code><a href="stats.html#topic+cor">cor</a></code>.
</p>
<p>A number of other robust correlation estimators are provided by the package <code>rrcov</code>.
</p>
<p>Testing for spatial sign correlation: <code><a href="#topic+sscor.test">sscor.test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(5)
X &lt;- cbind(rnorm(25),rnorm(25))
# X is a 25x2 matrix

# cor() and sscor() behave similar under normality
sscor(X)
cor(X)

# but behave differently in the presence of outliers.
X[1,] &lt;- c(10,10)
sscor(X)
cor(X) 

</code></pre>

<hr>
<h2 id='sscor.test'>
Correlation test based on spatial signs
</h2><span id='topic+sscor.test'></span>

<h3>Description</h3>

<p>Robust one-sample test and confidence interval for the correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sscor.test(x, y, rho0=0, alternative=c("two.sided","less","greater"),
conf.level=0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sscor.test_+3A_x">x</code>, <code id="sscor.test_+3A_y">y</code></td>
<td>
<p>(required) numeric vectors of observations, must have the same length.</p>
</td></tr>
<tr><td><code id="sscor.test_+3A_rho0">rho0</code></td>
<td>
<p>(optional) correlation coefficient under the null hypothesis. The default is 0.</p>
</td></tr>
<tr><td><code id="sscor.test_+3A_alternative">alternative</code></td>
<td>
<p>(optional) character string indicating the type of alternative to be tested. Must be one of <code>"two.sided"</code>, <code>"less"</code>, <code>"greater"</code>. The default is <code>"two-sided"</code>.</p>
</td></tr>
<tr><td><code id="sscor.test_+3A_conf.level">conf.level</code></td>
<td>
<p>(optional) confidence level. The default is 0.95.</p>
</td></tr>
<tr><td><code id="sscor.test_+3A_...">...</code></td>
<td>
<p>optional arguments passed to sscor (such as location and scale estimates to be used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is based on the spatial sign correlation (Dürre et al. 2015), which is a highly robust correlation estimator, consistent for the generalized correlation coefficient under ellipticity. The confidence interval and the p-value are based on the asymptotic distribution after a variance-stabilizing transformation similar to Fisher's z-transform. They provide accurate approximations also for very small samples (Dürre and Vogel, 2015).  The test is furthermore distribution-free within the elliptical model.  It has, e.g., the same power at the elliptical Cauchy distribution as at the multivariate Gaussian distribution.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following values (similar to the output of <code>cor.test</code>):
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic. Under the null, the test statistic is (asymptotically) standard normal.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated spatial sign correlation.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the true correlation under the null hypothesis.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a characters string indicating the choosen correlation estimator. Currently only the spatial sign correlation is implemented.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character giving the names of the data.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>confidence interval for the correlation coefficient.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dürre, A., Vogel, D., Fried, R. (2015): Spatial sign correlation, <em>Journal of Multivariate Analyis</em>, vol. 135, 89&ndash;105. 
<a href="http://arxiv.org/abs/1403.7635">arvix 1403.7635</a>
</p>
<p>Dürre, A., Vogel, D. (2015): Asymptotics of the two-stage spatial sign correlation, preprint. <a href="http://arxiv.org/abs/1506.02578">arxiv 1506.02578</a>
</p>


<h3>See Also</h3>

<p>Classical correlation testing: <code><a href="stats.html#topic+cor.test">cor.test</a></code>.
</p>
<p>For more information on the spatial sign correlation: <code><a href="#topic+sscor">sscor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(5)
require(mvtnorm)

# create bivariate shape matrix with correlation 0.5
sigma &lt;- matrix(c(1,0.5,0.5,1),ncol=2)

# under normality, both tests behave similarly
data &lt;- rmvnorm(100,c(0,0),sigma)
x &lt;- data[,1]
y &lt;- data[,2]

sscor.test(x,y)
cor.test(x,y)

# sscor.test also works at a Cauchy distribution
data &lt;- rmvt(100,diag(1,2), df=1)
x &lt;- data[,1]
y &lt;- data[,2]

sscor.test(x,y)
cor.test(x,y)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
