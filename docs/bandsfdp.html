<!DOCTYPE html><html><head><title>Help for package bandsfdp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bandsfdp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gen_bound'><p>Generalized band</p></a></li>
<li><a href='#sim_bound'><p>Simultaneous Band</p></a></li>
<li><a href='#tdc_sb'><p>Standardized Band</p></a></li>
<li><a href='#tdc_ub'><p>Uniform Band</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Compute Upper Prediction Bounds on the FDP in Competition-Based
Setups</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>fdpbandsdata</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements functions that calculate upper prediction 
  bounds on the false discovery proportion (FDP) in the list of discoveries 
  returned by competition-based setups, implementing Ebadi et al. (2022)
  &lt;<a href="https://arxiv.org/abs/2302.11837">arXiv:2302.11837</a>&gt;. Such setups include target-decoy competition (TDC) 
  in computational mass spectrometry and the knockoff construction in linear 
  regression (note this package typically uses the terminology of TDC). Included 
  is the standardized (TDC-SB) and uniform (TDC-UB) bound on TDC's FDP, and the 
  simultaneous standardized and uniform bands. Requires 
  pre-computed Monte Carlo statistics available at 
  <a href="https://github.com/uni-Arya/fdpbandsdata">https://github.com/uni-Arya/fdpbandsdata</a>. This data can be downloaded by
  running the command 'devtools::install_github("uni-Arya/fdpbandsdata")' in R
  and restarting R after installation. The size of this data is roughly 81Mb.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/uni-Arya/bandsfdp">https://github.com/uni-Arya/bandsfdp</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/uni-Arya/bandsfdp/issues">https://github.com/uni-Arya/bandsfdp/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-12 06:44:34 UTC; aeba3842</td>
</tr>
<tr>
<td>Author:</td>
<td>Arya Ebadi [aut, cre],
  Dong Luo [aut],
  Jack Freestone [aut],
  William Stafford Noble [aut],
  Uri Keich <a href="https://orcid.org/0000-0002-3209-5011"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arya Ebadi &lt;aeba3842@uni.sydney.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-12 07:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='gen_bound'>Generalized band</h2><span id='topic+gen_bound'></span><span id='topic+genband'></span>

<h3>Description</h3>

<p>This function computes an upper prediction bound on the FDP among target wins
in any set <code class="reqn">R</code> of hypotheses of TDC. See details for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_bound(
  labels,
  indices,
  gamma,
  type,
  d_max = NULL,
  max_fdp = 0.5,
  c = 0.5,
  lambda = 0.5
)

genband(
  labels,
  indices,
  gamma,
  type,
  d_max = NULL,
  max_fdp = 0.5,
  c = 0.5,
  lambda = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_bound_+3A_labels">labels</code></td>
<td>
<p>A vector of (ordered) labels. See details below.</p>
</td></tr>
<tr><td><code id="gen_bound_+3A_indices">indices</code></td>
<td>
<p>A vector specifying the indices of hypotheses for which an
upper prediction bound on the FDP is computed.</p>
</td></tr>
<tr><td><code id="gen_bound_+3A_gamma">gamma</code></td>
<td>
<p>The confidence parameter of the band. Typical values include
<code>gamma = 0.05</code> or <code>gamma = 0.01</code>.</p>
</td></tr>
<tr><td><code id="gen_bound_+3A_type">type</code></td>
<td>
<p>A character string specifying which band to use. Must be one of
<code>"stband"</code> or <code>"uniband"</code>.</p>
</td></tr>
<tr><td><code id="gen_bound_+3A_d_max">d_max</code></td>
<td>
<p>An optional positive integer specifying the maximum number
of decoy wins considered in calculating the bands.</p>
</td></tr>
<tr><td><code id="gen_bound_+3A_max_fdp">max_fdp</code></td>
<td>
<p>A number specifying the maximum FDP considered by the user in
calculating the bands. Used to compute <code>d_max</code> if <code>d_max</code> is
set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gen_bound_+3A_c">c</code></td>
<td>
<p>Determines the ranks of the target score that are considered
winning. Defaults to <code>c = 0.5</code> for (single-decoy) TDC.</p>
</td></tr>
<tr><td><code id="gen_bound_+3A_lambda">lambda</code></td>
<td>
<p>Determines the ranks of the target score that are
considered losing. Defaults to <code>lambda = 0.5</code> for (single-decoy) TDC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In (single-decoy) TDC, each hypothesis is associated to a
winning score and a label (1 for a target win, -1 for a decoy win). This
function assumes that the hypotheses are ordered in decreasing order of
winning scores (with ties broken at random). The argument <code>labels</code>,
therefore, must be ordered according to this rule.
</p>
<p>This function also supports the extension of TDC that uses multiple
decoys. In that setup, the target score is competed with multiple decoy
scores and the rank of the target score after competition is used to determine whether the
hypothesis is a target win (label = 1), decoy win (-1) or uncounted (0).
The top <code>c</code> proportion of ranks are considered winning, the bottom
<code>1-lambda</code> losing, and all the rest uncounted.
</p>
<p>The threshold of TDC is given by the formula (assuming hypotheses are ordered):
</p>
<p style="text-align: center;"><code class="reqn">\max\{k : \frac{D_k + 1}{T_k \vee 1} \cdot \frac{c}{1-\lambda} \leq \alpha\}</code>
</p>

<p>where <code class="reqn">T_k</code> is the number of target wins among the top
<code class="reqn">k</code> hypotheses, and <code class="reqn">D_k</code> is the number of decoy wins similarly.
</p>
<p>The argument <code>gamma</code> sets a confidence level of <code>1-gamma</code>. Both
the uniform and standardized bands require pre-computed Monte Carlo
statistics, so only certain values of <code>gamma</code> are available to use.
Commonly used confidence levels, like 0.95 and 0.99, are available.
We refer the reader to the README of this package for more details.
</p>
<p>The argument <code>d_max</code> controls the rate at which the returned bounds
increase: a larger <code>d_max</code> results in a more conservative bound.
If, however, <code class="reqn">D_k + 1</code> exceeds <code>d_max</code> for some index <code class="reqn">k</code>, each target
win thereafter is considered a false discovery when computing the bound.
Thus it is important that <code>d_max</code>, chosen a priori, is large enough. Given
it is sufficiently large, the precise value of <code>d_max</code> does not have a
significant effect on the resulting bounds (see <a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a> for more details).
</p>
<p>We recommend setting <code>d_max = NULL</code> so that it is computed automatically
using <code>max_fdp</code>. This argument ensures that <code class="reqn">D_k + 1</code> never
exceeds <code>d_max</code> when the (non-interpolated) FDP bound on the top
<code class="reqn">k</code> hypotheses is less than <code>max_fdp</code>.
</p>


<h3>Value</h3>

<p>An upper prediction bound on the FDP among target wins in the set of
hypotheses whose <code>indices</code> are given as input.
</p>


<h3>References</h3>

<p>Ebadi et al. (2022), Bounding the FDP in competition-based
control of the FDR <a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("fdpbandsdata", quietly = TRUE)) {
  set.seed(123)
  labels &lt;- c(
    rep(1, 250),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.9, 0.1)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.5, 0.5)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.1, 0.9))
  )
  indices &lt;- c(1:100, 300:400, 600:650)
  gamma &lt;- 0.05
  gen_bound(labels, indices, gamma, "stband")
}

</code></pre>

<hr>
<h2 id='sim_bound'>Simultaneous Band</h2><span id='topic+sim_bound'></span><span id='topic+simband'></span>

<h3>Description</h3>

<p>This function computes upper prediction bounds on the target wins among the
top <code class="reqn">k</code> hypotheses of TDC, for each <code class="reqn">k = 1,\ldots,n</code> where <code class="reqn">n</code>
is the total number of hypotheses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_bound(
  labels,
  gamma,
  type,
  d_max = NULL,
  max_fdp = 0.5,
  c = 0.5,
  lambda = 0.5
)

simband(
  labels,
  gamma,
  type,
  d_max = NULL,
  max_fdp = 0.5,
  c = 0.5,
  lambda = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_bound_+3A_labels">labels</code></td>
<td>
<p>A vector of (ordered) labels. See details below.</p>
</td></tr>
<tr><td><code id="sim_bound_+3A_gamma">gamma</code></td>
<td>
<p>The confidence parameter of the band. Typical values include
<code>gamma = 0.05</code> or <code>gamma = 0.01</code>.</p>
</td></tr>
<tr><td><code id="sim_bound_+3A_type">type</code></td>
<td>
<p>A character string specifying which band to use. Must be one of
<code>"stband"</code> or <code>"uniband"</code>.</p>
</td></tr>
<tr><td><code id="sim_bound_+3A_d_max">d_max</code></td>
<td>
<p>An optional positive integer specifying the maximum number
of decoy wins considered in calculating the bands.</p>
</td></tr>
<tr><td><code id="sim_bound_+3A_max_fdp">max_fdp</code></td>
<td>
<p>A number specifying the maximum FDP considered by the user in
calculating the bands. Used to compute <code>d_max</code> if <code>d_max</code> is
set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="sim_bound_+3A_c">c</code></td>
<td>
<p>Determines the ranks of the target score that are considered
winning. Defaults to <code>c = 0.5</code> for (single-decoy) TDC.</p>
</td></tr>
<tr><td><code id="sim_bound_+3A_lambda">lambda</code></td>
<td>
<p>Determines the ranks of the target score that are
considered losing. Defaults to <code>lambda = 0.5</code> for (single-decoy) TDC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In (single-decoy) TDC, each hypothesis is associated to a
winning score and a label (1 for a target win, -1 for a decoy win). This
function assumes that the hypotheses are ordered in decreasing order of
winning scores (with ties broken at random). The argument <code>labels</code>,
therefore, must be ordered according to this rule.
</p>
<p>This function also supports the extension of TDC that uses multiple
decoys. In that setup, the target score is competed with multiple decoy
scores and the rank of the target score after competition is used to determine whether the
hypothesis is a target win (label = 1), decoy win (-1) or uncounted (0).
The top <code>c</code> proportion of ranks are considered winning, the bottom
<code>1-lambda</code> losing, and all the rest uncounted.
</p>
<p>The threshold of TDC is given by the formula (assuming hypotheses are ordered):
</p>
<p style="text-align: center;"><code class="reqn">\max\{k : \frac{D_k + 1}{T_k \vee 1} \cdot \frac{c}{1-\lambda} \leq \alpha\}</code>
</p>

<p>where <code class="reqn">T_k</code> is the number of target wins among the top
<code class="reqn">k</code> hypotheses, and <code class="reqn">D_k</code> is the number of decoy wins similarly.
</p>
<p>The argument <code>gamma</code> sets a confidence level of <code>1-gamma</code>. Both
the uniform and standardized bands require pre-computed Monte Carlo
statistics, so only certain values of <code>gamma</code> are available to use.
Commonly used confidence levels, like 0.95 and 0.99, are available.
We refer the reader to the README of this package for more details.
</p>
<p>The argument <code>d_max</code> controls the rate at which the returned bounds
increase: a larger <code>d_max</code> results in a more conservative bound.
If, however, <code class="reqn">D_k + 1</code> exceeds <code>d_max</code> for some index <code class="reqn">k</code>, each target
win thereafter is considered a false discovery when computing the bound.
Thus it is important that <code>d_max</code>, chosen a priori, is large enough. Given
it is sufficiently large, the precise value of <code>d_max</code> does not have a
significant effect on the resulting bounds (see <a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a> for more details).
</p>
<p>We recommend setting <code>d_max = NULL</code> so that it is computed automatically
using <code>max_fdp</code>. This argument ensures that <code class="reqn">D_k + 1</code> never
exceeds <code>d_max</code> when the (non-interpolated) FDP bound on the top
<code class="reqn">k</code> hypotheses is less than <code>max_fdp</code>.
</p>


<h3>Value</h3>

<p>A vector of upper prediction bounds on the FDP of target wins among
the top <code class="reqn">k</code> hypotheses for each <code class="reqn">k = 1,\ldots,n</code> where <code class="reqn">n</code>
is the total number of hypotheses.
</p>


<h3>References</h3>

<p>Ebadi et al. (2022), Bounding the FDP in competition-based
control of the FDR <a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("fdpbandsdata", quietly = TRUE)) {
  set.seed(123)
  labels &lt;- c(
    rep(1, 250),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.9, 0.1)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.5, 0.5)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.1, 0.9))
  )
  gamma &lt;- 0.05
  head(sim_bound(labels, gamma, "stband"))
}

</code></pre>

<hr>
<h2 id='tdc_sb'>Standardized Band</h2><span id='topic+tdc_sb'></span><span id='topic+stband'></span>

<h3>Description</h3>

<p>This function computes an upper prediction bound, derived from the
standardized band, on the FDP in TDC's list of discoveries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdc_sb(
  thresholds,
  labels,
  alpha,
  gamma,
  c = 0.5,
  lambda = 0.5,
  n = length(labels),
  interpolate = TRUE
)

stband(
  thresholds,
  labels,
  alpha,
  gamma,
  c = 0.5,
  lambda = 0.5,
  n = length(labels),
  interpolate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tdc_sb_+3A_thresholds">thresholds</code></td>
<td>
<p>The rejection threshold of TDC. If given as
a vector, an upper prediction bound is returned for each element.</p>
</td></tr>
<tr><td><code id="tdc_sb_+3A_labels">labels</code></td>
<td>
<p>A vector of (ordered) labels. See details below.</p>
</td></tr>
<tr><td><code id="tdc_sb_+3A_alpha">alpha</code></td>
<td>
<p>The FDR threshold.</p>
</td></tr>
<tr><td><code id="tdc_sb_+3A_gamma">gamma</code></td>
<td>
<p>The confidence parameter of the bound. Typical values include
<code>gamma = 0.05</code> or <code>gamma = 0.01</code>.</p>
</td></tr>
<tr><td><code id="tdc_sb_+3A_c">c</code></td>
<td>
<p>Determines the ranks of the target score that are considered
winning. Defaults to <code>c = 0.5</code> for (single-decoy) TDC.</p>
</td></tr>
<tr><td><code id="tdc_sb_+3A_lambda">lambda</code></td>
<td>
<p>Determines the ranks of the target score that are
considered losing. Defaults to <code>lambda = 0.5</code> for (single-decoy) TDC.</p>
</td></tr>
<tr><td><code id="tdc_sb_+3A_n">n</code></td>
<td>
<p>The number of hypotheses. Defaults to the length of <code>labels</code>.</p>
</td></tr>
<tr><td><code id="tdc_sb_+3A_interpolate">interpolate</code></td>
<td>
<p>A boolean indicating whether the bands should be
interpolated. Offers a slight boost in performance at the cost of computing
power. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In (single-decoy) TDC, each hypothesis is associated to a
winning score and a label (1 for a target win, -1 for a decoy win). This
function assumes that the hypotheses are ordered in decreasing order of
winning scores (with ties broken at random). The argument <code>labels</code>,
therefore, must be ordered according to this rule.
</p>
<p>This function also supports the extension of TDC that uses multiple
decoys. In that setup, the target score is competed with multiple decoy
scores and the rank of the target score after competition is used to determine whether the
hypothesis is a target win (label = 1), decoy win (-1) or uncounted (0).
The top <code>c</code> proportion of ranks are considered winning, the bottom
<code>1-lambda</code> losing, and all the rest uncounted.
</p>
<p>The threshold of TDC is given by the formula:
</p>
<p style="text-align: center;"><code class="reqn">\max\{k : \frac{D_k + 1}{T_k \vee 1} \cdot \frac{c}{1-\lambda} \leq \alpha\}</code>
</p>

<p>where <code class="reqn">T_k</code> is the number of target wins among the top
<code class="reqn">k</code> hypotheses, and <code class="reqn">D_k</code> is the number of decoy wins similarly.
</p>
<p>The argument <code>gamma</code> sets a confidence level of <code>1-gamma</code>. Since
the standardized band requires pre-computed Monte Carlo quantiles, only
certain values of <code>gamma</code> are available to use. Commonly used
confidence levels, like 0.95 and 0.99, are available. We refer the reader
to the README of this package for more details.
</p>
<p>The argument <code>alpha</code>, used to compute the threshold of TDC, is also
used in this function. It serves to compute an appropriate d_max
for a non-trivial bound. In particular, if the user inputs a vector of
<code>thresholds</code>, a bound is returned for each element of
<code>thresholds</code> using the same d_max. For more details, see:
<a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a>.
</p>
<p>We recommend the use of <code>interpolate = TRUE</code> (default), as it generally
results in a tighter bound. This comes at the cost of performance: the bound
for each threshold is computed in O(n) time with interpolation and O(1)
without.
</p>


<h3>Value</h3>

<p>An upper prediction bound on the FDP in TDC's list of discoveries.
If <code>thresholds</code> is a vector, returns an upper prediction bound for each
element of <code>thresholds</code>.
</p>


<h3>References</h3>

<p>Ebadi et al. (2022), Bounding the FDP in competition-based
control of the FDR <a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("fdpbandsdata", quietly = TRUE)) {
  set.seed(123)
  thresholds &lt;- c(250, 500, 750, 1000)
  labels &lt;- c(
    rep(1, 250),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.9, 0.1)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.5, 0.5)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.1, 0.9))
  )
  alpha &lt;- 0.05
  gamma &lt;- 0.05
  tdc_sb(thresholds, labels, alpha, gamma)
}

</code></pre>

<hr>
<h2 id='tdc_ub'>Uniform Band</h2><span id='topic+tdc_ub'></span><span id='topic+uniband'></span>

<h3>Description</h3>

<p>This function computes an upper prediction bound, derived from the
uniform band, on the FDP in TDC's list of discoveries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdc_ub(
  thresholds,
  labels,
  alpha,
  gamma,
  c = 0.5,
  lambda = 0.5,
  n = length(labels),
  interpolate = TRUE
)

uniband(
  thresholds,
  labels,
  alpha,
  gamma,
  c = 0.5,
  lambda = 0.5,
  n = length(labels),
  interpolate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tdc_ub_+3A_thresholds">thresholds</code></td>
<td>
<p>The rejection threshold of TDC. If given as
a vector, an upper prediction bound is returned for each element.</p>
</td></tr>
<tr><td><code id="tdc_ub_+3A_labels">labels</code></td>
<td>
<p>A vector of (ordered) labels. See details below.</p>
</td></tr>
<tr><td><code id="tdc_ub_+3A_alpha">alpha</code></td>
<td>
<p>The FDR threshold.</p>
</td></tr>
<tr><td><code id="tdc_ub_+3A_gamma">gamma</code></td>
<td>
<p>The confidence parameter of the bound. Typical values include
<code>gamma = 0.05</code> or <code>gamma = 0.01</code>.</p>
</td></tr>
<tr><td><code id="tdc_ub_+3A_c">c</code></td>
<td>
<p>Determines the ranks of the target score that are considered
winning. Defaults to <code>c = 0.5</code> for (single-decoy) TDC.</p>
</td></tr>
<tr><td><code id="tdc_ub_+3A_lambda">lambda</code></td>
<td>
<p>Determines the ranks of the target score that are
considered losing. Defaults to <code>lambda = 0.5</code> for (single-decoy) TDC.</p>
</td></tr>
<tr><td><code id="tdc_ub_+3A_n">n</code></td>
<td>
<p>The number of hypotheses. Defaults to the length of <code>labels</code>.</p>
</td></tr>
<tr><td><code id="tdc_ub_+3A_interpolate">interpolate</code></td>
<td>
<p>A boolean indicating whether the bands should be
interpolated. Offers a slight boost in performance at the cost of computing
power. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In (single-decoy) TDC, each hypothesis is associated to a
winning score and a label (1 for a target win, -1 for a decoy win). This
function assumes that the hypotheses are ordered in decreasing order of
winning scores (with ties broken at random). The argument <code>labels</code>,
therefore, must be ordered according to this rule.
</p>
<p>This function also supports the extension of TDC that uses multiple
decoys. In that setup, the target score is competed with multiple decoy
scores and the rank of the target score after competition is used to determine whether the
hypothesis is a target win (label = 1), decoy win (-1) or uncounted (0).
The top <code>c</code> proportion of ranks are considered winning, the bottom
<code>1-lambda</code> losing, and all the rest uncounted.
</p>
<p>The threshold of TDC is given by the formula:
</p>
<p style="text-align: center;"><code class="reqn">\max\{k : \frac{D_k + 1}{T_k \vee 1} \cdot \frac{c}{1-\lambda} \leq \alpha\}</code>
</p>

<p>where <code class="reqn">T_k</code> is the number of target wins among the top
<code class="reqn">k</code> hypotheses, and <code class="reqn">D_k</code> is the number of decoy wins similarly.
</p>
<p>The argument <code>gamma</code> sets a confidence level of <code>1-gamma</code>. Since
the uniform band requires pre-computed Monte Carlo statistics, only
certain values of <code>gamma</code> are available to use. Commonly used
confidence levels, like 0.95 and 0.99, are available. We refer the reader
to the README of this package for more details.
</p>
<p>The argument <code>alpha</code>, used to compute the threshold of TDC, is also
used in this function. It serves to compute an appropriate d_max
for a non-trivial bound. In particular, if the user inputs a vector of
<code>thresholds</code>, a bound is returned for each element of
<code>thresholds</code> using the same d_max. For more details, see:
<a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a>.
</p>
<p>We recommend the use of <code>interpolate = TRUE</code> (default), as it generally
results in a tighter bound. This comes at the cost of performance: the bound
for each threshold is computed in O(n) time with interpolation and O(1)
without.
</p>


<h3>Value</h3>

<p>An upper prediction bound on the FDP in TDC's list of discoveries.
If <code>thresholds</code> is a vector, returns an upper prediction bound for each
element of <code>thresholds</code>.
</p>


<h3>References</h3>

<p>Ebadi et al. (2022), Bounding the FDP in competition-based
control of the FDR <a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("fdpbandsdata", quietly = TRUE)) {
  set.seed(123)
  thresholds &lt;- c(250, 500, 750, 1000)
  labels &lt;- c(
    rep(1, 250),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.9, 0.1)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.5, 0.5)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.1, 0.9))
  )
  alpha &lt;- 0.05
  gamma &lt;- 0.05
  tdc_ub(thresholds, labels, alpha, gamma)
}

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
