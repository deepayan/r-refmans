<!DOCTYPE html><html lang="en"><head><title>Help for package csmpv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {csmpv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confirmVars'><p>Biomarker Confirmation Function</p></a></li>
<li><a href='#csmpvModelling'><p>All-in-one Modelling with csmpv R package</p></a></li>
<li><a href='#datlist'><p>This is an example data in csmpv</p></a></li>
<li><a href='#LASSO_plus'><p>LASSO_plus Variable Selection and Modeling</p></a></li>
<li><a href='#LASSO_plus_XGBtraining'><p>LASSO_plus_XGBtraining: Variable Selection and XGBoost Modeling</p></a></li>
<li><a href='#LASSO2'><p>Variable Selection using Modified LASSO with a Minimum of Two Remaining Variables</p></a></li>
<li><a href='#LASSO2_predict'><p>Predict and Validate LASSO2 Model Scores</p></a></li>
<li><a href='#LASSO2_reg'><p>LASSO2 Variable Selection and Regular Regression Modeling</p></a></li>
<li><a href='#LASSO2_XGBtraining'><p>Variable Selection with LASSO2 and Modeling with XGBoost</p></a></li>
<li><a href='#LASSO2plus'><p>Variable Selection and Modeling with LASSO2plus</p></a></li>
<li><a href='#LASSO2plus_XGBtraining'><p>XGBoost Modeling after Variable Selection with LASSO2plus</p></a></li>
<li><a href='#rms_model'><p>A Wrapper for Building Predictive Models using the rms Package</p></a></li>
<li><a href='#validation'><p>Validate Model Predictions</p></a></li>
<li><a href='#XGBtraining'><p>A Wrapper Function for xgboost::xgboost</p></a></li>
<li><a href='#XGBtraining_predict'><p>Predicting XGBoost Model Scores and Performing Validation</p></a></li>
<li><a href='#XGpred'><p>XGpred: Building Risk Classification Predictive Models using Survival Data</p></a></li>
<li><a href='#XGpred_predict'><p>Predicting Risk Group Classification for a New Data Set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Biomarker Confirmation, Selection, Modelling, Prediction, and
Validation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Aixiang Jiang [aut, cre, cph] (&lt;https://orcid.org/0000-0002-6153-7595&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aixiang Jiang &lt;aijiang@bccrc.ca&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0), stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, glmnet, Hmisc, rms, forestmodel, ggplot2, ggpubr,
survminer, xgboost, scales, Matrix</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, devtools</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>
   There are diverse purposes such as biomarker confirmation, novel biomarker discovery, constructing predictive models, model-based prediction, and validation. 
   It handles binary, continuous, and time-to-event outcomes at the sample or patient level.
   - Biomarker confirmation utilizes established functions like glm() from 'stats', coxph() from 'survival', surv_fit(), and ggsurvplot() from 'survminer'.
   - Biomarker discovery and variable selection are facilitated by three LASSO-related functions LASSO2(), LASSO_plus(), and LASSO2plus(), leveraging the 'glmnet' R package with additional steps.
   - Eight versatile modeling functions are offered, each designed for predictive models across various outcomes and data types.
     1) LASSO2(), LASSO_plus(), LASSO2plus(), and LASSO2_reg() perform variable selection using LASSO methods and construct predictive models based on selected variables.
     2) XGBtraining() employs 'XGBoost' for model building and is the only function not involving variable selection.
     3) Functions like LASSO2_XGBtraining(), LASSOplus_XGBtraining(), and LASSO2plus_XGBtraining() combine LASSO-related variable selection with 'XGBoost' for model construction.
   - All models support prediction and validation, requiring a testing dataset comparable to the training dataset.
   Additionally, the package introduces XGpred() for risk prediction based on survival data, with the XGpred_predict() function available for predicting risk groups in new datasets.
   The methodology is based on our new algorithms and various references:
   - Hastie et al. (1992, ISBN 0 534 16765-9), 
   - Therneau et al. (2000, ISBN 0-387-98784-3), 
   - Kassambara et al. (2021) <a href="https://CRAN.R-project.org/package=survminer">https://CRAN.R-project.org/package=survminer</a>,
   - Friedman et al. (2010) &lt;<a href="https://doi.org/10.18637%2Fjss.v033.i01">doi:10.18637/jss.v033.i01</a>&gt;,
   - Simon et al. (2011) &lt;<a href="https://doi.org/10.18637%2Fjss.v039.i05">doi:10.18637/jss.v039.i05</a>&gt;,
   - Harrell (2023) <a href="https://CRAN.R-project.org/package=rms">https://CRAN.R-project.org/package=rms</a>,
   - Harrell (2023) <a href="https://CRAN.R-project.org/package=Hmisc">https://CRAN.R-project.org/package=Hmisc</a>,
   - Chen and Guestrin (2016) &lt;<a href="https://doi.org/10.48550/arXiv.1603.02754">doi:10.48550/arXiv.1603.02754</a>&gt;,
   - Aoki et al. (2023) &lt;<a href="https://doi.org/10.1200%2FJCO.23.01115">doi:10.1200/JCO.23.01115</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-01 17:04:24 UTC; aijiang</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-01 18:12:44 UTC</td>
</tr>
</table>
<hr>
<h2 id='confirmVars'>Biomarker Confirmation Function</h2><span id='topic+confirmVars'></span>

<h3>Description</h3>

<p>This function confirms and validates known biomarkers in a given dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confirmVars(
  data = NULL,
  standardization = FALSE,
  columnWise = TRUE,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confirmVars_+3A_data">data</code></td>
<td>
<p>A data matrix or data frame with samples in rows and features/traits (including outcome and biomarkers) in columns.</p>
</td></tr>
<tr><td><code id="confirmVars_+3A_standardization">standardization</code></td>
<td>
<p>Logical; indicates if standardization is needed before biomarker confirmation/validation. Default is FALSE.</p>
</td></tr>
<tr><td><code id="confirmVars_+3A_columnwise">columnWise</code></td>
<td>
<p>Logical; indicates if column-wise or row-wise normalization is needed for standardization. Default is TRUE.</p>
</td></tr>
<tr><td><code id="confirmVars_+3A_biomks">biomks</code></td>
<td>
<p>A vector of biomarker names to confirm/validate. Subset of column names in the data parameter.</p>
</td></tr>
<tr><td><code id="confirmVars_+3A_outcometype">outcomeType</code></td>
<td>
<p>The type of the outcome variable. It has three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="confirmVars_+3A_y">Y</code></td>
<td>
<p>The outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="confirmVars_+3A_time">time</code></td>
<td>
<p>The time variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="confirmVars_+3A_event">event</code></td>
<td>
<p>The event variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="confirmVars_+3A_outfile">outfile</code></td>
<td>
<p>A string representing the output file, including the path if necessary, but without the file type extension</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use this function to assess whether individual variables or groups of variables
have an impact on an outcome variable within a dataset. The outcome variable can be binary,
continuous, or time-to-event. Note that this function is not intended for model confirmation,
as it doesn't incorporate coefficients from previous research.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>fit</code></td>
<td>
<p>A model with selected variables for the given outcome variable.</p>
</td></tr>
<tr><td><code>allplot</code></td>
<td>
<p>A list of plots generated during the confirmation/validation process.</p>
</td></tr>
</table>
<p>There might be extra plots in the list for time-to-event outcome
</p>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Hastie, T. J. and Pregibon, D. (1992) Generalized linear models. Chapter 6 of Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
<p>Therneau, T., Grambsch, P., Modeling Survival Data: Extending the Cox Model. Springer-Verlag, 2000.
</p>
<p>Kassambara A, Kosinski M, Biecek P (2021). survminer: Drawing Survival Curves using 'ggplot2', R package version 0.4.9,
&lt;https://CRAN.R-project.org/package=survminer&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The confirmVars function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()

# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI","B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")

# confirmVars can work with three different outcome types. 
# Here, we use binary as an example:
bconfirm = confirmVars(data = tdat, biomks = Xvars, Y = "DZsig",
                        outfile = paste0(temp_dir, "/confirmBinary"))
# You might save the files to the directory you want.

# To delete the temp_dir, use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='csmpvModelling'>All-in-one Modelling with csmpv R package</h2><span id='topic+csmpvModelling'></span>

<h3>Description</h3>

<p>This function is designed to simplify the process of building, evaluating and comparing different modelling methods. It offers the flexibility to perform one 
or all of the following modelling methods: LASSO2, LASSO2 + regression, LASSO_plus, LASSO2plus, XGBoost, LASSO2 + XGBoost, LASSO_plus + XGBoost, 
and LASSO2plus + XGBoost. The models are trained on the training data, and their performance is validated on a separate validation dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csmpvModelling(
  tdat = NULL,
  vdat = NULL,
  Ybinary = NULL,
  varsBinary = NULL,
  Ycont = NULL,
  varsCont = NULL,
  time = NULL,
  event = NULL,
  varsSurvival = NULL,
  methods = c("all", "LASSO2", "LASSO2_reg", "LASSO_plus", "LASSO2plus", "XGBoost",
    "LASSO2_XGBoost", "LASSO_plus_XGBoost", "LASSO2plus_XGBoost"),
  outfileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csmpvModelling_+3A_tdat">tdat</code></td>
<td>
<p>Training data. It can not be null.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_vdat">vdat</code></td>
<td>
<p>Validation data. It should contain the same variables as in the training data, including outcome variables. No validation result is saved if it is NULL.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_ybinary">Ybinary</code></td>
<td>
<p>Binary outcome variable for classification.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_varsbinary">varsBinary</code></td>
<td>
<p>Names of binary predictors.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_ycont">Ycont</code></td>
<td>
<p>Continuous outcome variable for regression.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_varscont">varsCont</code></td>
<td>
<p>Names of continuous predictors.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_time">time</code></td>
<td>
<p>Time-to-event variable for survival analysis.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_event">event</code></td>
<td>
<p>Event/censoring indicator for survival analysis.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_varssurvival">varsSurvival</code></td>
<td>
<p>Names of predictors for survival analysis.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_methods">methods</code></td>
<td>
<p>Method(s) to use for modeling. If &quot;all,&quot; models for all eight methods will be built. 
Otherwise, provide one of the following method names:
- &quot;LASSO2&quot;: Variable selection using LASSO2 with a minimum of two remaining variables.
- &quot;LASSO2_reg&quot;: Variables selected from LASSO2, followed by regular regression.
- &quot;LASSO_plus&quot;: Variables selected from LASSO_plus, followed by regular regression.
- &quot;LASSO2plus&quot;: Variables selected from LASSO2plus, followed by regular regression.
- &quot;XGBoost&quot;: XGBoost model built without variable selection.
- &quot;LASSO2_XGBoost&quot;: Variables selected from LASSO2, followed by XGBoost.
- &quot;LASSO_plus_XGBoost&quot;: Variables selected from LASSO_plus, followed by XGBoost.
- &quot;LASSO2plus_XGBoost&quot;: Variables selected from LASSO2plus, followed by XGBoost.</p>
</td></tr>
<tr><td><code id="csmpvModelling_+3A_outfilename">outfileName</code></td>
<td>
<p>Prefix for output file names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, this function runs all eight different modeling methods. However, users can specify the &quot;methods&quot; parameter to choose and run a specific modelling 
method of their choice. For clarity, when providing a 'vdat' argument, the function assumes that it contains the outcome variable, and it proceeds with model validation.
</p>


<h3>Value</h3>

<p>A list of trained models and prediction objects. Results are saved to local files.
</p>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training
vdat = datlist$validation

# The confirmVars function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()

# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# The default setting of this single function generates all models and provides predictions
# and validations for each of them. 
# Of course, we can also use this all-in-one function to work on one outcome type 
# and one model at a time, for example:
DZlassoreg = csmpvModelling(tdat = tdat, vdat = vdat,
                           Ybinary = "DZsig", varsBinary = Xvars,
                           methods = "LASSO2_reg",
                           outfileName= paste0(temp_dir, "/just_one"))
# This is equivalent to using LASSO2_reg for modeling, followed by prediction and validation 
# with rms_model for the classification task "DZsig".
# Six result files are then saved locally.
# You might want to save the files to the directory you prefer.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='datlist'>This is an example data in csmpv</h2><span id='topic+datlist'></span>

<h3>Description</h3>

<p>This dataset contains sample data for csmpv.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datlist
</code></pre>


<h3>Format</h3>

<p>A list with training and a validation datasets.
</p>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>

<hr>
<h2 id='LASSO_plus'>LASSO_plus Variable Selection and Modeling</h2><span id='topic+LASSO_plus'></span>

<h3>Description</h3>

<p>This function performs variable selection using the LASSO_plus algorithm and builds a model afterward.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LASSO_plus(
  data = NULL,
  standardization = FALSE,
  columnWise = TRUE,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  topN = 10,
  outfile = "nameWithPath",
  height = 6
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LASSO_plus_+3A_data">data</code></td>
<td>
<p>A data matrix or a data frame, samples are in rows, and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_standardization">standardization</code></td>
<td>
<p>A logic variable to indicate if standardization is needed before variable selection, the default is FALSE.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_columnwise">columnWise</code></td>
<td>
<p>A logic variable to indicate if column wise or row wise normalization is needed, the default is TRUE, which is to do column-wise normalization. 
This is only meaningful when &quot;standardization&quot; is TRUE.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_biomks">biomks</code></td>
<td>
<p>A vector of potential biomarkers for variable selection, they should be a subset of &quot;data&quot; column names.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_outcometype">outcomeType</code></td>
<td>
<p>Outcome variable type. There are three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_y">Y</code></td>
<td>
<p>Outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_time">time</code></td>
<td>
<p>Time variable name when outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_event">event</code></td>
<td>
<p>Event variable name when outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_topn">topN</code></td>
<td>
<p>An integer indicating the desired number of variables to be selected.</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_outfile">outfile</code></td>
<td>
<p>A string representing the output file, including the path if necessary, but without the file type extension</p>
</td></tr>
<tr><td><code id="LASSO_plus_+3A_height">height</code></td>
<td>
<p>An integer to indicate the forest plot height in inches</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LASSO_plus algorithm combines LASSO, single variable regression, and stepwise regression
to select variables associated with an outcome variable in a given dataset. The outcome variable can be binary, 
continuous, or time-to-event. After variable selection, a model is built using common R functions such as lm, glm, 
and coxph, depending on the outcome type.
</p>


<h3>Value</h3>

<p>A list is returned: 
</p>
<table role = "presentation">
<tr><td><code>fit</code></td>
<td>
<p>A model with selected variables for the given outcome variable</p>
</td></tr>
<tr><td><code>outplot</code></td>
<td>
<p>A forest plot</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for Generalized Linear Models via Coordinate Descent (2010), Journal of Statistical Software, Vol. 33(1), 1-22, doi:10.18637/jss.v033.i01.
</p>
<p>Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011) Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol. 39(5), 1-13, doi:10.18637/jss.v039.i05.
</p>
<p>Hastie, T. J. and Pregibon, D. (1992) Generalized linear models. Chapter 6 of Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
<p>Therneau, T., Grambsch, P., Modeling Survival Data: Extending the Cox Model. Springer-Verlag, 2000.
</p>
<p>Kassambara A, Kosinski M, Biecek P (2021). survminer: Drawing Survival Curves using 'ggplot2', R package version 0.4.9,
&lt;https://CRAN.R-project.org/package=survminer&gt;.
</p>
<p>Aoki T, Jiang A, Xu A et al.,(2023) Spatially Resolved Tumor Microenvironment Predicts Treatment Outcomes in Relapsed/Refractory Hodgkin Lymphoma. J Clin Oncol. 2023 Dec 19:JCO2301115. doi: 10.1200/JCO.23.01115. Epub ahead of print. PMID: 38113419.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# The function can work with three different outcome types. 
# Here, we use binary as an example:
bfit = LASSO_plus(data = tdat, biomks = Xvars, Y = "DZsig", topN = 5,
                  outfile = paste0(temp_dir, "/binaryLASSO_plus"))
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='LASSO_plus_XGBtraining'>LASSO_plus_XGBtraining: Variable Selection and XGBoost Modeling</h2><span id='topic+LASSO_plus_XGBtraining'></span>

<h3>Description</h3>

<p>This function performs variable selection using LASSO_plus, followed by building an XGBoost model.
LASSO_plus is a method for variable selection, and XGBoost is a gradient boosting algorithm for modeling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LASSO_plus_XGBtraining(
  data = NULL,
  standardization = FALSE,
  columnWise = TRUE,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  topN = 10,
  nrounds = 5,
  nthread = 2,
  gamma = 1,
  max_depth = 3,
  eta = 0.3,
  outfile = "nameWithPath",
  height = 6
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LASSO_plus_XGBtraining_+3A_data">data</code></td>
<td>
<p>A data matrix or a data frame where samples are in rows, and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_standardization">standardization</code></td>
<td>
<p>A logical variable to indicate if standardization is needed before variable selection. The default is FALSE.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_columnwise">columnWise</code></td>
<td>
<p>A logical variable to indicate if column-wise or row-wise normalization is needed. The default is TRUE, 
which is to do column-wise normalization. This is only meaningful when &quot;standardization&quot; is TRUE.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_biomks">biomks</code></td>
<td>
<p>A vector of potential biomarkers for variable selection. They should be a subset of &quot;data&quot; column names.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_outcometype">outcomeType</code></td>
<td>
<p>Outcome variable type. There are three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_y">Y</code></td>
<td>
<p>Outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_time">time</code></td>
<td>
<p>Time variable name when outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_event">event</code></td>
<td>
<p>Event variable name when outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_topn">topN</code></td>
<td>
<p>An integer to indicate how many variables we intend to select.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_nrounds">nrounds</code></td>
<td>
<p>Max number of boosting iterations.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_nthread">nthread</code></td>
<td>
<p>Number of parallel threads used to run XGBoost.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_gamma">gamma</code></td>
<td>
<p>Minimum loss reduction required to make a further partition on a leaf node of the tree.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_max_depth">max_depth</code></td>
<td>
<p>Maximum depth of a tree. Increasing this value will make the model more complex and more likely to overfit.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_eta">eta</code></td>
<td>
<p>The learning rate for the XGBoost model.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_outfile">outfile</code></td>
<td>
<p>A string representing the output file, including the path if necessary, but without the file type extension.</p>
</td></tr>
<tr><td><code id="LASSO_plus_XGBtraining_+3A_height">height</code></td>
<td>
<p>An integer to indicate the forest plot height in inches.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned: 
</p>
<table role = "presentation">
<tr><td><code>XGBoost_model</code></td>
<td>
<p>An XGBoost model</p>
</td></tr>
<tr><td><code>XGBoost_model_score</code></td>
<td>
<p>Model scores for the given training data set. 
For a continuous outcome variable, this is a vector of the estimated continuous values; 
for a binary outcome variable, this is a vector representing the probability of the positive class;
for time-to-event outcome, this is a vector of risk scores</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for Generalized Linear Models via Coordinate Descent (2010), Journal of Statistical Software, Vol. 33(1), 1-22, doi:10.18637/jss.v033.i01.
</p>
<p>Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011) Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol. 39(5), 1-13, doi:10.18637/jss.v039.i05.
</p>
<p>Tianqi Chen and Carlos Guestrin, &quot;XGBoost: A Scalable Tree Boosting System&quot;, 22nd SIGKDD Conference on Knowledge Discovery and Data Mining, 2016, https://arxiv.org/abs/1603.02754
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# The function can work with three different outcome types. 
# Here, we use continuous as an example:
clpxfit = LASSO_plus_XGBtraining(data = tdat, biomks = Xvars,
          outcomeType = "continuous", Y = "Age", topN = 5,
          outfile = paste0(temp_dir, "/continuous_LASSO_plus_XGBoost"))
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='LASSO2'>Variable Selection using Modified LASSO with a Minimum of Two Remaining Variables</h2><span id='topic+LASSO2'></span>

<h3>Description</h3>

<p>This function conducts variable selection using LASSO (Least Absolute Shrinkage and Selection Operator) with a minor adaptation. 
It calculates the mean lambda value from multiple cv.glmnet runs and ensures the selection of at least two variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LASSO2(
  data = NULL,
  standardization = FALSE,
  columnWise = TRUE,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  nfolds = 10,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LASSO2_+3A_data">data</code></td>
<td>
<p>A data matrix or a data frame where samples are in rows and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_standardization">standardization</code></td>
<td>
<p>A logical variable indicating if standardization is needed before variable selection. The default is FALSE.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_columnwise">columnWise</code></td>
<td>
<p>A logical variable indicating if column-wise or row-wise normalization is needed. The default is TRUE, which means column-wise normalization is performed.
This is only meaningful when &quot;standardization&quot; is TRUE.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_biomks">biomks</code></td>
<td>
<p>A vector of potential biomarkers for variable selection. They should be a subset of the column names in the &quot;data&quot; variable.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_outcometype">outcomeType</code></td>
<td>
<p>The outcome variable type. There are three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_y">Y</code></td>
<td>
<p>The outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_time">time</code></td>
<td>
<p>The time variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_event">event</code></td>
<td>
<p>The event variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_nfolds">nfolds</code></td>
<td>
<p>The number of folds for cross-validation. The default is 10.</p>
</td></tr>
<tr><td><code id="LASSO2_+3A_outfile">outfile</code></td>
<td>
<p>A string representing the output file, including the path if necessary, but without the file type extension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function utilizes glmnet::cv.glmnet for cross-validation-based variable selection with 
the largest value of lambda such that error is within 1 standard error of the minimum. 
To mitigate randomness from cross-validation splits, it conducts 10 runs (this number can later be parameterized) of n-fold cv.glmnet. The resulting 
average lambda value across these runs serves as the final lambda. Subsequently, the final regularization regression is performed on the 
complete dataset using this mean lambda value. Following this, the function assesses the count of remaining variables. If only one or none 
are selected, the function defaults to selecting the first lambda that results in at least two chosen variables on the full dataset.
This function is designed to handle three types of outcome variables: continuous, binary, and time-to-event.
</p>


<h3>Value</h3>

<p>A list is returned:
</p>
<table role = "presentation">
<tr><td><code>coefs</code></td>
<td>
<p>A vector of LASSO coefficients</p>
</td></tr>
<tr><td><code>h0</code></td>
<td>
<p>Cumulative baseline hazard table, for time to event outcome only</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>The time variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code>event</code></td>
<td>
<p>The event variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code>standardization</code></td>
<td>
<p>A logical variable indicating if standardization is needed before variable selection.</p>
</td></tr>
<tr><td><code>columnWise</code></td>
<td>
<p>A logical variable indicating if column-wise or row-wise normalization is needed.</p>
</td></tr>
<tr><td><code>outcomeType</code></td>
<td>
<p>The outcome variable type.</p>
</td></tr>
<tr><td><code>allplot</code></td>
<td>
<p>A plot object</p>
</td></tr>
</table>
<p>A shrunken coefficient vector is returned
</p>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for Generalized Linear Models via Coordinate Descent (2010), Journal of Statistical Software, Vol. 33(1), 1-22, doi:10.18637/jss.v033.i01.
</p>
<p>Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011) Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol. 39(5), 1-13, doi:10.18637/jss.v039.i05.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# The function can work with three different outcome types.
# Here, we use time-to-event as an example:
# tl = LASSO2(data = tdat, biomks = Xvars,
#             outcomeType = "time-to-event",
#             time = "FFP..Years.",event = "Code.FFP",
#             outfile = paste0(temp_dir, "/survivalLASSO2"))
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='LASSO2_predict'>Predict and Validate LASSO2 Model Scores</h2><span id='topic+LASSO2_predict'></span>

<h3>Description</h3>

<p>This function predicts model scores, positive group probabilities, and risk scores for different outcome types based on a LASSO2 object and a new data set.
It also performs validation of predictions when the true outcome variable is available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LASSO2_predict(
  lassoObj,
  newdata = NULL,
  newY = FALSE,
  u = 2,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LASSO2_predict_+3A_lassoobj">lassoObj</code></td>
<td>
<p>A LASSO2 object.</p>
</td></tr>
<tr><td><code id="LASSO2_predict_+3A_newdata">newdata</code></td>
<td>
<p>A new data matrix or data frame where samples are in rows and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="LASSO2_predict_+3A_newy">newY</code></td>
<td>
<p>The outcome variable for the new data set.</p>
</td></tr>
<tr><td><code id="LASSO2_predict_+3A_u">u</code></td>
<td>
<p>A single numeric follow-up time for survival outcomes.</p>
</td></tr>
<tr><td><code id="LASSO2_predict_+3A_outfile">outfile</code></td>
<td>
<p>A string representing the output file, including the path if necessary, but without the file type extension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of predicted values is returned.
</p>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for Generalized Linear Models via Coordinate Descent (2010), Journal of Statistical Software, Vol. 33(1), 1-22, doi:10.18637/jss.v033.i01.
</p>
<p>Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011) Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol. 39(5), 1-13, doi:10.18637/jss.v039.i05.
</p>
<p>Harrell Jr F (2023). rms: Regression Modeling Strategies_. R package version 6.7-1, &lt;https://CRAN.R-project.org/package=rms&gt;
</p>
<p>Harrell Jr F (2023). Hmisc: Harrell Miscellaneous_. R package version 5.1-1, &lt;https://CRAN.R-project.org/package=Hmisc&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training
vdat = datlist$validation

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# The function can work with three different outcome types. 
# Here, we use time-to-event as an example:
# tl = LASSO2(data = tdat, biomks = Xvars,
#             outcomeType = "time-to-event",
#             time = "FFP..Years.",event = "Code.FFP",
#             outfile = paste0(temp_dir, "/survivalLASSO2"))
# To predict the model in a new data set:
# ptl = LASSO2_predict(tl, newdata = vdat,
#                     outfile = paste0(temp_dir, "/pred_LASSO2_time_to_event"))
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='LASSO2_reg'>LASSO2 Variable Selection and Regular Regression Modeling</h2><span id='topic+LASSO2_reg'></span>

<h3>Description</h3>

<p>This function performs variable selection with LASSO2 but ignores the shrunk LASSO coefficients and builds a regular regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LASSO2_reg(
  data = NULL,
  standardization = FALSE,
  columnWise = TRUE,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  nfolds = 10,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LASSO2_reg_+3A_data">data</code></td>
<td>
<p>A data matrix or a data frame where samples are in rows, and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_standardization">standardization</code></td>
<td>
<p>A logical variable to indicate if standardization is needed before variable selection. The default is FALSE.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_columnwise">columnWise</code></td>
<td>
<p>A logical variable to indicate if column-wise or row-wise normalization is needed. The default is TRUE, which performs column-wise normalization. 
This is only meaningful when &quot;standardization&quot; is TRUE.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_biomks">biomks</code></td>
<td>
<p>A vector of potential biomarkers for variable selection. They should be a subset of column names in &quot;data&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_outcometype">outcomeType</code></td>
<td>
<p>The outcome variable type. There are three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_y">Y</code></td>
<td>
<p>The outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_time">time</code></td>
<td>
<p>The time variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_event">event</code></td>
<td>
<p>The event variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_nfolds">nfolds</code></td>
<td>
<p>The number of folds for cross-validation. The default value is 10.</p>
</td></tr>
<tr><td><code id="LASSO2_reg_+3A_outfile">outfile</code></td>
<td>
<p>A string for the output file including the path, if necessary, but without the file type extension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first part of LASSO2_reg involves variable selection with LASSO2, typically based on the mean lambda.1se from 10 iterations of 
n-fold cross-validation-based LASSO regression. In each iteration, a lambda.1se refers to the largest value of lambda such that the error 
is within 1 standard error of the minimum. However, if only one or no variable is selected, the cross-validation results are ignored, 
and a minimum of two remaining variables is ensured through full-data lambda simulations.
The second part of LASSO2_reg involves ignoring the shrunk LASSO coefficients and building a regular regression model.
It is suitable for three types of outcomes: continuous, binary, and time-to-event.
</p>


<h3>Value</h3>

<p>A list is returned with the same output as from confirmVars.
</p>
<table role = "presentation">
<tr><td><code>fit</code></td>
<td>
<p>A model with selected variables for the given outcome variable.</p>
</td></tr>
<tr><td><code>allplot</code></td>
<td>
<p>A list with all plots.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for Generalized Linear Models via Coordinate Descent (2010), Journal of Statistical Software, Vol. 33(1), 1-22, doi:10.18637/jss.v033.i01.
</p>
<p>Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011) Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol. 39(5), 1-13, doi:10.18637/jss.v039.i05.
</p>
<p>Hastie, T. J. and Pregibon, D. (1992) Generalized linear models. Chapter 6 of Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
<p>Therneau, T., Grambsch, P., Modeling Survival Data: Extending the Cox Model. Springer-Verlag, 2000.
</p>
<p>Kassambara A, Kosinski M, Biecek P (2021). survminer: Drawing Survival Curves using 'ggplot2'_. R package version 0.4.9,
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")

# The function can work with three different outcome types. 
# Here, we use time-to-event as an example:
# tlr = LASSO2_reg(data = tdat, biomks = Xvars,
#                  outcomeType = "time-to-event",
#                  time = "FFP..Years.",event = "Code.FFP",
#                  outfile = paste0(temp_dir, "/survivalLASSO2_reg"))
# You might save the files to the directory you want.
# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='LASSO2_XGBtraining'>Variable Selection with LASSO2 and Modeling with XGBoost</h2><span id='topic+LASSO2_XGBtraining'></span>

<h3>Description</h3>

<p>This function performs a two-step process: variable selection using LASSO2 and building a predictive model using XGBoost.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LASSO2_XGBtraining(
  data = NULL,
  standardization = FALSE,
  columnWise = TRUE,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  nfolds = 10,
  nrounds = 5,
  nthread = 2,
  gamma = 1,
  max_depth = 3,
  eta = 0.3,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LASSO2_XGBtraining_+3A_data">data</code></td>
<td>
<p>A data matrix or data frame containing samples in rows and features/traits in columns.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_standardization">standardization</code></td>
<td>
<p>A logical value indicating if standardization is needed before variable selection. Default is FALSE.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_columnwise">columnWise</code></td>
<td>
<p>A logical value indicating if column-wise or row-wise normalization is needed for standardization. Default is TRUE. 
This parameter is only meaningful when standardization is TRUE.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_biomks">biomks</code></td>
<td>
<p>A vector of potential biomarkers for variable selection. These should be a subset of the column names in the data parameter.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_outcometype">outcomeType</code></td>
<td>
<p>The type of the outcome variable: &quot;binary&quot; (default), &quot;continuous&quot;, or &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_y">Y</code></td>
<td>
<p>The name of the outcome variable when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_time">time</code></td>
<td>
<p>The name of the time variable when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_event">event</code></td>
<td>
<p>The name of the event variable when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_nfolds">nfolds</code></td>
<td>
<p>The number of folds for cross-validation. The default is 10.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_nrounds">nrounds</code></td>
<td>
<p>The maximum number of boosting iterations for the XGBoost model.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_nthread">nthread</code></td>
<td>
<p>The number of parallel threads used for running XGBoost.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_gamma">gamma</code></td>
<td>
<p>The minimum loss reduction required to make a further partition on a leaf node of the tree.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_max_depth">max_depth</code></td>
<td>
<p>The maximum depth of a tree in the XGBoost model.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_eta">eta</code></td>
<td>
<p>The learning rate for the XGBoost model.</p>
</td></tr>
<tr><td><code id="LASSO2_XGBtraining_+3A_outfile">outfile</code></td>
<td>
<p>A string for the output file, including the path if necessary, but without the file type extension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first part of LASSO2_XGBtraining involves variable selection with LASSO2, typically based on the mean lambda.1se from 10 iterations of n-fold 
cross-validation-based LASSO regression. In each iteration, a lambda.1se refers to the largest value of lambda such that the error is within
1 standard error of the minimum. However, if only one or no variable is selected, the cross-validation results are ignored, 
and a minimum of two remaining variables is ensured through full-data lambda simulations.
</p>
<p>The second part of LASSO2_XGBtraining involves ignoring the shrunk LASSO coefficients and building an XGBoost model.
It is suitable for three types of outcomes: continuous, binary, and time-to-event.
</p>


<h3>Value</h3>

<p>A list is returned:
</p>
<table role = "presentation">
<tr><td><code>XGBoost_model</code></td>
<td>
<p>An XGBoost model</p>
</td></tr>
<tr><td><code>XGBoost_model_score</code></td>
<td>
<p>Model scores for the given training data set. 
For a continuous outcome variable, this is a vector of the estimated continuous values; 
for a binary outcome variable, this is a vector representing the probability of the positive class;
for time-to-event outcome, this a vector of risk scores</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for Generalized Linear Models via Coordinate Descent (2010), Journal of Statistical Software, Vol. 33(1), 1-22, doi:10.18637/jss.v033.i01.
</p>
<p>Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011) Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol. 39(5), 1-13, doi:10.18637/jss.v039.i05.
</p>
<p>Tianqi Chen and Carlos Guestrin, &quot;XGBoost: A Scalable Tree Boosting System&quot;, 22nd SIGKDD Conference on Knowledge Discovery and Data Mining, 2016, https://arxiv.org/abs/1603.02754
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# The function can work with three different outcome types. 
# Here, we use binary as an example:
blxfit = LASSO2_XGBtraining(data = tdat, biomks = Xvars, Y = "DZsig",
                           outfile = paste0(temp_dir, "/binary_LASSO2_XGBoost"))
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='LASSO2plus'>Variable Selection and Modeling with LASSO2plus</h2><span id='topic+LASSO2plus'></span>

<h3>Description</h3>

<p>This function performs variable selection using the LASSO2plus algorithm and subsequently builds a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LASSO2plus(
  data = NULL,
  standardization = FALSE,
  columnWise = TRUE,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  outfile = "nameWithPath",
  height = 6
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LASSO2plus_+3A_data">data</code></td>
<td>
<p>A data matrix or a data frame, samples are in rows, and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_standardization">standardization</code></td>
<td>
<p>A logic variable to indicate if standardization is needed before variable selection, the default is FALSE.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_columnwise">columnWise</code></td>
<td>
<p>A logic variable to indicate if column wise or row wise normalization is needed, the default is TRUE, which is to do column-wise normalization. 
This is only meaningful when &quot;standardization&quot; is TRUE.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_biomks">biomks</code></td>
<td>
<p>A vector of potential biomarkers for variable selection, they should be a subset of &quot;data&quot; column names.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_outcometype">outcomeType</code></td>
<td>
<p>Outcome variable type. There are three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_y">Y</code></td>
<td>
<p>Outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_time">time</code></td>
<td>
<p>Time variable name when outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_event">event</code></td>
<td>
<p>Event variable name when outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_outfile">outfile</code></td>
<td>
<p>A string for the output file including path if necessary but without file type extension.</p>
</td></tr>
<tr><td><code id="LASSO2plus_+3A_height">height</code></td>
<td>
<p>An integer to indicate the forest plot height in inches</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LASSO2plus algorithm begins with variable selection using LASSO2, typically involving multiple cross-validation-based LASSO regressions.
However, if only one or no variables are selected, the cross-validation results are ignored, and the algorithm ensures a minimum 
of two remaining variables through full-data lambda simulations. Additionally, it conducts variable selection through single-variable regression for each candidate variable.
The variables selected from both LASSO2 and single-variable approaches are then combined to perform traditional variable selection using stepwise regression. 
This function is designed to handle outcome variables of binary, continuous, or time-to-event type. Following variable selection, 
a model is constructed using standard R functions such as lm, glm, or coxph, depending on the type of outcome variable.
</p>


<h3>Value</h3>

<p>A list is returned: 
</p>
<table role = "presentation">
<tr><td><code>fit</code></td>
<td>
<p>A model with selected variables for the given outcome variable</p>
</td></tr>
<tr><td><code>outplot</code></td>
<td>
<p>A forest plot</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for Generalized Linear Models via Coordinate Descent (2010), Journal of Statistical Software, Vol. 33(1), 1-22, doi:10.18637/jss.v033.i01.
</p>
<p>Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011) Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol. 39(5), 1-13, doi:10.18637/jss.v039.i05.
</p>
<p>Hastie, T. J. and Pregibon, D. (1992) Generalized linear models. Chapter 6 of Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
<p>Therneau, T., Grambsch, P., Modeling Survival Data: Extending the Cox Model. Springer-Verlag, 2000.
</p>
<p>Kassambara A, Kosinski M, Biecek P (2021). survminer: Drawing Survival Curves using 'ggplot2'_. R package version 0.4.9,
&lt;https://CRAN.R-project.org/package=survminer&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# The function can work with three different outcome types. 
# Here, we use continuous as an example:
c2fit = LASSO2plus(data = tdat, biomks = Xvars,
                   outcomeType = "continuous", Y = "Age",
                   outfile = paste0(temp_dir, "/continuousLASSO2plus"))
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='LASSO2plus_XGBtraining'>XGBoost Modeling after Variable Selection with LASSO2plus</h2><span id='topic+LASSO2plus_XGBtraining'></span>

<h3>Description</h3>

<p>This function performs variable selection using LASSO2plus and then builds an XGBoost model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LASSO2plus_XGBtraining(
  data = NULL,
  standardization = FALSE,
  columnWise = TRUE,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  nrounds = 5,
  nthread = 2,
  gamma = 1,
  max_depth = 3,
  eta = 0.3,
  outfile = "nameWithPath",
  height = 6
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LASSO2plus_XGBtraining_+3A_data">data</code></td>
<td>
<p>A data matrix or a data frame where samples are in rows, and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_standardization">standardization</code></td>
<td>
<p>A logical variable to indicate if standardization is needed before variable selection. The default is FALSE.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_columnwise">columnWise</code></td>
<td>
<p>A logical variable indicating whether column-wise or row-wise normalization is needed. 
The default is TRUE, which is used to perform column-wise normalization. This is only meaningful when &quot;standardization&quot; is TRUE.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_biomks">biomks</code></td>
<td>
<p>A vector of potential biomarkers for variable selection. They should be a subset of &quot;data&quot; column names.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_outcometype">outcomeType</code></td>
<td>
<p>Outcome variable type. There are three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_y">Y</code></td>
<td>
<p>Outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_time">time</code></td>
<td>
<p>Time variable name when outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_event">event</code></td>
<td>
<p>Event variable name when outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_nrounds">nrounds</code></td>
<td>
<p>Max number of boosting iterations.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_nthread">nthread</code></td>
<td>
<p>Number of parallel threads used to run XGBoost.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_gamma">gamma</code></td>
<td>
<p>Minimum loss reduction required to make a further partition on a leaf node of the tree.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_max_depth">max_depth</code></td>
<td>
<p>Maximum depth of a tree. Increasing this value will make the model more complex and more likely to overfit.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_eta">eta</code></td>
<td>
<p>The learning rate for the XGBoost model.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_outfile">outfile</code></td>
<td>
<p>A string for the output file including path if necessary but without file type extension.</p>
</td></tr>
<tr><td><code id="LASSO2plus_XGBtraining_+3A_height">height</code></td>
<td>
<p>An integer to indicate the forest plot height in inches.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first part of LASSO2plus_XGBtraining involves variable selection with LASSO2plus. The LASSO2plus algorithm begins with variable selection using LASSO2,
followed by variable selection through single-variable regression for each candidate variable. Finally, the two sets of selected variables are combined and processed to
obtain the final list through stepwise variable selection.
The second part of LASSO2plus_XGBtraining involves using the final variable list obtained above to build an XGBoost model.
It is suitable for three types of outcomes: continuous, binary, and time-to-event.
</p>


<h3>Value</h3>

<p>A list is returned: 
</p>
<table role = "presentation">
<tr><td><code>XGBoost_model</code></td>
<td>
<p>An XGBoost model</p>
</td></tr>
<tr><td><code>XGBoost_model_score</code></td>
<td>
<p>Model scores for the given training data set. 
For a continuous outcome variable, this is a vector of the estimated continuous values; 
for a binary outcome variable, this is a vector representing the probability of the positive class;
for time-to-event outcome, this is a vector of risk scores</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Friedman, J., Hastie, T. and Tibshirani, R. (2008) Regularization Paths for Generalized Linear Models via Coordinate Descent (2010), Journal of Statistical Software, Vol. 33(1), 1-22, doi:10.18637/jss.v033.i01.
</p>
<p>Simon, N., Friedman, J., Hastie, T. and Tibshirani, R. (2011) Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol. 39(5), 1-13, doi:10.18637/jss.v039.i05.
</p>
<p>Tianqi Chen and Carlos Guestrin, &quot;XGBoost: A Scalable Tree Boosting System&quot;, 22nd SIGKDD Conference on Knowledge Discovery and Data Mining, 2016, https://arxiv.org/abs/1603.02754
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# The function can work with three different outcome types. 
# Here, we use time-to-event as an example:
# tl2xfit = LASSO2plus_XGBtraining(data = tdat, biomks = Xvars,
#                                 outcomeType = "time-to-event",
#                                time = "FFP..Years.", event = "Code.FFP",
#                                outfile = paste0(temp_dir, "/survival_LASSO2plus_XGBoost"))
#
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='rms_model'>A Wrapper for Building Predictive Models using the rms Package</h2><span id='topic+rms_model'></span>

<h3>Description</h3>

<p>This wrapper function harnesses the capabilities of the rms package to construct robust predictive models using various modeling techniques.
Whether you're working with linear regression (lm), generalized linear models (glm), or Cox proportional hazards models (coxph) directly or generating these 
objects from other functions, this function streamlines the model-building process and enhances analysis. The function features built-in bootstrap-based 
internal validation, model score generation, and result storage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rms_model(afit, data = NULL, newdata = NULL, newY = FALSE, u = 2, outfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rms_model_+3A_afit">afit</code></td>
<td>
<p>A model fit from lm, glm, or coxph.</p>
</td></tr>
<tr><td><code id="rms_model_+3A_data">data</code></td>
<td>
<p>A data frame used to obtain the 'afit' object. This parameter is only required when the outcome variable is time-to-event; otherwise, the data is extracted from 'afit'.</p>
</td></tr>
<tr><td><code id="rms_model_+3A_newdata">newdata</code></td>
<td>
<p>A new data frame for prediction.</p>
</td></tr>
<tr><td><code id="rms_model_+3A_newy">newY</code></td>
<td>
<p>A logical variable indicating whether 'newdata' contains the outcome variable.</p>
</td></tr>
<tr><td><code id="rms_model_+3A_u">u</code></td>
<td>
<p>A single numeric value representing follow-up time for survival outcomes, used to estimate the survival probability for the given time point.</p>
</td></tr>
<tr><td><code id="rms_model_+3A_outfile">outfile</code></td>
<td>
<p>A string indicating the output file name without the file type extension, but including the complete path information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The wrapper function capitalizes on the power of the rms package, providing a seamless interface for creating predictive models.
With the rms package, the function conducts efficient bootstrap-based internal validation, enabling thorough model evaluation. 
Nomograph plots and C-index calculations are also at your disposal. Furthermore, the function adapts to your needs by predicting model scores for new datasets. 
In the absence of new data, it generates predictions based on the training data. However, when you provide an independent dataset complete with outcome 
variable information, the function extends to external validation. This enables assessing model performance in an independent context using the rms R package.
</p>
<p>All results, from the model itself to internal validation metrics and predictions, are conveniently stored locally for easy access and further analysis.
</p>


<h3>Value</h3>

<p>Predictions are returned.
</p>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Harrell Jr F (2023). rms: Regression Modeling Strategies. R package version 6.7-1, &lt;https://CRAN.R-project.org/package=rms&gt;
</p>
<p>Harrell Jr F (2023). Hmisc: Harrell Miscellaneous. R package version 5.1-1, &lt;https://CRAN.R-project.org/package=Hmisc&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training
vdat = datlist$validation

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")

# The function can work with multiple models and multiple outcome types. 
# Here, we use continuous as an example:
clr = LASSO2_reg(data = tdat, biomks = Xvars,
                 outcomeType = "continuous", Y = "Age",
                 outfile = paste0(temp_dir, "/continuousLASSO2_reg"))
pclr = rms_model(clr$fit, newdata = vdat,
                 outfile = paste0(temp_dir, "/pred_LASSO2reg_continuous"))
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='validation'>Validate Model Predictions</h2><span id='topic+validation'></span>

<h3>Description</h3>

<p>This function is designed to perform model validation when the corresponding outcome variable is available. It facilitates the comparison of model predictions
with the provided outcome variable, which can be continuous, binary, or time-to-event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validation(
  predicted = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  trueY = NULL,
  time = NULL,
  trueEvent = NULL,
  baseHz = NULL,
  u = 2,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validation_+3A_predicted">predicted</code></td>
<td>
<p>A vector of model prediction values, which can be generated by prediction functions in this package such as LASSO2_predict and XGBtraining_predict. 
For continuous outcomes, this vector represents model scores; for binary outcomes, it represents the probability of the positive class; 
for time-to-event outcomes, it contains risk scores, which will later be transformed into estimated survival probabilities corresponding to times in the new data.</p>
</td></tr>
<tr><td><code id="validation_+3A_outcometype">outcomeType</code></td>
<td>
<p>Outcome variable type. There are three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="validation_+3A_truey">trueY</code></td>
<td>
<p>A vector of the outcome variable when it is continuous or binary.</p>
</td></tr>
<tr><td><code id="validation_+3A_time">time</code></td>
<td>
<p>A vector of time for time-to-event outcome.</p>
</td></tr>
<tr><td><code id="validation_+3A_trueevent">trueEvent</code></td>
<td>
<p>A vector of the event for time-to-event outcome.</p>
</td></tr>
<tr><td><code id="validation_+3A_basehz">baseHz</code></td>
<td>
<p>A table for accumulating baseline hazard for multiple time points, usually generated based on a training data set.</p>
</td></tr>
<tr><td><code id="validation_+3A_u">u</code></td>
<td>
<p>A single numeric follow-up time for survival outcomes.</p>
</td></tr>
<tr><td><code id="validation_+3A_outfile">outfile</code></td>
<td>
<p>A string for the output file, including the path if necessary but without the file type extension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is invoked by multiple prediction functions within this package when an outcome variable is available for a new dataset. 
However, users can also directly call this function if needed.
</p>


<h3>Value</h3>

<p>A vector of model prediction values from the input
</p>


<h3>References</h3>

<p>Harrell Jr F (2023). rms: Regression Modeling Strategies_. R package version 6.7-1, &lt;https://CRAN.R-project.org/package=rms&gt;
</p>
<p>Harrell Jr F (2023). Hmisc: Harrell Miscellaneous_. R package version 5.1-1, &lt;https://CRAN.R-project.org/package=Hmisc&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training
vdat = datlist$validation

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")

# The function can work with multiple models and multiple outcome types. 
# Here, we use XGBoost model with binary outcome as an example:
bxfit = XGBtraining(data = tdat, biomks = Xvars, Y = "DZsig",
                    outfile = paste0(temp_dir, "/binary_XGBoost"))
testdat = vdat[,bxfit$XGBoost_model$feature_names]
test = xgboost::xgb.DMatrix(data.matrix(testdat))
scores = stats::predict(bxfit$XGBoost_model, test) 
names(scores) = rownames(vdat)
Y = bxfit$Y
outs = validation(predicted = scores, outcomeType = "binary", trueY = vdat[,Y],
                  outfile = paste0(temp_dir, "/binary_XGBoost_validate")) 
# You might save the files to the directory you want.

# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='XGBtraining'>A Wrapper Function for xgboost::xgboost</h2><span id='topic+XGBtraining'></span>

<h3>Description</h3>

<p>This wrapper function streamlines the process of utilizing the xgboost package for model training. 
It takes care of converting the data format to xgb.DMatrix, handling xgboost's specific settings, 
and invoking xgboost::xgboost. The function is suitable for all three outcome types: binary, 
continuous, and time-to-event. It returns both the trained model and the model scores for the 
training dataset.
</p>
<p>It's important to note that all independent variables (X variables) should already be selected 
and in numeric format when passed to this function. Additionally, this function does not perform 
variable selection or automatically convert categorical variables to numeric format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XGBtraining(
  data,
  biomks = NULL,
  outcomeType = c("binary", "continuous", "time-to-event"),
  Y = NULL,
  time = NULL,
  event = NULL,
  nrounds = 5,
  nthread = 2,
  gamma = 1,
  max_depth = 3,
  eta = 0.3,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="XGBtraining_+3A_data">data</code></td>
<td>
<p>A data matrix or a data frame where samples are in rows and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_biomks">biomks</code></td>
<td>
<p>A vector of potential biomarkers for variable selection. They should be a subset of the column names in the &quot;data&quot; variable.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_outcometype">outcomeType</code></td>
<td>
<p>The outcome variable type. There are three choices: &quot;binary&quot; (default), &quot;continuous&quot;, and &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_y">Y</code></td>
<td>
<p>The outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;. When Y is binary, it should be in 0-1 format.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_time">time</code></td>
<td>
<p>The time variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_event">event</code></td>
<td>
<p>The event variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_nrounds">nrounds</code></td>
<td>
<p>The maximum number of boosting iterations.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_nthread">nthread</code></td>
<td>
<p>The number of parallel threads used to run XGBoost.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_gamma">gamma</code></td>
<td>
<p>The minimum loss reduction required to make a further partition on a leaf node of the tree.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_max_depth">max_depth</code></td>
<td>
<p>The maximum depth of a tree. Increasing this value will make the model more complex and more likely to overfit.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_eta">eta</code></td>
<td>
<p>The step size shrinkage used in the update to prevent overfitting.</p>
</td></tr>
<tr><td><code id="XGBtraining_+3A_outfile">outfile</code></td>
<td>
<p>A string for the output file, including the path if necessary but without the file type extension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned:
</p>
<table role = "presentation">
<tr><td><code>XGBoost_model</code></td>
<td>
<p>An XGBoost model</p>
</td></tr>
<tr><td><code>XGBoost_score</code></td>
<td>
<p>Scores for the given training data set.
For a continuous outcome variable, this is a vector of the estimated continuous values;
for a binary outcome variable, this is a vector representing the probability of the positive class;
for a time-to-event outcome, this is a vector of risk scores.</p>
</td></tr>
<tr><td><code>h0</code></td>
<td>
<p>Cumulative baseline hazard table, for time to event outcome only.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The outcome variable name when the outcome type is either &quot;binary&quot; or &quot;continuous&quot;.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>The time variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
<tr><td><code>event</code></td>
<td>
<p>The event variable name when the outcome type is &quot;time-to-event&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Tianqi Chen and Carlos Guestrin, &quot;XGBoost: A Scalable Tree Boosting System&quot;, 22nd SIGKDD Conference on Knowledge Discovery and Data Mining, 2016, https://arxiv.org/abs/1603.02754
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training
# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")

# The function can work with three outcome types. 
# Here, we use time-to-event outcome as an example:
txfit = XGBtraining(data = tdat, biomks = Xvars,
                    outcomeType = "time-to-event",
                    time = "FFP..Years.",event = "Code.FFP",
                    outfile = paste0(temp_dir, "/survival_XGBoost"))
# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='XGBtraining_predict'>Predicting XGBoost Model Scores and Performing Validation</h2><span id='topic+XGBtraining_predict'></span>

<h3>Description</h3>

<p>This function predicts XGBoost model scores using an XGBtraining object and a new dataset. 
It converts the input data to the required xgb.DMatrix format and returns the model scores. 
If the new dataset includes an outcome variable, the function also performs validation, 
comparing predictions with observed outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XGBtraining_predict(
  xgbtrainingObj = NULL,
  newdata = NULL,
  newY = FALSE,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="XGBtraining_predict_+3A_xgbtrainingobj">xgbtrainingObj</code></td>
<td>
<p>An XGBtraining object returned from the XGBtraining function.</p>
</td></tr>
<tr><td><code id="XGBtraining_predict_+3A_newdata">newdata</code></td>
<td>
<p>A data matrix or a data frame, samples are in rows, and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="XGBtraining_predict_+3A_newy">newY</code></td>
<td>
<p>A logical variable indicating if 'newdata' contains the outcome variable.</p>
</td></tr>
<tr><td><code id="XGBtraining_predict_+3A_outfile">outfile</code></td>
<td>
<p>A string for the output file including path if necessary but without file type extension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of predicted values is return. If an outcome variable is available for the new dataset, validation is performed.
</p>
<table role = "presentation">
<tr><td><code>predicted</code></td>
<td>
<p>A vector of model prediction values. For continuous outcome, this is a vector of model scores; 
for binary outcome, this is a vector representing the probability of the positive class;
for time to event outcome, this is a vector of risk scores</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Tianqi Chen and Carlos Guestrin, &quot;XGBoost: A Scalable Tree Boosting System&quot;, 22nd SIGKDD Conference on Knowledge Discovery and Data Mining, 2016, https://arxiv.org/abs/1603.02754
</p>
<p>Harrell Jr F (2023). rms: Regression Modeling Strategies_. R package version 6.7-1, &lt;https://CRAN.R-project.org/package=rms&gt;
</p>
<p>Harrell Jr F (2023). Hmisc: Harrell Miscellaneous_. R package version 5.1-1, &lt;https://CRAN.R-project.org/package=Hmisc&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training
vdat = datlist$validation

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")

# The function can work with multiple models and multiple outcome types. 
# Here, we provide an example using the XGBoost model with a time-to-event outcome:
txfit = XGBtraining(data = tdat, biomks = Xvars,
                    outcomeType = "time-to-event",
                    time = "FFP..Years.",event = "Code.FFP",
                    outfile = paste0(temp_dir, "/survival_XGBoost"))
ptxfit = XGBtraining_predict(txfit, newdata = vdat,
                    outfile = paste0(temp_dir, "/pred_XGBoost_time_to_event"))
# To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='XGpred'>XGpred: Building Risk Classification Predictive Models using Survival Data</h2><span id='topic+XGpred'></span>

<h3>Description</h3>

<p>The XGpred function is designed to generate an empirical Bayesian-based binary risk classification model with survival data based on our novel XGpred algorithm, 
combining XGBoost and traditional survival analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XGpred(
  data = NULL,
  varsIn = NULL,
  selection = FALSE,
  vsMethod = c("LASSO2", "LASSO2plus", "LASSO_plus"),
  time = NULL,
  event = NULL,
  nrounds = 5,
  probcut = 0.8,
  nclass = c(2, 3),
  topN = 10,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="XGpred_+3A_data">data</code></td>
<td>
<p>A data matrix or a data frame where samples are in rows and features/traits are in columns.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_varsin">varsIn</code></td>
<td>
<p>A vector of variables used for the prediction model.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_selection">selection</code></td>
<td>
<p>Logical. Default is FALSE. If TRUE, three variable selection methods can be chosen.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_vsmethod">vsMethod</code></td>
<td>
<p>When &quot;selection&quot; is set to TRUE, three variable selection methods can be chosen, with LASSO2 as the default method. The other two methods
are &quot;LASSO2plus&quot; and &quot;LASSO_plus.&quot;</p>
</td></tr>
<tr><td><code id="XGpred_+3A_time">time</code></td>
<td>
<p>Time variable name.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_event">event</code></td>
<td>
<p>Event variable name.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_nrounds">nrounds</code></td>
<td>
<p>The maximum number of boosting iterations.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_probcut">probcut</code></td>
<td>
<p>Probability cutoff for risk group classification. Default is set to 0.8.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_nclass">nclass</code></td>
<td>
<p>Number of risk groups. By default, it is 2; any samples not classified into high-risk groups are classified into the low-risk group. 
When 3 is chosen, samples are classified into low, middle, and high-risk groups.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_topn">topN</code></td>
<td>
<p>An integer indicating how many variables to select if LASSO_plus is chosen as the variable selection method.</p>
</td></tr>
<tr><td><code id="XGpred_+3A_outfile">outfile</code></td>
<td>
<p>A string for the output file, including the path if necessary but without a file type extension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If variable selection is needed, three variable selection methods are provided. Either the given variable or the selected variable list is used to build both an XGBoost model
and a traditional Cox model. Risk scores for each model are calculated and ranked, then averaged for each sample. 
The top 1/3 of samples are defined as the high-risk group, while the bottom 1/3 of samples are defined as the low-risk group. 
The binary risk classification model is built based on these two risk groups using either the given variable or the selected variable list. 
The model is a linear combination of these variables, with weights defined as t values derived from the single-variable linear model
of each variable on the two groups. Finally, the classification is based on empirical Bayesian probabilities.
</p>


<h3>Value</h3>

<p>A list is returned with the following seven items:
</p>
<table role = "presentation">
<tr><td><code>ranks</code></td>
<td>
<p>Ranks from XGboost and Cox</p>
</td></tr>
<tr><td><code>twoEnds</code></td>
<td>
<p>High and low risk group samples identified by mean ranks from XGBoost and Cox models</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Weights for each variables used in the model</p>
</td></tr>
<tr><td><code>modelPars</code></td>
<td>
<p>Mean and standard error of model scores for each risk group</p>
</td></tr>
<tr><td><code>nclass</code></td>
<td>
<p>Number of risk groups</p>
</td></tr>
<tr><td><code>XGpred_score</code></td>
<td>
<p>Model XGpred score</p>
</td></tr>
<tr><td><code>XGpred_prob</code></td>
<td>
<p>Empirical Bayesian probability based on model XGpred score</p>
</td></tr>
<tr><td><code>XGpred_prob_class</code></td>
<td>
<p>Risk group classification based on XGpred_prob for the given probability cutoff</p>
</td></tr>
<tr><td><code>probcut</code></td>
<td>
<p>Probability cutoff for risk group classification</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Tianqi Chen and Carlos Guestrin (2016), &quot;XGBoost: A Scalable Tree Boosting System&quot;, 22nd SIGKDD Conference on Knowledge Discovery and Data Mining, 2016, https://arxiv.org/abs/1603.02754
</p>
<p>Aoki T, Jiang A, Xu A et al.,(2023) Spatially Resolved Tumor Microenvironment Predicts Treatment Outcomes in Relapsed/Refractory Hodgkin Lymphoma. J Clin Oncol. 2023 Dec 19:JCO2301115. doi: 10.1200/JCO.23.01115. Epub ahead of print. PMID: 38113419.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# For given time-to-event outcome and Xvars, we can build up a binary risk classification:
 xgobj = XGpred(data = tdat, varsIn = Xvars, 
                time = "FFP..Years.", event = "Code.FFP", 
                outfile = paste0(temp_dir, "/XGpred"))
# You might save the files to the directory you want.

# To delete the temp_dir, use the following:
unlink(temp_dir)
</code></pre>

<hr>
<h2 id='XGpred_predict'>Predicting Risk Group Classification for a New Data Set</h2><span id='topic+XGpred_predict'></span>

<h3>Description</h3>

<p>The XGpred_predict function is designed to predict risk group classifications for a new data set. 
This prediction is based on the assumption that an XGpred object is available from a training data set and
that the new data set is comparable to the training data set.
</p>
<p>In scenarios where the new and training data sets are not directly comparable, a calibration cohort is required 
to ensure accurate risk group predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XGpred_predict(newdat = NULL, XGpredObj = NULL, scoreShift = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="XGpred_predict_+3A_newdat">newdat</code></td>
<td>
<p>A data matrix or a data frame where samples are in rows and features/traits are in columns. 
It should include all variables needed for the prediction model.</p>
</td></tr>
<tr><td><code id="XGpred_predict_+3A_xgpredobj">XGpredObj</code></td>
<td>
<p>An XGpred object returned by the XGpred function. Although not all items are needed for 
prediction purposes, using the XGpred object as input is convenient.</p>
</td></tr>
<tr><td><code id="XGpred_predict_+3A_scoreshift">scoreShift</code></td>
<td>
<p>A calibration value to subtract from the current model score if needed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing XGpred_score, XGpred_prob, and XGpred_prob_class
</p>


<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Aoki T, Jiang A, Xu A et al.,(2023) Spatially Resolved Tumor Microenvironment Predicts Treatment Outcomes 
in Relapsed/Refractory Hodgkin Lymphoma. J Clin Oncol. 2023 Dec 19:JCO2301115. doi: 10.1200/JCO.23.01115. Epub ahead of print. 
PMID: 38113419.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training
vdat = datlist$validation

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# For given time-to-event outcome and Xvars, we can build up a binary risk classification:
 xgobj = XGpred(data = tdat, varsIn = Xvars, 
               time = "FFP..Years.",
                event = "Code.FFP", outfile = paste0(temp_dir, "/XGpred"))
 tdat$XGpred_class = xgobj$XGpred_prob_class
# You might save the files to the directory you want.

# Now, we can predict the risk classification for a new data set:
 xgNew = XGpred_predict(newdat = vdat, XGpredObj = xgobj)

#' # To delete the "temp_dir", use the following:
unlink(temp_dir)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
