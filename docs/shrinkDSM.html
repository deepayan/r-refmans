<!DOCTYPE html><html><head><title>Help for package shrinkDSM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {shrinkDSM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#divisionpoints'><p>Create division points for estimation of a dynamic survival model</p></a></li>
<li><a href='#gastric'><p>Survival times of gastric cancer patients</p></a></li>
<li><a href='#plot.mcmc.dsm.tvp'><p>Graphical summary of posterior distribution for a piecewise constant, time-varying parameter</p></a></li>
<li><a href='#plot.shrinkDSM'><p>Graphical summary of posterior distribution of fitted dynamic survival model</p></a></li>
<li><a href='#plot.shrinkDSM_pred'><p>Graphical summary of posterior predictive density</p></a></li>
<li><a href='#predict.shrinkDSM'><p>Draw from posterior predictive density of a fitted time-varying parameter survival model</p></a></li>
<li><a href='#prep_tvinput'><p>Prepare time-varying inputs for estimation of a dynamic survival model</p></a></li>
<li><a href='#print.shrinkDSM'><p>Nicer printing of shrinkDSM objects</p></a></li>
<li><a href='#shrinkDSM'><p>Markov Chain Monte Carlo (MCMC) for time-varying parameter survival models with shrinkage</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Efficient Bayesian Inference for Dynamic Survival Models with
Shrinkage</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Efficient Markov chain Monte Carlo (MCMC) algorithms for fully 
    Bayesian estimation of dynamic survival models with shrinkage priors. 
    Details on the algorithms used are provided in Wagner (2011) &lt;<a href="https://doi.org/10.1007%2Fs11222-009-9164-5">doi:10.1007/s11222-009-9164-5</a>&gt;, 
    Bitto and Fr√ºhwirth-Schnatter (2019) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2018.11.006">doi:10.1016/j.jeconom.2018.11.006</a>&gt; and
    Cadonna et al. (2020) &lt;<a href="https://doi.org/10.3390%2Feconometrics8020020">doi:10.3390/econometrics8020020</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, stochvol (&ge; 3.0.3), coda, utils, shrinkTVP (&ge; 2.0.2)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppProgress, stochvol, shrinkTVP</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-13 09:18:53 UTC; danie</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Winkler [aut, cre],
  Peter Knaus <a href="https://orcid.org/0000-0001-6498-7084"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Winkler &lt;daniel.winkler@wu.ac.at&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-15 21:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='divisionpoints'>Create division points for estimation of a dynamic survival model</h2><span id='topic+divisionpoints'></span>

<h3>Description</h3>

<p>Create a vector of division points for the model.
These points mark the times at which the parameters are allowed to evolve,
with the parameters being fixed between division points. The points
are generated in a data driven fashion, with a new point being created
when <code>events</code> number of interesting events have been observed since
the last division point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>divisionpoints(times, delta, events = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="divisionpoints_+3A_times">times</code></td>
<td>
<p>A vector of real, positive numbers indicating
the survival times. For right censored data, this is the follow up time.</p>
</td></tr>
<tr><td><code id="divisionpoints_+3A_delta">delta</code></td>
<td>
<p>A vector of status indicators, with 0 = alive and 1 = dead.
Other choices are <code>TRUE</code>/<code>FALSE</code> (<code>TRUE</code> = death) or 1/2 (2 = death).</p>
</td></tr>
<tr><td><code id="divisionpoints_+3A_events">events</code></td>
<td>
<p>A positive integer indicating the number of interesting events per interval until
a new division is created.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an integer vector of time points to be used as division points <code>S</code> in <code>shrinkDSM</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel Winkler <a href="mailto:daniel.winkler@wu.ac.at">daniel.winkler@wu.ac.at</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("gastric")

# Create intervals for piecewise exponential model
intervals &lt;- divisionpoints(gastric$time, gastric$status, 2)
</code></pre>

<hr>
<h2 id='gastric'>Survival times of gastric cancer patients</h2><span id='topic+gastric'></span>

<h3>Description</h3>

<p>A data set of survival times of patients with locally advanced,
nonresectable gastric carcinoma. The patients were either
treated with chemotherapy plus radiation or chemotherapy alone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gastric
</code></pre>


<h3>Format</h3>

<p>A data frame with 90 rows and 4 variables:
</p>

<dl>
<dt>id</dt><dd><p>patient id</p>
</dd>
<dt>radiation</dt><dd><p>dummy variable indicating which treatment was employed,
0 = chemotherapy, 1 = combined chemotherapy/radiation</p>
</dd>
<dt>time</dt><dd><p>time survived by patient in days</p>
</dd>
<dt>status</dt><dd><p>dummy variable indicating whether death of the patient was observed,
0 = death not observed (i.e. censored), 1 = death observed.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Moreau, T., O'Quigley, J., and Mesbah M. (1985) A global goodness-of-fit statistic for
the proportional hazards model Appl. Statist., 34, 212:218 (p 213)
</p>
<p><a href="https://www.mayo.edu/research/documents/gastrichtml/DOC-10027680">https://www.mayo.edu/research/documents/gastrichtml/DOC-10027680</a>
</p>

<hr>
<h2 id='plot.mcmc.dsm.tvp'>Graphical summary of posterior distribution for a piecewise constant, time-varying parameter</h2><span id='topic+plot.mcmc.dsm.tvp'></span>

<h3>Description</h3>

<p><code>plot.mcmc.dsm.tvp</code> plots empirical posterior quantiles for a piecewise constant, time-varying parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcmc.dsm.tvp'
plot(
  x,
  probs = c(0.025, 0.25, 0.75, 0.975),
  shaded = TRUE,
  quantlines = FALSE,
  shadecol = "skyblue",
  shadealpha = 0.5,
  quantlty = 2,
  quantcol = "black",
  quantlwd = 0.5,
  drawzero = TRUE,
  zerolty = 2,
  zerolwd = 1,
  zerocol = "grey",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_x">x</code></td>
<td>
<p><code>mcmc.dsm.tvp</code> object</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_probs">probs</code></td>
<td>
<p>vector of boundaries for credible intervals to plot for each point in time, with values in [0,1].
The largest and smallest value form the outermost credible interval, the second smallest and second largest the second outermost and so forth.
The default value is <code>c(0.025, 0.25, 0.75, 0.975)</code>. Note that there have to be the same number of probs
&lt; 0.5 as there are &gt; 0.5.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_shaded">shaded</code></td>
<td>
<p>single logical value or a vector of logical values, indicating whether or not to shade the area between the pointwise
credible intervals. If a vector is given, the first value given is used to determine if the area between the outermost credible interval
is shaded, the second for the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the
number of quantile pairs. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_quantlines">quantlines</code></td>
<td>
<p>single logical value or a vector of logical values, indicating whether or not to draw borders along the pointwise
credible intervals. If a vector is given, the first value given is used to determine whether the outermost credible interval
is marked by lines, the second for the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the
number of credible intervals. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_shadecol">shadecol</code></td>
<td>
<p>single character string or a vector of character strings. Determines the color of the shaded areas that represent
the credible intervals. If a vector is given, the first color given is used for the outermost area,
the second for the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the number
of shaded areas. Has no effect if <code>shaded = FALSE</code>. The default value is <code>"skyblue"</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_shadealpha">shadealpha</code></td>
<td>
<p>real number between 0 and 1 or a vector of real numbers between 0 and 1.
Determines the level of transparency of the shaded areas that represent
the credible intervals. If a vector is given, the first value
given is used for the outermost area, the second for the second outermost and so forth. Recycled in the usual fashion
if the vector is shorter than the number of shaded areas. Has no effect if <code>shaded = FALSE</code>.
The default value is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_quantlty">quantlty</code></td>
<td>
<p>either a single integer in [0,6] or one of the character strings <code>"blank",
"solid", "dashed", "dotted", "dotdash", "longdash", "twodash"</code> or a vector containing these. Determines the line type of the borders
drawn around the shaded areas that represent the credible intervals. Note that if a vector is supplied the elements have to either
be all integers or all character strings. If a vector is given, the first value given is used for the outermost area, the second for
the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the number of shaded areas.
Has no effect if <code>quantlines = FALSE</code>. The default value is <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_quantcol">quantcol</code></td>
<td>
<p>single character string or a vector of character strings. Determines the color of the borders drawn around the shaded
areas that represent the credible intervals. If a vector is given, the first color given is used for borders of the outermost area,
the second for the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the number
of shaded areas. Has no effect if <code>quantlines = FALSE</code>. The default value is <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_quantlwd">quantlwd</code></td>
<td>
<p>single real, positive number or a vector of real, positive numbers. Determines the line width of the borders
drawn around the shaded areas that represent the credible intervals. If a vector is given, the first number given is used for
the borders of the outermost area, the second for the second outermost and so forth. Recycled in the usual fashion if the vector
is shorter than the number of shaded areas. Has no effect if <code>quantlines = FALSE</code>. The default value is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_drawzero">drawzero</code></td>
<td>
<p>single logical value determining whether to draw a horizontal line at zero or not. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_zerolty">zerolty</code></td>
<td>
<p>single integer in [0,6] or one of the character strings <code>"blank",
"solid", "dashed", "dotted", "dotdash", "longdash", "twodash"</code>. Determines the line type of the horizontal line at zero. Has no effect
if <code>drawzero = FALSE</code>. The default value is <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_zerolwd">zerolwd</code></td>
<td>
<p>single real, positive number. Determines the line width of the horizontal line at zero. Has no effect
if <code>drawzero = FALSE</code>. The default value is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_zerocol">zerocol</code></td>
<td>
<p>single character string. Determines the color of the horizontal line at zero. Has no effect if <code>drawzero = FALSE</code>.
The default value is <code>"grey"</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.dsm.tvp_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects and returns invisibly.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other plotting functions: 
<code><a href="#topic+plot.shrinkDSM_pred">plot.shrinkDSM_pred</a>()</code>,
<code><a href="#topic+plot.shrinkDSM">plot.shrinkDSM</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
data("gastric")

# Create intervals for piecewise exponential model
intervals &lt;- divisionpoints(gastric$time, gastric$status, 2)

# Estimate model
mod &lt;- shrinkDSM(time ~ radiation, gastric,
                 delta = gastric$status, S = intervals)

# Plot piecewise constant, time-varying parameter
plot(mod$beta$beta_radiation)

</code></pre>

<hr>
<h2 id='plot.shrinkDSM'>Graphical summary of posterior distribution of fitted dynamic survival model</h2><span id='topic+plot.shrinkDSM'></span>

<h3>Description</h3>

<p><code>plot.shrinkDSM</code> generates plots visualizing the posterior distribution estimated
as a result from a call to <code>shrinkDSM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkDSM'
plot(
  x,
  pars = c("beta"),
  nplot = 3,
  h_borders = c(0.05, 0.05),
  w_borders = c(0.02, 0.02),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.shrinkDSM_+3A_x">x</code></td>
<td>
<p>a <code>shrinkDSM</code> object.</p>
</td></tr>
<tr><td><code id="plot.shrinkDSM_+3A_pars">pars</code></td>
<td>
<p>a character vector containing the names of the parameters to be visualized.
The names have to coincide with the names of the list elements of the <code>shrinkDSM</code>
object. Throws an error if any element of <code>pars</code> does not fulfill this criterium.
The default is <code>c("beta")</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkDSM_+3A_nplot">nplot</code></td>
<td>
<p>positive integer that indicates the number of tvp plots to display on a single
page before a new page is generated. The default value is 3.</p>
</td></tr>
<tr><td><code id="plot.shrinkDSM_+3A_h_borders">h_borders</code></td>
<td>
<p>single real, positive number smaller than 0.5 or a vector containing two such numbers. Determines
the relative amount of space (the total amount summing up to 1) left blank on the left and right of the plot, in that order.
The default is <code>c(0.05, 0.05)</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkDSM_+3A_w_borders">w_borders</code></td>
<td>
<p>single real, positive number smaller than 0.5 or a vector containing two such numbers. Determines
the relative amount of space (the total amount summing up to 1) left blank at the top and bottom of the plot, in that order.
The default is <code>c(0.02, 0.02)</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkDSM_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the respective plotting functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects and returns invisibly.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other plotting functions: 
<code><a href="#topic+plot.mcmc.dsm.tvp">plot.mcmc.dsm.tvp</a>()</code>,
<code><a href="#topic+plot.shrinkDSM_pred">plot.shrinkDSM_pred</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
data("gastric")

# Create intervals for piecewise exponential model
intervals &lt;- divisionpoints(gastric$time, gastric$status, 2)

# Estimate model
mod &lt;- shrinkDSM(time ~ radiation, gastric,
                 delta = gastric$status, S = intervals)
plot(mod)


# Will produce an error because 'hello' is not a parameter in the model
## Not run: 
plot(mod, pars = c("beta", "hello"))

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.shrinkDSM_pred'>Graphical summary of posterior predictive density</h2><span id='topic+plot.shrinkDSM_pred'></span>

<h3>Description</h3>

<p><code>plot.shrinkDSM_pred</code> generates plots visualizing the posterior predictive density generated by <code>predict.shrinkDSM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkDSM_pred'
plot(x, dens_args, legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.shrinkDSM_pred_+3A_x">x</code></td>
<td>
<p>a <code>shrinkDSM_pred</code> object.</p>
</td></tr>
<tr><td><code id="plot.shrinkDSM_pred_+3A_dens_args">dens_args</code></td>
<td>
<p><em>optional</em> named list containing arguments passed to <code>density</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkDSM_pred_+3A_legend">legend</code></td>
<td>
<p>logical value inidicating whether a legend should be added. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkDSM_pred_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>plots</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects and returns invisibly.
</p>


<h3>See Also</h3>

<p>Other plotting functions: 
<code><a href="#topic+plot.mcmc.dsm.tvp">plot.mcmc.dsm.tvp</a>()</code>,
<code><a href="#topic+plot.shrinkDSM">plot.shrinkDSM</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
data("gastric")

# Create intervals for piecewise exponential model
intervals &lt;- divisionpoints(gastric$time, gastric$status, 2)

# Estimate model
mod &lt;- shrinkDSM(time ~ radiation, gastric,
                 delta = gastric$status, S = intervals)

# Draw from posterior predictive distribution
newdata &lt;- data.frame(radiation = c(0, 1))
pred &lt;- predict(mod, newdata = newdata)

# Plot predictions
plot(pred)

</code></pre>

<hr>
<h2 id='predict.shrinkDSM'>Draw from posterior predictive density of a fitted time-varying parameter survival model</h2><span id='topic+predict.shrinkDSM'></span>

<h3>Description</h3>

<p>Draws from the posterior predictive distribution of survival times based on a fitted
time-varying parameter survival model resulting from a call to
<code>shrinkDSM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkDSM'
predict(object, newdata, cens = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.shrinkDSM_+3A_object">object</code></td>
<td>
<p>an object of class <code>shrinkDSM</code>, containing the fitted model.</p>
</td></tr>
<tr><td><code id="predict.shrinkDSM_+3A_newdata">newdata</code></td>
<td>
<p>a data frame containing the covariates used for the prediction.
The names of the covariates
have to match the names used during model estimation in the call to <code>shrinkDSM</code>.</p>
</td></tr>
<tr><td><code id="predict.shrinkDSM_+3A_cens">cens</code></td>
<td>
<p>logical value indicating whether the predictions should be censored at the
largest survival time in the data used for estimation.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict.shrinkDSM_+3A_...">...</code></td>
<td>
<p>included for S3 method consistency and currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is a list object of class <code>shrinkTVP_pred</code> containing the
samples from the
posterior predictive density.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>
<p>Daniel Winkler <a href="mailto:dwinkler@wu.ac.at">dwinkler@wu.ac.at</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
data("gastric")

# Create intervals for piecewise exponential model
intervals &lt;- divisionpoints(gastric$time, gastric$status, 2)

# Estimate model
mod &lt;- shrinkDSM(time ~ radiation, gastric,
                 delta = gastric$status, S = intervals)

# Draw from posterior predictive distribution
newdata &lt;- data.frame(radiation = c(0, 1))
pred &lt;- predict(mod, newdata = newdata)

</code></pre>

<hr>
<h2 id='prep_tvinput'>Prepare time-varying inputs for estimation of a dynamic survival model</h2><span id='topic+prep_tvinput'></span>

<h3>Description</h3>

<p>This function pre-processes time-varying inputs in such a way that <code>shrinkDSM</code>
can work with time-varying inputs. Its main inputs are two data frames, namely
<code>surv_data</code> and <code>covariate_data</code>. <code>surv_data</code> contains meta data about
each observation (i.e. survival time and censoring indicator), while <code>covariate_data</code>
contains the time-varying covariates (one per observation and time interval) and an
index for which time interval each covariate is observed in. The two are merged
together via an ID that needs to be unique for each observation and present in both
<code>surv_data</code> and <code>covariate_data</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_tvinput(
  surv_data,
  covariate_data,
  id_var,
  surv_var,
  delta_var,
  interval_var,
  covariate_id_var = id_var
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_tvinput_+3A_surv_data">surv_data</code></td>
<td>
<p>data frame containing meta-data for each observation (survival time and
censoring indicator) as well as an ID for each observation.</p>
</td></tr>
<tr><td><code id="prep_tvinput_+3A_covariate_data">covariate_data</code></td>
<td>
<p>data frame containing the time-varying covariates
(one per observation and time interval), an index for which time interval each covariate
is observed in as well as an ID for each observation.</p>
</td></tr>
<tr><td><code id="prep_tvinput_+3A_id_var">id_var</code></td>
<td>
<p>character string specifying the column name of the ID variable. If the name
is different in <code>surv_data</code> and <code>covariate_data</code>, <code>id_var</code> will be used in
<code>surv_data</code>, whereas <code>covariate_id_var</code> will be used in <code>covariate_data</code>.</p>
</td></tr>
<tr><td><code id="prep_tvinput_+3A_surv_var">surv_var</code></td>
<td>
<p>character string specifying the column name of the survival times in
<code>surv_data</code>.</p>
</td></tr>
<tr><td><code id="prep_tvinput_+3A_delta_var">delta_var</code></td>
<td>
<p>character string specifying the column name of the status indicators in
<code>surv_data</code>, 0 = censored or 1 = event observed..</p>
</td></tr>
<tr><td><code id="prep_tvinput_+3A_interval_var">interval_var</code></td>
<td>
<p>character string specifying the column name of the time interval ID in
<code>covariate_data</code>.</p>
</td></tr>
<tr><td><code id="prep_tvinput_+3A_covariate_id_var">covariate_id_var</code></td>
<td>
<p>character string specifying the column name of the ID variable in
<code>covariate_data</code>. Defaults to <code>id_var</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>data.frame</code> and <code>tvsurv</code> to be used as an input in
<code>shrinkDSM</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel Winkler <a href="mailto:daniel.winkler@wu.ac.at">daniel.winkler@wu.ac.at</a>
</p>
<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A toy example with 5 observations and 2 covariates, observed over 3 time periods
set.seed(123)
n_obs &lt;- 5
surv_var &lt;- round(rgamma(n_obs, 1, .1)) + 1
delta_var &lt;- sample(size = n_obs, c(0, 1), prob = c(0.2, 0.8), replace = TRUE)

surv_data &lt;- data.frame(id_var = 1:n_obs, surv_var, delta_var)

# Determine intervals
S &lt;- c(3, 11)

# Create synthetic observations for each individual
covariate_list &lt;- list()

for (i in 1:n_obs) {
  nr_periods_survived &lt;- sum(surv_var[i] &gt; S) + 1
  covariate_list[[i]] &lt;- data.frame(id_var = i,
                                    interval_var = 1:nr_periods_survived,
                                    x1 = rnorm(nr_periods_survived),
                                    x2 = rnorm(nr_periods_survived))
}

# Bind all individual covariate data frames together
# Each observation now has a covariate in each period they
# were observed in.
covariate_data &lt;- do.call(rbind, covariate_list)

# Call prep_tvinput to pre-process for shrinkDSM
merged_data &lt;- prep_tvinput(surv_data,
                            covariate_data,
                            id_var = "id_var",
                            surv_var = "surv_var",
                            delta_var = "delta_var",
                            interval_var = "interval_var")

# Can now be used in shrinkDSM
# Note that delta is now automatically extracted from merged_data,
# providing it will throw a warning
mod &lt;- shrinkDSM(surv_var ~ x1 + x2, merged_data, S = S)
</code></pre>

<hr>
<h2 id='print.shrinkDSM'>Nicer printing of shrinkDSM objects</h2><span id='topic+print.shrinkDSM'></span>

<h3>Description</h3>

<p>Nicer printing of shrinkDSM objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkDSM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.shrinkDSM_+3A_x">x</code></td>
<td>
<p>a <code>shrinkDSM</code> object.</p>
</td></tr>
<tr><td><code id="print.shrinkDSM_+3A_...">...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects and returns invisibly.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
data("gastric")

# Create intervals for piecewise exponential model
intervals &lt;- divisionpoints(gastric$time, gastric$status, 2)

# Estimate model
mod &lt;- shrinkDSM(time ~ radiation, gastric,
                 delta = gastric$status, S = intervals)

# Print
print(mod)

# Alternatively
mod

</code></pre>

<hr>
<h2 id='shrinkDSM'>Markov Chain Monte Carlo (MCMC) for time-varying parameter survival models with shrinkage</h2><span id='topic+shrinkDSM'></span>

<h3>Description</h3>

<p><code>shrinkDSM</code> samples from the joint posterior distribution of the parameters of a time-varying
parameter survival model with shrinkage and returns the MCMC draws.
See also <code>shrinkTVP</code> to see more examples of how to modify the prior setup of the time-varying
component of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shrinkDSM(
  formula,
  data,
  mod_type = "double",
  delta,
  S,
  group,
  subset,
  niter = 10000,
  nburn = round(niter/2),
  nthin = 1,
  learn_a_xi = TRUE,
  learn_a_tau = TRUE,
  a_xi = 0.1,
  a_tau = 0.1,
  learn_c_xi = TRUE,
  learn_c_tau = TRUE,
  c_xi = 0.1,
  c_tau = 0.1,
  a_eq_c_xi = FALSE,
  a_eq_c_tau = FALSE,
  learn_kappa2_B = TRUE,
  learn_lambda2_B = TRUE,
  kappa2_B = 20,
  lambda2_B = 20,
  hyperprior_param,
  sv_param,
  MH_tuning,
  phi_param,
  display_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shrinkDSM_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;: a symbolic representation of the model, as in the
function <code>lm</code>. For details, see <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_data">data</code></td>
<td>
<p><em>optional</em> data frame containing the response variable and the covariates. If not found in <code>data</code>,
the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>shrinkDSM</code>
is called. No <code>NA</code>s are allowed in the response variable and the covariates.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_mod_type">mod_type</code></td>
<td>
<p>character string that reads either <code>"triple"</code>, <code>"double"</code> or <code>"ridge"</code>.
Determines whether the triple gamma, double gamma or ridge prior are used for <code>theta_sr</code> and <code>beta_mean</code>.
The default is &quot;double&quot;.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_delta">delta</code></td>
<td>
<p>The status indicator of the last period, 0 = censored or 1 = event observed.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_s">S</code></td>
<td>
<p>integer vector of time points that start a new interval.
Parameters are fixed within an interval and vary across intervals.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_group">group</code></td>
<td>
<p><em>optional</em> grouping indicator for latent factor.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_subset">subset</code></td>
<td>
<p><em>optional</em> vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_niter">niter</code></td>
<td>
<p>positive integer, indicating the number of MCMC iterations
to perform, including the burn-in. Has to be larger than or equal to <code>nburn</code> + 2. The default value is 10000.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_nburn">nburn</code></td>
<td>
<p>non-negative integer, indicating the number of iterations discarded
as burn-in. Has to be smaller than or equal to <code>niter</code> - 2. The default value is <code>round(niter / 2)</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_nthin">nthin</code></td>
<td>
<p>positive integer, indicating the degree of thinning to be performed. Every <code>nthin</code> draw is kept and returned.
The default value is 1, implying that every draw is kept.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_learn_a_xi">learn_a_xi</code></td>
<td>
<p>logical value indicating whether to learn a_xi, the spike parameter of the state variances.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_learn_a_tau">learn_a_tau</code></td>
<td>
<p>logical value indicating whether to learn a_tau, the spike parameter of the mean of the
initial values of the states. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_a_xi">a_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_xi. Ignored if
<code>learn_a_xi</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_a_tau">a_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_tau. Ignored if
<code>learn_a_tau</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_learn_c_xi">learn_c_xi</code></td>
<td>
<p>logical value indicating whether to learn c_xi, the tail parameter of the state variances.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_xi</code> is set to <code>TRUE</code>.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_learn_c_tau">learn_c_tau</code></td>
<td>
<p>logical value indicating whether to learn c_tau, the tail parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_tau</code> is set to <code>TRUE</code>.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_c_xi">c_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_xi. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code>, <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_xi</code> is set to <code>TRUE</code>.
The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_c_tau">c_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_tau. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code>, <code>mod_type</code> is not set to <code>"triple"</code>  or <code>a_eq_c_tau</code> is set to <code>TRUE</code>.
The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_a_eq_c_xi">a_eq_c_xi</code></td>
<td>
<p>logical value indicating whether to force <code>a_xi</code> and <code>c_xi</code> to be equal.
If set to <code>TRUE</code>, <code>beta_a_xi</code> and <code>alpha_a_xi</code> are used as the hyperparameters and <code>beta_c_xi</code> and <code>alpha_c_xi</code> are ignored.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_a_eq_c_tau">a_eq_c_tau</code></td>
<td>
<p>logical value indicating whether to force <code>a_tau</code> and <code>c_tau</code> to be equal.
If set to <code>TRUE</code>, <code>beta_a_tau</code> and <code>alpha_a_tau</code> are used as the hyperparameters and <code>beta_c_tau</code> and <code>alpha_c_tau</code> are ignored.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_learn_kappa2_b">learn_kappa2_B</code></td>
<td>
<p>logical value indicating whether to learn kappa2_B, the global level of shrinkage for
the state variances. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_learn_lambda2_b">learn_lambda2_B</code></td>
<td>
<p>logical value indicating whether to learn the lambda2_B parameter,
the global level of shrinkage for the mean of the initial values of the states. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_kappa2_b">kappa2_B</code></td>
<td>
<p>positive, real number. Initial value of kappa2_B. The default value is 20.</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_lambda2_b">lambda2_B</code></td>
<td>
<p>positive, real number. Initial value of lambda2_B. The default value is</p>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_hyperprior_param">hyperprior_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values.
Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
All hyperparameter values have to be positive, real numbers. The following hyperparameters can be
supplied:
</p>

<ul>
<li> <p><code>e1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>e2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>beta_a_xi</code>: The default value is 10.
</p>
</li>
<li> <p><code>beta_a_tau</code>: The default value is 10.
</p>
</li>
<li> <p><code>alpha_a_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>alpha_a_tau</code>: The default value is 5.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_sv_param">sv_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values for the stochastic volatility
parameters. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown. Ignored if
<code>group</code> is missing. The following elements can be supplied:
</p>

<ul>
<li> <p><code>Bsigma_sv</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a0_sv</code>: positive, real number. The default value is 5.
</p>
</li>
<li> <p><code>b0_sv</code>: positive, real number. The default value is 1.5.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_mh_tuning">MH_tuning</code></td>
<td>
<p><em>optional</em> named list containing values used to tune the MH steps for <code>a_xi</code> and <code>a_tau</code>. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
The arguments for <code>a_xi</code>(<code>a_tau</code>) are only used if <code>learn_a_xi</code>(<code>learn_a_tau</code>)
is set to <code>TRUE</code>. Arguments ending in &quot;adaptive&quot; are
logical values indicating whether or not to make the MH step for the respective parameter adaptive. Arguments ending in &quot;tuning_par&quot; serve two different purposes.
If the respective MH step is not set to be adaptive, it acts as the standard deviation of the proposal distribution. If the respective MH step
is set to be adaptive, it acts as the initial standard deviation. Arguments ending in &quot;target_rate&quot; define the acceptance rate the algorithm aims to achieve.
Arguments ending in &quot;max_adapt&quot; set the maximum value by which the logarithm of the standard deviation of the proposal distribution is adjusted. Finally,
arguments ending in &quot;batch_size&quot; set the batch size after which the standard deviation of the proposal distribution is adjusted.
The following elements can be supplied:
</p>

<ul>
<li> <p><code>a_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>a_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_phi_param">phi_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values for the grouped factor
and values to tune the MH steps for <code>a_phi</code> and <code>c_phi</code>. Not all have to be supplied, with
those missing being replaced by the default values. Any list elements that are misnamed will be ignored
and a warning will be thrown. Ignored if <code>group</code> is missing. The following elements can be supplied:
</p>

<ul>
<li> <p><code>mod_type_phi</code> character string that reads either <code>"triple"</code>, <code>"double"</code> or <code>"ridge"</code>. Determines whether the triple gamma, double gamma or ridge prior are used for <code>phi</code>. The default is &quot;double&quot;.
</p>
</li>
<li> <p><code>learn_a_phi</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_phi</code>: positive, real number. The default value is 0.1.
</p>
</li>
<li> <p><code>learn_c_phi</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_phi</code>: positive, real number. The default value is  0.1,
</p>
</li>
<li> <p><code>a_phi_eq_c_phi</code>: logical value. The default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>learn_lambda2_B_phi</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>lambda2_B_phi</code>: positive, real number. The default value is 20.
</p>
</li>
<li> <p><code>e1_phi</code>: positive, real number. The default value is 0.001.
</p>
</li>
<li> <p><code>e2_phi</code>: positive, real number. The default value is 0.001.
</p>
</li>
<li> <p><code>beta_a_phi</code>: positive, real number. The default value is 10.
</p>
</li>
<li> <p><code>alpha_a_phi</code>: positive, real number. The default value is 5.
</p>
</li>
<li> <p><code>beta_c_phi</code>: positive, real number. The default value is 10.
</p>
</li>
<li> <p><code>alpha_c_phi</code>: positive, real number. The default value is 5.
</p>
</li>
<li> <p><code>a_phi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_phi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_phi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_phi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_phi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_phi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_phi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_phi_target_rate</code>:  positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_phi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_phi_batch_size</code>: positive integer. The default value is 50.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkDSM_+3A_display_progress">display_progress</code></td>
<td>
<p>logical value indicating whether the progress bar and other informative output should be
displayed. The default value is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is a list object of class <code>shrinkDSM</code> containing
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p><code>list</code> object containing an <code>mcmc.dsm.tvp</code> object for the parameter draws from the posterior distribution of the centered
states, one for each covariate. In the case that there is only one covariate, this becomes just a single <code>mcmc.dsm.tvp</code> object.</p>
</td></tr>
<tr><td><code>beta_mean</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of beta_mean.</p>
</td></tr>
<tr><td><code>theta_sr</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of the square root of theta.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of tau2.</p>
</td></tr>
<tr><td><code>xi2</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of xi2.</p>
</td></tr>
<tr><td><code>lambda2</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of lambda2.
Not returned if <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>kappa2</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of kappa2.
Not returned if <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>a_xi</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of a_xi.
Not returned if <code>learn_a_xi</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>a_tau</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of a_tau.
Not returned if <code>learn_a_tau</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>c_xi</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of c_xi.
Not returned if <code>learn_c_xi</code> is <code>FALSE</code> or <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>c_tau</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of c_tau.
Not returned if <code>learn_c_tau</code> is <code>FALSE</code> or <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>lambda2_B</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of lambda2_B.
Not returned if <code>learn_lambda2_B</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>kappa2_B</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of kappa2_B.
Not returned if <code>learn_kappa2_B</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>MH_diag</code></td>
<td>
<p><em>(optional)</em> named list containing statistics for assessing MH performance. Not returned if no MH steps are required
or none of them are specified to be adaptive.</p>
</td></tr>
<tr><td><code>priorvals</code></td>
<td>
<p><code>list</code> object containing hyperparameter values of the prior distributions, as specified by the user.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p><code>list</code> object containing the model matrix, model response and formula used.</p>
</td></tr>
<tr><td><code>summaries</code></td>
<td>
<p><code>list</code> object containing a collection of summary statistics of the posterior draws.</p>
</td></tr>
</table>
<p>To display the output, use <code>plot</code> and <code>summary</code>. The <code>summary</code> method displays the specified prior values stored in
<code>priorvals</code> and the posterior summaries stored in <code>summaries</code>, while the <code>plot</code> method calls <code>coda</code>'s <code>plot.mcmc</code>
or the <code>plot.mcmc.dsm.tvp</code> method. Furthermore, all functions that can be applied to <code>coda::mcmc</code> objects
(e.g. <code>coda::acfplot</code>) can be applied to all output elements that are <code>coda</code> compatible.
</p>


<h3>Author(s)</h3>

<p>Daniel Winkler <a href="mailto:daniel.winkler@wu.ac.at">daniel.winkler@wu.ac.at</a>
</p>
<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
data("gastric")

# Create intervals for piecewise exponential model
intervals &lt;- divisionpoints(gastric$time, gastric$status, 2)

# Estimate baseline model
mod &lt;- shrinkDSM(time ~ radiation, gastric,
                 delta = gastric$status, S = intervals)

# Estimate model with different prior setup
mod2 &lt;- shrinkDSM(time ~ radiation, gastric,
                 delta = gastric$status, S = intervals,
                 mod_type = "triple")

# Change some of the hyperparameters
mod3 &lt;- shrinkDSM(time ~ radiation, gastric,
                 delta = gastric$status, S = intervals,
                 mod_type = "triple",
                 hyperprior_param = list(beta_a_xi = 5,
                                         alpha_a_xi = 10))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
