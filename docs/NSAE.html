<!DOCTYPE html><html lang="en"><head><title>Help for package NSAE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NSAE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eblupFH1'><p>EBLUP under stationary Fay-Herriot model for sample area</p></a></li>
<li><a href='#eblupFH2'><p>EBLUP under stationary Fay-Herriot model for sample and  non-sample area</p></a></li>
<li><a href='#eblupNSFH1'><p>EBLUP under nonstationary Fay-Herriot model for sample area</p></a></li>
<li><a href='#eblupNSFH2'><p>EBLUP under nonstationary Fay-Herriot model for sample and  non-sample area</p></a></li>
<li><a href='#ebp'><p>EBP for proportion under generalized linear mixed model</p></a></li>
<li><a href='#ebpNP'><p>Nonparametric ebp using spatial spline for proportion under generalized linear mixed model</p></a></li>
<li><a href='#ebpNS'><p>Nonstationary ebp for proportion under generalized linear mixed model</p></a></li>
<li><a href='#ebpSP'><p>Spatial ebp for proportion under generalized linear mixed model</p></a></li>
<li><a href='#headcount'><p>Head count data</p></a></li>
<li><a href='#NS.test'><p>Parametric bootstrap-based spatial nonstationarity test for Fay-Herroit model</p></a></li>
<li><a href='#NSAE'><p>NSAE : Nonstationary Small Area Estimation</p></a></li>
<li><a href='#NSglm.test'><p>Parametric bootstrap-based spatial nonstationarity test for generalized linear mixed model</p></a></li>
<li><a href='#paddy'><p>Yield data of paddy</p></a></li>
<li><a href='#paddysample'><p>Yield data of paddy for sample area</p></a></li>
<li><a href='#Wmatrix'><p>Proximity matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonstationary Small Area Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Saurav Guha &lt;saurav.iasri@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Executes nonstationary Fay-Herriot model and nonstationary generalized linear mixed model for small area estimation.The empirical best linear unbiased predictor (EBLUP) under stationary and nonstationary Fay-Herriot models and empirical best predictor (EBP) under nonstationary generalized linear mixed model along with the mean squared error estimation are included. EBLUP for prediction of non-sample area is also included under both stationary and nonstationary Fay-Herriot models. This extension to the Fay-Herriot model that accounts for the presence  of spatial nonstationarity was developed by Hukum Chandra, Nicola Salvati and Ray Chambers (2015) &lt;<a href="https://doi.org/10.1093%2Fjssam%2Fsmu026">doi:10.1093/jssam/smu026</a>&gt; and nonstationary generalized linear mixed model was developed by Hukum  Chandra, Nicola Salvati and Ray Chambers (2017) &lt;<a href="https://doi.org/10.1016%2Fj.spasta.2017.01.004">doi:10.1016/j.spasta.2017.01.004</a>&gt;. This package is dedicated to the memory of Dr. Hukum Chandra who passed away while the package creation was in progress.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>rlist,cluster,MASS,lattice,Matrix,numDeriv,nlme,spgwr,SemiPar</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-27 11:57:48 UTC; saura</td>
</tr>
<tr>
<td>Author:</td>
<td>Hukum Chandra [aut],
  Nicola Salvati [aut],
  Ray Chambers [aut],
  Saurav Guha [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-27 12:40:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='eblupFH1'>EBLUP under stationary Fay-Herriot model for sample area</h2><span id='topic+eblupFH1'></span>

<h3>Description</h3>

<p>This function gives the EBLUP and the estimate of mean squared error (mse)
based on a stationary Fay-Herriot model for sample area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblupFH1(formula, vardir, method = "REML", MAXITER, PRECISION, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblupFH1_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="eblupFH1_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="eblupFH1_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; method</p>
</td></tr>
<tr><td><code id="eblupFH1_+3A_maxiter">MAXITER</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="eblupFH1_+3A_precision">PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="eblupFH1_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt><dd><p>a vector with the values of the estimators for each small area</p>
</dd>
<dt>mse</dt><dd><p>a vector of the mean squared error estimates for each small area</p>
</dd>
<dt>sample</dt><dd><p>a matrix consist of area code, eblup, mse, standard error (SE) and coefficient of variation (CV)</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> estcoef : a data frame with the estimated model coefficients in the first column (beta),
their asymptotic standard errors in the second column (std.error), the t statistics in
the third column (tvalue) and the p-values of the significance of each coefficient in
last column (pvalue)
</p>
</li>
<li><p> refvar : estimated random effects variance
</p>
</li>
<li><p> goodness : goodness of fit statistics
</p>
</li>
<li><p> randomeffect : a data frame with the values of the random effect estimators
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(paddysample)
# Fit Fay-Herriot model using sample part of paddy data
result &lt;- eblupFH1(y ~ x1+x2, var, "REML", 100, 1e-04,paddysample)
result
</code></pre>

<hr>
<h2 id='eblupFH2'>EBLUP under stationary Fay-Herriot model for sample and  non-sample area</h2><span id='topic+eblupFH2'></span>

<h3>Description</h3>

<p>This function gives the EBLUP and the estimate of mean squared error (mse)
based on a stationary Fay-Herriot model for both sample and non-sample area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblupFH2(formula, vardir, indicator, method = "REML", MAXITER, PRECISION, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblupFH2_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="eblupFH2_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="eblupFH2_+3A_indicator">indicator</code></td>
<td>
<p>a vector indicating the sample and non-sample area</p>
</td></tr>
<tr><td><code id="eblupFH2_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; methods</p>
</td></tr>
<tr><td><code id="eblupFH2_+3A_maxiter">MAXITER</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="eblupFH2_+3A_precision">PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="eblupFH2_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt><dd><p>a vector with the values of the estimators for each sample area</p>
</dd>
<dt>eblup.out</dt><dd><p>a vector with the values of the estimators for each non-sample area</p>
</dd>
<dt>mse</dt><dd><p>a vector of the mean squared error estimates for each sample area</p>
</dd>
<dt>mse.out</dt><dd><p>a vector of the mean squared error estimates for each non-sample area</p>
</dd>
<dt>sample</dt><dd><p>a matrix consist of area code, eblup, mse, SE and CV for sample area</p>
</dd>
<dt>nonsample</dt><dd><p>a matrix consist of area code, eblup, mse, SE and CV for non-sample area</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> estcoef : a data frame with the estimated model coefficients in the first column (beta),their asymptotic standard errors in the second column (std.error), the t statistics in the third column (tvalue) and the p-values of the significance of each coefficient in last column (pvalue)
</p>
</li>
<li><p> refvar : estimated random effects variance
</p>
</li>
<li><p> goodness : goodness of fit statistics
</p>
</li>
<li><p> randomeffect : a data frame with the values of the random effect estimators
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(paddy)
# Fit Fay-Herriot model using sample and non-sample part of paddy data
result &lt;- eblupFH2(y ~ x1+x2, var, indicator ,"REML", 100, 1e-04,paddy)
result
</code></pre>

<hr>
<h2 id='eblupNSFH1'>EBLUP under nonstationary Fay-Herriot model for sample area</h2><span id='topic+eblupNSFH1'></span>

<h3>Description</h3>

<p>This function gives the EBLUP and the estimate of mean squared error (mse)
based on a nonstationary Fay-Herriot model for sample area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblupNSFH1(
  formula,
  vardir,
  lat,
  long,
  method = "REML",
  MAXITER,
  PRECISION,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblupNSFH1_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="eblupNSFH1_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="eblupNSFH1_+3A_lat">lat</code></td>
<td>
<p>a vector of latitude for each small area</p>
</td></tr>
<tr><td><code id="eblupNSFH1_+3A_long">long</code></td>
<td>
<p>a vector of longitude for each small area</p>
</td></tr>
<tr><td><code id="eblupNSFH1_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; methods</p>
</td></tr>
<tr><td><code id="eblupNSFH1_+3A_maxiter">MAXITER</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="eblupNSFH1_+3A_precision">PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="eblupNSFH1_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula, vardir, lat and long</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt><dd><p>a vector with the values of the estimators for each small area</p>
</dd>
<dt>mse</dt><dd><p>a vector of the mean squared error estimates for each small area</p>
</dd>
<dt>sample</dt><dd><p>a matrix consist of area code, eblup, mse, SE and CV</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> estcoef : a data frame with the estimated model coefficients in the first column (beta),their asymptotic standard errors in the second column (std.error), the t statistics in  the third column (tvalue) and the p-values of the significance of each coefficient in last column (pvalue)
</p>
</li>
<li><p> refvar : estimated random effects variance
</p>
</li>
<li><p> spatialcorr : spatial correlation parameter
</p>
</li>
<li><p> randomeffect : a data frame with the values of the random effect estimators
</p>
</li>
<li><p> goodness : goodness of fit statistics
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(paddysample)
# Fit nonstationary Fay-Herriot model using sample part of paddy data
result &lt;- eblupNSFH1(y ~ x1+x2, var, latitude, longitude, "REML", 100, 1e-04,paddysample)
result
</code></pre>

<hr>
<h2 id='eblupNSFH2'>EBLUP under nonstationary Fay-Herriot model for sample and  non-sample area</h2><span id='topic+eblupNSFH2'></span>

<h3>Description</h3>

<p>This function gives the EBLUP and the estimate of mean squared error (mse)
based on a nonstationary Fay-Herriot model for both sample and non-sample area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblupNSFH2(
  formula,
  vardir,
  lat,
  long,
  indicator,
  method = "REML",
  MAXITER,
  PRECISION,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblupNSFH2_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="eblupNSFH2_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="eblupNSFH2_+3A_lat">lat</code></td>
<td>
<p>a vector of latitude for each small area</p>
</td></tr>
<tr><td><code id="eblupNSFH2_+3A_long">long</code></td>
<td>
<p>a vector of longitude for each small area</p>
</td></tr>
<tr><td><code id="eblupNSFH2_+3A_indicator">indicator</code></td>
<td>
<p>a vector indicating the sample and non-sample area</p>
</td></tr>
<tr><td><code id="eblupNSFH2_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; methods</p>
</td></tr>
<tr><td><code id="eblupNSFH2_+3A_maxiter">MAXITER</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="eblupNSFH2_+3A_precision">PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="eblupNSFH2_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula, vardir, lat and long</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt><dd><p>a vector with the values of the estimators for each sample area</p>
</dd>
<dt>eblup.out</dt><dd><p>a vector with the values of the estimators for each non-sample area</p>
</dd>
<dt>mse</dt><dd><p>a vector of the mean squared error estimates for each sample area</p>
</dd>
<dt>mse.out</dt><dd><p>a vector of the mean squared error estimates for each non-sample area</p>
</dd>
<dt>sample</dt><dd><p>a matrix consist of area code, eblup, mse, SE and CV for sample area</p>
</dd>
<dt>nonsample</dt><dd><p>a matrix consist of area code, eblup, mse, SE and CV for non-sample area</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> estcoef : a data frame with the estimated model coefficients in the first column (beta),their asymptotic standard errors in the second column (std.error), the t statistics in the third column (tvalue) and the p-values of the significance of each coefficient in last column (pvalue)
</p>
</li>
<li><p> refvar : estimated random effects variance
</p>
</li>
<li><p> spatialcorr : estimated spatial correlation parameter
</p>
</li>
<li><p> randomeffect : a data frame with the values of the random effect estimators
</p>
</li>
<li><p> goodness : goodness of fit statistics
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(paddy)
# Fit nonstationary Fay-Herriot model using sample and non-sample part of paddy data
result &lt;- eblupNSFH2(y ~ x1+x2, var, latitude, longitude, indicator , "REML", 100, 1e-04,paddy)
result
</code></pre>

<hr>
<h2 id='ebp'>EBP for proportion under generalized linear mixed model</h2><span id='topic+ebp'></span>

<h3>Description</h3>

<p>This function gives the ebp and the estimate of mean squared error (mse) for proportion
based on a generalized linear mixed model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebp(
  formula,
  vardir,
  Ni,
  ni,
  method = "REML",
  maxit = 100,
  precision = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ebp_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="ebp_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="ebp_+3A_ni">Ni</code></td>
<td>
<p>a vector of population size for each small area</p>
</td></tr>
<tr><td><code id="ebp_+3A_ni">ni</code></td>
<td>
<p>a vector of sample size for each small area</p>
</td></tr>
<tr><td><code id="ebp_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; method</p>
</td></tr>
<tr><td><code id="ebp_+3A_maxit">maxit</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="ebp_+3A_precision">precision</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="ebp_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>ebp</dt><dd><p>a vector with the values of the estimators for each small area</p>
</dd>
<dt>mse</dt><dd><p>a vector of the mean squared error estimates for each small area</p>
</dd>
<dt>sample</dt><dd><p>a matrix consist of area code, ebp, mse, standard error (SE) and coefficient of variation (CV)</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> estcoef : a data frame with the estimated model coefficients in the first column (beta),
their asymptotic standard errors in the second column (std.error), the t statistics in
the third column (tvalue) and the p-values of the significance of each coefficient in
last column (pvalue)
</p>
</li>
<li><p> refvar : estimated random effects variance
</p>
</li>
<li><p> randomeffect : a data frame with the values of the random effect estimators
</p>
</li>
<li><p> loglike : value of the loglikelihood
</p>
</li>
<li><p> deviance : value of the deviance
</p>
</li>
<li><p> loglike1 : value of the restricted loglikelihood
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(headcount)
# Fit generalized linear mixed model using HCR data
result &lt;- ebp(y~x1, var, N, n,"REML",100,1e-04, headcount)
result
</code></pre>

<hr>
<h2 id='ebpNP'>Nonparametric ebp using spatial spline for proportion under generalized linear mixed model</h2><span id='topic+ebpNP'></span>

<h3>Description</h3>

<p>This function gives the nonparametric ebp and the estimate of mean squared error (mse) for proportion
based on a nonstationary generalized linear mixed model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebpNP(
  formula,
  vardir,
  n.knot,
  Ni,
  ni,
  lat,
  lon,
  method = "REML",
  maxit = 100,
  precision = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ebpNP_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_n.knot">n.knot</code></td>
<td>
<p>number of knot in spatial splines. Default is 25 knot</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_ni">Ni</code></td>
<td>
<p>a vector of population size for each small area</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_ni">ni</code></td>
<td>
<p>a vector of sample size for each small area</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_lat">lat</code></td>
<td>
<p>a vector of latitude for each small area</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_lon">lon</code></td>
<td>
<p>a vector of longitude for each small area</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; method</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_maxit">maxit</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_precision">precision</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="ebpNP_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>ebp</dt><dd><p>a vector with the values of the estimators for each small area</p>
</dd>
<dt>mse</dt><dd><p>a vector of the mean squared error estimates for each small area</p>
</dd>
<dt>sample</dt><dd><p>a matrix consist of area code, ebp, mse, standard error (SE) and coefficient of variation (CV)</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> estcoef : a data frame with the estimated model coefficients in the first column (beta),
their asymptotic standard errors in the second column (std.error), the t statistics in
the third column (tvalue) and the p-values of the significance of each coefficient in
last column (pvalue)
</p>
</li>
<li><p> refvar : estimated random effects variance
</p>
</li>
<li><p> lambda : estimated spatial intensity paprameter
</p>
</li>
<li><p> randomeffect : a data frame with the values of the area specific random effect
</p>
</li>
<li><p> gamma : a data frame with the values of the spatially correlated random effect
</p>
</li>
<li><p> variance : a covariance matrix of estimated variance components
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(headcount)
# Fit a nonparametric generalized linear mixed model using headcount data
result &lt;- ebpNP(y~x1, var,25, N, n,  lat, long, "REML", 100, 1e-04,headcount)
result
</code></pre>

<hr>
<h2 id='ebpNS'>Nonstationary ebp for proportion under generalized linear mixed model</h2><span id='topic+ebpNS'></span>

<h3>Description</h3>

<p>This function gives the nonstationary ebp and the estimate of mean squared error (mse) for proportion
based on a generalized linear mixed model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebpNS(
  formula,
  vardir,
  Ni,
  ni,
  lat,
  lon,
  method = "REML",
  maxit = 100,
  precision = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ebpNS_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_ni">Ni</code></td>
<td>
<p>a vector of population size for each small area</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_ni">ni</code></td>
<td>
<p>a vector of sample size for each small area</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_lat">lat</code></td>
<td>
<p>a vector of latitude for each small area</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_lon">lon</code></td>
<td>
<p>a vector of longitude for each small area</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; method</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_maxit">maxit</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_precision">precision</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="ebpNS_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>ebp</dt><dd><p>a vector with the values of the estimators for each small area</p>
</dd>
<dt>mse</dt><dd><p>a vector of the mean squared error estimates for each small area</p>
</dd>
<dt>sample</dt><dd><p>a matrix consist of area code, ebp, mse, standard error (SE) and coefficient of variation (CV)</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> estcoef : a data frame with the estimated model coefficients in the first column (beta),
their asymptotic standard errors in the second column (std.error), the t statistics in
the third column (tvalue) and the p-values of the significance of each coefficient in
last column (pvalue)
</p>
</li>
<li><p> refvar : estimated random effects variance
</p>
</li>
<li><p> lambda : estimated spatial intensity parameter
</p>
</li>
<li><p> randomeffect : a data frame with the values of the area specific random effect
</p>
</li>
<li><p> gamma : a data frame with the values of the spatially correlated random effect
</p>
</li>
<li><p> variance : a covariance matrix of estimated variance components
</p>
</li>
<li><p> loglike : value of the loglikelihood
</p>
</li>
<li><p> deviance : value of the deviance
</p>
</li>
<li><p> loglike1 : value of the restricted loglikelihood
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(headcount)
# Fit a nonstationary generalized linear mixed model using headcount data
result &lt;- ebpNS(y~x1, var, N, n, lat, long, "REML", 100, 1e-04, headcount)
result
</code></pre>

<hr>
<h2 id='ebpSP'>Spatial ebp for proportion under generalized linear mixed model</h2><span id='topic+ebpSP'></span>

<h3>Description</h3>

<p>This function gives the spatial ebp and the estimate of mean squared error (mse) for proportion
based on a generalized linear mixed model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebpSP(
  formula,
  vardir,
  Ni,
  ni,
  proxmat,
  method = "REML",
  maxit = 100,
  precision = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ebpSP_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="ebpSP_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="ebpSP_+3A_ni">Ni</code></td>
<td>
<p>a vector of population size for each small area</p>
</td></tr>
<tr><td><code id="ebpSP_+3A_ni">ni</code></td>
<td>
<p>a vector of sample size for each small area</p>
</td></tr>
<tr><td><code id="ebpSP_+3A_proxmat">proxmat</code></td>
<td>
<p>a D*D proximity matrix of D small areas. The matrix must be row-standardized.</p>
</td></tr>
<tr><td><code id="ebpSP_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; method</p>
</td></tr>
<tr><td><code id="ebpSP_+3A_maxit">maxit</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="ebpSP_+3A_precision">precision</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="ebpSP_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>ebp</dt><dd><p>a vector with the values of the estimators for each small area</p>
</dd>
<dt>mse</dt><dd><p>a vector of the mean squared error estimates for each small area</p>
</dd>
<dt>sample</dt><dd><p>a matrix consist of area code, ebp, mse, standard error (SE) and coefficient of variation (CV)</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> estcoef : a data frame with the estimated model coefficients in the first column (beta),
their asymptotic standard errors in the second column (std.error), the t statistics in
the third column (tvalue) and the p-values of the significance of each coefficient in
last column (pvalue)
</p>
</li>
<li><p> refvar : estimated random effects variance
</p>
</li>
<li><p> rho : estimated spatial correlation
</p>
</li>
<li><p> randomeffect : a data frame with the values of the area specific random effect
</p>
</li>
<li><p> variance : a covariance matrix of estimated variance components
</p>
</li>
<li><p> loglike : value of the loglikelihood
</p>
</li>
<li><p> deviance : value of the deviance
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(headcount)
# Fit a generalized linear mixed model with SAR spcification using headcount data
result &lt;- ebpSP(ps~x1, var, N, n, Wmatrix, "REML", 100, 1e-04, headcount)
result
</code></pre>

<hr>
<h2 id='headcount'>Head count data</h2><span id='topic+headcount'></span>

<h3>Description</h3>

<p>Dataset on head count used by Chandra et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(headcount)
</code></pre>


<h3>Format</h3>

<p>A data frame with 71 observations on the following 11 variables:
</p>

<dl>
<dt>Area</dt><dd><p>Small area code</p>
</dd>
<dt>lat</dt><dd><p>Latitude of each small areas</p>
</dd>
<dt>long</dt><dd><p>Longitude of each small areas</p>
</dd>
<dt>N</dt><dd><p>Sample size of each small areas</p>
</dd>
<dt>n</dt><dd><p>Sample size of each small areas</p>
</dd>
<dt>y</dt><dd><p>Head count (direct estimates for the small areas)</p>
</dd>
<dt>ps</dt><dd><p>proportion of head count</p>
</dd>
<dt>var</dt><dd><p>Estimated variance</p>
</dd>
<dt>x1</dt><dd><p>First covariate used by Chandra et al. (2017)</p>
</dd>
<dt>x2</dt><dd><p>Second covariate used by Chandra et al. (2017)</p>
</dd>
<dt>x3</dt><dd><p>Second covariate  used by Chandra et al. (2017)</p>
</dd>
</dl>



<h3>Reference</h3>

<p>Chandra, H., Salvati, N., &amp; Chambers, R. (2017). Small area prediction of counts under a non-stationary spatial model. Spatial Statistics. 20. 30-56. DOI:10.1016/j.spasta.2017.01.004.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(headcount)
y &lt;- headcount$y
summary(y)
</code></pre>

<hr>
<h2 id='NS.test'>Parametric bootstrap-based spatial nonstationarity test for Fay-Herroit model</h2><span id='topic+NS.test'></span>

<h3>Description</h3>

<p>This function performs a parametric bootstrap-based test procudure for testing spatial nonstationarity in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NS.test(formula, vardir, lat, long, iter = 100, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NS.test_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="NS.test_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="NS.test_+3A_lat">lat</code></td>
<td>
<p>a vector of latitude for each small area</p>
</td></tr>
<tr><td><code id="NS.test_+3A_long">long</code></td>
<td>
<p>a vector of longitude for each small area</p>
</td></tr>
<tr><td><code id="NS.test_+3A_iter">iter</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="NS.test_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with class &quot;htest&quot; containing the following components:
</p>

<dl>
<dt>method</dt><dd><p>a character string indicating what type of test was performed.</p>
</dd>
<dt>p.value</dt><dd><p>the p-value for the test.</p>
</dd>
<dt>data.name</dt><dd><p>a character string giving the name of the data.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(paddysample)
# Testing spatial nonstationarity of the data
result &lt;- NS.test(y ~ x1+x2, var, latitude, longitude, iter=50, data = paddysample[1:10,])
result
</code></pre>

<hr>
<h2 id='NSAE'>NSAE : Nonstationary Small Area Estimation</h2><span id='topic+NSAE'></span>

<h3>Description</h3>

<p>Executes nonstationary Fay-Herriot model and nonstationary generalized linear mixed model for small area estimation. It produces empirical best linear unbiased predictor (EBLUP) and empirical best predictor (EBP) under stationary and nonstationary Fay-Herriot models. Functions give EBLUP and EBP estimators along with their mean squared error (MSE) estimator for each model. The nonstationary Fay-Herriot model was developed by Hukum  Chandra, Nicola Salvati and Ray Chambers (2015) &lt;doi:10.1093/jssam/smu026&gt; and the nonstationary generalized linear mixed model was developed by Hukum  Chandra, Nicola Salvati and Ray Chambers (2017) &lt;doi:10.1016/j.spasta.2017.01.004&gt;.
</p>


<h3>Author(s)</h3>

<p>Hukum  Chandra, Nicola Salvati, Ray Chambers, Saurav Guha
</p>
<p>Maintainer: Saurav Guha <a href="mailto:saurav.iasri@gmail.com">saurav.iasri@gmail.com</a>
</p>


<h3>Functions</h3>


<dl>
<dt><code><a href="#topic+eblupFH1">eblupFH1</a></code></dt><dd><p>Provides the EBLUPs and MSE under stationary Fay-Herriot model for sample area</p>
</dd>
<dt><code><a href="#topic+eblupFH2">eblupFH2</a></code></dt><dd><p>Provides the EBLUPs and MSE under stationary Fay-Herriot model for sample and non-sample area</p>
</dd>
<dt><code><a href="#topic+eblupNSFH1">eblupNSFH1</a></code></dt><dd><p>Provides the EBLUPs and MSE under nonstationary Fay-Herriot model for sample area</p>
</dd>
<dt><code><a href="#topic+eblupNSFH2">eblupNSFH2</a></code></dt><dd><p>Provides the EBLUPs and MSE under nonstationary Fay-Herriot model for sample and non-sample area</p>
</dd>
<dt><code><a href="#topic+NS.test">NS.test</a></code></dt><dd><p>Provides a p-value for testing spatial nonstationarity in the data under Fay-Herriot model.</p>
</dd>
<dt><code><a href="#topic+ebp">ebp</a></code></dt><dd><p>Provides the EBPs and MSE under stationary generalized linear mixed model.</p>
</dd>
<dt><code><a href="#topic+ebpNS">ebpNS</a></code></dt><dd><p>Provides the EBPs and MSE under nonstationary generalized linear mixed model.</p>
</dd>
<dt><code><a href="#topic+ebpSP">ebpSP</a></code></dt><dd><p>Provides the EBPs and MSE under a spatially correlated generalized linear mixed model.</p>
</dd>
<dt><code><a href="#topic+ebpNP">ebpNP</a></code></dt><dd><p>Provides the EBPs and MSE under nonparametric generalized linear mixed model.</p>
</dd>
<dt><code><a href="#topic+NSglm.test">NSglm.test</a></code></dt><dd><p>Provides a p-value for testing spatial nonstationarity in the data under generalized linear mixed model.</p>
</dd>
</dl>



<h3>Reference</h3>


<ul>
<li><p>Chandra, H., Salvati, N., &amp; Chambers, R. (2015). A spatially nonstationary fay-herriot model for small area estimation. Journal of survey statistics and methodology. 3. 109-135. DOI:10.1093/jssam/smu026.
</p>
</li>
<li><p>Chandra, H., Salvati, N., &amp; Chambers, R. (2017). Small area prediction of counts under a non-stationary spatial model. Spatial Statistics. 20. 30-56. DOI:10.1016/j.spasta.2017.01.004.
</p>
</li>
<li><p>Chandra, H., Salvati, N., &amp; Chambers, R. (2018). Small area estimation under a spatially non-linear model. Computational Statistics and Data Analysis. 126. 19-38. DOI:10.1016/j.csda.2018.04.002.
</p>
</li>
<li><p>Fay, R. E. &amp; Herriot, R. A. (1979). Estimates of Income for Small Places: An Application of James-Stein Procedures to Census Data. Journal of the American Statistical Association. 74. 269-277. DOI:10.2307/2286322.
</p>
</li>
<li><p>Rao, J.N.K &amp; Molina. (2015). Small Area Estimation 2nd Edition. New York: John Wiley and Sons, Inc.
</p>
</li></ul>


<hr>
<h2 id='NSglm.test'>Parametric bootstrap-based spatial nonstationarity test for generalized linear mixed model</h2><span id='topic+NSglm.test'></span>

<h3>Description</h3>

<p>This function performs a parametric bootstrap-based test procudure for testing spatial nonstationarity in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NSglm.test(
  formula,
  vardir,
  Ni,
  ni,
  lat,
  lon,
  method = "REML",
  maxit = 100,
  precision = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NSglm.test_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_vardir">vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_ni">Ni</code></td>
<td>
<p>a vector of population size for each small area</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_ni">ni</code></td>
<td>
<p>a vector of sample size for each small area</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_lat">lat</code></td>
<td>
<p>a vector of latitude for each small area</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_lon">lon</code></td>
<td>
<p>a vector of longitude for each small area</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_method">method</code></td>
<td>
<p>type of fitting method, default is &quot;REML&quot; method</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_maxit">maxit</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_precision">precision</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td></tr>
<tr><td><code id="NSglm.test_+3A_data">data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with class &quot;htest&quot; containing the following components:
</p>

<dl>
<dt>method</dt><dd><p>a character string indicating what type of test was performed.</p>
</dd>
<dt>p.value</dt><dd><p>the p-value for the test.</p>
</dd>
<dt>data.name</dt><dd><p>a character string giving the name of the data.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(headcount)
# Testing spatial nonstationarity of the data
result &lt;- NSglm.test(y~x1, var, N,n,lat,long, "REML", 10, 1e-04, headcount[1:10,])
result
</code></pre>

<hr>
<h2 id='paddy'>Yield data of paddy</h2><span id='topic+paddy'></span>

<h3>Description</h3>

<p>Dataset on paddy yield used by Chandra et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(paddy)
</code></pre>


<h3>Format</h3>

<p>A data frame with 70 observations on the following 9 variables:
</p>

<dl>
<dt>D</dt><dd><p>Small area code</p>
</dd>
<dt>latitude</dt><dd><p>Latitude of each small areas</p>
</dd>
<dt>longitude</dt><dd><p>Longitude of each small areas</p>
</dd>
<dt>n</dt><dd><p>Sample size of each small areas</p>
</dd>
<dt>y</dt><dd><p>Average yield data of paddy crop for the year 2009-10 (direct estimates for the small areas)</p>
</dd>
<dt>var</dt><dd><p>Estimated variance of y</p>
</dd>
<dt>x1</dt><dd><p>First covariate  (average household size) used by Chandra et al. (2016)</p>
</dd>
<dt>x2</dt><dd><p>Second covariate  (female population of marginal household) used by Chandra et al. (2016)</p>
</dd>
<dt>indicator</dt><dd><p>Index for sample and non-sample area</p>
</dd>
</dl>



<h3>Reference</h3>

<p>Chandra, H., salvati, N., chambers, R. and Sud, U. C. (2016). A Spatially Nonstationary Fay-Herriot Model for Small Area Estimation - An Application to Crop Yield Estimation. Seventh International Conference on Agricultural Statistics. Rome. DOI:10.1481/icasVII.2016.f35.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(paddy)
yield &lt;- paddy$y
summary(yield)
</code></pre>

<hr>
<h2 id='paddysample'>Yield data of paddy for sample area</h2><span id='topic+paddysample'></span>

<h3>Description</h3>

<p>Dataset on paddy yield for sample area used by Chandra et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(paddysample)
</code></pre>


<h3>Format</h3>

<p>A data frame with 58 observations on the following 8 variables:
</p>

<dl>
<dt>D</dt><dd><p>Small area code</p>
</dd>
<dt>latitude</dt><dd><p>Latitude of each small areas</p>
</dd>
<dt>longitude</dt><dd><p>Longitude of each small areas</p>
</dd>
<dt>n</dt><dd><p>Sample size of each small areas</p>
</dd>
<dt>y</dt><dd><p>Average yield data of paddy crop for the year 2009-10 (direct estimates for the small areas)</p>
</dd>
<dt>var</dt><dd><p>Estimated variance of y</p>
</dd>
<dt>x1</dt><dd><p>First covariate  (average household size) used by Chandra et al. (2016)</p>
</dd>
<dt>x2</dt><dd><p>Second covariate  (female population of marginal household) used by Chandra et al. (2016)</p>
</dd>
</dl>



<h3>Reference</h3>

<p>Chandra, H., salvati, N., chambers, R. and Sud, U. C. (2016). A Spatially Nonstationary Fay-Herriot Model for Small Area Estimation - An Application to Crop Yield Estimation. Seventh International Conference on Agricultural Statistics. Rome. DOI:10.1481/icasVII.2016.f35.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(paddysample)
yield &lt;- paddysample$y
summary(yield)
</code></pre>

<hr>
<h2 id='Wmatrix'>Proximity matrix</h2><span id='topic+Wmatrix'></span>

<h3>Description</h3>

<p>Proximity matrix for the areas included in data set of Chandra et al. (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Wmatrix)
</code></pre>


<h3>Format</h3>

<p>A 71*71 proximity matrix of the areas. It must be in row-standerdized form
</p>


<h3>Reference</h3>

<p>Chandra, H., Salvati, N., &amp; Chambers, R. (2017). Small area prediction of counts under a non-stationary spatial model. Spatial Statistics. 20. 30-56. DOI:10.1016/j.spasta.2017.01.004.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Wmatrix)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
