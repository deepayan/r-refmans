<!DOCTYPE html><html lang="en"><head><title>Help for package portes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {portes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#portes-package'>
<p>Portmanteau Tests for Time Series Models</p></a></li>
<li><a href='#BoxPierce'><p>The Univariate-Multivariate Box and Pierce Portmanteau Test</p></a></li>
<li><a href='#CRSP'><p> Monthly simple returns of the CRSP value-weighted index, 1926 to 1997</p></a></li>
<li><a href='#DEXCAUS'><p> Canada/US Foreign Exchanges Rates, Daily, Jan. 4, 1971 to Sept. 5, 1996.</p></a></li>
<li><a href='#EconomicUK'>
<p>Quarterly U.K. economic time series from 1957 Q3 to 1967 Q4</p></a></li>
<li><a href='#GetResiduals'><p>Extract Residuals from ARIMA, VAR, or any Simulated Fitted Time Series Model</p></a></li>
<li><a href='#GNPDEF'>
<p>GNP Deflator for U.S. Inflation Data from January 01, 1947 to April 01, 2010.</p></a></li>
<li><a href='#Hosking'><p>The Modified Multivariate Portmanteau Test, Hosking (1980)</p></a></li>
<li><a href='#IbmSp500'><p>Monthly Returns of IBM and S&amp;P 500 Index</p></a></li>
<li><a href='#ImpulseVMA'><p>The Impulse Response Function in the Infinite MA or VMA Representation</p></a></li>
<li><a href='#InvertQ'><p>Check Stationary and Invertibility of ARMA or VARMA Models</p></a></li>
<li><a href='#LiMcLeod'><p>The Modified Multivariate Portmanteau Test, Li-McLeod (1981)</p></a></li>
<li><a href='#LjungBox'><p>Ljung and Box Portmanteau Test</p></a></li>
<li><a href='#MahdiMcLeod'><p>Generalized Variance Portmanteau Test</p></a></li>
<li><a href='#monthintel'><p>The Monthly Log Stock Returns of Intel Corporation from January 1973 to December 2003</p></a></li>
<li><a href='#portest'><p>Portmanteau Test Statistics</p></a></li>
<li><a href='#ToeplitzBlock'><p>Toeplitz Block Matrix of Hosking (1980) Auto and Cross Correlation Matrices</p></a></li>
<li><a href='#varima.sim'><p>Simulate Data From Seasonal/Nonseasonal ARIMA(p,d,q)*(ps,ds,qs)_s or VARIMA(p,d,q)*(ps,ds,qs)_s Models</p></a></li>
<li><a href='#vma.sim'><p>Compute The Vector of Moving Average Model (VMA)</p></a></li>
<li><a href='#WestGerman'>
<p>Quarterly, West German Investment, Income, and Consumption: 1960Q1-1982Q4</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Portmanteau Tests for Time Series Models</td>
</tr>
<tr>
<td>Version:</td>
<td>6.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Esam Mahdi</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Esam Mahdi &lt;emahdi2012@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains common univariate and multivariate portmanteau test statistics for time series models. These tests are based on using asymptotic distributions such as chi-square distribution and based on using the Monte Carlo significance tests. Also, it can be used to simulate from univariate and multivariate seasonal time series models.</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, forecast(&ge; 8.21), vars(&ge; 1.5-9)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-18 07:26:56 UTC; emahdi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-18 22:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='portes-package'>
Portmanteau Tests for Time Series Models 
</h2><span id='topic+portes-package'></span>

<h3>Description</h3>

<p>This package contains a set of portmanteau diagnostic checks for univariate and multivariate time series
based on the asymptotic approximation distributions and the Monte-Carlo significance test.
More details about the portmanteau test statistics are available online from the vignette of this package.
This package can be also used to simulate univariate and multivariate data 
from seasonal/nonseasonal <code>ARIMA</code>/ <code>VARIMA</code> models with
innovations from finite or infinite variances from stable distributions. 
The simulated data may have deterministic terms, constant drifts and time trends, with non-zero means.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> portes</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 6.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-06-06</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Classification/ACM: </td><td style="text-align: left;"> G.3, G.4, I.5.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Classification/MSC: </td><td style="text-align: left;"> 62M10, 91B84</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Esam Mahdi and A. Ian McLeod.
</p>
<p>Maintainer: Esam Mahdi &lt;emahdi2012@gmail.com&gt;
</p>

<hr>
<h2 id='BoxPierce'>The Univariate-Multivariate Box and Pierce Portmanteau Test</h2><span id='topic+BoxPierce'></span>

<h3>Description</h3>

<p>The univariate or multivariate Box-Pierce (1970) portmanteau test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BoxPierce(obj,lags=seq(5,30,5),fitdf=0,sqrd.res=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BoxPierce_+3A_obj">obj</code></td>
<td>
<p>a univariate or multivariate series with class <code>"numeric"</code>, <code>"matrix"</code>, 
<code>"ts"</code>, or <code>("mts" "ts")</code>.
It can be also an object of fitted time-series model with class <code>"ar"</code>, 
<code>"arima0"</code>, <code>"Arima"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>,
<code>("glm" "lm")</code>, or <code>"varest"</code>. 
<code>obj</code> may also an object with class <code>"list"</code> (see details and following examples).</p>
</td></tr>
<tr><td><code id="BoxPierce_+3A_lags">lags</code></td>
<td>
<p>vector of lag auto-cross correlation coefficients used for <code>Hosking</code> test.</p>
</td></tr>
<tr><td><code id="BoxPierce_+3A_fitdf">fitdf</code></td>
<td>
<p>Default is zero for testing the randomness of a given sequence with 
class <code>"numeric"</code>, <code>"matrix"</code>, <code>"ts"</code>, or <code>("mts" "ts")</code>. 
In general <code>fitdf</code> equals to the number of estimated parameters in the fitted model.
If <code>obj</code> is an object with class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>"varest"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, or <code>"list"</code> then no need to enter 
the value of <code>fitdf</code> as it will be automatically determined.
For <code>obj</code> with other classes, the <code>fitdf</code> is needed for degrees 
of freedom of asymptotic chi-square distribution.</p>
</td></tr>           
<tr><td><code id="BoxPierce_+3A_sqrd.res">sqrd.res</code></td>
<td>
<p>if <code>TRUE</code> then apply the test on the squared values. 
This checks for Autoregressive Conditional Heteroscedastic, 
<code>ARCH</code>, effects. 
When <code>sqrd.res = FALSE</code>, then apply the test on the usual residuals. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>However the portmanteau test statistic can be applied directly on the output objects from 
the built in <code>R</code> functions <code>ar()</code>, <code>ar.ols()</code>, <code>ar.burg()</code>, 
<code>ar.yw()</code>, <code>ar.mle()</code>, <code>arima()</code>, <code>arim0()</code>, <code>Arima()</code>,
<code>auto.arima()</code>, <code>lm()</code>, <code>glm()</code>, and <code>VAR()</code>, 
it works with output objects from any fitted model. 
In this case, users should write their own function to fit any model they want, where they 
may use the built in <code>R</code> functions <code>garch()</code>, <code>garchFit()</code>, 
<code>fracdiff()</code>, <code>tar()</code>, etc.
The object <code>obj</code> represents the output of this function. 
This output must be a list with at least two outcomes: 
the fitted residual and the fitdf of the fitted model (<code>list(res = ..., fitdf = ...)</code>). 
See the following example with the function <code>FitModel()</code>.
</p>
<p>Note: In <code>stats</code> <code>R</code>, the function <code><a href="stats.html#topic+Box.test">Box.test</a></code> was built to compute
the Box and Pierce (1970) and Ljung and Box (1978) test statistics
only in the univariate case where we can not use more than one single lag value at a time.
The functions <code><a href="#topic+BoxPierce">BoxPierce</a></code> and <code><a href="#topic+LjungBox">LjungBox</a></code> are more accurate than
<code><a href="stats.html#topic+Box.test">Box.test</a></code> function and can be used in the univariate or multivariate time series
at vector of different lag values as well as they can be applied on an output object 
from a fitted model described in the description of the function <code><a href="#topic+BoxPierce">BoxPierce</a></code>.
</p>


<h3>Value</h3>

<p>The Box and Pierce univariate or multivariate test statistic with the associated p-values 
for different lags based on the asymptotic chi-square distribution with <code>k^2(lags-fitdf)</code> degrees of freedom.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Box, G.E.P. and Pierce, D.A. (1970). &quot;Distribution of Residual Autocorrelation in Autoregressive-Integrated Moving Average
Time Series Models&quot;. Journal of American Statistical Association, 65, 1509-1526.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Box.test">Box.test</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, <code><a href="#topic+Hosking">Hosking</a></code>, 
<code><a href="#topic+LiMcLeod">LiMcLeod</a></code>, <code><a href="#topic+portest">portest</a></code>, <code><a href="#topic+GetResiduals">GetResiduals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
BoxPierce(x)                              ## univariate test
x &lt;- cbind(rnorm(100),rnorm(100))
BoxPierce(x)                              ## multivariate test      
##
##
## Annual flow of the river Nile at Aswan - 1871 to 1970
fit &lt;- arima(Nile, c(1, 0, 1))
lags &lt;- c(5, 10, 20)
## Apply the univariate test statistic on the fitted model 
BoxPierce(fit, lags)            ## Correct (no need to specify fitdf) 
BoxPierce(fit, lags, fitdf = 2) ## Correct 
## Apply the test statistic on the residuals and set fitdf = 2 
res &lt;- resid(fit)
BoxPierce(res, lags)             ## Wrong (fitdf is needed!)  
BoxPierce(res, lags, fitdf = 2)  ## Correct 
##
##
## Quarterly, west German investment, income, and consumption from 1960 Q1 to 1982 Q4 
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
fit &lt;- ar.ols(DiffData, intercept = TRUE, order.max = 2)
lags &lt;- c(5,10)
## Apply the test statistic on the fitted model 
BoxPierce(fit,lags)                ## Correct (no need to specify fitdf)
## Apply the test statistic on the residuals where fitdf = 2
res &lt;- ts(na.omit(fit$resid))
BoxPierce(res,lags)                ## Wrong (fitdf is needed!)  
BoxPierce(res,lags,fitdf = 2)      ## Correct 
##
##
## Monthly log stock returns of Intel corporation data: Test for ARCH Effects 
monthintel &lt;- as.ts(monthintel)
BoxPierce(monthintel)                         ## Usual test 
BoxPierce(monthintel,sqrd.res=TRUE)  ## Test for ARCH effects
##
#### Write a function to fit a model: Apply portmanteau test on fitted obj with class "list"
## Example 
FitModel &lt;- function(data){
    fit &lt;- ar.ols(data, intercept = TRUE, order.max = 2)
    fitdf &lt;- 2
    res &lt;- ts(na.omit(fit$resid))
 list(res=res,fitdf=fitdf)
}
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
Fit &lt;- FitModel(DiffData)
BoxPierce(Fit) 
</code></pre>

<hr>
<h2 id='CRSP'> Monthly simple returns of the CRSP value-weighted index, 1926 to 1997</h2><span id='topic+CRSP'></span>

<h3>Description</h3>

<p>This data has been discussed by Tsay (2002, Ch.2, p.38 and 39) and
Lin and McLeod (2008). 
There are 864 data values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CRSP)</code></pre>


<h3>References</h3>

<p>Lin, J.-W. and McLeod, A.I. (2008). &quot;Portmanteau Tests for ARMA Models with Infinite Variance&quot;.  
Journal of Time Series Analysis, 29, 600-617.
</p>
<p>Tsay, R. S. (2002). Analysis of Financial Time Series. Wiley, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>acf(CRSP)
</code></pre>

<hr>
<h2 id='DEXCAUS'> Canada/US Foreign Exchanges Rates, Daily, Jan. 4, 1971 to Sept. 5, 1996. </h2><span id='topic+DEXCAUS'></span>

<h3>Description</h3>

<p>There are 2513 data values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DEXCAUS)</code></pre>


<h3>Details</h3>

<p>Title:               Canada / U.S. Foreign Exchange Rate
Series ID:           DEXCAUS
Source:              Board of Governors of the Federal Reserve System
Release:             H.10 Foreign Exchange Rates
Seasonal Adjustment: Not Applicable
Frequency:           Daily
Units:               Canadian Dollars to One U.S. Dollar
Date Range:          1971-01-04 to 2006-09-05
Last Updated:        2006-09-06 10:42 AM CT
Notes:               Noon buying rates in New York City for cable transfers payable in foreign currencies.
</p>


<h3>Source</h3>

<p><a href="https://fred.stlouisfed.org/series/DEXCAUS">https://fred.stlouisfed.org/series/DEXCAUS</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>acf(DEXCAUS)
</code></pre>

<hr>
<h2 id='EconomicUK'>
Quarterly U.K. economic time series from 1957 Q3 to 1967 Q4
</h2><span id='topic+EconomicUK'></span>

<h3>Description</h3>

<p>The data are quarterly, seasonally unadjusted in 1958 prices, covering the period
1957/3-1967/4 (with 7 series each with 42 observations), as published in Economic Trends, with information 
about consumers' expenditure on goods and services, Investment, inventory investment, 
imports of goods and services, gross domestic product, and personal disposable income.
Prothero and Wallis (1976) fitted several models to each series and compared
their performance with a multivariate model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("EconomicUK")</code></pre>


<h3>Format</h3>

<p>A data frame with 42 observations on the following 8 variables.
</p>

<dl>
<dt><code>Cd</code></dt><dd><p>consumers' expenditure on durable goods</p>
</dd>
<dt><code>Cn</code></dt><dd><p>consumers' expenditure on all other goods and services</p>
</dd>
<dt><code>I</code></dt><dd><p>investment (gross domestic fixed capital formation)</p>
</dd>
<dt><code>Iv</code></dt><dd><p>inventory investment (value of physical increase in stocks and work in progress)</p>
</dd>
<dt><code>M</code></dt><dd><p>imports of goods and services</p>
</dd>
<dt><code>Y</code></dt><dd><p>gross domestic product</p>
</dd>
<dt><code>Yd</code></dt><dd><p>personal disposable income</p>
</dd>
<dt><code>year</code></dt><dd><p>year with attributed number associated to quarterly period</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are quarterly, seasonally unadjusted in 1958 prices, covering the period
1957/3-1967/4 (42 observations), as published in Economic Trends.
</p>


<h3>References</h3>

<p>David L. Prothero and Kenneth F. Wallis (1976). &quot;Modelling macroeconomic time series (with discussion)&quot;, Journal of the Royal Statistical Society, A, Vol.139, Part 4, pp.468-500.
</p>

<hr>
<h2 id='GetResiduals'>Extract Residuals from ARIMA, VAR, or any Simulated Fitted Time Series Model</h2><span id='topic+GetResiduals'></span>

<h3>Description</h3>

<p>This utility function is useful to use in the portmanteau functions, 
<code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, <code><a href="#topic+Hosking">Hosking</a></code>,
<code><a href="#topic+LiMcLeod">LiMcLeod</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>, and <code><a href="#topic+portest">portest</a></code>.
<code>GetResiduals()</code> function takes a fitted time-series object 
with class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>, <code>("glm" "lm")</code>, 
<code>"varest"</code>, or <code>"list"</code>. 
and returns the residuals and the order from the fitted object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetResiduals(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetResiduals_+3A_obj">obj</code></td>
<td>
<p>a fitted time-series model with class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>, <code>("glm" "lm")</code>, 
<code>"varest"</code>, or <code>"list"</code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of order of fitted time series model and residuals from this model. 
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ar">ar</a></code>, <code><a href="stats.html#topic+ar.ols">ar.ols</a></code>, <code><a href="stats.html#topic+ar.burg">ar.burg</a></code>, 
<code><a href="stats.html#topic+ar.yw">ar.yw</a></code>, <code><a href="stats.html#topic+ar.mle">ar.mle</a></code>, <code><a href="stats.html#topic+arima0">arima0</a></code>, <code><a href="stats.html#topic+arima">arima</a></code>, 
<code><a href="forecast.html#topic+Arima">Arima</a></code>, <code><a href="forecast.html#topic+auto.arima">auto.arima</a></code>,
<code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="vars.html#topic+VAR">VAR</a></code>, 
<code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, <code><a href="#topic+Hosking">Hosking</a></code>,
<code><a href="#topic+LiMcLeod">LiMcLeod</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- arima(Nile, c(1, 0, 1))
GetResiduals(fit)
</code></pre>

<hr>
<h2 id='GNPDEF'> 
GNP Deflator for U.S. Inflation Data from January 01, 1947 to April 01, 2010.</h2><span id='topic+GNPDEF'></span>

<h3>Description</h3>

<p>GNP deflator for U.S. inflation data from 1947-01-01 to 2010-04-01.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GNPDEF)</code></pre>


<h3>Format</h3>

<p>A data frame with 254 observations on the following 2 variables.
</p>

<dl>
<dt><code>time</code></dt><dd><p>time</p>
</dd>
<dt><code>GNPDEF</code></dt><dd><p>a numeric vector denotes the GNP deflator</p>
</dd>
</dl>



<h3>References</h3>

<p>Bollerslev, T. (1986). &quot;Generalized autoregressive conditional heteroskedasticity&quot;.
Journal of Econometrics, 31(3), 307-327.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(ts(GNPDEF[,2]))
</code></pre>

<hr>
<h2 id='Hosking'>The Modified Multivariate Portmanteau Test, Hosking (1980)</h2><span id='topic+Hosking'></span>

<h3>Description</h3>

<p>The modified multivariate portmanteau test suggested by Hosking (1980).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hosking(obj,lags=seq(5,30,5),fitdf=0,sqrd.res=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Hosking_+3A_obj">obj</code></td>
<td>
<p>a univariate or multivariate series with class <code>"numeric"</code>, <code>"matrix"</code>, 
<code>"ts"</code>, or <code>("mts" "ts")</code>.
It can be also an object of fitted time-series model with class <code>"ar"</code>, 
<code>"arima0"</code>, <code>"Arima"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>,
<code>("glm" "lm")</code>, or <code>"varest"</code>. 
<code>obj</code> may also an object with class <code>"list"</code> (see details and following examples).</p>
</td></tr>
<tr><td><code id="Hosking_+3A_lags">lags</code></td>
<td>
<p>vector of lag auto-cross correlation coefficients used for <code>Hosking</code> test.</p>
</td></tr>
<tr><td><code id="Hosking_+3A_fitdf">fitdf</code></td>
<td>
<p>Default is zero for testing the randomness of a given sequence with 
class <code>"numeric"</code>, <code>"matrix"</code>, <code>"ts"</code>, or <code>("mts" "ts")</code>. 
In general <code>fitdf</code> equals to the number of estimated parameters in the fitted model.
If <code>obj</code> is an object with class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>"varest"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, or <code>"list"</code> then no need to enter 
the value of <code>fitdf</code> as it will be automatically determined.
For <code>obj</code> with other classes, the <code>fitdf</code> is needed for degrees 
of freedom of asymptotic chi-square distribution.</p>
</td></tr>           
<tr><td><code id="Hosking_+3A_sqrd.res">sqrd.res</code></td>
<td>
<p>if <code>TRUE</code> then apply the test on the squared values. 
This checks for Autoregressive Conditional Heteroscedastic, 
<code>ARCH</code>, effects. 
When <code>sqrd.res = FALSE</code>, then apply the test on the usual residuals. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>However the portmanteau test statistic can be applied directly on the output objects from 
the built in <code>R</code> functions <code>ar()</code>, <code>ar.ols()</code>, <code>ar.burg()</code>, 
<code>ar.yw()</code>, <code>ar.mle()</code>, <code>arima()</code>, <code>arim0()</code>, <code>Arima()</code>,
<code>auto.arima()</code>, <code>lm()</code>, <code>glm()</code>, and <code>VAR()</code>, 
it works with output objects from any fitted model. 
In this case, users should write their own function to fit any model they want, where they 
may use the built in <code>R</code> functions <code>garch()</code>, <code>garchFit()</code>, 
<code>fracdiff()</code>, <code>tar()</code>, etc.
The object <code>obj</code> represents the output of this function. 
This output must be a list with at least two outcomes: 
the fitted residual and the fitdf of the fitted model (<code>list(res = ..., fitdf = ...)</code>). 
See the following example with the function <code>FitModel()</code>.
</p>


<h3>Value</h3>

<p>The multivariate test statistic suggested by Hosking (1980) and its associated p-values 
for different lags based on the asymptotic chi-square distribution with <code>k^2(lags-fitdf)</code> degrees of freedom.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Hosking, J. R. M. (1980). &quot;The Multivariate Portmanteau Statistic&quot;. 
Journal of American Statistical Association, 75, 602-608.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Box.test">Box.test</a></code>, <code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, 
<code><a href="#topic+LiMcLeod">LiMcLeod</a></code>, <code><a href="#topic+portest">portest</a></code>, <code><a href="#topic+GetResiduals">GetResiduals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
Hosking(x)                              ## univariate test
x &lt;- cbind(rnorm(100),rnorm(100))
Hosking(x)                              ## multivariate test
##
##
## Quarterly, west German investment, income, and consumption from 1960 Q1  to 1982 Q4 
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
fit &lt;- ar.ols(DiffData, intercept = TRUE, order.max = 2)
lags &lt;- c(5,10)
## Apply the test statistic on the fitted model (fitdf will be automatically applied)
Hosking(fit,lags,fitdf = 2)                          ## Correct (no need to specify fitdf)
Hosking(fit,lags)                                    ## Correct
## Apply the test statistic on the residuals
res &lt;- ts((fit$resid)[-(1:2), ])
Hosking(res,lags,fitdf = 2)                          ## Correct
Hosking(res,lags)                                    ## Wrong (fitdf is needed!)  
##
##
## Write a function to fit a model: Apply portmanteau test on fitted obj with class "list"
FitModel &lt;- function(data){
    fit &lt;- ar.ols(data, intercept = TRUE, order.max = 2)
    fitdf &lt;- 2
    res &lt;- res &lt;- ts((fit$resid)[-(1:2), ]) 
 list(res=res,fitdf=fitdf)
}
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
Fit &lt;- FitModel(DiffData)
Hosking(Fit) 
</code></pre>

<hr>
<h2 id='IbmSp500'>Monthly Returns of IBM and S&amp;P 500 Index
</h2><span id='topic+IbmSp500'></span>

<h3>Description</h3>

<p>The monthly returns of IBM stock and the S&amp;P 500 index from January 1926 to December 2008. 
This data has been discussed by Tsay (2010, Chapter 8).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(IbmSp500)</code></pre>


<h3>Format</h3>

<p>A data frame with 996 observations on the following 3 variables.
</p>

<dl>
<dt><code>date</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ibm</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sp</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://faculty.chicagobooth.edu/ruey.tsay/teaching/fts3/</p>


<h3>References</h3>

<p>Tsay, R. S. (2010). &quot;Analysis of Financial Time Series&quot;. Wiley, New York, 3rd edition.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IbmSp500)
plot(IbmSp500) 
acf(IbmSp500)
</code></pre>

<hr>
<h2 id='ImpulseVMA'>The Impulse Response Function in the Infinite MA or VMA Representation</h2><span id='topic+ImpulseVMA'></span>

<h3>Description</h3>

<p>The impulse coefficients are computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ImpulseVMA(ar=NULL,ma=NULL,trunc.lag=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ImpulseVMA_+3A_ar">ar</code></td>
<td>
<p>a numeric or an array of <code>AR</code> or an array of <code>VAR</code> parameters with order <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="ImpulseVMA_+3A_ma">ma</code></td>
<td>
<p>a numeric or an array of <code>MA</code> or an array of <code>VMA</code> parameters with order <code class="reqn">q</code>.</p>
</td></tr>
<tr><td><code id="ImpulseVMA_+3A_trunc.lag">trunc.lag</code></td>
<td>
<p>truncation lag is used to truncate the infinite <code>MA</code> or <code>VMA</code> Process. 
IF it is <code>NULL</code>, then the default <code>trunc.lag</code> = <code class="reqn">p+q</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The impulse response coefficients of order <code>trunc.lag+1</code> obtained by 
converting the <code>ARMA</code><code class="reqn">(p,q)</code> or <code>VARMA</code><code class="reqn">(p,q)</code> 
process to infinite <code>MA</code> or <code>VMA</code> process, respectively. 
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Lutkepohl, H. (2005). &quot;New introduction to multiple time series analysis&quot;. 
Springer-Verlag, New York.
</p>
<p>Reinsel, G. C. (1997). &quot;Elements of Multivariate Time Series Analysis&quot;. 
Springer-Verlag, 2nd edition.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+ARMAtoMA">ARMAtoMA</a></code>, <code><a href="#topic+varima.sim">varima.sim</a></code>, <code><a href="#topic+vma.sim">vma.sim</a></code>, 
<code><a href="#topic+InvertQ">InvertQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#####################################################################
### Impulse response coefficients from AR(1,1) to infinite MA process. 
### The infinite process is truncated at lag 20
###
k &lt;- 1
trunc.lag &lt;- 20
ar &lt;- 0.7
ma &lt;- array(-0.9,dim=c(k,k,1))
ImpulseVMA(ar,ma,trunc.lag)
#####################################################################
### Impulse response coefficients from VAR(2) to infinite VMA process
### The infinite process is truncated at default lag value = p+q
###
k &lt;- 2
ar &lt;- array(c(0.5,0.4,0.1,0.5,0,0.3,0,0),dim=c(k,k,2))
ma &lt;- NULL
ImpulseVMA(ar,ma)
#####################################################################
### Impulse response coefficients from VARMA(2,1) to infinite VMA process
### The infinite process is truncated at lag 50
###
k &lt;- 2
ar &lt;- array(c(0.5,0.4,0.1,0.5,0,0.25,0,0),dim=c(k,k,2))
ma &lt;- array(c(0.6,0,0.2,0.3),dim=c(k,k,1))
ImpulseVMA(ar,ma,trunc.lag=50)
</code></pre>

<hr>
<h2 id='InvertQ'>Check Stationary and Invertibility of ARMA or VARMA Models</h2><span id='topic+InvertQ'></span>

<h3>Description</h3>

<p>Utility function checks whether <code>ARMA</code> or <code>VARMA</code> model 
satisfies the stationary or/and the invertibility conditions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>InvertQ(coef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="InvertQ_+3A_coef">coef</code></td>
<td>
<p>a numeric, matrix, or array. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>It should be noted that, the <code>AR</code>(<code class="reqn">p</code>) or <code>VAR</code>(<code class="reqn">p</code>) model can always be expressed as a <code class="reqn">kp</code>-dimensional 
<code>AR</code>(<code class="reqn">1</code>) or <code>VAR</code>(<code class="reqn">1</code>), and the <code>MA</code>(<code class="reqn">q</code>) or <code>VMA</code>(<code class="reqn">q</code>) model can 
always be expressed as a <code class="reqn">kq</code>-dimensional <code>MA</code>(<code class="reqn">1</code>) or <code>VMA</code>(<code class="reqn">1</code>). 
For this reason, we can use this fact when we need to find the explicit solutions of <code>AR</code>(<code class="reqn">p</code>) or 
<code>VAR</code>(<code class="reqn">p</code>) models or <code>MA</code>(<code class="reqn">q</code>) or <code>VMA</code>(<code class="reqn">q</code>) models as the <code>AR</code>(<code class="reqn">1</code>) or
<code>VAR</code>(<code class="reqn">1</code>) or the <code>MA</code>(<code class="reqn">1</code>) or <code>VMA</code>(<code class="reqn">1</code>) models can be characterized with simple intuitive formulas.
</p>


<h3>Value</h3>

<p>A warning message only if the model is not stationary or/and not invertible.</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Lutkepohl, H. (2005). &quot;New introduction to multiple time series analysis&quot;. 
Springer-Verlag, New York.
</p>
<p>Reinsel, G. C. (1997). &quot;Elements of Multivariate Time Series Analysis&quot;. 
Springer-Verlag, 2nd edition.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varima.sim">varima.sim</a></code>, <code><a href="#topic+vma.sim">vma.sim</a></code>, <code><a href="#topic+ImpulseVMA">ImpulseVMA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##############################################################
### Check Stationary
phi &lt;- array(c(0.5,0.4,0.1,0.5,0,0.3,0,0),dim=c(2,2,2))
InvertQ(phi)
### Check Invertibility
theta &lt;- array(c(0.5,0.4,0.1,0.5,0,0.3,0,0),dim=c(2,2,2))
InvertQ(theta)
</code></pre>

<hr>
<h2 id='LiMcLeod'>The Modified Multivariate Portmanteau Test, Li-McLeod (1981)</h2><span id='topic+LiMcLeod'></span>

<h3>Description</h3>

<p>The modified multivariate portmanteau test suggested by Li and McLeod (1981).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LiMcLeod(obj,lags=seq(5,30,5),fitdf=0,sqrd.res=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LiMcLeod_+3A_obj">obj</code></td>
<td>
<p>a univariate or multivariate series with class <code>"numeric"</code>, <code>"matrix"</code>, 
<code>"ts"</code>, or <code>("mts" "ts")</code>.
It can be also an object of fitted time-series model with class <code>"ar"</code>, 
<code>"arima0"</code>, <code>"Arima"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>,
<code>("glm" "lm")</code>, or <code>"varest"</code>. 
<code>obj</code> may also an object with class <code>"list"</code> (see details and following examples).</p>
</td></tr>
<tr><td><code id="LiMcLeod_+3A_lags">lags</code></td>
<td>
<p>vector of lag auto-cross correlation coefficients used for <code>Hosking</code> test.</p>
</td></tr>
<tr><td><code id="LiMcLeod_+3A_fitdf">fitdf</code></td>
<td>
<p>Default is zero for testing the randomness of a given sequence with 
class <code>"numeric"</code>, <code>"matrix"</code>, <code>"ts"</code>, or <code>("mts" "ts")</code>. 
In general <code>fitdf</code> equals to the number of estimated parameters in the fitted model.
If <code>obj</code> is an object with class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>"varest"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, or <code>"list"</code> then no need to enter 
the value of <code>fitdf</code> as it will be automatically determined.
For <code>obj</code> with other classes, the <code>fitdf</code> is needed for degrees 
of freedom of asymptotic chi-square distribution.</p>
</td></tr>           
<tr><td><code id="LiMcLeod_+3A_sqrd.res">sqrd.res</code></td>
<td>
<p>if <code>TRUE</code> then apply the test on the squared values. 
This checks for Autoregressive Conditional Heteroscedastic, 
<code>ARCH</code>, effects. 
When <code>sqrd.res = FALSE</code>, then apply the test on the usual residuals. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>However the portmanteau test statistic can be applied directly on the output objects from 
the built in <code>R</code> functions <code>ar()</code>, <code>ar.ols()</code>, <code>ar.burg()</code>, 
<code>ar.yw()</code>, <code>ar.mle()</code>, <code>arima()</code>, <code>arim0()</code>, <code>Arima()</code>,
<code>auto.arima()</code>, <code>lm()</code>, <code>glm()</code>, and <code>VAR()</code>, 
it works with output objects from any fitted model. 
In this case, users should write their own function to fit any model they want, where they 
may use the built in <code>R</code> functions <code>garch()</code>, <code>garchFit()</code>, 
<code>fracdiff()</code>, <code>tar()</code>, etc.
The object <code>obj</code> represents the output of this function. 
This output must be a list with at least two outcomes: 
the fitted residual and the fitdf of the fitted model (<code>list(res = ..., fitdf = ...)</code>). 
See the following example with the function <code>FitModel()</code>.
</p>


<h3>Value</h3>

<p>The multivariate test statistic suggested by Li and McLeod (1981) and its corresponding p-values 
for different lags based on the asymptotic chi-square distribution with <code>k^2(lags-fitdf)</code> degrees of freedom.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Li, W. K. and McLeod, A. I. (1981). &quot;Distribution of The Residual Autocorrelations in 
Multivariate ARMA Time Series Models&quot;. Journal of The Royal Statistical Society, Series B, 43, 231-239.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Box.test">Box.test</a></code>, <code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, 
<code><a href="#topic+Hosking">Hosking</a></code>, <code><a href="#topic+portest">portest</a></code>, <code><a href="#topic+GetResiduals">GetResiduals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
LiMcLeod(x)                              ## univariate test
x &lt;- cbind(rnorm(100),rnorm(100))
LiMcLeod(x)                              ## multivariate test 
##
##
## Monthly log stock returns of Intel corporation data: Test for ARCH Effects 
monthintel &lt;- as.ts(monthintel)
LjungBox(monthintel)                         ## Usual test 
LjungBox(monthintel,sqrd.res=TRUE)  ## Test for ARCH effects 
##
##
## Quarterly, west German investment, income, and consumption from 1960 Q1 to 1982 Q4 
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
fit &lt;- ar.ols(DiffData, intercept = TRUE, order.max = 2)
lags &lt;- c(5,10)
## Apply the test statistic on the fitted model (fitdf will be automatically applied)
LiMcLeod(fit,lags,fitdf = 2)                          ## Correct (no need to specify fitdf)
LiMcLeod(fit,lags)                                    ## Correct
## Apply the test statistic on the residuals
res &lt;- ts((fit$resid)[-(1:2), ])
LiMcLeod(res,lags,fitdf = 2)                          ## Correct
LiMcLeod(res,lags)                                    ## Wrong (fitdf is needed!)  
##
##
## Write a function to fit a model: Apply portmanteau test on fitted obj with class "list"
FitModel &lt;- function(data){
    fit &lt;- ar.ols(data, intercept = TRUE, order.max = 2)
    fitdf &lt;- 2
    res &lt;- res &lt;- ts((fit$resid)[-(1:2), ]) 
 list(res=res,fitdf=fitdf)
}
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
Fit &lt;- FitModel(DiffData)
LiMcLeod(Fit) 
</code></pre>

<hr>
<h2 id='LjungBox'>Ljung and Box Portmanteau Test</h2><span id='topic+LjungBox'></span>

<h3>Description</h3>

<p>The Ljung-Box (1978) modified portmanteau test.
In the multivariate time series, this test statistic is asymptotically
equal to <code><a href="#topic+Hosking">Hosking</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LjungBox(obj,lags=seq(5,30,5),fitdf=0,sqrd.res=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LjungBox_+3A_obj">obj</code></td>
<td>
<p>a univariate or multivariate series with class <code>"numeric"</code>, <code>"matrix"</code>, 
<code>"ts"</code>, or <code>("mts" "ts")</code>.
It can be also an object of fitted time-series model with class <code>"ar"</code>, 
<code>"arima0"</code>, <code>"Arima"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>,
<code>("glm" "lm")</code>, or <code>"varest"</code>. 
<code>obj</code> may also an object with class <code>"list"</code> (see details and following examples).</p>
</td></tr>
<tr><td><code id="LjungBox_+3A_lags">lags</code></td>
<td>
<p>vector of lag auto-cross correlation coefficients used for <code>Hosking</code> test.</p>
</td></tr>
<tr><td><code id="LjungBox_+3A_fitdf">fitdf</code></td>
<td>
<p>Default is zero for testing the randomness of a given sequence with 
class <code>"numeric"</code>, <code>"matrix"</code>, <code>"ts"</code>, or <code>("mts" "ts")</code>. 
In general <code>fitdf</code> equals to the number of estimated parameters in the fitted model.
If <code>obj</code> is an object with class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>"varest"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, or <code>"list"</code> then no need to enter 
the value of <code>fitdf</code> as it will be automatically determined.
For <code>obj</code> with other classes, the <code>fitdf</code> is needed for degrees 
of freedom of asymptotic chi-square distribution.</p>
</td></tr>           
<tr><td><code id="LjungBox_+3A_sqrd.res">sqrd.res</code></td>
<td>
<p>if <code>TRUE</code> then apply the test on the squared values. 
This checks for Autoregressive Conditional Heteroscedastic, 
<code>ARCH</code>, effects. 
When <code>sqrd.res = FALSE</code>, then apply the test on the usual residuals. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>However the portmanteau test statistic can be applied directly on the output objects from 
the built in <code>R</code> functions <code>ar()</code>, <code>ar.ols()</code>, <code>ar.burg()</code>, 
<code>ar.yw()</code>, <code>ar.mle()</code>, <code>arima()</code>, <code>arim0()</code>, <code>Arima()</code>,
<code>auto.arima()</code>, <code>lm()</code>, <code>glm()</code>, and <code>VAR()</code>, 
it works with output objects from any fitted model. 
In this case, users should write their own function to fit any model they want, where they 
may use the built in <code>R</code> functions <code>garch()</code>, <code>garchFit()</code>, 
<code>fracdiff()</code>, <code>tar()</code>, etc.
The object <code>obj</code> represents the output of this function. 
This output must be a list with at least two outcomes: 
the fitted residual and the fitdf of the fitted model (<code>list(res = ..., fitdf = ...)</code>). 
See the following example with the function <code>FitModel()</code>.
</p>
<p>Note: In <code>stats</code> <code>R</code>, the function <code><a href="stats.html#topic+Box.test">Box.test</a></code> was built to compute
the Box and Pierce (1970) and Ljung and Box (1978) test statistics
only in the univariate case where we can not use more than one single lag value at a time.
The functions <code><a href="#topic+BoxPierce">BoxPierce</a></code> and <code><a href="#topic+LjungBox">LjungBox</a></code> are more accurate than
<code><a href="stats.html#topic+Box.test">Box.test</a></code> function and can be used in the univariate or multivariate time series
at vector of different lag values as well as they can be applied on an output object 
from a fitted model described in the description of the function <code><a href="#topic+BoxPierce">BoxPierce</a></code>.
</p>


<h3>Value</h3>

<p>The Ljung and Box test statistic with the associated p-values 
for different lags based on the asymptotic chi-square distribution with <code>k^2(lags-fitdf)</code> degrees of freedom.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Ljung, G.M. and Box, G.E.P (1978). &quot;On a Measure of Lack of Fit in Time Series Models&quot;. 
Biometrika, 65, 297-303.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Box.test">Box.test</a></code>, <code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, 
<code><a href="#topic+Hosking">Hosking</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, <code><a href="#topic+portest">portest</a></code>, <code><a href="#topic+GetResiduals">GetResiduals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
LjungBox(x)                              ## univariate test
x &lt;- cbind(rnorm(100),rnorm(100))
LjungBox(x)                              ## multivariate test      
##
##
## Annual flow of the river Nile at Aswan - 1871 to 1970
fit &lt;- arima(Nile, c(1, 0, 1))
lags &lt;- c(5, 10, 20)
## Apply the univariate test statistic on the fitted model 
LjungBox(fit, lags)            ## Correct (no need to specify fitdf) 
LjungBox(fit, lags, fitdf = 2) ## Correct 
## Apply the test statistic on the residuals and set fitdf = 2 
res &lt;- resid(fit)
LjungBox(res, lags)             ## Wrong (fitdf is needed!)  
LjungBox(res, lags, fitdf = 2)  ## Correct 
##
##
## Quarterly, west German investment, income, and consumption from 1960 Q1 to 1982 Q4 
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
fit &lt;- ar.ols(DiffData, intercept = TRUE, order.max = 2)
lags &lt;- c(5,10)
## Apply the test statistic on the fitted model 
LjungBox(fit,lags)                ## Correct (no need to specify fitdf)
## Apply the test statistic on the residuals where fitdf = 2
res &lt;- ts((fit$resid)[-(1:2), ])
LjungBox(res,lags)                ## Wrong (fitdf is needed!)  
LjungBox(res,lags,fitdf = 2)      ## Correct 
##
##
## Monthly log stock returns of Intel corporation data: Test for ARCH Effects 
monthintel &lt;- as.ts(monthintel)
LjungBox(monthintel)                         ## Usual test 
LjungBox(monthintel,sqrd.res=TRUE)  ## Test for ARCH effects
##
#### Write a function to fit a model: Apply portmanteau test on fitted obj with class "list"
## Example
FitModel &lt;- function(data){
    fit &lt;- ar.ols(data, intercept = TRUE, order.max = 2)
    fitdf &lt;- 2
    res &lt;- res &lt;- ts((fit$resid)[-(1:2), ]) 
 list(res=res,fitdf=fitdf)
}
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
Fit &lt;- FitModel(DiffData)
LjungBox(Fit) 
</code></pre>

<hr>
<h2 id='MahdiMcLeod'>Generalized Variance Portmanteau Test</h2><span id='topic+MahdiMcLeod'></span>

<h3>Description</h3>

<p>New generalized variance portmanteau test based on the determinant of the Hosking's autocorrelation block 
Toeplitz matrix with fitdf <code class="reqn">m+1</code> given in the function <code><a href="#topic+ToeplitzBlock">ToeplitzBlock</a></code>, 
where <code class="reqn">m</code> represents the fitdf of the block matrix.
Originally, the generalized variance portmanteau test, <code>MahdiMcLeod</code>, 
for univariate time series was derived by Pena and Rodriguez (2002)
based on the gamma distribution. 
Lin and McLeod (2006) proposed the Monte-Carlo version of this test and 
Mahdi and McLeod (2012) extended both methods to the multivariate case. 
Simulation results suggest that the Monte-Carlo version of 
<code>MahdiMcLeod</code> statistic is more accurate
and powerful than its competitors proposed by Box and Pierce (1970), Ljung and Box (1978),
and Pena and Rodriguez (2002, 2006) in the univariate time series and
Hosking (1980) and Li and McLeod (1981) in the multivariate time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MahdiMcLeod(obj,lags=seq(5,30,5),fitdf=0,sqrd.res=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MahdiMcLeod_+3A_obj">obj</code></td>
<td>
<p>a univariate or multivariate series with class <code>"numeric"</code>, <code>"matrix"</code>, 
<code>"ts"</code>, or <code>("mts" "ts")</code>.
It can be also an object of fitted time-series model with class <code>"ar"</code>, 
<code>"arima0"</code>, <code>"Arima"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>,
<code>("glm" "lm")</code>, or <code>"varest"</code>. 
<code>obj</code> may also an object with class <code>"list"</code> (see details and following examples).</p>
</td></tr>
<tr><td><code id="MahdiMcLeod_+3A_lags">lags</code></td>
<td>
<p>vector of lag auto-cross correlation coefficients used for <code>Hosking</code> test.</p>
</td></tr>
<tr><td><code id="MahdiMcLeod_+3A_fitdf">fitdf</code></td>
<td>
<p>Default is zero for testing the randomness of a given sequence with 
class <code>"numeric"</code>, <code>"matrix"</code>, <code>"ts"</code>, or <code>("mts" "ts")</code>. 
In general <code>fitdf</code> equals to the number of estimated parameters in the fitted model.
If <code>obj</code> is an object with class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>"varest"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, or <code>"list"</code> then no need to enter 
the value of <code>fitdf</code> as it will be automatically determined.
For <code>obj</code> with other classes, the <code>fitdf</code> is needed for degrees 
of freedom of asymptotic chi-square distribution.</p>
</td></tr>           
<tr><td><code id="MahdiMcLeod_+3A_sqrd.res">sqrd.res</code></td>
<td>
<p>if <code>TRUE</code> then apply the test on the squared values. 
This checks for Autoregressive Conditional Heteroscedastic, 
<code>ARCH</code>, effects. 
When <code>sqrd.res = FALSE</code>, then apply the test on the usual residuals. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>However the portmanteau test statistic can be applied directly on the output objects from 
the built in <code>R</code> functions <code>ar()</code>, <code>ar.ols()</code>, <code>ar.burg()</code>, 
<code>ar.yw()</code>, <code>ar.mle()</code>, <code>arima()</code>, <code>arim0()</code>, <code>Arima()</code>,
<code>auto.arima()</code>, <code>lm()</code>, <code>glm()</code>, and <code>VAR()</code>, 
it works with output objects from any fitted model. 
In this case, users should write their own function to fit any model they want, where they 
may use the built in <code>R</code> functions <code>garch()</code>, <code>garchFit()</code>, 
<code>fracdiff()</code>, <code>tar()</code>, etc.
The object <code>obj</code> represents the output of this function. 
This output must be a list with at least two outcomes: 
the fitted residual and the fitdf of the fitted model (<code>list(res = ..., fitdf = ...)</code>). 
See the following example with the function <code>FitModel()</code>.
</p>


<h3>Value</h3>

<p>The generalized variance portmanteau test statistic and its associated p-values for different lags based on asymptotic 
chi-square as given in Mahdi and McLeod (2012).
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Hosking, J. R. M. (1980). &quot;The Multivariate Portmanteau Statistic&quot;. 
Journal of American Statistical Association, 75, 602-608.
</p>
<p>Li, W. K. and McLeod, A. I. (1981). &quot;Distribution of The Residual Autocorrelations in 
Multivariate ARMA Time Series Models&quot;. 
Journal of The Royal Statistical Society, Series B, 43, 231-239.
</p>
<p>Lin, J.-W. and McLeod, A.I. (2006). &quot;Improved Generalized Variance Portmanteau Test&quot;.
Computational Statistics and Data Analysis 51, 1731-1738.
</p>
<p>Mahdi, E. and McLeod, A.I. (2012). &quot;Improved Multivariate Portmanteau Test&quot;. 
Journal of Time Series Analysis, 33(2), 211-222.
</p>
<p>Pena, D. and Rodriguez, J. (2002). &quot;A Powerful Portmanteau Test of Lack of Test for Time Series&quot;.
Journal of American Statistical Association, 97, 601-610.
</p>
<p>Pena, D. and Rodriguez, J. (2006). &quot;The log of the determinant of the autocorrelation
matrix for testing goodness of fit in time series&quot;. Journal of Statistical Planning and
Inference, 136, 2706-2718.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+acf">acf</a></code>, <code><a href="#topic+ToeplitzBlock">ToeplitzBlock</a></code>, <code><a href="stats.html#topic+Box.test">Box.test</a></code>, 
<code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>, <code><a href="#topic+Hosking">Hosking</a></code>, 
<code><a href="#topic+LiMcLeod">LiMcLeod</a></code>, <code><a href="#topic+portest">portest</a></code>, <code><a href="#topic+GetResiduals">GetResiduals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
MahdiMcLeod(x)                              ## univariate test
x &lt;- cbind(rnorm(100),rnorm(100))
MahdiMcLeod(x)                              ## multivariate test      
##
##
## Annual flow of the river Nile at Aswan - 1871 to 1970
fit &lt;- arima(Nile, c(1, 0, 1))
lags &lt;- c(5, 10, 20)
## Apply the univariate test statistic on the fitted model 
MahdiMcLeod(fit, lags)            ## Correct (no need to specify fitdf) 
MahdiMcLeod(fit, lags, fitdf = 2) ## Correct 
## Apply the test statistic on the residuals and set fitdf = 2 
res &lt;- resid(fit)
MahdiMcLeod(res, lags)             ## Wrong (fitdf is needed!)  
MahdiMcLeod(res, lags, fitdf = 2)  ## Correct 
##
##
## Quarterly, west German investment, income, and consumption from 1960 Q1 to 1982 Q4 
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
fit &lt;- ar.ols(DiffData, intercept = TRUE, order.max = 2)
lags &lt;- c(5,10)
## Apply the test statistic on the fitted model 
MahdiMcLeod(fit,lags)                ## Correct (no need to specify fitdf)
## Apply the test statistic on the residuals where fitdf = 2
res &lt;- ts((fit$resid)[-(1:2), ])
MahdiMcLeod(res,lags)                ## Wrong (fitdf is needed!)  
MahdiMcLeod(res,lags,fitdf = 2)      ## Correct 
##
##
## Monthly log stock returns of Intel corporation data: Test for ARCH Effects 
monthintel &lt;- as.ts(monthintel)
MahdiMcLeod(monthintel)                         ## Usual test 
MahdiMcLeod(monthintel,sqrd.res=TRUE)  ## Test for ARCH effects
##
#### Write a function to fit a model: Apply portmanteau test on fitted obj with class "list"
## Example
FitModel &lt;- function(data){
    fit &lt;- ar.ols(data, intercept = TRUE, order.max = 2)
    fitdf &lt;- 2
    res &lt;- res &lt;- ts((fit$resid)[-(1:2), ]) 
 list(res=res,fitdf=fitdf)
}
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
Fit &lt;- FitModel(DiffData)
MahdiMcLeod(Fit) 
</code></pre>

<hr>
<h2 id='monthintel'>The Monthly Log Stock Returns of Intel Corporation from January 1973 to December 2003
</h2><span id='topic+monthintel'></span>

<h3>Description</h3>

<p>The monthly log stock returns of Intel Corporation from January 1973 to December 2003.
This data has been discussed by Tsay (2005, p.99-102).
There are 372 data values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(monthintel)</code></pre>


<h3>References</h3>

<p>Tsay, R. S. (2005). &quot;Analysis of Financial Time Series&quot;. Wiley, New York, 2nd edition.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>acf(monthintel)
</code></pre>

<hr>
<h2 id='portest'>Portmanteau Test Statistics</h2><span id='topic+portest'></span>

<h3>Description</h3>

<p>Univariate or multivariate portmanteau 
test statistics of <code>BoxPierce</code>, <code>MahdiMcLeod</code>, <code>Hosking</code>, 
<code>LiMcLeod</code>, <code>LjungBox</code>, and possibly any other test statistic using 
Monte-Carlo techniques or asymptotic distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> portest(obj,lags=seq(5,30,5),test=c("MahdiMcLeod","BoxPierce","LjungBox",
      "Hosking","LiMcLeod","other"),fn=NULL,sqrd.res=FALSE,MonteCarlo=TRUE,
         innov.dist=c("Gaussian","t","bootstrap"), ncores=1,nrep=1000,
        model=list(sim.model=NULL,fit.model=NULL),pkg.name=NULL,set.seed=123,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="portest_+3A_obj">obj</code></td>
<td>
<p>if <code>obj</code> is an object of class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>, <code>("glm" "lm")</code>, 
<code>"varest"</code>, or <code>"list"</code> 
then a portmanteau goodness-of-fit test is done on the fitted model. 
Otherwise, for <code>obj</code> with class <code>"ts"</code>, <code>"numeric"</code>, <code>"matrix"</code>, 
or <code>("mts" "ts")</code>, a test of randomness is done.</p>
</td></tr>
<tr><td><code id="portest_+3A_lags">lags</code></td>
<td>
<p>vector of lag values is used for portmanteau test.</p>
</td></tr>
<tr><td><code id="portest_+3A_test">test</code></td>
<td>
<p>portmanteau test statistic type.</p>
</td></tr>
<tr><td><code id="portest_+3A_sqrd.res">sqrd.res</code></td>
<td>
<p>as described in <code>BoxPierce</code>, <code>MahdiMcLeod</code>, 
<code>Hosking</code>, <code>LiMcLeod</code>, and <code>LjungBox</code>.</p>
</td></tr> 
<tr><td><code id="portest_+3A_fn">fn</code></td>
<td>
<p>a function calculates the test statistic that is associated with <code>test = "other"</code>. 
For example, <code>fn</code> can be a function returns the generalized Durbin-Watson test statistic values calculated at
different lags. This function has at least two inputs: <code>obj</code> and <code>lags</code>, where <code>obj</code>
and <code>lags</code> are described as above.</p>
</td></tr> 
<tr><td><code id="portest_+3A_montecarlo">MonteCarlo</code></td>
<td>
<p>if <code>TRUE</code> then apply the Monte-Carlo version of portmanteau statistic. 
Otherwise, apply the asymptotic distribution. </p>
</td></tr>
<tr><td><code id="portest_+3A_innov.dist">innov.dist</code></td>
<td>
<p>distribution to generate univariate or multivariate innovation process. 
This could be <code>Gaussian</code>, <code>t</code>, or <code>bootstrap</code> using resampled errors rather than distributed errors.
Default is <code>Gaussian</code>.</p>
</td></tr>
<tr><td><code id="portest_+3A_ncores">ncores</code></td>
<td>
<p>number of cores needed to use in parallel calculations.
Default is a single CPU.</p>
</td></tr>
<tr><td><code id="portest_+3A_nrep">nrep</code></td>
<td>
<p>number of replications needed for Monte-Carlo test.</p>
</td></tr>
<tr><td><code id="portest_+3A_model">model</code></td>
<td>
<p>additional argument defined as a list with two specified functions, 
<code>sim.model</code> and <code>fit.model</code>.
This argument is needed when the class of <code>obj</code> is <code>"list"</code> 
(see details and following example).</p>
</td></tr> 
<tr><td><code id="portest_+3A_pkg.name">pkg.name</code></td>
<td>
<p>the name of the required library to be loaded if the Monte-Carlo significance test is used with
an object <code>obj</code> with class <code>"list"</code>.</p>
</td></tr> 
<tr><td><code id="portest_+3A_set.seed">set.seed</code></td>
<td>
<p><code>set.seed</code> is initialized. Default seed is 123, but users can use any seed they wish.</p>
</td></tr> 
<tr><td><code id="portest_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as <code>dft</code> degrees of freedom 
needed to generate innovations with univariate/multivariate series with t-distribution innovations, 
or <code>trunc.lag</code> used in <code><a href="#topic+varima.sim">varima.sim</a></code> function, or <code>fitdf</code> and <code>season</code> as described in
<code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>, <code><a href="#topic+Hosking">Hosking</a></code>, <code><a href="#topic+LiMcLeod">LiMcLeod</a></code> and <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The portmanteau test statistics, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, <code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>,
<code><a href="#topic+Hosking">Hosking</a></code>, and <code><a href="#topic+LiMcLeod">LiMcLeod</a></code> are implemented based on the Monte-Carlo techniques
and the approximation asymptotic distributions as described in Mahdi and McLeod (2012). 
Any other possible test statistic is also implemented in this function by selecting the argument 
<code>test = "other"</code> and providing the test statistic as a function passing the argument <code>fn</code>.
The null hypothesis assuming that the fitted model is an adequate 
model and the residuals behave like white noise series. 
This function can be used for testing the  
adequacy in the nonseasonal fitted time series models.
this function can be used to check for randomness as well as to check for <code>ARCH</code>-<code>GARCH</code> effects.
Any other fitted model, for example, threashold autoregression model,
may also be tested for adequacy.
In this case, two functions, <code>sim.model()</code> and <code>fit.model()</code>,
must be provided via the argument <code>func</code>.
The object <code>obj</code> is the output of the fitted model coded in
the function <code>fit.model</code> and it is a <code>"list"</code> with at least
<code>res</code>, the residuals from the fitted model in <code>fit.model()</code>, 
and <code>fitdf</code>, the fitdf of this fitted model.
The output from the function <code>sim.model()</code> is a simulated 
univariate or multivariate series from the fitted model obtained from the function
<code>fit.model()</code>.
The argument <code>pkg.name</code> represents the name of the <code>R</code> package where the fitted
model build in (see the last given example). 
The parallel computing using the <code>portes</code> package proposed by
Gonzalo Vera, Ritsert Jansen, and Remo Suppi (2008)
will run if one decide to choose the argument <code>MonteCarlo=TRUE</code> provided that 
<code>ncores</code> equals to a positive integer more than 1.
</p>


<h3>Value</h3>

<p>The portmanteau test statistic with the associated p-values 
for different lag values.
When the argument <code>MonteCarlo</code> is set to be <code>FALSE</code> then
the degrees of freedom will be an additional output.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Box, G.E.P. and Pierce, D.A. (1970). &quot;Distribution of Residual Autocorrelation in Autoregressive-Integrated Moving Average
Time Series Models&quot;. Journal of American Statistical Association, 65, 1509-1526.
</p>
<p>Fox, J and Weisberg, S and Adler, D and Bates, D and Baud-Bovy, G and Ellison, S and Firth, D and Friendly, M and 
Gorjanc, G and Graves, S and Heiberger, R and Laboissiere, R and Monette, G and Murdoch, D and Nilsson, H and Ogle, D 
and Ripley, B and Venables, W and Zeileis, A and R-Core (2019). car: Companion to Applied Regression. R package
version 3.0-3, <a href="https://CRAN.R-project.org/package=car">https://CRAN.R-project.org/package=car</a>.
</p>
<p>Fraley C, Leisch F, Maechler M, Reisen V, Lemonte A (2012). fracdiff: Fractionally differenced ARIMA aka ARFIMA(p,d,q) models. 
R package version 1.4-2, <a href="https://CRAN.R-project.org/package=fracdiff">https://CRAN.R-project.org/package=fracdiff</a>.
</p>
<p>Hosking, J. R. M. (1980). &quot;The Multivariate Portmanteau Statistic&quot;. 
Journal of American Statistical Association, 75, 602-608.
</p>
<p>John Haslett and Adrian E. Raftery (1989). &quot;Space-time Modelling with Long-memory Dependence: 
Assessing Ireland's Wind Power Resource (with Discussion)&quot;. Applied Statistics, 38, 1-50.
</p>
<p>Li, W. K. and McLeod, A. I. (1981). &quot;Distribution of The Residual Autocorrelations in 
Multivariate ARMA Time Series Models&quot;. Journal of The Royal Statistical Society, Series B, 43, 231-239.
</p>
<p>Lin, J.-W. and McLeod, A.I. (2006). &quot;Improved Generalized Variance Portmanteau Test&quot;.
Computational Statistics and Data Analysis 51, 1731-1738.
</p>
<p>Lin, J.-W. and McLeod, A.I. (2008). &quot;Portmanteau Tests for ARMA Models with Infinite Variance&quot;.  
Journal of Time Series Analysis, 29, 600-617.
</p>
<p>Ljung, G.M. and Box, G.E.P (1978). &quot;On a Measure of Lack of Fit in Time Series Models&quot;. 
Biometrika, 65, 297-303.
</p>
<p>Mahdi, E. and McLeod, A.I. (2012). &quot;Improved Multivariate Portmanteau Test&quot;. 
Journal of Time Series Analysis, 33(2), 211-222.
</p>
<p>McLeod A.I, Li W.K (1983). &quot;Distribution of the Residual Autocorrelation in Multivariate
ARMA Time Series Models&quot;. Journal of Time Series Analysis, 4, 269-273.
</p>
<p>Pena, D. and Rodriguez, J. (2002). &quot;A Powerful Portmanteau Test of Lack of Test for Time Series&quot;.
Journal of American Statistical Association, 97, 601-610.
</p>
<p>Pena, D. and Rodriguez, J. (2006). &quot;The log of the determinant of the autocorrelation
matrix for testing goodness of fit in time series&quot;. Journal of Statistical Planning and
Inference, 136, 2706-2718.
</p>
<p>Pfaff B, Stigler M (2018). vars: VAR Modelling. R package version 1.5-3, 
<a href="https://CRAN.R-project.org/package=vars">https://CRAN.R-project.org/package=vars</a>.
</p>
<p>Rob J Hyndman with contributions from George Athanasopoulos Slava Razbash DSZZYKCB,
Wang E (2019). forecast: Forecasting Functions for Time Series and Linear Models. 
R package version 8.7, <a href="https://CRAN.R-project.org/package=forecast">https://CRAN.R-project.org/package=forecast</a>.
</p>
<p>Tierney, L., Rossini, A. J., Li, N., and Sevcikova, H. (2018). snow: Simple Network of Workstations.
<code>R</code> package version 0.4-3. <a href="https://CRAN.R-project.org/package=snow">https://CRAN.R-project.org/package=snow</a>.
</p>
<p>Trapletti A, Hornik K, LeBaron B (2019). tseries: Time Series Analysis and Computational Finance. 
R package version 0.10-47, <a href="https://CRAN.R-project.org/package=tseries">https://CRAN.R-project.org/package=tseries</a>.
</p>
<p>Gonzalo Vera and Ritsert C. Jansen and Remo L. Suppi (2008). R/parallel - speeding 
up bioinformatics analysis with R. BMC Bioinformatics, 9:390.
</p>
<p>Wuertz D, core team members R (2019). fGarch: Rmetrics - Autoregressive Conditional
Heteroskedastic Modelling. R package version 3042.83.1, <a href="https://CRAN.R-project.org/package=fGarch">https://CRAN.R-project.org/package=fGarch</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+acf">acf</a></code>, <code><a href="stats.html#topic+ar">ar</a></code>, <code><a href="stats.html#topic+ar.ols">ar.ols</a></code>, <code><a href="stats.html#topic+ar.burg">ar.burg</a></code>, 
<code><a href="stats.html#topic+ar.yw">ar.yw</a></code>, <code><a href="stats.html#topic+ar.mle">ar.mle</a></code>, <code><a href="stats.html#topic+arima0">arima0</a></code>, <code><a href="stats.html#topic+arima">arima</a></code>, 
<code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, 
<code><a href="stats.html#topic+Box.test">Box.test</a></code>, <code><a href="#topic+BoxPierce">BoxPierce</a></code>, <code><a href="#topic+LjungBox">LjungBox</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, 
<code><a href="#topic+LiMcLeod">LiMcLeod</a></code>, <code><a href="#topic+portest">portest</a></code>, <code><a href="#topic+ToeplitzBlock">ToeplitzBlock</a></code>, <code><a href="#topic+GetResiduals">GetResiduals</a></code>, 
<code><a href="forecast.html#topic+Arima">Arima</a></code>, <code><a href="forecast.html#topic+auto.arima">auto.arima</a></code>, 
<code><a href="vars.html#topic+VAR">VAR</a></code>, <code><a href="fracdiff.html#topic+fracdiff">fracdiff</a></code>, 
<code><a href="fGarch.html#topic+garchFit">garchFit</a></code>, <code><a href="tseries.html#topic+garch">garch</a></code>, <code><a href="#topic+varima.sim">varima.sim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#################################################################################
####                                                                         ####
####                             Portmanteau Tests                           ####  
####                                                                         #### 
#################################################################################
## Monte-Carlo (MC) and asymptotic tests for randomness series                 ##
#################################################################################
data("DEXCAUS")
returns &lt;- log(DEXCAUS[-1]/DEXCAUS[-length(DEXCAUS)])
portest(returns)            ## MC using one CPU takes about 24.16 seconds
portest(returns, ncores=4)    ## MC using 4 CPUs takes about 9.51 seconds
portest(returns, MonteCarlo=FALSE)              ## asymptotic MahdiMcLeod
portest(returns,test="LjungBox", MonteCarlo=FALSE) ## asymptotic LjungBox 
#################################################################################
## Monte-Carlo goodness-of-fit arima test using 4 CPUs                         ##
#################################################################################
## arima() function takes about 11.32 seconds
## Example 1
ans1 &lt;- arima(WWWusage,fitdf=c(3,1,0))
portest(ans1, ncores = 4)
#
## arima0() function takes about 11.1 seconds
## Example 2
ans2 &lt;- arima0(WWWusage,fitdf=c(3,1,0))
portest(ans2, ncores = 4)
#
## Arima() or auto.arima() functions from forecast package take about 12.1 seconds
## Example 3
ans3 &lt;- Arima(WWWusage,fitdf=c(3,1,0))
portest(ans3, ncores = 4)
#
## ar() function takes about 7.39 seconds
## Example 4
ans4 &lt;- ar(Nile,fitdf.max=2)
portest(ans4, ncores = 4)
#
## ar() function with your own R code takes about 8.75 seconds
## Example 5
fit.model &lt;- function(data){
    fit &lt;- ar(data,aic = FALSE, fitdf.max=2)
    fitdf &lt;- 2
    res &lt;- ts(fit$resid[-(1:fitdf)]) 
    phi &lt;- fit$ar
    theta &lt;- NULL
    sigma &lt;- fit$var.pred
    demean &lt;- fit$x.mean
 list(res=res,phi=phi,theta=theta,sigma=sigma,demean=demean)
}
sim.model &lt;- function(parSpec){
    res &lt;- parSpec$res
    n &lt;- length(res)  
    innov &lt;- function(n) ts(stats::rnorm(n, mean = demean, sd = sqrt(sigma))) 
    phi &lt;- parSpec$phi
    theta &lt;- parSpec$theta
    sigma &lt;- parSpec$sigma 
    demean &lt;- parSpec$demean 
   arima.sim(n = n, list(ar = phi, ma = theta), rand.gen=innov)
}
ans5 &lt;- fit.model(Nile)
portest(ans5,ncores=4,model=list(sim.model=sim.model,fit.model=fit.model),pkg.name="stats")
#################################################################################
## Monte-Carlo test for seasonality                                            ##
#################################################################################
## Accidental Deaths in the US 1973 - 1978
seasonal.arima&lt;-Arima(USAccDeaths,fitdf=c(0,1,1),seasonal=list(fitdf= c(0,1,1)))
portest(seasonal.arima,ncores=4,nrep=1000,lags=1:5)
## Quarterly U.K. economic time series from 1957 Q3 to 1967 Q4
cd &lt;- EconomicUK[,1]
cd.fit &lt;- Arima(cd,fitdf=c(0,1,0),seasonal=list(fitdf=c(0,1,1),period=4))
portest(cd.fit, lags = c(5,10),ncores=4)
#################################################################################
## Monte-Carlo test for linear models and time series regression               ##
#################################################################################
## Linear Model
require("car")
fit &lt;- lm(fconvict ~ tfr + partic + degrees + mconvict, data=Hartnagel)
portest(fit,lags=1:3,ncores=4)          ## MC of MahdiMcLeod test
## MC of generalized Durbin-Watson test needs the argument function fn() as follows
fn &lt;- function(obj,lags){
     test.stat &lt;- numeric(length(lags))
       for (i in 1:length(lags))
          test.stat[i] &lt;- -sum(diff(obj,lag=lags[i])^2)/sum(obj^2)
       test.stat
}	
portest(fit,lags=1:3,test="other",fn=fn,ncores=4) 
detach(package:car)
## Time series regression 
fit.arima &lt;- Arima(LakeHuron, fitdf = c(2,0,0), xreg = time(LakeHuron)-1920)
portest(fit.arima,ncores=4)
#################################################################################
## Monte-Carlo goodness-of-fit VAR test - Multivariate series                  ##
#################################################################################
data("IbmSp500")
ibm &lt;- log(IbmSp500[,2]+1)*100
sp500 &lt;- log(IbmSp500[,3]+1)*100
IBMSP500 &lt;- data.frame(cbind(ibm,sp500))
## ar.ols() function takes about 9.11 seconds
ans6 &lt;-  ar.ols(IBMSP500, aic=FALSE, intercept=TRUE, fitdf.max=5)
portest(ans6,nrep=100,test="MahdiMcLeod",ncores=4,innov.dist="t",dft=5)
## VAR() function takes about 11.55 seconds
require("vars")
ans7 &lt;- VAR(IBMSP500, p=5) 
portest(ans7,nrep=100,test="MahdiMcLeod",ncores=4,innov.dist="bootstrap")
portest(ans7,test="Hosking",MonteCarlo=FALSE) ## asymptotic Hosking test
detach(package:vars)
#################################################################################
## Monte-Carlo test for ARCH/GARCH effects using 4 CPUs                        ##
#################################################################################
## It takes about 12.65 seconds
data("monthintel")
returns &lt;- as.ts(monthintel)
lags &lt;- c(5, 10, 20, 40)
portest(returns, lags = lags, ncores = 4, sqrd.res = FALSE)
portest(returns,lags=lags,ncores=4,sqrd.res=TRUE,innov.dist="t",dft=5)

## End(Not run)
</code></pre>

<hr>
<h2 id='ToeplitzBlock'>Toeplitz Block Matrix of Hosking (1980) Auto and Cross Correlation Matrices</h2><span id='topic+ToeplitzBlock'></span>

<h3>Description</h3>

<p>Block Toeplitz matrix of order <code class="reqn">m+1</code> with <code class="reqn">k\times k</code> auto-cross correlation matrices. 
The Hosking (1980) definition of the correlation matrix is used.
This is needed for the function <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ToeplitzBlock(res,Maxlag)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ToeplitzBlock_+3A_res">res</code></td>
<td>
<p>residuals, numeric or matrix. </p>
</td></tr>
<tr><td><code id="ToeplitzBlock_+3A_maxlag">Maxlag</code></td>
<td>
<p>an integer number = <code class="reqn">m</code> is used to determined the order of the block matrix. </p>
</td></tr>
</table>


<h3>Value</h3>

 
<p>A block Toeplitz matrix of auto and cross correlation matrices using Hosking (1980) definition 
from <code>lag</code> = <code class="reqn">0</code> to <code>lag</code> = <code class="reqn">m</code>.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Hosking, J. R. M. (1980). &quot;The Multivariate Portmanteau Statistic&quot;. 
Journal of American Statistical Association, 75, 602-608.
</p>
<p>Lin, J.-W. and McLeod, A.I. (2006). &quot;Improved Generalized Variance Portmanteau Test&quot;. 
Computational Statistics and Data Analysis, 51, 1731-1738.
</p>
<p>Mahdi, E. and McLeod, A.I. (2011, accepted). &quot;Improved Multivariate Portmanteau Test&quot;. 
Journal of Time Series Analysis. (JTSA - 3192).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+acf">acf</a></code>, <code><a href="#topic+MahdiMcLeod">MahdiMcLeod</a></code>, <code><a href="stats.html#topic+toeplitz">toeplitz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)   
ToeplitzBlock(x,Maxlag=4)          ## Univariate Series
#
y &lt;- cbind(rnorm(100),rnorm(100)) 
ToeplitzBlock(y,Maxlag=4)          ## Multivariate Series
</code></pre>

<hr>
<h2 id='varima.sim'>Simulate Data From Seasonal/Nonseasonal ARIMA(p,d,q)*(ps,ds,qs)_s or VARIMA(p,d,q)*(ps,ds,qs)_s Models</h2><span id='topic+varima.sim'></span>

<h3>Description</h3>

<p>Simulate time series from AutoRegressive Integrated Moving Average, <code>ARIMA(p,d,q)</code>, or 
Vector Integrated AutoRegressive Moving Average, <code>VARIMA(p,d,q)</code>, 
where <code>d</code> is a nonnegative difference integer in the <code>ARIMA</code> case 
and it is a vector of <code class="reqn">k</code> differenced components
<code class="reqn">d_1,...,d_k</code> in the <code>VARIMA</code> case.
In general, this function can be implemented in simulating univariate or multivariate 
Seasonal AutoRegressive Integrated Moving Average, <code>SARIMA(p,d,q)*(ps,ds,qs)_s</code> 
and <code>SVARIMA(p,d,q)*(ps,ds,qs)_s</code>, where <code>ps</code> and <code>qs</code> are 
the orders of the seasonal univariate/multivariate AutoRegressive and Moving Average components respectively.
<code>ds</code> is a nonnegative difference integer in the <code>SARIMA</code> case 
and it is a vector of <code class="reqn">k</code> differenced components <code class="reqn">ds_1,...,ds_k</code> in the <code>SVARIMA</code> case, 
whereas <code>s</code> is the seasonal period. 
The simulated process may have a deterministic terms, drift constant and time trend, with non-zero mean.
The innovations may have finite or infinite variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varima.sim(model=list(ar=NULL,ma=NULL,d=NULL,sar=NULL,sma=NULL,D=NULL,period=NULL),
          n,k=1,constant=NA,trend=NA,demean=NA,innov=NULL, 
          innov.dist=c("Gaussian","t","bootstrap"),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varima.sim_+3A_model">model</code></td>
<td>
<p>a list with univariate/multivariate component <code>ar</code> and/or <code>ma</code> and/or <code>sar</code>
and/or <code>sma</code> giving the univariate/multivariate <code>AR</code> and/or <code>MA</code> and/or <code>SAR</code> 
and/or <code>SMA</code> coefficients respectively. 
<code>period</code> specifies the seasonal period. 
For seasonality, default is <code>NULL</code> indicates that <code>period =12</code>. 
<code>d</code> and <code>D</code> are integer or vector representing the order of the usual and seasonal difference.
An empty list gives an <code>ARIMA(0, 0, 0)*(0,0,0)_null</code> model, that is white noise.</p>
</td></tr>
<tr><td><code id="varima.sim_+3A_n">n</code></td>
<td>
<p>length of the series.</p>
</td></tr>
<tr><td><code id="varima.sim_+3A_k">k</code></td>
<td>
<p> number of simulated series. For example, <code>k=1</code> is used for univariate series and <code>k=2</code> is used for bivariate series.</p>
</td></tr> 
<tr><td><code id="varima.sim_+3A_constant">constant</code></td>
<td>
<p>a numeric vector represents the intercept in the deterministic equation.</p>
</td></tr>
<tr><td><code id="varima.sim_+3A_trend">trend</code></td>
<td>
<p>a numeric vector represents the slop in the deterministic equation.</p>
</td></tr>
<tr><td><code id="varima.sim_+3A_demean">demean</code></td>
<td>
<p>a numeric vector represents the mean of the series.</p>
</td></tr>
<tr><td><code id="varima.sim_+3A_innov">innov</code></td>
<td>
<p>a vector of univariate or multivariate innovation series. 
This may used as an initial series to genrate innovations with <code>innov.dist = "bootstrap"</code>.
This argument is irrelevant with the other selections of <code>innov.dist</code>.</p>
</td></tr>
<tr><td><code id="varima.sim_+3A_innov.dist">innov.dist</code></td>
<td>
<p>distribution to generate univariate or multivariate innovation process. 
This could be <code>Gaussian</code>, <code>t</code>, or <code>bootstrap</code> using resampled errors rather than distributed errors.
Default is <code>Gaussian</code>.</p>
</td></tr>
<tr><td><code id="varima.sim_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as <code>dft</code> degrees of freedom 
needed to generate innovations with univariate/multivariate series with t-distribution innovations.
The argument <code>trunc.lag</code> represents the truncation lag that is used 
to truncate the infinite <code>MA</code> or <code>VMA</code> Process. 
IF it is not given, then <code>trunc.lag</code> = min(100, <code class="reqn">n/3</code>). 
Optionally <code>sigma</code> is the variance of a Gaussian or t white noise series.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to simulate a univariate/multivariate seasonal/nonseasonal 
<code>SARIMA</code> or <code>SVARIMA</code> model of order <code class="reqn">(p,d,q)\times(ps,ds,qs)_s</code> 
</p>
<p style="text-align: center;"><code class="reqn">\phi(B)\Phi(B^s)d(B)D(B^s)(Z_{t})-\mu = a + b \times t + \theta(B)\Theta(B^s)e_{t},</code>
</p>

<p>where <code class="reqn">a, b,</code> and <code class="reqn">\mu</code> correspond to the arguments <code>constant</code>, <code>trend</code>, and <code>demean</code> respectively.
The univariate or multivariate series <code class="reqn">e_{t}</code> represents the innovations series given from the argument <code>innov</code>.
If <code>innov = NULL</code> then <code class="reqn">e_{t}</code> will be generated from   
a univariate or multivariate normal distribution or t-distribution. 
<code class="reqn">\phi(B)</code> and <code class="reqn">\theta(B)</code> are the <code>VAR</code> and the <code>VMA</code> coefficient matrices respectively 
and <code class="reqn">B</code> is the backshift time operator.
<code class="reqn">\Phi(B^s)</code> and <code class="reqn">\Theta(B^s)</code> are the <code>Vector SAR</code> <code>Vector SMA</code> 
coefficient matrices respectively.
<code class="reqn">d(B)=diag[(1-B)^{d_{1}},\ldots,(1-B)^{d_{k}}]</code> and
<code class="reqn">D(B^s)=diag[(1-B^s)^{ds_{1}},\ldots,(1-B^s)^{ds_{k}}]</code> are diagonal matrices. 
This states that each individual series <code class="reqn">Z_{i}, i=1,...,k</code> is differenced <code class="reqn">d_{i}ds_{i}</code> times
to reduce to a stationary <code>Vector ARMA(p,0,q)*(ps,0,qs)_s</code> series.
</p>


<h3>Value</h3>

<p>Simulated data from <code>SARIMA(p,d,q)</code> or <code>SVARIMA(p,d,q)*(ps,ds,qs)_s</code> process 
that may have a drift and deterministic time trend terms.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Hipel, K.W. and McLeod, A.I. (2005). &quot;Time Series Modelling of Water Resources and Environmental Systems&quot;.
</p>
<p>Reinsel, G. C. (1997). &quot;Elements of Multivariate Time Series Analysis&quot;. Springer-Verlag, 2nd edition.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+arima.sim">arima.sim</a></code>, <code><a href="#topic+vma.sim">vma.sim</a></code>, <code><a href="#topic+ImpulseVMA">ImpulseVMA</a></code>, <code><a href="#topic+InvertQ">InvertQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#################################################################################
# Simulate white noise series from a Gaussian distribution                      #
#################################################################################
set.seed(1234)
Z1 &lt;- varima.sim(n=400)       ## a univariate series
plot(Z1)
Z2 &lt;- varima.sim(n=400,k=2)   ## a bivariate series
plot(Z2)
Z3 &lt;- varima.sim(n=400,k=5)   ## a multivariate series of dimension 5
plot(Z3)
#################################################################################
# Simulate MA(1) where innovation series is provided via argument innov         #
#################################################################################
set.seed(1234)
n &lt;- 200
ma &lt;-  0.6
Z&lt;-varima.sim(list(ma=ma),n=n,innov=rnorm(n),innov.dist="bootstrap")
plot(Z)
#################################################################################
# Simulate seasonal ARIMA(2,1,0)*(0,2,1)_12 process with ar=c(1.3,-0.35),      #
# ma.season = 0.8. Gaussian innovations. The series is truncated at lag 50   #
#################################################################################
set.seed(12834)
n &lt;- 100
ar &lt;- c(1.3, -0.35)
ma.season &lt;- 0.8
Z&lt;-varima.sim(list(ar=ar,d=1,sma=ma.season,D=2),n=n,trunc.lag=50)
plot(Z)
acf(Z)
#################################################################################
# Simulate seasonal ARMA(0,0,0)*(2,0,0)_4 process with intercept = 0.8          #
# ar.season = c(0.9,-0.9), period = 4, t5-distribution innovations with df = 3 #
#################################################################################
set.seed(1234)
n &lt;- 200
ar.season &lt;- c(0.9,-0.9)
Z&lt;-varima.sim(list(sar=ar.season,period=4),n=n,constant=0.8,innov.dist="t",dft=3)
plot(Z)
acf(Z)
arima(Z,order=c(0,0,0),seasonal = list(order = c(2,0,0),period=4))
#################################################################################
# Simulate a bivariate white noise series from a multivariate t4-distribution   #
# Then use the nonparametric bootstrap method to generate a seasonal SVARIMA    #
# of order (0,d,0)*(0,0,1)_12 with d = c(1, 0), n= 250, k = 2, and              #
# ma.season=array(c(0.5,0.4,0.1,0.3),dim=c(k,k,1))                           #
#################################################################################
set.seed(1234)
Z1 &lt;- varima.sim(n=250,k=2,innov.dist="t",dft=4)
ma.season=array(c(0.5,0.4,0.1,0.3),dim=c(2,2,1)) 
Z2 &lt;- varima.sim(list(sma=ma.season,d=c(1,0)),n=250,k=2,
                 innov=Z1,innov.dist="bootstrap")
plot(Z2)
#################################################################################
# Simulate a bivariate VARIMA(2,d,1) process with length 300, where d=(1,2).    #
# ar = array(c(0.5,0.4,0.1,0.5,0,0.3,0,0),dim=c(k,k,2)),                       #
# ma = array(c(0,0.25,0,0), dim=c(k,k,1)).                                   #
# innovations are generated from multivariate normal                            #
# The process have mean zero and no deterministic terms.                        #
# The variance covariance is sigma = matrix(c(1,0.71,0.71,2),2,2).              #
# The series is truncated at default value: trunc.lag=ceiling(100/3)=34         #
#################################################################################
set.seed(1234)
k &lt;- 2
n &lt;- 300 
ar &lt;-  array(c(0.5,0.4,0.1,0.5,0,0.3,0,0),dim=c(k,k,2))
ma &lt;-  array(c(0,0.25,0,0),dim=c(k,k,1))
d &lt;- c(1,2)
sigma &lt;- matrix(c(1,0.71,0.71,2),k,k)
Z &lt;- varima.sim(list(ma=ar,ma=ma,d=d),n=n,k=2,sigma=sigma)
plot(Z)
#################################################################################
# Simulate a trivariate Vector SVARMA(1,0,0)*(1,0,0)_12 process with length 300 #
# ar = array(c(0.5,0.4,0.1,0.5,0,0.3,0,0,0.1), dim=c(k,k,1)), where k =3       #
# ar.season = array(c(0,0.25,0,0.5,0.1,0.4,0,0.25,0.6), dim=c(k,k,1)).         #
# innovations are generated from multivariate normal distribution               #
# The process have mean c(10, 0, 12),                                           #
# Drift equation a + b * t, where a = c(2,1,5), and b = c(0.01,0.06,0)          #
# The series is truncated at default value: trunc.lag=ceiling(100/3)=34         #
#################################################################################
set.seed(1234)
k &lt;- 3
n &lt;- 300
ar &lt;-  array(c(0.5,0.4,0.1,0.5,0,0.3,0,0,0.1),dim=c(k,k,1))
ar.season &lt;-  array(c(0,0.25,0,0.5,0.1,0.4,0,0.25,0.6),dim=c(k,k,1))
constant &lt;- c(2,1,5)
trend &lt;- c(0.01,0.06,0)
demean &lt;- c(10,0,12)
Z &lt;- varima.sim(list(ar=ar,sar=ar.season),n=n,k=3,constant=constant,
trend=trend,demean=demean)
plot(Z)
acf(Z)
</code></pre>

<hr>
<h2 id='vma.sim'>Compute The Vector of Moving Average Model (VMA)</h2><span id='topic+vma.sim'></span>

<h3>Description</h3>

<p>This utility function is useful to use in the function <code><a href="#topic+varima.sim">varima.sim</a></code> 
and may used to compute the coefficients of moving-average or vector moving-average.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vma.sim(psi, a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vma.sim_+3A_psi">psi</code></td>
<td>
<p>the impulse coefficients.</p>
</td></tr>
<tr><td><code id="vma.sim_+3A_a">a</code></td>
<td>
<p>innovations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of length <code class="reqn">n</code> (in the univariate case), or <code class="reqn">n</code> matrices (in the multivariate case), 
where <code class="reqn">n</code> = length(<code class="reqn">a</code>)-length(<code class="reqn">\Psi</code>) and <code class="reqn">n\times k</code> is the dimension of the series.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Hannan, E.J. (1970). &quot;Multiple Time Series&quot;. New York: Wiley.
</p>
<p>Hipel, K.W. and McLeod, A.I. (2005). &quot;Time Series Modelling of Water Resources and Environmental Systems&quot;.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+convolve">convolve</a></code>, <code><a href="#topic+varima.sim">varima.sim</a></code>, <code><a href="stats.html#topic+arima.sim">arima.sim</a></code>, <code><a href="#topic+ImpulseVMA">ImpulseVMA</a></code>, 
<code><a href="#topic+InvertQ">InvertQ</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k &lt;- 2
n &lt;- 300
trunc.lag &lt;-  50   
ar &lt;-  array(c(0.5,0.4,0.1,0.5),dim=c(k,k,1))
ma &lt;-  array(c(0,0.25,0,0),dim=c(k,k,1))
sigma &lt;- matrix(c(1,0.71,0.71,2),k,k)
p &lt;- ifelse(is.null(ar),0,dim(ar)[3])
q &lt;- ifelse(is.null(ma),0,dim(ma)[3])
r &lt;- max(p, q)
d &lt;- trunc.lag + r
psi &lt;- ImpulseVMA(ar = ar, ma = ma, trunc.lag = trunc.lag)
a &lt;- t(crossprod(chol(sigma),matrix(rnorm(k*d),ncol=d)))
vma.sim(psi = psi, a = a)
</code></pre>

<hr>
<h2 id='WestGerman'>
Quarterly, West German Investment, Income, and Consumption: 1960Q1-1982Q4
</h2><span id='topic+WestGerman'></span>

<h3>Description</h3>

<p>Quarterly, seasonally adjusted, West German fixed investment, disposable income, consumption expenditures in billions of DM, 
1960Q1-1982Q4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(WestGerman)</code></pre>


<h3>Format</h3>

<p>A data frame with 92 observations on the following 3 variables.
</p>

<dl>
<dt><code>invest</code></dt><dd><p>a numeric vector denotes the investment in billions of DM</p>
</dd>
<dt><code>income</code></dt><dd><p>a numeric vector denotes the income in billions of DM</p>
</dd>
<dt><code>cons</code></dt><dd><p>a numeric vector denotes the consumption expenditures in billions of DM</p>
</dd>
</dl>



<h3>Source</h3>

<p>Deutsche Bundesbank; <a href="http://www.jmulti.de/data_imtsa.html">http://www.jmulti.de/data_imtsa.html</a>
</p>


<h3>References</h3>

<p>Lutkepohl, H. (2005). &quot;New introduction to multiple time series analysis&quot;. Springer-Verlag, New York.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
