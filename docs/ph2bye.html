<!DOCTYPE html><html><head><title>Help for package ph2bye</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ph2bye}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayes.design'><p>Bayesian design method for sequentially monitoring patients using Beta-Binomial posterior probability based on observing data</p></a></li>
<li><a href='#BB.aniplot'><p>Sequentially monitor patients using Beta-Binomial posterior probability</p></a></li>
<li><a href='#DT.design'><p>The whole design with double thresholds showing futility and efficacy boundary together</p></a></li>
<li><a href='#MultPostP'><p>The posterior probability criterion function for Phase II single-arm design</p></a></li>
<li><a href='#MultPostP.design'><p>The stopping boundaries based on the multiple outcomes criterion</p></a></li>
<li><a href='#ph2bye-package'><p>ph2bye: A package for Phase II single-arm Bayesian design.</p></a></li>
<li><a href='#PostP'><p>The posterior probability criterion function for Phase II single-arm design</p></a></li>
<li><a href='#PostP.design'><p>The stopping boundaries based on the posterior probability criterion</p></a></li>
<li><a href='#PredP'><p>The predictive probability criterion function for Phase II single-arm design</p></a></li>
<li><a href='#PredP.design'><p>The stopping boundaries based on the predictive probability criterion</p></a></li>
<li><a href='#prior'><p>Beta priors determination based on different prior information</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phase II Clinical Trial Design Using Bayesian Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.4</td>
</tr>
<tr>
<td>Author:</td>
<td>Yalin Zhu, Rui Qin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yalin Zhu &lt;yalin.zhu@outlook.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate the Bayesian posterior/predictive probability and
    determine the sample size and stopping boundaries for single-arm Phase II design.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://allen.shinyapps.io/BayesDesign/">https://allen.shinyapps.io/BayesDesign/</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats, graphics, animation, nleqslv</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, VGAM</td>
</tr>
<tr>
<td>Suggests:</td>
<td>clinfun, gsDesign, survival</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-08-21 19:51:00 UTC; yalin.zhu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-08-21 22:11:03</td>
</tr>
</table>
<hr>
<h2 id='bayes.design'>Bayesian design method for sequentially monitoring patients using Beta-Binomial posterior probability based on observing data</h2><span id='topic+bayes.design'></span>

<h3>Description</h3>

<p>Make animation plots to present sequential monitor stopping rule using Beta-Binomial Bayesian model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes.design(a,b,r=0, stop.rule="futility", add.size=5, alpha=0.05,
p0 ,delta=0.2,tau1=0.9,tau2=0.9,tau3=0.9,tau4=0.9, time.interval =1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes.design_+3A_a">a</code></td>
<td>
<p>the hyperparameter (shape1) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_b">b</code></td>
<td>
<p>the hyperparameter (shape2) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_r">r</code></td>
<td>
<p>the maximum number of patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_stop.rule">stop.rule</code></td>
<td>
<p>the hyperparameter (shape1) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_add.size">add.size</code></td>
<td>
<p>a single integer value, random number generator (RNG) state for random number generation.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_alpha">alpha</code></td>
<td>
<p>the siginificant level to determine the credible interval, set 0.05 by default.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_p0">p0</code></td>
<td>
<p>the prespecified reseponse rate.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_delta">delta</code></td>
<td>
<p>the minimally acceptable increment of the response rate.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_tau1">tau1</code></td>
<td>
<p>threshold for stopping rule 1.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_tau2">tau2</code></td>
<td>
<p>threshold for stopping rule 2.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_tau3">tau3</code></td>
<td>
<p>threshold for stopping rule 3.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_tau4">tau4</code></td>
<td>
<p>threshold for stopping rule 4.</p>
</td></tr>
<tr><td><code id="bayes.design_+3A_time.interval">time.interval</code></td>
<td>
<p>a positive number to set the time interval of the animation (unit in seconds); default to be 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>animation plot of determination of stopping boundaries.
</p>


<h3>References</h3>

<p>Yin, G. (2012).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using Multiple Myeloma (MM) data example
MM.r = rep(0,6); MM.mean = 0.1; MM.var = 0.0225
a &lt;- MM.mean^2*(1-MM.mean)/MM.var - MM.mean; b &lt;- MM.mean*(1-MM.mean)^2/MM.var - (1-MM.mean)
bayes.design(a=a,b=b,r=MM.r,stop.rule="futility",p0=0.1)

# Using Acute Promyelocytic Leukaemia (APL) data example
APL.r &lt;- c(0,1,0,0,1,1); APL.mean = 0.3; APL.var = 0.0191
a &lt;- APL.mean^2*(1-APL.mean)/APL.var - APL.mean; b &lt;- APL.mean*(1-APL.mean)^2/APL.var - (1-APL.mean)
bayes.design(a=a,b=b,r=APL.r,stop.rule="efficacy",p0=0.1)
</code></pre>

<hr>
<h2 id='BB.aniplot'>Sequentially monitor patients using Beta-Binomial posterior probability</h2><span id='topic+BB.aniplot'></span>

<h3>Description</h3>

<p>Make animation plots to present sequential monitor the patients using Beta-Binomial Bayesian model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BB.aniplot(a, b, r, N=1, alpha=0.05, seed=1234, time.interval=1, output=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BB.aniplot_+3A_a">a</code></td>
<td>
<p>the hyperparameter (shape1) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="BB.aniplot_+3A_b">b</code></td>
<td>
<p>the hyperparameter (shape2) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="BB.aniplot_+3A_r">r</code></td>
<td>
<p>vector of number of response in each cohort, the value of each element should not exceed N</p>
</td></tr>
<tr><td><code id="BB.aniplot_+3A_n">N</code></td>
<td>
<p>the number of patients treated by the experimental drug at a certain stage of the trial.</p>
</td></tr>
<tr><td><code id="BB.aniplot_+3A_alpha">alpha</code></td>
<td>
<p>the siginificant level to determine the credible interval, set 0.05 by default.</p>
</td></tr>
<tr><td><code id="BB.aniplot_+3A_seed">seed</code></td>
<td>
<p>a single integer value, random number generator (RNG) state for random number generation.</p>
</td></tr>
<tr><td><code id="BB.aniplot_+3A_time.interval">time.interval</code></td>
<td>
<p>a positive number to set the time interval of the animation (unit in seconds); default to be 1.</p>
</td></tr>
<tr><td><code id="BB.aniplot_+3A_output">output</code></td>
<td>
<p>a logical value, whether to output the inference results of posterior distribution and mean, observed data and credible interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>animation plot of updating posterior as prior, and output the inference information of prior and posterior distribution if <code>output=TRUE</code>.
</p>


<h3>References</h3>

<p>Yin, G. (2012).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using APL data
r=rep(0,6)
BB.aniplot(a=1,b=1,r=r, alpha=0.05, seed=1234)
# Simulate binomial data
B &lt;- 10; N=1; p=0.3
r &lt;- rbinom(n = B,size = N,prob = p)
BB.aniplot(a=1,b=1,r=r,time.interval = 0.2,output = FALSE)
</code></pre>

<hr>
<h2 id='DT.design'>The whole design with double thresholds showing futility and efficacy boundary together</h2><span id='topic+DT.design'></span>

<h3>Description</h3>

<p>The design function to sequentially monitor sample size and stopping boundary for both futility and efficacy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DT.design(type, a, b, nmin, nmax, p0, p1, theta0, theta1, theta_t, optimize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DT.design_+3A_type">type</code></td>
<td>
<p>type of stopping criterion: &quot;PostP&quot; or &quot;PredP&quot;.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_a">a</code></td>
<td>
<p>the hyperparameter (shape1) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_b">b</code></td>
<td>
<p>the hyperparameter (shape2) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_nmin">nmin</code></td>
<td>
<p>the minimum number of patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_nmax">nmax</code></td>
<td>
<p>the maximum number of patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_p0">p0</code></td>
<td>
<p>the pre-specified reseponse rate.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_p1">p1</code></td>
<td>
<p>the pre-specified reseponse rate.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_theta0">theta0</code></td>
<td>
<p>the cutoff probability for futility: typically, <code class="reqn">\theta_0 = [0.01, 0.1]</code>.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_theta1">theta1</code></td>
<td>
<p>the cutoff probability for efficacy: typically, <code class="reqn">\theta_1 = [0.9, 0.99]</code>.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_theta_t">theta_t</code></td>
<td>
<p>the cutoff probability for efficacy including future patients; typically, <code class="reqn">\theta_T = [0.85, 0.95]</code>. Set 0.9 by default.</p>
</td></tr>
<tr><td><code id="DT.design_+3A_optimize">optimize</code></td>
<td>
<p>logical value, if optimize=TRUE, then only output the minimal sample size for the same number of futility and efficacy boundaries.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>boundsets</code></td>
<td>
<p>the boundaries sets: <code class="reqn">U_n</code> and <code class="reqn">L_n</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Thall, P. F., Simon, R. (1994).
Practical Bayesian guidelines for phase IIB clinical trials.
<em>Biometrics</em> <strong>50</strong>: 337-349.
</p>
<p>Lee, J. J., Liu, D. D. (2008).
A predictive probability design for phase II cancer clinical trials.
<em>Clinical Trials</em> <strong>5</strong>: 93-106.
</p>
<p>Yin, G. (2012).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using vague prior Unif(0,1), sequential monitor
DT.design(type = "PostP", a=1, b=1, nmin=20, nmax=60, p0=0.4, p1=0.3, theta0 = 0.05, theta1 = 0.9)
DT.design(type = "PredP", a=1, b=1, nmin=20, nmax=60, p0=0.4, p1=0.3, theta0 = 0.05, theta1 = 0.9,
theta_t = 0.9)
## Or using Jeffery prior with Beta(0.5,0.5), multi-stage monitor when sample size is
## 10, 20, ..., 80
DT.design(type = "PostP", a=0.5, b=0.5, nmin=1, nmax=85, p0=0.3, p1=0.3, theta0 = 0.05,
theta1 = 0.9)[(1:8)*10,]
DT.design(type = "PredP", a=0.5, b=0.5, nmin=1, nmax=85, p0=0.3, p1=0.3, theta0 = 0.05,
theta1 = 0.9, theta_t = 0.9)[(1:8)*10,]
</code></pre>

<hr>
<h2 id='MultPostP'>The posterior probability criterion function for Phase II single-arm design</h2><span id='topic+MultPostP'></span>

<h3>Description</h3>

<p>Thall, Simon and Estey's criterion function for determining the trial decision boundaries for efficacy (futility) and safety (toxicity).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MultPostP(x, n, a.vec, p0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MultPostP_+3A_x">x</code></td>
<td>
<p>the value of observed data.  It can be <code class="reqn">x_{E}=y_{ET}+y_{E T^C}</code> i.e. number of responses for efficacy among <code class="reqn">n</code> patients treated by the experimental drug, or <code class="reqn">x_{T}= y_{ET}+y_{E^C T}</code> i.e. number of responses for toxicity among <code class="reqn">n</code> patients treated by the experimental drug, where <code class="reqn">y = (y_{ET}, y_{E^C T}, y_{ET^C}, y_{E^C T^C})</code>, that is, among <code class="reqn">n</code> patients treated by the experimental drug, <code class="reqn">y_{ET}</code> of them have experienced both toxicity and efficacy, <code class="reqn">y_{E^C T}</code> have experienced toxicity only, <code class="reqn">y_{ET^C}</code> have experienced efficacy only, <code class="reqn">y_{E^C T^C}</code> have neither experienced toxicity nor efficacy.</p>
</td></tr>
<tr><td><code id="MultPostP_+3A_n">n</code></td>
<td>
<p>the number of patients treated by the experimental drug at a certain stage of the trial.</p>
</td></tr>
<tr><td><code id="MultPostP_+3A_a.vec">a.vec</code></td>
<td>
<p>the hyperparameter vector of the Dirichlet prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="MultPostP_+3A_p0">p0</code></td>
<td>
<p>the prespecified reseponse rate for efficacy, futility or toxicity.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prob</code></td>
<td>
<p>the posterior probability: <code class="reqn">Pr(p_E &gt; p_0 | X=x_E)</code> or <code class="reqn">Pr(p_T &gt; p_0 | X=x_T)</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Berry, S. M., Carlin, B. P., Lee, J. J., &amp; Muller, P. (2010).
<em>Bayesian adaptive methods for clinical trials.</em>
CRC press.
</p>
<p>Thall, Peter F., Richard M. Simon, and Elihu H. Estey. (1995).
<em>Bayesian sequential monitoring designs for single-arm clinical trials with multiple outcomes.</em>
<em>Statistics in medicine</em> <strong>14.4</strong>: 357-379.
</p>
<p>Yin, G. (2013).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 30; x.eff &lt;- 5; x.tox &lt;- 8; param &lt;- c(1,1,1,1); p0.eff &lt;- 0.9; p0.tox &lt;- 0.95
MultPostP(x=x.eff, n=n, a.vec=param, p0=p0.eff)
MultPostP(x=x.tox, n=n, a.vec=param, p0=p0.tox)
</code></pre>

<hr>
<h2 id='MultPostP.design'>The stopping boundaries based on the multiple outcomes criterion</h2><span id='topic+MultPostP.design'></span>

<h3>Description</h3>

<p>The design function to sequentially monitor sample size and boundary based on Thall, Simon and Estey's criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MultPostP.design(type, nmax, a.vec, p0, theta, optimize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MultPostP.design_+3A_type">type</code></td>
<td>
<p>type of boundaries: &quot;efficacy&quot; or &quot;futility&quot; or &quot;toxicity&quot;.</p>
</td></tr>
<tr><td><code id="MultPostP.design_+3A_nmax">nmax</code></td>
<td>
<p>the maximum number of patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="MultPostP.design_+3A_a.vec">a.vec</code></td>
<td>
<p>the hyperparameter vector of the Dirichlet prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="MultPostP.design_+3A_p0">p0</code></td>
<td>
<p>the prespecified reseponse rate for efficacy or toxicity.</p>
</td></tr>
<tr><td><code id="MultPostP.design_+3A_theta">theta</code></td>
<td>
<p>the cutoff probability: typically, <code class="reqn">\theta = [0.9, 0.99]</code> for efficacy, <code class="reqn">\theta = [0.01, 0.1]</code> for futility, and <code class="reqn">\theta = [0.95, 1]</code> for toxicity.</p>
</td></tr>
<tr><td><code id="MultPostP.design_+3A_optimize">optimize</code></td>
<td>
<p>logical value, if optimize=TRUE, then only output the minimal sample size for the same number of futility boundaries and maximal sample size for the same number efficacy boundaries</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>boundset</code></td>
<td>
<p>the boundaries set: <code class="reqn">U_n</code> or <code class="reqn">L_n</code> for the experimental drug efficacy or futility; <code class="reqn">T_n</code> for the experimental drug toxicity.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Thall, Peter F., Richard M. Simon, and Elihu H. Estey. (1995).
<em>Bayesian sequential monitoring designs for single-arm clinical trials with multiple outcomes.</em>
<em>Statistics in medicine</em> <strong>14.4</strong>: 357-379.
</p>
<p>Yin, G. (2012).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using vague prior Unif(0,1)
MultPostP.design(type="futility",nmax = 30,a.vec = c(1,1,1,1),p0 = 0.15, theta = 0.05)
MultPostP.design(type="efficacy",nmax = 30,a.vec = c(1,1,1,1),p0 = 0.15, theta = 0.9)
MultPostP.design(type="toxicity",nmax = 30,a.vec = c(1,1,1,1),p0 = 0.15, theta = 0.95)
</code></pre>

<hr>
<h2 id='ph2bye-package'>ph2bye: A package for Phase II single-arm Bayesian design.</h2><span id='topic+ph2bye'></span><span id='topic+ph2bye-package'></span>

<h3>Description</h3>

<p>The ph2bye package provides three categories of important functions:
PostP.design, PredP.design and MultPostP.design.
</p>


<h3>Posterior probability criterion functions</h3>

<p>The posterior probability criterion functions include PostP and PostP.design functions.
</p>


<h3>Predictive probability criterion functions</h3>

<p>The predictive probability criterion functions include PredP and PredP.design functions.
</p>


<h3>Posterior probability criterion function for multiple outcomes</h3>

<p>The posterior probability criterion functions include MultPostP and MultPostP.design functions.
</p>


<h3>Whole design function with double thresholds showing futility and efficacy boundary together</h3>

<p>The criterion function DT.design.
</p>


<h3>Prior calculation function</h3>

<p>The function prior calculating Beta prior parameters accourding different prior information.
</p>


<h3>Author(s)</h3>

<p>Yalin Zhu &lt;yalin.zhu@outlook.com&gt;
</p>

<hr>
<h2 id='PostP'>The posterior probability criterion function for Phase II single-arm design</h2><span id='topic+PostP'></span>

<h3>Description</h3>

<p>Thall and Simon's criterion function for determining the trial decision boundaries based on the posterior probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PostP(x, n, a, b, p0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PostP_+3A_x">x</code></td>
<td>
<p>the number of responses among <code class="reqn">n</code> patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="PostP_+3A_n">n</code></td>
<td>
<p>the number of patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="PostP_+3A_a">a</code></td>
<td>
<p>the hyperparameter (shape1) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="PostP_+3A_b">b</code></td>
<td>
<p>the hyperparameter (shape2) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="PostP_+3A_p0">p0</code></td>
<td>
<p>the prespecified reseponse rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prob</code></td>
<td>
<p>the posterior probability: <code class="reqn">Pr(p &gt; p_0  | X=x)</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Berry, S. M., Carlin, B. P., Lee, J. J., &amp; Muller, P. (2010).
<em>Bayesian adaptive methods for clinical trials.</em>
CRC press.
</p>
<p>Thall, P. F., Simon, R. (1994).
Practical Bayesian guidelines for phase IIB clinical trials.
<em>Biometrics</em> <strong>50</strong>: 337-349.
</p>
<p>Yin, G. (2013).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PostP(8,15,1,1,0.8)
</code></pre>

<hr>
<h2 id='PostP.design'>The stopping boundaries based on the posterior probability criterion</h2><span id='topic+PostP.design'></span>

<h3>Description</h3>

<p>The design function to sequentially monitor sample size and boundary based on Thall and Simon's criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PostP.design(type, nmax, a, b, p0, theta, optimize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PostP.design_+3A_type">type</code></td>
<td>
<p>type of boundaries: &quot;efficacy&quot; or &quot;futility&quot;.</p>
</td></tr>
<tr><td><code id="PostP.design_+3A_nmax">nmax</code></td>
<td>
<p>the maximum number of patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="PostP.design_+3A_a">a</code></td>
<td>
<p>the hyperparameter (shape1) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="PostP.design_+3A_b">b</code></td>
<td>
<p>the hyperparameter (shape2) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="PostP.design_+3A_p0">p0</code></td>
<td>
<p>the pre-specified reseponse rate.</p>
</td></tr>
<tr><td><code id="PostP.design_+3A_theta">theta</code></td>
<td>
<p>the cutoff probability: typically, <code class="reqn">\theta = [0.9, 0.99]</code> for efficacy, <code class="reqn">\theta = [0.01, 0.1]</code> for futility.</p>
</td></tr>
<tr><td><code id="PostP.design_+3A_optimize">optimize</code></td>
<td>
<p>logical value, if optimize=TRUE, then only output the minimal sample size for the same number of futility and efficacy boundaries.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>boundset</code></td>
<td>
<p>the boundaries set: <code class="reqn">U_n</code> or <code class="reqn">L_n</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Thall, P. F., Simon, R. (1994).
Practical Bayesian guidelines for phase IIB clinical trials.
<em>Biometrics</em> <strong>50</strong>: 337-349.
</p>
<p>Yin, G. (2012).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using vague prior Unif(0,1)
PostP.design(type = "futility", nmax=100, a=1, b=1, p0=0.3, theta=0.05)
PostP.design(type = "efficacy", nmax=100, a=1, b=1, p0=0.3, theta=0.9)
## Or using Jeffery prior with Beta(0.5,0.5)
PostP.design(type = "futility", nmax=100, a=0.5, b=0.5, p0=0.3, theta=0.05)
PostP.design(type = "efficacy", nmax=100, a=0.5, b=0.5, p0=0.3, theta=0.9)
</code></pre>

<hr>
<h2 id='PredP'>The predictive probability criterion function for Phase II single-arm design</h2><span id='topic+PredP'></span>

<h3>Description</h3>

<p>Lee and Liu's criterion function for determining the
trial decision cutoffs based on the predictive probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PredP(x, n, nmax, a, b, p0, theta_t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PredP_+3A_x">x</code></td>
<td>
<p>the number of responses among <code class="reqn">n</code> patients treated by the experimental drug at a certain stage of the trial.</p>
</td></tr>
<tr><td><code id="PredP_+3A_n">n</code></td>
<td>
<p>the number of patients treated by the experimental drug at a certain stage of the trial.</p>
</td></tr>
<tr><td><code id="PredP_+3A_nmax">nmax</code></td>
<td>
<p>the maximum number of patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="PredP_+3A_a">a</code></td>
<td>
<p>the hyperparameter (shape1) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="PredP_+3A_b">b</code></td>
<td>
<p>the hyperparameter (shape2) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="PredP_+3A_p0">p0</code></td>
<td>
<p>the the response rate for the standard drug.</p>
</td></tr>
<tr><td><code id="PredP_+3A_theta_t">theta_t</code></td>
<td>
<p>the cutoff probability for efficacy including future patients; typically, <code class="reqn">\theta_T = [0.85, 0.95]</code>. Set 0.9 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prob</code></td>
<td>
<p>the predictive probability: <code class="reqn">PP = \sum\limits_{y=0}^{n_{max}-n} Pr(Y=y | x) I(\Pr(p &gt; p_0 | Y=y, x) \geq \theta_T) </code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Lee, J. J., Liu, D. D. (2008).
A predictive probability design for phase II cancer clinical trials.
<em>Clinical Trials</em> <strong>5</strong>: 93-106.
</p>
<p>Yin, G. (2012).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using vague prior Uniform(0,1), i.e. Beta(1,1)
PredP(16, 23, 40, 1, 1, 0.5, 0.9)
</code></pre>

<hr>
<h2 id='PredP.design'>The stopping boundaries based on the predictive probability criterion</h2><span id='topic+PredP.design'></span>

<h3>Description</h3>

<p>The design function to sequentially monitor sample size and boundary based on Lee and Liu's criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PredP.design(type, nmax, a, b, p0, theta_t, theta, optimize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PredP.design_+3A_type">type</code></td>
<td>
<p>type of boundaries: &quot;efficacy&quot; or &quot;futility&quot;.</p>
</td></tr>
<tr><td><code id="PredP.design_+3A_nmax">nmax</code></td>
<td>
<p>the maximum number of patients treated by the experimental drug.</p>
</td></tr>
<tr><td><code id="PredP.design_+3A_a">a</code></td>
<td>
<p>the hyperparameter (shape1) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="PredP.design_+3A_b">b</code></td>
<td>
<p>the hyperparameter (shape2) of the Beta prior for the experimental drug.</p>
</td></tr>
<tr><td><code id="PredP.design_+3A_p0">p0</code></td>
<td>
<p>the the response rate for the standard drug.</p>
</td></tr>
<tr><td><code id="PredP.design_+3A_theta_t">theta_t</code></td>
<td>
<p>the cutoff probability for efficacy including future patients; typically, <code class="reqn">\theta_T = [0.85, 0.95]</code>. Set 0.9 by default.</p>
</td></tr>
<tr><td><code id="PredP.design_+3A_theta">theta</code></td>
<td>
<p>the cutoff probability: typically, <code class="reqn">\theta = [0.9, 0.99]</code> for efficacy, <code class="reqn">\theta = [0.01, 0.1]</code> for futility.</p>
</td></tr>
<tr><td><code id="PredP.design_+3A_optimize">optimize</code></td>
<td>
<p>logical value, if optimize=TRUE, then only output the minimal sample size for the same number of futility and efficacy boundaries.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>boundset</code></td>
<td>
<p>the boundaries set: <code class="reqn">U_n</code> or <code class="reqn">L_n</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Lee, J. J., Liu, D. D. (2008).
A predictive probability design for phase II cancer clinical trials.
<em>Clinical Trials</em> <strong>5</strong>: 93-106.
</p>
<p>Yin, G. (2012).
<em>Clinical Trial Design: Bayesian and Frequentist Adaptive Methods.</em>
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PredP.design(type = "futility", nmax=40, a=1, b=1, p0=0.3, theta=0.05)
PredP.design(type = "efficacy", nmax=40, a=1, b=1, p0=0.3, theta=0.9)
</code></pre>

<hr>
<h2 id='prior'>Beta priors determination based on different prior information</h2><span id='topic+prior'></span>

<h3>Description</h3>

<p>The prior function to calculate the Beta prior parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior(type, mu, v, N, W, init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prior_+3A_type">type</code></td>
<td>
<p>type of prior information: &quot;MeanVar&quot; uses mean and variance, &quot;Optimist&quot; uses (ORR) mean, &quot;ORRN&quot; uses ORR and smaple size, &quot;ORRW&quot; uses ORR and CI width.</p>
</td></tr>
<tr><td><code id="prior_+3A_mu">mu</code></td>
<td>
<p>prior(ORR) mean.</p>
</td></tr>
<tr><td><code id="prior_+3A_v">v</code></td>
<td>
<p>prior variance</p>
</td></tr>
<tr><td><code id="prior_+3A_n">N</code></td>
<td>
<p>prior sample size.</p>
</td></tr>
<tr><td><code id="prior_+3A_w">W</code></td>
<td>
<p>prior confidence interval width.</p>
</td></tr>
<tr><td><code id="prior_+3A_init">init</code></td>
<td>
<p>initial value to solve the nonlinear equations for &quot;ORRW&quot; type.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>parameters</code></td>
<td>
<p>the vector of Beta parameters: <code class="reqn">a</code> and <code class="reqn">b</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Thall, P. F., Simon, R. (1994).
Practical Bayesian guidelines for phase IIB clinical trials.
<em>Biometrics</em> <strong>50</strong>: 337-349.
</p>
<p>Mayo, M. S., &amp; Gajewski, B. J. (2004).
Bayesian sample size calculations in phase II clinical trials using informative conjugate priors.
<em>Controlled clinical trials</em> <strong>25</strong>(2): 157-167.
</p>
<p>Tan, S. B., &amp; Machin, D. (2002).
Bayesian two-stage designs for phase II clinical trials.
<em>Statistics in medicine</em> <strong>21</strong>(14): 1991-2012.
New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior(type = "MeanVar", mu=0.2, v=0.025)
prior(type = "Optimist", mu = 0.2)
prior(type = "ORRN", mu = 0.2, N = 10)
prior(type = "ORRW", mu = 0.2, W = 0.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
