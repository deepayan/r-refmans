<!DOCTYPE html><html lang="en"><head><title>Help for package penetrance</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {penetrance}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#penetrance'><p>penetrance: A Package for Penetrance Estimation</p></a></li>
<li><a href='#absValue'><p>Function to return absolute values</p></a></li>
<li><a href='#apply_burn_in'><p>Apply Burn-In</p></a></li>
<li><a href='#apply_thinning'><p>Apply Thinning</p></a></li>
<li><a href='#baseline_data_default'><p>Default Baseline Data</p></a></li>
<li><a href='#calculate_weibull_parameters'><p>Calculate Weibull Parameters</p></a></li>
<li><a href='#calculateBaseline'><p>Calculate Baseline Risk</p></a></li>
<li><a href='#calculateEmpiricalDensity'><p>Calculate Empirical Age Density</p></a></li>
<li><a href='#calculateNCPen'><p>Calculate Age-Specific Non-Carrier Penetrance</p></a></li>
<li><a href='#combine_chains'><p>Combine Chains</p>
Function to combine the posterior samples from the multiple chains.</a></li>
<li><a href='#combine_chains_noSex'><p>Combine Chains for Non-Sex-Specific Estimation</p></a></li>
<li><a href='#distribution_data_default'><p>Default Distribution Data</p></a></li>
<li><a href='#drawBaseline'><p>Draw Ages Using the Inverse CDF Method from the baseline data</p></a></li>
<li><a href='#drawEmpirical'><p>Draw Ages Using the Inverse CDF Method from Empirical Density</p></a></li>
<li><a href='#generate_density_plots'><p>Generate Posterior Density Plots</p></a></li>
<li><a href='#generate_summary'><p>Generate Summary</p></a></li>
<li><a href='#generate_summary_noSex'><p>Generate Summary for Non-Sex-Specific Estimation</p></a></li>
<li><a href='#imputeAges'><p>Impute Missing Ages in Family-Based Data</p></a></li>
<li><a href='#imputeAgesInit'><p>Initialize Age Imputation</p></a></li>
<li><a href='#imputeUnaffectedAges'><p>Impute Ages for Unaffected Individuals</p></a></li>
<li><a href='#lik_noSex'><p>Likelihood Calculation without Sex Differentiation</p></a></li>
<li><a href='#lik.fn'><p>Penetrance Function</p></a></li>
<li><a href='#makePriors'><p>Make Priors</p></a></li>
<li><a href='#mhChain'><p>Execution of a Single Chain in Metropolis-Hastings for Cancer Risk Estimation</p></a></li>
<li><a href='#mhLogLikelihood_clipp'><p>Calculate Log Likelihood using clipp Package</p></a></li>
<li><a href='#mhLogLikelihood_clipp_noSex'><p>Calculate Log Likelihood without Sex Differentiation</p></a></li>
<li><a href='#out_sim'><p>Simulated Output Data</p></a></li>
<li><a href='#plot_acf'><p>Plot Autocorrelation for Multiple MCMC Chains (Posterior Samples)</p></a></li>
<li><a href='#plot_loglikelihood'><p>Plot Log-Likelihood for Multiple MCMC Chains</p></a></li>
<li><a href='#plot_pdf'><p>Plot Weibull Probability Density Function with Credible Intervals</p></a></li>
<li><a href='#plot_penetrance'><p>Plot Weibull Distribution with Credible Intervals</p></a></li>
<li><a href='#plot_trace'><p>Plot MCMC Trace Plots</p></a></li>
<li><a href='#printRejectionRates'><p>Print MCMC Rejection Rates</p></a></li>
<li><a href='#prior_params_default'><p>Default Prior Parameters</p></a></li>
<li><a href='#risk_proportion_default'><p>Default Risk Proportions</p></a></li>
<li><a href='#simulated_families'><p>Processed Family Data</p></a></li>
<li><a href='#test_fam2'><p>Processed Family Data</p></a></li>
<li><a href='#transformDF'><p>Transform Data Frame</p></a></li>
<li><a href='#validate_weibull_parameters'><p>Validate Weibull Parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods for Penetrance Estimation in Family-Based Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>clipp, stats, parallel, MASS, kinship2 (&ge; 1.8.5), graphics,
grDevices</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements statistical methods for estimating disease penetrance in 
    family-based studies. Penetrance refers to the probability of diseaseÂ§
    manifestation in individuals carrying specific genetic variants. The package 
    provides tools for age-specific penetrance estimation, handling missing data, 
    and accounting for ascertainment bias in family studies.
    Cite as: Kubista, N., Braun, D. &amp; Parmigiani, G. (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2411.18816">doi:10.48550/arXiv.2411.18816</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nicokubi/penetrance">https://github.com/nicokubi/penetrance</a>,
<a href="https://nicokubi.github.io/penetrance/">https://nicokubi.github.io/penetrance/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, scales, ggplot2, roxygen2, testthat (&ge;
3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-26 22:15:48 UTC; nicolaskubista</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicolas Kubista [aut, cre],
  BayesMendel Lab [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicolas Kubista &lt;bmendel@jimmy.harvard.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-03 11:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='penetrance'>penetrance: A Package for Penetrance Estimation</h2><span id='topic+penetrance'></span><span id='topic+penetrance-package'></span>

<h3>Description</h3>

<p>A comprehensive package for penetrance estimation in family-based studies. This package
implements Bayesian methods using Metropolis-Hastings algorithm for estimating age-specific
penetrance of genetic variants. It supports both sex-specific and non-sex-specific analyses,
and provides various visualization tools for examining MCMC results.
</p>
<p>This function implements the Independent Metropolis-Hastings algorithm for Bayesian
penetrance estimation of cancer risk. It utilizes parallel computing to run multiple
chains and provides various options for analyzing and visualizing the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penetrance(
  pedigree,
  twins = NULL,
  n_chains = 1,
  n_iter_per_chain = 10000,
  ncores = 6,
  max_age = 94,
  baseline_data = baseline_data_default,
  remove_proband = FALSE,
  age_imputation = FALSE,
  median_max = TRUE,
  BaselineNC = TRUE,
  var = c(0.1, 0.1, 2, 2, 5, 5, 5, 5),
  burn_in = 0,
  thinning_factor = 1,
  imp_interval = 100,
  distribution_data = distribution_data_default,
  prev = 1e-04,
  sample_size = NULL,
  ratio = NULL,
  prior_params = prior_params_default,
  risk_proportion = risk_proportion_default,
  summary_stats = TRUE,
  rejection_rates = TRUE,
  density_plots = TRUE,
  plot_trace = TRUE,
  penetrance_plot = TRUE,
  penetrance_plot_pdf = TRUE,
  plot_loglikelihood = TRUE,
  plot_acf = TRUE,
  probCI = 0.95,
  sex_specific = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="penetrance_+3A_pedigree">pedigree</code></td>
<td>
<p>A data frame containing the pedigree data in the required format. It should include the following columns:
</p>

<ul>
<li> <p><code>PedigreeID</code>: A numeric value representing the unique identifier for each family. There should be no duplicated entries.
</p>
</li>
<li> <p><code>ID</code>: A numeric value representing the unique identifier for each individual. There should be no duplicated entries.
</p>
</li>
<li> <p><code>Sex</code>: A numeric value where <code>0</code> indicates female and <code>1</code> indicates male. Unknown sex needs to be coded as <code>NA</code>.
</p>
</li>
<li> <p><code>MotherID</code>: A numeric value representing the unique identifier for an individual's mother.
</p>
</li>
<li> <p><code>FatherID</code>: A numeric value representing the unique identifier for an individual's father.
</p>
</li>
<li> <p><code>isProband</code>: A numeric value where <code>1</code> indicates the individual is a proband and <code>0</code> otherwise.
</p>
</li>
<li> <p><code>CurAge</code>: A numeric value indicating the age of censoring (current age if the person is alive or age at death if the person is deceased). Allowed ages range from <code>1</code> to <code>94</code>. Unknown ages can be left empty or coded as <code>NA</code>.
</p>
</li>
<li> <p><code>isAff</code>: A numeric value indicating the affection status of cancer, with <code>1</code> for diagnosed individuals,
<code>0</code> for unaffected individuals, and <code>NA</code> for unknown status.
</p>
</li>
<li> <p><code>Age</code>: A numeric value indicating the age of cancer diagnosis, encoded as <code>NA</code> if the individual was not diagnosed. Allowed ages range from <code>1</code> to <code>94</code>. Unknown ages can be left empty or coded as <code>NA</code>.
</p>
</li>
<li> <p><code>geno</code>: A column for germline testing or tumor marker testing results. Positive results should be coded as <code>1</code>, negative results as <code>0</code>, and unknown results as <code>NA</code> or left empty.
</p>
</li></ul>
</td></tr>
<tr><td><code id="penetrance_+3A_twins">twins</code></td>
<td>
<p>A list specifying identical twins or triplets in the family. For example, to indicate that &quot;ora024&quot; and &quot;ora027&quot; are identical twins, and &quot;aey063&quot; and &quot;aey064&quot; are identical twins, use the following format: <code>twins &lt;- list(c("ora024", "ora027"), c("aey063", "aey064"))</code>.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_n_chains">n_chains</code></td>
<td>
<p>Integer, the number of chains for parallel computation. Default is 1.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_n_iter_per_chain">n_iter_per_chain</code></td>
<td>
<p>Integer, the number of iterations for each chain. Default is 10000.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_ncores">ncores</code></td>
<td>
<p>Integer, the number of cores for parallel computation. Default is 6.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_max_age">max_age</code></td>
<td>
<p>Integer, the maximum age considered for analysis. Default is 94.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_baseline_data">baseline_data</code></td>
<td>
<p>Data for the baseline risk estimates (probability of developing cancer), such as population-level risk from a cancer registry. Default data, for exemplary purposes, is for Colorectal cancer from the SEER database.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_remove_proband">remove_proband</code></td>
<td>
<p>Logical, indicating whether to remove probands from the analysis. Default is FALSE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_age_imputation">age_imputation</code></td>
<td>
<p>Logical, indicating whether to perform age imputation. Default is FALSE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_median_max">median_max</code></td>
<td>
<p>Logical, indicating whether to use the baseline median age or <code>max_age</code> as an upper bound for the median proposal. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_baselinenc">BaselineNC</code></td>
<td>
<p>Logical, indicating that the non-carrier penetrance is assumed to be the baseline penetrance. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_var">var</code></td>
<td>
<p>Numeric vector, variances for the proposal distribution in the Metropolis-Hastings algorithm. Default is <code>c(0.1, 0.1, 2, 2, 5, 5, 5, 5)</code>.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_burn_in">burn_in</code></td>
<td>
<p>Numeric, the fraction of results to discard as burn-in (0 to 1). Default is 0 (no burn-in).</p>
</td></tr>
<tr><td><code id="penetrance_+3A_thinning_factor">thinning_factor</code></td>
<td>
<p>Integer, the factor by which to thin the results. Default is 1 (no thinning).</p>
</td></tr>
<tr><td><code id="penetrance_+3A_imp_interval">imp_interval</code></td>
<td>
<p>Integer, the interval at which age imputation should be performed when age_imputation = TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_distribution_data">distribution_data</code></td>
<td>
<p>Data for generating prior distributions.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_prev">prev</code></td>
<td>
<p>Numeric, prevalence of the carrier status. Default is 0.0001.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_sample_size">sample_size</code></td>
<td>
<p>Optional numeric, sample size for distribution generation.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_ratio">ratio</code></td>
<td>
<p>Optional numeric, ratio parameter for distribution generation.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_prior_params">prior_params</code></td>
<td>
<p>List, parameters for prior distributions.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_risk_proportion">risk_proportion</code></td>
<td>
<p>Numeric, proportion of risk for distribution generation.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_summary_stats">summary_stats</code></td>
<td>
<p>Logical, indicating whether to include summary statistics in the output. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_rejection_rates">rejection_rates</code></td>
<td>
<p>Logical, indicating whether to include rejection rates in the output. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_density_plots">density_plots</code></td>
<td>
<p>Logical, indicating whether to include density plots in the output. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_plot_trace">plot_trace</code></td>
<td>
<p>Logical, indicating whether to include trace plots in the output. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_penetrance_plot">penetrance_plot</code></td>
<td>
<p>Logical, indicating whether to include penetrance plots in the output. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_penetrance_plot_pdf">penetrance_plot_pdf</code></td>
<td>
<p>Logical, indicating whether to include PDF plots in the output. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_plot_loglikelihood">plot_loglikelihood</code></td>
<td>
<p>Logical, indicating whether to include log-likelihood plots in the output. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_plot_acf">plot_acf</code></td>
<td>
<p>Logical, indicating whether to include autocorrelation function (ACF) plots for posterior samples. Default is TRUE.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_probci">probCI</code></td>
<td>
<p>Numeric, probability level for credible intervals in penetrance plots. Must be between 0 and 1. Default is 0.95.</p>
</td></tr>
<tr><td><code id="penetrance_+3A_sex_specific">sex_specific</code></td>
<td>
<p>Logical, indicating whether to use sex-specific parameters in the analysis. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Key features:
</p>

<ul>
<li><p> Bayesian estimation of penetrance using family-based data
</p>
</li>
<li><p> Support for sex-specific and non-sex-specific analyses
</p>
</li>
<li><p> Age imputation for missing data
</p>
</li>
<li><p> Visualization tools for MCMC diagnostics
</p>
</li>
<li><p> Integration with the clipp package for likelihood calculations
</p>
</li></ul>



<h3>Value</h3>

<p>A list containing combined results from all chains, including optional statistics and plots.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Nicolas Kubista <a href="mailto:bmendel@jimmy.harvard.edu">bmendel@jimmy.harvard.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> BayesMendel Lab
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/nicokubi/penetrance">https://github.com/nicokubi/penetrance</a>
</p>
</li>
<li> <p><a href="https://nicokubi.github.io/penetrance/">https://nicokubi.github.io/penetrance/</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Create example baseline data (simplified for demonstration)
baseline_data_default &lt;- data.frame(
  Age = 1:94,
  Female = rep(0.01, 94),
  Male = rep(0.01, 94)
)

# Create example distribution data
distribution_data_default &lt;- data.frame(
  Age = 1:94,
  Risk = rep(0.01, 94)
)

# Create example prior parameters
prior_params_default &lt;- list(
  shape = 2,
  scale = 50
)

# Create example risk proportion
risk_proportion_default &lt;- 0.5

# Create a simple example pedigree
example_pedigree &lt;- data.frame(
  PedigreeID = rep(1, 4),
  ID = 1:4,
  Sex = c(1, 0, 1, 0),  # 1 for male, 0 for female
  MotherID = c(NA, NA, 2, 2),
  FatherID = c(NA, NA, 1, 1),
  isProband = c(0, 0, 1, 0),
  CurAge = c(70, 68, 45, 42),
  isAff = c(0, 0, 1, 0),
  Age = c(NA, NA, 40, NA),
  geno = c(NA, NA, 1, NA)
)

# Basic usage with minimal iterations
result &lt;- penetrance(
  pedigree = list(example_pedigree),
  n_chains = 1,
  n_iter_per_chain = 10,  # Very small number for example
  ncores = 1,             # Single core for example
  summary_stats = TRUE,
  plot_trace = FALSE,     # Disable plots for quick example
  density_plots = FALSE,
  penetrance_plot = FALSE,
  penetrance_plot_pdf = FALSE,
  plot_loglikelihood = FALSE,
  plot_acf = FALSE
)

# View basic results
head(result$summary_stats)

</code></pre>

<hr>
<h2 id='absValue'>Function to return absolute values</h2><span id='topic+absValue'></span>

<h3>Description</h3>

<p>Function to return absolute values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>absValue(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="absValue_+3A_x">x</code></td>
<td>
<p>Numeric, the input value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric, the absolute value of the input.
</p>

<hr>
<h2 id='apply_burn_in'>Apply Burn-In</h2><span id='topic+apply_burn_in'></span>

<h3>Description</h3>

<p>Apply Burn-In
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_burn_in(results, burn_in)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply_burn_in_+3A_results">results</code></td>
<td>
<p>A list of MCMC chain results.</p>
</td></tr>
<tr><td><code id="apply_burn_in_+3A_burn_in">burn_in</code></td>
<td>
<p>The fraction roportion of results to discard as burn-in (0 to 1). The default is no burn-in, burn_in=0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results with burn-in applied.
</p>

<hr>
<h2 id='apply_thinning'>Apply Thinning</h2><span id='topic+apply_thinning'></span>

<h3>Description</h3>

<p>Apply Thinning
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_thinning(results, thinning_factor)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply_thinning_+3A_results">results</code></td>
<td>
<p>A list of MCMC chain results.</p>
</td></tr>
<tr><td><code id="apply_thinning_+3A_thinning_factor">thinning_factor</code></td>
<td>
<p>The factor by which to thin the results (positive integer). The default thinning factor is 1, which implies no thinning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results with thinning applied.
</p>

<hr>
<h2 id='baseline_data_default'>Default Baseline Data</h2><span id='topic+baseline_data_default'></span>

<h3>Description</h3>

<p>This dataset contains age-specific cancer penetrance rates for both females and males.
As an example, the data is derived from the SEER program for colorectal cancer females and males.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baseline_data_default

baseline_data_default
</code></pre>


<h3>Format</h3>

<p>A data frame with 94 rows and 3 variables:
</p>

<dl>
<dt>Age</dt><dd><p>Age in years</p>
</dd>
<dt>Female</dt><dd><p>Female baseline risk</p>
</dd>
<dt>Male</dt><dd><p>Male baseline risk</p>
</dd>
</dl>

<p>A data frame with 94 rows and 3 variables:
</p>

<dl>
<dt>Age</dt><dd><p>Age in years (1 to 94)</p>
</dd>
<dt>Female</dt><dd><p>Penetrance rate for females</p>
</dd>
<dt>Male</dt><dd><p>Penetrance rate for males</p>
</dd>
</dl>


<hr>
<h2 id='calculate_weibull_parameters'>Calculate Weibull Parameters</h2><span id='topic+calculate_weibull_parameters'></span>

<h3>Description</h3>

<p>This function calculates the shape (<code>alpha</code>) and scale (<code>beta</code>) parameters
of a Weibull distribution given the median, first quartile, and delta values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_weibull_parameters(given_median, given_first_quartile, delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_weibull_parameters_+3A_given_median">given_median</code></td>
<td>
<p>The median of the data.</p>
</td></tr>
<tr><td><code id="calculate_weibull_parameters_+3A_given_first_quartile">given_first_quartile</code></td>
<td>
<p>The first quartile of the data.</p>
</td></tr>
<tr><td><code id="calculate_weibull_parameters_+3A_delta">delta</code></td>
<td>
<p>A constant offset value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the calculated Weibull parameters:
</p>
<table role = "presentation">
<tr><td><code>alpha</code></td>
<td>
<p>The shape parameter of the Weibull distribution</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The scale parameter of the Weibull distribution</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate Weibull parameters
params &lt;- calculate_weibull_parameters(
  given_median = 50,
  given_first_quartile = 30,
  delta = 15
)
print(params)
</code></pre>

<hr>
<h2 id='calculateBaseline'>Calculate Baseline Risk</h2><span id='topic+calculateBaseline'></span>

<h3>Description</h3>

<p>This function extracts the penetrance data for a specified cancer type, gene, race, and penetrance type
from the provided database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateBaseline(cancer_type, gene, race, type, db)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateBaseline_+3A_cancer_type">cancer_type</code></td>
<td>
<p>The type of cancer for which the risk is being calculated.</p>
</td></tr>
<tr><td><code id="calculateBaseline_+3A_gene">gene</code></td>
<td>
<p>The gene of interest for which the risk is being calculated.</p>
</td></tr>
<tr><td><code id="calculateBaseline_+3A_race">race</code></td>
<td>
<p>The race of the individual.</p>
</td></tr>
<tr><td><code id="calculateBaseline_+3A_type">type</code></td>
<td>
<p>The type of penetrance calculation.</p>
</td></tr>
<tr><td><code id="calculateBaseline_+3A_db">db</code></td>
<td>
<p>The dataset used for the calculation, containing penetrance data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of penetrance data for the specified parameters.
</p>

<hr>
<h2 id='calculateEmpiricalDensity'>Calculate Empirical Age Density</h2><span id='topic+calculateEmpiricalDensity'></span>

<h3>Description</h3>

<p>Calculates empirical age density distributions for different subgroups in the data,
separated by sex and genetic testing status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateEmpiricalDensity(
  data,
  aff_column = "aff",
  age_column = "age",
  sex_column = "sex",
  geno_column = "geno",
  n_points = 10000,
  sex_specific = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateEmpiricalDensity_+3A_data">data</code></td>
<td>
<p>A data frame containing the family data</p>
</td></tr>
<tr><td><code id="calculateEmpiricalDensity_+3A_aff_column">aff_column</code></td>
<td>
<p>Name of the affection status column</p>
</td></tr>
<tr><td><code id="calculateEmpiricalDensity_+3A_age_column">age_column</code></td>
<td>
<p>Name of the age column</p>
</td></tr>
<tr><td><code id="calculateEmpiricalDensity_+3A_sex_column">sex_column</code></td>
<td>
<p>Name of the sex column</p>
</td></tr>
<tr><td><code id="calculateEmpiricalDensity_+3A_geno_column">geno_column</code></td>
<td>
<p>Name of the genotype column</p>
</td></tr>
<tr><td><code id="calculateEmpiricalDensity_+3A_n_points">n_points</code></td>
<td>
<p>Number of points to use in density estimation</p>
</td></tr>
<tr><td><code id="calculateEmpiricalDensity_+3A_sex_specific">sex_specific</code></td>
<td>
<p>Logical; whether to calculate sex-specific densities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of density objects for different subgroups (tested/untested, male/female)
</p>

<hr>
<h2 id='calculateNCPen'>Calculate Age-Specific Non-Carrier Penetrance</h2><span id='topic+calculateNCPen'></span>

<h3>Description</h3>

<p>This function calculates the age-specific non-carrier penetrance based on SEER baseline
data, penetrances for carriers, and allele frequencies. It adjusts penetrance estimates
for genetic testing by incorporating the genetic risk attributable to specified alleles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateNCPen(SEER_baseline, alpha, beta, delta, gamma, prev, max_age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateNCPen_+3A_seer_baseline">SEER_baseline</code></td>
<td>
<p>Numeric, the baseline penetrance derived from SEER data for the general population without considering genetic risk factors.</p>
</td></tr>
<tr><td><code id="calculateNCPen_+3A_alpha">alpha</code></td>
<td>
<p>Numeric, shape parameter for the Weibull distribution used to model carrier risk.</p>
</td></tr>
<tr><td><code id="calculateNCPen_+3A_beta">beta</code></td>
<td>
<p>Numeric, scale parameter for the Weibull distribution used to model carrier risk.</p>
</td></tr>
<tr><td><code id="calculateNCPen_+3A_delta">delta</code></td>
<td>
<p>Numeric, location parameter for the Weibull distribution used to model carrier risk.</p>
</td></tr>
<tr><td><code id="calculateNCPen_+3A_gamma">gamma</code></td>
<td>
<p>Numeric, scaling factor applied to the Weibull distribution to adjust carrier risk.</p>
</td></tr>
<tr><td><code id="calculateNCPen_+3A_prev">prev</code></td>
<td>
<p>Numeric, the prevalence of the risk allele in the population.</p>
</td></tr>
<tr><td><code id="calculateNCPen_+3A_max_age">max_age</code></td>
<td>
<p>Integer, the maximum age up to which the calculations are performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>weightedCarrierRisk</code></td>
<td>
<p>Numeric vector, the weighted risk for carriers at each age based on prevalence.</p>
</td></tr>
<tr><td><code>yearlyProb</code></td>
<td>
<p>Numeric vector, the yearly probability of not getting the disease at each age.</p>
</td></tr>
<tr><td><code>cumulativeProb</code></td>
<td>
<p>Numeric vector, the cumulative probability of not getting the disease up to each age.</p>
</td></tr>
</table>

<hr>
<h2 id='combine_chains'>Combine Chains
Function to combine the posterior samples from the multiple chains.</h2><span id='topic+combine_chains'></span>

<h3>Description</h3>

<p>Combine Chains
Function to combine the posterior samples from the multiple chains.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_chains(results)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine_chains_+3A_results">results</code></td>
<td>
<p>A list of MCMC chain results.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with combined results, including median, threshold, first quartile, and asymptote values.
</p>

<hr>
<h2 id='combine_chains_noSex'>Combine Chains for Non-Sex-Specific Estimation</h2><span id='topic+combine_chains_noSex'></span>

<h3>Description</h3>

<p>Combines the posterior samples from multiple MCMC chains for non-sex-specific estimations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_chains_noSex(results)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine_chains_noSex_+3A_results">results</code></td>
<td>
<p>A list of MCMC chain results, where each element contains posterior samples of parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with combined results, including samples for median, threshold, first quartile, asymptote values,
log-likelihoods, and log-acceptance ratios.
</p>

<hr>
<h2 id='distribution_data_default'>Default Distribution Data</h2><span id='topic+distribution_data_default'></span>

<h3>Description</h3>

<p>Default data frame structure with row names for use in the <code>makePriors</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distribution_data_default

distribution_data_default
</code></pre>


<h3>Format</h3>

<p>A data frame for prior distribution parameters
</p>
<p>A data frame with the following columns:
</p>

<dl>
<dt>age</dt><dd><p>Age values (NA for default).</p>
</dd>
<dt>at_risk</dt><dd><p>Proportion of people at risk (NA for default).</p>
</dd>
</dl>


<hr>
<h2 id='drawBaseline'>Draw Ages Using the Inverse CDF Method from the baseline data</h2><span id='topic+drawBaseline'></span>

<h3>Description</h3>

<p>This function draws ages using the inverse CDF method from baseline data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawBaseline(baseline_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="drawBaseline_+3A_baseline_data">baseline_data</code></td>
<td>
<p>A data frame containing baseline data with columns 'cum_prob' and 'age'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single age value drawn from the baseline data.
</p>

<hr>
<h2 id='drawEmpirical'>Draw Ages Using the Inverse CDF Method from Empirical Density</h2><span id='topic+drawEmpirical'></span>

<h3>Description</h3>

<p>This function draws ages using the inverse CDF method from empirical density data,
based on sex and whether the individual was tested.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawEmpirical(empirical_density, sex, tested, sex_specific = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="drawEmpirical_+3A_empirical_density">empirical_density</code></td>
<td>
<p>A list of density objects containing the empirical density of ages for different groups.</p>
</td></tr>
<tr><td><code id="drawEmpirical_+3A_sex">sex</code></td>
<td>
<p>Numeric, the sex of the individual (1 for male, 2 for female).</p>
</td></tr>
<tr><td><code id="drawEmpirical_+3A_tested">tested</code></td>
<td>
<p>Logical, indicating whether the individual was tested (has a non-NA 'geno' value).</p>
</td></tr>
<tr><td><code id="drawEmpirical_+3A_sex_specific">sex_specific</code></td>
<td>
<p>Logical, indicating whether the imputation should be sex-specific. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single age value drawn from the appropriate empirical density data.
</p>

<hr>
<h2 id='generate_density_plots'>Generate Posterior Density Plots</h2><span id='topic+generate_density_plots'></span>

<h3>Description</h3>

<p>Generates histograms of the posterior samples for the different parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_density_plots(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_density_plots_+3A_data">data</code></td>
<td>
<p>A list with combined results.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects. Creates density plots for each parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create example data
data &lt;- list(
  median_male_results = rnorm(1000, 50, 5),
  median_female_results = rnorm(1000, 45, 5),
  threshold_male_results = runif(1000, 20, 30),
  threshold_female_results = runif(1000, 25, 35),
  asymptote_male_results = rbeta(1000, 2, 2),
  asymptote_female_results = rbeta(1000, 2, 2)
)

# Generate density plots
old_par &lt;- par(no.readonly = TRUE)  # Save old par settings
generate_density_plots(data)
par(old_par)  # Restore old par settings
</code></pre>

<hr>
<h2 id='generate_summary'>Generate Summary</h2><span id='topic+generate_summary'></span>

<h3>Description</h3>

<p>Function to generate summary statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_summary(data, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_summary_+3A_data">data</code></td>
<td>
<p>A list with combined results.</p>
</td></tr>
<tr><td><code id="generate_summary_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to print summary to console. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame containing summary statistics (min, 1st quartile, median, mean, 3rd quartile, max)
for each parameter.
</p>

<hr>
<h2 id='generate_summary_noSex'>Generate Summary for Non-Sex-Specific Estimation</h2><span id='topic+generate_summary_noSex'></span>

<h3>Description</h3>

<p>Generates summary statistics for the combined MCMC results for non-sex-specific estimations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_summary_noSex(data, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_summary_noSex_+3A_data">data</code></td>
<td>
<p>A list containing combined results of MCMC chains, typically the output of <code>combine_chains_noSex</code>.</p>
</td></tr>
<tr><td><code id="generate_summary_noSex_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to print summary to console. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame containing summary statistics (min, 1st quartile, median, mean, 3rd quartile, max)
for median, threshold, first quartile, and asymptote values.
</p>

<hr>
<h2 id='imputeAges'>Impute Missing Ages in Family-Based Data</h2><span id='topic+imputeAges'></span>

<h3>Description</h3>

<p>Imputes missing ages in family-based data using a combination of Weibull distributions
for affected individuals and empirical distributions for unaffected individuals.
The function can perform both sex-specific and non-sex-specific imputations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imputeAges(
  data,
  na_indices,
  baseline_male = NULL,
  baseline_female = NULL,
  alpha_male = NULL,
  beta_male = NULL,
  delta_male = NULL,
  alpha_female = NULL,
  beta_female = NULL,
  delta_female = NULL,
  baseline = NULL,
  alpha = NULL,
  beta = NULL,
  delta = NULL,
  max_age,
  sex_specific = TRUE,
  max_attempts = 100,
  geno_freq,
  trans,
  lik
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imputeAges_+3A_data">data</code></td>
<td>
<p>A data frame containing family-based data with columns: family, individual,
father, mother, sex, aff, age, geno, and isProband</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_na_indices">na_indices</code></td>
<td>
<p>Vector of indices where ages need to be imputed</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_baseline_male">baseline_male</code>, <code id="imputeAges_+3A_baseline_female">baseline_female</code></td>
<td>
<p>Data frames containing baseline age distributions for males/females</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_alpha_male">alpha_male</code>, <code id="imputeAges_+3A_alpha_female">alpha_female</code></td>
<td>
<p>Shape parameters for male/female Weibull distributions</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_beta_male">beta_male</code>, <code id="imputeAges_+3A_beta_female">beta_female</code></td>
<td>
<p>Scale parameters for male/female Weibull distributions</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_delta_male">delta_male</code>, <code id="imputeAges_+3A_delta_female">delta_female</code></td>
<td>
<p>Location parameters for male/female Weibull distributions</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_baseline">baseline</code></td>
<td>
<p>Data frame containing overall baseline age distribution (non-sex-specific)</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_alpha">alpha</code>, <code id="imputeAges_+3A_beta">beta</code>, <code id="imputeAges_+3A_delta">delta</code></td>
<td>
<p>Overall Weibull parameters (non-sex-specific)</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_max_age">max_age</code></td>
<td>
<p>Maximum allowable age</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_sex_specific">sex_specific</code></td>
<td>
<p>Logical; whether to use sex-specific parameters</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_max_attempts">max_attempts</code></td>
<td>
<p>Maximum number of attempts for generating valid ages</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_geno_freq">geno_freq</code></td>
<td>
<p>Vector of genotype frequencies</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_trans">trans</code></td>
<td>
<p>Transmission probabilities</p>
</td></tr>
<tr><td><code id="imputeAges_+3A_lik">lik</code></td>
<td>
<p>Likelihood matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following modifications:
</p>
<table role = "presentation">
<tr><td><code>age</code></td>
<td>
<p>Updated with imputed ages for previously missing values</p>
</td></tr>
</table>
<p>The rest of the data frame remains unchanged.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create sample data with the same structure as used in mhChain
data &lt;- data.frame(
  family = rep(1:2, each=5),
  individual = rep(1:5, 2),
  father = c(NA,1,1,1,1, NA,6,6,6,6),
  mother = c(NA,2,2,2,2, NA,7,7,7,7),
  sex = c(1,2,1,2,1, 1,2,1,2,1),
  aff = c(1,0,1,0,NA, 1,0,1,0,NA),
  age = c(45,NA,25,NA,20, 50,NA,30,NA,22),
  geno = c("1/2",NA,"1/2",NA,NA, "1/2",NA,"1/2",NA,NA),
  isProband = c(1,0,0,0,0, 1,0,0,0,0)
)

# Initialize parameters
na_indices &lt;- which(is.na(data$age))
geno_freq &lt;- c(0.999, 0.001)  # Frequency of normal and risk alleles
trans &lt;- matrix(c(1,0,0.5,0.5), nrow=2)  # Transmission matrix
lik &lt;- matrix(1, nrow=nrow(data), ncol=2)  # Likelihood matrix

# Create baseline data for both sex-specific and non-sex-specific cases
age_range &lt;- 20:94
n_ages &lt;- length(age_range)

# Sex-specific baseline data
baseline_male &lt;- data.frame(
  age = age_range,
  cum_prob = (1:n_ages)/n_ages * 0.8  # Male cumulative probabilities
)

baseline_female &lt;- data.frame(
  age = age_range,
  cum_prob = (1:n_ages)/n_ages * 0.9  # Female cumulative probabilities
)

# Non-sex-specific baseline data
baseline &lt;- data.frame(
  age = age_range,
  cum_prob = (1:n_ages)/n_ages * 0.85  # Overall cumulative probabilities
)

# Example with sex-specific imputation
imputed_data_sex &lt;- imputeAges(
  data = data,
  na_indices = na_indices,
  baseline_male = baseline_male,
  baseline_female = baseline_female,
  alpha_male = 3.5,
  beta_male = 20,
  delta_male = 20,
  alpha_female = 3.2,
  beta_female = 18,
  delta_female = 18,
  max_age = 94,
  sex_specific = TRUE,
  geno_freq = geno_freq,
  trans = trans,
  lik = lik
)

# Example with non-sex-specific imputation
imputed_data_nosex &lt;- imputeAges(
  data = data,
  na_indices = na_indices,
  baseline = baseline,
  alpha = 3.3,
  beta = 19,
  delta = 19,
  max_age = 94,
  sex_specific = FALSE,
  geno_freq = geno_freq,
  trans = trans,
  lik = lik
)
</code></pre>

<hr>
<h2 id='imputeAgesInit'>Initialize Age Imputation</h2><span id='topic+imputeAgesInit'></span>

<h3>Description</h3>

<p>Initializes the age imputation process by filling missing ages with random values
between a threshold and maximum age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imputeAgesInit(data, threshold, max_age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imputeAgesInit_+3A_data">data</code></td>
<td>
<p>A data frame containing family-based data</p>
</td></tr>
<tr><td><code id="imputeAgesInit_+3A_threshold">threshold</code></td>
<td>
<p>Minimum age value for initialization</p>
</td></tr>
<tr><td><code id="imputeAgesInit_+3A_max_age">max_age</code></td>
<td>
<p>Maximum age value for initialization</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>The data frame with initialized ages</p>
</td></tr>
<tr><td><code>na_indices</code></td>
<td>
<p>Indices of missing age values</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Create sample data
data &lt;- data.frame(
  family = c(1, 1),
  individual = c(1, 2),
  father = c(NA, 1),
  mother = c(NA, NA),
  sex = c(1, 2),
  aff = c(1, 0),
  age = c(NA, NA),
  geno = c("1/2", NA),
  isProband = c(1, 0)
)

# Initialize ages with random values between 20 and 94
result &lt;- imputeAgesInit(data, threshold = 20, max_age = 94)

# Access the results
imputed_data &lt;- result$data
missing_indices &lt;- result$na_indices
</code></pre>

<hr>
<h2 id='imputeUnaffectedAges'>Impute Ages for Unaffected Individuals</h2><span id='topic+imputeUnaffectedAges'></span>

<h3>Description</h3>

<p>This function imputes ages for unaffected individuals in a dataset based on their sex
and whether they were tested, using empirical age distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imputeUnaffectedAges(data, na_indices, empirical_density, max_age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imputeUnaffectedAges_+3A_data">data</code></td>
<td>
<p>A data frame containing the individual data, including columns for age, sex, and geno.</p>
</td></tr>
<tr><td><code id="imputeUnaffectedAges_+3A_na_indices">na_indices</code></td>
<td>
<p>A vector of indices indicating the rows in the data where ages need to be imputed.</p>
</td></tr>
<tr><td><code id="imputeUnaffectedAges_+3A_empirical_density">empirical_density</code></td>
<td>
<p>A list of density objects containing the empirical density of ages for different groups.</p>
</td></tr>
<tr><td><code id="imputeUnaffectedAges_+3A_max_age">max_age</code></td>
<td>
<p>Integer, the maximum age considered in the analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The data frame with imputed ages for unaffected individuals.
</p>

<hr>
<h2 id='lik_noSex'>Likelihood Calculation without Sex Differentiation</h2><span id='topic+lik_noSex'></span>

<h3>Description</h3>

<p>This function calculates the likelihood for an individual based on Weibull distribution parameters without considering sex differentiation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik_noSex(
  i,
  data,
  alpha,
  beta,
  delta,
  gamma,
  max_age,
  baselineRisk,
  BaselineNC,
  prev
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lik_noSex_+3A_i">i</code></td>
<td>
<p>Integer, index of the individual in the data set.</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_data">data</code></td>
<td>
<p>Data frame, containing individual demographic and genetic information. Must include columns for 'age', 'aff' (affection status), and 'geno' (genotype).</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_alpha">alpha</code></td>
<td>
<p>Numeric, Weibull distribution shape parameter.</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_beta">beta</code></td>
<td>
<p>Numeric, Weibull distribution scale parameter.</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_delta">delta</code></td>
<td>
<p>Numeric, shift parameter for the Weibull function.</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_gamma">gamma</code></td>
<td>
<p>Numeric, asymptote parameter (only scales the entire distribution).</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_max_age">max_age</code></td>
<td>
<p>Integer, maximum age considered in the analysis.</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_baselinerisk">baselineRisk</code></td>
<td>
<p>Numeric vector, baseline risk for each age.</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_baselinenc">BaselineNC</code></td>
<td>
<p>Logical, indicates if non-carrier penetrance should be based on SEER data or the calculated non-carrier penetrance.</p>
</td></tr>
<tr><td><code id="lik_noSex_+3A_prev">prev</code></td>
<td>
<p>Numeric, prevalence of the risk allele in the population.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector, containing likelihood values for unaffected and affected individuals.
</p>

<hr>
<h2 id='lik.fn'>Penetrance Function</h2><span id='topic+lik.fn'></span>

<h3>Description</h3>

<p>Calculates the penetrance for an individual based on Weibull distribution parameters.
This function estimates the probability of developing cancer given the individual's genetic and demographic information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik.fn(
  i,
  data,
  alpha_male,
  alpha_female,
  beta_male,
  beta_female,
  delta_male,
  delta_female,
  gamma_male,
  gamma_female,
  max_age,
  baselineRisk,
  BaselineNC,
  prev
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lik.fn_+3A_i">i</code></td>
<td>
<p>Integer, index of the individual in the data set.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_data">data</code></td>
<td>
<p>Data frame, containing individual demographic and genetic information. Must include columns for 'sex', 'age', 'aff' (affection status), and 'geno' (genotype).</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_alpha_male">alpha_male</code></td>
<td>
<p>Numeric, Weibull distribution shape parameter for males.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_alpha_female">alpha_female</code></td>
<td>
<p>Numeric, Weibull distribution shape parameter for females.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_beta_male">beta_male</code></td>
<td>
<p>Numeric, Weibull distribution scale parameter for males.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_beta_female">beta_female</code></td>
<td>
<p>Numeric, Weibull distribution scale parameter for females.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_delta_male">delta_male</code></td>
<td>
<p>Numeric, shift parameter for the Weibull function for males.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_delta_female">delta_female</code></td>
<td>
<p>Numeric, shift parameter for the Weibull function for females.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_gamma_male">gamma_male</code></td>
<td>
<p>Numeric, asymptote parameter for males (only scales the entire distribution).</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_gamma_female">gamma_female</code></td>
<td>
<p>Numeric, asymptote parameter for females (only scales the entire distribution).</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_max_age">max_age</code></td>
<td>
<p>Integer, maximum age considered in the analysis.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_baselinerisk">baselineRisk</code></td>
<td>
<p>Numeric matrix, baseline risk for each age by sex. Rows correspond to sex (1 for male, 2 for female) and columns to age.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_baselinenc">BaselineNC</code></td>
<td>
<p>Logical, indicates if non-carrier penetrance should be based on SEER data.</p>
</td></tr>
<tr><td><code id="lik.fn_+3A_prev">prev</code></td>
<td>
<p>Numeric, prevalence of the risk allele in the population.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector, containing penetrance values for unaffected and affected individuals.
</p>

<hr>
<h2 id='makePriors'>Make Priors</h2><span id='topic+makePriors'></span>

<h3>Description</h3>

<p>This function generates prior distributions based on user input or default parameters.
It is designed to aid in the statistical analysis of risk proportions in populations, particularly in the context of cancer research.
The distributions are calculated for various statistical metrics such as asymptote, threshold, median, and first quartile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makePriors(
  data,
  sample_size,
  ratio,
  prior_params,
  risk_proportion,
  baseline_data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makePriors_+3A_data">data</code></td>
<td>
<p>A data frame containing age and risk data. If NULL or contains NA values, default parameters are used.</p>
</td></tr>
<tr><td><code id="makePriors_+3A_sample_size">sample_size</code></td>
<td>
<p>Numeric, the total sample size used for risk proportion calculations.</p>
</td></tr>
<tr><td><code id="makePriors_+3A_ratio">ratio</code></td>
<td>
<p>Numeric, the odds ratio (OR) or relative risk (RR) used in asymptote parameter calculations.</p>
</td></tr>
<tr><td><code id="makePriors_+3A_prior_params">prior_params</code></td>
<td>
<p>List, containing prior parameters for the beta distributions. If NULL, default parameters are used.</p>
</td></tr>
<tr><td><code id="makePriors_+3A_risk_proportion">risk_proportion</code></td>
<td>
<p>Data frame, with default proportions of people at risk.</p>
</td></tr>
<tr><td><code id="makePriors_+3A_baseline_data">baseline_data</code></td>
<td>
<p>Data frame with the baseline risk data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function includes internal helper functions for normalizing median and first quartile values, and for computing beta distribution parameters.
The function handles various settings: using default parameters, applying user inputs, and calculating parameters based on sample size and risk proportions.
</p>
<p>If the OR/RR ratio is provided, the asymptote parameters are computed based on this ratio, overriding other inputs for the asymptote.
</p>
<p>The function returns a list of distribution functions for the asymptote, threshold, median, and first quartile, which can be used for further statistical analysis.
</p>


<h3>Value</h3>

<p>A list of functions representing the prior distributions for asymptote, threshold, median, and first quartile.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+qbeta">qbeta</a></code>, <code><a href="stats.html#topic+runif">runif</a></code>
</p>

<hr>
<h2 id='mhChain'>Execution of a Single Chain in Metropolis-Hastings for Cancer Risk Estimation</h2><span id='topic+mhChain'></span>

<h3>Description</h3>

<p>Performs a single chain execution in the Metropolis-Hastings algorithm for Bayesian inference,
specifically tailored for cancer risk estimation. This function can handle both sex-specific and
non-sex-specific scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mhChain(
  seed,
  n_iter,
  burn_in,
  chain_id,
  ncores,
  data,
  twins,
  max_age,
  baseline_data,
  prior_distributions,
  prev,
  median_max,
  BaselineNC,
  var,
  age_imputation,
  imp_interval,
  remove_proband,
  sex_specific
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mhChain_+3A_seed">seed</code></td>
<td>
<p>Integer, the seed for the random number generator to ensure reproducibility.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_n_iter">n_iter</code></td>
<td>
<p>Integer, the number of iterations to perform in the Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_burn_in">burn_in</code></td>
<td>
<p>Integer, the number of initial iterations to discard (burn-in period).</p>
</td></tr>
<tr><td><code id="mhChain_+3A_chain_id">chain_id</code></td>
<td>
<p>Integer, the identifier for the chain being executed.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_ncores">ncores</code></td>
<td>
<p>Integer, the number of cores to use for parallel computation.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_data">data</code></td>
<td>
<p>Data frame, containing family and genetic information used in the analysis.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_twins">twins</code></td>
<td>
<p>Information on monozygous twins or triplets in the pedigrees.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_max_age">max_age</code></td>
<td>
<p>Integer, the maximum age considered in the analysis.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_baseline_data">baseline_data</code></td>
<td>
<p>Numeric matrix or vector, containing baseline risk estimates for different ages and sexes.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_prior_distributions">prior_distributions</code></td>
<td>
<p>List, containing prior distributions for the parameters being estimated.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_prev">prev</code></td>
<td>
<p>Numeric, the prevalence of the risk allele in the population.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_median_max">median_max</code></td>
<td>
<p>Logical, indicates if the maximum median age should be used for the Weibull distribution.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_baselinenc">BaselineNC</code></td>
<td>
<p>Logical, indicates if non-carrier penetrance should be based on SEER data.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_var">var</code></td>
<td>
<p>Numeric, the variance for the proposal distribution in the Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_age_imputation">age_imputation</code></td>
<td>
<p>Logical, indicates if age imputation should be performed.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_imp_interval">imp_interval</code></td>
<td>
<p>Integer, the interval at which age imputation should be performed when age_imputation = TRUE.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_remove_proband">remove_proband</code></td>
<td>
<p>Logical, indicates if the proband should be removed from the analysis.</p>
</td></tr>
<tr><td><code id="mhChain_+3A_sex_specific">sex_specific</code></td>
<td>
<p>Logical, indicates if the analysis should differentiate by sex.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing samples, log likelihoods, log-acceptance ratio, and rejection rate for each iteration.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create sample data in PanelPRO format
data &lt;- data.frame(
  ID = 1:10,
  PedigreeID = rep(1, 10),
  Sex = c(0, 1, 0, 1, 0, 1, 0, 1, 0, 1),  # 0=female, 1=male
  MotherID = c(NA, NA, 1, 1, 3, 3, 5, 5, 7, 7),
  FatherID = c(NA, NA, 2, 2, 4, 4, 6, 6, 8, 8),
  isProband = c(1, rep(0, 9)),
  CurAge = c(45, 35, 55, 40, 50, 45, 60, 38, 52, 42),
  isAff = c(1, 0, 1, 0, 1, 0, 1, 0, 1, 0),
  Age = c(40, NA, 50, NA, 45, NA, 55, NA, 48, NA),
  Geno = c(1, NA, 1, 0, 1, 0, NA, NA, 1, NA)
)

# Transform data into required format
data &lt;- transformDF(data)

# Set parameters for the chain
seed &lt;- 123
n_iter &lt;- 10
burn_in &lt;- 0.1  # 10% burn-in
chain_id &lt;- 1
ncores &lt;- 1
max_age &lt;- 100

# Create baseline data (simplified example)
baseline_data &lt;- matrix(
  c(rep(0.005, max_age), rep(0.008, max_age)),  # Increased baseline risks
  ncol = 2,
  dimnames = list(NULL, c("Male", "Female"))
)

# Set prior distributions with carefully chosen bounds
prior_distributions &lt;- list(
  prior_params = list(
    asymptote = list(g1 = 2, g2 = 3),  # Mode around 0.4
    threshold = list(min = 20, max = 30),  # Narrower range for threshold
    median = list(m1 = 3, m2 = 2),  # Mode around 0.6
    first_quartile = list(q1 = 2, q2 = 3)  # Mode around 0.4
  )
)

# Create variance vector for all 8 parameters in sex-specific case
# Using very small variances for initial stability
var &lt;- c(0.005, 0.005,  # asymptotes (smaller variance since between 0-1)
         1, 1,          # thresholds
         1, 1,          # medians
         1, 1)          # first quartiles

# Run the chain
results &lt;- mhChain(
  seed = seed,
  n_iter = n_iter,
  burn_in = burn_in,
  chain_id = chain_id,
  ncores = ncores,
  data = data,
  twins = NULL,
  max_age = max_age,
  baseline_data = baseline_data,
  prior_distributions = prior_distributions,
  prev = 0.05,  # Increased prevalence
  median_max = FALSE,  # Changed to FALSE for simpler median constraints
  BaselineNC = TRUE,
  var = var,
  age_imputation = FALSE,
  imp_interval = 10,
  remove_proband = TRUE,
  sex_specific = TRUE
)

</code></pre>

<hr>
<h2 id='mhLogLikelihood_clipp'>Calculate Log Likelihood using clipp Package</h2><span id='topic+mhLogLikelihood_clipp'></span>

<h3>Description</h3>

<p>Calculate Log Likelihood using clipp Package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mhLogLikelihood_clipp(
  paras,
  families,
  twins,
  max_age,
  baseline_data,
  prev,
  geno_freq,
  trans,
  BaselineNC,
  ncores
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mhLogLikelihood_clipp_+3A_paras">paras</code></td>
<td>
<p>Numeric vector of parameters</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_families">families</code></td>
<td>
<p>Data frame of pedigree information</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_twins">twins</code></td>
<td>
<p>Information on monozygous twins</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_max_age">max_age</code></td>
<td>
<p>Integer, maximum age</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_baseline_data">baseline_data</code></td>
<td>
<p>Numeric matrix of baseline risk data</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_prev">prev</code></td>
<td>
<p>Numeric, prevalence</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_geno_freq">geno_freq</code></td>
<td>
<p>Numeric vector of frequencies</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_trans">trans</code></td>
<td>
<p>Numeric matrix of transmission probabilities</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_baselinenc">BaselineNC</code></td>
<td>
<p>Logical for baseline choice</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_+3A_ncores">ncores</code></td>
<td>
<p>Integer for parallel computation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value representing the calculated log likelihood.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create example parameters and data
paras &lt;- c(0.8, 0.7, 20, 25, 50, 45, 30, 35)  # Example parameters

# Create sample data in PanelPRO format
families &lt;- data.frame(
  ID = 1:10,
  PedigreeID = rep(1, 10),
  Sex = c(0, 1, 0, 1, 0, 1, 0, 1, 0, 1),  # 0=female, 1=male
  MotherID = c(NA, NA, 1, 1, 3, 3, 5, 5, 7, 7),
  FatherID = c(NA, NA, 2, 2, 4, 4, 6, 6, 8, 8),
  isProband = c(1, rep(0, 9)),
  CurAge = c(45, 35, 55, 40, 50, 45, 60, 38, 52, 42),
  isAff = c(1, 0, 1, 0, 1, 0, 1, 0, 1, 0),
  Age = c(40, NA, 50, NA, 45, NA, 55, NA, 48, NA),
  Geno = c(1, NA, 1, 0, 1, 0, NA, NA, 1, NA)
)

# Transform data into required format
families &lt;- transformDF(families)

trans &lt;- matrix(
  c(
    1, 0, # both parents are wild type
    0.5, 0.5, # mother is wildtype and father is a heterozygous carrier
    0.5, 0.5, # father is wildtype and mother is a heterozygous carrier
    1 / 3, 2 / 3 # both parents are heterozygous carriers
  ),
 nrow = 4, ncol = 2, byrow = TRUE
)

# Calculate log likelihood
loglik &lt;- mhLogLikelihood_clipp(
  paras = paras,
  families = families,
  twins = NULL,
  max_age = 94,
  baseline_data = baseline_data_default,
  prev = 0.001,
  geno_freq = c(0.999, 0.001),
  trans = trans,
  BaselineNC = TRUE,
  ncores = 1
)

</code></pre>

<hr>
<h2 id='mhLogLikelihood_clipp_noSex'>Calculate Log Likelihood without Sex Differentiation</h2><span id='topic+mhLogLikelihood_clipp_noSex'></span>

<h3>Description</h3>

<p>This function calculates the log likelihood for a set of parameters and data without considering sex differentiation using the clipp package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mhLogLikelihood_clipp_noSex(
  paras,
  families,
  twins,
  max_age,
  baseline_data,
  prev,
  geno_freq,
  trans,
  BaselineNC,
  ncores
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_paras">paras</code></td>
<td>
<p>Numeric vector, the parameters for the Weibull distribution and scaling factors.
Should contain in order: gamma, delta, given_median, given_first_quartile.</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_families">families</code></td>
<td>
<p>Data frame, containing pedigree information with columns for 'age', 'aff' (affection status), and 'geno' (genotype).</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_twins">twins</code></td>
<td>
<p>Information on monozygous twins or triplets in the pedigrees.</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_max_age">max_age</code></td>
<td>
<p>Integer, maximum age considered in the analysis.</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_baseline_data">baseline_data</code></td>
<td>
<p>Numeric vector, baseline risk data for each age.</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_prev">prev</code></td>
<td>
<p>Numeric, prevalence of the risk allele in the population.</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_geno_freq">geno_freq</code></td>
<td>
<p>Numeric vector, represents the frequency of the risk type and its complement in the population.</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_trans">trans</code></td>
<td>
<p>Numeric matrix, transition matrix that defines the probabilities of allele transmission from parents to offspring.</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_baselinenc">BaselineNC</code></td>
<td>
<p>Logical, indicates if non-carrier penetrance should be based on the baseline data or the calculated non-carrier penetrance.</p>
</td></tr>
<tr><td><code id="mhLogLikelihood_clipp_noSex_+3A_ncores">ncores</code></td>
<td>
<p>Integer, number of cores to use for parallel computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric, the calculated log likelihood.
</p>


<h3>References</h3>

<p>Details about the clipp package and methods can be found in the package documentation.
</p>

<hr>
<h2 id='out_sim'>Simulated Output Data</h2><span id='topic+out_sim'></span>

<h3>Description</h3>

<p>This dataset contains the simulated output data for the penetrance package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(out_sim)
</code></pre>


<h3>Format</h3>

<p>A list with the following components:
</p>

<dl>
<dt>summary_stats</dt><dd><p>A data frame with 18000 observations of 8 variables:
</p>

<dl>
<dt>Median_Male</dt><dd><p>numeric, Median value for males</p>
</dd>
<dt>Median_Female</dt><dd><p>numeric, Median value for females</p>
</dd>
<dt>Threshold_Male</dt><dd><p>numeric, Threshold value for males</p>
</dd>
<dt>Threshold_Female</dt><dd><p>numeric, Threshold value for females</p>
</dd>
<dt>First_Quartile_Male</dt><dd><p>numeric, First quartile value for males</p>
</dd>
<dt>First_Quartile_Female</dt><dd><p>numeric, First quartile value for females</p>
</dd>
<dt>Asymptote_Male</dt><dd><p>numeric, Asymptote value for males</p>
</dd>
<dt>Asymptote_Female</dt><dd><p>numeric, Asymptote value for females</p>
</dd>
</dl>

</dd>
<dt>density_plots</dt><dd><p>A list of 1 element, mfrow: integer vector of length 2</p>
</dd>
<dt>trace_plots</dt><dd><p>A list of 1 element, mfrow: integer vector of length 2</p>
</dd>
<dt>penetrance_plot</dt><dd><p>A list of 2 elements: rect and text</p>
</dd>
<dt>pdf_plots</dt><dd><p>A list of 2 elements: rect and text</p>
</dd>
<dt>combined_chains</dt><dd><p>A list of 19 numeric vectors with 18000 elements each</p>
</dd>
<dt>results</dt><dd><p>A list of 1 element which is a list of 24 elements, each with 18000 elements</p>
</dd>
<dt>data</dt><dd><p>A data frame with 4727 observations of 9 variables:
</p>

<dl>
<dt>individual</dt><dd><p>integer, Individual ID</p>
</dd>
<dt>isProband</dt><dd><p>numeric, Indicator if the individual is a proband</p>
</dd>
<dt>family</dt><dd><p>integer, Family ID</p>
</dd>
<dt>mother</dt><dd><p>numeric, Mother's ID</p>
</dd>
<dt>father</dt><dd><p>numeric, Father's ID</p>
</dd>
<dt>aff</dt><dd><p>numeric, Affected status</p>
</dd>
<dt>sex</dt><dd><p>numeric, Sex of the individual</p>
</dd>
<dt>age</dt><dd><p>numeric, Age of the individual</p>
</dd>
<dt>geno</dt><dd><p>character, Genotype</p>
</dd>
</dl>

</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(out_sim)
head(out_sim$summary_stats)
</code></pre>

<hr>
<h2 id='plot_acf'>Plot Autocorrelation for Multiple MCMC Chains (Posterior Samples)</h2><span id='topic+plot_acf'></span>

<h3>Description</h3>

<p>This function plots the autocorrelation for sex-specific or non-sex-specific posterior samples across multiple MCMC chains.
It defaults to key parameters like <code>asymptote_male_samples</code>, <code>asymptote_female_samples</code>, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_acf(results, n_chains, max_lag = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_acf_+3A_results">results</code></td>
<td>
<p>A list of MCMC chain results.</p>
</td></tr>
<tr><td><code id="plot_acf_+3A_n_chains">n_chains</code></td>
<td>
<p>The number of chains.</p>
</td></tr>
<tr><td><code id="plot_acf_+3A_max_lag">max_lag</code></td>
<td>
<p>Integer, the maximum lag to be considered for the autocorrelation plot. Default is 50.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A series of autocorrelation plots for each chain.
</p>

<hr>
<h2 id='plot_loglikelihood'>Plot Log-Likelihood for Multiple MCMC Chains</h2><span id='topic+plot_loglikelihood'></span>

<h3>Description</h3>

<p>This function plots the log-likelihood values across iterations for multiple MCMC chains.
It helps visualize the convergence of the chains based on the log-likelihood values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_loglikelihood(results, n_chains)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_loglikelihood_+3A_results">results</code></td>
<td>
<p>A list of MCMC chain results, each containing the <code>loglikelihood_current</code> values.</p>
</td></tr>
<tr><td><code id="plot_loglikelihood_+3A_n_chains">n_chains</code></td>
<td>
<p>The number of chains.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A series of log-likelihood plots for each chain.
</p>

<hr>
<h2 id='plot_pdf'>Plot Weibull Probability Density Function with Credible Intervals</h2><span id='topic+plot_pdf'></span>

<h3>Description</h3>

<p>This function plots the Weibull PDF with credible intervals for the given MCMC results.
It allows for visualization of density curves based on the posterior samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pdf(combined_chains, prob, max_age, sex = "NA")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_pdf_+3A_combined_chains">combined_chains</code></td>
<td>
<p>List of combined MCMC chain results containing posterior samples
for penetrance parameters.</p>
</td></tr>
<tr><td><code id="plot_pdf_+3A_prob">prob</code></td>
<td>
<p>Numeric, probability level for confidence intervals (between 0 and 1).</p>
</td></tr>
<tr><td><code id="plot_pdf_+3A_max_age">max_age</code></td>
<td>
<p>Integer, maximum age to plot.</p>
</td></tr>
<tr><td><code id="plot_pdf_+3A_sex">sex</code></td>
<td>
<p>Character, one of &quot;Male&quot;, &quot;Female&quot;, or &quot;NA&quot; for non-sex-specific. Default is &quot;NA&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot showing the Weibull PDF with credible intervals.
</p>

<hr>
<h2 id='plot_penetrance'>Plot Weibull Distribution with Credible Intervals</h2><span id='topic+plot_penetrance'></span>

<h3>Description</h3>

<p>This function plots the Weibull distribution with credible intervals for the given MCMC results.
It allows for visualization of penetrance curves based on the posterior samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_penetrance(combined_chains, prob, max_age, sex = "NA")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_penetrance_+3A_combined_chains">combined_chains</code></td>
<td>
<p>List of combined MCMC chain results containing posterior samples
for penetrance parameters.</p>
</td></tr>
<tr><td><code id="plot_penetrance_+3A_prob">prob</code></td>
<td>
<p>Numeric, probability level for confidence intervals (between 0 and 1).</p>
</td></tr>
<tr><td><code id="plot_penetrance_+3A_max_age">max_age</code></td>
<td>
<p>Integer, maximum age to plot.</p>
</td></tr>
<tr><td><code id="plot_penetrance_+3A_sex">sex</code></td>
<td>
<p>Character, one of &quot;Male&quot;, &quot;Female&quot;, or &quot;NA&quot; for non-sex-specific. Default is &quot;NA&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot showing the Weibull distribution with credible intervals.
</p>

<hr>
<h2 id='plot_trace'>Plot MCMC Trace Plots</h2><span id='topic+plot_trace'></span>

<h3>Description</h3>

<p>Plot MCMC Trace Plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_trace(results, n_chains, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_trace_+3A_results">results</code></td>
<td>
<p>A list of MCMC chain results.</p>
</td></tr>
<tr><td><code id="plot_trace_+3A_n_chains">n_chains</code></td>
<td>
<p>Integer, the number of chains.</p>
</td></tr>
<tr><td><code id="plot_trace_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to print progress messages. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects. Creates trace plots for each parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create example results list
results &lt;- list(
  list(
    median_samples = rnorm(100),
    threshold_samples = runif(100),
    first_quartile_samples = rgamma(100, 2, 2),
    asymptote_samples = rbeta(100, 2, 2)
  )
)

# Generate trace plots
plot_trace(results, n_chains = 1)
</code></pre>

<hr>
<h2 id='printRejectionRates'>Print MCMC Rejection Rates</h2><span id='topic+printRejectionRates'></span>

<h3>Description</h3>

<p>Print MCMC Rejection Rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printRejectionRates(results, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="printRejectionRates_+3A_results">results</code></td>
<td>
<p>A list of MCMC chain results.</p>
</td></tr>
<tr><td><code id="printRejectionRates_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to print rates to console. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts and prints the rejection rates from MCMC chain results.
</p>


<h3>Value</h3>

<p>A named numeric vector containing the rejection rate (between 0 and 1) for each MCMC chain.
Names are of the form &quot;Chain X&quot; where X is the chain number.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create example results list with two chains
results &lt;- list(
  list(rejection_rate = 0.3),
  list(rejection_rate = 0.4)
)

# Get rejection rates without printing
rates &lt;- printRejectionRates(results, verbose = FALSE)

# Print rejection rates
rates &lt;- printRejectionRates(results)

</code></pre>

<hr>
<h2 id='prior_params_default'>Default Prior Parameters</h2><span id='topic+prior_params_default'></span>

<h3>Description</h3>

<p>Default parameters for the prior distributions used in the <code>makePriors</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_params_default

prior_params_default
</code></pre>


<h3>Format</h3>

<p>A list of prior distribution parameters
</p>
<p>A list with the following components:
</p>

<dl>
<dt>asymptote</dt><dd><p>A list with components <code>g1</code> and <code>g2</code>, default values for the asymptote parameters.</p>
</dd>
<dt>threshold</dt><dd><p>A list with components <code>min</code> and <code>max</code>, default values for the threshold parameters.</p>
</dd>
<dt>median</dt><dd><p>A list with components <code>m1</code> and <code>m2</code>, default values for the median parameters.</p>
</dd>
<dt>first_quartile</dt><dd><p>A list with components <code>q1</code> and <code>q2</code>, default values for the first quartile parameters.</p>
</dd>
</dl>


<hr>
<h2 id='risk_proportion_default'>Default Risk Proportions</h2><span id='topic+risk_proportion_default'></span>

<h3>Description</h3>

<p>Default proportions of people at risk used in the <code>makePriors</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk_proportion_default

risk_proportion_default
</code></pre>


<h3>Format</h3>

<p>A data frame of risk proportions
</p>
<p>A data frame with the following columns:
</p>

<dl>
<dt>median</dt><dd><p>Proportion of people at risk at the median age.</p>
</dd>
<dt>first_quartile</dt><dd><p>Proportion of people at risk at the first quartile age.</p>
</dd>
<dt>max_age</dt><dd><p>Proportion of people at risk at the maximum age.</p>
</dd>
</dl>


<hr>
<h2 id='simulated_families'>Processed Family Data</h2><span id='topic+simulated_families'></span>

<h3>Description</h3>

<p>A dataset containing processed information about the first simulated 130 families.
These families are referenced in the vigniette simulation_study.Rmd and using_penetrance.Rmd
The user must specify the <code>pedigree</code> argument as a data frame which contains the
family data (see <code>test_fam</code>). The family data must be in the correct format with the following columns:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated_families
</code></pre>


<h3>Format</h3>

<p>A list of processed family data.
</p>


<h3>Details</h3>


<dl>
<dt><code>ID</code></dt><dd><p>A numeric value representing the unique identifier for each individual. There should be no duplicated entries.</p>
</dd>
<dt><code>Sex</code></dt><dd><p>A numeric value where <code>0</code> indicates female and <code>1</code> indicates male. Missing entries are not currently supported.</p>
</dd>
<dt><code>MotherID</code></dt><dd><p>A numeric value representing the unique identifier for an individual's mother.</p>
</dd>
<dt><code>FatherID</code></dt><dd><p>A numeric value representing the unique identifier for an individual's father.</p>
</dd>
<dt><code>isProband</code></dt><dd><p>A numeric value where <code>1</code> indicates the individual is a proband and <code>0</code> otherwise.</p>
</dd>
<dt><code>CurAge</code></dt><dd><p>A numeric value indicating the age of censoring (current age if the person is alive or age at death if the person is deceased). Allowed ages range from <code>1</code> to <code>94</code>.</p>
</dd>
<dt><code>isAff</code></dt><dd><p>A numeric value indicating the affection status of cancer, with <code>1</code> for diagnosed individuals and <code>0</code> otherwise. Missing entries are not supported.</p>
</dd>
<dt><code>Age</code></dt><dd><p>A numeric value indicating the age of cancer diagnosis, encoded as <code>NA</code> if the individual was not diagnosed. Allowed ages range from <code>1</code> to <code>94</code>.</p>
</dd>
<dt><code>Geno</code></dt><dd><p>A column for germline testing or tumor marker testing results. Positive results should be coded as <code>1</code>, negative results as <code>0</code>, and unknown results as <code>NA</code> or left empty.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Generated for package example
</p>

<hr>
<h2 id='test_fam2'>Processed Family Data</h2><span id='topic+test_fam2'></span>

<h3>Description</h3>

<p>A dataset containing processed information about the first simulated 130 families.
These families are referenced in the vigniette simulation_study_real.Rmd
The user must specify the <code>pedigree</code> argument as a data frame which contains the
family data (see <code>test_fam</code>). The family data must be in the correct format with the following columns:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_fam2
</code></pre>


<h3>Format</h3>

<p>A list of processed family data.
</p>


<h3>Details</h3>


<dl>
<dt><code>ID</code></dt><dd><p>A numeric value representing the unique identifier for each individual. There should be no duplicated entries.</p>
</dd>
<dt><code>Sex</code></dt><dd><p>A numeric value where <code>0</code> indicates female and <code>1</code> indicates male. Missing entries are not currently supported.</p>
</dd>
<dt><code>MotherID</code></dt><dd><p>A numeric value representing the unique identifier for an individual's mother.</p>
</dd>
<dt><code>FatherID</code></dt><dd><p>A numeric value representing the unique identifier for an individual's father.</p>
</dd>
<dt><code>isProband</code></dt><dd><p>A numeric value where <code>1</code> indicates the individual is a proband and <code>0</code> otherwise.</p>
</dd>
<dt><code>CurAge</code></dt><dd><p>A numeric value indicating the age of censoring (current age if the person is alive or age at death if the person is deceased). Allowed ages range from <code>1</code> to <code>94</code>.</p>
</dd>
<dt><code>isAff</code></dt><dd><p>A numeric value indicating the affection status of cancer, with <code>1</code> for diagnosed individuals and <code>0</code> otherwise. Missing entries are not supported.</p>
</dd>
<dt><code>Age</code></dt><dd><p>A numeric value indicating the age of cancer diagnosis, encoded as <code>NA</code> if the individual was not diagnosed. Allowed ages range from <code>1</code> to <code>94</code>.</p>
</dd>
<dt><code>Geno</code></dt><dd><p>A column for germline testing or tumor marker testing results. Positive results should be coded as <code>1</code>, negative results as <code>0</code>, and unknown results as <code>NA</code> or left empty.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Generated for package example
</p>

<hr>
<h2 id='transformDF'>Transform Data Frame</h2><span id='topic+transformDF'></span>

<h3>Description</h3>

<p>This function transforms a data frame from the standard format used in PanelPRO
into the required format which conforms to the requirements of penetrance (and clipp).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformDF(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformDF_+3A_df">df</code></td>
<td>
<p>The input data frame in the usual PanelPRO format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame in the format required for clipp with the following columns:
</p>
<table role = "presentation">
<tr><td><code>individual</code></td>
<td>
<p>ID of the individual</p>
</td></tr>
<tr><td><code>isProband</code></td>
<td>
<p>Indicator if the individual is a proband</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>Family ID</p>
</td></tr>
<tr><td><code>mother</code></td>
<td>
<p>Mother's ID</p>
</td></tr>
<tr><td><code>father</code></td>
<td>
<p>Father's ID</p>
</td></tr>
<tr><td><code>aff</code></td>
<td>
<p>Affection status</p>
</td></tr>
<tr><td><code>sex</code></td>
<td>
<p>Sex (2 for female, 1 for male)</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>Age at diagnosis or current age</p>
</td></tr>
<tr><td><code>geno</code></td>
<td>
<p>Genotype information</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Create example data frame
df &lt;- data.frame(
  ID = 1:2,
  PedigreeID = c(1,1),
  Sex = c(0,1),
  MotherID = c(NA,1),
  FatherID = c(NA,NA),
  isProband = c(1,0),
  CurAge = c(45,20),
  isAff = c(1,0),
  Age = c(40,NA),
  Geno = c(1,0)
)

# Transform the data frame
transformed_df &lt;- transformDF(df)
</code></pre>

<hr>
<h2 id='validate_weibull_parameters'>Validate Weibull Parameters</h2><span id='topic+validate_weibull_parameters'></span>

<h3>Description</h3>

<p>This function validates the given parameters for calculating Weibull distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_weibull_parameters(
  given_first_quartile,
  given_median,
  threshold,
  asymptote
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validate_weibull_parameters_+3A_given_first_quartile">given_first_quartile</code></td>
<td>
<p>The first quartile of the data.</p>
</td></tr>
<tr><td><code id="validate_weibull_parameters_+3A_given_median">given_median</code></td>
<td>
<p>The median of the data.</p>
</td></tr>
<tr><td><code id="validate_weibull_parameters_+3A_threshold">threshold</code></td>
<td>
<p>A constant threshold value.</p>
</td></tr>
<tr><td><code id="validate_weibull_parameters_+3A_asymptote">asymptote</code></td>
<td>
<p>A constant asymptote value (gamma).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical value indicating whether the parameters are valid (TRUE) or not (FALSE)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Validate parameters
is_valid &lt;- validate_weibull_parameters(
  given_first_quartile = 30,
  given_median = 50,
  threshold = 15,
  asymptote = 0.8
)
print(is_valid)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
