<!DOCTYPE html><html><head><title>Help for package aberrance</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aberrance}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aberrance-package'><p>aberrance: Detect Aberrant Behavior in Test Data</p></a></li>
<li><a href='#detect_ac'><p>Detect answer copying</p></a></li>
<li><a href='#detect_as'><p>Detect answer similarity</p></a></li>
<li><a href='#detect_nm'><p>Detect nonparametric misfit</p></a></li>
<li><a href='#detect_pk'><p>Detect preknowledge</p></a></li>
<li><a href='#detect_pm'><p>Detect parametric misfit</p></a></li>
<li><a href='#detect_rg'><p>Detect rapid guessing</p></a></li>
<li><a href='#detect_tt'><p>Detect test tampering</p></a></li>
<li><a href='#sim'><p>Simulate data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Detect Aberrant Behavior in Test Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Detect several types of aberrant behavior, including answer
    copying, answer similarity, nonparametric misfit, parametric misfit,
    preknowledge, rapid guessing, and test tampering.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kyliegorney/aberrance">https://github.com/kyliegorney/aberrance</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kyliegorney/aberrance/issues">https://github.com/kyliegorney/aberrance/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, MASS, stats, utils</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-20 01:49:52 UTC; 17156</td>
</tr>
<tr>
<td>Author:</td>
<td>Kylie Gorney <a href="https://orcid.org/0000-0002-8924-0726"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph, cre],
  Jiayi Deng <a href="https://orcid.org/0000-0002-1962-2956"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kylie Gorney &lt;kgorney@msu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-20 21:10:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='aberrance-package'>aberrance: Detect Aberrant Behavior in Test Data</h2><span id='topic+aberrance'></span><span id='topic+aberrance-package'></span>

<h3>Description</h3>

<p>Detect several types of aberrant behavior, including answer copying, answer similarity, nonparametric misfit, parametric misfit, preknowledge, rapid guessing, and test tampering.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Kylie Gorney <a href="mailto:kgorney@msu.edu">kgorney@msu.edu</a> (<a href="https://orcid.org/0000-0002-8924-0726">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Jiayi Deng (<a href="https://orcid.org/0000-0002-1962-2956">ORCID</a>) [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/kyliegorney/aberrance">https://github.com/kyliegorney/aberrance</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/kyliegorney/aberrance/issues">https://github.com/kyliegorney/aberrance/issues</a>
</p>
</li></ul>


<hr>
<h2 id='detect_ac'>Detect answer copying</h2><span id='topic+detect_ac'></span>

<h3>Description</h3>

<p>Detect answer copying for all possible source-copier pairs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_ac(
  method,
  psi,
  xi = NULL,
  x = NULL,
  d = NULL,
  r = NULL,
  interval = c(-4, 4),
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_ac_+3A_method">method</code></td>
<td>
<p>The answer copying statistic(s) to compute. Options for
score-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_S"</code> for the conditional <code class="reqn">\omega</code> statistic (Wollack, 1997).
</p>
</li>
<li> <p><code>"GBT_S"</code> for the conditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li></ul>

<p>Options for score and distractor-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_SD"</code> for the conditional <code class="reqn">\omega</code> statistic (Wollack, 1997).
</p>
</li>
<li> <p><code>"GBT_SD"</code> for the conditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li></ul>

<p>Options for response-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_R"</code> for the conditional <code class="reqn">\omega</code> statistic (Wollack, 1997).
</p>
</li>
<li> <p><code>"GBT_R"</code> for the conditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li></ul>
</td></tr>
<tr><td><code id="detect_ac_+3A_psi">psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td></tr>
<tr><td><code id="detect_ac_+3A_xi">xi</code></td>
<td>
<p>A matrix of person parameters. If <code>NULL</code> (default), person
parameters are estimated using maximum likelihood estimation.</p>
</td></tr>
<tr><td><code id="detect_ac_+3A_x">x</code>, <code id="detect_ac_+3A_d">d</code>, <code id="detect_ac_+3A_r">r</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores, <code>d</code> the item
distractors, and <code>r</code> the item responses.</p>
</td></tr>
<tr><td><code id="detect_ac_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the person parameters. Default is
<code>c(-4, 4)</code>.</p>
</td></tr>
<tr><td><code id="detect_ac_+3A_alpha">alpha</code></td>
<td>
<p>Value(s) between 0 and 1 indicating the significance level(s)
used for flagging. Default is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr><td><code>stat</code></td>
<td>
<p>A matrix of answer copying statistics.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>A matrix of <em>p</em>-values.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>An array of flagging results. The first dimension corresponds to
source-copier pairs, the second dimension to methods, and the third
dimension to significance levels.</p>
</td></tr>
</table>


<h3>References</h3>

<p>van der Linden, W. J., &amp; Sotaridona, L. (2006). Detecting answer copying when
the regular response process follows a known response model. <em>Journal of
Educational and Behavioral Statistics</em>, <em>31</em>(3), 283&ndash;304.
</p>
<p>Wollack, J. A. (1997). A nominal response model approach for detecting answer
copying. <em>Applied Psychological Measurement</em>, <em>21</em>(4), 307&ndash;320.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_as">detect_as()</a></code> to detect answer similarity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup for Examples 1 to 3 -------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 50         # number of persons
n &lt;- 40         # number of items

# Randomly select 10% sources and 10% copiers
s &lt;- sample(1:N, size = N * 0.10)
c &lt;- sample(setdiff(1:N, s), size = N * 0.10)

# Create vector of indicators (1 = copying pair, 0 = non-copying pair)
pair &lt;- t(combn(N, 2))
pair &lt;- rbind(pair, pair[, 2:1])
ind &lt;- ifelse(1:nrow(pair) %in% apply(
  rbind(cbind(s, c), cbind(c, s)), 1, function(p)
  which(pair[, 1] == p[1] &amp; pair[, 2] == p[2])), 1, 0)
names(ind) &lt;- paste(pair[, 1], pair[, 2], sep = "-")

# Example 1: Item Scores ----------------------------------------------------

# Generate person parameters for the 3PL model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the 3PL model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = rnorm(n, mean = 0.00, sd = 1.00),
  c = runif(n, min = 0.05, max = 0.30)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by replacing 40% of the copier scores with source
# scores
for (v in 1:length(c)) {
  ci &lt;- sample(1:n, size = n * 0.40)
  x[c[v], ci] &lt;- x[s[v], ci]
}

# Detect answer copying
out &lt;- detect_ac(
  method = c("OMG_S", "GBT_S"),
  psi = psi,
  x = x
)

# Example 2: Item Scores and Distractors ------------------------------------

# Generate person parameters for the nested logit model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, eta = 0.00),
  Sigma = matrix(c(1.00, 0.80, 0.80, 1.00), ncol = 2)
)

# Generate item parameters for the nested logit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = rnorm(n, mean = 0.00, sd = 1.00),
  c = runif(n, min = 0.05, max = 0.30),
  lambda1 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda2 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda3 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta1 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta2 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta3 = rnorm(n, mean = 0.00, sd = 1.00)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
d &lt;- dat$d

# Modify contaminated data by replacing 40% of the copier scores and
# distractors with source scores and distractors
for (v in 1:length(c)) {
  ci &lt;- sample(1:n, size = n * 0.40)
  x[c[v], ci] &lt;- x[s[v], ci]
  d[c[v], ci] &lt;- d[s[v], ci]
}

# Detect answer copying
out &lt;- detect_ac(
  method = c("OMG_S", "GBT_S", "OMG_SD", "GBT_SD"),
  psi = psi,
  x = x,
  d = d
)

# Example 3: Item Responses -------------------------------------------------

# Generate person parameters for the nominal response model
xi &lt;- cbind(eta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the nominal response model
psi &lt;- cbind(
  lambda1 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda2 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda3 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda4 = rnorm(n, mean = 1.50, sd = 0.50),
  zeta1 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta2 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta3 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta4 = rnorm(n, mean = 1.50, sd = 0.50)
)

# Simulate uncontaminated data
r &lt;- sim(psi, xi)$r

# Modify contaminated data by replacing 40% of the copier responses with
# source responses
for (v in 1:length(c)) {
  ci &lt;- sample(1:n, size = n * 0.40)
  r[c[v], ci] &lt;- r[s[v], ci]
}

# Detect answer copying
out &lt;- detect_ac(
  method = c("OMG_R", "GBT_R"),
  psi = psi,
  r = r
)
</code></pre>

<hr>
<h2 id='detect_as'>Detect answer similarity</h2><span id='topic+detect_as'></span>

<h3>Description</h3>

<p>Detect answer similarity for all possible pairs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_as(
  method,
  psi,
  xi = NULL,
  x = NULL,
  d = NULL,
  r = NULL,
  y = NULL,
  interval = c(-4, 4),
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_as_+3A_method">method</code></td>
<td>
<p>The answer similarity statistic(s) to compute. Options for
score-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_S"</code> for the unconditional <code class="reqn">\omega</code> statistic (Romero et al.,
2015).
</p>
</li>
<li> <p><code>"GBT_S"</code> for the unconditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li>
<li> <p><code>"M4_S"</code> for the <code class="reqn">M4</code> statistic (Maynes, 2014).
</p>
</li></ul>

<p>Options for score and distractor-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_SD"</code> for the unconditional <code class="reqn">\omega</code> statistic (Romero et al.,
2015).
</p>
</li>
<li> <p><code>"GBT_SD"</code> for the unconditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li>
<li> <p><code>"M4_SD"</code> for the <code class="reqn">M4</code> statistic (Maynes, 2014).
</p>
</li></ul>

<p>Options for response-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_R"</code> for the unconditional <code class="reqn">\omega</code> statistic (Romero et al.,
2015).
</p>
</li>
<li> <p><code>"GBT_R"</code> for the unconditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li>
<li> <p><code>"M4_R"</code> for the <code class="reqn">M4</code> statistic (Maynes, 2014).
</p>
</li></ul>

<p>Options for score and response time-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_ST"</code> for the unconditional <code class="reqn">\omega</code> statistic (Gorney &amp;
Wollack, 2024).
</p>
</li>
<li> <p><code>"GBT_ST"</code> for the unconditional <code class="reqn">GBT</code> statistic (Gorney &amp; Wollack,
2024).
</p>
</li></ul>

<p>Options for score, distractor, and response time-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_SDT"</code> for the unconditional <code class="reqn">\omega</code> statistic (Gorney &amp;
Wollack, 2024).
</p>
</li>
<li> <p><code>"GBT_SDT"</code> for the unconditional <code class="reqn">GBT</code> statistic (Gorney &amp; Wollack,
2024).
</p>
</li></ul>

<p>Options for response and response time-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_RT"</code> for the unconditional <code class="reqn">\omega</code> statistic (Gorney &amp;
Wollack, 2024).
</p>
</li>
<li> <p><code>"GBT_RT"</code> for the unconditional <code class="reqn">GBT</code> statistic (Gorney &amp; Wollack,
2024).
</p>
</li></ul>
</td></tr>
<tr><td><code id="detect_as_+3A_psi">psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td></tr>
<tr><td><code id="detect_as_+3A_xi">xi</code></td>
<td>
<p>A matrix of person parameters. If <code>NULL</code> (default), person
parameters are estimated using maximum likelihood estimation.</p>
</td></tr>
<tr><td><code id="detect_as_+3A_x">x</code>, <code id="detect_as_+3A_d">d</code>, <code id="detect_as_+3A_r">r</code>, <code id="detect_as_+3A_y">y</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores, <code>d</code> the item
distractors, <code>r</code> the item responses, and <code>y</code> the item log response times.</p>
</td></tr>
<tr><td><code id="detect_as_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the person parameters. Default is
<code>c(-4, 4)</code>.</p>
</td></tr>
<tr><td><code id="detect_as_+3A_alpha">alpha</code></td>
<td>
<p>Value(s) between 0 and 1 indicating the significance level(s)
used for flagging. Default is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr><td><code>stat</code></td>
<td>
<p>A matrix of answer similarity statistics.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>A matrix of <em>p</em>-values.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>An array of flagging results. The first dimension corresponds to
pairs, the second dimension to methods, and the third dimension to
significance levels.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gorney, K., &amp; Wollack, J. A. (2024). <em>Using response times in answer
similarity analysis</em> [Manuscript submitted for publication].
</p>
<p>Maynes, D. (2014). Detection of non-independent test taking by similarity
analysis. In N. M. Kingston &amp; A. K. Clark (Eds.), <em>Test fraud: Statistical
detection and methodology</em> (pp. 53&ndash;80). Routledge.
</p>
<p>Romero, M., Riascos, Á., &amp; Jara, D. (2015). On the optimality of
answer-copying indices: Theory and practice. <em>Journal of Educational and
Behavioral Statistics</em>, <em>40</em>(5), 435&ndash;453.
</p>
<p>van der Linden, W. J., &amp; Sotaridona, L. (2006). Detecting answer copying when
the regular response process follows a known response model. <em>Journal of
Educational and Behavioral Statistics</em>, <em>31</em>(3), 283&ndash;304.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_ac">detect_ac()</a></code> to detect answer copying.
</p>
<p><code><a href="#topic+detect_pk">detect_pk()</a></code> to detect preknowledge.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup for Examples 1 and 2 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 50         # number of persons
n &lt;- 40         # number of items

# Randomly select 10% examinees with preknowledge and 40% compromised items
cv &lt;- sample(1:N, size = N * 0.10)
ci &lt;- sample(1:n, size = n * 0.40)

# Create vector of indicators (1 = similar pair, 0 = non-similar pair)
pair &lt;- t(combn(N, 2))
ind &lt;- ifelse((pair[, 1] %in% cv) &amp; (pair[, 2] %in% cv), 1, 0)
names(ind) &lt;- paste(pair[, 1], pair[, 2], sep = "-")

# Example 1: Item Scores and Response Times ---------------------------------

# Generate person parameters for the 3PL model and lognormal model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, tau = 0.00),
  Sigma = matrix(c(1.00, 0.25, 0.25, 0.25), ncol = 2)
)

# Generate item parameters for the 3PL model and lognormal model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = NA,
  c = runif(n, min = 0.05, max = 0.30),
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = NA
)

# Generate positively correlated difficulty and time intensity parameters
psi[, c("b", "beta")] &lt;- MASS::mvrnorm(
  n,
  mu = c(b = 0.00, beta = 3.50),
  Sigma = matrix(c(1.00, 0.20, 0.20, 0.15), ncol = 2)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
y &lt;- dat$y

# Modify contaminated data by changing the item scores and reducing the log
# response times
x[cv, ci] &lt;- rbinom(length(cv) * length(ci), size = 1, prob = 0.90)
y[cv, ci] &lt;- y[cv, ci] * 0.75

# Detect answer similarity
out &lt;- detect_as(
  method = c("OMG_S", "GBT_S", "OMG_ST", "GBT_ST"),
  psi = psi,
  x = x,
  y = y
)

# Example 2: Polytomous Item Scores -----------------------------------------

# Generate person parameters for the generalized partial credit model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the generalized partial credit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores to the maximum score
x[cv, ci] &lt;- 3

# Detect answer similarity
out &lt;- detect_as(
  method = c("OMG_S", "GBT_S"),
  psi = psi,
  x = x
)

# Setup for Examples 3 and 4 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 50         # number of persons
n &lt;- 40         # number of items

# Randomly select 10% sources and 10% copiers
s &lt;- sample(1:N, size = N * 0.10)
c &lt;- sample(setdiff(1:N, s), size = N * 0.10)

# Create vector of indicators (1 = similar pair, 0 = non-similar pair)
pair &lt;- t(combn(N, 2))
ind &lt;- ifelse(1:nrow(pair) %in% apply(
  rbind(cbind(s, c), cbind(c, s)), 1, function(p)
  which(pair[, 1] == p[1] &amp; pair[, 2] == p[2])), 1, 0)
names(ind) &lt;- paste(pair[, 1], pair[, 2], sep = "-")

# Example 3: Item Scores and Distractors ------------------------------------

# Generate person parameters for the nested logit model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, eta = 0.00),
  Sigma = matrix(c(1.00, 0.80, 0.80, 1.00), ncol = 2)
)

# Generate item parameters for the nested logit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = rnorm(n, mean = 0.00, sd = 1.00),
  c = runif(n, min = 0.05, max = 0.30),
  lambda1 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda2 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda3 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta1 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta2 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta3 = rnorm(n, mean = 0.00, sd = 1.00)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
d &lt;- dat$d

# Modify contaminated data by replacing 40% of the copier scores and
# distractors with source scores and distractors
for (v in 1:length(c)) {
  ci &lt;- sample(1:n, size = n * 0.40)
  x[c[v], ci] &lt;- x[s[v], ci]
  d[c[v], ci] &lt;- d[s[v], ci]
}

# Detect answer similarity
out &lt;- detect_as(
  method = c("OMG_S", "GBT_S", "OMG_SD", "GBT_SD"),
  psi = psi,
  x = x,
  d = d
)

# Example 4: Item Responses -------------------------------------------------

# Generate person parameters for the nominal response model
xi &lt;- cbind(eta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the nominal response model
psi &lt;- cbind(
  lambda1 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda2 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda3 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda4 = rnorm(n, mean = 1.50, sd = 0.50),
  zeta1 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta2 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta3 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta4 = rnorm(n, mean = 1.50, sd = 0.50)
)

# Simulate uncontaminated data
r &lt;- sim(psi, xi)$r

# Modify contaminated data by replacing 40% of the copier responses with
# source responses
for (v in 1:length(c)) {
  ci &lt;- sample(1:n, size = n * 0.40)
  r[c[v], ci] &lt;- r[s[v], ci]
}

# Detect answer similarity
out &lt;- detect_as(
  method = c("OMG_R", "GBT_R"),
  psi = psi,
  r = r
)
</code></pre>

<hr>
<h2 id='detect_nm'>Detect nonparametric misfit</h2><span id='topic+detect_nm'></span>

<h3>Description</h3>

<p>Detect nonparametric misfit using person-fit statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_nm(method, x = NULL, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_nm_+3A_method">method</code></td>
<td>
<p>The person-fit statistic(s) to compute. Options for score-based
statistics are:
</p>

<ul>
<li> <p><code>"G_S"</code> for the number of Guttman errors (Guttman, 1944; see also
Molenaar, 1991).
</p>
</li>
<li> <p><code>"NC_S"</code> for the norm conformity index (Tatsuoka &amp; Tatsuoka, 1983).
<em>Note:</em> This statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"U1_S"</code> for the <code class="reqn">U1</code> statistic, also known as the <code class="reqn">G^*</code>
statistic (van der Flier, 1977; see also Emons, 2008).
</p>
</li>
<li> <p><code>"U3_S"</code> for the <code class="reqn">U3</code> statistic (van der Flier, 1982; see also Emons,
2008).
</p>
</li>
<li> <p><code>"ZU3_S"</code> for the <code class="reqn">ZU3</code> statistic (van der Flier, 1982).
<em>Note:</em> This statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"A_S"</code> for the agreement index (Kane &amp; Brennan, 1980). <em>Note:</em> This
statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"D_S"</code> for the disagreement index (Kane &amp; Brennan, 1980). <em>Note:</em> This
statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"E_S"</code> for the dependability index (Kane &amp; Brennan, 1980). <em>Note:</em> This
statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"C_S"</code> for the caution index (Sato, 1975). <em>Note:</em> This statistic cannot
be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"MC_S"</code> for the modified caution index, also known as the <code class="reqn">C^*</code>
statistic (Harnisch &amp; Linn, 1981). <em>Note:</em> This statistic cannot be
computed for polytomous item scores.
</p>
</li>
<li> <p><code>"PC_S"</code> for the personal point-biserial correlation (Donlon &amp; Fischer,
1968). <em>Note:</em> This statistic cannot be computed for polytomous item
scores.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"HT_S&#8288;</code> for the <code class="reqn">H^T</code> statistic (Sijtsma, 1986). <em>Note:</em> This
statistic cannot be computed for polytomous item scores.
</p>
</li></ul>

<p>Options for response time-based statistics are:
</p>

<ul>
<li> <p><code>"KL_T"</code> for the Kullback-Leibler divergence (Man et al., 2018).
</p>
</li></ul>
</td></tr>
<tr><td><code id="detect_nm_+3A_x">x</code>, <code id="detect_nm_+3A_y">y</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores and <code>y</code> the item
log response times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr><td><code>stat</code></td>
<td>
<p>A matrix of nonparametric person-fit statistics.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Donlon, T. F., &amp; Fischer, F. E. (1968). An index of an individual's agreement
with group-determined item difficulties. <em>Educational and Psychological
Measurement</em>, <em>28</em>(1), 105&ndash;113.
</p>
<p>Emons, W. H. M. (2008). Nonparametric person-fit analysis of polytomous item
scores. <em>Applied Psychological Measurement</em>, <em>32</em>(3), 224&ndash;247.
</p>
<p>Guttman, L. (1944). A basis for scaling qualitative data. <em>American
Sociological Review</em>, <em>9</em>(2), 139&ndash;150.
</p>
<p>Harnisch, D. L., &amp; Linn, R. L. (1981). Analysis of item response patterns:
Questionable test data and dissimilar curriculum practices. <em>Journal of
Educational Measurement</em>, <em>18</em>(3), 133&ndash;146.
</p>
<p>Kane, M. T., &amp; Brennan, R. L. (1980). Agreement coefficients as indices of
dependability for domain referenced tests. <em>Applied Psychological
Measurement</em>, <em>4</em>(1), 105&ndash;126.
</p>
<p>Man, K., Harring, J. R., Ouyang, Y., &amp; Thomas, S. L. (2018). Response time
based nonparametric Kullback-Leibler divergence measure for detecting
aberrant test-taking behavior. <em>International Journal of Testing</em>, <em>18</em>(2),
155&ndash;177.
</p>
<p>Molenaar, I. W. (1991). A weighted Loevinger H-coefficient extending Mokken
scaling to multicategory items. <em>Kwantitatieve Methoden</em>, <em>12</em>(37), 97&ndash;117.
</p>
<p>Sato, T. (1975). <em>The construction and interpretation of S-P tables</em>.
</p>
<p>Sijtsma, K. (1986). A coefficient of deviance of response patterns.
<em>Kwantitatieve Methoden</em>, <em>7</em>(22), 131&ndash;145.
</p>
<p>Tatsuoka, K. K., &amp; Tatsuoka, M. M. (1983). Spotting erroneous rules of
operation by the individual consistency index. <em>Journal of Educational
Measurement</em>, <em>20</em>(3), 221&ndash;230.
</p>
<p>van der Flier, H. (1977) Environmental factors and deviant response patterns.
In Y. H. Poortinga (Ed.), <em>Basic problems in cross-cultural psychology</em>.
Swets &amp; Zeitlinger Publishers.
</p>
<p>van der Flier, H. (1982). Deviant response patterns and comparability of test
scores. <em>Journal of Cross-Cultural Psychology</em>, <em>13</em>(3), 267&ndash;298.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_pm">detect_pm()</a></code> to detect parametric misfit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup for Examples 1 to 3 -------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 500        # number of persons
n &lt;- 40         # number of items

# Randomly select 10% examinees with preknowledge and 40% compromised items
cv &lt;- sample(1:N, size = N * 0.10)
ci &lt;- sample(1:n, size = n * 0.40)

# Create vector of indicators (1 = misfitting, 0 = fitting)
ind &lt;- ifelse(1:N %in% cv, 1, 0)

# Example 1: Dichotomous Item Scores ----------------------------------------

# Generate person parameters for the 3PL model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the 3PL model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = rnorm(n, mean = 0.00, sd = 1.00),
  c = runif(n, min = 0.05, max = 0.30)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores
x[cv, ci] &lt;- rbinom(length(cv) * length(ci), size = 1, prob = 0.90)

# Detect nonparametric misfit
out &lt;- detect_nm(
  method = c("G_S", "NC_S", "U1_S", "U3_S", "ZU3_S", "A_S", "D_S", "E_S",
             "C_S", "MC_S", "PC_S", "HT_S"),
  x = x
)

# Example 2: Polytomous Item Scores -----------------------------------------

# Generate person parameters for the generalized partial credit model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the generalized partial credit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores to the maximum score
x[cv, ci] &lt;- 3

# Detect nonparametric misfit
out &lt;- detect_nm(
  method = c("G_S", "U1_S", "U3_S"),
  x = x
)

# Example 3: Item Response Times --------------------------------------------

# Generate person parameters for the lognormal model
xi &lt;- cbind(tau = rnorm(N, mean = 0.00, sd = sqrt(0.25)))

# Generate item parameters for the lognormal model
psi &lt;- cbind(
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = rnorm(n, mean = 3.50, sd = sqrt(0.15))
)

# Simulate uncontaminated data
y &lt;- sim(psi, xi)$y

# Modify contaminated data by reducing the log response times
y[cv, ci] &lt;- y[cv, ci] * 0.75

# Detect nonparametric misfit
out &lt;- detect_nm(
  method = "KL_T",
  y = y
)
</code></pre>

<hr>
<h2 id='detect_pk'>Detect preknowledge</h2><span id='topic+detect_pk'></span>

<h3>Description</h3>

<p>Detect preknowledge under the assumption that the set of
compromised items is known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_pk(
  method,
  ci,
  psi,
  xi = NULL,
  xi_c = NULL,
  xi_s = NULL,
  x = NULL,
  y = NULL,
  interval = c(-4, 4),
  alpha = 0.05,
  cutoff = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_pk_+3A_method">method</code></td>
<td>
<p>The preknowledge detection statistic(s) to compute. Options for
score-based statistics are:
</p>

<ul>
<li> <p><code>"L_S"</code> for the signed likelihood ratio test statistic (Sinharay, 2017).
</p>
</li>
<li> <p><code>"ML_S"</code> for the modified signed likelihood ratio test statistic
(Sinharay &amp; Jensen, 2019). For numerical stability, an absolute cutoff
value can be specified using <code>cutoff</code>. <em>Note:</em> This statistic cannot be
computed under the 3PL model or the graded response model.
</p>
</li>
<li> <p><code>"LR_S"</code> for the Lugannani-Rice approximation (Sinharay &amp; Jensen, 2019).
For numerical stability, an absolute cutoff value can be specified using
<code>cutoff</code>. <em>Note:</em> This statistic cannot be computed under the 3PL model
or the graded response model.
</p>
</li>
<li> <p><code>"S_S"</code> for the signed score test statistic (Sinharay, 2017).
</p>
</li>
<li> <p><code>"W_S"</code> for the Wald test statistic (Sinharay &amp; Jensen, 2019).
</p>
</li></ul>

<p>Options for response time-based statistics are:
</p>

<ul>
<li> <p><code>"L_T"</code> for the signed likelihood ratio test statistic, or equivalently,
<code>"W_T"</code> for the Wald test statistic (Sinharay, 2020).
</p>
</li></ul>

<p>Options for score and response time-based statistics are:
</p>

<ul>
<li> <p><code>"L_ST"</code> for the constrained likelihood ratio test statistic (Sinharay &amp;
Johnson, 2020).
</p>
</li></ul>
</td></tr>
<tr><td><code id="detect_pk_+3A_ci">ci</code></td>
<td>
<p>A vector of compromised item positions. Length must be greater
than 1. All other items are presumed secure.</p>
</td></tr>
<tr><td><code id="detect_pk_+3A_psi">psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td></tr>
<tr><td><code id="detect_pk_+3A_xi">xi</code>, <code id="detect_pk_+3A_xi_c">xi_c</code>, <code id="detect_pk_+3A_xi_s">xi_s</code></td>
<td>
<p>Matrices of person parameters. <code>xi</code> is based on all
items, <code>xi_c</code> is based on the compromised items, and <code>xi_s</code> is based on the
secure items. If <code>NULL</code> (default), person parameters are estimated using
maximum likelihood estimation.</p>
</td></tr>
<tr><td><code id="detect_pk_+3A_x">x</code>, <code id="detect_pk_+3A_y">y</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores and <code>y</code> the item
log response times.</p>
</td></tr>
<tr><td><code id="detect_pk_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the person parameters. Default is
<code>c(-4, 4)</code>.</p>
</td></tr>
<tr><td><code id="detect_pk_+3A_alpha">alpha</code></td>
<td>
<p>Value(s) between 0 and 1 indicating the significance level(s)
used for flagging. Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="detect_pk_+3A_cutoff">cutoff</code></td>
<td>
<p>Use with the modified signed likelihood ratio test statistic
and the Lugannani-Rice approximation. If the absolute value of the signed
likelihood ratio test statistic is less than the cutoff (default is
<code>0.05</code>), then the modified signed likelihood ratio test statistic is
replaced with the signed likelihood ratio test statistic and the
Lugannani-Rice approximation is replaced with the <code class="reqn">p</code>-value of the
signed likelihood ratio test statistic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr><td><code>stat</code></td>
<td>
<p>A matrix of preknowledge detection statistics.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>A matrix of <em>p</em>-values.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>An array of flagging results. The first dimension corresponds to
persons, the second dimension to methods, and the third dimension to
significance levels.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sinharay, S. (2017). Detection of item preknowledge using likelihood ratio
test and score test. <em>Journal of Educational and Behavioral Statistics</em>,
<em>42</em>(1), 46&ndash;68.
</p>
<p>Sinharay, S. (2020). Detection of item preknowledge using response times.
<em>Applied Psychological Measurement</em>, <em>44</em>(5), 376&ndash;392.
</p>
<p>Sinharay, S., &amp; Jensen, J. L. (2019). Higher-order asymptotics and its
application to testing the equality of the examinee ability over two sets of
items. <em>Psychometrika</em>, <em>84</em>(2), 484&ndash;510.
</p>
<p>Sinharay, S., &amp; Johnson, M. S. (2020). The use of item scores and response
times to detect examinees who may have benefited from item preknowledge.
<em>British Journal of Mathematical and Statistical Psychology</em>, <em>73</em>(3),
397&ndash;419.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_as">detect_as()</a></code> to detect answer similarity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup for Examples 1 and 2 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 500        # number of persons
n &lt;- 40         # number of items

# Randomly select 10% examinees with preknowledge and 40% compromised items
cv &lt;- sample(1:N, size = N * 0.10)
ci &lt;- sample(1:n, size = n * 0.40)

# Create vector of indicators (1 = preknowledge, 0 = no preknowledge)
ind &lt;- ifelse(1:N %in% cv, 1, 0)

# Example 1: Item Scores and Response Times ---------------------------------

# Generate person parameters for the 2PL model and lognormal model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, tau = 0.00),
  Sigma = matrix(c(1.00, 0.25, 0.25, 0.25), ncol = 2)
)

# Generate item parameters for the 2PL model and lognormal model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = NA,
  c = 0,
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = NA
)

# Generate positively correlated difficulty and time intensity parameters
psi[, c("b", "beta")] &lt;- MASS::mvrnorm(
  n,
  mu = c(b = 0.00, beta = 3.50),
  Sigma = matrix(c(1.00, 0.20, 0.20, 0.15), ncol = 2)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
y &lt;- dat$y

# Modify contaminated data by changing the item scores and reducing the log
# response times
x[cv, ci] &lt;- rbinom(length(cv) * length(ci), size = 1, prob = 0.90)
y[cv, ci] &lt;- y[cv, ci] * 0.75

# Detect preknowledge
out &lt;- detect_pk(
  method = c("L_S", "ML_S", "LR_S", "S_S", "W_S", "L_T", "L_ST"),
  ci = ci,
  psi = psi,
  x = x,
  y = y
)

# Example 2: Polytomous Item Scores -----------------------------------------

# Generate person parameters for the generalized partial credit model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the generalized partial credit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores to the maximum score
x[cv, ci] &lt;- 3

# Detect preknowledge
out &lt;- detect_pk(
  method = c("L_S", "ML_S", "LR_S", "S_S", "W_S"),
  ci = ci,
  psi = psi,
  x = x
)
</code></pre>

<hr>
<h2 id='detect_pm'>Detect parametric misfit</h2><span id='topic+detect_pm'></span>

<h3>Description</h3>

<p>Detect parametric misfit using person-fit statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_pm(
  method,
  psi,
  xi = NULL,
  x = NULL,
  d = NULL,
  r = NULL,
  y = NULL,
  interval = c(-4, 4),
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_pm_+3A_method">method</code></td>
<td>
<p>The person-fit statistic(s) to compute. Options for score-based
statistics are:
</p>

<ul>
<li> <p><code>"ECI2_S_*"</code> for the second standardized extended caution index, also
known as <code class="reqn">\zeta_1</code> (Tatsuoka, 1984; see also Sinharay, 2018b).
</p>
</li>
<li> <p><code>"ECI4_S_*"</code> for the fourth standardized extended caution index, also
known as <code class="reqn">\zeta_2</code> (Tatsuoka, 1984; see also Sinharay, 2018b).
</p>
</li>
<li> <p><code>"L_S_*"</code> for the standardized log-likelihood statistic (Drasgow et al.,
1985).
</p>
</li></ul>

<p>Options for distractor-based statistics are:
</p>

<ul>
<li> <p><code>"L_D_*"</code> for the standardized log-likelihood statistic (Gorney &amp;
Wollack, 2023).
</p>
</li></ul>

<p>Options for score and distractor-based statistics are:
</p>

<ul>
<li> <p><code>"L_SD_*"</code> for the log-likelihood statistic (Gorney &amp; Wollack, 2023).
</p>
</li></ul>

<p>Options for response-based statistics are:
</p>

<ul>
<li> <p><code>"L_R_*"</code> for the standardized log-likelihood statistic (Drasgow et al.,
1985).
</p>
</li></ul>

<p>Options for response time-based statistics are:
</p>

<ul>
<li> <p><code>"L_T"</code> for the log-likelihood statistic (Sinharay, 2018a).
</p>
</li></ul>

<p>Options for score and response time-based statistics are:
</p>

<ul>
<li> <p><code>"Q_ST_*"</code> for the log-likelihood statistic that combines <code>"L_S_*"</code> and
<code>"L_T"</code> (Gorney, Sinharay, &amp; Liu, 2024).
</p>
</li>
<li> <p><code>"L_ST_*"</code> for the standardized log-likelihood statistic (Gorney,
Sinharay, &amp; Liu, 2024). <em>Note:</em> This statistic cannot be computed using
the <code>"CF"</code>, <code>"CS"</code>, <code>"EW"</code>, <code>"TSCF"</code>, <code>"TSCS"</code>, or <code>"TSEW"</code> corrections.
</p>
</li></ul>

<p>Options for response and response time-based statistics are:
</p>

<ul>
<li> <p><code>"Q_RT_*"</code> for the log-likelihood statistic that combines <code>"L_R_*"</code> and
<code>"L_T"</code> (Gorney, Sinharay, &amp; Liu, 2024).
</p>
</li>
<li> <p><code>"L_RT_*"</code> for the standardized log-likelihood statistic (Gorney,
Sinharay, &amp; Liu, 2024). <em>Note:</em> This statistic cannot be computed using
the <code>"CF"</code>, <code>"CS"</code>, <code>"EW"</code>, <code>"TSCF"</code>, <code>"TSCS"</code>, or <code>"TSEW"</code> corrections.
</p>
</li></ul>

<p>Statistics ending in <code>"*"</code> can be computed using various corrections.
Options are:
</p>

<ul>
<li> <p><code>"*"</code> for all possible corrections.
</p>
</li>
<li> <p><code>"NO"</code> for no correction.
</p>
</li>
<li> <p><code>"CF"</code> for the Cornish-Fisher expansion (Molenaar &amp; Hoijtink, 1990).
</p>
</li>
<li> <p><code>"CS"</code> for the chi-squared approximation (Molenaar &amp; Hoijtink, 1990).
</p>
</li>
<li> <p><code>"EW"</code> for the Edgeworth expansion (Bedrick, 1997).
</p>
</li>
<li> <p><code>"TS"</code> for the Taylor series expansion (Snijders, 2001; see also
Sinharay, 2016a, 2016b).
</p>
</li>
<li> <p><code>"TSCF"</code> for the Taylor series expansion and Cornish-Fisher expansion
(Gorney, Sinharay, &amp; Eckerly, 2024; see also Gorney, 2024).
</p>
</li>
<li> <p><code>"TSCS"</code> for the Taylor series expansion and chi-squared approximation
(Gorney Sinharay, &amp; Eckerly, 2024; see also Gorney, 2024).
</p>
</li>
<li> <p><code>"TSEW"</code> for the Taylor series expansion and Edgeworth expansion (Gorney
Sinharay, &amp; Eckerly, 2024; see also Gorney, 2024).
</p>
</li></ul>
</td></tr>
<tr><td><code id="detect_pm_+3A_psi">psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td></tr>
<tr><td><code id="detect_pm_+3A_xi">xi</code></td>
<td>
<p>A matrix of person parameters. If <code>NULL</code> (default), person
parameters are estimated using maximum likelihood estimation.</p>
</td></tr>
<tr><td><code id="detect_pm_+3A_x">x</code>, <code id="detect_pm_+3A_d">d</code>, <code id="detect_pm_+3A_r">r</code>, <code id="detect_pm_+3A_y">y</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores, <code>d</code> the item
distractors, <code>r</code> the item responses, and <code>y</code> the item log response times.</p>
</td></tr>
<tr><td><code id="detect_pm_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the person parameters. Default is
<code>c(-4, 4)</code>.</p>
</td></tr>
<tr><td><code id="detect_pm_+3A_alpha">alpha</code></td>
<td>
<p>Value(s) between 0 and 1 indicating the significance level(s)
used for flagging. Default is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr><td><code>stat</code></td>
<td>
<p>A matrix of parametric person-fit statistics.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>A matrix of <em>p</em>-values.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>An array of flagging results. The first dimension corresponds to
persons, the second dimension to methods, and the third dimension to
significance levels.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bedrick, E. J. (1997). Approximating the conditional distribution of person
fit indexes for checking the Rasch model. <em>Psychometrika</em>, <em>62</em>(2), 191&ndash;199.
</p>
<p>Drasgow, F., Levine, M. V., &amp; Williams, E. A. (1985). Appropriateness
measurement with polychotomous item response models and standardized indices.
<em>British Journal of Mathematical and Statistical Psychology</em>, <em>38</em>(1),
67&ndash;86.
</p>
<p>Gorney, K. (2024). <em>Three new corrections for standardized person-fit
statistics for tests with polytomous items</em> [Manuscript submitted for
publication].
</p>
<p>Gorney, K., Sinharay, S., &amp; Eckerly, C. (2024). <em>Efficient corrections for
standardized person-fit statistics</em> [Manuscript submitted for publication].
</p>
<p>Gorney, K., Sinharay, S., &amp; Liu, X. (2024). Using item scores and response
times in person-fit assessment. <em>British Journal of Mathematical and
Statistical Psychology</em>, <em>77</em>(1), 151&ndash;168.
</p>
<p>Gorney, K., &amp; Wollack, J. A. (2023). Using item scores and distractors in
person-fit assessment. <em>Journal of Educational Measurement</em>, <em>60</em>(1), 3&ndash;27.
</p>
<p>Molenaar, I. W., &amp; Hoijtink, H. (1990). The many null distributions of person
fit indices. <em>Psychometrika</em>, <em>55</em>(1), 75&ndash;106.
</p>
<p>Sinharay, S. (2016a). Asymptotic corrections of standardized extended caution
indices. <em>Applied Psychological Measurement</em>, <em>40</em>(6), 418&ndash;433.
</p>
<p>Sinharay, S. (2016b). Asymptotically correct standardization of person-fit
statistics beyond dichotomous items. <em>Psychometrika</em>, <em>81</em>(4), 992&ndash;1013.
</p>
<p>Sinharay, S. (2018a). A new person-fit statistic for the lognormal model for
response times. <em>Journal of Educational Measurement</em>, <em>55</em>(4), 457&ndash;476.
</p>
<p>Sinharay, S. (2018b). Extension of caution indices to mixed-format tests.
<em>British Journal of Mathematical and Statistical Psychology</em>, <em>71</em>(2),
363&ndash;386.
</p>
<p>Snijders, T. A. B. (2001). Asymptotic null distribution of person fit
statistics with estimated person parameter. <em>Psychometrika</em>, <em>66</em>(3),
331&ndash;342.
</p>
<p>Tatsuoka, K. K. (1984). Caution indices based on item response theory.
<em>Psychometrika</em>, <em>49</em>(1), 95&ndash;110.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_nm">detect_nm()</a></code> to detect nonparametric misfit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup for Examples 1 and 2 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 500        # number of persons
n &lt;- 40         # number of items

# Randomly select 10% examinees with preknowledge and 40% compromised items
cv &lt;- sample(1:N, size = N * 0.10)
ci &lt;- sample(1:n, size = n * 0.40)

# Create vector of indicators (1 = misfitting, 0 = fitting)
ind &lt;- ifelse(1:N %in% cv, 1, 0)

# Example 1: Item Scores and Response Times ---------------------------------

# Generate person parameters for the 3PL model and lognormal model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, tau = 0.00),
  Sigma = matrix(c(1.00, 0.25, 0.25, 0.25), ncol = 2)
)

# Generate item parameters for the 3PL model and lognormal model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = NA,
  c = runif(n, min = 0.05, max = 0.30),
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = NA
)

# Generate positively correlated difficulty and time intensity parameters
psi[, c("b", "beta")] &lt;- MASS::mvrnorm(
  n,
  mu = c(b = 0.00, beta = 3.50),
  Sigma = matrix(c(1.00, 0.20, 0.20, 0.15), ncol = 2)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
y &lt;- dat$y

# Modify contaminated data by changing the item scores and reducing the log
# response times
x[cv, ci] &lt;- rbinom(length(cv) * length(ci), size = 1, prob = 0.90)
y[cv, ci] &lt;- y[cv, ci] * 0.75

# Detect parametric misfit
out &lt;- detect_pm(
  method = c("L_S_TS", "L_T", "Q_ST_TS", "L_ST_TS"),
  psi = psi,
  x = x,
  y = y
)

# Example 2: Polytomous Item Scores -----------------------------------------

# Generate person parameters for the generalized partial credit model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the generalized partial credit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores to the maximum score
x[cv, ci] &lt;- 3

# Detect parametric misfit
out &lt;- detect_pm(
  method = c("ECI2_S_TSCF", "ECI4_S_TSCF", "L_S_TSCF"),
  psi = psi,
  x = x
)
</code></pre>

<hr>
<h2 id='detect_rg'>Detect rapid guessing</h2><span id='topic+detect_rg'></span>

<h3>Description</h3>

<p>Detect rapid guessing using item-level response time
information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_rg(
  method,
  t,
  x = NULL,
  outlier = 100,
  chance = 0.25,
  thr = 3,
  nt = 10,
  limits = c(0, Inf),
  min_item = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_rg_+3A_method">method</code></td>
<td>
<p>The rapid guessing detection method to apply. Options for
visual inspection methods are:
</p>

<ul>
<li> <p><code>"VI"</code> for the visual inspection method (Schnipke, 1995). Each plot
contains a histogram of the item response times.
</p>
</li>
<li> <p><code>"VITP"</code> for the visual inspection with proportion correct method (Lee &amp;
Jia, 2014; Ma et al., 2011). Each plot contains a histogram of the item
response times, a dashed red line indicating the proportion correct, and
a solid red line indicating the chance rate of success (see <code>chance</code>).
</p>
</li></ul>

<p>Options for threshold methods are:
</p>

<ul>
<li> <p><code>"CT"</code> for the custom threshold method (Wise et al., 2004; Wise &amp; Kong,
2005). The thresholds can be specified using <code>thr</code>.
</p>
</li>
<li> <p><code>"NT"</code> for the normative threshold method (Martinez &amp; Rios, 2023; Wise &amp;
Ma, 2012). The percentage(s) of the mean item response time can be
specified using <code>nt</code>.
</p>
</li></ul>

<p>Options for visual inspection and threshold methods are:
</p>

<ul>
<li> <p><code>"CUMP"</code> for the cumulative proportion correct method (Guo et al., 2016).
Each plot contains a histogram of the item response times, a dashed red
line indicating the cumulative proportion correct, and a solid red line
indicating the chance rate of success (see <code>chance</code>). <em>Note:</em> No
thresholds are returned for items for which the cumulative proportion
correct is consistently above or below <code>chance</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="detect_rg_+3A_t">t</code>, <code id="detect_rg_+3A_x">x</code></td>
<td>
<p>Matrices of raw data. <code>t</code> is for the item response times and <code>x</code>
the item scores.</p>
</td></tr>
<tr><td><code id="detect_rg_+3A_outlier">outlier</code></td>
<td>
<p>The percentile(s) above which to delete outliers in <code>t</code>.
Length must be equal to 1 or equal to the total number of items. Default is
<code>100</code>, for which no response times are identified as outliers to be
deleted.</p>
</td></tr>
<tr><td><code id="detect_rg_+3A_chance">chance</code></td>
<td>
<p>Use with the visual inspection with proportion correct method
and the cumulative proportion correct method. Value(s) indicating the
chance rate(s) of success. Length must be equal to 1 or equal to the total
number of items. Default is <code>0.25</code>.</p>
</td></tr>
<tr><td><code id="detect_rg_+3A_thr">thr</code></td>
<td>
<p>Use with the custom threshold method. Value(s) indicating the
response time thresholds. Length must be equal to 1 or equal to the total
number of items. Default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="detect_rg_+3A_nt">nt</code></td>
<td>
<p>Use with the normative threshold method. Value(s) indicating the
percentage(s) of the mean item response time to be used as thresholds. If
length is equal to 1, one normative threshold is applied to all items (Wise
et al., 2004). Else if length is greater than 1, multiple normative
thresholds are applied to all items (Martinez &amp; Rios, 2023). Default is
<code>10</code>, for NT10.</p>
</td></tr>
<tr><td><code id="detect_rg_+3A_limits">limits</code></td>
<td>
<p>Use with threshold methods. A vector of length 2 indicating
the minimum and maximum possible thresholds. Default is <code>c(0, Inf)</code>.</p>
</td></tr>
<tr><td><code id="detect_rg_+3A_min_item">min_item</code></td>
<td>
<p>The minimum number of items used to identify unmotivated
persons. Default is <code>1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned. If a visual inspection method is used, the list
contains the following elements:
</p>
<table>
<tr><td><code>plots</code></td>
<td>
<p>A list containing one plot per item.</p>
</td></tr>
</table>
<p>If a threshold method is used, the list contains the following elements:
</p>
<table>
<tr><td><code>thr</code></td>
<td>
<p>A vector or matrix of response time thresholds.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>A matrix or array of flagging results.</p>
</td></tr>
<tr><td><code>rte</code></td>
<td>
<p>A vector or matrix of response time effort, equal to 1 minus the
proportion of flagged responses per person (Wise &amp; Kong, 2005).</p>
</td></tr>
<tr><td><code>rtf</code></td>
<td>
<p>A vector or matrix of response time fidelity, equal to 1 minus the
proportion of flagged responses per item (Wise, 2006).</p>
</td></tr>
<tr><td><code>unmotivated</code></td>
<td>
<p>The proportion of unmotivated persons.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Guo, H., Rios, J. A., Haberman, S., Liu, O. L., Wang, J., &amp; Paek, I. (2016).
A new procedure for detection of students' rapid guessing responses using
response time. <em>Applied Measurement in Education</em>, <em>29</em>(3), 173&ndash;183.
</p>
<p>Lee, Y.-H., &amp; Jia, Y. (2014). Using response time to investigate students'
test-taking behaviors in a NAEP computer-based study. <em>Large-Scale
Assessments in Education</em>, <em>2</em>, Article 8.
</p>
<p>Ma, L., Wise, S. L., Thum, Y. M., &amp; Kingsbury, G. (2011, April). <em>Detecting
response time threshold under the computer adaptive testing environment</em>
[Paper presentation]. National Council of Measurement in Education, New
Orleans, LA, United States.
</p>
<p>Martinez, A. J., &amp; Rios, J. A. (2023, April). <em>The impact of rapid guessing
on model fit and factor-analytic reliability</em> [Paper presentation]. National
Council on Measurement in Education, Chicago, IL, United States.
</p>
<p>Schnipke, D. L. (1995, April). <em>Assessing speededness in computer-based tests
using item response times</em> [Paper presentation]. National Council on
Measurement in Education, San Francisco, CA, United States.
</p>
<p>Wise, S. L. (2006). An investigation of the differential effort received by
items on a low-stakes computer-based test. <em>Applied Measurement in
Education</em>, <em>19</em>(2), 95&ndash;114.
</p>
<p>Wise, S. L., Kingsbury, G. G., Thomason, J., &amp; Kong, X. (2004, April). <em>An
investigation of motivation filtering in a statewide achievement testing
program</em> [Paper presentation]. National Council on Measurement in Education,
San Diego, CA, United States.
</p>
<p>Wise, S. L., &amp; Kong, X. (2005). Response time effort: A new measure of
examinee motivation in computer-based tests. <em>Applied Measurement in
Education</em>, <em>18</em>(2), 163&ndash;183.
</p>
<p>Wise, S. L., &amp; Ma, L. (2012, April). <em>Setting response time thresholds for a
CAT item pool: The normative threshold method</em> [Paper presentation].
National Council on Measurement in Education, Vancouver, BC, Canada.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup for Examples 1 to 3 -------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 5000       # number of persons
n &lt;- 40         # number of items

# Randomly select 20% unmotivated persons
cv &lt;- sample(1:N, size = N * 0.20)

# Create vector of indicators (1 = unmotivated, 0 = motivated)
ind &lt;- ifelse(1:N %in% cv, 1, 0)

# Generate person parameters for the 3PL model and lognormal model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, tau = 0.00),
  Sigma = matrix(c(1.00, 0.25, 0.25, 0.25), ncol = 2)
)

# Generate item parameters for the 3PL model and lognormal model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = NA,
  c = runif(n, min = 0.05, max = 0.30),
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = NA
)

# Generate positively correlated difficulty and time intensity parameters
psi[, c("b", "beta")] &lt;- MASS::mvrnorm(
  n,
  mu = c(b = 0.00, beta = 3.50),
  Sigma = matrix(c(1.00, 0.20, 0.20, 0.15), ncol = 2)
)

# Simulate item scores and response times
dat &lt;- sim(psi, xi)
x &lt;- dat$x
t &lt;- exp(dat$y)

# Modify contaminated data by guessing on 20% of the items
for (v in cv) {
  ci &lt;- sample(1:n, size = n * 0.20)
  x[v, ci] &lt;- rbinom(length(ci), size = 1, prob = 0.25)
  t[v, ci] &lt;- runif(length(ci), min = 1, max = 10)
}

# Example 1: Visual Inspection Methods --------------------------------------

# Detect rapid guessing using the visual inspection method
out &lt;- detect_rg(
  method = "VI",
  t = t,
  outlier = 90
)

# Detect rapid guessing using the visual inspection with proportion correct
# method
out &lt;- detect_rg(
  method = "VITP",
  t = t,
  x = x,
  outlier = 90
)

# Example 2: Threshold Methods ----------------------------------------------

# Detect rapid guessing using the custom threshold method with a common
# three-second threshold
out &lt;- detect_rg(
  method = "CT",
  t = t,
  thr = 3
)

# Detect rapid guessing using the custom threshold method with 10% of the
# median item response time
out &lt;- detect_rg(
  method = "CT",
  t = t,
  thr = apply(t, 2, function(i) 0.10 * median(i))
)

# Detect rapid guessing using the normative threshold method with 10% of the
# mean item response time
out &lt;- detect_rg(
  method = "NT",
  t = t,
  nt = 10
)

# Detect rapid guessing using the normative threshold method with 5 to 35% of
# the mean item response time
out &lt;- detect_rg(
  method = "NT",
  t = t,
  nt = seq(5, 35, by = 5)
)

# Example 3: Visual Inspection and Threshold Methods ------------------------

# Detect rapid guessing using the cumulative proportion correct method
out &lt;- detect_rg(
  method = "CUMP",
  t = t,
  x = x,
  outlier = 90
)
</code></pre>

<hr>
<h2 id='detect_tt'>Detect test tampering</h2><span id='topic+detect_tt'></span>

<h3>Description</h3>

<p>Detect test tampering at the person level or at the group level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_tt(
  method,
  psi,
  xi = NULL,
  xi_c = NULL,
  xi_s = NULL,
  x = NULL,
  d = NULL,
  r = NULL,
  x_0 = NULL,
  d_0 = NULL,
  r_0 = NULL,
  interval = c(-4, 4),
  alpha = 0.05,
  group = NULL,
  c = -0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_tt_+3A_method">method</code></td>
<td>
<p>The test tampering statistic(s) to compute. Options for score
and distractor-based statistics are:
</p>

<ul>
<li> <p><code>"EDI_SD_*"</code> for the erasure detection index (Wollack et al., 2015;
Wollack &amp; Eckerly, 2017).
</p>
</li>
<li> <p><code>"GBT_SD"</code> for the generalized binomial test statistic (Sinharay &amp;
Johnson, 2017). <em>Note:</em> This statistic cannot be computed at the group
level.
</p>
</li>
<li> <p><code>"L_SD"</code> for the signed likelihood ratio test statistic (Sinharay et al.,
2017). <em>Note:</em> This statistic cannot be computed at the group level.
</p>
</li></ul>

<p>Options for response-based statistics are:
</p>

<ul>
<li> <p><code>"EDI_R_*"</code> for the erasure detection index (Wollack et al., 2015;
Wollack &amp; Eckerly, 2017).
</p>
</li>
<li> <p><code>"GBT_R"</code> for the generalized binomial test statistic (Sinharay &amp;
Johnson, 2017). <em>Note:</em> This statistic cannot be computed at the group
level.
</p>
</li>
<li> <p><code>"L_R"</code> for the signed likelihood ratio test statistic (Sinharay et al.,
2017). <em>Note:</em> This statistic cannot be computed at the group level.
</p>
</li></ul>

<p>Statistics ending in <code>"*"</code> can be computed using various corrections.
Options are:
</p>

<ul>
<li> <p><code>"*"</code> for all possible corrections.
</p>
</li>
<li> <p><code>"NO"</code> for no correction (Sinharay, 2018; Wollack et al., 2015).
</p>
</li>
<li> <p><code>"CO"</code> for the continuity correction (Wollack et al., 2015; Wollack &amp;
Eckerly, 2017). The value of the continuity correction can be specified
using <code>c</code>.
</p>
</li>
<li> <p><code>"TS"</code> for the Taylor series expansion (Sinharay, 2018).
</p>
</li></ul>
</td></tr>
<tr><td><code id="detect_tt_+3A_psi">psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td></tr>
<tr><td><code id="detect_tt_+3A_xi">xi</code>, <code id="detect_tt_+3A_xi_c">xi_c</code>, <code id="detect_tt_+3A_xi_s">xi_s</code></td>
<td>
<p>Matrices of person parameters. <code>xi</code> is based on all
items, <code>xi_c</code> is based on items with changed answers, and <code>xi_s</code> is based
on items with the same answers. If <code>NULL</code> (default), person parameters are
estimated using maximum likelihood estimation.</p>
</td></tr>
<tr><td><code id="detect_tt_+3A_x">x</code>, <code id="detect_tt_+3A_d">d</code>, <code id="detect_tt_+3A_r">r</code></td>
<td>
<p>Matrices of final data. <code>x</code> is for the item scores, <code>d</code> the item
distractors, and <code>r</code> the item responses.</p>
</td></tr>
<tr><td><code id="detect_tt_+3A_x_0">x_0</code>, <code id="detect_tt_+3A_d_0">d_0</code>, <code id="detect_tt_+3A_r_0">r_0</code></td>
<td>
<p>Matrices of initial data. <code>x_0</code> is for the item scores,
<code>d_0</code> the item distractors, and <code>r_0</code> the item responses.</p>
</td></tr>
<tr><td><code id="detect_tt_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the person parameters. Default is
<code>c(-4, 4)</code>.</p>
</td></tr>
<tr><td><code id="detect_tt_+3A_alpha">alpha</code></td>
<td>
<p>Value(s) between 0 and 1 indicating the significance level(s)
used for flagging. Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="detect_tt_+3A_group">group</code></td>
<td>
<p>A vector indicating group membership. If <code>NULL</code> (default),
statistics are computed at the person level.</p>
</td></tr>
<tr><td><code id="detect_tt_+3A_c">c</code></td>
<td>
<p>Use with the erasure detection index. A value indicating the
continuity correction. Default is <code>-0.5</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr><td><code>stat</code></td>
<td>
<p>A matrix of test tampering detection statistics.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>A matrix of <em>p</em>-values.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>An array of flagging results. The first dimension corresponds to
persons/groups, the second dimension to methods, and the third dimension to
significance levels.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sinharay, S., Duong, M. Q., &amp; Wood, S. W. (2017). A new statistic for
detection of aberrant answer changes. <em>Journal of Educational Measurement</em>,
<em>54</em>(2), 200&ndash;217.
</p>
<p>Sinharay, S., &amp; Johnson, M. S. (2017). Three new methods for analysis of
answer changes. <em>Educational and Psychological Measurement</em>, <em>77</em>(1), 54&ndash;81.
</p>
<p>Sinharay, S. (2018). Detecting fraudulent erasures at an aggregate level.
<em>Journal of Educational and Behavioral Statistics</em>, <em>43</em>(3), 286&ndash;315.
</p>
<p>Wollack, J. A., Cohen, A. S., &amp; Eckerly, C. A. (2015). Detecting test
tampering using item response theory. <em>Educational and Psychological
Measurement</em>, <em>75</em>(6), 931&ndash;953.
</p>
<p>Wollack, J. A., &amp; Eckerly, C. A. (2017). Detecting test tampering at the
group level. In G. J. Cizek &amp; J. A. Wollack (Eds.), <em>Handbook of quantitative
methods for detecting cheating on tests</em> (pp. 214&ndash;231). Routledge.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup for Examples 1 and 2 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 500        # number of persons
n &lt;- 40         # number of items
G &lt;- 20         # number of groups

# Create groups
group &lt;- rep(1:G, each = N / G)

# Randomly select 20% tampered groups with 20% tampered persons
cg &lt;- sample(1:G, size = G * 0.20)
cv &lt;- NULL
for (g in cg) {
  cv &lt;- c(cv, sample(which(group == g), size = N / G * 0.20))
}

# Create vectors of indicators (1 = tampered, 0 = non-tampered)
group_ind &lt;- ifelse(1:G %in% cg, 1, 0)
person_ind &lt;- ifelse(1:N %in% cv, 1, 0)

# Generate person parameters for the nested logit model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, eta = 0.00),
  Sigma = matrix(c(1.00, 0.80, 0.80, 1.00), ncol = 2)
)

# Generate item parameters for the nested logit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = rnorm(n, mean = 0.00, sd = 1.00),
  c = runif(n, min = 0.05, max = 0.30),
  lambda1 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda2 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda3 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta1 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta2 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta3 = rnorm(n, mean = 0.00, sd = 1.00)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x_0 &lt;- x &lt;- dat$x
d_0 &lt;- d &lt;- dat$d

# Simulate 5% random erasures for non-tampered persons
r_0 &lt;- r &lt;- ifelse(x == 1, 4, d)
for (v in setdiff(1:N, cv)) {
  ci &lt;- sample(1:n, size = n * 0.05)
  for (i in ci) {
    r_0[v, i] &lt;- sample((1:4)[-r[v, i]], size = 1)
  }
  x_0[v, ci] &lt;- ifelse(r_0[v, ci] == 4, 1, 0)
  d_0[v, ci] &lt;- ifelse(r_0[v, ci] == 4, NA, r_0[v, ci])
}
rm(r_0, r)

# Modify contaminated data by tampering with 20% of the scores and
# distractors
for (v in cv) {
  ci &lt;- sample(1:n, size = n * 0.20)
  x[v, ci] &lt;- 1
  d[v, ci] &lt;- NA
}

# Example 1: Person-Level Statistics ----------------------------------------

# Detect test tampering
out &lt;- detect_tt(
  method = c("EDI_SD_*", "GBT_SD", "L_SD"),
  psi = psi,
  x = x,
  d = d,
  x_0 = x_0,
  d_0 = d_0
)

# Example 2: Group-Level Statistics -----------------------------------------

# Detect test tampering
out &lt;- detect_tt(
  method = "EDI_SD_*",
  psi = psi,
  x = x,
  d = d,
  x_0 = x_0,
  d_0 = d_0,
  group = group
)
</code></pre>

<hr>
<h2 id='sim'>Simulate data</h2><span id='topic+sim'></span>

<h3>Description</h3>

<p>Simulate data using item response theory (IRT) models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim(psi, xi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_+3A_psi">psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td></tr>
<tr><td><code id="sim_+3A_xi">xi</code></td>
<td>
<p>A matrix of person parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned. Possible elements include:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>A matrix of item scores.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>A matrix of item distractors.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>A matrix of item responses.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>A matrix of item log response times.</p>
</td></tr>
</table>


<h3>Models for Item Scores</h3>

<p>The <strong>Rasch</strong>, <strong>2PL</strong>, and <strong>3PL models</strong> (Birnbaum, 1968; Rasch, 1960) are
given by
</p>
<p style="text-align: center;"><code class="reqn">P(X_{vi} = 1 | \theta_v, a_i, b_i, c_i) =
c_i + \frac{1 - c_i}{1 + \exp\{-a_i(\theta_v - b_i)\}}.</code>
</p>


<ul>
<li> <p><code>psi</code> must contain columns named <code>"a"</code>, <code>"b"</code>, and <code>"c"</code> for the item
discrimination, difficulty, and pseudo-guessing parameters, respectively.
</p>
</li>
<li> <p><code>xi</code> must contain a column named <code>"theta"</code> for the person ability
parameters.
</p>
</li></ul>

<p>The <strong>partial credit model</strong> (PCM; Masters, 1982) and the <strong>generalized
partial credit model</strong> (GPCM; Muraki, 1992) are given by
</p>
<p style="text-align: center;"><code class="reqn">P(X_{vi} = j | \theta_v, a_i, \boldsymbol{c_i}) =
\frac{\exp\{\sum_{k=0}^j a_i(\theta_v - c_{ik})\}}
{\sum_{l=0}^{m_i} \exp\{\sum_{k=0}^l a_i(\theta_v - c_{ik})\}}.</code>
</p>


<ul>
<li> <p><code>psi</code> must contain columns named <code>"a"</code> for the item discrimination
parameter and <code>"c0"</code>, <code>"c1"</code>, <code>...</code>, for the item category parameters.
</p>
</li>
<li> <p><code>xi</code> must contain a column named <code>"theta"</code> for the person ability
parameters.
</p>
</li></ul>

<p>The <strong>graded response model</strong> (GRM; Samejima, 1969) is given by
</p>
<p style="text-align: center;"><code class="reqn">P(X_{vi} = j | \theta_v, a_i, \boldsymbol{b_i}) =
P(X_{vi} \ge j | \theta_v, a_i, \boldsymbol{b_i}) -
P(X_{vi} \ge j + 1 | \theta_v, a_i, \boldsymbol{b_i}),</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">P(X_{vi} \ge j | \theta_v, a_i, \boldsymbol{b_i}) = \begin{cases}
1 &amp;\text{if } j = 0, \\
\frac{1}{1 + \exp\{-a_i(\theta_v - b_{ij})\}}
&amp;\text{if } 1 \le j \le m_i, \\
0 &amp;\text{if } j = m_i + 1.
\end{cases}</code>
</p>


<ul>
<li> <p><code>psi</code> must contain columns named <code>"a"</code> for the item discrimination
parameter and <code>"b1"</code>, <code>"b2"</code>, <code>...</code>, for the item location parameters
listed in increasing order.
</p>
</li>
<li> <p><code>xi</code> must contain a column named <code>"theta"</code> for the person ability
parameters.
</p>
</li></ul>



<h3>Models for Item Distractors</h3>

<p>The <strong>nested logit model</strong> (NLM; Bolt et al., 2012) is given by
</p>
<p style="text-align: center;"><code class="reqn">P(D_{vi} = j | \theta_v, \eta_v,
a_i, b_i, c_i, \boldsymbol{\lambda_i}, \boldsymbol{\zeta_i}) =
[1 - P(X_{vi} = 1 | \theta_v, a_i, b_i, c_i)] \times
P(D_{vi} = j | X_{vi} = 0, \eta_v,
\boldsymbol{\lambda_i}, \boldsymbol{\zeta_i}),</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">P(D_{vi} = j | X_{vi} = 0, \eta_v,
\boldsymbol{\lambda_i}, \boldsymbol{\zeta_i}) =
\frac{\exp(\lambda_{ij} \eta_v + \zeta_{ij})}
{\sum_{k=1}^{m_i-1} \exp(\lambda_{ik} \eta_v + \zeta_{ik})}.</code>
</p>


<ul>
<li> <p><code>psi</code> must contain columns named <code>"a"</code>, <code>"b"</code>, and <code>"c"</code> for the item
discrimination, difficulty, and pseudo-guessing parameters, respectively,
<code>"lambda1"</code>, <code>"lambda2"</code>, <code>...</code>, for the item slope parameters, and
<code>"zeta1"</code>, <code>"zeta2"</code>, <code>...</code>, for the item intercept parameters.
</p>
</li>
<li> <p><code>xi</code> must contain columns named <code>"theta"</code> and <code>"eta"</code> for the person
parameters that govern response correctness and distractor selection,
respectively.
</p>
</li></ul>



<h3>Models for Item Responses</h3>

<p>The <strong>nominal response model</strong> (NRM; Bock, 1972) is given by
</p>
<p style="text-align: center;"><code class="reqn">P(R_{vi} = j | \eta_v,
\boldsymbol{\lambda_i}, \boldsymbol{\zeta_i}) =
\frac{\exp(\lambda_{ij} \eta_v + \zeta_{ij})}
{\sum_{k=1}^{m_i} \exp(\lambda_{ik} \eta_v + \zeta_{ik})}.</code>
</p>


<ul>
<li> <p><code>psi</code> must contain columns named <code>"lambda1"</code>, <code>"lambda2"</code>, <code>...</code>, for the
item slope parameters and <code>"zeta1"</code>, <code>"zeta2"</code>, <code>...</code>, for the item
intercept parameters. If there is a correct response category, its
parameters should be listed last.
</p>
</li>
<li> <p><code>xi</code> must contain a column named <code>"eta"</code> for the person parameters that
govern response selection.
</p>
</li></ul>



<h3>Models for Item Log Response Times</h3>

<p>The <strong>lognormal model</strong> (van der Linden, 2006) is given by
</p>
<p style="text-align: center;"><code class="reqn">f(Y_{vi} | \tau_v, \alpha_i, \beta_i) =
\frac{\alpha_i}{\sqrt{2 \pi}}
\exp\{-\frac{1}{2}[\alpha_i(Y_{vi} - (\beta_i - \tau_v))]^2\}.</code>
</p>


<ul>
<li> <p><code>psi</code> must contain columns named <code>"alpha"</code> and <code>"beta"</code> for the item time
discrimination and time intensity parameters, respectively.
</p>
</li>
<li> <p><code>xi</code> must contain a column named <code>"tau"</code> for the person speed parameters.
</p>
</li></ul>



<h3>References</h3>

<p>Birnbaum, A. (1968). Some latent trait models and their use in inferring an
examinee's ability. In F. M. Lord &amp; M. R. Novick (Eds.), <em>Statistical
theories of mental test scores</em> (pp. 397&ndash;479). Addison-Wesley.
</p>
<p>Bock, R. D. (1972). Estimating item parameters and latent ability when
responses are scored in two or more nominal categories. <em>Psychometrika</em>,
<em>37</em>(1), 29&ndash;51.
</p>
<p>Bolt, D. M., Wollack, J. A., &amp; Suh, Y. (2012). Application of a
multidimensional nested logit model to multiple-choice test items.
<em>Psychometrika</em>, <em>77</em>(2), 339&ndash;357.
</p>
<p>Masters, G. N. (1982). A Rasch model for partial credit scoring.
<em>Psychometrika</em>, <em>47</em>(2), 149&ndash;174.
</p>
<p>Muraki, E. (1992). A generalized partial credit model: Application of an EM
algorithm. <em>Applied Psychological Measurement</em>, <em>16</em>(2), 159&ndash;176.
</p>
<p>Rasch, G. (1960). <em>Probabilistic models for some intelligence and attainment
tests</em>. Danish Institute for Educational Research.
</p>
<p>Samejima, F. (1969). Estimation of latent ability using a response pattern of
graded scores. <em>Psychometrika</em>, <em>34</em>(S1), 1&ndash;97.
</p>
<p>van der Linden, W. J. (2006). A lognormal model for response times on test
items. <em>Journal of Educational and Behavioral Statistics</em>, <em>31</em>(2), 181&ndash;204.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup for Examples 1 to 5 -------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 500        # number of persons
n &lt;- 40         # number of items

# Example 1: 3PL Model and Lognormal Model ----------------------------------

# Generate person parameters
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, tau = 0.00),
  Sigma = matrix(c(1.00, 0.25, 0.25, 0.25), ncol = 2)
)

# Generate item parameters
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = NA,
  c = runif(n, min = 0.05, max = 0.30),
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = NA
)

# Generate positively correlated difficulty and time intensity parameters
psi[, c("b", "beta")] &lt;- MASS::mvrnorm(
  n,
  mu = c(b = 0.00, beta = 3.50),
  Sigma = matrix(c(1.00, 0.20, 0.20, 0.15), ncol = 2)
)

# Simulate item scores and log response times
dat &lt;- sim(psi, xi)
x &lt;- dat$x
y &lt;- dat$y

# Example 2: Generalized Partial Credit Model -------------------------------

# Generate person parameters
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate item scores
x &lt;- sim(psi, xi)$x

# Example 3: Graded Response Model ------------------------------------------

# Generate person parameters
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b1 = rnorm(n, mean = -1.00, sd = 0.50),
  b2 = rnorm(n, mean = 0.00, sd = 0.50),
  b3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Sort item location parameters in increasing order
psi[, paste0("b", 1:3)] &lt;- t(apply(psi[, paste0("b", 1:3)], 1, sort))

# Simulate item scores
x &lt;- sim(psi, xi)$x

# Example 4: Nested Logit Model ---------------------------------------------

# Generate person parameters
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, eta = 0.00),
  Sigma = matrix(c(1.00, 0.80, 0.80, 1.00), ncol = 2)
)

# Generate item parameters
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = rnorm(n, mean = 0.00, sd = 1.00),
  c = runif(n, min = 0.05, max = 0.30),
  lambda1 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda2 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda3 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta1 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta2 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta3 = rnorm(n, mean = 0.00, sd = 1.00)
)

# Simulate item scores and distractors
dat &lt;- sim(psi, xi)
x &lt;- dat$x
d &lt;- dat$d

# Example 5: Nominal Response Model -----------------------------------------

# Generate person parameters
xi &lt;- cbind(eta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters
psi &lt;- cbind(
  lambda1 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda2 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda3 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda4 = rnorm(n, mean = 1.50, sd = 0.50),
  zeta1 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta2 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta3 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta4 = rnorm(n, mean = 1.50, sd = 0.50)
)

# Simulate item responses
r &lt;- sim(psi, xi)$r
</code></pre>

</main>


</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
