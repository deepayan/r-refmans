<!DOCTYPE html><html lang="en"><head><title>Help for package hbal</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hbal}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.onAttach'><p>Subsidiary hbal Function</p></a></li>
<li><a href='#att'><p>Estimating the ATT from an hbal object</p></a></li>
<li><a href='#contenderJudges'><p>Data from Black and Owens (2016)</p></a></li>
<li><a href='#covarExclude'><p>Match Column Names to be Excluded</p></a></li>
<li><a href='#covarExpand'><p>Serial Expansion of Covariates</p></a></li>
<li><a href='#crossValidate'><p>Ridge Penalty Selection through Cross Validation</p></a></li>
<li><a href='#doubleSelection'><p>Double Selection</p></a></li>
<li><a href='#hbal'><p>Hierarchically Regularized Entropy Balancing</p></a></li>
<li><a href='#hbal-data'><p>Data from Black and Owens (2016) and Hazlett (2020)</p></a></li>
<li><a href='#lalonde'><p>Data from Hazlett (2020)</p></a></li>
<li><a href='#plot.hbal'><p>Plotting Covariate Balance from an <code>hbal</code> Object</p></a></li>
<li><a href='#summary.hbal'><p>Summarizing from an <code>hbal</code> Object</p></a></li>
<li><a href='#updateCoef'><p>Update lambda</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchically Regularized Entropy Balancing</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yiqing Xu &lt;yiqingxu@stanford.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements hierarchically regularized entropy balancing proposed by Xu and Yang (2022) &lt;<a href="https://doi.org/10.1017%2Fpan.2022.12">doi:10.1017/pan.2022.12</a>&gt;. The method adjusts the covariate distributions of the control group to match those of the treatment group. 'hbal' automatically expands the covariate space to include higher order terms and uses cross-validation to select variable penalties for the balancing conditions.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://yiqingxu.org/packages/hbal/">https://yiqingxu.org/packages/hbal/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.1), estimatr, glmnet, gtable, gridExtra, ggplot2,
stringr, nloptr, generics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, knitr, rmarkdown, broom, ebal</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-29 23:51:27 UTC; yiqingxu</td>
</tr>
<tr>
<td>Author:</td>
<td>Yiqing Xu <a href="https://orcid.org/0000-0003-2041-6671"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Eddie Yang [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-10 18:13:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='.onAttach'>Subsidiary hbal Function</h2><span id='topic+.onAttach'></span>

<h3>Description</h3>

<p>Function to load package description.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.onAttach(lib, pkg)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".onAttach_+3A_lib">lib</code></td>
<td>
<p>libname</p>
</td></tr>
<tr><td><code id=".onAttach_+3A_pkg">pkg</code></td>
<td>
<p>package name</p>
</td></tr>
</table>


<h3>References</h3>

<p>Xu, Y., &amp; Yang, E. (2022). Hierarchically Regularized Entropy Balancing. Political Analysis, 1-8. doi:10.1017/pan.2022.12
</p>

<hr>
<h2 id='att'>Estimating the ATT from an hbal object</h2><span id='topic+att'></span>

<h3>Description</h3>

<p><code>att</code> estimates the average treatment effect on the treated (ATT) from an 
hbal object returned by <code>hbal</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>att(hbalobject, method="lm_robust", dr=TRUE, displayAll=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="att_+3A_hbalobject">hbalobject</code></td>
<td>
<p>an object of class <code>hbal</code> as returned by <code>hbal</code>.</p>
</td></tr>
<tr><td><code id="att_+3A_method">method</code></td>
<td>
<p>estimation method for the ATT. Default is the Lin (2016) estimator.</p>
</td></tr>
<tr><td><code id="att_+3A_dr">dr</code></td>
<td>
<p>doubly robust, whether an outcome model is included in estimating the ATT.</p>
</td></tr>
<tr><td><code id="att_+3A_displayall">displayAll</code></td>
<td>
<p>only displays treatment effect by default.</p>
</td></tr>
<tr><td><code id="att_+3A_...">...</code></td>
<td>
<p>arguments passed to lm_lin or lm_robust</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper for <code>lm_robust</code> and <code>lm_lin</code> from the <a href="estimatr.html#topic+estimatr">estimatr</a> package.
</p>


<h3>Value</h3>

<p>A matrix of estimates with their robust standard errors
</p>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#EXAMPLE 1
set.seed(1984)
N &lt;- 500
X1 &lt;- rnorm(N)
X2 &lt;- rbinom(N,size=1,prob=.5)
X &lt;- cbind(X1, X2)
treat &lt;- rbinom(N, 1, prob=0.5) # Treatment indicator
y &lt;- 0.5 * treat + X[,1] + X[,2] + rnorm(N) # Outcome
dat &lt;- data.frame(treat=treat, X, Y=y)
out &lt;- hbal(Treat = 'treat', X = c('X1', 'X2'), Y = 'Y', data=dat)
sout &lt;- summary(att(out))
</code></pre>

<hr>
<h2 id='contenderJudges'>Data from Black and Owens (2016)</h2><span id='topic+contenderJudges'></span>

<h3>Description</h3>

<p>Data on the contender judges from Black and Owens (2016): Courting the president: how circuit court judges alter their behavior for promotion to the Supreme Court
This dataset includes 10,171 period-judge observations for a total of 68 judges.
The treatment variable of interest is <code>treatFinal0</code>, which indicates whether there was a vacancy in the Supreme Court
The outcome of interest is ideological alignment of judges' votes with the sitting President (<code>presIdeoVote</code>).
The remaining variables are characteristics of the judges and courts, to be used as controls.
</p>


<h3>Format</h3>

<p>A data frame with 10171 rows and 10 columns.
</p>

<dl>
<dt>presIdeoVote</dt><dd><p>ideological alignment of judges' votes with the sitting President (outcome)</p>
</dd>
<dt>treatFinal0</dt><dd><p>treatment indicator for vacancy period</p>
</dd>
<dt>judgeJCS</dt><dd><p>judge’s Judicial Common Space (JCS)score</p>
</dd>
<dt>presDist</dt><dd><p>Ideological distribution of the sitting President</p>
</dd>
<dt>panelDistJCS</dt><dd><p>ideological composition of the panel with whom the judge sat</p>
</dd>
<dt>circmed</dt><dd><p>median JCS score of the circuit judges</p>
</dd>
<dt>sctmed</dt><dd><p>JCS score of the median justice on the Supreme Court</p>
</dd>
<dt>coarevtc</dt><dd><p>indicator for whether the case decision was reversed by the circuit court</p>
</dd>
<dt>casepub</dt><dd><p>indicator for the publication status of thecourt’s opinion</p>
</dd>
<dt>judge</dt><dd><p>name of the judge</p>
</dd>
</dl>



<h3>References</h3>


<ul>
<li><p> Black, R. C., and Owens, R. J. (2016). Courting the president: how circuit court judges alter their behavior for promotion to the Supreme Court. American Journal of Political Science, 60(1), 30-43.
</p>
</li></ul>


<hr>
<h2 id='covarExclude'>Match Column Names to be Excluded</h2><span id='topic+covarExclude'></span>

<h3>Description</h3>

<p>Internal function called by <code>hbal</code> to serially expand covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covarExclude(colname, exclude)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="covarExclude_+3A_colname">colname</code></td>
<td>
<p>column name.</p>
</td></tr>
<tr><td><code id="covarExclude_+3A_exclude">exclude</code></td>
<td>
<p>list of covariate name pairs or triplets to be excluded.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical
</p>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>

<hr>
<h2 id='covarExpand'>Serial Expansion of Covariates</h2><span id='topic+covarExpand'></span>

<h3>Description</h3>

<p>Internal function called by <code>hbal</code> to serially expand covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covarExpand(X, exp.degree = 3, treatment = NULL, exclude = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="covarExpand_+3A_x">X</code></td>
<td>
<p>matrix of covariates.</p>
</td></tr>
<tr><td><code id="covarExpand_+3A_exp.degree">exp.degree</code></td>
<td>
<p>the degree of the polynomial.</p>
</td></tr>
<tr><td><code id="covarExpand_+3A_treatment">treatment</code></td>
<td>
<p>treatment indicator</p>
</td></tr>
<tr><td><code id="covarExpand_+3A_exclude">exclude</code></td>
<td>
<p>list of covariate name pairs or triplets to be excluded.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of serially expanded covariates
</p>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>

<hr>
<h2 id='crossValidate'>Ridge Penalty Selection through Cross Validation</h2><span id='topic+crossValidate'></span>

<h3>Description</h3>

<p>Internal function called by <code>hbal</code> to select ridge penalties through cross-validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossValidate(
  group.alpha = NULL,
  penalty.pos = NULL,
  penalty.val = NULL,
  group.exact = NULL,
  grouping = NULL,
  folds = NULL,
  treatment = NULL,
  fold.co = NULL,
  fold.tr = NULL,
  coefs = NULL,
  control = NULL,
  constraint.tolerance = NULL,
  print.level = NULL,
  base.weight = NULL,
  full.t = NULL,
  full.c = NULL,
  shuffle.treat = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crossValidate_+3A_group.alpha">group.alpha</code></td>
<td>
<p>group.alpha. Controls degree of regularization.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_penalty.pos">penalty.pos</code></td>
<td>
<p>positions of user-supplied penalties.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_penalty.val">penalty.val</code></td>
<td>
<p>values of user-supplied penalties.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_group.exact">group.exact</code></td>
<td>
<p>binary indicator of whether each covariate group should be penalized.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_grouping">grouping</code></td>
<td>
<p>different groupings of the covariates.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_folds">folds</code></td>
<td>
<p>number of folds to perform cross validation.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_treatment">treatment</code></td>
<td>
<p>covariate matrix for treatment group.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_fold.co">fold.co</code></td>
<td>
<p>fold assignments for control units.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_fold.tr">fold.tr</code></td>
<td>
<p>fold assignments for treated units.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_coefs">coefs</code></td>
<td>
<p>starting coefficients (lambda).</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_control">control</code></td>
<td>
<p>covariate matrix for control group.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_constraint.tolerance">constraint.tolerance</code></td>
<td>
<p>tolerance level for imbalance.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_print.level">print.level</code></td>
<td>
<p>details of printed output.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_base.weight">base.weight</code></td>
<td>
<p>target weight distribution for the control units.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_full.t">full.t</code></td>
<td>
<p>(unresidualized) ovariate matrix for treatment group.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_full.c">full.c</code></td>
<td>
<p>(unresidualized) ovariate matrix for control group.</p>
</td></tr>
<tr><td><code id="crossValidate_+3A_shuffle.treat">shuffle.treat</code></td>
<td>
<p>whether to create folds for the treated units</p>
</td></tr>
</table>


<h3>Value</h3>

<p>group.alpha, lambda
</p>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>

<hr>
<h2 id='doubleSelection'>Double Selection</h2><span id='topic+doubleSelection'></span>

<h3>Description</h3>

<p>Internal function called by <code>hbal</code> to perform double selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doubleSelection(X, W, Y, grouping)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doubleSelection_+3A_x">X</code></td>
<td>
<p>covaraite matrix</p>
</td></tr>
<tr><td><code id="doubleSelection_+3A_w">W</code></td>
<td>
<p>treatment indicator</p>
</td></tr>
<tr><td><code id="doubleSelection_+3A_y">Y</code></td>
<td>
<p>outcome variable</p>
</td></tr>
<tr><td><code id="doubleSelection_+3A_grouping">grouping</code></td>
<td>
<p>groupings of covariates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>resX, penalty.list, covar.keep
</p>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>

<hr>
<h2 id='hbal'>Hierarchically Regularized Entropy Balancing</h2><span id='topic+hbal'></span>

<h3>Description</h3>

<p><code>hbal</code> performs hierarchically regularized entropy balancing 
such that the covariate distributions of the control group match those of the 
treatment group. <code>hbal</code> automatically expands the covariate space to include
higher order terms and uses cross-validation to select variable penalties for the 
balancing conditions.
</p>
<p>hbal performs hierarchically regularized entropy balancing such that the covariate distributions of the control group match those of the treatment group. hbal automatically expands the covariate space to include higher order terms and uses cross-validation to select variable penalties for the balancing conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hbal(data, Treat, X, Y = NULL, w = NULL, 
     X.expand = NULL, X.keep = NULL, expand.degree = 1,
     coefs = NULL, max.iterations = 200, cv = NULL, folds = 4,
     ds = FALSE, group.exact = NULL, group.alpha = NULL,
     term.alpha = NULL, constraint.tolerance = 1e-3, print.level = 0,
     grouping = NULL, group.labs = NULL, linear.exact = TRUE, shuffle.treat = TRUE,
     exclude = NULL,force = FALSE, seed = 94035)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hbal_+3A_data">data</code></td>
<td>
<p>a dataframe that contains the treatment, outcome, and covariates.</p>
</td></tr>
<tr><td><code id="hbal_+3A_treat">Treat</code></td>
<td>
<p>a character string of the treatment variable.</p>
</td></tr>
<tr><td><code id="hbal_+3A_x">X</code></td>
<td>
<p>a character vector of covariate names to balance on.</p>
</td></tr>
<tr><td><code id="hbal_+3A_y">Y</code></td>
<td>
<p>a character string of the outcome variable.</p>
</td></tr>
<tr><td><code id="hbal_+3A_w">w</code></td>
<td>
<p>a character string of the weighting variable for base weights</p>
</td></tr>
<tr><td><code id="hbal_+3A_x.expand">X.expand</code></td>
<td>
<p>a character vector of covariate names for serial expansion.</p>
</td></tr>
<tr><td><code id="hbal_+3A_x.keep">X.keep</code></td>
<td>
<p>a character vector of covariate names to keep regardless of whether they are selected in double selection.</p>
</td></tr>
<tr><td><code id="hbal_+3A_expand.degree">expand.degree</code></td>
<td>
<p>degree of series expansion. 1 means no expansion. Default is 1.</p>
</td></tr>
<tr><td><code id="hbal_+3A_coefs">coefs</code></td>
<td>
<p>initial coefficients for the reweighting algorithm (lambdas).</p>
</td></tr>
<tr><td><code id="hbal_+3A_max.iterations">max.iterations</code></td>
<td>
<p>maximum number of iterations. Default is 200.</p>
</td></tr>
<tr><td><code id="hbal_+3A_cv">cv</code></td>
<td>
<p>whether to use cross validation. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="hbal_+3A_folds">folds</code></td>
<td>
<p>number of folds for cross validation. Only used when cv is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="hbal_+3A_ds">ds</code></td>
<td>
<p>whether to perform double selection prior to balancing. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hbal_+3A_group.exact">group.exact</code></td>
<td>
<p>binary indicator of whether each covariate group should be exact balanced.</p>
</td></tr>
<tr><td><code id="hbal_+3A_group.alpha">group.alpha</code></td>
<td>
<p>penalty for each covariate group</p>
</td></tr>
<tr><td><code id="hbal_+3A_term.alpha">term.alpha</code></td>
<td>
<p>named vector of ridge penalties, only takes 0 or 1.</p>
</td></tr>
<tr><td><code id="hbal_+3A_constraint.tolerance">constraint.tolerance</code></td>
<td>
<p>tolerance level for overall imbalance. Default is 1e-3.</p>
</td></tr>
<tr><td><code id="hbal_+3A_print.level">print.level</code></td>
<td>
<p>details of printed output.</p>
</td></tr>
<tr><td><code id="hbal_+3A_grouping">grouping</code></td>
<td>
<p>different groupings of the covariates. Must be specified if expand is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="hbal_+3A_group.labs">group.labs</code></td>
<td>
<p>labels for user-supplied groups</p>
</td></tr>
<tr><td><code id="hbal_+3A_linear.exact">linear.exact</code></td>
<td>
<p>seek exact balance on the level terms</p>
</td></tr>
<tr><td><code id="hbal_+3A_shuffle.treat">shuffle.treat</code></td>
<td>
<p>whether to use cross-validation on the treated units. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="hbal_+3A_exclude">exclude</code></td>
<td>
<p>list of covariate name pairs or triplets to be excluded.</p>
</td></tr>
<tr><td><code id="hbal_+3A_force">force</code></td>
<td>
<p>binary indicator of whether to expand covariates when there are too many</p>
</td></tr>
<tr><td><code id="hbal_+3A_seed">seed</code></td>
<td>
<p>random seed to be set. Set random seed when cv=<code>TRUE</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the simplest set-up, user can just pass in {Treatment, X, Y}. The default settings will serially expand
X to include higher order terms, hierarchically residualize these terms, perform double selection to only keep the relevant
variables and use cross-validation to select penalities for different groupings of the covariates.
</p>


<h3>Value</h3>

<p>An list object of class <code>hbal</code> with the following elements:
</p>
<table role = "presentation">
<tr><td><code>coefs</code></td>
<td>
<p>vector that contains coefficients from the reweighting algorithm.</p>
</td></tr>
<tr><td><code>mat</code></td>
<td>
<p>matrix of serially expanded covariates if expand=<code>TRUE</code>. Otherwise, the original covariate matrix is returned.</p>
</td></tr>
<tr><td><code>penalty</code></td>
<td>
<p>vector of ridge penalties used for each covariate</p>
</td></tr> 
<tr><td><code>weights</code></td>
<td>
<p>vector that contains the control group weights assigned by hbal.</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>vector of treatment status</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>vector of outcome</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>
<p>Yiqing Xu &lt;yiqingxu@stanford.edu&gt;, Eddie Yang &lt;z5yang@ucsd.edu&gt;
</p>


<h3>References</h3>

<p>Xu, Y., &amp; Yang, E. (2022). Hierarchically Regularized Entropy Balancing. Political Analysis, 1-8. doi:10.1017/pan.2022.12
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
set.seed(1984)
N &lt;- 500
X1 &lt;- rnorm(N)
X2 &lt;- rbinom(N,size=1,prob=.5)
X &lt;- cbind(X1, X2)
treat &lt;- rbinom(N, 1, prob=0.5) # Treatment indicator
y &lt;- 0.5 * treat + X[,1] + X[,2] + rnorm(N) # Outcome
dat &lt;- data.frame(treat=treat, X, Y=y)
out &lt;- hbal(Treat = 'treat', X = c('X1', 'X2'), Y = 'Y', data=dat)
summary(hbal::att(out))

# Example 2
## Simulation from Kang and Shafer (2007).
library(MASS)
set.seed(1984)
n &lt;- 500
X &lt;- mvrnorm(n, mu = rep(0, 4), Sigma = diag(4))
prop &lt;- 1 / (1 + exp(X[,1] - 0.5 * X[,2] + 0.25*X[,3] + 0.1 * X[,4]))
# Treatment indicator
treat &lt;- rbinom(n, 1, prop)
# Outcome
y &lt;- 210 + 27.4*X[,1] + 13.7*X[,2] + 13.7*X[,3] + 13.7*X[,4] + rnorm(n)
# Observed covariates
X.mis &lt;- cbind(exp(X[,1]/2), X[,2]*(1+exp(X[,1]))^(-1)+10, 
    (X[,1]*X[,3]/25+.6)^3, (X[,2]+X[,4]+20)^2)
dat &lt;- data.frame(treat=treat, X.mis, Y=y)
out &lt;- hbal(Treat = 'treat', X = c('X1', 'X2', 'X3', 'X4'), Y='Y', data=dat)
summary(att(out))
</code></pre>

<hr>
<h2 id='hbal-data'>Data from Black and Owens (2016) and Hazlett (2020)</h2><span id='topic+hbal-data'></span>

<h3>Description</h3>

<p>The contenderJudges dataset is from Black and Owens (2016): Courting the president: how circuit court judges alter their behavior for promotion to the Supreme Court
This dataset includes 10,171 period-judge observations for a total of 68 judges.
The treatment variable of interest is <code>treatFinal0</code>, which indicates whether there was a vacancy in the Supreme Court
The outcome of interest is ideological alignment of judges' votes with the sitting President (<code>presIdeoVote</code>).
The remaining variables are characteristics of the judges and courts, to be used as controls.
</p>
<p>The LaLonde dataset has treated units from Dehejia and Wahba (1999), containing 185 individuals; data on the control units is from Panel Study
of Income Dynamics (PSID-1), containing 2,490 individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hbal)
</code></pre>


<h3>Source</h3>


<ul>
<li><p> Black, R. C., and Owens, R. J. (2016). Courting the president: how circuit court judges alter their behavior for promotion to the Supreme Court. American Journal of Political Science, 60(1), 30-43.
</p>
</li>
<li><p> Dehejia, R. H., and Wahba, S. (1999). Causal effects in nonexperimental studies: Reevaluating the evaluation of training programs. Journal of the American statistical Association, 94(448), 1053-1062.
</p>
</li>
<li><p> Hazlett, C. (2020). KERNEL BALANCING. Statistica Sinica, 30(3), 1155-1189.
</p>
</li></ul>


<hr>
<h2 id='lalonde'>Data from Hazlett (2020)</h2><span id='topic+lalonde'></span>

<h3>Description</h3>

<p>Data on the treated units is from Dehejia and Wahba (1999), containing 185 individuals; data on the control units is from Panel Study
of Income Dynamics (PSID-1), containing 2,490 individuals.
</p>


<h3>Format</h3>

<p>A data frame with 2675 rows and 13 columns.
</p>

<dl>
<dt>nsw</dt><dd><p>treatment indicator of whether an individual participated in the National Supported Work (NSW) program</p>
</dd>
<dt>age</dt><dd></dd>
<dt>educ</dt><dd><p>years of education</p>
</dd>
<dt>black</dt><dd><p>demographic indicator variables for Black</p>
</dd>
<dt>hisp</dt><dd><p>idemographic indicator variables for Hispanic</p>
</dd>
<dt>married</dt><dd><p>demographic indicator variables for married</p>
</dd>
<dt>re74</dt><dd><p>real earnings in 1974</p>
</dd>
<dt>re75</dt><dd><p>real earnings in 1975</p>
</dd>
<dt>re78</dt><dd><p>real earnings in 1978, outcome</p>
</dd>
<dt>u74</dt><dd><p>unemployment indicator for 1974</p>
</dd>
<dt>u75</dt><dd><p>unemployment indicator for 1975</p>
</dd>
<dt>u78</dt><dd><p>unemployment indicator for 1978</p>
</dd>
<dt>nodegr</dt><dd><p>indicator for no high school degree</p>
</dd>
</dl>



<h3>References</h3>


<ul>
<li><p> Dehejia, R. H., and Wahba, S. (1999). Causal effects in nonexperimental studies: Reevaluating the evaluation of training programs. Journal of the American statistical Association, 94(448), 1053-1062.
</p>
</li>
<li><p> Hazlett, C. (2020). KERNEL BALANCING. Statistica Sinica, 30(3), 1155-1189.
</p>
</li></ul>


<hr>
<h2 id='plot.hbal'>Plotting Covariate Balance from an <code>hbal</code> Object</h2><span id='topic+plot.hbal'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>This function plots the covariate difference between the control and treatment groups in standardized means before and after weighting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hbal'
plot(x, type = 'balance', log = TRUE, base_size = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.hbal_+3A_x">x</code></td>
<td>
<p>an object of class <code>hbalobject</code> as returned by <code>hbal</code>.</p>
</td></tr>
<tr><td><code id="plot.hbal_+3A_type">type</code></td>
<td>
<p>type of graph to plot.</p>
</td></tr>
<tr><td><code id="plot.hbal_+3A_log">log</code></td>
<td>
<p>log scale for the weight plot</p>
</td></tr>
<tr><td><code id="plot.hbal_+3A_base_size">base_size</code></td>
<td>
<p>base font size</p>
</td></tr>
<tr><td><code id="plot.hbal_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>plot.hbal()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of ggplots of covariate balance by group
</p>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>

<hr>
<h2 id='summary.hbal'>Summarizing from an <code>hbal</code> Object</h2><span id='topic+summary.hbal'></span><span id='topic+summary'></span>

<h3>Description</h3>

<p>This function prints a summary from an <code>hbal</code> Object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hbal'
summary(object, print.level = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.hbal_+3A_object">object</code></td>
<td>
<p>an object of class <code>hbalobject</code> as returned by <code>hbal</code>.</p>
</td></tr>
<tr><td><code id="summary.hbal_+3A_print.level">print.level</code></td>
<td>
<p>level of details to be printed</p>
</td></tr>
<tr><td><code id="summary.hbal_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>summary.hbal()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a summary table
</p>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>

<hr>
<h2 id='updateCoef'>Update lambda</h2><span id='topic+updateCoef'></span>

<h3>Description</h3>

<p>Internal function called by <code>hbal</code> to residualize covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateCoef(old.coef, new.coef, counter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateCoef_+3A_old.coef">old.coef</code></td>
<td>
<p>previous coefficients</p>
</td></tr>
<tr><td><code id="updateCoef_+3A_new.coef">new.coef</code></td>
<td>
<p>new coefficients</p>
</td></tr>
<tr><td><code id="updateCoef_+3A_counter">counter</code></td>
<td>
<p>which fold in CV</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated coefficients
</p>


<h3>Author(s)</h3>

<p>Yiqing Xu, Eddie Yang
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
