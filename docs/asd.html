<!DOCTYPE html><html><head><title>Help for package asd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {asd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#asd-package'><p>Simulation Tools for Adaptive Seamless Design (ASD)</p></a></li>
<li><a href='#combn.test'>
<p>Combination Tests for ASD</p></a></li>
<li><a href='#dunnett.test'>
<p>Dunnett Test</p></a></li>
<li><a href='#gsubpop.sim'>
<p>ASD simulation for subpopulation selection</p></a></li>
<li><a href='#gtreatsel.sim'>
<p>ASD simulation for treatment selection</p></a></li>
<li><a href='#hyp.test'>
<p>Closed Testing for ASD</p></a></li>
<li><a href='#select.rule'>
<p>Selection Rules for Interim Analysis in ASD</p></a></li>
<li><a href='#simeans.binormal'>
<p>Simulate Bivariate Normal Means</p></a></li>
<li><a href='#subpop.sim'>
<p>ASD simulation for subpopulation selection</p></a></li>
<li><a href='#treatsel.sim'>
<p>ASD simulation for treatment selection</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulations for Adaptive Seamless Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-05-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Nick Parsons</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nick Parsons &lt;nick.parsons@warwick.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>Description:</td>
<td>Package runs simulations for adaptive seamless designs with and without early outcomes 
                           for treatment selection and subpopulation type designs.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-05-23 06:58:58 UTC; mlsgbf</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-05-23 10:14:13</td>
</tr>
</table>
<hr>
<h2 id='asd-package'>Simulation Tools for Adaptive Seamless Design (ASD)</h2><span id='topic+asd-package'></span><span id='topic+asd'></span>

<h3>Description</h3>

<p>Functions to run simulations for trial designs that either (i) test a number of experimental treatments against a single control treatment group in a seamless adaptive trial or (ii) test an experimental treatment against a single control treatment group in a seamless adaptive trial with co-primary analyses in a pre-defined subgroup and the full population.<br />
In setting (i) test treatments are compared to the control treatment using Dunnett's many-to-one testing procedure, with an interim analysis undertaken using an early outcome measure. A decision is made on which of the treatments to take forward using a pre-defined selection rule. Data are simulated for the final outcome measure that is correlated with the early outcome measure. Data from the interim and final analyses for the final outcome measure are combined together using either the inverse normal or Fisher combination test and hypotheses are either rejected or accepted after controlling the familywise error rate at the selected level.<br />
In setting (ii) an interim analysis is undertaken using an early outcome measure and a decision is made on whether to continue with both full and subpopulations, the subpopulation only or the full population, using a pre-defined selection rule. A number of different methods to control the family wise error rate are implemented. Data are simulated for the early and final outcome measures, subpopulation prevalence and correlation between the final and the early outcomes.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> asd</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-05-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Simulations are run using the functions (i) <code><a href="#topic+treatsel.sim">treatsel.sim</a></code> and (ii) <code><a href="#topic+subpop.sim">subpop.sim</a></code>. The other functions are not generally to be called by the user.
</p>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Some useful references to adaptive designs and more specifically to the methodology described here:<br />
</p>
<p>Thall PF, Simon R, Ans Ellenberg SS. A two-stage design for choosing amongst several experimental treatments and a control in clinical trials. <em>Biometrics</em> 1988;45:537-547.<br />
</p>
<p>Thall PF, Simon, R, Ans Ellenberg SS. Two-stage selection and testing designs for comparative clinical trials. <em>Biometrika</em> 1989;75,303-310.<br />
</p>
<p>Bauer P, Kieser M. Combining different phases in the development of medical treatments within a single trial. <em>Statistics in Medicine</em> 1999;18:1833-1848.<br />
</p>
<p>Stallard N, Todd S. Sequential designs for phase II and phase III clinical trials incorporating treatment selection. <em>Statistics in Medicine</em> 2003;22:689-703.<br />
</p>
<p>Posch M, Koenig F, Branson M, Brannath W, Dunger-Baldauf C, Bauer P. Testing and estimation in flexible group sequential designs with adaptive treatment selection. <em>Statistics in Medicine</em> 2005;24:3697-3714.<br />
</p>
<p>Bretz F, Schmidli H, Koenig F, Racine A, Maurer W. Confirmatory seamless phase II/III clinical trials with hypotheses selection at interim: General concepts. <em>Biometrical Journal</em> 2006;48:623-634.<br />
</p>
<p>Koenig F, Brannath W, Bretz F, Posch M. Adaptive Dunnett tests for treatment selection. <em>Statistics in Medicine</em> 2008;27:1612-1625.<br />
</p>
<p>Stallard N, Friede T. A group-sequential design for clinical trials with treatment selection. <em>Statistics in Medicine</em> 2008;27:6209-6227.<br />
</p>
<p>Friede T, Parsons N, Stallard N, Todd S, Valdes Marquez E, Chataway J, Nicholas R. Designing a Seamless Phase II/III Clinical Trial using Early Outcomes for Treatment Selection: an Application in Multiple Sclerosis. <em>Statistics in Medicine</em> 2011;30:1528-1540.<br />
</p>
<p>Parsons N, Friede T, Todd S, Valdes Marquez E, Chataway J, Nicholas R, Stallard N. An R package for implementing simulations for seamless phase II/III clinicals trials using early outcomes for treatment selection. <em>Computational Statistics and Data Analysis</em> 2012;56:1150-1160.<br />
</p>
<p>Friede T, Parsons N, Stallard N. A conditional error function approach for subgroup selection in adaptive clinical trials. <em>Statistics in Medicine</em> 2012;31:4309-4320.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+treatsel.sim">treatsel.sim</a></code>, <code><a href="#topic+subpop.sim">subpop.sim</a></code>
</p>

<hr>
<h2 id='combn.test'>
Combination Tests for ASD
</h2><span id='topic+combn.test'></span>

<h3>Description</h3>

<p>Implements weighted inverse normal and Fisher combination tests for combining <em>p</em>-values for adaptive seamless designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combn.test(stage1, stage2, weight = 0.5, method = "invnorm")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combn.test_+3A_stage1">stage1</code></td>
<td>

<p>Output from function <code>dunnett.test</code> from stage 1 of an ASD
</p>
</td></tr>
<tr><td><code id="combn.test_+3A_stage2">stage2</code></td>
<td>

<p>Output from function <code>dunnett.test</code> from stage 2 of an ASD
</p>
</td></tr>
<tr><td><code id="combn.test_+3A_weight">weight</code></td>
<td>

<p>Weight indicating how <em>p</em>-values from stages 1 and 2 are combined; default weight is 0.5 indicating equal weighting between stages (0&lt;<code>weight</code>&lt;1)
</p>
</td></tr>
<tr><td><code id="combn.test_+3A_method">method</code></td>
<td>

<p>Select combination test method; available options are &ldquo;<code>invnorm</code>&rdquo; or &ldquo;<code>fisher</code>&rdquo;, with default &ldquo;<code>invnorm</code>&rdquo;
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic ideas of the combination test approach were proposed by Bauer and Kieser (1999) and make use of a combination function (Bauer and Kohne, 1994) to combine stagewise <em>p</em>-values to allow for interim adaptations and the application of the closed test principle (Marcus <em>et al.</em>, 1976) to control the overall test size across multiple hypotheses.
</p>


<h3>Value</h3>

<table>
<tr><td><code>method</code></td>
<td>
<p>Selected method of combining <em>p</em>-values</p>
</td></tr>
<tr><td><code>zscores</code></td>
<td>
<p>Z-scores for each hypothesis</p>
</td></tr>
<tr><td><code>hyp.comb</code></td>
<td>
<p>A list of matrices indicating the structure of the intersection hypotheses</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Weights used for each stage</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Bauer P, Kieser M. Combining different phases in the development of medical treatments within a single trial. <em>Statistics in Medicine</em> 1999;18:1833-1848.<br />
</p>
<p>Bauer P, Kohne K. Evaluation of experiments with adaptive interim analyses. <em>Biometrics</em> 1994;50:1029-1041.<br />
</p>
<p>Marcus R, Peritz E, Gabriel KR. On closed testing procedures with special reference to ordered analysis of variance. <em>Biometrika</em> 1976;63:655-660.<br />
</p>
<p>Lehmacher W, Wassmer G. Adaptive sample size calculations in group sequential trials. <em>Biometrics</em> 1999;55:1286-1290.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+treatsel.sim">treatsel.sim</a></code>, <code><a href="#topic+dunnett.test">dunnett.test</a></code>, <code><a href="#topic+hyp.test">hyp.test</a></code>, <code><a href="#topic+select.rule">select.rule</a></code>, <code><a href="#topic+simeans.binormal">simeans.binormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
stage1 &lt;- dunnett.test(c(0.75,1.5,2.25))
stage2 &lt;- dunnett.test(c(0.15,1.75,2.15))
combn.test(stage1,stage2,weight=0.5,method="invnorm")

</code></pre>

<hr>
<h2 id='dunnett.test'>
Dunnett Test
</h2><span id='topic+dunnett.test'></span>

<h3>Description</h3>

<p>Implements Dunnett's test (Dunnett, 1955) for many-to-one comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dunnett.test(Z = Z, select = rep(1, length(Z)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dunnett.test_+3A_z">Z</code></td>
<td>

<p>A vector of test statistics
</p>
</td></tr>
<tr><td><code id="dunnett.test_+3A_select">select</code></td>
<td>

<p>A vector of length <code>Z</code>; to include treatments set values to one and to exclude treatments set values to zero
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A many-to-one comparison test for the the null hypothesis that all the treatment effects are equal to zero against the alternative that at least one is larger than zero.
</p>


<h3>Value</h3>

<table>
<tr><td><code>pvalues</code></td>
<td>
<p>A list of matrices of <em>p</em>-values for all intersection hypotheses</p>
</td></tr>
<tr><td><code>zscores</code></td>
<td>
<p>A list of matrices of z-scores for all intersection hypotheses</p>
</td></tr>
<tr><td><code>hyp.comb</code></td>
<td>
<p>A list of matrices indicating the structure of the intersection hypotheses</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Dunnett CW. A multiple comparison procedure for comparing several treatments with a control. <em>Journal of the American Statistical Association</em> 1955;50:1096-1121.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+treatsel.sim">treatsel.sim</a></code>, <code><a href="#topic+combn.test">combn.test</a></code>, <code><a href="#topic+hyp.test">hyp.test</a></code>, <code><a href="#topic+select.rule">select.rule</a></code>, <code><a href="#topic+simeans.binormal">simeans.binormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dunnett.test(c(0.75,1.5,2.25))

# select two treatments only
dunnett.test(c(0.75,1.5,2.25),select=c(1,1,0))

# set test statistic to -Inf
dunnett.test(c(0.75,1.5,-Inf))

</code></pre>

<hr>
<h2 id='gsubpop.sim'>
ASD simulation for subpopulation selection
</h2><span id='topic+gsubpop.sim'></span>

<h3>Description</h3>

<p>Function <code>subpop.sim</code>  runs simulations for a trial design that tests an experimental treatment against a single control treatment group in a seamless adaptive trial with co-primary analyses in a pre-defined subgroup and the full population. An interim analysis is undertaken using an early outcome measure and a decision is made on whether to continue with both full and subpopulations, the subpopulation only or the full population, using a pre-defined selection rule. A number of different methods to control the family wise error rate are implemented; (i) the treatment is compared to the control in the subpopulation and full populations using Simes test and the inverse normal combination function used to combine p-values before and after design adaptation, (ii) as (i) but the bivariate normal method of Spiessens and Debois (2010) is used to control the type I error rate, (iii) as (i) but a Bonferroni test is used and (iv) a conditional error function approach using the Spiessens and Debois test. Data are simulated for the early and final outcome measures, subpopulation prevalence and correlation between the final and the early outcomes. 
This function should not generally be called by the user. The more user-friendly function <code><a href="#topic+subpop.sim">subpop.sim</a></code> covers most common applications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gsubpop.sim(z.early=NULL,z1=z1,z2=z2,sprev=sprev,
        corr=NULL,selim=NULL,nsim=nsim,seed=12345678,
        level=level,select="thresh",wt=NULL,method="CT-SD")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gsubpop.sim_+3A_z.early">z.early</code></td>
<td>

<p>Vector of test statistics for early outcome subpopulation and full population i.e. c(sub, full)
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_z1">z1</code></td>
<td>

<p>Vector of test statistics for final outcome subpopulation and full population i.e. c(sub, full)
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_z2">z2</code></td>
<td>

<p>Vector of test statistics for final outcome subpopulation and full population, and subpopulation and full population when both are selected i.e. c(sub only, full only, sub, full)
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_sprev">sprev</code></td>
<td>

<p>Subpopulation prevalence
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_corr">corr</code></td>
<td>

<p>Correlation between early and final outcomes
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_selim">selim</code></td>
<td>

<p>Upper and lower limits for the difference between test statistics for the threshold rule
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulations (maximum=10,000,000)
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_seed">seed</code></td>
<td>

<p>Seed number
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_level">level</code></td>
<td>

<p>Test level (default=0.025)
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_select">select</code></td>
<td>

<p>Selection rule type; available options are &ldquo;<code>thresh</code>&rdquo; and &ldquo;<code>futility</code>&rdquo;
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_wt">wt</code></td>
<td>

<p>User set weight for combination test
</p>
</td></tr>
<tr><td><code id="gsubpop.sim_+3A_method">method</code></td>
<td>

<p>Test type; available options are &ldquo;<code>CT-Simes</code>&rdquo;,  &ldquo;<code>CT-SD</code>&rdquo;, &ldquo;<code>CT-Bonferroni</code>&rdquo; or &ldquo;<code>CEF</code>&rdquo;
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A structured description of the the methodology and the simulation model is given by Friede <em>et al.</em> (2012).
</p>


<h3>Value</h3>

<table>
<tr><td><code>results</code></td>
<td>
<p>Table of counts; (i) the number of times the subpopulation, full population or both population are selected (<code>n</code>), (ii) the number of times the subpopulation is rejected when either it alone or both populations are selected (<code>Hs</code>), (iii) the number of times the full population is rejected when either it alone or both populations are selected (<code>Hf</code>), (iv) the number of times both populations are rejected (<code>Hs+Hf</code>) and (v) the number of times the intersection hypothesis is rejected (<code>Hs+f</code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Spiessens B, Debois M. Adjusted significance levels for subgroup analysis in clinical trials. <em>Contemporary Clinical Trials</em> 2010;31:647-656.<br />
</p>
<p>Jenkins M, Stone A, Jennison C. An adaptive seamless phase II/III design for oncology trials with subpopulation selection using survival endpoints. <em>Pharmaceutical Statistics</em> 2011;10:347-356. <br />
</p>
<p>Friede T, Parsons N, Stallard N. A conditional error function approach for subgroup selection in adaptive clinical trials. <em>Statistics in Medicine</em> 2012;31:409-4320.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subpop.sim">subpop.sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
gsubpop.sim(z.early=c(-1,-1),z1=c(-1,-1),z2=c(-1,0,-1,0),sprev=c(0.5,0.5),
        corr=0.5,selim=c(-0.5,0.5),nsim=100,seed=12345678,level=0.025,
        select="thresh",wt=0.5,method="CT-SD")

</code></pre>

<hr>
<h2 id='gtreatsel.sim'>
ASD simulation for treatment selection
</h2><span id='topic+gtreatsel.sim'></span>

<h3>Description</h3>

<p>Function <code>treatsel.sim</code> runs simulations for a trial design that tests a number of experimental treatments against a single control treatment group in a seamless adaptive trial. Test treatments are compared to the control treatment using Dunnett's many-to-one testing procedure. An interim analysis is undertaken using an early outcome measure for each treatment (and control). A decision is made on which of the treatments to take forward, using a pre-defined selection rule. Data are simulated for the final outcome measure, and data from the interim and final analyses for the final outcome measure are combined together using either the inverse normal or Fisher combination test, and hypotheses tested at the selected level.
This function should not generally be called by the user. The more user-friendly function <code><a href="#topic+treatsel.sim">treatsel.sim</a></code> covers most common applications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtreatsel.sim(z1=c(0,0,0),z2=c(0,0,0),zearly=c(0,0,0),v1=c(1,1,1,1),
           v2=c(1,1,1,1),vearly=c(1,1,1,1),corr=0,weight=0.5,
           nsim=1000,seed=12345678,select=0,epsilon=1,thresh=1,
           level=0.025,ptest=seq(1:length(z1)),fu=FALSE,
           method="invnorm")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gtreatsel.sim_+3A_z1">z1</code></td>
<td>

<p>Vector of test statistics for the final outcome measure based on stage 1 data
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_z2">z2</code></td>
<td>

<p>Vector of test statistics for the final outcome measure based on stage 2 data
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_zearly">zearly</code></td>
<td>

<p>Vector of test statistics for the early outcome measure
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_v1">v1</code></td>
<td>

<p>Vector of variances for the final outcome measure based on stage 1 data; in format control treatment variance followed by the test treatment variances
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_v2">v2</code></td>
<td>

<p>Vector of variances for the final outcome measure based on stage 2 data; format as <code>v1</code>
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_vearly">vearly</code></td>
<td>

<p>Vector of variances for the early outcome measure; format as <code>v1</code>
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_corr">corr</code></td>
<td>

<p>Vector of correlations between the early and final outcome measures for the control and test treatments; format as <code>v1</code>
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_weight">weight</code></td>
<td>

<p>Weighting between stages 1 and 2; default is for equal weighting (0.5)
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulations (maximum=10,000,000)
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_seed">seed</code></td>
<td>

<p>Seed number
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_select">select</code></td>
<td>

<p>Selection rule type; 0 = select all treatments, 1 = select maximum, 2 = select maximum two, 3 = select maximum three, 4 = epsilon rule (select means within epsilon of maximum), 5 = randomly select  a single treatment and 6 = threshold rule (select means greater than or equal to threshold). See <code><a href="#topic+select.rule">select.rule</a></code>
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_epsilon">epsilon</code></td>
<td>

<p>For <code>select</code> = 4, set epsilon criterion
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_thresh">thresh</code></td>
<td>

<p>For <code>select</code> = 6, set threshold criterion
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_level">level</code></td>
<td>

<p>Test level (default=0.025)
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_ptest">ptest</code></td>
<td>

<p>Vector of treatment numbers for determining power; for example, c(1,2) will count rejections of one or both hypotheses for testing treatments 1 and 2 against control
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_fu">fu</code></td>
<td>

<p>Logical indicating whether patients from dropped treatments (after interim selection) should be followed-up; default <code>TRUE</code>
</p>
</td></tr>
<tr><td><code id="gtreatsel.sim_+3A_method">method</code></td>
<td>

<p>Select combination method; available options are &ldquo;<code>invnorm</code>&rdquo; or &ldquo;<code>fisher</code>&rdquo;, with default &ldquo;<code>invnorm</code>&rdquo;
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A structured description of the the methodology and the simulation model is given by Friede <em>et al.</em> (2011) and implementation by Parsons <em>et al.</em> (2012).
</p>


<h3>Value</h3>

<table>
<tr><td><code>count.total</code></td>
<td>
<p>Number of times one or more treatments are selected</p>
</td></tr>
<tr><td><code>select.total</code></td>
<td>
<p>Number of times each test treatment is selected</p>
</td></tr>
<tr><td><code>reject.total</code></td>
<td>
<p>Number of times each hypothesis is rejected</p>
</td></tr>
<tr><td><code>sim.reject</code></td>
<td>
<p>Number of times one or more of the treatments selected using <code>ptest</code> is rejected</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Friede T, Parsons N, Stallard N, Todd S, Valdes Marquez E, Chataway J, Nicholas R. Designing a Seamless Phase II/III Clinical Trial using Early Outcomes for Treatment Selection: an Application in Multiple Sclerosis. <em>Statistics in Medicine</em> 2011;30:1528-1540.<br />
</p>
<p>Parsons N, Friede T, Todd S, Valdes Marquez E, Chataway J, Nicholas R, Stallard N. An R package for implementing simulations for seamless phase II/III clinicals trials using early outcomes for treatment selection. <em>Computational Statistics and Data Analysis</em> 2012;56:1150-1160.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+treatsel.sim">treatsel.sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
gtreatsel.sim(z1=c(1,0,2),z2=c(1,0,2),zearly=c(1,0,1), 
    v1=c(1,1,1,1),v2=c(1,1,1,1),vearly=c(1,1,1,1), 
    corr=0,weight=0.25,nsim=100,seed=12345678,
    select=1,level=0.025,ptest = c(1:3),method="fisher")

</code></pre>

<hr>
<h2 id='hyp.test'>
Closed Testing for ASD
</h2><span id='topic+hyp.test'></span>

<h3>Description</h3>

<p>Implements the closure principle (Marcus <em>et al.</em>, 1976) for controlling the familywise type I error rate in ASD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyp.test(comb.test, level = level, full.hyp = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hyp.test_+3A_comb.test">comb.test</code></td>
<td>

<p>Output from function <code>combn.test</code>
</p>
</td></tr>
<tr><td><code id="hyp.test_+3A_level">level</code></td>
<td>

<p>Test level (default=0.025)
</p>
</td></tr>
<tr><td><code id="hyp.test_+3A_full.hyp">full.hyp</code></td>
<td>

<p>Logical indicating whether the full set of intersection hypotheses should be reported; default <code>FALSE</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to control the familywise type I error rate in the strong sense at the pre-specified level <code class="reqn">\alpha</code> the closure principle (Marcus <em>et al.</em>, 1976) is applied. This means that an individual null hypothesis is rejected if and only if all intersection hypotheses are also rejected at level <code class="reqn">\alpha</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>reject</code></td>
<td>
<p>Matrix indicating whether elementary hypotheses have been rejected</p>
</td></tr>
<tr><td><code>all.rejects</code></td>
<td>
<p>Matrix indicating rejections for each intersection hypothesis, if <code>full.hyp</code>=<code>TRUE</code></p>
</td></tr>
<tr><td><code>all.hyp</code></td>
<td>
<p>Matrix labelling each intersection hypothesis, if <code>full.hyp</code>=<code>TRUE</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Marcus R, Peritz E, Gabriel KR. On closed testing procedures with special reference to ordered analysis of variance. <em>Biometrika</em> 1976;63:655-660.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+treatsel.sim">treatsel.sim</a></code>,<code><a href="#topic+dunnett.test">dunnett.test</a></code>, <code><a href="#topic+combn.test">combn.test</a></code>, <code><a href="#topic+select.rule">select.rule</a></code>, <code><a href="#topic+simeans.binormal">simeans.binormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
stage1 &lt;- dunnett.test(c(0.75,1.5,2.25))
stage2 &lt;- dunnett.test(c(0.15,1.75,2.15))
comb.test &lt;- combn.test(stage1,stage2,weight=0.5)
hyp.test(comb.test,level=0.025,full.hyp=FALSE)

# more output
hyp.test(comb.test,level=0.025,full.hyp=TRUE)

</code></pre>

<hr>
<h2 id='select.rule'>
Selection Rules for Interim Analysis in ASD
</h2><span id='topic+select.rule'></span>

<h3>Description</h3>

<p>Function <code>select.rule</code> provides a number of options for selecting treatments at an interim analysis in ASD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.rule(x, type = 0, epsilon = 1, thresh = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.rule_+3A_x">x</code></td>
<td>

<p>Vector of test statistics.
</p>
</td></tr>
<tr><td><code id="select.rule_+3A_type">type</code></td>
<td>

<p>Decision rule type; 0, 1, 2, 3, 4, 5 or 6 (see below for details); default is 0.
</p>
</td></tr>
<tr><td><code id="select.rule_+3A_epsilon">epsilon</code></td>
<td>

<p>For <code>type</code> = 4, set epsilon criterion
</p>
</td></tr>
<tr><td><code id="select.rule_+3A_thresh">thresh</code></td>
<td>

<p>For <code>type</code> = 6, set threshold criterion
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are seven types of selction rule available:<br />
(0) Select all treatments<br />
(1) Select one treatment; largest value of <code>x</code><br />
(2) Select two treatments; two largest values of <code>x</code><br />
(3) Select three treatments; three largest values of <code>x</code><br />
(4) Epsilon rule; select all <code>x</code> within <code>epsilon</code> of maximum<br />
(5) Randomly select one treatment<br />
(6) Threshold rule; select all <code>x</code> larger than <code>thresh</code><br />
</p>


<h3>Value</h3>

<table>
<tr><td><code>select</code></td>
<td>
<p>Indicator vector that shows treatments selected (1) or not selected (0)</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Vector of same length as <code>select</code> set to -Inf if not selected and 0 otherwise. For use with function <code>dunnett.test</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+treatsel.sim">treatsel.sim</a></code>, <code><a href="#topic+dunnett.test">dunnett.test</a></code>, <code><a href="#topic+hyp.test">hyp.test</a></code>, <code><a href="#topic+combn.test">combn.test</a></code>, <code><a href="#topic+simeans.binormal">simeans.binormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# select maximum treatment
select.rule(x=c(5.3,5.2,1.3,4.5,-1.3),type=4,epsilon=1)

</code></pre>

<hr>
<h2 id='simeans.binormal'>
Simulate Bivariate Normal Means
</h2><span id='topic+simeans.binormal'></span>

<h3>Description</h3>

<p>Simulates bivariate normal means; for use with <code>asd.sim</code> and <code>gasd.sim</code> in ASD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simeans.binormal(n = n, means = means, vars = vars, corr = corr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simeans.binormal_+3A_n">n</code></td>
<td>

<p>Number of records used to calculate means
</p>
</td></tr>
<tr><td><code id="simeans.binormal_+3A_means">means</code></td>
<td>

<p>Vector of expected means for two samples
</p>
</td></tr>
<tr><td><code id="simeans.binormal_+3A_vars">vars</code></td>
<td>

<p>Vector of expected variances for two samples
</p>
</td></tr>
<tr><td><code id="simeans.binormal_+3A_corr">corr</code></td>
<td>

<p>Correlation between two samples
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses function <code>rmvnorm</code> from package <code>mvtnorm</code> to generate means from correlated normal variates.
</p>


<h3>Value</h3>

<table>
<tr><td><code>samp1</code></td>
<td>
<p>Mean of sample 1</p>
</td></tr>
<tr><td><code>samp2</code></td>
<td>
<p>Mean of sample 2</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+treatsel.sim">treatsel.sim</a></code>, <code><a href="#topic+dunnett.test">dunnett.test</a></code>, <code><a href="#topic+hyp.test">hyp.test</a></code>, <code><a href="#topic+select.rule">select.rule</a></code>, <code><a href="#topic+combn.test">combn.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# need to load mvtnorm
library(mvtnorm)

# generate data
set.seed(1234)
simeans.binormal(n=10,means=c(2,3),vars=c(1,5),corr=0.5)

</code></pre>

<hr>
<h2 id='subpop.sim'>
ASD simulation for subpopulation selection
</h2><span id='topic+subpop.sim'></span>

<h3>Description</h3>

<p>Function <code>subpop.sim</code>  runs simulations for a trial design that tests an experimental treatment against a single control treatment group in a seamless adaptive trial with co-primary analyses in a pre-defined subgroup and the full population. An interim analysis is undertaken using an early outcome measure and a decision is made on whether to continue with both full and subpopulations, the subpopulation only or the full population, using a pre-defined selection rule. A number of different methods to control the family wise error rate are implemented; (i) the treatment is compared to the control in the subpopulation and full populations using Simes test and the inverse normal combination function used to combine p-values before and after design adaptation, (ii) as (i) but the bivariate normal method of Spiessens and Debois (2010) is used to control the type I error rate, (iii) as (i) but a Bonferroni test is used and (iv) a conditional error function approach using the Spiessens and Debois test. Data are simulated for the early and final outcome measures, subpopulation prevalence and correlation between the final and the early outcomes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subpop.sim(n=list(stage1=32,enrich=NULL,stage2=32),
          effect=list(early=c(0,0),final=c(0, 0)),
          outcome=list(early="N",final="N"),
          control=list(early=NULL,final=NULL),sprev=0.5,
          nsim=1000,corr=0,seed=12345678,select="thresh",
          weight=NULL,selim=NULL,level=0.025,method="CT-SD",
          sprev.fixed=TRUE,file="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subpop.sim_+3A_n">n</code></td>
<td>

<p>List giving sample sizes for each treatment group at stage 1 (interim) and stage 2 (final) analyses; <code>enrich</code> allows for sample size modifications if the subgroup only is selected at stage 1
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_effect">effect</code></td>
<td>

<p>List giving effect sizes for early and final outcomes
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_outcome">outcome</code></td>
<td>

<p>List giving outcome type for early and final outcomes; available options are &ldquo;<code>N</code>&rdquo;, &ldquo;<code>T</code>&rdquo; and &ldquo;<code>B</code>&rdquo;, for normal, time-to-event and binary data
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_control">control</code></td>
<td>

<p>Optional list giving effect sizes for early and final outcomes
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_sprev">sprev</code></td>
<td>

<p>Subpopulation prevalence
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulations (maximum=10,000,000)
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_corr">corr</code></td>
<td>

<p>Correlation between early and final outcomes
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_seed">seed</code></td>
<td>

<p>Seed number
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_select">select</code></td>
<td>

<p>Selection rule type;  available options are &ldquo;<code>thresh</code>&rdquo; and &ldquo;<code>futility</code>&rdquo;
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_weight">weight</code></td>
<td>

<p>Optional user set weight for combination test; default is to use those suggested by Jenkins <em>et al.</em> (2011)
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_selim">selim</code></td>
<td>

<p>Upper and lower limits for the difference between test statistics for the threshold rule
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_level">level</code></td>
<td>

<p>Test level (default=0.025)
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_method">method</code></td>
<td>

<p>Test type; available options are &ldquo;<code>CT-Simes</code>&rdquo;,  &ldquo;<code>CT-SD</code>&rdquo;, &ldquo;<code>CT-Bonferroni</code>&rdquo; or &ldquo;<code>CEF</code>&rdquo;
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_sprev.fixed">sprev.fixed</code></td>
<td>

<p>Logical indicating whether subpopulation prevalence is fixed at each simulation; default <code>TRUE</code>
</p>
</td></tr>
<tr><td><code id="subpop.sim_+3A_file">file</code></td>
<td>

<p>File name to dump output; if unset will default to R console
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A structured description of the the methodology and the simulation model is given by Friede <em>et al.</em> (2012).
</p>


<h3>Value</h3>

<table>
<tr><td><code>results</code></td>
<td>
<p>Table of counts; (i) the number of times the subpopulation, full population or both population are selected (<code>n</code>), (ii) the number of times the subpopulation is rejected when either it alone or both populations are selected (<code>Hs</code>), (iii) the number of times the full population is rejected when either it alone or both populations are selected (<code>Hf</code>), (iv) the number of times both populations are rejected (<code>Hs+Hf</code>) and (v) the number of times the intersection hypothesis is rejected (<code>Hs+f</code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Spiessens B, Debois M. Adjusted significance levels for subgroup analysis in clinical trials. <em>Contemporary Clinical Trials</em> 2010;31:647-656.<br />
</p>
<p>Jenkins M, Stone A, Jennison C. An adaptive seamless phase II/III design for oncology trials with subpopulation selection using survival endpoints. <em>Pharmaceutical Statistics</em> 2011;10:347-356. <br />
</p>
<p>Friede T, Parsons N, Stallard N. A conditional error function approach for subgroup selection in adaptive clinical trials. <em>Statistics in Medicine</em> 2012;31:409-4320.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gsubpop.sim">gsubpop.sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# hazard ratio in subgroup = 0.6 and full population = 0.9
# for both early and final time-to-event outcomes
# subgroup prevalence = 0.3 and correlation = 0.5
# futility stopping rule, with limits 0 and 0
subpop.sim(n=list(stage1=100,enrich=200,stage2=300),
           effect=list(early=c(0.6,0.9),final=c(0.6,0.9)),
           sprev=0.3,outcome=list(early="T",final="T"),nsim=100,
           corr=0.5,seed=1234,select="futility",weight=NULL,
           selim=c(0,0),level=0.025,method="CT-SD",file="")

</code></pre>

<hr>
<h2 id='treatsel.sim'>
ASD simulation for treatment selection
</h2><span id='topic+treatsel.sim'></span>

<h3>Description</h3>

<p>Function <code>treatsel.sim</code> runs simulations for a trial design that tests a number of experimental treatments against a single control treatment group in a seamless adaptive trial. Test treatments are compared to the control treatment using Dunnett's many-to-one testing procedure. An interim analysis is undertaken using an early outcome measure for each treatment (and control). A decision is made on which of the treatments to take forward, using a pre-defined selection rule. Data are simulated for the final outcome measure, and data from the interim and final analyses for the final outcome measure are combined together using either the inverse normal or Fisher combination test, and hypotheses tested at the selected level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treatsel.sim(n=list(stage1=32,stage2=32),
             effect=list(early=c(0,0,0),final=c(0,0,0)),
             outcome=list(early="N",final="N"),nsim=1000,
             corr=0,seed=12345678,select=0,epsilon=1,
             weight=NULL,thresh=1,level=0.025,ptest=c(1),
             method="invnorm",fu=FALSE,file = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="treatsel.sim_+3A_n">n</code></td>
<td>

<p>List giving sample sizes for each treatment group at stage 1 (interim) and stage 2 (final) analyses
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_effect">effect</code></td>
<td>

<p>List giving effect sizes for early and final outcomes
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_outcome">outcome</code></td>
<td>

<p>List giving outcome type for early and final outcomes; available options are &ldquo;<code>N</code>&rdquo;, &ldquo;<code>T</code>&rdquo; and &ldquo;<code>B</code>&rdquo;, for normal, time-to-event and binary data
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulations (maximum=10,000,000)
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_corr">corr</code></td>
<td>

<p>Correlation between early and final outcomes
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_seed">seed</code></td>
<td>

<p>Seed number
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_select">select</code></td>
<td>

<p>Selection rule type (<code><a href="#topic+select.rule">select.rule</a></code>); 0 = select all treatments, 1 = select maximum, 2 = select maximum two, 3 = select maximum three, 4 = epsilon rule (select means within epsilon of maximum), 5 = randomly select  a single treatment and 6 = threshold rule (select means greater than or equal to threshold)
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_epsilon">epsilon</code></td>
<td>

<p>For <code>select</code> = 4, set epsilon criterion
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_weight">weight</code></td>
<td>

<p>Optional user set weight for combination test; default is to use those suggested by Jenkins <em>et al.</em> (2011)
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_thresh">thresh</code></td>
<td>

<p>For <code>select</code> = 6, set threshold criterion
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_level">level</code></td>
<td>

<p>Test level (default=0.025)
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_ptest">ptest</code></td>
<td>

<p>Vector of treatment numbers for determining power; for example, c(1,2) will count rejections of one or both hypotheses for testing treatments 1 and 2 against the control
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_method">method</code></td>
<td>

<p>Select combination method; available options are &ldquo;<code>invnorm</code>&rdquo; or &ldquo;<code>fisher</code>&rdquo;, with default &ldquo;<code>invnorm</code>&rdquo;.
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_fu">fu</code></td>
<td>

<p>Logical indicating whether patients from dropped treatments (after interim selection) should be followed-up; default <code>FALSE</code>
</p>
</td></tr>
<tr><td><code id="treatsel.sim_+3A_file">file</code></td>
<td>

<p>File name to dump output; if unset will default to R console
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A structured description of the the methodology and the simulation model is given by Friede <em>et al.</em> (2011) and implementation by Parsons <em>et al.</em> (2012).
</p>


<h3>Value</h3>

<table>
<tr><td><code>count.total</code></td>
<td>
<p>Number of times one or more treatments are selected</p>
</td></tr>
<tr><td><code>select.total</code></td>
<td>
<p>Number of times each test treatment is selected</p>
</td></tr>
<tr><td><code>reject.total</code></td>
<td>
<p>Number of times each hypothesis is rejected</p>
</td></tr>
<tr><td><code>sim.reject</code></td>
<td>
<p>Number of times one or more of the treatments selected using <code>ptest</code> is rejected</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Friede T, Parsons N, Stallard N, Todd S, Valdes Marquez E, Chataway J, Nicholas R. Designing a Seamless Phase II/III Clinical Trial using Early Outcomes for Treatment Selection: an Application in Multiple Sclerosis. <em>Statistics in Medicine</em> 2011;30:1528-1540.<br />
</p>
<p>Parsons N, Friede T, Todd S, Valdes Marquez E, Chataway J, Nicholas R, Stallard N. An R package for implementing simulations for seamless phase II/III clinicals trials using early outcomes for treatment selection. <em>Computational Statistics and Data Analysis</em> 2012;56:1150-1160.<br />
</p>
<p>Bretz F, Schmidli H, Koenig F, Racine A, Maurer W. Confirmatory seamless phase II/III clinical trials with hypotheses selection at interim: General concepts. <em>Biometrical Journal</em> 2006;48:623-634.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gtreatsel.sim">gtreatsel.sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# two test treatment groups
# effect size = 0.3 for group 1
# for both early and final normal outcomes
# correlation = 0.3
# select one treatment only at interim
treatsel.sim(n=list(stage1=100,stage2=300),
        effect=list(early=c(0,0.3,0),final=c(0,0.3,0)),
        outcome=list(early="N",final="N"),
        nsim=100,corr=0.3,seed=145514,select=1,
        level=0.025,ptest=c(1,2),fu=FALSE,
        method="invnorm",file="")

# five test treatment groups
# correlation = 0.3
# flexible selection rule, with epsilon = 1
treatsel.sim(n=list(stage1=100,stage2=300),
        effect=list(early=c(0,0.3,0.2,0.1,0.3,0.05),
        final=c(0,0.2,0.3,0.2,0.1,0.5)),
        outcome=list(early="N",final="N"),
        nsim=200,corr=0.3,seed=145514,select=4,epsilon=1,
        level=0.025,ptest=c(1:5),method="invnorm")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
