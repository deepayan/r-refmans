<!DOCTYPE html><html><head><title>Help for package sdcSpatial</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sdcSpatial}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#create_raster'><p>Create a raster at a certain resolution</p></a></li>
<li><a href='#disclosure_risk'><p>Calculate disclosure risk for raster cells</p></a></li>
<li><a href='#dwellings'><p>Simulated dwellings data set</p></a></li>
<li><a href='#enterprises'><p>Simulated data set with enterprise locations.</p></a></li>
<li><a href='#is_sensitive'><p>Return raster with sensitive locations.</p></a></li>
<li><a href='#is_sensitive_at'><p>Calculate sensitivity from  a sdc_raster at x,y locations.</p></a></li>
<li><a href='#mask_grid'><p>Mask coordinates using a grid</p></a></li>
<li><a href='#mask_random'><p>Mask coordinates using random pertubation</p></a></li>
<li><a href='#mask_voronoi'><p>Mask coordinates using voronoi masking</p></a></li>
<li><a href='#mask_weighted_random'><p>Mask coordinates using weighted random pertubation</p></a></li>
<li><a href='#max2'><p>returns one but highest contribution</p></a></li>
<li><a href='#plot_sensitive'><p>Plot the sensitive cells of the sdc_raster.</p></a></li>
<li><a href='#plot.sdc_raster'><p>Plot a sdc_raster object</p></a></li>
<li><a href='#protect_neighborhood'><p>protects raster by summing over the neighborhood</p></a></li>
<li><a href='#protect_quadtree'><p>Protect a raster with  a quadtree method.</p></a></li>
<li><a href='#protect_smooth'><p>Protect a sdc_raster by smoothing</p></a></li>
<li><a href='#remove_sensitive'><p>Remove sensitive cells from raster</p></a></li>
<li><a href='#sdc_raster'><p>Create a raster map with privacy awareness</p></a></li>
<li><a href='#sdcSpatial-package'><p>Privacy Protected maps</p></a></li>
<li><a href='#sensitivity_score'><p>Mean sensitivity for raster</p></a></li>
<li><a href='#smooth_raster'><p>Create kde density version of a raster</p></a></li>
<li><a href='#topdown_code'><p>Remove revealing high and low values</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Statistical Disclosure Control for Spatial Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Privacy protected raster maps 
  can be created from spatial point data. Protection
  methods include smoothing of dichotomous variables by de Jonge and de Wolf (2016) 
  &lt;<a href="https://doi.org/10.1007%2F978-3-319-45381-1_9">doi:10.1007/978-3-319-45381-1_9</a>&gt;, continuous variables by de Wolf and 
  de Jonge (2018) &lt;<a href="https://doi.org/10.1007%2F978-3-319-99771-1_23">doi:10.1007/978-3-319-99771-1_23</a>&gt;, suppressing 
  revealing values and a generalization of the quad tree method by 
  Suñé, Rovira, Ibáñez and Farré (2017) &lt;<a href="https://doi.org/10.2901%2FEUROSTAT.C2017.001">doi:10.2901/EUROSTAT.C2017.001</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/edwindj/sdcSpatial">https://github.com/edwindj/sdcSpatial</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/edwindj/sdcSpatial/issues">https://github.com/edwindj/sdcSpatial/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, sp, sf, FNN</td>
</tr>
<tr>
<td>Imports:</td>
<td>raster, methods</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-24 13:08:32 UTC; edwindj</td>
</tr>
<tr>
<td>Author:</td>
<td>Edwin de Jonge <a href="https://orcid.org/0000-0002-6580-4718"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Peter-Paul de Wolf [aut],
  Douwe Hut [ctb],
  Sapphire Han [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Edwin de Jonge &lt;edwindjonge@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-24 13:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='create_raster'>Create a raster at a certain resolution</h2><span id='topic+create_raster'></span>

<h3>Description</h3>

<p>Utility function to generate a raster at a certain resolution (with rounded coordinates).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_raster(x, res = 200, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_raster_+3A_x">x</code></td>
<td>
<p>geographical object (that supports extent).</p>
</td></tr>
<tr><td><code id="create_raster_+3A_res">res</code></td>
<td>
<p>desired resolution (default 200).</p>
</td></tr>
<tr><td><code id="create_raster_+3A_...">...</code></td>
<td>
<p>passed through to <code><a href="raster.html#topic+raster">raster</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="raster.html#topic+raster">raster::raster</a></code> object
</p>

<hr>
<h2 id='disclosure_risk'>Calculate disclosure risk for raster cells</h2><span id='topic+disclosure_risk'></span>

<h3>Description</h3>

<p>The disclosure risk function is used by <code><a href="#topic+is_sensitive">is_sensitive()</a></code> to determine the risk of
a <code>raster</code> cell. It returns a score between 0 and 1 for cells that have a finite
value (otherwise <code>NA</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disclosure_risk(x, risk_type = x$risk_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="disclosure_risk_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+sdc_raster">sdc_raster</a></code> object.</p>
</td></tr>
<tr><td><code id="disclosure_risk_+3A_risk_type">risk_type</code></td>
<td>
<p><code>character</code>: &quot;external&quot;, &quot;internal&quot;, &quot;discrete&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Different risk functions include:
</p>

<ul>
<li><p> external (numeric variable), calculates how much the largest value
comprises the total sum within a cell
</p>
</li>
<li><p> internal (numeric variable), calculates how much the largest value
comprises the sum without the second largest value
</p>
</li>
<li><p> discrete (logical variable), calculates the fraction of <code>TRUE</code> vs <code>FALSE</code>
</p>
</li></ul>



<h3>Value</h3>

<p><a href="raster.html#topic+raster">raster::raster</a> object with the disclosure risk.
</p>


<h3>See Also</h3>

<p>Other sensitive: 
<code><a href="#topic+is_sensitive_at">is_sensitive_at</a>()</code>,
<code><a href="#topic+is_sensitive">is_sensitive</a>()</code>,
<code><a href="#topic+plot_sensitive">plot_sensitive</a>()</code>,
<code><a href="#topic+remove_sensitive">remove_sensitive</a>()</code>,
<code><a href="#topic+sdc_raster">sdc_raster</a>()</code>,
<code><a href="#topic+sensitivity_score">sensitivity_score</a>()</code>
</p>

<hr>
<h2 id='dwellings'>Simulated dwellings data set</h2><span id='topic+dwellings'></span>

<h3>Description</h3>

<p>The data are generated with residence/household locations from the Dutch open
data <a href="https://www.kadaster.nl/zakelijk/registraties/basisregistraties/bag/bag-producten">BAG register</a>.
The locations are realistic, but the associated data is simulated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwellings
</code></pre>


<h3>Format</h3>

<p>a <code>data.frame</code> with 90603 rows and 4 columns.
</p>

<dl>
<dt>x</dt><dd><p>integer, x coordinate of dwelling (crs 28992)</p>
</dd>
<dt>y</dt><dd><p>integer, y coordinate of dwelling (crs 28992)</p>
</dd>
<dt>consumption</dt><dd><p>numeric, simulated continuous value</p>
</dd>
<dt>unemployed</dt><dd><p>logical, simulated discrete value</p>
</dd>
</dl>



<h3>Source</h3>

<p>Basisregistratie Adressen en Gebouwen
<a href="https://www.kadaster.nl/zakelijk/registraties/basisregistraties/bag/bag-producten">https://www.kadaster.nl/zakelijk/registraties/basisregistraties/bag/bag-producten</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# dwellings is a data.frame, the best way is to first turn it
# into a sf or sp object.

# create an sf object from our data
if (requireNamespace("sf")){
  dwellings_sf &lt;- sf::st_as_sf(dwellings, coords=c("x", "y"), crs=28992)

  unemployed &lt;- sdc_raster( dwellings_sf
                          , "unemployed"
                          , r=200
                          , max_risk = 0.9
                          )

  plot(unemployed)
  sensitivity_score(unemployed)

  unemployed_smoothed &lt;- protect_smooth(unemployed, bw = 0.4e3)
  plot(unemployed_smoothed, main="Employment rate")
  plot(unemployed_smoothed, "sum", main = "Employment")
} else {
  message("Package 'sf' was not installed.")
}

dwellings_sp &lt;- dwellings
# or change a data.frame into a sp object
sp::coordinates(dwellings_sp) &lt;- ~ x + y
tryCatch(
  # not working on some OS versions.
  sp::proj4string(dwellings_sp) &lt;- "+init=epsg:28992"
)
consumption &lt;- sdc_raster(dwellings_sp, dwellings_sp$consumption, r = 500)
consumption

plot(consumption)

# but we can also create a raster directly from a data.frame
unemployed &lt;- sdc_raster( dwellings[c("x","y")], dwellings$unemployed)

</code></pre>

<hr>
<h2 id='enterprises'>Simulated data set with enterprise locations.</h2><span id='topic+enterprises'></span>

<h3>Description</h3>

<p><code>enterprises</code> is generated from the dutch open data
<a href="https://www.kadaster.nl/zakelijk/registraties/basisregistraties/bag/bag-producten">BAG register</a>.
The locations are realistic, but the associated data is simulated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enterprises
</code></pre>


<h3>Format</h3>

<p>An object of class <code>SpatialPointsDataFrame</code> with 8348 rows and 2 columns.
</p>

<dl>
<dt>production</dt><dd><p><code>numeric</code> simulated production (lognormal).</p>
</dd>
<dt>fined</dt><dd><p>logical simulated variable if an enterprise is fined or not.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Basisregistratie Adressen en Gebouwen: <a href="https://www.kadaster.nl/zakelijk/registraties/basisregistraties/bag/bag-producten">https://www.kadaster.nl/zakelijk/registraties/basisregistraties/bag/bag-producten</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sdcSpatial)
library(raster)

data("enterprises")

production &lt;- sdc_raster(enterprises, "production", min_count = 10)
print(production)

# show the average production per cell
plot(production, "mean")
production$min_count &lt;- 2 # adjust norm for sdc
plot(production)

production_safe &lt;- remove_sensitive(production)
plot(production_safe)

</code></pre>

<hr>
<h2 id='is_sensitive'>Return raster with sensitive locations.</h2><span id='topic+is_sensitive'></span>

<h3>Description</h3>

<p>Create a binary raster with sensitive locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_sensitive(
  x,
  max_risk = x$max_risk,
  min_count = x$min_count,
  risk_type = x$risk_type
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_sensitive_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+sdc_raster">sdc_raster</a></code> object.</p>
</td></tr>
<tr><td><code id="is_sensitive_+3A_max_risk">max_risk</code></td>
<td>
<p>a risk value higher than <code>max_risk</code> will be sensitive.</p>
</td></tr>
<tr><td><code id="is_sensitive_+3A_min_count">min_count</code></td>
<td>
<p>a count lower than <code>min_count</code> will be sensitive.</p>
</td></tr>
<tr><td><code id="is_sensitive_+3A_risk_type">risk_type</code></td>
<td>
<p>what kind of measure should be used (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default the risk settings are taken from <code>x</code>, but they can be overriden.
</p>
<p>Different risk functions can be used:
</p>

<ul>
<li><p> external (numeric variable), calculates how much the largest value comprises the total sum
</p>
</li>
<li><p> internal (numeric variable), calculates how much the largest value comprises the sum without the second largest value
</p>
</li>
<li><p> discrete (logical variable), calculates the fraction of sensitive values.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other sensitive: 
<code><a href="#topic+disclosure_risk">disclosure_risk</a>()</code>,
<code><a href="#topic+is_sensitive_at">is_sensitive_at</a>()</code>,
<code><a href="#topic+plot_sensitive">plot_sensitive</a>()</code>,
<code><a href="#topic+remove_sensitive">remove_sensitive</a>()</code>,
<code><a href="#topic+sdc_raster">sdc_raster</a>()</code>,
<code><a href="#topic+sensitivity_score">sensitivity_score</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dwellings_sp &lt;- dwellings
sp::coordinates(dwellings_sp) &lt;- ~ x + y
tryCatch(
  # does not work on some OS versions
  sp::proj4string(dwellings_sp) &lt;- "+init=epsg:28992"
)
# create a 1km grid
unemployed &lt;- sdc_raster(dwellings_sp, dwellings_sp$unemployed, r = 1e3)
print(unemployed)

# retrieve the sensitive cells
is_sensitive(unemployed)

</code></pre>

<hr>
<h2 id='is_sensitive_at'>Calculate sensitivity from  a sdc_raster at x,y locations.</h2><span id='topic+is_sensitive_at'></span>

<h3>Description</h3>

<p>Calculate sensitivity from  a sdc_raster at x,y locations.
A typical use is to calculate the sensitivity for each of the locations <code>x</code>
was created with (see example).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_sensitive_at(x, xy, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_sensitive_at_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+sdc_raster">sdc_raster()</a></code></p>
</td></tr>
<tr><td><code id="is_sensitive_at_+3A_xy">xy</code></td>
<td>
<p>matrix of x and y coordinates, or a SpatialPoints or
SpatialPointsDataFrame object</p>
</td></tr>
<tr><td><code id="is_sensitive_at_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+is_sensitive">is_sensitive</a></code>
</p>

<dl>
<dt><code>max_risk</code></dt><dd><p>a risk value higher than <code>max_risk</code> will be sensitive.</p>
</dd>
<dt><code>min_count</code></dt><dd><p>a count lower than <code>min_count</code> will be sensitive.</p>
</dd>
<dt><code>risk_type</code></dt><dd><p>what kind of measure should be used (see details).</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p><code>logical</code> vector with
</p>


<h3>See Also</h3>

<p>Other sensitive: 
<code><a href="#topic+disclosure_risk">disclosure_risk</a>()</code>,
<code><a href="#topic+is_sensitive">is_sensitive</a>()</code>,
<code><a href="#topic+plot_sensitive">plot_sensitive</a>()</code>,
<code><a href="#topic+remove_sensitive">remove_sensitive</a>()</code>,
<code><a href="#topic+sdc_raster">sdc_raster</a>()</code>,
<code><a href="#topic+sensitivity_score">sensitivity_score</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
production &lt;- sdc_raster(enterprises, "production")

# add the sensitive variable to original data set.
enterprises$sensitive &lt;- is_sensitive_at(production, enterprises)

</code></pre>

<hr>
<h2 id='mask_grid'>Mask coordinates using a grid</h2><span id='topic+mask_grid'></span>

<h3>Description</h3>

<p>Pertubates coordinates by rounding coordinates to grid coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask_grid(x, r, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mask_grid_+3A_x">x</code></td>
<td>
<p>coordinates</p>
</td></tr>
<tr><td><code id="mask_grid_+3A_r">r</code></td>
<td>
<p>grid resolution</p>
</td></tr>
<tr><td><code id="mask_grid_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> the points (black) and the pertubation (red) will be plotted</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other point pertubation: 
<code><a href="#topic+mask_random">mask_random</a>()</code>,
<code><a href="#topic+mask_voronoi">mask_voronoi</a>()</code>,
<code><a href="#topic+mask_weighted_random">mask_weighted_random</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- cbind(
  x = c(2.5, 3.5, 7.2, 1.5),
  y = c(6.2, 3.8, 4.4, 2.1)
)

# plotting is only useful from small datasets!

# grid masking
x_g &lt;- mask_grid(x, r=1, plot=TRUE)

# random pertubation
set.seed(3)
x_r &lt;- mask_random(x, r=1, plot=TRUE)

if (requireNamespace("FNN", quietly = TRUE)){
  # weighted random pertubation
  x_wr &lt;- mask_weighted_random(x, k = 2, r = 4, plot=TRUE)
}

if ( requireNamespace("FNN", quietly = TRUE)
  &amp;&amp; requireNamespace("sf", quietly = TRUE)
   ){
  # voronoi masking, plotting needs package `sf`
  x_vor &lt;- mask_voronoi(x, r = 1, plot=TRUE)
}
</code></pre>

<hr>
<h2 id='mask_random'>Mask coordinates using random pertubation</h2><span id='topic+mask_random'></span>

<h3>Description</h3>

<p>Pertubates points with a uniform pertubation in a circle.
Note that <code>r</code> can either be one distance, of a distance per data point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask_random(x, r, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mask_random_+3A_x">x</code></td>
<td>
<p>coordinates, <code>matrix</code> or <code>data.frame</code> (first two columns)</p>
</td></tr>
<tr><td><code id="mask_random_+3A_r">r</code></td>
<td>
<p><code>numeric</code> maximum pertubation distance (vectorized)</p>
</td></tr>
<tr><td><code id="mask_random_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> points will be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>adapted <code>x</code> with perturbed coordinates
</p>


<h3>See Also</h3>

<p>Other point pertubation: 
<code><a href="#topic+mask_grid">mask_grid</a>()</code>,
<code><a href="#topic+mask_voronoi">mask_voronoi</a>()</code>,
<code><a href="#topic+mask_weighted_random">mask_weighted_random</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- cbind(
  x = c(2.5, 3.5, 7.2, 1.5),
  y = c(6.2, 3.8, 4.4, 2.1)
)

# plotting is only useful from small datasets!

# grid masking
x_g &lt;- mask_grid(x, r=1, plot=TRUE)

# random pertubation
set.seed(3)
x_r &lt;- mask_random(x, r=1, plot=TRUE)

if (requireNamespace("FNN", quietly = TRUE)){
  # weighted random pertubation
  x_wr &lt;- mask_weighted_random(x, k = 2, r = 4, plot=TRUE)
}

if ( requireNamespace("FNN", quietly = TRUE)
  &amp;&amp; requireNamespace("sf", quietly = TRUE)
   ){
  # voronoi masking, plotting needs package `sf`
  x_vor &lt;- mask_voronoi(x, r = 1, plot=TRUE)
}
</code></pre>

<hr>
<h2 id='mask_voronoi'>Mask coordinates using voronoi masking</h2><span id='topic+mask_voronoi'></span>

<h3>Description</h3>

<p>Pertubates points by using voronoi masking. Each point is moved at its nearest
voronoi boundary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask_voronoi(x, r = 0, k = 10, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mask_voronoi_+3A_x">x</code></td>
<td>
<p>coordinates</p>
</td></tr>
<tr><td><code id="mask_voronoi_+3A_r">r</code></td>
<td>
<p>tolerance, nearest voronoi should be at least r away.</p>
</td></tr>
<tr><td><code id="mask_voronoi_+3A_k">k</code></td>
<td>
<p>number of neighbors to consider when determining nearest neighbors</p>
</td></tr>
<tr><td><code id="mask_voronoi_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> plots the voronoi tesselation, points (black), and
perturbated points (red), needs package <code>sf</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>adapted <code>x</code> with perturbed coordinates
</p>


<h3>See Also</h3>

<p>Other point pertubation: 
<code><a href="#topic+mask_grid">mask_grid</a>()</code>,
<code><a href="#topic+mask_random">mask_random</a>()</code>,
<code><a href="#topic+mask_weighted_random">mask_weighted_random</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- cbind(
  x = c(2.5, 3.5, 7.2, 1.5),
  y = c(6.2, 3.8, 4.4, 2.1)
)

# plotting is only useful from small datasets!

# grid masking
x_g &lt;- mask_grid(x, r=1, plot=TRUE)

# random pertubation
set.seed(3)
x_r &lt;- mask_random(x, r=1, plot=TRUE)

if (requireNamespace("FNN", quietly = TRUE)){
  # weighted random pertubation
  x_wr &lt;- mask_weighted_random(x, k = 2, r = 4, plot=TRUE)
}

if ( requireNamespace("FNN", quietly = TRUE)
  &amp;&amp; requireNamespace("sf", quietly = TRUE)
   ){
  # voronoi masking, plotting needs package `sf`
  x_vor &lt;- mask_voronoi(x, r = 1, plot=TRUE)
}
</code></pre>

<hr>
<h2 id='mask_weighted_random'>Mask coordinates using weighted random pertubation</h2><span id='topic+mask_weighted_random'></span>

<h3>Description</h3>

<p>This method uses per point the distance to the <code>k</code>th neighbor as the maximum
pertubation distance. Parameter <code>r</code> can be used to restrict the maximum distance
of the <code>k</code>th neighbor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask_weighted_random(x, k = 5, r = NULL, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mask_weighted_random_+3A_x">x</code></td>
<td>
<p>coordinates, <code>matrix</code> or <code>data.frame</code> (first two columns)</p>
</td></tr>
<tr><td><code id="mask_weighted_random_+3A_k">k</code></td>
<td>
<p><code>integer</code> number of neighbors to be used as the maximum distance</p>
</td></tr>
<tr><td><code id="mask_weighted_random_+3A_r">r</code></td>
<td>
<p><code>numeric</code> maximum pertubation distance (vectorized)</p>
</td></tr>
<tr><td><code id="mask_weighted_random_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> points will be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>adapted <code>x</code> with perturbed coordinates
</p>


<h3>References</h3>

<p>Spatial obfuscation methods for privacy protection of
household-level data
</p>


<h3>See Also</h3>

<p>Other point pertubation: 
<code><a href="#topic+mask_grid">mask_grid</a>()</code>,
<code><a href="#topic+mask_random">mask_random</a>()</code>,
<code><a href="#topic+mask_voronoi">mask_voronoi</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- cbind(
  x = c(2.5, 3.5, 7.2, 1.5),
  y = c(6.2, 3.8, 4.4, 2.1)
)

# plotting is only useful from small datasets!

# grid masking
x_g &lt;- mask_grid(x, r=1, plot=TRUE)

# random pertubation
set.seed(3)
x_r &lt;- mask_random(x, r=1, plot=TRUE)

if (requireNamespace("FNN", quietly = TRUE)){
  # weighted random pertubation
  x_wr &lt;- mask_weighted_random(x, k = 2, r = 4, plot=TRUE)
}

if ( requireNamespace("FNN", quietly = TRUE)
  &amp;&amp; requireNamespace("sf", quietly = TRUE)
   ){
  # voronoi masking, plotting needs package `sf`
  x_vor &lt;- mask_voronoi(x, r = 1, plot=TRUE)
}
</code></pre>

<hr>
<h2 id='max2'>returns one but highest contribution</h2><span id='topic+max2'></span>

<h3>Description</h3>

<p>returns one but highest contribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max2(x, default_value = 0, na.rm = TRUE)
</code></pre>

<hr>
<h2 id='plot_sensitive'>Plot the sensitive cells of the sdc_raster.</h2><span id='topic+plot_sensitive'></span>

<h3>Description</h3>

<p>Plots t the sensitive cells of the sdc_raster. The sensitive cells are
plotted in red. The sensitive cells are determined using <code><a href="#topic+is_sensitive">is_sensitive</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sensitive(x, value = "mean", main = "sensitive", col, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_sensitive_+3A_x">x</code></td>
<td>
<p><a href="#topic+sdc_raster">sdc_raster</a> object</p>
</td></tr>
<tr><td><code id="plot_sensitive_+3A_value">value</code></td>
<td>
<p><a href="base.html#topic+character">character</a> which value layer to be used for values,
e.g. &quot;sum&quot;, &quot;count&quot;, &quot;mean&quot; (default).</p>
</td></tr>
<tr><td><code id="plot_sensitive_+3A_main">main</code></td>
<td>
<p><a href="base.html#topic+character">character</a> title of map.</p>
</td></tr>
<tr><td><code id="plot_sensitive_+3A_col">col</code></td>
<td>
<p>color palette to be used, passed on to <code><a href="raster.html#topic+plot">raster::plot()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_sensitive_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="#topic+plot.sdc_raster">plot.sdc_raster</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other plotting: 
<code><a href="#topic+plot.sdc_raster">plot.sdc_raster</a>()</code>
</p>
<p>Other sensitive: 
<code><a href="#topic+disclosure_risk">disclosure_risk</a>()</code>,
<code><a href="#topic+is_sensitive_at">is_sensitive_at</a>()</code>,
<code><a href="#topic+is_sensitive">is_sensitive</a>()</code>,
<code><a href="#topic+remove_sensitive">remove_sensitive</a>()</code>,
<code><a href="#topic+sdc_raster">sdc_raster</a>()</code>,
<code><a href="#topic+sensitivity_score">sensitivity_score</a>()</code>
</p>

<hr>
<h2 id='plot.sdc_raster'>Plot a sdc_raster object</h2><span id='topic+plot.sdc_raster'></span>

<h3>Description</h3>

<p>Plot a sdc_raster object together with its sensitivity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sdc_raster'
plot(
  x,
  value = "mean",
  sensitive = TRUE,
  ...,
  main = paste(substitute(x)),
  col
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.sdc_raster_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+sdc_raster">sdc_raster</a></code> object to be plotted</p>
</td></tr>
<tr><td><code id="plot.sdc_raster_+3A_value">value</code></td>
<td>
<p><code>character</code> which value layer to be used for plotting, e.g. &quot;sum&quot;, &quot;count&quot;, &quot;mean&quot; (default).</p>
</td></tr>
<tr><td><code id="plot.sdc_raster_+3A_sensitive">sensitive</code></td>
<td>
<p><code>logical</code> show the sensitivity in the plot?</p>
</td></tr>
<tr><td><code id="plot.sdc_raster_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="raster.html#topic+plot">raster::plot()</a></code></p>
</td></tr>
<tr><td><code id="plot.sdc_raster_+3A_main">main</code></td>
<td>
<p>title of plot</p>
</td></tr>
<tr><td><code id="plot.sdc_raster_+3A_col">col</code></td>
<td>
<p>color palette to be used, passed on to <code><a href="raster.html#topic+plot">raster::plot()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>sensitive</code> is set to <code>TRUE</code>, a side-by-side plot will be made of
the <code>value</code> and its <code>sensitivity</code>.
</p>


<h3>See Also</h3>

<p>Other plotting: 
<code><a href="#topic+plot_sensitive">plot_sensitive</a>()</code>
</p>

<hr>
<h2 id='protect_neighborhood'>protects raster by summing over the neighborhood</h2><span id='topic+protect_neighborhood'></span>

<h3>Description</h3>

<p>protects raster by summing over the neighborhood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>protect_neighborhood(x, radius = 10 * raster::res(x$value)[1], ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="protect_neighborhood_+3A_x">x</code></td>
<td>
<p><code>sdc_raster()</code> object to be protected</p>
</td></tr>
<tr><td><code id="protect_neighborhood_+3A_radius">radius</code></td>
<td>
<p>of the neighborhood to take</p>
</td></tr>
<tr><td><code id="protect_neighborhood_+3A_...">...</code></td>
<td>
<p>not used at the moment</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sdc_raster</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(enterprises)

# create a sdc_raster from point data with raster with
# a resolution of 200m
production &lt;- sdc_raster(enterprises, variable = "production"
                        , r = 200, min_count = 3)

print(production)

# plot the raster
zlim &lt;- c(0, 3e4)
# show which raster cells are sensitive
plot(production, zlim=zlim)

# let's smooth to reduce the sensitivity
smoothed &lt;- protect_smooth(production, bw = 400)
plot(smoothed)

neighborhood &lt;- protect_neighborhood(production, radius=1000)
plot(neighborhood)

# what is the sensitivy fraction?
sensitivity_score(neighborhood)

</code></pre>

<hr>
<h2 id='protect_quadtree'>Protect a raster with  a quadtree method.</h2><span id='topic+protect_quadtree'></span>

<h3>Description</h3>

<p><code>protect_quadtree</code> reduces sensitivy by aggregating sensisitve cells with its
three neighbors, and does this recursively until no sensitive cells are
left or when the maximum zoom levels has been reached.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>protect_quadtree(x, max_zoom = Inf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="protect_quadtree_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+sdc_raster">sdc_raster</a></code> object to be protected.</p>
</td></tr>
<tr><td><code id="protect_quadtree_+3A_max_zoom">max_zoom</code></td>
<td>
<p><code>numeric</code>, restricts the number of zoom steps and thereby the max resolution for the
blocks. Each step will zoom with a factor of 2 in x and y so the max resolution = resolution * 2^max_zoom.</p>
</td></tr>
<tr><td><code id="protect_quadtree_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+is_sensitive">is_sensitive</a></code>
</p>

<dl>
<dt><code>max_risk</code></dt><dd><p>a risk value higher than <code>max_risk</code> will be sensitive.</p>
</dd>
<dt><code>min_count</code></dt><dd><p>a count lower than <code>min_count</code> will be sensitive.</p>
</dd>
<dt><code>risk_type</code></dt><dd><p>what kind of measure should be used (see details).</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>This implementation generalizes the method as described by Suñé et al., in
which there is no
risk function, and only a  <code>min_count</code> to determine sensitivity.
Furthermore the method the article
only handles count data (<code>x$value$count</code>), not mean or summed values.
Currently the translation feature of the article is not (yet) implemented,
for the original method does not take the <code>disclosure_risk</code> into account.
</p>


<h3>Value</h3>

<p>a <code><a href="#topic+sdc_raster">sdc_raster</a></code> object, in which sensitive cells have been recursively aggregated until not sensitive or
when max_zoom has been reached.
</p>


<h3>References</h3>

<p>Suñé, E., Rovira, C., Ibáñez, D., Farré, M. (2017).
Statistical disclosure control on visualising geocoded population data using
a structure in quadtrees, NTTS 2017
</p>


<h3>See Also</h3>

<p>Other protection methods: 
<code><a href="#topic+protect_smooth">protect_smooth</a>()</code>,
<code><a href="#topic+remove_sensitive">remove_sensitive</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># library(raster)
#
# fined &lt;- sdc_raster(enterprises, enterprises$fined)
# plot(fined)
# fined_qt &lt;- protect_quadtree(fined)
# plot(fined_qt)
#
# fined &lt;- sdc_raster(enterprises, enterprises$fined, r=50)
# plot(fined)
# fined_qt &lt;- protect_quadtree(fined)
# plot(fined_qt)
#
#
#
# library(sf)
# gemeente_2019 &lt;- st_read("https://cartomap.github.io/nl/rd/gemeente_2019.geojson")
# st_crs(gemeente_2019) &lt;- 28992
# nbl &lt;- st_touches(gemeente_2019)
#
# coords &lt;- st_coordinates(st_centroid(gemeente_2019))
# l &lt;- lapply(seq_along(nbl), function(i){
#   nb &lt;- nbl[[i]]
#   st_sfc(lapply(nb, function(j){
#     st_linestring(coords[c(i,j),])})
#   )
# })
# l2 &lt;- do.call(c, l)
#
# edge_list &lt;- as.data.frame(nbl)
# library(data.table)
# el &lt;- as.data.table(edge_list)
# names(el) &lt;- c("from", "to")
#
# edge_list$from &lt;- gemeente_2019$id[edge_list$row.id]
# edge_list$to &lt;- gemeente_2019$id[edge_list$col.id]
# edge_list &lt;- subset(edge_list, row.id &lt; col.id)
# edge_list &lt;- edge_list[,c("from", "to")]
#
# g &lt;- igraph::graph_from_data_frame(edge_list, directed = FALSE)
# plot(g)
# library(igraph)
# i &lt;- match(names(V(g)), gemeente_2019$id)
#
# c2 &lt;- igraph::layout_with_fr(g, coords[i,])
# plot(g, layout = c2)
#
# buurt_2019 &lt;- st_read("https://cartomap.github.io/nl/rd/buurt_2019.geojson")
# st_crs(buurt_2019) &lt;- 28992
# system.time({
#   nbl &lt;- st_touches(buurt_2019)
# })
#
# coords &lt;- st_coordinates(st_centroid(buurt_2019))
# l &lt;- lapply(seq_along(nbl), function(i){
#   nb &lt;- nbl[[i]]
#   st_sfc(lapply(nb, function(j){
#     st_linestring(coords[c(i,j),])})
#   )
# })
# l2 &lt;- do.call(c, l)
#
# plot(l2)
</code></pre>

<hr>
<h2 id='protect_smooth'>Protect a sdc_raster by smoothing</h2><span id='topic+protect_smooth'></span>

<h3>Description</h3>

<p><code>protect_smooth</code> reduces the sensitivity by applying a Gaussian smoother,
making the values less localized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>protect_smooth(x, bw = raster::res(x$value), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="protect_smooth_+3A_x">x</code></td>
<td>
<p>raster object</p>
</td></tr>
<tr><td><code id="protect_smooth_+3A_bw">bw</code></td>
<td>
<p>bandwidth</p>
</td></tr>
<tr><td><code id="protect_smooth_+3A_...">...</code></td>
<td>
<p>passed through to <code><a href="raster.html#topic+focal">focal</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sensitivity of a raster can be decreased by applying a kernel density smoother as
argued by de Jonge et al. (2016) and de Wolf et al. (2018). Smoothing spatially spreads
localized values, reducing the risk for location disclosure. Note that
smoothing often visually enhances detection of spatial patterns.
The kernel applied is a Gaussian kernel with a bandwidth <code>bw</code> supplied by the user.
The smoother acts upon the <code>x$value$count</code> and <code>x$value$sum</code>
from which a new <code>x$value$mean</code> is derived.
</p>


<h3>References</h3>

<p>de Jonge, E., &amp; de Wolf, P. P. (2016, September).
Spatial smoothing and statistical disclosure control.
In International Conference on Privacy in Statistical Databases
(pp. 107-117). Springer, Cham.
</p>
<p>de Wolf, P. P., &amp; de Jonge, E. (2018, September).
Safely Plotting Continuous Variables on a Map. In International Conference
on Privacy in Statistical Databases (pp. 347-359). Springer, Cham.
</p>


<h3>See Also</h3>

<p>Other protection methods: 
<code><a href="#topic+protect_quadtree">protect_quadtree</a>()</code>,
<code><a href="#topic+remove_sensitive">remove_sensitive</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sdcSpatial)
library(raster)

data(enterprises)

# create a sdc_raster from point data with raster with
# a resolution of 200m
production &lt;- sdc_raster(enterprises, variable = "production"
                        , r = 200, min_count = 3)

print(production)

# plot the raster
zlim &lt;- c(0, 3e4)
# show which raster cells are sensitive
plot(production, zlim=zlim)

# but we can also retrieve directly the raster
sensitive &lt;- is_sensitive(production, min_count = 3)
plot(sensitive, col = c('white', 'red'))

# what is the sensitivy fraction?
sensitivity_score(production)
# or equally
cellStats(sensitive, mean)

# let's smooth to reduce the sensitivity
smoothed &lt;- protect_smooth(production, bw = 400)
plot(smoothed)

# let's smooth to reduce the sensitivity, with higher resolution
smoothed &lt;- protect_smooth(production, bw = 400, smooth_fact=4, keep_resolution=FALSE)
plot(smoothed)

# what is the sensitivy fraction?
sensitivity_score(smoothed)

# let's remove the sensitive data.
smoothed_safe &lt;- remove_sensitive(smoothed, min_count = 3)
plot(smoothed_safe)

# let's communicate!
production_mean &lt;- mean(smoothed_safe)
production_total &lt;- sum(smoothed_safe)

# and create a contour plot
raster::filledContour(production_mean, nlevels = 6, main = "Mean production")


# generated with R 3.6 &gt;=
#col &lt;- hcl.colors(11, rev=TRUE)
col &lt;- c("#FDE333", "#C2DE34", "#7ED357", "#00C475", "#00B28A", "#009B95"
        ,  "#008298", "#006791", "#274983", "#44286E", "#4B0055"
        )
raster::filledContour(production_total, nlevels = 11
             , col = col
             , main="Total production")

</code></pre>

<hr>
<h2 id='remove_sensitive'>Remove sensitive cells from raster</h2><span id='topic+remove_sensitive'></span><span id='topic+mask_sensitive'></span>

<h3>Description</h3>

<p><code>remove_sensitive</code> removes sensitive cells from a <code><a href="#topic+sdc_raster">sdc_raster</a></code>.
The sensitive cells, as found by <code><a href="#topic+is_sensitive">is_sensitive()</a></code> are set to NA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_sensitive(x, max_risk = x$max_risk, min_count = x$min_count, ...)

mask_sensitive(x, max_risk = x$max_risk, min_count = x$min_count, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_sensitive_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+sdc_raster">sdc_raster</a></code> object.</p>
</td></tr>
<tr><td><code id="remove_sensitive_+3A_max_risk">max_risk</code></td>
<td>
<p>a risk value higher than <code>max_risk</code> will be sensitive.</p>
</td></tr>
<tr><td><code id="remove_sensitive_+3A_min_count">min_count</code></td>
<td>
<p>a count lower than <code>min_count</code> will be sensitive.</p>
</td></tr>
<tr><td><code id="remove_sensitive_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="#topic+is_sensitive">is_sensitive</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Removing sensitive cells is a protection method, which often is useful to
finalize map protection after other protection methods have been applied.
<code>mask_sensitive</code> and <code>remove_sensitive</code> are synonyms, to accommodate both
experienced <code>raster</code> users as well as sdc users.
</p>


<h3>Value</h3>

<p>sdc_raster object with sensitive cells set to <code>NA</code>.
</p>


<h3>See Also</h3>

<p>Other sensitive: 
<code><a href="#topic+disclosure_risk">disclosure_risk</a>()</code>,
<code><a href="#topic+is_sensitive_at">is_sensitive_at</a>()</code>,
<code><a href="#topic+is_sensitive">is_sensitive</a>()</code>,
<code><a href="#topic+plot_sensitive">plot_sensitive</a>()</code>,
<code><a href="#topic+sdc_raster">sdc_raster</a>()</code>,
<code><a href="#topic+sensitivity_score">sensitivity_score</a>()</code>
</p>
<p>Other protection methods: 
<code><a href="#topic+protect_quadtree">protect_quadtree</a>()</code>,
<code><a href="#topic+protect_smooth">protect_smooth</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(raster)

unemployed &lt;- sdc_raster(dwellings[1:2], dwellings$unemployed, r=200)

# plot the normally rastered data
plot(unemployed, zlim=c(0,1))
plot_sensitive(unemployed)

unemployed_safe &lt;- remove_sensitive(unemployed, risk_type="discrete")
plot_sensitive(unemployed_safe, zlim=c(0,1))
print(unemployed)
unemployed$value

</code></pre>

<hr>
<h2 id='sdc_raster'>Create a raster map with privacy awareness</h2><span id='topic+sdc_raster'></span>

<h3>Description</h3>

<p><code>sdc_raster</code> creates multiple <code><a href="raster.html#topic+raster">raster::raster</a></code> objects
(&quot;count&quot;, &quot;mean&quot;, &quot;sum&quot;) from supplied point data <code>x</code> and calculates
the sensitivity to privacy disclosure for each raster location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdc_raster(
  x,
  variable,
  r = 200,
  max_risk = 0.95,
  min_count = 10,
  risk_type = c("external", "internal", "discrete"),
  ...,
  field = variable
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sdc_raster_+3A_x">x</code></td>
<td>
<p><a href="sp.html#topic+SpatialPoints">sp::SpatialPointsDataFrame</a>, <a href="sf.html#topic+sf">sf::sf</a> or a two column matrix or <a href="base.html#topic+data.frame">data.frame</a>
that is used to create a raster map.</p>
</td></tr>
<tr><td><code id="sdc_raster_+3A_variable">variable</code></td>
<td>
<p>name of data column or <code>numeric</code> with same length as <code>x</code>
to be used for the data in the raster map.</p>
</td></tr>
<tr><td><code id="sdc_raster_+3A_r">r</code></td>
<td>
<p>either a desired resolution or a pre-existing <a href="raster.html#topic+raster">raster</a> object.
In the first case, the crs of <code>x</code> (if present) will be used, in the latter
the properties of the <code>r</code> will be kept.</p>
</td></tr>
<tr><td><code id="sdc_raster_+3A_max_risk">max_risk</code></td>
<td>
<p><code>numeric</code>, the maximum_risk score (<code><a href="#topic+disclosure_risk">disclosure_risk</a></code>)
before a cell in the map is considered sensitive.</p>
</td></tr>
<tr><td><code id="sdc_raster_+3A_min_count">min_count</code></td>
<td>
<p><code>numeric</code>, a raster cell with less then <code>min_count</code>
observations is considered sensitived.</p>
</td></tr>
<tr><td><code id="sdc_raster_+3A_risk_type">risk_type</code></td>
<td>
<p>passed on to <code><a href="#topic+disclosure_risk">disclosure_risk()</a></code>.</p>
</td></tr>
<tr><td><code id="sdc_raster_+3A_...">...</code></td>
<td>
<p>passed through to <code><a href="raster.html#topic+rasterize">raster::rasterize()</a></code></p>
</td></tr>
<tr><td><code id="sdc_raster_+3A_field">field</code></td>
<td>
<p>synonym for <code>variable</code>. If both supplied, <code>field</code> has precedence.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code>sdc_raster</code> object is the vehicle that does the book keeping for calculating
sensitivity. Protection methods work upon a <code>sdc_raster</code> and return a new
<code>sdc_raster</code> in which the sensitivity is reduced.
The sensitivity of the map can be assessed with <a href="#topic+sensitivity_score">sensitivity_score</a>,
<code><a href="#topic+plot.sdc_raster">plot.sdc_raster()</a></code>, <code><a href="#topic+plot_sensitive">plot_sensitive()</a></code> or <code>print</code>.
Reducing the sensitivity can be done with <code><a href="#topic+protect_smooth">protect_smooth()</a></code>,
<code><a href="#topic+protect_quadtree">protect_quadtree()</a></code> and <code><a href="#topic+remove_sensitive">remove_sensitive()</a></code>. Raster maps for <code>mean</code>,
<code>sum</code> and <code>count</code> data can be extracted from the <code style="white-space: pre;">&#8288;$value&#8288;</code> (<code><a href="raster.html#topic+brick">brick()</a></code>).
</p>


<h3>Value</h3>

<p>object of <code>class</code> &quot;sdc_raster&quot;:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;$value&#8288;</code>: <code><a href="raster.html#topic+brick">raster::brick()</a></code> object with different layers e.g. <code>count</code>, <code>sum</code>, <code>mean</code>, <code>scale</code>.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$max_risk&#8288;</code>: see above.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$min_count&#8288;</code>: see above.
of protection operation <code><a href="#topic+protect_smooth">protect_smooth()</a></code> or <code><a href="#topic+protect_quadtree">protect_quadtree()</a></code>.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$type&#8288;</code>: data type of <code>variable</code>, either <code>numeric</code> or <code>logical</code>
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$risk_type&#8288;</code>, &quot;external&quot;, &quot;internal&quot; or &quot;discrete&quot; (see <code><a href="#topic+disclosure_risk">disclosure_risk()</a></code>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Other sensitive: 
<code><a href="#topic+disclosure_risk">disclosure_risk</a>()</code>,
<code><a href="#topic+is_sensitive_at">is_sensitive_at</a>()</code>,
<code><a href="#topic+is_sensitive">is_sensitive</a>()</code>,
<code><a href="#topic+plot_sensitive">plot_sensitive</a>()</code>,
<code><a href="#topic+remove_sensitive">remove_sensitive</a>()</code>,
<code><a href="#topic+sensitivity_score">sensitivity_score</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(raster)
prod &lt;- sdc_raster(enterprises, field = "production", r = 500)
print(prod)

prod &lt;- sdc_raster(enterprises, field = "production", r = 1e3)
print(prod)

# get raster with the average production per cell averaged over the enterprises
prod_mean &lt;- mean(prod)
summary(prod_mean)

# get raster with the total production per cell
prod_total &lt;- sum(prod)
summary(prod_total)

</code></pre>

<hr>
<h2 id='sdcSpatial-package'>Privacy Protected maps</h2><span id='topic+sdcSpatial'></span><span id='topic+sdcSpatial-package'></span>

<h3>Description</h3>

<p><code>sdcSpatial</code> contains  functions to create spatial distribution maps,
assess the risk of disclosure on a location and to suppress or adjust
revealing values at certain locations.
</p>


<h3>Details</h3>

<p><code>sdcSpatial</code> working horse is the <code><a href="#topic+sdc_raster">sdc_raster()</a></code> object upon which the
following methods can be applied:
</p>


<h3>Sensitivity assessment</h3>


<ul>
<li> <p><code><a href="#topic+plot.sdc_raster">plot.sdc_raster()</a></code>, <code><a href="#topic+plot_sensitive">plot_sensitive()</a></code>
</p>
</li>
<li> <p><code>print</code>
</p>
</li>
<li> <p><code><a href="#topic+is_sensitive">is_sensitive()</a></code>
</p>
</li></ul>



<h3>Protection methods</h3>


<ul>
<li> <p><code><a href="#topic+remove_sensitive">remove_sensitive()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+protect_smooth">protect_smooth()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+protect_quadtree">protect_quadtree()</a></code>
</p>
</li></ul>



<h3>Extraction</h3>


<ul>
<li> <p><code>sum</code>, extract the <code>sum</code> layer from a <code>sdc_raster</code> object
</p>
</li>
<li> <p><code>mean</code>, extract the <code>mean</code> layer from a <code>sdc_raster</code> object
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Edwin de Jonge <a href="mailto:edwindjonge@gmail.com">edwindjonge@gmail.com</a> (<a href="https://orcid.org/0000-0002-6580-4718">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Peter-Paul de Wolf
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Douwe Hut [contributor]
</p>
</li>
<li><p> Sapphire Han [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>de Jonge, E., &amp; de Wolf, P. P. (2016, September).
Spatial smoothing and statistical disclosure control.
In International Conference on Privacy in Statistical Databases (pp. 107-117). Springer, Cham.
</p>
<p>de Wolf, P. P., &amp; de Jonge, E. (2018, September).
Safely Plotting Continuous Variables on a Map. In International Conference
on Privacy in Statistical Databases (pp. 347-359). Springer, Cham.
</p>
<p>Suñé, E., Rovira, C., Ibáñez, D., Farré, M. (2017). Statistical
disclosure control on visualising geocoded population data using
a structure in quadtrees, NTTS 2017
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/edwindj/sdcSpatial">https://github.com/edwindj/sdcSpatial</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/edwindj/sdcSpatial/issues">https://github.com/edwindj/sdcSpatial/issues</a>
</p>
</li></ul>


<hr>
<h2 id='sensitivity_score'>Mean sensitivity for raster</h2><span id='topic+sensitivity_score'></span>

<h3>Description</h3>

<p><code>sensitivity_score</code> calculates the fraction of cells (with a value)
that are considered sensitive according to the used <code><a href="#topic+disclosure_risk">disclosure_risk</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity_score(x, max_risk = x$max_risk, min_count = x$min_count, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity_score_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+sdc_raster">sdc_raster</a></code> object.</p>
</td></tr>
<tr><td><code id="sensitivity_score_+3A_max_risk">max_risk</code></td>
<td>
<p>a risk value higher than <code>max_risk</code> will be sensitive.</p>
</td></tr>
<tr><td><code id="sensitivity_score_+3A_min_count">min_count</code></td>
<td>
<p>a count lower than <code>min_count</code> will be sensitive.</p>
</td></tr>
<tr><td><code id="sensitivity_score_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="#topic+is_sensitive">is_sensitive</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other sensitive: 
<code><a href="#topic+disclosure_risk">disclosure_risk</a>()</code>,
<code><a href="#topic+is_sensitive_at">is_sensitive_at</a>()</code>,
<code><a href="#topic+is_sensitive">is_sensitive</a>()</code>,
<code><a href="#topic+plot_sensitive">plot_sensitive</a>()</code>,
<code><a href="#topic+remove_sensitive">remove_sensitive</a>()</code>,
<code><a href="#topic+sdc_raster">sdc_raster</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
consumption &lt;- sdc_raster(dwellings[1:2], variable = dwellings$consumption, r = 500)

sensitivity_score(consumption)
# same as
print(consumption)

# change the rules! A higher norm generates more sensitive cells
sensitivity_score(consumption, min_count = 20)

</code></pre>

<hr>
<h2 id='smooth_raster'>Create kde density version of a raster</h2><span id='topic+smooth_raster'></span>

<h3>Description</h3>

<p>Create kde density version of a raster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth_raster(
  x,
  bw = raster::res(x),
  smooth_fact = 5,
  keep_resolution = TRUE,
  na.rm = TRUE,
  pad = TRUE,
  padValue = NA,
  threshold = NULL,
  type = c("Gauss", "circle", "rectangle"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smooth_raster_+3A_x">x</code></td>
<td>
<p>raster object</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_bw">bw</code></td>
<td>
<p>bandwidth</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_smooth_fact">smooth_fact</code></td>
<td>
<p><code>integer</code>, disaggregate factor to have a
better smoothing</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_keep_resolution">keep_resolution</code></td>
<td>
<p><code>integer</code>, should the returned map have same
resolution as <code>x</code> or keep the disaggregated raster resulting from
<code>smooth_fact</code>?</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_na.rm">na.rm</code></td>
<td>
<p>should the <code>NA</code> value be removed from the raster?</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_pad">pad</code></td>
<td>
<p>should the data be padded?</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_padvalue">padValue</code></td>
<td>
<p>what should the padding value be?</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_threshold">threshold</code></td>
<td>
<p>cells with a lower (weighted) value of this threshold will be removed.</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_type">type</code></td>
<td>
<p>what is the type of smoothing (see <code>raster::focal()</code>)</p>
</td></tr>
<tr><td><code id="smooth_raster_+3A_...">...</code></td>
<td>
<p>passed through to <code><a href="raster.html#topic+focal">focal</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='topdown_code'>Remove revealing high and low values</h2><span id='topic+topdown_code'></span>

<h3>Description</h3>

<p>Remove revealing high and low values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>topdown_code(r, top = Inf, down = -Inf, ..., upper = top, lower = down)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
