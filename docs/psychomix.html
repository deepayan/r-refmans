<!DOCTYPE html><html><head><title>Help for package psychomix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {psychomix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#btmix'><p>Finite Mixtures of Bradley-Terry Models</p></a></li>
<li><a href='#btmix-class'><p>Class &quot;btmix&quot;</p></a></li>
<li><a href='#btmix-methods'><p>Methods for btmix Objects</p></a></li>
<li><a href='#effectsplot'><p>Effects Displays for Concomitant Variables in Finite Mixture Models</p></a></li>
<li><a href='#mptmix'><p>Finite Mixtures of Multinomial Processing Tree Models</p></a></li>
<li><a href='#mptmix-class'><p>Class &quot;mptmix&quot;</p></a></li>
<li><a href='#raschmix'><p>Finite Mixtures of Rasch Models</p></a></li>
<li><a href='#raschmix-class'><p>Class &quot;raschmix&quot;</p></a></li>
<li><a href='#raschmix-methods'><p>Methods for raschmix Objects</p></a></li>
<li><a href='#raschmix-plot-method'><p>Profile Plot of Item Parameters</p></a></li>
<li><a href='#simRaschmix'><p>Simulate Data from Rasch Mixture Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-01-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Psychometric Mixture Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Psychometric mixture models based on 'flexmix' infrastructure. At the moment Rasch mixture models
  with different parameterizations of the score distribution (saturated vs. mean/variance specification),
  Bradley-Terry mixture models, and MPT mixture models are implemented. These mixture models can be estimated
  with or without concomitant variables. See vignette('raschmix', package = 'psychomix') for details on the
  Rasch mixture models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0), flexmix (&ge; 2.3-7), psychotools (&ge; 0.4-2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, methods, stats, lattice, Formula (&ge; 1.1-0),
modeltools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>effects, lmtest, nnet, numDeriv</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-01-30 21:44:16 UTC; hannah</td>
</tr>
<tr>
<td>Author:</td>
<td>Hannah Frick <a href="https://orcid.org/0000-0002-6049-5258"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Friedrich Leisch [aut],
  Carolin Strobl [aut],
  Florian Wickelmaier [aut],
  Achim Zeileis <a href="https://orcid.org/0000-0003-0918-3766"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hannah Frick &lt;hannah.frick@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-30 22:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='btmix'>Finite Mixtures of Bradley-Terry Models</h2><span id='topic+btmix'></span><span id='topic+FLXMCbtreg'></span>

<h3>Description</h3>

<p>Fit finite mixtures of Bradley-Terry models for paired comparisons data via
maximum likelihood with the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>btmix(formula, data, k, subset, weights,
         nrep = 3, cluster = NULL, control = NULL,
         verbose = TRUE, drop = TRUE, unique = FALSE, which = NULL,
         type = c("loglin", "logit"), ref = NULL, undecided = NULL,
         position = NULL, ...)

FLXMCbtreg(formula = . ~ ., type = c("loglin", "logit"), ref = NULL,
  undecided = NULL, position = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="btmix_+3A_formula">formula</code></td>
<td>
<p>Symbolic description of the model (of type <code>y ~ 1</code>
or <code>y ~ x</code>).</p>
</td></tr>
<tr><td><code id="btmix_+3A_data">data</code>, <code id="btmix_+3A_subset">subset</code></td>
<td>
<p>Arguments controlling formula processing.</p>
</td></tr>
<tr><td><code id="btmix_+3A_k">k</code></td>
<td>
<p>A vector of integers indicating the number of components of
the finite mixture; passed in turn to the <code>k</code> argument
of <code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>.</p>
</td></tr>
<tr><td><code id="btmix_+3A_weights">weights</code></td>
<td>
<p>An optional vector of weights to be used in the fitting
process; passed in turn to the <code>weights</code> argument of
<code><a href="flexmix.html#topic+flexmix">flexmix</a></code>.</p>
</td></tr>
<tr><td><code id="btmix_+3A_nrep">nrep</code></td>
<td>
<p>Number of runs of the EM algorithm.</p>
</td></tr>
<tr><td><code id="btmix_+3A_cluster">cluster</code></td>
<td>
<p>Either a matrix with <code>k</code> columns of initial
cluster membership probabilities for each observation; or a factor
or integer vector with the initial cluster assignments of
observations at the start of the EM algorithm. Default is random
assignment into <code>k</code> clusters.</p>
</td></tr>
<tr><td><code id="btmix_+3A_control">control</code></td>
<td>
<p>An object of class <code>"FLXcontrol"</code> or a named list;
controls the EM algorithm and passed in turn to the <code>control</code>
argument of <code><a href="flexmix.html#topic+flexmix">flexmix</a></code>.</p>
</td></tr>
<tr><td><code id="btmix_+3A_verbose">verbose</code></td>
<td>
<p>A logical; if <code>TRUE</code> progress information is shown
for different starts of the EM algorithm.</p>
</td></tr>
<tr><td><code id="btmix_+3A_drop">drop</code></td>
<td>
<p>A logical; if <code>TRUE</code> and <code>k</code> is of length 1,
then a single <code>raschmix</code> object is returned instead of a
<code>stepRaschmix</code> object.</p>
</td></tr>
<tr><td><code id="btmix_+3A_unique">unique</code></td>
<td>
<p>A logical; if <code>TRUE</code>, then <code>unique()</code> is
called on the result; for details see
<code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>.</p>
</td></tr>
<tr><td><code id="btmix_+3A_which">which</code></td>
<td>
<p>number of model to get if <code>k</code> is a vector of
integers longer than one. If character, interpreted as
number of components or name of an information criterion.</p>
</td></tr>
<tr><td><code id="btmix_+3A_type">type</code></td>
<td>
<p>Character. Should an auxiliary log-linear Poisson model or
logistic binomial be employed for estimation? The latter is only
available if not undecided effects are estimated.</p>
</td></tr>
<tr><td><code id="btmix_+3A_ref">ref</code></td>
<td>
<p>Character or numeric. Which object parameter should be the
reference category, i.e., constrained to zero?</p>
</td></tr>
<tr><td><code id="btmix_+3A_undecided">undecided</code></td>
<td>
<p>Logical. Should an undecided parameter be estimated?</p>
</td></tr>
<tr><td><code id="btmix_+3A_position">position</code></td>
<td>
<p>Logical. Should a position effect be estimated?</p>
</td></tr>
<tr><td><code id="btmix_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally <code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>
is called with suitable arguments to fit the finite mixture model with
the EM algorithm.
</p>
<p><code>FLXMCbtreg</code> is the <code><a href="flexmix.html#topic+flexmix">flexmix</a></code>-driver for
Bradley-Terry mixture models.
</p>
<p>The interface is designed along the same lines as <code><a href="#topic+raschmix">raschmix</a></code>
which is introduced in detail in Frick et al. (2012). However, the
<code>btmix</code> function has not yet been fully tested and may change in
future versions.  
</p>


<h3>Value</h3>

<p>Either an object of class <code>"btmix"</code> containing the best model
with respect to the log-likelihood (if <code>k</code> is a scalar) or the
one selected according to <code>which</code> (if specified and <code>k</code> is a
vector of integers longer than 1) or an object of class
<code>"stepBTmix"</code> (if <code>which</code> is not specified and <code>k</code> is a
vector of integers longer than 1).
</p>


<h3>References</h3>

<p>Bradley, R.A., and Terry, M.E. (1952). Rank Analysis of Incomplete
Block Designs. I. The Method of Paired Comparisons. <em>Biometrika</em>,
<b>39</b>(3/4), 324&ndash;345.
</p>
<p>Dörr, M. (2011). Bradley Terry Mixture Models: Theory, Implementation
in R and Validation. Diploma Thesis, Ludwig-Maximilians-Universität
München.
</p>
<p>Frick, H., Strobl, C., Leisch, F., and Zeileis, A. (2012).
Flexible Rasch Mixture Models with Package psychomix.
<em>Journal of Statistical Software</em>, <b>48</b>(7), 1&ndash;25.
<a href="http://www.jstatsoft.org/v48/i07/">http://www.jstatsoft.org/v48/i07/</a>.
</p>
<p>Grün, B., and Leisch, F. (2008). FlexMix Version 2: Finite Mixtures
with Concomitant Variables and Varying and Constant Parameters.
<em>Journal of Statistical Software</em>, <b>28</b>(4), 1&ndash;35.
<a href="http://www.jstatsoft.org/v28/i04/">http://www.jstatsoft.org/v28/i04/</a>.
</p>
<p>Leisch, F. (2004). FlexMix: A General Framework for Finite Mixture
Models and Latent Class Regression in R.
<em>Journal of Statistical Software</em>, <b>11</b>(8), 1&ndash;18.
<a href="http://www.jstatsoft.org/v11/i08/">http://www.jstatsoft.org/v11/i08/</a>.
</p>


<h3>See Also</h3>

<p><code><a href="flexmix.html#topic+flexmix">flexmix</a></code>, <code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Data
data("GermanParties2009", package = "psychotools")

## omit single observation with education = 1
gp &lt;- subset(GermanParties2009, education != "1")
gp$education &lt;- factor(gp$education)

## Bradley-Terry mixture models
suppressWarnings(RNGversion("3.5.0"))
set.seed(1)
## fit models for k = 1, ..., 4 with concomitant variables
cm &lt;- btmix(preference ~ gender + education + age + crisis,
  data = gp, k = 1:4, nrep = 3)

## inspect results
plot(cm)

## select model
cm4 &lt;- getModel(cm, which = "4")

## inspect mixture and effects
library("lattice")
xyplot(cm4)
effectsplot(cm4)
effectsplot(cm4, selection = "education")

## vis effects package directly
if(require("effects")) {
eff4 &lt;- allEffects(cm4)
plot(eff4)
}


</code></pre>

<hr>
<h2 id='btmix-class'>Class &quot;btmix&quot;</h2><span id='topic+btmix-class'></span>

<h3>Description</h3>

<p>A fitted <code><a href="#topic+btmix">btmix</a></code> model.</p>


<h3>Slots</h3>


<dl>
<dt><code>model</code>:</dt><dd><p>A <code>FLXMC</code> object for a Bradley-Terry mixture
model</p>
</dd>
<dt><code>prior</code>:</dt><dd><p>Numeric vector with prior probabilities of classes.</p>
</dd>
<dt><code>posterior</code>:</dt><dd><p>Named list with elements <code>scaled</code>
and <code>unscaled</code>, both matrices with one row per observation
and one column per class.</p>
</dd>
<dt><code>iter</code>:</dt><dd><p>Number of EM iterations.</p>
</dd>
<dt><code>k</code>:</dt><dd><p>Number of classes after EM.</p>
</dd>
<dt><code>k0</code>:</dt><dd><p>Number of classes at start of EM.</p>
</dd>
<dt><code>cluster</code>:</dt><dd><p>Class assignments of observations.</p>
</dd>
<dt><code>size</code>:</dt><dd><p>Class sizes.</p>
</dd>
<dt><code>logLik</code>:</dt><dd><p>Log-likelihood at EM convergence.</p>
</dd>
<dt><code>df</code>:</dt><dd><p>Total number of parameters of the model.</p>
</dd>
<dt><code>components</code>:</dt><dd><p>List describing
the fitted components using <code>FLXcomponent</code> objects.</p>
</dd>
<dt><code>formula</code>:</dt><dd><p>Object of class <code>"formula"</code>.</p>
</dd>
<dt><code>control</code>:</dt><dd><p>Object of class <code>"FLXcontrol"</code>.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>The function call
used to create the object.</p>
</dd>
<dt><code>group</code>:</dt><dd><p>Object of class <code>"factor"</code>.</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>Logical, <code>TRUE</code> if EM algorithm converged.</p>
</dd>
<dt><code>concomitant</code>:</dt><dd><p>Object of class <code>"FLXP"</code>.</p>
</dd>
<dt><code>weights</code>:</dt><dd><p>Optional weights of the observations.</p>
</dd>
<dt><code>flx.call</code>:</dt><dd><p>Internal call to <code>stepFlexmix</code></p>
</dd>
<dt><code>nobs</code>:</dt><dd><p>Number of observations.</p>
</dd>
<dt><code>labels</code>:</dt><dd><p>Labels of objects compared.</p>
</dd>
<dt><code>mscale</code>:</dt><dd><p>Measurement scale of paired comparisons data.</p>
</dd>
<dt><code>undecided</code>:</dt><dd><p>logical. Should an undecided parameter be estimated?</p>
</dd>
<dt><code>ref</code>:</dt><dd><p>character or numeric. Which object parameter should be the reference
category, i.e., constrained to zero?</p>
</dd>
<dt><code>type</code>:</dt><dd><p>character. Should an auxiliary log-linear Poisson model or logistic
binomial be employed for estimation? The latter is only available if not undecided
effects are estimated.</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>flexmix</code>, directly.
</p>


<h3>Accessor Functions</h3>

<p>The following functions should be used for accessing the corresponding
slots:
</p>

<dl>
<dt><code>clusters</code>:</dt><dd><p>Cluster assignments of observations.</p>
</dd>
<dt><code>posterior</code>:</dt><dd><p>A matrix of posterior probabilities for each
observation.</p>
</dd>
</dl>


<hr>
<h2 id='btmix-methods'>Methods for btmix Objects</h2><span id='topic+worth+2Cbtmix-method'></span>

<h3>Description</h3>

<p>Methods for <code><a href="#topic+btmix-class">btmix-class</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'btmix'
worth(object, component = NULL)



</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="btmix-methods_+3A_object">object</code></td>
<td>
<p>An object of class <code>"btmix"</code>.</p>
</td></tr>
<tr><td><code id="btmix-methods_+3A_component">component</code></td>
<td>
<p>Indicates which components are returned. Default is
all components.</p>
</td></tr>

</table>


<h3>Details</h3>

<p><code>worth</code> returns the worth parameters from the Bradley-Terry model.
</p>



<hr>
<h2 id='effectsplot'>Effects Displays for Concomitant Variables in Finite Mixture Models</h2><span id='topic+effectsplot'></span><span id='topic+effectsplot.efflist'></span><span id='topic+effectsplot.effpoly'></span><span id='topic+allEffects.btmix'></span><span id='topic+allEffects.mptmix'></span><span id='topic+allEffects.raschmix'></span><span id='topic+effect.btmix'></span><span id='topic+effect.mptmix'></span><span id='topic+effect.raschmix'></span><span id='topic+effectsplot+2Craschmix-method'></span><span id='topic+effectsplot+2Cbtmix-method'></span><span id='topic+effectsplot+2Cmptmix-method'></span>

<h3>Description</h3>

<p>Generic function for visualizing the effects of concomitant variables
in finite mixture models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effectsplot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effectsplot_+3A_object">object</code></td>
<td>
<p>Fitted model object.</p>
</td></tr>
<tr><td><code id="effectsplot_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="effects.html#topic+plot.eff">plot.eff</a></code>,
<code><a href="effects.html#topic+plot.efflist">plot.efflist</a></code>, or <code><a href="effects.html#topic+plot.effpoly">plot.effpoly</a></code>.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p><code>effectsplot</code> is set up to be both an S3 and S4 generic.
The idea is that it provides the glue needed to extract the concomitant
part from a mixture model: First, the concomitant model is
refitted as a <code>multinom</code> object or <code>glm</code> object (in case of
a mixture with two components). Second, <code><a href="effects.html#topic+effect">effect</a></code>
or <code><a href="effects.html#topic+allEffects">allEffects</a></code> from the <span class="pkg">effects</span> package
is called to extract the effects of the concomitants. Third,
the corresponding <code>plot</code> methods from the <span class="pkg">effects</span>
package create the display.
</p>
<p>Currently, this is implemented for <code><a href="#topic+raschmix">raschmix</a></code>,
<code><a href="#topic+btmix">btmix</a></code>, and <code><a href="#topic+mptmix">mptmix</a></code> objects. The interface is not
yet fully tested and may change in future versions.
</p>


<h3>References</h3>

<p>Fox, J. (2003). Effect Displays in R for Generalised Linear Models.
<em>Journal of Statistical Software</em>, <b>8</b>(15), 1&ndash;27.
<a href="http://www.jstatsoft.org/v08/i15/">http://www.jstatsoft.org/v08/i15/</a>
</p>
<p>Fox, J., and Hong, J. (2009). Effect Displays in R for Multinomial
and Proportional-Odds Logit Models: Extensions to the effects Package. 
<em>Journal of Statistical Software</em>, <b>32</b>(1), 1&ndash;24.
<a href="http://www.jstatsoft.org/v32/i01/">http://www.jstatsoft.org/v32/i01/</a>
</p>


<h3>See Also</h3>

<p><code><a href="effects.html#topic+effect">effect</a></code>, <code><a href="effects.html#topic+allEffects">allEffects</a></code>,
<code><a href="nnet.html#topic+multinom">multinom</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data on party preferences in Germany
## (omit single observation with education = 1)
data("GermanParties2009", package = "psychotools")
gp &lt;- subset(GermanParties2009, education != "1")
gp$education &lt;- factor(gp$education)

## fit Bradley-Terry mixture, see ?btmix for more details
## and a fully-worked example
suppressWarnings(RNGversion("3.5.0"))
set.seed(2)
cm4 &lt;- btmix(preference ~ gender + education + age + crisis, data = gp, k = 4, nrep = 1)

## inspect mixture and effects
library("lattice")
xyplot(cm4)
effectsplot(cm4)

## vis effects package directly
if(require("effects")) {
eff4 &lt;- allEffects(cm4)
plot(eff4)
}

</code></pre>

<hr>
<h2 id='mptmix'>Finite Mixtures of Multinomial Processing Tree Models</h2><span id='topic+mptmix'></span><span id='topic+FLXMCmpt'></span>

<h3>Description</h3>

<p>Fit finite mixtures of multinomial processing tree (MPT) models via maximum
likelihood with the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mptmix(formula, data, k, subset, weights,
          nrep = 3, cluster = NULL, control = NULL,
          verbose = TRUE, drop = TRUE, unique = FALSE, which = NULL,
          spec, treeid = NULL,
          optimargs = list(control = list(reltol =
            .Machine$double.eps^(1/1.2), maxit = 1000)), ...)

FLXMCmpt(formula = . ~ ., spec = NULL, treeid = NULL, optimargs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mptmix_+3A_formula">formula</code></td>
<td>
<p>Symbolic description of the model (of type <code>y ~ 1</code>
or <code>y ~ x</code>).</p>
</td></tr>
<tr><td><code id="mptmix_+3A_data">data</code>, <code id="mptmix_+3A_subset">subset</code></td>
<td>
<p>Arguments controlling formula processing.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_k">k</code></td>
<td>
<p>A vector of integers indicating the number of components of
the finite mixture; passed in turn to the <code>k</code> argument
of <code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_weights">weights</code></td>
<td>
<p>An optional vector of weights to be used in the fitting
process; passed in turn to the <code>weights</code> argument of
<code><a href="flexmix.html#topic+flexmix">flexmix</a></code>.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_nrep">nrep</code></td>
<td>
<p>Number of runs of the EM algorithm.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_cluster">cluster</code></td>
<td>
<p>Either a matrix with <code>k</code> columns of initial
cluster membership probabilities for each observation; or a factor
or integer vector with the initial cluster assignments of
observations at the start of the EM algorithm. Default is random
assignment into <code>k</code> clusters.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_control">control</code></td>
<td>
<p>An object of class <code>"FLXcontrol"</code> or a named list;
controls the EM algorithm and passed in turn to the <code>control</code>
argument of <code><a href="flexmix.html#topic+flexmix">flexmix</a></code>.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_verbose">verbose</code></td>
<td>
<p>A logical; if <code>TRUE</code> progress information is shown
for different starts of the EM algorithm.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_drop">drop</code></td>
<td>
<p>A logical; if <code>TRUE</code> and <code>k</code> is of length 1,
then a single <code>mptmix</code> object is returned instead of a
<code>stepMPTmix</code> object.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_unique">unique</code></td>
<td>
<p>A logical; if <code>TRUE</code>, then <code>unique()</code> is
called on the result; for details see
<code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_which">which</code></td>
<td>
<p>number of model to get if <code>k</code> is a vector of
integers longer than one. If character, interpreted as
number of components or name of an information criterion.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_spec">spec</code>, <code id="mptmix_+3A_treeid">treeid</code>, <code id="mptmix_+3A_optimargs">optimargs</code></td>
<td>
<p>arguments for the MPT model passed on to
<code><a href="psychotools.html#topic+mptmodel">mptmodel</a></code>.</p>
</td></tr>
<tr><td><code id="mptmix_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally <code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>
is called with suitable arguments to fit the finite mixture model with
the EM algorithm.
</p>
<p><code>FLXMCmpt</code> is the <code><a href="flexmix.html#topic+flexmix">flexmix</a></code> driver for
MPT mixture models.
</p>
<p>The interface is designed along the same lines as <code><a href="#topic+raschmix">raschmix</a></code>
which is introduced in detail in Frick et al. (2012). However, the
<code>mptmix</code> function has not yet been fully tested and may change in
future versions.  
</p>
<p>The latent-class MPT model (Klauer, 2006) is equivalent to an MPT mixture
model without concomitant variables.
</p>
<p>MPT models are specified using the <code>mptspec</code> function. See the
documentation in the <span class="pkg">mpt</span> package for details.
</p>


<h3>Value</h3>

<p>Either an object of class <code>"mptmix"</code> containing the best model
with respect to the log-likelihood (if <code>k</code> is a scalar) or the
one selected according to <code>which</code> (if specified and <code>k</code> is a
vector of integers longer than 1) or an object of class
<code>"stepMPTmix"</code> (if <code>which</code> is not specified and <code>k</code> is a
vector of integers longer than 1).
</p>


<h3>References</h3>

<p>Frick, H., Strobl, C., Leisch, F., and Zeileis, A. (2012).
Flexible Rasch Mixture Models with Package psychomix.
<em>Journal of Statistical Software</em>, <b>48</b>(7), 1&ndash;25.
<a href="http://www.jstatsoft.org/v48/i07/">http://www.jstatsoft.org/v48/i07/</a>
</p>
<p>Klauer, K.C. (2006).
Hierarchical Multinomial Processing Tree Models: A Latent-Class Approach.
<em>Psychometrika</em>, <b>71</b>, 7&ndash;31.
doi: <a href="https://doi.org/10.1007/s11336-004-1188-3">10.1007/s11336-004-1188-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="flexmix.html#topic+flexmix">flexmix</a></code>, <code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Data
data("PairClustering", package = "psychotools")
pc &lt;- reshape(PairClustering, timevar = "trial", idvar = "ID",
              direction = "wide")

## Latent-class MPT model (Klauer, 2006)
suppressWarnings(RNGversion("3.5.0"))
set.seed(1)
m &lt;- mptmix(as.matrix(pc[-1]) ~ 1, data = pc, k = 1:3,
            spec = mptspec("SR", .replicates = 2))
m1 &lt;- getModel(m, which = "BIC")

## Inspect results
summary(m1)
parameters(m1)
plot(m1)

library(lattice)
xyplot(m1)


</code></pre>

<hr>
<h2 id='mptmix-class'>Class &quot;mptmix&quot;</h2><span id='topic+mptmix-class'></span>

<h3>Description</h3>

<p>A fitted <code><a href="#topic+mptmix">mptmix</a></code> model.</p>


<h3>Slots</h3>


<dl>
<dt><code>model</code>:</dt><dd><p>A <code>FLXMC</code> object for an MPT mixture model</p>
</dd>
<dt><code>prior</code>:</dt><dd><p>Numeric vector with prior probabilities of classes.</p>
</dd>
<dt><code>posterior</code>:</dt><dd><p>Named list with elements <code>scaled</code>
and <code>unscaled</code>, both matrices with one row per observation
and one column per class.</p>
</dd>
<dt><code>iter</code>:</dt><dd><p>Number of EM iterations.</p>
</dd>
<dt><code>k</code>:</dt><dd><p>Number of classes after EM.</p>
</dd>
<dt><code>k0</code>:</dt><dd><p>Number of classes at start of EM.</p>
</dd>
<dt><code>cluster</code>:</dt><dd><p>Class assignments of observations.</p>
</dd>
<dt><code>size</code>:</dt><dd><p>Class sizes.</p>
</dd>
<dt><code>logLik</code>:</dt><dd><p>Log-likelihood at EM convergence.</p>
</dd>
<dt><code>df</code>:</dt><dd><p>Total number of parameters of the model.</p>
</dd>
<dt><code>components</code>:</dt><dd><p>List describing
the fitted components using <code>FLXcomponent</code> objects.</p>
</dd>
<dt><code>formula</code>:</dt><dd><p>Object of class <code>"formula"</code>.</p>
</dd>
<dt><code>control</code>:</dt><dd><p>Object of class <code>"FLXcontrol"</code>.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>The function call used to create the object.</p>
</dd>
<dt><code>group</code>:</dt><dd><p>Object of class <code>"factor"</code>.</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>Logical, <code>TRUE</code> if EM algorithm converged.</p>
</dd>
<dt><code>concomitant</code>:</dt><dd><p>Object of class <code>"FLXP"</code>.</p>
</dd>
<dt><code>weights</code>:</dt><dd><p>Optional weights of the observations.</p>
</dd>
<dt><code>flx.call</code>:</dt><dd><p>Internal call to <code>stepFlexmix</code></p>
</dd>
<dt><code>nobs</code>:</dt><dd><p>Number of observations.</p>
</dd>

</dl>



<h3>Extends</h3>

<p>Class <code>flexmix</code>, directly.
</p>


<h3>Accessor Functions</h3>

<p>The following functions should be used for accessing the corresponding
slots:
</p>

<dl>
<dt><code>clusters</code>:</dt><dd><p>Cluster assignments of observations.</p>
</dd>
<dt><code>posterior</code>:</dt><dd><p>A matrix of posterior probabilities for each
observation.</p>
</dd>
</dl>


<hr>
<h2 id='raschmix'>Finite Mixtures of Rasch Models</h2><span id='topic+raschmix'></span><span id='topic+FLXMCrasch'></span>

<h3>Description</h3>

<p>Fit finite mixtures of Rasch models for item response data via
conditional maximum likelihood with the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raschmix(formula, data, k, subset, weights, scores = c("saturated", "meanvar"),
  restricted = FALSE, nrep = 3, cluster = NULL, control = NULL, verbose = TRUE,
  drop = TRUE, unique = FALSE, which = NULL, reltol = 1e-10, deriv = "sum",
  hessian = FALSE, restart = TRUE, model = NULL, gradtol = reltol, ...)

FLXMCrasch(formula = . ~ ., scores = "saturated", delta = NULL, nonExtremeProb = 1,
  ref = 1, reltol = 1e-10, deriv = "sum", hessian = FALSE,
  restart = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raschmix_+3A_formula">formula</code></td>
<td>
<p>Symbolic description of the model (of type <code>y ~ 1</code>
or <code>y ~ x</code>).</p>
</td></tr>
<tr><td><code id="raschmix_+3A_data">data</code>, <code id="raschmix_+3A_subset">subset</code></td>
<td>
<p>Arguments controlling formula processing.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_k">k</code></td>
<td>
<p>A vector of integers indicating the number of components of
the finite mixture; passed in turn to the <code>k</code> argument
of <code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_weights">weights</code></td>
<td>
<p>An optional vector of weights to be used in the fitting
process; passed in turn to the <code>weights</code> argument of
<code><a href="flexmix.html#topic+flexmix">flexmix</a></code>.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_scores">scores</code></td>
<td>
<p>Indicates which model should be fitted
for the score probabilities: either a <code>saturated</code> model with a
separate parameter for each score probability, or, for <code>meanvar</code>,
a multinomial logit model with a location and a scale parameter.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_restricted">restricted</code></td>
<td>
<p>Logical. Should the score distributions be
restricted to being equal across components? See Frick et al. (2015)
for details.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_nrep">nrep</code></td>
<td>
<p>Number of runs of the EM algorithm.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_cluster">cluster</code></td>
<td>
<p>Either a matrix with <code>k</code> columns of initial
cluster membership probabilities for each observation; or a factor
or integer vector with the initial cluster
assignments of observations at the start of the EM
algorithm.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_control">control</code></td>
<td>
<p>An object of class <code>"FLXcontrol"</code> or a named list;
controls the EM algorithm and passed in turn to the <code>control</code>
argument of <code><a href="flexmix.html#topic+flexmix">flexmix</a></code>.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_verbose">verbose</code></td>
<td>
<p>A logical; if <code>TRUE</code> progress information is shown
for different starts of the EM algorithm.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_drop">drop</code></td>
<td>
<p>A logical; if <code>TRUE</code> and <code>k</code> is of length 1,
then a single <code>raschmix</code> object is returned instead of a
<code>stepRaschmix</code> object.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_unique">unique</code></td>
<td>
<p>A logical; if <code>TRUE</code>, then <code>unique()</code> is
called on the result; for details see
<code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_which">which</code></td>
<td>
<p>number of model to get if <code>k</code> is a vector of
integers longer than one. If character, interpreted as
number of components or name of an information criterion.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_nonextremeprob">nonExtremeProb</code></td>
<td>
<p>A numeric giving the probability of scoring
either none or all items.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_ref">ref</code></td>
<td>
<p>Reference category for the saturated score model.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_reltol">reltol</code>, <code id="raschmix_+3A_gradtol">gradtol</code>, <code id="raschmix_+3A_deriv">deriv</code>, <code id="raschmix_+3A_hessian">hessian</code></td>
<td>
<p>Control parameters passed to
<code><a href="psychotools.html#topic+RaschModel.fit">RaschModel.fit</a></code> for the M-step. The <code>gradtol</code>
argument is deprecated and <code>reltol</code> should be used instead.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_restart">restart</code></td>
<td>
<p>Logical. Should the estimation of the item parameters
be restarted in each iteration? If FALSE, the estimates from the
previous M-step are used as starting values.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_delta">delta</code></td>
<td>
<p>Parameters of score model. If <code>NULL</code>, a score model
is estimated.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_model">model</code></td>
<td>
<p>An object inheriting from class <code>"FLXM"</code> for the
<code><a href="flexmix.html#topic+flexmix">flexmix</a></code>-driver, as typically produced by
<code>FLXMCrasch</code>. By default <code>FLXMCrasch</code> is called automatically
with the parameters computed from <code>raschmix</code>.</p>
</td></tr>
<tr><td><code id="raschmix_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>raschmix</code> is intended as a convenience interface to the
<code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code> function from the <span class="pkg">flexmix</span> package
(Leisch 2004, Grün and Leisch 2008). The formula argument of
raschmix is used to describe the model in terms of both items and
concomitant variables, if any. On the left-hand side of the formula
the item are specified, either as a matrix <code>y</code> or as single items
<code>y1 + y2 + y3 + ...</code>. On the right-hand side, the concomitant
variables are specified. If no concomitant variables are to be
included in the model, the right-hand side of the is just written as
<code>~ 1</code>. See Frick et al. (2012) for a detailed introduction.
</p>
<p><code>raschmix</code> processes this model description and calls
<code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code> with the suitable driver
<code>FLXMCrasch</code>. Usually, the driver does not need to be called by
itself, but it is of course also possible to call
<code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code> directly with this driver to fit
Rasch mixture models.
</p>
<p>The Rasch mixture model with saturated score distribution as proposed
by Rost (1990) is also known as &ldquo;Mixed Rasch Model&rdquo;. The
mean-variance score distribution was suggested by Rost and von Davier
(1995). A more recent extension is the restricted score specification
by Frick et al. (2015) who also provide an extensive comparison using
Monte Carlo studies.
</p>


<h3>Value</h3>

<p>Either an object of class <code>"raschmix"</code> containing the best model
with respect to the log-likelihood (if <code>k</code> is a scalar) or the
one selected according to <code>which</code> (if specified and <code>k</code> is a
vector of integers longer than 1) or an object of class
<code>"stepRaschmix"</code> (if <code>which</code> is not specified and <code>k</code> is a
vector of integers longer than 1).
</p>


<h3>References</h3>

<p>Frick, H., Strobl, C., Leisch, F., and Zeileis, A. (2012).
Flexible Rasch Mixture Models with Package psychomix.
<em>Journal of Statistical Software</em>, <b>48</b>(7), 1&ndash;25.
<a href="http://www.jstatsoft.org/v48/i07/">http://www.jstatsoft.org/v48/i07/</a>.
</p>
<p>Frick, H., Strobl, C., and Zeileis, A. (2015).
Rasch Mixture Models for DIF Detection: A Comparison of Old and New
Score Specifications.
<em>Educational and Psychological Measurement</em>, <b>75</b>(2), 208&ndash;234.
doi:10.1177/0013164414536183.
</p>
<p>Grün, B., and Leisch, F. (2008). FlexMix Version 2: Finite Mixtures
with Concomitant Variables and Varying and Constant Parameters.
<em>Journal of Statistical Software</em>, <b>28</b>(4), 1&ndash;35.
<a href="http://www.jstatsoft.org/v28/i04/">http://www.jstatsoft.org/v28/i04/</a>.
</p>
<p>Leisch, F. (2004). FlexMix: A General Framework for Finite Mixture
Models and Latent Class Regression in R.
<em>Journal of Statistical Software</em>, <b>11</b>(8), 1&ndash;18.
<a href="http://www.jstatsoft.org/v11/i08/">http://www.jstatsoft.org/v11/i08/</a>.
</p>
<p>Rost, J. (1990). Rasch Models in Latent Classes: An Integration of Two
Approaches to Item Analysis.
<em>Applied Psychological Measurement</em>, <b>14</b>(3), 271&ndash;282.
</p>
<p>Rost, J., and von Davier, M. (1995). Mixture Distribution Rasch Models.
In Fischer, G.H., and Molenaar, I.W. (eds.),
<em>Rasch Models: Foundations, Recent Developments, and Applications</em>,
chapter 14, pp. 257&ndash;268. Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="flexmix.html#topic+flexmix">flexmix</a></code>, <code><a href="flexmix.html#topic+stepFlexmix">stepFlexmix</a></code>,
<code><a href="#topic+simRaschmix">simRaschmix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##########
## Data ##
##########

## simulate response from Rost's scenario 2 (with 2 latent classes)
suppressWarnings(RNGversion("3.5.0"))
set.seed(1)
r2 &lt;- simRaschmix(design = "rost2")

## plus informative and non-informative concomitants
d &lt;- data.frame(
  x1 = rbinom(nrow(r2), prob = c(0.4, 0.6)[attr(r2, "cluster")], size = 1),
  x2 = rnorm(nrow(r2))
)
d$resp &lt;- r2

## fit model with 2 latent classes (here the number is known a priori)
m &lt;- raschmix(r2, k = 2, scores = "saturated")
summary(m)

## see below for examples which do not use this a priori information
## (these take a little longer to compute) 



####################################################
## Rasch mixture model with saturated score model ##
## (Rost, 1990)                                   ##
####################################################

## fit models for k = 1, 2, 3
m1 &lt;- raschmix(r2, k = 1:3, score = "saturated")
## equivalently: m1 &lt;- raschmix(resp ~ 1, data = d, k = 1:3, score = "saturated")

## inspect results
m1
plot(m1)

## select best BIC model
BIC(m1)
m1b &lt;- getModel(m1, which = "BIC")
summary(m1b)

## compare estimated with true item parameters
parameters(m1b, "item") ##  9 items, item_1 = 0
worth(m1b)              ## 10 items, sum = 0
attr(r2, "difficulty")

## graphical comparison
plot(m1b, pos = "top")
for(i in 1:2) lines(attr(r2, "difficulty")[,i], lty = 2, type = "b")

## extract estimated raw score probabilities
## (approximately equal across components and roughly uniform)
scoreProbs(m1b)

## note: parameters() and worth() take "component" argument
parameters(m1b, "item",  component = 2)
parameters(m1b, "score", component = 1)
worth(m1b, component = 2:1)

## inspect posterior probabilities
histogram(m1b)
head(posterior(m1b)) ## for first observations only

## compare resulting clusters with true groups
table(model = clusters(m1b), true = attr(r2, "cluster"))




################################################################
##  Rasch mixture model with mean/variance score distribution ##
## (Rost &amp; von Davier, 1995)                                  ##
################################################################

## more parsimonious parameterization,
## fit multinomial logit model for score probabilities

## fit models and select best BIC
m2 &lt;- raschmix(r2, k = 1:3, score = "meanvar")
plot(m2)
m2b &lt;- getModel(m2, which = "BIC")

## compare number of estimated parameters
dim(parameters(m2b)) 
dim(parameters(m1b)) 

## graphical comparison with true parameters
plot(m2b, pos = "top")
for(i in 1:2) lines(attr(r2, "difficulty")[,i], lty = 2, type = "b")

## results from non-parametric and parametric specification
## essentially identical
max(abs(worth(m1b) - worth(m2b, component = 2:1)))



###########################
## Concomitant variables ##
###########################

## employ concomitant variables (x1 = informative, x2 = not)
## Not run: 
## fit model
cm2 &lt;- raschmix(resp ~ x1 + x2, data = d, k = 2:3, score = "meanvar")

## BIC selection
rbind(m2 = BIC(m2), cm2 = c(NA, BIC(cm2)))
cm2b &lt;- getModel(cm2, which = "BIC")

## concomitant coefficients
parameters(cm2b, which = "concomitant")

## End(Not run)


##########
## Misc ##
##########

## note: number of clusters can either be chosen directly
## or directly selected via AIC (or BIC, ICL)
## Not run: 
raschmix(r2, k = 2)
raschmix(r2, k = 1:3, which = "AIC")

## End(Not run)
</code></pre>

<hr>
<h2 id='raschmix-class'>Class &quot;raschmix&quot;</h2><span id='topic+raschmix-class'></span>

<h3>Description</h3>

<p>A fitted <code><a href="#topic+raschmix">raschmix</a></code> model.</p>


<h3>Slots</h3>


<dl>
<dt><code>model</code>:</dt><dd><p>A <code>FLXMC</code> object for a Rasch mixture
model</p>
</dd>
<dt><code>prior</code>:</dt><dd><p>Numeric vector with prior probabilities of classes.</p>
</dd>
<dt><code>posterior</code>:</dt><dd><p>Named list with elements <code>scaled</code>
and <code>unscaled</code>, both matrices with one row per observation
and one column per class.</p>
</dd>
<dt><code>iter</code>:</dt><dd><p>Number of EM iterations.</p>
</dd>
<dt><code>k</code>:</dt><dd><p>Number of classes after EM.</p>
</dd>
<dt><code>k0</code>:</dt><dd><p>Number of classes at start of EM.</p>
</dd>
<dt><code>cluster</code>:</dt><dd><p>Class assignments of observations.</p>
</dd>
<dt><code>size</code>:</dt><dd><p>Class sizes.</p>
</dd>
<dt><code>logLik</code>:</dt><dd><p>Log-likelihood at EM convergence.</p>
</dd>
<dt><code>df</code>:</dt><dd><p>Total number of
parameters of the model.</p>
</dd>
<dt><code>components</code>:</dt><dd><p>List describing
the fitted components using <code>FLXcomponent</code> objects.</p>
</dd>
<dt><code>formula</code>:</dt><dd><p>Object of class <code>"formula"</code>.</p>
</dd>
<dt><code>control</code>:</dt><dd><p>Object of class <code>"FLXcontrol"</code>.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>The function call
used to create the object.</p>
</dd>
<dt><code>group</code>:</dt><dd><p>Object of class <code>"factor"</code>.</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>Logical, <code>TRUE</code> if EM algorithm converged.</p>
</dd>
<dt><code>concomitant</code>:</dt><dd><p>Object of class <code>"FLXP"</code>..</p>
</dd>
<dt><code>weights</code>:</dt><dd><p>Optional weights of the observations.</p>
</dd>
<dt><code>scores</code>:</dt><dd><p>Type of score model employed.</p>
</dd>
<dt><code>restricted</code>:</dt><dd><p>Logical. Is the score model equal across components?</p>
</dd>
<dt><code>deriv</code>:</dt><dd><p>Type of derivatives used for computing
gradient and Hessian matrix. Analytical with sum algorithm (<code>"sum"</code>),
analytical with difference algorithm (<code>"diff"</code>, faster but numerically unstable),
or numerical.</p>
</dd>
<dt><code>extremeScoreProbs</code>:</dt><dd><p>Estimated probability of solving
either all or no items.</p>
</dd>
<dt><code>rawScoresData</code>:</dt><dd><p>Table of raw scores from the data.</p>
</dd>
<dt><code>flx.call</code>:</dt><dd><p>Internal call to <code>stepFlexmix</code></p>
</dd>
<dt><code>nobs</code>:</dt><dd><p>Number of observations without missing values,
excluding observations with an extreme score.</p>
</dd>
<dt><code>identified.items</code>:</dt><dd><p>Factor indicating which items are identified.</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>flexmix</code>, directly.
</p>


<h3>Accessor Functions</h3>

<p>The following functions should be used for accessing the corresponding
slots:
</p>

<dl>
<dt><code>clusters</code>:</dt><dd><p>Cluster assignments of observations.</p>
</dd>
<dt><code>posterior</code>:</dt><dd><p>A matrix of posterior probabilities for each
observation.</p>
</dd>
</dl>


<hr>
<h2 id='raschmix-methods'>Methods for raschmix Objects</h2><span id='topic+show+2Craschmix-method'></span><span id='topic+summary+2Craschmix-method'></span><span id='topic+show+2Csummary.raschmix-method'></span><span id='topic+parameters+2Craschmix-method'></span><span id='topic+worth+2Craschmix-method'></span><span id='topic+itempar+2Craschmix-method'></span><span id='topic+scoreProbs'></span>

<h3>Description</h3>

<p>Methods for <code><a href="#topic+raschmix-class">raschmix-class</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'raschmix'
summary(object, eps = 1e-4, ...)

## S4 method for signature 'raschmix'
parameters(object,
       which = c("model", "item", "score", "concomitant"),
       difficulty = TRUE, component = NULL, simplify = TRUE)

## S4 method for signature 'raschmix'
worth(object, difficulty = TRUE, component = NULL)

## S4 method for signature 'raschmix'
itempar(object, ref = NULL, alias = TRUE, ...)

scoreProbs(object, component = NULL, simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raschmix-methods_+3A_object">object</code></td>
<td>
<p>An object of class <code>"raschmix"</code>.</p>
</td></tr>
<tr><td><code id="raschmix-methods_+3A_eps">eps</code></td>
<td>
<p>Probabilities below this threshold are treated as zero in the
summary method.</p>
</td></tr>
<tr><td><code id="raschmix-methods_+3A_which">which</code></td>
<td>
<p>Indicates which type of parameters are used. <code>model</code>
refers to both item and score parameters, <code>item</code> and
<code>score</code> to their corresponding parameters separately. The
parameters of the concomitant model are accessed through
<code>concomitant</code>.</p>
</td></tr>
<tr><td><code id="raschmix-methods_+3A_difficulty">difficulty</code></td>
<td>
<p>Indicates whether item difficulty (default) or
easiness parameters are used.</p>
</td></tr>
<tr><td><code id="raschmix-methods_+3A_component">component</code></td>
<td>
<p>Indicates which components are returned. Default is
all components.</p>
</td></tr>
<tr><td><code id="raschmix-methods_+3A_ref">ref</code></td>
<td>
<p>a vector of labels or position indices of item parameters or
a contrast matrix which should be used as restriction/for
normalization. If 'NULL' (the default), all items are used (sum zero
restriction).</p>
</td></tr>
<tr><td><code id="raschmix-methods_+3A_alias">alias</code></td>
<td>
<p>logical. If 'TRUE' (the default), the aliased parameter is
included in the return vector. If 'FALSE', it is removed. If the
restriction given in 'ref' depends on several parameters, the first
parameter of the restriction specified is (arbitrarily) chosen to be
removed if 'alias' is 'FALSE'.</p>
</td></tr>
<tr><td><code id="raschmix-methods_+3A_simplify">simplify</code></td>
<td>
<p>Should the result be simplified if possible?</p>
</td></tr>
<tr><td><code id="raschmix-methods_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>worth</code> transforms the item parameters so that the sum over all
item parameters (within each component) is zero.
</p>
<p><code>itempar</code> allows for the flexible specification of the
restriction applied to the item parameters.
</p>
<p><code>scoreProbs</code> does not include any aliased parameters if a certain
raw score is not present in the data.
</p>

<hr>
<h2 id='raschmix-plot-method'>Profile Plot of Item Parameters</h2><span id='topic+plot+2Craschmix-method'></span><span id='topic+plot+2Craschmix+2Cmissing-method'></span><span id='topic+histogram.raschmix'></span><span id='topic+xyplot.raschmix'></span>

<h3>Description</h3>

<p>The <code>plot</code> method for <code><a href="#topic+raschmix-class">raschmix-class</a></code> objects gives a
base plot of the item parameter profiles in each class. A lattice plot
of the item parameters is returned by <code>xyplot</code>. A rootogram or
histogram of the posterior probabilities is plotted via <code>histogram</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'raschmix,missing'
plot(x, y, component = NULL, difficulty = TRUE,
                   center = TRUE, index = TRUE, names = TRUE,
                   abbreviate = FALSE, ref = TRUE, col =  "black",
                   refcol = "lightgray", linecol = NULL, lty = 2, cex = 1,
                   pch = 19, type = NULL, ylim = NULL, xlab = "Items",
                   ylab = NULL, legend = TRUE, pos = "topright",
                   srt = 45, adj = c(1.1, 1.1), ...)
## S3 method for class 'raschmix'
histogram(x, data, root = TRUE, ...)
## S3 method for class 'raschmix'
xyplot(x, data, component = NULL, item = NULL,
  difficulty = TRUE, plot.type = c("multiple", "single"),
  auto.key = NULL, type = "b", lty = NULL, xlab = "Item", ylab = NULL,
  panel = NULL, scales = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raschmix-plot-method_+3A_x">x</code></td>
<td>
<p>An object of class <code>"raschmix"</code>.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_y">y</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_component">component</code></td>
<td>
<p>A vector indicating which components should be
plotted.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_difficulty">difficulty</code></td>
<td>
<p>Logical. Should item difficulty parameters be used?</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_center">center</code></td>
<td>
<p>Logical. Should the item parameters be centered around 0?</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_index">index</code></td>
<td>
<p>Logical. Should the index be used for labelling the items?</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_names">names</code></td>
<td>
<p>Either logical or an optional vector of names used for
labeling of the items.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_abbreviate">abbreviate</code></td>
<td>
<p>Logical. Should the labels of the items be abbreviated?</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_ref">ref</code></td>
<td>
<p>Logical. Should a reference line be drawn?</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_col">col</code></td>
<td>
<p>Point color. If <code>col</code> is a vector, it is
interpreted as the color of the components respectively. Individual
coloring within components is possible if col is given as a matrix
with each column representing one component.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_refcol">refcol</code></td>
<td>
<p>Color of the reference line.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_linecol">linecol</code></td>
<td>
<p>Line color. Defaults to the point color.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_lty">lty</code>, <code id="raschmix-plot-method_+3A_cex">cex</code>, <code id="raschmix-plot-method_+3A_pch">pch</code>, <code id="raschmix-plot-method_+3A_type">type</code>, <code id="raschmix-plot-method_+3A_ylim">ylim</code>, <code id="raschmix-plot-method_+3A_xlab">xlab</code>, <code id="raschmix-plot-method_+3A_ylab">ylab</code></td>
<td>
<p>Further standard
graphical parameters.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_legend">legend</code></td>
<td>
<p>Logical. Should a legend be included?</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_pos">pos</code></td>
<td>
<p>Position of the legend.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_srt">srt</code>, <code id="raschmix-plot-method_+3A_adj">adj</code></td>
<td>
<p>Passed on to text() if names = TRUE.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_data">data</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_root">root</code></td>
<td>
<p>Logical. Should a rootogram be drawn?</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_item">item</code></td>
<td>
<p>A vector indicating which items should be plotted.</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_plot.type">plot.type</code></td>
<td>
<p>Should the item profiles be drawn in multiple panels
or a single panel?</p>
</td></tr>
<tr><td><code id="raschmix-plot-method_+3A_auto.key">auto.key</code>, <code id="raschmix-plot-method_+3A_panel">panel</code>, <code id="raschmix-plot-method_+3A_scales">scales</code></td>
<td>
<p>Further graphical parameters for lattice.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a graphical representation of the item parameter in each class use
<code>plot</code> (for a base graph) or <code>xyplot</code> (for a lattice plot).
</p>
<p>For a graphical representation of the quality of the mixture use
<code>histogram</code>. For details see <code><a href="flexmix.html#topic+plot-methods">plot-methods</a></code>.
</p>


<h3>References</h3>

<p>Frick, H., Strobl, C., Leisch, F., and Zeileis, A. (2012).
Flexible Rasch Mixture Models with Package psychomix.
<em>Journal of Statistical Software</em>, <b>48</b>(7), 1&ndash;25.
<a href="http://www.jstatsoft.org/v48/i07/">http://www.jstatsoft.org/v48/i07/</a>.
</p>
<p>Leisch, F. (2004). FlexMix: A General Framework for Finite Mixture
Models and Latent Class Regression in R.
<em>Journal of Statistical Software</em>, <b>11</b>(8), 1&ndash;18.
<a href="http://www.jstatsoft.org/v11/i08/">http://www.jstatsoft.org/v11/i08/</a>.
</p>
<p>Leisch, F. (2004). Exploring the Structure of Mixture Model
Components. In Jaromir Antoch, editor, <em>Compstat 2004 &ndash; Proceedings in
Computational Statistics</em>, pages 1405&ndash;1412. Physika Verlag, Heidelberg,
Germany. ISBN 3-7908-1554-3.
</p>

<hr>
<h2 id='simRaschmix'>Simulate Data from Rasch Mixture Models</h2><span id='topic+simRaschmix'></span>

<h3>Description</h3>

<p>Generate simulated data from mixtures of Rasch models. The latent
classes of the mixture can differ regarding size as well as item and
person parameters of the corresponding Rasch model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  simRaschmix(design, extremes = FALSE, attributes = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simRaschmix_+3A_design">design</code></td>
<td>
<p>Type of data generating process. Can be provided as a
character or a named list. See Details.</p>
</td></tr>
<tr><td><code id="simRaschmix_+3A_extremes">extremes</code></td>
<td>
<p>Logical. Should observations with none or all items
solved be included in the data?</p>
</td></tr>
<tr><td><code id="simRaschmix_+3A_attributes">attributes</code></td>
<td>
<p>Logical. Should the true group membership as well as
true item and person parameters be attached to the data as attributes
<code>"cluster"</code>, <code>"difficulty"</code>, and <code>"ability"</code>?</p>
</td></tr>
<tr><td><code id="simRaschmix_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>design</code> of the data generating process (DGP) can be provided
in essentially three different ways.
</p>
<p>If the <code>design</code> argument is one of <code>"rost1"</code>, <code>"rost2"</code>
or <code>"rost3"</code>, responses from the three DGPs introduced in Rost
(1990) will be drawn.
</p>
<p>Alternatively, the <code>design</code> can be provided as a named list with
elements <code>nobs</code>, <code>weights</code>, <code>ability</code>, and
<code>difficulty</code>.
The <code>weights</code> can be provided in three formats: If provided as a
vector of probabilities (summing to 1), class membership will be drawn
with these probabilities. If <code>weights</code> is a vector of integer weights
(summing to <code>nobs</code>, or an integer division thereof), Class sizes
will be either the weights directly or a multiple thereof. As a third
alternative, the <code>weights</code> can be provided as a
function of the number of observations (<code>nobs</code>).
The <code>ability</code> specification can also be provided in three
formats: If provided as a matrix of dimension 2xk with mean and
standard deviation for each of the k clusters, the ability parameters
are drawn from a normal distribution with the corresponding parameters.
Second, <code>ability</code> can be an array of dimension (., 2, k) with abilities
and corresponding weights/probabilities per cluster. Third, it can
also be provided as a list of k functions which take the number of
observations as an argument.
The specification of the item <code>difficulty</code> can be
provided either as a matrix with k columns with the item
difficulties per cluster or as a matrix with <code>nobs</code> rows with the item
difficulties per subject.
</p>
<p>As a third option, <code>design</code> may also be a named list containing a
vector of <code>ability</code> parameters and a matrix
<code>difficulty</code> of dimension (number of observation x number of items).
</p>


<h3>Value</h3>

<p>A matrix of item responses with dimension (number of observations x
number of items).
If <code>attributes = TRUE</code>, the matrix has attributes <code>cluster</code>,
<code>ability</code>, and <code>difficulty</code>. The class memberships
<code>cluster</code> are only returned when not provided implicitly through
and a vector of abilties and a difficulty matrix with entries for each
subject.
</p>


<h3>References</h3>

<p>Frick, H., Strobl, C., Leisch, F., and Zeileis, A. (2012).
Flexible Rasch Mixture Models with Package psychomix.
<em>Journal of Statistical Software</em>, <b>48</b>(7), 1&ndash;25.
<a href="http://www.jstatsoft.org/v48/i07/">http://www.jstatsoft.org/v48/i07/</a>.
</p>
<p>Rost, J. (1990). Rasch Models in Latent Classes: An Integration of Two
Approaches to Item Analysis.
<em>Applied Psychological Measurement</em>, <b>14</b>(3), 271&ndash;282.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+raschmix">raschmix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#################
## Rost's DGPs ##
#################

suppressWarnings(RNGversion("3.5.0"))
set.seed(1990)

## DGP 1 with just one latent class 
r1 &lt;- simRaschmix(design = "rost1")
## less than 1800 observations because the extreme scorers have been removed
table(attr(r1, "ability"))
table(rowSums(r1))

## DGP 2 with 2 equally large latent classes
r2 &lt;- simRaschmix(design = "rost2", extreme = TRUE)
## exactly 1800 observations including the extreme scorers
table(attr(r2, "ability"))
table(rowSums(r2))

## DGP 3 with 3 latent classes
r3 &lt;- simRaschmix(design = "rost3")
## item parameters in the three latent classes
attr(r3, "difficulty")


####################################
## flexible specification of DGPs ##
####################################

suppressWarnings(RNGversion("3.5.0"))
set.seed(482)

## number of observations
nobs &lt;- 8

## relative weights
weights &lt;- c(1/4, 3/4)
## exact weights: either summing to nobs or an integer division thereof
weights &lt;- c(2, 6)
weights &lt;- c(1, 3)
## weights as function
## here the result is the same as when specifying relative weights
weights &lt;- function(n) sample(size = n, 1:2, prob = c(1/4, 3/4), replace
= TRUE)

## class 1: only ability level 0
## class 2: normally distributed abilities with mean = 2 and sd = 1
ability &lt;- cbind(c(0, 0), c(2, 1))
## class 1: 3 ability levels (-1, 0, 1); class 2: 2 ability levels (-0.5, 0.5)
## with equal probabilities and frequencies, repectively
ability &lt;- array(c(cbind(-1:1, rep(1/3, 3)), cbind(-1:1/2, c(0.5, 0, 0.5))), 
  dim = c(3, 2, 2))
ability &lt;- array(c(cbind(-1:1, rep(1, 3)), cbind(-1:1/2, c(1, 0, 1))),
  dim = c(3, 2, 2))
## ability as function
ability &lt;- list(
  function(n) rnorm(n, mean = 0, sd = 0.5),
  function(n) sample(c(-0.5, 0.5), size = n, replace = TRUE)
)

## difficulty per latent class
difficulty &lt;- cbind(c(-1,1,rep(0,8)), c(rep(0,8),1,-1))

## simulate data
dat &lt;- simRaschmix(design = list(nobs = nobs, weights = weights,
  ability = ability, difficulty = difficulty))

## inspect attributes and raw scores
table(attr(dat, "cluster"))
hist(attr(dat, "ability"))
barplot(table(rowSums(dat)))
attr(dat, "difficulty")


## specification of DGP only via ability and difficulty
## one vector of abilities of all subjects
ability &lt;- c(rnorm(4, mean = 0, sd = 0.5), sample(c(-0.5, 0.5), size = 4, 
  replace = TRUE))
## difficulty per subject
difficulty &lt;- matrix(c(rep(c(-1,1,rep(0,8)), 4), rep(c(rep(0,8),1,-1), 4)),
  nrow = 8, byrow = TRUE)
## simulate data
dat &lt;- simRaschmix(design = list(ability = ability, difficulty = difficulty))

## inspect attributes and raw scores
hist(attr(dat, "ability"))
barplot(table(rowSums(dat)))
attr(dat, "difficulty")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
