<!DOCTYPE html><html lang="en"><head><title>Help for package allomr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {allomr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allomr'>
<p>Removing Allometric Effects of Body Size in Morphological Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Removing Allometric Effects of Body Size in Morphological
Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the technique of Lleonart et al. 
    (2000) &lt;<a href="https://doi.org/10.1006%2Fjtbi.2000.2043">doi:10.1006/jtbi.2000.2043</a>&gt; to scale body measurements 
    that exhibit an allometric growth. This procedure is a theoretical 
    generalization of the technique used by Thorpe 
    (1975) &lt;<a href="https://doi.org/10.1111%2Fj.1095-8312.1975.tb00732.x">doi:10.1111/j.1095-8312.1975.tb00732.x</a>&gt; and
    Thorpe (1976) &lt;<a href="https://doi.org/10.1111%2Fj.1469-185X.1976.tb01063.x">doi:10.1111/j.1469-185X.1976.tb01063.x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-26 10:39:53 UTC; ping</td>
</tr>
<tr>
<td>Author:</td>
<td>Sämi Schär <a href="https://orcid.org/0000-0001-6108-4832"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sämi Schär &lt;saemi.schaer@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-26 11:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='allomr'>
Removing Allometric Effects of Body Size in Morphological Analysis
</h2><span id='topic+allomr'></span>

<h3>Description</h3>

<p>Implementation of the technique of Lleonart et al. (2000) &lt;doi:10.1006/jtbi.2000.2043&gt; to scale body measurements that exhibit an allometric growth. This procedure is a theoretical generalization of the technique used by Thorpe (1975) &lt;doi:10.1111/j.1095-8312.1975.tb00732.x&gt; and Thorpe (1976) &lt;doi:10.1111/j.1469-185X.1976.tb01063.x&gt;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>allomr(X, Y, X0, a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="allomr_+3A_x">X</code></td>
<td>

<p>Required. A numerical vector, containing the first set of body measurements.
</p>
</td></tr>
<tr><td><code id="allomr_+3A_y">Y</code></td>
<td>

<p>Required. Either a numerical vector or an entire data set, containing the second set of body measurements. These are the measurements from which allometric effects will be removed. This is achieved by calculating Y*, the normalized value of Y this subject would reach when X=X0.
</p>
</td></tr>
<tr><td><code id="allomr_+3A_x0">X0</code></td>
<td>

<p>Optional. The value of X for which Y should be normalized. Default is the mean of X.
</p>
</td></tr>
<tr><td><code id="allomr_+3A_a">a</code></td>
<td>

<p>Optional. The regression parameter a. Derived from data if not specified or if Y is a data set.
</p>
</td></tr>
<tr><td><code id="allomr_+3A_b">b</code></td>
<td>

<p>Optional. The regression parameter b. Derived from data if not specified or if Y is a data set.
</p>
</td></tr></table>


<h3>Details</h3>

<p>Calculates <code class="reqn">X_{0}</code> as the mean of <code class="reqn">X</code> and the regression parameters <code class="reqn">a</code> and <code class="reqn">b</code> (if not specified) according to equation (A.5). <code class="reqn">Y^*</code> is calculated according to equation (13) and the particular shape factor <code class="reqn">exp(\varepsilon_{i})</code> according to equation (9) in Lleonart et al. (2000) &lt;doi:10.1006/jtbi.2000.2043&gt;.
</p>


<h3>Value</h3>

<p>A list containing sample size for <code class="reqn">X</code> (n), the regression parameters <code class="reqn">a</code> (a) and <code class="reqn">b</code> (b), <code class="reqn">X_{0}</code> (X0), a vector containing the normalized values <code class="reqn">Y^*</code> (Yx) and a vector containing the values for the particular shape factor <code class="reqn">exp(\varepsilon_{i})</code> (exp_e).
</p>


<h3>Author(s)</h3>

<p>Sämi Schär
</p>


<h3>References</h3>

<p>Lleonart et al. (2000). J. theor. Biol. 205, 85-93. &lt;doi:10.1006/jtbi.2000.2043&gt;
</p>
<p>Thorpe (1975). Biol. J. Linn. Soc. 7, 27-43. &lt;doi:10.1111/j.1095-8312.1975.tb00732.x&gt;
</p>
<p>Thorpe (1976), Biol. Rev. 51, 407-452. &lt;doi:10.1111/j.1469-185X.1976.tb01063.x&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## examples from Lleonart et al. (2000), Appendix B
## note: small differences due to rounding in paper

## Table B1
gr1&lt;-NULL
gr1$X&lt;- c(10.223, 11.184,12.251,11.922,11.485,11.625,11.303,11.662)
gr1$Y&lt;- c(1.184,1.371,1.676,1.662,1.509,1.539,1.481,1.417)
gr1$Group&lt;-c(rep(1, 8))
gr1d &lt;- as.data.frame(gr1)

gr2&lt;-NULL
gr2$X&lt;- c(11.415,11.684,11.668, 11.322,12.553,12.213, 10.814, 10.493)
gr2$Y&lt;-c(1.364,1.508,1.535,1.387,1.522,1.502,1.256,1.230)
gr2$Group&lt;-c(rep(2, 8))
gr2d &lt;- as.data.frame(gr2)

B1 &lt;- as.data.frame(rbind(gr1d, gr2d))

allomr(B1$X, B1$Y)


## Table B2
gr1&lt;-NULL
gr1$X&lt;- c(3.050,2.783,2.492,3.543,2.495)
gr1$Y&lt;- c(2.349,2.129,1.936,2.813,1.908)
gr1$Group&lt;-c(rep(1, 5))
gr1d &lt;- as.data.frame(gr1)

gr2&lt;-NULL
gr2$X&lt;- c(4.088,4.264,3.200,4.038,3.855)
gr2$Y&lt;- c(3.307,3.405,2.528,3.217,3.102)
gr2$Group&lt;-c(rep(2, 5))
gr2d &lt;- as.data.frame(gr2)

B2 &lt;- as.data.frame(rbind(gr1d, gr2d))

allomr(X=B2$X, Y=B2$Y, X0=3.4, a=0.705, b=1.092)


## The function is currently defined as
allomr &lt;- function(X, Y, X0, a, b){
  if (is.vector(Y)==TRUE){
    m1 &lt;- lm(log(Y)~log(X))
    n &lt;- length(X[!is.na(X)])
    if (missing(a)){
      a &lt;- exp(m1$coefficients[1])
    }
    if (missing(b)){
      b &lt;- m1$coefficients[2]
    }
    if (missing(X0)){
      X0 &lt;- mean(X, na.rm=TRUE)
    }
    Yx &lt;- Y*(X0/X)^b
    exp_e &lt;- Y/(a*X^b)
    obj &lt;-list(n, a, b, X0, Yx, exp_e)
    names(obj) &lt;-c("n","a","b","X0","Yx","exp_e")
    class(obj) &lt;- "allomr"
    return(obj)
  }
  else {
    if (!missing(a) | !missing(b)){
      message("NOTE: Y is a data set. Regression parameters will be derived from data.")
    }
    a&lt;-NULL
    b&lt;-NULL
    Yx&lt;-NULL
    exp_e&lt;-NULL
    for (i in 1:ncol(Y)){
      m1&lt;- lm(log(Y[[i]])~log(X))
      n&lt;-length(X[!is.na(X)])
      a&lt;- cbind(a, exp(m1$coefficients[1]))
      b&lt;- cbind(b, m1$coefficients[2])
      if (missing(X0)){
        X0&lt;-mean(X, na.rm=TRUE)
      }
      Yx&lt;- cbind(Yx, Y[[i]]*(X0/X)^m1$coefficients[2])
      exp_e&lt;- cbind(exp_e, Y[[i]]/(exp(m1$coefficients[1])*X^m1$coefficients[2]))
    }
    obj &lt;-list(n, a, b, X0, Yx, exp_e)
    names(obj) &lt;-c("n","a","b","X0","Yx","exp_e")
    class(obj) &lt;- "allomr"
    return(obj)
  }
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
