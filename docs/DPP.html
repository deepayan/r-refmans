<!DOCTYPE html><html><head><title>Help for package DPP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DPP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DPP-package'>
<p>Inference of Parameters of Normal Distributions from a Mixture of Normals</p></a></li>
<li><a href='#dppMCMC_C'><p>A Reference Class that provides DPP functionality</p></a></li>
<li><a href='#expectedNumberOfClusters'><p>Calculate the expected number of clusters from the number of individuals and a concentration parameter</p></a></li>
<li><a href='#GammaModel-class'><p>Class <code>"GammaModel"</code></p></a></li>
<li><a href='#NormalModel-class'><p>Class <code>"NormalModel"</code></p></a></li>
<li><a href='#simulateChineseRestaurant'><p>Simulate a discrete distribution as in the chinese restaurant problem</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inference of Parameters of Normal Distributions from a Mixture
of Normals</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>This MCMC method takes a data numeric vector (Y) and assigns the elements of Y
  to a (potentially infinite) number of normal distributions. The individual normal distributions from a mixture of normals can be inferred.
  Following the method described in Escobar (1994) &lt;<a href="https://doi.org/10.2307%2F2291223">doi:10.2307/2291223</a>&gt; we use a Dirichlet Process Prior (DPP) to describe stochastically our prior assumptions about the dimensionality of the data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, Rcpp (&ge; 0.12.4), coda, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RcppModules:</td>
<td>DPPmcmc,Models</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-24 06:17:07 UTC; lavila</td>
</tr>
<tr>
<td>Author:</td>
<td>Luis M. Avila [aut, cre],
  Michael R. May [aut],
  Jeff Ross-Ibarra [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luis M. Avila &lt;lmavila@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-24 08:38:30 UTC</td>
</tr>
</table>
<hr>
<h2 id='DPP-package'>
Inference of Parameters of Normal Distributions from a Mixture of Normals
</h2><span id='topic+DPP-package'></span><span id='topic+DPP'></span><span id='topic+DPPmcmc'></span><span id='topic+Model'></span><span id='topic+Rcpp_DPPmcmc'></span><span id='topic+Rcpp_Model'></span>

<h3>Description</h3>

<p>This MCMC method takes a data numeric vector (Y) and assigns the elements of Y
to a (potentially infinite) number of normal distributions. The individual normal distributions from a mixture of normals can be inferred.
Following the method described in Escobar (1994) &lt;doi:10.2307/2291223&gt; we use a Dirichlet Process Prior (DPP) to describe stochastically our prior assumptions about the dimensionality of the data.
</p>


<h3>Details</h3>

<p>DPP implements a Bayesian method to get a posterior
probability for k normal distributions form a vector of n numeric values.
We implemented an MCMC method as described in Escobar (1994). Using a Dirichlet process prior we describe stochastically our prior assumptions about the dimensionality of the data without specifying a fix number of clusters k, allowing us to infer the number of normal distributions or categories from a potentially infinite number of categories.
DPP is implemented in C++ and made available to used within the R statistical environment using Rcpp (Eddelbuettel and Francois, 2011).
</p>


<h3>Author(s)</h3>

<p>Luis M. Avila, Michael R. May, Jeff Ross-Ibarra
</p>
<p>Maintainer: Luis M. Avila &lt;lmavila@gmail.com&gt;
</p>


<h3>References</h3>

<p>Ferguson, Thomas S. A Bayesian analysis of some nonparametric problems. The annals of statistics (1973): 209-230.
</p>
<p>Antoniak, Charles E. Mixtures of Dirichlet processes with applications to Bayesian nonparametric problems. The Annals of Statistics (1974): 1152-1174.
</p>
<p>Escobar, Michael D. Estimating Normal Means With a Dirichlet Process Prior. Journal of the American Statistical Association, 89(425), 1994.
</p>
<p>Neal, Radford M. Markov chain sampling methods for Dirichlet process mixture models. Journal of Computational and Graphical Statistics 9.2 (2000): 249-265.
</p>
<p>Eddelbuettel, Dirk and Romain Francois. Rcpp: Seamless R and C++ Integration. Journal Of Statistical Software, 40(8):1-18, 2011.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>normal.model&lt;-new(NormalModel,
                  mean_prior_mean=0.5,
                  mean_prior_sd=0.1,
                  sd_prior_shape=3,
                  sd_prior_rate=20,
                  estimate_concentration_parameter=TRUE,
                  concentration_parameter_alpha=10,
                  proposal_disturbance_sd=0.1)

 #simulating three normal distributions
 y &lt;- c(rnorm(100,mean=0.2,sd=0.05), rnorm(100,0.7,0.05), rnorm(100,1.3,0.1))
 hist(y,breaks=30)

 #setwd("~/yourwd") #mcmc log files will be saved here
 my_dpp_analysis &lt;- dppMCMC_C(data=y,
                              output = "output_prefix_",
                              model=normal.model,
                              num_auxiliary_tables=4,
                              expected_k=1.5,
                              power=1)
 #running the mcmc  , generations will be ignored because auto_stop=true
 ## Not run: 
 my_dpp_analysis$run(generations=1000,auto_stop=TRUE,max_gen = 10000,min_ess = 500)

 #we get rid of the first 25% of the output (burn-in)
 hist(my_dpp_analysis$getNumCategoryTrace(0.25))
 my_dpp_analysis$getNumCategoryProbabilities(0.25)
 
## End(Not run)
</code></pre>

<hr>
<h2 id='dppMCMC_C'>A Reference Class that provides DPP functionality</h2><span id='topic+dppMCMC_C'></span>

<h3>Description</h3>

<p>This class implements the main functionality of this package.
The consturctor receives a numeric vector (Y) and priors. A model should be provided specifying  the distributions
to be used for inference (e.g. NormalModel for Normal distributions or GammaModel for Gamma distributions).
Then an MCMC algorithm will be used to infer a number of distributions (k) that fit the data.
The prior for the number of distributions is specified by the concentration_parameter_alpha and expected_k.
Once the data and priors are specified the method run is used to start the inference.
</p>


<h3>Details</h3>

<p>Class dppMCMC_C
Class <code>dppMCMC_C</code> A Reference Class that provides DPP functionality
</p>


<h3>Fields</h3>


<dl>
<dt><code>dpp_mcmc_object</code></dt><dd><p>a DPPmcmc object</p>
</dd>
</dl>


<h3>Methods</h3>


<dl>
<dt><code>getNumCategoryProbabilities(burnin_cutoff = 0.25)</code></dt><dd><p>returns the probabilities vector for inferred number of categories</p>
</dd>
<dt><code>getNumCategoryTrace(burnin_cutoff = 0.25)</code></dt><dd><p>returns the trace vector for the inferred number of categories in the data</p>
</dd>
<dt><code>initialize(data, output, model, num_auxiliary_tables = 4, expected_k = 2,
  power = 1, verbose = TRUE, sample.num.clusters = TRUE)</code></dt><dd><p>the class constructor, initializes DPPmcmc object with data and parameters</p>
</dd>
<dt><code>run(generations, sample_freq = generations/1000, log_file, allocation_file,
  param_file, append = TRUE, random = FALSE, auto_stop = FALSE,
  min_ess = 500, max_gen = 1e+05)</code></dt><dd><p>starts the MCMC run</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>normal.model&lt;-new(NormalModel,
                 mean_prior_mean=0.5,
                 mean_prior_sd=0.1,
                 sd_prior_shape=3,
                 sd_prior_rate=20,
                 estimate_concentration_parameter=TRUE,
                 concentration_parameter_alpha=10,
                  proposal_disturbance_sd=0.1)

#simulating three normal distributions
y &lt;- c(rnorm(100,mean=0.2,sd=0.05), rnorm(100,0.7,0.05), rnorm(100,1.3,0.1))
hist(y,breaks=30)

#setwd("~/yourwd") #mcmc log files will be saved here
## Not run: 
my_dpp_analysis &lt;- dppMCMC_C(data=y,
                             output = "output_prefix_",
                             model=normal.model,
                             num_auxiliary_tables=4,
                             expected_k=1.5,
                             power=1)
#running the mcmc  , generations will be ignored because auto_stop=true
my_dpp_analysis$run(generations=1000,auto_stop=TRUE,max_gen = 10000,min_ess = 500)

#we get rid of the first 25% of the output (burn-in)
hist(my_dpp_analysis$getNumCategoryTrace(0.25))

my_dpp_analysis$getNumCategoryProbabilities(0.25)

## End(Not run)

</code></pre>

<hr>
<h2 id='expectedNumberOfClusters'>Calculate the expected number of clusters from the number of individuals and a concentration parameter</h2><span id='topic+expectedNumberOfClusters'></span>

<h3>Description</h3>

<p>Calculate the expected number of clusters from the number of individuals and a concentration parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expectedNumberOfClusters(n, a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expectedNumberOfClusters_+3A_n">n</code></td>
<td>
<p>the number of individuals</p>
</td></tr>
<tr><td><code id="expectedNumberOfClusters_+3A_a">a</code></td>
<td>
<p>the concentration parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the expected number of clusters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expectedNumberOfClusters(100,0.2)
expectedNumberOfClusters(100,0.15)
</code></pre>

<hr>
<h2 id='GammaModel-class'>Class <code>"GammaModel"</code></h2><span id='topic+GammaModel'></span>

<h3>Description</h3>

<p>Objects of the GammaModel class are initialized with prior parameters to be used by the MCMC algorithm in dppMCMC_C class.
An object of the class GammaModel will be passed as an argument upon creation
of the dppMCMC_C object that will run the MCMC code.
</p>


<h3>Methods</h3>

<pre>new(GammaModel,
                    shape_prior_mean=4,
                    shape_prior_sd=1,
                    rate_prior_mean=1.5,
                    rate_prior_sd=0.54,
                    estimate_concentration_parameter=TRUE,
                    concentration_parameter_alpha=10,
                    proposal_disturbance_sd=0.1)
       instantiates a GammaModel object

getParameters()
  returns a list with the parameters and arguments supplied upon object initialization </pre>


<h3>Examples</h3>

<pre><code class='language-R'>#creating an object of the class NormalModel
gamma.model&lt;-new(GammaModel,
                    shape_prior_mean=4,
                    shape_prior_sd=1,
                    rate_prior_mean=1.5,
                    rate_prior_sd=0.54,
                    estimate_concentration_parameter=TRUE,
                    concentration_parameter_alpha=10,
                    proposal_disturbance_sd=0.1)
gamma.model$getParameters()
</code></pre>

<hr>
<h2 id='NormalModel-class'>Class <code>"NormalModel"</code></h2><span id='topic+NormalModel'></span>

<h3>Description</h3>

<p>Objects of the NormalModel class are initialized with prior parameters to be used by the MCMC algorithm in dppMCMC_C class.
An object of the class NormalMode will be passed as an argument upon creation
of the dppMCMC_C object that will run the MCMC code.
</p>


<h3>Methods</h3>

<pre>new(NormalModel,
    mean_prior_mean=0.5,
    mean_prior_sd=0.1,
    sd_prior_shape=3,
    sd_prior_rate=20,
    estimate_concentration_parameter=TRUE,
    concentration_parameter_alpha=10,
    proposal_disturbance_sd=0.1)
       instantiates a NormalModel object

getParameters()
  returns a list with the parameters and arguments supplied upon object initialization </pre>


<h3>Examples</h3>

<pre><code class='language-R'>#creating an object of the class NormalModel
normal.model&lt;-new(NormalModel,
                  mean_prior_mean=0.5,
                  mean_prior_sd=0.1,
                  sd_prior_shape=3,
                  sd_prior_rate=20,
                  estimate_concentration_parameter=TRUE,
                  concentration_parameter_alpha=10,
                  proposal_disturbance_sd=0.1)
normal.model$getParameters()
</code></pre>

<hr>
<h2 id='simulateChineseRestaurant'>Simulate a discrete distribution as in the chinese restaurant problem</h2><span id='topic+simulateChineseRestaurant'></span>

<h3>Description</h3>

<p>Simulate a discrete distribution as in the chinese restaurant problem
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateChineseRestaurant(num_elements, chi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulateChineseRestaurant_+3A_num_elements">num_elements</code></td>
<td>
<p>the number of elements to be grouped</p>
</td></tr>
<tr><td><code id="simulateChineseRestaurant_+3A_chi">chi</code></td>
<td>
<p>the concentration parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The sum of <code>x</code> and <code>y</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simulateChineseRestaurant(100, 0.2)
simulateChineseRestaurant(100, 0.8)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
