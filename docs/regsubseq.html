<!DOCTYPE html><html><head><title>Help for package regsubseq</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {regsubseq}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#most.gaplin.sub'><p>Find the Most Gap-Linear Subsequence.</p></a></li>
<li><a href='#most.linear.sub'><p>Find the Most Lineaer Subsequence</p></a></li>
<li><a href='#qtables'><p>Quantile Tables of the Linearity/Gap-Linearity Tests</p></a></li>
<li><a href='#recursive.B'><p>Compute the Gap-Linearity Test Statistics</p></a></li>
<li><a href='#test.gaplin'><p> Detect and Test Almost Gap-Linear Subsequnces.</p></a></li>
<li><a href='#test.lin'><p>Detect and Test Almost Linear Subsequences.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Detect and Test Regular Sequences and Subsequences</td>
</tr>
<tr>
<td>Version:</td>
<td>0.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2014-03-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Yanming Di</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yanming Di&lt;diy@stat.oregonstate.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>For a sequence of event occurence times, we are interested in
  finding subsequences in it that are too "regular". We define regular as being
  significantly different from a homogeneous Poisson process. The departure from
  the Poisson process is measured using a L1 distance. See Di and Perlman 2007
  for more details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2014-03-09 17:49:22 UTC; yanming</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2014-03-09 19:18:52</td>
</tr>
</table>
<hr>
<h2 id='most.gaplin.sub'>Find the Most Gap-Linear Subsequence.</h2><span id='topic+most.gaplin.sub'></span>

<h3>Description</h3>

<p>Find the most gap-linear length k+1 subsequence of the input sequence. The
subsequence found by this function has the same end points as the original
sequence. This function is not intended to be used by an end user directly.
Users should use <code>test.gaplin.t</code>, <code>test.gaplin.p</code> or
<code>test.gaplin</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  most.gaplin.sub(x, k, T);
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="most.gaplin.sub_+3A_x">x</code></td>
<td>
<p> The input sequence, a vector of numbers. </p>
</td></tr>
<tr><td><code id="most.gaplin.sub_+3A_k">k</code></td>
<td>
<p> The length of the subsequences for which we want to test gap-linearity. </p>
</td></tr>
<tr><td><code id="most.gaplin.sub_+3A_t">T</code></td>
<td>
<p> A threshold value. A subsequence will only be examined when its
gap-linearity test statistic can be bigger than this <code>t</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>improved</code></td>
<td>
<p><code>TRUE</code> if we found a subsequence with a gap-linearity test
statistic more extreme than the input <code>t</code>.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>The gap-linearity test statistic corresponding to the most gap-linear subsequence.</p>
</td></tr>
<tr><td><code>sub</code></td>
<td>
<p>The most gap-linear subsequence.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The indices corresponding to the most gap-linear subsequence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Yanming Di </p>


<h3>References</h3>

<p>Di and Perlman (2007)</p>


<h3>See Also</h3>

<p><code><a href="#topic+test.gaplin">test.gaplin</a></code>, <code><a href="#topic+test.gaplin.t">test.gaplin.t</a></code>,
<code><a href="#topic+test.gaplin.p">test.gaplin.p</a></code>.
</p>

<hr>
<h2 id='most.linear.sub'>Find the Most Lineaer Subsequence</h2><span id='topic+most.linear.sub'></span>

<h3>Description</h3>

<p>Find the most linear length k+1 subsequence of the input sequence. The
subsequence found by this function has the same end points as the original
sequence. This function is not intended to be used by an end user directly.
Users should use <code>test.lin.t</code>, <code>test.lin.p</code> or <code>test.lin</code>
instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  most.linear.sub(x, k, t);
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="most.linear.sub_+3A_x">x</code></td>
<td>
<p> The input sequence, a vector of numbers. </p>
</td></tr>
<tr><td><code id="most.linear.sub_+3A_k">k</code></td>
<td>
<p> The length of the subsequences for which we want to test linearity. </p>
</td></tr>
<tr><td><code id="most.linear.sub_+3A_t">t</code></td>
<td>
<p> A threshold value. A subsequence will only be examined when its
linearity test statistic can be bigger than this <code>t</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>improved</code></td>
<td>
<p><code>TRUE</code> if we found a subsequence with a linearity test
statistic more extreme than the input <code>t</code>.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>The linearity test statistic corresponding to the most linear subsequence.</p>
</td></tr>
<tr><td><code>sub</code></td>
<td>
<p>The most linear subsequence.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The indices corresponding to the most linear subsequence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Yanming Di </p>


<h3>References</h3>

<p>Di and Perlman (2007)</p>


<h3>See Also</h3>

<p><code><a href="#topic+test.lin">test.lin</a></code>, <code><a href="#topic+test.lin.t">test.lin.t</a></code>, <code><a href="#topic+test.lin.p">test.lin.p</a></code>.
</p>

<hr>
<h2 id='qtables'>Quantile Tables of the Linearity/Gap-Linearity Tests</h2><span id='topic+q.testlin.n2'></span><span id='topic+q.testlin.n3'></span><span id='topic+q.testlin.n4'></span><span id='topic+q.testlin.n5'></span><span id='topic+q.testlin.n6'></span><span id='topic+q.testlin.n7'></span><span id='topic+q.testlin.n8'></span><span id='topic+q.testlin.n9'></span><span id='topic+q.testlin.n10'></span><span id='topic+q.testlin.n11'></span><span id='topic+q.testlin.n12'></span><span id='topic+q.testlin.n13'></span><span id='topic+q.testlin.n14'></span><span id='topic+q.testlin.n15'></span><span id='topic+q.testlin.n16'></span><span id='topic+q.testlin.n17'></span><span id='topic+q.testlin.n18'></span><span id='topic+q.testlin.n19'></span><span id='topic+q.testlin.n20'></span><span id='topic+q.testlin.n21'></span><span id='topic+q.testlin.n22'></span><span id='topic+q.testlin.n23'></span><span id='topic+q.testlin.n24'></span><span id='topic+q.testlin.n25'></span><span id='topic+q.testlin.n26'></span><span id='topic+q.testlin.n27'></span><span id='topic+q.testlin.n28'></span><span id='topic+q.testlin.n29'></span><span id='topic+q.testlin.n30'></span><span id='topic+q.testlin.n31'></span><span id='topic+q.testlin.n32'></span><span id='topic+q.testlin.n33'></span><span id='topic+q.testlin.n34'></span><span id='topic+q.testlin.n35'></span><span id='topic+q.testlin.n36'></span><span id='topic+q.testlin.n37'></span><span id='topic+q.testlin.n38'></span><span id='topic+q.testlin.n39'></span><span id='topic+q.testlin.n40'></span><span id='topic+q.testlin.n41'></span><span id='topic+q.testlin.n42'></span><span id='topic+q.testlin.n43'></span><span id='topic+q.testlin.n44'></span><span id='topic+q.testlin.n45'></span><span id='topic+q.testlin.n46'></span><span id='topic+q.testlin.n47'></span><span id='topic+q.testlin.n48'></span><span id='topic+q.testlin.n49'></span><span id='topic+q.testlin.n50'></span><span id='topic+q.testgaplin.n2'></span><span id='topic+q.testgaplin.n3'></span><span id='topic+q.testgaplin.n4'></span><span id='topic+q.testgaplin.n5'></span><span id='topic+q.testgaplin.n6'></span><span id='topic+q.testgaplin.n7'></span><span id='topic+q.testgaplin.n8'></span><span id='topic+q.testgaplin.n9'></span><span id='topic+q.testgaplin.n10'></span><span id='topic+q.testgaplin.n11'></span><span id='topic+q.testgaplin.n12'></span><span id='topic+q.testgaplin.n13'></span><span id='topic+q.testgaplin.n14'></span><span id='topic+q.testgaplin.n15'></span><span id='topic+q.testgaplin.n16'></span><span id='topic+q.testgaplin.n17'></span><span id='topic+q.testgaplin.n18'></span><span id='topic+q.testgaplin.n19'></span><span id='topic+q.testgaplin.n20'></span><span id='topic+q.testgaplin.n21'></span><span id='topic+q.testgaplin.n22'></span><span id='topic+q.testgaplin.n23'></span><span id='topic+q.testgaplin.n24'></span><span id='topic+q.testgaplin.n25'></span><span id='topic+q.testgaplin.n26'></span><span id='topic+q.testgaplin.n27'></span><span id='topic+q.testgaplin.n28'></span><span id='topic+q.testgaplin.n29'></span><span id='topic+q.testgaplin.n30'></span><span id='topic+q.testgaplin.n31'></span><span id='topic+q.testgaplin.n32'></span><span id='topic+q.testgaplin.n33'></span><span id='topic+q.testgaplin.n34'></span><span id='topic+q.testgaplin.n35'></span><span id='topic+q.testgaplin.n36'></span><span id='topic+q.testgaplin.n37'></span><span id='topic+q.testgaplin.n38'></span><span id='topic+q.testgaplin.n39'></span><span id='topic+q.testgaplin.n40'></span><span id='topic+q.testgaplin.n41'></span><span id='topic+q.testgaplin.n42'></span><span id='topic+q.testgaplin.n43'></span><span id='topic+q.testgaplin.n44'></span><span id='topic+q.testgaplin.n45'></span><span id='topic+q.testgaplin.n46'></span><span id='topic+q.testgaplin.n47'></span><span id='topic+q.testgaplin.n48'></span><span id='topic+q.testgaplin.n49'></span><span id='topic+q.testgaplin.n50'></span>

<h3>Description</h3>

<p>The data set provide quantile tables for the linearity/gap-linearity test
statistics for N=2, ..., 50 and k= 2, ..., N, for each N. These tables will be
used to compute p-values corresponding to test statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qtables</code></pre>


<h3>Format</h3>

<p>R rda files. Within each quantile table, the first row indicates at
which probability values the quantiles are computed.</p>

<hr>
<h2 id='recursive.B'>Compute the Gap-Linearity Test Statistics</h2><span id='topic+recursive.B'></span>

<h3>Description</h3>

<p>An internal function used to recursively compte gap-linearity test
statistics. This function is not intended to be used by an end user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recursive.B(x, indices = FALSE);
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recursive.B_+3A_x">x</code></td>
<td>
<p>A sequence of numbers. </p>
</td></tr>
<tr><td><code id="recursive.B_+3A_indices">indices</code></td>
<td>
<p> Whether to keep track of indices of the end points of the most
gap-linear subsequences.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table of computed test statistics. If <code>indices</code> is <code>TRUE</code>,
almost return the indices of the end points of the most gap-linear
subsequences.
</p>


<h3>Author(s)</h3>

<p>Yanming Di</p>


<h3>References</h3>

<p>Di and Perlman (2007)</p>

<hr>
<h2 id='test.gaplin'> Detect and Test Almost Gap-Linear Subsequnces.</h2><span id='topic+test.gaplin'></span><span id='topic+test.gaplin.t'></span><span id='topic+test.gaplin.p'></span>

<h3>Description</h3>

<p><code>test.gaplin.t</code> find the most almost gap-linear length k+1 subsequence
of a given sequence and compute the almost gap-linearity test statistic for
this subsequence. <code>test.gaplin.p</code> compute the p-value corresponding to
a computed test statistic. <code>test.gaplin</code> compute the test statistics
and the p-values for subsequences of all lengths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.gaplin(Tn);
test.gaplin.t(Tn, k);
test.gaplin.p(t, n, k);
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test.gaplin_+3A_tn">Tn</code></td>
<td>
<p>A sequence of numbers. Currently, only support sequence of length
less than 50.</p>
</td></tr>
<tr><td><code id="test.gaplin_+3A_k">k</code></td>
<td>
<p>The length of the subsequences for which we want to test for
almost gap-linearity.</p>
</td></tr>
<tr><td><code id="test.gaplin_+3A_n">n</code></td>
<td>
<p>The length of the sequence for which we want to test for
subsequence almost gap-linearity.</p>
</td></tr>
<tr><td><code id="test.gaplin_+3A_t">t</code></td>
<td>
<p>Test statistic computed for a length k+1 subsequence of a length
n+1 sequence.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Almost gap-linear means the spacings of a subsequence are almost in
proportion to the spacings of the corresponding indicies. For example, for
Tn=c(11, 14, (.), 20), the subs sequence (11, 14, 20) is gap-linear, since the
spacings (3, 6) is in proportion with the spacings of hte corresponding
indicies (1, 2). Equivalently, almost gap-linearity can measured by the
distance between the standardized spacings of the subsequnce and the
standardized spacings of the corresponding indicies. See Di and Perlman (2007)
for more details.
</p>


<h3>Value</h3>

<p><code>test.gaplin.t</code> returns the most gap-linear length k+1 subsequence of the
input sequence and corresponding almost gap-linearity test statistic.
<code>test.gaplin.p</code> returns the p-value corresponding to the input test
statistic <code>t</code>. <code>test.lin</code> has no return value, instead, a table
containing the most almost gap-linear subsequences, corresponding test
staistics and p-values will be outputed.
</p>


<h3>Author(s)</h3>

<p>Yanming Di</p>


<h3>References</h3>

<p>Di and Perlman, 2007</p>


<h3>See Also</h3>

<p><code><a href="#topic+test.lin">test.lin</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## A sequence representing arrival times of events.
  Tn = c(13, 21, 24, 33, 40, 55, 59, 63, 72, 85, 87);

  ## Test for almost linearity.
  t = test.gaplin.t(Tn, 4);
  print(t$sub);
  p = test.gaplin.p(t$t, 10, 4);
  print(p);
  test.gaplin(Tn);
</code></pre>

<hr>
<h2 id='test.lin'>Detect and Test Almost Linear Subsequences.</h2><span id='topic+test.lin'></span><span id='topic+test.lin.t'></span><span id='topic+test.lin.p'></span>

<h3>Description</h3>

<p><code>test.lin.t</code> find the most almost-linear length k+1 subsequence
of a given sequence and compute the almost-linearity test statistic for
this subsequence. <code>test.lin.p</code> compute the p-value corresponding to
a computed test statistic. <code>test.lin</code> compute the test statistics
and the p-values for subsequences of all lengths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.lin(Tn);
test.lin.t(Tn, k);
test.lin.p(t, n, k);
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test.lin_+3A_tn">Tn</code></td>
<td>
<p>A sequence of numbers. Currently, only support sequences of length
less than 50.</p>
</td></tr>
<tr><td><code id="test.lin_+3A_k">k</code></td>
<td>
<p>The length of the subsequences for which we want to test for
almost-linearity.</p>
</td></tr>
<tr><td><code id="test.lin_+3A_n">n</code></td>
<td>
<p>The length of the sequence for which we want to test for
subsequence almost-linearity.</p>
</td></tr>
<tr><td><code id="test.lin_+3A_t">t</code></td>
<td>
<p>Test statistic computed for a length k+1 subsequence of a length
n+1 sequence.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Almost-linear means the spacings of the sequence are almost equal, or
the distance between the standardized spacings as a vector and (1/k,
..., 1/k) is too small. The p-value is computed by comparing the test
statistic to a procomputed test statistic quantile table. See Di and
Perlman (2007) for more details.
</p>


<h3>Value</h3>

<p><code>test.lin.t</code> returns the most linear length k+1 subsequence of
the input sequence and corresponding almost-linearity test
statistic. <code>test.lin.p</code> returns the p-value corresponding to the
input test statistic <code>t</code>. <code>test.lin</code> has no return value,
instead, a table containing the most almost linear subsequences,
corresponding test staistics and p-values will be outputed.
</p>


<h3>Author(s)</h3>

<p>Yanming Di</p>


<h3>References</h3>

<p> Di and Perlman, 2007</p>


<h3>See Also</h3>

<p><code><a href="#topic+test.gaplin">test.gaplin</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## A sequence representing arrival times of events.
  Tn = c(13, 21, 24, 33, 40, 55, 59, 63, 72, 85, 87);

  ## Test for almost linearity.
  t = test.lin.t(Tn, 4);
  print(t$sub);
  p = test.lin.p(t$t, 10, 4);
  print(p);
  test.lin(Tn);
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
