<!DOCTYPE html><html lang="en"><head><title>Help for package Sim.DiffProc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Sim.DiffProc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Sim.DiffProc-package'>
<p>Simulation of Diffusion Processes</p></a></li>
<li><a href='#BM'>
<p>Brownian motion, Brownian bridge, geometric Brownian motion, and arithmetic Brownian motion simulators</p></a></li>
<li><a href='#bridgesde1d'><p>Simulation of 1-D Bridge SDE</p></a></li>
<li><a href='#bridgesde2d'><p>Simulation of 2-D Bridge SDE's</p></a></li>
<li><a href='#bridgesde3d'><p>Simulation of 3-D Bridge SDE's</p></a></li>
<li><a href='#fitsde'><p>Maximum Pseudo-Likelihood Estimation of 1-D SDE</p></a></li>
<li><a href='#fptsde1d'><p>Approximate densities and random generation for first passage time in 1-D SDE</p></a></li>
<li><a href='#fptsde2d'><p>Approximate densities and random generation for first passage time in 2-D SDE's</p></a></li>
<li><a href='#fptsde3d'><p>Approximate densities and random generation for first passage time in 3-D SDE's</p></a></li>
<li><a href='#HWV'>
<p>Hull-White/Vasicek, Ornstein-Uhlenbeck process</p></a></li>
<li><a href='#Irates'>
<p>Monthly Interest Rates</p></a></li>
<li><a href='#MCM.sde'>
<p>Parallel Monte-Carlo Methods for SDE's</p></a></li>
<li><a href='#MEM.sde'>
<p>Moment Equations Methods for SDE's</p></a></li>
<li><a href='#moment'><p>Monte-Carlo statistics of SDE's</p></a></li>
<li><a href='#plot2d'><p>Plotting for Class SDE</p></a></li>
<li><a href='#rsde1d'>
<p>Approximate transitional densities and random generation for 1-D SDE</p></a></li>
<li><a href='#rsde2d'><p>Approximate transitional densities and random generation for 2-D SDE's</p></a></li>
<li><a href='#rsde3d'><p>Approximate transitional densities and random generation for 3-D SDE's</p></a></li>
<li><a href='#snssde1d'><p>Simulation of 1-D Stochastic Differential Equation</p></a></li>
<li><a href='#snssde2d'><p>Simulation of 2-D Stochastic Differential Equation</p></a></li>
<li><a href='#snssde3d'><p>Simulation of 3-D Stochastic Differential Equation</p></a></li>
<li><a href='#st.int'><p>Stochastic Integrals</p></a></li>
<li><a href='#TEX.sde'>
<p>Converting Sim.DiffProc Objects to LaTeX</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>4.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulation of Diffusion Processes</td>
</tr>
<tr>
<td>Author:</td>
<td>Arsalane Chouaib Guidoum
    <a href="https://orcid.org/0000-0003-3781-2160"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre, aut],
  Kamal Boukhetala [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arsalane Chouaib Guidoum &lt;acguidoum@univ-tam.dz&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Deriv (&ge; 3.8.0), MASS (&ge; 7.3-30), parallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>deSolve (&ge; 1.11), knitr (&ge; 1.10), rgl (&ge; 0.93.991),
rmarkdown (&ge; 0.8), scatterplot3d (&ge; 0.3-36), sm (&ge; 2.2-5.3)</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/acguidoum/Sim.DiffProc/issues">https://github.com/acguidoum/Sim.DiffProc/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/acguidoum/Sim.DiffProc">https://github.com/acguidoum/Sim.DiffProc</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>It provides users with a wide range of tools to simulate, estimate, analyze, and visualize the dynamics of stochastic differential systems in both forms Ito and Stratonovich. Statistical analysis with parallel Monte Carlo and moment equations methods of SDEs &lt;<a href="https://doi.org/10.18637%2Fjss.v096.i02">doi:10.18637/jss.v096.i02</a>&gt;. Enabled many searchers in different domains to use these equations to modeling practical problems in financial and actuarial modeling and other areas of application, e.g., modeling and simulate of first passage time problem in shallow water using the attractive center (Boukhetala K, 1996) ISBN:1-56252-342-2. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Classification/MSC:</td>
<td>37H10, 37M10, 60H05, 60H10, 60H35, 60J60, 65C05,
68N15, 68Q10</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-05 22:22:44 UTC; stars</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-06 01:00:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='Sim.DiffProc-package'>
Simulation of Diffusion Processes
</h2><span id='topic+Sim.DiffProc-package'></span><span id='topic+Sim.DiffProc'></span>

<h3>Description</h3>

<p>It provides users with a wide range of tools to simulate, estimate, analyze, and visualize the dynamics of stochastic differential systems in both forms Ito and Stratonovich. Statistical analysis with parallel Monte Carlo and moment equations methods of SDEs &lt;doi:10.18637/jss.v096.i02&gt;. Enabled many searchers in different domains to use these equations to modeling practical problems in financial and actuarial modeling and other areas of application, e.g., modeling and simulate of first passage time problem in shallow water using the attractive center (Boukhetala K, 1996) ISBN:1-56252-342-2. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> Sim.DiffProc </td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 4.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-03-06 </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 4.0.0) </td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Deriv (&gt;= 3.8.0), MASS (&gt;= 7.3-30), parallel </td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> deSolve (&gt;= 1.11), knitr (&gt;= 1.10), rgl (&gt;= 0.93.991), rmarkdown (&gt;= 0.8), scatterplot3d (&gt;= 0.3-36), sm (&gt;= 2.2-5.3) </td>
</tr>
<tr>
 <td style="text-align: left;">
Classification/MSC:</td><td style="text-align: left;"> 37H10, 37M10, 60H05, 60H10, 60H35, 60J60, 65C05, 68N15, 68Q10 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>There are main types of functions in this package:
</p>

<ol>
<li><p> Simulation of solution to 1,2 and 3-dim stochastic differential equations of Itô and Stratonovich types, with different methods.
</p>
</li>
<li><p> Simulation of solution to 1,2 and 3-dim diffusion bridge of Itô and Stratonovich types, with different methods. 
</p>
</li>
<li><p> Simulation the first-passage-time (f.p.t) in 1,2 and 3-dim sde of Itô and Stratonovich types.
</p>
</li>
<li><p> Calculate symbolic ODE's of moment equations (means and variances-covariance) for 1,2 and 3-dim SDE's.
</p>
</li>
<li><p> Monte-Carlo replicates of a statistic applied to 1,2 and 3-dim SDE's at any time t.
</p>
</li>
<li><p> Computing the basic statistics (mean, var, median, ...) of the processes at any time t using the Monte Carlo method.
</p>
</li>
<li><p> Random number generators (RN's) to generate 1,2 and 3-dim sde of Itô and Stratonovich types.
</p>
</li>
<li><p> Approximate the transition density  1,2 and 3-dim of the processes at any time t.
</p>
</li>
<li><p> Approximate the density of first-passage-time in 1,2 and 3-dim SDE's.
</p>
</li>
<li><p> Computing the Itô and Stratonovich stochastic integrals.
</p>
</li>
<li><p> Estimate drift and diffusion parameters by the method of maximum pseudo-likelihood of the one-dim stochastic differential equation.	
</p>
</li>
<li><p> Converting Sim.DiffProc objects to LaTeX.
</p>
</li>
<li><p> Displaying an object inheriting from class <code>"sde"</code> (1,2 and 3 dim).
</p>
</li></ol>

<p>For more examples see <code>demo(Sim.DiffProc)</code>, and for an overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations. 
</p>


<h3>Requirements</h3>

<p><span class="rlang"><b>R</b></span> version &gt;= 4.0.0
</p>


<h3>Citation</h3>

<p>Guidoum AC, Boukhetala K (2020). 
&quot;Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc&quot;. 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1&ndash;82. doi:10.18637/jss.v096.i02
</p>


<h3>Licence</h3>

<p>This package and its documentation are usable under the terms of the &quot;GNU General Public License&quot;, a copy of which is distributed with the package.
</p>


<h3>Author(s)</h3>

<p>A.C. Guidoum <a href="mailto:acguidoum@univ-tam.dz">acguidoum@univ-tam.dz</a> and K. Boukhetala <a href="mailto:kboukhetala@usthb.dz">kboukhetala@usthb.dz</a>.<br /> 
Please send comments, error reports, etc. to the author via the addresses email.
</p>


<h3>References</h3>

<p>Argyrakisa, P. and G.H. Weiss (2006).
A first-passage time problem for many random walkers.
<em>Physica A</em>. <b>363</b>, 343&ndash;347.
</p>
<p>Aytug H., G. J. Koehler (2000). 
New stopping criterion for genetic algorithms. 
<em>European Journal of Operational Research</em>, <b>126</b>, 662&ndash;674.
</p>
<p>Boukhetala, K. (1994). 
Simulation study of a dispersion about an attractive centre. 
In proceedings of 11th Symposium Computational Statistics, edited by R.Dutter and W.Grossman, Wien , Austria, 128&ndash;130.  
</p>
<p>Boukhetala, K. (1996).
Modelling and simulation of a dispersion pollutant with attractive centre.
ed by Computational Mechanics Publications, Southampton ,U.K and Computational Mechanics Inc, Boston, USA, 245&ndash;252.
</p>
<p>Boukhetala, K. (1998a). 
Estimation of the first passage time distribution for a simulated diffusion process.
<em>Maghreb Math.Rev</em>, <b>7</b>(1), 1&ndash;25.
</p>
<p>Boukhetala, K. (1998b). 
Kernel density of the exit time in a simulated diffusion. 
<em>les Annales Maghrebines De L ingenieur</em>, <b>12</b>, 587&ndash;589.
</p>
<p>Ding, M. and G. Rangarajan. (2004). 
First Passage Time Problem: A Fokker-Planck Approach. 
<em>New Directions in Statistical Physics</em>. ed by L. T. Wille. Springer. 31&ndash;46.
</p>
<p>Ait-Sahalia, Y. (1999). 
Transition densities for interest rate and other nonlinear diffusions.
<em>The Journal of Finance</em>, 54, 1361&ndash;1395.
</p>
<p>Ait-Sahalia, Y. (2002). 
Maximum likelihood estimation of discretely sampled diffusions: a closed-form approximation approach. 
<em>Econometrica</em>. 70, 223&ndash;262.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2008).
First-passage-time location function: Application to determine first-passage-time densities in diffusion processes.
<em>Computational Statistics and Data Analysis</em>. <b>52</b>, 4132&ndash;4146.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2012). 
An R package for an efficient approximation of first-passage-time densities for diffusion processes based on the FPTL function. 
<em>Applied Mathematics and Computation</em>, <b>218</b>, 8408&ndash;8428.
</p>
<p>Kessler, M. (1997).  
Estimation of an ergodic diffusion from discrete observations. 
<em>Scand. J. Statist.</em>, 24, 211-229.
</p>
<p>Gardiner, C. W. (1997). 
<em>Handbook of Stochastic Methods</em>.
Springer-Verlag, New York.
</p>
<p>Friedman, A. (1975). 
<em>Stochastic differential equations and applications</em>.
Volume 1, ACADEMIC PRESS.
</p>
<p>Henderson, D. and Plaschko,P. (2006). 
<em>Stochastic differential equations in science and engineering</em>.
World Scientific.
</p>
<p>Croissant, Y. (2014). 
Ecdat: Data sets for econometrics. 
<em><span class="rlang"><b>R</b></span> package version 0.2-5</em>.
</p>
<p>Vasicek, O. (1977). 
An Equilibrium Characterization of the Term Structure.
<em>Journal of Financial Economics</em>,  5, 177&ndash;188. 
</p>
<p>Allen, E. (2007).
<em>Modeling with Itô stochastic differential equations</em>. 
Springer-Verlag.
</p>
<p>Jedrzejewski, F. (2009). 
<em>Modeles aleatoires et physique probabiliste</em>. 
Springer-Verlag.
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York.
</p>
<p>Iacus, S.M. (2014). 
sde: Simulation and Inference for Stochastic Differential Equations. 
<em><span class="rlang"><b>R</b></span> package version 2.0.13</em>. 
</p>
<p>Brouste, A. et al. (2014).
The yuima Project: A Computational Framework for Simulation and Inference of Stochastic Differential Equations.
<em>Journal of Statistical Software</em>, <b>57</b>(4).
</p>
<p>Kloeden, P.E, and Platen, E. (1989). 
A survey of numerical methods for stochastic differential equations. 
<em>Stochastic Hydrology and Hydraulics</em>, <b>3</b>, 155&ndash;178.
</p>
<p>Kloeden, P.E, and Platen, E. (1991a).
Relations between multiple Itô and stratonovich integrals.
<em>Stochastic Analysis and Applications</em>, <b>9</b>(3), 311&ndash;321.
</p>
<p>Kloeden, P.E, and Platen, E. (1991b).
Stratonovich and Itô stochastic taylor expansions. 
<em>Mathematische Nachrichten</em>, <b>151</b>, 33&ndash;50.
</p>
<p>Kloeden, P.E, and Platen, E. (1995).
<em>Numerical Solution of Stochastic Differential Equations</em>. 
Springer-Verlag, New York.
</p>
<p>Oksendal, B. (2000).
<em>Stochastic Differential Equations: An Introduction with Applications</em>.
5th edn. Springer-Verlag, Berlin.
</p>
<p>B.L.S. Prakasa Rao. (1999).
<em>Statistical Inference for Diffusion Type Processes</em>.
Arnold, London and Oxford University press, New York.
</p>
<p>Kutoyants, Y.A. (2004).
<em>Statistical Inference for Ergodic Diffusion Processes</em>.
Springer, London.
</p>
<p>Sorensen, H. (2000).
Inference for Diffusion Processes and Stochastic Volatility Models.
Ph.D. thesis, Department of Mathematical Sciences, University of Copenhagen.
</p>
<p>Sorensen, H. (2002).
Estimation of diffusion parameters for discretely observed diffusion processes.
<em>Bernoulli</em>, 8, 491&ndash;508.
</p>
<p>Sorensen, H. (2004).
Parametric inference for diffusion processes observed at discrete points in time: a survey.
<em>International Statistical Review</em>, 72, 337&ndash;354.
</p>
<p>Platen, E. (1980).
Weak convergence of approximations of Itô integral equations. 
<em>Z Angew Math Mech</em>. <b>60</b>, 609&ndash;614.
</p>
<p>Platen, E. and Bruti-Liberati, N. (2010).
<em>Numerical Solution of Stochastic Differential Equations with Jumps in Finance.</em> 
Springer-Verlag, New York.
</p>
<p>Itô, Y, and Mitsui, T. (1993).
Simulation of Stochastic Differential Equations. 
<em>The Annals of the Institute of Statistical Mathematics</em>, <b>3</b>, 419&ndash;432.
</p>
<p>Risken, H. (2001).
<em>The Fokker Planck Equation : Methods of Solutions and Applications</em>. 
2nd edition, Springer Series in Synergetics.
</p>
<p>Dacunha, D.C. and Florens, D.Z. (1986). 
Estimation of the Coefficients of a Diffusion from Discrete Observations. 
<em>Stochastics</em>. 19, 263&ndash;284.  
</p>
<p>Dohnal, G. (1987).
On estimating the diffusion coefficient.
<em>J. Appl.Prob.</em>, 24, 105&ndash;114.
</p>
<p>Genon, V.C. (1990).
Maximum constrast estimation for diffusion processes from discrete observation.
<em>Statistics</em>, 21, 99&ndash;116.
</p>
<p>Protter, P. (2005). 
<em>Stochastic Integration and Differential Equations.</em>
2nd edn. Springer-Verlag, New York.
</p>
<p>Bladt, M. and Sorensen, M. (2007).
Simple simulation of diffusion bridges with application to likelihood inference for diffusions.
<em>Working Paper, University of Copenhagen</em>. 
</p>
<p>Ozaki, T. (1992). 
A bridge between nonlinear time series models and nonlinear stochastic dynamical systems: A local linearization approach. 
<em>Statistica Sinica</em>, 2, 25-83.
</p>
<p>Shoji, L., Ozaki, T. (1998). 
Estimation for nonlinear stochastic differential equations by a local linearization method. 
<em>Stochastic Analysis and Applications</em>, 16, 733-752.
</p>
<p>Nicolau, J. (2004).
Introduction to the estimation of stochastic differential equations based on discrete observations.
<em>Autumn School and International Conference, Stochastic Finance</em>.
</p>
<p>F C Klebaner, F.C. (2005).
<em>Introduction to stochastic calculus with application.</em> 
2nd edn. Imperial College Press (ICP).
</p>
<p>Henderson, D. and Plaschko, P. (2006). 
<em>Stochastic differential equations in science and engineering.</em>
World Scientific.
</p>


<h3>See Also</h3>

<p>sde, yumia, DiffusionRgqd, DiffusionRjgqd, DiffusionRimp, QPot, diffeqr, fptdApprox.
</p>

<hr>
<h2 id='BM'>
Brownian motion, Brownian bridge, geometric Brownian motion, and arithmetic Brownian motion simulators
</h2><span id='topic+ABM'></span><span id='topic+BB'></span><span id='topic+BM'></span><span id='topic+GBM'></span><span id='topic+ABM.default'></span><span id='topic+BB.default'></span><span id='topic+BM.default'></span><span id='topic+GBM.default'></span>

<h3>Description</h3>

<p>The (S3) generic function for simulation of brownian motion, brownian bridge, geometric brownian motion, and arithmetic brownian motion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BM(N, ...)
BB(N, ...)
GBM(N, ...)
ABM(N, ...)

## Default S3 method:
BM(N =1000,M=1,x0=0,t0=0,T=1,Dt=NULL, ...)
## Default S3 method:
BB(N =1000,M=1,x0=0,y=0,t0=0,T=1,Dt=NULL, ...)
## Default S3 method:
GBM(N =1000,M=1,x0=1,t0=0,T=1,Dt=NULL,theta=1,sigma=1, ...)
## Default S3 method:
ABM(N =1000,M=1,x0=0,t0=0,T=1,Dt=NULL,theta=1,sigma=1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_+3A_n">N</code></td>
<td>
<p>number of simulation steps.</p>
</td></tr>
<tr><td><code id="BM_+3A_m">M</code></td>
<td>
<p>number of trajectories.</p>
</td></tr>
<tr><td><code id="BM_+3A_x0">x0</code></td>
<td>
<p>initial value of the process at time <code class="reqn">t_{0}</code>.</p>
</td></tr>
<tr><td><code id="BM_+3A_y">y</code></td>
<td>
<p>terminal value of the process at time <code class="reqn">T</code> of the <code>BB</code>.</p>
</td></tr>
<tr><td><code id="BM_+3A_t0">t0</code></td>
<td>
<p>initial time.</p>
</td></tr>
<tr><td><code id="BM_+3A_t">T</code></td>
<td>
<p>final time.</p>
</td></tr> 
<tr><td><code id="BM_+3A_dt">Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code><a href="base.html#topic+NULL">NULL</a></code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td></tr>
<tr><td><code id="BM_+3A_theta">theta</code></td>
<td>
<p>the interest rate of the <code>ABM</code> and <code>GBM</code>.</p>
</td></tr>
<tr><td><code id="BM_+3A_sigma">sigma</code></td>
<td>
<p>the volatility of the <code>ABM</code> and <code>GBM</code>.</p>
</td></tr>
<tr><td><code id="BM_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>BM</code> returns a trajectory of the <b>standard Brownian motion</b> (Wiener process) in the time interval <code class="reqn">[t_{0},T]</code>. Indeed, for <code class="reqn">W(dt)</code> it holds true that 
<code class="reqn">W(dt) \rightarrow W(dt) - W(0) \rightarrow \mathcal{N}(0,dt)</code>, where <code class="reqn">\mathcal{N}(0,1)</code> is normal distribution 
<code><a href="stats.html#topic+Normal">Normal</a></code>.
</p>
<p>The function <code>BB</code> returns a trajectory of the <b>Brownian bridge</b> starting at <code class="reqn">x_{0}</code> at time <code class="reqn">t_{0}</code> and ending
at <code class="reqn">y</code> at time <code class="reqn">T</code>; i.e., the diffusion process solution of stochastic differential equation: 
</p>
<p style="text-align: center;"><code class="reqn">dX_{t}= \frac{y-X_{t}}{T-t} dt + dW_{t}</code>
</p>

<p>The function <code>GBM</code> returns a trajectory of the <b>geometric Brownian motion</b> starting at <code class="reqn">x_{0}</code> at time <code class="reqn">t_{0}</code>; 
i.e., the diffusion process solution of stochastic differential equation: 
</p>
<p style="text-align: center;"><code class="reqn">dX_{t}= \theta X_{t} dt + \sigma X_{t} dW_{t}</code>
</p>

<p>The function <code>ABM</code> returns a trajectory of the <b>arithmetic Brownian motion</b> starting at <code class="reqn">x_{0}</code> at time <code class="reqn">t_{0}</code>; 
i.e.,; the diffusion process solution of stochastic differential equation: 
</p>
<p style="text-align: center;"><code class="reqn">dX_{t}= \theta dt + \sigma dW_{t}</code>
</p>



<h3>Value</h3>

<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>an visible <code>ts</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

   
<p>Allen, E. (2007).
<em>Modeling with Ito stochastic differential equations.</em>
Springer-Verlag, New York.
</p>
<p>Jedrzejewski, F. (2009).
<em>Modeles aleatoires et physique probabiliste.</em>
Springer-Verlag, New York.
</p>
<p>Henderson, D and Plaschko, P. (2006). 
<em>Stochastic differential equations in science and engineering.</em>
World Scientific.   
</p>


<h3>See Also</h3>

<p>This functions <code>BM</code>, <code>BBridge</code> and <code>GBM</code> are available in other packages such as &quot;sde&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
op &lt;- par(mfrow = c(2, 2))

## Brownian motion
set.seed(1234)
X &lt;- BM(M = 100)
plot(X,plot.type="single")
lines(as.vector(time(X)),rowMeans(X),col="red")

## Brownian bridge
set.seed(1234)
X &lt;- BB(M =100)
plot(X,plot.type="single")
lines(as.vector(time(X)),rowMeans(X),col="red")

## Geometric Brownian motion
set.seed(1234)
X &lt;- GBM(M = 100)
plot(X,plot.type="single")
lines(as.vector(time(X)),rowMeans(X),col="red")

## Arithmetic Brownian motion
set.seed(1234)
X &lt;- ABM(M = 100)
plot(X,plot.type="single")
lines(as.vector(time(X)),rowMeans(X),col="red")

par(op)
</code></pre>

<hr>
<h2 id='bridgesde1d'>Simulation of 1-D Bridge SDE</h2><span id='topic+bridgesde1d'></span><span id='topic+bridgesde1d.default'></span><span id='topic+print.bridgesde1d'></span><span id='topic+time.bridgesde1d'></span><span id='topic+mean.bridgesde1d'></span><span id='topic+summary.bridgesde1d'></span><span id='topic+Median.bridgesde1d'></span><span id='topic+Mode.bridgesde1d'></span><span id='topic+quantile.bridgesde1d'></span><span id='topic+kurtosis.bridgesde1d'></span><span id='topic+skewness.bridgesde1d'></span><span id='topic+moment.bridgesde1d'></span><span id='topic+cv.bridgesde1d'></span><span id='topic+max.bridgesde1d'></span><span id='topic+min.bridgesde1d'></span><span id='topic+bconfint.bridgesde1d'></span><span id='topic+plot.bridgesde1d'></span><span id='topic+points.bridgesde1d'></span><span id='topic+lines.bridgesde1d'></span>

<h3>Description</h3>

<p>The (S3) generic function <code>bridgesde1d</code> for simulation of 1-dim bridge stochastic differential equations,Itô or Stratonovich type, with different methods.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bridgesde1d(N, ...)
## Default S3 method:
bridgesde1d(N = 1000, M=1, x0 = 0, y = 0, t0 = 0, T = 1, Dt, 
   drift, diffusion, alpha = 0.5, mu = 0.5, type = c("ito", "str"), 
   method = c("euler", "milstein", "predcorr", "smilstein", "taylor", 
   "heun", "rk1", "rk2", "rk3"), ...)
   
## S3 method for class 'bridgesde1d'
summary(object, at ,digits=NULL, ...)							  
## S3 method for class 'bridgesde1d'
time(x, ...)
## S3 method for class 'bridgesde1d'
mean(x, at, ...)
## S3 method for class 'bridgesde1d'
Median(x, at, ...)
## S3 method for class 'bridgesde1d'
Mode(x, at, ...)
## S3 method for class 'bridgesde1d'
quantile(x, at, ...)
## S3 method for class 'bridgesde1d'
kurtosis(x, at, ...)
## S3 method for class 'bridgesde1d'
skewness(x, at, ...)
## S3 method for class 'bridgesde1d'
min(x, at, ...)
## S3 method for class 'bridgesde1d'
max(x, at, ...)
## S3 method for class 'bridgesde1d'
moment(x, at, ...)
## S3 method for class 'bridgesde1d'
cv(x, at, ...)
## S3 method for class 'bridgesde1d'
bconfint(x, at,  ...)

## S3 method for class 'bridgesde1d'
plot(x, ...)
## S3 method for class 'bridgesde1d'
lines(x, ...)
## S3 method for class 'bridgesde1d'
points(x, ...)							  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bridgesde1d_+3A_n">N</code></td>
<td>
<p>number of simulation steps.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_m">M</code></td>
<td>
<p>number of trajectories.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_x0">x0</code></td>
<td>
<p>initial value of the process at time <code>t0</code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_y">y</code></td>
<td>
<p>terminal value of the process at time <code>T</code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_t0">t0</code></td>
<td>
<p>initial time.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_t">T</code></td>
<td>
<p>final time.</p>
</td></tr> 
<tr><td><code id="bridgesde1d_+3A_dt">Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code><a href="base.html#topic+missing">missing</a></code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_drift">drift</code></td>
<td>
<p>drift coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of two variables <code>t</code> and <code>x</code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_diffusion">diffusion</code></td>
<td>
<p>diffusion coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of two variables <code>t</code> and <code>x</code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_alpha">alpha</code>, <code id="bridgesde1d_+3A_mu">mu</code></td>
<td>
<p>weight of the predictor-corrector scheme; the default <code>alpha = 0.5</code> and <code>mu = 0.5</code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_type">type</code></td>
<td>
<p>if <code>type="ito"</code> simulation diffusion bridge of Itô type, else <code>type="str"</code> simulation diffusion bridge of Stratonovich type; the default <code>type="ito"</code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_method">method</code></td>
<td>
<p>numerical methods of simulation, the default <code>method = "euler"</code>; see <code><a href="#topic+snssde1d">snssde1d</a></code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_x">x</code>, <code id="bridgesde1d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>"bridgesde1d"</code>.</p>
</td></tr>
<tr><td><code id="bridgesde1d_+3A_at">at</code></td>
<td>
<p>time between <code>t0</code> and <code>T</code>. Monte-Carlo statistics of the solution <code class="reqn">X_{t}</code> at time <code>at</code>. The default <code>at = T/2</code>.</p>
</td></tr> 
<tr><td><code id="bridgesde1d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr>  
<tr><td><code id="bridgesde1d_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>bridgesde1d</code> returns a trajectory of the diffusion bridge starting at <code>x</code> at time <code>t0</code> and ending at <code>y</code> at time <code>T</code>.
</p>
<p>The methods of approximation are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong 
and the weak (orders of) convergence. The <code>method</code> of simulation can be one among: <code>Euler-Maruyama Order 0.5</code>, <code>Milstein Order 1</code>, <code>Milstein Second-Order</code>, 
<code>Predictor-Corrector method</code>, <code>Itô-Taylor Order 1.5</code>, <code>Heun Order 2</code> and <code>Runge-Kutta Order 1, 2 and 3</code>.
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations. 
</p>


<h3>Value</h3>

<p><code>bridgesde1d</code> returns an object inheriting from <code><a href="base.html#topic+class">class</a></code> <code>"bridgesde1d"</code>.
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>an invisible <code><a href="stats.html#topic+ts">ts</a></code> object.</p>
</td></tr>
<tr><td><code>drift</code></td>
<td>
<p>drift coefficient.</p>
</td></tr>
<tr><td><code>diffusion</code></td>
<td>
<p>diffusion coefficient.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>indices of crossing realized of X(t).</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of sde.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the numerical method used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Bladt, M. and Sorensen, M. (2007).
Simple simulation of diffusion bridges with application to likelihood inference for diffusions.
<em>Working Paper, University of Copenhagen</em>. 
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bridgesde2d">bridgesde2d</a></code> and <code><a href="#topic+bridgesde3d">bridgesde3d</a></code> for 2 and 3-dim. 
</p>
<p><code>DBridge</code> in package &quot;sde&quot;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Ito bridge sde
## Ito Bridge sde
## dX(t) = 2*(1-X(t)) *dt + dW(t)
## x0 = 2 at time t0=0 , and y = 1 at time T=1
set.seed(1234)

f &lt;- expression( 2*(1-x) )
g &lt;- expression( 1 )
mod1 &lt;- bridgesde1d(drift=f,diffusion=g,x0=2,y=1,M=1000)
mod1
summary(mod1) ## Monte-Carlo statistics at T/2=0.5
summary(mod1,at=0.75) ## Monte-Carlo statistics at 0.75
## Not run: 
plot(mod1)
lines(time(mod1),apply(mod1$X,1,mean),col=2,lwd=2)
lines(time(mod1),apply(mod1$X,1,bconfint,level=0.95)[1,],col=4,lwd=2)
lines(time(mod1),apply(mod1$X,1,bconfint,level=0.95)[2,],col=4,lwd=2)
legend("topleft",c("mean path",paste("bound of", 95," percent confidence")),
       inset = .01,col=c(2,4),lwd=2,cex=0.8)

## End(Not run)

## Example 2: Stratonovich sde
## dX(t) = ((2-X(t))/(2-t)) dt + X(t) o dW(t)
## x0 = 2 at time t0=0 , and y = 2 at time T=1
set.seed(1234)

f &lt;- expression((2-x)/(2-t))
g &lt;- expression(x)
mod2 &lt;- bridgesde1d(type="str",drift=f,diffusion=g,M=1000,x0=2,y=2)
mod2
summary(mod2,at = 0.25) ## Monte-Carlo statistics at 0.25
summary(mod2,at = 0.5)  ## Monte-Carlo statistics at 0.5
summary(mod2,at = 0.75 )## Monte-Carlo statistics at 0.75
## Not run: 
plot(mod2)
lines(time(mod2),apply(mod2$X,1,mean),col=2,lwd=2)
lines(time(mod2),apply(mod2$X,1,bconfint,level=0.95)[1,],col=4,lwd=2)
lines(time(mod2),apply(mod2$X,1,bconfint,level=0.95)[2,],col=4,lwd=2)
legend("topright",c("mean path",paste("bound of", 95," percent confidence")),
       inset = .01,col=c(2,4),lwd=2,cex=0.8)

## End(Not run)
</code></pre>

<hr>
<h2 id='bridgesde2d'>Simulation of 2-D Bridge SDE's</h2><span id='topic+bridgesde2d'></span><span id='topic+bridgesde2d.default'></span><span id='topic+print.bridgesde2d'></span><span id='topic+time.bridgesde2d'></span><span id='topic+mean.bridgesde2d'></span><span id='topic+Median.bridgesde2d'></span><span id='topic+Mode.bridgesde2d'></span><span id='topic+quantile.bridgesde2d'></span><span id='topic+kurtosis.bridgesde2d'></span><span id='topic+skewness.bridgesde2d'></span><span id='topic+moment.bridgesde2d'></span><span id='topic+summary.bridgesde2d'></span><span id='topic+cv.bridgesde2d'></span><span id='topic+max.bridgesde2d'></span><span id='topic+min.bridgesde2d'></span><span id='topic+bconfint.bridgesde2d'></span><span id='topic+plot.bridgesde2d'></span><span id='topic+points.bridgesde2d'></span><span id='topic+lines.bridgesde2d'></span><span id='topic+plot2d.bridgesde2d'></span><span id='topic+points2d.bridgesde2d'></span><span id='topic+lines2d.bridgesde2d'></span>

<h3>Description</h3>

<p>The (S3) generic function <code>bridgesde2d</code> for simulation of 2-dim bridge stochastic differential equations,Itô or Stratonovich type, with different methods.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bridgesde2d(N, ...)
## Default S3 method:
bridgesde2d(N = 1000, M = 1, x0 = c(0, 0), 
   y = c(0, 0),t0 = 0, T = 1, Dt,drift, diffusion, corr = NULL,
   alpha = 0.5, mu = 0.5,type = c("ito", "str"),method = 
   c("euler", "milstein","predcorr", "smilstein", "taylor",
   "heun", "rk1", "rk2", "rk3"), ...)

## S3 method for class 'bridgesde2d'
summary(object, at,
     digits=NULL, ...)								  
## S3 method for class 'bridgesde2d'
time(x, ...)
## S3 method for class 'bridgesde2d'
mean(x, at, ...)
## S3 method for class 'bridgesde2d'
Median(x, at, ...)
## S3 method for class 'bridgesde2d'
Mode(x, at, ...)
## S3 method for class 'bridgesde2d'
quantile(x, at, ...)
## S3 method for class 'bridgesde2d'
kurtosis(x, at, ...)
## S3 method for class 'bridgesde2d'
skewness(x, at, ...)
## S3 method for class 'bridgesde2d'
min(x, at, ...)
## S3 method for class 'bridgesde2d'
max(x, at, ...)
## S3 method for class 'bridgesde2d'
moment(x, at, ...)
## S3 method for class 'bridgesde2d'
cv(x, at, ...)
## S3 method for class 'bridgesde2d'
bconfint(x, at, ...)

## S3 method for class 'bridgesde2d'
plot(x, ...)
## S3 method for class 'bridgesde2d'
lines(x, ...)
## S3 method for class 'bridgesde2d'
points(x, ...)	
## S3 method for class 'bridgesde2d'
plot2d(x, ...)
## S3 method for class 'bridgesde2d'
lines2d(x, ...)
## S3 method for class 'bridgesde2d'
points2d(x, ...)								  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bridgesde2d_+3A_n">N</code></td>
<td>
<p>number of simulation steps.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_m">M</code></td>
<td>
<p>number of trajectories.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_x0">x0</code></td>
<td>
<p>initial value (numeric vector of length 2) of the process <code class="reqn">X_t</code> and <code class="reqn">Y_t</code> at time <code class="reqn">t_0</code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_y">y</code></td>
<td>
<p>terminal value (numeric vector of length 2) of the process <code class="reqn">X_t</code> and <code class="reqn">Y_t</code> at time <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_t0">t0</code></td>
<td>
<p>initial time.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_t">T</code></td>
<td>
<p>final time.</p>
</td></tr> 
<tr><td><code id="bridgesde2d_+3A_dt">Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code><a href="base.html#topic+missing">missing</a></code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_drift">drift</code></td>
<td>
<p>drift coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of three variables <code>t</code>, <code>x</code> and <code>y</code> for process <code class="reqn">X_t</code> and <code class="reqn">Y_t</code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_diffusion">diffusion</code></td>
<td>
<p>diffusion coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of three variables <code>t</code>, <code>x</code> and <code>y</code> for process <code class="reqn">X_t</code> and <code class="reqn">Y_t</code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_corr">corr</code></td>
<td>
<p>the correlation structure of two Brownian motions W1(t) and W2(t); must be a real symmetric positive-definite square matrix of dimension 2.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_alpha">alpha</code>, <code id="bridgesde2d_+3A_mu">mu</code></td>
<td>
<p>weight of the predictor-corrector scheme; the default <code>alpha = 0.5</code> and <code>mu = 0.5</code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_type">type</code></td>
<td>
<p>if <code>type="ito"</code> simulation diffusion bridge of Itô type, else <code>type="str"</code> simulation diffusion bridge of Stratonovich type; the default <code>type="ito"</code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_method">method</code></td>
<td>
<p>numerical methods of simulation, the default <code>method = "euler"</code>; see <code><a href="#topic+snssde2d">snssde2d</a></code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_x">x</code>, <code id="bridgesde2d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>"bridgesde2d"</code>.</p>
</td></tr>
<tr><td><code id="bridgesde2d_+3A_at">at</code></td>
<td>
<p>time between <code>t0</code> and <code>T</code>. Monte-Carlo statistics of the solution <code class="reqn">(X_{t},Y_{t})</code> at time <code>at</code>. The default <code>at = T/2</code>.</p>
</td></tr> 
<tr><td><code id="bridgesde2d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr> 
<tr><td><code id="bridgesde2d_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>bridgesde2d</code> returns a <code>mts</code> of the diffusion bridge starting at <code>x</code> at time <code>t0</code> and ending at <code>y</code> at time <code>T</code>. W1(t) and W2(t) are two standard Brownian motion independent if <code>corr=NULL</code>.
</p>
<p>The methods of approximation are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong 
and the weak (orders of) convergence. The <code>method</code> of simulation can be one among: <code>Euler-Maruyama Order 0.5</code>, <code>Milstein Order 1</code>, <code>Milstein Second-Order</code>, 
<code>Predictor-Corrector method</code>, <code>Itô-Taylor Order 1.5</code>, <code>Heun Order 2</code> and <code>Runge-Kutta Order 1, 2 and 3</code>.
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>bridgesde2d</code> returns an object inheriting from <code><a href="base.html#topic+class">class</a></code> <code>"bridgesde2d"</code>.
</p>
<table role = "presentation">
<tr><td><code>X</code>, <code>Y</code></td>
<td>
<p>an invisible <code>mts</code> (2-dim) object (X(t),Y(t)).</p>
</td></tr>
<tr><td><code>driftx</code>, <code>drifty</code></td>
<td>
<p>drift coefficient of X(t) and Y(t).</p>
</td></tr>
<tr><td><code>diffx</code>, <code>diffy</code></td>
<td>
<p>diffusion coefficient of X(t) and Y(t).</p>
</td></tr>
<tr><td><code>Cx</code>, <code>Cy</code></td>
<td>
<p>indices of crossing realized of X(t) and Y(t).</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of sde.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the numerical method used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Bladt, M. and Sorensen, M. (2007).
Simple simulation of diffusion bridges with application to likelihood inference for diffusions.
<em>Working Paper, University of Copenhagen</em>. 
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bridgesde1d">bridgesde1d</a></code> for simulation of 1-dim SDE. 
</p>
<p><code>DBridge</code> in package &quot;sde&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## dX(t) = 4*(-1-X(t)) dt + 0.2 dW1(t)
## dY(t) = X(t) dt + 0 dW2(t)
## x01 = 0 , y01 = 0
## x02 = 0, y02 = 0 
## W1(t) and W2(t) two correlated Brownian motion with matrix Sigma=matrix(c(1,0.7,0.7,1),nrow=2)
set.seed(1234)

fx &lt;- expression(4*(-1-x) , x)
gx &lt;- expression(0.2 , 0)
Sigma= matrix(c(1,0.7,0.7,1),nrow=2)
res &lt;- bridgesde2d(drift=fx,diffusion=gx,Dt=0.005,M=500,corr=Sigma)
res
summary(res) ## Monte-Carlo statistics at time T/2=2.5
summary(res,at=1) ## Monte-Carlo statistics at time 1
summary(res,at=4) ## Monte-Carlo statistics at time 4
##
plot(res,type="n")
lines(time(res),apply(res$X,1,mean),col=3,lwd=2)
lines(time(res),apply(res$Y,1,mean),col=4,lwd=2)
legend("topright",c(expression(E(X[t])),expression(E(Y[t]))),lty=1,inset = .7,col=c(3,4))
##
plot2d(res)
</code></pre>

<hr>
<h2 id='bridgesde3d'>Simulation of 3-D Bridge SDE's</h2><span id='topic+bridgesde3d'></span><span id='topic+bridgesde3d.default'></span><span id='topic+print.bridgesde3d'></span><span id='topic+time.bridgesde3d'></span><span id='topic+mean.bridgesde3d'></span><span id='topic+Median.bridgesde3d'></span><span id='topic+Mode.bridgesde3d'></span><span id='topic+quantile.bridgesde3d'></span><span id='topic+kurtosis.bridgesde3d'></span><span id='topic+skewness.bridgesde3d'></span><span id='topic+moment.bridgesde3d'></span><span id='topic+summary.bridgesde3d'></span><span id='topic+cv.bridgesde3d'></span><span id='topic+max.bridgesde3d'></span><span id='topic+min.bridgesde3d'></span><span id='topic+bconfint.bridgesde3d'></span><span id='topic+plot.bridgesde3d'></span><span id='topic+points.bridgesde3d'></span><span id='topic+lines.bridgesde3d'></span><span id='topic+plot3D.bridgesde3d'></span>

<h3>Description</h3>

<p>The (S3) generic function <code>bridgesde3d</code> for simulation of 3-dim bridge stochastic differential equations,Itô or Stratonovich type, with different methods.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bridgesde3d(N, ...)
## Default S3 method:
bridgesde3d(N=1000,M=1, x0=c(0,0,0), 
   y=c(0,0,0), t0 = 0, T = 1, Dt, drift, diffusion, corr = NULL, 
   alpha = 0.5, mu = 0.5,type = c("ito", "str"), method = 
   c("euler", "milstein","predcorr","smilstein", "taylor", 
	"heun","rk1", "rk2", "rk3"), ...)

## S3 method for class 'bridgesde3d'
summary(object, at,
     digits=NULL, ...)								  
## S3 method for class 'bridgesde3d'
time(x, ...)
## S3 method for class 'bridgesde3d'
mean(x, at, ...)
## S3 method for class 'bridgesde3d'
Median(x, at, ...)
## S3 method for class 'bridgesde3d'
Mode(x, at, ...)
## S3 method for class 'bridgesde3d'
quantile(x, at, ...)
## S3 method for class 'bridgesde3d'
kurtosis(x, at, ...)
## S3 method for class 'bridgesde3d'
skewness(x, at, ...)
## S3 method for class 'bridgesde3d'
min(x, at, ...)
## S3 method for class 'bridgesde3d'
max(x, at, ...)
## S3 method for class 'bridgesde3d'
moment(x, at, ...)
## S3 method for class 'bridgesde3d'
cv(x, at, ...)
## S3 method for class 'bridgesde3d'
bconfint(x, at, ...)

## S3 method for class 'bridgesde3d'
plot(x, ...)
## S3 method for class 'bridgesde3d'
lines(x, ...)
## S3 method for class 'bridgesde3d'
points(x, ...)	
## S3 method for class 'bridgesde3d'
plot3D(x, display = c("persp","rgl"), ...)						  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bridgesde3d_+3A_n">N</code></td>
<td>
<p>number of simulation steps.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_m">M</code></td>
<td>
<p>number of trajectories.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_x0">x0</code></td>
<td>
<p>initial value (numeric vector of length 3) of the process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code> at time <code class="reqn">t_0</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_y">y</code></td>
<td>
<p>terminal value (numeric vector of length 3) of the process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code> at time <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_t0">t0</code></td>
<td>
<p>initial time.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_t">T</code></td>
<td>
<p>final time.</p>
</td></tr> 
<tr><td><code id="bridgesde3d_+3A_dt">Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code><a href="base.html#topic+missing">missing</a></code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_drift">drift</code></td>
<td>
<p>drift coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of four variables <code>t</code>, <code>x</code>, <code>y</code> and <code>z</code> for process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_diffusion">diffusion</code></td>
<td>
<p>diffusion coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of four variables <code>t</code>, <code>x</code>, <code>y</code> and <code>z</code> for process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_corr">corr</code></td>
<td>
<p>the correlation structure of three Brownian motions W1(t), W2(t) and W3(t); must be a real symmetric positive-definite square matrix of dimension 3.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_alpha">alpha</code></td>
<td>
<p>weight <code>alpha</code> of the predictor-corrector scheme; the default <code>alpha = 0.5</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_mu">mu</code></td>
<td>
<p>weight <code>mu</code> of the predictor-corrector scheme; the default <code>mu = 0.5</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_type">type</code></td>
<td>
<p>if <code>type="ito"</code> simulation diffusion bridge of Itô type, else <code>type="str"</code> simulation diffusion bridge of Stratonovich type; the default <code>type="ito"</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_method">method</code></td>
<td>
<p>numerical methods of simulation, the default <code>method = "euler"</code>; see <code><a href="#topic+snssde3d">snssde3d</a></code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_x">x</code>, <code id="bridgesde3d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>"bridgesde3d"</code>.</p>
</td></tr>
<tr><td><code id="bridgesde3d_+3A_at">at</code></td>
<td>
<p>time between <code>t0</code> and <code>T</code>. Monte-Carlo statistics of the solution <code class="reqn">(X_{t},Y_{t},Z_{t})</code> at time <code>at</code>. The default <code>at = T/2</code>.</p>
</td></tr> 
<tr><td><code id="bridgesde3d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr> 
<tr><td><code id="bridgesde3d_+3A_display">display</code></td>
<td>
<p><code>"persp"</code> perspective and <code>"rgl"</code> plots.</p>
</td></tr> 
<tr><td><code id="bridgesde3d_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>bridgesde3d</code> returns a <code>mts</code> of the diffusion bridge starting at <code>x</code> at time <code>t0</code> and ending at <code>y</code> at time <code>T</code>. W1(t), W2(t) and W3(t) three standard Brownian motion independent if <code>corr=NULL</code>.
</p>
<p>The methods of approximation are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong 
and the weak (orders of) convergence. The <code>method</code> of simulation can be one among: <code>Euler-Maruyama Order 0.5</code>, <code>Milstein Order 1</code>, <code>Milstein Second-Order</code>, 
<code>Predictor-Corrector method</code>, <code>Itô-Taylor Order 1.5</code>, <code>Heun Order 2</code> and <code>Runge-Kutta Order 1, 2 and 3</code>. 
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>bridgesde3d</code> returns an object inheriting from <code><a href="base.html#topic+class">class</a></code> <code>"bridgesde3d"</code>.
</p>
<table role = "presentation">
<tr><td><code>X</code>, <code>Y</code>, <code>Z</code></td>
<td>
<p>an invisible <code>mts</code> (3-dim) object (X(t),Y(t),Z(t)).</p>
</td></tr>
<tr><td><code>driftx</code>, <code>drifty</code>, <code>driftz</code></td>
<td>
<p>drift coefficient of X(t), Y(t) and Z(t).</p>
</td></tr>
<tr><td><code>diffx</code>, <code>diffy</code>, <code>diffz</code></td>
<td>
<p>diffusion coefficient of X(t), Y(t) and Z(t).</p>
</td></tr>
<tr><td><code>Cx</code>, <code>Cy</code>, <code>Cz</code></td>
<td>
<p>indices of crossing realized of X(t), Y(t)) and Z(t).</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of sde.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the numerical method used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Bladt, M. and Sorensen, M. (2007).
Simple simulation of diffusion bridges with application to likelihood inference for diffusions.
<em>Working Paper, University of Copenhagen</em>. 
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bridgesde1d">bridgesde1d</a></code> for simulation of 1-dim SDE. <code>DBridge</code> in package &quot;sde&quot;.
</p>
<p><code><a href="#topic+bridgesde2d">bridgesde2d</a></code> for simulation of 2-dim SDE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## dX(t) = 4*(-1-X(t))*Y(t) dt + 0.2 * dW1(t) ; x01 = 0 and y01 = 0
## dY(t) = 4*(1-Y(t)) *X(t) dt + 0.2 * dW2(t) ; x02 = -1 and y02 = -2
## dZ(t) = 4*(1-Z(t)) *Y(t) dt + 0.2 * dW3(t) ; x03 = 0.5 and y03 = 0.5       
## W1(t), W2(t) and W3(t) are three correlated Brownian motions with Sigma
set.seed(1234)

fx &lt;- expression(4*(-1-x)*y, 4*(1-y)*x, 4*(1-z)*y)
gx &lt;- rep(expression(0.2),3)
# correlation matrix
Sigma &lt;-matrix(c(1,0.3,0.5,0.3,1,0.2,0.5,0.2,1),nrow=3,ncol=3) 

res &lt;- bridgesde3d(x0=c(0,-1,0.5),y=c(0,-2,0.5),drift=fx,diffusion=gx,corr=Sigma,M=200)
res
summary(res) ## Monte-Carlo statistics at time T/2=0.5
summary(res,at=0.25) ## Monte-Carlo statistics at time 0.25
summary(res,at=0.75) ## Monte-Carlo statistics at time 0.75
##
plot(res,type="n")
lines(time(res),apply(res$X,1,mean),col=3,lwd=2)
lines(time(res),apply(res$Y,1,mean),col=4,lwd=2)
lines(time(res),apply(res$Z,1,mean),col=5,lwd=2)
legend("topleft",c(expression(E(X[t])),expression(E(Y[t])),
       expression(E(Z[t]))),lty=1,inset = .01,col=c(3,4,5))
##
plot3D(res,display = "persp",main="3-dim bridge sde")
</code></pre>

<hr>
<h2 id='fitsde'>Maximum Pseudo-Likelihood Estimation of 1-D SDE</h2><span id='topic+fitsde'></span><span id='topic+fitsde.default'></span><span id='topic+summary.fitsde'></span><span id='topic+print.fitsde'></span><span id='topic+vcov.fitsde'></span><span id='topic+AIC.fitsde'></span><span id='topic+BIC.fitsde'></span><span id='topic+logLik.fitsde'></span><span id='topic+coef.fitsde'></span><span id='topic+confint.fitsde'></span>

<h3>Description</h3>

<p>The (S3) generic function <code>"fitsde"</code> of estimate drift and diffusion parameters by the method of maximum pseudo-likelihood 
of the 1-dim stochastic differential equation. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsde(data, ...)
## Default S3 method:
fitsde(data, drift, diffusion, start = list(), pmle = c("euler","kessler", 
   "ozaki", "shoji"), optim.method = "L-BFGS-B",
   lower = -Inf, upper = Inf, ...)
   
## S3 method for class 'fitsde'
summary(object, ...)
## S3 method for class 'fitsde'
coef(object, ...)
## S3 method for class 'fitsde'
vcov(object, ...)
## S3 method for class 'fitsde'
logLik(object, ...)
## S3 method for class 'fitsde'
AIC(object, ...)
## S3 method for class 'fitsde'
BIC(object, ...)
## S3 method for class 'fitsde'
confint(object,parm, level=0.95, ...)   
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitsde_+3A_data">data</code></td>
<td>
<p>a univariate time series (<code><a href="stats.html#topic+ts">ts</a></code> class).</p>
</td></tr>
<tr><td><code id="fitsde_+3A_drift">drift</code></td>
<td>
<p>drift coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of two variables <code>t</code>, <code>x</code> and <code>theta</code> a vector of parameters of sde. See Examples.</p>
</td></tr>
<tr><td><code id="fitsde_+3A_diffusion">diffusion</code></td>
<td>
<p>diffusion coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of two variables <code>t</code>, <code>x</code> and <code>theta</code> a vector of parameters of sde. See Examples.</p>
</td></tr>
<tr><td><code id="fitsde_+3A_start">start</code></td>
<td>
<p>named list of starting values for optimizer. See Examples.</p>
</td></tr>
<tr><td><code id="fitsde_+3A_pmle">pmle</code></td>
<td>
<p>a <code><a href="base.html#topic+character">character</a></code> string specifying the method; can be either:
<code>"euler"</code> (Euler pseudo-likelihood),
<code>"ozaki"</code> (Ozaki pseudo-likelihood),
<code>"shoji"</code> (Shoji pseudo-likelihood), and
<code>"kessler"</code> (Kessler pseudo-likelihood).</p>
</td></tr>
<tr><td><code id="fitsde_+3A_optim.method">optim.method</code></td>
<td>
<p>the <code>method</code> for <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="fitsde_+3A_lower">lower</code>, <code id="fitsde_+3A_upper">upper</code></td>
<td>
<p>bounds on the variables for the <code>"Brent"</code> or <code>"L-BFGS-B"</code> method.</p>
</td></tr>
<tr><td><code id="fitsde_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>"fitsde"</code>.</p>
</td></tr>
<tr><td><code id="fitsde_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, either a vector of names (example <code>parm='theta1'</code>). If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="fitsde_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>    
<tr><td><code id="fitsde_+3A_...">...</code></td>
<td>
<p>potentially further arguments to pass to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>fitsde</code> returns a pseudo-likelihood estimators of the drift and diffusion parameters in 1-dim stochastic 
differential equation. The <code><a href="stats.html#topic+optim">optim</a></code> optimizer is used to find the maximum of the negative log pseudo-likelihood. An 
approximate covariance matrix for the parameters is obtained by inverting the Hessian matrix at the optimum.
</p>
<p>The <code>pmle</code> of pseudo-likelihood can be one among:<code>"euler"</code>: Euler pseudo-likelihood), <code>"ozaki"</code>: Ozaki pseudo-likelihood,
<code>"shoji"</code>: Shoji pseudo-likelihood, and <code>"kessler"</code>: Kessler pseudo-likelihood.
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>fitsde</code> returns an object inheriting from <code><a href="base.html#topic+class">class</a></code> <code>"fitsde"</code>.
</p>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>





<p>Kessler, M. (1997).  
Estimation of an ergodic diffusion from discrete observations. 
<em>Scand. J. Statist.</em>, 24, 211-229.
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York.
</p>
<p>Iacus, S.M. (2009). 
sde: Simulation and Inference for Stochastic Differential Equations. 
<em><span class="rlang"><b>R</b></span> package version 2.0.10</em>. 
</p>
<p>Iacus, S.M. and all. (2014).
The yuima Project: A Computational Framework for Simulation and Inference of Stochastic Differential Equations.
<em>Journal of Statistical Software</em>, <b>57</b>(4).
</p>
<p>Ozaki, T. (1992). 
A bridge between nonlinear time series models and nonlinear stochastic dynamical systems: A local linearization approach. 
<em>Statistica Sinica</em>, 2, 25-83.
</p>
<p>Shoji, L., Ozaki, T. (1998). 
Estimation for nonlinear stochastic differential equations by a local linearization method. 
<em>Stochastic Analysis and Applications</em>, 16, 733-752.
</p>
<p>Dacunha, D.C. and Florens, D.Z. (1986). 
Estimation of the Coefficients of a Diffusion from Discrete Observations. 
<em>Stochastics</em>. 19, 263&ndash;284.  
</p>
<p>Dohnal, G. (1987).
On estimating the diffusion coefficient.
<em>J. Appl.Prob.</em>, 24, 105&ndash;114.
</p>
<p>Genon, V.C. (1990).
Maximum constrast estimation for diffusion processes from discrete observation.
<em>Statistics</em>, 21, 99&ndash;116.
</p>
<p>Nicolau, J. (2004).
Introduction to the estimation of stochastic differential equations based on discrete observations.
<em>Autumn School and International Conference, Stochastic Finance</em>.
</p>
<p>Ait-Sahalia, Y. (1999). 
Transition densities for interest rate and other nonlinear diffusions.
<em>The Journal of Finance</em>, 54, 1361&ndash;1395.
</p>
<p>Ait-Sahalia, Y. (2002). 
Maximum likelihood estimation of discretely sampled diffusions: a closed-form approximation approach. 
<em>Econometrica</em>. 70, 223&ndash;262.
</p>
<p>B.L.S. Prakasa Rao. (1999).
<em>Statistical Inference for Diffusion Type Processes</em>.
Arnold, London and Oxford University press, New York.
</p>
<p>Kutoyants, Y.A. (2004).
<em>Statistical Inference for Ergodic Diffusion Processes</em>.
Springer, London.
</p>


<h3>See Also</h3>

<p><code>dcEuler</code>, <code>dcElerian</code>, <code>dcOzaki</code>, <code>dcShoji</code>, 
<code>dcKessler</code> and <code>dcSim</code> for approximated conditional law of a diffusion process. <code>gmm</code> estimator of the generalized method of moments by Hansen, and <code>HPloglik</code> these functions are useful 
to calculate approximated maximum likelihood estimators when the transition density of the process is not known, in package &quot;sde&quot;. 
</p>
<p><code>qmle</code> in package &quot;yuima&quot; calculate quasi-likelihood and ML estimator of least squares estimator.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#####  Example 1:

## Modele GBM (BS)
## dX(t) = theta1 * X(t) * dt + theta2 * x * dW(t)
## Simulation of data
set.seed(1234)

X &lt;- GBM(N =1000,theta=4,sigma=1)
## Estimation: true theta=c(4,1)
fx &lt;- expression(theta[1]*x)
gx &lt;- expression(theta[2]*x)

fres &lt;- fitsde(data=X,drift=fx,diffusion=gx,start = list(theta1=1,theta2=1),
              lower=c(0,0))
fres			   
summary(fres)
coef(fres)
logLik(fres)
AIC(fres)
BIC(fres)
vcov(fres)
confint(fres,level=0.95)
		  
</code></pre>

<hr>
<h2 id='fptsde1d'>Approximate densities and random generation for first passage time in 1-D SDE</h2><span id='topic+fptsde1d'></span><span id='topic+fptsde1d.default'></span><span id='topic+summary.fptsde1d'></span><span id='topic+print.fptsde1d'></span><span id='topic+mean.fptsde1d'></span><span id='topic+Median.fptsde1d'></span><span id='topic+Mode.fptsde1d'></span><span id='topic+quantile.fptsde1d'></span><span id='topic+kurtosis.fptsde1d'></span><span id='topic+skewness.fptsde1d'></span><span id='topic+moment.fptsde1d'></span><span id='topic+cv.fptsde1d'></span><span id='topic+max.fptsde1d'></span><span id='topic+min.fptsde1d'></span><span id='topic+dfptsde1d'></span><span id='topic+dfptsde1d.default'></span><span id='topic+print.dfptsde1d'></span><span id='topic+plot.dfptsde1d'></span>

<h3>Description</h3>

<p>Kernel density and random generation for first-passage-time (f.p.t) in 1-dim stochastic differential equations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fptsde1d(object, ...)
dfptsde1d(object, ...)

## Default S3 method:
fptsde1d(object, boundary, ...)
## S3 method for class 'fptsde1d'
summary(object, digits=NULL, ...)
## S3 method for class 'fptsde1d'
mean(x, ...)
## S3 method for class 'fptsde1d'
Median(x, ...)
## S3 method for class 'fptsde1d'
Mode(x, ...)
## S3 method for class 'fptsde1d'
quantile(x, ...)
## S3 method for class 'fptsde1d'
kurtosis(x, ...)
## S3 method for class 'fptsde1d'
skewness(x, ...)
## S3 method for class 'fptsde1d'
min(x, ...)
## S3 method for class 'fptsde1d'
max(x, ...)
## S3 method for class 'fptsde1d'
moment(x, ...)
## S3 method for class 'fptsde1d'
cv(x, ...)

## Default S3 method:
dfptsde1d(object, ...)
## S3 method for class 'dfptsde1d'
plot(x, hist=FALSE, ...)						  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fptsde1d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+snssde1d">snssde1d</a></code> for <code>fptsde1d</code>, and <code><a href="#topic+fptsde1d">fptsde1d</a></code> for <code>dfptsde1d</code>.</p>
</td></tr>
<tr><td><code id="fptsde1d_+3A_boundary">boundary</code></td>
<td>
<p>an <code><a href="base.html#topic+expression">expression</a></code> of a constant or time-dependent boundary.</p>
</td></tr>  
<tr><td><code id="fptsde1d_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>dfptsde1d</code>.</p>
</td></tr>
<tr><td><code id="fptsde1d_+3A_hist">hist</code></td>
<td>
<p>if <code>hist=TRUE</code> plot histogram. Based on <code><a href="MASS.html#topic+truehist">truehist</a></code> function.</p>
</td></tr> 
<tr><td><code id="fptsde1d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr>  
<tr><td><code id="fptsde1d_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods, such as <code><a href="stats.html#topic+density">density</a></code> for <code>dfptsde1d</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>fptsde1d</code> returns a random variable <code class="reqn">\tau_{(X(t),S(t))}</code> &quot;first passage time&quot;, is defined as : 
</p>
<p style="text-align: center;"><code class="reqn">\tau_{(X(t),S(t))} = \{ t \geq 0 ; X_{t} \geq S(t) \},\quad if \quad X(t_{0}) &lt; S(t_{0})</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_{(X(t),S(t))} = \{ t \geq 0 ; X_{t} \leq S(t) \},\quad if \quad X(t_{0}) &gt; S(t_{0})</code>
</p>

<p><img src="../help/figures/fpt1d.png" alt="fig07" />
</p>
<p>And <code>dfptsde1d</code> returns a kernel density approximation for <code class="reqn">\tau_{(X(t),S(t))}</code> &quot;first passage time&quot;.
with <code class="reqn">S(t)</code> is through a continuous boundary (barrier).
</p>
<p><img src="../help/figures/dfpt1d.png" alt="fig08" />
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dfptsde1d()</code></td>
<td>
<p>gives the density estimate of fpt.</p>
</td></tr>
<tr><td><code>fptsde1d()</code></td>
<td>
<p>generates random of fpt.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Argyrakisa, P. and G.H. Weiss (2006).
A first-passage time problem for many random walkers.
<em>Physica A</em>. <b>363</b>, 343&ndash;347.
</p>
<p>Aytug H., G. J. Koehler (2000). 
New stopping criterion for genetic algorithms. 
<em>European Journal of Operational Research</em>, <b>126</b>, 662&ndash;674.
</p>
<p>Boukhetala, K. (1996)
Modelling and simulation of a dispersion pollutant with attractive centre.
ed by Computational Mechanics Publications, Southampton ,U.K and Computational Mechanics Inc, Boston, USA, 245&ndash;252.
</p>
<p>Boukhetala, K. (1998a). 
Estimation of the first passage time distribution for a simulated diffusion process.
<em>Maghreb Math.Rev</em>, <b>7</b>(1), 1&ndash;25.
</p>
<p>Boukhetala, K. (1998b). 
Kernel density of the exit time in a simulated diffusion. 
<em>les Annales Maghrebines De L ingenieur</em>, <b>12</b>, 587&ndash;589.
</p>
<p>Ding, M. and G. Rangarajan. (2004). 
First Passage Time Problem: A Fokker-Planck Approach. 
<em>New Directions in Statistical Physics</em>. ed by L. T. Wille. Springer. 31&ndash;46.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2008).
First-passage-time location function: Application to determine first-passage-time densities in diffusion processes.
<em>Computational Statistics and Data Analysis</em>. <b>52</b>, 4132&ndash;4146.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2012). 
An R package for an efficient approximation of first-passage-time densities for diffusion processes based on the FPTL function. 
<em>Applied Mathematics and Computation</em>, <b>218</b>, 8408&ndash;8428.
</p>
<p>Gardiner, C. W. (1997). 
<em>Handbook of Stochastic Methods</em>.
Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fptsde2d">fptsde2d</a></code> and <code><a href="#topic+fptsde3d">fptsde3d</a></code> simulation fpt for 2 and 3-dim SDE.
</p>
<p><code>FPTL</code> for computes values of the first passage time location (FPTL) function, and <code>Approx.fpt.density</code> 
for approximate first-passage-time (f.p.t.) density in package &quot;fptdApprox&quot;. 
</p>
<p><code>GQD.TIpassage</code> for compute the First Passage Time Density of a GQD With Time Inhomogeneous Coefficients in package &quot;DiffusionRgqd&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Ito SDE
## dX(t) = -4*X(t) *dt + 0.5*dW(t)
## S(t) = 0 (constant boundary)
set.seed(1234)

# SDE 1d
f &lt;- expression( -4*x )
g &lt;- expression( 0.5 )
mod &lt;- snssde1d(drift=f,diffusion=g,x0=2,M=1000)

# boundary
St &lt;- expression(0) 

# random
out &lt;- fptsde1d(mod, boundary=St)
out
summary(out)
# density approximate
den &lt;- dfptsde1d(out)
den
plot(den)

## Example 2: Stratonovich SDE
## dX(t) = 0.5*X(t)*t *dt + sqrt(1+X(t)^2) o dW(t)
## S(t) = -0.5*sqrt(t) + exp(t^2) (time-dependent boundary)
set.seed(1234)

# SDE 1d
f &lt;- expression( 0.5*x*t )
g &lt;- expression( sqrt(1+x^2) )
mod2 &lt;- snssde1d(drift=f,diffusion=g,x0=2,M=1000,type="srt")

# boundary
St &lt;- expression(-0.5*sqrt(t)+exp(t^2))

# random
out2 &lt;- fptsde1d(mod2,boundary=St)
out2
summary(out2)
# density approximate
plot(dfptsde1d(out2,bw='ucv'))


## Example 3: fptsde1d vs fptdApproximate
## Not run: 
f &lt;- expression( -0.5*x+0.5*5 )
g &lt;- expression( 1 )
St &lt;- expression(5+0.25*sin(2*pi*t)) 
mod &lt;- snssde1d(drift=f,diffusion=g,boundary=St,x0=3,T=10,N=10^4,M =10000)
mod

# random
out3 &lt;- fptsde1d(mod,boundary=St)
out3
summary(out3)
# density approximate: 
library("fptdApprox")
# Under `fptdApprox':
# Define the diffusion process and give its transitional density:
OU &lt;- diffproc(c("alpha*x + beta","sigma^2",
"dnorm((x-(y*exp(alpha*(t-s)) - beta*(1 - exp(alpha*(t-s)))/alpha))/
(sigma*sqrt((exp(2*alpha*(t-s)) - 1)/(2*alpha))),0,1)/
(sigma*sqrt((exp(2*alpha*(t-s)) - 1)/(2*alpha)))",
"pnorm(x, y*exp(alpha*(t-s)) - beta*(1 - exp(alpha*(t-s)))/alpha,
sigma*sqrt((exp(2*alpha*(t-s)) - 1)/(2*alpha)))"))
# Approximate the first passgage time density for OU, starting in X_0 = 3
# passing through 5+0.25*sin(2*pi*t) on the time interval [0,10]:
res &lt;- Approx.fpt.density(OU, 0, 10, 3,"5+0.25*sin(2*pi*t)", list(alpha=-0.5,beta=0.5*5,sigma=1))

##
plot(dfptsde1d(out3,bw='ucv'),main = 'fptsde1d vs fptdApproximate')
lines(res$y~res$x, type = 'l',lwd=2)
legend('topright', lty = c('solid', 'dashed'), col = c(1, 2),
       legend = c('fptdApproximate', 'fptsde1d'), lwd = 2, bty = 'n')


## End(Not run)

</code></pre>

<hr>
<h2 id='fptsde2d'>Approximate densities and random generation for first passage time in 2-D SDE's</h2><span id='topic+fptsde2d'></span><span id='topic+fptsde2d.default'></span><span id='topic+summary.fptsde2d'></span><span id='topic+print.fptsde2d'></span><span id='topic+mean.fptsde2d'></span><span id='topic+Median.fptsde2d'></span><span id='topic+Mode.fptsde2d'></span><span id='topic+quantile.fptsde2d'></span><span id='topic+kurtosis.fptsde2d'></span><span id='topic+skewness.fptsde2d'></span><span id='topic+moment.fptsde2d'></span><span id='topic+cv.fptsde2d'></span><span id='topic+max.fptsde2d'></span><span id='topic+min.fptsde2d'></span><span id='topic+dfptsde2d'></span><span id='topic+dfptsde2d.default'></span><span id='topic+print.dfptsde2d'></span><span id='topic+plot.dfptsde2d'></span>

<h3>Description</h3>

<p>Kernel density and random generation for first-passage-time (f.p.t) in 2-dim stochastic differential equations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fptsde2d(object, ...)
dfptsde2d(object, ...)

## Default S3 method:
fptsde2d(object, boundary, ...)
## S3 method for class 'fptsde2d'
summary(object, digits=NULL, ...)
## S3 method for class 'fptsde2d'
mean(x, ...)
## S3 method for class 'fptsde2d'
Median(x, ...)
## S3 method for class 'fptsde2d'
Mode(x, ...)
## S3 method for class 'fptsde2d'
quantile(x, ...)
## S3 method for class 'fptsde2d'
kurtosis(x, ...)
## S3 method for class 'fptsde2d'
skewness(x, ...)
## S3 method for class 'fptsde2d'
min(x, ...)
## S3 method for class 'fptsde2d'
max(x, ...)
## S3 method for class 'fptsde2d'
moment(x, ...)
## S3 method for class 'fptsde2d'
cv(x, ...)

## Default S3 method:
dfptsde2d(object, pdf=c("Joint","Marginal"), ...)
## S3 method for class 'dfptsde2d'
plot(x,display=c("persp","rgl","image","contour"),
                         hist=FALSE, ...)						  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fptsde2d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+snssde2d">snssde2d</a></code> for <code>fptsde2d</code>, and <code><a href="#topic+fptsde2d">fptsde2d</a></code> for <code>dfptsde2d</code>.</p>
</td></tr>
<tr><td><code id="fptsde2d_+3A_boundary">boundary</code></td>
<td>
<p>an <code><a href="base.html#topic+expression">expression</a></code> of a constant or time-dependent boundary.</p>
</td></tr> 
<tr><td><code id="fptsde2d_+3A_pdf">pdf</code></td>
<td>
<p>probability density function <code>Joint</code> or <code>Marginal</code>.</p>
</td></tr>    
<tr><td><code id="fptsde2d_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>fptsde2d</code>.</p>
</td></tr>
<tr><td><code id="fptsde2d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr>
<tr><td><code id="fptsde2d_+3A_display">display</code></td>
<td>
<p>display plots.</p>
</td></tr> 
<tr><td><code id="fptsde2d_+3A_hist">hist</code></td>
<td>
<p>if <code>hist=TRUE</code> plot histogram. Based on <code><a href="MASS.html#topic+truehist">truehist</a></code> function.</p>
</td></tr> 
<tr><td><code id="fptsde2d_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods. arguments to be passed to methods, such as <code><a href="stats.html#topic+density">density</a></code> for marginal density and <code><a href="MASS.html#topic+kde2d">kde2d</a></code> fro joint density.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>fptsde1d</code> returns a random variable <code class="reqn">(\tau_{(X(t),S(t))},\tau_{(Y(t),S(t))})</code> &quot;first passage time&quot;, is defined as : 
</p>
<p style="text-align: center;"><code class="reqn">\tau_{(X(t),S(t))} = \{ t \geq 0 ; X_{t} \geq S(t) \},\quad if \quad X(t_{0}) &lt; S(t_{0})</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_{(Y(t),S(t))} = \{ t \geq 0 ; Y_{t} \geq S(t) \},\quad if \quad Y(t_{0}) &lt; S(t_{0})</code>
</p>

<p>and:
</p>
<p style="text-align: center;"><code class="reqn">\tau_{(X(t),S(t))} = \{ t \geq 0 ; X_{t} \leq S(t) \},\quad if \quad X(t_{0}) &gt; S(t_{0})</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_{(Y(t),S(t))} = \{ t \geq 0 ; Y_{t} \leq S(t) \},\quad if \quad Y(t_{0}) &gt; S(t_{0})</code>
</p>

<p><img src="../help/figures/fpt2d.png" alt="fig09" />
</p>
<p>And <code>dfptsde2d</code> returns a kernel density approximation for <code class="reqn">(\tau_{(X(t),S(t))},\tau_{(Y(t),S(t))})</code> &quot;first passage time&quot;.
with <code class="reqn">S(t)</code> is through a continuous boundary (barrier).
</p>
<p><img src="../help/figures/dfpt2d.png" alt="fig10" />
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dfptsde2d()</code></td>
<td>
<p>gives the kernel density approximation for fpt.</p>
</td></tr>
<tr><td><code>fptsde2d()</code></td>
<td>
<p>generates random of fpt.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Argyrakisa, P. and G.H. Weiss (2006).
A first-passage time problem for many random walkers.
<em>Physica A</em>. <b>363</b>, 343&ndash;347.
</p>
<p>Aytug H., G. J. Koehler (2000). 
New stopping criterion for genetic algorithms. 
<em>European Journal of Operational Research</em>, <b>126</b>, 662&ndash;674.
</p>
<p>Boukhetala, K. (1996)
Modelling and simulation of a dispersion pollutant with attractive centre.
ed by Computational Mechanics Publications, Southampton ,U.K and Computational Mechanics Inc, Boston, USA, 245&ndash;252.
</p>
<p>Boukhetala, K. (1998a). 
Estimation of the first passage time distribution for a simulated diffusion process.
<em>Maghreb Math.Rev</em>, <b>7</b>(1), 1&ndash;25.
</p>
<p>Boukhetala, K. (1998b). 
Kernel density of the exit time in a simulated diffusion. 
<em>les Annales Maghrebines De L ingenieur</em>, <b>12</b>, 587&ndash;589.
</p>
<p>Ding, M. and G. Rangarajan. (2004). 
First Passage Time Problem: A Fokker-Planck Approach. 
<em>New Directions in Statistical Physics</em>. ed by L. T. Wille. Springer. 31&ndash;46.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2008).
First-passage-time location function: Application to determine first-passage-time densities in diffusion processes.
<em>Computational Statistics and Data Analysis</em>. <b>52</b>, 4132&ndash;4146.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2012). 
An R package for an efficient approximation of first-passage-time densities for diffusion processes based on the FPTL function. 
<em>Applied Mathematics and Computation</em>, <b>218</b>, 8408&ndash;8428.
</p>
<p>Gardiner, C. W. (1997). 
<em>Handbook of Stochastic Methods</em>.
Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fptsde1d">fptsde1d</a></code> for simulation fpt in sde 1-dim. <code><a href="#topic+fptsde3d">fptsde3d</a></code> for simulation fpt in sde 3-dim. 
</p>
<p><code>FPTL</code> for computes values of the first passage time location (FPTL) function, and <code>Approx.fpt.density</code> 
for approximate first-passage-time (f.p.t.) density in package &quot;fptdApprox&quot;. 
</p>
<p><code>GQD.TIpassage</code> for compute the First Passage Time Density of a GQD With Time Inhomogeneous Coefficients in package &quot;DiffusionRgqd&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## dX(t) = 5*(-1-Y(t))*X(t) * dt + 0.5 * dW1(t)          
## dY(t) = 5*(-1-X(t))*Y(t) * dt + 0.5 * dW2(t)
## x0 = 2, y0 = -2, and barrier -3+5*t.
## W1(t) and W2(t) two independent Brownian motion
set.seed(1234)

# SDE's 2d
fx &lt;- expression(5*(-1-y)*x , 5*(-1-x)*y)
gx &lt;- expression(0.5 , 0.5)
mod2d &lt;- snssde2d(drift=fx,diffusion=gx,x0=c(2,-2),M=100)

# boundary

St &lt;- expression(-1+5*t)

# random fpt

out &lt;- fptsde2d(mod2d,boundary=St)
out
summary(out)

# Marginal density 

denM &lt;- dfptsde2d(out,pdf="M")
denM
plot(denM)

# Joint density

denJ &lt;- dfptsde2d(out,pdf="J",n=200,lims=c(0.28,0.4,0.04,0.13))
denJ
plot(denJ)
plot(denJ,display="image")
plot(denJ,display="image",drawpoints=TRUE,cex=0.5,pch=19,col.pt='green')
plot(denJ,display="contour")
plot(denJ,display="contour",color.palette=colorRampPalette(c('white','green','blue','red')))
</code></pre>

<hr>
<h2 id='fptsde3d'>Approximate densities and random generation for first passage time in 3-D SDE's</h2><span id='topic+fptsde3d'></span><span id='topic+fptsde3d.default'></span><span id='topic+summary.fptsde3d'></span><span id='topic+print.fptsde3d'></span><span id='topic+mean.fptsde3d'></span><span id='topic+Median.fptsde3d'></span><span id='topic+Mode.fptsde3d'></span><span id='topic+quantile.fptsde3d'></span><span id='topic+kurtosis.fptsde3d'></span><span id='topic+skewness.fptsde3d'></span><span id='topic+moment.fptsde3d'></span><span id='topic+cv.fptsde3d'></span><span id='topic+max.fptsde3d'></span><span id='topic+min.fptsde3d'></span><span id='topic+dfptsde3d'></span><span id='topic+dfptsde3d.default'></span><span id='topic+print.dfptsde3d'></span><span id='topic+plot.dfptsde3d'></span>

<h3>Description</h3>

<p>Kernel density and random generation for first-passage-time (f.p.t) in 3-dim stochastic differential equations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fptsde3d(object, ...)
dfptsde3d(object, ...)

## Default S3 method:
fptsde3d(object, boundary, ...)
## S3 method for class 'fptsde3d'
summary(object, digits=NULL, ...)
## S3 method for class 'fptsde3d'
mean(x, ...)
## S3 method for class 'fptsde3d'
Median(x, ...)
## S3 method for class 'fptsde3d'
Mode(x, ...)
## S3 method for class 'fptsde3d'
quantile(x, ...)
## S3 method for class 'fptsde3d'
kurtosis(x, ...)
## S3 method for class 'fptsde3d'
skewness(x, ...)
## S3 method for class 'fptsde3d'
min(x, ...)
## S3 method for class 'fptsde3d'
max(x, ...)
## S3 method for class 'fptsde3d'
moment(x, ...)
## S3 method for class 'fptsde3d'
cv(x, ...)

## Default S3 method:
dfptsde3d(object, pdf=c("Joint","Marginal"), ...)
## S3 method for class 'dfptsde3d'
plot(x,display="rgl",hist=FALSE, ...)						   
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fptsde3d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+snssde3d">snssde3d</a></code> for <code>fptsde3d</code>, and <code><a href="#topic+fptsde3d">fptsde3d</a></code> for <code>dfptsde3d</code>.</p>
</td></tr>
<tr><td><code id="fptsde3d_+3A_boundary">boundary</code></td>
<td>
<p>an <code><a href="base.html#topic+expression">expression</a></code> of a constant or time-dependent boundary.</p>
</td></tr>
<tr><td><code id="fptsde3d_+3A_pdf">pdf</code></td>
<td>
<p>probability density function <code>Joint</code> or <code>Marginal</code>.</p>
</td></tr> 
<tr><td><code id="fptsde3d_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>dfptsde3d</code>.</p>
</td></tr>
<tr><td><code id="fptsde3d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr>
<tr><td><code id="fptsde3d_+3A_display">display</code></td>
<td>
<p>display plots.</p>
</td></tr> 
<tr><td><code id="fptsde3d_+3A_hist">hist</code></td>
<td>
<p>if <code>hist=TRUE</code> plot histogram. Based on <code><a href="MASS.html#topic+truehist">truehist</a></code> function.</p>
</td></tr> 
<tr><td><code id="fptsde3d_+3A_...">...</code></td>
<td>
<p>potentially arguments to be passed to methods, such as <code><a href="stats.html#topic+density">density</a></code> for marginal density  and <code><a href="sm.html#topic+sm.density">sm.density</a></code> for joint density.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>fptsde3d</code> returns a random variable <code class="reqn">(\tau_{(X(t),S(t))},\tau_{(Y(t),S(t))},\tau_{(Z(t),S(t))})</code> &quot;first passage time&quot;, is defined as : 
</p>
<p style="text-align: center;"><code class="reqn">\tau_{(X(t),S(t))} = \{ t \geq 0 ; X_{t} \geq S(t) \},\quad if \quad X(t_{0}) &lt; S(t_{0})</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_{(Y(t),S(t))} = \{ t \geq 0 ; Y_{t} \geq S(t) \},\quad if \quad Y(t_{0}) &lt; S(t_{0})</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_{(Z(t),S(t))} = \{ t \geq 0 ; Z_{t} \geq S(t) \},\quad if \quad Z(t_{0}) &lt; S(t_{0})</code>
</p>

<p>and:
</p>
<p style="text-align: center;"><code class="reqn">\tau_{(X(t),S(t))} = \{ t \geq 0 ; X_{t} \leq S(t) \},\quad if \quad X(t_{0}) &gt; S(t_{0})</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_{(Y(t),S(t))} = \{ t \geq 0 ; Y_{t} \leq S(t) \},\quad if \quad Y(t_{0}) &gt; S(t_{0})</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_{(Z(t),S(t))} = \{ t \geq 0 ; Z_{t} \leq S(t) \},\quad if \quad Z(t_{0}) &gt; S(t_{0})</code>
</p>

<p><img src="../help/figures/fpt3d.png" alt="fig11" />
</p>
<p>And <code>dfptsde3d</code> returns a marginal kernel density approximation for <code class="reqn">(\tau_{(X(t),S(t))},\tau_{(Y(t),S(t))},\tau_{(Z(t),S(t))})</code> &quot;first passage time&quot;.
with <code class="reqn">S(t)</code> is through a continuous boundary (barrier).
</p>
<p><img src="../help/figures/dfpt3d.png" alt="fig12" />
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dfptsde3d()</code></td>
<td>
<p>gives the marginal kernel density approximation for fpt.</p>
</td></tr>
<tr><td><code>fptsde3d()</code></td>
<td>
<p>generates random of fpt.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Argyrakisa, P. and G.H. Weiss (2006).
A first-passage time problem for many random walkers.
<em>Physica A</em>. <b>363</b>, 343&ndash;347.
</p>
<p>Aytug H., G. J. Koehler (2000). 
New stopping criterion for genetic algorithms. 
<em>European Journal of Operational Research</em>, <b>126</b>, 662&ndash;674.
</p>
<p>Boukhetala, K. (1996)
Modelling and simulation of a dispersion pollutant with attractive centre.
ed by Computational Mechanics Publications, Southampton ,U.K and Computational Mechanics Inc, Boston, USA, 245&ndash;252.
</p>
<p>Boukhetala, K. (1998a). 
Estimation of the first passage time distribution for a simulated diffusion process.
<em>Maghreb Math.Rev</em>, <b>7</b>(1), 1&ndash;25.
</p>
<p>Boukhetala, K. (1998b). 
Kernel density of the exit time in a simulated diffusion. 
<em>les Annales Maghrebines De L ingenieur</em>, <b>12</b>, 587&ndash;589.
</p>
<p>Ding, M. and G. Rangarajan. (2004). 
First Passage Time Problem: A Fokker-Planck Approach. 
<em>New Directions in Statistical Physics</em>. ed by L. T. Wille. Springer. 31&ndash;46.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2008).
First-passage-time location function: Application to determine first-passage-time densities in diffusion processes.
<em>Computational Statistics and Data Analysis</em>. <b>52</b>, 4132&ndash;4146.
</p>
<p>Roman, R.P., Serrano, J. J., Torres, F. (2012). 
An R package for an efficient approximation of first-passage-time densities for diffusion processes based on the FPTL function. 
<em>Applied Mathematics and Computation</em>, <b>218</b>, 8408&ndash;8428.
</p>
<p>Gardiner, C. W. (1997). 
<em>Handbook of Stochastic Methods</em>.
Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fptsde1d">fptsde1d</a></code> for simulation fpt in sde 1-dim. <code><a href="#topic+fptsde2d">fptsde2d</a></code> for simulation fpt in sde 2-dim.
</p>
<p><code>FPTL</code> for computes values of the first passage time location (FPTL) function, and <code>Approx.fpt.density</code> 
for approximate first-passage-time (f.p.t.) density in package &quot;fptdApprox&quot;. 
</p>
<p><code>GQD.TIpassage</code> for compute the First Passage Time Density of a GQD With Time Inhomogeneous Coefficients in package &quot;DiffusionRgqd&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## dX(t) = 4*(-1-X(t))*Y(t) dt + 0.2 * dW1(t) 
## dY(t) = 4*(1-Y(t)) *X(t) dt + 0.2 * dW2(t) 
## dZ(t) = 4*(1-Z(t)) *Y(t) dt + 0.2 * dW3(t) 
## x0 = 0, y0 = -2, z0 = 0, and barrier -3+5*t.       
## W1(t), W2(t) and W3(t) three independent Brownian motion      
set.seed(1234)

# SDE's 3d

fx &lt;- expression(4*(-1-x)*y, 4*(1-y)*x, 4*(1-z)*y)
gx &lt;- rep(expression(0.2),3)
mod3d &lt;- snssde3d(drift=fx,diffusion=gx,M=500)

# boundary 
St &lt;- expression(-3+5*t)

# random

out &lt;- fptsde3d(mod3d,boundary=St)
out
summary(out)

# Marginal density

denM &lt;- dfptsde3d(out,pdf="M")
denM
plot(denM)

# Multiple isosurfaces
## Not run: 
denJ &lt;- dfptsde3d(out,pdf="J")
denJ
plot(denJ,display="rgl")

## End(Not run)
</code></pre>

<hr>
<h2 id='HWV'>
Hull-White/Vasicek, Ornstein-Uhlenbeck process
</h2><span id='topic+HWV'></span><span id='topic+OU'></span><span id='topic+HWV.default'></span><span id='topic+OU.default'></span>

<h3>Description</h3>

<p>The (S3) generic function for simulation of Hull-White/Vasicek or gaussian diffusion models, and Ornstein-Uhlenbeck process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HWV(N, ...)
OU(N, ...)

## Default S3 method:
HWV(N = 100, M = 1, x0 = 2, t0 = 0, T = 1, Dt = NULL, mu = 4, theta = 1,
   sigma = 0.1, ...)
## Default S3 method:
OU(N =100,M=1,x0=2,t0=0,T=1,Dt = NULL,mu=4,sigma=0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HWV_+3A_n">N</code></td>
<td>
<p>number of simulation steps.</p>
</td></tr>
<tr><td><code id="HWV_+3A_m">M</code></td>
<td>
<p>number of trajectories.</p>
</td></tr>
<tr><td><code id="HWV_+3A_x0">x0</code></td>
<td>
<p>initial value of the process at time <code class="reqn">t_{0}</code>.</p>
</td></tr>
<tr><td><code id="HWV_+3A_t0">t0</code></td>
<td>
<p>initial time.</p>
</td></tr>
<tr><td><code id="HWV_+3A_t">T</code></td>
<td>
<p>final time.</p>
</td></tr> 
<tr><td><code id="HWV_+3A_dt">Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code><a href="base.html#topic+missing">missing</a></code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td></tr>
<tr><td><code id="HWV_+3A_mu">mu</code></td>
<td>
<p>parameter of the <code>HWV</code> and <code>OU</code>; see details.</p>
</td></tr>
<tr><td><code id="HWV_+3A_theta">theta</code></td>
<td>
<p>parameter of the <code>HWV</code>; see details.</p>
</td></tr>
<tr><td><code id="HWV_+3A_sigma">sigma</code></td>
<td>
<p>the volatility of the <code>HWV</code> and <code>OU</code>.</p>
</td></tr>
<tr><td><code id="HWV_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>HWV</code> returns a trajectory of the <b>Hull-White/Vasicek process</b> starting at <code class="reqn">x_{0}</code> at time <code class="reqn">t_{0}</code>; 
i.e., the diffusion process solution of stochastic differential equation: 
</p>
<p style="text-align: center;"><code class="reqn">dX_{t}= \mu ( \theta -X_{t}) dt + \sigma dW_{t}</code>
</p>

<p>The function <code>OU</code> returns a trajectory of the <b>Ornstein-Uhlenbeck</b> starting at <code class="reqn">x_{0}</code> at time <code class="reqn">t_{0}</code>; 
i.e., the diffusion process solution of stochastic differential equation: 
</p>
<p style="text-align: center;"><code class="reqn">dX_{t}= -\mu X_{t} dt + \sigma dW_{t}</code>
</p>

<p>Constraints: <code class="reqn">\mu , \sigma &gt;0</code>.
</p>
<p>Please note that the process is stationary only if <code class="reqn">\mu &gt;0</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>an visible <code>ts</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Vasicek, O. (1977). 
An Equilibrium Characterization of the Term Structure.
<em>Journal of Financial Economics</em>,  5, 177&ndash;188. 
</p>


<h3>See Also</h3>

<p><code>rcOU</code> and <code>rsOU</code> for conditional and stationary law of Vasicek process are available in &quot;sde&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Hull-White/Vasicek Models
## dX(t) = 4 * (2.5 - X(t)) * dt + 1 *dW(t), X0=10
set.seed(1234)

X &lt;- HWV(N=1000,M=10,mu = 4, theta = 2.5,sigma = 1,x0=10)
plot(X,plot.type="single")
lines(as.vector(time(X)),rowMeans(X),col="red")

## Ornstein-Uhlenbeck Process
## dX(t) = -4 * X(t) * dt + 1 *dW(t) , X0=2
set.seed(1234)

X &lt;- OU(N=1000,M=10,mu = 4,sigma = 1,x0=10)
plot(X,plot.type="single")
lines(as.vector(time(X)),rowMeans(X),col="red")
</code></pre>

<hr>
<h2 id='Irates'>
Monthly Interest Rates
</h2><span id='topic+Irates'></span>

<h3>Description</h3>

<p>monthly observations from 1946&ndash;12 to 1991&ndash;02
</p>
<p><em>number of observations</em> :  531
</p>
<p><em>observation</em> :  country
</p>
<p><em>country</em> :  United&ndash;States
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Irates)</code></pre>


<h3>Format</h3>

<p>A time serie containing :
</p>

<dl>
<dt>r1</dt><dd><p>interest rate for a maturity of 1 months  (% per year). </p>
</dd>
<dt>r2</dt><dd><p>interest rate for a maturity of 2 months  (% per year). </p>
</dd>
<dt>r3</dt><dd><p>interest rate for a maturity of 3 months  (% per year). </p>
</dd>
<dt>r5</dt><dd><p>interest rate for a maturity of 5 months  (% per year). </p>
</dd>
<dt>r6</dt><dd><p>interest rate for a maturity of 6 months  (% per year). </p>
</dd>
<dt>r11</dt><dd><p>interest rate for a maturity of 11 months  (% per year). </p>
</dd>
<dt>r12</dt><dd><p>interest rate for a maturity of 12 months  (% per year). </p>
</dd>
<dt>r36</dt><dd><p>interest rate for a maturity of 36 months  (% per year). </p>
</dd>
<dt>r60</dt><dd><p>interest rate for a maturity of 60 months  (% per year). </p>
</dd>
<dt>r120</dt><dd><p>interest rate for a maturity of 120 months  (% per year). </p>
</dd>
</dl>



<h3>Source</h3>

<p>McCulloch, J.H. and Kwon, H.C. (1993). U.S. term structure data, 1947&ndash;1991, Ohio State Working Paper 93&ndash;6, Ohio State University, Columbus
</p>
<p>These datasets <code>Irates</code> are in package &quot;Ecdat&quot;.
</p>


<h3>References</h3>

<p>Croissant, Y. (2014). Ecdat: Data sets for econometrics. R package version 0.2&ndash;5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Irates)
rates &lt;- Irates[,"r1"]
rates &lt;- window(rates, start=1964.471, end=1989.333)

## CKLS modele vs CIR modele 
## CKLS :  dX(t) = (theta1+theta2* X(t))* dt + theta3 * X(t)^theta4 * dW(t)

fx &lt;- expression(theta[1]+theta[2]*x)
gx &lt;- expression(theta[3]*x^theta[4])
fitmod &lt;- fitsde(rates,drift=fx,diffusion=gx,pmle="euler",start = list(theta1=1,theta2=1,
                  theta3=1,theta4=1),optim.method = "L-BFGS-B")
theta &lt;- coef(fitmod)
	
N &lt;- length(rates)
res &lt;- snssde1d(drift=fx,diffusion=gx,M=1000,t0=time(rates)[1],T=time(rates)[N],
                Dt=deltat(rates),x0=rates[1],N=N)

plot(res,type="n",ylim=c(0,35))
lines(rates,col=2,lwd=2)
lines(time(res),apply(res$X,1,mean),col=3,lwd=2)
lines(time(res),apply(res$X,1,bconfint,level=0.95)[1,],col=4,lwd=2)
lines(time(res),apply(res$X,1,bconfint,level=0.95)[2,],col=4,lwd=2)
legend("topleft",c("real data","mean path",
  paste("bound of", 95," confidence")),inset = .01,
  col=2:4,lwd=2,cex=0.8)
</code></pre>

<hr>
<h2 id='MCM.sde'>
Parallel Monte-Carlo Methods for SDE's
</h2><span id='topic+MCM.sde'></span><span id='topic+MCM.sde.default'></span><span id='topic+print.MCM.sde'></span><span id='topic+plot.MCM.sde'></span>

<h3>Description</h3>

<p>Generate <code>R</code> Monte-Carlo (version parallel) replicates of a statistic applied to SDE's (1,2 and 3 dim) for the two cases Ito and Stratonovich interpretations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCM.sde(model, ...)

## Default S3 method:
MCM.sde(model, statistic, R = 100, time, exact = NULL, 
         names = NULL, level = 0.95, parallel = c("no", "multicore", "snow"),
         ncpus = getOption("ncpus", 1L), cl = NULL, ...)

## S3 method for class 'MCM.sde'
plot(x,index = 1,type=c("all","hist","qqplot","boxplot","CI"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MCM.sde_+3A_model">model</code></td>
<td>

<p>an object from class <code><a href="#topic+snssde1d">snssde1d</a></code>, <code><a href="#topic+snssde2d">snssde2d</a></code> and <code><a href="#topic+snssde3d">snssde3d</a></code>.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_statistic">statistic</code></td>
<td>

<p>a function which when applied to model returns a vector containing the statistic(s) of interest. 
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_r">R</code></td>
<td>

<p>the number of Monte-Carlo replicates. Usually this will be a single positive integer &quot;R &gt; 1&quot;.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_time">time</code></td>
<td>

<p>the time when estimating the statistic(s) of interesttime between <code>t0</code> and <code>T</code>. The default <code>time = T</code>.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_exact">exact</code></td>
<td>

<p>a named list giving the exact statistic(s) if it exists otherwise <code>exact = NULL</code>. 
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_names">names</code></td>
<td>

<p>named the statistic(s) of interest. The default <code>names=c("mu1","mu2",...)</code>.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_level">level</code></td>
<td>

<p>the confidence level(s) of the required interval(s).
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_parallel">parallel</code></td>
<td>

<p>the type of parallel operation to be used (if any). The default <code>parallel = "no"</code>.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_ncpus">ncpus</code></td>
<td>

<p>integer: number of processes to be used in parallel operation: typically one would chose this to the number of available CPUs.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_cl">cl</code></td>
<td>

<p>an optional parallel or snow cluster for use if <code>parallel = "snow"</code>.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_x">x</code></td>
<td>

<p>an object inheriting from class <code>"MCM.sde"</code>.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_index">index</code></td>
<td>

<p>the index of the variable of interest within the output of <code>"MCM.sde"</code>.
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_type">type</code></td>
<td>

<p>the type of plot of the Monte-Carlo estimation of the variable of interest. The default <code>type = "all"</code>.   
</p>
</td></tr>
<tr><td><code id="MCM.sde_+3A_...">...</code></td>
<td>

<p>potentially further arguments for (non-default) methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We have here developed Monte-Carlo methods whose essence is the use of repeated experiments to evaluate a 
statistic(s) of interest in SDE's. For example estimation of moments as: mean, variance, covariance (and other as median, 
mode, quantile,...). With the standard error and the confidence interval for these estimators.
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p>The returned value is an object of class <code>"MCM.sde"</code>, containing the following components:
</p>
<table role = "presentation">
<tr><td><code>mod</code></td>
<td>
<p>The SDE's used (class: <code><a href="#topic+snssde1d">snssde1d</a></code>, <code><a href="#topic+snssde2d">snssde2d</a></code> and <code><a href="#topic+snssde3d">snssde3d</a></code>).</p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p>Dimension of the model.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The original call to <code>"MCM.sde"</code>.</p>
</td></tr>
<tr><td><code>Fn</code></td>
<td>
<p>The function statistic as passed to <code>"MCM.sde"</code>.</p>
</td></tr>
<tr><td><code>ech</code></td>
<td>
<p>A matrix with <code>sum(R)</code> column each of which is a Monte-Carlo replicate of the result of calling statistic.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>The time when estimating the statistic(s) of interest.</p>
</td></tr>
<tr><td><code>name</code></td>
<td>
<p>named of statistic(s) of interest.</p>
</td></tr>
<tr><td><code>MC</code></td>
<td>
<p>Table contains simulation results of statistic(s) of interest: Estimate, Bias (if exact available), Std.Error and Confidence interval.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When <code>parallel = "multicore"</code> is used are not available on Windows, <code>parallel = "snow"</code> is primarily intended to be used on multi-core Windows machine where <code>parallel = "multicore"</code> is not available. For more details see Q.E.McCallum and S.Weston (2011).
</p>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Guidoum AC, Boukhetala K (2020). 
&quot;Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc&quot;. 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1&ndash;82. doi:10.18637/jss.v096.i02
</p>
<p>Paul Glasserman (2003).
<em>Monte Carlo Methods in Financial Engineering</em>. 
Springer-Verlag New York.
</p>
<p>Jun S. Liu (2004).
<em>Monte Carlo Strategies in Scientific Computing</em>. 
Springer-Verlag New York.
</p>
<p>Christian Robert and George Casella (2010).
<em>Introducing Monte Carlo Methods with R</em>. 
Springer-Verlag New York.
</p>
<p>Nick T. Thomopoulos (2013).
<em>Essentials of Monte Carlo Simulation: Statistical Methods for Building Simulation Models</em>. 
Springer-Verlag New York.
</p>
<p>Q. Ethan McCallum and Stephen Weston (2011).
<em>Parallel R</em>. 
O'Reilly Media, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEM.sde">MEM.sde</a></code> moment equations methods for SDE's.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1 : (1 dim)
## dX(t) = 3*(1-X(t)) dt + 0.5 * dW(t), X(0)=5, t in [0,10]
## set the model 1d
f &lt;- expression(3*(1-x));g &lt;- expression(0.5)
mod1d &lt;-  snssde1d(drift=f,diffusion=g,x0=5,T=10,M=50)

## function of the statistic(s) of interest.
sde.fun1d &lt;- function(data, i){
  d &lt;- data[i, ]
  return(c(mean(d),Mode(d),var(d)))
}

mc.sde1d = MCM.sde(model=mod1d,statistic=sde.fun1d,R=100,exact=list(Me=1,Mo=1,Va=0.5^2/6),
                 names=c("Me(10)","Mo(10)","Va(10)"))
mc.sde1d
plot(mc.sde1d,index=1)
plot(mc.sde1d,index=2)
plot(mc.sde1d,index=3)

## Example 2 : with Parallel computing
## Not run: 
mod1d &lt;-  snssde1d(drift=f,diffusion=g,x0=5,T=10,M=1000)
## On Windows or Unix
mc.sde1d = MCM.sde(model=mod1d,statistic=sde.fun1d,R=1000,exact=list(Me=1,Mo=1,Va=0.5^2/6),
           names=c("Me(10)","Mo(10)","Va(10)"),parallel="snow",ncpus=parallel::detectCores())
mc.sde1d
## On Unix only
mc.sde1d = MCM.sde(model=mod1d,statistic=sde.fun1d,R=1000,exact=list(Me=1,Mo=1,Va=0.5^2/6),
           names=c("Me(10)","Mo(10)","Va(10)"),parallel="multicore",ncpus=parallel::detectCores())
mc.sde1d

## End(Not run)

## Example 3: (2 dim)
## dX(t) = 1/mu*(theta-X(t)) dt + sqrt(sigma) * dW1(t),
## dY(t) = X(t) dt + 0 * dW2(t)
## Not run: 
## Set the model 2d
mu=0.75;sigma=0.1;theta=2
x0=0;y0=0;init=c(x=0,y=0)
f &lt;- expression(1/mu*(theta-x), x)  
g &lt;- expression(sqrt(sigma),0)
OUI &lt;- snssde2d(drift=f,diffusion=g,M=1000,Dt=0.01,x0=init)

## function of the statistic(s) of interest.
sde.fun2d &lt;- function(data, i){
  d &lt;- data[i,]
  return(c(mean(d$x),mean(d$y),var(d$x),var(d$y),cov(d$x,d$y)))
}
## Monte-Carlo at time = 5
mc.sde2d_a = MCM.sde(model=OUI,statistic=sde.fun2d,R=100,time=5,
                  parallel="snow",ncpus=parallel::detectCores())
mc.sde2d_a
## Monte-Carlo at time = 10
mc.sde2d_b = MCM.sde(model=OUI,statistic=sde.fun2d,R=100,time=10,
                  parallel="snow",ncpus=parallel::detectCores())
mc.sde2d_b

## Compared with exact values at time 5 and 10
E_x &lt;- function(t) theta+(x0-theta)*exp(-t/mu)
V_x &lt;- function(t) 0.5*sigma*mu *(1-exp(-2*(t/mu)))
E_y &lt;- function(t) y0+theta*t+(x0-theta)*mu*(1-exp(-t/mu))
V_y &lt;- function(t) sigma*mu^3*((t/mu)-2*(1-exp(-t/mu))+0.5*(1-exp(-2*(t/mu))))
cov_xy &lt;- function(t) 0.5*sigma*mu^2 *(1-2*exp(-t/mu)+exp(-2*(t/mu)))

## at time=5
mc.sde2d_a = MCM.sde(model=OUI,statistic=sde.fun2d,R=100,time=5,
    exact=list(m1=E_x(5),m2=E_y(5),S1=V_x(5),S2=V_y(5),C12=cov_xy(5)),
	parallel="snow",ncpus=parallel::detectCores())
mc.sde2d_a
plot(mc.sde2d_a,index=1)
plot(mc.sde2d_a,index=2)
## at time=10
mc.sde2d_b = MCM.sde(model=OUI,statistic=sde.fun2d,R=100,time=10,
    exact=list(m1=E_x(10),m2=E_y(10),S1=V_x(10),S2=V_y(10),C12=cov_xy(10)),
	parallel="snow",ncpus=parallel::detectCores())
mc.sde2d_b
plot(mc.sde2d_b,index=1)
plot(mc.sde2d_b,index=2)

## End(Not run)

## Example 4: (3 dim)
## dX(t) = sigma*(Y(t)-X(t)) dt + 0.1 * dW1(t)
## dY(t) = (rho*X(t)-Y(t)-X(t)*Z(t)) dt + 0.1 * dW2(t)
## dZ(t) = (X(t)*Y(t)-bet*Z(t)) dt + 0.1 * dW3(t)
## W1(t), W2(t) and W3(t) are three correlated Brownian motions with Sigma
## Not run: 
## Set the model 3d
sigma=10;rho=28; bet=8/3
f &lt;- expression(sigma*(y-x),rho*x-y-x*z,x*y-bet*z)
g &lt;- expression(0.1,0.1,0.1)
# correlation matrix
Sigma &lt;-matrix(c(1,0.3,0.5,0.3,1,0.2,0.5,0.2,1),nrow=3,ncol=3) 
mod3d &lt;- snssde3d(x0=rep(0,3),drift=f,diffusion=g,M=1000,Dt=0.01,corr=Sigma)

## function of the statistic(s) of interest.
sde.fun3d &lt;- function(data, i){
  d &lt;- data[i,]
  return(c(mean(d$x),mean(d$y),mean(d$z)))
}
## Monte-Carlo at time = 10
mc.sde3d = MCM.sde(mod3d,statistic=sde.fun3d,R=100,parallel="snow",ncpus=parallel::detectCores())
mc.sde3d

## End(Not run)

</code></pre>

<hr>
<h2 id='MEM.sde'>
Moment Equations Methods for SDE's
</h2><span id='topic+MEM.sde'></span><span id='topic+MEM.sde.default'></span><span id='topic+print.MEM.sde'></span><span id='topic+summary.MEM.sde'></span>

<h3>Description</h3>

<p>Calculate and numerical approximation of moment equations (Symbolic ODE's of means and variances-covariance) at any time for SDE's (1,2 and 3 dim) for the two cases Ito and Stratonovich interpretations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MEM.sde(drift, diffusion, ...)

## Default S3 method:
MEM.sde(drift, diffusion, corr = NULL, type = c("ito", "str"), solve = FALSE, 
      parms = NULL, init = NULL, time = NULL, ...)
					
## S3 method for class 'MEM.sde'
summary(object, at , ...)					
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MEM.sde_+3A_drift">drift</code></td>
<td>

<p>drift coefficient: an <code><a href="base.html#topic+expression">expression</a></code> 1-dim(t,x), 2-dim(t,x,y) or 3-dim(t,x,y,z).
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_diffusion">diffusion</code></td>
<td>

<p>diffusion coefficient: an <code><a href="base.html#topic+expression">expression</a></code> 1-dim(t,x), 2-dim(t,x,y) or 3-dim(t,x,y,z).
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_corr">corr</code></td>
<td>

<p>the correlation coefficient '|corr|&lt;=1' of W1(t) and W2(t) (2d) must be an expression length equal 1. And for 3d (W1(t),W2(t),W3(t)) an expressions length equal 3. See examples.
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_type">type</code></td>
<td>

<p>type of process <code>"ito"</code> or <code>"Stratonovich"</code>; the default <code>type="ito"</code>.
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_solve">solve</code></td>
<td>

<p>if <code>solve=TRUE</code> solves a system of ordinary differential equations.
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_parms">parms</code></td>
<td>

<p>parameters passed to <code>drift</code> and <code>diffusion</code>.
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_init">init</code></td>
<td>

<p>the initial (state) values for the ODE system. for 1-dim (m=x0,S=0), 2-dim (m1=x0,m2=y0,S1=0,S2=0,C12=0) and 
for 3-dim (m1=x0,m2=y0,m3=z0,S1=0,S2=0,S3=0,C12=0,C13=0,C23=0), see examples.
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_time">time</code></td>
<td>
	
<p>time sequence (vector) for which output is wanted; the first value of time must be the initial time.
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_object">object</code>, <code id="MEM.sde_+3A_at">at</code></td>
<td>

<p>an object inheriting from class <code>"MEM.sde"</code> and summaries at any time <code>at</code>.
</p>
</td></tr>
<tr><td><code id="MEM.sde_+3A_...">...</code></td>
<td>

<p>potentially arguments to be passed to methods, such as <code><a href="deSolve.html#topic+ode">ode</a></code> for solver for ODE's.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The stochastic transition is approximated by the moment equations, and the numerical treatment is required to solve these equations from above with given initial conditions.
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p>Symbolic ODE's of means and variances-covariance. If <code>solve=TRUE</code> approximate the moment of SDE's at any time. 
</p>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Guidoum AC, Boukhetala K (2020). 
&quot;Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc&quot;. 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1&ndash;82. doi:10.18637/jss.v096.i02
</p>
<p>Rodriguez R, Tuckwell H (2000). 
<em>A dynamical system for the approximate moments of nonlinear stochastic models of spiking neurons and networks.</em> 
Mathematical and Computer Modelling, 31(4), 175&ndash;180.
</p>
<p>Alibrandi U, Ricciardi G (2012). 
<em>Stochastic Methods in Nonlinear Structural Dynamics</em>,
3&ndash;60. Springer Vienna, Vienna. ISBN 978-3-7091-1306-6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCM.sde">MCM.sde</a></code> Monte-Carlo methods for SDE's.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(deSolve)
## Example 1: 1-dim
## dX(t) = mu * X(t) * dt + sigma * X(t) * dW(t)
## Symbolic ODE's of mean and variance
f &lt;- expression(mu*x)
g &lt;- expression(sigma*x)
res1 &lt;- MEM.sde(drift=f,diffusion=g,type="ito")
res2 &lt;- MEM.sde(drift=f,diffusion=g,type="str")
res1
res2
## numerical approximation of mean and variance
para &lt;- c(mu=2,sigma=0.5)
t    &lt;- seq(0,1,by=0.001)
init &lt;- c(m=1,S=0)
res1 &lt;- MEM.sde(drift=f,diffusion=g,solve=TRUE,init=init,parms=para,time=t)
res1
matplot.0D(res1$sol.ode,main="Mean and Variance of X(t), type Ito")
plot(res1$sol.ode,select=c("m","S"))
## approximation at time = 0.75
summary(res1,at=0.75)

##
res2 &lt;- MEM.sde(drift=f,diffusion=g,solve=TRUE,init=init,parms=para,time=t,type="str")
res2
matplot.0D(res2$sol.ode,main="Mean and Variance of X(t), type Stratonovich")
plot(res2$sol.ode,select=c("m","S"))
## approximation at time = 0.75
summary(res2,at=0.75)

## Comparison:

plot(res1$sol.ode, res2$sol.ode,ylab = c("m(t)"),select="m",xlab = "Time",
     col = c("red", "blue"))
plot(res1$sol.ode, res2$sol.ode,ylab = c("S(t)"),select="S",xlab = "Time",
     col = c("red", "blue"))
	 
## Example2: 2-dim
## dX(t) = 1/mu*(theta-X(t)) dt + sqrt(sigma) * dW1(t),
## dY(t) = X(t) dt + 0 * dW2(t)	 
## Not run: 
para=c(mu=0.75,sigma=0.1,theta=2)
init=c(m1=0,m2=0,S1=0,S2=0,C12=0)
t &lt;- seq(0,10,by=0.001)
f &lt;- expression(1/mu*(theta-x), x)  
g &lt;- expression(sqrt(sigma),0)
res2d &lt;- MEM.sde(drift=f,diffusion=g,solve=TRUE,init=init,parms=para,time=t)
res2d

## Exact moment

mu=0.75;sigma=0.1;theta=2;x0=0;y0=0
E_x &lt;- function(t) theta+(x0-theta)*exp(-t/mu)
V_x &lt;- function(t) 0.5*sigma*mu *(1-exp(-2*(t/mu)))
E_y &lt;- function(t) y0+theta*t+(x0-theta)*mu*(1-exp(-t/mu))
V_y &lt;- function(t) sigma*mu^3*((t/mu)-2*(1-exp(-t/mu))+0.5*(1-exp(-2*(t/mu))))
cov_xy &lt;- function(t) 0.5*sigma*mu^2 *(1-2*exp(-t/mu)+exp(-2*(t/mu)))

## 
summary(res2d,at=5)
E_x(5);E_y(5);V_x(5);V_y(5);cov_xy(5)

matplot.0D(res2d$sol.ode,select=c("m1"))
curve(E_x,add=TRUE,col="red") 

## plot

plot(res2d$sol.ode)
matplot.0D(res2d$sol.ode,select=c("S1","S2","C12"))   
plot(res2d$sol.ode[,"m1"], res2d$sol.ode[,"m2"], xlab = "m1(t)",
  ylab = "m2(t)", type = "l",lwd = 2)
hist(res2d$sol.ode,select=c("m1","m2"), col = c("darkblue", "red", "orange", "black"))

## Example3: 2-dim with correlation
## Heston model
## dX(t) = mu*X(t) dt + sqrt(Y(t))*X(t) * dW1(t),
## dY(t) = lambda*(theta-Y(t)) dt + sigma*sqrt(Y(t)) * dW2(t)	
## with E(dw1dw2)=rho


f &lt;- expression( mu*x, lambda*(theta-y) )
g &lt;- expression( sqrt(y)*x, sigma*sqrt(y) )
RHO  &lt;- expression(rho)
res2d &lt;- MEM.sde(drift=f,diffusion=g,corr=RHO)
res2d

## Numerical approximation
RHO &lt;- expression(0.5)
para=c(mu=1,lambda=3,theta=0.5,sigma=0.1)
ini=c(m1=10,m2=2,S1=0,S2=0,C12=0)
res2d = MEM.sde(drift=f,diffusion=g,solve=TRUE,parms=para,init=ini,time=seq(0,1,by=0.01))
res2d

matplot.0D(res2d$sol.ode,select=c("m1","m2")) 
matplot.0D(res2d$sol.ode,select=c("S1","S2","C12")) 
	 
## Example4: 3-dim
## dX(t) = sigma*(Y(t)-X(t)) dt + 0.1 * dW1(t)
## dY(t) = (rho*X(t)-Y(t)-X(t)*Z(t)) dt + 0.1 * dW2(t)
## dZ(t) = (X(t)*Y(t)-bet*Z(t)) dt + 0.1 * dW3(t)
## with E(dw1dw2)=rho1, E(dw1dw3)=rho2 and E(dw2dw3)=rho3


f &lt;- expression(sigma*(y-x),rho*x-y-x*z,x*y-bet*z)
g &lt;- expression(0.1,0.1,0.1)
RHO &lt;- expression(rho1,rho2,rho3)
## Symbolic moments equations
res3d = MEM.sde(drift=f,diffusion=g,corr=RHO)
res3d

## Numerical approximation
RHO &lt;- expression(0.5,0.2,-0.7)
para=c(sigma=10,rho=28,bet=8/3)
ini=c(m1=1,m2=1,m3=1,S1=0,S2=0,S3=0,C12=0,C13=0,C23=0)
res3d = MEM.sde(drift=f,diffusion=g,solve=T,parms=para,init=ini,time=seq(0,1,by=0.01))
res3d

summary(res3d,at=0.25)
summary(res3d,at=0.50)
summary(res3d,at=0.75)

plot(res3d$sol.ode)
matplot.0D(res3d$sol.ode,select=c("m1","m2","m3")) 
matplot.0D(res3d$sol.ode,select=c("S1","S2","S3")) 
matplot.0D(res3d$sol.ode,select=c("C12","C13","C23")) 

plot3D(res3d$sol.ode[,"m1"], res3d$sol.ode[,"m2"],res3d$sol.ode[,"m3"], xlab = "m1(t)",
  ylab = "m2(t)",zlab="m3(t)", type = "l",lwd = 2,box=F)

## End(Not run)
</code></pre>

<hr>
<h2 id='moment'>Monte-Carlo statistics of SDE's</h2><span id='topic+bconfint'></span><span id='topic+kurtosis'></span><span id='topic+moment'></span><span id='topic+Median'></span><span id='topic+Mode'></span><span id='topic+cv'></span><span id='topic+skewness'></span><span id='topic+bconfint.default'></span><span id='topic+kurtosis.default'></span><span id='topic+moment.default'></span><span id='topic+cv.default'></span><span id='topic+Median.default'></span><span id='topic+Mode.default'></span><span id='topic+skewness.default'></span>

<h3>Description</h3>

<p>Generic function for compute the kurtosis, skewness, median, mode and coefficient of variation (relative variability), moment and confidence interval of class <code>"sde"</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
bconfint(x, level = 0.95, ...)
## Default S3 method:
kurtosis(x, ...)
## Default S3 method:
moment(x, order = 1,center = TRUE, ...)
## Default S3 method:
cv(x, ...)
## Default S3 method:
skewness(x, ...)
## Default S3 method:
Median(x, ...)
## Default S3 method:
Mode(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="moment_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>"sde"</code>.</p>
</td></tr>  
<tr><td><code id="moment_+3A_order">order</code></td>
<td>
<p>order of moment.</p>
</td></tr>
<tr><td><code id="moment_+3A_center">center</code></td>
<td>
<p>if <code>TRUE</code> is a central moment.</p>
</td></tr>
<tr><td><code id="moment_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr> 
<tr><td><code id="moment_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1:
## dX(t) = 2*(3-X(t)) *dt + dW(t)
set.seed(1234)

f &lt;- expression( 2*(3-x) )
g &lt;- expression( 1 )
mod &lt;- snssde1d(drift=f,diffusion=g,M=10000,T=5)
## Monte-Carlo statistics of 5000 trajectory of X(t) at final time T of 'mod'
summary(mod)
kurtosis(mod)
skewness(mod)
mean(mod)
Median(mod)
Mode(mod)
moment(mod,order=4)
cv(mod)
bconfint(mod,level = 0.95) ## of mean
</code></pre>

<hr>
<h2 id='plot2d'>Plotting for Class SDE</h2><span id='topic+plot2d'></span><span id='topic+lines2d'></span><span id='topic+points2d'></span><span id='topic+plot3D'></span><span id='topic+plot2d.default'></span><span id='topic+lines2d.default'></span><span id='topic+points2d.default'></span><span id='topic+plot3D.default'></span>

<h3>Description</h3>

<p>Generic function for plotting.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
plot2d(x, ...)
## Default S3 method:
lines2d(x, ...)
## Default S3 method:
points2d(x, ...)
## Default S3 method:
plot3D(x, display = c("persp","rgl"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot2d_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+snssde2d">snssde2d</a></code>, <code><a href="#topic+snssde3d">snssde3d</a></code>, <code><a href="#topic+bridgesde2d">bridgesde2d</a></code> and <code><a href="#topic+bridgesde3d">bridgesde3d</a></code>.</p>
</td></tr>
<tr><td><code id="plot2d_+3A_display">display</code></td>
<td>
<p><code>"persp"</code> perspective or <code>"rgl"</code> plots.</p>
</td></tr>   
<tr><td><code id="plot2d_+3A_...">...</code></td>
<td>
<p>other graphics parameters, see <code><a href="graphics.html#topic+par">par</a></code> in package &quot;graphics&quot;, <code>scatterplot3d</code> in package &quot;scatterplot3d&quot; and 
<code>plot3d</code> in package &quot;rgl&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 2 and 3-dim plot of class sde.
</p>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: 
set.seed(1234)

fx &lt;- rep(expression(0),2)
gx &lt;- rep(expression(1),2)

res &lt;- snssde2d(drift=fx,diffusion=gx,N=5000)
plot2d(res,type="l")
</code></pre>

<hr>
<h2 id='rsde1d'>
Approximate transitional densities and random generation for 1-D SDE
</h2><span id='topic+rsde1d'></span><span id='topic+rsde1d.default'></span><span id='topic+dsde1d'></span><span id='topic+dsde1d.default'></span><span id='topic+print.dsde1d'></span><span id='topic+plot.dsde1d'></span>

<h3>Description</h3>

<p>Transition density and random generation for <code>X(t-s) | X(s)=x0</code> of the 1-dim SDE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsde1d(object, ...)
dsde1d(object, ...)

## Default S3 method:
rsde1d(object, at, ...)

## Default S3 method:
dsde1d(object, at, ...)
## S3 method for class 'dsde1d'
plot(x,hist=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsde1d_+3A_object">object</code></td>
<td>

<p>an object inheriting from class <code><a href="#topic+snssde1d">snssde1d</a></code> and <code><a href="#topic+bridgesde1d">bridgesde1d</a></code>.
</p>
</td></tr>
<tr><td><code id="rsde1d_+3A_at">at</code></td>
<td>

<p>time between <code>s=t0</code> and <code>t=T</code>. The default <code>at = T</code>.
</p>
</td></tr>
<tr><td><code id="rsde1d_+3A_x">x</code></td>
<td>

<p>an object inheriting from class <code>dsde1d</code>.
</p>
</td></tr>
<tr><td><code id="rsde1d_+3A_hist">hist</code></td>
<td>
<p>if <code>hist=TRUE</code> plot histogram. Based on <code><a href="MASS.html#topic+truehist">truehist</a></code> function.</p>
</td></tr> 
<tr><td><code id="rsde1d_+3A_...">...</code></td>
<td>

<p>potentially arguments to be passed to methods, such as <code><a href="stats.html#topic+density">density</a></code> for kernel density.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>rsde1d</code> returns a <code>M</code> random variable <code class="reqn">x_{t=at}</code> realize at time <code class="reqn">t=at</code> defined by : 
</p>
<p style="text-align: center;"><code class="reqn">x_{ t=at } = \{ t \geq 0 ; x = X_{ t=at } \}</code>
</p>

<p><img src="../help/figures/r1d.png" alt="fig01" />
</p>
<p>And <code>dsde1d</code> returns a transition density approximation for <code>X(t-s) | X(s)=x0</code>.
with <code class="reqn">t= at </code> is a fixed time between <code>t0</code> and <code>T</code>.
</p>
<p><img src="../help/figures/tranden1d.png" alt="fig02" />
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dsde1d()</code></td>
<td>
<p>gives the transition density estimate of <code>X(t-s) | X(s)=x0</code>.</p>
</td></tr>
<tr><td><code>rsde1d()</code></td>
<td>
<p>generates random of <code>X(t-s) | X(s)=x0</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+density">density</a></code> Kernel density estimation in &quot;stats&quot; package. 
</p>
<p><code>kde</code> Kernel density estimate for 1- to 6-dimensional data in &quot;ks&quot; package.
</p>
<p><code>sm.density</code> Nonparametric density estimation in one, two or three dimensions in &quot;sm&quot; package.
</p>
<p><code>rng</code> random number generators in &quot;yuima&quot; package. 
</p>
<p><code>dcSim</code> Pedersen's simulated transition density in &quot;sde&quot; package.
</p>
<p><code>rcBS</code>, <code>rcCIR</code>, <code>rcOU</code> and <code>rsOU</code>  in package &quot;sde&quot;.
</p>
<p><code>dcBS</code>, <code>dcCIR</code>, <code>dcOU</code> and <code>dsOU</code>  in package &quot;sde&quot;.
</p>
<p><code>GQD.density</code> Generate the transition density of a scalar generalized quadratic diffusion in &quot;DiffusionRgqd&quot; package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1:  
## dX(t) = (-2*(X(t)&lt;=0)+2*(X(t)&gt;=0)) *dt + 0.5 * dW(t)
set.seed(1234)

f &lt;- expression(-2*(x&lt;=0)+2*(x&gt;=0))
g &lt;- expression(0.5)
res1 &lt;- snssde1d(drift=f,diffusion=g,M=5000)
x &lt;- rsde1d(res1, at = 1)
summary(x)
dens1 &lt;-  dsde1d(res1, at = 1)
dens1
plot(dens1,main="Transition density of X(t=1)|X(s=0)=0") # kernel estimated
plot(dens1,hist=TRUE) # histogramme

## Example 2:
## Transition density of standard Brownian motion W(t) at time = 0.5
set.seed(1234)

f &lt;- expression(0)
g &lt;- expression(1)
res2 &lt;- snssde1d(drift=f,diffusion=g,M=5000)
plot(dsde1d(res2, at = 0.5),dens=function(x) dnorm(x,0,sqrt(0.5)))
plot(dsde1d(res2, at = 0.5),dens=function(x) dnorm(x,0,sqrt(0.5)),hist=TRUE)

## Example 3: Transition density of Brownian motion W(t) in [0,1]

## Not run: 
for (i in seq(res2$t0,res2$T,by=res2$Dt)){
plot(dsde1d(res2, at = i),main=paste0('Transition Density \n t = ',i))
}

## End(Not run)

## Example 4:
## Transition density of bridge Brownian motion W(t) at time = 0.25 and 0.75 
set.seed(1234)
## Not run: 
f &lt;- expression(0)
g &lt;- expression(1)
Bd &lt;- bridgesde1d(drift=f,diffusion=g,M=5000)
Bd
plot(dsde1d(Bd, at = 0.25))         ## Transition Density at time=0.25
plot(dsde1d(Bd, at = 0.75),add=TRUE)## Transition Density at time=0.75

## End(Not run)
</code></pre>

<hr>
<h2 id='rsde2d'>Approximate transitional densities and random generation for 2-D SDE's</h2><span id='topic+rsde2d'></span><span id='topic+rsde2d.default'></span><span id='topic+dsde2d'></span><span id='topic+dsde2d.default'></span><span id='topic+print.dsde2d'></span><span id='topic+plot.dsde2d'></span>

<h3>Description</h3>

<p>Transition density and random generation for the joint and marginal of <code>(X(t-s),Y(t-s) | X(s)=x0,Y(s)=y0)</code> of the SDE's 2-d.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsde2d(object, ...)
dsde2d(object, ...)

## Default S3 method:
rsde2d(object, at, ...)

## Default S3 method:
dsde2d(object, pdf=c("Joint","Marginal"), at, ...)
## S3 method for class 'dsde2d'
plot(x,display=c("persp","rgl","image","contour"),hist=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsde2d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+snssde2d">snssde2d</a></code> and <code><a href="#topic+bridgesde2d">bridgesde2d</a></code>.</p>
</td></tr>
<tr><td><code id="rsde2d_+3A_at">at</code></td>
<td>
<p>time between <code>s=t0</code> and <code>t=T</code>. The default <code>at = T</code>.</p>
</td></tr>
<tr><td><code id="rsde2d_+3A_pdf">pdf</code></td>
<td>
<p>probability density function <code>Joint</code> or <code>Marginal</code>.</p>
</td></tr>  
<tr><td><code id="rsde2d_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>dsde2d</code>.</p>
</td></tr>
<tr><td><code id="rsde2d_+3A_display">display</code></td>
<td>
<p>display plots.</p>
</td></tr> 
<tr><td><code id="rsde2d_+3A_hist">hist</code></td>
<td>
<p>if <code>hist=TRUE</code> plot histogram. Based on <code><a href="MASS.html#topic+truehist">truehist</a></code> function.</p>
</td></tr> 
<tr><td><code id="rsde2d_+3A_...">...</code></td>
<td>
<p>potentially potentially arguments to be passed to methods, such as <code><a href="stats.html#topic+density">density</a></code> for marginal density and <code><a href="MASS.html#topic+kde2d">kde2d</a></code> fro joint density.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>rsde2d</code> returns a <code>M</code> random variable <code class="reqn">x_{t=at},y_{t=at}</code> realize at time <code class="reqn">t=at</code>.
</p>
<p><img src="../help/figures/r2d.png" alt="fig03" />
</p>
<p>And <code>dsde2d</code> returns a bivariate density approximation for <code>(X(t-s),Y(t-s) | X(s)=x0,Y(s)=y0)</code>. with <code class="reqn"> t=at </code> is a fixed time between <code>t0</code> and <code>T</code>.
</p>
<p><img src="../help/figures/tranden2d.png" alt="fig04" />
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dsde2d()</code></td>
<td>
<p>gives the bivariate density approximation for <code>(X(t-s),Y(t-s) | X(s)=x0,Y(s)=y0)</code>.</p>
</td></tr>
<tr><td><code>rsde2d()</code></td>
<td>
<p>generates random of the couple <code>(X(t-s),Y(t-s) | X(s)=x0,Y(s)=y0)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+kde2d">kde2d</a></code> Two-dimensional kernel density estimation in &quot;MASS&quot; package.
</p>
<p><code>kde</code> Kernel density estimate for 1- to 6-dimensional data in &quot;ks&quot; package.
</p>
<p><code>sm.density</code> Nonparametric density estimation in one, two or three dimensions in &quot;sm&quot; package.
</p>
<p><code>rng</code> random number generators in &quot;yuima&quot; package. 
</p>
<p><code>BiGQD.density</code> Generate the transition density of a bivariate generalized quadratic diffusion model (2D GQD) in &quot;DiffusionRgqd&quot; package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example:1
set.seed(1234)

# SDE's 2d
fx &lt;- expression(3*(2-y),2*x)
gx &lt;- expression(1,y)
mod2d &lt;- snssde2d(drift=fx,diffusion=gx,x0=c(1,2),M=1000)

# random 
r2d &lt;- rsde2d(mod2d,at=0.5)
summary(r2d)

# Marginal density 

denM &lt;- dsde2d(mod2d,pdf="M", at=0.5)
denM
plot(denM)

# Joint density
denJ &lt;- dsde2d(mod2d,pdf="J",n=200, at= 0.5,lims=c(-3,4,0,6))
denJ
plot(denJ)
plot(denJ,display="contour")

## Example 2: Bivariate Transition Density of 2 Brownian motion (W1(t),W2(t)) in [0,1]

## Not run: 
B2d &lt;- snssde2d(drift=rep(expression(0),2),diffusion=rep(expression(1),2),
       M=10000)
for (i in seq(B2d$Dt,B2d$T,by=B2d$Dt)){
plot(dsde2d(B2d, at = i,lims=c(-3,3,-3,3),n=100),
   display="contour",main=paste0('Transition Density \n t = ',i))
}

## End(Not run)

## Example 3: 

## Not run: 
fx &lt;- expression(4*(-1-x)*y , 4*(1-y)*x )
gx &lt;- expression(0.25*y,0.2*x)
mod2d1 &lt;- snssde2d(drift=fx,diffusion=gx,x0=c(x0=1,y0=-1),
      M=5000,type="str")

# Marginal transition density
for (i in seq(mod2d1$Dt,mod2d1$T,by=mod2d1$Dt)){
plot(dsde2d(mod2d1,pdf="M", at = i),main=
      paste0('Marginal Transition Density \n t = ',i))
}

# Bivariate transition density
for (i in seq(mod2d1$Dt,mod2d1$T,by=mod2d1$Dt)){
plot(dsde2d(mod2d1, at = i,lims=c(-1,2,-1,1),n=100),
    display="contour",main=paste0('Transition Density \n t = ',i))
}

## End(Not run)

## Example 4: Bivariate Transition Density of 2 bridge Brownian motion (W1(t),W2(t)) in [0,1]

## Not run: 
B2d &lt;- bridgesde2d(drift=rep(expression(0),2),
  diffusion=rep(expression(1),2),M=5000)
for (i in seq(0.01,0.99,by=B2d$Dt)){ 
plot(dsde2d(B2d, at = i,lims=c(-3,3,-3,3),
 n=100),display="contour",main=
 paste0('Transition Density \n t = ',i))
}

## End(Not run)

## Example 5: Bivariate Transition Density of bridge 
## Ornstein-Uhlenbeck process and its integral in [0,5]
## dX(t) = 4*(-1-X(t)) dt + 0.2 dW1(t)
## dY(t) = X(t) dt + 0 dW2(t)
## x01 = 0 , y01 = 0
## x02 = 0, y02 = 0 
## Not run: 
fx &lt;- expression(4*(-1-x) , x)
gx &lt;- expression(0.2 , 0)
OUI &lt;- bridgesde2d(drift=fx,diffusion=gx,Dt=0.005,M=1000)
for (i in seq(0.01,4.99,by=OUI$Dt)){
plot(dsde2d(OUI, at = i,lims=c(-1.2,0.2,-2.5,0.2),n=100),
 display="contour",main=paste0('Transition Density \n t = ',i))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='rsde3d'>Approximate transitional densities and random generation for 3-D SDE's</h2><span id='topic+rsde3d'></span><span id='topic+rsde3d.default'></span><span id='topic+dsde3d'></span><span id='topic+dsde3d.default'></span><span id='topic+print.dsde3d'></span><span id='topic+plot.dsde3d'></span>

<h3>Description</h3>

<p>Transition density and random generation for the joint and marginal of <code>(X(t-s),Y(t-s),Z(t-s) | X(s)=x0,Y(s)=y0,Z(s)=z0)</code> of the SDE's 3-d.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsde3d(object, ...)
dsde3d(object, ...)

## Default S3 method:
rsde3d(object, at, ...)

## Default S3 method:
dsde3d(object, pdf=c("Joint","Marginal"), at, ...)
## S3 method for class 'dsde3d'
plot(x,display="rgl",hist=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsde3d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+snssde3d">snssde3d</a></code> and <code><a href="#topic+bridgesde3d">bridgesde3d</a></code>.</p>
</td></tr>
<tr><td><code id="rsde3d_+3A_at">at</code></td>
<td>
<p>time between <code>s=t0</code> and <code>t=T</code>. The default <code>at = T</code>.</p>
</td></tr>
<tr><td><code id="rsde3d_+3A_pdf">pdf</code></td>
<td>
<p>probability density function <code>Joint</code> or <code>Marginal</code>.</p>
</td></tr>  
<tr><td><code id="rsde3d_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>dsde3d</code>.</p>
</td></tr>
<tr><td><code id="rsde3d_+3A_display">display</code></td>
<td>
<p>display plots.</p>
</td></tr> 
<tr><td><code id="rsde3d_+3A_hist">hist</code></td>
<td>
<p>if <code>hist=TRUE</code> plot histogram. Based on <code><a href="MASS.html#topic+truehist">truehist</a></code> function.</p>
</td></tr> 
<tr><td><code id="rsde3d_+3A_...">...</code></td>
<td>
<p>potentially arguments to be passed to methods, such as <code><a href="stats.html#topic+density">density</a></code> for marginal density  and <code><a href="sm.html#topic+sm.density">sm.density</a></code> for joint density.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>rsde3d</code> returns a <code>M</code> random variable <code class="reqn">x_{t=at},y_{t=at},z_{t=at}</code> realize at time <code class="reqn">t=at</code>.
</p>
<p><img src="../help/figures/r3d.png" alt="fig05" />
</p>
<p>And <code>dsde3d</code> returns a trivariate kernel density approximation for <code>(X(t-s),Y(t-s),Z(t-s) | X(s)=x0,Y(s)=y0,Z(s)=z0)</code>. with <code class="reqn">t= at </code> is a fixed time between <code>t0</code> and <code>T</code>.
</p>
<p><img src="../help/figures/tranden3d.png" alt="fig06" />
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dsde3d()</code></td>
<td>
<p>gives the trivariate density approximation <code>(X(t-s),Y(t-s),Z(t-s) | X(s)=x0,Y(s)=y0,Z(s)=z0)</code>.</p>
</td></tr>
<tr><td><code>rsde3d()</code></td>
<td>
<p>generates random of the <code>(X(t-s),Y(t-s),Z(t-s) | X(s)=x0,Y(s)=y0,Z(s)=z0)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>See Also</h3>

<p><code>kde</code> Kernel density estimate for 1- to 6-dimensional data in &quot;ks&quot; package.
</p>
<p><code>sm.density</code> Nonparametric density estimation in one, two or three dimensions in &quot;sm&quot; package.
</p>
<p><code>kde3d</code> Compute a three dimension kernel density estimate in &quot;misc3d&quot; package.
</p>
<p><code>rng</code> random number generators in &quot;yuima&quot; package. 
</p>
<p><code>rcBS</code>, <code>rcCIR</code>, <code>rcOU</code> and <code>rsOU</code> in package &quot;sde&quot;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Ito sde
## dX(t) = (2*(Y(t)&gt;0)-2*(Z(t)&lt;=0)) dt + 0.2 * dW1(t) 
## dY(t) = -2*Y(t) dt + 0.2 * dW2(t) 
## dZ(t) = -2*Z(t) dt + 0.2 * dW3(t)        
## W1(t), W2(t) and W3(t) three independent Brownian motion
set.seed(1234)
fx &lt;- expression(2*(y&gt;0)-2*(z&lt;=0) , -2*y, -2*z)
gx &lt;- rep(expression(0.2),3)
mod3d1 &lt;- snssde3d(x0=c(0,2,-2),drift=fx,diffusion=gx,M=1000,Dt=0.003)

# random at t= 0.75
r3d1 &lt;- rsde3d(mod3d1,at=0.75)
summary(r3d1)

# Marginal transition density at t=0.75, t0=0

denM &lt;- dsde3d(mod3d1,pdf="M",at=0.75)
denM
plot(denM)

# for Joint transition density at t=0.75;t0=0 
# Multiple isosurfaces
## Not run: 
denJ &lt;- dsde3d(mod3d1,pdf="J", at= 0.75)
denJ
plot(denJ,display="rgl")

## End(Not run)

## Example 2: Stratonovich sde
## dX(t) = Y(t)* dt + X(t) o dW1(t)          
## dY(t) = (4*( 1-X(t)^2 )* Y(t) - X(t))* dt + 0.2 o dW2(t)
## dZ(t) = (4*( 1-X(t)^2 )* Z(t) - X(t))* dt + 0.2 o dW3(t)
set.seed(1234)

fx &lt;- expression( y , (4*( 1-x^2 )* y - x), (4*( 1-x^2 )* z - x))
gx &lt;- expression( x , 0.2, 0.2)
mod3d2 &lt;- snssde3d(drift=fx,diffusion=gx,M=1000,type="str")

# random 
r3d2 &lt;- rsde3d(mod3d2)
summary(r3d2)

# Marginal transition density at t=1, t0=0

denM &lt;- dsde3d(mod3d2,pdf="M")
denM
plot(denM)

# for Joint transition density at t=1;t0=0
# Multiple isosurfaces
## Not run: 
denJ &lt;- dsde3d(mod3d2,pdf="J")
denJ
plot(denJ,display="rgl")

## End(Not run)

## Example 3: Tivariate Transition Density of 3 Brownian motion (W1(t),W2(t),W3(t)) in [0,1]

## Not run: 
B3d &lt;- snssde3d(drift=rep(expression(0),3),diffusion=rep(expression(1),3),M=500)
for (i in seq(B3d$Dt,B3d$T,by=B3d$Dt)){
plot(dsde3d(B3d, at = i,pdf="J"),box=F,main=paste0('Transition Density t = ',i))
}

## End(Not run)

</code></pre>

<hr>
<h2 id='snssde1d'>Simulation of 1-D Stochastic Differential Equation</h2><span id='topic+snssde1d'></span><span id='topic+snssde1d.default'></span><span id='topic+summary.snssde1d'></span><span id='topic+print.snssde1d'></span><span id='topic+time.snssde1d'></span><span id='topic+mean.snssde1d'></span><span id='topic+Median.snssde1d'></span><span id='topic+Mode.snssde1d'></span><span id='topic+quantile.snssde1d'></span><span id='topic+kurtosis.snssde1d'></span><span id='topic+skewness.snssde1d'></span><span id='topic+moment.snssde1d'></span><span id='topic+cv.snssde1d'></span><span id='topic+max.snssde1d'></span><span id='topic+min.snssde1d'></span><span id='topic+bconfint.snssde1d'></span><span id='topic+plot.snssde1d'></span><span id='topic+points.snssde1d'></span><span id='topic+lines.snssde1d'></span>

<h3>Description</h3>

<p>The (S3) generic function <code>snssde1d</code> of simulation of solution to 1-dim stochastic differential equation of Itô or Stratonovich type, with different methods.</p>


<h3>Usage</h3>

<pre><code class='language-R'>snssde1d(N, ...)
## Default S3 method:
snssde1d(N = 1000, M = 1, x0 = 0, t0 = 0, T = 1, Dt, 
   drift, diffusion, alpha = 0.5, mu = 0.5, type = c("ito", "str"), 
   method = c("euler", "milstein", "predcorr", "smilstein", "taylor", 
   "heun", "rk1", "rk2", "rk3"), ...)	
   
## S3 method for class 'snssde1d'
summary(object, at ,digits=NULL, ...)
## S3 method for class 'snssde1d'
time(x, ...)
## S3 method for class 'snssde1d'
mean(x, at, ...)
## S3 method for class 'snssde1d'
Median(x, at, ...)
## S3 method for class 'snssde1d'
Mode(x, at, ...)
## S3 method for class 'snssde1d'
quantile(x, at, ...)
## S3 method for class 'snssde1d'
kurtosis(x, at, ...)
## S3 method for class 'snssde1d'
min(x, at, ...)
## S3 method for class 'snssde1d'
max(x, at, ...)
## S3 method for class 'snssde1d'
skewness(x, at, ...)
## S3 method for class 'snssde1d'
moment(x, at,  ...)
## S3 method for class 'snssde1d'
cv(x, at,  ...)
## S3 method for class 'snssde1d'
bconfint(x, at,  ...)

## S3 method for class 'snssde1d'
plot(x, ...)
## S3 method for class 'snssde1d'
lines(x, ...)
## S3 method for class 'snssde1d'
points(x, ...)		
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="snssde1d_+3A_n">N</code></td>
<td>
<p>number of simulation steps.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_m">M</code></td>
<td>
<p>number of trajectories (Monte-Carlo).</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_x0">x0</code></td>
<td>
<p>initial value of the process at time <code>t0</code>.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_t0">t0</code></td>
<td>
<p>initial time.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_t">T</code></td>
<td>
<p>ending time.</p>
</td></tr> 
<tr><td><code id="snssde1d_+3A_dt">Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code><a href="base.html#topic+missing">missing</a></code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_drift">drift</code></td>
<td>
<p>drift coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of two variables <code>t</code> and <code>x</code>.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_diffusion">diffusion</code></td>
<td>
<p>diffusion coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of two variables <code>t</code> and <code>x</code>.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_alpha">alpha</code>, <code id="snssde1d_+3A_mu">mu</code></td>
<td>
<p>weight of the predictor-corrector scheme; the default <code>alpha = 0.5</code> and <code>mu = 0.5</code>.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_type">type</code></td>
<td>
<p>if <code>type="ito"</code> simulation sde of Itô type, else <code>type="str"</code> simulation sde of Stratonovich type; the default <code>type="ito"</code>.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_method">method</code></td>
<td>
<p>numerical methods of simulation, the default <code>method = "euler"</code>.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_x">x</code>, <code id="snssde1d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>"snssde1d"</code>.</p>
</td></tr>
<tr><td><code id="snssde1d_+3A_at">at</code></td>
<td>
<p>time between <code>t0</code> and <code>T</code>. Monte-Carlo statistics of the solution <code class="reqn">X_{t}</code> at time <code>at</code>. The default <code>at = T</code>.</p>
</td></tr>   
<tr><td><code id="snssde1d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr>  
<tr><td><code id="snssde1d_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>snssde1d</code> returns a <code><a href="stats.html#topic+ts">ts</a></code> x of length <code>N+1</code>; i.e. solution of the sde of Ito or 
Stratonovich types; If <code>Dt</code> is not specified, then the best discretization <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>. 
</p>
<p>The Ito stochastic differential equation is: 
</p>
<p style="text-align: center;"><code class="reqn">dX(t) = a(t,X(t)) dt + b(t,X(t)) dW(t)</code>
</p>

<p>Stratonovich sde :
</p>
<p style="text-align: center;"><code class="reqn">dX(t) = a(t,X(t)) dt + b(t,X(t)) \circ dW(t)</code>
</p>

<p>The methods of approximation are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong 
and the weak (orders of) convergence. The <code>method</code> of simulation can be one among: <code>Euler-Maruyama Order 0.5</code>, <code>Milstein Order 1</code>, <code>Milstein Second-Order</code>, 
<code>Predictor-Corrector method</code>, <code>Itô-Taylor Order 1.5</code>, <code>Heun Order 2</code> and <code>Runge-Kutta Order 1, 2 and 3</code>. 
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>snssde1d</code> returns an object inheriting from <code><a href="base.html#topic+class">class</a></code> <code>"snssde1d"</code>.
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>an invisible <code><a href="stats.html#topic+ts">ts</a></code> object.</p>
</td></tr>
<tr><td><code>drift</code></td>
<td>
<p>drift coefficient.</p>
</td></tr>
<tr><td><code>diffusion</code></td>
<td>
<p>diffusion coefficient.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of sde.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the numerical method used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Guidoum AC, Boukhetala K (2020). 
&quot;Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc&quot;. 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1&ndash;82. doi:10.18637/jss.v096.i02
</p>
<p>Friedman, A. (1975). 
<em>Stochastic differential equations and applications</em>.
Volume 1, ACADEMIC PRESS.
</p>
<p>Henderson, D. and Plaschko,P. (2006). 
<em>Stochastic differential equations in science and engineering</em>.
World Scientific.
</p>
<p>Allen, E. (2007).
<em>Modeling with Ito stochastic differential equations</em>. 
Springer-Verlag.
</p>
<p>Jedrzejewski, F. (2009). 
<em>Modeles aleatoires et physique probabiliste</em>. 
Springer-Verlag.
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York.
</p>
<p>Kloeden, P.E, and Platen, E. (1989). 
A survey of numerical methods for stochastic differential equations. 
<em>Stochastic Hydrology and Hydraulics</em>, <b>3</b>, 155&ndash;178.
</p>
<p>Kloeden, P.E, and Platen, E. (1991a).
Relations between multiple ito and stratonovich integrals.
<em>Stochastic Analysis and Applications</em>, <b>9</b>(3), 311&ndash;321.
</p>
<p>Kloeden, P.E, and Platen, E. (1991b).
Stratonovich and ito stochastic taylor expansions. 
<em>Mathematische Nachrichten</em>, <b>151</b>, 33&ndash;50.
</p>
<p>Kloeden, P.E, and Platen, E. (1995).
<em>Numerical Solution of Stochastic Differential Equations</em>. 
Springer-Verlag, New York.
</p>
<p>Oksendal, B. (2000).
<em>Stochastic Differential Equations: An Introduction with Applications</em>.
5th edn. Springer-Verlag, Berlin.
</p>
<p>Platen, E. (1980).
Weak convergence of approximations of ito integral equations. 
<em>Z Angew Math Mech</em>. <b>60</b>, 609&ndash;614.
</p>
<p>Platen, E. and Bruti-Liberati, N. (2010).
<em>Numerical Solution of Stochastic Differential Equations with Jumps in Finance.</em> 
Springer-Verlag, New York
</p>
<p>Saito, Y, and Mitsui, T. (1993).
Simulation of Stochastic Differential Equations. 
<em>The Annals of the Institute of Statistical Mathematics</em>, <b>3</b>, 419&ndash;432.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+snssde2d">snssde2d</a></code> and <code><a href="#topic+snssde3d">snssde3d</a></code> for 2 and 3-dim sde.
</p>
<p><code>sde.sim</code> in package &quot;sde&quot;. 
</p>
<p><code>simulate</code> in package &quot;yuima&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Ito sde
## dX(t) = 2*(3-X(t)) dt + 2*X(t) dW(t)
set.seed(1234)

f &lt;- expression(2*(3-x) )
g &lt;- expression(1)
mod1 &lt;- snssde1d(drift=f,diffusion=g,M=4000,x0=10,Dt=0.01)
mod1
summary(mod1)
## Not run: 
plot(mod1)
lines(time(mod1),apply(mod1$X,1,mean),col=2,lwd=2)
lines(time(mod1),apply(mod1$X,1,bconfint,level=0.95)[1,],col=4,lwd=2)
lines(time(mod1),apply(mod1$X,1,bconfint,level=0.95)[2,],col=4,lwd=2)
legend("topright",c("mean path",paste("bound of", 95," percent confidence")),
       inset = .01,col=c(2,4),lwd=2,cex=0.8)

## End(Not run)
## Example 2: Stratonovich sde
## dX(t) = ((2-X(t))/(2-t)) dt + X(t) o dW(t)
set.seed(1234)

f &lt;- expression((2-x)/(2-t))
g &lt;- expression(x)
mod2 &lt;- snssde1d(type="str",drift=f,diffusion=g,M=4000,x0=1, method="milstein")
mod2
summary(mod2,at = 0.25)
summary(mod2,at = 1)
## Not run: 
plot(mod2)
lines(time(mod2),apply(mod2$X,1,mean),col=2,lwd=2)
lines(time(mod2),apply(mod2$X,1,bconfint,level=0.95)[1,],col=4,lwd=2)
lines(time(mod2),apply(mod2$X,1,bconfint,level=0.95)[2,],col=4,lwd=2)
legend("topleft",c("mean path",paste("bound of", 95," percent confidence")),
       inset = .01,col=c(2,4),lwd=2,cex=0.8)

## End(Not run)
</code></pre>

<hr>
<h2 id='snssde2d'>Simulation of 2-D Stochastic Differential Equation</h2><span id='topic+snssde2d'></span><span id='topic+snssde2d.default'></span><span id='topic+summary.snssde2d'></span><span id='topic+print.snssde2d'></span><span id='topic+time.snssde2d'></span><span id='topic+mean.snssde2d'></span><span id='topic+Median.snssde2d'></span><span id='topic+Mode.snssde2d'></span><span id='topic+quantile.snssde2d'></span><span id='topic+kurtosis.snssde2d'></span><span id='topic+skewness.snssde2d'></span><span id='topic+moment.snssde2d'></span><span id='topic+cv.snssde2d'></span><span id='topic+max.snssde2d'></span><span id='topic+min.snssde2d'></span><span id='topic+bconfint.snssde2d'></span><span id='topic+plot.snssde2d'></span><span id='topic+points.snssde2d'></span><span id='topic+lines.snssde2d'></span><span id='topic+plot2d.snssde2d'></span><span id='topic+points2d.snssde2d'></span><span id='topic+lines2d.snssde2d'></span>

<h3>Description</h3>

<p>The (S3) generic function <code>snssde2d</code> of simulation of solutions to 2-dim stochastic differential equations of Itô or Stratonovich type, with different methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>snssde2d(N, ...)
## Default S3 method:
snssde2d(N = 1000, M = 1, x0 = c(0,0),t0 = 0, T = 1, Dt, 
   drift, diffusion, corr = NULL, type = c("ito", "str"), alpha = 0.5, mu = 0.5, 
   method = c("euler", "milstein", "predcorr", "smilstein", "taylor", 
   "heun", "rk1", "rk2","rk3"), ...)	
   
## S3 method for class 'snssde2d'
summary(object, at, digits=NULL,...)
## S3 method for class 'snssde2d'
time(x, ...)
## S3 method for class 'snssde2d'
mean(x, at, ...)
## S3 method for class 'snssde2d'
Median(x, at, ...)
## S3 method for class 'snssde2d'
Mode(x, at, ...)
## S3 method for class 'snssde2d'
quantile(x, at, ...)
## S3 method for class 'snssde2d'
kurtosis(x, at, ...)
## S3 method for class 'snssde2d'
skewness(x, at, ...)
## S3 method for class 'snssde2d'
min(x, at, ...)
## S3 method for class 'snssde2d'
max(x, at, ...)
## S3 method for class 'snssde2d'
moment(x, at, ...)
## S3 method for class 'snssde2d'
cv(x, at, ...)
## S3 method for class 'snssde2d'
bconfint(x, at, ...)

## S3 method for class 'snssde2d'
plot(x, ...)
## S3 method for class 'snssde2d'
lines(x, ...)
## S3 method for class 'snssde2d'
points(x, ...)
## S3 method for class 'snssde2d'
plot2d(x, ...)
## S3 method for class 'snssde2d'
lines2d(x, ...)
## S3 method for class 'snssde2d'
points2d(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="snssde2d_+3A_n">N</code></td>
<td>
<p>number of simulation steps.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_m">M</code></td>
<td>
<p>number of trajectories (Monte-Carlo).</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_x0">x0</code></td>
<td>
<p>initial values x0=(x,y) of the process <code class="reqn">X_{t}</code> and <code class="reqn">Y_{t}</code> at time <code>t0</code>.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_t0">t0</code></td>
<td>
<p>initial time.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_t">T</code></td>
<td>
<p>ending time.</p>
</td></tr> 
<tr><td><code id="snssde2d_+3A_dt">Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code><a href="base.html#topic+missing">missing</a></code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_drift">drift</code></td>
<td>
<p>drift coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of three variables <code>t</code>, <code>x</code> and <code>y</code> for process <code class="reqn">X_t</code> and <code class="reqn">Y_t</code>.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_diffusion">diffusion</code></td>
<td>
<p>diffusion coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of three variables <code>t</code>, <code>x</code> and <code>y</code> for process <code class="reqn">X_t</code> and <code class="reqn">Y_t</code>.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_corr">corr</code></td>
<td>
<p>the correlation structure of two Brownian motions W1(t) and W2(t); must be a real symmetric positive-definite square matrix of dimension 2.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_type">type</code></td>
<td>
<p>if <code>type="ito"</code> simulation sde of Itô type, else <code>type="str"</code> simulation sde of Stratonovich type; the default <code>type="ito"</code>.</p>
</td></tr>  
<tr><td><code id="snssde2d_+3A_alpha">alpha</code>, <code id="snssde2d_+3A_mu">mu</code></td>
<td>
<p>weight of the predictor-corrector scheme; the default <code>alpha = 0.5</code> and <code>mu = 0.5</code>.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_method">method</code></td>
<td>
<p>numerical methods of simulation, the default <code>method = "euler"</code>.</p>
</td></tr>
<tr><td><code id="snssde2d_+3A_x">x</code>, <code id="snssde2d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>"snssde2d"</code>.</p>
</td></tr> 
<tr><td><code id="snssde2d_+3A_at">at</code></td>
<td>
<p>time between <code>t0</code> and <code>T</code>. Monte-Carlo statistics of the solutions <code class="reqn">(X_{t},Y_{t})</code> at time <code>at</code>. The default <code>at = T</code>.</p>
</td></tr>    
<tr><td><code id="snssde2d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr>  
<tr><td><code id="snssde2d_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>snssde2d</code> returns a <code>mts</code> x of length <code>N+1</code>; i.e. solution of the 2-dim sde <code class="reqn">(X_{t},Y_{t})</code>
of Ito or Stratonovich types; If <code>Dt</code> is not specified, then the best discretization <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>. 
</p>
<p>The 2-dim Ito stochastic differential equation is: 
</p>
<p style="text-align: center;"><code class="reqn">dX(t) = a(t,X(t),Y(t)) dt + b(t,X(t),Y(t)) dW_{1}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dY(t) = a(t,X(t),Y(t)) dt + b(t,X(t),Y(t)) dW_{2}(t)</code>
</p>

<p>2-dim Stratonovich sde :
</p>
<p style="text-align: center;"><code class="reqn">dX(t) = a(t,X(t),Y(t)) dt + b(t,X(t),Y(t)) \circ dW_{1}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dY(t) = a(t,X(t),Y(t)) dt + b(t,X(t),Y(t)) \circ dW_{2}(t)</code>
</p>

<p><code class="reqn">W_{1}(t), W_{2}(t)</code> are two standard Brownian motion independent if <code>corr=NULL</code>.
</p>
<p>In the correlation case, currently we can use only the Euler-Maruyama and Milstein scheme.
</p>
<p>The methods of approximation are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong 
and the weak (orders of) convergence. The <code>method</code> of simulation can be one among: <code>Euler-Maruyama Order 0.5</code>, <code>Milstein Order 1</code>, <code>Milstein Second-Order</code>, 
<code>Predictor-Corrector method</code>, <code>Itô-Taylor Order 1.5</code>, <code>Heun Order 2</code> and <code>Runge-Kutta Order 1, 2 and 3</code>. 
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>snssde2d</code> returns an object inheriting from <code><a href="base.html#topic+class">class</a></code> <code>"snssde2d"</code>.
</p>
<table role = "presentation">
<tr><td><code>X</code>, <code>Y</code></td>
<td>
<p>an invisible <code>mts</code> (2-dim) object (X(t),Y(t)).</p>
</td></tr>
<tr><td><code>driftx</code>, <code>drifty</code></td>
<td>
<p>drift coefficient of X(t) and Y(t).</p>
</td></tr>
<tr><td><code>diffx</code>, <code>diffy</code></td>
<td>
<p>diffusion coefficient of X(t) and Y(t).</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of sde.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the numerical method used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Guidoum AC, Boukhetala K (2020). 
&quot;Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc&quot;. 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1&ndash;82. doi:10.18637/jss.v096.i02
</p>
<p>Friedman, A. (1975). 
<em>Stochastic differential equations and applications</em>.
Volume 1, ACADEMIC PRESS.
</p>
<p>Henderson, D. and Plaschko,P. (2006). 
<em>Stochastic differential equations in science and engineering</em>.
World Scientific.
</p>
<p>Allen, E. (2007).
<em>Modeling with Ito stochastic differential equations</em>. 
Springer-Verlag.
</p>
<p>Jedrzejewski, F. (2009). 
<em>Modeles aleatoires et physique probabiliste</em>. 
Springer-Verlag.
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York.
</p>
<p>Kloeden, P.E, and Platen, E. (1989). 
A survey of numerical methods for stochastic differential equations. 
<em>Stochastic Hydrology and Hydraulics</em>, <b>3</b>, 155&ndash;178.
</p>
<p>Kloeden, P.E, and Platen, E. (1991a).
Relations between multiple ito and stratonovich integrals.
<em>Stochastic Analysis and Applications</em>, <b>9</b>(3), 311&ndash;321.
</p>
<p>Kloeden, P.E, and Platen, E. (1991b).
Stratonovich and ito stochastic taylor expansions. 
<em>Mathematische Nachrichten</em>, <b>151</b>, 33&ndash;50.
</p>
<p>Kloeden, P.E, and Platen, E. (1995).
<em>Numerical Solution of Stochastic Differential Equations</em>. 
Springer-Verlag, New York.
</p>
<p>Oksendal, B. (2000).
<em>Stochastic Differential Equations: An Introduction with Applications</em>.
5th edn. Springer-Verlag, Berlin.
</p>
<p>Platen, E. (1980).
Weak convergence of approximations of ito integral equations. 
<em>Z Angew Math Mech</em>. <b>60</b>, 609&ndash;614.
</p>
<p>Platen, E. and Bruti-Liberati, N. (2010).
<em>Numerical Solution of Stochastic Differential Equations with Jumps in Finance.</em> 
Springer-Verlag, New York
</p>
<p>Saito, Y, and Mitsui, T. (1993).
Simulation of Stochastic Differential Equations. 
<em>The Annals of the Institute of Statistical Mathematics</em>, <b>3</b>, 419&ndash;432.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+snssde3d">snssde3d</a></code> for 3-dim sde.
</p>
<p><code>simulate</code> in package &quot;yuima&quot;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Ito sde
## dX(t) = 4*(-1-X(t))*Y(t) dt + 0.2 dW1(t)
## dY(t) = 4*(1-Y(t))*X(t) dt + 0.2 dW2(t)
set.seed(1234)

fx &lt;- expression(4*(-1-x)*y , 4*(1-y)*x )
gx &lt;- expression(0.25*y,0.2*x)

mod2d1 &lt;- snssde2d(drift=fx,diffusion=gx,x0=c(x0=1,y0=-1),M=1000)
mod2d1
summary(mod2d1)
##
dev.new()
plot(mod2d1,type="n")
mx &lt;- apply(mod2d1$X,1,mean)
my &lt;- apply(mod2d1$Y,1,mean)
lines(time(mod2d1),mx,col=1)
lines(time(mod2d1),my,col=2)
legend("topright",c(expression(E(X[t])),expression(E(Y[t]))),lty=1,inset = .01,col=c(1,2),cex=0.95)
##
dev.new()
plot2d(mod2d1) ## in plane (O,X,Y)
lines(my~mx,col=2)

## Now W1(t) and W2(t) are correlated.

set.seed(1234)
Sigma &lt;- matrix(c(0.9,0.3,0.3,0.4),nrow=2,ncol=2) # correlation structure
mod2d1 &lt;- snssde2d(drift=fx,diffusion=gx,corr=Sigma,x0=c(x0=1,y0=-1),M=1000)
mod2d1
summary(mod2d1)
##
dev.new()
plot(mod2d1,type="n")
mx &lt;- apply(mod2d1$X,1,mean)
my &lt;- apply(mod2d1$Y,1,mean)
lines(time(mod2d1),mx,col=1)
lines(time(mod2d1),my,col=2)
legend("topright",c(expression(E(X[t])),expression(E(Y[t]))),lty=1,inset = .01,col=c(1,2),cex=0.95)
##
dev.new()
plot2d(mod2d1) ## in plane (O,X,Y)
lines(my~mx,col=2)

## Example 2: Stratonovich sde
## dX(t) = Y(t) dt + 0 o dW1(t)
## dY(t) = (4*(1-X(t)^2)*Y(t) - X(t) ) dt + 0.2 o dW2(t)
set.seed(1234)

fx &lt;- expression( y , (4*( 1-x^2 )* y - x))
gx &lt;- expression( 0 , 0.2)

mod2d2 &lt;- snssde2d(drift=fx,diffusion=gx,type="str",T=100,N=10000)
mod2d2
plot(mod2d2,pos=2)
dev.new()
plot(mod2d2,union = FALSE)
dev.new()
plot2d(mod2d2,type="n") ## in plane (O,X,Y)
points2d(mod2d2,col=rgb(0,100,0,50,maxColorValue=255), pch=16)
</code></pre>

<hr>
<h2 id='snssde3d'>Simulation of 3-D Stochastic Differential Equation</h2><span id='topic+snssde3d'></span><span id='topic+snssde3d.default'></span><span id='topic+summary.snssde3d'></span><span id='topic+print.snssde3d'></span><span id='topic+time.snssde3d'></span><span id='topic+mean.snssde3d'></span><span id='topic+Median.snssde3d'></span><span id='topic+Mode.snssde3d'></span><span id='topic+quantile.snssde3d'></span><span id='topic+kurtosis.snssde3d'></span><span id='topic+skewness.snssde3d'></span><span id='topic+moment.snssde3d'></span><span id='topic+cv.snssde3d'></span><span id='topic+max.snssde3d'></span><span id='topic+min.snssde3d'></span><span id='topic+bconfint.snssde3d'></span><span id='topic+plot.snssde3d'></span><span id='topic+points.snssde3d'></span><span id='topic+lines.snssde3d'></span><span id='topic+plot3D.snssde3d'></span>

<h3>Description</h3>

<p>The (S3) generic function <code>snssde3d</code> of simulation of solutions to 3-dim stochastic differential equations of Itô or Stratonovich type, with different methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>snssde3d(N, ...)
## Default S3 method:
snssde3d(N = 1000, M =1, x0=c(0,0,0), t0 = 0, T = 1, Dt, 
   drift, diffusion, corr = NULL, alpha = 0.5, mu = 0.5, type = c("ito", "str"), 
   method = c("euler", "milstein","predcorr", "smilstein", "taylor", 
   "heun", "rk1", "rk2", "rk3"), ...)	
   
## S3 method for class 'snssde3d'
summary(object, at, digits=NULL,...)
## S3 method for class 'snssde3d'
time(x, ...)
## S3 method for class 'snssde3d'
mean(x, at, ...)
## S3 method for class 'snssde3d'
Median(x, at, ...)
## S3 method for class 'snssde3d'
Mode(x, at, ...)
## S3 method for class 'snssde3d'
quantile(x, at, ...)
## S3 method for class 'snssde3d'
kurtosis(x, at, ...)
## S3 method for class 'snssde3d'
skewness(x, at, ...)
## S3 method for class 'snssde3d'
min(x, at, ...)
## S3 method for class 'snssde3d'
max(x, at, ...)
## S3 method for class 'snssde3d'
moment(x, at, ...)
## S3 method for class 'snssde3d'
cv(x, at, ...)
## S3 method for class 'snssde3d'
bconfint(x, at, ...)

## S3 method for class 'snssde3d'
plot(x, ...)
## S3 method for class 'snssde3d'
lines(x, ...)
## S3 method for class 'snssde3d'
points(x, ...)
## S3 method for class 'snssde3d'
plot3D(x, display = c("persp","rgl"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="snssde3d_+3A_n">N</code></td>
<td>
<p>number of simulation steps.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_m">M</code></td>
<td>
<p>number of trajectories.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_x0">x0</code></td>
<td>
<p>initial value of the process <code class="reqn">X_{t}</code>, <code class="reqn">Y_{t}</code> and <code class="reqn">Z_{t}</code> at time <code>t0</code>.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_t0">t0</code></td>
<td>
<p>initial time.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_t">T</code></td>
<td>
<p>ending time.</p>
</td></tr> 
<tr><td><code id="snssde3d_+3A_dt">Dt</code></td>
<td>
<p>time step of the simulation (discretization). If it is <code><a href="base.html#topic+missing">missing</a></code> a default <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_drift">drift</code></td>
<td>
<p>drift coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of four variables <code>t</code>, <code>x</code>, <code>y</code> and <code>z</code> for process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code>.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_diffusion">diffusion</code></td>
<td>
<p>diffusion coefficient: an <code><a href="base.html#topic+expression">expression</a></code> of four variables <code>t</code>, <code>x</code>, <code>y</code> and <code>z</code> for process <code class="reqn">X_t</code>, <code class="reqn">Y_t</code> and <code class="reqn">Z_t</code>.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_corr">corr</code></td>
<td>
<p>the correlation structure of three Brownian motions W1(t), W2(t) and W3(t); must be a real symmetric positive-definite square matrix of dimension 3.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_alpha">alpha</code>, <code id="snssde3d_+3A_mu">mu</code></td>
<td>
<p>weight of the predictor-corrector scheme; the default <code>alpha = 0.5</code> and <code>mu = 0.5</code>.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_type">type</code></td>
<td>
<p>if <code>type="ito"</code> simulation sde of Itô type, else <code>type="str"</code> simulation sde of Stratonovich type; the default <code>type="ito"</code>.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_method">method</code></td>
<td>
<p>numerical methods of simulation, the default <code>method = "euler"</code>.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_x">x</code>, <code id="snssde3d_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>"snssde3d"</code>.</p>
</td></tr>
<tr><td><code id="snssde3d_+3A_at">at</code></td>
<td>
<p>time between <code>t0</code> and <code>T</code>. Monte-Carlo statistics of the solutions <code class="reqn">(X_{t},Y_{t},Z_{t})</code> at time <code>at</code>. The default <code>at = T</code>.</p>
</td></tr>  
<tr><td><code id="snssde3d_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr>  
<tr><td><code id="snssde3d_+3A_display">display</code></td>
<td>
<p><code>"persp"</code> perspective or <code>"rgl"</code> plots.</p>
</td></tr> 
<tr><td><code id="snssde3d_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>snssde3d</code> returns a <code>mts</code> x of length <code>N+1</code>; i.e. solution of the 3-dim sde <code class="reqn">(X_{t},Y_{t},Z_{t})</code>
of Ito or Stratonovich types; If <code>Dt</code> is not specified, then the best discretization <code class="reqn">\Delta t = \frac{T-t_{0}}{N}</code>. 
</p>
<p>The 3-dim Ito stochastic differential equation is:
</p>
<p style="text-align: center;"><code class="reqn">dX(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) dW_{1}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dY(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) dW_{2}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dZ(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) dW_{3}(t)</code>
</p>

<p>3-dim Stratonovich sde :
</p>
<p style="text-align: center;"><code class="reqn">dX(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) \circ dW_{1}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dY(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) \circ dW_{2}(t)</code>
</p>

<p style="text-align: center;"><code class="reqn">dZ(t) = a(t,X(t),Y(t),Z(t)) dt + b(t,X(t),Y(t),Z(t)) \circ dW_{3}(t)</code>
</p>

<p><code class="reqn">W_{1}(t), W_{2}(t), W_{3}(t)</code> three standard Brownian motion independent if <code>corr=NULL</code>.
</p>
<p>In the correlation case, currently we can use only the Euler-Maruyama and Milstein scheme.
</p>
<p>The methods of approximation are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong 
and the weak (orders of) convergence. The <code>method</code> of simulation can be one among: <code>Euler-Maruyama Order 0.5</code>, <code>Milstein Order 1</code>, <code>Milstein Second-Order</code>, 
<code>Predictor-Corrector method</code>, <code>Itô-Taylor Order 1.5</code>, <code>Heun Order 2</code> and <code>Runge-Kutta Order 1, 2 and 3</code>. 
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>snssde3d</code> returns an object inheriting from <code><a href="base.html#topic+class">class</a></code> <code>"snssde3d"</code>.
</p>
<table role = "presentation">
<tr><td><code>X</code>, <code>Y</code>, <code>Z</code></td>
<td>
<p>an invisible <code>mts</code> (3-dim) object (X(t),Y(t),Z(t)).</p>
</td></tr>
<tr><td><code>driftx</code>, <code>drifty</code>, <code>driftz</code></td>
<td>
<p>drift coefficient of X(t), Y(t) and Z(t).</p>
</td></tr>
<tr><td><code>diffx</code>, <code>diffy</code>, <code>diffz</code></td>
<td>
<p>diffusion coefficient of X(t), Y(t) and Z(t).</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of sde.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the numerical method used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Guidoum AC, Boukhetala K (2020). 
&quot;Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc&quot;. 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1&ndash;82. doi:10.18637/jss.v096.i02
</p>
<p>Friedman, A. (1975). 
<em>Stochastic differential equations and applications</em>.
Volume 1, ACADEMIC PRESS.
</p>
<p>Henderson, D. and Plaschko,P. (2006). 
<em>Stochastic differential equations in science and engineering</em>.
World Scientific.
</p>
<p>Allen, E. (2007).
<em>Modeling with Ito stochastic differential equations</em>. 
Springer-Verlag.
</p>
<p>Jedrzejewski, F. (2009). 
<em>Modeles aleatoires et physique probabiliste</em>. 
Springer-Verlag.
</p>
<p>Iacus, S.M. (2008). 
<em>Simulation and inference for stochastic differential equations: with R examples</em>. 
Springer-Verlag, New York.
</p>
<p>Kloeden, P.E, and Platen, E. (1989). 
A survey of numerical methods for stochastic differential equations. 
<em>Stochastic Hydrology and Hydraulics</em>, <b>3</b>, 155&ndash;178.
</p>
<p>Kloeden, P.E, and Platen, E. (1991a).
Relations between multiple ito and stratonovich integrals.
<em>Stochastic Analysis and Applications</em>, <b>9</b>(3), 311&ndash;321.
</p>
<p>Kloeden, P.E, and Platen, E. (1991b).
Stratonovich and ito stochastic taylor expansions. 
<em>Mathematische Nachrichten</em>, <b>151</b>, 33&ndash;50.
</p>
<p>Kloeden, P.E, and Platen, E. (1995).
<em>Numerical Solution of Stochastic Differential Equations</em>. 
Springer-Verlag, New York.
</p>
<p>Oksendal, B. (2000).
<em>Stochastic Differential Equations: An Introduction with Applications</em>.
5th edn. Springer-Verlag, Berlin.
</p>
<p>Platen, E. (1980).
Weak convergence of approximations of ito integral equations. 
<em>Z Angew Math Mech</em>. <b>60</b>, 609&ndash;614.
</p>
<p>Platen, E. and Bruti-Liberati, N. (2010).
<em>Numerical Solution of Stochastic Differential Equations with Jumps in Finance.</em> 
Springer-Verlag, New York
</p>
<p>Saito, Y, and Mitsui, T. (1993).
Simulation of Stochastic Differential Equations. 
<em>The Annals of the Institute of Statistical Mathematics</em>, <b>3</b>, 419&ndash;432.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+snssde1d">snssde1d</a></code> and <code><a href="#topic+snssde2d">snssde2d</a></code> for 1- and 2-dim sde.
</p>
<p><code>sde.sim</code> in package &quot;sde&quot;. <code>simulate</code> in package &quot;yuima&quot;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Ito sde
## dX(t) = (2*(Y(t)&gt;0)-2*(Z(t)&lt;=0)) dt + 0.2 * dW1(t) 
## dY(t) = -2*Y(t) dt + 0.2 * dW2(t) 
## dZ(t) = -2*Z(t) dt + 0.2 * dW3(t)        
## W1(t), W2(t) and W3(t) three independent Brownian motion
set.seed(1234)

fx &lt;- expression(2*(y&gt;0)-2*(z&lt;=0) , -2*y, -2*z)
gx &lt;- rep(expression(0.2),3)

mod3d1 &lt;- snssde3d(x0=c(0,2,-2),drift=fx,diffusion=gx,M=500,Dt=0.003)
mod3d1
summary(mod3d1)
##
dev.new()
plot(mod3d1,type="n")
mx &lt;- apply(mod3d1$X,1,mean)
my &lt;- apply(mod3d1$Y,1,mean)
mz &lt;- apply(mod3d1$Z,1,mean)
lines(time(mod3d1),mx,col=1)
lines(time(mod3d1),my,col=2)
lines(time(mod3d1),mz,col=3)
legend("topright",c(expression(E(X[t])),expression(E(Y[t])),
 expression(E(Z[t]))),lty=1,inset = .01,col=c(1,2,3),cex=0.95)
##
dev.new()
plot3D(mod3d1,display="persp") ## in space (O,X,Y,Z)

## Example 2: Stratonovich sde 
## dX(t) = Y(t)* dt  + 0.2 o dW3(t)         
## dY(t) = (4*( 1-X(t)^2 )* Y(t) - X(t))* dt + 0.2 o dW2(t)
## dZ(t) = (4*( 1-X(t)^2 )* Z(t) - X(t))* dt + 0.2 o dW3(t)
## W1(t), W2(t) and W3(t) are three correlated Brownian motions with Sigma

fx &lt;- expression( y , (4*( 1-x^2 )* y - x), (4*( 1-x^2 )* z - x))
gx &lt;- expression( 0.2 , 0.2, 0.2)
# correlation matrix
Sigma &lt;-matrix(c(1,0.3,0.5,0.3,1,0.2,0.5,0.2,1),nrow=3,ncol=3) 

mod3d2 &lt;- snssde3d(drift=fx,diffusion=gx,N=10000,T=100,type="str",corr=Sigma)
mod3d2
##
dev.new()
plot(mod3d2,pos=2)
##
dev.new()
plot(mod3d2,union = FALSE)
##
dev.new()
plot3D(mod3d2,display="persp") ## in space (O,X,Y,Z)
</code></pre>

<hr>
<h2 id='st.int'>Stochastic Integrals</h2><span id='topic+st.int'></span><span id='topic+st.int.default'></span><span id='topic+summary.st.int'></span><span id='topic+print.st.int'></span><span id='topic+time.st.int'></span><span id='topic+mean.st.int'></span><span id='topic+Median.st.int'></span><span id='topic+Mode.st.int'></span><span id='topic+quantile.st.int'></span><span id='topic+kurtosis.st.int'></span><span id='topic+skewness.st.int'></span><span id='topic+moment.st.int'></span><span id='topic+cv.st.int'></span><span id='topic+max.st.int'></span><span id='topic+min.st.int'></span><span id='topic+bconfint.st.int'></span><span id='topic+plot.st.int'></span><span id='topic+points.st.int'></span><span id='topic+lines.st.int'></span>

<h3>Description</h3>

<p>The (S3) generic function <code>st.int</code> of simulation of stochastic integrals of Itô or Stratonovich type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st.int(expr, ...)
## Default S3 method:
st.int(expr, lower = 0, upper = 1, M = 1, subdivisions = 1000L, 
               type = c("ito", "str"), ...)

## S3 method for class 'st.int'
summary(object, at ,digits=NULL, ...)
## S3 method for class 'st.int'
time(x, ...)
## S3 method for class 'st.int'
mean(x, at, ...)
## S3 method for class 'st.int'
Median(x, at, ...)
## S3 method for class 'st.int'
Mode(x, at, ...)
## S3 method for class 'st.int'
quantile(x, at, ...)
## S3 method for class 'st.int'
kurtosis(x, at, ...)
## S3 method for class 'st.int'
min(x, at, ...)
## S3 method for class 'st.int'
max(x, at, ...)
## S3 method for class 'st.int'
skewness(x, at, ...)
## S3 method for class 'st.int'
moment(x, at,  ...)
## S3 method for class 'st.int'
cv(x, at,  ...)
## S3 method for class 'st.int'
bconfint(x, at,  ...)

## S3 method for class 'st.int'
plot(x, ...)
## S3 method for class 'st.int'
lines(x, ...)
## S3 method for class 'st.int'
points(x, ...)	
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="st.int_+3A_expr">expr</code></td>
<td>
<p>an <code><a href="base.html#topic+expression">expression</a></code> of two variables <code>t</code> (time) and <code>w</code> (<code>w</code>: standard Brownian motion).</p>
</td></tr>
<tr><td><code id="st.int_+3A_lower">lower</code>, <code id="st.int_+3A_upper">upper</code></td>
<td>
<p>the lower and upper end points of the interval to be integrate.</p>
</td></tr>
<tr><td><code id="st.int_+3A_m">M</code></td>
<td>
<p>number of trajectories (Monte-Carlo).</p>
</td></tr>
<tr><td><code id="st.int_+3A_subdivisions">subdivisions</code></td>
<td>
<p>the maximum number of subintervals.</p>
</td></tr>
<tr><td><code id="st.int_+3A_type">type</code></td>
<td>
<p>Itô or Stratonovich integration.</p>
</td></tr>
<tr><td><code id="st.int_+3A_x">x</code>, <code id="st.int_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>"st.int"</code>.</p>
</td></tr>  
<tr><td><code id="st.int_+3A_at">at</code></td>
<td>
<p>time between <code>lower</code> and <code>upper</code>. Monte-Carlo statistics of stochastic integral at time <code>at</code>. The default <code>at = upper</code>.</p>
</td></tr>   
<tr><td><code id="st.int_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting.</p>
</td></tr>  
<tr><td><code id="st.int_+3A_...">...</code></td>
<td>
<p>potentially further arguments for (non-default) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>st.int</code> returns a <code><a href="stats.html#topic+ts">ts</a></code> x of length <code>N+1</code>; i.e. simulation of stochastic integrals 
of Itô or Stratonovich type.
</p>
<p>The Itô interpretation is:
</p>
<p style="text-align: center;"><code class="reqn">\int_{t_{0}}^{t} f(s) dW_{s} = \lim_{N \rightarrow \infty} \sum_{i=1}^{N} f(t_{i-1})(W_{t_{i}}-W_{t_{i-1}})</code>
</p>

<p>The Stratonovich interpretation is:
</p>
<p style="text-align: center;"><code class="reqn">\int_{t_{0}}^{t} f(s) \circ dW_{s} = \lim_{N \rightarrow \infty} \sum_{i=1}^{N} f\left(\frac{t_{i}+t_{i-1}}{2}\right)(W_{t_{i}}-W_{t_{i-1}})</code>
</p>

<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Value</h3>

<p><code>st.int</code> returns an object inheriting from <code><a href="base.html#topic+class">class</a></code> <code>"st.int"</code>.
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>the final simulation of the integral, an invisible <code><a href="stats.html#topic+ts">ts</a></code> object.</p>
</td></tr>
<tr><td><code>fun</code></td>
<td>
<p>function to be integrated.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of stochastic integral.</p>
</td></tr>
<tr><td><code>subdivisions</code></td>
<td>
<p>the number of subintervals produced in the subdivision process.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.C. Guidoum, K. Boukhetala.
</p>


<h3>References</h3>

<p>Ito, K. (1944). 
Stochastic integral. 
<em>Proc. Jap. Acad, Tokyo</em>, <b>20</b>, 19&ndash;529.
</p>
<p>Stratonovich RL (1966). 
New Representation for Stochastic Integrals and Equations.
<em>SIAM Journal on Control</em>, <b>4(2)</b>, 362&ndash;371.
</p>
<p>Kloeden, P.E, and Platen, E. (1995).
<em>Numerical Solution of Stochastic Differential Equations</em>. 
Springer-Verlag, New York.
</p>
<p>Oksendal, B. (2000).
<em>Stochastic Differential Equations: An Introduction with Applications</em>.
5th edn. Springer-Verlag, Berlin.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+snssde1d">snssde1d</a></code>, <code><a href="#topic+snssde2d">snssde2d</a></code> and <code><a href="#topic+snssde3d">snssde3d</a></code> for 1,2 and 3-dim sde.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Ito integral
## f(t,w(t)) = int(exp(w(t) - 0.5*t) * dw(s)) with t in [0,1]
set.seed(1234)

f &lt;- expression( exp(w-0.5*t) )
mod1 &lt;- st.int(expr=f,type="ito",M=50,lower=0,upper=1)
mod1
summary(mod1)
## Display
plot(mod1)
lines(time(mod1),apply(mod1$X,1,mean),col=2,lwd=2)
lines(time(mod1),apply(mod1$X,1,bconfint,level=0.95)[1,],col=4,lwd=2)
lines(time(mod1),apply(mod1$X,1,bconfint,level=0.95)[2,],col=4,lwd=2)
legend("topleft",c("mean path",paste("bound of", 95," percent confidence")),
       inset = .01,col=c(2,4),lwd=2,cex=0.8)

## Example 2: Stratonovich integral
## f(t,w(t)) = int(w(s)  o dw(s)) with t in [0,1]
set.seed(1234)

g &lt;- expression( w )
mod2 &lt;- st.int(expr=g,type="str",M=50,lower=0,upper=1)
mod2
summary(mod2)
## Display
plot(mod2)
lines(time(mod2),apply(mod2$X,1,mean),col=2,lwd=2)
lines(time(mod2),apply(mod2$X,1,bconfint,level=0.95)[1,],col=4,lwd=2)
lines(time(mod2),apply(mod2$X,1,bconfint,level=0.95)[2,],col=4,lwd=2)
legend("topleft",c("mean path",paste("bound of", 95," percent confidence")),
       inset = .01,col=c(2,4),lwd=2,cex=0.8)

</code></pre>

<hr>
<h2 id='TEX.sde'>
Converting Sim.DiffProc Objects to LaTeX
</h2><span id='topic+TEX.sde'></span><span id='topic+TEX.sde.default'></span>

<h3>Description</h3>

<p>These methods produces the related LaTeX table and mathematic expression for Sim.DiffProc environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TEX.sde(object, ...)

## Default S3 method:
TEX.sde(object, ...)	
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TEX.sde_+3A_object">object</code></td>
<td>

<p>an objects from class <code><a href="#topic+MCM.sde">MCM.sde</a></code> and <code><a href="#topic+MEM.sde">MEM.sde</a></code>. Or an R vector of <code><a href="base.html#topic+expression">expression</a></code> of SDEs, i.e., drift and diffusion coefficients.
</p>
</td></tr>
<tr><td><code id="TEX.sde_+3A_...">...</code></td>
<td>

<p>arguments to be passed to <code><a href="knitr.html#topic+kable">kable</a></code> function if <code>object</code> from class <code><a href="#topic+MCM.sde">MCM.sde</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>New tools for constructing tables and  mathematical expressions with <code>Sim.DiffProc</code> package.
</p>
<p>An overview of this package, see <code><a href="utils.html#topic+browseVignettes">browseVignettes</a>('Sim.DiffProc')</code> for more informations.
</p>


<h3>Author(s)</h3>

<p>A.C. Guidoum
</p>


<h3>References</h3>

<p>Guidoum AC, Boukhetala K (2020). 
&quot;Performing Parallel Monte Carlo and Moment Equations Methods for Itô and Stratonovich Stochastic Differential Systems: R Package Sim.DiffProc&quot;. 
<em>Journal of Statistical Software</em>, <b>96</b>(2), 1&ndash;82. doi:10.18637/jss.v096.i02
</p>
<p>Xie Y (2015). 
Dynamic Documents with R and knitr. 
2nd edition. Chapman and Hall/CRC, Boca Raton, Florida. 
ISBN 978-1498716963, URL <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</p>
<p>Wickham H (2015). 
Advanced R. 
Chapman &amp; Hall/CRC The R Series. CRC Press. ISBN 9781498759809.
</p>


<h3>See Also</h3>

<p><code><a href="knitr.html#topic+kable">kable</a></code> create tables in LaTeX, HTML, Markdown and reStructuredText. 
</p>
<p><code><a href="utils.html#topic+toLatex">toLatex</a></code> converting R Objects to BibTeX or LaTeX.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## LaTeX mathematic for an R expression of SDEs
## Copy and paste the following output in your LaTeX file

# Example 1

f &lt;- expression(-mu1 * x) 
g &lt;- expression(mu2 * sqrt(x)) 
TEX.sde(object = c(drift = f, diffusion = g))

# Example 2

f &lt;- expression(mu1*cos(mu2+z),mu1*sin(mu2+z),0) 
g &lt;- expression(sigma,sigma,alpha) 
TEX.sde(object = c(drift = f, diffusion = g))

## LaTeX mathematic for object of class 'MEM.sde'
## Copy and paste the following output in your LaTeX file

# Example 3

mem.mod3d &lt;- MEM.sde(drift = f, diffusion = g)
TEX.sde(object = mem.mod3d)

## LaTeX table for object of class 'MCM.sde'
## Copy and paste the following output in your LaTeX file

# Example 4

## Not run: 
mu1=0.25; mu2=3; sigma=0.05; alpha=0.03
mod3d &lt;- snssde3d(drift=f,diffusion=g,x0=c(x=0,y=0,z=0),M=100,T=10)

stat.fun3d &lt;- function(data, i){
   d &lt;- data[i,]
   return(c(mean(d$x),mean(d$y),mean(d$z), 
            var(d$x),var(d$y),var(d$z)))
			}
mcm.mod3d = MCM.sde(mod3d,statistic=stat.fun3d,R=10,parallel="snow",ncpus=parallel::detectCores(),
                    names=c("m1","m2","m3","S1","S2","S3"))
					
TEX.sde(object = mcm.mod3d, booktabs = TRUE, align = "r", caption ="\LaTeX~ 
         table for Monte Carlo results generated by \code{TEX.sde()} method.")

## End(Not run)		 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
