<!DOCTYPE html><html lang="en"><head><title>Help for package GGoutlieR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GGoutlieR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anc_coeff_to_GeneticSimilarityMatrix'><p>calculate genetic similarity from ancestry coefficients.</p></a></li>
<li><a href='#get_GGNet_adjacency_matrix'><p>obtain an adjacency matrix to make a network graph</p></a></li>
<li><a href='#ggoutlier'><p>Identify outliers with unusual geo-genetic patterns</p></a></li>
<li><a href='#ggoutlier_compositeKNN'><p>GGoutlieR with the composite approach</p></a></li>
<li><a href='#ggoutlier_example'><p>Example of 'ggoutlier' output</p></a></li>
<li><a href='#ggoutlier_geneticKNN'><p>GGoutlieR with the genetic KNN approach</p></a></li>
<li><a href='#ggoutlier_geoKNN'><p>GGoutlieR with the geographical KNN approach</p></a></li>
<li><a href='#ipk_anc_coef'><p>Ancestry coefficients of IPK barley landraces</p></a></li>
<li><a href='#ipk_geo_coord'><p>Geographical origins of IPK barley landraces</p></a></li>
<li><a href='#plot_ggoutlier'><p>Visualize GGoutlieR results on a geographical map</p></a></li>
<li><a href='#summary_ggoutlier'><p>Summarize GGoutlieR results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Identify Individuals with Unusual Geo-Genetic Patterns</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Identify and visualize individuals with unusual association patterns of genetics and geography using the approach of Chang and Schmid (2023) &lt;<a href="https://doi.org/10.1101%2F2023.04.06.535838">doi:10.1101/2023.04.06.535838</a>&gt;. It detects potential outliers that violate the isolation-by-distance assumption using the K-nearest neighbor approach. You can obtain a table of outliers with statistics and visualize unusual geo-genetic patterns on a geographical map. This is useful for landscape genomics studies to discover individuals with unusual geography and genetics associations from a large biological sample.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats4, FastKNN, foreach, doParallel, parallel, scales,
RColorBrewer, ggforce, rlang, stats, tidyr, utils,
rnaturalearth, sf, ggplot2, cowplot</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rnaturalearthdata</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-15 20:48:51 UTC; user</td>
</tr>
<tr>
<td>Author:</td>
<td>Che-Wei Chang <a href="https://orcid.org/0000-0001-6704-3732"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Karl Schmid <a href="https://orcid.org/0000-0001-5129-895X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Che-Wei Chang &lt;cheweichang92@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-15 21:50:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='anc_coeff_to_GeneticSimilarityMatrix'>calculate genetic similarity from ancestry coefficients.</h2><span id='topic+anc_coeff_to_GeneticSimilarityMatrix'></span>

<h3>Description</h3>

<p>calculate genetic similarity from ancestry coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anc_coeff_to_GeneticSimilarityMatrix(anc_coef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anc_coeff_to_GeneticSimilarityMatrix_+3A_anc_coef">anc_coef</code></td>
<td>
<p>a matrix of ancestry coefficients with samples by rows. Each column corresponds to an ancestral population.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since ancestry coefficients can be interpreted as a propotion of genome derived from a specific ancestral population, this function calculate genetic similarity as the probability of a random genome segment of two individuals derived from the same ancestral population.
</p>

<hr>
<h2 id='get_GGNet_adjacency_matrix'>obtain an adjacency matrix to make a network graph</h2><span id='topic+get_GGNet_adjacency_matrix'></span>

<h3>Description</h3>

<p>'get_GGNet_adjacency_matrix' calculates p-values based on the KNNs and heuristic Gamma distribution obtained in the outlier identification processes. The matrices of p-values are then multiplied with the given genetic similarity matrix to form adjacency matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_GGNet_adjacency_matrix(
  ggoutlier_res,
  geo_coord,
  gen_coord,
  mutual = FALSE,
  adjust_p_value = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_GGNet_adjacency_matrix_+3A_ggoutlier_res">ggoutlier_res</code></td>
<td>
<p>an output from 'ggoutlier'</p>
</td></tr>
<tr><td><code id="get_GGNet_adjacency_matrix_+3A_geo_coord">geo_coord</code></td>
<td>
<p>a two-column matrix or data.frame. the first column is longitude and the second one is latitude.</p>
</td></tr>
<tr><td><code id="get_GGNet_adjacency_matrix_+3A_gen_coord">gen_coord</code></td>
<td>
<p>a matrix of &quot;coordinates in a genetic space&quot;. Users can provide ancestry coefficients or eigenvectors for calculation. If, for example, ancestry coefficients are given, each column corresponds to an ancestral population. Samples are ordered in rows as in 'geo_coord'. Users have to provide 'pgdM' if 'gen_coord' is not given.</p>
</td></tr>
<tr><td><code id="get_GGNet_adjacency_matrix_+3A_mutual">mutual</code></td>
<td>
<p>logic. If a multi-stage test is used in the outlier identification, some samples could not be a mutual neighbor with its K nearest neighbors. In this case, setting 'mutual=TRUE' can force those samples to become mutual neighbors in the output adjacency matrix.</p>
</td></tr>
<tr><td><code id="get_GGNet_adjacency_matrix_+3A_adjust_p_value">adjust_p_value</code></td>
<td>
<p>logic. If 'adjust_p_value=TRUE', p values are adjusted for each nearest neighbor of a given sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list consisting of four matrices that can be used in building network graphs. The default is 'TRUE'
'GeoSP_pvalue' is a matrix describing the strength of edges as p values from the empirical Gamma distribution identified by 'detect_outlier_in_GeoSpace'
'GenSP_pvalue' is a matrix describing the strength of edges as p values from the empirical Gamma distribution identified by 'detect_outlier_in_GeneticSpace'
</p>

<hr>
<h2 id='ggoutlier'>Identify outliers with unusual geo-genetic patterns</h2><span id='topic+ggoutlier'></span>

<h3>Description</h3>

<p>This function is used to identify outliers with unusual geo-genetic patterns using the KNN approach. For the details of the outlier detection approach, please see Chang and Schmid 2023 (doi:https://doi.org/10.1101/2023.04.06.535838)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggoutlier(
  geo_coord,
  gen_coord,
  pgdM = NULL,
  method = c("geneticKNN", "geoKNN", "composite"),
  K = NULL,
  k_geneticKNN = NULL,
  k_geoKNN = NULL,
  klim = c(3, 50),
  make_fig = FALSE,
  plot_dir = ".",
  w_geo = 1,
  w_genetic = 2,
  p_thres = 0.05,
  s = 100,
  min_nn_dist = 100,
  cpu = 1,
  geneticKNN_output = NULL,
  geoKNN_output = NULL,
  verbose = TRUE,
  multi_stages = TRUE,
  maxIter = NULL,
  keep_all_stg_res = FALSE,
  warning_minR2 = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggoutlier_+3A_geo_coord">geo_coord</code></td>
<td>
<p>matrix or data.frame with two columns. The first column is longitude and the second one is latitude.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_gen_coord">gen_coord</code></td>
<td>
<p>matrix. A matrix of &quot;coordinates in a genetic space&quot;. Users can provide ancestry coefficients or eigenvectors for calculation. If, for example, ancestry coefficients are given, each column corresponds to an ancestral population. Samples are ordered in rows as in 'geo_coord'.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_pgdm">pgdM</code></td>
<td>
<p>matrix. A pairwise genetic distance matrix. Users can provide a customized genetic distance matrix with this argument. Samples are ordered in rows and columns as in the rows of 'geo_coord'. The default of 'pgdM' is 'NULL'. If 'pgdM' is not provided, a genetic distance matrix will be calculated from 'gen_coord'.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_method">method</code></td>
<td>
<p>string. The method to run 'GGoutlieR'. It can be '&quot;composite&quot;', '&quot;geneticKNN&quot;', or '&quot;geoKNN&quot;'.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_k">K</code></td>
<td>
<p>integer. Number of the nearest neighbors. If 'K' is not 'NULL', the value will pass to 'k_geneticKNN' and 'k_geoKNN'.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_k_geneticknn">k_geneticKNN</code></td>
<td>
<p>integer. Number of the nearest neighbors in a genetic space. The default is 'NULL'. The 'ggoutlier' will search the optimal K if 'k_geneticKNN = NULL'.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_k_geoknn">k_geoKNN</code></td>
<td>
<p>integer. Number of the nearest neighbors in a geographical space. the default is 'NULL'. The 'ggoutlier' will search the optimal K if 'k_geoKNN = NULL'.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_klim">klim</code></td>
<td>
<p>vector. A range of K to search for the optimal number of nearest neighbors. The default is 'klim = c(3, 50)'</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_make_fig">make_fig</code></td>
<td>
<p>logic. If 'make_fig = TRUE', plots for diagnosing GGoutlieR analysis will be generated and saved to 'plot_dir'. The default is 'FALSE'</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_plot_dir">plot_dir</code></td>
<td>
<p>string. The path to save plots</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_w_geo">w_geo</code></td>
<td>
<p>numeric. A value controlling the power of distance weight in geographical KNN prediction.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_w_genetic">w_genetic</code></td>
<td>
<p>numeric. A value controlling the power of distance weight in genetic KNN prediction.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_p_thres">p_thres</code></td>
<td>
<p>numeric. A significance level</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_s">s</code></td>
<td>
<p>integer. A scalar of geographical distance. The default 's=100' scales the distance to a unit of 0.1 kilometer.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_min_nn_dist">min_nn_dist</code></td>
<td>
<p>numeric. A minimal geographical distance for searching KNNs. Neighbors of a focal sample within this distance will be excluded from the KNN searching procedure.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_cpu">cpu</code></td>
<td>
<p>integer. Number of CPUs to use for searching the optimal K.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_geneticknn_output">geneticKNN_output</code></td>
<td>
<p>output of 'ggoutlier_geneticKNN'. Users can use this argument if running 'ggoutlier_geneticKNN' in advance.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_geoknn_output">geoKNN_output</code></td>
<td>
<p>output of 'ggoutlier_geoKNN'. Users can use this argument if running 'ggoutlier_geoKNN' in advance.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_verbose">verbose</code></td>
<td>
<p>logic. If 'verbose = FALSE', 'ggoutlier' will suppress printout messages.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_multi_stages">multi_stages</code></td>
<td>
<p>logic. A multi-stage test will be performed if is 'TRUE' (the default is 'TRUE').</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_maxiter">maxIter</code></td>
<td>
<p>numeric. Maximal iteration number of multi-stage KNN test.</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_keep_all_stg_res">keep_all_stg_res</code></td>
<td>
<p>logic. Results from all iterations of the multi-stage test will be retained if it is'TRUE'. (the default is 'FALSE')</p>
</td></tr>
<tr><td><code id="ggoutlier_+3A_warning_minr2">warning_minR2</code></td>
<td>
<p>numeric. The prediction accuracy of KNN is evaluated as R^2 to assess the violation of isolation-by-distance expectation. If any R^2 is larger than 'warning_minR2', a warning message will be reported at the end of your analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of 'list'. If you set 'method = &quot;composite&quot;', 'ggoutlier' will return a nested 'list' with two subsidiary 'list' which are '&quot;geneticKNN_result&quot;' and '&quot;geoKNN_result&quot;'. Each subsidiary list includes five items: 'statistics' is a 'data.frame' consisting of the D_geography (&quot;Dgeo&quot;) or D_genetics (&quot;Dg&quot;) values, p values and a column of logic values showing if a sample is an outlier or not. 'threshold' is a 'data.frame' recording the significance threshold. 'gamma_parameter' is a vector recording the parameter of the heuristic Gamma distribution. 'knn_index' and 'knn_name' are a 'data.frame' recording the K nearest neighbors of each sample. The subsidiary list 'geneticKNN_result' has an additional item called '&quot;scalar&quot;', which records the value of geographical distance scalar used in the computation. If you set 'method = &quot;geneticKNN&quot;', or 'method = &quot;geoKNN&quot;', 'ggoutlier' will return a 'list' respectively corresponding to '&quot;geneticKNN_result&quot;' or '&quot;geoKNN_result&quot;'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GGoutlieR)
data("ipk_anc_coef") # get ancestry coefficients
data("ipk_geo_coord") # get geographical coordinates


#DON'T RUN: this analysis will take a few minutes
## Not run: 
ggoutlier_example &lt;-
                 ggoutlier(geo_coord = ipk_geo_coord,
                           gen_coord = ipk_anc_coef,
                           klim = c(3,6),
                           p_thres = 0.01,
                           cpu = 2,
                           method = "composite",
                           verbose = FALSE,
                           min_nn_dist = 1000,
                           multi_stages = FALSE)

head(summary_ggoutlier(ggoutlier_example)) # get a summary table

## End(Not run)
</code></pre>

<hr>
<h2 id='ggoutlier_compositeKNN'>GGoutlieR with the composite approach</h2><span id='topic+ggoutlier_compositeKNN'></span>

<h3>Description</h3>

<p>perform outlier identification with genetic space KNN and geographical space KNN. For the details of the outlier detection approach, please see the supplementary material of Chang and Schmid 2023 (doi:https://doi.org/10.1101/2023.04.06.535838)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggoutlier_compositeKNN(
  geo_coord,
  gen_coord,
  pgdM = NULL,
  k_geneticKNN = NULL,
  k_geoKNN = NULL,
  klim = c(3, 50),
  make_fig = FALSE,
  plot_dir = ".",
  w_geo = 1,
  w_genetic = 2,
  p_thres = 0.05,
  n = 10^6,
  s = 100,
  min_nn_dist = 1000,
  multi_stages = TRUE,
  maxIter = NULL,
  keep_all_stg_res = FALSE,
  warning_minR2 = 0.9,
  cpu = 1,
  geneticKNN_output = NULL,
  geoKNN_output = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggoutlier_compositeKNN_+3A_geo_coord">geo_coord</code></td>
<td>
<p>matrix or data.frame with two columns. The first column is longitude and the second one is latitude.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_gen_coord">gen_coord</code></td>
<td>
<p>matrix. A matrix of &quot;coordinates in a genetic space&quot;. Users can provide ancestry coefficients or eigenvectors for calculation. If, for example, ancestry coefficients are given, each column corresponds to an ancestral population. Samples are ordered in rows as in 'geo_coord'.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_pgdm">pgdM</code></td>
<td>
<p>matrix. A pairwise genetic distance matrix. Users can provide a customized genetic distance matrix with this argument. Samples are ordered in rows and columns as in the rows of 'geo_coord'. The default of 'pgdM' is 'NULL'. If 'pgdM' is not provided, a genetic distance matrix will be calculated from 'gen_coord'. NOTE: the genetic distance matrix is used in the search of KNN and as weights of KNN regression.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_k_geneticknn">k_geneticKNN</code></td>
<td>
<p>integer. Number of the nearest neighbors in a genetic space. The default is 'NULL'. The 'ggoutlier' will search the optimal K if 'k_geneticKNN = NULL'.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_k_geoknn">k_geoKNN</code></td>
<td>
<p>integer. Number of the nearest neighbors in a geographical space. the default is 'NULL'. The 'ggoutlier' will search the optimal K if 'k_geoKNN = NULL'.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_klim">klim</code></td>
<td>
<p>vector. A range of K to search for the optimal number of nearest neighbors. The default is 'klim = c(3, 50)'</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_make_fig">make_fig</code></td>
<td>
<p>logic. If 'make_fig = TRUE', plots for diagnosing GGoutlieR analysis will be generated and saved to 'plot_dir'. The default is 'FALSE'</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_plot_dir">plot_dir</code></td>
<td>
<p>string. The path to save plots</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_w_geo">w_geo</code></td>
<td>
<p>numeric. A value controlling the power of distance weight in geographical KNN prediction.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_w_genetic">w_genetic</code></td>
<td>
<p>numeric. A value controlling the power of distance weight in genetic KNN prediction.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_p_thres">p_thres</code></td>
<td>
<p>numeric. A significance level</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_n">n</code></td>
<td>
<p>numeric. A number of random samples to draw from the null distribution for making a graph.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_s">s</code></td>
<td>
<p>integer. A scalar of geographical distance. The default 's=100' scales the distance to a unit of 0.1 kilometer.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_min_nn_dist">min_nn_dist</code></td>
<td>
<p>numeric. A minimal geographical distance for searching KNNs. Neighbors of a focal sample within this distance will be excluded from the KNN searching procedure.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_multi_stages">multi_stages</code></td>
<td>
<p>logic. A multi-stage test will be performed if is 'TRUE' (the default is 'TRUE').</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_maxiter">maxIter</code></td>
<td>
<p>numeric. Maximal iteration number of multi-stage KNN test.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_keep_all_stg_res">keep_all_stg_res</code></td>
<td>
<p>logic. Results from all iterations of the multi-stage test will be retained if it is'TRUE'. (the default is 'FALSE')</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_warning_minr2">warning_minR2</code></td>
<td>
<p>numeric. The prediction accuracy of KNN is evaluated as R^2 to assess the violation of isolation-by-distance expectation. If any R^2 is larger than 'warning_minR2', a warning message will be reported at the end of your analysis.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_cpu">cpu</code></td>
<td>
<p>integer. Number of CPUs to use for searching the optimal K.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_geneticknn_output">geneticKNN_output</code></td>
<td>
<p>output of 'ggoutlier_geneticKNN'. Users can use this argument if running 'ggoutlier_geneticKNN' in advance.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_geoknn_output">geoKNN_output</code></td>
<td>
<p>output of 'ggoutlier_geoKNN'. Users can use this argument if running 'ggoutlier_geoKNN' in advance.</p>
</td></tr>
<tr><td><code id="ggoutlier_compositeKNN_+3A_verbose">verbose</code></td>
<td>
<p>logic. If 'verbose = FALSE', 'ggoutlier' will suppress printout messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of nested 'list' with two subsidiary 'list' which are '&quot;geneticKNN_result&quot;' and '&quot;geoKNN_result&quot;'. Each subsidiary list includes five items: 'statistics' is a 'data.frame' consisting of the D_geography (&quot;Dgeo&quot;) or D_genetics (&quot;Dg&quot;) values, p values and a column of logic values showing if a sample is an outlier or not. 'threshold' is a 'data.frame' recording the significance threshold. 'gamma_parameter' is a vector recording the parameter of the heuristic Gamma distribution. 'knn_index' and 'knn_name' are a 'data.frame' recording the K nearest neighbors of each sample. The subsidiary list 'geneticKNN_result' has an additional item called '&quot;scalar&quot;', which records the value of geographical distance scalar used in the computation.
</p>

<hr>
<h2 id='ggoutlier_example'>Example of 'ggoutlier' output</h2><span id='topic+ggoutlier_example'></span>

<h3>Description</h3>

<p>Example of 'ggoutlier' output
</p>


<h3>Format</h3>

<p>list
</p>

<hr>
<h2 id='ggoutlier_geneticKNN'>GGoutlieR with the genetic KNN approach</h2><span id='topic+ggoutlier_geneticKNN'></span>

<h3>Description</h3>

<p>identify samples geographically remote from K genetically nearest neighbors (genetic KNN). For the details of the outlier detection approach, please see the supplementary material of Chang and Schmid 2023 (doi:https://doi.org/10.1101/2023.04.06.535838)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggoutlier_geneticKNN(
  geo_coord,
  gen_coord = NULL,
  pgdM = NULL,
  k = NULL,
  klim = c(3, 50),
  make_fig = FALSE,
  plot_dir = ".",
  w_power = 2,
  p_thres = 0.05,
  n = 10^6,
  s = 100,
  multi_stages = TRUE,
  maxIter = NULL,
  keep_all_stg_res = FALSE,
  warning_minR2 = 0.9,
  cpu = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggoutlier_geneticKNN_+3A_geo_coord">geo_coord</code></td>
<td>
<p>matrix or data.frame with two columns. The first column is longitude and the second one is latitude.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_gen_coord">gen_coord</code></td>
<td>
<p>matrix. A matrix of &quot;coordinates in a genetic space&quot;. Users can provide ancestry coefficients or eigenvectors for calculation. If, for example, ancestry coefficients are given, each column corresponds to an ancestral population. Samples are ordered in rows as in 'geo_coord'.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_pgdm">pgdM</code></td>
<td>
<p>matrix. A pairwise genetic distance matrix. Users can provide a customized genetic distance matrix with this argument. Samples are ordered in rows and columns as in the rows of 'geo_coord'. The default of 'pgdM' is 'NULL'. If 'pgdM' is not provided, a genetic distance matrix will be calculated from 'gen_coord'.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_k">k</code></td>
<td>
<p>integer. Number of the nearest neighbors.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_klim">klim</code></td>
<td>
<p>vector. A range of K to search for the optimal number of nearest neighbors. The default is 'klim = c(3, 50)'</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_make_fig">make_fig</code></td>
<td>
<p>logic. If 'make_fig = TRUE', plots for diagnosing GGoutlieR analysis will be generated and saved to 'plot_dir'. The default is 'FALSE'</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_plot_dir">plot_dir</code></td>
<td>
<p>string. The path to save plots</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_w_power">w_power</code></td>
<td>
<p>numanceric. A value controlling the power of distance weight in genetic KNN prediction.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_p_thres">p_thres</code></td>
<td>
<p>numeric. A significe level</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_n">n</code></td>
<td>
<p>numeric. A number of random samples to draw from the null distribution for making a graph.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_s">s</code></td>
<td>
<p>integer. A scalar of geographical distance. The default 's=100' scales the distance to a unit of 0.1 kilometer.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_multi_stages">multi_stages</code></td>
<td>
<p>logic. A multi-stage test will be performed if is 'TRUE' (the default is 'TRUE').</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_maxiter">maxIter</code></td>
<td>
<p>numeric. Maximal iteration number of multi-stage KNN test.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_keep_all_stg_res">keep_all_stg_res</code></td>
<td>
<p>logic. Results from all iterations of the multi-stage test will be retained if it is'TRUE'. (the default is 'FALSE')</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_warning_minr2">warning_minR2</code></td>
<td>
<p>numeric. The prediction accuracy of KNN is evaluated as R^2 to assess the violation of isolation-by-distance expectation. If any R^2 is larger than 'warning_minR2', a warning message will be reported at the end of your analysis.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_cpu">cpu</code></td>
<td>
<p>integer. Number of CPUs to use for searching the optimal K.</p>
</td></tr>
<tr><td><code id="ggoutlier_geneticKNN_+3A_verbose">verbose</code></td>
<td>
<p>logic. If 'verbose = FALSE', 'ggoutlier' will suppress printout messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of 'list' including six items. 'statistics' is a 'data.frame' consisting of the 'D geography' &quot;Dgeo&quot; values, p values and a column of logic values showing if a sample is an outlier or not. 'threshold' is a 'data.frame' recording the significance threshold. 'gamma_parameter' is a vector recording the parameter of the heuristic Gamma distribution. 'knn_index' and 'knn_name' are a 'data.frame' recording the K nearest neighbors of each sample. 'scalar' is the value of geographical distance scalar used in the computation.
</p>

<hr>
<h2 id='ggoutlier_geoKNN'>GGoutlieR with the geographical KNN approach</h2><span id='topic+ggoutlier_geoKNN'></span>

<h3>Description</h3>

<p>identify samples genetically different from K nearest geographical neighbors (geographical KNN). For the details of the outlier detection approach, please see the supplementary material of Chang and Schmid 2023 (doi:https://doi.org/10.1101/2023.04.06.535838)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggoutlier_geoKNN(
  geo_coord,
  gen_coord,
  min_nn_dist = 100,
  k = NULL,
  klim = c(3, 50),
  s = 100,
  make_fig = FALSE,
  plot_dir = ".",
  w_power = 1,
  p_thres = 0.05,
  n = 10^6,
  multi_stages = TRUE,
  maxIter = NULL,
  keep_all_stg_res = FALSE,
  warning_minR2 = 0.9,
  cpu = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggoutlier_geoKNN_+3A_geo_coord">geo_coord</code></td>
<td>
<p>matrix or data.frame with two columns. The first column is longitude and the second one is latitude.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_gen_coord">gen_coord</code></td>
<td>
<p>matrix. A matrix of &quot;coordinates in a genetic space&quot;. Users can provide ancestry coefficients or eigenvectors for calculation. If, for example, ancestry coefficients are given, each column corresponds to an ancestral population. Samples are ordered in rows as in 'geo_coord'.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_min_nn_dist">min_nn_dist</code></td>
<td>
<p>numeric. A minimal geographical distance for searching KNNs. Neighbors of a focal sample within this distance will be excluded from the KNN searching procedure.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_k">k</code></td>
<td>
<p>integer. Number of the nearest neighbors.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_klim">klim</code></td>
<td>
<p>vector. A range of K to search for the optimal number of nearest neighbors. The default is 'klim = c(3, 50)'</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_s">s</code></td>
<td>
<p>integer. A scalar of geographical distance. The default 's=100' scales the distance to a unit of 0.1 kilometer.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_make_fig">make_fig</code></td>
<td>
<p>logic. If 'make_fig = TRUE', plots for diagnosing GGoutlieR analysis will be generated and saved to 'plot_dir'. The default is 'FALSE'</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_plot_dir">plot_dir</code></td>
<td>
<p>string. The path to save plots</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_w_power">w_power</code></td>
<td>
<p>numeric. A value controlling the power of distance weight in geographical KNN prediction.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_p_thres">p_thres</code></td>
<td>
<p>numeric. A significance level</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_n">n</code></td>
<td>
<p>numeric. A number of random samples to draw from the null distribution for making a graph.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_multi_stages">multi_stages</code></td>
<td>
<p>logic. A multi-stage test will be performed if is 'TRUE' (the default is 'TRUE').</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_maxiter">maxIter</code></td>
<td>
<p>numeric. Maximal iteration number of multi-stage KNN test.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_keep_all_stg_res">keep_all_stg_res</code></td>
<td>
<p>logic. Results from all iterations of the multi-stage test will be retained if it is'TRUE'. (the default is 'FALSE')</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_warning_minr2">warning_minR2</code></td>
<td>
<p>numeric. The prediction accuracy of KNN is evaluated as R^2 to assess the violation of isolation-by-distance expectation. If any R^2 is larger than 'warning_minR2', a warning message will be reported at the end of your analysis.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_cpu">cpu</code></td>
<td>
<p>integer. Number of CPUs to use for searching the optimal K.</p>
</td></tr>
<tr><td><code id="ggoutlier_geoKNN_+3A_verbose">verbose</code></td>
<td>
<p>logic. If 'verbose = FALSE', 'ggoutlier' will suppress printout messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of 'list' including five items. 'statistics' is a 'data.frame' consisting of the 'D genetics' (&quot;Dg&quot;) values, p values and a column of logic values showing if a sample is an outlier or not. 'threshold' is a 'data.frame' recording the significance threshold. 'gamma_parameter' is a vector recording the parameter of the heuristic Gamma distribution. 'knn_index' and 'knn_name' are a 'data.frame' recording the K nearest neighbors of each sample.
</p>

<hr>
<h2 id='ipk_anc_coef'>Ancestry coefficients of IPK barley landraces</h2><span id='topic+ipk_anc_coef'></span>

<h3>Description</h3>

<p>Ancestry coefficients of IPK barley landraces
</p>


<h3>Format</h3>

<p>matrix
</p>

<hr>
<h2 id='ipk_geo_coord'>Geographical origins of IPK barley landraces</h2><span id='topic+ipk_geo_coord'></span>

<h3>Description</h3>

<p>Geographical origins of IPK barley landraces
</p>


<h3>Format</h3>

<p>data.frame
</p>

<hr>
<h2 id='plot_ggoutlier'>Visualize GGoutlieR results on a geographical map</h2><span id='topic+plot_ggoutlier'></span>

<h3>Description</h3>

<p>Visualize geo-genetic patterns of outliers with their K nearest neighbors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ggoutlier(
  ggoutlier_res,
  geo_coord,
  anc_coef = NULL,
  gen_coord = NULL,
  pie_color = NULL,
  map_color = "black",
  p_thres = NULL,
  color_res = 10,
  dot_cex = NULL,
  map_type = c("geographic_knn", "genetic_knn", "both"),
  select_xlim = c(-180, 180),
  select_ylim = c(-90, 90),
  plot_xlim = NULL,
  plot_ylim = NULL,
  only_edges_in_xylim = TRUE,
  pie_r_scale = 1,
  map_resolution = "medium",
  show_knn_pie = FALSE,
  which_sample = NULL,
  add_benchmark_graph = TRUE,
  adjust_p_value_projection = FALSE,
  linewidth_range = c(0.5, 3),
  plot_labels = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ggoutlier_+3A_ggoutlier_res">ggoutlier_res</code></td>
<td>
<p>output of 'ggoutlier'</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_geo_coord">geo_coord</code></td>
<td>
<p>matrix or data.frame with two columns. The first column is longitude and the second one is latitude.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_anc_coef">anc_coef</code></td>
<td>
<p>matrix. A matrix of ancestry coefficients with samples ordered by rows. Ancestry coefficients are used to make pie charts on a geographical map. This argument is optional.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_gen_coord">gen_coord</code></td>
<td>
<p>matrix. A matrix of &quot;coordinates in a genetic space&quot;. It should be identical to the 'gen_coord' used for running 'ggoutlier'</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_pie_color">pie_color</code></td>
<td>
<p>string. Colors of pie charts. colors are automatically assigned if 'pie_color = NULL' (which is the default). This argument is optional.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_map_color">map_color</code></td>
<td>
<p>string. Colors of map contours. The default is 'map_color = &quot;black&quot;'</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_p_thres">p_thres</code></td>
<td>
<p>numeric. A value of significant level. Only outliers (p values less than 'p_thres') are mapped on a geographical map if 'p_thres' is provided (the default is 'NULL'). This argument is optional.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_color_res">color_res</code></td>
<td>
<p>integer. The resolution of color scale.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_dot_cex">dot_cex</code></td>
<td>
<p>numeric. The size of dots denoting the positions of samples on a geographical map.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_map_type">map_type</code></td>
<td>
<p>string. The type of plot to draw. It can be '&quot;geographic_knn&quot;', '&quot;genetic_knn&quot;' and '&quot;both&quot;'.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_select_xlim">select_xlim</code></td>
<td>
<p>vector. Values controlling longitude boundaries of a window to select outliers to present on a geographical map. The default is 'select_xlim = c(-180,180)'.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_select_ylim">select_ylim</code></td>
<td>
<p>vector. Values controlling latitude boundaries of a window to select outliers to present on a geographical map. The default is 'select_ylim = c(-90,90)'.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_plot_xlim">plot_xlim</code></td>
<td>
<p>vector. Values controlling longitude boundaries of a map.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_plot_ylim">plot_ylim</code></td>
<td>
<p>vector. Values controlling latitude boundaries of a map.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_only_edges_in_xylim">only_edges_in_xylim</code></td>
<td>
<p>logic. only the edges with starting points within the given 'select_xlim' and 'select_ylim' will display on a geographical map. If 'FALSE', the edges out of the given boundaries will be removed from your plot. The default is 'TRUE'.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_pie_r_scale">pie_r_scale</code></td>
<td>
<p>numeric. A scale controlling the radius of pie charts</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_map_resolution">map_resolution</code></td>
<td>
<p>a character string. The resolution of the geographical map. See details of the 'scale' argument in the manual of 'rnaturalearth::ne_countries()'. The default is 'map_resolution = &quot;medium&quot;'</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_show_knn_pie">show_knn_pie</code></td>
<td>
<p>logic. If 'TRUE', the ancestry coefficients of K nearest neighbors of significant samples will display on the map. The default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_which_sample">which_sample</code></td>
<td>
<p>a string vector of sample ID(s). If users want to only show specific sample(s)</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_add_benchmark_graph">add_benchmark_graph</code></td>
<td>
<p>logic. If 'TRUE', a benchmark graph with only pie charts of ancestry coefficients for comparison with the outlier graph.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_adjust_p_value_projection">adjust_p_value_projection</code></td>
<td>
<p>logic. If 'TRUE', the function will perform KNN prediction by forcing K=1 and compute new p-values for visualization.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_linewidth_range">linewidth_range</code></td>
<td>
<p>numeric. A vector of two values. It is used to control the minimal and maximal width of KNN network on the geographical map.</p>
</td></tr>
<tr><td><code id="plot_ggoutlier_+3A_plot_labels">plot_labels</code></td>
<td>
<p>character. A string of labels for plots. The default is 'plot_labels = &quot;auto&quot;'. This parameter is for 'cowplot::plot_grid'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Red links on the map denote individual pairs that are genetically similar but geographically remote.
The color depth and thickness of red links are proportional to -log10(p) based on the empirical Gamma distribution obtained from 'detect_outlier_in_GeneticSpace'.
Blue links on the map denote individual pairs that are genetically different but geographically close.
The color depth and thickness of blue links are proportional to -log10(p) based on the empirical Gamma distribution obtained from 'detect_outlier_in_GeoSpace'
</p>


<h3>Value</h3>

<p>ggplot object. The plot is geographical map(s) with colored lines showing sample pairs with unusual geo-genetic associations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GGoutlieR)
data("ipk_anc_coef") # get ancestry coefficients
data("ipk_geo_coord") # get geographical coordinates
data(ggoutlier_example) # get an example output of ggoutlier
## Not run: 
plot_ggoutlier(ggoutlier_res = ggoutlier_example,
               gen_coord = ipk_anc_coef,
               geo_coord = ipk_geo_coord,
               p_thres = 0.025,
               map_type = "both",
               select_xlim = c(-20,140),
               select_ylim = c(10,62),
               plot_xlim = c(-20,140),
               plot_ylim = c(10,62),
               pie_r_scale = 1.8,
               map_resolution = "medium")
               
## End(Not run)

</code></pre>

<hr>
<h2 id='summary_ggoutlier'>Summarize GGoutlieR results</h2><span id='topic+summary_ggoutlier'></span>

<h3>Description</h3>

<p>Get a summary table from the 'ggoutlier' output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_ggoutlier(ggoutlier_res)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_ggoutlier_+3A_ggoutlier_res">ggoutlier_res</code></td>
<td>
<p>output from the function 'ggoutlier'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a table contains IDs of outliers and p-values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(GGoutlieR)
data(ggoutlier_example) # get an example output of ggoutlier
head(summary_ggoutlier(ggoutlier_example))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
