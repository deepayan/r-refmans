<!DOCTYPE html><html><head><title>Help for package npde</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {npde}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#npde-package'><p>Normalised prediction distribution errors for nonlinear mixed-effect models</p></a></li>
<li><a href='#+5B+2CNpdeSimData-method'><p>Get/set methods for NpdeData object</p></a></li>
<li><a href='#autonpde'><p>Compute normalised prediction distribution errors</p></a></li>
<li><a href='#compute.ploq'><p>Compute P(y_ij&lt;LOQ) for all observations</p></a></li>
<li><a href='#computenpde'><p>Internal functions used to compute normalised prediction distribution errors (npde)</p></a></li>
<li><a href='#computepd'><p>Internal functions used to compute prediction discrepancies</p></a></li>
<li><a href='#default.npde.plots'><p>Default plots for a NpdeObject object</p></a></li>
<li><a href='#dist.pred.sim'><p>Compute distribution of pd/npde using simulations</p></a></li>
<li><a href='#gof.test'><p>Goodness-of-fit tests for npde</p></a></li>
<li><a href='#kurtosis'><p>Kurtosis</p></a></li>
<li><a href='#npde.binning'><p>Internal functions used to produce prediction intervals</p></a></li>
<li><a href='#npde.cens.method'><p>Method used to handle censored data</p></a></li>
<li><a href='#npde.decorr.method'><p>Decorrelation methods in npde</p></a></li>
<li><a href='#npde.graphs'><p>Save the graphs for a NpdeObject object to a file</p></a></li>
<li><a href='#npde.main'><p>Main npde function</p></a></li>
<li><a href='#npde.plot.covariate'><p>Covariate diagnostic plots</p></a></li>
<li><a href='#npde.plot.data'><p>Plot a NpdeData object</p></a></li>
<li><a href='#npde.plot.default'><p>Diagnostic plots</p></a></li>
<li><a href='#npde.plot.dist'><p>Distribution plots of pd/npde</p></a></li>
<li><a href='#npde.plot.loq'><p>Plot of the probability that the observations are below the LOQ</p></a></li>
<li><a href='#npde.plot.npde'><p>Plots for pd and npde</p></a></li>
<li><a href='#npde.plot.scatterplot'><p>Scatterplots and VPC</p></a></li>
<li><a href='#npde.plot.select'><p>Select plot for a NpdeObject object</p></a></li>
<li><a href='#npde.plot.splitcov'><p>Plots split by covariate for a NpdeObject object</p></a></li>
<li><a href='#npde.save'><p>Save the results contained in a NpdeObject object to a file</p></a></li>
<li><a href='#npdeControl'><p>Set options for an NpdeObject</p></a></li>
<li><a href='#npdeData'><p>Creates a NpdeData object</p></a></li>
<li><a href='#NpdeData-class'><p>Class &quot;NpdeData&quot; representing the structure of the longitudinal data</p></a></li>
<li><a href='#NpdeObject-class'><p>Class &quot;NpdeObject&quot;</p></a></li>
<li><a href='#NpdeRes-class'><p>Class &quot;NpdeRes&quot;</p></a></li>
<li><a href='#npdeSimData'><p>Creates a NpdeSimData object</p></a></li>
<li><a href='#NpdeSimData-class'><p>Class &quot;NpdeSimData&quot; representing the structure of the longitudinal data</p></a></li>
<li><a href='#pdemenu'><p>Interactive menu to set the options for the npde() function</p></a></li>
<li><a href='#plot.NpdeData'><p>Plots a NpdeData object</p></a></li>
<li><a href='#plot.NpdeObject'><p>Plots a NpdeObject object</p></a></li>
<li><a href='#plot.NpdeRes'><p>Plots a NpdeRes object</p></a></li>
<li><a href='#print.NpdeData'><p>Prints objects from the npde package</p></a></li>
<li><a href='#read'><p>Read data into structures (internal)</p></a></li>
<li><a href='#replace.plotoptions'><p>Replace graphical options</p></a></li>
<li><a href='#set.plotoptions'><p>Set graphical preferences</p></a></li>
<li><a href='#show'><p>Displays npde objects</p></a></li>
<li><a href='#showall'><p>Contents of an object</p></a></li>
<li><a href='#simtheopp'><p>Simulated data for the computation of normalised prediction distribution</p>
errors in the theophylline dataset</a></li>
<li><a href='#skewness'><p>Skewness</p></a></li>
<li><a href='#subset.NpdeData'><p>Subsetting a NpdeData object</p></a></li>
<li><a href='#summary.NpdeData'><p>Summary of a NpdeData object</p></a></li>
<li><a href='#theopp'><p>Pharmacokinetics of theophylline</p></a></li>
<li><a href='#virload'><p>Simulated HIV viral loads in HIV patients</p></a></li>
<li><a href='#warfarin'><p>Pharmacokinetics of warfarin</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Normalised Prediction Distribution Errors for Nonlinear
Mixed-Effect Models</td>
</tr>
<tr>
<td>Version:</td>
<td>3.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-06</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emmanuelle Comets &lt;emmanuelle.comets@inserm.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides routines to compute normalised prediction distribution errors, a metric designed to evaluate non-linear mixed effect models such as those used in pharmacokinetics and pharmacodynamics.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, scales, ggplot2, mclust, grid, gridExtra, rlang</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Collate:</td>
<td>'NpdeSimData.R' 'NpdeData.R' 'aaa_generics.R'
'NpdeData-methods.R' 'NpdeRes.R' 'NpdeRes-methods.R'
'NpdeObject.R' 'NpdeObject-methods.R' 'compute_distribution.R'
'compute_npde.R' 'compute_pd.R' 'compute_ploq.R' 'mainNpde.R'
'npde.R' 'npdeControl.R' 'plotNpde-auxDistPlot.R'
'plotNpde-auxScatter.R' 'plotNpde-auxScatterPlot.R'
'plotNpde-binningPI.R' 'plotNpde-covplot.R'
'plotNpde-distributionPlot.R' 'plotNpde-methods.R'
'plotNpde-plotFunctions.R' 'plotNpde-scatterplot.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-07 08:27:15 UTC; eco</td>
</tr>
<tr>
<td>Author:</td>
<td>Emmanuelle Comets <a href="https://orcid.org/0000-0002-9150-9886"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Karl Brendel [ctb],
  Thi Huyen Tram Nguyen [ctb],
  Marc Cerou [ctb],
  Romain Leroux [ctb],
  France Mentre [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-07 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='npde-package'>Normalised prediction distribution errors for nonlinear mixed-effect models</h2><span id='topic+npde-package'></span>

<h3>Description</h3>

<p>Routines to compute normalised prediction distribution errors, a metric
designed to evaluate non-linear mixed effect models such as those used in
pharmacokinetics and pharmacodynamics
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets, Karl Brendel, Thi Huyen Tram Nguyen, France Mentre
</p>
<p>Maintainer: Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>
<p>PDF documentation for npde 3.0: <a href="https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf">https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(theopp)
data(simtheopp)

# Calling autonpde with dataframes

x&lt;-autonpde(theopp,simtheopp,ix="Time",iy="Conc",iid="ID",boolsave=FALSE)
print(x)

</code></pre>

<hr>
<h2 id='+5B+2CNpdeSimData-method'>Get/set methods for NpdeData object</h2><span id='topic++5B+2CNpdeSimData-method'></span><span id='topic++5B+3C-+2CNpdeSimData-method'></span><span id='topic++5B+2CNpdeSimData'></span><span id='topic++5B+3C-+2CNpdeSimData'></span><span id='topic++5B'></span><span id='topic++5B+2CNpdeData-method'></span><span id='topic++5B+3C-+2CNpdeData-method'></span><span id='topic++5B+2CNpdeRes-method'></span><span id='topic++5B+3C-+2CNpdeRes-method'></span><span id='topic++5B+2CNpdeObject-method'></span><span id='topic++5B+3C-+2CNpdeObject-method'></span>

<h3>Description</h3>

<p>Access slots of a NpdeData using the object[&quot;slot&quot;] format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'NpdeSimData'
x[i, j, drop]

## S4 method for signature 'NpdeData'
x[i, j, drop]

## S4 replacement method for signature 'NpdeData'
x[i, j] &lt;- value

## S4 method for signature 'NpdeRes'
x[i, j, drop]

## S4 method for signature 'NpdeObject'
x[i, j, drop]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B+2B2CNpdeSimData-method_+3A_x">x</code></td>
<td>
<p>object from which to extract element(s) or in which to replace element(s)</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CNpdeSimData-method_+3A_i">i</code>, <code id="+2B5B+2B2CNpdeSimData-method_+3A_j">j</code></td>
<td>
<p>indices specifying elements to extract or replace. Indices are numeric or character vectors or empty (missing) or NULL</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CNpdeSimData-method_+3A_drop">drop</code></td>
<td>
<p>For matrices and arrays. If TRUE the result is coerced to the lowest possible dimension (see the examples). This only works for extracting elements, not for the replacement. See drop for further details</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CNpdeSimData-method_+3A_value">value</code></td>
<td>
<p>typically an array-like R object of a similar class as x</p>
</td></tr>
</table>

<hr>
<h2 id='autonpde'>Compute normalised prediction distribution errors</h2><span id='topic+autonpde'></span><span id='topic+npde'></span>

<h3>Description</h3>

<p>These functions compute normalised prediction distribution errors (npde) and
prediction discrepancies (pd). <code>npde</code> asks the user the name
and structure of the files containing the data, using <code>pdemenu</code>, while
<code>autonpde</code> takes these variables and others as arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autonpde(namobs, namsim, iid, ix, iy, imdv = 0, icens = 0,
icov = 0, iipred = 0, boolsave = TRUE, namsav = "output", type.graph = "eps",
verbose = FALSE, calc.npde=TRUE, calc.npd=TRUE, decorr.method = "cholesky",
 cens.method = "cdf", units = list(x="",y=""), detect=FALSE, ties=TRUE, header=TRUE)

npde()

npde()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autonpde_+3A_namobs">namobs</code></td>
<td>
<p>name of the file containing the observed data, or a dataframe
containing the observed data (in both cases, the column containing the
various data required for the computation of the pde can be set using the
arguments <code>iid</code>,<code>ix</code> and <code>iy</code> below)</p>
</td></tr>
<tr><td><code id="autonpde_+3A_namsim">namsim</code></td>
<td>
<p>name of the file containing the simulated data, or a dataframe
containing the simulated data (the program will assume that subject ID are
in column 1 and simulated Y in column 3, see User Guide)</p>
</td></tr>
<tr><td><code id="autonpde_+3A_iid">iid</code></td>
<td>
<p>name/number of the column in the observed data containing the patient
ID; if missing, the program will attempt to detect a column named id</p>
</td></tr>
<tr><td><code id="autonpde_+3A_ix">ix</code></td>
<td>
<p>name/number of the column in the observed data containing the
independent variable (X); ; if missing, the program will attempt to detect a column named X</p>
</td></tr>
<tr><td><code id="autonpde_+3A_iy">iy</code></td>
<td>
<p>name/number of the column in the observed data containing the dependent
variable (Y); if missing, the program will attempt to detect a column with the response</p>
</td></tr>
<tr><td><code id="autonpde_+3A_imdv">imdv</code></td>
<td>
<p>name/number of the column containing information about missing data
(MDV), defaults to 0 (column not present)</p>
</td></tr>
<tr><td><code id="autonpde_+3A_icens">icens</code></td>
<td>
<p>name/number of the column containing information about censored data
(cens), defaults to 0 (column not present)</p>
</td></tr>
<tr><td><code id="autonpde_+3A_icov">icov</code></td>
<td>
<p>name/number of the column(s) containing covariate information
defaults to 0 (no covariates)</p>
</td></tr>
<tr><td><code id="autonpde_+3A_iipred">iipred</code></td>
<td>
<p>name/number of the column(s) with individual predictions
(ipred), defaults to 0 (individual predictions not available)</p>
</td></tr>
<tr><td><code id="autonpde_+3A_boolsave">boolsave</code></td>
<td>
<p>a boolean (TRUE if graphs and results are to be saved to a
file, FALSE otherwise), defaults to TRUE</p>
</td></tr>
<tr><td><code id="autonpde_+3A_namsav">namsav</code></td>
<td>
<p>name of the files to which results are to be saved (defaults
to &quot;output&quot;, which will produce a file called output.eps (if the default
format of postscript is kept, see type.graph) for the graphs and a file
called output.npde for the numerical results (see value)</p>
</td></tr>
<tr><td><code id="autonpde_+3A_type.graph">type.graph</code></td>
<td>
<p>type of graph (one of &quot;eps&quot;,&quot;jpeg&quot;,&quot;png&quot;,&quot;pdf&quot;), defaults
to postscript (&quot;eps&quot;)</p>
</td></tr>
<tr><td><code id="autonpde_+3A_verbose">verbose</code></td>
<td>
<p>a boolean (TRUE if messages are to be printed as each subject is
processed, FALSE otherwise), defaults to FALSE</p>
</td></tr>
<tr><td><code id="autonpde_+3A_calc.npde">calc.npde</code></td>
<td>
<p>a boolean (TRUE if npde are to be computed, FALSE otherwise),
defaults to TRUE</p>
</td></tr>
<tr><td><code id="autonpde_+3A_calc.npd">calc.npd</code></td>
<td>
<p>a boolean (TRUE if npd are to be computed, FALSE otherwise), defaults
to TRUE</p>
</td></tr>
<tr><td><code id="autonpde_+3A_decorr.method">decorr.method</code></td>
<td>
<p>a character string indicating the method used to decorrelate
observed and simulated data in the computation of npde (see <code><a href="#topic+npde.decorr.method">npde.decorr.method</a></code>)
defaults to cholesky</p>
</td></tr>
<tr><td><code id="autonpde_+3A_cens.method">cens.method</code></td>
<td>
<p>a character string indicating the method used to handle
censored data (see <code><a href="#topic+npde.cens.method">npde.cens.method</a></code>)
defaults to cdf</p>
</td></tr>
<tr><td><code id="autonpde_+3A_units">units</code></td>
<td>
<p>a list with components x, y and cov (optional), specifying the
units respectively for the predictor (x), the response (y), and the covariates
(a vector of length equal to the number of covariates). Units will default to (-) if not given.</p>
</td></tr>
<tr><td><code id="autonpde_+3A_detect">detect</code></td>
<td>
<p>a boolean controlling whether automatic recognition of columns in
the dataset is on, defaults to FALSE</p>
</td></tr>
<tr><td><code id="autonpde_+3A_ties">ties</code></td>
<td>
<p>a boolean (if FALSE, the distributions of pd and npde are smoothed by jittering the values so that there are no ties), defaults to TRUE</p>
</td></tr>
<tr><td><code id="autonpde_+3A_header">header</code></td>
<td>
<p>a boolean (TRUE if input files have headers,
FALSE otherwise), defaults to TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both functions compute the normalised prediction distribution errors (and/or
prediction discrepancies) in the same way. <code>npde</code> is an interactive
function whereas <code>autonpde</code> takes all required input as arguments.
</p>
<p>Diagnostic graphs are produced for npd, and npde are used in the tests as
their distribution takes into account the correlation between repeated observations.
</p>
<p>When the computation of npde fails because of numerical problems, error
messages are printed out, then pd are computed instead and graphs of pd are
plotted so that the user may evaluate why the computation failed.
</p>
<p>The function also prints out the characteristics of the distribution of the
npde (mean, variance, skewness and kurtosis) as well as the results of the
statistical tests applied to npde. In addition, if boolsave is TRUE, two files
are created:
</p>

<dl>
<dt>results file</dt><dd><p>the numerical results are saved in a file
with extension .npde (the name of which is given by the user). The file
contains the components id, xobs, ypred, npde, pd stored in columns</p>
</dd>
<dt>graph file</dt><dd><p>the graphs are saved to a file with the same name as the
results file, and with extension depending on the format.</p>
</dd>
</dl>



<h3>Value</h3>

<p>An object of class <code><a href="#topic+NpdeObject">NpdeObject</a></code>
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>
<p>PDF documentation for npde 3.0: <a href="https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf">https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde.graphs">npde.graphs</a></code>, <code><a href="#topic+gof.test">gof.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(theopp)
data(simtheopp)

# Calling autonpde with dataframes
x&lt;-autonpde(theopp,simtheopp,1,3,4,boolsave=FALSE)
x
head(x["results"]["res"])

plot(x)

</code></pre>

<hr>
<h2 id='compute.ploq'>Compute P(y_ij&lt;LOQ) for all observations</h2><span id='topic+compute.ploq'></span>

<h3>Description</h3>

<p>For each observation in the dataset, computes the probability to be below LOQ
using the simulations under the model. This is generally performed automatically.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute.ploq(npdeObject)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute.ploq_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class NpdeObject with a component ploq in the [&quot;results&quot;] slot
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>

<hr>
<h2 id='computenpde'>Internal functions used to compute normalised prediction distribution errors (npde)</h2><span id='topic+computenpde'></span>

<h3>Description</h3>

<p>Functions used by <code>npde</code> and <code>autonpde</code> to compute prediction
discrepancies (not intended for the end-user).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computenpde(npdeObject,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computenpde_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object of class NpdeObject</p>
</td></tr>
<tr><td><code id="computenpde_+3A_...">...</code></td>
<td>
<p>additional options to modify</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are normally not called by the end-user.
</p>


<h3>Value</h3>

<p>an object of class NpdeObject; the results slot will now include prediction discrepancies (npde) as well as decorrelated observed data, while the sim.data slot will now include decorrelated simulated data
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>

<hr>
<h2 id='computepd'>Internal functions used to compute prediction discrepancies</h2><span id='topic+computepd'></span>

<h3>Description</h3>

<p>Functions used by <code>npde</code> and <code>autonpde</code> to compute prediction
discrepancies (not intended for the end-user).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computepd(npdeObject,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computepd_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object of class NpdeObject</p>
</td></tr>
<tr><td><code id="computepd_+3A_...">...</code></td>
<td>
<p>additional options to modify</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are normally not called by the end-user.
</p>


<h3>Value</h3>

<p>an object of class NpdeObject; the results slot will now include prediction discrepancies (pd) as well as model predictions (ypred) obtained as the mean of the simulated data for each observation
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>

<hr>
<h2 id='default.npde.plots'>Default plots for a NpdeObject object</h2><span id='topic+default.npde.plots'></span>

<h3>Description</h3>

<p>Default plots for a NpdeObject object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default.npde.plots(npdeObject, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="default.npde.plots_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="default.npde.plots_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='dist.pred.sim'>Compute distribution of pd/npde using simulations</h2><span id='topic+dist.pred.sim'></span><span id='topic+calcnpde.sim'></span>

<h3>Description</h3>

<p>This function is used to build the distribution of pd/npde using the simulations under the model. The default is to build only the distribution of pd, and to sample from N(0,1) when building the distribution of npde under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist.pred.sim(npdeObject,nsamp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist.pred.sim_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="dist.pred.sim_+3A_nsamp">nsamp</code></td>
<td>
<p>number of datasets (defaults to 100 or to the number of replications if it is smaller)</p>
</td></tr>
<tr><td><code id="dist.pred.sim_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently only the value of calc.npd and calc.npde may be passed on, and will override their corresponding value in the &quot;options&quot; slot of npdeObject</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class NpdeObject; the [&quot;results&quot;] slot will contain pd and/or npde for a sample of the simulated datasets (depending on whether calc.npd/calc.npde are set), stored in pd.sim and/or npde.sim
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(theopp)
data(simtheopp)
x&lt;-autonpde(theopp,simtheopp,1,3,4,boolsave=FALSE)
# Use random samples from N(0,1) to obtain a prediction interval on the empirical cdf of the npde
plot(x,plot.type="ecdf",bands=TRUE,approx.pi=TRUE)
# defaults to computing the pd and npde for 100 simulated datasets
# (in the theophylline example, this uses all the simulated datasets)
x&lt;-dist.pred.sim(x)
# Use the npde from the simulated datasets to obtain a prediction interval on the empirical cdf
plot(x,plot.type="ecdf",bands=TRUE,approx.pi=FALSE)


</code></pre>

<hr>
<h2 id='gof.test'>Goodness-of-fit tests for npde</h2><span id='topic+gof.test'></span><span id='topic+gof.test.default'></span><span id='topic+gof.test.numeric'></span><span id='topic+gof.test.NpdeRes'></span><span id='topic+printgoftest'></span><span id='topic+gof.test.NpdeObject'></span>

<h3>Description</h3>

<p>Performs test on the selected variable (which=one of npde, pd or npd) or on a numeric vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof.test(object, parametric = TRUE, ...)

printgoftest(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof.test_+3A_object">object</code></td>
<td>
<p>an object (currently has methods for types numeric, NpdeRes and NpdeObject)</p>
</td></tr>
<tr><td><code id="gof.test_+3A_parametric">parametric</code></td>
<td>
<p>a boolean. If TRUE (default), parametric tests are performed</p>
</td></tr>
<tr><td><code id="gof.test_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to the function; special arguments are <code>na.action</code>, which controls how to handle NAs in the results (<code><a href="stats.html#topic+na.action">na.action</a></code>), <code>verbose</code> (if FALSE, suppresses printing of the results) and <code>covsplit</code> which requests the tests to be performed split by categories or quantiles of the data. If <code>covsplit</code> is TRUE, continuous covariates will be split in 3 categories (&lt;Q1, Q1-Q3, &gt;Q3) (see details in the PDF documentation), but this behaviour can be overriden by passing the argument <code>ncat=XXX</code> where XXX is the number of categories to divide the continuous covariates in.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If object is an NpdeObject and an argument covsplit=TRUE is given in ..., in addition to the global descriptive statistics and tests, tests will be performed for each covariate in <code>which.cov</code>. This argument can be set in ...; barring an explicit specification, the component <code>which.cov</code> of the prefs slot for a NpdeObject object will be used. The default value is <code>which.cov="all"</code>, which produces tests for each covariate in the dataset. Two additional dataframes will then be present:
</p>

<dl>
<dt>cov.stat</dt><dd><p>descriptive statistics and test p-values split by covariate and by categories</p>
</dd>
<dt>cov.p.value</dt><dd><p>p-values split by covariate; for each covariate, two tests are performed: the first test is a correlation test for continuous covariates and a Chi-square test for categorical covariates; the second test is defined using the p-values of the global tests split by each category, and appling a Bonferroni correction to obtain an overall p-value (see PDF documentation for details)</p>
</dd>
</dl>

<p>The p.value elements is a named vector with four components:
</p>

<dl>
<dt>p.mean</dt><dd><p>p-value for the mean test (Wilcoxon test if parametric=FALSE, Student test if parametric=TRUE)</p>
</dd>
<dt>p.var</dt><dd><p>p-value for the variance test (parametric=FALSE, Fisher test if parametric=TRUE)</p>
</dd>
<dt>p.dist</dt><dd><p>p-value for the distribution test (Shapiro-test for normality (npd, npde)/Kolmogorove-Smirnov test for uniformity)</p>
</dd>
<dt>p.global</dt><dd><p>p-value for the global test (combination of the mean, variance and distribution tests with a Bonferroni correction)</p>
</dd>
</dl>

<p>The p-values are adjusted using a Bonferroni correction: the raw p-values of the 3 individual tests are multiplied by 3, and the p-value for the global test is equal to the minimum of the adjusted p-values.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<dl>
<dt>mean</dt><dd><p>mean</p>
</dd>
<dt>se.mean</dt><dd><p>standard error of the mean</p>
</dd>
<dt>var</dt><dd><p>variance</p>
</dd>
<dt>se.var</dt><dd><p>standard error on variance</p>
</dd>
<dt>kurtosis</dt><dd><p>kurtosis (see <code><a href="#topic+kurtosis">kurtosis</a></code>)</p>
</dd>
<dt>skewness</dt><dd><p>skewness (see <code><a href="#topic+skewness">skewness</a></code>)</p>
</dd>
<dt>p.value</dt><dd><p>p-values for several tests (see below)</p>
</dd>
</dl>



<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F. Mentre. Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>, 23:2036&ndash;49, 2006.
</p>
<p>K. Brendel, E. Comets, C. Laffont, and F. Mentre. Evaluation of different tests based on observations for external model evaluation of  population analyses. <em>Journal of Pharmacokinetics and Pharmacodynamics</em>, 37:49&ndash;65, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kurtosis">kurtosis</a></code>, <code><a href="#topic+skewness">skewness</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(theopp)
data(simtheopp)
#' # Calling autonpde with dataframes
x&lt;-autonpde(theopp,simtheopp,1,3,4,boolsave=FALSE)
gof.test(x)

</code></pre>

<hr>
<h2 id='kurtosis'>Kurtosis</h2><span id='topic+kurtosis'></span>

<h3>Description</h3>

<p>Computes the kurtosis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kurtosis(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kurtosis_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the values whose kurtosis is to be
computed. NA values are removed in the computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">N = \mathrm{length}(x)</code>, then the kurtosis of <code class="reqn">x</code>
is defined as: </p>
<p style="text-align: center;"><code class="reqn">N sum_i (x_i-\mathrm{mean}(x))^4 (sum_i
(x_i-\mathrm{mean}(x))^2)^(-2) - </code>
</p>
<p style="text-align: center;"><code class="reqn">3</code>
</p>



<h3>Value</h3>

<p>The kurtosis of <code>x</code>.
</p>


<h3>References</h3>

<p>G. Snedecor, W. Cochran. <em>Statistical Methods</em>,
Wiley-Blackwell, 1989
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
kurtosis(x)
</code></pre>

<hr>
<h2 id='npde.binning'>Internal functions used to produce prediction intervals</h2><span id='topic+npde.binning'></span>

<h3>Description</h3>

<p>Functions used by plot functions to define the boundaries of the bins on the X-axis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.binning(xvec, plot.opt, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.binning_+3A_xvec">xvec</code></td>
<td>
<p>a vector of values for the X-axis of the plot</p>
</td></tr>
<tr><td><code id="npde.binning_+3A_plot.opt">plot.opt</code></td>
<td>
<p>graphical options</p>
</td></tr>
<tr><td><code id="npde.binning_+3A_verbose">verbose</code></td>
<td>
<p>boolean (defaults to FALSE). If TRUE, a table showing how the binning was performed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are normally not called by the end-user but are now exported for use in the saemix package.
</p>


<h3>Value</h3>

<p>a list with 3 elements, xgrp (the number of the bin associated with each element of xvec), xcent (a named vector containing the mean of the elements of xvec contained in each bin; the name of the bin is the interval), and xgroup (a vector with the group associated to each element of xvec after binning)
If verbose is TRUE, a table showing the bins is shown, giving the interval of xvec associated with each bin, the mean value
of xvec in each bin, and the number of observations
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>

<hr>
<h2 id='npde.cens.method'>Method used to handle censored data</h2><span id='topic+npde.cens.method'></span><span id='topic+computenpde.omit'></span><span id='topic+computenpde.loq'></span>

<h3>Description</h3>

<p>Specifies the method used to handle censored data (data below the limit of quantification LOQ
</p>


<h3>Details</h3>

<p>Several methods are available to handle censored data.
</p>

<dl>
<dt>omit</dt><dd><p>pd and npde for censored data will be set to NA</p>
</dd>
<dt>cdf</dt><dd><p>for an observation ycens_ij under the LOQ, a pd_ij will be imputed in the uniform distribution [0-pLOQ_ij] where pLOQ_ij is the probability that y_ij is below LOQ, according to the model; 
the predictive distribution will then be used to obtain a corresponding y*_ij. 
This is also performed for all simulated data, and the npde are then computed on the completed dataset containing the observed y_ij for the uncensored data and the y*_ij imputed for the censored data. This method is the default.</p>
</dd>
<dt>ipred</dt><dd><p>an observation ycens_ij is replaced by the individual prediction according to the model (ipred, which must be present in the dataset). Simulated data are left untouched.</p>
</dd>
<dt>ppred</dt><dd><p>an observation ycens_ij is replaced by the population prediction according to the model. Simulated data are left untouched.</p>
</dd>
<dt>loq</dt><dd><p>an observation ycens_ij is replaced by the value of the LOQ. Simulated data are left untouched.</p>
</dd>
</dl>



<h3>Value</h3>

<p>This is not a function and does not have a return value, this is a statistical method.
</p>
<p>More details can be found in the PDF documentation.
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# You need to have gridExtra installed to successfully run this example
if(requireNamespace("gridExtra", quietly=TRUE)) {
  data(warfarin)
  data(simwarfarinCov)
  wcov&lt;-autonpde(namobs=warfarin,namsim=simwarfarinCov, iid=1,ix=2,iy=4,icov=c(3,6:8),
  namsav="warfCov", units=list(x="hr",y="mg/L", covariates=c("mg","kg","-","yr")))
  
  # Diagnostic plots for warfarin with a covariate model
  plot(wcov)
  
  # Covariate plots
  xwt.scatt&lt;-plot(wcov, plot.type="x.scatter", covsplit=TRUE, which.cov="wt")
  xwt.qqplot&lt;-plot(wcov, plot.type="qqplot", covsplit=TRUE, which.cov="wt")
  xwt.box&lt;-plot(wcov, plot.type="covariates", which.cov="wt")
  xsex.scatt&lt;-plot(wcov, plot.type="x.scatter", covsplit=TRUE, which.cov="sex")
  xsex.qqplot&lt;-plot(wcov, plot.type="qqplot", covsplit=TRUE, which.cov="sex")
  xsex.box&lt;-plot(wcov, plot.type="covariates", which.cov="sex")
  
  # Transforming the reference profile for npd, compared to a VPC plot
  plot.tnpd&lt;-plot(wcov, plot.type="x.scatter", ref.prof=list(id=2), 
  main="tnpd with reference profile ID=2")
  plot.vpc&lt;-plot(wcov, plot.type="vpc", main="VPC")
  gridExtra::grid.arrange(grobs=list(plot.tnpd, plot.vpc), nrow=1, ncol=2)
  }

## End(Not run)
</code></pre>

<hr>
<h2 id='npde.decorr.method'>Decorrelation methods in npde</h2><span id='topic+npde.decorr.method'></span><span id='topic+decorr.chol'></span><span id='topic+decorr.inverse'></span><span id='topic+decorr.polar'></span>

<h3>Description</h3>

<p>Specifies the method used to decorrelate observed and simulated data
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.decorr.method_+3A_x">x</code></td>
<td>
<p>a square matrix
</p>

<dl>
<dt>cholesky</dt><dd><p>decorrelation is performed through the Cholesky decomposition (default)</p>
</dd>
<dt>inverse</dt><dd><p>decorrelation is performed by inverting Vi through the <code>eigen</code> function</p>
</dd>
<dt>polar</dt><dd><p>the singular-value decomposition (<code>svd</code>) is used</p>
</dd>
</dl>

<p>@return This is not a function and does not have a return value, this is a statistical method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in the PDF documentation.
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>

<hr>
<h2 id='npde.graphs'>Save the graphs for a NpdeObject object to a file</h2><span id='topic+npde.graphs'></span><span id='topic+npde.graphs+2CNpdeObject-method'></span>

<h3>Description</h3>

<p>Save the graphs to a file on disk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.graphs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.graphs_+3A_object">object</code></td>
<td>
<p>a NpdeObject object</p>
</td></tr>
<tr><td><code id="npde.graphs_+3A_...">...</code></td>
<td>
<p>optional arguments to replace options in object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following options can be changed by passing the appropriate arguments: namsav (string giving the root name of the files, an extension depending on the type of graph will be added), namgr (string giving the full name of the file), type.graph (one of &quot;eps&quot;, &quot;pdf&quot;, &quot;jpeg&quot;, &quot;png&quot;)
</p>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.Mentre. Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>, 23:2036&ndash;49, 2006.
</p>

<hr>
<h2 id='npde.main'>Main npde function</h2><span id='topic+npde.main'></span>

<h3>Description</h3>

<p>Main npde function, used to compute pd and npde
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.main(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.main_+3A_object">object</code></td>
<td>
<p>A NpdeObject object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A NpdeObject object updated with the results
</p>

<hr>
<h2 id='npde.plot.covariate'>Covariate diagnostic plots</h2><span id='topic+npde.plot.covariate'></span><span id='topic+aux.npdeplot.boxcov'></span>

<h3>Description</h3>

<p>Boxplot of the selected variable versus categories of covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.covariate(npdeObject, which.y="npd", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.covariate_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.covariate_+3A_which.y">which.y</code></td>
<td>
<p>a string specifying the variable on the Y-axis (one of &quot;yobs&quot;, &quot;npde&quot;, &quot;pd&quot;, &quot;npd&quot;)</p>
</td></tr>
<tr><td><code id="npde.plot.covariate_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code> and <code><a href="#topic+npdeControl">npdeControl</a></code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a categorical covariate, boxplots are produced for each category. Continous covariates are split into quantile (by default, first quartile (&lt;Q1), interquartile range (Q1-Q3) and upper quartile (&gt;Q3), but the number of categories can be set by using the ncat argument).
</p>
<p>For each category, the median according to simulations under the model is shown (it can be suppressed by using the argument bands=FALSE)..
</p>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, F. Mentre F. Evaluation of different tests based on observations for external model evaluation of population analyses. <em>Journal of Pharmacokinetics and Pharmacodynamics</em>, 37:49-65, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>, <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>, <code><a href="#topic+npdeControl">npdeControl</a></code>
</p>

<hr>
<h2 id='npde.plot.data'>Plot a NpdeData object</h2><span id='topic+npde.plot.data'></span>

<h3>Description</h3>

<p>Produces a spaghetti plot of the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.data(npdeObject, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.data_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.data_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>

<hr>
<h2 id='npde.plot.default'>Diagnostic plots</h2><span id='topic+npde.plot.default'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>The default diagnostic plots produced after a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code> include a histogram of the distribution, a QQ-plot compared to the theoretical distribution, and scatterplots versus the independent variable and versus the population predictions from the model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.default(npdeObject, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.default_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.default_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, npd are used for the diagnostic plots. If an unknown argument to which (eg which=&quot;XXX&quot;) is given, 
this is changed to npd (with a warning message if verbose=TRUE or the verbose option in the option slot of the npdeObject is TRUE).
</p>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>

<hr>
<h2 id='npde.plot.dist'>Distribution plots of pd/npde</h2><span id='topic+npde.plot.dist'></span><span id='topic+aux.npdeplot.hist'></span><span id='topic+aux.npdeplot.dist'></span>

<h3>Description</h3>

<p>Produces a plot of the cdistribution of a metric compared to their theoretical distribution. Three types of distribution plots are available:
a histogram, a QQ-plot, or the empirical cdf.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.dist(npdeObject, which="npd", dist.type="qqplot", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.dist_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.dist_+3A_which">which</code></td>
<td>
<p>a string determining which metric to plot (one of &quot;npde&quot;, &quot;pd&quot; or &quot;npd&quot;), defaults to &quot;npd&quot;</p>
</td></tr>
<tr><td><code id="npde.plot.dist_+3A_dist.type">dist.type</code></td>
<td>
<p>string, one of &quot;ecdf&quot; (empirical cumulative density function), &quot;hist&quot; (histogram) or &quot;qqplot&quot; (QQ-plot of the empirical distribution versus the theoretical quantiles) to determine which type of plot (default is &quot;qqplot&quot;)</p>
</td></tr>
<tr><td><code id="npde.plot.dist_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.  Mentre.
Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide.
<em>Pharmaceutical Research</em>, 23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>, <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>
</p>

<hr>
<h2 id='npde.plot.loq'>Plot of the probability that the observations are below the LOQ</h2><span id='topic+npde.plot.loq'></span>

<h3>Description</h3>

<p>Plots the probability that the observations are below the LOQ along with the model predicted interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.loq(npdeObject,xaxis="x",nsim=200,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.loq_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.loq_+3A_xaxis">xaxis</code></td>
<td>
<p>a string character, one of &quot;x&quot; (to plot P(Y&lt;LOQ) versus the value of the independent predictor) or &quot;ypred&quot; (versus the value of the population predictions). Defaults to &quot;x&quot;</p>
</td></tr>
<tr><td><code id="npde.plot.loq_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations to be used for the computation of the prediction interval</p>
</td></tr>
<tr><td><code id="npde.plot.loq_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>, <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>
</p>

<hr>
<h2 id='npde.plot.npde'>Plots for pd and npde</h2><span id='topic+npde.plot.npde'></span><span id='topic+npde.plot.pd'></span><span id='topic+npde.plot.npd'></span>

<h3>Description</h3>

<p>Plots for pd and npde
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.pd(npdeObject, ...)

npde.plot.npde(npdeObject, ...)

npde.plot.npd(npdeObject, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.npde_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.npde_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>

<hr>
<h2 id='npde.plot.scatterplot'>Scatterplots and VPC</h2><span id='topic+npde.plot.scatterplot'></span><span id='topic+compute.bands.true'></span><span id='topic+compute.bands'></span><span id='topic+aux.npdeplot.computepi'></span><span id='topic+aux.npdeplot.meanprof'></span><span id='topic+aux.npdeplot.pimat'></span><span id='topic+aux.npdeplot.transformPI'></span><span id='topic+aux.npdeplot.transformObs'></span>

<h3>Description</h3>

<p>Produces a scatterplot. Different types of scatterplots can be produced, with associated prediction bands (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.scatterplot(npdeObject, which.x="x", which.y="npd", ref.prof=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.scatterplot_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.scatterplot_+3A_which.x">which.x</code></td>
<td>
<p>a string specifying the variable on the X-axis (one of &quot;x&quot;, &quot;pred&quot;, &quot;cov&quot;)</p>
</td></tr>
<tr><td><code id="npde.plot.scatterplot_+3A_which.y">which.y</code></td>
<td>
<p>a string specifying the variable on the Y-axis (one of &quot;yobs&quot;, &quot;npde&quot;, &quot;pd&quot;, &quot;npd&quot;), defaults to &quot;npd&quot;</p>
</td></tr>
<tr><td><code id="npde.plot.scatterplot_+3A_ref.prof">ref.prof</code></td>
<td>
<p>either a character string (one of &quot;covariate&quot; or &quot;all&quot;), or a named list specifying the characteristics of the reference profile (see details)</p>
</td></tr>
<tr><td><code id="npde.plot.scatterplot_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code> and <code><a href="#topic+npdeControl">npdeControl</a></code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>VPC: obtained using which.x=&quot;x&quot;, which.y=&quot;yobs&quot;
</p>
<p>Scatterplots of npde/pd/npd can be obtained versus &quot;x&quot; (independent variable) or &quot;pred&quot; (population predictions from the model)
</p>
<p>Scatterplots of npde/pd/npd/observations can be obtained versus covariates by setting the which.x argument to &quot;cov&quot; and selecting the appropriate which.y. The function will use the covariates in the which.cov element of the prefs slot. This can be overriden to cycle over all the covariates in the dataset by supplying the argument which.cov=&quot;all&quot; in the call to the function.
</p>
<p>Reference profile: a reference profile can be added to scatterplots of npd and npde versus the independent variable (see Comets et al. 2013)
</p>
<p>If ref.prof=&quot;all&quot; (and covsplit is FALSE), the reference plot will be computed over all subjects using the mean and SD of all simulated data in each bin (see documentation).
</p>
<p>If ref.prof=&quot;covariate&quot; and an additional argument covsplit is given (covsplit=TRUE), the reference plot will be adjusted for each covariate category over all the covariates in the which.cov element of the prefs slot (see  <code><a href="#topic+npdeControl">npdeControl</a></code> for details on the prefs slot of the npdeObject).
</p>
<p>If ref.prof is given as a named list (eg list(ID=c(1,5)) or list(sex=0, dose=c(50,100)), where names should refer to columns in the data file (eg ID should be a column in the data)), the reference profile will be obtained by combining (in the first example above, the reference profile will be obtained using the simulated data for subjects 1 and 5, while in the second example it will be computed using the subjects with sex=0 given doses 50 or 100).
</p>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.  Mentre.
Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide.
<em>Pharmaceutical Research</em>, 23:2036&ndash;49, 2006.
</p>
<p>E. Comets, T.H.T. Nguyen, and F. Mentr F. Additional features and graphs in the new npde library for R.
<em>22th meeting of the Population Approach Group in Europe</em>, Glasgow, United Kingdom, 2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>, <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>, <code><a href="#topic+npdeControl">npdeControl</a></code>
</p>

<hr>
<h2 id='npde.plot.select'>Select plot for a NpdeObject object</h2><span id='topic+npde.plot.select'></span>

<h3>Description</h3>

<p>Select plot for a NpdeObject object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.select(npdeObject,data=FALSE,ecdf=FALSE,qqplot=FALSE, histogram=FALSE,
x.scatter=FALSE,pred.scatter=FALSE,x.box=FALSE,pred.box=FALSE, cov.scatter=FALSE, 
cov.x.scatter=FALSE, cov.pred.scatter=FALSE,cov.x.box=FALSE,cov.pred.box=FALSE, 
cov.ecdf=FALSE, cov.hist=FALSE, cov.qqplot=FALSE, vpc=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.select_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_data">data</code></td>
<td>
<p>boolean, whether to produce a plot of the data</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_ecdf">ecdf</code></td>
<td>
<p>boolean, whether to produce a distribution plot of the empirical distribution function</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_qqplot">qqplot</code></td>
<td>
<p>boolean, whether to produce a QQ-plot of the empirical distribution function</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_histogram">histogram</code></td>
<td>
<p>boolean, whether to produce a histogram of the metric</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_x.scatter">x.scatter</code></td>
<td>
<p>boolean, whether to produce a scatterplot of the metric as a function of X</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_pred.scatter">pred.scatter</code></td>
<td>
<p>boolean, whether to produce a scatterplot of the metric as a function of predictions</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_x.box">x.box</code></td>
<td>
<p>boolean, whether to produce whisker plots of the metric as a function of X</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_pred.box">pred.box</code></td>
<td>
<p>boolean, whether to produce whisker plots of the metric as a function of predictions</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_cov.scatter">cov.scatter</code></td>
<td>
<p>boolean, whether to produce a scatterplot of the metric as a function of covariate(s)</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_cov.x.scatter">cov.x.scatter</code></td>
<td>
<p>boolean, whether to produce a scatterplot of the metric as a function of X, split by covariate(s)</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_cov.pred.scatter">cov.pred.scatter</code></td>
<td>
<p>boolean, whether to produce a scatterplot of the metric as a function of predictions, split by covariate(s)</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_cov.x.box">cov.x.box</code></td>
<td>
<p>boolean, whether to produce whisker plots of the metric as a function of X, split by covariate(s)</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_cov.pred.box">cov.pred.box</code></td>
<td>
<p>boolean, whether to produce whisker plots of the metric as a function of predictions, split by covariate(s)</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_cov.ecdf">cov.ecdf</code></td>
<td>
<p>boolean, whether to produce a distribution plot of the empirical distribution function, split by covariate(s)</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_cov.hist">cov.hist</code></td>
<td>
<p>boolean, whether to produce a distribution plot of the empirical distribution function, split by covariate(s)</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_cov.qqplot">cov.qqplot</code></td>
<td>
<p>boolean, whether to produce a distribution plot of the empirical distribution function, split by covariate(s)</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_vpc">vpc</code></td>
<td>
<p>boolean, whether to produce a VPC</p>
</td></tr>
<tr><td><code id="npde.plot.select_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>, <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>
</p>

<hr>
<h2 id='npde.plot.splitcov'>Plots split by covariate for a NpdeObject object</h2><span id='topic+npde.plot.splitcov'></span>

<h3>Description</h3>

<p>Plots split by covariate for a NpdeObject object (equivalent to using covsplit=TRUE with the appropriate plot.type)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.plot.splitcov(npdeObject, which.plot="x", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.plot.splitcov_+3A_npdeobject">npdeObject</code></td>
<td>
<p>an object returned by a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code></p>
</td></tr>
<tr><td><code id="npde.plot.splitcov_+3A_which.plot">which.plot</code></td>
<td>
<p>one of &quot;x&quot; (scatterplots of the metric versus X), &quot;pred&quot; (scatterplots of the metric versus predictions), &quot;ecdf&quot; (empirical distribution function), &quot;hist&quot; (histogram), &quot;qqplot&quot;</p>
</td></tr>
<tr><td><code id="npde.plot.splitcov_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code><a href="#topic+set.plotoptions">set.plotoptions</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>

<hr>
<h2 id='npde.save'>Save the results contained in a NpdeObject object to a file</h2><span id='topic+npde.save'></span><span id='topic+npde.save+2CNpdeObject-method'></span>

<h3>Description</h3>

<p>Save the results to a table on disk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde.save(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde.save_+3A_object">object</code></td>
<td>
<p>a NpdeObject object</p>
</td></tr>
<tr><td><code id="npde.save_+3A_...">...</code></td>
<td>
<p>optional arguments to replace options in object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following options can be changed by passing the appropriate arguments: namsav (string giving the root name of the files, an extension .npde will be added), nameres (string giving the full name of the file)
</p>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.Mentre. Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>, 23:2036&ndash;49, 2006.
</p>

<hr>
<h2 id='npdeControl'>Set options for an NpdeObject</h2><span id='topic+npdeControl'></span><span id='topic+replace.control.options'></span><span id='topic+check.control.options'></span>

<h3>Description</h3>

<p>Set, replace and check options for an NpdeObject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npdeControl(boolsave = TRUE, namsav = "output", type.graph = "eps",
verbose = FALSE, calc.npde = TRUE, calc.npd = TRUE, decorr.method = "cholesky",
cens.method = "omit", ties = TRUE, sample = FALSE)

check.control.options(opt)

replace.control.options(opt,...)

replace.control.options(opt, ...)

check.control.options(opt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npdeControl_+3A_boolsave">boolsave</code></td>
<td>
<p>whether to save the results (a file containing the numerical results and a file with the graphs)</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_namsav">namsav</code></td>
<td>
<p>the root name of the files to save to (the file with the results will be named ROOTNAME.npde and the graphs will be saved to ROOTNAME.format where format is given by the type.graph argument)</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_type.graph">type.graph</code></td>
<td>
<p>type of graph to save to (one of &quot;eps&quot;, &quot;pdf&quot;, &quot;jpeg&quot;, &quot;png&quot;)</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_verbose">verbose</code></td>
<td>
<p>a boolean; if TRUE, a message is printed as the computation of the npde begins for each new subject</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_calc.npde">calc.npde</code></td>
<td>
<p>a boolean; TRUE to compute npde</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_calc.npd">calc.npd</code></td>
<td>
<p>a boolean; TRUE to compute npd</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_decorr.method">decorr.method</code></td>
<td>
<p>the method used to decorrelate simulated and observed data (see <code><a href="#topic+npde.decorr.method">npde.decorr.method</a></code>)</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_cens.method">cens.method</code></td>
<td>
<p>the method used to handle censored data (see <code><a href="#topic+npde.cens.method">npde.cens.method</a></code>)</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_ties">ties</code></td>
<td>
<p>if FALSE, a smoothing will be applied to prediction discrepancies to avoid ties</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_sample">sample</code></td>
<td>
<p>if TRUE, the test on the pd will be performed after randomly sampling only pd per subject</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_opt">opt</code></td>
<td>
<p>a list of control options to be checked</p>
</td></tr>
<tr><td><code id="npdeControl_+3A_...">...</code></td>
<td>
<p>named parameters to be changed. The names will be compared to the names of the control variables and changed, with warnings issued for names that do not match.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of settings for the computation of pd/npde
</p>

<hr>
<h2 id='npdeData'>Creates a NpdeData object</h2><span id='topic+npdeData'></span>

<h3>Description</h3>

<p>This function is used to create a NpdeData object, representing a longitudinal data structure, and fill it with data from a dataframe or a file on disk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npdeData(name.data,header=TRUE,sep="",na.strings=c(".","NA"),name.group,
name.predictor, name.response, name.covariates,name.cens,name.miss,name.ipred,
units=list(x="",y="",covariates=c()), detect=TRUE,verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npdeData_+3A_name.data">name.data</code></td>
<td>
<p>name of the file containing the observed data, or a dataframe
containing the observed data</p>
</td></tr>
<tr><td><code id="npdeData_+3A_header">header</code></td>
<td>
<p>boolean indicating whether the file has a header (a header is 
mandatory if detect is TRUE)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_sep">sep</code></td>
<td>
<p>field separator (for files on disk)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_na.strings">na.strings</code></td>
<td>
<p>strings to be considered as indicating NA</p>
</td></tr>
<tr><td><code id="npdeData_+3A_name.group">name.group</code></td>
<td>
<p>name/number of the column in the observed data containing the
patient ID (if missing and detect is TRUE, columns named id, subject or sujet
(regardless of case) will be assumed to contain this information)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_name.predictor">name.predictor</code></td>
<td>
<p>name/number of the column in the observed data containing
the independent variable X (if missing and detect is TRUE, columns named xobs,
time, dose, x, temps, tim (regardless of case) will be assumed to
contain this information)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_name.response">name.response</code></td>
<td>
<p>name/number of the column in the observed data containing
the dependent variable Y (if missing and detect is TRUE, columns named yobs,
response, resp, conc, concentration (regardless of case) will be assumed to
contain this information)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_name.covariates">name.covariates</code></td>
<td>
<p>name/number of the column(s) containing covariate
information (optional)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_name.cens">name.cens</code></td>
<td>
<p>name/number of the column containing information about censored
data (cens) (if missing and detect is TRUE, column with a name containing cens
(regardless of case) will be assumed to contain this information)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_name.miss">name.miss</code></td>
<td>
<p>name/number of the column containing information about missing
data (MDV) (if missing and detect is TRUE, column called mdv or miss
(regardless of case) will be assumed to contain this information)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_name.ipred">name.ipred</code></td>
<td>
<p>name/number of the column(s) with individual predictions
(ipred)  (if missing and detect is TRUE, column with a name containing ipred
(regardless of case) will be assumed to contain this information)</p>
</td></tr>
<tr><td><code id="npdeData_+3A_units">units</code></td>
<td>
<p>a list with components x, y and cov (optional), specifying the
units respectively for the predictor (x), the response (y), and the covariates
(a vector of length equal to the number of covariates). Units will default to (-) if not given.</p>
</td></tr>
<tr><td><code id="npdeData_+3A_detect">detect</code></td>
<td>
<p>a boolean controlling whether automatic recognition of columns in the dataset is on, defaults to TRUE</p>
</td></tr>
<tr><td><code id="npdeData_+3A_verbose">verbose</code></td>
<td>
<p>whether to print warning messages, defaults to FALSE (set to TRUE to check how data is being handled)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class NpdeData
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentr. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(theopp)

x&lt;-npdeData(theopp) # Automatic detection
print(x)
x&lt;-npdeData(theopp,name.group="ID",name.predictor="Time",name.response="Conc",
name.covariates=c("Wt"),units=list(x="hr",y="mg/L",covariates="kg")) # Explicit
print(x)

</code></pre>

<hr>
<h2 id='NpdeData-class'>Class &quot;NpdeData&quot; representing the structure of the longitudinal data</h2><span id='topic+NpdeData-class'></span><span id='topic+NpdeData'></span><span id='topic+print+2CNpdeData-method'></span><span id='topic+summary+2CNpdeData-method'></span><span id='topic+npde.qqplot+2CNpdeData-method'></span>

<h3>Description</h3>

<p>A longitudinal data structure
</p>


<h3>Objects from the Class</h3>

<p>NpdeData objects are typically created by a call to <code><a href="#topic+npdeData">npdeData</a></code> contain the following slots:
</p>

<dl>
<dt>name.group</dt><dd><p>character string giving the name of the grouping term (ID)</p>
</dd>
<dt>name.predictor</dt><dd><p>character string giving the name of the predictor (X)</p>
</dd>
<dt>name.response</dt><dd><p>character string giving the name of the response (Y)</p>
</dd>
<dt>name.cens</dt><dd><p>character string giving the name of the censoring indicator in the original dataset (renamed to cens)</p>
</dd>
<dt>name.mdv</dt><dd><p>character string giving the name of the missing data indicator in the original dataset (renamed to mdv)</p>
</dd>
<dt>name.covariates</dt><dd><p>vector of character string giving the name(s) of the covariates</p>
</dd>
<dt>name.ipred</dt><dd><p>character string giving the name of the individual predictions</p>
</dd>
<dt>units</dt><dd><p>(optional) a list with the units for X, Y, and covariates</p>
</dd>
<dt>data</dt><dd><p>a dataframe containing the data</p>
</dd>
<dt>N</dt><dd><p>number of subjects</p>
</dd>
<dt>ntot.obs</dt><dd><p>total number of non-missing observations</p>
</dd>
<dt>nind.obs</dt><dd><p>vector of size N giving the number of non-missing observations for each subject</p>
</dd>
<dt>ind</dt><dd><p>index of non-missing observations</p>
</dd>
<dt>icens</dt><dd><p>index of censored observations (non-missing)</p>
</dd>
<dt>not.miss</dt><dd><p>a vector of boolean indicating for each observation whether it is missing (FALSE) or available (TRUE)</p>
</dd>
<dt>loq</dt><dd><p>the censoring value</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show(npde.data):</dt><dd><p>Prints a short summary of object npde.data</p>
</dd>
<dt>qqplot.npde(npde.data):</dt><dd><p>QQ-plot for NpdeData object (TODO: change for NpdeObject in final package)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>methods(class="NpdeData")
showClass("NpdeData")
</code></pre>

<hr>
<h2 id='NpdeObject-class'>Class &quot;NpdeObject&quot;</h2><span id='topic+NpdeObject-class'></span><span id='topic+NpdeObject'></span><span id='topic+print+2CNpdeObject-method'></span><span id='topic+showall+2CNpdeObject-method'></span><span id='topic+summary+2CNpdeObject-method'></span><span id='topic+test+2CNpdeObject-method'></span><span id='topic+npde.main+2CNpdeObject'></span><span id='topic+npde.save+2CNpdeObject'></span><span id='topic+npde.graphs+2CNpdeObject'></span><span id='topic+plot+2CNpdeObject'></span>

<h3>Description</h3>

<p>An object of class NpdeObject
</p>


<h3>Objects from the Class</h3>

<p>NpdeObject objects are typically created by calls to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code>. They contain the following slots:
</p>

<dl>
<dt>data</dt><dd><p>an object of class NpdeData, containing the observed data</p>
</dd>
<dt>sim.data</dt><dd><p>an object of class NpdeSimData, containing the simulated data</p>
</dd>
<dt>results</dt><dd><p>an object of class NpdeRes, containing the results</p>
</dd>
<dt>options</dt><dd><p>a list of options</p>
</dd>
<dt>prefs</dt><dd><p>a list of graphical preferences for the plots</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>print(x):</dt><dd><p>Prints a summary of object</p>
</dd>
<dt>show(x):</dt><dd><p>Prints a short summary of object</p>
</dd>
<dt>showall(x):</dt><dd><p>Prints a detailed summary of object</p>
</dd>
<dt>plot(x):</dt><dd><p>Diagnostic and other plots. More details can be found in <code><a href="#topic+plot.NpdeObject">plot.NpdeObject</a></code></p>
</dd>
<dt>summary(x):</dt><dd><p>Returns a summary of object x in list format</p>
</dd>
<dt>gof.test(x, parametric=TRUE, ...):</dt><dd><p>Returns goodness-of-fit tests</p>
</dd>
<dt>set.plotoptions(x):</dt><dd><p>Sets options for graphs (internal method used in plots)</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>, <code><a href="#topic+NpdeData">NpdeData</a></code>, <code><a href="#topic+NpdeSimData">NpdeSimData</a></code>, <code><a href="#topic+NpdeRes">NpdeRes</a></code>, <code><a href="#topic+gof.test">gof.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>methods(class="NpdeObject")

showClass("NpdeObject")

</code></pre>

<hr>
<h2 id='NpdeRes-class'>Class &quot;NpdeRes&quot;</h2><span id='topic+NpdeRes-class'></span><span id='topic+NpdeRes'></span><span id='topic+NpdeRes-class+2C'></span><span id='topic+print+2CNpdeRes-method'></span><span id='topic+showall+2CNpdeRes-method'></span><span id='topic+summary+2CNpdeRes-method'></span><span id='topic+test+2CNpdeRes-method'></span>

<h3>Description</h3>

<p>The results component of a NpdeObject object
</p>


<h3>Objects from the Class</h3>

<p>NpdeRes objects are created during a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code> as the &quot;results&quot; slot in a NpdeObject object. An NpdeRes object contains the following slots:
</p>

<dl>
<dt>res</dt><dd><p>a dataframe containing the results. Columns include id (group), xobs (observed X), yobs (observed Y), cens (indicator for censored data), as well as the actual results: ypred (model population predictions), pd (prediction discrepancies), npde (normalised prediction distribution errors), ycomp (completed data), ydobs (decorrelated observed data).</p>
</dd>
<dt>N</dt><dd><p>number of subjects</p>
</dd>
<dt>ntot.obs</dt><dd><p>total number of non-missing observations</p>
</dd>
<dt>ploq</dt><dd><p>a vector giving the probability that a given observation is LOQ, according to the model</p>
</dd>
<dt>icens</dt><dd><p>index of (non-missing) censored observations</p>
</dd>
<dt>not.miss</dt><dd><p>a vector of boolean indicating for each observation whether it is missing (FALSE) or available (TRUE)</p>
</dd>
<dt>pd.sim</dt><dd><p>pd computed for a number of simulated datasets (optional, used to obtain prediction intervals on the distribution of pd)</p>
</dd>
<dt>npde.sim</dt><dd><p>npde computed for a number of simulated datasets (optional, used to obtain prediction intervals on the distribution of npde)</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>print(npde.res):</dt><dd><p>Prints a summary of object npde.res</p>
</dd>
<dt>show(npde.res):</dt><dd><p>Prints a short summary of object npde.res</p>
</dd>
<dt>showall(npde.res):</dt><dd><p>Prints a detailed summary of object npde.res</p>
</dd>
<dt>plot(npde.res):</dt><dd><p>Plots the data in npde.res. More details can be found in <code><a href="#topic+plot.NpdeRes">plot.NpdeRes</a></code></p>
</dd>
<dt>summary(npde.res):</dt><dd><p>Returns a summary of object npde.res in list format</p>
</dd>
<dt>gof.test(x, parametric=TRUE, ...):</dt><dd><p>Returns goodness-of-fit tests</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>, <code><a href="#topic+plot.NpdeRes">plot.NpdeRes</a></code>, <code><a href="#topic+NpdeObject">NpdeObject</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>methods(class="NpdeRes")

showClass("NpdeRes")
</code></pre>

<hr>
<h2 id='npdeSimData'>Creates a NpdeSimData object</h2><span id='topic+npdeSimData'></span>

<h3>Description</h3>

<p>This function is used to create a NpdeSimData object containing the simulated data corresponding to an NpdeData object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npdeSimData(npde.data, name.simdata, header=TRUE, sep="", na.strings=c("NA","."), 
detect=FALSE, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npdeSimData_+3A_npde.data">npde.data</code></td>
<td>
<p>a NpdeData object</p>
</td></tr>
<tr><td><code id="npdeSimData_+3A_name.simdata">name.simdata</code></td>
<td>
<p>name of the file containing the simulated data, or a dataframe containing it</p>
</td></tr>
<tr><td><code id="npdeSimData_+3A_header">header</code></td>
<td>
<p>boolean indicating whether the file has a header (a header is 
mandatory if detect is TRUE)</p>
</td></tr>
<tr><td><code id="npdeSimData_+3A_sep">sep</code></td>
<td>
<p>field separator (for files on disk)</p>
</td></tr>
<tr><td><code id="npdeSimData_+3A_na.strings">na.strings</code></td>
<td>
<p>strings to be considered as indicating NA</p>
</td></tr>
<tr><td><code id="npdeSimData_+3A_detect">detect</code></td>
<td>
<p>a boolean controlling whether automatic recognition of columns in the dataset is on, defaults to FALSE
if FALSE, the first 3 columns of the simulated data file will will be used as simulated id, predictor and response respectively
if TRUE, the function will look for columns named respectively idsim, xsim and ysim (it will fail with an error message if these columns
are not present in the simulated data)</p>
</td></tr>
<tr><td><code id="npdeSimData_+3A_verbose">verbose</code></td>
<td>
<p>whether to print warning messages, defaults to FALSE (set to TRUE to check how data is being handled)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class NpdeSimData
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NpdeData">NpdeData</a></code>, <code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>

<hr>
<h2 id='NpdeSimData-class'>Class &quot;NpdeSimData&quot; representing the structure of the longitudinal data</h2><span id='topic+NpdeSimData-class'></span><span id='topic+NpdeSimData'></span>

<h3>Description</h3>

<p>A longitudinal data structure, with simulated data
</p>


<h3>Objects from the Class</h3>

<p>NpdeSimData objects are created by associating an NpdeData object with matching simulated data, and they contain the following slots.
</p>

<dl>
<dt>nrep</dt><dd><p>number of replications)</p>
</dd>
<dt>datsim</dt><dd><p>a dataframe containing the simulated data,  with columns: idsim (subject id), irsim (replication index), xsim (simulated x), ysim (simulated response). After a call to <code><a href="#topic+npde">npde</a></code> or <code><a href="#topic+autonpde">autonpde</a></code>, an additional column ydsim (decorrelated replicated data) will be added.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>print(npde.simdata):</dt><dd><p>Prints a summary of object npde.simdata</p>
</dd>
<dt>show(npde.simdata):</dt><dd><p>Prints a short summary of object npde.simdata</p>
</dd>
<dt>showall(npde.simdata):</dt><dd><p>Prints a detailed summary of object npde.simdata</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("NpdeSimData")
</code></pre>

<hr>
<h2 id='pdemenu'>Interactive menu to set the options for the npde() function</h2><span id='topic+pdemenu'></span>

<h3>Description</h3>

<p>Interactive menu to set the options for the npde() function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdemenu()
</code></pre>


<h3>Value</h3>

<p>A list with the information needed to compute the pd/npde
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.
Mentre. Metrics for external model evaluation with an application to the
population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>,
23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde.graphs">npde.graphs</a></code>, <code><a href="#topic+gof.test">gof.test</a></code>
</p>

<hr>
<h2 id='plot.NpdeData'>Plots a NpdeData object</h2><span id='topic+plot.NpdeData'></span>

<h3>Description</h3>

<p>Plots the data in a NpdeData object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NpdeData'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.NpdeData_+3A_x">x</code></td>
<td>
<p>a NpdeData object</p>
</td></tr>
<tr><td><code id="plot.NpdeData_+3A_y">y</code></td>
<td>
<p>unused, here for compatibility with the base plot function</p>
</td></tr>
<tr><td><code id="plot.NpdeData_+3A_...">...</code></td>
<td>
<p>additional graphical parameters to be passed on to the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default plot is a spaghetti plot of all the data, with a line joining the observations for each subject. If censored data is present, it is shown with a different symbol and colour.
</p>


<h3>Value</h3>

<p>currently does not return anything, use plot(x, plot.type=&quot;data&quot;) on the npdeObject x (TODO; a ggplot object)
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.Mentre. Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>, 23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set.plotoptions">set.plotoptions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(theopp)

x&lt;-npdeData(theopp,name.group="ID",name.predictor="Time",name.response="Conc",
name.covariates=c("Wt"),units=list(x="hr",y="mg/L",covariates="kg"))
plot(x)

</code></pre>

<hr>
<h2 id='plot.NpdeObject'>Plots a NpdeObject object</h2><span id='topic+plot.NpdeObject'></span><span id='topic+plot.npde'></span><span id='topic+plotNpde'></span>

<h3>Description</h3>

<p>Plots the data and diagnostic plots in a NpdeObject object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NpdeObject'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.NpdeObject_+3A_x">x</code></td>
<td>
<p>a NpdeObject object</p>
</td></tr>
<tr><td><code id="plot.NpdeObject_+3A_y">y</code></td>
<td>
<p>unused, here for compatibility with the base plot function</p>
</td></tr>
<tr><td><code id="plot.NpdeObject_+3A_...">...</code></td>
<td>
<p>additional graphical parameters, which when given will supersede graphical preferences stored in the object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default plots are represented as a 2x2 array with distribution plots on the top row (histogram and QQ-plot),
and scatterplots of npde versus independent variable and population predictions on the bottom row. 
The graph is plotted in a graphic device window, unless the result is stored in an object (eg myplot&lt;-plot(x)) which can then be printed (eg using print(myplot)).
</p>
<p>@references K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.Mentre. Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>, 23:2036&ndash;49, 2006.
</p>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set.plotoptions">set.plotoptions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(theopp)
data(simtheopp)

x&lt;-autonpde(theopp,simtheopp,iid="ID",ix="Time", iy="Conc", boolsave=FALSE)
plot(x)


</code></pre>

<hr>
<h2 id='plot.NpdeRes'>Plots a NpdeRes object</h2><span id='topic+plot.NpdeRes'></span>

<h3>Description</h3>

<p>Plots distribution and scatterplots for the npde in a NpdeRes object. Users are advised to use the plot() function on the NpdeObject object resulting from a call to npde() or autonpde() instead of trying to plot only the results element of this object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NpdeRes'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.NpdeRes_+3A_x">x</code></td>
<td>
<p>a NpdeRes object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Four graphs are produced:
</p>

<dl>
<dt>a quantile-quantile plot</dt><dd><p>plot of the npde versus the corresponding quantiles of a normal distribution, with the line y=x overlayed.</p>
</dd>
<dt>a histogram of the npde</dt><dd><p>the shape of the normal distribution is also shown</p>
</dd>
<dt>two scatterplots of the npde</dt><dd><p>a plot of the npde versus the independent variable X and a plot of the npde versus the empirical mean of the predicted distribution; for these last two graphs, we plot the lines corresponding to y=0 and to the 5% and 95% critical value of the normal distribution delimiting a 90% prediction interval for the npde</p>
</dd>
</dl>



<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.Mentre. Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide. <em>Pharmaceutical Research</em>, 23:2036&ndash;49, 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set.plotoptions">set.plotoptions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(theopp)

</code></pre>

<hr>
<h2 id='print.NpdeData'>Prints objects from the npde package</h2><span id='topic+print.NpdeData'></span><span id='topic+print.NpdeRes'></span><span id='topic+print.NpdeObject'></span>

<h3>Description</h3>

<p>prints  objects of classes NpdeData, NpdeSimData, NpdeRes and NpdeObject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NpdeData'
print(x, nlines = 10, ...)

## S3 method for class 'NpdeRes'
print(x, nlines = 10, ...)

## S3 method for class 'NpdeObject'
print(x, nlines = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.NpdeData_+3A_x">x</code></td>
<td>
<p>an object of class NpdeData, NpdeSimData, NpdeRes or NpdeObject</p>
</td></tr>
<tr><td><code id="print.NpdeData_+3A_nlines">nlines</code></td>
<td>
<p>number of lines from the dataset to print</p>
</td></tr>
<tr><td><code id="print.NpdeData_+3A_...">...</code></td>
<td>
<p>Additional arguments (ignored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='read'>Read data into structures (internal)</h2><span id='topic+read'></span><span id='topic+read-methods'></span><span id='topic+read+2CNpdeData'></span><span id='topic+read+2CNpdeData-methods'></span><span id='topic+read+2CNpdeSimData-methods'></span><span id='topic+read+2CNpdeData-method'></span><span id='topic+read+2CNpdeSimData-method'></span>

<h3>Description</h3>

<p>Creates an NpdeData object containing the observed data, either from disk or from a dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read(object, dat, detect=TRUE, verbose=FALSE, ...)

## S4 method for signature 'NpdeData'
read(object, dat, detect = TRUE, verbose = FALSE, ...)

## S4 method for signature 'NpdeSimData'
read(object, dat, detect = FALSE, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_+3A_object">object</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="read_+3A_dat">dat</code></td>
<td>
<p>a dataframe containing the data to be analysed</p>
</td></tr>
<tr><td><code id="read_+3A_detect">detect</code></td>
<td>
<p>a boolean; if TRUE, automatic recognition of names will be attempted to detect necessary items 
for a NpdeData, these include longitudinal data structure, missing data and censoring information
for a NpdeSimData, the required columns should be called idsim, xsim, ysim, representing respectively simulated id, simulated 
predictor and simulated response</p>
</td></tr>
<tr><td><code id="read_+3A_verbose">verbose</code></td>
<td>
<p>a boolean; messages are printed if verbose is TRUE (defaults to FALSE)</p>
</td></tr>
<tr><td><code id="read_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility with generic</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>"<a href="#topic+NpdeData-class">NpdeData</a>"</code> or <code>"<a href="#topic+NpdeSimData-class">NpdeSimData</a>"</code>
</p>

<hr>
<h2 id='replace.plotoptions'>Replace graphical options</h2><span id='topic+replace.plotoptions'></span>

<h3>Description</h3>

<p>This function is used to replace graph options (available in the prefs slot of the NpdeObject object) for plotting NpdeObject objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace.plotoptions(plot.opt,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace.plotoptions_+3A_plot.opt">plot.opt</code></td>
<td>
<p>a list of graphical preferences</p>
</td></tr>
<tr><td><code id="replace.plotoptions_+3A_...">...</code></td>
<td>
<p>names and values of the options to be replaced</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See documentation for a list of available options. During replacement, invalid (including misspelled) options will raise warnings.
</p>


<h3>Value</h3>

<p>an updated list of options for graphs
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>

<hr>
<h2 id='set.plotoptions'>Set graphical preferences</h2><span id='topic+set.plotoptions'></span><span id='topic+set.plotoptions+2CNpdeData-method'></span><span id='topic+set.plotoptions+2CNpdeObject-method'></span><span id='topic+set.plotoptions.NpdeData'></span><span id='topic+set.plotoptions.default'></span><span id='topic+set.plotoptions.NpdeObject'></span>

<h3>Description</h3>

<p>This function is used to set options for graphs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.plotoptions(object)

## Default S3 method:
set.plotoptions(object)

## S3 method for class 'NpdeData'
set.plotoptions(object)

## S3 method for class 'NpdeObject'
set.plotoptions(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set.plotoptions_+3A_object">object</code></td>
<td>
<p>an object of class NpdeData or NpdeObject</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See documentation for a list of available options.
</p>


<h3>Value</h3>

<p>a list of options for graphs
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npde">npde</a></code>, <code><a href="#topic+autonpde">autonpde</a></code>
</p>

<hr>
<h2 id='show'>Displays npde objects</h2><span id='topic+show'></span><span id='topic+show+2CNpdeData-method'></span><span id='topic+show.NpdeData'></span><span id='topic+show+2CNpdeSimData-method'></span><span id='topic+show.NpdeSimData'></span><span id='topic+show+2CNpdeRes-method'></span><span id='topic+show.NpdeRes'></span><span id='topic+show+2CNpdeObject-method'></span><span id='topic+show.NpdeObject'></span><span id='topic+show+2CObject-method'></span>

<h3>Description</h3>

<p>Prints the structure of objects from the package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'NpdeData'
show(object)

## S4 method for signature 'NpdeSimData'
show(object)

## S4 method for signature 'NpdeRes'
show(object)

## S4 method for signature 'NpdeObject'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_+3A_object">object</code></td>
<td>
<p>an object from the npde package (NpdeData, NpdeRes, NpdeObject)</p>
</td></tr>
</table>

<hr>
<h2 id='showall'>Contents of an object</h2><span id='topic+showall'></span><span id='topic+showall.NpdeData'></span><span id='topic+showall+2CNpdeData-method'></span><span id='topic+showall.default'></span><span id='topic+showall+2Cmethod'></span><span id='topic+showall.NpdeRes'></span><span id='topic+showall.NpdeObject'></span>

<h3>Description</h3>

<p>Prints the contents of an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showall(object)

## S3 method for class 'NpdeRes'
showall(object)

## S3 method for class 'NpdeObject'
showall(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showall_+3A_object">object</code></td>
<td>
<p>a NpdeData object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, shows the object
</p>

<hr>
<h2 id='simtheopp'>Simulated data for the computation of normalised prediction distribution
errors in the theophylline dataset</h2><span id='topic+simtheopp'></span>

<h3>Description</h3>

<p>The <code>simtheopp</code> dataset contains 100 simulations using the design of
dataset <code><a href="#topic+theopp">theopp</a></code>. These simulations are used to compute npde.
The control file used to perform the simulations can be found in the
subdirectory 'doc' within the library npde.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simtheopp
</code></pre>


<h3>Format</h3>

<p>A data frame with 132000 rows and 3 variables
This data frame contains the following columns: </p>

<dl>
<dt>ID</dt><dd><p> an ordered factor with levels <code>1</code>, ..., <code>12</code>
identifying the subject on whom the observation was made.  The ordering is
first by simulation then by increasing time.  </p>
</dd> <dt>xsim</dt><dd><p> time since drug
administration when the sample was drawn (hr).  </p>
</dd> <dt>ysim</dt><dd><p> simulated
theophylline concentration (mg/L).  </p>
</dd> </dl>



<h3>Details</h3>

<p>See <code><a href="#topic+theopp">theopp</a></code> for a description of the original dataset.
</p>
<p>The simulated data was obtained using the software <em>NONMEM</em>. A
one-compartment model was fit to the data. An exponential interindividual
variability was assumed for the three parameters (absorption rate constant
ka, volume of distribution V and clearance CL) and a combined additive and
proportional residual error model was usd. The estimated parameters were
then used to simulate 100 datasets with the same structure as the original
dataset.  Thus, for each observation in the original dataset, the simulated
dataset contains 100 simulations under the model used for the estimation.
</p>
<p>This dataset is provided so that users can figure out what type of data is
needed for the computation of prediction distribution errors. More
information can be found in the User Guide distributed along with this
package, which contains a run-through of the theophylline example.
</p>


<h3>Source</h3>

<p>Boeckmann, A. J., Sheiner, L. B. and Beal, S. L. (1994),
<em>NONMEM Users Guide: Part V</em>, NONMEM Project Group, University of
California, San Francisco.
</p>


<h3>References</h3>

<p>PDF documentation for npde 3.0: <a href="https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf">https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+theopp">theopp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(simtheopp)

# Plotting the simulated data for subject 1 in the first simulation
plot(ysim[2:12]~xsim[2:12],data=simtheopp,xlab="Time after dose (hr)",
ylab="Theophylline concentration (mg/L)",type="l",
main="Example of simulated data for subject 1")

# Plotting a 90% prediction interval for the observations in theopp
# using the simulated data in simtheopp
# note : differences in doses between subjects are not taken into account
data(theopp)
xpl&lt;-c(0,0.25,0.5,1,2,3.5,5,7,9,12,24)
xpl1&lt;-list(c(0,0.1),c(0.2,0.4),c(0.5,0.65),c(0.9,1.2),c(1.9,2.2),c(3.4,4),
c(4.9,5.2),c(6.9,7.2),c(8.8,9.4),c(11.5,12.2),c(23.7,24.7))

ypl&lt;-cbind(xpl=xpl,binf=xpl,median=xpl,bsup=xpl)
for(i in 1:(length(xpl))) {
  vec&lt;-simtheopp$ysim[simtheopp$xsim&gt;=xpl1[[i]][1] &amp;simtheopp$xsim&lt;=xpl1[[i]][2]]
  ypl[i,2:4]&lt;-quantile(vec,c(0.05,0.5,0.95))
}
plot(Conc~Time,data=theopp,xlab="Time after dose (hr)",
ylab="Theophylline concentration (mg/L)")
lines(ypl[,1],ypl[,3],lwd=2)
lines(ypl[,1],ypl[,2],lty=2)
lines(ypl[,1],ypl[,4],lty=2)


</code></pre>

<hr>
<h2 id='skewness'>Skewness</h2><span id='topic+skewness'></span>

<h3>Description</h3>

<p>Computes the skewness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewness(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skewness_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the values whose skewness is to be
computed. NA values are removed in the computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">N = \mathrm{length}(x)</code>, then the skewness of <code class="reqn">x</code>
is defined as </p>
<p style="text-align: center;"><code class="reqn">N^{-1} \mathrm{sd}(x)^{-3} \sum_i (x_i -
\mathrm{mean}(x))^3.</code>
</p>



<h3>Value</h3>

<p>The skewness of <code>x</code>.
</p>


<h3>References</h3>

<p>G. Snedecor, W. Cochran. <em>Statistical Methods</em>,
Wiley-Blackwell, 1989
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
skewness(x)
</code></pre>

<hr>
<h2 id='subset.NpdeData'>Subsetting a NpdeData object</h2><span id='topic+subset.NpdeData'></span><span id='topic+subset.NpdeObject'></span>

<h3>Description</h3>

<p>Return subset of data from a NpdeData object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NpdeData'
subset(x, subset, ...)

## S3 method for class 'NpdeObject'
subset(x, subset, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset.NpdeData_+3A_x">x</code></td>
<td>
<p>A NpdeData object</p>
</td></tr>
<tr><td><code id="subset.NpdeData_+3A_subset">subset</code></td>
<td>
<p>logical expression indicating elements or rows to keep: missing values are taken as false.</p>
</td></tr>
<tr><td><code id="subset.NpdeData_+3A_...">...</code></td>
<td>
<p>Additional arguments (ignored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a NpdeData object with a subset of the original data
</p>

<hr>
<h2 id='summary.NpdeData'>Summary of a NpdeData object</h2><span id='topic+summary.NpdeData'></span><span id='topic+summary.NpdeRes'></span><span id='topic+summary.NpdeObject'></span>

<h3>Description</h3>

<p>Extracts elements from a NpdeData object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NpdeData'
summary(object, print = TRUE, ...)

## S3 method for class 'NpdeRes'
summary(object, print = TRUE, ...)

## S3 method for class 'NpdeObject'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.NpdeData_+3A_object">object</code></td>
<td>
<p>A NpdeData object</p>
</td></tr>
<tr><td><code id="summary.NpdeData_+3A_print">print</code></td>
<td>
<p>whether to print to data to stdev</p>
</td></tr>
<tr><td><code id="summary.NpdeData_+3A_...">...</code></td>
<td>
<p>Additional arguments (ignored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements N (nb of subjects), data (dataframe containing the data), ntot.obs (total nb of observations), nind.obs (nb of observations per subject)
</p>

<hr>
<h2 id='theopp'>Pharmacokinetics of theophylline</h2><span id='topic+theopp'></span>

<h3>Description</h3>

<p>The <code>theopp</code> data frame has 132 rows and 5 columns of data from an
experiment on the pharmacokinetics of theophylline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theopp
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns: </p>

<dl>
<dt>ID</dt><dd><p> an ordered factor with levels <code>1</code>, ..., <code>12</code>
identifying the subject on whom the observation was made.  The ordering is
by Time at which the observation was made.  </p>
</dd> <dt>Dose</dt><dd><p> dose of
theophylline administered orally to the subject (mg/kg).  </p>
</dd> <dt>Time</dt><dd>
<p>time since drug administration when the sample was drawn (hr).  </p>
</dd>
<dt>Conc</dt><dd><p> theophylline concentration in the sample (mg/L).  </p>
</dd> <dt>Wt</dt><dd>
<p>weight of the subject (kg).  </p>
</dd> </dl>



<h3>Details</h3>

<p>Boeckmann, Sheiner and Beal (1994) report data from a study by Dr. Robert
Upton of the kinetics of the anti-asthmatic drug theophylline.  Twelve
subjects were given oral doses of theophylline then serum concentrations
were measured at 11 time points over the next 25 hours.
</p>
<p>These data are analyzed in Davidian and Giltinan (1995) and Pinheiro and
Bates (2000) using a two-compartment open pharmacokinetic model.
</p>
<p>These data are also available in the library <code>datasets</code> under the name
<code>Theoph</code> in a slightly modified format and including the data at time
0.  Here, we use the file in the format provided in the <em>NONMEM</em>
installation path (see the User Guide for that software for details).
</p>


<h3>Source</h3>

<p>Boeckmann, A. J., Sheiner, L. B. and Beal, S. L. (1994),
<em>NONMEM Users Guide: Part V</em>, NONMEM Project Group, University of
California, San Francisco.
</p>
<p>Davidian, M. and Giltinan, D. M. (1995) <em>Nonlinear Models for Repeated
Measurement Data</em>, Chapman &amp; Hall (section 5.5, p. 145 and section 6.6, p.
176)
</p>
<p>Pinheiro, J. C. and Bates, D. M. (2000) <em>Mixed-effects Models in S and
S-PLUS</em>, Springer (Appendix A.29)
</p>


<h3>References</h3>

<p>PDF documentation for npde 3.0: <a href="https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf">https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(theopp)

#Plotting the theophylline data
plot(Conc~Time,data=theopp,xlab="Time after dose (hr)",
ylab="Theophylline concentration (mg/L)")

</code></pre>

<hr>
<h2 id='virload'>Simulated HIV viral loads in HIV patients</h2><span id='topic+virload'></span><span id='topic+virload20'></span><span id='topic+virloadMDV20'></span><span id='topic+virload50'></span><span id='topic+simvirload'></span>

<h3>Description</h3>

<p>This is simulated data, based on real data obtained in a phase II clinical trial supported by the French Agency for AIDS Research, the COPHAR 3-ANRS 134 trial (Goujard et al., 2010). The original study included 35 patients, who received a once daily dose containing atazanavir (300 mg), ritonavir (100 mg), tenofovir disoproxil (245 mg) and emtricitabine (200 mg) during 24 weeks. Viral loads were measured 6 times over a treatment period of 24 weeks (day 0, 28, 56, 84, 112, 168).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>virload
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns: 
</p>

<dl>
<dt>ID</dt><dd><p>an ordered factor with levels <code>1</code>, ..., <code>50</code> identifying the subject on whom the observation was made.  The ordering is by Time at which the observation was made.</p>
</dd>
<dt>Time</dt><dd><p>time since the beginning of the study (days)</p>
</dd>
<dt>Log_VL</dt><dd><p>logarithm (base 10) of the viral load (copies/L)</p>
</dd>
<dt>cens</dt><dd><p> indicator variable (cens=1 for censored data, cens=0 for observed data)</p>
</dd> 
<dt>ipred</dt><dd><p>individual predictions</p>
</dd>
</dl>



<h3>Details</h3>

<p>The datasets were generated in a simulation study designed to evaluate the new method proposed to handle BQL data (Nguyen et al., 2011). Data was simulated using a simple bi-exponential HIV dynamic model describing the two-phase decline of viral load during anti-retroviral treatment.
</p>
<p>The <code>virload</code> data frame has 300 rows and 4 columns of data. The dataset was then censored at two different LOQ levels (LOQ=20 or 50~copies/mL) to generate two datasets containing different proportions of BQL data, creating the data frames <code>virload20</code> and<code>virload50</code> respectively
</p>
<p>The file simvirload contains 500 simulations under the same model. A full version of the simulated data with 1000 simulations 
can be downloaded from the github for npde3.0: <a href="https://github.com/ecomets/npde30/blob/main/keep/data/simvirload.tab">https://github.com/ecomets/npde30/blob/main/keep/data/simvirload.tab</a>
</p>


<h3>Source</h3>

<p>Goujard, C., Barrail-Train, A., Duval, X., Nembot, G., Panhard, X., Savic, R., Descamps, D., Vrijens, B., Taburet, A., Mentre, F., and the ANRS 134 study group (2010). 
Virological response to atazanavir, ritonavir and tenofovir/emtricitabine: relation to individual pharmacokinetic parameters and adherence measured by medication events monitoring system (MEMS) in naive HIV-infected patients (ANRS134 trial). 
<em>International AIDS Society 2010</em>, Abstr WEPE0094.
</p>


<h3>References</h3>

<p>PDF documentation for npde 3.0: <a href="https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf">https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(virload)
  str(virload)
  data(virload50)
  # Plotting the data
  plot(Log_VL~Time,data=virload,xlab="Time (d)",ylab="Viral loads, base 10 log-scale (cp/mL)")
  plot(Log_VL~Time,data=virload50,xlab="Time (d)",ylab="Viral loads, base 10 log-scale (cp/mL)")

</code></pre>

<hr>
<h2 id='warfarin'>Pharmacokinetics of warfarin</h2><span id='topic+warfarin'></span><span id='topic+simwarfarinBase'></span><span id='topic+simwarfarinCov'></span>

<h3>Description</h3>

<p>The <code>warfarin</code> data frame has 251 rows and 8 columns of data containing
data on the pharmacokinetics of warfarin, an anticoagulant drug used in the 
prevention of thrombosis and thromboembolism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>warfarin
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns: 
</p>

<dl>
<dt>id</dt><dd><p>an integer identifying the subject on whom the observation was made</p>
</dd>
<dt>time</dt><dd><p>time since drug administration when the sample was drawn (hr)</p>
</dd>
<dt>amt</dt><dd><p>total dose received by the subject (mg)</p>
</dd>
<dt>dv</dt><dd><p>warfarin concentration in the sample (mg/L)</p>
</dd> 
<dt>dvid</dt><dd><p>observation type (1 for all observations)</p>
</dd>
<dt>wt</dt><dd><p>weight of the subject (kg)</p>
</dd> 
<dt>sex</dt><dd><p>subject gender (0=female, 1=male)</p>
</dd> 
<dt>age</dt><dd><p>age of the subject (yr) </p>
</dd> 
</dl>



<h3>Details</h3>

<p>The dataset is the PK part of a larger dataset including both warfarin concentrations
and prothrombin complex activity (PCA), which measures the decreased coagulation 
activity resulting from the inhibition of vitamin K recycling, the mechanism of 
action of warfarin. It contains the concentrations measured in 32 healthy subjects 
after a single oral dose of warfarin sodium (1.5 mg/kg of body weight). The subjects 
in the study were sampled at different times over a period of up to 120 hours.
</p>
<p>The data is distributed with the Monolix software as a demo for PK/PD modelling.
The data has been slightly reformated for R, removing the line at time=0
and filling the amt column with the dose for each subject, following the output
of simulx which was used to simulate data from two alternative models to fit this
dataset.
</p>
<p>Two datasets containing simulated data are associated with the <code>warfarin</code> data. For
each dataset, 1000 simulations of the original data were performed for the computation of npde.
The package contains only the simulated data simwarfarinCov because of size constraints. simwarfarinBase can be downloaded from
the github for npde3.0: <a href="https://github.com/ecomets/npde30/blob/main/keep/data/simwarfarinBase.tab">https://github.com/ecomets/npde30/blob/main/keep/data/simwarfarinBase.tab</a>
</p>

<dl>
<dt>simwarfarinBase</dt><dd><p>the data in this dataset was simulated according to a base model without covariates: the PK model was a two-compartment model, with first-order absorption and a time-delay. Interindividual variability was modelled as log-normal distributions for parameters Tlag, ka, Cl and V1, and the error model was a combined error model. The parameters were estimated by Monolix.</p>
</dd>
<dt>simwarfarinCov</dt><dd><p>the data in this dataset was simulated according to a model including several covariates: an age (centered on 30 yr) effect on Cl, a weight (centered on 70 kg) effect on Cl and V1, and a gender effect on V1. The covariate model was built in Monolix.</p>
</dd>
</dl>



<h3>Source</h3>

<p>OReilly (1968). Studies on coumarin anticoagulant drugs. Initiation 
of warfarin therapy without a loading dose. Circulation 1968, 38:169-177.
</p>


<h3>References</h3>

<p>PDF documentation for npde 3.0: <a href="https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf">https://github.com/ecomets/npde30/blob/main/userguide_npde_3.0.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(warfarin)

#Plotting the warfarin PK data
plot(dv~time,data=warfarin,xlab="Time after dose (hr)",
ylab="Warfarin concentration (mg/L)")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
