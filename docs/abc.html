<!DOCTYPE html><html><head><title>Help for package abc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {abc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#abc'>
<p>Parameter estimation with Approximate Bayesian Computation (ABC)</p></a></li>
<li><a href='#cv4abc'>
<p>Cross validation for Approximate Bayesian Computation (ABC)</p></a></li>
<li><a href='#cv4postpr'>
<p>Leave-one-our cross validation for model selection ABC</p></a></li>
<li><a href='#expected.deviance'>
<p>Expected deviance</p></a></li>
<li><a href='#gfit'>
<p>Goodness of fit</p></a></li>
<li><a href='#gfitpca'>
<p>Goodness of fit with principal component analysis</p></a></li>
<li><a href='#hist.abc'>
<p>Posterior histograms</p></a></li>
<li><a href='#plot.abc'>
<p>Diagnostic plots for ABC</p></a></li>
<li><a href='#plot.cv4abc'>
<p>Cross-validation plots for ABC</p></a></li>
<li><a href='#plot.cv4postpr'>
<p>Barplot of model misclassification</p></a></li>
<li><a href='#plot.gfit'>
<p>Goodness-of-fit plot for ABC</p></a></li>
<li><a href='#postpr'>
<p>Estimating posterior model probabilities</p></a></li>
<li><a href='#summary.abc'>
<p>Summaries of posterior samples generated by ABC algortithms</p></a></li>
<li><a href='#summary.cv4abc'>
<p>Calculates the cross-validation prediction error</p></a></li>
<li><a href='#summary.cv4postpr'>
<p>Confusion matrix and misclassification probabilities of models</p></a></li>
<li><a href='#summary.gfit'>
<p>Calculates the p-value of the goodness-of-fit test.</p></a></li>
<li><a href='#summary.postpr'>
<p>Posterior model probabilities and Bayes factors</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Approximate Bayesian Computation (ABC)</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-17</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), abc.data, nnet, quantreg, MASS, locfit</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements several ABC algorithms for
        performing parameter estimation, model selection, and goodness-of-fit.
        Cross-validation tools are also available for measuring the
        accuracy of ABC estimates, and to calculate the
        misclassification probabilities of different models.</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-18 18:46:30 UTC; mblum</td>
</tr>
<tr>
<td>Author:</td>
<td>Csillery Katalin [aut],
  Lemaire Louisiane [aut],
  Francois Olivier [aut],
  Blum Michael [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Blum Michael &lt;michael.blum.temp@gmail.com&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-19 07:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='abc'>
Parameter estimation with Approximate Bayesian Computation (ABC)
</h2><span id='topic+abc'></span><span id='topic+abc.return'></span>

<h3>Description</h3>

<p>This function performs multivariate parameter estimation based on
summary statistics using an ABC algorithm. The algorithms implemented
are rejection sampling, and local linear or non-linear (neural
network) regression. A conditional heteroscedastic model is available
for the latter two algorithms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abc(target, param, sumstat, tol, method, hcorr = TRUE, transf = "none",
logit.bounds, subset = NULL, kernel = "epanechnikov", numnet =
10, sizenet = 5, lambda = c(0.0001,0.001,0.01), trace = FALSE, maxit =
500, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abc_+3A_target">target</code></td>
<td>
  
<p>a vector of the observed summary statistics.</p>
</td></tr>
<tr><td><code id="abc_+3A_param">param</code></td>
<td>

<p>a vector, matrix or data frame of the simulated parameter values,
i.e. the dependent variable(s) when <code>method</code> is <code>"loclinear"</code>, <code>"neuralnet"</code> or <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code id="abc_+3A_sumstat">sumstat</code></td>
<td>

<p>a vector, matrix or data frame of the simulated summary statistics,
i.e. the independent variables when <code>method</code> is <code>"loclinear"</code>, <code>"neuralnet"</code> or <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code id="abc_+3A_tol">tol</code></td>
<td>

<p>tolerance, the required proportion of points accepted nearest the
target values.</p>
</td></tr>
<tr><td><code id="abc_+3A_method">method</code></td>
<td>

<p>a character string indicating the type of ABC algorithm to be
applied.  Possible values are <code>"rejection"</code>,
<code>"loclinear"</code>, <code>"neuralnet"</code> and <code>"ridge"</code>. See also
<code>Details</code>.</p>
</td></tr>
<tr><td><code id="abc_+3A_hcorr">hcorr</code></td>
<td>

<p>logical, the conditional heteroscedastic model is applied if
<code>TRUE</code> (default).</p>
</td></tr>
<tr><td><code id="abc_+3A_transf">transf</code></td>
<td>

<p>a vector of character strings indicating the kind of transformation
to be applied to the parameter values. The possible values are
<code>"log"</code>, <code>"logit"</code>, and <code>"none"</code> (default), when no
is transformation applied. See also <code>Details</code>.</p>
</td></tr>
<tr><td><code id="abc_+3A_logit.bounds">logit.bounds</code></td>
<td>

<p>a matrix of bounds if <code>transf</code> is <code>"logit"</code>. 
The matrix has as many lines as parameters (including the ones 
that are not <code>"logit"</code> transformed) and 2 columns. First column is the 
minimum bound and second column is the maximum bound.</p>
</td></tr>
<tr><td><code id="abc_+3A_subset">subset</code></td>
<td>

<p>a logical expression indicating elements or rows to keep. Missing
values in <code>param</code> and/or <code>sumstat</code> are taken as
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="abc_+3A_kernel">kernel</code></td>
<td>

<p>a character string specifying the kernel to be used when
<code>method</code> is <code>"loclinear"</code>, <code>"neuralnet"</code> or <code>"ridge"</code>. Defaults
to <code>"epanechnikov"</code>. See <code><a href="stats.html#topic+density">density</a></code> for details.</p>
</td></tr>
<tr><td><code id="abc_+3A_numnet">numnet</code></td>
<td>

<p>the number of neural networks when <code>method</code> is
<code>"neuralnet"</code>. Defaults to 10. It indicates the number of times
the function <code><a href="nnet.html#topic+nnet">nnet</a></code> is called.</p>
</td></tr>
<tr><td><code id="abc_+3A_sizenet">sizenet</code></td>
<td>

<p>the number of units in the hidden layer. Defaults to 5. Can be zero
if there are no skip-layer units. See <code><a href="nnet.html#topic+nnet">nnet</a></code> for more
details.</p>
</td></tr>
<tr><td><code id="abc_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector or a single value indicating the weight decay when
<code>method</code> is <code>"neuralnet"</code>. See <code><a href="nnet.html#topic+nnet">nnet</a></code> for more
details. By default, 0.0001, 0.001, or 0.01 is randomly chosen for
each of the networks.</p>
</td></tr>
<tr><td><code id="abc_+3A_trace">trace</code></td>
<td>

<p>logical, if <code>TRUE</code> switches on tracing the optimization of
<code><a href="nnet.html#topic+nnet">nnet</a></code>. Applies only when <code>method</code> is
<code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code id="abc_+3A_maxit">maxit</code></td>
<td>

<p>numeric, the maximum number of iterations. Defaults to 500. Applies
only when <code>method</code> is <code>"neuralnet"</code>. See also
<code><a href="nnet.html#topic+nnet">nnet</a></code>.</p>
</td></tr>
<tr><td><code id="abc_+3A_...">...</code></td>
<td>

<p>other arguments passed to <code><a href="nnet.html#topic+nnet">nnet</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These ABC algorithms generate random samples from the posterior
distributions of one or more parameters of interest, <code class="reqn">\theta_1,
  \theta_2, \dots, \theta_n</code>. To apply any of these algorithms, (i) data
sets have to be simulated based on random draws from the prior
distributions of the <code class="reqn">\theta_i</code>'s, (ii) from these data sets, a set
of summary statistics have to be calculated, <code class="reqn">S(y)</code>, (iii) the
same summary statistics have to be calculated from the observed data,
<code class="reqn">S(y_0)</code>, and (iv) a tolerance rate must be chosen
(<code>tol</code>). See <code><a href="#topic+cv4abc">cv4abc</a></code> for a cross-validation tool
that may help in choosing the tolerance rate.
</p>
<p>When <code>method</code> is <code>"rejection"</code>, the simple rejection
algorithm is used. Parameter values are accepted if the Euclidean
distance between <code class="reqn">S(y)</code> and <code class="reqn">S(y_0)</code> is sufficiently
small. The percentage of accepted simulations is determined by
<code>tol</code>. When <code>method</code> is <code>"loclinear"</code>, a local linear
regression method corrects for the imperfect match between <code class="reqn">S(y)</code>
and <code class="reqn">S(y_0)</code>. The accepted parameter values are weighted by a
smooth function (<code>kernel</code>) of the distance between <code class="reqn">S(y)</code> and
<code class="reqn">S(y_0)</code>, and corrected according to a linear transform:
<code class="reqn">\theta^{*} = \theta - b(S(y) - S(y_0))</code>. <code class="reqn">\theta^{*}</code>'s
represent samples form the posterior distribution. This method calls
the function <code><a href="stats.html#topic+lsfit">lsfit</a></code> from the <code>stats</code> library.  When
using the <code>"loclinear"</code> method, a warning about the collinearity
of the design matrix of the regression might be issued. In that
situation, we recommend to rather use the related <code>"ridge"</code>
method that performs local-linear ridge regression and deals with the
collinearity issue.  The non-linear regression correction method
(<code>"neuralnet"</code>) uses a non-linear regression to minimize the
departure from non-linearity using the function <code><a href="nnet.html#topic+nnet">nnet</a></code>.
The posterior samples of parameters based on the rejection algorithm
are returned as well, even when one of the regression algorithms is
used.
</p>
<p>Several additional arguments can be specified when <code>method</code> is
<code>"neuralnet"</code>. The method is based on the function
<code><a href="nnet.html#topic+nnet">nnet</a></code> from the library <code><a href="nnet.html#topic+nnet">nnet</a></code>, which fits
single-hidden-layer neural networks. <code>numnet</code> defines the
number of neural networks, thus the function <code><a href="nnet.html#topic+nnet">nnet</a></code> is
called <code>numnet</code> number of times. Predictions from different
neural networks can be rather different, so the median of the
predictions from all neural networks is used to provide a global
prediction. The choice of the number of neural networks is a trade-off
between speed and accuracy. The default is set to 10 networks. The
number of units in the hidden layer can be specified via
<code>sizenet</code>. Selecting the number of hidden units is similar to
selecting the independent variables in a linear or non-linear
regression. Thus, it corresponds to the complexity of the
network. There is several rule of thumb to choose the number of hidden
units, but they are often unreliable. Generally speaking, the optimal
choice of <code>sizenet</code> depends on the dimensionality, thus the
number of statistics in <code>sumstat</code>. It can be zero when there are
no skip-layer units. See also <code><a href="nnet.html#topic+nnet">nnet</a></code> for more details. The
<code>method</code> <code>"neuralnet"</code> is recommended when dealing with a
large number of summary statistics.
</p>
<p>If <code>method</code> is <code>"loclinear"</code>, <code>"neuralnet"</code> or <code>"ridge"</code>, a
correction for heteroscedasticity is applied by default (<code>hcorr =
  TRUE</code>).
</p>
<p>Parameters maybe transformed priori to estimation. The type of
transformation is defined by <code>transf</code>. The length of
<code>transf</code> is normally the same as the number of parameters. If
only one value is given, that same transformation is applied to all
parameters and the user is warned. When a parameter transformation
used, the parameters are back-transformed to their original scale
after the regression estimation. No transformations can be applied
when <code>method</code> is <code>"rejection"</code>.
</p>
<p>Using names for the parameters and summary statistics is strongly
recommended. Names can be supplied as <code><a href="base.html#topic+names">names</a></code> or
<code><a href="base.html#topic+colnames">colnames</a></code> to <code>param</code> and <code>sumstat</code> (and
<code>target</code>). If no names are supplied, P1, P2, ... is assigned to
parameters and S1, S2, ... to summary statistics and the user is
warned.
</p>


<h3>Value</h3>

<p>The returned value is an object of class <code>"abc"</code>, containing the
following components:
</p>
<table>
<tr><td><code>adj.values</code></td>
<td>
<p>The regression adjusted values, when <code>method</code> is
<code>"loclinear"</code>, <code>"neuralnet"</code> or <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>unadj.values</code></td>
<td>
<p>The unadjusted values that correspond to
<code>"rejection"</code> <code>method</code>.</p>
</td></tr>
<tr><td><code>ss</code></td>
<td>
<p>The summary statistics for the accepted simulations.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>The regression weights, when <code>method</code> is
<code>"loclinear"</code>, <code>"neuralnet"</code> or <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>The residuals from the regression when <code>method</code> is
<code>"loclinear"</code>, <code>"neuralnet"</code> or <code>"ridge"</code>. These are the &quot;raw&quot;
residuals from <code><a href="stats.html#topic+lsfit">lsfit</a></code> or <code><a href="nnet.html#topic+nnet">nnet</a></code>,
respectively, thus they are not on the original scale of the
parameter(s).</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>The Euclidean distances for the accepted simulations.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The original call.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>A logical vector indicating the elements or rows that
were excluded, including both <code>NA</code>/<code>NaN</code>'s and
elements/rows selected by <code>subset</code>.</p>
</td></tr>
<tr><td><code>region</code></td>
<td>
<p>A logical expression indicting the elements or rows that
were accepted.</p>
</td></tr>
<tr><td><code>transf</code></td>
<td>
<p>The parameter transformations that have been used.</p>
</td></tr>
<tr><td><code>logit.bounds</code></td>
<td>
<p>The bounds, if transformation was <code>"logit"</code>.</p>
</td></tr>
<tr><td><code>kernel</code></td>
<td>
<p>The kernel used.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Character string indicating the <code>method</code>, i.e.
<code>"rejection"</code>, <code>"loclinear"</code>, or <code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>A numeric vector of length <code>numnet</code>. The actual
values of the decay parameters used in each of the neural networks,
when <code>method</code> is <code>"neuralnet"</code>. These values are selected
randomly from the supplied vector of values.</p>
</td></tr>
<tr><td><code>numparam</code></td>
<td>
<p>Number of parameters used.</p>
</td></tr>
<tr><td><code>numstat</code></td>
<td>
<p>Number of summary statistics used.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>The sum of the AIC of the <code>numparam</code> regression.
Returned only if <code>method</code> is <code>"loclinear"</code>. It is used for
selecting informative summary statistics.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>The same but with the BIC.</p>
</td></tr> 
<tr><td><code>names</code></td>
<td>
<p>A list with two elements: <code>parameter.names</code> and
<code>statistics.names</code>. Both contain a vector of character strings
with the parameter and statistics names, respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Katalin Csillery, Olivier Francois and Michael Blum with some
initial code from Mark Beaumont.
</p>


<h3>References</h3>

<p>Pritchard, J.K., and M.T. Seielstad and A. Perez-Lezaun and
M.W. Feldman (1999) Population growth of human Y chromosomes: a study
of Y chromosome microsatellites. <em>Molecular Biology and
Evolution</em>, <b>16</b>, 1791&ndash;1798.
</p>
<p>Beaumont, M.A., Zhang, W., and Balding, D.J. (2002) Approximate
Bayesian Computation in Population Genetics, <em>Genetics</em>,
<b>162</b>, 2025-2035.
</p>
<p>Blum, M.G.B. and Francois, O. (2010) Non-linear regression models
for Approximate Bayesian Computation. <em>Statistics and Computing</em>
<b>20</b>, 63-73.
</p>
<p>Csillery, K., M.G.B. Blum, O.E. Gaggiotti and O. Francois (2010)
Approximate Bayesian Computation (ABC) in practice. <em>Trends in
Ecology and Evolution</em>, <b>25</b>, 410-418.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.abc">summary.abc</a></code>, <code><a href="#topic+hist.abc">hist.abc</a></code>,
<code><a href="#topic+plot.abc">plot.abc</a></code>, <code><a href="stats.html#topic+lsfit">lsfit</a></code>, <code><a href="nnet.html#topic+nnet">nnet</a></code>,
<code><a href="#topic+cv4abc">cv4abc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(abc.data)
data(musigma2)
?musigma2

## The rejection algorithm
##
rej &lt;- abc(target=stat.obs, param=par.sim, sumstat=stat.sim, tol=.1, method =
"rejection") 

## ABC with local linear regression correction without/with correction
## for heteroscedasticity 
##
lin &lt;- abc(target=stat.obs, param=par.sim, sumstat=stat.sim, tol=.1, hcorr =
FALSE, method = "loclinear", transf=c("none","log"))
linhc &lt;- abc(target=stat.obs, param=par.sim, sumstat=stat.sim, tol=.1, method =
"loclinear", transf=c("none","log")) 

## posterior summaries
##
linsum &lt;- summary(linhc, intvl = .9)
linsum
## compare with the rejection sampling
summary(linhc, unadj = TRUE, intvl = .9)

## posterior histograms
##
hist(linhc, breaks=30, caption=c(expression(mu),
expression(sigma^2))) 

## or send histograms to a pdf file
## Not run: 
hist(linhc, file="linhc", breaks=30, caption=c(expression(mu),
expression(sigma^2)))

## End(Not run)
## diagnostic plots: compare the 2 'abc' objects: "loclinear",
## "loclinear" with correction for heteroscedasticity
##
plot(lin, param=par.sim)
plot(linhc, param=par.sim)

## example illustrates how to add "true" parameter values to a plot
##
postmod &lt;- c(post.mu[match(max(post.mu[,2]), post.mu[,2]),1],
             post.sigma2[match(max(post.sigma2[,2]), post.sigma2[,2]),1])
plot(linhc, param=par.sim, true=postmod)


## artificial example to show how to use the logit tranformations
##
myp &lt;- data.frame(par1=runif(1000,-1,1),par2=rnorm(1000),par3=runif(1000,0,2))
mys &lt;- myp+rnorm(1000,sd=.1)
myt &lt;- c(0,0,1.5)
lin2 &lt;- abc(target=myt, param=myp, sumstat=mys, tol=.1, method =
"loclinear", transf=c("logit","none","logit"),logit.bounds = rbind(c(-1,
1), c(NA, NA), c(0, 2)))
summary(lin2)
</code></pre>

<hr>
<h2 id='cv4abc'>
Cross validation for Approximate Bayesian Computation (ABC)
</h2><span id='topic+cv4abc'></span>

<h3>Description</h3>

<p>This function performs a leave-one-out cross validation for ABC via
subsequent calls to the function <code><a href="#topic+abc">abc</a></code>. A potential use of
this function is to evaluate the effect of the choice of the tolerance
rate on the quality of the estimation with ABC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv4abc(param, sumstat, abc.out = NULL, nval, tols, statistic = "median",
prior.range = NULL, method, hcorr = TRUE, transf = "none", logit.bounds
= c(0,0), subset = NULL, kernel = "epanechnikov", numnet = 10, sizenet =
5, lambda = c(0.0001,0.001,0.01), trace = FALSE, maxit = 500, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv4abc_+3A_param">param</code></td>
<td>

<p>a vector, matrix or data frame of the simulated parameter values.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_sumstat">sumstat</code></td>
<td>

<p>a vector, matrix or data frame of the simulated summary statistics.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_abc.out">abc.out</code></td>
<td>

<p>an object of class <code>"abc"</code>, optional. If supplied, all arguments
passed to <code><a href="#topic+abc">abc</a></code> are extracted from this object,
except for <code>sumstat</code>, <code>param</code>, and <code>tol</code>, which
always have to be supplied as arguments.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_nval">nval</code></td>
<td>

<p>size of the cross-validation sample.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_tols">tols</code></td>
<td>

<p>a single tolerance rate or a vector of tolerance rates.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_statistic">statistic</code></td>
<td>

<p>a character string specifying the statistic to calculate a point
estimate from the posterior distribution of the
parameter(s). Possible values are <code>"median"</code> (default),
<code>"mean"</code>, or <code>"mode"</code>.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_prior.range">prior.range</code></td>
<td>

<p>a range to truncate the prior range.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_method">method</code></td>
<td>

<p>a character string indicating the type of ABC algorithm to be
applied.  Possible values are <code>"rejection"</code>,
<code>"loclinear"</code>, and <code>"neuralnet"</code>. See also
<code><a href="#topic+abc">abc</a></code>.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_hcorr">hcorr</code></td>
<td>

<p>logical, if <code>TRUE</code> (default) the conditional heteroscedastic
model is applied.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_transf">transf</code></td>
<td>

<p>a vector of character strings indicating the kind of transformation
to be applied to the parameter values. The possible values are
<code>"log"</code>, <code>"logit"</code>, and <code>"none"</code> (default), when no
is transformation applied. See also <code><a href="#topic+abc">abc</a></code>.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_logit.bounds">logit.bounds</code></td>
<td>

<p>a vector of bounds if <code>transf</code> is <code>"logit"</code>. These bounds
are applied to all parameters that are to be logit transformed.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_subset">subset</code></td>
<td>

<p>a logical expression indicating elements or rows to keep. Missing
values in <code>param</code> and/or <code>sumstat</code> are taken as
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_kernel">kernel</code></td>
<td>

<p>a character string specifying the kernel to be used when
<code>method</code> is <code>"loclinear"</code> or <code>"neuralnet"</code>. Defaults
to <code>"epanechnikov"</code>. See <code><a href="stats.html#topic+density">density</a></code> for details.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_numnet">numnet</code></td>
<td>

<p>the number of neural networks when <code>method</code> is
<code>"neuralnet"</code>. Defaults to 10. It indicates the number of times
the function <code>nnet</code> is called.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_sizenet">sizenet</code></td>
<td>

<p>the number of units in the hidden layer. Defaults to 5. Can be zero
if there are no skip-layer units. See <code><a href="nnet.html#topic+nnet">nnet</a></code> for more
details.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector or a single value indicating the weight decay when
<code>method</code> is <code>"neuralnet"</code>. See <code><a href="nnet.html#topic+nnet">nnet</a></code> for more
details. By default, 0.0001, 0.001, or 0.01 is randomly chosen for
each of the networks.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_trace">trace</code></td>
<td>

<p>logical, <code>TRUE</code> switches on tracing the optimization of
<code><a href="nnet.html#topic+nnet">nnet</a></code>. Applies only when <code>method</code> is
<code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_maxit">maxit</code></td>
<td>

<p>numeric, the maximum number of iterations. Defaults to 500. Applies
only when <code>method</code> is <code>"neuralnet"</code>. See also
<code><a href="nnet.html#topic+nnet">nnet</a></code>.</p>
</td></tr>
<tr><td><code id="cv4abc_+3A_...">...</code></td>
<td>

<p>other arguments passed to <code><a href="nnet.html#topic+nnet">nnet</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

  
<p>A simulation is selected repeatedly to be a validation simulation,
while the other simulations are used as training simulations. Each
time the function <code><a href="#topic+abc">abc</a></code> is called to estimate the
parameter(s). A total of <code>nval</code> validation simulations are
selected.
</p>
<p>The arguments of the function <code><a href="#topic+abc">abc</a></code> can be supplied in two
ways. First, simply give them as arguments when calling this function,
in which case <code>abc.out</code> can be <code>NULL</code>. Second, via an
existing object of class <code>"abc"</code>, here <code>abc.out</code>. WARNING:
when <code>abc.out</code> is supplied, the same <code>sumstat</code> and
<code>param</code> objects have to be used as in the original call to
<code><a href="#topic+abc">abc</a></code>. Column names of <code>sumstat</code> and <code>param</code> are
checked for match.
</p>
<p>See <code><a href="#topic+summary.cv4abc">summary.cv4abc</a></code> for calculating the prediction error
from an object of class <code>"cv4abc"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"cv4abc"</code>, which is a list with the following
elements
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The original calls to <code><a href="#topic+abc">abc</a></code> for each tolerance
rates.</p>
</td></tr>
<tr><td><code>cvsamples</code></td>
<td>
<p>Numeric vector of length <code>nval</code>, indicating
which rows of the <code>param</code> and <code>sumstat</code> matrices were used
as validation values.</p>
</td></tr>
<tr><td><code>tols</code></td>
<td>
<p>The tolerance rates.</p>
</td></tr>
<tr><td><code>true</code></td>
<td>
<p>The parameter values that served as validation values.</p>
</td></tr>
<tr><td><code>estim</code></td>
<td>
<p>The estimated parameter values.</p>
</td></tr>     
<tr><td><code>names</code></td>
<td>
<p>A list with two elements: <code>parameter.names</code> and
<code>statistics.names</code>. Both contain a vector of character strings
with the parameter and statistics names, respectively.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>The value of <code>.Random.seed</code> when <code>cv4abc</code> is
called.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+abc">abc</a></code>, <code><a href="#topic+plot.cv4abc">plot.cv4abc</a></code>, <code><a href="#topic+summary.cv4abc">summary.cv4abc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(abc.data)
data(musigma2)
## this data set contains five R objects, see ?musigma2 for
## details 

## cv4abc() calls abc(). Here we show two ways for the supplying
## arguments of abc(). 1st way: passing arguments directly. In this
## example only 'param', 'sumstat', 'tol', and 'method', while default
## values are used for the other arguments.
## Number of eval. should be much more greater in realistic settings
cv.rej &lt;- cv4abc(param=par.sim, sumstat=stat.sim, nval=5,
tols=c(.1,.2,.3), method="rejection")

## 2nd way: first creating an object of class 'abc', and then using it
## to pass its arguments to abc().
##
lin &lt;- abc(target=stat.obs, param=par.sim, sumstat=stat.sim, tol=.2,
method="loclinear", transf=c("none","log"))
cv.lin &lt;- cv4abc(param=par.sim, sumstat=stat.sim, abc.out=lin, nval=5,
tols=c(.1,.2,.3))

## using the plot method. Different tolerance levels are plotted with
## different heat.colors. Smaller the tolerance levels correspond to
## "more red" points.
## !!! consider using the argument 'exclude' (plot.cv4abc) to supress
## the plotting of any outliers that mask readibility !!!
plot(cv.lin, log=c("xy", "xy"), caption=c(expression(mu),
expression(sigma^2)))

## comparing with the rejection sampling
plot(cv.rej, log=c("", "xy"), caption=c(expression(mu), expression(sigma^2)))

## or printing results directly to a postscript file...
## Not run: 
plot(cv.lin, log=c("xy", "xy"), caption=c(expression(mu),
expression(sigma^2)), file="CVrej", postscript=TRUE)

## End(Not run)

## using the summary method to calculate the prediction error
summary(cv.lin)
## compare with rejection sampling
summary(cv.rej)
</code></pre>

<hr>
<h2 id='cv4postpr'>
Leave-one-our cross validation for model selection ABC
</h2><span id='topic+cv4postpr'></span>

<h3>Description</h3>

<p>This function performs a leave-one-out cross validation for model
selection with ABC via subsequent calls to the function
<code><a href="#topic+postpr">postpr</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv4postpr(index, sumstat, postpr.out = NULL, nval, tols, method,
subset = NULL, kernel = "epanechnikov", numnet = 10, sizenet = 5, lambda
= c(0.0001,0.001,0.01), trace = FALSE, maxit = 500, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv4postpr_+3A_index">index</code></td>
<td>
<p> a vector of model indices. It can be character or
numeric and will be coerced to factor. It must have the same length
as the number of rows in <code>sumstat</code> to indicate which row of
<code>sumstat</code> belong to which model.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_sumstat">sumstat</code></td>
<td>

<p>a vector, matrix or data frame of the simulated summary statistics.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_postpr.out">postpr.out</code></td>
<td>

<p>an object of class <code>"postpr"</code>, optional. If supplied, all arguments
passed to <code><a href="#topic+postpr">postpr</a></code> are extracted from this object,
except for <code>sumstat</code>, <code>index</code>, and <code>tols</code>, which
always have to be supplied as arguments.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_nval">nval</code></td>
<td>

<p>the size of the cross-validation sample for each model.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_tols">tols</code></td>
<td>

<p>a single tolerance rate or a vector of tolerance rates.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_method">method</code></td>
<td>

<p>a character string indicating the type of simulation required.
Possible values are <code>"rejection"</code>, <code>"mnlogistic"</code>,
<code>"neuralnet"</code>. See <code><a href="#topic+postpr">postpr</a></code> for details.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_subset">subset</code></td>
<td>

<p>a logical expression indicating elements or rows to keep. Missing
values in <code>index</code> and/or <code>sumstat</code> are taken as
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_kernel">kernel</code></td>
<td>

<p>a character string specifying the kernel to be used when
<code>method</code> is <code>"loclinear"</code> or <code>"neuralnet"</code>. Defaults
to <code>"epanechnikov"</code>. See <code><a href="stats.html#topic+density">density</a></code> for details.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_numnet">numnet</code></td>
<td>

<p>the number of neural networks when <code>method</code> is
<code>"neuralnet"</code>. Defaults to 10. It indicates the number of times
the function <code>nnet</code> is called.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_sizenet">sizenet</code></td>
<td>

<p>the number of units in the hidden layer. Defaults to 5. Can be zero
if there are no skip-layer units. See <code><a href="nnet.html#topic+nnet">nnet</a></code> for more
details.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector or a single value indicating the weight decay when
<code>method</code> is <code>"neuralnet"</code>. See <code><a href="nnet.html#topic+nnet">nnet</a></code> for more
details. By default, 0.0001, 0.001, or 0.01 is randomly chosen for
each of the networks.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_trace">trace</code></td>
<td>

<p>logical, <code>TRUE</code> switches on tracing the optimization of
<code><a href="nnet.html#topic+nnet">nnet</a></code>. Applies only when <code>method</code> is
<code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_maxit">maxit</code></td>
<td>

<p>numeric, the maximum number of iterations. Defaults to 500. Applies
only when <code>method</code> is <code>"neuralnet"</code>. See also
<code><a href="nnet.html#topic+nnet">nnet</a></code>.</p>
</td></tr>
<tr><td><code id="cv4postpr_+3A_...">...</code></td>
<td>

<p>other arguments passed to <code><a href="nnet.html#topic+nnet">nnet</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each model, a simulation is selected repeatedly to be a validation
simulation, while the other simulations are used as training
simulations. Each time the function <code><a href="#topic+postpr">postpr</a></code> is called to
estimate the parameter(s).
</p>
<p>Ideally, we want <code>nval</code> to be equal to the number of simulations
for each model, however, this might take too much time. Users are
warned not to choose a too large number of simulations (especially
when the neural networks are used). Beware that the actual number of
cross-validation estimation steps that need to be performed is
<code>nval</code>*the number of models.
</p>
<p>The arguments for the function <code><a href="#topic+postpr">postpr</a></code> can be supplied in
two ways. First, simply give them as arguments when calling this
function, in which case <code>postpr.out</code> can be <code>NULL</code>. Second,
via an existing object of class <code>"postpr"</code>, here
<code>postpr.out</code>. WARNING: when <code>postpr.out</code> is supplied, the
same <code>sumstat</code> and <code>param</code> objects have to be used as in the
original call to <code><a href="#topic+postpr">postpr</a></code>. Column names of <code>sumstat</code>
and <code>param</code> are checked for match.
</p>
<p>See <code><a href="#topic+summary.cv4postpr">summary.cv4postpr</a></code> for calculating the prediction
error from an object of class <code>"cv4postpr"</code> and
<code><a href="#topic+plot.cv4postpr">plot.cv4postpr</a></code> for visualizing the misclassification of
the models using barplots.
</p>


<h3>Value</h3>

<p>An object of class <code>"cv4postpr"</code>, which is a list with the following
elements
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The original calls to <code><a href="#topic+postpr">postpr</a></code> for each tolerance
rates.</p>
</td></tr>
<tr><td><code>cvsamples</code></td>
<td>
<p>Numeric vector of length <code>nval</code>*the number of
models, indicating which rows of <code>sumstat</code> were used as
validation values.</p>
</td></tr>
<tr><td><code>tols</code></td>
<td>
<p>The tolerance rates.</p>
</td></tr>
<tr><td><code>true</code></td>
<td>
<p>The true models.</p>
</td></tr>
<tr><td><code>estim</code></td>
<td>
<p>The estimated model probabilities.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method used.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>A list of two elements: <code>model</code> contains the model names,
and <code>statistics.names</code> the names of the summary statistics.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>The value of <code>.Random.seed</code> when <code>cv4postpr</code> is
called.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+postpr">postpr</a></code>, <code><a href="#topic+summary.cv4postpr">summary.cv4postpr</a></code>, <code><a href="#topic+plot.cv4postpr">plot.cv4postpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(abc.data)
data(human)
###Reduce the sample size of the simulations to reduce the running time.
###Do not do that with your own data!
ss&lt;-c(1:1000,50001:51000,100001:101000)
cv.modsel &lt;- cv4postpr(models[ss], stat.3pops.sim[ss,], nval=5, tols=c(.05,.1), method="rejection") 
summary(cv.modsel)
plot(cv.modsel, names.arg=c("Bottleneck", "Constant", "Exponential"))
</code></pre>

<hr>
<h2 id='expected.deviance'>
Expected deviance
</h2><span id='topic+expected.deviance'></span>

<h3>Description</h3>

<p>Model selection criterion based on posterior predictive distributions
and approximations of the expected deviance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expected.deviance(target, postsumstat, kernel = "gaussian", subset=NULL,
print=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expected.deviance_+3A_target">target</code></td>
<td>
  
<p>a vector of the observed summary statistics.</p>
</td></tr>
<tr><td><code id="expected.deviance_+3A_postsumstat">postsumstat</code></td>
<td>

<p>a vector, matrix or data frame of summary statistics simulated
a posteriori.</p>
</td></tr>
<tr><td><code id="expected.deviance_+3A_kernel">kernel</code></td>
<td>

<p>a character string specifying the kernel to be used when. Defaults
to <code>"gaussian"</code>. See <code><a href="stats.html#topic+density">density</a></code> for details.</p>
</td></tr>
<tr><td><code id="expected.deviance_+3A_subset">subset</code></td>
<td>
<p> a logical expression indicating elements or rows to
keep. Missing values in <code>postsumstat</code> are taken as
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="expected.deviance_+3A_print">print</code></td>
<td>
    
<p>prints out what percent of the distances have been zero.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements an approximation for the expected deviance
based on simulation performed a posteriori. Thus, after the posterior
distribution of parameters or the posterior model probabilities have
been determined, users need to re-simulate data using the posterior.
The Monte-Carlo estimate of the expected deviance is computed from the
simulated data as follows:
<code class="reqn">D=-\frac{2}{n}\sum_{j=1}^{n}\log(K_\epsilon(\parallel
  s^j-s_0\parallel))</code>, where n is number of simulations, <code class="reqn">K</code> is the
statistical kernel, <code class="reqn">\epsilon</code> is the error, i.e. difference
between the observed and simulated summary statistics below which
simualtions were accepted in the original call to
<code><a href="#topic+postpr">postpr</a></code>, the <code class="reqn">s^j</code>'s are the summary statistics
obtained from the posterior predictive simualtions, and <code class="reqn">s_0</code> are
the observed values of the summary statistics.  The expected devaince
averaged over the posterior distribution to compute a deviance
information criterion (DIC).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>expected.deviance</code></td>
<td>
<p>The approximate expected deviance.</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>The Euclidean distances for summary statistics simulated a
posteriori.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Francois O, Laval G (2011) Deviance information criteria for model
selection in approximate Bayesian computation
<em>arXiv</em>:<b>0240377</b>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function definitions
skewness &lt;- function(x) {
sk &lt;- mean((x-mean(x))^3)/(sd(x)^3)
return(sk)
}
kurtosis &lt;- function(x) {  
k &lt;- mean((x-mean(x))^4)/(sd(x)^4) - 3  
return(k)
}

## Observed summary statistics
obs.sumstat &lt;- c(2.004821, 3.110915, -0.7831861, 0.1440266) 

## Model 1 (Gaussian)
## ##################
## Simulate data
theta &lt;- rnorm(10000, 2, 10)
zeta &lt;- 1/rexp(10000, 1)
param &lt;- cbind(theta, zeta)
y &lt;- matrix(rnorm(200000, rep(theta, each = 20), sd = rep(sqrt(zeta),
each = 20)), nrow = 20, ncol = 10000)

## Calculate summary statistics
s &lt;- cbind(apply(y, 2, mean), apply(y, 2, sd), apply(y, 2, skewness),
apply(y, 2, kurtosis))

## ABC inference
gaus &lt;- abc(target=obs.sumstat, param = param, sumstat=s, tol=.1, hcorr =
FALSE, method = "loclinear")
param.post &lt;- gaus$adj.values

## Posterior predictive simulations
postpred.gaus &lt;- matrix(rnorm(20000, rep(param.post[,1], each = 20), sd
= rep(sqrt(param.post[,2]), each = 20)), nrow = 20, ncol = 1000)
statpost.gaus &lt;- cbind(apply(postpred.gaus, 2,
mean),apply(postpred.gaus, 2, sd),apply(postpred.gaus,
2,skewness),apply(postpred.gaus, 2,kurtosis))

# Computation of the expected deviance
expected.deviance(obs.sumstat, statpost.gaus)$expected.deviance
expected.deviance(obs.sumstat, statpost.gaus, kernel =
"epanechnikov")$expected.deviance

## Modele 2 (Laplace)
## ##################
## Simulate data
zeta &lt;- rexp(10000)
param &lt;- cbind(theta, zeta)
y &lt;- matrix(theta + sample(c(-1,1),200000, replace = TRUE)*rexp(200000,
rep(zeta, each = 20)), nrow = 20, ncol = 10000)

## Calculate summary statistics
s &lt;- cbind( apply(y, 2, mean), apply(y, 2, sd), apply(y, 2, skewness),
apply(y, 2, kurtosis))

## ABC inference
lapl &lt;- abc(target=obs.sumstat, param = param, sumstat=s, tol=.1, hcorr =
FALSE, method = "loclinear")
param.post &lt;- lapl$adj.values

## Posterior predictive simulations
postpred.lapl &lt;- matrix(param.post[,1] + sample(c(-1,1),20000, replace =
TRUE)*rexp(20000, rep(param.post[,2], each = 20)), nrow = 20, ncol =
1000)
statpost.lapl &lt;- cbind(apply(postpred.lapl, 2,
mean),apply(postpred.lapl, 2, sd),apply(postpred.lapl,
2,skewness),apply(postpred.lapl, 2,kurtosis))

## Computation of the expected deviance
expected.deviance(obs.sumstat, statpost.lapl)$expected.deviance
expected.deviance(obs.sumstat, statpost.lapl, kernel =
"epanechnikov")$expected.deviance

</code></pre>

<hr>
<h2 id='gfit'>
Goodness of fit
</h2><span id='topic+gfit'></span>

<h3>Description</h3>

<p>Perform a test for goodness-of-fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gfit(target, sumstat, nb.replicate, tol=.01, statistic=mean, subset=NULL, 
trace=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gfit_+3A_target">target</code></td>
<td>

<p>a data frame or vector of the observed summary statistic.</p>
</td></tr>   
<tr><td><code id="gfit_+3A_sumstat">sumstat</code></td>
<td>

<p>a vector, matrix or data frame of the simulated summary statistics.</p>
</td></tr>
<tr><td><code id="gfit_+3A_nb.replicate">nb.replicate</code></td>
<td>

<p>number of replicates used to estimate the null distribution of the 
goodness-of-fit statistic.</p>
</td></tr>
<tr><td><code id="gfit_+3A_tol">tol</code></td>
<td>

<p>a tolerance rate. Defaults to 0.01 </p>
</td></tr>
<tr><td><code id="gfit_+3A_statistic">statistic</code></td>
<td>

<p>define the goodness-of-fit statistic. Typical values are <code>median</code> 
(default), <code>mean</code>, or <code>max</code>. When using <code>median</code> fo 
instance, the g.o.f. statistic is the median of the distance between 
observed and accepted summary statistics.</p>
</td></tr>
<tr><td><code id="gfit_+3A_subset">subset</code></td>
<td>

<p>optional. A logical expression indicating elements or rows to keep. 
Missing values in <code>sumstat</code> are taken as <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gfit_+3A_trace">trace</code></td>
<td>

<p>a boolean indicating if a trace should be displayed when calling the 
function. Default to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null distribution is estimated using already performed simulations 
contained in <code>sumstat</code> as pseudo-observed datasets. For each 
pseudo-observed dataset, the rejection algorithm is performed to obtain 
a value of the goodness-of-fit statistic. A better estimate of the 
P-value is obtained for larger <code>nb.replicate</code> but the running time
of the function is increased. 
</p>


<h3>Value</h3>

<p>An object of class <code>"gfit"</code>, which is a list with the following
elements
</p>
<table>
<tr><td><code>dist.obs</code></td>
<td>

<p>the value of the goodness-of-fit statistic for the data.</p>
</td></tr>
<tr><td><code>dist.sim</code></td>
<td>

<p>a vector of size <code>nb.replicate</code>. It is a sample of the null 
distribution of the test statistic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Louisiane Lemaire and Michael Blum.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+abc">abc</a></code>, <code><a href="#topic+plot.gfit">plot.gfit</a></code>, <code><a href="#topic+summary.gfit">summary.gfit</a></code>, 
<code><a href="#topic+gfitpca">gfitpca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## human demographic history
require(abc.data)
data(human)

##  Perform a test of goodness-of-fit.
##  The data are the European data and we test the fit of the bottleneck 
## model (good fit) and of the constant-size population model (poor fit) 
## Use larger values of \code{nb.replicate} (e.g. 1000)
## for real applications
res.gfit.bott=gfit(target=stat.voight["italian",], 
sumstat=stat.3pops.sim[models=="bott",], statistic=mean, nb.replicate=10)
res.gfit.const=gfit(target=stat.voight["italian",], 
sumstat=stat.3pops.sim[models=="const",], statistic=mean, nb.replicate=10)


## Plot the distribution of the null statistic and indicate where is the 
## observed value.
plot(res.gfit.bott, main="Histogram under H0")
## Call the function \code{summary}
## It computes the P-value, call \code{summary} on the vector 
## \code{dist.sim} and returns the value of the observed statistic
summary(res.gfit.bott)
</code></pre>

<hr>
<h2 id='gfitpca'>
Goodness of fit with principal component analysis
</h2><span id='topic+gfitpca'></span>

<h3>Description</h3>

<p>Perform a priori goodness of fit using the two first components 
obtained with PCA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gfitpca(target, sumstat, index, cprob=0.1, xlim=NULL, ylim=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gfitpca_+3A_target">target</code></td>
<td>

<p>a data frame or vector of the observed summary statistic.</p>
</td></tr>
<tr><td><code id="gfitpca_+3A_sumstat">sumstat</code></td>
<td>

<p>a matrix or data frame of the simulated summary statistics.</p>
</td></tr>
<tr><td><code id="gfitpca_+3A_index">index</code></td>
<td>

<p>a vector of models names. It must be character and have the same
length as the number of row in <code>sumstat</code> to indicate which row
belong to which model.</p>
</td></tr>
<tr><td><code id="gfitpca_+3A_cprob">cprob</code></td>
<td>

<p><code>cprob</code> is the proportion of points outside the displayed 
envelope. Default to 0.1 which corresponds to a 90% envelope.</p>
</td></tr>
<tr><td><code id="gfitpca_+3A_xlim">xlim</code>, <code id="gfitpca_+3A_ylim">ylim</code></td>
<td>

<p>optional, numeric vectors of length 2, giving the x and y coordinates
ranges.</p>
</td></tr>
<tr><td><code id="gfitpca_+3A_...">...</code></td>
<td>

<p>other parameters passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs PCA using the a priori simulated summary
statistics. It displays envelopes containing 1-<code>hprob</code> percent of
the simulations.
The projection of the observed summary statistics is displayed in
order to check if they are contained or not in the envelopes.
If the projection lies outside the envelope of a given model, it is
an indication of poor fit.
</p>


<h3>Author(s)</h3>

<p>Louisiane Lemaire and Michael Blum
</p>


<h3>See Also</h3>

<p><code><a href="#topic+abc">abc</a></code>, <code><a href="#topic+plot.gfit">plot.gfit</a></code>, <code><a href="#topic+summary.gfit">summary.gfit</a></code>, 
<code><a href="#topic+gfit">gfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## human demographic history
require(abc.data)
data(human)
## five R objects are loaded. See ?human and vignette("abc") for details.

## Perform a priori goodness of fit for 3 different demographic models
## The envelopes containing 90% of the simulations are displayed.
## For the European data, a reasonable fit is only provided by the 
## bottleneck model.
## The number of simulations is reduced to improve speed (do not do that
## with your own data)
index&lt;-c(1:5000,50001:55000,100001:105000)
gfitpca(target=stat.voight["italian",], sumstat=stat.3pops.sim[index,],
index=models[index], cprob=0.1)
</code></pre>

<hr>
<h2 id='hist.abc'>
Posterior histograms
</h2><span id='topic+hist.abc'></span>

<h3>Description</h3>

<p>Histograms of posterior samples from objects of class <code>"abc"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'abc'
hist(x, unadj = FALSE, true = NULL, file = NULL,
postscript = FALSE, onefile = TRUE, ask =
!is.null(deviceIsInteractive()), col.hist = "grey", col.true = "red",
caption = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist.abc_+3A_x">x</code></td>
<td>

<p>an object of class <code>"abc"</code>.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_unadj">unadj</code></td>
<td>

<p>logical, if <code>TRUE</code> the unadjusted values are plotted even
if method is <code>"loclinear"</code> or <code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_true">true</code></td>
<td>

<p>the true parameter value(s), if known. Vertical bar(s) are drawn at
the true value(s). If more than one parameters were estimated, a
vector of the true values have to be supplied.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_file">file</code></td>
<td>

<p>a character string giving the name of the file. See
<code><a href="grDevices.html#topic+postscript">postscript</a></code> for details on accepted file names. If
<code>NULL</code> (the default) histograms are printed to the null device
(e.g. <code><a href="grDevices.html#topic+X11">X11</a></code>). If not <code>NULL</code> histograms are printed
on a <code><a href="grDevices.html#topic+pdf">pdf</a></code> device. See also <code><a href="grDevices.html#topic+postscript">postscript</a></code>.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_postscript">postscript</code></td>
<td>

<p>logical; if <code>FALSE</code> (default) histograms are printed on a
<code><a href="grDevices.html#topic+pdf">pdf</a></code> device, if <code>TRUE</code> on a <code>postscript</code> device.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_onefile">onefile</code></td>
<td>

<p>logical, if <code>TRUE</code> (the default) allow multiple figures in one
file.  If <code>FALSE</code>, generate a file name containing the page
number for each page. See <code><a href="grDevices.html#topic+postscript">postscript</a></code> for further details.</p>
</td></tr> 
<tr><td><code id="hist.abc_+3A_ask">ask</code></td>
<td>

<p>logical; if <code>TRUE</code> (the default), the user is asked before each
plot, see <code>par(ask=.)</code>.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_col.hist">col.hist</code></td>
<td>

<p>the colour of the histograms.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_col.true">col.true</code></td>
<td>

<p>the colour of the vertical bar at the true value.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_caption">caption</code></td>
<td>

<p>captions to appear above the histogram(s); <code>character</code> vector
of valid graphics annotations, see <code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>
for details. When <code>NULL</code> (default), <code>parnames</code> are used,
which are extracted from <code>x</code> (see <code><a href="#topic+abc">abc</a></code>). Can be
set to <code>NA</code> to suppress all captions.</p>
</td></tr>
<tr><td><code id="hist.abc_+3A_...">...</code></td>
<td>

<p>other parameters passed to <code>hist</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of length equal to the number of parameters, the elements of
which are objects of class <code>"histogram"</code>. See <code><a href="graphics.html#topic+hist">hist</a></code>
for details.</p>


<h3>See Also</h3>

<p><code><a href="#topic+abc">abc</a></code>, <code><a href="#topic+plot.abc">plot.abc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?abc for examples 
</code></pre>

<hr>
<h2 id='plot.abc'>
Diagnostic plots for ABC
</h2><span id='topic+plot.abc'></span>

<h3>Description</h3>

<p>A plotting utile for quick visualization of the quality of an ABC
analysis from an object of class <code>"abc"</code> generated with methods
<code>"loclinear"</code> or <code>"neuralnet"</code> (see <code><a href="#topic+abc">abc</a></code> for
details). Four plots are currently available: a density plot of the
prior distribution, a density plot of the posterior distribution, a
scatter plot of the Euclidean distances as a function of the parameter
values, and a Normal Q-Q plot of the residuals from the
regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'abc'
plot(x, param, subsample = 1000, true = NULL, file = NULL,
postscript = FALSE, onefile = TRUE, ask =
!is.null(deviceIsInteractive()), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.abc_+3A_x">x</code></td>
<td>

<p>an object of class <code>"abc"</code> generated with methods
<code>"loclinear"</code> or <code>"neuralnet"</code> (see <code><a href="#topic+abc">abc</a></code> for
details).</p>
</td></tr>
<tr><td><code id="plot.abc_+3A_param">param</code></td>
<td>

<p>a vector or matrix of parameter values from the simulations that
were used in the original call to <code><a href="#topic+abc">abc</a></code>.</p>
</td></tr>
<tr><td><code id="plot.abc_+3A_subsample">subsample</code></td>
<td>

<p>the number of rows (simulations) to be plotted. Rows are randomly
selected from <code>param</code>. 
</p>
</td></tr>
<tr><td><code id="plot.abc_+3A_true">true</code></td>
<td>

<p>a vector of true parameter values, if known. Vertical lines are
drawn at these values.</p>
</td></tr>
<tr><td><code id="plot.abc_+3A_file">file</code></td>
<td>

<p>a character string giving the name of the file. See
<code><a href="grDevices.html#topic+postscript">postscript</a></code> for details on accepted file names. If
<code>NULL</code> (the default) plots are printed to the null device
(e.g. <code><a href="grDevices.html#topic+X11">X11</a></code>). If not <code>NULL</code> plots are printed on a
<code><a href="grDevices.html#topic+pdf">pdf</a></code> device. See also <code><a href="grDevices.html#topic+postscript">postscript</a></code>.</p>
</td></tr>
<tr><td><code id="plot.abc_+3A_postscript">postscript</code></td>
<td>

<p>logical; if <code>FALSE</code> (default) plots are printed on a
<code><a href="grDevices.html#topic+pdf">pdf</a></code> device, if <code>TRUE</code> on a <code>postscript</code> device.</p>
</td></tr>
<tr><td><code id="plot.abc_+3A_onefile">onefile</code></td>
<td>

<p>logical, if <code>TRUE</code> (the default) allow multiple figures in one
file.  If <code>FALSE</code>, generate a file name containing the page
number for each page. See <code><a href="grDevices.html#topic+postscript">postscript</a></code> for further details.</p>
</td></tr> 
<tr><td><code id="plot.abc_+3A_ask">ask</code></td>
<td>

<p>logical; if <code>TRUE</code> (the default), the user is asked before each plot, see
<code>par(ask=.)</code>.</p>
</td></tr>
<tr><td><code id="plot.abc_+3A_...">...</code></td>
<td>

<p>other parameters passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to use this function, one of the regression correction
methods had to be used in the original call to <code><a href="#topic+abc">abc</a></code>,
i.e. <code>"loclinear"</code> or <code>"neuralnet"</code> (see <code><a href="#topic+abc">abc</a></code>
for details). Four plots are printed for each parameter. (i) A density
plot of the prior distribution. (ii) A density plot of the posterior
distribution using the regression correction (red thick lines) and,
for reference, using the simple rejection method (black fine
lines). The prior distribution (in the posterior distributions' range)
is also displayed (dashed lines). (iii) A scatter plot of the log
Euclidean distances as a function of the true parameter values. Points
corresponding to the accepted simulations are displayed in red. (iv) A
Normal Q-Q plot of the residuals from the regression, thus from
<code><a href="stats.html#topic+lsfit">lsfit</a></code> when method was <code>"loclinear"</code>, and from
<code><a href="nnet.html#topic+nnet">nnet</a></code> when method was <code>"neuralnet"</code> in the original
<code><a href="#topic+abc">abc</a></code>.
</p>
<p>For plots (i) and (iii) not the whole data but a subsample is used,
the size of which can be is given by <code>subsample</code>. This is to
avoid plots that may take too much time to print.
</p>
<p>If a parameter transformation was applied in the original call to
<code><a href="#topic+abc">abc</a></code>, the same transformations are applied to the
parameters for plotting (on plots (i)-(iii)).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+abc">abc</a></code>, <code><a href="#topic+hist.abc">hist.abc</a></code>, <code><a href="#topic+summary.abc">summary.abc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?abc for examples
</code></pre>

<hr>
<h2 id='plot.cv4abc'>
Cross-validation plots for ABC
</h2><span id='topic+plot.cv4abc'></span>

<h3>Description</h3>

<p>Plotting method for cross-validation ABC objects. Helps to visually
evaluate the quality of the estimation and/or the effect of the
tolerance level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv4abc'
plot(x, exclude = NULL, log = NULL, file = NULL,
postscript = FALSE, onefile = TRUE, ask =
!is.null(deviceIsInteractive()), caption = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cv4abc_+3A_x">x</code></td>
<td>

<p>an object of class <code>"cv4abc"</code>.</p>
</td></tr>
<tr><td><code id="plot.cv4abc_+3A_exclude">exclude</code></td>
<td>

<p>a vector of row indices indicating which rows should be excluded from
plotting. Useful when the prior distribution has a long tail.</p>
</td></tr>
<tr><td><code id="plot.cv4abc_+3A_log">log</code></td>
<td>

<p>character vector of the same length as the number of parameters in
the <code>"cv4abc"</code> object. Allows plotting on a log scale. Possible
values are &quot;&quot; (normal scale) and &quot;xy&quot; (log scale for both the x and
y axis). &quot;x&quot; and &quot;y&quot; are possible as well, but not of any interest
here. Negative values are set to <code>NA</code> and there is a warning.</p>
</td></tr>
<tr><td><code id="plot.cv4abc_+3A_file">file</code></td>
<td>

<p>a character string giving the name of the file. See
<code><a href="grDevices.html#topic+postscript">postscript</a></code> for details on accepted file names. If
<code>NULL</code> (the default) plots are printed to the null device
(e.g. <code><a href="grDevices.html#topic+X11">X11</a></code>). If not <code>NULL</code> plots are printed on a
<code><a href="grDevices.html#topic+pdf">pdf</a></code> device. See also <code>postscript</code>.</p>
</td></tr>
<tr><td><code id="plot.cv4abc_+3A_postscript">postscript</code></td>
<td>

<p>logical; if <code>FALSE</code> (default) plots are
printed on a <code><a href="grDevices.html#topic+pdf">pdf</a></code> device, if <code>TRUE</code> on a
<code>postscript</code> device.</p>
</td></tr>
<tr><td><code id="plot.cv4abc_+3A_onefile">onefile</code></td>
<td>

<p>logical, if <code>TRUE</code> (the default) allow multiple
figures in one file.  If <code>FALSE</code>, generate a file name
containing the page number for each page. See
<code><a href="grDevices.html#topic+postscript">postscript</a></code> for further details.</p>
</td></tr>
<tr><td><code id="plot.cv4abc_+3A_ask">ask</code></td>
<td>

<p>logical; if <code>TRUE</code> (the default), the user is asked
before each plot, see <code>par(ask=.)</code>.</p>
</td></tr>
<tr><td><code id="plot.cv4abc_+3A_caption">caption</code></td>
<td>

<p>captions to appear above the plot(s); <code>character</code>
vector of valid graphics annotations, see
<code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>. By default, <code>parnames</code> from
<code>x</code> are extracted (see <code><a href="#topic+abc">abc</a></code>). Can be set to
<code>""</code> or <code>NA</code> to suppress all captions.</p>
</td></tr>
<tr><td><code id="plot.cv4abc_+3A_...">...</code></td>
<td>

<p>other parameters passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Different tolerance levels are plotted with <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code>.
Thus, the colors correspond to different levels of the tolerance rate
in an increasing order from red to yellow.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv4abc">cv4abc</a></code>, <code><a href="#topic+abc">abc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?cv4abc for examples
</code></pre>

<hr>
<h2 id='plot.cv4postpr'>
Barplot of model misclassification
</h2><span id='topic+plot.cv4postpr'></span>

<h3>Description</h3>

<p>Displays a barplot of either the proportion of simulations classified
to any of the models or the mean misclassification probabilities of
models for all tolerance levels in the <code>"cv4postpr"</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv4postpr'
plot(x, probs = FALSE, file = NULL, postscript
= FALSE, onefile = TRUE, ask = !is.null(deviceIsInteractive()), caption
= NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cv4postpr_+3A_x">x</code></td>
<td>

<p>an object of class <code>"cv4postpr"</code>.</p>
</td></tr>
<tr><td><code id="plot.cv4postpr_+3A_probs">probs</code></td>
<td>
<p> logical, if <code>TRUE</code> the mean posterior model
probabilities are plotted. If <code>FALSE</code> the frequencies of the
simulations classified to the different models (default).</p>
</td></tr>
<tr><td><code id="plot.cv4postpr_+3A_file">file</code></td>
<td>

<p>a character string giving the name of the file. See
<code><a href="grDevices.html#topic+postscript">postscript</a></code> for details on accepted file names. If
<code>NULL</code> (the default) plots are printed to the null device
(e.g. <code><a href="grDevices.html#topic+X11">X11</a></code>). If not <code>NULL</code> plots are printed on a
<code><a href="grDevices.html#topic+pdf">pdf</a></code> device. See also <code>postscript</code>.</p>
</td></tr>
<tr><td><code id="plot.cv4postpr_+3A_postscript">postscript</code></td>
<td>

<p>logical; if <code>FALSE</code> (default) plots are
printed on a <code><a href="grDevices.html#topic+pdf">pdf</a></code> device, if <code>TRUE</code> on a
<code>postscript</code> device.</p>
</td></tr>
<tr><td><code id="plot.cv4postpr_+3A_onefile">onefile</code></td>
<td>

<p>logical, if <code>TRUE</code> (the default) allow multiple
figures in one file.  If <code>FALSE</code>, generate a file name
containing the page number for each page. See
<code><a href="grDevices.html#topic+postscript">postscript</a></code> for further details.</p>
</td></tr>
<tr><td><code id="plot.cv4postpr_+3A_ask">ask</code></td>
<td>

<p>logical; if <code>TRUE</code> (the default), the user is asked
before each plot, see <code>par(ask=.)</code>.</p>
</td></tr>
<tr><td><code id="plot.cv4postpr_+3A_caption">caption</code></td>
<td>

<p>captions to appear above the plot(s); <code>character</code>
vector of valid graphics annotations, see
<code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>. Can be set to
<code>""</code> or <code>NA</code> to suppress all captions.</p>
</td></tr>
<tr><td><code id="plot.cv4postpr_+3A_...">...</code></td>
<td>

<p>other parameters passed to <code>barplot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model are distinguised with different intensities of the gray
colour. The first model in alphabetic order has the darkest colour. If
the classification of models is perfect (so that the frequency (or
probability) of each model is zero for all but the correct model) each
bar has a single colour of its corresponding model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv4postpr">cv4postpr</a></code>, <code><a href="#topic+summary.cv4postpr">summary.cv4postpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?cv4postpr for examples
</code></pre>

<hr>
<h2 id='plot.gfit'>
Goodness-of-fit plot for ABC
</h2><span id='topic+plot.gfit'></span>

<h3>Description</h3>

<p>Plotting method for goodness-of-fit ABC objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gfit'
plot(x, breaks="Freedman-Diaconis", main, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gfit_+3A_x">x</code></td>
<td>

<p>an object of class <code>"gfit"</code>.</p>
</td></tr>
<tr><td><code id="plot.gfit_+3A_breaks">breaks</code></td>
<td>

<p>number of cells for the histogram. Defaults to &quot;Freedman-Diaconis&quot;.</p>
</td></tr>
<tr><td><code id="plot.gfit_+3A_main">main</code></td>
<td>

<p>title for the plot</p>
</td></tr>
<tr><td><code id="plot.gfit_+3A_...">...</code></td>
<td>

<p>other parameters passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the distribution of the statistic under the null hypothesis and 
indicate where is the observed value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gfit">gfit</a></code>, <code><a href="#topic+abc">abc</a></code>, <code><a href="#topic+summary.gfit">summary.gfit</a></code>, 
<code><a href="graphics.html#topic+hist">hist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see ?gfit for examples
</code></pre>

<hr>
<h2 id='postpr'>
Estimating posterior model probabilities
</h2><span id='topic+postpr'></span>

<h3>Description</h3>

<p>Model selection with Approximate Bayesian Computation (ABC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>postpr(target, index, sumstat, tol, subset = NULL, method, corr=TRUE,
kernel="epanechnikov", numnet = 10, sizenet = 5, lambda =
c(0.0001,0.001,0.01), trace = TRUE, maxit = 500, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="postpr_+3A_target">target</code></td>
<td>

<p>a vector of the observed summary statistics.</p>
</td></tr>
<tr><td><code id="postpr_+3A_index">index</code></td>
<td>

<p>a vector of model indices. It can be character or numeric and
will be coerced to factor. It must have the same length as
<code>sumstat</code> to indicate which row of <code>sumstat</code> belong to
which model.</p>
</td></tr>
<tr><td><code id="postpr_+3A_sumstat">sumstat</code></td>
<td>

<p>a vector, matrix or data frame of the simulated summary statistics.</p>
</td></tr>
<tr><td><code id="postpr_+3A_tol">tol</code></td>
<td>

<p>numeric, the required proportion of points nearest the target
values (tolerance), or a vector of the desired tolerance values. If
a vector is given</p>
</td></tr>
<tr><td><code id="postpr_+3A_subset">subset</code></td>
<td>

<p>a logical expression indicating elements or rows to keep. Missing
values in <code>index</code> and/or <code>sumstat</code> are taken as <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="postpr_+3A_method">method</code></td>
<td>

<p>a character string indicating the type of simulation required.
Possible values are <code>"rejection"</code>, <code>"mnlogistic"</code>,
<code>"neuralnet"</code>. See <code>Details</code>.</p>
</td></tr>
<tr><td><code id="postpr_+3A_corr">corr</code></td>
<td>

<p>logical, if <code>TRUE</code> (default) posterior model probabilities are corrected
for the number of simulations performed for each model. If equal
number of simulations are available for all models, <code>corr</code> has
no effect.</p>
</td></tr>
<tr><td><code id="postpr_+3A_kernel">kernel</code></td>
<td>

<p>a character string specifying the kernel to be used when method is
<code>"mnlogistic"</code> or <code>"neuralnet"</code>. Defaults to
&quot;epanechnikov&quot;. See <code><a href="stats.html#topic+density">density</a></code> for details.</p>
</td></tr>
<tr><td><code id="postpr_+3A_numnet">numnet</code></td>
<td>

<p>the number of neural networks when method is <code>"neuralnet"</code>. It
corresponds to the number of times the function <code>nnet</code> is called.</p>
</td></tr>  
<tr><td><code id="postpr_+3A_sizenet">sizenet</code></td>
<td>

<p>the number of units in the hidden layer. Can be zero if there are
no skip-layer units.</p>
</td></tr>
<tr><td><code id="postpr_+3A_lambda">lambda</code></td>
<td>

<p>a numeric vector or a single value indicating the weight decay when
method is <code>"neuralnet"</code>. By default, 0.0001, 0.001, or 0.01 is
randomly chosen for the each of the networks. See <code><a href="nnet.html#topic+nnet">nnet</a></code>
for more details.</p>
</td></tr>
<tr><td><code id="postpr_+3A_trace">trace</code></td>
<td>

<p>logical, <code>TRUE</code> switches on tracing the
optimization of <code><a href="nnet.html#topic+nnet">nnet</a></code> (applies when method is
<code>"neuralnet"</code>).</p>
</td></tr>
<tr><td><code id="postpr_+3A_maxit">maxit</code></td>
<td>

<p>numeric, the maximum number of iterations. Defaults to 500. See also
<code><a href="nnet.html#topic+nnet">nnet</a></code>.</p>
</td></tr>
<tr><td><code id="postpr_+3A_...">...</code></td>
<td>

<p>other arguments passed on from <code>nnet</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the posterior model probabilities.  Simulations
have to be performed with at least two distinct models. When method is
<code>"rejection"</code>, the posterior probability of a given model is
approximated by the proportion of accepted simulations given this
model. This approximation holds when the different models are a priori
equally likely, and the same number of simulations is performed for
each model. When method is <code>"mnlogistic"</code> the posterior model
probabilities are estimated using a multinomial logistic regression as
implemented in the function <code><a href="mgcv.html#topic+multinom">multinom</a></code> from the package
<code><a href="nnet.html#topic+nnet">nnet</a></code>. When method is <code>"neuralnet"</code>, neural networks
are used to predict the probabilities of models based on the observed
statistics using <code><a href="nnet.html#topic+nnet">nnet</a></code>. This method can be useful if many
summary statistics are used.
</p>
<p>Names for the summary statistics are strongly recommended. Names can
be supplied as colnames to <code>sumstat</code> (and target). If no names are
supplied S1, S2, ... to summary statistics will be assigned to
parameters and the user will be warned.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"postpr"</code>, containing the following
components:
</p>
<table>
<tr><td><code>pred</code></td>
<td>
<p>a vector of model probabilities when method is
<code>"mnlogistic"</code> or <code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code>values</code></td>
<td>
<p>the vector of model indices in the accepted region using
the rejection method.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>vector of regression weights when method is
<code>"mnlogistic"</code> or <code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code>ss</code></td>
<td>
<p>summary statistics in the accepted region.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the original call.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>a logical vector indicating the elements or rows that
were excluded, including both <code>NA</code>/<code>NaN</code>'s and
elements/rows selected by <code>subset</code></p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the method used, i.e.
<code>"rejection"</code>, <code>"mnlogistic"</code> or <code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code>corr</code></td>
<td>
<p>logical, if <code>TRUE</code> the posterior model probabilities
are corrected for the number of simulations performed for each
model.</p>
</td></tr>
<tr><td><code>nmodels</code></td>
<td>
<p>the number of simulations performed for each model a
priori.</p>
</td></tr>
<tr><td><code>models</code></td>
<td>

<p>a character vector of model names (a priori).</p>
</td></tr>
<tr><td><code>numstat</code></td>
<td>
<p>the number of summary statistics used.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>a list of two elements: <code>model</code> contains the model names,
and <code>statistics.names</code> the names of the summary statistics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Katalin Csillery, Olivier Francois and Michael Blum with some
initial code from Mark Beaumont.
</p>


<h3>References</h3>

<p>Beaumont, M.A. (2008) Joint determination of topology, divergence
time, and immigration in population trees. In <em>Simulation,
Genetics, and Human Prehistory</em> (Matsumura, S., Forster, P. and
Renfrew, C., eds) McDonald Institute for Archaeological Research
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.postpr">summary.postpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## an artifical example
ss &lt;- cbind(runif(1000),rt(1000,df=20))
postpr(target=c(3), index=c(rep("norm",500),rep("t",500)),
sumstat=ss[,1], tol=.1, method="rejection")

## human demographic history
require(abc.data)
data(human)
## five R objects are loaded. See ?human and vignette("abc") for details.

## illustrate the informativeness of two summary statistics: mean and
## variance of Tajima's D
par(mfcol = c(1,3))
boxplot(stat.3pops.sim[,"pi"]~models, main="Mean nucleotide diversity")
boxplot(stat.3pops.sim[,"TajD.m"]~models, main="Mean Tajima's D")
boxplot(stat.3pops.sim[,"TajD.v"]~models, main="Var in Tajima's D")

## model selection with ABC for the European population


modsel.it &lt;- postpr(stat.voight["italian",], models, stat.3pops.sim, tol=.05, method="mnlogistic")
summary(modsel.it)

## In Europe, the most supported model
## is a population bottleneck 
## Check that in Africa, population expansion is the most supported model, while in
##  Asia, it is a population bottleneck
##modsel.ha &lt;- postpr(stat.voight["hausa",], models, stat.3pops.sim, 
##tol=.05, method="mnlogistic")
##modsel.ch &lt;- postpr(stat.voight["chinese",], models, stat.3pops.sim,
## tol=.05, method="mnlogistic")


</code></pre>

<hr>
<h2 id='summary.abc'>
Summaries of posterior samples generated by ABC algortithms
</h2><span id='topic+summary.abc'></span><span id='topic+getmode'></span>

<h3>Description</h3>

<p>Calculates simple summaries of posterior samples: the minimum and
maximum, the weighted mean, median, mode, and credible intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'abc'
summary(object, unadj = FALSE, intvl = .95, print = TRUE,
digits = max(3, getOption("digits")-3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.abc_+3A_object">object</code></td>
<td>

<p>an object of class <code>"abc"</code>.</p>
</td></tr>
<tr><td><code id="summary.abc_+3A_unadj">unadj</code></td>
<td>

<p>logical, if TRUE it forces to plot the unadjusted values when <code>method</code>
is <code>"loclinear"</code> or <code>"neuralnet"</code>.</p>
</td></tr>
<tr><td><code id="summary.abc_+3A_intvl">intvl</code></td>
<td>

<p>size of the symmetric credible interval.</p>
</td></tr>
<tr><td><code id="summary.abc_+3A_print">print</code></td>
<td>

<p>logical, if <code>TRUE</code> prints messages. Mainly for internal use.</p>
</td></tr>
<tr><td><code id="summary.abc_+3A_digits">digits</code></td>
<td>

<p>the digits to be rounded to. Can be a vector of the same length as the
number of parameters, when each parameter is rounded to its
corresponding digits.</p>
</td></tr>
<tr><td><code id="summary.abc_+3A_...">...</code></td>
<td>

<p>other arguments passed to <code>density</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If method is <code>"rejection"</code> in the original call to
<code><a href="#topic+abc">abc</a></code>, posterior means, medians, modes and percentiles
defined by <code>intvl</code>, 95 by default (credible intervals) are
calculated. If a regression correction was used (i.e. method is
<code>"loclinear"</code> or <code>"neuralnet"</code> in the original call to
<code><a href="#topic+abc">abc</a></code>) the weighted posterior means, medians, modes and
percentiles are calculated.
</p>
<p>To calculate the mode, parameters are passed on from
<code><a href="stats.html#topic+density.default">density.default</a></code>. Note that the posterior mode can be
rather different depending on the parameters to estimate the
density.  
</p>


<h3>Value</h3>

<p>The returned value is an object of class <code>"table"</code>. The rows are,
</p>
<table>
<tr><td><code>Min.</code></td>
<td>
<p>minimun</p>
</td></tr>
<tr><td><code>Lower perc.</code></td>
<td>
<p>lower percentile</p>
</td></tr>
<tr><td><code>Median</code></td>
<td>
<p>or weighted median</p>
</td></tr>
<tr><td><code>Mean</code></td>
<td>
<p>or weighted mean</p>
</td></tr>
<tr><td><code>Mode</code></td>
<td>
<p>or weighted mode</p>
</td></tr>
<tr><td><code>Upper perc.</code></td>
<td>
<p>upper percentile</p>
</td></tr>
<tr><td><code>Max.</code></td>
<td>
<p>maximum</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+abc">abc</a></code>,  <code><a href="#topic+hist.abc">hist.abc</a></code>, <code><a href="#topic+plot.abc">plot.abc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?abc for examples
</code></pre>

<hr>
<h2 id='summary.cv4abc'>
Calculates the cross-validation prediction error
</h2><span id='topic+summary.cv4abc'></span>

<h3>Description</h3>

<p>This function calculates the prediction error from an object of class
<code>"cv4abc"</code> for each parameter and tolerance level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv4abc'
summary(object, print = TRUE, digits = max(3,
getOption("digits")-3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cv4abc_+3A_object">object</code></td>
<td>

<p>an object of class <code>"abc"</code>.</p>
</td></tr>
<tr><td><code id="summary.cv4abc_+3A_print">print</code></td>
<td>

<p>logical, if <code>TRUE</code> prints messages. Mainly for internal use.</p>
</td></tr>
<tr><td><code id="summary.cv4abc_+3A_digits">digits</code></td>
<td>

<p>the digits to be rounded to. Can be a vector of the same length as the
number of parameters, when each parameter is rounded to its
corresponding digits.</p>
</td></tr>
<tr><td><code id="summary.cv4abc_+3A_...">...</code></td>
<td>

<p>other arguments passed to <code>density</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The prediction error is calculated as
<code class="reqn">\frac{\sum((\theta^{*}-\theta)^2)}{nval\times Var(\theta)}</code>, where
<code class="reqn">\theta</code> is the true parameter value, <code class="reqn">\theta^{*}</code> is the
predicted parameter value, and <code class="reqn">nval</code> is the number of points where true and predicted values are compared.
</p>


<h3>Value</h3>

  
<p>The returned value is an object of class <code>"table"</code>, where the
columns correspond to the parameters and the rows to the different
tolerance levels.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv4abc">cv4abc</a></code>, <code><a href="#topic+plot.cv4abc">plot.cv4abc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?cv4abc for examples
</code></pre>

<hr>
<h2 id='summary.cv4postpr'>
Confusion matrix and misclassification probabilities of models
</h2><span id='topic+summary.cv4postpr'></span>

<h3>Description</h3>

<p>This function calculates the confusion matrix and the mean
misclassification probabilities of models from an object of class
<code>"cv4postpr"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv4postpr'
summary(object, probs = TRUE, print = TRUE, digits =
max(3, getOption("digits")-3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cv4postpr_+3A_object">object</code></td>
<td>

<p>an object of class <code>"cv4postpr"</code>.</p>
</td></tr>
<tr><td><code id="summary.cv4postpr_+3A_probs">probs</code></td>
<td>

<p>logical, if <code>TRUE</code> (default), mean posterior model
probabilities are returned.</p>
</td></tr>
<tr><td><code id="summary.cv4postpr_+3A_print">print</code></td>
<td>

<p>logical, if <code>TRUE</code> prints the mean models probabilities.</p>
</td></tr>
<tr><td><code id="summary.cv4postpr_+3A_digits">digits</code></td>
<td>

<p>the digits to be rounded to.</p>
</td></tr>
<tr><td><code id="summary.cv4postpr_+3A_...">...</code></td>
<td>

<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

  
<p>If <code>probs</code>=<code>FALSE</code> a matrix with the frequencies of the
simulations classified to the different models (the confusion
matrix). If <code>probs</code>=<code>TRUE</code>, a list with two components:
</p>
<table>
<tr><td><code>conf.matrix</code></td>
<td>
<p>The confusion matrix.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>The mean model misclassification probabilities.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+cv4postpr">cv4postpr</a></code>, <code><a href="#topic+plot.cv4postpr">plot.cv4postpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?cv4postpr for examples
</code></pre>

<hr>
<h2 id='summary.gfit'>
Calculates the p-value of the goodness-of-fit test.
</h2><span id='topic+summary.gfit'></span>

<h3>Description</h3>

<p>This function calculates the p-value of the goodness-of-fit test from an 
object of class <code>"gfit"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gfit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.gfit_+3A_object">object</code></td>
<td>

<p>an object of class <code>"gfit"</code>.</p>
</td></tr>
<tr><td><code id="summary.gfit_+3A_...">...</code></td>
<td>

<p>other parameters passed to <code>summary</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It computes the P-value, call <code>summary</code> on the vector of 
statistics simulated under the null and returns the value of the 
observed statistic.
</p>


<h3>Value</h3>

<p>A list of the following elements
</p>
<table>
<tr><td><code>pvalue</code></td>
<td>

<p>P-value for goodness-of-fit.</p>
</td></tr>
<tr><td><code>s.dist.sim</code></td>
<td>

<p>the result of a call to the function <code>summary</code>. Provides a 
summary of the distribution of the goodness-of-fit statistic simulated
under the null.</p>
</td></tr>
<tr><td><code>dist.obs</code></td>
<td>

<p>the observed value goodness-of-fit statistic.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gfit">gfit</a></code>, <code><a href="#topic+abc">abc</a></code>, <code><a href="#topic+plot.gfit">plot.gfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## see ?gfit for exemples
</code></pre>

<hr>
<h2 id='summary.postpr'>
Posterior model probabilities and Bayes factors
</h2><span id='topic+summary.postpr'></span>

<h3>Description</h3>

<p>This function extracts the posterior model probabilities and
calculates the Bayes factors from an object of class <code>"postpr"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'postpr'
summary(object, rejection = TRUE, print = TRUE, digits
= max(3, getOption("digits")-3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.postpr_+3A_object">object</code></td>
<td>

<p>an object of class <code>"postpr"</code>.</p>
</td></tr>
<tr><td><code id="summary.postpr_+3A_rejection">rejection</code></td>
<td>

<p>logical, if method is <code>"mnlogistic"</code> or <code>"neuralnet"</code>,
should the approximate model probabilities based on the rejection
method returned.</p>
</td></tr>
<tr><td><code id="summary.postpr_+3A_print">print</code></td>
<td>

<p>logical, if <code>TRUE</code> prints the mean models probabilities.</p>
</td></tr>
<tr><td><code id="summary.postpr_+3A_digits">digits</code></td>
<td>

<p>the digits to be rounded to.</p>
</td></tr>
<tr><td><code id="summary.postpr_+3A_...">...</code></td>
<td>

<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components if method=<code>"rejection"</code>:
</p>
<table>
<tr><td><code>Prob</code></td>
<td>
<p>an object of class <code>table</code> of the posterior model
probabilities.</p>
</td></tr>
<tr><td><code>BayesF</code></td>
<td>
<p>an object of class <code>table</code> with the Bayes factors
between pairs of models.</p>
</td></tr>
</table>
<p>A list with the following components if method is <code>"mnlogistic"</code>
or <code>"neuralnet"</code> and rejection is <code>TRUE</code>:
</p>
<table>
<tr><td><code>rejection</code></td>
<td>
<p>a list with the same components as above</p>
</td></tr>
<tr><td><code>mnlogistic</code></td>
<td>
<p>a list with the same components as above</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+postpr">postpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?postpr for examples
</code></pre>

</main>


</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
