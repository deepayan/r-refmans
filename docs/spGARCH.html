<!DOCTYPE html><html lang="en"><head><title>Help for package spGARCH</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spGARCH}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#extractAIC.spARCH'>
<p>Computes the Akaike information criterion</p></a></li>
<li><a href='#fitted.spARCH'>
<p>Extract model fitted values</p></a></li>
<li><a href='#logLik.spARCH'>
<p>Extract logarithmic likelihood</p></a></li>
<li><a href='#plot.spARCH'>
<p>Descriptive plots for residuals of a fitted spatial ARCH model</p></a></li>
<li><a href='#prostate_cancer'>
<p>Logarithmic incidence rates of prostate cancer and covariates</p></a></li>
<li><a href='#qml.SARspARCH'>
<p>Maximum-likelihood estimation of a spatial autoregressive model with spatial ARCH residuals</p></a></li>
<li><a href='#qml.spARCH'>
<p>Maximum-likelihood estimation of a spatial ARCH model</p></a></li>
<li><a href='#residuals.spARCH'>
<p>Extract model residuals</p></a></li>
<li><a href='#sim.spARCH'><p>Simulation of spatial ARCH models</p></a></li>
<li><a href='#sim.spGARCH'><p>Simulation of spatial ARCH models</p></a></li>
<li><a href='#spARCH'><p>Output of Quasi-Maximum-Likelihood Estimation</p></a></li>
<li><a href='#spGARCH'><p>spGARCH - Package to fit spatial ARCH models</p></a></li>
<li><a href='#summary.spARCH'>
<p>Summary for spARCH object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatial ARCH and GARCH Models (spGARCH)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philipp Otto &lt;ph.otto789@gmail.com&gt;</td>
</tr>
<tr>
<td>Contact:</td>
<td>&lt;ph.otto789@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of functions to deal with spatial and spatiotemporal autoregressive conditional heteroscedasticity (spatial ARCH and GARCH models) by Otto, Schmid, Garthoff (2018, Spatial Statistics) &lt;<a href="https://doi.org/10.48550/arXiv.1609.00711">doi:10.48550/arXiv.1609.00711</a>&gt;: simulation of spatial ARCH-type processes (spARCH, exponential spARCH, complex spARCH); quasi-maximum-likelihood estimation of the parameters of spARCH models and spatial autoregressive models with spARCH disturbances, diagnostic checks, visualizations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.4), stats, truncnorm, Rsolnp, spdep, Matrix,
nleqslv, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen, Matrix</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-01 18:24:18 UTC; potto</td>
</tr>
<tr>
<td>Author:</td>
<td>Philipp Otto <a href="https://orcid.org/0000-0002-9796-6682"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-02 07:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='extractAIC.spARCH'>
Computes the Akaike information criterion
</h2><span id='topic+extractAIC.spARCH'></span>

<h3>Description</h3>

<p>The function extracts the log-likelihood of a spatial ARCH model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spARCH'
extractAIC(fit, scale, k = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractAIC.spARCH_+3A_fit">fit</code></td>
<td>

<p><code>spARCH</code> object (fitted model resulting of <code>qml.spARCH</code>).
</p>
</td></tr>
<tr><td><code id="extractAIC.spARCH_+3A_scale">scale</code></td>
<td>

<p>currently unused for <code>spARCH</code> objects.
</p>
</td></tr>
<tr><td><code id="extractAIC.spARCH_+3A_k">k</code></td>
<td>

<p>parameter specifying the weight for the penalizing term.
</p>
</td></tr>
<tr><td><code id="extractAIC.spARCH_+3A_...">...</code></td>
<td>

<p>Other arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numeric vector of length 2 is returned. The first element specify the <code>edf</code> (equivalent degree of freedom) and the Akaike information criterion is returned as second element.
</p>


<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>

<hr>
<h2 id='fitted.spARCH'>
Extract model fitted values
</h2><span id='topic+fitted.spARCH'></span>

<h3>Description</h3>

<p>The function extracts the fitted values of a spatial ARCH model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spARCH'
## S3 method for class 'spARCH'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.spARCH_+3A_object">object</code></td>
<td>
<p><code>spARCH</code> object generated by <code><a href="#topic+qml.spARCH">qml.spARCH</a></code> or <code><a href="#topic+qml.SARspARCH">qml.SARspARCH</a></code>.</p>
</td></tr>
<tr><td><code id="fitted.spARCH_+3A_...">...</code></td>
<td>

<p>Other arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fitted values extracted from the <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+residuals.spARCH">residuals.spARCH</a></code>, <code><a href="#topic+logLik.spARCH">logLik.spARCH</a></code>.
</p>

<hr>
<h2 id='logLik.spARCH'>
Extract logarithmic likelihood
</h2><span id='topic+logLik.spARCH'></span>

<h3>Description</h3>

<p>The function extracts the log-likelihood of a spatial ARCH model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spARCH'
## S3 method for class 'spARCH'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.spARCH_+3A_object">object</code></td>
<td>

<p><code>spARCH</code> Object of <code>qml.spARCH</code>.
</p>
</td></tr>
<tr><td><code id="logLik.spARCH_+3A_...">...</code></td>
<td>

<p>Other arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>logLik</code> object is returned.
</p>


<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+residuals.spARCH">residuals.spARCH</a></code>, <code><a href="#topic+fitted.spARCH">fitted.spARCH</a></code>.
</p>

<hr>
<h2 id='plot.spARCH'>
Descriptive plots for residuals of a fitted spatial ARCH model
</h2><span id='topic+plot.spARCH'></span>

<h3>Description</h3>

<p>The function depicts several descriptive statistics of the residuals of a fitted spatial ARCH model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spARCH'
## S3 method for class 'spARCH'
plot(x, which = c(1:3), ask, ..., qqline = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.spARCH_+3A_x">x</code></td>
<td>
<p><a href="#topic+spARCH-class">spARCH</a> object generated by <code><a href="#topic+qml.spARCH">qml.spARCH</a></code> or <code><a href="#topic+qml.SARspARCH">qml.SARspARCH</a></code>.</p>
</td></tr>
<tr><td><code id="plot.spARCH_+3A_which">which</code></td>
<td>

<p>Index number of plot to be returned.
</p>
</td></tr>
<tr><td><code id="plot.spARCH_+3A_ask">ask</code></td>
<td>

<p>if <code>TRUE</code>, the user is asked before plotting the next figure.
</p>
</td></tr>
<tr><td><code id="plot.spARCH_+3A_...">...</code></td>
<td>

<p>Other arguments.
</p>
</td></tr>
<tr><td><code id="plot.spARCH_+3A_qqline">qqline</code></td>
<td>

<p>A line of the normal distribution for comparison is added to the Q-Q plot, if <code>qqline = TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>plot.spARCH</code> provides several descriptive plots to analyze the residuals of a fitted spatial ARCH model, namely (1) Moran's plot for residuals, (2) Moran's plot for squared residuals, and (3) Normal Q-Q plot for standardized residuals.
</p>


<h3>Note</h3>

<p>For details of <code>moran.plot</code> see: <code>help(moran.plot)</code>.
</p>


<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>

<hr>
<h2 id='prostate_cancer'>
Logarithmic incidence rates of prostate cancer and covariates
</h2><span id='topic+prostate_cancer'></span>

<h3>Description</h3>

<p>The dataset contains logarithmic incidence rates from the National Cancer Institute and Centers for Disease, Control and Prevention (State Cancer Profiles) and factor loadings of a set of covariates. The incidence rates are 5-year averages from 2008 to 2012 in several southeastern states (Arkansas, Louisiana, Mississippi, Tennessee, North and South Carolina, Georgia, Alabama, and Florida). Missing values were imputed by spatial averaging.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("prostate_cancer")</code></pre>


<h3>Format</h3>

<p>A list with three entries:
</p>

<dl>
<dt><code>data</code></dt><dd><p>a data frame; see below for details</p>
</dd>
<dt><code>B</code></dt><dd><p>a numeric matrix; weighting matrix B to run the example</p>
</dd>
<dt><code>W</code></dt><dd><p>a numeric matrix; weighting matrix W to run the example</p>
</dd>
</dl>

<p>The data frame contains 755 observations of the following 12 variables.
</p>

<dl>
<dt><code>log_incidence_rates</code></dt><dd><p>a numeric vector; logarithmic incidence rates of prostate cancer</p>
</dd>
<dt><code>F_1</code></dt><dd><p>a numeric vector; scores of factor 1 (environment: fine atmospheric particles and aerosols)</p>
</dd>
<dt><code>F_2</code></dt><dd><p>a numeric vector; scores of factor 2 (environment: particulate matter)</p>
</dd>
<dt><code>F_3</code></dt><dd><p>a numeric vector; scores of factor 3 (weather: solar radiation and temperature)</p>
</dd>
<dt><code>F_4</code></dt><dd><p>a numeric vector; scores of factor 4 (weather: temperature differences)</p>
</dd>
<dt><code>F_5</code></dt><dd><p>a numeric vector; scores of factor 5 (behavior: smoking)</p>
</dd>
<dt><code>F_6</code></dt><dd><p>a numeric vector; scores of factor 6 (behavior: drinking)</p>
</dd>
<dt><code>F_7</code></dt><dd><p>a numeric vector; scores of factor 7 (behavior: preventive health care)</p>
</dd>
<dt><code>F_8</code></dt><dd><p>a numeric vector; scores of factor 8 (behavior: physical activity)</p>
</dd>
<dt><code>F_9</code></dt><dd><p>a numeric vector; scores of factor 9 (health: overweight)</p>
</dd>
<dt><code>F_10</code></dt><dd><p>a numeric vector; scores of factor 10 (health: cholesterol and blood pressure)</p>
</dd>
<dt><code>PSA_test</code></dt><dd><p>a numeric vector;  percentage of positive results for a prostate-specific antigen (PSA) test</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://statecancerprofiles.cancer.gov/index.html">https://statecancerprofiles.cancer.gov/index.html</a>
</p>
<p>National Cancer Institute, Centers for Disease, Control and Prevention
</p>


<h3>References</h3>

<p>https://statecancerprofiles.cancer.gov/map/map.withimage.php?99&amp;001&amp;001&amp;00&amp;0&amp;02&amp;0&amp;1&amp;10
Otto, P. (2019). spGARCH: An R-Package for Spatial and Spatiotemporal ARCH and GARCH models To appear: The R Journal URL: https://arxiv.org/abs/1812.01871
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prostate_cancer)

## Not run: 

# Estimation (long running example)
formula &lt;- "log_incidence_rates ~ F_2 + F_10"
out     &lt;- qml.SARspARCH(formula, B = prostate_cancer$B, W = prostate_cancer$W,
                         type = "spARCH", data = prostate_cancer$data)

# Summary
summary(out)


## End(Not run)

</code></pre>

<hr>
<h2 id='qml.SARspARCH'>
Maximum-likelihood estimation of a spatial autoregressive model with spatial ARCH residuals
</h2><span id='topic+qml.SARspARCH'></span>

<h3>Description</h3>

<p>The function fits a spatial autoregressive model with spatial ARCH residuals using the maximum-likelihood approach. All parameters are jointly estimated. In addition, external regressor may be included in the mean equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qml.SARspARCH(formula, B, W, type = "spARCH", data = NULL,
              b = 2, start = NULL, eigen_v = NULL, control = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qml.SARspARCH_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot;): a symbolic description of the model to be fitted. The details of model specification are given under &quot;Details.&quot;  <code>y</code> must be a numeric vector of length <code>n</code> (dimension of the weighting matrix)
</p>
</td></tr>
<tr><td><code id="qml.SARspARCH_+3A_b">B</code></td>
<td>

<p><code>n</code> times <code>n</code> spatial weight matrix for the spatial autoregressive part
</p>
</td></tr>
<tr><td><code id="qml.SARspARCH_+3A_w">W</code></td>
<td>

<p><code>n</code> times <code>n</code> spatial weight matrix for the spatial ARCH residuals
</p>
</td></tr>
<tr><td><code id="qml.SARspARCH_+3A_type">type</code></td>
<td>

<p>type of spatial ARCH model to be fitted for the error process (see Details)
</p>
</td></tr>
<tr><td><code id="qml.SARspARCH_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment containing the variables in the model. If not found in data, the variables are taken from the working space.
</p>
</td></tr>
<tr><td><code id="qml.SARspARCH_+3A_b">b</code></td>
<td>

<p>parameter <code>b</code> for the E-spARCH model (<code>type = "exp"</code>), must be a (positive) natural number
</p>
</td></tr>
<tr><td><code id="qml.SARspARCH_+3A_start">start</code></td>
<td>

<p>vector of starting values for the numerical optimization of the log-likelihood (optional)
</p>
</td></tr>
<tr><td><code id="qml.SARspARCH_+3A_eigen_v">eigen_v</code></td>
<td>

<p>eigen values of B (optional)
</p>
</td></tr>
<tr><td><code id="qml.SARspARCH_+3A_control">control</code></td>
<td>

<p>list of control variables for iterative maximization of the log-likelihood
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>type = "spARCH"</code>, the functions fits a simple spatial autoregressive model with spatial ARCH residuals, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{Y} = \lambda \mathbf{B} \boldsymbol{Y} + \mathbf{X} \boldsymbol{\beta} + \boldsymbol{h}^{1/2} \boldsymbol{\varepsilon}
</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} = \alpha \boldsymbol{1}_n + \rho \mathbf{W} \boldsymbol{Y}^{(2)} \, .
</code>
</p>

<p>The distribution of the error term is assumed to be Gaussian.
</p>
<p>If <code>type = "log-ARCH"</code>, a spatial log-ARCH process is estimated for the error term, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln(\boldsymbol{h}) = \alpha \boldsymbol{1}_n + \rho \mathbf{W} g_b(\boldsymbol{\varepsilon}) \, .
</code>
</p>

<p>The function <code class="reqn">g_b</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">
g_b(\boldsymbol{\varepsilon}) = (\ln|\varepsilon(\boldsymbol{s}_1)|^{b}, \ldots, \ln|\varepsilon(\boldsymbol{s}_n)|^{b})'
</code>
</p>

<p>and the error term is also assumed to be Gaussian.
</p>
<p>The modelling equation gan be specified as for <code><a href="stats.html#topic+lm">lm</a></code>, i.e., as <code><a href="stats.html#topic+formula">formula</a></code> object. A typical model has the form <code>response ~ terms</code> where response is the (numeric) response vector and terms is a series of terms which specifies a linear predictor for <code>response</code>. A terms specification of the form <code>first + second</code> indicates all the terms in first together with all the terms in second with duplicates removed. A specification of the form <code>first:second</code> indicates the set of terms obtained by taking the interactions of all terms in first with all terms in second. The specification <code>first*second</code> indicates the cross of first and second. This is the same as <code>first + second + first:second</code>. However, there is no <code>offset</code> permitted for the <code>qml.SARspARCH</code>.
</p>
<p>For an intercept-only model, the <code><a href="stats.html#topic+formula">formula</a></code> can be specified as <code>response ~ 1</code>. In addition, it is possible to fit an intercept-free model with <code>response ~ 0</code> or <code>response ~ 0 + terms</code>.
</p>
<p>To summarize the results of the model fit, use the generic function <code>summary</code>. For analysis of the residuals, the generic <code><a href="base.html#topic+plot">plot</a></code> function provides several descriptive plots. For numerical maximization of the log-likelihood, the function uses the algorithm of <code><a href="Rsolnp.html#topic+solnp">solnp</a></code> from the package <code><a href="Rsolnp.html#topic+Rsolnp">Rsolnp</a></code>.
</p>


<h3>Value</h3>

<p>A <a href="#topic+spARCH-class">spARCH</a> object with the following elements is returned:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>Parameter estimates <code class="reqn">\alpha</code> and <code class="reqn">\rho</code>.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Vector of residuals.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>Fitted values.</p>
</td></tr>
<tr><td><code>stderr</code></td>
<td>
<p>Standard errors of the estimates (Cramer-Rao estimates).</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>Hessian matrix of the negative Log-Likelihood at the estimated minimum.</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>Value of the Log-Likelihood at the estimated maximum.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>Fitted vector <code class="reqn">\boldsymbol{h}</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Vector of observations (input values).</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>Chosen type (input).</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Spatial weight matrix (input).</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Spatial weight matrix (input).</p>
</td></tr>
<tr><td><code>regressors</code></td>
<td>
<p>Are regressors included? <code>TRUE</code>/<code>FALSE</code></p>
</td></tr>
<tr><td><code>AR</code></td>
<td>
<p>Is an autoregressive term in the mean equation? <code>TRUE</code>/<code>FALSE</code></p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Matrix of regressors if <code>regressor = TRUE</code></p>
</td></tr>
</table>


<h3>Control Arguments</h3>

<p>see also: <code><a href="Rsolnp.html#topic+solnp">solnp</a></code>
</p>

<ul>
<li> <p><code>rho</code> - This is used as a penalty weighting scalar for infeasibility in the augmented objective function. The higher its value the more the weighting to bring the solution into the feasible region (default 1). However, very high values might lead to numerical ill conditioning or significantly slow down convergence.
</p>
</li>
<li> <p><code>outer.iter</code> - Maximum number of major (outer) iterations (default 400).
</p>
</li>
<li> <p><code>inner.iter</code> - Maximum number of minor (inner) iterations (default 800).
</p>
</li>
<li> <p><code>delta</code> - Relative step size in forward difference evaluation (default 1.0e-7).
</p>
</li>
<li> <p><code>tol</code> - Relative tolerance on feasibility and optimality (default 1e-8).
</p>
</li>
<li> <p><code>trace</code> - The value of the objective function and the parameters is printed at every major iteration (default 1).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>References</h3>

<p>Philipp Otto, Wolfgang Schmid, Robert Garthoff (2018). Generalised Spatial and Spatiotemporal Autoregressive Conditional Heteroscedasticity. <a href="https://doi.org/10.1016/j.spasta.2018.07.005">Spatial Statistics</a> 26, pp. 125-145. <em>arXiv:1609.00711</em>
</p>


<h3>See Also</h3>

<p><code><a href="Rsolnp.html#topic+solnp">solnp</a></code> (package <code><a href="Rsolnp.html#topic+Rsolnp">Rsolnp</a></code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("spdep")
rho &lt;- 0.5
alpha &lt;- 1
lambda &lt;- 0.5
d &lt;- 5
n &lt;- d^2
nblist &lt;- cell2nb(d, d, type = "queen")
W &lt;- nb2mat(nblist)
B &lt;- W

X &lt;- cbind(rep(1, n), rnorm(n))
beta &lt;- c(5, 2)

y &lt;- solve(diag(n) - lambda * B) %*%
    (sim.spARCH(n = n, rho = rho, alpha = alpha, W = W, type = "log-spARCH") + X %*% beta)
y &lt;- as.vector(y)
out &lt;- qml.SARspARCH(y ~ X[,2], B = B, W = W, type = "log-spARCH")

summary(out)
</code></pre>

<hr>
<h2 id='qml.spARCH'>
Maximum-likelihood estimation of a spatial ARCH model
</h2><span id='topic+qml.spARCH'></span>

<h3>Description</h3>

<p>The function fits a spatial ARCH model using the maximum-likelihood approach. In addition, external regressor may be included in the mean equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qml.spARCH(formula, W, type = "spARCH", data = NULL,
            b = 2, start = NULL, control = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qml.spARCH_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot;): a symbolic description of the model to be fitted. The details of model specification are given under &quot;Details.&quot;&quot;  <code>y</code> must be a numeric vector of length <code>n</code> (dimension of the weighting matrix)
</p>
</td></tr>
<tr><td><code id="qml.spARCH_+3A_w">W</code></td>
<td>

<p><code>n</code> times <code>n</code> spatial weight matrix
</p>
</td></tr>
<tr><td><code id="qml.spARCH_+3A_type">type</code></td>
<td>

<p>type of spatial ARCH model to be fitted (see Details)
</p>
</td></tr>
<tr><td><code id="qml.spARCH_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment containing the variables in the model. If not found in data, the variables are taken from the working space.
</p>
</td></tr>
<tr><td><code id="qml.spARCH_+3A_b">b</code></td>
<td>

<p>parameter <code>b</code> for the E-spARCH model (<code>type = "exp"</code>), must be a (positive) natural number
</p>
</td></tr>
<tr><td><code id="qml.spARCH_+3A_start">start</code></td>
<td>

<p>vector of starting values for the numerical optimization of the log-likelihood (optional)
</p>
</td></tr>
<tr><td><code id="qml.spARCH_+3A_control">control</code></td>
<td>

<p>list of control variables for iterative maximization of the log-likelihood
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>type = "spARCH"</code>, the functions fits a simple spatial ARCH model with one spatial lag, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{Y} = \mathbf{X} \boldsymbol{\beta} + \boldsymbol{h}^{1/2} \boldsymbol{\varepsilon}
</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} = \alpha \boldsymbol{1}_n + \rho \mathbf{W} \boldsymbol{Y}^{(2)} \, .
</code>
</p>

<p>The distribution of the error term is assumed to be Gaussian.
</p>
<p>If <code>type = "log-spARCH"</code>, a spatial log-ARCH process is estimated, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln(\boldsymbol{h}) = \alpha \boldsymbol{1}_n + \rho \mathbf{W} g_b(\boldsymbol{\varepsilon}) \, .
</code>
</p>

<p>The function <code class="reqn">g_b</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">
g_b(\boldsymbol{\varepsilon}) = (\ln|\varepsilon(\boldsymbol{s}_1)|^{b}, \ldots, \ln|\varepsilon(\boldsymbol{s}_n)|^{b})'
</code>
</p>

<p>and the error term is also assumed to be Gaussian.
</p>
<p>The modelling equation gan be specified as for <code><a href="stats.html#topic+lm">lm</a></code>, i.e., as <code><a href="stats.html#topic+formula">formula</a></code> object. A typical model has the form <code>response ~ terms</code> where response is the (numeric) response vector and terms is a series of terms which specifies a linear predictor for <code>response</code>. A terms specification of the form <code>first + second</code> indicates all the terms in first together with all the terms in second with duplicates removed. A specification of the form <code>first:second</code> indicates the set of terms obtained by taking the interactions of all terms in first with all terms in second. The specification <code>first*second</code> indicates the cross of first and second. This is the same as <code>first + second + first:second</code>. However, there is no <code>offset</code> permitted for the <code><a href="#topic+qml.spARCH">qml.spARCH</a></code>.
</p>
<p>For an intercept-only model, the <code><a href="stats.html#topic+formula">formula</a></code> can be specified as <code>response ~ 1</code>. In addition, it is possible to fit an intercept-free model with <code>response ~ 0</code> or <code>response ~ 0 + terms</code>.
</p>
<p>To summarize the results of the model fit, use the generic function <code>summary</code>. For analysis of the residuals, the generic <code>plot</code> provides several descriptive plots. For numerical maximization of the log-likelihood, the function uses the algorithm of <code><a href="Rsolnp.html#topic+solnp">solnp</a></code> from the package <code><a href="Rsolnp.html#topic+Rsolnp">Rsolnp</a></code>.
</p>


<h3>Value</h3>

<p>A <a href="#topic+spARCH-class">spARCH</a> object with the following elements is returned:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>Parameter estimates <code class="reqn">\alpha</code> and <code class="reqn">\rho</code>.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Vector of residuals.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>Fitted values.</p>
</td></tr>
<tr><td><code>stderr</code></td>
<td>
<p>Standard errors of the estimates (Cramer-Rao estimates).</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>Hessian matrix of the negative Log-Likelihood at the estimated minimum.</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>Value of the Log-Likelihood at the estimated maximum.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>Fitted vector <code class="reqn">\boldsymbol{h}</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Vector of observations (input values).</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>Chosen type (input).</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Spatial weight matrix (input).</p>
</td></tr>
<tr><td><code>regressors</code></td>
<td>
<p>Are regressors included? <code>TRUE</code>/<code>FALSE</code></p>
</td></tr>
<tr><td><code>AR</code></td>
<td>
<p>Is an autoregressive term in the mean equation? <code>TRUE</code>/<code>FALSE</code></p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Matrix of regressors if <code>regressor = TRUE</code></p>
</td></tr>
</table>


<h3>Control Arguments</h3>

<p>see also: <code><a href="Rsolnp.html#topic+solnp">solnp</a></code>
</p>

<ul>
<li> <p><code>rho</code> - This is used as a penalty weighting scalar for infeasibility in the augmented objective function. The higher its value the more the weighting to bring the solution into the feasible region (default 1). However, very high values might lead to numerical ill conditioning or significantly slow down convergence.
</p>
</li>
<li> <p><code>outer.iter</code> - Maximum number of major (outer) iterations (default 400).
</p>
</li>
<li> <p><code>inner.iter</code> - Maximum number of minor (inner) iterations (default 800).
</p>
</li>
<li> <p><code>delta</code> - Relative step size in forward difference evaluation (default 1.0e-7).
</p>
</li>
<li> <p><code>tol</code> - Relative tolerance on feasibility and optimality (default 1e-8).
</p>
</li>
<li> <p><code>trace</code> - The value of the objective function and the parameters is printed at every major iteration (default 1).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>References</h3>

<p>Philipp Otto, Wolfgang Schmid, Robert Garthoff (2018). Generalised Spatial and Spatiotemporal Autoregressive Conditional Heteroscedasticity. <a href="https://doi.org/10.1016/j.spasta.2018.07.005">Spatial Statistics</a> 26, pp. 125-145. <em>arXiv:1609.00711</em>
</p>


<h3>See Also</h3>

<p><code><a href="Rsolnp.html#topic+solnp">solnp</a></code> (package <code><a href="Rsolnp.html#topic+Rsolnp">Rsolnp</a></code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("spdep")

# directional spatial ARCH process (W is triangular, 1:1 origin)

rho &lt;- 0.5
alpha &lt;- 1
d &lt;- 5
n &lt;- d^2
nblist &lt;- cell2nb(d, d, type = "queen")
W &lt;- nb2mat(nblist)
W[lower.tri(W)] &lt;- 0
y &lt;- sim.spARCH(n = n, rho = rho, alpha = alpha, W = W, type = "spARCH")

out &lt;- qml.spARCH(y ~ 0, W = W, type = "spARCH")

summary(out)
</code></pre>

<hr>
<h2 id='residuals.spARCH'>
Extract model residuals
</h2><span id='topic+residuals.spARCH'></span>

<h3>Description</h3>

<p>The function extracts the residuals of a fitted spatial ARCH model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spARCH'
## S3 method for class 'spARCH'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.spARCH_+3A_object">object</code></td>
<td>
<p><code>spARCH</code> object generated by <code><a href="#topic+qml.spARCH">qml.spARCH</a></code> or <code><a href="#topic+qml.SARspARCH">qml.SARspARCH</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.spARCH_+3A_...">...</code></td>
<td>

<p>Other arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function extracts the residuals of a fitted spatial ARCH model.
</p>


<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+residuals.spARCH">residuals.spARCH</a></code>, <code><a href="#topic+fitted.spARCH">fitted.spARCH</a></code>.
</p>

<hr>
<h2 id='sim.spARCH'>Simulation of spatial ARCH models</h2><span id='topic+sim.spARCH'></span>

<h3>Description</h3>

<p>The function generates <code>n</code> random numbers of a spatial ARCH process for given parameters and weighting schemes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.spARCH(n = dim(W)[1], rho, alpha, W, b = 2, type = "spARCH", control = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.spARCH_+3A_n">n</code></td>
<td>
<p>number of observations. If <code>length(n)</code> <code class="reqn">&gt; 1</code>, the length is taken to be the number required. Default <code>dim(W)[1]</code></p>
</td></tr>
<tr><td><code id="sim.spARCH_+3A_rho">rho</code></td>
<td>
<p>spatial dependence parameter rho</p>
</td></tr>
<tr><td><code id="sim.spARCH_+3A_alpha">alpha</code></td>
<td>
<p>unconditional variance level alpha</p>
</td></tr>
<tr><td><code id="sim.spARCH_+3A_w">W</code></td>
<td>
<p><code>n</code> times <code>n</code> spatial weight matrix</p>
</td></tr>
<tr><td><code id="sim.spARCH_+3A_b">b</code></td>
<td>
<p>parameter <code>b</code> for logarithmic spatial ARCH (only needed if <code>type = "log-spARCH"</code>). Default 2.</p>
</td></tr>
<tr><td><code id="sim.spARCH_+3A_type">type</code></td>
<td>
<p>type of simulated spARCH process (see details)</p>
</td></tr>
<tr><td><code id="sim.spARCH_+3A_control">control</code></td>
<td>
<p>list of control arguments (see below)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function simulates <code>n</code> observations <code class="reqn">Y = (Y_1, ..., Y_n)'</code> of a spatial ARCH process, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{Y} = diag(\boldsymbol{h})^{1/2} \boldsymbol{\varepsilon} \, ,
</code>
</p>

<p>where <code class="reqn">\boldsymbol{\varepsilon}</code> is a spatial White Noise process. The definition of <code class="reqn">\boldsymbol{h}</code> depends on the chosen <code>type</code>. The following types are available.
</p>

<ul>
<li> <p><code>type = "spARCH"</code> - simulates <code class="reqn">\boldsymbol{\varepsilon}</code> from a truncated normal distribution on the interval <code class="reqn">[-a, a]</code>, such that <code class="reqn">\boldsymbol{h} &gt; 0</code> with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} =  \alpha + \rho \mathbf{W} \boldsymbol{Y}^{(2)} \; \mbox{and} \; a = 1 / ||\rho^2\mathbf{W}^2||_1^{1/4}.
</code>
</p>

<p>Note that the normal distribution is not trunctated (<code class="reqn">a = \infty</code>), if <code class="reqn">\mathbf{W}</code> is a strictly triangular matrix, as it is ensured that <code class="reqn">\boldsymbol{h} &gt; \boldsymbol{0}</code>. Generally, it is sufficient that if there exists a permutation such that <code class="reqn">\mathbf{W}</code> is strictly triangular. In this case, the process is called oriented spARCH process.
</p>
</li>
<li> <p><code>type = "log-spARCH"</code> - simulates a logarithmic spARCH process (log-spARCH), i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln\boldsymbol{h} = \alpha + \rho \mathbf{W} g(\boldsymbol{\varepsilon}) \, .
</code>
</p>

<p>For the log-spARCH process, the errors follow a standard normal distribution. The function <code class="reqn">g_b</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
g_b(\boldsymbol{\varepsilon}) = (\ln|\varepsilon(\boldsymbol{s}_1)|^{b}, \ldots, \ln|\varepsilon(\boldsymbol{s}_n)|^{b})' \, .
</code>
</p>

</li>
<li> <p><code>type = "complex-spARCH"</code> - allows for complex solutions of <code class="reqn">\boldsymbol{h}^{1/2}</code> with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} =  \alpha + \rho \mathbf{W} \boldsymbol{Y}^{(2)}  \, .
</code>
</p>

<p>The errors follow a standard normal distribution.
</p>
</li></ul>



<h3>Value</h3>

<p>The functions returns a vector <code class="reqn">\boldsymbol{y}</code>.
</p>


<h3>Control Arguments</h3>


<ul>
<li> <p><code>seed</code> - positive integer to initialize the random number generator (RNG), default value is a random integer in <code class="reqn">[1, 10^6]</code>
</p>
</li>
<li> <p><code>silent</code> - if <code>FALSE</code>, current random seed is reported
</p>
</li>
<li> <p><code>triangular</code> - if <code>TRUE</code>, <code class="reqn">\mathbf{W}</code> is a triangular matrix and there are no checks to verify this assumption (default <code>FALSE</code>)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>References</h3>

<p>Philipp Otto, Wolfgang Schmid, Robert Garthoff (2018). Generalised Spatial and Spatiotemporal Autoregressive Conditional Heteroscedasticity. <a href="https://doi.org/10.1016/j.spasta.2018.07.005">Spatial Statistics</a> 26, pp. 125-145. <em>arXiv:1609.00711</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("spdep")

# 1st example
##############

# parameters

rho &lt;- 0.5
alpha &lt;- 1
d &lt;- 2

nblist &lt;- cell2nb(d, d, type = "queen")
W &lt;- nb2mat(nblist)

# simulation

Y &lt;- sim.spARCH(rho = rho, alpha = alpha, W = W, type = "log-spARCH")

# visualization

image(1:d, 1:d, array(Y, dim = c(d,d)), xlab = expression(s[1]), ylab = expression(s[2]))

# 2nd example
##############

# two spatial weighting matrices W_1 and W_2
# h = alpha + rho_1 W_1 Y^2 + rho_2 W_2 Y^2

W_1 &lt;- W
nblist &lt;- cell2nb(d, d, type = "rook")
W_2 &lt;- nb2mat(nblist)

rho_1 &lt;- 0.3
rho_2 &lt;- 0.7

W &lt;- rho_1 * W_1 + rho_2 * W_2
rho &lt;- 1

Y &lt;- sim.spARCH(n = d^2, rho = rho, alpha = alpha, W = W, type = "log-spARCH")
image(1:d, 1:d, array(Y, dim = c(d,d)), xlab = expression(s[1]), ylab = expression(s[2]))
</code></pre>

<hr>
<h2 id='sim.spGARCH'>Simulation of spatial ARCH models</h2><span id='topic+sim.spGARCH'></span>

<h3>Description</h3>

<p>The function generates <code>n</code> random numbers of a spatial GARCH process for given parameters and weighting schemes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.spGARCH(n = dim(W1)[1], rho, lambda, alpha, W1, W2,
            b = 2, zeta = 0.5, theta = 0.5, type = "spGARCH",
            control = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.spGARCH_+3A_n">n</code></td>
<td>
<p>number of observations. If <code>length(n)</code> <code class="reqn">&gt; 1</code>, the length is taken to be the number required. Default <code>dim(W1)[1]</code></p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_rho">rho</code></td>
<td>
<p>spatial dependence parameter rho</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_lambda">lambda</code></td>
<td>
<p>spatial dependence parameter lambda</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_alpha">alpha</code></td>
<td>
<p>unconditional variance level alpha</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_w1">W1</code></td>
<td>
<p><code>n</code> times <code>n</code> spatial weight matrix (ARCH component, parameter rho)</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_w2">W2</code></td>
<td>
<p><code>n</code> times <code>n</code> spatial weight matrix (GARCH component, parameter lambda)</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_b">b</code></td>
<td>
<p>parameter <code>b</code> for logarithmic spatial GARCH (only needed if <code>type = "log-spGARCH"</code>). Default 2.</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_zeta">zeta</code></td>
<td>
<p>parameter <code>zeta</code> for exponential spatial GARCH (only needed if <code>type = "e-spGARCH"</code>). Default 0.5.</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_theta">theta</code></td>
<td>
<p>parameter <code>theta</code> for exponential spatial GARCH (only needed if <code>type = "e-spGARCH"</code>). Default 0.5.</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_type">type</code></td>
<td>
<p>type of simulated spGARCH process (see details)</p>
</td></tr>
<tr><td><code id="sim.spGARCH_+3A_control">control</code></td>
<td>
<p>list of control arguments (see below)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function simulates <code>n</code> observations <code class="reqn">Y = (Y_1, ..., Y_n)'</code> of a spatial GARCH process, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{Y} = diag(\boldsymbol{h})^{1/2} \boldsymbol{\varepsilon} \, ,
</code>
</p>

<p>where <code class="reqn">\boldsymbol{\varepsilon}</code> is a spatial White Noise process. The definition of <code class="reqn">\boldsymbol{h}</code> depends on the chosen <code>type</code>. The following types are available.
</p>

<ul>
<li> <p><code>type = "spGARCH"</code> - simulates <code class="reqn">\boldsymbol{\varepsilon}</code> from a truncated normal distribution on the interval <code class="reqn">[-a, a]</code>, such that <code class="reqn">\boldsymbol{h} &gt; 0</code> with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} =  \alpha + \rho \mathbf{W}_1 \boldsymbol{Y}^{(2)} + \lambda \mathbf{W}_2 \boldsymbol{h} \; \mbox{and} \; a = 1 / ||\rho^2\mathbf{W}_1^2||_1^{1/4}.
</code>
</p>

<p>Note that the normal distribution is not trunctated (<code class="reqn">a = \infty</code>), if <code class="reqn">\mathbf{W}_1</code> is a strictly triangular matrix, as it is ensured that <code class="reqn">\boldsymbol{h} &gt; \boldsymbol{0}</code>. Generally, it is sufficient that if there exists a permutation such that <code class="reqn">\mathbf{W}_1</code> is strictly triangular. In this case, the process is called oriented spGARCH process.
</p>
</li>
<li> <p><code>type = "e-spGARCH"</code> - simulates an exponential spARCH process (e-spGARCH), i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln\boldsymbol{h} = \alpha + \rho \mathbf{W}_1 g(\boldsymbol{\varepsilon}) + \lambda \mathbf{W}_2 log(\boldsymbol{h}) \, .
</code>
</p>

<p>For the e-spGARCH process, the errors follow a standard normal distribution. The function <code class="reqn">g</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
g(\boldsymbol{\varepsilon}) = \Theta {\varepsilon} + \zeta (|\varepsilon| - E(|\varepsilon|))  \, .
</code>
</p>

</li>
<li> <p><code>type = "log-spGARCH"</code> - simulates a logarithmic spARCH process (log-spGARCH), i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\ln\boldsymbol{h} = \alpha + \rho \mathbf{W}_1 g(\boldsymbol{\varepsilon}) + \lambda \mathbf{W}_2 log(\boldsymbol{h}) \, .
</code>
</p>

<p>For the log-spGARCH process, the errors follow a standard normal distribution. The function <code class="reqn">g</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
g(\boldsymbol{\varepsilon}) = (\ln|\varepsilon(\boldsymbol{s}_1)|^{b}, \ldots, \ln|\varepsilon(\boldsymbol{s}_n)|^{b})' \, .
</code>
</p>

</li>
<li> <p><code>type = "complex-spGARCH"</code> - allows for complex solutions of <code class="reqn">\boldsymbol{h}^{1/2}</code> with
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{h} =  \alpha + \rho \mathbf{W}_1 \boldsymbol{Y}^{(2)} + \lambda \mathbf{W}_2 \boldsymbol{h}  \, .
</code>
</p>

<p>The errors follow a standard normal distribution.
</p>
</li></ul>



<h3>Value</h3>

<p>The functions returns a vector <code class="reqn">\boldsymbol{y}</code>.
</p>


<h3>Control Arguments</h3>


<ul>
<li> <p><code>seed</code> - positive integer to initialize the random number generator (RNG), default value is a random integer in <code class="reqn">[1, 10^6]</code>
</p>
</li>
<li> <p><code>silent</code> - if <code>FALSE</code>, current random seed is reported
</p>
</li>
<li> <p><code>triangular</code> - if <code>TRUE</code>, <code class="reqn">\mathbf{W}</code> is a triangular matrix and there are no checks to verify this assumption (default <code>FALSE</code>)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>References</h3>

<p>Philipp Otto, Wolfgang Schmid (2019). Spatial GARCH Models - A Unified Approach. <em>arXiv:1908.08320</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("spdep")

# 1st example (spatial GARCH)
##############

# parameters

rho    &lt;- 0.5
lambda &lt;- 0.3
alpha  &lt;- 1
d      &lt;- 5

nblist &lt;- cell2nb(d, d, type = "rook") # lattice process with Rook's contiguity matrix
W_1    &lt;- nb2mat(nblist)
W_2    &lt;- W_1

# simulation

Y      &lt;- sim.spGARCH(rho = rho, lambda = lambda, alpha = alpha,
                      W1 = W_1, W2 = W_2, type = "spGARCH")

# visualization

image(1:d, 1:d, array(Y, dim = c(d,d)), xlab = expression(s[1]), ylab = expression(s[2]))

# 2nd example (exponential spatial GARCH)
##############

# parameters

rho    &lt;- 0.5
lambda &lt;- 0.3
alpha  &lt;- 1
zeta   &lt;- 0.5
theta  &lt;- 0.5
d      &lt;- 5

nblist &lt;- cell2nb(d, d, type = "rook") # lattice process with Rook's contiguity matrix
W_1    &lt;- nb2mat(nblist)
W_2    &lt;- W_1

# simulation

Y      &lt;- sim.spGARCH(rho = rho, lambda = lambda, alpha = alpha,
                      W1 = W_1, W2 = W_2, zeta = zeta, theta = 0.5, type = "e-spGARCH")

# visualization

image(1:d, 1:d, array(Y, dim = c(d,d)), xlab = expression(s[1]), ylab = expression(s[2]))

</code></pre>

<hr>
<h2 id='spARCH'>Output of Quasi-Maximum-Likelihood Estimation</h2><span id='topic+spARCH'></span><span id='topic+spARCH-class'></span>

<h3>Description</h3>

<p>The <code>spARCH</code> class is a class generated by the estimation functions <code><a href="#topic+qml.spARCH">qml.spARCH</a></code> or <code><a href="#topic+qml.SARspARCH">qml.SARspARCH</a></code> comprising the results of the quasi-maximum-likelihood estimation.
</p>


<h3>Methods</h3>


<p>Several generic methods for summarizing the results are available:
</p>
<dl>
<dt><code>plot(spARCH_object)</code></dt><dd><p><code><a href="#topic+plot.spARCH">plot.spARCH</a></code> - Descriptive plots for residuals of a fitted spatial ARCH model</p>
</dd>
<dt><code>summary(spARCH_object)</code></dt><dd><p><code><a href="#topic+summary.spARCH">summary.spARCH</a></code> - The function returns a summary of the model fit of a spatial ARCH model</p>
</dd>
<dt><code>fitted(spARCH_object)</code></dt><dd><p><code><a href="#topic+fitted.spARCH">fitted.spARCH</a></code> - The function extracts the fitted values of a spatial ARCH model.</p>
</dd>
</dl>


<hr>
<h2 id='spGARCH'>spGARCH - Package to fit spatial ARCH models</h2><span id='topic+spGARCH'></span>

<h3>Description</h3>

<p>A collection of functions for simulating and fitting spatial autoregressive conditional heteroscedasticity (spARCH) processes are provided.
</p>
<p>The functions <code><a href="#topic+sim.spARCH">sim.spARCH</a></code> and <code><a href="#topic+sim.spGARCH">sim.spGARCH</a></code> are the main function for simulating spARCH and spGARCH processes, respectively. Via the argument <code>type</code> several types of spatial ARCH and GARCH can be simulated, e.g., exponential spARCH models, spARCH for oriented processes, or spARCH processes with truncated error support. For details, refer the paper Otto, Schmid, and Garthoff (2018) published in <a href="https://doi.org/10.1016/j.spasta.2018.07.005">Spatial Statistics</a>.
</p>
<p>Moreover, the package provides function for fitting spARCH models. Basically, there are two functions to fit these kind of model: <code><a href="#topic+qml.spARCH">qml.spARCH</a></code> and <code><a href="#topic+qml.SARspARCH">qml.SARspARCH</a></code>. First, spARCH models can be fitted by <code><a href="#topic+qml.spARCH">qml.spARCH</a></code>.
</p>


<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>References</h3>

<p>Philipp Otto, Wolfgang Schmid, Robert Garthoff (2018). Generalised Spatial and Spatiotemporal Autoregressive Conditional Heteroscedasticity. <a href="https://doi.org/10.1016/j.spasta.2018.07.005">Spatial Statistics</a> 26, pp. 125-145.
</p>

<hr>
<h2 id='summary.spARCH'>
Summary for spARCH object
</h2><span id='topic+summary.spARCH'></span><span id='topic+print.summary.spARCH'></span><span id='topic+print.spARCH'></span>

<h3>Description</h3>

<p>The function returns a summary of the model fit of a spatial ARCH model (<code>qml.spARCH</code> or <code>qml.SARspARCH</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spARCH'
summary(object, ...)
## S3 method for class 'summary.spARCH'
print(x, digits = max(5, .Options$digits - 3),
	signif.stars = TRUE, ...)
## S3 method for class 'spARCH'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.spARCH_+3A_object">object</code></td>
<td>
<p><a href="#topic+spARCH-class">spARCH</a> object generated by <code><a href="#topic+qml.spARCH">qml.spARCH</a></code> or <code><a href="#topic+qml.SARspARCH">qml.SARspARCH</a></code>.</p>
</td></tr>
<tr><td><code id="summary.spARCH_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to be printed.</p>
</td></tr>
<tr><td><code id="summary.spARCH_+3A_signif.stars">signif.stars</code></td>
<td>
<p>Logical variable. If TRUE, significance stars are printed for each coefficient.</p>
</td></tr>
<tr><td><code id="summary.spARCH_+3A_x">x</code></td>
<td>
<p><a href="#topic+spARCH-class">spARCH</a> object of <code><a href="#topic+qml.spARCH">qml.spARCH</a></code>.</p>
</td></tr>
<tr><td><code id="summary.spARCH_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>summary.spARCH</code> returns an <a href="#topic+spARCH-class">spARCH</a> object with all results (coefficients, residuals, diagnostic checks etc.). If the returned object is printed, a detailed summary of the model fit is returned.
</p>


<h3>Value</h3>

<p>The function returns the input <a href="#topic+spARCH-class">spARCH</a> object, plus
</p>
<table role = "presentation">
<tr><td><code>Coef</code></td>
<td>
<p>a matrix with columns for the estimated coefficients, their standard error, t-statistics and corresponding (two-sided, asymptotic) p-values.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian Schwarz information criterion</p>
</td></tr>
<tr><td><code>moran_res</code></td>
<td>
<p>Test on spatial spatial autocorrelation of the residuals (based on Morans I, <code><a href="spdep.html#topic+moran.test">moran.test</a></code>).</p>
</td></tr>
<tr><td><code>moran_sq_res</code></td>
<td>
<p>Test on spatial spatial autocorrelation of the squared residuals (based on Morans I, <code><a href="spdep.html#topic+moran.test">moran.test</a></code>).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>For further details about the Moran's I test see <code><a href="spdep.html#topic+moran.test">moran.test</a></code>.
</p>


<h3>Author(s)</h3>

<p>Philipp Otto <a href="mailto:potto@europa-uni.de">potto@europa-uni.de</a>
</p>


<h3>See Also</h3>

<p>The model fitting functions <code><a href="#topic+qml.spARCH">qml.spARCH</a></code> and <code><a href="#topic+qml.SARspARCH">qml.SARspARCH</a></code>. Function <code><a href="stats.html#topic+coef">coef</a></code> will extract the matrix of coefficients with standard errors, t-statistics and p-values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("spdep")

# directional spatial ARCH process (W is triangular, 1:1 origin)

rho &lt;- 0.5
alpha &lt;- 1
d &lt;- 5
n &lt;- d^2
nblist &lt;- cell2nb(d, d, type = "queen")
W &lt;- nb2mat(nblist)
W[lower.tri(W)] &lt;- 0
y &lt;- sim.spARCH(n = n, rho = rho, alpha = alpha, W = W, type = "spARCH")

out &lt;- qml.spARCH(y ~ 0, W = W, type = "spARCH")

summary(out)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
