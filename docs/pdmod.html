<!DOCTYPE html><html><head><title>Help for package pdmod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pdmod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pdmod-package'>
<p>Proximal/Distal Modeling Framework</p></a></li>
<li><a href='#averageBySession'><p>Average by session</p></a></li>
<li><a href='#calculateResponse'><p>Calculate response from the estimate</p></a></li>
<li><a href='#computeModel'><p>Calculates proximal/distal model</p></a></li>
<li><a href='#Constants'><p>Constants</p></a></li>
<li><a href='#fitModel'><p>Fit model parameters</p></a></li>
<li><a href='#isTimedVector'><p>Is TimedVector</p></a></li>
<li><a href='#modelObjectiveFunction'><p>Objective function to fit model parameters</p></a></li>
<li><a href='#plot.pdmod'><p>Plot model</p></a></li>
<li><a href='#TimedVector'><p>Create a TimedVector</p></a></li>
<li><a href='#verifyTimedVector'><p>Verify TimedVector</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Proximal/Distal Modeling Framework for Pavlovian Conditioning
Phenomena</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-02-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Chloe Bracis</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chloe Bracis &lt;cbracis@uw.edu&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>mco,stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RUnit</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a model of Pavlovian conditioning phenomena, such as response extinction and spontaneous recovery, and partial reinforcement extinction effects. Competing proximal and distal reward predictions, computed using fast and slow learning rates, combine according to their uncertainties and the recency of information. The resulting mean prediction drives the response rate.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-02-13 10:01:05 UTC; bunch</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-02-13 10:16:37 UTC</td>
</tr>
</table>
<hr>
<h2 id='pdmod-package'>
Proximal/Distal Modeling Framework
</h2><span id='topic+pdmod-package'></span><span id='topic+pdmod'></span>

<h3>Description</h3>

<p>In this model, Pavlovian phenomena conditioning phenomena (acquisition, extinction, spontaneous recovery and the partial reinforcement extinction effect) emerge from reward predictions of parallel neural circuits that combine according to their time-varying uncertainties. This package provides methods to compute the model for different parameter values and fit parameters to experimental data.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> pdmod</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2014-03-27</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>For a given set of rewards/non-rewards paired with a signal in a Pavlovian conditioning experiment (specified as a <code><a href="#topic+TimedVector">TimedVector</a></code>), the animal's response for a given set of parameter values can be computed with <code><a href="#topic+computeModel">computeModel</a></code>. Additionally, if experimental response data is available, the parameter values can be fit to the data using <code><a href="#topic+fitModel">fitModel</a></code>. Additional methods <code><a href="#topic+averageBySession">averageBySession</a></code> and <code><a href="#topic+plot.pdmod">plot.pdmod</a></code> are available to manipulate and plot model results.
</p>
<p><code><a href="#topic+TimedVector">TimedVector</a></code> is a class used to associate reward/no-reward with a time schedule with helper methods <code><a href="base.html#topic+c">c</a></code>, <code><a href="#topic+isTimedVector">isTimedVector</a></code>, <code><a href="base.html#topic+print">print</a></code>, <code><a href="stats.html#topic+time">time</a></code>, and 
<code><a href="#topic+verifyTimedVector">verifyTimedVector</a></code>.
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>
<p>Maintainer: Chloe Bracis &lt;cbracis@uw.edu&gt;
</p>

<hr>
<h2 id='averageBySession'>Average by session</h2><span id='topic+averageBySession'></span>

<h3>Description</h3>

<p>Calculates the average estimate per session or block of
trials
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  averageBySession(estimate, sessionBoundaries)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="averageBySession_+3A_estimate">estimate</code></td>
<td>
<p>Series of estimates in event time</p>
</td></tr>
<tr><td><code id="averageBySession_+3A_sessionboundaries">sessionBoundaries</code></td>
<td>
<p>Vector of the starting indices
for each session (which means to include the end, the
last value should be length(estimate) + 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of average estimate for each session
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create vector of values (i.e. estimates, respones, etc.)
values = runif(100)
# Specify sessions, here a group of 10 trials
sessionBoundaries = seq(1, 101, 10)
valuesBySession = averageBySession(values, sessionBoundaries)
</code></pre>

<hr>
<h2 id='calculateResponse'>Calculate response from the estimate</h2><span id='topic+calculateResponse'></span>

<h3>Description</h3>

<p>Given an estiamtes probability of reward beween 0 and 1,
calculates a response rate (i.e. the measured response of
the animal such as visits to the food delivery system)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  calculateResponse(k, rmax, est)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateResponse_+3A_k">k</code></td>
<td>
<p>Response rate parameter</p>
</td></tr>
<tr><td><code id="calculateResponse_+3A_rmax">rmax</code></td>
<td>
<p>Maximum response</p>
</td></tr>
<tr><td><code id="calculateResponse_+3A_est">est</code></td>
<td>
<p>Vector of estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of responses
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Constants">Constants</a></code>, <code><a href="#topic+isTimedVector">isTimedVector</a></code>,
<code><a href="#topic+verifyTimedVector">verifyTimedVector</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calculateResponse(0.8, 10, runif(20))
</code></pre>

<hr>
<h2 id='computeModel'>Calculates proximal/distal model</h2><span id='topic+computeModel'></span>

<h3>Description</h3>

<p>Calulates a realization of a proximal/distal model for a
specified sequence of trials and paramter values. Use the
<code>verbose</code> parameter to include underlying model
components (distal and proximal estimates, weights,
uncertainties and signal-reward association) in addition
to the mean estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  computeModel(x, mFast, mSlow, n, g = 0, h,
    tau = 1/TV_DAY, threshold = 0, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeModel_+3A_x">x</code></td>
<td>
<p>Object of class <code><a href="#topic+TimedVector">TimedVector</a></code>
specifying trials including whether signal was
rewarded/unrewarded and times</p>
</td></tr>
<tr><td><code id="computeModel_+3A_mfast">mFast</code></td>
<td>
<p>Learning rate of proximal memory estimates</p>
</td></tr>
<tr><td><code id="computeModel_+3A_mslow">mSlow</code></td>
<td>
<p>Learning rate of distal memory estimates</p>
</td></tr>
<tr><td><code id="computeModel_+3A_n">n</code></td>
<td>
<p>Learning rate of uncertainty estimates</p>
</td></tr>
<tr><td><code id="computeModel_+3A_h">h</code></td>
<td>
<p>Decay rate of distal memory uncertainty
estimator as time passes between trials</p>
</td></tr>
<tr><td><code id="computeModel_+3A_g">g</code></td>
<td>
<p>Association learning speed parameter</p>
</td></tr>
<tr><td><code id="computeModel_+3A_tau">tau</code></td>
<td>
<p>Temporal scaling coefficient to translate time
differences in <code>x</code> to fractional days. Defaults to
<code>1/TV_DAY</code> assuming that the times in <code>x</code> are
expressed in minutes.</p>
</td></tr>
<tr><td><code id="computeModel_+3A_threshold">threshold</code></td>
<td>
<p>Difference in real time that must pass
before deflation kicks in (used for testing)</p>
</td></tr>
<tr><td><code id="computeModel_+3A_verbose">verbose</code></td>
<td>
<p>true to include supporting estimates,
weights, etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Series of estimates
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculateResponse">calculateResponse</a></code>,
<code><a href="#topic+averageBySession">averageBySession</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create 5 sessions of 20 rewarded trials,
# then 2 sessions of 20 unrewarded trials
trialTime = as.vector(sapply(0:6, function(x) 1:20 + x * TV_DAY))
trials =  TimedVector(c(rep(1, 5*20), rep(0, 2*20)), trialTime)

estimates = computeModel(trials, mFast = 0.7, mSlow = 0.1, n = 0.05,
						 g = 500, h = 0.2, verbose = TRUE)
plot(estimates, trials)
</code></pre>

<hr>
<h2 id='Constants'>Constants</h2><span id='topic+Constants'></span><span id='topic+TV_DAY'></span><span id='topic+TV_HOUR'></span><span id='topic+TV_MINUTE'></span>

<h3>Description</h3>

<p>Constants to use with <code><a href="#topic+TimedVector">TimedVector</a></code> for
specifying time between events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  TV_MINUTE

  TV_HOUR

  TV_DAY
</code></pre>


<h3>Format</h3>

<p>Numeric constants</p>


<h3>Details</h3>

<p><code>TV_MINUTE</code> A minute
</p>
<p><code>TV_HOUR</code> An hour
</p>
<p><code>TV_DAY</code> A day
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TimedVector">TimedVector</a></code>
</p>

<hr>
<h2 id='fitModel'>Fit model parameters</h2><span id='topic+fitModel'></span>

<h3>Description</h3>

<p>Estimates parameters for proximal/distal model using
multi-criteria estimation (<code><a href="mco.html#topic+nsga2">mco</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  fitModel(dataX, dataResponse,
    responseFunction = calculateResponse,
    sessionBoundaries = NA, fitG = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitModel_+3A_datax">dataX</code></td>
<td>
<p>Object of class <code><a href="#topic+TimedVector">TimedVector</a></code>
specifying trials including whether signal was
rewarded/unrewarded and times</p>
</td></tr>
<tr><td><code id="fitModel_+3A_dataresponse">dataResponse</code></td>
<td>
<p>Corresponding observations of
subject's response to signal</p>
</td></tr>
<tr><td><code id="fitModel_+3A_responsefunction">responseFunction</code></td>
<td>
<p>The function to use to transform
the mean estimate into a response</p>
</td></tr>
<tr><td><code id="fitModel_+3A_sessionboundaries">sessionBoundaries</code></td>
<td>
<p>(optional) Vector defining how
to group the trials into sessions where the items are the
starting indicies for each session (so the last value can
be the index after the last trial) and <code>NA</code>s are
used for gaps between sessions</p>
</td></tr>
<tr><td><code id="fitModel_+3A_fitg">fitG</code></td>
<td>
<p><code>TRUE</code> (default) to estimate g, or
<code>FALSE</code> to fix g at 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Model fit
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeModel">computeModel</a></code>
</p>

<hr>
<h2 id='isTimedVector'>Is TimedVector</h2><span id='topic+isTimedVector'></span>

<h3>Description</h3>

<p>Determines if an object inherits
<code><a href="#topic+TimedVector">TimedVector</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  isTimedVector(tv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isTimedVector_+3A_tv">tv</code></td>
<td>
<p>Potential <code>TimedVector</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code>, if the object inherits <code>TimedVector</code>
<code>FALSE</code>, otherwise
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TimedVector">TimedVector</a></code>,
<code><a href="#topic+verifyTimedVector">verifyTimedVector</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A TimedVector
tv = TimedVector(rep(1, 10), 1:10)
isTimedVector(tv)

# Not a TimedVector
isTimedVector(1:10)
isTimedVector(time(tv))
</code></pre>

<hr>
<h2 id='modelObjectiveFunction'>Objective function to fit model parameters</h2><span id='topic+modelObjectiveFunction'></span>

<h3>Description</h3>

<p>Function passed to optimization routine to minimize to
estimate parameters. Uses mean squared error to calculate
difference between <code>dataResponse</code> and what
<code><a href="#topic+computeModel">computeModel</a></code>) would forcast for
<code>dataX</code> using parameters <code>pars</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  modelObjectiveFunction(pars, dimension, dataX,
    dataResponse, responseFunction = calculateResponse,
    sessionBoundaries = NA, fitG = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelObjectiveFunction_+3A_pars">pars</code></td>
<td>
<p>Vector of parameters mFast, mSlow, n, hSlow,
and r</p>
</td></tr>
<tr><td><code id="modelObjectiveFunction_+3A_dimension">dimension</code></td>
<td>
<p>What dimension to return error in, 1 for
single criteria optimization, or number of columns of
data for multicriteria optimization</p>
</td></tr>
<tr><td><code id="modelObjectiveFunction_+3A_datax">dataX</code></td>
<td>
<p>List of observations of process x(i) (with
real time)</p>
</td></tr>
<tr><td><code id="modelObjectiveFunction_+3A_dataresponse">dataResponse</code></td>
<td>
<p>Corresponding list of observations of
subject's response to x(i), i.e. ~x(i)</p>
</td></tr>
<tr><td><code id="modelObjectiveFunction_+3A_responsefunction">responseFunction</code></td>
<td>
<p>The function to use to transform
the forecast into a response</p>
</td></tr>
<tr><td><code id="modelObjectiveFunction_+3A_sessionboundaries">sessionBoundaries</code></td>
<td>
<p>(option) Vector defining how to
group the trials into sessions where the items are the
starting indicies for each session (so the last value can
be the index after the last trial) and <code>NA</code>s are
used for gaps between sessions</p>
</td></tr>
<tr><td><code id="modelObjectiveFunction_+3A_fitg">fitG</code></td>
<td>
<p><code>TRUE</code> to estimate g, or <code>FALSE</code> to
fix g at 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Error between <code>dataRespones</code> and what would have
been estimated for <code>dataX</code> based on parameters pars
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeModel">computeModel</a></code>, <code><a href="#topic+fitModel">fitModel</a></code>
</p>

<hr>
<h2 id='plot.pdmod'>Plot model</h2><span id='topic+plot.pdmod'></span>

<h3>Description</h3>

<p>Plots a <code>pdmod</code> class (what's returned from
<code><a href="#topic+computeModel">computeModel</a></code> with <code>verbose = TRUE</code>).
The plots show the proximal and distal estimates, their
corresponding uncertainties and weights, as well as the
overall mean estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'pdmod'
 plot(x, actual, n, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pdmod_+3A_x">x</code></td>
<td>
<p>Object of class <code>pdmod</code></p>
</td></tr>
<tr><td><code id="plot.pdmod_+3A_actual">actual</code></td>
<td>
<p>Actual rewards received</p>
</td></tr>
<tr><td><code id="plot.pdmod_+3A_n">n</code></td>
<td>
<p>(optional) Only plot the last n values</p>
</td></tr>
<tr><td><code id="plot.pdmod_+3A_...">...</code></td>
<td>
<p>Other arguments to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create 5 sessions of 20 rewarded trials,
# then 2 sessions of 20 unrewarded trials
trialTime = as.vector(sapply(0:6, function(x) 1:20 + x * TV_DAY))
trials =  TimedVector(c(rep(1, 5*20), rep(0, 2*20)), trialTime)

estimates = computeModel(trials, mFast = 0.7, mSlow = 0.1, n = 0.05,
						 g = 500, h = 0.2, verbose = TRUE)
plot(estimates, trials)
</code></pre>

<hr>
<h2 id='TimedVector'>Create a TimedVector</h2><span id='topic+TimedVector'></span>

<h3>Description</h3>

<p>The class TimedVector contains a vector of values in
event time, as well as when in real time those events
took place.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  TimedVector(x, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TimedVector_+3A_x">x</code></td>
<td>
<p>Series of values in event time</p>
</td></tr>
<tr><td><code id="TimedVector_+3A_t">t</code></td>
<td>
<p>(optional) Cooresponding real time of events in
minutes.  Default is an event every minute.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TimedVector
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Constants">Constants</a></code>, <code><a href="#topic+isTimedVector">isTimedVector</a></code>,
<code><a href="#topic+verifyTimedVector">verifyTimedVector</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># One session of 20 rewarded trials every minute
TimedVector(rep(1, 20), 1:20)

# Three sessions of rewarded trials, then one session of non-rewarded trials,
# with trials every 2 min and sessions every day
trialTime = as.vector(sapply(0:3, function(x) seq(2, 20, 2) + x * TV_DAY))
TimedVector(c(rep(1, 30), rep(0, 10)), trialTime)

# The above schedule of sessions, but 50% probability of reward
TimedVector(sample(0:1, 40, replace = TRUE), trialTime)
</code></pre>

<hr>
<h2 id='verifyTimedVector'>Verify TimedVector</h2><span id='topic+verifyTimedVector'></span>

<h3>Description</h3>

<p>Verifies object really is a <code><a href="#topic+TimedVector">TimedVector</a></code>
(stronger checks than <code><a href="#topic+isTimedVector">isTimedVector</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  verifyTimedVector(tv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verifyTimedVector_+3A_tv">tv</code></td>
<td>
<p>Potential <code>TimedVector</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code>, if the object is a <code>TimedVector</code>
<code>FALSE</code>, otherwise
</p>


<h3>Author(s)</h3>

<p>Chloe Bracis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+isTimedVector">isTimedVector</a></code>, <code><a href="#topic+TimedVector">TimedVector</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
