<!DOCTYPE html><html><head><title>Help for package prevalence</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {prevalence}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#prevalence-package'><p>Tools for prevalence assessment studies</p></a></li>
<li><a href='#betaExpert'><p>Calculate the parameters of a Beta distribution based on expert information</p></a></li>
<li><a href='#betaPERT'><p>Calculate the parameters of a Beta-PERT distribution</p></a></li>
<li><a href='#convert-methods'><p>Methods for Function <code>as.matrix</code> in Package <span class="pkg">prevalence</span></p></a></li>
<li><a href='#define'><p>Definition of <code>truePrevMulti</code> and <code>truePrevMulti2</code> model</p></a></li>
<li><a href='#plot-methods'><p>Methods for Function <code>plot</code> in Package <span class="pkg">prevalence</span></p></a></li>
<li><a href='#plot-methods-coda'><p>Plotting functions from package <span class="pkg">coda</span></p></a></li>
<li><a href='#prev-class'><p>Class <code>"prev"</code></p></a></li>
<li><a href='#print-methods'><p>Methods for Function <code>print</code> in Package <span class="pkg">prevalence</span></p></a></li>
<li><a href='#propCI'><p>Calculate confidence intervals for prevalences and other proportions</p></a></li>
<li><a href='#show-methods'><p>Methods for Function <code>show</code> in Package <span class="pkg">prevalence</span></p></a></li>
<li><a href='#summary-methods'><p>Methods for Function <code>summary</code> in Package <span class="pkg">prevalence</span></p></a></li>
<li><a href='#truePrev'><p>Estimate true prevalence from individuals samples</p></a></li>
<li><a href='#truePrevMulti'><p>Estimate true prevalence from individuals samples using multiple tests &ndash; conditional probability scheme</p></a></li>
<li><a href='#truePrevMulti2'><p>Estimate true prevalence from individuals samples using multiple tests &ndash; covariance scheme</p></a></li>
<li><a href='#truePrevPools'><p>Estimate true prevalence from pooled samples</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Prevalence Assessment Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Brecht Devleesschauwer [aut, cre],
  Paul Torgerson [aut],
  Johannes Charlier [aut],
  Bruno Levecke [aut],
  Nicolas Praet [aut],
  Sophie Roelandt [aut],
  Suzanne Smit [aut],
  Pierre Dorny [aut],
  Dirk Berkvens [aut],
  Niko Speybroeck [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brecht Devleesschauwer &lt;brechtdv@gmail.com&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/brechtdv/prevalence/issues">https://github.com/brechtdv/prevalence/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>The prevalence package provides Frequentist and Bayesian methods for prevalence assessment studies. IMPORTANT: the truePrev functions in the prevalence package call on JAGS (Just Another Gibbs Sampler), which therefore has to be available on the user's system. JAGS can be downloaded from <a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, utils, stats, graphics, grDevices, coda, rjags</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 4.0.0) (see
https://mcmc-jags.sourceforge.io/)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://prevalence.cbra.be/">http://prevalence.cbra.be/</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-03 21:00:31 UTC; BrDe394</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-03 21:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='prevalence-package'>Tools for prevalence assessment studies</h2><span id='topic+prevalence-package'></span><span id='topic+prevalence'></span>

<h3>Description</h3>

<p>The <span class="pkg">prevalence</span> package provides Frequentist and Bayesian methods useful in prevalence assessment studies. Visit <a href="http://prevalence.cbra.be/">http://prevalence.cbra.be/</a> for more information and tutorials.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> prevalence</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 0.4.1</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2022-06-03</td>
</tr>
<tr>
 <td style="text-align: left;">
    BugReports: </td><td style="text-align: left;"> <a href="https://github.com/brechtdv/prevalence/issues">https://github.com/brechtdv/prevalence/issues</a></td>
</tr>
<tr>
 <td style="text-align: left;">
    Depends: </td><td style="text-align: left;"> R (&gt;= 4.0.0), rjags, coda, methods</td>
</tr>
<tr>
 <td style="text-align: left;">
    SystemRequirements: </td><td style="text-align: left;"> JAGS (&gt;= 3.2.0) (see <a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>)</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GNU &gt;= 2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Available functions in the <span class="pkg">prevalence</span> package:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+propCI">propCI</a></code> </td><td style="text-align: left;"> Derive confidence intervals for an apparent prevalence estimate</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+truePrev">truePrev</a></code> </td><td style="text-align: left;"> Estimate TP from AP obtained by testing individual samples with a single test</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code><a href="#topic+truePrevMulti">truePrevMulti</a></code> </td><td style="text-align: left;"> Estimate TP from AP obtained by testing individual samples with multiple tests, using a conditional probability scheme</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code> </td><td style="text-align: left;"> Estimate TP from AP obtained by testing individual samples with multiple tests, using a covariance scheme</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+truePrevPools">truePrevPools</a></code> </td><td style="text-align: left;"> Estimate TP from AP obtained by testing pooled samples</td>
</tr>
<tr>
 <td style="text-align: left;">

    <code><a href="#topic+betaPERT">betaPERT</a></code> </td><td style="text-align: left;"> Calculate the parameters of a Beta-PERT distribution</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code><a href="#topic+betaExpert">betaExpert</a></code> </td><td style="text-align: left;"> Calculate the parameters of a Beta distribution based on expert opinion
  </td>
</tr>

</table>

<p><strong>IMPORTANT</strong>: the <code>truePrev</code> functions in the <span class="pkg">prevalence</span> package call on <span class="pkg">JAGS (Just Another Gibbs Sampler)</span>, through the <span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> package. Therefore, JAGS has to be installed on the user's system.<br /><br />
JAGS can be downloaded from <a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>
</p>


<h3>Author(s)</h3>

<p><strong>Creator, Maintainer</strong><br />
Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;<br /><br />
<strong>Contributors</strong><br />
Paul Torgerson, Johannes Charlier, Bruno Levecke, Nicolas Praet, Sophie Roelandt, Suzanne Smit, Pierre Dorny, Dirk Berkvens, Niko Speybroeck
</p>

<hr>
<h2 id='betaExpert'>Calculate the parameters of a Beta distribution based on expert information</h2><span id='topic+betaExpert'></span><span id='topic+print.betaExpert'></span><span id='topic+plot.betaExpert'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+betaExpert">betaExpert</a></code> function fits a (standard) Beta distribution to expert opinion. The expert provides information on a best-guess estimate (mode or mean), and an uncertainty range:
</p>

<ul>
<li><p>The parameter value is with <code>100*p%</code> certainty greater than <code>lower</code>
</p>
</li>
<li><p>The parameter value is with <code>100*p%</code> certainty smaller than <code>upper</code>
</p>
</li>
<li><p>The parameter value lies with <code>100*p%</code> in between <code>lower</code> and <code>upper</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>betaExpert(best, lower, upper, p = 0.95, method = "mode")

## S3 method for class 'betaExpert'
print(x, conf.level = .95, ...)
## S3 method for class 'betaExpert'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betaExpert_+3A_best">best</code></td>
<td>
<p>Best-guess estimate; see argument <code>method</code></p>
</td></tr>
<tr><td><code id="betaExpert_+3A_lower">lower</code></td>
<td>
<p>Lower uncertainty limit</p>
</td></tr>
<tr><td><code id="betaExpert_+3A_upper">upper</code></td>
<td>
<p>Upper uncertainty limit</p>
</td></tr>
<tr><td><code id="betaExpert_+3A_p">p</code></td>
<td>
<p>Expert's certainty level</p>
</td></tr>
<tr><td><code id="betaExpert_+3A_method">method</code></td>
<td>
<p>Does best-guess estimate correspond to the <code>mode</code> or to the <code>mean</code>? Defaults to <code>mode</code></p>
</td></tr>
<tr><td><code id="betaExpert_+3A_x">x</code></td>
<td>
<p>Object of class <code>betaExpert</code></p>
</td></tr>
<tr><td><code id="betaExpert_+3A_y">y</code></td>
<td>
<p>Currently not implemented</p>
</td></tr>
<tr><td><code id="betaExpert_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used in printing quantiles of resulting Beta distribution</p>
</td></tr>
<tr><td><code id="betaExpert_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to function <code>print</code> and <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methodology behind the <code><a href="#topic+betaExpert">betaExpert</a></code> function is presented by Branscum et al. (2005) and implemented in the <em>BetaBuster</em> software, written by Chun-Lung Su.<br /><br />
</p>
<p>The parameters of a standard Beta distribution are calculated based on a best-guess estimate and a 100(<code class="reqn">p</code>)% uncertainty range, defined by a lower and/or upper limit. The <code>betaExpert</code> function uses minimization (<code><a href="stats.html#topic+optimize">optimize</a></code>) to derive <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> from this best guess and lower and/or upper limit. The resulting distribution is a standard 2-parameter Beta distribution: Beta(<code class="reqn">\alpha</code>, <code class="reqn">\beta</code>).
</p>


<h3>Value</h3>

<p>A list of class <code>"betaExpert"</code>:
</p>
<table>
<tr><td><code>alpha</code></td>
<td>
<p>Parameter <code class="reqn">\alpha</code> (shape1) of the Beta distribution</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Parameter <code class="reqn">\beta</code> (shape2) of the Beta distribution</p>
</td></tr>
</table>
<p>The <code>print</code> method for <code>"betaExpert"</code> additionally calculates the mean, median, mode, variance and range of the corresponding Beta distribution.
</p>


<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Branscum AJ, Gardner IA, Johnson WO (2005) Estimation of diagnostic-test sensitivity and specificity through Bayesian modeling. <em>Prev Vet Med</em> <strong>68</strong>:145-163.
</p>


<h3>See Also</h3>

<p>Package <span class="pkg"><a href="https://cran.r-project.org/package=rriskDistributions">rriskDistributions</a></span>, which provides a collection of functions for fitting distributions to given data or by known quantiles.<br />
</p>
<p><code><a href="#topic+betaPERT">betaPERT</a></code>, for modelling a generalized Beta distribution based on expert opinion
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Most likely value (mode) is 90%
## Expert states with 95% certainty that true value is larger than 70%
betaExpert(best = 0.90, lower = 0.70, p = 0.95)

## Most likely value (mode) is 0%
## Expert states with 95% certainty that true value is smaller than 40%
betaExpert(best = 0, upper = 0.40, p = 0.95)

## Most likely value (mode) is 80%
## Expert states with 90% certainty that true value lies in between 40% and 90%
betaExpert(best = 0.80, lower = 0.40, upper = 0.90, p = 0.90)

## Mean value is assumed to be 80%
## Expert states with 90% certainty that true value lies in between 40% and 90%
betaExpert(best = 0.80, lower = 0.40, upper = 0.90, p = 0.90, method = "mean")
</code></pre>

<hr>
<h2 id='betaPERT'>Calculate the parameters of a Beta-PERT distribution</h2><span id='topic+betaPERT'></span><span id='topic+print.betaPERT'></span><span id='topic+plot.betaPERT'></span>

<h3>Description</h3>

<p>The Beta-PERT methodology allows to parametrize a generalized Beta distribution based on expert opinion regarding
a pessimistic estimate (minimum value), a most likely estimate (mode), 
and an optimistic estimate (maximum value). The <code>betaPERT</code> function incorporates two methods of
calculating the parameters of a Beta-PERT distribution, designated <code>"classic"</code> and <code>"vose"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betaPERT(a, m, b, k = 4, method = c("classic", "vose"))

## S3 method for class 'betaPERT'
print(x, conf.level = .95, ...)
## S3 method for class 'betaPERT'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betaPERT_+3A_a">a</code></td>
<td>
<p>Pessimistic estimate (Minimum value)</p>
</td></tr>
<tr><td><code id="betaPERT_+3A_m">m</code></td>
<td>
<p>Most likely estimate (Mode)</p>
</td></tr>
<tr><td><code id="betaPERT_+3A_b">b</code></td>
<td>
<p>Optimistic estimate (Maximum value)</p>
</td></tr>
<tr><td><code id="betaPERT_+3A_k">k</code></td>
<td>
<p>Scale parameter</p>
</td></tr>
<tr><td><code id="betaPERT_+3A_method">method</code></td>
<td>
<p><code>"classic"</code> or <code>"vose"</code>; see details below</p>
</td></tr>
<tr><td><code id="betaPERT_+3A_x">x</code></td>
<td>
<p>Object of class <code>betaPERT</code></p>
</td></tr>
<tr><td><code id="betaPERT_+3A_y">y</code></td>
<td>
<p>Currently ignored</p>
</td></tr>
<tr><td><code id="betaPERT_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used in printing quantiles of resulting Beta-PERT distribution</p>
</td></tr>
<tr><td><code id="betaPERT_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to function <code>print</code> and <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Beta-PERT methodology was developed in the context of Program Evaluation and Review Technique (PERT). Based on a pessimistic estimate (minimum value), a most likely estimate (mode), and an optimistic estimate (maximum value), typically derived through expert elicitation, the parameters of a Beta distribution can be calculated. The Beta-PERT distribution is used in stochastic modeling and risk assessment studies to reflect uncertainty regarding specific parameters.
</p>
<p>Different methods exist in literature for defining the parameters of a Beta distribution based on PERT. The two most common methods are included in the <code>BetaPERT</code> function:
</p>

<dl>
<dt><strong>Classic</strong>: </dt><dd><p>The standard formulas for mean, standard deviation, <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>, are as follows:
</p>
<p style="text-align: center;"><code class="reqn">mean = \frac{a + k*m + b}{k + 2}</code>
</p>

<p style="text-align: center;"><code class="reqn">sd = \frac{b - a}{k + 2}</code>
</p>

<p style="text-align: center;"><code class="reqn">\alpha = \frac{mean - a}{b - a} * \left\{ (mean - a) * \frac{b - mean}{sd^{2}} - 1 \right\} </code>
</p>

<p style="text-align: center;"><code class="reqn">\beta = \alpha * \frac{b - mean}{mean - a}</code>
</p>

<p>The resulting distribution is a 4-parameter Beta distribution: Beta(<code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, a, b).<br />
</p>
</dd>
<dt><strong>Vose</strong>: </dt><dd><p>Vose (2000) describes a different formula for <code class="reqn">\alpha</code>:
</p>
<p style="text-align: center;"><code class="reqn">(mean - a) * \frac{2 * m - a - b}{(m - mean) * (b - a)}</code>
</p>

<p>Mean and <code class="reqn">\beta</code> are calculated using the standard formulas; as for the classical PERT,
the resulting distribution is a 4-parameter Beta distribution: Beta(<code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, a, b).<br /><br />
Note: If <code class="reqn">m = mean</code>, <code class="reqn">\alpha</code> is calculated as <code class="reqn">1 + k/2</code>, in accordance with the <span class="pkg">mc2d</span> package (see 'Note').<br />
</p>
</dd>
</dl>



<h3>Value</h3>

<p>A list of class <code>"betaPERT"</code>:
</p>
<table>
<tr><td><code>alpha</code></td>
<td>
<p>Parameter <code class="reqn">\alpha</code> (shape1) of the Beta distribution</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Parameter <code class="reqn">\beta</code> (shape2) of the Beta distribution</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>Pessimistic estimate (Minimum value)</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>Most likely estimate (Mode)</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Optimistic estimate (Maximum value)</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Applied method</p>
</td></tr>
</table>
<p>Available generic functions for class <code>"betaPERT"</code> are <code>print</code> and <code>plot</code>.
</p>


<h3>Note</h3>

<p>The <span class="pkg"><a href="https://cran.r-project.org/package=mc2d">mc2d</a></span> package provides 
the probability density function, cumulative distribution function, quantile function and random number generation function 
for the PERT distribution, parametrized by the <code>"vose"</code> method.
</p>


<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>References</h3>


<dl>
<dt><strong>Classic</strong>: </dt><dd>
<p>Malcolm DG, Roseboom JH, Clark CE, Fazar W (1959) Application of a technique for research and development program evaluation. <em>Oper Res</em> <strong>7</strong>(5):646-669.
</p>
</dd>
<dt><strong>Vose</strong>: </dt><dd>
<p>David Vose. <em>Risk analysis, a quantitative guide, 2nd edition.</em> Wiley and Sons, 2000.<br />
<a href="http://vosesoftware.com/ModelRiskHelp/index.htm%5C#Distributions/Continuous_distributions/PERT_distribution.htm">PERT distribution in <em>ModelRisk</em> (Vose software)</a>
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+betaExpert">betaExpert</a></code>, for modelling a standard Beta distribution based on expert opinion
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The value of a parameter of interest is believed to lie between 0 and 50
## The most likely value is believed to be 10

# Classical PERT
betaPERT(a = 0, m = 10, b = 50, method = "classic")

# Vose parametrization
betaPERT(a = 0, m = 10, b = 50, method = "vose")
</code></pre>

<hr>
<h2 id='convert-methods'>Methods for Function <code>as.matrix</code> in Package <span class="pkg">prevalence</span></h2><span id='topic+convert-methods'></span><span id='topic+as.matrix-methods'></span><span id='topic+as.matrix+2Cprev-method'></span>

<h3>Description</h3>

<p>Convert objects of class <code>prev</code> to matrix</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'prev'
as.matrix(x, iters = FALSE, chains = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert-methods_+3A_x">x</code></td>
<td>
<p>An object of class <code>prev</code></p>
</td></tr>
<tr><td><code id="convert-methods_+3A_iters">iters</code></td>
<td>
<p>Logical flag, indicating whether a column should be added for iteration number; defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="convert-methods_+3A_chains">chains</code></td>
<td>
<p>Logical flag, indicating whether a column should be added for chain number; defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "prev")</code></dt><dd>
<p>Convert objects of class <code>prev</code> to <code><a href="base.html#topic+matrix">matrix</a></code>
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+prev-class">prev-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## Taenia solium cysticercosis 1-test model
cysti &lt;-
truePrev(x = 142, n = 742,
         SE = ~dunif(0.60, 1.00), SP = ~dunif(0.75, 1.00))

head(as.matrix(cysti))


## Campylobacter 2-test model
campy &lt;-
truePrevMulti(
  x = c(113, 46, 156, 341),
  n = 656,
  prior = {
    theta[1] ~ dunif(0.45, 0.80)
    theta[2] ~ dunif(0.24, 0.50)
    theta[3] &lt;- 1
    theta[4] ~ dbeta(30, 12)
    theta[5] ~ dbeta(1, 1)
    theta[6] &lt;- 1
    theta[7] &lt;- 1
  }
)

head(as.matrix(campy, iters = TRUE, chains = TRUE))

## End(Not run)</code></pre>

<hr>
<h2 id='define'>Definition of <code>truePrevMulti</code> and <code>truePrevMulti2</code> model</h2><span id='topic+define_x'></span><span id='topic+define_prior'></span><span id='topic+define_prior2'></span>

<h3>Description</h3>

<p>These utility functions generate definitions for the test results and priors used by <code><a href="#topic+truePrevMulti">truePrevMulti</a></code> and <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_x(h)
define_prior(h)
define_prior2(h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="define_+3A_h">h</code></td>
<td>

<p>Number of tests
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector of apparent tests results, <code>x</code>, must contain the number of samples corresponding to each combination of test results. The models assume that the first value corresponds to the number of samples that tested positive on all tests and that the last value corresponds to the number of samples that tested negative on all tests.<br />
</p>
<p>Function <code><a href="#topic+truePrevMulti">truePrevMulti</a></code> estimates true prevalence from individual samples tested with <code>h</code> tests, using the approach of Berkvens et al. (2006). The prior in the multinomial model consists of a vector <code>theta</code>, which holds values for the true prevalence (TP), the sensitivity and specificity of the first test (SE1, SP1), and the conditional dependencies between the results of the subsequent tests and the preceding one(s). <code><a href="#topic+define_prior">define_prior</a></code> generates the definition of <code>prior</code> for <code>h</code> tests.
</p>
<p>Function <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code> implements and extends the approach described by Dendukuri and Joseph (2001), which uses a multinomial distribution to model observed test results, and in which conditional dependence between tests is modelled through covariances. Argument <code>prior</code> consists of prior distributions for:
</p>

<ul>
<li><p>True Prevalence: <code>TP</code>
</p>
</li>
<li><p>SEnsitivity of each individual test: vector <code>SE</code>
</p>
</li>
<li><p>SPecificity of each individual test: vector <code>SP</code>
</p>
</li>
<li><p>Conditional covariance of all possible test combinations given a truly positive disease status: vector <code>a</code>
</p>
</li>
<li><p>Conditional covariance of all possible test combinations given a truly negative disease status: vector <code>b</code>
</p>
</li></ul>

<p><code><a href="#topic+define_prior2">define_prior2</a></code> generates the definition of <code>prior</code> for <code>h</code> tests.
</p>


<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>References</h3>


<ul>
<li><p>Berkvens D, Speybroeck N, Praet N, Adel A, Lesaffre E (2006) Estimating disease prevalence in a Bayesian framework using probabilistic constraints. <em>Epidemiology</em> <strong>17</strong>:145-153
</p>
</li>
<li><p>Dendukuri N, Joseph L (2001) Bayesian approaches to modeling the conditional dependence between multiple diagnostic tests. <em>Biometrics</em> <strong>57</strong>:158-167
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+truePrevMulti">truePrevMulti</a></code>, <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## how is a 2-test model defined?

define_x(2)
# Definition of the apparent test results, 'x', for 2 tests:
# x[1] : T1-,T2- 
# x[2] : T1-,T2+ 
# x[3] : T1+,T2- 
# x[4] : T1+,T2+

define_prior(2)
# Conditional probability scheme
# Definition of the prior, 'theta', for 2 tests: 
# theta[1] : P(D+) = TP
# theta[2] : P(T1+|D+) = SE1
# theta[3] : P(T1-|D-) = SP1
# theta[4] : P(T2+|D+,T1+)
# theta[5] : P(T2+|D+,T1-)
# theta[6] : P(T2-|D-,T1-)
# theta[7] : P(T2-|D-,T1+)

define_prior2(2)
# Covariance scheme
# Definition of the prior for 2 tests: 
# TP :    True Prevalence 
# SE[1] : Sensitity T1 
# SE[2] : Sensitity T2 
# SP[1] : Specificity T1 
# SP[2] : Specificity T2 
# a[1] :  Covariance(T1,T2|D+) 
# b[1] :  Covariance(T1,T2|D-)

## how is a 3-test model defined?

define_x(3)
# Definition of the apparent test results, 'x', for 3 tests:
# x[1] : T1-,T2-,T3- 
# x[2] : T1-,T2-,T3+ 
# x[3] : T1-,T2+,T3- 
# x[4] : T1-,T2+,T3+ 
# x[5] : T1+,T2-,T3- 
# x[6] : T1+,T2-,T3+ 
# x[7] : T1+,T2+,T3- 
# x[8] : T1+,T2+,T3+

define_prior(3)
# Conditional probability scheme
# Definition of the prior, 'theta', for 3 tests: 
# theta[1] : P(D+) = TP
# theta[2] : P(T1+|D+) = SE1
# theta[3] : P(T1-|D-) = SP1
# theta[4] : P(T2+|D+,T1+)
# theta[5] : P(T2+|D+,T1-)
# theta[6] : P(T2-|D-,T1-)
# theta[7] : P(T2-|D-,T1+)
# theta[8] : P(T3+|D+,T1+,T2+)
# theta[9] : P(T3+|D+,T1+,T2-)
# theta[10] : P(T3+|D+,T1-,T2+)
# theta[11] : P(T3+|D+,T1-,T2-)
# theta[12] : P(T3-|D-,T1-,T2-)
# theta[13] : P(T3-|D-,T1-,T2+)
# theta[14] : P(T3-|D-,T1+,T2-)
# theta[15] : P(T3-|D-,T1+,T2+)

define_prior2(3)
# Covariance scheme
# Definition of the prior for 3 tests: 
# TP :    True Prevalence 
# SE[1] : Sensitity T1 
# SE[2] : Sensitity T2 
# SE[3] : Sensitity T3 
# SP[1] : Specificity T1 
# SP[2] : Specificity T2 
# SP[3] : Specificity T3 
# a[1] :  Covariance(T1,T2|D+) 
# a[2] :  Covariance(T1,T3|D+) 
# a[3] :  Covariance(T2,T3|D+) 
# a[4] :  Covariance(T1,T2,T3|D+) 
# b[1] :  Covariance(T1,T2|D-) 
# b[2] :  Covariance(T1,T3|D-) 
# b[3] :  Covariance(T2,T3|D-) 
# b[4] :  Covariance(T1,T2,T3|D-)
</code></pre>

<hr>
<h2 id='plot-methods'>Methods for Function <code>plot</code> in Package <span class="pkg">prevalence</span></h2><span id='topic+plot-methods'></span><span id='topic+plot+2Cprev-method'></span><span id='topic+plot+2Cprev+2CANY-method'></span>

<h3>Description</h3>

<p>Plot objects of class <code>prev</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'prev,ANY'
plot(x, y = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p>An object of class <code>prev</code></p>
</td></tr>
<tr><td><code id="plot-methods_+3A_y">y</code></td>
<td>
<p>Which parameter to plot? Defaults to <code>NULL</code>, in which case TP will be used</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to the <code>plot</code> function</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "prev", y = "ANY")</code></dt><dd>
<p>Show <code><a href="#topic+densplot-methods">density</a></code>,
<code><a href="#topic+traceplot-methods">trace</a></code>,
<code><a href="#topic+gelman.plot-methods">Brooks-Gelman-Rubin</a></code> and
<code><a href="#topic+autocorr.plot-methods">autocorrelation</a></code> plots.
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+prev-class">prev-class</a></code><br />
<code><a href="#topic+densplot-methods">densplot-methods</a></code>, 
<code><a href="#topic+traceplot-methods">traceplot-methods</a></code>, 
<code><a href="#topic+gelman.plot-methods">gelman.plot-methods</a></code>, 
<code><a href="#topic+autocorr.plot-methods">autocorr.plot-methods</a></code>
</p>

<hr>
<h2 id='plot-methods-coda'>Plotting functions from package <span class="pkg">coda</span></h2><span id='topic+plot-methods-coda'></span><span id='topic+densplot-methods'></span><span id='topic+densplot+2Cprev-method'></span><span id='topic+traceplot-methods'></span><span id='topic+traceplot+2Cprev-method'></span><span id='topic+gelman.plot-methods'></span><span id='topic+gelman.plot+2Cprev-method'></span><span id='topic+autocorr.plot-methods'></span><span id='topic+autocorr.plot+2Cprev-method'></span>

<h3>Description</h3>

<p>Different plotting functions from package <span class="pkg">coda</span> have been
made available as method to class <code>prev</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'prev'
densplot(x, exclude_fixed = TRUE, ...)

## S4 method for signature 'prev'
traceplot(x, exclude_fixed = TRUE, ...)

## S4 method for signature 'prev'
autocorr.plot(x, exclude_fixed = TRUE, chain = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-methods-coda_+3A_x">x</code></td>
<td>
<p>An object of class <code>prev</code></p>
</td></tr>
<tr><td><code id="plot-methods-coda_+3A_exclude_fixed">exclude_fixed</code></td>
<td>
<p>Should fixed parameters be excluded from plotting?
defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="plot-methods-coda_+3A_chain">chain</code></td>
<td>
<p>Which chain to plot in <code>autocorr.plot</code>;
defaults to 1</p>
</td></tr>
<tr><td><code id="plot-methods-coda_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to the specific plot function.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "prev")</code></dt><dd>
<p>Show <a href="coda.html#topic+densplot">density</a>, <a href="coda.html#topic+traceplot">trace</a>,
<a href="coda.html#topic+gelman.plot">Brooks-Gelman-Rubin</a> and
<a href="coda.html#topic+autocorr.plot">autocorrelation</a> plots.
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+prev-class">prev-class</a></code><br />
<code><a href="#topic+plot-methods">plot-methods</a></code><br />
<code><a href="coda.html#topic+densplot">densplot</a></code>, 
<code><a href="coda.html#topic+traceplot">traceplot</a></code>, 
<code><a href="coda.html#topic+gelman.plot">gelman.plot</a></code>, 
<code><a href="coda.html#topic+autocorr.plot">autocorr.plot</a></code>
</p>

<hr>
<h2 id='prev-class'>Class <code>"prev"</code></h2><span id='topic+prev-class'></span>

<h3>Description</h3>

<p>The <code>"prev"</code> class represents output from Bayesian true prevalence
estimation models.
</p>


<h3>Objects from the Class</h3>

<p>Objects of class <code>"prev"</code> are created by <code><a href="#topic+truePrev">truePrev</a></code>, <code><a href="#topic+truePrevMulti">truePrevMulti</a></code>, <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code> and <code><a href="#topic+truePrevPools">truePrevPools</a></code>.
</p>


<h3>Slots</h3>

<p>Objects of class <code>"prev"</code> contain the following four slots:
</p>

<dl>
<dt><code>par</code>:</dt><dd>
<p>A list of input parameters
</p>
</dd>
<dt><code>model</code>:</dt><dd>
<p>The fitted Bayesian model, in BUGS language (S3 class <code>"prevModel"</code>) 
</p>
</dd>
<dt><code>mcmc</code>:</dt><dd>
<p>A list, with one element per chain, of the simulated true prevalences, sensitivities and specificities
</p>
</dd>
<dt><code>diagnostics</code>:</dt><dd>
<p>A list with elements for the Deviance Information Criterion (<code>$DIC</code>), the Brooks-Gelman-Rubin statistic (<code>$BGR</code>), and in the case of <code><a href="#topic+truePrevMulti">truePrevMulti</a></code> and <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code>, the Bayes-P statistic
(<code>$bayesP</code>)
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+truePrev">truePrev</a></code>, <code><a href="#topic+truePrevMulti">truePrevMulti</a></code>, <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code>, <code><a href="#topic+truePrevPools">truePrevPools</a></code><br />
<code><a href="#topic+show-methods">show-methods</a></code>, <code><a href="#topic+print-methods">print-methods</a></code>, <code><a href="#topic+summary-methods">summary-methods</a></code>, <code><a href="#topic+convert-methods">convert-methods</a></code>, <code><a href="#topic+plot-methods">plot-methods</a></code>, <code><a href="#topic+plot-methods-coda">plot-methods-coda</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Taenia solium cysticercosis in Nepal
SE &lt;- list(dist = "uniform", min = 0.60, max = 1.00)
SP &lt;- list(dist = "uniform", min = 0.75, max = 1.00)
TP &lt;- truePrev(x = 142, n = 742, SE = SE, SP = SP)

## Summarize estimates per chain
summary(TP)

## Diagnostic plots
par(mfrow = c(2, 2))
plot(TP)

## Generic plots from package coda
par(mfrow = c(1, 1))
densplot(TP)
traceplot(TP)
gelman.plot(TP)
autocorr.plot(TP)

## Use 'slotNames()' to see the slots of object TP
slotNames(TP)

## Every slot can be accessed using the '@' operator
## Use 'str()' to see the structure of each object
str(TP@par)          # input parameters
str(TP@model)        # fitted model
str(TP@mcmc)         # simulated TP, SE, SP
str(TP@diagnostics)  # DIC and BGR (and bayesP)

## Each element of TP@mcmc inherits from coda class 'mcmc.list'
## List all available methods for this class
methods(class = "mcmc.list")
## List all available functions in the coda package
library(help = "coda")

## Highest Posterior Density interval, from coda package
coda::HPDinterval(TP@mcmc$TP)
</code></pre>

<hr>
<h2 id='print-methods'>Methods for Function <code>print</code> in Package <span class="pkg">prevalence</span></h2><span id='topic+print-methods'></span><span id='topic+print+2Cprev-method'></span>

<h3>Description</h3>

<p>Print objects of class <code>prev</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'prev'
print(x, conf.level = 0.95, dig = 3, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print-methods_+3A_x">x</code></td>
<td>
<p>An object of class <code>prev</code></p>
</td></tr>
<tr><td><code id="print-methods_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level to be used in credibility interval</p>
</td></tr>
<tr><td><code id="print-methods_+3A_dig">dig</code></td>
<td>
<p>Number of decimal digits to print</p>
</td></tr>
<tr><td><code id="print-methods_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to the <code>print</code> function</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "prev")</code></dt><dd><p>Print mean, median, mode, standard deviation and credibility interval of estimated true prevalence, sensitivities and specificities. In addition, print multivariate <a href="coda.html#topic+gelman.diag">Brooks-Gelman-Rubin statistic</a> (or univariate BGR statistic with corresponding upper confidence limit in case of a single stochastic node). BGR values substantially above 1 indicate lack of convergence. For <code>prev</code> objects created by <code><a href="#topic+truePrevMulti">truePrevMulti</a></code>, the Bayes-P statistic is also printed. Bayes-P should be as close to 0.5 as possible.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+prev-class">prev-class</a></code><br />
<code><a href="coda.html#topic+gelman.diag">gelman.diag</a></code>
</p>

<hr>
<h2 id='propCI'>Calculate confidence intervals for prevalences and other proportions</h2><span id='topic+propCI'></span>

<h3>Description</h3>

<p>The <code>propCI</code> function calculates five types of confidence intervals for proportions:
</p>

<ul>
<li><p>Wald interval (= Normal approximation interval, asymptotic interval)
</p>
</li>
<li><p>Agresti-Coull interval (= adjusted Wald interval)
</p>
</li>
<li><p>Exact interval (= Clopper-Pearson interval)
</p>
</li>
<li><p>Jeffreys interval (= Bayesian interval)
</p>
</li>
<li><p>Wilson score interval
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>propCI(x, n, method = "all", level = 0.95, sortby = "level")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="propCI_+3A_x">x</code></td>
<td>
<p>Number of successes (positive samples)</p>
</td></tr>
<tr><td><code id="propCI_+3A_n">n</code></td>
<td>
<p>Number of trials (sample size)</p>
</td></tr>
<tr><td><code id="propCI_+3A_method">method</code></td>
<td>
<p>Confidence interval calculation method; see details</p>
</td></tr>
<tr><td><code id="propCI_+3A_level">level</code></td>
<td>
<p>Confidence level for confidence intervals</p>
</td></tr>
<tr><td><code id="propCI_+3A_sortby">sortby</code></td>
<td>
<p>Sort results by <code>"level"</code> or <code>"method"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Five methods are available for calculating confidence intervals. For convenience, synonyms are allowed. Please refer to the PDF version of the manual for proper formatting of the below formulas.
</p>

<dl>
<dt><code>"agresti.coull", "agresti-coull", "ac"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">\tilde{n} = n + z_{1-\frac{\alpha}{2}}^2</code>
</p>

<p style="text-align: center;"><code class="reqn">\tilde{p} = \frac{1}{\tilde{n}}(x + \frac{1}{2} z_{1-\frac{\alpha}{2}}^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">\tilde{p} \pm z_{1-\frac{\alpha}{2}} \sqrt{\frac{\tilde{p}(1-\tilde{p})}{\tilde{n}}}</code>
</p>

</dd>
<dt><code>"exact", "clopper-pearson", "cp"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">(Beta(\frac{\alpha}{2}; x, n - x + 1), Beta(1 - \frac{\alpha}{2}; x + 1, n - x))</code>
</p>

</dd>
<dt><code>"jeffreys", "bayes"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">(Beta(\frac{\alpha}{2}; x + 0.5, n - x + 0.5), Beta(1 - \frac{\alpha}{2}; x + 0.5, n - x + 0.5))</code>
</p>

</dd>
<dt><code>"wald", "asymptotic", "normal"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">p \pm z_{1-\frac{\alpha}{2}} \sqrt{\frac{p(1-p)}{n}}</code>
</p>

</dd>
<dt><code>"wilson"</code></dt><dd>
<p style="text-align: center;"><code class="reqn">
	  \frac{p + \frac{z_{1-\frac{\alpha}{2}}^2}{2n} \pm z_{1-\frac{\alpha}{2}} \sqrt{\frac{p(1-p)}{n} + \frac{z_{1-\frac{\alpha}{2}}^2}{4n^2}}}
	       {1 + \frac{z_{1-\frac{\alpha}{2}}^2}{n}}
	</code>
</p>

</dd>
</dl>



<h3>Value</h3>

<p>Data frame with seven columns:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Number of successes (positive samples)</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of trials (sample size)</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Proportion of successes (prevalence)</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Confidence interval calculation method</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Confidence level</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>Lower confidence limit</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>Upper confidence limit</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In case the observed prevalence equals 0% (ie, <code>x == 0</code>), an upper one-sided confidence interval is returned. 
In case the observed prevalence equals 100% (ie, <code>x == n</code>), a lower one-sided confidence interval is returned. 
In all other cases, two-sided confidence intervals are returned.
</p>


<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## All methods, 95% confidence intervals
propCI(x = 142, n = 742)

## Wald-type 90%, 95% and 99% confidence intervals
propCI(x = 142, n = 742, method = "wald", level = c(0.90, 0.95, 0.99))
</code></pre>

<hr>
<h2 id='show-methods'>Methods for Function <code>show</code> in Package <span class="pkg">prevalence</span></h2><span id='topic+show-methods'></span><span id='topic+show+2Cprev-method'></span>

<h3>Description</h3>

<p>Show objects of class <code>prev</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'prev'
show(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show-methods_+3A_object">object</code></td>
<td>
<p>An object of class <code>prev</code></p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "prev")</code></dt><dd>
<p>Corresponds to <code>print(object)</code>
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+prev-class">prev-class</a></code>
</p>

<hr>
<h2 id='summary-methods'>Methods for Function <code>summary</code> in Package <span class="pkg">prevalence</span></h2><span id='topic+summary-methods'></span><span id='topic+summary+2Cprev-method'></span>

<h3>Description</h3>

<p>Summarize objects of class <code>prev</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'prev'
summary(object, conf.level)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary-methods_+3A_object">object</code></td>
<td>
<p>An object of class <code>prev</code></p>
</td></tr>
<tr><td><code id="summary-methods_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level to be used in credibility intervals</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "prev")</code></dt><dd>
<p>Obtain mean, median, mode, standard deviation, variance, credibility interval and number of samples for each chain separately and for all chains combined.
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+prev-class">prev-class</a></code><br />
</p>

<hr>
<h2 id='truePrev'>Estimate true prevalence from individuals samples</h2><span id='topic+truePrev'></span>

<h3>Description</h3>

<p>Bayesian estimation of true prevalence from apparent prevalence obtained by
testing <em>individual</em> samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truePrev(x, n, SE = 1, SP = 1, prior = c(1, 1),
         nchains = 2, burnin = 10000, update = 10000,
         verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="truePrev_+3A_x">x</code></td>
<td>
<p>The apparent number of positive samples</p>
</td></tr>
<tr><td><code id="truePrev_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="truePrev_+3A_se">SE</code>, <code id="truePrev_+3A_sp">SP</code></td>
<td>
<p>The prior distribution for sensitivity (SE) and specificity 
SP); see 'Details' below for specification of these distributions</p>
</td></tr>
<tr><td><code id="truePrev_+3A_prior">prior</code></td>
<td>
<p>The parameters of the prior Beta distribution for true
prevalence; defaults to <code>c(1, 1)</code></p>
</td></tr>
<tr><td><code id="truePrev_+3A_nchains">nchains</code></td>
<td>
<p>The number of chains used in the estimation process;
<code>'n'</code> must be <code class="reqn">\ge 2</code></p>
</td></tr>
<tr><td><code id="truePrev_+3A_burnin">burnin</code></td>
<td>
<p>The number of discarded model iterations; defaults to 10,000</p>
</td></tr>
<tr><td><code id="truePrev_+3A_update">update</code></td>
<td>
<p>The number of withheld model iterations; defaults to 10,000</p>
</td></tr>
<tr><td><code id="truePrev_+3A_verbose">verbose</code></td>
<td>
<p>Logical flag, indicating if JAGS process output should be
printed to the R console; defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>truePrev</code> calls on <span class="pkg">JAGS</span>/<span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> to
estimate the true prevalence from the apparent prevalence in a Bayesian
framework. The default model, in BUGS language, is given below. To see the
actual fitted model, see the model slot of the
<a href="#topic+prev-class">prev</a>-object.<br />
</p>
<pre>
  model {
    x ~ dbin(AP, n)
    AP &lt;- SE * TP + (1 - SP) * (1 - TP)
    # SE ~ user-defined (see below)
    # SP ~ user-defined (see below)
    TP ~ dbeta(prior[1], prior[2])
  }
  </pre>  
<p>The test sensitivity (<code>SE</code>) and specificity (<code>SP</code>) can be
specified, independently, as one of <code>"fixed"</code>, <code>"uniform"</code>,
<code>"beta"</code>, <code>"pert"</code>, or <code>"beta-expert"</code>, with <code>"fixed"</code>
as the default.
</p>
<p>Distribution parameters can be specified in a <em>named</em> <code>list()</code>
as follows:
</p>

<ul>
<li><p><strong>Fixed:  </strong><code>list(dist = "fixed", par)</code>
</p>
</li>
<li><p><strong>Uniform:  </strong><code>list(dist = "uniform", min, max)</code>
</p>
</li>
<li><p><strong>Beta:  </strong><code>list(dist = "beta", alpha, beta)</code>
</p>
</li>
<li><p><strong>Beta-PERT:  </strong><code>list(dist = "pert", method, a, m, b, k)</code><br />
<code>'method'</code> must be <code>"classic"</code> or <code>"vose"</code>;<br />
<code>'a'</code> denotes the pessimistic (minimum) estimate, <code>'m'</code> the most
likely estimate, and <code>'b'</code> the optimistic (maximum) estimate;<br />
<code>'k'</code> denotes the scale parameter.<br />
See <code><a href="#topic+betaPERT">betaPERT</a></code> for more information on Beta-PERT parametrization.
</p>
</li>
<li><p><strong>Beta-Expert:  </strong><code>list(dist = "beta-expert", mode, mean, lower, upper, p)</code><br />
<code>'mode'</code> denotes the most likely estimate, <code>'mean'</code> the mean estimate;<br />
<code>'lower'</code> denotes the lower bound, <code>'upper'</code> the upper bound;<br />
<code>'p'</code> denotes the confidence level of the expert.<br />
Only <code>mode</code> or <code>mean</code> should be specified;
<code>lower</code> and <code>upper</code> can be specified together or alone.<br />
See <code><a href="#topic+betaExpert">betaExpert</a></code> for more information on Beta-Expert parametrization.
</p>
</li></ul>

<p>For Uniform, Beta and Beta-PERT distributions, BUGS-style short-hand notation
is also allowed:
</p>

<ul>
<li><p><strong>Uniform: </strong><code>~dunif(min, max)</code>
</p>
</li>
<li><p><strong>Beta: </strong><code>~dbeta(alpha, beta)</code>
</p>
</li>
<li><p><strong>Beta-PERT: </strong><code>~dpert(min, mode, max)</code>
</p>
</li></ul>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+prev-class">prev</a></code>.
</p>


<h3>Note</h3>

<p>Markov chain Monte Carlo sampling in <code>truePrev</code> is performed by
<span class="pkg">JAGS (Just Another Gibbs Sampler)</span> through the
<span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> package. JAGS can be downloaded from
<a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>.
</p>


<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>References</h3>


<ul>
<li><p>Speybroeck N, Devleesschauwer B, Joseph L, Berkvens D (2013) Misclassification errors in prevalence estimation: Bayesian handling with care. <em>Int J Public Health</em> <strong>58</strong>:791-795
</p>
</li>
<li><p>Online Shiny application: <a href="https://cbra.shinyapps.io/truePrev/">https://cbra.shinyapps.io/truePrev/</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><span class="pkg"><a href="coda.html#topic+mcmc">coda</a></span> for various functions that can be applied to the <code>prev@mcmc</code> object<br />
<code><a href="#topic+truePrevMulti">truePrevMulti</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with multiple tests, using a conditional probability scheme<br />
<code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with multiple tests, using a covariance scheme<br />
<code><a href="#topic+truePrevPools">truePrevPools</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>pooled</em> samples<br />
<code><a href="#topic+betaPERT">betaPERT</a></code>: calculate the parameters of a Beta-PERT distribution<br />
<code><a href="#topic+betaExpert">betaExpert</a></code>: calculate the parameters of a Beta distribution based on expert opinion
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Taenia solium cysticercosis in Nepal
## 142 positives out of 742 pigs sampled

## Model SE and SP based on literature data
## Sensitivity ranges uniformly between 60% and 100%
## Specificity ranges uniformly between 75% and 100%
#&gt; BUGS-style:
truePrev(x = 142, n = 742,
         SE = ~dunif(0.60, 1.00), SP = ~dunif(0.75, 1.00))

#&gt; list-style:
SE &lt;- list(dist = "uniform", min = 0.60, max = 1.00)
SP &lt;- list(dist = "uniform", min = 0.75, max = 1.00)
truePrev(x = 142, n = 742, SE = SE, SP = SP)

## Model SE and SP based on expert opinions
## Sensitivity lies in between 60% and 100%; most likely value is 90%
## Specificity is with 95% confidence larger than 75%; most likely value is 90%
SE &lt;- list(dist = "pert", a = 0.60, m = 0.90, b = 1.00)
SP &lt;- list(dist = "beta-expert", mode = 0.90, lower = 0.75, p = 0.95)
truePrev(x = 142, n = 742, SE = SE, SP = SP)

## Model SE and SP as fixed values (each 90%)
truePrev(x = 142, n = 742, SE = 0.90, SP = 0.90)
</code></pre>

<hr>
<h2 id='truePrevMulti'>Estimate true prevalence from individuals samples using multiple tests &ndash; conditional probability scheme</h2><span id='topic+truePrevMulti'></span>

<h3>Description</h3>

<p>Bayesian estimation of true prevalence from apparent prevalence obtained by applying <em>multiple</em> tests to <em>individual</em> samples. <code><a href="#topic+truePrevMulti">truePrevMulti</a></code> implements the approach described by Berkvens et al. (2006), which uses a multinomial distribution to model observed test results, and in which conditional dependence between tests is modelled through conditional probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truePrevMulti(x, n, prior, nchains = 2, burnin = 10000, update = 10000,
              verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="truePrevMulti_+3A_x">x</code></td>
<td>
<p>Vector of apparent test results; see 'Details' below</p>
</td></tr>
<tr><td><code id="truePrevMulti_+3A_n">n</code></td>
<td>
<p>The total sample size</p>
</td></tr>
<tr><td><code id="truePrevMulti_+3A_prior">prior</code></td>
<td>
<p>The prior distribution for <code>theta</code>; see 'Details' below</p>
</td></tr>
<tr><td><code id="truePrevMulti_+3A_nchains">nchains</code></td>
<td>
<p>The number of chains used in the estimation process; must be <code class="reqn">\ge 2</code></p>
</td></tr>
<tr><td><code id="truePrevMulti_+3A_burnin">burnin</code></td>
<td>
<p>The number of discarded model iterations; defaults to 10,000</p>
</td></tr>
<tr><td><code id="truePrevMulti_+3A_update">update</code></td>
<td>
<p>The number of withheld model iterations; defaults to 10,000</p>
</td></tr>
<tr><td><code id="truePrevMulti_+3A_verbose">verbose</code></td>
<td>
<p>Logical flag, indicating if JAGS process output should be printed to the R console; defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+truePrevMulti">truePrevMulti</a></code> calls on <span class="pkg">JAGS</span> via the <span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> package to estimate true prevalence from apparent prevalence in a Bayesian framework. <code><a href="#topic+truePrevMulti">truePrevMulti</a></code> fits a multinomial model to the apparent test results obtained by testing individual samples with a given number of tests. To see the actual fitted model, see the model slot of the <code><a href="#topic+prev-class">prev</a></code>-object.<br />
</p>
<p>The vector of apparent tests results, <code>x</code>, must contain the number of samples corresponding to each combination of test results. To see how this vector is defined for the number of tests <code>h</code> at hand, use <code><a href="#topic+define_x">define_x</a></code>.
</p>
<p>The prior in the multinomial model consists of a vector <code>theta</code>, which holds values for the true prevalence (TP), the sensitivity and specificity of the first test (SE1, SP1), and the conditional dependencies between the results of the subsequent tests and the preceding one(s). To see how this vector is defined for the number of tests <code>n</code> at hand, use <code><a href="#topic+define_prior">define_prior</a></code>.<br />
</p>
<p>The values of <code>prior</code> can be specified in two ways, referred to as BUGS-style and list-style, respectively. See also below for some examples.<br />
</p>
<p>For BUGS-style specification, the values of <code>theta</code> should be given between curly brackets (i.e., <code>{}</code>), separated by line breaks. <code>theta</code> values can be specified to be deterministic (i.e., fixed), using the <code>&lt;-</code> operator, or stochastic, using the <code>~</code> operator. In the latter case, the following distributions can be used:
</p>

<ul>
<li><p><strong>Uniform:  </strong><code>dunif(min, max)</code>
</p>
</li>
<li><p><strong>Beta:  </strong><code>dbeta(alpha, beta)</code>
</p>
</li>
<li><p><strong>Beta-PERT:  </strong><code>dpert(min, mode, max)</code>
</p>
</li></ul>

<p>Alternatively, <code>theta</code> values can  be specified in a <em>named</em> <code>list()</code> as follows:
</p>

<ul>
<li><p><strong>Fixed:  </strong><code>list(dist = "fixed", par)</code>
</p>
</li>
<li><p><strong>Uniform:  </strong><code>list(dist = "uniform", min, max)</code>
</p>
</li>
<li><p><strong>Beta:  </strong><code>list(dist = "beta", alpha, beta)</code>
</p>
</li>
<li><p><strong>Beta-PERT:  </strong><code>list(dist = "pert", method, a, m, b, k)</code><br />
<code>'method'</code> must be <code>"classic"</code> or <code>"vose"</code>;<br />
<code>'a'</code> denotes the pessimistic (minimum) estimate, <code>'m'</code> the most
likely estimate, and <code>'b'</code> the optimistic (maximum) estimate;<br />
<code>'k'</code> denotes the scale parameter.<br />
See <code><a href="#topic+betaPERT">betaPERT</a></code> for more information on Beta-PERT parameterization.
</p>
</li>
<li><p><strong>Beta-Expert:  </strong><code>list(dist = "beta-expert", mode, mean,
  lower, upper, p)</code><br />
<code>'mode'</code> denotes the most likely estimate, <code>'mean'</code> the mean
estimate;<br />
<code>'lower'</code> denotes the lower bound, <code>'upper'</code> the upper bound;<br />
<code>'p'</code> denotes the confidence level of the expert.<br />
Only <code>mode</code> or <code>mean</code> should be specified; <code>lower</code> and
<code>upper</code> can be specified together or alone.<br />
See <code><a href="#topic+betaExpert">betaExpert</a></code> for more information on Beta-Expert parameterization.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code><a href="#topic+prev-class">prev</a></code>.
</p>


<h3>Note</h3>

<p>Markov chain Monte Carlo sampling in <code>truePrevMulti</code> is performed by <span class="pkg">JAGS (Just Another Gibbs Sampler)</span> through the <span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> package. JAGS can be downloaded from <a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>.
</p>


<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>References</h3>


<ul>
<li><p>Berkvens D, Speybroeck N, Praet N, Adel A, Lesaffre E (2006) Estimating disease prevalence in a Bayesian framework using probabilistic constraints. <em>Epidemiology</em> <strong>17</strong>:145-153
</p>
</li>
<li><p>Habib I, Sampers I, Uyttendaele M, De Zutter L, Berkvens D (2008) A Bayesian modelling framework to estimate <em>Campylobacter</em> prevalence and culture methods sensitivity: application to a chicken meat survey in Belgium. <em>J Appl Microbiol</em> <strong>105</strong>:2002-2008
</p>
</li>
<li><p>Geurden T, Berkvens D, Casaert S, Vercruysse J, Claerebout E (2008) A Bayesian evaluation of three diagnostic assays for the detection of <em>Giardia duodenalis</em> in symptomatic and asymptomatic dogs. <em>Vet Parasitol</em> <strong>157</strong>:14-20
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+define_x">define_x</a></code>: how to define the vector of apparent test results <code>x</code><br />
<code><a href="#topic+define_prior">define_prior</a></code>: how to define the vector of <code>theta</code> values in <code>prior</code><br />
</p>
<p><span class="pkg"><a href="coda.html#topic+mcmc">coda</a></span> for various functions that can be applied to the <code>prev@mcmc</code> object<br />
<code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with multiple tests, using a covariance scheme<br />
<code><a href="#topic+truePrev">truePrev</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with a single test<br />
<code><a href="#topic+truePrevPools">truePrevPools</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>pooled</em> samples<br />
<code><a href="#topic+betaPERT">betaPERT</a></code>: calculate the parameters of a Beta-PERT distribution<br />
<code><a href="#topic+betaExpert">betaExpert</a></code>: calculate the parameters of a Beta distribution based on expert opinion
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## ===================================================== ##
## 2-TEST EXAMPLE: Campylobacter                         ##
## ----------------------------------------------------- ##
## Two tests were performed on 656 chicken meat samples  ##
## -&gt; T1 = enrichment culture                            ##
## -&gt; T2 = direct plating                                ##
## The following assumption were made:                   ##
## -&gt; TP is larger than 45% and smaller than 80%         ##
## -&gt; SE1 must lie within 24% and 50%                    ##
## -&gt; SP1 and SP2 both equal 100%                        ##
## -&gt; beta(30, 12) describes P(T2+|D+,T1+)               ##
## The following results were obtained:                  ##
## -&gt; 113 samples T1+,T2+                                ##
## -&gt;  46 samples T1+,T2-                                ##
## -&gt; 156 samples T1-,T2+                                ##
## -&gt; 341 samples T1-,T2-                                ##
## ===================================================== ##

## how is the 2-test model defined?
define_x(2)
define_prior(2)

## fit campylobacter 2-test model
campy &lt;-
truePrevMulti(
  x = c(113, 46, 156, 341),
  n = 656,
  prior = {
    theta[1] ~ dunif(0.45, 0.80)
    theta[2] ~ dunif(0.24, 0.50)
    theta[3] &lt;- 1
    theta[4] ~ dbeta(30, 12)
    theta[5] ~ dbeta(1, 1)
    theta[6] &lt;- 1
    theta[7] &lt;- 1
  }
)

## fit same model using 'list-style'
campy &lt;-
truePrevMulti(
  x = c(113, 46, 156, 341),
  n = 656,
  prior =
    list(
      theta1 = list(dist = "uniform", min = 0.45, max = 0.80),
      theta2 = list(dist = "uniform", min = 0.24, max = 0.50),
      theta3 = 1,
      theta4 = list(dist = "beta", alpha = 30, beta = 12),
      theta5 = list(dist = "beta", alpha = 1, beta = 1),
      theta6 = 1,
      theta7 = 1
    )
)

## show model results
campy

## explore model structure
str(campy)         # overall structure
str(campy@par)     # structure of slot 'par'
str(campy@mcmc)    # structure of slot 'mcmc'
campy@model        # fitted model
campy@diagnostics  # DIC, BGR and Bayes-P values

## standard methods
print(campy)
summary(campy)
par(mfrow = c(2, 2))
plot(campy)         # shows plots of TP by default
plot(campy, "SE1")  # same plots for SE1
plot(campy, "SE2")  # same plots for SE2

## coda plots of TP, SE1, SE2
par(mfrow = c(1, 3))
densplot(campy, col = "red")
traceplot(campy)
gelman.plot(campy)
autocorr.plot(campy)


## ===================================================== ##
## 3-TEST EXAMPLE: Giardia                               ##
## ----------------------------------------------------- ##
## Three tests were performed on stools from 272 dogs    ##
## -&gt; T1 = immunofluorescence assay                      ##
## -&gt; T2 = direct microscopy                             ##
## -&gt; T3 = SNAP immunochromatography                     ##
## The following assumption were made:                   ##
## -&gt; TP is smaller than 20%                             ##
## -&gt; SE1 must be higher than 80%                        ##
## -&gt; SP1 must be higher than 90%                        ##
## The following results were obtained:                  ##
## -&gt;   6 samples T1+,T2+,T3+                            ##
## -&gt;   4 samples T1+,T2+,T3-                            ##
## -&gt;  12 samples T1+,T2-,T3+                            ##
## -&gt;  12 samples T1+,T2-,T3-                            ##
## -&gt;   1 sample  T1-,T2+,T3+                            ##
## -&gt;  14 samples T1-,T2+,T3-                            ##
## -&gt;   3 samples T1-,T2-,T3+                            ##
## -&gt; 220 samples T1-,T2-,T3-                            ##
## ===================================================== ##

## how is the 3-test model defined?
define_x(3)
define_prior(3)

## fit giardia 3-test model
giardia &lt;-
truePrevMulti(
  x = c(6, 4, 12, 12, 1, 14, 3, 220),
  n = 272,
  prior = {
    theta[1] ~ dunif(0.00, 0.20)
    theta[2] ~ dunif(0.90, 1.00)
    theta[3] ~ dunif(0.80, 1.00)
    theta[4] ~ dbeta(1, 1)
    theta[5] ~ dbeta(1, 1)
    theta[6] ~ dbeta(1, 1)
    theta[7] ~ dbeta(1, 1)
    theta[8] ~ dbeta(1, 1)
    theta[9] ~ dbeta(1, 1)
    theta[10] ~ dbeta(1, 1)
    theta[11] ~ dbeta(1, 1)
    theta[12] ~ dbeta(1, 1)
    theta[13] ~ dbeta(1, 1)
    theta[14] ~ dbeta(1, 1)
    theta[15] ~ dbeta(1, 1)
  }
)

## show model results
giardia

## coda densplots
par(mfcol = c(2, 4))
densplot(giardia, col = "red")

## End(Not run)</code></pre>

<hr>
<h2 id='truePrevMulti2'>Estimate true prevalence from individuals samples using multiple tests &ndash; covariance scheme</h2><span id='topic+truePrevMulti2'></span>

<h3>Description</h3>

<p>Bayesian estimation of true prevalence from apparent prevalence obtained by applying <em>multiple</em> tests to <em>individual</em> samples. <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code> implements and extends the approach described by Dendukuri and Joseph (2001), which uses a multinomial distribution to model observed test results,
and in which conditional dependence between tests is modelled through
covariances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truePrevMulti2(x, n, prior, nchains = 2, burnin = 10000, update = 10000,
               verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="truePrevMulti2_+3A_x">x</code></td>
<td>
<p>Vector of apparent test results; see 'Details' below</p>
</td></tr>
<tr><td><code id="truePrevMulti2_+3A_n">n</code></td>
<td>
<p>The total sample size</p>
</td></tr>
<tr><td><code id="truePrevMulti2_+3A_prior">prior</code></td>
<td>
<p>The prior distributions; see 'Details' below</p>
</td></tr>
<tr><td><code id="truePrevMulti2_+3A_nchains">nchains</code></td>
<td>
<p>The number of chains used in the estimation process; must be <code class="reqn">\ge 2</code></p>
</td></tr>
<tr><td><code id="truePrevMulti2_+3A_burnin">burnin</code></td>
<td>
<p>The number of discarded model iterations; defaults to 10,000</p>
</td></tr>
<tr><td><code id="truePrevMulti2_+3A_update">update</code></td>
<td>
<p>The number of withheld model iterations; defaults to 10,000</p>
</td></tr>
<tr><td><code id="truePrevMulti2_+3A_verbose">verbose</code></td>
<td>
<p>Logical flag, indicating if JAGS process output should be printed to the R console; defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code> calls on <span class="pkg">JAGS</span> via the <span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> package to estimate true prevalence from apparent prevalence in a Bayesian framework. <code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code> fits a multinomial model to the apparent test results obtained by testing individual samples with a given number of tests. To see the actual fitted model, see the model slot of the <code><a href="#topic+prev-class">prev</a></code>-object.<br />
</p>
<p>The vector of apparent tests results, <code>x</code>, must contain the number of samples corresponding to each combination of test results. To see how this vector is defined for the number of tests <code>h</code> at hand, use <code><a href="#topic+define_x">define_x</a></code>.
</p>
<p>Argument <code>prior</code> consists of prior distributions for:
</p>

<ul>
<li><p>True Prevalence: <code>TP</code>
</p>
</li>
<li><p>SEnsitivity of each individual test: vector <code>SE</code>
</p>
</li>
<li><p>SPecificity of each individual test: vector <code>SP</code>
</p>
</li>
<li><p>Conditional covariance of all possible test combinations given a truly positive disease status: vector <code>a</code>
</p>
</li>
<li><p>Conditional covariance of all possible test combinations given a truly negative disease status: vector <code>b</code>
</p>
</li></ul>

<p>To see how <code>prior</code> is defined for the number of tests <code>h</code> at hand, use <code><a href="#topic+define_prior2">define_prior2</a></code>.<br />
</p>
<p>The values of <code>prior</code> can be specified in two ways, referred to as BUGS-style and list-style, respectively. See also below for some examples.<br />
</p>
<p>For BUGS-style specification, the values of <code>prior</code> should be given between curly brackets (i.e., <code>{}</code>), separated by line breaks. Priors can be specified to be deterministic (i.e., fixed), using the <code>&lt;-</code> operator, or stochastic, using the <code>~</code> operator. In the latter case, the following distributions can be used:
</p>

<ul>
<li><p><strong>Uniform:  </strong><code>dunif(min, max)</code>
</p>
</li>
<li><p><strong>Beta:  </strong><code>dbeta(alpha, beta)</code>
</p>
</li>
<li><p><strong>Beta-PERT:  </strong><code>dpert(min, mode, max)</code>
</p>
</li></ul>

<p>Alternatively, priors can  be specified in a <em>named</em> <code>list()</code> as follows:
</p>

<ul>
<li><p><strong>Fixed:  </strong><code>list(dist = "fixed", par)</code>
</p>
</li>
<li><p><strong>Uniform:  </strong><code>list(dist = "uniform", min, max)</code>
</p>
</li>
<li><p><strong>Beta:  </strong><code>list(dist = "beta", alpha, beta)</code>
</p>
</li>
<li><p><strong>Beta-PERT:  </strong><code>list(dist = "pert", method, a, m, b, k)</code><br />
<code>'method'</code> must be <code>"classic"</code> or <code>"vose"</code>;<br />
<code>'a'</code> denotes the pessimistic (minimum) estimate, <code>'m'</code> the most
likely estimate, and <code>'b'</code> the optimistic (maximum) estimate;<br />
<code>'k'</code> denotes the scale parameter.<br />
See <code><a href="#topic+betaPERT">betaPERT</a></code> for more information on Beta-PERT parameterization.
</p>
</li>
<li><p><strong>Beta-Expert:  </strong><code>list(dist = "beta-expert", mode, mean,
  lower, upper, p)</code><br />
<code>'mode'</code> denotes the most likely estimate, <code>'mean'</code> the mean
estimate;<br />
<code>'lower'</code> denotes the lower bound, <code>'upper'</code> the upper bound;<br />
<code>'p'</code> denotes the confidence level of the expert.<br />
Only <code>mode</code> or <code>mean</code> should be specified; <code>lower</code> and
<code>upper</code> can be specified together or alone.<br />
See <code><a href="#topic+betaExpert">betaExpert</a></code> for more information on Beta-Expert parameterization.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code><a href="#topic+prev-class">prev</a></code>.
</p>


<h3>Note</h3>

<p>Markov chain Monte Carlo sampling in <code>truePrevMulti2</code> is performed by <span class="pkg">JAGS (Just Another Gibbs Sampler)</span> through the <span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> package. JAGS can be downloaded from <a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>.
</p>


<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>References</h3>


<ul>
<li><p>Dendukuri N, Joseph L (2001) Bayesian approaches to modeling the conditional dependence between multiple diagnostic tests. <em>Biometrics</em> <strong>57</strong>:158-167
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+define_x">define_x</a></code>: how to define the vector of apparent test results <code>x</code><br />
<code><a href="#topic+define_prior2">define_prior2</a></code>: how to define <code>prior</code><br />
</p>
<p><span class="pkg"><a href="coda.html#topic+mcmc">coda</a></span> for various functions that can be applied to the <code>prev@mcmc</code> object<br />
<code><a href="#topic+truePrevMulti">truePrevMulti</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with multiple tests, using a conditional probability scheme<br />
<code><a href="#topic+truePrev">truePrev</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with a single test<br />
<code><a href="#topic+truePrevPools">truePrevPools</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>pooled</em> samples<br />
<code><a href="#topic+betaPERT">betaPERT</a></code>: calculate the parameters of a Beta-PERT distribution<br />
<code><a href="#topic+betaExpert">betaExpert</a></code>: calculate the parameters of a Beta distribution based on expert opinion
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## ===================================================== ##
## 2-TEST EXAMPLE: Strongyloides                         ##
## ----------------------------------------------------- ##
## Two tests were performed on 162 humans                ##
## -&gt; T1 = stool examination                             ##
## -&gt; T2 = serology test                                 ##
## Expert opinion generated the following priors:        ##
## -&gt; SE1 ~ dbeta( 4.44, 13.31)                          ##
## -&gt; SP1 ~ dbeta(71.25,  3.75)                          ##
## -&gt; SE2 ~ dbeta(21.96,  5.49)                          ##
## -&gt; SP2 ~ dbeta( 4.10,  1.76)                          ##
## The following results were obtained:                  ##
## -&gt; 38 samples T1+,T2+                                 ##
## -&gt;  2 samples T1+,T2-                                 ##
## -&gt; 87 samples T1-,T2+                                 ##
## -&gt; 35 samples T1-,T2-                                 ##
## ===================================================== ##

## how is the 2-test model defined?
define_x(2)
define_prior2(2)

## fit Strongyloides 2-test model
## a first model assumes conditional independence
## -&gt; set covariance terms to zero
strongy_indep &lt;-
truePrevMulti2(
  x = c(38, 2, 87, 35),
  n = 162,
  prior = {
    TP ~ dbeta(1, 1)
    SE[1] ~ dbeta( 4.44, 13.31)
    SP[1] ~ dbeta(71.25,  3.75)
    SE[2] ~ dbeta(21.96,  5.49)
    SP[2] ~ dbeta( 4.10,  1.76)
    a[1] &lt;- 0
    b[1] &lt;- 0
  })

## show model results
strongy_indep

## fit same model using 'list-style'
strongy_indep &lt;-
truePrevMulti2(
  x = c(38, 2, 87, 35),
  n = 162,
  prior =
    list(
      TP = list(dist = "beta", alpha = 1, beta = 1),
      SE1 = list(dist = "beta", alpha = 4.44, beta = 13.31),
      SP1 = list(dist = "beta", alpha = 71.25, beta = 3.75),
      SE2 = list(dist = "beta", alpha = 21.96, beta = 5.49),
      SP2 = list(dist = "beta", alpha = 4.10, beta = 1.76),
      a1 = 0,
      b1 = 0
    )
  )

## show model results
strongy_indep

## fit Strongyloides 2-test model
## a second model allows for conditional dependence
## -&gt; a[1] is the covariance between T1 and T2, given D+
## -&gt; b[1] is the covariance between T1 and T2, given D-
## -&gt; a[1] and b[1] can range between +/- 2^-h, ie, (-.25, .25)
strongy &lt;-
truePrevMulti2(
  x = c(38, 2, 87, 35),
  n = 162,
  prior = {
    TP ~ dbeta(1, 1)
    SE[1] ~ dbeta( 4.44, 13.31)
    SP[1] ~ dbeta(71.25,  3.75)
    SE[2] ~ dbeta(21.96,  5.49)
    SP[2] ~ dbeta( 4.10,  1.76)
    a[1] ~ dunif(-0.25, 0.25)
    b[1] ~ dunif(-0.25, 0.25)
  })

## explore model structure
str(strongy)         # overall structure
str(strongy@par)     # structure of slot 'par'
str(strongy@mcmc)    # structure of slot 'mcmc'
strongy@model        # fitted model
strongy@diagnostics  # DIC, BGR and Bayes-P values

## standard methods
print(strongy)
summary(strongy)
par(mfrow = c(2, 2))
plot(strongy)           # shows plots of TP by default
plot(strongy, "SE[1]")  # same plots for SE1
plot(strongy, "SE[2]")  # same plots for SE2
plot(strongy, "SP[1]")  # same plots for SP1
plot(strongy, "SP[2]")  # same plots for SP2
plot(strongy, "a[1]")   # same plots for a[1]
plot(strongy, "b[1]")   # same plots for b[1]

## coda plots of all parameters
par(mfrow = c(2, 4)); densplot(strongy, col = "red")
par(mfrow = c(2, 4)); traceplot(strongy)
par(mfrow = c(2, 4)); gelman.plot(strongy)
par(mfrow = c(2, 4)); autocorr.plot(strongy)

## End(Not run)</code></pre>

<hr>
<h2 id='truePrevPools'>Estimate true prevalence from pooled samples</h2><span id='topic+truePrevPools'></span>

<h3>Description</h3>

<p>Bayesian estimation of true prevalence from apparent prevalence obtained by
testing <em>pooled</em> samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truePrevPools(x, n, SE = 1, SP = 1, prior = c(1, 1),
              nchains = 2, burnin = 10000, update = 10000,
              verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="truePrevPools_+3A_x">x</code></td>
<td>
<p>The vector of indicator variables, indicating whether a pool was
positive (<code>"1"</code>) or negative (<code>"0"</code>)</p>
</td></tr>
<tr><td><code id="truePrevPools_+3A_n">n</code></td>
<td>
<p>The vector of pool sizes</p>
</td></tr>
<tr><td><code id="truePrevPools_+3A_se">SE</code>, <code id="truePrevPools_+3A_sp">SP</code></td>
<td>
<p>The prior distribution for sensitivity (SE) and specificity (SP); see 'Details' below for specification of these distributions</p>
</td></tr>
<tr><td><code id="truePrevPools_+3A_prior">prior</code></td>
<td>
<p>The parameters of the prior Beta distribution for true prevalence; defaults to <code>c(1, 1)</code></p>
</td></tr>
<tr><td><code id="truePrevPools_+3A_nchains">nchains</code></td>
<td>
<p>The number of chains used in the estimation process; <code>nchains</code> must be <code class="reqn">\ge 2</code></p>
</td></tr>
<tr><td><code id="truePrevPools_+3A_burnin">burnin</code></td>
<td>
<p>The number of discarded model iterations; defaults to 10,000</p>
</td></tr>
<tr><td><code id="truePrevPools_+3A_update">update</code></td>
<td>
<p>The number of withheld model iterations; defaults to 10,000</p>
</td></tr>
<tr><td><code id="truePrevPools_+3A_verbose">verbose</code></td>
<td>
<p>Logical flag, indicating if JAGS process output should be printed to the R console; defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>truePrevPools</code> calls on <span class="pkg">JAGS</span>/<span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> 
to estimate the true prevalence from the apparent prevalence in a Bayesian
framework. The default model, in BUGS language, is given below. To see the
actual fitted model, see the model slot of the
<a href="#topic+prev-class">prev</a>-object.<br />
</p>
<pre>
  model {
    for (i in 1:N) {
      x[i] ~ dbern(AP[i])
      AP[i] &lt;- SEpool[i] * (1 - pow(1 - TP, n[i])) + (1 - SPpool[i]) * pow(1 - TP, n[i])
      SEpool[i] &lt;- 1 - (pow(1 - SE, n[i] * TP) * pow(SP, n[i] * (1 - TP)))
      SPpool[i] &lt;- pow(SP, n[i])
    }
  # SE ~ user-defined (see below)
  # SP ~ user-defined (see below)
  TP ~ dbeta(prior[1], prior[2])
  }
  </pre>
<p>The test sensitivity (<code>SE</code>) and specificity (<code>SP</code>) can be specified
by the user, independently, as one of <code>"fixed"</code>, <code>"uniform"</code>,
<code>"beta"</code>, <code>"pert"</code>, or <code>"beta-expert"</code>, with <code>"fixed"</code> as
the default. Note that <code>SE</code> and <code>SP</code> must correspond to the test
characteristics for testing individual samples; <code>truePrevPools</code> will
calculate <code>SEpool</code> and <code>SPpool</code>, the sensitivity and specificitiy
for testing pooled samples, based on Boelaert et al. (2000).
</p>
<p>Distribution parameters can be specified in a <em>named</em> <code>list()</code>
as follows:
</p>

<ul>
<li><p><strong>Fixed:  </strong><code>list(dist = "fixed", par)</code>
</p>
</li>
<li><p><strong>Uniform:  </strong><code>list(dist = "uniform", min, max)</code>
</p>
</li>
<li><p><strong>Beta:  </strong><code>list(dist = "beta", alpha, beta)</code>
</p>
</li>
<li><p><strong>PERT:  </strong><code>list(dist = "pert", method, a, m, b, k)</code><br />
<code>'method'</code> must be <code>"classic"</code> or <code>"vose"</code>;<br />
<code>'a'</code> denotes the pessimistic (minimum) estimate, <code>'m'</code> the most likely estimate, and <code>'b'</code> the optimistic (maximum) estimate;<br />
<code>'k'</code> denotes the scale parameter.<br />
See <code><a href="#topic+betaPERT">betaPERT</a></code> for more information on Beta-PERT parametrization.
</p>
</li>
<li><p><strong>Beta-Expert:  </strong><code>list(dist = "beta-expert", mode, mean, lower, upper, p)</code><br />
<code>'mode'</code> denotes the most likely estimate, <code>'mean'</code> the mean estimate;<br />
<code>'lower'</code> denotes the lower bound, <code>'upper'</code> the upper bound;<br />
<code>'p'</code> denotes the confidence level of the expert.<br />
Only <code>mode</code> or <code>mean</code> should be specified; <code>lower</code> and
<code>upper</code> can be specified together or alone.<br />
See <code><a href="#topic+betaExpert">betaExpert</a></code> for more information on Beta-Expert parameterization.
</p>
</li></ul>

<p>For Uniform, Beta and Beta-PERT distributions, BUGS-style short-hand notation
is also allowed:
</p>

<ul>
<li><p><strong>Uniform: </strong><code>~dunif(min, max)</code>
</p>
</li>
<li><p><strong>Beta: </strong><code>~dbeta(alpha, beta)</code>
</p>
</li>
<li><p><strong>Beta-PERT: </strong><code>~dpert(min, mode, max)</code>
</p>
</li></ul>


<h3>Value</h3>

<p>An object of class <a href="#topic+prev-class">prev</a>.
</p>


<h3>Note</h3>

<p>Markov chain Monte Carlo sampling in <code>truePrevPools</code> is performed by
<span class="pkg">JAGS (Just Another Gibbs Sampler)</span> through the
<span class="pkg"><a href="rjags.html#topic+rjags">rjags</a></span> package. JAGS can be downloaded from
<a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>.
</p>


<h3>Author(s)</h3>

<p>Brecht Devleesschauwer &lt;<a href="mailto:brechtdv@gmail.com">brechtdv@gmail.com</a>&gt;
</p>


<h3>References</h3>


<ul>
<li><p>Speybroeck N, Williams CJ, Lafia KB, Devleesschauwer B, Berkvens D (2012) Estimating the prevalence of infections in vector populations using pools of samples. <em>Med Vet Entomol</em> <strong>26</strong>:361-371
</p>
</li>
<li><p>Boelaert F, Walravens K, Biront P, Vermeersch JP, Berkvens D, Godfroid J (2000) Prevalence of paratuberculosis (Johne's disease) in the Belgian cattle population. <em>Vet Microbiol</em> <strong>77</strong>:269-281
</p>
</li></ul>


<h3>See Also</h3>

<p><span class="pkg"><a href="coda.html#topic+mcmc">coda</a></span> for various functions that can be applied to the <code>prev@mcmc</code> object<br />
<code><a href="#topic+truePrev">truePrev</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with a single test<br />
<code><a href="#topic+truePrevMulti">truePrevMulti</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with multiple tests, using a conditional probability scheme<br />
<code><a href="#topic+truePrevMulti2">truePrevMulti2</a></code>: estimate true prevalence from apparent prevalence obtained by testing <em>individual</em> samples with multiple tests, using a covariance scheme<br />
<code><a href="#topic+betaPERT">betaPERT</a></code>: calculate the parameters of a Beta-PERT distribution<br />
<code><a href="#topic+betaExpert">betaExpert</a></code>: calculate the parameters of a Beta distribution based on expert opinion
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Sandflies in Aurabani, Nepal, 2007
pool_results &lt;- c(0, 0, 0, 0, 0, 0, 0, 0, 1, 0)
pool_sizes &lt;- c(2, 1, 6, 10, 1, 7, 1, 4, 1, 3)

## Sensitivity ranges uniformly between 60% and 95%
## Specificity is considered to be 100%

#&gt; BUGS-style:
truePrevPools(x = pool_results, n = pool_sizes,
              SE = ~dunif(0.60, 0.95), SP = 1)
			  
#&gt; list-style:
SE &lt;- list(dist = "uniform", min = 0.60, max = 0.95)
truePrevPools(x = pool_results, n = pool_sizes,
              SE = SE, SP = 1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
