<!DOCTYPE html><html lang="en"><head><title>Help for package isoorbi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {isoorbi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#isoorbi-package'><p>isoorbi: Process Orbitrap Isotopocule Data</p></a></li>
<li><a href='#orbi_add_blocks_to_plot'><p>Plot blocks background</p></a></li>
<li><a href='#orbi_adjust_block'><p>Manually adjust block delimiters</p></a></li>
<li><a href='#orbi_analyze_shot_noise'><p>Shot noise calculation</p></a></li>
<li><a href='#orbi_calculate_ratios'><p>Calculate direct isotopocule ratios</p></a></li>
<li><a href='#orbi_calculate_summarized_ratio'><p>Calculate isotopocule ratio</p></a></li>
<li><a href='#orbi_default_theme'><p>Default isoorbi plotting theme</p></a></li>
<li><a href='#orbi_define_basepeak'><p>Define the denominator for ratio calculation</p></a></li>
<li><a href='#orbi_define_block_for_flow_injection'><p>Define data block for flow injection</p></a></li>
<li><a href='#orbi_define_blocks_for_dual_inlet'><p>Binning raw data into blocks for dual inlet analyses</p></a></li>
<li><a href='#orbi_export_data_to_excel'><p>Export data frame to excel</p></a></li>
<li><a href='#orbi_filter_flagged_data'><p>Filter out flagged data</p></a></li>
<li><a href='#orbi_filter_isox'><p>Basic generic filter for IsoX data</p></a></li>
<li><a href='#orbi_filter_satellite_peaks'><p>Function replaced by <code>orbi_flag_satellite_peaks()</code></p></a></li>
<li><a href='#orbi_filter_scan_intensity'><p>Function replaced by <code>orbi_flag_outliers()</code></p></a></li>
<li><a href='#orbi_filter_weak_isotopocules'><p>Function replaced by <code>orbi_flag_weak_isotopocules()</code></p></a></li>
<li><a href='#orbi_find_isox'><p>Find isox files</p></a></li>
<li><a href='#orbi_flag_outliers'><p>Flag outlier scans</p></a></li>
<li><a href='#orbi_flag_satellite_peaks'><p>Flag minor satellite peaks</p></a></li>
<li><a href='#orbi_flag_weak_isotopocules'><p>Flag weak isotopocules</p></a></li>
<li><a href='#orbi_get_blocks_info'><p>Summarize blocks info</p></a></li>
<li><a href='#orbi_get_isotopocule_coverage'><p>Calculate isotopocule coverage</p></a></li>
<li><a href='#orbi_get_settings'><p>Get all isoorbi package settings</p></a></li>
<li><a href='#orbi_plot_isotopocule_coverage'><p>Plot isotopocule coverage</p></a></li>
<li><a href='#orbi_plot_raw_data'><p>Visualize raw data</p></a></li>
<li><a href='#orbi_plot_satellite_peaks'><p>Visualize satellite peaks</p></a></li>
<li><a href='#orbi_plot_shot_noise'><p>Make a shot noise plot</p></a></li>
<li><a href='#orbi_read_isox'><p>Read IsoX file</p></a></li>
<li><a href='#orbi_segment_blocks'><p>Segment data blocks</p></a></li>
<li><a href='#orbi_set_settings'><p>Set package settings</p></a></li>
<li><a href='#orbi_simplify_isox'><p>Simplify IsoX data</p></a></li>
<li><a href='#orbi_summarize_results'><p>Generate the results table</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Process Orbitrap Isotopocule Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-26</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://isoorbi.isoverse.org/">https://isoorbi.isoverse.org/</a>, <a href="https://github.com/isoverse/isoorbi">https://github.com/isoverse/isoorbi</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/isoverse/isoorbi/issues">https://github.com/isoverse/isoorbi/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils (&ge; 4.1.0), stats (&ge; 4.1.0), rlang (&ge; 1.0.0),
lifecycle (&ge; 1.0.0), tidyr (&ge; 1.2.0), dplyr (&ge; 1.1.1),
ggplot2 (&ge; 3.4.0), scales (&ge; 1.2.1), readr (&ge; 2.1.0),
tidyselect (&ge; 1.2.0), openxlsx, purrr, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>devtools, knitr, rmarkdown, testthat, forcats</td>
</tr>
<tr>
<td>Description:</td>
<td>Read and process isotopocule data from an Orbitrap Isotope Solutions mass spectrometer. Citation: Kantnerova et al. (Nature Protocols, 2024).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-27 04:49:57 UTC; caj</td>
</tr>
<tr>
<td>Author:</td>
<td>Caj Neubauer <a href="https://orcid.org/0000-0002-5348-5609"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Sebastian Kopf <a href="https://orcid.org/0000-0002-2044-0201"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Kristýna Kantnerová
    <a href="https://orcid.org/0000-0001-6259-3225"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Caj Neubauer &lt;caj.neubauer@colorado.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-27 05:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='isoorbi-package'>isoorbi: Process Orbitrap Isotopocule Data</h2><span id='topic+isoorbi'></span><span id='topic+isoorbi-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Read and process isotopocule data from an Orbitrap Isotope Solutions mass spectrometer. Citation: Kantnerova et al. (Nature Protocols, 2024).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Caj Neubauer <a href="mailto:caj.neubauer@colorado.edu">caj.neubauer@colorado.edu</a> (<a href="https://orcid.org/0000-0002-5348-5609">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Sebastian Kopf <a href="mailto:sebastian.kopf@colorado.edu">sebastian.kopf@colorado.edu</a> (<a href="https://orcid.org/0000-0002-2044-0201">ORCID</a>)
</p>
</li>
<li><p> Kristýna Kantnerová <a href="mailto:kristyna.kantnerova@colorado.edu">kristyna.kantnerova@colorado.edu</a> (<a href="https://orcid.org/0000-0001-6259-3225">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://isoorbi.isoverse.org/">https://isoorbi.isoverse.org/</a>
</p>
</li>
<li> <p><a href="https://github.com/isoverse/isoorbi">https://github.com/isoverse/isoorbi</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/isoverse/isoorbi/issues">https://github.com/isoverse/isoorbi/issues</a>
</p>
</li></ul>


<hr>
<h2 id='orbi_add_blocks_to_plot'>Plot blocks background</h2><span id='topic+orbi_add_blocks_to_plot'></span>

<h3>Description</h3>

<p>This function can be used to add colored background to a plot of dual-inlet data where different colors signify different data types (data, startup time, changeover time, unused). Note that this function only works with continuous and pseudo-log y axis, not with log y axes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_add_blocks_to_plot(
  plot,
  x = c("guess", "scan.no", "time.min"),
  data_only = FALSE,
  fill = .data$data_type,
  fill_colors = c("#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02",
    "#A6761D", "#666666"),
  fill_scale = scale_fill_manual("blocks", values = fill_colors),
  alpha = 0.5,
  show.legend = !data_only
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_add_blocks_to_plot_+3A_plot">plot</code></td>
<td>
<p>object with a dataset that has defined blocks</p>
</td></tr>
<tr><td><code id="orbi_add_blocks_to_plot_+3A_x">x</code></td>
<td>
<p>which x-axis to use (time vs. scan number). If set to &quot;guess&quot; (the default), the function will try to figure it out from the plot.</p>
</td></tr>
<tr><td><code id="orbi_add_blocks_to_plot_+3A_data_only">data_only</code></td>
<td>
<p>if set to TRUE, only the blocks flagged as &quot;data&quot; (<code>setting("data_type_data")</code>) are highlighted</p>
</td></tr>
<tr><td><code id="orbi_add_blocks_to_plot_+3A_fill">fill</code></td>
<td>
<p>what to use for the fill aesthetic, default is the block <code>data_type</code></p>
</td></tr>
<tr><td><code id="orbi_add_blocks_to_plot_+3A_fill_colors">fill_colors</code></td>
<td>
<p>which colors to use, by default a color-blind friendly color palettes (RColorBrewer, dark2)</p>
</td></tr>
<tr><td><code id="orbi_add_blocks_to_plot_+3A_fill_scale">fill_scale</code></td>
<td>
<p>use this parameter to replace the entire fill scale rather than just the <code>fill_colors</code></p>
</td></tr>
<tr><td><code id="orbi_add_blocks_to_plot_+3A_alpha">alpha</code></td>
<td>
<p>opacity settings for the background</p>
</td></tr>
<tr><td><code id="orbi_add_blocks_to_plot_+3A_show.legend">show.legend</code></td>
<td>
<p>whether to include the background information in the legend</p>
</td></tr>
</table>

<hr>
<h2 id='orbi_adjust_block'>Manually adjust block delimiters</h2><span id='topic+orbi_adjust_block'></span>

<h3>Description</h3>

<p>This function can be used to manually adjust where certain <code>block</code> starts or ends using either time or scan number.
Note that adjusting blocks removes all block segmentation. Make sure to call <code><a href="#topic+orbi_segment_blocks">orbi_segment_blocks()</a></code> <strong>after</strong> adjusting block delimiters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_adjust_block(
  dataset,
  block,
  filename = NULL,
  shift_start_time.min = NULL,
  shift_end_time.min = NULL,
  shift_start_scan.no = NULL,
  shift_end_scan.no = NULL,
  set_start_time.min = NULL,
  set_end_time.min = NULL,
  set_start_scan.no = NULL,
  set_end_scan.no = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_adjust_block_+3A_dataset">dataset</code></td>
<td>
<p>tibble produced by <code><a href="#topic+orbi_define_blocks_for_dual_inlet">orbi_define_blocks_for_dual_inlet()</a></code></p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_block">block</code></td>
<td>
<p>the block for which to adjust the start and/or end</p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_filename">filename</code></td>
<td>
<p>needs to be specified only if the <code>dataset</code> has more than one <code>filename</code></p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_shift_start_time.min">shift_start_time.min</code></td>
<td>
<p>if provided, the start time of the block will be shifted by this many minutes (use negative numbers to shift back)</p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_shift_end_time.min">shift_end_time.min</code></td>
<td>
<p>if provided, the end time of the block will be shifted by this many minutes (use negative numbers to shift back)</p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_shift_start_scan.no">shift_start_scan.no</code></td>
<td>
<p>if provided, the start of the block will be shifted by this many scans (use negative numbers to shift back)</p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_shift_end_scan.no">shift_end_scan.no</code></td>
<td>
<p>if provided, the end of the block will be shifted by this many scans (use negative numbers to shift back)</p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_set_start_time.min">set_start_time.min</code></td>
<td>
<p>if provided, sets the start time of the block as close as possible to this time</p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_set_end_time.min">set_end_time.min</code></td>
<td>
<p>if provided, sets the end time of the block as close as possible to this time</p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_set_start_scan.no">set_start_scan.no</code></td>
<td>
<p>if provided, sets the start of the block to this scan number (scan must exist in the <code>dataset</code>)</p>
</td></tr>
<tr><td><code id="orbi_adjust_block_+3A_set_end_scan.no">set_end_scan.no</code></td>
<td>
<p>if provided, sets the end of the block to this scan number (scan must exist in the <code>dataset</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (tibble) with block limits altered according to the provided start/end change parameters. Any data that is no longer part of the original block will be marked with the value of <code>orbi_get_settings("data_type_unused")</code>. Any previously applied segmentation will be discarded (<code>segment</code> column set to <code>NA</code>) to avoid unintended side effects.
</p>

<hr>
<h2 id='orbi_analyze_shot_noise'>Shot noise calculation</h2><span id='topic+orbi_analyze_shot_noise'></span>

<h3>Description</h3>

<p>This function computes the shot noise calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_analyze_shot_noise(dataset, include_flagged_data = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_analyze_shot_noise_+3A_dataset">dataset</code></td>
<td>
<p>a data frame output after running <code>orbi_define_basepeak()</code></p>
</td></tr>
<tr><td><code id="orbi_analyze_shot_noise_+3A_include_flagged_data">include_flagged_data</code></td>
<td>
<p>whether to include flagged data in the shot noise calculation (FALSE by default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Analyze shot noise
</p>
<p>will calculate for all combinations of <code>filename</code>, <code>compound</code>, and <code>isotopocule</code> in the provided <code>dataset</code>
</p>


<h3>Value</h3>

<p>The processed data frame with new columns: <code>n_effective_ions</code>, <code>ratio</code>, <code>ratio_rel_se.permil</code>, <code>shot_noise.permil</code>
</p>

<hr>
<h2 id='orbi_calculate_ratios'>Calculate direct isotopocule ratios</h2><span id='topic+orbi_calculate_ratios'></span>

<h3>Description</h3>

<p>This function calculates isotopocule/base peak ratios for all isotopocules. It does not summarize or average the ratios in any way. For a summarizing version of this function, see <code>orbi_summarize_results()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_calculate_ratios(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_calculate_ratios_+3A_dataset">dataset</code></td>
<td>
<p>A data frame output after running <code>orbi_define_basepeak()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a mutated dataset with <code>ratio</code> column added.
</p>

<hr>
<h2 id='orbi_calculate_summarized_ratio'>Calculate isotopocule ratio</h2><span id='topic+orbi_calculate_summarized_ratio'></span>

<h3>Description</h3>

<p>This function calculates the ratio of two isotopocules (the <code>numerator</code> and <code>denominator</code>). This function averages multiple measurements of each using the <code>ratio_method</code> and returns a single value. Normally this function is not called directly by the user, but via the function <code><a href="#topic+orbi_summarize_results">orbi_summarize_results()</a></code>, which calculates isotopocule ratios and other results for an entire dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_calculate_summarized_ratio(
  numerator,
  denominator,
  ratio_method = c("direct", "mean", "sum", "median", "geometric_mean", "slope",
    "weighted_sum")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_calculate_summarized_ratio_+3A_numerator">numerator</code></td>
<td>
<p>Column(s) used as numerator; contains ion counts</p>
</td></tr>
<tr><td><code id="orbi_calculate_summarized_ratio_+3A_denominator">denominator</code></td>
<td>
<p>Column used as denominator; contains ion counts</p>
</td></tr>
<tr><td><code id="orbi_calculate_summarized_ratio_+3A_ratio_method">ratio_method</code></td>
<td>
<p>Method for computing the ratio. <strong>Please note well</strong>: the formula used to calculate ion ratios matters! Do not simply use arithmetic mean. The best option may depend on the type of data you are processing (e.g., MS1 versus M+1 fragmentation). <code>ratio_method</code> can be one of the following:
</p>

<ul>
<li> <p><code>mean</code>: arithmetic mean of ratios from individual scans.
</p>
</li>
<li> <p><code>sum</code>: sum of all ions of the numerator across all scans divided by the sum of all ions observed for the denominator across all scans.
</p>
</li>
<li> <p><code>geometric_mean</code>: geometric mean of ratios from individual scans.
</p>
</li>
<li> <p><code>slope</code>: The ratio is calculated using the slope obtained from a linear regression model that is weighted by the <code style="white-space: pre;">&#8288;numerator x&#8288;</code>, using <code>stats::lm(x ~ y + 0, weights = x)</code>.
</p>
</li>
<li> <p><code>weighted_sum</code>: A derivative of the <code>sum</code> option. The weighing function ensures that each scan contributes equal weight to the ratio calculation,
i.e. scans with more ions in the Orbitrap do not contribute disproportionately to the total <code>sum</code> of <code>x</code> and <code>y</code> that is used to calculate <code>x/y</code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Single value ratio between the isotopocules defined as <code>numerator</code> and <code>denominator</code> calculated using the <code>ratio_method</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;-
  system.file("extdata", "testfile_flow.isox", package = "isoorbi") |&gt;
  orbi_read_isox()

ions_18O &lt;- dplyr::filter(df, isotopocule == "18O")$ions.incremental
ions_M0 &lt;- dplyr::filter(df, isotopocule == "M0")$ions.incremental

orbi_calculate_summarized_ratio(
  numerator = ions_18O, denominator = ions_M0, ratio_method = "sum"
)

orbi_calculate_summarized_ratio(
  numerator = ions_18O, denominator = ions_M0, ratio_method = "slope"
)

</code></pre>

<hr>
<h2 id='orbi_default_theme'>Default isoorbi plotting theme</h2><span id='topic+orbi_default_theme'></span>

<h3>Description</h3>

<p>Default isoorbi plotting theme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_default_theme(text_size = 16, facet_text_size = 20)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_default_theme_+3A_text_size">text_size</code></td>
<td>
<p>a font size for text</p>
</td></tr>
<tr><td><code id="orbi_default_theme_+3A_facet_text_size">facet_text_size</code></td>
<td>
<p>a font size for facet text</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot theme object
</p>

<hr>
<h2 id='orbi_define_basepeak'>Define the denominator for ratio calculation</h2><span id='topic+orbi_define_basepeak'></span>

<h3>Description</h3>

<p><code>orbi_define_basepeak()</code> sets one isotopocule in the data frame as the base peak (ratio denominator) and calculates the instantaneous isotope ratios against it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_define_basepeak(dataset, basepeak_def)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_define_basepeak_+3A_dataset">dataset</code></td>
<td>
<p>A tibble from a <code>IsoX</code> output. Needs to contain columns for <code>filename</code>, <code>compound</code>, <code>scan.no</code>, <code>isotopocule</code>, and <code>ions.incremental</code>.</p>
</td></tr>
<tr><td><code id="orbi_define_basepeak_+3A_basepeak_def">basepeak_def</code></td>
<td>
<p>The isotopocule that gets defined as base peak, i.e. the denominator to calculate ratios</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Input data frame without the rows of the basepeak isotopocule and instead three new columns called <code>basepeak</code>, <code>basepeak_ions</code>, and <code>ratio</code> holding the basepeak information and the isotope ratios vs. the base peak
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fpath &lt;- system.file("extdata", "testfile_flow.isox", package = "isoorbi")
df &lt;- orbi_read_isox(file = fpath) |&gt;
  orbi_simplify_isox() |&gt;
  orbi_define_basepeak(basepeak_def = "M0")

</code></pre>

<hr>
<h2 id='orbi_define_block_for_flow_injection'>Define data block for flow injection</h2><span id='topic+orbi_define_block_for_flow_injection'></span>

<h3>Description</h3>

<p>Define a data block by either start and end time or start and end scan number.
If you want to make segments in the blocks (optional), note that this function - manually defining blocks - removes all block segmentation. Make sure to call <code><a href="#topic+orbi_segment_blocks">orbi_segment_blocks()</a></code> <strong>only after</strong> finishing block definitions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_define_block_for_flow_injection(
  dataset,
  start_time.min = NULL,
  end_time.min = NULL,
  start_scan.no = NULL,
  end_scan.no = NULL,
  sample_name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_define_block_for_flow_injection_+3A_dataset">dataset</code></td>
<td>
<p>tibble with Orbitrap data</p>
</td></tr>
<tr><td><code id="orbi_define_block_for_flow_injection_+3A_start_time.min">start_time.min</code></td>
<td>
<p>set the start time of the block</p>
</td></tr>
<tr><td><code id="orbi_define_block_for_flow_injection_+3A_end_time.min">end_time.min</code></td>
<td>
<p>set the end time of the block</p>
</td></tr>
<tr><td><code id="orbi_define_block_for_flow_injection_+3A_start_scan.no">start_scan.no</code></td>
<td>
<p>set the start scan of the block</p>
</td></tr>
<tr><td><code id="orbi_define_block_for_flow_injection_+3A_end_scan.no">end_scan.no</code></td>
<td>
<p>set the end scan of the block</p>
</td></tr>
<tr><td><code id="orbi_define_block_for_flow_injection_+3A_sample_name">sample_name</code></td>
<td>
<p>if provided, will be used as the <code>sample_name</code> for the block</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (tibble) with block definition added. Any data that is not part of a block will be marked with the value of <code>orbi_get_settings("data_type_unused")</code>. Any previously applied segmentation will be discarded (<code>segment</code> column set to <code>NA</code>) to avoid unintended side effects.
</p>

<hr>
<h2 id='orbi_define_blocks_for_dual_inlet'>Binning raw data into blocks for dual inlet analyses</h2><span id='topic+orbi_define_blocks_for_dual_inlet'></span>

<h3>Description</h3>

<p>This function sorts out (bins) data into indivual blocks of reference, sample, changeover time, and startup time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_define_blocks_for_dual_inlet(
  dataset,
  ref_block_time.min,
  change_over_time.min,
  sample_block_time.min = ref_block_time.min,
  startup_time.min = 0,
  ref_block_name = setting("di_ref_name"),
  sample_block_name = setting("di_sample_name")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_define_blocks_for_dual_inlet_+3A_dataset">dataset</code></td>
<td>
<p>A data frame or tibble produced from IsoX data by <code><a href="#topic+orbi_simplify_isox">orbi_simplify_isox()</a></code></p>
</td></tr>
<tr><td><code id="orbi_define_blocks_for_dual_inlet_+3A_ref_block_time.min">ref_block_time.min</code></td>
<td>
<p>time where the signal is stable when reference is analyzed</p>
</td></tr>
<tr><td><code id="orbi_define_blocks_for_dual_inlet_+3A_change_over_time.min">change_over_time.min</code></td>
<td>
<p>time where the signal is unstable after switching from reference to sample or back</p>
</td></tr>
<tr><td><code id="orbi_define_blocks_for_dual_inlet_+3A_sample_block_time.min">sample_block_time.min</code></td>
<td>
<p>time where the signal is stable when sample is analyzed</p>
</td></tr>
<tr><td><code id="orbi_define_blocks_for_dual_inlet_+3A_startup_time.min">startup_time.min</code></td>
<td>
<p>initial time to stabilize spray</p>
</td></tr>
<tr><td><code id="orbi_define_blocks_for_dual_inlet_+3A_ref_block_name">ref_block_name</code></td>
<td>
<p>the name of the reference being measured</p>
</td></tr>
<tr><td><code id="orbi_define_blocks_for_dual_inlet_+3A_sample_block_name">sample_block_name</code></td>
<td>
<p>the name of the sample being measured</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (tibble) with block annotations in the form of the additional columns described below:
</p>

<ul>
<li> <p><code>data_group</code> is an integer that numbers each data group (whether that's startup, a sample block, a segment, etc.) in each file sequentially to uniquely identify groups of data that belong together - this columns is NOT static (i.e. functions like <code><a href="#topic+orbi_adjust_block">orbi_adjust_block()</a></code> and <code><a href="#topic+orbi_segment_blocks">orbi_segment_blocks()</a></code> will lead to renumbering) and should be used purely for grouping purposes in calculations and visualization
</p>
</li>
<li> <p><code>block</code> is an integer counting the data blocks in each file (0 is the startup block)
</p>
</li>
<li> <p><code>sample_name</code> is the name of the material being measured as defined by the <code>ref_block_name</code> and <code>sample_block_name</code> parameters
</p>
</li>
<li> <p><code>segment</code> is an integer defines segments within individual blocks - this will be <code>NA</code> until the optional <code><a href="#topic+orbi_segment_blocks">orbi_segment_blocks()</a></code> is called
</p>
</li>
<li> <p><code>data_type</code> is a text value describing the type of data in each <code>data_group</code> - for a list of the main categories, call <code>orbi_get_settings("data_type")</code>
</p>
</li></ul>


<hr>
<h2 id='orbi_export_data_to_excel'>Export data frame to excel</h2><span id='topic+orbi_export_data_to_excel'></span>

<h3>Description</h3>

<p>This functions exports the final <code>dataset</code> into an Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_export_data_to_excel(
  dataset,
  file,
  dbl_digits = 7,
  int_format = "0",
  dbl_format = sprintf(sprintf("%%.%df", dbl_digits), 0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_export_data_to_excel_+3A_dataset">dataset</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="orbi_export_data_to_excel_+3A_file">file</code></td>
<td>
<p>file path to export the file</p>
</td></tr>
<tr><td><code id="orbi_export_data_to_excel_+3A_dbl_digits">dbl_digits</code></td>
<td>
<p>how many digits to show for dbls (all are exported)</p>
</td></tr>
<tr><td><code id="orbi_export_data_to_excel_+3A_int_format">int_format</code></td>
<td>
<p>the excel formatting style for integers</p>
</td></tr>
<tr><td><code id="orbi_export_data_to_excel_+3A_dbl_format">dbl_format</code></td>
<td>
<p>the excel formatting style for doubles (created automatically from the dbl_digits parameter)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns dataset invisibly for use in pipes
</p>

<hr>
<h2 id='orbi_filter_flagged_data'>Filter out flagged data</h2><span id='topic+orbi_filter_flagged_data'></span>

<h3>Description</h3>

<p>This function filters out data that have been previously flagged using functions <code>orbi_flag_satellite_peaks()</code>, <code>orbi_flag_weak_isotopocules()</code>, and/or <code>orbi_flag_outliers()</code>. Note that this function is no longer necessary to call explicitly as <code>orbi_analyze_shot_noise()</code> and <code>orbi_summarize_results()</code> automatically exclude flagged data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_filter_flagged_data(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_filter_flagged_data_+3A_dataset">dataset</code></td>
<td>
<p>a tibble with previously flagged data from <code>orbi_flag_satellite_peaks()</code>, <code>orbi_flag_weak_isotopocules()</code>, and/or <code>orbi_flag_outliers()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataset with the flagged data filtered out
</p>

<hr>
<h2 id='orbi_filter_isox'>Basic generic filter for IsoX data</h2><span id='topic+orbi_filter_isox'></span>

<h3>Description</h3>

<p>A basic filter function <code>orbi_filter_isox()</code> for file names, isotopocules, compounds and time ranges. Default value for all parameters is NULL, i.e. no filter is applied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_filter_isox(
  dataset,
  filenames = NULL,
  compounds = NULL,
  isotopocules = NULL,
  time_min = NULL,
  time_max = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_filter_isox_+3A_dataset">dataset</code></td>
<td>
<p>The IsoX data to be filtered</p>
</td></tr>
<tr><td><code id="orbi_filter_isox_+3A_filenames">filenames</code></td>
<td>
<p>Vector of file names to keep, keeps all if set to <code>NULL</code> (the default)</p>
</td></tr>
<tr><td><code id="orbi_filter_isox_+3A_compounds">compounds</code></td>
<td>
<p>Vector of compounds to keep, keeps all if set to <code>NULL</code> (the default)</p>
</td></tr>
<tr><td><code id="orbi_filter_isox_+3A_isotopocules">isotopocules</code></td>
<td>
<p>Vector of isotopocules to keep, keeps all if set to <code>NULL</code> (the default)</p>
</td></tr>
<tr><td><code id="orbi_filter_isox_+3A_time_min">time_min</code></td>
<td>
<p>Minimum retention time in minutes (<code>time.min</code>), no minimum if set to <code>NULL</code> (the default)</p>
</td></tr>
<tr><td><code id="orbi_filter_isox_+3A_time_max">time_max</code></td>
<td>
<p>Maximum retention time in minutes (<code>time.min</code>), no maximum if set to <code>NULL</code> (the default)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Filtered tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fpath &lt;- system.file("extdata", "testfile_flow.isox", package = "isoorbi")
df &lt;-
  orbi_read_isox(file = fpath) |&gt;
  orbi_simplify_isox() |&gt;
  orbi_filter_isox(
    filenames = c("s3744"),
    compounds = "HSO4-",
    isotopocules = c("M0", "34S", "18O")
  )

</code></pre>

<hr>
<h2 id='orbi_filter_satellite_peaks'>Function replaced by <code>orbi_flag_satellite_peaks()</code></h2><span id='topic+orbi_filter_satellite_peaks'></span>

<h3>Description</h3>

<p>Function replaced by <code>orbi_flag_satellite_peaks()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_filter_satellite_peaks(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_filter_satellite_peaks_+3A_...">...</code></td>
<td>
<p>parameters passed on to the new function <code><a href="#topic+orbi_flag_satellite_peaks">orbi_flag_satellite_peaks()</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='orbi_filter_scan_intensity'>Function replaced by <code>orbi_flag_outliers()</code></h2><span id='topic+orbi_filter_scan_intensity'></span>

<h3>Description</h3>

<p>Function replaced by <code>orbi_flag_outliers()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_filter_scan_intensity(..., outlier_percent)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_filter_scan_intensity_+3A_...">...</code></td>
<td>
<p>parameters passed on to the new function <code><a href="#topic+orbi_flag_outliers">orbi_flag_outliers()</a></code>.</p>
</td></tr>
<tr><td><code id="orbi_filter_scan_intensity_+3A_outlier_percent">outlier_percent</code></td>
<td>
<p>outlier_percent needs to be between 0 and 10, flags extreme scans based on TIC x injection time (i.e., ion intensity)</p>
</td></tr>
</table>

<hr>
<h2 id='orbi_filter_weak_isotopocules'>Function replaced by <code>orbi_flag_weak_isotopocules()</code></h2><span id='topic+orbi_filter_weak_isotopocules'></span>

<h3>Description</h3>

<p>Function replaced by <code>orbi_flag_weak_isotopocules()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_filter_weak_isotopocules(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_filter_weak_isotopocules_+3A_...">...</code></td>
<td>
<p>parameters passed on to the new function orbi_flag_weak_isotopocules().</p>
</td></tr>
</table>

<hr>
<h2 id='orbi_find_isox'>Find isox files</h2><span id='topic+orbi_find_isox'></span>

<h3>Description</h3>

<p>Finds all .isox files in a folder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_find_isox(folder, recursive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_find_isox_+3A_folder">folder</code></td>
<td>
<p>path to a folder with isox files</p>
</td></tr>
<tr><td><code id="orbi_find_isox_+3A_recursive">recursive</code></td>
<td>
<p>whether to find files recursively</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# all .isox files provided with the isoorbi package
orbi_find_isox(system.file("extdata", package = "isoorbi"))

</code></pre>

<hr>
<h2 id='orbi_flag_outliers'>Flag outlier scans</h2><span id='topic+orbi_flag_outliers'></span>

<h3>Description</h3>

<p>The function <code>orbi_flag_outliers()</code> flags outliers using one of the different methods provided by the parameters (to use multiple, please call this function several times sequentially). Note that this function evaluates outliers within each &quot;filename&quot;, &quot;block&quot;, &quot;segment&quot; and &quot;injection&quot; (if these columns exist), in addition to any groupings already defined before calling this function using dplyr's <code>group_by()</code>. It restores the original groupings in the returned data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_flag_outliers(dataset, agc_fold_cutoff = NA_real_, agc_window = c())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_flag_outliers_+3A_dataset">dataset</code></td>
<td>
<p>Simplified IsoX dataset to have outliers flagged</p>
</td></tr>
<tr><td><code id="orbi_flag_outliers_+3A_agc_fold_cutoff">agc_fold_cutoff</code></td>
<td>
<p>flags scans with a fold cutoff based on the average number of ions in the Orbitrap analyzer. For example, <code>agc_fold_cutoff = 2</code> flags scans that have more than 2 times, or less than 1/2 times the average. TIC multiplied by injection time serves as an estimate for the number of ions in the Orbitrap.</p>
</td></tr>
<tr><td><code id="orbi_flag_outliers_+3A_agc_window">agc_window</code></td>
<td>
<p>flags scans with a critically low or high number of ions in the Orbitrap analyzer. Provide a vector with 2 numbers <code>c(x,y)</code> flagging the lowest x percent and highest y percent. TIC multiplied by injection time serves as an estimate for the number of ions in the Orbitrap.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function is intended to flag scans that are outliers.
</p>
<p>The input <code>dataset</code> is expected to have at least these 8 columns: <code>filename</code>, <code>scan.no</code>, <code>time.min</code>, <code>compound</code>, <code>isotopocule</code>, <code>ions.incremental</code>, <code>tic</code>, <code>it.ms</code>.
</p>


<h3>Value</h3>

<p>A data frame with new columns <code>is_outlier</code> and <code>outlier_type</code> (if they don't already exist) that flags outliers identified by the method and provides the type of outlier (e.g. &quot;2 fold agc cutoff&quot;), respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fpath &lt;- system.file("extdata", "testfile_flow.isox", package = "isoorbi")
df &lt;-
  orbi_read_isox(file = fpath) |&gt;
  orbi_simplify_isox() |&gt;
  orbi_flag_outliers(agc_window = c(1,99))

</code></pre>

<hr>
<h2 id='orbi_flag_satellite_peaks'>Flag minor satellite peaks</h2><span id='topic+orbi_flag_satellite_peaks'></span>

<h3>Description</h3>

<p>Flag minor signals (e.g., satellite peaks) that were reported by IsoX (filter them out with <code>orbi_filter_flagged_data()</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_flag_satellite_peaks(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_flag_satellite_peaks_+3A_dataset">dataset</code></td>
<td>
<p>A data frame or tibble produced from IsoX data by <code>orbi_simplify_isox()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>orbi_filter_satellite_peaks()</code> function removes minor signals for an isotopocule that have been reported by IsoX.
These are often small <code style="white-space: pre;">&#8288;satellite peaks&#8288;</code> generated by the Fourier transform.
</p>
<p>If there are signal of high intensity or very many signals, this can indicate that the m/z and tolerance setting used for processing .raw files with IsoX were incorrect.
</p>


<h3>Value</h3>

<p>A data frame with new column <code>is_satellite_peak</code> that flags satellite peaks.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fpath &lt;- system.file("extdata", "testfile_flow.isox", package = "isoorbi")
df &lt;-
  orbi_read_isox(file = fpath) |&gt;
  orbi_simplify_isox() |&gt;
  orbi_flag_satellite_peaks()

</code></pre>

<hr>
<h2 id='orbi_flag_weak_isotopocules'>Flag weak isotopocules</h2><span id='topic+orbi_flag_weak_isotopocules'></span>

<h3>Description</h3>

<p>The function <code>orbi_filter_weak_isotopocules()</code> flags isotopocules that are not detected in a minimum of <code>min_percent</code> of scans. This function evaluates weak isotopocules within each &quot;filename&quot;, &quot;block&quot;, &quot;segment&quot; and &quot;injection&quot; (if these columns exist), in addition to any groupings already defined before calling this function using dplyr's <code>group_by()</code>. It restores the original groupings in the returned data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_flag_weak_isotopocules(dataset, min_percent)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_flag_weak_isotopocules_+3A_dataset">dataset</code></td>
<td>
<p>A simplified IsoX data frame to be processed</p>
</td></tr>
<tr><td><code id="orbi_flag_weak_isotopocules_+3A_min_percent">min_percent</code></td>
<td>
<p>A number between 0 and 90. Isotopocule must be observed in at least this percentage of scans (please note: the percentage is defined relative to the most commonly observed isotopocule of each compound)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input <code>dataset</code> is expected to have at least these 8 columns: <code>filename</code>, <code>scan.no</code>, <code>time.min</code>, <code>compound</code>, <code>isotopocule</code>, <code>ions.incremental</code>, <code>tic</code>, <code>it.ms</code>.
</p>


<h3>Value</h3>

<p>A data frame with new column <code>is_weak_isotopocule</code> that flags weak isotopocules.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fpath &lt;- system.file("extdata", "testfile_flow.isox", package = "isoorbi")
df &lt;- orbi_read_isox(file = fpath) |&gt;
      orbi_simplify_isox() |&gt;
      orbi_flag_weak_isotopocules(min_percent = 2)

</code></pre>

<hr>
<h2 id='orbi_get_blocks_info'>Summarize blocks info</h2><span id='topic+orbi_get_blocks_info'></span>

<h3>Description</h3>

<p>This function provides an overview table <code>blocks_info</code> which shows information on blocks in the dataset (block number, sample name, data type, scan number and start time where a block starts, and scan number and end time where a block ends).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_get_blocks_info(
  dataset,
  .by = c("filename", "injection", "data_group", "block", "sample_name", "data_type",
    "segment")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_get_blocks_info_+3A_dataset">dataset</code></td>
<td>
<p>tibble produced by <code><a href="#topic+orbi_define_blocks_for_dual_inlet">orbi_define_blocks_for_dual_inlet()</a></code></p>
</td></tr>
<tr><td><code id="orbi_get_blocks_info_+3A_.by">.by</code></td>
<td>
<p>grouping columns for block info (akin to dplyr's <code>.by</code> parameter e.g. in <code><a href="dplyr.html#topic+summarise">dplyr::summarize()</a></code>). If not set by the user, all columns in the parameter's default values are used, if present in the dataset.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a block summary or if no blocks defined yet, an empty tibble (with warning)
</p>

<hr>
<h2 id='orbi_get_isotopocule_coverage'>Calculate isotopocule coverage</h2><span id='topic+orbi_get_isotopocule_coverage'></span>

<h3>Description</h3>

<p>Calculate which stretches of the data have data for which isotopocules. This function is usually used indicrectly by <code>orbi_plot_isotopocule_coverage()</code> but can be called directly to investigate isotopocule coverage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_get_isotopocule_coverage(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_get_isotopocule_coverage_+3A_dataset">dataset</code></td>
<td>
<p>A data frame or tibble produced from IsoX data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summary data frame
</p>

<hr>
<h2 id='orbi_get_settings'>Get all isoorbi package settings</h2><span id='topic+orbi_get_settings'></span>

<h3>Description</h3>

<p>Get all isoorbi package settings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_get_settings(pattern = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_get_settings_+3A_pattern">pattern</code></td>
<td>
<p>an optional parameter with a regular expression pattern by which to sub-select the returned settings</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of all package settings and their values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>orbi_get_settings()
</code></pre>

<hr>
<h2 id='orbi_plot_isotopocule_coverage'>Plot isotopocule coverage</h2><span id='topic+orbi_plot_isotopocule_coverage'></span>

<h3>Description</h3>

<p>Weak isotopocules (if previously defined by <code>orbi_flag_weak_isotopocules()</code>) are highlighted in the <code>weak_isotopocules_color</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_plot_isotopocule_coverage(
  dataset,
  isotopocules = c(),
  x = c("scan.no", "time.min"),
  x_breaks = scales::breaks_pretty(5),
  add_data_blocks = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_plot_isotopocule_coverage_+3A_dataset">dataset</code></td>
<td>
<p>isox data</p>
</td></tr>
<tr><td><code id="orbi_plot_isotopocule_coverage_+3A_isotopocules">isotopocules</code></td>
<td>
<p>which isotopocules to visualize, if none provided will visualize all (this may take a long time or even crash your R session if there are too many isotopocules in the data set)</p>
</td></tr>
<tr><td><code id="orbi_plot_isotopocule_coverage_+3A_x">x</code></td>
<td>
<p>x-axis column for the plot, either &quot;time.min&quot; or &quot;scan.no&quot;</p>
</td></tr>
<tr><td><code id="orbi_plot_isotopocule_coverage_+3A_x_breaks">x_breaks</code></td>
<td>
<p>what breaks to use for the x axis, change to make more specifid tickmarks</p>
</td></tr>
<tr><td><code id="orbi_plot_isotopocule_coverage_+3A_add_data_blocks">add_data_blocks</code></td>
<td>
<p>add highlight for data blocks if there are any block definitions in the dataset (uses <code>orbi_add_blocks_to_plot()</code>). To add blocks manually, set <code>add_data_blocks = FALSE</code> and manually call the <code>orbi_add_blocks_to_plot()</code> function afterwards.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='orbi_plot_raw_data'>Visualize raw data</h2><span id='topic+orbi_plot_raw_data'></span>

<h3>Description</h3>

<p>Call this function to visualize orbitrap data vs. time or scan number. The most common uses are <code>orbi_plot_raw_data(y = intensity)</code>, <code>orbi_plot_raw_data(y = ratio)</code>, and <code>orbi_plot_raw_data(y = tic * it.ms)</code>. By default includes all isotopcules that have not been previously identified by <code>orbi_flag_weak_isotopcules()</code> (if already called on dataset). To narrow down the isotopocules to show, use the <code>isotopocule</code> parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_plot_raw_data(
  dataset,
  isotopocules = c(),
  x = c("time.min", "scan.no"),
  x_breaks = scales::breaks_pretty(5),
  y,
  y_scale = c("raw", "linear", "pseudo-log", "log"),
  y_scale_sci_labels = TRUE,
  color = .data$isotopocule,
  colors = c("#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D",
    "#666666"),
  color_scale = scale_color_manual(values = colors),
  add_data_blocks = TRUE,
  add_all_blocks = FALSE,
  show_outliers = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_plot_raw_data_+3A_dataset">dataset</code></td>
<td>
<p>isox dataset</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_isotopocules">isotopocules</code></td>
<td>
<p>which isotopocules to visualize, if none provided will visualize all (this may take a long time or even crash your R session if there are too many isotopocules in the data set)</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_x">x</code></td>
<td>
<p>x-axis column for the plot, either &quot;time.min&quot; or &quot;scan.no&quot;</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_x_breaks">x_breaks</code></td>
<td>
<p>what breaks to use for the x axis, change to make more specifid tickmarks</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_y">y</code></td>
<td>
<p>expression for what to plot on the y-axis, e.g. <code>intensity</code>, <code>tic * it.ms</code> (pick one <code>isotopocules</code> as this is identical for different istopocules), <code>ratio</code>. Depending on the variable, you may want to adjust the <code>y_scale</code> and potentially <code>y_scale_sci_labels</code> argument.</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_y_scale">y_scale</code></td>
<td>
<p>what type of y scale to use: &quot;log&quot; scale, &quot;pseudo-log&quot; scale (smoothly transitions to linear scale around 0), &quot;linear&quot; scale, or &quot;raw&quot; (if you want to add a y scale to the plot manually instead)</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_y_scale_sci_labels">y_scale_sci_labels</code></td>
<td>
<p>whether to render numbers with scientific exponential notation</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_color">color</code></td>
<td>
<p>expression for what to use for the color aesthetic, default is isotopocule</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_colors">colors</code></td>
<td>
<p>which colors to use, by default a color-blind friendly color palettes (RColorBrewer, dark2)</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_color_scale">color_scale</code></td>
<td>
<p>use this parameter to replace the entire color scale rather than just the <code>colors</code></p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_add_data_blocks">add_data_blocks</code></td>
<td>
<p>add highlight for data blocks if there are any block definitions in the dataset (uses <code>orbi_add_blocks_to_plot()</code>). To add blocks manually, set <code>add_data_blocks = FALSE</code> and manually call the <code>orbi_add_blocks_to_plot()</code> function afterwards.</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_add_all_blocks">add_all_blocks</code></td>
<td>
<p>add highlight for all blocks, not just data blocks (equivalent to the <code>data_only = FALSE</code> argument in <code>orbi_add_blocks_to_plot()</code>)</p>
</td></tr>
<tr><td><code id="orbi_plot_raw_data_+3A_show_outliers">show_outliers</code></td>
<td>
<p>whether to highlight data previously flagged as outliers by <code>orbi_flag_outliers()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='orbi_plot_satellite_peaks'>Visualize satellite peaks</h2><span id='topic+orbi_plot_satellite_peaks'></span>

<h3>Description</h3>

<p>Call this function any time after flagging the satellite peaks to see where they are. Use the <code>isotopocules</code> argument to focus on the specific isotopocules of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_plot_satellite_peaks(
  dataset,
  isotopocules = c(),
  x = c("scan.no", "time.min"),
  x_breaks = scales::breaks_pretty(5),
  y_scale = c("log", "pseudo-log", "linear", "raw"),
  y_scale_sci_labels = TRUE,
  colors = c("#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D",
    "#666666"),
  color_scale = scale_color_manual(values = colors)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_plot_satellite_peaks_+3A_dataset">dataset</code></td>
<td>
<p>isox dataset with satellite peaks identified (<code>orbi_flag_satellite_peaks()</code>)</p>
</td></tr>
<tr><td><code id="orbi_plot_satellite_peaks_+3A_isotopocules">isotopocules</code></td>
<td>
<p>which isotopocules to visualize, if none provided will visualize all (this may take a long time or even crash your R session if there are too many isotopocules in the data set)</p>
</td></tr>
<tr><td><code id="orbi_plot_satellite_peaks_+3A_x">x</code></td>
<td>
<p>x-axis column for the plot, either &quot;time.min&quot; or &quot;scan.no&quot;</p>
</td></tr>
<tr><td><code id="orbi_plot_satellite_peaks_+3A_x_breaks">x_breaks</code></td>
<td>
<p>what breaks to use for the x axis, change to make more specifid tickmarks</p>
</td></tr>
<tr><td><code id="orbi_plot_satellite_peaks_+3A_y_scale">y_scale</code></td>
<td>
<p>what type of y scale to use: &quot;log&quot; scale, &quot;pseudo-log&quot; scale (smoothly transitions to linear scale around 0), &quot;linear&quot; scale, or &quot;raw&quot; (if you want to add a y scale to the plot manually instead)</p>
</td></tr>
<tr><td><code id="orbi_plot_satellite_peaks_+3A_y_scale_sci_labels">y_scale_sci_labels</code></td>
<td>
<p>whether to render numbers with scientific exponential notation</p>
</td></tr>
<tr><td><code id="orbi_plot_satellite_peaks_+3A_colors">colors</code></td>
<td>
<p>which colors to use, by default a color-blind friendly color palettes (RColorBrewer, dark2)</p>
</td></tr>
<tr><td><code id="orbi_plot_satellite_peaks_+3A_color_scale">color_scale</code></td>
<td>
<p>use this parameter to replace the entire color scale rather than just the <code>colors</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='orbi_plot_shot_noise'>Make a shot noise plot</h2><span id='topic+orbi_plot_shot_noise'></span>

<h3>Description</h3>

<p>This function creates a shot noise plot using a <code>shotnoise</code> data frame created by the <code><a href="#topic+orbi_analyze_shot_noise">orbi_analyze_shot_noise()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_plot_shot_noise(
  shotnoise,
  x = c("time.min", "n_effective_ions"),
  permil_target = NA_real_,
  color = "ratio_label",
  colors = c("#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D",
    "#666666")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_plot_shot_noise_+3A_shotnoise">shotnoise</code></td>
<td>
<p>a <code>shotnoise</code> data frame</p>
</td></tr>
<tr><td><code id="orbi_plot_shot_noise_+3A_x">x</code></td>
<td>
<p>x-axis for the shot noise plot, either &quot;time.min&quot; or &quot;n_effective_ions&quot;</p>
</td></tr>
<tr><td><code id="orbi_plot_shot_noise_+3A_permil_target">permil_target</code></td>
<td>
<p>highlight the target permil in the shotnoise plot</p>
</td></tr>
<tr><td><code id="orbi_plot_shot_noise_+3A_color">color</code></td>
<td>
<p>which column to use for the color aesthetic (must be a factor)</p>
</td></tr>
<tr><td><code id="orbi_plot_shot_noise_+3A_colors">colors</code></td>
<td>
<p>which colors to use, by default a color-blind friendly color palettes (RColorBrewer, dark2)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot shot noise
</p>


<h3>Value</h3>

<p>a ggplot object
</p>

<hr>
<h2 id='orbi_read_isox'>Read IsoX file</h2><span id='topic+orbi_read_isox'></span>

<h3>Description</h3>

<p>Read an IsoX output file (<code>.isox</code>) into a tibble data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_read_isox(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_read_isox_+3A_file">file</code></td>
<td>
<p>Path to the <code>.isox</code> file(s), single value or vector of paths</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Additional information on the columns:
</p>

<ul>
<li> <p><code>filename</code>: name of the original Thermo <code>.raw</code> file processed by IsoX
</p>
</li>
<li> <p><code>scan.no</code>: scan number
</p>
</li>
<li> <p><code>time.min</code>: acquisition or retention time in minutes
</p>
</li>
<li> <p><code>compound</code>: name of the compound (e.g., NO3-)
</p>
</li>
<li> <p><code>isotopocule</code>: name of the isotopocule (e.g., 15N); called <code>isotopolog</code> in <code>.isox</code>
</p>
</li>
<li> <p><code>ions.incremental</code>: estimated number of ions, in increments since it is a calculated number
</p>
</li>
<li> <p><code>tic</code>: total ion current (TIC) of the scan
</p>
</li>
<li> <p><code>it.ms</code>: scan injection time (IT) in millisecond (ms)
</p>
</li></ul>



<h3>Value</h3>

<p>A tibble containing at minimum the columns <code>filename</code>, <code>scan.no</code>, <code>time.min</code>, <code>compound</code>, <code>isotopocule</code>, <code>ions.incremental</code>, <code>tic</code>, <code>it.ms</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fpath &lt;- system.file("extdata", "testfile_dual_inlet.isox", package = "isoorbi")
df &lt;- orbi_read_isox(file = fpath)

</code></pre>

<hr>
<h2 id='orbi_segment_blocks'>Segment data blocks</h2><span id='topic+orbi_segment_blocks'></span>

<h3>Description</h3>

<p>This step is optional and is intended to make it easy to explore the data within a sample or ref data block. Note that any raw data not identified with <code>data_type</code> set to &quot;data&quot; (<code>orbi_get_settings("data_type")</code>) will stay unsegmented. This includes raw data flagged as &quot;startup&quot;, &quot;changeover&quot;, and &quot;unused&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_segment_blocks(
  dataset,
  into_segments = NULL,
  by_scans = NULL,
  by_time_interval = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_segment_blocks_+3A_dataset">dataset</code></td>
<td>
<p>tibble produced by <code><a href="#topic+orbi_define_blocks_for_dual_inlet">orbi_define_blocks_for_dual_inlet()</a></code></p>
</td></tr>
<tr><td><code id="orbi_segment_blocks_+3A_into_segments">into_segments</code></td>
<td>
<p>segment each data block into this many segments. The result will have exactly this number of segments for each data block except for if there are more segments requested than observations in a group (in which case each observation will be one segment)</p>
</td></tr>
<tr><td><code id="orbi_segment_blocks_+3A_by_scans">by_scans</code></td>
<td>
<p>segment each data block into segments spanning this number of scans. The result will be approximately the requested number of scans per segment, depending on what is the most sensible distribution of the data. For example, in a hypothetical data block with 31 scans, if by_scans = 10, this function will create 3 segments with 11, 10 and 10 scans each (most evenly distributed), instead of 4 segments with 10, 10, 10, 1 (less evenly distributed).</p>
</td></tr>
<tr><td><code id="orbi_segment_blocks_+3A_by_time_interval">by_time_interval</code></td>
<td>
<p>segment each data block into segments spanning this time interval. The result will have the requested time interval for all segments except usually the last one which is almost always shorter than the requested interval.</p>
</td></tr>
</table>

<hr>
<h2 id='orbi_set_settings'>Set package settings</h2><span id='topic+orbi_set_settings'></span>

<h3>Description</h3>

<p>Use this function to change the default package settings. When calling this function, only specify the settings you want to change, everything else will remain unchanged. The default value for each parameter is what the package uses by default for each setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_set_settings(
  di_ref_name = "ref",
  di_sample_name = "sam",
  data_type_data = "data",
  data_type_startup = "startup",
  data_type_changeover = "changeover",
  data_type_unused = "unused",
  reset_all = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_set_settings_+3A_di_ref_name">di_ref_name</code></td>
<td>
<p>the text label for dual inlet reference blocks</p>
</td></tr>
<tr><td><code id="orbi_set_settings_+3A_di_sample_name">di_sample_name</code></td>
<td>
<p>the text label for dual inlet sample blocks</p>
</td></tr>
<tr><td><code id="orbi_set_settings_+3A_data_type_data">data_type_data</code></td>
<td>
<p>the text used to flag raw data as actually being data</p>
</td></tr>
<tr><td><code id="orbi_set_settings_+3A_data_type_startup">data_type_startup</code></td>
<td>
<p>the text used to flag raw data as being part of the startup</p>
</td></tr>
<tr><td><code id="orbi_set_settings_+3A_data_type_changeover">data_type_changeover</code></td>
<td>
<p>the text used to flag raw data as being part of a changeover</p>
</td></tr>
<tr><td><code id="orbi_set_settings_+3A_data_type_unused">data_type_unused</code></td>
<td>
<p>the text used to flag raw data as being unused</p>
</td></tr>
<tr><td><code id="orbi_set_settings_+3A_reset_all">reset_all</code></td>
<td>
<p>if set to TRUE, will reset all settings back to their defaults</p>
</td></tr>
</table>


<h3>Details</h3>

<p>FIXME: needs documentation completion
FIXME: needs tests to change settings and then get the value back
</p>


<h3>Value</h3>

<p>invisible list of all settings (see <code><a href="#topic+orbi_get_settings">orbi_get_settings()</a></code>)
</p>

<hr>
<h2 id='orbi_simplify_isox'>Simplify IsoX data</h2><span id='topic+orbi_simplify_isox'></span>

<h3>Description</h3>

<p>Keep only columns that are directly relevant for isotopocule ratio analysis. This function is optional and does not affect any downstream function calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_simplify_isox(dataset, add = c())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_simplify_isox_+3A_dataset">dataset</code></td>
<td>
<p>IsoX data that is to be simplified</p>
</td></tr>
<tr><td><code id="orbi_simplify_isox_+3A_add">add</code></td>
<td>
<p>additional columns to keep</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing only the 9 columns: <code>filepath</code>, <code>filename</code>, <code>scan.no</code>, <code>time.min</code>, <code>compound</code>, <code>isotopocule</code>, <code>ions.incremental</code>, <code>tic</code>, <code>it.ms</code>, plus any additional columns defined in the <code>add</code> argument
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fpath &lt;- system.file("extdata", "testfile_flow.isox", package="isoorbi")
df &lt;- orbi_read_isox(file = fpath) |&gt; orbi_simplify_isox()

</code></pre>

<hr>
<h2 id='orbi_summarize_results'>Generate the results table</h2><span id='topic+orbi_summarize_results'></span>

<h3>Description</h3>

<p>Contains the logic to generate the results table. It passes the  <code>ratio_method</code> parameter to the <code><a href="#topic+orbi_calculate_summarized_ratio">orbi_calculate_summarized_ratio()</a></code> function for ratio calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbi_summarize_results(
  dataset,
  ratio_method = c("mean", "sum", "median", "geometric_mean", "slope", "weighted_sum"),
  .by = c("block", "sample_name", "segment", "data_group", "data_type", "injection"),
  include_flagged_data = FALSE,
  include_unused_data = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbi_summarize_results_+3A_dataset">dataset</code></td>
<td>
<p>A tibble from <code>IsoX</code> output (<code><a href="#topic+orbi_read_isox">orbi_read_isox()</a></code>) and with a basepeak already defined (using <code>orbi_define_basepeak()</code>). Optionally, with block definitions (<code><a href="#topic+orbi_define_blocks_for_dual_inlet">orbi_define_blocks_for_dual_inlet()</a></code>) or even additional block segments (<code><a href="#topic+orbi_segment_blocks">orbi_segment_blocks()</a></code>).</p>
</td></tr>
<tr><td><code id="orbi_summarize_results_+3A_ratio_method">ratio_method</code></td>
<td>
<p>Method for computing the ratio. <strong>Please note well</strong>: the formula used to calculate ion ratios matters! Do not simply use arithmetic mean. The best option may depend on the type of data you are processing (e.g., MS1 versus M+1 fragmentation). <code>ratio_method</code> can be one of the following:
</p>

<ul>
<li> <p><code>mean</code>: arithmetic mean of ratios from individual scans.
</p>
</li>
<li> <p><code>sum</code>: sum of all ions of the numerator across all scans divided by the sum of all ions observed for the denominator across all scans.
</p>
</li>
<li> <p><code>geometric_mean</code>: geometric mean of ratios from individual scans.
</p>
</li>
<li> <p><code>slope</code>: The ratio is calculated using the slope obtained from a linear regression model that is weighted by the <code style="white-space: pre;">&#8288;numerator x&#8288;</code>, using <code>stats::lm(x ~ y + 0, weights = x)</code>.
</p>
</li>
<li> <p><code>weighted_sum</code>: A derivative of the <code>sum</code> option. The weighing function ensures that each scan contributes equal weight to the ratio calculation,
i.e. scans with more ions in the Orbitrap do not contribute disproportionately to the total <code>sum</code> of <code>x</code> and <code>y</code> that is used to calculate <code>x/y</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="orbi_summarize_results_+3A_.by">.by</code></td>
<td>
<p>additional grouping columns for the results summary (akin to dplyr's <code>.by</code> parameter e.g. in <code><a href="dplyr.html#topic+summarise">dplyr::summarize()</a></code>). If not set by the user, all columns in the parameter's default values are used, if present in the dataset. Note that the order of these is also used to arrange the summary.</p>
</td></tr>
<tr><td><code id="orbi_summarize_results_+3A_include_flagged_data">include_flagged_data</code></td>
<td>
<p>whether to include flagged data in the calculations (FALSE by default)</p>
</td></tr>
<tr><td><code id="orbi_summarize_results_+3A_include_unused_data">include_unused_data</code></td>
<td>
<p>whether to include unused data in the calculations (FALSE by default), in addition to peaks actually flagged as setting(&quot;data_type_data&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a results summary table retaining the columns <code>filename</code>, <code>compound</code>, <code>isotopocule</code> and <code>basepeak</code> as well as the grouping columns from the <code>.by</code> parameter that are part of the input <code>dataset</code>. Additionally this function adds the following results columns: <code>start_scan.no</code>, <code>end_scan.no</code>, <code>start_time.min</code>, <code>mean_time.min</code>, <code>end_time.min</code>, <code>ratio</code>, <code>ratio_sem</code>, <code>ratio_relative_sem_permil</code>, <code>shot_noise_permil</code>, <code>No.of.Scans</code>, <code>minutes_to_1e6_ions</code>
</p>

<ul>
<li> <p><code>ratio</code>: The isotope ratio between the <code>isotopocule</code> and the <code>basepeak</code>, calculated using the <code>ratio_method</code>
</p>
</li>
<li> <p><code>ratio_sem</code>: Standard error of the mean for the ratio
</p>
</li>
<li> <p><code>number_of_scans</code>: Number of scans used for the final ratio calculation
</p>
</li>
<li> <p><code>minutes_to_1e6_ions</code>: Time in minutes it would take to observe 1 million ions of the <code>isotopocule</code> used as numerator of the ratio calculation.
</p>
</li>
<li> <p><code>shot_noise_permil</code>: Estimate of the shot noise (more correctly thermal noise) of the reported ratio in permil.
</p>
</li>
<li> <p><code>ratio_relative_sem_permil</code>: Relative standard error of the reported ratio in permil
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>fpath &lt;- system.file("extdata", "testfile_flow.isox", package = "isoorbi")
df &lt;- orbi_read_isox(file = fpath) |&gt;
      orbi_simplify_isox() |&gt;
      orbi_define_basepeak("M0")  |&gt;
      orbi_summarize_results(ratio_method = "sum")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
