<!DOCTYPE html><html><head><title>Help for package lmSubsets</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmSubsets}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC.lmSubsets'><p>Extract AIC values from a subset regression</p></a></li>
<li><a href='#AirPollution'><p>Air pollution and mortality</p></a></li>
<li><a href='#BIC.lmSubsets'><p>Extract BIC values from a subset regression</p></a></li>
<li><a href='#coef.lmSubsets'><p>Extract the ceofficients from a subset regression</p></a></li>
<li><a href='#deviance.lmSubsets'><p>Extract the deviance from a subset regression</p></a></li>
<li><a href='#fitted.lmSubsets'><p>Extract the fitted values from a subset regression</p></a></li>
<li><a href='#formula.lmSubsets'><p>Extract a formula from a subset regression</p></a></li>
<li><a href='#IbkTemperature'><p>Temperature observations and numerical weather predictions for</p>
Innsbruck</a></li>
<li><a href='#image.lmSubsets'><p>Heatmap of a subset regression</p></a></li>
<li><a href='#lmSelect'><p>Best-subset regression</p></a></li>
<li><a href='#lmSelect_fit'><p>Best-subset regression</p></a></li>
<li><a href='#lmSelect.lmSubsets'><p>Best-subset regression</p></a></li>
<li><a href='#lmSelect.matrix'><p>Best-subset regression</p></a></li>
<li><a href='#lmSubsets'><p>All-subsets regression</p></a></li>
<li><a href='#lmSubsets_fit'><p>All-subsets regression</p></a></li>
<li><a href='#lmSubsets-package'><p>Package <code>lmSubsets</code></p></a></li>
<li><a href='#lmSubsets.matrix'><p>All-subsets regression</p></a></li>
<li><a href='#logLik.lmSubsets'><p>Extract the log-likelihood from a subset regression</p></a></li>
<li><a href='#model_response'><p>Model response</p></a></li>
<li><a href='#model_response.lmSubsets'><p>Extract the model response from a subset regression</p></a></li>
<li><a href='#model.frame.lmSubsets'><p>Extract the model frame from a subset regression</p></a></li>
<li><a href='#model.matrix.lmSubsets'><p>Extract a model matrix from a subset regression</p></a></li>
<li><a href='#plot.lmSubsets'><p>Plot a subset regression</p></a></li>
<li><a href='#refit'><p>Refitting models</p></a></li>
<li><a href='#refit.lmSubsets'><p>Refit a subset regression</p></a></li>
<li><a href='#residuals.lmSubsets'><p>Extract the residuals from all-subsets regression</p></a></li>
<li><a href='#sigma.lmSubsets'><p>Extract the residual standard deviation from a subset regression</p></a></li>
<li><a href='#summary.lmSubsets'><p>Summarize a subset regression</p></a></li>
<li><a href='#variable.names.lmSubsets'><p>Extract variable names from a subset regression</p></a></li>
<li><a href='#vcov.lmSubsets'><p>Extract the variance-covariance matrix from a subset regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.5-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-02-03</td>
</tr>
<tr>
<td>Title:</td>
<td>Exact Variable-Subset Selection in Linear Regression</td>
</tr>
<tr>
<td>Description:</td>
<td>Exact and approximation algorithms for variable-subset
  selection in ordinary linear regression models.  Either compute all
  submodels with the lowest residual sum of squares, or determine the
  single-best submodel according to a pre-determined statistical
  criterion.  Hofmann et al. (2020) &lt;<a href="https://doi.org/10.18637%2Fjss.v093.i03">doi:10.18637/jss.v093.i03</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/marc-hofmann/lmSubsets.R">https://github.com/marc-hofmann/lmSubsets.R</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-07 18:25:40 UTC; marc</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Hofmann [aut, cre],
  Cristian Gatu [aut],
  Erricos J. Kontoghiorghes [aut],
  Ana Colubi [aut],
  Achim Zeileis <a href="https://orcid.org/0000-0003-0918-3766"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Martin Moene [cph] (for the GSL Lite library),
  Microsoft Corporation [cph] (for the GSL Lite library),
  Free Software Foundation, Inc. [cph] (for snippets from the GNU ISO C++
    Library)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marc Hofmann &lt;marc.hofmann@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-07 20:10:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC.lmSubsets'>Extract AIC values from a subset regression</h2><span id='topic+AIC.lmSubsets'></span><span id='topic+AIC.lmSelect'></span>

<h3>Description</h3>

<p>Evaluate Akaike's information criterion (AIC) for the specified
submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
AIC(object, size, best = 1, ..., k = 2, na.rm = TRUE, drop = TRUE)

## S3 method for class 'lmSelect'
AIC(object, best = 1, ..., k = 2, na.rm = TRUE, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="AIC.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel sizes</p>
</td></tr>
<tr><td><code id="AIC.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel positions</p>
</td></tr>
<tr><td><code id="AIC.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="AIC.lmSubsets_+3A_k">k</code></td>
<td>
<p><code>double</code>&mdash;the penalty per model parameter</p>
</td></tr>
<tr><td><code id="AIC.lmSubsets_+3A_na.rm">na.rm</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, remove <code>NA</code>
entries</p>
</td></tr>
<tr><td><code id="AIC.lmSubsets_+3A_drop">drop</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, simplify structure</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[]</code>&mdash;the AIC values
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+AIC">AIC()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='AirPollution'>Air pollution and mortality</h2><span id='topic+AirPollution'></span>

<h3>Description</h3>

<p>Data relating air pollution and mortality, frequently used for
illustrations in ridge regression and related tasks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AirPollution)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 60 observations on 16 variables.
</p>

<dl>
<dt>precipitation</dt><dd><p>average annual precipitation in inches</p>
</dd>
<dt>temperature1</dt><dd><p>average January temperature in degrees
Fahrenheit</p>
</dd>
<dt>temperature7</dt><dd><p>average July temperature in degrees
Fahrenheit</p>
</dd>
<dt>age</dt><dd><p>percentage of 1960 SMSA population aged 65 or older</p>
</dd>
<dt>household</dt><dd><p>average household size</p>
</dd>
<dt>education</dt><dd><p>median school years completed by those over 22</p>
</dd>
<dt>housing</dt><dd><p>percentage of housing units which are sound and
with all facilities</p>
</dd>
<dt>population</dt><dd><p>population per square mile in urbanized areas,
1960</p>
</dd>
<dt>noncauc</dt><dd><p>percentage of non-Caucasian population in
urbanized areas, 1960</p>
</dd>
<dt>whitecollar</dt><dd><p>percentage employed in white collar
occupations</p>
</dd>
<dt>income</dt><dd><p>percentage of families with income &lt; USD 3000</p>
</dd>
<dt>hydrocarbon</dt><dd><p>relative hydrocarbon pollution potential</p>
</dd>
<dt>nox</dt><dd><p>relative nitric oxides potential</p>
</dd>
<dt>so2</dt><dd><p>relative sulphur dioxide potential</p>
</dd>
<dt>humidity</dt><dd><p>annual average percentage of relative humidity at
13:00</p>
</dd>
<dt>mortality</dt><dd><p>total age-adjusted mortality rate per 100,000</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://lib.stat.cmu.edu/datasets/pollution">http://lib.stat.cmu.edu/datasets/pollution</a>
</p>


<h3>References</h3>

<p>McDonald GC, Schwing RC (1973).  Instabilities of regression estimates
relating air pollution to mortality.  <em>Technometrics</em>,
<strong>15</strong>, 463&ndash;482.
</p>
<p>Miller AJ (2002). <em>Subset selection in regression</em>.  New York:
Chapman and Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data (with logs for relative potentials)
data("AirPollution", package = "lmSubsets")
for (i in 12:14)  AirPollution[[i]] &lt;- log(AirPollution[[i]])

## fit subsets
lm_all &lt;- lmSubsets(mortality ~ ., data = AirPollution)
plot(lm_all)

## refit best model
lm6 &lt;- refit(lm_all, size = 6)
summary(lm6)
</code></pre>

<hr>
<h2 id='BIC.lmSubsets'>Extract BIC values from a subset regression</h2><span id='topic+BIC.lmSubsets'></span><span id='topic+BIC.lmSelect'></span>

<h3>Description</h3>

<p>Evaluate the Bayesian information criterion (BIC) for the specified
submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
BIC(object, size, best = 1, ..., na.rm = TRUE, drop = TRUE)

## S3 method for class 'lmSelect'
BIC(object, best = 1, ..., na.rm = TRUE, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="BIC.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel sizes</p>
</td></tr>
<tr><td><code id="BIC.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel positions</p>
</td></tr>
<tr><td><code id="BIC.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="BIC.lmSubsets_+3A_na.rm">na.rm</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, remove <code>NA</code>
entries</p>
</td></tr>
<tr><td><code id="BIC.lmSubsets_+3A_drop">drop</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, simplify structure</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[]</code>&mdash;the BIC values
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+BIC">BIC()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='coef.lmSubsets'>Extract the ceofficients from a subset regression</h2><span id='topic+coef.lmSubsets'></span><span id='topic+coef.lmSelect'></span>

<h3>Description</h3>

<p>Return the coefficients for the specified submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
coef(object, size, best = 1, ..., na.rm = TRUE, drop = TRUE)

## S3 method for class 'lmSelect'
coef(object, best = 1, ..., na.rm = TRUE, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="coef.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel sizes</p>
</td></tr>
<tr><td><code id="coef.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel positions</p>
</td></tr>
<tr><td><code id="coef.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="coef.lmSubsets_+3A_na.rm">na.rm</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, remove <code>NA</code>
entries</p>
</td></tr>
<tr><td><code id="coef.lmSubsets_+3A_drop">drop</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, simplify structure</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[,]</code>, <code>"data.frame"</code>&mdash;the submodel coefficients
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+coef">coef()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='deviance.lmSubsets'>Extract the deviance from a subset regression</h2><span id='topic+deviance.lmSubsets'></span><span id='topic+deviance.lmSelect'></span>

<h3>Description</h3>

<p>Return the deviance for the specified submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
deviance(object, size, best = 1, ..., na.rm = TRUE, drop = TRUE)

## S3 method for class 'lmSelect'
deviance(object, best = 1, ..., na.rm = TRUE, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deviance.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="deviance.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel sizes</p>
</td></tr>
<tr><td><code id="deviance.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel positions</p>
</td></tr>
<tr><td><code id="deviance.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="deviance.lmSubsets_+3A_na.rm">na.rm</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, remove <code>NA</code>
entries</p>
</td></tr>
<tr><td><code id="deviance.lmSubsets_+3A_drop">drop</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, simplify structure</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[]</code>, <code>"data.frame"</code>&mdash;the submodel deviances
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+deviance">deviance()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='fitted.lmSubsets'>Extract the fitted values from a subset regression</h2><span id='topic+fitted.lmSubsets'></span><span id='topic+fitted.lmSelect'></span>

<h3>Description</h3>

<p>Return the fitted values for the specified submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
fitted(object, size, best = 1, ...)

## S3 method for class 'lmSelect'
fitted(object, best = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="fitted.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer</code>&mdash;the submodel size</p>
</td></tr>
<tr><td><code id="fitted.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer</code>&mdash;the submodel position</p>
</td></tr>
<tr><td><code id="fitted.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[]</code>&mdash;the fitted values
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+fitted">fitted()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='formula.lmSubsets'>Extract a formula from a subset regression</h2><span id='topic+formula.lmSubsets'></span><span id='topic+formula.lmSelect'></span>

<h3>Description</h3>

<p>Return the formula for the specified submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
formula(x, size, best = 1, ...)

## S3 method for class 'lmSelect'
formula(x, best, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula.lmSubsets_+3A_x">x</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset regression</p>
</td></tr>
<tr><td><code id="formula.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer</code>&mdash;the submodel size</p>
</td></tr>
<tr><td><code id="formula.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer</code>&mdash;the submodel position</p>
</td></tr>
<tr><td><code id="formula.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>"formula"</code>&mdash;the submodel formula
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+formula">formula()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='IbkTemperature'>Temperature observations and numerical weather predictions for
Innsbruck</h2><span id='topic+IbkTemperature'></span>

<h3>Description</h3>

<p>00UTC temperature observations and corresponding 24-hour reforecast
ensemble means from the Global Ensemble Forecast System (GEFS, Hamill
et al. 2013) for SYNOP station Innsbruck Airport (11120; 47.260,
11.357) from 2011-01-01 to 2015-12-31.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(IbkTemperature)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 1824 daily observations/forecasts for 42
variables.  The first column (<code>temp</code>) contains temperature
observations at 00UTC (coordinated universal time), columns 2&ndash;37 are
24-hour lead time GEFS reforecast ensemble means for different
variables (see below).  Columns 38&ndash;42 are deterministic time
trend/season patterns.
</p>

<dl>
<dt>temp</dt><dd><p>observed temperature at Innsbruck Airport (deg <code class="reqn">C</code>)</p>
</dd>
<dt>tp</dt><dd><p>total accumulated precipitation (<code class="reqn">kg~m^{-2}</code>)</p>
</dd>
<dt>t2m</dt><dd><p>temperature at 2 meters (<code class="reqn">K</code>)</p>
</dd>
<dt>u10m</dt><dd><p>U-component of wind at 10 meters (<code class="reqn">m~s^{-1}</code>)</p>
</dd>
<dt>v10m</dt><dd><p>V-component of wind at 10 meters (<code class="reqn">m~s^{-1}</code>)</p>
</dd>
<dt>u80m</dt><dd><p>U-component of wind at 80 meters (<code class="reqn">m~s^{-1}</code>)</p>
</dd>
<dt>v80m</dt><dd><p>U-component of wind at 80 meters (<code class="reqn">m~s^{-1}</code>)</p>
</dd>
<dt>cape</dt><dd><p>convective available potential energy
(<code class="reqn">J~kg^{-1}</code>)</p>
</dd>
<dt>ci</dt><dd><p>convective inhibition (<code class="reqn">J~kg^{-1}</code>)</p>
</dd>
<dt>sdlwrf</dt><dd><p>surface downward long-wave radiation flux
(<code class="reqn">W~m^{-2}</code>)</p>
</dd>
<dt>sdswrf</dt><dd><p>surface downward short-wave radiation flux
(<code class="reqn">W~m^{-2}</code>)</p>
</dd>
<dt>sulwrf</dt><dd><p>surface upward long-wave radiation flux
(<code class="reqn">W~m^{-2}</code>)</p>
</dd>
<dt>suswrf</dt><dd><p>surface upward short-wave radiation flux
(<code class="reqn">W~m^{-2}</code>)</p>
</dd>
<dt>ghf</dt><dd><p>ground heat flux (<code class="reqn">W~m^{-2}</code>)</p>
</dd>
<dt>slhnf</dt><dd><p>surface latent heat net flux (<code class="reqn">W~m^{-2}</code>)</p>
</dd>
<dt>sshnf</dt><dd><p>surface sensible heat net flux (<code class="reqn">W~m^{-2}</code>)</p>
</dd>
<dt>mslp</dt><dd><p>mean sea level pressure (<code class="reqn">Pa</code>)</p>
</dd>
<dt>psfc</dt><dd><p>surface pressure (<code class="reqn">Pa</code>)</p>
</dd>
<dt>pw</dt><dd><p>precipitable water (<code class="reqn">kg~m^{-2}</code>)</p>
</dd>
<dt>vsmc</dt><dd><p>volumetric soil moisture content (fraction)</p>
</dd>
<dt>sh2m</dt><dd><p>specific humidity at 2 meters (<code class="reqn">kg~kg^{-1}</code>)</p>
</dd>
<dt>tcc</dt><dd><p>total cloud cover (percent)</p>
</dd>
<dt>tcic</dt><dd><p>total column-integrated condensate
(<code class="reqn">kg~m^{-2}</code>)</p>
</dd>
<dt>tsfc</dt><dd><p>skin temperature (<code class="reqn">K</code>)</p>
</dd>
<dt>tmax2m</dt><dd><p>maximum temperature (<code class="reqn">K</code>)</p>
</dd>
<dt>tmin2m</dt><dd><p>minimum temperature (<code class="reqn">K</code>)</p>
</dd>
<dt>st</dt><dd><p>soil temperature (0&ndash;10 cm below surface) (<code class="reqn">K</code>)</p>
</dd>
<dt>ulwrf</dt><dd><p>upward long-wave radiation flux (<code class="reqn">W~m^{-2}</code>)</p>
</dd>
<dt>wr</dt><dd><p>water runoff (<code class="reqn">kg~m^{-2}</code>)</p>
</dd>
<dt>we</dt><dd><p>water equivalent of accumulated snow depth
(<code class="reqn">kg~m^{-2}</code>)</p>
</dd>
<dt>wp</dt><dd><p>wind mixing energy (<code class="reqn">J</code>)</p>
</dd>
<dt>w850</dt><dd><p>vertical velocity at 850 hPa surface (<code class="reqn">Pa~s^{-1}</code>)</p>
</dd>
<dt>t2pvu</dt><dd><p>temperature on 2 PVU surface (<code class="reqn">K</code>)</p>
</dd>
<dt>p2pvu</dt><dd><p>pressure on 2 PVU surface (<code class="reqn">Pa</code>)</p>
</dd>
<dt>u2pvu</dt><dd><p>U-component of wind on 2 PVU surface (<code class="reqn">m~s^{-1}</code>)</p>
</dd>
<dt>v2pvu</dt><dd><p>U-component of wind on 2 PVU surface (<code class="reqn">m~s^{-1}</code>)</p>
</dd>
<dt>pv</dt><dd><p>Potential vorticity on 320 K isentrope
(<code class="reqn">K~m^{2}~kg^{-1}~s^{-1}</code>)</p>
</dd>
<dt>time</dt><dd><p>time in years</p>
</dd>
<dt>sin, cos</dt><dd><p>sine and cosine component of annual harmonic
pattern</p>
</dd>
<dt>sin2, cos2</dt><dd><p>sine and cosine component of bi-annual harmonic
pattern</p>
</dd>
</dl>



<h3>Source</h3>

<p>Observations:  <a href="https://www.ogimet.com/synops.phtml.en">https://www.ogimet.com/synops.phtml.en</a>.
Reforecasts:  <a href="https://psl.noaa.gov/forecasts/reforecast2/">https://psl.noaa.gov/forecasts/reforecast2/</a>.
</p>


<h3>References</h3>

<p>Hamill TM, Bates GT, Whitaker JS, Murray DR, Fiorino M, Galarneau
Jr. TJ, Zhu Y, Lapenta W (2013).  NOAA's second-generation global
medium-range ensemble reforecast data set.  <em>Bulletin of the
American Meteorological Society</em>, <strong>94</strong>(10), 1553&ndash;1565.
doi: <a href="https://doi.org/10.1175/BAMS-D-12-00014.1">10.1175/BAMS-D-12-00014.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data and omit missing values
data("IbkTemperature", package = "lmSubsets")
IbkTemperature &lt;- na.omit(IbkTemperature)

## fit a simple climatological model for the temperature
## with a linear trend and annual/bi-annual harmonic seasonal pattern
CLIM &lt;- lm(temp ~ time + sin + cos + sin2 + cos2,
  data = IbkTemperature)

## fit a simple MOS with 2-meter temperature forecast in addition
## to the climatological model
MOS0 &lt;- lm(temp ~ t2m + time + sin + cos + sin2 + cos2,
  data = IbkTemperature)

## graphical comparison and MOS summary
plot(temp ~ time, data = IbkTemperature, type = "l", col = "darkgray")
lines(fitted(MOS0) ~ time, data = IbkTemperature, col = "darkred")
lines(fitted(CLIM) ~ time, data = IbkTemperature, lwd = 2)
MOS0

## best subset selection of remaining variables for the MOS
## (i.e., forcing the regressors of m1 into the model)
MOS1_all &lt;- lmSubsets(temp ~ ., data = IbkTemperature,
  include = c("t2m", "time", "sin", "cos", "sin2", "cos2"))
plot(MOS1_all)
image(MOS1_all, size = 8:20)
## -&gt; Note that soil temperature and maximum temperature are selected
## in addition to the 2-meter temperature

## best subset selection of all variables
MOS2_all &lt;- lmSubsets(temp ~ ., data = IbkTemperature)
plot(MOS2_all)
image(MOS2_all, size = 2:20)
## -&gt; Note that 2-meter temperature is not selected into the best
## BIC model but soil-temperature (and maximum temperature) are used instead

## refit the best BIC subset selections
MOS1 &lt;- refit(lmSelect(MOS1_all))
MOS2 &lt;- refit(lmSelect(MOS2_all))

## compare BIC
BIC(CLIM, MOS0, MOS1, MOS2)

## compare RMSE
sqrt(sapply(list(CLIM, MOS0, MOS1, MOS2), deviance)/
  nrow(IbkTemperature))

## compare coefficients
cf0 &lt;- coef(CLIM)
cf1 &lt;- coef(MOS0)
cf2 &lt;- coef(MOS1)
cf3 &lt;- coef(MOS2)
names(cf2) &lt;- gsub("^x", "", names(coef(MOS1)))
names(cf3) &lt;- gsub("^x", "", names(coef(MOS2)))
nam &lt;- unique(c(names(cf0), names(cf1), names(cf2), names(cf3)))
cf &lt;- matrix(NA, nrow = length(nam), ncol = 4,
  dimnames = list(nam, c("CLIM", "MOS0", "MOS1", "MOS2")))
cf[names(cf0), 1] &lt;- cf0
cf[names(cf1), 2] &lt;- cf1
cf[names(cf2), 3] &lt;- cf2
cf[names(cf3), 4] &lt;- cf3
print(round(cf, digits = 3), na.print = "")
</code></pre>

<hr>
<h2 id='image.lmSubsets'>Heatmap of a subset regression</h2><span id='topic+image.lmSubsets'></span><span id='topic+image.lmSelect'></span>

<h3>Description</h3>

<p>Plot a heatmap of the specified submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
image(x, size = NULL, best = 1, which = NULL, hilite, hilite_penalty,
      main, sub, xlab = NULL, ylab, ann = par("ann"), axes = TRUE,
      col = c("gray40", "gray90"), lab = "lab",
      col_hilite = cbind("red", "pink"), lab_hilite = "lab",
      pad_size = 3, pad_best = 1, pad_which = 3, axis_pos = -4,
      axis_tck = -4, axis_lab = -10, ...)

## S3 method for class 'lmSelect'
image(x, best = NULL, which = NULL, hilite, hilite_penalty,
      main, sub = NULL, xlab = NULL, ylab, ann = par("ann"),
      axes = TRUE, col = c("gray40", "gray90"), lab = "lab",
      col_hilite = cbind("red", "pink"), lab_hilite = "lab",
      pad_best = 2, pad_which = 2, axis_pos = -4, axis_tck = -4,
      axis_lab = -10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="image.lmSubsets_+3A_x">x</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset regression</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_size">size</code>, <code id="image.lmSubsets_+3A_best">best</code></td>
<td>
<p>submodels to be plotted</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_which">which</code></td>
<td>
<p>regressors to be plotted</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_hilite">hilite</code>, <code id="image.lmSubsets_+3A_hilite_penalty">hilite_penalty</code></td>
<td>
<p>submodels to be highlighted</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_main">main</code>, <code id="image.lmSubsets_+3A_sub">sub</code>, <code id="image.lmSubsets_+3A_xlab">xlab</code>, <code id="image.lmSubsets_+3A_ylab">ylab</code></td>
<td>
<p>main, sub-, and axis titles</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_ann">ann</code></td>
<td>
<p>annotate plot</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_axes">axes</code></td>
<td>
<p>plot axes</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_col">col</code>, <code id="image.lmSubsets_+3A_lab">lab</code></td>
<td>
<p>color and label style</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_col_hilite">col_hilite</code>, <code id="image.lmSubsets_+3A_lab_hilite">lab_hilite</code></td>
<td>
<p>highlighting style</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_pad_size">pad_size</code>, <code id="image.lmSubsets_+3A_pad_best">pad_best</code>, <code id="image.lmSubsets_+3A_pad_which">pad_which</code></td>
<td>
<p>padding</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_axis_pos">axis_pos</code>, <code id="image.lmSubsets_+3A_axis_tck">axis_tck</code>, <code id="image.lmSubsets_+3A_axis_lab">axis_lab</code></td>
<td>
<p>position of axes, tick length,
and position of labels</p>
</td></tr>
<tr><td><code id="image.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>invisible(x)</code>
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## data
data("AirPollution", package = "lmSubsets")


#################
##  lmSubsets  ##
#################

lm_all &lt;- lmSubsets(mortality ~ ., data = AirPollution, nbest = 20)

## heatmap
image(lm_all, best = 1:3)

## highlight 5 best (BIC)
image(lm_all, best = 1:3, hilite = 1:5, hilite_penalty = "BIC")


################
##  lmSelect  ##
################

## default criterion: BIC
lm_best &lt;- lmSelect(lm_all)

## highlight 5 best (AIC)
image(lm_best, hilite = 1:5, hilite_penalty = "AIC")

## axis labels
image(lm_best, lab = c("bold(lab)", "lab"), hilite = 1,
      lab_hilite = "underline(lab)")
</code></pre>

<hr>
<h2 id='lmSelect'>Best-subset regression</h2><span id='topic+lmSelect'></span><span id='topic+lmSelect.default'></span><span id='topic+print.lmSelect'></span>

<h3>Description</h3>

<p>Best-variable-subset selection in ordinary linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmSelect(formula, ...)

## Default S3 method:
lmSelect(formula, data, subset, weights, na.action,
         model = TRUE, x = FALSE, y = FALSE, contrasts = NULL,
         offset, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmSelect_+3A_formula">formula</code>, <code id="lmSelect_+3A_data">data</code>, <code id="lmSelect_+3A_subset">subset</code>, <code id="lmSelect_+3A_weights">weights</code>, <code id="lmSelect_+3A_na.action">na.action</code>, <code id="lmSelect_+3A_model">model</code>, <code id="lmSelect_+3A_x">x</code>, <code id="lmSelect_+3A_y">y</code>, <code id="lmSelect_+3A_contrasts">contrasts</code>, <code id="lmSelect_+3A_offset">offset</code></td>
<td>
<p>standard formula interface</p>
</td></tr>
<tr><td><code id="lmSelect_+3A_...">...</code></td>
<td>
<p>forwarded to <code>lmSelect_fit()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>lmSelect()</code> generic provides various methods to conveniently
specify the regressor and response variables.  The standard formula
interface (see <code><a href="stats.html#topic+lm">lm()</a></code>) can be used, or the model
information can be extracted from an already fitted <code>"lm"</code>
object.  The model matrix and response can also be passed in directly.
</p>
<p>After processing the arguments, the call is forwarded to
<code><a href="#topic+lmSelect_fit">lmSelect_fit()</a></code>.
</p>


<h3>Value</h3>

<p><code>"lmSelect"</code>&mdash;a <code>list</code> containing the components returned
by <code>lmSelect_fit()</code>
</p>
<p>Further components include <code>call</code>, <code>na.action</code>,
<code>weights</code>, <code>offset</code>, <code>contrasts</code>, <code>xlevels</code>,
<code>terms</code>, <code>mf</code>, <code>x</code>, and <code>y</code>.  See
<code><a href="stats.html#topic+lm">lm()</a></code> for more information.
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSelect.matrix">lmSelect.matrix()</a></code> for the
matrix interface
</p>
</li>
<li><p><code><a href="#topic+lmSelect.lmSubsets">lmSelect.lmSubsets()</a></code> for
coercing an all-subsets regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect_fit">lmSelect_fit()</a></code> for the low-level
interface
</p>
</li>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## load data
data("AirPollution", package = "lmSubsets")


###################
##  basic usage  ##
###################

## fit 20 best subsets (BIC)
lm_best &lt;- lmSelect(mortality ~ ., data = AirPollution, nbest = 20)
lm_best

## summary statistics
summary(lm_best)

## visualize
plot(lm_best)


########################
##  custom criterion  ##
########################

## the same as above, but with a custom criterion:
M &lt;- nrow(AirPollution)

ll &lt;- function (rss) {
  -M/2 * (log(2 * pi) - log(M) + log(rss) + 1)
}

aic &lt;- function (size, rss, k = 2) {
  -2 * ll(rss) + k * (size + 1)
}

bic &lt;- function (size, rss) {
  aic(size, rss, k = log(M))
}

lm_cust &lt;- lmSelect(mortality ~ ., data = AirPollution,
                    penalty = bic, nbest = 20)
lm_cust
</code></pre>

<hr>
<h2 id='lmSelect_fit'>Best-subset regression</h2><span id='topic+lmSelect_fit'></span>

<h3>Description</h3>

<p>Low-level interface to best-variable-subset selection in ordinary
linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmSelect_fit(x, y, weights = NULL, offset = NULL, include = NULL,
             exclude = NULL, penalty = "BIC", tolerance = 0,
             nbest = 1, ..., pradius = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmSelect_fit_+3A_x">x</code></td>
<td>
<p><code>double[,]</code>&mdash;the model matrix</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_y">y</code></td>
<td>
<p><code>double[]</code>&mdash;the model response</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_weights">weights</code></td>
<td>
<p><code>double[]</code>&mdash;the model weights</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_offset">offset</code></td>
<td>
<p><code>double[]</code>&mdash;the model offset</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_include">include</code></td>
<td>
<p><code>logical[]</code>, <code>integer[]</code>,
<code>character[]</code>&mdash;the regressors to force in</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_exclude">exclude</code></td>
<td>
<p><code>logical[]</code>, <code>integer[]</code>,
<code>character[]</code>&mdash;the regressors to force out</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_penalty">penalty</code></td>
<td>
<p><code>double</code>, <code>character</code>,
<code>"function"</code>&mdash;the penalty per model parameter</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_tolerance">tolerance</code></td>
<td>
<p><code>double</code>&mdash;the approximation tolerance</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_nbest">nbest</code></td>
<td>
<p><code>integer</code>&mdash;the number of best subsets</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="lmSelect_fit_+3A_pradius">pradius</code></td>
<td>
<p><code>integer</code>&mdash;the preordering radius</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The best variable-subset model is determined, where the &quot;best&quot; model
is the one with the lowest information criterion value.  The
information criterion belongs to the <a href="stats.html#topic+AIC">AIC</a> family.
</p>
<p>The regression data is specified with the <code>x</code>, <code>y</code>,
<code>weights</code>, and <code>offset</code> parameters.  See
<code><a href="stats.html#topic+lm.fit">lm.fit()</a></code> for further details.
</p>
<p>To force regressors into or out of the regression, a list of
regressors can be passed as an argument to the <code>include</code> or
<code>exclude</code> parameters, respectively.
</p>
<p>The information criterion is specified with the <code>penalty</code>
parameter.  Accepted values are <code>"AIC"</code>, <code>"BIC"</code>, or a
<code>"numeric"</code> value representing the penalty-per-model-parameter.
A custom selection criterion may be specified by passing an <code>R</code>
function as an argument.  The expected signature is <code>function
  (size, rss)</code>, where <code>size</code> is the number of predictors (including
the intercept, if any), and <code>rss</code> is the residual sum of squares.
The function must be non-decreasing in both parameters.
</p>
<p>An approximation <code>tolerance</code> can be specified to speed up the
search.
</p>
<p>The number of returned submodels is determined by the <code>nbest</code>
parameter.
</p>
<p>The preordering radius is given with the <code>pradius</code> parameter.
</p>


<h3>Value</h3>

<p>A <code>list</code> with the following components:
</p>
<table>
<tr><td><code>NOBS</code></td>
<td>
<p><code>integer</code>&mdash;number of observations in model (before
<code>weights</code> processing)</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p><code>integer</code>&mdash;number of observations in model (after
<code>weights</code> processing)</p>
</td></tr>
<tr><td><code>nvar</code></td>
<td>
<p><code>integer</code>&mdash;number of regressors in model</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p><code>double[]</code>&mdash;model weights</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p><code>logical</code>&mdash;is <code>TRUE</code> if model contains an
intercept term, <code>FALSE</code> otherwise</p>
</td></tr>
<tr><td><code>include</code></td>
<td>
<p><code>logical[]</code>&mdash;regressors forced into the
regression</p>
</td></tr>
<tr><td><code>exclude</code></td>
<td>
<p><code>logical[]</code>&mdash;regressors forced out of the
regression</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p><code>integer[]</code>&mdash;subset sizes</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>
<p>information criterion</p>
</td></tr>
<tr><td><code>tolerance</code></td>
<td>
<p><code>double</code>&mdash;approximation tolerance</p>
</td></tr>
<tr><td><code>nbest</code></td>
<td>
<p><code>integer</code>&mdash;number of best subsets</p>
</td></tr>
<tr><td><code>submodel</code></td>
<td>
<p><code>"data.frame"</code>&mdash;submodel information</p>
</td></tr>
<tr><td><code>subset</code></td>
<td>
<p><code>"data.frame"</code>&mdash;selected subsets</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hofmann M, Gatu C, Kontoghiorghes EJ, Colubi A, Zeileis A (2020).
lmSubsets: Exact variable-subset selection in linear regression for R.
<em>Journal of Statistical Software</em>, <strong>93</strong>, 1&ndash;21.
doi: <a href="https://doi.org/10.18637/jss.v093.i03">10.18637/jss.v093.i03</a>.
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for the high-level
interface
</p>
</li>
<li><p><code><a href="#topic+lmSubsets_fit">lmSubsets_fit()</a></code> for all-subsets
regression
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data("AirPollution", package = "lmSubsets")

x &lt;- as.matrix(AirPollution[, names(AirPollution) != "mortality"])
y &lt;-           AirPollution[, names(AirPollution) == "mortality"]

f &lt;- lmSelect_fit(x, y)
f
</code></pre>

<hr>
<h2 id='lmSelect.lmSubsets'>Best-subset regression</h2><span id='topic+lmSelect.lmSubsets'></span>

<h3>Description</h3>

<p>Coerce an all-subsets regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
lmSelect(formula, penalty = "BIC", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmSelect.lmSubsets_+3A_formula">formula</code></td>
<td>
<p><code>"lmSubsets"</code>&mdash;an all-subsets regression</p>
</td></tr>
<tr><td><code id="lmSelect.lmSubsets_+3A_penalty">penalty</code></td>
<td>
<p><code>double</code>, <code>character</code>,
<code>"function"</code>&mdash;penalty per model parameter</p>
</td></tr>
<tr><td><code id="lmSelect.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes a best-subset regression from an all-subsets regression.
</p>


<h3>Value</h3>

<p><code><a href="#topic+lmSelect">&quot;lmSelect&quot;</a></code>&mdash;a best-subset regression
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for the S3 generic
</p>
</li>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data("AirPollution", package = "lmSubsets")

lm_all &lt;- lmSubsets(mortality ~ ., data = AirPollution, nbest = 20)

lm_best &lt;- lmSelect(lm_all)
lm_best
</code></pre>

<hr>
<h2 id='lmSelect.matrix'>Best-subset regression</h2><span id='topic+lmSelect.matrix'></span>

<h3>Description</h3>

<p>Matrix interface to best-variable-subset selection in ordinary linear
regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
lmSelect(formula, y, intercept = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmSelect.matrix_+3A_formula">formula</code></td>
<td>
<p><code>"matrix"</code>&mdash;the model matrix</p>
</td></tr>
<tr><td><code id="lmSelect.matrix_+3A_y">y</code></td>
<td>
<p><code>double[]</code>&mdash;the model response</p>
</td></tr>
<tr><td><code id="lmSelect.matrix_+3A_intercept">intercept</code></td>
<td>
<p><code>logical[]</code>&mdash;if <code>FALSE</code>, remove intercept
term</p>
</td></tr>
<tr><td><code id="lmSelect.matrix_+3A_...">...</code></td>
<td>
<p>forwarded to
<code><a href="#topic+lmSelect.default">lmSelect.default()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a utility interface.  Use the standard formula interface
wherever possible.
</p>


<h3>Value</h3>

<p><code><a href="#topic+lmSelect">&quot;lmSelect&quot;</a></code>&mdash;a best-subset regression
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for the S3 generic
</p>
</li>
<li><p><code><a href="#topic+lmSelect.default">lmSelect.default()</a></code> for the
standard formula interface
</p>
</li></ul>


<hr>
<h2 id='lmSubsets'>All-subsets regression</h2><span id='topic+lmSubsets'></span><span id='topic+lmSubsets.default'></span><span id='topic+print.lmSubsets'></span>

<h3>Description</h3>

<p>All-variable-subsets selection in ordinary linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmSubsets(formula, ...)

## Default S3 method:
lmSubsets(formula, data, subset, weights, na.action,
          model = TRUE, x = FALSE, y = FALSE, contrasts = NULL,
          offset, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmSubsets_+3A_formula">formula</code>, <code id="lmSubsets_+3A_data">data</code>, <code id="lmSubsets_+3A_subset">subset</code>, <code id="lmSubsets_+3A_weights">weights</code>, <code id="lmSubsets_+3A_na.action">na.action</code>, <code id="lmSubsets_+3A_model">model</code>, <code id="lmSubsets_+3A_x">x</code>, <code id="lmSubsets_+3A_y">y</code>, <code id="lmSubsets_+3A_contrasts">contrasts</code>, <code id="lmSubsets_+3A_offset">offset</code></td>
<td>
<p>standard formula interface</p>
</td></tr>
<tr><td><code id="lmSubsets_+3A_...">...</code></td>
<td>
<p>fowarded to <code>lmSubsets_fit()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>lmSubsets()</code> generic provides various methods to
conveniently specify the regressor and response variables.  The
standard formula interface (see <code><a href="stats.html#topic+lm">lm()</a></code>) can be used,
or the model information can be extracted from an already fitted
<code>"lm"</code> object.  The model matrix and response can also be passed
in directly.
</p>
<p>After processing of the arguments, the call is forwarded to
<code><a href="#topic+lmSubsets_fit">lmSubsets_fit()</a></code>.
</p>


<h3>Value</h3>

<p><code>"lmSubsets"</code>&mdash;a <code>list</code> containing the components returned
by <code>lmSubsets_fit()</code>
</p>
<p>Further components include <code>call</code>, <code>na.action</code>,
<code>weights</code>, <code>offset</code>, <code>contrasts</code>, <code>xlevels</code>,
<code>terms</code>, <code>mf</code>, <code>x</code>, and <code>y</code>.  See
<code><a href="stats.html#topic+lm">lm()</a></code> for more information.
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets.matrix">lmSubsets.matrix()</a></code> for the
<code>"matrix"</code> interface
</p>
</li>
<li><p><code><a href="#topic+lmSubsets_fit">lmSubsets_fit()</a></code> for the
low-level interface
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## load data
data("AirPollution", package = "lmSubsets")


###################
##  basic usage  ##
###################

## canonical example: fit all subsets
lm_all &lt;- lmSubsets(mortality ~ ., data = AirPollution, nbest = 5)
lm_all

## plot RSS and BIC
plot(lm_all)

## summary statistics
summary(lm_all)


############################
##  forced in-/exclusion  ##
############################

lm_force &lt;- lmSubsets(lm_all, include = c("nox", "so2"),
                      exclude = "whitecollar")
lm_force
</code></pre>

<hr>
<h2 id='lmSubsets_fit'>All-subsets regression</h2><span id='topic+lmSubsets_fit'></span>

<h3>Description</h3>

<p>Low-level interface to all-variable-subsets selection in ordinary
linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmSubsets_fit(x, y, weights = NULL, offset = NULL, include = NULL,
              exclude = NULL, nmin = NULL, nmax = NULL,
              tolerance = 0, nbest = 1, ..., pradius = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmSubsets_fit_+3A_x">x</code></td>
<td>
<p><code>double[,]</code>&mdash;the model matrix</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_y">y</code></td>
<td>
<p><code>double[]</code>&mdash;the model response</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_weights">weights</code></td>
<td>
<p><code>double[]</code>&mdash;the model weights</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_offset">offset</code></td>
<td>
<p><code>double[]</code>&mdash;the model offset</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_include">include</code></td>
<td>
<p><code>logical[]</code>, <code>integer[]</code>,
<code>character[]</code>&mdash;the regressors to force in</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_exclude">exclude</code></td>
<td>
<p><code>logical[]</code>, <code>integer[]</code>,
<code>character[]</code>&mdash;the regressors to force out</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_nmin">nmin</code></td>
<td>
<p><code>integer</code>&mdash;the minimum number of regressors</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_nmax">nmax</code></td>
<td>
<p><code>integer</code>&mdash;the maximum number of regressors</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_tolerance">tolerance</code></td>
<td>
<p><code>double[]</code>&mdash;the approximation tolerances</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_nbest">nbest</code></td>
<td>
<p><code>integer</code>&mdash;the number of best subsets</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="lmSubsets_fit_+3A_pradius">pradius</code></td>
<td>
<p><code>integer</code>&mdash;the preordering radius</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The best variable-subset model for every subset size is determined,
where the &quot;best&quot; model is the one with the lowest residual sum of
squares (RSS).
</p>
<p>The regression data is specified with the <code>x</code>, <code>y</code>,
<code>weights</code>, and <code>offset</code> parameters.  See
<code><a href="stats.html#topic+lm.fit">lm.fit()</a></code> for further details.
</p>
<p>To force regressors into or out of the regression, a list of
regressors can be passed as an argument to the <code>include</code> or
<code>exclude</code> parameters, respectively.
</p>
<p>The scope of the search can be limited to a range of subset sizes by
setting <code>nmin</code> and <code>nmax</code>, the minimum and maximum number of
regressors allowed in the regression, respectively.
</p>
<p>A <code>tolerance</code> vector can be specified to speed up the search,
where <code>tolerance[j]</code> is the approximation tolerance applied to
subset models of size <code>j</code>.
</p>
<p>The number of submodels returned for each subset size is determined by
the <code>nbest</code> parameter.
</p>
<p>The preordering radius is given with the <code>pradius</code> parameter.
</p>


<h3>Value</h3>

<p>A <code>list</code> with the following components:
</p>
<table>
<tr><td><code>NOBS</code></td>
<td>
<p><code>integer</code>&mdash;number of observations in model (before
<code>weights</code> processing)</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p><code>integer</code>&mdash;number of observations in model (after
<code>weights</code> processing)</p>
</td></tr>
<tr><td><code>nvar</code></td>
<td>
<p><code>integer</code>&mdash;number of regressors in model</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p><code>double[]</code>&mdash;model weights</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p><code>logical</code>&mdash;is <code>TRUE</code> if model contains an
intercept term, <code>FALSE</code> otherwise</p>
</td></tr>
<tr><td><code>include</code></td>
<td>
<p><code>logical[]</code>&mdash;regressors forced into the
regression</p>
</td></tr>
<tr><td><code>exclude</code></td>
<td>
<p><code>logical[]</code>&mdash;regressors forced out of the
regression</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p><code>integer[]</code>&mdash;subset sizes</p>
</td></tr>
<tr><td><code>tolerance</code></td>
<td>
<p><code>double[]</code>&mdash;approximation tolerances</p>
</td></tr>
<tr><td><code>nbest</code></td>
<td>
<p><code>integer</code>&mdash;number of best subsets</p>
</td></tr>
<tr><td><code>submodel</code></td>
<td>
<p><code>"data.frame"</code>&mdash;submodel information</p>
</td></tr>
<tr><td><code>subset</code></td>
<td>
<p><code>"data.frame"</code>&mdash;variable subsets</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hofmann M, Gatu C, Kontoghiorghes EJ, Colubi A, Zeileis A (2020).
lmSubsets: Exact variable-subset selection in linear regression for R.
<em>Journal of Statistical Software</em>, <strong>93</strong>, 1&ndash;21.
doi: <a href="https://doi.org/10.18637/jss.v093.i03">10.18637/jss.v093.i03</a>.
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for the high-level
interface
</p>
</li>
<li><p><code><a href="#topic+lmSelect_fit">lmSelect_fit()</a></code> for best-subset
regression
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data("AirPollution", package = "lmSubsets")

x &lt;- as.matrix(AirPollution[, names(AirPollution) != "mortality"])
y &lt;-           AirPollution[, names(AirPollution) == "mortality"]

f &lt;- lmSubsets_fit(x, y)
f
</code></pre>

<hr>
<h2 id='lmSubsets-package'>Package <code>lmSubsets</code></h2><span id='topic+lmSubsets-package'></span>

<h3>Description</h3>

<p>Variable-subset selection in ordinary linear regression.
</p>


<h3>Author(s)</h3>


<ul>
<li><p>Marc Hofmann (<a href="mailto:marc.hofmann@gmail.com">marc.hofmann@gmail.com</a>)
</p>
</li>
<li><p>Cristian Gatu (<a href="mailto:cgatu@info.uaic.ro">cgatu@info.uaic.ro</a>)
</p>
</li>
<li><p>Erricos J. Kontoghiorghes (<a href="mailto:erricos@dcs.bbk.ac.uk">erricos@dcs.bbk.ac.uk</a>)
</p>
</li>
<li><p>Ana Colubi (<a href="mailto:ana.colubi@gmail.com">ana.colubi@gmail.com</a>)
</p>
</li>
<li><p>Achim Zeileis (<a href="mailto:Achim.Zeileis@R-project.org">Achim.Zeileis@R-project.org</a>)
</p>
</li></ul>



<h3>References</h3>

<p>Hofmann M, Gatu C, Kontoghiorghes EJ, Colubi A, Zeileis A (2020).
lmSubsets: Exact variable-subset selection in linear regression for R.
<em>Journal of Statistical Software</em>, <strong>93</strong>, 1&ndash;21.
doi: <a href="https://doi.org/10.18637/jss.v093.i03">10.18637/jss.v093.i03</a>.
</p>
<p>Hofmann M, Gatu C, Kontoghiorghes EJ (2007).  Efficient algorithms for
computing the best subset regression models for large-scale problems.
<em>Computational Statistics \&amp; Data Analysis</em>, <strong>52</strong>, 16&ndash;29.
doi: <a href="https://doi.org/10.1016/j.csda.2007.03.017">10.1016/j.csda.2007.03.017</a>.
</p>
<p>Gatu C, Kontoghiorghes EJ (2006).  Branch-and-bound algorithms for
computing the best subset regression models.  <em>Journal of
Computational and Graphical Statistics</em>, <strong>15</strong>, 139&ndash;156.
doi: <a href="https://doi.org/10.1198/106186006x100290">10.1198/106186006x100290</a>.
</p>


<h3>See Also</h3>

<p>Home page:  <a href="https://github.com/marc-hofmann/lmSubsets.R">https://github.com/marc-hofmann/lmSubsets.R</a>
</p>

<hr>
<h2 id='lmSubsets.matrix'>All-subsets regression</h2><span id='topic+lmSubsets.matrix'></span>

<h3>Description</h3>

<p>Matrix interface to all-variable-subsets selection in ordinary linear
regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
lmSubsets(formula, y, intercept = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmSubsets.matrix_+3A_formula">formula</code></td>
<td>
<p><code>"matrix"</code>&mdash;the model matrix</p>
</td></tr>
<tr><td><code id="lmSubsets.matrix_+3A_y">y</code></td>
<td>
<p><code>double[]</code>&mdash;the model response</p>
</td></tr>
<tr><td><code id="lmSubsets.matrix_+3A_intercept">intercept</code></td>
<td>
<p><code>logical</code>&mdash;if <code>FALSE</code>, remove intercept
term</p>
</td></tr>
<tr><td><code id="lmSubsets.matrix_+3A_...">...</code></td>
<td>
<p>forwarded to
<code><a href="#topic+lmSubsets.default">lmSubsets.default()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a utility interface.  Use the standard formula interface
wherever possible.
</p>


<h3>Value</h3>

<p><code><a href="#topic+lmSubsets">&quot;lmSubsets&quot;</a></code>&mdash;an all-subsets regression
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for the S3 generic
</p>
</li>
<li><p><code><a href="#topic+lmSubsets.default">lmSubsets.default()</a></code> for the
standard formula interface
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data("AirPollution", package = "lmSubsets")

x &lt;- as.matrix(AirPollution)

lm_mat &lt;- lmSubsets(x, y = "mortality")
lm_mat
</code></pre>

<hr>
<h2 id='logLik.lmSubsets'>Extract the log-likelihood from a subset regression</h2><span id='topic+logLik.lmSubsets'></span><span id='topic+logLik.lmSelect'></span>

<h3>Description</h3>

<p>Return the log-likelihood of the the specified submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
logLik(object, size, best = 1, ..., na.rm = TRUE, drop = TRUE)

## S3 method for class 'lmSelect'
logLik(object, best = 1, ..., na.rm = TRUE, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="logLik.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel sizes</p>
</td></tr>
<tr><td><code id="logLik.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel positions</p>
</td></tr>
<tr><td><code id="logLik.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="logLik.lmSubsets_+3A_na.rm">na.rm</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, remove <code>NA</code>
entries</p>
</td></tr>
<tr><td><code id="logLik.lmSubsets_+3A_drop">drop</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, simplify structure</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[]</code>&mdash;the log-likelihoods
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+logLik">logLik()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='model_response'>Model response</h2><span id='topic+model_response'></span><span id='topic+model_response.default'></span>

<h3>Description</h3>

<p>Extract the model response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_response(data, ...)

## Default S3 method:
model_response(data, type = "any", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_response_+3A_data">data</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="model_response_+3A_type">type</code></td>
<td>
<p><code>character</code>&mdash;the return type</p>
</td></tr>
<tr><td><code id="model_response_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default method simply forwards the call to
<code>model.response()</code>.
</p>


<h3>Value</h3>

<p><code>double[]</code>&mdash;the model response
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="stats.html#topic+model.response">model.response()</a></code> for the
default implementation
</p>
</li></ul>


<hr>
<h2 id='model_response.lmSubsets'>Extract the model response from a subset regression</h2><span id='topic+model_response.lmSubsets'></span><span id='topic+model_response.lmSelect'></span>

<h3>Description</h3>

<p>Return the model response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
model_response(data, ...)

## S3 method for class 'lmSelect'
model_response(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_response.lmSubsets_+3A_data">data</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="model_response.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[]</code>&mdash;the model response
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="#topic+model_response">model_response()</a></code> for the S3
generic
</p>
</li></ul>


<hr>
<h2 id='model.frame.lmSubsets'>Extract the model frame from a subset regression</h2><span id='topic+model.frame.lmSubsets'></span><span id='topic+model.frame.lmSelect'></span>

<h3>Description</h3>

<p>Return the model frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
model.frame(formula, ...)

## S3 method for class 'lmSelect'
model.frame(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.frame.lmSubsets_+3A_formula">formula</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="model.frame.lmSubsets_+3A_...">...</code></td>
<td>
<p>forwarded to <code>model.frame()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>"data.frame"</code>&mdash;the model frame
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+model.frame">model.frame()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='model.matrix.lmSubsets'>Extract a model matrix from a subset regression</h2><span id='topic+model.matrix.lmSubsets'></span><span id='topic+model.matrix.lmSelect'></span>

<h3>Description</h3>

<p>Returns the model matrix for the specified submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
model.matrix(object, size, best = 1, ...)

## S3 method for class 'lmSelect'
model.matrix(object, best, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="model.matrix.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer</code>&mdash;the submodel size</p>
</td></tr>
<tr><td><code id="model.matrix.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer</code>&mdash;the submodel position</p>
</td></tr>
<tr><td><code id="model.matrix.lmSubsets_+3A_...">...</code></td>
<td>
<p>forwarded to <code><a href="stats.html#topic+model.frame">model.frame()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[,]</code>&mdash;the model matrix
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+model.matrix">model.matrix()</a></code> for the S3
generic
</p>
</li></ul>


<hr>
<h2 id='plot.lmSubsets'>Plot a subset regression</h2><span id='topic+plot.lmSubsets'></span><span id='topic+plot.lmSelect'></span>

<h3>Description</h3>

<p>Plot the deviance of the selected submodels, as well as a specified
information criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
plot(x, penalty = "BIC", xlim, ylim_rss, ylim_ic, type_rss = "o",
     type_ic = "o", main, sub, xlab, ylab_rss, ylab_ic, legend_rss,
     legend_ic, ann = par("ann"), axes = TRUE, lty_rss = c(1, 3),
     pch_rss = c(16, 21), col_rss = "black", bg_rss = "white",
     lty_ic = c(1, 3), pch_ic = c(16, 21), col_ic = "red",
     bg_ic = "white", ...)

## S3 method for class 'lmSelect'
plot(x, xlim, ylim, type = "o", main, sub, xlab, ylab, legend,
     ann = par("ann"), axes = TRUE, lty = 1, pch = 16, col = "red",
     bg = "white", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.lmSubsets_+3A_x">x</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset regression</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_penalty">penalty</code></td>
<td>
<p>the information criterion</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_xlim">xlim</code>, <code id="plot.lmSubsets_+3A_ylim">ylim</code>, <code id="plot.lmSubsets_+3A_ylim_rss">ylim_rss</code>, <code id="plot.lmSubsets_+3A_ylim_ic">ylim_ic</code></td>
<td>
<p>x and y limits</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_type">type</code>, <code id="plot.lmSubsets_+3A_type_rss">type_rss</code>, <code id="plot.lmSubsets_+3A_type_ic">type_ic</code></td>
<td>
<p>type of plot</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_main">main</code>, <code id="plot.lmSubsets_+3A_sub">sub</code></td>
<td>
<p>main and sub-title</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_xlab">xlab</code>, <code id="plot.lmSubsets_+3A_ylab">ylab</code>, <code id="plot.lmSubsets_+3A_ylab_rss">ylab_rss</code>, <code id="plot.lmSubsets_+3A_ylab_ic">ylab_ic</code></td>
<td>
<p>axis titles</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_legend">legend</code>, <code id="plot.lmSubsets_+3A_legend_rss">legend_rss</code>, <code id="plot.lmSubsets_+3A_legend_ic">legend_ic</code></td>
<td>
<p>plot legend</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_ann">ann</code></td>
<td>
<p>annotate plot</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_axes">axes</code></td>
<td>
<p>plot axes</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_lty">lty</code>, <code id="plot.lmSubsets_+3A_lty_rss">lty_rss</code>, <code id="plot.lmSubsets_+3A_lty_ic">lty_ic</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_pch">pch</code>, <code id="plot.lmSubsets_+3A_pch_rss">pch_rss</code>, <code id="plot.lmSubsets_+3A_pch_ic">pch_ic</code></td>
<td>
<p>plotting character</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_col">col</code>, <code id="plot.lmSubsets_+3A_col_rss">col_rss</code>, <code id="plot.lmSubsets_+3A_col_ic">col_ic</code></td>
<td>
<p>color</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_bg">bg</code>, <code id="plot.lmSubsets_+3A_bg_rss">bg_rss</code>, <code id="plot.lmSubsets_+3A_bg_ic">bg_ic</code></td>
<td>
<p>background color</p>
</td></tr>
<tr><td><code id="plot.lmSubsets_+3A_...">...</code></td>
<td>
<p>further graphical parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>invisible(x)</code>
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="graphics.html#topic+plot">plot()</a></code> for the S3 generic
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## load data
data("AirPollution", package = "lmSubsets")


#################
##  lmSubsets  ##
#################

lm_all &lt;- lmSubsets(mortality ~ ., data = AirPollution, nbest = 5)
plot(lm_all)


################
##  lmSelect  ##
################

lm_best &lt;- lmSelect(mortality ~ ., data = AirPollution, nbest = 20)
plot(lm_best)
</code></pre>

<hr>
<h2 id='refit'>Refitting models</h2><span id='topic+refit'></span>

<h3>Description</h3>

<p>Generic function for refitting a model on a subset or reweighted data
set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refit(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="refit_+3A_object">object</code></td>
<td>
<p>an object to be refitted</p>
</td></tr>
<tr><td><code id="refit_+3A_...">...</code></td>
<td>
<p>forwarded arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>refit</code> generic is a new function for refitting a certain
model object on multiple versions of a data set (and is hence
different from <code>update</code>).  Applications refit models after some
kind of model selection, e.g., variable subset selection,
partitioning, reweighting, etc.
</p>
<p>The generic is similar to the one provided in <span class="pkg">modeltools</span> and
<span class="pkg">fxregime</span> (and should fulfill the same purpose).  To avoid
dependencies, it is also provided here.
</p>


<h3>Value</h3>

<p><code>"lm"</code>&mdash;the refitted model
</p>

<hr>
<h2 id='refit.lmSubsets'>Refit a subset regression</h2><span id='topic+refit.lmSubsets'></span><span id='topic+refit.lmSelect'></span>

<h3>Description</h3>

<p>Fit the specified submodel and return the obtained <code>"lm"</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
refit(object, size, best = 1, ...)

## S3 method for class 'lmSelect'
refit(object, best = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="refit.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="refit.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer</code>&mdash;the submodel size</p>
</td></tr>
<tr><td><code id="refit.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer</code>&mdash;the submodel position</p>
</td></tr>
<tr><td><code id="refit.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>"lm"</code>&mdash;the fitted model
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="#topic+refit">refit()</a></code> for the S3 generic
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## load data
data("AirPollution", package = "lmSubsets")

## fit subsets
lm_all &lt;- lmSubsets(mortality ~ ., data = AirPollution)

## refit best model
lm5 &lt;- refit(lm_all, size = 5)
summary(lm5)
</code></pre>

<hr>
<h2 id='residuals.lmSubsets'>Extract the residuals from all-subsets regression</h2><span id='topic+residuals.lmSubsets'></span><span id='topic+residuals.lmSelect'></span>

<h3>Description</h3>

<p>Return the residuals for the specified submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
residuals(object, size, best = 1, ...)

## S3 method for class 'lmSelect'
residuals(object, best = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="residuals.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer</code>&mdash;the submodel size</p>
</td></tr>
<tr><td><code id="residuals.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer</code>&mdash;the submodel position</p>
</td></tr>
<tr><td><code id="residuals.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[]</code>&mdash;the residuals
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+residuals">residuals()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='sigma.lmSubsets'>Extract the residual standard deviation from a subset regression</h2><span id='topic+sigma.lmSubsets'></span><span id='topic+sigma.lmSelect'></span>

<h3>Description</h3>

<p>Return the residual standard deviation for the specified submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
sigma(object, size, best = 1, ..., na.rm = TRUE, drop = TRUE)

## S3 method for class 'lmSelect'
sigma(object, best = 1, ..., na.rm = TRUE, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigma.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="sigma.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel sizes</p>
</td></tr>
<tr><td><code id="sigma.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel positions</p>
</td></tr>
<tr><td><code id="sigma.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="sigma.lmSubsets_+3A_na.rm">na.rm</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, remove <code>NA</code>
entries</p>
</td></tr>
<tr><td><code id="sigma.lmSubsets_+3A_drop">drop</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, simplify structure</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[]</code>&mdash;the residual standard deviations
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+sigma">sigma()</a></code> for the S3 generic
</p>
</li></ul>


<hr>
<h2 id='summary.lmSubsets'>Summarize a subset regression</h2><span id='topic+summary.lmSubsets'></span><span id='topic+summary.lmSelect'></span><span id='topic+print.summary.lmSubsets'></span><span id='topic+print.summary.lmSelect'></span>

<h3>Description</h3>

<p>Evaluate summary statistics for the selected submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
summary(object, ..., na.rm = TRUE)

## S3 method for class 'lmSelect'
summary(object, ..., na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="summary.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="summary.lmSubsets_+3A_na.rm">na.rm</code></td>
<td>
<p>if <code>TRUE</code>, remove <code>NA</code> values</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>"summary.lmSubsets"</code>, <code>"summary.lmSelect"</code>&mdash;a subset
regression summary
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li></ul>


<hr>
<h2 id='variable.names.lmSubsets'>Extract variable names from a subset regression</h2><span id='topic+variable.names.lmSubsets'></span><span id='topic+variable.names.lmSelect'></span>

<h3>Description</h3>

<p>Return the variable names for the specified submodels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
variable.names(object, size, best = 1, ..., na.rm = TRUE, drop = TRUE)

## S3 method for class 'lmSelect'
variable.names(object, best = 1, ..., na.rm = TRUE, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variable.names.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="variable.names.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel sizes</p>
</td></tr>
<tr><td><code id="variable.names.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer[]</code>&mdash;the submodel positions</p>
</td></tr>
<tr><td><code id="variable.names.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="variable.names.lmSubsets_+3A_na.rm">na.rm</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, remove <code>NA</code>
entries</p>
</td></tr>
<tr><td><code id="variable.names.lmSubsets_+3A_drop">drop</code></td>
<td>
<p><code>logical</code>&mdash;if <code>TRUE</code>, simplify structure</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>logical[,]</code>, <code>"data.frame"</code>&mdash;the variable names
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+variable.names">variable.names()</a></code> for the S3
generic
</p>
</li></ul>


<hr>
<h2 id='vcov.lmSubsets'>Extract the variance-covariance matrix from a subset regression</h2><span id='topic+vcov.lmSubsets'></span><span id='topic+vcov.lmSelect'></span>

<h3>Description</h3>

<p>Return the variance-covariance matrix for the specified submodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmSubsets'
vcov(object, size, best = 1, ...)

## S3 method for class 'lmSelect'
vcov(object, best = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.lmSubsets_+3A_object">object</code></td>
<td>
<p><code>"lmSubsets"</code>, <code>"lmSelect"</code>&mdash;a subset
regression</p>
</td></tr>
<tr><td><code id="vcov.lmSubsets_+3A_size">size</code></td>
<td>
<p><code>integer</code>&mdash;the submodel size</p>
</td></tr>
<tr><td><code id="vcov.lmSubsets_+3A_best">best</code></td>
<td>
<p><code>integer</code>&mdash;the submodel position</p>
</td></tr>
<tr><td><code id="vcov.lmSubsets_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>double[,]</code>&mdash;the variance-covariance matrix
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+lmSubsets">lmSubsets()</a></code> for all-subsets
regression
</p>
</li>
<li><p><code><a href="#topic+lmSelect">lmSelect()</a></code> for best-subset
regression
</p>
</li>
<li><p><code><a href="stats.html#topic+vcov">vcov()</a></code> for the S3 generic
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
