<!DOCTYPE html><html lang="en"><head><title>Help for package sahpm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sahpm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#sahpmlm'><p>This implements the stochastic search based on Simulated Anneling strategy.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Variable Selection using Simulated Annealing</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Highest posterior model is widely accepted as a good model among available models. In terms of variable selection highest posterior model is often the true model. Our stochastic search process SAHPM based on simulated annealing maximization method tries to find the highest posterior model by maximizing the model space with respect to the posterior probabilities of the models. This package currently contains the SAHPM method only for linear models. The codes for GLM will be added in future.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, mvtnorm, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-22 21:54:04 UTC; SUDESHNA</td>
</tr>
<tr>
<td>Author:</td>
<td>Arnab Maity [aut, cre],
  Sanjib Basu [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arnab Maity &lt;arnab.maity@pfizer.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-24 08:20:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='sahpmlm'>This implements the stochastic search based on Simulated Anneling strategy.</h2><span id='topic+sahpmlm'></span>

<h3>Description</h3>

<p>Highest posterior model is widely accepted as a good model among available
models. In terms of variable selection highest posterior model is often the true
model. Our stochastic search process SAHPM based on simulated annealing maximization method
tries to find the highest posterior model by maximizing the model space with
respect to the posterior probabilities of the models. This function currently
contains the SAHPM method only for linear models. The codes for GLM will be
added in future.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sahpmlm(formula, data, na.action, g = n, nstep = 200, abstol = 1e-07,
  replace = FALSE, burnin = FALSE, nburnin = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sahpmlm_+3A_formula">formula</code></td>
<td>
<p>an object of class <code><a href="stats.html#topic+formula">formula</a></code> (or one that can be
coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="sahpmlm_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible
by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data frame) containing the variables in the
model. If not found in data, the variables are taken from environment(formula),
typically the environment from which <code><a href="stats.html#topic+lm">lm</a></code> is called.</p>
</td></tr>
<tr><td><code id="sahpmlm_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain
<code>NA</code>s.  The default is set by the <code>na.action</code> setting of
<code><a href="base.html#topic+options">options</a></code>, and is <code><a href="stats.html#topic+na.fail">na.fail</a></code> if that is unset.
The &ldquo;factory-fresh&rdquo; default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.  Another possible
value is <code>NULL</code>, no action.  Value <code><a href="stats.html#topic+na.exclude">na.exclude</a></code> can be useful.</p>
</td></tr>
<tr><td><code id="sahpmlm_+3A_g">g</code></td>
<td>
<p>value of <code class="reqn">g</code> for <code class="reqn">g</code> prior. Default is sample size <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="sahpmlm_+3A_nstep">nstep</code></td>
<td>
<p>maximum number of steps for simulated annealing search.</p>
</td></tr>
<tr><td><code id="sahpmlm_+3A_abstol">abstol</code></td>
<td>
<p>desired level of difference of marginal likelihoods between two steps.</p>
</td></tr>
<tr><td><code id="sahpmlm_+3A_replace">replace</code></td>
<td>
<p>logical. If <code>TRUE</code> the replce step is considered in the search. Default is FALSE.</p>
</td></tr>
<tr><td><code id="sahpmlm_+3A_burnin">burnin</code></td>
<td>
<p>logical. If <code>TRUE</code> the burnin is added. Default is FALSE. Number of burnin is specified by the next input.</p>
</td></tr>
<tr><td><code id="sahpmlm_+3A_nburnin">nburnin</code></td>
<td>
<p>Number of burnin (required if burnin = TRUE). Default is 50.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is:
</p>
<p style="text-align: center;"><code class="reqn">y= \alpha + X\beta+\epsilon, \epsilon \sim N(0,\sigma^2)</code>
</p>

<p>The Zellner's <code class="reqn">g</code> prior is used with default <code class="reqn">g = n</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>final.model</code></td>
<td>
<p>A column vector which corresponds to the original
variable indices.</p>
</td></tr>
<tr><td><code>history</code></td>
<td>
<p>A history of the search process. By columns: Step number,
temperature, current objective function value, current minimal objective
function value, current model, posterior probability of current model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Maity, A., K., and Basu, S. Highest Posterior Model Computation and
Variable Selection via the Simulated Annealing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(mvtnorm)     # for multivariate normal distribution
n &lt;- 100             # sample size
k &lt;- 40              # number of variables
z &lt;- as.vector(rmvnorm(1, mean = rep(0, n), sigma = diag(n)))
x &lt;- matrix(NA, nrow = n, ncol = k)
for(i in 1:k)
{
x[, i] &lt;- as.vector(rmvnorm(1, mean = rep(0, n), sigma = diag(n))) + z
}                    # this induce 0.5 correlation among the variables
beta &lt;- c(rep(0, 10), rep(2, 10), rep(0, 10), rep(2, 10))
                     # vector of coefficients
sigma &lt;- 1
sigma.square &lt;- sigma^2
linear.pred &lt;- x %*% beta
y &lt;- as.numeric(t(rmvnorm(1, mean = linear.pred, sigma = diag(sigma.square, n))))
                     # response
answer &lt;- sahpmlm(formula = y ~ x)
answer$final.model
answer$history


## Not run: 
# With small effect size
beta &lt;- c(rep(0, 10), rep(1, 10), rep(0, 10), rep(1, 10))
                     # vector of coefficients

linear.pred &lt;- x %*% beta
y &lt;- as.numeric(t(rmvnorm(1, mean = linear.pred, sigma = diag(sigma.square, n))))
                     # response
answer &lt;- sahpmlm(formula = y ~ x)
answer$final.model  # Might miss some of the true predictors
answer$history

# Able to recover all the predictors with 50 burnin
answer &lt;- sahpmlm(formula = y ~ x, burnin = TRUE, nburnin = 50)
answer$final.model  # Misses some of the true predictors
answer$history

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
