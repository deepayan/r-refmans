<!DOCTYPE html><html lang="en"><head><title>Help for package animate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {animate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#animate'><p>A web-based graphics device for animated visualisations</p></a></li>
<li><a href='#animateDependencies'><p>The HTML dependency of an 'animate' plot</p></a></li>
<li><a href='#animateOutput'><p>Create an animate output (container) element</p></a></li>
<li><a href='#click_to_loop'><p>Click an element to play all frames</p></a></li>
<li><a href='#click_to_play'><p>Click an element to play a frame</p></a></li>
<li><a href='#ffmpeg'><p>Launch the 'FFmpeg'-based video editor ('Shiny' app)</p></a></li>
<li><a href='#ffmpeg_command'><p>'FFmpeg' command builder</p></a></li>
<li><a href='#ffmpeg_shiny'><p>'FFmpeg'-based video editor ('Shiny' app)</p></a></li>
<li><a href='#insert_animate'><p>Insert an animated plot into an R Markdown document</p></a></li>
<li><a href='#loop'><p>Loop through the available frames n times</p></a></li>
<li><a href='#new_id'><p>A utility function for generating IDs</p></a></li>
<li><a href='#rmd_animate'><p>In-line rendering of an animated plot in an R Markdown document</p></a></li>
<li><a href='#websocket'><p>Start a Websocket server</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>A Web-Based Graphics Device for Animated Visualisations</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.9.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a web-based graphics device for animated visualisations.
  Modelled on the 'base' syntax, it extends the 'base' graphics functions to
  support frame-by-frame animation and keyframes animation.
  The target use cases are real-time animated visualisations, including agent-based
  models, dynamical systems, and animated diagrams.
  The generated visualisations can be deployed as GIF images / MP4 videos, as
  'Shiny' apps (with interactivity) or as HTML documents through embedding into
  R Markdown documents.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://kcf-jackson.github.io/animate/">https://kcf-jackson.github.io/animate/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kcf-jackson/animate/issues">https://github.com/kcf-jackson/animate/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>R6, httpuv, base64enc, jsonlite, glue, R.utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, shiny, htmltools, pryr, V8, servr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-03 06:57:49 UTC; jkwok</td>
</tr>
<tr>
<td>Author:</td>
<td>Chun Fung Kwok <a href="https://orcid.org/0000-0002-0716-3879"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Davis McCarthy <a href="https://orcid.org/0000-0002-2218-6833"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chun Fung Kwok &lt;kcf.jackson@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-03 10:42:32 UTC</td>
</tr>
</table>
<hr>
<h2 id='animate'>A web-based graphics device for animated visualisations</h2><span id='topic+animate'></span>

<h3>Description</h3>

<p>Extends the 'base' graphics functions to support frame-by-frame
animation and keyframes animation.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>connection</code></dt><dd><p>A handle for the WebSocket connection.</p>
</dd>
<dt><code>ready_state</code></dt><dd><p>The ready state of the connection.</p>
</dd>
<dt><code>shiny</code></dt><dd><p>TRUE or FALSE; whether the device is used with in a 'Shiny' app.</p>
</dd>
<dt><code>session</code></dt><dd><p>A 'Shiny' session.</p>
</dd>
<dt><code>virtual_meta</code></dt><dd><p>A list of device metadata.</p>
</dd>
<dt><code>virtual_session</code></dt><dd><p>A virtual session simulated with 'V8'.</p>
</dd>
<dt><code>event_handlers</code></dt><dd><p>A named list of user-defined functions for handling events.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-animate-new"><code>animate$new()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-off"><code>animate$off()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-send"><code>animate$send()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-set_max_stacksize"><code>animate$set_max_stacksize()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-svg"><code>animate$svg()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-bars"><code>animate$bars()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-objects"><code>animate$objects()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-plot"><code>animate$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-points"><code>animate$points()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-lines"><code>animate$lines()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-abline"><code>animate$abline()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-axis"><code>animate$axis()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-text"><code>animate$text()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-image"><code>animate$image()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-event"><code>animate$event()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-chain"><code>animate$chain()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-simple_event"><code>animate$simple_event()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-set"><code>animate$set()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-par"><code>animate$par()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-remove"><code>animate$remove()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-clear"><code>animate$clear()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-delete"><code>animate$delete()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-import"><code>animate$import()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-export"><code>animate$export()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-record"><code>animate$record()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-observeAnimateEvent"><code>animate$observeAnimateEvent()</code></a>
</p>
</li>
<li> <p><a href="#method-animate-clone"><code>animate$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-animate-new"></a>



<h4>Method <code>new()</code></h4>

<p>Constructor of the device
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$new(width, height, id = "SVG_1", launch.browser, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>width</code></dt><dd><p>An integer; the width in pixels.</p>
</dd>
<dt><code>height</code></dt><dd><p>An integer; the height in pixels.</p>
</dd>
<dt><code>id</code></dt><dd><p>A character string; the id assigned to the device.</p>
</dd>
<dt><code>launch.browser</code></dt><dd><p>A function to launch a viewer; two options are
<code>rstudioapi::viewer</code> and <code>utils::browseURL</code>. It defaults to the first
option if the user is using RStudio and to the second option otherwise.
The default applies to interactive session only.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional arguments. Use <code>virtual = TRUE</code> to use the virtual
device, <code>shiny = TRUE</code> for shiny application; everything else will be
passed to the SVG element that hosts the visualisation.</p>
</dd>
</dl>

</div>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
library(animate)
device &lt;- animate$new(400, 400)  # Launch a WebSocket server
attach(device)
x &lt;- 1:10
y &lt;- 1:10
id &lt;- new_id(x)   # Give each point an ID: c("ID-1", "ID-2", ..., "ID-10")
plot(x, y, id = id)

new_y &lt;- 10:1
plot(x, new_y, id = id, transition = TRUE)  # Use transition
off()
detach(device)
}
</pre>
</div>


<hr>
<a id="method-animate-off"></a>



<h4>Method <code>off()</code></h4>

<p>Switch off the device; this function closes the WebSocket connection.
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$off()</pre></div>


<hr>
<a id="method-animate-send"></a>



<h4>Method <code>send()</code></h4>

<p>Send commands to device
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$send(message)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>message</code></dt><dd><p>The message to send to the device.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-set_max_stacksize"></a>



<h4>Method <code>set_max_stacksize()</code></h4>

<p>Set the maximum size of the stack
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$set_max_stacksize(n)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>n</code></dt><dd><p>The number of commands the plot stack can hold. Use
-1 for unlimited number of commands.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-svg"></a>



<h4>Method <code>svg()</code></h4>

<p>Initialise a SVG element
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$svg(width = 800, height = 600, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>width</code></dt><dd><p>Width of the canvas in pixels.</p>
</dd>
<dt><code>height</code></dt><dd><p>Height of the canvas in pixels.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional parameters. Some commonly used parameters are <code>id</code>
and <code>root</code>. <code>id</code> assigns an id to the SVG element for future reference;
<code>root</code> specifies the DOM element to insert the SVG element into.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-bars"></a>



<h4>Method <code>bars()</code></h4>

<p>Add bars to a plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$bars(x, y, w, h, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>The x coordinates of the bars.</p>
</dd>
<dt><code>y</code></dt><dd><p>The y coordinates of the bars.</p>
</dd>
<dt><code>w</code></dt><dd><p>The width of the bars.</p>
</dd>
<dt><code>h</code></dt><dd><p>The height of the bars.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-objects"></a>



<h4>Method <code>objects()</code></h4>

<p>Add HTML objects to a plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$objects(x, y, w, h, content, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>The x coordinates of the objects.</p>
</dd>
<dt><code>y</code></dt><dd><p>The y coordinates of the objects.</p>
</dd>
<dt><code>w</code></dt><dd><p>The width of the objects.</p>
</dd>
<dt><code>h</code></dt><dd><p>The height of the objects.</p>
</dd>
<dt><code>content</code></dt><dd><p>The content of the objects; the HTML string.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-plot"></a>



<h4>Method <code>plot()</code></h4>

<p>Generic X-Y plotting
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$plot(x, y, type = "p", ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>The x coordinates of the data.</p>
</dd>
<dt><code>y</code></dt><dd><p>The y coordinates of the data.</p>
</dd>
<dt><code>type</code></dt><dd><p>Type of the plot; one of 'p' and 'l'.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-points"></a>



<h4>Method <code>points()</code></h4>

<p>Add points to a plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$points(x, y, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>The x coordinates of the points.</p>
</dd>
<dt><code>y</code></dt><dd><p>The y coordinates of the points.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Options for the &quot;pch&quot; parameter: &quot;circle&quot;, &quot;plus&quot;, &quot;diamond&quot;, &quot;square&quot;,
&quot;star&quot;, &quot;triangle&quot;, &quot;wye&quot;, &quot;triangle_down&quot;, &quot;triangle_left&quot;, &quot;triangle_right&quot;,
&quot;diamond_alt&quot;, &quot;diamond_square&quot;, &quot;pentagon&quot;, &quot;hexagon&quot;, &quot;hexagon_alt&quot;,
&quot;octagon&quot;, &quot;octagon_alt&quot;, &quot;cross&quot;.
</p>
<p>The unit of the &quot;cex&quot; parameter is squared pixels, corresponding to how
much pixel space the symbol would cover. The convention comes from the
'D3' library, and the choice is (believed) to make plots visually consistent
across the different symbols.
</p>


<hr>
<a id="method-animate-lines"></a>



<h4>Method <code>lines()</code></h4>

<p>Add line segments / paths to a plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$lines(x, y, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>The x coordinates of the line.</p>
</dd>
<dt><code>y</code></dt><dd><p>The y coordinates of the line.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-abline"></a>



<h4>Method <code>abline()</code></h4>

<p>Add straight lines to a plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$abline(a, b, h, v, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>a</code></dt><dd><p>The intercept.</p>
</dd>
<dt><code>b</code></dt><dd><p>The slope.</p>
</dd>
<dt><code>h</code></dt><dd><p>The y-value(s) for horizontal line(s).</p>
</dd>
<dt><code>v</code></dt><dd><p>The x-value(s) for vertical line(s).</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-axis"></a>



<h4>Method <code>axis()</code></h4>

<p>Add an axis to a plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$axis(x, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>The x coordinates of the text.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
<dt><code>y</code></dt><dd><p>The y coordinates of the text.</p>
</dd>
<dt><code>labels</code></dt><dd><p>The text.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-text"></a>



<h4>Method <code>text()</code></h4>

<p>Add text to a plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$text(x, y, labels, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>The x coordinates of the text.</p>
</dd>
<dt><code>y</code></dt><dd><p>The y coordinates of the text.</p>
</dd>
<dt><code>labels</code></dt><dd><p>The text.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-image"></a>



<h4>Method <code>image()</code></h4>

<p>Add background image to a plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$image(href, width, height, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>href</code></dt><dd><p>The link to the image.</p>
</dd>
<dt><code>width</code></dt><dd><p>The width of the image.</p>
</dd>
<dt><code>height</code></dt><dd><p>Th height of the image.</p>
</dd>
<dt><code>...</code></dt><dd><p>Additional graphical parameters.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-event"></a>



<h4>Method <code>event()</code></h4>

<p>Attach an interactive event to an element
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$event(selector, event_type, callback)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>selector</code></dt><dd><p>A character string; a CSS selector.</p>
</dd>
<dt><code>event_type</code></dt><dd><p>A character string; the event type. For example, &quot;click&quot;, &quot;mouseover&quot;,
&quot;mouseout&quot;. See more options at <a href="https://www.w3schools.com/jsref/dom_obj_event.asp">https://www.w3schools.com/jsref/dom_obj_event.asp</a>.</p>
</dd>
<dt><code>callback</code></dt><dd><p>A function, to be called when the event is triggered.
The function should take an argument to receive the data from the
browser end.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-chain"></a>



<h4>Method <code>chain()</code></h4>

<p>Chain a transition after another.
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$chain(callback)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>callback</code></dt><dd><p>A function, to be called when the event is triggered.
The function should take an argument to receive the data from the
browser end.</p>
</dd>
</dl>

</div>



<h5>Examples</h5>

<div class="r example copy">
<pre>\donttest{
library(animate)
device &lt;- animate$new(600, 600)  # Launch a WebSocket server
attach(device)
par(xlim = c(0, 10), ylim = c(0, 10))
plot(1:10, 1:10, id = 1:10)
points(1:10, sample(10, 10), id = 1:10,
  transition = list(
    duration = 1000,
    on = chain(function(message) {
      print(message)
      points(1:10, sample(10, 10), id = 1:10, bg = "green",
             transition = list(duration = 2000))
      })
  ))
par(xlim = NULL, ylim = NULL)  # Reset `xlim` and `ylim` in `par`
off()
detach(device)
}
</pre>
</div>


<hr>
<a id="method-animate-simple_event"></a>



<h4>Method <code>simple_event()</code></h4>

<p>Attach a captured event to an element
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$simple_event(selector, event_type, method, param)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>selector</code></dt><dd><p>A character string; a CSS selector.</p>
</dd>
<dt><code>event_type</code></dt><dd><p>A character string; the event type. For example, &quot;click&quot;, &quot;mouseover&quot;,
&quot;mouseout&quot;. See more options at <a href="https://www.w3schools.com/jsref/dom_obj_event.asp">https://www.w3schools.com/jsref/dom_obj_event.asp</a>.</p>
</dd>
<dt><code>method</code></dt><dd><p>A character string; the name of a device function (e.g. &quot;points&quot;).</p>
</dd>
<dt><code>param</code></dt><dd><p>A named list of arguments to be called with.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-set"></a>



<h4>Method <code>set()</code></h4>

<p>Set the active device to a SVG element
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$set(device_id)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>device_id</code></dt><dd><p>A character vector; ID of the device.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-par"></a>



<h4>Method <code>par()</code></h4>

<p>Set the graphical parameters
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$par(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>The graphical parameters</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-remove"></a>



<h4>Method <code>remove()</code></h4>

<p>Remove elements from the active SVG element
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$remove(id = NULL, selector = "*")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>id</code></dt><dd><p>A character vector; the ID of the elements.</p>
</dd>
<dt><code>selector</code></dt><dd><p>A character vector; a CSS selector.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-clear"></a>



<h4>Method <code>clear()</code></h4>

<p>Remove all elements from the active SVG element
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$clear()</pre></div>


<hr>
<a id="method-animate-delete"></a>



<h4>Method <code>delete()</code></h4>

<p>Remove a SVG element
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$delete(id = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>id</code></dt><dd><p>A character string; the ID of the SVG. If not provided, remove
the active SVG element.
#' @description
#' Perform a group of graphical operations to a plot
#' @param ... Any number of graphical operations.
group = function(...) 
self$send(Message(&quot;fn_group&quot;, c(...)))
,</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-import"></a>



<h4>Method <code>import()</code></h4>

<p>Import an animated plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$import(setting)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>setting</code></dt><dd><p>A JSON file exported from previous runs.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-export"></a>



<h4>Method <code>export()</code></h4>

<p>Export an animated plot
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$export(path = "./animate.json", handler = "browser")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt><dd><p>A character string; the file path to export to.</p>
</dd>
<dt><code>handler</code></dt><dd><p>'r' or 'browser'; the program to handle the export operation.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-record"></a>



<h4>Method <code>record()</code></h4>

<p>Record an animated plot as a MP4 video
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$record()</pre></div>



<h5>Details</h5>

<p>This function will prompt you to select a screen / window / tab to
record. Once started, the recording can be stopped by using the stop button
at the notification box, or clicking anywhere on the page near the device.
Always confirm that the screen recording notification box is gone.
The captured video will be downloaded right after the recording stops.
</p>
<p>This uses web browsers' Media Streams API to record the screen
and return the captured frames as a video. The entire process runs locally.
The source file that provides this functionality can be found at
<code>system.file("addons/screen_record.js", package = "animate")</code>.
</p>
<p>This function is disabled for 'Shiny' app and R Markdown document.
</p>
<p>This function does not work in the RStudio viewer. Please use the
&quot;show in new window&quot; button to launch the page with a web browser.
</p>
<p>See browser compatibility at: <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API#browser_compatibility">https://developer.mozilla.org/en-US/docs/Web/API/MediaStream_Recording_API#browser_compatibility</a>
</p>
<p>See Media Streams API reference at: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API">https://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API</a>
</p>


<hr>
<a id="method-animate-observeAnimateEvent"></a>



<h4>Method <code>observeAnimateEvent()</code></h4>

<p>Event handler
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$observeAnimateEvent(input)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>input</code></dt><dd><p>The input object in the <code>server</code> function of a 'Shiny' app.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-animate-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>animate$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>Note</h3>

<p>This function differs from the <code>event</code> function in that events
registered through <code>simple_event</code> do not require R at deployment to work.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## ------------------------------------------------
## Method `animate$new`
## ------------------------------------------------


library(animate)
device &lt;- animate$new(400, 400)  # Launch a WebSocket server
attach(device)
x &lt;- 1:10
y &lt;- 1:10
id &lt;- new_id(x)   # Give each point an ID: c("ID-1", "ID-2", ..., "ID-10")
plot(x, y, id = id)

new_y &lt;- 10:1
plot(x, new_y, id = id, transition = TRUE)  # Use transition
off()
detach(device)


## ------------------------------------------------
## Method `animate$chain`
## ------------------------------------------------


library(animate)
device &lt;- animate$new(600, 600)  # Launch a WebSocket server
attach(device)
par(xlim = c(0, 10), ylim = c(0, 10))
plot(1:10, 1:10, id = 1:10)
points(1:10, sample(10, 10), id = 1:10,
  transition = list(
    duration = 1000,
    on = chain(function(message) {
      print(message)
      points(1:10, sample(10, 10), id = 1:10, bg = "green",
             transition = list(duration = 2000))
      })
  ))
par(xlim = NULL, ylim = NULL)  # Reset `xlim` and `ylim` in `par`
off()
detach(device)

</code></pre>

<hr>
<h2 id='animateDependencies'>The HTML dependency of an 'animate' plot</h2><span id='topic+animateDependencies'></span>

<h3>Description</h3>

<p>The HTML dependency of an 'animate' plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>animateDependencies()
</code></pre>

<hr>
<h2 id='animateOutput'>Create an animate output (container) element</h2><span id='topic+animateOutput'></span>

<h3>Description</h3>

<p>Create an animate output (container) element
</p>


<h3>Usage</h3>

<pre><code class='language-R'>animateOutput(
  outputId = "animateOutput",
  width = "100%",
  height = "400px",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="animateOutput_+3A_outputid">outputId</code></td>
<td>
<p>output variable to read the plot/image from.</p>
</td></tr>
<tr><td><code id="animateOutput_+3A_width">width</code></td>
<td>
<p>Width of the plot area. Must be a valid CSS unit (like &quot;100%&quot;, &quot;400px&quot;, &quot;auto&quot;).</p>
</td></tr>
<tr><td><code id="animateOutput_+3A_height">height</code></td>
<td>
<p>Height of the plot area. Must be a valid CSS unit (like &quot;100%&quot;, &quot;400px&quot;, &quot;auto&quot;).</p>
</td></tr>
<tr><td><code id="animateOutput_+3A_...">...</code></td>
<td>
<p>Optional CSS styling for the container of the plot.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>(Advanced usage) A &quot;stack_limit&quot; parameter can be included in the optional parameters
to control how many directives the device should keep track of.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using 'animate' in a 'Shiny' app
library(shiny)

ui &lt;- fluidPage(
  actionButton("buttonPlot", "Plot"),
  actionButton("buttonPoints", "Points"),
  actionButton("buttonLines", "Lines"),
  animateOutput()
)

server &lt;- function(input, output, session) {
  device &lt;- animate$new(600, 400, session = session)
  id &lt;- new_id(1:10)

  observeEvent(input$buttonPlot, {     # Example 1
    device$plot(1:10, 1:10, id = id)
  })

  observeEvent(input$buttonPoints, {   # Example 2
    device$points(1:10, runif(10, 1, 10), id = id, transition = TRUE)
  })

  observeEvent(input$buttonLines, {    # Example 3
    x &lt;- seq(1, 10, 0.1)
    y &lt;- sin(x)
    id &lt;- "line_1"
    device$lines(x, y, id = id)
    for (n in 11:100) {
      x &lt;- seq(1, n, 0.1)
      y &lt;- sin(x)
      device$lines(x, y, id = id)
      Sys.sleep(0.05)
    }
  })
}

# shinyApp(ui = ui, server = server)  # Launch the 'Shiny' app

</code></pre>

<hr>
<h2 id='click_to_loop'>Click an element to play all frames</h2><span id='topic+click_to_loop'></span>

<h3>Description</h3>

<p>Playback option for the functions <a href="#topic+rmd_animate">rmd_animate</a>
and <a href="#topic+insert_animate">insert_animate</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>click_to_loop(selector = "#SVG_1", start = 2, wait = 20)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="click_to_loop_+3A_selector">selector</code></td>
<td>
<p>The ID of the DOM element.</p>
</td></tr>
<tr><td><code id="click_to_loop_+3A_start">start</code></td>
<td>
<p>An integer; the number of frames to execute upon the beginning
of the visualisation. This is useful when one wants to start with some set-up
instead of an empty canvas.</p>
</td></tr>
<tr><td><code id="click_to_loop_+3A_wait">wait</code></td>
<td>
<p>A number; the number of milliseconds to wait for before the
next frame is drawn.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
input &lt;- tempfile(fileext = ".Rmd")
output &lt;- tempfile(fileext = ".html")
writeLines('
```{r, echo = FALSE, message = FALSE}
# Run / include the following in a code chunk of an R Markdown document
library(animate)
insert_animate(system.file("tests/Lorenz_system.json.gz", package = "animate"),
               options = click_to_loop())
```
', input)
knitr::knit(input, output)
# browseURL(output)


</code></pre>

<hr>
<h2 id='click_to_play'>Click an element to play a frame</h2><span id='topic+click_to_play'></span>

<h3>Description</h3>

<p>Playback option for the functions <a href="#topic+rmd_animate">rmd_animate</a>
and <a href="#topic+insert_animate">insert_animate</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>click_to_play(selector = "#SVG_1", start = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="click_to_play_+3A_selector">selector</code></td>
<td>
<p>The ID of the DOM element.</p>
</td></tr>
<tr><td><code id="click_to_play_+3A_start">start</code></td>
<td>
<p>An integer; the number of frames to execute upon the beginning
of the visualisation. This is useful when one wants to start with some set-up
instead of an empty canvas.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
input &lt;- tempfile(fileext = ".Rmd")
output &lt;- tempfile(fileext = ".html")
writeLines('
```{r, echo = FALSE, message = FALSE}
# Run / include the following in a code chunk of an R Markdown document
library(animate)
insert_animate(system.file("tests/basic_points.json", package = "animate"),
               options = click_to_play())
```
', input)
knitr::knit(input, output)
# browseURL(output)


</code></pre>

<hr>
<h2 id='ffmpeg'>Launch the 'FFmpeg'-based video editor ('Shiny' app)</h2><span id='topic+ffmpeg'></span>

<h3>Description</h3>

<p>Launch the 'FFmpeg'-based video editor ('Shiny' app)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffmpeg()
</code></pre>


<h3>Note</h3>

<p>This requires <code>ffmpeg</code> to work. The 'ffmpeg' binary can be downloaded from
<a href="https://ffmpeg.org/download.html">https://ffmpeg.org/download.html</a>.
</p>

<hr>
<h2 id='ffmpeg_command'>'FFmpeg' command builder</h2><span id='topic+ffmpeg_command'></span>

<h3>Description</h3>

<p>'FFmpeg' command builder
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffmpeg_command(input, output, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ffmpeg_command_+3A_input">input</code></td>
<td>
<p>A character string; the path to the input video file.</p>
</td></tr>
<tr><td><code id="ffmpeg_command_+3A_output">output</code></td>
<td>
<p>A character string; the path to the output video file.</p>
</td></tr>
<tr><td><code id="ffmpeg_command_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the <code>ffmpeg</code> command-line interface.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string; the 'FFmpeg' command.
</p>

<hr>
<h2 id='ffmpeg_shiny'>'FFmpeg'-based video editor ('Shiny' app)</h2><span id='topic+ffmpeg_shiny'></span>

<h3>Description</h3>

<p>'FFmpeg'-based video editor ('Shiny' app)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffmpeg_shiny()
</code></pre>

<hr>
<h2 id='insert_animate'>Insert an animated plot into an R Markdown document</h2><span id='topic+insert_animate'></span>

<h3>Description</h3>

<p>Insert an animated plot into an R Markdown document
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_animate(file, options = click_to_play(), style, use_cdn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insert_animate_+3A_file">file</code></td>
<td>
<p>The exported plot.</p>
</td></tr>
<tr><td><code id="insert_animate_+3A_options">options</code></td>
<td>
<p>A character string; the JavaScript to customise the playback options.
Two basic options <code>click_to_play()</code> and <code>click_to_loop()</code> have been implemented
for general usage.</p>
</td></tr>
<tr><td><code id="insert_animate_+3A_style">style</code></td>
<td>
<p>Optional style for the iframe that hosts the visualisation.</p>
</td></tr>
<tr><td><code id="insert_animate_+3A_use_cdn">use_cdn</code></td>
<td>
<p>TRUE / FALSE; if TRUE, serve the assets from a CDN, otherwise
embed the assets into the HTML.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
input &lt;- tempfile(fileext = ".Rmd")
output &lt;- tempfile(fileext = ".html")
writeLines('
```{r, echo = FALSE, message = FALSE}
# Run / include the following in a code chunk of an R Markdown document
library(animate)
insert_animate(system.file("tests/Lorenz_system.json.gz", package = "animate"),
               options = click_to_loop())
```
', input)
knitr::knit(input, output)
# browseURL(output)


</code></pre>

<hr>
<h2 id='loop'>Loop through the available frames n times</h2><span id='topic+loop'></span>

<h3>Description</h3>

<p>Playback option for the functions <a href="#topic+rmd_animate">rmd_animate</a>
and <a href="#topic+insert_animate">insert_animate</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loop(times = 1, wait = 20)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loop_+3A_times">times</code></td>
<td>
<p>An integer; the number of times to loop.</p>
</td></tr>
<tr><td><code id="loop_+3A_wait">wait</code></td>
<td>
<p>A number; the number of milliseconds to wait for before the
next frame is drawn.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
input &lt;- tempfile(fileext = ".Rmd")
output &lt;- tempfile(fileext = ".html")
writeLines('
```{r, echo = FALSE, message = FALSE}
# Run / include the following in a code chunk of an R Markdown document
library(animate)
insert_animate(system.file("tests/Lorenz_system.json.gz", package = "animate"),
               options = loop(times = 2, wait = 15))
```
', input)
knitr::knit(input, output)
# browseURL(output)


</code></pre>

<hr>
<h2 id='new_id'>A utility function for generating IDs</h2><span id='topic+new_id'></span>

<h3>Description</h3>

<p>A utility function for generating IDs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_id(x, prefix = "ID", sep = "-")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_id_+3A_x">x</code></td>
<td>
<p>The data that require IDs.</p>
</td></tr>
<tr><td><code id="new_id_+3A_prefix">prefix</code></td>
<td>
<p>A character string; the prefix to be added to each ID.</p>
</td></tr>
<tr><td><code id="new_id_+3A_sep">sep</code></td>
<td>
<p>A character string; the separator to be added between the prefix
and an ID.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>new_id(x = runif(10), prefix = "points")

</code></pre>

<hr>
<h2 id='rmd_animate'>In-line rendering of an animated plot in an R Markdown document</h2><span id='topic+rmd_animate'></span>

<h3>Description</h3>

<p>In-line rendering of an animated plot in an R Markdown document
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmd_animate(device, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmd_animate_+3A_device">device</code></td>
<td>
<p>The <a href="#topic+animate">animate</a> object.</p>
</td></tr>
<tr><td><code id="rmd_animate_+3A_...">...</code></td>
<td>
<p>Optional parameters to pass to <a href="#topic+insert_animate">insert_animate</a>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function should only be used in a code chunk of an R Markdown document.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
input &lt;- tempfile(fileext = ".Rmd")
output &lt;- tempfile(fileext = ".html")
writeLines('
```{r, echo = FALSE, message = FALSE}
# Run / include the following in a code chunk of an R Markdown document
library(animate)
device &lt;- animate$new(500, 500, virtual = TRUE)  # set `virtual = TRUE` for R Markdown document
attach(device)

# Data
id &lt;- new_id(1:10)
s &lt;- 1:10 * 2 * pi / 10
s2 &lt;- sample(s)

# Plot
par(xlim = c(-2.5, 2.5), ylim = c(-2.5, 2.5))
plot(2*sin(s), 2*cos(s), id = id)
points(sin(s2), cos(s2), id = id, transition = list(duration = 2000))

# Render in-line in an R Markdown document
rmd_animate(device, click_to_play(start = 3))  # begin the plot at the third frame
```
```{r, echo = FALSE, message = FALSE}
par(xlim = NULL, ylim = NULL)  # Reset `xlim` and `ylim` in `par`
# Do some other plots
off()
detach(device)
```
', input)
knitr::knit(input, output)
# browseURL(output)


</code></pre>

<hr>
<h2 id='websocket'>Start a Websocket server</h2><span id='topic+websocket'></span>

<h3>Description</h3>

<p>A thin wrapper of the <code>httpuv</code> package, modified to serve animated
plots.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>app</code></dt><dd><p>A list of functions that define the application.</p>
</dd>
<dt><code>server</code></dt><dd><p>A server handle to be used by 'stopServer'.</p>
</dd>
<dt><code>ws</code></dt><dd><p>A WebSocket channel to handle the communication between
the R session and the browser session.</p>
</dd>
<dt><code>in_handler</code></dt><dd><p>A function to handle instructions sent by the
browser session.</p>
</dd>
<dt><code>port</code></dt><dd><p>An integer; the TCP port number.</p>
</dd>
<dt><code>connected</code></dt><dd><p>TRUE or FALSE; whether a connection has been established.
One should start the WebSocket server before launching the web page that
connects to the server.</p>
</dd>
<dt><code>started</code></dt><dd><p>TRUE or FALSE; whether a server has been started. Use
the <code>startServer</code> method to start a server.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-websocket-startServer"><code>websocket$startServer()</code></a>
</p>
</li>
<li> <p><a href="#method-websocket-stopServer"><code>websocket$stopServer()</code></a>
</p>
</li>
<li> <p><a href="#method-websocket-listServers"><code>websocket$listServers()</code></a>
</p>
</li>
<li> <p><a href="#method-websocket-stopAllServers"><code>websocket$stopAllServers()</code></a>
</p>
</li>
<li> <p><a href="#method-websocket-new"><code>websocket$new()</code></a>
</p>
</li>
<li> <p><a href="#method-websocket-clone"><code>websocket$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-websocket-startServer"></a>



<h4>Method <code>startServer()</code></h4>

<p>Start a WebSocket server
</p>


<h5>Usage</h5>

<div class="r"><pre>websocket$startServer()</pre></div>


<hr>
<a id="method-websocket-stopServer"></a>



<h4>Method <code>stopServer()</code></h4>

<p>Stop a WebSocket server
</p>


<h5>Usage</h5>

<div class="r"><pre>websocket$stopServer()</pre></div>


<hr>
<a id="method-websocket-listServers"></a>



<h4>Method <code>listServers()</code></h4>

<p>List all running WebSocket servers
</p>


<h5>Usage</h5>

<div class="r"><pre>websocket$listServers()</pre></div>


<hr>
<a id="method-websocket-stopAllServers"></a>



<h4>Method <code>stopAllServers()</code></h4>

<p>Stop all running WebSocket servers
</p>


<h5>Usage</h5>

<div class="r"><pre>websocket$stopAllServers()</pre></div>


<hr>
<a id="method-websocket-new"></a>



<h4>Method <code>new()</code></h4>

<p>Initialise a WebSocket connection
</p>


<h5>Usage</h5>

<div class="r"><pre>websocket$new(in_handler, port = 9454)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>in_handler</code></dt><dd><p>A function to handle incoming message, default to
be <a href="base.html#topic+print">print</a> which only displays the message without
any processing.</p>
</dd>
<dt><code>port</code></dt><dd><p>An integer; the TCP port number.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A 'websocket' object.
</p>


<hr>
<a id="method-websocket-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>websocket$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>



</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
