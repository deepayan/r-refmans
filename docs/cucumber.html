<!DOCTYPE html><html lang="en"><head><title>Help for package cucumber</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cucumber}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#define_parameter_type'><p>Define extra parameters to use in Cucumber steps.</p></a></li>
<li><a href='#hook'><p>Hooks</p></a></li>
<li><a href='#opts'><p>cucumber Options</p></a></li>
<li><a href='#step'><p>Define a step</p></a></li>
<li><a href='#test'><p>Run all Cucumber tests</p></a></li>
<li><a href='#validate_feature'><p>Validate lines read from a feature file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Behavior-Driven Development for R</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Write executable specifications in a natural language that describes how your code should behave.
    Write specifications in feature files using 'Gherkin' language and execute them using functions implemented in R.
    Use them as an extension to your 'testthat' tests to provide a high level description of how your code works.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jakubsob/cucumber">https://github.com/jakubsob/cucumber</a>,
<a href="https://jakubsob.github.io/cucumber/">https://jakubsob.github.io/cucumber/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jakubsob/cucumber/issues">https://github.com/jakubsob/cucumber/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, cli, dplyr, fs, glue, purrr, rlang, stringr,
testthat (&ge; 3.0.0), tibble, withr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mockery, box, shinytest2, chromote, covr, knitr, rmarkdown,
quarto, R6, pkgdown</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>quarto</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-24 18:21:50 UTC; jakub</td>
</tr>
<tr>
<td>Author:</td>
<td>Jakub Sobolewski [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jakub Sobolewski &lt;jakupsob@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-24 18:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='define_parameter_type'>Define extra parameters to use in Cucumber steps.</h2><span id='topic+define_parameter_type'></span>

<h3>Description</h3>

<p>The following parameter types are available by default:</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Type</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>{int}</code> </td><td style="text-align: left;"> Matches integers, for example <code>71</code> or <code>-19</code>. Converts value with <code>as.integer</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>{float}</code> </td><td style="text-align: left;"> Matches floats, for example <code>3.6</code>, <code>.8</code> or <code>-9.2</code>. Converts value with <code>as.double</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>{word}</code> </td><td style="text-align: left;"> Matches words without whitespace, for example <code>banana</code> (but not <code style="white-space: pre;">&#8288;banana split&#8288;</code>). </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>{string}</code> </td><td style="text-align: left;"> Matches single-quoted or double-quoted strings, for example <code>"banana split"</code> or <code>'banana split'</code> (but not <code style="white-space: pre;">&#8288;banana split&#8288;</code>). Only the text between the quotes will be extracted. The quotes themselves are discarded. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>To use custom parameter types, call <code>define_parameter_type</code> before <code>cucumber::test</code> is called.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_parameter_type(name, regexp, transformer)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="define_parameter_type_+3A_name">name</code></td>
<td>
<p>The name of the parameter.</p>
</td></tr>
<tr><td><code id="define_parameter_type_+3A_regexp">regexp</code></td>
<td>
<p>A regular expression that the parameter will match on. Note that if you want to escape a special character,
you need to use four backslashes.</p>
</td></tr>
<tr><td><code id="define_parameter_type_+3A_transformer">transformer</code></td>
<td>
<p>A function that will transform the parameter from a string to the desired type.
Must be a function that requires only a single argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>parameter</code>, invisibly. Function should be called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>define_parameter_type("color", "red|blue|green", as.character)
define_parameter_type(
  name = "sci_number",
  regexp = "[+-]?\\\\d*\\\\.?\\\\d+(e[+-]?\\\\d+)?",
  transform = as.double
)

## Not run: 
#' tests/testthat/test-cucumber.R
cucumber::define_parameter_type("color", "red|blue|green", as.character)
cucumber::test(".", "./steps")

## End(Not run)

</code></pre>

<hr>
<h2 id='hook'>Hooks</h2><span id='topic+hook'></span><span id='topic+before'></span><span id='topic+after'></span>

<h3>Description</h3>

<p>Hooks are functions that are run before or after a scenario.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>before(hook)

after(hook)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hook_+3A_hook">hook</code></td>
<td>
<p>A function that will be run. The function first argument is context and the scenario name is the second argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>You can define them alongside steps definitions.
</p>
<p>If you want to run a hook only before or after a specific scenario, use it's name to execute hook only for this scenario.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
before(function(context, scenario_name) {
  context$session &lt;- selenider::selenider_session()
})

after(function(context, scenario_name) {
  selenider::close_session(context$session)
})

after(function(context, scenario_name) {
  if (scenario_name == "Playing one round of the game") {
    context$game$close()
  }
})

## End(Not run)
</code></pre>

<hr>
<h2 id='opts'>cucumber Options</h2><span id='topic+opts'></span>

<h3>Description</h3>

<p>Internally used, package-specific options.
They allow overriding the default behavior of the package.
</p>


<h3>Details</h3>

<p>The following options are available:
</p>

<ul>
<li> <p><code>cucumber.indent</code>
</p>
<p>Regular expression for the indent of the feature files.
</p>
<p>default: <code style="white-space: pre;">&#8288;^\\s{2}&#8288;</code>
</p>
</li>
<li> <p><code>cucumber.interactive</code>
</p>
<p>Logical value indicating whether to ask which feature files to run.
</p>
<p>default: <code>FALSE</code>
</p>
</li></ul>

<p>See <code><a href="base.html#topic+options">base::options()</a></code> and <code><a href="base.html#topic+options">base::getOption()</a></code> on how to work with options.
</p>

<hr>
<h2 id='step'>Define a step</h2><span id='topic+step'></span><span id='topic+given'></span><span id='topic+when'></span><span id='topic+then'></span>

<h3>Description</h3>

<p>Provide a description that matches steps in feature files and the implementation function that will be run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>given(description, implementation)

when(description, implementation)

then(description, implementation)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step_+3A_description">description</code></td>
<td>
<p>A description of the step.
</p>
<p>Cucumber executes each step in a scenario one at a time, in the sequence you’ve written them in.
When Cucumber tries to execute a step, it looks for a matching step definition to execute.
</p>
<p><strong>Keywords are not taken into account when looking for a step definition.</strong>
This means you cannot have a <code>Given</code>, <code>When</code>, <code>Then</code>, <code>And</code> or <code>But</code> step with the same text as another step.
</p>
<p>Cucumber considers the following steps duplicates:
</p>
<div class="sourceCode"><pre>Given there is money in my account
Then there is money in my account
</pre></div>
<p>This might seem like a limitation, but it forces you to come up with a less ambiguous, more clear domain language:
</p>
<div class="sourceCode"><pre>Given my account has a balance of £430
Then my account should have a balance of £430
</pre></div>
<p>To pass arguments, description can contain placeholders in curly braces.
</p>
<p>To match:
</p>
<div class="sourceCode"><pre>Given my account has a balance of £430
</pre></div>
<p>use:
</p>
<div class="sourceCode"><pre>given("my account has a balance of £{float}", function(balance, context) {

})
</pre></div>
<p>If no step definition is found an error will be thrown.
</p>
<p>If multiple steps definitions for a single step are found an error will be thrown.</p>
</td></tr>
<tr><td><code id="step_+3A_implementation">implementation</code></td>
<td>
<p>A function that will be run during test execution.
</p>
<p>The implementation function must always have the last parameter named <code>context</code>.
It holds the environment where test state can be stored to be passed to the next step.
</p>
<p>If a step has a description <code>"I have {int} cucumbers in my basket"</code> then the implementation
function should be <code style="white-space: pre;">&#8288;function(n, context)&#8288;</code>. The <code>{int}</code> value will be passed to
<code>n</code>, this parameter can have any name.
</p>
<p>If a table or a docstring is defined for a step, it will be passed as an argument after plceholder parameters
and before <code>context</code>. The function should be a <code style="white-space: pre;">&#8288;function(n, table, context)&#8288;</code>.
See
<a href="https://github.com/jakubsob/cucumber/blob/main/inst/examples/table/tests/testthat/steps/steps.R">an example</a>
on how to write implementation that uses tables or docstrings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Placeholders in expressions are replaced with regular expressions that match values in the feature file.
Regular expressions are generated during runtime based on defined parameter types.
</p>
<p>The expression <code>"I have {int} cucumbers in my basket"</code> will be converted to
<code>"I have [+-]?(?&lt;![.])[:digit:]+(?![.]) cucumbers in my basket"</code>. The extracted value of <code>{int}</code>
will be passed to the implementation function after being transformed with <code>as.integer</code>.
</p>
<p>To define your own parameter types use <code><a href="#topic+define_parameter_type">define_parameter_type</a></code>.
</p>


<h3>Value</h3>

<p>A function of class <code>step</code>, invisibly. Function should be called for side effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+define_parameter_type">define_parameter_type()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>given("I have {int} cucumbers in my basket", function(n_cucumbers, context) {
  context$n_cucumbers &lt;- n_cucumbers
})

given("I have {int} cucumbers in my basket and a table", function(n_cucumbers, table, context) {
  context$n_cucumbers &lt;- n_cucumbers
  context$table &lt;- table
})

when("I eat {int} cucumbers", function(n_cucumbers, context) {
  context$n_cucumbers &lt;- context$n_cucumbers - n_cucumbers
})

then("I should have {int} cucumbers in my basket", function(n_cucumbers, context) {
  expect_equal(context$n_cucumbers, n_cucumbers)
})

</code></pre>

<hr>
<h2 id='test'>Run all Cucumber tests</h2><span id='topic+test'></span>

<h3>Description</h3>

<p>This command runs all Cucumber tests. It takes all .feature files
from the <code>features_dir</code> and runs them using the steps from the <code>steps_dir</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test(
  features_dir,
  steps_dir,
  steps_loader = .default_steps_loader,
  test_interactive = getOption("cucumber.interactive", default = FALSE)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_+3A_features_dir">features_dir</code></td>
<td>
<p>A character string of the directory containing the feature files.</p>
</td></tr>
<tr><td><code id="test_+3A_steps_dir">steps_dir</code></td>
<td>
<p>A character string of the directory containing the step files.</p>
</td></tr>
<tr><td><code id="test_+3A_steps_loader">steps_loader</code></td>
<td>
<p>A function that loads the steps implementations. By default it sources all files
from the <code>steps_dir</code> using the built-in mechanism. You can provide your own function to load
the steps. The function should take one argument, which will be the <code>steps_dir</code>.
</p>
<p><strong>For packages</strong>: set to NULL to use default support-code load mechanism and place your steps
definitions in <code>setup</code> or <code>helper</code> files. Read more about those files in
<a href="https://testthat.r-lib.org/articles/special-files.html">testthat documentation</a>.</p>
</td></tr>
<tr><td><code id="test_+3A_test_interactive">test_interactive</code></td>
<td>
<p>A logical value indicating whether to ask which feature files to run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None, function called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#' testthat/acceptance/test-cucumber.R
cucumber::test(".", ".", steps_loader = NULL)
# Steps are stored in `testthat/acceptance/setup-steps.R` file.

## End(Not run)

</code></pre>

<hr>
<h2 id='validate_feature'>Validate lines read from a feature file</h2><span id='topic+validate_feature'></span>

<h3>Description</h3>

<p>Validate lines read from a feature file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_feature(lines)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
