<!DOCTYPE html><html lang="en"><head><title>Help for package sundialr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sundialr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cvode'><p>cvode</p></a></li>
<li><a href='#cvodes'><p>cvodes</p></a></li>
<li><a href='#cvsolve'><p>cvsolve</p></a></li>
<li><a href='#ida'><p>ida</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An Interface to 'SUNDIALS' Ordinary Differential Equation (ODE)
Solvers</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Satyaprakash Nayak &lt;satyaprakash.nayak@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/sn248/sundialr">https://github.com/sn248/sundialr</a>,
<a href="http://sn248.github.io/sundialr/">http://sn248.github.io/sundialr/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sn248/sundialr/issues">https://github.com/sn248/sundialr/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a way to call the functions in 'SUNDIALS' C ODE solving library (<a href="https://computing.llnl.gov/projects/sundials">https://computing.llnl.gov/projects/sundials</a>). Currently the serial version of ODE solver, 'CVODE', sensitivity calculator 'CVODES' and differential algebraic solver 'IDA' from the 'SUNDIALS' library are implemented. The package requires ODE to be written as an 'R' or 'Rcpp' function and does not require the 'SUNDIALS' library to be installed on the local machine.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>Copyright:</td>
<td>file COPYRIGHTS</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.12)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>cmake</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-14 04:10:46 UTC; quantilogy</td>
</tr>
<tr>
<td>Author:</td>
<td>Satyaprakash Nayak
    <a href="https://orcid.org/0000-0001-7225-1317"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Lawrence Livermore National Security [cph],
  Southern Methodist University [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-14 04:30:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='cvode'>cvode</h2><span id='topic+cvode'></span>

<h3>Description</h3>

<p>CVODE solver to solve stiff ODEs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvode(
  time_vector,
  IC,
  input_function,
  Parameters,
  reltolerance = 1e-04,
  abstolerance = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvode_+3A_time_vector">time_vector</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="cvode_+3A_ic">IC</code></td>
<td>
<p>Initial Conditions</p>
</td></tr>
<tr><td><code id="cvode_+3A_input_function">input_function</code></td>
<td>
<p>Right Hand Side function of ODEs</p>
</td></tr>
<tr><td><code id="cvode_+3A_parameters">Parameters</code></td>
<td>
<p>Parameters input to ODEs</p>
</td></tr>
<tr><td><code id="cvode_+3A_reltolerance">reltolerance</code></td>
<td>
<p>Relative Tolerance (a scalar, default value  = 1e-04)</p>
</td></tr>
<tr><td><code id="cvode_+3A_abstolerance">abstolerance</code></td>
<td>
<p>Absolute Tolerance (a scalar or vector with length equal to ydot (dy/dx), default = 1e-04)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame. First column is the time-vector, the other columns are values of y in order they are provided.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of solving a set of ODEs with cvode function
# ODEs described by an R function
ODE_R &lt;- function(t, y, p){

  # vector containing the right hand side gradients
  ydot = vector(mode = "numeric", length = length(y))

  # R indices start from 1
  ydot[1] = -p[1]*y[1] + p[2]*y[2]*y[3]
  ydot[2] = p[1]*y[1] - p[2]*y[2]*y[3] - p[3]*y[2]*y[2]
  ydot[3] = p[3]*y[2]*y[2]

  # ydot[1] = -0.04 * y[1] + 10000 * y[2] * y[3]
  # ydot[3] = 30000000 * y[2] * y[2]
  # ydot[2] = -ydot[1] - ydot[3]

  ydot

}

# ODEs can also be described using Rcpp
Rcpp::sourceCpp(code = '

                #include &lt;Rcpp.h&gt;
                using namespace Rcpp;

                // ODE functions defined using Rcpp
                // [[Rcpp::export]]
                NumericVector ODE_Rcpp (double t, NumericVector y, NumericVector p){

                // Initialize ydot filled with zeros
                NumericVector ydot(y.length());

                ydot[0] = -p[0]*y[0] + p[1]*y[1]*y[2];
                ydot[1] = p[0]*y[0] - p[1]*y[1]*y[2] - p[2]*y[1]*y[1];
                ydot[2] = p[2]*y[1]*y[1];

                return ydot;

                }')



# R code to genrate time vector, IC and solve the equations
time_vec &lt;- c(0.0, 0.4, 4.0, 40.0, 4E2, 4E3, 4E4, 4E5, 4E6, 4E7, 4E8, 4E9, 4E10)
IC &lt;- c(1,0,0)
params &lt;- c(0.04, 10000, 30000000)
reltol &lt;- 1e-04
abstol &lt;- c(1e-8,1e-14,1e-6)

## Solving the ODEs using cvode function
df1 &lt;- cvode(time_vec, IC, ODE_R , params, reltol, abstol)           ## using R
df2 &lt;- cvode(time_vec, IC, ODE_Rcpp , params, reltol, abstol)        ## using Rcpp

## Check that both solutions are identical
# identical(df1, df2)
</code></pre>

<hr>
<h2 id='cvodes'>cvodes</h2><span id='topic+cvodes'></span>

<h3>Description</h3>

<p>CVODES solver to solve ODEs and calculate sensitivities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvodes(
  time_vector,
  IC,
  input_function,
  Parameters,
  reltolerance = 1e-04,
  abstolerance = 1e-04,
  SensType = "STG",
  ErrCon = "F"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvodes_+3A_time_vector">time_vector</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="cvodes_+3A_ic">IC</code></td>
<td>
<p>Initial Conditions</p>
</td></tr>
<tr><td><code id="cvodes_+3A_input_function">input_function</code></td>
<td>
<p>Right Hand Side function of ODEs</p>
</td></tr>
<tr><td><code id="cvodes_+3A_parameters">Parameters</code></td>
<td>
<p>Parameters input to ODEs</p>
</td></tr>
<tr><td><code id="cvodes_+3A_reltolerance">reltolerance</code></td>
<td>
<p>Relative Tolerance (a scalar, default value  = 1e-04)</p>
</td></tr>
<tr><td><code id="cvodes_+3A_abstolerance">abstolerance</code></td>
<td>
<p>Absolute Tolerance (a scalar or vector with length equal to ydot, default = 1e-04)</p>
</td></tr>
<tr><td><code id="cvodes_+3A_senstype">SensType</code></td>
<td>
<p>Sensitivity Type - allowed values are &quot;STG&quot; (for Staggered, default) or &quot;SIM&quot; (for Simultaneous)</p>
</td></tr>
<tr><td><code id="cvodes_+3A_errcon">ErrCon</code></td>
<td>
<p>Error Control - allowed values are TRUE or FALSE (default)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame. First column is the time-vector, the next y * p columns are sensitivities of y1 w.r.t all parameters, then y2 w.r.t all parameters etc. y is the state vector, p is the parameter vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of solving a set sensitivity equations for ODEs with cvodes function
# ODEs described by an R function
ODE_R &lt;- function(t, y, p){

  # vector containing the right hand side gradients
  ydot = vector(mode = "numeric", length = length(y))

  # R indices start from 1
  ydot[1] = -p[1]*y[1] + p[2]*y[2]*y[3]
  ydot[2] = p[1]*y[1] - p[2]*y[2]*y[3] - p[3]*y[2]*y[2]
  ydot[3] = p[3]*y[2]*y[2]

  # ydot[1] = -0.04 * y[1] + 10000 * y[2] * y[3]
  # ydot[3] = 30000000 * y[2] * y[2]
  # ydot[2] = -ydot[1] - ydot[3]

  ydot

}

# ODEs can also be described using Rcpp
Rcpp::sourceCpp(code = '

                #include &lt;Rcpp.h&gt;
                using namespace Rcpp;

                // ODE functions defined using Rcpp
                // [[Rcpp::export]]
                NumericVector ODE_Rcpp (double t, NumericVector y, NumericVector p){

                // Initialize ydot filled with zeros
                NumericVector ydot(y.length());

                ydot[0] = -p[0]*y[0] + p[1]*y[1]*y[2];
                ydot[1] = p[0]*y[0] - p[1]*y[1]*y[2] - p[2]*y[1]*y[1];
                ydot[2] = p[2]*y[1]*y[1];

                return ydot;

                }')



# R code to genrate time vector, IC and solve the equations
time_vec &lt;- c(0.0, 0.4, 4.0, 40.0, 4E2, 4E3, 4E4, 4E5, 4E6, 4E7, 4E8, 4E9, 4E10)
IC &lt;- c(1,0,0)
params &lt;- c(0.04, 10000, 30000000)
reltol &lt;- 1e-04
abstol &lt;- c(1e-8,1e-14,1e-6)

## Solving the ODEs and Sensitivities using cvodes function
df1 &lt;- cvodes(time_vec, IC, ODE_R , params, reltol, abstol,"STG",FALSE)           ## using R
df2 &lt;- cvodes(time_vec, IC, ODE_Rcpp , params, reltol, abstol,"STG",FALSE)        ## using Rcpp

## Check that both solutions are identical
# identical(df1, df2)
</code></pre>

<hr>
<h2 id='cvsolve'>cvsolve</h2><span id='topic+cvsolve'></span>

<h3>Description</h3>

<p>CVSOLVE solver to solve stiff ODEs with discontinuties
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvsolve(
  time_vector,
  IC,
  input_function,
  Parameters,
  Events = NULL,
  reltolerance = 1e-04,
  abstolerance = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvsolve_+3A_time_vector">time_vector</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="cvsolve_+3A_ic">IC</code></td>
<td>
<p>Initial Conditions</p>
</td></tr>
<tr><td><code id="cvsolve_+3A_input_function">input_function</code></td>
<td>
<p>Right Hand Side function of ODEs</p>
</td></tr>
<tr><td><code id="cvsolve_+3A_parameters">Parameters</code></td>
<td>
<p>Parameters input to ODEs</p>
</td></tr>
<tr><td><code id="cvsolve_+3A_events">Events</code></td>
<td>
<p>Discontinuities in the solution (a DataFrame, default value is NULL)</p>
</td></tr>
<tr><td><code id="cvsolve_+3A_reltolerance">reltolerance</code></td>
<td>
<p>Relative Tolerance (a scalar, default value  = 1e-04)</p>
</td></tr>
<tr><td><code id="cvsolve_+3A_abstolerance">abstolerance</code></td>
<td>
<p>Absolute Tolerance (a scalar or vector with length equal to ydot, default = 1e-04)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame. First column is the time-vector, the other columns are values of y in order they are provided.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of solving a set of ODEs with multiple discontinuities using cvsolve
# A simple One dimensional equation, y = -0.1 * y
# ODEs described by an R function
ODE_R &lt;- function(t, y, p){

  # vector containing the right hand side gradients
  ydot = vector(mode = "numeric", length = length(y))

  # R indices start from 1
  ydot[1] = -p[1]*y[1]

  ydot

}

# R code to generate time vector, IC and solve the equations
TSAMP &lt;- seq(from = 0, to = 100, by = 0.1)      # sampling time points
IC &lt;- c(1)
params &lt;- c(0.1)

# A dataset describing the dosing at times at which additions to y[1] are to be done
# Names of the columns don't matter, but they MUST be in the order of state index,
# times and Values at discontinuity.
TDOSE &lt;- data.frame(ID = 1, TIMES = c(0, 10, 20, 30, 40, 50), VAL = 100)
df1 &lt;- cvsolve(TSAMP, c(1), ODE_R, params)         # solving without any discontinuity
df2 &lt;- cvsolve(TSAMP, c(1), ODE_R, params, TDOSE)  # solving with discontinuity
</code></pre>

<hr>
<h2 id='ida'>ida</h2><span id='topic+ida'></span>

<h3>Description</h3>

<p>IDA solver to solve stiff DAEs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ida(
  time_vector,
  IC,
  IRes,
  input_function,
  Parameters,
  reltolerance = 1e-04,
  abstolerance = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ida_+3A_time_vector">time_vector</code></td>
<td>
<p>time vector</p>
</td></tr>
<tr><td><code id="ida_+3A_ic">IC</code></td>
<td>
<p>Initial Value of y</p>
</td></tr>
<tr><td><code id="ida_+3A_ires">IRes</code></td>
<td>
<p>Inital Value of ydot</p>
</td></tr>
<tr><td><code id="ida_+3A_input_function">input_function</code></td>
<td>
<p>Right Hand Side function of DAEs</p>
</td></tr>
<tr><td><code id="ida_+3A_parameters">Parameters</code></td>
<td>
<p>Parameters input to ODEs</p>
</td></tr>
<tr><td><code id="ida_+3A_reltolerance">reltolerance</code></td>
<td>
<p>Relative Tolerance (a scalar, default value  = 1e-04)</p>
</td></tr>
<tr><td><code id="ida_+3A_abstolerance">abstolerance</code></td>
<td>
<p>Absolute Tolerance (a scalar or vector with length equal to ydot, default = 1e-04)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame. First column is the time-vector, the other columns are values of y in order they are provided.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
