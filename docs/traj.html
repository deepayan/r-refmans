<!DOCTYPE html><html><head><title>Help for package traj</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {traj}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#traj-package'><p>traj: Clustering of Functional Data Based on Measures of Change</p></a></li>
<li><a href='#plot.trajClusters'><p>Plots <code>trajClusters</code> objects</p></a></li>
<li><a href='#Step1Measures'><p>Compute Measures for Identifying Patterns of Change in Longitudinal</p>
Data</a></li>
<li><a href='#Step2Selection'><p>Select a Subset of the Measures Using Factor Analysis</p></a></li>
<li><a href='#Step3Clusters'><p>Classify the Longitudinal Data Based on the Selected Measures.</p></a></li>
<li><a href='#trajdata'><p>trajdata</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Clustering of Functional Data Based on Measures of Change</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a three-step procedure in the spirit of Leffondre et al. (2004) to identify clusters of individual longitudinal trajectories. The procedure involves (1) computing a number of "measures of change" capturing various features of the trajectories; (2) using a Principal Component Analysis based dimension reduction algorithm to select a subset of measures and (3) using the k-means clustering algorithm to identify clusters of trajectories.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=traj">https://CRAN.R-project.org/package=traj</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, cluster, psych</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-04 19:39:51 UTC; Moi</td>
</tr>
<tr>
<td>Author:</td>
<td>Marie-Pierre Sylvestre [aut],
  Laurence Boulanger [aut, cre],
  Gillis Delmas Tchouangue Dinkou [ctb],
  Dan Vatnik [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Laurence Boulanger &lt;laurence.boulanger@umontreal.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-04 22:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='traj-package'>traj: Clustering of Functional Data Based on Measures of Change</h2><span id='topic+traj'></span><span id='topic+traj-package'></span>

<h3>Description</h3>

<p>Implements a three-step procedure in the spirit of Leffondre et al. (2004) to identify clusters of individual longitudinal trajectories. The procedure involves (1) computing a number of &quot;measures of change&quot; capturing various features of the trajectories; (2) using a Principal Component Analysis based dimension reduction algorithm to select a subset of measures and (3) using the k-means clustering algorithm to identify clusters of trajectories.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Laurence Boulanger <a href="mailto:laurence.boulanger@umontreal.ca">laurence.boulanger@umontreal.ca</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Marie-Pierre Sylvestre <a href="mailto:marie-pierre.sylvestre@umontreal.ca">marie-pierre.sylvestre@umontreal.ca</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Gillis Delmas Tchouangue Dinkou [contributor]
</p>
</li>
<li><p> Dan Vatnik [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://CRAN.R-project.org/package=traj">https://CRAN.R-project.org/package=traj</a>
</p>
</li></ul>


<hr>
<h2 id='plot.trajClusters'>Plots <code>trajClusters</code> objects</h2><span id='topic+plot.trajClusters'></span>

<h3>Description</h3>

<p>Up to 5 kinds of plots are currently available: a plot of the
cluster-specific median and mean trajectories, a random sample of
trajectories from each cluster and scatter plots of the measures on which
the clustering was based. When the GAP criterion was used in
<code>Step3Clusters</code> to determine the optimal number of clusters, a plot of
the GAP statistic as a function of the number of clusters is provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'trajClusters'
plot(x, sample.size = 5, ask = TRUE, which.plots = NULL, spline = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.trajClusters_+3A_x">x</code></td>
<td>
<p>object of class <code>trajClusters</code> as returned by
<code>Step3Cluster</code>.</p>
</td></tr>
<tr><td><code id="plot.trajClusters_+3A_sample.size">sample.size</code></td>
<td>
<p>the number of random trajectories to be randomly sampled
from each cluster. Defaults to <code>5</code>.</p>
</td></tr>
<tr><td><code id="plot.trajClusters_+3A_ask">ask</code></td>
<td>
<p>logical. If <code>TRUE</code>, the user is asked before each plot. Defaults to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.trajClusters_+3A_which.plots">which.plots</code></td>
<td>
<p>either <code>NULL</code> or a vector of integers. If <code>NULL</code>, every
available plot is displayed. If a vector is supplied, only the corresponding
plots will be displayed.</p>
</td></tr>
<tr><td><code id="plot.trajClusters_+3A_spline">spline</code></td>
<td>
<p>logical. If <code>TRUE</code>, each trajectory will be smoothed using
smoothing splines and the median and mean trajectories will be plotted from
the smoothed trajectories. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="plot.trajClusters_+3A_...">...</code></td>
<td>
<p>other parameters to be passed through to plotting functions.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+Step3Clusters">Step3Clusters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("trajdata")
trajdata.noGrp &lt;- trajdata[, -which(colnames(trajdata) == "Group")] #remove the Group column

m = Step1Measures(trajdata.noGrp, ID = TRUE)
s = Step2Selection(m)
c3 = Step3Clusters(s, nclusters = 3)

plot(c3)

#The pointwise mean trajectories correspond to the third and fourth displayed plots.

c4 = Step3Clusters(s, nclusters = 4)

plot(c4, which.plots = 3:4)


## End(Not run)


</code></pre>

<hr>
<h2 id='Step1Measures'>Compute Measures for Identifying Patterns of Change in Longitudinal
Data</h2><span id='topic+Step1Measures'></span><span id='topic+print.trajMeasures'></span><span id='topic+summary.trajMeasures'></span>

<h3>Description</h3>

<p><code>Step1Measures</code> computes up to 18 measures for each
longitudinal trajectory. See Details for the list of measures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Step1Measures(
  Data,
  Time = NULL,
  ID = FALSE,
  measures = c(1:17),
  midpoint = NULL,
  cap.outliers = FALSE
)

## S3 method for class 'trajMeasures'
print(x, ...)

## S3 method for class 'trajMeasures'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Step1Measures_+3A_data">Data</code></td>
<td>
<p>a matrix or data frame in which each row contains the longitudinal
data (trajectories).</p>
</td></tr>
<tr><td><code id="Step1Measures_+3A_time">Time</code></td>
<td>
<p>either <code>NULL</code>, a vector or a matrix/data frame of the same dimension
as <code>Data</code>. If a vector, matrix or data frame is supplied, its entries
are assumed to be measured at the times of the corresponding cells in
<code>Data</code>. When set to <code>NULL</code> (the default), the times are assumed
equidistant.</p>
</td></tr>
<tr><td><code id="Step1Measures_+3A_id">ID</code></td>
<td>
<p>logical. Set to <code>TRUE</code> if the first columns of <code>Data</code> and
<code>Time</code> corresponds to an <code>ID</code> variable identifying the
trajectories. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Step1Measures_+3A_measures">measures</code></td>
<td>
<p>a vector containing the numerical identifiers of the measures
to compute. The default, 1:17, corresponds to
measures 1-17 and thus excludes the measures which require specifying a
midpoint.</p>
</td></tr>
<tr><td><code id="Step1Measures_+3A_midpoint">midpoint</code></td>
<td>
<p>specifies which column of <code>Time</code> to use as the midpoint
in measure 18. Can be <code>NULL</code>, an integer or a vector of integers of length
the number of rows in <code>Time</code>. The default is <code>NULL</code>, in which case the
midpoint is the time closest to the median of the Time vector specific to
each trajectory.</p>
</td></tr>
<tr><td><code id="Step1Measures_+3A_cap.outliers">cap.outliers</code></td>
<td>
<p>logical. If <code>TRUE</code>, extreme values of the measures will be capped. If <code>FALSE</code>, only the infinite values will be capped. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Step1Measures_+3A_x">x</code></td>
<td>
<p>object of class <code>trajMeasures</code>.</p>
</td></tr>
<tr><td><code id="Step1Measures_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="Step1Measures_+3A_object">object</code></td>
<td>
<p>object of class <code>trajMeasures</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each trajectory must have a minimum of 3 observations otherwise it
will be omitted from the analysis.
</p>
<p>The 18 measures and their numerical identifiers are listed below. Please
refer to the vignette for the specific formulas used to compute them.
</p>

<ol>
<li><p>  Maximum<br />
</p>
</li>
<li><p>  Range (max - min)<br />
</p>
</li>
<li><p>  Mean value<br />
</p>
</li>
<li><p>  Standard deviation<br />
</p>
</li>
<li><p>  Slope of the linear model<br />
</p>
</li>
<li>  <p><code class="reqn">R^2</code>: Proportion of variance explained by the linear model<br />
</p>
</li>
<li><p>  Curve length (total variation)<br />
</p>
</li>
<li><p>  Rate of intersection with the mean<br />
</p>
</li>
<li><p>  Proportion of time spent above the mean<br />
</p>
</li>
<li><p>  Minimum  of the first derivative<br />
</p>
</li>
<li><p>  Maximum of the first derivative<br />
</p>
</li>
<li><p>  Mean of the first derivative<br />
</p>
</li>
<li><p>  Standard deviation of the first derivative<br />
</p>
</li>
<li><p>  Minimum  of the second derivative<br />
</p>
</li>
<li><p>  Maximum of the second derivative<br />
</p>
</li>
<li><p>  Mean of the second derivative<br />
</p>
</li>
<li><p>  Standard deviation of the second derivative<br />
</p>
</li>
<li><p>  Later change/Early change<br />
</p>
</li></ol>

<p>If 'cap.outliers' is set to <code>TRUE</code>, or if some measures are infinite as a result of division by 0, Nishiyama's improved Chebychev bound for continuous distributions
is used to determine extreme values for each measure, corresponding to
a 0.3% probability threshold. Extreme values beyond the threshold are then capped
to the 0.3% probability threshold (see vignette for more details). If applicable, the values which
would be of the form 0/0 are set to 1.
</p>


<h3>Value</h3>

<p>An object of class <code>trajMeasures</code>; a list containing the values
of the measures, a table of the outliers which have been capped, as well as
a curated form of the function's arguments.
</p>


<h3>References</h3>

<p>Leffondre K, Abrahamowicz M, Regeasse A, Hawker GA, Badley EM,
McCusker J, Belzile E. Statistical measures were proposed for identifying
longitudinal patterns of change in quantitative health indicators. J Clin
Epidemiol. 2004 Oct;57(10):1049-62. doi: 10.1016/j.jclinepi.2004.02.012.
PMID: 15528056.
</p>
<p>Nishiyama T, Improved Chebyshev inequality: new probability bounds with
known supremum of PDF, arXiv:1808.10770v2 stat.ME
https://doi.org/10.48550/arXiv.1808.10770
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("trajdata")
trajdata.noGrp &lt;- trajdata[, -which(colnames(trajdata) == "Group")] #remove the Group column

m1 = Step1Measures(trajdata.noGrp, ID = TRUE, measures = 18, midpoint = NULL)
m2 = Step1Measures(trajdata.noGrp, ID = TRUE, measures = 18, midpoint = 3)

identical(m1$measures, m2$measures)

## End(Not run)

</code></pre>

<hr>
<h2 id='Step2Selection'>Select a Subset of the Measures Using Factor Analysis</h2><span id='topic+Step2Selection'></span><span id='topic+print.trajSelection'></span><span id='topic+summary.trajSelection'></span>

<h3>Description</h3>

<p>This function applies the following dimension reduction algorithm
to the measures computed by <code><a href="#topic+Step1Measures">Step1Measures</a></code>:
</p>

<ol>
<li><p> Drop the measures whose values are constant across the trajectories;
</p>
</li>
<li><p> Whenever two measures are highly correlated (absolute value of Pearson correlation &gt; 0.98), keep the highest-ranking measure on the list (see <code><a href="#topic+Step1Measures">Step1Measures</a></code>) and drop the other;
</p>
</li>
<li><p> Use principal component analysis (PCA) on the measures to form factors summarizing the variability in the measures;
</p>
</li>
<li><p> Drop the factors whose variance is smaller than any one of the standardized measures;
</p>
</li>
<li><p> Perform a varimax rotation on the remaining factors;
</p>
</li>
<li><p> For each rotated factor, select the measure that has the highest correlation (aka factor loading) with it and that hasn't yet been selected;
</p>
</li>
<li><p> Drop the remaining measures.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>Step2Selection(trajMeasures, num.select = NULL, discard = NULL, select = NULL)

## S3 method for class 'trajSelection'
print(x, ...)

## S3 method for class 'trajSelection'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Step2Selection_+3A_trajmeasures">trajMeasures</code></td>
<td>
<p>object of class <code>trajMeasures</code> as returned by
<code><a href="#topic+Step1Measures">Step1Measures</a></code>.</p>
</td></tr>
<tr><td><code id="Step2Selection_+3A_num.select">num.select</code></td>
<td>
<p>an optional positive integer indicating the number of
factors to keep in the second stage of the algorithm. Defaults to <code>NULL</code> so
that all factors with variance greater than any one of the normalized
measures are selected.</p>
</td></tr>
<tr><td><code id="Step2Selection_+3A_discard">discard</code></td>
<td>
<p>an optional vector of positive integers corresponding to the
measures to be dropped from the analysis. See
<code><a href="#topic+Step1Measures">Step1Measures</a></code> for the list of measures. Defaults to
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="Step2Selection_+3A_select">select</code></td>
<td>
<p>an optional vector of positive integers corresponding to the
measures to forcefully select. Defaults to <code>NULL</code>. If a vector is supplied,
the five-steps selection algorithm described above is bypassed and the
corresponding measures are selected instead.</p>
</td></tr>
<tr><td><code id="Step2Selection_+3A_x">x</code></td>
<td>
<p>object of class <code>trajSelection</code>.</p>
</td></tr>
<tr><td><code id="Step2Selection_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="Step2Selection_+3A_object">object</code></td>
<td>
<p>object of class  <code>trajSelection</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Whenever two measures are highly correlated (Pearson correlation &gt;
0.98), the highest-ranking measure on the list (see <code><a href="#topic+Step1Measures">Step1Measures</a></code>) is kept and the other is discarded and discards the others. PCA is applied on the remaining measures using the <code><a href="psych.html#topic+principal">principal</a></code> function from the <code>psych</code> package.
</p>


<h3>Value</h3>

<p>An object of class <code>trajSelection</code>; a list containing the values
of the selected measures, the output of the principal component analysis as
well as a curated form of the arguments.
</p>


<h3>References</h3>

<p>Leffondre K, Abrahamowicz M, Regeasse A, Hawker GA, Badley EM,
McCusker J, Belzile E. Statistical measures were proposed for identifying
longitudinal patterns of change in quantitative health indicators. J Clin
Epidemiol. 2004 Oct;57(10):1049-62. doi: 10.1016/j.jclinepi.2004.02.012.
PMID: 15528056.
</p>


<h3>See Also</h3>

<p><code><a href="psych.html#topic+principal">principal</a></code> <code><a href="#topic+Step1Measures">Step1Measures</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("trajdata")
trajdata.noGrp &lt;- trajdata[, -which(colnames(trajdata) == "Group")] #remove the Group column

m = Step1Measures(trajdata.noGrp, measure = c(1:18), ID = TRUE)
s = Step2Selection(m)

print(s)

s2 = Step2Selection(m, select = c(13, 3, 12, 9))

## End(Not run)


</code></pre>

<hr>
<h2 id='Step3Clusters'>Classify the Longitudinal Data Based on the Selected Measures.</h2><span id='topic+Step3Clusters'></span><span id='topic+print.trajClusters'></span><span id='topic+summary.trajClusters'></span>

<h3>Description</h3>

<p>Classifies the trajectories by applying the k-means clustering
algorithm to the measures selected by <code>Step2Selection</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Step3Clusters(
  trajSelection,
  algorithm = "k-medoids",
  metric = "euclidean",
  nstart = 200,
  iter.max = 100,
  nclusters = NULL,
  criterion = "Calinski-Harabasz",
  K.max = min(15, nrow(trajSelection$selection) - 1),
  boot = FALSE,
  R = 100,
  B = 500
)

## S3 method for class 'trajClusters'
print(x, ...)

## S3 method for class 'trajClusters'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Step3Clusters_+3A_trajselection">trajSelection</code></td>
<td>
<p>object of class <code>trajSelection</code> as returned by
<code>Step2Selection</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_algorithm">algorithm</code></td>
<td>
<p>either <code>"k-medoids"</code> or <code>"k-means"</code>. Determines the clustering algorithm to use. Defaults to <code>"k-medoids"</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_metric">metric</code></td>
<td>
<p>to be passed to the <code>metric</code> argument of
<code><a href="cluster.html#topic+pam">pam</a></code> if <code>"k-medoids"</code> is the chosen <code>algorithm</code>. Defaults to <code>"euclidean"</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_nstart">nstart</code></td>
<td>
<p>to be passed to the <code>nstart</code> argument of
<code><a href="stats.html#topic+kmeans">kmeans</a></code> if <code>"k-means"</code> is the chosen <code>algorithm</code>. Defaults to <code>200</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_iter.max">iter.max</code></td>
<td>
<p>to be passed to the <code>iter.max</code> argument of
<code><a href="stats.html#topic+kmeans">kmeans</a></code> if <code>"k-means"</code> is the chosen <code>algorithm</code>. Defaults to <code>100</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_nclusters">nclusters</code></td>
<td>
<p>either <code>NULL</code> or the desired number of clusters. If <code>NULL</code>, the
number of clusters is determined using the criterion chosen in <code>criterion</code>. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_criterion">criterion</code></td>
<td>
<p>criterion to determine the optimal number of clusters if <code>nclusters</code> is <code>NULL</code>. Either <code>"GAP"</code> or <code>"Calinski-Harabasz"</code>. Defaults to <code>"Calinski-Harabasz"</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_k.max">K.max</code></td>
<td>
<p>maximum number of clusters to be considered if <code>nclusters</code> is set to <code>NULL</code>. Defaults to <code>15</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_boot">boot</code></td>
<td>
<p>logical. If <code>TRUE</code>, and if <code>"Calinski-Harabasz"</code> is the chosen <code>criterion</code>, the optimal number of clusters will be the first mode of sampling distribution of the optimal number of clusters obtained by bootstrap. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_r">R</code></td>
<td>
<p>the number of bootstrap replicate if <code>boot</code> is set to <code>TRUE</code>. Defaults to <code>100</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_b">B</code></td>
<td>
<p>to be passed to the <code>B</code> argument of
<code><a href="cluster.html#topic+clusGap">clusGap</a></code> if <code>"GAP"</code> is the chosen <code>criterion</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_x">x</code></td>
<td>
<p>object of class <code>trajClusters</code>.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="Step3Clusters_+3A_object">object</code></td>
<td>
<p>object of class <code>trajClusters</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>"GAP"</code> is the chosen <code>criterion</code> for determining the optimal number of clusters, the method described by Tibshirani et al. is implemented by the <code><a href="cluster.html#topic+clusGap">clusGap</a></code> function.
</p>
<p>Instead, if <code>"Calinski-Harabasz"</code> is the chosen <code>criterion</code>, the Calinski-Harabasz index is computed for each possible number of clusters between 2 and <code>K.max</code> and the optimal number of clusters is the maximizer of the Calinski-Harabasz index. Moreover, if <code>boot</code> is set to <code>TRUE</code>, then, following the guidelines suggested by Mesidor et al., a sampling distribution of the optimal number of clusters is obtained by bootstrap and the optimal number of clusters is chosen to be the (first) mode of this sampling distribution.
</p>


<h3>Value</h3>

<p>An object of class <code>trajClusters</code>; a list containing the result
of the clustering, as well as a curated form of the arguments.
</p>


<h3>References</h3>

<p>Miceline Mésidor, Caroline Sirois, Marc Simard, Denis Talbot, A Bootstrap Approach for Evaluating Uncertainty in the Number of Groups Identified by Latent Class Growth Models, American Journal of Epidemiology, Volume 192, Issue 11, November 2023, Pages 1896–1903, https://doi.org/10.1093/aje/kwad148
</p>
<p>Tibshirani, R., Walther, G. and Hastie, T. (2001). Estimating the number of data clusters via the Gap statistic. Journal of the Royal Statistical Society B, 63, 411–423.
</p>
<p>Tibshirani, R., Walther, G. and Hastie, T. (2000). Estimating the number of clusters in a dataset via the Gap statistic. Technical Report. Stanford.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Step2Selection">Step2Selection</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("trajdata")
trajdata.noGrp &lt;- trajdata[, -which(colnames(trajdata) == "Group")] #remove the Group column

m = Step1Measures(trajdata.noGrp, ID = TRUE, measures = 1:18)
s = Step2Selection(m)

s$RC$loadings

s2 = Step2Selection(m, select = c(10, 12, 8, 4))

c3.part &lt;- Step3Clusters(s2, nclusters = 3)$partition
c4.part &lt;- Step3Clusters(s2, nclusters = 4)$partition
c5.part &lt;- Step3Clusters(s2, nclusters = 5)$partition


## End(Not run)

</code></pre>

<hr>
<h2 id='trajdata'>trajdata</h2><span id='topic+trajdata'></span>

<h3>Description</h3>

<p>An artificially created data set with 130 trajectories split into four groups, labelled A, B, C, D according to the data generating process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trajdata
</code></pre>


<h3>Format</h3>

<p>This data frame has 130 rows and the following 7 columns:
</p>

<dl>
<dt>ID</dt><dd><p>An identification variable that runs from 1 to 130.</p>
</dd>
<dt>Group</dt><dd><p>A character variable that's either &quot;A&quot;, &quot;B&quot;, &quot;C&quot; or &quot;D&quot; depending on which of the four data generating process the trajectory is coming from.</p>
</dd>
<dt>X1</dt><dd><p>The observation of the trajectory at time t = 1.</p>
</dd>
<dt>X2</dt><dd><p>The observation of the trajectory at time t = 2.</p>
</dd>
<dt>X3</dt><dd><p>The observation of the trajectory at time t = 3.</p>
</dd>
<dt>X4</dt><dd><p>The observation of the trajectory at time t = 4.</p>
</dd>
<dt>X5</dt><dd><p>The observation of the trajectory at time t = 5.</p>
</dd>
<dt>X6</dt><dd><p>The observation of the trajectory at time t = 6.</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
