<!DOCTYPE html><html><head><title>Help for package pedigreemm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pedigreemm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Dmat'><p>vector of the diagonal for the D matrix from the decomposition A= TDT'</p></a></li>
<li><a href='#editPed'><p>Complete and Order a Pedigree</p></a></li>
<li><a href='#getA'><p>Additive Relationship Matrix</p></a></li>
<li><a href='#getAInv'><p>Inverse of the relationship matrix</p></a></li>
<li><a href='#inbreeding'><p>Inbreeding coefficients from a pedigree...</p></a></li>
<li><a href='#mastitis'><p>Mastitis cases in dairy cattle</p></a></li>
<li><a href='#milk'><p>Milk production</p></a></li>
<li><a href='#pedCows'><p>Pedigree of the cows in milk</p></a></li>
<li><a href='#pedCowsR'><p>Pedigree of the cows in milk with 0.70 of the information in pedCows</p></a></li>
<li><a href='#pedigree'><p>Pedigree Constructor</p></a></li>
<li><a href='#pedigree-class'><p>Class &quot;pedigree&quot;</p></a></li>
<li><a href='#pedigreemm'><p>Fit mixed-effects models incorporating pedigrees</p></a></li>
<li><a href='#pedigreemm-class'><p>Pedigree-based mixed-effects model fits</p></a></li>
<li><a href='#pedSires'><p>Pedigree of the sires from mastitis</p></a></li>
<li><a href='#relfactor'><p>Relationship factor from a pedigree...</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.3-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-22</td>
</tr>
<tr>
<td>Title:</td>
<td>Pedigree-Based Mixed-Effects Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Douglas Bates, Paulino Perez Rodriguez and Ana Ines Vazquez,</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ana Ines Vazquez &lt;avazquez@msu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit pedigree-based mixed-effects models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.0.0), lme4 (&ge; 1.0), Matrix (&ge; 1.0), methods</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/anainesvs/pedigreemm/">https://github.com/anainesvs/pedigreemm/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-24 17:53:03 UTC; anaivazquez</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-24 22:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Dmat'>vector of the diagonal for the D matrix from the decomposition A= TDT'</h2><span id='topic+Dmat'></span>

<h3>Description</h3>

<p>numeric vector that should be the diagonal elements of the diagonal matrix D</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dmat(ped)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Dmat_+3A_ped">ped</code></td>
<td>
<p>an object that inherits from class <a href="#topic+pedigree-class">pedigree</a></p>
</td></tr></table>


<h3>Details</h3>

<p>Determine the diagonal factor in the decomposition of the relationship
matrix from a pedigree equal to TDT'. Where T is unit lower triangular 
and D is a diagonal matrix.
This function returns a numeric vector with the entries of  D
</p>


<h3>Value</h3>

<p>a numeric vector</p>


<h3>Examples</h3>

<pre><code class='language-R'>ped &lt;- pedigree(sire = c(NA,NA,1, 1,4,5),
                dam  = c(NA,NA,2,NA,3,2), label= 1:6)
Dmat(ped)
</code></pre>

<hr>
<h2 id='editPed'>Complete and Order a Pedigree</h2><span id='topic+editPed'></span>

<h3>Description</h3>

<p>This function helps to prepare a pedigree to generate a pedigree object</p>


<h3>Usage</h3>

<pre><code class='language-R'>editPed(sire, dam, label, verbose)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="editPed_+3A_sire">sire</code></td>
<td>
<p>a vector (with some <code>NA</code> entries) with the father IDs</p>
</td></tr>
<tr><td><code id="editPed_+3A_dam">dam</code></td>
<td>
<p>similarly as <code>sire</code> for the &ldquo;mother&rdquo; of each entry. 
The vector must be of the same length than the one for the sire</p>
</td></tr>
<tr><td><code id="editPed_+3A_label">label</code></td>
<td>
<p>a vector with the subjects id. Giving a unique ID for the corresponding 
entry. The length as <code>sire</code> and <code>dam</code> should be the same</p>
</td></tr>
<tr><td><code id="editPed_+3A_verbose">verbose</code></td>
<td>
<p>logical entry inquiring whether to print line that the program is evaluating.
The default is FALSE.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The function takes a vector of sires, another for dams and a final one for subjects
all of the same length, convert them to character. If there are dams or sires not
declared as subjects the function generates them. Finally, it orders the pedigree. 
The output can be used to build a pedigree object <code>ped</code>
</p>


<h3>Value</h3>

<p>A data frame with strings as characters. All subjects are in the label column, 
and all subjects will appear in this column before appering as sires or dams.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  #(1)
  pede&lt;-data.frame(sire=as.character(c(NA,NA,NA,NA,NA,1,3,5,6,4,8,1,10,8)),
             dam= as.character(c(NA,NA,NA,NA,NA,2,2,NA,7,7,NA,9,9,13)),
             label=as.character(1:14))
   #scrambled original pedigree:
   (pede&lt;- pede[sample(replace=FALSE, 1:14),]  )
   (pede&lt;- editPed(sire=pede$sire, dam= pede$dam, label=pede$label)) 
   ped&lt;- with(pede, pedigree(label=label, sire=sire, dam=dam))
#################################################################################################
   #(2) With missing labels
   pede&lt;-data.frame(sire=as.character(c(NA,1,3,5,6,4,8,1,10,8)),
             dam= as.character(c(NA,2,2,NA,7,7,NA,9,9,13)),
             label=as.character(5:14))
   #scrambled original pedigree:
   (pede&lt;- pede[sample(replace=FALSE, 1:10),]  )
   (pede&lt;- editPed(sire=pede$sire, dam= pede$dam, label=pede$label)) 
   ped&lt;- with(pede, pedigree(label=label, sire=sire, dam=dam))

#################################################################################################
   #(2) A larger pedigree
 #Useing pedCows pedigree
# str(pedCows)
# pede&lt;-data.frame(id=pedCows@label, sire=pedCows@sire, dam=pedCows@dam)
# pede&lt;-pede[sample(1:nrow(pede),replace=FALSE),]
# pede&lt;- editPed(sire=pede$sire, dam=pede$dam, label=pede$id)
# ped&lt;- with(pede, pedigree(label=label, sire=sire, dam=dam))
</code></pre>

<hr>
<h2 id='getA'>Additive Relationship Matrix</h2><span id='topic+getA'></span>

<h3>Description</h3>

<p>Additive relationship matrix from a pedigree</p>


<h3>Usage</h3>

<pre><code class='language-R'>getA(ped)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getA_+3A_ped">ped</code></td>
<td>
<p>a pedigree that includes the individuals who occur in <code>labs</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the additive relationship matrix for the pedigree <code>ped</code> .
</p>


<h3>Value</h3>

<p>Sparse matrix</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example from chapter 2 of Mrode (2005)

ped &lt;- pedigree(sire = c(NA,NA,1, 1,4,5),
                dam  = c(NA,NA,2,NA,3,2), label= 1:6)
(getA(ped))
</code></pre>

<hr>
<h2 id='getAInv'>Inverse of the relationship matrix</h2><span id='topic+getAInv'></span>

<h3>Description</h3>

<p>Inverse of the Relationship matrix from a pedigree</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAInv(ped)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getAInv_+3A_ped">ped</code></td>
<td>
<p>a pedigree that includes the individuals who occur in <code>labs</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Determine the inverse of the relationship matrix from a pedigree
<code>ped</code>.
</p>


<h3>Value</h3>

<p>sparse matrix, inverse of the relationship matrix</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example from chapter 2 of Mrode (2005)

ped &lt;- pedigree(sire = c(NA,NA,1, 1,4,5),
                dam  = c(NA,NA,2,NA,3,2), label= 1:6)
getAInv(ped)
</code></pre>

<hr>
<h2 id='inbreeding'>Inbreeding coefficients from a pedigree...</h2><span id='topic+inbreeding'></span>

<h3>Description</h3>

<p>Inbreeding coefficients from a pedigree</p>


<h3>Usage</h3>

<pre><code class='language-R'>inbreeding(ped)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inbreeding_+3A_ped">ped</code></td>
<td>
<p>an object that inherits from class <a href="#topic+pedigree-class">pedigree</a></p>
</td></tr></table>


<h3>Details</h3>

<p>Determine the inbreeding coefficients for all the individuals of a pedigree. 
This function a numeric vector. 
</p>


<h3>Value</h3>

<p>a numeric vector</p>


<h3>Source</h3>

<p>Sargolzaei, M. and H. Iwaisaki, 2005. Comparison of four direct algorithms
for computing the inbreeding coefficients. J. Anim. Sci, 76: 401-406. 
</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ped &lt;- pedigree(sire = c(NA,NA,1, 1,4,5),
                dam  = c(NA,NA,2,NA,3,2), label= 1:6)
inbreeding(ped)
</code></pre>

<hr>
<h2 id='mastitis'>Mastitis cases in dairy cattle</h2><span id='topic+mastitis'></span>

<h3>Description</h3>

<p>Records of the number of cases of clinical mastitis during the first
lactation of 1,675 cows, primarily Holsteins.
Cows belonged to 41 herds and were daughters of 38 sires. 
There were 1,491 healthy cows, 134 had only one case of mastitis, 
36 had 2 cases, and 14 had between 4 and  cases. 
Overall, mastitis incidence was 0.11. 
Calving years for these records were from 2000 through 2005. 
The sire, herd and days in milk are also recorded for each
cow.
</p>


<h3>Format</h3>

<p>A data frame with 1675 observations on the following 8 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Identifier of the animal.</p>
</dd>
<dt><code>sire</code></dt><dd><p>Identifier of the animal's sire.</p>
</dd>
<dt><code>birth</code></dt><dd><p>year of birth of the animal (as a factor).</p>
</dd>
<dt><code>herd</code></dt><dd><p>herd id number (as a factor).</p>
</dd>
<dt><code>calvingYear</code></dt><dd><p>year of calving for this lactation.</p>
</dd>
<dt><code>DIM</code></dt><dd><p>total number of days in milk for the lactation.</p>
</dd>
<dt><code>mastitis</code></dt><dd><p>a factor indicating if the cow had any
incidents of clinical mastitis during the lactation.</p>
</dd>
<dt><code>NCM</code></dt><dd><p>An ordered factor giving the number of clinical
mastitis cases for the cow during this lactation.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The pedigree of the sires is given in the companion
<code><a href="#topic+pedSires">pedSires</a></code> data set.</p>


<h3>Source</h3>

<p>Vazquez, A.I. 2007. Analysis of number of episodes of clinical mastitis
in Norwegian Red and Holstein cows with Poisson and categorical data mixed models. 
Master of Science Thesis. University of Wisconsin - Madison. 162 pp.
</p>
<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pedSires">pedSires</a></code>, <code><a href="#topic+pedigree">pedigree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>str(mastitis)
summary(mastitis, maxsum = 10)
</code></pre>

<hr>
<h2 id='milk'>Milk production</h2><span id='topic+milk'></span>

<h3>Description</h3>

<p>Records of the milk production of 3397 lactations from first through fifty parity Holsteins.
These were 1,359 cows, daughters of 38 sires in 57 herds. 
The data was downloaded from the USDA internet site. 
All lactation records represent cows with at least 100 days in milk, with an average of 347 days. 
Milk yield ranged from 4,065 to 19,345 kg estimated for 305 days, averaging 11,636 kg. 
There were 1,314, 1,006, 640, 334 and 103 records were from first thorough fifth lactation animals. 
</p>


<h3>Format</h3>

<p>A data frame with 3397 observations on the following 9 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>numeric identifier of cow</p>
</dd>
<dt><code>lact</code></dt><dd><p>number of lactation for which production is measured</p>
</dd>
<dt><code>herd</code></dt><dd><p>a factor indicating the herd</p>
</dd>
<dt><code>sire</code></dt><dd><p>a factor indicating the sire</p>
</dd>
<dt><code>dim</code></dt><dd><p>number of days in milk for that lactation</p>
</dd>
<dt><code>milk</code></dt><dd><p>milk production estimated at 305 days</p>
</dd>
<dt><code>fat</code></dt><dd><p>fat production estimated at 305 days</p>
</dd>
<dt><code>prot</code></dt><dd><p>protein production estimated at 305 days</p>
</dd>
<dt><code>scs</code></dt><dd><p>the somatic cell score</p>
</dd>
</dl>



<h3>Source</h3>

<p>USDA web site.
http://www.aipl.arsusda.gov/
</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(milk)
</code></pre>

<hr>
<h2 id='pedCows'>Pedigree of the cows in milk</h2><span id='topic+pedCows'></span>

<h3>Description</h3>

<p>A <code><a href="#topic+pedigree-class">pedigree</a></code> object giving (part of) the pedigree
of the cows in the <code><a href="#topic+milk">milk</a></code> data frame.
</p>


<h3>Format</h3>

<p>The format is:
Formal class 'pedigree' [package &quot;pedigreemm&quot;] with 3 slots
..@ sire : int [1:6547] NA NA NA NA NA NA NA NA NA NA ...
..@ dam  : int [1:6547] NA NA NA NA NA NA NA NA NA NA ...
..@ label: chr [1:6547] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+milk">milk</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>str(pedCows)
</code></pre>

<hr>
<h2 id='pedCowsR'>Pedigree of the cows in milk with 0.70 of the information in pedCows</h2><span id='topic+pedCowsR'></span>

<h3>Description</h3>

<p>A <code><a href="#topic+pedigree-class">pedigree</a></code> object giving (part of) the pedigree
of the cows in the <code><a href="#topic+milk">milk</a></code> data frame.
This pedigree allows the example with 'milk' to run faster. 
</p>


<h3>Format</h3>

<p>The format is:
Formal class 'pedigree' [package &quot;pedigreemm&quot;] with 3 slots
..@ sire : int [1:6547] NA NA NA NA NA NA NA NA NA NA ...
..@ dam  : int [1:6547] NA NA NA NA NA NA NA NA NA NA ...
..@ label: chr [1:6547] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+milk">milk</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>str(pedCowsR)
</code></pre>

<hr>
<h2 id='pedigree'>Pedigree Constructor</h2><span id='topic+pedigree'></span>

<h3>Description</h3>

<p>Construct an object of class <code>"pedigree"</code>, more
conveniently than by <code>new("pedigree", ....)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pedigree(sire, dam, label)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pedigree_+3A_sire">sire</code></td>
<td>
<p>numeric vector (with some <code>NA</code> entries) of integer IDs,
denoting a <em>previous</em> entry in the pedigree corresponding to
the current entry's &ldquo;father&rdquo;.</p>
</td></tr>
<tr><td><code id="pedigree_+3A_dam">dam</code></td>
<td>
<p>similarly as <code>sire</code> for the &ldquo;mother&rdquo; of each entry.</p>
</td></tr>
<tr><td><code id="pedigree_+3A_label">label</code></td>
<td>
<p>a vector coercable to <code>"character"</code> of the same
length as <code>sire</code> and <code>dam</code> giving a unique ID for the
corresponding entry.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of formal class <code>"<a href="#topic+pedigree-class">pedigree</a>"</code>.
</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>See Also</h3>

<p>the <code><a href="#topic+pedigree-class">pedigree</a></code> class.</p>


<h3>Examples</h3>

<pre><code class='language-R'>example("pedigree-class") ## 'p1' pedigree object `the hard way'

ped &lt;- pedigree(sire = c(NA,NA,1, 1,4,5),
                dam  = c(NA,NA,2,NA,3,2), label= 1:6)
## note that 'label' is coerced to character automatically
ped
stopifnot(identical(ped, p1))
</code></pre>

<hr>
<h2 id='pedigree-class'>Class &quot;pedigree&quot;</h2><span id='topic+pedigree-class'></span><span id='topic+pedinbred-class'></span><span id='topic+coerce+2Cpedigree+2CsparseMatrix-method'></span><span id='topic+coerce+2Cpedigree+2Cdata.frame-method'></span><span id='topic+head+2Cpedigree-method'></span><span id='topic+show+2Cpedigree-method'></span><span id='topic+tail+2Cpedigree-method'></span>

<h3>Description</h3>

<p>Objects of class <code>"pedigree"</code> represent a set of
individuals that can have two parents including their parent-child
relations.  The terminology has been taken from cattle breeding.
The <code>"pedinbred"</code> class is an extension of the pedigree class
with an additional slot of the inbreeding coefficients.
</p>


<h3>Objects from the Class</h3>

<p>Objects in the <code>"pedigree"</code> class can be created by calls of the
form <code>new("pedigree", ...)</code>, or more conveniently,
<code><a href="#topic+pedigree">pedigree</a>(sire= ., dam = ., label =.)</code>.
</p>
<p>Objects of the <code>"pedinbred"</code> class are created by coercing a
pedigree to class <code>"pedinbred"</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>sire</code>:</dt><dd><p>integer vector (with some <code>NA</code> entries),
denoting a <em>previous</em> entry in the pedigree corresponding to
the current entry's &ldquo;father&rdquo;.</p>
</dd>
<dt><code>dam</code>:</dt><dd><p>similarly as <code>sire</code> for the &ldquo;mother&rdquo;
of each entry.</p>
</dd>
<dt><code>label</code>:</dt><dd><p>a <code>"character"</code> vector of the same length
as <code>sire</code> and <code>dam</code> giving a unique ID for the
corresponding entry.</p>
</dd>
<dt><code>F</code>:</dt><dd><p>(class <code>"pedinbred"</code> only) a numeric vector of
inbreeding coefficients.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>coerce</dt><dd><p><code>signature(from = "pedigree", to = "sparseMatrix")</code>:
returns a sparse, unit lower-triangular matrix which is the inverse of the
&quot;L&quot; part of the &quot;LDL'&quot; form of the Cholesky factorization of the
relationship matrix.  All non-zero elements below the diagonal
are -0.5.</p>
</dd>
<dt>coerce</dt><dd><p><code>signature(from = "pedigree", to = "data.frame")</code>: ... </p>
</dd>
<dt>head</dt><dd><p><code>signature(x = "pedigree")</code>: ... </p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "pedigree")</code>: ... </p>
</dd>
<dt>tail</dt><dd><p><code>signature(x = "pedigree")</code>: ... </p>
</dd>
</dl>



<h3>References</h3>

<p>R. A. Mrode, <em>Linear Models for the Prediction of Animal Breeding
Values, 2nd ed</em>, CABI Publishing, 2005.
</p>
<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pedigree">pedigree</a></code>, <code><a href="#topic+inbreeding">inbreeding</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Rather use, pedigree()!   The following is "raw code":
## Example from chapter 2 of Mrode (2005)
p1 &lt;- new("pedigree",
          sire = as.integer(c(NA,NA,1, 1,4,5)),
          dam  = as.integer(c(NA,NA,2,NA,3,2)),
          label = as.character(1:6))
p1
(dtc &lt;- as(p1, "sparseMatrix"))   # T-inverse in Mrode's notation
solve(dtc)
inbreeding(p1)
</code></pre>

<hr>
<h2 id='pedigreemm'>Fit mixed-effects models incorporating pedigrees</h2><span id='topic+pedigreemm'></span>

<h3>Description</h3>

<p>Fit linear or generalized linear mixed models incorporating the
effects of a pedigree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pedigreemm(formula, data, family = NULL, REML = TRUE,
           pedigree = list(), control = list(),
           start = NULL, verbose = FALSE, subset, weights,
           na.action, offset, contrasts = NULL, model = TRUE,
           x = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pedigreemm_+3A_pedigree">pedigree</code></td>
<td>
<p>a named list of <code><a href="#topic+pedigree-class">pedigree</a></code> objects.
The names must correspond to the names of grouping factors for
random-effects terms in the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_formula">formula</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_data">data</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_family">family</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+glmer">glmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_reml">REML</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_control">control</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_start">start</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_verbose">verbose</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_subset">subset</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_weights">weights</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_na.action">na.action</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_offset">offset</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_contrasts">contrasts</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_model">model</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_x">x</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
<tr><td><code id="pedigreemm_+3A_...">...</code></td>
<td>
<p>as in <code><a href="lme4.html#topic+lmer">lmer</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>All arguments to this function are the same as those to the function
<code><a href="lme4.html#topic+lmer">lmer</a></code> except <code>pedigree</code> which must be a named list of
<code><a href="#topic+pedigree-class">pedigree</a></code> objects.  Each name (frequently there is
only one) must correspond to the name of a grouping factor in a
random-effects term in the <code>formula</code>.  The observed levels
of that factor must be contained in the pedigree.  For each pedigree
the (left) Cholesky factor of the
relationship matrix restricted to the observed levels is calculated
using <code><a href="#topic+relfactor">relfactor</a></code> and applied to the model matrix for that
term.
</p>


<h3>Value</h3>

<p>a <code><a href="#topic+pedigreemm-class">pedigreemm</a></code> object.
</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel. 
Technical Note: An R package for fitting generalized linear mixed models 
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pedigreemm-class">pedigreemm</a></code>, <code><a href="#topic+pedigree-class">pedigree</a></code>,
<code><a href="#topic+relfactor">relfactor</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  p1 &lt;- new("pedigree",
           sire = as.integer(c(NA,NA,1, 1,4,5)),
           dam  = as.integer(c(NA,NA,2,NA,3,2)),
           label = as.character(1:6))
  A&lt;-getA(p1)
  cholA&lt;-chol(A)  
  varU&lt;-0.4; varE&lt;-0.6; rep&lt;-20
  n&lt;-rep*6
  set.seed(108)
  bStar&lt;- rnorm(6, sd=sqrt(varU))
  b&lt;-crossprod(as.matrix(cholA),bStar)
  ID &lt;- rep(1:6, each=rep)
  e0&lt;-rnorm(n, sd=sqrt(varE))
  y&lt;-b[ID]+e0
  fm1 &lt;- pedigreemm(y ~ (1|ID) , pedigree = list(ID = p1))
  table(y01&lt;-ifelse(y&lt;1.3,0,1))
  fm2 &lt;- pedigreemm(y01 ~ (1|ID) , pedigree = list(ID = p1), family = 'binomial')
</code></pre>

<hr>
<h2 id='pedigreemm-class'>Pedigree-based mixed-effects model fits</h2><span id='topic+pedigreemm-class'></span><span id='topic+fitted+2Cpedigreemm-method'></span><span id='topic+ranef+2Cpedigreemm-method'></span><span id='topic+residuals+2Cpedigreemm-method'></span>

<h3>Description</h3>

<p>A mixed-effects model fit by <code><a href="#topic+pedigreemm">pedigreemm</a></code>.
This class extends class <code>"<a href="lme4.html#topic+merMod-class">merMod</a>"</code> class and includes one
additional slot, <code>relfac</code>, which is a list of (left) Cholesky
factors of the relationship matrices derived from 
<code>"<a href="#topic+pedigree-class">pedigree</a>"</code> objects.</p>


<h3>Objects from the Class</h3>

<p>Objects are created by calls to the
<code><a href="#topic+pedigreemm">pedigreemm</a></code> function.</p>


<h3>Slots</h3>


<dl>
<dt><code>relfac</code>:</dt><dd><p>A list of relationship matrix factors.  All
other slots are inherited from class <code>"<a href="lme4.html#topic+merMod-class">merMod</a>"</code>.</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="lme4.html#topic+merMod-class">merMod</a>"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>fitted</dt><dd><p><code>signature(object = "pedigreemm")</code>: actually a
non-method in that <code>fitted</code> doesn't apply to such objects
because of the pre-whitening.</p>
</dd>
<dt>ranef</dt><dd><p><code>signature(object = "pedigreemm")</code>: incorporates
the pedigree into the random effects as returned for the object
viewed as a <code>"<a href="lme4.html#topic+merMod-class">merMod</a>)"</code> object.</p>
</dd>
<dt>residuals</dt><dd><p><code>signature(object = "pedigreemm")</code>: also a
non-method for the same reason as <code>fitted</code></p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+pedigreemm">pedigreemm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("pedigreemm")
</code></pre>

<hr>
<h2 id='pedSires'>Pedigree of the sires from mastitis</h2><span id='topic+pedSires'></span>

<h3>Description</h3>

<p>A <code><a href="#topic+pedigree-class">pedigree</a></code> object giving (part of) the pedigree
of the sires from the <code><a href="#topic+mastitis">mastitis</a></code> data frame.  The
pedigree is traced back on sires only.
</p>


<h3>Format</h3>

<p>The format is:
Formal class 'pedigree' [package &quot;pedigreemm&quot;] with 3 slots
..@ sire : int [1:352] NA NA NA NA NA NA NA NA NA NA ...
..@ dam  : int [1:352] NA NA NA NA NA NA NA NA NA NA ...
..@ label: chr [1:352] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mastitis">mastitis</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>str(pedSires)
</code></pre>

<hr>
<h2 id='relfactor'>Relationship factor from a pedigree...</h2><span id='topic+relfactor'></span>

<h3>Description</h3>

<p>Relationship factor from a pedigree</p>


<h3>Usage</h3>

<pre><code class='language-R'>relfactor(ped, labs)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relfactor_+3A_ped">ped</code></td>
<td>
<p>a pedigree that includes the individuals who occur in <code>labs</code></p>
</td></tr>
<tr><td><code id="relfactor_+3A_labs">labs</code></td>
<td>
<p>a character vector or a factor giving the labels to
which to restrict the relationship matrix. If <code>labs</code> is a
factor then the levels of the factor are used as the labels.
Default is the complete set of labels in the pedigree.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Determine the right Cholesky factor of the relationship matrix for the
pedigree <code>ped</code>, possibly restricted to the specific labels that
occur in <code>labs</code>.
</p>


<h3>Value</h3>

<p>an upper triangular, sparse (right) Cholesky factor of the relationship matrix</p>


<h3>References</h3>

<p>2010. A.I. Vazquez, D.M. Bates, G.J.M. Rosa, D. Gianola and K.A. Weigel.
Technical Note: An R package for fitting generalized linear mixed models
in animal breeding. Journal of Animal Science, 88:497-504.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example from chapter 2 of Mrode (2005)

ped &lt;- pedigree(sire = c(NA,NA,1, 1,4,5),
                dam  = c(NA,NA,2,NA,3,2), label= 1:6)
(fac &lt;- relfactor(ped))
crossprod(fac)    # the relationship matrix
getA(ped)         # the relationship matrix 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
