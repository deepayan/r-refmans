<!DOCTYPE html><html lang="en"><head><title>Help for package bayesanova</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bayesanova}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayesanova-package'>
<p>Bayesian ANOVA</p></a></li>
<li><a href='#anovaplot'>
<p>anovaplot</p></a></li>
<li><a href='#assumption.check'>
<p>assumption.check</p></a></li>
<li><a href='#bayes.anova'>
<p>bayes.anova</p></a></li>
<li><a href='#post.pred.check'>
<p>post.pred.check</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Inference in the Analysis of Variance via Markov Chain
Monte Carlo in Gaussian Mixture Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Riko Kelter</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Riko Kelter &lt;riko_k@gmx.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a Bayesian version of the analysis of variance based on a three-component Gaussian mixture for which a Gibbs sampler produces posterior draws. For details about the Bayesian ANOVA based on Gaussian mixtures, see Kelter (2019) &lt;<a href="https://doi.org/10.48550/arXiv.1906.07524">doi:10.48550/arXiv.1906.07524</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MCMCpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>coda, knitr, MASS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-04 14:01:52 UTC; riko</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-04 15:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='bayesanova-package'>
Bayesian ANOVA
</h2><span id='topic+bayesanova-package'></span>

<h3>Description</h3>

<p>Provides a Bayesian version of the analysis of variance (ANOVA) based on a three-component Gaussian mixture, for which a Gibbs sampler produces the posteriors of the means and standard deviation of each component. Also, model assumptions can be checked and results visualised.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
This package was not yet installed at build time.<br />

Index:  This package was not yet installed at build time.<br />
The core function is <code>bayes.anova</code> which provides the Bayesian version of the ANOVA. Also, assumptions can be checked via <code>assumption.check</code>, and <code>anovaplot</code> produces visualizations of the results.
</p>


<h3>Author(s)</h3>

<p>Riko Kelter
</p>
<p>Maintainer: Riko Kelter
</p>


<h3>References</h3>

<p>For details, see: https://arxiv.org/abs/1906.07524v1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
x1=rnorm(75,0,1)
x2=rnorm(75,1,1)
x3=rnorm(75,2,1)
assumption.check(x1,x2,x3,conf.level = 0.95)
result=bayes.anova(n=1000,first=x1,second=x2,third=x3)
anovaplot(result)
</code></pre>

<hr>
<h2 id='anovaplot'>
anovaplot
</h2><span id='topic+anovaplot'></span>

<h3>Description</h3>

<p>Plots the results of a Bayesian ANOVA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anovaplot(dataframe, type="rope", sd="sd", ci=0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anovaplot_+3A_dataframe">dataframe</code></td>
<td>

<p>A dataframe which is the result of a Bayesian ANOVA
</p>
</td></tr>
<tr><td><code id="anovaplot_+3A_type">type</code></td>
<td>

<p>Selects the type of plot which should be produced. The default is <code>"rope"</code>, which produces a posterior region of practical equivalence (ROPE) analysis and posterior distributions for the three effect sizes of interest. Other options are to produce posteriors for each parameter via <code>type=="pars"</code>, or to produce posteriors for the difference of means and variances via <code>type=="diff"</code>.
</p>
</td></tr>
<tr><td><code id="anovaplot_+3A_sd">sd</code></td>
<td>

<p>Selects if the results include posterior draws for the standard deviation (default) or the variance. <code>sd="sd"</code> is the default. <code>sd="var"</code> assumes that the dataframe includes posterior draws of the variances of each group.
</p>
</td></tr>
<tr><td><code id="anovaplot_+3A_ci">ci</code></td>
<td>

<p>The credible level used for producing credible intervals. The default is <code>ci=0.95</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces plots of the results depending on which type is selected. In the default setting, the produced plots include horizontal colored lines which visualize the standard regions of practical equivalence (ROPEs) for the effect size of Cohen. In particular, the ROPE of no effect, <code class="reqn">\delta \in (-0.2,0.2)</code> is shown as a red horizontal line, the ROPE of a small effect, <code class="reqn">|\delta| \in [0.2,0.5)</code> is shown as an orange horizontal line, the ROPE of a medium effect, <code class="reqn">|\delta| \in [0.5,0.8)</code> is shown as an green horizontal line, and the ROPE of a large effect, <code class="reqn">|\delta| \in [0.8,0.\infty)</code> is shown as a purple horizontal line. Corresponding dashed vertical lines show the boundaries between these default ROPEs for effect sizes.
</p>


<h3>Author(s)</h3>

<p>Riko Kelter
</p>


<h3>References</h3>

<p>For details, see: https://arxiv.org/abs/1906.07524v1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
x1=rnorm(75,0,1)
x2=rnorm(75,1,1)
x3=rnorm(75,2,1)
result=bayes.anova(n=1000,first=x1,second=x2,third=x3)

anovaplot(result)
anovaplot(result, type="effect")

x4=rnorm(75,3,1)
result2=bayes.anova(n=1000,first=x1,second=x2,third=x3,fourth=x4)
anovaplot(result2)
</code></pre>

<hr>
<h2 id='assumption.check'>
assumption.check
</h2><span id='topic+assumption.check'></span>

<h3>Description</h3>

<p>This function checks the assumption of normality for each of the groups <code>x1</code>, <code>x2</code>, <code>x3</code> (and optional <code>x4</code>, <code>x5</code> and <code>6</code>) used in the Bayesian ANOVA via Shapiro-Wilk tests with confidence level <code>conf.level</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assumption.check(x1,x2,x3,x4=NULL,x5=NULL,x6=NULL,conf.level=0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assumption.check_+3A_x1">x1</code></td>
<td>

<p>Numerical vector containing the values for the first group
</p>
</td></tr>
<tr><td><code id="assumption.check_+3A_x2">x2</code></td>
<td>

<p>Numerical vector containing the values for the second group
</p>
</td></tr>
<tr><td><code id="assumption.check_+3A_x3">x3</code></td>
<td>

<p>Numerical vector containing the values for the third group
</p>
</td></tr>
<tr><td><code id="assumption.check_+3A_x4">x4</code></td>
<td>

<p>Numerical vector containing the values for the fourth group. Defaults to NULL.
</p>
</td></tr>
<tr><td><code id="assumption.check_+3A_x5">x5</code></td>
<td>

<p>Numerical vector containing the values for the fifth group. Defaults to NULL.
</p>
</td></tr>
<tr><td><code id="assumption.check_+3A_x6">x6</code></td>
<td>

<p>Numerical vector containing the values for the sixth group. Defaults to NULL.
</p>
</td></tr>
<tr><td><code id="assumption.check_+3A_conf.level">conf.level</code></td>
<td>

<p>Confidence level of the Shapiro-Wilk test used. Significance level equals <code>1-conf.level</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a single Shapiro-Wilk test fails, the method returns a warning and recommends to use further diagnostics.
</p>


<h3>Value</h3>

<p>Histograms and Quantile-Quantile plots for all groups are produced, either a warning or a confirmation of normality in all three groups is printed to the console.
</p>


<h3>Author(s)</h3>

<p>Riko Kelter
</p>


<h3>References</h3>

<p>For details, see: https://arxiv.org/abs/1906.07524v1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
x1=rnorm(75,0,1)
x2=rnorm(75,1,1)
x3=rnorm(75,2,1)

assumption.check(x1,x2,x3,conf.level = 0.95)
</code></pre>

<hr>
<h2 id='bayes.anova'>
bayes.anova
</h2><span id='topic+bayes.anova'></span>

<h3>Description</h3>

<p>This function runs a Bayesian analysis of variance (ANOVA) on the data. The Bayesian ANOVA model assumes normally distributed data in all three groups, and conducts inference based on a Gibbs sampler in a three-component Gaussian-mixture with unknown parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes.anova(n=10000,first,second,third,fourth=NULL,fifth=NULL,sixth=NULL,
hyperpars="custom",burnin=n/2,sd="sd",q=0.1,ci=0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayes.anova_+3A_n">n</code></td>
<td>

<p>Number of posterior draws the Gibbs sampler produces. The default is <code>n=10000</code>.
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_first">first</code></td>
<td>

<p>Numerical vector containing the values of the first group
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_second">second</code></td>
<td>

<p>Numerical vector containing the values of the second group
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_third">third</code></td>
<td>

<p>Numerical vector containing the values of the third group
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_fourth">fourth</code></td>
<td>

<p>Numerical vector containing the values of the fourth group. Default value is NULL.
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_fifth">fifth</code></td>
<td>

<p>Numerical vector containing the values of the fifth group. Default value is NULL.
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_sixth">sixth</code></td>
<td>

<p>Numerical vector containing the values of the sixth group. Default value is NULL.
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_hyperpars">hyperpars</code></td>
<td>

<p>Sets the hyperparameters on the prior distributions. Two options are provided. The default is <code>"custom"</code>, and the other is <code>"rafterys"</code>. For details, see the references.
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_burnin">burnin</code></td>
<td>

<p>Burn-in samples for the Gibbs sampler
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_sd">sd</code></td>
<td>

<p>Selects if posterior draws should be produced for the standard deviation (default) or the variance. The two options are <code>"sd"</code> and <code>"var"</code> respectively.
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_q">q</code></td>
<td>

<p>Tuning parameter for the hyperparameters. The default is <code>q=0.1</code> and it is recommended not to change this.
</p>
</td></tr>
<tr><td><code id="bayes.anova_+3A_ci">ci</code></td>
<td>

<p>The credible level for the credible intervals produced. Default is <code>ci=0.95</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Gibbs sampler is run with four Markov chains to run convergence diagnostics.
</p>


<h3>Value</h3>

<p>Returns a dataframe which includes four columns for each parameter of interest. Each column corresponds to the posterior draws of a single Markov chain obtained by the Gibbs sampling algorithm.
</p>


<h3>Author(s)</h3>

<p>Riko Kelter
</p>


<h3>References</h3>

<p>For details, see: https://arxiv.org/abs/1906.07524v1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
x1=rnorm(75,0,1)
x2=rnorm(75,1,1)
x3=rnorm(75,2,1)
x4=rnorm(75,-1,1)
result=bayes.anova(first=x1,second=x2,third=x3)
result=bayes.anova(n=1000,first=x1,second=x2,third=x3,
hyperpars="custom",burnin=750,ci=0.99,sd="sd")
result2=bayes.anova(n=1000,first=x1,second=x2,third=x3,
fourth=x4)
</code></pre>

<hr>
<h2 id='post.pred.check'>
post.pred.check
</h2><span id='topic+post.pred.check'></span>

<h3>Description</h3>

<p>Provides a posterior predictive check for a fitted Bayesian ANOVA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post.pred.check(anovafit, ngroups, out, reps = 50, eta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="post.pred.check_+3A_anovafit">anovafit</code></td>
<td>

<p>A dataframe returned by <code>bayes.anova</code>
</p>
</td></tr>
<tr><td><code id="post.pred.check_+3A_ngroups">ngroups</code></td>
<td>

<p>An integer which is the number of groups used in the ANOVA
</p>
</td></tr>
<tr><td><code id="post.pred.check_+3A_out">out</code></td>
<td>

<p>A numerical vector containing the originally observed data in all groups
</p>
</td></tr>
<tr><td><code id="post.pred.check_+3A_reps">reps</code></td>
<td>

<p>An integer which is the number of posterior predictive distributions sampled from the ANOVA models posterior distribution. Defaults to 50 sampled parameters.
</p>
</td></tr>
<tr><td><code id="post.pred.check_+3A_eta">eta</code></td>
<td>

<p>A numerical vector containing the weight values of the mixture.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides a posterior predictive check for a fitted Bayesian ANOVA model.
</p>


<h3>Value</h3>

<p>Produces a plot consisting of a density estimate of the original data and posterior predictive distributions sampled from the posterior of the Bayesian ANOVA model as density overlays.
</p>


<h3>Author(s)</h3>

<p>Riko Kelter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(700)
x1=rnorm(1000,0,1)
x2=rnorm(1000,1,1)
x3=rnorm(1000,2,2)

result=bayes.anova(n=1000,first = x1, second=x2, third=x3)
post.pred.check(result, ngroups = 3, out = c(x1,x2,x3), reps = 25, eta = c(1/3,1/3,1/3))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
