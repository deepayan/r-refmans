<!DOCTYPE html><html><head><title>Help for package bamdit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bamdit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bamdit-package'><p>Bayesian Meta-Analysis of Diagnostic Test Data</p></a></li>
<li><a href='#bsroc'><p>bsroc</p></a></li>
<li><a href='#ct'><p>Diagnosis of appendicities with computer tomography scans</p></a></li>
<li><a href='#diabetes'><p>Systematic review which compares the accuracy of HbA1c vs</p>
FPG in diabetes</a></li>
<li><a href='#ep'><p>Ectopic pregnancy vs. all other pregnancies data</p></a></li>
<li><a href='#glas'><p>Tumor markers in the diagnosis of primary bladder cancer.</p></a></li>
<li><a href='#gould'><p>Accuracy of Positron Emission Tomography for Diagnosis of Pulmonary</p>
Nodules and Mass Lesions</a></li>
<li><a href='#metadiag'><p>Bayesian Meta-Analysis of diagnostic test data</p></a></li>
<li><a href='#mri'><p>Diagnosis of lymph node metastasis with magnetic resonance imaging</p></a></li>
<li><a href='#plot.metadiag'><p>Generic plot function for metadiag object in bamdit</p></a></li>
<li><a href='#plotcompare'><p>plotcompare</p></a></li>
<li><a href='#plotcredibility'><p>Generic plot function for metadiag object in bamdit</p></a></li>
<li><a href='#plotdata'><p>Basic function to plot the data of meta-analysis of diagnostic test</p></a></li>
<li><a href='#plotsesp'><p>plotsesp()</p>
plot the posterior densities for Se and Sp</a></li>
<li><a href='#plotw'><p>Plot for the conflict of evidence parameters w1 and w2</p></a></li>
<li><a href='#print.metadiag'><p>Generic print function for metadiag object in bamdit</p></a></li>
<li><a href='#rapt'><p>Systematic reviews of clinical decision tools for acute abdominal pain</p></a></li>
<li><a href='#safdar05'><p>Diagnosis of Intravascular Device-Related Bloodstream Infection</p></a></li>
<li><a href='#scheidler'><p>Radiological evaluation of lymph node metastases in patients with cervical cancer: a</p>
meta-analysis.</a></li>
<li><a href='#skin'><p>Accuracy of Computer-Aided Diagnosis of Melanoma: A Meta-analysis.</p></a></li>
<li><a href='#skin2'><p>Accuracy of Computer-Aided Diagnosis of Melanoma: A Comparative Meta-analysis.</p></a></li>
<li><a href='#summary.metadiag'><p>Generic summary function for metadiag object in bamdit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Meta-Analysis of Diagnostic Test Data</td>
</tr>
<tr>
<td>Version:</td>
<td>3.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-07-12</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rjags (&ge; 4.0.0), R2jags (&ge; 0.04-03), stats, ggplot2,
ggExtra, MASS, grid, gridExtra</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 4.3.0) (see
http://mcmc-jags.sourceforge.net)</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a new class of Bayesian meta-analysis models that incorporates a model for internal and external validity bias. In this way, it is possible to combine studies of diverse quality and different types. For example, we can combine the results of randomized control trials (RCTs) with the results of observational studies (OS). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-12 13:43:31 UTC; User</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Pablo Emilio Verde [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pablo Emilio Verde &lt;pabloemilio.verde@hhu.de&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-12 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bamdit-package'>Bayesian Meta-Analysis of Diagnostic Test Data</h2><span id='topic+bamdit-package'></span><span id='topic+bamdit'></span>

<h3>Description</h3>

<p>Bayesian meta-analysis of diagnostic test data based on a scale mixtures
bivariate random-effects model.
This package was developed with the aim of simplifying the use of meta-analysis
models that up to now have demanded great statistical expertise in Bayesian meta-analysis.
The package implements a series of innovative statistical techniques including:
the BSROC (Bayesian Summary ROC) curve, the BAUC (Bayesian AUC), predictive surfaces,
the use of prior distributions  that avoid boundary estimation problems of component
of variance and correlation parameters, analysis of conflict of evidence and robust
estimation of model parameters. In addition, the package comes with several published
examples of meta-analysis that can be used for illustration or further research in
this area.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> bamdit    </td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package      </td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.4.1    </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-07-12  </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pablo Emilio Verde <a href="mailto:pabloemilio.verde@hhu.de">pabloemilio.verde@hhu.de</a>
</p>

<hr>
<h2 id='bsroc'>bsroc</h2><span id='topic+bsroc'></span>

<h3>Description</h3>

<p>This function plots the observed data in the ROC (Receiving Operating Charachteristics) space with the
Bayesian SROC (Summary ROC) curve. The predictive curves are approximated using a parametric model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsroc(
  m,
  level = c(0.05, 0.5, 0.95),
  title = "Bayesian SROC Curve",
  fpr.x = seq(0.01, 0.95, 0.01),
  partial.AUC = TRUE,
  xlim.bsroc = c(0, 1),
  ylim.bsroc = c(0, 1),
  lower.auc = 0,
  upper.auc = 0.95,
  col.fill.points = "blue",
  results.bauc = TRUE,
  results.bsroc = FALSE,
  plot.post.bauc = FALSE,
  bins = 30,
  scale.size.area = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bsroc_+3A_m">m</code></td>
<td>
<p>The object generated by metadiag.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_level">level</code></td>
<td>
<p>Credibility levels of the predictive curve</p>
</td></tr>
<tr><td><code id="bsroc_+3A_title">title</code></td>
<td>
<p>Optional parameter for setting a title in the plot.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_fpr.x">fpr.x</code></td>
<td>
<p>Grid of values where the conditionl distribution is calculated.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_partial.auc">partial.AUC</code></td>
<td>
<p>Automatically calculate the AUC for the observed range of FPRs, default is TRUE.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_xlim.bsroc">xlim.bsroc</code></td>
<td>
<p>Graphical limits of the x-axis for the BSROC curve plot.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_ylim.bsroc">ylim.bsroc</code></td>
<td>
<p>Graphical limits of the y-axis for the BSROC curve plot.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_lower.auc">lower.auc</code></td>
<td>
<p>Lower limit of the AUC.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_upper.auc">upper.auc</code></td>
<td>
<p>Upper limit of the AUC.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_col.fill.points">col.fill.points</code></td>
<td>
<p>Color used to fill points, default is blue.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_results.bauc">results.bauc</code></td>
<td>
<p>Print results of the Bayesian Area Under the Curve, default value is TRUE.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_results.bsroc">results.bsroc</code></td>
<td>
<p>Print results of the Bayesian SROC curve, default value is FALSE.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_plot.post.bauc">plot.post.bauc</code></td>
<td>
<p>The BSROC and the posterior of the BAUC are ploted in the same page, default is FALSE.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_bins">bins</code></td>
<td>
<p>Histograms' bins.</p>
</td></tr>
<tr><td><code id="bsroc_+3A_scale.size.area">scale.size.area</code></td>
<td>
<p>Scale area for the ploted points, default = 10.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Verde P. E. (2010). Meta-analysis of diagnostic test data: A
bivariate Bayesian modeling approach. Statistics in Medicine. 29(30):3088-102.
doi: 10.1002/sim.4055.
</p>
<p>Verde P. E. (2018). bamdit: An R Package for Bayesian Meta-Analysis
of Diagnostic Test Data. Journal of Statisticsl Software. Volume 86, issue 10, pages 1&ndash;32.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+metadiag">metadiag</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## execute analysis
## Not run: 
# Example: data from Glas et al. (2003).....................................

data(glas)
glas.t &lt;- glas[glas$marker == "Telomerase", 1:4]
glas.m1 &lt;- metadiag(glas.t, re = "normal", link = "logit")
bsroc(glas.m1)
bsroc(glas.m1, plot.post.bauc = TRUE)

# Example: data from Scheidler et al. (1997)
# In this example the range of the observed FPR is less than 20%.
# Calculating the BSROC curve makes no sense! You will get a warning message!

data(mri)
mri.m &lt;- metadiag(mri)
bsroc(mri.m)

## End(Not run)
</code></pre>

<hr>
<h2 id='ct'>Diagnosis of appendicities with computer tomography scans</h2><span id='topic+ct'></span>

<h3>Description</h3>

<p>This data frame corresponds to 51 clinical studies reporting the accuracy of computer tomography (CT) scans for the diagnosis of appendicities.
</p>


<h3>Format</h3>

<p>A matrix with 51 rows and 17 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>tp</dt><dd><p>number of true positives.</p>
</dd>
<dt>n1</dt><dd><p>number of patients with disease.</p>
</dd>
<dt>fp</dt><dd><p>number of false positives.</p>
</dd>
<dt>n2</dt><dd><p>number of patients without disease.</p>
</dd>
<dt>Author</dt><dd><p>First author and year.</p>
</dd>
<dt>country</dt><dd><p>Country: EU = 1, others/USA = 2.</p>
</dd>
<dt>hosp</dt><dd><p>Type of hospital: 1 = university, 2 = others.</p>
</dd>
<dt>inclus</dt><dd><p>Inclusion criteria: 1 = Suspected, 2 = appendectomy.</p>
</dd>
<dt>indfind</dt><dd><p>Other CT findings included: 1 = no, 2 = yes.</p>
</dd>
<dt>design</dt><dd><p>Study design: 1 = prospective, 2 = retrospective.</p>
</dd>
<dt>contr</dt><dd><p>Contrast medium: 1 = no, 2 = yes.</p>
</dd>
<dt>localis</dt><dd><p>Localisation: 1 = one area, 2 = more than one area.</p>
</dd>
<dt>child</dt><dd><p>Children included: 1 = no, 2 = yes.</p>
</dd>
<dt>fup.na</dt><dd><p>Followup: 0 = no, 1 = yes.</p>
</dd>
<dt>refer.na</dt><dd><p>Valid reference: 0 = no, 1 = yes.</p>
</dd>
<dt>sample.na</dt><dd><p>Sample: 0 = selected, 1= consecutive/random.</p>
</dd>
<dt>gender.na</dt><dd><p>Gender, female: 0 = less than 50%; 1 = more than 50%.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This data frame corresponds to 51 clinical studies reporting
the accuracy of
computer tomography (CT) scans for the diagnosis of appendicities.
</p>


<h3>Source</h3>

<p>The data were obtainded from
</p>
<p>Ohmann C, Verde PE, Gilbers T, Franke C, Fuerst G, Sauerland S,
Boehner H. (2006) Systematic review of CT investigation in suspected acute
appendicitis. <em>Final Report; Coordination Centre for Clinical Trials,
Heinrich-Heine University</em>. Moorenstr. 5, D-40225 Duesseldorf Germany.
</p>


<h3>References</h3>

<p>Verde P. E. (2010). Meta-analysis of diagnostic test data: A
bivariate Bayesian modeling approach. <em>Statistics in Medicine</em>.
<b>29</b>, 3088-3102.
</p>

<hr>
<h2 id='diabetes'>Systematic review which compares the accuracy of HbA1c vs
FPG in diabetes</h2><span id='topic+diabetes'></span>

<h3>Description</h3>

<p>This data frame contains results of diagnostic accuracy of 38 studies which reported comparison of sensitivity and specificity between HbA1c vs FPG in a population based screening for type 2 diabetes.
</p>


<h3>Format</h3>

<p>A data frame with 38 rows and 9 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>Study</dt><dd><p>Name of the first author.</p>
</dd>
<dt>TP_HbA1c</dt><dd><p>Number of true positive cases for HbA1c.</p>
</dd>
<dt>FP_HbA1c</dt><dd><p>Number of false positive cases for HbA1c.</p>
</dd>
<dt>FN_HbA1c</dt><dd><p>Number of false negative cases for HbA1c.</p>
</dd>
<dt>TN_HbA1c</dt><dd><p>Number of true negative cases for HbA1c.</p>
</dd>
<dt>TP_FPG</dt><dd><p>Number of true positive cases for FPG.</p>
</dd>
<dt>FP_FPG</dt><dd><p>Number of false positive cases for FPG.</p>
</dd>
<dt>FN_FPG</dt><dd><p>Number of false negative cases for FPG.</p>
</dd>
<dt>TN_FPG</dt><dd><p>Number of true negative cases for FPG.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This data frame contains results of diagnostic accuraccy of 38 studies
which reported comparison of sensitivity and specificity between
HbA1c vs FPG in a population-based screening for type 2 diabetes.
</p>


<h3>Source</h3>

<p>Hoyer, A., Kuss, O. Meta-analysis for the comparison of two
disgnostic test: a new approach based on copulas. Stat. Med. 2018; 37:739-748
</p>

<hr>
<h2 id='ep'>Ectopic pregnancy vs. all other pregnancies data</h2><span id='topic+ep'></span>

<h3>Description</h3>

<p>Ectopic pregnancy vs. all other pregnancies data
Table III Mol et al. 1998
</p>


<h3>Format</h3>

<p>A matrix with 21 rows and 8 columns. Each row represents study
results, the columns are:
</p>

<dl>
<dt>tp</dt><dd><p>number of true positives.</p>
</dd>
<dt>n1</dt><dd><p>number of patients with disease.</p>
</dd>
<dt>fp</dt><dd><p>number of false positives.</p>
</dd>
<dt>n2</dt><dd><p>number of patients without disease.</p>
</dd>
<dt>d1</dt><dd><p>Prospective vs. retrospective.</p>
</dd>
<dt>d2</dt><dd><p>Cohort vs. case-control</p>
</dd>
<dt>d3</dt><dd><p>Consecutive sampling patients series vs. non-consecutive.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Table III Mol et al. 1998
</p>

<hr>
<h2 id='glas'>Tumor markers in the diagnosis of primary bladder cancer.</h2><span id='topic+glas'></span>

<h3>Description</h3>

<p>Outcome of individual studies evaluating urine markers
</p>


<h3>Format</h3>

<p>A matrix with 46 rows and 7 columns. Each row represents study
results, the columns are:
</p>

<dl>
<dt>tp</dt><dd><p>number of true positives.</p>
</dd>
<dt>n1</dt><dd><p>number of patients with disease.</p>
</dd>
<dt>fp</dt><dd><p>number of false positives.</p>
</dd>
<dt>n2</dt><dd><p>number of patients without disease.</p>
</dd>
<dt>author</dt><dd><p>first author of the study.</p>
</dd>
<dt>cutoff</dt><dd><p>cutoff in U/ml.</p>
</dd>
<dt>marker</dt><dd><p>test method used in the study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Glas AS, Roos D, Deutekom M, Zwindermann AH, Bossuyt PM, Kurth KH. (2003)
Tumor markers in the diagnosis of primary bladder cancer. A systematic
review. <em>Journal of Urology</em>; <b>169</b>:1975-82.
</p>


<h3>References</h3>

<p>Verde P. E. (2010). Meta-analysis of diagnostic test data: A
bivariate Bayesian modeling approach. <em>Statistics in Medicine</em>.
<b>29</b>, 3088-3102.
</p>

<hr>
<h2 id='gould'>Accuracy of Positron Emission Tomography for Diagnosis of Pulmonary
Nodules and Mass Lesions</h2><span id='topic+gould'></span>

<h3>Description</h3>

<p>Data from a Meta-Analysis of Studies Quality of FDG-PET for Diagnosis of SPNs and Mass Lesions
</p>


<h3>Format</h3>

<p>A matrix with 31 rows and 6 columns. Each row represents study
results, the columns are:
</p>

<dl>
<dt>tp</dt><dd><p>number of true positives.</p>
</dd>
<dt>n1</dt><dd><p>number of patients with disease.</p>
</dd>
<dt>fp</dt><dd><p>number of false positives.</p>
</dd>
<dt>n2</dt><dd><p>number of patients without disease.</p>
</dd>
<dt>author</dt><dd><p>first author of the study.</p>
</dd>
<dt>year</dt><dd><p>publication date.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtainded from
</p>
<p>Gould MK, Maclean CC, Kuschner WG, Rydzak CE, Owens Dk. (2001) Accuracy of
positron emission tomography for diagnosis of pulmonary nodules and mass
lesions: a meta-analysis. <em>The Journal of the American Medical
Association</em>;<b>285</b>:914-24.
</p>

<hr>
<h2 id='metadiag'>Bayesian Meta-Analysis of diagnostic test data</h2><span id='topic+metadiag'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis of diagnostic test data by
fitting a bivariate random effects model. The number of true positives and
false positives are modeled with two conditional Binomial distributions and
the random-effects are based on a bivariate scale mixture of Normals.
Computations are done by calling JAGS (Just Another Gibbs Sampler) to perform
MCMC (Markov Chain Monte Carlo) sampling and returning an object of the
class <em>mcmc.list</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metadiag(
  data,
  two.by.two = FALSE,
  re = "normal",
  re.model = "DS",
  link = "logit",
  mean.mu.D = 0,
  mean.mu.S = 0,
  sd.mu.D = 1,
  sd.mu.S = 1,
  sigma.D.upper = 10,
  sigma.S.upper = 10,
  mean.Fisher.rho = 0,
  sd.Fisher.rho = 1/sqrt(2),
  df = 4,
  df.estimate = FALSE,
  df.lower = 3,
  df.upper = 20,
  split.w = FALSE,
  n.1.new = 50,
  n.2.new = 50,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1,
  be.quiet = FALSE,
  r2jags = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metadiag_+3A_data">data</code></td>
<td>
<p>Either a data frame with at least 4 columns containing the true positives (tp),
number of patients with disease (n1), false positives (fp), number of patients without
disease (n2), or for two.by.two = TRUE a data frame where each line contains the
diagnostic results as a two by two table, where the column names are:
TP, FP, TN, FN.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_two.by.two">two.by.two</code></td>
<td>
<p>If TRUE indicates that the diagnostic results are given as: TP, FP, TN, FN.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_re">re</code></td>
<td>
<p>Random effects distribution for the resulting model. Possible
values are <em>normal</em> for bivariate random effects and <em>sm</em> for scale mixtures.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_re.model">re.model</code></td>
<td>
<p>If re.model = &quot;DS&quot; indicates that the sum and differences of TPR and FPR are modeled as random effects and re.model = &quot;SeSp&quot; indicates that the Sensitivity and Specificity are modeled as ranodm effects.
The default value is re.model = &quot;DS&quot;.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_link">link</code></td>
<td>
<p>The link function used in the model. Possible values are
<em>logit</em>, <em>cloglog</em> <em>probit</em>.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_mean.mu.d">mean.mu.D</code></td>
<td>
<p>prior Mean of D, default value is 0.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_mean.mu.s">mean.mu.S</code></td>
<td>
<p>prior Mean of S, default value is 0.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_sd.mu.d">sd.mu.D</code></td>
<td>
<p>prior   Standard deviation of D, default value is 1 (the prior of mu.D is a logistic distribution).</p>
</td></tr>
<tr><td><code id="metadiag_+3A_sd.mu.s">sd.mu.S</code></td>
<td>
<p>prior   Standard deviation of S, default value is 1 (the prior of mu.S is a logistic distribution).</p>
</td></tr>
<tr><td><code id="metadiag_+3A_sigma.d.upper">sigma.D.upper</code></td>
<td>
<p>Upper bound of the uniform prior of sigma.S, default value is 10.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_sigma.s.upper">sigma.S.upper</code></td>
<td>
<p>Upper bound of the uniform prior of sigma.S, default value is 10.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_mean.fisher.rho">mean.Fisher.rho</code></td>
<td>
<p>Mean of rho in the Fisher scale default value is 0.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_sd.fisher.rho">sd.Fisher.rho</code></td>
<td>
<p>Standard deviation of rho in the Fisher scale, default value is 1/sqrt(2).</p>
</td></tr>
<tr><td><code id="metadiag_+3A_df">df</code></td>
<td>
<p>If de.estimate = FALSE, then df is the degrees of freedom for the scale mixture distribution, default value is 4.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_df.estimate">df.estimate</code></td>
<td>
<p>Estimate the posterior of df. The defualt value is FALSE.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_df.lower">df.lower</code></td>
<td>
<p>Lower bound of the prior of df. The defulat value is 3.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_df.upper">df.upper</code></td>
<td>
<p>Upper bound of the prior of df. The defulat value is 30.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_split.w">split.w</code></td>
<td>
<p>Split the w parameter in two independent weights one for each random effect. The default value is FALSE.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_n.1.new">n.1.new</code></td>
<td>
<p>Number of patients with disease in a predictive study default is 50.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_n.2.new">n.2.new</code></td>
<td>
<p>Number of patients with non-disease in a predictive study default is 50.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 5.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adaptation.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discard for burn-in period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_be.quiet">be.quiet</code></td>
<td>
<p>Do not print warning message if the model does not adapt default value is FALSE. If you are not sure about the adaptation period choose be.quiet=TRUE.</p>
</td></tr>
<tr><td><code id="metadiag_+3A_r2jags">r2jags</code></td>
<td>
<p>Which interface is used to link R to JAGS (rjags and R2jags) default value is R2Jags TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Installation of JAGS: It is important to note that R 3.3.0 introduced a major change in the
use of toolchain for Windows. This new toolchain is incompatible with older packages written in C++.
As a consequence, if the installed version of JAGS does not match the R installation, then the rjags
package will spontaneously crash. Therefore, if a user works with R version &gt;= 3.3.0, then JAGS must
be installed with the installation program JAGS-4.2.0-Rtools33.exe. For users who continue using R 3.2.4 or
an earlier version, the installation program for JAGS is the default installer JAGS-4.2.0.exe.
</p>


<h3>Value</h3>

<p>This function returns an object of the class metadiag. This object contains the MCMC output of
each parameter and hyper-parameter in the model, the data frame used for fitting the model, the link function,
type of random effects distribution and the splitting information for conflict of evidence analysis.
</p>
<p>The results of the object of the class metadiag can be extracted with R2jags or with rjags. In addition
a summary, a print and a plot functions are implemented for this type of object.
</p>


<h3>References</h3>

<p>Verde P. E. (2010). Meta-analysis of diagnostic test data: A
bivariate Bayesian modeling approach. Statistics in Medicine. 29(30):3088-102.
doi: 10.1002/sim.4055.
</p>
<p>Verde P. E. (2018). bamdit: An R Package for Bayesian Meta-Analysis
of Diagnostic Test Data. Journal of Statisticsl Software. Volume 86, issue 10, pages 1&ndash;32.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 

# Example: data from Glas et al. (2003).....................................
library(bamdit)
data("glas")
glas.t &lt;- glas[glas$marker == "Telomerase", 1:4]

glas.t &lt;- glas[glas$marker == "Telomerase", 1:4]

# Simple visualization ...

plotdata(glas.t,                # Data frame
         two.by.two = FALSE     # Data is given as: (tp, n1, fp, n2)
         )

glas.m1 &lt;- metadiag(glas.t,                # Data frame
                    two.by.two = FALSE,    # Data is given as: (tp, n1, fp, n2)
                    re = "normal",         # Random effects distribution
                    re.model = "DS",       # Random effects on D and S
                    link = "logit",        # Link function
                    sd.Fisher.rho   = 1.7, # Prior standard deviation of correlation
                    nr.burnin = 1000,      # Iterations for burnin
                    nr.iterations = 10000, # Total iterations
                    nr.chains = 2,         # Number of chains
                    r2jags = TRUE)         # Use r2jags as interface to jags


 summary(glas.m1, digit=3)

 plot(glas.m1,                    # Fitted model
      level = c(0.5, 0.75, 0.95), # Credibility levels
      parametric.smooth = TRUE)   # Parametric curve


# Plot results: based on a non-parametric smoother of the posterior predictive rates .......

plot(glas.m1,                    # Fitted model
     level = c(0.5, 0.75, 0.95), # Credibility levels
     parametric.smooth = FALSE)  # Non-parametric curve


# Using the pipe command in the package dplyr ...............................................

library(dplyr)

glas.t %&gt;%
  metadiag(re = "normal", re.model ="SeSp") %&gt;%
  plot(parametric.smooth = FALSE, color.pred.points = "red")



# Visualization of posteriors of hyper-parameters .........................................
library(ggplot2)
library(GGally)
library(R2jags)
attach.jags(glas.m1)
hyper.post &lt;- data.frame(mu.D, mu.S, sigma.D, sigma.S, rho)
ggpairs(hyper.post,                  # Data frame
       title = "Hyper-Posteriors",          # title of the graph
       lower = list(continuous = "density") # contour plots
       )


#............................................................................

# List of different statistical models:
#    1) Different link functions: logit, cloglog and probit

#    2) Different parametrization of random effects in the link scale:
#         DS = "differences of TPR and FPR"
#         SeSp = "Sensitivity and Specificity"

#    3) Different random effects distributions:
#       "normal" or "sm = scale mixtures".

#    4) For the scale mixture random effects:
#       split.w = TRUE =&gt; "split the weights".

#    5) For the scale mixture random effects:
#       df.estimate = TRUE =&gt; "estimate the degrees of freedom".

#    6) For the scale mixture random effects:
#       df.estimate = TRUE =&gt; "estimate the degrees of freedom".

#    7) For the scale mixture random effects:
#       df = 4 =&gt; "fix the degrees of freedom to a particual value".
#       Note that df = 1 fits a Cauchy bivariate distribution to the random effects.

# logit-normal-DS
m &lt;- metadiag(glas.t, re = "normal", re.model = "DS", link = "logit")
summary(m)
plot(m)

# cloglog-normal-DS
summary(metadiag(glas.t, re = "normal", re.model = "DS", link = "cloglog"))

# probit-normal-DS
summary(metadiag(glas.t, re = "normal", re.model = "DS", link = "probit"))
# logit-normal-SeSp
summary(metadiag(glas.t, re = "normal", re.model = "SeSp", link = "logit"))

# cloglog-normal-SeSp
summary(metadiag(glas.t, re = "normal", re.model = "SeSp", link = "cloglog"))
# probit-normal-SeSp
summary(metadiag(glas.t, re = "normal", re.model = "SeSp", link = "probit"))

# logit-sm-DS
summary(metadiag(glas.t, re = "sm", re.model = "DS", link = "logit", df = 1))

# cloglog-sm-DS
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "cloglog", df = 1))
plot(m, parametric.smooth = FALSE)

# probit-sm-DS
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "probit", df = 1))
plot(m, parametric.smooth = FALSE)

# logit-sm-SeSp
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "logit", df = 1))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# cloglog-sm-SeSp
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "cloglog", df = 1))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# probit-sm-SeSp
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "probit", df = 1))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# logit-sm-DS-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "logit",
 df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# cloglog-sm-DS-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "cloglog",
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# probit-sm-DS-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "probit",
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# logit-sm-SeSp-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "probit",
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# cloglog-sm-SeSp-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "cloglog",
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# probit-sm-SeSp-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "probit",
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))

# split.w ...................................................................

# logit-sm-DS
summary(m &lt;- metadiag(glas.t, re = "sm", re.model = "DS", link = "logit", split.w = TRUE, df = 10))
plot(m)

# cloglog-sm-DS
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "cloglog", split.w = TRUE, df = 4))
plot(m)

# probit-sm-DS
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "probit", split.w = TRUE, df = 4))
plot(m, parametric.smooth = FALSE)

# logit-sm-SeSp
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "logit", split.w = TRUE, df = 1))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)

# cloglog-sm-SeSp
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "cloglog", split.w = TRUE, df = 1))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)

# probit-sm-SeSp
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "probit", split.w = TRUE, df = 1))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)


# logit-sm-DS-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "logit", split.w = TRUE,
 df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)

# cloglog-sm-DS-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "cloglog", split.w = TRUE,
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)

# probit-sm-DS-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "DS", link = "probit", split.w = TRUE,
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)

# logit-sm-SeSp-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "probit", split.w = TRUE,
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)

# cloglog-sm-SeSp-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "cloglog", split.w = TRUE,
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)

# probit-sm-SeSp-df
summary(m&lt;-metadiag(glas.t, re = "sm", re.model = "SeSp", link = "probit", split.w = TRUE,
df.estimate = TRUE))
plot(m, parametric.smooth = FALSE, level = c(0.5, 0.9))
plotw(m)


## End(Not run)

</code></pre>

<hr>
<h2 id='mri'>Diagnosis of lymph node metastasis with magnetic resonance imaging</h2><span id='topic+mri'></span>

<h3>Description</h3>

<p>Diagnosis of lymph node metastasis with magnetic resonance imaging
</p>


<h3>Format</h3>

<p>A matrix with 10 rows and 4 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>tp</dt><dd><p>true positives</p>
</dd>
<dt>n1</dt><dd><p>number of patients with disease</p>
</dd>
<dt>fp</dt><dd><p>false positives</p>
</dd>
<dt>n2</dt><dd><p>number of patients without disease</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Scheidler J, Hricak H, Yu KK, Subak L, Segal MR. (1997)
Radiological evaluation of lymph node metastases in
patients with cervical cancer: a meta-analysis. <em>The
Journal of the American Medical Association</em>;
<b>278</b>:1096-1101.
</p>


<h3>References</h3>

<p>Verde P. E. (2010). Meta-analysis of diagnostic test
data: A bivariate Bayesian modeling approach.
<em>Statistics in Medicine</em>. <b>29</b>, 3088-3102.
</p>

<hr>
<h2 id='plot.metadiag'>Generic plot function for metadiag object in bamdit</h2><span id='topic+plot.metadiag'></span>

<h3>Description</h3>

<p>This function plots the observe data in the ROC (Receiving Operating Charachteristics) space with the
posterior predictive contours. The predictive curves are approximated using a non-parametric smoother
or with a parametric model. For the parametric model the current implementation supports only a
logistic link function. The marginal posterior predictive distributions are ploted outside the ROC space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metadiag'
plot(
  x,
  parametric.smooth = TRUE,
  level = c(0.5, 0.75, 0.95),
  limits.x = c(0, 1),
  limits.y = c(0, 1),
  kde2d.n = 25,
  color.line = "red",
  title = paste("Posterior Predictive Contours (50%, 75% and 95%)"),
  marginals = TRUE,
  bin.hist = 30,
  color.hist = "lightblue",
  S = 500,
  color.pred.points = "lightblue",
  color.data.points = "blue",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.metadiag_+3A_x">x</code></td>
<td>
<p>The object generated by the metadiag function.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_parametric.smooth">parametric.smooth</code></td>
<td>
<p>Indicates if the predictive curve is a parametric or non-parametric.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_level">level</code></td>
<td>
<p>Credibility levels of the predictive curve. If parametric.smooth = FALSE, then the probability levels are estimated from the nonparametric surface.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_limits.x">limits.x</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits. The default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_limits.y">limits.y</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits. The default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_kde2d.n">kde2d.n</code></td>
<td>
<p>The number of grid points in each direction for the non-parametric density estimation. Can be scalar or a length-2 inter vector.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_color.line">color.line</code></td>
<td>
<p>Color of the predictive contour line.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_title">title</code></td>
<td>
<p>Optional parameter for setting a title in the plot.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_marginals">marginals</code></td>
<td>
<p>Plot the posterior marginal predictive histograms.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_bin.hist">bin.hist</code></td>
<td>
<p>Number of bins of the marginal histograms.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_color.hist">color.hist</code></td>
<td>
<p>Color of the histograms.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_s">S</code></td>
<td>
<p>Number of predictive rates to be plotted.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_color.pred.points">color.pred.points</code></td>
<td>
<p>Color of the posterior predictive rates.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_color.data.points">color.data.points</code></td>
<td>
<p>Color of the data points.</p>
</td></tr>
<tr><td><code id="plot.metadiag_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+metadiag">metadiag</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


## Not run: 
library(bamdit)
data("glas")
glas.t &lt;- glas[glas$marker == "Telomerase", 1:4]
glas.m1 &lt;- metadiag(glas.t,                # Data frame
                    re = "normal",         # Random effects distribution
                    re.model = "DS",       # Random effects on D and S
                    link = "logit",        # Link function
                    sd.Fisher.rho   = 1.7, # Prior standard deviation of correlation
                    nr.burnin = 1000,      # Iterations for burnin
                    nr.iterations = 10000, # Total iterations
                    nr.chains = 2,         # Number of chains
                    r2jags = TRUE)         # Use r2jags as interface to jags


 plot(glas.m1,                    # Fitted model
      level = c(0.5, 0.75, 0.95), # Credibility levels
      parametric.smooth = TRUE)   # Parametric curve

# Plot results: based on a non-parametric smoother of the posterior predictive rates .......

plot(glas.m1,                    # Fitted model
     level = c(0.5, 0.75, 0.95), # Credibility levels
     parametric.smooth = FALSE)  # Non-parametric curve

# Using the pipe command in the package dplyr and changing some colors .......

library(dplyr)

glas.t %&gt;%
 metadiag(re = "normal", re.model ="SeSp") %&gt;%
   plot(parametric.smooth = FALSE,
          S = 100,
          color.data.points = "green",
          color.pred.points = "blue",
          color.line = "black")


## End(Not run)
</code></pre>

<hr>
<h2 id='plotcompare'>plotcompare</h2><span id='topic+plotcompare'></span>

<h3>Description</h3>

<p>This function compares the predictive posterior surfaces of two fitted models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotcompare(
  m1,
  m2,
  level = 0.95,
  title = paste("Comparative Predictive Posterior Contours"),
  m1.name = "Model.1",
  m2.name = "Model.2",
  group = NULL,
  limits.x = c(0, 1),
  limits.y = c(0, 1),
  group.colors = c("blue", "red")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotcompare_+3A_m1">m1</code></td>
<td>
<p>A model fitted to the data. This is an object generated by the metadiag function.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_m2">m2</code></td>
<td>
<p>A second model fitted to the data. This is an object generated by the metadiag function.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_level">level</code></td>
<td>
<p>Credibility level of the predictive curves.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_title">title</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_m1.name">m1.name</code></td>
<td>
<p>Label of the model 1.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_m2.name">m2.name</code></td>
<td>
<p>Label of the model 2.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_group">group</code></td>
<td>
<p>An optional argument, which is a variable name indicating a group factor. This argument is used to compare results from two subgroups.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_limits.x">limits.x</code></td>
<td>
<p>A vector with the limits of the horizontal axis.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_limits.y">limits.y</code></td>
<td>
<p>A vector with the limits of the vertical axis.</p>
</td></tr>
<tr><td><code id="plotcompare_+3A_group.colors">group.colors</code></td>
<td>
<p>A character vector with two color names.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+metadiag">metadiag</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## execute analysis
## Not run: 

# Comparing results from two models same data

data(glas)
glas.t &lt;- glas[glas$marker == "Telomerase", 1:4]
glas.m1 &lt;- metadiag(glas.t)
glas.m2 &lt;- metadiag(glas.t, re = "sm")
plotcompare(m1 = glas.m1, m2 = glas.m2)

# Comparing results from two models fitted to two subgroups of data:
# studies with retrospective design and studies with prospective design

data("ct")
ct$design = factor(ct$design, labels = c("Prospective", "Retrospective"))

m1.ct &lt;- metadiag(ct[ct$design=="Prospective", ])
m2.ct &lt;- metadiag(ct[ct$design=="Retrospective", ])

plotcompare(m1.ct, m2.ct,m1.name = "Retrospective design",
m2.name = "Prospective design",group = "design",
limits.x = c(0, 0.75), limits.y = c(0.65, 1))



## End(Not run)

</code></pre>

<hr>
<h2 id='plotcredibility'>Generic plot function for metadiag object in bamdit</h2><span id='topic+plotcredibility'></span>

<h3>Description</h3>

<p>This function plots the observe data in the ROC (Receiving Operating Characteristics) space with the
posterior credibility contours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotcredibility(
  x,
  parametric.smooth = TRUE,
  level = c(0.5, 0.75, 0.95),
  limits.x = c(0, 1),
  limits.y = c(0, 1),
  color.line = "red",
  color.data.points = "blue",
  title = paste("Posterior Credibility Contours (50%, 75% and 95%)"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotcredibility_+3A_x">x</code></td>
<td>
<p>The object generated by the metadiag function.</p>
</td></tr>
<tr><td><code id="plotcredibility_+3A_parametric.smooth">parametric.smooth</code></td>
<td>
<p>Indicates if the predictive curve is a parametric or non-parametric.</p>
</td></tr>
<tr><td><code id="plotcredibility_+3A_level">level</code></td>
<td>
<p>Credibility levels of the predictive curve. If parametric.smooth = FALSE, then the probability levels are estimated from the nonparametric surface.</p>
</td></tr>
<tr><td><code id="plotcredibility_+3A_limits.x">limits.x</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits. The default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="plotcredibility_+3A_limits.y">limits.y</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits. The default value is c(0, 1).</p>
</td></tr>
<tr><td><code id="plotcredibility_+3A_color.line">color.line</code></td>
<td>
<p>Color of the predictive contour line.</p>
</td></tr>
<tr><td><code id="plotcredibility_+3A_color.data.points">color.data.points</code></td>
<td>
<p>Color of the data points.</p>
</td></tr>
<tr><td><code id="plotcredibility_+3A_title">title</code></td>
<td>
<p>Optional parameter for setting a title in the plot.</p>
</td></tr>
<tr><td><code id="plotcredibility_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+metadiag">metadiag</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


## Not run: 
library(bamdit)
data("glas")
glas.t &lt;- glas[glas$marker == "Telomerase", 1:4]
glas.m1 &lt;- metadiag(glas.t,                # Data frame
                    re = "normal",         # Random effects distribution
                    re.model = "DS",       # Random effects on D and S
                    link = "logit",        # Link function
                    sd.Fisher.rho   = 1.7, # Prior standard deviation of correlation
                    nr.burnin = 1000,      # Iterations for burnin
                    nr.iterations = 10000, # Total iterations
                    nr.chains = 2,         # Number of chains
                    r2jags = TRUE)         # Use r2jags as interface to jags


 plotcredibility(glas.m1,         # Fitted model
      level = c(0.5, 0.75, 0.95), # Credibility levels
      parametric.smooth = TRUE)   # Parametric curve

## End(Not run)
</code></pre>

<hr>
<h2 id='plotdata'>Basic function to plot the data of meta-analysis of diagnostic test</h2><span id='topic+plotdata'></span>

<h3>Description</h3>

<p>This function plots the true positive rates vs the false positive rates of each study included
in the meta-analysis. Study results are displayed by circles, the diameter of each circle is proportional
to the sample size of the study (or table). If subgroups are displayed each group is represented by
different colours. This function use the package <em>ggplot2</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotdata(
  data,
  two.by.two = FALSE,
  group = NULL,
  x.lo = 0,
  x.up = 1,
  y.lo = 0,
  y.up = 1,
  alpha.p = 0.7,
  max.size = 15
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotdata_+3A_data">data</code></td>
<td>
<p>Either a data frame with at least 4 columns containing the true positives (tp),
number of patients with disease (n1), false positives (fp), number of patients without
disease (n2), or for two.by.two = TRUE a data frame where each line contains the
diagnostic results as a two by two table, where the column names are:
TP, FP, TN, FN.</p>
</td></tr>
<tr><td><code id="plotdata_+3A_two.by.two">two.by.two</code></td>
<td>
<p>If TRUE indicates that the diagnostic results are given as: TP, FP, TN, FN.</p>
</td></tr>
<tr><td><code id="plotdata_+3A_group">group</code></td>
<td>
<p>a variable name indicating a group factor</p>
</td></tr>
<tr><td><code id="plotdata_+3A_x.lo">x.lo</code></td>
<td>
<p>lower limit of the x-axis</p>
</td></tr>
<tr><td><code id="plotdata_+3A_x.up">x.up</code></td>
<td>
<p>upper limit of the x-axis</p>
</td></tr>
<tr><td><code id="plotdata_+3A_y.lo">y.lo</code></td>
<td>
<p>lower limit of the y-axis</p>
</td></tr>
<tr><td><code id="plotdata_+3A_y.up">y.up</code></td>
<td>
<p>upper limit of the y-axis</p>
</td></tr>
<tr><td><code id="plotdata_+3A_alpha.p">alpha.p</code></td>
<td>
<p>transparency of the points</p>
</td></tr>
<tr><td><code id="plotdata_+3A_max.size">max.size</code></td>
<td>
<p>scale parameter of the maximum size</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## execute analysis
## Not run: 

data(ct)
ct$design &lt;- with(ct, factor(design,
             labels = c("Prospective", "Retrospective")))

plotdata(ct,              # Data frame
        group = "design", # Groupping variable
        y.lo = 0.75,      # Lower limit of y-axis
        x.up = 0.75,      # Upper limit of x-axis
        alpha.p = 0.5,    # Transparency of the balls
        max.size = 5)     # Scale the circles

## End(Not run)


</code></pre>

<hr>
<h2 id='plotsesp'>plotsesp()
plot the posterior densities for Se and Sp</h2><span id='topic+plotsesp'></span>

<h3>Description</h3>

<p>plotsesp()
plot the posterior densities for Se and Sp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsesp(m, binwidth.p = 0.03, CI.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsesp_+3A_m">m</code></td>
<td>
<p>The object generated by the metadiag function.</p>
</td></tr>
<tr><td><code id="plotsesp_+3A_binwidth.p">binwidth.p</code></td>
<td>
<p>Histograms binwidth, default is 0.03.</p>
</td></tr>
<tr><td><code id="plotsesp_+3A_ci.level">CI.level</code></td>
<td>
<p>Level of the posterior interval default is 0.95.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+metadiag">metadiag</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## execute analysis
## Not run: 
data(ep)
m1.ep &lt;- metadiag(ep[,1:4])

plotsesp(m = m1.ep)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotw'>Plot for the conflict of evidence parameters w1 and w2</h2><span id='topic+plotw'></span>

<h3>Description</h3>

<p>Conflict of evidence plot: this plot displays the posterior distribution of the study's weights w1 and w1.
These weights indicate potential conflict of evidence of the studies. The weight w1 indicates deviations
with respect to the specificity and w2 to the sensitivity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotw(
  m,
  group = NULL,
  title = "Posterior quantiles (25%, 50%, 75%)",
  group.colors = c("blue", "red")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotw_+3A_m">m</code></td>
<td>
<p>The object generated by metadiag. The model object must be fitted with the options: re = &quot;sm&quot; and split.w = TRUE.</p>
</td></tr>
<tr><td><code id="plotw_+3A_group">group</code></td>
<td>
<p>An optional argument which is a variable name indicating a group factor.
If set, then the plot is colored by groups.</p>
</td></tr>
<tr><td><code id="plotw_+3A_title">title</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plotw_+3A_group.colors">group.colors</code></td>
<td>
<p>A character vector with two color names.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+metadiag">metadiag</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## execute analysis
## Not run: 
data(ep)
ep$design = factor(ep$d1,labels = c("prospective", "retrospective"))
m.ep &lt;- metadiag(ep, re = "sm", re.model = "SeSp",
                split.w = TRUE,
                df.estimate = TRUE)

plotw(m.ep)
#Relationship between conflict and study design
plotw(m.ep, group = "design")


## End(Not run)

</code></pre>

<hr>
<h2 id='print.metadiag'>Generic print function for metadiag object in bamdit</h2><span id='topic+print.metadiag'></span>

<h3>Description</h3>

<p>Generic print function for metadiag object in bamdit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metadiag'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.metadiag_+3A_x">x</code></td>
<td>
<p>The object generated by the function metadiag.</p>
</td></tr>
<tr><td><code id="print.metadiag_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.metadiag_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='rapt'>Systematic reviews of clinical decision tools for acute abdominal pain</h2><span id='topic+rapt'></span>

<h3>Description</h3>

<p>This data frame corresponds to 13 clinical studies reporting the accuracy of doctors added with decision tools.
</p>


<h3>Format</h3>

<p>A data frame with 13 rows and 13 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>Author</dt><dd><p>Name of the first author and year of publication</p>
</dd>
<dt>tp.dr</dt><dd><p>Number of true positive cases for unadded doctors.</p>
</dd>
<dt>fp.dr</dt><dd><p>Number of false positive cases for unadded doctors.</p>
</dd>
<dt>fn.dr</dt><dd><p>Number of false negative cases for unadded doctors.</p>
</dd>
<dt>tn.dr</dt><dd><p>Number of true negative cases for unadded doctors.</p>
</dd>
<dt>tp.tools</dt><dd><p>Number of true positive cases for doctors with decision tools.</p>
</dd>
<dt>fp.tools</dt><dd><p>Number of false positive cases for doctors with decision tools.</p>
</dd>
<dt>fn.tools</dt><dd><p>Number of false negative cases for doctors with decision tools.</p>
</dd>
<dt>tn.tools</dt><dd><p>Number of true negative cases for doctors with decision tools.</p>
</dd>
<dt>tool</dt><dd><p>Diagnostic tool.</p>
</dd>
<dt>n.dr</dt><dd><p>Total number of cases for unadded doctors.</p>
</dd>
<dt>n.tools</dt><dd><p>Total number of cases for doctors with decision tools.</p>
</dd>
<dt>design</dt><dd><p>Study design.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This data frame contains results of diagnostic accuraccy of 13 studies
which reported comparison of sensitivity and specificity between
doctors using diagnostic tools vs doctors without decision tools.
</p>


<h3>Source</h3>

<p>Health Technol Assess. 2006 Nov;10(47):1-167, iii-iv.
Systematic reviews of clinical decision tools for acute abdominal pain.
Liu JL1, Wyatt JC, Deeks JJ, Clamp S, Keen J, Verde P, Ohmann C,
Wellwood J, Dawes M, Altman DG.
</p>


<h3>References</h3>

<p>Health Technol Assess. 2006 Nov;10(47):1-167, iii-iv.
Systematic reviews of clinical decision tools for acute abdominal pain.
Liu JL1, Wyatt JC, Deeks JJ, Clamp S, Keen J, Verde P, Ohmann C,
Wellwood J, Dawes M, Altman DG.
</p>

<hr>
<h2 id='safdar05'>Diagnosis of Intravascular Device-Related Bloodstream Infection</h2><span id='topic+safdar05'></span>

<h3>Description</h3>

<p>Outcome of individual studies evaluating intravascular device-related
bloodstream infection
</p>


<h3>Format</h3>

<p>A matrix with 78 rows and 8 columns. Each row represents study
results, the columns are:
</p>

<dl>
<dt>tp</dt><dd><p>number of true positives.</p>
</dd>
<dt>n1</dt><dd><p>number of patients with disease.</p>
</dd>
<dt>fp</dt><dd><p>number of false positives.</p>
</dd>
<dt>n2</dt><dd><p>number of patients without disease.</p>
</dd>
<dt>author</dt><dd><p>first author of the study.</p>
</dd>
<dt>year</dt><dd><p>publication date.</p>
</dd>
<dt>technique</dt><dd><p>diagnostic technique used in the study.</p>
</dd>
<dt>duration</dt><dd><p>duration of catheterization: short term or long term or both.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Safdar N, Fine JP, Maki DG. (2005) Meta-analysis: methods for diagnosing
intravascular device-related bloodstream infection.
<em>Ann Intern Med.</em>; <b>142</b>:451-66.
</p>

<hr>
<h2 id='scheidler'>Radiological evaluation of lymph node metastases in patients with cervical cancer: a
meta-analysis.</h2><span id='topic+scheidler'></span>

<h3>Description</h3>

<p>This data frame summarizes the tables 1-3 of Scheidler et al. 1997.
</p>


<h3>Format</h3>

<p>A matrix with 46 rows and 7 columns. Each row represents study
results, the columns are:
</p>

<dl>
<dt>tp</dt><dd><p>true positives.</p>
</dd>
<dt>n1</dt><dd><p>number of patients with disease.</p>
</dd>
<dt>fp</dt><dd><p>false positives.</p>
</dd>
<dt>n2</dt><dd><p>number of patients without disease.</p>
</dd>
<dt>author</dt><dd><p>first author of the study.</p>
</dd>
<dt>year</dt><dd><p>publication date.</p>
</dd>
<dt>test</dt><dd><p>test method used in the study.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Scheidler J, Hricak H, Yu KK, Subak L, Segal MR. (1997) Radiological
evaluation of lymph node metastases in patients with cervical cancer: a
meta-analysis. <em>The Journal of the American Medical Association</em>;
<b>278</b>:1096-1101.
</p>


<h3>References</h3>

<p>Verde P. E. (2010). Meta-analysis of diagnostic test data: A
bivariate Bayesian modeling approach. <em>Statistics in Medicine</em>.
<b>29</b>, 3088-3102.
</p>

<hr>
<h2 id='skin'>Accuracy of Computer-Aided Diagnosis of Melanoma: A Meta-analysis.</h2><span id='topic+skin'></span>

<h3>Description</h3>

<p>This data frame contains results 70 studies investigated computer-aided diagnosis of melanoma
</p>


<h3>Format</h3>

<p>A matrix with 70 rows and 15 columns. Each row represents a study's results, the columns are:
</p>

<dl>
<dt>&quot;TP&quot;</dt><dd><p>number of true positives.</p>
</dd>
<dt>&quot;TN&quot;</dt><dd><p>number of ture negatives.</p>
</dd>
<dt>&quot;FP&quot;</dt><dd><p>number of false positives.</p>
</dd>
<dt>&quot;FN&quot;</dt><dd><p>number of false negative.</p>
</dd>
<dt>&quot;study_ID&quot;</dt><dd><p>Study identification</p>
</dd>
<dt>&quot;test_set_source&quot;</dt><dd><p>Public or propietary.</p>
</dd>
<dt>&quot;method&quot;</dt><dd><p>Diagnostic technique used in the study: computer vision; deep learning or hardware-based.</p>
</dd>
<dt>&quot;test_set_independent&quot;</dt><dd><p>yes or no.</p>
</dd>
<dt>&quot;SAMPLE_SELECTION_BR&quot;</dt><dd><p>QUADAS-2, Patient selection bias.</p>
</dd>
<dt>&quot;INDEX_TEST_BR&quot;</dt><dd><p>QUADAS-2, Index test description/application bias.</p>
</dd>
<dt>&quot;REFERENCE_STANDARD_BR&quot;</dt><dd><p>QUADAS-2, Reference standard bias.</p>
</dd>
<dt>&quot;FLOW_AND_TIMING_BR&quot;</dt><dd><p>QUADAS-2, Patient flow and timing bias.</p>
</dd>
<dt>&quot;SAMPLE_SELECTION_AP</dt><dd><p>QUADAS-2, Patient selection bias.</p>
</dd>
<dt>&quot;INDEX_TEST_AP&quot;</dt><dd><p>QUADAS-2, Index test description/application bias.</p>
</dd>
<dt>&quot;REFERENCE_STANDARD_AP&quot;</dt><dd><p>QUADAS-2, Reference standard bias.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Dick V, Sinz C, Mittlböck M, Kittler H, Tschandl P. Accuracy of Computer-Aided Diagnosis of Melanoma:
A Meta-analysis. JAMA Dermatol. 2019 Nov 1;155 11:1291-1299.
doi: 10.1001/jamadermatol.2019.1375. PMID: 31215969; PMCID: PMC6584889.
</p>

<hr>
<h2 id='skin2'>Accuracy of Computer-Aided Diagnosis of Melanoma: A Comparative Meta-analysis.</h2><span id='topic+skin2'></span>

<h3>Description</h3>

<p>This data frame contains results 14 comparative diagnostic studies: CAD vs Dermatologists
</p>


<h3>Format</h3>

<p>A matrix with 14 rows and 12 columns. Each row represents a study's results, the columns are:
</p>

<dl>
<dt>&quot;study&quot;</dt><dd><p>Study name and year</p>
</dd>
<dt>&quot;TP_CAD&quot;</dt><dd><p>number of true positives CAD.</p>
</dd>
<dt>&quot;TN_CAD&quot;</dt><dd><p>number of ture negatives CAD.</p>
</dd>
<dt>&quot;FP_CAD&quot;</dt><dd><p>number of false positives CAD.</p>
</dd>
<dt>&quot;FN_CAD&quot;</dt><dd><p>number of false negative CAD.</p>
</dd>
<dt>&quot;TP_Dermatologists&quot;</dt><dd><p>number of true positives Dermatologists.</p>
</dd>
<dt>&quot;TN_Dermatologists&quot;</dt><dd><p>number of ture negatives Dermatologists.</p>
</dd>
<dt>&quot;FP_Dermatologists&quot;</dt><dd><p>number of false positives Dermatologists.</p>
</dd>
<dt>&quot;FN_Dermatologists&quot;</dt><dd><p>number of false negative Dermatologists.</p>
</dd>
<dt>&quot;test_set_source&quot;</dt><dd><p>The database was public domain or propietary.</p>
</dd>
<dt>&quot;cad_method&quot;</dt><dd><p>Computer-Aided Diagnostic Technique: computer vision; deep learning or hardware-based.</p>
</dd>
<dt>&quot;test_set_independent&quot;</dt><dd><p>yes or no.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from
</p>
<p>Dick V, Sinz C, Mittlböck M, Kittler H, Tschandl P. Accuracy of Computer-Aided Diagnosis of Melanoma:
A Meta-analysis. JAMA Dermatol. 2019 Nov 1;155 11:1291-1299.
doi: 10.1001/jamadermatol.2019.1375. PMID: 31215969; PMCID: PMC6584889.
</p>

<hr>
<h2 id='summary.metadiag'>Generic summary function for metadiag object in bamdit</h2><span id='topic+summary.metadiag'></span>

<h3>Description</h3>

<p>Generic summary function for metadiag object in bamdit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metadiag'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.metadiag_+3A_object">object</code></td>
<td>
<p>The object generated by the metadiag function.</p>
</td></tr>
<tr><td><code id="summary.metadiag_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.metadiag_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
