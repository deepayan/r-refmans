<!DOCTYPE html><html><head><title>Help for package powerMediation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {powerMediation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#minEffect.SLR'>
<p>Minimum detectable slope</p></a></li>
<li><a href='#minEffect.VSMc'>
<p>Minimum detectable slope for mediator in linear regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#minEffect.VSMc.cox'>
<p>Minimum detectable slope for mediator in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#minEffect.VSMc.logistic'>
<p>Minimum detectable slope for mediator in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#minEffect.VSMc.poisson'>
<p>Minimum detectable slope for mediator in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#power.SLR'>
<p>Power for testing slope for simple linear regression</p></a></li>
<li><a href='#power.SLR.rho'>
<p>Power for testing slope for simple linear regression</p></a></li>
<li><a href='#powerInteract2by2'>
<p>Power Calculation for Interaction Effect in 2x2 Two-Way ANOVA Given Effect Sizes</p></a></li>
<li><a href='#powerLogisticBin'>
<p>Calculating power for simple logistic regression with binary predictor</p></a></li>
<li><a href='#powerLogisticCon'>
<p>Calculating power for simple logistic regression with continuous predictor</p></a></li>
<li><a href='#powerLong'>
<p>Power calculation for longitudinal study with 2 time point</p></a></li>
<li><a href='#powerLong.multiTime'>
<p>Power calculation for testing if mean changes for 2 groups are the</p>
same or not for longitudinal study with more than 2 time points</a></li>
<li><a href='#powerLongFull'>
<p>Power calculation for longitudinal study with 2 time point</p></a></li>
<li><a href='#powerMediation.Sobel'>
<p>Power for testing mediation effect  (Sobel's test)</p></a></li>
<li><a href='#powerMediation.VSMc'>
<p>Power for testing mediation effect in linear regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#powerMediation.VSMc.cox'>
<p>Power for testing mediation effect in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#powerMediation.VSMc.logistic'>
<p>Power for testing mediation effect in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#powerMediation.VSMc.poisson'>
<p>Power for testing mediation effect in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#powerPoisson'>
<p>Power calculation for simple Poisson regression</p></a></li>
<li><a href='#sizePoisson'>
<p>Sample size calculation for simple Poisson regression</p></a></li>
<li><a href='#ss.SLR'>
<p>Sample size for testing slope for simple linear regression</p></a></li>
<li><a href='#ss.SLR.rho'>
<p>Sample size for testing slope for simple linear regression based on R2</p></a></li>
<li><a href='#SSizeLogisticBin'>
<p>Calculating sample size for simple logistic regression with binary predictor</p></a></li>
<li><a href='#SSizeLogisticCon'>
<p>Calculating sample size for simple logistic regression with continuous predictor</p></a></li>
<li><a href='#ssLong'>
<p>Sample size calculation for longitudinal study with 2 time point</p></a></li>
<li><a href='#ssLong.multiTime'>
<p>Sample size calculation for testing if mean changes for 2 groups are the</p>
same or not for longitudinal study with more than 2 time points</a></li>
<li><a href='#ssLongFull'>
<p>Sample size calculation for longitudinal study with 2 time point</p></a></li>
<li><a href='#ssMediation.Sobel'>
<p>Sample size for testing mediation effectd (Sobel's test)</p></a></li>
<li><a href='#ssMediation.VSMc'>
<p>Sample size for testing mediation effect in linear regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#ssMediation.VSMc.cox'>
<p>Sample size for testing mediation effect in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#ssMediation.VSMc.logistic'>
<p>Sample size for testing mediation effect in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#ssMediation.VSMc.poisson'>
<p>Sample size for testing mediation effect in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method</p></a></li>
<li><a href='#testMediation.Sobel'>
<p>P-value and confidence interval for testing mediation effect  (Sobel's test)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.3.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-03-22</td>
</tr>
<tr>
<td>Title:</td>
<td>Power/Sample Size Calculation for Mediation Analysis</td>
</tr>
<tr>
<td>Author:</td>
<td>Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to 
        calculate power and sample size for testing
        (1) mediation effects; 
        (2) the slope in a simple linear regression; 
        (3) odds ratio in a simple logistic regression;
        (4) mean change for longitudinal study with 2 time points;
        (5) interaction effect in 2-way ANOVA; and
        (6) the slope in a simple Poisson regression.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-23 01:23:12 UTC; kunling</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-23 14:20:02 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='minEffect.SLR'>
Minimum detectable slope
</h2><span id='topic+minEffect.SLR'></span>

<h3>Description</h3>

<p>Calculate minimal detectable slope given sample size and power for simple linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minEffect.SLR(n, 
              power, 
              sigma.x, 
              sigma.y, 
              alpha = 0.05, 
              verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="minEffect.SLR_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="minEffect.SLR_+3A_power">power</code></td>
<td>

<p>power for testing if <code class="reqn">\lambda=0</code> for the simple linear regression 
<code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_{e}^2).</code>
</p>
</td></tr>
<tr><td><code id="minEffect.SLR_+3A_sigma.x">sigma.x</code></td>
<td>

<p>standard deviation of the predictor <code class="reqn">sd(x)=\sigma_x</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.SLR_+3A_sigma.y">sigma.y</code></td>
<td>

<p>marginal standard deviation of the outcome <code class="reqn">sd(y)=\sigma_y</code>.
(not the conditional standard deviation <code class="reqn">sd(y|x)</code>)
</p>
</td></tr>
<tr><td><code id="minEffect.SLR_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="minEffect.SLR_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing minimum absolute detectable effect; <code>FALSE</code> means not printing minimum absolute detectable effect.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\lambda\neq 0</code>
for the simple linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>lambda.a</code></td>
<td>
<p>minimum absolute detectable effect.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal minimum absolute detectable effect.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Dupont, W.D. and Plummer, W.D..
Power and Sample Size Calculations for Studies Involving Linear Regression.
<em>Controlled Clinical Trials</em>. 1998;19:589-601.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.SLR">power.SLR</a></code>,
<code><a href="#topic+power.SLR.rho">power.SLR.rho</a></code>,
<code><a href="#topic+ss.SLR">ss.SLR</a></code>,
<code><a href="#topic+ss.SLR.rho">ss.SLR.rho</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  minEffect.SLR(n = 100, power = 0.8, sigma.x = 0.2, sigma.y = 0.5, 
    alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='minEffect.VSMc'>
Minimum detectable slope for mediator in linear regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+minEffect.VSMc'></span>

<h3>Description</h3>

<p>Calculate minimal detectable slope for mediator given sample size and power in simple linear regression based on Vittinghoff, Sen and McCulloch's (2009) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minEffect.VSMc(n, 
               power, 
               sigma.m, 
               sigma.e, 
               corr.xm, 
               alpha = 0.05, 
               verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="minEffect.VSMc_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc_+3A_power">power</code></td>
<td>

<p>power for testing <code class="reqn">b_2=0</code> for the linear regression <code class="reqn">y_i=b0+b1 x_i + b2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_e^2)</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc_+3A_sigma.e">sigma.e</code></td>
<td>

<p>standard deviation of the random error term in the linear regression
<code class="reqn">y_i=b0+b1 x_i + b2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_e^2)</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing minimum absolute detectable effect; <code>FALSE</code> means not printing minimum absolute detectable effect.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + b_2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above linear regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>, if the
correlation <code>corr.xm</code> between the primary predictor and mediator is non-zero.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + b_2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>b2</code></td>
<td>
<p>minimum absolute detectable effect.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerMediation.VSMc">powerMediation.VSMc</a></code>,
<code><a href="#topic+ssMediation.VSMc">ssMediation.VSMc</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 3 (page 544) of Vittinghoff et al. (2009).
  # minimum effect is =0.1
  minEffect.VSMc(n = 863, power = 0.8, sigma.m = 1, 
    sigma.e = 1, corr.xm = 0.3, alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='minEffect.VSMc.cox'>
Minimum detectable slope for mediator in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+minEffect.VSMc.cox'></span>

<h3>Description</h3>

<p>Calculate minimal detectable slope for mediator given sample size and power in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minEffect.VSMc.cox(n, 
                   power, 
                   sigma.m, 
                   psi, 
                   corr.xm, 
                   alpha = 0.05, 
                   verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="minEffect.VSMc.cox_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.cox_+3A_power">power</code></td>
<td>

<p>power for testing <code class="reqn">b_2=0</code> for the cox regression <code class="reqn">\log(\lambda)=\log(\lambda_0)+b1 x_i + b2 m_i</code>, where <code class="reqn">\lambda</code> is the hazard function and
<code class="reqn">\lambda_0</code> is the baseline hazard function.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.cox_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.cox_+3A_psi">psi</code></td>
<td>

<p>the probability that an observation is uncensored, so that
the number of event <code class="reqn">d= n * psi</code>, where <code class="reqn">n</code> is the sample size.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.cox_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.cox_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.cox_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing minimum absolute detectable effect; <code>FALSE</code> means not printing minimum absolute detectable effect.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the cox regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i + b_2 m_i </code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above cox regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>, if the
correlation <code>corr.xm</code> between the primary predictor and mediator is non-zero.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i </code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>b2</code></td>
<td>
<p>minimum absolute detectable effect.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerMediation.VSMc.cox">powerMediation.VSMc.cox</a></code>,
<code><a href="#topic+ssMediation.VSMc.cox">ssMediation.VSMc.cox</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 6 (page 547) of Vittinghoff et al. (2009).
  # minimum effect is = log(1.5) = 0.4054651

  minEffect.VSMc.cox(n = 1399, power = 0.7999916, 
    sigma.m = sqrt(0.25 * (1 - 0.25)), psi = 0.2, corr.xm = 0.3, 
    alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='minEffect.VSMc.logistic'>
Minimum detectable slope for mediator in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+minEffect.VSMc.logistic'></span>

<h3>Description</h3>

<p>Calculate minimal detectable slope for mediator given sample size and power in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minEffect.VSMc.logistic(n, 
                        power, 
                        sigma.m, 
                        p, 
                        corr.xm, 
                        alpha = 0.05, 
                        verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="minEffect.VSMc.logistic_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.logistic_+3A_power">power</code></td>
<td>

<p>power for testing <code class="reqn">b_2=0</code> for the logistic regression <code class="reqn">\log(p_i/(1-p_i))=b0+b1 x_i + b2 m_i</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.logistic_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.logistic_+3A_p">p</code></td>
<td>

<p>the marginal prevalence of the outcome.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.logistic_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.logistic_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.logistic_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing minimum absolute detectable effect; <code>FALSE</code> means not printing minimum absolute detectable effect.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the logistic regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b_0+b_1 x_i + b_2 m_i </code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above logistic regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>, if the
correlation <code>corr.xm</code> between the primary predictor and mediator is non-zero.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b_0+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b_0+b_1 x_i</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>b2</code></td>
<td>
<p>minimum absolute detectable effect.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerMediation.VSMc.logistic">powerMediation.VSMc.logistic</a></code>,
<code><a href="#topic+ssMediation.VSMc.logistic">ssMediation.VSMc.logistic</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 4 (page 545) of Vittinghoff et al. (2009).
  # minimum effect is log(1.5)= 0.4054651 

  minEffect.VSMc.logistic(n = 255, power = 0.8, sigma.m = 1, 
    p = 0.5, corr.xm = 0.5, alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='minEffect.VSMc.poisson'>
Minimum detectable slope for mediator in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+minEffect.VSMc.poisson'></span>

<h3>Description</h3>

<p>Calculate minimal detectable slope for mediator given sample size and power in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minEffect.VSMc.poisson(n, 
                       power, 
                       sigma.m, 
                       EY, 
                       corr.xm, 
                       alpha = 0.05, 
                       verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="minEffect.VSMc.poisson_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.poisson_+3A_power">power</code></td>
<td>

<p>power for testing <code class="reqn">b_2=0</code> for the poisson regression <code class="reqn">\log(E(Y_i))=b0+b1 x_i + b2 m_i</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.poisson_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.poisson_+3A_ey">EY</code></td>
<td>

<p>the marginal mean of the outcome
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.poisson_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.poisson_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="minEffect.VSMc.poisson_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing minimum absolute detectable effect; <code>FALSE</code> means not printing minimum absolute detectable effect.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the poisson regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b_0+b_1 x_i + b_2 m_i </code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above poisson regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>, if the
correlation <code>corr.xm</code> between the primary predictor and mediator is non-zero.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b_0+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b_0+b_1 x_i</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>b2</code></td>
<td>
<p>minimum absolute detectable effect.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerMediation.VSMc.poisson">powerMediation.VSMc.poisson</a></code>,
<code><a href="#topic+ssMediation.VSMc.poisson">ssMediation.VSMc.poisson</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 5 (page 546) of Vittinghoff et al. (2009).
  # minimum effect is = log(1.35) = 0.3001046
  minEffect.VSMc.poisson(n = 1239, power = 0.7998578, 
    sigma.m = sqrt(0.25 * (1 - 0.25)), 
    EY = 0.5, corr.xm = 0.5, 
    alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='power.SLR'>
Power for testing slope for simple linear regression
</h2><span id='topic+power.SLR'></span>

<h3>Description</h3>

<p>Calculate power for testing slope for simple linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.SLR(n, 
          lambda.a, 
          sigma.x, 
          sigma.y, 
          alpha = 0.05, 
          verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.SLR_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="power.SLR_+3A_lambda.a">lambda.a</code></td>
<td>

<p>regression coefficient in the simple linear regression 
<code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_{e}^2).</code>
</p>
</td></tr>
<tr><td><code id="power.SLR_+3A_sigma.x">sigma.x</code></td>
<td>

<p>standard deviation of the predictor <code class="reqn">sd(x)</code>.
</p>
</td></tr>
<tr><td><code id="power.SLR_+3A_sigma.y">sigma.y</code></td>
<td>

<p>marginal standard deviation of the outcome <code class="reqn">sd(y)</code>.
(not the marginal standard deviation <code class="reqn">sd(y|x)</code>)
</p>
</td></tr>
<tr><td><code id="power.SLR_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="power.SLR_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power is for testing the null hypothesis <code class="reqn">\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\lambda\neq 0</code>
for the simple linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>power for testing if <code class="reqn">b_2=0</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p><code class="reqn">\lambda\sigma_x\sqrt{n}/\sqrt{\sigma_y^2-(\lambda\sigma_x)^2}</code>.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p><code class="reqn">\sqrt{\sigma_y^2-(\lambda\sigma_x)^2}</code>.</p>
</td></tr>
<tr><td><code>t.cr</code></td>
<td>
<p><code class="reqn">\Phi^{-1}(1-\alpha/2)</code>, where <code class="reqn">\Phi</code> is the cumulative distribution function of the standard normal distribution.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>correlation between the predictor <code class="reqn">x</code> and outcome <code class="reqn">y</code>
<code class="reqn">=\lambda\sigma_x/\sigma_y</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Dupont, W.D. and Plummer, W.D..
Power and Sample Size Calculations for Studies Involving Linear Regression.
<em>Controlled Clinical Trials</em>. 1998;19:589-601.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.SLR">minEffect.SLR</a></code>,
<code><a href="#topic+power.SLR.rho">power.SLR.rho</a></code>,
<code><a href="#topic+ss.SLR.rho">ss.SLR.rho</a></code>,
<code><a href="#topic+ss.SLR">ss.SLR</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  power.SLR(n=100, lambda.a=0.8, sigma.x=0.2, sigma.y=0.5, 
    alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='power.SLR.rho'>
Power for testing slope for simple linear regression
</h2><span id='topic+power.SLR.rho'></span>

<h3>Description</h3>

<p>Calculate power for testing slope for simple linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.SLR.rho(n, 
              rho2, 
              alpha = 0.05, 
              verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.SLR.rho_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="power.SLR.rho_+3A_rho2">rho2</code></td>
<td>

<p>square of the correlation between the outcome and the predictor.
</p>
</td></tr>
<tr><td><code id="power.SLR.rho_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="power.SLR.rho_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power is for testing the null hypothesis <code class="reqn">\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\lambda\neq 0</code>
for the simple linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>power for testing if <code class="reqn">b_2=0</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p><code class="reqn">\sqrt{n}/\sqrt{1/\rho^2-1}</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Dupont, W.D. and Plummer, W.D..
Power and Sample Size Calculations for Studies Involving Linear Regression.
<em>Controlled Clinical Trials</em>. 1998;19:589-601.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.SLR">minEffect.SLR</a></code>,
<code><a href="#topic+power.SLR">power.SLR</a></code>,
<code><a href="#topic+ss.SLR.rho">ss.SLR.rho</a></code>,
<code><a href="#topic+ss.SLR">ss.SLR</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  power.SLR.rho(n=100, rho2=0.6, alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='powerInteract2by2'>
Power Calculation for Interaction Effect in 2x2 Two-Way ANOVA Given Effect Sizes
</h2><span id='topic+powerInteract2by2'></span>

<h3>Description</h3>

<p>Power calculation for interaction effect in 2x2 two-way ANOVA given effect sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerInteract2by2(n, tauBetaSigma, alpha = 0.05, nTests = 1, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerInteract2by2_+3A_n">n</code></td>
<td>

<p>integer. Number of subjects per group.
</p>
</td></tr>
<tr><td><code id="powerInteract2by2_+3A_taubetasigma">tauBetaSigma</code></td>
<td>

<p>Effect sizes <code class="reqn">\left(\tau\beta\right)_{ij}/\sigma, i=1, \ldots, a, j=1,\ldots, b</code>, where <code class="reqn">a=b=2</code> and <code class="reqn">\sigma</code> is
the standard deviation of random error. Rows are for factor 1 and columns are for factor 2.  Note that <code class="reqn">\sum_{i=1}^a \left(\tau\beta\right)_{ij} = \sum_{j=1}^b \left(\tau\beta\right)_{ij}=0</code>. We can get
<code class="reqn">\left(\tau\beta\right)_{11}=\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{12}=-\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{21}=-\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{22}=\theta</code>. So
<code>tauBetaSigma=</code><code class="reqn">\theta/\sigma</code>
</p>
</td></tr>
<tr><td><code id="powerInteract2by2_+3A_alpha">alpha</code></td>
<td>

<p>family-wise type I error rate.
</p>
</td></tr>
<tr><td><code id="powerInteract2by2_+3A_ntests">nTests</code></td>
<td>

<p>integer. For high-throughput omics study, 
we perform two-way ANOVA for each of 'nTests' probes.
We use Bonferroni correction to control for family-wise type I error rate.
That is, for each probe, type I error rate would be <code>alpha/nTests</code>.
</p>
</td></tr>
<tr><td><code id="powerInteract2by2_+3A_verbose">verbose</code></td>
<td>

<p>logical. Indicating if intermediate results should be printed out.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume the following model:
</p>
<p style="text-align: center;"><code class="reqn">y_{ijk}=\mu+\tau_i + \beta_j + \left(\tau\beta\right)_{ij} + \epsilon_{ijk},</code>
</p>

<p>where <code class="reqn">i=1,\ldots, a, j=1,\ldots, b, k=1, \ldots, n</code>, <code class="reqn">\sum_{i=1}^{a}\tau_i = 0</code>, 
<code class="reqn">\sum_{j=1}^{b}\beta_j = 0</code>, <code class="reqn">\sum_{i=1}^{a} \left(\tau\beta\right)_{ij} = 0</code>,
<code class="reqn">\sum_{j=1}^{b} \left(\tau\beta\right)_{ij} = 0</code>,
and <code class="reqn">\epsilon_{ijk}\stackrel{i.i.d}{\sim} N\left(0, \sigma^2\right)</code>. 
</p>
<p>The group means are
</p>
<p style="text-align: center;"><code class="reqn">\mu_{ij} = \mu+\tau_i + \beta_j + \left(\tau\beta\right)_{ij}, i=1 \ldots, a,
j=1,\ldots, b.</code>
</p>

<p>Note that <code class="reqn">\mu = \sum_{i=1}^{a}\sum_{j=1}^b \mu_{ij} / (ab)</code>,
<code class="reqn">\tau_i = \sum_{j=1}^b \mu_{ij}/b - \mu</code>, and 
<code class="reqn">\beta_j = \sum_{i=1}^a \mu_{ij}/a - \mu</code>.
</p>
<p>The null hypothesis <code class="reqn">H_0</code>: all <code class="reqn">\left(\tau\beta\right)_{ij}, i=1, \ldots, a, j=1,\ldots, b</code> are equal to zero.
The alternative hypothesis <code class="reqn">H_a</code>: at least one <code class="reqn">\left(\tau\beta\right)_{ij}</code> is different from zero.
</p>
<p>The F test statistic is </p>
<p style="text-align: center;"><code class="reqn">F=MS_{AB}/MS_{E}\stackrel{H_a}{\sim} F_{(a-1)(b-1), ab(n - 1), ncp},</code>
</p>

<p>where <code>ncp</code> is the 
non-centrality parameter of the F test statistic:
</p>
<p style="text-align: center;"><code class="reqn">ncp=n\sum_{i=1}^{a}\sum_{j=1}^{b}\left[\frac{\left(\tau\beta\right)_{ij}}{\sigma}\right]^2.</code>
</p>

<p>For the scenario <code class="reqn">a=b=2</code>, we have 
<code class="reqn">\left(\tau\beta\right)_{11}=\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{12}=-\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{21}=-\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{22}=\theta</code>. 
Hence,
the non-centrality parameter can be simplified to
</p>
<p style="text-align: center;"><code class="reqn">ncp=4n\left(\frac{\theta}{\sigma}\right)^2.</code>
</p>

<p>The power for testing the null hypothesis <code class="reqn">H_0</code> versus
the alternative hypothesis <code class="reqn">H_a</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=Pr\left(F &gt; F_0 | H_a\right),</code>
</p>
 
<p>where the rejection region boundary <code class="reqn">F_0</code> satisfies:
</p>
<p style="text-align: center;"><code class="reqn">Pr\left(F &gt; F_0 | H_0\right) = \alpha/nTests.</code>
</p>



<h3>Value</h3>

<p>A list with 5 elements:
</p>
<table>
<tr><td><code>power</code></td>
<td>
<p>the power of the two-way ANOVA test</p>
</td></tr>
<tr><td><code>df1</code></td>
<td>
<p>the first degree of freedom of the F test statistic (<code>df1=(a-1)(b-1)</code>)</p>
</td></tr>
<tr><td><code>df2</code></td>
<td>
<p>the second degree of freedom of the F test statistic (<code>df1=a*b(n-1)</code>)</p>
</td></tr>
<tr><td><code>F0</code></td>
<td>
<p>the rejection region boundary</p>
</td></tr>
<tr><td><code>ncp</code></td>
<td>
<p>the non-centrality parameter</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:weiliang.qiu@gmail.com">weiliang.qiu@gmail.com</a>
</p>


<h3>References</h3>

<p>Chow SC, Shao J, and Wang H. 
Sample size calculations in clinical research. 2nd edition.
Chapman &amp; Hall/CRC. 2008
</p>
<p>Montgomery DC.
Design and Analysis of Experiments. 8th edition.
John Wiley &amp; Sons. Inc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 25
tauBetaSigma = 0.3

# power = 0.8437275
res2 = powerInteract2by2(n = n, tauBetaSigma = tauBetaSigma, 
    alpha = 0.05, nTests = 1, verbose = TRUE)

</code></pre>

<hr>
<h2 id='powerLogisticBin'>
Calculating power for simple logistic regression with binary predictor
</h2><span id='topic+powerLogisticBin'></span>

<h3>Description</h3>

<p>Calculating power for simple logistic regression with binary predictor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerLogisticBin(n, 
                 p1, 
                 p2, 
                 B, 
                 alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerLogisticBin_+3A_n">n</code></td>
<td>

<p>total number of sample size.
</p>
</td></tr>
<tr><td><code id="powerLogisticBin_+3A_p1">p1</code></td>
<td>

<p><code class="reqn">pr(diseased|X=0)</code>, i.e. the event rate at <code class="reqn">X=0</code> in logistic regression
<code class="reqn">logit(p) = a + b X</code>, where <code class="reqn">X</code> is the binary predictor.
</p>
</td></tr>
<tr><td><code id="powerLogisticBin_+3A_p2">p2</code></td>
<td>

<p><code class="reqn">pr(diseased|X=1)</code>, the event rate at <code class="reqn">X=1</code> in logistic regression
<code class="reqn">logit(p) = a + b X</code>, where <code class="reqn">X</code> is the binary predictor.
</p>
</td></tr>
<tr><td><code id="powerLogisticBin_+3A_b">B</code></td>
<td>

<p><code class="reqn">pr(X=1)</code>, i.e. proportion of the sample with <code class="reqn">X=1</code>
</p>
</td></tr>
<tr><td><code id="powerLogisticBin_+3A_alpha">alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The logistic regression mode is
</p>
<p style="text-align: center;"><code class="reqn">
\log(p/(1-p)) = \beta_0 + \beta_1 X
</code>
</p>

<p>where <code class="reqn">p=prob(Y=1)</code>, <code class="reqn">X</code> is the binary predictor, <code class="reqn">p_1=pr(diseased | X=0)</code>,
<code class="reqn">p_2=pr(diseased| X = 1)</code>, <code class="reqn">B=pr(X=1)</code>, and <code class="reqn">p = (1 - B) p_1+B p_2</code>.
The sample size formula we used for testing if <code class="reqn">\beta_1=0</code>, is Formula (2) in Hsieh et al. (1998):
</p>
<p style="text-align: center;"><code class="reqn">
n=(Z_{1-\alpha/2}[p(1-p)/B]^{1/2} + Z_{power}[p_1(1-p_1)+p_2(1-p_2)(1-B)/B]^{1/2})^2/[ (p_1-p_2)^2 (1-B) ]
</code>
</p>

<p>where <code class="reqn">n</code> is the required total sample size and <code class="reqn">Z_u</code> is the <code class="reqn">u</code>-th
percentile of the standard normal distribution.
</p>


<h3>Value</h3>

<p>Estimated power.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Hsieh, FY, Bloch, DA, and Larsen, MD.
A SIMPLE METHOD OF SAMPLE SIZE CALCULATION FOR LINEAR AND LOGISTIC REGRESSION.
<em>Statistics in Medicine</em>. 1998; 17:1623-1634.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerLogisticBin">powerLogisticBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    ## Example in Table I Design (Balanced design with high event rates) 
    ## of Hsieh et al. (1998 )
    ## the power = 0.95
    powerLogisticBin(n = 1281, p1 = 0.4, p2 = 0.5, B = 0.5, alpha = 0.05)
</code></pre>

<hr>
<h2 id='powerLogisticCon'>
Calculating power for simple logistic regression with continuous predictor
</h2><span id='topic+powerLogisticCon'></span>

<h3>Description</h3>

<p>Calculating power for simple logistic regression with continuous predictor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerLogisticCon(n, 
                 p1, 
                 OR, 
                 alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerLogisticCon_+3A_n">n</code></td>
<td>

<p>total sample size.
</p>
</td></tr>
<tr><td><code id="powerLogisticCon_+3A_p1">p1</code></td>
<td>

<p>the event rate at the mean of the continuous predictor <code class="reqn">X</code> in logistic regression
<code class="reqn">logit(p) = a + b X</code>.
</p>
</td></tr>
<tr><td><code id="powerLogisticCon_+3A_or">OR</code></td>
<td>

<p>Expected odds ratio. <code class="reqn">\log(OR)</code> is the change in log odds for the difference between at the mean of <code class="reqn">X</code> and at one SD above the mean.
</p>
</td></tr>
<tr><td><code id="powerLogisticCon_+3A_alpha">alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The logistic regression mode is
</p>
<p style="text-align: center;"><code class="reqn">
\log(p/(1-p)) = \beta_0 + \beta_1 X
</code>
</p>

<p>where <code class="reqn">p=prob(Y=1)</code>, <code class="reqn">X</code> is the continuous predictor, and <code class="reqn">\log(OR)</code> is the
the change in log odds for the difference between at the mean of <code class="reqn">X</code> and at one SD above the mean.
The sample size formula we used for testing if <code class="reqn">\beta_1=0</code> or equivalently
<code class="reqn">OR=1</code>, is Formula (1) in Hsieh et al. (1998):
</p>
<p style="text-align: center;"><code class="reqn">
n=(Z_{1-\alpha/2} + Z_{power})^2/[ p_1 (1-p_1) [log(OR)]^2 ]
</code>
</p>

<p>where <code class="reqn">n</code> is the required total sample size, <code class="reqn">OR</code> is the
odds ratio to be tested, <code class="reqn">p_1</code> is the event rate at the mean
of the predictor <code class="reqn">X</code>, and <code class="reqn">Z_u</code> is the <code class="reqn">u</code>-th
percentile of the standard normal distribution.
</p>


<h3>Value</h3>

<p>Estimated power.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Hsieh, FY, Bloch, DA, and Larsen, MD.
A SIMPLE METHOD OF SAMPLE SIZE CALCULATION FOR LINEAR AND LOGISTIC REGRESSION.
<em>Statistics in Medicine</em>. 1998; 17:1623-1634.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SSizeLogisticCon">SSizeLogisticCon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    ## Example in Table II Design (Balanced design (1)) of Hsieh et al. (1998 )
    ## the power is 0.95
    powerLogisticCon(n=317, p1=0.5, OR=exp(0.405), alpha=0.05)
</code></pre>

<hr>
<h2 id='powerLong'>
Power calculation for longitudinal study with 2 time point
</h2><span id='topic+powerLong'></span>

<h3>Description</h3>

<p>Power calculation for testing if mean changes for 2 groups are the same or not for longitudinal study with 2 time point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerLong(es, 
          n, 
          rho = 0.5, 
          alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerLong_+3A_es">es</code></td>
<td>

<p>effect size of the difference of mean change.
</p>
</td></tr>
<tr><td><code id="powerLong_+3A_n">n</code></td>
<td>

<p>sample size per group.
</p>
</td></tr>
<tr><td><code id="powerLong_+3A_rho">rho</code></td>
<td>

<p>correlation coefficient between baseline and follow-up values within a treatment group.
</p>
</td></tr>
<tr><td><code id="powerLong_+3A_alpha">alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power formula is based on Equation 8.31 on page 336 of Rosner (2006).
</p>
<p style="text-align: center;"><code class="reqn">
power=\Phi\left(-Z_{1-\alpha/2}+\frac{\delta\sqrt{n}}{\sigma_d \sqrt{2}}\right)
</code>
</p>

<p>where <code class="reqn">\sigma_d = \sigma_1^2+\sigma_2^2-2\rho\sigma_1\sigma_2</code>, <code class="reqn">\delta=|\mu_1 - \mu_2|</code>,
<code class="reqn">\mu_1</code> is the mean change over time <code class="reqn">t</code> in group 1, 
<code class="reqn">\mu_2</code> is the mean change over time <code class="reqn">t</code> in group 2, 
<code class="reqn">\sigma_1^2</code> is the variance of baseline values within a treatment group,
<code class="reqn">\sigma_2^2</code> is the variance of follow-up values within a treatment group,
<code class="reqn">\rho</code> is the correlation coefficient between baseline and follow-up values within a treatment group,
and <code class="reqn">Z_u</code> is the u-th percentile of the standard normal distribution.
</p>
<p>We wish to test <code class="reqn">\mu_1 = \mu_2</code>.
</p>
<p>When <code class="reqn">\sigma_1=\sigma_2=\sigma</code>, then formula reduces to
</p>
<p style="text-align: center;"><code class="reqn">
power=\Phi\left(-Z_{1-\alpha/2} + \frac{|d|\sqrt{n}}{2\sqrt{1-\rho}}\right)
</code>
</p>

<p>where <code class="reqn">d=\delta/\sigma</code>.
</p>


<h3>Value</h3>

<p>power for testing for difference of mean changes.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Rosner, B.
<em>Fundamentals of Biostatistics</em>. Sixth edition. Thomson Brooks/Cole. 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssLong">ssLong</a></code>, <code><a href="#topic+ssLongFull">ssLongFull</a></code>, 
<code><a href="#topic+powerLongFull">powerLongFull</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example 8.34 on page 336 of Rosner (2006)
    # power=0.75
    powerLong(es=5/15, n=75, rho=0.7, alpha=0.05)

</code></pre>

<hr>
<h2 id='powerLong.multiTime'>
Power calculation for testing if mean changes for 2 groups are the
same or not for longitudinal study with more than 2 time points
</h2><span id='topic+powerLong.multiTime'></span>

<h3>Description</h3>

<p>Power calculation for testing if mean changes for 2 groups are the
same or not for longitudinal study with more than 2 time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerLong.multiTime(es, m, nn, sx2, rho = 0.5, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerLong.multiTime_+3A_es">es</code></td>
<td>

<p>effect size
</p>
</td></tr>
<tr><td><code id="powerLong.multiTime_+3A_m">m</code></td>
<td>

<p>number of subjects
</p>
</td></tr>
<tr><td><code id="powerLong.multiTime_+3A_nn">nn</code></td>
<td>

<p>number of observations per subject
</p>
</td></tr>
<tr><td><code id="powerLong.multiTime_+3A_sx2">sx2</code></td>
<td>

<p>within subject variance
</p>
</td></tr>
<tr><td><code id="powerLong.multiTime_+3A_rho">rho</code></td>
<td>

<p>within subject correlation
</p>
</td></tr>
<tr><td><code id="powerLong.multiTime_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We are interested in comparing the slopes of the 2 groups <code class="reqn">A</code> and <code class="reqn">B</code>:
</p>
<p style="text-align: center;"><code class="reqn">
\beta_{1A} = \beta_{1B}
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
Y_{ijA}=\beta_{0A}+\beta_{1A} x_{jA} + \epsilon_{ijA}, j=1, \ldots, nn; i=1, \ldots, m
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
Y_{ijB}=\beta_{0B}+\beta_{1B} x_{jB} + \epsilon_{ijB}, j=1, \ldots, nn; i=1, \ldots, m
</code>
</p>

<p>The power calculation formula is (Equation on page 30 of Diggle et al. (1994)):
</p>
<p style="text-align: center;"><code class="reqn">
power=\Phi\left[
-z_{1-\alpha} + \sqrt{\frac{m nn s_x^2 es^2}{2(1-\rho)}}
\right]
</code>
</p>

<p>where <code class="reqn">es=d/\sigma</code>, <code class="reqn">d</code> is the meaninful differnce of interest, 
<code class="reqn">sigma^2</code> is the variance of the random error, 
<code class="reqn">\rho</code> is the within-subject correlation, and
<code class="reqn">s_x^2</code> is the within-subject variance.
</p>


<h3>Value</h3>

<p>power
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Diggle PJ, Liang KY, and Zeger SL (1994). 
Analysis of Longitundinal Data.  page 30.
Clarendon Press, Oxford
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssLong.multiTime">ssLong.multiTime</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # power=0.8
  powerLong.multiTime(es=0.5/10, m=196, nn=3, sx2=4.22, rho = 0.5, alpha = 0.05)
</code></pre>

<hr>
<h2 id='powerLongFull'>
Power calculation for longitudinal study with 2 time point
</h2><span id='topic+powerLongFull'></span>

<h3>Description</h3>

<p>Power calculation for testing if mean changes for 2 groups are the same or not for longitudinal study with 2 time point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerLongFull(delta, 
              sigma1, 
              sigma2, 
              n, 
              rho = 0.5, 
              alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerLongFull_+3A_delta">delta</code></td>
<td>

<p>absolute difference of the mean changes between the two groups: <code class="reqn">\delta=|\mu_1 - \mu_2|</code> where
<code class="reqn">\mu_1</code> is the mean change over time <code class="reqn">t</code> in group 1, 
<code class="reqn">\mu_2</code> is the mean change over time <code class="reqn">t</code> in group 2. 
</p>
</td></tr>
<tr><td><code id="powerLongFull_+3A_sigma1">sigma1</code></td>
<td>

<p>the standard deviation of baseline values within a treatment group
</p>
</td></tr>
<tr><td><code id="powerLongFull_+3A_sigma2">sigma2</code></td>
<td>

<p>the standard deviation of follow-up values within a treatment group
</p>
</td></tr>
<tr><td><code id="powerLongFull_+3A_n">n</code></td>
<td>

<p>sample size per group
</p>
</td></tr>
<tr><td><code id="powerLongFull_+3A_rho">rho</code></td>
<td>

<p>correlation coefficient between baseline and follow-up values within a treatment group.
</p>
</td></tr>
<tr><td><code id="powerLongFull_+3A_alpha">alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power formula is based on Equation 8.31 on page 336 of Rosner (2006).
</p>
<p style="text-align: center;"><code class="reqn">
power=\Phi\left(-Z_{1-\alpha/2}+\frac{\delta\sqrt{n}}{\sigma_d \sqrt{2}}\right)
</code>
</p>

<p>where <code class="reqn">\sigma_d = \sigma_1^2+\sigma_2^2-2\rho\sigma_1\sigma_2</code>, <code class="reqn">\delta=|\mu_1 - \mu_2|</code>,
<code class="reqn">\mu_1</code> is the mean change over time <code class="reqn">t</code> in group 1, 
<code class="reqn">\mu_2</code> is the mean change over time <code class="reqn">t</code> in group 2, 
<code class="reqn">\sigma_1^2</code> is the variance of baseline values within a treatment group,
<code class="reqn">\sigma_2^2</code> is the variance of follow-up values within a treatment group,
<code class="reqn">\rho</code> is the correlation coefficient between baseline and follow-up values within a treatment group,
and <code class="reqn">Z_u</code> is the u-th percentile of the standard normal distribution.
</p>
<p>We wish to test <code class="reqn">\mu_1 = \mu_2</code>.
</p>


<h3>Value</h3>

<p>power for testing for difference of mean changes.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Rosner, B.
<em>Fundamentals of Biostatistics</em>. Sixth edition. Thomson Brooks/Cole. 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssLong">ssLong</a></code>, <code><a href="#topic+ssLongFull">ssLongFull</a></code>, 
<code><a href="#topic+powerLong">powerLong</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example 8.33 on page 336 of Rosner (2006)
    # power=0.80
    powerLongFull(delta=5, sigma1=15, sigma2=15, n=85, rho=0.7, alpha=0.05)
</code></pre>

<hr>
<h2 id='powerMediation.Sobel'>
Power for testing mediation effect  (Sobel's test)
</h2><span id='topic+powerMediation.Sobel'></span>

<h3>Description</h3>

<p>Calculate power for testing mediation effect based on Sobel's test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerMediation.Sobel(n, 
                     theta.1a, 
                     lambda.a, 
                     sigma.x, 
                     sigma.m,
                     sigma.epsilon, 
                     alpha = 0.05, 
                     verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerMediation.Sobel_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="powerMediation.Sobel_+3A_theta.1a">theta.1a</code></td>
<td>

<p>regression coefficient for the predictor in the linear regression linking
the predictor <code class="reqn">x</code> to the mediator <code class="reqn">m</code> (<code class="reqn">m_i=\theta_0+\theta_{1a} x_i + e_i, e_i\sim N(0, \sigma^2_e)</code>).
</p>
</td></tr>
<tr><td><code id="powerMediation.Sobel_+3A_lambda.a">lambda.a</code></td>
<td>

<p>regression coefficient for the mediator in the linear regression linking
the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code> to the outcome <code class="reqn">y</code> (<code class="reqn">y_i=\gamma+\lambda_{a} m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>).
</p>
</td></tr>
<tr><td><code id="powerMediation.Sobel_+3A_sigma.x">sigma.x</code></td>
<td>

<p>standard deviation of the predictor.
</p>
</td></tr>
<tr><td><code id="powerMediation.Sobel_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="powerMediation.Sobel_+3A_sigma.epsilon">sigma.epsilon</code></td>
<td>

<p>standard deviation of the random error term 
in the linear regression linking
the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code> to the outcome <code class="reqn">y</code> (<code class="reqn">y_i=\gamma+\lambda_a m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>).
</p>
</td></tr>
<tr><td><code id="powerMediation.Sobel_+3A_alpha">alpha</code></td>
<td>

<p>type I error.
</p>
</td></tr>
<tr><td><code id="powerMediation.Sobel_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power is for testing the null hypothesis <code class="reqn">\theta_1\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\theta_{1a}\lambda_a\neq 0</code>
for the linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">m_i=\theta_0+\theta_{1a} x_i + e_i, e_i\sim N(0, \sigma^2_e)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_i=\gamma+\lambda_a m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>
</p>

<p>Test statistic is based on Sobel's (1982) test:
</p>
<p style="text-align: center;"><code class="reqn">Z=\frac{\hat{\theta}_{1a}\hat{\lambda_a}}{\hat{\sigma}_{\theta_{1a}\lambda_a}}
</code>
</p>

<p>where <code class="reqn">\hat{\sigma}_{\theta_{1a}\lambda_a}</code> is the estimated standard deviation
of the estimate <code class="reqn">\hat{\theta}_{1a}\hat{\lambda_a}</code> using multivariate
delta method: 
</p>
<p style="text-align: center;"><code class="reqn">\sigma_{\theta_{1a}\lambda_a}=\sqrt{\theta_{1a}^2\sigma_{\lambda_a}^2+\lambda_a^2\sigma_{\theta_{1a}}^2}</code>
</p>

<p>and
<code class="reqn">\sigma_{\theta_{1a}}^2=\sigma_e^2/(n\sigma_x^2)</code> is the 
variance
of the estimate <code class="reqn">\hat{\theta}_{1a}</code>, and
<code class="reqn">\sigma_{\lambda_a}^2=\sigma_{\epsilon}^2/(n\sigma_m^2(1-\rho_{mx}^2))</code>
is the variance
of the estimate <code class="reqn">\hat{\lambda_a}</code>, <code class="reqn">\sigma_m^2</code> is the variance of the
mediator <code class="reqn">m_i</code>.
</p>
<p>From the linear regression <code class="reqn">m_i=\theta_0+\theta_{1a} x_i+e_i</code>, we have the
relationship <code class="reqn">\sigma_e^2=\sigma_m^2(1-\rho^2_{mx})</code>. Hence, we can simply
the variance <code class="reqn">\sigma_{\theta_{1a}, \lambda_a}</code> to 
</p>
<p style="text-align: center;"><code class="reqn">\sigma_{\theta_{1a}\lambda_a}=\sqrt{\theta_{1a}^2\frac{\sigma_{\epsilon}^2}{n\sigma_m^2(1-\rho_{mx}^2)}+\lambda_a^2\frac{\sigma_{m}^2(1-\rho_{mx}^2)}{n\sigma_x^2}}</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>power of the test for the parameter <code class="reqn">\theta_{1a}\lambda_a</code></p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p><code class="reqn">\theta_1\lambda/(sd(\hat{\theta}_{1a})sd(\hat{\lambda}_a))</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Sobel, M. E.
Asymptotic confidence intervals for indirect effects in structural equation models.
<em>Sociological Methodology</em>. 1982;13:290-312.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssMediation.Sobel">ssMediation.Sobel</a></code>, 
<code><a href="#topic+testMediation.Sobel">testMediation.Sobel</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'> powerMediation.Sobel(n=248, theta.1a=0.1701, lambda.a=0.1998, 
   sigma.x=0.57, sigma.m=0.61, sigma.epsilon=0.2, 
   alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='powerMediation.VSMc'>
Power for testing mediation effect in linear regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+powerMediation.VSMc'></span>

<h3>Description</h3>

<p>Calculate Power for testing mediation effect in linear regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerMediation.VSMc(n, 
                    b2, 
                    sigma.m, 
                    sigma.e, 
                    corr.xm, 
                    alpha = 0.05, 
                    verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerMediation.VSMc_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc_+3A_b2">b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the linear regression
<code class="reqn">y_i=b0+b1 x_i + b2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_e^2)</code>.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc_+3A_sigma.e">sigma.e</code></td>
<td>

<p>standard deviation of the random error term in the linear regression
<code class="reqn">y_i=b0+b1 x_i + b2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_e^2)</code>.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + b_2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above linear regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + b_2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>power for testing if <code class="reqn">b_2=0</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p><code class="reqn">b_2\sigma_m\sqrt{1-\rho_{xm}^2}/\sigma_e</code>, where
<code class="reqn">\sigma_m</code> is the standard deviation of the mediator <code class="reqn">m</code>,
<code class="reqn">\rho_{xm}</code> is the correlation between the predictor <code class="reqn">x</code>
and the mediator <code class="reqn">m</code>, and <code class="reqn">\sigma_e</code> is the standard deviation
of the random error term in the linear regression.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.VSMc">minEffect.VSMc</a></code>, 
<code><a href="#topic+ssMediation.VSMc">ssMediation.VSMc</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 3 (page 544) of Vittinghoff et al. (2009).
  # power=0.8
  powerMediation.VSMc(n = 863, b2 = 0.1, sigma.m = 1, sigma.e = 1, 
    corr.xm = 0.3, alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='powerMediation.VSMc.cox'>
Power for testing mediation effect in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+powerMediation.VSMc.cox'></span>

<h3>Description</h3>

<p>Calculate Power for testing mediation effect in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerMediation.VSMc.cox(n, 
                        b2, 
                        sigma.m, 
                        psi, 
                        corr.xm, 
                        alpha = 0.05, 
                        verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerMediation.VSMc.cox_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.cox_+3A_b2">b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the cox regression
<code class="reqn">\log(\lambda)=\log(\lambda_0)+b1 x_i + b2 m_i</code>, where <code class="reqn">\lambda</code> is the hazard function and
<code class="reqn">\lambda_0</code> is the baseline hazard function.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.cox_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.cox_+3A_psi">psi</code></td>
<td>

<p>the probability that an observation is uncensored, so that
the number of event <code class="reqn">d= n * psi</code>, where <code class="reqn">n</code> is the sample size.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.cox_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.cox_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.cox_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the cox regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i + b_2 m_i </code>
</p>

<p>where <code class="reqn">\lambda</code> is the hazard function and
<code class="reqn">\lambda_0</code> is the baseline hazard function.
</p>
<p>Vittinghoff et al. (2009) showed that for the above cox regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i </code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>power for testing if <code class="reqn">b_2=0</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p><code class="reqn">b_2\sigma_m\sqrt{(1-\rho_{xm}^2) psi}</code></p>
</td></tr></table>
<p>, where
<code class="reqn">\sigma_m</code> is the standard deviation of the mediator <code class="reqn">m</code>,
<code class="reqn">\rho_{xm}</code> is the correlation between the predictor <code class="reqn">x</code>
and the mediator <code class="reqn">m</code>, and <code class="reqn">psi</code> is 
the probability that an observation is uncensored, so that
the number of event <code class="reqn">d= n * psi</code>, where <code class="reqn">n</code> is the sample size.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.VSMc.cox">minEffect.VSMc.cox</a></code>, 
<code><a href="#topic+ssMediation.VSMc.cox">ssMediation.VSMc.cox</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 6 (page 547) of Vittinghoff et al. (2009).
  # power = 0.7999916
  powerMediation.VSMc.cox(n = 1399, b2 = log(1.5), 
    sigma.m = sqrt(0.25 * (1 - 0.25)), psi = 0.2, corr.xm = 0.3,
    alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='powerMediation.VSMc.logistic'>
Power for testing mediation effect in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+powerMediation.VSMc.logistic'></span>

<h3>Description</h3>

<p>Calculate Power for testing mediation effect in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerMediation.VSMc.logistic(n, 
                             b2, 
                             sigma.m, 
                             p, 
                             corr.xm, 
                             alpha = 0.05, 
                             verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerMediation.VSMc.logistic_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.logistic_+3A_b2">b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the logistic regression
<code class="reqn">\log(p_i/(1-p_i))=b0+b1 x_i + b2 m_i</code>.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.logistic_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.logistic_+3A_p">p</code></td>
<td>

<p>the marginal prevalence of the outcome.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.logistic_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.logistic_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.logistic_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the logistic regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b0+b1 x_i + b2 m_i</code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above logistic regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b_0+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b_0+b_1 x_i</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>power for testing if <code class="reqn">b_2=0</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p><code class="reqn">b_2\sigma_m\sqrt{(1-\rho_{xm}^2) p (1-p)}</code></p>
</td></tr></table>
<p>, where
<code class="reqn">\sigma_m</code> is the standard deviation of the mediator <code class="reqn">m</code>,
<code class="reqn">\rho_{xm}</code> is the correlation between the predictor <code class="reqn">x</code>
and the mediator <code class="reqn">m</code>, and <code class="reqn">p</code> is the marginal prevalence of the 
outcome.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.VSMc.logistic">minEffect.VSMc.logistic</a></code>, 
<code><a href="#topic+ssMediation.VSMc.logistic">ssMediation.VSMc.logistic</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 4 (page 545) of Vittinghoff et al. (2009).
  # power = 0.8005793
  powerMediation.VSMc.logistic(n = 255, b2 = log(1.5), sigma.m = 1, 
    p = 0.5, corr.xm = 0.5, alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='powerMediation.VSMc.poisson'>
Power for testing mediation effect in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+powerMediation.VSMc.poisson'></span>

<h3>Description</h3>

<p>Calculate Power for testing mediation effect in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerMediation.VSMc.poisson(n, 
                            b2, 
                            sigma.m, 
                            EY, 
                            corr.xm, 
                            alpha = 0.05, 
                            verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerMediation.VSMc.poisson_+3A_n">n</code></td>
<td>

<p>sample size.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.poisson_+3A_b2">b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the poisson regression
<code class="reqn">\log(E(Y_i))=b0+b1 x_i + b2 m_i</code>.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.poisson_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.poisson_+3A_ey">EY</code></td>
<td>

<p>the marginal mean of the outcome.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.poisson_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.poisson_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="powerMediation.VSMc.poisson_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the poisson regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b0+b1 x_i + b2 m_i</code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above poisson regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b_0+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b_0+b_1 x_i</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>power</code></td>
<td>
<p>power for testing if <code class="reqn">b_2=0</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p><code class="reqn">b_2\sigma_m\sqrt{(1-\rho_{xm}^2) EY}</code></p>
</td></tr></table>
<p>, where
<code class="reqn">\sigma_m</code> is the standard deviation of the mediator <code class="reqn">m</code>,
<code class="reqn">\rho_{xm}</code> is the correlation between the predictor <code class="reqn">x</code>
and the mediator <code class="reqn">m</code>, and <code class="reqn">EY</code> is the marginal mean of the 
outcome.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.VSMc.poisson">minEffect.VSMc.poisson</a></code>, 
<code><a href="#topic+ssMediation.VSMc.poisson">ssMediation.VSMc.poisson</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 5 (page 546) of Vittinghoff et al. (2009).
  # power = 0.7998578
  powerMediation.VSMc.poisson(n = 1239, b2 = log(1.35), 
    sigma.m = sqrt(0.25 * (1 - 0.25)), EY = 0.5, corr.xm = 0.5,
    alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='powerPoisson'>
Power calculation for simple Poisson regression
</h2><span id='topic+powerPoisson'></span>

<h3>Description</h3>

<p>Power calculation for simple Poisson regression.
Assume the predictor is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerPoisson(
    beta0, 
    beta1, 
    mu.x1, 
    sigma2.x1, 
    mu.T = 1, 
    phi = 1, 
    alpha = 0.05, 
    N = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerPoisson_+3A_beta0">beta0</code></td>
<td>

<p>intercept
</p>
</td></tr>
<tr><td><code id="powerPoisson_+3A_beta1">beta1</code></td>
<td>

<p>slope
</p>
</td></tr>
<tr><td><code id="powerPoisson_+3A_mu.x1">mu.x1</code></td>
<td>

<p>mean of the predictor
</p>
</td></tr>
<tr><td><code id="powerPoisson_+3A_sigma2.x1">sigma2.x1</code></td>
<td>

<p>variance of the predictor
</p>
</td></tr>
<tr><td><code id="powerPoisson_+3A_mu.t">mu.T</code></td>
<td>

<p>mean exposure time
</p>
</td></tr>
<tr><td><code id="powerPoisson_+3A_phi">phi</code></td>
<td>

<p>a measure of over-dispersion
</p>
</td></tr>
<tr><td><code id="powerPoisson_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate
</p>
</td></tr>
<tr><td><code id="powerPoisson_+3A_n">N</code></td>
<td>

<p>toal sample size
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The simple Poisson regression has the following form:
</p>
<p style="text-align: center;"><code class="reqn">
Pr(Y_i = y_i | \mu_i, t_i) = \exp(-\mu_i t_i) (\mu_i t_i)^{y_i}/ (y_i!)
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn"> 
\mu_i=\exp(\beta_0+\beta_1 x_{1i})
</code>
</p>

<p>We are interested in testing the null hypothesis <code class="reqn">\beta_1=0</code>
versus the alternative hypothesis <code class="reqn">\beta_1 = \theta_1</code>.
Assume <code class="reqn">x_{1}</code>  is normally distributed with mean
<code class="reqn">\mu_{x_1}</code> and variance <code class="reqn">\sigma^2_{x_1}</code>.
The sample size calculation formula derived by Signorini (1991) is
</p>
<p style="text-align: center;"><code class="reqn">
N=\phi\frac{\left[z_{1-\alpha/2}\sqrt{V\left(b_1 | \beta_1=0\right)}
+z_{power}\sqrt{V\left(b_1 | \beta_1=\theta_1\right)}\right]^2}
{\mu_T \exp(\beta_0) \theta_1^2}
</code>
</p>

<p>where <code class="reqn">\phi</code> is the over-dispersion parameter 
(<code class="reqn">=var(y_i)/mean(y_i)</code>), 
<code class="reqn">\alpha</code> is the type I error rate, 
<code class="reqn">b_1</code> is the estimate of the slope <code class="reqn">\beta_1</code>,
<code class="reqn">\beta_0</code> is the intercept,
<code class="reqn">\mu_T</code> is the mean exposure time, 
<code class="reqn">z_{a}</code> is the <code class="reqn">100*a</code>-th lower percentile of 
the standard normal distribution, and 
<code class="reqn">V\left(b_1|\beta_1=\theta\right)</code>
is the variance of the estimate <code class="reqn">b_1</code> given the true slope
<code class="reqn">\beta_1=\theta</code>. 
</p>
<p>The variances are
</p>
<p style="text-align: center;"><code class="reqn">
V\left(b_1 | \beta_1 = 0\right)=\frac{1}{\sigma^2_{x_1}}
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
V\left(b_1 | \beta_1 = \theta_1\right)=\frac{1}{\sigma^2_{x_1}}
\exp\left[-\left(\theta_1 \mu_{x_1} + \theta_1^2\sigma^2_{x_1}/2\right)\right]
</code>
</p>



<h3>Value</h3>

<p>power
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu &lt;stwxq@channing.harvard.edu&gt;
</p>


<h3>References</h3>

<p>Signorini D.F. (1991). 
Sample size for Poisson regression. 
Biometrika. Vol.78. no.2, pp. 446-50
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+sizePoisson">sizePoisson</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># power = 0.8090542
print(powerPoisson(
    beta0 = 0.1, 
    beta1 = 0.5, 
    mu.x1 = 0, 
    sigma2.x1 = 1, 
    mu.T = 1, 
    phi = 1, 
    alpha = 0.05, 
    N = 28))


</code></pre>

<hr>
<h2 id='sizePoisson'>
Sample size calculation for simple Poisson regression
</h2><span id='topic+sizePoisson'></span>

<h3>Description</h3>

<p>Sample size calculation for simple Poisson regression.
Assume the predictor is normally distributed. Two-sided test is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sizePoisson(
    beta0, 
    beta1, 
    mu.x1, 
    sigma2.x1, 
    mu.T = 1, 
    phi = 1, 
    alpha = 0.05, 
    power = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sizePoisson_+3A_beta0">beta0</code></td>
<td>

<p>intercept
</p>
</td></tr>
<tr><td><code id="sizePoisson_+3A_beta1">beta1</code></td>
<td>

<p>slope
</p>
</td></tr>
<tr><td><code id="sizePoisson_+3A_mu.x1">mu.x1</code></td>
<td>

<p>mean of the predictor
</p>
</td></tr>
<tr><td><code id="sizePoisson_+3A_sigma2.x1">sigma2.x1</code></td>
<td>

<p>variance of the predictor
</p>
</td></tr>
<tr><td><code id="sizePoisson_+3A_mu.t">mu.T</code></td>
<td>

<p>mean exposure time
</p>
</td></tr>
<tr><td><code id="sizePoisson_+3A_phi">phi</code></td>
<td>

<p>a measure of over-dispersion
</p>
</td></tr>
<tr><td><code id="sizePoisson_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate
</p>
</td></tr>
<tr><td><code id="sizePoisson_+3A_power">power</code></td>
<td>

<p>power
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The simple Poisson regression has the following form:
</p>
<p style="text-align: center;"><code class="reqn">
Pr(Y_i = y_i | \mu_i, t_i) = \exp(-\mu_i t_i) (\mu_i t_i)^{y_i}/ (y_i!)
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn"> 
\mu_i=\exp(\beta_0+\beta_1 x_{1i})
</code>
</p>

<p>We are interested in testing the null hypothesis <code class="reqn">\beta_1=0</code>
versus the alternative hypothesis <code class="reqn">\beta_1 = \theta_1</code>.
Assume <code class="reqn">x_{1}</code>  is normally distributed with mean
<code class="reqn">\mu_{x_1}</code> and variance <code class="reqn">\sigma^2_{x_1}</code>.
The sample size calculation formula derived by Signorini (1991) is
</p>
<p style="text-align: center;"><code class="reqn">
N=\phi\frac{\left[z_{1-\alpha/2}\sqrt{V\left(b_1 | \beta_1=0\right)}
+z_{power}\sqrt{V\left(b_1 | \beta_1=\theta_1\right)}\right]^2}
{\mu_T \exp(\beta_0) \theta_1^2}
</code>
</p>

<p>where <code class="reqn">\phi</code> is the over-dispersion parameter 
(<code class="reqn">=var(y_i)/mean(y_i)</code>), 
<code class="reqn">\alpha</code> is the type I error rate, 
<code class="reqn">b_1</code> is the estimate of the slope <code class="reqn">\beta_1</code>,
<code class="reqn">\beta_0</code> is the intercept,
<code class="reqn">\mu_T</code> is the mean exposure time, 
<code class="reqn">z_{a}</code> is the <code class="reqn">100*a</code>-th lower percentile of 
the standard normal distribution, and 
<code class="reqn">V\left(b_1|\beta_1=\theta\right)</code>
is the variance of the estimate <code class="reqn">b_1</code> given the true slope
<code class="reqn">\beta_1=\theta</code>. 
</p>
<p>The variances are
</p>
<p style="text-align: center;"><code class="reqn">
V\left(b_1 | \beta_1 = 0\right)=\frac{1}{\sigma^2_{x_1}}
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
V\left(b_1 | \beta_1 = \theta_1\right)=\frac{1}{\sigma^2_{x_1}}
\exp\left[-\left(\theta_1 \mu_{x_1} + \theta_1^2\sigma^2_{x_1}/2\right)\right]
</code>
</p>



<h3>Value</h3>

<p>total sample size
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu &lt;stwxq@channing.harvard.edu&gt;
</p>


<h3>References</h3>

<p>Signorini D.F. (1991). 
Sample size for Poisson regression. 
Biometrika. Vol.78. no.2, pp. 446-50
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+powerPoisson">powerPoisson</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># sample size = 28
print(sizePoisson(
  beta0 = 0.1, 
  beta1 = 0.5,
  mu.x1 = 0, 
  sigma2.x1 = 1,
  mu.T = 1, 
  phi = 1,
  alpha = 0.05, 
  power = 0.8))

</code></pre>

<hr>
<h2 id='ss.SLR'>
Sample size for testing slope for simple linear regression
</h2><span id='topic+ss.SLR'></span>

<h3>Description</h3>

<p>Calculate sample size for testing slope for simple linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss.SLR(power, 
       lambda.a, 
       sigma.x, 
       sigma.y, 
       n.lower = 2.01, 
       n.upper = 1e+30, 
       alpha = 0.05, 
       verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss.SLR_+3A_power">power</code></td>
<td>

<p>power for testing if <code class="reqn">\lambda=0</code> for the simple linear regression 
<code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_{e}^2).</code>
</p>
</td></tr>
<tr><td><code id="ss.SLR_+3A_lambda.a">lambda.a</code></td>
<td>

<p>regression coefficient in the simple linear regression 
<code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_{e}^2).</code>
</p>
</td></tr>
<tr><td><code id="ss.SLR_+3A_sigma.x">sigma.x</code></td>
<td>

<p>standard deviation of the predictor <code class="reqn">sd(x)</code>.
</p>
</td></tr>
<tr><td><code id="ss.SLR_+3A_sigma.y">sigma.y</code></td>
<td>

<p>marginal standard deviation of the outcome <code class="reqn">sd(y)</code>.
(not the marginal standard deviation <code class="reqn">sd(y|x)</code>)
</p>
</td></tr>
<tr><td><code id="ss.SLR_+3A_n.lower">n.lower</code></td>
<td>

<p>lower bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ss.SLR_+3A_n.upper">n.upper</code></td>
<td>

<p>upper bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ss.SLR_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="ss.SLR_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing sample size; <code>FALSE</code> means not printing sample size.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\lambda\neq 0</code>
for the simple linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Dupont, W.D. and Plummer, W.D..
Power and Sample Size Calculations for Studies Involving Linear Regression.
<em>Controlled Clinical Trials</em>. 1998;19:589-601.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.SLR">minEffect.SLR</a></code>,
<code><a href="#topic+power.SLR">power.SLR</a></code>,
<code><a href="#topic+power.SLR.rho">power.SLR.rho</a></code>,
<code><a href="#topic+ss.SLR.rho">ss.SLR.rho</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ss.SLR(power=0.8, lambda.a=0.8, sigma.x=0.2, sigma.y=0.5, 
    alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='ss.SLR.rho'>
Sample size for testing slope for simple linear regression based on R2
</h2><span id='topic+ss.SLR.rho'></span>

<h3>Description</h3>

<p>Calculate sample size for testing slope for simple linear regression based on R2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss.SLR.rho(power, 
           rho2, 
           n.lower = 2.01, 
           n.upper = 1e+30, 
           alpha = 0.05, 
           verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss.SLR.rho_+3A_power">power</code></td>
<td>

<p>power.
</p>
</td></tr>
<tr><td><code id="ss.SLR.rho_+3A_rho2">rho2</code></td>
<td>

<p>square of the correlation between the outcome and the predictor.
</p>
</td></tr>
<tr><td><code id="ss.SLR.rho_+3A_n.lower">n.lower</code></td>
<td>

<p>lower bound of the sample size.
</p>
</td></tr>
<tr><td><code id="ss.SLR.rho_+3A_n.upper">n.upper</code></td>
<td>

<p>upper bound o the sample size.
</p>
</td></tr>
<tr><td><code id="ss.SLR.rho_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="ss.SLR.rho_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing sample size; <code>FALSE</code> means not printing sample size.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\lambda\neq 0</code>
for the simple linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">y_i=\gamma+\lambda x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Dupont, W.D. and Plummer, W.D..
Power and Sample Size Calculations for Studies Involving Linear Regression.
<em>Controlled Clinical Trials</em>. 1998;19:589-601.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.SLR">minEffect.SLR</a></code>,
<code><a href="#topic+power.SLR">power.SLR</a></code>,
<code><a href="#topic+power.SLR.rho">power.SLR.rho</a></code>,
<code><a href="#topic+ss.SLR">ss.SLR</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ss.SLR.rho(power=0.8, rho2=0.6, alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='SSizeLogisticBin'>
Calculating sample size for simple logistic regression with binary predictor
</h2><span id='topic+SSizeLogisticBin'></span>

<h3>Description</h3>

<p>Calculating sample size for simple logistic regression with binary predictor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSizeLogisticBin(p1, 
                 p2, 
                 B, 
                 alpha = 0.05, 
                 power = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSizeLogisticBin_+3A_p1">p1</code></td>
<td>

<p><code class="reqn">pr(diseased | X = 0)</code>, i.e. the event rate at <code class="reqn">X = 0</code> in logistic regression
<code class="reqn">logit(p) = a + b X</code>, where <code class="reqn">X</code> is the binary predictor.
</p>
</td></tr>
<tr><td><code id="SSizeLogisticBin_+3A_p2">p2</code></td>
<td>

<p><code class="reqn">pr(diseased | X = 1)</code>, the event rate at <code class="reqn">X = 1</code> in logistic regression
<code class="reqn">logit(p) = a + b X</code>, where <code class="reqn">X</code> is the binary predictor.
</p>
</td></tr>
<tr><td><code id="SSizeLogisticBin_+3A_b">B</code></td>
<td>

<p><code class="reqn">pr(X = 1)</code>, i.e. proportion of the sample with <code class="reqn">X = 1</code>
</p>
</td></tr>
<tr><td><code id="SSizeLogisticBin_+3A_alpha">alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td></tr>
<tr><td><code id="SSizeLogisticBin_+3A_power">power</code></td>
<td>

<p>power for testing if the odds ratio is equal to one.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The logistic regression mode is
</p>
<p style="text-align: center;"><code class="reqn">
\log(p / (1 - p)) = \beta_0 + \beta_1 X
</code>
</p>

<p>where <code class="reqn">p = prob(Y = 1)</code>, <code class="reqn">X</code> is the binary predictor, 
<code class="reqn">p_1 = pr(diseased | X = 0)</code>,
<code class="reqn">p_2 = pr(diseased| X = 1)</code>, <code class="reqn">B = pr(X = 1)</code>, and 
<code class="reqn">p = (1 - B) p_1 + B p_2</code>.
The sample size formula we used for testing if 
<code class="reqn">\beta_1 = 0</code>, is Formula (2) in Hsieh et al. (1998):
</p>
<p style="text-align: center;"><code class="reqn">
n = (Z_{1-\alpha/2}[p(1-p)/B]^{1/2} + Z_{power}[p_1(1-p_1)+p_2(1-p_2)(1-B)/B]^{1/2})^2/[ (p_1-p_2)^2 (1-B) ]
</code>
</p>

<p>where <code class="reqn">n</code> is the required total sample size and <code class="reqn">Z_u</code> is the <code class="reqn">u</code>-th
percentile of the standard normal distribution.
</p>


<h3>Value</h3>

<p>total sample size required.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Hsieh, FY, Bloch, DA, and Larsen, MD.
A SIMPLE METHOD OF SAMPLE SIZE CALCULATION FOR LINEAR AND LOGISTIC REGRESSION.
<em>Statistics in Medicine</em>. 1998; 17:1623-1634.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerLogisticBin">powerLogisticBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    ## Example in Table I Design (Balanced design with high event rates) 
    ## of Hsieh et al. (1998 )
    ## the sample size is 1281
    SSizeLogisticBin(p1 = 0.4, p2 = 0.5, B = 0.5, alpha = 0.05, power = 0.95)
</code></pre>

<hr>
<h2 id='SSizeLogisticCon'>
Calculating sample size for simple logistic regression with continuous predictor
</h2><span id='topic+SSizeLogisticCon'></span>

<h3>Description</h3>

<p>Calculating sample size for simple logistic regression with continuous predictor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSizeLogisticCon(p1, 
                 OR, 
                 alpha = 0.05, 
                 power = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSizeLogisticCon_+3A_p1">p1</code></td>
<td>

<p>the event rate at the mean of the continuous predictor <code>X</code> in logistic regression
<code class="reqn">logit(p) = a + b X</code>,
</p>
</td></tr>
<tr><td><code id="SSizeLogisticCon_+3A_or">OR</code></td>
<td>

<p>Expected odds ratio. <code class="reqn">\log(OR)</code> is the change in log odds for the difference between at the mean of <code class="reqn">X</code> and at one SD above the mean.
</p>
</td></tr>
<tr><td><code id="SSizeLogisticCon_+3A_alpha">alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td></tr>
<tr><td><code id="SSizeLogisticCon_+3A_power">power</code></td>
<td>

<p>power for testing if the odds ratio is equal to one.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The logistic regression mode is
</p>
<p style="text-align: center;"><code class="reqn">
\log(p/(1-p)) = \beta_0 + \beta_1 X
</code>
</p>

<p>where <code class="reqn">p=prob(Y=1)</code>, <code class="reqn">X</code> is the continuous predictor, and <code class="reqn">\log(OR)</code> is the
the change in log odds for the difference between at the mean of <code class="reqn">X</code> and at one SD above the mean.
The sample size formula we used for testing if <code class="reqn">\beta_1=0</code> or equivalently
<code class="reqn">OR=1</code>, is Formula (1) in Hsieh et al. (1998):
</p>
<p style="text-align: center;"><code class="reqn">
n=(Z_{1-\alpha/2} + Z_{power})^2/[ p_1 (1-p_1) [log(OR)]^2 ]
</code>
</p>

<p>where <code class="reqn">n</code> is the required total sample size, <code class="reqn">OR</code> is the
odds ratio to be tested, <code class="reqn">p_1</code> is the event rate at the mean
of the predictor <code class="reqn">X</code>, and <code class="reqn">Z_u</code> is the <code class="reqn">u</code>-th
percentile of the standard normal distribution.
</p>


<h3>Value</h3>

<p>total sample size required.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Hsieh, FY, Bloch, DA, and Larsen, MD.
A SIMPLE METHOD OF SAMPLE SIZE CALCULATION FOR LINEAR AND LOGISTIC REGRESSION.
<em>Statistics in Medicine</em>. 1998; 17:1623-1634.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerLogisticCon">powerLogisticCon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    ## Example in Table II Design (Balanced design (1)) of Hsieh et al. (1998 )
    ## the sample size is 317
    SSizeLogisticCon(p1 = 0.5, OR = exp(0.405), alpha = 0.05, power = 0.95)
</code></pre>

<hr>
<h2 id='ssLong'>
Sample size calculation for longitudinal study with 2 time point
</h2><span id='topic+ssLong'></span>

<h3>Description</h3>

<p>Sample size calculation for testing if mean changes for 2 groups are the same or not for longitudinal study with 2 time point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssLong(es, 
       rho = 0.5, 
       alpha = 0.05, 
       power = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssLong_+3A_es">es</code></td>
<td>

<p>effect size of the difference of mean change.
</p>
</td></tr>
<tr><td><code id="ssLong_+3A_rho">rho</code></td>
<td>

<p>correlation coefficient between baseline and follow-up values within a treatment group.
</p>
</td></tr>
<tr><td><code id="ssLong_+3A_alpha">alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td></tr>
<tr><td><code id="ssLong_+3A_power">power</code></td>
<td>

<p>power for testing for difference of mean changes.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample size formula is based on Equation 8.30 on page 335 of Rosner (2006).
</p>
<p style="text-align: center;"><code class="reqn">
n=\frac{2\sigma_d^2 (Z_{1-\alpha/2} + Z_{power})^2}{\delta^2}
</code>
</p>

<p>where <code class="reqn">\sigma_d = \sigma_1^2+\sigma_2^2-2\rho\sigma_1\sigma_2</code>, <code class="reqn">\delta=|\mu_1 - \mu_2|</code>,
<code class="reqn">\mu_1</code> is the mean change over time <code class="reqn">t</code> in group 1, 
<code class="reqn">\mu_2</code> is the mean change over time <code class="reqn">t</code> in group 2, 
<code class="reqn">\sigma_1^2</code> is the variance of baseline values within a treatment group,
<code class="reqn">\sigma_2^2</code> is the variance of follow-up values within a treatment group,
<code class="reqn">\rho</code> is the correlation coefficient between baseline and follow-up values within a treatment group,
and <code class="reqn">Z_u</code> is the u-th percentile of the standard normal distribution.
</p>
<p>We wish to test <code class="reqn">\mu_1 = \mu_2</code>.
</p>
<p>When <code class="reqn">\sigma_1=\sigma_2=\sigma</code>, then formula reduces to
</p>
<p style="text-align: center;"><code class="reqn">
n=\frac{4(1-\rho)(Z_{1-\alpha/2}+Z_{\beta})^2}{d^2}
</code>
</p>

<p>where <code class="reqn">d=\delta/\sigma</code>.
</p>


<h3>Value</h3>

<p>required sample size per group
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Rosner, B.
<em>Fundamentals of Biostatistics</em>. Sixth edition. Thomson Brooks/Cole. 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssLongFull">ssLongFull</a></code>, <code><a href="#topic+powerLong">powerLong</a></code>, 
<code><a href="#topic+powerLongFull">powerLongFull</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example 8.33 on page 336 of Rosner (2006)
    # n=85
    ssLong(es=5/15, rho=0.7, alpha=0.05, power=0.8)
</code></pre>

<hr>
<h2 id='ssLong.multiTime'>
Sample size calculation for testing if mean changes for 2 groups are the
same or not for longitudinal study with more than 2 time points
</h2><span id='topic+ssLong.multiTime'></span>

<h3>Description</h3>

<p>Sample size calculation for testing if mean changes for 2 groups are the
same or not for longitudinal study with more than 2 time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssLong.multiTime(es, power, nn, sx2, rho = 0.5, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssLong.multiTime_+3A_es">es</code></td>
<td>

<p>effect size
</p>
</td></tr>
<tr><td><code id="ssLong.multiTime_+3A_power">power</code></td>
<td>

<p>power
</p>
</td></tr>
<tr><td><code id="ssLong.multiTime_+3A_nn">nn</code></td>
<td>

<p>number of observations per subject
</p>
</td></tr>
<tr><td><code id="ssLong.multiTime_+3A_sx2">sx2</code></td>
<td>

<p>within subject variance
</p>
</td></tr>
<tr><td><code id="ssLong.multiTime_+3A_rho">rho</code></td>
<td>

<p>within subject correlation
</p>
</td></tr>
<tr><td><code id="ssLong.multiTime_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We are interested in comparing the slopes of the 2 groups <code class="reqn">A</code> and <code class="reqn">B</code>:
</p>
<p style="text-align: center;"><code class="reqn">
\beta_{1A} = \beta_{1B}
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
Y_{ijA}=\beta_{0A}+\beta_{1A} x_{jA} + \epsilon_{ijA}, j=1, \ldots, nn; i=1, \ldots, m
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
Y_{ijB}=\beta_{0B}+\beta_{1B} x_{jB} + \epsilon_{ijB}, j=1, \ldots, nn; i=1, \ldots, m
</code>
</p>

<p>The sample size calculation formula is (Equation on page 30 of Diggle et al. (1994)):
</p>
<p style="text-align: center;"><code class="reqn">
m=\frac{2\left(Z_{1-\alpha}+z_{power}\right)^2 \left(1-\rho\right)}{
nn s_x^2 es^2}
</code>
</p>

<p>where <code class="reqn">es=d/\sigma</code>, <code class="reqn">d</code> is the meaninful differnce of interest, 
<code class="reqn">sigma^2</code> is the variance of the random error, 
<code class="reqn">\rho</code> is the within-subject correlation, and
<code class="reqn">s_x^2</code> is the within-subject variance.
</p>


<h3>Value</h3>

<p>subject per group
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Diggle PJ, Liang KY, and Zeger SL (1994). 
Analysis of Longitundinal Data.  page 30.
Clarendon Press, Oxford
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerLong.multiTime">powerLong.multiTime</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># subject per group = 196
ssLong.multiTime(es=0.5/10, power=0.8, nn=3, sx2=4.22, rho = 0.5, alpha=0.05)
</code></pre>

<hr>
<h2 id='ssLongFull'>
Sample size calculation for longitudinal study with 2 time point
</h2><span id='topic+ssLongFull'></span>

<h3>Description</h3>

<p>Sample size calculation for testing if mean changes for 2 groups are the same or not for longitudinal study with 2 time point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssLongFull(delta, 
           sigma1, 
           sigma2, 
           rho = 0.5, 
           alpha = 0.05, 
           power = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssLongFull_+3A_delta">delta</code></td>
<td>

<p>absolute difference of the mean changes between the two groups: <code class="reqn">\delta=|\mu_1 - \mu_2|</code> where
<code class="reqn">\mu_1</code> is the mean change over time <code class="reqn">t</code> in group 1, 
<code class="reqn">\mu_2</code> is the mean change over time <code class="reqn">t</code> in group 2. 
</p>
</td></tr>
<tr><td><code id="ssLongFull_+3A_sigma1">sigma1</code></td>
<td>

<p>the standard deviation of baseline values within a treatment group
</p>
</td></tr>
<tr><td><code id="ssLongFull_+3A_sigma2">sigma2</code></td>
<td>

<p>the standard deviation of follow-up values within a treatment group
</p>
</td></tr>
<tr><td><code id="ssLongFull_+3A_rho">rho</code></td>
<td>

<p>correlation coefficient between baseline and follow-up values within a treatment group.
</p>
</td></tr>
<tr><td><code id="ssLongFull_+3A_alpha">alpha</code></td>
<td>

<p>Type I error rate
</p>
</td></tr>
<tr><td><code id="ssLongFull_+3A_power">power</code></td>
<td>

<p>power for testing for difference of mean changes.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample size formula is based on Equation 8.30 on page 335 of Rosner (2006).
</p>
<p style="text-align: center;"><code class="reqn">
n=\frac{2\sigma_d^2 (Z_{1-\alpha/2} + Z_{power})^2}{\delta^2}
</code>
</p>

<p>where <code class="reqn">\sigma_d = \sigma_1^2+\sigma_2^2-2\rho\sigma_1\sigma_2</code>, <code class="reqn">\delta=|\mu_1 - \mu_2|</code>,
<code class="reqn">\mu_1</code> is the mean change over time <code class="reqn">t</code> in group 1, 
<code class="reqn">\mu_2</code> is the mean change over time <code class="reqn">t</code> in group 2, 
<code class="reqn">\sigma_1^2</code> is the variance of baseline values within a treatment group,
<code class="reqn">\sigma_2^2</code> is the variance of follow-up values within a treatment group,
<code class="reqn">\rho</code> is the correlation coefficient between baseline and follow-up values within a treatment group,
and <code class="reqn">Z_u</code> is the u-th percentile of the standard normal distribution.
</p>
<p>We wish to test <code class="reqn">\mu_1 = \mu_2</code>.
</p>


<h3>Value</h3>

<p>required sample size per group
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Rosner, B.
<em>Fundamentals of Biostatistics</em>. Sixth edition. Thomson Brooks/Cole. 2006.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ssLong">ssLong</a></code>, <code><a href="#topic+powerLong">powerLong</a></code>, 
<code><a href="#topic+powerLongFull">powerLongFull</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example 8.33 on page 336 of Rosner (2006)
    # n=85
    ssLongFull(delta=5, sigma1=15, sigma2=15, rho=0.7, alpha=0.05, power=0.8)
</code></pre>

<hr>
<h2 id='ssMediation.Sobel'>
Sample size for testing mediation effectd (Sobel's test)
</h2><span id='topic+ssMediation.Sobel'></span>

<h3>Description</h3>

<p>Calculate sample size for testing mediation effect based on Sobel's test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssMediation.Sobel(power, 
                  theta.1a, 
                  lambda.a, 
                  sigma.x, 
                  sigma.m,
                  sigma.epsilon, 
                  n.lower = 1, 
                  n.upper = 1e+30, 
                  alpha = 0.05, 
                  verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssMediation.Sobel_+3A_power">power</code></td>
<td>

<p>power of the test.
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_theta.1a">theta.1a</code></td>
<td>

<p>regression coefficient for the predictor in the linear regression linking
the predictor <code class="reqn">x</code> to the mediator <code class="reqn">m</code> (<code class="reqn">m_i=\theta_0+\theta_{1a} x_i + e_i, e_i\sim N(0, \sigma^2_e)</code>).
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_lambda.a">lambda.a</code></td>
<td>

<p>regression coefficient for the mediator in the linear regression linking
the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code> to the outcome <code class="reqn">y</code> (<code class="reqn">y_i=\gamma+\lambda_a m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>).
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_sigma.x">sigma.x</code></td>
<td>

<p>standard deviation of the predictor.
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_sigma.epsilon">sigma.epsilon</code></td>
<td>

<p>standard deviation of the random error term 
in the linear regression linking
the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code> to the outcome <code class="reqn">y</code> (<code class="reqn">y_i=\gamma+\lambda_a m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>).
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_n.lower">n.lower</code></td>
<td>

<p>lower bound of the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_n.upper">n.upper</code></td>
<td>

<p>upper bound of the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="ssMediation.Sobel_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample size is for testing the null hypothesis <code class="reqn">\theta_1\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\theta_{1a}\lambda_a\neq 0</code>
for the linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">m_i=\theta_0+\theta_{1a} x_i + e_i, e_i\sim N(0, \sigma^2_e)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_i=\gamma+\lambda_a m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>
</p>

<p>Test statistic is based on Sobel's (1982) test:
</p>
<p style="text-align: center;"><code class="reqn">Z=\frac{\hat{\theta}_{1a}\hat{\lambda_a}}{\hat{\sigma}_{\theta_{1a}\lambda_a}}
</code>
</p>

<p>where <code class="reqn">\hat{\sigma}_{\theta_{1a}\lambda_a}</code> is the estimated standard deviation
of the estimate <code class="reqn">\hat{\theta}_{1a}\hat{\lambda_a}</code> using multivariate
delta method: 
</p>
<p style="text-align: center;"><code class="reqn">\sigma_{\theta_{1a}\lambda_a}=\sqrt{\theta_{1a}^2\sigma_{\lambda_a}^2+\lambda_a^2\sigma_{\theta_{1a}}^2}</code>
</p>

<p>and
<code class="reqn">\sigma_{\theta_{1a}}^2=\sigma_e^2/(n\sigma_x^2)</code> is the 
variance
of the estimate <code class="reqn">\hat{\theta}_{1a}</code>, and
<code class="reqn">\sigma_{\lambda_a}^2=\sigma_{\epsilon}^2/(n\sigma_m^2(1-\rho_{mx}^2))</code>
is the variance
of the estimate <code class="reqn">\hat{\lambda_a}</code>, <code class="reqn">\sigma_m^2</code> is the variance of the
mediator <code class="reqn">m_i</code>.
</p>
<p>From the linear regression <code class="reqn">m_i=\theta_0+\theta_{1a} x_i+e_i</code>, we have the
relationship <code class="reqn">\sigma_e^2=\sigma_m^2(1-\rho^2_{mx})</code>. Hence, we can simply
the variance <code class="reqn">\sigma_{\theta_{1a}, \lambda_a}</code> to 
</p>
<p style="text-align: center;"><code class="reqn">\sigma_{\theta_{1a}\lambda_a}=\sqrt{\theta_{1a}^2\frac{\sigma_{\epsilon}^2}{n\sigma_m^2(1-\rho_{mx}^2)}+\lambda_a^2\frac{\sigma_{m}^2(1-\rho_{mx}^2)}{n\sigma_x^2}}</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Sobel, M. E.
Asymptotic confidence intervals for indirect effects in structural equation models.
<em>Sociological Methodology</em>. 1982;13:290-312.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerMediation.Sobel">powerMediation.Sobel</a></code>, 
<code><a href="#topic+testMediation.Sobel">testMediation.Sobel</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ssMediation.Sobel(power=0.8, theta.1a=0.1701, lambda.a=0.1998, 
   sigma.x=0.57, sigma.m=0.61, sigma.epsilon=0.2, 
   alpha = 0.05, verbose = TRUE)
</code></pre>

<hr>
<h2 id='ssMediation.VSMc'>
Sample size for testing mediation effect in linear regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+ssMediation.VSMc'></span>

<h3>Description</h3>

<p>Calculate sample size for testing mediation effect in linear regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssMediation.VSMc(power, 
                 b2, 
                 sigma.m, 
                 sigma.e, 
                 corr.xm, 
                 n.lower = 1, 
                 n.upper = 1e+30, 
                 alpha = 0.05, 
                 verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssMediation.VSMc_+3A_power">power</code></td>
<td>

<p>power for testing <code class="reqn">b_2=0</code> for the linear regression <code class="reqn">y_i=b0+b1 x_i + b2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_e^2)</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc_+3A_b2">b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the linear regression
<code class="reqn">y_i=b0+b1 x_i + b2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_e^2)</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc_+3A_sigma.e">sigma.e</code></td>
<td>

<p>standard deviation of the random error term in the linear regression
<code class="reqn">y_i=b0+b1 x_i + b2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma_e^2)</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc_+3A_n.lower">n.lower</code></td>
<td>

<p>lower bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc_+3A_n.upper">n.upper</code></td>
<td>

<p>upper bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing sample size; <code>FALSE</code> means not printing sample size.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + b_2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above linear regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + b_2 m_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">y_i=b_0+b_1 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{e})</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.VSMc">minEffect.VSMc</a></code>, 
<code><a href="#topic+powerMediation.VSMc">powerMediation.VSMc</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 3 (page 544) of Vittinghoff et al. (2009).
  # n=863
  ssMediation.VSMc(power = 0.80, b2 = 0.1, sigma.m = 1, sigma.e = 1, 
    corr.xm = 0.3, alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='ssMediation.VSMc.cox'>
Sample size for testing mediation effect in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+ssMediation.VSMc.cox'></span>

<h3>Description</h3>

<p>Calculate sample size for testing mediation effect in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssMediation.VSMc.cox(power, 
                     b2, 
                     sigma.m, 
                     psi, 
                     corr.xm, 
                     n.lower = 1, 
                     n.upper = 1e+30, 
                     alpha = 0.05, 
                     verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssMediation.VSMc.cox_+3A_power">power</code></td>
<td>

<p>power for testing <code class="reqn">b_2=0</code> for the cox regression <code class="reqn">\log(\lambda)=\log(\lambda_0)+b1 x_i + b2 m_i</code>, where <code class="reqn">\lambda</code> is the hazard function and
<code class="reqn">\lambda_0</code> is the baseline hazard function.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.cox_+3A_b2">b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the cox regression
<code class="reqn">\log(\lambda)=\log(\lambda_0)+b1 x_i + b2 m_i</code>, where <code class="reqn">\lambda</code> is the hazard function and
<code class="reqn">\lambda_0</code> is the baseline hazard function.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.cox_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.cox_+3A_psi">psi</code></td>
<td>

<p>the probability that an observation is uncensored, so that
the number of event <code class="reqn">d= n * psi</code>, where <code class="reqn">n</code> is the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.cox_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.cox_+3A_n.lower">n.lower</code></td>
<td>

<p>lower bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.cox_+3A_n.upper">n.upper</code></td>
<td>

<p>upper bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.cox_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.cox_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing sample size; <code>FALSE</code> means not printing sample size.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the cox regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b1 x_i + b2 m_i</code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above cox regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i </code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.VSMc.cox">minEffect.VSMc.cox</a></code>, 
<code><a href="#topic+powerMediation.VSMc.cox">powerMediation.VSMc.cox</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 6 (page 547) of Vittinghoff et al. (2009).
  # n = 1399
  ssMediation.VSMc.cox(power = 0.7999916, b2 = log(1.5), 
    sigma.m = sqrt(0.25 * (1 - 0.25)), psi = 0.2, corr.xm = 0.3,
    alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='ssMediation.VSMc.logistic'>
Sample size for testing mediation effect in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+ssMediation.VSMc.logistic'></span>

<h3>Description</h3>

<p>Calculate sample size for testing mediation effect in logistic regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssMediation.VSMc.logistic(power, 
                          b2, 
                          sigma.m, 
                          p, 
                          corr.xm, 
                          n.lower = 1, 
                          n.upper = 1e+30, 
                          alpha = 0.05, 
                          verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_power">power</code></td>
<td>

<p>power for testing <code class="reqn">b_2=0</code> for the logistic regression <code class="reqn">\log(p_i/(1-p_i))=b0+b1 x_i + b2 m_i</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_b2">b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the logistic regression
<code class="reqn">\log(p_i/(1-p_i))=b0+b1 x_i + b2 m_i</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_p">p</code></td>
<td>

<p>the marginal prevalence of the outcome.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_n.lower">n.lower</code></td>
<td>

<p>lower bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_n.upper">n.upper</code></td>
<td>

<p>upper bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.logistic_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing sample size; <code>FALSE</code> means not printing sample size.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the logistic regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b_0+b_1 x_i + b_2 m_i</code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above logistic regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b_0+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(p_i/(1-p_i))=b_0+b_1 x_i</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.VSMc.logistic">minEffect.VSMc.logistic</a></code>, 
<code><a href="#topic+powerMediation.VSMc.logistic">powerMediation.VSMc.logistic</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 4 (page 545) of Vittinghoff et al. (2009).
  # n=255

  ssMediation.VSMc.logistic(power = 0.80, b2 = log(1.5), sigma.m = 1, p = 0.5, 
    corr.xm = 0.5, alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='ssMediation.VSMc.poisson'>
Sample size for testing mediation effect in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2><span id='topic+ssMediation.VSMc.poisson'></span>

<h3>Description</h3>

<p>Calculate sample size for testing mediation effect in poisson regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssMediation.VSMc.poisson(power, 
                         b2, 
                         sigma.m, 
                         EY, 
                         corr.xm, 
                         n.lower = 1, 
                         n.upper = 1e+30, 
                         alpha = 0.05, 
                         verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_power">power</code></td>
<td>

<p>power for testing <code class="reqn">b_2=0</code> for the poisson regression <code class="reqn">\log(E(Y_i))=b0+b1 x_i + b2 m_i</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_b2">b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the poisson regression
<code class="reqn">\log(E(Y_i))=b0+b1 x_i + b2 m_i</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_sigma.m">sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_ey">EY</code></td>
<td>

<p>the marginal mean of the outcome.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_corr.xm">corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_n.lower">n.lower</code></td>
<td>

<p>lower bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_n.upper">n.upper</code></td>
<td>

<p>upper bound for the sample size.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_alpha">alpha</code></td>
<td>

<p>type I error rate.
</p>
</td></tr>
<tr><td><code id="ssMediation.VSMc.poisson_+3A_verbose">verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing sample size; <code>FALSE</code> means not printing sample size.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the poisson regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b_0+b_1 x_i + b_2 m_i</code>
</p>

<p>Vittinghoff et al. (2009) showed that for the above poisson regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b_0+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(E(Y_i))=b_0+b_1 x_i</code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>res.uniroot</code></td>
<td>
<p>results of optimization to find the optimal sample size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+minEffect.VSMc.poisson">minEffect.VSMc.poisson</a></code>, 
<code><a href="#topic+powerMediation.VSMc.poisson">powerMediation.VSMc.poisson</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # example in section 5 (page 546) of Vittinghoff et al. (2009).
  # n = 1239
  ssMediation.VSMc.poisson(power = 0.7998578, b2 = log(1.35), 
    sigma.m = sqrt(0.25 * (1 - 0.25)), EY = 0.5, corr.xm = 0.5,
    alpha = 0.05, verbose = TRUE)

</code></pre>

<hr>
<h2 id='testMediation.Sobel'>
P-value and confidence interval for testing mediation effect  (Sobel's test)
</h2><span id='topic+testMediation.Sobel'></span>

<h3>Description</h3>

<p>Calculate p-value and confidence interval for testing mediation effect based on Sobel's test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testMediation.Sobel(theta.1.hat, 
                    lambda.hat, 
                    sigma.theta1, 
                    sigma.lambda, 
                    alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testMediation.Sobel_+3A_theta.1.hat">theta.1.hat</code></td>
<td>

<p>estimated regression coefficient for the predictor in the linear regression linking
the predictor <code class="reqn">x</code> to the mediator <code class="reqn">m</code> (<code class="reqn">m_i=\theta_0+\theta_1 x_i + e_i, e_i\sim N(0, \sigma^2_e)</code>).
</p>
</td></tr>
<tr><td><code id="testMediation.Sobel_+3A_lambda.hat">lambda.hat</code></td>
<td>

<p>estimated regression coefficient for the mediator in the linear regression linking
the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code> to the outcome <code class="reqn">y</code> (<code class="reqn">y_i=\gamma+\lambda m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>).
</p>
</td></tr>
<tr><td><code id="testMediation.Sobel_+3A_sigma.theta1">sigma.theta1</code></td>
<td>

<p>standard deviation of <code class="reqn">\hat{\theta}_1</code>
in the linear regression linking
the predictor <code class="reqn">x</code> to the mediator <code class="reqn">m</code> (<code class="reqn">m_i=\theta_0+\theta_1 x_i + e_i, e_i\sim N(0, \sigma^2_e)</code>).
</p>
</td></tr>
<tr><td><code id="testMediation.Sobel_+3A_sigma.lambda">sigma.lambda</code></td>
<td>

<p>standard deviation of <code class="reqn">\hat{\lambda}</code>
in the linear regression linking
the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code> to the outcome <code class="reqn">y</code> (<code class="reqn">y_i=\gamma+\lambda m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>).
</p>
</td></tr>
<tr><td><code id="testMediation.Sobel_+3A_alpha">alpha</code></td>
<td>

<p>significance level of a test.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is for testing the null hypothesis <code class="reqn">\theta_1\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\theta_{1a}\lambda_a\neq 0</code>
for the linear regressions:
</p>
<p style="text-align: center;"><code class="reqn">m_i=\theta_0+\theta_1 x_i + e_i, e_i\sim N(0, \sigma^2_e)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_i=\gamma+\lambda m_i+ \lambda_2 x_i + \epsilon_i, \epsilon_i\sim N(0, \sigma^2_{\epsilon})</code>
</p>

<p>Test statistic is based on Sobel's (1982) test:
</p>
<p style="text-align: center;"><code class="reqn">Z=\frac{\hat{\theta}_1\hat{\lambda}}{\hat{\sigma}_{\theta_1\lambda}}
</code>
</p>

<p>where <code class="reqn">\hat{\sigma}_{\theta_1\lambda}</code> is the estimated standard deviation
of the estimate <code class="reqn">\hat{\theta}_1\hat{\lambda}</code> using multivariate
delta method: 
</p>
<p style="text-align: center;"><code class="reqn">\sigma_{\theta_1\lambda}=\sqrt{\theta_1^2\sigma_{\lambda}^2+\lambda^2\sigma_{\theta_1}^2}</code>
</p>

<p>and
<code class="reqn">\hat{\sigma}_{\theta_1}</code> is the estimated standard deviation
of the estimate <code class="reqn">\hat{\theta}_1</code>, and
<code class="reqn">\hat{\sigma}_{\lambda}</code> is the estimated standard deviation
of the estimate <code class="reqn">\hat{\lambda}</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>pval</code></td>
<td>
<p>p-value for testing the null hypothesis <code class="reqn">\theta_1\lambda=0</code>
versus the alternative hypothesis <code class="reqn">\theta_{1a}\lambda_a\neq 0</code>.</p>
</td></tr>
<tr><td><code>CI.low</code></td>
<td>
<p>Lower bound of the <code class="reqn">100 (1-\alpha)\%</code> confidence interval for the parameter <code class="reqn">\theta_1\lambda</code>.</p>
</td></tr>
<tr><td><code>CI.upp</code></td>
<td>
<p>Upper bound of the <code class="reqn">100 (1-\alpha)\%</code> confidence interval for the parameter <code class="reqn">\theta_1\lambda</code>.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Sobel, M. E.
Asymptotic confidence intervals for indirect effects in structural equation models.
<em>Sociological Methodology</em>. 1982;13:290-312.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powerMediation.Sobel">powerMediation.Sobel</a></code>, 
<code><a href="#topic+ssMediation.Sobel">ssMediation.Sobel</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  testMediation.Sobel(theta.1.hat=0.1701, lambda.hat=0.1998, 
    sigma.theta1=0.01, sigma.lambda=0.02, alpha=0.05)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
