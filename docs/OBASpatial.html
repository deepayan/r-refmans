<!DOCTYPE html><html><head><title>Help for package OBASpatial</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OBASpatial}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dataca20'>
<p>Calcium Content In Soil Samples.</p></a></li>
<li><a href='#dataelev'><p>Surface elevations</p></a></li>
<li><a href='#dnsrposoba'>
<p>Objective posterior density for the NSR model</p></a></li>
<li><a href='#dnsrprioroba'>
<p>Objective prior density for the NSR model</p></a></li>
<li><a href='#dtsrposoba'>
<p>Objective posterior density for the TSR model</p></a></li>
<li><a href='#dtsrprioroba'>
<p>Objective prior density for the TSR model</p></a></li>
<li><a href='#intmnorm'>
<p>Marginal posterior density for a model.</p></a></li>
<li><a href='#intmT'>
<p>Marginal posterior density for a model.</p></a></li>
<li><a href='#nsroba'>
<p>Bayesian estimation for the NSR model.</p></a></li>
<li><a href='#nsrobapred1'>
<p>Prediction under Normal Objective Bayesian Analysis (OBA).</p></a></li>
<li><a href='#summary.nsroba'><p>Summary of a nsroba object</p>
</a></li>
<li><a href='#summary.tsroba'><p>Summary of a nsroba object</p>
</a></li>
<li><a href='#tsroba'>
<p>Bayesian estimation for the TSR model.</p></a></li>
<li><a href='#tsrobapred'>

<p>Prediction under Student-t Objective Bayesian Analysis (OBA).</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Objective Bayesian Analysis for Spatial Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.9</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-11</td>
</tr>
<tr>
<td>Author:</td>
<td>Alejandro Ordonez,  Marcos O. Prates , Larissa A. Matos, Victor H. Lachos.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alejandro Ordonez &lt;ordonezjosealejandro@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats,modeest,cubature,truncdist,invgamma,LaplacesDemon,HDInterval,mvtnorm</td>
</tr>
<tr>
<td>Description:</td>
<td>It makes an objective Bayesian analysis of the spatial regression model using both the normal (NSR) and student-T (TSR) distributions. The functions provided give prior and posterior objective densities and allow default Bayesian estimation of the model regression parameters. Details can be found in Ordonez et al. (2020) &lt;<a href="https://arxiv.org/abs/2004.04341">arXiv:2004.04341</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-11 03:49:13 UTC; ALEJANDRO</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-11 04:12:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='dataca20'>
Calcium Content In Soil Samples.
</h2><span id='topic+dataca20'></span>

<h3>Description</h3>

<p>This data set contains the calcium content measured in soil samples taken from the 0-20cm layer at 178 locations within a certain study area divided in three sub-areas. The elevation at each location was also recorded.See <code>geoR</code> package for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dataca20")</code></pre>


<h3>Format</h3>

<p>A data frame with 178 observations on the following 3 variables.
</p>

<dl>
<dt><code>east</code></dt><dd><p>X Coordinate.</p>
</dd>
<dt><code>north</code></dt><dd><p>Y coordinate.</p>
</dd>
<dt><code>calcont</code></dt><dd><p>Calcium content measured in <code class="reqn">mmol_c/dm^3</code>.</p>
</dd>
<dt><code>altitude</code></dt><dd><p>A vector with the elevation of each sampling location,in meters.</p>
</dd>
<dt><code>area</code></dt><dd><p>A factor indicating the sub area to which the locations belongs.</p>
</dd>
</dl>



<h3>References</h3>

<p>Oliveira, M. C. N. (2003). Metodos de estimacao de parametros em modelos geoestatisticos com diferentes estruturas de covariancias: uma aplicacao ao teor de calcio no solo. Ph.D. thesis, ESALQ/USP/Brasil.
</p>

<hr>
<h2 id='dataelev'>Surface elevations</h2><span id='topic+dataelev'></span>

<h3>Description</h3>

<p>Surface elevation data taken from Davis (1972). An onject of the class geodata with elevation values at 52 locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dataelev")</code></pre>


<h3>Format</h3>

<p>A data frame with 52 observations on the following 3 variables.
</p>

<dl>
<dt><code>x</code></dt><dd><p>X coordinate (multiple of 50 feet).</p>
</dd>
<dt><code>y</code></dt><dd><p>Y coordinate (multiple of 50 feet).</p>
</dd>
<dt><code>elevation</code></dt><dd><p>elevations (multiples of 10 feet).</p>
</dd>
</dl>



<h3>References</h3>

<p>Davis, J.C. (1973) Statistics and Data Analysis in Geology. Wiley.
</p>

<hr>
<h2 id='dnsrposoba'>
Objective posterior density for the NSR model
</h2><span id='topic+dnsrposoba'></span>

<h3>Description</h3>

<p>It calculates the density function <code class="reqn">\pi(\phi)</code> (up to a proportionality constant) for the TSR model using the based reference, Jeffreys' rule, Jeffreys' independent and vague priors. In this context <code class="reqn">\phi</code> corresponds to the range parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dnsrposoba(x,formula,prior="reference",coords.col=1:2,
kappa=0.5,cov.model="exponential",data,asigma=2.1,intphi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dnsrposoba_+3A_x">x</code></td>
<td>

<p>The <code class="reqn">\phi</code> quantil value.
</p>
</td></tr>
<tr><td><code id="dnsrposoba_+3A_formula">formula</code></td>
<td>

<p>A valid formula for a linear regression model.
</p>
</td></tr>
<tr><td><code id="dnsrposoba_+3A_prior">prior</code></td>
<td>

<p>Objective prior densities avaiable for the TSR model: ( <code>reference</code>: Reference based, <code>jef.rul</code>: Jeffreys' rule, <code>jef.ind</code>: Jeffreys' independent).
</p>
</td></tr>
<tr><td><code id="dnsrposoba_+3A_coords.col">coords.col</code></td>
<td>

<p>A vector with the column numbers corresponding to the spatial coordinates.
</p>
</td></tr>
<tr><td><code id="dnsrposoba_+3A_kappa">kappa</code></td>
<td>

<p>Shape parameter of the covariance function (fixed).
</p>
</td></tr>
<tr><td><code id="dnsrposoba_+3A_cov.model">cov.model</code></td>
<td>
<p> Covariance functions available for the TSR
model. <code>matern</code>: Matern, <code>pow.exp</code>: power exponential, <code>exponential</code>:exponential, <code>cauchy</code>: Cauchy, <code>spherical</code>: Spherical.</p>
</td></tr>
<tr><td><code id="dnsrposoba_+3A_data">data</code></td>
<td>

<p>Data set with 2D spatial coordinates, the response and optional covariates.
</p>
</td></tr>
<tr><td><code id="dnsrposoba_+3A_asigma">asigma</code></td>
<td>

<p>Value of <code class="reqn">a</code> for  vague prior.
</p>
</td></tr>
<tr><td><code id="dnsrposoba_+3A_intphi">intphi</code></td>
<td>

<p>An interval for <code class="reqn">\phi</code> used for vague prior.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The posterior distribution is computed for this priors under the improper family <code class="reqn">\frac{\pi(\phi)}{(\sigma^2)^a}</code>. For the vague prior, it was considered the structure where a priori, <code class="reqn">\phi</code> folows an uniform distribution on the interval <code>intphi</code>.
</p>
<p>For the Jeffreys independent prior, this family of priors generates improper posterior distribution when intercept is considered for the mean function.
</p>


<h3>Value</h3>

<p>Posterior density of x=<code class="reqn">\phi</code>.
</p>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Berger, J.O,  De Oliveira, V. and Sanso, B. (2001). Objective Bayesian Analysis of Spatially Correlated Data. Journal of the American Statistical Association., 96, 1361 &ndash; 1374.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtsrposoba">dtsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(dataelev)

######### Using reference prior ###########
dnsrposoba(x=5,prior="reference",formula=elevation~1,
kappa=1,cov.model="matern",data=dataelev)

######### Using Jeffreys' rule prior ###########
dnsrposoba(x=5,prior="jef.rul",formula=elevation~1,
kappa=1,cov.model="matern",data=dataelev)

######### Using vague independent prior ###########
dnsrposoba(x=5,prior="vague",formula=elevation~1,
kappa=0.3,cov.model="matern",data=dataelev,intphi=c(0.1,10))

</code></pre>

<hr>
<h2 id='dnsrprioroba'>
Objective prior density for the NSR model
</h2><span id='topic+dnsrprioroba'></span>

<h3>Description</h3>

<p>It calculates the density function <code class="reqn">\pi(\phi)</code> (up to a proportionality constant) for the NSR model using the based reference, Jeffreys' rule and Jeffreys' independent  priors. In this context <code class="reqn">\phi</code> corresponds to the range parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dnsrprioroba(x,trend="cte",prior="reference",coords.col=1:2,
kappa=0.5,cov.model="exponential",data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dnsrprioroba_+3A_x">x</code></td>
<td>

<p>The <code class="reqn">\phi</code> quantil value.
</p>
</td></tr>
<tr><td><code id="dnsrprioroba_+3A_trend">trend</code></td>
<td>

<p>Builds the trend matrix in accordance to a specification of the mean provided by the user. See <code>DETAILS</code> below.</p>
</td></tr>
<tr><td><code id="dnsrprioroba_+3A_prior">prior</code></td>
<td>

<p>Objective prior densities avaiable for the TSR model: ( <code>reference</code>: Reference based, <code>jef.rul</code>: Jeffreys' rule, <code>jef.ind</code>: Jeffreys' independent).
</p>
</td></tr>
<tr><td><code id="dnsrprioroba_+3A_coords.col">coords.col</code></td>
<td>

<p>A vector with the column numbers corresponding to the spatial coordinates.
</p>
</td></tr>
<tr><td><code id="dnsrprioroba_+3A_kappa">kappa</code></td>
<td>

<p>Shape parameter of the covariance function (fixed).
</p>
</td></tr>
<tr><td><code id="dnsrprioroba_+3A_cov.model">cov.model</code></td>
<td>
<p> Covariance functions available for the TSR
model. <code>matern</code>: Matern, <code>pow.exp</code>: power exponential, <code>exponential</code>:exponential, <code>cauchy</code>: Cauchy, <code>spherical</code>: Spherical.</p>
</td></tr>
<tr><td><code id="dnsrprioroba_+3A_data">data</code></td>
<td>

<p>Data set with 2D spatial coordinates, the response and optional covariates.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Denote as <code class="reqn">\bold{c}=(c_{1},c_{2})</code> the coordinates of a spatial location. <code>trend</code> defines the design matrix as:
</p>

<ul>
<li> <p><code>0</code> (zero,without design matrix) Only valid for the Independent Jeffreys' prior
</p>
</li>
<li> <p><code>"cte"</code>, the design matrix is such that mean function <code class="reqn">\mu(\bold{c})=\mu</code> is constant over the region.
</p>
</li>
<li> <p><code>"1st"</code>, the design matrix is such that mean function becames a first order polynomial on the coordinates:
</p>
<p style="text-align: center;"><code class="reqn">\mu(\bold(c))=\beta_0+ \beta_1c_1+\beta_2c_2</code>
</p>

</li>
<li> <p><code>"2nd"</code>, the design matrix is such that mean function <code class="reqn">\mu(\bold{c})=\mu</code> becames a second order polynomial on the coordinates:
</p>
<p style="text-align: center;"><code class="reqn">\mu(\bold(c))=\beta_0+ \beta_1c_1+\beta_2c_2 + \beta_3c_{1}^2+ \beta_4c_{2}^2+ \beta_5c_1c_2</code>
</p>

</li>
<li> <p><code>~model</code> a model specification to include covariates (external trend) in the model.
</p>
</li></ul>



<h3>Value</h3>

<p>Prior density of x=<code class="reqn">\phi</code>
</p>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Berger, J.O,  De Oliveira, V. and Sanso, B. (2001). Objective Bayesian Analysis of Spatially Correlated Data. Journal of the American Statistical Association., 96, 1361 &ndash; 1374.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtsrposoba">dtsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrposoba">dnsrposoba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dataelev)## data using by Berger et. al (2001)

######### Using reference prior ###########
dnsrprioroba(x=20,kappa=0.3,cov.model="matern",data=dataelev)


######### Using jef.rule prior###########
dnsrprioroba(x=20,prior="jef.rul",kappa=0.3,cov.model="matern",
data=dataelev)

######### Using  jef.ind prior ###########
dnsrprioroba(x=20,prior="jef.ind",trend=0,
kappa=0.3,cov.model="matern",data=dataelev)
</code></pre>

<hr>
<h2 id='dtsrposoba'>
Objective posterior density for the TSR model
</h2><span id='topic+dtsrposoba'></span>

<h3>Description</h3>

<p>It calculates the density function <code class="reqn">\pi(\phi,\nu)</code> (up to a proportionality constant) for the TSR model using the based reference, Jeffreys' rule, Jeffreys' independent and vague priors. In this context <code class="reqn">\phi</code> corresponds to the range parameter and <code class="reqn">\nu</code> to the degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtsrposoba(x,formula,prior="reference",coords.col=1:2,
kappa=0.5,cov.model="exponential",data,asigma=2.1,intphi,intnu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dtsrposoba_+3A_x">x</code></td>
<td>

<p>A vector with the quanties <code class="reqn">(\phi,\nu)</code>. For the vague prior x must be a three dimension vector <code class="reqn">(\phi,\nu,\lambda)</code> with <code class="reqn">\lambda</code> a number in the interval <code class="reqn">(0.02,0.5)</code>. See <code>DETAILS</code> below.
</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_formula">formula</code></td>
<td>

<p>A valid formula for a linear regression model.
</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_prior">prior</code></td>
<td>

<p>Objective prior densities avaiable for the TSR model: ( <code>reference</code>: Reference based, <code>jef.rul</code>: Jeffreys' rule, <code>jef.ind</code>: Jeffreys' independent).
</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_coords.col">coords.col</code></td>
<td>

<p>A vector with the column numbers corresponding to the spatial coordinates.
</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_kappa">kappa</code></td>
<td>

<p>Shape parameter of the covariance function (fixed).
</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_cov.model">cov.model</code></td>
<td>
<p> Covariance functions available for the TSR
model. <code>matern</code>: Matern, <code>pow.exp</code>: power exponential, <code>exponential</code>:exponential, <code>cauchy</code>: Cauchy, <code>spherical</code>: Spherical.</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_data">data</code></td>
<td>

<p>Data set with 2D spatial coordinates, the response and optional covariates.
</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_asigma">asigma</code></td>
<td>

<p>Value of <code class="reqn">a</code> for  vague prior.
</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_intphi">intphi</code></td>
<td>

<p>An interval for <code class="reqn">\phi</code> used for vague prior.
</p>
</td></tr>
<tr><td><code id="dtsrposoba_+3A_intnu">intnu</code></td>
<td>

<p>An interval for <code class="reqn">\nu</code> used for vague prior.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The posterior distribution is computed for this priors under the improper family <code class="reqn">\frac{\pi(\phi,\nu)}{(\sigma^2)^a}</code>. For the vague prior, it was considered the structure <code class="reqn">\pi(\phi,\nu,\lambda)=\phi(\phi)\pi(\nu|\lambda)\pi(\lambda)</code> where a priori, <code class="reqn">\phi</code> follows an uniform distribution on the interval <code>intphi</code>, <code class="reqn">\nu|\lambda~ Texp(\lambda,A)</code> with A the interval given by the argument <code>intnu</code> and <code class="reqn">\lambda~unif(0.02,0.5)</code>.
</p>
<p>For the Jeffreys independent prior, this family of priors generates improper posterior distribution when intercept is considered for the mean function.
</p>


<h3>Value</h3>

<p>Posterior density of x=(<code class="reqn">\phi,\nu</code>) for the reference based, Jeffreys' rule and Jeffreys' independent priors. For the vague the result is the posterior density of x=(<code class="reqn">\phi,\nu,\lambda</code>)
</p>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Ordonez, J.A, M.O. Prattes, L.A. Matos, and V.H. Lachos (2020+). Objective Bayesian analysis for spatial Student-t regression models (Submitted).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnsrposoba">dnsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataca20)

######### Using reference prior ###########
dtsrposoba(x=c(5,11),prior="reference",formula=calcont~altitude+area,
kappa=0.3,cov.model="matern",data=dataca20)

######### Using Jeffreys' rule prior ###########
dtsrposoba(x=c(5,11),prior="jef.rul",formula=calcont~altitude+area,
kappa=0.3,cov.model="matern",data=dataca20)


######### Using Jeffreys' independent prior ###########
dtsrposoba(x=c(5,11),prior="jef.ind",formula=calcont~altitude+area
,kappa=0.3,cov.model="matern",data=dataca20)

######### Using vague independent prior ###########
dtsrposoba(x=c(5,11,.3),prior="vague",formula=calcont~altitude+area,
kappa=0.3,cov.model="matern",data=dataca20,intphi=c(0.1,10),
intnu=c(4.1,30))
</code></pre>

<hr>
<h2 id='dtsrprioroba'>
Objective prior density for the TSR model
</h2><span id='topic+dtsrprioroba'></span>

<h3>Description</h3>

<p>It calculates the density function <code class="reqn">\pi(\phi,\nu)</code> (up to a proportionality constant) for the TSR model using the based reference, Jeffreys' rule and Jeffreys' independent  priors. In this context <code class="reqn">\phi</code> corresponds to the range parameter and <code class="reqn">\nu</code> to the degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtsrprioroba(x,trend="cte",prior="reference",coords.col=1:2,
kappa=0.5,cov.model="exponential",data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dtsrprioroba_+3A_x">x</code></td>
<td>

<p>A vector with the quanties <code class="reqn">(\phi,\nu)</code>
</p>
</td></tr>
<tr><td><code id="dtsrprioroba_+3A_trend">trend</code></td>
<td>

<p>Builds the trend matrix in accordance to a specification of the mean provided by the user. See <code>DETAILS</code> below.</p>
</td></tr>
<tr><td><code id="dtsrprioroba_+3A_prior">prior</code></td>
<td>

<p>Objective prior densities avaiable for the TSR model: ( <code>reference</code>: Reference based, <code>jef.rul</code>: Jeffreys' rule, <code>jef.ind</code>: Jeffreys' independent)
</p>
</td></tr>
<tr><td><code id="dtsrprioroba_+3A_coords.col">coords.col</code></td>
<td>

<p>A vector with the column numbers corresponding to the spatial coordinates.
</p>
</td></tr>
<tr><td><code id="dtsrprioroba_+3A_kappa">kappa</code></td>
<td>

<p>Shape parameter of the covariance function (fixed)
</p>
</td></tr>
<tr><td><code id="dtsrprioroba_+3A_cov.model">cov.model</code></td>
<td>
<p> Covariance functions available for the TSR
model. <code>matern</code>: Matern, <code>pow.exp</code>: power exponential, <code>exponential</code>:exponential, <code>cauchy</code>: Cauchy, <code>spherical</code>: Spherical</p>
</td></tr>
<tr><td><code id="dtsrprioroba_+3A_data">data</code></td>
<td>

<p>Data set with 2D spatial coordinates, the response and optional covariates
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Denote as <code class="reqn">\bold{c}=(c_{1},c_{2})</code> the coordinates of a spatial location. <code>trend</code> defines the design matrix as:
</p>

<ul>
<li> <p><code>0</code> (zero,without design matrix) Only valid for the Independent Jeffreys' prior
</p>
</li>
<li> <p><code>"cte"</code>, the design matrix is such that mean function <code class="reqn">\mu(\bold{c})=\mu</code> is constant over the region.
</p>
</li>
<li> <p><code>"1st"</code>, the design matrix is such that mean function becames a first order polynomial on the coordinates:
</p>
<p style="text-align: center;"><code class="reqn">\mu(\bold(c))=\beta_0+ \beta_1c_1+\beta_2c_2</code>
</p>

</li>
<li> <p><code>"2nd"</code>, the design matrix is such that mean function <code class="reqn">\mu(\bold{c})=\mu</code> becames a second order polynomial on the coordinates:
</p>
<p style="text-align: center;"><code class="reqn">\mu(\bold(c))=\beta_0+ \beta_1c_1+\beta_2c_2 + \beta_3c_{1}^2+ \beta_4c_{2}^2+ \beta_5c_1c_2</code>
</p>

</li>
<li> <p><code>~model</code> a model specification to include covariates (external trend) in the model.
</p>
</li></ul>



<h3>Value</h3>

<p>Density of x=(<code class="reqn">\phi,\nu</code>)
</p>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Ordonez, J.A, M.O. Prattes, L.A. Matos, and V.H. Lachos (2020+). Objective Bayesian analysis for spatial Student-t regression models (Submitted).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtsrposoba">dtsrposoba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a></code>,<code><a href="#topic+dnsrposoba">dnsrposoba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataca20)

######### Using reference prior and a constant trend###########
dtsrprioroba(x=c(6,100),kappa=0.3,cov.model="matern",data=dataca20)


######### Using jef.rule prior and 1st trend###########
dtsrprioroba(x=c(6,100),prior="jef.rul",trend=~altitude+area,
kappa=0.3,cov.model="matern",data=dataca20)

######### Using  jef.ind prior ###########
dtsrprioroba(x=c(6,100),prior="jef.ind",trend=0,
kappa=0.3,cov.model="matern",data=dataca20)
</code></pre>

<hr>
<h2 id='intmnorm'>
Marginal posterior density for a model.
</h2><span id='topic+intmnorm'></span>

<h3>Description</h3>

<p>It calculates the marginal density density for a model <code class="reqn">M</code> (up to a proportionality constant) for the NSR model using the based reference, Jeffreys' rule, Jeffreys' independent and vague  priors.  In this context <code class="reqn">\phi</code> corresponds to the range parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intmnorm(formula,prior="reference",coords.col=1:2,kappa=0.5,
cov.model="exponential",data,asigma=2.1,intphi,maxEval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intmnorm_+3A_formula">formula</code></td>
<td>

<p>A valid formula for a linear regression model.
</p>
</td></tr>
<tr><td><code id="intmnorm_+3A_prior">prior</code></td>
<td>

<p>Objective prior densities avaiable for the TSR model: ( <code>reference</code>: Reference based, <code>jef.rul</code>: Jeffreys' rule, <code>jef.ind</code>: Jeffreys' independent).
</p>
</td></tr>
<tr><td><code id="intmnorm_+3A_coords.col">coords.col</code></td>
<td>

<p>A vector with the column numbers corresponding to the spatial coordinates.
</p>
</td></tr>
<tr><td><code id="intmnorm_+3A_kappa">kappa</code></td>
<td>

<p>Shape parameter of the covariance function (fixed).
</p>
</td></tr>
<tr><td><code id="intmnorm_+3A_cov.model">cov.model</code></td>
<td>
<p> Covariance functions available for the TSR
model. <code>matern</code>: Matern, <code>pow.exp</code>: power exponential, <code>exponential</code>:exponential, <code>cauchy</code>: Cauchy, <code>spherical</code>: Spherical.</p>
</td></tr>
<tr><td><code id="intmnorm_+3A_data">data</code></td>
<td>

<p>Data set with 2D spatial coordinates, the response and optional covariates.
</p>
</td></tr>
<tr><td><code id="intmnorm_+3A_asigma">asigma</code></td>
<td>

<p>Value of <code class="reqn">a</code> for  vague prior.
</p>
</td></tr>
<tr><td><code id="intmnorm_+3A_intphi">intphi</code></td>
<td>

<p>An interval for <code class="reqn">\phi</code> used for vague prior.
</p>
</td></tr>
<tr><td><code id="intmnorm_+3A_maxeval">maxEval</code></td>
<td>

<p>Maximum number of iterations for the integral computation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">m_k</code> a parametric model with parameter vector <code class="reqn">\theta_k</code>. Under the TSR model and the prior density proposal:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\pi(\phi)}{(\sigma^2)^a}</code>
</p>

<p>we have that the marginal density is given by:
</p>
<p style="text-align: center;"><code class="reqn">\int L(\theta_{m_k})\pi(m_k)dm_k</code>
</p>

<p>This quantity can be useful as a criteria for model selection. The computation of <code class="reqn">m_k</code> could be compute demanding depending on the number of iterations in <code>maxEval</code>.
</p>


<h3>Value</h3>

<p>Marginal density of the model <code class="reqn">m_k</code> for the reference based, Jeffreys' rule, Jeffreys' independent and vague priors.
</p>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Berger, J.O,  De Oliveira, V. and Sanso, B. (2001). Objective Bayesian Analysis of Spatially Correlated Data. Journal of the American Statistical Association., 96, 1361 &ndash; 1374.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnsrposoba">dnsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>





data(dataca20)

set.seed(25)
data(dataelev)## data using by Berger et. al (2001)

######### Using reference prior ###########
m1=intmnorm(prior="reference",formula=elevation~1,
kappa=0.5,cov.model="matern",data=dataelev,maxEval=1000)

log(m1)


######### Using reference prior kappa=1 ###########
m2=intmnorm(prior="reference",formula=elevation~1,
kappa=1,cov.model="matern",data=dataelev,maxEval=1000)
log(m2)

######### Using reference prior kappa=1.5 ###########
m3=intmnorm(prior="reference",formula=elevation~1
,kappa=1.5,cov.model="matern",data=dataelev,maxEval=1000)
log(m3)

tot=m1+m2+m3

########posterior probabilities: higher probability:
#########prior="reference", kappa=1
p1=m1/tot
p2=m2/tot
p3=m3/tot

</code></pre>

<hr>
<h2 id='intmT'>
Marginal posterior density for a model.
</h2><span id='topic+intmT'></span>

<h3>Description</h3>

<p>It calculates the marginal density density for a model <code class="reqn">M</code> (up to a proportionality constant) for the TSR model using the based reference, Jeffreys' rule, Jeffreys' independent and vague  priors.  In this context <code class="reqn">\phi</code> corresponds to the range parameter and <code class="reqn">\nu</code> to the degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intmT(formula,prior="reference",coords.col=1:2,kappa=0.5,
cov.model="exponential",data,asigma,intphi="default",intnu=c(4.1,Inf),maxEval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intmT_+3A_formula">formula</code></td>
<td>

<p>A valid formula for a linear regression model.
</p>
</td></tr>
<tr><td><code id="intmT_+3A_prior">prior</code></td>
<td>

<p>Objective prior densities avaiable for the TSR model: ( <code>reference</code>: Reference based, <code>jef.rul</code>: Jeffreys' rule, <code>jef.ind</code>: Jeffreys' independent).
</p>
</td></tr>
<tr><td><code id="intmT_+3A_coords.col">coords.col</code></td>
<td>

<p>A vector with the column numbers corresponding to the spatial coordinates.
</p>
</td></tr>
<tr><td><code id="intmT_+3A_kappa">kappa</code></td>
<td>

<p>Shape parameter of the covariance function (fixed).
</p>
</td></tr>
<tr><td><code id="intmT_+3A_cov.model">cov.model</code></td>
<td>
<p> Covariance functions available for the TSR
model. <code>matern</code>: Matern, <code>pow.exp</code>: power exponential, <code>exponential</code>:exponential, <code>cauchy</code>: Cauchy, <code>spherical</code>: Spherical.</p>
</td></tr>
<tr><td><code id="intmT_+3A_data">data</code></td>
<td>

<p>Data set with 2D spatial coordinates, the response and optional covariates.
</p>
</td></tr>
<tr><td><code id="intmT_+3A_asigma">asigma</code></td>
<td>

<p>Value of <code class="reqn">a</code> for  vague prior.
</p>
</td></tr>
<tr><td><code id="intmT_+3A_intphi">intphi</code></td>
<td>

<p>An interval for <code class="reqn">\phi</code> used for vague prior.
</p>
</td></tr>
<tr><td><code id="intmT_+3A_intnu">intnu</code></td>
<td>

<p>An interval for <code class="reqn">\nu</code> used for vague prior.
</p>
</td></tr>
<tr><td><code id="intmT_+3A_maxeval">maxEval</code></td>
<td>

<p>Maximum number of iterations for the integral computation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">m_k</code> a parametric model with parameter vector <code class="reqn">\theta_k</code>. Under the TSR model and the prior density proposal:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\pi(\phi,\nu)}{(\sigma^2)^a}</code>
</p>

<p>we have that the marginal density is given by:
</p>
<p style="text-align: center;"><code class="reqn">\int L(\theta_{m_k})\pi(m_k)dm_k</code>
</p>

<p>This quantity can be useful as a criteria for model selection. The computation of <code class="reqn">m_k</code> could be compute demanding depending on the number of iterations in <code>maxEval</code>.
</p>


<h3>Value</h3>

<p>Marginal density of the model <code class="reqn">m_k</code> for the reference based, Jeffreys' rule, Jeffreys' independent and vague priors.
</p>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Ordonez, J.A, M.O. Prattes, L.A. Matos, and V.H. Lachos (2020+). Objective Bayesian analysis for spatial Student-t regression models (Submitted).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnsrposoba">dnsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>




set.seed(25)
data(dataca20)



######### Using reference prior ###########
m1=intmT(prior="reference",formula=calcont~altitude+area,
kappa=0.3,cov.model="matern",data=dataca20,maxEval=1000)

######### Using Jeffreys' rule prior ###########
m1j=intmT(prior="jef.rul",formula=calcont~altitude+area,
kappa=0.3,cov.model="matern",data=dataca20,maxEval=1000)


######### Using Jeffreys' independent prior ###########
m1ji=intmT(prior="jef.ind",formula=calcont~altitude+area
,kappa=0.3,cov.model="matern",data=dataca20,maxEval=1000)

m1v=intmT(prior="vague",formula=calcont~altitude+area
,kappa=0.3,cov.model="matern",data=dataca20,maxEval=1000,intphi="default")




tot=m1+m1j+m1ji+m1v

########posterior probabilities: higher probability:
#########prior="reference", kappa=0.3


p1=m1/tot
pj=m1j/tot
pji=m1ji/tot
pv=m1v/tot



</code></pre>

<hr>
<h2 id='nsroba'>
Bayesian estimation for the NSR model.
</h2><span id='topic+nsroba'></span>

<h3>Description</h3>

<p>This function performs Bayesian estimation of <code class="reqn">\theta=(\bold{\beta},\sigma^2,\phi)</code> for the NSR model using the based reference, Jeffreys' rule ,Jeffreys' independent and vague  priors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsroba(formula, method="median",
prior = "reference",coords.col = 1:2,kappa = 0.5,
cov.model = "matern", data,asigma=2.1, intphi = "default",
ini.pars, burn=500, iter=5000, thin=10,
cprop = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nsroba_+3A_formula">formula</code></td>
<td>

<p>A valid formula for a linear regression model.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_method">method</code></td>
<td>

<p>Method to estimate (<code class="reqn">\bold{beta},\sigma,\phi</code>). The methods availables are <code>"mean"</code>,<code>"median"</code> and <code>"mode"</code>.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_prior">prior</code></td>
<td>

<p>Objective prior densities avaiable for the TSR model: ( <code>reference</code>: Reference based, <code>jef.rul</code>: Jeffreys' rule, <code>jef.ind</code>: Jeffreys' independent, <code>vague</code>, Vague).
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_coords.col">coords.col</code></td>
<td>

<p>A vector with the column numbers corresponding to the spatial coordinates.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_kappa">kappa</code></td>
<td>

<p>Shape parameter of the covariance function (fixed).
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_cov.model">cov.model</code></td>
<td>
<p> Covariance functions available for the TSR
model. <code>matern</code>: Matern, <code>pow.exp</code>: power exponential, <code>exponential</code>:exponential, <code>cauchy</code>: Cauchy, <code>spherical</code>: Spherical.</p>
</td></tr>
<tr><td><code id="nsroba_+3A_data">data</code></td>
<td>

<p>Data set with 2D spatial coordinates, the response and optional covariates.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_asigma">asigma</code></td>
<td>

<p>Value of <code class="reqn">a</code> for  the vague prior.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_intphi">intphi</code></td>
<td>

<p>An interval for <code class="reqn">\phi</code> used for the uniform proposal. See <code>DETAILS</code> below.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_ini.pars">ini.pars</code></td>
<td>

<p>Initial values for <code class="reqn">(\sigma^2,\phi)</code> in that order.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_burn">burn</code></td>
<td>

<p>Number of observations considered in the burning process.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_iter">iter</code></td>
<td>

<p>Number of iterations for the sampling procedure.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_thin">thin</code></td>
<td>

<p>Number of observations considered in the thin process.
</p>
</td></tr>
<tr><td><code id="nsroba_+3A_cprop">cprop</code></td>
<td>

<p>A constant related to the acceptance probability
(Default = NULL indicates that cprop is computed as the interval length of intphi). See
<code>DETAILS</code> below.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code>"unif"</code> proposal, it was considered the structure where a priori, <code class="reqn">\phi</code> follows an uniform distribution on the interval <code>intphi</code>. By default, this interval is computed using the empirical range of data as well as the constant <code>cprop</code>.
</p>
<p>For the Jeffreys independent prior, the sampling procedure generates improper posterior distribution when intercept is considered for the mean function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>$dist</code></td>
<td>

<p>Joint sample (matrix object) obtaining for (<code class="reqn">\bold{beta},\sigma^2,\phi</code>).
</p>
</td></tr>
<tr><td><code>$betaF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\bold{beta}</code>.
</p>
</td></tr>
<tr><td><code>$sigmaF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\sigma^2</code>.
</p>
</td></tr>
<tr><td><code>$phiF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\phi</code>.
</p>
</td></tr>
<tr><td><code>$coords</code></td>
<td>

<p>Spatial data coordinates.
</p>
</td></tr>
<tr><td><code>$kappa</code></td>
<td>

<p>Shape parameter of the covariance function.
</p>
</td></tr>
<tr><td><code>$X</code></td>
<td>

<p>Design matrix of the model.
</p>
</td></tr>
<tr><td><code>$type</code></td>
<td>

<p>Covariance function of the model.
</p>
</td></tr>
<tr><td><code>$theta</code></td>
<td>

<p>Bayesian estimator of (<code class="reqn">\bold{beta},\sigma,\phi</code>).
</p>
</td></tr>
<tr><td><code>$y</code></td>
<td>

<p>Response variable.
</p>
</td></tr>
<tr><td><code>$prior</code></td>
<td>

<p>Prior density considered.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Berger, J.O,  De Oliveira, V. and Sanso, B. (2001). Objective Bayesian Analysis of Spatially Correlated Data. Journal of the American Statistical Association., 96, 1361 &ndash; 1374.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnsrposoba">dnsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a>,<a href="#topic+tsroba">tsroba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>





set.seed(25)
data(dataelev)


######covariance matern: kappa=0.5
res=nsroba(elevation~1, kappa = 0.5, cov.model = "matern", data=dataelev,
ini.pars=c(10,390))

summary(res)

######covariance matern: kappa=1
res1=nsroba(elevation~1, kappa = 1, cov.model = "matern", data=dataelev,
ini.pars=c(10,390))

summary(res1)

######covariance matern: kappa=1.5
res2=nsroba(elevation~1, kappa = 1.5, cov.model = "matern", data=dataelev,
ini.pars=c(10,390))

summary(res2)




</code></pre>

<hr>
<h2 id='nsrobapred1'>
Prediction under Normal Objective Bayesian Analysis (OBA).
</h2><span id='topic+nsrobapred1'></span>

<h3>Description</h3>

<p>This function uses the sampling distribution of parameters obtained from the function <code>tsroba</code> to predict values at unknown locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsrobapred1(xpred, coordspred, obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nsrobapred1_+3A_xpred">xpred</code></td>
<td>

<p>Values of the X design matrix for prediction coordinates.
</p>
</td></tr>
<tr><td><code id="nsrobapred1_+3A_coordspred">coordspred</code></td>
<td>

<p>Points coordinates to be predicted.
</p>
</td></tr>
<tr><td><code id="nsrobapred1_+3A_obj">obj</code></td>
<td>


<p>object of the class &quot;nsroba&quot; (see <code><a href="#topic+nsroba">nsroba</a></code> function).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function predicts using the sampling distribution of parameters obtained from the function <code>nsroba</code> and the conditional normal distribution of the predicted values given the data.
</p>


<h3>Value</h3>

<p>This function returns a vector with the predicted values at the specified locations.
</p>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Berger, J.O,  De Oliveira, V. and Sanso, B. (2001). Objective Bayesian Analysis of Spatially Correlated Data. Journal of the American Statistical Association., 96, 1361 &ndash; 1374.
</p>
<p>Diggle, P. and P. Ribeiro (2007).Model-Based Geostatistics.  Springer Series in Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nsroba">nsroba</a></code>,<code><a href="#topic+tsrobapred">tsrobapred</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>





set.seed(25)
data(dataelev)
d1=dataelev[1:42,]

reselev=nsroba(elevation~1, kappa = 0.5, cov.model = "matern", data=d1,
ini.pars=c(10,3),intphi=c(0.8,10))

datapred1=dataelev[43:52,]
coordspred1=datapred1[,1:2]
nsrobapred1(obj=reselev,coordspred=coordspred1,xpred=rep(1,10))

</code></pre>

<hr>
<h2 id='summary.nsroba'>Summary of a nsroba object

</h2><span id='topic+summary.nsroba'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;nsroba&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nsroba'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.nsroba_+3A_object">object</code></td>
<td>


<p>object of the class &quot;nsroba&quot; (see <code><a href="#topic+nsroba">nsroba</a></code> function).
</p>
</td></tr>
<tr><td><code id="summary.nsroba_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mean.str</code></td>
<td>

<p>Estimates for the mean structure parameters <code class="reqn">\bold{beta}</code>.
</p>
</td></tr>
<tr><td><code>var.str</code></td>
<td>

<p>Estimates for the variance structure parameters <code class="reqn">\sigma^2, \phi</code>.
</p>
</td></tr>
<tr><td><code>betaF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\bold{beta}</code>.
</p>
</td></tr>
<tr><td><code>sigmaF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\sigma^2</code>.
</p>
</td></tr>
<tr><td><code>phiF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\phi</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Berger, J.O,  De Oliveira, V. and Sanso, B. (2001). Objective Bayesian Analysis of Spatially Correlated Data. Journal of the American Statistical Association., 96, 1361 &ndash; 1374.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnsrposoba">dnsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a>,<a href="#topic+tsroba">tsroba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>





set.seed(25)
data(dataelev)


######covariance matern: kappa=0.5
res=nsroba(elevation~1, kappa = 0.5, cov.model = "matern", data=dataelev,
ini.pars=c(10,3))

summary(res)




</code></pre>

<hr>
<h2 id='summary.tsroba'>Summary of a nsroba object

</h2><span id='topic+summary.tsroba'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;tsroba&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsroba'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.tsroba_+3A_object">object</code></td>
<td>


<p>object of the class &quot;tsroba&quot; (see <code><a href="#topic+tsroba">tsroba</a></code> function).
</p>
</td></tr>
<tr><td><code id="summary.tsroba_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mean.str</code></td>
<td>

<p>Estimates for the mean structure parameters <code class="reqn">\bold{beta}</code>.
</p>
</td></tr>
<tr><td><code>var.str</code></td>
<td>

<p>Estimates for the variance structure parameters <code class="reqn">\sigma^2, \phi, \nu</code>.
</p>
</td></tr>
<tr><td><code>betaF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\bold{beta}</code>.
</p>
</td></tr>
<tr><td><code>sigmaF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\sigma^2</code>.
</p>
</td></tr>
<tr><td><code>phiF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\phi</code>.
</p>
</td></tr>
<tr><td><code>nuF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\nu</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Ordonez, J.A, M.O. Prattes, L.A. Matos, and V.H. Lachos (2020+). Objective Bayesian analysis for spatial Student-t regression models. (Submitted)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnsrposoba">dnsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a></code>,<code><a href="#topic+tsroba">tsroba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>





set.seed(25)
data(dataca20)
d1=dataca20[1:158,]

xpred=model.matrix(calcont~altitude+area,data=dataca20[159:178,])
xobs=model.matrix(calcont~altitude+area,data=dataca20[1:158,])
coordspred=dataca20[159:178,1:2]

######covariance matern: kappa=0.3 prior:reference
res=tsroba(calcont~altitude+area, kappa = 0.3, data=d1,
           ini.pars=c(10,3,10))

summary(res)

</code></pre>

<hr>
<h2 id='tsroba'>
Bayesian estimation for the TSR model.
</h2><span id='topic+tsroba'></span>

<h3>Description</h3>

<p>This function performs Bayesian estimation of <code class="reqn">\theta=(\bold{\beta},\sigma^2,\phi)</code> for the TSR model using the based reference, Jeffreys' rule ,Jeffreys' independent and vague  priors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsroba(formula, method="median",sdnu=1,
prior = "reference",coords.col = 1:2,kappa = 0.5,
cov.model = "matern", data,asigma=2.1, intphi = "default",
intnu="default",ini.pars,burn=500, iter=5000,thin=10,cprop = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsroba_+3A_formula">formula</code></td>
<td>

<p>A valid formula for a linear regression model.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_method">method</code></td>
<td>

<p>Method to estimate (<code class="reqn">\bold{beta},\sigma,\phi,\nu</code>). The methods availables are <code>"mean"</code>,<code>"median"</code> and <code>"mode"</code>.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_sdnu">sdnu</code></td>
<td>

<p>Standard deviation logarithm for the lognormal proposal for <code class="reqn">\nu</code>
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_prior">prior</code></td>
<td>

<p>Objective prior densities avaiable for the TSR model: ( <code>reference</code>: Reference based, <code>jef.rul</code>: Jeffreys' rule, <code>jef.ind</code>: Jeffreys' independent,<code>vague</code>: Vague).
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_coords.col">coords.col</code></td>
<td>

<p>A vector with the column numbers corresponding to the spatial coordinates.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_kappa">kappa</code></td>
<td>

<p>Shape parameter of the covariance function (fixed).
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_cov.model">cov.model</code></td>
<td>
<p> Covariance functions available for the TSR
model. <code>matern</code>: Matern, <code>pow.exp</code>: power exponential, <code>exponential</code>:exponential, <code>cauchy</code>: Cauchy, <code>spherical</code>: Spherical.</p>
</td></tr>
<tr><td><code id="tsroba_+3A_data">data</code></td>
<td>

<p>Data set with 2D spatial coordinates, the response and optional covariates.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_asigma">asigma</code></td>
<td>

<p>Value of <code class="reqn">a</code> for  vague prior.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_intphi">intphi</code></td>
<td>

<p>An interval for <code class="reqn">\phi</code> used for the uniform proposal. See <code>DETAILS</code> below.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_intnu">intnu</code></td>
<td>

<p>An interval for <code class="reqn">\nu</code> used for the uniform proposal. See <code>DETAILS</code> below.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_ini.pars">ini.pars</code></td>
<td>

<p>Initial values for <code class="reqn">(\sigma^2,\phi,\nu)</code> in that order.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_burn">burn</code></td>
<td>

<p>Number of observations considered in burning process.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_iter">iter</code></td>
<td>

<p>Number of iterations for the sampling procedure.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_thin">thin</code></td>
<td>

<p>Number of observations considered in thin process.
</p>
</td></tr>
<tr><td><code id="tsroba_+3A_cprop">cprop</code></td>
<td>

<p>A constant related to the acceptance probability (Default = NULL indicates that cprop is computed as the interval length of intphi). See
<code>DETAILS</code> below.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the prior proposal, it was considered the structure <code class="reqn">\pi(\phi,\nu,\lambda)=\phi(\phi)\pi(\nu|\lambda)\pi(\lambda)</code>. For the vague  prior, <code class="reqn">\phi</code> follows an uniform distribution on the interval <code>intphi</code>, by default, this interval is computed using the empirical range of data as well as the constant <code>cprop</code>. On the other hand, <code class="reqn">\nu|\lambda~ Texp(\lambda,A)</code> with A the interval given by the argument <code>intnu</code> and <code class="reqn">\lambda~unif(0.02,0.5)</code>
</p>
<p>For the Jeffreys independent prior, the sampling procedure generates improper posterior distribution when intercept is considered for the mean function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>dist</code></td>
<td>

<p>Joint sample (matrix object) obtaining for (<code class="reqn">\bold{beta},\sigma^2,\phi</code>).
</p>
</td></tr>
<tr><td><code>betaF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\bold{beta}</code>.
</p>
</td></tr>
<tr><td><code>sigmaF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\sigma^2</code>.
</p>
</td></tr>
<tr><td><code>phiF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\phi</code>.
</p>
</td></tr>
<tr><td><code>nuF</code></td>
<td>

<p>Sample obtained for <code class="reqn">\phi</code>.
</p>
</td></tr>
<tr><td><code>coords</code></td>
<td>

<p>Spatial data coordinates.
</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>

<p>Shape parameter of the covariance function.
</p>
</td></tr>
<tr><td><code>$X</code></td>
<td>

<p>Design matrix of the model.
</p>
</td></tr>
<tr><td><code>$type</code></td>
<td>

<p>Covariance function of the model.
</p>
</td></tr>
<tr><td><code>$theta</code></td>
<td>

<p>Bayesian estimator of (<code class="reqn">\bold{beta},\sigma,\phi</code>).
</p>
</td></tr>
<tr><td><code>$y</code></td>
<td>

<p>Response variable.
</p>
</td></tr>
<tr><td><code>$prior</code></td>
<td>

<p>Prior density considered.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Ordonez, J.A, M.O. Prattes, L.A. Matos, and V.H. Lachos (2020+). Objective Bayesian analysis for spatial Student-t regression models. (Submitted)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnsrposoba">dnsrposoba</a></code>,<code><a href="#topic+dtsrprioroba">dtsrprioroba</a></code>,<code><a href="#topic+dnsrprioroba">dnsrprioroba</a></code>,<code><a href="#topic+tsroba">tsroba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>





set.seed(25)
data(dataca20)
d1=dataca20[1:158,]

xpred=model.matrix(calcont~altitude+area,data=dataca20[159:178,])
xobs=model.matrix(calcont~altitude+area,data=dataca20[1:158,])
coordspred=dataca20[159:178,1:2]

######covariance matern: kappa=0.3 prior:reference
res=tsroba(calcont~altitude+area, kappa = 0.3, data=d1,
           ini.pars=c(10,390,10),iter=11000,burn=1000,thin=10)

summary(res)

######covariance matern: kappa=0.3 prior:jef.rul
res1=tsroba(calcont~altitude+area, kappa = 0.3,
            data=d1,prior="jef.rul",ini.pars=c(10,390,10),
            iter=11000,burn=1000,thin=10)

summary(res1)

######covariance matern: kappa=0.3 prior:jef.ind
res2=tsroba(calcont~altitude+area, kappa = 0.3, data=d1,
            prior="jef.ind",ini.pars=c(10,390,10),iter=11000,
            burn=1000,thin=10)

summary(res2)

######covariance matern: kappa=0.3 prior:vague
res3=tsroba(calcont~altitude+area, kappa = 0.3,
     data=d1,prior="vague",ini.pars=c(10,390,10),,iter=11000,
     burn=1000,thin=10)

summary(res3)

####obtaining posterior probabilities
###(just comparing priors with kappa=0.3).
###the real aplication (see Ordonez et.al) consider kappa=0.3,0.5,0.7.

######### Using reference prior ###########
m1=intmT(prior="reference",formula=calcont~altitude+area,
kappa=0.3,cov.model="matern",data=dataca20,maxEval=1000)

######### Using Jeffreys' rule prior ###########
m1j=intmT(prior="jef.rul",formula=calcont~altitude+area,
kappa=0.3,cov.model="matern",data=dataca20,maxEval=1000)


######### Using Jeffreys' independent prior ###########
m1ji=intmT(prior="jef.ind",formula=calcont~altitude+area
,kappa=0.3,cov.model="matern",data=dataca20,maxEval=1000)

m1v=intmT(prior="vague",formula=calcont~altitude+area
,kappa=0.3,cov.model="matern",data=dataca20,maxEval=1000,intphi="default")


tot=m1+m1j+m1ji+m1v

####posterior probabilities#####
p1=m1/tot
pj=m1j/tot
pji=m1ji/tot
pv=m1v/tot


##########MSPE#######################################

pme=tsrobapred(res,xpred=xpred,coordspred=coordspred)
pme1=tsrobapred(res1,xpred=xpred,coordspred=coordspred)
pme2=tsrobapred(res2,xpred=xpred,coordspred=coordspred)
pme3=tsrobapred(res3,xpred=xpred,coordspred=coordspred)

mse=mean((pme-dataca20$calcont[159:178])^2)
mse1=mean((pme1-dataca20$calcont[159:178])^2)
mse2=mean((pme2-dataca20$calcont[159:178])^2)
mse3=mean((pme3-dataca20$calcont[159:178])^2)


</code></pre>

<hr>
<h2 id='tsrobapred'>

Prediction under Student-t Objective Bayesian Analysis (OBA).
</h2><span id='topic+tsrobapred'></span>

<h3>Description</h3>


<p>This function uses the sampling distribution of parameters obtained from the function <code>tsroba</code> to predict values at unknown locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsrobapred(obj,xpred,coordspred)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsrobapred_+3A_obj">obj</code></td>
<td>


<p>object of the class &quot;tsroba&quot; (see <code><a href="#topic+tsroba">tsroba</a></code> function).
</p>
</td></tr>
<tr><td><code id="tsrobapred_+3A_xpred">xpred</code></td>
<td>


<p>Values of the X design matrix for prediction coordinates.
</p>
</td></tr>
<tr><td><code id="tsrobapred_+3A_coordspred">coordspred</code></td>
<td>


<p>Points coordinates to be predicted.
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This function predicts using the sampling distribution of parameters obtained from the function <code>tsroba</code> and the conditional Student-t distribution of the predicted values given the data.
</p>


<h3>Value</h3>

<p>This function returns a vector with the predicted values at the specified locations.
</p>


<h3>Author(s)</h3>

<p>Jose A. Ordonez, Marcos O. Prates, Larissa A. Matos, Victor H. Lachos.
</p>


<h3>References</h3>

<p>Diggle, P. and P. Ribeiro (2007).Model-Based Geostatistics.  Springer Series in Statistics.
</p>
<p>Ordonez, J.A, M.O. Prattes, L.A. Matos, and V.H. Lachos (2020+). Objective Bayesian analysis for spatial Student-t regression models. (Submitted)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsroba">tsroba</a></code>,<code><a href="#topic+nsrobapred1">nsrobapred1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(25)
data(dataca20)
d1=dataca20[1:158,]

######covariance matern: kappa=0.3 prior:reference
res=tsroba(calcont~altitude+area, kappa = 0.3, data=d1,
ini.pars=c(10,3,10),iter=50,thin=1,burn=5)

datapred=dataca20[159:178,]
formula=calcont~altitude+area
xpred=model.matrix(formula,data=datapred)

tsrobapred(res,xpred=xpred,coordspred=dataca20[159:178,1:2])


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
