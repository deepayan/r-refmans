<!DOCTYPE html><html lang="en"><head><title>Help for package BOIN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BOIN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#get.boundary'><p>Generate the optimal dose escalation and deescalation boundaries for conducting the trial.</p></a></li>
<li><a href='#get.oc'><p>Generate operating characteristics for single agent trials</p></a></li>
<li><a href='#get.oc.comb'><p>Generate operating characteristics for drug combination trials</p></a></li>
<li><a href='#next.comb'><p>Determine the dose combination for the next cohort of new patients for drug-combination trials that aim to find a MTD</p></a></li>
<li><a href='#next.subtrial'><p>Determine the starting dose and the dose-searching space for next subtrial in waterfall design</p></a></li>
<li><a href='#plot.boin'><p>Plot the flowchart and simulation results for BOIN designs</p></a></li>
<li><a href='#print.boin'><p>Generate descriptive summary for objects returned by other functions</p></a></li>
<li><a href='#select.mtd'><p>Select the maximum tolerated dose (MTD) for single agent trials</p></a></li>
<li><a href='#select.mtd.comb'><p>Select the maximum tolerated dose (MTD) or MTD contour for drug combination trials</p></a></li>
<li><a href='#summary.boin'><p>Generate descriptive summary for objects returned by other functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Optimal INterval (BOIN) Design for Single-Agent and
Drug- Combination Phase I Clinical Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>2.7.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Ying Yuan and Suyu Liu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ying Yuan &lt;yyuan@mdanderson.org&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>Iso</td>
</tr>
<tr>
<td>Description:</td>
<td>The Bayesian optimal interval (BOIN) design is a novel phase I
    clinical trial design for finding the maximum tolerated dose (MTD). It can be
    used to design both single-agent and drug-combination trials. The BOIN design
    is motivated by the top priority and concern of clinicians when testing a new
    drug, which is to effectively treat patients and minimize the chance of exposing
    them to subtherapeutic or overly toxic doses. The prominent advantage of the
    BOIN design is that it achieves simplicity and superior performance at the same
    time. The BOIN design is algorithm-based and can be implemented in a simple
    way similar to the traditional 3+3 design. The BOIN design yields an average
    performance that is comparable to that of the continual reassessment method
    (CRM, one of the best model-based designs) in terms of selecting the MTD, but
    has a substantially lower risk of assigning patients to subtherapeutic or overly
    toxic doses. For tutorial, please check Yan et al. (2020) &lt;<a href="https://doi.org/10.18637%2Fjss.v094.i13">doi:10.18637/jss.v094.i13</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-19 14:57:45 UTC; jianga</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-19 17:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='get.boundary'>Generate the optimal dose escalation and deescalation boundaries for conducting the trial.</h2><span id='topic+get.boundary'></span>

<h3>Description</h3>

<p>Use this function to generate the optimal dose escalation and deescalation boundaries for conducting the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.boundary(
  target,
  ncohort,
  cohortsize,
  n.earlystop = 100,
  p.saf = 0.6 * target,
  p.tox = 1.4 * target,
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.boundary_+3A_target">target</code></td>
<td>
<p>the target DLT rate</p>
</td></tr>
<tr><td><code id="get.boundary_+3A_ncohort">ncohort</code></td>
<td>
<p>the total number of cohorts</p>
</td></tr>
<tr><td><code id="get.boundary_+3A_cohortsize">cohortsize</code></td>
<td>
<p>the cohort size</p>
</td></tr>
<tr><td><code id="get.boundary_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>the early stopping parameter. If the number of patients treated at
the current dose reaches <code>n.earlystop</code>, stop the trial
and select the MTD based on the observed data. The default
value <code>n.earlystop=100</code> essentially turns off the type
of early stopping.</p>
</td></tr>
<tr><td><code id="get.boundary_+3A_p.saf">p.saf</code></td>
<td>
<p>the highest toxicity probability that is deemed subtherapeutic
(i.e., below the MTD) such that dose escalation should be made.
The default value is <code>p.saf = 0.6 * target</code>.</p>
</td></tr>
<tr><td><code id="get.boundary_+3A_p.tox">p.tox</code></td>
<td>
<p>the lowest toxicity probability that is deemed overly toxic such
that deescalation is required. The default value is
<code>p.tox=1.4*target</code>.</p>
</td></tr>
<tr><td><code id="get.boundary_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate an overly toxic dose for safety.
We recommend the default value (<code>cutoff.eli=0.95</code>) for general use.</p>
</td></tr>
<tr><td><code id="get.boundary_+3A_extrasafe">extrasafe</code></td>
<td>
<p>set <code>extrasafe=TRUE</code> to impose a more strict stopping rule for extra safety,
expressed as the stopping boundary value in the result .</p>
</td></tr>
<tr><td><code id="get.boundary_+3A_offset">offset</code></td>
<td>
<p>a small positive number (between 0 and 0.5) to control how strict
the stopping rule is when <code>extrasafe=TRUE</code>. A larger value leads
to a more strict stopping rule. The default value
(<code>offset=0.05</code>) generally works well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dose escalation and deescalation boundaries are all we need to run a
phase I trial when using the BOIN design. The decision of which dose to
administer to the next cohort of patients does not require complicated
computations, but only a simple comparison of the observed DLT rate
at the current dose with the dose escalation and deescalation boundaries.
If the observed DLT rate at the current dose is smaller than or equal
to the escalation boundary, we escalate the dose; if the observed toxicity
rate at the current dose is greater than or equal to the deescalation boundary,
we deescalate the dose; otherwise, we retain the current dose. The dose
escalation and deescalation boundaries are chosen to minimize the probability
of assigning patients to subtherapeutic or overly toxic doses, thereby
optimizing patient ethics. <code>get.boundary()</code> also outputs the elimination
boundary, which is used to avoid treating patients at overly toxic doses based
on the following Bayesian safety rule: if <code class="reqn">Pr(p_j &gt; \phi | m_j , n_j ) &gt; 0.95</code> and
<code class="reqn">n_j \ge 3</code>, dose levels <code class="reqn">j</code> and higher are eliminated from the trial, where <code class="reqn">p_j</code> is
the toxicity probability of dose level <code class="reqn">j</code>, <code class="reqn">\phi</code> is the target DLT rate,
and <code class="reqn">m_j</code> and <code class="reqn">n_j</code> are the number of toxicities and patients treated at dose level <code class="reqn">j</code>.
The trial is terminated if the lowest dose is eliminated.
</p>
<p>The BOIN design has two built-in stopping rules: (1) stop the trial if the lowest dose is eliminated
due to toxicity, and no dose should be selected as the MTD; and (2) stop the trial
and select the MTD if the number of patients treated at the current dose reaches
<code>n.earlystop</code>. The first stopping rule is a safety rule to protect patients
from the case in which all doses are overly toxic. The rationale for the second
stopping rule is that when there is a large number (i.e., <code>n.earlystop</code>)
of patients assigned to a dose, it means that the dose-finding algorithm has
approximately converged. Thus, we can stop the trial early and select the MTD
to save the sample size and reduce the trial duration. For some applications,
investigators may prefer a more strict safety stopping rule than rule (1) for
extra safety when the lowest dose is overly toxic. This can be achieved by
setting <code>extrasafe=TRUE</code>, which imposes the following more strict safety
stopping rule: stop the trial if (i) the number of patients treated at the
lowest dose &gt;=3, and (ii) <code class="reqn">Pr(toxicity\ rate\ of\ the\ lowest\ dose &gt; \code{target} | data)
         &gt; \code{cutoff.eli}-\code{offset}</code>. As a tradeoff, the strong stopping rule will decrease the
MTD selection percentage when the lowest dose actually is the MTD.
</p>


<h3>Value</h3>

<p><code>get.boundary()</code> returns a list object, including the dose escalation and de-escalation
boundaries <code>$lambda_e</code> and <code>$lambda_d</code> and the corresponding decision tables
<code>$boundary_tab</code> and <code>$full_boundary_tab</code>. If <code>extrasafe=TRUE</code>, the function also returns
a (more strict) safety stopping boundary <code>$stop_boundary</code>.
</p>


<h3>Note</h3>

<p>We should avoid setting the values of <code>p.saf</code> and <code>p.tox</code> very close to the
<code>target</code>. This is because the small sample sizes of typical phase I trials prevent us from
differentiating the target DLT rate from the rates close to it. In addition,
in most clinical applications, the target DLT rate is often a rough guess,
and finding a dose level with a DLT rate reasonably close to the target rate
will still be of interest to the investigator. The default values provided by
<code>get.boundary()</code> are generally reasonable for most clinical applications.
</p>


<h3>Author(s)</h3>

<p>Suyu Liu and Ying Yuan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I
Clinical Trials, <em>Journal of the Royal Statistical Society: Series C</em>, 64, 507-523.
</p>
<p>Yan, F., Zhang, L., Zhou, Y., Pan, H., Liu, S. and Yuan, Y. (2020).BOIN: An R Package
for Designing Single-Agent and Drug-Combination Dose-Finding Trials Using Bayesian Optimal
Interval Designs. <em>Journal of Statistical Software</em>, 94(13),1-32.&lt;doi:10.18637/jss.v094.i13&gt;.
</p>
<p>Yuan Y., Hess K.R., Hilsenbeck S.G. and Gilbert M.R. (2016). Bayesian Optimal Interval Design: A
Simple and Well-performing Design for Phase I Oncology Trials, <em>Clinical Cancer Research</em>, 22, 4291-4301.
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf</a>
</p>
<p>Paper: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## get the dose escalation and deescalation boundaries for BOIN design with
## the target DLT rate of 0.3, maximum sample size of 30, and cohort size of 3
bound &lt;- get.boundary(target=0.3, ncohort=10, cohortsize=3)
summary(bound) # get the descriptive summary of the boundary
plot(bound)    # plot the flowchart of the design with boundaries

</code></pre>

<hr>
<h2 id='get.oc'>Generate operating characteristics for single agent trials</h2><span id='topic+get.oc'></span>

<h3>Description</h3>

<p>Obtain the operating characteristics of the BOIN design for single agent trials by simulating trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.oc(target, p.true, ncohort, cohortsize, n.earlystop=100,
              startdose=1, titration=FALSE, p.saf=0.6*target, p.tox=1.4*target,
              cutoff.eli=0.95,extrasafe=FALSE, offset=0.05, boundMTD=FALSE,
              ntrial=1000, seed=6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.oc_+3A_target">target</code></td>
<td>
<p>the target DLT rate</p>
</td></tr>
<tr><td><code id="get.oc_+3A_p.true">p.true</code></td>
<td>
<p>a vector containing the true toxicity probabilities of the
investigational dose levels.</p>
</td></tr>
<tr><td><code id="get.oc_+3A_ncohort">ncohort</code></td>
<td>
<p>the total number of cohorts</p>
</td></tr>
<tr><td><code id="get.oc_+3A_cohortsize">cohortsize</code></td>
<td>
<p>the cohort size</p>
</td></tr>
<tr><td><code id="get.oc_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>the early stopping parameter. If the number of patients
treated at the current dose reaches <code>n.earlystop</code>,
stop the trial and select the MTD based on the observed data.
The default value <code>n.earlystop=100</code> essentially turns
off this type of early stopping.</p>
</td></tr>
<tr><td><code id="get.oc_+3A_startdose">startdose</code></td>
<td>
<p>the starting dose level for the trial</p>
</td></tr>
<tr><td><code id="get.oc_+3A_titration">titration</code></td>
<td>
<p>set <code>titration=TRUE</code> to perform dose escalation with cohort size = 1 to accelerate dose escalation at the begining of the trial.</p>
</td></tr>
<tr><td><code id="get.oc_+3A_p.saf">p.saf</code></td>
<td>
<p>the highest toxicity probability that is deemed subtherapeutic
(i.e. below the MTD) such that dose escalation should be undertaken.
The default value is <code>p.saf=0.6*target</code>.</p>
</td></tr>
<tr><td><code id="get.oc_+3A_p.tox">p.tox</code></td>
<td>
<p>the lowest toxicity probability that is deemed overly toxic such
that deescalation is required. The default value is
<code>p.tox=1.4*target</code>).</p>
</td></tr>
<tr><td><code id="get.oc_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate an overly toxic dose for safety.
We recommend the default value of (<code>cutoff.eli=0.95</code>) for general use.</p>
</td></tr>
<tr><td><code id="get.oc_+3A_extrasafe">extrasafe</code></td>
<td>
<p>set <code>extrasafe=TRUE</code> to impose a more stringent stopping rule</p>
</td></tr>
<tr><td><code id="get.oc_+3A_offset">offset</code></td>
<td>
<p>a small positive number (between <code>0</code> and <code>0.5</code>) to control how strict the
stopping rule is when <code>extrasafe=TRUE</code>. A larger value leads to a more
strict stopping rule. The default value <code>offset=0.05</code> generally works well.</p>
</td></tr>
<tr><td><code id="get.oc_+3A_boundmtd">boundMTD</code></td>
<td>
<p>set <code>boundMTD=TRUE</code> to impose the condition: the isotonic estimate of toxicity probability
for the selected MTD must be less than de-escalation boundary.</p>
</td></tr>
<tr><td><code id="get.oc_+3A_ntrial">ntrial</code></td>
<td>
<p>the total number of trials to be simulated</p>
</td></tr>
<tr><td><code id="get.oc_+3A_seed">seed</code></td>
<td>
<p>the random seed for simulation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The operating characteristics of the BOIN design are generated by simulating trials
under the prespecified true toxicity probabilities of the investigational doses. If
<code>titration=TRUE</code>, we perform dose escalation with cohort size = 1 at the begining of the trial:
starting from <code>startdose</code>, if no toxicity is observed, we escalate the dose;
otherwise, the titration is completed and we switch to cohort size = <code>cohortsize</code>.
Titration accelerates the dose escalation and is useful when low doses are believed to be safe.
</p>
<p>The BOIN design has two built-in stopping rules: (1) stop the trial if the lowest
dose is eliminated due to toxicity, and no dose should be selected as the MTD; and
(2) stop the trial and select the MTD if the number of patients treated at the current
dose reaches <code>n.earlystop</code>. The first stopping rule is a safety rule to protect patients
from the case in which all doses are overly toxic. The rationale for the second stopping
rule is that when there is a large number (i.e., <code>n.earlystop</code>) of patients
assigned to a dose, it means that the dose-finding algorithm has approximately converged.
Thus, we can stop the trial early and select the MTD to save sample size and reduce the
trial duration. For some applications, investigators may prefer a more strict safety
stopping rule than rule (1) for extra safety when the lowest dose is overly toxic.
This can be achieved by setting <code>extrasafe=TRUE</code>, which imposes the following more
strict safety stopping rule: stop the trial if (i) the number of patients treated at the
lowest dose <code>&gt;=3</code>, and (ii) <code class="reqn">Pr(toxicity\ rate\ of\ the\ lowest\ dose &gt; \code{target} | data)
         &gt; \code{cutoff.eli}-\code{offset}</code>. As a tradeoff, the strong stopping rule will decrease the MTD
selection percentage when the lowest dose actually is the MTD.
</p>


<h3>Value</h3>

<p><code>get.oc()</code> returns the operating characteristics of the BOIN design as a list,
including:
(1) selection percentage at each dose level (<code>$selpercent</code>),
(2) the number of patients treated at each dose level (<code>$npatients</code>),
(3) the number of toxicities observed at each dose level (<code>$ntox</code>),
(4) the average number of toxicities (<code>$totaltox</code>),
(5) the average number of patients (<code>$totaln</code>),
(6) the percentage of early stopping without selecting the MTD (<code>$percentstop</code>),
(7) risk of overdosing 60% or more of patients (<code>$overdose60</code>),
(8) risk of overdosing 80% or more of patients (<code>$overdose80</code>),
(9) data.frame (<code>$simu.setup</code>) containing simulation parameters, such as target, p.true, etc.
</p>


<h3>Note</h3>

<p>We should avoid setting the values of <code>p.saf</code> and <code>p.tox</code> very close to the
<code>target</code>. This is because the small sample sizes of typical phase I trials prevent us from
differentiating the target DLT rate from the rates close to it. The default values provided by
<code>get.oc()</code> are strongly recommended, and generally yield excellent operating characteristics.
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Yanhong Zhou, and Ying Yuan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I
Clinical Trials, <em>Journal of the Royal Statistical Society: Series C</em>, 64, 507-523.
</p>
<p>Yan, F., Zhang, L., Zhou, Y., Pan, H., Liu, S. and Yuan, Y. (2020).BOIN: An R Package
for Designing Single-Agent and Drug-Combination Dose-Finding Trials Using Bayesian Optimal
Interval Designs. <em>Journal of Statistical Software</em>, 94(13),1-32.&lt;doi:10.18637/jss.v094.i13&gt;.
</p>
<p>Yuan Y., Hess K.R., Hilsenbeck S.G. and Gilbert M.R. (2016) Bayesian Optimal Interval Design: A
Simple and Well-performing Design for Phase I Oncology Trials, <em>Clinical Cancer Research</em>, 22, 4291-4301.
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf</a>
</p>
<p>Paper: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## get the operating characteristics for BOIN single agent trial
oc &lt;- get.oc(target=0.3, p.true=c(0.05, 0.15, 0.3, 0.45, 0.6),
			ncohort=20, cohortsize=3, ntrial=1000)

summary(oc) # summarize design operating characteristics
plot(oc)   # plot flowchart of the BOIN design and design operating characteristics, including
           # selection percentage, number of patients, and observed toxicities at each dose


## perform titration at the begining of the trial to accelerate dose escalation
oc &lt;- get.oc(target=0.3, p.true=c(0.05, 0.15, 0.3, 0.45, 0.6),
			titration=TRUE, ncohort=20, cohortsize=3, ntrial=1000)

summary(oc)          # summarize design operating characteristics
plot(oc)  # plot flowchart of the BOIN design and design operating characteristics
</code></pre>

<hr>
<h2 id='get.oc.comb'>Generate operating characteristics for drug combination trials</h2><span id='topic+get.oc.comb'></span>

<h3>Description</h3>

<p>Obtain the operating characteristics of the BOIN design or waterfall design for drug combination
trials. The BOIN design is to find a MTD, and the waterfall design is to find the MTD contour
(i.e., multple MTDs in the dose matrix)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.oc.comb(target, p.true, ncohort, cohortsize, n.earlystop=NULL, startdose=c(1, 1),
                   titration=FALSE,p.saf=0.6*target, p.tox=1.4*target, cutoff.eli=0.95,
                   extrasafe=FALSE,offset=0.05, ntrial=1000, mtd.contour=FALSE,
                   boundMTD=FALSE, seed=6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.oc.comb_+3A_target">target</code></td>
<td>
<p>the target DLT rate</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_p.true">p.true</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the true toxicity probabilities of
combinations with <code>J</code> dose levels of agent A and <code>K</code> dose levels of agent B</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_ncohort">ncohort</code></td>
<td>
<p>a <code>1*J</code> vector specifying the number of cohorts for each of <code>J</code> subtrials
if <code>mtd.contour=TRUE</code>; Otherwise, a scalar specifying the total number of cohorts for
the trial.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_cohortsize">cohortsize</code></td>
<td>
<p>the cohort size</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>the early stopping parameter. If the number of patients treated at the current
dose reaches <code>n.earlystop</code>, stop the trial or subtrial and select the MTD based on
the observed data. When the waterfall design is used to find the MTD contour,
<code>n.earlystop=12</code> by default.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_startdose">startdose</code></td>
<td>
<p>the starting dose combination level for drug combination trial</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_titration">titration</code></td>
<td>
<p>set <code>titration=TRUE</code> to perform dose escalation with cohort size = 1 to accelerate dose escalation at the begining of the trial.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_p.saf">p.saf</code></td>
<td>
<p>the highest toxicity probability that is deemed subtherapeutic (i.e. below the MTD)
such that dose escalation should be undertaken.
The default value is <code>p.saf=0.6*target</code>.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_p.tox">p.tox</code></td>
<td>
<p>the lowest toxicity probability that is deemed overly toxic such that deescalation
is required. The default value is <code>p.tox=1.4*target</code>.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate an overly toxic dose for safety. We recommend the
default value of (<code>cutoff.eli=0.95</code>) for general use.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>set <code>extrasafe=TRUE</code> to impose a more stringent stopping rule</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_offset">offset</code></td>
<td>
<p>a small positive number (between 0 and 0.5) to control how strict the stopping
rule is when <code>extrasafe=TRUE</code>. A larger value leads to a more strict stopping
rule. The default value <code>offset=0.05</code> generally works well.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_ntrial">ntrial</code></td>
<td>
<p>the total number of trials to be simulated</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_mtd.contour">mtd.contour</code></td>
<td>
<p>set <code>mtd.contour=TRUE</code> to select the MTD contour (claiming multiple MTDs).
Otherwise, BOIN design is used to search for a single MTD.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_boundmtd">boundMTD</code></td>
<td>
<p>set <code>boundMTD=TRUE</code> to impose the condition: the isotonic estimate of toxicity
probability for the selected MTD must be less than de-escalation boundary.</p>
</td></tr>
<tr><td><code id="get.oc.comb_+3A_seed">seed</code></td>
<td>
<p>the random seed for simulation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The operating characteristics of the BOIN design or waterfall design are generated by
simulating trials under the prespecified true toxicity probabilities of the investigational dose
combinations. If <code>titration=TRUE</code>, we perform dose escalation with cohort size = 1 at the begining of the trial:
starting from <code>startdose</code>, if no toxicity is observed, we escalate the dose;
otherwise, the titration is completed and we switch to cohort size = <code>cohortsize</code>.
Titration accelerates the dose escalation and is useful when low doses are believed to be safe.
</p>
<p>The BOIN and waterfall designs have two built-in stopping rules:
(1) stop the trial/subtrial if the lowest dose is eliminated due to toxicity, and no dose should
be selected as the MTD; and (2) stop the trial/subtrial and select the MTD if the number of
patients treated at the current dose reaches <code>n.earlystop</code>. The first stopping rule is a safety
rule to protect patients from the case in which all doses are overly toxic. The rationale for
the second stopping rule is that when there is a large number (i.e., <code>n.earlystop</code>) of
patients assigned to a dose, it means that the dose-finding algorithm has approximately converged.
Thus, we can stop the trial/subtrial early and select the MTD to save sample size and reduce the
trial duration.
</p>
<p>For some applications, investigators may prefer a more strict safety stopping rule than rule
(1) for extra safety when the lowest dose is overly toxic.
This can be achieved by setting <code>extrasafe=TRUE</code>,
which imposes the following more strict safety stopping rule:
stop the trial if (i) the number of patients treated at the lowest dose <code>&gt;=3</code>,
and (ii) <code class="reqn">Pr(toxicity\ rate\ of\ the\ lowest\ dose &gt; \code{target} | data) &gt; \code{cutoff.eli}-\code{offset}</code>.
As a tradeoff, the strong stopping rule will decrease the MTD selection percentage
when the lowest dose actually is the MTD.
</p>


<h3>Value</h3>

<p><code>get.oc.comb()</code> returns the operating characteristics of the BOIN combination or
waterfall design as a list. For the BOIN combination design, including:
(1) true toxicity probability at each dose level (<code>$p.true</code>),
(2) selection percentage at each dose level (<code>$selpercent</code>),
(3) the number of patients treated at each dose level (<code>$npatients</code>)
(4) the number of toxicities observed at each dose level (<code>$ntox</code>),
(5) the total number of patients in the trial (<code>$totaln</code>),
(6) the total number of toxicities observed for the trial (<code>$totaltox</code>)
(7) the pecentage of correct selection (<code>$pcs</code>),
(8) the total percentage of patients treated at the MTD (<code>$npercent</code>).
(9) the percentage of early stopping without selecting the MTD (<code>$percentstop</code>)
For the the waterfall design, including:
(1) true toxicity probability at each dose level (<code>$p.true</code>),
(2) selection percentage of dose combinations (<code>$selpercent</code>),
(3) the number of patients treated at each dose combination (<code>$npatients</code>)
(4) the number of toxicities observed at each dose combination (<code>$ntox</code>),
(5) the total number of patients in the trial (<code>$totaln</code>),
(6) the total number of toxicities observed for the trial (<code>$totaltox</code>)
(7) the total percentage of correct selection at the MTD contour (<code>$pcs.contour</code>),
(8) the total percentage of patients treated at MTD contour
(<code>$npercent.contour</code>)
(9) the total percentage of patients treated above MTD contour
(<code>$npercent.above.contour</code>)
(10) the total percentage of patients treated below MTD contour
(<code>$npercent.below.contour</code>)
</p>


<h3>Note</h3>

<p>We should avoid setting the values of <code>p.saf</code> and <code>p.tox</code> very close to the
<code>target</code>. This is because the small sample sizes of typical phase I trials prevent us from
differentiating the target DLT rate from the rates close to it. The default values provided by
<code>get.oc()</code> are strongly recommended, and generally yield excellent operating characteristics.
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Liangcai Zhang, Yanhong Zhou, and Ying Yuan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials, <em>Journal of the Royal Statistical Society: Series C</em>, 64, 507-523.
</p>
<p>Lin R. and Yin, G. (2017). Bayesian Optimal Interval Designs for Dose Finding in
Drug-combination Trials, <em>Statistical Methods in Medical Research</em>, 26, 2155-2167.
</p>
<p>Yan, F., Zhang, L., Zhou, Y., Pan, H., Liu, S. and Yuan, Y. (2020).BOIN: An R Package
for Designing Single-Agent and Drug-Combination Dose-Finding Trials Using Bayesian Optimal
Interval Designs. <em>Journal of Statistical Software</em>, 94(13),1-32.&lt;doi:10.18637/jss.v094.i13&gt;.
</p>
<p>Zhang L. and Yuan, Y. (2016). A Simple Bayesian Design to Identify the Maximum
Tolerated Dose Contour for Drug Combination Trials, <em>Statistics in Medicine</em>, 35, 4924-4936.
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf</a>
</p>
<p>Paper: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###### drug-combination trial ######

##### combination trial to find a single MTD  ######

## get the operating characteristics for BOIN design
p.true &lt;- matrix(c(0.01,0.03,0.10,0.20,0.30,
                 0.03,0.05,0.15,0.30,0.60,
                 0.08,0.10,0.30,0.60,0.75), byrow=TRUE, ncol=5)

oc.comb &lt;- get.oc.comb(target=0.3, p.true, ncohort=20, cohortsize=3,
   n.earlystop=12, startdose=c(1,1), ntrial=100)

summary(oc.comb)
plot(oc.comb)


## get the operating characteristics with titration for BOIN design
oc.comb &lt;- get.oc.comb(target=0.3, p.true, ncohort=20, cohortsize=3,
   n.earlystop=12, startdose=c(1,1), titration=TRUE, ntrial=100)
summary(oc.comb)
plot(oc.comb)


##### combination trial to find the MTD contour ######

## find the MTD contour using waterfall design
oc.comb &lt;- get.oc.comb(target=0.3, p.true, ncohort=c(10,5,5), cohortsize=3,
   n.earlystop=12, startdose=c(1,1), ntrial=100, mtd.contour=TRUE)

summary(oc.comb)
plot(oc.comb)

</code></pre>

<hr>
<h2 id='next.comb'>Determine the dose combination for the next cohort of new patients for drug-combination trials that aim to find a MTD</h2><span id='topic+next.comb'></span>

<h3>Description</h3>

<p>Determine the dose combination for the next cohort of new patients for drug-combination trials that aim to find a MTD
</p>


<h3>Usage</h3>

<pre><code class='language-R'>next.comb(target, npts, ntox, dose.curr, n.earlystop=100,
                 p.saf=0.6*target, p.tox=1.4*target, cutoff.eli=0.95,
                 extrasafe=FALSE, offset=0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="next.comb_+3A_target">target</code></td>
<td>
<p>the target DLT rate</p>
</td></tr>
<tr><td><code id="next.comb_+3A_npts">npts</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of patients treated at each dose combination</p>
</td></tr>
<tr><td><code id="next.comb_+3A_ntox">ntox</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of patients experienced
dose-limiting toxicity at each dose combination</p>
</td></tr>
<tr><td><code id="next.comb_+3A_dose.curr">dose.curr</code></td>
<td>
<p>the current dose combination</p>
</td></tr>
<tr><td><code id="next.comb_+3A_n.earlystop">n.earlystop</code></td>
<td>
<p>the early stopping parameter. If the number of patients
treated at the current dose reaches <code>n.earlystop</code>,
stop the trial and select the MTD based on the observed data.
The default value <code>n.earlystop=100</code> essentially turns
off this type of early stopping.</p>
</td></tr>
<tr><td><code id="next.comb_+3A_p.saf">p.saf</code></td>
<td>
<p>the highest toxicity probability that is deemed subtherapeutic
(i.e. below the MTD) such that dose escalation should be undertaken.
The default value is <code>p.saf=0.6*target</code>.</p>
</td></tr>
<tr><td><code id="next.comb_+3A_p.tox">p.tox</code></td>
<td>
<p>the lowest toxicity probability that is deemed overly toxic such
that deescalation is required. The default value is
<code>p.tox=1.4*target</code>.</p>
</td></tr>
<tr><td><code id="next.comb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate an overly toxic dose for safety.
We recommend the default value of (<code>cutoff.eli=0.95</code>)
for general use.</p>
</td></tr>
<tr><td><code id="next.comb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>set <code>extrasafe=TRUE</code> to impose a more stringent stopping rule</p>
</td></tr>
<tr><td><code id="next.comb_+3A_offset">offset</code></td>
<td>
<p>a small positive number (between <code>0</code> and <code>0.5</code>) to control how strict the
stopping rule is when <code>extrasafe=TRUE</code>. A larger value leads to a more
strict stopping rule. The default value <code>offset=0.05</code> generally works well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to determine dose combination for conducting combination trials.
Given the currently observed data, <code>next.comb()</code> determines dose combination for
treating the next cohort of new patients. The currently observed data include: the
number of patients treated at each dose combination (i.e., <code>npts</code>),
the number of patients who experienced dose-limiting toxicities at each dose
combination (i.e., <code>ntox</code>), and the level of current dose (i.e., <code>dose.curr</code>).
</p>


<h3>Value</h3>

<p>the recommended dose for treating the next cohort of patients (<code>$next_dc</code>).
</p>


<h3>Author(s)</h3>

<p>Suyu Liu and Ying Yuan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials, <em>Journal of the Royal Statistical Society: Series C</em>, 64, 507-523.
</p>
<p>Lin R. and Yin, G. (2017). Bayesian Optimal Interval Designs for Dose Finding in
Drug-combination Trials, <em>Statistical Methods in Medical Research</em>, 26, 2155-2167.
</p>
<p>Yan, F., Zhang, L., Zhou, Y., Pan, H., Liu, S. and Yuan, Y. (2020).BOIN: An R Package
for Designing Single-Agent and Drug-Combination Dose-Finding Trials Using Bayesian Optimal
Interval Designs. <em>Journal of Statistical Software</em>, 94(13),1-32.&lt;doi:10.18637/jss.v094.i13&gt;.
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf</a>
</p>
<p>Paper: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## determine the dose combination for the next cohort of new patients
n &lt;- matrix(c(3, 0, 0, 0, 0, 7, 6, 0, 0, 0, 0, 0, 0, 0, 0), ncol=5, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0), ncol=5, byrow=TRUE)
nxt.comb &lt;- next.comb(target=0.3, npts=n, ntox=y, dose.curr=c(2, 2))
summary(nxt.comb)

</code></pre>

<hr>
<h2 id='next.subtrial'>Determine the starting dose and the dose-searching space for next subtrial in waterfall design</h2><span id='topic+next.subtrial'></span>

<h3>Description</h3>

<p>Determine the starting dose and the dose-searching space for next subtrial after
the current subtrial is completed when using the waterfall design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>next.subtrial(
  target,
  npts,
  ntox,
  p.saf = 0.6 * target,
  p.tox = 1.4 * target,
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="next.subtrial_+3A_target">target</code></td>
<td>
<p>the target DLT rate</p>
</td></tr>
<tr><td><code id="next.subtrial_+3A_npts">npts</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of patients treated at each dose combination</p>
</td></tr>
<tr><td><code id="next.subtrial_+3A_ntox">ntox</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of patients who experienced dose-limiting
toxicities at each dose combination</p>
</td></tr>
<tr><td><code id="next.subtrial_+3A_p.saf">p.saf</code></td>
<td>
<p>the highest toxicity probability that is deemed subtherapeutic (i.e. below
the MTD) such that dose escalation should be undertaken. The default value
is <code>p.saf=0.6*target</code>.</p>
</td></tr>
<tr><td><code id="next.subtrial_+3A_p.tox">p.tox</code></td>
<td>
<p>the lowest toxicity probability that is deemed overly toxic such that
deescalation is required. The default value is <code>p.tox=1.4*target</code>.</p>
</td></tr>
<tr><td><code id="next.subtrial_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate an overly toxic dose for safety. We recommend
the default value of (<code>cutoff.eli=0.95</code>) for general use.</p>
</td></tr>
<tr><td><code id="next.subtrial_+3A_extrasafe">extrasafe</code></td>
<td>
<p>set <code>extrasafe=TRUE</code> to impose a more stringent stopping rule</p>
</td></tr>
<tr><td><code id="next.subtrial_+3A_offset">offset</code></td>
<td>
<p>a small positive number (between 0 and 0.5) to control how strict the
stopping rule is when <code>extrasafe=TRUE</code>. A larger value leads to a
more strict stopping rule. The default value <code>offset=0.05</code> generally
works well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the waterfall design, this function is used to obtain the starting dose and
dose-searching space for the next subtrial when the current subtrial is completed.
The input data include: the number of patients treated at each dose combination
(i.e., <code>npts</code>), the number of patients who experienced dose-limiting
toxicities at each dose combination (i.e., <code>ntox</code>).
</p>


<h3>Value</h3>

<p><code>next.subtrial()</code> returns a list object, containing the starting dose
(<code>$starting_dose</code>) and the dose-searching space for the the next subtrial
(<code>$next_subtrial</code>).
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Liangcai Zhang and Ying Yuan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials, <em>Journal of the Royal Statistical Society: Series C</em>, 64, 507-523.
</p>
<p>Lin R. and Yin, G. (2017). Bayesian Optimal Interval Designs for Dose Finding in
Drug-combination Trials, <em>Statistical Methods in Medical Research</em>, 26, 2155-2167.
</p>
<p>Yan, F., Zhang, L., Zhou, Y., Pan, H., Liu, S. and Yuan, Y. (2020).BOIN: An R Package
for Designing Single-Agent and Drug-Combination Dose-Finding Trials Using Bayesian Optimal
Interval Designs. <em>Journal of Statistical Software</em>, 94(13),1-32.&lt;doi:10.18637/jss.v094.i13&gt;.
</p>
<p>Zhang L. and Yuan, Y. (2016). A Simple Bayesian Design to Identify the Maximum
Tolerated Dose Contour for Drug Combination Trials, <em>Statistics in Medicine</em>, 35, 4924-4936.
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf</a>
</p>
<p>Paper: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## determine the starting dose and dose searching space for next subtrial
n &lt;- matrix(c(6, 0, 0, 0,
           6, 10, 12, 0,
           9, 12, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0,
            1, 1, 4, 0,
            2, 3, 0, 0), ncol=4, byrow=TRUE)
nxt.trial &lt;- next.subtrial(target=0.3, npts=n, ntox=y)
summary(nxt.trial)

</code></pre>

<hr>
<h2 id='plot.boin'>Plot the flowchart and simulation results for BOIN designs</h2><span id='topic+plot.boin'></span>

<h3>Description</h3>

<p>Plot the objects returned by other functions, including (1) flowchart of BOIN design;
(2) operating characteristics of the design, including selesction percentage and the
number of patients treated at each dose;
(3) the estimate of toxicity probability for each dose and corresponding 95% credible interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'boin'
plot(x, ..., name = deparse(substitute(x)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.boin_+3A_x">x</code></td>
<td>
<p>the object returned by other functions</p>
</td></tr>
<tr><td><code id="plot.boin_+3A_...">...</code></td>
<td>
<p>ignored arguments</p>
</td></tr>
<tr><td><code id="plot.boin_+3A_name">name</code></td>
<td>
<p>the name of the object to be plotted.
User doesn't need to input this parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot()</code> returns a figure or a series of figures depending on the object entered
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Liangcai Zhang, Yanhong Zhou,  and Ying Yuan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###### single-agent trial ######

## get dose escalation and deescalation boundaries for conducting the trial
bound &lt;- get.boundary(target=0.3, ncohort=10, cohortsize=3)
plot(bound)


## get the operating characteristics for BOIN single agent trial
oc &lt;- get.oc(target=0.3, p.true=c(0.05,0.15,0.3,0.45,0.6),
   ncohort=10, cohortsize=3, ntrial=1000)
summary(oc)
plot(oc)


## select the MTD based on the trial data
n &lt;- c(3, 3, 15, 9, 0)
y &lt;- c(0, 0, 4, 4, 0)
selmtd &lt;- select.mtd(target=0.3, npts=n, ntox=y)
summary(selmtd)
plot(selmtd)


###### drug-combination trial ######

##### combination trial to find a single MTD  ######

## get the operating characteristics for BOIN combination trial
p.true &lt;- matrix(c(0.01,0.03,0.10,0.20,0.30,
                0.03,0.05,0.15,0.30,0.60,
                0.08,0.10,0.30,0.60,0.75), byrow=TRUE, ncol=5)

oc.comb &lt;- get.oc.comb(target=0.3, p.true, ncohort=20, cohortsize=3, n.earlystop=12,
     startdose=c(1,1),ntrial=100)
summary(oc.comb)
plot(oc.comb)


## select a MTD based on the trial data
n &lt;- matrix(c(3, 5, 0, 0, 0, 7, 6, 15, 0, 0, 0, 0, 4, 0, 0), ncol=5, byrow=TRUE)
y &lt;- matrix(c(0, 1, 0, 0, 0, 1, 1, 4, 0, 0, 0, 0, 2, 0, 0), ncol=5, byrow=TRUE)
sel.comb &lt;- select.mtd.comb(target=0.3, npts=n, ntox=y)
summary(sel.comb)
plot(sel.comb)


##### combination trial to find a MTD contour (e.g., multiple MTDs)  #####

## get the operating characteristics for BOIN waterfall design
p.true &lt;- matrix(c(0.01, 0.10, 0.20, 0.30,
                0.03, 0.15, 0.30, 0.60,
                0.08, 0.30, 0.60, 0.75), byrow=TRUE, ncol=4)

oc.comb2 &lt;- get.oc.comb(target=0.3, p.true, ncohort=c(8,6,6), cohortsize=3, n.earlystop=12,
       startdose=c(1,1), ntrial=100, mtd.contour=TRUE)
summary(oc.comb2)
plot(oc.comb2)


## select the MTD contour based on the trial data
n &lt;- matrix(c(6, 9, 24, 0,  6, 24, 9, 0,  12, 18, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 1,  5, 0,  1,  5, 4, 0,  1, 5, 0, 0), ncol=4, byrow=TRUE)
sel.comb2 &lt;- select.mtd.comb(target=0.3, npts=n, ntox=y, mtd.contour=TRUE)
summary(sel.comb2)
plot(sel.comb2)

</code></pre>

<hr>
<h2 id='print.boin'>Generate descriptive summary for objects returned by other functions</h2><span id='topic+print.boin'></span>

<h3>Description</h3>

<p>Generate descriptive summary for objects returned by other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'boin'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.boin_+3A_x">x</code></td>
<td>
<p>the object returned by other functions</p>
</td></tr>
<tr><td><code id="print.boin_+3A_...">...</code></td>
<td>
<p>ignored arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print()</code> prints the objects returned by other functions.
</p>


<h3>Value</h3>

<p><code>print()</code> prints the objects returned by other functions.
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Liangcai Zhang, Yanhong Zhou, and Ying Yuan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###### single-agent trial ######

## sprint the object returned by get.boundary()
bound &lt;- get.boundary(target=0.3, ncohort=10, cohortsize=3)
print(bound)


## print the object returned by get.oc()
oc.single &lt;- get.oc(target=0.3, p.true=c(0.05, 0.15, 0.3, 0.45, 0.6), ncohort=10,
cohortsize=3, ntrial=1000)
print(oc.single)


## print the object returned by select.mtd()
n &lt;- c(3, 3, 15, 9, 0)
y &lt;- c(0, 0, 4, 4, 0)
selmtd &lt;- select.mtd(target=0.3, npts=n, ntox=y)
print(selmtd)


###### drug-combination trial######

###### drug-combiation trial to find a single MTD ######

## print the object returned by next.comb()
n &lt;- matrix(c(3, 0, 0, 0, 0, 0, 0, 0,  0, 0, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), ncol=4, byrow=TRUE)
nxt.comb &lt;- next.comb(target=0.25, npts=n, ntox=y, dose.curr=c(1, 1))
print(nxt.comb)


## print the object returned by next.comb()
n &lt;- matrix(c(3, 3, 0, 0, 0, 0, 0, 0,  0, 0, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), ncol=4, byrow=TRUE)
nxt.comb &lt;- next.comb(target=0.25, npts=n, ntox=y, dose.curr=c(1, 2))
print(nxt.comb)


## print the object returned by get.oc.comb() when mtd.contour=FALSE
p.true &lt;- matrix(c(0.02,0.04,0.08,0.14,
               0.08,0.25,0.42,0.48,
               0.25,0.45,0.50,0.60), byrow=TRUE, ncol=4)

oc.comb &lt;- get.oc.comb(target=0.25, p.true=p.true, ncohort=16, cohortsize=3,
           ntrial=100)
print(oc.comb)


## print the object returned by select.mtd.comb()
n &lt;- matrix(c(6, 3, 0, 0, 6, 24, 9, 0, 0, 0, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0, 1, 5, 4, 0, 0, 0, 0, 0), ncol=4, byrow=TRUE)
sel.comb &lt;- select.mtd.comb(target=0.25, npts=n, ntox=y)
print(sel.comb)



###### drug-combiation trial to find the MTD contour ######

## print the object returned by next.subtrial()
n &lt;- matrix(c(6, 0,  0, 0,
           6, 0, 0, 0,
           9, 12, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0,
           1, 0, 0, 0,
           2, 3, 0, 0), ncol=4, byrow=TRUE)
nxt.trial &lt;- next.subtrial(target=0.3, npts=n, ntox=y)
print(nxt.trial)


## print the object returned by get.oc.comb() when mtd.contour=TRUE.
p.true &lt;- matrix(c(0.01,0.03,0.10,0.20,0.30,
               0.03,0.05,0.15,0.30,0.60,
               0.08,0.10,0.30,0.60,0.75), byrow=TRUE, ncol=5)

oc.comb &lt;- get.oc.comb(target=0.3, p.true, ncohort=c(10,5,5), cohortsize=3,
   n.earlystop=12, startdose=c(1,1),ntrial=100, mtd.contour=TRUE)
print(oc.comb)


## print the object returned by select.mtd.comb()
n &lt;- matrix(c(6, 9, 24, 0,
           6,  24, 9, 0,
           12, 18, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 1, 5, 0,
           1, 5, 4, 0,
           1, 5, 0, 0), ncol=4, byrow=TRUE)
sel.comb2 &lt;- select.mtd.comb(target=0.3, npts=n, ntox=y, mtd.contour=TRUE)
print(sel.comb2)



</code></pre>

<hr>
<h2 id='select.mtd'>Select the maximum tolerated dose (MTD) for single agent trials</h2><span id='topic+select.mtd'></span>

<h3>Description</h3>

<p>Select the maximum tolerated dose (MTD) when the single-agent trial is completed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.mtd(target, npts, ntox, cutoff.eli=0.95, extrasafe=FALSE, offset=0.05,
                 boundMTD=FALSE,p.tox=1.4*target)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select.mtd_+3A_target">target</code></td>
<td>
<p>the target DLT rate</p>
</td></tr>
<tr><td><code id="select.mtd_+3A_npts">npts</code></td>
<td>
<p>a vector containing the number of patients treated at each dose level</p>
</td></tr>
<tr><td><code id="select.mtd_+3A_ntox">ntox</code></td>
<td>
<p>a vector containing the number of patients who experienced dose-limiting
toxicity at each dose level</p>
</td></tr>
<tr><td><code id="select.mtd_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of (<code>cutoff.eli=0.95</code>) for general use.</p>
</td></tr>
<tr><td><code id="select.mtd_+3A_extrasafe">extrasafe</code></td>
<td>
<p>set <code>extrasafe=TRUE</code> to impose a more strict stopping rule for
extra safety</p>
</td></tr>
<tr><td><code id="select.mtd_+3A_offset">offset</code></td>
<td>
<p>a small positive number (between <code>0</code> and <code>0.5</code>) to control how strict the
stopping rule is when <code>extrasafe=TRUE</code>. A larger value leads to
a more strict stopping rule. The default value <code>offset=0.05</code>
generally works well.</p>
</td></tr>
<tr><td><code id="select.mtd_+3A_boundmtd">boundMTD</code></td>
<td>
<p>set <code>boundMTD=TRUE</code> to impose the condition: the isotonic estimate of toxicity
probability for the selected MTD must be less than de-escalation boundary.</p>
</td></tr>
<tr><td><code id="select.mtd_+3A_p.tox">p.tox</code></td>
<td>
<p>the lowest toxicity probability that is deemed overly toxic such
that deescalation is required. The default value is
<code>p.tox=1.4*target</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>select.mtd()</code> selects the MTD based on isotonic estimates of toxicity
probabilities. <code>select.mtd()</code> selects as the MTD dose <code class="reqn">j^*</code>, for which the
isotonic estimate of the DLT rate is closest to the target. If there
are ties, we select from the ties the highest dose level when the estimate
of the DLT rate is smaller than the target, or the lowest dose level
when the estimate of the DLT rate is greater than the target. The
isotonic estimates are obtained by the pooled-adjacent-violators algorithm
(PAVA) (Barlow, 1972).
</p>


<h3>Value</h3>

<p><code>select.mtd()</code> returns (1) target toxicity probability (<code>$target</code>), (2) selected MTD (<code>$MTD</code>),
(3) isotonic estimate of the DLT probablity at each dose and associated <code class="reqn">95\%</code> credible interval (<code>$p_est</code>),
and (4) the probability of overdosing defined as <code class="reqn">Pr(toxicity&gt;\code{target}|data)</code> (<code>$p_overdose</code>)
</p>


<h3>Note</h3>

<p>The MTD selection and dose escalation/deescalation rule are two independent
components of the trial design. When appropriate, another dose selection
procedure (e.g., based on a fitted logistic model) can be used to select
the MTD after the completion of the trial using the BOIN design.
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Yanhong Zhou, and Ying Yuan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for
Phase I Clinical Trials, <em>Journal of the Royal Statistical Society:
Series C</em>, 64, 507-523.
</p>
<p>Yan, F., Zhang, L., Zhou, Y., Pan, H., Liu, S. and Yuan, Y. (2020).BOIN: An R Package
for Designing Single-Agent and Drug-Combination Dose-Finding Trials Using Bayesian Optimal
Interval Designs. <em>Journal of Statistical Software</em>, 94(13),1-32.&lt;doi:10.18637/jss.v094.i13&gt;.
</p>
<p>Yuan Y., Hess K.R., Hilsenbeck S.G. and Gilbert M.R. (2016). Bayesian Optimal Interval Design: A
Simple and Well-performing Design for Phase I Oncology Trials, <em>Clinical Cancer Research</em>, 22, 4291-4301.
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf</a>
</p>
<p>Paper: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### select the MTD for BOIN single agent trial
n &lt;- c(3, 3, 15, 9, 0)
y &lt;- c(0, 0, 4, 4, 0)
selmtd &lt;- select.mtd(target=0.3, npts=n, ntox=y)
summary(selmtd)
plot(selmtd)

</code></pre>

<hr>
<h2 id='select.mtd.comb'>Select the maximum tolerated dose (MTD) or MTD contour for drug combination trials</h2><span id='topic+select.mtd.comb'></span>

<h3>Description</h3>

<p>Select the maximum tolerated dose (MTD) or MTD contour after the drug combination trial is
completed using the BOIN design or waterfall design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.mtd.comb(
  target,
  npts,
  ntox,
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05,
  boundMTD = FALSE,
  p.tox = 1.4 * target,
  mtd.contour = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select.mtd.comb_+3A_target">target</code></td>
<td>
<p>the target DLT rate</p>
</td></tr>
<tr><td><code id="select.mtd.comb_+3A_npts">npts</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of patients treated at each dose combination</p>
</td></tr>
<tr><td><code id="select.mtd.comb_+3A_ntox">ntox</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of patients experienced
dose-limiting toxicity at each dose combination</p>
</td></tr>
<tr><td><code id="select.mtd.comb_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate an overly toxic dose for safety.
We recommend the default value of (<code>cutoff.eli=0.95</code>)
for general use.</p>
</td></tr>
<tr><td><code id="select.mtd.comb_+3A_extrasafe">extrasafe</code></td>
<td>
<p>set <code>extrasafe=TRUE</code> to impose a more strict stopping
rule for extra safety</p>
</td></tr>
<tr><td><code id="select.mtd.comb_+3A_offset">offset</code></td>
<td>
<p>a small positive number (between <code>0</code> and <code>0.5</code>) to control how
strict the stopping rule is when <code>extrasafe=TRUE</code>. A
larger value leads to a more strict stopping rule. The
default value <code>offset=0.05</code> generally works well.</p>
</td></tr>
<tr><td><code id="select.mtd.comb_+3A_boundmtd">boundMTD</code></td>
<td>
<p>set <code>boundMTD=TRUE</code> to impose the condition: the isotonic estimate of toxicity
probability for the selected MTD must be less than de-escalation boundary.</p>
</td></tr>
<tr><td><code id="select.mtd.comb_+3A_p.tox">p.tox</code></td>
<td>
<p>the lowest toxicity probability that is deemed overly toxic such
that deescalation is required. The default value is
<code>p.tox=1.4*target</code>.</p>
</td></tr>
<tr><td><code id="select.mtd.comb_+3A_mtd.contour">mtd.contour</code></td>
<td>
<p>set <code>mtd.contour=TRUE</code> to select the MTD contour,
otherwise select a single MTD. The value of <code>mtd.contour</code>
should be consistent with that in <code>get.oc.comb()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>select.mtd.comb()</code> selects a MTD or the MTD contour based
on matrix isotonic estimates of toxicity probabilities, depending on
<code>mtd.contour</code> is set as <code>TRUE</code> or <code>FALSE</code>. The (matrix)
isotonic estimates are obtained by the R package (Iso::biviso).
</p>


<h3>Value</h3>

<p><code>select.mtd.comb()</code> returns returns (1) target toxicity probability (<code>$target</code>),
(2) selected MTD or MTD contour (<code>$MTD</code>),
(3) isotonic estimate of the DLT probablity at each dose (<code>$p_est</code>).
</p>


<h3>Note</h3>

<p>The MTD selection and dose escalation/deescalation rule are two independent
components of the trial design. When appropriate, another dose selection
procedure (e.g., based on a fitted logistic model) can be used to select
the MTD after the completion of the trial using the BOIN or waterfall design.
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Liangcai Zhang, Yanhong Zhou, and Ying Yuan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials, <em>Journal of the Royal Statistical Society: Series C</em>, 64, 507-523.
</p>
<p>Lin R. and Yin, G. (2017). Bayesian Optimal Interval Designs for Dose Finding in
Drug-combination Trials, <em>Statistical Methods in Medical Research</em>, 26, 2155-2167.
</p>
<p>Yan, F., Zhang, L., Zhou, Y., Pan, H., Liu, S. and Yuan, Y. (2020).BOIN: An R Package
for Designing Single-Agent and Drug-Combination Dose-Finding Trials Using Bayesian Optimal
Interval Designs. <em>Journal of Statistical Software</em>, 94(13),1-32.&lt;doi:10.18637/jss.v094.i13&gt;.
</p>
<p>Zhang L. and Yuan, Y. (2016). A Simple Bayesian Design to Identify the Maximum
Tolerated Dose Contour for Drug Combination Trials, <em>Statistics in Medicine</em>, 35, 4924-4936.
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf</a>
</p>
<p>Paper: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### drug-combination trial to find a single MTD

## Select the MTD based on the data from a 3x5 combination trial
## matrix n contains the number of patients treated at each dose combination
## matrix y contains the number of patients experienced toxicity at each dose combination
n &lt;- matrix(c(3, 5, 0, 0, 0, 7, 6, 15, 0, 0, 0, 0, 4, 0, 0), ncol=5, byrow=TRUE)
y &lt;- matrix(c(0, 1, 0, 0, 0, 1, 1, 4, 0, 0, 0, 0, 2, 0, 0), ncol=5, byrow=TRUE)
sel.comb &lt;- select.mtd.comb(target=0.3, npts=n, ntox=y)
summary(sel.comb)
plot(sel.comb)


### drug-combination trial to find the MTD contour

## Select the MTD contour based on the data from a 3x4 combination trial
## matrix n contains the number of patients treated at each dose combination
## matrix y contains the number of patients experienced toxicity at each dose combination
n &lt;- matrix(c(6, 9, 24, 0,  6, 24, 9, 0,  12, 18, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 1,  5, 0,  1,  5, 4, 0,  1, 5, 0, 0), ncol=4, byrow=TRUE)
sel.comb2 &lt;- select.mtd.comb(target=0.3, npts=n, ntox=y, mtd.contour=TRUE)
summary(sel.comb2)
plot(sel.comb2)

</code></pre>

<hr>
<h2 id='summary.boin'>Generate descriptive summary for objects returned by other functions</h2><span id='topic+summary.boin'></span>

<h3>Description</h3>

<p>Generate descriptive summary for objects returned by other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'boin'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.boin_+3A_object">object</code></td>
<td>
<p>the object returned by other functions.</p>
</td></tr>
<tr><td><code id="summary.boin_+3A_...">...</code></td>
<td>
<p>ignored arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary()</code> prints the objects returned by other functions.
</p>


<h3>Value</h3>

<p><code>summary()</code> prints the objects returned by other functions.
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Liangcai Zhang and Ying Yuan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###### single-agent trial ######

## summarize the object returned by get.boundary()
bound &lt;- get.boundary(target=0.3, ncohort=10, cohortsize=3)
summary(bound)


## summarize the object returned by get.oc()
oc.single &lt;- get.oc(target=0.3, p.true=c(0.05, 0.15, 0.3, 0.45, 0.6), ncohort=10,
cohortsize=3, ntrial=1000)
summary(oc.single)


## summarize the object returned by select.mtd()
n &lt;- c(3, 3, 15, 9, 0)
y &lt;- c(0, 0, 4, 4, 0)
selmtd &lt;- select.mtd(target=0.3, npts=n, ntox=y)
summary(selmtd)


###### drug-combination trial######

###### drug-combiation trial to find a single MTD ######

## summarize the object returned by next.comb()
n &lt;- matrix(c(3, 0, 0, 0, 0, 0, 0, 0,  0, 0, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), ncol=4, byrow=TRUE)
nxt.comb &lt;- next.comb(target=0.25, npts=n, ntox=y, dose.curr=c(1, 1))
summary(nxt.comb)


## summarize the object returned by next.comb()
n &lt;- matrix(c(3, 3, 0, 0, 0, 0, 0, 0,  0, 0, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), ncol=4, byrow=TRUE)
nxt.comb &lt;- next.comb(target=0.25, npts=n, ntox=y, dose.curr=c(1, 2))
summary(nxt.comb)


## summarize the object returned by get.oc.comb() when mtd.contour=FALSE
p.true &lt;- matrix(c(0.02,0.04,0.08,0.14,
               0.08,0.25,0.42,0.48,
               0.25,0.45,0.50,0.60), byrow=TRUE, ncol=4)

oc.comb &lt;- get.oc.comb(target=0.25, p.true=p.true, ncohort=16, cohortsize=3,
           ntrial=100)
summary(oc.comb)


## summarize the object returned by select.mtd.comb()
n &lt;- matrix(c(6, 3, 0, 0, 6, 24, 9, 0, 0, 0, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0, 1, 5, 4, 0, 0, 0, 0, 0), ncol=4, byrow=TRUE)
sel.comb &lt;- select.mtd.comb(target=0.25, npts=n, ntox=y)
summary(sel.comb)



###### drug-combiation trial to find the MTD contour ######

## summarize the object returned by next.subtrial()
n &lt;- matrix(c(6, 0,  0, 0,
           6, 0, 0, 0,
           9, 12, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0,
           1, 0, 0, 0,
           2, 3, 0, 0), ncol=4, byrow=TRUE)
nxt.trial &lt;- next.subtrial(target=0.3, npts=n, ntox=y)
summary(nxt.trial)


## summarize the object returned by get.oc.comb() when mtd.contour=TRUE.
p.true &lt;- matrix(c(0.01,0.03,0.10,0.20,0.30,
               0.03,0.05,0.15,0.30,0.60,
               0.08,0.10,0.30,0.60,0.75), byrow=TRUE, ncol=5)

oc.comb &lt;- get.oc.comb(target=0.3, p.true, ncohort=c(10,5,5), cohortsize=3,
   n.earlystop=12, startdose=c(1,1),ntrial=100, mtd.contour=TRUE)
summary(oc.comb)


## summarize the object returned by select.mtd.comb()
n &lt;- matrix(c(6, 9, 24, 0,
           6,  24, 9, 0,
           12, 18, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 1, 5, 0,
           1, 5, 4, 0,
           1, 5, 0, 0), ncol=4, byrow=TRUE)
sel.comb2 &lt;- select.mtd.comb(target=0.3, npts=n, ntox=y, mtd.contour=TRUE)
summary(sel.comb2)



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
