<!DOCTYPE html><html><head><title>Help for package plotmo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {plotmo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot_gbm'><p>Plot a gbm model</p></a></li>
<li><a href='#plot_glmnet'><p>Plot a glmnet model</p></a></li>
<li><a href='#plotmo'><p>Plot a model's response over a range of predictor values (the model surface)</p></a></li>
<li><a href='#plotmo.misc'><p>Ignore</p></a></li>
<li><a href='#plotres'><p>Plot the residuals of a regression model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.6.3</td>
</tr>
<tr>
<td>Title:</td>
<td>Plot a Model's Residuals, Response, and Partial Dependence Plots</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephen Milborrow</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stephen Milborrow &lt;milbo@sonic.net&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), Formula (&ge; 1.2-3), plotrix</td>
</tr>
<tr>
<td>Description:</td>
<td>Plot model surfaces for a wide variety of models
        using partial dependence plots and other techniques.
        Also plot model residuals and other information on the model.</td>
</tr>
<tr>
<td>Suggests:</td>
<td>C50 (&ge; 0.1.0-24), earth (&ge; 5.1.2), gbm (&ge; 2.1.1), glmnet
(&ge; 2.0.5), glmnetUtils (&ge; 1.0.3), MASS (&ge; 7.3-51), mlr (&ge;
2.12.1), neuralnet (&ge; 1.33), partykit (&ge; 1.2-2), pre (&ge;
0.5.0), rpart (&ge; 4.1-15), rpart.plot (&ge; 3.0.8)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.milbo.users.sonic.net">http://www.milbo.users.sonic.net</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-26 12:22:22 UTC; milbo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-26 13:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot_gbm'>Plot a gbm model</h2><span id='topic+plot_gbm'></span>

<h3>Description</h3>

<p>Plot a <code><a href="gbm.html#topic+gbm">gbm</a></code> model showing the training and other
error curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_gbm(object=stop("no 'object' argument"),
    smooth = c(0, 0, 0, 1),
    col = c(1, 2, 3, 4), ylim = "auto",
    legend.x = NULL, legend.y = NULL, legend.cex = .8,
    grid.col = NA,
    n.trees = NA, col.n.trees ="darkgray",
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_gbm_+3A_object">object</code></td>
<td>

<p>The <code>gbm</code> model.
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_smooth">smooth</code></td>
<td>

<p>Four-element vector specifying if smoothing should be applied
to the train, test, CV, and OOB curves respectively.
When smoothing is specified, a smoothed curve is plotted and the
minimum is calculated from the smoothed curve.<br />
The default is c(0, 0, 0, 1) meaning apply smoothing only to the
OOB curve (same as <code><a href="gbm.html#topic+gbm.perf">gbm.perf</a></code>).<br />
Note that <code>smooth=1</code> (which gets recyled to <code>c(1,1,1,1)</code>)
will smooth all the curves.
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_col">col</code></td>
<td>

<p>Four-element vector specifying the colors for the train, test, CV, and OOB
curves respectively.<br />
The default is <code>c(1, 2, 3, 4)</code>.<br />
Use a color of <code>0</code> to remove the corresponding curve, e.g.
<code>col=c(1,2,3,0)</code> to not display the OOB curve.<br />
If <code>col=0</code> (which gets recycled to <code>c(0,0,0,0)</code>) nothing
will be plotted, but <code>plot_gbm</code> will return the number-of-trees
at the minima as usual (as described in the Value section below).
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_ylim">ylim</code></td>
<td>

<p>The default <code>ylim="auto"</code> shows more detail around the minima.<br />
Use <code>ylim=NULL</code> for the full vertical range of the curves.<br />
Else specify <code>ylim</code> as usual.
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_legend.x">legend.x</code></td>
<td>

<p>The x position of the legend.
The default positions the legend automatically.<br />
Use <code>legend.x=NA</code> for no legend.<br />
See the <code>x</code> and <code>y</code> arguments of
<code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code> for other options,
for example <code>legend.x="topright"</code>.
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_legend.y">legend.y</code></td>
<td>

<p>The y position of the legend.
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_legend.cex">legend.cex</code></td>
<td>

<p>The legend <code>cex</code> (the default is <code>0.8</code>).
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_grid.col">grid.col</code></td>
<td>

<p>Default <code>NA</code>.
Color of the optional grid, for example <code>grid.col=1</code>.
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_n.trees">n.trees</code></td>
<td>

<p>For use by <code><a href="#topic+plotres">plotres</a></code>.<br />
The x position of the gray vertical line indicating the <code>n.trees</code>
passed by <code>plotres</code> to <code>predict.gbm</code> to calculate the residuals.
Plotres defaults to all trees.
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_col.n.trees">col.n.trees</code></td>
<td>

<p>For use by <code><a href="#topic+plotres">plotres</a></code>.<br />
Color of the vertical line showing the <code>n.trees</code> argument.
Default is <code>"darkgray"</code>.
</p>
</td></tr>
<tr><td><code id="plot_gbm_+3A_...">...</code></td>
<td>

<p>Dot arguments are passed internally to
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a four-element vector specifying the number of trees at
the train, test, CV, and OOB minima respectively.
</p>
<p>The minima are calculated after smoothing as specified by this
function's <code>smooth</code> argument.
By default, only the OOB curve is smoothed.
The smoothing algorithm for the OOB curve differs slightly
from <code><a href="gbm.html#topic+gbm.perf">gbm.perf</a></code>, so can give a slightly
different number of trees.
</p>


<h3>Note</h3>

<p><b>The OOB curve</b>
</p>
<p>The OOB curve is artificially rescaled to force it into the plot.
See Chapter 7 in the <a href="../doc/plotres-notes.pdf">plotres
vignette</a>.
</p>
<p><b>Interaction with <code>plotres</code></b>
</p>
<p>When invoking this function via <code><a href="#topic+plotres">plotres</a></code>, prefix any
argument of <code>plotres</code> with <code>w1.</code> to tell <code>plotres</code> to
pass the argument to this function.
For example give <code>w1.ylim=c(0,10)</code> to <code>plotres</code> (plain
<code>ylim=c(0,10)</code> in this context gets passed to the residual
plots).
</p>
<p><b>Acknowledgments</b>
</p>
<p>This function is derived from code in the <code><a href="gbm.html#topic+gbm">gbm</a></code>
package authored by Greg Ridgeway and others.
</p>


<h3>See Also</h3>

<p>Chapter 7 in <a href="../doc/plotres-notes.pdf">plotres vignette</a> discusses
this function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require(gbm)) {
    n &lt;- 100                            # toy model for quick demo
    x1 &lt;- 3 * runif(n)
    x2 &lt;- 3 * runif(n)
    x3 &lt;- sample(1:4, n, replace=TRUE)
    y &lt;- x1 + x2 + x3 + rnorm(n, 0, .3)
    data &lt;- data.frame(y=y, x1=x1, x2=x2, x3=x3)
    mod &lt;- gbm(y~., data=data, distribution="gaussian",
               n.trees=300, shrinkage=.1, interaction.depth=3,
               train.fraction=.8, verbose=FALSE)

    plot_gbm(mod)

    # plotres(mod)                      # plot residuals

    # plotmo(mod)                       # plot regression surfaces
}
</code></pre>

<hr>
<h2 id='plot_glmnet'>Plot a glmnet model</h2><span id='topic+plot_glmnet'></span>

<h3>Description</h3>

<p>Plot the coefficient paths of a <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> model.
</p>
<p>An enhanced version of <code><a href="glmnet.html#topic+plot.glmnet">plot.glmnet</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_glmnet(x = stop("no 'x' argument"),
           xvar = c("rlambda", "lambda", "norm", "dev"),
           label = 10, nresponse = NA, grid.col = NA, s = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_glmnet_+3A_x">x</code></td>
<td>

<p>The <code>glmnet</code> model.
</p>
</td></tr>
<tr><td><code id="plot_glmnet_+3A_xvar">xvar</code></td>
<td>

<p>What gets plotted along the x axis. One of:<br />
<b><code>"rlambda"</code></b> (default) decreasing log lambda (lambda is the glmnet penalty)<br />
<b><code>"lambda"</code></b> log lambda<br />
<b><code>"norm"</code></b> L1-norm of the coefficients<br />
<b><code>"dev"</code></b> percent deviance explained<br /><br />
The default <code>xvar</code> differs from <code>plot.glmnet</code> to allow
<code>s</code> to be plotted when this function is invoked by
<code><a href="#topic+plotres">plotres</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_glmnet_+3A_label">label</code></td>
<td>

<p>Default <code>10</code>.
Number of variable names displayed on the right of the plot.
One of:<br />
<b><code>FALSE</code></b> display no variables<br />
<b><code>TRUE</code></b> display all variables<br />
<b><code>integer</code></b> (default) number of variables to display (default is 10)<br />
</p>
</td></tr>
<tr><td><code id="plot_glmnet_+3A_nresponse">nresponse</code></td>
<td>

<p>Which response to plot for multiple response models.
</p>
</td></tr>
<tr><td><code id="plot_glmnet_+3A_grid.col">grid.col</code></td>
<td>

<p>Default <code>NA</code>.
Color of the optional grid, for example <code>grid.col="lightgray"</code>.
</p>
</td></tr>
<tr><td><code id="plot_glmnet_+3A_s">s</code></td>
<td>

<p>For use by <code><a href="#topic+plotres">plotres</a></code>.
The x position of the gray vertical line indicating the lambda
<code>s</code> passed by <code>plotres</code> to <code>predict.glmnet</code> to
calculate the residuals.
Plotres defaults to <code>s=0</code>.
</p>
</td></tr>
<tr><td><code id="plot_glmnet_+3A_...">...</code></td>
<td>

<p>Dot arguments are passed internally to
<code><a href="graphics.html#topic+matplot">matplot</a></code>.
</p>
<p>Use <code>col</code> to change the color of curves; for example <code>col=1:4</code>.
The six default colors are intended to be distinguishable yet
harmonious (to my eye at least), with adjacent colors as different as
easily possible.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Limitations</b>
</p>
<p>For multiple response models use the <code>nresponse</code> argument to
specify which response should be plotted.
(Currently each response must be plotted one by one.)
</p>
<p>The <code>type.coef</code> argument of <code><a href="glmnet.html#topic+plot.glmnet">plot.glmnet</a></code> is
currently not supported.
</p>
<p>Currently <code>xvar="norm"</code> is not supported for multiple
response models (you will get an error message).
</p>
<p><b>Interaction with <code>plotres</code></b>
</p>
<p>When invoking this function via <code><a href="#topic+plotres">plotres</a></code>, prefix any
argument of <code>plotres</code> with <code>w1.</code> to tell <code>plotres</code> to
pass the argument to this function.
For example give <code>w1.col=1:4</code> to <code>plotres</code> (plain
<code>col=1:4</code> in this context gets passed to the residual plots).
</p>
<p><b>Acknowledgments</b>
</p>
<p>This function is based on <code><a href="glmnet.html#topic+plot.glmnet">plot.glmnet</a></code> in the
<code><a href="glmnet.html#topic+glmnet">glmnet</a></code> package authored by Jerome Friedman,
Trevor Hastie, and Rob Tibshirani.
</p>
<p>This function incorporates the function <code>spread.labs</code> from the orphaned
package <code>TeachingDemos</code> written by Greg Snow.
</p>


<h3>See Also</h3>

<p>Chapter 6 in <a href="../doc/plotres-notes.pdf">plotres vignette</a> discusses
this function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require(glmnet)) {
    x &lt;- matrix(rnorm(100 * 10), 100, 10)   # n=100 p=10
    y &lt;- x[,1] + x[,2] + 2 * rnorm(100)     # y depends only on x[,1] and x[,2]
    mod &lt;- glmnet(x, y)

    plot_glmnet(mod)

    # plotres(mod)                          # plot the residuals
}
</code></pre>

<hr>
<h2 id='plotmo'>Plot a model's response over a range of predictor values (the model surface)</h2><span id='topic+plotmo'></span>

<h3>Description</h3>

<p>Plot model surfaces for a wide variety of models.
</p>
<p>This function plots the model's response when varying one or two
predictors while holding the other predictors constant (a poor man's
partial-dependence plot).
</p>
<p>It can also generate partial-dependence plots (by specifying
<code>pmethod="partdep"</code>).
</p>
<p>Please see the <a href="../doc/plotmo-notes.pdf">plotmo vignette</a>
(also available <a href="http://www.milbo.org/doc/plotmo-notes.pdf">here</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmo(object=stop("no 'object' argument"),
    type=NULL, nresponse=NA, pmethod="plotmo",
    pt.col=0, jitter=.5, smooth.col=0, level=0,
    func=NULL, inverse.func=NULL, nrug=0, grid.col=0,
    type2="persp",
    degree1=TRUE, all1=FALSE, degree2=TRUE, all2=FALSE,
    do.par=TRUE, clip=TRUE, ylim=NULL, caption=NULL, trace=0,
    grid.func=NULL, grid.levels=NULL, extend=0,
    ngrid1=50, ngrid2=20, ndiscrete=5, npoints=3000,
    center=FALSE, xflip=FALSE, yflip=FALSE, swapxy=FALSE, int.only.ok=TRUE,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotmo_+3A_object">object</code></td>
<td>

<p>The model object.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_type">type</code></td>
<td>

<p>Type parameter passed to <code><a href="stats.html#topic+predict">predict</a></code>.
For allowed values see the <code>predict</code> method for
your <code>object</code> (such as <code><a href="earth.html#topic+predict.earth">predict.earth</a></code>).
By default, <code>plotmo</code> tries to automatically select a suitable
value for the model in question (usually <code>"response"</code>)
but this will not always be correct.
Use <code>trace=1</code> to see the <code>type</code> argument passed to <code>predict</code>.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_nresponse">nresponse</code></td>
<td>

<p>Which column to use when <code>predict</code> returns multiple columns.
This can be a column index, or a column name if the <code>predict</code>
method for the model returns column names.
The column name may be abbreviated, partial matching is used.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_pmethod">pmethod</code></td>
<td>

<p>Plotting method.
One of:
</p>
<p><code>"plotmo"</code> (default)
Classic plotmo plots i.e. the background variables
are fixed at their medians (or first level for factors).
</p>
<p><code>"partdep"</code> Partial dependence plots, i.e. at each point the effect
of the background variables is averaged.
</p>
<p><code>"apartdep"</code> Approximate partial dependence plots.
Faster than <code>"partdep"</code> especially for big datasets.
Like <code>"partdep"</code> but the background variables are averaged over a
subset of <code>ngrid1</code> cases (default 50), rather than all cases in
the training data.
The subset is created by selecting
rows at equally spaced intervals from the training data
after sorting the data on the response values
(ties are randomly broken).
The same background subset of <code>ngrid1</code> cases is used for both
degree1 and degree2 plots.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_pt.col">pt.col</code></td>
<td>

<p>The color of response points (or response sites in degree2 plots).
This refers to the response <code>y</code> in the data
used to build the model.
Note that the displayed points are jittered by default
(see the <code>jitter</code> argument).
<br />
Default is <code>0</code>, display no response points.
<br />
This can be a vector, like all such arguments &ndash; for example
<code>pt.col = as.numeric(survived)+2</code> to color points by their survival class.
<br />
You can modify the plotted points with
<code>pt.pch</code>, <code>pt.cex</code>, etc.
(these get passed via <code>plotmo</code>'s &ldquo;<code>...</code>&rdquo; argument).
For example, <code>pt.cex = weights</code> to size points by their weight.
To label the points, set <code>pt.pch</code> to a character vector.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_jitter">jitter</code></td>
<td>

<p>Applies only if <code>pt.col</code> is specified.<br />
The default is <code>jitter=.5</code>, automatically apply some jitter to the points.
Points are jittered horizontally and vertically.<br />
Use <code>jitter=0</code> to disable this automatic jittering.
Otherwise something like <code>jitter=1</code>, but the optimum value is data dependent.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_smooth.col">smooth.col</code></td>
<td>

<p>Color of smooth line through the response points.
(The points themselves will not be plotted unless <code>pt.col</code> is specified.)
Default is <code>0</code>, no smooth line.
<br />
Example:</p>
<pre>    mod &lt;- lm(Volume~Height, data=trees)
    plotmo(mod, pt.color=1, smooth.col=2)</pre>
<p>You can adjust the amount of smoothing with <code>smooth.f</code>.
This gets passed as <code>f</code> to <code><a href="stats.html#topic+lowess">lowess</a></code>.
The default is <code>.5</code>.
Lower values make the line more wiggly.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_level">level</code></td>
<td>

<p>Draw estimated confidence or prediction interval bands at the given <code>level</code>,
if the predict method for the model supports them.<br />
Default is <code>0</code>, bands not plotted.
Else a fraction, for example <code>level=.95</code>.
See &ldquo;<em>Prediction intervals</em>&rdquo; in the <code>plotmo</code> vignette.
Example:</p>
<pre>    mod &lt;- lm(log(Volume)~log(Girth), data=trees)
    plotmo(mod, level=.95)</pre>
<p>You can modify the color of the bands with <code>level.shade</code> and <code>level.shade2</code>.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_func">func</code></td>
<td>

<p>Superimpose <code>func(x)</code> on the plot.
Example:</p>
<pre>    mod &lt;- lm(Volume~Girth, data=trees)
    estimated.volume &lt;- function(x) .17 * x$Girth^2
    plotmo(mod, pt.col=2, func=estimated.volume)</pre>
<p>The <code>func</code> is called for each plot with a single argument which
is a dataframe with columns in the same order as the predictors
in the <code>formula</code> or <code>x</code> used to build the model.
Use <code>trace=2</code> to see the column names and first few rows of this dataframe.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_inverse.func">inverse.func</code></td>
<td>

<p>A function applied to the response before plotting.
Useful to transform a transformed response back to the original scale.
Example:</p>
<pre>    mod &lt;- lm(log(Volume)~., data=trees)
    plotmo(mod, inverse.func=exp)    # exp() is inverse of log()

</pre>
</td></tr>
<tr><td><code id="plotmo_+3A_nrug">nrug</code></td>
<td>

<p>Number of ticks in the <code><a href="graphics.html#topic+rug">rug</a></code> along the bottom of the plot
<br />
Default is <code>0</code>, no rug.
<br />
Use <code>nrug=TRUE</code> for all the points.
<br />
Else specify the number of quantiles
e.g. use <code>nrug=10</code> for ticks at the 0, 10, 20, ..., 100 percentiles.
<br />
Modify the rug ticks with <code>rug.col</code>, <code>rug.lwd</code>, etc.
<br />
The special value <code>nrug="density"</code> means plot the
density of the points along the bottom.
Modify the <code><a href="stats.html#topic+density">density</a></code> plot with <code>density.adjust</code> (default is <code>.5</code>),
<code>density.col</code>, <code>density.lty</code>, etc.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_grid.col">grid.col</code></td>
<td>

<p>Default is <code>0</code>, no grid.
Else add a background <code><a href="graphics.html#topic+grid">grid</a></code>
of the specified color to the degree1 plots.
The special value <code>grid.col=TRUE</code> is treated as <code>"lightgray"</code>.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_type2">type2</code></td>
<td>

<p>Degree2 plot type.
One of <code>"<a href="graphics.html#topic+persp">persp</a>"</code> (default),
<code>"<a href="graphics.html#topic+image">image</a>"</code>, or <code>"<a href="graphics.html#topic+contour">contour</a>"</code>.
You can pass arguments to these functions if necessary by using
<code>persp.</code>, <code>image.</code>, or <code>contour.</code> as a prefix.
Examples:</p>
<pre>    plotmo(mod, persp.ticktype="detailed", persp.nticks=3)
    plotmo(mod, type2="image")
    plotmo(mod, type2="image", image.col=heat.colors(12))
    plotmo(mod, type2="contour", contour.col=2, contour.labcex=.4)
    </pre>
</td></tr>
<tr><td><code id="plotmo_+3A_degree1">degree1</code></td>
<td>

<p>An index vector specifying which subset of degree1 (main effect) plots to include
(after selecting the relevant predictors as described in
&ldquo;<em>Which variables are plotted?</em>&rdquo; in the <code>plotmo</code> vignette).
<br />
Default is <code>TRUE</code>, meaning all (the <code>TRUE</code> gets recycled).
To plot only the third plot use <code>degree1=3</code>.
For no degree1 plots use <code>degree1=0</code>.
<br />
<br />
Note that <code>degree1</code> indexes plots on the page,
not columns of <code>x</code>.
Probably the easiest way to use this argument (and <code>degree2</code>) is to
first use the default (and possibly <code>all1=TRUE</code>)
to plot all figures.  This shows how the figures are numbered.
Then replot using <code>degree1</code> to select the figures you want,
for example <code>degree1=c(1,3,4)</code>.
<br />
<br />
Can also be a character vector
specifying which variables to plot. Examples:<br />
<code>degree1="wind"</code><br />
<code>degree1=c("wind", "vis")</code>.
<br />
<br />
Variables names are matched with <code><a href="base.html#topic+grep">grep</a></code>.
Thus <code>"wind"</code> will match all variables with <code>"wind"</code>
anywhere in their name. Use <code>"^wind$"</code> to match only the variable
named <code>"wind"</code>.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_all1">all1</code></td>
<td>

<p>Default is <code>FALSE</code>.
Use <code>TRUE</code> to plot all predictors,
not just those usually selected by <code>plotmo</code>.
<br />
The <code>all1</code> argument increases the number of plots;
the <code>degree1</code> argument reduces the number of plots.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_degree2">degree2</code></td>
<td>

<p>An index vector specifying which subset of degree2 (interaction) plots to include.
<br />
Default is <code>TRUE</code> meaning all
(after selecting the relevant interaction terms as described in
&ldquo;<em>Which variables are plotted?</em>&rdquo; in the <code>plotmo</code> vignette).
<br />
<br />
Can also be a character vector specifying which variables to plot
(<code><a href="base.html#topic+grep">grep</a></code> is used for matching).
Examples:
<br />
<code>degree2="wind"</code> plots all degree2 plots
for the <code>wind</code> variable.
<br />
<code>degree2=c("wind", "vis")</code> plots just the <code>wind:vis</code> plot.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_all2">all2</code></td>
<td>

<p>Default is <code>FALSE</code>.
Use <code>TRUE</code> to plot all pairs of predictors,
not just those usually selected by <code>plotmo</code>.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_do.par">do.par</code></td>
<td>
<p>One of <code>NULL</code>, <code>FALSE</code>, <code>TRUE</code>, or <code>2</code>, as follows:
</p>
<p><code>do.par=NULL</code>. Same as <code>do.par=FALSE</code> if the
number of plots is one; else the same as <code>TRUE</code>.
</p>
<p><code>do.par=FALSE</code>. Use the current <code><a href="graphics.html#topic+par">par</a></code> settings.
You can pass additional graphics parameters in the &ldquo;<code>...</code>&rdquo; argument.
</p>
<p><code>do.par=TRUE</code> (default). Start a new page and call <code><a href="graphics.html#topic+par">par</a></code> as
appropriate to display multiple plots on the same page.
This automatically sets parameters like <code>mfrow</code> and <code>mar</code>.
You can pass additional graphics parameters in the &ldquo;<code>...</code>&rdquo; argument.
</p>
<p><code>do.par=2</code>.  Like <code>do.par=TRUE</code> but don't restore
the <code><a href="graphics.html#topic+par">par</a></code> settings to their original state when <code>plotmo</code> exits,
so you can add something to the plot.
<br />
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_clip">clip</code></td>
<td>

<p>The default is <code>clip=TRUE</code>, meaning ignore very outlying
predictions  when determining the automatic <code>ylim</code>.
This keeps <code>ylim</code> fairly compact while
still covering all or nearly all the data,
even if there are a few crazy predicted values.
See &ldquo;<em>The <code>ylim</code> and <code>clip</code> arguments</em>&rdquo; in the <code>plotmo</code> vignette.
<br />
Use <code>clip=FALSE</code> for no clipping.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_ylim">ylim</code></td>
<td>
<p>Three possibilities:
<br />
<code>ylim=NULL</code> (default). Automatically determine a <code>ylim</code>
to use across all graphs.
<br />
<code>ylim=NA</code>. Each graph has its own <code>ylim</code>.
<br />
<code>ylim=c(ymin,ymax)</code>. Use the specified limits across all graphs.
<br />
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_caption">caption</code></td>
<td>

<p>Overall caption.  By default create the caption automatically.
Use <code>caption=""</code> for no caption.
(Use <code>main</code> to set the title of individual plots, can be a vector.)
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_trace">trace</code></td>
<td>

<p>Default is <code>0</code>.
<br />
<code>trace=1</code> (or <code>TRUE</code>) for a summary trace (shows how
<code><a href="stats.html#topic+predict">predict</a></code> is invoked for the current object).
<br />
<code>trace=2</code> for detailed tracing.
<br />
<code>trace=-1</code> inhibits the messages usually issued by <code>plotmo</code>,
like the <code>plotmo grid:</code>,
<code>calculating partdep</code>,
and  <code>nothing to plot</code> messages.
Error and warning messages will be printed as usual.
<br />
<br />
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_grid.func">grid.func</code></td>
<td>

<p>Function applied to columns of the <code>x</code> matrix to pin the values of
variables not on the axis of the current plot (the &ldquo;background&rdquo; variables).<br />
The default is a function which for numeric variables returns the
median and for logical and factors variables returns the value
occurring most often in the training data.<br />
Examples:</p>
<pre>    plotmo(mod, grid.func=mean)
    grid.func &lt;- function(x, ...) quantile(x)[2] # 25% quantile
    plotmo(mod, grid.func=grid.func)</pre>
<p>This argument is not related to the <code>grid.col</code> argument.<br />
This argument can be overridden for specific variables&mdash;see <code>grid.levels</code> below.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_grid.levels">grid.levels</code></td>
<td>

<p>Default is <code>NULL</code>.
Else a list of variables and their fixed value to be used
when the variable is not on the axis.
Supersedes <code>grid.func</code> for variables in the list.
Names and values can be abbreviated, partial matching is used.
Example:</p>
<pre>    plotmo(mod, grid.levels=list(sex="m", age=21))

</pre>
</td></tr>
<tr><td><code id="plotmo_+3A_extend">extend</code></td>
<td>

<p>Amount to extend the horizontal axis in each plot.
The default is <code>0</code>, do not extend
(i.e. use the range of the variable in the training data).
Else something like <code>extend=.5</code>, which will extend both the lower
and upper <code>xlim</code> of each plot by 50%.<br />
This argument is useful if you want to see how the model performs
on data that is beyond the training data;
for example, you want to see how a time-series model performs on future data.<br />
This argument is currently implemented only for degree1 plots.
Factors and discrete variables (see the <code>ndiscrete</code> argument)
are not extended.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_ngrid1">ngrid1</code></td>
<td>

<p>Number of equally spaced x values in each degree1 plot.
Default is <code>50</code>.
Also used as the number of background cases for <code>pmethod="apartdep"</code>.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_ngrid2">ngrid2</code></td>
<td>

<p>Grid size for degree2 plots (<code>ngrid2 x ngrid2</code> points are plotted).
Default is <code>20</code>.
<br />
The default will sometimes be too small for <code>contour</code> and <code>image</code> plots.
<br />
With large <code>ngrid2</code> values, <code>persp</code> plots look better with
<code>persp.border=NA</code>.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_npoints">npoints</code></td>
<td>

<p>Number of response points to be plotted
(a sample of <code>npoints</code> points is plotted).
Applies only if <code>pt.col</code> is specified.
<br />
The default is 3000 (not all, to avoid overplotting on large models).
Use <code>npoints=TRUE</code> or <code>-1</code> for all points.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_ndiscrete">ndiscrete</code></td>
<td>

<p>Default <code>5</code> (a somewhat arbitrary value).
Variables with no more than <code>ndiscrete</code> unique values
are plotted as quantized in plots (a staircase rather than a curve).<br />
Factors are always considered discrete.
Variables with non-integer values are always considered non-discrete.<br />
Use <code>ndiscrete=0</code> if you want to plot the response for a variable
with just a few integer values as a line or a curve, rather than a
staircase.<br />
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_int.only.ok">int.only.ok</code></td>
<td>

<p>Plot the model even if it is an intercept-only model (no predictors are
used in the model).
Do this by plotting a single degree1 plot for the first predictor.
<br />
The default is <code>TRUE</code>.
Use <code>int.only.ok=FALSE</code> to instead issue an error message for intercept-only models.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_center">center</code></td>
<td>

<p>Center the plotted response.
Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_xflip">xflip</code></td>
<td>

<p>Default <code>FALSE</code>.
Use <code>TRUE</code> to flip the direction of the <code>x</code> axis.
This argument (and <code>yflip</code> and <code>swapxy</code>) is useful when comparing
to a plot from another source and you want the axes to be the same.
(Note that <code>xflip</code> and <code>yflip</code> cannot be used on the <code>persp</code> plots,
a limitation of the <code>persp</code> function.)
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_yflip">yflip</code></td>
<td>

<p>Default <code>FALSE</code>.
Use <code>TRUE</code> to flip the direction of the y axis of the degree2 graphs.
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_swapxy">swapxy</code></td>
<td>

<p>Default <code>FALSE</code>.
Use <code>TRUE</code> to swap the x and y axes on the degree2 graphs.
<br />
<br />
</p>
</td></tr>
<tr><td><code id="plotmo_+3A_...">...</code></td>
<td>

<p>Dot arguments are passed to the predict and plot functions.
Dot argument names, whether prefixed or not, should be specified in full
and not abbreviated.
<br />
<br />
&ldquo;Prefixed&rdquo; arguments are passed directly to the associated function.
For example the prefixed argument <code>persp.col="pink"</code> passes
<code>col="pink"</code> to <code>persp()</code>, overriding the global
<code>col</code> setting.
To send an argument to <code>predict</code> whose name may alias with
<code>plotmo</code>'s arguments, use <code>predict.</code> as a prefix.
Example:</p>
<pre>    plotmo(mod, s=1)           # error:  arg matches multiple formal args
    plotmo(mod, predict.s=1)   # ok now: s=1 will be passed to predict()
</pre>
<p>The prefixes recognized by <code>plotmo</code> are:</p>

<table>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>predict.</code> </td><td style="text-align: left;"> passed to the <code><a href="stats.html#topic+predict">predict</a></code> method for the model
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>degree1.</code> </td><td style="text-align: left;"> modifies degree1 plots e.g. <code>degree1.col=3, degree1.lwd=2</code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>persp.</code> </td><td style="text-align: left;"> arguments passed to <code><a href="graphics.html#topic+persp">persp</a></code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>contour.</code> </td><td style="text-align: left;"> arguments passed to <code><a href="graphics.html#topic+contour">contour</a></code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>image.</code> </td><td style="text-align: left;"> arguments passed to <code><a href="graphics.html#topic+image">image</a></code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>pt.</code> </td><td style="text-align: left;"> see the <code>pt.col</code> argument
(arguments passed to <code><a href="graphics.html#topic+points">points</a></code> and <code><a href="graphics.html#topic+text">text</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>smooth.</code> </td><td style="text-align: left;"> see the <code>smooth.col</code> argument
(arguments passed to <code><a href="graphics.html#topic+lines">lines</a></code> and <code><a href="stats.html#topic+lowess">lowess</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>level.</code> </td><td style="text-align: left;"> see the <code>level</code> argument
(<code>level.shade</code>, <code>level.shade2</code>, and arguments for <code><a href="graphics.html#topic+polygon">polygon</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>func.</code> </td><td style="text-align: left;"> see the <code>func</code> argument
(arguments passed to <code><a href="graphics.html#topic+lines">lines</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>rug.</code> </td><td style="text-align: left;"> see the <code>nrug</code> argument
(<code>rug.jitter</code>, and arguments passed to <code><a href="graphics.html#topic+rug">rug</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>density.</code> </td><td style="text-align: left;"> see the <code>nrug</code> argument
(<code>density.adjust</code>, and arguments passed to <code><a href="graphics.html#topic+lines">lines</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>grid.</code> </td><td style="text-align: left;"> see the <code>grid.col</code> argument
(arguments passed to <code><a href="graphics.html#topic+grid">grid</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>caption.</code> </td><td style="text-align: left;"> see the <code>caption</code> argument
(arguments passed to <code><a href="graphics.html#topic+mtext">mtext</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>par.</code> </td><td style="text-align: left;"> arguments passed to <code><a href="graphics.html#topic+par">par</a></code>
(only necessary if a <code>par</code> argument name clashes
with a <code>plotmo</code> argument)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>prednames.</code> </td><td style="text-align: left;"> Use <code>prednames.abbreviate=FALSE</code> for
full predictor names in graph axes.
</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The <code>cex</code> argument is relative, so
specifying <code>cex=1</code> is the same as not specifying <code>cex</code>.
</p>
<p>For backwards compatibility, some dot arguments are supported but not
explicitly documented.  For example, the old argument <code>col.response</code>
is no longer in <code>plotmo</code>'s formal argument list, but is still
accepted and treated like the new argument <code>pt.col</code>.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In general this function won't work on models that don't save the call
and data with the model in a standard way.
For further discussion please see &ldquo;<em>Accessing the model
data</em>&rdquo; in the <a href="../doc/plotmo-notes.pdf">plotmo vignette</a>.
Package authors may want to look at
<a href="../doc/modguide.pdf">Guidelines for S3 Regression Models</a>
(also available <a href="http://www.milbo.org/doc/modguide.pdf">here</a>).
</p>
<p>By default, <code>plotmo</code> tries to use sensible model-dependent
defaults when calling <code>predict</code>.
Use <code>trace=1</code> to see the arguments passed to <code>predict</code>.
You can change the defaults by using <code>plotmo</code>'s <code>type</code> argument,
and by using dot arguments prefixed with
<code>predict.</code> (see the description of &ldquo;<code>...</code>&rdquo; above).
</p>


<h3>See Also</h3>

<p>Please see the <a href="../doc/plotmo-notes.pdf">plotmo vignette</a>
(also available <a href="http://www.milbo.org/doc/plotmo-notes.pdf">here</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require(rpart)) {
    data(kyphosis)
    rpart.model &lt;- rpart(Kyphosis~., data=kyphosis)
    # pass type="prob" to plotmo's internal calls to predict.rpart, and
    # select the column named "present" from the matrix returned by predict.rpart
    plotmo(rpart.model, type="prob", nresponse="present")
}
if (require(earth)) {
    data(ozone1)
    earth.model &lt;- earth(O3 ~ ., data=ozone1, degree=2)
    plotmo(earth.model)
    # plotmo(earth.model, pmethod="partdep") # partial dependence plots
}
</code></pre>

<hr>
<h2 id='plotmo.misc'>Ignore</h2><span id='topic+check.index'></span><span id='topic+plotmo.convert.na.nresponse'></span><span id='topic+plotmo.pairs.default'></span><span id='topic+plotmo.pairs'></span><span id='topic+plotmo.pint'></span><span id='topic+plotmo.predict'></span><span id='topic+plotmo.prolog'></span><span id='topic+plotmo.residtype'></span><span id='topic+plotmo.singles.default'></span><span id='topic+plotmo.singles'></span><span id='topic+plotmo.type'></span><span id='topic+plotmo.x'></span><span id='topic+plotmo.y.default'></span><span id='topic+plotmo.y'></span><span id='topic+plotmo_cum'></span><span id='topic+plotmo_fitted'></span><span id='topic+plotmo_nresponse'></span><span id='topic+plotmo_predict'></span><span id='topic+plotmo_prolog'></span><span id='topic+plotmo_resplevs'></span><span id='topic+plotmo_response'></span><span id='topic+plotmo_rinfo'></span><span id='topic+plotmo_rsq'></span><span id='topic+plotmo_standardizescale'></span><span id='topic+plotmo_type'></span><span id='topic+plotmo_y'></span>

<h3>Description</h3>

<p>Miscellaneous functions exported for internal use by <code>earth</code>
and other packages.
You can ignore these.
</p>


<h3>Usage</h3>

<pre><code class='language-R'># for earth
plotmo_fitted(object, trace, nresponse, type, ...)
plotmo_cum(rinfo, info, nfigs=1, add=FALSE,
           cum.col1, grid.col, jitter=0, cum.grid="percentages", ...)
plotmo_nresponse(y, object, nresponse, trace, fname, type="response")
plotmo_rinfo(object, type=NULL, residtype=type, nresponse=1,
    standardize=FALSE, delever=FALSE, trace=0,
    leverage.msg="returned as NA", expected.levs=NULL, labels.id=NULL, ...)
plotmo_predict(object, newdata, nresponse,
    type, expected.levs, trace, inverse.func=NULL, ...)
plotmo_prolog(object, object.name, trace, ...)
plotmo_resplevs(object, plotmo_fitted, yfull, trace)
plotmo_rsq(object, newdata, trace=0, nresponse=NA, type=NULL, ...)
plotmo_standardizescale(object)
plotmo_type(object, trace, fname="plotmo", type, ...)
plotmo_y(object, nresponse=NULL, trace=0, expected.len=NULL,
    resp.levs=NULL, convert.glm.response=!is.null(nresponse))
## Default S3 method:
plotmo.pairs(object, x, nresponse, trace, all2, ...)
## Default S3 method:
plotmo.singles(object, x, nresponse, trace, all1, ...)
## Default S3 method:
plotmo.y(object, trace, naked, expected.len, ...)
# plotmo methods
plotmo.convert.na.nresponse(object, nresponse, yhat, type="response", ...)
plotmo.pairs(object, x, nresponse, trace, all2, ...)
plotmo.pint(object, newdata, type, level, trace, ...)
plotmo.predict(object, newdata, type, ..., TRACE)
plotmo.prolog(object, object.name, trace, ...)
plotmo.residtype(object, ..., TRACE)
plotmo.singles(object, x, nresponse, trace, all1, ...)
plotmo.type(object, ..., TRACE)
plotmo.x(object, trace, ...)
plotmo.y(object, trace, naked, expected.len, nresponse=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotmo.misc_+3A_...">...</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_add">add</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_all1">all1</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_all2">all2</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_convert.glm.response">convert.glm.response</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_cum.col1">cum.col1</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_cum.grid">cum.grid</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_delever">delever</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_expected.len">expected.len</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_expected.levs">expected.levs</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_fname">fname</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_grid.col">grid.col</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_info">info</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_inverse.func">inverse.func</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_jitter">jitter</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_labels.id">labels.id</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_level">level</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_leverage.msg">leverage.msg</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_naked">naked</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_newdata">newdata</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_nfigs">nfigs</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_nresponse">nresponse</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_object.name">object.name</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_object">object</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_plotmo_fitted">plotmo_fitted</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_residtype">residtype</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_resp.levs">resp.levs</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_rinfo">rinfo</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_standardize">standardize</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_trace">TRACE</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_trace">trace</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_type">type</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_x">x</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_yfull">yfull</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_yhat">yhat</code></td>
<td>
<p>-</p>
</td></tr>
<tr><td><code id="plotmo.misc_+3A_y">y</code></td>
<td>
<p>-</p>
</td></tr>
</table>

<hr>
<h2 id='plotres'>Plot the residuals of a regression model</h2><span id='topic+plotres'></span>

<h3>Description</h3>

<p>Plot the residuals of a regression model.
</p>
<p>Please see the <a href="../doc/plotres-notes.pdf">plotres vignette</a>
(also available <a href="http://www.milbo.org/doc/plotres-notes.pdf">here</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotres(object = stop("no 'object' argument"),
    which = 1:4, info = FALSE, versus = 1,
    standardize = FALSE, delever = FALSE, level = 0,
    id.n = 3, labels.id = NULL, smooth.col = 2,
    grid.col = 0, jitter = 0,
    do.par = NULL, caption = NULL, trace = 0,
    npoints = 3000, center = TRUE,
    type = NULL, nresponse = NA,
    object.name = quote.deparse(substitute(object)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotres_+3A_object">object</code></td>
<td>

<p>The model object.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_which">which</code></td>
<td>

<p>Which plots do draw.  Default is <code>1:4</code>.
</p>
<p><code>1</code>  Model plot.  What gets plotted here depends on the model class.
For example, for <code>earth</code> models this is a model selection plot.
Nothing will be displayed for some models.
For details, please see the
<a href="../doc/plotres-notes.pdf">plotres vignette</a>.
</p>
<p><code>2</code>  Cumulative distribution of abs residuals
</p>
<p><code>3</code>  Residuals vs fitted
</p>
<p><code>4</code>  QQ plot
</p>
<p><code>5</code>  Abs residuals vs fitted
</p>
<p><code>6</code>  Sqrt abs residuals vs fitted
</p>
<p><code>7</code>  Abs residuals vs log fitted
</p>
<p><code>8</code>  Cube root of the squared residuals vs log fitted
</p>
<p><code>9</code>  Log abs residuals vs log fitted
<br />
<br />
</p>
</td></tr>
<tr><td><code id="plotres_+3A_info">info</code></td>
<td>

<p>Default is <code>FALSE</code>.
Use <code>TRUE</code> to print extra information as follows:
</p>
<p>i) Display the distribution of the residuals along the bottom of the plot.
</p>
<p>ii) Display the training R-Squared.
</p>
<p>iii) Display the Spearman Rank Correlation of the absolute residuals
with the fitted values.
Actually, correlation is measured against the absolute values
of whatever is on the horizontal
axis &mdash; by default this is the fitted response, but may be something
else if the <code>versus</code> argument is used.
</p>
<p>iv) In the Cumulative Distribution plot (<code>which=2</code>),
display additional information on the quantiles.
</p>
<p>v) Only for <code>which=5</code> or <code>9</code>.
Regress the absolute residuals against the fitted values
and display the regression slope.
Robust linear regression is used via <code><a href="MASS.html#topic+rlm">rlm</a></code> in the MASS package.
</p>
<p>vi) Add various annotations to the other plots.
<br />
<br />
</p>
</td></tr>
<tr><td><code id="plotres_+3A_versus">versus</code></td>
<td>

<p>What do we plot the residuals against?  One of:
</p>
<p><code>1</code> Default. Plot the residuals versus the fitted values
(or the log values when <code>which=7</code> to <code>9</code>).
</p>
<p><code>2</code> Residuals versus observation number,
after observations have been sorted on the fitted value.
Same as <code>versus=1</code>, except that the residuals are spaced
uniformly along the horizontal axis.
</p>
<p><code>3</code> Residuals versus the response.
</p>
<p><code>4</code> Residuals versus the hat leverages.
</p>
<p><code>"b:"</code> Residuals versus the basis functions.
Currently only supported for <code>earth</code>, <code>mda::mars</code>, and <code>gam::gam</code> models.
A optional <code><a href="base.html#topic+regex">regex</a></code> can follow the <code>"b:"</code> to specify a subset of the
terms, e.g. <code>versus="b:wind"</code> will plot terms with <code>"wind"</code> in
their name.
</p>
<p>Else a character vector specifying which predictors to plot against.
<br />
Example 1: <code>versus=""</code> plots against all predictors (since the
regex <code>versus=""</code> matches anything).
<br />
Example 2: <code>versus=c("wind", "vis")</code> plots predictors
with <code>wind</code> or <code>vis</code> in their name.
<br />
Example 3: <code>versus=c("wind|vis")</code> equivalent to the above.
<br />
Note: These are <code><a href="base.html#topic+regex">regex</a></code>s.
Thus <code>versus="wind"</code> will match all variables that have <code>"wind"</code>
in their names. Use <code>"^wind$"</code> to match only the variable named
<code>"wind"</code>.
<br />
<br />
</p>
</td></tr>
<tr><td><code id="plotres_+3A_standardize">standardize</code></td>
<td>

<p>Default is <code>FALSE</code>.
Use <code>TRUE</code> to standardize the residuals.
Only supported for some models, an error message will be issued otherwise.
<br />
Each residual is divided by by <code>se_i * sqrt(1 - h_ii)</code>,
where <code>se_i</code> is the standard error of prediction
and <code>h_ii</code> is the leverage (the diagonal entry of the hat matrix).
When the variance model holds, the standardized residuals are
homoscedastic with unity variance.
<br />
The leverages are obtained using <code><a href="stats.html#topic+hatvalues">hatvalues</a></code>.
(For <code>earth</code> models the leverages are
for the linear regression of the response on the basis matrix <code>bx</code>.)
A standardized residual with a leverage of 1 is plotted as a star on the axis.
<br />
This argument applies to all plots where the residuals are used
(including the cumulative distribution and QQ plots, and to
annotations displayed by the <code>info</code> argument).
</p>
</td></tr>
<tr><td><code id="plotres_+3A_delever">delever</code></td>
<td>

<p>Default is <code>FALSE</code>.
Use <code>TRUE</code> to &ldquo;de-lever&rdquo; the residuals.
Only supported for some models, an error message will be issued otherwise.
<br />
Each residual is divided by <code>sqrt(1 - h_ii)</code>.
See the <code>standardize</code> argument for details.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_level">level</code></td>
<td>

<p>Draw estimated confidence or prediction interval bands at the given
<code>level</code>, if the model supports them.
<br />
Default is <code>0</code>, bands not plotted.
Else a fraction, for example <code>level=0.90</code>.
Example:</p>
<pre>    mod &lt;- lm(log(Volume)~log(Girth), data=trees)
    plotres(mod, level=.90)</pre>
<p>You can modify the color of the bands with <code>level.shade</code> and <code>level.shade2</code>.
<br />
See also &ldquo;<em>Prediction intervals</em>&rdquo; in the
<a href="../doc/plotmo-notes.pdf">plotmo vignette</a>
(but note that <code>plotmo</code> needs prediction intervals on <em>new</em>
data, whereas <code>plotres</code> requires only that the model supports
prediction intervals on the training data).
</p>
</td></tr>
<tr><td><code id="plotres_+3A_id.n">id.n</code></td>
<td>

<p>The largest <code>id.n</code> residuals will be labeled in the plot.
Default is <code>3</code>.
Special values <code>TRUE</code> and <code>-1</code> or mean all.<br />
If <code>id.n</code> is negative (but not <code>-1</code>)
the <code>id.n</code> most positive and most negative
residuals will be labeled in the plot.<br />
A current implementation restriction is that <code>id.n</code> is ignored
when there are more than ten thousand cases.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_labels.id">labels.id</code></td>
<td>

<p>Residual labels.
Only used if <code>id.n &gt; 0</code>.
Default is the case names, or the case numbers if the cases are unnamed.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_smooth.col">smooth.col</code></td>
<td>

<p>Color of the smooth line through the residual points.
Default is <code>2</code>, red. Use <code>smooth.col=0</code> for no smooth line.
<br />
You can adjust the amount of smoothing with <code>smooth.f</code>.
This gets passed as <code>f</code> to <code><a href="stats.html#topic+lowess">lowess</a></code>.
The default is <code>2/3</code>.
Lower values make the line more wiggly.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_grid.col">grid.col</code></td>
<td>

<p>Default is <code>0</code>, no grid.
Else add a background <code><a href="graphics.html#topic+grid">grid</a></code>
of the specified color to the degree1 plots.
The special value <code>grid.col=TRUE</code> is treated as <code>"lightgray"</code>.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_jitter">jitter</code></td>
<td>

<p>Default is <code>0</code>, no jitter.
Passed as <code>factor</code> to <code><a href="base.html#topic+jitter">jitter</a></code>
to jitter the plotted points horizontally and vertically.
Useful for discrete variables and responses, where the residual points
tend to be overlaid.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_do.par">do.par</code></td>
<td>
<p>One of <code>NULL</code>, <code>FALSE</code>, <code>TRUE</code>, or <code>2</code>, as follows:
</p>
<p><code>do.par=NULL</code> (default). Same as <code>do.par=FALSE</code> if the
number of plots is one; else the same as <code>TRUE</code>.
</p>
<p><code>do.par=FALSE</code>. Use the current <code><a href="graphics.html#topic+par">par</a></code> settings.
You can pass additional graphics parameters in the &ldquo;<code>...</code>&rdquo; argument.
</p>
<p><code>do.par=TRUE</code>. Start a new page and call <code><a href="graphics.html#topic+par">par</a></code> as
appropriate to display multiple plots on the same page.
This automatically sets parameters like <code>mfrow</code> and <code>mar</code>.
You can pass additional graphics parameters in the &ldquo;<code>...</code>&rdquo; argument.
</p>
<p><code>do.par=2</code>.  Like <code>do.par=TRUE</code> but don't restore the
<code><a href="graphics.html#topic+par">par</a></code> settings to their original state when
<code>plotres</code> exits, so you can add something to the plot.
<br />
<br />
</p>
</td></tr>
<tr><td><code id="plotres_+3A_caption">caption</code></td>
<td>

<p>Overall caption.  By default create the caption automatically.
Use <code>caption=""</code> for no caption.
(Use <code>main</code> to set the title of an individual plot.)
</p>
</td></tr>
<tr><td><code id="plotres_+3A_trace">trace</code></td>
<td>

<p>Default is <code>0</code>.
<br />
<code>trace=1</code> (or <code>TRUE</code>) for a summary trace (shows how
<code><a href="stats.html#topic+predict">predict</a></code> and friends
are invoked for the model).
<br />
<code>trace=2</code> for detailed tracing.
<br />
</p>
</td></tr>
<tr><td><code id="plotres_+3A_npoints">npoints</code></td>
<td>

<p>Number of points to be plotted.
A sample of <code>npoints</code> is taken; the sample includes the biggest
twenty or so residuals.
<br />
The default is 3000 (not all, to avoid overplotting on large models).
Use <code>npoints=TRUE</code> or <code>-1</code> for all points.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_center">center</code></td>
<td>

<p>Default is TRUE, meaning center the horizontal axis in the residuals plot,
so asymmetry in the residual distribution is more obvious.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_type">type</code></td>
<td>

<p>Type parameter passed first to <code><a href="stats.html#topic+residuals">residuals</a></code> and
if that fails to <code><a href="stats.html#topic+predict">predict</a></code>.
For allowed values see the <code>residuals</code> and <code>predict</code> methods for
your <code>object</code>
(such as
<code><a href="rpart.html#topic+residuals.rpart">residuals.rpart</a></code> or
<code><a href="earth.html#topic+predict.earth">predict.earth</a></code>).
By default, <code>plotres</code> tries to automatically select a suitable
value for the model in question (usually <code>"response"</code>),
but this will not always be correct.
Use <code>trace=1</code> to see the <code>type</code> argument passed to
<code>residuals</code> and <code>predict</code>.
</p>
</td></tr>
<tr><td><code id="plotres_+3A_nresponse">nresponse</code></td>
<td>

<p>Which column to use when <code>residuals</code> or <code>predict</code> returns
multiple columns.
This can be a column index or column name
(which may be abbreviated, partial matching is used).
</p>
</td></tr>
<tr><td><code id="plotres_+3A_object.name">object.name</code></td>
<td>

<p>The name of the <code>object</code> for error and trace messages.
Used internally by <code>plot.earth</code>.
<br />
<br />
</p>
</td></tr>
<tr><td><code id="plotres_+3A_...">...</code></td>
<td>

<p>Dot arguments are passed to the plot functions.
Dot argument names, whether prefixed or not, should be specified in full
and not abbreviated.
</p>
<p>&ldquo;Prefixed&rdquo; arguments are passed directly to the associated function.
For example the prefixed argument <code>pt.col="pink"</code> passes
<code>col="pink"</code> to <code>points()</code>, overriding the global
<code>col</code> setting.
The prefixes recognized by <code>plotres</code> are:</p>

<table>
<tr>
 <td style="text-align: left;">
<code>residuals.</code> </td><td style="text-align: left;"> passed to <code><a href="stats.html#topic+residuals">residuals</a></code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>predict.</code> </td><td style="text-align: left;"> passed to <code><a href="stats.html#topic+predict">predict</a></code>
(<code>predict</code> is called if the call to <code>residuals</code> fails)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>w1.</code> </td><td style="text-align: left;"> sent to the model-dependent plot for <code>which=1</code> e.g. <code>w1.col=2</code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>pt.</code> </td><td style="text-align: left;"> modify the displayed points
e.g. <code>pt.col=as.numeric(survived)+2</code> or <code>pt.cex=.8</code>.
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>smooth.</code> </td><td style="text-align: left;"> modify the  smooth line e.g. <code>smooth.col=0</code> or
<code>smooth.f=.5</code>.
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>level.</code> </td><td style="text-align: left;"> modify the interval bands, e.g. <code>level.shade="gray"</code> or <code>level.shade2="lightblue"</code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>legend.</code> </td><td style="text-align: left;"> modify the displayed <code><a href="graphics.html#topic+legend">legend</a></code> e.g. <code>legend.cex=.9</code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>cum.</code> </td><td style="text-align: left;"> modify the Cumulative Distribution plot
(arguments for <code><a href="stats.html#topic+plot.stepfun">plot.stepfun</a></code>)
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qq.</code> </td><td style="text-align: left;"> modify the QQ plot, e.g. <code>qq.pch=1</code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qqline</code> </td><td style="text-align: left;"> modify the <code><a href="stats.html#topic+qqline">qqline</a></code> in the QQ plot, e.g. <code>qqline.col=0</code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>label.</code> </td><td style="text-align: left;"> modify the point labels, e.g. <code>label.cex=.9</code> or <code>label.font=2</code>
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>cook.</code> </td><td style="text-align: left;"> modify the Cook's Distance annotations.
This affects only the leverage plot
(<code>versus=3</code>) for <code>lm</code> models with <code>standardize=TRUE</code>.
e.g. <code>cook.levels=c(.5, .8, 1)</code> or <code>cook.col=2</code>.
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>caption.</code> </td><td style="text-align: left;"> modify the overall caption (see the <code>caption</code> argument)
e.g. <code>caption.col=2</code>.
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>par.</code> </td><td style="text-align: left;"> arguments for <code><a href="graphics.html#topic+par">par</a></code>
(only necessary if a <code>par</code> argument name clashes
with a <code>plotres</code> argument)
</td>
</tr>

</table>

<p>The <code>cex</code> argument is relative, so
specifying <code>cex=1</code> is the same as not specifying <code>cex</code>.
</p>
<p>For backwards compatibility, some dot
arguments are supported but not explicitly documented.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the <code>which=1</code> plot was plotted, the return value of that
plot (model dependent).
</p>
<p>Else if the <code>which=3</code> plot was plotted, return <code>list(x,y)</code>
where <code>x</code> and <code>y</code> are the coordinates of the points in that plot
(but without jittering even if the <code>jitter</code> argument was used).
</p>
<p>Else return <code>NULL</code>.
</p>


<h3>Note</h3>

<p>This function is designed primarily for displaying standard
<code>response - fitted</code> residuals for models
with a single continuous response,
although it will work for a few other models.
</p>
<p>In general this function won't work on models that don't save the call
and data with the model in a standard way.
It uses the same underlying mechanism to access the model data as
<code><a href="#topic+plotmo">plotmo</a></code>.
For further discussion please see &ldquo;<em>Accessing the model
data</em>&rdquo; in the <a href="../doc/plotmo-notes.pdf">plotmo vignette</a>
(also available <a href="http://www.milbo.org/doc/plotmo-notes.pdf">here</a>).
Package authors may want to look at
<a href="../doc/modguide.pdf">Guidelines for S3 Regression Models</a>
(also available <a href="http://www.milbo.org/doc/modguide.pdf">here</a>).
</p>


<h3>See Also</h3>

<p>Please see the <a href="../doc/plotres-notes.pdf">plotres vignette</a>
(also available <a href="http://www.milbo.org/doc/plotres-notes.pdf">here</a>).
</p>
<p><code><a href="stats.html#topic+plot.lm">plot.lm</a></code>
</p>
<p><code><a href="earth.html#topic+plot.earth">plot.earth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># we use lm in this example, but plotres is more useful for models
# that don't have a function like plot.lm for plotting residuals

lm.model &lt;- lm(Volume~., data=trees)

plotres(lm.model)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
