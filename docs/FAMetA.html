<!DOCTYPE html><html lang="en"><head><title>Help for package FAMetA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FAMetA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addFA'><p>Add missing FA annotations</p></a></li>
<li><a href='#annotateFA'><p>FA annotation</p></a></li>
<li><a href='#blankSubstraction'><p>substract blank samples.</p></a></li>
<li><a href='#changeFArt'><p>Modify rt peak limits of annotated FAs</p></a></li>
<li><a href='#checkparameters'><p>check S and E steps based on isotopologue distribution.</p></a></li>
<li><a href='#combAcetate'><p>acetate combinations for M+0, M+1 and M+2.</p></a></li>
<li><a href='#correctNatAb13C'><p>correct data for natural abundance of 13C using accucor algorithm.</p></a></li>
<li><a href='#curateFAannotations'><p>Modify FA annotations</p></a></li>
<li><a href='#dataCorrection'><p>Data correction for natural abundance of 13C and data normalization using</p>
internal standards followed by blank substraction.</a></li>
<li><a href='#dataElong'><p>data list for elongation analysis.</p></a></li>
<li><a href='#dataSynth'><p>data list for synthesis analysis.</p></a></li>
<li><a href='#desaturationAnalysis'><p>Desaturation analysis of fatty acids.</p></a></li>
<li><a href='#desaturationsdb'>
<p>Desaturation reactions database.</p></a></li>
<li><a href='#elongationAnalysis'><p>Elongation analysis of fatty acids longer than 16 carbons.</p></a></li>
<li><a href='#elongationqmult'><p>calculate FA isotope distribution for elongated FAs using the quasi</p>
multinomial distribution.</a></li>
<li><a href='#estimatePars'><p>Fit FA isotope distribution with non-linear regression using multiple</p>
starting points to find the best fit.</a></li>
<li><a href='#estimateSynthesis'><p>estimate synthesis parameters.</p></a></li>
<li><a href='#examplefadata'>
<p>Example fadata list.</p></a></li>
<li><a href='#externalNormalization'><p>External normalization using additional measures (i.e. protein levels).</p></a></li>
<li><a href='#fattyacidsdb'>
<p>Fatty Acids database.</p></a></li>
<li><a href='#fitSSE'><p>Fit FA isotope distribution with non-linear regression and calculate the sum</p>
of squared estimate of errors.</a></li>
<li><a href='#getFormula'><p>Get formula and neutral mass for annotated compounds</p></a></li>
<li><a href='#getResultsTable'><p>Obtain the final results table from synthesis, elongation and desaturation</p>
analysis.</a></li>
<li><a href='#getSummaryTable'><p>Obtain a summary results table.</p></a></li>
<li><a href='#gridElong'><p>generate starting points grid for elongation analysis.</p></a></li>
<li><a href='#gridSynth'><p>generate starting points grid for  synthesis analysis.</p></a></li>
<li><a href='#heatmapResults'><p>Plot results on a heatmap.</p></a></li>
<li><a href='#msbatch2fadata'><p>Extract FA data from an annotated msbatch.</p></a></li>
<li><a href='#mzMatch'><p>mz match withing a vector of mz values</p></a></li>
<li><a href='#normalizeIS'><p>Data normalization using internal stardards.</p></a></li>
<li><a href='#parameters'>
<p>Parameters for FA metabolic analysis.</p></a></li>
<li><a href='#plotDistributions'><p>Plot observed and predicted isotope distributions.</p></a></li>
<li><a href='#plotFA'><p>Plot FA EICs</p></a></li>
<li><a href='#plotResults'><p>Plot observed and predicted isotope distributions from the results obtained.</p></a></li>
<li><a href='#readfadatafile'><p>read FA data from a csv file.</p></a></li>
<li><a href='#removeFA'><p>Remove incorrect FA annotations</p></a></li>
<li><a href='#runElongationAnalysis'><p>run the elongation analysis.</p></a></li>
<li><a href='#runSynthesisAnalysis'><p>run synthesis analysis.</p></a></li>
<li><a href='#searchFAisotopes'><p>Search FA isotopes</p></a></li>
<li><a href='#searchIS'><p>Search internal stardards.</p></a></li>
<li><a href='#ssexamplefadata'>
<p>Toy example fadata list.</p></a></li>
<li><a href='#summarizeResults'><p>Obtain result tables and heatmaps that help interpreting your results.</p></a></li>
<li><a href='#synthesisAnalysis'><p>De novo synthesis analysis of fatty acids until 16 carbons.</p></a></li>
<li><a href='#synthesisqmult'><p>calculate FA isotope distribution for newly synthesized FAs using the quasi</p>
multinomial distribution.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fatty Acid Metabolic Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Fatty acid metabolic analysis aimed to the estimation of FA import (I), de novo synthesis (S), fractional contribution of the 13C-tracers (D0, D1, D2), elongation (E) and desaturation (Des) based on mass isotopologue data.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), LipidMS (&ge; 3.0.4), rmarkdown, knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>accucor, scales, gtools, minpack.lm, tidyr, plyr, gplots,
grDevices</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-19 12:14:33 UTC; 73581298C</td>
</tr>
<tr>
<td>Author:</td>
<td>Maribel Alcoriza-Balaguer [aut, cre],
  Juan Carlos Garcia-Cañaveras [ctb],
  Agustin Lahoz [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maribel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-20 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='addFA'>Add missing FA annotations</h2><span id='topic+addFA'></span>

<h3>Description</h3>

<p>Add missing FA annotations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addFA(msbatch, dmz = 5, faid, adducts = "M-H", mz, from, to)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addFA_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="addFA_+3A_dmz">dmz</code></td>
<td>
<p>mz tolerance in ppm.</p>
</td></tr>
<tr><td><code id="addFA_+3A_faid">faid</code></td>
<td>
<p>character vector specifying FA names (i.e. &quot;FA(16:1)&quot;).</p>
</td></tr>
<tr><td><code id="addFA_+3A_adducts">adducts</code></td>
<td>
<p>character vector specifying adducts.</p>
</td></tr>
<tr><td><code id="addFA_+3A_mz">mz</code></td>
<td>
<p>numeric vector specifying FA mz.</p>
</td></tr>
<tr><td><code id="addFA_+3A_from">from</code></td>
<td>
<p>numeric vector specifying the peak start.</p>
</td></tr>
<tr><td><code id="addFA_+3A_to">to</code></td>
<td>
<p>numeric vector specifying the peak end.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>annotated msbatch.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='annotateFA'>FA annotation</h2><span id='topic+annotateFA'></span>

<h3>Description</h3>

<p>FA annotation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annotateFA(msbatch, dmz = 5, rt, adducts = c("M-H"), db)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="annotateFA_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch obtained from LipidMS package.</p>
</td></tr>
<tr><td><code id="annotateFA_+3A_dmz">dmz</code></td>
<td>
<p>mz tolerance in ppm.</p>
</td></tr>
<tr><td><code id="annotateFA_+3A_rt">rt</code></td>
<td>
<p>Optional. Numeric vector of length two specifying the rt range to
search for FA.</p>
</td></tr>
<tr><td><code id="annotateFA_+3A_adducts">adducts</code></td>
<td>
<p>character vector specifying adducts.</p>
</td></tr>
<tr><td><code id="annotateFA_+3A_db">db</code></td>
<td>
<p>FA database. Data frame with three columns: formula, total (number
of carbons and double bounds, i.e. &quot;18:1&quot;) and Mass.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>annotated msbatch.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- annotateFA(msbatch, dmz = 5)

## End(Not run)

</code></pre>

<hr>
<h2 id='blankSubstraction'>substract blank samples.</h2><span id='topic+blankSubstraction'></span>

<h3>Description</h3>

<p>substract blank samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blankSubstraction(fadata, blankgroup = "blank", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="blankSubstraction_+3A_fadata">fadata</code></td>
<td>
<p>fadata.</p>
</td></tr>
<tr><td><code id="blankSubstraction_+3A_blankgroup">blankgroup</code></td>
<td>
<p>name used to define blank samples group.</p>
</td></tr>
<tr><td><code id="blankSubstraction_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>blank substracted fadata.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='changeFArt'>Modify rt peak limits of annotated FAs</h2><span id='topic+changeFArt'></span>

<h3>Description</h3>

<p>Modify rt peak limits of annotated FAs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changeFArt(msbatch, id, from, to)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="changeFArt_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="changeFArt_+3A_id">id</code></td>
<td>
<p>integer vector specifying FA ids to be modified.</p>
</td></tr>
<tr><td><code id="changeFArt_+3A_from">from</code></td>
<td>
<p>numeric vector specifying the peak start.</p>
</td></tr>
<tr><td><code id="changeFArt_+3A_to">to</code></td>
<td>
<p>numeric vector specifying the peak end.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>annotated msbatch.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='checkparameters'>check S and E steps based on isotopologue distribution.</h2><span id='topic+checkparameters'></span>

<h3>Description</h3>

<p>check S and E steps based on isotopologue distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkparameters(resp, M, n, SE, imported, D2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkparameters_+3A_resp">resp</code></td>
<td>
<p>isotopologue distribution</p>
</td></tr>
<tr><td><code id="checkparameters_+3A_m">M</code></td>
<td>
<p>total number of carbons of the fatty acid.</p>
</td></tr>
<tr><td><code id="checkparameters_+3A_n">n</code></td>
<td>
<p>maximum number of elongation steps.</p>
</td></tr>
<tr><td><code id="checkparameters_+3A_se">SE</code></td>
<td>
<p>list with S and E parameters. NA indicates they must be estimated 
while 0 indicates it does not occur.</p>
</td></tr>
<tr><td><code id="checkparameters_+3A_imported">imported</code></td>
<td>
<p>logical. TRUE if S16 is predefined as 0 (n3 or n6 series).</p>
</td></tr>
<tr><td><code id="checkparameters_+3A_d2">D2</code></td>
<td>
<p>numeric between 0 and 1. Only if D2 &gt;= 0.4 parameters are checked 
based on distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SE list corrected.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='combAcetate'>acetate combinations for M+0, M+1 and M+2.</h2><span id='topic+combAcetate'></span>

<h3>Description</h3>

<p>acetate combinations for M+0, M+1 and M+2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combAcetate(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combAcetate_+3A_m">M</code></td>
<td>
<p>total number of carbons for the FA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>acetate combination for M carbon atoms.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='correctNatAb13C'>correct data for natural abundance of 13C using accucor algorithm.</h2><span id='topic+correctNatAb13C'></span>

<h3>Description</h3>

<p>correct data for natural abundance of 13C using accucor algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correctNatAb13C(fadata, resolution = 140000, purity = 0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correctNatAb13C_+3A_fadata">fadata</code></td>
<td>
<p>fadata.</p>
</td></tr>
<tr><td><code id="correctNatAb13C_+3A_resolution">resolution</code></td>
<td>
<p>resolution of the mass spectrometer.</p>
</td></tr>
<tr><td><code id="correctNatAb13C_+3A_purity">purity</code></td>
<td>
<p>purity of the tracer employed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>corrected fadata.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Su X, Lu W, Rabinowitz J (2017). “Metabolite Spectral Accuracy on 
Orbitraps.” Analytical Chemistry, 89(11), 5940-5948, PMID: 28471646, R package 
version 0.2.4 (2021), &lt;https://doi.org/10.1021/acs.analchem.7b00396&gt;.
</p>

<hr>
<h2 id='curateFAannotations'>Modify FA annotations</h2><span id='topic+curateFAannotations'></span>

<h3>Description</h3>

<p>after FA annotation using <a href="#topic+annotateFA">annotateFA</a>, the resulting
data frame can be modified to remove rows with unwanted annotation, iniRT and
endRT can be changed to redefine peak limits and extra rows may be written to
add new annotations. FAid should also be modified to contain unique names
such as &quot;FA(16:1)n7&quot; and &quot;FA(16:1)n10&quot; instead of generic &quot;FA(16:1)&quot;. For
unknown fatty acids use FA(16:1)nx (nx, ny and nz are availables for all FA).
</p>
<p>Internal standards can also be added to normalize data later. Leave ID and
Adducts columns empty, write &quot;IS&quot; at the FAid column and add mz, RT, iniRT
and endRT information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curateFAannotations(msbatch, faid, dmz = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="curateFAannotations_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="curateFAannotations_+3A_faid">faid</code></td>
<td>
<p>data frame with 7 columns (ID, FAid, Adducts, mz, RT, iniRT and
endRT) containing curated FAs.</p>
</td></tr>
<tr><td><code id="curateFAannotations_+3A_dmz">dmz</code></td>
<td>
<p>mz tolerance in ppm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Modify FA annotations
</p>


<h3>Value</h3>

<p>annotated msbatch.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- annotateFA(msbatch, dmz = 5)

plots &lt;- plotFA(msbatch, dmz = 10)

pdf("FAs.pdf")
for (p in 1:length(plots)){
  print(plots[[p]])
}
dev.off()

write.csv(msbatch$fas, file="faid.csv", row.names=FALSE)

faid &lt;- read.csv("faid_curated.csv", sep=",", dec=".")

msbatch &lt;- curateFAannotations(msbatch, faid)

## End(Not run)

</code></pre>

<hr>
<h2 id='dataCorrection'>Data correction for natural abundance of 13C and data normalization using
internal standards followed by blank substraction.</h2><span id='topic+dataCorrection'></span>

<h3>Description</h3>

<p>Data correction for natural abundance of 13C and data normalization using
internal standards followed by blank substraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataCorrection(
  fadata,
  correct13C = TRUE,
  blankgroup = "blank",
  externalnormalization = c(),
  resolution = 140000,
  purity13C = 0.99,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dataCorrection_+3A_fadata">fadata</code></td>
<td>
<p>fadata list.</p>
</td></tr>
<tr><td><code id="dataCorrection_+3A_correct13c">correct13C</code></td>
<td>
<p>logical. If TRUE, data is corrected for natural abundance
of 13C. Set to FALSE if data has been already been corrected.</p>
</td></tr>
<tr><td><code id="dataCorrection_+3A_blankgroup">blankgroup</code></td>
<td>
<p>name used to define blank samples group.</p>
</td></tr>
<tr><td><code id="dataCorrection_+3A_externalnormalization">externalnormalization</code></td>
<td>
<p>column name at the metadata data frame of any
additional measure that must be used to normalize data (i.e. protein).</p>
</td></tr>
<tr><td><code id="dataCorrection_+3A_resolution">resolution</code></td>
<td>
<p>resolution of the mass spectrometer.</p>
</td></tr>
<tr><td><code id="dataCorrection_+3A_purity13c">purity13C</code></td>
<td>
<p>purity of the tracer employed.</p>
</td></tr>
<tr><td><code id="dataCorrection_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>corrected fadata.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Su X, Lu W, Rabinowitz J (2017). Metabolite Spectral Accuracy on 
Orbitraps. Analytical Chemistry, 89(11), 5940-5948, PMID: 28471646, R package 
version 0.2.4 (2021), &lt;https://doi.org/10.1021/acs.analchem.7b00396&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ssdata &lt;- dataCorrection(ssexamplefadata, blankgroup="Blank")


</code></pre>

<hr>
<h2 id='dataElong'>data list for elongation analysis.</h2><span id='topic+dataElong'></span>

<h3>Description</h3>

<p>data list for elongation analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataElong(S16, D1, D2, P, E1, E2, E3, E4, E5, M, vcomb16, mcombe)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dataElong_+3A_s16">S16</code></td>
<td>
<p>fraction of newly synthesized C16 FA. If different to NULL it is
included in the data list.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_d1">D1</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+1.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_d2">D2</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+2.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_p">P</code></td>
<td>
<p>overdispersion parameter.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_e1">E1</code></td>
<td>
<p>fraction of elongated C18 FA from C16. If different to NULL it is
included in the data list.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_e2">E2</code></td>
<td>
<p>fraction of elongated C20 FA from C18. If different to NULL it is
included in the data list.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_e3">E3</code></td>
<td>
<p>fraction of elongated C22 FA from C20. If different to NULL it is
included in the data list.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_e4">E4</code></td>
<td>
<p>fraction of elongated C24 FA from C22. If different to NULL it is
included in the data list.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_e5">E5</code></td>
<td>
<p>fraction of elongated C26 FA from C124. If different to NULL it is
included in the data list.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_m">M</code></td>
<td>
<p>total number of carbons for the FA.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_vcomb16">vcomb16</code></td>
<td>
<p>list of acetate combinations for C16 synthesis.</p>
</td></tr>
<tr><td><code id="dataElong_+3A_mcombe">mcombe</code></td>
<td>
<p>list of acetate combinations for each elongation step.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data list for elongation analysis.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='dataSynth'>data list for synthesis analysis.</h2><span id='topic+dataSynth'></span>

<h3>Description</h3>

<p>data list for synthesis analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataSynth(D1, D2, P, M, vcomb)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dataSynth_+3A_d1">D1</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+1. If different to NULL it is included in the data list.</p>
</td></tr>
<tr><td><code id="dataSynth_+3A_d2">D2</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+2. If different to NULL it is included in the data list.</p>
</td></tr>
<tr><td><code id="dataSynth_+3A_p">P</code></td>
<td>
<p>overdispersion parameter. If different to NULL it is included in the
data list.</p>
</td></tr>
<tr><td><code id="dataSynth_+3A_m">M</code></td>
<td>
<p>total number of carbons for the FA.</p>
</td></tr>
<tr><td><code id="dataSynth_+3A_vcomb">vcomb</code></td>
<td>
<p>list of acetate combinations for C16 synthesis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data list for synthesis analysis.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='desaturationAnalysis'>Desaturation analysis of fatty acids.</h2><span id='topic+desaturationAnalysis'></span>

<h3>Description</h3>

<p>Desaturation analysis of fatty acids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>desaturationAnalysis(
  fadata,
  desaturationsdb = FAMetA::desaturationsdb,
  SEThr = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="desaturationAnalysis_+3A_fadata">fadata</code></td>
<td>
<p>fadata containing synthesis and elongation results.</p>
</td></tr>
<tr><td><code id="desaturationAnalysis_+3A_desaturationsdb">desaturationsdb</code></td>
<td>
<p>desaturation reactions considered. It can be
modified to change them or to add new reactions.</p>
</td></tr>
<tr><td><code id="desaturationAnalysis_+3A_sethr">SEThr</code></td>
<td>
<p>minimum S or E value allowed to perform estimate desaturations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Once synthesis and elongation parameters have been estimated, these
results can be used to calculate the FA fraction that comes from desaturation
in unsaturated FA. For a given unsaturated FA (e.g. FA(18:1n9) we can
conceptually consider a one-step elongation-desaturation reaction (in this
example directly from FA(16:0) to FA(18:1n9) (E1') or a two-step elongation
followed by desaturation process (in this example FA(16:0) is elongated to
FA(18:0) (E1) and then desaturated to FA(18:1n9) (Des). Therefore,
desaturation can be estimated based on the fraction of E1', which is E1 from
FA(18:1)n9, and E1, which is E1 from FA(18:0). This same model can be used
for all known desaturation steps (see FAMetA::desaturationsdb) as long as
precursor and product FA isomers have been correctly and uniquely identified
and stationary state has been reached.
</p>


<h3>Value</h3>

<p>fadata list. Desaturation analysis results will be saved at the 
desaturation element of the fa list.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ssdata &lt;- dataCorrection(ssexamplefadata, blankgroup="Blank")
ssdata &lt;- synthesisAnalysis(ssdata, R2Thr = 0.95, maxiter = 1e3,
maxconvergence = 100, startpoints = 5)
ssdata &lt;- elongationAnalysis(ssdata, R2Thr = 0.95, maxiter = 1e4,
maxconvergence=100, startpoints = 5, D2Thr = 0.1)
ssdata &lt;- desaturationAnalysis(ssdata, SEThr = 0.05)


## Not run: 
fadata &lt;- dataCorrection(examplefadata, blankgroup = "Blank")
fadata &lt;- synthesisAnalysis(fadata, R2Thr = 0.95, maxiter = 1e3,
maxconvergence = 100, startpoints = 5)
fadata &lt;- elongationAnalysis(fadata, R2Thr = 0.95, maxiter = 1e4,
maxconvergence=100, startpoints = 5, D2Thr = 0.1)
fadata &lt;- desaturationAnalysis(fadata, SEThr = 0.05)

## End(Not run)

</code></pre>

<hr>
<h2 id='desaturationsdb'>
Desaturation reactions database.
</h2><span id='topic+desaturationsdb'></span>

<h3>Description</h3>

<p>Desaturation reactions database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("desaturationsdb")</code></pre>


<h3>Format</h3>

<p>A data frame with 13 observations on the following 3 variables.
</p>

<dl>
<dt><code>precursor</code></dt><dd><p>character vector.</p>
</dd>
<dt><code>product</code></dt><dd><p>character vector.</p>
</dd>
<dt><code>parameter</code></dt><dd><p>parameter required to estimate desaturation.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(desaturationsdb)
</code></pre>

<hr>
<h2 id='elongationAnalysis'>Elongation analysis of fatty acids longer than 16 carbons.</h2><span id='topic+elongationAnalysis'></span>

<h3>Description</h3>

<p>Elongation analysis of fatty acids longer than 16 carbons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elongationAnalysis(
  fadata,
  R2Thr = 0.98,
  maxiter = 10000,
  maxconvergence = 100,
  startpoints = 5,
  D2Thr = 0.1,
  parameters = FAMetA::parameters,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elongationAnalysis_+3A_fadata">fadata</code></td>
<td>
<p>fadata containing synthesis results.</p>
</td></tr>
<tr><td><code id="elongationAnalysis_+3A_r2thr">R2Thr</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the minimum R2
allowed for fits.</p>
</td></tr>
<tr><td><code id="elongationAnalysis_+3A_maxiter">maxiter</code></td>
<td>
<p>parameter passed to <a href="stats.html#topic+nls.control">nls.control</a>. Positive integer
specifying the maximum number of iterations allowed.</p>
</td></tr>
<tr><td><code id="elongationAnalysis_+3A_maxconvergence">maxconvergence</code></td>
<td>
<p>positive integer specifying the maximum number of
successes before choosing the winning model.</p>
</td></tr>
<tr><td><code id="elongationAnalysis_+3A_startpoints">startpoints</code></td>
<td>
<p>positive integer specifying the number of starting points
for each parameter to be estimated.</p>
</td></tr>
<tr><td><code id="elongationAnalysis_+3A_d2thr">D2Thr</code></td>
<td>
<p>minimum D2 value allowed to perform the elongation analysis.</p>
</td></tr>
<tr><td><code id="elongationAnalysis_+3A_parameters">parameters</code></td>
<td>
<p>parameters to be estimated for each fatty acid. It can be
modified to change them or to add new fatty acids (adding new rows).</p>
</td></tr>
<tr><td><code id="elongationAnalysis_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Main route of de novo synthesis plus elongation starts at 16 carbons
and then adds blocks of 2 carbons. Therefore, isotopologue distributions for
FA longer than 16 carbons will be modeled taking into account de novo
synthesis until FA(16:0), followed by single and independent elongation steps
(E1, E2 …, En). Parameters D0, D1 and D2 are imported from FA(16:0) or FA(14:0)
and thus, the only relevant parameters to be estimated in the elongation
analysis are Ei and I. For n6 and n3 series, elongation is expected from
FA(18:2)n6 and FA(18:3)n3 so that synthesis (S16:0) and first elongation step
(E1) are set to 0.
</p>


<h3>Value</h3>

<p>fadata list. Elongation analysis results will be saved at the 
elongation element of the fa list.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ssdata &lt;- dataCorrection(ssexamplefadata, blankgroup="Blank")
ssdata &lt;- synthesisAnalysis(ssdata, R2Thr = 0.95, maxiter = 1e3,
maxconvergence = 100, startpoints = 5)
ssdata &lt;- elongationAnalysis(ssdata, R2Thr = 0.95, maxiter = 1e4,
maxconvergence=100, startpoints = 5, D2Thr = 0.1)


## Not run: 
fadata &lt;- dataCorrection(examplefadata, blankgroup = "Blank")
fadata &lt;- synthesisAnalysis(fadata, R2Thr = 0.95, maxiter = 1e3,
maxconvergence = 100, startpoints = 5)
fadata &lt;- elongationAnalysis(fadata, R2Thr = 0.95, maxiter = 1e4,
maxconvergence=100, startpoints = 5, D2Thr = 0.1)

## End(Not run)

</code></pre>

<hr>
<h2 id='elongationqmult'>calculate FA isotope distribution for elongated FAs using the quasi
multinomial distribution.</h2><span id='topic+elongationqmult'></span>

<h3>Description</h3>

<p>calculate FA isotope distribution for elongated FAs using the quasi
multinomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elongationqmult(S16, D1, D2, P, E1, E2, E3, E4, E5, M, vcomb16, mcombe)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elongationqmult_+3A_s16">S16</code></td>
<td>
<p>fraction of newly synthesized palmitate.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_d1">D1</code></td>
<td>
<p>tracer contribution to M+1 acetate pool.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_d2">D2</code></td>
<td>
<p>tracer contribution to M+2 acetate pool.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_p">P</code></td>
<td>
<p>overdispersion parameter. If different to 0, quasi-multinomial
distribution is obtained, while if set to 0, it is simplified to a multinomial
distribution.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_e1">E1</code></td>
<td>
<p>fraction of elongated C18 FA from C16.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_e2">E2</code></td>
<td>
<p>fraction of elongated C20 FA from C18.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_e3">E3</code></td>
<td>
<p>fraction of elongated C22 FA from C20.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_e4">E4</code></td>
<td>
<p>fraction of elongated C24 FA from C22.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_e5">E5</code></td>
<td>
<p>fraction of elongated C26 FA from C24.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_m">M</code></td>
<td>
<p>total number of carbons for the FA.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_vcomb16">vcomb16</code></td>
<td>
<p>list of acetate combinations for C16 synthesis obtained with
combAcetate(16) function.</p>
</td></tr>
<tr><td><code id="elongationqmult_+3A_mcombe">mcombe</code></td>
<td>
<p>list of acetate combinations for each elongation step obtained
with combAcetate(2) function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>FA isotope distribution.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='estimatePars'>Fit FA isotope distribution with non-linear regression using multiple
starting points to find the best fit.</h2><span id='topic+estimatePars'></span>

<h3>Description</h3>

<p>Fit FA isotope distribution with non-linear regression using multiple
starting points to find the best fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimatePars(
  formula,
  gridStart,
  datanls,
  maxiter,
  maxconvergence,
  limitPhi = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimatePars_+3A_formula">formula</code></td>
<td>
<p>formula.</p>
</td></tr>
<tr><td><code id="estimatePars_+3A_gridstart">gridStart</code></td>
<td>
<p>starting points grid.</p>
</td></tr>
<tr><td><code id="estimatePars_+3A_datanls">datanls</code></td>
<td>
<p>data list.</p>
</td></tr>
<tr><td><code id="estimatePars_+3A_maxiter">maxiter</code></td>
<td>
<p>parameter passed to <a href="stats.html#topic+nls.control">nls.control</a>. Positive integer
specifying the maximum number of iterations allowed.</p>
</td></tr>
<tr><td><code id="estimatePars_+3A_maxconvergence">maxconvergence</code></td>
<td>
<p>positive integer specifying the maximum number of
successes before choosing the winning model.</p>
</td></tr>
<tr><td><code id="estimatePars_+3A_limitphi">limitPhi</code></td>
<td>
<p>upper bound for overdispersion parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Daniel Padfield and Granville Matheson (2020). nls.multstart: Robust Non-Linear Regression using AIC Scores. R package version 1.2.0. &lt;https://CRAN.R-project.org/package=nls.multstart&gt;
</p>

<hr>
<h2 id='estimateSynthesis'>estimate synthesis parameters.</h2><span id='topic+estimateSynthesis'></span>

<h3>Description</h3>

<p>estimate synthesis parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateSynthesis(
  fa,
  M,
  R2Thr = 0.9,
  maxiter = 1000,
  maxconvergence = 100,
  D1 = NA,
  D2 = NA,
  P = NA,
  startpoints = 5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimateSynthesis_+3A_fa">fa</code></td>
<td>
<p>data frame with isotope intensities for a FA. First two columns
correspond to Compound and Label information.</p>
</td></tr>
<tr><td><code id="estimateSynthesis_+3A_m">M</code></td>
<td>
<p>total number of carbons for the FA.</p>
</td></tr>
<tr><td><code id="estimateSynthesis_+3A_r2thr">R2Thr</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the minimum R2
allowed for fits.</p>
</td></tr>
<tr><td><code id="estimateSynthesis_+3A_maxiter">maxiter</code></td>
<td>
<p>parameter passed to <a href="stats.html#topic+nls.control">nls.control</a>. Positive integer
specifying the maximum number of iterations allowed.</p>
</td></tr>
<tr><td><code id="estimateSynthesis_+3A_maxconvergence">maxconvergence</code></td>
<td>
<p>positive integer specifying the maximum number of
successes before choosing the winning model.</p>
</td></tr>
<tr><td><code id="estimateSynthesis_+3A_d1">D1</code></td>
<td>
<p>positive numeric vector with values between 0 and 1 specifying the
contribution of acetate M+1. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="estimateSynthesis_+3A_d2">D2</code></td>
<td>
<p>positive numeric vector with values between 0 and 1 specifying the
contribution of acetate M+2. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="estimateSynthesis_+3A_p">P</code></td>
<td>
<p>overdispersion parameter. If NA it is estimated (quasi-multinomial
distribution). If set to 0, no overdispersion is assumed (multinomial
distribution).</p>
</td></tr>
<tr><td><code id="estimateSynthesis_+3A_startpoints">startpoints</code></td>
<td>
<p>positive integer specifying the number of starting points
for each parameter to be estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>De novo-synthesis and elongation analysis results.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='examplefadata'>
Example fadata list.
</h2><span id='topic+examplefadata'></span>

<h3>Description</h3>

<p>Example fadata list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("examplefadata")</code></pre>


<h3>Format</h3>

<p>A list with 4 elements.
</p>

<dl>
<dt><code>metadata</code></dt><dd><p>data frame with metadata information for samples.</p>
</dd>
<dt><code>fattyacids</code></dt><dd><p>data frame with compound name and label for each isotopologue (intensities df).</p>
</dd>
<dt><code>IS</code></dt><dd><p>data frame with IS intensities for each sample.</p>
</dd>
<dt><code>intensities</code></dt><dd><p>data frame with isotopologue intensities for each sample.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(examplefadata)
</code></pre>

<hr>
<h2 id='externalNormalization'>External normalization using additional measures (i.e. protein levels).</h2><span id='topic+externalNormalization'></span>

<h3>Description</h3>

<p>External normalization using additional measures (i.e. protein levels).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>externalNormalization(fadata, externalnormalization, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="externalNormalization_+3A_fadata">fadata</code></td>
<td>
<p>fadata list.</p>
</td></tr>
<tr><td><code id="externalNormalization_+3A_externalnormalization">externalnormalization</code></td>
<td>
<p>column names of metadata data frame used to
define external measures.</p>
</td></tr>
<tr><td><code id="externalNormalization_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>normalised fadata by external measures.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='fattyacidsdb'>
Fatty Acids database.
</h2><span id='topic+fattyacidsdb'></span>

<h3>Description</h3>

<p>Fatty Acids database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("fattyacidsdb")</code></pre>


<h3>Format</h3>

<p>A data frame with 35 observations on the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>a character vector.</p>
</dd>
<dt><code>total</code></dt><dd><p>a character vector. Number of carbons and double bounds.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>a numeric vector.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(fattyacidsdb)
</code></pre>

<hr>
<h2 id='fitSSE'>Fit FA isotope distribution with non-linear regression and calculate the sum
of squared estimate of errors.</h2><span id='topic+fitSSE'></span>

<h3>Description</h3>

<p>Fit FA isotope distribution with non-linear regression and calculate the sum
of squared estimate of errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitSSE(formula, startpars, datanls, control, limitPhi = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitSSE_+3A_formula">formula</code></td>
<td>
<p>formula.</p>
</td></tr>
<tr><td><code id="fitSSE_+3A_startpars">startpars</code></td>
<td>
<p>starting points for parameters to estimate.</p>
</td></tr>
<tr><td><code id="fitSSE_+3A_datanls">datanls</code></td>
<td>
<p>data list.</p>
</td></tr>
<tr><td><code id="fitSSE_+3A_control">control</code></td>
<td>
<p>nls control.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sum of squared estimate errors.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Daniel Padfield and Granville Matheson (2020). nls.multstart: Robust Non-Linear Regression using AIC Scores. R package version 1.2.0. &lt;https://CRAN.R-project.org/package=nls.multstart&gt;
</p>

<hr>
<h2 id='getFormula'>Get formula and neutral mass for annotated compounds</h2><span id='topic+getFormula'></span>

<h3>Description</h3>

<p>Get formula and neutral mass for annotated compounds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFormula(df, dbs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getFormula_+3A_df">df</code></td>
<td>
<p>data frame with the input results</p>
</td></tr>
<tr><td><code id="getFormula_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="LipidMS.html#topic+createLipidDB">createLipidDB</a>
and <a href="LipidMS.html#topic+assignDB">assignDB</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>References</h3>

<p>M Isabel Alcoriza-Balaguer (2021). LipidMS: Lipid Annotation for
LC-MS/MS DDA or DIA Data. R package version 3.0.1.
&lt;https://CRAN.R-project.org/package=LipidMS&gt;
</p>

<hr>
<h2 id='getResultsTable'>Obtain the final results table from synthesis, elongation and desaturation
analysis.</h2><span id='topic+getResultsTable'></span>

<h3>Description</h3>

<p>Obtain the final results table from synthesis, elongation and desaturation
analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getResultsTable(fadata, parameters = FAMetA::parameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getResultsTable_+3A_fadata">fadata</code></td>
<td>
<p>fadata list.</p>
</td></tr>
<tr><td><code id="getResultsTable_+3A_parameters">parameters</code></td>
<td>
<p>parameters to be estimated for each fatty acid. It can be
modified to change them or to add new fatty acids.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results data frame.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='getSummaryTable'>Obtain a summary results table.</h2><span id='topic+getSummaryTable'></span>

<h3>Description</h3>

<p>Obtain a summary results table containing means and standard deviation for
each relevant parameter for each fatty acids by sample groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSummaryTable(fadata, resultstable, parameters = FAMetA::parameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSummaryTable_+3A_fadata">fadata</code></td>
<td>
<p>fadata list.</p>
</td></tr>
<tr><td><code id="getSummaryTable_+3A_resultstable">resultstable</code></td>
<td>
<p>results data frame obtained with <a href="#topic+getResultsTable">getResultsTable</a>.</p>
</td></tr>
<tr><td><code id="getSummaryTable_+3A_parameters">parameters</code></td>
<td>
<p>parameters to be estimated for each fatty acid. It can be
modified to change them or to add new fatty acids.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summary data frame.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='gridElong'>generate starting points grid for elongation analysis.</h2><span id='topic+gridElong'></span>

<h3>Description</h3>

<p>generate starting points grid for elongation analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gridElong(S16 = NA, E1 = NA, E2 = NA, E3 = NA, E4 = NA, E5 = NA, startpoints)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gridElong_+3A_s16">S16</code></td>
<td>
<p>fraction of newly synthesized C16 FA. If NA it is included in
the starting points grid.</p>
</td></tr>
<tr><td><code id="gridElong_+3A_e1">E1</code></td>
<td>
<p>fraction of elongated C18 FA from C16. If NA it is included in
the starting points grid.</p>
</td></tr>
<tr><td><code id="gridElong_+3A_e2">E2</code></td>
<td>
<p>fraction of elongated C20 FA from C18. If NA it is included in
the starting points grid.</p>
</td></tr>
<tr><td><code id="gridElong_+3A_e3">E3</code></td>
<td>
<p>fraction of elongated C22 FA from C20. If NA it is included in
the starting points grid.</p>
</td></tr>
<tr><td><code id="gridElong_+3A_e4">E4</code></td>
<td>
<p>fraction of elongated C24 FA from C22. If NA it is included in
the starting points grid.</p>
</td></tr>
<tr><td><code id="gridElong_+3A_e5">E5</code></td>
<td>
<p>fraction of elongated C26 FA from C124. If NA it is included in
the starting points grid.</p>
</td></tr>
<tr><td><code id="gridElong_+3A_startpoints">startpoints</code></td>
<td>
<p>positive integer specifying the number of starting points
for each parameter to be estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Starting points grid for elongation analysis.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='gridSynth'>generate starting points grid for  synthesis analysis.</h2><span id='topic+gridSynth'></span>

<h3>Description</h3>

<p>generate starting points grid for synthesis analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gridSynth(D1 = NA, D2 = NA, P = NA, S = NA, M, startpoints)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gridSynth_+3A_d1">D1</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+1. If NA it is included in the starting points grid.</p>
</td></tr>
<tr><td><code id="gridSynth_+3A_d2">D2</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+2. If NA it is included in the starting points grid.</p>
</td></tr>
<tr><td><code id="gridSynth_+3A_p">P</code></td>
<td>
<p>overdispersion parameter. If NA, it is included in the starting
points grid.</p>
</td></tr>
<tr><td><code id="gridSynth_+3A_s">S</code></td>
<td>
<p>fraction of newly synthesized C16 FA. If NA it is included in the
starting points grid.</p>
</td></tr>
<tr><td><code id="gridSynth_+3A_m">M</code></td>
<td>
<p>total number of carbons for the FA.</p>
</td></tr>
<tr><td><code id="gridSynth_+3A_startpoints">startpoints</code></td>
<td>
<p>positive integer specifying the number of starting points
for each parameter to be estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Starting points grid for synthesis analysis.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='heatmapResults'>Plot results on a heatmap.</h2><span id='topic+heatmapResults'></span>

<h3>Description</h3>

<p>Plot results on a heatmap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmapResults(toPlot, cols, scale = "none", breaks, nacolor = "grey")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="heatmapResults_+3A_toplot">toPlot</code></td>
<td>
<p>data frame with data to be plotted.</p>
</td></tr>
<tr><td><code id="heatmapResults_+3A_cols">cols</code></td>
<td>
<p>colors for the side bar (by group).</p>
</td></tr>
<tr><td><code id="heatmapResults_+3A_scale">scale</code></td>
<td>
<p>&quot;none&quot;, &quot;row&quot; or &quot;column&quot;.</p>
</td></tr>
<tr><td><code id="heatmapResults_+3A_breaks">breaks</code></td>
<td>
<p>numeric vector with breaks for colouring. Optional.</p>
</td></tr>
<tr><td><code id="heatmapResults_+3A_nacolor">nacolor</code></td>
<td>
<p>color for NA values. Grey by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>heatmap.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='msbatch2fadata'>Extract FA data from an annotated msbatch.</h2><span id='topic+msbatch2fadata'></span>

<h3>Description</h3>

<p>Extract FA data from an annotated msbatch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msbatch2fadata(msbatch, faid)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msbatch2fadata_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="msbatch2fadata_+3A_faid">faid</code></td>
<td>
<p>data frame with two columns (ID and Compound) specifying FA ids
and FA names. FA names must be unique and omega series must be indicated
(i.e. FA(20:4)n3, FA(24:1)n9, FA(16:0)). Unknown FA series can be named as nx,
ny, nz to differentiate between isomers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fadata.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='mzMatch'>mz match withing a vector of mz values</h2><span id='topic+mzMatch'></span>

<h3>Description</h3>

<p>This function searches marches between a given mz and a vector of mz values
with certain mass  tolerance and returns the index of the matched values. It
is used by identification functions to find candidates of each class of lipid
based on full MS information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mzMatch(mz, mzvector, ppm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mzMatch_+3A_mz">mz</code></td>
<td>
<p>mz value to be matched</p>
</td></tr>
<tr><td><code id="mzMatch_+3A_mzvector">mzvector</code></td>
<td>
<p>vector of mz values</p>
</td></tr>
<tr><td><code id="mzMatch_+3A_ppm">ppm</code></td>
<td>
<p>mass error tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector indicating the index of matched mz values and ppms for
each one of those matches (match1, ppm1, match2, ppm2, etc.)
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>References</h3>

<p>M Isabel Alcoriza-Balaguer (2021). LipidMS: Lipid Annotation for
LC-MS/MS DDA or DIA Data. R package version 3.0.1.
&lt;https://CRAN.R-project.org/package=LipidMS&gt;
</p>

<hr>
<h2 id='normalizeIS'>Data normalization using internal stardards.</h2><span id='topic+normalizeIS'></span>

<h3>Description</h3>

<p>Data normalization using internal stardards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizeIS(fadata, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalizeIS_+3A_fadata">fadata</code></td>
<td>
<p>fadata list.</p>
</td></tr>
<tr><td><code id="normalizeIS_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>normalised fadata by IS.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='parameters'>
Parameters for FA metabolic analysis.
</h2><span id='topic+parameters'></span>

<h3>Description</h3>

<p>Parameters for FA metabolic analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("parameters")</code></pre>


<h3>Format</h3>

<p>A data frame with 167 observations on the following 8 variables.
</p>

<dl>
<dt><code>FattyAcid</code></dt><dd><p>a character vector.</p>
</dd>
<dt><code>M</code></dt><dd><p>integer vector. Number of carbons.</p>
</dd>
<dt><code>S16</code></dt><dd><p>De novo synthesis. If equal to 1 it is estimated.</p>
</dd>
<dt><code>E1</code></dt><dd><p>a numeric vector. If equal to 1 it is estimated.</p>
</dd>
<dt><code>E2</code></dt><dd><p>a numeric vector. If equal to 1 it is estimated.</p>
</dd>
<dt><code>E3</code></dt><dd><p>a numeric vector. If equal to 1 it is estimated.</p>
</dd>
<dt><code>E4</code></dt><dd><p>a numeric vector. If equal to 1 it is estimated.</p>
</dd>
<dt><code>E5</code></dt><dd><p>a numeric vector. If equal to 1 it is estimated.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(paramters)
</code></pre>

<hr>
<h2 id='plotDistributions'>Plot observed and predicted isotope distributions.</h2><span id='topic+plotDistributions'></span>

<h3>Description</h3>

<p>Plot observed and predicted isotope distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDistributions(results, groups, title = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotDistributions_+3A_results">results</code></td>
<td>
<p>results.</p>
</td></tr>
<tr><td><code id="plotDistributions_+3A_groups">groups</code></td>
<td>
<p>character vector specifying sample groups.</p>
</td></tr>
<tr><td><code id="plotDistributions_+3A_title">title</code></td>
<td>
<p>title.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='plotFA'>Plot FA EICs</h2><span id='topic+plotFA'></span>

<h3>Description</h3>

<p>Plot FA EICs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFA(msbatch, dmz, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotFA_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="plotFA_+3A_dmz">dmz</code></td>
<td>
<p>mz tolerance in ppm for EIC extraction.</p>
</td></tr>
<tr><td><code id="plotFA_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>annotated msbatch with saved plots.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- annotateFA(msbatch, dmz = 5)

plots &lt;- plotFA(msbatch, dmz = 10)

pdf("FAs.pdf")
for (p in 1:length(plots)){
  print(plots[[p]])
}
dev.off()

## End(Not run)

</code></pre>

<hr>
<h2 id='plotResults'>Plot observed and predicted isotope distributions from the results obtained.</h2><span id='topic+plotResults'></span>

<h3>Description</h3>

<p>Plot observed and predicted isotope distributions from the results obtained.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotResults(results, groups, fas)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotResults_+3A_results">results</code></td>
<td>
<p>results.</p>
</td></tr>
<tr><td><code id="plotResults_+3A_groups">groups</code></td>
<td>
<p>character vector specifying sample groups.</p>
</td></tr>
<tr><td><code id="plotResults_+3A_fas">fas</code></td>
<td>
<p>character vector specifying the FAs to be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='readfadatafile'>read FA data from a csv file.</h2><span id='topic+readfadatafile'></span>

<h3>Description</h3>

<p>First rows must contain metadata information such
as sample groups (row named sampletype) and any other extra information like
protein levels for external normalization. Then, the following row must
contain a Compound and Label columns followed by all sample names.
FA names must be unique and omega series must be indicated
(i.e. FA(20:4)n3, FA(24:1)n9, FA(16:0)). Unknown FA series can be named as nx,
ny, nz to differentiate between isomers. Labels must be specified with integer
numbers for 0 to maximum number of carbons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readfadatafile(file, sep = ",", dec = ".")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readfadatafile_+3A_file">file</code></td>
<td>
<p>csv file name.</p>
</td></tr>
<tr><td><code id="readfadatafile_+3A_sep">sep</code></td>
<td>
<p>column delimiter.</p>
</td></tr>
<tr><td><code id="readfadatafile_+3A_dec">dec</code></td>
<td>
<p>character used for decimal points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>read FA data from a csv file.
</p>


<h3>Value</h3>

<p>fadata.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fadata &lt;- readfadatafile("externafadata.csv", sep=",", dec=".")

## End(Not run)

</code></pre>

<hr>
<h2 id='removeFA'>Remove incorrect FA annotations</h2><span id='topic+removeFA'></span>

<h3>Description</h3>

<p>Remove incorrect FA annotations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeFA(msbatch, ids)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeFA_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="removeFA_+3A_ids">ids</code></td>
<td>
<p>integer vector specifying FA ids to be removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>annotated msbatch.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='runElongationAnalysis'>run the elongation analysis.</h2><span id='topic+runElongationAnalysis'></span>

<h3>Description</h3>

<p>run the elongation analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runElongationAnalysis(
  fa,
  M,
  D1,
  D2,
  P,
  S16,
  E1,
  E2,
  E3,
  E4,
  E5,
  R2Thr = 0.9,
  maxiter = 10000,
  maxconvergence = 100,
  startpoints = 5,
  D2Thr = D2Thr
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runElongationAnalysis_+3A_fa">fa</code></td>
<td>
<p>data frame with isotope intensities for a FA. First two columns
correspond to Compound and Label information.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_m">M</code></td>
<td>
<p>total number of carbons for the FA.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_d1">D1</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+1. Estimated with <a href="#topic+synthesisAnalysis">synthesisAnalysis</a>.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_d2">D2</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+2. Estimated with <a href="#topic+synthesisAnalysis">synthesisAnalysis</a>.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_p">P</code></td>
<td>
<p>overdispersion parameter. Estimated with <a href="#topic+synthesisAnalysis">synthesisAnalysis</a>.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_s16">S16</code></td>
<td>
<p>fraction of newly synthesized C16 FA. If NA it is estimated.
It is set to 0 for n3 and n6 FA series.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_e1">E1</code></td>
<td>
<p>fraction of elongated C18 FA from C16. If NA it is estimated.
It is set to 0 for n3 and n6 FA series.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_e2">E2</code></td>
<td>
<p>fraction of elongated C20 FA from C18. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_e3">E3</code></td>
<td>
<p>fraction of elongated C22 FA from C20. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_e4">E4</code></td>
<td>
<p>fraction of elongated C24 FA from C22. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_e5">E5</code></td>
<td>
<p>fraction of elongated C26 FA from C24. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_r2thr">R2Thr</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the minimum R2
allowed for fits.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_maxiter">maxiter</code></td>
<td>
<p>parameter passed to <a href="stats.html#topic+nls.control">nls.control</a>. Positive integer
specifying the maximum number of iterations allowed.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_maxconvergence">maxconvergence</code></td>
<td>
<p>positive integer specifying the maximum number of
successes before choosing the winning model.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_startpoints">startpoints</code></td>
<td>
<p>positive integer specifying the number of starting points
for each parameter to be estimated.</p>
</td></tr>
<tr><td><code id="runElongationAnalysis_+3A_d2thr">D2Thr</code></td>
<td>
<p>minimum D2 value allowed to perform the elongation analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Elongation and importation analysis results.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='runSynthesisAnalysis'>run synthesis analysis.</h2><span id='topic+runSynthesisAnalysis'></span>

<h3>Description</h3>

<p>run synthesis analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runSynthesisAnalysis(
  fadata,
  toDo,
  R2Thr = R2Thr,
  maxiter = maxiter,
  maxconvergence = maxconvergence,
  D1 = D1,
  D2 = D2,
  P = P,
  startpoints = startpoints,
  parameters = FAMetA::parameters,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runSynthesisAnalysis_+3A_fadata">fadata</code></td>
<td>
<p>fadata containing synthesis results.</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_todo">toDo</code></td>
<td>
<p>fatty acids to analyse.</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_r2thr">R2Thr</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the minimum R2
allowed for fits.</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_maxiter">maxiter</code></td>
<td>
<p>parameter passed to <a href="stats.html#topic+nls.control">nls.control</a>. Positive integer
specifying the maximum number of iterations allowed.</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_maxconvergence">maxconvergence</code></td>
<td>
<p>positive integer specifying the maximum number of
successes before choosing the winning model.</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_d1">D1</code></td>
<td>
<p>positive numeric vector with values between 0 and 1 specifying the
contribution of acetate M+1. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_d2">D2</code></td>
<td>
<p>positive numeric vector with values between 0 and 1 specifying the
contribution of acetate M+2. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_p">P</code></td>
<td>
<p>overdispersion parameter. If NA it is estimated (quasi-multinomial
distribution). If set to 0, no overdispersion is assumed (multinomial
distribution).</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_startpoints">startpoints</code></td>
<td>
<p>positive integer specifying the number of starting points
for each parameter to be estimated.</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_parameters">parameters</code></td>
<td>
<p>parameters to be estimated for each fatty acid. It can be
modified to change them or to add new fatty acids (adding new rows).</p>
</td></tr>
<tr><td><code id="runSynthesisAnalysis_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>De novo-synthesis analysis results.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='searchFAisotopes'>Search FA isotopes</h2><span id='topic+searchFAisotopes'></span>

<h3>Description</h3>

<p>Search FA isotopes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>searchFAisotopes(msbatch, dmz = 5, coelCutoff = 0.7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="searchFAisotopes_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="searchFAisotopes_+3A_dmz">dmz</code></td>
<td>
<p>mz tolerance in ppm.</p>
</td></tr>
<tr><td><code id="searchFAisotopes_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and isotope peaks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fadata list.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fadata &lt;- searchFAisotopes(msbatch, dmz = 10, coelCutoff = 0.4)

## End(Not run)

</code></pre>

<hr>
<h2 id='searchIS'>Search internal stardards.</h2><span id='topic+searchIS'></span>

<h3>Description</h3>

<p>Search internal stardards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>searchIS(msbatch, mz, rt, minRT, maxRT, dmz = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="searchIS_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="searchIS_+3A_mz">mz</code></td>
<td>
<p>numeric vector specifying IS mz.</p>
</td></tr>
<tr><td><code id="searchIS_+3A_rt">rt</code></td>
<td>
<p>numeric vector specifying IS rt.</p>
</td></tr>
<tr><td><code id="searchIS_+3A_minrt">minRT</code></td>
<td>
<p>numeric vector specifying lower limits for IS rt.</p>
</td></tr>
<tr><td><code id="searchIS_+3A_maxrt">maxRT</code></td>
<td>
<p>numeric vector specifying upper limits for IS rt.</p>
</td></tr>
<tr><td><code id="searchIS_+3A_dmz">dmz</code></td>
<td>
<p>mz tolerance in ppm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>annotated msbatch.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='ssexamplefadata'>
Toy example fadata list.
</h2><span id='topic+ssexamplefadata'></span>

<h3>Description</h3>

<p>Toy example fadata list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ssexamplefadata")</code></pre>


<h3>Format</h3>

<p>A list with 4 elements.
</p>

<dl>
<dt><code>metadata</code></dt><dd><p>data frame with metadata information for samples.</p>
</dd>
<dt><code>fattyacids</code></dt><dd><p>data frame with compound name and label for each isotopologue (intensities df).</p>
</dd>
<dt><code>IS</code></dt><dd><p>data frame with IS intensities for each sample.</p>
</dd>
<dt><code>intensities</code></dt><dd><p>data frame with isotopologue intensities for each sample.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(ssexamplefadata)
</code></pre>

<hr>
<h2 id='summarizeResults'>Obtain result tables and heatmaps that help interpreting your results.</h2><span id='topic+summarizeResults'></span>

<h3>Description</h3>

<p>Obtain result tables and heatmaps that help interpreting your results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarizeResults(fadata, controlgroup = NA, parameters = FAMetA::parameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarizeResults_+3A_fadata">fadata</code></td>
<td>
<p>fadata containing synthesis, elongation and desaturation results.</p>
</td></tr>
<tr><td><code id="summarizeResults_+3A_controlgroup">controlgroup</code></td>
<td>
<p>name of the control group to compare the results.</p>
</td></tr>
<tr><td><code id="summarizeResults_+3A_parameters">parameters</code></td>
<td>
<p>parameters to be estimated for each fatty acid. It can be
modified to change them or to add new fatty acids.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fadata list with a results element which contains: results data frame
(results for the main parameters for each fatty acid and sample), summary 
data frame (mean and sd by sample groups for each parameter and fatty acids 
from the results table), different heatmaps representing pool size and 
results (values represented are also saved in data frames) and tables 
summarizing all parameters values for synthesis and elongation (S16, E1, E2, 
E3, E4 and E5).
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ssdata &lt;- dataCorrection(ssexamplefadata, blankgroup="Blank")
ssdata &lt;- synthesisAnalysis(ssdata, R2Thr = 0.95, maxiter = 1e3,
maxconvergence = 100, startpoints = 5)
ssdata &lt;- elongationAnalysis(ssdata, R2Thr = 0.95, maxiter = 1e4,
maxconvergence=100, startpoints = 5, D2Thr = 0.1)
ssdata &lt;- desaturationAnalysis(ssdata, SEThr = 0.05)
ssdata &lt;- summarizeResults(ssdata)


## Not run: 
fadata &lt;- dataCorrection(examplefadata, blankgroup = "Blank")
fadata &lt;- synthesisAnalysis(fadata, R2Thr = 0.95, maxiter = 1e3,
maxconvergence = 100, startpoints = 5)
fadata &lt;- elongationAnalysis(fadata, R2Thr = 0.95, maxiter = 1e4,
maxconvergence=100, startpoints = 5, D2Thr = 0.1)
fadata &lt;- desaturationAnalysis(fadata, SEThr = 0.05)
fadata &lt;- summarizeResults(fadata, controlgroup = "Control13Cglc")

## End(Not run)

</code></pre>

<hr>
<h2 id='synthesisAnalysis'>De novo synthesis analysis of fatty acids until 16 carbons.</h2><span id='topic+synthesisAnalysis'></span>

<h3>Description</h3>

<p>De novo synthesis analysis of fatty acids until 16 carbons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>synthesisAnalysis(
  fadata,
  R2Thr = 0.98,
  maxiter = 1000,
  maxconvergence = 100,
  D1 = NA,
  D2 = NA,
  P = NA,
  startpoints = 5,
  parameters = FAMetA::parameters,
  propagateD = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="synthesisAnalysis_+3A_fadata">fadata</code></td>
<td>
<p>fadata obtained from the msbatch with <a href="#topic+searchFAisotopes">searchFAisotopes</a>
function or read from csv file with <a href="#topic+readfadatafile">readfadatafile</a> function.</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_r2thr">R2Thr</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the minimum R2
allowed for fits.</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_maxiter">maxiter</code></td>
<td>
<p>parameter passed to <a href="stats.html#topic+nls.control">nls.control</a>. Positive integer
specifying the maximum number of iterations allowed.</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_maxconvergence">maxconvergence</code></td>
<td>
<p>positive integer specifying the maximum number of
successes before choosing the winning model.</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_d1">D1</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+1. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_d2">D2</code></td>
<td>
<p>positive numeric between 0 and 1 specifying the contribution of
acetate M+2. If NA it is estimated.</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_p">P</code></td>
<td>
<p>overdispersion parameter. If NA it is estimated (quasi-multinomial
distribution). If set to 0, no overdispersion is assumed (multinomial
distribution).</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_startpoints">startpoints</code></td>
<td>
<p>positive integer specifying the number of starting points
for each parameter to be estimated.</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_parameters">parameters</code></td>
<td>
<p>parameters to be estimated for each fatty acid. It can be
modified to change them or to add new fatty acids.</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_propagated">propagateD</code></td>
<td>
<p>logical. If TRUE, unsaturated fatty acids use estimated D0,
D1,D2 and P values for saturated fatty acids (14:0 for FA shorter than 16C
and 16:0 for FA with 16C.).</p>
</td></tr>
<tr><td><code id="synthesisAnalysis_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Synthesis analysis will model FA data for FA up to 16 carbons to
estimate 13C-tracer contribution to the acetyl-CoA pool for FA synthesis (D)
and the FA fraction that has been synthesized de novo. D0, D1 and D2
represent the contribution of M+0, M+1 and M+2 acetate, respectively, and P
(phi) is the overdispersion parameter of the quasi-multinomial distribution.
D0, D1, D2 can also be fixed if they are known. This is particularly useful
in case inhibitors have been used as they could reduce S below the confidence
interval and thus, S and D parameters could be misestimated.
</p>


<h3>Value</h3>

<p>fadata list. Synthesis analysis results will be saved at the 
synthesis element of the fa list.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ssdata &lt;- dataCorrection(ssexamplefadata, blankgroup="Blank")
ssdata &lt;- synthesisAnalysis(ssdata, R2Thr = 0.95, maxiter = 1e3,
maxconvergence = 100, startpoints = 5)


## Not run: 
fadata &lt;- dataCorrection(examplefadata, blankgroup = "Blank")
fadata &lt;- synthesisAnalysis(fadata, R2Thr = 0.95, maxiter = 1e3,
maxconvergence = 100, startpoints = 5)

# If inhibitors have been used, make sure D2 has not been underestimated. If so,
# D2 could be set as the one calculated for 13-Glc Control samples to improve
# the results:

# D2 &lt;- fadata$synthesis$results$D2[fadata$synthesis$results$FA == "FA(16:0)"]
# fadata$synthesis$results$Group[fadata$synthesis$results$FA == "FA(16:0)"]

# D2[4:12] &lt;- rep(mean(D2[1:3]))

# relaunch synthesis analysis fixing D2
# fadata &lt;- synthesisAnalysis(fadata, R2Thr = 0.95, maxiter = 1e3,
#                             maxconvergence = 100, startpoints = 5, D2 = D2)

## End(Not run)

</code></pre>

<hr>
<h2 id='synthesisqmult'>calculate FA isotope distribution for newly synthesized FAs using the quasi
multinomial distribution.</h2><span id='topic+synthesisqmult'></span>

<h3>Description</h3>

<p>calculate FA isotope distribution for newly synthesized FAs using the quasi
multinomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>synthesisqmult(D1, D2, P, S, M, vcomb)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="synthesisqmult_+3A_d1">D1</code></td>
<td>
<p>tracer contribution to M+1 acetate pool.</p>
</td></tr>
<tr><td><code id="synthesisqmult_+3A_d2">D2</code></td>
<td>
<p>tracer contribution to M+2 acetate pool.</p>
</td></tr>
<tr><td><code id="synthesisqmult_+3A_p">P</code></td>
<td>
<p>overdispersion parameter. If different to 0, quasi-multinomial
distribution is obtained, while if set to 0, it is simplified to a multinomial
distribution.</p>
</td></tr>
<tr><td><code id="synthesisqmult_+3A_s">S</code></td>
<td>
<p>fraction of newly synthesized FA.</p>
</td></tr>
<tr><td><code id="synthesisqmult_+3A_m">M</code></td>
<td>
<p>total number of carbons for the FA.</p>
</td></tr>
<tr><td><code id="synthesisqmult_+3A_vcomb">vcomb</code></td>
<td>
<p>list of acetate combinations obtained with <a href="#topic+combAcetate">combAcetate</a>
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector with the FA isotope distribution.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
