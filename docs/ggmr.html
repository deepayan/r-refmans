<!DOCTYPE html><html><head><title>Help for package ggmr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ggmr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ggmr'>
<p>Solves the Generalized Gauss Markov Regression model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Gauss Markov Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-09-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Hugo Gasca-Aragon</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hugo Gasca-Aragon &lt;hugo_gasca_aragon@hotmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the generalized Gauss Markov regression, this is useful when both predictor and response have uncertainty attached to them and also when covariance within the predictor, within the response and between the predictor and the response is present. Base on the results published in guide ISO/TS 28037 (2010) <a href="https://www.iso.org/standard/44473.html">https://www.iso.org/standard/44473.html</a>. </td>
</tr>
<tr>
<td>Depends:</td>
<td>stats (&ge; 3.4.0), MASS (&ge; 7.3), R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-09-21 02:30:13 UTC; hugo_</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-09-30 11:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ggmr'>
Solves the Generalized Gauss Markov Regression model
</h2><span id='topic+ggmr'></span>

<h3>Description</h3>

<p>Fits the linear model using covariance matrices on the predictor, the response and covariance matrix between predictor and response, according to ISO/TS 28037 (2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggmr(x, y, Ux = diag(0, length(x)), 
			Uy = diag(1, length(x)), 
			Uxy = diag(0, length(x)),
			subset = rep(TRUE, length(x)), 
			tol = sqrt(.Machine$double.eps), max.iter = 100, alpha = 0.05,
			coef.H0 = c(0, 1))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggmr_+3A_x">x</code></td>
<td>
<p>numeric vector, the predictor values</p>
</td></tr>
<tr><td><code id="ggmr_+3A_y">y</code></td>
<td>
<p>numeric vector, the response values</p>
</td></tr>
<tr><td><code id="ggmr_+3A_ux">Ux</code></td>
<td>
<p>numeric matrix, the variance matrix of the predictor</p>
</td></tr>
<tr><td><code id="ggmr_+3A_uy">Uy</code></td>
<td>
<p>numeric matrix, the variance matrix of the response</p>
</td></tr>
<tr><td><code id="ggmr_+3A_uxy">Uxy</code></td>
<td>
<p>numeric matrix, the covariance matrix between predictor and the response</p>
</td></tr>
<tr><td><code id="ggmr_+3A_subset">subset</code></td>
<td>
<p>a logical vector or a numeric vector with the position to be considered</p>
</td></tr>
<tr><td><code id="ggmr_+3A_tol">tol</code></td>
<td>
<p>numeric, the maximum allowed error tolerance, tolerance is relative</p>
</td></tr>
<tr><td><code id="ggmr_+3A_max.iter">max.iter</code></td>
<td>
<p>integer, the maximum number of allowed iterations</p>
</td></tr>
<tr><td><code id="ggmr_+3A_alpha">alpha</code></td>
<td>
<p>numeric, the significance level used on testing H0</p>
</td></tr>
<tr><td><code id="ggmr_+3A_coef.h0">coef.H0</code></td>
<td>
<p>the coeffients for hypothesis testing purposes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following elements
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>estimated coefficients</p>
</td></tr> 
<tr><td><code>cov</code></td>
<td>
<p>covariance matrix of the estimated coefficients</p>
</td></tr>
<tr><td><code>xi</code></td>
<td>
<p>estimated latent unobservable variables</p>
</td></tr>
<tr><td><code>chisq.validation</code></td>
<td>
<p>chi-squared statistic for model validation</p>
</td></tr>
<tr><td><code>chisq.ht</code></td>
<td>
<p>chi-squared statistic of the observed values for the hypothesis testing</p>
</td></tr>
<tr><td><code>chisq.cri</code></td>
<td>
<p>chi-squared critical value</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>probability of observing a validation statistic equal or larger then the sampled just by chance</p>
</td></tr>
<tr><td><code>curr.iter</code></td>
<td>
<p>current number of iterations used</p>
</td></tr>
<tr><td><code>curr.tol</code></td>
<td>
<p>current relative tolerance</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Hugo Gasca-Aragon
</p>
<p>Maintainer: Hugo Gasca-Aragon &lt;hugo_gasca_aragon@hotmail.com&gt;
</p>


<h3>References</h3>

<p>ISO/TS 28037 (2010). <em>Determination and Use of straight-line calibration functions</em> <a href="https://www.iso.org/standard/44473.html">https://www.iso.org/standard/44473.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="dwlm.html#topic+dwlm">dwlm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(MASS)

# Example ISO 28037 (2010) Section 6. table 6
d&lt;- data.frame(
 x=c(1.0, 2.0, 3.0, 4.0, 5.0, 6.0),
 y=c(3.2, 4.3, 7.6, 8.6, 11.7, 12.8),
 uy=c(0.5, 0.5, 0.5, 1.0, 1.0, 1.0)
)
# estimates
ggmr.res &lt;- ggmr(d$x, d$y, Uy=diag(d$uy^2), coef.H0=c(0, 2), tol = 1e-10)
ggmr.res$coefficients
sqrt(diag(ggmr.res$cov))
ggmr.res$cov[1, 2]
ggmr.res$chisq.validation
ggmr.res$chisq.cri
# reference values
# coefficients = c(0.885, 2.057)
# se = c(0.530, 0.178)
# cov = -0.082
# validation.stat = 4.131
# critical.value = 9.488

# lm() estimates the coefficients correctly but 
# fails to reproduce the standard errors
summary(lm(y~x, data=d, weights=1/d$uy^2)) 
# coefficients = c(0.8852, 2.0570)
# se = c(0.5383, 0.1808)

# Example ISO 28037 (2010) Section 7. table 10
d &lt;- data.frame(
 x = c(1.2, 1.9, 2.9, 4.0, 4.7, 5.9),
 y = c(3.4, 4.4, 7.2, 8.5, 10.8, 13.5)
)
Ux = diag(c(0.2, 0.2, 0.2, 0.2, 0.2, 0.2))^2
Uy = diag(c(0.2, 0.2, 0.2, 0.4, 0.4, 0.4))^2

# estimates
ggmr.res &lt;- ggmr(d$x, d$y, Ux, Uy, coef.H0=c(0, 2), tol = 1e-10)
ggmr.res$coefficients
sqrt(diag(ggmr.res$cov))
ggmr.res$cov[1, 2]
ggmr.res$chisq.validation
ggmr.res$chisq.cri
# reference values
# coefficients = c(0.5788, 2.1597)
# se = c(0.4764, 0.1355)
# cov = -0.0577
# validation.stat = 2.743
# critical.value = 9.488

# Example ISO 28037 (2010) Section 10. table 25
d&lt;- data.frame(
 x=c(50.4, 99.0, 149.9, 200.4, 248.5, 299.7, 349.1),
 y=c(52.3, 97.8, 149.7, 200.1, 250.4, 300.9, 349.2)
)

Ux&lt;- matrix(c(
 0.50, 0.00, 0.25, 0.00, 0.25, 0.00, 0.25,
 0.00, 1.25, 1.00, 0.00, 0.00, 1.00, 1.00,
 0.25, 1.00, 1.50, 0.00, 0.25, 1.00, 1.25,
 0.00, 0.00, 0.00, 1.25, 1.00, 1.00, 1.00,
 0.25, 0.00, 0.25, 1.00, 1.50, 1.00, 1.25,
 0.00, 1.00, 1.00, 1.00, 1.00, 2.25, 2.00,
 0.25, 1.00, 1.25, 1.00, 1.25, 2.00, 2.50
), 7, 7)

Uy&lt;- matrix(1.00, 7, 7) + diag(4.00, 7)

Uxy&lt;- matrix(0, 7, 7)

# estimates
ggmr.res&lt;- ggmr(d$x, d$y, Ux, Uy, Uxy)
ggmr.res$coefficients
sqrt(diag(ggmr.res$cov))
ggmr.res$cov[1, 2]
ggmr.res$chisq.validation
ggmr.res$chisq.cri
# reference values
# coefficients = c(0.3424, 1.0012)
# se = c(2.0569, 0.0090)
# cov = -0.0129
# validation.stat = 1.772
# critical.value = 11.070

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
