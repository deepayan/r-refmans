<!DOCTYPE html><html lang="en"><head><title>Help for package globalKinhom</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {globalKinhom}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#globalKinhom-package'>
<p>Inhomogeneous K- And Pair Correlation Functions Using Global Estimators</p></a></li>
<li><a href='#expectedPairs'>
<p>Expected pairs in an inhomogeneous poisson process</p></a></li>
<li><a href='#Kglobal'><p> (cross) K functions with a global intensity reweighting</p></a></li>
<li><a href='#pcfglobal'><p> (cross) pair correlation functions with a global intensity reweighting</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inhomogeneous K- And Pair Correlation Functions Using Global
Estimators</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-07</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Shaw [aut, cre],
  Ege Rubak [ctb],
  Adrian Baddeley [ctb],
  Rolf Turner [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Shaw &lt;tshaw20@utk.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), spatstat.explore (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, grDevices, spatstat.geom (&ge; 3.1),
spatstat.random (&ge; 2.1.0), spatstat.univar</td>
</tr>
<tr>
<td>Description:</td>
<td>Second-order summary statistics K- and pair-correlation functions describe
    interactions in point pattern data. This package provides computations to estimate those
    statistics on inhomogeneous point processes, using the methods of
    in T Shaw, J Møller, R Waagepetersen, 2020 &lt;<a href="https://doi.org/10.48550%2FarXiv.2004.00527">doi:10.48550/arXiv.2004.00527</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-07 19:35:07 UTC; tshaw</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-07 20:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='globalKinhom-package'>
Inhomogeneous K- And Pair Correlation Functions Using Global Estimators
</h2><span id='topic+globalKinhom-package'></span><span id='topic+globalKinhom'></span>

<h3>Description</h3>

<p>Second-order summary statistics K- and pair-correlation functions describe
    interactions in point pattern data. This package provides computations to estimate those
    statistics on inhomogeneous point processes, using the methods of
    in T Shaw, J Møller, R Waagepetersen, 2020 &lt;doi:10.48550/arXiv.2004.00527&gt;.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> globalKinhom</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Inhomogeneous K- And Pair Correlation Functions Using Global Estimators</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1.9</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-10-07</td>
</tr>
<tr>
 <td style="text-align: left;">
Encoding: </td><td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person("Thomas", "Shaw", role=c("aut", "cre"), email="tshaw20@utk.edu"),
            person("Ege", "Rubak", role="ctb"),
            person("Adrian", "Baddeley", role="ctb"),
            person("Rolf", "Turner", role="ctb"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Thomas Shaw [aut, cre],
            Ege Rubak [ctb],
            Adrian Baddeley [ctb],
            Rolf Turner [ctb]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Thomas Shaw &lt;tshaw20@utk.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.5.0), spatstat.explore (&gt;= 3.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> stats, utils, grDevices, spatstat.geom (&gt;= 3.1), spatstat.random (&gt;= 2.1.0), spatstat.univar</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Second-order summary statistics K- and pair-correlation functions describe
    interactions in point pattern data. This package provides computations to estimate those
    statistics on inhomogeneous point processes, using the methods of
    in T Shaw, J Møller, R Waagepetersen, 2020 &lt;doi:10.48550/arXiv.2004.00527&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
Kglobal                 (cross) K functions with a global intensity
                        reweighting
expectedPairs           Expected pairs in an inhomogeneous poisson
                        process
globalKinhom-package    Inhomogeneous K- And Pair Correlation Functions
                        Using Global Estimators
pcfglobal               (cross) pair correlation functions with a
                        global intensity reweighting
</pre>
<p>This package accompanies Shaw et al (2020). It provides &ldquo;global&rdquo;
estimators for the non-parametric <code class="reqn">K</code>- and pair correlation functions, which
summarize the second order interactions of second-order intensity-reweighted
stationary (SOIRS) point processes. These estimators provide an alternative to
those proposed by Baddeley et al (2000) for SOIRS point processes, which we
refer to as &ldquo;local&rdquo; estimators. The local estimators are implemented in
the <code><a href="spatstat.explore.html#topic+spatstat.explore">spatstat.explore</a></code> package as <code><a href="spatstat.explore.html#topic+pcfinhom">pcfinhom</a></code> and
<code><a href="spatstat.explore.html#topic+Kinhom">Kinhom</a></code>, with <code><a href="spatstat.explore.html#topic+pcfcross.inhom">pcfcross.inhom</a></code> and
<code><a href="spatstat.explore.html#topic+Kcross.inhom">Kcross.inhom</a></code> for the corresponding cross-pcf and
cross-<code class="reqn">K</code>-function.
</p>
<p>Where possible, the interfaces are made to match those used by the
<a href="spatstat.explore.html#topic+spatstat.explore">spatstat.explore</a> package.
</p>


<h3>Author(s)</h3>

<p>Thomas Shaw [aut, cre],
            Ege Rubak [ctb],
            Adrian Baddeley [ctb],
            Rolf Turner [ctb]
</p>
<p>Maintainer: Thomas Shaw &lt;tshaw20@utk.edu&gt;
</p>


<h3>References</h3>

<p>T Shaw, J Møller, R Waagepetersen. 2020. &ldquo;Globally Intensity-Reweighted Estimators for
<code class="reqn">K</code>- and pair correlation functions&rdquo;. arXiv:2004.00527 [stat.ME].
</p>
<p>A Baddeley, J Møller, R Waagepetersen. 2000. &ldquo;Non- and Semi-Parametric Estimation of
Interaction in Inhomogeneous Point Patterns&rdquo;. Statistica Neerlandica 54, 329-350.
</p>


<h3>See Also</h3>

 <p><code><a href="spatstat.explore.html#topic+spatstat.explore">spatstat.explore</a></code>, <code><a href="#topic+Kglobal">Kglobal</a></code>, <code>link{pcfglobal}</code>
</p>

<hr>
<h2 id='expectedPairs'>
Expected pairs in an inhomogeneous poisson process
</h2><span id='topic+expectedPairs'></span><span id='topic+expectedCrossPairs'></span><span id='topic+expectedPairs_iso'></span><span id='topic+expectedCrossPairs_iso'></span><span id='topic+expectedPairs_kernloo'></span><span id='topic+expectedPairs_iso_kernloo'></span>

<h3>Description</h3>

<p>Compute the expected number of pairs at a given displacement h in a poisson
process with a given intensity function. This corresponds to the integrals
<code class="reqn">\gamma</code> of Shaw et al. 2020. The various functions correspond
to the univariate and bivariate versions of the anisotropic or isotropic
versions of <code class="reqn">\gamma</code>. The final two options (<code>expectedPairs_kernloo</code>
and <code>expectedPairs_iso_kernloo</code>), provide implementations of the leave-out
kernel estimates of <code class="reqn">\gamma</code>: <code class="reqn">\bar \gamma(h)</code> and
<code class="reqn">\bar \gamma ^\mathrm{iso}(r)</code>. In those cases, the point pattern
<code>X</code> itself is passed to the routine, rather than the (true or estimated) intensities
<code>rho</code> etc. The estimators for <code class="reqn">\bar \gamma(h)</code> are only applicable
to univariate processes. See Shaw et al, 2020 for details.</p>


<h3>Usage</h3>

<pre><code class='language-R'>expectedPairs(rho, hx, hy=NULL, method=c("mc", "lattice"),
                tol=.005, dx=diff(as.owin(rho)$xrange)/200, maxeval=1e6,
                maxsamp=5e3)

expectedCrossPairs(rho1, rho2=NULL, hx, hy=NULL, method=c("mc", "lattice"),
                tol=.005, dx=diff(as.owin(rho1)$xrange)/200, maxeval=1e6,
                maxsamp=5e3)

expectedPairs_iso(rho, r, tol=.001, maxeval=1e6, maxsamp=5e3)

expectedCrossPairs_iso(rho1, rho2=NULL, r, tol=.001, maxeval=1e6, maxsamp=5e3)

expectedPairs_kernloo(X, hx,hy, sigma=bw.CvL, tol=.005, maxeval=1e6,
                            maxsamp=5e3, leaveoneout=TRUE)

expectedPairs_iso_kernloo(X, r, sigma=bw.CvL, tol=.001, maxeval=1e6,
                                    maxsamp=5e3, leaveoneout=TRUE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expectedPairs_+3A_rho1">rho1</code>, <code id="expectedPairs_+3A_rho2">rho2</code>, <code id="expectedPairs_+3A_rho">rho</code></td>
<td>

<p>Intensity functions, either of class <code>im</code> or <code>funxy</code>.  This may
be produced by <code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code> or
<code><a href="spatstat.explore.html#topic+densityfun.ppp">densityfun.ppp</a></code>, or provided by a fitted
intensity model.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_x">X</code></td>
<td>

<p>Point pattern of class <code><a href="spatstat.geom.html#topic+ppp">ppp</a></code> with the points of
the pattern for which <code class="reqn">\bar \gamma</code> is to be estimated.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_hx">hx</code>, <code id="expectedPairs_+3A_hy">hy</code></td>
<td>

<p>For expectedPairs and expectedCrossPairs (i.e. <code class="reqn">\gamma(h)</code>),
the displacements <code class="reqn">h \in \textrm{R}^2</code> to evaluate <code class="reqn">\gamma</code>
at. These can be in any format supported by xy.coords.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_r">r</code></td>
<td>

<p>For the isotropic versions <code class="reqn">\gamma^\mathrm{iso}(r)</code>, the
separations <code class="reqn">r</code> at which <code class="reqn">\gamma^\mathrm{iso}</code> is to be
evaluated.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_method">method</code></td>
<td>

<p>Either mc (the default) or lattice. Compute integral using monte-carlo or
on a lattice.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_tol">tol</code></td>
<td>

<p>A tolerance for how precise the integral should be. This is compared to a
standard error for the mc estimate.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_sigma">sigma</code></td>
<td>

<p>Smoothing bandwidth for direct kernel-based estimators <code class="reqn">\bar \gamma</code>.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_leaveoneout">leaveoneout</code></td>
<td>

<p>Use leave-out estimators. This should generally be true except for the purpose of
evaluating the bias of the standard estimators. See Shaw et al 2020 for details.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_maxeval">maxeval</code></td>
<td>

<p>Maximum number of evaluations of rho per iteration. Prevents memory-related
crashes that can occur.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_maxsamp">maxsamp</code></td>
<td>

<p>Maximum number of monte carlo samples per iteration. If this is too large,
you may do more work than required to achieve tol.
</p>
</td></tr>
<tr><td><code id="expectedPairs_+3A_dx">dx</code></td>
<td>

<p>if method==&quot;lattice&quot;, a lattice spacing for the computation. defaults to .01.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value is a numeric vector with length equal to the number of
displacements h passed 
</p>


<h3>Author(s)</h3>

<p>Thomas Shaw &lt;shawtr@umich.edu&gt;
</p>


<h3>References</h3>

<p>T Shaw, J Møller, R Waagepetersen. 2020. &ldquo;Globally Intensity-Reweighted Estimators for
<code class="reqn">K</code>- and pair correlation functions&rdquo;. arXiv:2004.00527 [stat.ME].
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pcfglobal">pcfglobal</a></code>, <code><a href="#topic+Kglobal">Kglobal</a></code>, which use these functions to compute
the normalization functions <code class="reqn">\gamma</code>.
</p>

<hr>
<h2 id='Kglobal'> (cross) K functions with a global intensity reweighting </h2><span id='topic+Kglobal'></span><span id='topic+Kcross.global'></span>

<h3>Description</h3>

<p>Compute <code class="reqn">K_\textrm{global}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kglobal(X, lambda=NULL, ..., sigma=bw.CvL(X), r=NULL, rmax=NULL, breaks=NULL,
            normtol=.005, discrete.lambda=FALSE,
            interpolate=TRUE, interpolate.fac=10, isotropic=TRUE,
            leaveoneout=TRUE, exp_prs=NULL,
            interpolate.maxdx=diameter(as.owin(X))/100, dump=FALSE)

Kcross.global(X, Y, lambdaX=NULL, lambdaY=NULL, ..., sigma=bw.CvL(X), r=NULL,
            rmax=NULL, breaks=NULL, normtol=.005,
            discrete.lambda=FALSE, interpolate=TRUE, isotropic=TRUE,
            interpolate.fac=10, leaveoneout=TRUE, exp_prs=NULL,
            interpolate.maxdx=diameter(as.owin(X))/100, dump=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Kglobal_+3A_x">X</code>, <code id="Kglobal_+3A_y">Y</code></td>
<td>

<p>point process of type <code><a href="spatstat.geom.html#topic+ppp">ppp</a></code>, on which to evaluate the (cross) <code class="reqn">K</code>-function
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_lambda">lambda</code>, <code id="Kglobal_+3A_lambdax">lambdaX</code>, <code id="Kglobal_+3A_lambday">lambdaY</code></td>
<td>

<p>intensity function estimates corresponding to <code>X</code> and <code>Y</code>. If omitted, intensity
functions will be computed using
<code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code> or
<code><a href="spatstat.explore.html#topic+densityfun.ppp">densityfun.ppp</a></code> (see discrete.lambda below)
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_...">...</code></td>
<td>

<p>extra args passed to density.ppp or densityfun.ppp, if applicable.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_sigma">sigma</code></td>
<td>

<p>Bandwidth value to use for kernel-based intensity estimation, intensity functions and
<code>exp_prs</code> are not provided by the user.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_r">r</code></td>
<td>

<p>Values of <code class="reqn">r</code> to evaluate <code class="reqn">K(r)</code> at. If omitted, a sensible default
is chosen, using the same conventions as <code><a href="spatstat.explore.html#topic+Kest">Kest</a></code> and
<code><a href="spatstat.explore.html#topic+Kinhom">Kinhom</a></code>.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_rmax">rmax</code></td>
<td>

<p>Maximum <code class="reqn">r</code> to evaluate <code class="reqn">K(r)</code> at. <code>rmax</code> is used to generate values for <code>r</code>,
if omitted. If missing, a sensible default is chosen.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_breaks">breaks</code></td>
<td>

<p>For internal use only.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_normtol">normtol</code></td>
<td>

<p>A tolerance to use for expectedPairs or expectedCrossPairs when computing monte-carlo
estimates of the normalizing factor <code class="reqn">\gamma</code>. Expressed as a maximum fractional
standard error.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_discrete.lambda">discrete.lambda</code></td>
<td>

<p>If <code>TRUE</code>, and intensity function(s) are not supplied, estimate intensities by
interpolating the values on a discrete lattice (using
<code><a href="spatstat.geom.html#topic+interp.im">interp.im</a></code> and
<code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>), instead of exactly (using
<code><a href="spatstat.explore.html#topic+densityfun.ppp">densityfun.ppp</a></code>).
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_interpolate">interpolate</code></td>
<td>

<p>If <code>TRUE</code>, evaluate the expectedCrossPairs on a lattice and interpolate,
rather than at the exact displacements observed in the pattern.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_interpolate.fac">interpolate.fac</code></td>
<td>

<p>If <code>interpolate</code>, the lattice spacing will be <code>sigma/interpolate.fac</code>.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_isotropic">isotropic</code></td>
<td>

<p>Set to <code>TRUE</code> to use the isotropic estimators <code class="reqn">\gamma_\textrm{iso}</code>.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_leaveoneout">leaveoneout</code></td>
<td>

<p>Use the leave-one-out estimator for <code class="reqn">\gamma</code>. See Shaw et al, 2020 for details.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_exp_prs">exp_prs</code></td>
<td>

<p>A function that returns values for
<code class="reqn">\gamma_\textrm{iso}(r)</code>. If <code class="reqn">\gamma</code> is
known explicitly, or the same calculation is being used for several
point patterns, it can be much faster to compute it once and provide the function
as <code>exp_prs</code>, since the computation of <code class="reqn">\gamma</code> is usually the
slowest part.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_interpolate.maxdx">interpolate.maxdx</code></td>
<td>

<p>Upper bound on allowable lattice spacing for interpolation.
</p>
</td></tr>
<tr><td><code id="Kglobal_+3A_dump">dump</code></td>
<td>

<p>For debugging purposes, include computed values of <code class="reqn">\gamma</code> with the output,
as <code>attr</code>s.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value is an object of class <code><a href="spatstat.explore.html#topic+fv">fv</a></code>,
just as for <code><a href="spatstat.explore.html#topic+Kest">Kest</a></code> and
<code><a href="spatstat.explore.html#topic+Kinhom">Kinhom</a></code>. The
object contains columns <code>r</code>, <code>theo</code>, and
<code>global</code>, corresponding respectively to the argument <code class="reqn">r</code>, the theoretical
values of <code class="reqn">K(r)</code> for a Poisson process, and <code class="reqn">K_\mathrm{global}(r)</code>.
</p>


<h3>Author(s)</h3>

<p>Thomas Shaw &lt;shawtr@umich.edu&gt;
</p>


<h3>References</h3>

<p>T Shaw, J Møller, R Waagepetersen. 2020. &ldquo;Globally Intensity-Reweighted Estimators for
<code class="reqn">K</code>- and pair correlation functions&rdquo;. arXiv:2004.00527 [stat.ME].
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expectedPairs">expectedPairs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rho &lt;- funxy(function(x,y) 80*(1+x), owin())
X &lt;- rpoispp(rho)
K &lt;- Kglobal(X)
#plot(K)
</code></pre>

<hr>
<h2 id='pcfglobal'> (cross) pair correlation functions with a global intensity reweighting </h2><span id='topic+pcfglobal'></span><span id='topic+pcfcross.global'></span>

<h3>Description</h3>

<p>Compute <code class="reqn">g_\textrm{global}</code> or <code class="reqn">c_\textrm{global}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcfglobal(X, lambda=NULL, ..., sigma=bw.CvL(X), r=NULL, rmax=NULL,
    kernel="epanechnikov", bw=NULL, stoyan=0.15, normtol=.005, ratio=FALSE,
    discrete.lambda=FALSE, divisor=c("r", "d"),
    leaveoneout=TRUE, interpolate=TRUE, interpolate.fac=10, exp_prs=NULL,
    interpolate.maxdx=diameter(as.owin(X))/100, dump=FALSE)

pcfcross.global(X,Y, lambdaX=NULL, lambdaY=NULL, ...,
    sigma=bw.CvL(X), r=NULL, rmax=NULL, kernel="epanechnikov", bw=NULL,
    stoyan=0.15, normtol=.005, ratio=FALSE, discrete.lambda=FALSE,
    divisor=c("r", "d"), analytical=NULL, interpolate=TRUE,
    interpolate.fac=10, exp_prs=NULL,
    interpolate.maxdx=diameter(as.owin(X))/100, dump=FALSE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcfglobal_+3A_x">X</code>, <code id="pcfglobal_+3A_y">Y</code></td>
<td>

<p>point process of type <code><a href="spatstat.geom.html#topic+ppp">ppp</a></code>, on which to evaluate the (cross) <code class="reqn">K</code>-function
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_lambda">lambda</code>, <code id="pcfglobal_+3A_lambdax">lambdaX</code>, <code id="pcfglobal_+3A_lambday">lambdaY</code></td>
<td>

<p>intensity function estimates corresponding to <code>X</code> and <code>Y</code>. If omitted, intensity
functions will be computed using
<code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code> or
<code><a href="spatstat.explore.html#topic+densityfun.ppp">densityfun.ppp</a></code> (see discrete.lambda below)
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_...">...</code></td>
<td>

<p>extra args passed to density.ppp or densityfun.ppp, if applicable.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_sigma">sigma</code></td>
<td>

<p>Bandwidth value to use for kernel-based intensity estimation, intensity functions and
<code>exp_prs</code> are not provided by the user.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_r">r</code></td>
<td>

<p>Values of <code class="reqn">r</code> to evaluate <code class="reqn">K(r)</code> at. If omitted, a sensible default is chosen, using the same
conventions as <code><a href="spatstat.explore.html#topic+Kest">Kest</a></code> and <code><a href="spatstat.explore.html#topic+Kinhom">Kinhom</a></code>.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_rmax">rmax</code></td>
<td>

<p>Maximum <code class="reqn">r</code> to evaluate <code class="reqn">K(r)</code> at. <code>rmax</code> is used to generate values for <code>r</code>,
if omitted. If missing, a sensible default is chosen.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_kernel">kernel</code></td>
<td>

<p>Kernel type for smoothing of pcf.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_bw">bw</code></td>
<td>

<p>Kernel bandwidth for smoothing of pcf.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_stoyan">stoyan</code></td>
<td>

<p>Coefficient for Stoyan's bandwidth selection rule. See
<code><a href="spatstat.explore.html#topic+pcf.ppp">pcf.ppp</a></code>.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_normtol">normtol</code></td>
<td>

<p>A tolerance to use for expectedPairs or expectedCrossPairs when computing monte-carlo
estimates of the normalizing factor <code class="reqn">\gamma</code>. Expressed as a maximum fractional
standard error.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_ratio">ratio</code></td>
<td>

<p>If <code>TRUE</code>, assemble numerator and denominator of pcf estimator separately.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_divisor">divisor</code></td>
<td>

<p>Whether to use the evaluation distance (<code>"r"</code>) or the distance between points (<code>"d"</code>)
to normalize the contribution of each point pair.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_analytical">analytical</code></td>
<td>

<p>If <code>TRUE</code>, use Diggle-Jones weights 
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_discrete.lambda">discrete.lambda</code></td>
<td>

<p>If <code>TRUE</code>, and intensity function(s) are not supplied, estimate intensities by
interpolating the values on a discrete lattice (using
<code><a href="spatstat.geom.html#topic+interp.im">interp.im</a></code> and
<code><a href="spatstat.explore.html#topic+density.ppp">density.ppp</a></code>), instead of exactly (using
<code><a href="spatstat.explore.html#topic+densityfun.ppp">densityfun.ppp</a></code>).
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_interpolate">interpolate</code></td>
<td>

<p>If <code>TRUE</code>, evaluate the expectedCrossPairs on a lattice and interpolate,
rather than at the exact displacements observed in the pattern.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_interpolate.fac">interpolate.fac</code></td>
<td>

<p>If <code>interpolate</code>, the lattice spacing will be <code>sigma/interpolate.fac</code>.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_leaveoneout">leaveoneout</code></td>
<td>

<p>Use the leave-one-out estimator for <code class="reqn">\gamma</code>. See Shaw et al 2020 for details.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_exp_prs">exp_prs</code></td>
<td>

<p>A function that returns values for
<code class="reqn">\gamma_\textrm{iso}(r)</code>. If <code class="reqn">\gamma</code> is
known explicitly, or the same calculation is being used for several
point patterns, it can be much faster to compute it once and provide the function
as <code>exp_prs</code>, since the computation of <code class="reqn">\gamma</code> is usually the
slowest part.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_interpolate.maxdx">interpolate.maxdx</code></td>
<td>

<p>Upper bound on allowable lattice spacing for interpolation.
</p>
</td></tr>
<tr><td><code id="pcfglobal_+3A_dump">dump</code></td>
<td>

<p>For debugging purposes, include computed values of <code class="reqn">\gamma</code> with the output,
as <code>attr</code>s.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value is an object of class <code><a href="spatstat.explore.html#topic+fv">fv</a></code>,
just as for <code><a href="spatstat.explore.html#topic+pcf">pcf</a></code> and
<code><a href="spatstat.explore.html#topic+pcfinhom">pcfinhom</a></code>. The object contains columns <code>r</code>,
<code>theo</code>, and <code>global</code>, corresponding respectively to the argument
<code class="reqn">r</code>, the theoretical values of <code class="reqn">g(r)</code> for a Poisson process, and
<code class="reqn">g_\mathrm{global}(r)</code>.
</p>


<h3>Author(s)</h3>

<p>Thomas Shaw &lt;shawtr@umich.edu&gt;
</p>


<h3>References</h3>

<p>T Shaw, J Møller, R Waagepetersen. 2020. &ldquo;Globally Intensity-Reweighted Estimators for
<code class="reqn">K</code>- and pair correlation functions&rdquo;. arXiv:2004.00527 [stat.ME].
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expectedPairs">expectedPairs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rho &lt;- funxy(function(x,y) 80*(1+x), owin())
X &lt;- rpoispp(rho)
g &lt;- pcfglobal(X)
#plot(g)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
