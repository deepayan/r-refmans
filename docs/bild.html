<!DOCTYPE html><html><head><title>Help for package bild</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bild}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bild-package'><p>A Package for BInary Longitudinal Data</p></a></li>
<li><a href='#airpollution'><p>Air Pollution</p></a></li>
<li><a href='#anova-methods'><p>Methods for Function anova in Package &quot;bild&quot;</p></a></li>
<li><a href='#bild'><p>Fit of Parametric Models for Binary Longitudinal Data via Likelihood Method</p></a></li>
<li><a href='#bild-class'><p>Class &quot;bild&quot; for Results of a Maximum Likelihood Estimation</p></a></li>
<li><a href='#bild-internal'><p>Internal functions</p></a></li>
<li><a href='#bildControl'><p>Auxiliary for Controlling &quot;bild&quot; Fitting</p></a></li>
<li><a href='#bildIntegrate'><p> Auxiliary for Controlling &quot;bild&quot; Fitting</p></a></li>
<li><a href='#fitted-methods'><p>Methods for function <code>fitted</code></p></a></li>
<li><a href='#fixeff'><p>Extract fixed effects estimates</p></a></li>
<li><a href='#fixeff-methods'><p>Methods for function <code>fixeff</code></p></a></li>
<li><a href='#getAIC'><p>Extract the Akaike Information Criterion</p></a></li>
<li><a href='#getAIC-methods'><p>Extract the Akaike Information Criterion</p></a></li>
<li><a href='#getcoef'><p>Extract the coefficient estimates</p></a></li>
<li><a href='#getcoef-methods'><p>Methods for function <code>getcoef</code></p></a></li>
<li><a href='#getLogLik'><p>Extract Log-Likelihood</p></a></li>
<li><a href='#getLogLik-methods'><p>Extract Log-Likelihood</p></a></li>
<li><a href='#getvcov'><p>Extract variance-covariance matrix</p></a></li>
<li><a href='#getvcov-methods'><p>Methods for function <code>getvcov</code></p></a></li>
<li><a href='#locust'><p>Locust</p></a></li>
<li><a href='#model.mat'><p>Extract the fixed effects model matrix</p></a></li>
<li><a href='#model.mat-methods'><p>Methods for function <code>model.mat</code></p></a></li>
<li><a href='#muscatine'><p>Muscatine</p></a></li>
<li><a href='#plot-methods'><p>Methods for Function plot in Package &quot;bild&quot;</p></a></li>
<li><a href='#randeff'><p>Extract conditional random effects</p></a></li>
<li><a href='#randeff-methods'><p>Methods for function <code>randeff</code></p></a></li>
<li><a href='#show-methods'><p>Methods for function show in package &quot;bild&quot;</p></a></li>
<li><a href='#summary-methods'><p>Methods for Function summary in Package &quot;bild&quot;</p></a></li>
<li><a href='#summary.bild-class'><p>Class &quot;summary.bild&quot;, Summary of &quot;bild&quot; Objects</p></a></li>
<li><a href='#vareff'><p>Extract variance of random effects</p></a></li>
<li><a href='#vareff-methods'><p>Methods for function <code>vareff</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Package for BInary Longitudinal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-18</td>
</tr>
<tr>
<td>Author:</td>
<td>M. Helena Goncalves, M. Salome Cabral and Adelchi Azzalini, 
  apart from a set of Fortran-77 subroutines written by R. Piessens
  and E. de Doncker, belonging to the suite "Quadpack".</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>M. Helena Goncalves &lt;mhgoncal@ualg.pt&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs logistic regression for binary longitudinal
  data, allowing for serial dependence among observations from a given
  individual and a random intercept term. Estimation is via maximization
  of the exact likelihood of a suitably defined model. Missing values and 
  unbalanced data are allowed, with some restrictions. 
  M. Helena Goncalves et al.(2007) &lt;<a href="https://doi.org/10.18637%2Fjss.v046.i09">doi:10.18637/jss.v046.i09</a>&gt;.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), methods, stats, graphics, grDevices, utils</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-03 13:19:42 UTC; PC</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-03 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bild-package'>A Package for BInary Longitudinal Data</h2><span id='topic+bild-package'></span>

<h3>Description</h3>

<p>Performs logistic regression for binary longitudinal
data, allowing for serial dependence among observations from a given
individual and a random intercept term. Estimation is via maximization
of the exact likelihood of a suitably defined model. Missing values and 
unbalanced data are allowed, with some restrictions. 
</p>


<h3>Details</h3>

<p>This package contains functions to perform the fit of parametric models via likelihood method for binary
longitudinal data using &quot;S4&quot; classes and methods as implemented in the <code>methods</code> package.</p>


<h3>Acknowledgments</h3>

<p>We would like to thank the CRAN team for help in the fine tuning of the Fortran code.</p>


<h3>Author(s)</h3>

<p>M. Helena Goncalves, M.Salome Cabral and Adelchi Azzalini</p>


<h3>References</h3>

<p>Azzalini, A. (1994). Logistic regression for autocorrelated data with application to repeated measures. 
<em>Biometrika</em>, 81, 767-775. Amendment: (1997) vol. 84, 989.
</p>
<p>Goncalves, M. Helena (2002) <em> Likelihood methods for discrete longitudinal data</em>. PhD thesis, Faculty of Sciences, University of Lisbon.
</p>
<p>Goncalves, M. Helena and Azzalini, A. (2008). Using Markov chains for marginal modelling of binary longitudinal data 
in an exact likelihood approach. <em>Metron</em>, vol LXVI, 2, 157-181.
</p>
<p>Goncalves MH, Cabral MS and Azzalini A (2012). 
The R Package <code>bild</code> for the Analysis of Binary Longitudinal Data. <em>Journal of Statistical Software</em>, 46(9), 1-17.</p>


<h3>See Also</h3>

<p><code><a href="#topic+bild-class">bild-class</a></code>, <code><a href="#topic+bild">bild</a></code>, <code><a href="methods.html#topic+Methods">Methods</a></code></p>

<hr>
<h2 id='airpollution'>Air Pollution</h2><span id='topic+airpollution'></span>

<h3>Description</h3>

<p>This example is a subset of data from Six Cities study, a longitudinal study of the health effects of 
air pollution (Ware, J. H. et al., 1984).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(airpollution)</code></pre>


<h3>Format</h3>

<p>A data frame with 128 observations on the following 5 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>identifies de number of the individual profile. This vector contains observations of 32 individual profiles.</p>
</dd>
<dt><code>wheeze</code></dt><dd><p>a numeric vector that identify the wheezing status (1=&quot;yes&quot;, 0=&quot;no&quot;) of a child at each occasion.</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector corresponding to the <code>age</code> in years since the child's 9th birthday.</p>
</dd>
<dt><code>smoking</code></dt><dd><p>a factor that identify if the mother smoke (1=&quot;smoke&quot;, 0=&quot;no smoke&quot;).</p>
</dd>
<dt><code>counts</code></dt><dd><p>a numeric vector corresponding to the replications of each individual profile.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data set presented by Fitzmaurice and Laird (1993) contains complete records
on 537 children from Steubnville, Ohio, each woman was examined annually at ages 7 through 10. 
The repeated binary response is the wheezing status (1=&quot;yes&quot;, 0=&quot;no&quot;) of a child at each occasion. 
Although mother's smoking status could vary with time, it was determined in the first interview and 
was treated as a time-independent covariate. Maternal smoking was categorized as 1 if the mother
smoked regularly and 0 otherwise.</p>


<h3>Source</h3>

<p> Fitzmaurice, G. M. and Laird, N. M. (1993). 
A Likelihood-Based Method for analyzing Longitudinal Binary Response. 
<em>Biometrika</em>, 80, 141-51.</p>


<h3>References</h3>

<p>  Ware, J. H., Dockery, D. W., Spiro,  A. III, Speizer, F. E. and Ferris, B. G., Jr. (1984). 
Passive smoking, gas cooking and respiratory health in children 
living in six cities. <em>Am. Rev. Respir. dis.</em>, 129, 366-74.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(airpollution)

#####  dependence="MC2"
air2 &lt;- bild(wheeze~age+smoking, data=airpollution, time="age",
        aggregate=smoking, dependence="MC2")

summary(air2)
getAIC(air2)
getLogLik(air2)
plot(air2)

#####  dependence="MC2R"
 
air2r &lt;- bild(wheeze~age+smoking, data=airpollution, time="age",
            aggregate=smoking, dependence="MC2R")

summary(air2r)
getAIC(air2r)
getLogLik(air2r)
plot(air2r) 

plot(air2r, which=6, subSET=smoking=="0", main="smoking==0", ident=TRUE) 

</code></pre>

<hr>
<h2 id='anova-methods'>Methods for Function anova in Package &quot;bild&quot;</h2><span id='topic+anova-methods'></span><span id='topic+anova+2Cbild-method'></span>

<h3>Description</h3>

<p> Compute an analysis deviance table for two fitted model objects. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
anova(object, ..., test = TRUE, correct = FALSE)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="anova-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
<tr><td><code id="anova-methods_+3A_...">...</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
<tr><td><code id="anova-methods_+3A_test">test</code></td>
<td>
<p>an optional logical value controlling whether likelihood ratio tests 
should be used to compare the fitted models represented by <code>object</code> and by <code>y</code>. The default is TRUE. </p>
</td></tr>  
<tr><td><code id="anova-methods_+3A_correct">correct</code></td>
<td>
<p>an optional logical value controlling whether the p-value of the likelihood ratio test 
must be corrected. The default is FALSE.</p>
</td></tr>  
</table>


<h3>Details</h3>

 
<p><code>correct</code> = TRUE is used to test the presence of a random intercept term and the solution proposed by Self and Liang (1987) is adopted 
only to the p-value. </p>


<h3>Warning</h3>

 
<p>The comparison between two models by anova will only be valid if they are fitted to the same dataset.</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "ANY")</code>:</dt><dd><p>Generic function.</p>
</dd>
<dt><code>signature(object="bild")</code>:</dt><dd><p>Anova for <code><a href="#topic+bild">bild</a></code> object.</p>
</dd> 
</dl>


<h3>References</h3>

<p>Self, Steven G. and Liang, Kung-Yee (1987). Asymptotic properties of maximum likelihood estimators and likelihood 
ratio tests under nonstandard conditions. <em>Journal of the American Statistical Association</em>, 82, 605-610. </p>


<h3>Examples</h3>

<pre><code class='language-R'>#####  data = locust

loc1 &lt;- bild(move~(time+I(time^2))*feed*sex, data=locust, dependence="MC1")

loc2 &lt;- bild(move~(time+I(time^2))*feed, data=locust, dependence="MC1")

anova(loc1,loc2)

loc3 &lt;- bild(move~(time+I(time^2))*feed, data=locust, dependence="MC2")

anova(loc3,loc2)

#####  data= muscatine
 
# we decompose the time effect in orthogonal components
muscatine$time1 &lt;- c(-1, 0, 1)
muscatine$time2 &lt;- c(1, -2, 1)

musc1 &lt;- bild(obese~time1, data=muscatine, time="time1", 
        dependence="MC1")

musc1r &lt;- bild(obese~time1, data=muscatine, time="time1", 
        dependence="MC1R")

anova(musc1, musc1r, correct=TRUE)

</code></pre>

<hr>
<h2 id='bild'>Fit of Parametric Models for Binary Longitudinal Data via Likelihood Method</h2><span id='topic+bild'></span>

<h3>Description</h3>

<p>Performs the fit of parametric models via likelihood method.
Serial dependence and random intercept are allowed according to the stochastic model chosen.
Missing values and unbalanced data are automatically accounted for computing the
likelihood function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bild(formula = formula(data), data, time, id, subSET,
aggregate = FALSE, start = NULL, trace = FALSE,
dependence="ind", method = "BFGS",
control = bildControl(), integrate = bildIntegrate())</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bild_+3A_formula">formula</code></td>
<td>
<p>a description of the model to be fitted of the form response~predictors</p>
</td></tr>
<tr><td><code id="bild_+3A_data">data</code></td>
<td>
<p>a <code>data</code> frame containing the variables in the formula. NA values are allowed.
If data is missing, an error message is produced. See &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="bild_+3A_time">time</code></td>
<td>
<p>a string that matches the name of the <code>time</code> variable in data. By default, the program expects a variable named <code>time</code>
to be present in the <code>data.frame</code>, otherwise the name of the variable playing the role of time must be declared by assigning <code>time</code> here. </p>
</td></tr>
<tr><td><code id="bild_+3A_id">id</code></td>
<td>
<p>a string that matches the name of the <code>id</code> variable in <code>data</code>. By default, the program expects a variable named <code>id</code>
to be present in the <code>data.frame</code>, otherwise the name of the variable playing the role of <code>id</code> must be declared by assigning <code>id</code> here. </p>
</td></tr>
<tr><td><code id="bild_+3A_subset">subSET</code></td>
<td>
<p>an optional expression indicating the subset of the rows of <code>data</code> that should be
used in the fit. All observations are included by default.</p>
</td></tr>
<tr><td><code id="bild_+3A_aggregate">aggregate</code></td>
<td>
<p>a string that permits the user identify the factor to be used in <code><a href="#topic+plot-methods">plot-methods</a></code>.</p>
</td></tr>
<tr><td><code id="bild_+3A_start">start</code></td>
<td>
<p>a vector of initial values for the nuisance parameters of the likelihood. The dimension of the vector is according
to the structure of the dependence model.</p>
</td></tr>
<tr><td><code id="bild_+3A_trace">trace</code></td>
<td>
<p>logical flag: if TRUE, details of the nonlinear optimization are printed. By default the flag is set to FALSE.</p>
</td></tr>
<tr><td><code id="bild_+3A_dependence">dependence</code></td>
<td>
<p>expression stating which <code>dependence</code> structure should be used in the fit. The default is &quot;ind&quot;.
According to the stochastic model chosen serial dependence and random effects are allowed.
There are six options: &quot;<code>ind</code>&quot; (independence), &quot;<code>MC1</code>&quot; (first order Markov Chain), &quot;<code>MC2</code>&quot; (second order Markov Chain),
&quot;<code>indR</code>&quot; (independence with random intercept),  &quot;<code>MC1R</code>&quot; (first order Markov Chain with random intercept) or
&quot;<code>MC2R</code>&quot; (second order Markov Chain with random intercept).</p>
</td></tr>
<tr><td><code id="bild_+3A_method">method</code></td>
<td>
<p>The <code>method</code> used in the optimization process: &quot;<code>BFGS</code>&quot;,&quot;<code>CG</code>&quot;, &quot;<code>L-BFGS-B</code>&quot; and &quot;<code>SANN</code>&quot;.
The default is &quot;<code>BFGS</code>&quot;.
See <code><a href="stats.html#topic+optim">optim</a></code> for details.</p>
</td></tr>
<tr><td><code id="bild_+3A_control">control</code></td>
<td>
<p>a list of algorithmic constants for the optimizer <code>optim</code>.
See R documentation of <code>optim.control</code> for details and possible control options. By default, <code>bild</code> sets the maximum number
of iterations (<code>maxit</code>) equal to 100, the absolute convergence tolerance (<code>abstol</code>) and the relative
convergence tolerance (<code>rel.tol</code>) equal to 1e-6 and uses the <code><a href="stats.html#topic+optim">optim</a></code> standard default values for the remaining options.</p>
</td></tr>
<tr><td><code id="bild_+3A_integrate">integrate</code></td>
<td>
<p>a list of algorithmic constants for the computation of a definite integral using a Fortran-77 subroutine. See &quot;Details&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>data</code> are contained in a <code>data.frame</code>. Each element of the <code>data</code> argument must be identifiable by a name.
The simplest situation occurs when all subjects are observed at the same time points.
The response variable represent the individual profiles of each subject, it is expected
a variable in the <code>data.frame</code> that identifies the correspondence of each component of the response variable to the subject that it belongs,
by default is named <code>id</code> variable. It is expected a variable named <code>time</code> to be present in the <code>data.frame</code>.
If the <code>time</code> component has been given a different name, this should be declared.
The <code>time</code> variable should identify the time points that each individual profile has been observed.
</p>
<p>When it is expected that all subjects in one experiment to be observed at the same time points, but in practice some of the subjects were
not observed in some of the scheduled occasions, NA values can then be inserted in the response variable.
If a response profile is replicated several times, a variable called <code>counts</code> must be created accordingly.
This vector is used for weighting the response profile indicating for each individual profile the number of times that is replicated.
The vector <code>counts</code> must repeat the number of the observed replications of each individual profile as many times as the number of observed time
points for the correspondent profile. The program expect such vector to be named <code>counts</code>.
If each profile has been observed only once, the construction of the vector <code>counts</code> is not required.
</p>
<p><code>subSET</code> is an optional expression indicating the subset of <code>data</code> that should be
used in the fit. This is a logical statement of the type
<code>variable 1</code> == &quot;a&quot; &amp; <code>variable 2</code> &gt; x
which identifies the observations to be selected. All observations are included by default.
</p>
<p>For the models with random intercept <code>indR</code>, <code>MC1R</code> and <code>MC2R</code>,
<code>bild</code> compute integrals based on a Fortran-77 subroutine package
<code>QUADPACK</code>. For some data sets, when the dependence structure has
a random intercept term, the user could have the need to do a specification
of the <code>integrate</code> argument list changing
the integration limits in the <code>bildIntegrate</code> function.
The <code><a href="#topic+bildIntegrate">bildIntegrate</a></code> is an auxiliary function for controlling <code>bild</code>
fitting. See the example of <code><a href="#topic+locust">locust</a></code> data.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+bild-class">bild</a></code>.</p>


<h3>Background</h3>

<p>Assume that each subject of a given set has been observed at number of
successive time points. For each subject and for each time point, a binary
response variable, taking value 0 and 1, and a set of covariates are
recorded.
The underlying methodology builds a logistic regression model for the
probability that the response variable  takes value 1
as a function of the  covariates, taking into account that successive
observations from the same individual cannot be assumed to be independent.
</p>
<p>The basic model for serial dependence is of Markovian type of the first order
(denoted <code>MC1</code> here), suitably constructed so that the logistic regression
parameters maintain the same meaning as in ordinary logistic regression for
independent observations. The serial dependence parameter is the logarithm of
the odds-ratio between probabilities of adjacent observations, which is
assumed to be constant for all adjacent pairs, and it is denoted here
<code>log.psi1</code>.
</p>
<p>An extension of this formulation allows a Markovian dependence of the second
order, denoted <code>MC2</code> here.  In this case there are two parameters which
regulate serial dependence: <code>log.psi1</code> as before and <code>log.psi2</code>
which is the analogous quantity for observations which are two time units apart,
conditionally on the intermediate value.
</p>
<p>Individual random effects can be incorporated in the form of a random
intercept term of the linear predictor of the logistic regression,
assuming a normal distribution of mean 0 and variance <code class="reqn">\sigma^2</code>,
parameterized as <code class="reqn">\omega=\log(\sigma^2)</code>.
The combination of serial Markov dependence with a random intercept corresponds here
to the dependence structures <code>MC1R</code> and <code>MC2R</code>.
The combination of an independence structure with a random intercept is also allowed
setting the dependence structure to <code>indR</code>.
</p>
<p>Original sources of the above formulation are given by Azzalini (1994), as for the first order Markov dependence, and by Goncalves (2002) and Goncalves and Azzalini (2008) for the its extensions.
</p>


<h3>Author(s)</h3>

<p>M. Helena Goncalves, M. Salome Cabral and Adelchi Azzalini</p>


<h3>References</h3>

<p>Azzalini, A. (1994). Logistic regression for autocorrelated data with application to repeated measures.
<em>Biometrika</em>, 81, 767-775. Amendment: (1997) vol. 84, 989.
</p>
<p>Goncalves, M. Helena (2002). <em> Likelihood methods for discrete longitudinal data</em>. PhD thesis, Faculty of Sciences, University of Lisbon.
</p>
<p>Goncalves, M. Helena and Azzalini, A. (2008). Using Markov chains for marginal modelling of binary longitudinal data
in an exact likelihood approach. <em>Metron</em>, vol LXVI, 2, 157-181.
</p>
<p>Goncalves, M. Helena and Cabral, M. Salome and Azzalini,  Adelchi (2012). The R Package <code>bild</code> for the Analysis of Binary Longitudinal Data. <em>Journal of Statistical Software</em>, 46(9), 1-17.</p>


<h3>See Also</h3>

<p><code><a href="#topic+bild-class">bild-class</a></code>, <code><a href="#topic+bildControl">bildControl</a></code>, <code><a href="#topic+bildIntegrate">bildIntegrate</a></code>, <code><a href="stats.html#topic+optim">optim</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  
## Are the examples used in respective dataset files

#####  data= airpollution, dependence="MC2R"
str(airpollution)

air2r &lt;- bild(wheeze~age+smoking, data=airpollution, trace=TRUE,
    time="age", aggregate=smoking, dependence="MC2R")

summary(air2r)
getAIC(air2r)
getLogLik(air2r)
plot(air2r)

####  data=muscatine, dependence="MC2"
str(muscatine)

# we decompose the time effect in orthogonal components
muscatine$time1 &lt;- c(-1, 0, 1)
muscatine$time2 &lt;- c(1, -2, 1)

musc2 &lt;- bild(obese~(time1+time2)*sex, data=muscatine,
    time="time1", aggregate=sex, trace=TRUE, dependence="MC2")

summary(musc2)
getAIC(musc2)
getLogLik(musc2)
</code></pre>

<hr>
<h2 id='bild-class'>Class &quot;bild&quot; for Results of a Maximum Likelihood Estimation</h2><span id='topic+bild-class'></span>

<h3>Description</h3>

<p>This class encapsulates results of a maximum likelihood procedure.</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("bild", ...)</code>, 
but most often as the result of a call to <code><a href="#topic+bild">bild</a></code>.</p>


<h3>Slots</h3>


<dl>
<dt><code>coefficients</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Estimated parameters.</p>
</dd>
<dt><code>se</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Standard errors of estimated parameters.</p>
</dd>
<dt><code>covariance</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Covariance of estimated parameters.</p>
</dd>
<dt><code>correlation</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Correlation of estimated parameters.</p>
</dd>
<dt><code>log.likelihood</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The value of the log likelihood.</p>
</dd>
<dt><code>message</code>:</dt><dd><p>Object of class <code>"integer"</code>. A character string giving any additional information returned by the optimizer, or NULL. 
See <code><a href="stats.html#topic+optim">optim</a></code> for details.</p>
</dd>
<dt><code>n.cases</code>:</dt><dd><p>Object of class <code>"numeric"</code>. Number of individual profiles used in the optimization procedure.</p>
</dd>
<dt><code>ni.cases</code>:</dt><dd><p>Object of class <code>"numeric"</code>. Number of individual profiles in the dataset.</p>
</dd>
<dt><code>aic</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The Akaike information criterion for a fitted model object.</p>
</dd>
<dt><code>residuals</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The residuals of estimated parameters.</p>
</dd>
<dt><code>s.residuals</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The residuals of estimated parameters summed over the individual profile.</p>
</dd>
<dt><code>ind.probability</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The transitions probabilities.</p>
</dd>
<dt><code>prob.matrix</code>:</dt><dd><p>Object of class <code>"matrix"</code>. The matrix of transitions probabilities.</p>
</dd>
<dt><code>Fitted</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The fitted values for the estimated parameters.</p>
</dd>
<dt><code>bi.estimate</code>:</dt><dd><p>Object of class <code>"matrix"</code>. The estimated values for the individual random effects.</p>
</dd>
<dt><code>Fitted.av</code>:</dt><dd><p>Object of class <code>"numeric"</code>. </p>
</dd>
<dt><code>Time</code>:</dt><dd><p>Object of class <code>"numeric"</code>. Vector of time points.</p>
</dd>
<dt><code>model.matrix</code>:</dt><dd><p>Object of class <code>"matrix"</code>. The model matrix.</p>
</dd>
<dt><code>y.matrix</code>:</dt><dd><p>Object of class <code>"matrix"</code>. The matrix of response values.</p>
</dd>
<dt><code>subset.data</code>:</dt><dd><p>Object of class <code>"data.frame"</code>. The data subset if considered.</p>
</dd>
<dt><code>y.av</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The average of the response value over an individual profile.</p>
</dd>
<dt><code>f.value</code>:</dt><dd><p>Object of class <code>"factor"</code>. Indicates the <code>aggregation</code> factor if present.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code>. The call to <code>"bild"</code>.</p>
</dd> 
</dl>



<h3>Methods</h3>


<dl>
<dt>anova</dt><dd><p><code>signature(object="bild")</code>: Display anova table.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x="bild", y="missing")</code>: Plots six type of plots.</p>
</dd>
<dt>show</dt><dd><p><code>signature(object="bild")</code>: Display object briefly.</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object="bild")</code>: Generate object summary.</p>
</dd>
<dt>getAIC</dt><dd><p><code>signature(object="bild")</code>: Returns a numeric value corresponding to the AIC of the fitted model.</p>
</dd>
<dt>getLogLik</dt><dd><p><code>signature(object="bild")</code>: Returns a numeric value corresponding to the log-Likelihood of the fitted model.</p>
</dd>
<dt>fitted</dt><dd><p><code>signature(object="bild")</code>: The fitted values of a fitted model.</p>
</dd>
<dt>fixeff</dt><dd><p><code>signature(object="bild")</code>: 
The values corresponding to the fixed effects of a fitted model.</p>
</dd> 
<dt>getcoef</dt><dd><p><code>signature(object="bild")</code>: The values corresponding to the coefficient estimates of the fitted model.</p>
</dd>
<dt>getvcov</dt><dd><p><code>signature(object="bild")</code>: The variance-covariance matrix of the fitted model.</p>
</dd>
<dt>model.mat</dt><dd><p><code>signature(object="bild")</code>: The fixed effects model matrix of the fitted model.</p>
</dd>
<dt>randeff</dt><dd><p><code>signature(object="bild")</code>: A data frame corresponding to the conditional random effects of the fitted model.</p>
</dd>
<dt>vareff</dt><dd><p><code>signature(object="bild")</code>: Numeric value corresponding to the estimated random effect variance of the fitted model.</p>
</dd>
</dl>


<hr>
<h2 id='bild-internal'>Internal functions</h2><span id='topic+mblik1'></span><span id='topic+mbgd1'></span><span id='topic+integ1'></span><span id='topic+gint1'></span><span id='topic+blik2m'></span><span id='topic+bgd2m'></span><span id='topic+integ'></span><span id='topic+gint'></span><span id='topic+gradlogL.bin0'></span><span id='topic+gradlogL.bin0I'></span><span id='topic+gradlogL.bin1'></span><span id='topic+gradlogL.bin1I'></span><span id='topic+gradlogL.bin2'></span><span id='topic+gradlogL.bin2I'></span><span id='topic+logL.bin0'></span><span id='topic+logL.bin0.aux'></span><span id='topic+logL.bin0I'></span><span id='topic+logL.bin0I.aux'></span><span id='topic+logL.bin1'></span><span id='topic+logL.bin1.aux'></span><span id='topic+logL.bin1I'></span><span id='topic+logL.bin1I.aux'></span><span id='topic+logL.bin2'></span><span id='topic+logL.bin2.aux'></span><span id='topic+logL.bin2I'></span><span id='topic+logL.bin2I.aux'></span><span id='topic+num.info'></span><span id='topic+num.infoI'></span>

<h3>Description</h3>

<p>Functions for internal usage only.</p>

<hr>
<h2 id='bildControl'>Auxiliary for Controlling &quot;bild&quot; Fitting</h2><span id='topic+bildControl'></span>

<h3>Description</h3>

<p>Auxiliary function as user interface for <code>bild</code> fitting </p>


<h3>Usage</h3>

<pre><code class='language-R'>bildControl(maxit = 100, abstol = 1e-006, reltol = 1e-006)</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="bildControl_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>      
<tr><td><code id="bildControl_+3A_abstol">abstol</code></td>
<td>
<p>absolute convergence tolerance.</p>
</td></tr>     
<tr><td><code id="bildControl_+3A_reltol">reltol</code></td>
<td>
<p>relative convergence tolerance.</p>
</td></tr>
</table>


<h3>Details</h3>

          
<p>See R documentation of <code><a href="stats.html#topic+optim">optim</a></code> for details of standard default values 
for the remaining options not cosidered in <code>bildControl</code>.              
</p>


<h3>Value</h3>

<p>A list with the arguments as components.</p>


<h3>See Also</h3>

<p><code><a href="#topic+bild-class">bild-class</a></code>, <code><a href="stats.html#topic+optim">optim</a></code></p>

<hr>
<h2 id='bildIntegrate'> Auxiliary for Controlling &quot;bild&quot; Fitting</h2><span id='topic+bildIntegrate'></span>

<h3>Description</h3>

<p>Auxiliary function as user interface for <code>bild</code> fitting </p>


<h3>Usage</h3>

<pre><code class='language-R'>bildIntegrate(li=-4,ls=4, epsabs=.Machine$double.eps^.25, 
epsrel=.Machine$double.eps^.25,limit=100,key=6,lig=-4,lsg=4) </code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="bildIntegrate_+3A_li">li</code></td>
<td>
<p>lower limit of integration for the log-likelihood.</p>
</td></tr>                                                                 
<tr><td><code id="bildIntegrate_+3A_ls">ls</code></td>
<td>
<p>upper limit of integration for the log-likelihood.</p>
</td></tr>                                                                 
<tr><td><code id="bildIntegrate_+3A_epsabs">epsabs</code></td>
<td>
<p>absolute accuracy requested.</p>
</td></tr>                                                                                  
<tr><td><code id="bildIntegrate_+3A_epsrel">epsrel</code></td>
<td>
<p>relative accuracy requested.</p>
</td></tr>                                                                                 
<tr><td><code id="bildIntegrate_+3A_key">key</code></td>
<td>
<p>integer from 1 to 6 for choice of local integration rule for number of Gauss-Kronrod quadrature points.          
A gauss-kronrod pair is used with: <br />                                                                                             
7 - 15 points if key = 1, <br />                                                                                                      
10 - 21 points if key = 2,<br />                                                                                                      
15 - 31 points if key = 3,<br />                                                                                                      
20 - 41 points if key = 4,<br />                                                                                                      
25 - 51 points if key = 5 and <br />                                                                                                  
30 - 61 points if key = 6.</p>
</td></tr>                                                                                                        
<tr><td><code id="bildIntegrate_+3A_limit">limit</code></td>
<td>
<p>integer that gives an upperbound on the number of subintervals in the partition                                
of (<code>li</code>,<code>ls</code>), limit.ge.1.</p>
</td></tr>                                                                                            
<tr><td><code id="bildIntegrate_+3A_lig">lig</code></td>
<td>
<p>lower limit of integration for the gradient.</p>
</td></tr>                                                                    
<tr><td><code id="bildIntegrate_+3A_lsg">lsg</code></td>
<td>
<p>upper limit of integration for the gradient.</p>
</td></tr>                                                                    
</table>


<h3>Details</h3>

       
<p><code>bildIntegrate</code> returns a list of constants that are used to compute integrals based on a Fortran-77 subroutine <code>dqage</code> from a   
Fortran-77 subroutine package <code>QUADPACK</code> for the numerical computation of definite one-dimensional integrals.              
The subroutine <code>dqage</code> is a simple globally adaptive integrator in which it is possible to choose between 6 pairs          
of Gauss-Kronrod quadrature formulae for the rule evaluation component. The source code <code>dqage</code> was modified and re-named  
<code>dqager</code>, the change was the introduction of an extra variable that allow, in our Fortran-77 subroutines when              
have a call to <code>dqager</code>, to control for which parameter the integral is computed.
</p>
<p>For given values of <code>li</code> and <code>ls</code>, the above-described
numerical integration is performed over the interval 
(<code>li</code>*<code class="reqn">\sigma</code>, <code>ls</code>*<code class="reqn">\sigma</code>), where <code class="reqn">\sigma=\exp(\omega)/2</code>
is  associated to the current parameter value <code class="reqn">\omega</code> examined by
the <code>optim</code> function.  In some cases, this integration may
generate an error, and the user must suitably adjust the values of <code>li</code> 
and <code>ls</code>. In case different choices of these quantities all
lead to a successful run, it is recommended to retain the one with
largest value of the log-likelihood. Integration of the gradient is
regulated similarly by <code>lig</code> and <code>lsg</code>.
</p>
<p>For datasets where the individual profiles have a high number of 
observed time points (say, more than 30), 
use <code>bildIntegrate</code> function to set the integration limits for the 
likelihood and for the gradient to small values 
than the default ones, see the example of <code><a href="#topic+locust">locust</a></code> data. 
</p>
<p>If fitting procedure is complete but when computing the information matrix 
some NaNs are produced, the change in <code>bildIntegrate</code> function of the default values 
for the gradient integration limits (<code>lig</code> and <code>lsg</code>) might solve this problem.
</p>


<h3>Value</h3>

<p>A list with the arguments as components.</p>


<h3>See Also</h3>

<p><code><a href="#topic+bild-class">bild-class</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  
## It takes a very long time to run

####  data=locust, dependence="MC2R"                                                   
str(locust)                                                                            
                                                                                       
Integ &lt;- bildIntegrate(li=-2.5,ls=2.5, lig=-2.5, lsg=2.5)                              
locust2r_feed1 &lt;- bild(move~(time+I(time^2))*sex, data=locust,              
    trace=TRUE, subSET=feed=="1", aggregate=sex, dependence="MC2R",                    
    integrate=Integ)                                                                   
                                                                                       
summary(locust2r_feed1)                                                                
getAIC(locust2r_feed1)                                                                 
getLogLik(locust2r_feed1)                                                              
plot(locust2r_feed1)                                                                   
</code></pre>

<hr>
<h2 id='fitted-methods'>Methods for function <code>fitted</code></h2><span id='topic+fitted-methods'></span><span id='topic+fitted+2Cbild-method'></span>

<h3>Description</h3>

<p>Methods for function <code>fitted</code> extracting fitted values of a fitted model object from class <code><a href="#topic+bild-class">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
fitted(object)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="fitted-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object="bild")</code>:</dt><dd><p>fitted for <code><a href="#topic+bild">bild</a></code> object.</p>
</dd> 
</dl>

<hr>
<h2 id='fixeff'>Extract fixed effects estimates</h2><span id='topic+fixeff'></span>

<h3>Description</h3>

<p> Methods for function <code>fixeff</code> extracting fixed effects estimates of a fitted model object from class <code><a href="#topic+bild">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>fixeff(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixeff_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Extract fixed effects estimates.</p>

<hr>
<h2 id='fixeff-methods'>Methods for function <code>fixeff</code></h2><span id='topic+fixeff-methods'></span><span id='topic+fixeff+2Cbild-method'></span>

<h3>Description</h3>

<p>Methods for function <code>fixeff</code> extracting fixed effects estimates of a fitted model object from class <code><a href="#topic+bild-class">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
fixeff(object)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="fixeff-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object="bild")</code>:</dt><dd><p> fixed effects estimates of a fitted model for <code><a href="#topic+bild">bild</a></code> object.</p>
</dd> 
</dl>

<hr>
<h2 id='getAIC'>Extract the Akaike Information Criterion</h2><span id='topic+getAIC'></span>

<h3>Description</h3>

<p>Methods for function <code>getAIC</code> extracting the Akaike information criterion 
for one fitted model object from class <code><a href="#topic+bild">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>getAIC(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getAIC_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns a numeric value corresponding to the AIC of the fitted model.</p>

<hr>
<h2 id='getAIC-methods'>Extract the Akaike Information Criterion</h2><span id='topic+getAIC-methods'></span><span id='topic+getAIC+2Cbild-method'></span>

<h3>Description</h3>

<p>Methods for function <code>getAIC</code> extracting the Akaike information criterion 
for one fitted model object from class <code><a href="#topic+bild-class">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
getAIC(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getAIC-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns a numeric value corresponding to the AIC of the fitted model.</p>


<h3>Methods</h3>

 
<dl>
<dt>getAIC</dt><dd><p><code>signature(object="bild")</code>:Returns a numeric value corresponding to the AIC of the fitted model.</p>
</dd>   
</dl>

<hr>
<h2 id='getcoef'>Extract the coefficient estimates</h2><span id='topic+getcoef'></span>

<h3>Description</h3>

<p>Methods for function <code>getcoef</code> extracting the coefficient estimates of the fitted model object from class <code><a href="#topic+bild">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>getcoef(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getcoef_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns the coefficient estimates of the fitted model.</p>

<hr>
<h2 id='getcoef-methods'>Methods for function <code>getcoef</code></h2><span id='topic+getcoef-methods'></span><span id='topic+getcoef+2Cbild-method'></span>

<h3>Description</h3>

<p>Methods for function <code>getcoef</code> extracting the coefficient estimates of the fitted model object from class <code><a href="#topic+bild-class">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
getcoef(object)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="getcoef-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object="bild")</code>:</dt><dd><p>Returns the coefficient estimates of the fitted model <code><a href="#topic+bild">bild</a></code> object.</p>
</dd> 
</dl>

<hr>
<h2 id='getLogLik'>Extract Log-Likelihood</h2><span id='topic+getLogLik'></span>

<h3>Description</h3>

<p>Methods for function <code>getLogLik</code> extracting the Log-Likelihood 
for one fitted model object from class <code><a href="#topic+bild-class">bild</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLogLik(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLogLik_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns a numeric value corresponding to the log-Likelihood of the fitted model.</p>

<hr>
<h2 id='getLogLik-methods'>Extract Log-Likelihood</h2><span id='topic+getLogLik-methods'></span><span id='topic+getLogLik+2Cbild-method'></span>

<h3>Description</h3>

<p>Methods for function <code>getLogLik</code> extracting the Log-Likelihood 
for one fitted model object from class <code><a href="#topic+bild-class">bild</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
getLogLik(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLogLik-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns a numeric value corresponding to the log-Likelihood of the fitted model.</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object="bild")</code>:</dt><dd><p>Returns a numeric value corresponding to the log-Likelihood of the fitted model.</p>
</dd>
</dl>

<hr>
<h2 id='getvcov'>Extract variance-covariance matrix</h2><span id='topic+getvcov'></span>

<h3>Description</h3>

<p>Extract the variance-covariance matrix of a fitted model object from class <code><a href="#topic+bild-class">bild</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getvcov(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getvcov_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns a numeric value corresponding to the variance-covariance matrix.</p>

<hr>
<h2 id='getvcov-methods'>Methods for function <code>getvcov</code></h2><span id='topic+getvcov-methods'></span><span id='topic+getvcov+2Cbild-method'></span>

<h3>Description</h3>

<p>Extract the variance-covariance matrix of a fitted model object from class <code><a href="#topic+bild-class">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
getvcov(object)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="getvcov-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object="bild")</code>:</dt><dd><p>Returns a numeric value corresponding to the variance-covariance matrix of the fixed effect estimates of the fitted model 
<code><a href="#topic+bild">bild</a></code> object.</p>
</dd> 
</dl>

<hr>
<h2 id='locust'>Locust</h2><span id='topic+locust'></span>

<h3>Description</h3>

<p>This data set was presented by MacDonald and Raubenheimer (1995) 
and analyze the effect of hunger on locomotory behaviour of 24 locust (<em>Locusta migratoria</em>) 
observed at 161 time points. The subjects were divided in two treatment groups (&quot;fed&quot; and &quot;not fed&quot;), 
and within each of the two groups, the subjects were alternatively &quot;male&quot; and &quot;female&quot;. 
For the purpose of this analysis the categories of the response variable 
were &quot;moving&quot; and &quot;not moving&quot;. During the observation period, the behavior of each of the subjects was 
registered every thirty seconds.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(locust)</code></pre>


<h3>Format</h3>

<p>A data frame with 3864 observations on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>a numeric vector that identifies de number of the individual profile.</p>
</dd>
<dt><code>move</code></dt><dd><p>a numeric vector representing the response variable.</p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor with levels <code>1</code> for &quot;male&quot; and <code>0</code> for &quot;female&quot;. </p>
</dd>
<dt><code>time</code></dt><dd><p>a numeric vector that identifies de number of the time points observed. 
The <code>time</code> vector considered was obtained dividing (1:161) by 120 (number of observed periods in 1 hour).</p>
</dd>
<dt><code>feed</code></dt><dd><p>a factor with levels <code>0</code> &quot;no&quot; and <code>1</code> &quot;yes&quot;.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The response variable, <code>move</code> is the binary type coded as <code>1</code> for &quot;moving&quot; and <code>0</code> for &quot;not moving&quot;. 
The <code>sex</code> covariate was coded as <code>1</code> for &quot;male&quot; and <code>0</code> for &quot;female&quot;. The <code>feed</code> covariate indicating the treatment group,  
was coded as <code>1</code> for &quot;fed&quot; and <code>0</code> for &quot;not fed&quot;. Azzalini and Chiogna (1997) also have analyze this 
data set using their <code>S-plus</code> package <code>rm.tools</code>. </p>


<h3>Source</h3>

<p>MacDonald, I. and Raubenheimer, D. (1995). Hidden Markov models and animal behaviour. 
<em>Biometrical Journal</em>, 37, 701-712</p>


<h3>References</h3>

<p>Azzalini, A. and Chiogna, M. (1997). S-Plus Tools for the Analysis of Repeated Measures Data. 
<em>Computational Statistics</em>, 12, 53-66</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(locust)


####  dependence="MC2"
locust2_feed1 &lt;- bild(move~(time+I(time^2))*sex, data=locust, 
   subSET=feed=="1", aggregate=sex, dependence="MC2")

summary(locust2_feed1)

plot(locust2_feed1, which=5, ylab="probability of locomoting", 
    main="Feed=1", add.unadjusted=TRUE)

locust2 &lt;- bild(move~(time+I(time^2))*feed, data=locust,  
        aggregate=feed, dependence="MC2")

par(mfrow=c(2,2))
plot(locust2, which=1)
plot(locust2, which=2)
plot(locust2, which=3)
plot(locust2, which=4)
par(mfrow=c(1,1))

plot(locust2, which=5, ylab="probability of locomoting", 
    add.unadjusted=TRUE)

</code></pre>

<hr>
<h2 id='model.mat'>Extract the fixed effects model matrix</h2><span id='topic+model.mat'></span>

<h3>Description</h3>

<p>Methods for function <code>model.mat</code> extracting the fixed effects model matrix for a fitted model object from class <code><a href="#topic+bild-class">bild</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>model.mat(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.mat_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns a numeric value corresponding to the fixed effects model matrix.</p>

<hr>
<h2 id='model.mat-methods'>Methods for function <code>model.mat</code></h2><span id='topic+model.mat-methods'></span><span id='topic+model.mat+2Cbild-method'></span>

<h3>Description</h3>

<p>Methods for function <code>model.mat</code> extracting the fixed effects model matrix for a fitted model object from class <code><a href="#topic+bild-class">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
model.mat(object)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="model.mat-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object="bild")</code>:</dt><dd><p>Returns the fixed effects model matrix of the fitted model object from class <code><a href="#topic+bild-class">bild</a></code>.</p>
</dd>
</dl>

<hr>
<h2 id='muscatine'>Muscatine</h2><span id='topic+muscatine'></span>

<h3>Description</h3>

<p>This example is a subset of data from the Muscatine Coronary Risk Factor Study, a longitudinal 
study of coronary risk factors in school children from Muscatine (Iowa, USA). </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(muscatine)</code></pre>


<h3>Format</h3>

<p>A data frame with 156 observations on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>identifies de number of the individual profile. This vector contains observation of 52 individuals.</p>
</dd>
<dt><code>obese</code></dt><dd><p>a numeric vector that identify the obesity status (1=&quot;yes&quot;, 0=&quot;no&quot;) of a child at each occasion. </p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor with levels <code>1</code> for &quot;female&quot; and <code>0</code> for &quot;male&quot;. </p>
</dd>
<dt><code>time</code></dt><dd><p>a numeric vector (1,2,3) indicating the observed time points.</p>
</dd>
<dt><code>counts</code></dt><dd><p>a numeric vector indicating the number of times that each profile is replicated.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data set presented by Fitzmaurice, Laird and Lipsitz (1994) contains records 
on 1014 children who were 7-9 years old in 1977 and were examined in 1977, 1979 and 1981. 
Height and weight were measured in each survey year, and those with relative weight greater 
than 110
The binary response of interest is whether the child is obese (1) or not (0). However, many 
data records are incomplete, since not all children participate in all the surveys. This data set 
was also analyzed by Azzalini (1994).</p>


<h3>Source</h3>

<p> Fitzmaurice, G. M.,  Laird, N. M. and Lipsitz, S. R. (1994). Analyzing incomplete 
longitudinal binary responses: a likelihood based approach. <em>Biometrics</em>, 38, 602-612.</p>


<h3>References</h3>

<p>Azzalini, A. (1994). Logistic regression for autocorrelated data with 
application to repeated measures. <em>Biometrika</em>, 81, 767-775.</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(muscatine)

# we decompose the time effect in orthogonal components
muscatine$time1 &lt;- c(-1, 0, 1)
muscatine$time2 &lt;- c(1, -2, 1)

# second order Markov Chain without random effects
musc2 &lt;- bild(obese~(time1+time2)*sex, data=muscatine,  
    time="time1", aggregate=sex, trace=TRUE, dependence="MC2")

summary(musc2)
getAIC(musc2)
getLogLik(musc2)
fitted(musc2)

</code></pre>

<hr>
<h2 id='plot-methods'>Methods for Function plot in Package &quot;bild&quot;</h2><span id='topic+plot-methods'></span><span id='topic+plot+2Cbild+2Cmissing-method'></span>

<h3>Description</h3>

<p>Six plots (selectable by <code>which</code>) are currently available: a plot of residuals against fitted values (<code>which</code>=1), 
a plot of standardized residuals against time (<code>which</code>=2), a plot of the autocorrelation function of the residuals (<code>which</code>=3),  
a plot of the partial autocorrelation function of the residuals (<code>which</code>=4), a plot for the fitted model (<code>which</code>=5) 
and a plot for the individual mean profile (<code>which</code>=6). By default, the first five are provided. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild,missing'
plot(x,which=c(1:5),ylab=NULL,main=NULL, 
    ask=prod(par("mfcol"))&lt;length(which)&amp;&amp;dev.interactive(), 
    subSET,add.unadjusted=FALSE,ident=FALSE, 
    caption=c("Residuals vs Fitted", "Residuals vs Time", 
    "ACF residuals", "PACF residuals", 
    "Individual mean profiles"), cex.caption=1)</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+bild">bild</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_which">which</code></td>
<td>
<p>if a subset of the plots is required, specify a subset of the numbers 1:6.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_ylab">ylab</code></td>
<td>
<p>label to some plots (<code>which</code>=5 and 6).</p>
</td></tr>  
<tr><td><code id="plot-methods_+3A_main">main</code></td>
<td>
<p>title to some plots in addition to the caption (<code>which</code>=5 and 6).</p>
</td></tr> 
<tr><td><code id="plot-methods_+3A_ask">ask</code></td>
<td>
<p>logical expression; if TRUE, the user is asked before each plot.</p>
</td></tr>   
<tr><td><code id="plot-methods_+3A_subset">subSET</code></td>
<td>
<p>logical expression indicating elements to keep in individual mean profile plots: missing values are taken as FALSE. 
The <code>subSET</code> argument is only for option <code>which</code>=6.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_add.unadjusted">add.unadjusted</code></td>
<td>
<p>logical expression indicating whether or not to add the unadjusted fit for plot in <code>which</code>=5.</p>
</td></tr>     
<tr><td><code id="plot-methods_+3A_ident">ident</code></td>
<td>
<p>logical expression indicating whether or not to add the number of the subject to individual mean profile plots.
The <code>ident</code> argument is only for option <code>which</code>=6.</p>
</td></tr> 
<tr><td><code id="plot-methods_+3A_caption">caption</code></td>
<td>
<p>captions to appear above the plots.</p>
</td></tr>   
<tr><td><code id="plot-methods_+3A_cex.caption">cex.caption</code></td>
<td>
<p>controls the size of caption.</p>
</td></tr>   
</table>


<h3>Details</h3>

   
<p>The option <code>which</code>=5 provides the parametric fitted model if the dependence structure is  
&quot;ind&quot; (independence), &quot;MC1&quot; (first order Markov Chain) or &quot;MC2&quot; (second order Markov Chain). 
When the dependence structure is 
&quot;indR&quot; (independence with random intercept) or 
&quot;MC1R&quot; (first order Markov Chain with random intercept) or 
&quot;MC2R&quot; (second order Markov Chain with random intercept) the parametric adjusted fit is provided and     
the user can set <code>add.unadjusted</code>=TRUE to provide the unadjusted fitted. 
The option <code>which</code>=6 is used only if the random intercept is present and provides individual mean profile.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x="ANY", y="ANY")</code>:</dt><dd><p>Generic function.</p>
</dd>
<dt><code>signature(x="bild", y="missing")</code>:</dt><dd><p>Plot diagnostics for <code><a href="#topic+bild">bild</a></code> object.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'> 
## It takes a very long time to run
str(locust)

####  dependence="MC2R"
Integ &lt;- bildIntegrate(li=-2.5,ls=2.5, lig=-2.5, lsg=2.5)   
locust2r_feed1 &lt;- bild(move~(time+I(time^2))*sex, data=locust, 
    subSET=feed=="1", aggregate=sex, dependence="MC2R",  
    integrate=Integ)
    


summary(locust2r_feed1)

plot(locust2r_feed1, which=5, ylab="probability of locomoting",
     add.unadjusted=TRUE)

plot(locust2r_feed1, which=6, subSET=sex=="1", 
    main="sex==1 &amp; Feed=1", ident=TRUE)

locust2r &lt;- bild(move~(time+I(time^2))*feed,data=locust, 
    trace=TRUE, aggregate=feed, dependence="MC2R", 
    integrate=Integ)

par(mfrow=c(2,2))
plot(locust2r, which=1)
plot(locust2r, which=2)
plot(locust2r, which=3)
plot(locust2r, which=4)
par(mfrow=c(1,1))

plot(locust2r, which=5, ylab="probability of locomoting", 
    main="Feed &amp; Unfeed groups", add.unadjusted=TRUE)

plot(locust2r, which=6, ylab="probability of locomoting",
    main="Fed &amp; Unfed groups", ident=TRUE)
</code></pre>

<hr>
<h2 id='randeff'>Extract conditional random effects</h2><span id='topic+randeff'></span>

<h3>Description</h3>

<p> Methods for function <code>randeff</code> extracting conditional random effects of a fitted model object from class <code><a href="#topic+bild-class">bild</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>randeff(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randeff_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns a data.frame corresponding to the conditional random effects of the fitted model.</p>

<hr>
<h2 id='randeff-methods'>Methods for function <code>randeff</code></h2><span id='topic+randeff-methods'></span><span id='topic+randeff+2Cbild-method'></span>

<h3>Description</h3>

<p>Methods for function <code>randeff</code> extracting conditional random effects of a fitted model object from class  <code><a href="#topic+bild-class">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
randeff(object)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="randeff-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object="bild")</code>:</dt><dd><p>fitted for <code><a href="#topic+bild">bild</a></code> object.</p>
</dd> 
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>str(airpollution)

#####  dependence="indR"
air0R &lt;- bild(wheeze~age+smoking, data=airpollution, time="age", dependence="indR")

randeff(air0R)
</code></pre>

<hr>
<h2 id='show-methods'>Methods for function show in package &quot;bild&quot;</h2><span id='topic+show-methods'></span><span id='topic+show+2Cbild-method'></span><span id='topic+show+2Csummary.bild-method'></span>

<h3>Description</h3>

<p>Show objects of classes <code>bild</code> and <code>summary.bild</code>.</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "bild")</code></dt><dd><p>Print simple summary of a <code>bild</code> object, just the call, the number of profiles in the fit, 
the number of coefficients, the value of the log-likelihood and a message giving additional information returned by the optimizer. </p>
</dd>
<dt><code>signature(object = "summary.bild")</code></dt><dd><p>Shows call, the number of profiles in the fit, 
table of coefficients, standard errors and p-values, the log-likelihood, the AIC coefficient, 
and a message giving additional information returned by the optimizer.</p>
</dd>
</dl>

<hr>
<h2 id='summary-methods'>Methods for Function summary in Package &quot;bild&quot;</h2><span id='topic+summary-methods'></span><span id='topic+summary+2Cbild-method'></span>

<h3>Description</h3>

<p> Summarize objects</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
summary(object, cov=FALSE, cor=FALSE)</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="summary-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
<tr><td><code id="summary-methods_+3A_cov">cov</code></td>
<td>
<p>if set to TRUE prints the matrix of covariances between parameters estimates. The default is FALSE.</p>
</td></tr>
<tr><td><code id="summary-methods_+3A_cor">cor</code></td>
<td>
<p>if set to TRUE prints the matrix of correlations between parameters estimates. The default is FALSE.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p> Computes and returns a list of summary statistics of the fitted linear model given a <code>bild</code> object, 
using the components (list elements) &quot;call&quot; and &quot;terms&quot; from its argument, plus 
depending on the structure of the dependence model chosen, the table for the estimates of coefficients will appear 
<code>log.psi1</code> if the dependence structure of the process corresponds to a first-order 
Markov chain, or both <code>log.psi1</code> and <code>log.psi2</code> if the dependence structure of the process corresponds 
to a second-order Markov chain. <code>log.psi1</code> is the log-odds ratio between adjacent observations and 
<code>log.psi2</code> is the logarithm of conditional odds ratio for observations separated by one time point. 
If the structure of the dependence model chosen includes the random intercept (models &quot;<code>indR</code>&quot;, &quot;<code>MC1R</code>&quot; and &quot;<code>MC2R</code>&quot;) 
the estimate of the random effect (<code>omega</code>) will also appear where <code class="reqn">\omega=\log\sigma^2</code>.</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "ANY")</code>:</dt><dd><p>Generic function.</p>
</dd>
<dt><code>signature(object = "bild")</code>:</dt><dd><p>Prints a summary as an object of class 
<code><a href="#topic+summary.bild-class">summary.bild</a></code>, 
containing information about the matched call to <code>bild</code>, the number of profiles in the data, 
the number of profiles used in the fit, the log-likelihood, the AIC,
a table with estimates, asymptotic SE, t-values and p-values,  
the estimated correlation and variance-covariance matrix for the estimated parameters if the user wishes, 
and a message giving additional information returned by the optimizer.</p>
</dd>
</dl>

<hr>
<h2 id='summary.bild-class'>Class &quot;summary.bild&quot;, Summary of &quot;bild&quot; Objects</h2><span id='topic+summary.bild-class'></span>

<h3>Description</h3>

<p>Extract of <code><a href="#topic+bild">bild</a></code> object.</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("summary.bild", ...)</code>, 
but most often by invoking <code>summary</code> on an <code>bild</code> object. They contain values meant for printing by <code>show</code>.</p>


<h3>Slots</h3>


<dl>
<dt><code>coefficients</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Estimated parameters.</p>
</dd>
<dt><code>se</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Standard errors of estimated parameters.</p>
</dd>
<dt><code>covariance</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Covariance of estimated parameters.</p>
</dd>
<dt><code>correlation</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Correlation of estimated parameters.</p>
</dd>
<dt><code>log.likelihood</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The value of the log likelihood.</p>
</dd>
<dt><code>message</code>:</dt><dd><p>Object of class <code>"integer"</code>. A character string giving any additional information returned 
by the optimizer, or NULL. See <code><a href="stats.html#topic+optim">optim</a></code> for details.</p>
</dd>
<dt><code>n.cases</code>:</dt><dd><p>Object of class <code>"numeric"</code>. Number of individual profiles used in the optimization procedure.</p>
</dd>
<dt><code>ni.cases</code>:</dt><dd><p>Object of class <code>"numeric"</code>. Number of individual profiles in the dataset.</p>
</dd>
<dt><code>aic</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The Akaike information criterion for a fitted model object.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code>. The <code>call</code> that generated <code>bild</code> object.</p>
</dd> 
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+bild-class">bild</a>"</code>, directly.</p>


<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "summary.bild")</code>: Pretty-prints object.</p>
</dd>
</dl>



<h3>See Also</h3>

 <p><code><a href="#topic+bild">bild</a></code>, <code><a href="#topic+bild-class">bild-class</a></code> </p>

<hr>
<h2 id='vareff'>Extract variance of random effects</h2><span id='topic+vareff'></span>

<h3>Description</h3>

<p> Methods for function <code>vareff</code> extracting the variance of random effects of a fitted model object. </p>


<h3>Usage</h3>

<pre><code class='language-R'>vareff(object)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vareff_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns the variance estimates of random effects  of a fitted model.</p>

<hr>
<h2 id='vareff-methods'>Methods for function <code>vareff</code></h2><span id='topic+vareff-methods'></span><span id='topic+vareff+2Cbild-method'></span>

<h3>Description</h3>

<p>Methods for function <code>vareff </code> extracting the variance estimates of random effects of a fitted model object from class  <code><a href="#topic+bild-class">bild</a></code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bild'
vareff(object)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="vareff-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+bild-class">bild</a></code>.</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object="bild")</code>:</dt><dd><p>vareff for <code><a href="#topic+bild">bild</a></code> object.</p>
</dd> 
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>str(airpollution)

#####  dependence="indR"
air0R &lt;- bild(wheeze~age+smoking, data=airpollution, time="age", dependence="indR")

vareff(air0R)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
