<!DOCTYPE html><html lang="en"><head><title>Help for package EloOptimized</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EloOptimized}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EloOptimized'><p>EloOptimized: ML fitting of Elo Scores</p></a></li>
<li><a href='#cardinalize'><p>internal fn to create cardinal rank scores</p></a></li>
<li><a href='#chimpagg_f'><p>Anonymized female chimpanzee pant-grunt data from Gombe</p></a></li>
<li><a href='#chimpagg_m'><p>Anonymized male chimpanzee pant-grunt data from Gombe</p></a></li>
<li><a href='#chimppres_f'><p>Anonymized female chimpanzee presence data from Gombe</p></a></li>
<li><a href='#chimppres_m'><p>Anonymized male chimpanzee presence data from Gombe</p></a></li>
<li><a href='#elo.m3_lik_vect'><p>optimize k parameter and entry Elo scores, vectorized</p></a></li>
<li><a href='#elo.model1'><p>Optimize k parameter in Elo rating method</p></a></li>
<li><a href='#elo.model3'><p>optimize k parameter and entry Elo scores</p></a></li>
<li><a href='#eloratingfixed'><p>Create daily elo ranks and multiple derivatives with user-defined parameter values</p></a></li>
<li><a href='#eloratingopt'><p>Create daily ML fitted Elo ranks and multiple derivatives</p></a></li>
<li><a href='#jenksify'><p>internal fn to generate categorical ranks</p></a></li>
<li><a href='#nba'><p>NBA games 1995-96</p></a></li>
<li><a href='#relativize'><p>internal fn to relativize rank scores</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Optimized Elo Rating Method for Obtaining Dominance Ranks</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-21</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides an implementation of the maximum likelihood methods for deriving
    Elo scores as published in Foerster, Franz et al. (2016) &lt;<a href="https://doi.org/10.1038%2Fsrep35404">doi:10.1038/srep35404</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, reshape2, BAMMtools, magrittr, methods, lubridate,
rlang</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jtfeld/EloOptimized">https://github.com/jtfeld/EloOptimized</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jtfeld/EloOptimized/issues">https://github.com/jtfeld/EloOptimized/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggplot2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-21 18:01:40 UTC; jtf9</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph Feldblum [aut, cre],
  Steffen Foerster [aut],
  Mathias Franz [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joseph Feldblum &lt;jtf9@duke.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-21 22:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='EloOptimized'>EloOptimized: ML fitting of Elo Scores</h2><span id='topic+EloOptimized-package'></span><span id='topic+EloOptimized'></span>

<h3>Description</h3>

<p>This package implements the maximum likelihood methods for deriving Elo scores as published in Foerster, Franz et al. (2016).
Chimpanzee females queue but males compete for social status. Scientific Reports 6, 35404, doi:10.1038/srep35404
</p>


<h3>Primary functions</h3>


<ul>
<li><p><code><a href="#topic+eloratingopt">eloratingopt</a></code>: main function
</p>
</li>
<li><p><code><a href="#topic+eloratingfixed">eloratingfixed</a></code>: traditional Elo scores function
</p>
</li>
<li><p><code><a href="#topic+elo.model1">elo.model1</a></code>: internal function for fitting model type 1
</p>
</li>
<li><p><code><a href="#topic+elo.model3">elo.model3</a></code>: internal function for fitting model type 3
</p>
</li>
<li><p><code><a href="#topic+elo.m3_lik_vect">elo.m3_lik_vect</a></code>: vectorized internal function 
for fitting mod type 3
</p>
</li></ul>



<h3>Plans for future development</h3>


<ul>
<li><p> Make package more modular, with a more flexible wrapper function.
</p>
</li>
<li><p> Option to specify K during burn-in period when fitting only K
</p>
</li>
<li><p> Add additional example data
</p>
</li>
<li><p> Add additional user control of the optimization procedure, allowing 
for specification of the burn in period, optimization algorithm, and 
initial values for optimization.
</p>
</li>
<li><p> Add functionality to plot Elo trajectories from within package.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Joseph Feldblum <a href="mailto:jtf9@duke.edu">jtf9@duke.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Steffen Foerster <a href="mailto:sf2041@gmail.com">sf2041@gmail.com</a>
</p>
</li>
<li><p> Mathias Franz <a href="mailto:m.franz@izw-berlin.de">m.franz@izw-berlin.de</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/jtfeld/EloOptimized">https://github.com/jtfeld/EloOptimized</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/jtfeld/EloOptimized/issues">https://github.com/jtfeld/EloOptimized/issues</a>
</p>
</li></ul>


<hr>
<h2 id='cardinalize'>internal fn to create cardinal rank scores</h2><span id='topic+cardinalize'></span>

<h3>Description</h3>

<p>internal function for generating cardinal ranks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cardinalize(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cardinalize_+3A_x">x</code></td>
<td>
<p>input vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>converts raw Elo scores into predicted number of individuals beaten
(using Equation 1 from paper)
</p>
<p>subtracting .5 is equivalent to removing the prob of winning against oneself
because 1/(1 + exp(-0.01*0)) = 1/(1 + exp(0)) = 1/(1 + 1) = 1/2
</p>


<h3>Value</h3>

<p>returns new vector of cardinal rank scores
</p>

<hr>
<h2 id='chimpagg_f'>Anonymized female chimpanzee pant-grunt data from Gombe</h2><span id='topic+chimpagg_f'></span>

<h3>Description</h3>

<p>Female data from Gombe National Park, Tanzania from 1969 to 2013.  
Data are submissive pant-grunt vocalizations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chimpagg_f
</code></pre>


<h3>Format</h3>

<p>A data frame with 1015 rows and 3 variables:
</p>

<dl>
<dt>Date</dt><dd><p>date of interaction</p>
</dd>
<dt>Winner</dt><dd><p>winning individual</p>
</dd>
<dt>Loser</dt><dd><p>losing individual</p>
</dd>
</dl>



<h3>Source</h3>

<p>Supplemental data published with Foerster, Franz et al. (2016).
<a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.r4g74">https://datadryad.org/stash/dataset/doi:10.5061/dryad.r4g74</a>
</p>

<hr>
<h2 id='chimpagg_m'>Anonymized male chimpanzee pant-grunt data from Gombe</h2><span id='topic+chimpagg_m'></span>

<h3>Description</h3>

<p>Data from Gombe National Park, Tanzania from 1978 to 2011.  Data 
are submissive pant-grunt vocalizations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chimpagg_m
</code></pre>


<h3>Format</h3>

<p>A data frame with 2741 rows and 3 variables:
</p>

<dl>
<dt>Date</dt><dd><p>date of interaction</p>
</dd>
<dt>Winner</dt><dd><p>winning individual</p>
</dd>
<dt>Loser</dt><dd><p>losing individual</p>
</dd>
</dl>



<h3>Source</h3>

<p>Supplemental data published with Foerster, Franz et al. (2016).
<a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.r4g74">https://datadryad.org/stash/dataset/doi:10.5061/dryad.r4g74</a>
</p>

<hr>
<h2 id='chimppres_f'>Anonymized female chimpanzee presence data from Gombe</h2><span id='topic+chimppres_f'></span>

<h3>Description</h3>

<p>Female presence data from Gombe National Park, Tanzania from 1969 to 2013.  
Presence criteria are given in Foerster, Franz et al. (2016)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chimppres_f
</code></pre>


<h3>Format</h3>

<p>A data frame with 44 rows and 3 variables:
</p>

<dl>
<dt>id</dt><dd><p>female code</p>
</dd>
<dt>start_date</dt><dd><p>start date</p>
</dd>
<dt>end_date</dt><dd><p>date of departure</p>
</dd>
</dl>



<h3>Source</h3>

<p>Supplemental data published with Foerster, Franz et al. (2016).
<a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.r4g74">https://datadryad.org/stash/dataset/doi:10.5061/dryad.r4g74</a>
</p>

<hr>
<h2 id='chimppres_m'>Anonymized male chimpanzee presence data from Gombe</h2><span id='topic+chimppres_m'></span>

<h3>Description</h3>

<p>Male presence data from Gombe National Park, Tanzania from 1978 to 2011.  
Presence criteria are given in Foerster, Franz et al. (2016)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chimppres_m
</code></pre>


<h3>Format</h3>

<p>A data frame with 22 rows and 3 variables:
</p>

<dl>
<dt>id</dt><dd><p>male code</p>
</dd>
<dt>start_date</dt><dd><p>start date</p>
</dd>
<dt>end_date</dt><dd><p>date of departure</p>
</dd>
</dl>



<h3>Source</h3>

<p>Supplemental data published with Foerster, Franz et al. (2016).
<a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.r4g74">https://datadryad.org/stash/dataset/doi:10.5061/dryad.r4g74</a>
</p>

<hr>
<h2 id='elo.m3_lik_vect'>optimize k parameter and entry Elo scores, vectorized</h2><span id='topic+elo.m3_lik_vect'></span>

<h3>Description</h3>

<p>Function to optimize k parameter and entry Elo scores
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.m3_lik_vect(par, IA_data, all_ids)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elo.m3_lik_vect_+3A_par">par</code></td>
<td>
<p>list of parameters, with par[1] being log(k), and par[2:length(par)] 
being the initial elo scores of individuals</p>
</td></tr>
<tr><td><code id="elo.m3_lik_vect_+3A_ia_data">IA_data</code></td>
<td>
<p>list of interaction data, with columns &quot;Date&quot;, &quot;Winner&quot;, and &quot;Loser&quot;
(in that order)</p>
</td></tr>
<tr><td><code id="elo.m3_lik_vect_+3A_all_ids">all_ids</code></td>
<td>
<p>list of all ids to rank</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# for internal use
</code></pre>

<hr>
<h2 id='elo.model1'>Optimize k parameter in Elo rating method</h2><span id='topic+elo.model1'></span>

<h3>Description</h3>

<p>Function to optimize k parameter in Elo Rating Method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.model1(par, burn_in=100, init_elo = 1000, IA_data, all_ids, p_function = "sigmoid", 
  return_likelihood = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elo.model1_+3A_par">par</code></td>
<td>
<p>initial value of log(k)</p>
</td></tr>
<tr><td><code id="elo.model1_+3A_burn_in">burn_in</code></td>
<td>
<p>burn in period for establishing initial elo scores. Defaults to 100</p>
</td></tr>
<tr><td><code id="elo.model1_+3A_init_elo">init_elo</code></td>
<td>
<p>Initial Elo score for all individuals.  Defaults to 1000</p>
</td></tr>
<tr><td><code id="elo.model1_+3A_ia_data">IA_data</code></td>
<td>
<p>Data frame with Date, Winner, and Loser</p>
</td></tr>
<tr><td><code id="elo.model1_+3A_all_ids">all_ids</code></td>
<td>
<p>list of all IDs in sample</p>
</td></tr>
<tr><td><code id="elo.model1_+3A_p_function">p_function</code></td>
<td>
<p>function used to calculate probability of winning.  Defaults to sinusoidal 
function, but use &quot;pnorm&quot; to use the <code><a href="stats.html#topic+Normal">pnorm</a></code>-based method 
implemented in the EloRating package.</p>
</td></tr>
<tr><td><code id="elo.model1_+3A_return_likelihood">return_likelihood</code></td>
<td>
<p>Logical; if TRUE, returns log likelihood based on given par, if FALSE
returns agonistic interactions table with elo scores based on given value of par</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#for internal use

</code></pre>

<hr>
<h2 id='elo.model3'>optimize k parameter and entry Elo scores</h2><span id='topic+elo.model3'></span>

<h3>Description</h3>

<p>Function to optimize k parameter and entry Elo scores
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.model3(par, IA_data, all_ids, return_likelihood = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elo.model3_+3A_par">par</code></td>
<td>
<p>list of parameters, with par[1] being log(k), and par[2:length(par)] 
being the initial elo scores of individuals</p>
</td></tr>
<tr><td><code id="elo.model3_+3A_ia_data">IA_data</code></td>
<td>
<p>list of interaction data, with columns &quot;Date&quot;, &quot;Winner&quot;, and &quot;Loser&quot;
(in that order)</p>
</td></tr>
<tr><td><code id="elo.model3_+3A_all_ids">all_ids</code></td>
<td>
<p>list of all ids to rank</p>
</td></tr>
<tr><td><code id="elo.model3_+3A_return_likelihood">return_likelihood</code></td>
<td>
<p>If TRUE, returns the total likelihood based on all 
interactions given a particular set of parameters.  If FALSE, returns 
a table of Elo scores based on a given set of parameters.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># for internal use
</code></pre>

<hr>
<h2 id='eloratingfixed'>Create daily elo ranks and multiple derivatives with user-defined parameter values</h2><span id='topic+eloratingfixed'></span>

<h3>Description</h3>

<p>Conducts traditional elo rating analyses using specified K value
and outputs raw, normalized, cardinal, and  categorical ranks as a list object in 
R or in an output file.  For optimized Elo parameters, use <code><a href="#topic+eloratingopt">eloratingopt</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eloratingfixed(agon_data, pres_data, k = 100, init_elo = 1000, outputfile = NULL, 
  returnR = TRUE, p_function = "sigmoid")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eloratingfixed_+3A_agon_data">agon_data</code></td>
<td>
<p>Input data frame with dominance interactions, should only contain Date, 
Winner, Loser.  Date should be formatted as MONTH/DAY/YEAR, or already as Date class.</p>
</td></tr>
<tr><td><code id="eloratingfixed_+3A_pres_data">pres_data</code></td>
<td>
<p>Input data frame with columns &quot;id&quot;, &quot;start_date&quot; and &quot;end_date&quot;.  Date
columns should be formatted as MONTH/DAY/YEAR, or already as Date class.  If all IDs 
are present the whole time, you ignore this and a pres_data table will be automatically
generated.</p>
</td></tr>
<tr><td><code id="eloratingfixed_+3A_k">k</code></td>
<td>
<p>Specified value of the k parameter, default is 100</p>
</td></tr>
<tr><td><code id="eloratingfixed_+3A_init_elo">init_elo</code></td>
<td>
<p>The starting Elo value for all individuals, default is 1000</p>
</td></tr>
<tr><td><code id="eloratingfixed_+3A_outputfile">outputfile</code></td>
<td>
<p>Name of csv file to save ranks to.  Default is NULL, in which case 
the function will only return a table in R.  If you supply an output file name
the function will save the results as a csv file in your working directory.</p>
</td></tr>
<tr><td><code id="eloratingfixed_+3A_returnr">returnR</code></td>
<td>
<p>whether to return an R object from the function call.  Default is TRUE</p>
</td></tr>
<tr><td><code id="eloratingfixed_+3A_p_function">p_function</code></td>
<td>
<p>function defining probability of winning.  Default &quot;sigmoid&quot; is 
equation (1) from Foerster, Franz et al 2016.  Use &quot;pnorm&quot; to use the 
<code><a href="stats.html#topic+Normal">pnorm</a></code>-based method implemented in the EloRating package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function accepts a data frame of date-stamped dominance interactions and 
(optionally) a data frame of start and end dates for each individual to be ranked, 
and outputs daily Elo scores with parameters specified by the user.  The default function 
used to determine probability of winning is equation (1) from Foerster, Franz et al. 2016, 
but for ease of comparison with the EloRating package, we also added the option to use
the <code><a href="stats.html#topic+Normal">pnorm</a></code>-based method implemented in the EloRating package, and future 
development will add the option to use the original function from Elo 1978 (as implemented in 
the elo package).  This function does not require large presence matrices, and efficiently 
calculates a series of additional indices (described below).  
</p>
<p>As opposed to the <code><a href="#topic+eloratingopt">eloratingopt</a></code> function, this procedure only requires that 
included individuals have at least one win <em>or</em> one loss. 
</p>
<p>A detailed description of the function output is given in the <strong>Value</strong> section of 
this help file:
</p>


<h3>Value</h3>

<p>Returns a list with six elements: 
</p>

<dl>
<dt><strong>elo</strong></dt><dd><p> Data frame with all IDs and dates they were present, with the following columns:</p>
</dd>
</dl>

<dl>
<dt>Date</dt><dd><p>: Dates of study period</p>
</dd>
<dt>Individual</dt><dd><p>: the names of each ranked individual, for each date they were present</p>
</dd>
<dt>Elo</dt><dd><p>: fitted Elo scores for each individual on each day</p>
</dd>
<dt>EloOrdinal</dt><dd><p>: Daily ordinal rank based on Elo scores</p>
</dd>
<dt>EloScaled</dt><dd><p>: Daily Elo scores rescaled between 0 and 1 according to 
</p>
<p style="text-align: center;"><code class="reqn">([individual Elo] - min([daily Elo scores])/(max([daily Elo scores]) - min([daily Elo scores]))</code>
</p>
</dd>
<dt>ExpNumBeaten</dt><dd><p>: expected number of individuals in the group beaten, which is the sum of 
winning probabilities based on relative Elo scores of an individual and all others, following 
equation (4) in Foerster, Franz et al. 2016</p>
</dd>
<dt>EloCardinal</dt><dd><p>: ExpNumBeaten values rescaled as a percentage of the total number of ranked 
individuals present in the group on the day of ranking. We encourage the use of this measure.</p>
</dd>
<dt>JenksEloCardinal</dt><dd><p>: Categorical rank (high, mid, or low) using the Jenks natural breaks 
classification method implemented in the R package BAMMtools. 
See <code><a href="BAMMtools.html#topic+getJenksBreaks">getJenksBreaks</a></code></p>
</dd>
</dl>

<dl>
<dt><strong>k</strong></dt><dd><p> User-defined value of the k parameter</p>
</dd>
<dt><strong>init_elo</strong></dt><dd><p> User-defined initial Elo score when individuals enter the hierarchy</p>
</dd>
<dt><strong>pred_accuracy</strong></dt><dd><p> Proportion of correctly predicted interactions</p>
</dd>
<dt><strong>logL</strong></dt><dd><p> The overall log-likelihood of the observed data given the user-supplied parameter 
values based on winning probabilities (as calculated in equation (1) of Foerster, Franz et al 2016) 
for all interactions</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
nbadata = EloOptimized::nba #nba wins and losses from the 1995-96 season
nbaelo = eloratingfixed(agon_data = nbadata)
# generates traditional Elo scores (with init_elo = 1000 &amp; k = 100) and saves 
#   them as "nbaelo" 

</code></pre>

<hr>
<h2 id='eloratingopt'>Create daily ML fitted Elo ranks and multiple derivatives</h2><span id='topic+eloratingopt'></span>

<h3>Description</h3>

<p>Conducts <strong>optimized</strong> elo rating analyses as per Foerster, Franz et al
and outputs raw, normalized, cardinal, and  categorical ranks as a list object in 
R or in an output file. For non-optimized Elo score calculation, use 
<code><a href="#topic+eloratingfixed">eloratingfixed</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eloratingopt(agon_data, pres_data, fit_init_elo = FALSE, outputfile = NULL, 
  returnR = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eloratingopt_+3A_agon_data">agon_data</code></td>
<td>
<p>Input data frame with dominance interactions, should only contain Date, 
Winner, Loser.  Date should be formatted as MONTH/DAY/YEAR, or already as Date class.</p>
</td></tr>
<tr><td><code id="eloratingopt_+3A_pres_data">pres_data</code></td>
<td>
<p>Input data frame with columns &quot;id&quot;, &quot;start_date&quot; and &quot;end_date&quot;.  Date
columns should be formatted as MONTH/DAY/YEAR, or already as Date class.  If all IDs 
are present the whole time, you can ignore this and a pres_data table will be 
automatically generated.</p>
</td></tr>
<tr><td><code id="eloratingopt_+3A_fit_init_elo">fit_init_elo</code></td>
<td>
<p>If FALSE (the default), fits only the K parameter, with a default 
starting Elo score of 1000 for each individual.  If TRUE, fits K and starting Elo for 
each individual.  The latter option is <em>much</em> slower.</p>
</td></tr>
<tr><td><code id="eloratingopt_+3A_outputfile">outputfile</code></td>
<td>
<p>Name of csv file to save ranks to.  Default is NULL, in which case 
the function will only return a table in R.  If you supply an output file name
the function will save the results as a csv file in your working directory.</p>
</td></tr>
<tr><td><code id="eloratingopt_+3A_returnr">returnR</code></td>
<td>
<p>whether to return an R object from the function call.  Default is TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function accepts a data frame of date-stamped dominance interactions and 
(optionally) a data frame of start and end dates for each individual to be ranked, 
and outputs daily Elo scores with K parameter, and optionally initial elo scores, fitted using 
a maximum likelihood approach.  The optimization procedure uses the <code>optim()</code> function, 
with a burn in period of 100 interactions.  We use the &quot;Brent&quot; method when fitting only the K 
parameter, and the &quot;BFGS&quot; method for fitting both K and initial Elo scores.  See 
<code><a href="stats.html#topic+optim">optim</a></code> for more details.  Future package development will add additional 
user control of the optimization procedure, allowing for specification of the burn in period, 
optimization algorithm, and initial values for optimization.  
</p>
<p>Note also that the fitting procedure requires each individual to have at least one win and 
one loss, so any individual that doesn't meet those criteria is automatically removed.  
Additionally, any instance of an individual winning against itself is cleaned from the data,
and several other checks of the data are performed before the optimization procedure is run.
</p>
<p>A detailed description of the function output is given in the <strong>Value</strong> section of 
this help file:
</p>


<h3>Value</h3>

<p>Returns a list with five or six elements (depending on input): 
</p>

<dl>
<dt><strong>elo</strong></dt><dd><p> Data frame with all IDs and dates they were present, with the following columns:</p>
</dd>
</dl>

<dl>
<dt>Date</dt><dd><p>: Dates of study period</p>
</dd>
<dt>Individual</dt><dd><p>: the names of each ranked individual, for each date they were present</p>
</dd>
<dt>Elo</dt><dd><p>: fitted Elo scores for each individual on each day</p>
</dd>
<dt>EloOrdinal</dt><dd><p>: Daily ordinal rank based on Elo scores</p>
</dd>
<dt>EloScaled</dt><dd><p>: Daily Elo scores rescaled between 0 and 1 according to 
</p>
<p style="text-align: center;"><code class="reqn">([individual Elo] - min([daily Elo scores])/(max([daily Elo scores]) - min([daily Elo scores]))</code>
</p>
</dd>
<dt>ExpNumBeaten</dt><dd><p>: expected number of individuals in the group beaten, which is the sum of 
winning probabilities based on relative Elo scores of an individual and all others, following 
equation (4) in Foerster, Franz et al. 2016</p>
</dd>
<dt>EloCardinal</dt><dd><p>: ExpNumBeaten values rescaled as a percentage of the total number of ranked 
individuals present in the group on the day of ranking. We encourage the use of this measure.</p>
</dd>
<dt>JenksEloCardinal</dt><dd><p>: Categorical rank (high, mid, or low) using the Jenks natural breaks 
classification method implemented in the R package BAMMtools. 
See <code><a href="BAMMtools.html#topic+getJenksBreaks">getJenksBreaks</a></code></p>
</dd>
</dl>

<dl>
<dt><strong>k</strong></dt><dd><p> The maximum-likelihood fitted k parameter value</p>
</dd>
<dt><strong>pred_accuracy</strong></dt><dd><p> Proportion of correctly predicted interactions</p>
</dd>
<dt><strong>maxLogL</strong></dt><dd><p> The overall log-likelihood of the observed data given the fitted parameter values 
based on winning probabilities (as calculated in equation (1) of Foerster, Franz et al 2016) for all 
interactions</p>
</dd>
<dt><strong>AIC</strong></dt><dd><p> Akaike's Information Criterion value as a measure of model fit</p>
</dd>
<dt><strong>init_elo</strong></dt><dd><p> (<em>Only returned if you fit initial Elo scores</em>) initial Elo for each individual</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
nbadata = EloOptimized::nba #nba wins and losses from the 1995-96 season
nbaelo = eloratingopt(agon_data = nbadata, fit_init_elo = FALSE)
# generates optimized elo scores (optimizing only K) and saves them as "nbaelo" 

</code></pre>

<hr>
<h2 id='jenksify'>internal fn to generate categorical ranks</h2><span id='topic+jenksify'></span>

<h3>Description</h3>

<p>internal function for generating categorical ranks using 
jenks natural breaks algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jenksify(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jenksify_+3A_x">x</code></td>
<td>
<p>input vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>creates categorical ranks using jenks natural breaks algorithm
</p>


<h3>Value</h3>

<p>returns new vector of categorical ranks (high/medium/low)
</p>

<hr>
<h2 id='nba'>NBA games 1995-96</h2><span id='topic+nba'></span>

<h3>Description</h3>

<p>Outcome of NBA games during the 1995-1996 regular season, adapted from a dataset 
from fivethirtyeight
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nba
</code></pre>


<h3>Format</h3>

<p>A data frame with 1189 rows and 3 variables:
</p>

<dl>
<dt>Date</dt><dd><p>date of game</p>
</dd>
<dt>Winner</dt><dd><p>winning team</p>
</dd>
<dt>Loser</dt><dd><p>losing team</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://github.com/fivethirtyeight/data/blob/master/nba-elo/nbaallelo.csv">https://github.com/fivethirtyeight/data/blob/master/nba-elo/nbaallelo.csv</a>
</p>

<hr>
<h2 id='relativize'>internal fn to relativize rank scores</h2><span id='topic+relativize'></span>

<h3>Description</h3>

<p>internal function for generating scaled cardinal ranks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relativize(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="relativize_+3A_x">x</code></td>
<td>
<p>input vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>scales cardinal Elo scores between 0 and 1
</p>


<h3>Value</h3>

<p>returns new vector of scaled rank scores
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
