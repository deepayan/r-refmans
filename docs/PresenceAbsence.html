<!DOCTYPE html><html><head><title>Help for package PresenceAbsence</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PresenceAbsence}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#auc'><p> Area Under the Curve</p></a></li>
<li><a href='#auc.roc.plot'><p> AUC ROC Plot</p></a></li>
<li><a href='#calibration.plot'><p> Calibration Plot</p></a></li>
<li><a href='#cmx'><p> Confusion Matrix</p></a></li>
<li><a href='#error.threshold.plot'><p> Error Threshold Plot</p></a></li>
<li><a href='#Kappa'><p> Kappa</p></a></li>
<li><a href='#optimal.thresholds'><p> Calculate Optimal Thresholds</p></a></li>
<li><a href='#pcc'><p> Percent Correctly Classified</p></a></li>
<li><a href='#predicted.prevalence'><p> Predicted Prevalence</p></a></li>
<li><a href='#presence.absence.accuracy'><p> Accuracy Table for Presence/Absence Data</p></a></li>
<li><a href='#presence.absence.hist'><p> Presence/Absence Histogram</p></a></li>
<li><a href='#presence.absence.simulation'><p>Presence/Absence Data Simulation</p></a></li>
<li><a href='#presence.absence.summary'><p> Presence/Absence Summary Plots</p></a></li>
<li><a href='#PresenceAbsence-package'>
<p>Presence-Absence model evaluation</p></a></li>
<li><a href='#roc.plot.calculate'><p> ROC Plot Calculations</p></a></li>
<li><a href='#sensitivity'><p> Sensitivity</p></a></li>
<li><a href='#SIM3DATA'><p> Simulated Presence-Absence Data</p></a></li>
<li><a href='#SPDATA'><p> Species Presence/Absence Data</p></a></li>
<li><a href='#specificity'><p> Specificity</p></a></li>
<li><a href='#SPPREV'><p> Overall Preavalences for Species Presence/Absence Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Presence-Absence Model Evaluation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.11</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-05</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.2.0)</td>
</tr>
<tr>
<td>Author:</td>
<td>Elizabeth Freeman</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Elizabeth Freeman &lt;elizabeth.a.freeman@usda.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a set of functions useful when evaluating the results of presence-absence models. Package includes functions for calculating threshold dependent measures such as confusion matrices, pcc, sensitivity, specificity, and Kappa, and produces plots of each measure as the threshold is varied. It will calculate optimal threshold choice according to a choice of optimization criteria. It also includes functions to plot the threshold independent ROC curves along with the associated AUC (area under the curve).</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-05 22:33:28 UTC; eafreeman</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-07 04:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='auc'> Area Under the Curve </h2><span id='topic+auc'></span>

<h3>Description</h3>

<p><code>auc</code> calculates the area under the ROC curve approximated with a Mann-Whitney U statistic, and (optionally) the associated standard deviation. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc(DATA, st.dev = TRUE, which.model = 1, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auc_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> DATA[,1] </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> DATA[,2] </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> DATA[,3] </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> DATA[,4] </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  
	</td>
</tr>

</table>

</td></tr>
<tr><td><code id="auc_+3A_st.dev">st.dev</code></td>
<td>
<p> a logical indicating whether the associated standard deviation should be calculated </p>
</td></tr>
<tr><td><code id="auc_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which model from DATA should be used</p>
</td></tr>
<tr><td><code id="auc_+3A_na.rm">na.rm</code></td>
<td>
<p> a logical indicating whether missing values should be removed</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>auc</code> approximates the area under the ROC curve with a Mann-Whitney U statistic (Delong et al., 1988) to calculate the area under the curve.
</p>
<p>The standard errors from <code>auc</code> are only valid for comparing an individual model to random assignment (i.e. AUC=.5). To compare two models to each other it is necessary to account for correlation due to the fact that they use the same test set. If you are interested in pair wise model comparisons see the Splus ROC library from Mayo clinic. <code>auc</code> is a much simpler function than what is available from the Splus ROC library from Mayo clinic. 
</p>
<p>The observed values (column 2 in <code>DATA</code>) can be given as 0/1 values to represent <code>absence</code> and <code>presence</code>. If this column contains actual values (i.e. basal area, biomass, etc...), any value of zero will be treated as <code>absence</code> and any value greater than zero will be treated as <code>presence</code>.
</p>
<p>If observed values are all the same, in other words, if the data consists entirely of observed Presences or entirely of observed Absences, <code>auc</code> will return <code>NaN</code>.
</p>


<h3>Value</h3>

<p>if <code>st.dev</code> = FALSE, returns: <code>AUC</code> area under the curve.<br />
</p>
<p>if <code>st.dev</code> = TRUE, returns a dataframe where:
</p>

<table>
<tr>
 <td style="text-align: left;">
[1,1] </td><td style="text-align: left;"> <code>AUC</code>   </td><td style="text-align: left;"> area under the curve </td>
</tr>
<tr>
 <td style="text-align: left;">
[1,2] </td><td style="text-align: left;"> <code>AUC.sd</code></td><td style="text-align: left;"> standard deviation of <code>AUC</code></td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>References</h3>

 
<p>DeLong, E.R., Delong, D.M. and Clarke-Pearson, D.L., 1988. Comparing areas under two or more correlated Receiver Operating Characteristic curves: a nonparametric approach. Biometrics, 44(3):837-845.
</p>
<p>Splus ROC library developed by Beth Atkinson and Doug Mahoney at the Mayo Clinic is available at: <a href="http://www.stats.ox.ac.uk/pub/MASS3/Winlibs/">http://www.stats.ox.ac.uk/pub/MASS3/Winlibs/</a> for windows.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+cmx">cmx</a></code>, <code><a href="#topic+pcc">pcc</a></code>, <code><a href="#topic+sensitivity">sensitivity</a></code>, <code><a href="#topic+specificity">specificity</a></code>, <code><a href="#topic+Kappa">Kappa</a></code>, <code><a href="#topic+auc.roc.plot">auc.roc.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

auc(SIM3DATA)

auc(SIM3DATA,st.dev=FALSE,which.model=2)
</code></pre>

<hr>
<h2 id='auc.roc.plot'> AUC ROC Plot </h2><span id='topic+auc.roc.plot'></span>

<h3>Description</h3>

<p><code>auc.roc.plot</code> creates a ROC plot for one dataset and one or more model predictions. Prints AUC for each model as part of the legend. <code>auc.roc.plot</code> also includes an option to mark several types of optimal thresholds along each ROC plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc.roc.plot(DATA, threshold = 101, find.auc = TRUE, 
which.model = (1:(ncol(DATA) - 2)), na.rm = FALSE, 
xlab = "1-Specificity (false positives)", 
ylab = "Sensitivity (true positives)", main = "ROC Plot", 
model.names = NULL, color = NULL, line.type = NULL, lwd = 1, 
mark = 0, mark.numbers = TRUE, mark.color = NULL, 
opt.thresholds = NULL, opt.methods = NULL, req.sens, 
req.spec, obs.prev = NULL, smoothing = 1, add.legend = TRUE, 
legend.text = model.names, legend.cex = 0.8, add.opt.legend = TRUE, 
opt.legend.text = NULL, opt.legend.cex = 0.7, 
counter.diagonal = FALSE, pch = NULL, FPC, FNC, cost.line = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auc.roc.plot_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_threshold">threshold</code></td>
<td>
<p>cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. It can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_find.auc">find.auc</code></td>
<td>
<p>a logical indicating if area under the curve should be calculated</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which model from <code>DATA</code> should be used</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_xlab">xlab</code></td>
<td>
<p> a title for the x axis</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_ylab">ylab</code></td>
<td>
<p> a title for the y axis</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_main">main</code></td>
<td>
<p> an overall title for the plot </p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_model.names">model.names</code></td>
<td>
<p> a vector of the names of each model included in <code>DATA</code> to be used in the legend box </p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_color">color</code></td>
<td>
<p> should each model be plotted in a different color. It can be a logical value (where <code>TRUE</code> = color and <code>FALSE</code> = black and white), or a vector of color codes specifying particular colors for each line.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_line.type">line.type</code></td>
<td>
<p> should each model be plotted in a different line type. It can be a logical value (where <code>TRUE</code> = dashed lines and <code>FALSE</code> = solid lines), or a vector of codes specifying particular line types for each line.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_lwd">lwd</code></td>
<td>
<p> line width </p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_mark">mark</code></td>
<td>
<p> particular thresholds to mark along each roc plot, given in same format as <code>threshold</code>. Note: if <code>optimal.thresholds</code> = <code>TRUE</code>, argument <code>mark</code> will be ignored.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_mark.numbers">mark.numbers</code></td>
<td>
<p>a logical indication if the threshold values of each marked point along the ROC curved should be labeled next to the points</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_mark.color">mark.color</code></td>
<td>
<p>should the marked thresholds be plotted in a different color for each model. A logical value where <code>TRUE</code> equals same colors as the lines, and <code>FALSE</code> = marks are always black. Can also be specified as a vector of color codes. Note that is this case, it is one color per model, not one color per threshold.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_opt.thresholds">opt.thresholds</code></td>
<td>
<p> logical indicating whether the optimal thresholds should be calculated and plotted, or a vector specifying thresholds to plot </p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_opt.methods">opt.methods</code></td>
<td>
<p> what methods should be used to optimize thresholds. Argument can be given either as a vector of method names or method numbers. Possible values are:
</p>

<table>
<tr>
 <td style="text-align: right;">
  1  </td><td style="text-align: left;"> <code>Default</code>   </td><td style="text-align: left;"> threshold=0.5 </td>
</tr>
<tr>
 <td style="text-align: right;">
  2  </td><td style="text-align: left;"> <code>Sens=Spec</code> </td><td style="text-align: left;"> sensitivity=specificity </td>
</tr>
<tr>
 <td style="text-align: right;">
  3  </td><td style="text-align: left;"> <code>MaxSens+Spec</code> </td><td style="text-align: left;"> maximizes (sensitivity+specificity)/2 </td>
</tr>
<tr>
 <td style="text-align: right;">
  4  </td><td style="text-align: left;"> <code>MaxKappa</code>  </td><td style="text-align: left;"> maximizes Kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
  5  </td><td style="text-align: left;"> <code>MaxPCC</code>    </td><td style="text-align: left;"> maximizes PCC (percent correctly classified) </td>
</tr>
<tr>
 <td style="text-align: right;">
  6  </td><td style="text-align: left;"> <code>PredPrev=Obs</code> </td><td style="text-align: left;"> predicted prevalence=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  7  </td><td style="text-align: left;"> <code>ObsPrev</code>   </td><td style="text-align: left;"> threshold=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  8 </td><td style="text-align: left;"> <code>MeanProb </code> </td><td style="text-align: left;"> mean predicted probability </td>
</tr>
<tr>
 <td style="text-align: right;"> 
  9  </td><td style="text-align: left;"> <code>MinROCdist</code></td><td style="text-align: left;"> minimizes distance between ROC plot and (0,1)</td>
</tr>
<tr>
 <td style="text-align: right;">
  10 </td><td style="text-align: left;"> <code>ReqSens</code> </td><td style="text-align: left;"> user defined required sensitivity </td>
</tr>
<tr>
 <td style="text-align: right;">
  11 </td><td style="text-align: left;"> <code>ReqSpec</code> </td><td style="text-align: left;"> user defined required specificity </td>
</tr>

</table>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_req.sens">req.sens</code></td>
<td>
<p> a value between zero and one giving the user defined required sensitivity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1-maximum allowable errors for points with positive observations).</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_req.spec">req.spec</code></td>
<td>
<p> a value between zero and one giving the user defined required sspecificity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1- maximum allowable errors for points with negative observations).</p>
</td></tr>  
<tr><td><code id="auc.roc.plot_+3A_obs.prev">obs.prev</code></td>
<td>
<p>observed prevalence for <code>opt.method</code> = <code>"PredPrev=Obs"</code> and <code>"ObsPrev"</code>. Defaults to observed prevalence from <code>DATA</code>.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_smoothing">smoothing</code></td>
<td>
<p> smoothing factor for maximizing/minimizing. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Instead of find the threshold that gives the max/min value, function will average the thresholds of the given number of max/min values.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_add.legend">add.legend</code></td>
<td>
<p>a logical indicating if a legend for AUC lines should be added to plot</p>
</td></tr>   
<tr><td><code id="auc.roc.plot_+3A_legend.text">legend.text</code></td>
<td>
<p>a two item vector of text for presence/absence legend. Defaults to 'model.names'. </p>
</td></tr>   
<tr><td><code id="auc.roc.plot_+3A_legend.cex">legend.cex</code></td>
<td>
<p>cex for AUC legend</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_add.opt.legend">add.opt.legend</code></td>
<td>
<p>logical indicating if a legend for optimal threshold criteria should be included on the plot</p>
</td></tr>  
<tr><td><code id="auc.roc.plot_+3A_opt.legend.text">opt.legend.text</code></td>
<td>
<p>a vector of text for optimimal threshold criteria legend. Defaults to text corresponding to 'opt.methods'.</p>
</td></tr>   
<tr><td><code id="auc.roc.plot_+3A_opt.legend.cex">opt.legend.cex</code></td>
<td>
<p>cex for optimization criteria legend</p>
</td></tr> 
<tr><td><code id="auc.roc.plot_+3A_counter.diagonal">counter.diagonal</code></td>
<td>
<p> should a counter-diagonal line be plotted. Note: each ROC plot crosses this line at the point where sensitivity equals specificity for that model. </p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_pch">pch</code></td>
<td>
<p> plotting &quot;character&quot;, i.e., symbol to use for the thresholds specified in <code>mark</code>.  <code>pch</code> can either be a single character or an integer code for one of a set of graphics symbols.  See <code>help(points)</code> for details. </p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_fpc">FPC</code></td>
<td>
<p> False Positive Costs, or for C/B ratio C = 'net costs of treating nondiseased individuals'.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_fnc">FNC</code></td>
<td>
<p> False Negative Costs, or for C/B ratio B = 'net benefits of treating diseased individuals'.</p>
</td></tr>
<tr><td><code id="auc.roc.plot_+3A_cost.line">cost.line</code></td>
<td>
<p> a logical indicating if the line representing the realtive cost ratio should be added to the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Receiver Operating Curves (ROC plots) provide a threshold independent method of evaluating the performance of presence/absence models. In a ROC plot the true positive rate (sensitivity) is plotted against the false positive rate (1.0-specificity) as the threshold varies from 0 to 1. A good model will achieve a high true positive rate while the false positive rate is still relatively small; thus the ROC plot will rise steeply at the origin, and then level off at a value near the maximum of 1. The ROC plot for a poor model (whose predictive ability is the equivalent of random assignment) will lie near the diagonal, where the true positive rate equals the false positive rate for all thresholds. Thus the area under the ROC curve (AUC) is a good measure of overall model performance, with good models having an AUC near 1, while poor models have an AUC near 0.5.
</p>
<p><code>mark</code> can be used to mark particular thresholds along each ROC plot, alternativly, if <code>optimal.thresholds</code> = <code>TRUE</code> the function will find optimal thresholds by several criteria and plot them along each ROC curve.
</p>
<p>See <a href="#topic+optimal.thresholds">optimal.thresholds</a> for more details on the optimization methods, and on the arguments <code>ReqSens</code>, <code>ReqSpec</code>, <code>obs.prev</code> <code>smoothing</code>, <code>FPC</code>, <code>FNC</code>, and <code>cost.line</code>.
</p>
<p>Note: if too many methods are included in <code>opt.methods</code>, the graph will get very crowded.
</p>


<h3>Value</h3>

<p>creates a graphical plot</p>


<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

 <p><a href="#topic+optimal.thresholds">optimal.thresholds</a>,<a href="#topic+presence.absence.accuracy">presence.absence.accuracy</a>, <a href="#topic+roc.plot.calculate">roc.plot.calculate</a>, <a href="#topic+error.threshold.plot">error.threshold.plot</a>, <a href="#topic+presence.absence.summary">presence.absence.summary</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(SIM3DATA)

auc.roc.plot(SIM3DATA)

auc.roc.plot(	SIM3DATA,
			opt.thresholds=TRUE,
			opt.methods=c("Default","Sens=Spec","MinROCdist"))

auc.roc.plot(	SIM3DATA,
			threshold=101,
			which.model=c(2,3),
			model.names=c("model a","model b","model c"),
			na.rm=TRUE,
			xlab="1-Specificity (false positives)",
			ylab="Sensitivity (true positives)",
			main="ROC Plot", 
			color=TRUE,
			line.type=TRUE,
			lwd=1,
			mark=0,
			mark.numbers=TRUE,
			opt.thresholds=TRUE,
			opt.methods=c(1,2,4),
			req.sens=0.85,
			req.spec=0.85,
			obs.prev=NULL,
			add.legend=TRUE,
			legend.text=NULL,
			legend.cex=0.8,
			add.opt.legend=TRUE,
			opt.legend.text=NULL,
			opt.legend.cex=0.7,
			counter.diagonal=TRUE,
			pch=NULL)
</code></pre>

<hr>
<h2 id='calibration.plot'> Calibration Plot </h2><span id='topic+calibration.plot'></span>

<h3>Description</h3>

<p><code>calibration.plot</code> produces a goodness-of-fit plot for Presence/Absence data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibration.plot(DATA, which.model = 1, na.rm = FALSE, alpha = 0.05, N.bins = 5, 
xlab = "Predicted Probability of Occurrence", 
ylab = "Observed Occurrence as Proportion of Sites Surveyed", 
main = NULL, color= NULL, model.names= NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibration.plot_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="calibration.plot_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which model from <code>DATA</code> should be used</p>
</td></tr>
<tr><td><code id="calibration.plot_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td></tr>
<tr><td><code id="calibration.plot_+3A_alpha">alpha</code></td>
<td>
<p> alpha value for confidence intervals </p>
</td></tr>
<tr><td><code id="calibration.plot_+3A_n.bins">N.bins</code></td>
<td>
<p> number of bins to split predicted probabilities into </p>
</td></tr>
<tr><td><code id="calibration.plot_+3A_xlab">xlab</code></td>
<td>
<p> a title for the x axis</p>
</td></tr>
<tr><td><code id="calibration.plot_+3A_ylab">ylab</code></td>
<td>
<p> a title for the y axis</p>
</td></tr>
<tr><td><code id="calibration.plot_+3A_main">main</code></td>
<td>
<p> an overall title for the plot </p>
</td></tr>
<tr><td><code id="calibration.plot_+3A_color">color</code></td>
<td>
<p> a logical or a vector of color codes </p>
</td></tr>
<tr><td><code id="calibration.plot_+3A_model.names">model.names</code></td>
<td>
<p> a vector of the names of each model included in <code>DATA</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Takes a single model and creates a goodness-of-fit plot of observed verses predicted values. The plots are grouped into bins based on their predicted values, and then the bin prevalence (the ratio of plots in this bin with observed values of present verses the total number of plots in this bin) is calculated for each bin. The confidence interval for each bin is also plotted, and the total number of plots is labeled above each the bin.
</p>
<p>Confidence intervals are calculated for the binomial bin counts using the F distribution.
</p>
<p>Unlike a typical goodness-of-fit plot from a linear regression model, with Presence/Absence data having all the points lay along the diagonal does not necessarily imply a good quality model. The ideal calibration plot for Presence/Absence data depends on the intended use of the model.
</p>
<p>If the model is to be used to produce probability maps, then it is indeed desirable that (for example) 80 percent of plots with predicted probability of 0.8 actually do have observed Presence. In this case, having all the bins along the diagonal does indicate a good model.
</p>
<p>However, if model is to be used simply to predict species presence, then all that is required is that some threshold exists (not necessarily 0.5) where every plot with a lower predicted probability is observed Absent, and every plot with a higher predicted probability is observed Present. In this case, a good model will not necessarily (in fact, will rarely) have all the bins along the diagonal. (Note: for this purpose <code>presence.absence.hist</code> may produce more useful diagnostics.)
</p>
<p>If all the bins lie above the diagonal, or all the bins lie below the diagonal, it may indicate that the training and test datasets have different prevalence. In this case, it may be worthwhile to re-examine the initial data selection.
</p>


<h3>Value</h3>

<p>creates a graphical plot 
</p>
<p>returns a dataframe of information about the bins where:
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code>[,1]</code> </td><td style="text-align: left;"> <code>BinCenter</code> </td><td style="text-align: left;"> center of bin </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,2]</code> </td><td style="text-align: left;"> <code>NBin</code> </td><td style="text-align: left;"> Number of plots in Bin </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,3]</code> </td><td style="text-align: left;"> <code>BinObs</code> </td><td style="text-align: left;"> Proportion of Bin observed as Present </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,4]</code> </td><td style="text-align: left;"> <code>BinPred</code> </td><td style="text-align: left;"> Average prediction for Bin </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,5]</code> </td><td style="text-align: left;"> <code>BinObsCIlower</code> </td><td style="text-align: left;"> Lower bound of confidence Interval for <code>BinObs</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,6]</code> </td><td style="text-align: left;"> <code>BinObsCIupper</code> </td><td style="text-align: left;"> Upper bound of confidence Interval for <code>BinObs</code>  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a>  </p>


<h3>References</h3>

 
<p>Vaughan, I. P., Ormerod, S. J. 2005. The continuing challenges of testing species distribution models.  J. Appl. Ecol., 42:720-730.
</p>
<p>Reineking, B. and Schröder, B. 2006. Constrain to perform: regularization of habitat models. Ecological Modelling 193: 675-690.
</p>


<h3>See Also</h3>

 <p><a href="#topic+presence.absence.summary">presence.absence.summary</a>, <a href="#topic+presence.absence.hist">presence.absence.hist</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

calibration.plot(SIM3DATA)

calibration.plot(	DATA=SIM3DATA,
			which.model=3,
			na.rm=TRUE,
			alpha=0.05,
			N.bins=10,
			xlab="Predicted Probability of Occurence",
			ylab="Observed occurence as proportion of sites surveyed",
			model.names=NULL,
			main=NULL)
</code></pre>

<hr>
<h2 id='cmx'> Confusion Matrix </h2><span id='topic+cmx'></span>

<h3>Description</h3>

<p><code>cmx</code> calculates the confusion matrix for a single model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmx(DATA, threshold = 0.5, which.model = 1, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cmx_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> DATA[,1] </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> DATA[,2] </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> DATA[,3] </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> DATA[,4] </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  
	</td>
</tr>

</table>

</td></tr>
<tr><td><code id="cmx_+3A_threshold">threshold</code></td>
<td>
<p>a cutoff value between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. It must be a single value between zero and one.</p>
</td></tr>
<tr><td><code id="cmx_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which model from DATA should be used</p>
</td></tr>
<tr><td><code id="cmx_+3A_na.rm">na.rm</code></td>
<td>
<p> a logical indicating whether missing values should be removed</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cmx</code> calculates the confusion matrix for a single model at a single threshold. 
</p>
<p>If <code>DATA</code> contains more predictions from more than one model  <code>WHICH.DATA</code> can be used to specify which model should be used. If <code>WHICH.DATA</code> is not given, <code>cmx</code> will use predictions from the first model by default.
</p>
<p>When calculating the confusion matrix, any plot with a predicted probability greater than <code>threshold</code> is considered to be predicted <code>Present</code>, while any plot with a predicted probability less than or equal to <code>threshold</code> is considered to be predicted <code>Absent</code>. The only exception is when <code>threshold</code> equals zero. In that case, all plots are considered to be predicted <code>Present</code>.
</p>
<p>Unlike other functions in this library, <code>threshold</code> can not be a vector or an integer greater than one. Instead, <code>threshold</code> must be given as a single number between zero and one.
</p>
<p>If <code>na.rm</code> equals <code>FALSE</code> and <code>NA</code>'s are present in the <code>DATA</code> function will return <code>NA</code>.
</p>
<p>If <code>na.rm</code> equals <code>TRUE</code> and <code>NA</code>'s are present in the <code>DATA</code>, function will remove all rows where any of the values in the row consist of <code>NA</code>. Function will also print the number of rows that have been removed. 
</p>


<h3>Value</h3>

<p>the confusion matrix is returned in the form of a table where:
</p>
<table>
<tr><td><code>columns</code></td>
<td>
<p>observed values</p>
</td></tr>
<tr><td><code>rows</code></td>
<td>
<p>predicted values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+pcc">pcc</a></code>, <code><a href="#topic+sensitivity">sensitivity</a></code>, <code><a href="#topic+specificity">specificity</a></code>, <code><a href="#topic+Kappa">Kappa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### EXAMPLE 1 ###
     ### generate simulated data ###
     set.seed(666)
     N=1000
     SIMDATA&lt;-matrix(0,N,3)
     SIMDATA&lt;-as.data.frame(SIMDATA)
     names(SIMDATA)&lt;-c("plotID","Observed","Predicted")
     SIMDATA$plotID&lt;-1:N
     SIMDATA$Observed&lt;-rbinom(n=N,size=1,prob=.2)
     SIMDATA$Predicted[SIMDATA$Observed==1]&lt;-rnorm(n=length(SIMDATA$Observed[SIMDATA$Observed==1]),
                                                   mean=.8,sd=.15)
     SIMDATA$Predicted[SIMDATA$Observed==0]&lt;-rnorm(n=length(SIMDATA$Observed[SIMDATA$Observed==0]),
                                                   mean=.2,sd=.15)
     SIMDATA$Predicted&lt;-(SIMDATA$Predicted-min(SIMDATA$Predicted))/
                           (max(SIMDATA$Predicted)-min(SIMDATA$Predicted))

     ### plot simulated data
     hist(SIMDATA$Predicted,100)

     ### calculate confusion matrix ###
     cmx(SIMDATA)

### EXAMPLE 2 ###

     data(SIM3DATA)

     cmx(SIM3DATA)
     cmx(SIM3DATA,which.model=2)
     cmx(SIM3DATA,which.model=3,threshold=.2)

</code></pre>

<hr>
<h2 id='error.threshold.plot'> Error Threshold Plot </h2><span id='topic+error.threshold.plot'></span>

<h3>Description</h3>

<p><code>error.threshold.plot</code> takes a single model and plots the sensitivity and specificity as a function of threshold. It will optionally add other error statistics such as PCC and/or Kappa to the plot. Optionally, it will also optimize the choice of threshold by several criteria, return the results as a dataframe, and mark the optimized thresholds on the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>error.threshold.plot(DATA, threshold = 101, which.model = 1, na.rm = FALSE, 
xlab = "Threshold", ylab = "Accuracy Measures", main = NULL, model.names = NULL, 
color = NULL, line.type = NULL, lwd = 1, plot.it = TRUE, opt.thresholds = NULL, 
opt.methods = NULL, req.sens, req.spec, obs.prev = NULL, smoothing = 1, 
vert.lines = FALSE, add.legend = TRUE, legend.text = legend.names, 
legend.cex = 0.8, add.opt.legend = TRUE, opt.legend.text = NULL, 
opt.legend.cex = 0.7, pch = NULL, FPC, FNC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="error.threshold.plot_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_threshold">threshold</code></td>
<td>
<p>cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. It can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate.</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which model from <code>DATA</code> should be used</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_xlab">xlab</code></td>
<td>
<p> a title for the x axis</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_ylab">ylab</code></td>
<td>
<p> a title for the y axis</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_main">main</code></td>
<td>
<p> an overall title for the plot </p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_model.names">model.names</code></td>
<td>
<p> a vector of the names of each model included in <code>DATA</code> to be used in the legend box </p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_color">color</code></td>
<td>
<p> should each error statistic be plotted in a different color. It can be a logical value (where <code>TRUE</code> = color and <code>FALSE</code> = black and white), or a vector of color codes specifying particular colors for each line.</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_line.type">line.type</code></td>
<td>
<p> should each model be plotted in a different line type. It can be a logical value (where <code>TRUE</code> = dashed lines and <code>FALSE</code> = solid lines), or a vector of codes specifying particular line types for each line.</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_lwd">lwd</code></td>
<td>
<p> line width </p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_plot.it">plot.it</code></td>
<td>
<p> a logical indicating if a graphical plot should be produced</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_opt.thresholds">opt.thresholds</code></td>
<td>
<p> logical indicating whether the optimal thresholds should be calculated and plotted, or a vector specifying thresholds to plot </p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_opt.methods">opt.methods</code></td>
<td>
<p> what methods should be used to optimize thresholds. Given either as a vector of method names or method numbers. Possible values are:
</p>

<table>
<tr>
 <td style="text-align: right;">
  1  </td><td style="text-align: left;"> <code>Default</code>   </td><td style="text-align: left;"> threshold=0.5 </td>
</tr>
<tr>
 <td style="text-align: right;">
  2  </td><td style="text-align: left;"> <code>Sens=Spec</code> </td><td style="text-align: left;"> sensitivity=specificity </td>
</tr>
<tr>
 <td style="text-align: right;">
  3  </td><td style="text-align: left;"> <code>MaxSens+Spec</code> </td><td style="text-align: left;"> maximizes (sensitivity+specificity)/2 </td>
</tr>
<tr>
 <td style="text-align: right;">
  4  </td><td style="text-align: left;"> <code>MaxKappa</code>  </td><td style="text-align: left;"> maximizes Kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
  5  </td><td style="text-align: left;"> <code>MaxPCC</code>    </td><td style="text-align: left;"> maximizes PCC (percent correctly classified) </td>
</tr>
<tr>
 <td style="text-align: right;">
  6  </td><td style="text-align: left;"> <code>PredPrev=Obs</code> </td><td style="text-align: left;"> predicted prevalence=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  7  </td><td style="text-align: left;"> <code>ObsPrev</code>   </td><td style="text-align: left;"> threshold=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  8 </td><td style="text-align: left;"> <code>MeanProb </code> </td><td style="text-align: left;"> mean predicted probability </td>
</tr>
<tr>
 <td style="text-align: right;"> 
  9  </td><td style="text-align: left;"> <code>MinROCdist</code></td><td style="text-align: left;"> minimizes distance between ROC plot and (0,1)</td>
</tr>
<tr>
 <td style="text-align: right;">
  10 </td><td style="text-align: left;"> <code>ReqSens</code> </td><td style="text-align: left;"> user defined required sensitivity </td>
</tr>
<tr>
 <td style="text-align: right;">
  11 </td><td style="text-align: left;"> <code>ReqSpec</code> </td><td style="text-align: left;"> user defined required specificity </td>
</tr>
<tr>
 <td style="text-align: right;">
  12 </td><td style="text-align: left;"> <code>Cost</code> </td><td style="text-align: left;"> user defined relative costs ratio </td>
</tr>

</table>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_req.sens">req.sens</code></td>
<td>
<p>a value between zero and one giving the user defined required sensitivity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1-maximum allowable errors for points with positive observations).</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_req.spec">req.spec</code></td>
<td>
<p>a value between zero and one giving the user defined required sspecificity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1- maximum allowable errors for points with negative observations).</p>
</td></tr>  
<tr><td><code id="error.threshold.plot_+3A_obs.prev">obs.prev</code></td>
<td>
<p>observed prevalence for <code>opt.method</code> = <code>"PredPrev=Obs"</code> and <code>"ObsPrev"</code>. Defaults to observed prevalence from <code>DATA</code>.</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_smoothing">smoothing</code></td>
<td>
<p>smoothing factor for maximizing/minimizing. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Instead of find the threshold that gives the max/min value, function will average the thresholds of the given number of max/min values.</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_vert.lines">vert.lines</code></td>
<td>
<p>a logical where: <code>TRUE</code> means vertical lines added to plot at optimal thresholds; <code>FALSE</code> means no vertical lines, instead optimal thresholds marked along error statistics plots. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. </p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_add.legend">add.legend</code></td>
<td>
<p>logical indicating if a legend for accuracy statistics should be included on the plot </p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_legend.text">legend.text</code></td>
<td>
<p>a vector of text for accuracy statistics legend. Defaults to name of each accuracy statistic. </p>
</td></tr>   
<tr><td><code id="error.threshold.plot_+3A_legend.cex">legend.cex</code></td>
<td>
<p>cex for presence/absence legend</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_add.opt.legend">add.opt.legend</code></td>
<td>
<p>logical indicating if a legend for optimal threshold criteria should be included on the plot</p>
</td></tr>  
<tr><td><code id="error.threshold.plot_+3A_opt.legend.text">opt.legend.text</code></td>
<td>
<p>a vector of text for optimimal threshold criteria legend. Defaults to text corresponding to 'opt.methods'.</p>
</td></tr>   
<tr><td><code id="error.threshold.plot_+3A_opt.legend.cex">opt.legend.cex</code></td>
<td>
<p>cex for optimization criteria legend</p>
</td></tr> 
<tr><td><code id="error.threshold.plot_+3A_pch">pch</code></td>
<td>
<p>plotting &quot;character&quot;, i.e., symbol to use for the thresholds specified in <code>MARK</code>.  <code>pch</code> can either be a single character or an integer code for one of a set of graphics symbols.  See <code>help(points)</code> for details. </p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_fpc">FPC</code></td>
<td>
<p> False Positive Costs, or for C/B ratio C = 'net costs of treating nondiseased individuals'.</p>
</td></tr>
<tr><td><code id="error.threshold.plot_+3A_fnc">FNC</code></td>
<td>
<p> False Negative Costs, or for C/B ratio B = 'net benefits of treating diseased individuals'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>error.threshold.plot</code> serves two purposes. First, if <code>plot.it</code> = <code>TRUE</code>, it produces a graphical plot. Second, if <code>opt.thresholds</code> = <code>TRUE</code> it will find optimal thresholds by several criteria. These optimal thresholds, along with basic accuracy measures for each type of optimal threshold will be returned as a dataframe. If a plot is produced, these optimal thresholds will be added to the plot.
</p>
<p>The graphical plot will always include lines showing sensitivity and specificity as a function of threshold. In addition, for <code>opt.methods</code> = <code>"MaxKappa"</code>, <code>"MaxPCC"</code>, <code>"MinROCdist"</code>, or <code>"MaxSens+Spec"</code> additional lines will be added to show the statistic being maximized/minimized. 
</p>
<p>These lines will be added to graph even if <code>opt.thresholds</code> = <code>FALSE</code>. So for example, to produce a graph showing sensitivity, specificity, and Kappa as functions of threshold, with out marking the optimal thresholds, set <code>opt.thresholds</code> = <code>FALSE</code>, and <code>opt.methods</code> = <code>"MaxKappa"</code>.
</p>
<p>See <a href="#topic+optimal.thresholds">optimal.thresholds</a> for more details on the optimization methods, and on the arguments <code>ReqSens</code>, <code>ReqSpec</code>, <code>obs.prev</code>, <code>smoothing</code>, <code>FPC</code>, and <code>FNC</code>.
</p>
<p>When <code>opt.thresholds</code> = <code>TRUE</code>, the default is to plot the optimal thresholds directly along the corresponding error statistics (or along the sensitivity line if the method has no corresponding error statistic). If the argument <code>vert.lines</code> = <code>TRUE</code>, a vertical line is drawn at each optimal threshold, and the lines are labeled across the top of the plot.
</p>
<p>Note: if too many methods are included in <code>opt.methods</code>, the graph will get very crowded.
</p>


<h3>Value</h3>

<p>If <code>plot.it</code> = <code>TRUE</code> creates a graphical plot.
</p>
<p>If <code>opt.thresholds</code> = <code>TRUE</code>, returns a dataframe of information about the optimal thresholds where:
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code>[,1]</code> </td><td style="text-align: left;"> <code>legend.names</code> </td><td style="text-align: left;"> type of optimal threshold </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,2]</code> </td><td style="text-align: left;"> <code>threshold</code> </td><td style="text-align: left;"> optimal threshold</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,3]</code> </td><td style="text-align: left;"> <code>PCC</code> </td><td style="text-align: left;"> at that threshold </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,4]</code> </td><td style="text-align: left;"> <code>sensitivity</code> </td><td style="text-align: left;"> at that threshold </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,5]</code> </td><td style="text-align: left;"> <code>specificity</code> </td><td style="text-align: left;"> at that threshold </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,6]</code> </td><td style="text-align: left;"> <code>Kappa</code> </td><td style="text-align: left;"> at that threshold </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a>  </p>


<h3>See Also</h3>

 <p><a href="#topic+optimal.thresholds">optimal.thresholds</a>, <a href="#topic+presence.absence.accuracy">presence.absence.accuracy</a>, <a href="#topic+roc.plot.calculate">roc.plot.calculate</a>, <a href="#topic+presence.absence.summary">presence.absence.summary</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(SIM3DATA)

error.threshold.plot(SIM3DATA,opt.methods=c(1,2,5))

error.threshold.plot( SIM3DATA, 
                      which.model=2, 
                      opt.thresholds=TRUE, 
		      opt.methods=c("Default", "Sens=Spec", "MinROCdist"), 
                      vert.lines=TRUE)


error.threshold.plot(	SIM3DATA,
				threshold=101,
				which.model=2,
				na.rm=TRUE,
				xlab="Threshold",
				ylab="Accuracy Measures",
				main="Error Rate verses Threshold",
				model.names=NULL, 
				pch=NULL,
				color= c(3,5,7),
				line.type=NULL,
				lwd=1,
				plot.it=TRUE,
				opt.thresholds=TRUE,
				opt.methods=1:4,
				req.sens=0.85,
				req.spec=0.85,
				obs.prev=NULL,
				smoothing=1,
				vert.lines=FALSE,
				add.legend=TRUE,
				legend.cex=0.8)


</code></pre>

<hr>
<h2 id='Kappa'> Kappa </h2><span id='topic+Kappa'></span>

<h3>Description</h3>

<p><code>Kappa</code> calculates Kappa and (optionally) the associated standard deviation from a confusion matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kappa(CMX, st.dev = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kappa_+3A_cmx">CMX</code></td>
<td>
<p> a confusion matrix - output from <code>cmx</code> </p>
</td></tr>
<tr><td><code id="Kappa_+3A_st.dev">st.dev</code></td>
<td>
<p> a logical indicating whether the associated standard deviation should be calculated </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Kappa statistic summarizes all the available information in the confusion matrix. Kappa measures the proportion of correctly classified units after accounting for the probability of chance agreement.  
</p>


<h3>Value</h3>

<p>if <code>st.dev</code> = FALSE, returns: <code>Kappa</code>. <br />
</p>
<p>if <code>st.dev</code> = TRUE, returns a dataframe where:
</p>

<table>
<tr>
 <td style="text-align: left;">
[1,1] </td><td style="text-align: left;"> <code>Kappa</code>        </td><td style="text-align: left;">                                    </td>
</tr>
<tr>
 <td style="text-align: left;">
[1,2] </td><td style="text-align: left;"> <code>Kappa.sd</code>     </td><td style="text-align: left;"> standard deviation of <code>Kappa</code> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+cmx">cmx</a></code>, <code><a href="#topic+pcc">pcc</a></code>, <code><a href="#topic+sensitivity">sensitivity</a></code>, <code><a href="#topic+specificity">specificity</a></code>, <code><a href="#topic+auc">auc</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

Kappa(cmx(SIM3DATA))

Kappa(cmx(SIM3DATA),st.dev=FALSE)
</code></pre>

<hr>
<h2 id='optimal.thresholds'> Calculate Optimal Thresholds </h2><span id='topic+optimal.thresholds'></span>

<h3>Description</h3>

<p><code>optimal.thresholds</code> calculates optimal thresholds for Presence/Absence data by any of several methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimal.thresholds(DATA = NULL, threshold = 101, which.model = 1:(ncol(DATA)-2), 
model.names = NULL, na.rm = FALSE, opt.methods = NULL, req.sens, req.spec, 
obs.prev = NULL, smoothing = 1, FPC, FNC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimal.thresholds_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_threshold">threshold</code></td>
<td>
<p>cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. It can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate. To get reasonably good optimizations, there should be a large number of thresholds.</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_which.model">which.model</code></td>
<td>
<p>a number or vector indicating which models from <code>DATA</code> should be used</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_model.names">model.names</code></td>
<td>
<p> a vector of the names of each model included in <code>DATA</code> to be used as column names</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_opt.methods">opt.methods</code></td>
<td>
<p> what methods should be used to optimize thresholds. Given either as a vector of method names or method numbers. Possible values are:
</p>

<table>
<tr>
 <td style="text-align: right;">
  1  </td><td style="text-align: left;"> <code>Default</code>   </td><td style="text-align: left;"> threshold=0.5 </td>
</tr>
<tr>
 <td style="text-align: right;">
  2  </td><td style="text-align: left;"> <code>Sens=Spec</code> </td><td style="text-align: left;"> sensitivity=specificity </td>
</tr>
<tr>
 <td style="text-align: right;">
  3  </td><td style="text-align: left;"> <code>MaxSens+Spec</code> </td><td style="text-align: left;"> maximizes (sensitivity+specificity)/2 </td>
</tr>
<tr>
 <td style="text-align: right;">
  4  </td><td style="text-align: left;"> <code>MaxKappa</code>  </td><td style="text-align: left;"> maximizes Kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
  5  </td><td style="text-align: left;"> <code>MaxPCC</code>    </td><td style="text-align: left;"> maximizes PCC (percent correctly classified) </td>
</tr>
<tr>
 <td style="text-align: right;">
  6  </td><td style="text-align: left;"> <code>PredPrev=Obs</code> </td><td style="text-align: left;"> predicted prevalence=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  7  </td><td style="text-align: left;"> <code>ObsPrev</code>   </td><td style="text-align: left;"> threshold=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  8  </td><td style="text-align: left;"> <code>MeanProb</code> </td><td style="text-align: left;"> mean predicted probability </td>
</tr>
<tr>
 <td style="text-align: right;"> 
  9  </td><td style="text-align: left;"> <code>MinROCdist</code></td><td style="text-align: left;"> minimizes distance between ROC plot and (0,1)</td>
</tr>
<tr>
 <td style="text-align: right;">
  10 </td><td style="text-align: left;"> <code>ReqSens</code> </td><td style="text-align: left;"> user defined required sensitivity </td>
</tr>
<tr>
 <td style="text-align: right;">
  11 </td><td style="text-align: left;"> <code>ReqSpec</code> </td><td style="text-align: left;"> user defined required specificity </td>
</tr>
<tr>
 <td style="text-align: right;">
  12 </td><td style="text-align: left;"> <code>Cost</code> </td><td style="text-align: left;"> user defined relative costs ratio </td>
</tr>

</table>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_req.sens">req.sens</code></td>
<td>
<p> a value between zero and one giving the user defined required sensitivity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1-maximum allowable errors for points with positive observations).</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_req.spec">req.spec</code></td>
<td>
<p> a value between zero and one giving the user defined required sspecificity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1- maximum allowable errors for points with negative observations).</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_obs.prev">obs.prev</code></td>
<td>
<p>observed prevalence for <code>opt.method</code> = <code>"PredPrev=Obs"</code> and <code>"ObsPrev"</code>. Defaults to observed prevalence from <code>DATA</code>.</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_smoothing">smoothing</code></td>
<td>
<p> smoothing factor for maximizing/minimizing. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Instead of find the threshold that gives the max/min value, function will average the thresholds of the given number of max/min values.</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_fpc">FPC</code></td>
<td>
<p> False Positive Costs, or for C/B ratio C = 'net costs of treating nondiseased individuals'.</p>
</td></tr>
<tr><td><code id="optimal.thresholds_+3A_fnc">FNC</code></td>
<td>
<p> False Negative Costs, or for C/B ratio B = 'net benefits of treating diseased individuals'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'opt.methods' argument is allows the user to choose optimization
methods.  The methods can be specified by number (<code>opt.methods</code> = <code>1:12</code> or <code>opt.methods</code> = <code>c(1,2,4)</code>) or by name (<code>opt.methods</code> = <code>c("Default","Sens=Spec","MaxKappa")</code>).
</p>
<p>There are currently twelve optimization criteria available:
</p>
<p><code>"Default"</code> First, the default criteria of setting 'threshold = 0.5'
</p>
<p><code>"Sens=Spec"</code> The second criteria for optimizing threshold choice is by finding the threshold where sensitivity equals specificity. In other words, find the threshold where positive observations are just as likely to be wrong as negative observations. 
</p>
<p>Note: when threshold is optimized by criteria <code>"Sens=Spec"</code> it is correlated to prevalence, so that rare species are given much lower thresholds than widespread species. As a result, rare species may give the appearance of inflated distribution, if maps are made with thresholds that have been optimized by this method (Manel, 2001).
</p>
<p><code>"MaxSens+Spec"</code> The third criteria chooses the threshold that maximizes the sum of sensitivity and specificity. In other words, it is minimizing the mean of the error rate for positive observations and the error rate for negative observations. This is equivalent to maximizing (sensitivity + specificity - 1), otherwise know as the Youden's index, or the True Skill Statistic. Note that while Youden's Index is independent of prevalence, using Youden's index to select a threshold does have an effect on the predicted prevalence, causing the distribution of rare species to be over predicted.
</p>
<p><code>"MaxKappa"</code> The forth criteria for optimizing the threshold choice is to find the threshold that gives the maximum value of Kappa. Kappa makes full use of the information in the confusion matrix to asses the improvement over chance prediction.
</p>
<p><code>"MaxPCC"</code> The fifth criteria is to maximize the total accuracy (PCC - Percent Correctly Classified).
</p>
<p>Note: It may seem like maximizing total accuracy would be the obvious goal, however, there are many problems with using PCC to assess model accuracy. For example, with species with very low prevalence, it is possible to maximize PCC simply by declaring the species a absent at all locations &ndash; not a very useful prediction!
</p>
<p><code>"PredPrev=Obs"</code> The sixth criteria is to find the threshold where the Predicted prevalence is equal to the Observed prevalence. This is a useful method when preserving prevalence is of prime importance.
</p>
<p><code>"ObsPrev"</code> The seventh criteria is an even simpler variation, where you simply set the threshold to the Observed prevalence. It is nearly as good as method six at preserving prevalence and requires no computation.
</p>
<p><code>"MeanProb"</code> The eighth criteria also requires no threshold computation. Method eight sets the threshold to the mean probability of occurrence from the model results.
</p>
<p><code>"MinROCdist"</code> The ninth criteria is to find the threshold that minimizes the distance between the ROC plot and the upper left corner of the unit square.
</p>
<p><code>"ReqSens"</code> The tenth criteria allows the user to set a required sensitivity, and then finds the highest threshold that will meet this requirement. In other words, the user can decide that the model must miss no more than, for example 15 percent of the plots where the species is observed to be present. Therefore they require a sensitivity of at least 0.85. This may be useful if, for example, the goal is to define a management area for a rare species, and they want to be certain that the management area doesn't leave unprotected too many populations.
</p>
<p><code>"ReqSpec"</code> The eleventh criteria allows the user to set a required specificity, and then finds the lowest threshold that will meet this requirement. In other words, the user can decide that the model must miss no more than, for example 15 percent of the plots where the species is observed to be absent. Therefore they require a specificity of at least 0.85. This may be useful if, for example, the goal is to determine if a species is threatened, and they want to be certain not to over inflate the population by over declaring true absences as predicted presences.
</p>
<p>Note: for <code>"ReqSens"</code> and <code>"ReqSpec"</code>, if your model is poor, and your requirement is too strict, it is possible that the only way to meet it will be by declaring every single plot to be Present (for ReqSens) or Absent (for ReqSpec) &ndash; not a very useful method of prediction! Conversely, if the model is good, and the requirement too lax, the resulting thresholds will result in unnecessary levels on inaccuracy. If a threshold exists where sensitivity equals specificity at a value greater than the required accuracy, then the user can raise their required specificity (or sensitivity) without sacrificing sensitivity (or specificity).
</p>
<p><code>"Cost"</code> The twelth criteria balances the relative costs of false positive predictions and false negative predictions. A slope is calculated as (FPC/FNC)((1 - prevalence)/prevalence). To determine the threshold, a line of this slope is moved from the top left of the ROC plot, till it first touches the ROC curve.
</p>
<p>Note: the criteria <code>"Cost"</code> can also be used for C/B ratio analysis of diagnostic tests. In this case <code>FPC</code> = <code>C</code> (the net costs of treating nondiseased individuals) and <code>FNC</code> = <code>B</code> (the net benafits of treating diseased individuals). For further information on <code>"Cost"</code> see Wilson et. al. (2005) and Cantor et. al. (1999).
</p>
<p>For all the criteria that depend on observed prevalence (<code>"PredPrev=Obs"</code>, <code>"ObsPrev"</code> and <code>cost</code>) , the default is to use the observed prevalence from <code>DATA</code>. However, the argument <code>obs.prev</code> can be used to substiture a predetermined value for observed prevalence, for example, the prevalence from a larger dataset.
</p>
<p><code>error.threshold.plot</code> is a rough and ready function. It optimizes thresholds simply by calculating a large number of evenly spaced thresholds and looking for the best ones. This is good enough for graphs, but to find the theoretically 'best' thresholds, would require calculating every possible unique threshold (not necessarily evenly spaced!).
</p>
<p>Details on <code>smoothing</code> argument: when the statistic being maximized (e.g. Kappa) is relatively flat but erratic, just picking the threshold that gives single maximum value is somewhat arbitrary. <code>smoothing</code> compensates for this by taking an average of the thresholds that give a set number of the highest values (e.g. the 10 highest Kappa's, or the 20 highest Kappa's).
</p>


<h3>Value</h3>

<p>If <code>DATA</code> is not provided function will return a vector of the possible optimization methods. 
</p>
<p>Otherwise, returns a dataframe where:
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code>[,1]</code> </td><td style="text-align: left;"> <code>Method</code> - names of optimization methods </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,2]</code> </td><td style="text-align: left;"> optimal thresholds for the first model</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>[,3]</code> </td><td style="text-align: left;"> optimal thresholds for the second model, etc...</td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>References</h3>

 
<p>S.B. Cantor, C.C. Sun, G. Tortolero-Luna, R. Richards-Kortum, and M. Follen. A comparison of C/B ratios from studies using receiver operating characteristic curve analysis. Journal of Clinical Epidemiology, 52(9):885-892, 1999.
</p>
<p>S. Manel, H.C. Williams, and S.J. Ormerod. Evaluating presence-absence models in ecology: the need to account for prevalence. Journal of Applied Ecology, 38:921-931, 2001.
K.A. Wilson, M.I. Westphal, H.P. Possingham. and J. Elith. Sensitivity of conservation planning to different approaches to using predicted species distribution data. Biological Conservation, 22(1):99-112, 2004.
</p>


<h3>See Also</h3>

 <p><a href="#topic+error.threshold.plot">error.threshold.plot</a>, <a href="#topic+presence.absence.accuracy">presence.absence.accuracy</a>, <a href="#topic+roc.plot.calculate">roc.plot.calculate</a>, <a href="#topic+presence.absence.summary">presence.absence.summary</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)
optimal.thresholds(SIM3DATA)
</code></pre>

<hr>
<h2 id='pcc'> Percent Correctly Classified </h2><span id='topic+pcc'></span>

<h3>Description</h3>

<p><code>pcc</code> calculates the percent correctly classified and (optionally) the associated standard deviation from a confusion matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcc(CMX, st.dev = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcc_+3A_cmx">CMX</code></td>
<td>
<p> a confusion matrix - output from <code>cmx</code> </p>
</td></tr>
<tr><td><code id="pcc_+3A_st.dev">st.dev</code></td>
<td>
<p> a logical indicating whether the associated standard deviation should be calculated </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Percent Correctly Classified is simply the proportion of test observations that are correctly classified. 
</p>


<h3>Value</h3>

<p>if <code>st.dev</code> = FALSE, returns: <code>PCC</code> percent correctly classified.
<br />
</p>
<p>if <code>st.dev</code> = TRUE, returns a dataframe where:
</p>

<table>
<tr>
 <td style="text-align: left;">
[1,1] </td><td style="text-align: left;"> <code>PCC</code>       	</td><td style="text-align: left;"> percent correctly classified            </td>
</tr>
<tr>
 <td style="text-align: left;">
[1,2] </td><td style="text-align: left;"> <code>PCC.sd</code>     	</td><td style="text-align: left;"> standard deviation of <code>PCC</code>          </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+cmx">cmx</a></code>, <code><a href="#topic+sensitivity">sensitivity</a></code>, <code><a href="#topic+specificity">specificity</a></code>, <code><a href="#topic+Kappa">Kappa</a></code>, <code><a href="#topic+auc">auc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

pcc(cmx(SIM3DATA))

pcc(cmx(SIM3DATA),st.dev=FALSE)
</code></pre>

<hr>
<h2 id='predicted.prevalence'> Predicted Prevalence </h2><span id='topic+predicted.prevalence'></span>

<h3>Description</h3>

<p><code> predicted.prevalence </code> calculates the observed prevalence and predicted prevalence for one or more models at one or more thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predicted.prevalence(DATA, threshold = 0.5, which.model = (1:N.models), na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predicted.prevalence_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="predicted.prevalence_+3A_threshold">threshold</code></td>
<td>
<p>a cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. <code>threshold</code> can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate. </p>
</td></tr>
<tr><td><code id="predicted.prevalence_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which models from DATA should be used</p>
</td></tr>
<tr><td><code id="predicted.prevalence_+3A_na.rm">na.rm</code></td>
<td>
<p> a logical indicating whether missing values should be removed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function will work for one model and multiple thresholds, or one threshold and multiple models, or multiple models each with their own threshold.
</p>


<h3>Value</h3>

<p>returns a dataframe where: 
</p>

<table>
<tr>
 <td style="text-align: left;">
[,1] </td><td style="text-align: left;"> <code>threshold</code>   </td><td style="text-align: left;"> thresholds used for each row in the table </td>
</tr>
<tr>
 <td style="text-align: left;">
[,2] </td><td style="text-align: left;"> <code>Obs.Prevalence</code>  </td><td style="text-align: left;"> this will be the same in each row</td>
</tr>
<tr>
 <td style="text-align: left;">
[,3] </td><td style="text-align: left;"> <code>Model 1</code> </td><td style="text-align: left;"> Predicted prevalence for first model</td>
</tr>
<tr>
 <td style="text-align: left;">
[,4] </td><td style="text-align: left;"> <code>Model 2</code> </td><td style="text-align: left;"> Predicted prevalence for second model, etc...</td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

predicted.prevalence(SIM3DATA)
predicted.prevalence(SIM3DATA,threshold=11,which.model=1,na.rm=FALSE)
predicted.prevalence(SIM3DATA,threshold=c(.2,.5,.7),na.rm=FALSE)
</code></pre>

<hr>
<h2 id='presence.absence.accuracy'> Accuracy Table for Presence/Absence Data </h2><span id='topic+presence.absence.accuracy'></span>

<h3>Description</h3>

<p>Calculates five accuracy measures (pcc, sensitivity, specificity, Kappa, and AUC) for Presence/Absence data, and (optionally) their associated standard deviations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>presence.absence.accuracy(DATA, threshold = 0.5, find.auc = TRUE, st.dev = TRUE, 
which.model = (1:(ncol(DATA) - 2)), na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="presence.absence.accuracy_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="presence.absence.accuracy_+3A_threshold">threshold</code></td>
<td>
<p>a cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. If calculations are to be performed on a single model prediction <code>threshold</code> can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate. If calculations are to be performed on multiple model predictions, then <code>threshold</code> must be either a single value between zero and one, or a vector of the same length as the number of models.</p>
</td></tr>  
<tr><td><code id="presence.absence.accuracy_+3A_find.auc">find.auc</code></td>
<td>
<p>a logical indicating if area under the curve should be calculated</p>
</td></tr>
<tr><td><code id="presence.absence.accuracy_+3A_st.dev">st.dev</code></td>
<td>
<p>a logical indicating if standard deviations should be calculated</p>
</td></tr>
<tr><td><code id="presence.absence.accuracy_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which models from <code>DATA</code> should be used</p>
</td></tr>
<tr><td><code id="presence.absence.accuracy_+3A_na.rm">na.rm</code></td>
<td>
<p> a logical indicating whether missing values should be removed</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>presence.absence.accuracy</code> calculates five standard accuracy measures for presence absence data, and (optionally) their associated standard deviations.
</p>
<p>Function will work for one model and multiple thresholds, or one threshold and multiple models, or multiple models each with their own threshold.
</p>
<p>Depending on the size of the dataset and the speed of the computer this function may take a couple of minutes to run. Finding the AUC is the slowest part of this function. The AUC can be suppressed by setting <code>find.auc</code> = FALSE.
</p>
<p><code>which.model</code> can be used to specify which of the prediction models from <code>DATA</code> should be used.
</p>


<h3>Value</h3>

<p>if <code>st.dev</code> = FALSE, returns a dataframe where: 
</p>

<table>
<tr>
 <td style="text-align: left;">
 [,1] </td><td style="text-align: left;"> <code>model</code>       </td><td style="text-align: left;"> model name (column name from <code>DATA</code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
 [,2] </td><td style="text-align: left;"> <code>threshold</code>   </td><td style="text-align: left;"> thresholds used for each row in the table </td>
</tr>
<tr>
 <td style="text-align: left;">
 [,3] </td><td style="text-align: left;"> <code>PCC</code>       	</td><td style="text-align: left;"> percent correctly classified              </td>
</tr>
<tr>
 <td style="text-align: left;">
 [,4] </td><td style="text-align: left;"> <code>sensitivity</code> </td><td style="text-align: left;">                                           </td>
</tr>
<tr>
 <td style="text-align: left;">
 [,5] </td><td style="text-align: left;"> <code>specificity</code> </td><td style="text-align: left;">                                           </td>
</tr>
<tr>
 <td style="text-align: left;">
 [,6] </td><td style="text-align: left;"> <code>Kappa</code>       </td><td style="text-align: left;">                                           </td>
</tr>
<tr>
 <td style="text-align: left;">
 [,7] </td><td style="text-align: left;"> <code>AUC</code>         </td><td style="text-align: left;"> area under the curve                      
</td>
</tr>

</table>

<p>if <code>st.dev</code> = TRUE, returns a dataframe where:
</p>

<table>
<tr>
 <td style="text-align: left;">
[,1] </td><td style="text-align: left;"> <code>model</code>       </td><td style="text-align: left;"> model name (column name from <code>DATA</code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
[,2] </td><td style="text-align: left;"> <code>threshold</code>   </td><td style="text-align: left;"> thresholds used for each row in the table </td>
</tr>
<tr>
 <td style="text-align: left;">
[,3] </td><td style="text-align: left;"> <code>PCC</code>         </td><td style="text-align: left;"> percent correctly classified              </td>
</tr>
<tr>
 <td style="text-align: left;">
[,4] </td><td style="text-align: left;"> <code>sensitivity</code> </td><td style="text-align: left;">                                           </td>
</tr>
<tr>
 <td style="text-align: left;">
[,5] </td><td style="text-align: left;"> <code>specificity</code> </td><td style="text-align: left;">                                           </td>
</tr>
<tr>
 <td style="text-align: left;">
[,6] </td><td style="text-align: left;"> <code>Kappa</code>       </td><td style="text-align: left;">                                           </td>
</tr>
<tr>
 <td style="text-align: left;">
[,7] </td><td style="text-align: left;"> <code>AUC</code>         </td><td style="text-align: left;"> area under the curve                      </td>
</tr>
<tr>
 <td style="text-align: left;">
[,8] </td><td style="text-align: left;"> <code>PCC.sd</code>     	 </td><td style="text-align: left;"> standard deviation of <code>PCC</code>        </td>
</tr>
<tr>
 <td style="text-align: left;">
[,9] </td><td style="text-align: left;"> <code>sensitivity.sd</code></td><td style="text-align: left;"> standard deviation of <code>sensitivity</code></td>
</tr>
<tr>
 <td style="text-align: left;">
[,10]</td><td style="text-align: left;"> <code>specificity.sd</code></td><td style="text-align: left;"> standard deviation of <code>specificity</code></td>
</tr>
<tr>
 <td style="text-align: left;">
[,11]</td><td style="text-align: left;"> <code>Kappa.sd</code>      </td><td style="text-align: left;"> standard deviation of <code>Kappa</code>      </td>
</tr>
<tr>
 <td style="text-align: left;">
[,12]</td><td style="text-align: left;"> <code>AUC.sd</code>      </td><td style="text-align: left;"> standard deviation of <code>AUC</code>      
</td>
</tr>

</table>

<p>if <code>find.auc</code> = FALSE, then columns for <code>AUC</code> and <code>AUC.sd</code> are not returned.
</p>


<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

 
<p><code><a href="#topic+cmx">cmx</a></code>, <code><a href="#topic+pcc">pcc</a></code>, <code><a href="#topic+sensitivity">sensitivity</a></code>, <code><a href="#topic+specificity">specificity</a></code>, <code><a href="#topic+Kappa">Kappa</a></code>, <code><a href="#topic+auc">auc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(SIM3DATA)

### EXAMPLE 1 - multiple model predictions at one threshold###

presence.absence.accuracy(SIM3DATA)
presence.absence.accuracy(SIM3DATA,threshold=.4,st.dev=FALSE)
presence.absence.accuracy(SIM3DATA, which.model=c(1,3),st.dev=FALSE)

### EXAMPLE 2 - one model prediction at multiple thresholds ###

presence.absence.accuracy(SIM3DATA, threshold=c(.25,.5,.75), which.model=3)
presence.absence.accuracy(SIM3DATA, threshold=11, which.model=2)

### EXAMPLE 3 - multiple model predictions, each at it's own treshold ###

presence.absence.accuracy(SIM3DATA, threshold=c(.5,.5,.2), which.model=c(1,2,2))


</code></pre>

<hr>
<h2 id='presence.absence.hist'> Presence/Absence Histogram </h2><span id='topic+presence.absence.hist'></span>

<h3>Description</h3>

<p>Produces a histogram of predicted probabilities with each bar subdivided by observed values. <code>presence.absence.hist</code> also includes an option to mark several types of optimal thresholds along each plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>presence.absence.hist(DATA, which.model = 1, na.rm = FALSE, 
xlab = "predicted probability", ylab = "number of plots", 
main = NULL, model.names = NULL, color = NULL, N.bars = 20, 
truncate.tallest = FALSE, ylim = 1.25 * range(0, apply(counts, 2, sum)),
opt.thresholds = NULL, threshold = 101, opt.methods = NULL, 
req.sens, req.spec, obs.prev = NULL, smoothing = 1, add.legend = TRUE, 
legend.text=c("present","absent"), legend.cex = 0.8, add.opt.legend = TRUE, 
opt.legend.text = NULL, opt.legend.cex = 0.7, pch = NULL, FPC, FNC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="presence.absence.hist_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which model from <code>DATA</code> should be used</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_main">main</code></td>
<td>
<p>an overall title for the plot </p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_model.names">model.names</code></td>
<td>
<p>a vector of the names of each model included in <code>DATA</code></p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_color">color</code></td>
<td>
<p>colors for presence/absence. Defaults to Presence = dark gray, Absence = light gray.</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_n.bars">N.bars</code></td>
<td>
<p>number of bars in histogram </p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_truncate.tallest">truncate.tallest</code></td>
<td>
<p> a logical indicating if the tallest bar should be truncated to fit on plot</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_ylim">ylim</code></td>
<td>
<p>limit for y axis. To allow room for legend box <code>ylim</code> should be somewhat larger than largest bar.</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_opt.thresholds">opt.thresholds</code></td>
<td>
<p>a logical indicating whether the optimal thresholds should be calculated and plotted, or a vector specifying thresholds to plot</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_threshold">threshold</code></td>
<td>
<p>cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. It can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate. To get reasonably good optimizations, there should be a large number of thresholds. (Only used if <code>opt.thresholds</code> = <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_opt.methods">opt.methods</code></td>
<td>
<p> what methods should be used to optimize thresholds. Argument can be given either as a vector of method names or method numbers. Possible values are:
</p>

<table>
<tr>
 <td style="text-align: right;">
  1  </td><td style="text-align: left;"> <code>Default</code>   </td><td style="text-align: left;"> threshold=0.5 </td>
</tr>
<tr>
 <td style="text-align: right;">
  2  </td><td style="text-align: left;"> <code>Sens=Spec</code> </td><td style="text-align: left;"> sensitivity=specificity </td>
</tr>
<tr>
 <td style="text-align: right;">
  3  </td><td style="text-align: left;"> <code>MaxSens+Spec</code> </td><td style="text-align: left;"> maximizes (sensitivity+specificity)/2 </td>
</tr>
<tr>
 <td style="text-align: right;">
  4  </td><td style="text-align: left;"> <code>MaxKappa</code>  </td><td style="text-align: left;"> maximizes Kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
  5  </td><td style="text-align: left;"> <code>MaxPCC</code>    </td><td style="text-align: left;"> maximizes PCC (percent correctly classified) </td>
</tr>
<tr>
 <td style="text-align: right;">
  6  </td><td style="text-align: left;"> <code>PredPrev=Obs</code> </td><td style="text-align: left;"> predicted prevalence=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  7  </td><td style="text-align: left;"> <code>ObsPrev</code>   </td><td style="text-align: left;"> threshold=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  8 </td><td style="text-align: left;"> <code>MeanProb </code> </td><td style="text-align: left;"> mean predicted probability </td>
</tr>
<tr>
 <td style="text-align: right;"> 
  9  </td><td style="text-align: left;"> <code>MinROCdist</code></td><td style="text-align: left;"> minimizes distance between ROC plot and (0,1)</td>
</tr>
<tr>
 <td style="text-align: right;">
  10 </td><td style="text-align: left;"> <code>ReqSens</code> </td><td style="text-align: left;"> user defined required sensitivity </td>
</tr>
<tr>
 <td style="text-align: right;">
  11 </td><td style="text-align: left;"> <code>ReqSpec</code> </td><td style="text-align: left;"> user defined required specificity </td>
</tr>

</table>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_req.sens">req.sens</code></td>
<td>
<p> a value between zero and one giving the user defined required sensitivity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1-maximum allowable errors for points with positive observations).</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_req.spec">req.spec</code></td>
<td>
<p> a value between zero and one giving the user defined required sspecificity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1- maximum allowable errors for points with negative observations).</p>
</td></tr>  
<tr><td><code id="presence.absence.hist_+3A_obs.prev">obs.prev</code></td>
<td>
<p>observed prevalence for <code>opt.method</code> = <code>"PredPrev=Obs"</code> and <code>"ObsPrev"</code>. Defaults to observed prevalence from <code>DATA</code>.</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_smoothing">smoothing</code></td>
<td>
<p>smoothing factor for maximizing/minimizing. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Instead of find the threshold that gives the max/min value, function will average the thresholds of the given number of max/min values.</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_add.legend">add.legend</code></td>
<td>
<p>a logical indicating if a legend for presence/absence should be added to plot</p>
</td></tr>   
<tr><td><code id="presence.absence.hist_+3A_legend.text">legend.text</code></td>
<td>
<p>a two item vector of text for presence/absence legend. Defaults to &quot;present&quot; and &quot;absent&quot;. </p>
</td></tr>   
<tr><td><code id="presence.absence.hist_+3A_legend.cex">legend.cex</code></td>
<td>
<p>cex for presence/absence legend</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_add.opt.legend">add.opt.legend</code></td>
<td>
<p>logical indicating if a legend for optimal threshold criteria should be included on the plot</p>
</td></tr>  
<tr><td><code id="presence.absence.hist_+3A_opt.legend.text">opt.legend.text</code></td>
<td>
<p>a vector of text for optimimal threshold criteria legend. Defaults to text corresponding to 'opt.methods'.</p>
</td></tr>   
<tr><td><code id="presence.absence.hist_+3A_opt.legend.cex">opt.legend.cex</code></td>
<td>
<p>cex for optimization criteria legend</p>
</td></tr> 
<tr><td><code id="presence.absence.hist_+3A_pch">pch</code></td>
<td>
<p> plotting &quot;character&quot;, i.e., symbol to use for the thresholds specified in <code>mark</code>.  <code>pch</code> can either be a single character or an integer code for one of a set of graphics symbols.  See <code>help(points)</code> for details. </p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_fpc">FPC</code></td>
<td>
<p> False Positive Costs, or for C/B ratio C = 'net costs of treating nondiseased individuals'.</p>
</td></tr>
<tr><td><code id="presence.absence.hist_+3A_fnc">FNC</code></td>
<td>
<p> False Negative Costs, or for C/B ratio B = 'net benefits of treating diseased individuals'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When examining a Presence/Absence histogram to evaluate model quality, a good model will produce a clear separation of 'present' and 'absent' with little overlap in any bars.
</p>
<p>The <code>truncate.tallest</code> argument is useful when one bar (often the bar for predicted probability of zero) is much larger than all the other bars. If <code>truncate.tallest</code> = <code>TRUE</code>, the tallest bar is truncated to slightly taller than the next highest bar, and the actual count is plotted above the bar. The truncated bar is also crosshatched to avoid confusion by making it more obviously different from the other bars.
</p>
<p>if <code>optimal.thresholds</code> = <code>TRUE</code> the function will find optimal thresholds by several methods and plot them along the X axis. See <a href="#topic+optimal.thresholds">optimal.thresholds</a> for more details on the optimization methods, and on the arguments <code>ReqSens</code>, <code>ReqSpec</code>, <code>obs.prev</code>, <code>smoothing</code>, <code>FPC</code>, and <code>FNC</code>.
</p>
<p>Note: if too many methods are included in <code>opt.methods</code>, the graph will get very crowded.
</p>


<h3>Value</h3>

<p>creates a graphical plot 
</p>


<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

 <p><a href="#topic+optimal.thresholds">optimal.thresholds</a>,<a href="#topic+presence.absence.summary">presence.absence.summary</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

### EXAMPLE 1 - Comparing three models ###
par(mfrow=c(1,3))
for(i in 1:3){
	presence.absence.hist(	SIM3DATA,
					which.model=i,
					na.rm=TRUE,
					model.names=c("Model 1","Model 2","Model 3"),
					N.bars=10,
					truncate.tallest=FALSE,
					opt.thresholds=TRUE,
					opt.methods=c("Default","Sens=Spec","MaxKappa"))}

### EXAMPLE 2 - Effect of 'truncate.tallest' argument ###
par(mfrow=c(1,2))
presence.absence.hist(	SIM3DATA,
				which.model=1,
				model.names=c("Model 1","Model 2","Model 3"),
				N.bars=10,
				truncate.tallest=FALSE,
				main="truncate.tallest=FALSE")
presence.absence.hist(	SIM3DATA,
				which.model=1,
				model.names=c("Model 1","Model 2","Model 3"),
				N.bars=10,
				truncate.tallest=TRUE,
				main="truncate.tallest=TRUE")
</code></pre>

<hr>
<h2 id='presence.absence.simulation'>Presence/Absence Data Simulation</h2><span id='topic+presence.absence.simulation'></span>

<h3>Description</h3>

<p><code>presence.absence.simulation</code> simulates presence/absence data as one set of observed values, and one or more prediction models. First, Observed values are generated as a binomial distribution, then for each model two beta distributions are used to generate predicted values, one beta distribution for the data points where the simulated observed value is present, and a second for points where it is absent. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>presence.absence.simulation(n, prevalence, N.models = 1, 
shape1.absent, shape2.absent, shape1.present, shape2.present)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="presence.absence.simulation_+3A_n">n</code></td>
<td>
<p> number of plots (i.e. rows) in simulated dataset </p>
</td></tr>
<tr><td><code id="presence.absence.simulation_+3A_prevalence">prevalence</code></td>
<td>
<p> probability species is present for binomial observed values </p>
</td></tr>
<tr><td><code id="presence.absence.simulation_+3A_n.models">N.models</code></td>
<td>
<p> number of models to simulate predictions for </p>
</td></tr>
<tr><td><code id="presence.absence.simulation_+3A_shape1.absent">shape1.absent</code></td>
<td>
<p> first parameter for beta distribution for plots where observed value is absent </p>
</td></tr>
<tr><td><code id="presence.absence.simulation_+3A_shape2.absent">shape2.absent</code></td>
<td>
<p> second parameter for beta distribution for plots where observed value is absent </p>
</td></tr>
<tr><td><code id="presence.absence.simulation_+3A_shape1.present">shape1.present</code></td>
<td>
<p> first parameter for beta distribution for plots where observed value is present </p>
</td></tr>
<tr><td><code id="presence.absence.simulation_+3A_shape2.present">shape2.present</code></td>
<td>
<p> second parameter for beta distribution for plots where observed value is present </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>presence.absence.simulation</code> will generate predicted probabilities for one or more models. If <code>N.models</code> = 1, then shape parameters should be of length 1. If <code>N.models</code> &gt; 1, then shape parameters can be either length 1 or vectors of length <code>N.models</code>.
</p>
<p>The beta distribution is extremely flexible and is capable of generating data with unrealistic behavior. The following rules of thumb will help generate realistic datasets:
</p>
<p>The mean of the beta distribution equals shape1/(shape1+shape2). To get reasonable predictions (e.g. better than random), the mean for the plots where the observed value is present should be higher than that for the plots where the species is absent:
</p>
<p>mean(present) &gt; mean(absent)
</p>
<p>The overall mean probability should be approximately equal to the prevalence. In other words:
</p>
<p>prevalence*mean(present) + (1-prevalence)*mean(absent) = prevalence
</p>


<h3>Value</h3>

<p><code>presence.absence.simulation</code> returns a dataframe where:
</p>
<table>
<tr><td><code>column 1</code></td>
<td>
<p><code>plotID</code> - plot ID numbers</p>
</td></tr>
<tr><td><code>column 2</code></td>
<td>
<p><code>Observed</code> - 0/1 values</p>
</td></tr>
<tr><td><code>column 3</code></td>
<td>
<p><code>Predicted 1</code> - predicted probabilities for model 1</p>
</td></tr>
<tr><td><code>column 4</code></td>
<td>
<p><code>Predicted 2</code> - predicted probabilities for model 2, etc...</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>### EXAMPLE 1 ###
### a graph illustrating effect of shape parameters on beta distribution

set.seed(666)
shapes&lt;-c(1,2,5,10,20)
par(mfrow=c(5,5),mar=c(2,2,2,2),oma=c(0,3,3,0))

for(i in 1:5){
for(j in 1:5){
     SIMDATA&lt;-presence.absence.simulation( n=1000,
                                           prevalence=1,
                                           N.models=1,
                                           shape1.absent=1,
                                           shape2.absent=1,
                                           shape1.present=shapes[i],
                                           shape2.present=shapes[j])
	#Note: by setting prevalence=1, all observed values will be 'present' 
	#	 therefore only one beta distribution will be simulated.	
	hist(SIMDATA[,3],breaks=50,main="",xlab="",ylab="",xlim=c(0,1))
	if(i==1){mtext(paste("shape2 =",shapes[j]),side=3,line=2,cex=.8)}
	if(j==1){mtext(paste("shape1 =",shapes[i]),side=2,line=3,cex=.8)}
}}

### EXAMPLE 2 ###
### generate observed data along with 3 sets of model predictions 
### for models of varying predictive ability.
### Note: This is the code used to generate sample dataset SIM3DATA.

set.seed(666)
SIM3DATA&lt;-presence.absence.simulation(	n=1000,
							prevalence=.2,
							N.models=3,
							shape1.absent=c(1,1,1),
							shape2.absent=c(14,7,5), 
							shape1.present=c(6,2,1),
							shape2.present=c(2,2,2))
</code></pre>

<hr>
<h2 id='presence.absence.summary'> Presence/Absence Summary Plots </h2><span id='topic+presence.absence.summary'></span>

<h3>Description</h3>

<p>Produces four types of Presence/Absence accuracy plots for a single set of model Predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>presence.absence.summary(DATA, threshold = 101, find.auc = TRUE, which.model = 1, 
na.rm = FALSE, main = NULL, model.names = NULL, alpha = 0.05, N.bins = 5, N.bars = 10, 
truncate.tallest = FALSE, opt.thresholds = NULL, opt.methods = NULL, req.sens, req.spec, 
obs.prev = NULL, smoothing = 1, vert.lines = FALSE, add.legend = TRUE, 
add.opt.legend=TRUE, legend.cex = 0.6, opt.legend.cex = 0.6, pch = NULL, 
FPC, FNC, cost.line = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="presence.absence.summary_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_threshold">threshold</code></td>
<td>
<p>cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. It can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate.</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_find.auc">find.auc</code></td>
<td>
<p>a logical indicating if area under the curve should be calculated</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which model from <code>DATA</code> should be used</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_main">main</code></td>
<td>
<p> an overall title for the plot </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_model.names">model.names</code></td>
<td>
<p> a vector of the names of each model included in <code>DATA</code> to be used in the legend box </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_alpha">alpha</code></td>
<td>
<p> alpha value for confidence intervals for <code>calibration.plot</code></p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_n.bins">N.bins</code></td>
<td>
<p> integer giving number of bins for predicted probabilities for <code>calibration.plot</code></p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_n.bars">N.bars</code></td>
<td>
<p> number of bars in histogram  </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_truncate.tallest">truncate.tallest</code></td>
<td>
<p> a logical indicating if the tallest bar should be truncated to fit for <code>presence.absence.hist</code></p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_opt.thresholds">opt.thresholds</code></td>
<td>
<p> a logical indicating whether the optimal thresholds should be calculated and plotted </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_opt.methods">opt.methods</code></td>
<td>
<p> what methods should be used to optimize thresholds. Argument can be given either as a vector of method names or method numbers. Possible values are:
</p>

<table>
<tr>
 <td style="text-align: right;">
  1  </td><td style="text-align: left;"> <code>Default</code>   </td><td style="text-align: left;"> threshold=0.5 </td>
</tr>
<tr>
 <td style="text-align: right;">
  2  </td><td style="text-align: left;"> <code>Sens=Spec</code> </td><td style="text-align: left;"> sensitivity=specificity </td>
</tr>
<tr>
 <td style="text-align: right;">
  3  </td><td style="text-align: left;"> <code>MaxSens+Spec</code> </td><td style="text-align: left;"> maximizes (sensitivity+specificity)/2 </td>
</tr>
<tr>
 <td style="text-align: right;">
  4  </td><td style="text-align: left;"> <code>MaxKappa</code>  </td><td style="text-align: left;"> maximizes Kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
  5  </td><td style="text-align: left;"> <code>MaxPCC</code>    </td><td style="text-align: left;"> maximizes PCC (percent correctly classified) </td>
</tr>
<tr>
 <td style="text-align: right;">
  6  </td><td style="text-align: left;"> <code>PredPrev=Obs</code> </td><td style="text-align: left;"> predicted prevalence=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  7  </td><td style="text-align: left;"> <code>ObsPrev</code>   </td><td style="text-align: left;"> threshold=observed prevalence </td>
</tr>
<tr>
 <td style="text-align: right;">
  8 </td><td style="text-align: left;"> <code>MeanProb </code> </td><td style="text-align: left;"> mean predicted probability </td>
</tr>
<tr>
 <td style="text-align: right;"> 
  9  </td><td style="text-align: left;"> <code>MinROCdist</code></td><td style="text-align: left;"> minimizes distance between ROC plot and (0,1)</td>
</tr>
<tr>
 <td style="text-align: right;">
  10 </td><td style="text-align: left;"> <code>ReqSens</code> </td><td style="text-align: left;"> user defined required sensitivity </td>
</tr>
<tr>
 <td style="text-align: right;">
  11 </td><td style="text-align: left;"> <code>ReqSpec</code> </td><td style="text-align: left;"> user defined required specificity </td>
</tr>

</table>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_req.sens">req.sens</code></td>
<td>
<p> a value between zero and one giving the user defined required sensitivity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1-maximum allowable errors for points with positive observations).</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_req.spec">req.spec</code></td>
<td>
<p> a value between zero and one giving the user defined required sspecificity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1- maximum allowable errors for points with negative observations).</p>
</td></tr>  
<tr><td><code id="presence.absence.summary_+3A_obs.prev">obs.prev</code></td>
<td>
<p>observed prevalence for <code>opt.method</code> = <code>"PredPrev=Obs"</code> and <code>"ObsPrev"</code>. Defaults to observed prevalence from <code>DATA</code>.</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_smoothing">smoothing</code></td>
<td>
<p> smoothing factor for maximizing/minimizing. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Instead of find the threshold that gives the max/min value, function will average the thresholds of the given number of max/min values.</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_vert.lines">vert.lines</code></td>
<td>
<p> a logical where: <code>TRUE</code> means vertical lines added to plot at optimal thresholds; <code>FALSE</code> means no vertical lines, instead optimal thresholds marked along error statistics plots. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_add.legend">add.legend</code></td>
<td>
<p> logical indicating if a legend should be included on the plot </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_add.opt.legend">add.opt.legend</code></td>
<td>
<p> logical indicating if optimization criteria legend should be included on the plot </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_legend.cex">legend.cex</code></td>
<td>
<p> cex for legends </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_opt.legend.cex">opt.legend.cex</code></td>
<td>
<p> cex for optimization criteria legend </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_pch">pch</code></td>
<td>
<p> plotting &quot;character&quot;, i.e., symbol to use for the thresholds specified in <code>MARK</code>.  <code>pch</code> can either be a single character or an integer code for one of a set of graphics symbols.  See <code>help(points)</code> for details. </p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_fpc">FPC</code></td>
<td>
<p> False Positive Costs, or for C/B ratio C = 'net costs of treating nondiseased individuals'.</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_fnc">FNC</code></td>
<td>
<p> False Negative Costs, or for C/B ratio B = 'net benefits of treating diseased individuals'.</p>
</td></tr>
<tr><td><code id="presence.absence.summary_+3A_cost.line">cost.line</code></td>
<td>
<p> a logical indicating if the line representing the realtive cost ratio should be added to the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>presence.absence.summary</code> produces a set of summary plots for a single model, along with calculating AUC and optimal thresholds. <code>presence.absence.summary</code> is not quite as flexible as the individual plot functions, as some arguments are preset so that the plots will be comparable, but the remaining arguments have the same meaning. See the individual plot functions <a href="#topic+error.threshold.plot">error.threshold.plot</a>, <a href="#topic+auc.roc.plot">auc.roc.plot</a>, <a href="#topic+calibration.plot">calibration.plot</a>, and <a href="#topic+presence.absence.hist">presence.absence.hist</a> for further details.
</p>


<h3>Value</h3>

<p>creates a graphical plot</p>


<h3>Author(s)</h3>

<p>Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

<p><a href="#topic+optimal.thresholds">optimal.thresholds</a>, <a href="#topic+error.threshold.plot">error.threshold.plot</a>, <a href="#topic+auc.roc.plot">auc.roc.plot</a>, <a href="#topic+calibration.plot">calibration.plot</a>, <a href="#topic+presence.absence.hist">presence.absence.hist</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

presence.absence.summary(SIM3DATA)

presence.absence.summary(	SIM3DATA,
					threshold=101,
					find.auc=TRUE,
					which.model=2,
					na.rm=FALSE,
					main=NULL,
					model.names=NULL,
					alpha=0.05,
					N.bins=5,
					N.bars=10,
					truncate.tallest=FALSE,
					opt.thresholds=TRUE,
					opt.methods=c(1,2,4),
					req.sens=0.85,
					req.spec=0.85,
					obs.prev=NULL,
					smoothing=1,
					vert.lines=FALSE,
					add.legend=TRUE,
					add.opt.legend=TRUE,
					legend.cex=0.6,
					opt.legend.cex=0.6,
					pch=NULL)
</code></pre>

<hr>
<h2 id='PresenceAbsence-package'>
Presence-Absence model evaluation 
</h2><span id='topic+PresenceAbsence-package'></span><span id='topic+PresenceAbsence'></span>

<h3>Description</h3>

<p>Provides a set of functions useful when evaluating the results of presence-absence models. Package includes functions for calculating threshold dependent measures such as confusion matrices, pcc, sensitivity, specificity, and Kappa, and produces plots of each measure as the threshold is varied. It also includes functions to plot the threshold independent ROC curves along with the associated AUC (area under the curve).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PresenceAbsence</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.11</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-01-05</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> This code was written and prepared by a U.S. Government employee on official time, and therefore it is in the public domain and not subject to copyright.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This library provides a collection of functions useful for evaluating Presence/Absence data, both analytically as well as graphically. It also includes a function that uses beta distributions to produce simulated Presence/Absence data.
</p>
<p>Data should be in the form of a matrix or data frame where each row represents one data point or plot location, and where column 1 is plot ID, column 2 is observed values, column 3 is predictions from the first model, column 4 is predictions from the second model, etc...
</p>
<p>If the observed values are not already in the form of zero/one values (i.e. they are instead measurements such as basal area or tree counts) the functions will automatically translate them into zero-one values where any number greater than zero is treated as Present.
</p>
<p>The library is most useful if the predictions are in the form of probabilities. This allows one to investigate how the model predictions vary as the threshold is varied. If all that is available is predicted Presence/Absence values, the summary statistics can still be calculated, but most of the graphs are not possible.
</p>
<p>Functions that will still work when all that is available is predicted Presence/Absence: <a href="#topic+cmx">cmx</a>, <a href="#topic+pcc">pcc</a>, <a href="#topic+sensitivity">sensitivity</a>, <a href="#topic+specificity">specificity</a>, <a href="#topic+Kappa">Kappa</a>, <a href="#topic+presence.absence.accuracy">presence.absence.accuracy</a> with <code>find.auc</code> set to false, <a href="#topic+predicted.prevalence">predicted.prevalence</a>, and the graphical function <a href="#topic+presence.absence.hist">presence.absence.hist</a> with <code>N.bar</code> set to 2.
</p>
<p>Most functions take the dataframe of observed and predicted values (<code>DATA</code>) as input. The exceptions are the sub-functions that calculate single accuracy statistics: <a href="#topic+pcc">pcc</a>, <a href="#topic+sensitivity">sensitivity</a>, <a href="#topic+specificity">specificity</a>, and <a href="#topic+Kappa">Kappa</a>. These sub-functions take the confusion matrix from <a href="#topic+cmx">cmx</a> as input.
</p>
<p>Some functions only evaluate one set of model predictions at a time, while others will work with multiple sets of model predictions. Even if the function only works on single models, the dataframe <code>DATA</code> can still contain multiple model predictions. Just use the argument <code>which.model</code> to indicate the desired column. 
</p>
<p>Functions that will only work on single models: <a href="#topic+cmx">cmx</a>, <a href="#topic+auc">auc</a>, <a href="#topic+roc.plot.calculate">roc.plot.calculate</a>, <a href="#topic+presence.absence.hist">presence.absence.hist</a>, <a href="#topic+error.threshold.plot">error.threshold.plot</a>, <a href="#topic+calibration.plot">calibration.plot</a>, and <a href="#topic+presence.absence.summary">presence.absence.summary</a>.
</p>
<p>Functions that will work with multiple models: <a href="#topic+presence.absence.accuracy">presence.absence.accuracy</a>, <a href="#topic+optimal.thresholds">optimal.thresholds</a>, <a href="#topic+predicted.prevalence">predicted.prevalence</a>, and <a href="#topic+auc.roc.plot">auc.roc.plot</a>.
</p>
<p>Note that this library provides graphical and tabular comparisons between models. It does not provide significance testing of model differences. The standard deviations given by <a href="#topic+presence.absence.accuracy">presence.absence.accuracy</a> are for each model individually. To test AUC for differences between models it is necessary to account for correlation. If you are interested in AUC significance testing, both pair-wise and overall, the Splus ROC library from Mayo clinic provides such a test. See <a href="#topic+auc">auc</a> for more details.
</p>
<p>This code was written and prepared by a U.S. Government employee on official time, and therefore it is in the public domain and not subject to copyright.
</p>


<h3>Author(s)</h3>

<p>Author:Elizabeth Freeman &lt;elizabeth.a.freeman@usda.gov&gt;
</p>
<p>Maintainer: Elizabeth Freeman &lt;elizabeth.a.freeman@usda.gov&gt;
</p>


<h3>References</h3>

<p>Fielding, A.H. and Bell, J.F., 1997. A review of methods for the assessment of prediction errors in conservation presence/absence models. Environ. Conserv., 24(1):38-49.
</p>
<p>Manel, S., Ceri Williams, H., and Ormerod, S.J., 2001. Evaluating presence/absence models in ecology: the need to account for prevalence. J. Appl. Ecol., 38:921-931.
</p>
<p>Moisen, G.G., Freeman, E.A., Blackard, J.A., Frescino, T.S., Zimmerman N.E., Edwards, T.C. Predicting tree species presence and basal area in Utah: A comparison of stochastic gradient boosting, generalized additive models, and tree-based methods. Ecological Modellng, 199 (2006) 176-187.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)
auc.roc.plot(SIM3DATA)
presence.absence.summary(SIM3DATA,which.model=1)
</code></pre>

<hr>
<h2 id='roc.plot.calculate'> ROC Plot Calculations </h2><span id='topic+roc.plot.calculate'></span>

<h3>Description</h3>

<p><code>roc.plot.calculate</code> calculates PCC, sensitivity, specificity, and Kappa for a single presence absence model at a series of thresholds in preparation for creating a ROC plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roc.plot.calculate(DATA, threshold = 101, which.model = 1, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roc.plot.calculate_+3A_data">DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,1]</code> </td><td style="text-align: left;"> plot ID </td><td style="text-align: left;"> text</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,2]</code> </td><td style="text-align: left;"> observed values </td><td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,3]</code> </td><td style="text-align: left;"> predicted probabilities from first model </td><td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
 <td style="text-align: left;">
	  </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> <code>DATA[,4]</code> </td><td style="text-align: left;"> predicted probabilities from second model, etc... </td><td style="text-align: left;">  </td>
</tr>

</table>
</td></tr>
<tr><td><code id="roc.plot.calculate_+3A_threshold">threshold</code></td>
<td>
<p>cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. It can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate.</p>
</td></tr>
<tr><td><code id="roc.plot.calculate_+3A_which.model">which.model</code></td>
<td>
<p>a number indicating which model from <code>DATA</code> should be used</p>
</td></tr>
<tr><td><code id="roc.plot.calculate_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>roc.plot.calculate</code> is a streamlined version of <code>presence.absence.accuracy</code> designed specifically to compute the accuracy measures needed to produce a ROC plot. <code>roc.plot.calculate</code> is less versatile, but more efficient than <code>presence.absence.accuracy</code>. 
</p>
<p>Unlike <code>presence.absence.accuracy</code>, <code>roc.plot.calculate</code> will only work for a single set of model predictions. Therefore either <code>DATA</code> can contain only one model prediction, or <code>which.model</code> must be used to indicate a single model prediction from <code>DATA</code>. By default, if <code>DATA</code> contains more than one model prediction, and <code>which.model</code> is not specified, <code>roc.plot.calculate</code> will use the first model prediction (e.g. <code>DATA[,3]</code>).
</p>
<p><code>roc.plot.calculate</code> was written as a sub-function for the plotting functions(i.e. <code>error.threshold.plot</code>, <code>auc.roc.plot</code>, but can be used on its own to produce a simple table of how the accuracy measures vary with choice of threshold.
</p>
<p>To produce attractive plots requires a large number of thresholds. The default value of <code>threshold</code> = 101 is a good compromise between speed and resolution.
</p>


<h3>Value</h3>

<p>Returns a dataframe where: 
</p>

<table>
<tr>
 <td style="text-align: left;">
[,1] </td><td style="text-align: left;"> <code>threshold</code>   </td><td style="text-align: left;"> thresholds used for each row in the table </td>
</tr>
<tr>
 <td style="text-align: left;">
[,2] </td><td style="text-align: left;"> <code>PCC</code>         </td><td style="text-align: left;"> percent correctly classified              </td>
</tr>
<tr>
 <td style="text-align: left;">
[,3] </td><td style="text-align: left;"> <code>sensitivity</code> </td><td style="text-align: left;">                                           </td>
</tr>
<tr>
 <td style="text-align: left;">
[,4] </td><td style="text-align: left;"> <code>specificity</code> </td><td style="text-align: left;">                                           </td>
</tr>
<tr>
 <td style="text-align: left;">
[,5] </td><td style="text-align: left;"> <code>Kappa</code>       </td><td style="text-align: left;">                                           </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

 
<p><a href="#topic+cmx">cmx</a>, <a href="#topic+pcc">pcc</a>, <a href="#topic+sensitivity">sensitivity</a>, <a href="#topic+specificity">specificity</a>, <a href="#topic+Kappa">Kappa</a>, <a href="#topic+presence.absence.accuracy">presence.absence.accuracy</a>, <a href="#topic+error.threshold.plot">error.threshold.plot</a>, <a href="#topic+auc.roc.plot">auc.roc.plot</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

roc.plot.calculate(SIM3DATA,which.model=2)
</code></pre>

<hr>
<h2 id='sensitivity'> Sensitivity </h2><span id='topic+sensitivity'></span>

<h3>Description</h3>

<p><code>sensitivity</code> calculates the sensitivity and (optionally) the associated standard deviation from a confusion matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity(CMX, st.dev = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity_+3A_cmx">CMX</code></td>
<td>
<p> a confusion matrix - output from <code>cmx</code> </p>
</td></tr>
<tr><td><code id="sensitivity_+3A_st.dev">st.dev</code></td>
<td>
<p> a logical indicating whether the associated standard deviation should be calculated </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sensitivity is the proportion of observed positives correctly predicted, and reflects a model's ability to predict a presence given that a species actually occurs at a location. 
</p>


<h3>Value</h3>

<p>if <code>st.dev</code> = FALSE, returns: <code>sensitivity</code>. <br />
</p>
<p>if <code>st.dev</code> = TRUE, returns a dataframe where:
</p>

<table>
<tr>
 <td style="text-align: left;">
[1,1] </td><td style="text-align: left;"> <code>sensitivity</code>   </td><td style="text-align: left;">                                         </td>
</tr>
<tr>
 <td style="text-align: left;">
[1,2] </td><td style="text-align: left;"> <code>sensitivity.sd</code></td><td style="text-align: left;"> standard deviation of <code>sensitivity</code> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+cmx">cmx</a></code>, <code><a href="#topic+pcc">pcc</a></code>, <code><a href="#topic+specificity">specificity</a></code>, <code><a href="#topic+Kappa">Kappa</a></code>, <code><a href="#topic+auc">auc</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

sensitivity(cmx(SIM3DATA))

sensitivity(cmx(SIM3DATA),st.dev=FALSE)
</code></pre>

<hr>
<h2 id='SIM3DATA'> Simulated Presence-Absence Data </h2><span id='topic+SIM3DATA'></span>

<h3>Description</h3>

<p>This data set was generated using the <code>presence.absence.simulation()</code> function. It consists of plotID, observed presence-absence values, and the simulated probability predictions of three different models, for 1000 plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SIM3DATA)</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 observations on the following 5 variables.
</p>

<dl>
<dt><code>plotID</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Observed</code></dt><dd><p>a numeric vector of 0-1 values</p>
</dd>
<dt><code>Predicted1</code></dt><dd><p>a numeric vector of predicted probabilities</p>
</dd>
<dt><code>Predicted2</code></dt><dd><p>a numeric vector of predicted probabilities </p>
</dd>
<dt><code>Predicted3</code></dt><dd><p>a numeric vector of predicted probabilities </p>
</dd>
</dl>



<h3>Source</h3>

<p>simulated with the <a href="#topic+presence.absence.simulation">presence.absence.simulation</a> function . See <code>Example 2</code> from <a href="#topic+presence.absence.simulation">presence.absence.simulation</a> help file for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)
</code></pre>

<hr>
<h2 id='SPDATA'> Species Presence/Absence Data </h2><span id='topic+SPDATA'></span>

<h3>Description</h3>

<p>This data set has Presence/Absence predictions for 13 species at 386 forested locations. It consists of species, observed presence-absence values, and the probability predictions of three different models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SPDATA)</code></pre>


<h3>Format</h3>

<p>A data frame with 386 observations for 13 species with the following 5 variables.
</p>

<dl>
<dt><code>SPECIES</code></dt><dd><p>a character vector of species codes</p>
</dd>
<dt><code>OBSERVED</code></dt><dd><p>a numeric vector of 0-1 values</p>
</dd>
<dt><code>GAM</code></dt><dd><p>a numeric vector of predicted probabilities</p>
</dd>
<dt><code>See5</code></dt><dd><p>a numeric vector of predicted probabilities </p>
</dd>
<dt><code>SGB</code></dt><dd><p>a numeric vector of predicted probabilities </p>
</dd>
</dl>



<h3>Source</h3>

<p>This dataset is from:
</p>
<p>Moisen, G.G., Freeman, E.A., Blackard, J.A., Frescino, T.S., Zimmerman N.E., Edwards, T.C. Predicting tree species presence and basal area in Utah: A comparison of stochastic gradient boosting, generalized additive models, and tree-based methods. Ecological Modellng, 199 (2006) 176-187.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SPDATA)
</code></pre>

<hr>
<h2 id='specificity'> Specificity </h2><span id='topic+specificity'></span>

<h3>Description</h3>

<p><code>specificity</code> calculates the specificity and (optionally) the associated standard deviation from a confusion matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specificity(CMX, st.dev = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="specificity_+3A_cmx">CMX</code></td>
<td>
<p> a confusion matrix - output from <code>cmx</code> </p>
</td></tr>
<tr><td><code id="specificity_+3A_st.dev">st.dev</code></td>
<td>
<p> a logical indicating whether the associated standard deviation should be calculated </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specificity is the proportion of observed negatives correctly predicted, and reflects a model's ability to predict an absence given that a species actually does not occur at a location. 
</p>


<h3>Value</h3>

<p>if <code>st.dev</code> = FALSE, returns: <code>specificity</code>. <br />
</p>
<p>if <code>st.dev</code> = TRUE, returns a dataframe where:
</p>

<table>
<tr>
 <td style="text-align: left;">
[1,1] </td><td style="text-align: left;"> <code>specificity</code>   </td><td style="text-align: left;">                                         </td>
</tr>
<tr>
 <td style="text-align: left;">
[1,2] </td><td style="text-align: left;"> <code>specificity.sd</code></td><td style="text-align: left;"> standard deviation of <code>specificity</code> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a> </p>


<h3>See Also</h3>

 <p><code><a href="#topic+cmx">cmx</a></code>, <code><a href="#topic+pcc">pcc</a></code>, <code><a href="#topic+sensitivity">sensitivity</a></code>, <code><a href="#topic+Kappa">Kappa</a></code>, <code><a href="#topic+auc">auc</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SIM3DATA)

specificity(cmx(SIM3DATA))

specificity(cmx(SIM3DATA),st.dev=FALSE)
</code></pre>

<hr>
<h2 id='SPPREV'> Overall Preavalences for Species Presence/Absence Data </h2><span id='topic+SPPREV'></span>

<h3>Description</h3>

<p>This data set is summary prevalence for Presence/Absence data for 13 species from 1930 forested locations. <code>SPPREV</code> is the prevalence data from the full dataset (training and test data). Note that <code>SPDATA</code> is the model predictions from the test data subset (20 percent of total plots) of this original dataset, and therefore the species in <code>SPDATA</code> have slightly different prevalence than the overall prevalence given in <code>SPPREV</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SPDATA)</code></pre>


<h3>Format</h3>

<p>A data frame with data for 13 species. Dataframe consists of species names, number of plots where the species was present, and the overall prevalence for each species:
</p>

<dl>
<dt><code>SPECIES</code></dt><dd><p>a character vector of species codes</p>
</dd>
<dt><code>NUMPLOTS</code></dt><dd><p>a numeric vector of plot counts</p>
</dd>
<dt><code>PREV</code></dt><dd><p>a numeric vector of prevalence</p>
</dd>
</dl>



<h3>Source</h3>

<p>This dataset is from:
</p>
<p>Moisen, G.G., Freeman, E.A., Blackard, J.A., Frescino, T.S., Zimmerman N.E., Edwards, T.C. Predicting tree species presence and basal area in Utah: A comparison of stochastic gradient boosting, generalized additive models, and tree-based methods. Ecological Modellng, 199 (2006) 176-187.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SPPREV)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
