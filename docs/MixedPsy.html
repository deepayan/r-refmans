<!DOCTYPE html><html><head><title>Help for package MixedPsy</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MixedPsy}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MixDelta'><p>PSE/JND from GLMM Estimates using Delta Method</p></a></li>
<li><a href='#MixPlot'><p>Plot Individual Responses from GLMM</p></a></li>
<li><a href='#pseMer'><p>PSE/JND from GLMM Estimates Using Bootstrap Method</p></a></li>
<li><a href='#PsychDelta'><p>PSE/JND from GLM Using Delta Method</p></a></li>
<li><a href='#PsychFunction'><p>Psychometric Function and PSE/JND Parameters from Single-Subject Response</p></a></li>
<li><a href='#PsychPlot'><p>Plot Psychometric Function from GLM</p></a></li>
<li><a href='#PsychShape'><p>Plot Psychometric Functions given PSE and JND</p></a></li>
<li><a href='#PsySimulate'><p>Simulate psychophysical data</p></a></li>
<li><a href='#simul_data'><p>A simulated psychophysical dataset</p></a></li>
<li><a href='#vibro_exp3'><p>Data from tactile discrimination task - (Dallmann et al., 2015).</p></a></li>
<li><a href='#xplode'><p>Extract values from a fitted GLMM object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Tools for the Analysis of Psychophysical Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Alessandro Moscatelli
    <a href="https://orcid.org/0000-0001-6269-4536"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Priscilla Balestrucci
    <a href="https://orcid.org/0000-0002-5764-9439"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alessandro Moscatelli &lt;moskante@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for the analysis of psychophysical data in R. This package allows to estimate the Point of Subjective Equivalence (PSE) 
    and the Just Noticeable Difference (JND), either from a psychometric function or from a Generalized Linear Mixed Model (GLMM). 
    Additionally, the package allows plotting the fitted models and the response data, simulating psychometric functions of different shapes, and simulating data sets.
    For a description of the use of GLMMs applied to psychophysical data, refer to Moscatelli et al. (2012).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>beepr, boot, brglm, lme4, Matrix, mnormt, ggplot2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mixedpsychophysics.wordpress.com">https://mixedpsychophysics.wordpress.com</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/moskante/MixedPsy/issues">https://github.com/moskante/MixedPsy/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-08 15:18:09 UTC; priscilla</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-08 15:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='MixDelta'>PSE/JND from GLMM Estimates using Delta Method</h2><span id='topic+MixDelta'></span>

<h3>Description</h3>

<p>Estimate Points of Subjective Equivalence (PSE), Just Noticeable
Differences (JND) and the related Standard Errors from a GLMM by means of 
delta method. 
The method applies to models with a <em>probit</em> link function, one continuous predictor,
and one (optional) factorial predictor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MixDelta(xplode.obj, alpha = 0.05, p = 0.75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MixDelta_+3A_xplode.obj">xplode.obj</code></td>
<td>
<p>an object of class <code>xplode.obj</code>. The fitted model
(object of class <code><a href="lme4.html#topic+merMod">merMod</a></code>, specifically of subclass <code>glmerMod</code>) includes
one continuous predictor and one (optional) factorial predictor.</p>
</td></tr>
<tr><td><code id="MixDelta_+3A_alpha">alpha</code></td>
<td>
<p>significance level of the confidence intervals. Default is 0.05 (value for 95% confidence interval).</p>
</td></tr>
<tr><td><code id="MixDelta_+3A_p">p</code></td>
<td>
<p>probability value relative to the JND upper limit. Default is 0.75 (value for 50% JND).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the model includes a factorial predictor, the function is based on a recursive use of
<code><a href="lme4.html#topic+glmer">glmer</a></code> and re-order of levels of the factorial predictor. 
The JND estimate assumes a <em>probit</em> link function.
</p>


<h3>Value</h3>

<p>A matrix including estimate, standard error, inferior and superior bounds of the confidence interval of PSE and JND. 
If a factorial predictor is included in the model, the function returns a list, each item containing a matrix 
for the estimates relative to a level of the predictor.
</p>


<h3>Note</h3>

<p>The delta method is based on the assumption of asymptotic normal distribution of the parameters estimates. 
This may result in an incorrect variance estimation. For a more reliable (but more time-consuming) estimation 
based on bootstrap method, use <code><a href="#topic+pseMer">pseMer</a></code>.
</p>


<h3>References</h3>

<p>Moscatelli, A., Mezzetti, M., &amp; Lacquaniti, F. (2012). Modeling psychophysical data 
at the population-level: The generalized linear mixed model. 
Journal of Vision, 12(11):26, 1-17. doi:10.1167/12.11.26
</p>
<p>Casella, G., &amp; Berger, R. L. (2002). Statistical inference (2nd ed.). 
Pacific Grove, CA: Duxbury Press
</p>


<h3>See Also</h3>

<p><code><a href="lme4.html#topic+glmer">glmer</a></code> for fitting Generalized Linear Mixed Models. 
<code><a href="#topic+xplode">xplode</a></code> for interfacing values from a fitted GLMM to <code>MixedPsy</code> functions. 
<code><a href="#topic+pseMer">pseMer</a></code> for bootstrap-based confidence intervals of psychometric parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lme4)

#univariable GLMM (one continuous predictor)
mod.uni = glmer(formula = cbind(Longer, Total - Longer) ~ X + (1 | Subject), 
family = binomial(link = "probit"), data = simul_data)
xplode.uni = xplode(model = mod.uni, name.cont = "X")
MixDelta(xplode.uni)

#multivariable GLMM (one continuous and one factorial predictor)
mod.multi &lt;- glmer(cbind(faster, slower) ~ speed * vibration + (1 + speed| subject), 
family = binomial(link = "probit"), data = vibro_exp3)
xplode.multi &lt;- xplode(model = mod.multi, name.cont = "speed", name.factor = "vibration")
MixDelta(xplode.multi)

</code></pre>

<hr>
<h2 id='MixPlot'>Plot Individual Responses from GLMM</h2><span id='topic+MixPlot'></span>

<h3>Description</h3>

<p>Plot response curve for each individual in a population sample, given a GLMM with one continuous predictor 
and one (optional) factorial predictor. If the factorial predictor is specified, the response is plotted separately for each
individual and each predictor level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MixPlot(xplode.obj, facet_by = NULL, showData = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MixPlot_+3A_xplode.obj">xplode.obj</code></td>
<td>
<p>an object of class <code><a href="#topic+xplode">xplode</a></code>.</p>
</td></tr>
<tr><td><code id="MixPlot_+3A_facet_by">facet_by</code></td>
<td>
<p>optional. A string specifying the name of the faceting variable (either the participant identification 
or the factorial predictor).</p>
</td></tr>
<tr><td><code id="MixPlot_+3A_showdata">showData</code></td>
<td>
<p>logical, defines if proportion of binomial responses for each stimulus level are presented. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the model includes only a continuous predictor, the figure consist of a single panel, and each individual's 
response is assigned a different color. If a factorial predictor is included in the model, the faceting variable can be either the 
participant identification or the factorial predictor. By default, each panel shows an individual's response, different levels of 
the factorial predictor are coded by color.
</p>


<h3>Value</h3>

<p><code>MixPlot</code> returns a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xplode">xplode</a></code> for objects of class <code>xplode</code>.
<code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> for creating data visualizations. 
<code><a href="#topic+PsychPlot">PsychPlot</a></code> for plotting a a psychometric function from a GLM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lme4)
mod.multi &lt;- glmer(cbind(faster, slower) ~ speed * vibration + (1 + speed| subject), 
family = binomial(link = "probit"), data = vibro_exp3)
xplode.multi &lt;- xplode(model = mod.multi, name.cont = "speed", name.factor = "vibration")

MixPlot(xplode.multi)
#alternative visualization
MixPlot(xplode.multi, facet_by = "vibration", showData = FALSE)

</code></pre>

<hr>
<h2 id='pseMer'>PSE/JND from GLMM Estimates Using Bootstrap Method</h2><span id='topic+pseMer'></span>

<h3>Description</h3>

<p>Estimates the Point of Subjective Equivalence (PSE), the Just Noticeable
Difference (JND) and the related Standard Errors by means of Bootstrap Method, 
given an object of class <code><a href="lme4.html#topic+merMod">merMod</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseMer(
  mer.obj,
  B = 200,
  FUN = NULL,
  alpha = 0.05,
  ci.type = c("norm", "basic", "perc"),
  beep = F
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pseMer_+3A_mer.obj">mer.obj</code></td>
<td>
<p>an object of class <code><a href="lme4.html#topic+merMod-class">merMod</a></code>.</p>
</td></tr>
<tr><td><code id="pseMer_+3A_b">B</code></td>
<td>
<p>integer. Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="pseMer_+3A_fun">FUN</code></td>
<td>
<p>an optional, custom made function to specify the required parameters to be estimated.
If NULL, <code>pseMer</code> estimates PSE and 50%JND of a univariable GLMM with a single intercept and slope.</p>
</td></tr>
<tr><td><code id="pseMer_+3A_alpha">alpha</code></td>
<td>
<p>significance level of the confidence intervals. Default is 0.05 (95% confidence interval).</p>
</td></tr>
<tr><td><code id="pseMer_+3A_ci.type">ci.type</code></td>
<td>
<p>vector of character strings representing the type of intervals required. The value 
should be any subset of the values accepted by <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>: c(&quot;norm&quot;,&quot;basic&quot;, &quot;stud&quot;, &quot;perc&quot;, &quot;bca&quot;). 
Specify &quot;all&quot; for all five types of intervals. &quot;perc&quot; should be always included for the summary table.</p>
</td></tr>
<tr><td><code id="pseMer_+3A_beep">beep</code></td>
<td>
<p>logical. If TRUE, a &quot;ping&quot; sound alerts that the simulation is complete. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>pseMer</code> estimates PSE and JND (and additional user defined parameters) from a 
fitted GLMM model (class <code><a href="lme4.html#topic+merMod-class">merMod</a></code>).
</p>


<h3>Value</h3>

<p><code>pseMer</code> returns a list of length 3 including a summary table (estimate,
inferior and superior bounds of the confidence interval), the output of <code><a href="lme4.html#topic+bootMer">bootMer</a></code>, and that of 
<code><a href="boot.html#topic+boot.ci">boot.ci</a></code>, for further analyses. Confidence intervals in the summary table are
based on the percentile method.
</p>


<h3>Note</h3>

<p>A first custom function was written in 2012 for the non-CRAN package MERpsychophisics,
based on the algorithm in Moscatelli et al. (2012). The current function is a wrapper
of function <code><a href="lme4.html#topic+bootMer">bootMer</a></code> and <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. 
</p>
<p>Increasing the number of bootstrap samples (<code>B</code>) makes the estimate more reliable. 
However, this will also increase the duration of the computation.
</p>


<h3>References</h3>

<p>Moscatelli, A., Mezzetti, M., &amp; Lacquaniti, F. (2012). Modeling psychophysical data 
at the population-level: The generalized linear mixed model. 
Journal of Vision, 12(11):26, 1-17. doi:10.1167/12.11.26
</p>
<p>Bates, D., Mächler, M., Bolker, B., &amp; Walker, S. (2015). Fitting Linear Mixed-Effects 
Models Using lme4. Journal of Statistical Software, 67(1), 51. https://doi.org/10.18637/jss.v067.i01
</p>


<h3>See Also</h3>

<p><code><a href="lme4.html#topic+bootMer">bootMer</a></code> and <code><a href="boot.html#topic+boot.ci">boot.ci</a></code> for estimation of confidence intervals with the bootstrap method. 
<code><a href="#topic+MixDelta">MixDelta</a></code> for confidence intervals with delta method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lme4)
#example 1: univariable GLMM
mod.uni = glmer(formula = cbind(Longer, Total - Longer) ~ X + (1 | Subject),
family = binomial(link = "probit"), data = simul_data)

BootEstim.uni &lt;- pseMer(mod.uni, B = 100, ci.type = c("perc"))

#example 2: specify custom parameters for multivariable model
mod.multi &lt;- glmer(cbind(faster, slower) ~ speed * vibration + (1 + speed| subject), 
family = binomial(link = "probit"), data = vibro_exp3)
              
fun2mod = function(mer.obj){
#allocate space: 4 parameters (jnd_A, jnd_B, pse_A, pse_B)
jndpse = vector(mode = "numeric", length = 4)
names(jndpse) = c("pse_0", "pse_32","jnd_0", "jnd_32")
jndpse[1] = -fixef(mer.obj)[1]/fixef(mer.obj)[2] #pse_0
jndpse[2] = -(fixef(mer.obj)[1]+fixef(mer.obj)[3])/(fixef(mer.obj)[2]+ fixef(mer.obj)[4]) #pse_0
jndpse[3] = qnorm(0.75)/fixef(mer.obj)[2] #jnd_0
jndpse[4] = qnorm(0.75)/(fixef(mer.obj)[2]+ fixef(mer.obj)[4]) #jnd_32
return(jndpse)
}
 
BootEstim.multi = pseMer(mod.multi, B = 100, FUN = fun2mod)

</code></pre>

<hr>
<h2 id='PsychDelta'>PSE/JND from GLM Using Delta Method</h2><span id='topic+PsychDelta'></span>

<h3>Description</h3>

<p>Estimate Point of Subjective Equivalence (PSE), Just Noticeable
Difference (JND), and related Standard Errors of an individual participant 
by means of Delta Method.
The method only applies to a GLM (object of class <code><a href="stats.html#topic+glm">glm</a></code>) with one continuous 
predictor and a <em>probit</em> link function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PsychDelta(model.obj, alpha = 0.05, p = 0.75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PsychDelta_+3A_model.obj">model.obj</code></td>
<td>
<p>the fitted psychometric function. An object of class <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="PsychDelta_+3A_alpha">alpha</code></td>
<td>
<p>significance level of the confidence interval.Default is 0.05 (95% confidence interval).</p>
</td></tr>
<tr><td><code id="PsychDelta_+3A_p">p</code></td>
<td>
<p>probability value relative to the JND upper limit. Default is 0.75 (value for 50% JND).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PsychDelta</code> estimates PSE and JND of a psychometric
function (object of class <code>glm</code>).
</p>


<h3>Value</h3>

<p><code>PsychDelta</code> returns a matrix including estimate, standard error,
inferior and superior bounds of the confidence interval of PSE and JND. Confidence Intervals
are computed as: <code class="reqn">Estimate +/- z(1-(\alpha/2)) * Std.Error</code>.
</p>


<h3>Note</h3>

<p>The function assumes that the first model coefficient is the intercept
and the second is the slope. The estimate of the JND assumes a <em>probit</em>
link function.
</p>


<h3>References</h3>

<p>Faraggi, D., Izikson, P., &amp; Reiser, B. (2003). Confidence intervals for the 50 per cent 
response dose. Statistics in medicine, 22(12), 1977-1988. https://doi.org/10.1002/sim.1368
</p>
<p>Knoblauch, K., &amp; Maloney, L. T. (2012). Modeling psychophysical data in R (Vol. 32). 
Springer Science &amp; Business Media.
</p>
<p>Moscatelli, A., Mezzetti, M., &amp; Lacquaniti, F. (2012). Modeling psychophysical data 
at the population-level: The generalized linear mixed model. 
Journal of Vision, 12(11):26, 1-17. doi:10.1167/12.11.26
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code> for fitting a Generalized Linear Model to a single-subject response. <code><a href="lme4.html#topic+glmer">glmer</a></code> 
for Generalized Linear Mixed Models (including fixed and random effects). <code>MixDelta</code> for estimating PSE and JND at a population level 
with delta method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data.S1 &lt;- subset(simul_data, Subject == "S1")
model.glm = glm(formula = cbind(Longer, Total - Longer) ~ X,
family = binomial(link = "probit"), data = data.S1)
PsychDelta(model.glm)

</code></pre>

<hr>
<h2 id='PsychFunction'>Psychometric Function and PSE/JND Parameters from Single-Subject Response</h2><span id='topic+PsychFunction'></span>

<h3>Description</h3>

<p>Fit psychometric functions using <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="brglm.html#topic+brglm">brglm</a></code>. 
Estimate PSE, JND, and related confidence intervals with Delta Method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PsychFunction(ps.formula, ps.link, ps.data, br = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PsychFunction_+3A_ps.formula">ps.formula</code></td>
<td>
<p>an object of class <code><a href="stats.html#topic+formula">formula</a></code>, such as <code>cbind(yes, no) ~ X</code></p>
</td></tr>
<tr><td><code id="PsychFunction_+3A_ps.link">ps.link</code></td>
<td>
<p>link function for the binomial family of error distribution. Default is <code>probit</code>.</p>
</td></tr>
<tr><td><code id="PsychFunction_+3A_ps.data">ps.data</code></td>
<td>
<p>a data frame including the variables used in the model.</p>
</td></tr>
<tr><td><code id="PsychFunction_+3A_br">br</code></td>
<td>
<p>logical. If TRUE, <code><a href="brglm.html#topic+brglm">brglm</a></code> for bias reduction is used if values are equal to 0 or 1. 
Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimates are computed only for GLM of the type <code>F(Y) ~ X</code>, where X is a continuous
predictor. Std. Errors and 95% confidence intervals of PSE and JND are estimated via Delta Methods. 
Currently only working with <em>probit</em> link function.
</p>


<h3>Value</h3>

<p><code>PsychFunction</code> returns a list including the fitted model,
the estimate of PSE and JND and a flag to indicate if <code><a href="brglm.html#topic+brglm">brglm</a></code> was called.
</p>


<h3>Note</h3>

<p><code>PsychFunction</code> returns the same parameter estimate as <code><a href="#topic+PsychDelta">PsychDelta</a></code>, without an explicit call to <code><a href="stats.html#topic+glm">glm</a></code>. 
Moreover, it allows to fit the model using <code><a href="brglm.html#topic+brglm">brglm</a></code> in case of complete or quasi separation.
</p>


<h3>References</h3>

<p>Faraggi, D., Izikson, P., &amp; Reiser, B. (2003). Confidence intervals for the 50 per cent 
response dose. Statistics in medicine, 22(12), 1977-1988. https://doi.org/10.1002/sim.1368
</p>
<p>Moscatelli, A., Mezzetti, M., &amp; Lacquaniti, F. (2012). Modeling psychophysical data 
at the population-level: The generalized linear mixed model. 
Journal of Vision, 12(11):26, 1-17. doi:10.1167/12.11.26
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code> for Generalized Linear Models. 
<code><a href="brglm.html#topic+brglm">brglm</a></code> for fitting a GLM using bias reduction.
<code><a href="#topic+PsychPlot">PsychPlot</a></code> for plotting a psychometric function given a <code><a href="stats.html#topic+glm">glm</a></code> (or <code><a href="brglm.html#topic+brglm">brglm</a></code>) object.
<code><a href="#topic+PsychPlot">PsychPlot</a></code> for plotting a a psychometric function from a GLM. 
<code><a href="#topic+PsychShape">PsychShape</a></code> for plotting a psychometric function given PSE and JND.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data.S1 &lt;- subset(simul_data, Subject == "S1")
psych.S1 &lt;- PsychFunction(ps.formula = cbind(Longer, Total - Longer) ~ X, 
ps.link = "probit", ps.data = data.S1)
                        
</code></pre>

<hr>
<h2 id='PsychPlot'>Plot Psychometric Function from GLM</h2><span id='topic+PsychPlot'></span>

<h3>Description</h3>

<p>Plot a psychometric function given an object of class <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="brglm.html#topic+brglm">brglm</a></code>. 
The plot can be drawn on a new or existing <code>ggplot</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PsychPlot(
  model.obj,
  addTo = NULL,
  showData = TRUE,
  ps.type = "solid",
  ps.size = 1,
  ps.lab = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PsychPlot_+3A_model.obj">model.obj</code></td>
<td>
<p>the fitted psychometric function. An object of class <code><a href="stats.html#topic+glm">glm</a></code> or <code><a href="brglm.html#topic+brglm">brglm</a></code>.</p>
</td></tr>
<tr><td><code id="PsychPlot_+3A_addto">addTo</code></td>
<td>
<p>specifies an existing <code>ggplot</code> object where the new line should be plotted. If no object is given, the function is drawn on a new plot.</p>
</td></tr>
<tr><td><code id="PsychPlot_+3A_showdata">showData</code></td>
<td>
<p>logical, defines if proportion of binomial responses for each stimulus level are presented. Default is TRUE.</p>
</td></tr>
<tr><td><code id="PsychPlot_+3A_ps.type">ps.type</code>, <code id="PsychPlot_+3A_ps.size">ps.size</code></td>
<td>
<p>type and size of the plotted line (see <code>"ggplot2-spec"</code>).</p>
</td></tr>
<tr><td><code id="PsychPlot_+3A_ps.lab">ps.lab</code></td>
<td>
<p>label assigned to the psychometric curve. The label is coded by the color aesthetic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>PsychPlot</code> returns a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object.
</p>


<h3>References</h3>

<p>Moscatelli, A., Mezzetti, M., &amp; Lacquaniti, F. (2012). Modeling psychophysical data 
at the population-level: The generalized linear mixed model. 
Journal of Vision, 12(11):26, 1-17. doi:10.1167/12.11.26
</p>
<p>Knoblauch, K., &amp; Maloney, L. T. (2012). Modeling psychophysical data in R (Vol. 32). 
Springer Science &amp; Business Media.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code> for for Generalized Linear Models.
<code><a href="#topic+PsychFunction">PsychFunction</a></code> for estimation of PSE and JND.
<code><a href="#topic+MixPlot">MixPlot</a></code> for plotting individual responses from a GLMM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data.S1 &lt;- subset(simul_data, Subject == "S1")
psych.S1 &lt;- PsychFunction(ps.formula = cbind(Longer, Total - Longer) ~ X, 
ps.link = "probit", ps.data = data.S1)
plotP1 &lt;- PsychPlot(psych.S1$model, showData = TRUE, ps.lab = "S1") 

data.S2 &lt;- subset(simul_data, Subject == "S2")
glm.S2 &lt;- glm(formula = cbind(Longer, Total - Longer) ~ X, 
           family = binomial(link = "probit"), data = data.S2)
plotP2 &lt;- PsychPlot(glm.S2, addTo = plotP1, ps.lab = "S2")

</code></pre>

<hr>
<h2 id='PsychShape'>Plot Psychometric Functions given PSE and JND</h2><span id='topic+PsychShape'></span>

<h3>Description</h3>

<p>Plot a psychometric function with known PSE and JND on a new or existing <code>ggplot</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PsychShape(
  pse = 0,
  jnd = 1,
  p = 0.75,
  x.range = c(NA, NA),
  ps.link = c("probit"),
  ps.type = "solid",
  ps.size = 1,
  ps.color = "black",
  addTo = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PsychShape_+3A_pse">pse</code>, <code id="PsychShape_+3A_jnd">jnd</code></td>
<td>
<p>point of subjective equivalende (PSE) and just noticeable difference (JND) of the desired psychometric function.</p>
</td></tr>
<tr><td><code id="PsychShape_+3A_p">p</code></td>
<td>
<p>probability value relative to the JND upper limit. Default is 0.75 (value for 50% JND).</p>
</td></tr>
<tr><td><code id="PsychShape_+3A_x.range">x.range</code></td>
<td>
<p>vector of length two specifying the range of the psychometric function.</p>
</td></tr>
<tr><td><code id="PsychShape_+3A_ps.link">ps.link</code></td>
<td>
<p>a link function for the binomial family of error distribution.</p>
</td></tr>
<tr><td><code id="PsychShape_+3A_ps.type">ps.type</code>, <code id="PsychShape_+3A_ps.size">ps.size</code>, <code id="PsychShape_+3A_ps.color">ps.color</code></td>
<td>
<p>type, size, and color of the plotted line (see <code>"ggplot2-spec"</code>).</p>
</td></tr>
<tr><td><code id="PsychShape_+3A_addto">addTo</code></td>
<td>
<p>specifies an existing <code>ggplot</code> object where the new line should be plotted. If no object is given, the function is drawn on a new plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PsychShape()</code> can be used to visualize the predicted results of a
psychophysical experiment or to plot a fitted psychometric function whose
values of pse and jnd are known. Currently only working with probit and logit
link function.
</p>


<h3>Value</h3>

<p><code>PsychShape</code> returns a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object.
</p>


<h3>References</h3>

<p>Moscatelli, A., Mezzetti, M., &amp; Lacquaniti, F. (2012). Modeling psychophysical data 
at the population-level: The generalized linear mixed model. 
Journal of Vision, 12(11):26, 1-17. doi:10.1167/12.11.26
</p>
<p>Knoblauch, K., &amp; Maloney, L. T. (2012). Modeling psychophysical data in R (Vol. 32). 
Springer Science &amp; Business Media.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code> for for Generalized Linear Models.
<code><a href="#topic+PsychFunction">PsychFunction</a></code> and <code><a href="#topic+PsychDelta">PsychDelta</a></code> for estimation of PSE and JND from response data.
<code><a href="#topic+PsychPlot">PsychPlot</a></code> for plotting a a psychometric function from a GLM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- PsychShape(pse = 0, jnd = 6, x.range = c(-40, 40), ps.color = "gray", ps.size = 3)
p1 &lt;- PsychShape(pse = 6, jnd = 6, x.range = c(-40, 40), ps.col = "black", addTo = p)
p2 &lt;- PsychShape(pse = 6, jnd = 6, x.range = c(-40, 40), ps.col = "red", ps.link = "logit", 
ps.type = "dashed", addTo = NULL)

</code></pre>

<hr>
<h2 id='PsySimulate'>Simulate psychophysical data</h2><span id='topic+PsySimulate'></span>

<h3>Description</h3>

<p>The function simulates data of a typical psychophysics experiment. For each simulated 
participant, the function returns the following information: individual slope and intercept 
coefficients, given the fixed and random effects parameters provided as input; summary of 
the simulated binomial response to a range of intensity levels between a specified range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PsySimulate(
  fixeff = c(-7, 0.0875),
  raneff = c(2.4, -0.002, 2e-06),
  nsubjects = 8,
  ntrials = 40,
  nintervals = 9,
  xint = c(40, 120),
  constant = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PsySimulate_+3A_fixeff">fixeff</code></td>
<td>
<p>array of fixed effects. First item is the intercept, second
item is the slope.</p>
</td></tr>
<tr><td><code id="PsySimulate_+3A_raneff">raneff</code></td>
<td>
<p>array of random effects. First item is the intercept, second
item is the covariance, third item is the slope.</p>
</td></tr>
<tr><td><code id="PsySimulate_+3A_nsubjects">nsubjects</code></td>
<td>
<p>number of subjects to simulate. Default is 8.</p>
</td></tr>
<tr><td><code id="PsySimulate_+3A_ntrials">ntrials</code></td>
<td>
<p>number of trials for each stimulus level. Default is 40.</p>
</td></tr>
<tr><td><code id="PsySimulate_+3A_nintervals">nintervals</code></td>
<td>
<p>number of stimulus levels. Default is 9.</p>
</td></tr>
<tr><td><code id="PsySimulate_+3A_xint">xint</code></td>
<td>
<p>range of the stimulus interval. Default is c(40,120)</p>
</td></tr>
<tr><td><code id="PsySimulate_+3A_constant">constant</code></td>
<td>
<p>logical. If set to FALSE, stimulus levels are randomly generated,
uniformly distributed values within the selected interval.
otherwise, the X interval is divided in  intervals of constant
length. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>PsySimulate</code> returns a simulated dataset. If no input arguments are specified, the function returns 
a dataset with the same characteristics as <code><a href="#topic+simul_data">simul_data</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PsychShape">PsychShape</a></code> for plotting a psychometric function given PSE and JND.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>datafr.S1 &lt;- PsySimulate(fixeff = c(0, 1), xint = c(-5,5), 
nsubject = 1, ntrials = 60, nintervals = 10, constant = FALSE)
library(ggplot2)
g &lt;- ggplot(datafr.S1, aes(X,Longer/Total)) + geom_point()

PsychShape(pse = 0, jnd = qnorm(0.75)/1, ps.link = "probit", 
x.range = c(-5,5), addTo = g, ps.color = "red")

</code></pre>

<hr>
<h2 id='simul_data'>A simulated psychophysical dataset</h2><span id='topic+simul_data'></span>

<h3>Description</h3>

<p>A dataset containing simulated responses to a forced-choice task for eight clusters. Created using 
<code>PsySimulate()</code>. The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simul_data)
</code></pre>


<h3>Format</h3>

<p>A data frame with 72 rows (9 observations x 8 simulated participants) and 6 variables:
</p>

<dl>
<dt>X</dt><dd><p>samples in the continuous interval (range <code>c(40,120)</code>)</p>
</dd>
<dt>Intercept,Slope</dt><dd><p>simulated participant's coefficients (combination of random and fixed effect)</p>
</dd>
<dt>Longer</dt><dd><p>number of trials in which response is judged &quot;longer&quot; than standard</p>
</dd>
<dt>Total</dt><dd><p>total number of trials for sample in X</p>
</dd>
<dt>Subject</dt><dd><p>simulated participant's identification code (S1 to S8)</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+PsySimulate">PsySimulate</a></code> for simulating dataframes with custom parameters.
</p>

<hr>
<h2 id='vibro_exp3'>Data from tactile discrimination task - (Dallmann et al., 2015).</h2><span id='topic+vibro_exp3'></span>

<h3>Description</h3>

<p>A dataset containing the response recorded from a tactile discrimination task (nine participants). In a
forced-choice experiment, participants were required to discriminate the motion speed of a moving surface by
touching it. Simultaneously with the motion stimulus, a 32Hz masking vibration occurred in half of the trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vibro_exp3)
</code></pre>


<h3>Format</h3>

<p>A data frame with 126 rows (14 observations x 9 participants) and 5 variables:
</p>

<dl>
<dt>speed</dt><dd><p>numeric, speed of the moving surface (in cm/s, range <code>c(1,16)</code>)</p>
</dd>
<dt>vibration</dt><dd><p>factor representing the vibration frequency of the masking stimulus. Two levels: 32 (vibration in the experimental condition, in Hz) 
or 0 (no vibration - control condition)</p>
</dd>
<dt>faster</dt><dd><p>proportion of trials in which the comparison stimulus was judged as faster than the reference</p>
</dd>
<dt>slower</dt><dd><p>proportion of trials in which the comparison stimulus was judged as slower than the reference</p>
</dd>
<dt>subject</dt><dd><p>participant's identification code</p>
</dd>
</dl>



<h3>Source</h3>

<p>Original data were published in Dallmann et al. (2015).
</p>


<h3>References</h3>

<p>Dallmann, C. J., Ernst, M. O., &amp; Moscatelli, A. (2015). 
The role of vibration in tactile speed perception. Journal of Neurophysiology, 114(6),
3131–3139. &lt;doi:10.1152/jn.00621.2015&gt;
</p>

<hr>
<h2 id='xplode'>Extract values from a fitted GLMM object</h2><span id='topic+xplode'></span>

<h3>Description</h3>

<p>Extract values from an object of class <code><a href="lme4.html#topic+merMod-class">merMod</a></code>
(more specifically, from an object of subclass <code>glmerMod</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xplode(model.obj, name.cont = NA, name.factor = NA, names.response = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xplode_+3A_model.obj">model.obj</code></td>
<td>
<p>The GLMM fitted with <code>glmer</code>. An object of class
<code>"<a href="lme4.html#topic+merMod-class">merMod</a>"</code>.</p>
</td></tr>
<tr><td><code id="xplode_+3A_name.cont">name.cont</code></td>
<td>
<p>A string providing the name of the continuous predictor,
as in the formula object of the fitted model</p>
</td></tr>
<tr><td><code id="xplode_+3A_name.factor">name.factor</code></td>
<td>
<p>A string providing the name of name of the categorical
predictor, as in the formula object of the fitted model</p>
</td></tr>
<tr><td><code id="xplode_+3A_names.response">names.response</code></td>
<td>
<p>Optional. A string providing the name of name of the
response variable, as in the formula object of the fitted model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For simplicity and maintenance reasons, several <code>MixedPsy</code> functions take as input an
object of class <code>xplode</code> instead of an object of class <code><a href="lme4.html#topic+merMod-class">merMod</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="lme4.html#topic+merMod-class">merMod-class</a></code> and <code><a href="lme4.html#topic+glmer">glmer</a></code>.
<code><a href="#topic+MixDelta">MixDelta</a></code>, <code><a href="#topic+MixPlot">MixPlot</a></code> for use of objects of class <code>xplode</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lme4)
multi.mod &lt;- glmer(cbind(faster, slower) ~ speed * vibration  + (1 + speed| subject), 
family = binomial(link = "probit"), data = vibro_exp3)
xplode.mod &lt;- xplode(multi.mod, name.cont = "speed", name.factor = "vibration")
MixPlot(xplode.mod)
MixDelta(xplode.mod)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
