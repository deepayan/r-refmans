<!DOCTYPE html><html lang="en"><head><title>Help for package causalQual</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {causalQual}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#causalQual_did'><p>Causal Inference for Qualitative Outcomes under Difference-in-Differences</p></a></li>
<li><a href='#causalQual_iv'><p>Causal Inference for Qualitative Outcomes under Instrumental Variables</p></a></li>
<li><a href='#causalQual_rd'><p>Causal Inference for Qualitative Outcomes under Regression Discontinuity</p></a></li>
<li><a href='#causalQual_soo'><p>Causal Inference for Qualitative Outcomes under Selection-on-Observables</p></a></li>
<li><a href='#generate_qualitative_data_did'><p>Generate Qualitative Data (Difference-in-Differences)</p></a></li>
<li><a href='#generate_qualitative_data_iv'><p>Generate Qualitative Data (Instrumental Variables)</p></a></li>
<li><a href='#generate_qualitative_data_rd'><p>Generate Qualitative Data (Regression Discontinuity)</p></a></li>
<li><a href='#generate_qualitative_data_soo'><p>Generate Qualitative Data (Selection-on-Observables)</p></a></li>
<li><a href='#plot.causalQual'><p>Plot Method for causalQual Objects</p></a></li>
<li><a href='#print.causalQual'><p>Print Method for causalQual Objects</p></a></li>
<li><a href='#rename_latex'><p>Renaming Variables for LATEX Usage</p></a></li>
<li><a href='#softmax'><p>Softmax function.</p></a></li>
<li><a href='#summary.causalQual'><p>Summary Method for causalQual Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Causal Inference for Qualitative Outcomes</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the framework introduced in Di Francesco and Mellace (2025) &lt;<a href="https://doi.org/10.48550%2FarXiv.2502.11691">doi:10.48550/arXiv.2502.11691</a>&gt;, shifting the focus to well-defined and interpretable 
    estimands that quantify how treatment affects the probability distribution over outcome categories. It supports selection-on-observables, instrumental variables, 
    regression discontinuity, and difference-in-differences designs.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>AER, caret, cli, ggplot2, ggsci, grf, lmtest, magrittr, ocf,
rdrobust, sandwich, stats, stringr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://riccardo-df.github.io/causalQual/">https://riccardo-df.github.io/causalQual/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-22 12:46:57 UTC; riccardo-df</td>
</tr>
<tr>
<td>Author:</td>
<td>Riccardo Di Francesco [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Riccardo Di Francesco &lt;difrancesco.riccardo96@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-24 17:20:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='causalQual_did'>Causal Inference for Qualitative Outcomes under Difference-in-Differences</h2><span id='topic+causalQual_did'></span>

<h3>Description</h3>

<p>Fit two-group/two-period models for qualitative outcomes to estimate the probabilities of shift on the treated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>causalQual_did(Y_pre, Y_post, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="causalQual_did_+3A_y_pre">Y_pre</code></td>
<td>
<p>Qualitative outcome before treatment. Must be labeled as <code class="reqn">\{1, 2, \dots\}</code>.</p>
</td></tr>
<tr><td><code id="causalQual_did_+3A_y_post">Y_post</code></td>
<td>
<p>Qualitative outcome after treatment. Must be labeled as <code class="reqn">\{1, 2, \dots\}</code>.</p>
</td></tr>
<tr><td><code id="causalQual_did_+3A_d">D</code></td>
<td>
<p>Binary treatment indicator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under a difference-in-difference design, identification requires that the probabilities time shift for <code class="reqn">Y_{is} (0)</code> for class <code class="reqn">m</code> evolve similarly for the treated and control groups (parallel
trends on the probability mass functions of <code class="reqn">Y_{is}(0)</code>). If this assumption holds, we can recover the probability of shift on the treated for class <code class="reqn">m</code>:
</p>
<p style="text-align: center;"><code class="reqn">\delta_{m, T} := P(Y_{it} (1) = m | D_i = 1) - P(Y_{it}(0) = m | D_i = 1).</code>
</p>

<p><code><a href="#topic+causalQual_did">causalQual_did</a></code> applies, for each class <code class="reqn">m</code>, the canonical two-group/two-period method to the binary variable <code class="reqn">1(Y_{is} = m)</code>. Specifically,
consider the following linear model:
</p>
<p style="text-align: center;"><code class="reqn">1(Y_{is} = m) = D_i \beta_{m1} + 1(s = t) \beta_{m2} + D_i 1(s = t) \beta_{m3} + \epsilon_{mis}.</code>
</p>

<p>The OLS estimate <code class="reqn">\hat{\beta}_{m3}</code> of <code class="reqn">\beta_{m3}</code> is our estimate of the probability shift on the treated for class <code>m</code>. Standard errors are clustered at the unit level and used to construct
conventional confidence intervals.
</p>


<h3>Value</h3>

<p>An object of class <code>causalQual</code>.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>References</h3>


<ul>
<li><p> Di Francesco, R., and Mellace, G. (2025). Causal Inference for Qualitative Outcomes. arXiv preprint arXiv:2502.11691. <a href="https://doi.org/10.48550/arXiv.2502.11691">doi:10.48550/arXiv.2502.11691</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+causalQual_soo">causalQual_soo</a></code> <code><a href="#topic+causalQual_iv">causalQual_iv</a></code> <code><a href="#topic+causalQual_rd">causalQual_rd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_did(100, assignment = "observational",
                                      outcome_type = "ordered")

Y_pre &lt;- data$Y_pre
Y_post &lt;- data$Y_post
D &lt;- data$D

## Estimate probabilities of shift on the treated.
fit &lt;- causalQual_did(Y_pre, Y_post, D)

summary(fit)
plot(fit)

</code></pre>

<hr>
<h2 id='causalQual_iv'>Causal Inference for Qualitative Outcomes under Instrumental Variables</h2><span id='topic+causalQual_iv'></span>

<h3>Description</h3>

<p>Fit two-stage least squares models for qualitative outcomes to estimate the local probabilities of shift.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>causalQual_iv(Y, D, Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="causalQual_iv_+3A_y">Y</code></td>
<td>
<p>Qualitative outcome before treatment. Must be labeled as <code class="reqn">\{1, 2, \dots\}</code>.</p>
</td></tr>
<tr><td><code id="causalQual_iv_+3A_d">D</code></td>
<td>
<p>Binary treatment indicator.</p>
</td></tr>
<tr><td><code id="causalQual_iv_+3A_z">Z</code></td>
<td>
<p>Binary instrument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under an instrumental-variables design, identification requires the instrument to be independent of potential outcomes and potential treatments (exogeneity), that the
instrument influences the outcome solely through its effect on treatment (exclusion restriction), that the instrument has a nonzero effect on treatment probability (relevance), and that the instrument can only
increase/decrease the treatment probability (monotonicity). If these assumptions hold, we can recover the local probabilities of shift for all classes:<br />
</p>
<p style="text-align: center;"><code class="reqn">\delta_{m, L} := P(Y_i(1) = m | i \, is \, complier) - P(Y_i(0) = m | i \, is \, complier), \, m = 1, \dots, M.</code>
</p>

<p><code><a href="#topic+causalQual_iv">causalQual_iv</a></code> applies, for each class <code>m</code>, the standard two-stage least squares method to the binary variable <code class="reqn">1(Y_i = m)</code>. Specifically, the routine first estimates
the following first-stage regression model via OLS:
</p>
<p style="text-align: center;"><code class="reqn">D_i = \gamma_0 + \gamma_1 Z_i + \nu_i,</code>
</p>

<p>and constructs the predicted values <code class="reqn">\hat{D}_i</code>. It then uses these predicted values in the second-stage regressions:
</p>
<p style="text-align: center;"><code class="reqn">1(Y_i = m) = \alpha_{m0} + \alpha_{m1} \hat{D}_i + \epsilon_{mi}, \quad m = 1, \dots, M.</code>
</p>

<p>The OLS estimate <code class="reqn">\hat{\alpha}_{m1}</code> of <code class="reqn">\alpha_{m1}</code> is then our estimate of <code class="reqn">\delta_{m, L}</code>. Standard errors are computed using conventional procedures and used to construct
conventional confidence intervals. All of this is done by calling the <code><a href="AER.html#topic+ivreg">ivreg</a></code> function.
</p>


<h3>Value</h3>

<p>An object of class <code>causalQual</code>.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>References</h3>


<ul>
<li><p> Di Francesco, R., and Mellace, G. (2025). Causal Inference for Qualitative Outcomes. arXiv preprint arXiv:2502.11691. <a href="https://doi.org/10.48550/arXiv.2502.11691">doi:10.48550/arXiv.2502.11691</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+causalQual_soo">causalQual_soo</a></code> <code><a href="#topic+causalQual_rd">causalQual_rd</a></code> <code><a href="#topic+causalQual_did">causalQual_did</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_iv(100, outcome_type = "ordered")

Y &lt;- data$Y
D &lt;- data$D
Z &lt;- data$Z

## Estimate local probabilities of shift.
fit &lt;- causalQual_iv(Y, D, Z)

summary(fit)
plot(fit)

</code></pre>

<hr>
<h2 id='causalQual_rd'>Causal Inference for Qualitative Outcomes under Regression Discontinuity</h2><span id='topic+causalQual_rd'></span>

<h3>Description</h3>

<p>Fit local polynomial regression models for qualitative outcomes to estimate the probabilities of shift at the cutoff.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>causalQual_rd(Y, running_variable, cutoff)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="causalQual_rd_+3A_y">Y</code></td>
<td>
<p>Qualitative outcome. Must be labeled as <code class="reqn">\{1, 2, \dots\}</code>.</p>
</td></tr>
<tr><td><code id="causalQual_rd_+3A_running_variable">running_variable</code></td>
<td>
<p>Running variable determining treatment assignment.</p>
</td></tr>
<tr><td><code id="causalQual_rd_+3A_cutoff">cutoff</code></td>
<td>
<p>Cutoff or threshold. Units with <code>running_variable &lt; cutoff</code> are considered controls, while units with <code>running_variable &gt;= cutoff</code> are considered treated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under a regression discontinuity design, identification requires that the probability mass functions for class <code class="reqn">m</code> of potential outcomes are continuous in the running variable (continuity). If this assumption holds,
we can recover the probability shift at the cutoff for class <code class="reqn">m</code>:
</p>
<p style="text-align: center;"><code class="reqn">\delta_{m, C} := P(Y_i (1) = m | Running_i = cutoff) - P(Y_i(0) = m | Running_i = cutoff).</code>
</p>

<p><code><a href="#topic+causalQual_rd">causalQual_rd</a></code> applies, for each class <code class="reqn">m</code>, standard local polynomial estimators to the binary variable <code class="reqn">1(Y_i = m)</code>. Specifically, the ruotine implements the
robust bias-corrected inference procedure of Calonico et al. (2014) (see the <code><a href="rdrobust.html#topic+rdrobust">rdrobust</a></code> function).
</p>


<h3>Value</h3>

<p>An object of class <code>causalQual</code>.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>References</h3>


<ul>
<li><p> Di Francesco, R., and Mellace, G. (2025). Causal Inference for Qualitative Outcomes. arXiv preprint arXiv:2502.11691. <a href="https://doi.org/10.48550/arXiv.2502.11691">doi:10.48550/arXiv.2502.11691</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+causalQual_soo">causalQual_soo</a></code> <code><a href="#topic+causalQual_iv">causalQual_iv</a></code> <code><a href="#topic+causalQual_did">causalQual_did</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_rd(100, outcome_type = "ordered")

Y &lt;- data$Y
running_variable &lt;- data$running_variable
cutoff &lt;- data$cutoff

## Estimate probabilities of shift at the cutoff.
fit &lt;- causalQual_rd(Y, running_variable, cutoff)

summary(fit)
plot(fit)

</code></pre>

<hr>
<h2 id='causalQual_soo'>Causal Inference for Qualitative Outcomes under Selection-on-Observables</h2><span id='topic+causalQual_soo'></span>

<h3>Description</h3>

<p>Construct and average doubly robust scores for qualitative outcomes to estimate the probabilities of shift.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>causalQual_soo(Y, D, X, outcome_type, K = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="causalQual_soo_+3A_y">Y</code></td>
<td>
<p>Qualitative outcome. Must be labeled as <code class="reqn">\{1, 2, \dots\}</code>.</p>
</td></tr>
<tr><td><code id="causalQual_soo_+3A_d">D</code></td>
<td>
<p>Binary treatment indicator.</p>
</td></tr>
<tr><td><code id="causalQual_soo_+3A_x">X</code></td>
<td>
<p>Covariate matrix (no intercept).</p>
</td></tr>
<tr><td><code id="causalQual_soo_+3A_outcome_type">outcome_type</code></td>
<td>
<p>String controlling the outcome type. Must be either <code>"multinomial"</code> or <code>"ordered"</code>. Affects estimation of conditional class probabilities.</p>
</td></tr>
<tr><td><code id="causalQual_soo_+3A_k">K</code></td>
<td>
<p>Number of folds for nuisance functions estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under a selection-on-observables design, identification requires the treatment indicator to be (conditionally) independent of potential outcomes
(unconfoundedness), and that each unit has a non-zero probability of being treated (common support). If these assumptions hold, we can recover the
probabilities of shift of all classes:
</p>
<p style="text-align: center;"><code class="reqn">\delta_m := P(Y_i(1) = m) - P(Y_i(0) = m), \, m = 1, \dots, M.</code>
</p>

<p><code><a href="#topic+causalQual_soo">causalQual_soo</a></code> constructs and averages doubly robust scores for qualitative outcomes
to estimate <code class="reqn">\delta_m</code>. For each class <code class="reqn">m</code>, the doubly robust score for unit <code class="reqn">i</code> is defined as:
</p>
<p style="text-align: center;"><code class="reqn">
    \hat{\Gamma}_{m, i} =
    \hat{P}(Y_i = m \mid D_i = 1, X_i) -
    \hat{P}(Y_i = m \mid D_i = 0, X_i) +
</code>
</p>

<p style="text-align: center;"><code class="reqn">
    D_i \frac{1\{Y_i = m\} - \hat{P}(Y_i = m \mid D_i = 1, X_i)}
    {\hat{P}(D_i = 1 | X_i)}
    - (1 - D_i) \frac{1\{Y_i = m\} - \hat{P}(Y_i = m \mid D_i = 0, X_i)}
    {1 - \hat{P}(D_i = 1 | X_i)}.
</code>
</p>

<p>The estimator for <code class="reqn">\delta_m</code> is then the average of the scores:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\delta}_m = \frac{1}{n} \sum_{i=1}^{n} \hat{\Gamma}_{m, i},</code>
</p>

<p>with its variance estimated as:
</p>
<p style="text-align: center;"><code class="reqn">
    \widehat{\text{Var}} ( \hat{\delta}_m ) = \frac{1}{n} \sum_{i=1}^{n} ( \hat{\Gamma}_{m, i} - \hat{\delta}_m )^2.
</code>
</p>

<p><code><a href="#topic+causalQual_soo">causalQual_soo</a></code> uses these estimates to construct confidence intervals based on conventional normal approximations.<br />
</p>
<p>If <code>outcome_type == "multinomial"</code>, <code class="reqn">\hat{P}(Y_i = m \mid D_i = 1, X_i)</code> and <code class="reqn">\hat{P}(Y_i = m \mid D_i = 0, X_i)</code> are estimated using a <code><a href="ocf.html#topic+multinomial_ml">multinomial_ml</a></code> strategy with regression forests
as base learners. Else, if <code>outcome_type == "ordered"</code>, <code class="reqn">\hat{P}(Y_i = m \mid D_i = 1, X_i)</code> and <code class="reqn">\hat{P}(Y_i = m \mid D_i = 0, X_i)</code> are estimated using the honest version of the <code><a href="ocf.html#topic+ocf">ocf</a></code> estimator.
<code class="reqn">\hat{P}(D_i = 1 | X_i)</code> is always estimated via a honest <code><a href="grf.html#topic+regression_forest">regression_forest</a></code>. <code>K</code>-fold cross-fitting is employed for the estimation of all these functions.<br />
</p>
<p>Folds are created by random split. If some class of <code>Y</code> is not observed in one or more folds for one or both treatment groups, a new random partition is performed. This process is repeat until when all
classes are observed in all folds and for all treatment groups up to 1000 times, after which the routine raises an error.
</p>


<h3>Value</h3>

<p>An object of class <code>causalQual</code>.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>References</h3>


<ul>
<li><p> Di Francesco, R., and Mellace, G. (2025). Causal Inference for Qualitative Outcomes. arXiv preprint arXiv:2502.11691. <a href="https://doi.org/10.48550/arXiv.2502.11691">doi:10.48550/arXiv.2502.11691</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+causalQual_iv">causalQual_iv</a></code> <code><a href="#topic+causalQual_rd">causalQual_rd</a></code> <code><a href="#topic+causalQual_did">causalQual_did</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_soo(200, assignment = "observational",
                                      outcome_type = "ordered")
Y &lt;- data$Y
D &lt;- data$D
X &lt;- data$X

# Estimate probabilities of shift.
fit &lt;- causalQual_soo(Y, D, X, outcome_type = "ordered", K = 2)

summary(fit)
plot(fit)

</code></pre>

<hr>
<h2 id='generate_qualitative_data_did'>Generate Qualitative Data (Difference-in-Differences)</h2><span id='topic+generate_qualitative_data_did'></span>

<h3>Description</h3>

<p>Generate a synthetic data set with qualitative outcomes under a difference-in-differences design. The data include two time periods, a binary treatment indicator (applied only in the second period),
and a matrix of covariates. Probabilities time shift among the treated and control groups evolve similarly across the two time periods (parallel trends on the probability mass functions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_qualitative_data_did(n, assignment, outcome_type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_qualitative_data_did_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="generate_qualitative_data_did_+3A_assignment">assignment</code></td>
<td>
<p>String controlling treatment assignment. Must be either <code>"randomized"</code> (random assignment)
or <code>"observational"</code> (assignment based on covariates).</p>
</td></tr>
<tr><td><code id="generate_qualitative_data_did_+3A_outcome_type">outcome_type</code></td>
<td>
<p>String controlling the outcome type. Must be either <code>"multinomial"</code> or <code>"ordered"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Outcome type</h4>

<p>Potential outcomes are generated differently according to <code>outcome_type</code>. If <code>outcome_type == "multinomial"</code>, <code><a href="#topic+generate_qualitative_data_did">generate_qualitative_data_did</a></code> computes linear predictors for each class using the covariates:
</p>
<p style="text-align: center;"><code class="reqn">\eta_{mi} (d, s) = \beta_{m1}^d X_{i1} + \beta_{m2}^d X_{i2} + \beta_{m3}^d X_{i3}, \quad d = 0, 1, \quad s = t-1, t,</code>
</p>

<p>and then transforms <code class="reqn">\eta_{mi} (d, s)</code> into valid probability distributions using the softmax function:
</p>
<p style="text-align: center;"><code class="reqn">P(Y_{is}(d) = m | X_i) = \frac{\exp(\eta_{mi} (d, s))}{\sum_{m'} \exp(\eta_{m'i}(d, s))}, \quad d = 0, 1, \quad s = t-1, t.</code>
</p>

<p>It then generates potential outcomes <code class="reqn">Y_{it-1}(1)</code>, <code class="reqn">Y_{it}(1)</code>, <code class="reqn">Y_{it-1}(0)</code>, and <code class="reqn">Y_{it}(0)</code> by sampling from {1, 2, 3} using <code class="reqn">P(Y(d, s) = m \mid X), \, d = 0, 1, \, s = t-1, t</code>.<br />
</p>
<p>If instead <code>outcome_type == "ordered"</code>, <code><a href="#topic+generate_qualitative_data_did">generate_qualitative_data_did</a></code> first generates latent potential outcomes:
</p>
<p style="text-align: center;"><code class="reqn">Y_i^* (d, s) = \tau d + X_{i1} + X_{i2} + X_{i3} + N (0, 1), \quad d = 0, 1, \quad s = t-1, t,</code>
</p>

<p>with <code class="reqn">\tau = 2</code>. It then constructs <code class="reqn">Y_i (d, s)</code> by discretizing <code class="reqn">Y_i^* (d, s)</code> using threshold parameters <code class="reqn">\zeta_1 = 2</code> and <code class="reqn">\zeta_2 = 4</code>. Then,
</p>
<p style="text-align: center;"><code class="reqn">P(Y_i(d, s) = m | X_i) = P(\zeta_{m-1} &lt; Y_i^*(d, s) \leq \zeta_m | X_i) = \Phi (\zeta_m - \sum_j X_{ij} - \tau d) - \Phi (\zeta_{m-1} - \sum_j X_{ij} - \tau d), \quad d = 0, 1, \quad s = t-1, t,</code>
</p>

<p>which allows us to analytically compute the probabilities of shift on the treated.
</p>



<h4>Treatment assignment</h4>

<p>Treatment is always assigned as <code class="reqn">D_i \sim \text{Bernoulli}(\pi(X_i))</code>. If <code>assignment == "randomized"</code>, then the propensity score is specified as <code class="reqn">\pi(X_i) = P ( D_i = 1 | X_i)) = 0.5</code>.
If instead <code>assignment == "observational"</code>, then <code class="reqn">\pi(X_i) = (X_{i1} + X_{i3}) / 2</code>.
</p>



<h4>Other details</h4>

<p>The function always generates three independent covariates from <code class="reqn">U(0,1)</code>. Observed outcomes <code class="reqn">Y_{is}</code> are always constructed using the usual observational rule.
</p>



<h3>Value</h3>

<p>A list storing a data frame with the observed data, the true propensity score, and the true probabilities of shift on the treated.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_qualitative_data_soo">generate_qualitative_data_soo</a></code> <code><a href="#topic+generate_qualitative_data_iv">generate_qualitative_data_iv</a></code> <code><a href="#topic+generate_qualitative_data_rd">generate_qualitative_data_rd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_did(100,
                                      assignment = "observational",
                                      outcome_type = "ordered")

data$pshifts_treated

</code></pre>

<hr>
<h2 id='generate_qualitative_data_iv'>Generate Qualitative Data (Instrumental Variables)</h2><span id='topic+generate_qualitative_data_iv'></span>

<h3>Description</h3>

<p>Generate a synthetic data set with qualitative outcomes under an instrumental variables design. The data include a binary treatment indicator and a binary instrument. Potential outcomes
and potential treatments are independent of the instrument. Moreover, the instrument does not directly impact potential outcomes, has an impact on treatment probability, and can only increase the probability
of treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_qualitative_data_iv(n, outcome_type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_qualitative_data_iv_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="generate_qualitative_data_iv_+3A_outcome_type">outcome_type</code></td>
<td>
<p>String controlling the outcome type. Must be either <code>"multinomial"</code> or <code>"ordered"</code>. Affects how potential outcomes are generated.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Outcome type</h4>

<p>Potential outcomes are generated differently according to <code>outcome_type</code>. If <code>outcome_type == "multinomial"</code>, <code><a href="#topic+generate_qualitative_data_iv">generate_qualitative_data_iv</a></code> computes linear predictors for each class using the covariates:
</p>
<p style="text-align: center;"><code class="reqn">\eta_{mi} (d) = \beta_{m1}^d X_{i1} + \beta_{m2}^d X_{i2} + \beta_{m3}^d X_{i3}, \quad d = 0, 1,</code>
</p>

<p>and then transforms <code class="reqn">\eta_{mi} (d)</code> into valid probability distributions using the softmax function:
</p>
<p style="text-align: center;"><code class="reqn">P(Y_i(d) = m | X_i) = \frac{\exp(\eta_{mi} (d))}{\sum_{m'} \exp(\eta_{m'i}(d))}, \quad d = 0, 1.</code>
</p>

<p>It then generates potential outcomes <code class="reqn">Y_i(1)</code> and <code class="reqn">Y_i(0)</code> by sampling from {1, 2, 3} using <code class="reqn">P_i(Y(d) = m | X), \, d = 0, 1</code>.<br />
</p>
<p>If instead <code>outcome_type == "ordered"</code>, <code><a href="#topic+generate_qualitative_data_iv">generate_qualitative_data_iv</a></code> first generates latent potential outcomes:
</p>
<p style="text-align: center;"><code class="reqn">Y_i^* (d) = \tau d + X_{i1} + X_{i2} + X_{i3} + N (0, 1), \quad d = 0, 1,</code>
</p>

<p>with <code class="reqn">\tau = 2</code>. It then constructs <code class="reqn">Y_i (d)</code> by discretizing <code class="reqn">Y_i^* (d)</code> using threshold parameters <code class="reqn">\zeta_1 = 2</code> and <code class="reqn">\zeta_2 = 4</code>. Then,
</p>
<p style="text-align: center;"><code class="reqn">P(Y_i(d) = m | X_i) = P(\zeta_{m-1} &lt; Y_i^*(d) \leq \zeta_m | X_i) = \Phi (\zeta_m - \sum_j X_{ij} - \tau d) - \Phi (\zeta_{m-1} - \sum_j X_{ij} - \tau d), \quad d = 0, 1,</code>
</p>

<p>which allows us to analytically compute the local probabilities of shift.
</p>



<h4>Treatment assignment and instrument</h4>

<p>The instrument is always generated as <code class="reqn">Z_i \sim \text{Bernoulli}(0.5)</code>. Treatment is always modeled as <code class="reqn">D_i \sim \text{Bernoulli}(\pi(X_i, Z_i))</code>, with
<code class="reqn">\pi(X_i, Z_i) = P ( D_i = 1 | X_i, Z_i)) = (X_{i1} + X_{i3} + Z_i) / 3</code>. Thus, <code class="reqn">Z_i</code> can increase the probability of treatment intake but cannot decrease it.
</p>



<h4>Other details</h4>

<p>The function always generates three independent covariates from <code class="reqn">U(0,1)</code>. Observed outcomes <code class="reqn">Y_i</code> are always constructed using the usual observational rule.
</p>



<h3>Value</h3>

<p>A list storing a data frame with the observed data, the true propensity score, the true instrument propensity score, and the true local probabilities of shift.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_qualitative_data_soo">generate_qualitative_data_soo</a></code> <code><a href="#topic+generate_qualitative_data_rd">generate_qualitative_data_rd</a></code> <code><a href="#topic+generate_qualitative_data_did">generate_qualitative_data_did</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_iv(100,
                                     outcome_type = "ordered")

data$local_pshifts

</code></pre>

<hr>
<h2 id='generate_qualitative_data_rd'>Generate Qualitative Data (Regression Discontinuity)</h2><span id='topic+generate_qualitative_data_rd'></span>

<h3>Description</h3>

<p>Generate a synthetic data set with qualitative outcomes under a regression discontinuity design. The data include a binary treatment indicator and a single covariate (the running variable). The conditional
probability mass fuctions of potential outcomes are continuous in the running variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_qualitative_data_rd(n, outcome_type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_qualitative_data_rd_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="generate_qualitative_data_rd_+3A_outcome_type">outcome_type</code></td>
<td>
<p>String controlling the outcome type. Must be either <code>"multinomial"</code> or <code>"ordered"</code>. Affects how potential outcomes are generated.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Outcome type</h4>

<p>Potential outcomes are generated differently according to <code>outcome_type</code>. If <code>outcome_type == "multinomial"</code>, <code><a href="#topic+generate_qualitative_data_rd">generate_qualitative_data_rd</a></code> computes linear predictors for each class using the covariates:
</p>
<p style="text-align: center;"><code class="reqn">\eta_{mi} (d) = \beta_{m1}^d X_{i1} + \beta_{m2}^d X_{i2} + \beta_{m3}^d X_{i3}, \quad d = 0, 1,</code>
</p>

<p>and then transforms <code class="reqn">\eta_{mi} (d)</code> into valid probability distributions using the softmax function:
</p>
<p style="text-align: center;"><code class="reqn">P(Y_i(d) = m | X_i) = \frac{\exp(\eta_{mi} (d))}{\sum_{m'} \exp(\eta_{m'i}(d))}.</code>
</p>

<p>It then generates potential outcomes <code class="reqn">Y_i(1)</code> and <code class="reqn">Y_i(0)</code> by sampling from {1, 2, 3} using <code class="reqn">P(Y_i(d) = m | X_i), \, d = 0, 1</code>.<br />
</p>
<p>If instead <code>outcome_type == "ordered"</code>, <code><a href="#topic+generate_qualitative_data_rd">generate_qualitative_data_rd</a></code> first generates latent potential outcomes:
</p>
<p style="text-align: center;"><code class="reqn">Y_i^* (d) = \tau d + X_{i1} + X_{i2} + X_{i3} + N (0, 1), \quad d = 0, 1,</code>
</p>

<p>with <code class="reqn">\tau = 2</code>. It then constructs <code class="reqn">Y_i (d)</code> by discretizing <code class="reqn">Y_i^* (d)</code> using threshold parameters <code class="reqn">\zeta_1 = 2</code> and <code class="reqn">\zeta_2 = 4</code>. Then,
</p>
<p style="text-align: center;"><code class="reqn">P(Y_i(d) = m) = P(\zeta_{m-1} &lt; Y_i^*(d) \leq \zeta_m) = \Phi (\zeta_m - \sum_j X_{ij} - \tau d) - \Phi (\zeta_{m-1} - \sum_j X_{ij} - \tau d), \quad d = 0, 1,</code>
</p>

<p>which allows us to analytically compute the probabilities of shift at the cutoff.
</p>



<h4>Treatment assignment</h4>

<p>Treatment is always assigned as <code class="reqn">D_i = 1(X_i \geq 0.5)</code>.
</p>



<h4>Other details</h4>

<p>The function always generates three independent covariates from <code class="reqn">U(0,1)</code>. Observed outcomes <code class="reqn">Y_i</code> are always constructed using the usual observational rule.
</p>



<h3>Value</h3>

<p>A list storing a data frame with the observed data, and the true probabilities of shift at the cutoff.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_qualitative_data_soo">generate_qualitative_data_soo</a></code> <code><a href="#topic+generate_qualitative_data_iv">generate_qualitative_data_iv</a></code> <code><a href="#topic+generate_qualitative_data_did">generate_qualitative_data_did</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_rd(100,
                                     outcome_type = "ordered")

data$pshifts_cutoff

</code></pre>

<hr>
<h2 id='generate_qualitative_data_soo'>Generate Qualitative Data (Selection-on-Observables)</h2><span id='topic+generate_qualitative_data_soo'></span>

<h3>Description</h3>

<p>Generate a synthetic data set with qualitative outcomes under a selection-on-observables design. The data include a binary treatment indicator and a matrix of covariates. The treatment is either
independent or conditionally (on the covariates) independent of potential outcomes, depending on users' choices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_qualitative_data_soo(n, assignment, outcome_type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_qualitative_data_soo_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="generate_qualitative_data_soo_+3A_assignment">assignment</code></td>
<td>
<p>String controlling treatment assignment. Must be either <code>"randomized"</code> (random assignment) or <code>"observational"</code> (random assigment conditional on the generated covariates).</p>
</td></tr>
<tr><td><code id="generate_qualitative_data_soo_+3A_outcome_type">outcome_type</code></td>
<td>
<p>String controlling the outcome type. Must be either <code>"multinomial"</code> or <code>"ordered"</code>. Affects how potential outcomes are generated.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Outcome type</h4>

<p>Potential outcomes are generated differently according to <code>outcome_type</code>. If <code>outcome_type == "multinomial"</code>, <code><a href="#topic+generate_qualitative_data_soo">generate_qualitative_data_soo</a></code> computes linear predictors for each class using the covariates:
</p>
<p style="text-align: center;"><code class="reqn">\eta_{mi} (d) = \beta_{m1}^d X_{i1} + \beta_{m2}^d X_{i2} + \beta_{m3}^d X_{i3}, \quad d = 0, 1,</code>
</p>

<p>and then transforms <code class="reqn">\eta_{mi} (d)</code> into valid probability distributions using the softmax function:
</p>
<p style="text-align: center;"><code class="reqn">P(Y_i(d) = m | X_i) = \frac{\exp(\eta_{mi} (d))}{\sum_{m'} \exp(\eta_{m'i}(d))}, \quad d = 0, 1.</code>
</p>

<p>It then generates potential outcomes <code class="reqn">Y_i(1)</code> and <code class="reqn">Y_i(0)</code> by sampling from {1, 2, 3} using <code class="reqn">P(Y_i(d) = m | X_i), \, d = 0, 1</code>.<br />
</p>
<p>If instead <code>outcome_type == "ordered"</code>, <code><a href="#topic+generate_qualitative_data_soo">generate_qualitative_data_soo</a></code> first generates latent potential outcomes:
</p>
<p style="text-align: center;"><code class="reqn">Y_i^* (d) = \tau d + X_{i1} + X_{i2} + X_{i3} + N (0, 1), \quad d = 0, 1,</code>
</p>

<p>with <code class="reqn">\tau = 2</code>. It then constructs <code class="reqn">Y_i (d)</code> by discretizing <code class="reqn">Y_i^* (d)</code> using threshold parameters <code class="reqn">\zeta_1 = 2</code> and <code class="reqn">\zeta_2 = 4</code>. Then,
</p>
<p style="text-align: center;"><code class="reqn">P(Y_i(d) = m | X_i) = P(\zeta_{m-1} &lt; Y_i^*(d) \leq \zeta_m | X_i) = \Phi (\zeta_m - \sum_j X_{ij} - \tau d) - \Phi (\zeta_{m-1} - \sum_j X_{ij} - \tau d), \quad d = 0, 1,</code>
</p>

<p>which allows us to analytically compute the probabilities of shift.
</p>



<h4>Treatment assignment</h4>

<p>Treatment is always assigned as <code class="reqn">D_i \sim \text{Bernoulli}(\pi(X_i))</code>. If <code>assignment == "randomized"</code>, then the propensity score is specified as <code class="reqn">\pi(X_i) = P ( D_i = 1 | X_i)) = 0.5</code>.
If instead <code>assignment == "observational"</code>, then <code class="reqn">\pi(X_i) = (X_{i1} + X_{i3}) / 2</code>.
</p>



<h4>Other details</h4>

<p>The function always generates three independent covariates from <code class="reqn">U(0,1)</code>. Observed outcomes <code class="reqn">Y_i</code> are always constructed using the usual observational rule.
</p>



<h3>Value</h3>

<p>A list storing a data frame with the observed data, the true propensity score, and the true probabilities of shift.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_qualitative_data_iv">generate_qualitative_data_iv</a></code> <code><a href="#topic+generate_qualitative_data_rd">generate_qualitative_data_rd</a></code> <code><a href="#topic+generate_qualitative_data_did">generate_qualitative_data_did</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_soo(100,
                                      assignment = "observational",
                                      outcome_type = "ordered")

data$pshifts

</code></pre>

<hr>
<h2 id='plot.causalQual'>Plot Method for causalQual Objects</h2><span id='topic+plot.causalQual'></span>

<h3>Description</h3>

<p>Plots an <code>causalQual</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'causalQual'
plot(x, hline = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.causalQual_+3A_x">x</code></td>
<td>
<p>An <code>causalQual</code> object.</p>
</td></tr>
<tr><td><code id="plot.causalQual_+3A_hline">hline</code></td>
<td>
<p>Logical, whether to display an horizontal line at zero in the plot.</p>
</td></tr>
<tr><td><code id="plot.causalQual_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots an causalQual object.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>See Also</h3>

<p>causalQual
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_soo(1000, assignment = "observational",
                                      outcome_type = "ordered")
Y &lt;- data$Y
D &lt;- data$D
X &lt;- data$X

## Estimate probabilities of shifts.
fit &lt;- causalQual_soo(Y = Y, D = D, X = X, outcome_type = "ordered")
plot(fit)

</code></pre>

<hr>
<h2 id='print.causalQual'>Print Method for causalQual Objects</h2><span id='topic+print.causalQual'></span>

<h3>Description</h3>

<p>Prints an <code>causalQual</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'causalQual'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.causalQual_+3A_x">x</code></td>
<td>
<p>An <code>causalQual</code> object.</p>
</td></tr>
<tr><td><code id="print.causalQual_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints an <code>causalQual</code> object.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>See Also</h3>

<p>causalQual
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_soo(1000, assignment = "observational",
                                      outcome_type = "ordered")
Y &lt;- data$Y
D &lt;- data$D
X &lt;- data$X

## Estimate probabilities of shifts.
fit &lt;- causalQual_soo(Y = Y, D = D, X = X, outcome_type = "ordered")
print(fit)

</code></pre>

<hr>
<h2 id='rename_latex'>Renaming Variables for LATEX Usage</h2><span id='topic+rename_latex'></span>

<h3>Description</h3>

<p>Renames variables where the character &quot;_&quot; is used, which causes clashes in LATEX. Useful for the <code>phased</code> print method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename_latex(names)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rename_latex_+3A_names">names</code></td>
<td>
<p>string vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The renamed string vector. Strings where &quot;_&quot; is not found are not modified by <code>rename_latex</code>.
</p>

<hr>
<h2 id='softmax'>Softmax function.</h2><span id='topic+softmax'></span>

<h3>Description</h3>

<p>Implementation of the softmax function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>softmax(logits)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="softmax_+3A_logits">logits</code></td>
<td>
<p>An nxM matrix, with n the sample size and M the number of classes of an ordinal outcome.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same matrix where each row is normalized so that row sums equal 1; useful to construct conditional probability mass functions.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>

<hr>
<h2 id='summary.causalQual'>Summary Method for causalQual Objects</h2><span id='topic+summary.causalQual'></span>

<h3>Description</h3>

<p>Summarizes an <code>causalQual</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'causalQual'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.causalQual_+3A_object">object</code></td>
<td>
<p>An <code>causalQual</code> object.</p>
</td></tr>
<tr><td><code id="summary.causalQual_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summarizes an <code>causalQual</code> object.
</p>


<h3>Author(s)</h3>

<p>Riccardo Di Francesco
</p>


<h3>See Also</h3>

<p>causalQual
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate synthetic data.
set.seed(1986)

data &lt;- generate_qualitative_data_soo(1000, assignment = "observational",
                                      outcome_type = "ordered")
Y &lt;- data$Y
D &lt;- data$D
X &lt;- data$X

## Estimate probabilities of shifts.
fit &lt;- causalQual_soo(Y = Y, D = D, X = X, outcome_type = "ordered")
summary(fit)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
