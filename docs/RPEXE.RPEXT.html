<!DOCTYPE html><html lang="en"><head><title>Help for package RPEXE.RPEXT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RPEXE.RPEXT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bisec'><p>Bisection algorithm in Beta distribution</p></a></li>
<li><a href='#data2'><p>RPEXE_fitting</p></a></li>
<li><a href='#df'><p>JAMA Breast cancer</p></a></li>
<li><a href='#exact_pvalue'><p>P-value for the two exponential comparison in Han et al.(2012)</p></a></li>
<li><a href='#gamllik'><p>Log likelihood from the gamma distribution</p></a></li>
<li><a href='#km'><p>Kaplan-Meier curve</p></a></li>
<li><a href='#km_blacksolid'><p>Kaplan-Meier curve</p></a></li>
<li><a href='#km_combine'><p>Comparing two Kaplan Meier curves in one plot</p></a></li>
<li><a href='#km_log'><p>Plot a Kaplan Meier curve in log scale</p></a></li>
<li><a href='#km_red'><p>Plot a Kaplan Meier curve in red</p></a></li>
<li><a href='#km_redsolid'><p>Plot a Kaplan Meier curve in red solid line</p></a></li>
<li><a href='#kmvalue'><p>Obtain values for Kaplan-Meier plotting</p></a></li>
<li><a href='#loopcut_onestep_data'><p>Example data for loopcut_onestep</p></a></li>
<li><a href='#loopcuts'><p>Change-point p-values with backward elimination</p></a></li>
<li><a href='#loopcuts_cut'><p>Example data for loopcuts_cuttimes</p></a></li>
<li><a href='#loopcuts_onestep'><p>Change-point p-values at given time points</p></a></li>
<li><a href='#loopcuts_t_c'><p>Example data for loopcut_times_censoring</p></a></li>
<li><a href='#loopcuts_umbrella'><p>Change-point p-values with backward elimination under umbrella alternative order restriction</p></a></li>
<li><a href='#loopcuts_umbrella_cuttimes_mono'><p>Example data for loopcut_umbrella</p></a></li>
<li><a href='#pava_dfr'><p>PAVA order restriction under decreasing failure rate (DFR)</p></a></li>
<li><a href='#pava_dfrd'><p>Example data for pava</p></a></li>
<li><a href='#pava_ifr'><p>PAVA order restriction under increasing failure rate (IFR)</p></a></li>
<li><a href='#pexeest'><p>RPEXE estimate given change-points</p></a></li>
<li><a href='#pexeest_times_censoring'><p>Example data for pexeest_times_censoring</p></a></li>
<li><a href='#RPEXE.RPEXT'><p>Reduced Piecewise Exponential Estimate/Test Software</p></a></li>
<li><a href='#RPEXEv1_2'><p>RPEXE main function</p></a></li>
<li><a href='#simple'><p>None Small Cell Lung cancer data</p></a></li>
<li><a href='#t100'><p>Example data for pexeest_tx</p></a></li>
<li><a href='#totaltest'><p>total time on test</p></a></li>
<li><a href='#umbrella'><p>Umbrella alternative.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Reduced Piecewise Exponential Estimate/Test Software</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Gang Han [aut, cre],
  Yu Zhang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gang Han &lt;hangang.true@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hangangtrue/RPEXE.RPEXT">https://github.com/hangangtrue/RPEXE.RPEXT</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hangangtrue/RPEXE.RPEXT/issues">https://github.com/hangangtrue/RPEXE.RPEXT/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>This reduced piecewise exponential survival software implements the likelihood ratio test and backward elimination procedure in Han, Schell, and Kim (2012 &lt;<a href="https://doi.org/10.1080%2F19466315.2012.698945">doi:10.1080/19466315.2012.698945</a>&gt;, 2014 &lt;<a href="https://doi.org/10.1002%2Fsim.5915">doi:10.1002/sim.5915</a>&gt;), and Han et al. (2016 &lt;<a href="https://doi.org/10.1111%2Fbiom.12590">doi:10.1111/biom.12590</a>&gt;). Inputs to the program can be either times when events/censoring occur or the vectors of total time on test and the number of events. Outputs of the programs are times and the corresponding p-values in the backward elimination. Details about the model and implementation are given in Han et al. 2014. This program can run in R version 3.2.2 and above.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-21 00:02:40 UTC; Guo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-21 06:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='bisec'>Bisection algorithm in Beta distribution</h2><span id='topic+bisec'></span>

<h3>Description</h3>

<p>Running bisection algorithm to search for a2, the minimizer of (log((a2)^dea1*(1-a2)^dea2-delta))^2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bisec(delta, dea1, dea2, upbd, lowbd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bisec_+3A_delta">delta</code></td>
<td>
<p>Test statistic in Han et al. (2012), 
delta = (ttot1/(ttot1+ttot2))^dea1*(ttot2/(ttot1+ttot2))^dea2;</p>
</td></tr>
<tr><td><code id="bisec_+3A_dea1">dea1</code></td>
<td>
<p>first parameter in Beta distribution (number of events from the first arm)</p>
</td></tr>
<tr><td><code id="bisec_+3A_dea2">dea2</code></td>
<td>
<p>second parameter in Beta distribution (number of events from the second arm)</p>
</td></tr>
<tr><td><code id="bisec_+3A_upbd">upbd</code></td>
<td>
<p>upper bound of a2</p>
</td></tr>
<tr><td><code id="bisec_+3A_lowbd">lowbd</code></td>
<td>
<p>lower bound of a2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a2
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bisec(-74.4824, 33, 98, 1, 0.252)
</code></pre>

<hr>
<h2 id='data2'>RPEXE_fitting</h2><span id='topic+data2'></span>

<h3>Description</h3>

<p>A breast cancer clinical trial dataset in Adelson et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data2)
</code></pre>


<h3>Details</h3>


<ul>
<li><p> first column - times : time to event
</p>
</li>
<li><p> second column - censor : censoring status; 0=censored, 1=event.
</p>
</li>
<li><p> third column - group : labels the single agent arm and combination arm
</p>
</li></ul>



<h3>References</h3>

<p>[1] Adelson, K. B., Ramaswamy, B., Sparano, J. A., Christos, P. J., Wright, J. J., Raptis, G., Han, G., Villalona-Calero, M., Ma, C., Hershman, D., Baar, J., Klein, P., Cigler, T., Budd, T., Novik, Y., Tan, A.R., Tannenbaum, S., Goel, A., Levine, E., Shapiro, C. L., Andreopoulou, E., Naughton, M., Kalinsky, K., Waxman, S., Germain, D. (2016) “Randomized Phase II Trial of Fulvestrant Alone or in Combination with Bortezomib in Hormone Receptor-Positive Metastatic Breast Cancer Resistant to Aromatase Inhibitors: A New York Cancer Consortium Trial,&quot; Nature Partner Journals Breast Cancer, Volume 2, Article ID 16037, DOI: 10.1038/npjbcancer.2016.37.
</p>

<hr>
<h2 id='df'>JAMA Breast cancer</h2><span id='topic+df'></span>

<h3>Description</h3>

<p>A dataset containing predictions for chemo-censitivity and pathological response 
from Hatzis (2011)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(df)
</code></pre>


<h3>Details</h3>


<ul>
<li><p> validate: Validation status
</p>
</li>
<li><p> drfs: Censoring status; 0=censored, 1=event.
</p>
</li>
<li><p> drfs.time: Time to event or censoring
</p>
</li>
<li><p> er.status: ER status, P=positive, N=negative
</p>
</li>
<li><p> chemo.pred: Prediction for chemo sensitivity from the ACES predictor, sensitive or insensitive
</p>
</li>
<li><p> pre.N: Prediction of nodal status
</p>
</li>
<li><p> pCR.RD: pathological complete response (pCR) or residual disease (RD) 
</p>
</li>
<li><p> pre.grade: prediction of tumor grade
</p>
</li>
<li><p> pre.T: T stage prediction
</p>
</li>
<li><p> dlda30: DLDA30 prediction for the pathological response.
</p>
</li></ul>



<h3>References</h3>

<p>[1] Hatzis, C., Pusztai, L., Valero, V., Booser, D. J., Esserman, L., Lluch, A., et al. (2011). A genomic predictor of response and survival following taxane-anthracycline chemotherapy for invasive breast cancer. The Journal of the American Medical Association 305, 1873–1881.
</p>

<hr>
<h2 id='exact_pvalue'>P-value for the two exponential comparison in Han et al.(2012)</h2><span id='topic+exact_pvalue'></span>

<h3>Description</h3>

<p>This function computes the exact p-value from the likelihood ratio test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exact_pvalue(ttot1,ttot2,dea1,dea2,mono)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exact_pvalue_+3A_ttot1">ttot1</code></td>
<td>
<p>total time on test 1</p>
</td></tr>
<tr><td><code id="exact_pvalue_+3A_ttot2">ttot2</code></td>
<td>
<p>total time on test 2</p>
</td></tr>
<tr><td><code id="exact_pvalue_+3A_dea1">dea1</code></td>
<td>
<p>number of death 1</p>
</td></tr>
<tr><td><code id="exact_pvalue_+3A_dea2">dea2</code></td>
<td>
<p>number of death 2</p>
</td></tr>
<tr><td><code id="exact_pvalue_+3A_mono">mono</code></td>
<td>
<p>0: 2-sided hypothesis: H0: lam1 is equal to lam2; H1: lam1 is not equal to lam2
1: 1-sided hypothesis: H0: lam1 is greater than or equal to lam2; H1: lam1 is less than lam2
2: 1-sided hypothesis: H0: lam1 is less than or equal to lam2; H1: lam1 is greater than lam2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a2: Beta distribution quantile computed using bisec.R
pval: p-value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exact_pvalue(1, 302.04, 2, 25, 1)
</code></pre>

<hr>
<h2 id='gamllik'>Log likelihood from the gamma distribution</h2><span id='topic+gamllik'></span>

<h3>Description</h3>

<p>A function computing the log likelihood from the gamma distribution under an order restriction reduction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamllik(structtime,structttot,structdeaths,time_die,ttot,deaths)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gamllik_+3A_structtime">structtime</code></td>
<td>
<p>change-point times to be used to compute the likelihood value</p>
</td></tr>
<tr><td><code id="gamllik_+3A_structttot">structttot</code></td>
<td>
<p>total time on test (ttot) between each time point and the previous time point (or 0) corresponding to structtime</p>
</td></tr>
<tr><td><code id="gamllik_+3A_structdeaths">structdeaths</code></td>
<td>
<p>number of deaths corresponding to structttot</p>
</td></tr>
<tr><td><code id="gamllik_+3A_time_die">time_die</code></td>
<td>
<p>all event and censoring times from small to large</p>
</td></tr>
<tr><td><code id="gamllik_+3A_ttot">ttot</code></td>
<td>
<p>total time on test corresponding to time_die</p>
</td></tr>
<tr><td><code id="gamllik_+3A_deaths">deaths</code></td>
<td>
<p>the number of deaths corresponding to &quot;ttot&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>log of the likelihood
</p>


<h3>Examples</h3>

<pre><code class='language-R'>time_die &lt;- c(0.05,0.08,0.38,0.41,0.64)
ttot &lt;- c(9.2,5.8,52.1,5.8,40.0)
deaths &lt;- c(1,1,1,1,1)
structtime &lt;- c(0.05,0.64)
structttot &lt;- c(9.2, 40.0)
structdeaths = c(1, 5)
gamllik(structtime,structttot,structdeaths,time_die,ttot,deaths)
</code></pre>

<hr>
<h2 id='km'>Kaplan-Meier curve</h2><span id='topic+km'></span>

<h3>Description</h3>

<p>This function plots the Kaplan-Meier curve without returning outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km(time, censor, plotcens)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="km_+3A_time">time</code></td>
<td>
<p>a vector of event or censoring time</p>
</td></tr>
<tr><td><code id="km_+3A_censor">censor</code></td>
<td>
<p>a vector indicating censoring: 0 = censored; 1 = uncensored</p>
</td></tr>
<tr><td><code id="km_+3A_plotcens">plotcens</code></td>
<td>
<p>0: don't add censored data symbol to the output curve
1: add censored data symbol to the output curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Kaplan-Meier curve only
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
km(t1,c1,0)

</code></pre>

<hr>
<h2 id='km_blacksolid'>Kaplan-Meier curve</h2><span id='topic+km_blacksolid'></span>

<h3>Description</h3>

<p>This function plots the Kaplan-Meier curve without returning outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km_blacksolid(time, censor, plotcens)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="km_blacksolid_+3A_time">time</code></td>
<td>
<p>a vector of event or censoring time</p>
</td></tr>
<tr><td><code id="km_blacksolid_+3A_censor">censor</code></td>
<td>
<p>a vector indicating censoring: 0 = censored; 1 = uncensored</p>
</td></tr>
<tr><td><code id="km_blacksolid_+3A_plotcens">plotcens</code></td>
<td>
<p>0: don't add censored data symbol to the output curve
1: add censored data symbol to the output curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Kaplan-Meier curve only
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
km_blacksolid(t1,c1,0)

</code></pre>

<hr>
<h2 id='km_combine'>Comparing two Kaplan Meier curves in one plot</h2><span id='topic+km_combine'></span>

<h3>Description</h3>

<p>The function compares two Kaplan Meier curves in one plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km_combine(x1, x2, pos = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="km_combine_+3A_x1">x1</code></td>
<td>
<p>Nx2 data matrix,first columen represents survival time of the i-th subject, second column represents censored flag (0 if not censored, 1 if censored)</p>
</td></tr>
<tr><td><code id="km_combine_+3A_x2">x2</code></td>
<td>
<p>Nx2 data matrix,first columen represents survival time of the i-th subject, second column represents censored flag (0 if not censored, 1 if censored)</p>
</td></tr>
<tr><td><code id="km_combine_+3A_pos">pos</code></td>
<td>
<p>The position of the legend. Can be 0 or 1. The legend will be 
on the topright if set to 0. The legend will be on the bottomleft if set to 1. Default is 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A combined Kaplan Meier curve
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
t2 &lt;- c(1,3,5,4,8,10,9,11)
c2 &lt;- c(0,0,0,0,1,0,0,0)
x1&lt;-cbind(t1,c1)
x2&lt;-cbind(t2,c2)
km_combine(x1,x2)
km_combine(x1,x2,pos=1)
</code></pre>

<hr>
<h2 id='km_log'>Plot a Kaplan Meier curve in log scale</h2><span id='topic+km_log'></span>

<h3>Description</h3>

<p>The function plots a Kaplan Meier curve in log scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km_log(time, censor, plotcens)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="km_log_+3A_time">time</code></td>
<td>
<p>time of observed event</p>
</td></tr>
<tr><td><code id="km_log_+3A_censor">censor</code></td>
<td>
<p>a vector indicating censored or not at the given times, 0 = censored; 1 = uncensored</p>
</td></tr>
<tr><td><code id="km_log_+3A_plotcens">plotcens</code></td>
<td>
<p>0: add censored data to the output curve
</p>
<p>1: don't add censored data to the output curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Kaplan Meier curve in log scale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
km_log(t1,c1,0)
</code></pre>

<hr>
<h2 id='km_red'>Plot a Kaplan Meier curve in red</h2><span id='topic+km_red'></span>

<h3>Description</h3>

<p>The function plots a Kaplan Meier curve in red
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km_red(time, censor, plotcens)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="km_red_+3A_time">time</code></td>
<td>
<p>time of observed event</p>
</td></tr>
<tr><td><code id="km_red_+3A_censor">censor</code></td>
<td>
<p>a vector indicating censored or not at the given times, 0 = censored; 1 = uncensored</p>
</td></tr>
<tr><td><code id="km_red_+3A_plotcens">plotcens</code></td>
<td>
<p>0: add censored data to the output curve
</p>
<p>1: don't add censored data to the output curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A red Kaplan Meier curve
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
km_red(t1,c1,0)
</code></pre>

<hr>
<h2 id='km_redsolid'>Plot a Kaplan Meier curve in red solid line</h2><span id='topic+km_redsolid'></span>

<h3>Description</h3>

<p>The function plots a Kaplan Meier curve in red solid line
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km_redsolid(time, censor, plotcens)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="km_redsolid_+3A_time">time</code></td>
<td>
<p>time of observed event</p>
</td></tr>
<tr><td><code id="km_redsolid_+3A_censor">censor</code></td>
<td>
<p>a vector indicating censored or not at the given times, 0 = censored; 1 = uncensored</p>
</td></tr>
<tr><td><code id="km_redsolid_+3A_plotcens">plotcens</code></td>
<td>
<p>0: add censored data to the output curve
</p>
<p>1: don't add censored data to the output curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A red solid Kaplan Meier curve
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
km_redsolid(t1,c1,0)
</code></pre>

<hr>
<h2 id='kmvalue'>Obtain values for Kaplan-Meier plotting</h2><span id='topic+kmvalue'></span>

<h3>Description</h3>

<p>Obtain values for Kaplan-Meier plotting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmvalue(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kmvalue_+3A_x">x</code></td>
<td>
<p>Nx2 data matrix,first columen represents survival time of the i-th subject, second column represents censored flag (0 if not censored, 1 if censored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Values used for Kaplan-Meier plotting
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
x1&lt;-cbind(t1,c1)
kmvalue(x1)
</code></pre>

<hr>
<h2 id='loopcut_onestep_data'>Example data for loopcut_onestep</h2><span id='topic+loopcut_onestep_data'></span>

<h3>Description</h3>

<p>Example data for loopcut_onestep
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(loopcut_onestep_data)
</code></pre>

<hr>
<h2 id='loopcuts'>Change-point p-values with backward elimination</h2><span id='topic+loopcuts'></span>

<h3>Description</h3>

<p>A function that iterates to compute the p-values from the backward elimination procedure (Han et al. 2014)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loopcuts(time,censor,cuttimes,mono)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loopcuts_+3A_time">time</code></td>
<td>
<p>a sequence of time</p>
</td></tr>
<tr><td><code id="loopcuts_+3A_censor">censor</code></td>
<td>
<p>a vector indicating censored or not at the given times, 0 = censored; 1 = uncensored</p>
</td></tr>
<tr><td><code id="loopcuts_+3A_cuttimes">cuttimes</code></td>
<td>
<p>unique, sorted, possible times to make the cuts, including 0 and the ending time</p>
</td></tr>
<tr><td><code id="loopcuts_+3A_mono">mono</code></td>
<td>
<p>0: 2-sided hypothesis: H0: lam1 is equal to lam2; H1: lam1 is not equal to lam2
1: 1-sided hypothesis: H0: lam1 is greater than or equal to lam2; H1: lam1 is less than lam2
2: 1-sided hypothesis: H0: lam1 is less than or equal to lam2; H1: lam1 is greater than lam2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the times in the backward elimination procedure and the corresponding p-values for each change-point in the iteration
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(loopcuts_t_c)
data(loopcuts_cut)
time = loopcuts_t_c[,1]
censor = loopcuts_t_c[,2]
loopcuts(time, censor, loopcuts_cut, 1)
</code></pre>

<hr>
<h2 id='loopcuts_cut'>Example data for loopcuts_cuttimes</h2><span id='topic+loopcuts_cut'></span>

<h3>Description</h3>

<p>Example data for loopcuts_cuttimes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(loopcuts_cut)
</code></pre>

<hr>
<h2 id='loopcuts_onestep'>Change-point p-values at given time points</h2><span id='topic+loopcuts_onestep'></span>

<h3>Description</h3>

<p>This function computes the p-values at the current time points in input &quot;time&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loopcuts_onestep(time,censor,cuttimes,mono)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loopcuts_onestep_+3A_time">time</code></td>
<td>
<p>a sequence of time</p>
</td></tr>
<tr><td><code id="loopcuts_onestep_+3A_censor">censor</code></td>
<td>
<p>a vector indicating censored or not at the given times, 0 = censored; 1 = uncensored</p>
</td></tr>
<tr><td><code id="loopcuts_onestep_+3A_cuttimes">cuttimes</code></td>
<td>
<p>unique, sorted, possible times to make the cuts, including 0 and the ending time</p>
</td></tr>
<tr><td><code id="loopcuts_onestep_+3A_mono">mono</code></td>
<td>
<p>0: 2-sided hypothesis: H0: lam1 is equal to lam2; H1: lam1 is not equal to lam2
1: 1-sided hypothesis: H0: lam1 is greater than or equal to lam2; H1: lam1 is less than lam2
2: 1-sided hypothesis: H0: lam1 is less than or equal to lam2; H1: lam1 is greater than lam2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>P-values at for all time points in &quot;time&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(loopcuts_t_c)
time = loopcuts_t_c[,1]
censor = loopcuts_t_c[,2]
loopcuts_onestep(time, censor, 28.03013699, 1)

</code></pre>

<hr>
<h2 id='loopcuts_t_c'>Example data for loopcut_times_censoring</h2><span id='topic+loopcuts_t_c'></span>

<h3>Description</h3>

<p>Example data for loopcut_times_censoring
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(loopcuts_t_c)
</code></pre>

<hr>
<h2 id='loopcuts_umbrella'>Change-point p-values with backward elimination under umbrella alternative order restriction</h2><span id='topic+loopcuts_umbrella'></span>

<h3>Description</h3>

<p>A function that iterates to compute the p-values from the backward elimination procedure (Han et al. 2014) with umbrella alternative order restriction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loopcuts_umbrella(time,censor,cuttimes,mono)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loopcuts_umbrella_+3A_time">time</code></td>
<td>
<p>a sequence of time</p>
</td></tr>
<tr><td><code id="loopcuts_umbrella_+3A_censor">censor</code></td>
<td>
<p>a vector indicating censored or not at the given times, 0 = censored; 1 = uncensored</p>
</td></tr>
<tr><td><code id="loopcuts_umbrella_+3A_cuttimes">cuttimes</code></td>
<td>
<p>unique, sorted, possible times to make the cuts, including 0 and the ending time</p>
</td></tr>
<tr><td><code id="loopcuts_umbrella_+3A_mono">mono</code></td>
<td>
<p>0: 2-sided hypothesis: H0: lam1 is equal to lam2; H1: lam1 is not equal to lam2
1: 1-sided hypothesis: H0: lam1 is greater than or equal to lam2; H1: lam1 is less than lam2
2: 1-sided hypothesis: H0: lam1 is less than or equal to lam2; H1: lam1 is greater than lam2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the times in the backward elimination procedure and the corresponding p-values for each change-point in the iteration
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(loopcuts_t_c)
data(loopcuts_umbrella_cuttimes_mono)
time = loopcuts_t_c[,1]
censor = loopcuts_t_c[,2]
cuttimes = loopcuts_umbrella_cuttimes_mono[,1]
mono = loopcuts_umbrella_cuttimes_mono[,2]
loopcuts_umbrella(time, censor, cuttimes, mono)
</code></pre>

<hr>
<h2 id='loopcuts_umbrella_cuttimes_mono'>Example data for loopcut_umbrella</h2><span id='topic+loopcuts_umbrella_cuttimes_mono'></span>

<h3>Description</h3>

<p>Example data for loopcut_umbrella
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(loopcuts_umbrella_cuttimes_mono)
</code></pre>

<hr>
<h2 id='pava_dfr'>PAVA order restriction under decreasing failure rate (DFR)</h2><span id='topic+pava_dfr'></span>

<h3>Description</h3>

<p>This function imposes the PAVA DFR order restriction by eliminating change-points violating the restriction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pava_dfr(time_die,ttot,deaths)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pava_dfr_+3A_time_die">time_die</code></td>
<td>
<p>event times</p>
</td></tr>
<tr><td><code id="pava_dfr_+3A_ttot">ttot</code></td>
<td>
<p>the total time on test (ttot) corresponding to the event times</p>
</td></tr>
<tr><td><code id="pava_dfr_+3A_deaths">deaths</code></td>
<td>
<p>the number of deaths at each event time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>time2: the event times after PAVA
ttot2: the corresponding ttot
deaths2 the corresponding number of deaths
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pava_dfrd)
t_d = pava_dfrd[,1]
t = pava_dfrd[,2]
d = pava_dfrd[,3]
pava_dfr(t_d, t, d)
</code></pre>

<hr>
<h2 id='pava_dfrd'>Example data for pava</h2><span id='topic+pava_dfrd'></span>

<h3>Description</h3>

<p>Example data for pava
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pava_dfrd)
</code></pre>

<hr>
<h2 id='pava_ifr'>PAVA order restriction under increasing failure rate (IFR)</h2><span id='topic+pava_ifr'></span>

<h3>Description</h3>

<p>This function imposes the PAVA IFR order restriction by 
eliminating change-points violating the restriction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pava_ifr(time_die,ttot,deaths)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pava_ifr_+3A_time_die">time_die</code></td>
<td>
<p>event times</p>
</td></tr>
<tr><td><code id="pava_ifr_+3A_ttot">ttot</code></td>
<td>
<p>the total time on test (ttot) corresponding to the event times</p>
</td></tr>
<tr><td><code id="pava_ifr_+3A_deaths">deaths</code></td>
<td>
<p>the number of deaths at each event time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>time2 the event times after PAVA
ttot2 the corresponding ttot after PAVA
deaths2 the corresponding number of deaths after PAVA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pava_dfrd)
t_d = pava_dfrd[,1]
t = pava_dfrd[,2]
d = pava_dfrd[,3]
pava_ifr(t_d, t, d)

</code></pre>

<hr>
<h2 id='pexeest'>RPEXE estimate given change-points</h2><span id='topic+pexeest'></span>

<h3>Description</h3>

<p>This function estimates the survival probability at tx when a piecewise 
exponential distribution is fitted to (times,cens) cens = 0 for censored, cens = 1 for uncensored.
the change point is tchange and lamest is the estimated parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pexeest(times, cens, tchange, tx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pexeest_+3A_times">times</code></td>
<td>
<p>All the event/censoring times used to fit the model</p>
</td></tr>
<tr><td><code id="pexeest_+3A_cens">cens</code></td>
<td>
<p>censoring status used to fit the model</p>
</td></tr>
<tr><td><code id="pexeest_+3A_tchange">tchange</code></td>
<td>
<p>Change-points</p>
</td></tr>
<tr><td><code id="pexeest_+3A_tx">tx</code></td>
<td>
<p>Time points to estimate the survival probability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>quan survival probability
lamest Lambda estimates for time periods divided by the change-points
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pexeest_times_censoring)
data(t100)
times = pexeest_times_censoring[,1]
cens = pexeest_times_censoring[,2]
pexeest(times, cens, 28.03014, t100)

</code></pre>

<hr>
<h2 id='pexeest_times_censoring'>Example data for pexeest_times_censoring</h2><span id='topic+pexeest_times_censoring'></span>

<h3>Description</h3>

<p>Example data for pexeest_times_censoring
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pexeest_times_censoring)
</code></pre>

<hr>
<h2 id='RPEXE.RPEXT'>Reduced Piecewise Exponential Estimate/Test Software</h2><span id='topic+RPEXE.RPEXT'></span>

<h3>Description</h3>

<p>This reduced piecewise exponential survival software implements the likelihood ratio test 
and backward elimination procedure in Han, Schell, and Kim (2012, 2014), and Han et al. (2016). Inputs 
to the program can be either times when events/censoring 
occur or the vectors of total time on test and the number of events. Outputs of the programs are times 
and the corresponding p-values in the backward elimination. 
Details about the model and implementation are given in Han et al. 2014. 
This program can run in R version 3.2.2 and above.
</p>


<h3>References</h3>

<p>[1] Han, G., Schell, M. J., and Kim, J. (2012) “Comparing Two Exponential Distributions Using the Exact Likelihood Ratio Test,&quot; Statistics in Biopharmaceutical Research, 4(4), 348-356.
</p>
<p>[2] Han, G., Schell, M. J., and Kim, J. (2014) “Improved Survival Modeling in Cancer Research Using a Reduced Piecewise Exponential Approach,&quot; Statistics in Medicine, 33(1), 59-73.
</p>
<p>[3] Han, G., Schell, M., Zhang, H., Zelterman, D., Pusztai, L., Adelson, K., and Hatzis, C. (2016) “Testing Violations of the Exponential Assumption in Cancer Clinical Trials with Survival Endpoints,&quot; Biometrics, DOI: 10.1111/biom.12590; PMID: 27669414.
</p>
<p>[4] Adelson, K. B., Ramaswamy, B., Sparano, J. A., Christos, P. J., Wright, J. J., Raptis, G., Han, G., Villalona-Calero, M., Ma, C., Hershman, D., Baar, J., Klein, P., Cigler, T., Budd, T., Novik, Y., Tan, A.R., Tannenbaum, S., Goel, A., Levine, E., Shapiro, C. L., Andreopoulou, E., Naughton, M., Kalinsky, K., Waxman, S., Germain, D. (2016) “Randomized Phase II Trial of Fulvestrant Alone or in Combination with Bortezomib in Hormone Receptor-Positive Metastatic Breast Cancer Resistant to Aromatase Inhibitors: A New York Cancer Consortium Trial,&quot; Nature Partner Journals Breast Cancer, Volume 2, Article ID 16037, DOI: 10.1038/npjbcancer.2016.37.
</p>
<p>[5] Simon GR, Extermann M, Chiappori A, Williams C, Begum M, Haura RKE, Ismail-Khan R, Schell M, Antonia SJ, Bepler G. Phase 2 trial of docetaxel and gefitinib in the first-line treatment of patients with advanced stage non-small cell lung cancer (NSCLC) who are 70 years of age or older. Cancer 2008; 112:2021–2029.
</p>
<p>[6] Hatzis, C., Pusztai, L., Valero, V., Booser, D. J., Esserman, L., Lluch, A., et al. (2011). A genomic predictor of response and survival following taxane-anthracycline chemotherapy for invasive breast cancer. The Journal of the American Medical Association 305, 1873–1881.
</p>

<hr>
<h2 id='RPEXEv1_2'>RPEXE main function</h2><span id='topic+RPEXEv1_2'></span>

<h3>Description</h3>

<p>This is the RPEXE main function taking inputs including time, censoring, 
change-point candidates, order restriction, criticl value, and display position. This function 
produces the RPEXE estimate. The prediction of the survival probability will be made on 100 equally
spaced time points within the range of the event times based on the piecewise exponential 
estimate determined by all the changepoints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RPEXEv1_2(times,censoring,cuttimes=NULL, monotone=0, criticalp=-1, pos = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RPEXEv1_2_+3A_times">times</code></td>
<td>
<p>A sequence of times where the events occur</p>
</td></tr>
<tr><td><code id="RPEXEv1_2_+3A_censoring">censoring</code></td>
<td>
<p>A sequence of dichotomous values indicating censored or not (0=censored and 1=not censored)</p>
</td></tr>
<tr><td><code id="RPEXEv1_2_+3A_cuttimes">cuttimes</code></td>
<td>
<p>A vector of unique, sorted, possible times to make the cuts. When it's set to NULL, it's the Default value, 
which is sorted event times from small to large.</p>
</td></tr>
<tr><td><code id="RPEXEv1_2_+3A_monotone">monotone</code></td>
<td>
<p>An input having indicating the monotonicity assumption
&ndash; 0: no monotonic assumption (default)
&ndash; 1: failure rate is decreasing over time
&ndash; 2: failure rate is increasing over time
&ndash; 3: monotonic failure rate
&ndash; 4: failure rate is increasing and then decreasing
&ndash; 5: failure rate is decreasing and then increasing
&ndash; 6: failure rate is increasing and then decreasing with
the peak removed first
&ndash; 7: failure rate is decreasing and then increasing with
the peak removed first</p>
</td></tr>
<tr><td><code id="RPEXEv1_2_+3A_criticalp">criticalp</code></td>
<td>
<p>The critical (naive) p-value cutoff where all p-values 
in the backward elimination that are lower than this 
will be regarded as being significant. For example, at type I error rate 0.05, 
the critical p-value was 0.004 in the real example of Han et al. (2014).
Default == -1 (equivalent to NA).</p>
</td></tr>
<tr><td><code id="RPEXEv1_2_+3A_pos">pos</code></td>
<td>
<p>The position of the legend. Can be 0 or 1. The legend will be 
on the topright if set to 0. The legend will be on the bottomleft if set to 1. Default is 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>times: event/censoring times taking out from the backward elimination
pvalues: p-values corresponding to &quot;times&quot; 
times_c: significant change-points
pvalues_c: critical p-values that are smaller than the critical p-value 
trend: trend information
struct:  structure information for multiple order restrictions
changet:  change-point time of trend for umbrella alternatives.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
RPEXEv1_2(t1, c1, monotone = 1,criticalp=0.05, pos = 0)
</code></pre>

<hr>
<h2 id='simple'>None Small Cell Lung cancer data</h2><span id='topic+simple'></span>

<h3>Description</h3>

<p>A dataset non-small-cell lung cancer trial data from Simon et al. (2011)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simple)
</code></pre>


<h3>Details</h3>


<ul>
<li><p> first column - censor : censoring status; 0=censored, 1=event.
</p>
</li>
<li><p> second column - times : time to event
</p>
</li></ul>



<h3>References</h3>

<p>[1] Simon GR, Extermann M, Chiappori A, Williams C, Begum M, Haura RKE, Ismail-Khan R, Schell M, Antonia SJ, Bepler G. Phase 2 trial of docetaxel and gefitinib in the first-line treatment of patients with advanced stage non-small cell lung cancer (NSCLC) who are 70 years of age or older. Cancer 2008; 112:2021–2029.
</p>

<hr>
<h2 id='t100'>Example data for pexeest_tx</h2><span id='topic+t100'></span>

<h3>Description</h3>

<p>Example data for pexeest_tx
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(t100)
</code></pre>

<hr>
<h2 id='totaltest'>total time on test</h2><span id='topic+totaltest'></span>

<h3>Description</h3>

<p>Function 'totaltest' computes total-time-on-test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>totaltest(time,censor)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="totaltest_+3A_time">time</code></td>
<td>
<p>event/censoring times</p>
</td></tr>
<tr><td><code id="totaltest_+3A_censor">censor</code></td>
<td>
<p>censoring status</p>
</td></tr>
</table>


<h3>Value</h3>

<p>time_die time points where events occur (in ascending order)
ttot total time on test corresponding to each time point in &quot;time_die&quot;
deaths number of death corresponding to each time point in &quot;time_die&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1 &lt;- c(2,3,4,5.5,7,10,12,15)
c1 &lt;- c(0,0,1,0,0,1,0,0)
totaltest(t1,c1)
</code></pre>

<hr>
<h2 id='umbrella'>Umbrella alternative.</h2><span id='topic+umbrella'></span>

<h3>Description</h3>

<p>Using the umbrella alternative to merge certain entries to make 
the sequence of ttot/deaths to increase then decrease or to decrease then increase. 
Note that the pava function imposes non-decreasing or non-increasing order. 
This function directly uses function pava().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>umbrella(time_die,ttot,deaths,indi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="umbrella_+3A_time_die">time_die</code></td>
<td>
<p>a sequence of times where deaths happened.</p>
</td></tr>
<tr><td><code id="umbrella_+3A_ttot">ttot</code></td>
<td>
<p>the total time on test between each time point
and the previous time point (or 0).</p>
</td></tr>
<tr><td><code id="umbrella_+3A_deaths">deaths</code></td>
<td>
<p>the number of deaths at each time point.</p>
</td></tr>
<tr><td><code id="umbrella_+3A_indi">indi</code></td>
<td>
<p>an indicator
indi == 0: monotonic failure rate (either decrease or increase)
indi == 1: denoting the failure rate increase then decrease
indi == 2: denoting the failure rate decrease then increase</p>
</td></tr>
</table>


<h3>Value</h3>

<p>time2  == the merged time_die after the umbrealla alternative order restriction;
struct  == a structure saves the partition information;
label  == a note about how the failure rate varies;
indx   == the position where the change point value is.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pava_dfrd)
t_d = pava_dfrd[,1]
t = pava_dfrd[,2]
d = pava_dfrd[,3]
umbrella(t_d, t, d, 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
