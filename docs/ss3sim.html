<!DOCTYPE html><html lang="en"><head><title>Help for package ss3sim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ss3sim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ss3sim'><p>ss3sim: Fisheries stock assessment simulation testing with Stock Synthesis</p></a></li>
<li><a href='#add_colnames'><p>Create matching column names across a list of data frames</p></a></li>
<li><a href='#add_CPUE'><p>Add a q setup line into an SS control file</p></a></li>
<li><a href='#add_nulls'><p>Add <code>NULL</code> values to non-existent list elements</p></a></li>
<li><a href='#add_tv_parlines'><p>Add short time varying parameter lines. At time of writing, this method will</p>
work for MG, selectivity, and catchability time varying, but not for SR</a></li>
<li><a href='#calculate_data_units'><p>Given sampling arguments, calculate super set of fleets, years, and data</p>
types.</a></li>
<li><a href='#calculate_re'><p>Calculate relative error</p></a></li>
<li><a href='#case_comp'><p>Write a case file for length- or age-composition data</p></a></li>
<li><a href='#case_deparse'><p>Turn an argument describing an object into a character.</p></a></li>
<li><a href='#case_fishing'><p>Write a case file for fishing data to the disk.</p></a></li>
<li><a href='#case_index'><p>Write a case file for index data to the disk.</p></a></li>
<li><a href='#case_tv'><p>Write time varying casefiles to the disk</p></a></li>
<li><a href='#change_data'><p>Change the data that is available as output from an SS operating model.</p></a></li>
<li><a href='#change_e'><p>Methods to alter which parameters are estimated in a SS3 <code>.ctl</code> file.</p></a></li>
<li><a href='#change_e_fcast_yrs'><p>Check and change forecast file years if necessary</p></a></li>
<li><a href='#change_em_binning'><p>Change population and observed length composition bins in an SS estimation</p>
model</a></li>
<li><a href='#change_f'><p>Alter fishing mortality (<em>F</em>) using the SS control file</p></a></li>
<li><a href='#change_f_par'><p>Alter the fishing mortality (<em>F</em>) values in an SS3 <code>.par</code> file.</p></a></li>
<li><a href='#change_lcomp_constant'><p>Set the robustification constant for length composition data.</p></a></li>
<li><a href='#change_o'><p>Methods to include parameters in an SS3operating model</p></a></li>
<li><a href='#change_pop_bin'><p>Set up population length bin structure</p></a></li>
<li><a href='#change_rec_devs'><p>Replace recruitment deviations</p></a></li>
<li><a href='#change_rec_devs_par'><p>Replace recruitment deviations</p></a></li>
<li><a href='#change_retro'><p>Alter a starter file for a retrospective analysis</p></a></li>
<li><a href='#change_tail_compression'><p>Replace tail compression value for length composition data.</p></a></li>
<li><a href='#change_tv'><p>Methods to include time-varying parameters in an SS3 operating model</p></a></li>
<li><a href='#check_data'><p>Check that the SS data file looks correct</p></a></li>
<li><a href='#check_data_str_range'><p>Check input arguments for data</p></a></li>
<li><a href='#clean_data'><p>Given sampling arguments remove (&quot;clean&quot;) all data in a .dat file that</p>
is not specified</a></li>
<li><a href='#cleanup_ss3'><p>Clean up after an SS3 run</p></a></li>
<li><a href='#copy_ss3models'><p>Copy the operating and estimation models and create a folder</p>
structure</a></li>
<li><a href='#create_argfiles'><p>Create template argument input files</p></a></li>
<li><a href='#expand_scenarios'><p>Create vectors of scenario IDs</p></a></li>
<li><a href='#facet_form'><p>A helper function for building a ggplot facet. Used internally by the</p>
plotting functions.</a></li>
<li><a href='#fill_across'><p>Fill in matrix across rows of weight-at-age data by interpolation</p></a></li>
<li><a href='#get_args'><p>Take a csv file, read it, and turn the first column into the list</p>
names and the second column into the list values.</a></li>
<li><a href='#get_bin'><p>Get SS3 binary/executable location in package</p></a></li>
<li><a href='#get_bin_info'><p>Get the parameter values for change_bin</p></a></li>
<li><a href='#get_caseargs'><p>Take a scenario ID and return argument lists</p></a></li>
<li><a href='#get_caseval'><p>Take a scenario ID and a case type and return the case number</p></a></li>
<li><a href='#get_fish600_casefolder'><p>Get the folder location of the FISH600 case files</p></a></li>
<li><a href='#get_model_folder'><p>Get the folder location of an included SS3 model configuration</p></a></li>
<li><a href='#get_nll_components'><p>Get negative log likelihood (NLL) values from a report file list</p></a></li>
<li><a href='#get_recdevs'><p>Return a set of recruitment deviations</p></a></li>
<li><a href='#get_results_all'><p>Extract SS3 simulation output</p></a></li>
<li><a href='#get_results_derived'><p>Extract time series from a model run with the associated standard deviation.</p></a></li>
<li><a href='#get_results_scalar'><p>Extract scalar quantities from a model run.</p></a></li>
<li><a href='#get_results_scenario'><p>Extract SS3 simulation results for one scenario.</p></a></li>
<li><a href='#get_results_timeseries'><p>Extract time series from a model run.</p></a></li>
<li><a href='#get_sigmar'><p>Get Variability About Recruitment Deviations (<code class="reqn">\sigma_R</code>)</p></a></li>
<li><a href='#get_ss_ver_dl'><p>Get the ss version (either 3.24 or 3.30) from a <code>dat_list</code> list.</p></a></li>
<li><a href='#get_ss_ver_file'><p>Get the ss version (either 3.24 or 3.30) from an ss file</p></a></li>
<li><a href='#id_scenarios'><p>Identify ss3sim scenarios within a directory</p></a></li>
<li><a href='#plot_scalar_boxplot'><p>Print scalar values as boxplots.</p></a></li>
<li><a href='#plot_scalar_points'><p>Plot scalar values as points.</p></a></li>
<li><a href='#plot_ts_boxplot'><p>Plot timeseries values as boxplots.</p></a></li>
<li><a href='#plot_ts_lines'><p>Plot timeseries values as lines.</p></a></li>
<li><a href='#plot_ts_points'><p>Plot timeseries values as points.</p></a></li>
<li><a href='#profile_fmsy'><p>Determine Fmsy for a given operating model</p></a></li>
<li><a href='#remove_CPUE'><p>Remove a q setup line into an SS control file</p></a></li>
<li><a href='#remove_q_ctl'><p>Remove a q setup line into an SS control file only</p></a></li>
<li><a href='#rename_ss3_files'><p>Rename SS3-version-specific files</p></a></li>
<li><a href='#run_ss3model'><p>Run an operating or estimation model for a specified set of scenario IDs</p></a></li>
<li><a href='#run_ss3sim'><p>Master function to run SS3 simulations</p></a></li>
<li><a href='#sample_agecomp'><p>Sample age compositions from a Stock Synthesis data file</p></a></li>
<li><a href='#sample_calcomp'><p>Sample conditional age-at-length (CAL) data and write to file for use by</p>
the EM.</a></li>
<li><a href='#sample_comp'><p>Sample composition data from expected values</p></a></li>
<li><a href='#sample_index'><p>Sample the biomass with observation error</p></a></li>
<li><a href='#sample_lcomp'><p>Sample length compositions from a Stock Synthesis data file</p></a></li>
<li><a href='#sample_mlacomp'><p>[BETA VERSION] Sample mean length (size-)-at-age data and write to file for use by the EM.</p></a></li>
<li><a href='#sample_wtatage'><p>Sample empirical weight-at-age data and write to file for use by the EM</p></a></li>
<li><a href='#sanitize_admb_options'><p>Check admb options to make sure there aren't flags there shouldn't</p>
be</a></li>
<li><a href='#scalar_dat'><p>Example scalar data from the ss3sim vignette</p></a></li>
<li><a href='#setup_parallel'><p>Setup parallel processing</p></a></li>
<li><a href='#ss3sim_base'><p>Base wrapper function to run an ss3sim simulation</p></a></li>
<li><a href='#standardize_bounds'><p>Standardize the bounds of the estimation model control file.</p></a></li>
<li><a href='#substr_r'><p>Substring from right</p></a></li>
<li><a href='#ts_dat'><p>Example time series data from the ss3sim vignette</p></a></li>
<li><a href='#vbgf_func'><p>Predict length given VBGF parameters</p></a></li>
<li><a href='#verify_input'><p>Verify and standardize SS3 input files</p></a></li>
<li><a href='#verify_plot_arguments'><p>A helper function to check the correct input for the plotting functions.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fisheries Stock Assessment Simulation Testing with Stock
Synthesis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Develops a framework for fisheries stock assessment simulation
    testing with Stock Synthesis (SS) as described in Anderson et al.
    (2014) &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0092725">doi:10.1371/journal.pone.0092725</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ss3sim/ss3sim">https://github.com/ss3sim/ss3sim</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ss3sim/ss3sim/issues">https://github.com/ss3sim/ss3sim/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, doParallel, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>foreach, r4ss (&ge; 1.35.0), gtools, ggplot2, bbmle, grDevices,
graphics, stats, utils</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-08 20:24:46 UTC; kelli</td>
</tr>
<tr>
<td>Author:</td>
<td>Kelli F. Johnson [aut, cre],
  Sean C. Anderson <a href="https://orcid.org/0000-0001-9563-1937"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Kathryn Doering [aut],
  Cole Monnahan [aut],
  Christine Stawitz [aut],
  Ian Taylor [aut],
  Curry Cunningham [ctb],
  Allan Hicks [ctb],
  Felipe Hurtado-Ferro [ctb],
  Peter Kuriyama [ctb],
  Roberto Licandeo [ctb],
  Carey McGilliard [ctb],
  Melissa Murdian [ctb],
  Kotaro Ono [ctb],
  Merrill Rudd [ctb],
  Cody Szuwalski [ctb],
  Juan Valero [ctb],
  Athol Whitten [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kelli F. Johnson &lt;kelli.johnson@noaa.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-08 22:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ss3sim'>ss3sim: Fisheries stock assessment simulation testing with Stock Synthesis</h2><span id='topic+ss3sim'></span><span id='topic+ss3sim-package'></span>

<h3>Description</h3>

<p>The <span class="pkg">ss3sim</span> <span class="rlang"><b>R</b></span> package is designed to facilitate rapid, reproducible,
and flexible simulation with the widely-used Stock Synthesis 3 (SS3)
statistical catch-at-age stock assessment framework.
</p>


<h3>Details</h3>

<p>An <span class="pkg">ss3sim</span> simulation requires three types of input: (1) a base
model of the underlying truth (an SS3 operating model), (2) a base
model of how you will assess that truth (an SS3 estimation model),
(3) and a set of cases that deviate from these base models that you
want to compare (configuration arguments provided as plain-text
cases files).
</p>
<p>You can find examples of these SS3 operating and estimation models
within the package data (<code>inst/extdata/models/</code>). The package
data also contains example plain-text control files in the folder
<code>inst/extdata/cases</code> and <code>inst/extdata/eg-cases</code>.
</p>
<p>To carry out <span class="pkg">ss3sim</span> simulations
with the version from CRAN, you will need to have SS3 installed on
your computer and the binary needs to be in the path that <span class="rlang"><b>R</b></span> sees. See the
section &quot;Installing the ss3sim R package&quot; in the vignette
<code>vignette("ss3sim-vignette")</code> for instructions on installing SS3. See
the Appendix A &quot;Putting SS3 in your path&quot; in the vignette for instructions on
making sure SS3 will work from within <span class="rlang"><b>R</b></span>.
</p>
<p>The main <span class="pkg">ss3sim</span> functions are divided into three types:
</p>
<p>1. <code>change</code> and <code>sample</code> functions that manipulate SS3
configuration files. These manipulations generate an underlying &quot;truth&quot;
(operating models) and control our assessment of those models (estimation
models).
</p>

<ul>
<li> <p><code><a href="#topic+change_f">change_f</a></code>: Controls fishing mortality.
</p>
</li>
<li> <p><code><a href="#topic+change_tv">change_tv</a></code>: Adds time-varying features. For
example, time-varying natural mortality, growth, or selectivity.
</p>
</li>
<li> <p><code><a href="#topic+sample_lcomp">sample_lcomp</a></code>: Controls how length composition
data are sampled.
</p>
</li>
<li> <p><code><a href="#topic+sample_agecomp">sample_agecomp</a></code>: Controls how age composition
data are sampled.
</p>
</li>
<li> <p><code><a href="#topic+sample_index">sample_index</a></code>: Controls how the fishery and
survey indices are sampled.
</p>
</li>
<li> <p><code><a href="#topic+change_e">change_e</a></code>: Controls which and how parameters are
estimated.
</p>
</li>
<li> <p><code><a href="#topic+change_retro">change_retro</a></code>: Controls the number of years to
discard for a retrospective analysis.
</p>
</li>
<li> <p><code><a href="#topic+change_rec_devs">change_rec_devs</a></code>: Substitutes recruitment
deviations.
</p>
</li>
<li> <p><code><a href="#topic+change_lcomp_constant">change_lcomp_constant</a></code>: Set the robustification constant
for length composition data.
</p>
</li>
<li> <p><code><a href="#topic+change_tail_compression">change_tail_compression</a></code>: Replace tail compression value
for length composition data.
</p>
</li></ul>

<p>2. <code>run</code> functions that conduct simulations. These functions
generate a folder structure, call manipulation functions, run SS3
as needed, and save the output.
</p>

<ul>
<li> <p><code><a href="#topic+run_ss3sim">run_ss3sim</a></code>: Main function to run <span class="pkg">ss3sim</span>
simulations.
</p>
</li>
<li> <p><code><a href="#topic+ss3sim_base">ss3sim_base</a></code>: Underlying base simulation
function. Can also be called directly.
</p>
</li></ul>

<p>3. <code>get</code> functions for synthesizing the output.
</p>

<ul>
<li> <p><code><a href="#topic+get_results_scenario">get_results_scenario</a></code>: Extract the results for a
single scenario.
</p>
</li>
<li> <p><code><a href="#topic+get_results_all">get_results_all</a></code>: Extract results from a series
of scenarios.
</p>
</li></ul>

<p>See the introductory vignette <code>vignette("introduction",
package = "ss3sim")</code> for
more extensive explanation of how to use the <span class="pkg">ss3sim</span> <span class="rlang"><b>R</b></span> package.
</p>
<p><span class="pkg">ss3sim</span> was developed by graduate students and post doctoral researchers
at the University of Washington (School of Aquatic and Fishery Sciences and
Quantitative Ecology and Resource Management departments) and Simon Fraser
University. The authors of individual functions are listed within the
function documentation and all contributors are listed in the
<code>DESCRIPTION</code> file.
</p>
<p>If you use <span class="pkg">ss3sim</span> in a publication, please cite the package as
indicated by running <code>citation("ss3sim")</code> in the <span class="rlang"><b>R</b></span> console.
</p>

<hr>
<h2 id='add_colnames'>Create matching column names across a list of data frames</h2><span id='topic+add_colnames'></span>

<h3>Description</h3>

<p>Add missing columns to each data frame in the list allowing
for the use <code><a href="base.html#topic+rbind">rbind</a></code> to create a single data frame.
The code is based on <code><a href="plyr.html#topic+rbind.fill">rbind.fill</a></code>, but we
didn't want to depend on that package for just one function
given it had not been updated since 2016.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_colnames(dfs, bind = FALSE, fillwith = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_colnames_+3A_dfs">dfs</code></td>
<td>
<p>A list of data frames, where the length can be one.</p>
</td></tr>
<tr><td><code id="add_colnames_+3A_bind">bind</code></td>
<td>
<p>A logical value specifying if the data frame(s)
should be returned as a single data frame. The default is
<code>FALSE</code>, which returns a list of data frames same as what
was provided in <code>dfs</code>.</p>
</td></tr>
<tr><td><code id="add_colnames_+3A_fillwith">fillwith</code></td>
<td>
<p>A single value that will be used to populate all
of the missing columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the input to <code>bind</code> you can either
return the same structure, i.e., a list of data frames, or
a data frame with all rows from each original data frame.
Missing values will be filled with the entry in <code>fillwith</code>.
</p>


<h3>Author(s)</h3>

<p>Kelli Faye Johnson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame("a" = 1:10, "b" = 21:30)
y &lt;- data.frame("a" = 11:15, "y" = letters[1:5])
alist &lt;- ss3sim:::add_colnames(list(x, y), bind = FALSE)
adataframe &lt;- ss3sim:::add_colnames(list(x, y), bind = TRUE)
# clean up
rm(x, y, alist, adataframe)

</code></pre>

<hr>
<h2 id='add_CPUE'>Add a q setup line into an SS control file</h2><span id='topic+add_CPUE'></span>

<h3>Description</h3>

<p>This function adds a q setup line to an SS 3.30 control file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_CPUE(ctl.in, ctl.out = NULL, overwrite = FALSE,
  q = data.frame(fleet = 3, link = 1, link_info = 0, extra_se = 0,
  biasadj = 0, float = 0, LO = -20, HI = 20, INIT = 0, PRIOR = 0, PR_SD =
  99, PR_type = 0, PHASE = 1, env_var = 0, use_dev = 0, dev_mnyr = 0,
  dev_mxyr = 0, dev_PH = 0, Block = 0, Blk_Fxn = 0, name = NULL))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_CPUE_+3A_ctl.in">ctl.in</code></td>
<td>
<p>An SS control file name to read in.</p>
</td></tr>
<tr><td><code id="add_CPUE_+3A_ctl.out">ctl.out</code></td>
<td>
<p>The SS control file to read out.</p>
</td></tr>
<tr><td><code id="add_CPUE_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. Overwrite an existing file with the same name as
<code>ctl.out</code>?</p>
</td></tr>
<tr><td><code id="add_CPUE_+3A_q">q</code></td>
<td>
<p>a dataframe containing the q parameter lines to add.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified SS control file.
</p>


<h3>Author(s)</h3>

<p>Kelli Johnson
</p>

<hr>
<h2 id='add_nulls'>Add <code>NULL</code> values to non-existent list elements</h2><span id='topic+add_nulls'></span>

<h3>Description</h3>

<p>Add <code>NULL</code> values to non-existent list elements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_nulls(param_list, desired_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_nulls_+3A_param_list">param_list</code></td>
<td>
<p>A list in which the names correspond to parameter names
and the values correspond to the values to be passed.</p>
</td></tr>
<tr><td><code id="add_nulls_+3A_desired_params">desired_params</code></td>
<td>
<p>A character vector of desired list elements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the desired elements as described by the
<code>desired_params</code> argument. Any values that were missing in
<code>param_list</code> will be returned with values of <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Sean C. Anderson
</p>

<hr>
<h2 id='add_tv_parlines'>Add short time varying parameter lines. At time of writing, this method will
work for MG, selectivity, and catchability time varying, but not for SR</h2><span id='topic+add_tv_parlines'></span>

<h3>Description</h3>

<p>Add short time varying parameter lines. At time of writing, this method will
work for MG, selectivity, and catchability time varying, but not for SR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_tv_parlines(string, tab, ctl_string, ss3.ctl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_tv_parlines_+3A_string">string</code></td>
<td>
<p>The code representing the section the parameter is from.</p>
</td></tr>
<tr><td><code id="add_tv_parlines_+3A_tab">tab</code></td>
<td>
<p>As created in <code>change_tv()</code></p>
</td></tr>
<tr><td><code id="add_tv_parlines_+3A_ctl_string">ctl_string</code></td>
<td>
<p>The code as called in the .ss_new comment for time varying.</p>
</td></tr>
<tr><td><code id="add_tv_parlines_+3A_ss3.ctl">ss3.ctl</code></td>
<td>
<p>A ss control file that has been read in using <code>readLines()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified version of ss3.ctl (a vector of strings), containing the
new parameter line
</p>

<hr>
<h2 id='calculate_data_units'>Given sampling arguments, calculate super set of fleets, years, and data
types.</h2><span id='topic+calculate_data_units'></span>

<h3>Description</h3>

<p>Given sampling arguments, calculate super set of fleets, years, and data
types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_data_units(index_params = NULL, lcomp_params = NULL,
  agecomp_params = NULL, calcomp_params = NULL,
  mlacomp_params = NULL, wtatage_params = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_data_units_+3A_index_params">index_params</code></td>
<td>
<p>Named lists containing the arguments for
<code>sample_index</code>.</p>
</td></tr>
<tr><td><code id="calculate_data_units_+3A_lcomp_params">lcomp_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_lcomp">sample_lcomp</a></code>.</p>
</td></tr>
<tr><td><code id="calculate_data_units_+3A_agecomp_params">agecomp_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_agecomp">sample_agecomp</a></code>.</p>
</td></tr>
<tr><td><code id="calculate_data_units_+3A_calcomp_params">calcomp_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>.</p>
</td></tr>
<tr><td><code id="calculate_data_units_+3A_mlacomp_params">mlacomp_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>.</p>
</td></tr>
<tr><td><code id="calculate_data_units_+3A_wtatage_params">wtatage_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_wtatage">sample_wtatage</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible list of fleets, years, and types.
</p>


<h3>Note</h3>

<p>A superset by nature is larger than the individual sets used to
create it (unless all sampling arguments are identical), so that the
returned list will created some unnecessary combinations. This was done
intentionally for simplicity but may be changed later. See the vignette
for further information.
</p>
<p>See further examples in <code><a href="#topic+change_data">change_data</a></code>.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>See Also</h3>

<p>clean_data, change_data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Only one fleet
calculate_data_units(lcomp_params = list(fleets = 1, years = c(3, 4, 6)))
## Add new fleet
calculate_data_units(lcomp_params = list(fleets = 1, years = c(3, 4, 6)),
                     agecomp_params = list(fleets = 2, years = 5))
</code></pre>

<hr>
<h2 id='calculate_re'>Calculate relative error</h2><span id='topic+calculate_re'></span>

<h3>Description</h3>

<p>Calculate the relative error (RE; [EM - OM]/OM) of 
parameters and derived quantities stored in a scalar or time series 
data frame generated by <code><a href="#topic+get_results_all">get_results_all</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_re(dat, add = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_re_+3A_dat">dat</code></td>
<td>
<p>An input data frame. Should be either a scalar or time series
data frame as returned from <code><a href="#topic+get_results_all">get_results_all</a></code> or a related
get results function. Specifically, the data frame needs to have columns
with <code>_em</code> and <code>_om</code> as names.</p>
</td></tr>
<tr><td><code id="calculate_re_+3A_add">add</code></td>
<td>
<p>Logical: should the relative error columns be added to <code>dat</code>
or should the original EM and OM columns be dropped? If <code>FALSE</code> then
the returned data frame will have only the identifying columns and the new
relative error columns. You could then merge selected columns back into
<code>dat</code> if you wished. The default is to return all columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The default is to return a data frame structured the same as the 
input data frame, i.e., <code>dat</code>, but with additional columns, where 
<code>'_re'</code> is appended to the base string of the column name.
All <code>NAN</code> and <code>Inf</code> values are returned as <code>NA</code> values,
typically because you cannot divide by zero.
</p>


<h3>Author(s)</h3>

<p>Sean Anderson and Cole Monnahan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_results_all">get_results_all</a></code>, <code>link{get_results_scenario}</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with built in package data:
data("ts_dat", package = "ss3sim")
data("scalar_dat", package = "ss3sim")
head(calculate_re(ts_dat))
head(calculate_re(ts_dat, add = FALSE))
head(calculate_re(scalar_dat, add = FALSE))
rm("ts_dat", "scalar_dat")

</code></pre>

<hr>
<h2 id='case_comp'>Write a case file for length- or age-composition data</h2><span id='topic+case_comp'></span>

<h3>Description</h3>

<p>Use <span class="rlang"><b>R</b></span> code to write arguments to the disk, which
will later be used in a <span class="pkg">ss3sim</span> simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>case_comp(fleets = 1, Nsamp = NULL, years = NULL, cpar = 2, type,
  case, spp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="case_comp_+3A_fleets">fleets</code></td>
<td>
<p>Vector of fleet numbers, where the order of
<code>fleets</code> will dictate the order of all remaining arguments.</p>
</td></tr>
<tr><td><code id="case_comp_+3A_nsamp">Nsamp</code></td>
<td>
<p>A list of length <code>length(fleets)</code>,
where each element of the list contains a vector of
sample sizes for each year for that given fleet.</p>
</td></tr>
<tr><td><code id="case_comp_+3A_years">years</code></td>
<td>
<p>A list of length <code>length(fleets)</code>,
where each element of the list contains a vector of
years for the given fleet.</p>
</td></tr>
<tr><td><code id="case_comp_+3A_cpar">cpar</code></td>
<td>
<p>A vector of cpar for each fleet.</p>
</td></tr>
<tr><td><code id="case_comp_+3A_type">type</code></td>
<td>
<p>A character value of <code>"agecomp"</code> or <code>"lcomp"</code>,
to write age- or length-composition specifications, respectively.
Argument can be a vector (e.g., <code>c("agecomp", "lcomp")</code>) if you want
the case files to be the same for length and age compositions.</p>
</td></tr>
<tr><td><code id="case_comp_+3A_case">case</code></td>
<td>
<p>The casenumber you want to write to.
If <code>case = 1</code> and <code>type = "agecomp"</code>,
then the result will be <code>'agecomp1'</code>.</p>
</td></tr>
<tr><td><code id="case_comp_+3A_spp">spp</code></td>
<td>
<p>A vector of character values argument specifying the species.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>case_comp(fleets = 1:2, case = 30, spp = "cod",
  Nsamp = list(rep(10, 40), rep(10, 25)),
  years = list(61:100, 76:100), cpar = 2:1, type = "agecomp")
done &lt;- file.remove("agecomp30-cod.txt")
</code></pre>

<hr>
<h2 id='case_deparse'>Turn an argument describing an object into a character.</h2><span id='topic+case_deparse'></span>

<h3>Description</h3>

<p>Turn an argument describing an object into a character.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>case_deparse(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="case_deparse_+3A_x">x</code></td>
<td>
<p>The argument you would like to <code>deparse</code>.
<code>"M1-F1-D1-R1"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Includes checks to make sure multiple lines will not be created.
</p>


<h3>Value</h3>

<p>A single character value.
</p>

<hr>
<h2 id='case_fishing'>Write a case file for fishing data to the disk.</h2><span id='topic+case_fishing'></span>

<h3>Description</h3>

<p>Use <span class="rlang"><b>R</b></span> code to write arguments to the disk, which
will later be used in a <span class="pkg">ss3sim</span> simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>case_fishing(years = 1, years_alter = NULL, fvals = 2, case, spp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="case_fishing_+3A_years">years</code></td>
<td>
<p>Vector of years for which <em>F</em> values are specified,
if there is more than one fleet or season the catches must be ordered by
season:year:fishery (e.g., season1year1fishery1, season2year1fishery1,
season1year2fishery1). The actual vector does not have to correspond to
true years but must be the correct length (e.g., instead of
<code>2000:2004</code> you can use <code>1:5</code>). Use this argument to create
an index to old values. <code>years_alter</code> will use values in this vector.
For example, with two seasons and one fishery that operates for 4 years
you could use the following: <code>1:8</code>.</p>
</td></tr>
<tr><td><code id="case_fishing_+3A_years_alter">years_alter</code></td>
<td>
<p>Vector of years for the which <em>F</em> values will be altered.
If there is more than one fishery or season, use the mapping system
created in <code>years</code> because actual year values cannot be recycled.
For example, to change the second season of the second year in the
example above, use: <code>4</code>.</p>
</td></tr>
<tr><td><code id="case_fishing_+3A_fvals">fvals</code></td>
<td>
<p>Vector of <em>F</em> values to be entered into <code>ss.par</code> file,
where <code>length(fvals) == length(years_alter)</code> must be true.</p>
</td></tr>
<tr><td><code id="case_fishing_+3A_case">case</code></td>
<td>
<p>The case number you want to write to.
If <code>case = 1</code>, then the result will be <code>'F1'</code>.</p>
</td></tr>
<tr><td><code id="case_fishing_+3A_spp">spp</code></td>
<td>
<p>A vector of character values argument specifying the species.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>case_fishing(1:100, 1:100, seq(0, 0.4, length.out = 100), 2, "cod")
done &lt;- file.remove("F2-cod.txt")
</code></pre>

<hr>
<h2 id='case_index'>Write a case file for index data to the disk.</h2><span id='topic+case_index'></span>

<h3>Description</h3>

<p>Use <span class="rlang"><b>R</b></span> code to write arguments to the disk, which
will later be used in a <span class="pkg">ss3sim</span> simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>case_index(fleets = 1, years = NULL, sd = 2, case, spp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="case_index_+3A_fleets">fleets</code></td>
<td>
<p>Vector of fleet numbers, where the order of
<code>fleets</code> will dictate the order of all remaining arguments.</p>
</td></tr>
<tr><td><code id="case_index_+3A_years">years</code></td>
<td>
<p>A list of length <code>length(fleets)</code>,
where each element of the list contains a vector of
years for the given fleet.</p>
</td></tr>
<tr><td><code id="case_index_+3A_sd">sd</code></td>
<td>
<p>A list of standard deviations for each fleet.</p>
</td></tr>
<tr><td><code id="case_index_+3A_case">case</code></td>
<td>
<p>The case number you want to write to.
If <code>case = 1</code>, then the result will be <code>'index1'</code>.</p>
</td></tr>
<tr><td><code id="case_index_+3A_spp">spp</code></td>
<td>
<p>A vector of character values argument specifying the species.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>case_index(fleets = 2, case = 1, spp = "cod", years = list(7:10), sd = 0.1)
done &lt;- file.remove("index1-cod.txt")
</code></pre>

<hr>
<h2 id='case_tv'>Write time varying casefiles to the disk</h2><span id='topic+case_tv'></span>

<h3>Description</h3>

<p>Use <span class="rlang"><b>R</b></span> code to write arguments to the disk, which
will later be used in a <span class="pkg">ss3sim</span> simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>case_tv(species, parameter, perc_change, outfile, dir_out = "cases",
  dir_models = system.file("models", package = "ss3models"),
  nyears = 100, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="case_tv_+3A_species">species</code></td>
<td>
<p>A vector of species, for which a unique case file will be
generated.</p>
</td></tr>
<tr><td><code id="case_tv_+3A_parameter">parameter</code></td>
<td>
<p>A character value specifying the parameter to add deviates
to. The argument must match the parameter name exactly.</p>
</td></tr>
<tr><td><code id="case_tv_+3A_perc_change">perc_change</code></td>
<td>
<p>A vector of percents, which will be used to add deviates
to the parameter specified in <code>parameter</code>. A percentage must be supplied
for every year in the model.</p>
</td></tr>
<tr><td><code id="case_tv_+3A_outfile">outfile</code></td>
<td>
<p>A character value specifying the case letter and number used
to save the file.</p>
</td></tr>
<tr><td><code id="case_tv_+3A_dir_out">dir_out</code></td>
<td>
<p>A character value specifying the directory to save the
<code>outfile</code> to.</p>
</td></tr>
<tr><td><code id="case_tv_+3A_dir_models">dir_models</code></td>
<td>
<p>The path where the models are stored, such that
<code>file.path(dir_models, species, "om", "ss3.ctl")</code> leads to valid
<code>ss3.ctl</code> operating model files.</p>
</td></tr>
<tr><td><code id="case_tv_+3A_nyears">nyears</code></td>
<td>
<p>The length time-series included in the model. The length of
<code>perc_change</code> must equal <code>nyears</code>.</p>
</td></tr>
<tr><td><code id="case_tv_+3A_verbose">verbose</code></td>
<td>
<p>Useful for debugging to print output to screen. Default is
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Kuriyama
</p>


<h3>Examples</h3>

<pre><code class='language-R'>temp_path &lt;- file.path(tempdir(), "cod")
dir.create(temp_path, showWarnings = FALSE)

d &lt;- system.file("extdata", package = "ss3sim")

om &lt;- file.path(d, "models", "cod-om")
ig &lt;- file.copy(om, temp_path, recursive = TRUE)
ig &lt;- file.rename(file.path(temp_path, "cod-om"), file.path(temp_path, "om"))
filenames &lt;- dir(file.path(temp_path, "om"), full.names = TRUE)
ig &lt;- file.rename(filenames, gsub("codOM\\.|ss\\.", "ss3.", filenames))

verify_input(file.path(temp_path, "om"), type = "om")
ig &lt;- file.rename(file.path(temp_path, "om", "om.ctl"),
  file.path(temp_path, "om", "ss3.ctl"))

case_tv(species = "cod", parameter = "NatM_p_1_Fem_GP_1",
perc_change = rep(0.5, 100), outfile = "G1",
dir_out = temp_path, dir_models = gsub("/cod", "", temp_path),
nyears = 100, verbose = TRUE)
unlink(temp_path, recursive = TRUE)
</code></pre>

<hr>
<h2 id='change_data'>Change the data that is available as output from an SS operating model.</h2><span id='topic+change_data'></span>

<h3>Description</h3>

<p><code>change_data</code> alters the data structure for a data list as read in by
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code>, for use in preparing the data file for an SS
operating model. Original data is removed and dummy data is added, as
specified, to the SS <code>.dat</code> file. This causes SS to produce expected
values (OM &quot;truth&quot;) when the operating model is run, from which data can be
sampled.  For each data type altered, <code>change_data</code> will add data for
the fleets and years given; potentially adding many rows of redundant data.
Currently, <code>.dat</code> files with multiple sexes cannot be manipulated with
<code>change_data</code>. <code><a href="#topic+calculate_data_units">calculate_data_units</a></code> is used internally in
<code><a href="#topic+ss3sim_base">ss3sim_base</a></code> to create a superset of fleets and years from
sample arguments, and <code><a href="#topic+clean_data">clean_data</a></code> to strip out unused data after
<code>change_data</code> is called (see examples below). <code>change_data</code> is
called internally automatically, but can also be used by an <span class="pkg">ss3sim</span> user
to manipulate data as a case, or to prepare a new OM for use in a simulation.
See the vignette for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_data(dat_list, outfile = NULL, fleets, years, types,
  age_bins = NULL, len_bins = NULL, pop_binwidth = NULL,
  pop_minimum_size = NULL, pop_maximum_size = NULL,
  lcomp_constant = NULL, tail_compression = NULL, nsex = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_data_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="change_data_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
<tr><td><code id="change_data_+3A_fleets">fleets</code></td>
<td>
<p>A numeric vector of fleets</p>
</td></tr>
<tr><td><code id="change_data_+3A_years">years</code></td>
<td>
<p>A numeric vector of years</p>
</td></tr>
<tr><td><code id="change_data_+3A_types">types</code></td>
<td>
<p>A vector that can take combinations of the following entries:
<code>"index"</code>, <code>"len"</code>, <code>"age"</code>, <code>"cal"</code>, <code>"mla"</code>.
<code>types</code> controls what data structures the function acts on, with
<code>"index"</code> changing indices/CPUE, <code>"len"</code> augmenting the length
composition data, <code>"age"</code> augmenting the age composition, <code>"cal"</code>
augmenting the conditional age at length, and <code>"mla"</code> augmenting the
mean length at age data.</p>
</td></tr>
<tr><td><code id="change_data_+3A_age_bins">age_bins</code></td>
<td>
<p>*A numeric vector of age bins to use. If left as <code>NULL</code>
then the age bin structure will be taken from the OM.</p>
</td></tr>
<tr><td><code id="change_data_+3A_len_bins">len_bins</code></td>
<td>
<p>*A numeric vector of length bins to use. If left as
<code>NULL</code> then the length bin structure will be taken from the OM.
For conditional age-at-length (CAAL) data, the last value provided to
<code>len_bins</code> will be used for Lbin_lo and -1 will be used for Lbin_hi
for the largest length bin category, i.e., row of CAAL data.</p>
</td></tr>
<tr><td><code id="change_data_+3A_pop_binwidth">pop_binwidth</code></td>
<td>
<p>*Population length bin width. Note that this value must
be smaller than the bin width specified in length composition data
<code>len_bins</code> or SS will fail (see notes in the SS manual).</p>
</td></tr>
<tr><td><code id="change_data_+3A_pop_minimum_size">pop_minimum_size</code></td>
<td>
<p>*Population minimum length bin value.</p>
</td></tr>
<tr><td><code id="change_data_+3A_pop_maximum_size">pop_maximum_size</code></td>
<td>
<p>*Population maximum length bin value.</p>
</td></tr>
<tr><td><code id="change_data_+3A_lcomp_constant">lcomp_constant</code></td>
<td>
<p>*A new robustification constant for length composition
data to be used. Must be a numeric value, as a proportion. For example 0.1
means 10 percent. See the SS manual for further information. A <code>NULL</code>
value indicates no action resulting in using the current value, and a value
of 0 will throw an error since that leads to an error when zeroes exist in
the data. Instead use a very small value like <code>1e-07</code>.</p>
</td></tr>
<tr><td><code id="change_data_+3A_tail_compression">tail_compression</code></td>
<td>
<p>*A new tail compression value to be used in SS. Must
be a numeric value, as a proportion. For example 0.1 means 10 percent. See
the SS manual for further information. A <code>NULL</code> value indicates no
action, a negative value indicates to SS to ignore it (not use that
feature).</p>
</td></tr>
<tr><td><code id="change_data_+3A_nsex">nsex</code></td>
<td>
<p>An integer value of 1 or 2 specifying the number of sexes in the
model. If 1, then females are the only included sex. This information can be
found in the data file for a given model and dictates how the composition
data are structured.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The robustification constant is added to both the observed and
expected proportions of length composition data, before being normalized
internally. It is designed to help stabilize the model, but is unclear how
and when to use it for optimal effect. The same value is used for all
length data.
</p>


<h3>Value</h3>

<p>An invisible data list, and a file is written to the disk if an
entry other than <code>NULL</code> is provided for <code>outfile</code>.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan, Ian Taylor, Sean Anderson, Kelli Johnson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sample_lcomp">sample_lcomp</a></code>, <code><a href="#topic+sample_agecomp">sample_agecomp</a></code>
</p>
<p>Other change functions: <code><a href="#topic+change_em_binning">change_em_binning</a></code>,
<code><a href="#topic+change_e">change_e</a></code>, <code><a href="#topic+change_f_par">change_f_par</a></code>,
<code><a href="#topic+change_f">change_f</a></code>, <code><a href="#topic+change_o">change_o</a></code>,
<code><a href="#topic+change_retro">change_retro</a></code>, <code><a href="#topic+change_tv">change_tv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- system.file("extdata", package = "ss3sim")
fleets &lt;- 1:2
years &lt;- c(5, 10, 15)
types &lt;- c("len", "age")
file_in &lt;- r4ss::SS_readdat(file.path(d, "models", "cod-om", "codOM.dat"),
  version = NULL, verbose = FALSE)

# Basic test with just length data, default bins:
out &lt;- change_data(file_in, outfile = NULL, types = "len",
  years = years, fleets = fleets)
print(out$lbin_vector)
print(out$lencomp)

# Change the length bins:
out &lt;- change_data(file_in, outfile = NULL, types = "len",
  years = years, fleets = fleets, len_bins = 3:6)
out$lbin_vector
out$lencomp

# Change the population length bins:
out &lt;- change_data(file_in, outfile = NULL, types = "len",
  years = years, fleets = fleets, pop_binwidth = 1, pop_minimum_size = 5,
  pop_maximum_size = 210)
out$binwidth
out$maximum_size
out$minimum_size
</code></pre>

<hr>
<h2 id='change_e'>Methods to alter which parameters are estimated in a SS3 <code>.ctl</code> file.</h2><span id='topic+change_e'></span>

<h3>Description</h3>

<p>Takes SS3 <code>.ctl</code> and <code>forecast.ss</code> files, along with
a list structure which houses the data file as read in by
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code>
and changes which parameters are estimated, how natural mortality is
estimated, and if forecasts are performed. The function can be called by
itself or within <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> to alter an estimation model
<code>.ctl</code> file.
If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> the case file should be named
<code>E</code>. A suggested (default) case letter is <code>E</code> for estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_e(ctl_file_in = "em.ctl", ctl_file_out = "em.ctl",
  dat_list = NULL, for_file_in = "forecasts.ss", par_name = NULL,
  par_int = "NA", par_phase = "NA", forecast_num = 0,
  verbose = FALSE, natM_type = NULL, natM_n_breakpoints = NULL,
  natM_lorenzen = NULL, natM_val = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_e_+3A_ctl_file_in">ctl_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>.ctl</code> file.</p>
</td></tr>
<tr><td><code id="change_e_+3A_ctl_file_out">ctl_file_out</code></td>
<td>
<p>A string providing the path to the output SS control file. If the value is <code>NULL</code>, the file will not be written to the disk.</p>
</td></tr>
<tr><td><code id="change_e_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="change_e_+3A_for_file_in">for_file_in</code></td>
<td>
<p>A string providing the path to the input SS
<code>forecast.ss</code> file.</p>
</td></tr>
<tr><td><code id="change_e_+3A_par_name">par_name</code></td>
<td>
<p>*A vector of values, separated by commas.  Each value
corresponds to a parameter that you wish to turn on or off in the
<code>ctl_file_in</code>. The values will later be turned into character values
and used to search for specific lines for each parameter in the
<code>ctl_file_in</code>, therefore it is best to use full parameter names as
they are specified in <code>ctl_file_in</code>.</p>
</td></tr>
<tr><td><code id="change_e_+3A_par_int">par_int</code></td>
<td>
<p>*A vector of initial values, one for each parameter in
<code>par_name</code>.  Values can be <code>NA</code> if you do not wish to change the
initial value for a given parameter.</p>
</td></tr>
<tr><td><code id="change_e_+3A_par_phase">par_phase</code></td>
<td>
<p>*A vector of phase values, one for each parameter in
<code>par_name</code>.  Values can be <code>NA</code> if you do not wish to change
the phase for a given parameter.</p>
</td></tr>
<tr><td><code id="change_e_+3A_forecast_num">forecast_num</code></td>
<td>
<p>*Number of years to perform forecasts. For those years,
the data will be removed from the <code>dat_list</code>, enabling SS3 to
generate forecasts rather than use the data to fit the model.</p>
</td></tr>
<tr><td><code id="change_e_+3A_verbose">verbose</code></td>
<td>
<p>When <code>TRUE</code> messages will be returned
from the function. Often useful for debugging. The default
is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="change_e_+3A_natm_type">natM_type</code></td>
<td>
<p>Deprecated. Should have value NULL.</p>
</td></tr>
<tr><td><code id="change_e_+3A_natm_n_breakpoints">natM_n_breakpoints</code></td>
<td>
<p>Deprecated. Should have value NULL.</p>
</td></tr>
<tr><td><code id="change_e_+3A_natm_lorenzen">natM_lorenzen</code></td>
<td>
<p>Deprecated. Should have value NULL.</p>
</td></tr>
<tr><td><code id="change_e_+3A_natm_val">natM_val</code></td>
<td>
<p>Deprecated. Should have value NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Turning parameters on and off is the main function of
<code>change_e</code>.  <code>change_e</code> was not created with the capability of
adding parameters to a <code>.ctl</code> file.  The function can only add
parameters for age specific natural mortality, and only for models with
one growth morph.  Furthermore, the function is designed to add complexity
to the natural mortality type and not remove complexity.  Therefore, the
function will fail if natural mortality in the <code>ctl_file_in</code> is not
specified as <code>"1Param"</code> and <code>natM_type</code> is anything other than
<code>NULL</code> or <code>"1Param"</code>.
</p>


<h3>Value</h3>

<p>Altered versions of SS3 <code>.ctl</code> and <code>forecast.ss</code> files are written
to the disk and the altered <code>dat_list</code> is returned invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Kelli Johnson
</p>


<h3>See Also</h3>

<p>Other change functions: <code><a href="#topic+change_data">change_data</a></code>,
<code><a href="#topic+change_em_binning">change_em_binning</a></code>,
<code><a href="#topic+change_f_par">change_f_par</a></code>, <code><a href="#topic+change_f">change_f</a></code>,
<code><a href="#topic+change_o">change_o</a></code>, <code><a href="#topic+change_retro">change_retro</a></code>,
<code><a href="#topic+change_tv">change_tv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

d &lt;- system.file("extdata", "models", "cod-om", package = "ss3sim")
data.old &lt;- r4ss::SS_readdat(
  system.file("extdata", "models", "cod-om", "codOM.dat",
    package = "ss3sim"),
  version = NULL, verbose = FALSE)
change_e(
  ctl_file_in = file.path(d, "codOM.ctl"),
  ctl_file_out = file.path(tempdir(), "change_e.ctl"),
  dat_list = data.old,
  for_file_in = file.path(d, "forecast.ss"),
         natM_type = NULL, natM_n_breakpoints = NULL,
         natM_lorenzen = NULL, natM_val = NULL,
         par_name = c("_steep", "SizeSel_P1_Fishery(1)"),
         par_int = c(0.3, 40), par_phase = c(3, 2),
         forecast_num = 0)
# clean up the temporary files
file.remove(file.path(tempdir(), "change_e.ctl"))

## End(Not run)
</code></pre>

<hr>
<h2 id='change_e_fcast_yrs'>Check and change forecast file years if necessary</h2><span id='topic+change_e_fcast_yrs'></span>

<h3>Description</h3>

<p>Check if forecast years and benchmark years within the forecast file are
within the model start year and end year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_e_fcast_yrs(styr = 0, endyr_orig = 100, endyr_new = 100,
  fcast_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_e_fcast_yrs_+3A_styr">styr</code></td>
<td>
<p>The model start year, an integer</p>
</td></tr>
<tr><td><code id="change_e_fcast_yrs_+3A_endyr_orig">endyr_orig</code></td>
<td>
<p>The original end year that the forecast file assumed, an
integer</p>
</td></tr>
<tr><td><code id="change_e_fcast_yrs_+3A_endyr_new">endyr_new</code></td>
<td>
<p>The new end year, an integer</p>
</td></tr>
<tr><td><code id="change_e_fcast_yrs_+3A_fcast_list">fcast_list</code></td>
<td>
<p>forecast file read in using r4ss (is a list)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A changed forecast list.
</p>

<hr>
<h2 id='change_em_binning'>Change population and observed length composition bins in an SS estimation
model</h2><span id='topic+change_em_binning'></span>

<h3>Description</h3>

<p><code>change_em_binning</code> alters the bin structure for the population and
length composition data in an SS estimation model. It is done by taking the
original length composition info from the EM <code>ss3.dat</code> then changing
according to the user's specification. If the data file also contains
conditional age-at-length data then these data will be re-binned as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_em_binning(dat_list, outfile = NULL, bin_vector,
  lbin_method = NULL, pop_binwidth = NULL, pop_minimum_size = NULL,
  pop_maximum_size = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_em_binning_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="change_em_binning_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
<tr><td><code id="change_em_binning_+3A_bin_vector">bin_vector</code></td>
<td>
<p>A numeric vector of new length bins to substitute into the
<code>ss3.dat</code> file.</p>
</td></tr>
<tr><td><code id="change_em_binning_+3A_lbin_method">lbin_method</code></td>
<td>
<p>A numeric value of either <code>NULL, 1, 2, 3</code> to change
the lbin_method for the population bin. Only supports either <code>NULL, 1,
2</code> at the moment. <code>NULL</code> means to keep it unchanged.</p>
</td></tr>
<tr><td><code id="change_em_binning_+3A_pop_binwidth">pop_binwidth</code></td>
<td>
<p>*Population length bin width. Only necessary for
<code>lbin_method=2</code>. Note that this value must be smaller than the bin
width specified in length composition data <code>len_bins</code> or SS3 will
fail (see notes in the SS3 manual).</p>
</td></tr>
<tr><td><code id="change_em_binning_+3A_pop_minimum_size">pop_minimum_size</code></td>
<td>
<p>*Population minimum length bin value. 'Only
necessary for <code>lbin_method=2</code></p>
</td></tr>
<tr><td><code id="change_em_binning_+3A_pop_maximum_size">pop_maximum_size</code></td>
<td>
<p>*Population maximum length bin value. Only
necessary for <code>lbin_method=2</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kotaro Ono (length-composition rebinning), Sean Anderson
(conditional age-at-length rebinning)
</p>


<h3>See Also</h3>

<p>Other change functions: <code><a href="#topic+change_data">change_data</a></code>,
<code><a href="#topic+change_e">change_e</a></code>, <code><a href="#topic+change_f_par">change_f_par</a></code>,
<code><a href="#topic+change_f">change_f</a></code>, <code><a href="#topic+change_o">change_o</a></code>,
<code><a href="#topic+change_retro">change_retro</a></code>, <code><a href="#topic+change_tv">change_tv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Note that typically this function is used with estimation models in ss3sim,
# but it is used with an operating model data file in the following examples.
f &lt;- system.file("extdata", "models", "cod-om", "codOM.dat", package = "ss3sim")
d &lt;- r4ss::SS_readdat(f, version = NULL, verbose = FALSE)

# An example with lbin_method = 1
l1 &lt;- change_em_binning(d, outfile = NULL, lbin_method = 1,
  bin_vector = seq(20, 152, by = 4))
l1$lbin_vector
head(l1$lencomp)

#An example with lbin_method = 2
new_bin_vec &lt;- seq(min(d$lbin_vector), max(d$lbin_vector), by = 4)
# add the max value if necessary.
if(new_bin_vec[length(new_bin_vec)] != d$lbin_vector[length(d$lbin_vector)]){
  new_bin_vec &lt;- c(new_bin_vec,
                   d$lbin_vector[length(d$lbin_vector)])
}
pop_bin_input &lt;- 5
pop_min_size_input &lt;- min(d$lbin_vector_pop) - 1
pop_max_size_input &lt;- max(d$lbin_vector_pop) + 5
lbin_vec_pop &lt;-seq(pop_min_size_input,
                   pop_max_size_input,
                   length.out = (pop_max_size_input - pop_min_size_input)/
                     pop_bin_input + 1
)
l2 &lt;- change_em_binning(dat_list = d,
                            bin_vector = new_bin_vec,
                            lbin_method = 2,
                            #Note: need more inputs with lbin_method = 2
                            pop_binwidth = pop_bin_input,
                            pop_minimum_size = pop_min_size_input,
                            pop_maximum_size = pop_max_size_input)
l2$lbin_method
# note bin width is now the same as the input
pop_bin_input
l2$binwidth
# note the minimum size has changed based on the input:
pop_min_size_input
l2$minimum_size
# so has max
l2$maximum_size
l2$lbin_vector
#other modified components:
l2$lbin_vector_pop
head(l2$lencomp)
</code></pre>

<hr>
<h2 id='change_f'>Alter fishing mortality (<em>F</em>) using the SS control file</h2><span id='topic+change_f'></span>

<h3>Description</h3>

<p>Alter fishing mortality (<em>F</em>) for a Stock Synthesis simulation
via changes to the control file. The argument <code>years</code> is the only
argument that must be a vector, where other vectors, e.g., <code>fisheries</code>,
will be repeated if a single value is provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_f(years, fisheries, fvals, seasons = 1, ses = 0.005,
  ctl_file_in, ctl_file_out = "control_fishing.ss")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_f_+3A_years">years</code></td>
<td>
<p>*Vector of integers that will map to each <code>fvals</code>
specifying which year the fishing level pertains to.</p>
</td></tr>
<tr><td><code id="change_f_+3A_fisheries">fisheries</code></td>
<td>
<p>*Vector of integers that will map to each <code>fvals</code>
specifying which fleet the fishing level pertains to.
A single value will be repeated for every value in <code>years</code> or
<code>length(years) == length(fisheries)</code> must be true.</p>
</td></tr>
<tr><td><code id="change_f_+3A_fvals">fvals</code></td>
<td>
<p>*Vector of <em>F</em> values to be entered into the
SS control file. A single value will be repeated for every value in <code>years</code> or
<code>length(years) == length(fvals)</code> must be true.</p>
</td></tr>
<tr><td><code id="change_f_+3A_seasons">seasons</code></td>
<td>
<p>Vector of seasons to be entered into the
SS control file. A single value will be repeated for every value in <code>years</code> or
<code>length(years) == length(ses)</code> must be true.
The default is 1, which will be applied to all fisheries in all years.</p>
</td></tr>
<tr><td><code id="change_f_+3A_ses">ses</code></td>
<td>
<p>Vector of fishing level standard errors (ses) to be entered into the
SS control file. A single value will be repeated for every value in <code>years</code> or
<code>length(years) == length(ses)</code> must be true.
The default is 0.005, which will be applied to all fisheries in all years.</p>
</td></tr>
<tr><td><code id="change_f_+3A_ctl_file_in">ctl_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>.ctl</code> file.</p>
</td></tr>
<tr><td><code id="change_f_+3A_ctl_file_out">ctl_file_out</code></td>
<td>
<p>A string providing the path to the output SS control file. If the value is <code>NULL</code>, the file will not be written to the disk.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using the control file depends on
(1) the starter file is set up to read parameters from the control file
rather than the par file and
(2) the data file having a dummy catch entry for every year, fishery
combination that will be specified in the control file.
<em>F</em> values currently in the control file will be removed and
the newly specified values will replace them.
Users do not need to specify values for years in which there
will be zero fishing because SS will be parameterized to assume
no fishing in missing years.
</p>
<p>The control file is currently read in using <code>readLines</code> but will
eventually shift to using code specific to Stock Synthesis to alter
a structured list.
If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>, the case file should be named
<code>F</code>. A suggested (default) case letter is <code>F</code>.
</p>


<h3>Value</h3>

<p>Modified SS control file.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Kelli Faye Johnson
</p>


<h3>See Also</h3>

<p>Other change functions: <code><a href="#topic+change_data">change_data</a></code>,
<code><a href="#topic+change_em_binning">change_em_binning</a></code>, <code><a href="#topic+change_e">change_e</a></code>,
<code><a href="#topic+change_f_par">change_f_par</a></code>, <code><a href="#topic+change_o">change_o</a></code>,
<code><a href="#topic+change_retro">change_retro</a></code>, <code><a href="#topic+change_tv">change_tv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- system.file(file.path("extdata", "models"), package = "ss3sim")
change_f(years = 1:50, fisheries = 1, fvals = 0.2,
  ctl_file_in = file.path(d, "cod-om", "codOM.ctl"),
  ctl_file_out = file.path(tempdir(), "control_fishing.ss"))
</code></pre>

<hr>
<h2 id='change_f_par'>Alter the fishing mortality (<em>F</em>) values in an SS3 <code>.par</code> file.</h2><span id='topic+change_f_par'></span>

<h3>Description</h3>

<p>Takes an SS3 <code>.par</code> file and changes the <em>F</em> values for specified years.
If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> the case file should be named
<code>F</code>. A suggested (default) case letter is <code>F</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_f_par(years, years_alter, fvals, par_file_in = "ss.par",
  par_file_out = "ss.par")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_f_par_+3A_years">years</code></td>
<td>
<p>*Vector of years for which <em>F</em> values are specified,
if there is more than one fleet or season the catches must be ordered by
season:year:fishery (e.g., season1year1fishery1, season2year1fishery1,
season1year2fishery1). The actual vector does not have to correspond to
true years but must be the correct length (e.g., instead of
<code>2000:2004</code> you can use <code>1:5</code>). Use this argument to create
an index to old values. <code>years_alter</code> will use values in this vector.
For example, with two seasons and one fishery that operates for 4 years
you could use the following: <code>1:8</code>.</p>
</td></tr>
<tr><td><code id="change_f_par_+3A_years_alter">years_alter</code></td>
<td>
<p>*Vector of years for the which <em>F</em> values will be altered.
If there is more than one fishery or season, use the mapping system
created in <code>years</code> because actual year values cannot be recycled.
For example, to change the second season of the second year in the
example above, use: <code>4</code>.</p>
</td></tr>
<tr><td><code id="change_f_par_+3A_fvals">fvals</code></td>
<td>
<p>*Vector of <em>F</em> values to be entered into <code>ss.par</code> file,
where <code>length(fvals) == length(years_alter)</code> must be true.</p>
</td></tr>
<tr><td><code id="change_f_par_+3A_par_file_in">par_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>.par</code> file.</p>
</td></tr>
<tr><td><code id="change_f_par_+3A_par_file_out">par_file_out</code></td>
<td>
<p>A string providing the path to the output SS <code>.par</code> file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified SS3 <code>.par</code> file.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Curry James Cunningham
</p>


<h3>See Also</h3>

<p>Other change functions: <code><a href="#topic+change_data">change_data</a></code>,
<code><a href="#topic+change_em_binning">change_em_binning</a></code>, <code><a href="#topic+change_e">change_e</a></code>,
<code><a href="#topic+change_f">change_f</a></code>, <code><a href="#topic+change_o">change_o</a></code>,
<code><a href="#topic+change_retro">change_retro</a></code>, <code><a href="#topic+change_tv">change_tv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a temporary folder for the output:
temp_path &lt;- file.path(tempdir(), "ss3sim-f-example")
dir.create(temp_path, showWarnings = FALSE)

# Find the example .par file in the package data:
d &lt;- system.file("extdata", package = "ss3sim")
par_file &lt;- paste0(d, "/change_f/ss3.par")

change_f_par(years = 1:49, years_alter = 2, fvals = 9999, par_file_in =
par_file, par_file_out = paste0(temp_path, "/test.par"))
</code></pre>

<hr>
<h2 id='change_lcomp_constant'>Set the robustification constant for length composition data.</h2><span id='topic+change_lcomp_constant'></span>

<h3>Description</h3>

<p>This function replaces the robustification value for length composition data
in a <code>.dat</code> file that was read in using <code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code>
with those specified in
<code>lcomp_constant</code>. It then writes a new file with name <code>outfile</code>
into the working directory. If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> the case
file should be named <code>lcomp_constant</code>. A suggested case letter is
<code>C</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_lcomp_constant(lcomp_constant, dat_list, outfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_lcomp_constant_+3A_lcomp_constant">lcomp_constant</code></td>
<td>
<p>*The new value to be used. Must be a numeric value, as
a proportion. For example 0.1 means 10 percent. See the SS3 manual for
further information. A NULL value indicates no action resulting in using
the current value, and a value of 0 will throw an error since that leads to
an error when zeroes exist in the data. Instead use a very small value like
1e-07.</p>
</td></tr>
<tr><td><code id="change_lcomp_constant_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="change_lcomp_constant_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The robustification constant is added to both the observed and
expected proportions of length composition data, before being normalized
internally. It is designed to help stabilize the model, but is unclear how
and when to use it for optimal effect. The same value is used for all
length data.
</p>


<h3>Value</h3>

<p>A modified SS3 <code>.dat</code> file, and that file returned invisibly
(for testing) as a vector of character lines.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>

<hr>
<h2 id='change_o'>Methods to include parameters in an SS3operating model</h2><span id='topic+change_o'></span>

<h3>Description</h3>

<p><code>change_o</code> takes an SS3 <code>.ctl</code>file
and implements parameter value changes that are NOT time varying.
<code>change_o</code> is specifically set up to work with an operating model
<code>.ctl</code> file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_o(change_o_list, ctl_file_in = "control.ss_new",
  ctl_file_out = "om.ctl", par_name = NULL, par_int = NULL,
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_o_+3A_change_o_list">change_o_list</code></td>
<td>
<p>*A list of named vectors. Names correspond to parameters
in the operating model and the vectors correspond to deviations.
Alternatively, <code>par_name</code> and <code>par_init</code> can be passed to this
function.</p>
</td></tr>
<tr><td><code id="change_o_+3A_ctl_file_in">ctl_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>.ctl</code> file.</p>
</td></tr>
<tr><td><code id="change_o_+3A_ctl_file_out">ctl_file_out</code></td>
<td>
<p>A string providing the path to the output SS control file. If the value is <code>NULL</code>, the file will not be written to the disk.</p>
</td></tr>
<tr><td><code id="change_o_+3A_par_name">par_name</code></td>
<td>
<p>*A character vector of parameter names to pass in. NULL unless
want to use instead of <code>change_o_list</code>.</p>
</td></tr>
<tr><td><code id="change_o_+3A_par_int">par_int</code></td>
<td>
<p>*A numeric vector of parameter initial values to pass in. NULL
unless want to use instead of <code>change_o_list</code>. Must have the same
length and be in the same order as <code>par_names</code>, as the names should
correspond with their initial values.</p>
</td></tr>
<tr><td><code id="change_o_+3A_verbose">verbose</code></td>
<td>
<p>When <code>TRUE</code> messages will be returned
from the function. Often useful for debugging. The default
is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function creates modified versions of the  <code>.ctl</code> files. The
function also returns <code>change_o_list</code> invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Specifying the <code>change_o_list</code></h3>

<p>Parameters initial values will change according to the values passed to
<code>change_o_list</code>. Each parameter should have a single value specified.
</p>
<p>Parameter names must be unique and match the full parameter name in the
<code>.ctl</code> file.
</p>


<h3>Passing arguments to <code>change_o</code> through <code><a href="#topic+run_ss3sim">run_ss3sim</a></code></h3>

<p>(1) create a case file with an arbitrary letter
not used elsewhere (anything but D, E, F, or R) and (2) include the line
<code>function_type; change_o</code> in your case file. For example, you might
want to use M for natural mortality, S for selectivity, or G for growth.
</p>


<h3>Author(s)</h3>

<p>Kathryn Doering
</p>


<h3>See Also</h3>

<p>Other change functions: <code><a href="#topic+change_data">change_data</a></code>,
<code><a href="#topic+change_em_binning">change_em_binning</a></code>, <code><a href="#topic+change_e">change_e</a></code>,
<code><a href="#topic+change_f_par">change_f_par</a></code>, <code><a href="#topic+change_f">change_f</a></code>,
<code><a href="#topic+change_retro">change_retro</a></code>, <code><a href="#topic+change_tv">change_tv</a></code>
</p>

<hr>
<h2 id='change_pop_bin'>Set up population length bin structure</h2><span id='topic+change_pop_bin'></span>

<h3>Description</h3>

<p>The population length bins in Stock Synthesis structure size data and
empirical weight-at-age data.
<code>change_pop_bin</code> changes the data file to contain
specifications to create a vector (length-bin method of 2) rather than
the actual bins from the length data (length-bin method of 1) or
an actual vector (length-bin method of 3).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_pop_bin(dat_list, binwidth = NULL, minimum_size = NULL,
  maximum_size = NULL, maximum_age = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_pop_bin_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="change_pop_bin_+3A_binwidth">binwidth</code></td>
<td>
<p>A numeric value specifying the width of the size bins.</p>
</td></tr>
<tr><td><code id="change_pop_bin_+3A_minimum_size">minimum_size</code></td>
<td>
<p>The smallest size bin.</p>
</td></tr>
<tr><td><code id="change_pop_bin_+3A_maximum_size">maximum_size</code></td>
<td>
<p>The largest size bin.</p>
</td></tr>
<tr><td><code id="change_pop_bin_+3A_maximum_age">maximum_age</code></td>
<td>
<p>The highest age. Used to structure the maximum age of
the population and the ageing-error matrix, which will be assumed
to have no bias and maximum precision for any added ages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The only required argument is <code>dat_list</code> and the remaining arguments
default to a value of <code>NULL</code>, which leads to the data file not being
changed.
</p>


<h3>Value</h3>

<p>A modified Stock Synthesis data file in list form. The list
is only returned if it is assigned to an object.
</p>

<hr>
<h2 id='change_rec_devs'>Replace recruitment deviations</h2><span id='topic+change_rec_devs'></span>

<h3>Description</h3>

<p>This function replaces the recruitment deviations in the
control file of a Stock Synthesis model with those specified in the argument
<code>recdevs</code>. The new control file is then written to the disk if
<code>ctl_file_out</code> is specified.
It is imperative that the path provided in <code>ctl_file_in</code>
be to a <code>ss_new</code> file so <code>change_rec_devs</code> can
properly determine where to place the recruitment deviations
in the control file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_rec_devs(recdevs, ctl_file_in,
  ctl_file_out = "control_recruitment.ss")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_rec_devs_+3A_recdevs">recdevs</code></td>
<td>
<p>A vector of recruitment deviations to be entered into
the SS control file. The vector must be the same length as the vector
of recruitment deviations that are commented out in the <code>ss_new</code>
control file. This vector can be found by searching for
<code># all recruitment deviations</code> within the file.
If a single value is provided instead of a vector, the value
will be repeated for every recruitment deviation in the model.
Alternatively, users can supply a named vector with each name being a year
of the model. Missing years will be filled in with values of zero.</p>
</td></tr>
<tr><td><code id="change_rec_devs_+3A_ctl_file_in">ctl_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>.ctl</code> file.</p>
</td></tr>
<tr><td><code id="change_rec_devs_+3A_ctl_file_out">ctl_file_out</code></td>
<td>
<p>A string providing the path to the output SS control file. If the value is <code>NULL</code>, the file will not be written to the disk.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does not need to be specified in a case file if you
are running an ss3sim simulation using <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>.
</p>


<h3>Value</h3>

<p>A modified SS control file.
</p>


<h3>Author(s)</h3>

<p>Kelli Faye Johnson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- system.file(file.path("extdata", "models"), package = "ss3sim")
change_rec_devs(recdevs = rlnorm(101),
  ctl_file_in = file.path(d, "cod-om", "codOM.ctl"),
  ctl_file_out = file.path(tempdir(), "control_recdevs.ss"))
# Change the recruitment deviations in years 2:11
change_rec_devs(recdevs = setNames(rlnorm(10), 2:11),
  ctl_file_in = file.path(d, "cod-om", "codOM.ctl"),
  ctl_file_out = file.path(tempdir(), "control_recdevsInitial.ss"))
sapply(dir(tempdir(), pattern = "control_.+ss", full.names = TRUE), unlink)
</code></pre>

<hr>
<h2 id='change_rec_devs_par'>Replace recruitment deviations</h2><span id='topic+change_rec_devs_par'></span>

<h3>Description</h3>

<p>This function replaces the recruitment deviations in the
<code>ss.par</code> file with those specified in <code>recdevs_new</code>, as
well as a comment (for debugging). It then writes a new file with
name <code>par_file_out</code> into the working directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_rec_devs_par(recdevs_new, par_file_in = "ss.par",
  par_file_out = "ss.par")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_rec_devs_par_+3A_recdevs_new">recdevs_new</code></td>
<td>
<p>A vector of new recruitment deviations.</p>
</td></tr>
<tr><td><code id="change_rec_devs_par_+3A_par_file_in">par_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>.par</code> file.</p>
</td></tr>
<tr><td><code id="change_rec_devs_par_+3A_par_file_out">par_file_out</code></td>
<td>
<p>A string providing the path to the output SS <code>.par</code> file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does not need to be specified in a case file if you
are running and ss3sim simulation through case files with
<code><a href="#topic+run_ss3sim">run_ss3sim</a></code>.
</p>


<h3>Value</h3>

<p>A modified SS3 <code>.par</code> file.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>

<hr>
<h2 id='change_retro'>Alter a starter file for a retrospective analysis</h2><span id='topic+change_retro'></span>

<h3>Description</h3>

<p>A retrospective analysis tests the effect of peeling back the number of
operating model years observable to the estimation model. This function
alters the SS3 starter file to run a retrospective analysis.
If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> the case file should be named
<code>R</code>. A suggested (default) case letter is <code>R</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_retro(str_file_in = "starter.ss", str_file_out = "starter.ss",
  retro_yr = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_retro_+3A_str_file_in">str_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>starter.ss</code> file.</p>
</td></tr>
<tr><td><code id="change_retro_+3A_str_file_out">str_file_out</code></td>
<td>
<p>A string providing the path to the output SS <code>starter.ss</code> file.</p>
</td></tr>
<tr><td><code id="change_retro_+3A_retro_yr">retro_yr</code></td>
<td>
<p>*Which retrospective year to enter into the starter file.
Should be 0 (no retrospective analysis) or a negative value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the starter file is set up to run a single retrospective
run. Therefore, if you would like to run retrospective analyses for, say,
0, 1, 2, 3, 4, and 5 years, you will need to use this function to adjust
the starter file 6 separate times.
</p>


<h3>Value</h3>

<p>A modified SS3 starter file.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Sean C. Anderson
</p>


<h3>See Also</h3>

<p>Other change functions: <code><a href="#topic+change_data">change_data</a></code>,
<code><a href="#topic+change_em_binning">change_em_binning</a></code>, <code><a href="#topic+change_e">change_e</a></code>,
<code><a href="#topic+change_f_par">change_f_par</a></code>, <code><a href="#topic+change_f">change_f</a></code>,
<code><a href="#topic+change_o">change_o</a></code>, <code><a href="#topic+change_tv">change_tv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a temporary folder for the output:
temp_path &lt;- file.path(tempdir(), "ss3sim-retro-example")
dir.create(temp_path, showWarnings = FALSE)

# Locate the package data:
starterfile &lt;- system.file("extdata", "models", "cod-om",
 "starter.ss", package = "ss3sim")

# No retrospective analysis:
change_retro(starterfile, paste0(temp_path, "/retro-0-starter.ss"),
retro_yr = 0)

# A retrospective analysis of 5 years:
change_retro(starterfile, paste0(temp_path, "/retro-5-starter.ss"),
retro_yr = -5)
</code></pre>

<hr>
<h2 id='change_tail_compression'>Replace tail compression value for length composition data.</h2><span id='topic+change_tail_compression'></span>

<h3>Description</h3>

<p>This function replaces the tail compression value for length composition data
in a <code>.dat</code> file that was read in using <code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code>
with those specified in
<code>tail_compression</code>. It then writes a new file with name <code>dat_file_out</code>
into the working directory. If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> the case
file should be named <code>tail_compression</code>. A suggested case letter is
<code>T</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_tail_compression(tail_compression, dat_list, outfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_tail_compression_+3A_tail_compression">tail_compression</code></td>
<td>
<p>*The new tail_compression value to be used. Must be a
numeric value, as a proportion. For example 0.1 means 10 percent. See the
SS3 manual for further information. A NULL value indicates no action, a
negative value indicates to SS3 to ignore it (not use that feature).</p>
</td></tr>
<tr><td><code id="change_tail_compression_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="change_tail_compression_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified SS3 <code>.dat</code> file, and that file returned invisibly
(for testing) as a vector of character lines.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>

<hr>
<h2 id='change_tv'>Methods to include time-varying parameters in an SS3 operating model</h2><span id='topic+change_tv'></span>

<h3>Description</h3>

<p><code>change_tv</code> takes SS3 <code>.ctl</code>, <code>.par</code>, and <code>.dat</code> files
and implements time-varying parameters using environmental variables.
<code>change_tv</code> is specifically set up to work with an operating model
<code>.ctl</code> file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_tv(change_tv_list, ctl_file_in = "control.ss_new",
  ctl_file_out = "om.ctl", dat_file_in = "ss3.dat",
  dat_file_out = "ss3.dat")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="change_tv_+3A_change_tv_list">change_tv_list</code></td>
<td>
<p>*A list of named vectors. Names correspond to parameters
in the operating model that currently do not use environmental deviations and
the vectors correspond to deviations. See the section &quot;Specifying the
<code>change_tv_list</code>&quot; below for help on specifying this argument.</p>
</td></tr>
<tr><td><code id="change_tv_+3A_ctl_file_in">ctl_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>.ctl</code> file.</p>
</td></tr>
<tr><td><code id="change_tv_+3A_ctl_file_out">ctl_file_out</code></td>
<td>
<p>A string providing the path to the output SS control file. If the value is <code>NULL</code>, the file will not be written to the disk.</p>
</td></tr>
<tr><td><code id="change_tv_+3A_dat_file_in">dat_file_in</code></td>
<td>
<p>A string providing the path to the input SS <code>.dat</code> file.</p>
</td></tr>
<tr><td><code id="change_tv_+3A_dat_file_out">dat_file_out</code></td>
<td>
<p>A string providing the path to the output SS <code>.dat</code> file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although there are three ways to implement time-varying parameters within
SS3, <span class="pkg">ss3sim</span> and <code>change_tv</code> only use the environmental variable
option. Within SS3, time-varying parameters work on an annual time-step.
Thus, for models with multiple seasons, the time-varying parameters will
remain constant for the entire year.
</p>
<p>The <code>ctl_file_in</code> argument needs to be a <code>.ss_new</code> file because
the documentation in <code>.ss_new</code> files are automated and standardized.
This function takes advantage of the standard documentation the
<code>.ss_new</code> files to determine which lines to manipulate and where to
add code in the <code>.ctl</code>, <code>.par</code>, and <code>.dat</code> files, code that
is necessary to implement time-varying parameters.
</p>
<p><span class="pkg">ss3sim</span> uses annual recruitment deviations and may not work with a
model that ties recruitment deviations to environmental covariates. If you
need to compare the environment to annual recruitment deviations, the
preferred option is to transform the environmental variable into an age 0
pre-recruit survey. See page 55 of the SS3 version 3.24f manual for more
information.
</p>


<h3>Value</h3>

<p>The function creates modified versions of the  <code>.ctl</code> and
<code>.dat</code> files if ctl_file_out and dat_file_out are not NULL. The function
also returns a list of the modified <code>.ctl</code> and <code>.dat</code> R objects
invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Specifying the <code>change_tv_list</code></h3>

<p>Parameters will change to vary with time according to the vectors of
deviations passed to <code>change_tv_list</code>. Vectors of deviations, also
referred to as environmental data, must have a length equal to <code>
endyr-startyr+1</code>, where <code>endyr</code> and <code>startyr</code> are specified the
<code>.dat</code> file. Specify years without deviations as zero.
</p>
<p>Parameter names must be unique and match the full parameter name in the
<code>.ctl</code> file. Names for stock recruit parameters must contain &quot;devs&quot;,
&quot;R0&quot;, or &quot;steep&quot;, and only one stock recruit parameter can be time-varying
per model.
</p>
<p>This feature will include an *additive* functional linkage between
environmental data and the parameter where the link parameter is fixed at a
value of one and the par value is specified in the <code>.par</code> file:
<code class="reqn">par'[y] = par + link * env[y]</code>.
</p>
<p>For catchability (<code class="reqn">q</code>) the *additive* functional linkage is implemented
on the log scale: <code class="reqn">ln(q'[y]) = ln(q) + link * env[y]</code>
</p>


<h3>Passing arguments to <code>change_tv</code> through <code><a href="#topic+run_ss3sim">run_ss3sim</a></code></h3>

<p>(1) create a case file with an arbitrary letter
not used elsewhere (anything but D, E, F, or R) and (2) include the line
<code>function_type; change_tv</code> in your case file. For example, you might
want to use M for natural mortality, S for selectivity, or G for growth.
</p>


<h3>Author(s)</h3>

<p>Kotaro Ono, Carey McGilliard, Kelli Johnson, and Kathryn Doering
</p>


<h3>See Also</h3>

<p>Other change functions: <code><a href="#topic+change_data">change_data</a></code>,
<code><a href="#topic+change_em_binning">change_em_binning</a></code>, <code><a href="#topic+change_e">change_e</a></code>,
<code><a href="#topic+change_f_par">change_f_par</a></code>, <code><a href="#topic+change_f">change_f</a></code>,
<code><a href="#topic+change_o">change_o</a></code>, <code><a href="#topic+change_retro">change_retro</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create a temporary folder for the output and set the working directory:
temp_path &lt;- file.path(tempdir(), "ss3sim-tv-example")
dir.create(temp_path, showWarnings = FALSE)
wd &lt;- getwd()
setwd(temp_path)
on.exit(setwd(wd), add = TRUE)

d &lt;- system.file("extdata", package = "ss3sim")
om &lt;- file.path(d, "models", "cod-om")
dir.create("cod-om")
file.copy(om, ".", recursive = TRUE)
setwd("cod-om")

change_tv(change_tv_list =
            list("NatM_p_1_Fem_GP_1" = c(rep(0, 20), rep(.1, 80)),
                 "SR_BH_steep"=rnorm(100, 0, 0.05)),
          ctl_file_in  = "codOM.ctl",
          ctl_file_out = "example.ctl",
          dat_file_in  = "codOM.dat",
          dat_file_out = "example.dat")

# Clean up:
unlink("cod-om", recursive = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='check_data'>Check that the SS data file looks correct</h2><span id='topic+check_data'></span>

<h3>Description</h3>

<p>Check that the SS data file looks correct
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_data(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_data_+3A_x">x</code></td>
<td>
<p>An SS data list object as read in by <code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='check_data_str_range'>Check input arguments for data</h2><span id='topic+check_data_str_range'></span>

<h3>Description</h3>

<p>Check that the param list inputs have correct structure and range given an
associated data file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_data_str_range(all_params, dat_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_data_str_range_+3A_all_params">all_params</code></td>
<td>
<p>A named list of the parameters containing at a minimum
year and fleet values</p>
</td></tr>
<tr><td><code id="check_data_str_range_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in by <code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='clean_data'>Given sampling arguments remove (&quot;clean&quot;) all data in a .dat file that
is not specified</h2><span id='topic+clean_data'></span>

<h3>Description</h3>

<p>This prepares a <code>.dat</code> file to be used by an EM, whereas before it may
have had leftover data from sampling purposes. See examples in
<code><a href="#topic+change_data">change_data</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_data(dat_list, index_params = NULL, lcomp_params = NULL,
  agecomp_params = NULL, calcomp_params = NULL,
  mlacomp_params = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clean_data_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="clean_data_+3A_index_params">index_params</code></td>
<td>
<p>Named lists containing the arguments for
<code>sample_index</code>.</p>
</td></tr>
<tr><td><code id="clean_data_+3A_lcomp_params">lcomp_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_lcomp">sample_lcomp</a></code>.</p>
</td></tr>
<tr><td><code id="clean_data_+3A_agecomp_params">agecomp_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_agecomp">sample_agecomp</a></code>.</p>
</td></tr>
<tr><td><code id="clean_data_+3A_calcomp_params">calcomp_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>.</p>
</td></tr>
<tr><td><code id="clean_data_+3A_mlacomp_params">mlacomp_params</code></td>
<td>
<p>Named lists containing the arguments for
<code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>.</p>
</td></tr>
<tr><td><code id="clean_data_+3A_verbose">verbose</code></td>
<td>
<p>When <code>TRUE</code> it will print a message when rows are
deleted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible cleaned data list as an object.
</p>


<h3>Note</h3>

<p>This function does not write the result to file.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>See Also</h3>

<p>calculate_data_units, change_data
</p>
<p>Other sampling functions: <code><a href="#topic+sample_agecomp">sample_agecomp</a></code>,
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>, <code><a href="#topic+sample_index">sample_index</a></code>,
<code><a href="#topic+sample_lcomp">sample_lcomp</a></code>, <code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>,
<code><a href="#topic+sample_wtatage">sample_wtatage</a></code>
</p>

<hr>
<h2 id='cleanup_ss3'>Clean up after an SS3 run</h2><span id='topic+cleanup_ss3'></span>

<h3>Description</h3>

<p>Removes all of the unwanted output files from the specified
directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cleanup_ss3(dir_name, clean_vector = c("admodel.*", "ss3.eva",
  "fmin.log", "*.rpt", "variance", "ss3.b0*", "ss3.p0*", "ss3.r0*",
  "ss3.bar", "ss3.cor", "ss3.log", "ss3.rep", "checkup.sso",
  "cumreport.sso", "derived_posteriors.sso ", "echoinput.sso",
  "parmtrace.sso", "posterior_vectors.sso", "posteriors.sso",
  "rebuild.sso", "sis_table.sso", "data.ss_new", "forecast.ss_new",
  "control.ss_new", "starter.ss_new", "wtatage.ss_new"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cleanup_ss3_+3A_dir_name">dir_name</code></td>
<td>
<p>The directory of interest, the function ignores
case (i.e. names can be specified as lower or upper case)</p>
</td></tr>
<tr><td><code id="cleanup_ss3_+3A_clean_vector">clean_vector</code></td>
<td>
<p>A vector of characters specifying the unwanted
files to be removed. The function allows the use of wildcards (i.e.
&quot;*&quot;).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kelli Johnson
</p>

<hr>
<h2 id='copy_ss3models'>Copy the operating and estimation models and create a folder
structure</h2><span id='topic+copy_ss3models'></span>

<h3>Description</h3>

<p>Copy the operating and estimation models and create a folder
structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_ss3models(model_dir, scenarios, iterations = 1:100, type = c("om",
  "em"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="copy_ss3models_+3A_model_dir">model_dir</code></td>
<td>
<p>A directory containing the operating or estimation
model. Each folder should be named according to a scenario ID. (See
the vignette <code>vignette("ss3sim-vignette")</code> or
<code><a href="#topic+get_caseargs">get_caseargs</a></code> for details on the scenario ID format.)</p>
</td></tr>
<tr><td><code id="copy_ss3models_+3A_scenarios">scenarios</code></td>
<td>
<p>Which scenarios to copy to. Supply a vector of
character elements.</p>
</td></tr>
<tr><td><code id="copy_ss3models_+3A_iterations">iterations</code></td>
<td>
<p>A numeric vector of the iterations to copy to.
The function will create the folders as needed.</p>
</td></tr>
<tr><td><code id="copy_ss3models_+3A_type">type</code></td>
<td>
<p>Are you copying operating or estimation models? This
affects whether the model folder gets named &quot;om&quot; or &quot;em&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible boolean for whether that iteration already
existed. A set of nested folders starting with the scenario ID, then the
iterations, then &quot;om&quot; or &quot;em&quot;, and then the SS model files.
</p>


<h3>Author(s)</h3>

<p>Sean Anderson, Kelli Johnson
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Locate the package data:
om_folder &lt;- system.file("extdata", "models", "cod-om", package =
  "ss3sim")

# Copy the operating model:
copy_ss3models(model_dir = om_folder, type = "om", iterations =
  1:3, scenarios = "D0-F0-testing")
# Now look at your working directory in your file system

# Copy the estimation model with two scenario IDs:
copy_ss3models(model_dir = om_folder, type = "em", iterations = 1:2,
  scenarios = c("D1-F0-testing", "D2-F0-testing"))
# (Note that all the scenario argument does here is affect the
# folder names.)

# Clean up:
unlink("D0-F0-testing", recursive = TRUE)
unlink("D1-F0-testing", recursive = TRUE)
unlink("D2-F0-testing", recursive = TRUE)
</code></pre>

<hr>
<h2 id='create_argfiles'>Create template argument input files</h2><span id='topic+create_argfiles'></span>

<h3>Description</h3>

<p>Creates template input files based on the argument lists for specified
functions. Look in your working directory for the template files. Change
the case ID number (defaults to <code>0</code>) and the species identifier to a
three letter identifier. To use one of the built-in model setups, use one
of <code>cod</code>, <code>sar</code>, or <code>fla</code> for cod, sardine, or flatfish. An
example filename would be <code>M1-sar.txt</code> or <code>lcomp2-fla.txt</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_argfiles(functions = c(`lcomp0-spp` = "sample_lcomp",
  `agecomp0-spp` = "sample_agecomp", `index0-spp` = "sample_index",
  `F0-spp` = "change_f", `R0-spp` = "change_retro", `E0-spp` = "change_e",
  `X0-spp` = "change_tv"), ext = ".txt", delim = "; ",
  ignore = c("file", "dir", "make_plot"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_argfiles_+3A_functions">functions</code></td>
<td>
<p>A named vector. The names correspond to the filenames that
will get written. The values correspond to the functions to grab the
arguments from.</p>
</td></tr>
<tr><td><code id="create_argfiles_+3A_ext">ext</code></td>
<td>
<p>The file extension to create the configuration files with.
Defaults to <code>".txt"</code>.</p>
</td></tr>
<tr><td><code id="create_argfiles_+3A_delim">delim</code></td>
<td>
<p>The delimiter. Defaults to <code>"; "</code>.</p>
</td></tr>
<tr><td><code id="create_argfiles_+3A_ignore">ignore</code></td>
<td>
<p>A vector of character object of arguments to ignore in the
arguments. Found via <code>grep</code> so can be part of an argument name.</p>
</td></tr>
<tr><td><code id="create_argfiles_+3A_...">...</code></td>
<td>
<p>Anything else to pass to <code>write.table</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first column in the text files denotes the argument to be passed to a
function. The second argument denotes the value to be passed. You can use
any simple <span class="rlang"><b>R</b></span> syntax. For example: <code>c(1, 2, 4)</code>, or <code>seq(1, 100)</code>
or <code>1:100</code> or <code>matrix()</code>. Character objects don't need to be
quoted. However, be careful not to use your delimiter (set up as a
semicolon) anywhere else in the file besides to denote columns.
</p>
<p>The function <code><a href="#topic+change_tv">change_tv</a></code> is a special case. To pass arguments
to <code><a href="#topic+change_tv">change_tv</a></code> through a <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>: (1) create a
case file with an arbitrary letter not used elsewhere (anything but D, E,
F, or R) and include the line <code>function_type; change_tv</code> in your case
file. For example, you might want to use M for natural mortality, S for
selectivity, or G for growth.
</p>
<p>This function (<code>create_argfiles</code>) automatically adds a line
<code>function_type; change_tv</code> to the top of a case file <code>X0-spp.txt</code>
as a starting point for <code>change_tv</code>.
</p>


<h3>Author(s)</h3>

<p>Sean Anderson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
create_argfiles()
# Some example input lines:
#
# year1; 1990
# years; 1990:2000
# years; c(1980, 1990, 1995)
# survey_type; fishery

## End(Not run)
</code></pre>

<hr>
<h2 id='expand_scenarios'>Create vectors of scenario IDs</h2><span id='topic+expand_scenarios'></span>

<h3>Description</h3>

<p>Create vectors of scenarios from case letters, case numbers,
and species codes. Scenarios are passed to
<code><a href="#topic+run_ss3sim">run_ss3sim</a></code> and <code><a href="#topic+get_results_all">get_results_all</a></code>. 
Case letters 'D' and 'F' are mandatory and provide the data 
sampling and fishing history for the operating model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_scenarios(cases = list(D = 0, E = 0, F = 0, M = 0, R = 0),
  species = c("cod", "fla", "sar"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expand_scenarios_+3A_cases">cases</code></td>
<td>
<p>A named list of cases. The names in the list are the
case IDs and the values are the case values.</p>
</td></tr>
<tr><td><code id="expand_scenarios_+3A_species">species</code></td>
<td>
<p>Vector of 3-letter character IDs designating the
species/stock.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of scenario IDs. The case IDs will be
alphabetically sorted.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan and Sean C. Anderson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_ss3sim">run_ss3sim</a></code>, <code><a href="#topic+get_results_all">get_results_all</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expand_scenarios()
expand_scenarios(cases = list(D = 0:3, E = 0, F = 0, M = 0, R = 0),
  species = "cod")
</code></pre>

<hr>
<h2 id='facet_form'>A helper function for building a ggplot facet. Used internally by the
plotting functions.</h2><span id='topic+facet_form'></span>

<h3>Description</h3>

<p>A helper function for building a ggplot facet. Used internally by the
plotting functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>facet_form(horiz = NULL, horiz2 = NULL, vert = NULL, vert2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="facet_form_+3A_horiz">horiz</code>, <code id="facet_form_+3A_horiz2">horiz2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>horiz</code>) and second (<code>horiz2</code>) level of faceting in
the horizontal direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="facet_form_+3A_vert">vert</code>, <code id="facet_form_+3A_vert2">vert2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>vert</code>) and second (<code>vert2</code>) level of faceting in
the vertical direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A formula which can be used in <code>facet_grid</code>, or NULL if all
arguments are NULL
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>

<hr>
<h2 id='fill_across'>Fill in matrix across rows of weight-at-age data by interpolation</h2><span id='topic+fill_across'></span>

<h3>Description</h3>

<p>Function that fills in matrix across rows of wtatage data by interpolation
Missing Rows are then backfilled
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_across(mat, minYear, maxYear)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_across_+3A_mat">mat</code></td>
<td>
<p>A matrix</p>
</td></tr>
<tr><td><code id="fill_across_+3A_minyear">minYear</code></td>
<td>
<p>Minimum year</p>
</td></tr>
<tr><td><code id="fill_across_+3A_maxyear">maxYear</code></td>
<td>
<p>Maximum year</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Kuriyama and Allan Hicks
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sample_lcomp">sample_lcomp</a></code>, <code><a href="#topic+sample_agecomp">sample_agecomp</a></code>,
<code><a href="#topic+fill_across">fill_across</a></code>
</p>

<hr>
<h2 id='get_args'>Take a csv file, read it, and turn the first column into the list
names and the second column into the list values.</h2><span id='topic+get_args'></span>

<h3>Description</h3>

<p>Take a csv file, read it, and turn the first column into the list
names and the second column into the list values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_args(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_args_+3A_file">file</code></td>
<td>
<p>The file name as character</p>
</td></tr>
</table>

<hr>
<h2 id='get_bin'>Get SS3 binary/executable location in package</h2><span id='topic+get_bin'></span>

<h3>Description</h3>

<p>Get SS3 binary/executable location in package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_bin(bin_name = "ss")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_bin_+3A_bin_name">bin_name</code></td>
<td>
<p>Name of SS3 binary, defaults to &quot;ss_safe&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The path to an SS3 binary. If using the GitHub version of the
package, this will be an internal binary. Otherwise, this function
will search for a version of the binary in your path. See the
ss3sim vignette.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
get_bin()

## End(Not run)
</code></pre>

<hr>
<h2 id='get_bin_info'>Get the parameter values for change_bin</h2><span id='topic+get_bin_info'></span>

<h3>Description</h3>

<p>This function organizes arguments for other functions needed by 
<code>change_bin</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_bin_info(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_bin_info_+3A_dat">dat</code></td>
<td>
<p>A list of sample arguments from all sampling functions</p>
</td></tr>
</table>

<hr>
<h2 id='get_caseargs'>Take a scenario ID and return argument lists</h2><span id='topic+get_caseargs'></span>

<h3>Description</h3>

<p>This function calls a number of internal functions to go from a unique
scenario identifier like <code>"D1-E2-F3-M0-R4-cod"</code> and read the
corresponding input files (e.g. <code>"M0-cod.txt"</code>) that have two columns:
the first column contains the argument names and the second column contains
the argument values. The two columns should be separated by a semicolon.
The output is then returned in a named list with the intention of passing
these to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> or <code><a href="#topic+ss3sim_base">ss3sim_base</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_caseargs(folder, scenario, ext = ".txt", case_files = list(F = "F",
  D = c("index", "lcomp", "agecomp")))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_caseargs_+3A_folder">folder</code></td>
<td>
<p>The folder to look for input files in.</p>
</td></tr>
<tr><td><code id="get_caseargs_+3A_scenario">scenario</code></td>
<td>
<p>A character object that has the cases separated by the &quot;-&quot;
delimiter. The combination of cases and stock ID is referred to as a
scenario. E.g. <code>"D0-E0-F0-M0-R0-cod"</code>. See the Details section.</p>
</td></tr>
<tr><td><code id="get_caseargs_+3A_ext">ext</code></td>
<td>
<p>The file extension of the input files. Defaults to
<code>".txt"</code>.</p>
</td></tr>
<tr><td><code id="get_caseargs_+3A_case_files">case_files</code></td>
<td>
<p>A named list that relates the case IDs (e.g. <code>"D"</code>)
to the files to read the arguments from (e.g. <code>c("index", "lcomp",
"agecomp")</code>). See the Details section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let's start with an example scenario <code>"D0-E1-F0-M0-R0-cod"</code>.
The single capital letters refer to case IDs. The numbers refer to the case
numbers. The last block of text (<code>cod</code>) represents the stock ID (any
alphanumeric string of text will work) and is to help the user identify
different &quot;stocks&quot; (intended to represent different SS3 model setups).
</p>
<p>The stock IDs should correspond to how the case files are named and the
case IDs should correspond to the cases described by the <code>case_files</code>.
The case file names will correspond to the list values plus the stock ID.
For example <code>list(D = c("index", "lcomp", "agecomp"))</code> combined with
the stock ID <code>cod</code> means that the case <code>D1</code> will refer to the
case files <code>index-cod.txt, lcomp-cod.txt, agecomp-cod.txt</code>.
</p>
<p>The case argument plain text files should have arguments in the first
column that should be passed on to functions. The names should match
exactly. The second column (delimited by a semicolon) should contain the
values to be passed to those arguments. Multiple words should be enclosed
in quotes.
</p>
<p>You can use any simple <span class="rlang"><b>R</b></span> syntax to declare argument values. For example:
<code>c(1, 2, 4)</code>, or <code>seq(1, 100)</code>, or <code>1:100</code>, or
<code>matrix()</code>, or <code>NULL</code>. Character objects don't need to be quoted,
but can be if you'd like. However, be careful not to use the delimiter (set
up as a semicolon) anywhere else in the file besides to denote columns. You
can add comments after any <code>#</code> symbol just like in R.
</p>
<p>Internally, the functions evaluate in <span class="rlang"><b>R</b></span> any entries that have no
character values (e.g. <code>1:100</code>), or have an alpha-numeric character
followed by a <code>(</code>. Anything that is character only or has character
mixed with numeric but doesn't have the regular expression
<code>"[A-Za-z0-9]("</code> gets turned into a character argument. (<code>NA</code> and
<code>NULL</code> are special cases that are also passed on directly.)
</p>


<h3>Value</h3>

<p>A (nested) named list. The first level of the named list refers to
the <code>case_files</code>. The second level of the named list refers to the
argument names (the first column in the input text files). The contents of
the list are the argument values themselves (the second column of the input
text files).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Find the example data folders:
case_folder &lt;- system.file("extdata", "eg-cases", package =
  "ss3sim")

# An example using the cases defined by default:
get_caseargs(case_folder, scenario = "D0-F0-cod")

# With a custom time-varying case for selectivity, which we'll call
# the S case. Here, we'll need to define which file the case S should
# read from ("S*-cod.txt"):
get_caseargs(case_folder, scenario = "D0-E0-F0-M0-R0-S0-cod",
  case_files = list(E = "E", D = c("index", "lcomp", "agecomp"), F =
    "F", M = "M", R = "retro", S = "S"))
</code></pre>

<hr>
<h2 id='get_caseval'>Take a scenario ID and a case type and return the case number</h2><span id='topic+get_caseval'></span>

<h3>Description</h3>

<p>Take a scenario ID and a case type and return the case number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_caseval(scenario, case)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_caseval_+3A_scenario">scenario</code></td>
<td>
<p>A character object with the cases. E.g.
<code>"M1-F1-D1-R1"</code></p>
</td></tr>
<tr><td><code id="get_caseval_+3A_case">case</code></td>
<td>
<p>The case you want to extract. E.g. <code>"M"</code></p>
</td></tr>
</table>

<hr>
<h2 id='get_fish600_casefolder'>Get the folder location of the FISH600 case files</h2><span id='topic+get_fish600_casefolder'></span>

<h3>Description</h3>

<p>This function is used by some developers of <span class="pkg">ss3sim</span> for simulations. This
function links to the &quot;cases&quot; folder in <code>extdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fish600_casefolder()
</code></pre>


<h3>Value</h3>

<p>A character object showing the location of the FISH600 case
files in the package <code>extdata</code> folder.
</p>

<hr>
<h2 id='get_model_folder'>Get the folder location of an included SS3 model configuration</h2><span id='topic+get_model_folder'></span>

<h3>Description</h3>

<p>This function returns the location of one of the built-in model
configurations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_model_folder(folder_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_model_folder_+3A_folder_name">folder_name</code></td>
<td>
<p>The model folder name. One of <code>"cod-om", "cod-em",
"fla-om", "fla-em", "sar-om", "sar-em"</code> representing cod, flatfish, and
sardine-like model configurations and operating (om) and estimating model
(em) varieties. See the <span class="pkg">ss3sim</span> paper or vignette for further details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character object showing the location of the appropriate model
configuration folder in the package <code>extdata</code> folder.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_model_folder("cod-em")
</code></pre>

<hr>
<h2 id='get_nll_components'>Get negative log likelihood (NLL) values from a report file list</h2><span id='topic+get_nll_components'></span>

<h3>Description</h3>

<p>Get negative log likelihood (NLL) values from a report file list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_nll_components(report.file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_nll_components_+3A_report.file">report.file</code></td>
<td>
<p>An <code><a href="r4ss.html#topic+SS_output">SS_output</a></code> list for a model
(operating model or estimation model).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Merrill Rudd
</p>

<hr>
<h2 id='get_recdevs'>Return a set of recruitment deviations</h2><span id='topic+get_recdevs'></span>

<h3>Description</h3>

<p>This function returns a set of pseudo-random recruitment deviations based
on an iteration number. Given the same iteration number the function will
return the same recruitment deviations. The deviations are standard normal.
I.e., they have a mean of 0 and a standard deviation of 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_recdevs(iteration, n, seed = 21)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_recdevs_+3A_iteration">iteration</code></td>
<td>
<p>The iteration number. This is used as an ID to set the
random number seed.</p>
</td></tr>
<tr><td><code id="get_recdevs_+3A_n">n</code></td>
<td>
<p>The length of the vector returned.</p>
</td></tr>
<tr><td><code id="get_recdevs_+3A_seed">seed</code></td>
<td>
<p>An integer value to pass to <code><a href="base.html#topic+set.seed">set.seed</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of standard normal recruitment deviations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_recdevs(1, 10)
get_recdevs(1, 10)
get_recdevs(2, 10)
</code></pre>

<hr>
<h2 id='get_results_all'>Extract SS3 simulation output</h2><span id='topic+get_results_all'></span>

<h3>Description</h3>

<p>This high level function extracts results from SS3 model runs. Give it a
directory which contains directories for different &quot;scenario&quot; runs, within
which are iterations. It writes two data.frames to file:
one for single scalar values (e.g., MSY) and a second
that contains output for each year of the same model (timeseries, e.g.,
biomass(year)). These can always be joined later.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_results_all(directory = getwd(), overwrite_files = FALSE,
  user_scenarios = NULL, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_results_all_+3A_directory">directory</code></td>
<td>
<p>The directory which contains scenario folders with
results.</p>
</td></tr>
<tr><td><code id="get_results_all_+3A_overwrite_files">overwrite_files</code></td>
<td>
<p>A switch to determine if existing files should be
overwritten, useful for testing purposes or if new iterations are run.</p>
</td></tr>
<tr><td><code id="get_results_all_+3A_user_scenarios">user_scenarios</code></td>
<td>
<p>A character vector of scenarios that should be read
in. Default is <code>NULL</code>, which indicates find all scenario folders in
<code>directory</code>.</p>
</td></tr>
<tr><td><code id="get_results_all_+3A_parallel">parallel</code></td>
<td>
<p>Should the function be run on multiple cores? You will
need to set up parallel processing as shown in <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates two .csv files in the current working directory:
<code>ss3sim_ts.csv</code> and <code>ss3sim_scalar.csv</code>.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan, Merrill Rudd
</p>


<h3>See Also</h3>

<p>Other get-results: <code><a href="#topic+get_results_derived">get_results_derived</a></code>,
<code><a href="#topic+get_results_scalar">get_results_scalar</a></code>,
<code><a href="#topic+get_results_scenario">get_results_scenario</a></code>,
<code><a href="#topic+get_results_timeseries">get_results_timeseries</a></code>
</p>

<hr>
<h2 id='get_results_derived'>Extract time series from a model run with the associated standard deviation.</h2><span id='topic+get_results_derived'></span>

<h3>Description</h3>

<p>Extract time series from an <code><a href="r4ss.html#topic+SS_output">SS_output</a></code> list from a model run.
Returns a data.frame of the results for SSB, recruitment,
forecasts, and effort by year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_results_derived(report.file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_results_derived_+3A_report.file">report.file</code></td>
<td>
<p>An <code><a href="r4ss.html#topic+SS_output">SS_output</a></code> list for a model
(operating model or estimation model).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kelli Johnson
</p>


<h3>See Also</h3>

<p>Other get-results: <code><a href="#topic+get_results_all">get_results_all</a></code>,
<code><a href="#topic+get_results_scalar">get_results_scalar</a></code>,
<code><a href="#topic+get_results_scenario">get_results_scenario</a></code>,
<code><a href="#topic+get_results_timeseries">get_results_timeseries</a></code>
</p>

<hr>
<h2 id='get_results_scalar'>Extract scalar quantities from a model run.</h2><span id='topic+get_results_scalar'></span>

<h3>Description</h3>

<p>Extract scalar quantities from an <code><a href="r4ss.html#topic+SS_output">SS_output</a></code> list from a model run.
Returns a data.frame of the results (a single row) which can be rbinded later.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_results_scalar(report.file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_results_scalar_+3A_report.file">report.file</code></td>
<td>
<p>An <code><a href="r4ss.html#topic+SS_output">SS_output</a></code> list for a model
(operating model or estimation model).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cole Monnahan; Merrill Rudd
</p>


<h3>See Also</h3>

<p>Other get-results: <code><a href="#topic+get_results_all">get_results_all</a></code>,
<code><a href="#topic+get_results_derived">get_results_derived</a></code>,
<code><a href="#topic+get_results_scenario">get_results_scenario</a></code>,
<code><a href="#topic+get_results_timeseries">get_results_timeseries</a></code>
</p>

<hr>
<h2 id='get_results_scenario'>Extract SS3 simulation results for one scenario.</h2><span id='topic+get_results_scenario'></span>

<h3>Description</h3>

<p>Function that extracts results from all iterations inside a supplied
scenario folder. The function writes 3 .csv files to the scenario
folder: (1) scalar metrics with one value per iteration (e.g. <code class="reqn">R_0</code>,
<code class="reqn">h</code>), (2) a timeseries data ('ts') which contains multiple values per
iteration (e.g.  <code class="reqn">SSB_y</code> for a range of years <code class="reqn">y</code>), and (3) [currently
disabled and not tested] residuals on the log scale from the surveys
across all iterations. The function <code>get_results_all</code> loops through
these .csv files and combines them together into a single &quot;final&quot;
dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_results_scenario(scenario, directory = getwd(),
  overwrite_files = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_results_scenario_+3A_scenario">scenario</code></td>
<td>
<p>A single character giving the scenario from which to
extract results.</p>
</td></tr>
<tr><td><code id="get_results_scenario_+3A_directory">directory</code></td>
<td>
<p>The directory which contains the scenario folder.</p>
</td></tr>
<tr><td><code id="get_results_scenario_+3A_overwrite_files">overwrite_files</code></td>
<td>
<p>A boolean (default is <code>FALSE</code>) for whether to delete
any files previously created with this function. This is intended to be
used if iterations were added since the last time it was called, or any
changes were made to this function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>See Also</h3>

<p>Other get-results: <code><a href="#topic+get_results_all">get_results_all</a></code>,
<code><a href="#topic+get_results_derived">get_results_derived</a></code>,
<code><a href="#topic+get_results_scalar">get_results_scalar</a></code>,
<code><a href="#topic+get_results_timeseries">get_results_timeseries</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
d &lt;- system.file("extdata", package = "ss3sim")
case_folder &lt;- file.path(d, "eg-cases")
om &lt;- file.path(d, "models", "cod-om")
em &lt;- file.path(d, "models", "cod-em")
run_ss3sim(iterations = 1:2, scenarios =
  c("D0-F0-cod"),
  case_folder = case_folder, om_dir = om, em_dir = em,
  case_files = list(F = "F",
                    D = c("index", "lcomp", "agecomp")),
  bias_adjust = FALSE)
get_results_scenario(c("D0-F0-cod"), overwrite_files = TRUE)

#clean up
unlink("D0-F0-cod", recursive = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_results_timeseries'>Extract time series from a model run.</h2><span id='topic+get_results_timeseries'></span>

<h3>Description</h3>

<p>Extract time series from an <code><a href="r4ss.html#topic+SS_output">SS_output</a></code> list from a model run.
Returns a data.frame of the results for SSB, recruitment and effort by year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_results_timeseries(report.file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_results_timeseries_+3A_report.file">report.file</code></td>
<td>
<p>An <code><a href="r4ss.html#topic+SS_output">SS_output</a></code> list for a model
(operating model or estimation model).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>See Also</h3>

<p>Other get-results: <code><a href="#topic+get_results_all">get_results_all</a></code>,
<code><a href="#topic+get_results_derived">get_results_derived</a></code>,
<code><a href="#topic+get_results_scalar">get_results_scalar</a></code>,
<code><a href="#topic+get_results_scenario">get_results_scenario</a></code>
</p>

<hr>
<h2 id='get_sigmar'>Get Variability About Recruitment Deviations (<code class="reqn">\sigma_R</code>)</h2><span id='topic+get_sigmar'></span>

<h3>Description</h3>

<p>Use the name of the operating model to open the ctl file and obtain the 
INIT value for sigmaR (recruitment deviations sigma)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sigmar(om)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_sigmar_+3A_om">om</code></td>
<td>
<p>The name of the operating model, which should be the prefix of
the <code>.ctl</code> file, e.g., &quot;myOM&quot;.
A full directory can be specified with the the prefix of the file name but
leaving off the '.ctl' portion.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kelli Johnson
</p>

<hr>
<h2 id='get_ss_ver_dl'>Get the ss version (either 3.24 or 3.30) from a <code>dat_list</code> list.</h2><span id='topic+get_ss_ver_dl'></span>

<h3>Description</h3>

<p># Get the SS version from a list <code>dat_list</code> that was a
originally read in using <code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ss_ver_dl(dat_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_ss_ver_dl_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='get_ss_ver_file'>Get the ss version (either 3.24 or 3.30) from an ss file</h2><span id='topic+get_ss_ver_file'></span>

<h3>Description</h3>

<p># Get the SS version from the top line in an SS file.
as done in <code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ss_ver_file(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_ss_ver_file_+3A_file">file</code></td>
<td>
<p>Input SS3 control file, either a starter, control, or data SS file.</p>
</td></tr>
</table>

<hr>
<h2 id='id_scenarios'>Identify ss3sim scenarios within a directory</h2><span id='topic+id_scenarios'></span>

<h3>Description</h3>

<p>Identify ss3sim scenarios within a directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>id_scenarios(directory)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="id_scenarios_+3A_directory">directory</code></td>
<td>
<p>The directory which contains scenario folders with
results.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of folders
</p>


<h3>Author(s)</h3>

<p>Merrill Rudd
</p>

<hr>
<h2 id='plot_scalar_boxplot'>Print scalar values as boxplots.</h2><span id='topic+plot_scalar_boxplot'></span>

<h3>Description</h3>

<p>Print scalar values as boxplots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_scalar_boxplot(data, x, y, horiz = NULL, horiz2 = NULL,
  vert = NULL, vert2 = NULL, relative.error = FALSE,
  axes.free = TRUE, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_scalar_boxplot_+3A_data">data</code></td>
<td>
<p>A valid data frame containing scalar or timeseries values
from a <span class="pkg">ss3sim</span> simulation. That data are generated from
<code><a href="#topic+get_results_all">get_results_all</a></code>.</p>
</td></tr>
<tr><td><code id="plot_scalar_boxplot_+3A_x">x</code></td>
<td>
<p>A character string denoting which column to use as the x variable.
Column should be a factor (e.g. &quot;F&quot; or &quot;species&quot;).</p>
</td></tr>
<tr><td><code id="plot_scalar_boxplot_+3A_y">y</code></td>
<td>
<p>A character string denoting which column to use as the y
variable. Must be a numeric column.</p>
</td></tr>
<tr><td><code id="plot_scalar_boxplot_+3A_horiz">horiz</code>, <code id="plot_scalar_boxplot_+3A_horiz2">horiz2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>horiz</code>) and second (<code>horiz2</code>) level of faceting in
the horizontal direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_scalar_boxplot_+3A_vert">vert</code>, <code id="plot_scalar_boxplot_+3A_vert2">vert2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>vert</code>) and second (<code>vert2</code>) level of faceting in
the vertical direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_scalar_boxplot_+3A_relative.error">relative.error</code></td>
<td>
<p>Boolean for whether the y-axis should be
interpreted as relative error. If <code>TRUE</code>, <code>ylim</code> is set to
<code>c(-1,1)</code>, the y axis label is changed automatically, and a
red line at y=0 is added.</p>
</td></tr>
<tr><td><code id="plot_scalar_boxplot_+3A_axes.free">axes.free</code></td>
<td>
<p>Boolean for whether the y-axis scales should be free
in <code>facet_grid</code>.</p>
</td></tr>
<tr><td><code id="plot_scalar_boxplot_+3A_print">print</code></td>
<td>
<p>A logical for whether the plot is printed or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <span class="pkg">ss3sim</span> plotting functions are simply
wrappers for <span class="pkg">ggplot2</span> code, specific to the output from
<span class="pkg">ss3sim</span> simulation scalar and timeseries (ts) objects. They are
designed to quickly explore simulation output, rather than
publication-level figures. The functions use the <code>aes_string</code>
function within <span class="pkg">ggplot2</span> such that arguments are passed as
characters that refer to columns of <code>data</code>.
</p>
<p>Note that there are some subtle differences between the
functions. Scalar plots require a value for <code>x</code>, while for ts plots
<code>x</code> is invalid because it is fixed internally as 'year', since it
makes no sense to use another column. Boxplots cannot have a color
mapped to them like points or lines, and thus <code>color</code> is not a
valid argument. The ts point and line plots are grouped internally by
'ID', which is a combination of scenario and iteration.
</p>


<h3>Output</h3>

<p>These functions print the <code>ggplot</code> object, but
also return it invisibly for saving or printing again later.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>scalar_dat$depletion &lt;- with(scalar_dat,
  (depletion_om - depletion_em) / depletion_om)
plot_scalar_boxplot(scalar_dat, x = "E", y = "depletion", horiz = "D",
  relative.error = TRUE)
</code></pre>

<hr>
<h2 id='plot_scalar_points'>Plot scalar values as points.</h2><span id='topic+plot_scalar_points'></span>

<h3>Description</h3>

<p>Plot scalar values as points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_scalar_points(data, x, y, horiz = NULL, horiz2 = NULL,
  vert = NULL, vert2 = NULL, color = NULL, relative.error = FALSE,
  axes.free = TRUE, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_scalar_points_+3A_data">data</code></td>
<td>
<p>A valid data frame containing scalar or timeseries values
from a <span class="pkg">ss3sim</span> simulation. That data are generated from
<code><a href="#topic+get_results_all">get_results_all</a></code>.</p>
</td></tr>
<tr><td><code id="plot_scalar_points_+3A_x">x</code></td>
<td>
<p>A character string denoting which column to use as the x variable.
Column should be a factor (e.g. &quot;F&quot; or &quot;species&quot;).</p>
</td></tr>
<tr><td><code id="plot_scalar_points_+3A_y">y</code></td>
<td>
<p>A character string denoting which column to use as the y
variable. Must be a numeric column.</p>
</td></tr>
<tr><td><code id="plot_scalar_points_+3A_horiz">horiz</code>, <code id="plot_scalar_points_+3A_horiz2">horiz2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>horiz</code>) and second (<code>horiz2</code>) level of faceting in
the horizontal direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_scalar_points_+3A_vert">vert</code>, <code id="plot_scalar_points_+3A_vert2">vert2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>vert</code>) and second (<code>vert2</code>) level of faceting in
the vertical direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_scalar_points_+3A_color">color</code></td>
<td>
<p>A character string denoting which column to use to map
color. Not valid for boxplot functions. Useful for looking at EM
performance criteria against other dimensions of the EM or OM. See
example below for how to merge in a metric from a scalar dataset to a ts
dataset.</p>
</td></tr>
<tr><td><code id="plot_scalar_points_+3A_relative.error">relative.error</code></td>
<td>
<p>Boolean for whether the y-axis should be
interpreted as relative error. If <code>TRUE</code>, <code>ylim</code> is set to
<code>c(-1,1)</code>, the y axis label is changed automatically, and a
red line at y=0 is added.</p>
</td></tr>
<tr><td><code id="plot_scalar_points_+3A_axes.free">axes.free</code></td>
<td>
<p>Boolean for whether the y-axis scales should be free
in <code>facet_grid</code>.</p>
</td></tr>
<tr><td><code id="plot_scalar_points_+3A_print">print</code></td>
<td>
<p>A logical for whether the plot is printed or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <span class="pkg">ss3sim</span> plotting functions are simply
wrappers for <span class="pkg">ggplot2</span> code, specific to the output from
<span class="pkg">ss3sim</span> simulation scalar and timeseries (ts) objects. They are
designed to quickly explore simulation output, rather than
publication-level figures. The functions use the <code>aes_string</code>
function within <span class="pkg">ggplot2</span> such that arguments are passed as
characters that refer to columns of <code>data</code>.
</p>
<p>Note that there are some subtle differences between the
functions. Scalar plots require a value for <code>x</code>, while for ts plots
<code>x</code> is invalid because it is fixed internally as 'year', since it
makes no sense to use another column. Boxplots cannot have a color
mapped to them like points or lines, and thus <code>color</code> is not a
valid argument. The ts point and line plots are grouped internally by
'ID', which is a combination of scenario and iteration.
</p>


<h3>Output</h3>

<p>These functions print the <code>ggplot</code> object, but
also return it invisibly for saving or printing again later.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>scalar_dat$depletion &lt;- with(scalar_dat,
  (depletion_om - depletion_em) / depletion_om)
plot_scalar_points(scalar_dat, x = "E", y = "depletion", horiz = 'D',
  color = "max_grad", relative.error = TRUE)
</code></pre>

<hr>
<h2 id='plot_ts_boxplot'>Plot timeseries values as boxplots.</h2><span id='topic+plot_ts_boxplot'></span>

<h3>Description</h3>

<p>Plot timeseries values as boxplots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ts_boxplot(data, y, horiz = NULL, horiz2 = NULL, vert = NULL,
  vert2 = NULL, relative.error = FALSE, axes.free = TRUE,
  print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ts_boxplot_+3A_data">data</code></td>
<td>
<p>A valid data frame containing scalar or timeseries values
from a <span class="pkg">ss3sim</span> simulation. That data are generated from
<code><a href="#topic+get_results_all">get_results_all</a></code>.</p>
</td></tr>
<tr><td><code id="plot_ts_boxplot_+3A_y">y</code></td>
<td>
<p>A character string denoting which column to use as the y
variable. Must be a numeric column.</p>
</td></tr>
<tr><td><code id="plot_ts_boxplot_+3A_horiz">horiz</code>, <code id="plot_ts_boxplot_+3A_horiz2">horiz2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>horiz</code>) and second (<code>horiz2</code>) level of faceting in
the horizontal direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_ts_boxplot_+3A_vert">vert</code>, <code id="plot_ts_boxplot_+3A_vert2">vert2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>vert</code>) and second (<code>vert2</code>) level of faceting in
the vertical direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_ts_boxplot_+3A_relative.error">relative.error</code></td>
<td>
<p>Boolean for whether the y-axis should be
interpreted as relative error. If <code>TRUE</code>, <code>ylim</code> is set to
<code>c(-1,1)</code>, the y axis label is changed automatically, and a
red line at y=0 is added.</p>
</td></tr>
<tr><td><code id="plot_ts_boxplot_+3A_axes.free">axes.free</code></td>
<td>
<p>Boolean for whether the y-axis scales should be free
in <code>facet_grid</code>.</p>
</td></tr>
<tr><td><code id="plot_ts_boxplot_+3A_print">print</code></td>
<td>
<p>A logical for whether the plot is printed or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <span class="pkg">ss3sim</span> plotting functions are simply
wrappers for <span class="pkg">ggplot2</span> code, specific to the output from
<span class="pkg">ss3sim</span> simulation scalar and timeseries (ts) objects. They are
designed to quickly explore simulation output, rather than
publication-level figures. The functions use the <code>aes_string</code>
function within <span class="pkg">ggplot2</span> such that arguments are passed as
characters that refer to columns of <code>data</code>.
</p>
<p>Note that there are some subtle differences between the
functions. Scalar plots require a value for <code>x</code>, while for ts plots
<code>x</code> is invalid because it is fixed internally as 'year', since it
makes no sense to use another column. Boxplots cannot have a color
mapped to them like points or lines, and thus <code>color</code> is not a
valid argument. The ts point and line plots are grouped internally by
'ID', which is a combination of scenario and iteration.
</p>


<h3>Output</h3>

<p>These functions print the <code>ggplot</code> object, but
also return it invisibly for saving or printing again later.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ts_dat$SpawnBio &lt;- with(ts_dat, (SpawnBio_om-SpawnBio_em)/SpawnBio_om)
# Merge in max_grad, a performance metric, to use for color
ts_dat &lt;- merge(scalar_dat[, c("ID", "max_grad")], ts_dat)
plot_ts_boxplot(ts_dat, y = "SpawnBio", horiz = "D", vert = "E",
  relative.error = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_ts_lines'>Plot timeseries values as lines.</h2><span id='topic+plot_ts_lines'></span>

<h3>Description</h3>

<p>Plot timeseries values as lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ts_lines(data, y, horiz = NULL, horiz2 = NULL, vert = NULL,
  vert2 = NULL, relative.error = FALSE, color = NULL,
  axes.free = TRUE, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ts_lines_+3A_data">data</code></td>
<td>
<p>A valid data frame containing scalar or timeseries values
from a <span class="pkg">ss3sim</span> simulation. That data are generated from
<code><a href="#topic+get_results_all">get_results_all</a></code>.</p>
</td></tr>
<tr><td><code id="plot_ts_lines_+3A_y">y</code></td>
<td>
<p>A character string denoting which column to use as the y
variable. Must be a numeric column.</p>
</td></tr>
<tr><td><code id="plot_ts_lines_+3A_horiz">horiz</code>, <code id="plot_ts_lines_+3A_horiz2">horiz2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>horiz</code>) and second (<code>horiz2</code>) level of faceting in
the horizontal direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_ts_lines_+3A_vert">vert</code>, <code id="plot_ts_lines_+3A_vert2">vert2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>vert</code>) and second (<code>vert2</code>) level of faceting in
the vertical direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_ts_lines_+3A_relative.error">relative.error</code></td>
<td>
<p>Boolean for whether the y-axis should be
interpreted as relative error. If <code>TRUE</code>, <code>ylim</code> is set to
<code>c(-1,1)</code>, the y axis label is changed automatically, and a
red line at y=0 is added.</p>
</td></tr>
<tr><td><code id="plot_ts_lines_+3A_color">color</code></td>
<td>
<p>A character string denoting which column to use to map
color. Not valid for boxplot functions. Useful for looking at EM
performance criteria against other dimensions of the EM or OM. See
example below for how to merge in a metric from a scalar dataset to a ts
dataset.</p>
</td></tr>
<tr><td><code id="plot_ts_lines_+3A_axes.free">axes.free</code></td>
<td>
<p>Boolean for whether the y-axis scales should be free
in <code>facet_grid</code>.</p>
</td></tr>
<tr><td><code id="plot_ts_lines_+3A_print">print</code></td>
<td>
<p>A logical for whether the plot is printed or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <span class="pkg">ss3sim</span> plotting functions are simply
wrappers for <span class="pkg">ggplot2</span> code, specific to the output from
<span class="pkg">ss3sim</span> simulation scalar and timeseries (ts) objects. They are
designed to quickly explore simulation output, rather than
publication-level figures. The functions use the <code>aes_string</code>
function within <span class="pkg">ggplot2</span> such that arguments are passed as
characters that refer to columns of <code>data</code>.
</p>
<p>Note that there are some subtle differences between the
functions. Scalar plots require a value for <code>x</code>, while for ts plots
<code>x</code> is invalid because it is fixed internally as 'year', since it
makes no sense to use another column. Boxplots cannot have a color
mapped to them like points or lines, and thus <code>color</code> is not a
valid argument. The ts point and line plots are grouped internally by
'ID', which is a combination of scenario and iteration.
</p>


<h3>Output</h3>

<p>These functions print the <code>ggplot</code> object, but
also return it invisibly for saving or printing again later.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ts_dat$SpawnBio &lt;- with(ts_dat, (SpawnBio_om-SpawnBio_em)/SpawnBio_om)
# Merge in max_grad, a performance metric, to use for color
ts_dat &lt;- merge(scalar_dat[, c("ID", "max_grad")], ts_dat)
plot_ts_lines(ts_dat, y = "SpawnBio", horiz = "D", vert = "E",
  relative.error = TRUE, color = "max_grad")
</code></pre>

<hr>
<h2 id='plot_ts_points'>Plot timeseries values as points.</h2><span id='topic+plot_ts_points'></span>

<h3>Description</h3>

<p>Plot timeseries values as points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ts_points(data, y, horiz = NULL, horiz2 = NULL, vert = NULL,
  vert2 = NULL, relative.error = FALSE, color = NULL,
  axes.free = TRUE, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ts_points_+3A_data">data</code></td>
<td>
<p>A valid data frame containing scalar or timeseries values
from a <span class="pkg">ss3sim</span> simulation. That data are generated from
<code><a href="#topic+get_results_all">get_results_all</a></code>.</p>
</td></tr>
<tr><td><code id="plot_ts_points_+3A_y">y</code></td>
<td>
<p>A character string denoting which column to use as the y
variable. Must be a numeric column.</p>
</td></tr>
<tr><td><code id="plot_ts_points_+3A_horiz">horiz</code>, <code id="plot_ts_points_+3A_horiz2">horiz2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>horiz</code>) and second (<code>horiz2</code>) level of faceting in
the horizontal direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_ts_points_+3A_vert">vert</code>, <code id="plot_ts_points_+3A_vert2">vert2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>vert</code>) and second (<code>vert2</code>) level of faceting in
the vertical direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="plot_ts_points_+3A_relative.error">relative.error</code></td>
<td>
<p>Boolean for whether the y-axis should be
interpreted as relative error. If <code>TRUE</code>, <code>ylim</code> is set to
<code>c(-1,1)</code>, the y axis label is changed automatically, and a
red line at y=0 is added.</p>
</td></tr>
<tr><td><code id="plot_ts_points_+3A_color">color</code></td>
<td>
<p>A character string denoting which column to use to map
color. Not valid for boxplot functions. Useful for looking at EM
performance criteria against other dimensions of the EM or OM. See
example below for how to merge in a metric from a scalar dataset to a ts
dataset.</p>
</td></tr>
<tr><td><code id="plot_ts_points_+3A_axes.free">axes.free</code></td>
<td>
<p>Boolean for whether the y-axis scales should be free
in <code>facet_grid</code>.</p>
</td></tr>
<tr><td><code id="plot_ts_points_+3A_print">print</code></td>
<td>
<p>A logical for whether the plot is printed or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <span class="pkg">ss3sim</span> plotting functions are simply
wrappers for <span class="pkg">ggplot2</span> code, specific to the output from
<span class="pkg">ss3sim</span> simulation scalar and timeseries (ts) objects. They are
designed to quickly explore simulation output, rather than
publication-level figures. The functions use the <code>aes_string</code>
function within <span class="pkg">ggplot2</span> such that arguments are passed as
characters that refer to columns of <code>data</code>.
</p>
<p>Note that there are some subtle differences between the
functions. Scalar plots require a value for <code>x</code>, while for ts plots
<code>x</code> is invalid because it is fixed internally as 'year', since it
makes no sense to use another column. Boxplots cannot have a color
mapped to them like points or lines, and thus <code>color</code> is not a
valid argument. The ts point and line plots are grouped internally by
'ID', which is a combination of scenario and iteration.
</p>


<h3>Output</h3>

<p>These functions print the <code>ggplot</code> object, but
also return it invisibly for saving or printing again later.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ts_dat$SpawnBio &lt;- with(ts_dat, (SpawnBio_om-SpawnBio_em)/SpawnBio_om)
# Merge in max_grad, a performance metric, to use for color
ts_dat &lt;- merge(scalar_dat[, c("ID", "max_grad")], ts_dat)
plot_ts_points(ts_dat, y = "SpawnBio", horiz = "D", vert = "E",
  relative.error = TRUE, color = "max_grad")
</code></pre>

<hr>
<h2 id='profile_fmsy'>Determine Fmsy for a given operating model</h2><span id='topic+profile_fmsy'></span>

<h3>Description</h3>

<p>Runs an operating model over a range of fishing mortality (F) levels to
determine the F at maximum sustainable yield (Fmsy).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profile_fmsy(om_in, results_out, start = 0, end = 1.5, by_val = 0.01,
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile_fmsy_+3A_om_in">om_in</code></td>
<td>
<p>A full or relative path to a directory that contains an
<span class="pkg">ss3sim</span> operating model.</p>
</td></tr>
<tr><td><code id="profile_fmsy_+3A_results_out">results_out</code></td>
<td>
<p>A full or relative path to a directory where the results
will be saved. The directory will be created if it doesn't already exist.</p>
</td></tr>
<tr><td><code id="profile_fmsy_+3A_start">start</code></td>
<td>
<p>Lower fishing mortality levels that will be explored.</p>
</td></tr>
<tr><td><code id="profile_fmsy_+3A_end">end</code></td>
<td>
<p>Upper fishing mortality levels that will be explored.</p>
</td></tr>
<tr><td><code id="profile_fmsy_+3A_by_val">by_val</code></td>
<td>
<p>Interval at which F will be incremented between <code>start</code>
and <code>end</code>.</p>
</td></tr>
<tr><td><code id="profile_fmsy_+3A_verbose">verbose</code></td>
<td>
<p>When <code>TRUE</code> messages will be returned
from the function. Often useful for debugging. The default
is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function extracts the number of years from the data
file and then runs the model with a constant level of fishing for each year,
extracting the catch in the last year. This assumes the length of the
model is long enough to reach an equilibrium catch. The user is
responsible for ensuring this fact. If the function is run with
<code>verbose = TRUE</code>, which is not the default, users will be provided
with coefficient of variations of the catches in the terminal years of
the model. Here, terminal is defined as half as many years as there are
ages in the population dynamics of your model.
Thus, if the population plus group starts at age twenty,
then the standard deviation of the last ten years of catch
divided by the mean catch over that same time will be printed to the
screen for each model that is ran. For the default cod model provided within
the package, the CV is less than 1e-04 for all F levels explored.
</p>
<p>Ensure that the argument <code>om_in</code> leads to an operating model that is
configured for use within <span class="pkg">ss3sim</span>. For example, the F type must
allow for an input vector of Fs rather than catches, along with other
specifications.
</p>


<h3>Value</h3>

<p>Creates a plot and a table with catches and F values.
Also, invisibly returns a table of F and catch as a data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  d &lt;- system.file("extdata", "models", "cod-om", package = "ss3sim")
  fmsy.val &lt;- profile_fmsy(om_in = d, results_out = "fmsy",
    start = 0.1, end = 0.2, by_val = 0.05)
  #cleanup
  unlink("fmsy", recursive = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='remove_CPUE'>Remove a q setup line into an SS control file</h2><span id='topic+remove_CPUE'></span>

<h3>Description</h3>

<p>This function removesa q setup line from a SS 3.30 control file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_CPUE(string, ctl.in, ctl.out, dat.in, dat.out, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remove_CPUE_+3A_string">string</code></td>
<td>
<p>A string with the fleetname to remove.</p>
</td></tr>
<tr><td><code id="remove_CPUE_+3A_ctl.in">ctl.in</code></td>
<td>
<p>An SS control file name to read in.</p>
</td></tr>
<tr><td><code id="remove_CPUE_+3A_ctl.out">ctl.out</code></td>
<td>
<p>The SS control file to read out.</p>
</td></tr>
<tr><td><code id="remove_CPUE_+3A_dat.in">dat.in</code></td>
<td>
<p>An SS data file name to read in.</p>
</td></tr>
<tr><td><code id="remove_CPUE_+3A_dat.out">dat.out</code></td>
<td>
<p>An SS data file name to read out.</p>
</td></tr>
<tr><td><code id="remove_CPUE_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. Overwrite an existing file with the same name as
<code>ctl.out</code> or <code>data.out</code>?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified SS control file.
</p>


<h3>Author(s)</h3>

<p>Kelli Johnson
</p>

<hr>
<h2 id='remove_q_ctl'>Remove a q setup line into an SS control file only</h2><span id='topic+remove_q_ctl'></span>

<h3>Description</h3>

<p>This function removesa q setup line from a SS 3.30 control file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_q_ctl(string, ctl.in, filename = TRUE, ctl.out,
  overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remove_q_ctl_+3A_string">string</code></td>
<td>
<p>A string with the fleetname to remove.</p>
</td></tr>
<tr><td><code id="remove_q_ctl_+3A_ctl.in">ctl.in</code></td>
<td>
<p>An SS control file name to read in if filename = TRUE otherwise
an SS control file vector already read using readLines()</p>
</td></tr>
<tr><td><code id="remove_q_ctl_+3A_filename">filename</code></td>
<td>
<p>Does function expect ctl.in to be a filename? defaults to
TRUE. See <code>ctl.in</code> definition.</p>
</td></tr>
<tr><td><code id="remove_q_ctl_+3A_ctl.out">ctl.out</code></td>
<td>
<p>The SS control file to read out.</p>
</td></tr>
<tr><td><code id="remove_q_ctl_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. Overwrite an existing file with the same name as
<code>ctl.out</code> or <code>data.out</code>?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified SS control file vector.
</p>


<h3>Author(s)</h3>

<p>Kelli Johnson
</p>

<hr>
<h2 id='rename_ss3_files'>Rename SS3-version-specific files</h2><span id='topic+rename_ss3_files'></span>

<h3>Description</h3>

<p>Rename SS3-version-specific files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename_ss3_files(path, ss_bin, extensions)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rename_ss3_files_+3A_path">path</code></td>
<td>
<p>The path to the folder with the files.</p>
</td></tr>
<tr><td><code id="rename_ss3_files_+3A_ss_bin">ss_bin</code></td>
<td>
<p>A character value giving the SS binary name</p>
</td></tr>
<tr><td><code id="rename_ss3_files_+3A_extensions">extensions</code></td>
<td>
<p>A character vector of file extensions to rename without
periods preceding the values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sean C. Anderson
</p>

<hr>
<h2 id='run_ss3model'>Run an operating or estimation model for a specified set of scenario IDs</h2><span id='topic+run_ss3model'></span>

<h3>Description</h3>

<p>This function takes care of calling SS3. Importantly, it parses whether the
user is on Unix or Windows and calls the binary correctly. This lower-level
function is meant to be called by higher level functions such as
<code><a href="#topic+run_ss3sim">run_ss3sim</a></code>, <code><a href="#topic+ss3sim_base">ss3sim_base</a></code>, or your own custom
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_ss3model(scenarios, iterations, type = c("om", "em"),
  admb_options = "", hess = FALSE, ignore.stdout = TRUE,
  admb_pause = 0.05, show.output.on.console = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_ss3model_+3A_scenarios">scenarios</code></td>
<td>
<p>Which scenarios to run. Controls which folder contains the
model that SS3 should run on.</p>
</td></tr>
<tr><td><code id="run_ss3model_+3A_iterations">iterations</code></td>
<td>
<p>Which iterations to run. Controls which folder contains
the model that SS3 should run on.</p>
</td></tr>
<tr><td><code id="run_ss3model_+3A_type">type</code></td>
<td>
<p>Are you running the operating or estimation models?</p>
</td></tr>
<tr><td><code id="run_ss3model_+3A_admb_options">admb_options</code></td>
<td>
<p>Any additional options to pass to the SS3 command.</p>
</td></tr>
<tr><td><code id="run_ss3model_+3A_hess">hess</code></td>
<td>
<p>Calculate the Hessian on estimation model runs?</p>
</td></tr>
<tr><td><code id="run_ss3model_+3A_ignore.stdout">ignore.stdout</code></td>
<td>
<p>Passed to <code>system</code>. If <code>TRUE</code> then ADMB
output is not printed on screen. This will be slightly faster. Set to
<code>FALSE</code> to help with debugging.</p>
</td></tr>
<tr><td><code id="run_ss3model_+3A_admb_pause">admb_pause</code></td>
<td>
<p>A length of time (in seconds) to pause after running the
simulation model. This can be necessary on certain computers where file
writing can be slightly delayed. For example, on computers where the files
are written over a network connection. If the output files haven't
finished writing before <span class="rlang"><b>R</b></span> starts looking for the output then the
simulation will crash with an error about missing files. The default
value is set to <code>0.01</code> seconds, just to be safe.</p>
</td></tr>
<tr><td><code id="run_ss3model_+3A_show.output.on.console">show.output.on.console</code></td>
<td>
<p>Logical: passed on to
<code><a href="base.html#topic+system">system</a></code>.</p>
</td></tr>
<tr><td><code id="run_ss3model_+3A_...">...</code></td>
<td>
<p>Anything else to pass to <code><a href="base.html#topic+system">system</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ss3sim requires you to place the SS executable in your
path. See the vignette <code>vignette("ss3sim-vignette")</code> for details on
this process. The executables themselves can be downloaded from:
<a href="https://www.dropbox.com/sh/zg0sec6j20sfyyz/AACQiuk787qW882U2euVKoPna">https://www.dropbox.com/sh/zg0sec6j20sfyyz/AACQiuk787qW882U2euVKoPna</a>
#'
</p>


<h3>Author(s)</h3>

<p>Sean C. Anderson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss3sim_base">ss3sim_base</a></code>, <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>
</p>

<hr>
<h2 id='run_ss3sim'>Master function to run SS3 simulations</h2><span id='topic+run_ss3sim'></span>

<h3>Description</h3>

<p>This is the main high-level wrapper function for running <span class="pkg">ss3sim</span>
simulations. This function first deals with parsing a scenario ID into case
arguments, reads the appropriate case files, and then passes these arguments
on to <code><a href="#topic+ss3sim_base">ss3sim_base</a></code> to run a simulation. Alternatively, you might
choose to run <code><a href="#topic+ss3sim_base">ss3sim_base</a></code> directly and skip the case-file
setup.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_ss3sim(iterations, scenarios, case_folder, om_dir, em_dir,
  case_files = list(F = "F", D = c("index", "lcomp", "agecomp")),
  user_recdevs = NULL, parallel = FALSE, parallel_iterations = FALSE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_ss3sim_+3A_iterations">iterations</code></td>
<td>
<p>Which iterations to run. A numeric vector. For example
<code>1:100</code>.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_scenarios">scenarios</code></td>
<td>
<p>Which scenarios to run. A vector of character objects. For
example <code>c("D0-F0-cod", "D1-F1-cod")</code>. Also, see
<code><a href="#topic+expand_scenarios">expand_scenarios</a></code> for a shortcut to specifying the scenarios.
See <code><a href="#topic+get_caseargs">get_caseargs</a></code> and the vignette for details on specifying
the scenarios.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_case_folder">case_folder</code></td>
<td>
<p>The folder containing the plain-text case files.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_om_dir">om_dir</code></td>
<td>
<p>The folder containing the SS3 operating model
configuration files.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_em_dir">em_dir</code></td>
<td>
<p>The folder containing the SS3 estimation model
configuration files.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_case_files">case_files</code></td>
<td>
<p>A named list that relates the case IDs to the files to
return. <b>The default list specifies only the required fishing
mortality and data scenarios. To specify other cases you will need to
extend this named list</b>. This argument is passed to
<code><a href="#topic+get_caseargs">get_caseargs</a></code>. See that function for details and examples of
how to specify this. The introduction vignette also explains how to specify
the case files.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_user_recdevs">user_recdevs</code></td>
<td>
<p>An optional matrix of recruitment deviations to replace
the recruitment deviations built into the package. The columns represent
run iterations and the rows represent years. <code>user_recdevs</code> can be a
matrix of 0s for deterministic model checking. For traditional stochastic
simulations these would be independent and normally distributed deviations
with a standard deviation equal to the desired sigma R. Note that these
recruitment deviations will be used verbatim (after exponentiation).
<code>user_recdevs</code> will *not* be multiplied by sigma R and they will *not*
be log-normal bias corrected. If <code>user_recdevs</code> are specified as
anything besides <code>NULL</code> the package will issue a warning about this.
Biased recruitment deviations can lead to biased model results.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_parallel">parallel</code></td>
<td>
<p>A logical argument that controls whether the scenarios are
run in parallel. You will need to register multiple cores first with a
package such as <span class="pkg">doParallel</span> and have the <span class="pkg">foreach</span> package
installed. See the example below.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_parallel_iterations">parallel_iterations</code></td>
<td>
<p>Logical. By default <code>parallel = TRUE</code> will
run scenarios in parallel. If you set <code>parallel = TRUE</code> and
<code>parallel_iterations = TRUE</code> then the iterations will be run in
parallel. This would be useful if you were only running one scenario
but you wanted to run it faster.</p>
</td></tr>
<tr><td><code id="run_ss3sim_+3A_...">...</code></td>
<td>
<p>Anything else to pass to <code><a href="#topic+ss3sim_base">ss3sim_base</a></code>. This could
include <code>bias_adjust</code>. Also, you can pass
additional options to the <code>SS3</code> command through the argument
<code>admb_options</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The operating model folder should contain: <code>forecast.ss</code>,
<code>yourmodel.ctl</code>, <code>yourmodel.dat</code>, <code>ss.par</code>, and
<code>starter.ss</code>. The files should be the versions that are returned from an
SS run as <code>.ss_new</code> files. This is important because it creates
consistent formatting which many of the functions in this package depend on.
Rename the <code>.ss_new</code> files as listed above (and in all lowercase). The
estimation model folder should contain all the same files listed above except
the <code>ss.par</code> and <code>yourmodel.dat</code> files, which are unnecessary but
can be included if desired. See the vignette for details on modifying an
existing <code>SS3</code> model to run with <span class="pkg">ss3sim</span>. Alternatively, you might
consider modifying one of the built-in model configurations.
</p>


<h3>Value</h3>

<p>The output will appear in whatever your current <span class="rlang"><b>R</b></span> working directory
is. There will be folders named after your scenarios. They will
look like this:
</p>

<ul>
<li> <p><code>D0-F0-cod/1/om</code>
</p>
</li>
<li> <p><code>D0-F0-cod/1/em</code>
</p>
</li>
<li> <p><code>D0-F0-cod/2/om</code>
</p>
</li>
<li><p> ...
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Sean C. Anderson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss3sim_base">ss3sim_base</a></code>, <code><a href="#topic+run_ss3model">run_ss3model</a></code>,
<code><a href="#topic+get_caseargs">get_caseargs</a></code>,
<code><a href="#topic+expand_scenarios">expand_scenarios</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
# Create a temporary folder for the output and set the working directory:
temp_path &lt;- file.path(tempdir(), "ss3sim-example")
dir.create(temp_path, showWarnings = FALSE)
wd &lt;- getwd()
setwd(temp_path)
on.exit(setwd(wd), add = TRUE)

# Find the data in the ss3sim package:
d &lt;- system.file("extdata", package = "ss3sim")
om &lt;- file.path(d, "models", "cod-om")
em &lt;- file.path(d, "models", "cod-em")
case_folder &lt;- file.path(d, "eg-cases")
#
 # Without bias adjustment:
 run_ss3sim(iterations = 1, scenarios = "D0-F0-cod",
 case_folder = case_folder, om_dir = om, em_dir = em)
 unlink("D0-F0-cod", recursive = TRUE) # clean up

# An example specifying the case files:
run_ss3sim(iterations = 1, scenarios = "D0-F0-E0-cod",
  case_folder = case_folder, om_dir = om, em_dir = em,
  case_files = list(F = "F", D = c("index", "lcomp",
      "agecomp"), E = "E"))
unlink("D0-F0-E0-cod", recursive = TRUE) # clean up

# If try to use bias adjustment, a warning will be triggered and the run will
# proceed WITHOUT using bias adjustment (and may result in error.)
# run_ss3sim(iterations = 1, scenarios = "D1-F0-cod",
#   case_folder = case_folder, om_dir = om, em_dir = em,
#   bias_adjust = TRUE)

# A run with deterministic process error for model checking:
recdevs_det &lt;- matrix(0, nrow = 101, ncol = 2)
run_ss3sim(iterations = 1:2, scenarios = "D0-E100-F0-cod",
  case_folder = case_folder,
  case_files = list(F = "F", D = c("index", "lcomp", "agecomp"), E = "E"),
  om_dir = om, em_dir = em,
  bias_adjust = FALSE, user_recdevs = recdevs_det)
unlink("D0-E100-F0-cod", recursive = TRUE)

# # An example of a run using parallel processing across 2 cores:
# require(doParallel)
# registerDoParallel(cores = 2)
# require(foreach)
# getDoParWorkers() # check how many cores are registered
#
# # parallel scenarios:
# run_ss3sim(iterations = 1, scenarios = c("D0-F0-cod",
#     "D1-F0-cod"), case_folder = case_folder,
#   om_dir = om, em_dir = em, parallel = TRUE)
# unlink("D0-F0-cod", recursive = TRUE)
# unlink("D1-F0-cod", recursive = TRUE)
#
# # parallel iterations:
# run_ss3sim(iterations = 1:2, scenarios = "D0-F0-cod",
#   case_folder = case_folder, om_dir = om, em_dir = em,
#   parallel = TRUE, parallel_iterations = TRUE)
# unlink("D0-F0-cod", recursive = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='sample_agecomp'>Sample age compositions from a Stock Synthesis data file</h2><span id='topic+sample_agecomp'></span>

<h3>Description</h3>

<p>Extract age-composition data from a <code>.ss_new</code> data file and sample
the data. It is assumed that the composition data will be expected values
as written by Stock Synthesis in the second section of the data file, but
one can also sample input data. The resulting age-composition
data are assumed to represent observed age composition and will overwrite
the age data in <code>dat_list</code>, which is returned invisibly.
The data file can also be written to the disk, if a file path is provided to
<code>outfile</code>, and used as simulated data by an estimation model.
If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>, the case file should be named
<code>agecomp</code>. A suggested (default) case letter is <code>D</code> for data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_agecomp(dat_list, outfile = NULL, fleets, Nsamp, years,
  cpar = 1, ESS = NULL, keep_conditional = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_agecomp_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="sample_agecomp_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
<tr><td><code id="sample_agecomp_+3A_fleets">fleets</code></td>
<td>
<p>*A vector of integers specifying which fleets to include.
The order of the fleets pertains to the input order of other arguments.
An entry of <code>fleets=NULL</code> leads to zero samples for any fleet.</p>
</td></tr>
<tr><td><code id="sample_agecomp_+3A_nsamp">Nsamp</code></td>
<td>
<p>*A numeric list of the same length as <code>fleets</code>.
Either single values or vectors of the same length as the number of
years can be passed through. Single values are repeated for all
years. If no fleet collected samples, keep the value to
<code>Nsamp=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_agecomp_+3A_years">years</code></td>
<td>
<p>*A list the same length as <code>fleets</code> giving the years as
numeric vectors. If no fleet collected samples, keep the value to
<code>years=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_agecomp_+3A_cpar">cpar</code></td>
<td>
<p>A numeric value or vector the same length as
<code>fleets</code> controlling the variance of the Dirichlet
distribution used for sampling. A value of <code>1</code> leads to the
same standard deviation as a multinomial of the given <code>Nsamp</code>,
<code>2</code> indicates twice, etc. Values greater than one indicate
overdispersion, and less underdispersion. <code>NULL</code> or <code>NA</code>
for a given fleet will lead to no dispersion.</p>
</td></tr>
<tr><td><code id="sample_agecomp_+3A_ess">ESS</code></td>
<td>
<p>The final effective sample size (ESS) associated with the
simulated data. The ESS is not used to generate the simulated data
but can be used as an input sample size in subsequent models that estimate
population parameters or status.
The default, <code>NULL</code>, leads to the true (internally calculated)
#' ESS being used, which is <code>Nsamp</code> for the multinomial case or given
by the formula under <code>cpar</code> for the Dirichlet case.
At least one value must be provided for each fleet or a vector of
year-specific values can be used for any given fleet.
The argument accepts a list with entries,
either a single integer or a vector of integers, for each fleet.</p>
</td></tr>
<tr><td><code id="sample_agecomp_+3A_keep_conditional">keep_conditional</code></td>
<td>
<p>A logical if conditional age-at-length data
should be kept or removed entirely from the data file.
<code>sample_agecomp</code> only works on the age-composition data
and not on the conditional age-at-length data. To sample the
conditional data, set <code>keep_conditional</code> to <code>TRUE</code>
and use <code><a href="#topic+sample_calcomp">sample_calcomp</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified <code>.dat</code> file if <code>!is.null(outfile)</code>. A list object
containing the modified <code>.dat</code> file is returned invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan and Kotaro Ono
</p>


<h3>See Also</h3>

<p>Other sampling functions: <code><a href="#topic+clean_data">clean_data</a></code>,
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>, <code><a href="#topic+sample_index">sample_index</a></code>,
<code><a href="#topic+sample_lcomp">sample_lcomp</a></code>, <code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>,
<code><a href="#topic+sample_wtatage">sample_wtatage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- system.file("extdata", package = "ss3sim")
f_in &lt;- file.path(d, "models", "cod-om", "codOM.dat")
dat_list &lt;- r4ss::SS_readdat(f_in, version = NULL, verbose = FALSE)

## Turn off age comps by specifying fleets=NULL
test &lt;- sample_agecomp(dat_list = dat_list, fleets = NULL)

## Generate with a smaller number of fleet taking samples
ex1 &lt;- sample_agecomp(dat_list = dat_list, outfile = NULL,
  fleets = 2, Nsamp = list(c(10, 50)), years = list(c(26, 27)))
NROW(ex1$agecomp) == 2

## Generate with varying Nsamp by year for first fleet
ex2 &lt;- sample_agecomp(dat_list = dat_list, outfile = NULL,
  fleets = c(1, 2),
  Nsamp = list(c(rep(50, 5), rep(100, 5)), 50),
  years = list(seq(26, 44, 2), c(26:100)))

## Run three  cases showing Multinomial, Dirichlet(1), and over-dispersed
## Dirichlet for different levels of sample sizes
op &lt;- par(mfrow = c(1, 3))
set.seed(1)
true &lt;- prop.table(dat_list$agecomp[
  dat_list$agecomp$FltSvy == 1 &amp; dat_list$agecomp$Yr == 50, -(1:9)])
cpars &lt;- c(NA, 1, 4)
for (samplesize in c(30, 100, 1000)) {
  if (samplesize &gt; 30) par(mar = c(5.1, 1, 4.1, 2.1))
  plot(dat_list$agebin_vector, true, type = "b", ylim = c(0, 1),
    col = 4, lwd = 2, xlab = "Age",
    ylab = ifelse(samplesize == 30, "Proportion", ""),
    main = paste("Sample size =", samplesize))
  if (samplesize == 30) {
    legend("topright", lty = 1, col = 1:4, bty = "n",
      legend = c("Multinomial", "Dirichlet(1)", "Dirichlet(4)", "Truth"))
  }
  for (i in seq_along(cpars)) {
    ex &lt;- sample_agecomp(dat_list = dat_list, outfile = NULL, fleets = 1,
      Nsamp = list(samplesize), years = list(50), cpar = cpars[i])$agecomp
    lines(dat_list$agebin_vector, prop.table(ex[1, -(1:9)]),
      col = i, type = "b")
  }
}
par(op)
</code></pre>

<hr>
<h2 id='sample_calcomp'>Sample conditional age-at-length (CAL) data and write to file for use by
the EM.</h2><span id='topic+sample_calcomp'></span>

<h3>Description</h3>

<p>Sample conditional age-at-length (CAL) data and write to file for use by
the EM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_calcomp(dat_list, outfile = NULL, fleets = c(1, 2), years,
  Nsamp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_calcomp_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="sample_calcomp_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
<tr><td><code id="sample_calcomp_+3A_fleets">fleets</code></td>
<td>
<p>*A vector of integers specifying which fleets to include.
The order of the fleets pertains to the input order of other arguments.
An entry of <code>fleets=NULL</code> leads to zero samples for any fleet.</p>
</td></tr>
<tr><td><code id="sample_calcomp_+3A_years">years</code></td>
<td>
<p>*A list the same length as <code>fleets</code> giving the years as
numeric vectors. If no fleet collected samples, keep the value to
<code>years=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_calcomp_+3A_nsamp">Nsamp</code></td>
<td>
<p>*A numeric list of the same length as <code>fleets</code>.
Either single values or vectors of the same length as the number of
years can be passed through. Single values are repeated for all
years. If no fleet collected samples, keep the value to
<code>Nsamp=NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Take a <code>data.SS_new</code> file containing expected values and
sample from true lengths, using length comp sample sizes, to get
realistic sample sizes for age bins given a length. Only the multinomial
distribution is currently implemented. xIf no fish are sampled then that
row is discarded. A value of NULL for fleets indicates to delete the
data so the EM If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> the case file
should be named <code>calcomp</code>.
</p>


<h3>Value</h3>

<p>A modified <code>.dat</code> file if <code>!is.null(outfile)</code>. A list object
containing the modified <code>.dat</code> file is returned invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Note</h3>

<p>This function is only reliable when using multinomial length
compositions for the matching fleet. The real-valued length compositions
resulting from the Dirichlet distribution cause difficulties in the
sampling code. See the vignette for more.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan, Kotaro Ono
</p>


<h3>See Also</h3>

<p>Other sampling functions: <code><a href="#topic+clean_data">clean_data</a></code>,
<code><a href="#topic+sample_agecomp">sample_agecomp</a></code>, <code><a href="#topic+sample_index">sample_index</a></code>,
<code><a href="#topic+sample_lcomp">sample_lcomp</a></code>, <code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>,
<code><a href="#topic+sample_wtatage">sample_wtatage</a></code>
</p>

<hr>
<h2 id='sample_comp'>Sample composition data from expected values</h2><span id='topic+sample_comp'></span>

<h3>Description</h3>

<p>Apply the multinomial or Dirichlet distribution to sample
composition data, creating a data frame that mimics
observed composition data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_comp(data, Nsamp, fleets, years, ESS = NULL, cpar = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_comp_+3A_data">data</code></td>
<td>
<p>A data frame with informational columns followed by
columns of compositional data.
The informational columns must include columns labeled
'Yr' and 'FltSvy' and end with a column labeled 'Nsamp'.
Columns of compositional data should follow 'Nsamp'.
Rows of compositional data do not need to sum to one.</p>
</td></tr>
<tr><td><code id="sample_comp_+3A_nsamp">Nsamp</code></td>
<td>
<p>*A numeric list of the same length as <code>fleets</code>.
Either single values or vectors of the same length as the number of
years can be passed through. Single values are repeated for all
years. If no fleet collected samples, keep the value to
<code>Nsamp=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_comp_+3A_fleets">fleets</code></td>
<td>
<p>*A vector of integers specifying which fleets to include.
The order of the fleets pertains to the input order of other arguments.
An entry of <code>fleets=NULL</code> leads to zero samples for any fleet.</p>
</td></tr>
<tr><td><code id="sample_comp_+3A_years">years</code></td>
<td>
<p>*A list the same length as <code>fleets</code> giving the years as
numeric vectors. If no fleet collected samples, keep the value to
<code>years=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_comp_+3A_ess">ESS</code></td>
<td>
<p>The final effective sample size (ESS) associated with the
simulated data. The ESS is not used to generate the simulated data
but can be used as an input sample size in subsequent models that estimate
population parameters or status.
The default, <code>NULL</code>, leads to the true (internally calculated)
#' ESS being used, which is <code>Nsamp</code> for the multinomial case or given
by the formula under <code>cpar</code> for the Dirichlet case.
At least one value must be provided for each fleet or a vector of
year-specific values can be used for any given fleet.
The argument accepts a list with entries,
either a single integer or a vector of integers, for each fleet.</p>
</td></tr>
<tr><td><code id="sample_comp_+3A_cpar">cpar</code></td>
<td>
<p>A numeric value or vector the same length as
<code>fleets</code> controlling the variance of the Dirichlet
distribution used for sampling. A value of <code>1</code> leads to the
same standard deviation as a multinomial of the given <code>Nsamp</code>,
<code>2</code> indicates twice, etc. Values greater than one indicate
overdispersion, and less underdispersion. <code>NULL</code> or <code>NA</code>
for a given fleet will lead to no dispersion.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sample size, i.e., 'Nsamp', is used as a measure of precision,
where higher sample sizes lead to simulated samples that more accurately
represent the truth provided in <code>data</code>.
</p>


<h3>Value</h3>

<p>A data frame of observed composition data.
</p>


<h3>Author(s)</h3>

<p>Kelli Faye Johnson
</p>

<hr>
<h2 id='sample_index'>Sample the biomass with observation error</h2><span id='topic+sample_index'></span>

<h3>Description</h3>

<p>This function creates an index of abundance sampled from the expected
available biomass for given fleets in given years. Let <code>B_y</code> be the biomass
from the operating model for year y. Then the sampled value is calculated as:
<code>B_y*exp(rnorm(1, 0, sds_obs)-sds_obs^2/2)</code>. The second term
adjusts the random samples so that their expected value is <code>B_y</code> (i.e. the
log-normal bias correction).
If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> the case file should be named
<code>index</code>. A suggested (default) case letter is <code>D</code> for data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_index(dat_list, outfile = NULL, fleets, years, sds_obs,
  make_plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_index_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="sample_index_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
<tr><td><code id="sample_index_+3A_fleets">fleets</code></td>
<td>
<p>*A vector of integers specifying which fleets to include.
The order of the fleets pertains to the input order of other arguments.
An entry of <code>fleets=NULL</code> leads to zero samples for any fleet.</p>
</td></tr>
<tr><td><code id="sample_index_+3A_years">years</code></td>
<td>
<p>*A list the same length as <code>fleets</code> giving the years as
numeric vectors. If no fleet collected samples, keep the value to
<code>years=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_index_+3A_sds_obs">sds_obs</code></td>
<td>
<p>*A list the same length as <code>fleets</code>. The list should
contain either single values or numeric vectors of the same length as the
number of years which represent the standard deviation of the observation
error. Single values are repeated for all years.</p>
</td></tr>
<tr><td><code id="sample_index_+3A_make_plot">make_plot</code></td>
<td>
<p>A logical switch for whether to make a crude plot showing
the results. Useful for testing and exploring the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified <code>.dat</code> file if <code>!is.null(outfile)</code>. A list object
containing the modified <code>.dat</code> file is returned invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan, Kotaro Ono
</p>


<h3>See Also</h3>

<p>Other sampling functions: <code><a href="#topic+clean_data">clean_data</a></code>,
<code><a href="#topic+sample_agecomp">sample_agecomp</a></code>,
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>, <code><a href="#topic+sample_lcomp">sample_lcomp</a></code>,
<code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>,
<code><a href="#topic+sample_wtatage">sample_wtatage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Find the example data location:
d &lt;- system.file("extdata", package = "ss3sim")
f_in &lt;- file.path(d, "example-om", "ss3_expected_values.dat")
dat_list &lt;- r4ss::SS_readdat(f_in, version = NULL, verbose = FALSE)
# Note the initial expected values for the index data:
dat_list$CPUE # Only has expected values for fleet 2 in every other year from
# 76 to 100, so can only sample from fleet 2 during every other year between
# 76 and 100
sam_yrs &lt;- seq(76, 100, by = 2)
ex1 &lt;- sample_index(dat_list,
                   outfile = NULL,
                   fleets = 2,
                   years = list(sam_yrs),
                   sds_obs=list(seq(.001, .1,
                     length.out = length(sam_yrs))))
ex1$CPUE
# could sample from less years, but not more:
ex2 &lt;- sample_index(dat_list,
                    outfile = NULL,
                    fleets = 2,
                    years = list(sam_yrs[c(-1, -2)]),
                    sds_obs=list(seq(.001, .1,
                      length.out = length(sam_yrs[c(-1, -2)]))))
ex2$CPUE
# Also, sd can be fixed across years:
ex3 &lt;- sample_index(dat_list,
                    outfile = NULL,
                    fleets = 2,
                    years = list(sam_yrs),
                    sds_obs=list(0.01))
ex3$CPUE
# If fleet 1 also had expected values in the index that you wanted to sample:
# ex4 &lt;- sample_index(dat_list,
#                     outfile = NULL,
#                     fleets = c(1,2),
#                     years = list(sam_yrs, sam_yrs),
#                     sds_obs=list(0.01, 0.01))

## End(Not run)
</code></pre>

<hr>
<h2 id='sample_lcomp'>Sample length compositions from a Stock Synthesis data file</h2><span id='topic+sample_lcomp'></span>

<h3>Description</h3>

<p>Extract length-composition data from a <code>.ss_new</code> data file and sample
the data. It is assumed that the composition data will be expected values
as written by Stock Synthesis in the second section of the data file, but 
one can also sample input data. The resulting length-composition
data are assumed to represent observed length composition and will overwrite
the length data in <code>dat_list</code>, which is returned invisibly. 
The data file can also be written to the disk, if a file path is provided to
<code>outfile</code>, and used as simulated data by an estimation model.
If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>, the case file should be named
<code>agecomp</code>. A suggested (default) case letter is <code>D</code> for data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_lcomp(dat_list, outfile, fleets, Nsamp, years, cpar = 1,
  ESS = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_lcomp_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="sample_lcomp_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
<tr><td><code id="sample_lcomp_+3A_fleets">fleets</code></td>
<td>
<p>*A vector of integers specifying which fleets to include.
The order of the fleets pertains to the input order of other arguments.
An entry of <code>fleets=NULL</code> leads to zero samples for any fleet.</p>
</td></tr>
<tr><td><code id="sample_lcomp_+3A_nsamp">Nsamp</code></td>
<td>
<p>*A numeric list of the same length as <code>fleets</code>.
Either single values or vectors of the same length as the number of
years can be passed through. Single values are repeated for all
years. If no fleet collected samples, keep the value to
<code>Nsamp=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_lcomp_+3A_years">years</code></td>
<td>
<p>*A list the same length as <code>fleets</code> giving the years as
numeric vectors. If no fleet collected samples, keep the value to
<code>years=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_lcomp_+3A_cpar">cpar</code></td>
<td>
<p>A numeric value or vector the same length as
<code>fleets</code> controlling the variance of the Dirichlet
distribution used for sampling. A value of <code>1</code> leads to the
same standard deviation as a multinomial of the given <code>Nsamp</code>,
<code>2</code> indicates twice, etc. Values greater than one indicate
overdispersion, and less underdispersion. <code>NULL</code> or <code>NA</code>
for a given fleet will lead to no dispersion.</p>
</td></tr>
<tr><td><code id="sample_lcomp_+3A_ess">ESS</code></td>
<td>
<p>The final effective sample size (ESS) associated with the
simulated data. The ESS is not used to generate the simulated data
but can be used as an input sample size in subsequent models that estimate
population parameters or status.
The default, <code>NULL</code>, leads to the true (internally calculated)
#' ESS being used, which is <code>Nsamp</code> for the multinomial case or given
by the formula under <code>cpar</code> for the Dirichlet case.
At least one value must be provided for each fleet or a vector of
year-specific values can be used for any given fleet.
The argument accepts a list with entries,
either a single integer or a vector of integers, for each fleet.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified <code>.dat</code> file if <code>!is.null(outfile)</code>. A list object
containing the modified <code>.dat</code> file is returned invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan and Kotaro Ono
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sample_agecomp">sample_agecomp</a></code> for more examples
</p>
<p>Other sampling functions: <code><a href="#topic+clean_data">clean_data</a></code>,
<code><a href="#topic+sample_agecomp">sample_agecomp</a></code>,
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>, <code><a href="#topic+sample_index">sample_index</a></code>,
<code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>,
<code><a href="#topic+sample_wtatage">sample_wtatage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat_list &lt;- r4ss::SS_readdat(verbose = FALSE,
  file = system.file(file.path("extdata", "models", "cod-om", "codOM.dat"), 
  package="ss3sim"))
## Generate with constant sample size across years
ex1 &lt;- sample_lcomp(dat_list=dat_list, outfile = NULL, 
  fleets = 1:2, Nsamp = list(100, 50), 
  years=list(seq(26, 100, by = 2), 80:100))

</code></pre>

<hr>
<h2 id='sample_mlacomp'>[BETA VERSION] Sample mean length (size-)-at-age data and write to file for use by the EM.</h2><span id='topic+sample_mlacomp'></span>

<h3>Description</h3>

<p>[BETA VERSION] Sample mean length (size-)-at-age data and write to file for use by the EM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_mlacomp(dat_list, outfile, ctl_file_in, fleets = 1, Nsamp, years,
  mean_outfile = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_mlacomp_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="sample_mlacomp_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
<tr><td><code id="sample_mlacomp_+3A_ctl_file_in">ctl_file_in</code></td>
<td>
<p>A path to the control file, output from an OM, containing
the OM parameters for growth. These values are used to determine the
uncertainty about size for fish sampled in each age bin.</p>
</td></tr>
<tr><td><code id="sample_mlacomp_+3A_fleets">fleets</code></td>
<td>
<p>*A vector of integers specifying which fleets to include.
The order of the fleets pertains to the input order of other arguments.
An entry of <code>fleets=NULL</code> leads to zero samples for any fleet.</p>
</td></tr>
<tr><td><code id="sample_mlacomp_+3A_nsamp">Nsamp</code></td>
<td>
<p>*A numeric list of the same length as <code>fleets</code>.
Either single values or vectors of the same length as the number of
years can be passed through. Single values are repeated for all
years. If no fleet collected samples, keep the value to
<code>Nsamp=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_mlacomp_+3A_years">years</code></td>
<td>
<p>*A list the same length as <code>fleets</code> giving the years as
numeric vectors. If no fleet collected samples, keep the value to
<code>years=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_mlacomp_+3A_mean_outfile">mean_outfile</code></td>
<td>
<p>A path to write length and age data for external
estimation of parametric growth. If <code>NULL</code> no file will be written.
This file is used by <code>change_e</code> to externally estimate growth
parameters. Filename must contain &quot;vbgf&quot; to be used by <code>change_e</code>.
Also, if &quot;remove&quot; is included in the filename, the mean length at age data
will be removed from the <code>.dat</code> file and not be available to the EM.</p>
</td></tr>
<tr><td><code id="sample_mlacomp_+3A_verbose">verbose</code></td>
<td>
<p>Logical value whether or not diagnostic information from
<span class="pkg">r4ss</span> functions should be printed to the screen. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>**This function is in beta and untested. Use with caution.**
Take a <code>data.SS_new</code> file, read in by <span class="pkg">r4ss</span> function
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> containing observed values, and
sample from the observed ages to get realistic proportions for the number
of fish in each age bin, then use the mean size-at-age and CV for growth to
generate random samples of size, which are then averaged to get mean
length-at-age values. These values are then written to file for the
EM.
</p>


<h3>Value</h3>

<p>A modified <code>.dat</code> file if <code>!is.null(outfile)</code>. A list object
containing the modified <code>.dat</code> file is returned invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan, Kelli Johnson
</p>


<h3>See Also</h3>

<p>Other sampling functions: <code><a href="#topic+clean_data">clean_data</a></code>,
<code><a href="#topic+sample_agecomp">sample_agecomp</a></code>,
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>, <code><a href="#topic+sample_index">sample_index</a></code>,
<code><a href="#topic+sample_lcomp">sample_lcomp</a></code>, <code><a href="#topic+sample_wtatage">sample_wtatage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- system.file(file.path("extdata", "models", "cod-om"),
  package = "ss3sim")
dat_in &lt;- file.path(d, "codOM.dat")
dat_list &lt;- r4ss::SS_readdat(dat_in, version = NULL, verbose = FALSE)
dat_list &lt;- change_data(dat_list, outfile = NULL,
  fleets = 1, years = seq(dat_list$styr, dat_list$styr + 5),
  types = c("age", "mla"))
ctl_file_in &lt;- file.path(d, "codOM.ctl")

out &lt;- sample_mlacomp(dat_list, outfile = NULL, ctl_file_in = ctl_file_in,
  fleets = 1, Nsamp = 30, years = list(dat_list$styr + 5),
  verbose = FALSE, mean_outfile = NULL)

</code></pre>

<hr>
<h2 id='sample_wtatage'>Sample empirical weight-at-age data and write to file for use by the EM</h2><span id='topic+sample_wtatage'></span>

<h3>Description</h3>

<p>Take a <code>data.SS_new</code> file containing expected values and sample from
true ages to get realistic proportions for the number of fish in each age
bin, then use the mean size-at-age and CV for growth to generate random
samples of size, which are then converted to weight and averaged to get mean
weight-at-age values. Missing ages and years are filled according to a
specified function. These matrices are then written to file for the EM. By
calling this function, <span class="pkg">ss3sim</span> will turn on the empirical weight-at-age
function (set maturity option to 5) automatically. See
<code><a href="#topic+ss3sim_base">ss3sim_base</a></code> for more details on how that is implemented.
If used with <code><a href="#topic+run_ss3sim">run_ss3sim</a></code> the case file should be named
<code>wtatage</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_wtatage(wta_file_in, outfile, dat_list, ctl_file_in, years,
  fill_fnc = fill_across, fleets, cv_wtatage = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_wtatage_+3A_wta_file_in">wta_file_in</code></td>
<td>
<p>The file to read weight-at-age from. Specifically to get the
age-0 weight-at-age. This is typically <code>wtatage.ss_new</code>.</p>
</td></tr>
<tr><td><code id="sample_wtatage_+3A_outfile">outfile</code></td>
<td>
<p>A character string specifying the file name to use
when writing the information to the disk. The string must include
the proper file extension. No file is written using the default value
of <code>NULL</code>, which leads to increased speed because writing the 
file takes time and computing resources.</p>
</td></tr>
<tr><td><code id="sample_wtatage_+3A_dat_list">dat_list</code></td>
<td>
<p>An SS data list object as read in from
<code><a href="r4ss.html#topic+SS_readdat">SS_readdat</a></code> in the <span class="pkg">r4ss</span> package. Make sure
you select option <code>section=2</code>.</p>
</td></tr>
<tr><td><code id="sample_wtatage_+3A_ctl_file_in">ctl_file_in</code></td>
<td>
<p>A path to the control file, output from an OM, containing
the OM parameters for growth and weight/length relationship. These values
are used to determine the uncertainty about weight for fish sampled in each
age bin. Commonly <code>control.ss_new</code></p>
</td></tr>
<tr><td><code id="sample_wtatage_+3A_years">years</code></td>
<td>
<p>*A list the same length as <code>fleets</code> giving the years as
numeric vectors. If no fleet collected samples, keep the value to
<code>years=NULL</code>.</p>
</td></tr>
<tr><td><code id="sample_wtatage_+3A_fill_fnc">fill_fnc</code></td>
<td>
<p>*A function to fill in missing values (ages and years). The
resulting weight-at-age file will have values for all years and ages.One
function is <code>fill_across</code>.</p>
</td></tr>
<tr><td><code id="sample_wtatage_+3A_fleets">fleets</code></td>
<td>
<p>*A vector of integers specifying which fleets to include.
The order of the fleets pertains to the input order of other arguments.
An entry of <code>fleets=NULL</code> leads to zero samples for any fleet.</p>
</td></tr>
<tr><td><code id="sample_wtatage_+3A_cv_wtatage">cv_wtatage</code></td>
<td>
<p>A user specified CV for growth. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified <code>.wtatage.ss</code> file if <code>!is.null(outfile)</code>. A list
object containing the modified <code>.wtatage.ss</code> file is returned invisibly.
</p>


<h3>Which arguments to specifiy in case files</h3>

<p>All function argument descriptions that start with an asterisk (*) will be passed
through the case files to <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>. If one of these arguments
is not specified in a case file, then a value of <code>NULL</code> will be passed,
which may or may not be an appropriate value. Other arguments will be ignored
if specified.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan, Allan Hicks, Peter Kuriyama
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fill_across">fill_across</a></code>
</p>
<p>Other sampling functions: <code><a href="#topic+clean_data">clean_data</a></code>,
<code><a href="#topic+sample_agecomp">sample_agecomp</a></code>,
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>, <code><a href="#topic+sample_index">sample_index</a></code>,
<code><a href="#topic+sample_lcomp">sample_lcomp</a></code>, <code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>
</p>

<hr>
<h2 id='sanitize_admb_options'>Check admb options to make sure there aren't flags there shouldn't
be</h2><span id='topic+sanitize_admb_options'></span>

<h3>Description</h3>

<p>Check admb options to make sure there aren't flags there shouldn't
be
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sanitize_admb_options(x, exclude = "-nohess")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sanitize_admb_options_+3A_x">x</code></td>
<td>
<p>The admb options</p>
</td></tr>
<tr><td><code id="sanitize_admb_options_+3A_exclude">exclude</code></td>
<td>
<p>A character object (not a vector)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sean C. Anderson
</p>

<hr>
<h2 id='scalar_dat'>Example scalar data from the ss3sim vignette</h2><span id='topic+scalar_dat'></span>

<h3>Description</h3>

<p>Example scalar data from the ss3sim vignette
</p>

<hr>
<h2 id='setup_parallel'>Setup parallel processing</h2><span id='topic+setup_parallel'></span>

<h3>Description</h3>

<p>Setup parallel processing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_parallel()
</code></pre>

<hr>
<h2 id='ss3sim_base'>Base wrapper function to run an ss3sim simulation</h2><span id='topic+ss3sim_base'></span>

<h3>Description</h3>

<p>This function is a wrapper function that can call <code><a href="#topic+run_ss3model">run_ss3model</a></code>
for the operating model, sample the output (add recruitment deviations,
survey the data, etc.), and run the estimation model. <code>ss3sim_base</code> is
the main internal function for <span class="pkg">ss3sim</span>. It is intended to be used
through <code><a href="#topic+run_ss3sim">run_ss3sim</a></code>, but can also be used directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss3sim_base(iterations, scenarios, f_params, index_params, lcomp_params,
  agecomp_params, calcomp_params = NULL, wtatage_params = NULL,
  mlacomp_params = NULL, em_binning_params = NULL,
  estim_params = NULL, tv_params = NULL, operat_params = NULL,
  om_dir, em_dir, retro_params = NULL, data_params = NULL,
  user_recdevs = NULL, user_recdevs_warn = TRUE, bias_adjust = FALSE,
  hess_always = FALSE, print_logfile = TRUE, sleep = 0, seed = 21,
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ss3sim_base_+3A_iterations">iterations</code></td>
<td>
<p>Which iterations to run. A numeric vector.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_scenarios">scenarios</code></td>
<td>
<p>Which scenarios to run.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_f_params">f_params</code></td>
<td>
<p>A named list containing arguments for <code><a href="#topic+change_f">change_f</a></code>.
A mandatory case.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_index_params">index_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+sample_index">sample_index</a></code>. A mandatory case.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_lcomp_params">lcomp_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+sample_lcomp">sample_lcomp</a></code>. A mandatory case.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_agecomp_params">agecomp_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+sample_agecomp">sample_agecomp</a></code>. A mandatory case.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_calcomp_params">calcomp_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+sample_calcomp">sample_calcomp</a></code>, for conditional age-at-length data.
Currently CAL is not implemented in this version of ss3sim,
so calcomp_params should be NULL.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_wtatage_params">wtatage_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+sample_wtatage">sample_wtatage</a></code>, for empirical weight-at-age data.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_mlacomp_params">mlacomp_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+sample_mlacomp">sample_mlacomp</a></code>, for mean length-at-age data.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_em_binning_params">em_binning_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+change_em_binning">change_em_binning</a></code>.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_estim_params">estim_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+change_e">change_e</a></code>.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_tv_params">tv_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+change_tv">change_tv</a></code> (time-varying).</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_operat_params">operat_params</code></td>
<td>
<p>A named list containing arguments for <code><a href="#topic+change_o">change_o</a></code>.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_om_dir">om_dir</code></td>
<td>
<p>The directory with the operating model you want to copy and use
for the specified simulations.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_em_dir">em_dir</code></td>
<td>
<p>The directory with the estimation model you want to copy and
use for the specified simulations.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_retro_params">retro_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+change_retro">change_retro</a></code>.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_data_params">data_params</code></td>
<td>
<p>A named list containing arguments for
<code><a href="#topic+change_data">change_data</a></code>.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_user_recdevs">user_recdevs</code></td>
<td>
<p>An optional matrix of recruitment deviations to replace
the recruitment deviations built into the package. The columns represent
run iterations and the rows represent years. <code>user_recdevs</code> can be a
matrix of 0s for deterministic model checking. For traditional stochastic
simulations these would be independent and normally distributed deviations
with a standard deviation equal to the desired sigma R. Note that these
recruitment deviations will be used verbatim (after exponentiation).
<code>user_recdevs</code> will *not* be multiplied by sigma R and they will *not*
be log-normal bias corrected. If <code>user_recdevs</code> are specified as
anything besides <code>NULL</code> the package will issue a warning about this.
Biased recruitment deviations can lead to biased model results.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_user_recdevs_warn">user_recdevs_warn</code></td>
<td>
<p>A logical argument allowing users to turn the
warning regarding biased recruitment deviations off when <code>user_recdevs</code>
are specified.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_bias_adjust">bias_adjust</code></td>
<td>
<p>Run bias adjustment first?.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_hess_always">hess_always</code></td>
<td>
<p>If <code>TRUE</code> then the Hessian will always be calculated.
If <code>FALSE</code> then the Hessian will only be calculated for
bias-adjustment runs thereby saving time.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_print_logfile">print_logfile</code></td>
<td>
<p>Logical. Print a log file?</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_sleep">sleep</code></td>
<td>
<p>A time interval (in seconds) to pause on each iteration. Useful
if you want to reduce average CPU time &ndash; perhaps because you're working on
a shared server.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_seed">seed</code></td>
<td>
<p>The seed value to pass to <code><a href="#topic+get_recdevs">get_recdevs</a></code> when
generating recruitment deviations. The generated recruitment deviations
depend on the iteration value, but also on the value of <code>seed</code>. A
given combination of iteration, number of years, and <code>seed</code> value will
result in the same recruitment deviations.</p>
</td></tr>
<tr><td><code id="ss3sim_base_+3A_...">...</code></td>
<td>
<p>Anything extra to pass to <code><a href="#topic+run_ss3model">run_ss3model</a></code>. For
example, you may want to pass additional options to <code>SS3</code> through
the argument <code>admb_options</code>. Anything that doesn't match a named
argument in <code><a href="#topic+run_ss3model">run_ss3model</a></code> will be passed to the
<code><a href="base.html#topic+system">system</a></code> call that runs <code>SS3</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is written to be flexible. You can specify the fishing
mortality, survey index, length composition, age composition, and
time-varying parameters in the function call as list objects (see the
example below). For a generic higher-level function, see
<code><a href="#topic+run_ss3sim">run_ss3sim</a></code>.
</p>


<h3>Value</h3>

<p>The output will appear in whatever your current <span class="rlang"><b>R</b></span> working directory
is. There will be folders named after your scenarios. They will
look like this:
</p>

<ul>
<li> <p><code>D0-F0-cod/1/om</code>
</p>
</li>
<li> <p><code>D0-F0-cod/1/em</code>
</p>
</li>
<li> <p><code>D0-F0-cod/2/om</code>
</p>
</li>
<li><p> ...
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Sean Anderson with contributions from many others as listed in
the DESCRIPTION file.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_ss3sim">run_ss3sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create a temporary folder for the output and set the working directory:
  # Create a temporary folder for the output and set the working directory:
  temp_path &lt;- file.path(tempdir(), "ss3sim-base-example")
  dir.create(temp_path, showWarnings = FALSE)
  wd &lt;- getwd()
  setwd(temp_path)
  on.exit(setwd(wd), add = TRUE)

  # Find the data in the ss3sim package:
  d &lt;- system.file("extdata", package = "ss3sim")
  om &lt;- file.path(d, "models", "cod-om")
  em &lt;- file.path(d, "models", "cod-em")
  case_folder &lt;- file.path(d, "eg-cases")

  # Pull in file paths from the package example data:
  d &lt;- system.file("extdata", package = "ss3sim")
  om_dir &lt;- file.path(d, "models", "cod-om")
  em_dir &lt;- file.path(d, "models", "cod-em")
  a &lt;- get_caseargs(folder = file.path(d, "eg-cases"),
                    case_files = list(F = "F",
                                      D = c("index", "lcomp", "agecomp"),
                                      E = "E"),
                    scenario = "F0-D0-E0-cod")
  ss3sim_base(iterations = 1,
              scenarios = "F0-D0-E0-cod",
              f_params = a$F,
              index_params = a$index,
              lcomp_params = a$lcomp,
              agecomp_params = a$agecomp,
              tv_params = a$tv_params,
              estim_params = a$E,
              om_dir = om_dir,
              em_dir = em_dir)
  unlink("F0-D0-E0-cod", recursive = TRUE) # clean up

  # Or, create the argument lists directly in R and skip the case file setup:

  F0 &lt;- list(years = 1:100,
             fisheries = 1,
             fvals = c(rep(0, 25), rep(0.114, 75)))

  index1 &lt;- list(fleets = 2, years = list(seq(62, 100, by = 2)),
                 sds_obs = list(0.1))

  lcomp1 &lt;- list(fleets = c(1, 2), Nsamp = list(100, 100),
                 years = list(26:100, seq(62, 100, by = 2)),
                 lengthbin_vector = NULL, cpar = c(1, 1))

  agecomp1 &lt;- list(fleets = c(1, 2), Nsamp = list(100, 100),
                   years = list(26:100, seq(62, 100, by = 2)),
                   agebin_vector = NULL, cpar = c(1, 1))

  E0 &lt;- list(natM_type = NULL, natM_n_breakpoints = NULL, natM_lorenzen = NULL,
             natM_val = NULL,
             par_name = c("LnQ_base_Fishery", "NatM_p_1_Fem_GP_1"),
             par_int = c(NA, NA), par_phase = c(-1, -1), forecast_num = 0)

  ss3sim_base(iterations = 1,
              scenarios = "D1-E0-F0-cod", #name as desired
              f_params = F0,
              index_params = index1,
              lcomp_params = lcomp1,
              agecomp_params = agecomp1,
              estim_params = E0,
              om_dir = om,
              em_dir = em)

  unlink("D1-E0-F0-cod", recursive = TRUE) # clean up

## End(Not run)
</code></pre>

<hr>
<h2 id='standardize_bounds'>Standardize the bounds of the estimation model control file.</h2><span id='topic+standardize_bounds'></span>

<h3>Description</h3>

<p>Function to standardize the bounds of the control file in the estimation
model. This function first checks to ensure the initial values in the
estimation model control file are set to the true values of the
<code>om_ctl_file</code> and if not sets them for every parameter. Next, the
function adjusts the LO and HI values in the <code>em_ctl_file</code> to
be a fixed percentage of the initial value for every parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standardize_bounds(percent_df, dir, em_ctl_file, om_ctl_file = "",
  verbose = FALSE, estimate = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="standardize_bounds_+3A_percent_df">percent_df</code></td>
<td>
<p>A <code>data.frame</code> with nine rows and three columns.
The first column is the parameter.
The second column is the percent of the initial parameter value LO is set to.
The third column is the percent of the initial parameter value HI is set to.</p>
</td></tr>
<tr><td><code id="standardize_bounds_+3A_dir">dir</code></td>
<td>
<p>A path to the directory containing the model files.</p>
</td></tr>
<tr><td><code id="standardize_bounds_+3A_em_ctl_file">em_ctl_file</code></td>
<td>
<p>A string with the name of the estimation model
control file. <code>em_ctl_file</code> must be located in <code>dir</code>.</p>
</td></tr>
<tr><td><code id="standardize_bounds_+3A_om_ctl_file">om_ctl_file</code></td>
<td>
<p>A string with the name of the operating model
control file. If it is not given the part of the function which matches the
OM and EM INIT values is ignored. Default is <code>""</code>.
<code>om_ctl_file</code> must be located in <code>dir</code>.</p>
</td></tr>
<tr><td><code id="standardize_bounds_+3A_verbose">verbose</code></td>
<td>
<p>Detailed output to command line. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="standardize_bounds_+3A_estimate">estimate</code></td>
<td>
<p>A logical for which changed parameters are to be estimated.
Used by <code><a href="r4ss.html#topic+SS_changepars">SS_changepars</a></code>, where in <span class="pkg">r4ss</span> the default
is <code>FALSE</code>, which turns all parameter estimation off. Here the default
is <code>NULL</code>, which will leave parameter phases unchanged.</p>
</td></tr>
<tr><td><code id="standardize_bounds_+3A_...">...</code></td>
<td>
<p>Any other arguments to pass to <code><a href="r4ss.html#topic+SS_changepars">SS_changepars</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Christine Stawitz
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
temp_path &lt;- file.path(tempdir(), "standardize-bounds-example")
dir.create(temp_path, showWarnings = FALSE)
wd &lt;- getwd()
setwd(temp_path)
on.exit(setwd(wd), add = TRUE)

## Set to the path and filename of the OM and EM control files
OM.ctl &lt;- system.file("extdata", "models", "cod-om", "codOM.ctl",
  package = "ss3sim")
EM.ctl &lt;- system.file("extdata", "models", "cod-em", "codEM.ctl",
  package = "ss3sim")
file.copy(OM.ctl, "om.ctl")
file.copy(EM.ctl, "em.ctl")

## Use SS_parlines to get the proper names for parameters for the data frame
em.pars &lt;- r4ss::SS_parlines(ctlfile = "em.ctl")

## Set percentages to make lower and upper bounds
lo.percent&lt;-rep(.5,11)
hi.percent&lt;-c(500,1000,1000,rep(500,8))

##Populate data frame using EM parameter names and percentages
percent_df&lt;-data.frame(Label=as.character(em.pars[c(1:6,17,27:30),"Label"]),
  lo=lo.percent,hi=hi.percent)

##Run function
standardize_bounds(percent_df = percent_df, dir = ".",
                   em_ctl_file = "em.ctl",
                   om_ctl_file = "om.ctl")
unlink("om.ctl")
unlink("em.ctl")
unlink(temp_path, recursive = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='substr_r'>Substring from right</h2><span id='topic+substr_r'></span>

<h3>Description</h3>

<p>Substring from right
</p>


<h3>Usage</h3>

<pre><code class='language-R'>substr_r(x, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="substr_r_+3A_x">x</code></td>
<td>
<p>A character object</p>
</td></tr>
<tr><td><code id="substr_r_+3A_n">n</code></td>
<td>
<p>The number of characters from the right to extract</p>
</td></tr>
</table>


<h3>References</h3>

<p>http://stackoverflow.com/questions/7963898/extracting-the-last-n-characters-from-a-string-in-r
</p>

<hr>
<h2 id='ts_dat'>Example time series data from the ss3sim vignette</h2><span id='topic+ts_dat'></span>

<h3>Description</h3>

<p>Example time series data from the ss3sim vignette
</p>

<hr>
<h2 id='vbgf_func'>Predict length given VBGF parameters</h2><span id='topic+vbgf_func'></span>

<h3>Description</h3>

<p>External estimation procedure for von Bertalanffy growth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vbgf_func(L1, L.inf, k, ages, a3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vbgf_func_+3A_l1">L1</code></td>
<td>
<p>mean length at youngest age which is well sampled in the data (a3)</p>
</td></tr>
<tr><td><code id="vbgf_func_+3A_l.inf">L.inf</code></td>
<td>
<p>Length at infinity</p>
</td></tr>
<tr><td><code id="vbgf_func_+3A_k">k</code></td>
<td>
<p>von Bertalanffy growth rate parameter</p>
</td></tr>
<tr><td><code id="vbgf_func_+3A_ages">ages</code></td>
<td>
<p>vector of ages in the data for which you want to predict mean
length-at-age</p>
</td></tr>
<tr><td><code id="vbgf_func_+3A_a3">a3</code></td>
<td>
<p>youngest age which is well sampled in the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of lengths predicted which correspond to the input ages
vector.
</p>

<hr>
<h2 id='verify_input'>Verify and standardize SS3 input files</h2><span id='topic+verify_input'></span>

<h3>Description</h3>

<p>This function verifies the contents of operating model (<code>om</code>) and
estimation model (<code>em</code>) folders (i.e., it checks that the necessary SS
input files are available). If the contents are correct, the
<code>.ctl</code> and <code>.dat</code> files are renamed to standardized names and the
<code>starter.ss</code> file is updated to reflect these names. If the contents
are incorrect then a warning is issued and the simulation is aborted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify_input(model_dir, type = c("om", "em"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="verify_input_+3A_model_dir">model_dir</code></td>
<td>
<p>Directory name for model. This folder should contain the
<code>.ctl</code>, <code>.dat</code>, files etc.</p>
</td></tr>
<tr><td><code id="verify_input_+3A_type">type</code></td>
<td>
<p>One of &quot;om&quot; or &quot;em&quot; for operating or estimating model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a helper function to be used within the larger wrapper
simulation functions.
</p>


<h3>Value</h3>

<p>Returns a version of the folder with sanitized files or an error if
some files are missing.
</p>


<h3>Author(s)</h3>

<p>Curry James Cunningham; modified by Sean Anderson
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a temporary folder for the output:
temp_path &lt;- file.path(tempdir(), "ss3sim-verify-example")
dir.create(temp_path, showWarnings = FALSE)

d &lt;- system.file("extdata", package = "ss3sim")

om &lt;- paste0(d, "/models/cod-om")
em &lt;- paste0(d, "/models/cod-em")

file.copy(om, temp_path, recursive = TRUE)
file.copy(em, temp_path, recursive = TRUE)

# Verify the correct files exist and change file names:
verify_input(model_dir = paste0(temp_path, "/cod-om"), type = "om")
verify_input(model_dir = paste0(temp_path, "/cod-em"), type = "em")
unlink(temp_path, recursive = TRUE)
</code></pre>

<hr>
<h2 id='verify_plot_arguments'>A helper function to check the correct input for the plotting functions.</h2><span id='topic+verify_plot_arguments'></span>

<h3>Description</h3>

<p>A helper function to check the correct input for the plotting functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify_plot_arguments(data, x, y, horiz, horiz2, vert, vert2, color,
  relative.error, axes.free, print)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="verify_plot_arguments_+3A_data">data</code></td>
<td>
<p>A valid data frame containing scalar or timeseries values
from a <span class="pkg">ss3sim</span> simulation. That data are generated from
<code><a href="#topic+get_results_all">get_results_all</a></code>.</p>
</td></tr>
<tr><td><code id="verify_plot_arguments_+3A_x">x</code></td>
<td>
<p>A character string denoting which column to use as the x variable.
Column should be a factor (e.g. &quot;F&quot; or &quot;species&quot;).</p>
</td></tr>
<tr><td><code id="verify_plot_arguments_+3A_y">y</code></td>
<td>
<p>A character string denoting which column to use as the y
variable. Must be a numeric column.</p>
</td></tr>
<tr><td><code id="verify_plot_arguments_+3A_horiz">horiz</code>, <code id="verify_plot_arguments_+3A_horiz2">horiz2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>horiz</code>) and second (<code>horiz2</code>) level of faceting in
the horizontal direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="verify_plot_arguments_+3A_vert">vert</code>, <code id="verify_plot_arguments_+3A_vert2">vert2</code></td>
<td>
<p>A character string denoting which column to use as
the first (<code>vert</code>) and second (<code>vert2</code>) level of faceting in
the vertical direction. E.g. &quot;M&quot; or &quot;species&quot;. A value of NULL (default)
indicates no faceting.</p>
</td></tr>
<tr><td><code id="verify_plot_arguments_+3A_color">color</code></td>
<td>
<p>A character string denoting which column to use to map
color. Not valid for boxplot functions. Useful for looking at EM
performance criteria against other dimensions of the EM or OM. See
example below for how to merge in a metric from a scalar dataset to a ts
dataset.</p>
</td></tr>
<tr><td><code id="verify_plot_arguments_+3A_relative.error">relative.error</code></td>
<td>
<p>Boolean for whether the y-axis should be
interpreted as relative error. If <code>TRUE</code>, <code>ylim</code> is set to
<code>c(-1,1)</code>, the y axis label is changed automatically, and a
red line at y=0 is added.</p>
</td></tr>
<tr><td><code id="verify_plot_arguments_+3A_axes.free">axes.free</code></td>
<td>
<p>Boolean for whether the y-axis scales should be free
in <code>facet_grid</code>.</p>
</td></tr>
<tr><td><code id="verify_plot_arguments_+3A_print">print</code></td>
<td>
<p>A logical for whether the plot is printed or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <span class="pkg">ss3sim</span> plotting functions are simply
wrappers for <span class="pkg">ggplot2</span> code, specific to the output from
<span class="pkg">ss3sim</span> simulation scalar and timeseries (ts) objects. They are
designed to quickly explore simulation output, rather than
publication-level figures. The functions use the <code>aes_string</code>
function within <span class="pkg">ggplot2</span> such that arguments are passed as
characters that refer to columns of <code>data</code>.
</p>
<p>Note that there are some subtle differences between the
functions. Scalar plots require a value for <code>x</code>, while for ts plots
<code>x</code> is invalid because it is fixed internally as 'year', since it
makes no sense to use another column. Boxplots cannot have a color
mapped to them like points or lines, and thus <code>color</code> is not a
valid argument. The ts point and line plots are grouped internally by
'ID', which is a combination of scenario and iteration.
</p>


<h3>Value</h3>

<p>Nothing is returned; an informative error is throw if an
argument is invalid.
</p>


<h3>Output</h3>

<p>These functions print the <code>ggplot</code> object, but
also return it invisibly for saving or printing again later.
</p>


<h3>Author(s)</h3>

<p>Cole Monnahan
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
