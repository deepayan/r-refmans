<!DOCTYPE html><html lang="en-GB"><head><title>Help for package rice</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rice}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rice-package'><p>rice: Radiocarbon Equations</p></a></li>
<li><a href='#age.F14C'><p>To be deprecated. Use C14.F14C instead</p></a></li>
<li><a href='#age.pMC'><p>To be deprecated. Use C14topMC instead.</p></a></li>
<li><a href='#as.bin'><p>Combine multiple radiocarbon dates within bins</p></a></li>
<li><a href='#as.one'><p>Combine multiple radiocarbon dates assuming they belong to the same single year</p></a></li>
<li><a href='#BCADtoC14'><p>Find the 14C age and error belonging to a BC/AD age.</p></a></li>
<li><a href='#BCADtocalBP'><p>calculate cal BP ages from BC/AD ages</p></a></li>
<li><a href='#BCADtoD14C'><p>Find the pMC and error belonging to a cal BP age.</p></a></li>
<li><a href='#BCADtoF14C'><p>Find the F14C and error belonging to a BC/AD age.</p></a></li>
<li><a href='#BCADtopMC'><p>Find the pMC and error belonging to a BC/AD age.</p></a></li>
<li><a href='#C14toBCAD'><p>Find the BCAD age(s) crossing a C14 age.</p></a></li>
<li><a href='#C14tocalBP'><p>Find the calBP age(s) crossing a C14 age.</p></a></li>
<li><a href='#C14toD14C'><p>Transform C14 age(s) into D14C</p></a></li>
<li><a href='#C14toF14C'><p>Calculate F14C values from C14 ages</p></a></li>
<li><a href='#C14topMC'><p>Calculate pMC values from C14 ages</p></a></li>
<li><a href='#calBPtoBCAD'><p>calculate BC/AD ages from cal BP ages</p></a></li>
<li><a href='#calBPtoC14'><p>Find the 14C age and error belonging to a cal BP age.</p></a></li>
<li><a href='#calBPtoD14C'><p>Find the pMC and error belonging to a cal BP age.</p></a></li>
<li><a href='#calBPtoF14C'><p>Find the F14C and error belonging to a cal BP age.</p></a></li>
<li><a href='#calBPtopMC'><p>Find the pMC and error belonging to a cal BP age.</p></a></li>
<li><a href='#caldist'><p>Calculate calibrated distribution</p></a></li>
<li><a href='#calib.t'><p>Comparison dates calibrated using both the t distribution (Christen and Perez 2009) and the normal distribution.</p></a></li>
<li><a href='#calibrate'><p>Plot individual calibrated dates.</p></a></li>
<li><a href='#clean'><p>Simulate removing contamination from a radiocarbon age</p></a></li>
<li><a href='#contaminate'><p>Simulate the impact of contamination on a radiocarbon age</p></a></li>
<li><a href='#D14CtoC14'><p>Transform D14C into C14 age</p></a></li>
<li><a href='#D14CtoF14C'><p>Transform D14C into F14C</p></a></li>
<li><a href='#D14CtopMC'><p>Transform D14C into pMC</p></a></li>
<li><a href='#draw.ccurve'><p>Draw a calibration curve.</p></a></li>
<li><a href='#draw.contamination'><p>Draw contamination impacts</p></a></li>
<li><a href='#draw.D14C'><p>Draw d14C and the calibration curve.</p></a></li>
<li><a href='#draw.dates'><p>add calibrated distributions to a plot.</p></a></li>
<li><a href='#F14C.age'><p>To be deprecated. Calculate C14 ages from F14C values.</p></a></li>
<li><a href='#F14CtoC14'><p>Calculate C14 ages from F14C values.</p></a></li>
<li><a href='#F14CtoD14C'><p>Transform F14C into D14C</p></a></li>
<li><a href='#F14CtopMC'><p>Calculate pMC ages from F14C values.</p></a></li>
<li><a href='#find.shells'><p>Find nearby shell-derived dR values</p></a></li>
<li><a href='#fractions'><p>Estimate a missing radiocarbon age from fractions</p></a></li>
<li><a href='#hpd'><p>Calculate highest posterior density</p></a></li>
<li><a href='#l.calib'><p>Find the calibrated probability of a calendar age for a 14C date.</p></a></li>
<li><a href='#map.shells'><p>Plot regional shell-derived dR values</p></a></li>
<li><a href='#muck'><p>Calculate the amount of muck/contamination to explain an observed C14 age</p></a></li>
<li><a href='#older'><p>Find the probability of a calibrated date being older than a certain age</p></a></li>
<li><a href='#overlap'><p>The overlap between calibrated C14 dates</p></a></li>
<li><a href='#p.range'><p>Probability of a date lying within a cal BP range</p></a></li>
<li><a href='#pMC.age'><p>To be deprecated. Use pMCtoC14 instead.</p></a></li>
<li><a href='#pMCtoC14'><p>Calculate C14 ages from pMC values.</p></a></li>
<li><a href='#pMCtoD14C'><p>Transform F14C into D14C</p></a></li>
<li><a href='#pMCtoF14C'><p>Calculate pMC ages from F14C values.</p></a></li>
<li><a href='#point.estimates'><p>Calculate a point estimate</p></a></li>
<li><a href='#pool'><p>Test if a set of radiocarbon dates can be combined</p></a></li>
<li><a href='#push.gamma'><p>Add a gamma distribution to a calibrated date</p></a></li>
<li><a href='#push.normal'><p>Add a normal distribution to a calibrated date</p></a></li>
<li><a href='#r.calib'><p>return a random calendar age from a calibrated distribution</p></a></li>
<li><a href='#rice'><p>Radiocarbon Equations</p></a></li>
<li><a href='#shells'><p>shells Data</p></a></li>
<li><a href='#shells.mean'><p>Plot and summarize the dR values</p></a></li>
<li><a href='#shroud'><p>shroud Data</p></a></li>
<li><a href='#smooth.curve'><p>Smooth a calibration curve</p></a></li>
<li><a href='#spread'><p>The spread among calibrated dates</p></a></li>
<li><a href='#weighted_means'><p>Calculate the weighted mean of C14 ages</p></a></li>
<li><a href='#younger'><p>Find the probability of a calibrated date being of a certain age or younger than it</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Radiocarbon Equations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Maarten Blaauw <a href="https://orcid.org/0000-0002-5680-1515"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for the calibration of radiocarbon dates, as well as options to calculate different radiocarbon realms (C14 age, F14C, pMC, D14C) and estimating the effects of contamination or local reservoir offsets (Reimer and Reimer 2001 &lt;<a href="https://doi.org/10.1017%2FS0033822200038339">doi:10.1017/S0033822200038339</a>&gt;). The methods follow long-established recommendations such as Stuiver and Polach (1977) &lt;<a href="https://doi.org/10.1017%2FS0033822200003672">doi:10.1017/S0033822200003672</a>&gt; and Reimer et al. (2004) &lt;<a href="https://doi.org/10.1017%2FS0033822200033154">doi:10.1017/S0033822200033154</a>&gt;. This package complements the data package 'rintcal'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>rlang, ggplot2, sf, maps (&ge; 3.4.2.1), rnaturalearth (&ge;
1.0.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, utf8, remotes, devtools, rnaturalearthdata</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), rintcal (&ge; 1.1.1)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-07 17:36:54 UTC; maarten</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-07 18:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rice-package'>rice: Radiocarbon Equations</h2><span id='topic+rice-package'></span>

<h3>Description</h3>

<p>Provides functions for the calibration of radiocarbon dates, as well as options to calculate different radiocarbon realms (C14 age, F14C, pMC, D14C) and estimating the effects of contamination or local reservoir offsets (Reimer and Reimer 2001 <a href="https://doi.org/10.1017/S0033822200038339">doi:10.1017/S0033822200038339</a>). The methods follow long-established recommendations such as Stuiver and Polach (1977) <a href="https://doi.org/10.1017/S0033822200003672">doi:10.1017/S0033822200003672</a> and Reimer et al. (2004) <a href="https://doi.org/10.1017/S0033822200033154">doi:10.1017/S0033822200033154</a>. This package complements the data package 'rintcal'.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Maarten Blaauw <a href="mailto:maarten.blaauw@qub.ac.uk">maarten.blaauw@qub.ac.uk</a> (<a href="https://orcid.org/0000-0002-5680-1515">ORCID</a>)
</p>

<hr>
<h2 id='age.F14C'>To be deprecated. Use C14.F14C instead</h2><span id='topic+age.F14C'></span>

<h3>Description</h3>

<p>Calculate F14C values from radiocarbon ages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age.F14C(mn, sdev = c(), decimals = 5, lambda = 8033)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="age.F14C_+3A_mn">mn</code></td>
<td>
<p>Reported mean of the 14C age.</p>
</td></tr>
<tr><td><code id="age.F14C_+3A_sdev">sdev</code></td>
<td>
<p>Reported error of the 14C age. If left empty, will translate mn to F14C.</p>
</td></tr>
<tr><td><code id="age.F14C_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals required for the F14C value. Defaults to 5.</p>
</td></tr>
<tr><td><code id="age.F14C_+3A_lambda">lambda</code></td>
<td>
<p>The mean-life of radiocarbon (based on Libby half-life of 5568 years)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as F14C or fraction modern carbon. Since Bacon expects radiocarbon ages,
this function can be used to calculate F14C values from radiocarbon ages. The reverse function of <a href="#topic+F14CtoC14">F14CtoC14</a>.
</p>


<h3>Value</h3>

<p>F14C values from C14 ages.
</p>

<hr>
<h2 id='age.pMC'>To be deprecated. Use C14topMC instead.</h2><span id='topic+age.pMC'></span>

<h3>Description</h3>

<p>Calculate pMC values from radiocarbon ages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age.pMC(mn, sdev = c(), ratio = 100, decimals = 5, lambda = 8033)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="age.pMC_+3A_mn">mn</code></td>
<td>
<p>Reported mean of the 14C age.</p>
</td></tr>
<tr><td><code id="age.pMC_+3A_sdev">sdev</code></td>
<td>
<p>Reported error of the 14C age.</p>
</td></tr>
<tr><td><code id="age.pMC_+3A_ratio">ratio</code></td>
<td>
<p>Most modern-date values are reported against <code>100</code>. If it is against <code>1</code> instead, a warning is provided; use <code>age.F14C</code>.</p>
</td></tr>
<tr><td><code id="age.pMC_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals required for the pMC value. Defaults to 5.</p>
</td></tr>
<tr><td><code id="age.pMC_+3A_lambda">lambda</code></td>
<td>
<p>The mean-life of radiocarbon (based on Libby half-life of 5568 years)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as pMC or percent modern carbon. Since Bacon expects radiocarbon ages,
this function can be used to calculate pMC values from radiocarbon ages. The reverse function of pMC.C14.
</p>


<h3>Value</h3>

<p>pMC values from C14 ages.
</p>

<hr>
<h2 id='as.bin'>Combine multiple radiocarbon dates within bins</h2><span id='topic+as.bin'></span>

<h3>Description</h3>

<p>Combine all calibrated dates by calculating their product for a range of calendar ages, as if all dates belonged to the same (unknown) calendar age bin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.bin(
  y,
  er,
  width = 100,
  move.by = c(),
  move.res = 100,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  is.F = FALSE,
  as.F = FALSE,
  thiscurve = NULL,
  yrsteps = 1,
  threshold = 0.001,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  BCAD = FALSE,
  cc.dir = NULL,
  age.lim = c(),
  age.lab = c(),
  d.lim = c(),
  calib.col = rgb(0, 0, 0, 0.2),
  bin.col = rgb(0, 0, 1, 0.5),
  bin.height = 4,
  talk = TRUE,
  prob = 0.95,
  roundby = 0,
  bty = "n"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.bin_+3A_y">y</code></td>
<td>
<p>The set of radiocarbon dates to be tested</p>
</td></tr>
<tr><td><code id="as.bin_+3A_er">er</code></td>
<td>
<p>The lab errors of the radiocarbon dates</p>
</td></tr>
<tr><td><code id="as.bin_+3A_width">width</code></td>
<td>
<p>The bin width to apply. Narrower bins will result in fewer dates fitting those bins, but in more detailed bin width histograms.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_move.by">move.by</code></td>
<td>
<p>Step size by which the window moves. Left empty by default, and then the moves are set by the parameter move.res.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_move.res">move.res</code></td>
<td>
<p>The amount of steps taken to make the histogram. Defaults to <code>move.res=100</code> - a compromise between detail obtained and calculation speed.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to use. Defaults to IntCal20 (<code>cc=1</code>).</p>
</td></tr>
<tr><td><code id="as.bin_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="as.bin_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="as.bin_+3A_is.f">is.F</code></td>
<td>
<p>Set this to TRUE if the provided age and error are in the F14C realm.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="as.bin_+3A_yrsteps">yrsteps</code></td>
<td>
<p>Steps to use for interpolation. Defaults to the cal BP steps in the calibration curve</p>
</td></tr>
<tr><td><code id="as.bin_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=1e-6</code>.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="as.bin_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="as.bin_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="as.bin_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_age.lim">age.lim</code></td>
<td>
<p>Limits of the age axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_age.lab">age.lab</code></td>
<td>
<p>Label of the age axis. Defaults to cal BP or BC/AD.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_d.lim">d.lim</code></td>
<td>
<p>Limits of the depth/vertical axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_calib.col">calib.col</code></td>
<td>
<p>The colour of the individual calibrated ages. Defaults to semi-transparent grey.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_bin.col">bin.col</code></td>
<td>
<p>The colour of the combined</p>
</td></tr>
<tr><td><code id="as.bin_+3A_bin.height">bin.height</code></td>
<td>
<p>The height of the combined distribution</p>
</td></tr>
<tr><td><code id="as.bin_+3A_talk">talk</code></td>
<td>
<p>Whether or not to report the calculations made. Defaults to <code>talk=TRUE</code>.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_prob">prob</code></td>
<td>
<p>Probability range for highest posterior density (hpd) values. Defaults to <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="as.bin_+3A_roundby">roundby</code></td>
<td>
<p>Rounding of reported years. Defaults to 0 decimals</p>
</td></tr>
<tr><td><code id="as.bin_+3A_bty">bty</code></td>
<td>
<p>Draw a box around a box of a certain shape. Defaults to <code>bty="n"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates the amount of calibrated dates that fall within a specific bin, and calculates these bins as moving windows over the range of calendar ages to which the radiocarbon ages calibrate.
</p>


<h3>Value</h3>

<p>The number of dates that fall within the moving bins, for each bin.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(shroud)
  shroudbin &lt;- as.bin(shroud$y, shroud$er, 50, 10) 
  # bins of 50 yr, moving by 10 yr, slow

</code></pre>

<hr>
<h2 id='as.one'>Combine multiple radiocarbon dates assuming they belong to the same single year</h2><span id='topic+as.one'></span>

<h3>Description</h3>

<p>Combine all calibrated dates by calculating their product for a range of calendar ages, as if all dates belonged to the same (unknown) single calendar age. This assumed that they all belong to the same single year in time. Use with great care, as often dates could stem from material that could have accumulated over a (much) longer time-span, and if so, then the result will be wrong. See Baillie (1991)'s 'suck-in' effect, Journal of Theoretical Archaeology 2, 12-16.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.one(
  y,
  er,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  is.F = FALSE,
  as.F = FALSE,
  thiscurve = NULL,
  yrsteps = 1,
  threshold = 0.001,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  BCAD = FALSE,
  cc.dir = NULL,
  age.lim = c(),
  age.lab = c(),
  d.lim = c(),
  calib.col = rgb(0, 0, 0, 0.2),
  one.col = rgb(0, 0, 1, 0.5),
  one.height = 4,
  prob = 0.95,
  talk = TRUE,
  roundby = 0,
  bty = "n"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.one_+3A_y">y</code></td>
<td>
<p>The set of radiocarbon dates to be tested</p>
</td></tr>
<tr><td><code id="as.one_+3A_er">er</code></td>
<td>
<p>The lab errors of the radiocarbon dates</p>
</td></tr>
<tr><td><code id="as.one_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to use. Defaults to IntCal20 (<code>cc=1</code>).</p>
</td></tr>
<tr><td><code id="as.one_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages.</p>
</td></tr>
<tr><td><code id="as.one_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="as.one_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="as.one_+3A_is.f">is.F</code></td>
<td>
<p>Set this to TRUE if the provided age and error are in the F14C realm.</p>
</td></tr>
<tr><td><code id="as.one_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="as.one_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="as.one_+3A_yrsteps">yrsteps</code></td>
<td>
<p>Steps to use for interpolation. Defaults to the cal BP steps in the calibration curve</p>
</td></tr>
<tr><td><code id="as.one_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=1e-6</code>.</p>
</td></tr>
<tr><td><code id="as.one_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="as.one_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="as.one_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="as.one_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="as.one_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="as.one_+3A_age.lim">age.lim</code></td>
<td>
<p>Limits of the age axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="as.one_+3A_age.lab">age.lab</code></td>
<td>
<p>Label of the age axis. Defaults to cal BP or BC/AD.</p>
</td></tr>
<tr><td><code id="as.one_+3A_d.lim">d.lim</code></td>
<td>
<p>Limits of the depth/vertical axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="as.one_+3A_calib.col">calib.col</code></td>
<td>
<p>The colour of the individual calibrated ages. Defaults to semi-transparent grey.</p>
</td></tr>
<tr><td><code id="as.one_+3A_one.col">one.col</code></td>
<td>
<p>The colour of the combined</p>
</td></tr>
<tr><td><code id="as.one_+3A_one.height">one.height</code></td>
<td>
<p>The height of the combined distribution</p>
</td></tr>
<tr><td><code id="as.one_+3A_prob">prob</code></td>
<td>
<p>Probability range for highest posterior density (hpd) values. Defaults to <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="as.one_+3A_talk">talk</code></td>
<td>
<p>Whether or not to provide an analysis of the results</p>
</td></tr>
<tr><td><code id="as.one_+3A_roundby">roundby</code></td>
<td>
<p>Rounding of reported years. Defaults to 0 decimals</p>
</td></tr>
<tr><td><code id="as.one_+3A_bty">bty</code></td>
<td>
<p>Draw a box around a box of a certain shape. Defaults to <code>bty="n"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates the product of all calibrated probabilities, over the range of calendar ages to which the radiocarbon ages calibrate.
</p>


<h3>Value</h3>

<p>The product of all calibrated probabilities over the range of cal BP years.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(shroud)
  as.one(shroud$y,shroud$er, BCAD=TRUE) # but note the scatter!
  Zu &lt;- grep("ETH", shroud$ID) # Zurich lab only
  as.one(shroud$y[Zu],shroud$er[Zu], BCAD=TRUE)
</code></pre>

<hr>
<h2 id='BCADtoC14'>Find the 14C age and error belonging to a BC/AD age.</h2><span id='topic+BCADtoC14'></span>

<h3>Description</h3>

<p>Given a calendar age, the calibration curve (default cc=1) is interpolated and the corresponding 14C age and error are returned. BC ages are negative. In this implementation, the year 0 BC/AD does exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCADtoC14(
  x,
  cc = 1,
  postbomb = FALSE,
  zero = TRUE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BCADtoC14_+3A_x">x</code></td>
<td>
<p>The BC/AD year.</p>
</td></tr>
<tr><td><code id="BCADtoC14_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="BCADtoC14_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="BCADtoC14_+3A_zero">zero</code></td>
<td>
<p>Whether or not to include 0 in BC/AD years. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="BCADtoC14_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="BCADtoC14_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="BCADtoC14_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolation is used, and values outside the calibration curve are given as NA. For ages younger than AD 1950, a postbomb curve will have to be provided.
</p>


<h3>Value</h3>

<p>The calibration-curve 14C year belonging to the entered BC/AD age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  BCADtoC14(100)
</code></pre>

<hr>
<h2 id='BCADtocalBP'>calculate cal BP ages from BC/AD ages</h2><span id='topic+BCADtocalBP'></span>

<h3>Description</h3>

<p>calculate cal BP ages from BC/AD ages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCADtocalBP(x, zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BCADtocalBP_+3A_x">x</code></td>
<td>
<p>The BCAD age(s) to be translated into cal BP age(s). BC ages are negative, AD ages are positive.</p>
</td></tr>
<tr><td><code id="BCADtocalBP_+3A_zero">zero</code></td>
<td>
<p>Whether or not zero BC/AD should be included. Defaults to 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Turn BC/AD (or BCE/CE) ages into cal BP ages. Negative ages indicate BC, positive ages AD. Since the Gregorian and Julian calendars do not include 0 BC/AD (i.e., 31 December of 1 BC is followed by 1 January of AD 1), zero can be omitted. The years then go from 1 (AD) to -1 (i.e., 1 BC). Other calendars, such as the astronomical one, do include zero. The often-used BCE/CE ages are equivalent to BC/AD.
</p>


<h3>Value</h3>

<p>The cal BP age(s).
</p>


<h3>Examples</h3>

<pre><code class='language-R'> BCADtocalBP(2024)
 BCADtocalBP(-1, zero=TRUE)
 BCADtocalBP(-1, zero=FALSE)
</code></pre>

<hr>
<h2 id='BCADtoD14C'>Find the pMC and error belonging to a cal BP age.</h2><span id='topic+BCADtoD14C'></span>

<h3>Description</h3>

<p>Given a calendar age, the calibration curve (default cc=1) is interpolated and the corresponding F14C value and error are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCADtoD14C(
  x,
  zero = TRUE,
  cc = 1,
  postbomb = FALSE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BCADtoD14C_+3A_x">x</code></td>
<td>
<p>The cal BP year.</p>
</td></tr>
<tr><td><code id="BCADtoD14C_+3A_zero">zero</code></td>
<td>
<p>Whether or not to include 0 in BC/AD years. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="BCADtoD14C_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="BCADtoD14C_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="BCADtoD14C_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="BCADtoD14C_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="BCADtoD14C_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolation is used, and values outside the calibration curve are given as NA. For negative cal BP ages, a postbomb curve will have to be provided.
</p>


<h3>Value</h3>

<p>The calibration-curve 14C year belonging to the entered cal BP age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  BCADtoD14C(1900)
</code></pre>

<hr>
<h2 id='BCADtoF14C'>Find the F14C and error belonging to a BC/AD age.</h2><span id='topic+BCADtoF14C'></span>

<h3>Description</h3>

<p>Given a calendar age, the calibration curve (default cc=1) is interpolated and the corresponding F14C and error are returned. BC ages are negative. In this implementation, the year 0 BC/AD does exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCADtoF14C(
  x,
  cc = 1,
  postbomb = FALSE,
  zero = TRUE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BCADtoF14C_+3A_x">x</code></td>
<td>
<p>The BC/AD year.</p>
</td></tr>
<tr><td><code id="BCADtoF14C_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="BCADtoF14C_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="BCADtoF14C_+3A_zero">zero</code></td>
<td>
<p>Whether or not to include 0 in BC/AD years. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="BCADtoF14C_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="BCADtoF14C_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="BCADtoF14C_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolation is used, and values outside the calibration curve are given as NA. For ages younger than AD 1950, a postbomb curve will have to be provided.
</p>


<h3>Value</h3>

<p>The calibration-curve F14C belonging to the entered BC/AD age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  BCADtoF14C(100)
</code></pre>

<hr>
<h2 id='BCADtopMC'>Find the pMC and error belonging to a BC/AD age.</h2><span id='topic+BCADtopMC'></span>

<h3>Description</h3>

<p>Given a calendar age, the calibration curve (default cc=1) is interpolated and the corresponding pMC and error are returned. BC ages are negative. In this implementation, the year 0 BC/AD does exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCADtopMC(
  x,
  cc = 1,
  postbomb = FALSE,
  zero = TRUE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BCADtopMC_+3A_x">x</code></td>
<td>
<p>The BC/AD year.</p>
</td></tr>
<tr><td><code id="BCADtopMC_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="BCADtopMC_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="BCADtopMC_+3A_zero">zero</code></td>
<td>
<p>Whether or not to include 0 in BC/AD years. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="BCADtopMC_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="BCADtopMC_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="BCADtopMC_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolation is used, and values outside the calibration curve are given as NA. For ages younger than AD 1950, a postbomb curve will have to be provided.
</p>


<h3>Value</h3>

<p>The calibration-curve F14C belonging to the entered BC/AD age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  BCADtopMC(100)
</code></pre>

<hr>
<h2 id='C14toBCAD'>Find the BCAD age(s) crossing a C14 age.</h2><span id='topic+C14toBCAD'></span>

<h3>Description</h3>

<p>Find the BCAD ages where the calibration curve crosses a given C14 age. This function is for illustration only and not to be used for, e.g., calibration, because intercept calibration is an outdated method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C14toBCAD(
  y,
  cc = 1,
  postbomb = FALSE,
  rule = 1,
  zero = TRUE,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="C14toBCAD_+3A_y">y</code></td>
<td>
<p>The C14 age.</p>
</td></tr>
<tr><td><code id="C14toBCAD_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="C14toBCAD_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="C14toBCAD_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="C14toBCAD_+3A_zero">zero</code></td>
<td>
<p>Whether or not to include 0 in BC/AD years. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="C14toBCAD_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="C14toBCAD_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>. Whereas each cal BP age will only have one single IntCal radiocarbon age (mu), the same cannot be said for the other way round. Recurring C14 ages do happen, especially during periods of plateaux and wiggles. Therefore, there can be multiple cal BP ages for a single C14 age. In the early days, radiocarbon calibration used an 'intercept method' to find possible calendar ages belonging to a radiocarbon age, but this is problematic since small deviations in the C14 age can easily cause more or fewer crossing cal BP ages (try for example C14tocalBP(130) vs C14tocalBP(129)), and moreover, this approach does not deal well with the errors in either a date of the calibration curve. Therefore, the probabilistic approach to radiocarbon calibration (which starts with a cal BP age and then looks up the corresponding C14 age) has taken over as the standard.
</p>


<h3>Value</h3>

<p>The BCAD age(s) belonging to the entered C14 age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  y &lt;- 130
  calibrate(y,10, BCAD=TRUE)
  abline(h=y)
  abline(v=C14toBCAD(y))
</code></pre>

<hr>
<h2 id='C14tocalBP'>Find the calBP age(s) crossing a C14 age.</h2><span id='topic+C14tocalBP'></span>

<h3>Description</h3>

<p>Find the cal BP ages where the calibration curve crosses a given C14 age. This function is for illustration only and not to be used for, e.g., calibration, because intercept calibration is an outdated method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C14tocalBP(
  y,
  cc = 1,
  postbomb = FALSE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="C14tocalBP_+3A_y">y</code></td>
<td>
<p>The C14 age.</p>
</td></tr>
<tr><td><code id="C14tocalBP_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="C14tocalBP_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="C14tocalBP_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="C14tocalBP_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="C14tocalBP_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>. Whereas each cal BP age will only have one single IntCal radiocarbon age (mu), the same cannot be said for the other way round. Recurring C14 ages do happen, especially during periods of plateaux and wiggles. Therefore, there can be multiple cal BP ages for a single C14 age. In the early days, radiocarbon calibration used an 'intercept method' to find possible calendar ages belonging to a radiocarbon age, but this is problematic since small deviations in the C14 age can easily cause more or fewer crossing cal BP ages (try for example C14tocalBP(130) vs C14tocalBP(129)), and moreover, this approach does not deal well with the errors in either a date of the calibration curve. Therefore, the probabilistic approach to radiocarbon calibration (which starts with a cal BP age and then looks up the corresponding C14 age) has taken over as the standard.
</p>


<h3>Value</h3>

<p>The cal BP age(s) belonging to the entered C14 age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  y &lt;- 130
  calibrate(y,10)
  abline(h=y)
  abline(v=C14tocalBP(y))
</code></pre>

<hr>
<h2 id='C14toD14C'>Transform C14 age(s) into D14C</h2><span id='topic+C14toD14C'></span>

<h3>Description</h3>

<p>Transform C14 age(s) into D14C
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C14toD14C(y, er = NULL, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="C14toD14C_+3A_y">y</code></td>
<td>
<p>The C14 age to translate</p>
</td></tr>
<tr><td><code id="C14toD14C_+3A_er">er</code></td>
<td>
<p>Reported error of the C14 age. Returns just the mean if left empty.</p>
</td></tr>
<tr><td><code id="C14toD14C_+3A_t">t</code></td>
<td>
<p>the cal BP age</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As explained by Heaton et al. 2020 (Radiocarbon), 14C measurements are commonly expressed in
three domains: Delta14C, F14C and the radiocarbon age. This function translates C14 ages into Delta14C, the historical level of Delta14C in the year t cal BP. Note that per convention, this function uses the Cambridge half-life, not the Libby half-life.
</p>


<h3>Value</h3>

<p>The corresponding D14C value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  C14toD14C(0.985, 20, 222)
</code></pre>

<hr>
<h2 id='C14toF14C'>Calculate F14C values from C14 ages</h2><span id='topic+C14toF14C'></span>

<h3>Description</h3>

<p>Calculate F14C values from radiocarbon ages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C14toF14C(y, er = NULL, decimals = 5, lambda = 8033)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="C14toF14C_+3A_y">y</code></td>
<td>
<p>Reported mean of the 14C age.</p>
</td></tr>
<tr><td><code id="C14toF14C_+3A_er">er</code></td>
<td>
<p>Reported error of the 14C age. If left empty, will translate y to F14C.</p>
</td></tr>
<tr><td><code id="C14toF14C_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals required for the F14C value. Defaults to 5.</p>
</td></tr>
<tr><td><code id="C14toF14C_+3A_lambda">lambda</code></td>
<td>
<p>The mean-life of radiocarbon (based on Libby half-life of 5568 years)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as F14C or fraction modern carbon. Since software such as Bacon expects radiocarbon ages,
this function can be used to calculate F14C values from radiocarbon ages. The reverse function of <a href="#topic+F14C.age">F14C.age</a>.
</p>


<h3>Value</h3>

<p>F14C values from C14 ages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  C14toF14C(-2000, 20)
</code></pre>

<hr>
<h2 id='C14topMC'>Calculate pMC values from C14 ages</h2><span id='topic+C14topMC'></span>

<h3>Description</h3>

<p>Calculate pMC values from radiocarbon ages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C14topMC(y, er = NULL, decimals = 5, lambda = 8033)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="C14topMC_+3A_y">y</code></td>
<td>
<p>Reported mean of the C14 age.</p>
</td></tr>
<tr><td><code id="C14topMC_+3A_er">er</code></td>
<td>
<p>Reported error of the C14 age.</p>
</td></tr>
<tr><td><code id="C14topMC_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals required for the pMC value. Defaults to 5.</p>
</td></tr>
<tr><td><code id="C14topMC_+3A_lambda">lambda</code></td>
<td>
<p>The mean-life of radiocarbon (based on Libby half-life of 5568 years)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as pMC or percent modern carbon. Since Bacon expects radiocarbon ages,
this function can be used to calculate pMC values from radiocarbon ages. The reverse function of <a href="#topic+pMCtoC14">pMCtoC14</a>.
</p>


<h3>Value</h3>

<p>pMC values from C14 ages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  C14topMC(-2000, 20)
  C14topMC(-2000, 20, 1)
</code></pre>

<hr>
<h2 id='calBPtoBCAD'>calculate BC/AD ages from cal BP ages</h2><span id='topic+calBPtoBCAD'></span>

<h3>Description</h3>

<p>calculate BC/AD ages from cal BP ages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calBPtoBCAD(x, zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calBPtoBCAD_+3A_x">x</code></td>
<td>
<p>The calBP age(s) to be translated into BC/AD ages.</p>
</td></tr>
<tr><td><code id="calBPtoBCAD_+3A_zero">zero</code></td>
<td>
<p>Whether or not zero BC/AD should be included. Defaults to 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Turn cal BP ages into BC/AD (or BCE/CE). Negative ages indicate BC, positive ages AD. Since the Gregorian and Julian calendars do not include 0 BCAD (i.e., 31 December of 1 BC is followed by 1 January of AD 1), zero can be omitted. The years then go from 1 (AD) to -1 (i.e., 1 BC). Other calendars, such as the astronomical one, do include zero. The often-used BCE/CE ages are equivalent to BC/AD.
</p>


<h3>Value</h3>

<p>The BC/AD age(s). BC ages are negative, AD ages are positive.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> calBPtoBCAD(2024)
 calBPtoBCAD(1945:1955, zero=TRUE)
 calBPtoBCAD(1945:1955, zero=FALSE)
</code></pre>

<hr>
<h2 id='calBPtoC14'>Find the 14C age and error belonging to a cal BP age.</h2><span id='topic+calBPtoC14'></span>

<h3>Description</h3>

<p>Given a calendar age, the calibration curve (default cc=1) is interpolated and the corresponding 14C age and error are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calBPtoC14(
  x,
  cc = 1,
  postbomb = FALSE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calBPtoC14_+3A_x">x</code></td>
<td>
<p>The cal BP year.</p>
</td></tr>
<tr><td><code id="calBPtoC14_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="calBPtoC14_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="calBPtoC14_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="calBPtoC14_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="calBPtoC14_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolation is used, and values outside the calibration curve are given as NA. For negative cal BP ages, a postbomb curve will have to be provided.
</p>


<h3>Value</h3>

<p>The calibration-curve 14C year belonging to the entered cal BP age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calBPtoC14(100)
</code></pre>

<hr>
<h2 id='calBPtoD14C'>Find the pMC and error belonging to a cal BP age.</h2><span id='topic+calBPtoD14C'></span>

<h3>Description</h3>

<p>Given a calendar age, the calibration curve (default cc=1) is interpolated and the corresponding F14C value and error are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calBPtoD14C(
  x,
  cc = 1,
  postbomb = FALSE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calBPtoD14C_+3A_x">x</code></td>
<td>
<p>The cal BP year.</p>
</td></tr>
<tr><td><code id="calBPtoD14C_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="calBPtoD14C_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="calBPtoD14C_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="calBPtoD14C_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="calBPtoD14C_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolation is used, and values outside the calibration curve are given as NA. For negative cal BP ages, a postbomb curve will have to be provided.
</p>


<h3>Value</h3>

<p>The calibration-curve 14C year belonging to the entered cal BP age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  calBPtoD14C(100)
</code></pre>

<hr>
<h2 id='calBPtoF14C'>Find the F14C and error belonging to a cal BP age.</h2><span id='topic+calBPtoF14C'></span>

<h3>Description</h3>

<p>Given a calendar age, the calibration curve (default cc=1) is interpolated and the corresponding F14C value and error are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calBPtoF14C(
  x,
  cc = 1,
  postbomb = FALSE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calBPtoF14C_+3A_x">x</code></td>
<td>
<p>The cal BP year.</p>
</td></tr>
<tr><td><code id="calBPtoF14C_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="calBPtoF14C_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="calBPtoF14C_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="calBPtoF14C_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="calBPtoF14C_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolation is used, and values outside the calibration curve are given as NA. For negative cal BP ages, a postbomb curve will have to be provided.
</p>


<h3>Value</h3>

<p>The calibration-curve 14C year belonging to the entered cal BP age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  calBPtoF14C(100)
</code></pre>

<hr>
<h2 id='calBPtopMC'>Find the pMC and error belonging to a cal BP age.</h2><span id='topic+calBPtopMC'></span>

<h3>Description</h3>

<p>Given a calendar age, the calibration curve (default cc=1) is interpolated and the corresponding F14C value and error are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calBPtopMC(
  x,
  cc = 1,
  postbomb = FALSE,
  rule = 1,
  cc.dir = NULL,
  thiscurve = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calBPtopMC_+3A_x">x</code></td>
<td>
<p>The cal BP year.</p>
</td></tr>
<tr><td><code id="calBPtopMC_+3A_cc">cc</code></td>
<td>
<p>calibration curve for C14 (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="calBPtopMC_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="calBPtopMC_+3A_rule">rule</code></td>
<td>
<p>How should R's approx function deal with extrapolation. If <code>rule=1</code>, the default, then NAs are returned for such points and if it is 2, the value at the closest data extreme is used.</p>
</td></tr>
<tr><td><code id="calBPtopMC_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="calBPtopMC_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolation is used, and values outside the calibration curve are given as NA. For negative cal BP ages, a postbomb curve will have to be provided.
</p>


<h3>Value</h3>

<p>The calibration-curve 14C year belonging to the entered cal BP age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  calBPtopMC(100)
</code></pre>

<hr>
<h2 id='caldist'>Calculate calibrated distribution</h2><span id='topic+caldist'></span>

<h3>Description</h3>

<p>Calculate the calibrated distribution of a radiocarbon date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caldist(
  y,
  er,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  is.F = FALSE,
  as.F = FALSE,
  thiscurve = NULL,
  yrsteps = FALSE,
  cc.resample = FALSE,
  dist.res = 200,
  threshold = 0.001,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  normalise = TRUE,
  BCAD = FALSE,
  rule = 1,
  cc.dir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="caldist_+3A_y">y</code></td>
<td>
<p>Uncalibrated radiocarbon age</p>
</td></tr>
<tr><td><code id="caldist_+3A_er">er</code></td>
<td>
<p>Lab error of the radiocarbon age</p>
</td></tr>
<tr><td><code id="caldist_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to use. Defaults to IntCal20 (<code>cc=1</code>).</p>
</td></tr>
<tr><td><code id="caldist_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages.</p>
</td></tr>
<tr><td><code id="caldist_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="caldist_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="caldist_+3A_is.f">is.F</code></td>
<td>
<p>Set this to TRUE if the provided age and error are in the F14C realm.</p>
</td></tr>
<tr><td><code id="caldist_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="caldist_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="caldist_+3A_yrsteps">yrsteps</code></td>
<td>
<p>Steps to use for interpolation. Defaults to the cal BP steps in the calibration curve</p>
</td></tr>
<tr><td><code id="caldist_+3A_cc.resample">cc.resample</code></td>
<td>
<p>The IntCal20 curves have different densities (every year between 0 and 5 kcal BP, then every 5 yr up to 15 kcal BP, then every 10 yr up to 25 kcal BP, and then every 20 yr up to 55 kcal BP). If calibrated ages span these density ranges, their drawn heights can differ, as can their total areas (which should ideally all sum to the same size). To account for this, resample to a constant time-span, using, e.g., <code>cc.resample=5</code> for 5-yr timespans.</p>
</td></tr>
<tr><td><code id="caldist_+3A_dist.res">dist.res</code></td>
<td>
<p>As an alternative to yrsteps, provide the amount of 'bins' in the distribution</p>
</td></tr>
<tr><td><code id="caldist_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=1e-6</code>.</p>
</td></tr>
<tr><td><code id="caldist_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="caldist_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="caldist_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="caldist_+3A_normalise">normalise</code></td>
<td>
<p>Sum the entire calibrated distribution to 1. Defaults to <code>normalise=TRUE</code>.</p>
</td></tr>
<tr><td><code id="caldist_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="caldist_+3A_rule">rule</code></td>
<td>
<p>Which extrapolation rule to use. Defaults to <code>rule=1</code> which returns NAs.</p>
</td></tr>
<tr><td><code id="caldist_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The probability distribution(s) as two columns: cal BP ages and their associated probabilities
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calib &lt;- caldist(130,10)
plot(calib, type="l")
postbomb &lt;- caldist(-3030, 20, postbomb=1, BCAD=TRUE)
</code></pre>

<hr>
<h2 id='calib.t'>Comparison dates calibrated using both the t distribution (Christen and Perez 2009) and the normal distribution.</h2><span id='topic+calib.t'></span>

<h3>Description</h3>

<p>Visualise how a date calibrates using the t distribution and the normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calib.t(
  y = 2450,
  er = 50,
  t.a = 3,
  t.b = 4,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  as.F = FALSE,
  BCAD = FALSE,
  cc.dir = c(),
  normal.col = "red",
  normal.lwd = 1.5,
  t.col = rgb(0, 0, 0, 0.25),
  t.border = rgb(0, 0, 0, 0, 0.25),
  xlim = c(),
  ylim = c()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calib.t_+3A_y">y</code></td>
<td>
<p>The reported mean of the date.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_er">er</code></td>
<td>
<p>The reported error of the date.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_t.a">t.a</code></td>
<td>
<p>Value for the t parameter <code>a</code>.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_t.b">t.b</code></td>
<td>
<p>Value for the t parameter <code>b</code>.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_cc">cc</code></td>
<td>
<p>calibration curve for the radiocarbon date(s) (see the <code>rintcal</code> package).</p>
</td></tr>
<tr><td><code id="calib.t_+3A_postbomb">postbomb</code></td>
<td>
<p>Which postbomb curve to use for negative 14C dates.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="calib.t_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="calib.t_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory where the calibration curves for C14 dates <code>cc</code> are allocated. By default <code>cc.dir=c()</code>.
Use <code>cc.dir="."</code> to choose current working directory. Use <code>cc.dir="Curves/"</code> to choose sub-folder <code>Curves/</code>.</p>
</td></tr>
<tr><td><code id="calib.t_+3A_normal.col">normal.col</code></td>
<td>
<p>Colour of the normal curve</p>
</td></tr>
<tr><td><code id="calib.t_+3A_normal.lwd">normal.lwd</code></td>
<td>
<p>Line width of the normal curve</p>
</td></tr>
<tr><td><code id="calib.t_+3A_t.col">t.col</code></td>
<td>
<p>Colour of the t histogram</p>
</td></tr>
<tr><td><code id="calib.t_+3A_t.border">t.border</code></td>
<td>
<p>Colour of the border of the t histogram</p>
</td></tr>
<tr><td><code id="calib.t_+3A_xlim">xlim</code></td>
<td>
<p>x axis limits</p>
</td></tr>
<tr><td><code id="calib.t_+3A_ylim">ylim</code></td>
<td>
<p>y axis limits</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Radiocarbon and other dates are usually modelled using the normal distribution (red curve). The t approach (grey distribution) however allows for wider tails and thus tends to better accommodate outlying dates. This distribution requires two parameters, called 'a' and 'b'.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calib.t()

</code></pre>

<hr>
<h2 id='calibrate'>Plot individual calibrated dates.</h2><span id='topic+calibrate'></span>

<h3>Description</h3>

<p>Calibrate individual 14C dates, plot them and report calibrated ranges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate(
  age = 2450,
  error = 50,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  bombalert = TRUE,
  thiscurve = c(),
  as.F = FALSE,
  reservoir = 0,
  prob = 0.95,
  BCAD = FALSE,
  ka = FALSE,
  draw = TRUE,
  cal.lab = c(),
  C14.lab = c(),
  cal.lim = c(),
  C14.lim = c(),
  cc.col = rgb(0, 0.5, 0, 0.7),
  cc.fill = rgb(0, 0.5, 0, 0.7),
  date.col = "red",
  dist.col = rgb(0, 0, 0, 0.3),
  dist.fill = rgb(0, 0, 0, 0.3),
  hpd.fill = rgb(0, 0, 0, 0.3),
  dist.height = 0.3,
  dist.float = c(0.01, 0.01),
  cal.rev = FALSE,
  yr.steps = FALSE,
  cc.resample = 5,
  threshold = 5e-04,
  edge = TRUE,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  rounded = 1,
  every = 1,
  extend.range = 0.05,
  legend.cex = 0.8,
  legend1.loc = "topleft",
  legend2.loc = "topright",
  print.truncate.warning = TRUE,
  mgp = c(2, 1, 0),
  mar = c(3, 3, 1, 1),
  xaxs = "i",
  yaxs = "i",
  bty = "l",
  cc.dir = NULL,
  cc.er = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibrate_+3A_age">age</code></td>
<td>
<p>Mean of the uncalibrated C-14 age.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_error">error</code></td>
<td>
<p>Error of the uncalibrated C-14 age.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cc">cc</code></td>
<td>
<p>Calibration curve for C-14 dates (1, 2, 3, or 4, or, e.g., &quot;IntCal20&quot;, &quot;Marine20&quot;, &quot;SHCal20&quot;, &quot;nh1&quot;, &quot;sh3&quot;, or &quot;mixed&quot;).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not this is a postbomb age. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples). Can also be provided as option 'reservoir'.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation). Can also be provided within option 'reservoir'.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_bombalert">bombalert</code></td>
<td>
<p>Warn if a date is close to the lower limit of the IntCal curve. Defaults to <code>postbomb=TRUE</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error). Defaults to c().</p>
</td></tr>
<tr><td><code id="calibrate_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_reservoir">reservoir</code></td>
<td>
<p>Reservoir age, or reservoir age and age offset as two values (e.g., <code>reservoir=c(100,10)</code>).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_prob">prob</code></td>
<td>
<p>Probability confidence intervals (between 0 and 1).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_bcad">BCAD</code></td>
<td>
<p>Use BC/AD or cal BP scale (default cal BP).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_ka">ka</code></td>
<td>
<p>Use thousands of years instead of years in the plots and hpd ranges. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_draw">draw</code></td>
<td>
<p>Whether or not to draw the date. Can be set as FALSE to speed up things</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cal.lab">cal.lab</code></td>
<td>
<p>Label of the calendar/horizontal axis. Defaults to the calendar scale, but alternative names can be provided.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_c14.lab">C14.lab</code></td>
<td>
<p>Label of the C-14/vertical axis. Defaults to the 14C scale, but alternative names can be provided.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cal.lim">cal.lim</code></td>
<td>
<p>Minimum and maximum of calendar axis (default calculated automatically).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_c14.lim">C14.lim</code></td>
<td>
<p>Minimum and maximum of C-14 axis (default calculated automatically).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cc.col">cc.col</code></td>
<td>
<p>Colour of the lines of the calibration curve. Defaults to semi-transparent dark green; <code>cc.col=rgb(0,.5,0,0.7)</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cc.fill">cc.fill</code></td>
<td>
<p>Colour of the inner part of the calibration curve. Defaults to semi-transparent dark green; <code>cc.col=rgb(0,.5,0,0.7)</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_date.col">date.col</code></td>
<td>
<p>Colour of the &quot;dot-bar&quot; plot of the C14 date. Defaults to <code>date.col="red"</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_dist.col">dist.col</code></td>
<td>
<p>Colour of the outer lines of the distributions. Defaults to semi-transparent grey, <code>dist.col=rgb(0,0,0,0.2)</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_dist.fill">dist.fill</code></td>
<td>
<p>Colour of the inner part of the distributions. Defaults to semi-transparent grey, <code>dist.col=rgb(0,0,0,0.2)</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_hpd.fill">hpd.fill</code></td>
<td>
<p>Colour of the highest posterior density. Defaults to semi-transparent grey, <code>dist.col=rgb(0,0,0,0.3)</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_dist.height">dist.height</code></td>
<td>
<p>Maximum height of the C14 and calibrated distributions (as proportion of the invisible secondary axes). Defaults to 0.3.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_dist.float">dist.float</code></td>
<td>
<p>The probability distributions float a bit above the axes by default. Can be set to distinct heights of the axes, e.g.: <code>dist.float=c(0.05, 0.1)</code>, or to <code>dist.float=0</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cal.rev">cal.rev</code></td>
<td>
<p>Whether or not to reverse the direction of the calendar axis.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_yr.steps">yr.steps</code></td>
<td>
<p>Temporal resolution at which C-14 ages are calibrated (in calendar years). By default follows the spacing in the calibration curve.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cc.resample">cc.resample</code></td>
<td>
<p>The IntCal20 curves have different densities (every year between 0 and 5 kcal BP, then every 5 yr up to 15 kcal BP, then every 10 yr up to 25 kcal BP, and then every 20 yr up to 55 kcal BP). If calibrated ages span these density ranges, their drawn heights can differ, as can their total areas (which should ideally all sum to the same size). To account for this, resample to a constant time-span, using, e.g., cc.resample=5 for 5-yr timespans.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_threshold">threshold</code></td>
<td>
<p>Below which value should probabilities be excluded from calculations.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_edge">edge</code></td>
<td>
<p>How to treat dates are at or beyond the edge of the calibration curve. If dates are truncated, a warning is given. If they lie beyond the calibration curve, an error is given.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_rounded">rounded</code></td>
<td>
<p>Rounding of the percentages of the reported hpd ranges. Defaults to 1 decimal.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_every">every</code></td>
<td>
<p>Yearly precision (defaults to <code>every=1</code>).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_extend.range">extend.range</code></td>
<td>
<p>Range by which the axes are extended beyond the data limits. Defaults to 5%.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_legend.cex">legend.cex</code></td>
<td>
<p>Size of the font of the legends. Defaults to 0.8.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_legend1.loc">legend1.loc</code></td>
<td>
<p>Where the first legend (with the calibration curve name and the uncalibrated date) is plotted. Defaults to topleft.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_legend2.loc">legend2.loc</code></td>
<td>
<p>Where the second legend (with the hpd ranges) is plotted. Defaults to topright.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_print.truncate.warning">print.truncate.warning</code></td>
<td>
<p>Whether or not a truncation warning is printed on the plot. Defaults to <code>print.truncate.warning=TRUE</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_mgp">mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_mar">mar</code></td>
<td>
<p>Plot margins (amount of white space along edges of axes 1-4).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_xaxs">xaxs</code></td>
<td>
<p>Whether or not to extend the limits of the horizontal axis. Defaults to <code>xaxs="i"</code> which does not extend the limits.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_yaxs">yaxs</code></td>
<td>
<p>Whether or not to extend the limits of the vertical axis. Defaults to <code>yaxs="i"</code> which does not extend the limits.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_bty">bty</code></td>
<td>
<p>Draw a box around the graph (&quot;n&quot; for none, and &quot;l&quot;, &quot;7&quot;, &quot;c&quot;, &quot;u&quot;, &quot;]&quot; or &quot;o&quot; for correspondingly shaped boxes).</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_cc.er">cc.er</code></td>
<td>
<p>The error of the calibration curve. Only used for plotting the uncalibrated C14 distribution, which by default only shows the date's uncertainty (the calibration curve uncertainty is indeed taken into account during calibration). If known, the calibration curve's error can be added.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_...">...</code></td>
<td>
<p>Other plotting parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Type <code>calibrate()</code> to see how a date of 2450 +- 50 14C BP gets calibrated (the calibration curve happens to show
a plateau around this 14C age). To calibrate a different date, provide its reported mean and error (1
standard deviation error as reported by the radiocarbon laboratory) as follows: <code>calibrate(mean, error)</code>,
e.g., for a date of 130 +- 10 14C BP, type calibrate<code>(age=130, error=10)</code> or, shorter, <code>calibrate(130,10)</code>.
</p>
<p>In case the date has a reservoir effect or age offset, e.g. of 100 14C years, provide this as follows:
<code>calibrate(130, 10, reservoir=100)</code>. If you want to include an uncertainty for this offset, provide this as follows,
e.g., for an uncertainty of 50yr, <code>calibrate(130,10,reservoir=c(100, 50))</code>.
The uncertainty for the age offset will then be added to the error (by taking the square root of the sum
of the squared error and the squared offset uncertainty). If the carbon of your sample has mixed marine/terrestrial sources,
instead apply the marine offset using mix.curves and calibrate the date using that custom-built curve (cc=&quot;mixed&quot;).
</p>
<p>If you prefer to work with, e.g., 68 % as opposed to the default 95 % confidence intervals,
type: <code>calibrate(130, 10, prob=0.68)</code> or <code>calibrate(130, 10,, 0.68)</code> (the commas between the brackets indicate the position of the option;
the standard deviation is the fourth option of the <code>calibrate</code> function). The calibrated distribution can be calculated
for every single calendar year (<code>yrsteps=1</code>) within a wide range of the 14C date. Probabilities below a threshold (default <code>threshold=0.0005</code>) will be neglected.
</p>
<p>By default the northern hemisphere terrestrial calibration curve is used (<code>cc=1 or cc1="IntCal20"</code>).
To use alternative curves, use <code>cc=2</code> (<code>cc2="Marine20"</code>), <code>cc=3</code> (<code>cc3="SHCal20C"</code>),
<code>cc=4</code> (<code>cc4="mixed.14C"</code>), or specify a postbomb curve (e.g., <code>cc="nh1"</code>).
</p>
<p>Calibrate works in cal BP (calendar years before AD 1950) by default, but can work with cal BC/AD through the option <code>BCAD=TRUE</code>.
</p>
<p>By default the Gaussian distribution is used to calibrate dates. For use of the t distribution (Christen and Perez 2016) instead,
set <code>normal=FALSE</code> provide values for t.a and t.b (defaults to <code>t.a=3</code> and <code>t.b=4</code>).
</p>
<p>Calibrated distributions are usually reduced to their 68% or 95% calibrated ranges, taking into account the asymmetric
and multi-peaked shape of these distributions.
Calibrated ranges at 68% will obviously result in narrower confidence intervals, and a perceived higher precision, than 95% ranges. However, given the often
asymmetric and multi-modal nature of calibrated distributions, the probability that the 'true' calendar date
lies outside the 1 standard deviation hpd ranges is considerable (c. 32%). Therefore the use of 95% calibrated ranges is preferable,
and default.
</p>
<p>Negative radiocarbon ages are calibrated with postbomb curves, but the user needs to tell which curve to use.
For example, to use the first of the three northern hemisphere curves, provide the option <code>cc="nh1"</code>, <code>cc="nh2"</code>, <code>cc="nh3"</code>,
while for southern hemisphere samples, use <code>cc="sh1-2"</code> or <code>cc="sh3"</code>.
</p>
<p>A graph of the calibration is produced, and it can be adapted in several ways.
The limits of the horizontal (calendar scale) and vertical (14C scale) axes are calculated automatically
but can be changed by providing alternative values for the options <code>cal.lim, C14.lim</code>.
The titles of both axis can be changed by providing alternative titles to <code>cal.lab</code> and/or <code>C14.lab</code>. The heights of the distributions of the 14C and calibrated
ages can be set to alternative values using <code>dist.height</code> (default <code>0.3</code> which plots the distribution up to 30% of the height of the entire graph).
Parameters for white space around the
graph can be changed (default <code>mar=c(3.5, 2, 2, 1</code>) for spacing below, to the left, above and to the right respectively),
as can the spacing for the axis labels (<code>mgp=c(2,1,0)</code>). By default, the axes are connected at the lower left, <code>bty="l"</code>.
Check the R documentation of <code>par()</code> for more options.
</p>
<p>The colours of the 14C date, the calibration curve, the distributions, and the highest posterior density (hpd)
ranges, can be changed by providing an alternative colour in <code>date.col</code>, <code>cc.col</code>, <code>dist.col</code>, and/or <code>hpd.col</code>, respectively.
The default colours are transparent grey for the dates probability distributions (<code>dist.col=rgb(0,0,0, 0.3)</code> and <code>sd.col=rgb(0,0,0, 0.5)</code>;
change the last value of rgb for different greyscale values), red for the uncalibrated mean and error bars (<code>date.col="red"</code>),
and transparent green for the calibration curve (<code>cc.col=rgb(0, 0.5, 0, 0.7)</code>). R's rgb() function expects values between <code>0</code> and <code>1</code>
for red, green and blue, respectively, followed by a value for the semi-transparency (also between 0 and 1). Some graphic devices
such as postscript are unable to use transparency; in that case provide different colours or leave the fourth value empty.
</p>


<h3>Value</h3>

<p>A graph of the raw and calibrated C-14 date, the calibrated ranges and, invisibly, the calibrated distribution and hpd ranges.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calibrate()
calibrate(130, 10)
cal &lt;- calibrate(2550, 20, reservoir=100)
cal; plot(cal[[1]])
calibrate(130, 10, prob=0.68)
calibrate(age=130, error=10, BCAD=TRUE)
calibrate(4450, 40, reservoir=c(100, 50))
</code></pre>

<hr>
<h2 id='clean'>Simulate removing contamination from a radiocarbon age</h2><span id='topic+clean'></span>

<h3>Description</h3>

<p>Given an observed radiocarbon age, remove the impact of contamination (for example, 1% contamination with modern carbon) to estimate the true/target age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean(
  y,
  er = 0,
  percentage,
  percentage.error = 0,
  F.contam = 1,
  F.contam.er = 0,
  MC = TRUE,
  its = 10000,
  roundby = 1,
  decimals = 5,
  visualise = TRUE,
  talk = TRUE,
  eq.x = 5,
  eq.y = c(),
  eq.size = 0.75,
  true.col = "darkgreen",
  observed.col = "blue",
  contamination.col = "red",
  true.pch = 20,
  observed.pch = 18,
  contamination.pch = 17,
  true.name = "true",
  xlab = "contamination (%)",
  ylab = "F14C",
  ylim = c(),
  bty = "l"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clean_+3A_y">y</code></td>
<td>
<p>The observed radiocarbon age</p>
</td></tr>
<tr><td><code id="clean_+3A_er">er</code></td>
<td>
<p>The error of the observed radiocarbon age</p>
</td></tr>
<tr><td><code id="clean_+3A_percentage">percentage</code></td>
<td>
<p>Relative amount of contamination. Must be between 0 and 100 (%)</p>
</td></tr>
<tr><td><code id="clean_+3A_percentage.error">percentage.error</code></td>
<td>
<p>Uncertainty of the contamination. Assumed to be normally distributed (which fails close to 0% or 100% contamination levels). Defaults to 0%.</p>
</td></tr>
<tr><td><code id="clean_+3A_f.contam">F.contam</code></td>
<td>
<p>The F14C of the contamination. Set at 1 for carbon of modern radiocarbon age, at 0 for 14C-free carbon, or anywhere inbetween.</p>
</td></tr>
<tr><td><code id="clean_+3A_f.contam.er">F.contam.er</code></td>
<td>
<p>The error of the contamination. Defaults to 0.</p>
</td></tr>
<tr><td><code id="clean_+3A_mc">MC</code></td>
<td>
<p>Whether or not to use Monte Carlo iterations to estimate the values. Defaults to TRUE, because it treats uncertainties better than if set to FALSE.</p>
</td></tr>
<tr><td><code id="clean_+3A_its">its</code></td>
<td>
<p>Amount of iterations to use if MC=TRUE. Defaults to 10,000.</p>
</td></tr>
<tr><td><code id="clean_+3A_roundby">roundby</code></td>
<td>
<p>Rounding of the output for C14 ages. Defaults to 1 decimal.</p>
</td></tr>
<tr><td><code id="clean_+3A_decimals">decimals</code></td>
<td>
<p>Rounding of the output. Since details matter here, the default is to provide 5 decimals.</p>
</td></tr>
<tr><td><code id="clean_+3A_visualise">visualise</code></td>
<td>
<p>By default, a plot is made to visualise the target and observed F14C values, together with the inferred contamination.</p>
</td></tr>
<tr><td><code id="clean_+3A_talk">talk</code></td>
<td>
<p>Whether or not to report the calculations made. Defaults to <code>talk=TRUE</code>.</p>
</td></tr>
<tr><td><code id="clean_+3A_eq.x">eq.x</code></td>
<td>
<p>Leftmost location of the equation. Defaults to <code>eq.x=5</code>. Can be set to values outside of (0,100) to make the equation invisible.</p>
</td></tr>
<tr><td><code id="clean_+3A_eq.y">eq.y</code></td>
<td>
<p>Vertical location of the equation. Defaults to the top of the graph.</p>
</td></tr>
<tr><td><code id="clean_+3A_eq.size">eq.size</code></td>
<td>
<p>Size of the font of the equation. In case the equation gets jumbled up upon resizing of a graphical device, just issue the previous 'clean' command again. Defaults to <code>eq.size=0.8</code>.</p>
</td></tr>
<tr><td><code id="clean_+3A_true.col">true.col</code></td>
<td>
<p>Colour for the target/true values. Defaults to &quot;darkgreen&quot;.</p>
</td></tr>
<tr><td><code id="clean_+3A_observed.col">observed.col</code></td>
<td>
<p>Colour for the observed values. Defaults to blue.</p>
</td></tr>
<tr><td><code id="clean_+3A_contamination.col">contamination.col</code></td>
<td>
<p>Colour for the contamination values. Defaults to red.</p>
</td></tr>
<tr><td><code id="clean_+3A_true.pch">true.pch</code></td>
<td>
<p>Icon for the true/target date. Defaults to a filled circle.</p>
</td></tr>
<tr><td><code id="clean_+3A_observed.pch">observed.pch</code></td>
<td>
<p>Icon for the observed. Defaults to a diamond</p>
</td></tr>
<tr><td><code id="clean_+3A_contamination.pch">contamination.pch</code></td>
<td>
<p>Icon for the contamination. Defaults to a triangle.</p>
</td></tr>
<tr><td><code id="clean_+3A_true.name">true.name</code></td>
<td>
<p>Name of the label of the true/target date</p>
</td></tr>
<tr><td><code id="clean_+3A_xlab">xlab</code></td>
<td>
<p>Name of the x-axis. Defaults to 'contamination (%)'.</p>
</td></tr>
<tr><td><code id="clean_+3A_ylab">ylab</code></td>
<td>
<p>Name of the y-axis. Defaults to 'F14C'.</p>
</td></tr>
<tr><td><code id="clean_+3A_ylim">ylim</code></td>
<td>
<p>Limits of the y-axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="clean_+3A_bty">bty</code></td>
<td>
<p>Draw a box around a box of a certain shape. Defaults to <code>bty="l"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Whereas the function takes C14 ages and percentage contamination as input, internal calculations are done in the F14C realm and using fractions (between 0 and 1). The central calculation is 'F_true = ((1-frac)*F_obs) - (frac*F_contam)', where 'F_true' is the true or target age in F14C, 'frac' is the fraction of contamination, 'F_obs' is the F14C of the observed C14 age, and 'F_contam' is the F activity of the contamination. In some extreme cases, the calculations will spit out unexpected results. Messages will be provided in most of these cases.
</p>


<h3>Value</h3>

<p>The true/target radiocarbon age and error
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1% contamination with modern carbon (no uncertainties in contamination's percentage or F)
clean(5000, 20, 1, 0, 1, 0)
# now with errors:
clean(5000, 20, 1, 0.1, 1, 0.1)
</code></pre>

<hr>
<h2 id='contaminate'>Simulate the impact of contamination on a radiocarbon age</h2><span id='topic+contaminate'></span>

<h3>Description</h3>

<p>Given a true/target radiocarbon age, calculate the impact of contamination (for example, 1% contamination with modern carbon) on the observed age. Can optionally include contamination uncertainties, but then Monte Carlo iterations should be used (option MC=TRUE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contaminate(
  y,
  er = 0,
  percentage,
  percentage.error = 0,
  F.contam = 1,
  F.contam.er = 0,
  MC = TRUE,
  its = 10000,
  decimals = 5,
  roundby = 1,
  visualise = TRUE,
  talk = TRUE,
  eq.x = 5,
  eq.y = c(),
  eq.size = 0.75,
  true.col = "darkgreen",
  observed.col = "blue",
  contamination.col = "red",
  true.pch = 20,
  observed.pch = 18,
  contamination.pch = 17,
  true.name = "true",
  xlab = "contamination (%)",
  ylab = "F14C",
  ylim = c(),
  bty = "l"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contaminate_+3A_y">y</code></td>
<td>
<p>The 'true' radiocarbon age</p>
</td></tr>
<tr><td><code id="contaminate_+3A_er">er</code></td>
<td>
<p>The error of the 'true' radiocarbon age</p>
</td></tr>
<tr><td><code id="contaminate_+3A_percentage">percentage</code></td>
<td>
<p>Relative amount of contamination. Must be between 0 and 1</p>
</td></tr>
<tr><td><code id="contaminate_+3A_percentage.error">percentage.error</code></td>
<td>
<p>Uncertainty of the contamination. Assumed to be normally distributed (which fails close to 0% or 100% contamination levels). Defaults to 0%.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_f.contam">F.contam</code></td>
<td>
<p>the F14C of the contamination. Set at 1 for carbon of modern radiocarbon age, at 0 for 14C-free carbon, or anywhere inbetween.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_f.contam.er">F.contam.er</code></td>
<td>
<p>error of the contamination. Defaults to 0.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_mc">MC</code></td>
<td>
<p>Whether or not to use Monte Carlo iterations to estimate the values. Defaults to TRUE, because it treats uncertainties better than if set to FALSE.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_its">its</code></td>
<td>
<p>Amount of iterations to use if MC=TRUE. Defaults to 10,000.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_decimals">decimals</code></td>
<td>
<p>Rounding of the output for F values. Since details matter here, the default is to provide 5 decimals.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_roundby">roundby</code></td>
<td>
<p>Rounding of the output for C14 ages. Defaults to 1 decimal.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_visualise">visualise</code></td>
<td>
<p>By default, a plot is made to visualise the target and observed F14C values, together with the inferred contamination.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_talk">talk</code></td>
<td>
<p>Whether or not to report the calculations made. Defaults to <code>talk=TRUE</code>.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_eq.x">eq.x</code></td>
<td>
<p>Leftmost location of the equation. Defaults to <code>eq.x=5</code>. Can be set to values outside of (0,100) to make the equation invisible.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_eq.y">eq.y</code></td>
<td>
<p>Vertical location of the equation. Defaults to the top of the graph.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_eq.size">eq.size</code></td>
<td>
<p>Size of the font of the equation. In case the equation gets jumbled up upon resizing of a graphical device, just issue the previous 'clean' command again. Defaults to <code>eq.size=0.8</code>.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_true.col">true.col</code></td>
<td>
<p>Colour for the target/true values. Defaults to &quot;darkgreen&quot;.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_observed.col">observed.col</code></td>
<td>
<p>Colour for the observed values. Defaults to blue.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_contamination.col">contamination.col</code></td>
<td>
<p>Colour for the contamination values. Defaults to red.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_true.pch">true.pch</code></td>
<td>
<p>Icon for the true/target date. Defaults to a filled circle.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_observed.pch">observed.pch</code></td>
<td>
<p>Icon for the observed. Defaults to a diamond.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_contamination.pch">contamination.pch</code></td>
<td>
<p>Icon for the contamination. Defaults to a triangle.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_true.name">true.name</code></td>
<td>
<p>Name of the label of the true/target date</p>
</td></tr>
<tr><td><code id="contaminate_+3A_xlab">xlab</code></td>
<td>
<p>Name of the x-axis. Defaults to 'contamination (%)'.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_ylab">ylab</code></td>
<td>
<p>Name of the y-axis. Defaults to 'F14C'.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_ylim">ylim</code></td>
<td>
<p>Limits of the y-axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="contaminate_+3A_bty">bty</code></td>
<td>
<p>Draw a box around a box of a certain shape. Defaults to <code>bty="l"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Whereas the function takes C14 ages and percentage contamination as input, internal calculations are done in the F14C realm and using fractions (between 0 and 1). The central calculation is 'F_obs = ((1-frac)*F_true) + (frac*F_contam)', where 'F_obs' is the observed C14 age as F14C, 'frac' is the fraction of contamination, 'F_true' is the F14C of the true/target C14 age, and 'F_contam' is the F activity of the contamination. In some extreme cases, the calculations will spit out unexpected results. Messages will be provided in most of these cases.
</p>


<h3>Value</h3>

<p>The observed radiocarbon age and error
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>contaminate(5000, 20, 1, 0, 1) # 1% contamination with modern carbon
contaminate(66e6, 1e6, 1, 0, 1) # dino bone, shouldn't be dated as way beyond the dating limit
</code></pre>

<hr>
<h2 id='D14CtoC14'>Transform D14C into C14 age</h2><span id='topic+D14CtoC14'></span>

<h3>Description</h3>

<p>Transform D14C into C14 age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>D14CtoC14(D14C, er = NULL, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="D14CtoC14_+3A_d14c">D14C</code></td>
<td>
<p>The Delta14C value to translate</p>
</td></tr>
<tr><td><code id="D14CtoC14_+3A_er">er</code></td>
<td>
<p>Reported error of the D14C. Returns just the mean if left empty.</p>
</td></tr>
<tr><td><code id="D14CtoC14_+3A_t">t</code></td>
<td>
<p>the cal BP age</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As explained by Heaton et al. 2020 (Radiocarbon), 14C measurements are commonly expressed in
three domains: Delta14C, F14C and the radiocarbon age. This function translates Delta14C, the historical level of Delta14C in the year t cal BP, to C14 ages. Note that per convention, this function uses the Cambridge half-life, not the Libby half-life.
</p>


<h3>Value</h3>

<p>The corresponding C14 age
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  D14CtoC14(-10, 1, 238)
</code></pre>

<hr>
<h2 id='D14CtoF14C'>Transform D14C into F14C</h2><span id='topic+D14CtoF14C'></span>

<h3>Description</h3>

<p>Transform D14C into F14C
</p>


<h3>Usage</h3>

<pre><code class='language-R'>D14CtoF14C(D14C, er = NULL, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="D14CtoF14C_+3A_d14c">D14C</code></td>
<td>
<p>The Delta14C value to translate</p>
</td></tr>
<tr><td><code id="D14CtoF14C_+3A_er">er</code></td>
<td>
<p>Reported error of the D14C. Returns just the mean if left empty.</p>
</td></tr>
<tr><td><code id="D14CtoF14C_+3A_t">t</code></td>
<td>
<p>the cal BP age</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As explained by Heaton et al. 2020 (Radiocarbon), 14C measurements are commonly expressed in
three domains: Delta14C, F14C and the radiocarbon age. This function translates Delta14C, the historical level of Delta14C in the year t cal BP, to F14C values. Note that per convention, this function uses the Cambridge half-life, not the Libby half-life.
</p>


<h3>Value</h3>

<p>The corresponding F14C value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  D14CtoF14C(-10, 1, 238)
</code></pre>

<hr>
<h2 id='D14CtopMC'>Transform D14C into pMC</h2><span id='topic+D14CtopMC'></span>

<h3>Description</h3>

<p>Transform D14C into pMC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>D14CtopMC(D14C, er = NULL, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="D14CtopMC_+3A_d14c">D14C</code></td>
<td>
<p>The Delta14C value to translate</p>
</td></tr>
<tr><td><code id="D14CtopMC_+3A_er">er</code></td>
<td>
<p>Reported error of the D14C. Returns just the mean if left empty.</p>
</td></tr>
<tr><td><code id="D14CtopMC_+3A_t">t</code></td>
<td>
<p>the cal BP age</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As explained by Heaton et al. 2020 (Radiocarbon), 14C measurements are commonly expressed in
three domains: Delta14C, F14C and the radiocarbon age. This function translates Delta14C, the historical level of Delta14C in the year t cal BP, to F14C values. Note that per convention, this function uses the Cambridge half-life, not the Libby half-life.
</p>


<h3>Value</h3>

<p>The corresponding F14C value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  D14CtoF14C(-10, 1, 238)
</code></pre>

<hr>
<h2 id='draw.ccurve'>Draw a calibration curve.</h2><span id='topic+draw.ccurve'></span>

<h3>Description</h3>

<p>Draw one or two of the calibration curves, or add a calibration curve to an existing plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.ccurve(
  cal1 = c(),
  cal2 = c(),
  cc1 = "IntCal20",
  cc2 = NA,
  cc1.postbomb = FALSE,
  cc2.postbomb = FALSE,
  BCAD = FALSE,
  realm = "C14",
  cal.lab = NA,
  cal.rev = FALSE,
  c14.lab = NA,
  c14.lim = NA,
  c14.rev = FALSE,
  ka = FALSE,
  add.yaxis = FALSE,
  cc1.col = rgb(0, 0, 1, 0.5),
  cc1.fill = rgb(0, 0, 1, 0.2),
  cc2.col = rgb(0, 0.5, 0, 0.5),
  cc2.fill = rgb(0, 0.5, 0, 0.2),
  add = FALSE,
  bty = "l",
  cc.dir = NULL,
  legend = "topleft",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.ccurve_+3A_cal1">cal1</code></td>
<td>
<p>First calendar year for the plot. Defaults to 0 cal BP.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cal2">cal2</code></td>
<td>
<p>Last calendar year for the plot. Defaults to 55,000 cal BP.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc1">cc1</code></td>
<td>
<p>Name of the calibration curve. Can be &quot;IntCal20&quot;, &quot;Marine20&quot;, &quot;SHCal20&quot;, or for the previous curves &quot;IntCal13&quot;, &quot;Marine13&quot; or &quot;SHCal13&quot;. Can also be &quot;nh1&quot;, &quot;nh2&quot;, &quot;nh3&quot;, &quot;sh1-2&quot;, &quot;sh3&quot;, &quot;nh1_monthly&quot;, &quot;nh1_monthly&quot;, &quot;nh2_monthly&quot;, &quot;nh3_monthly&quot;, &quot;sh1-2_monthly&quot;, &quot;sh3_monthly&quot;, &quot;Kure&quot;, &quot;LevinKromer&quot; or &quot;Santos&quot; for postbomb curves.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc2">cc2</code></td>
<td>
<p>Optional second calibration curve to plot. Can be &quot;IntCal20&quot;, &quot;Marine20&quot;, &quot;SHCal20&quot;, or for the previous curves &quot;IntCal13&quot;, &quot;Marine13&quot; or &quot;SHCal13&quot;. Defaults to nothing, NA.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc1.postbomb">cc1.postbomb</code></td>
<td>
<p>Use <code>postbomb=TRUE</code> to get a postbomb calibration curve for cc1 (default <code>cc1.postbomb=FALSE</code>).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc2.postbomb">cc2.postbomb</code></td>
<td>
<p>Use <code>postbomb=TRUE</code> to get a postbomb calibration curve for cc2 (default <code>cc2.postbomb=FALSE</code>).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in cal BP (calendar or calibrated years before the present, where the present is AD 1950) by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_realm">realm</code></td>
<td>
<p>Which 'realm' of radiocarbon to use. Defaults to <code>realm="C14"</code> but can also be set to <code>realm="F14C"</code>, <code>realm="pMC"</code> or <code>realm="D14C"</code>. Can be shorted to, respectively, &quot;C&quot;, &quot;F&quot;, &quot;P&quot; or &quot;D&quot; (or their lower-case equivalents).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cal.lab">cal.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>), or to <code>age.lab="kcal BP"</code> etc. if ka=TRUE.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cal.rev">cal.rev</code></td>
<td>
<p>Reverse the calendar axis.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_c14.lab">c14.lab</code></td>
<td>
<p>Label for the C-14 axis. Defaults to 14C BP (or 14C kBP if ka=TRUE).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_c14.lim">c14.lim</code></td>
<td>
<p>Axis limits for the C-14 axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_c14.rev">c14.rev</code></td>
<td>
<p>Reverse the C-14 axis.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_ka">ka</code></td>
<td>
<p>Use kcal BP (and C14 kBP).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_add.yaxis">add.yaxis</code></td>
<td>
<p>Whether or not to plot the second calibration. Defaults to <code>add.yaxis=FALSE</code>.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc1.col">cc1.col</code></td>
<td>
<p>Colour of the calibration curve (outline).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc1.fill">cc1.fill</code></td>
<td>
<p>Colour of the calibration curve (fill).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc2.col">cc2.col</code></td>
<td>
<p>Colour of the calibration curve (outline), if activated (default cc2=NA).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc2.fill">cc2.fill</code></td>
<td>
<p>Colour of the calibration curve (fill), if activated (default cc2=NA).</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_add">add</code></td>
<td>
<p>Whether or not to add the curve(s) to an existing plot. Defaults to FALSE, which draws a new plot</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_bty">bty</code></td>
<td>
<p>Draw a box around a box of a certain shape. Defaults to <code>bty="l"</code>.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_legend">legend</code></td>
<td>
<p>Location of the legend (only activated if more than one curve is plotted). Plotted in the topleft corner by default. Use <code>legend=c()</code> to leave empty</p>
</td></tr>
<tr><td><code id="draw.ccurve_+3A_...">...</code></td>
<td>
<p>Any additional optional plotting parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the calibration curve
</p>


<h3>Examples</h3>

<pre><code class='language-R'>draw.ccurve()
draw.ccurve(1000, 3000, cc2="Marine20")
draw.ccurve(1800, 2020, BCAD=TRUE, cc2="nh1", cc2.postbomb=TRUE)
draw.ccurve(1800, 2010, BCAD=TRUE, cc2="nh1", add.yaxis=TRUE)
</code></pre>

<hr>
<h2 id='draw.contamination'>Draw contamination impacts</h2><span id='topic+draw.contamination'></span>

<h3>Description</h3>

<p>Show how contamination with different fractions of modern carbon affect observed C-14 ages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.contamination(
  from = 0,
  to = 50000,
  ka = TRUE,
  age.res = 500,
  xlim = c(),
  ylim = c(),
  colours = rainbow(age.res),
  max.contam = 0.1,
  contam.F14C = 1,
  contam.legend = max.contam * c(1/100, (1:5)/50, (1:4)/5, 1),
  legend.pos = 0.07,
  legend.cex = 0.6,
  grid = TRUE,
  xaxs = "i",
  yaxs = "i"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.contamination_+3A_from">from</code></td>
<td>
<p>Minimum 14C age for the plot. Defaults to 0</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_to">to</code></td>
<td>
<p>Maximum 14C age for the plot. Defaults to 50e3.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_ka">ka</code></td>
<td>
<p>Use C14 kBP. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_age.res">age.res</code></td>
<td>
<p>Resolution of age scale. Defaults to 500, which results in smooth curves. Higher numbers will take longer to draw.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_xlim">xlim</code></td>
<td>
<p>Limits of the horizontal axis.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_ylim">ylim</code></td>
<td>
<p>Limits of the vertical axis.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_colours">colours</code></td>
<td>
<p>Colours of the percentages. Defaults to rainbow colours.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_max.contam">max.contam</code></td>
<td>
<p>Maximum contamination level as a fraction of the sample. Defaults to 0.1 (10%).</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_contam.f14c">contam.F14C</code></td>
<td>
<p>14C activity of the sample. Defaults to 'modern' 14C, F14C=1.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_contam.legend">contam.legend</code></td>
<td>
<p>Percentages for which numbers will be plotted.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_legend.pos">legend.pos</code></td>
<td>
<p>horizontal position beyond which the percentage values will be plotted</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_legend.cex">legend.cex</code></td>
<td>
<p>font size of the legend</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_grid">grid</code></td>
<td>
<p>Whether to plot a grid. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_xaxs">xaxs</code></td>
<td>
<p>Whether or not to extend the limits of the horizontal axis. Defaults to <code>xaxs="i"</code> which does not extend.</p>
</td></tr>
<tr><td><code id="draw.contamination_+3A_yaxs">yaxs</code></td>
<td>
<p>Whether or not to extend the limits of the vertical axis. Defaults to <code>yaxs="i"</code> which does not extend.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of real and observed (contamination-impacted) C14 ages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  draw.contamination()
  draw.contamination(40e3, 50e3, ka=FALSE)
</code></pre>

<hr>
<h2 id='draw.D14C'>Draw d14C and the calibration curve.</h2><span id='topic+draw.D14C'></span>

<h3>Description</h3>

<p>Draw a proxy of the atmospheric 14C concentration (d14C) as well as the calibration curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.D14C(
  cal1 = c(),
  cal2 = c(),
  cc = rintcal::ccurve(),
  BCAD = FALSE,
  mar = c(4, 4, 1, 4),
  mgp = c(2.5, 1, 0),
  xaxs = "r",
  yaxs = "r",
  bty = "u",
  ka = FALSE,
  cal.lab = c(),
  cal.rev = FALSE,
  C14.lab = c(),
  C14.lim = c(),
  cc.col = rgb(0, 0.5, 0, 0.5),
  cc.border = rgb(0, 0.5, 0, 0.5),
  D14C.lab = c(),
  D14C.lim = c(),
  D14C.col = rgb(0, 0, 1, 0.5),
  D14C.border = rgb(0, 0, 1, 0.5)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.D14C_+3A_cal1">cal1</code></td>
<td>
<p>First calendar year for the plot. Defaults to youngest calendar age of the calibration curve</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_cal2">cal2</code></td>
<td>
<p>Last calendar year for the plot. Defaults to oldest calendar age of the calibration curve</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_cc">cc</code></td>
<td>
<p>The calibration curve to use. Defaults to IntCal20</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in cal BP (calendar or calibrated years before the present, where the present is AD 1950) by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_mar">mar</code></td>
<td>
<p>Plot margins (amount of white space along edges of axes 1-4).</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_mgp">mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted).</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_xaxs">xaxs</code></td>
<td>
<p>Whether or not to extend the limits of the horizontal axis. Defaults to <code>xaxs="r"</code> which extends it by R's default.</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_yaxs">yaxs</code></td>
<td>
<p>Whether or not to extend the limits of the vertical axis. Defaults to <code>yaxs="r"</code> which extends it by R's default.</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_bty">bty</code></td>
<td>
<p>Draw a box around the graph (&quot;n&quot; for none, and &quot;l&quot;, &quot;7&quot;, &quot;c&quot;, &quot;u&quot;, &quot;]&quot; or &quot;o&quot; for correspondingly shaped boxes).</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_ka">ka</code></td>
<td>
<p>Use kcal BP (and C14 kBP). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_cal.lab">cal.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>), or to <code>age.lab="kcal BP"</code> etc. if ka=TRUE.</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_cal.rev">cal.rev</code></td>
<td>
<p>Reverse the calendar axis (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_c14.lab">C14.lab</code></td>
<td>
<p>Label for the C-14 axis. Defaults to 14C BP (or 14C kBP if ka=TRUE).</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_c14.lim">C14.lim</code></td>
<td>
<p>Limits for the C-14 axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_cc.col">cc.col</code></td>
<td>
<p>Colour of the calibration curve (fill).</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_cc.border">cc.border</code></td>
<td>
<p>Colour of the calibration curve (border).</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_d14c.lab">D14C.lab</code></td>
<td>
<p>Label for the D14C axis.</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_d14c.lim">D14C.lim</code></td>
<td>
<p>Axis limits for the D14C axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_d14c.col">D14C.col</code></td>
<td>
<p>Colour of the D14C curve (fill).</p>
</td></tr>
<tr><td><code id="draw.D14C_+3A_d14c.border">D14C.border</code></td>
<td>
<p>Colour of the D14C curve (border).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of d14C and the calibration curve
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  draw.D14C()
  draw.D14C(30e3, 55e3, ka=TRUE)
  draw.D14C(cc=rintcal::ccurve("NH1_monthly"), BCAD=TRUE)
</code></pre>

<hr>
<h2 id='draw.dates'>add calibrated distributions to a plot.</h2><span id='topic+draw.dates'></span>

<h3>Description</h3>

<p>Add individual or multiple calibrated dates to a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.dates(
  age,
  error,
  depth = c(),
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  thiscurve = c(),
  oncurve = FALSE,
  realm = "C",
  reservoir = c(),
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  prob = 0.95,
  threshold = 0.001,
  BCAD = FALSE,
  draw.hpd = TRUE,
  hpd.border = NA,
  hpd.col = rgb(0, 0, 1, 0.7),
  cal.hpd.col = rgb(0, 0.5, 0.5, 0.35),
  rounded = 0.1,
  every = 1,
  mirror = TRUE,
  up = TRUE,
  draw.base = TRUE,
  col = rgb(0, 0, 1, 0.3),
  border = rgb(0, 0, 1, 0.5),
  cal.col = rgb(0, 0.5, 0.5, 0.35),
  cal.border = rgb(0, 0.5, 0.5, 0.35),
  add = FALSE,
  ka = FALSE,
  rotate.axes = FALSE,
  ex = 0.8,
  normalise = TRUE,
  cc.col = rgb(0, 0.5, 0, 0.5),
  cc.border = rgb(0, 0.5, 0, 0.5),
  cc.resample = 5,
  age.lab = c(),
  age.lim = c(),
  age.rev = FALSE,
  d.lab = c(),
  d.lim = c(),
  d.rev = TRUE,
  labels = c(),
  label.x = 1,
  label.y = c(),
  label.cex = 0.8,
  label.col = border,
  label.offset = c(0, 0),
  label.adj = c(1, 0),
  label.rot = 0,
  cc.dir = NULL,
  dist.res = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.dates_+3A_age">age</code></td>
<td>
<p>Mean of the uncalibrated C-14 age (or multiple ages).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_error">error</code></td>
<td>
<p>Error of the uncalibrated C-14 age (or ages).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_depth">depth</code></td>
<td>
<p>Depth(s) of the date(s). Defaults to their relative positions if no depths are provided.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_cc">cc</code></td>
<td>
<p>Calibration curve for C-14 dates (1, 2, 3, or 4, or, e.g., &quot;IntCal20&quot;, &quot;Marine20&quot;, &quot;SHCal20&quot;, &quot;nh1&quot;, &quot;sh3&quot;, or &quot;mixed&quot;). If there are multiple dates but all use the same calibration curve, one value can be provided.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not this is a postbomb age. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples). Can also be provided as option 'reservoir'.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation). Can also be provided within option 'reservoir'.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error). Defaults to c().</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_oncurve">oncurve</code></td>
<td>
<p>Whether or not to plot the calibration curve and then plot the dates onto this curve. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_realm">realm</code></td>
<td>
<p>If oncurve is used, by default the calibration curve is plotted in the C14 age realm. Alternatively, it can be provided as <code>realm="F14C"</code> or <code>realm="pMC"</code></p>
</td></tr>
<tr><td><code id="draw.dates_+3A_reservoir">reservoir</code></td>
<td>
<p>Reservoir age, or reservoir age and age offset.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2009).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_prob">prob</code></td>
<td>
<p>Probability confidence intervals (between 0 and 1).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=0.001</code>.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_bcad">BCAD</code></td>
<td>
<p>Use BC/AD or cal BP scale (default cal BP).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_draw.hpd">draw.hpd</code></td>
<td>
<p>Whether or not to draw the hpd ranges as a line</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_hpd.border">hpd.border</code></td>
<td>
<p>Colour of the border of the hpd intervals. Not drawn by default.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_hpd.col">hpd.col</code></td>
<td>
<p>Colour of the hpd rectangle for all dates or radiocarbon dates</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_cal.hpd.col">cal.hpd.col</code></td>
<td>
<p>Colour of the hpd rectangle for cal BP dates</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_rounded">rounded</code></td>
<td>
<p>Rounding for probabilities of reported hpd ranges. Defaults to 1 decimal.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_every">every</code></td>
<td>
<p>Yearly precision of hpds (defaults to <code>every=1</code>).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_mirror">mirror</code></td>
<td>
<p>Plot distributions mirrored, a bit like a swan. Confuses some people but looks nice to the author so is the default.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_up">up</code></td>
<td>
<p>If mirror is set to FALSE, the distribution can be plotted facing upwards or downwards.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_draw.base">draw.base</code></td>
<td>
<p>By default, the base of the calibrated distributions is plotted. This can be avoided by supplying <code>draw.base=FALSE</code> as an option.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_col">col</code></td>
<td>
<p>Colour of the inside of the distribution</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_border">border</code></td>
<td>
<p>Colour of the border of the distribution</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_cal.col">cal.col</code></td>
<td>
<p>Colour of the inside of distribution of non-radiocarbon dates that didn't need calibration</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_cal.border">cal.border</code></td>
<td>
<p>Colour of the border of the distribution of non-radiocarbon dates that didn't need calibration</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_add">add</code></td>
<td>
<p>Whether or not to add the dates to an existing plot. If set to FALSE (default), a plot will be set up.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_ka">ka</code></td>
<td>
<p>Whether or not to plot ages as thousands of years. Defaults to <code>ka=FALSE</code>.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>By default, the calendar age axis is plotted on the horizontal axis, and depth/position on the vertical one. Use <code>rotate.axes=TRUE</code> to rotate the axes.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_ex">ex</code></td>
<td>
<p>Exaggeration of the height of the distribution, defaults to <code>ex=1</code>.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_normalise">normalise</code></td>
<td>
<p>If TRUE, the age distributions are normalised by plotting each distribution with the same total area. Precise dates will therefore peak higher than less precise dates (default). If <code>normalise=FALSE</code>, the peak of each date will be drawn at the same height.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_cc.col">cc.col</code></td>
<td>
<p>Colour of the calibration curve. Default semi-transparent darkgreen.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_cc.border">cc.border</code></td>
<td>
<p>Colour of the edges of the calibration curve. Default semi-transparent darkgreen.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_cc.resample">cc.resample</code></td>
<td>
<p>The IntCal20 curves have different densities (every year between 0 and 5 kcal BP, then every 5 yr up to 15 kcal BP, then every 10 yr up to 25 kcal BP, and then every 20 yr up to 55 kcal BP). If calibrated ages span these density ranges, their drawn heights can differ, as can their total areas (which should ideally all sum to the same size). To account for this, resample to a constant time-span, using, e.g., <code>cc.resample=5</code> for 5-yr timespans.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_age.lab">age.lab</code></td>
<td>
<p>Title of the calendar axis (if present)</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_age.lim">age.lim</code></td>
<td>
<p>Limits of the calendar axis (if present)</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_age.rev">age.rev</code></td>
<td>
<p>Reverse the age axis. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_d.lab">d.lab</code></td>
<td>
<p>Title of the vertical axis (if present)</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_d.lim">d.lim</code></td>
<td>
<p>Limits of the vertical axis (if present)</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_d.rev">d.rev</code></td>
<td>
<p>Reverse the y-axis. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_labels">labels</code></td>
<td>
<p>Add labels to the dates. Empty by default.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_label.x">label.x</code></td>
<td>
<p>Horizontal position of the date labels. By default draws them before the youngest age (1), but can also draw them after the oldest age (2), or above its mean (3).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_label.y">label.y</code></td>
<td>
<p>Vertical positions of the depths/labels. Defaults to 0 (or 1 if label.x is 3 or 4).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_label.cex">label.cex</code></td>
<td>
<p>Size of labels.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_label.col">label.col</code></td>
<td>
<p>Colour of the labels. Defaults to the colour given to the borders of the dates.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_label.offset">label.offset</code></td>
<td>
<p>Offsets of the positions of the depths/labels, giving the x and y offsets. Defaults to c(0,0).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_label.adj">label.adj</code></td>
<td>
<p>Justification of the labels. Follows R's adj option: A value of &quot;0&quot; produces left-justified text, &quot;0.5&quot; (the default) centered text and &quot;1&quot; right-justified text.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_label.rot">label.rot</code></td>
<td>
<p>Rotation of the label. 0 by default (horizontal).</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_dist.res">dist.res</code></td>
<td>
<p>Resolution of the distribution polygons. Defaults to <code>dist.res=100</code>.</p>
</td></tr>
<tr><td><code id="draw.dates_+3A_...">...</code></td>
<td>
<p>Additional plotting options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the (calibrated) dates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  plot(0, xlim=c(500,0), ylim=c(0, 2))
  draw.dates(130, 20, depth=1) 
  x &lt;- sort(runif(10, 1000, 10000)) # draw 10 random calendar ages
  cc &lt;- rintcal::ccurve() # get the calibration curve
  y &lt;- approx(cc[,1], cc[,2], x)$y # find the IntCal 14C ages
  er &lt;- .01 * y
  draw.dates(y, er, 1:length(x))
  # or draw on the calibration curve
  draw.dates(y, er, y, d.lab="Radiocarbon age (BP)")
  draw.ccurve(add=TRUE, cc1.col=rgb(0,.5,0,.5))
</code></pre>

<hr>
<h2 id='F14C.age'>To be deprecated. Calculate C14 ages from F14C values.</h2><span id='topic+F14C.age'></span>

<h3>Description</h3>

<p>Calculate C14 ages from F14C values of radiocarbon dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>F14C.age(mn, sdev = c(), decimals = 5, lambda = 8033)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="F14C.age_+3A_mn">mn</code></td>
<td>
<p>Reported mean of the F14C</p>
</td></tr>
<tr><td><code id="F14C.age_+3A_sdev">sdev</code></td>
<td>
<p>Reported error of the F14C. Returns just the mean if left empty.</p>
</td></tr>
<tr><td><code id="F14C.age_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals required for the radiocarbon age. Quite sensitive, defaults to 5.</p>
</td></tr>
<tr><td><code id="F14C.age_+3A_lambda">lambda</code></td>
<td>
<p>The mean-life of radiocarbon (based on Libby half-life of 5568 years)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as F14C or fraction modern carbon. Since Bacon expects radiocarbon ages,
this function can be used to calculate radiocarbon ages from F14C values. The reverse function is <a href="#topic+age.F14C">age.F14C</a>.
</p>


<h3>Value</h3>

<p>Radiocarbon ages from F14C values. If F14C values are above 100%, the resulting radiocarbon ages will be negative.
</p>

<hr>
<h2 id='F14CtoC14'>Calculate C14 ages from F14C values.</h2><span id='topic+F14CtoC14'></span>

<h3>Description</h3>

<p>Calculate C14 ages from F14C values of radiocarbon dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>F14CtoC14(F14C, er = NULL, decimals = 5, lambda = 8033)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="F14CtoC14_+3A_f14c">F14C</code></td>
<td>
<p>Reported mean of the F14C</p>
</td></tr>
<tr><td><code id="F14CtoC14_+3A_er">er</code></td>
<td>
<p>Reported error of the F14C. Returns just the mean if left empty.</p>
</td></tr>
<tr><td><code id="F14CtoC14_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals required for the radiocarbon age. Quite sensitive, defaults to 5.</p>
</td></tr>
<tr><td><code id="F14CtoC14_+3A_lambda">lambda</code></td>
<td>
<p>The mean-life of radiocarbon (based on Libby half-life of 5568 years)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as F14C (between 0 at c. 55 kcal BP and 1 at c. AD 1950). Since software such as Bacon expects radiocarbon ages,
this function can be used to calculate radiocarbon ages from F14C values. The reverse function is <a href="#topic+age.F14C">age.F14C</a>.
</p>


<h3>Value</h3>

<p>The radiocarbon ages from the F14C values. If F14C values are above 100%, the resulting radiocarbon ages will be negative.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  F14CtoC14(1.10, 0.5) # a postbomb date, so with a negative C14 age
  F14CtoC14(.80, 0.5) # prebomb dates can also be calculated
</code></pre>

<hr>
<h2 id='F14CtoD14C'>Transform F14C into D14C</h2><span id='topic+F14CtoD14C'></span>

<h3>Description</h3>

<p>Transform F14C into D14C
</p>


<h3>Usage</h3>

<pre><code class='language-R'>F14CtoD14C(F14C, er = NULL, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="F14CtoD14C_+3A_f14c">F14C</code></td>
<td>
<p>The F14C value to translate</p>
</td></tr>
<tr><td><code id="F14CtoD14C_+3A_er">er</code></td>
<td>
<p>Reported error of the F14C. Returns just the mean if left empty.</p>
</td></tr>
<tr><td><code id="F14CtoD14C_+3A_t">t</code></td>
<td>
<p>the cal BP age</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As explained by Heaton et al. 2020 (Radiocarbon), 14C measurements are commonly expressed in
three domains: Delta14C, F14C and the radiocarbon age. This function translates F14C values into Delta14C, the historical level of Delta14C in the year t cal BP. Note that per convention, this function uses the Cambridge half-life, not the Libby half-life.
</p>


<h3>Value</h3>

<p>The corresponding D14C value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  F14CtoD14C(0.89, .001, 900)
</code></pre>

<hr>
<h2 id='F14CtopMC'>Calculate pMC ages from F14C values.</h2><span id='topic+F14CtopMC'></span>

<h3>Description</h3>

<p>Calculate pMC values from F14C values of radiocarbon dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>F14CtopMC(F14C, er = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="F14CtopMC_+3A_f14c">F14C</code></td>
<td>
<p>Reported mean of the F14C</p>
</td></tr>
<tr><td><code id="F14CtopMC_+3A_er">er</code></td>
<td>
<p>Reported error of the F14C. Returns just the mean if left empty.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as F14C (between 0 at c. 55 kcal BP and 1 at c. AD 1950). Since software such as Bacon expects radiocarbon ages,
this function can be used to calculate radiocarbon ages from F14C values. The reverse function is <a href="#topic+age.F14C">age.F14C</a>.
</p>


<h3>Value</h3>

<p>The pMC values from the F14C values. Basically the original values multiplied by 100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  F14CtopMC(1.10, 0.5)
</code></pre>

<hr>
<h2 id='find.shells'>Find nearby shell-derived dR values</h2><span id='topic+find.shells'></span>

<h3>Description</h3>

<p>Find the shells closest to a chosen coordinate, and plot the dR values and feeding ecology. Uses the marine database downloaded (30 Aug 2024) from calib.org/marine. See Reimer PJ, Reimer RW, 2001. A marine reservoir correction database and on-line interface. Radiocarbon 43:461-3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.shells(
  longitude,
  latitude,
  nearest = 50,
  colour = "dR",
  rainbow = FALSE,
  size = 2,
  mapsize = "large",
  mincol = "yellow",
  maxcol = "red",
  symbol = "feeding",
  symbol.legend = TRUE,
  ocean.col = "aliceblue",
  land.col = rgb(0, 0.5, 0, 0.6)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find.shells_+3A_longitude">longitude</code></td>
<td>
<p>Longitude of the point. Can only deal with one point at a time.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_latitude">latitude</code></td>
<td>
<p>Latitude of the point. Can only deal with one point at a time.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_nearest">nearest</code></td>
<td>
<p>The number of shell values to be returned. Defaults to 50.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_colour">colour</code></td>
<td>
<p>The variable to be plotted as colour. Expects a continuous variable. Defaults to 'dR'.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_rainbow">rainbow</code></td>
<td>
<p>Whether or not to use a rainbow scale to plot the variable.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_size">size</code></td>
<td>
<p>Size of the symbols. Defaults to 2.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_mapsize">mapsize</code></td>
<td>
<p>Resolution of the map. Can be &quot;small&quot;, &quot;medium&quot; or &quot;large&quot;. If the latter, a high-resolution dataset will have to be downloaded using the R package 'rnaturalearthhires'. Since this package is on github but not on CRAN, you will have to download it yourself (using the command devtools::install_github(&quot;ropensci/rnaturalearthhires&quot;)). Defaults to 'medium' if 'rnaturalearthhires' is not installed, and to 'high' if it is installed.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_mincol">mincol</code></td>
<td>
<p>Colour for minimum values.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_maxcol">maxcol</code></td>
<td>
<p>Colour for maximum values.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_symbol">symbol</code></td>
<td>
<p>The variable to be plotted as symbol. Expects a categoric variable. Defaults to 'feeding'.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_symbol.legend">symbol.legend</code></td>
<td>
<p>Whether or not to plot the legend for the symbols.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_ocean.col">ocean.col</code></td>
<td>
<p>Colour for the oceans. Defaults to <code>ocean.col="aliceblue"</code>.</p>
</td></tr>
<tr><td><code id="find.shells_+3A_land.col">land.col</code></td>
<td>
<p>Colour for the land. Defaults to semi-transparent darkgreen: <code>land.col=rgb(0, 0.5, 0, 0.6)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the 'rnaturalearth' package for country maps. If the high-resolution maps are desired,
the 'rnaturalearthhires' package must be installed from GitHub.
</p>


<h3>Value</h3>

<p>A dataset with the n nearest dR values, and a plot of their coordinates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  UK &lt;- find.shells(0, 55, mapsize="medium")
  mean(UK$dR)
  Caribbean &lt;- find.shells(-70, 20, 30, mapsize="medium")
</code></pre>

<hr>
<h2 id='fractions'>Estimate a missing radiocarbon age from fractions</h2><span id='topic+fractions'></span>

<h3>Description</h3>

<p>Estimate a missing radiocarbon age from a sample which has C14 dates on both the bulk and on fractions, but where 1 sample was too small to be dated. This can be used in for example soils separated into size fractions, where one of the samples turns out to be too small to be dated. Requires to have the bulk age, the ages of the dated fractions, and the carbon contents and weights of all fractions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fractions(
  bulk_age,
  bulk_er,
  fractions_percC,
  fractions_weights,
  fractions_ages,
  fractions_errors,
  roundby = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fractions_+3A_bulk_age">bulk_age</code></td>
<td>
<p>The age of the bulk/entire sample</p>
</td></tr>
<tr><td><code id="fractions_+3A_bulk_er">bulk_er</code></td>
<td>
<p>The error of the age of the bulk/entire sample</p>
</td></tr>
<tr><td><code id="fractions_+3A_fractions_percc">fractions_percC</code></td>
<td>
<p>The %carbon contents of the fractions. If unknown, enter estimates (e.g., rep(1,4))</p>
</td></tr>
<tr><td><code id="fractions_+3A_fractions_weights">fractions_weights</code></td>
<td>
<p>The weights of the fractions. The units are not important here as the weights are used to calculate the relative contributions of carbon within individual fractions to the entire sample.</p>
</td></tr>
<tr><td><code id="fractions_+3A_fractions_ages">fractions_ages</code></td>
<td>
<p>The radiocarbon ages of the individual fractions. The fraction without a date should be entered as NA.</p>
</td></tr>
<tr><td><code id="fractions_+3A_fractions_errors">fractions_errors</code></td>
<td>
<p>The errors of the radiocarbon ages of the individual fractions. The fraction without a date should be entered as NA.</p>
</td></tr>
<tr><td><code id="fractions_+3A_roundby">roundby</code></td>
<td>
<p>Rounding of the reported age</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>Cs &lt;- c(.02, .05, .03, .04) # carbon contents of each fraction
wghts &lt;- c(5, 4, 2, .5) # weights for all fractions, e.g., in mg
ages &lt;- c(130, 130, 130, NA) # ages of all fractions. The unmeasured one is NA
errors &lt;- c(10, 12, 10, NA) # errors, unmeasured is NA
fractions(150, 20, Cs, wghts, ages, errors) # assuming a bulk age of 150 +- 20 C14 BP
</code></pre>

<hr>
<h2 id='hpd'>Calculate highest posterior density</h2><span id='topic+hpd'></span>

<h3>Description</h3>

<p>Calculate highest posterior density ranges of calibrated distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpd(
  calib,
  prob = 0.95,
  return.raw = FALSE,
  BCAD = FALSE,
  age.round = 0,
  prob.round = 1,
  every = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hpd_+3A_calib">calib</code></td>
<td>
<p>The calibrated distribution, as returned from caldist()</p>
</td></tr>
<tr><td><code id="hpd_+3A_prob">prob</code></td>
<td>
<p>Probability range which should be calculated. Default <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="hpd_+3A_return.raw">return.raw</code></td>
<td>
<p>The raw data to calculate hpds can be returned, e.g. to draw polygons of the calibrated distributions. Defaults to <code>return.raw=FALSE</code>.</p>
</td></tr>
<tr><td><code id="hpd_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="hpd_+3A_age.round">age.round</code></td>
<td>
<p>Rounding for ages. Defaults to 0 decimals.</p>
</td></tr>
<tr><td><code id="hpd_+3A_prob.round">prob.round</code></td>
<td>
<p>Rounding for reported probabilities. Defaults to 1 decimal.</p>
</td></tr>
<tr><td><code id="hpd_+3A_every">every</code></td>
<td>
<p>Yearly precision (defaults to 0.1, as a compromise between speed and accuracy).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The highest posterior density ranges, as three columns: from age, to age, and the corresponding percentage(s) of the range(s)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hpd(caldist(130,20))
plot(tmp &lt;- caldist(2450,50), type='l')
abline(v=hpd(tmp)[,1:2], col=4)
</code></pre>

<hr>
<h2 id='l.calib'>Find the calibrated probability of a calendar age for a 14C date.</h2><span id='topic+l.calib'></span>

<h3>Description</h3>

<p>Find the calibrated probability of a cal BP age for a radiocarbon date. Can handle either multiple calendar ages for a single radiocarbon date, or a single calendar age for multiple radiocarbon dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l.calib(
  x,
  y,
  er,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  thiscurve = c(),
  cc.dir = c(),
  normal = TRUE,
  as.F = FALSE,
  t.a = 3,
  t.b = 4
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="l.calib_+3A_x">x</code></td>
<td>
<p>The cal BP year.</p>
</td></tr>
<tr><td><code id="l.calib_+3A_y">y</code></td>
<td>
<p>The radiocarbon date's mean.</p>
</td></tr>
<tr><td><code id="l.calib_+3A_er">er</code></td>
<td>
<p>The radiocarbon date's lab error.</p>
</td></tr>
<tr><td><code id="l.calib_+3A_cc">cc</code></td>
<td>
<p>calibration curve for the radiocarbon date(s) (see the <code>rintcal</code> package).</p>
</td></tr>
<tr><td><code id="l.calib_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages.</p>
</td></tr>
<tr><td><code id="l.calib_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="l.calib_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="l.calib_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="l.calib_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="l.calib_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="l.calib_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="l.calib_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="l.calib_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function cannot deal with multiple calibration curves if multiple calendar years or radiocarbon dates are entered.
</p>


<h3>Value</h3>

<p>The calibrated probability of a calendar age for a 14C age
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  l.calib(100, 130, 20)
  l.calib(100:110, 130, 20) # multiple calendar ages of a single date
  l.calib(100, c(130,150), c(15,20)) # multiple radiocarbon ages and a single calendar age
  plot(0:300, l.calib(0:300, 130, 20), type='l')
</code></pre>

<hr>
<h2 id='map.shells'>Plot regional shell-derived dR values</h2><span id='topic+map.shells'></span>

<h3>Description</h3>

<p>Find the shells that fit within a rectangular region (bounded by N, E, S and W), and plot the dR values and feeding ecology. Uses the marine database downloaded (30 Aug 2024) from calib.org/marine. See Reimer PJ, Reimer RW, 2001. A marine reservoir correction database and on-line interface. Radiocarbon 43:461-3. Expects the coordinates for the map to be provided (starting south, then clockwise as with R axes).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.shells(
  S = 48,
  W = -15,
  N = 62,
  E = 5,
  colour = "dR",
  rainbow = FALSE,
  size = 2,
  mapsize = "large",
  mincol = "yellow",
  maxcol = "red",
  symbol = "feeding",
  symbol.legend = TRUE,
  ocean.col = "aliceblue",
  land.col = rgb(0, 0.5, 0, 0.6)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map.shells_+3A_s">S</code></td>
<td>
<p>The southern limit of the rectangular region.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_w">W</code></td>
<td>
<p>The western limit of the rectangular region.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_n">N</code></td>
<td>
<p>The northern limit of the rectangular region.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_e">E</code></td>
<td>
<p>The eastern limit of the rectangular region.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_colour">colour</code></td>
<td>
<p>The variable to be plotted as colour. Expects a continuous variable. Defaults to 'dR'.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_rainbow">rainbow</code></td>
<td>
<p>Whether or not to use a rainbow scale to plot the variable.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_size">size</code></td>
<td>
<p>Size of the symbols. Defaults to 2.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_mapsize">mapsize</code></td>
<td>
<p>Resolution of the map. Can be &quot;small&quot;, &quot;medium&quot; or &quot;large&quot;. If the latter, a high-resolution dataset will have to be downloaded using the R package 'rnaturalearthhires'. Since this package is on github but not on CRAN, you will have to download it yourself (using the command devtools::install_github(&quot;ropensci/rnaturalearthhires&quot;)). Defaults to 'medium' if 'rnaturalearthhires' is not installed, and to 'high' if it is installed.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_mincol">mincol</code></td>
<td>
<p>Colour for minimum values.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_maxcol">maxcol</code></td>
<td>
<p>Colour for maximum values.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_symbol">symbol</code></td>
<td>
<p>The variable to be plotted as symbol. Expects a categoric variable. Defaults to 'feeding'.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_symbol.legend">symbol.legend</code></td>
<td>
<p>Whether or not to plot the legend for the symbols.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_ocean.col">ocean.col</code></td>
<td>
<p>Colour for the oceans. Defaults to <code>ocean.col="aliceblue"</code>.</p>
</td></tr>
<tr><td><code id="map.shells_+3A_land.col">land.col</code></td>
<td>
<p>Colour for the land. Defaults to semi-transparent darkgreen: <code>land.col=rgb(0, 0.5, 0, 0.6)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the 'rnaturalearth' package for country maps. If the high-resolution maps are desired,
the 'rnaturalearthhires' package must be installed from GitHub.
</p>


<h3>Value</h3>

<p>A plot and the relevant dR values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> N_UK &lt;- map.shells(53, -11, 60, 2, mapsize="medium")
 mean(N_UK$dR)
</code></pre>

<hr>
<h2 id='muck'>Calculate the amount of muck/contamination to explain an observed C14 age</h2><span id='topic+muck'></span>

<h3>Description</h3>

<p>Given an observed and a target radiocarbon age, calculate the amount of contamination required to explain the observed age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>muck(
  y.obs,
  y.obs.er = 0,
  y.target,
  y.target.er = 0,
  F.contam = 1,
  F.contam.er = 0,
  MC = TRUE,
  its = 10000,
  roundby = 1,
  decimals = 3,
  visualise = TRUE,
  talk = TRUE,
  eq.x = 5,
  eq.y = c(),
  eq.size = 0.8,
  target.col = "darkgreen",
  observed.col = "blue",
  contamination.col = "red",
  target.pch = 20,
  observed.pch = 18,
  contamination.pch = 17,
  true.name = "target",
  xlab = "contamination (%)",
  ylab = "F14C",
  ylim = c(),
  bty = "l"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="muck_+3A_y.obs">y.obs</code></td>
<td>
<p>The observed radiocarbon age</p>
</td></tr>
<tr><td><code id="muck_+3A_y.obs.er">y.obs.er</code></td>
<td>
<p>The error of the observed radiocarbon age</p>
</td></tr>
<tr><td><code id="muck_+3A_y.target">y.target</code></td>
<td>
<p>the target radiocarbon age</p>
</td></tr>
<tr><td><code id="muck_+3A_y.target.er">y.target.er</code></td>
<td>
<p>The error of the target radiocarbon age. Not taken into account in the calculations.</p>
</td></tr>
<tr><td><code id="muck_+3A_f.contam">F.contam</code></td>
<td>
<p>the F14C of the contamination. Set at 1 for carbon of modern radiocarbon age, at 0 for 14C-free carbon, or anywhere inbetween.</p>
</td></tr>
<tr><td><code id="muck_+3A_f.contam.er">F.contam.er</code></td>
<td>
<p>The error of the contamination. Defaults to 0.</p>
</td></tr>
<tr><td><code id="muck_+3A_mc">MC</code></td>
<td>
<p>Whether or not to use Monte Carlo iterations to estimate the values. Defaults to TRUE, because it treats uncertainties better than if set to FALSE.</p>
</td></tr>
<tr><td><code id="muck_+3A_its">its</code></td>
<td>
<p>Amount of iterations to use if MC=TRUE. Defaults to 10,000.</p>
</td></tr>
<tr><td><code id="muck_+3A_roundby">roundby</code></td>
<td>
<p>Rounding of the output for C14 ages. Defaults to 1 decimal.</p>
</td></tr>
<tr><td><code id="muck_+3A_decimals">decimals</code></td>
<td>
<p>Rounding of the output. Since details matter here, the default is to provide 5 decimals.</p>
</td></tr>
<tr><td><code id="muck_+3A_visualise">visualise</code></td>
<td>
<p>By default, a plot is made to visualise the target and observed F14C values, together with the inferred contamination.</p>
</td></tr>
<tr><td><code id="muck_+3A_talk">talk</code></td>
<td>
<p>Whether or not to report the calculations made. Defaults to <code>talk=TRUE</code>.</p>
</td></tr>
<tr><td><code id="muck_+3A_eq.x">eq.x</code></td>
<td>
<p>Leftmost location of the equation. Defaults to <code>eq.x=5</code>. Can be set to values outside of (0,100) to make the equation invisible.</p>
</td></tr>
<tr><td><code id="muck_+3A_eq.y">eq.y</code></td>
<td>
<p>Vertical location of the equation. Defaults to the top of the graph.</p>
</td></tr>
<tr><td><code id="muck_+3A_eq.size">eq.size</code></td>
<td>
<p>Size of the font of the equation. In case the equation gets jumbled up upon resizing of a graphical device, just issue the previous 'clean' command again. Defaults to <code>eq.size=0.8</code>.</p>
</td></tr>
<tr><td><code id="muck_+3A_target.col">target.col</code></td>
<td>
<p>Colour for the target/true values. Defaults to darkgreen.</p>
</td></tr>
<tr><td><code id="muck_+3A_observed.col">observed.col</code></td>
<td>
<p>Colour for the observed values. Defaults to blue.</p>
</td></tr>
<tr><td><code id="muck_+3A_contamination.col">contamination.col</code></td>
<td>
<p>Colour for the contamination values. Defaults to red.</p>
</td></tr>
<tr><td><code id="muck_+3A_target.pch">target.pch</code></td>
<td>
<p>Icon for the target. Defaults to a filled circle.</p>
</td></tr>
<tr><td><code id="muck_+3A_observed.pch">observed.pch</code></td>
<td>
<p>Icon for the observed. Defaults to a diamond</p>
</td></tr>
<tr><td><code id="muck_+3A_contamination.pch">contamination.pch</code></td>
<td>
<p>Icon for the contamination. Defaults to a triangle.</p>
</td></tr>
<tr><td><code id="muck_+3A_true.name">true.name</code></td>
<td>
<p>Name of the label of the true/target date</p>
</td></tr>
<tr><td><code id="muck_+3A_xlab">xlab</code></td>
<td>
<p>Name of the x-axis. Defaults to 'contamination (%)'.</p>
</td></tr>
<tr><td><code id="muck_+3A_ylab">ylab</code></td>
<td>
<p>Name of the y-axis. Defaults to 'F14C'.</p>
</td></tr>
<tr><td><code id="muck_+3A_ylim">ylim</code></td>
<td>
<p>Limits of the y-axis. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="muck_+3A_bty">bty</code></td>
<td>
<p>Draw a box around a box of a certain shape. Defaults to <code>bty="l"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Whereas the function takes true/target and observed C14 ages as input and percentage contamination as output, internal calculations are done in the F14C realm and using contamination fractions (between 0 and 1). The central calculation is 'frac = (F_obs - F_true) / (F_contam - F_true)', where 'frac' is the fraction of contamination to explain how we went from the observed to the true C14 age, 'F_obs' is the observed C14 age in F14C, 'F_true' is the true or target age in F14C, 'F_contam' is the F value of the contamination. In some extreme cases (e.g., if dividing by zero), the calculation will spit out unexpected results. Messages will be provided in most of these cases.
</p>


<h3>Value</h3>

<p>The required contamination (as percentage), as well as a plot
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  muck(600, 30, 2000, 0, 1, .01)
</code></pre>

<hr>
<h2 id='older'>Find the probability of a calibrated date being older than a certain age</h2><span id='topic+older'></span>

<h3>Description</h3>

<p>Find the probability of a calibrated date being older than an age x.
</p>
<p>Find the probability that a sample is older than a certain calendar age x, by calculating the proportion of the calibrated distribution 'after' x (i.e., 1 - the summed calibrated distribution up to year x).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>older(
  x,
  y,
  er,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  normal = TRUE,
  as.F = FALSE,
  t.a = 3,
  t.b = 4,
  BCAD = FALSE,
  threshold = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="older_+3A_x">x</code></td>
<td>
<p>The year of interest, in cal BP by default.</p>
</td></tr>
<tr><td><code id="older_+3A_y">y</code></td>
<td>
<p>The radiocarbon date's mean.</p>
</td></tr>
<tr><td><code id="older_+3A_er">er</code></td>
<td>
<p>The radiocarbon date's lab error.</p>
</td></tr>
<tr><td><code id="older_+3A_cc">cc</code></td>
<td>
<p>calibration curve for the radiocarbon date(s) (see the <code>rintcal</code> package).</p>
</td></tr>
<tr><td><code id="older_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="older_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="older_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="older_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="older_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="older_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="older_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="older_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="older_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=0</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can only deal with one date at a time.
</p>


<h3>Value</h3>

<p>The probability of a date being older than a certain calendar age.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>older(2800, 2450, 20)
older(2400, 2450, 20)
calibrate(160, 20, BCAD=TRUE)
older(1750, 160, 20, BCAD=TRUE)
</code></pre>

<hr>
<h2 id='overlap'>The overlap between calibrated C14 dates</h2><span id='topic+overlap'></span>

<h3>Description</h3>

<p>Calculates the amount of overlap (as percentage) between two or more calibrated radiocarbon dates. It does this by taking a sequence of calendar dates 'x' and for each calendar date find the calibrated distribution with the minimum height - this minimum height is taken as the overlap between the dates for that age. This is repeated for all 'x'. The sum of these heights is the overlap, which can reach values from 0 to 100%.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overlap(
  y,
  er,
  res = 1000,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  thiscurve = NULL,
  BCAD = FALSE,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  cc.dir = NULL,
  threshold = 0.001,
  age.lim = c(),
  age.lab = c(),
  calib.col = rgb(0, 0, 0, 0.2),
  overlap.col = rgb(0, 0, 1, 0.4),
  overlap.border = NA,
  overlap.height = 1,
  talk = TRUE,
  prob = 0.95,
  roundby = 1,
  bty = "n"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="overlap_+3A_y">y</code></td>
<td>
<p>The set of radiocarbon dates</p>
</td></tr>
<tr><td><code id="overlap_+3A_er">er</code></td>
<td>
<p>The lab errors of the radiocarbon dates</p>
</td></tr>
<tr><td><code id="overlap_+3A_res">res</code></td>
<td>
<p>The resolution to base the calculations on. Defaults to 1000 steps between the minimum and maximum cal BP (these are calculated from the total calendar age range of all calibrated distributions).</p>
</td></tr>
<tr><td><code id="overlap_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to use. Defaults to IntCal20 (<code>cc=1</code>).</p>
</td></tr>
<tr><td><code id="overlap_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages.</p>
</td></tr>
<tr><td><code id="overlap_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="overlap_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="overlap_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="overlap_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="overlap_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="overlap_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="overlap_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="overlap_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="overlap_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=1e-6</code>.</p>
</td></tr>
<tr><td><code id="overlap_+3A_age.lim">age.lim</code></td>
<td>
<p>Calendar age limits of the calculations. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="overlap_+3A_age.lab">age.lab</code></td>
<td>
<p>Label of the calendar age, defaults to BCAD or cal BP.</p>
</td></tr>
<tr><td><code id="overlap_+3A_calib.col">calib.col</code></td>
<td>
<p>The colour of the individual calibrated ages. Defaults to semi-transparent grey.</p>
</td></tr>
<tr><td><code id="overlap_+3A_overlap.col">overlap.col</code></td>
<td>
<p>The colour of the overlap distribution</p>
</td></tr>
<tr><td><code id="overlap_+3A_overlap.border">overlap.border</code></td>
<td>
<p>The colour of the border of the overlap distribution</p>
</td></tr>
<tr><td><code id="overlap_+3A_overlap.height">overlap.height</code></td>
<td>
<p>The height of the overlap distribution</p>
</td></tr>
<tr><td><code id="overlap_+3A_talk">talk</code></td>
<td>
<p>Whether or not to report a summary of the spread</p>
</td></tr>
<tr><td><code id="overlap_+3A_prob">prob</code></td>
<td>
<p>Probability range to report. Defaults to <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="overlap_+3A_roundby">roundby</code></td>
<td>
<p>Number of decimals to report</p>
</td></tr>
<tr><td><code id="overlap_+3A_bty">bty</code></td>
<td>
<p>Draw a box around a box of a certain shape. Defaults to <code>bty="n"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The overlap between all calibrated probabilities as percentage, and a plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  y &lt;- c(3820, 4430) # the C14 ages of a twig and a marine shell from a single layer
  er &lt;- c(40, 40) # their lab errors
  overlap(y, er, cc=1:2) 
</code></pre>

<hr>
<h2 id='p.range'>Probability of a date lying within a cal BP range</h2><span id='topic+p.range'></span>

<h3>Description</h3>

<p>Find the probability of a calibrated date lying within an age range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.range(
  x1,
  x2,
  y,
  er,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  normal = TRUE,
  as.F = FALSE,
  t.a = 3,
  t.b = 4,
  BCAD = FALSE,
  threshold = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.range_+3A_x1">x1</code></td>
<td>
<p>The start the range of interest.</p>
</td></tr>
<tr><td><code id="p.range_+3A_x2">x2</code></td>
<td>
<p>The end of the range of interest.</p>
</td></tr>
<tr><td><code id="p.range_+3A_y">y</code></td>
<td>
<p>The radiocarbon date's mean.</p>
</td></tr>
<tr><td><code id="p.range_+3A_er">er</code></td>
<td>
<p>The radiocarbon date's lab error.</p>
</td></tr>
<tr><td><code id="p.range_+3A_cc">cc</code></td>
<td>
<p>calibration curve for the radiocarbon date(s) (see the <code>rintcal</code> package).</p>
</td></tr>
<tr><td><code id="p.range_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="p.range_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="p.range_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="p.range_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="p.range_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="p.range_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="p.range_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="p.range_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="p.range_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=0</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can only deal with one date at a time.
</p>


<h3>Value</h3>

<p>The probability of a date lying within a certain calendar age range.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p.range(2800, 2400, 2450, 20)
</code></pre>

<hr>
<h2 id='pMC.age'>To be deprecated. Use pMCtoC14 instead.</h2><span id='topic+pMC.age'></span>

<h3>Description</h3>

<p>Will be deprecated. Use pMCtoC14 instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pMC.age(mn, sdev = c(), ratio = 100, decimals = 0, lambda = 8033)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pMC.age_+3A_mn">mn</code></td>
<td>
<p>Reported mean of the pMC.</p>
</td></tr>
<tr><td><code id="pMC.age_+3A_sdev">sdev</code></td>
<td>
<p>Reported error of the pMC.</p>
</td></tr>
<tr><td><code id="pMC.age_+3A_ratio">ratio</code></td>
<td>
<p>Most modern-date values are reported against <code>100</code>. If it is against <code>1</code> instead, use <code>1</code> here.</p>
</td></tr>
<tr><td><code id="pMC.age_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals required for the radiocarbon age.</p>
</td></tr>
<tr><td><code id="pMC.age_+3A_lambda">lambda</code></td>
<td>
<p>The mean-life of radiocarbon (based on Libby half-life of 5568 years)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as pMC or percent modern carbon. Since Bacon expects radiocarbon ages,
this function can be used to calculate radiocarbon ages from pMC values. The reverse function is C14.pMC.
</p>


<h3>Value</h3>

<p>Radiocarbon ages from pMC values. If pMC values are above 100%, the resulting radiocarbon ages will be negative.
</p>

<hr>
<h2 id='pMCtoC14'>Calculate C14 ages from pMC values.</h2><span id='topic+pMCtoC14'></span>

<h3>Description</h3>

<p>Calculate C14 ages from pMC values of radiocarbon dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pMCtoC14(pMC, er = NULL, decimals = 0, lambda = 8033)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pMCtoC14_+3A_pmc">pMC</code></td>
<td>
<p>Reported mean of the pMC.</p>
</td></tr>
<tr><td><code id="pMCtoC14_+3A_er">er</code></td>
<td>
<p>Reported error of the pMC.</p>
</td></tr>
<tr><td><code id="pMCtoC14_+3A_decimals">decimals</code></td>
<td>
<p>Amount of decimals required for the radiocarbon age.</p>
</td></tr>
<tr><td><code id="pMCtoC14_+3A_lambda">lambda</code></td>
<td>
<p>The mean-life of radiocarbon (based on Libby half-life of 5568 years)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as pMC or percent modern carbon. Since Bacon expects radiocarbon ages,
this function can be used to calculate radiocarbon ages from pMC values. The reverse function is C14.pMC.
</p>


<h3>Value</h3>

<p>Radiocarbon ages from pMC values. If pMC values are above 100%, the resulting radiocarbon ages will be negative.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  pMCtoC14(110, 0.5) # a postbomb date, so with a negative 14C age
  pMCtoC14(80, 0.5) # prebomb dates can also be calculated
  pMCtoC14(.8, 0.005) # throws a warning, use F14C.age instead
</code></pre>

<hr>
<h2 id='pMCtoD14C'>Transform F14C into D14C</h2><span id='topic+pMCtoD14C'></span>

<h3>Description</h3>

<p>Transform F14C into D14C
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pMCtoD14C(pMC, er = NULL, t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pMCtoD14C_+3A_pmc">pMC</code></td>
<td>
<p>The pMC value to translate</p>
</td></tr>
<tr><td><code id="pMCtoD14C_+3A_er">er</code></td>
<td>
<p>Reported error of the pMC value. Returns just the mean if left empty.</p>
</td></tr>
<tr><td><code id="pMCtoD14C_+3A_t">t</code></td>
<td>
<p>the cal BP age</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As explained by Heaton et al. 2020 (Radiocarbon), 14C measurements are commonly expressed in
three domains: Delta14C, F14C and the radiocarbon age. This function translates F14C values into Delta14C, the historical level of Delta14C in the year t cal BP. Note that per convention, this function uses the Cambridge half-life, not the Libby half-life.
</p>


<h3>Value</h3>

<p>The corresponding D14C value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  pMCtoD14C(0.985, .1, 222)
</code></pre>

<hr>
<h2 id='pMCtoF14C'>Calculate pMC ages from F14C values.</h2><span id='topic+pMCtoF14C'></span>

<h3>Description</h3>

<p>Calculate pMC values from F14C values of radiocarbon dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pMCtoF14C(pMC, er = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pMCtoF14C_+3A_pmc">pMC</code></td>
<td>
<p>Reported mean of the F14C</p>
</td></tr>
<tr><td><code id="pMCtoF14C_+3A_er">er</code></td>
<td>
<p>Reported error of the pMC value. Returns just the mean if left empty.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post-bomb dates are often reported as F14C (between 0 at c. 55 kcal BP and 1 at c. AD 1950). Since software such as Bacon expects radiocarbon ages,
this function can be used to calculate radiocarbon ages from F14C values. The reverse function is <a href="#topic+age.F14C">age.F14C</a>.
</p>


<h3>Value</h3>

<p>The F14C values from the pMC values. Basically the original values divided by 100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  pMCtoF14C(110, 5)
</code></pre>

<hr>
<h2 id='point.estimates'>Calculate a point estimate</h2><span id='topic+point.estimates'></span>

<h3>Description</h3>

<p>Calculate a point estimate of a calibrated distribution - either the weighted mean, the median or the mode (maximum). Note that point estimates often tend to be very poor representations of entire calibrated distributions, so please be careful and do not reduce entire calibrated distributions to just 1 point value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>point.estimates(
  calib,
  wmean = TRUE,
  median = TRUE,
  mode = TRUE,
  midpoint = TRUE,
  prob = 0.95,
  rounded = 1,
  every = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="point.estimates_+3A_calib">calib</code></td>
<td>
<p>The calibrated distribution, as returned from caldist()</p>
</td></tr>
<tr><td><code id="point.estimates_+3A_wmean">wmean</code></td>
<td>
<p>Report the weighted mean (defaults to TRUE)</p>
</td></tr>
<tr><td><code id="point.estimates_+3A_median">median</code></td>
<td>
<p>Report the median (defaults to TRUE)</p>
</td></tr>
<tr><td><code id="point.estimates_+3A_mode">mode</code></td>
<td>
<p>Report the mode, which is the year with the maximum probability (defaults to TRUE)</p>
</td></tr>
<tr><td><code id="point.estimates_+3A_midpoint">midpoint</code></td>
<td>
<p>Report the midpoint of the hpd range(s)</p>
</td></tr>
<tr><td><code id="point.estimates_+3A_prob">prob</code></td>
<td>
<p>probability range for the hpd range(s)</p>
</td></tr>
<tr><td><code id="point.estimates_+3A_rounded">rounded</code></td>
<td>
<p>Rounding for reported probabilities. Defaults to 1 decimal.</p>
</td></tr>
<tr><td><code id="point.estimates_+3A_every">every</code></td>
<td>
<p>Yearly precision (defaults to <code>every=1</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The chosen point estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>point.estimates(caldist(130,20))
plot(tmp &lt;- caldist(2450,50), type='l')
abline(v=point.estimates(tmp), col=1:4)
</code></pre>

<hr>
<h2 id='pool'>Test if a set of radiocarbon dates can be combined</h2><span id='topic+pool'></span>

<h3>Description</h3>

<p>Calculate the (chi-square) probability that a set of radiocarbon dates is consistent, i.e. that it can be assumed that they all pertain to the same true radiocarbon age (and thus to the same calendar age - note though that sometimes multiple calendar ages obtain the same C14 age). The function calculates the differences (chi2 value) and finds the corresponding p-value. If the chi2 values is sufficiently small, then the p-value is sufficiently large (above the threshold), and the pooled mean is calculated and returned. If the scatter is too large, no pooled mean is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pool(y, er, deltaR = 0, deltaSTD = 0, threshold = 0.05, roundby = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pool_+3A_y">y</code></td>
<td>
<p>The set of radiocarbon dates to be tested</p>
</td></tr>
<tr><td><code id="pool_+3A_er">er</code></td>
<td>
<p>The lab errors of the radiocarbon dates</p>
</td></tr>
<tr><td><code id="pool_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="pool_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="pool_+3A_threshold">threshold</code></td>
<td>
<p>Probability threshold above which chisquare values are considered acceptable (between 0 and 1; default <code>threshold=0.05</code>).</p>
</td></tr>
<tr><td><code id="pool_+3A_roundby">roundby</code></td>
<td>
<p>Rounding of the reported mean, chisquare and and p-value. Defaults to <code>roundby=1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This follows the calculations of Ward and Wilson (1978; Archaeometry 20: 19-31 &lt;doi:10.1111/j.1475-4754.1978.tb00208.x&gt;) and should only be used for multiple dates that stem from the same sample (e.g., multiple measurements on a single bone). It cannot be used to test if multiple dates from multiple samples pertain to the same event. Since the assumption is that all measurements stem from the same event, we can assume that they all share the same C14 age (since any calBP age will have an associated IntCal C14 age).
</p>


<h3>Value</h3>

<p>The pooled mean and error if the p-value is above the threshold - a warning if it is not.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(shroud)
  pool(shroud$y,shroud$er)
  Zu &lt;- grep("ETH", shroud$ID) # Zurich lab only
  pool(shroud$y[Zu],shroud$er[Zu])
</code></pre>

<hr>
<h2 id='push.gamma'>Add a gamma distribution to a calibrated date</h2><span id='topic+push.gamma'></span>

<h3>Description</h3>

<p>Push a date to younger or older ages by adding (or subtracting) a gamma distribution (e.g. if a bone is assumed to have a lag or in-built age)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>push.gamma(
  y,
  er,
  mean,
  shape,
  add = TRUE,
  n = 1e+06,
  prob = 0.95,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  thiscurve = NULL,
  cc.dir = NULL,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  BCAD = FALSE,
  cal.lim = c(),
  calib.col = rgb(0, 0, 0, 0.25),
  pushed.col = rgb(0, 0, 1, 0.4),
  inset = TRUE,
  inset.col = "darkgreen",
  inset.loc = c(0.6, 0.97, 0.6, 0.97),
  inset.mar = c(3, 0.5, 0.5, 0.5),
  inset.mgp = c(2, 1, 0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="push.gamma_+3A_y">y</code></td>
<td>
<p>The radiocarbon age</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_er">er</code></td>
<td>
<p>The error of the radiocarbon age</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_mean">mean</code></td>
<td>
<p>The mean of the gamma distribution</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_shape">shape</code></td>
<td>
<p>The shape of the gamma distribution. If setting this to shape=1, it becomes an exponential distribution.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_add">add</code></td>
<td>
<p>The distribution can be added or subtracted. Adding results in ages being pushed to younger age distributions, and subtracting to older ones.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_n">n</code></td>
<td>
<p>The amount of random values to sample (from both the calibrated distribution and the gamma distribution) to calculate the push. Defaults to <code>n=1e6</code>.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_prob">prob</code></td>
<td>
<p>The probability for the hpd ranges. Defaults to <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to use. Defaults to IntCal20 (<code>cc=1</code>).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages. Defaults to <code>postbomb=FALSE</code>.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_cal.lim">cal.lim</code></td>
<td>
<p>Calendar axis limits. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_calib.col">calib.col</code></td>
<td>
<p>Colour of the calibrated distribution (defaults to semi-transparent light grey).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_pushed.col">pushed.col</code></td>
<td>
<p>Colour of the pushed distribution (defaults to semi-transparent blue).</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_inset">inset</code></td>
<td>
<p>Whether or not to plot an inset graph showing the shape of the normal/gamma distribution.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_inset.col">inset.col</code></td>
<td>
<p>Colour of the normal/gamma distribution.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_inset.loc">inset.loc</code></td>
<td>
<p>Location of the inset graph.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_inset.mar">inset.mar</code></td>
<td>
<p>Margins of the inset graph.</p>
</td></tr>
<tr><td><code id="push.gamma_+3A_inset.mgp">inset.mgp</code></td>
<td>
<p>Margin lines for the inset graph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>n random values will be sampled from the calibrated distribution, and a similar amount will be sampled from the gamma distribution. The sampled values will then be added to or subtracted from each other to push the date to younger or older ages.
</p>


<h3>Value</h3>

<p>The resulting calibrated distribution and its hpd ranges, together with a plot of the pushed date with the gamma distribution (and whether it is added or subtracted) as inset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  push.gamma(250, 25, 50, 2, add=FALSE) # subtract a gamma distribution
</code></pre>

<hr>
<h2 id='push.normal'>Add a normal distribution to a calibrated date</h2><span id='topic+push.normal'></span>

<h3>Description</h3>

<p>Push a date to younger or older ages by adding (or subtracting) a normal distribution (e.g. if a bone is assumed to have a lag or in-built age)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>push.normal(
  y,
  er,
  mean,
  sdev,
  add = TRUE,
  n = 1e+06,
  prob = 0.95,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  thiscurve = NULL,
  cc.dir = NULL,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  BCAD = FALSE,
  cal.lim = c(),
  calib.col = rgb(0, 0, 0, 0.25),
  pushed.col = rgb(0, 0, 1, 0.4),
  inset = TRUE,
  inset.col = "darkgreen",
  inset.loc = c(0.6, 0.97, 0.6, 0.97),
  inset.mar = c(3, 0.5, 0.5, 0.5),
  inset.mgp = c(2, 1, 0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="push.normal_+3A_y">y</code></td>
<td>
<p>The radiocarbon age.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_er">er</code></td>
<td>
<p>The error of the radiocarbon age.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_mean">mean</code></td>
<td>
<p>The mean of the normal or gamma distribution.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_sdev">sdev</code></td>
<td>
<p>The standard deviation of the normal distribution.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_add">add</code></td>
<td>
<p>The distribution can be added or subtracted. Adding results in ages being pushed to younger age distributions, and subtracting to older ones.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_n">n</code></td>
<td>
<p>The amount of random values to sample (from both the calibrated distribution and the gamma/normal distribution) to calculate the push. Defaults to <code>n=1e6</code>.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_prob">prob</code></td>
<td>
<p>The probability for the hpd ranges. Defaults to <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to use. Defaults to IntCal20 (<code>cc=1</code>).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages. Defaults to <code>postbomb=FALSE</code>.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_cal.lim">cal.lim</code></td>
<td>
<p>Calendar axis limits. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_calib.col">calib.col</code></td>
<td>
<p>Colour of the calibrated distribution (defaults to semi-transparent light grey).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_pushed.col">pushed.col</code></td>
<td>
<p>Colour of the pushed distribution (defaults to semi-transparent blue).</p>
</td></tr>
<tr><td><code id="push.normal_+3A_inset">inset</code></td>
<td>
<p>Whether or not to plot an inset graph showing the shape of the normal/gamma distribution.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_inset.col">inset.col</code></td>
<td>
<p>Colour of the normal/gamma distribution.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_inset.loc">inset.loc</code></td>
<td>
<p>Location of the inset graph.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_inset.mar">inset.mar</code></td>
<td>
<p>Margins of the inset graph.</p>
</td></tr>
<tr><td><code id="push.normal_+3A_inset.mgp">inset.mgp</code></td>
<td>
<p>Margin lines for the inset graph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>n random values will be sampled from the calibrated distribution, and a similar amount will be sampled from the normal distribution. The sampled values will then be added to or subtracted from each other to push the date to younger or older ages.
</p>


<h3>Value</h3>

<p>The resulting calibrated distribution and its hpd ranges, together with a plot of the pushed date with the normal distribution (and whether it is added or subtracted) as inset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  push.normal(250, 25, 50, 10)
</code></pre>

<hr>
<h2 id='r.calib'>return a random calendar age from a calibrated distribution</h2><span id='topic+r.calib'></span>

<h3>Description</h3>

<p>Calculate the cumulative calibrated distribution, then sample n random uniform values between 0 and 1 and find the corresponding calendar ages through interpolation. Calendar ages with higher calibrated probabilities will be proportionally more likely to be sampled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r.calib(
  n,
  y,
  er,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  as.F = FALSE,
  thiscurve = NULL,
  yrsteps = FALSE,
  cc.resample = FALSE,
  dist.res = 200,
  threshold = 0,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  normalise = TRUE,
  BCAD = FALSE,
  rule = 2,
  cc.dir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r.calib_+3A_n">n</code></td>
<td>
<p>The number of calendar ages to sample</p>
</td></tr>
<tr><td><code id="r.calib_+3A_y">y</code></td>
<td>
<p>Uncalibrated radiocarbon age</p>
</td></tr>
<tr><td><code id="r.calib_+3A_er">er</code></td>
<td>
<p>Lab error of the radiocarbon age</p>
</td></tr>
<tr><td><code id="r.calib_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to use. Defaults to IntCal20 (<code>cc=1</code>).</p>
</td></tr>
<tr><td><code id="r.calib_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages.</p>
</td></tr>
<tr><td><code id="r.calib_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="r.calib_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="r.calib_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="r.calib_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="r.calib_+3A_yrsteps">yrsteps</code></td>
<td>
<p>Steps to use for interpolation. Defaults to the cal BP steps in the calibration curve</p>
</td></tr>
<tr><td><code id="r.calib_+3A_cc.resample">cc.resample</code></td>
<td>
<p>The IntCal20 curves have different densities (every year between 0 and 5 kcal BP, then every 5 yr up to 15 kcal BP, then every 10 yr up to 25 kcal BP, and then every 20 yr up to 55 kcal BP). If calibrated ages span these density ranges, their drawn heights can differ, as can their total areas (which should ideally all sum to the same size). To account for this, resample to a constant time-span, using, e.g., <code>cc.resample=5</code> for 5-yr timespans.</p>
</td></tr>
<tr><td><code id="r.calib_+3A_dist.res">dist.res</code></td>
<td>
<p>As an alternative to yrsteps, provide the amount of 'bins' in the distribution</p>
</td></tr>
<tr><td><code id="r.calib_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=0</code>.</p>
</td></tr>
<tr><td><code id="r.calib_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="r.calib_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="r.calib_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="r.calib_+3A_normalise">normalise</code></td>
<td>
<p>Sum the entire calibrated distribution to 1. Defaults to <code>normalise=TRUE</code>.</p>
</td></tr>
<tr><td><code id="r.calib_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="r.calib_+3A_rule">rule</code></td>
<td>
<p>Which extrapolation rule to use. Defaults to <code>rule=1</code> which returns NAs.</p>
</td></tr>
<tr><td><code id="r.calib_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>n randomly sampled calendar ages
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  r.calib(10,130,20) # 10 random cal BP ages
  plot(density(r.calib(1e6, 2450, 20)))
</code></pre>

<hr>
<h2 id='rice'>Radiocarbon Equations</h2><span id='topic+rice'></span>

<h3>Description</h3>

<p>Provides functions for the calibration of radiocarbon dates, as well as options to calculate different radiocarbon realms (C14 age, F14C, pMC, D14C) and estimating the effects of contamination or local reservoir offsets (Reimer and Reimer 2001 <a href="https://doi.org/10.1017/S0033822200038339">doi:10.1017/S0033822200038339</a>). The methods follow long-established recommendations such as Stuiver and Polach (1977) <a href="https://doi.org/10.1017/S0033822200003672">doi:10.1017/S0033822200003672</a> and Reimer et al. (2004) <a href="https://doi.org/10.1017/S0033822200033154">doi:10.1017/S0033822200033154</a>. This package complements the data package 'rintcal'.
</p>
<p>Provides equations for the handling of radiocarbon dates, for example to calculate different radiocarbon realms (C14 age, F14C, pMC, D14C), for their calibration, and estimating the effects of contamination. This package accompanies the data package rintcal.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Maarten Blaauw <a href="mailto:maarten.blaauw@qub.ac.uk">maarten.blaauw@qub.ac.uk</a> (<a href="https://orcid.org/0000-0002-5680-1515">ORCID</a>)
</p>
<p>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt;
</p>

<hr>
<h2 id='shells'>shells Data</h2><span id='topic+shells'></span>

<h3>Description</h3>

<p>A dataset containing the deltaR values and accompanying data from the marine database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shells
</code></pre>


<h3>Format</h3>

<p>A data frame with 1968 rows and 15 variables.
</p>

<dl>
<dt>lon</dt><dd><p>Longitude of the datapoint</p>
</dd>
<dt>lat</dt><dd><p>Latitude of the datapoint</p>
</dd>
<dt>no</dt><dd><p>Map or ID number of the datapoint</p>
</dd>
<dt>taxonN</dt><dd><p>Taxon number of the datapoint</p>
</dd>
<dt>dR</dt><dd><p>calculated deltaR of the datapoint</p>
</dd>
<dt>dSTD</dt><dd><p>uncertainty of the deltaR of the datapoint</p>
</dd>
<dt>collected</dt><dd><p>Collection year for the datapoint</p>
</dd>
<dt>res</dt><dd><p>Reservoir effect of the datapoint</p>
</dd>
<dt>res.error</dt><dd><p>Uncertainty of the reservoir effect of the datapoint</p>
</dd>
<dt>C14</dt><dd><p>Radiocarbon age of the datapoint</p>
</dd>
<dt>er</dt><dd><p>Error of the radiocarbon age of the datapoint</p>
</dd>
<dt>lab</dt><dd><p>Lab code of the datapoint</p>
</dd>
<dt>ref</dt><dd><p>Reference for the datapoint</p>
</dd>
<dt>taxon</dt><dd><p>Taxon of the datapoint</p>
</dd>
<dt>feeding</dt><dd><p>Feeding ecology of the datapoint (if known)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data downloaded from calib.org/marine
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shells)
head(shells)
</code></pre>

<hr>
<h2 id='shells.mean'>Plot and summarize the dR values</h2><span id='topic+shells.mean'></span>

<h3>Description</h3>

<p>After selecting a relevant range of shell values, plot them and calculate the weighted mean and variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shells.mean(
  dat,
  feeding = c(),
  draw = TRUE,
  distance = FALSE,
  pch = 20,
  col.mn = 1,
  lty.mn = 2,
  col.sd = rgb(0, 0, 0, 0.1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shells.mean_+3A_dat">dat</code></td>
<td>
<p>The data, as returned from the function 'plot.shells'.</p>
</td></tr>
<tr><td><code id="shells.mean_+3A_feeding">feeding</code></td>
<td>
<p>Whether or not to select a specific feeding behaviour. Defaults to empty (no selection of feeding behaviour).</p>
</td></tr>
<tr><td><code id="shells.mean_+3A_draw">draw</code></td>
<td>
<p>Whether or not to draw the values.</p>
</td></tr>
<tr><td><code id="shells.mean_+3A_distance">distance</code></td>
<td>
<p>Plot the dR values according to their distance (if you've used find.shells; assumes that 'dat' has a final column with the distances).</p>
</td></tr>
<tr><td><code id="shells.mean_+3A_pch">pch</code></td>
<td>
<p>Symbol to be plotted. Defaults to a closed circle (<code>pch=20</code>).</p>
</td></tr>
<tr><td><code id="shells.mean_+3A_col.mn">col.mn</code></td>
<td>
<p>Colour for the weighted mean. Defaults to black, <code>col.mn=1</code>.</p>
</td></tr>
<tr><td><code id="shells.mean_+3A_lty.mn">lty.mn</code></td>
<td>
<p>Line type for the weighted mean. Defaults to dashed, <code>lty.mn=2</code>.</p>
</td></tr>
<tr><td><code id="shells.mean_+3A_col.sd">col.sd</code></td>
<td>
<p>Colour of the rectangle of the error. Defaults to transparent grey, <code>col.sd=rgb(0,0,0,.1)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the dR values, as well as the weighted mean (vertical line) and (weighted) error (rectangle).
</p>


<h3>Examples</h3>

<pre><code class='language-R'> N_UK &lt;- map.shells(53, -11, 60, 2, mapsize="medium")
 shells.mean(N_UK)
 nearby &lt;- find.shells(0,56,20) # somewhere in Scotland
 shells.mean(nearby, distance=TRUE) # distance matters
</code></pre>

<hr>
<h2 id='shroud'>shroud Data</h2><span id='topic+shroud'></span>

<h3>Description</h3>

<p>A dataset containing the radiocarbon dates on the Shroud of Turin, from three labs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shroud
</code></pre>


<h3>Format</h3>

<p>A data frame with 1968 rows and 15 variables.
</p>

<dl>
<dt>ID</dt><dd><p>Lab numbers. Replicates are indicates with .1, .2, etc.</p>
</dd>
<dt>y</dt><dd><p>Radiocarbon year</p>
</dd>
<dt>er</dt><dd><p>Lab error</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data taken from Damon et al. 1989 [Nature] &lt;doi:10.1038/337611a0&gt;, see also Christen 1994 [Applied Statistics] &lt;doi:10.2307/2986273&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shroud)
head(shroud)
</code></pre>

<hr>
<h2 id='smooth.curve'>Smooth a calibration curve</h2><span id='topic+smooth.curve'></span><span id='topic+smooth.ccurve'></span>

<h3>Description</h3>

<p>Smooth a calibration curve over a time window of a specified width. This to accommodate material that has accumulated over a certain assumed time, e.g. a cm of peat over say 30 years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth.ccurve(
  smooth = 30,
  cc = 1,
  postbomb = FALSE,
  cc.dir = c(),
  thiscurve = c(),
  resample = 0,
  name = "smoothed.csv",
  save = FALSE,
  sep = "\t"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smooth.curve_+3A_smooth">smooth</code></td>
<td>
<p>The window width of the smoothing. Defaults to <code>smooth=30</code>.</p>
</td></tr>
<tr><td><code id="smooth.curve_+3A_cc">cc</code></td>
<td>
<p>The calibration curve to smooth. Calibration curve for 14C dates: 'cc=1' for IntCal20 (northern hemisphere terrestrial), 'cc=2' for Marine20 (marine), 'cc=3' for SHCal20 (southern hemisphere terrestrial). Alternatively, one can also write, e.g., &quot;IntCal20&quot;, &quot;Marine13&quot;. One can also make a custom-built calibration curve, e.g. using 'mix.ccurves()', and load this using 'cc=4'. In this case, it is recommended to place the custom calibration curve in its own directory, using 'cc.dir' (see below).</p>
</td></tr>
<tr><td><code id="smooth.curve_+3A_postbomb">postbomb</code></td>
<td>
<p>Use 'postbomb=TRUE' to get a postbomb calibration curve (default 'postbomb=FALSE'). For monthly data, type e.g. 'ccurve(&quot;sh1-2_monthly&quot;)'</p>
</td></tr>
<tr><td><code id="smooth.curve_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., 'cc.dir=&quot;ccurves&quot;'.</p>
</td></tr>
<tr><td><code id="smooth.curve_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error). Defaults to c().</p>
</td></tr>
<tr><td><code id="smooth.curve_+3A_resample">resample</code></td>
<td>
<p>The IntCal curves come at a range of 'bin sizes'; every year from 0 to 5 kcal BP, then every 5 yr until 15 kcal BP, then every 10 yr until 25 kcal BP, and every 20 year thereafter. The curves can be resampled to constant bin sizes, e.g. 'resample=5'. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="smooth.curve_+3A_name">name</code></td>
<td>
<p>The filename of the curve, if it is being saved. Defaults to <code>name="smoothed.csv"</code>.</p>
</td></tr>
<tr><td><code id="smooth.curve_+3A_save">save</code></td>
<td>
<p>Whether or not to save the curve to cc.dir. Defaults to <code>save=FALSE</code>.</p>
</td></tr>
<tr><td><code id="smooth.curve_+3A_sep">sep</code></td>
<td>
<p>Separator between fields if the file is saved (tab by default, <code>sep="\t"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The smoothing is done by calculating the mean C14 age and error of a moving window (moving along with the cal BP steps of the calibration curve). Something similar is done in the online calibration software CALIB.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'> mycurve &lt;- smooth.ccurve(smooth=50)
 calibrate(2450,20, thiscurve=mycurve)
</code></pre>

<hr>
<h2 id='spread'>The spread among calibrated dates</h2><span id='topic+spread'></span>

<h3>Description</h3>

<p>Calculates the spread among multiple calibrated radiocarbon dates. It does this by randomly sampling ages from the calibrated dates, and calculate the difference between one random date and all others for that iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spread(
  y,
  er,
  n = 1e+05,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  as.F = FALSE,
  thiscurve = NULL,
  yrsteps = 1,
  cc.resample = FALSE,
  threshold = 0.001,
  normal = TRUE,
  t.a = 3,
  t.b = 4,
  cc.dir = NULL,
  visualise = TRUE,
  talk = TRUE,
  prob = 0.95,
  roundby = 1,
  bty = "l"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spread_+3A_y">y</code></td>
<td>
<p>The set of radiocarbon dates</p>
</td></tr>
<tr><td><code id="spread_+3A_er">er</code></td>
<td>
<p>The lab errors of the radiocarbon dates</p>
</td></tr>
<tr><td><code id="spread_+3A_n">n</code></td>
<td>
<p>The number of iterations to base the calculations on. Defaults to 100,000.</p>
</td></tr>
<tr><td><code id="spread_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to use. Defaults to IntCal20 (<code>cc=1</code>).</p>
</td></tr>
<tr><td><code id="spread_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve. Required for negative radiocarbon ages.</p>
</td></tr>
<tr><td><code id="spread_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="spread_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="spread_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="spread_+3A_thiscurve">thiscurve</code></td>
<td>
<p>As an alternative to providing cc and/or postbomb, the data of a specific curve can be provided (3 columns: cal BP, C14 age, error).</p>
</td></tr>
<tr><td><code id="spread_+3A_yrsteps">yrsteps</code></td>
<td>
<p>Steps to use for interpolation. Defaults to the cal BP steps in the calibration curve</p>
</td></tr>
<tr><td><code id="spread_+3A_cc.resample">cc.resample</code></td>
<td>
<p>The IntCal20 curves have different densities (every year between 0 and 5 kcal BP, then every 5 yr up to 15 kcal BP, then every 10 yr up to 25 kcal BP, and then every 20 yr up to 55 kcal BP). If calibrated ages span these density ranges, their drawn heights can differ, as can their total areas (which should ideally all sum to the same size). To account for this, resample to a constant time-span, using, e.g., cc.resample=5 for 5-yr timespans.</p>
</td></tr>
<tr><td><code id="spread_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=1e-6</code>.</p>
</td></tr>
<tr><td><code id="spread_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="spread_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="spread_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="spread_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory of the calibration curves. Defaults to where the package's files are stored (system.file), but can be set to, e.g., <code>cc.dir="curves"</code>.</p>
</td></tr>
<tr><td><code id="spread_+3A_visualise">visualise</code></td>
<td>
<p>Whether or not to plot the spread</p>
</td></tr>
<tr><td><code id="spread_+3A_talk">talk</code></td>
<td>
<p>Whether or not to report a summary of the spread</p>
</td></tr>
<tr><td><code id="spread_+3A_prob">prob</code></td>
<td>
<p>Probability range to report. Defaults to <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="spread_+3A_roundby">roundby</code></td>
<td>
<p>Number of decimals to report</p>
</td></tr>
<tr><td><code id="spread_+3A_bty">bty</code></td>
<td>
<p>Draw a box around a box of a certain shape. Defaults to <code>bty="l"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The spread of all calibrated probabilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(shroud)
  spread(shroud$y,shroud$er)
  Zu &lt;- grep("ETH", shroud$ID) # Zurich lab only
  spread(shroud$y[Zu],shroud$er[Zu])
</code></pre>

<hr>
<h2 id='weighted_means'>Calculate the weighted mean of C14 ages</h2><span id='topic+weighted_means'></span>

<h3>Description</h3>

<p>Calculating the weighted mean of multiple C14 ages, using their means and lab errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted_means(y, er, round = 1, talk = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weighted_means_+3A_y">y</code></td>
<td>
<p>The C14 ages.</p>
</td></tr>
<tr><td><code id="weighted_means_+3A_er">er</code></td>
<td>
<p>The lab errors of the C14 ages.</p>
</td></tr>
<tr><td><code id="weighted_means_+3A_round">round</code></td>
<td>
<p>Rounding to be applied (defaults to 1 decimal).</p>
</td></tr>
<tr><td><code id="weighted_means_+3A_talk">talk</code></td>
<td>
<p>Report details of the found values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The weighted mean and error (the latter is the maximum of the weighted error and the square root of the variance).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  N_UK &lt;- map.shells(53, -11, 60, 2, mapsize="medium")
  weighted_means(N_UK$dR, N_UK$dSTD)
</code></pre>

<hr>
<h2 id='younger'>Find the probability of a calibrated date being of a certain age or younger than it</h2><span id='topic+younger'></span>

<h3>Description</h3>

<p>Find the probability that a sample is of a certain calendar age x or younger than it, by calculating the proportion of the calibrated distribution up to and including x (i.e., summing the calibrated distribution up to year x).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>younger(
  x,
  y,
  er,
  cc = 1,
  postbomb = FALSE,
  deltaR = 0,
  deltaSTD = 0,
  normal = TRUE,
  as.F = FALSE,
  t.a = 3,
  t.b = 4,
  BCAD = FALSE,
  threshold = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="younger_+3A_x">x</code></td>
<td>
<p>The year of interest, in cal BP by default.</p>
</td></tr>
<tr><td><code id="younger_+3A_y">y</code></td>
<td>
<p>The radiocarbon date's mean.</p>
</td></tr>
<tr><td><code id="younger_+3A_er">er</code></td>
<td>
<p>The radiocarbon date's lab error.</p>
</td></tr>
<tr><td><code id="younger_+3A_cc">cc</code></td>
<td>
<p>calibration curve for the radiocarbon date(s) (see the <code>rintcal</code> package).</p>
</td></tr>
<tr><td><code id="younger_+3A_postbomb">postbomb</code></td>
<td>
<p>Whether or not to use a postbomb curve (see <code>caldist()</code>).</p>
</td></tr>
<tr><td><code id="younger_+3A_deltar">deltaR</code></td>
<td>
<p>Age offset (e.g. for marine samples).</p>
</td></tr>
<tr><td><code id="younger_+3A_deltastd">deltaSTD</code></td>
<td>
<p>Uncertainty of the age offset (1 standard deviation).</p>
</td></tr>
<tr><td><code id="younger_+3A_normal">normal</code></td>
<td>
<p>Use the normal distribution to calibrate dates (default TRUE). The alternative is to use the t model (Christen and Perez 2016).</p>
</td></tr>
<tr><td><code id="younger_+3A_as.f">as.F</code></td>
<td>
<p>Whether or not to calculate ages in the F14C realm. Defaults to <code>as.F=FALSE</code>, which uses the C14 realm.</p>
</td></tr>
<tr><td><code id="younger_+3A_t.a">t.a</code></td>
<td>
<p>Value a of the t distribution (defaults to 3).</p>
</td></tr>
<tr><td><code id="younger_+3A_t.b">t.b</code></td>
<td>
<p>Value b of the t distribution (defaults to 4).</p>
</td></tr>
<tr><td><code id="younger_+3A_bcad">BCAD</code></td>
<td>
<p>Which calendar scale to use. Defaults to cal BP, <code>BCAD=FALSE</code>.</p>
</td></tr>
<tr><td><code id="younger_+3A_threshold">threshold</code></td>
<td>
<p>Report only values above a threshold. Defaults to <code>threshold=0</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can only deal with one date at a time.
</p>


<h3>Value</h3>

<p>The probability of a date being of a certain calendar age or younger than it.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>younger(2800, 2450, 20)
younger(2400, 2450, 20)
calibrate(160, 20, BCAD=TRUE)
younger(1750, 160, 20, BCAD=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
