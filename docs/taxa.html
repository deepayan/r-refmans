<!DOCTYPE html><html><head><title>Help for package taxa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {taxa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+5B.taxa_classification'><p>Taxonomy class</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>magrittr forward-pipe operator</p></a></li>
<li><a href='#+25in+25'><p>Value matching for taxa package</p></a></li>
<li><a href='#as_data_frame'><p>Convert a taxa object to a <code>data.frame</code></p></a></li>
<li><a href='#as_taxon'><p>Convert to a taxon vector</p></a></li>
<li><a href='#check_taxon_rank_order'><p>Check that order is ascending</p></a></li>
<li><a href='#classification'><p>Taxon class</p></a></li>
<li><a href='#contains'><p>dplyr select_helpers</p></a></li>
<li><a href='#database_ref'><p>Database list</p></a></li>
<li><a href='#db_ref'><p>Valid taxonomy databases</p></a></li>
<li><a href='#default_db_ref'><p>Defines valid taxonomic databases</p></a></li>
<li><a href='#delete_unused_class_taxa'><p>Removes taxa from the taxonomy of a classification that are not used by any of the instances</p></a></li>
<li><a href='#duplicated_index'><p>Returns the index of the first occurrence of each unique element</p></a></li>
<li><a href='#duplicated_index_taxonomy'><p>Returns the index of the first occurrence of each unique taxon in a taxonomy</p></a></li>
<li><a href='#ends_with'><p>dplyr select_helpers</p></a></li>
<li><a href='#everything'><p>dplyr select_helpers</p></a></li>
<li><a href='#font_default'><p>Default font</p></a></li>
<li><a href='#font_na'><p>Font for NAs in print methods</p></a></li>
<li><a href='#font_punct'><p>Punctuation formatting in print methods</p></a></li>
<li><a href='#font_secondary'><p>Font for secondary data</p></a></li>
<li><a href='#font_tax_name'><p>Taxon name formatting in print methods</p></a></li>
<li><a href='#format.taxa_classification'><p>taxa printing functions</p></a></li>
<li><a href='#impute_order_na'><p>Fill in NA values in sequence</p></a></li>
<li><a href='#interleave'><p>Interleaves two vectors</p></a></li>
<li><a href='#internodes'><p>Get internodes</p></a></li>
<li><a href='#is_classification'><p>Check if is a classification</p></a></li>
<li><a href='#is_internode'><p>Check if taxa are internodes</p></a></li>
<li><a href='#is_leaf'><p>Check if taxa are leaves</p></a></li>
<li><a href='#is_root'><p>Test if taxa are roots</p></a></li>
<li><a href='#is_stem'><p>Check if taxa are stems</p></a></li>
<li><a href='#is_taxon'><p>Check if something is a taxon object</p></a></li>
<li><a href='#is_taxon_authority'><p>Check if is a taxon_authority</p></a></li>
<li><a href='#is_taxon_db'><p>Check if something is a taxon_db</p></a></li>
<li><a href='#is_taxon_id'><p>Check if something is a taxon_id object</p></a></li>
<li><a href='#is_taxon_rank'><p>Check if something is a taxon_rank</p></a></li>
<li><a href='#is_taxon_rank_level'><p>Check if is a taxon id</p></a></li>
<li><a href='#is_taxonomy'><p>Check if something is a taxonomy</p></a></li>
<li><a href='#is_valid_regex'><p>Check regex validity</p></a></li>
<li><a href='#leaves'><p>Get leaves</p></a></li>
<li><a href='#limited_print'><p>Print a subset of a character vector</p></a></li>
<li><a href='#matches'><p>dplyr select_helpers</p></a></li>
<li><a href='#n_leaves'><p>Number of leaves per taxon</p></a></li>
<li><a href='#n_subtaxa'><p>Number of subtaxa per taxon</p></a></li>
<li><a href='#n_supertaxa'><p>Number of supertaxa per taxon</p></a></li>
<li><a href='#new_classification'><p>Minimal classfication constructor</p></a></li>
<li><a href='#new_taxon'><p>Minimal taxon constructor</p></a></li>
<li><a href='#new_taxon_authority'><p>Minimal taxon_authority constructor</p></a></li>
<li><a href='#new_taxon_db'><p>Minimal taxon_db constructor</p></a></li>
<li><a href='#new_taxon_db_def'><p>Minimal taxon_db_def constructor</p></a></li>
<li><a href='#new_taxon_id'><p>Minimal taxon_id constructor</p></a></li>
<li><a href='#new_taxon_rank'><p>Minimal taxon_rank constructor</p></a></li>
<li><a href='#new_taxon_rank_level'><p>Minimal taxon_rank_level constructor</p></a></li>
<li><a href='#new_taxonomy'><p>Minimal taxonomy constructor</p></a></li>
<li><a href='#num_range'><p>dplyr select_helpers</p></a></li>
<li><a href='#one_of'><p>dplyr select_helpers</p></a></li>
<li><a href='#print_with_color'><p>Print that works with color</p></a></li>
<li><a href='#printed_classification'><p>Prepare classification for printing</p></a></li>
<li><a href='#printed_taxon'><p>Prepare taxon for printing</p></a></li>
<li><a href='#printed_taxon_authority'><p>Prepare taxon_authority for printing</p></a></li>
<li><a href='#printed_taxon_id'><p>Prepare taxon_id for printing</p></a></li>
<li><a href='#printed_taxon_rank'><p>Prepare taxon_rank for printing</p></a></li>
<li><a href='#printed_taxon_rank_level'><p>Prepare taxon_rank_level for printing</p></a></li>
<li><a href='#printed_taxonomy'><p>Prepare taxonomy for printing</p></a></li>
<li><a href='#rank_level_color_funcs'><p>Get font color for levels</p></a></li>
<li><a href='#rank_ref'><p>All known taxonomic ranks</p></a></li>
<li><a href='#roots'><p>Get root taxa</p></a></li>
<li><a href='#starts_with'><p>dplyr select_helpers</p></a></li>
<li><a href='#stems'><p>Get stems</p></a></li>
<li><a href='#subtaxa'><p>Get subtaxa</p></a></li>
<li><a href='#supertaxa'><p>Get supertaxa</p></a></li>
<li><a href='#tax_auth.taxa_classification'><p>Set and get taxon authorities</p></a></li>
<li><a href='#tax_author.taxa_classification'><p>Set and get taxon authors</p></a></li>
<li><a href='#tax_cite.taxa_classification'><p>Set and get taxon authority citations</p></a></li>
<li><a href='#tax_date.taxa_classification'><p>Set and get taxon authority dates</p></a></li>
<li><a href='#tax_db.taxa_classification'><p>Set and get taxon ID databases</p></a></li>
<li><a href='#tax_id.taxa_classification'><p>Set and get taxon IDs</p></a></li>
<li><a href='#tax_name.taxa_classification'><p>Set and get taxon names</p></a></li>
<li><a href='#tax_rank.taxa_classification'><p>Set and get taxon ranks</p></a></li>
<li><a href='#taxa_comparison_funcs'><p>taxa comparison functions</p></a></li>
<li><a href='#taxa_taxon_authority-class'><p>Taxon authority class</p></a></li>
<li><a href='#taxa_taxon_db-class'><p>Taxon database class</p></a></li>
<li><a href='#taxa_taxon_id-class'><p>Taxon ID class</p></a></li>
<li><a href='#taxa_taxon_rank-class'><p>Taxon rank class</p></a></li>
<li><a href='#taxa_taxon-class'><p>Taxon class</p></a></li>
<li><a href='#taxa_taxonomy-class'><p>Taxonomy class</p></a></li>
<li><a href='#taxon'><p>Taxon class</p></a></li>
<li><a href='#taxon_authority'><p>Taxon authority class</p></a></li>
<li><a href='#taxon_db'><p>Taxon database class</p></a></li>
<li><a href='#taxon_db_def'><p>Taxon database definition class</p></a></li>
<li><a href='#taxon_id'><p>Taxon ID class</p></a></li>
<li><a href='#taxon_rank'><p>Taxon rank class</p></a></li>
<li><a href='#taxon_rank_level'><p>Taxon rank level</p></a></li>
<li><a href='#unname_fields'><p>Remove names from fields in a vctrs rcrd</p></a></li>
<li><a href='#vec_cast.taxa_classification'><p>taxa casting functions</p></a></li>
<li><a href='#vec_ptype2.taxa_classification'><p>taxa coercion functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Classes for Storing and Manipulating Taxonomic Data</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides classes for storing and manipulating taxonomic data. 
 Most of the classes can be treated like base R vectors (e.g. can be used 
 in tables as columns and can be named). Vectorized classes can store taxon names
 and authorities, taxon IDs from databases, taxon ranks, and other types of
 information. More complex classes are provided to store taxonomic trees and
 user-defined data associated with them.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), vctrs</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://docs.ropensci.org/taxa/">https://docs.ropensci.org/taxa/</a>, <a href="https://github.com/ropensci/taxa">https://github.com/ropensci/taxa</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/taxa/issues">https://github.com/ropensci/taxa/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, magrittr, tibble, rlang, stringr, crayon, utils,
pillar, methods, viridisLite, cli</td>
</tr>
<tr>
<td>Suggests:</td>
<td>roxygen2 (&ge; 6.0.1), testthat, rmarkdown (&ge; 0.9.6)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>X-schema.org-applicationCategory:</td>
<td>Taxonomy</td>
</tr>
<tr>
<td>X-schema.org-keywords:</td>
<td>taxonomy, biology, hierarchy</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-20 09:19:12 UTC; fosterz</td>
</tr>
<tr>
<td>Author:</td>
<td>Scott Chamberlain <a href="https://orcid.org/0000-0003-1444-9135"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Zachary Foster <a href="https://orcid.org/0000-0002-5075-0948"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zachary Foster &lt;zacharyfoster1989@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-20 09:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+5B.taxa_classification'>Taxonomy class</h2><span id='topic++5B.taxa_classification'></span><span id='topic++5B+5B.taxa_classification'></span><span id='topic+taxonomy'></span><span id='topic+names.taxa_taxonomy'></span><span id='topic+names+3C-.taxa_taxonomy'></span><span id='topic++5B.taxa_taxonomy'></span><span id='topic++5B+5B.taxa_taxonomy'></span>

<h3>Description</h3>

<a href='https://www.tidyverse.org/lifecycle/#experimental'><img src='figures/lifecycle-experimental.svg' alt='Experimental lifecycle'></a>
<p>Used to store information about a set of taxa forming a taxonomic tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
x[...]

## S3 method for class 'taxa_classification'
x[[i]]

taxonomy(taxa = taxon(), supertaxa = NA, .names = NULL)

## S3 method for class 'taxa_taxonomy'
names(x)

## S3 replacement method for class 'taxa_taxonomy'
names(x) &lt;- value

## S3 method for class 'taxa_taxonomy'
x[..., subtaxa = TRUE, supertaxa = FALSE, invert = FALSE]

## S3 method for class 'taxa_taxonomy'
x[[i, ..., subtaxa = TRUE, supertaxa = FALSE, invert = FALSE]]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B.taxa_classification_+3A_taxa">taxa</code></td>
<td>
<p>A <a href="#topic+taxon">taxon</a> vector or something that can be converted to a <a href="#topic+taxon">taxon</a> vector.</p>
</td></tr>
<tr><td><code id="+2B5B.taxa_classification_+3A_supertaxa">supertaxa</code></td>
<td>
<p>The indexes of <code>taxa</code> for each taxon's supertaxon.</p>
</td></tr>
<tr><td><code id="+2B5B.taxa_classification_+3A_.names">.names</code></td>
<td>
<p>The names of the vector (not the names of taxa).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon</code>
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic+classification">classification</a>()</code>,
<code><a href="#topic+taxon">taxon</a>()</code>,
<code><a href="#topic+taxon_authority">taxon_authority</a>()</code>,
<code><a href="#topic+taxon_db">taxon_db</a>()</code>,
<code><a href="#topic+taxon_id">taxon_id</a>()</code>,
<code><a href="#topic+taxon_rank">taxon_rank</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))

x &lt;- taxonomy(taxon(name = c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                             'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
                    rank = c('order', 'family', 'genus', 'species',
                             'species', 'family', 'genus', 'species'),
                    id = taxon_id(c('33554', '9681', '9688', '9689',
                                    '9694', '9632', '9639', '9644'),
                                  db = 'ncbi'),
                    auth = c('Bowdich, 1821', 'Fischer de Waldheim, 1817', 'Oken, 1816', 'L., 1758',
                             'L., 1758', 'Fischer de Waldheim, 1817', 'L., 1758', 'L., 1758')),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
names(x) &lt;- letters[1:8]

# Subset taxonomy vector
x[2] # By default, all subtaxa are included
x['b'] # Names can also be used
x[2:3, subtaxa = FALSE] # Disable subtaxa
x[3, supertaxa = TRUE] # include supertaxa
x[is_leaf(x)] # Subset by logical vector

# Get parts of the taxonomy vector
tax_name(x)
tax_rank(x)
tax_id(x)
tax_db(x)
tax_auth(x)
tax_author(x)
tax_date(x)
tax_cite(x)

# Set parts of the taxonomy vector
tax_name(x) &lt;- tolower(tax_name(x))
tax_rank(x)[1] &lt;- NA
tax_id(x) &lt;- '9999'
tax_db(x) &lt;- 'itis'
tax_auth(x) &lt;- NA
tax_author(x)[2:3] &lt;- c('Joe', 'Billy')
tax_date(x) &lt;- c('1999', '2013', '1796', '1899',
                 '1997', '2003', '1996', '1859')
tax_cite(x)['c'] &lt;- 'Linnaeus, C. (1771). Mantissa plantarum altera generum.'

# Convert to table
tibble::as_tibble(x)
as_data_frame(x)

# Get taxonomy attributes
subtaxa(x)
subtaxa(x, value = tax_name(x))
subtaxa(x, value = as_taxon(x))
n_subtaxa(x)
supertaxa(x)
n_supertaxa(x)
leaves(x)
n_leaves(x)
is_leaf(x)
stems(x)
is_stem(x)
roots(x)
is_root(x)
internodes(x)
is_internode(x)

</code></pre>

<hr>
<h2 id='+25+26gt+3B+25'>magrittr forward-pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>magrittr forward-pipe operator
</p>

<hr>
<h2 id='+25in+25'>Value matching for taxa package</h2><span id='topic++25in+25'></span>

<h3>Description</h3>

<p>A wrapper for the base value matching %in% that is used to take into consideration features of the taxa package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %in% table
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25in+2B25_+3A_x">x</code></td>
<td>
<p>vector or <code>NULL</code>: the values to be matched.
<a href="base.html#topic+Long+20vectors">Long vectors</a> are supported.</p>
</td></tr>
<tr><td><code id="+2B25in+2B25_+3A_table">table</code></td>
<td>
<p>vector or <code>NULL</code>: the values to be matched against.
<a href="base.html#topic+Long+20vectors">Long vectors</a> are not supported.</p>
</td></tr>
</table>

<hr>
<h2 id='as_data_frame'>Convert a taxa object to a <code>data.frame</code></h2><span id='topic+as_data_frame'></span>

<h3>Description</h3>

<p>Convert the information in a taxa object to a <code>data.frame</code> using base R
vectors as columns. Use <a href="dplyr.html#topic+as_tibble">as_tibble</a> to convert to tibbles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_data_frame(
  x,
  row.names = NULL,
  optional = FALSE,
  ...,
  stringsAsFactors = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_data_frame_+3A_x">x</code></td>
<td>
<p>An object defined by taxa, such as <a href="#topic+taxon">taxon</a> or <a href="#topic+taxon_id">taxon_id</a></p>
</td></tr>
<tr><td><code id="as_data_frame_+3A_row.names">row.names</code></td>
<td>
<p><code>NULL</code> or a character vector giving the row
names for the data frame.  Missing values are not allowed.</p>
</td></tr>
<tr><td><code id="as_data_frame_+3A_optional">optional</code></td>
<td>
<p>logical. If <code>TRUE</code>, setting row names and
converting column names (to syntactic names: see
<code><a href="base.html#topic+make.names">make.names</a></code>) is optional.  Note that all of <span class="rlang"><b>R</b></span>'s
<span class="pkg">base</span> package <code>as.data.frame()</code> methods use
<code>optional</code> only for column names treatment, basically with the
meaning of <code><a href="base.html#topic+data.frame">data.frame</a>(*, check.names = !optional)</code>.
See also the <code>make.names</code> argument of the <code>matrix</code> method.</p>
</td></tr>
<tr><td><code id="as_data_frame_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="as_data_frame_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>logical: should the character vector be converted
to a factor?</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon(name = c('Homo sapiens', 'Bacillus', 'Ascomycota', 'Ericaceae'),
           rank = c('species', 'genus', 'phylum', 'family'),
           id = taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi'),
           auth = c('Linnaeus, 1758', 'Cohn 1872', NA, 'Juss., 1789'))
as_data_frame(x)

</code></pre>

<hr>
<h2 id='as_taxon'>Convert to a <a href="#topic+taxon">taxon</a> vector</h2><span id='topic+as_taxon'></span>

<h3>Description</h3>

<p>Convert other objects to <a href="#topic+taxon">taxon</a> vectors. Compatible base R vectors can also
be converted using the <a href="#topic+taxon">taxon constructor</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_taxon(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_taxon_+3A_x">x</code></td>
<td>
<p>An object to be converted to a taxon vector</p>
</td></tr>
<tr><td><code id="as_taxon_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Convert a taxonomy object to a taxon vector
x &lt;- taxonomy(taxon(name = c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                             'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
                    rank = c('order', 'family', 'genus', 'species',
                             'species', 'family', 'genus', 'species'),
                    id = taxon_id(c('33554', '9681', '9688', '9689',
                                    '9694', '9632', '9639', '9644'),
                                  db = 'ncbi'),
                    auth = c('Bowdich, 1821', 'Fischer de Waldheim, 1817', 'Oken, 1816', 'L., 1758',
                             'L., 1758', 'Fischer de Waldheim, 1817', 'L., 1758', 'L., 1758')),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
names(x) &lt;- letters[1:8]
as_taxon(x)

# Convert base R vectors
as_taxon(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo'))
as_taxon(factor(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo')))

</code></pre>

<hr>
<h2 id='check_taxon_rank_order'>Check that order is ascending</h2><span id='topic+check_taxon_rank_order'></span>

<h3>Description</h3>

<p>Check that order is ascending and reorder the orders and their levels if needed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_taxon_rank_order(level, order, warn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_taxon_rank_order_+3A_level">level</code></td>
<td>
<p>Zero or more taxonomic rank names.</p>
</td></tr>
<tr><td><code id="check_taxon_rank_order_+3A_order">order</code></td>
<td>
<p>Integers that determine the relative order of taxonomic levels.</p>
</td></tr>
<tr><td><code id="check_taxon_rank_order_+3A_warn">warn</code></td>
<td>
<p>If <code>TRUE</code>, issue a warning when not in ascending order.</p>
</td></tr>
</table>

<hr>
<h2 id='classification'>Taxon class</h2><span id='topic+classification'></span>

<h3>Description</h3>

<a href='https://www.tidyverse.org/lifecycle/#experimental'><img src='figures/lifecycle-experimental.svg' alt='Experimental lifecycle'></a><p> Used to
store classifications in reference to a taxonomic tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classification(x = NULL, taxonomy = NULL, .names = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classification_+3A_x">x</code></td>
<td>
<p>One of:
</p>

<ul>
<li><p> A list where each item represents a series of nested taxa. The contents of
the list can be in any form that can be converted to a <a href="#topic+taxon">taxon</a> vector.
</p>
</li>
<li><p> The indexes/names of each instance of a taxon in a <a href="#topic+taxonomy">taxonomy</a> object specified by the <code>taxonomy</code> option. Can
be any length, but must consist of valid indexes for taxa in the <code>taxonomy</code>
object.
</p>
</li></ul>
</td></tr>
<tr><td><code id="classification_+3A_taxonomy">taxonomy</code></td>
<td>
<p>A <a href="#topic+taxonomy">taxonomy</a> object. Only needed if taxon indexes are supplied as the first argument.</p>
</td></tr>
<tr><td><code id="classification_+3A_.names">.names</code></td>
<td>
<p>The names of the vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_classification</code>
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic++5B.taxa_classification">[.taxa_classification</a>()</code>,
<code><a href="#topic+taxon">taxon</a>()</code>,
<code><a href="#topic+taxon_authority">taxon_authority</a>()</code>,
<code><a href="#topic+taxon_db">taxon_db</a>()</code>,
<code><a href="#topic+taxon_id">taxon_id</a>()</code>,
<code><a href="#topic+taxon_rank">taxon_rank</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create classification vector with a list
x &lt;- classification(list(
  c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo'),
  c('Carnivora', 'Felidae', 'Panthera', 'Panthera tigris'),
  c('Carnivora', 'Ursidae', 'Ursus', 'Ursus arctos'),
  c('Carnivora', 'Ursidae', 'Ursus', 'Ursus arctos'),
  c('Carnivora', 'Felidae', 'Panthera', 'Panthera tigris')
))


# Create classification vector with indexes and a taxonomy
x &lt;- classification(c(3, 4, 4, 5, 5, 6, 8, 8, 2, 5, 6, 2),
                    taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                               'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
                             supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7)))

x &lt;- classification(c(3, 4, 4, 5, 5, 6, 8, 8, 2, 5, 6, 2),
                    taxonomy(taxon(name = c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                                            'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
                                   rank = c('order', 'family', 'genus', 'species',
                                            'species', 'family', 'genus', 'species'),
                                   id = taxon_id(c('33554', '9681', '9688', '9689',
                                                   '9694', '9632', '9639', '9644'),
                                                 db = 'ncbi'),
                                   auth = c('Bowdich, 1821', 'Fischer, 1817',
                                            'Oken, 1816', 'L., 1758',
                                            'L., 1758', 'Fischer, 1817',
                                            'L., 1758', 'L., 1758')),
                             supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7)))
names(x) &lt;- letters[1:12]


# Get parts of the classification vector
tax_name(x)
tax_rank(x)
tax_id(x)
tax_db(x)
tax_auth(x)
tax_author(x)
tax_date(x)
tax_cite(x)

# Manipulate classification vectors
x[1:3]
x[tax_rank(x) &gt; 'family']
# c(x, x)
# x['b'] &lt;- NA
is.na(x)
# as.data.frame(x)
# tibble::as_tibble(x)

# Use as columns in tables
tibble::tibble(x = x, y = 1:12)
data.frame(x = x, y = 1:12)

</code></pre>

<hr>
<h2 id='contains'>dplyr select_helpers</h2><span id='topic+contains'></span>

<h3>Description</h3>

<p>dplyr select_helpers
</p>

<hr>
<h2 id='database_ref'>Database list</h2><span id='topic+database_ref'></span>

<h3>Description</h3>

<p>The list of known databases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>database_ref
</code></pre>


<h3>Format</h3>

<p>An object of class <code>taxa_taxon_db_def</code> (inherits from <code>vctrs_rcrd</code>, <code>vctrs_vctr</code>) of length 8.
</p>

<hr>
<h2 id='db_ref'>Valid taxonomy databases</h2><span id='topic+db_ref'></span>

<h3>Description</h3>

<p>This defines the valid taxonomic databases that can be used in <a href="#topic+taxon_db">taxon_db</a>
objects and objects that use <a href="#topic+taxon_db">taxon_db</a> objects, such as <a href="#topic+taxon_id">taxon_id</a> and
<a href="#topic+taxon">taxon</a>. <code>db_ref$get</code> can be used to see information for the databases. Users
can add their own custom databases to the list using <code>db_ref$set</code>. For each
database the following information is included:
</p>

<ul>
<li><p> The URL for the website associated with the database
</p>
</li>
<li><p> A short description
</p>
</li>
<li><p> The regular expression that defines valid taxon IDs
</p>
</li>
<li><p> The ranks used in the database if specified
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>db_ref
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 3.
</p>


<h3>Attribution</h3>

<p>This code is based on the code handling options in the knitr package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# List all database definitions
db_ref$get()

# Get a specific database definition
db_ref$get('ncbi')

# Add or overwrite a database definition
db_ref$set(
  name = "my_new_database",
  url = "http://www.my_tax_database.com",
  desc = "I just made this up",
  id_regex = ".*"
)

# Reset definitions to default values
db_ref$reset()

</code></pre>

<hr>
<h2 id='default_db_ref'>Defines valid taxonomic databases</h2><span id='topic+default_db_ref'></span>

<h3>Description</h3>

<p>Defines valid taxonomic databases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_db_ref(defaults = list())
</code></pre>


<h3>Attribution</h3>

<p>This code is copied from the code handling options in the knitr package.
</p>

<hr>
<h2 id='delete_unused_class_taxa'>Removes taxa from the taxonomy of a classification that are not used by any of the instances</h2><span id='topic+delete_unused_class_taxa'></span>

<h3>Description</h3>

<p>Removes taxa from the taxonomy of a classification that are not used by any of the instances
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delete_unused_class_taxa(x)
</code></pre>

<hr>
<h2 id='duplicated_index'>Returns the index of the first occurrence of each unique element</h2><span id='topic+duplicated_index'></span>

<h3>Description</h3>

<p>Returns the index of the first occurrence of each unique element
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duplicated_index(x, proxy_func = NULL)
</code></pre>

<hr>
<h2 id='duplicated_index_taxonomy'>Returns the index of the first occurrence of each unique taxon in a taxonomy</h2><span id='topic+duplicated_index_taxonomy'></span>

<h3>Description</h3>

<p>Returns the index of the first occurrence of each unique taxon in a taxonomy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duplicated_index_taxonomy(x, proxy_func = NULL)
</code></pre>

<hr>
<h2 id='ends_with'>dplyr select_helpers</h2><span id='topic+ends_with'></span>

<h3>Description</h3>

<p>dplyr select_helpers
</p>

<hr>
<h2 id='everything'>dplyr select_helpers</h2><span id='topic+everything'></span>

<h3>Description</h3>

<p>dplyr select_helpers
</p>

<hr>
<h2 id='font_default'>Default font</h2><span id='topic+font_default'></span>

<h3>Description</h3>

<p>A wrapper to make changing the formatting of text printed easier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>font_default(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="font_default_+3A_text">text</code></td>
<td>
<p>What to print.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other printer fonts: 
<code><a href="#topic+font_na">font_na</a>()</code>,
<code><a href="#topic+font_punct">font_punct</a>()</code>,
<code><a href="#topic+font_secondary">font_secondary</a>()</code>,
<code><a href="#topic+font_tax_name">font_tax_name</a>()</code>
</p>

<hr>
<h2 id='font_na'>Font for NAs in print methods</h2><span id='topic+font_na'></span>

<h3>Description</h3>

<p>A simple wrapper to make changing the formatting of text printed easier.
This is used for <code>NA</code>s
</p>


<h3>Usage</h3>

<pre><code class='language-R'>font_na(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="font_na_+3A_text">text</code></td>
<td>
<p>What to print</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other printer fonts: 
<code><a href="#topic+font_default">font_default</a>()</code>,
<code><a href="#topic+font_punct">font_punct</a>()</code>,
<code><a href="#topic+font_secondary">font_secondary</a>()</code>,
<code><a href="#topic+font_tax_name">font_tax_name</a>()</code>
</p>

<hr>
<h2 id='font_punct'>Punctuation formatting in print methods</h2><span id='topic+font_punct'></span>

<h3>Description</h3>

<p>A simple wrapper to make changing the formatting of text printed easier.
This is used for non-data, formatting characters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>font_punct(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="font_punct_+3A_text">text</code></td>
<td>
<p>What to print</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other printer fonts: 
<code><a href="#topic+font_default">font_default</a>()</code>,
<code><a href="#topic+font_na">font_na</a>()</code>,
<code><a href="#topic+font_secondary">font_secondary</a>()</code>,
<code><a href="#topic+font_tax_name">font_tax_name</a>()</code>
</p>

<hr>
<h2 id='font_secondary'>Font for secondary data</h2><span id='topic+font_secondary'></span>

<h3>Description</h3>

<p>A wrapper to make changing the formatting of text printed easier.
This is used for print data associated with other data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>font_secondary(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="font_secondary_+3A_text">text</code></td>
<td>
<p>What to print.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other printer fonts: 
<code><a href="#topic+font_default">font_default</a>()</code>,
<code><a href="#topic+font_na">font_na</a>()</code>,
<code><a href="#topic+font_punct">font_punct</a>()</code>,
<code><a href="#topic+font_tax_name">font_tax_name</a>()</code>
</p>

<hr>
<h2 id='font_tax_name'>Taxon name formatting in print methods</h2><span id='topic+font_tax_name'></span>

<h3>Description</h3>

<p>A simple wrapper to make changing the formatting of text printed easier.
This is used for taxon names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>font_tax_name(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="font_tax_name_+3A_text">text</code></td>
<td>
<p>What to print</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other printer fonts: 
<code><a href="#topic+font_default">font_default</a>()</code>,
<code><a href="#topic+font_na">font_na</a>()</code>,
<code><a href="#topic+font_punct">font_punct</a>()</code>,
<code><a href="#topic+font_secondary">font_secondary</a>()</code>
</p>

<hr>
<h2 id='format.taxa_classification'>taxa printing functions</h2><span id='topic+format.taxa_classification'></span><span id='topic+obj_print_data.taxa_classification'></span><span id='topic+obj_print_footer.taxa_classification'></span><span id='topic+vec_ptype_abbr.taxa_classification'></span><span id='topic+vec_ptype_full.taxa_classification'></span><span id='topic+pillar_shaft.taxa_classification'></span><span id='topic+taxa_printing_funcs'></span><span id='topic+format.taxa_taxon'></span><span id='topic+obj_print_data.taxa_taxon'></span><span id='topic+obj_print_footer.taxa_taxon'></span><span id='topic+vec_ptype_abbr.taxa_taxon'></span><span id='topic+vec_ptype_full.taxa_taxon'></span><span id='topic+pillar_shaft.taxa_taxon'></span><span id='topic+format.taxa_taxon_authority'></span><span id='topic+obj_print_data.taxa_taxon_authority'></span><span id='topic+vec_ptype_abbr.taxa_taxon_authority'></span><span id='topic+vec_ptype_full.taxa_taxon_authority'></span><span id='topic+pillar_shaft.taxa_taxon_authority'></span><span id='topic+format.taxa_taxon_db'></span><span id='topic+vec_ptype_abbr.taxa_taxon_db'></span><span id='topic+vec_ptype_full.taxa_taxon_db'></span><span id='topic+obj_print_data.taxa_taxon_db_def'></span><span id='topic+vec_ptype_full.taxa_taxon_db_def'></span><span id='topic+format.taxa_taxon_id'></span><span id='topic+obj_print_data.taxa_taxon_id'></span><span id='topic+vec_ptype_abbr.taxa_taxon_id'></span><span id='topic+vec_ptype_full.taxa_taxon_id'></span><span id='topic+pillar_shaft.taxa_taxon_id'></span><span id='topic+format.taxa_taxon_rank'></span><span id='topic+obj_print_data.taxa_taxon_rank'></span><span id='topic+obj_print_footer.taxa_taxon_rank'></span><span id='topic+vec_ptype_abbr.taxa_taxon_rank'></span><span id='topic+vec_ptype_full.taxa_taxon_rank'></span><span id='topic+pillar_shaft.taxa_taxon_rank'></span><span id='topic+format.taxa_taxon_rank_level'></span><span id='topic+obj_print_data.taxa_taxon_rank_level'></span><span id='topic+vec_ptype_abbr.taxa_taxon_rank_level'></span><span id='topic+vec_ptype_full.taxa_taxon_rank_level'></span><span id='topic+toString.taxa_taxon_rank_level'></span><span id='topic+format.taxa_taxonomy'></span><span id='topic+obj_print_data.taxa_taxonomy'></span><span id='topic+obj_print_footer.taxa_taxonomy'></span><span id='topic+vec_ptype_abbr.taxa_taxonomy'></span><span id='topic+vec_ptype_full.taxa_taxonomy'></span><span id='topic+pillar_shaft.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Functions used internally for printing information in taxon objects. They have to be exported to
work, but they are not intended to be directly used by most users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
format(x, ...)

## S3 method for class 'taxa_classification'
obj_print_data(x, ...)

## S3 method for class 'taxa_classification'
obj_print_footer(x, ...)

## S3 method for class 'taxa_classification'
vec_ptype_abbr(x, ...)

## S3 method for class 'taxa_classification'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_classification'
pillar_shaft(x, ...)

## S3 method for class 'taxa_taxon'
format(x, ...)

## S3 method for class 'taxa_taxon'
obj_print_data(x, ...)

## S3 method for class 'taxa_taxon'
obj_print_footer(x, ...)

## S3 method for class 'taxa_taxon'
vec_ptype_abbr(x, ...)

## S3 method for class 'taxa_taxon'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_taxon'
pillar_shaft(x, ...)

## S3 method for class 'taxa_taxon_authority'
format(x, ...)

## S3 method for class 'taxa_taxon_authority'
obj_print_data(x, ...)

## S3 method for class 'taxa_taxon_authority'
vec_ptype_abbr(x, ...)

## S3 method for class 'taxa_taxon_authority'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_taxon_authority'
pillar_shaft(x, ...)

## S3 method for class 'taxa_taxon_db'
format(x, ...)

## S3 method for class 'taxa_taxon_db'
vec_ptype_abbr(x, ...)

## S3 method for class 'taxa_taxon_db'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_taxon_db_def'
obj_print_data(x, ...)

## S3 method for class 'taxa_taxon_db_def'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_taxon_id'
format(x, ...)

## S3 method for class 'taxa_taxon_id'
obj_print_data(x, ...)

## S3 method for class 'taxa_taxon_id'
vec_ptype_abbr(x, ...)

## S3 method for class 'taxa_taxon_id'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_taxon_id'
pillar_shaft(x, ...)

## S3 method for class 'taxa_taxon_rank'
format(x, ...)

## S3 method for class 'taxa_taxon_rank'
obj_print_data(x, ...)

## S3 method for class 'taxa_taxon_rank'
obj_print_footer(x, ...)

## S3 method for class 'taxa_taxon_rank'
vec_ptype_abbr(x, ...)

## S3 method for class 'taxa_taxon_rank'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_taxon_rank'
pillar_shaft(x, ...)

## S3 method for class 'taxa_taxon_rank_level'
format(x, ...)

## S3 method for class 'taxa_taxon_rank_level'
obj_print_data(x, ...)

## S3 method for class 'taxa_taxon_rank_level'
vec_ptype_abbr(x, ...)

## S3 method for class 'taxa_taxon_rank_level'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_taxon_rank_level'
toString(x, ...)

## S3 method for class 'taxa_taxonomy'
format(x, ...)

## S3 method for class 'taxa_taxonomy'
obj_print_data(x, ...)

## S3 method for class 'taxa_taxonomy'
obj_print_footer(x, ...)

## S3 method for class 'taxa_taxonomy'
vec_ptype_abbr(x, ...)

## S3 method for class 'taxa_taxonomy'
vec_ptype_full(x, ...)

## S3 method for class 'taxa_taxonomy'
pillar_shaft(x, ...)
</code></pre>

<hr>
<h2 id='impute_order_na'>Fill in NA values in sequence</h2><span id='topic+impute_order_na'></span>

<h3>Description</h3>

<p>Fill in the NA values in a ascending sequence based on nearby non-NA values.
Used to guess the order values for unknown ranks based on the values of known ranks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_order_na(order, inc = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impute_order_na_+3A_order">order</code></td>
<td>
<p>An ascending sequences, possibly with NAs</p>
</td></tr>
<tr><td><code id="impute_order_na_+3A_inc">inc</code></td>
<td>
<p>The increment size to use for values in NA blocks at the start and end of the sequence.</p>
</td></tr>
</table>

<hr>
<h2 id='interleave'>Interleaves two vectors</h2><span id='topic+interleave'></span>

<h3>Description</h3>

<p>Taken from &quot;http://r.789695.n4.nabble.com/Interleaving-elements-of-two-vectors-td795123.html&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interleave(v1, v2)
</code></pre>

<hr>
<h2 id='internodes'>Get internodes</h2><span id='topic+internodes'></span>

<h3>Description</h3>

<p>Get internodes indexes for each taxon or another per-taxon value. An
internode is a taxon with exactly one supertaxon and one subtaxon. These taxa
can be removed without losing information on the relationships of the
remaining taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>internodes(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="internodes_+3A_x">x</code></td>
<td>
<p>The object to get internodes for, such as a <a href="#topic+taxonomy">taxonomy</a> object.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other taxonomy functions: 
<code><a href="#topic+leaves">leaves</a>()</code>,
<code><a href="#topic+roots">roots</a>()</code>,
<code><a href="#topic+stems">stems</a>()</code>,
<code><a href="#topic+subtaxa">subtaxa</a>()</code>,
<code><a href="#topic+supertaxa">supertaxa</a>()</code>
</p>
<p>Other internode functions: 
<code><a href="#topic+is_internode">is_internode</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
internodes(x)

</code></pre>

<hr>
<h2 id='is_classification'>Check if is a classification</h2><span id='topic+is_classification'></span>

<h3>Description</h3>

<p>Check if an object is the classification class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_classification(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_classification_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>

<hr>
<h2 id='is_internode'>Check if taxa are internodes</h2><span id='topic+is_internode'></span>

<h3>Description</h3>

<p>Check if each taxon is an internode. An internode is a taxon with exactly one
supertaxon and one subtaxon. These taxa can be removed without losing
information on the relationships of the remaining taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_internode(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_internode_+3A_x">x</code></td>
<td>
<p>The object to get internodes for, such as a <a href="#topic+taxonomy">taxonomy</a> object.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other internode functions: 
<code><a href="#topic+internodes">internodes</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
is_internode(x)

</code></pre>

<hr>
<h2 id='is_leaf'>Check if taxa are leaves</h2><span id='topic+is_leaf'></span>

<h3>Description</h3>

<p>Check if each taxon is a leaf. A leaf is a taxon with no subtaxa.
subtaxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_leaf(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_leaf_+3A_x">x</code></td>
<td>
<p>The object to get leaves for, such as a <a href="#topic+taxonomy">taxonomy</a> object</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other leaf functions: 
<code><a href="#topic+leaves">leaves</a>()</code>,
<code><a href="#topic+n_leaves">n_leaves</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
is_leaf(x)

</code></pre>

<hr>
<h2 id='is_root'>Test if taxa are roots</h2><span id='topic+is_root'></span>

<h3>Description</h3>

<p>Check if each taxon is a root. A root is a taxon with no supertaxon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_root(x, subset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_root_+3A_x">x</code></td>
<td>
<p>An object containing taxonomic relationships, such as <a href="#topic+taxonomy">taxonomy</a> objects.</p>
</td></tr>
<tr><td><code id="is_root_+3A_subset">subset</code></td>
<td>
<p>The subset of the tree to search for roots to that subset. Can be indexes or names.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other root functions: 
<code><a href="#topic+roots">roots</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
is_root(x)
is_root(x, subset = 2:8)

</code></pre>

<hr>
<h2 id='is_stem'>Check if taxa are stems</h2><span id='topic+is_stem'></span>

<h3>Description</h3>

<p>Check if each taxon is a stem. A stem is any taxa from a root to the first taxon with multiple subtaxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_stem(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_stem_+3A_x">x</code></td>
<td>
<p>An object with taxonomic relationships, like <a href="#topic+taxonomy">taxonomy</a> objects.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other stem functions: 
<code><a href="#topic+stems">stems</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris'),
              supertaxa = c(NA, 1, 2, 3, 3))
is_stem(x)

</code></pre>

<hr>
<h2 id='is_taxon'>Check if something is a <a href="#topic+taxon">taxon</a> object</h2><span id='topic+is_taxon'></span>

<h3>Description</h3>

<p>Check if an object is of the <a href="#topic+taxon">taxon</a> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_taxon(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_taxon_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon(c('A', 'B', 'C'))
is_taxon(x)
is_taxon(1:2)

</code></pre>

<hr>
<h2 id='is_taxon_authority'>Check if is a <a href="#topic+taxon_authority">taxon_authority</a></h2><span id='topic+is_taxon_authority'></span>

<h3>Description</h3>

<p>Check if an object is of the <a href="#topic+taxon_authority">taxon_authority</a> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_taxon_authority(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_taxon_authority_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon_authority(c('Cham. &amp; Schldl.', 'L.'),
                     date = c('1827', '1753'))
is_taxon_authority(x)
is_taxon_authority(1:3)

</code></pre>

<hr>
<h2 id='is_taxon_db'>Check if something is a <a href="#topic+taxon_db">taxon_db</a></h2><span id='topic+is_taxon_db'></span>

<h3>Description</h3>

<p>Check if an object is of the <a href="#topic+taxon_db">taxon_db</a> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_taxon_db(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_taxon_db_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon_db(c('ncbi', 'ncbi', 'itis'))
is_taxon_db(x)
is_taxon_db(1:3)

</code></pre>

<hr>
<h2 id='is_taxon_id'>Check if something is a <a href="#topic+taxon_id">taxon_id</a> object</h2><span id='topic+is_taxon_id'></span>

<h3>Description</h3>

<p>Check if an object is of the <a href="#topic+taxon_id">taxon_id</a> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_taxon_id(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_taxon_id_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi')
is_taxon_id(x)
is_taxon_id(1:3)

</code></pre>

<hr>
<h2 id='is_taxon_rank'>Check if something is a <a href="#topic+taxon_rank">taxon_rank</a></h2><span id='topic+is_taxon_rank'></span>

<h3>Description</h3>

<p>Check if an object is of the <a href="#topic+taxon_rank">taxon_rank</a> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_taxon_rank(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_taxon_rank_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon_rank(c('species', 'species', 'phylum', 'family'))
is_taxon_rank(x)
is_taxon_rank(1:3)

</code></pre>

<hr>
<h2 id='is_taxon_rank_level'>Check if is a taxon id</h2><span id='topic+is_taxon_rank_level'></span>

<h3>Description</h3>

<p>Check if an object is the taxon id class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_taxon_rank_level(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_taxon_rank_level_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>

<hr>
<h2 id='is_taxonomy'>Check if something is a <a href="#topic+taxonomy">taxonomy</a></h2><span id='topic+is_taxonomy'></span>

<h3>Description</h3>

<p>Check if an object is of the <a href="#topic+taxonomy">taxonomy</a> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_taxonomy(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_taxonomy_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
is_taxonomy(x)
is_taxonomy(1:2)

</code></pre>

<hr>
<h2 id='is_valid_regex'>Check regex validity</h2><span id='topic+is_valid_regex'></span>

<h3>Description</h3>

<p>Check if a regular expression is valid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_valid_regex(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_valid_regex_+3A_text">text</code></td>
<td>
<p>The putative regex to check.</p>
</td></tr>
</table>

<hr>
<h2 id='leaves'>Get leaves</h2><span id='topic+leaves'></span>

<h3>Description</h3>

<p>Get leaves indexes for each taxon or another per-taxon value. Leaves are taxa with no subtaxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leaves(x, value = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leaves_+3A_x">x</code></td>
<td>
<p>The object to get leaves for, such as a <a href="#topic+taxonomy">taxonomy</a> object</p>
</td></tr>
<tr><td><code id="leaves_+3A_value">value</code></td>
<td>
<p>Something to return instead of indexes. Must be the same length as the number of taxa.</p>
</td></tr>
<tr><td><code id="leaves_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other taxonomy functions: 
<code><a href="#topic+internodes">internodes</a>()</code>,
<code><a href="#topic+roots">roots</a>()</code>,
<code><a href="#topic+stems">stems</a>()</code>,
<code><a href="#topic+subtaxa">subtaxa</a>()</code>,
<code><a href="#topic+supertaxa">supertaxa</a>()</code>
</p>
<p>Other leaf functions: 
<code><a href="#topic+is_leaf">is_leaf</a>()</code>,
<code><a href="#topic+n_leaves">n_leaves</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
leaves(x)
leaves(x, value = tax_name(x))

</code></pre>

<hr>
<h2 id='limited_print'>Print a subset of a character vector</h2><span id='topic+limited_print'></span>

<h3>Description</h3>

<p>Prints the start and end values for a character vector. The number of values
printed depend on the width of the screen by default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>limited_print(
  chars,
  prefix = "",
  sep = ", ",
  mid = " ... ",
  trunc_char = "[truncated]",
  max_chars = getOption("width") - nchar(prefix) - 5,
  type = "message"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="limited_print_+3A_chars">chars</code></td>
<td>
<p>(<code>character</code>) What to print.</p>
</td></tr>
<tr><td><code id="limited_print_+3A_prefix">prefix</code></td>
<td>
<p>(<code>character</code> of length 1) What to print before
<code>chars</code>, on the same line.</p>
</td></tr>
<tr><td><code id="limited_print_+3A_sep">sep</code></td>
<td>
<p>What to put between consecutive values</p>
</td></tr>
<tr><td><code id="limited_print_+3A_mid">mid</code></td>
<td>
<p>What is used to indicate omitted values</p>
</td></tr>
<tr><td><code id="limited_print_+3A_trunc_char">trunc_char</code></td>
<td>
<p>What is appended onto truncated values</p>
</td></tr>
<tr><td><code id="limited_print_+3A_max_chars">max_chars</code></td>
<td>
<p>(<code>numeric</code> of length 1) The maximum number of
characters to print.</p>
</td></tr>
<tr><td><code id="limited_print_+3A_type">type</code></td>
<td>
<p>(<code>"error"</code>, <code>"warning"</code>, <code>"message"</code>, <code>"cat"</code>, <code>"print"</code>, <code>"silent"</code>, <code>"plain"</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>taxa:::limited_print(1:100)
taxa:::limited_print(1:10000)
taxa:::limited_print(1:10000, prefix = "stuff:")

</code></pre>

<hr>
<h2 id='matches'>dplyr select_helpers</h2><span id='topic+matches'></span>

<h3>Description</h3>

<p>dplyr select_helpers
</p>

<hr>
<h2 id='n_leaves'>Number of leaves per taxon</h2><span id='topic+n_leaves'></span>

<h3>Description</h3>

<p>Get the number of leaves per taxon. A leaf is a taxon with no subtaxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_leaves(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n_leaves_+3A_x">x</code></td>
<td>
<p>The object to get leaves for, such as a <a href="#topic+taxonomy">taxonomy</a> object</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other leaf functions: 
<code><a href="#topic+is_leaf">is_leaf</a>()</code>,
<code><a href="#topic+leaves">leaves</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
n_leaves(x)

</code></pre>

<hr>
<h2 id='n_subtaxa'>Number of subtaxa per taxon</h2><span id='topic+n_subtaxa'></span>

<h3>Description</h3>

<p>Get the number of subtaxa per taxon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_subtaxa(x, subset = NULL, max_depth = NULL, include = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n_subtaxa_+3A_x">x</code></td>
<td>
<p>The object to get subtaxa for, such as a <a href="#topic+taxonomy">taxonomy</a> object.</p>
</td></tr>
<tr><td><code id="n_subtaxa_+3A_subset">subset</code></td>
<td>
<p>The subset of the tree to search. Can be indexes or names.</p>
</td></tr>
<tr><td><code id="n_subtaxa_+3A_max_depth">max_depth</code></td>
<td>
<p>The number of ranks to traverse. For example, <code>max_depth = 1</code> returns only immediate subtaxa. By default (NULL) information for all
subtaxa is returned (i.e. subtaxa of subtaxa, etc).</p>
</td></tr>
<tr><td><code id="n_subtaxa_+3A_include">include</code></td>
<td>
<p>If <code>TRUE</code>, include information for each taxon in the output.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other subtaxa functions: 
<code><a href="#topic+subtaxa">subtaxa</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example data
x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))

# Find number of subtaxa (including subtaxa of subtaxa, etc)
n_subtaxa(x)

# Find the number of subtaxa one rank below each taxon
n_subtaxa(x, max_depth = 1)

# Only return data for some taxa (faster than subsetting the whole result)
n_subtaxa(x, subset = 1:3)

</code></pre>

<hr>
<h2 id='n_supertaxa'>Number of supertaxa per taxon</h2><span id='topic+n_supertaxa'></span>

<h3>Description</h3>

<p>Get the number of supertaxa each taxon is contained in.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_supertaxa(x, subset = NULL, max_depth = NULL, include = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n_supertaxa_+3A_x">x</code></td>
<td>
<p>The object to get supertaxa for, such as a <a href="#topic+taxonomy">taxonomy</a> object.</p>
</td></tr>
<tr><td><code id="n_supertaxa_+3A_subset">subset</code></td>
<td>
<p>The subset of the tree to search for roots to that subset. Can
be indexes or names.</p>
</td></tr>
<tr><td><code id="n_supertaxa_+3A_max_depth">max_depth</code></td>
<td>
<p>The number of levels to traverse. For example, <code>max_depth = 1</code> returns only immediate supertaxa. By default (NULL) information for all
supertaxa is returned.</p>
</td></tr>
<tr><td><code id="n_supertaxa_+3A_include">include</code></td>
<td>
<p>If <code>TRUE</code>, include information for each taxon in the output.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other supertaxa functions: 
<code><a href="#topic+supertaxa">supertaxa</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example data
x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))

# Find number of supertaxa each taxon is contained in
n_supertaxa(x)

# Only return data for some taxa (faster than subsetting the whole result)
n_supertaxa(x, subset = 1:3)

</code></pre>

<hr>
<h2 id='new_classification'>Minimal classfication constructor</h2><span id='topic+new_classification'></span>

<h3>Description</h3>

<p>Minimal classfication constructor for internal use. Only use when the input is known to be valid
since few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_classification(taxonomy = taxonomy(), instances = integer())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_classification_+3A_taxonomy">taxonomy</code></td>
<td>
<p>A <code><a href="#topic+taxonomy">taxonomy()</a></code> object.</p>
</td></tr>
<tr><td><code id="new_classification_+3A_instances">instances</code></td>
<td>
<p>The indexes of each instance of a taxon in the taxonomy. Can be any length.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_classification</code>
</p>

<hr>
<h2 id='new_taxon'>Minimal taxon constructor</h2><span id='topic+new_taxon'></span>

<h3>Description</h3>

<p>Minimal taxon constructor for internal use. Only use when the input is known to be valid since
few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_taxon(
  .names = NULL,
  name = character(),
  rank = taxon_rank(),
  id = taxon_id(),
  auth = taxon_authority(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_taxon_+3A_.names">.names</code></td>
<td>
<p>The names of the vector.</p>
</td></tr>
<tr><td><code id="new_taxon_+3A_name">name</code></td>
<td>
<p>The names of taxa as a <a href="base.html#topic+character">character</a> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_+3A_rank">rank</code></td>
<td>
<p>The ranks of taxa as a <a href="#topic+taxon_rank">taxon_rank</a> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_+3A_id">id</code></td>
<td>
<p>The ids of taxa as a <a href="#topic+taxon_id">taxon_id</a> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_+3A_auth">auth</code></td>
<td>
<p>The authority of the taxon as a <a href="#topic+taxon_authority">taxon_authority</a> vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon</code>
</p>

<hr>
<h2 id='new_taxon_authority'>Minimal taxon_authority constructor</h2><span id='topic+new_taxon_authority'></span>

<h3>Description</h3>

<p>Minimal taxon_authority constructor for internal use. Only use when the input is known to be valid since
few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_taxon_authority(
  .names = NULL,
  author = character(),
  date = character(),
  citation = character()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_taxon_authority_+3A_.names">.names</code></td>
<td>
<p>The names of the vector.</p>
</td></tr>
<tr><td><code id="new_taxon_authority_+3A_author">author</code></td>
<td>
<p>Zero or more author names.</p>
</td></tr>
<tr><td><code id="new_taxon_authority_+3A_date">date</code></td>
<td>
<p>Zero or more dates.</p>
</td></tr>
<tr><td><code id="new_taxon_authority_+3A_citation">citation</code></td>
<td>
<p>Zero or more literature citations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_authority</code>
</p>

<hr>
<h2 id='new_taxon_db'>Minimal taxon_db constructor</h2><span id='topic+new_taxon_db'></span>

<h3>Description</h3>

<p>Minimal taxon_db constructor for internal use. Only use when the input is known to be valid since
few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_taxon_db(db = character(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_taxon_db_+3A_db">db</code></td>
<td>
<p>Zero or more taxonomic database names. Should be a name contained in
<code>names(db_ref)</code>. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_db_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_db</code>
</p>

<hr>
<h2 id='new_taxon_db_def'>Minimal taxon_db_def constructor</h2><span id='topic+new_taxon_db_def'></span>

<h3>Description</h3>

<p>Minimal taxon_db_def constructor for internal use. Only use when the input is known to be valid since
few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_taxon_db_def(
  name = character(),
  url = character(),
  desc = character(),
  id_regex = character(),
  rank_levels = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_taxon_db_def_+3A_name">name</code></td>
<td>
<p>Name of the database in lower case. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_db_def_+3A_url">url</code></td>
<td>
<p>URL of the database website. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_db_def_+3A_desc">desc</code></td>
<td>
<p>Description of the database. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_db_def_+3A_id_regex">id_regex</code></td>
<td>
<p>A regular expression for taxon IDs of the database. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_db_def_+3A_rank_levels">rank_levels</code></td>
<td>
<p>Valid taxonomic ranks for the database. Should be a list of <code>numeric</code> vectors named by taxonomic ranks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_db_def</code>
</p>

<hr>
<h2 id='new_taxon_id'>Minimal taxon_id constructor</h2><span id='topic+new_taxon_id'></span>

<h3>Description</h3>

<p>Minimal taxon_id constructor for internal use. Only use when the input is known to be valid since
few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_taxon_id(.names = NULL, id = character(), db = taxon_db())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_taxon_id_+3A_.names">.names</code></td>
<td>
<p>The names to apply to the vector</p>
</td></tr>
<tr><td><code id="new_taxon_id_+3A_id">id</code></td>
<td>
<p>Zero or more taxonomic ids. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_id_+3A_db">db</code></td>
<td>
<p>The name(s) of the database(s) associated with the IDs. If not <code>NA</code> (the
default), the input must consist of names of databases in <a href="#topic+database_ref">database_ref</a>. The length must be
0, 1, or equal to the number of IDs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_id</code>
</p>

<hr>
<h2 id='new_taxon_rank'>Minimal taxon_rank constructor</h2><span id='topic+new_taxon_rank'></span>

<h3>Description</h3>

<p>Minimal taxon_rank constructor for internal use. Only use when the input is
known to be valid since few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_taxon_rank(rank = character(), levels = taxon_rank_level())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_taxon_rank_+3A_rank">rank</code></td>
<td>
<p>Zero or more taxonomic rank names. Inputs will be transformed to
a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_rank_+3A_levels">levels</code></td>
<td>
<p>A named numeric vector indicating the names and orders of
possible taxonomic ranks. Higher numbers indicate for fine-scale groupings.
Ranks of unknown order can be indicated with <code>NA</code> instead of a number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_rank</code>
</p>

<hr>
<h2 id='new_taxon_rank_level'>Minimal taxon_rank_level constructor</h2><span id='topic+new_taxon_rank_level'></span>

<h3>Description</h3>

<p>Minimal taxon_rank_level constructor for internal use. Only use when the
input is known to be valid since few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_taxon_rank_level(level = character(), order = numeric())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_taxon_rank_level_+3A_level">level</code></td>
<td>
<p>Zero or more taxonomic rank names. If a named numeric is
applied, the names are used for levels and the numeric values are used
for the order. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="new_taxon_rank_level_+3A_order">order</code></td>
<td>
<p>Integers that determine the relative order of taxonomic levels.
Inputs will be transformed to a <code>integer</code> vector. <code>NA</code>s can be used to
indicate that the order is not known.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_rank_level</code>
</p>

<hr>
<h2 id='new_taxonomy'>Minimal taxonomy constructor</h2><span id='topic+new_taxonomy'></span>

<h3>Description</h3>

<p>Minimal taxonomy constructor for internal use. Only use when the input is known to be valid since
few validity checks are done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_taxonomy(taxa = taxon(), supertaxa = integer())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_taxonomy_+3A_taxa">taxa</code></td>
<td>
<p>A <a href="#topic+taxon">taxon</a> vector.</p>
</td></tr>
<tr><td><code id="new_taxonomy_+3A_supertaxa">supertaxa</code></td>
<td>
<p>The indexes of <code>taxa</code> for each taxon's supertaxon.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon</code>
</p>

<hr>
<h2 id='num_range'>dplyr select_helpers</h2><span id='topic+num_range'></span>

<h3>Description</h3>

<p>dplyr select_helpers
</p>

<hr>
<h2 id='one_of'>dplyr select_helpers</h2><span id='topic+one_of'></span>

<h3>Description</h3>

<p>dplyr select_helpers
</p>

<hr>
<h2 id='print_with_color'>Print that works with color</h2><span id='topic+print_with_color'></span>

<h3>Description</h3>

<p>The same as the <code>print</code> function, but can print colored text. Its a bit of a hack, but the only
way I found to replicate the behavior of <code>print</code> without rewriting the entire <code>print</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_with_color(x, original_length = length(x), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_with_color_+3A_x">x</code></td>
<td>
<p>What to print, typically a character vector</p>
</td></tr>
<tr><td><code id="print_with_color_+3A_original_length">original_length</code></td>
<td>
<p>The length of the full vector if only part was given.</p>
</td></tr>
<tr><td><code id="print_with_color_+3A_...">...</code></td>
<td>
<p>Passed to <code>print</code></p>
</td></tr>
</table>

<hr>
<h2 id='printed_classification'>Prepare classification for printing</h2><span id='topic+printed_classification'></span>

<h3>Description</h3>

<p>Prepare classification for printing. Makes color optional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printed_classification(x, color = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printed_classification_+3A_color">color</code></td>
<td>
<p>Use color?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='printed_taxon'>Prepare taxon for printing</h2><span id='topic+printed_taxon'></span>

<h3>Description</h3>

<p>Prepare taxon for printing. Makes color optional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printed_taxon(x, color = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printed_taxon_+3A_color">color</code></td>
<td>
<p>Use color?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='printed_taxon_authority'>Prepare taxon_authority for printing</h2><span id='topic+printed_taxon_authority'></span>

<h3>Description</h3>

<p>Prepare taxon_authority for printing. Makes color optional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printed_taxon_authority(x, color = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printed_taxon_authority_+3A_color">color</code></td>
<td>
<p>Use color?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='printed_taxon_id'>Prepare taxon_id for printing</h2><span id='topic+printed_taxon_id'></span>

<h3>Description</h3>

<p>Prepare taxon_id for printing. Makes color optional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printed_taxon_id(x, color = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printed_taxon_id_+3A_color">color</code></td>
<td>
<p>Use color?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='printed_taxon_rank'>Prepare taxon_rank for printing</h2><span id='topic+printed_taxon_rank'></span>

<h3>Description</h3>

<p>Prepare taxon_rank for printing. Makes color optional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printed_taxon_rank(x, color = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printed_taxon_rank_+3A_color">color</code></td>
<td>
<p>Use color?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='printed_taxon_rank_level'>Prepare taxon_rank_level for printing</h2><span id='topic+printed_taxon_rank_level'></span>

<h3>Description</h3>

<p>Prepare taxon_rank_level for printing. Makes color optional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printed_taxon_rank_level(x, color = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printed_taxon_rank_level_+3A_color">color</code></td>
<td>
<p>Use color?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='printed_taxonomy'>Prepare taxonomy for printing</h2><span id='topic+printed_taxonomy'></span>

<h3>Description</h3>

<p>Prepare taxonomy for printing. Makes color optional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printed_taxonomy(x, color = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printed_taxonomy_+3A_color">color</code></td>
<td>
<p>Use color?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='rank_level_color_funcs'>Get font color for levels</h2><span id='topic+rank_level_color_funcs'></span>

<h3>Description</h3>

<p>Make list of crayon style functions to print taxon rank levels in color.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank_level_color_funcs(levels)
</code></pre>

<hr>
<h2 id='rank_ref'>All known taxonomic ranks</h2><span id='topic+rank_ref'></span>

<h3>Description</h3>

<p>A list of taxonomic ranks from all databases used combined into a single
vector to make it easier to maintain the relative order of ranks when data
from multiple databases are combined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank_ref
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 52.
</p>


<h3>Attribution</h3>

<p>This list was adapted from a similar one in the <code>taxize</code> package.
</p>

<hr>
<h2 id='roots'>Get root taxa</h2><span id='topic+roots'></span>

<h3>Description</h3>

<p>Get the indexes of root taxa in a taxonomy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roots(x, subset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roots_+3A_x">x</code></td>
<td>
<p>An object containing taxonomic relationships, such as <a href="#topic+taxonomy">taxonomy</a> objects.</p>
</td></tr>
<tr><td><code id="roots_+3A_subset">subset</code></td>
<td>
<p>The subset of the tree to search for roots to that subset. Can be indexes or names.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other taxonomy functions: 
<code><a href="#topic+internodes">internodes</a>()</code>,
<code><a href="#topic+leaves">leaves</a>()</code>,
<code><a href="#topic+stems">stems</a>()</code>,
<code><a href="#topic+subtaxa">subtaxa</a>()</code>,
<code><a href="#topic+supertaxa">supertaxa</a>()</code>
</p>
<p>Other root functions: 
<code><a href="#topic+is_root">is_root</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))
roots(x)
roots(x, subset = 2:8)

</code></pre>

<hr>
<h2 id='starts_with'>dplyr select_helpers</h2><span id='topic+starts_with'></span>

<h3>Description</h3>

<p>dplyr select_helpers
</p>

<hr>
<h2 id='stems'>Get stems</h2><span id='topic+stems'></span>

<h3>Description</h3>

<p>Get stem indexes for each taxon or another per-taxon value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stems(x, value = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stems_+3A_x">x</code></td>
<td>
<p>An object with taxonomic relationships, like <a href="#topic+taxonomy">taxonomy</a> objects.</p>
</td></tr>
<tr><td><code id="stems_+3A_value">value</code></td>
<td>
<p>Something to return instead of indexes. Must be the same length as the number of taxa.</p>
</td></tr>
<tr><td><code id="stems_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other taxonomy functions: 
<code><a href="#topic+internodes">internodes</a>()</code>,
<code><a href="#topic+leaves">leaves</a>()</code>,
<code><a href="#topic+roots">roots</a>()</code>,
<code><a href="#topic+subtaxa">subtaxa</a>()</code>,
<code><a href="#topic+supertaxa">supertaxa</a>()</code>
</p>
<p>Other stem functions: 
<code><a href="#topic+is_stem">is_stem</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris'),
              supertaxa = c(NA, 1, 2, 3, 3))
x &lt;- c(x, x)
stems(x)
stems(x, value = tax_name(x))

</code></pre>

<hr>
<h2 id='subtaxa'>Get subtaxa</h2><span id='topic+subtaxa'></span>

<h3>Description</h3>

<p>Get subtaxa indexes for each taxon or another per-taxon value. Subtaxa are
taxa contained within a taxon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subtaxa(x, subset = NULL, max_depth = NULL, include = FALSE, value = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subtaxa_+3A_x">x</code></td>
<td>
<p>The object to get subtaxa for, such as a <a href="#topic+taxonomy">taxonomy</a> object.</p>
</td></tr>
<tr><td><code id="subtaxa_+3A_subset">subset</code></td>
<td>
<p>The subset of the tree to search. Can be indexes or names.</p>
</td></tr>
<tr><td><code id="subtaxa_+3A_max_depth">max_depth</code></td>
<td>
<p>The number of ranks to traverse. For example, <code>max_depth = 1</code> returns only immediate subtaxa. By default (NULL) information for all
subtaxa is returned (i.e. subtaxa of subtaxa, etc).</p>
</td></tr>
<tr><td><code id="subtaxa_+3A_include">include</code></td>
<td>
<p>If <code>TRUE</code>, include information for each taxon in the output.</p>
</td></tr>
<tr><td><code id="subtaxa_+3A_value">value</code></td>
<td>
<p>Something to return instead of indexes. Must be the same length
as the number of taxa.</p>
</td></tr>
<tr><td><code id="subtaxa_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other taxonomy functions: 
<code><a href="#topic+internodes">internodes</a>()</code>,
<code><a href="#topic+leaves">leaves</a>()</code>,
<code><a href="#topic+roots">roots</a>()</code>,
<code><a href="#topic+stems">stems</a>()</code>,
<code><a href="#topic+supertaxa">supertaxa</a>()</code>
</p>
<p>Other subtaxa functions: 
<code><a href="#topic+n_subtaxa">n_subtaxa</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example data
x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))

# The indexes of all subtaxa (with subtaxa of subtaxa, etc) for each taxon
subtaxa(x)

# The indexes of immediate subtaxa (without subtaxa of subtaxa, etc) for each taxon
subtaxa(x, max_depth = 1)

# Return something other than index
subtaxa(x, value = tax_name(x))

# Include each taxon with its subtaxa
subtaxa(x, value = tax_name(x), include = TRUE)

# Only return data for some taxa (faster than subsetting the whole result)
subtaxa(x, subset = 3)

</code></pre>

<hr>
<h2 id='supertaxa'>Get supertaxa</h2><span id='topic+supertaxa'></span>

<h3>Description</h3>

<p>Get supertaxa indexes for each taxon or another per-taxon value. Supertaxa
are taxa a taxon is contained in.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>supertaxa(
  x,
  subset = NULL,
  max_depth = NULL,
  include = FALSE,
  value = NULL,
  use_na = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="supertaxa_+3A_x">x</code></td>
<td>
<p>The object to get supertaxa for, such as a <a href="#topic+taxonomy">taxonomy</a> object.</p>
</td></tr>
<tr><td><code id="supertaxa_+3A_subset">subset</code></td>
<td>
<p>The subset of the tree to search for roots to that subset. Can
be indexes or names.</p>
</td></tr>
<tr><td><code id="supertaxa_+3A_max_depth">max_depth</code></td>
<td>
<p>The number of levels to traverse. For example, <code>max_depth = 1</code> returns only immediate supertaxa. By default (NULL) information for all
supertaxa is returned.</p>
</td></tr>
<tr><td><code id="supertaxa_+3A_include">include</code></td>
<td>
<p>If <code>TRUE</code>, include information for each taxon in the output.</p>
</td></tr>
<tr><td><code id="supertaxa_+3A_value">value</code></td>
<td>
<p>Something to return instead of indexes. Must be the same length
as the number of taxa.</p>
</td></tr>
<tr><td><code id="supertaxa_+3A_use_na">use_na</code></td>
<td>
<p>Add a NA to represent the root of the taxonomy (i.e. no
supertaxon)</p>
</td></tr>
<tr><td><code id="supertaxa_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other taxonomy functions: 
<code><a href="#topic+internodes">internodes</a>()</code>,
<code><a href="#topic+leaves">leaves</a>()</code>,
<code><a href="#topic+roots">roots</a>()</code>,
<code><a href="#topic+stems">stems</a>()</code>,
<code><a href="#topic+subtaxa">subtaxa</a>()</code>
</p>
<p>Other supertaxa functions: 
<code><a href="#topic+n_supertaxa">n_supertaxa</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example data
x &lt;- taxonomy(c('Carnivora', 'Felidae', 'Panthera', 'Panthera leo',
                'Panthera tigris', 'Ursidae', 'Ursus', 'Ursus arctos'),
              supertaxa = c(NA, 1, 2, 3, 3, 1, 6, 7))

# The indexes of all supertaxa (with supertaxa of supertaxa, etc) for each taxon
supertaxa(x)

# Return something other than index
supertaxa(x, value = tax_name(x))

# Include each taxon with its supertaxa
supertaxa(x, value = tax_name(x), include = TRUE)

# Only return data for some taxa (faster than subsetting the whole result)
supertaxa(x, subset = 3)

</code></pre>

<hr>
<h2 id='tax_auth.taxa_classification'>Set and get taxon authorities</h2><span id='topic+tax_auth.taxa_classification'></span><span id='topic+tax_auth+3C-.taxa_classification'></span><span id='topic+tax_auth'></span><span id='topic+tax_auth+3C-'></span><span id='topic+tax_auth.taxa_taxon'></span><span id='topic+tax_auth+3C-.taxa_taxon'></span><span id='topic+tax_auth.taxa_taxonomy'></span><span id='topic+tax_auth+3C-.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Set and get the taxon authorities in objects that have them, such as <a href="#topic+taxon">taxon</a> objects.
Note that this sets all the authority information, such as author name, date, and citations.
To set or get just one of part of the authorities, use <a href="#topic+tax_author">tax_author</a>, <a href="#topic+tax_date">tax_date</a>, or <a href="#topic+tax_cite">tax_cite</a> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
tax_auth(x)

## S3 replacement method for class 'taxa_classification'
tax_auth(x) &lt;- value

tax_auth(x)

tax_auth(x) &lt;- value

## S3 method for class 'taxa_taxon'
tax_auth(x)

## S3 replacement method for class 'taxa_taxon'
tax_auth(x) &lt;- value

## S3 method for class 'taxa_taxonomy'
tax_auth(x)

## S3 replacement method for class 'taxa_taxonomy'
tax_auth(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tax_auth.taxa_classification_+3A_x">x</code></td>
<td>
<p>An object with taxon authorities.</p>
</td></tr>
<tr><td><code id="tax_auth.taxa_classification_+3A_value">value</code></td>
<td>
<p>The taxon IDs to set. Inputs will be coerced into a <a href="#topic+taxon_id">taxon_id</a> vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon(name = c('Homo sapiens', 'Bacillus', 'Ascomycota', 'Ericaceae'),
           rank = c('species', 'genus', 'phylum', 'family'),
           id = taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi'),
           auth = c('Linnaeus, 1758', 'Cohn 1872', NA, 'Juss., 1789'))

tax_auth(x)
tax_auth(x) &lt;- tolower(tax_auth(x))
tax_auth(x)[1] &lt;- 'Billy'

</code></pre>

<hr>
<h2 id='tax_author.taxa_classification'>Set and get taxon authors</h2><span id='topic+tax_author.taxa_classification'></span><span id='topic+tax_author+3C-.taxa_classification'></span><span id='topic+tax_author'></span><span id='topic+tax_author+3C-'></span><span id='topic+tax_author.taxa_taxon'></span><span id='topic+tax_author+3C-.taxa_taxon'></span><span id='topic+tax_author+3C-.taxa_taxon_authority'></span><span id='topic+tax_author.taxa_taxon_authority'></span><span id='topic+tax_author.taxa_taxonomy'></span><span id='topic+tax_author+3C-.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Set and get taxon authors in objects that have them, such as <a href="#topic+taxon_authority">taxon_authority</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
tax_author(x)

## S3 replacement method for class 'taxa_classification'
tax_author(x) &lt;- value

tax_author(x)

tax_author(x) &lt;- value

## S3 method for class 'taxa_taxon'
tax_author(x)

## S3 replacement method for class 'taxa_taxon'
tax_author(x) &lt;- value

## S3 replacement method for class 'taxa_taxon_authority'
tax_author(x) &lt;- value

## S3 method for class 'taxa_taxon_authority'
tax_author(x)

## S3 method for class 'taxa_taxonomy'
tax_author(x)

## S3 replacement method for class 'taxa_taxonomy'
tax_author(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tax_author.taxa_classification_+3A_x">x</code></td>
<td>
<p>An object with taxon authors.</p>
</td></tr>
<tr><td><code id="tax_author.taxa_classification_+3A_value">value</code></td>
<td>
<p>The taxon authors to set. Inputs will be coerced into a <a href="base.html#topic+character">character</a> vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon_authority(c('Cham. &amp; Schldl.', 'L.'),
                     date = c('1827', '1753'))
tax_author(x)
tax_author(x)[1] &lt;- "Billy"
tax_author(x) &lt;- tolower(tax_author(x))

</code></pre>

<hr>
<h2 id='tax_cite.taxa_classification'>Set and get taxon authority citations</h2><span id='topic+tax_cite.taxa_classification'></span><span id='topic+tax_cite+3C-.taxa_classification'></span><span id='topic+tax_cite'></span><span id='topic+tax_cite+3C-'></span><span id='topic+tax_cite.taxa_taxon'></span><span id='topic+tax_cite+3C-.taxa_taxon'></span><span id='topic+tax_cite+3C-.taxa_taxon_authority'></span><span id='topic+tax_cite.taxa_taxon_authority'></span><span id='topic+tax_cite.taxa_taxonomy'></span><span id='topic+tax_cite+3C-.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Set and get the taxon authority citations in objects that have them, such as <a href="#topic+taxon_authority">taxon_authority</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
tax_cite(x)

## S3 replacement method for class 'taxa_classification'
tax_cite(x) &lt;- value

tax_cite(x)

tax_cite(x) &lt;- value

## S3 method for class 'taxa_taxon'
tax_cite(x)

## S3 replacement method for class 'taxa_taxon'
tax_cite(x) &lt;- value

## S3 replacement method for class 'taxa_taxon_authority'
tax_cite(x) &lt;- value

## S3 method for class 'taxa_taxon_authority'
tax_cite(x)

## S3 method for class 'taxa_taxonomy'
tax_cite(x)

## S3 replacement method for class 'taxa_taxonomy'
tax_cite(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tax_cite.taxa_classification_+3A_x">x</code></td>
<td>
<p>An object with taxon authority dates.</p>
</td></tr>
<tr><td><code id="tax_cite.taxa_classification_+3A_value">value</code></td>
<td>
<p>The taxon citations to set. Inputs will be coerced into a <a href="#topic+taxon_authority">taxon_authority</a> vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon_authority(c('Cham. &amp; Schldl.', 'L.'),
                     date = c('1827', '1753'),
                     citation = c(NA, 'Species Plantarum'))
tax_cite(x)
tax_cite(x)[1] &lt;- "Cham. et al 1984"

</code></pre>

<hr>
<h2 id='tax_date.taxa_classification'>Set and get taxon authority dates</h2><span id='topic+tax_date.taxa_classification'></span><span id='topic+tax_date+3C-.taxa_classification'></span><span id='topic+tax_date'></span><span id='topic+tax_date+3C-'></span><span id='topic+tax_date.taxa_taxon'></span><span id='topic+tax_date+3C-.taxa_taxon'></span><span id='topic+tax_date+3C-.taxa_taxon_authority'></span><span id='topic+tax_date.taxa_taxon_authority'></span><span id='topic+tax_date.taxa_taxonomy'></span><span id='topic+tax_date+3C-.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Set and get the taxon authority dates in objects that have them, such as <a href="#topic+taxon_authority">taxon_authority</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
tax_date(x)

## S3 replacement method for class 'taxa_classification'
tax_date(x) &lt;- value

tax_date(x)

tax_date(x) &lt;- value

## S3 method for class 'taxa_taxon'
tax_date(x)

## S3 replacement method for class 'taxa_taxon'
tax_date(x) &lt;- value

## S3 replacement method for class 'taxa_taxon_authority'
tax_date(x) &lt;- value

## S3 method for class 'taxa_taxon_authority'
tax_date(x)

## S3 method for class 'taxa_taxonomy'
tax_date(x)

## S3 replacement method for class 'taxa_taxonomy'
tax_date(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tax_date.taxa_classification_+3A_x">x</code></td>
<td>
<p>An object with taxon authority dates.</p>
</td></tr>
<tr><td><code id="tax_date.taxa_classification_+3A_value">value</code></td>
<td>
<p>The taxon authority dates to set. Inputs will be coerced into a <a href="base.html#topic+character">character</a> vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon_authority(c('Cham. &amp; Schldl.', 'L.'),
                     date = c('1827', '1753'))
tax_date(x)
tax_date(x)[1] &lt;- "1984"
tax_date(x) &lt;- c(NA, '1800')

</code></pre>

<hr>
<h2 id='tax_db.taxa_classification'>Set and get taxon ID databases</h2><span id='topic+tax_db.taxa_classification'></span><span id='topic+tax_db+3C-.taxa_classification'></span><span id='topic+tax_db'></span><span id='topic+tax_db+3C-'></span><span id='topic+tax_db.taxa_taxon'></span><span id='topic+tax_db+3C-.taxa_taxon'></span><span id='topic+tax_db.taxa_taxon_id'></span><span id='topic+tax_db+3C-.taxa_taxon_id'></span><span id='topic+tax_db.taxa_taxonomy'></span><span id='topic+tax_db+3C-.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Set and get the taxon ID databases in objects that have them, such as <a href="#topic+taxon_id">taxon_id</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
tax_db(x)

## S3 replacement method for class 'taxa_classification'
tax_db(x) &lt;- value

tax_db(x)

tax_db(x) &lt;- value

## S3 method for class 'taxa_taxon'
tax_db(x)

## S3 replacement method for class 'taxa_taxon'
tax_db(x) &lt;- value

## S3 method for class 'taxa_taxon_id'
tax_db(x)

## S3 replacement method for class 'taxa_taxon_id'
tax_db(x) &lt;- value

## S3 method for class 'taxa_taxonomy'
tax_db(x)

## S3 replacement method for class 'taxa_taxonomy'
tax_db(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tax_db.taxa_classification_+3A_x">x</code></td>
<td>
<p>An object with taxon authority dates.</p>
</td></tr>
<tr><td><code id="tax_db.taxa_classification_+3A_value">value</code></td>
<td>
<p>The taxon citations to set. Inputs will be coerced into a <a href="#topic+taxon_db">taxon_db</a> vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi')
tax_db(x)
tax_db(x) &lt;- 'nbn'
tax_db(x)[2] &lt;- 'itis'

</code></pre>

<hr>
<h2 id='tax_id.taxa_classification'>Set and get taxon IDs</h2><span id='topic+tax_id.taxa_classification'></span><span id='topic+tax_id+3C-.taxa_classification'></span><span id='topic+tax_id'></span><span id='topic+tax_id+3C-'></span><span id='topic+tax_id.taxa_taxon'></span><span id='topic+tax_id+3C-.taxa_taxon'></span><span id='topic+tax_id.taxa_taxonomy'></span><span id='topic+tax_id+3C-.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Set and get the taxon IDs in objects that have them, such as <a href="#topic+taxon">taxon</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
tax_id(x)

## S3 replacement method for class 'taxa_classification'
tax_id(x) &lt;- value

tax_id(x)

tax_id(x) &lt;- value

## S3 method for class 'taxa_taxon'
tax_id(x)

## S3 replacement method for class 'taxa_taxon'
tax_id(x) &lt;- value

## S3 method for class 'taxa_taxonomy'
tax_id(x)

## S3 replacement method for class 'taxa_taxonomy'
tax_id(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tax_id.taxa_classification_+3A_x">x</code></td>
<td>
<p>An object with taxon IDs.</p>
</td></tr>
<tr><td><code id="tax_id.taxa_classification_+3A_value">value</code></td>
<td>
<p>The taxon IDs to set. Inputs will be coerced into a <a href="#topic+taxon_id">taxon_id</a> vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon(name = c('Homo sapiens', 'Bacillus', 'Ascomycota', 'Ericaceae'),
           rank = c('species', 'genus', 'phylum', 'family'),
           id = taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi'),
           auth = c('Linnaeus, 1758', 'Cohn 1872', NA, 'Juss., 1789'))

tax_id(x)
tax_id(x) &lt;- paste0('00', tax_id(x))
tax_id(x)[1] &lt;- '00000'

</code></pre>

<hr>
<h2 id='tax_name.taxa_classification'>Set and get taxon names</h2><span id='topic+tax_name.taxa_classification'></span><span id='topic+tax_name+3C-.taxa_classification'></span><span id='topic+tax_name'></span><span id='topic+tax_name+3C-'></span><span id='topic+tax_name.taxa_taxon'></span><span id='topic+tax_name+3C-.taxa_taxon'></span><span id='topic+tax_name.taxa_taxonomy'></span><span id='topic+tax_name+3C-.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Set and get the taxon names in objects that have them, such as <a href="#topic+taxon">taxon</a> objects.
Note that this is not the same as adding vector names with <a href="base.html#topic+names">names</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
tax_name(x)

## S3 replacement method for class 'taxa_classification'
tax_name(x) &lt;- value

tax_name(x)

tax_name(x) &lt;- value

## S3 method for class 'taxa_taxon'
tax_name(x)

## S3 replacement method for class 'taxa_taxon'
tax_name(x) &lt;- value

## S3 method for class 'taxa_taxonomy'
tax_name(x)

## S3 replacement method for class 'taxa_taxonomy'
tax_name(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tax_name.taxa_classification_+3A_x">x</code></td>
<td>
<p>An object with taxon names.</p>
</td></tr>
<tr><td><code id="tax_name.taxa_classification_+3A_value">value</code></td>
<td>
<p>The taxon names to set. Inputs will be coerced into a <a href="base.html#topic+character">character</a> vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon(name = c('Homo sapiens', 'Bacillus', 'Ascomycota', 'Ericaceae'),
           rank = c('species', 'genus', 'phylum', 'family'),
           id = taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi'),
           auth = c('Linnaeus, 1758', 'Cohn 1872', NA, 'Juss., 1789'))

tax_name(x)
tax_name(x) &lt;- tolower(tax_name(x))
tax_name(x)[1] &lt;- 'Billy'

</code></pre>

<hr>
<h2 id='tax_rank.taxa_classification'>Set and get taxon ranks</h2><span id='topic+tax_rank.taxa_classification'></span><span id='topic+tax_rank+3C-.taxa_classification'></span><span id='topic+tax_rank'></span><span id='topic+tax_rank+3C-'></span><span id='topic+tax_rank.taxa_taxon'></span><span id='topic+tax_rank+3C-.taxa_taxon'></span><span id='topic+tax_rank.taxa_taxonomy'></span><span id='topic+tax_rank+3C-.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Set and get the taxon ranks in objects that have them, such as <a href="#topic+taxon">taxon</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
tax_rank(x)

## S3 replacement method for class 'taxa_classification'
tax_rank(x) &lt;- value

tax_rank(x)

tax_rank(x) &lt;- value

## S3 method for class 'taxa_taxon'
tax_rank(x)

## S3 replacement method for class 'taxa_taxon'
tax_rank(x) &lt;- value

## S3 method for class 'taxa_taxonomy'
tax_rank(x)

## S3 replacement method for class 'taxa_taxonomy'
tax_rank(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tax_rank.taxa_classification_+3A_x">x</code></td>
<td>
<p>An object with taxon ranks.</p>
</td></tr>
<tr><td><code id="tax_rank.taxa_classification_+3A_value">value</code></td>
<td>
<p>The taxon ranks to set. Inputs will be coerced into a <a href="#topic+taxon_rank">taxon_rank</a> vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- taxon(name = c('Homo sapiens', 'Bacillus', 'Ascomycota', 'Ericaceae'),
           rank = c('species', 'genus', 'phylum', 'family'),
           id = taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi'),
           auth = c('Linnaeus, 1758', 'Cohn 1872', NA, 'Juss., 1789'))

tax_rank(x)
tax_rank(x) &lt;- 'species'
tax_rank(x)[1] &lt;- taxon_rank('family')

</code></pre>

<hr>
<h2 id='taxa_comparison_funcs'>taxa comparison functions</h2><span id='topic+taxa_comparison_funcs'></span><span id='topic+vec_proxy_equal.taxa_taxon'></span><span id='topic+vec_proxy_equal.taxa_taxon_authority'></span><span id='topic+vec_proxy_equal.taxa_taxon_id'></span><span id='topic+vec_proxy_compare.taxa_taxon_rank'></span><span id='topic+vec_proxy_equal.taxa_taxon_rank'></span><span id='topic+Ops.taxa_taxon_rank'></span><span id='topic+vec_proxy_equal.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Functions used internally for casting taxon objects to other types. They have to be exported to
work, but they are not intended to be directly used by most users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_taxon'
vec_proxy_equal(x, ...)

## S3 method for class 'taxa_taxon_authority'
vec_proxy_equal(x, ...)

## S3 method for class 'taxa_taxon_id'
vec_proxy_equal(x, ...)

## S3 method for class 'taxa_taxon_rank'
vec_proxy_compare(x, ...)

## S3 method for class 'taxa_taxon_rank'
vec_proxy_equal(x, ...)

## S3 method for class 'taxa_taxon_rank'
Ops(e1, e2)

## S3 method for class 'taxa_taxonomy'
vec_proxy_equal(x, ...)
</code></pre>

<hr>
<h2 id='taxa_taxon_authority-class'>Taxon authority class</h2><span id='topic+taxa_taxon_authority-class'></span><span id='topic+taxa_taxon_authority'></span>

<h3>Description</h3>

<p>Taxon authority class. See <a href="#topic+taxon_authority">taxon_authority</a> for more information
</p>

<hr>
<h2 id='taxa_taxon_db-class'>Taxon database class</h2><span id='topic+taxa_taxon_db-class'></span><span id='topic+taxa_taxon_db'></span>

<h3>Description</h3>

<p>Taxon database class. See <a href="#topic+taxon_db">taxon_db</a> for more information
</p>

<hr>
<h2 id='taxa_taxon_id-class'>Taxon ID class</h2><span id='topic+taxa_taxon_id-class'></span><span id='topic+taxa_taxon_id'></span>

<h3>Description</h3>

<p>Taxon ID class. See <a href="#topic+taxon_id">taxon_id</a> for more information
</p>

<hr>
<h2 id='taxa_taxon_rank-class'>Taxon rank class</h2><span id='topic+taxa_taxon_rank-class'></span><span id='topic+taxa_taxon_rank'></span>

<h3>Description</h3>

<p>Taxon rank class. See <a href="#topic+taxon_rank">taxon_rank</a> for more information
</p>

<hr>
<h2 id='taxa_taxon-class'>Taxon class</h2><span id='topic+taxa_taxon-class'></span><span id='topic+taxa_taxon'></span>

<h3>Description</h3>

<p>Taxon class. See <a href="#topic+taxon">taxon</a> for more information
</p>

<hr>
<h2 id='taxa_taxonomy-class'>Taxonomy class</h2><span id='topic+taxa_taxonomy-class'></span><span id='topic+taxa_taxonomy'></span>

<h3>Description</h3>

<p>Taxonomy class. See <a href="#topic+taxonomy">taxonomy</a> for more information
</p>

<hr>
<h2 id='taxon'>Taxon class</h2><span id='topic+taxon'></span>

<h3>Description</h3>

<a href='https://www.tidyverse.org/lifecycle/#maturing'><img src='figures/lifecycle-maturing.svg' alt='Maturing lifecycle'></a>
<p>Used to store information about taxa, such as names, ranks, and IDs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon(name = character(0), rank = NA, id = NA, auth = NA, .names = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_+3A_name">name</code></td>
<td>
<p>The names of taxa. Inputs with be coerced into a <a href="base.html#topic+character">character</a> vector if anything else
is given.</p>
</td></tr>
<tr><td><code id="taxon_+3A_rank">rank</code></td>
<td>
<p>The ranks of taxa. Inputs with be coerced into a <a href="#topic+taxon_rank">taxon_rank</a> vector if anything else
is given.</p>
</td></tr>
<tr><td><code id="taxon_+3A_id">id</code></td>
<td>
<p>The ids of taxa. These should be unique identifier and are usually associated with a
database. Inputs with be coerced into a <a href="#topic+taxon_id">taxon_id</a> vector if anything else is given.</p>
</td></tr>
<tr><td><code id="taxon_+3A_auth">auth</code></td>
<td>
<p>The authority of the taxon. Inputs with be coerced into a <a href="#topic+taxon_authority">taxon_authority</a> vector if
anything else is given.</p>
</td></tr>
<tr><td><code id="taxon_+3A_.names">.names</code></td>
<td>
<p>The names of the vector.</p>
</td></tr>
<tr><td><code id="taxon_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon</code>
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic++5B.taxa_classification">[.taxa_classification</a>()</code>,
<code><a href="#topic+classification">classification</a>()</code>,
<code><a href="#topic+taxon_authority">taxon_authority</a>()</code>,
<code><a href="#topic+taxon_db">taxon_db</a>()</code>,
<code><a href="#topic+taxon_id">taxon_id</a>()</code>,
<code><a href="#topic+taxon_rank">taxon_rank</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create taxon name vector
x &lt;- taxon(c('A', 'B', 'C'))
x &lt;- taxon(name = c('Homo sapiens', 'Bacillus', 'Ascomycota', 'Ericaceae'),
           rank = c('species', 'genus', 'phylum', 'family'),
           id = taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi'),
           auth = c('Linnaeus, 1758', 'Cohn 1872', NA, 'Juss., 1789'))
names(x) &lt;- c('a', 'b', 'c', 'd')

# Get parts of the taxon name vector
tax_name(x)
tax_rank(x)
tax_id(x)
tax_db(x)
tax_auth(x)
tax_author(x)
tax_date(x)
tax_cite(x)

# Set parts of the taxon name vector
tax_name(x) &lt;- tolower(tax_name(x))
tax_rank(x)[1] &lt;- NA
tax_name(x)['b'] &lt;- 'Billy'
tax_id(x) &lt;- '9999'
tax_db(x) &lt;- 'itis'
tax_auth(x) &lt;- NA
tax_author(x)[2:3] &lt;- c('Joe', 'Billy')
tax_date(x) &lt;- c('1999', '2013', '1796', '1899')
tax_cite(x)[1] &lt;- 'Linnaeus, C. (1771). Mantissa plantarum altera generum.'

# Manipulate taxon name vectors
x[1:3]
x[tax_rank(x) &gt; 'family']
x['b'] &lt;- NA
x[c('c', 'd')] &lt;- 'unknown'
is.na(x)

# Use as columns in tables
tibble::tibble(x = x, y = 1:4)
data.frame(x = x, y = 1:4)

# Converting to tables
tibble::as_tibble(x)
as_data_frame(x)

</code></pre>

<hr>
<h2 id='taxon_authority'>Taxon authority class</h2><span id='topic+taxon_authority'></span>

<h3>Description</h3>

<a href='https://www.tidyverse.org/lifecycle/#maturing'><img src='figures/lifecycle-maturing.svg' alt='Maturing lifecycle'></a><p> Used to store information on taxon authorities, such as author names, date, and citation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_authority(
  author = character(),
  date = "",
  citation = "",
  .names = "",
  extract_date = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_authority_+3A_author">author</code></td>
<td>
<p>Zero or more author names.</p>
</td></tr>
<tr><td><code id="taxon_authority_+3A_date">date</code></td>
<td>
<p>Zero or more dates.</p>
</td></tr>
<tr><td><code id="taxon_authority_+3A_citation">citation</code></td>
<td>
<p>Zero or more literature citations.</p>
</td></tr>
<tr><td><code id="taxon_authority_+3A_.names">.names</code></td>
<td>
<p>The names of the vector.</p>
</td></tr>
<tr><td><code id="taxon_authority_+3A_extract_date">extract_date</code></td>
<td>
<p>If <code>TRUE</code> (the default), then if a date is detected in the <code>author</code> input and
no <code>date</code> input is given, then the date is separated from the author input.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_authority</code>
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic++5B.taxa_classification">[.taxa_classification</a>()</code>,
<code><a href="#topic+classification">classification</a>()</code>,
<code><a href="#topic+taxon">taxon</a>()</code>,
<code><a href="#topic+taxon_db">taxon_db</a>()</code>,
<code><a href="#topic+taxon_id">taxon_id</a>()</code>,
<code><a href="#topic+taxon_rank">taxon_rank</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Making new objects
x &lt;- taxon_authority(c('A', 'B', 'C'))
x &lt;- taxon_authority(c('Cham. &amp; Schldl.', 'L.'),
                     date = c('1827', '1753'))

# Manipulating objects
as.character(x)
x[2]
x[2] &lt;- 'ABC'
names(x) &lt;- c('a', 'b')
x['b'] &lt;- 'David Bowie'
tax_author(x)[1] &lt;- tolower(tax_author(x)[1])
tax_author(x)
tax_date(x) &lt;- c('2000', '1234')
tax_date(x)
tax_cite(x)[2] &lt;- c('Linnaeus, C. (1771). Mantissa plantarum altera generum.')
tax_cite(x)

# Using as columns in tables
tibble::tibble(x = x, y = 1:2)
data.frame(x = x, y = 1:2)

# Converting to tables
tibble::as_tibble(x)
as_data_frame(x)

</code></pre>

<hr>
<h2 id='taxon_db'>Taxon database class</h2><span id='topic+taxon_db'></span>

<h3>Description</h3>

<a href='https://www.tidyverse.org/lifecycle/#maturing'><img src='figures/lifecycle-maturing.svg' alt='Maturing lifecycle'></a>
<p>Used to store the names of taxon databases defined in <a href="#topic+db_ref">db_ref</a>. Primarily
used in other classes like <a href="#topic+taxon_id">taxon_id</a> to define databases for each item.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_db(db = character(), .names = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_db_+3A_db">db</code></td>
<td>
<p>Zero or more taxonomic database names. Should be a name contained in
<a href="#topic+db_ref">db_ref</a>. Inputs will be transformed to a <a href="base.html#topic+character">character</a> vector if possible.</p>
</td></tr>
<tr><td><code id="taxon_db_+3A_.names">.names</code></td>
<td>
<p>The names of the vector.</p>
</td></tr>
<tr><td><code id="taxon_db_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_db</code>
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic++5B.taxa_classification">[.taxa_classification</a>()</code>,
<code><a href="#topic+classification">classification</a>()</code>,
<code><a href="#topic+taxon">taxon</a>()</code>,
<code><a href="#topic+taxon_authority">taxon_authority</a>()</code>,
<code><a href="#topic+taxon_id">taxon_id</a>()</code>,
<code><a href="#topic+taxon_rank">taxon_rank</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Making new objects
x &lt;- taxon_db(c('ncbi', 'ncbi', 'itis'))
x

# Manipulating objects
as.character(x)
x[2:3]
x[2:3] &lt;- 'nbn'
names(x) &lt;- c('a', 'b', 'c')
x['b']
x['b'] &lt;- 'nbn'
x[x == 'itis'] &lt;- 'gbif'

# Using as columns in tables
tibble::tibble(x = x, y = 1:3)
data.frame(x = x, y = 1:3)

# Converting to tables
tibble::as_tibble(x)
as_data_frame(x)

# Trying to use an invalid database generates an error
# x &lt;- taxon_db(c('ncbi', 'ncbi', 'my_custom_db'))
# x[x == 'itis'] &lt;- 'my_custom_db'

# Listing known databases and their properties
db_ref$get()

# Adding and using a new database
db_ref$set(name = 'my_custom_db', desc = 'I just made this up')
db_ref$get()
x &lt;- taxon_db(c('ncbi', 'ncbi', 'my_custom_db'))

</code></pre>

<hr>
<h2 id='taxon_db_def'>Taxon database definition class</h2><span id='topic+taxon_db_def'></span>

<h3>Description</h3>

<p>Used to store information on taxonomic databases that is used to validate information in other classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_db_def(
  name = character(),
  url = NA_character_,
  desc = NA_character_,
  id_regex = NA_character_,
  rank_levels = rep(list(NULL), length(name))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_db_def_+3A_name">name</code></td>
<td>
<p>Name of the database in lower case. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="taxon_db_def_+3A_url">url</code></td>
<td>
<p>URL of the database website. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="taxon_db_def_+3A_desc">desc</code></td>
<td>
<p>Description of the database. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="taxon_db_def_+3A_id_regex">id_regex</code></td>
<td>
<p>A regular expression for taxon IDs of the database. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="taxon_db_def_+3A_rank_levels">rank_levels</code></td>
<td>
<p>Valid taxonomic ranks for the database. Should be a list of <code>numeric</code> vectors named by taxonomic ranks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_db_def</code>
</p>

<hr>
<h2 id='taxon_id'>Taxon ID class</h2><span id='topic+taxon_id'></span>

<h3>Description</h3>

<a href='https://www.tidyverse.org/lifecycle/#maturing'><img src='figures/lifecycle-maturing.svg' alt='Maturing lifecycle'></a>
<p>Used to store the ID corresponding to taxa, either arbitrary or from a
particular taxonomy database. This is typically used to store taxon IDs in
<a href="#topic+taxon">taxon</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_id(id = character(), db = "", .names = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_id_+3A_id">id</code></td>
<td>
<p>Zero or more taxonomic ids. Inputs will be transformed to a <a href="base.html#topic+character">character</a> vector if
possible.</p>
</td></tr>
<tr><td><code id="taxon_id_+3A_db">db</code></td>
<td>
<p>The name(s) of the database(s) associated with the IDs. If not <code>NA</code> (the default), the
input must consist of names of databases in <a href="#topic+db_ref">db_ref$get()</a>.</p>
</td></tr>
<tr><td><code id="taxon_id_+3A_.names">.names</code></td>
<td>
<p>The names that will be applied to the vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_id</code>
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic++5B.taxa_classification">[.taxa_classification</a>()</code>,
<code><a href="#topic+classification">classification</a>()</code>,
<code><a href="#topic+taxon">taxon</a>()</code>,
<code><a href="#topic+taxon_authority">taxon_authority</a>()</code>,
<code><a href="#topic+taxon_db">taxon_db</a>()</code>,
<code><a href="#topic+taxon_rank">taxon_rank</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Making new objects
x &lt;- taxon_id(c('A', 'B', 'C'))
x &lt;- taxon_id(c('9606', '1386', '4890', '4345'), db = 'ncbi')
x &lt;- taxon_id(c('9606', '1386', '4890', '4345'),
              db = c('ncbi', 'ncbi', 'itis', 'itis'))
names(x) &lt;- c('a', 'b', 'c', 'd')

# Manipulating objects
as.character(x)
x[2:3]
x[2:3] &lt;- 'ABC'
x[c('a', 'c')] &lt;- '123'
x[['b']] &lt;- taxon_id('123423', db = 'ncbi')
tax_db(x)
tax_db(x) &lt;- 'nbn'
c(x, x)

# Using as columns in tables
tibble::tibble(x = x, y = 1:4)
data.frame(x = x, y = 1:4)

# Convert to tables
tibble::as_tibble(x)
as_data_frame(x)

# Trying to use an invalid ID with a specified database causes an error
#taxon_id('NOLETTERS', db = 'ncbi')

</code></pre>

<hr>
<h2 id='taxon_rank'>Taxon rank class</h2><span id='topic+taxon_rank'></span>

<h3>Description</h3>

<a href='https://www.tidyverse.org/lifecycle/#maturing'><img src='figures/lifecycle-maturing.svg' alt='Maturing lifecycle'></a>
<p>Used to store taxon ranks, possibly associated with a taxonomy database. This is typically used to
store taxon ranks in <a href="#topic+taxon">taxon</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_rank(
  rank = character(),
  .names = NULL,
  levels = NULL,
  guess_order = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_rank_+3A_rank">rank</code></td>
<td>
<p>Zero or more taxonomic rank names. Inputs will be transformed to a <a href="base.html#topic+character">character</a>
vector.</p>
</td></tr>
<tr><td><code id="taxon_rank_+3A_.names">.names</code></td>
<td>
<p>The names of the vector</p>
</td></tr>
<tr><td><code id="taxon_rank_+3A_levels">levels</code></td>
<td>
<p>A named numeric vector indicating the names and orders of possible taxonomic ranks.
Higher numbers indicate for fine-scale groupings. Ranks of unknown order can be indicated with
<code>NA</code> instead of a number.</p>
</td></tr>
<tr><td><code id="taxon_rank_+3A_guess_order">guess_order</code></td>
<td>
<p>If <code>TRUE</code> and no rank order is given using numbers, try to guess order based
on rank names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_rank</code>
</p>


<h3>See Also</h3>

<p>Other classes: 
<code><a href="#topic++5B.taxa_classification">[.taxa_classification</a>()</code>,
<code><a href="#topic+classification">classification</a>()</code>,
<code><a href="#topic+taxon">taxon</a>()</code>,
<code><a href="#topic+taxon_authority">taxon_authority</a>()</code>,
<code><a href="#topic+taxon_db">taxon_db</a>()</code>,
<code><a href="#topic+taxon_id">taxon_id</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Making new objects
x &lt;- taxon_rank(c('species', 'species', 'phylum', 'family'))

# Specifiying level order
taxon_rank(c('A', 'B', 'C', 'D', 'A', 'D', 'D'),
           levels = c('D', 'C', 'B', 'A'))
taxon_rank(c('A', 'B', 'C', 'D', 'A', 'D', 'D'),
           levels = c(D = NA, A = 10, B = 20, C = 30))
names(x) &lt;- c('a', 'b', 'c', 'd')

# Manipulating objects
as.character(x)
as.factor(x)
as.ordered(x)
x[2:3]
x[x &gt; 'family'] &lt;- taxon_rank('unknown')
x[1] &lt;- taxon_rank('order')
x['b']
x['b'] &lt;- 'order'

# Using as columns in tables
tibble::tibble(x = x, y = 1:4)
data.frame(x = x, y = 1:4)

# Converting to tables
tibble::as_tibble(x)
as_data_frame(x)

# Trying to add an unknown level as a character causes an error
#x[2] &lt;- 'superkingdom'

# But you can add a new level using taxon_rank objects
x[2] &lt;- taxon_rank('superkingdom')

</code></pre>

<hr>
<h2 id='taxon_rank_level'>Taxon rank level</h2><span id='topic+taxon_rank_level'></span>

<h3>Description</h3>

<p>Used to store taxon rank level information. This is used in <code><a href="#topic+taxon_rank">taxon_rank()</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_rank_level(
  level = character(),
  order = NULL,
  guess_order = TRUE,
  impute_na = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_rank_level_+3A_level">level</code></td>
<td>
<p>Zero or more taxonomic rank names. If a named numeric is
applied, the names are used for levels and the numeric values are used
for the order. Inputs will be transformed to a <code>character</code> vector.</p>
</td></tr>
<tr><td><code id="taxon_rank_level_+3A_order">order</code></td>
<td>
<p>Integers that determine the relative order of taxonomic levels.
Inputs will be transformed to a <code>integer</code> vector. <code>NA</code>s can be used to
indicate that the order is not known.</p>
</td></tr>
<tr><td><code id="taxon_rank_level_+3A_guess_order">guess_order</code></td>
<td>
<p>If <code>TRUE</code> and no order is given, try to guess order based on rank names.</p>
</td></tr>
<tr><td><code id="taxon_rank_level_+3A_impute_na">impute_na</code></td>
<td>
<p>If <code>TRUE</code>, fill in NAs based on nearby values (assumed in ascending order).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>S3</code> object of class <code>taxa_taxon_rank_level</code>
</p>

<hr>
<h2 id='unname_fields'>Remove names from fields in a vctrs rcrd</h2><span id='topic+unname_fields'></span>

<h3>Description</h3>

<p>Remove names from fields in a vctrs rcrd
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unname_fields(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unname_fields_+3A_x">x</code></td>
<td>
<p>a vctrs rcrd</p>
</td></tr>
</table>

<hr>
<h2 id='vec_cast.taxa_classification'>taxa casting functions</h2><span id='topic+vec_cast.taxa_classification'></span><span id='topic+vec_cast.taxa_classification.default'></span><span id='topic+vec_cast.taxa_classification.taxa_classification'></span><span id='topic+vec_cast.character.taxa_classification'></span><span id='topic+vec_cast.factor.taxa_classification'></span><span id='topic+vec_cast.integer.taxa_classification'></span><span id='topic+taxa_casting_funcs'></span><span id='topic+vec_cast.taxa_taxon'></span><span id='topic+vec_cast.taxa_taxon.default'></span><span id='topic+vec_cast.taxa_taxon.taxa_taxon'></span><span id='topic+vec_cast.taxa_taxon.character'></span><span id='topic+vec_cast.character.taxa_taxon'></span><span id='topic+vec_cast.taxa_taxon.factor'></span><span id='topic+vec_cast.factor.taxa_taxon'></span><span id='topic+vec_cast.taxa_taxon_authority'></span><span id='topic+vec_cast.taxa_taxon_authority.default'></span><span id='topic+vec_cast.taxa_taxon_authority.taxa_taxon_authority'></span><span id='topic+vec_cast.taxa_taxon_authority.character'></span><span id='topic+vec_cast.character.taxa_taxon_authority'></span><span id='topic+vec_cast.taxa_taxon_authority.factor'></span><span id='topic+vec_cast.factor.taxa_taxon_authority'></span><span id='topic+vec_cast.taxa_taxon_authority.integer'></span><span id='topic+vec_cast.data.frame.taxa_taxon_authority'></span><span id='topic+vec_cast.taxa_taxon_db'></span><span id='topic+vec_cast.taxa_taxon_db.default'></span><span id='topic+vec_cast.taxa_taxon_db.taxa_taxon_db'></span><span id='topic+vec_cast.taxa_taxon_db.character'></span><span id='topic+vec_cast.character.taxa_taxon_db'></span><span id='topic+vec_cast.taxa_taxon_db.factor'></span><span id='topic+vec_cast.factor.taxa_taxon_db'></span><span id='topic+vec_cast.taxa_taxon_db_def'></span><span id='topic+vec_cast.taxa_taxon_db_def.default'></span><span id='topic+vec_cast.taxa_taxon_db_def.taxa_taxon_db_def'></span><span id='topic+vec_cast.taxa_taxon_id'></span><span id='topic+vec_cast.taxa_taxon_id.default'></span><span id='topic+vec_cast.taxa_taxon_id.taxa_taxon_id'></span><span id='topic+vec_cast.taxa_taxon_id.character'></span><span id='topic+vec_cast.character.taxa_taxon_id'></span><span id='topic+vec_cast.taxa_taxon_id.factor'></span><span id='topic+vec_cast.factor.taxa_taxon_id'></span><span id='topic+vec_cast.taxa_taxon_id.integer'></span><span id='topic+vec_cast.integer.taxa_taxon_id'></span><span id='topic+vec_cast.taxa_taxon_id.double'></span><span id='topic+vec_cast.double.taxa_taxon_id'></span><span id='topic+vec_cast.data.frame.taxa_taxon_id'></span><span id='topic+vec_cast.taxa_taxon_rank'></span><span id='topic+vec_cast.taxa_taxon_rank.default'></span><span id='topic+vec_cast.taxa_taxon_rank.taxa_taxon_rank'></span><span id='topic+vec_cast.taxa_taxon_rank.character'></span><span id='topic+vec_cast.character.taxa_taxon_rank'></span><span id='topic+vec_cast.taxa_taxon_rank.factor'></span><span id='topic+vec_cast.factor.taxa_taxon_rank'></span><span id='topic+vec_cast.taxa_taxon_rank.double'></span><span id='topic+vec_cast.double.taxa_taxon_rank'></span><span id='topic+vec_cast.data.frame.taxa_taxon_rank'></span><span id='topic+vec_cast.taxa_taxon_rank_level'></span><span id='topic+vec_cast.taxa_taxon_rank_level.default'></span><span id='topic+vec_cast.taxa_taxon_rank_level.taxa_taxon_rank_level'></span><span id='topic+vec_cast.taxa_taxon_rank_level.character'></span><span id='topic+vec_cast.character.taxa_taxon_rank_level'></span><span id='topic+vec_cast.taxa_taxonomy'></span><span id='topic+vec_cast.taxa_taxonomy.default'></span><span id='topic+vec_cast.taxa_taxonomy.taxa_taxonomy'></span><span id='topic+vec_cast.taxa_taxonomy.character'></span><span id='topic+vec_cast.character.taxa_taxonomy'></span><span id='topic+vec_cast.taxa_taxonomy.factor'></span><span id='topic+vec_cast.factor.taxa_taxonomy'></span><span id='topic+vec_cast.taxa_taxonomy.taxa_taxon'></span><span id='topic+vec_cast.taxa_taxon.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Functions used internally for casting taxon objects to other types. They have to be exported to
work, but they are not intended to be directly used by most users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_classification(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_classification'
vec_cast.taxa_classification(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_classification'
vec_cast.character(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_classification'
vec_cast.factor(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_classification'
vec_cast.integer(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_taxon(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon'
vec_cast.taxa_taxon(x, to, ..., x_arg, to_arg)

## S3 method for class 'character'
vec_cast.taxa_taxon(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon'
vec_cast.character(x, to, ..., x_arg, to_arg)

## S3 method for class 'factor'
vec_cast.taxa_taxon(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon'
vec_cast.factor(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_authority'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_taxon_authority(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_authority'
vec_cast.taxa_taxon_authority(x, to, ..., x_arg, to_arg)

## S3 method for class 'character'
vec_cast.taxa_taxon_authority(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_authority'
vec_cast.character(x, to, ..., x_arg, to_arg)

## S3 method for class 'factor'
vec_cast.taxa_taxon_authority(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_authority'
vec_cast.factor(x, to, ..., x_arg, to_arg)

## S3 method for class 'integer'
vec_cast.taxa_taxon_authority(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_authority'
vec_cast.data.frame(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_db'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_taxon_db(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_db'
vec_cast.taxa_taxon_db(x, to, ..., x_arg, to_arg)

## S3 method for class 'character'
vec_cast.taxa_taxon_db(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_db'
vec_cast.character(x, to, ..., x_arg, to_arg)

## S3 method for class 'factor'
vec_cast.taxa_taxon_db(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_db'
vec_cast.factor(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_db_def'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_taxon_db_def(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_db_def'
vec_cast.taxa_taxon_db_def(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_id'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_taxon_id(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_id'
vec_cast.taxa_taxon_id(x, to, ..., x_arg, to_arg)

## S3 method for class 'character'
vec_cast.taxa_taxon_id(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_id'
vec_cast.character(x, to, ..., x_arg, to_arg)

## S3 method for class 'factor'
vec_cast.taxa_taxon_id(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_id'
vec_cast.factor(x, to, ..., x_arg, to_arg)

## S3 method for class 'integer'
vec_cast.taxa_taxon_id(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_id'
vec_cast.integer(x, to, ..., x_arg, to_arg)

## S3 method for class 'double'
vec_cast.taxa_taxon_id(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_id'
vec_cast.double(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_id'
vec_cast.data.frame(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_taxon_rank(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank'
vec_cast.taxa_taxon_rank(x, to, ..., x_arg, to_arg)

## S3 method for class 'character'
vec_cast.taxa_taxon_rank(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank'
vec_cast.character(x, to, ..., x_arg, to_arg)

## S3 method for class 'factor'
vec_cast.taxa_taxon_rank(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank'
vec_cast.factor(x, to, ..., x_arg, to_arg)

## S3 method for class 'double'
vec_cast.taxa_taxon_rank(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank'
vec_cast.double(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank'
vec_cast.data.frame(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank_level'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_taxon_rank_level(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank_level'
vec_cast.taxa_taxon_rank_level(x, to, ..., x_arg, to_arg)

## S3 method for class 'character'
vec_cast.taxa_taxon_rank_level(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon_rank_level'
vec_cast.character(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxonomy'
vec_cast(x, to, ..., x_arg, to_arg)

## Default S3 method:
vec_cast.taxa_taxonomy(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxonomy'
vec_cast.taxa_taxonomy(x, to, ..., x_arg, to_arg)

## S3 method for class 'character'
vec_cast.taxa_taxonomy(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxonomy'
vec_cast.character(x, to, ..., x_arg, to_arg)

## S3 method for class 'factor'
vec_cast.taxa_taxonomy(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxonomy'
vec_cast.factor(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxon'
vec_cast.taxa_taxonomy(x, to, ..., x_arg, to_arg)

## S3 method for class 'taxa_taxonomy'
vec_cast.taxa_taxon(x, to, ..., x_arg, to_arg)
</code></pre>

<hr>
<h2 id='vec_ptype2.taxa_classification'>taxa coercion functions</h2><span id='topic+vec_ptype2.taxa_classification'></span><span id='topic+vec_ptype2.taxa_classification.default'></span><span id='topic+vec_ptype2.taxa_classification.vctrs_unspecified'></span><span id='topic+vec_ptype2.taxa_classification.taxa_classification'></span><span id='topic+vec_ptype2.taxa_classification.character'></span><span id='topic+vec_ptype2.character.taxa_classification'></span><span id='topic+vec_ptype2.taxa_classification.factor'></span><span id='topic+vec_ptype2.factor.taxa_classification'></span><span id='topic+taxa_coercion_funcs'></span><span id='topic+vec_ptype2.taxa_taxon'></span><span id='topic+vec_ptype2.taxa_taxon.default'></span><span id='topic+vec_ptype2.taxa_taxon.vctrs_unspecified'></span><span id='topic+vec_ptype2.taxa_taxon.taxa_taxon'></span><span id='topic+vec_ptype2.taxa_taxon.character'></span><span id='topic+vec_ptype2.character.taxa_taxon'></span><span id='topic+vec_ptype2.taxa_taxon.factor'></span><span id='topic+vec_ptype2.factor.taxa_taxon'></span><span id='topic+vec_ptype2.taxa_taxon_authority'></span><span id='topic+vec_ptype2.taxa_taxon_authority.default'></span><span id='topic+vec_ptype2.taxa_taxon_authority.vctrs_unspecified'></span><span id='topic+vec_ptype2.taxa_taxon_authority.taxa_taxon_authority'></span><span id='topic+vec_ptype2.taxa_taxon_authority.character'></span><span id='topic+vec_ptype2.character.taxa_taxon_authority'></span><span id='topic+vec_ptype2.taxa_taxon_authority.factor'></span><span id='topic+vec_ptype2.factor.taxa_taxon_authority'></span><span id='topic+vec_ptype2.taxa_taxon_db'></span><span id='topic+vec_ptype2.taxa_taxon_db.default'></span><span id='topic+vec_ptype2.taxa_taxon_db.vctrs_unspecified'></span><span id='topic+vec_ptype2.taxa_taxon_db.taxa_taxon_db'></span><span id='topic+vec_ptype2.taxa_taxon_db.character'></span><span id='topic+vec_ptype2.character.taxa_taxon_db'></span><span id='topic+vec_ptype2.taxa_taxon_db.factor'></span><span id='topic+vec_ptype2.factor.taxa_taxon_db'></span><span id='topic+vec_ptype2.taxa_taxon_id'></span><span id='topic+vec_ptype2.taxa_taxon_id.default'></span><span id='topic+vec_ptype2.taxa_taxon_id.vctrs_unspecified'></span><span id='topic+vec_ptype2.taxa_taxon_id.taxa_taxon_id'></span><span id='topic+vec_ptype2.taxa_taxon_id.character'></span><span id='topic+vec_ptype2.character.taxa_taxon_id'></span><span id='topic+vec_ptype2.taxa_taxon_id.factor'></span><span id='topic+vec_ptype2.factor.taxa_taxon_id'></span><span id='topic+vec_ptype2.taxa_taxon_rank'></span><span id='topic+vec_ptype2.taxa_taxon_rank.default'></span><span id='topic+vec_ptype2.taxa_taxon_rank.vctrs_unspecified'></span><span id='topic+vec_ptype2.taxa_taxon_rank.taxa_taxon_rank'></span><span id='topic+vec_ptype2.taxa_taxon_rank.character'></span><span id='topic+vec_ptype2.character.taxa_taxon_rank'></span><span id='topic+vec_ptype2.taxa_taxon_rank.factor'></span><span id='topic+vec_ptype2.factor.taxa_taxon_rank'></span><span id='topic+vec_ptype2.taxa_taxon_rank_level'></span><span id='topic+vec_ptype2.taxa_taxon_rank_level.default'></span><span id='topic+vec_ptype2.taxa_taxon_rank_level.vctrs_unspecified'></span><span id='topic+vec_ptype2.taxa_taxon_rank_level.taxa_taxon_rank_level'></span><span id='topic+vec_ptype2.taxa_taxon_rank_level.character'></span><span id='topic+vec_ptype2.character.taxa_taxon_rank_level'></span><span id='topic+vec_ptype2.taxa_taxonomy'></span><span id='topic+vec_ptype2.taxa_taxonomy.default'></span><span id='topic+vec_ptype2.taxa_taxonomy.vctrs_unspecified'></span><span id='topic+vec_ptype2.taxa_taxonomy.taxa_taxonomy'></span><span id='topic+vec_ptype2.taxa_taxonomy.character'></span><span id='topic+vec_ptype2.character.taxa_taxonomy'></span><span id='topic+vec_ptype2.taxa_taxonomy.factor'></span><span id='topic+vec_ptype2.factor.taxa_taxonomy'></span>

<h3>Description</h3>

<p>Functions used internally for coercing taxon objects and other objects to common data types.
They have to be exported to work, but they are not intended to be directly used by most users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'taxa_classification'
vec_ptype2(x, y, ...)

## Default S3 method:
vec_ptype2.taxa_classification(x, y, ..., x_arg = "", y_arg = "")

## S3 method for class 'vctrs_unspecified'
vec_ptype2.taxa_classification(x, y, ...)

## S3 method for class 'taxa_classification'
vec_ptype2.taxa_classification(x, y, ...)

## S3 method for class 'character'
vec_ptype2.taxa_classification(x, y, ...)

## S3 method for class 'taxa_classification'
vec_ptype2.character(x, y, ...)

## S3 method for class 'factor'
vec_ptype2.taxa_classification(x, y, ...)

## S3 method for class 'taxa_classification'
vec_ptype2.factor(x, y, ...)

## S3 method for class 'taxa_taxon'
vec_ptype2(x, y, ...)

## Default S3 method:
vec_ptype2.taxa_taxon(x, y, ..., x_arg = "", y_arg = "")

## S3 method for class 'vctrs_unspecified'
vec_ptype2.taxa_taxon(x, y, ...)

## S3 method for class 'taxa_taxon'
vec_ptype2.taxa_taxon(x, y, ...)

## S3 method for class 'character'
vec_ptype2.taxa_taxon(x, y, ...)

## S3 method for class 'taxa_taxon'
vec_ptype2.character(x, y, ...)

## S3 method for class 'factor'
vec_ptype2.taxa_taxon(x, y, ...)

## S3 method for class 'taxa_taxon'
vec_ptype2.factor(x, y, ...)

## S3 method for class 'taxa_taxon_authority'
vec_ptype2(x, y, ...)

## Default S3 method:
vec_ptype2.taxa_taxon_authority(x, y, ..., x_arg = "", y_arg = "")

## S3 method for class 'vctrs_unspecified'
vec_ptype2.taxa_taxon_authority(x, y, ...)

## S3 method for class 'taxa_taxon_authority'
vec_ptype2.taxa_taxon_authority(x, y, ...)

## S3 method for class 'character'
vec_ptype2.taxa_taxon_authority(x, y, ...)

## S3 method for class 'taxa_taxon_authority'
vec_ptype2.character(x, y, ...)

## S3 method for class 'factor'
vec_ptype2.taxa_taxon_authority(x, y, ...)

## S3 method for class 'taxa_taxon_authority'
vec_ptype2.factor(x, y, ...)

## S3 method for class 'taxa_taxon_db'
vec_ptype2(x, y, ...)

## Default S3 method:
vec_ptype2.taxa_taxon_db(x, y, ..., x_arg = "", y_arg = "")

## S3 method for class 'vctrs_unspecified'
vec_ptype2.taxa_taxon_db(x, y, ...)

## S3 method for class 'taxa_taxon_db'
vec_ptype2.taxa_taxon_db(x, y, ...)

## S3 method for class 'character'
vec_ptype2.taxa_taxon_db(x, y, ...)

## S3 method for class 'taxa_taxon_db'
vec_ptype2.character(x, y, ...)

## S3 method for class 'factor'
vec_ptype2.taxa_taxon_db(x, y, ...)

## S3 method for class 'taxa_taxon_db'
vec_ptype2.factor(x, y, ...)

## S3 method for class 'taxa_taxon_id'
vec_ptype2(x, y, ...)

## Default S3 method:
vec_ptype2.taxa_taxon_id(x, y, ..., x_arg = "", y_arg = "")

## S3 method for class 'vctrs_unspecified'
vec_ptype2.taxa_taxon_id(x, y, ...)

## S3 method for class 'taxa_taxon_id'
vec_ptype2.taxa_taxon_id(x, y, ...)

## S3 method for class 'character'
vec_ptype2.taxa_taxon_id(x, y, ...)

## S3 method for class 'taxa_taxon_id'
vec_ptype2.character(x, y, ...)

## S3 method for class 'factor'
vec_ptype2.taxa_taxon_id(x, y, ...)

## S3 method for class 'taxa_taxon_id'
vec_ptype2.factor(x, y, ...)

## S3 method for class 'taxa_taxon_rank'
vec_ptype2(x, y, ...)

## Default S3 method:
vec_ptype2.taxa_taxon_rank(x, y, ..., x_arg = "", y_arg = "")

## S3 method for class 'vctrs_unspecified'
vec_ptype2.taxa_taxon_rank(x, y, ...)

## S3 method for class 'taxa_taxon_rank'
vec_ptype2.taxa_taxon_rank(x, y, ...)

## S3 method for class 'character'
vec_ptype2.taxa_taxon_rank(x, y, ...)

## S3 method for class 'taxa_taxon_rank'
vec_ptype2.character(x, y, ...)

## S3 method for class 'factor'
vec_ptype2.taxa_taxon_rank(x, y, ...)

## S3 method for class 'taxa_taxon_rank'
vec_ptype2.factor(x, y, ...)

## S3 method for class 'taxa_taxon_rank_level'
vec_ptype2(x, y, ...)

## Default S3 method:
vec_ptype2.taxa_taxon_rank_level(x, y, ..., x_arg = "", y_arg = "")

## S3 method for class 'vctrs_unspecified'
vec_ptype2.taxa_taxon_rank_level(x, y, ...)

## S3 method for class 'taxa_taxon_rank_level'
vec_ptype2.taxa_taxon_rank_level(x, y, ...)

## S3 method for class 'character'
vec_ptype2.taxa_taxon_rank_level(x, y, ...)

## S3 method for class 'taxa_taxon_rank_level'
vec_ptype2.character(x, y, ...)

## S3 method for class 'taxa_taxonomy'
vec_ptype2(x, y, ...)

## Default S3 method:
vec_ptype2.taxa_taxonomy(x, y, ..., x_arg = "", y_arg = "")

## S3 method for class 'vctrs_unspecified'
vec_ptype2.taxa_taxonomy(x, y, ...)

## S3 method for class 'taxa_taxonomy'
vec_ptype2.taxa_taxonomy(x, y, ...)

## S3 method for class 'character'
vec_ptype2.taxa_taxonomy(x, y, ...)

## S3 method for class 'taxa_taxonomy'
vec_ptype2.character(x, y, ...)

## S3 method for class 'factor'
vec_ptype2.taxa_taxonomy(x, y, ...)

## S3 method for class 'taxa_taxonomy'
vec_ptype2.factor(x, y, ...)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
