<!DOCTYPE html><html><head><title>Help for package htsr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {htsr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#d_backup'><p>Backup a data base</p></a></li>
<li><a href='#d_compact'><p>Compact a data base</p></a></li>
<li><a href='#d_convert_hydraccess'><p>Convert a full Hydraccess database into a new htsr sqlite database (Windows only)</p></a></li>
<li><a href='#d_convert_meteofrance_d'><p>Convert a Meteo-France csv daily basic data file into a htsr sqlite base</p></a></li>
<li><a href='#d_convert_weewx'><p>Convert a weewx data base into a htsr sqlite base</p></a></li>
<li><a href='#d_create'><p>Create a data base</p></a></li>
<li><a href='#d_exp_discalib'><p>Export discharge measurements and calibrations from data base</p></a></li>
<li><a href='#d_imp_hts'><p>Import a hts file into a data base</p></a></li>
<li><a href='#d_rem_hts'><p>Remove hts records from a data base</p></a></li>
<li><a href='#d_table'><p>Create or remove a table of a htsr sqlite base</p></a></li>
<li><a href='#ds_exp_hts'><p>Extraction of a time-series from htsr data base</p></a></li>
<li><a href='#ds_inventory_sensor'><p>Inventory of a station sensors of an htsr data base</p></a></li>
<li><a href='#ds_inventory_station'><p>Inventory of the stations of an htsr data base</p></a></li>
<li><a href='#ds_sensor'><p>Create, Modify or Remove a sensor</p></a></li>
<li><a href='#ds_station'><p>Create, Modify or Remove a station</p></a></li>
<li><a href='#f_change_id'><p>Change Station id or Sensor id in a hts file</p></a></li>
<li><a href='#f_convert'><p>Convert an hts file in another format (xls, xlsx or csv) and vice-versa</p></a></li>
<li><a href='#f_csv_multivar'><p>Build a multivariable table file in csv format</p></a></li>
<li><a href='#f_month2day'><p>Interpolation of daily records from a monthly time series</p></a></li>
<li><a href='#f_properties'><p>Properties of a hts series</p></a></li>
<li><a href='#fc'><p>Short-cut for file.choose</p></a></li>
<li><a href='#h_addna'><p>Add NA values within a time series</p></a></li>
<li><a href='#h_adjust'><p>Adjust a time series to a statistical model</p></a></li>
<li><a href='#h_avday'><p>Daily average over a sequence of several years</p></a></li>
<li><a href='#h_changetz'><p>Change the time zone of a time series</p></a></li>
<li><a href='#h_common'><p>Extract 2 (or more) time-series on their common period</p></a></li>
<li><a href='#h_condition'><p>Conditional extraction of a time-series regarding another one</p></a></li>
<li><a href='#h_cumul'><p>Cumul of time-series</p></a></li>
<li><a href='#h_gaperr'><p>Replace errors with gaps in a time-series based on neighboring values</p></a></li>
<li><a href='#h_gapfill'><p>Simple gapfilling in a time-series</p></a></li>
<li><a href='#h_gaprem_itv'><p>Remove gaps in a time-series with a time interval threshold</p></a></li>
<li><a href='#h_nodata'><p>Replace values with NA conditionally or in a time interval</p></a></li>
<li><a href='#h_rainsnow'><p>Share the solid and liquid precipitations with a temperature criteria</p></a></li>
<li><a href='#h_rbind'><p>Bind 2 time-series on consecutive periods</p></a></li>
<li><a href='#h_replace'><p>Replace a value by another</p></a></li>
<li><a href='#h_restrict'><p>Restrict a series between 2 dates</p></a></li>
<li><a href='#h_rollav'><p>Rolling average of a daily time-series</p></a></li>
<li><a href='#h_season'><p>Seasonal selection</p></a></li>
<li><a href='#h_stat_basic'><p>Basic statistics of a time-series</p></a></li>
<li><a href='#h_substitute'><p>Subtitute the missing values in a series by existing values of another series</p></a></li>
<li><a href='#h_weightedsum'><p>Weighted sum of time-series</p></a></li>
<li><a href='#h_wl_di'><p>Computation of the discharges from water-levels</p></a></li>
<li><a href='#h_year'><p>Annual time series</p></a></li>
<li><a href='#hs_tstep'><p>hts time series with fixed timestep</p></a></li>
<li><a href='#htsr-package'><p>htsr: Hydro-Meteorology Time-Series</p></a></li>
<li><a href='#p_box_month'><p>Boxplot of the 12 months of a time-series.</p></a></li>
<li><a href='#p_clim'><p>Plot climatologies in hydrological year</p></a></li>
<li><a href='#p_discalib'><p>Plot calibration curves water levels vs discharges</p></a></li>
<li><a href='#p_gaps'><p>Plot of data inventory</p></a></li>
<li><a href='#p_hypso'><p>Plot the hypsometry curve of one or more basins</p></a></li>
<li><a href='#p_scatter'><p>Scatter plot of 2 or more time-series</p></a></li>
<li><a href='#p_wind'><p>Plot wind roses</p></a></li>
<li><a href='#ps_plothts'><p>Plot hts files</p></a></li>
<li><a href='#u_index'><p>Compute an index of community</p></a></li>
<li><a href='#u_timestep'><p>Compute values in a time-series with a fixed timestep</p></a></li>
<li><a href='#w_atmp_alt'><p>Compute atmospheric pressure, function of altitude</p></a></li>
<li><a href='#w_etp'><p>Compute the potential evapotranspiration with several methods</p></a></li>
<li><a href='#w_spechum2relhum'><p>Convert specific humidity to relative humidity</p></a></li>
<li><a href='#w_temp_alt'><p>Compute temperature, function of altitude</p></a></li>
<li><a href='#z_coord'><p>Coordinate utility</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hydro-Meteorology Time-Series</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Pierre Chevallier [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pierre Chevallier &lt;pierre.chevallier@mailo.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for the management and treatment of hydrology and 
  meteorology time-series stored in a 'Sqlite' data base.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, purrr, readr, tibble, lubridate, stringr, fs,
Rcpp, readxl, RSQLite, DBI, shiny, shinyFiles, waiter, WriteXLS</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, RODBC, openair, editData, terra,
directlabels</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/p-chevallier/htsr">https://github.com/p-chevallier/htsr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/p-chevallier/htsr/issues">https://github.com/p-chevallier/htsr/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-16 15:40:20 UTC; pierre</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-16 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='d_backup'>Backup a data base</h2><span id='topic+d_backup'></span>

<h3>Description</h3>

<p>Back a htsr sqlite data base
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_backup(fsq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_backup_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the data base</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A saved data base with extension .bak
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Jan 2019 / Nov 2020
</p>

<hr>
<h2 id='d_compact'>Compact a data base</h2><span id='topic+d_compact'></span>

<h3>Description</h3>

<p>Compact htsr sqlite data base
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_compact(fsq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_compact_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the data base</p>
</td></tr>
</table>


<h3>Value</h3>

<p>New data base or overwritten data base. Note that the created data base is empty.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Jan 2019
</p>

<hr>
<h2 id='d_convert_hydraccess'>Convert a full Hydraccess database into a new htsr sqlite database (Windows only)</h2><span id='topic+d_convert_hydraccess'></span>

<h3>Description</h3>

<p>Because the Hydraccess application only works into a Windows environment,
this function cannot be applied on other platforms (Mas OS or Linux). Additionally,
the R session must be configured in 32b (see the htsr-package vignette).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_convert_hydraccess(fsq, db.hydraccess)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_convert_hydraccess_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the sqlite data base</p>
</td></tr>
<tr><td><code id="d_convert_hydraccess_+3A_db.hydraccess">db.hydraccess</code></td>
<td>
<p>Full name of the hydraccess data base</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the specified sqlite data base already exists, a confirmation
is requested to overwrite it.
</p>
<p>An 32b ODBC Microsoft driver must be configured
in the &quot;administrative tools&quot; and installed for the
hydraccess data base. The correct functioning can be verified
using the sub-function u_test_rodbc (db.hydraccess),
which must be successful.
</p>


<h3>Value</h3>

<p>A new or a replaced sqlite htsr data base.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2018-Nov 2020
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ds_inventory_station">ds_inventory_station</a></code> and <code><a href="#topic+ds_inventory_sensor">ds_inventory_sensor</a></code> for displaying
the content of the sqlite data base;
<code><a href="#topic+ds_exp_hts">ds_exp_hts</a></code> for extracting a time-series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

d_import_hydraccess("foo.sqlite","foo.mdb")

## End(Not run)


</code></pre>

<hr>
<h2 id='d_convert_meteofrance_d'>Convert a Meteo-France csv daily basic data file into a htsr sqlite base</h2><span id='topic+d_convert_meteofrance_d'></span>

<h3>Description</h3>

<p>Convert a Meteo-France csv daily data file into a htsr sqlite base. It regards
the &quot;basic&quot; data file, which includes precipitation, temperature and wind data. For other
variables the function d_convert_meteofrance_d1 shall be used with the corresponding csv file.
The csv file shall be downloaded from https://meteo.data.gouv.fr/
The name of the created sqlite file is the same as the csv file with an extension .sqlite.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_convert_meteofrance_d(fmeteo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_convert_meteofrance_d_+3A_fmeteo">fmeteo</code></td>
<td>
<p>Full name of the Meteo-France csv file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sensors have an additional prefix d (as daily) in order to distinguish them from sensors with another
time reference.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - dec 2023 - jan 2024
</p>

<hr>
<h2 id='d_convert_weewx'>Convert a weewx data base into a htsr sqlite base</h2><span id='topic+d_convert_weewx'></span>

<h3>Description</h3>

<p>Convert (or update) a weewx data base into a htsr sqlite base
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_convert_weewx(db.weewx, fsq = NA, update = TRUE, sta = NA, name_st = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_convert_weewx_+3A_db.weewx">db.weewx</code></td>
<td>
<p>Full name of the weewx data base</p>
</td></tr>
<tr><td><code id="d_convert_weewx_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the htsr data base</p>
</td></tr>
<tr><td><code id="d_convert_weewx_+3A_update">update</code></td>
<td>
<p>(default = TRUE)</p>
</td></tr>
<tr><td><code id="d_convert_weewx_+3A_sta">sta</code></td>
<td>
<p>Station id (default = NA)</p>
</td></tr>
<tr><td><code id="d_convert_weewx_+3A_name_st">name_st</code></td>
<td>
<p>Station name (default = NA)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If update is TRUE, sta and name_st are unnecessary. I update is FALSE and
fsq is NA, fsq is named &quot;weewx.sqlite&quot;.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Feb 2018 - Sep 2023
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

d_convert_weewx("weewx.sql", "foo.sqlite")

## End(Not run)

</code></pre>

<hr>
<h2 id='d_create'>Create a data base</h2><span id='topic+d_create'></span>

<h3>Description</h3>

<p>Create htsr sqlite data base
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_create(fsq, cr_table = TRUE, bku = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_create_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the data base</p>
</td></tr>
<tr><td><code id="d_create_+3A_cr_table">cr_table</code></td>
<td>
<p>Create the basis tables : TRUE (default), FALSE</p>
</td></tr>
<tr><td><code id="d_create_+3A_bku">bku</code></td>
<td>
<p>Operate a backup if fsq exists : TRUE (default) / FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the data base already exists and bku is TRUE, a backup is
automatically generated.
</p>
<p>If cr_table is TRUE, The following tables are also created:
ST (stations), SS (sensors), WL (water levels), DI (discharges), PR
(Precipitations), WE (weather) and QU (quality)
</p>


<h3>Value</h3>

<p>a new data base
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Jan 2019
</p>

<hr>
<h2 id='d_exp_discalib'>Export discharge measurements and calibrations from data base</h2><span id='topic+d_exp_discalib'></span>

<h3>Description</h3>

<p>Export discharge measurements and calibrations from data base
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_exp_discalib(fsq, sta, calib = TRUE, dism = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_exp_discalib_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the data base</p>
</td></tr>
<tr><td><code id="d_exp_discalib_+3A_sta">sta</code></td>
<td>
<p>Station Id.</p>
</td></tr>
<tr><td><code id="d_exp_discalib_+3A_calib">calib</code></td>
<td>
<p>Calibration extraction TRUE (default)/FALSE</p>
</td></tr>
<tr><td><code id="d_exp_discalib_+3A_dism">dism</code></td>
<td>
<p>Discharge measurement extraction TRUE (default)/FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of 2 tibbles, one with the calibration table and one with the discharge measurements
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Sep 2017 - Nov 2020
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ds_exp_hts">ds_exp_hts</a></code> for export time-series
</p>

<hr>
<h2 id='d_imp_hts'>Import a hts file into a data base</h2><span id='topic+d_imp_hts'></span>

<h3>Description</h3>

<p>Import a hts file into a tshm sqlite base
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_imp_hts(fsq, filein, table, bku = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_imp_hts_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the data base</p>
</td></tr>
<tr><td><code id="d_imp_hts_+3A_filein">filein</code></td>
<td>
<p>Full name of hts file to import</p>
</td></tr>
<tr><td><code id="d_imp_hts_+3A_table">table</code></td>
<td>
<p>Table</p>
</td></tr>
<tr><td><code id="d_imp_hts_+3A_bku">bku</code></td>
<td>
<p>Automatic Backup TRUE (default) / FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main table where the data have to be imported must be selected with one of the
following abbreviation: WL (water level), DI (discharge), WE (weather), PR (precipitation)
or QU (quality)
If records already exist during the same interval, they are removed and replaced.
</p>


<h3>Value</h3>

<p>Actualized data base
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - jan 2019-jan 2024
</p>

<hr>
<h2 id='d_rem_hts'>Remove hts records from a data base</h2><span id='topic+d_rem_hts'></span>

<h3>Description</h3>

<p>Remove hts records from a Sqlite base
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_rem_hts(fsq, table, sta, sen, start, end)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_rem_hts_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the data base</p>
</td></tr>
<tr><td><code id="d_rem_hts_+3A_table">table</code></td>
<td>
<p>Table</p>
</td></tr>
<tr><td><code id="d_rem_hts_+3A_sta">sta</code></td>
<td>
<p>Station id</p>
</td></tr>
<tr><td><code id="d_rem_hts_+3A_sen">sen</code></td>
<td>
<p>Sensor id</p>
</td></tr>
<tr><td><code id="d_rem_hts_+3A_start">start</code></td>
<td>
<p>Start time of removed records</p>
</td></tr>
<tr><td><code id="d_rem_hts_+3A_end">end</code></td>
<td>
<p>End time of removed records</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main table where the data have to be removed must be selected with one the
following abbreviation: WL (water level), DI (discharge), WE (weather), PR (precipitation)
or QU (quality)
</p>


<h3>Value</h3>

<p>Actualized data base
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - jan 2019 - dec 2022
</p>

<hr>
<h2 id='d_table'>Create or remove a table of a htsr sqlite base</h2><span id='topic+d_table'></span>

<h3>Description</h3>

<p>The function allows to create or remove of a tshm sqlite base. If
the base doesn't exist, it is created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_table(fsq, table, op = "C", bku = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_table_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the data base</p>
</td></tr>
<tr><td><code id="d_table_+3A_table">table</code></td>
<td>
<p>Table name</p>
</td></tr>
<tr><td><code id="d_table_+3A_op">op</code></td>
<td>
<p>Create (default) or Remove C/R</p>
</td></tr>
<tr><td><code id="d_table_+3A_bku">bku</code></td>
<td>
<p>Automatic Backup TRUE (default) / FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible table names : ST (Stations), SS (Sensors), WL (Water levels), DI (Discharges),
WE, (Weather), PR (Precipitations), QU (Quality)
</p>


<h3>Value</h3>

<p>Table created or removed
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Jan-Feb 2018
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+ds_inventory_station">ds_inventory_station</a></code> and <code><a href="#topic+ds_inventory_station">ds_inventory_station</a></code> to list the content of the base ;
</p>
</li>
<li> <p><code><a href="#topic+ds_exp_hts">ds_exp_hts</a></code> to extract a time-series
</p>
</li></ul>


<hr>
<h2 id='ds_exp_hts'>Extraction of a time-series from htsr data base</h2><span id='topic+ds_exp_hts'></span>

<h3>Description</h3>

<p>The function display a web page allowing to extract a time-series in the &quot;hts&quot; format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ds_exp_hts()
</code></pre>


<h3>Details</h3>

<p>Complete the requested information in the left panel, then press the submit button in
order to extract the file. If you want to display the plot of the extracted file,
choose &quot;line&quot; or &quot;bar&quot; and press the plot button.
</p>
<p>When the subfunction &quot;d_exp_hts(fsq, sta,sen,rtime=FALSE,dstart=NA,dend=NA, rplot=FALSE)&quot;
is used solely it returns a tibble tstab with 4 columns Date, Value, Station, Sensor.
In this last subfunction fsq is the sqlite data base; sta, the station id, sen, the sensor id; rtime, dstart and
dend define a time interval; rplot, the resulted plot.
</p>


<h3>Value</h3>

<p>The function returns a file (nomfic) with the following name: &lt;sensor.id&gt;_&lt;station.id&gt;.hts
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017 - Sep 2023
</p>

<hr>
<h2 id='ds_inventory_sensor'>Inventory of a station sensors of an htsr data base</h2><span id='topic+ds_inventory_sensor'></span>

<h3>Description</h3>

<p>The function display a web page in order to produce an inventory of the
sensors for a selected station in an htsr data base.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ds_inventory_sensor()
</code></pre>


<h3>Details</h3>

<p>Complete the requested information in the left panel, then press the submit button.
When finished press &quot;done&quot;.
</p>
<p>If &quot;Output format&quot; is &quot;none&quot;, the results are displayed on the screen, If it is &quot;xlsx&quot;,
or &quot;csv&quot; (, as separator) or &quot;csv2&quot; (; as separator), the corresponding file
with a sensor list is written.
</p>


<h3>Value</h3>

<p>A table with the inventory of sensors of a selected station in the data base.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier  - Jan 2024
</p>

<hr>
<h2 id='ds_inventory_station'>Inventory of the stations of an htsr data base</h2><span id='topic+ds_inventory_station'></span>

<h3>Description</h3>

<p>The function display a web page in order to produce an inventory of the
stations in an htsr data base.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ds_inventory_station()
</code></pre>


<h3>Details</h3>

<p>Complete the requested information in the left panel, then press the submit button.
When finished press &quot;done&quot;.
</p>
<p>If &quot;Output format&quot; is &quot;none&quot;, the results are displayed on the screen, If it is &quot;xlsx&quot;,
or &quot;csv&quot; (, as separator) or &quot;csv2&quot; (; as separator), the corresponding file
with a station list is written.
</p>


<h3>Value</h3>

<p>A table with the inventory of stations in the data base.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Dec 2023
</p>

<hr>
<h2 id='ds_sensor'>Create, Modify or Remove a sensor</h2><span id='topic+ds_sensor'></span>

<h3>Description</h3>

<p>Create, Modify or Remove a sensor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ds_sensor()
</code></pre>


<h3>Details</h3>

<p>If operation is Create, the fields Station, Table and Sensor are compulsory and cannot be modified afterwards.
</p>
<p>Allowed entries for table are: WL (water levels), DI (discharges),
QU (Quality), PR (precipitations), WE (weather).
</p>
<p>If op is Create or Modify, the following text fields can be completed optionally: Nature,
Description, Comment.
</p>
<p>If op is Remove, all data corresponding to the sensor of the selected
station are removed.
</p>
<p>The data base is automatically backuped before any operation.
</p>


<h3>Value</h3>

<p>Sensor created, modified or removed from the data base
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Feb 2018-Sep 2023
</p>

<hr>
<h2 id='ds_station'>Create, Modify or Remove a station</h2><span id='topic+ds_station'></span>

<h3>Description</h3>

<p>Create, Modify or Remove a station.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ds_station()
</code></pre>


<h3>Details</h3>

<p>If operation is Create, the fields Id_Station, Type_Station and
Name (name_st) are compulsory. The field Name can be modified afterwards.
</p>
<p>If op is Create or Modify the following fields can be completed optionnaly: Country,
Zone, Sub-zone, Large basin, Basin, Small basin, River, Longitude, Latitude,
Altitude, Basin area, Manager.
</p>
<p>If op is Modify, station type and station id cannot be modified. The sensors and
data corresponding to the station are conserved.
</p>
<p>If op is Remove, all data and sensors of the station are removed.
</p>


<h3>Value</h3>

<p>Station created, modified ou removed from the data base
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Jan 2018 - Sep 2023
</p>

<hr>
<h2 id='f_change_id'>Change Station id or Sensor id in a hts file</h2><span id='topic+f_change_id'></span>

<h3>Description</h3>

<p>The function changes the station and/or the sensor id of a hts file.
The new file is renamed with the new ids and a prefix n_: nw_&lt;sensor.id&gt;_&lt;station.id&gt;.hts, BUT the
eventual prefixes or suffixes of the original name are not conserved.
The original file is not removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_change_id(file, sta = NA, sen = NA, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_change_id_+3A_file">file</code></td>
<td>
<p>file to proceed</p>
</td></tr>
<tr><td><code id="f_change_id_+3A_sta">sta</code></td>
<td>
<p>new station id (default: NA)</p>
</td></tr>
<tr><td><code id="f_change_id_+3A_sen">sen</code></td>
<td>
<p>new sensor id (default: NA)</p>
</td></tr>
<tr><td><code id="f_change_id_+3A_overwrite">overwrite</code></td>
<td>
<p>TRUE / FALSE (default) if the output file exists</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2017-Jan 2019
</p>

<hr>
<h2 id='f_convert'>Convert an hts file in another format (xls, xlsx or csv) and vice-versa</h2><span id='topic+f_convert'></span>

<h3>Description</h3>

<p>Converter in formats hts, xls, xlsx and text (csv et csv2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_convert(file, form_start = "hts", form_end = "xlsx")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_convert_+3A_file">file</code></td>
<td>
<p>Hts file</p>
</td></tr>
<tr><td><code id="f_convert_+3A_form_start">form_start</code></td>
<td>
<p>Initial format (&quot;hts&quot; (default) or &quot;xls&quot; or
&quot;xlsx&quot;)</p>
</td></tr>
<tr><td><code id="f_convert_+3A_form_end">form_end</code></td>
<td>
<p>Final format (&quot;hts&quot; or &quot;xls&quot; or
&quot;xlsx&quot; (default) or &quot;csv&quot; (separator , &amp; decimal .)
or &quot;csv2&quot; (separator ; and decimal ,)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'form_start' = csv or csv2 is for instance not accepted. It could be converted previously
in xls or xlsx format.
</p>


<h3>Value</h3>

<p>A file in the requested format with 4 columns: Date, Value,
Station, Sensor
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - October 2017 - May 2022
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
f_convert(file,  "xlsx", "hts")

## End(Not run)

</code></pre>

<hr>
<h2 id='f_csv_multivar'>Build a multivariable table file in csv format</h2><span id='topic+f_csv_multivar'></span>

<h3>Description</h3>

<p>Build a multivariable table file in csv format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_csv_multivar(files, daily = TRUE, fileo = "fileo")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_csv_multivar_+3A_files">files</code></td>
<td>
<p>list of hts files</p>
</td></tr>
<tr><td><code id="f_csv_multivar_+3A_daily">daily</code></td>
<td>
<p>default = TRUE</p>
</td></tr>
<tr><td><code id="f_csv_multivar_+3A_fileo">fileo</code></td>
<td>
<p>name of the output file (without extension)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function build a cvs file with values extracted from several hts files at the same date. 
So, it's better to run 'h_common' before to apply 'f_csv_multivar'
</p>
<p>If daily is TRUE, only the date is taking into account, not the time.
</p>


<h3>Value</h3>

<p>A csv table, where the first field is a date and the next fields values
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Jan-Feb 2022
</p>

<hr>
<h2 id='f_month2day'>Interpolation of daily records from a monthly time series</h2><span id='topic+f_month2day'></span>

<h3>Description</h3>

<p>Interpolation of daily records from a monthly time-series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_month2day(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_month2day_+3A_file">file</code></td>
<td>
<p>monthly time series to process</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function build and interpolated daily time-series from a monthly one. The 
daily values are linearly computed between two consecutive monthly values.
</p>


<h3>Value</h3>

<p>a daily time series
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - dec 2022
</p>

<hr>
<h2 id='f_properties'>Properties of a hts series</h2><span id='topic+f_properties'></span>

<h3>Description</h3>

<p>The function provides the properties of a time-series, its duration and
the inventory of its gaps
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_properties(file, gaps = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_properties_+3A_file">file</code></td>
<td>
<p>: file to be analyzed</p>
</td></tr>
<tr><td><code id="f_properties_+3A_gaps">gaps</code></td>
<td>
<p>: produce a file with a table of the gaps: TRUE / FALSE (default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If gaps = TRUE, a file is produced, with the same name of file and the extension .gap.
It contents a table with the gaps of the series and allows to build a plot with the
function <code><a href="#topic+p_gaps">p_gaps</a></code>.
</p>


<h3>Value</h3>

<p>Basic infos on a hts time-series
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Jan 2019 - Oct 2021
</p>


<h3>See Also</h3>

<p><code><a href="#topic+p_gaps">p_gaps</a></code>.
</p>

<hr>
<h2 id='fc'>Short-cut for file.choose</h2><span id='topic+fc'></span>

<h3>Description</h3>

<p>Short-cut for file.choose
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fc()
</code></pre>


<h3>Value</h3>

<p>A filename
</p>


<h3>Author(s)</h3>

<p>P. Chevallier
</p>

<hr>
<h2 id='h_addna'>Add NA values within a time series</h2><span id='topic+h_addna'></span>

<h3>Description</h3>

<p>Add NA values within a time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_addna(file, add)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_addna_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_addna_+3A_add">add</code></td>
<td>
<p>List of dates with NA values to be added</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function adds records with NA in a time series at given dates. 
If the date already exists, the value is replaced by NA
</p>
<p>The output file is named with a nap_ prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - November 2022
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

f &lt;- h_addna (f, add = c("2021-01-01 12:00:00 UTC", "2031-01-01 12:00:00 UTC"))

## End(Not run)

</code></pre>

<hr>
<h2 id='h_adjust'>Adjust a time series to a statistical model</h2><span id='topic+h_adjust'></span>

<h3>Description</h3>

<p>Adjust a time series to a statistical model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_adjust(file, time_unit = "year")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_adjust_+3A_file">file</code></td>
<td>
<p>File to proceed</p>
</td></tr>
<tr><td><code id="h_adjust_+3A_time_unit">time_unit</code></td>
<td>
<p>to be chosen in: &quot;100y&quot;, &quot;year&quot;, &quot;month&quot;, &quot;day&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function adjust a time series with a statistical model. For instance
it works only with a linear model.
</p>
<p>&quot;year&quot; corresponds to an average year of 365.25 days and month to an average month of 30,4575 days.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - January 2024
</p>

<hr>
<h2 id='h_avday'>Daily average over a sequence of several years</h2><span id='topic+h_avday'></span>

<h3>Description</h3>

<p>Daily average over a sequence of several years
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_avday(file, start = NA, end = NA, mhy = 1, precip = FALSE, dig = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_avday_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_avday_+3A_start">start</code></td>
<td>
<p>Starting date (default = NA)</p>
</td></tr>
<tr><td><code id="h_avday_+3A_end">end</code></td>
<td>
<p>Ending date (default = NA)</p>
</td></tr>
<tr><td><code id="h_avday_+3A_mhy">mhy</code></td>
<td>
<p>Starting month of the hydrological year (default = 1)</p>
</td></tr>
<tr><td><code id="h_avday_+3A_precip">precip</code></td>
<td>
<p>Precipitation time series (default = FALSE)</p>
</td></tr>
<tr><td><code id="h_avday_+3A_dig">dig</code></td>
<td>
<p>Number of significant digits for Value (default = 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function means the values of each calendar day over a period larger 
than 4 years (i.e. it includes at least one Feb 29 day). The result is transfered
to the last possible hydrological year of the interval.
</p>
<p>In the special case of precipitation, where the distribution is discontinuous 
over time, the original values of the last hydrological year are replaced by values 
corrected proportionately.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2022
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

f &lt;- h_avday(f,   start=NA, end=NA, mhy=10, precip=TRUE, dig=1)

## End(Not run)

</code></pre>

<hr>
<h2 id='h_changetz'>Change the time zone of a time series</h2><span id='topic+h_changetz'></span>

<h3>Description</h3>

<p>Change the time zone of a time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_changetz(file, tz1 = "UTC", tz2 = "Europe/Paris")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_changetz_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_changetz_+3A_tz1">tz1</code></td>
<td>
<p>original time zone (default = &quot;UTC&quot;)</p>
</td></tr>
<tr><td><code id="h_changetz_+3A_tz2">tz2</code></td>
<td>
<p>new time zone (default = &quot;Europe/Paris&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output file is named with a tz prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - June 2023
</p>

<hr>
<h2 id='h_common'>Extract 2 (or more) time-series on their common period</h2><span id='topic+h_common'></span>

<h3>Description</h3>

<p>The fonction extract the data of 2 (or more) hts time-series
for the common date/time records (precision of the second).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_common(files)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_common_+3A_files">files</code></td>
<td>
<p>List of file names to process.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hts files resulting of the operation; their names are composed as:
co_&lt;original filename&gt;
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017 - Oct 2023
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
f &lt;- h_common(files = c("foo1.hts","foo2.hts"))

## End(Not run)
</code></pre>

<hr>
<h2 id='h_condition'>Conditional extraction of a time-series regarding another one</h2><span id='topic+h_condition'></span>

<h3>Description</h3>

<p>The series to proceed is the first of the list, the conditional series
the second. Only the common record dates are kept.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_condition(files, condition)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_condition_+3A_files">files</code></td>
<td>
<p>Liste de 2 file names</p>
</td></tr>
<tr><td><code id="h_condition_+3A_condition">condition</code></td>
<td>
<p>Liste 3 objects : oper (&quot;sup&quot; or &quot;inf&quot; or &quot;between&quot;),
thrhd1 &lt; thrhd2 ; default is c(&quot;inf&quot;,0,NA)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the condition on the file 2 value is not respected, the value of
file 1 is changed as NA.
</p>
<p>The condition has 3 options : x&lt; (&quot;inf&quot;), x&gt;= (&quot;sup&quot;), &lt; x &lt;=
(&quot;between&quot;). In case of error or by default, &quot;inf&quot; is considered.
In the cases &quot;inf&quot; and &quot;sup&quot;, only one threshold is used (thrhd1) ;
in the case &quot;between&quot;, two thresholds are needed (thrhd1 &lt; thrhd2).
</p>
<p>The output file is the name of the fist file with a cd_ prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017-Jan 2019
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

f &lt;- h_condition(c(f1,f2), c("between", O, 2))

## End(Not run)

</code></pre>

<hr>
<h2 id='h_cumul'>Cumul of time-series</h2><span id='topic+h_cumul'></span>

<h3>Description</h3>

<p>The function returns a time-series of cumulated values. If the value
is negative, the absolute value is taken.
It is possible to limit the computation time interval. NA values are ignored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_cumul(file, start = NA, end = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_cumul_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_cumul_+3A_start">start</code></td>
<td>
<p>Start date, default = NA</p>
</td></tr>
<tr><td><code id="h_cumul_+3A_end">end</code></td>
<td>
<p>End date, default NA</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output file is named with a cu_ prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017-Jan 2019
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

f &lt;- h_cumul(f, start="2012-1-1", end = "2013-1-1")

## End(Not run)

</code></pre>

<hr>
<h2 id='h_gaperr'>Replace errors with gaps in a time-series based on neighboring values</h2><span id='topic+h_gaperr'></span>

<h3>Description</h3>

<p>Replace errors with gaps in a time-series based on neighboring values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_gaperr(file, nv = 1, itv0 = 43201, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_gaperr_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_gaperr_+3A_nv">nv</code></td>
<td>
<p>Number of below and above neighboring values to take into account,
default = 1</p>
</td></tr>
<tr><td><code id="h_gaperr_+3A_itv0">itv0</code></td>
<td>
<p>Threshold of minimum time gap (see function h_gaprem_itv)</p>
</td></tr>
<tr><td><code id="h_gaperr_+3A_df">df</code></td>
<td>
<p>Deviation value factor for testing if a value is correct or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Replace errors with gaps in a time-series based on neighboring values
</p>


<h3>Value</h3>

<p>a time-series file with the prefix eg_
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2019
</p>

<hr>
<h2 id='h_gapfill'>Simple gapfilling in a time-series</h2><span id='topic+h_gapfill'></span>

<h3>Description</h3>

<p>Simple gapfilling in a time-series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_gapfill(file, npdt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_gapfill_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_gapfill_+3A_npdt">npdt</code></td>
<td>
<p>Number of time-steps</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Replace the missing values with the linear interpolated value within the gap
interval, when the time interval is less than a number of fixed time steps.
</p>
<p>CAUTION! this operation is only possible when the time-series has a fixed time-step.
</p>


<h3>Value</h3>

<p>a time-series file with the prefix gf_
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2017 - Nov 2021
</p>

<hr>
<h2 id='h_gaprem_itv'>Remove gaps in a time-series with a time interval threshold</h2><span id='topic+h_gaprem_itv'></span>

<h3>Description</h3>

<p>Remove gaps in a time-series with a time interval threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_gaprem_itv(file, itv0 = 43201)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_gaprem_itv_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_gaprem_itv_+3A_itv0">itv0</code></td>
<td>
<p>Time threshold in seconds, default = 43201 (i.e 12 hours)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Remove the missing values when the time interval between the previous
and the next record is less than a fixed threshold
</p>


<h3>Value</h3>

<p>a time-series file with the prefix gr_
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2019
</p>

<hr>
<h2 id='h_nodata'>Replace values with NA conditionally or in a time interval</h2><span id='topic+h_nodata'></span>

<h3>Description</h3>

<p>Replace values with NA conditionally or in a time interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_nodata(file, threshold = NA, test = "=", start = NA, end = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_nodata_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_nodata_+3A_threshold">threshold</code></td>
<td>
<p>Threshold value (default = NA)</p>
</td></tr>
<tr><td><code id="h_nodata_+3A_test">test</code></td>
<td>
<p>Test &quot;=&quot; (default);&quot;&lt;&quot;;&quot;&lt;=&quot;;&quot;&gt;&quot;;&quot;&gt;=&quot;</p>
</td></tr>
<tr><td><code id="h_nodata_+3A_start">start</code></td>
<td>
<p>Start date/time (included) of POSIXct class (default = NA)</p>
</td></tr>
<tr><td><code id="h_nodata_+3A_end">end</code></td>
<td>
<p>End date/time (excluded) of POSIXct class (default = NA)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function replace values with NA conditionally or introduce a gap for a given interval.
</p>
<p>For the conditional option, the start parameter must be NA. A conditional test is applied on
the values (= ; &gt; ; &gt;= ; &lt; ; &lt;=) with a fixed threshold returning NA if the test is verified.
</p>
<p>For the gap option, the threshold parameter must be NA. All the values of the records within the
interval start end are replaces by NA.
</p>
<p>CAUTION ! At least one of both parameters threshold or start must not be NA.
NA.
</p>
<p>The output file is named with a na_ prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017-Jan 2019
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

f &lt;- h_nodata(f, threshold=10., test= "&lt;=", start=NA)

## End(Not run)

</code></pre>

<hr>
<h2 id='h_rainsnow'>Share the solid and liquid precipitations with a temperature criteria</h2><span id='topic+h_rainsnow'></span>

<h3>Description</h3>

<p>The precipitations are shared with a linear bevel between two temperature
values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_rainsnow(fpr, fta, ta0, ta1, sta = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_rainsnow_+3A_fpr">fpr</code></td>
<td>
<p>Precipitation file name</p>
</td></tr>
<tr><td><code id="h_rainsnow_+3A_fta">fta</code></td>
<td>
<p>Temperature file name</p>
</td></tr>
<tr><td><code id="h_rainsnow_+3A_ta0">ta0</code></td>
<td>
<p>Low temperature threshold</p>
</td></tr>
<tr><td><code id="h_rainsnow_+3A_ta1">ta1</code></td>
<td>
<p>High temperature threshold</p>
</td></tr>
<tr><td><code id="h_rainsnow_+3A_sta">sta</code></td>
<td>
<p>Station id. (default = NA)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two time-series must be previously restricted to the same interval of time.
</p>
<p>The two temperature thresholds can be equal.
</p>
<p>The temperature time-series must be complete with no gap. Gaps are allowed
in the precipitation time-series.
</p>
<p>Is the station id is NA, the station id of the file fta is used.
</p>


<h3>Value</h3>

<p>2 hts files, one with the liquid precipitation (prefix rn_) and one with
the solid precipitation (prefix sn_).
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017- Feb 2019
</p>

<hr>
<h2 id='h_rbind'>Bind 2 time-series on consecutive periods</h2><span id='topic+h_rbind'></span>

<h3>Description</h3>

<p>The fonction binds the data of 2 hts time-series
for consecutive date/time records (precision of the second) of the same station.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_rbind(files, sensor = "NewS", gap = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_rbind_+3A_files">files</code></td>
<td>
<p>List of char, File names to process.</p>
</td></tr>
<tr><td><code id="h_rbind_+3A_sensor">sensor</code></td>
<td>
<p>New sensor name of the resulting hts file (default =&quot;NewS&quot;)</p>
</td></tr>
<tr><td><code id="h_rbind_+3A_gap">gap</code></td>
<td>
<p>Introduce or not a gap between both series (default = TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the list, the files must be ordered from the oldest to the newest.
If gap is TRUE, a gap is introduced between both series.
</p>


<h3>Value</h3>

<p>hts file resulting of the operation; its names are composed as:
&lt;sensor&gt;_&lt;station&gt;.hts, with the prefix na, if a gap has been introduced.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Mar-Nov 2020
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

f &lt;- h_bind(files = c("foo1.hts","foo2.hts"), sensor = "NewOne")

## End(Not run)

</code></pre>

<hr>
<h2 id='h_replace'>Replace a value by another</h2><span id='topic+h_replace'></span>

<h3>Description</h3>

<p>Replace a value by another
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_replace(file, old.val, new.val)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_replace_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_replace_+3A_old.val">old.val</code></td>
<td>
<p>Value to be replaced</p>
</td></tr>
<tr><td><code id="h_replace_+3A_new.val">new.val</code></td>
<td>
<p>New value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output file is named with a re_ prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017- Nov 2020
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

f &lt;- ts_remplace_ts(f,  NA, 0)

## End(Not run)

</code></pre>

<hr>
<h2 id='h_restrict'>Restrict a series between 2 dates</h2><span id='topic+h_restrict'></span>

<h3>Description</h3>

<p>Restrict a series between 2 dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_restrict(file, start = NA, end = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_restrict_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_restrict_+3A_start">start</code></td>
<td>
<p>Start date/time (included) of POSIXct class (default = NA)</p>
</td></tr>
<tr><td><code id="h_restrict_+3A_end">end</code></td>
<td>
<p>End date/time (excluded) of POSIXct class (default = NA)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output file is named with a rs_ prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2017-Jan 2019
</p>

<hr>
<h2 id='h_rollav'>Rolling average of a daily time-series</h2><span id='topic+h_rollav'></span>

<h3>Description</h3>

<p>The function compute a rollong average of daily time-series values.
NA values are removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_rollav(file, ti = 7, position = "central")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_rollav_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_rollav_+3A_ti">ti</code></td>
<td>
<p>Time interval of computation in days (default = 7)</p>
</td></tr>
<tr><td><code id="h_rollav_+3A_position">position</code></td>
<td>
<p>Position &quot;central&quot; or &quot;right&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output file is named with a ro_ prefix. The computation can considers
the values before and after the current time step (position = &quot;central&quot;) or the values
before the current time step. If the position is &quot;central&quot;, the position must be an
odd integer.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Apr 2020
</p>

<hr>
<h2 id='h_season'>Seasonal selection</h2><span id='topic+h_season'></span>

<h3>Description</h3>

<p>The function provides seasonal time-series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_season(file, monthstart)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_season_+3A_file">file</code></td>
<td>
<p>Full file name to proceed</p>
</td></tr>
<tr><td><code id="h_season_+3A_monthstart">monthstart</code></td>
<td>
<p>List of 2 to 4 integers (between 1 and 12) giving the starting
month of each season.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>2 to 4 seasons can be selected. For each season, the prefix sx_ where x is the season
is added to the file name.
</p>


<h3>Value</h3>

<p>list of file names for each seasonal time-series.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017 - Mar 2020
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

files &lt;- h_season("foo.hts", monthstart=c(3,6,9,12))

## End(Not run)

</code></pre>

<hr>
<h2 id='h_stat_basic'>Basic statistics of a time-series</h2><span id='topic+h_stat_basic'></span>

<h3>Description</h3>

<p>Compute the main statistic parameters of a time-series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_stat_basic(files)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_stat_basic_+3A_files">files</code></td>
<td>
<p>vector of file names to process</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with the basic stats of the files.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017 - Feb 2022
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
simplestat &lt;- h_stat_basic(c("foo1.hts", "foo2.hts")

## End(Not run)

</code></pre>

<hr>
<h2 id='h_substitute'>Subtitute the missing values in a series by existing values of another series</h2><span id='topic+h_substitute'></span>

<h3>Description</h3>

<p>The series to proceed (first in file list) contents missing values or gaps
to be replaced by those of the second series (second in file list).
</p>
<p>The function only works on the common dates of both series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_substitute(files)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_substitute_+3A_files">files</code></td>
<td>
<p>List of two file names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output file is named with a sb_ prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Feb 2017 - Mar 2020
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

f &lt;- h_substitute(c(f1, f2))

## End(Not run)

</code></pre>

<hr>
<h2 id='h_weightedsum'>Weighted sum of time-series</h2><span id='topic+h_weightedsum'></span>

<h3>Description</h3>

<p>The function only works on the common period of the files without NA values. It
operates weighted sums on one or several time-series. It is also possible to add a constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_weightedsum(files, weights, constant = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_weightedsum_+3A_files">files</code></td>
<td>
<p>List of file names to proceed</p>
</td></tr>
<tr><td><code id="h_weightedsum_+3A_weights">weights</code></td>
<td>
<p>List of weights (must have the same length as files)</p>
</td></tr>
<tr><td><code id="h_weightedsum_+3A_constant">constant</code></td>
<td>
<p>Constant to add (default = 0)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For averaging n time-series one can use n weights wit a value of 1/n and constant = 0.
</p>


<h3>Value</h3>

<p>The function returns
+ n hts files with the extracted common period
+ 1 hts file named as the first file of the list
with the prefix w_. The sensor id is automatically set to &quot;weighted&quot;.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017-Oct 2021
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# choose time-series f1, f2, f3
f1 &lt;- "foo1.hts" ; f2 &lt;- "foo2.hts" ; f3 &lt;- "foo3.hts"
# the new f time-series contains records f[i] = f1[i] - (0.5 * f2[i]) + (0.5 * f3[i]) + 5
f &lt;- h_weightedsum(c(f1,f2,f3), c(1,-0.5,0.5)), 5)
# the new f time-series contains records f[i] = (1.12 * f1[i]) + 3
f &lt;- h_weightedsum(f1, 1.12, 3)

## End(Not run)

</code></pre>

<hr>
<h2 id='h_wl_di'>Computation of the discharges from water-levels</h2><span id='topic+h_wl_di'></span>

<h3>Description</h3>

<p>Computes a discharge time-series from water levels data and calibration curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_wl_di(fsq, sta, seni, seno, dstart = NA, dend = NA, dbo = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_wl_di_+3A_fsq">fsq</code></td>
<td>
<p>htsr data base</p>
</td></tr>
<tr><td><code id="h_wl_di_+3A_sta">sta</code></td>
<td>
<p>Station Id.</p>
</td></tr>
<tr><td><code id="h_wl_di_+3A_seni">seni</code></td>
<td>
<p>Input sensor Id (water levels)</p>
</td></tr>
<tr><td><code id="h_wl_di_+3A_seno">seno</code></td>
<td>
<p>Output sensor Id (discharges)</p>
</td></tr>
<tr><td><code id="h_wl_di_+3A_dstart">dstart</code></td>
<td>
<p>Start date (NA by default)</p>
</td></tr>
<tr><td><code id="h_wl_di_+3A_dend">dend</code></td>
<td>
<p>End date (NA by default)</p>
</td></tr>
<tr><td><code id="h_wl_di_+3A_dbo">dbo</code></td>
<td>
<p>Includes the result in the data base (TRUE by default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calibration curves must exist in the data base.
</p>
<p>If 'dbo' is TRUE, a discharge table &quot;DI&quot; and the sensor 'seno'
must exist in the data base. The new discharge time-series overwrites the already existing data ; however, it is
asked to confirm the operation. In any case the data base is previously backed up.
</p>


<h3>Value</h3>

<p>Writes an hts file with the resulting discharges and optionally includes it in the data base.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Dec 2020 - Sep 2023
</p>


<h3>See Also</h3>

<p>The functions <code><a href="#topic+ds_exp_hts">ds_exp_hts</a></code> and <code><a href="#topic+d_imp_hts">d_imp_hts</a></code>are used for export the water levels,
respectively import the discharges within the data base. The function u_exp_discalib
included in <code><a href="#topic+p_discalib">p_discalib</a></code> is used for loading the calibration curves.
</p>

<hr>
<h2 id='h_year'>Annual time series</h2><span id='topic+h_year'></span>

<h3>Description</h3>

<p>Annual time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_year(file, mhy = 1, op = "M", dig = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_year_+3A_file">file</code></td>
<td>
<p>File name to proceed</p>
</td></tr>
<tr><td><code id="h_year_+3A_mhy">mhy</code></td>
<td>
<p>Starting month of the hydrological year (default = 1)</p>
</td></tr>
<tr><td><code id="h_year_+3A_op">op</code></td>
<td>
<p>Sum (S) or Mean (M) (default = &quot;M&quot;)</p>
</td></tr>
<tr><td><code id="h_year_+3A_dig">dig</code></td>
<td>
<p>Number of significant digits for Value (default = 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes an annual time-series using the annual mean or the 
annual sum of daily values. It allows the use of hydrological years. The date corresponds
to the middle of the year, i.e. the 182th day.
</p>


<h3>Value</h3>

<p>The function returns a time-series of annual values.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2022
</p>

<hr>
<h2 id='hs_tstep'>hts time series with fixed timestep</h2><span id='topic+hs_tstep'></span>

<h3>Description</h3>

<p>Computes time-series with a fixed timestep from infra-daily to monthly within a shiny web page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hs_tstep()
</code></pre>


<h3>Details</h3>

<p>First of all, one must select a &quot;starting&quot; hts file, instantaneous or already with
a fixed timestep.
</p>
<p>Then one must choose the computing time-step and mode, between the possible choices. Note that
the timezone considered is the timezone of the &quot;starting&quot; file.
</p>
<p>Possible time-steps are: 5, 10 or 30 minutes, 1, 2, 3, 6 or 12 hours, 1 day, 1 month.
It shall be noted that when computing the monthly time step, the daily time step is previously computed.
</p>
<p>Possible modes are: average, sum, max or min. For monthly time step, max and min offers two options:
daily max averages, respectively min, or absolute, respectively min.
</p>
<p>In the case of a daily timestep, a shift value (in hours) allows to shift the time interval.
For example if shift = 6, the date is computed from 6am until 6am the following day. The result is
dated in the middle of the interval, i.e. if shift = 6; the datetime is 18.
</p>
<p>In the case of a monthly timestep, associated additional time series can be optionally
computed:
</p>

<ul>
<li><p> A mean monthly climatology, taking into account or not the missing daily values with the
option &quot;remove NA&quot;. Climatology files are by convention awarded to year 2000.
</p>
</li>
<li><p> Excel files: with a calendar presentation (days in rows, months in columns,
years in sheets): option caledit_j ; with the monthly means (or sums): option caledit_m.
</p>
</li>
<li><p> Missing values can be replaced by the mean of the existing values for
other years: option gapfill.
</p>
</li>
<li><p> Extract year stat
</p>
</li></ul>

<p>The output files are written in same folder as the starting hts file.
</p>


<h3>Value</h3>

<p>hts files at the requested timestep with a suffix giving the timestep in minutes, i.e.
1440 for the daily timestep. In the case or monthly timestep, the suffixes are: M for the
current case, C for the climatology, G for the gapfilled file.
</p>
<p>Optionally, two Excel files with values in &quot;calendar form&quot;: one with
daily data and one with monthly data, the fist one with a ad_ prefix and the
second one with the am_ prefix.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017 - Sep 2023
</p>

<hr>
<h2 id='htsr-package'>htsr: Hydro-Meteorology Time-Series</h2><span id='topic+htsr'></span><span id='topic+htsr-package'></span>

<h3>Description</h3>

<p>Functions for the management and treatment of hydrology and meteorology time-series stored in a 'Sqlite' data base.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/p-chevallier/htsr">https://github.com/p-chevallier/htsr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/p-chevallier/htsr/issues">https://github.com/p-chevallier/htsr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='p_box_month'>Boxplot of the 12 months of a time-series.</h2><span id='topic+p_box_month'></span>

<h3>Description</h3>

<p>Boxplot of the 12 months of a time-series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_box_month(
  file,
  title = "Title",
  axeY = "Y-axis",
  savefig = FALSE,
  fileo = "plot.png",
  width = 8,
  height = 6
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_box_month_+3A_file">file</code></td>
<td>
<p>File name of the time-series</p>
</td></tr>
<tr><td><code id="p_box_month_+3A_title">title</code></td>
<td>
<p>Title plot (default = Title)</p>
</td></tr>
<tr><td><code id="p_box_month_+3A_axey">axeY</code></td>
<td>
<p>Title of y-axis (default  Y-axis)</p>
</td></tr>
<tr><td><code id="p_box_month_+3A_savefig">savefig</code></td>
<td>
<p>Save plot file TRUE / FALSE (default)</p>
</td></tr>
<tr><td><code id="p_box_month_+3A_fileo">fileo</code></td>
<td>
<p>Name of the plot file with extension png, jpg or pdf</p>
</td></tr>
<tr><td><code id="p_box_month_+3A_width">width</code></td>
<td>
<p>Plot width (x 100 pixels), default = 8</p>
</td></tr>
<tr><td><code id="p_box_month_+3A_height">height</code></td>
<td>
<p>Plot heights (x 100 pixels), default = 6</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 object
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2017 -Feb 2019
</p>

<hr>
<h2 id='p_clim'>Plot climatologies in hydrological year</h2><span id='topic+p_clim'></span>

<h3>Description</h3>

<p>This function processes climatology hts files created with
<code><a href="#topic+hs_tstep">hs_tstep</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_clim(
  files,
  type = "line",
  hydro.month = 1,
  title = "Title",
  yaxis = "Value",
  y.down = NA,
  y.up = NA,
  rpal = FALSE,
  pal = mapalette,
  legend.l = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_clim_+3A_files">files</code></td>
<td>
<p>List of climatology file names</p>
</td></tr>
<tr><td><code id="p_clim_+3A_type">type</code></td>
<td>
<p>Type: &quot;line&quot; (default) or bar&quot;</p>
</td></tr>
<tr><td><code id="p_clim_+3A_hydro.month">hydro.month</code></td>
<td>
<p>Starting month or the hydrological year (default = 1)</p>
</td></tr>
<tr><td><code id="p_clim_+3A_title">title</code></td>
<td>
<p>Title of the plot (default = &quot;Title&quot;)</p>
</td></tr>
<tr><td><code id="p_clim_+3A_yaxis">yaxis</code></td>
<td>
<p>Title of y-axis (default = &quot;Value&quot;)</p>
</td></tr>
<tr><td><code id="p_clim_+3A_y.down">y.down</code></td>
<td>
<p>Down limit of y-axis (default = NA)</p>
</td></tr>
<tr><td><code id="p_clim_+3A_y.up">y.up</code></td>
<td>
<p>Up limit of y-axis (default = NA)</p>
</td></tr>
<tr><td><code id="p_clim_+3A_rpal">rpal</code></td>
<td>
<p>Choice of a color palette TRUE/FALSE(default)</p>
</td></tr>
<tr><td><code id="p_clim_+3A_pal">pal</code></td>
<td>
<p>Color choice or mapalette (default)</p>
</td></tr>
<tr><td><code id="p_clim_+3A_legend.l">legend.l</code></td>
<td>
<p>List of text to be displayed in the plot legend (default = NA)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter tyoe allows to display a line graph or a bar graph.
</p>
<p>The parameter hydro.mont fixes the starting month of the hydrological year.
</p>
<p>The y-axis scale can be fixed with y.down and y.up.
</p>
<p>By default, the color palette is the R one. It can be change with a color
list in the pal parameter or choosing mapalette (default in pal)
</p>
<p>Par default station_sensor ids are displayed in the legend.l list. But it can be changed
entering a list of texts in legend.l,, which must have the same length as the
file number.
</p>


<h3>Value</h3>

<p>A ggplot2 object.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Feb 2017 - Sep 2023
</p>

<hr>
<h2 id='p_discalib'>Plot calibration curves water levels vs discharges</h2><span id='topic+p_discalib'></span>

<h3>Description</h3>

<p>Experimental function, which is for instance limited to only two calibration curves on the same plot.
</p>
<p>The function plot the discharges measurements and the corresponding
calibration curves starting.
</p>
<p>Only the &quot;active&quot; discharge measurements are plotted. The parameter plotdism displays
them or not.
</p>
<p>One can zoom on a subpart of the plot using the limit values on the x and y axis.
</p>
<p>The savefig (default = FALSE by default) parameter allows to save the result i a  png, jpg or pdf
file, according to the extension of fout.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_discalib(
  fsq,
  sta,
  sen = "IH",
  plotcalib = TRUE,
  plotdism = TRUE,
  title = "Title",
  savefig = FALSE,
  width = 8,
  height = 6,
  fout = "plot.png",
  limx = FALSE,
  limy = FALSE,
  xinf = NA,
  xsup = NA,
  yinf = NA,
  ysup = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_discalib_+3A_fsq">fsq</code></td>
<td>
<p>Data base file name</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_sta">sta</code></td>
<td>
<p>Station Id.</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_sen">sen</code></td>
<td>
<p>Sensor Id. (default = &quot;IH&quot;)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_plotcalib">plotcalib</code></td>
<td>
<p>Plot calibrations TRUE (default) / FALSE</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_plotdism">plotdism</code></td>
<td>
<p>Plot discharge measurements TRUE (default) / FALSE</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_title">title</code></td>
<td>
<p>Plot title (default: Title)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_savefig">savefig</code></td>
<td>
<p>Save plot in a png file TRUE (default) / FALSE</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_width">width</code></td>
<td>
<p>Plot width (x 100 pixels) (default = 8)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_height">height</code></td>
<td>
<p>Plot height (x 100 pixels) (default = 6)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_fout">fout</code></td>
<td>
<p>Plot file name (default = &quot;plot.png&quot;)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_limx">limx</code></td>
<td>
<p>Limit x axis TRUE / FALSE (default)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_limy">limy</code></td>
<td>
<p>Limit y axis TRUE / FALSE (default)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_xinf">xinf</code></td>
<td>
<p>Low value for x (default = NA)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_xsup">xsup</code></td>
<td>
<p>High value for x (default = NA)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_yinf">yinf</code></td>
<td>
<p>Low value for y (default = NA)</p>
</td></tr>
<tr><td><code id="p_discalib_+3A_ysup">ysup</code></td>
<td>
<p>High value for y (default = NA)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>P. Chevallier - Sep 2017 - Dec 2020
</p>

<hr>
<h2 id='p_gaps'>Plot of data inventory</h2><span id='topic+p_gaps'></span>

<h3>Description</h3>

<p>This function plot an inventory of the data from one or several station(s)-sensor(s).
It is based on the .gap files provided by the function <code><a href="#topic+f_properties">f_properties</a></code>. It allows
to highlight the gaps in time-series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_gaps(files, title = "Inventory", BW = FALSE, margin = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_gaps_+3A_files">files</code></td>
<td>
<p>List of series to plot (hts files)</p>
</td></tr>
<tr><td><code id="p_gaps_+3A_title">title</code></td>
<td>
<p>Plot title, default is &quot;Inventory&quot;</p>
</td></tr>
<tr><td><code id="p_gaps_+3A_bw">BW</code></td>
<td>
<p>Black &amp; white plot TRUE / FALSE (default)</p>
</td></tr>
<tr><td><code id="p_gaps_+3A_margin">margin</code></td>
<td>
<p>Reserved space for label writing - default is 0.1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The inventories are represented with lines displayed bottom-up in the order of the files list.
They are labeled with the station_sensor ids.
</p>
<p>Colors are the default colors of ggplot2. For a black &amp; white plot, precise BW = TRUE
</p>
<p>The margin value is a reserved space for writing the label at the end of each line.
Default value is 0.1 of the difference between the minimum and the maximum date. It shall be adjusted
following the length of the labels.
</p>


<h3>Value</h3>

<p>A ggplot2 object
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2017 - Sep 2023
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f_properties">f_properties</a></code>.
</p>

<hr>
<h2 id='p_hypso'>Plot the hypsometry curve of one or more basins</h2><span id='topic+p_hypso'></span>

<h3>Description</h3>

<p>Plot the hypsometry curve of one or more basins
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_hypso(
  file,
  abbrev,
  prop = FALSE,
  range = 50,
  fact = 5,
  title = "Title",
  savefig = FALSE,
  width = 8,
  height = 6,
  fileo = "plot.png"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_hypso_+3A_file">file</code></td>
<td>
<p>Raster file list of elevation model of basin(s)</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_abbrev">abbrev</code></td>
<td>
<p>List of abbreviated basin name(s)</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_prop">prop</code></td>
<td>
<p>TRUE / FALSE (default) plot a proportion curve of altitude ranges</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_range">range</code></td>
<td>
<p>Width of altitude range (default = 50m)</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_fact">fact</code></td>
<td>
<p>Exagerating factor of the areas (default=5)</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_title">title</code></td>
<td>
<p>Title of the plot (default = Title)</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_savefig">savefig</code></td>
<td>
<p>Save the plot in png (default FALSE)</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_width">width</code></td>
<td>
<p>Plot width (x 100 pixels) (default = 8)</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_height">height</code></td>
<td>
<p>Plot height (x 100 pixels) (default = 6)</p>
</td></tr>
<tr><td><code id="p_hypso_+3A_fileo">fileo</code></td>
<td>
<p>Name of plot file with extension (default = &quot;plot.png&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of ggplot2 class
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Sep 2017- Jun 2023
</p>

<hr>
<h2 id='p_scatter'>Scatter plot of 2 or more time-series</h2><span id='topic+p_scatter'></span>

<h3>Description</h3>

<p>The reference time-series is the first of the list. The scatter plot
regards only the common dates of the series. In addition to the plot, a linear function
is adjusted forcing or not the interception by the origin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_scatter(
  files,
  intercept.zero = FALSE,
  remove.zero = FALSE,
  lg.axis = c(NA, NA),
  title = "Title"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_scatter_+3A_files">files</code></td>
<td>
<p>List of file names to proceed</p>
</td></tr>
<tr><td><code id="p_scatter_+3A_intercept.zero">intercept.zero</code></td>
<td>
<p>TRUE/FALSE (default) force the interception by origin</p>
</td></tr>
<tr><td><code id="p_scatter_+3A_remove.zero">remove.zero</code></td>
<td>
<p>TRUE / FALSE (default) remove the records with Value = 0
(e.g. precipitations)</p>
</td></tr>
<tr><td><code id="p_scatter_+3A_lg.axis">lg.axis</code></td>
<td>
<p>Legend list for axis x &amp; y (default = NA)</p>
</td></tr>
<tr><td><code id="p_scatter_+3A_title">title</code></td>
<td>
<p>Title of the plot (default: Title)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a table named &quot;result&quot; with 5 columns : variable name, size of the sample,
correlation coefficient, regression line slope, interception
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Oct 2017-Apr 2023
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

result &lt;- p_scatter(files = c("foo1.RData","foo2.RData"),
          intercept.zero = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='p_wind'>Plot wind roses</h2><span id='topic+p_wind'></span>

<h3>Description</h3>

<p>Plot wind roses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_wind(
  fsq,
  sta,
  swd,
  swv,
  ws.int = 0.5,
  angle = 45,
  grid.line = 10,
  type = "default",
  breaks = 5,
  offset = 5,
  paddle = FALSE,
  key.position = "right"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_wind_+3A_fsq">fsq</code></td>
<td>
<p>Full name of the htsr data base</p>
</td></tr>
<tr><td><code id="p_wind_+3A_sta">sta</code></td>
<td>
<p>Station id</p>
</td></tr>
<tr><td><code id="p_wind_+3A_swd">swd</code></td>
<td>
<p>Id of wind direction sensor</p>
</td></tr>
<tr><td><code id="p_wind_+3A_swv">swv</code></td>
<td>
<p>Id of wind speed sensor</p>
</td></tr>
<tr><td><code id="p_wind_+3A_ws.int">ws.int</code></td>
<td>
<p>Size of speed intervals</p>
</td></tr>
<tr><td><code id="p_wind_+3A_angle">angle</code></td>
<td>
<p>Value in percent of the range unit</p>
</td></tr>
<tr><td><code id="p_wind_+3A_grid.line">grid.line</code></td>
<td>
<p>Value in percent of the grid line frequency</p>
</td></tr>
<tr><td><code id="p_wind_+3A_type">type</code></td>
<td>
<p>Type of plot: &quot;default&quot;, &quot;year&quot; or &quot;month&quot;</p>
</td></tr>
<tr><td><code id="p_wind_+3A_breaks">breaks</code></td>
<td>
<p>Number of speed intervals</p>
</td></tr>
<tr><td><code id="p_wind_+3A_offset">offset</code></td>
<td>
<p>Size in percent of the central hole</p>
</td></tr>
<tr><td><code id="p_wind_+3A_paddle">paddle</code></td>
<td>
<p>Shape of the basic elements: if FALSE, polar,
if TRUE, rectangular</p>
</td></tr>
<tr><td><code id="p_wind_+3A_key.position">key.position</code></td>
<td>
<p>Position of the legend</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a detailed description of all parameters see <code><a href="openair.html#topic+windRose">windRose</a></code>
</p>


<h3>Value</h3>

<p>A wind rose plot
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Dec 2019 - Sep 2023
</p>


<h3>See Also</h3>

<p><code><a href="openair.html#topic+windRose">windRose</a></code>
</p>

<hr>
<h2 id='ps_plothts'>Plot hts files</h2><span id='topic+ps_plothts'></span>

<h3>Description</h3>

<p>This function allows to plot one or several time series files using a shiny web page
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ps_plothts()
</code></pre>


<h3>Details</h3>

<p>When launched, a shiny window is open. Follow the instructions, divided in 5 steps.
</p>

<ol>
<li><p> Select hts files (8 max) pressing &quot;File select&quot;. They must be located in the same folder.
When done, press &quot;Enter file settings&quot;
</p>
</li>
<li><p> For each file, if needed, use the &quot;Edit&quot; tab to configure label, line.type, line.with,
point.shape and point.size. (The values follows the ggplot2 package conventions).
When done, press &quot;Save file settings&quot;
</p>
</li>
<li><p> Configure the general layout of the file, entering Title and y-Axis label and
choosing a color palette. Several options are available: set y-Axis scale, set time interval,
point plot(*), display normalized values, draw a trend line, or display the plot as horizontal facets.
When done, press &quot;Save plot settings&quot;
</p>
</li>
<li><p> Pressing &quot;Plot&quot; displays the graph. You can chose a line or bar graph. When the graph is finalized,
check the box &quot;save plot&quot;. Three formats are allowed: .png, .jpeg or pdf. The resolution is 300 dpi.
Then, press &quot;Save plot settings&quot;. The plot is saved in the folder of the selected files.
</p>
</li>
<li><p> When finished, press &quot;Done&quot;.
</p>
</li></ol>

<p>Items 2 and 3 can be performed and repeated in any order. Once they have been validated once,
item 4 can be executed as often as desired.
</p>
<p>(*) When point plot is selected, the points overlay the line (point plot doesn't work with bar).
If you want only the points on the plot, configure &quot;line.type&quot; and &quot;line.width&quot; = 0.
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Apr 2015 - Sep 2023
</p>

<hr>
<h2 id='u_index'>Compute an index of community</h2><span id='topic+u_index'></span>

<h3>Description</h3>

<p>Compute an index of community
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="u_index_+3A_nz">nz</code></td>
<td>
<p>length of the concatenated time-series</p>
</td></tr>
<tr><td><code id="u_index_+3A_yd">yd</code></td>
<td>
<p>initial vector of datetimes (in sec)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the function compute an index, which the number of apparition of the same datetime
in a time-series
</p>


<h3>Value</h3>

<p>vector of indexes
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Apr - Oct 2023
</p>

<hr>
<h2 id='u_timestep'>Compute values in a time-series with a fixed timestep</h2><span id='topic+u_timestep'></span>

<h3>Description</h3>

<p>Compute values in a time-series with a fixed timestep
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="u_timestep_+3A_te">te</code></td>
<td>
<p>time end (in sec)</p>
</td></tr>
<tr><td><code id="u_timestep_+3A_yd">yd</code></td>
<td>
<p>initial vector of datetimes (in sec)</p>
</td></tr>
<tr><td><code id="u_timestep_+3A_yv">yv</code></td>
<td>
<p>initial vector of values</p>
</td></tr>
<tr><td><code id="u_timestep_+3A_tst">tst</code></td>
<td>
<p>timestep (in mn)</p>
</td></tr>
<tr><td><code id="u_timestep_+3A_iop">iop</code></td>
<td>
<p>operation index</p>
</td></tr>
</table>


<h3>Details</h3>

<p>iop = 1 for sum; 0 for mean; -2 for min and +2 for max
</p>


<h3>Value</h3>

<p>vector of values with fixed timestep
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - June / Oct 2023
</p>

<hr>
<h2 id='w_atmp_alt'>Compute atmospheric pressure, function of altitude</h2><span id='topic+w_atmp_alt'></span>

<h3>Description</h3>

<p>Compute atmospheric pressure, function of altitude
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_atmp_alt(f_atmp, f_temp, alt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w_atmp_alt_+3A_f_atmp">f_atmp</code></td>
<td>
<p>File name of the known atmospheric pressure ts (mb)</p>
</td></tr>
<tr><td><code id="w_atmp_alt_+3A_f_temp">f_temp</code></td>
<td>
<p>File name of the air temperature at the known altitude (°C)</p>
</td></tr>
<tr><td><code id="w_atmp_alt_+3A_alt">alt</code></td>
<td>
<p>Altitude of the computed air- temperature ts (m)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes an atmospheric pressure time-series at a given altitude,
based on a known atmospheric pressure time-series at the sea level. It also needs
the air temperature time-series at the sea level for the same times.
</p>
<p>In order to verify that both time-series correspond, it is strongly recommended to 
run previously the function <code><a href="#topic+h_common">h_common</a></code>.
</p>


<h3>Value</h3>

<p>An hts file with the suffixe _&lt;alt&gt;
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2021 / Nov 2022
</p>

<hr>
<h2 id='w_etp'>Compute the potential evapotranspiration with several methods</h2><span id='topic+w_etp'></span>

<h3>Description</h3>

<p>ETP calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_etp(
  method = c("Turc", "Penman-Monteith", "Priestley-Taylor", "Makkink",
    "Heargraves-Samani"),
  freq = c("day", "month"),
  f_temp,
  f_relh = NA,
  f_radg = NA,
  f_radn = NA,
  f_atmp = NA,
  f_wvel = NA,
  f_tmin = NA,
  f_tmax = NA,
  lat = NA,
  alt = NA,
  albedo = NA,
  z = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w_etp_+3A_method">method</code></td>
<td>
<p>Method &quot;Turc&quot;, &quot;Penman-Monteith&quot;, &quot;Priestley-Taylor&quot;, &quot;Makkink&quot;, &quot;Heargraves-Samani&quot;</p>
</td></tr>
<tr><td><code id="w_etp_+3A_freq">freq</code></td>
<td>
<p>Frequency &quot;day&quot;, &quot;month&quot;</p>
</td></tr>
<tr><td><code id="w_etp_+3A_f_temp">f_temp</code></td>
<td>
<p>File of air temperature in degC, mandatory</p>
</td></tr>
<tr><td><code id="w_etp_+3A_f_relh">f_relh</code></td>
<td>
<p>File of relative humidity in percent, mandatory</p>
</td></tr>
<tr><td><code id="w_etp_+3A_f_radg">f_radg</code></td>
<td>
<p>File of global radiation in W/m2</p>
</td></tr>
<tr><td><code id="w_etp_+3A_f_radn">f_radn</code></td>
<td>
<p>File of net radiation in W/m2</p>
</td></tr>
<tr><td><code id="w_etp_+3A_f_atmp">f_atmp</code></td>
<td>
<p>File of atmospheric pressure in hPa</p>
</td></tr>
<tr><td><code id="w_etp_+3A_f_wvel">f_wvel</code></td>
<td>
<p>File of wind velocities in m/s</p>
</td></tr>
<tr><td><code id="w_etp_+3A_f_tmin">f_tmin</code></td>
<td>
<p>File of air min temperature in degC</p>
</td></tr>
<tr><td><code id="w_etp_+3A_f_tmax">f_tmax</code></td>
<td>
<p>File of air max temperature in degC</p>
</td></tr>
<tr><td><code id="w_etp_+3A_lat">lat</code></td>
<td>
<p>Latitude in deg</p>
</td></tr>
<tr><td><code id="w_etp_+3A_alt">alt</code></td>
<td>
<p>Altitude in m</p>
</td></tr>
<tr><td><code id="w_etp_+3A_albedo">albedo</code></td>
<td>
<p>Albedo</p>
</td></tr>
<tr><td><code id="w_etp_+3A_z">z</code></td>
<td>
<p>Anemometer high in m</p>
</td></tr>
</table>


<h3>Details</h3>

<p>f_temp and f_relh are mandatory in all cases.
</p>
<p>For the Turc method, f_radg is needed.
</p>
<p>For the Penman-Monteith method, f_atmp, f_wvel, h and z are needed. If
f_radn is not avalaible, lat, f_tmin and ftmax are also needed.
</p>
<p>The Turc method only works with a monthly frequence.
</p>


<h3>Value</h3>

<p>An hts files resulting of the operation with a name composed as:
</p>
<p>&lt;J or M&gt;&lt;EtpTu&gt;_&lt;Station_id&gt;.hts for the Turc method,
</p>
<p>&lt;J or M&gt;&lt;EtpPM&gt;_&lt;Station_id&gt;.hts for the Penman-Monteith method,
</p>
<p>&lt;J or M&gt;&lt;EtpPT&gt;_&lt;Station_id&gt;.hts for the Priestley-Taylor method
</p>
<p>&lt;J or M&gt;&lt;EtpMa&gt;_&lt;Station_id&gt;.hts for the Makkink method
</p>
<p>&lt;J or M&gt;&lt;EtpHS&gt;_&lt;Station_id&gt;.hts for the Heargraves-Samani method
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - April 2020-Nov2022
</p>


<h3>Source</h3>

<p>Hingray, B., Picouet, C., Musy A.,
Hydrologie, une science pour l'ingénieur, Presses Plolytechniques et Universitaires
Romandes, 2008,
</p>
<p>Allen, R.G., L.S. Pereira, D. Raes, and M. Smith. 1998.
Crop Evapotranspiration. Guidelines for Computing Crop Water Requirements.
FAO Irrigation and Drainage Paper 56. 300p
</p>
<p>Er-Raki, S., A. Chehbouni,
S. Khabba, V. Simonneaux, L. Jarlan, A. Ouldbba, J. C. Rodriguez,
and R. Allen. 2010. “Assessment of Reference Evapotranspiration Methods in
Semi-Arid Regions: Can Weather Forecast Data Be Used as Alternate of Ground
Meteorological Parameters?” Journal of Arid Environments 74 (12): 1587–96.
https://doi.org/10.1016/j.jaridenv.2010.07.002.
</p>

<hr>
<h2 id='w_spechum2relhum'>Convert specific humidity to relative humidity</h2><span id='topic+w_spechum2relhum'></span>

<h3>Description</h3>

<p>Convert specific humidity to relative humidity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_spechum2relhum(f_spechum, f_temp, f_atm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w_spechum2relhum_+3A_f_spechum">f_spechum</code></td>
<td>
<p>file of specific humidity, dimensionless (e.g. kg/kg) ratio of water mass / total air mass</p>
</td></tr>
<tr><td><code id="w_spechum2relhum_+3A_f_temp">f_temp</code></td>
<td>
<p>file of temperature degrees C</p>
</td></tr>
<tr><td><code id="w_spechum2relhum_+3A_f_atm">f_atm</code></td>
<td>
<p>file of atmospheric pressure in mb</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Converting specific humidity into relative humidity.
from Bolton 1980 The computation of Equivalent Potential Temperature
</p>


<h3>Value</h3>

<p>a file of relative humidity, ratio of actual water mixing ratio to saturation mixing ratio
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2022
</p>


<h3>Source</h3>

<p>David LeBauer - 2014
</p>
<p>from Bolton 1980 The computation of Equivalent Potential Temperature
</p>
<p><a href="https://earthscience.stackexchange.com/questions/2360/how-do-i-convert-specific-humidity-to-relative-humidity">https://earthscience.stackexchange.com/questions/2360/how-do-i-convert-specific-humidity-to-relative-humidity</a>
</p>

<hr>
<h2 id='w_temp_alt'>Compute temperature, function of altitude</h2><span id='topic+w_temp_alt'></span>

<h3>Description</h3>

<p>Compute temperature, function of altitude
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_temp_alt(file, alt0 = 0, alt, grad = -0.0065)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w_temp_alt_+3A_file">file</code></td>
<td>
<p>File name of the known air temperature ts (°C)</p>
</td></tr>
<tr><td><code id="w_temp_alt_+3A_alt0">alt0</code></td>
<td>
<p>Altitude of the known air temperature ts - default = 0 (m)</p>
</td></tr>
<tr><td><code id="w_temp_alt_+3A_alt">alt</code></td>
<td>
<p>Altitude of the computed air- temperature ts (m)</p>
</td></tr>
<tr><td><code id="w_temp_alt_+3A_grad">grad</code></td>
<td>
<p>Temperature gradient vs elevation - default = -0.0065 (°C/m)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes an air temperature time-series at a given altitude,
based on a known air temperature time-series at a known altitude.
</p>


<h3>Value</h3>

<p>An hts file with the suffix _&lt;alt&gt;
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Nov 2021
</p>

<hr>
<h2 id='z_coord'>Coordinate utility</h2><span id='topic+z_coord'></span>

<h3>Description</h3>

<p>Convert numeric coordinates in character coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z_coord(ncoord = NA, ccoord = NA, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="z_coord_+3A_ncoord">ncoord</code></td>
<td>
<p>Numeric coordinate</p>
</td></tr>
<tr><td><code id="z_coord_+3A_ccoord">ccoord</code></td>
<td>
<p>Character coordinate</p>
</td></tr>
<tr><td><code id="z_coord_+3A_type">type</code></td>
<td>
<p>Lat / Lon</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only one of both parameters ncoord (numeric) and ccoord (character) must be filled,
the other one remaining NA. The type of coordinate (Lat or Lon) is compulsory.
</p>
<p>The character coordinate must be organized in one string with 4 fields (degrees,
minutes, seconds, direction) separated with blanks (space or tab). Within each field,
no blanks are allowed to share the numeric value and the unit character. For
the unit character,  the only following letters are allowed: letter d/m/s.
For direction, the only the following letters are allowed: N/n/W/w/S/s/E/e.
</p>
<p>Example: &quot;25d 18m 56.2s S&quot;
</p>


<h3>Value</h3>

<p>Coordinates in characters
</p>


<h3>Author(s)</h3>

<p>P. Chevallier - Jan 2019 / Nov 2020
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
