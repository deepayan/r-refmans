<!DOCTYPE html><html lang="en"><head><title>Help for package CMHNPA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CMHNPA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ARL'><p>ARL Test</p></a></li>
<li><a href='#asbestos'><p>Asbestos data</p></a></li>
<li><a href='#CARL'><p>CARL Test</p></a></li>
<li><a href='#cereal'><p>Cereal data</p></a></li>
<li><a href='#CMH'><p>CMH Test</p></a></li>
<li><a href='#corn'><p>Corn data</p></a></li>
<li><a href='#crossover'><p>Cross-over data</p></a></li>
<li><a href='#durbin'><p>Durbin Test</p></a></li>
<li><a href='#dynamite'><p>Dynamite data</p></a></li>
<li><a href='#food'><p>Food data</p></a></li>
<li><a href='#friedman'><p>Friedman Test</p></a></li>
<li><a href='#gen_cor'><p>gen_cor Test</p></a></li>
<li><a href='#hr'><p>HR data</p></a></li>
<li><a href='#icecream'><p>Ice Cream data</p></a></li>
<li><a href='#intelligence'><p>Intelligence data</p></a></li>
<li><a href='#jam'><p>Jam data</p></a></li>
<li><a href='#job_satisfaction'><p>Job Satisfaction data</p></a></li>
<li><a href='#KW'><p>KW</p></a></li>
<li><a href='#lemonade'><p>Lemonade data</p></a></li>
<li><a href='#lemonade_sugar'><p>Lemonade Sugar data</p></a></li>
<li><a href='#lizard'><p>Lizard data</p></a></li>
<li><a href='#marriage'><p>Marriage data</p></a></li>
<li><a href='#milk'><p>Milk data</p></a></li>
<li><a href='#mu_r'><p>mu_r</p></a></li>
<li><a href='#np_anova'><p>np_anova function</p></a></li>
<li><a href='#orthogonal_scores'><p>orthogonal_scores</p></a></li>
<li><a href='#PARL'><p>PARL Test</p></a></li>
<li><a href='#peanuts'><p>Peanuts data</p></a></li>
<li><a href='#Poly'><p>Poly</p></a></li>
<li><a href='#RL'><p>RL Test</p></a></li>
<li><a href='#row_col_effect'><p>Row and column effects</p></a></li>
<li><a href='#saltiness'><p>Saltiness data</p></a></li>
<li><a href='#strawberry'><p>Strawberry data</p></a></li>
<li><a href='#T_Mu'><p>T_Mu statistic</p></a></li>
<li><a href='#traffic'><p>Traffic data</p></a></li>
<li><a href='#unconditional_CMH'><p>Unconditional CMH Test</p></a></li>
<li><a href='#whiskey'><p>Whiskey data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cochran-Mantel-Haenszel and Nonparametric ANOVA</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Cochran-Mantel-Haenszel methods (Cochran (1954) &lt;<a href="https://doi.org/10.2307%2F3001616">doi:10.2307/3001616</a>&gt;; Mantel and Haenszel (1959) &lt;<a href="https://doi.org/10.1093%2Fjnci%2F22.4.719">doi:10.1093/jnci/22.4.719</a>&gt;; Landis et al. (1978) &lt;<a href="https://doi.org/10.2307%2F1402373">doi:10.2307/1402373</a>&gt;) are a suite of tests applicable to categorical data. A competitor to those tests is the procedure of Nonparametric ANOVA which was initially introduced in Rayner and Best (2013) &lt;<a href="https://doi.org/10.1111%2Fanzs.12041">doi:10.1111/anzs.12041</a>&gt;. The methodology was then extended in Rayner et al. (2015) &lt;<a href="https://doi.org/10.1111%2Fanzs.12113">doi:10.1111/anzs.12113</a>&gt;. This package employs functions related to both methodologies and serves as an accompaniment to the book: An Introduction to Cochran–Mantel–Haenszel and Non-Parametric ANOVA. The package also contains the data sets used in that text.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, MASS, car</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-08 20:42:40 UTC; glj542</td>
</tr>
<tr>
<td>Author:</td>
<td>G. C. Livingston Jr [aut, cre, cph],
  J.C.W. Rayner [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>G. C. Livingston Jr &lt;Glen.LivingstonJr@newcastle.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-08 21:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ARL'>ARL Test</h2><span id='topic+ARL'></span>

<h3>Description</h3>

<p><code>ARL</code> returns the test statistic and p-value for the aligned RL test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARL(y, treatment, block1, block2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ARL_+3A_y">y</code></td>
<td>
<p>a numeric vector for the response variable.</p>
</td></tr>
<tr><td><code id="ARL_+3A_treatment">treatment</code></td>
<td>
<p>a vector giving the treatment type for the corresponding
elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="ARL_+3A_block1">block1</code></td>
<td>
<p>a vector giving the first blocking variable for the
corresponding elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="ARL_+3A_block2">block2</code></td>
<td>
<p>a vector giving the second blocking variable for the
corresponding elements of <code>y</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is applicable to Latin square designs. The test is not recommended
though as the use of t-1 degrees of freedom in the null distribution results
in unsatisfactorily large test sizes.
</p>
<p>The <code>CARL</code> test uses t+1 degrees of freedom in the null distribution which
results is appropriate test size and good power.
</p>


<h3>Value</h3>

<p>A list containing the ARL test statistic adjusted for ties together
with the associated p-value using a chi-squared distribution with t-1 degrees
of freedom.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CARL">CARL()</a></code> <code><a href="#topic+PARL">PARL()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(peanuts)
ARL(y = yield, treatment = treatment, block1 = row, block2 = col)

</code></pre>

<hr>
<h2 id='asbestos'>Asbestos data</h2><span id='topic+asbestos'></span>

<h3>Description</h3>

<p>A data set showing individuals' grade of asbestosis together with their
length of expposure to asbestos.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(asbestos)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1117 rows and two columns.
</p>

<dl>
<dt>exposure</dt><dd><p>a factor representing the number of years of exposure to asbestos</p>
</dd>
<dt>grade</dt><dd><p>a factor representing the grade of asbestosis. Grade 0 represents none present</p>
</dd>
</dl>



<h3>Details</h3>

<p>Irving J. Selikoff (1915–1992) was a chest physician and researcher who had
often been described as America’s foremost medical expert on asbestos related
diseases between the 1960s and the early 1990s.
</p>
<p>Through a lung clinic that he operated in New Jersey, Selikoff collected data
from a sample of around 1200 insulation workers in metropolitan New York in
1963.
</p>


<h3>Source</h3>

<p>Selikoff IJ. Household risks with inorganic fibers. Bull N Y Acad Med. 1981 Dec;57(10):947-61.
</p>


<h3>References</h3>

<p>Selikoff IJ. Household risks with inorganic fibers. Bull N Y Acad Med. 1981 Dec;57(10):947-61.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(asbestos)
KW(treatment = exposure, response = grade)
</code></pre>

<hr>
<h2 id='CARL'>CARL Test</h2><span id='topic+CARL'></span>

<h3>Description</h3>

<p><code>CARL</code> returns the test statistic and p-value for the aligned RL test
with empirically fitted degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CARL(
  y,
  treatment,
  block1,
  block2,
  n_components = 0,
  n_permutations = 0,
  treatment_scores = NULL,
  sig_digits = 4,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CARL_+3A_y">y</code></td>
<td>
<p>a numeric vector for the response variable.</p>
</td></tr>
<tr><td><code id="CARL_+3A_treatment">treatment</code></td>
<td>
<p>a vector giving the treatment type for the corresponding
elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="CARL_+3A_block1">block1</code></td>
<td>
<p>a vector giving the first blocking variable for the
corresponding elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="CARL_+3A_block2">block2</code></td>
<td>
<p>a vector giving the second blocking variable for the
corresponding elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="CARL_+3A_n_components">n_components</code></td>
<td>
<p>the number of polynomial components you wish to test. The maximum number of components is the number of treatments less one. If the number of components requested is less than <code>t-2</code>, a remainder component is created.</p>
</td></tr>
<tr><td><code id="CARL_+3A_n_permutations">n_permutations</code></td>
<td>
<p>the number of permutations you wish to run.</p>
</td></tr>
<tr><td><code id="CARL_+3A_treatment_scores">treatment_scores</code></td>
<td>
<p>the scores to be applied to the treatment groups. If not declared these will be set automatically and should be checked.</p>
</td></tr>
<tr><td><code id="CARL_+3A_sig_digits">sig_digits</code></td>
<td>
<p>the number of significant digits the output should show.</p>
</td></tr>
<tr><td><code id="CARL_+3A_verbose">verbose</code></td>
<td>
<p>flag for turning on the status bar for permutation tests.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is applicable to Latin square designs and is recommended over the
RL and ARL test. The test uses t+1 as the degrees of freedom of the
chi-squared null distribution and results in appropriate test sizes as well
as good power.
</p>


<h3>Value</h3>

<p>The <code>CARL</code> test statistic adjusted for ties together with the
associated p-value using a chi-squared distribution with t+1 degrees of
freedom.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARL">ARL()</a></code> <code><a href="#topic+PARL">PARL()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(peanuts)
CARL(y = yield, treatment = treatment, block1 = row, block2 = col)

</code></pre>

<hr>
<h2 id='cereal'>Cereal data</h2><span id='topic+cereal'></span>

<h3>Description</h3>

<p>Each of five breakfast cereals are ranked by ten judges, who each taste three
cereals. Each cereal is assessed six times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cereal)
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and three columns.
</p>

<dl>
<dt>rank</dt><dd><p>the rank of the cereal within each judge block</p>
</dd>
<dt>judge</dt><dd><p>the judge that was used</p>
</dd>
<dt>type</dt><dd><p>the type of cereal</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data comes from a Balanced Incomplete Block Design with the number of
treatments t = 5, number of blocks b = 10, with k = 3 and r = 6.
</p>


<h3>Source</h3>

<p>Kutner et al. (2005, section 28.1)
</p>


<h3>References</h3>

<p>Kutner, M., Nachtsheim, C., Neter, J. and Li, W. (2005). Applied linear statistical models (5th ed.). Boston: McGraw-Hill Irwin.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(cereal)
durbin(y = rank, groups = type, blocks = judge)
</code></pre>

<hr>
<h2 id='CMH'>CMH Test</h2><span id='topic+CMH'></span>

<h3>Description</h3>

<p><code>CMH</code> returns the test statistics and p-values for the four CMH tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CMH(
  treatment,
  response,
  strata = NULL,
  a_ij = NULL,
  b_hj = NULL,
  test_OPA = TRUE,
  test_GA = TRUE,
  test_MS = TRUE,
  test_C = TRUE,
  cor_breakdown = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CMH_+3A_treatment">treatment</code></td>
<td>
<p>a factor vector representing the treatment applied.</p>
</td></tr>
<tr><td><code id="CMH_+3A_response">response</code></td>
<td>
<p>a factor vector giving the response category for the
corresponding elements of <code>treatment</code>.</p>
</td></tr>
<tr><td><code id="CMH_+3A_strata">strata</code></td>
<td>
<p>a factor vector giving the strata or block for the
corresponding elements of <code>treatment</code> and <code>response</code>.</p>
</td></tr>
<tr><td><code id="CMH_+3A_a_ij">a_ij</code></td>
<td>
<p>a t x b matrix of treatment scores. The matrix allows for
different scores to be used over different strata. If a t x 1 vector of
scores is provided, it is assumed that the scores are the same across strata
and a warning provided.</p>
</td></tr>
<tr><td><code id="CMH_+3A_b_hj">b_hj</code></td>
<td>
<p>a c x b matrix of response scores. The matrix allows for
different scores to be used over different strata. If a c x 1 vector of
scores is provided, it is assumed that the scores are the same across strata
and a warning provided.</p>
</td></tr>
<tr><td><code id="CMH_+3A_test_opa">test_OPA</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the OPA
test values.</p>
</td></tr>
<tr><td><code id="CMH_+3A_test_ga">test_GA</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the GA
test values.</p>
</td></tr>
<tr><td><code id="CMH_+3A_test_ms">test_MS</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the MS
test values. If response scores are not included, this test will not be
performed.</p>
</td></tr>
<tr><td><code id="CMH_+3A_test_c">test_C</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the C
test values. If response scores and treatment scores are not included, this
test will not be performed.</p>
</td></tr>
<tr><td><code id="CMH_+3A_cor_breakdown">cor_breakdown</code></td>
<td>
<p>TRUE or FALSE flag to indicate if a correlation
breakdown over the strata is required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provided the required information is used in the function, the function will
return all four CMH test results.
</p>


<h3>Value</h3>

<p>The CMH test results for the four tests assuming the required
information is supplied.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CMH(treatment = marriage$religion, response = marriage$opinion,
strata = marriage$education, test_OPA = FALSE, test_MS = FALSE)
</code></pre>

<hr>
<h2 id='corn'>Corn data</h2><span id='topic+corn'></span>

<h3>Description</h3>

<p>Corn yields when grown by four different methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(corn)
</code></pre>


<h3>Format</h3>

<p>A data frame with 34 rows and two columns.
</p>

<dl>
<dt>method</dt><dd><p>one of four different methods used to grow corn</p>
</dd>
<dt>outcome</dt><dd><p>corn yield categorised into four levels</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rayner and Best (2001)
</p>


<h3>References</h3>

<p>Rayner, J.C.W. and Best, D.J. (2001). A Contingency Table Approach to Nonparametric Testing. Chapman &amp; Hall/CRC: Boca Raton FL.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(corn)
KW(treatment = method, response = outcome)
</code></pre>

<hr>
<h2 id='crossover'>Cross-over data</h2><span id='topic+crossover'></span>

<h3>Description</h3>

<p>A success or fail response variable with three treatments repeated over 11
patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(crossover)
</code></pre>


<h3>Format</h3>

<p>A data frame with 33 rows and three columns.
</p>

<dl>
<dt>treatment</dt><dd><p>the type of treatment applied. The three treatments are
placebo, aspirin and a new drug</p>
</dd>
<dt>success</dt><dd><p>whether the treatment was a success or not</p>
</dd>
<dt>patient</dt><dd><p>the patient the treatment was applied to</p>
</dd>
</dl>



<h3>Details</h3>

<p>In StatXact (2003), three treatment, three period cross-over clinical data
for 11 patients are given. This is a CMH design with t = 3, c = 2, and
b = 11.
</p>


<h3>Source</h3>

<p>StatXact (2003)
</p>


<h3>References</h3>

<p>StatXact (2003). User Manual Volume 2. CYTEL Software.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(crossover)
CMH(treatment = treatment,response = success,strata = patient)
</code></pre>

<hr>
<h2 id='durbin'>Durbin Test</h2><span id='topic+durbin'></span>

<h3>Description</h3>

<p><code>durbin</code> returns the results of Durbin's Rank Sum test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>durbin(
  y,
  groups,
  blocks,
  n_components = 0,
  n_permutations = 0,
  group_scores = NULL,
  sig_digits = 4,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="durbin_+3A_y">y</code></td>
<td>
<p>a numeric vector for the response variable.</p>
</td></tr>
<tr><td><code id="durbin_+3A_groups">groups</code></td>
<td>
<p>a vector giving the group for the corresponding elements of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="durbin_+3A_blocks">blocks</code></td>
<td>
<p>a vector giving the block for the corresponding elements of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="durbin_+3A_n_components">n_components</code></td>
<td>
<p>the number of polynomial components you wish to test. The maximum number of components is the number of groups less one. If the number of components requested is less than <code>t-2</code>, a remainder component is created.</p>
</td></tr>
<tr><td><code id="durbin_+3A_n_permutations">n_permutations</code></td>
<td>
<p>the number of permutations you wish to run.</p>
</td></tr>
<tr><td><code id="durbin_+3A_group_scores">group_scores</code></td>
<td>
<p>the scores to be applied to the groups. If not declared these will be set automatically and should be checked.</p>
</td></tr>
<tr><td><code id="durbin_+3A_sig_digits">sig_digits</code></td>
<td>
<p>the number of significant digits the output should show.</p>
</td></tr>
<tr><td><code id="durbin_+3A_verbose">verbose</code></td>
<td>
<p>flag for turning on the status bar for permutation tests.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is a generalisation of Friedman's test that can be applied to BIBD.
</p>


<h3>Value</h3>

<p>The Durbin test adjusted for tied results.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(icecream)
durbin(y = rank, groups = variety, blocks = judge)
</code></pre>

<hr>
<h2 id='dynamite'>Dynamite data</h2><span id='topic+dynamite'></span>

<h3>Description</h3>

<p>A data set for the explosiveness of five different formulations of explosive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dynamite)
</code></pre>


<h3>Format</h3>

<p>A data frame with 25 rows and four columns.
</p>

<dl>
<dt>response</dt><dd><p>a numeric vector for the explosiveness of the formulation with corresponding <code>treatment</code>, <code>batch</code> and <code>operator</code></p>
</dd>
<dt>treatment</dt><dd><p>a factor distinguishing the formulation for the
explosive mixture</p>
</dd>
<dt>batch</dt><dd><p>a factor describing the batch the raw materials come from</p>
</dd>
<dt>operator</dt><dd><p>a factor describing the operator who prepares the
explosive formulation</p>
</dd>
</dl>



<h3>Details</h3>

<p>The effect of five different formulations of an explosive mixture are
assessed. A batch of raw material is large enough for only five
formulations. Each formulation is prepared by five operators. The response
here is the explosiveness of dynamite formulations. This is a Latin square
design.
</p>


<h3>Source</h3>

<p>https://www.fox.temple.edu/cms/wp-content/uploads/2016/05/Randomized-Block-Design.pdf
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(dynamite)
CARL(y = response, treatment = treatment, block1 = batch, block2 = operator)
</code></pre>

<hr>
<h2 id='food'>Food data</h2><span id='topic+food'></span>

<h3>Description</h3>

<p>Categorical responses made by 15 subjects for two different prices of the
same food product. The data is from a CMH design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(food)
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and three columns.
</p>

<dl>
<dt>price</dt><dd><p>a factor showing two price points for the product</p>
</dd>
<dt>decision</dt><dd><p>a factor indicating the decision of either buy, undecided, or not_buy the product</p>
</dd>
<dt>subject</dt><dd><p>a factor showing the individual making a decison about the product</p>
</dd>
</dl>



<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(food)
b_hj = matrix(1:3,ncol=15,nrow=3)
CMH(treatment = price, response = decision, strata = subject, b_hj = b_hj,
test_OPA = FALSE, test_C = FALSE)
</code></pre>

<hr>
<h2 id='friedman'>Friedman Test</h2><span id='topic+friedman'></span>

<h3>Description</h3>

<p><code>friedman</code> returns the test statistic and p-value for the Friedman test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>friedman(
  y,
  groups,
  blocks,
  n_components = 0,
  n_permutations = 0,
  group_scores = NULL,
  sig_digits = 4,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="friedman_+3A_y">y</code></td>
<td>
<p>a numeric vector for the response variable.</p>
</td></tr>
<tr><td><code id="friedman_+3A_groups">groups</code></td>
<td>
<p>a vector giving the group for the corresponding elements of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="friedman_+3A_blocks">blocks</code></td>
<td>
<p>a vector giving the block for the corresponding elements of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="friedman_+3A_n_components">n_components</code></td>
<td>
<p>the number of polynomial components you wish to test. The maximum number of components is the number of groups less one. If the number of components requested is less than <code>t-2</code>, a remainder component is created.</p>
</td></tr>
<tr><td><code id="friedman_+3A_n_permutations">n_permutations</code></td>
<td>
<p>the number of permutations you wish to run.</p>
</td></tr>
<tr><td><code id="friedman_+3A_group_scores">group_scores</code></td>
<td>
<p>the scores to be applied to the groups. If not declared these will be set automatically and should be checked.</p>
</td></tr>
<tr><td><code id="friedman_+3A_sig_digits">sig_digits</code></td>
<td>
<p>the number of significant digits the output should show.</p>
</td></tr>
<tr><td><code id="friedman_+3A_verbose">verbose</code></td>
<td>
<p>flag for turning on the status bar for permutation tests.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Friedman test results statistic adjusted for ties together with the
associated p-value.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(jam)
friedman(y = sweetness_ranks, groups = type, blocks = judge)
</code></pre>

<hr>
<h2 id='gen_cor'>gen_cor Test</h2><span id='topic+gen_cor'></span>

<h3>Description</h3>

<p><code>gen_cor</code> returns the generalised correlations and associated p-values
together with tests of normality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_cor(
  x,
  y,
  z = NULL,
  U,
  V,
  W = NULL,
  x_scores = NULL,
  y_scores = NULL,
  z_scores = NULL,
  n_perms = 0,
  perms_info = FALSE,
  rounding = 4
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen_cor_+3A_x">x</code></td>
<td>
<p>a numeric vector or factor, commonly a response variable.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_y">y</code></td>
<td>
<p>a numeric vector or factor, commonly a treatment variable.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_z">z</code></td>
<td>
<p>an optional numeric vector or factor, commonly a block variable.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_u">U</code></td>
<td>
<p>the maximum degree of correlation relating to the variable <code>x</code>.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_v">V</code></td>
<td>
<p>the maximum degree of correlation relating to the variable <code>y</code>.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_w">W</code></td>
<td>
<p>the maximum degree of correlation relating to the variable <code>z</code>.
Required when <code>z</code> is included.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_x_scores">x_scores</code></td>
<td>
<p>optional scores related to the variable <code>x</code>.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_y_scores">y_scores</code></td>
<td>
<p>optional scores related to the variable <code>y</code>.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_z_scores">z_scores</code></td>
<td>
<p>optional scores related to the variable <code>z</code>.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_n_perms">n_perms</code></td>
<td>
<p>an optional numeric value indicating the number of
permutations required.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_perms_info">perms_info</code></td>
<td>
<p>a TRUE of FALSE flag to indicate whether information
regarding the progress on the number of permutations should be printed.</p>
</td></tr>
<tr><td><code id="gen_cor_+3A_rounding">rounding</code></td>
<td>
<p>the number of decimal places the output should be rounded to.
The default is 4.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates up to three way generalised correlations. The
function calculates three tests by default to test if the correlations are
statistically significantly different from 0 with an option to run permuation
testing.
</p>


<h3>Value</h3>

<p>This function calculates the generalised correlations for up to three input
variables.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(intelligence)
gen_cor(x = rank(score), y = age, U = 2, V = 2)
</code></pre>

<hr>
<h2 id='hr'>HR data</h2><span id='topic+hr'></span>

<h3>Description</h3>

<p>Human resource ranking data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hr)
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and three columns.
</p>

<dl>
<dt>applicant</dt><dd><p>the applicant to which ratings are applied</p>
</dd>
<dt>applicant_ranking</dt><dd><p>the ranking from made by the committee member</p>
</dd>
<dt>committee_member</dt><dd><p>member of the selection panel that ranks five candidates</p>
</dd>
</dl>



<h3>Details</h3>

<p>Applications for a position are vetted and ranked by Human Resource
(HR) professionals. The top five are interviewed by a selection committee of
ten. Each member of the committee gives an initial ranking of the applicants
and no one on the committee sees either the ranking by the HR professionals
or the initial rankings of the other committee members. Ties are not
permitted in any ranking. It is of interest to know if the rankings of the HR
professionals and the initial rankings of the selection committee are
correlated.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(hr)
a_ij = matrix(1:5,ncol=10,nrow=5)
b_hj = matrix(1:5,ncol=10,nrow=5)
CMH(treatment = applicant, response = applicant_ranking,
    strata = committee_member, a_ij = a_ij, b_hj = b_hj,
    test_OPA = FALSE, test_GA = FALSE, test_MS = FALSE)
</code></pre>

<hr>
<h2 id='icecream'>Ice Cream data</h2><span id='topic+icecream'></span>

<h3>Description</h3>

<p>Ice Cream data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(icecream)
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and three columns.
</p>

<dl>
<dt>rank</dt><dd><p>the rank of the ice cream within each judging block</p>
</dd>
<dt>judge</dt><dd><p>the judge that was used</p>
</dd>
<dt>variety</dt><dd><p>the type of ice cream that was tested</p>
</dd>
</dl>



<h3>Details</h3>

<p>The icecream data set comes from a Balanced Incomplete Block Design. There
are seven vanilla ice-creams that are the same except for increasing amounts
of vanilla flavouring. Seven judges each taste three varieties.
</p>


<h3>Source</h3>

<p>Table 5.1 in Conover (1998, p. 391).
</p>


<h3>References</h3>

<p>Conover, W. J. (1998). Practical nonparametric statistics (3rd ed.). New York: Wiley.
Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(icecream)
durbin(y = rank, groups = variety, blocks = judge)
</code></pre>

<hr>
<h2 id='intelligence'>Intelligence data</h2><span id='topic+intelligence'></span>

<h3>Description</h3>

<p>Intelligence scores for individuals from different age groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(intelligence)
</code></pre>


<h3>Format</h3>

<p>A data frame with 15 rows and two columns.
</p>

<dl>
<dt>age</dt><dd><p>age of the respondents</p>
</dd>
<dt>score</dt><dd><p>intelligence score achieved</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rayner and Best (2001, section 8.1)
</p>


<h3>References</h3>

<p>Rayner, J. C. W. and Best, D. J. (2001). A Contingency Table Approach to Nonparametric Testing. Boca Raton: Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(intelligence)
gen_cor(x = rank(score), y = age, U = 2, V = 2)
</code></pre>

<hr>
<h2 id='jam'>Jam data</h2><span id='topic+jam'></span>

<h3>Description</h3>

<p>Plum jam sweetness data based on JAR judge scores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(jam)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and four columns.
</p>

<dl>
<dt>type</dt><dd><p>the type of jam that was tested</p>
</dd>
<dt>judge</dt><dd><p>the judge that was used for tasting</p>
</dd>
<dt>sweetness</dt><dd><p>the judges score for sweetness: 1 denotes not sweet
enough, 2 not quite sweet enough, 3 just about right, 4 a little too sweet
and 5 too sweet</p>
</dd>
<dt>sweetness_ranks</dt><dd><p>the ranks within judge</p>
</dd>
</dl>



<h3>Details</h3>

<p>Three plum jams, A, B and C are given JAR sweetness codes by eight judges.
Here, 1 denotes not sweet enough, 2 not quite sweet enough, 3 just about
right, 4 a little too sweet and 5 too sweet.
</p>


<h3>Source</h3>

<p>Rayner and Best (2017, 2018)
</p>


<h3>References</h3>

<p>Rayner, J.C.W. and Best, D.J. (2017). Unconditional analogues of Cochran-Mantel-Haenszel tests. Australian &amp; NZ Journal of Statistics, 59(4), 485-494.
</p>
<p>Rayner, J.C.W. and Best, D.J. (2018). Extensions to the Cochran-Mantel-Haenszel mean scores and correlation tests. Journal of Statistical Theory and Practice.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(jam)
a_ij = matrix(rep(1:3,8), ncol = 8)
b_hj = matrix(rep(1:5,8), ncol = 8)
CMH(treatment = type, response = sweetness, strata = judge,
    a_ij = a_ij, b_hj = b_hj, test_OPA = FALSE, test_GA = FALSE,
    test_MS = FALSE)
</code></pre>

<hr>
<h2 id='job_satisfaction'>Job Satisfaction data</h2><span id='topic+job_satisfaction'></span>

<h3>Description</h3>

<p>Job satisfaction data based on income and gender.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(job_satisfaction)
</code></pre>


<h3>Format</h3>

<p>A data frame with 104 rows and three columns.
</p>

<dl>
<dt>income</dt><dd><p>income level categorised</p>
</dd>
<dt>satisfaction</dt><dd><p>the level of job satisfaction for the respondent</p>
</dd>
<dt>gender</dt><dd><p>gender of the respondent</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data relate job satisfaction and income in males and females.
Gender induces two strata; the treatments are income with categories scored
3, 10, 20 and 35 while the response is job satisfaction with categories
scored 1, 3, 4, and 5.
</p>


<h3>Source</h3>

<p>Agresti (2003)
</p>


<h3>References</h3>

<p>Agresti, A. (2003). Categorical Data Analysis. Hoboken: John Wiley &amp; Sons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(job_satisfaction)
a_ij = matrix(rep(c(3,10,20,35),2),nrow=4)
b_hj = matrix(rep(c(1,3,4,5),2),nrow=4)
unconditional_CMH(treatment = income, response = satisfaction,
strata = gender, U = 2, V = 2, a_ij = a_ij,
b_hj = b_hj)
</code></pre>

<hr>
<h2 id='KW'>KW</h2><span id='topic+KW'></span>

<h3>Description</h3>

<p><code>KW</code> returns the test statistic and p-value for the Kruskal-Wallis test
adjusted for ties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KW(
  treatment,
  response,
  n_components = 0,
  n_permutations = 0,
  treatment_scores = NULL,
  sig_digits = 4,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KW_+3A_treatment">treatment</code></td>
<td>
<p>a factor that defines the group the response belongs to.</p>
</td></tr>
<tr><td><code id="KW_+3A_response">response</code></td>
<td>
<p>a numeric variable measuring the response outcome.</p>
</td></tr>
<tr><td><code id="KW_+3A_n_components">n_components</code></td>
<td>
<p>the number of polynomial components you wish to test. The maximum number of components is the number of treatments less one. If the number of components requested is less than <code>t-2</code>, a remainder component is created.</p>
</td></tr>
<tr><td><code id="KW_+3A_n_permutations">n_permutations</code></td>
<td>
<p>the number of permutations you wish to run.</p>
</td></tr>
<tr><td><code id="KW_+3A_treatment_scores">treatment_scores</code></td>
<td>
<p>the scores to be applied to the treatment groups. If not declared these will be set automatically and should be checked.</p>
</td></tr>
<tr><td><code id="KW_+3A_sig_digits">sig_digits</code></td>
<td>
<p>the number of significant digits the output should show.</p>
</td></tr>
<tr><td><code id="KW_+3A_verbose">verbose</code></td>
<td>
<p>flag for turning on the status bar for permutation tests.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Kruskal-Wallis test is a non-parametric equivalent to the one way ANOVA.
</p>


<h3>Value</h3>

<p>The function returns the test result of the Kruskal Wallis test with
adjustment for ties and without.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston Jr, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(whiskey)
KW(treatment = maturity, response = grade)
</code></pre>

<hr>
<h2 id='lemonade'>Lemonade data</h2><span id='topic+lemonade'></span>

<h3>Description</h3>

<p>The Lemonade data set comes from a Randomised Block Design. There
are four types of lemonades which are all tasted by five tasters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lemonade)
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and three columns.
</p>

<dl>
<dt>rank</dt><dd><p>the rank of the lemonade within each judging block</p>
</dd>
<dt>type</dt><dd><p>the type of lemonade that was tested</p>
</dd>
<dt>taster</dt><dd><p>the judge that was used for tasting</p>
</dd>
</dl>



<h3>Source</h3>

<p>Thas et al. (2012, section 4.2)
</p>


<h3>References</h3>

<p>Thas, O., Best, D.J. and Rayner, J.C.W. (2012). Using orthogonal trend contrasts for testing ranked data with ordered alternatives. Statisticia Neerlandica, 66(4), 452-471.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(lemonade)
friedman(y = rank, groups = type, blocks = taster)
</code></pre>

<hr>
<h2 id='lemonade_sugar'>Lemonade Sugar data</h2><span id='topic+lemonade_sugar'></span>

<h3>Description</h3>

<p>Five lemonades with increasing sugar content are ranked by each of ten
judges. They were not permitted to give tied outcomes. This is a randomised
block design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lemonade_sugar)
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and three columns.
</p>

<dl>
<dt>ranks</dt><dd><p>the rank each lemonade based on sugar content</p>
</dd>
<dt>sugar_content</dt><dd><p>type of lemonade ordered by sugar content</p>
</dd>
<dt>judge</dt><dd><p>the judge providing the ranking</p>
</dd>
</dl>



<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(lemonade_sugar)
gen_cor(x = ranks, y = sugar_content, U = 3, V = 3, rounding = 3)
</code></pre>

<hr>
<h2 id='lizard'>Lizard data</h2><span id='topic+lizard'></span>

<h3>Description</h3>

<p>The data come from Manly (2007) and relate to the number of ants consumed by
two sizes of Eastern Horned Lizards over a four month period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lizard)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and three columns.
</p>

<dl>
<dt>month</dt><dd><p>the month in which the measurements were taken</p>
</dd>
<dt>size</dt><dd><p>the size of the Eastern Horned Lizards</p>
</dd>
<dt>ants</dt><dd><p>the number of ants consumed</p>
</dd>
</dl>



<h3>Source</h3>

<p>Manly (2007)
</p>


<h3>References</h3>

<p>Manly, B. F. J. (2007). Randomization, Bootstrap and Monte Carlo Methods in Biology, Third Edition. Boca Raton: Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(lizard)
gen_cor(x = ants, y = month, z = size, U = 3, V = 3, W = 1)
</code></pre>

<hr>
<h2 id='marriage'>Marriage data</h2><span id='topic+marriage'></span>

<h3>Description</h3>

<p>Scores of 1, 2 and 3 are assigned to the responses agree, neutral and
disagree respectively to the proposition &quot;Homosexuals should be able to
marry&quot; and scores of 1, 2 and 3 are assigned to the religious categories
fundamentalist, moderate and liberal respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(marriage)
</code></pre>


<h3>Format</h3>

<p>A data frame with 133 rows and three columns.
</p>

<dl>
<dt>education</dt><dd><p>highest level of eduction for the respondent</p>
</dd>
<dt>religion</dt><dd><p>level of religiosity. Scores of 1, 2 and 3 are assigned to the religious categories fundamentalist, moderate and liberal respectively</p>
</dd>
<dt>opinion</dt><dd><p>the response to the proposition: &quot;Homosexuals should be able to marry&quot;. Scores of 1, 2 and 3 are assigned to the responses agree, neutral and
disagree respectively</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agresti (2002)
</p>


<h3>References</h3>

<p>Agresti, A. (2002). Categorical Data Analysis, 2nd ed; Wiley: New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(marriage)
lm(as.numeric(opinion)~religion+education)
</code></pre>

<hr>
<h2 id='milk'>Milk data</h2><span id='topic+milk'></span>

<h3>Description</h3>

<p>In each of four lactation periods each of four cows are fed a different diet.
There is a washout period so previous diet does not affect future results.
A 4 × 4 Latin square is used to assess how diet affects milk production.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(milk)
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and four columns.
</p>

<dl>
<dt>production</dt><dd><p>a numerical measure of the milk production for the given diet, cow, and period</p>
</dd>
<dt>diet</dt><dd><p>a factor showing which diet the cow was administered</p>
</dd>
<dt>cow</dt><dd><p>a factor indicating the cow</p>
</dd>
<dt>period</dt><dd><p>a factor showing the relevant period</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://www.stat.purdue.edu/~yuzhu/stat514fall05/Lecnot/latinsquarefall05.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(milk)
CARL(y = production, treatment = diet, block1 = cow, block2 = period)
</code></pre>

<hr>
<h2 id='mu_r'>mu_r</h2><span id='topic+mu_r'></span>

<h3>Description</h3>

<p><code>mu_r</code> returns the estimated rth moment of a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu_r(x, r)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu_r_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="mu_r_+3A_r">r</code></td>
<td>
<p>the degree moment requiring calculation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the estimated rth moment of a vector.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x_vec = rnorm(10)
mu_r(x_vec,2)
</code></pre>

<hr>
<h2 id='np_anova'>np_anova function</h2><span id='topic+np_anova'></span>

<h3>Description</h3>

<p><code>np_anova</code> performs a nonparametric ANOVA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np_anova(ordered_vars, predictor_vars, uvw)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="np_anova_+3A_ordered_vars">ordered_vars</code></td>
<td>
<p>a data frame for the ordered variables being assessed.</p>
</td></tr>
<tr><td><code id="np_anova_+3A_predictor_vars">predictor_vars</code></td>
<td>
<p>a data frame for the un-ordered variables being
assessed.</p>
</td></tr>
<tr><td><code id="np_anova_+3A_uvw">uvw</code></td>
<td>
<p>the degree being assessed. This should be a vector with length
equal the number of elements in the <code>ordered_vars</code> data frame.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nonparametric ANOVA is a methodology that is applicable where one as an
ordered response variable as well as both ordered response and predictor
variables.
</p>


<h3>Value</h3>

<p>Where there is only one ordered variable, the function returns a type III
ANOVA table to test for differences of order <code>uvw</code> across the levels of
the <code>predictor_vars</code>.
</p>
<p>Where there is more than one ordered variable, the function returns a type
III ANOVA table to test for differences in generalised correlations of order
<code>uvw</code> across the levels of the <code>predictor_vars</code>.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(jam)
np_anova(ordered_vars = sweetness, predictor_vars = data.frame(type,judge), uvw = 1)
</code></pre>

<hr>
<h2 id='orthogonal_scores'>orthogonal_scores</h2><span id='topic+orthogonal_scores'></span>

<h3>Description</h3>

<p><code>orthogonal_scores</code> returns orthogonal scores weighted by prevalence in
the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orthogonal_scores(x, degree, n_strata = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orthogonal_scores_+3A_x">x</code></td>
<td>
<p>a vector of scores, either a factor or numeric.</p>
</td></tr>
<tr><td><code id="orthogonal_scores_+3A_degree">degree</code></td>
<td>
<p>the degree of orthogonal scores required.</p>
</td></tr>
<tr><td><code id="orthogonal_scores_+3A_n_strata">n_strata</code></td>
<td>
<p>optional argument for indicating the number of strata to
apply the scores to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of orthogonal scores.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(jam)
orthogonal_scores(x = sweetness, degree = 2, n_strata = 8)
</code></pre>

<hr>
<h2 id='PARL'>PARL Test</h2><span id='topic+PARL'></span>

<h3>Description</h3>

<p><code>PARL</code> returns the test statistic and p-value for the aligned RL test
performed as a permutation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PARL(y, treatment, block1, block2, N_perms = 1000, components = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PARL_+3A_y">y</code></td>
<td>
<p>a numericc vector for the response variable.</p>
</td></tr>
<tr><td><code id="PARL_+3A_treatment">treatment</code></td>
<td>
<p>a vector giving the treatment type for the corresponding
elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="PARL_+3A_block1">block1</code></td>
<td>
<p>a vector giving the first blocking variable for the
corresponding elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="PARL_+3A_block2">block2</code></td>
<td>
<p>a vector giving the second blocking variable for the
corresponding elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="PARL_+3A_n_perms">N_perms</code></td>
<td>
<p>The number of permutations to perform.</p>
</td></tr>
<tr><td><code id="PARL_+3A_components">components</code></td>
<td>
<p>a TRUE or FALSE flag to indicate whether component p-values
should be calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is applicable to Latin square designs and is recommended over the
RL and ARL test. The CARL test is much faster to run.
</p>


<h3>Value</h3>

<p>The PARL test statistic together with the associated p-value. Component
p-values may also be calculated and shown.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston Jr, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARL">ARL()</a></code> <code><a href="#topic+CARL">CARL()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(peanuts)
PARL(y = yield, treatment = treatment, block1 = row, block2 = col,
components = TRUE)
</code></pre>

<hr>
<h2 id='peanuts'>Peanuts data</h2><span id='topic+peanuts'></span>

<h3>Description</h3>

<p>A plant biologist conducted an experiment to compare the yields of four
varieties of peanuts, denoted as A, B, C, and D. A plot of land was divided
into 16 subplots (four rows and four columns).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(peanuts)
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and four columns.
</p>

<dl>
<dt>yield</dt><dd><p>the peanut yield</p>
</dd>
<dt>treatment</dt><dd><p>the variety of peanut plant</p>
</dd>
<dt>row</dt><dd><p>the row the plants were grown in of the plot</p>
</dd>
<dt>col</dt><dd><p>the column the plants were grown in of the plot</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://www.math.montana.edu/jobo/st541/sec3c.pdf
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(peanuts)
CARL(y = yield, treatment = treatment, block1 = row, block2 = col)
</code></pre>

<hr>
<h2 id='Poly'>Poly</h2><span id='topic+Poly'></span>

<h3>Description</h3>

<p><code>Poly</code> returns t-1 orthonormal scores weighted by a weights parameter.
The function uses Emerson Recursion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Poly(x, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Poly_+3A_x">x</code></td>
<td>
<p>a vector of numeric scores.</p>
</td></tr>
<tr><td><code id="Poly_+3A_p">p</code></td>
<td>
<p>a vector of weights corresponding to the elements of x.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of orthomornal scores based on the weights provided.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
Rayner, J.C.W., Thas, O. and De Boeck, B. (2008), A GENERALIZED EMERSON RECURRENCE RELATION. Australian &amp; New Zealand Journal of Statistics, 50: 235-240.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = 1:5
p = rep(0.2,5)
Poly(x = x, p = p)
</code></pre>

<hr>
<h2 id='RL'>RL Test</h2><span id='topic+RL'></span>

<h3>Description</h3>

<p><code>RL</code> returns the test statistic and p-value for the RL test. This test
is applicable to Latin square designs. The test is not recommended though as
block effects contaminate the response variable leading to unacceptable test
size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RL(y, treatment, block1, block2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RL_+3A_y">y</code></td>
<td>
<p>a numericc vector for the response variable.</p>
</td></tr>
<tr><td><code id="RL_+3A_treatment">treatment</code></td>
<td>
<p>a vector giving the treatment type for the corresponding
elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="RL_+3A_block1">block1</code></td>
<td>
<p>a vector giving the first blocking variable for the
corresponding elements of <code>y</code>.</p>
</td></tr>
<tr><td><code id="RL_+3A_block2">block2</code></td>
<td>
<p>a vector giving the second blocking variable for the
corresponding elements of <code>y</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the RL test statistic adjusted for ties together with the
associated p-value using a chi-squared distribution with t-1 degrees of
freedom.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARL">ARL()</a></code> <code><a href="#topic+CARL">CARL()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(peanuts)
RL(y = yield, treatment = treatment, block1 = row, block2 = col)
</code></pre>

<hr>
<h2 id='row_col_effect'>Row and column effects</h2><span id='topic+row_col_effect'></span>

<h3>Description</h3>

<p><code>row_col_effects</code> returns the values of the row and column effects. This
can be used to remove these effects from the response in a process call
aligning. This is particularly applicable in LSD data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>row_col_effect(to_align, rows, cols)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="row_col_effect_+3A_to_align">to_align</code></td>
<td>
<p>a numeric response vector.</p>
</td></tr>
<tr><td><code id="row_col_effect_+3A_rows">rows</code></td>
<td>
<p>a vector giving the row effects for <code>y</code>.</p>
</td></tr>
<tr><td><code id="row_col_effect_+3A_cols">cols</code></td>
<td>
<p>a vector giving the column effects for <code>y</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of row and column effects. The response vector less this is
the aligned response variable.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(peanuts)
row_col_effect(to_align = yield, rows = row, cols = col)
</code></pre>

<hr>
<h2 id='saltiness'>Saltiness data</h2><span id='topic+saltiness'></span>

<h3>Description</h3>

<p>Three products, A, B and C, were tasted by 107 consumers who gave responses
‘not salty enough’, ‘just about right saltiness’ and ‘too salty’, which were
then scored as 1, 2 and 3. The design is randomised blocks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(saltiness)
</code></pre>


<h3>Format</h3>

<p>A data frame with 321 rows and three columns.
</p>

<dl>
<dt>product</dt><dd><p>the type of product being tested</p>
</dd>
<dt>scores</dt><dd><p>the saltiness score. Scores of 1, 2 and 3 correspond to responses
‘not salty enough’, ‘just about right saltiness’ and ‘too salty’</p>
</dd>
<dt>participant</dt><dd><p>the participant providing the rating</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rayner, J. C. W. and Best, D. J. (2017)
</p>


<h3>References</h3>

<p>Rayner, J. C. W. and Best, D. J. (2017). Unconditional analogues of Cochran-Mantel-Haenszel tests. Australian &amp; New Zealand Journal of Statistics, 59(4):485–494.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(saltiness)
CMH(treatment = product, response = scores, strata = participant,
test_OPA = FALSE, test_MS = FALSE, test_C = FALSE)
</code></pre>

<hr>
<h2 id='strawberry'>Strawberry data</h2><span id='topic+strawberry'></span>

<h3>Description</h3>

<p>Strawberry growth rates for different pesticides.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(strawberry)
</code></pre>


<h3>Format</h3>

<p>A data frame with 28 rows and four columns.
</p>

<dl>
<dt>block</dt><dd><p>the experimental block</p>
</dd>
<dt>pesticide</dt><dd><p>the pesticide applied to the plant. Pesticide O is a control.</p>
</dd>
<dt>response</dt><dd><p>a measure of the growth rate of strawberry plants with <code>pesticide</code> applied.</p>
</dd>
<dt>rank</dt><dd><p>rank of the response</p>
</dd>
</dl>



<h3>Details</h3>

<p>Pesticides are applied to strawberry plants to inhibit the growth of
weeds. The question is, do they also inhibit the growth of the strawberries?
The design is a supplemented balanced design.
</p>


<h3>Source</h3>

<p>Pearce (1960)
</p>


<h3>References</h3>

<p>Pearce, S.C. (1960). Supplemented balanced. Biometrika, 47, 263-271.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(strawberry)
lm_strawberry = lm(rank~pesticide+block)
anova(lm_strawberry)
</code></pre>

<hr>
<h2 id='T_Mu'>T_Mu statistic</h2><span id='topic+T_Mu'></span>

<h3>Description</h3>

<p><code>T_Mu</code> returns the test statistic for an unconditional CMH MS equivalent
test of required <code>degree</code>. This function is used in the
<code>unconditional_CMH</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T_Mu(treatment, response, strata = NULL, degree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="T_Mu_+3A_treatment">treatment</code></td>
<td>
<p>a vector of treatment values.</p>
</td></tr>
<tr><td><code id="T_Mu_+3A_response">response</code></td>
<td>
<p>a vector of response values.</p>
</td></tr>
<tr><td><code id="T_Mu_+3A_strata">strata</code></td>
<td>
<p>a variable defining the strata.</p>
</td></tr>
<tr><td><code id="T_Mu_+3A_degree">degree</code></td>
<td>
<p>the degree assessment required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the test statistic for an unconditional CMH MS
equivalent test of required <code>degree</code>.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+unconditional_CMH">unconditional_CMH()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(job_satisfaction)
T_Mu(treatment = income, response = as.numeric(satisfaction),
strata = gender, degree = 1)
</code></pre>

<hr>
<h2 id='traffic'>Traffic data</h2><span id='topic+traffic'></span>

<h3>Description</h3>

<p>Traffic light data for different light sequences, intersections, and times of
day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(traffic)
</code></pre>


<h3>Format</h3>

<p>A data frame with 25 rows and four columns.
</p>

<dl>
<dt>minutes</dt><dd><p>the amount of unused red-light time in minutes</p>
</dd>
<dt>treatment</dt><dd><p>the traffic light sequence</p>
</dd>
<dt>intersection</dt><dd><p>the intersection the <code>treatment</code> was applied</p>
</dd>
<dt>time_of_day</dt><dd><p>the time of the day the <code>treatment</code> was applied</p>
</dd>
</dl>



<h3>Details</h3>

<p>A traffic engineer conducted a study to compare the total unused red-light
time for five different traffic light signal sequences. The experiment was
conducted with a Latin square design in which blocking factors were (1) five
intersections and (2) five time of day periods.
</p>


<h3>Source</h3>

<p>Kuehl, R. (2000)
</p>


<h3>References</h3>

<p>Kuehl, R. (2000). Design of Experiments: Statistical Principles of Research Design and Analysis. Belmont, California: Duxbury Press.
</p>
<p>Best, D. J. and Rayner, J. C. W. (2011). Nonparametric tests for Latin squares. NIASRA Statistics Working Paper Series, 11-11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(traffic)
np_anova(ordered_vars = rank(minutes),
predictor_vars = data.frame(treatment,intersection,time_of_day), uvw = 1)
</code></pre>

<hr>
<h2 id='unconditional_CMH'>Unconditional CMH Test</h2><span id='topic+unconditional_CMH'></span>

<h3>Description</h3>

<p><code>unconditional_CMH</code> returns the test statistics and p-values for the
equivalent unconditional CMH tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unconditional_CMH(
  treatment,
  response,
  strata = NULL,
  U = NULL,
  V = NULL,
  a_ij = NULL,
  b_hj = NULL,
  test_OPA = TRUE,
  test_GA = TRUE,
  test_M = TRUE,
  test_C = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unconditional_CMH_+3A_treatment">treatment</code></td>
<td>
<p>a factor vector representing the treatment applied.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_response">response</code></td>
<td>
<p>a factor vector giving the response category for the
corresponding elements of <code>treatment</code>.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_strata">strata</code></td>
<td>
<p>a factor vector giving the strata or block for the
corresponding elements of <code>treatment</code> and <code>response</code>.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_u">U</code></td>
<td>
<p>The degree of assessment relating to the treatment.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_v">V</code></td>
<td>
<p>The degree of assessment relating to the response.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_a_ij">a_ij</code></td>
<td>
<p>a t x b matrix of treatment scores. The matrix allows for
different scores to be used over different strata. If a t x 1 vector of
scores is provided, it is assumed that the scores are the same across strata
and a warning provided.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_b_hj">b_hj</code></td>
<td>
<p>a c x b matrix of response scores. The matrix allows for
different scores to be used over different strata. If a c x 1 vector of
scores is provided, it is assumed that the scores are the same across strata
and a warning provided.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_test_opa">test_OPA</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the OPA
test values.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_test_ga">test_GA</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the GA
test values.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_test_m">test_M</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the MS
test values. If response scores are not included, this test will not be
performed.</p>
</td></tr>
<tr><td><code id="unconditional_CMH_+3A_test_c">test_C</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the C
test values. If response scores and treatment scores are not included, this
test will not be performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The unconditional CMH test results.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(job_satisfaction)
a_ij = matrix(rep(c(3,10,20,35),2),nrow=4)
b_hj = matrix(rep(c(1,3,4,5),2),nrow=4)
unconditional_CMH(treatment = income, response = satisfaction,
strata = gender, U = 2, V = 2, a_ij = a_ij, b_hj = b_hj)
</code></pre>

<hr>
<h2 id='whiskey'>Whiskey data</h2><span id='topic+whiskey'></span>

<h3>Description</h3>

<p>Ratings of different whiskeys of differing maturity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(whiskey)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and two columns.
</p>

<dl>
<dt>maturity</dt><dd><p>the length of time the whiskey has matured for</p>
</dd>
<dt>grade</dt><dd><p>grade applied to the whiskey. A lower score indicates a better
whiskey</p>
</dd>
</dl>



<h3>Source</h3>

<p>O'Mahony (1986, p.363)
</p>


<h3>References</h3>

<p>Rayner, J.C.W. and Best, D.J. (2001). A Contingency Table Approach to Nonparametric Testing. Chapman &amp; Hall/CRC: Boca Raton FL.
</p>
<p>O'Mahony, M. (1986). Sensory Evaluation of Food - Statistical Methods and Procedures. Marcel Dekker: New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(whiskey)
CMH(treatment = maturity, response = grade, a_ij = c(1,5,7),
b_hj = 1:3, test_OPA = FALSE, test_GA = FALSE, test_MS = FALSE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
