<!DOCTYPE html><html><head><title>Help for package CoClust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CoClust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CoClust'><p>Copula-Based Clustering Algorithm</p></a></li>
<li><a href='#CoClust-class'><p>Class &quot;CoClust&quot;</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Copula Based Cluster Analysis</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-12-15</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3-2</td>
</tr>
<tr>
<td>Author:</td>
<td>Francesca Marta Lilja Di Lascio, Simone Giannerini</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.1), methods, copula</td>
</tr>
<tr>
<td>Imports:</td>
<td>gtools</td>
</tr>
<tr>
<td>Description:</td>
<td>A copula based clustering algorithm that finds clusters according to the complex multivariate dependence structure of the data generating process. The updated version of the algorithm is described in Di Lascio, F.M.L. and Giannerini, S. (2016). "Clustering dependent observations with copula functions". Statistical Papers, p.1-17. &lt;<a href="https://doi.org/10.1007%2Fs00362-016-0822-3">doi:10.1007/s00362-016-0822-3</a>&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-12-15 18:40:48 UTC; FDiLascio</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-12-17 16:14:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='CoClust'>Copula-Based Clustering Algorithm</h2><span id='topic+CoClust'></span>

<h3>Description</h3>

<p>Cluster analysis based on copula functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CoClust(m, dimset = 2:5, noc = 4, copula = "frank", fun = median,
  method.ma = c("empirical", "pseudo"), method.c = c("ml", "mpl", "irho", "itau"),
   dfree = NULL, writeout = 5, penalty = c("BICk", "AICk", "LL"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CoClust_+3A_m">m</code></td>
<td>
<p>a data matrix.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_dimset">dimset</code></td>
<td>
<p>the set of dimensions for which the function tries the clustering.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_noc">noc</code></td>
<td>
<p>sample size of the set for selecting the number of clusters.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_copula">copula</code></td>
<td>
<p>a copula model.
This should be one of &quot;normal&quot;, &quot;t&quot;, &quot;frank&quot;, &quot;clayton&quot; and &quot;gumbel&quot;. See the Details section.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_fun">fun</code></td>
<td>
<p>combination function of the pairwise Spearman's rho used to select the k-plets. The default is <code>median</code></p>
</td></tr>
<tr><td><code id="CoClust_+3A_method.ma">method.ma</code></td>
<td>
<p>estimation method for margins. See the Details section.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_method.c">method.c</code></td>
<td>
<p>estimation method for copula. See <code>fitCopula</code>.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_dfree">dfree</code></td>
<td>
<p>degrees of freedom for the <em>t</em> copula.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_writeout">writeout</code></td>
<td>
<p>writes a message on the number of allocated observations every writeout observations.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_penalty">penalty</code></td>
<td>
<p>Specifies the likelihood criterion used for selecting the number of clusters.</p>
</td></tr>
<tr><td><code id="CoClust_+3A_...">...</code></td>
<td>
<p>further parameters for <code>fitCopula</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>Usage for Frank copula: </dt><dd>
<pre>CoClust(m, nmaxmarg = 2:5, noc = 4, copula = "frank",
 fun = median, method.ma=c("gaussian","empirical"), method.c = "mpl",
 penalty ="BICk", ...)</pre></dd>
</dl>

<p>CoClust is a clustering algorithm that, being based on copula functions, allows to group observations according to the multivariate dependence structure of the generating process without any assumptions on the margins.
</p>
<p>For each <em>k</em> in <code>dimset</code> the algorithm builds a sample of <code>noc</code> observations (rows of the data matrix <code>m</code>) by using the matrix of Spearman's rho correlation coefficients which are combined by means of the function <code>fun</code> (<code>median</code> by default).
The number of clusters <em>K</em> is selected by means of a criterion based on the likelihood of the copula fit. The switch <code>penalty</code> allows to select 3 different criteria; The choice <code>LL</code> corresponds to using
the likelihood without penalty terms. Then, the remaining observations are allocated to the clusters as follows:
1. selects a <em>K</em>-plet of observations on the basis of <code>fun</code> applied to the pairwise Spearman's rho; 2. allocates or discards the <em>K</em>-plet on the basis of the likelihood of the copula fit.
</p>
<p>The estimation approach for the copula fit is semiparametric: a range of nonparametric margins and parametric copula models can be selected by the user.
The CoClust algorithm does not require to set a priori the number of clusters nor it needs a starting classification.
</p>
<p>Notice that the dependence structure for the Gaussian and the <em>t</em> copula is set to exchangeable. Non structured dependence structures will be allowed in a future version.
</p>


<h3>Value</h3>

<p>An object of S4 class &quot;CoClust&quot;, which is a list with the following elements:
</p>
<table>
<tr><td><code>Number.of.Clusters</code></td>
<td>
<p>the number <em>K</em> of identified clusters.</p>
</td></tr>
<tr><td><code>Index.Matrix</code></td>
<td>
<p>a <em>n.obs</em> by <em>(K+1)</em> matrix where <em>n.obs</em> is the number of observations put in each cluster. The matrix contains the row indexes of the observations of the data matrix <code>m</code>.
The last column contains the log-likelihood of the copula fit.</p>
</td></tr>
<tr><td><code>Data.Clusters</code></td>
<td>
<p>the matrix of the final clustering.</p>
</td></tr>
<tr><td><code>Dependence</code></td>
<td>
<p>a list containing:
</p>

<table>
<tr>
 <td style="text-align: left;">
        <code>Model</code>  </td><td style="text-align: left;"> the copula model used for the clustering. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>Param</code>  </td><td style="text-align: left;"> the estimated dependence parameter between clusters. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>Std.Err</code></td><td style="text-align: left;"> the standard error of Param.</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>P.val</code>  </td><td style="text-align: left;"> the p-value associated to the null hypothesis <code>H_0: theta=0</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
        </td>
</tr>

</table>
</td></tr>
<tr><td><code>LogLik</code></td>
<td>
<p>the maximized log-likelihood copula fit.</p>
</td></tr>
<tr><td><code>Est.Method</code></td>
<td>
<p>the estimation method used for the copula fit.</p>
</td></tr>
<tr><td><code>Opt.Method</code></td>
<td>
<p>the optimization method used for the copula fit.</p>
</td></tr>
<tr><td><code>LLC</code></td>
<td>
<p>the value of the LogLikelihood Criterion for each <em>k</em> in <code>dimset</code>.</p>
</td></tr>
<tr><td><code>Index.dimset</code></td>
<td>
<p>a list that, for each <em>k</em> in <code>dimset</code>, contains the index matrix of the initial set of <code>nk</code> observations used for selecting the number of clusters, together with the associated loglikelihood.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The final clustering is composed of <em>K</em> groups in which observations of the same group are independent whereas the observations that belong to different groups and that form a <em>K</em>-plet are dependent.
</p>


<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. (201x). &quot;CoClust: An R Package for Copula-based Cluster Analysis&quot;. To be submitted.
</p>
<p>Di Lascio, F.M.L., Durante, F. and Pappada', R. (2017). &quot;Copula-based clustering methods&quot;, Copulas and Dependence Models with Applications, p.49-67. Eds Ubeda-Flores, M., de Amo, E., Durante, F. and Fernandez Sanchez, J., Springer International Publishing. ISBN: 978-3-319-64220-8.
</p>
<p>Di Lascio, F.M.L. and Disegna, M. (2017). &quot;A copula-based clustering algorithm to analyse EU country diets&quot;. <em>Knowledge-Based Systems</em>, 132, p.72-84. DOI: 10.1016/j.knosys.2017.06.004.
</p>
<p>Di Lascio, F.M.L. and Giannerini, S. (2016). &quot;Clustering dependent observations with copula functions&quot;. <em>Statistical Papers</em>, p.1-17. DOI 10.1007/s00362-016-0822-3.
</p>
<p>Di Lascio, F.M.L. and Giannerini, S. (2012). &quot;A Copula-Based Algorithm for Discovering Patterns of Dependent Observations&quot;, <em>Journal of Classification</em>, 29(1), p.50-75.
</p>
<p>Di Lascio, F.M.L. (2008). &quot;Analyzing the dependence structure of microarray data: a copula-based approach&quot;. <em>PhD thesis</em>, Dipartimento di Scienze Statistiche, Universita' di Bologna, Italy.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## ******************************************************************
## 1. builds a 3-variate copula with different margins
##    (Gaussian, Gamma, Beta)
##
## 2. generates a data matrix xm with 15 rows and 21 columns and
##    builds the matrix of the true cluster indexes
##
## 3. applies the CoClust to the rows of xm and recovers the
##    multivariate dependence structure of the data
## ******************************************************************

## Step 1. **********************************************************
n      &lt;- 105             # total number of observations
n.col  &lt;- 21              # number of columns of the data matrix m
n.marg &lt;- 3               # dimension of the copula
n.row  &lt;- n*n.marg/n.col  # number of rows of the data matrix m

theta  &lt;- 10
copula &lt;- frankCopula(theta, dim = n.marg)
mymvdc &lt;- mvdc(copula, c("norm", "gamma", "beta"),list(list(mean=7, sd=2),
                list(shape=3, rate=4), list(shape1=2, shape2=1)))

## Step 2. **********************************************************
set.seed(11)
x.samp &lt;- rMvdc(n, mymvdc)
xm     &lt;- matrix(x.samp, nrow = n.row, ncol = n.col, byrow=TRUE)

index.true &lt;-  matrix(1:15,5,3)
colnames(index.true) &lt;- c("Cluster 1","Cluster 2", "Cluster 3")

## Step 3. **********************************************************

clust &lt;- CoClust(xm, dimset = 2:4, noc=2, copula="frank",
                 method.ma="empirical", method.c="ml",writeout=1)
clust
clust@"Number.of.Clusters"
clust@"Dependence"$Param
clust@"Data.Clusters"
index.clust &lt;- clust@"Index.Matrix"

## compare with index.true
index.clust
index.true
##
</code></pre>

<hr>
<h2 id='CoClust-class'>Class &quot;CoClust&quot;</h2><span id='topic+CoClust-class'></span>

<h3>Description</h3>

<p>A class for <code>CoClust</code> and its extensions</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("CoClust", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Number.of.Clusters</code>:</dt><dd><p>Object of class <code>"integer"</code>. The number <em>K</em> of identified clusters.</p>
</dd>
<dt><code>Index.Matrix</code>:</dt><dd><p>Object of class <code>"matrix"</code>. A <em>n.obs</em> by <em>(K+1)</em> matrix where <em>n.obs</em> is the number of observations put in each cluster. The matrix contains the row indexes of the observations of the data matrix <code>m</code>.
The last column contains the log-likelihood of the copula fit.</p>
</dd>
<dt><code>Data.Clusters</code>:</dt><dd><p>Object of class <code>"matrix"</code>. The matrix of the final clustering.</p>
</dd>
<dt><code>Dependence</code>:</dt><dd><p>Object of class <code>"list"</code>. The list contains:
</p>

<table>
<tr>
 <td style="text-align: left;">
        <code>Model</code>  </td><td style="text-align: left;"> the copula model used for the clustering. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>Param</code>  </td><td style="text-align: left;"> the estimated dependence parameter between clusters. </td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>Std.Err</code></td><td style="text-align: left;"> the standard error of Param.</td>
</tr>
<tr>
 <td style="text-align: left;">
        <code>P.val</code>  </td><td style="text-align: left;"> the p-value associated to the null hypothesis <code>H_0: theta=0</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
        </td>
</tr>

</table>

</dd>
<dt><code>LogLik</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The maximized log-likelihood copula fit.</p>
</dd>
<dt>Est.Method</dt><dd><p>Object of class <code>"character"</code>. The estimation method used for the copula fit.</p>
</dd>
<dt>Opt.Method</dt><dd><p>Object of class <code>"character"</code>. The optimization method used for the copula fit.</p>
</dd>
<dt>LLC</dt><dd><p>Object of class <code>"numeric"</code>. The value of the LogLikelihood Criterion for each <em>k</em> in <code>dimset</code>.</p>
</dd>
<dt>Index.dimset</dt><dd><p>Object of class <code>"list"</code>. A list that, for each <em>k</em> in <code>dimset</code>, contains the index matrix of the initial set of <code>nk</code> observations used for selecting the number of clusters, together with the associated loglikelihood.</p>
</dd>
</dl>



<h3>Methods</h3>

<p>No methods defined with class &quot;CoClust&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. (201x). &quot;CoClust: An R Package for Copula-based Cluster Analysis&quot;. To be submitted.
</p>
<p>Di Lascio, F.M.L., Durante, F. and Pappada', R. (2017). &quot;Copula-based clustering methods&quot;, Copulas and Dependence Models with Applications, p.49-67. Eds Ubeda-Flores, M., de Amo, E., Durante, F. and Fernandez Sanchez, J., Springer International Publishing. ISBN: 978-3-319-64220-8.
</p>
<p>Di Lascio, F.M.L. and Disegna, M. (2017). &quot;A copula-based clustering algorithm to analyse EU country diets&quot;. <em>Knowledge-Based Systems</em>, 132, p.72-84. DOI: 10.1016/j.knosys.2017.06.004.
</p>
<p>Di Lascio, F.M.L. and Giannerini, S. (2016). &quot;Clustering dependent observations with copula functions&quot;. <em>Statistical Papers</em>, p.1-17. DOI 10.1007/s00362-016-0822-3.
</p>
<p>Di Lascio, F.M.L. and Giannerini, S. (2012). &quot;A Copula-Based Algorithm for Discovering Patterns of Dependent Observations&quot;, <em>Journal of Classification</em>, 29(1), p.50-75.
</p>
<p>Di Lascio, F.M.L. (2008). &quot;Analyzing the dependence structure of microarray data: a copula-based approach&quot;. <em>PhD thesis</em>, Dipartimento di Scienze Statistiche, Universita' di Bologna, Italy.
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+CoClust">CoClust</a></code> and <code>copula</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("CoClust")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
