<!DOCTYPE html><html lang="en"><head><title>Help for package stacomirtools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stacomirtools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#stacomirtools'><p>Stacomirtools options.</p></a></li>
<li><a href='#chnames'><p>This function replaces the variable names in a data.frame</p></a></li>
<li><a href='#connect'><p>generic connect function for baseODBC</p></a></li>
<li><a href='#connect+2CConnectionDB-method'><p>connect method for ConnectionDB class</p></a></li>
<li><a href='#connect+2CConnectionODBC-method'><p>connect method for ConnectionODBC class</p></a></li>
<li><a href='#connect+2CRequeteODBC-method'><p>connect method loads a request to the database and returns either an error or a data.frame</p></a></li>
<li><a href='#connect+2CRequeteODBCwhere-method'><p>connect method loads a request to the database and returns either an error or a data.frame</p></a></li>
<li><a href='#connect+2CRequeteODBCwheredate-method'><p>connect method loads a request to the database and returns either an error or a data.frame</p></a></li>
<li><a href='#ConnectionDB-class'><p>ConnectionDB class</p></a></li>
<li><a href='#ConnectionODBC-class'><p>ConnectionODBC class</p></a></li>
<li><a href='#ex'><p>ex fonction to write to the clipboard</p></a></li>
<li><a href='#funhtml'><p>function used to print the html tables of output (see xtable documentation)</p></a></li>
<li><a href='#getquery'><p>generic query function for</p></a></li>
<li><a href='#getquery+2CRequeteDB-method'><p>getquery retreives the result of the query from the object</p></a></li>
<li><a href='#induk'><p>unique values of a vector</p></a></li>
<li><a href='#is.even'><p>is.even function modified from package sma</p></a></li>
<li><a href='#is.odd'><p>id.odd function modified from package sma</p></a></li>
<li><a href='#killfactor'><p>very usefull function used to &quot;kill&quot; the factors, noticeably after loading with 'ODBC'</p></a></li>
<li><a href='#query'><p>generic query function for</p></a></li>
<li><a href='#query+2CRequeteDB-method'><p>query method loads a quert to the data and returns either an error or a data.frame</p></a></li>
<li><a href='#query+2CRequeteDBwhere-method'><p>query method loads a request to the database and returns either an error or a data.frame</p></a></li>
<li><a href='#query+2CRequeteDBwheredate-method'><p>query method loads a request to the database and returns either an error or a data.frame</p></a></li>
<li><a href='#RequeteDB-class'><p>RequeteDB class</p></a></li>
<li><a href='#RequeteDBwhere-class'><p>RequeteDBwhere class</p></a></li>
<li><a href='#RequeteDBwheredate-class'><p>RequeteDBwhere class</p></a></li>
<li><a href='#RequeteODBC-class'><p>RequeteODBC class</p></a></li>
<li><a href='#RequeteODBCwhere-class'><p>RequeteODBCwhere class</p></a></li>
<li><a href='#RequeteODBCwheredate-class'><p>RequeteODBCwhere class</p></a></li>
<li><a href='#stacomirtools-deprecated'><p>Deprecated Functions</p></a></li>
<li><a href='#tab2df'><p>Function to transform a ftable into dataframe but just keeping the counts,</p>
works with ftable of dim 2</a></li>
<li><a href='#validity_DB'><p>validity function for ConnectionDB class</p></a></li>
<li><a href='#validity_ODBC'><p>Validity method for ODBC class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.6.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-28</td>
</tr>
<tr>
<td>Title:</td>
<td>Connection Class for Package stacomiR</td>
</tr>
<tr>
<td>Author:</td>
<td>Cedric Briand [aut, cre],
  Marion Legrand [aut],
  Beaulaton Laurent [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cedric Briand &lt;cedric.briand00@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>S4 class wrappers for the 'ODBC' and Pool DBI connection, also provides some 
    utilities to paste small datasets to clipboard, rename columns. It is used by the package 'stacomiR' for
    connections to the database. Development versions of 'stacomiR' are available in R-forge.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Collate:</td>
<td>'ConnectionODBC.R' 'RequeteODBC.R' 'RequeteODBCwhere.R'
'RequeteODBCwheredate.R' 'utilities.R' 'stacomirtools.R'
'stacomirtools-package.R''ConnectionDB.R' 'RequeteDB.R'
'RequeteDBwhere.R' 'RequeteDBwheredate.R' 'zzz.R'</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>RODBC, DBI, pool</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, xtable, utils, RPostgres</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, withr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-29 10:00:13 UTC; cedric.briand</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-29 11:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='stacomirtools'>Stacomirtools options.</h2><span id='topic+stacomirtools'></span><span id='topic+stacomirtools-package'></span>

<h3>Description</h3>

<p>S4 class wrappers for the 'ODBC' and Pool DBI connection, also provides some utilities to paste small datasets to clipboard, rename columns. It is used by the package 'stacomiR' for connections to the database. Development versions of 'stacomiR' are available in R-forge.
</p>


<h3>Package options</h3>

<p>stacomirtools uses the following [options()] to configure behaviour:
</p>

<ul>
<li><p> 'stacomiR.dbname': databasename
</p>
</li>
<li><p> 'stacomiR.host': the name of the host, often [&quot;localhost&quot;]
</p>
</li>
<li><p> 'stacomiR.port': the name of the port, most often [&quot;5432&quot;]
</p>
</li>
<li><p> &lsquo;stacomiR.user': a string with the user name e.g. [&quot;postgres&quot;]#&rsquo;     
</p>
</li>
<li><p> 'stacomiR.password': a string with the user password
</p>
</li>
<li><p> 'stacomiR.ODBClink': a string with name of the ODBC link, default NULL
</p>
</li>
<li><p> 'stacomiR.path': a string with the path to where some output are written  
</p>
</li>
<li><p> 'stacomiR.printqueries': a boolean, default FALSE, with the side effect of printing queries to the console
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Cedric Briand <a href="mailto:cedric.briand00@gmail.com">cedric.briand00@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Marion Legrand <a href="mailto:tableau-salt-loire@logrami.fr">tableau-salt-loire@logrami.fr</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Beaulaton Laurent <a href="mailto:laurent.beaulaton@ofb.gouv.fr">laurent.beaulaton@ofb.gouv.fr</a> [contributor]
</p>
</li></ul>


<hr>
<h2 id='chnames'>This function replaces the variable names in a data.frame</h2><span id='topic+chnames'></span>

<h3>Description</h3>

<p>This function replaces the variable names in a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chnames(object, old_variable_name, new_variable_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chnames_+3A_object">object</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="chnames_+3A_old_variable_name">old_variable_name</code></td>
<td>
<p>a character vector with old variables names</p>
</td></tr>
<tr><td><code id="chnames_+3A_new_variable_name">new_variable_name</code></td>
<td>
<p>a character vector with new variables names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- data.frame("var1" = c("blue","red"), "var2" = c("nice","ugly"))
colnames(df) # "var1" "var2"
df &lt;- chnames(object = df, old_variable_name = c("var1","var2"), 
"new_variable_name" = c("color","beauty"))
colnames(df) # "color"  "beauty"
# the following will return an error, as the variable wrong_name is not in variable names
## Not run: 
chnames(object = df, old_variable_name = c("wrong_name"), 
"new_variable_name" = c("color")))

## End(Not run)

</code></pre>

<hr>
<h2 id='connect'>generic connect function for baseODBC</h2><span id='topic+connect'></span><span id='topic+connect.generic'></span>

<h3>Description</h3>

<p>generic connect function for baseODBC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>connect(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="connect_+3A_object">object</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="connect_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to the connect method</p>
</td></tr>
</table>

<hr>
<h2 id='connect+2CConnectionDB-method'>connect method for ConnectionDB class</h2><span id='topic+connect+2CConnectionDB-method'></span><span id='topic+connect.ConnectionDB'></span>

<h3>Description</h3>

<p>connect method for ConnectionDB class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ConnectionDB'
connect(object, base = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="connect+2B2CConnectionDB-method_+3A_object">object</code></td>
<td>
<p>An object of class ConnectionDB</p>
</td></tr>
<tr><td><code id="connect+2B2CConnectionDB-method_+3A_base">base</code></td>
<td>
<p>a string with values for dbname, host, port, user, password, in this order.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a connection with slot filled
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
object &lt;- new("ConnectionDB")
object@dbname &lt;- c("bd_contmig_nat","test")
object@host &lt;- 		"localhost"
object@port &lt;-		"5432"
object@user &lt;-		"myuser"
object@password &lt;-		"mypassword"
object@silent=FALSE
object &lt;- connect(object)
pool::dbGetInfo(object@connection)
pool::poolClose(object@connection)

## End(Not run)
</code></pre>

<hr>
<h2 id='connect+2CConnectionODBC-method'>connect method for ConnectionODBC class</h2><span id='topic+connect+2CConnectionODBC-method'></span><span id='topic+connect.ConnectionODBC'></span>

<h3>Description</h3>

<p>connect method for ConnectionODBC class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ConnectionODBC'
connect(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="connect+2B2CConnectionODBC-method_+3A_object">object</code></td>
<td>
<p>an object of class ConnectionODBC</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a connection with slot filled
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##this wont be run as the user need to manually configure the connection before using it
## Not run: 
object=new("ConnectionODBC")
object@baseODBC=c("myODBCconnection","myusername","mypassword")
object@silent=FALSE
object&lt;-connect(object)
odbcClose(object@connection)

## End(Not run)
</code></pre>

<hr>
<h2 id='connect+2CRequeteODBC-method'>connect method loads a request to the database and returns either an error or a data.frame</h2><span id='topic+connect+2CRequeteODBC-method'></span><span id='topic+connect.RequeteODBC'></span>

<h3>Description</h3>

<p>connect method loads a request to the database and returns either an error or a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RequeteODBC'
connect(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="connect+2B2CRequeteODBC-method_+3A_object">object</code></td>
<td>
<p>an object of class RequeteODBC</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class RequeteODBC
</p>


<h3>Note</h3>

<p>assign(&quot;showmerequest&quot;,1,envir=envir_stacomi) allows to print all queries passing on the class RequeteDB
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("RequeteODBC")
## Not run: 
object=new("RequeteODBC")
object@open=TRUE
object@baseODBC=baseODBC
object@sql= "select * from t_lot_lot limit 100"
object&lt;-connect(object)
odbcClose(object@connection)
odbcCloseAll()
  object=new("RequeteODBC")
  object@open=TRUE 
  ## this will leave the connection open, 
  ## by default it closes after the query is sent
  ## the following will work only if you have configured and ODBC link
  object@baseODBC=c("myODBCconnection","myusername","mypassword")
  object@sql= "select * from mytable limit 100"
  object&lt;-connect(object)
  odbcClose(object@connection)
  envir_stacomi=new.env()
  ## While testing if you want to see the output of sometimes 
  ## complex queries generated by the program
  assign("showmerequest",1,envir_stacomi) 
  ## You can assign any values (here 1)
  ## just tests the existence of "showmerequest" in envir_stacomi
  object=new("RequeteODBC")
  object@baseODBC=c("myODBCconnection","myusername","mypassword")
  object@sql= "select * from mytable limit 100"
  object&lt;-connect(object)
 ## the connection is already closed, the query is printed

## End(Not run)
</code></pre>

<hr>
<h2 id='connect+2CRequeteODBCwhere-method'>connect method loads a request to the database and returns either an error or a data.frame</h2><span id='topic+connect+2CRequeteODBCwhere-method'></span><span id='topic+connect.RequeteODBCwhere'></span>

<h3>Description</h3>

<p>connect method loads a request to the database and returns either an error or a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RequeteODBCwhere'
connect(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="connect+2B2CRequeteODBCwhere-method_+3A_object">object</code></td>
<td>
<p>an object of class RequeteODBCwhere</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class RequeteODBCwhere
</p>


<h3>Note</h3>

<p>method modified from v0.2.1240 to use the connect method of the mother class
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
object&lt;-new("RequeteODBCwhere")
object@baseODBC&lt;-baseODBC
object@sql&lt;- "select * from t_lot_lot"
object@where&lt;-"WHERE lot_tax_code='2038'"
object@and&lt;-c("AND lot_std_code='CIV'","AND lot_ope_identifiant&lt;1000")
object@order_by&lt;-"ORDER BY lot_identifiant"
object&lt;-connect(object)

## End(Not run)
</code></pre>

<hr>
<h2 id='connect+2CRequeteODBCwheredate-method'>connect method loads a request to the database and returns either an error or a data.frame</h2><span id='topic+connect+2CRequeteODBCwheredate-method'></span><span id='topic+connect.RequeteODBCwheredate'></span>

<h3>Description</h3>

<p>connect method loads a request to the database and returns either an error or a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RequeteODBCwheredate'
connect(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="connect+2B2CRequeteODBCwheredate-method_+3A_object">object</code></td>
<td>
<p>an object of class RequeteODBCwheredate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class RequeteODBCwheredate
</p>


<h3>Note</h3>

<p>method modified from v0.2.1240 to use the connect method of the mother class which in turn will use the method of the mother class
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
object&lt;-new("RequeteODBCwheredate")
object@baseODBC&lt;-get("baseODBC",envir=envir_stacomi)
object@select&lt;- "select * from t_operation_ope"
object@datedebut=strptime("1996-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S")
object@datefin=strptime("2000-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S")
object@colonnedebut="ope_date_debut"
object@colonnefin="ope_date_fin"
object@and&lt;-c("AND ope_dic_identifiant=1","AND ope_dic_identifiant=2")
object@order_by&lt;-"ORDER BY ope_identifiant"
object@silent=FALSE
object&lt;-connect(object) 

## End(Not run)
</code></pre>

<hr>
<h2 id='ConnectionDB-class'>ConnectionDB class</h2><span id='topic+ConnectionDB-class'></span>

<h3>Description</h3>

<p>ConnectionDB class
</p>


<h3>Value</h3>

<p>connection an S4 object of class connectionDB
</p>


<h3>Slots</h3>


<dl>
<dt><code>dbname</code></dt><dd><p>name of the database, length 1</p>
</dd>
<dt><code>host</code></dt><dd><p>host default &quot;localhost&quot;, length 1</p>
</dd>
<dt><code>port</code></dt><dd><p>port of the database default &quot;5432&quot;, length 1</p>
</dd>
<dt><code>user</code></dt><dd><p>user of the database, length 1</p>
</dd>
<dt><code>password</code></dt><dd><p>password for the datatbase, length 1</p>
</dd>
<dt><code>silent</code></dt><dd><p>A &quot;logical&quot; stating if the program returns output to the user</p>
</dd>
<dt><code>status</code></dt><dd><p>Can be -1 or string</p>
</dd>
<dt><code>connection</code></dt><dd><p>Could be both string or S3</p>
</dd>
</dl>


<h3>Note</h3>

<p>Mother class for connection, opens the connection but does not shut it
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##this wont be run as the user need to manually configure the connection before using it
## Not run: 
object &lt;- new("ConnectionDB")
object@dbname &lt;- c("bd_contmig_nat","test")
object@host &lt;- 		"localhost"
object@port &lt;-		"5432"
object@user &lt;-		"myuser"
object@password &lt;-		"mypassword"
object@silent=FALSE
object &lt;- connect(object)
pool::dbGetInfo(object@connection)
pool::poolClose(object@connection)

## End(Not run)
</code></pre>

<hr>
<h2 id='ConnectionODBC-class'>ConnectionODBC class</h2><span id='topic+ConnectionODBC-class'></span>

<h3>Description</h3>

<p>ConnectionODBC class
</p>


<h3>Value</h3>

<p>connectionODBC an S4 object of class connectionODBC
</p>


<h3>Slots</h3>


<dl>
<dt><code>baseODBC</code></dt><dd><p>&quot;vector&quot; (of length 3, character)</p>
</dd>
<dt><code>silent</code></dt><dd><p>&quot;logical&quot;</p>
</dd>
<dt><code>etat</code></dt><dd><p>&quot;ANY&quot; # can be -1 or string</p>
</dd>
<dt><code>connection</code></dt><dd><p>&quot;ANY&quot; # could be both string or S3</p>
</dd>
</dl>


<h3>Note</h3>

<p>Mother class for connection, opens the connection but does not shut it
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##this wont be run as the user need to manually configure the connection before using it
## Not run: 
object=new("ConnectionODBC")
object@baseODBC=c("myODBCconnection","myusername","mypassword")
object@silent=FALSE
object&lt;-connect(object)
odbcClose(object@connection)

## End(Not run)
</code></pre>

<hr>
<h2 id='ex'>ex fonction to write to the clipboard</h2><span id='topic+ex'></span>

<h3>Description</h3>

<p>ex fonction to write to the clipboard
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex(d = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ex_+3A_d">d</code></td>
<td>
<p>a dataframe</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>

<hr>
<h2 id='funhtml'>function used to print the html tables of output (see xtable documentation)</h2><span id='topic+funhtml'></span>

<h3>Description</h3>

<p>see <span class="pkg">xtable</span> for further description, an xtable is created and printed
to html format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funhtml(
  data,
  caption = NULL,
  top = TRUE,
  outfile = NULL,
  clipboard = FALSE,
  append = TRUE,
  digits = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="funhtml_+3A_data">data</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="funhtml_+3A_caption">caption</code></td>
<td>
<p>the caption</p>
</td></tr>
<tr><td><code id="funhtml_+3A_top">top</code></td>
<td>
<p>a logical, if true the caption is placed on top</p>
</td></tr>
<tr><td><code id="funhtml_+3A_outfile">outfile</code></td>
<td>
<p>the path to the file</p>
</td></tr>
<tr><td><code id="funhtml_+3A_clipboard">clipboard</code></td>
<td>
<p>if clipboard TRUE, a copy to the clipboard is made</p>
</td></tr>
<tr><td><code id="funhtml_+3A_append">append</code></td>
<td>
<p>is the file appended to the previous one ?</p>
</td></tr>
<tr><td><code id="funhtml_+3A_digits">digits</code></td>
<td>
<p>the number of digits</p>
</td></tr>
<tr><td><code id="funhtml_+3A_...">...</code></td>
<td>
<p>additional parameters to be passed to the function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an xtable
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>

<hr>
<h2 id='getquery'>generic query function for</h2><span id='topic+getquery'></span>

<h3>Description</h3>

<p>generic query function for
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getquery(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getquery_+3A_object">object</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="getquery_+3A_...">...</code></td>
<td>
<p>additional parameters passed to query</p>
</td></tr>
</table>

<hr>
<h2 id='getquery+2CRequeteDB-method'>getquery retreives the result of the query from the object</h2><span id='topic+getquery+2CRequeteDB-method'></span>

<h3>Description</h3>

<p>getquery retreives the result of the query from the object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RequeteDB'
getquery(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getquery+2B2CRequeteDB-method_+3A_object">object</code></td>
<td>
<p>an object of class RequeteDB</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame
</p>

<hr>
<h2 id='induk'>unique values of a vector</h2><span id='topic+induk'></span>

<h3>Description</h3>

<p>returns the index of values appearing only once in a vector :
match(unique(a),a), replicated values are not returned on their second
occurence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>induk(a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="induk_+3A_a">a</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the index unique values within a vector
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
induk(c(1,1,2,2,2,3))

</code></pre>

<hr>
<h2 id='is.even'>is.even function modified from package sma</h2><span id='topic+is.even'></span>

<h3>Description</h3>

<p>is.even function modified from package sma (which did not verify that the
entry was indeed an integer)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.even(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.even_+3A_x">x</code></td>
<td>
<p>integer</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical
</p>


<h3>Author(s)</h3>

<p>Adapted from Henrik Bengtsson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
is.even(1)
is.even(2)

</code></pre>

<hr>
<h2 id='is.odd'>id.odd function modified from package sma</h2><span id='topic+is.odd'></span>

<h3>Description</h3>

<p>id.odd function modified from package sma (which did not verify that the
entry was indeed an integer)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.odd(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.odd_+3A_x">x</code></td>
<td>
<p>integer</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical
</p>


<h3>Author(s)</h3>

<p>Adapted from Henrik Bengtsson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
is.odd(1)
is.odd(2)

</code></pre>

<hr>
<h2 id='killfactor'>very usefull function used to &quot;kill&quot; the factors, noticeably after loading with 'ODBC'</h2><span id='topic+killfactor'></span>

<h3>Description</h3>

<p>very usefull function used to &quot;kill&quot; the factors, noticeably after loading with 'ODBC'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>killfactor(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="killfactor_+3A_df">df</code></td>
<td>
<p>a data.frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>df
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>

<hr>
<h2 id='query'>generic query function for</h2><span id='topic+query'></span><span id='topic+query.RequeteDB'></span>

<h3>Description</h3>

<p>generic query function for
</p>


<h3>Usage</h3>

<pre><code class='language-R'>query(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="query_+3A_object">object</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="query_+3A_...">...</code></td>
<td>
<p>additional parameters passed to query</p>
</td></tr>
</table>

<hr>
<h2 id='query+2CRequeteDB-method'>query method loads a quert to the data and returns either an error or a data.frame</h2><span id='topic+query+2CRequeteDB-method'></span>

<h3>Description</h3>

<p>query method loads a quert to the data and returns either an error or a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RequeteDB'
query(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="query+2B2CRequeteDB-method_+3A_object">object</code></td>
<td>
<p>an object of class RequeteDB</p>
</td></tr>
<tr><td><code id="query+2B2CRequeteDB-method_+3A_...">...</code></td>
<td>
<p>further arguments passed to the query method, base will be passed to ConnectionDB to set the connection parameters,
it should be a vector with dbname host port user and password (in this order)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class RequeteDB
</p>


<h3>Note</h3>

<p>assign(&quot;showmerequest&quot;,1,envir=envir_stacomi) allows to print all queries passing on the class RequeteDB
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("RequeteDB")
## Not run: 
# this connection require user and password and a working data
 object=new("RequeteDB",dbname ="bd_contmig_nat",
			host ="localhost", port="5432", user ="postgres", password="secret")
)
object@open=TRUE
 ## this will leave the connection open, 
 ## by default it closes after the query is sent
 ## the following will work only if you have configured and ODBC link
object@sql= "select * from t_lot_lot limit 100"
object&lt;-query(object)
  envir_stacomi=new.env()
  ## While testing if you want to see the output of sometimes
  ## complex queries generated by the program
  assign("showmerequest",1,envir_stacomi) 
  ## You can assign any values (here 1)
  ## just tests the existence of "showmerequest" in envir_stacomi
  object@sql= "select * from mytable limit 100"
  object&lt;-connect(object)
 ## the connection is already closed, the query is printed

## End(Not run)
</code></pre>

<hr>
<h2 id='query+2CRequeteDBwhere-method'>query method loads a request to the database and returns either an error or a data.frame</h2><span id='topic+query+2CRequeteDBwhere-method'></span><span id='topic+query.RequeteODBCwhere'></span>

<h3>Description</h3>

<p>query method loads a request to the database and returns either an error or a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RequeteDBwhere'
query(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="query+2B2CRequeteDBwhere-method_+3A_object">object</code></td>
<td>
<p>an object of class RequeteDBwhere</p>
</td></tr>
<tr><td><code id="query+2B2CRequeteDBwhere-method_+3A_...">...</code></td>
<td>
<p>further arguments passed to the query method, base will be passed to ConnectionDB to set the connection parameters,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class RequeteODBCwhere
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
object&lt;-new("RequeteODBCwhere")
base=c("bd_contmig_nat","localhost","5432","user", "password")
object@sql&lt;- "select * from t_lot_lot"
object@where&lt;-"WHERE lot_tax_code='2038'"
object@and&lt;-c("AND lot_std_code='CIV'","AND lot_ope_identifiant&lt;1000")
object@order_by&lt;-"ORDER BY lot_identifiant"
object &lt;- connect(object, base)

## End(Not run)
</code></pre>

<hr>
<h2 id='query+2CRequeteDBwheredate-method'>query method loads a request to the database and returns either an error or a data.frame</h2><span id='topic+query+2CRequeteDBwheredate-method'></span><span id='topic+query.RequeteDBwheredate'></span>

<h3>Description</h3>

<p>query method loads a request to the database and returns either an error or a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RequeteDBwheredate'
query(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="query+2B2CRequeteDBwheredate-method_+3A_object">object</code></td>
<td>
<p>an object of class RequeteDBwheredate</p>
</td></tr>
<tr><td><code id="query+2B2CRequeteDBwheredate-method_+3A_...">...</code></td>
<td>
<p>further arguments passed to the query method, base will be passed to ConnectionDB to set the connection parameters,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class RequeteDBwheredate
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
object&lt;-new("RequeteDBwheredate")
base=c("bd_contmig_nat","localhost","5432","user", "password")
object@select&lt;- "select * from t_operation_ope"
object@datedebut=strptime("1996-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S")
object@datefin=strptime("2000-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S")
object@colonnedebut="ope_date_debut"
object@colonnefin="ope_date_fin"
object@and&lt;-c("AND ope_dic_identifiant=1","AND ope_dic_identifiant=2")
object@order_by&lt;-"ORDER BY ope_identifiant"
object@silent=FALSE
object&lt;-connect(object, base)

## End(Not run)
</code></pre>

<hr>
<h2 id='RequeteDB-class'>RequeteDB class</h2><span id='topic+RequeteDB-class'></span>

<h3>Description</h3>

<p>RequeteDB class
</p>


<h3>Slots</h3>


<dl>
<dt><code>sql</code></dt><dd><p>&quot;character&quot;</p>
</dd>
<dt><code>query</code></dt><dd><p>&quot;data.frame&quot;</p>
</dd>
<dt><code>open</code></dt><dd><p>logical is the connection left open after the request ?</p>
</dd>
</dl>


<h3>Note</h3>

<p>Inherits from ConnectionDB
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> object=new("RequeteDB")
</code></pre>

<hr>
<h2 id='RequeteDBwhere-class'>RequeteDBwhere class</h2><span id='topic+RequeteDBwhere-class'></span>

<h3>Description</h3>

<p>RequeteDBwhere class
</p>


<h3>Slots</h3>


<dl>
<dt><code>select</code></dt><dd><p>&quot;character&quot;</p>
</dd>
<dt><code>where</code></dt><dd><p>&quot;character&quot;</p>
</dd>
<dt><code>and</code></dt><dd><p>&quot;vector&quot;</p>
</dd>
<dt><code>order_by</code></dt><dd><p>&quot;character&quot;</p>
</dd>
</dl>


<h3>Note</h3>

<p>Inherits from RequeteDB
the syntax is where=&quot;WHERE ...&quot;
and =vector(&quot;AND...&quot;,&quot;AND...&quot;)
order_by=&quot;ORDER BY..&quot;
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> object=new("RequeteDBwhere")
</code></pre>

<hr>
<h2 id='RequeteDBwheredate-class'>RequeteDBwhere class</h2><span id='topic+RequeteDBwheredate-class'></span>

<h3>Description</h3>

<p>RequeteDBwhere class
</p>


<h3>Slots</h3>


<dl>
<dt><code>datedebut</code></dt><dd><p>&quot;POSIXlt&quot;</p>
</dd>
<dt><code>datefin</code></dt><dd><p>&quot;POSIXlt&quot;</p>
</dd>
<dt><code>colonnedebut</code></dt><dd><p>&quot;character&quot; # name of the column containing datedebut</p>
</dd>
<dt><code>colonnefin</code></dt><dd><p>&quot;character&quot;  # name of the column containing datefin</p>
</dd>
</dl>


<h3>Note</h3>

<p>Inherits from RequeteDBwhere and uses its connect method with a new SetAs
</p>


<h3>Examples</h3>

<pre><code class='language-R'>object=new("RequeteDBwhere")
</code></pre>

<hr>
<h2 id='RequeteODBC-class'>RequeteODBC class</h2><span id='topic+RequeteODBC-class'></span>

<h3>Description</h3>

<p>RequeteODBC class
</p>


<h3>Slots</h3>


<dl>
<dt><code>sql</code></dt><dd><p>&quot;character&quot;</p>
</dd>
<dt><code>query</code></dt><dd><p>&quot;data.frame&quot;</p>
</dd>
<dt><code>open</code></dt><dd><p>logical is the connection left open after the request ?</p>
</dd>
</dl>


<h3>Note</h3>

<p>Inherits from ConnectionODBC
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> object=new("RequeteODBC")
</code></pre>

<hr>
<h2 id='RequeteODBCwhere-class'>RequeteODBCwhere class</h2><span id='topic+RequeteODBCwhere-class'></span>

<h3>Description</h3>

<p>RequeteODBCwhere class
</p>


<h3>Slots</h3>


<dl>
<dt><code>select</code></dt><dd><p>&quot;character&quot;</p>
</dd>
<dt><code>where</code></dt><dd><p>&quot;character&quot;</p>
</dd>
<dt><code>and</code></dt><dd><p>&quot;vector&quot;</p>
</dd>
<dt><code>order_by</code></dt><dd><p>&quot;character&quot;</p>
</dd>
</dl>


<h3>Note</h3>

<p>Inherits from RequeteODBC
the syntax is where=&quot;WHERE ...&quot;
and =vector(&quot;AND...&quot;,&quot;AND...&quot;)
order_by=&quot;ORDER BY..&quot;
</p>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> object=new("RequeteODBCwhere")
</code></pre>

<hr>
<h2 id='RequeteODBCwheredate-class'>RequeteODBCwhere class</h2><span id='topic+RequeteODBCwheredate-class'></span>

<h3>Description</h3>

<p>RequeteODBCwhere class
</p>


<h3>Slots</h3>


<dl>
<dt><code>datedebut</code></dt><dd><p>&quot;POSIXlt&quot;</p>
</dd>
<dt><code>datefin</code></dt><dd><p>&quot;POSIXlt&quot;</p>
</dd>
<dt><code>colonnedebut</code></dt><dd><p>&quot;character&quot; # name of the column containing datedebut</p>
</dd>
<dt><code>colonnefin</code></dt><dd><p>&quot;character&quot;  # name of the column containing datefin</p>
</dd>
</dl>


<h3>Note</h3>

<p>Inherits from RequeteODBCwhere and uses its connect method with a new SetAs
</p>


<h3>Examples</h3>

<pre><code class='language-R'> object=new("RequeteODBCwhere")
</code></pre>

<hr>
<h2 id='stacomirtools-deprecated'>Deprecated Functions</h2><span id='topic+stacomirtools-deprecated'></span>

<h3>Description</h3>

<p>These functions are Deprecated in this release of devtools, they will be
marked as Defunct and removed in a future version.
</p>

<hr>
<h2 id='tab2df'>Function to transform a ftable into dataframe but just keeping the counts,
works with ftable of dim 2</h2><span id='topic+tab2df'></span>

<h3>Description</h3>

<p>Function to transform a ftable into dataframe but just keeping the counts
works with ftable of dim 2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tab2df(tab)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tab2df_+3A_tab">tab</code></td>
<td>
<p>a flat table</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cedric Briand <a href="mailto:cedric.briand@eptb-vilaine.fr">cedric.briand@eptb-vilaine.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- data.frame("var1" = c("blue","red"), "var2" = c("nice","ugly"))
ftdf &lt;- ftable(df)
tab2df(ftdf)

</code></pre>

<hr>
<h2 id='validity_DB'>validity function for ConnectionDB class</h2><span id='topic+validity_DB'></span>

<h3>Description</h3>

<p>validity function for ConnectionDB class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validity_DB(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validity_DB_+3A_object">object</code></td>
<td>
<p>An object of class ConnectionDB</p>
</td></tr>
</table>

<hr>
<h2 id='validity_ODBC'>Validity method for ODBC class</h2><span id='topic+validity_ODBC'></span>

<h3>Description</h3>

<p>Validity method for ODBC class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validity_ODBC(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validity_ODBC_+3A_object">object</code></td>
<td>
<p>an object of class ConnectionODBC</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
