<!DOCTYPE html><html lang="en"><head><title>Help for package PCAmatchR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PCAmatchR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eigenvalues_1000G'><p>First 20 eigenvalues of 2504 individuals from the 1000 Genome Project</p></a></li>
<li><a href='#eigenvalues_all_1000G'><p>All eigenvalues of 2504 individuals from the 1000 Genome Project</p></a></li>
<li><a href='#match_maker'><p>Weighted matching of controls to cases using PCA results.</p></a></li>
<li><a href='#PCs_1000G'><p>First 20 principal components of 2504 individuals from the 1000 Genome Project</p></a></li>
<li><a href='#plot_maker'><p>Function to plot matches from match_maker output</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Match Cases to Controls Based on Genotype Principal Components</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Derek W. Brown &lt;derek9@gwmail.gwu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Matches cases to controls based on genotype principal components (PC). 
      In order to produce better results, matches are based on the weighted 
      distance of PCs where the weights are equal to the % variance explained 
      by that PC. A weighted Mahalanobis distance metric (Kidd et al. (1987)
      &lt;<a href="https://doi.org/10.1016%2F0031-3203%2887%2990066-5">doi:10.1016/0031-3203(87)90066-5</a>&gt;) is used to determine matches. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/machiela-lab/PCAmatchR">https://github.com/machiela-lab/PCAmatchR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/machiela-lab/PCAmatchR/issues">https://github.com/machiela-lab/PCAmatchR/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>optmatch, testthat, knitr, rmarkdown, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-30 12:24:40 UTC; myersta</td>
</tr>
<tr>
<td>Author:</td>
<td>Derek W. Brown <a href="https://orcid.org/0000-0001-8393-1713"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Mitchel J. Machiela
    <a href="https://orcid.org/0000-0001-6538-9705"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Timothy A. Myers <a href="https://orcid.org/0000-0001-8127-3446"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  NCI [cph, fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-01 00:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='eigenvalues_1000G'>First 20 eigenvalues of 2504 individuals from the 1000 Genome Project</h2><span id='topic+eigenvalues_1000G'></span>

<h3>Description</h3>

<p>A sample dataset containing the first 20 eigenvalues
calculated from 2504 individuals in the Phase 3 data
release of the 1000 Genomes Project. The principal
component analysis was conducted using PLINK.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenvalues_1000G
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 1 variable:
</p>

<dl>
<dt>eigen_values</dt><dd><p>calculated eigenvalues</p>
</dd>
</dl>



<h3>Source</h3>

<p>Machiela Lab
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  eigenvalues_1000G
genome_values &lt;- eigenvalues_1000G
          values &lt;- c(genome_values)$eigen_values


</code></pre>

<hr>
<h2 id='eigenvalues_all_1000G'>All eigenvalues of 2504 individuals from the 1000 Genome Project</h2><span id='topic+eigenvalues_all_1000G'></span>

<h3>Description</h3>

<p>A sample dataset containing all the eigenvalues
calculated from 2504 individuals in the Phase 3 data
release of the 1000 Genomes Project. The principal
component analysis was conducted using PLINK.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenvalues_all_1000G
</code></pre>


<h3>Format</h3>

<p>A data frame with 2504 rows and 1 variable:
</p>

<dl>
<dt>eigen_values</dt><dd><p>calculated eigenvalues</p>
</dd>
</dl>



<h3>Source</h3>

<p>Machiela Lab
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  eigenvalues_all_1000G
genome_values &lt;- eigenvalues_all_1000G
          values &lt;- c(genome_values)$eigen_values


</code></pre>

<hr>
<h2 id='match_maker'>Weighted matching of controls to cases using PCA results.</h2><span id='topic+match_maker'></span>

<h3>Description</h3>

<p>Weighted matching of controls to cases using PCA results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_maker(
  PC = NULL,
  eigen_value = NULL,
  data = NULL,
  ids = NULL,
  case_control = NULL,
  num_controls = 1,
  num_PCs = NULL,
  eigen_sum = NULL,
  exact_match = NULL,
  weight_dist = TRUE,
  weights = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="match_maker_+3A_pc">PC</code></td>
<td>
<p>Individual level principal component.</p>
</td></tr>
<tr><td><code id="match_maker_+3A_eigen_value">eigen_value</code></td>
<td>
<p>Computed eigenvalue for each PC. Used as the numerator to calculate the percent variance explained by each PC.</p>
</td></tr>
<tr><td><code id="match_maker_+3A_data">data</code></td>
<td>
<p>Dataframe containing id and case/control status. Optionally includes covariate data for exact matching.</p>
</td></tr>
<tr><td><code id="match_maker_+3A_ids">ids</code></td>
<td>
<p>The unique id variable contained in both &quot;PC&quot; and &quot;data.&quot;</p>
</td></tr>
<tr><td><code id="match_maker_+3A_case_control">case_control</code></td>
<td>
<p>The case control status variable.</p>
</td></tr>
<tr><td><code id="match_maker_+3A_num_controls">num_controls</code></td>
<td>
<p>The number of controls to match to each case. Default is 1:1 matching.</p>
</td></tr>
<tr><td><code id="match_maker_+3A_num_pcs">num_PCs</code></td>
<td>
<p>The total number of PCs calculated within the PCA. Can be used as the denomiator to calculate the percent variance explained by each PC. Default is 1000.</p>
</td></tr>
<tr><td><code id="match_maker_+3A_eigen_sum">eigen_sum</code></td>
<td>
<p>The sum of all possible eigenvalues within the PCA. Can be used as the denomiator to calculate the percent variance explained by each PC.</p>
</td></tr>
<tr><td><code id="match_maker_+3A_exact_match">exact_match</code></td>
<td>
<p>Optional variables contained in the dataframe on which to perform exact matching (i.e. sex, race, etc.).</p>
</td></tr>
<tr><td><code id="match_maker_+3A_weight_dist">weight_dist</code></td>
<td>
<p>When set to true, matches are produced based on PC weighted Mahalanobis distance. Default is TRUE.</p>
</td></tr>
<tr><td><code id="match_maker_+3A_weights">weights</code></td>
<td>
<p>Optional user defined weights used to compute the weighted Mahalanobis distance metric.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of matches and weights.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create PC data frame by subsetting provided example dataset
pcs &lt;- as.data.frame(PCs_1000G[,c(1,5:24)])
# Create eigenvalues vector using example dataset
eigen_vals &lt;- c(eigenvalues_1000G)$eigen_values
# Create full eigenvalues vector using example dataset
all_eigen_vals&lt;- c(eigenvalues_all_1000G)$eigen_values
# Create Covarite data frame
cov_data &lt;- PCs_1000G[,c(1:4)]
# Generate a case status variable using ESN 1000 Genome population
cov_data$case &lt;- ifelse(cov_data$pop=="ESN", c(1), c(0))
# With 1 to 1 matching
if(requireNamespace("optmatch", quietly = TRUE)){
                        library(optmatch)
                        match_maker(PC = pcs,
                                    eigen_value = eigen_vals,
                                    data = cov_data,
                                    ids = c("sample"),
                                    case_control = c("case"),
                                    num_controls = 1,
                                    eigen_sum = sum(all_eigen_vals),
                                    weight_dist=TRUE
                                   )
                        }

</code></pre>

<hr>
<h2 id='PCs_1000G'>First 20 principal components of 2504 individuals from the 1000 Genome Project</h2><span id='topic+PCs_1000G'></span>

<h3>Description</h3>

<p>A sample dataset containing information about population, gender, and
the first 20 principal components calculated from 2504 individuals
in the Phase 3 data release of the 1000 Genomes Project. The principal
component analysis was conducted using PLINK.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PCs_1000G
</code></pre>


<h3>Format</h3>

<p>A data frame with 2504 rows and 24 variables:
</p>

<dl>
<dt>sample</dt><dd><p>sample ID number</p>
</dd>
<dt>pop</dt><dd><p>three letter designation of 1000 Genomes reference population</p>
</dd>
<dt>super_pop</dt><dd><p>three letter designation of 1000 Genomes reference super population</p>
</dd>
<dt>gender</dt><dd><p>gender of individual</p>
</dd>
<dt>PC1</dt><dd><p>principal component 1</p>
</dd>
<dt>PC2</dt><dd><p>principal component 2</p>
</dd>
<dt>PC3</dt><dd><p>principal component 3</p>
</dd>
<dt>PC4</dt><dd><p>principal component 4</p>
</dd>
<dt>PC5</dt><dd><p>principal component 5</p>
</dd>
<dt>PC6</dt><dd><p>principal component 6</p>
</dd>
<dt>PC7</dt><dd><p>principal component 7</p>
</dd>
<dt>PC8</dt><dd><p>principal component 8</p>
</dd>
<dt>PC9</dt><dd><p>principal component 9</p>
</dd>
<dt>PC10</dt><dd><p>principal component 10</p>
</dd>
<dt>PC11</dt><dd><p>principal component 11</p>
</dd>
<dt>PC12</dt><dd><p>principal component 12</p>
</dd>
<dt>PC13</dt><dd><p>principal component 13</p>
</dd>
<dt>PC14</dt><dd><p>principal component 14</p>
</dd>
<dt>PC15</dt><dd><p>principal component 15</p>
</dd>
<dt>PC16</dt><dd><p>principal component 16</p>
</dd>
<dt>PC17</dt><dd><p>principal component 17</p>
</dd>
<dt>PC18</dt><dd><p>principal component 18</p>
</dd>
<dt>PC19</dt><dd><p>principal component 19</p>
</dd>
<dt>PC20</dt><dd><p>principal component 20</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.internationalgenome.org">https://www.internationalgenome.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(PCs_1000G)
genome_PC &lt;- PCs_1000G
# Create PCs
           PC &lt;- as.data.frame(genome_PC[,c(1,5:24)])
           head(PC)

</code></pre>

<hr>
<h2 id='plot_maker'>Function to plot matches from match_maker output</h2><span id='topic+plot_maker'></span>

<h3>Description</h3>

<p>Function to plot matches from match_maker output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_maker(
  data = NULL,
  x_var = NULL,
  y_var = NULL,
  case_control = NULL,
  line = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_maker_+3A_data">data</code></td>
<td>
<p>match_maker output</p>
</td></tr>
<tr><td><code id="plot_maker_+3A_x_var">x_var</code></td>
<td>
<p>Principal component 1</p>
</td></tr>
<tr><td><code id="plot_maker_+3A_y_var">y_var</code></td>
<td>
<p>Principal component 2</p>
</td></tr>
<tr><td><code id="plot_maker_+3A_case_control">case_control</code></td>
<td>
<p>Case or control status</p>
</td></tr>
<tr><td><code id="plot_maker_+3A_line">line</code></td>
<td>
<p>draw line</p>
</td></tr>
<tr><td><code id="plot_maker_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# run match_maker()
# Create PC data frame by subsetting provided example dataset
pcs &lt;- as.data.frame(PCs_1000G[,c(1,5:24)])
# Create eigenvalues vector using example dataset
eigen_vals &lt;- c(eigenvalues_1000G)$eigen_values
# Create full eigenvalues vector using example dataset
all_eigen_vals&lt;- c(eigenvalues_all_1000G)$eigen_values
# Create Covarite data frame
cov_data &lt;- PCs_1000G[,c(1:4)]
# Generate a case status variable using ESN 1000 Genome population
cov_data$case &lt;- ifelse(cov_data$pop=="ESN", c(1), c(0))
# With 1 to 1 matching
 if(requireNamespace("optmatch", quietly = TRUE)){
 library(optmatch)
 match_maker_output&lt;- match_maker(PC = pcs,
                                 eigen_value = eigen_vals,
                                 data = cov_data,
                                 ids = c("sample"),
                                 case_control = c("case"),
                                 num_controls = 1,
                                 eigen_sum = sum(all_eigen_vals),
                                 weight_dist=TRUE
                                 )

# run plot_maker()
 plot_maker(data=match_maker_output,
            x_var="PC1",
            y_var="PC2",
            case_control="case",
            line=TRUE)
 }


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
