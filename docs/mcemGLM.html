<!DOCTYPE html><html><head><title>Help for package mcemGLM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mcemGLM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mcemGLM-package'>
<p>Generalized Linear Mixed Model Estimation via Monte Carlo EM</p></a></li>
<li><a href='#anova.mcemGLMM'><p>Anova method for mcemGLMM objects</p></a></li>
<li><a href='#coef.mcemGLMM'><p>Anova method for mcemGLMM objects</p></a></li>
<li><a href='#contrasts.mcemGLMM'><p>Contrast estimation for mcemGLMM objects</p></a></li>
<li><a href='#covMat.mcemGLMM'><p>Anova method for mcemGLMM objects</p></a></li>
<li><a href='#epilepsy'>
<p>Epilesy Data</p></a></li>
<li><a href='#exdata'>
<p>Example data</p></a></li>
<li><a href='#mcemGLMM'><p>Generalized Linear Mixed Models Estimation</p></a></li>
<li><a href='#mcemGLMMext'><p>Extending the Iterations of a Model Fitted with mcemGLMM</p></a></li>
<li><a href='#predict.mcemGLMM'><p>Predict method for mcemGLMM objects</p></a></li>
<li><a href='#ranef.mcemGLMM'><p>Anova method for mcemGLMM objects</p></a></li>
<li><a href='#residuals.mcemGLMM'><p>Residual extraction method for mcemGLMM objects</p></a></li>
<li><a href='#salamander'>
<p>Salamander Data</p></a></li>
<li><a href='#simData'>
<p>Data used for fitting examples</p></a></li>
<li><a href='#summary.mcemGLMM'><p>Summary method for mcemGLMM objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Maximum Likelihood Estimation for Generalized Linear Mixed
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-3-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Felipe Acosta Archila</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felipe Acosta Archila &lt;acosta.felipe@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood estimation for generalized linear mixed models via Monte Carlo EM.
    For a description of the algorithm see Brian S. Caffo, Wolfgang Jank and Galin L. Jones (2005)
	&lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2005.00499.x">doi:10.1111/j.1467-9868.2005.00499.x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>trust, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-29 09:20:58 UTC; Felip</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-01 07:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='mcemGLM-package'>
Generalized Linear Mixed Model Estimation via Monte Carlo EM
</h2><span id='topic+mcemGLM-package'></span><span id='topic+mcemGLM'></span>

<h3>Description</h3>

<p><code>mcemGLM</code> performs maximum likelihood estimation for logistic, 
Poisson, and negative binomial regression when random effects are 
present. The package uses an MCEM algorithm to estimate the model's 
fixed parameters and variance components with their respective 
standard errors.
</p>
<p>A Wald test based <code>anova</code> is available to test significance of 
multi-leveled variables and for multiple contrast testing.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mcemGLM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-01-12</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Felipe Acosta Archila
</p>
<p>Maintainer: Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
x &lt;- rnorm(30, 10, 1)
z &lt;- factor(rep(1:6, each = 5))
obs &lt;- sample(0:1, 30, TRUE)
fit &lt;- mcemGLMM(obs ~ x, random = ~ 0 + z, family = "bernoulli",
vcDist = "normal", controlEM = list(EMit = 15, MCit = 10000), 
initial = c(3.30, -0.35, 0.005))
summary(fit)
anova(fit)

</code></pre>

<hr>
<h2 id='anova.mcemGLMM'>Anova method for mcemGLMM objects</h2><span id='topic+anova'></span><span id='topic+anova.mcemGLMM'></span>

<h3>Description</h3>

<p>ANOVA table based on Wald tests for a model fitted with <code>mcemGLMM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcemGLMM'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.mcemGLMM_+3A_object">object</code></td>
<td>
<p>a model fitted with the mcemGLMM function.</p>
</td></tr>
<tr><td><code id="anova.mcemGLMM_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the rows corresponding to a test for the different 
terms of the model and the following columns:
</p>

<dl>
<dt>Df</dt><dd><p>degrees of freedom for the term.</p>
</dd>
<dt>Wald</dt><dd><p>Wald's chi squared statistic.</p>
</dd>
<dt>Pr</dt><dd><p>p value for the test statistic.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>

<hr>
<h2 id='coef.mcemGLMM'>Anova method for mcemGLMM objects</h2><span id='topic+coef'></span><span id='topic+coef.mcemGLMM'></span>

<h3>Description</h3>

<p>Extract the fixed effect coefficients from a model fitted with <code>mcemGLMM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcemGLMM'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.mcemGLMM_+3A_object">object</code></td>
<td>
<p>a model fitted with the mcemGLMM function.</p>
</td></tr>
<tr><td><code id="coef.mcemGLMM_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the fixed effect coefficients.
</p>


<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>

<hr>
<h2 id='contrasts.mcemGLMM'>Contrast estimation for mcemGLMM objects</h2><span id='topic+contrasts.mcemGLMM'></span>

<h3>Description</h3>

<p>Contrast testing for a model fitted with <code>mcemGLMM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrasts.mcemGLMM(object, ctr.mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contrasts.mcemGLMM_+3A_object">object</code></td>
<td>
<p>a model fitted with the mcemGLMM function.</p>
</td></tr>
<tr><td><code id="contrasts.mcemGLMM_+3A_ctr.mat">ctr.mat</code></td>
<td>
<p>contrast matrix. Each row corresponds to a 
linear combination of the fixed effect coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with each row corresponding to a contrast and with the following columns:
</p>

<dl>
<dt>Estimate</dt><dd><p>contrasts's point estimator.</p>
</dd>
<dt>Std. Err.</dt><dd><p>standard error for each fitted contrast.</p>
</dd>
<dt>Wald</dt><dd><p>Wald statistic for each fitted contrast.</p>
</dd>
<dt>Adj. p-value</dt><dd><p>p-value adjusted for multiple comparison (Bonferroni.)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(72327)
data(exdata)
fit &lt;- mcemGLMM(obs ~ z2 + x, random = ~ 0 + z1, 
                data = exdata, 
                family = "bernoulli", vcDist = "normal", 
                controlEM = list(verb = FALSE, EMit = 15, MCit = 10000), 
                initial = c(-0.13, -0.15, -0.21, 1.59, 0.002))
mat &lt;- rbind("1 - 2" = c(0, -1, 0, 0), "1 - 3" = c(0, 0, -1, 0), "2 - 3" = c(0, 1, -1, 0))
contrasts.mcemGLMM(fit, mat)

</code></pre>

<hr>
<h2 id='covMat.mcemGLMM'>Anova method for mcemGLMM objects</h2><span id='topic+covMat'></span><span id='topic+covMat.mcemGLMM'></span>

<h3>Description</h3>

<p>Extract the fixed effect's covariance matrix from a model fitted with <code>mcemGLMM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covMat.mcemGLMM(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covMat.mcemGLMM_+3A_object">object</code></td>
<td>
<p>a model fitted with the mcemGLMM function.</p>
</td></tr>
<tr><td><code id="covMat.mcemGLMM_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix corresponding to the covariance matrix of the fixed effects.
</p>


<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>

<hr>
<h2 id='epilepsy'>
Epilesy Data
</h2><span id='topic+epilepsy'></span>

<h3>Description</h3>

<p>Data from an experiment with $i=1,...,59$ epilepsy patients. Each of the 
patients was assigned to a control group or a treatment group. The experiment
recorded the number of seizures experienced by each patient over four 
two-week periods. The experiment also recorded a baseline count of the 
number of seizures the patients had experienced during the previous eight weeks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("epilepsy")</code></pre>


<h3>Format</h3>

<p>A data frame with 236 observations on the following 6 variables.
</p>

<dl>
<dt><code>count</code></dt><dd><p>Number of seizures experienced.</p>
</dd>
<dt><code>id</code></dt><dd><p>Patient ID.</p>
</dd>
<dt><code>group</code></dt><dd><p>Treatment or control groups.</p>
</dd>
<dt><code>age</code></dt><dd><p>The logarithm of the patient's age.</p>
</dd>
<dt><code>base</code></dt><dd><p>The logarithm of baseline/4.</p>
</dd>
<dt><code>visit</code></dt><dd><p>The corresponding time period.</p>
</dd>
</dl>



<h3>References</h3>

<p>Thall, P. F. and Vail, S. C. (1990) Some covariance models for
longitudinal count data with overdispersion In <em>Biometrics</em> 46, 657&ndash;671
</p>

<hr>
<h2 id='exdata'>
Example data
</h2><span id='topic+exdata'></span>

<h3>Description</h3>

<p>Simulated binary response dataset to use in examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("exdata")</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 4 variables.
</p>

<dl>
<dt><code>obs</code></dt><dd><p>a numeric binary vector</p>
</dd>
<dt><code>obs2</code></dt><dd><p>a numeric count vector</p>
</dd>
<dt><code>x</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>z1</code></dt><dd><p>a factor with levels <code>1</code>, and <code>2</code></p>
</dd>
<dt><code>z2</code></dt><dd><p>a factor with levels <code>1</code>, <code>2</code>, and <code>3</code></p>
</dd>
</dl>

<p>The observations were generated independently with the code shown 
in the examples section.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
obs &lt;- c(sample(0:1, 30, TRUE, prob = c(0.5, 0.5)), sample(0:1, 30, TRUE, prob = c(0.3, 0.7)))
obs2 &lt;- c(rpois(30, 5), rpois(30, 10))
</code></pre>

<hr>
<h2 id='mcemGLMM'>Generalized Linear Mixed Models Estimation</h2><span id='topic+mcemGLMM'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation for logistic, Poisson, and negative binomial models with random effects using a Monte Carlo EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcemGLMM(fixed, random, data, family = c("bernoulli", "poisson", 
    "negbinom", "gamma"), vcDist = c("normal", "t"), df, 
    controlEM = list(), controlTrust = list(), initial)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcemGLMM_+3A_fixed">fixed</code></td>
<td>
<p>the fixed effects model. This is specified 
by a <code>formula</code> object.</p>
</td></tr>
<tr><td><code id="mcemGLMM_+3A_random">random</code></td>
<td>
<p>the random effects models. This is specified
by a <code>formula</code> object or a list of <code>formula</code> objects.
See details below.</p>
</td></tr>
<tr><td><code id="mcemGLMM_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in 
the model. If missing the variables are taken from the current 
environment.</p>
</td></tr>
<tr><td><code id="mcemGLMM_+3A_family">family</code></td>
<td>
<p>a string indicating the type of model to be fitted. 
The options are &quot;bernoulli&quot; for logistic regression, &quot;Poisson&quot;
for Poisson count regression, and &quot;negbinom&quot; for negative 
binomial count regression.</p>
</td></tr>
<tr><td><code id="mcemGLMM_+3A_vcdist">vcDist</code></td>
<td>
<p>a string indicating the distribution of the marginal 
variance components. The options are &quot;normal&quot; and &quot;t&quot; for normal 
and t distributed random effects respectively.</p>
</td></tr>
<tr><td><code id="mcemGLMM_+3A_df">df</code></td>
<td>
<p>a vector of degrees of freedom of the random effects 
when these are t distributed. The length of the vector must be
equal to the number of variance components in the model.</p>
</td></tr>
<tr><td><code id="mcemGLMM_+3A_controlem">controlEM</code></td>
<td>
<p>a list of options for the algorithm. See Details below.</p>
</td></tr>
<tr><td><code id="mcemGLMM_+3A_controltrust">controlTrust</code></td>
<td>
<p>a list of options to be passed to the <code>trust</code>
optimizer. See details below.</p>
</td></tr>
<tr><td><code id="mcemGLMM_+3A_initial">initial</code></td>
<td>
<p>optional initial values for the parameters. If missing 
the initial values for the fixed effects are taken from a generalized 
linear model fitted without random effects and the initial values for 
the variance components are set to 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>mcemGLMM</code> allows the fitting of generalized linear 
mixed models when the random effects are normal or a t distributed.
The supported models are the logistic, Poisson and negative binomial. 
The degrees of freedom for the t case must be supplied by the user 
with a vector in the <code>df</code> argument. The length of the vector 
must be equal to the number of variance components. For normal random 
effects the argument <code>df</code> does not need to be included.
</p>
<p>To fit a model with one random effect a formula must be supplied in 
the <code>random</code> argument. Note that it is necessary that the 
variable is a factor and to specify that there is no intercept for 
the random part of the model. To use more than one random effects a 
list of formulas must be supplied. Each member must be formula with 
in which the variables involved must be factors and it also it is 
necessary to specify that there is no intercept. To fit crossed 
random effects each variable must no appear in its own formula. To 
fit nested random effects a formula with the highest level variable 
must be specified and each subsequent variable must be specified with 
an interaction of the variables above it. See examples below.
</p>
<p>A note on the negative binomial overdispersion:
</p>
<p>The variance for the negative binomial model is set equal to
<code class="reqn">(1 + \mu/\alpha)</code> so we have that there is no overdispersion
as <code class="reqn">\alpha</code> goes to infinity.
</p>
<p>The variance for the gamma distribution is set to <code class="reqn">\mu^2/\alpha</code>. The value
of <code class="reqn">\alpha = 1</code> corresponds to an exponential regression.
</p>
<p>Stopping rules and convergence criteria:
</p>
<p>The algorithm runs for a maximum of <code>EMit</code> iterations or until
the criteria 
</p>
<p style="text-align: center;"><code class="reqn">\max_i \left\{ \frac{ |\theta_i^{(t)} - \theta_i^{(t-1)}|}{|\theta_i^{(t)}| + \delta}\right\} &lt; \epsilon</code>
</p>

<p>is satisfied three times in a row for pre-defined values of 
<code class="reqn">\epsilon</code> and <code class="reqn">\delta</code>. Once this criterion has been achieved 
two times we increase the Monte Carlo sample size more rapidly to 
have a better estimation of the model's information matrix. For 
a detailed discussion on convergence diagnostics see Neath R.C. (2012). 
After fitting a model it is recommended to plot the EM estimates 
at each step to assess convergence.
</p>
<p>Control options for EM:
</p>

<dl>
<dt>EMit</dt><dd><p>maximum number of EM iterations.</p>
</dd>
<dt>MCit</dt><dd><p>initial number of Monte Carlo iterations for the MCMC 
step.</p>
</dd>
<dt>MCf</dt><dd><p>factor in which the MC iterations increase in each EM 
iteration.</p>
</dd>
<dt>verb</dt><dd><p>logical. If TRUE at each EM iteration the function will 
print convergence information and a trace plot for on of the random 
effects. This is useful to assess the performance of the algorithm 
but it can impact the actual running time.</p>
</dd>
<dt>MCsd</dt><dd><p>initial standard deviation for the proposal density of 
the MCMC step. If zero (default) an auto-tuning step will be 
performed.</p>
</dd>
<dt>EMdelta</dt><dd><p>constant for the EM error assessment.</p>
</dd>
<dt>EMepsilon</dt><dd><p>constant for the EM error assessment.</p>
</dd>
</dl>

<p>Control options for trust, see <code>help(trust)</code> for more details:
</p>

<dl>
<dt>rinit</dt><dd><p>starting trust region radius. Default value set to 20.</p>
</dd>
<dt>rmax</dt><dd><p>maximum allowed trust region radius. Default value set to 200.</p>
</dd>
<dt>iterlim</dt><dd><p>maximum number of iterations. Default value set to 100.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A list of class &quot;mcemGLMM&quot; with the following items:
</p>

<dl>
<dt>mcemEST</dt><dd><p>a matrix with the value of the maximum likelihood 
estimators at the end of each EM step.</p>
</dd>
<dt>iMatrix</dt><dd><p>Fisher's information matrix.</p>
</dd>
<dt>QfunVal</dt><dd><p> value (up to a constant) of the Q function. 
Used to perform likelihood ratio tests.</p>
</dd>
<dt>QfunMCMC</dt><dd><p>Q function MCMC sample.</p>
</dd>
<dt>randeff</dt><dd><p>a sample from the conditional distribution of the 
random effects given the data and the maximum likelihood estimators.</p>
</dd>
<dt>y</dt><dd><p>vector of observations.</p>
</dd>
<dt>x</dt><dd><p>design matrix for the fixed effects.</p>
</dd>
<dt>z</dt><dd><p>design matrix for the random effects.</p>
</dd>
<dt>EMerror</dt><dd><p>relative error at the last iteration. See details.</p>
</dd>
<dt>MCsd</dt><dd><p>last value for MCMC step size.</p>
</dd>
<dt>call</dt><dd><p>original call.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>


<h3>References</h3>

<p>Neath, R. C. (2012) On Convergence Properties of the 
Monte Carlo EM Algorithm In Advances in Modern Statistical 
Theory and Applications: A Festschrift in Honor of Morris 
L. Eaton. <em>Institute of Mathematical Statistics</em> 43&ndash;62  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Data set for a logistic model with one binary fixed effects and two 
# possible random effects.
# Initial values and MC iterations are given to speed up the examples 
# but these are not necessary in general.
set.seed(0123210)
data(exdata)

# To fit a model with one random effect
fit.1 &lt;- mcemGLMM(obs ~ x, random = ~ 0 + z1, data = exdata, 
                family = "bernoulli", vcDist = "normal", 
                controlEM = list(MCit = 10000), 
                initial = c(0.27, -0.13, 0.003))
summary(fit.1)

# We can assess convergence by looking at a trace plot of the EM estimates
# and the loglikelihood values
ts.plot(fit.1$mcemEST)
ts.plot(fit.1$QfunVal)

# To fit a model with crossed random effects
fit.crossed &lt;- mcemGLMM(obs ~ x, random = list(~ 0 + z1, ~ 0 + z2), 
                data = exdata, 
                family = "bernoulli", vcDist = "normal", 
                controlEM = list(EMit = 10, MCit = 10000), 
                initial = c(0.28, -0.15, 0.001, 0.4))
summary(fit.crossed)


# To fit a model with crossed random effects
fit.nested &lt;- mcemGLMM(obs ~ x, random = list(~ 0 + z2, ~ 0 + z2:z1), 
                data = exdata, 
                family = "bernoulli", vcDist = "normal", 
                controlEM = list(EMit = 10, MCit = 10000), 
                initial = c(0.31, -0.15, 0.29, 0.27))
summary(fit.nested)

# Fit a Poisson model
fit.pois &lt;- mcemGLMM(obs2 ~ x, random = ~ 0 + z1, data = exdata, 
                family = "poisson", vcDist = "normal", 
                controlEM = list(EMit = 10, MCit = 10000), 
                initial = c(1.95, 0.03, 0.003))
summary(fit.pois)

</code></pre>

<hr>
<h2 id='mcemGLMMext'>Extending the Iterations of a Model Fitted with mcemGLMM</h2><span id='topic+mcemGLMMext'></span>

<h3>Description</h3>

<p>Given a model fitted with the function <code>mcemGLMM</code> this function will add iterations and update the model estimates for more accurate results.
</p>
<p>This is recommended if the initial fitting seems to have a large Monte Carlo error. This function will use the previous maximum likelihood estimate as its initial point and will also start with a Monte Carlo sample size equal to the sample size used in the last iteration of the previous fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcemGLMMext(object, it = 20, controlEM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcemGLMMext_+3A_object">object</code></td>
<td>
<p>an model fitted with <code>mcemGLMM</code></p>
</td></tr>
<tr><td><code id="mcemGLMMext_+3A_it">it</code></td>
<td>
<p>the maximum number of iterations to be performed.</p>
</td></tr>
<tr><td><code id="mcemGLMMext_+3A_controlem">controlEM</code></td>
<td>
<p>a list. New set of options for the EM algorithm. Can be missing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An updated object of class <code>mcemGLMM</code>.
</p>


<h3>Note</h3>

<p>If <code>controlEM</code> is supplied it is important that the value for <code>MCit</code> is at least equal to number of Monte Carlo iterations used in the last EM step to fit <code>object</code> since providing a lower number will increase the Monte Carlo error.
</p>


<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcemGLMM">mcemGLMM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(72327)
data(exdata)
fit1 &lt;- mcemGLMM(obs ~ z2 + x, random = ~ 0 + z1, 
                 data = exdata, 
                 family = "bernoulli", vcDist = "normal", 
                 controlEM = list(verb = FALSE, EMit = 5, MCit = 8000), 
                 initial = c(-0.13, -0.15, -0.21, 1.59, 0.002))
                 
# Now we extend the algorithm to do at least another 10 iterations
fit2 &lt;- mcemGLMMext(fit1, it = 10)

</code></pre>

<hr>
<h2 id='predict.mcemGLMM'>Predict method for mcemGLMM objects</h2><span id='topic+predict'></span><span id='topic+predict.mcemGLMM'></span>

<h3>Description</h3>

<p>This functions returns predicted link function of observations for a model fitted with <code>mcemGLMM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'mcemGLMM'
predict(object, newdata, type = c("link", "response"), se.fit = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mcemGLMM_+3A_object">object</code></td>
<td>
<p>a model fitted with the mcemGLMM function.</p>
</td></tr>
<tr><td><code id="predict.mcemGLMM_+3A_newdata">newdata</code></td>
<td>
<p>optional data frame with new data. The variable names must match the original variables. If missing, the function will return predicted values at each observation.</p>
</td></tr>
<tr><td><code id="predict.mcemGLMM_+3A_type">type</code></td>
<td>
<p>character string. The type of predictions to be returned. Either &quot;link&quot; or &quot;response&quot; predictions are available.</p>
</td></tr>
<tr><td><code id="predict.mcemGLMM_+3A_se.fit">se.fit</code></td>
<td>
<p>logical. If true, standard errors will be returned.</p>
</td></tr>
<tr><td><code id="predict.mcemGLMM_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the predictions from the observed data or by using the supplied new data.
</p>


<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>

<hr>
<h2 id='ranef.mcemGLMM'>Anova method for mcemGLMM objects</h2><span id='topic+ranef'></span><span id='topic+ranef.mcemGLMM'></span>

<h3>Description</h3>

<p>Extract the random effect predictions from a model fitted with <code>mcemGLMM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcemGLMM'
ranef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef.mcemGLMM_+3A_object">object</code></td>
<td>
<p>a model fitted with the mcemGLMM function.</p>
</td></tr>
<tr><td><code id="ranef.mcemGLMM_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the random effect predictions.
</p>


<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>

<hr>
<h2 id='residuals.mcemGLMM'>Residual extraction method for mcemGLMM objects</h2><span id='topic+residuals'></span><span id='topic+residuals.mcemGLMM'></span>

<h3>Description</h3>

<p>This functions returns the residuals of a model fitted with <code>mcemGLMM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcemGLMM'
residuals(object, type = c("deviance", "pearson"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.mcemGLMM_+3A_object">object</code></td>
<td>
<p>a model fitted with the mcemGLMM function.</p>
</td></tr>
<tr><td><code id="residuals.mcemGLMM_+3A_type">type</code></td>
<td>
<p>character string. The type of residuals to be returned.</p>
</td></tr>
<tr><td><code id="residuals.mcemGLMM_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the residuals of the model.
</p>


<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>

<hr>
<h2 id='salamander'>
Salamander Data
</h2><span id='topic+salamander'></span>

<h3>Description</h3>

<p>Salamander mating experiment data from McCullagh and Nelder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("salamander")</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 4 variables.
</p>

<dl>
<dt><code>Cross</code></dt><dd><p>the type of salamanders involved in the crossing.</p>
</dd>
<dt><code>Female</code></dt><dd><p>the female salamander's ID.</p>
</dd>
<dt><code>Male</code></dt><dd><p>the male salamander's ID.</p>
</dd>
<dt><code>Mate</code></dt><dd><p>whether the crossing was successful or not.</p>
</dd>
</dl>



<h3>References</h3>

<p>McCullagh, P and Nelder J. A. (1989) Generalized Linear Models, Second Edition. Chapman and Hall, 1989
</p>

<hr>
<h2 id='simData'>
Data used for fitting examples 
</h2><span id='topic+simData'></span>

<h3>Description</h3>

<p>Example data for logistic, Poisson and negative binomial models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simData")</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations on the following 8 variables.
</p>

<dl>
<dt><code>obs</code></dt><dd><p>a binary vector. Used as a response for a logistic model.</p>
</dd>
<dt><code>x1</code></dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>x2</code></dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>x3</code></dt><dd><p>a categorical vector with levels <code>blue</code>, <code>red</code>, and <code>yellow</code>.</p>
</dd>
<dt><code>z1</code></dt><dd><p>a categorical vector with levels <code>D1</code>, <code>D2</code>, <code>D3</code>, <code>D4</code>, and <code>D5</code>.</p>
</dd>
<dt><code>z2</code></dt><dd><p>a categorical vector with levels <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code>, and <code>5</code>.</p>
</dd>
<dt><code>z3</code></dt><dd><p>a categorical vector with levels <code>A</code>, <code>B</code>, and <code>D</code>.</p>
</dd>
<dt><code>count</code></dt><dd><p>a numeric vector. Used as a response for a Poisson model.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The levels of <code>z2</code> can be nested within $<code>z1</code>$. The observations were generated with the code shown in the examples section.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(47819)
x1 &lt;- rnorm(200, 10, 1)
x2 &lt;- rnorm(200, 5, 1)
x3 &lt;- sample(c("red", "blue", "yellow"), size = 200, replace = TRUE)
z1 &lt;- factor(rep(c("D1", "D2", "D3", "D4", "D5"), each = 40))
z2 &lt;- factor(rep(rep(1:4, each = 5), 10))
z3 &lt;- factor(c(rep("A", 100), rep("B", 60), rep("D", 40)))
kX &lt;- model.matrix(~x1 + x2 + x3)
kZ &lt;- cbind(model.matrix(~ 0+z1), model.matrix(~ 0+z1:z2), model.matrix(~ 0+z3))
kBeta &lt;- c(5, -4, 5, 0, 8)
kU &lt;- 3 * rt(28, 5)
linf0 &lt;- kX 
prob0 &lt;- exp(linf0)/(1+exp(linf0))
obs &lt;- as.numeric(runif(100) &lt; prob0)
simData &lt;- data.frame(obs, x1, x2, x3, z1, z2, z3)
</code></pre>

<hr>
<h2 id='summary.mcemGLMM'>Summary method for mcemGLMM objects</h2><span id='topic+summary'></span><span id='topic+summary.mcemGLMM'></span>

<h3>Description</h3>

<p>Summary for an object obtained from <code>mcemGLMM</code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcemGLMM'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mcemGLMM_+3A_object">object</code></td>
<td>
<p>a model fitted with the mcemGLMM function.</p>
</td></tr>
<tr><td><code id="summary.mcemGLMM_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints a table for Wald tests for the fixed effect 
coefficients and the variance estimators. For the negative binomial 
and the gamma distributions the estimate of <code class="reqn">\alpha</code> is reported 
with its respective standard error.
</p>


<h3>Value</h3>

<p>A list with the following items:
</p>

<dl>
<dt>coefficients</dt><dd><p>a list with the fixed effects coefficients 
and the predicted random effects.</p>
</dd>
<dt>var.est</dt><dd><p>the estimated variances for each variance component.</p>
</dd>
<dt>std.err</dt><dd><p>the standard errors for the fixed effects 
coefficients and the variance estimates.</p>
</dd>
<dt>z.val</dt><dd><p>z test values for the fixed effects coefficients and 
the variance estimators.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Felipe Acosta Archila &lt;acosta@umn.edu&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
