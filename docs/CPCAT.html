<!DOCTYPE html><html lang="en"><head><title>Help for package CPCAT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CPCAT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CPCAT'><p>Performs the closure principle computational approach test (CPCAT).</p></a></li>
<li><a href='#hypotheses'><p>Create main hypotheses and intersection hypotheses.</p></a></li>
<li><a href='#poisson.sub.test'><p>Perform a computational approach test (CAT).</p></a></li>
<li><a href='#poisson.test'><p>Perform the closure principle computational approach test (CPCAT) for one main hypothesis H0i: mu_0=mu_i.</p></a></li>
<li><a href='#testdata'><p>Description of testdata</p></a></li>
<li><a href='#testdata2'><p>Description of testdata2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>The Closure Principle Computational Approach Test</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>P-values and no/lowest observed (adverse) effect concentration values derived from the closure principle computational approach test (Lehmann, R. et al. (2015) &lt;<a href="https://doi.org/10.1007%2Fs00477-015-1079-4">doi:10.1007/s00477-015-1079-4</a>&gt;) are provided. The package contains functions to generate intersection hypotheses according to the closure principle (Bretz, F., Hothorn, T., Westfall, P. (2010) &lt;<a href="https://doi.org/10.1201%2F9781420010909">doi:10.1201/9781420010909</a>&gt;), an implementation of the computational approach test (Ching-Hui, C., Nabendu, P., Jyh-Jiuan, L. (2010) &lt;<a href="https://doi.org/10.1080%2F03610918.2010.508860">doi:10.1080/03610918.2010.508860</a>&gt;) and the combination of both, that is, the closure principle computational approach test.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-01 10:59:59 UTC; René Lehmann</td>
</tr>
<tr>
<td>Author:</td>
<td>René Lehmann <a href="https://orcid.org/0000-0003-4145-8272"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>René Lehmann &lt;rene.lehmann82@t-online.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-02 15:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='CPCAT'>Performs the closure principle computational approach test (CPCAT).</h2><span id='topic+CPCAT'></span>

<h3>Description</h3>

<p>Performs the closure principle computational approach test (CPCAT).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CPCAT(z, M = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CPCAT_+3A_z">z</code></td>
<td>
<p>The data set to be used. One column of z must contain the numeric Poisson data and one must contain the factor variable. The first level of the factor variable is assumed to be the control group. Factor levels (i.e., groups) should be in ascending order (e.g. increasing concentration of a test substance). If the data frame contains more than one numeric column and/or more than one factor variable the CPCAT is applied to the first numeric column and the corresponding Poisson data are grouped according the first factor variable.</p>
</td></tr>
<tr><td><code id="CPCAT_+3A_m">M</code></td>
<td>
<p>The number of parametric bootstrap simulations. Defaults to M=10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A p-value for each main hypotheses H_0i: mu_0=mu_i &quot;control vs. treatment i&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata)
CPCAT(testdata)
CPCAT(z=testdata)
CPCAT(z=testdata, M=1000)
</code></pre>

<hr>
<h2 id='hypotheses'>Create main hypotheses and intersection hypotheses.</h2><span id='topic+hypotheses'></span>

<h3>Description</h3>

<p>Create main hypotheses and intersection hypotheses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hypotheses(n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hypotheses_+3A_n">n</code></td>
<td>
<p>The number of treatments exclusive of the control group. That is, if we have, e.g., a control group and 3 treatments choose n=3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A contrast matrix reflecting all main and intersection hypotheses induced by the closure principle (CP). Please note that the leading column of treatment 0 (i.e., the control group) is not displayed because it always contains only ones.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hypotheses(3)
hypotheses(n=2)
</code></pre>

<hr>
<h2 id='poisson.sub.test'>Perform a computational approach test (CAT).</h2><span id='topic+poisson.sub.test'></span>

<h3>Description</h3>

<p>Perform a computational approach test (CAT).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.sub.test(dat, contrast, M = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poisson.sub.test_+3A_dat">dat</code></td>
<td>
<p>A list. The first list element contains the Poisson data of the control group, the second list element contains the Poisson data of the first treatment group etc..</p>
</td></tr>
<tr><td><code id="poisson.sub.test_+3A_contrast">contrast</code></td>
<td>
<p>A matrix consisting of one row and ncol=number of treatments. The values must be either 0 or 1. 1 (0) includes (excludes) the corresponding treatment from the CAT procedure. For example consider 1 control group and 4 treatment groups. For testing H0: mu_0=mu_1=mu_4 choose contrast=matrix(c(1,0,0,1),nrow = 1).</p>
</td></tr>
<tr><td><code id="poisson.sub.test_+3A_m">M</code></td>
<td>
<p>The number of parametric bootstrap simulations. Defaults to M=10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A p-value for testing one intersection hypothesis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata)
#Extract the group names from testdata.
conc&lt;-unique(testdata[,2])	#concentration levels of the test data
#Extract the number of treatment groups.
N=length(conc)-1
#Devide the testdata into a list where the first element contains
#the Poisson data of the control group and the following contain
#the Poisson data of the treatment groups, respectively.
dat&lt;-list()
#Create the final list.
for(j in 1:length(conc)){
index&lt;-which(testdata[,2]==conc[j])
dat[[j]]&lt;-testdata[index,]
}
#Show the data list.
dat
#Generate the intersection hypotheses of H01: mu_0=mu_1 using the
#hypotheses function.
C=hypotheses(N)[[1]]
#Show the first intersection hypothesis.
C[1,]
#Test the first intersection hypothesis.
poisson.sub.test(dat=dat,contrast=C[1,],M=10000)
</code></pre>

<hr>
<h2 id='poisson.test'>Perform the closure principle computational approach test (CPCAT) for one main hypothesis H0i: mu_0=mu_i.</h2><span id='topic+poisson.test'></span>

<h3>Description</h3>

<p>Perform the closure principle computational approach test (CPCAT) for one main hypothesis H0i: mu_0=mu_i.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.test(Data, contrastmatrix, M = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poisson.test_+3A_data">Data</code></td>
<td>
<p>The data matrix.</p>
</td></tr>
<tr><td><code id="poisson.test_+3A_contrastmatrix">contrastmatrix</code></td>
<td>
<p>The contrasts according to the closure principle induced intersection hypotheses.</p>
</td></tr>
<tr><td><code id="poisson.test_+3A_m">M</code></td>
<td>
<p>The number of parametric bootstrap simulations. Defaults to M=10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The set of p-values according to the intersection hypotheses and the maximum p-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Consider a data set of one control group and 3 treatment groups
data(testdata2)
#Test the main hypothesis H0: mu_0=mu_1 using M=10000
#simulation runs
C=hypotheses(3)[[1]] #Generate the set of intersection hypotheses
#according to H0
poisson.test(testdata2,contrastmatrix=C,M=10000)
</code></pre>

<hr>
<h2 id='testdata'>Description of testdata</h2><span id='topic+testdata'></span>

<h3>Description</h3>

<p>The data set testdata contains two variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testdata
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 2 variables:
</p>

<dl>
<dt>Poissondata</dt><dd><p>Contains 20 realizations of Poisson distributed random variables.</p>
</dd>
<dt>group</dt><dd><p>Contains the group names of the Poisson data.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Artificial example data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata)    #Lazy loading of the test data. To view the data type testdata.
</code></pre>

<hr>
<h2 id='testdata2'>Description of testdata2</h2><span id='topic+testdata2'></span>

<h3>Description</h3>

<p>The data set testdata2 contains two variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testdata2
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and 2 variables:
</p>

<dl>
<dt>Poissondata</dt><dd><p>Contains 16 realizations of Poisson distributed random variables.</p>
</dd>
<dt>group</dt><dd><p>Contains the group names of the Poisson data.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Artificial example data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata2)    #Lazy loading of the test data. To view the data type testdata.
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
