<!DOCTYPE html><html lang="en"><head><title>Help for package pCalibrate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pCalibrate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pCalibrate-package'>
<p>Bayesian Calibrations of p-Values</p></a></li>
<li><a href='#BF2pp'>
<p>Transform Bayes factors to posterior probabilities</p></a></li>
<li><a href='#FCalibrate'>
<p>Calibration of two-sided p-values from the F-test in the linear model</p></a></li>
<li><a href='#formatBF'><p> Formatting of Bayes factors</p></a></li>
<li><a href='#LRCalibrate'>
<p>Calibration of two-sided p-values obtained from the likelihood ratio test statistic</p></a></li>
<li><a href='#p2z'>
<p>Transform p-values to z-values</p></a></li>
<li><a href='#pCalibrate'><p>Calibrations of two-sided p-values directly based on the p-value</p></a></li>
<li><a href='#tCalibrate'>
<p>Calibration of p-values from t-tests</p></a></li>
<li><a href='#twoby2Calibrate'>
<p>Minimum Bayes factors and p-values from Fisher's exact test for 2x2 contingency tables</p></a></li>
<li><a href='#z2p'>
<p>Transform z-values to p-values</p></a></li>
<li><a href='#zCalibrate'>
<p>Calibration of p-values from z-tests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Calibrations of p-Values</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-19</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Manuela Ott &lt;manuela.c.ott@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements transformations of p-values to the smallest possible Bayes factor within the specified class of alternative hypotheses, as described in Held &amp; Ott (2018, &lt;<a href="https://doi.org/10.1146%2Fannurev-statistics-031017-100307">doi:10.1146/annurev-statistics-031017-100307</a>&gt;). Covers several common testing scenarios such as z-tests, t-tests, likelihood ratio tests and the F-test. </td>
</tr>
<tr>
<td>Depends:</td>
<td>exact2x2, MCMCpack</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-19 08:38:11 UTC; manuela</td>
</tr>
<tr>
<td>Author:</td>
<td>Manuela Ott <a href="https://orcid.org/0000-0002-8050-7279"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Leonhard Held <a href="https://orcid.org/0000-0002-8686-5325"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-19 12:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='pCalibrate-package'>
Bayesian Calibrations of p-Values
</h2><span id='topic+pCalibrate-package'></span>

<h3>Description</h3>

<p>Implements transformations of one- and two-sided p-values to minimum Bayes factors. The minimum Bayes factor is the smallest possible Bayes factor for the point null hypothesis against the alternative within the specified class of alternatives.
</p>
<p>The function <code>pCalibrate()</code> provides minimum Bayes factors
for two-sided p-values
which consider the p-value as the data and are directly based on the distribution of the p-value 
under the null hypothesis and the alternative.
For one- and two-sided p-values from z-tests, <code>zCalibrate()</code> implements
minimum Bayes factors for different classes of alternatives.
The function <br /> 
<code>tCalibrate()</code> provides the same functionality
for one- and two-sided p-values from t-tests.
The functions <code>FCalibrate()</code> 
and <code>LRCalibrate()</code> transform two-sided
p-values from the F-test or likelihood ratio test, respectively, to
minimum Bayes factors.
</p>


<h3>Details</h3>

<p>Package: pCalibrate
</p>
<p>Type: Package
</p>
<p>Title: Bayesian Calibrations of p-Values
</p>
<p>Version: 0.2-1
</p>
<p>Date: 2020-03-19
</p>
<p>Author: Manuela Ott [aut, cre], Leonhard Held [aut] 
</p>
<p>Maintainer: Manuela Ott &lt;manuela.c.ott@gmail.com&gt;
</p>
<p>Depends: exact2x2, MCMCpack
</p>
<p>License: GPL (&gt;=2)
</p>


<h3>Author(s)</h3>

<p>Manuela Ott, Leonhard Held
Maintainer: Manuela Ott &lt;manuela.c.ott@gmail.com&gt;
</p>


<h3>References</h3>

<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393&ndash;419.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pCalibrate(p=c(0.05, 0.01, 0.001), type="exploratory")
zCalibrate(p=c(0.05, 0.01, 0.005), type="one.sided", 
           alternative="simple")
zCalibrate(p=c(0.05, 0.01, 0.005),  type="two.sided", 
           alternative="normal")
tCalibrate(p=c(0.05, 0.01, 0.005), n=c(10, 20, 50), type="two.sided", 
           alternative="normal")
FCalibrate(p=c(0.05, 0.01, 0.005), n=20, d=c(2, 5, 10), 
           alternative="chi.squared")
LRCalibrate(p=c(0.05, 0.01, 0.005), df=2, alternative="simple")
</code></pre>

<hr>
<h2 id='BF2pp'>
Transform Bayes factors to posterior probabilities
</h2><span id='topic+BF2pp'></span>

<h3>Description</h3>

<p>Transforms the Bayes factor for a hypothesis H_1 against a hypothesis H_2
to the posterior probability of H_1 given
the prior probability of H_1 
(assuming that the prior probabilities of H_1 and H_2 add up to 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BF2pp(BF, prior.prob=0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BF2pp_+3A_bf">BF</code></td>
<td>

<p>a vector of Bayes factors
</p>
</td></tr>
<tr><td><code id="BF2pp_+3A_prior.prob">prior.prob</code></td>
<td>

<p>a vector of prior probabilities for H_1.
Defaults to a vector with entries 0.5.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of posterior probabilities of the hypothesis H_1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>BF2pp(BF=c(2, 10, 50), prior.prob=c(0.2, 0.5, 0.9))
</code></pre>

<hr>
<h2 id='FCalibrate'>
Calibration of two-sided p-values from the F-test in the linear model
</h2><span id='topic+FCalibrate'></span>

<h3>Description</h3>

<p>Transforms two-sided p-values from the F-test of overall significance in the linear model to sample-size adjusted lower bounds on the Bayes factor
for the point null hypothesis against the alternative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FCalibrate(p, n, d, alternative="chi.squared", intercept=TRUE, 
           transform="id")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FCalibrate_+3A_p">p</code></td>
<td>
<p>a vector of two-sided p-values
</p>
</td></tr>
<tr><td><code id="FCalibrate_+3A_n">n</code></td>
<td>
<p>a scalar or a vector of positive integers. Specifies the sample size(s). May be a vector only if <code>d</code> is a scalar.
</p>
</td></tr>
<tr><td><code id="FCalibrate_+3A_d">d</code></td>
<td>
<p>a scalar or a vector of positive integers. 
Specifies the dimension(s) of the vector(s) of regression coefficients,
i.e. the number(s) of explanatory variables in the linear model(s).
May be a vector only if <code>n</code> is a scalar.

</p>
</td></tr>
<tr><td><code id="FCalibrate_+3A_alternative">alternative</code></td>
<td>
<p>either <code>"simple"</code> or <code>"chi.squared"</code>.
Defaults to <code>"chi.squared"</code>. <br />
Specifies the alternative hypotheses
on the non-centrality parameter of the 
F-distribution to consider.
<code>"simple"</code> only considers simple point alternative hypotheses.
<code>"chi.squared"</code> assumes a scaled chi-squared distribution.
</p>
</td></tr>
<tr><td><code id="FCalibrate_+3A_intercept">intercept</code></td>
<td>
<p>logical. If TRUE, the linear model contains an unknown intercept term,
otherwise the intercept is fixed. Defaults to TRUE.
</p>
</td></tr>
<tr><td><code id="FCalibrate_+3A_transform">transform</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the lower bound on the Bayes factor.
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that under the point null hypothesis that all regression coefficients are
equal to zero, the F-statistic <code class="reqn">F</code>
(which is the <code class="reqn">(1-p)</code>-quantile of the F-distribution with <code class="reqn">d</code> and <code class="reqn">n-d-1</code> degrees of freedom)
has a central F-distribution with <code class="reqn">d</code> and <code class="reqn">n-d-1</code> degrees of freedom
if the linear model contains an unknown intercept term
(otherwise <code class="reqn">F</code>
has a central F-distribution with <code class="reqn">d</code> and <code class="reqn">n-d</code> degrees of freedom).
Under a simple point alternative, 
F has a non-central F-distribution with <code class="reqn">d</code> and <code class="reqn">n-d-1</code> degrees of freedom. 
</p>
<p>To obtain the lower bound on the Bayes factor 
for <code>alternative="simple"</code>,
the likelihood under the alternative is then maximized numerically with respect to
the non-centrality parameter.
That calibration is described in Held &amp; Ott (2018), 
Section 3.1 (in the last two paragraphs).
</p>
<p>For <code>alternative="chi-squared"</code>, the calibration is proposed in Held &amp; Ott (2016), 
Section 3
and also described in Held &amp; Ott (2018), Section 3.2.
The corresponding minimum Bayes factor has already been derived in Johnson (2005).
As described there, assigning a scaled chi-sqaured distribution to the
non-centrality parameter of the F-distribution corresponds to
assigning a (multivariate) normal prior distribution 
centered around the null value to the vector of regression coefficients.
</p>


<h3>Value</h3>

<p>A matrix containing the lower bounds on the Bayes factors 
as entries,
for all combinations of p-value and sample size <code>n</code> or dimension <code>d</code>
(whichever is multidimensional).
The values for the k-th sample size or dimension (k-th entry in the vector <code>n</code> or <code>d</code>) and the different p-values
are given in the k-th row.
</p>


<h3>Note</h3>

<p>Computation may fail for <code>alternative="simple"</code> if the p-value <code>p</code> is extremely small
and min{n, n-d} is also small. Warnings will be given in this case and
the returned value is <code>minBF=NaN</code>.
</p>


<h3>References</h3>

<p>Held , L. and Ott, M. (2016). How the maximal evidence of P -values against point null hypotheses depends on sample size. <em>American Statistician</em>, <b>70</b>, 335&ndash;341
</p>
<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393&ndash;419.
</p>
<p>Johnson, V. E. (2005). Bayes factors based on test statistics. 
<em>Journal of the Royal Statistical Society, Series B</em> <b>67</b>:689&ndash;701.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tCalibrate">tCalibrate</a></code> 

</p>


<h3>Examples</h3>

<pre><code class='language-R'>FCalibrate(p=c(0.05, 0.01, 0.005), n=20, d=2, alternative="simple")
# chi-squared alternatives
FCalibrate(p=c(0.05, 0.01, 0.005), n=20, d=2, intercept=FALSE)
FCalibrate(p=c(0.05, 0.01, 0.005), n=20, d=c(2, 5, 10))
FCalibrate(p=c(0.05, 0.01, 0.005), n=c(10, 20, 50), d=2)

# plot for chi-squared alternatives: d=2 and different sample sizes n
# note that the minimum Bayes factor decreases with decreasing sample 
# size
p &lt;- exp(seq(log(0.0001), log(0.3), by=0.01))
n &lt;- c(5, 10, 20)
minBF &lt;- FCalibrate(p, n, d=2) 
# compare to the bound for large n
minTBF &lt;- LRCalibrate(p, df=2)
par(las=1)
matplot(p, t(minBF), ylim=c(0.0003, 1), type="l", 
        xlab="two-sided F-test p-value", ylab="Minimum Bayes factor", 
        log="xy", lty=1, lwd=2, axes=FALSE, 
        main="Local normal alternatives")
lines(p, minTBF, col="gray", lty=2, lwd=2)
axis(1, at=c(0.0001, 0.0003, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3), 
     as.character(c(format(c(0.0001,0.0003), nsmall=4, digits=4, 
                           scientific=FALSE), 
                    c(0.001, 0.003, 0.01, 0.03, 0.1, 0.3))))
my.values &lt;- c(3000, 1000, 300, 100, 30, 10, 3, 1)
my.at &lt;- 1/my.values
my.ylegend &lt;- c(paste("1/", my.values[-length(my.values)], sep=""), 
                "1")
axis(2, at=my.at, my.ylegend)
box()
legend("bottomright", 
       legend=rev(c("n=5", "n=10", "n=20", "n large")), 
       col=rev(c(1:3, "gray")), lty=c(2, rep(1, times=3)), lwd=2)
</code></pre>

<hr>
<h2 id='formatBF'> Formatting of Bayes factors
</h2><span id='topic+formatBF'></span>

<h3>Description</h3>

<p>Bayes factors &lt;1 are represented as ratios
1/x, where x is rounded to the specified number of digits.
Bayes factors &gt;=1 are rounded to the specified number of digits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatBF(BF, digits="default")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formatBF_+3A_bf">BF</code></td>
<td>
<p> a numeric vector of Bayes factors
</p>
</td></tr>
<tr><td><code id="formatBF_+3A_digits">digits</code></td>
<td>
<p> either &quot;default&quot; (see Details) or a positive integer specifiying the number of decimal places to round the Bayes factor (for Bayes factors &gt;= 1) or
its inverse (for Bayes factors &lt; 1) to
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default formatting, which  is recommended in Held and Ott (2018), is as follows :
For very small Bayes factors BF &lt; 1/1000, &quot;&lt; 1/1000&quot; is returned.
Bayes factors BF with 1/1000 &lt;= BF &lt;=1/10 are formatted as 1/x, where x is an integer
and Bayes factors BF with 1/10 &lt; BF &lt; 1 as
1/x, where x is rounded to one decimal place.
Accordingly, Bayes factors 1 &lt;= BF &lt; 10 are rounded to one decimal place,
Bayes factors 10 &lt;= BF &lt;= 1000 are rounded to the next integer
and for larger Bayes factors, &quot;&gt; 1000&quot; is returned.
</p>
<p>If <code>digits</code> is specified,
the Bayes factor (if it is &gt;= 1) or its inverse (if the Bayes factor is &lt;1)
is rounded to the number of decimal places specified
and returned as a ratio if the Bayes factor is &lt;1.
</p>


<h3>Value</h3>

<p>  A character vector of ratios (for inputs &lt;1) or rounded numeric values (for inputs &gt;=1).
</p>


<h3>References</h3>

<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393&ndash;419.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> BF &lt;- c(0.0001, 0.0049, 0.0258, 0.24, 2.798)
 # use the default formatting
 formatBF(BF)
 # specify the number of digits
 formatBF(c(0.087, 4.65), digits=1)
</code></pre>

<hr>
<h2 id='LRCalibrate'>
Calibration of two-sided p-values obtained from the likelihood ratio test statistic
</h2><span id='topic+LRCalibrate'></span>

<h3>Description</h3>

<p>Transforms two-sided p-values from likelihood ratio (deviance) tests to lower bounds on the Bayes factor
for the point null hypothesis against the alternative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRCalibrate(p, df, alternative="gamma", transform="id")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LRCalibrate_+3A_p">p</code></td>
<td>

<p>a vector of two-sided p-values
</p>
</td></tr>
<tr><td><code id="LRCalibrate_+3A_df">df</code></td>
<td>

<p>a vector of degrees of freedom of the asymptotic chi-squared distribution(s)
of likelihood ratio test statistic(s)
</p>
</td></tr>
<tr><td><code id="LRCalibrate_+3A_alternative">alternative</code></td>
<td>

<p>either <code>"simple"</code> or <code>"gamma"</code>.
Defaults to <code>"gamma"</code>.
Specifies the alternative hypotheses on the non-centrality
parameter of the chi-squared distribution to consider.
<code>"simple"</code> only considers simple point alternative hypotheses.
<code>"gamma"</code> assumes a specific gamma distribution.
</p>
</td></tr>
<tr><td><code id="LRCalibrate_+3A_transform">transform</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the lower bound on the Bayes factor.
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under the assumption that the parameter vector of interest
(which has dimension <code>df</code>) is equal to the vector of zeros,
the distribution of the deviance converges to a
chi-squared distribution with <code>df</code> degrees of freedom.
Under a simple point alternative for the parameter vector of interest
and some regularity conditions,
the distribution of the deviance converges to a
non-central chi-squared distribution with <code>df</code> degrees of freedom.
</p>
<p>For <code>alternative = "simple"</code>, the lower bound on the Bayes factor
is obtained by mazimizing the
(asymptotic) chi-squared distribution under the alternative
with respect to the non-centrality parameter.
That calibration is described in
Held and Ott (2018), Section 4.2.1.
</p>
<p>The calibration for <code>alternative = "normal"</code> uses the test-based Bayes factors
introduced in Johnson (2008).
That approach is also outlined in Held and Ott (2018), Section 4.2.2.
</p>
<p>Using <code>alternative = "gamma"</code> yields a larger bound than
<code>alternative = "simple"</code>. <br />
Typical applications of these calibrations include generalized linear models.
</p>


<h3>Value</h3>

<p>A matrix containing the lower bounds on the Bayes factors 
as entries,
for all combinations of p-value and degrees of freedom.
The values for the k-th degrees of freedom (k-th entry in the vector <code>df</code>) and the different p-values
are given in the k-th row.
</p>


<h3>References</h3>

<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393&ndash;419.
</p>
<p>Johnson, V. E. (2008). Properties of Bayes factors based on test statistics. <em>Scandinavian
Journal of Statistics</em>, <b>35</b>, 354&ndash;368.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>LRCalibrate(p=c(0.05, 0.01, 0.005), df=2, alternative="simple")
# gamma alternatives
LRCalibrate(p=c(0.05, 0.01, 0.005), df=c(2, 5, 10))

# plot the minimum Bayes factor as a function of the p-value
# for different degrees of freedom df of the LR test statistic
par(mfrow=c(1,2), las=1)

p &lt;- exp(seq(log(0.005), log(0.3), by=0.01))
df &lt;- c(1, 5, 20)
par(las=1)

# for a simple alternative
minBF.sim &lt;- LRCalibrate(p, df=df, alternative="simple")
matplot(p, t(minBF.sim), type="l", ylab="Minimum Bayes factor", log="xy", 
        xlab="Two-sided LR-test p-value", lty=1, lwd=2, axes=FALSE,
        main="Simple alternative")
axis(1, at=c(0.01, 0.03, 0.1, 0.3), c(0.01, 0.03, 0.1, 0.3))
my.values &lt;- c(30, 20, 10, 5, 3, 1)
my.at &lt;- 1/my.values
my.ylegend &lt;- c(paste("1/", my.values[-length(my.values)], sep=""), "1")
axis(2, at=my.at, my.ylegend)
box()
legend("bottomright", legend=c("df=1", "df=5", "df=20"), 
        lty=1, lwd=2, , col=1:3)

# for gamma alternatives
minBF.loc &lt;- LRCalibrate(p, df=df, alternative="gamma")
matplot(p, t(minBF.loc), type="l", ylab="  Minimum Bayes factor", 
        log="xy", xlab="Two-sided LR-test p-value", lty=1, lwd=2, 
        axes=FALSE, main="Local alternatives")
axis(1, at=c(0.01, 0.03, 0.1, 0.3), c(0.01, 0.03, 0.1, 0.3))
axis(2, at=my.at, my.ylegend)
box()
legend("bottomright", legend=c("df=1", "df=5", "df=20"), 
        lty=1, lwd=2, col=1:3)
</code></pre>

<hr>
<h2 id='p2z'>
Transform p-values to z-values
</h2><span id='topic+p2z'></span>

<h3>Description</h3>

<p>Transforms the p-value(s) to the corresponding one- or two-sided z-value(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p2z(p, type="two.sided")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p2z_+3A_p">p</code></td>
<td>

<p>a vector of p-values
</p>
</td></tr>
<tr><td><code id="p2z_+3A_type">type</code></td>
<td>

<p>type of test. Either &quot;two.sided&quot; or &quot;one.sided&quot;. 
Defaults to &quot;two.sided&quot;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of z-values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p2z(p=c(0.005, 0.01, 0.05))
p2z(p=c(0.005, 0.01, 0.05), type="one.sided")
</code></pre>

<hr>
<h2 id='pCalibrate'>Calibrations of two-sided p-values directly based on the p-value
</h2><span id='topic+pCalibrate'></span>

<h3>Description</h3>

<p>Transforms a two-sided p-value to a minimum Bayes factor.
That minimum Bayes factor is obtained by modelling the distributions
of the p-value under the null and the alternative hypothesis,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pCalibrate(p,  type="exploratory", transform="id")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pCalibrate_+3A_p">p</code></td>
<td>

<p>a vector of two-sided p-values
</p>
</td></tr>
<tr><td><code id="pCalibrate_+3A_type">type</code></td>
<td>

<p>either <code>"exploratory"</code> or <code>"confirmatory"</code>.
Defaults to <code>"exploratory"</code>.


Corresponds to different distrbutional assumptions for the p-value p
under the alternative.
</p>
</td></tr>
<tr><td><code id="pCalibrate_+3A_transform">transform</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the minimum Bayes factor(s).
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>type="exploratory"</code> is used,
the so-called &quot;- e p log(p)&quot; calibration (Sellke et al., 2001)
is applied.
</p>
<p>If <code>type="confirmatory"</code> is used,
the  the so-called &quot;- e q log(q)&quot; calibration with q=1-p (Held &amp; Ott, 2018)
is applied.
</p>
<p><code>type="exploratory"</code> gives a larger minimum Bayes factor than <code>type="confirmatory"</code>.
</p>
<p>Under the null hypothesis, the distribution of the p-value
is assumed to be uniform.
Under the alternative, the p-value is assumed to have a beta-distribution
with monotonically decreasing density function under both alternatives,
with different parameters however.
If <code>type="exploratory"</code>, the prior sample size
does not exceed 2, whereas for <code>type="confirmatory"</code>,
the prior sample size is at least 2.
The latter calibration may be appropriate for small sample size,
but for larger sample size it is too conservative (Held &amp; Ott, 2018).
</p>
<p>Note that for the &quot;- e p log(p)&quot; calibration,
alternative derivations which do not assume a beta-distribution under the
alternative have also been given, see Sellke et al. (2001).
</p>


<h3>Value</h3>

<p>A numeric vector of minimum Bayes factors for the specified p-values
</p>


<h3>Note</h3>

<p>The argument <code>type</code> replaces the argument <code>alternative</code>
in version 0.1-1 of this package. <br />
<code>type="exploratory"</code> corresponds to <code>alternative="noninformative"</code>
and <br />
<code>type="confirmatory"</code> corresponds to <code>alternative="informative"</code>.
</p>


<h3>References</h3>

<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393&ndash;419.
</p>
<p>Sellke, T., Bayarri, M. J. and Berger, J. O. (2001). Calibration of p values for testing precise null hypotheses.
<em>The American Statistician</em>, <b>55</b>, 62&ndash;71.
</p>
<p>Vovk, V. G. (1993). A logic of probability, with application to the foundations of statistics (with discussion and a reply by the author). <em>Journal of the Royal Statistical Society, Series B</em>, <b>55</b>, 317&ndash;351.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pCalibrate(p=c(0.05, 0.01, 0.001))
pCalibrate(p=c(0.05, 0.01, 0.001), type="confirmatory")

# plot the 2 calibrations as a function of the p-value
par(las=1)
p &lt;- exp(seq(log(0.0001), log(0.3), by=0.01))
minBF1 &lt;- pCalibrate(p=p)
minBF2 &lt;- pCalibrate(p=p, type="confirmatory")
plot(p, minBF1, type="l", log="xy",
      xlab="Two sided p-value", ylab="Minimum Bayes factor", 
     axes=FALSE, lwd=2, col=1)
lines(p, minBF2, col=2, lwd=2)
axis(1, at=c(0.0001, 0.0003, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3), 
     as.character(c(format(c(0.0001,0.0003), nsmall=4, digits=4, 
                  scientific=FALSE), 
     c(0.001, 0.003, 0.01, 0.03, 0.1, 0.3))))
my.values &lt;- c(3000, 1000, 300, 100, 30, 10, 3, 1)
my.at &lt;- 1/my.values
my.ylegend &lt;- c(paste("1/", my.values[-length(my.values)], sep=""), "1")
axis(2, at=my.at, my.ylegend)
box()
legend("bottomright", lty=1, lwd=2, 
        legend=c("- e p log(p)", "- e q log(q)")
                , col=c(1,2))
</code></pre>

<hr>
<h2 id='tCalibrate'>
Calibration of p-values from t-tests
</h2><span id='topic+tCalibrate'></span>

<h3>Description</h3>

<p>Transforms one- and two-sided p-values from t-tests to sample-size adjusted lower bounds on the Bayes factor
for the point null hypothesis against the alternative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tCalibrate(p, n, type="two.sided", alternative="normal", transform="id")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tCalibrate_+3A_p">p</code></td>
<td>

<p>a vector of p-values
</p>
</td></tr>
<tr><td><code id="tCalibrate_+3A_n">n</code></td>
<td>

<p>a vector of sample sizes
</p>
</td></tr>
<tr><td><code id="tCalibrate_+3A_type">type</code></td>
<td>

<p>either <code>"one.sided"</code> or <code>"two.sided"</code>.
Defaults to <code>"two.sided"</code>.
Specifies if the t-test (and the corresponding p-value) is one-sided or two-sided.
</p>
</td></tr>
<tr><td><code id="tCalibrate_+3A_alternative">alternative</code></td>
<td>

<p>either <code>"simple"</code> or  <code>"normal"</code>.
Defaults to <code>"normal"</code>.
Specifies the alternative hypotheses for the mean to consider.
See Details for more information.
</p>
</td></tr>
<tr><td><code id="tCalibrate_+3A_transform">transform</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the lower bound on the Bayes factor.
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For one-sided t-tests (<code>type="one.sided"</code>), <code>alternative="simple"</code> considers all simple
point alternatives for the mean and <code>alternative="normal"</code> all shifted and possibly mirrored <br />
(if <code>direction=less</code>)
half-normal distributions with mode at the null value.
</p>
<p>For two-sided t-tests (<code>type="two.sided"</code>), <code>alternative="simple"</code> considers all
two-point distributions on the mean
which are symmetric with respect to the null value and <br />
<code>alternative="normal"</code> 
all local normal distributions centered around the null value.
</p>
<p>Note that for <code>alternative="normal"</code>,
the lower bound on the Bayes factor is the same for 
one-sided and two-sided p-values.
</p>
<p>For <code>type="one.sided", alternative="simple"</code>, the calibration is available
in closed form and is given in Held &amp; Ott (2018), 
equation (19).
</p>
<p>For <code>type="two.sided", alternative="simple"</code>, the calibration needs to be computed by
numerical optimization and is given in Held &amp; Ott (2018), 
equations (17) and (18).
</p>
<p>For <code>alternative="normal"</code>, the corresponding lower bound on the Bayes factor has been derived in Johnson (2005) and the calibration is proposed in Held &amp; Ott (2016), Section 3.
</p>
<p>If <code>alternative="normal"</code>, <code>tCalibrate()</code> is a special case of
<code>FCalibrate()</code>, i.e. <br /> <code>tCalibrate(p, n, alternative="normal")</code>
is equivalent to <br />
<code>FCalibrate(p, n, d=1, alternative="chi.squared")</code>.
</p>
<p>One can show that if one considers the class of all alternatives
which are symmetric with respect to the null value,
one obtains the same lower bound as for the subclass of all
symmetric two-point distributions.
</p>


<h3>Value</h3>

<p>A matrix containing the lower bounds on the Bayes factors 
as entries,
for all combinations of p-value and sample size.
The values for the k-th sample size (k-th entry in the vector <code>n</code>) and 
the specified p-values
are given in the k-th row.

</p>


<h3>References</h3>

<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393&ndash;419.
</p>
<p>Held, L. and Ott, M. (2016). How the maximal evidence of P-values against point null hypotheses depends
on sample size. <em>The American Statistician</em>, <b>70</b>, 335&ndash;341.
</p>
<p>Johnson, V. E. (2005). Bayes factors based on test statistics. 
<em>Journal of the Royal Statistical Society, Series B</em> <b>67</b>:689&ndash;701.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FCalibrate">FCalibrate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tCalibrate(p=c(0.05, 0.01, 0.005), n=10, type="one.sided", 
           alternative="simple")
# two-sided alternatives
tCalibrate(p=c(0.05, 0.01, 0.005), n=20, alternative="simple")
tCalibrate(p=c(0.05, 0.01, 0.005), n=c(10, 20, 50))

# for two-sided alternatives, plot the minimum Bayes factors 
# as a function of the p-value
par(mfrow=c(1,2), pty="s", las=1)

# plot for simple alternatives
p &lt;- exp(seq(log(0.0001), log(0.3), by=0.01))
n &lt;- c(10, 20, 50)
minBF &lt;- tCalibrate(p, n, alternative = "simple")
# compare to the bound for large n
bound1 &lt;- zCalibrate(p, alternative="simple")
matplot(p, t(minBF), ylim=c(0.0003, 1), type="l", 
        ylab="Min. Bayes factor", log="xy", 
        xlab="two-sided t-test p-value", lty=1, lwd=2, 
        axes=FALSE, main="Simple alternative")
lines(p, bound1, col="gray", lty=2, lwd=2)
my.at1 &lt;- c(0.0001, 0.0003, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3)
my.values1 &lt;- as.character(c(format(c(0.0001,0.0003), nsmall=4, 
                                    digits=4, scientific=FALSE), 
                           c(0.001, 0.003, 0.01, 0.03, 0.1, 0.3)))
axis(1, at=my.at1, labels=my.values1)
my.values2 &lt;- c(3000, 1000, 300, 100, 30, 10, 3, 1)
my.at2 &lt;- 1/my.values2
my.ylegend2 &lt;- c(paste("1/", my.values2[-length(my.values2)], sep=""), 
                 "1")
axis(2, at=my.at2, labels=my.ylegend2)
box()
legend("bottomright", legend=rev(c("n=10", "n=20", "n=50", "n large")), 
        lty=rev(c(rep(1,3), 2)), lwd=2, col=rev(c(1:3, "gray")))
       
# plot for local normal alternatives
p &lt;- exp(seq(log(0.0001), log(0.3), by=0.01))
n &lt;- c(10, 20, 50)
minBF &lt;- tCalibrate(p, n)
bound2 &lt;- zCalibrate(p)
matplot(p, t(minBF), ylim=c(0.0003, 1), type="l", 
        ylab="Min. Bayes factor", log="xy", 
        xlab="two-sided t-test p-value", lty=1, lwd=2, 
        axes=FALSE, main="Local normal alternatives")
lines(p, bound2, col="gray", lty=2, lwd=2)
axis(1, at=my.at1, labels=my.values1)
axis(2, at=my.at2, my.ylegend2)
box()            
legend("bottomright", legend=rev(c("n=10", "n=20", "n=50", "n large")), 
        lty=rev(c(rep(1,3), 2)), lwd=2, col=rev(c(1:3, "gray")))


</code></pre>

<hr>
<h2 id='twoby2Calibrate'>
Minimum Bayes factors and p-values from Fisher's exact test for 2x2 contingency tables
</h2><span id='topic+twoby2Calibrate'></span>

<h3>Description</h3>

<p>Computes a sample-size adjusted lower bound on the Bayes factor
(for the point null hypothesis against the alternative) 
for the given 2x2 contingency table.
Also returns p-values from Fisher's exact test
(different versions in the two-sided case) and less conservative
alternatives such as a mid p-value (see Details for more information).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twoby2Calibrate(x, type="two.sided", alternative="normal", 
                direction=NULL, transform.bf="id")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twoby2Calibrate_+3A_x">x</code></td>
<td>
<p>a 2x2 contingency table in matrix form
</p>
</td></tr>
<tr><td><code id="twoby2Calibrate_+3A_type">type</code></td>
<td>

<p>either <code>"one.sided"</code> or <code>"two.sided"</code>.
Defaults to <code>"two.sided"</code>.
Specifies if Fisher's exact test (and the corresponding p-value) is one-sided or two-sided.
</p>
</td></tr>
<tr><td><code id="twoby2Calibrate_+3A_alternative">alternative</code></td>
<td>

<p>either <code>"simple"</code> or <code>"normal"</code>.
Defaults to <code>"normal"</code>.
Specifies the alternative hypotheses for the (log) odds ratio to consider
for two-sided tests.
Is ignored if <code>type="one.sided"</code>
(in this case only simple alternatives are available).
</p>
</td></tr>
<tr><td><code id="twoby2Calibrate_+3A_direction">direction</code></td>
<td>

<p>either <code>"greater"</code>, <code>"less"</code> or <code>NULL</code>.
Defaults to <code>NULL</code>.
Specifies the direction of the alternative for one-sided tests: <code>"greater"</code> corresponds
to an odds ratio &gt; 1 and <code>"less"</code> to an odds ratio &lt; 1.
Is ignored if <code>type="two.sided"</code>.
</p>
</td></tr>
<tr><td><code id="twoby2Calibrate_+3A_transform.bf">transform.bf</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the lower bound on the Bayes factor.
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>type="two.sided"</code>,
the point null hypothesis that the odds ratio is 1 is tested
against
specific two-sided alternatives:
<code>alternative="simple"</code> considers all two-point distributions symmetric around 0 for
the log odds ratio.
<code>alternative="normal"</code> assumes a local normal prior distribution (a so-called g-prior) centered around 0
for the log odds ratio.  
</p>
<p>In the one-sided case (<code>type="one.sided"</code>), <code>direction="less"</code> tests the alternative that the odds ratio is
less than 1 and considers simple point alternatives in that direction
to compute the lower bound on the Bayes factor.
<code>"greater"</code> does the same for the alternative that the odds ratio is
larger than 1.
</p>
<p>The calibration obtained with <code>type="two.sided", alternative="normal"</code> is based on
the methodology proposed in Li &amp; Clyde (2018) 
and yields an (approximate) lower bound on the Bayes factor
in closed form.
All the other lower bounds on the Bayes factor
are computed by numerical optimization.
For <code>type="two.sided"</code>,
the two calibrations are described in Ott &amp; Held (2019).
</p>
<p>For one-sided alternatives, the following p-value and 2 related quantities are computed:
</p>

<ul>
<li> <p><code>p.fi</code>   is the one-sided p-value from Fisher's exact test.
</p>
</li>
<li> <p><code>p.mid</code> is a &quot;mid&quot; p-value. It is obtained by subtracting half of the
probability mass of the observed table from <code>p.fi</code>.
</p>
</li>
<li> <p><code>p.lie</code> is a Bayesian posterior probability. 
If <code>direction="greater"</code>, it is the posterior probability that the odds ratio
exceeds 1 given the observed table under the assumption of uniform priors on the
success probabilities for the two groups.
If <code>direction="less"</code>, it is the posterior probability that the odds ratio
does not exceed 1 given the observed table under the same priors.
</p>
</li></ul>

<p>For two-sided alternatives, the following 3 p-values and 2 related quantities are computed:
</p>

<ul>
<li> <p><code>p.pb</code>   is the &quot;probability-based&quot; p-value (the classical choice), 
defined as the sum
of the probabilities of all tables which are at most a likely as the observed table and
have the same marginals.
</p>
</li>
<li> <p><code>p.ce</code>  is the &quot;central&quot; p-value, which is twice the minimum one-sided p-value
(from Fisher's exact test),
bounded by 1.
</p>
</li>
<li> <p><code>p.bl</code> is &quot;Blaker's&quot; p-value, which is the minimum one-sided p-value
(from Fisher's exact test)
plus the largest tail probability from the other tail of the distribution that
does not exceed that minimum.
</p>
</li>
<li> <p><code>p.mid</code> is a &quot;mid&quot; p-value. It is the mid-p modification of the central p-value, 
i.e. it equals twice the minimum
one-sided mid p-value. 
</p>
</li>
<li> <p><code>p.lie</code> is a two-sided version of the posterior probability
for the one-sided test. 
Let p.lie.os be the one-sided posterior probability that the odds ratio does not exceed 1
given the observed table,
as returned by the one-sided test with <code>direction="less"</code>.
Then <code>p.lie</code> = 2 min{p.lie.os, 1-p.lie.os}.
</p>
</li></ul>

<p>For one-sided alternatives,
the posterior probability <code>p.lie</code> was already studied in Liebermeister (1877)
and its frequentist properties are investigated in Seneta &amp; Phipps (2001).
</p>
<p>For two-sided alternatives, the 3 p-values from Fisher's exact test are defined in equations (2.24)-(2.26)
in Kateri (2014) and computed using the function <code>exact2x2()</code> in the 
package <code>exact2x2</code>.
The &quot;mid&quot; p-value is described in Rothman &amp; Greenland (1998, pp. 222-223).
The Bayesian significance measure <code>p.lie</code> is proposed in Ott &amp; Held (2019)
as a modification of the corresponding one-sided significance measure.
</p>


<h3>Value</h3>

<p>A list of the following two elements:
</p>
<table role = "presentation">
<tr><td><code>minBF</code></td>
<td>
<p>the lower bound on the Bayes factor</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>A vector of 3 one-sided p-values/significance measures
for one-sided tests, <br />
namely first the p-value <code>p.fi</code> from Fisher's exact test,
second the corresponding mid p-value <code>p.mid</code> and 
third the Bayesian posterior probability <code>p.lie</code>
(see Details for more information).
</p>
<p>A vector of 5 two-sided p-values/significance measures
for two-sided tests: 
The first three p-values
<code>p.pb</code>, <code>p.ce</code> and <code>p.bl</code> (see Details for the definitions) correspond to
two-sided p-values from Fisher's exact test.
The 4th quantity <code>p.mid</code> is a mid p-value, namely the mid-p modification of the second p-value <code>p.ce</code>.
The last element <code>p.lie</code> is a Bayesian significance measure
(see Details for additional information).</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>For 2x2 tables with entries equal to 0,
the minimum Bayes factor is either not defined <br />
(for <code>alternative="normal"</code>) or 
the underlying numerical optimization is unstable <br />
(for <code>alternative="simple"</code>).
A warning is displayed in such cases and <code>minBF=NA</code>
is returned,
but the different p-values/significance measures 
are still available.
</p>


<h3>References</h3>

<p>Li, Y. and Clyde, M. A. (2018). Mixtures of g-priors in generalized linear models. 
<em>Journal of the American Statistical Association</em>, <b>113</b>:524, 1828&ndash;1845. 
<a href="https://doi.org/10.1080/01621459.2018.1469992">https://doi.org/10.1080/01621459.2018.1469992</a>
</p>
<p>Liebermeister, C. (1877). Ueber Wahrscheinlichkeitsrechnung in Anwendung auf therapeutische Statistik. Sammlung klinischer Vortraege. <em>Innere Medizin</em>, <b>110</b>(31&ndash;64), 935&ndash;
962.
</p>
<p>Kateri, M. (2014). Contingency Table Analysis - Methods and Implementation using R.
Statistics for Industry and Technology. Birkhaeuser.
</p>
<p>Ott, M. and Held, L. (2019). Bayesian calibration of p-values from Fisher's
exact test. <em>International Statistical Review</em> <b>87</b>(2), 285&ndash;305.
<a href="https://doi.org/10.1111/insr.12307">https://doi.org/10.1111/insr.12307</a>
</p>
<p>Rothman, K. J. and Greenland, S. (1998). Modern Epidemiology. 2nd ed. Lippincott-Raven.
</p>
<p>Seneta, E. and Phipps, M. C. (2001). On the comparison of two observed frequencies.
<em>Biometrical Journal</em>, <b>43</b>(1), 23&ndash;43.
</p>


<h3>See Also</h3>

<p>For computation of p-values:
<code><a href="exact2x2.html#topic+exact2x2">exact2x2</a></code> in package exact2x2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tab &lt;- matrix(c(1,15,5,10), nrow=2, byrow=TRUE)
# different minimum Bayes factors
twoby2Calibrate(x=tab, type="one.sided", direction="greater")$minBF
twoby2Calibrate(x=tab, type="one.sided", direction="less")$minBF
twoby2Calibrate(x=tab, type="two.sided", alternative="simple")$minBF
twoby2Calibrate(x=tab)$minBF
# one-sided p-values
twoby2Calibrate(x=tab, type="one.sided", direction="greater")$p.value
twoby2Calibrate(x=tab, type="one.sided", direction="less")$p.value
# two-sided p-values
twoby2Calibrate(x=tab)$p.value
</code></pre>

<hr>
<h2 id='z2p'>
Transform z-values to p-values
</h2><span id='topic+z2p'></span>

<h3>Description</h3>

<p>Transforms the z-value(s) to the corresponding one- or two-sided p-value(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z2p(z, type="two.sided")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="z2p_+3A_z">z</code></td>
<td>

<p>a vector of z-values
</p>
</td></tr>
<tr><td><code id="z2p_+3A_type">type</code></td>
<td>
<p>Underlying
type of p-value. Either &quot;two.sided&quot; or &quot;one.sided&quot;. 
Defaults to &quot;two.sided&quot;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of p-values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z2p(z=c(1,2,5))
z2p(z=c(1,2,5), type="one.sided")
</code></pre>

<hr>
<h2 id='zCalibrate'>
Calibration of p-values from z-tests
</h2><span id='topic+zCalibrate'></span>

<h3>Description</h3>

<p>Transforms one- and two-sided p-values from z-tests to minimum Bayes factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zCalibrate(p=NULL, z=p2z(p), type="two.sided",  
           alternative="normal", transform="id")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="zCalibrate_+3A_p">p</code></td>
<td>
<p>a vector of p-values, default is <code>NULL</code>
</p>
</td></tr>
<tr><td><code id="zCalibrate_+3A_z">z</code></td>
<td>
<p>a vector of z-values, is calculated from <code>p</code>, if necessary.
</p>
</td></tr>
<tr><td><code id="zCalibrate_+3A_type">type</code></td>
<td>

<p>either <code>"one.sided"</code> or <code>"two.sided"</code>.
Defaults to <code>"two.sided"</code>.
Specifies if the z-test (and the corresponding p-value) is one-sided or two-sided.
</p>
</td></tr>
<tr><td><code id="zCalibrate_+3A_alternative">alternative</code></td>
<td>
<p>either <code>"simple"</code>, <code>"normal"</code> or <code>"local"</code>.
Defaults to <code>"normal"</code>.
Specifies the alternative hypotheses for the mean to consider.
See Details for more information.
</p>
</td></tr>
<tr><td><code id="zCalibrate_+3A_transform">transform</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the minimum Bayes factor(s).
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For one-sided z-tests (<code>type="one.sided"</code>), 
<code>alternative="simple"</code> considers all simple
point alternatives for the mean in the specified direction, <code>alternative="normal"</code> all shifted and possibly mirrored (if <code>direction=less</code>)
half-normal distributions with mode at the null value and 
<code>alternative="local"</code> all monotonic density functions with mode at the null value,
which are concentrated on the parameter space of the alternative. 
</p>
<p>For two-sided z-tests (<code>type="two.sided"</code>), <code>alternative="simple"</code> considers all
two-point distributions on the mean
which are symmetric with respect to the null value, <br /> <code>alternative="normal"</code> 
all normal distributions centered around the null value and 
<br /> <code>alternative="local"</code> all unimodal symmetric distributions with respect the null value
(i.e. these distributions are non-increasing as a function of the distance to the null value).
</p>
<p>Note that for <code>alternative="normal"</code> and <code>alternative="local"</code>,
the minimum Bayes factor is the same for <code>type="one.sided"</code> and 
<code>type="two.sided"</code>.
</p>
<p>For <code>type="one.sided", alternative="simple"</code> and for <code>alternative="normal"</code>,
the calibrations have closed-form expressions and were proposed in Edwards et al. (1963).<br />
For <code>type="two.sided", alternative="simple"</code>  and for <code>alternative="local"</code>, the calibrations need to be computed by numerical optimization and were derived in 
Berger &amp; Sellke (1987). 
Most of these calibrations are also described in Held &amp; Ott (2018).
</p>
<p>Note that if one considers the class of all alternatives,
the resulting minimum Bayes factor is the same as for 
<code>type="one.sided", alternative="simple"</code>.
</p>
<p>One can show that if one considers the class of all alternatives
which are symmetric around the null value,
one obtains the same minimum Bayes factor as for the subclass of all
symmetric two-point distributions (Berger &amp; Sellke, 1987).
</p>


<h3>Value</h3>

<p>A numeric vector of minimum Bayes factors for the specified p-values 
</p>


<h3>Note</h3>

<p>For small p-values, using the corresponding z-value
as an argument instead of the p-value may lead to more accurate computations.
</p>


<h3>References</h3>

<p>Berger, J. O. and Sellke, T. (1987). Testing a point null hypothesis: The irreconcilability of P
values and evidence (with discussion). <em>Journal of the American Statistical Association</em>, <b>82</b>, 112&ndash;139.
</p>
<p>Edwards, W., Lindman, H. and Savage, L. J. (1963). Bayesian statistical inference for psychological research. 
<em>Psychological Review</em>, <b>70</b>, 193&ndash;242.
</p>
<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393&ndash;419.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tCalibrate">tCalibrate</a></code> 
for sample-size adjusted calibrations of p-values from t-tests
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
# two-sided alternatives
zCalibrate(p=c(0.05, 0.01, 0.005), alternative="simple")
zCalibrate(p=c(0.05, 0.01, 0.005))
zCalibrate(p=c(0.05, 0.01, 0.005), alternative="local")
zCalibrate(z=c(2, 3, 4), alternative="local")
# one-sided alternatives
zCalibrate(p=c(0.05, 0.01, 0.005), type="one.sided", 
           alternative="simple")
zCalibrate(p=c(0.05, 0.01, 0.005), type="one.sided")
zCalibrate(p=c(0.05, 0.01, 0.005), type="one.sided", 
           alternative="local")

# plot the different calibrations as a function of the p-value
par(las=1)
p &lt;- exp(seq(log(0.0001), log(0.3), by=0.01))
minBF &lt;- matrix(NA, ncol=4, nrow=length(p))
minBF[ ,1] &lt;- zCalibrate(p)
minBF[ ,2] &lt;- zCalibrate(p, type="two.sided", alternative="local")
minBF[ ,3] &lt;- zCalibrate(p, type="two.sided", alternative="simple")
minBF[ ,4] &lt;- zCalibrate(p, type="one.sided", alternative="simple")
matplot(p, minBF, type="l", ylab="Minimum Bayes factor", log="xy", 
        xlab="z-test p-value", lty=1, lwd=2, col=c(1,3,2,4), axes=FALSE)
axis(1, at=c(0.0001, 0.0003, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3), 
     as.character(c(format(c(0.0001,0.0003), nsmall=4, digits=4, 
                  scientific=FALSE), 
                  c(0.001, 0.003, 0.01, 0.03, 0.1, 0.3))))
my.values &lt;- c(3000, 1000, 300, 100, 30, 10, 3, 1)
my.at &lt;- 1/my.values
my.ylegend &lt;- c(paste("1/", my.values[-length(my.values)], sep=""), "1")
axis(2, at=my.at, my.ylegend)
box()
legend("bottomright", lty=1, lwd=2, 
        legend=c("normal", "unimodal symmetric", 
                "two-sided simple", "one-sided simple"), col=c(1,3,2,4))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
