<!DOCTYPE html><html><head><title>Help for package SpatGC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SpatGC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GC'><p>Gamma-Count (GC) Distribution</p></a></li>
<li><a href='#GClat'><p>Fit ICAR Spatial Gamma-Count Model</p></a></li>
<li><a href='#NBlat'><p>Fit Negative Binomial Spatial Model</p></a></li>
<li><a href='#Poislat'><p>Fit Poisson Spatial Model</p></a></li>
<li><a href='#rAdj'><p>Generate a Random Adjacency Matrix</p></a></li>
<li><a href='#rGCgeo'><p>Generate Data from GC Spatial Regression Model with Geospatial Dependency</p></a></li>
<li><a href='#rGClat'><p>Generate Data from GC Spatial Regression Model with Lattice Spatial Effect</p></a></li>
<li><a href='#spatCAR'><p>Generate Spatial Random Fields from CAR Models</p></a></li>
<li><a href='#spatGEO'><p>Generate Spatial Random Fields from Matern Covariance Model</p></a></li>
<li><a href='#spatICAR'><p>Generate Spatial Random Fields from ICAR Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Modeling of Spatial Count Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mahsa Nadifar &lt;mahsa.nst@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a collection of functions for preparing data and fitting Bayesian count spatial regression models, with a specific focus on the Gamma-Count (GC) model. The GC model is well-suited for modeling dispersed count data, including under-dispersed or over-dispersed counts, or counts with equivalent dispersion, using Integrated Nested Laplace Approximations (INLA). The package includes functions for generating data from the GC model, as well as spatially correlated versions of the model. See Nadifar, Baghishani, Fallah (2023) &lt;<a href="https://doi.org/10.1007%2Fs13253-023-00550-5">doi:10.1007/s13253-023-00550-5</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mahsanst/SpatGC">https://github.com/mahsanst/SpatGC</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://inla.r-inla-download.org/R/testing">https://inla.r-inla-download.org/R/testing</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, stats, spdep, sf</td>
</tr>
<tr>
<td>Suggests:</td>
<td>INLA (&ge; 23.06.15)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-24 19:15:06 UTC; u23027917</td>
</tr>
<tr>
<td>Author:</td>
<td>Mahsa Nadifar <a href="https://orcid.org/0000-0002-9130-125X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Hossein Baghishani
    <a href="https://orcid.org/0000-0002-6396-0303"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-25 15:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='GC'>Gamma-Count (GC) Distribution</h2><span id='topic+GC'></span><span id='topic+G'></span><span id='topic+dGC'></span><span id='topic+pGC'></span><span id='topic+qGC'></span><span id='topic+rGC'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for the GC distribution with
parameters <code class="reqn">\alpha</code> and <code class="reqn">\gamma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G(alpha, gamma)

dGC(y, alpha, gamma)

pGC(q, alpha, gamma, lower.tail = TRUE)

qGC(p, alpha = 1, gamma)

rGC(n = 1, alpha = 1, gamma = gamma, method = "PF")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GC_+3A_alpha">alpha</code></td>
<td>
<p>the dispersion parameter of GC: default is 1; (shape parameter of waiting time variable);</p>
</td></tr>
<tr><td><code id="GC_+3A_gamma">gamma</code></td>
<td>
<p>the rate parameter of GC and waiting time variable;</p>
</td></tr>
<tr><td><code id="GC_+3A_y">y</code></td>
<td>
<p>a vector or matrix of observations for which the pdf needs to be computed.</p>
</td></tr>
<tr><td><code id="GC_+3A_q">q</code></td>
<td>
<p>a vector or matrix of quantiles for which the cdf needs to be computed.</p>
</td></tr>
<tr><td><code id="GC_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P(Y \ge y)</code>; otherwise, <code class="reqn">P(Y &gt; y)</code>.</p>
</td></tr>
<tr><td><code id="GC_+3A_p">p</code></td>
<td>
<p>a vector or matrix of probabilities for which the quantile needs to be computed.</p>
</td></tr>
<tr><td><code id="GC_+3A_n">n</code></td>
<td>
<p>number of random values to be generated.</p>
</td></tr>
<tr><td><code id="GC_+3A_method">method</code></td>
<td>
<p>Character string. The method used for generating random variables from the GC distribution in 'rGC'. Options are:
- '&quot;PF&quot;': Based on the probability function.
- '&quot;IT&quot;': Inverse transformation method based on the quantile function.
- '&quot;WT&quot;': Based on the waiting times distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GC distribution with parameters  <code class="reqn">\alpha</code> and <code class="reqn">\gamma</code>
has the density
</p>
<p style="text-align: center;"><code class="reqn">P(Y_T=y)=G(y\alpha,\gamma T)-G\left(\left(y+1\right)\alpha,\gamma T\right)</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">G(n\alpha,\gamma T)=\frac{1}{\Gamma(n\alpha)}\int_{0}^{\gamma T} u^{n\alpha-1}\exp(-u)du</code>
</p>

<p>for <code class="reqn">\alpha</code> and <code class="reqn">\lambda</code> which must be positive
values and <code class="reqn">y \in \{0, 1, 2, \ldots\}</code>.
</p>


<h3>Value</h3>

<p><code>G</code> gives the G function,
<code>pGC</code> gives the distribution function,
<code>dGC</code> gives the density,
<code>qGC</code> gives the quantile function and
<code>rGC</code> generates random variables from the GC Distribution.
</p>


<h3>References</h3>

<p>Winkelmann, R. (1995). Duration dependence and dispersion in count-data models.
<em>Journal of Business &amp; Economic Statistics</em>, 13(4):467-474.
Nadifar, M., Baghishani, H., and Fallah, A. (2023). A flexible
generalized poisson likelihood for spatial counts constructed by renewal theory, motivated by groundwater
quality assessment.
<em>Journal of Agricultural, Biological, and Environmental Statistics</em>,
28:726-748.
<em>Neutrosophic Sets and Systems</em>,  22, 30-38.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In a study, the number of disease incidence, we will calculate
# the probability that the number of disease is zero with rate 1
dGC(0, alpha = 1, gamma = 1)

# the probability that the disease will receive at least one
pGC(q = 1, alpha = 1, gamma = 1, lower.tail = FALSE)
# the probability that the disease will receive at most three
pGC(q = 3, alpha = 1, gamma = 1, lower.tail = TRUE)
# Calcaute the quantiles
qGC(p = c(0.25, 0.5, 0.75), alpha = 1, gamma = 1)
# Simulate 10 values from GC(1, 1)
rGC(n = 10, alpha = 1, gamma = 1, method = "PF")
</code></pre>

<hr>
<h2 id='GClat'>Fit ICAR Spatial Gamma-Count Model</h2><span id='topic+GClat'></span>

<h3>Description</h3>

<p>This function fits an ICAR spatial Gamma-Count (GC) model to a given dataset using the INLA package.
It constructs the formula based on the provided covariate data and ID variables, and fits the model using
the specified adjacency matrix ('W') or a shapefile of the study region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GClat(Y, ID, W = NULL, shapefile = NULL, covariate = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GClat_+3A_y">Y</code></td>
<td>
<p>Vector of response variables (counts).</p>
</td></tr>
<tr><td><code id="GClat_+3A_id">ID</code></td>
<td>
<p>Vector of indexes of regions (spatial units).</p>
</td></tr>
<tr><td><code id="GClat_+3A_w">W</code></td>
<td>
<p>Optional adjacency matrix representing spatial connections between regions.
If not provided, it can be generated from a shapefile using the 'shapefile' argument.</p>
</td></tr>
<tr><td><code id="GClat_+3A_shapefile">shapefile</code></td>
<td>
<p>Optional shapefile representing the study region. If provided, the adjacency matrix ('W')
will be calculated from the shapefile.</p>
</td></tr>
<tr><td><code id="GClat_+3A_covariate">covariate</code></td>
<td>
<p>Optional matrix of covariates. If not provided, the function assumes the model
is intercept-only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;inla&quot; representing the fitted ICAR spatial GC model.
The object contains model estimates, diagnostics, and other results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  # Generate data from the GC spatial regression model with lattice spatial dependency
  W &lt;- rAdj(500) # Generate a random adjacency matrix
  DDl &lt;- rGClat(n = 500, alpha = 1, beta0 = 0.3, beta = c(-0.5, 0.5), W = W, V = 1)

  # Prepare the data
  Y &lt;- DDl$y
  covariate &lt;- DDl$covariate
  ID &lt;- DDl$ID

  # Fit the spatial GC model
  ResultGC &lt;- GClat(Y = Y, ID = ID, covariate = covariate, W = W)

  # Summary of the model fit
  summary(ResultGC)


</code></pre>

<hr>
<h2 id='NBlat'>Fit Negative Binomial Spatial Model</h2><span id='topic+NBlat'></span>

<h3>Description</h3>

<p>This function fits a negative binomial spatial model (including zero-inflated variations)
to a given dataset using the INLA package. The function constructs the formula based on
the provided covariate data and ID variables, and fits the model using the specified
adjacency matrix ('W') or a shapefile of the study region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NBlat(
  Y,
  ID,
  W = NULL,
  shapefile = NULL,
  covariate = NULL,
  family = c("nbinomial", "zeroinflatedbinomial0", "zeroinflatedbinomial1")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NBlat_+3A_y">Y</code></td>
<td>
<p>Vector of response variables (counts).</p>
</td></tr>
<tr><td><code id="NBlat_+3A_id">ID</code></td>
<td>
<p>Vector of indexes of regions (spatial units).</p>
</td></tr>
<tr><td><code id="NBlat_+3A_w">W</code></td>
<td>
<p>Optional adjacency matrix representing spatial connections between regions.
If not provided, it can be generated from a shapefile using the 'shapefile' argument.</p>
</td></tr>
<tr><td><code id="NBlat_+3A_shapefile">shapefile</code></td>
<td>
<p>Optional shapefile representing the study region. If provided, the adjacency matrix ('W')
will be calculated from the shapefile.</p>
</td></tr>
<tr><td><code id="NBlat_+3A_covariate">covariate</code></td>
<td>
<p>Optional matrix of covariates. If not provided, the function assumes the model
is intercept-only.</p>
</td></tr>
<tr><td><code id="NBlat_+3A_family">family</code></td>
<td>
<p>The family of negative binomial models to use. Options are &quot;nbinomial&quot;,
&quot;zeroinflatedbinomial0&quot;, and &quot;zeroinflatedbinomial1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;inla&quot; representing the fitted negative binomial spatial model.
The object contains model estimates, diagnostics, and other results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  # Generate data from the GC spatial regression model with lattice spatial dependency
  W &lt;- rAdj(500) # Generate a random adjacency matrix
  DDl &lt;- rGClat(n = 200, alpha = 1, beta0 = 0.3, beta = c(-0.5, 0.5),
  W = W, spatial = "lattice", V = 1)

  # Prepare the data
  Y &lt;- DDl$y
  covariate &lt;- DDl$covariate
  ID &lt;- DDl$ID

  # Fit the spatial negative binomial model
  ResultNB &lt;- NBlat(Y = Y, ID = ID, covariate = covariate, W = W, family = "nbinomial")

  # Summary of the model fit
  summary(ResultNB)


</code></pre>

<hr>
<h2 id='Poislat'>Fit Poisson Spatial Model</h2><span id='topic+Poislat'></span>

<h3>Description</h3>

<p>This function fits a Poisson spatial model (including zero-inflated and gamma Poisson variations)
to a given dataset using the INLA package. It constructs the formula based on the provided covariate data and ID variables,
and fits the model using the specified adjacency matrix ('W') or a shapefile of the study region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Poislat(
  Y,
  ID,
  W = NULL,
  shapefile = NULL,
  covariate = NULL,
  family = c("gpoisson", "poisson", "zeroinflatedpoisson0", "zeroinflatedpoisson1")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Poislat_+3A_y">Y</code></td>
<td>
<p>Vector of response variables (counts).</p>
</td></tr>
<tr><td><code id="Poislat_+3A_id">ID</code></td>
<td>
<p>Vector of indexes of regions (spatial units).</p>
</td></tr>
<tr><td><code id="Poislat_+3A_w">W</code></td>
<td>
<p>Optional adjacency matrix representing spatial connections between regions.
If not provided, it can be generated from a shapefile using the 'shapefile' argument.</p>
</td></tr>
<tr><td><code id="Poislat_+3A_shapefile">shapefile</code></td>
<td>
<p>Optional shapefile representing the study region. If provided, the adjacency matrix ('W')
will be calculated from the shapefile.</p>
</td></tr>
<tr><td><code id="Poislat_+3A_covariate">covariate</code></td>
<td>
<p>Optional matrix of covariates. If not provided, the function assumes the model
is intercept-only.</p>
</td></tr>
<tr><td><code id="Poislat_+3A_family">family</code></td>
<td>
<p>The family of Poisson models to use. Options are &quot;gpoisson&quot;, &quot;poisson&quot;,
&quot;zeroinflatedpoisson0&quot;, and &quot;zeroinflatedpoisson1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;inla&quot; representing the fitted Poisson spatial model.
The object contains model estimates, diagnostics, and other results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Generate data from the GC spatial regression model with lattice spatial dependency
  W &lt;- rAdj(500) # Generate a random adjacency matrix
  DDl &lt;- rGClat(n = 200, alpha = 1, beta0 = 0.3, beta = c(-0.5, 0.5),
  W = W, spatial = "lattice", V = 1)

  # Prepare the data
  Y &lt;- DDl$y
  covariate &lt;- DDl$covariate
  ID &lt;- DDl$ID

  # Fit the spatial Poisson model
  ResultPoisson &lt;- Poislat(Y = Y, ID = ID, covariate = covariate, W = W, family = "poisson")

  # Summary of the model fit
  summary(ResultPoisson)


</code></pre>

<hr>
<h2 id='rAdj'>Generate a Random Adjacency Matrix</h2><span id='topic+rAdj'></span>

<h3>Description</h3>

<p>This function generates a random adjacency matrix for a given number of regions.
The matrix is symmetric, and the upper triangular part (excluding the diagonal) is
randomly generated using the <code><a href="stats.html#topic+rbinom">rbinom</a></code> function with a specified
probability. The lower triangular part is filled in by reflecting the upper triangular
part to ensure the matrix is symmetric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rAdj(n, prob = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rAdj_+3A_n">n</code></td>
<td>
<p>Integer. The number of regions, which determines the dimensions of the
adjacency matrix. Must be a positive integer.</p>
</td></tr>
<tr><td><code id="rAdj_+3A_prob">prob</code></td>
<td>
<p>Numeric. The probability of an edge (connection) between two regions,
used as the probability for the binomial distribution. Default value is 0.2.
Should be between 0 and 1 (inclusive).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A symmetric numeric matrix of dimensions <code>n x n</code> representing the
adjacency matrix. The values in the matrix are either 0 or 1, where 1 indicates
an edge (connection) between two regions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate a random adjacency matrix for 5 regions with a probability of 0.3
random_adj_matrix &lt;- rAdj(5, prob = 0.3)
print(random_adj_matrix)

# Check if the matrix is symmetric
all(random_adj_matrix == t(random_adj_matrix))


</code></pre>

<hr>
<h2 id='rGCgeo'>Generate Data from GC Spatial Regression Model with Geospatial Dependency</h2><span id='topic+rGCgeo'></span>

<h3>Description</h3>

<p>This function generates spatially dependent count data based on the Gamma-Count (GC) spatial regression model.
It uses a specified geospatial dependency model with parameters such as 'sigma' for variance and 'range' for spatial range.
The function returns a list containing the generated data and relevant information about the simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rGCgeo(
  n = n,
  alpha,
  beta0,
  beta,
  V = NULL,
  rho = 1,
  sigma = NULL,
  range = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rGCgeo_+3A_n">n</code></td>
<td>
<p>Integer. The number of knots (or spatial units) for which the data should be generated.</p>
</td></tr>
<tr><td><code id="rGCgeo_+3A_alpha">alpha</code></td>
<td>
<p>Numeric. The dispersion parameter of the Gamma-Count model.</p>
</td></tr>
<tr><td><code id="rGCgeo_+3A_beta0">beta0</code></td>
<td>
<p>Numeric. The intercept term for the model.</p>
</td></tr>
<tr><td><code id="rGCgeo_+3A_beta">beta</code></td>
<td>
<p>Numeric vector. The regression coefficients (fixed effects) for the model.</p>
</td></tr>
<tr><td><code id="rGCgeo_+3A_v">V</code></td>
<td>
<p>Optional numeric. The variance of the spatial random effects for lattice data.</p>
</td></tr>
<tr><td><code id="rGCgeo_+3A_rho">rho</code></td>
<td>
<p>Optional numeric. The spatial correlation coefficient for the CAR model. Default is 1.</p>
</td></tr>
<tr><td><code id="rGCgeo_+3A_sigma">sigma</code></td>
<td>
<p>Optional numeric. The variance of the spatial random effects for geospatial data with Matern covariance.</p>
</td></tr>
<tr><td><code id="rGCgeo_+3A_range">range</code></td>
<td>
<p>Optional numeric. The range parameter for geospatial data with Matern covariance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt>covariate</dt><dd><p>A matrix of covariates with the specified number of knots ('n') and columns based on the length of 'beta'.</p>
</dd>
<dt>phi</dt><dd><p>A vector of spatial random effects generated from the Matern covariance model.</p>
</dd>
<dt>eta</dt><dd><p>A vector representing the linear predictor, calculated as the dot product of the covariates and coefficients plus the spatial effects ('phi').</p>
</dd>
<dt>mu</dt><dd><p>A vector of mean response values calculated as the product of 'alpha' and the exponential of 'eta'.</p>
</dd>
<dt>y</dt><dd><p>A vector of simulated count data based on the GC model and the mean response values ('mu').</p>
</dd>
<dt>ID</dt><dd><p>A vector of knot IDs from 1 to 'n'.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Generate data from the GC spatial regression model with geospatial dependency

data &lt;- rGCgeo(n = 100, alpha = 1, beta0 = 0.3, beta = c(-0.5, 0.5),
sigma = 1, range = 2)

# View the generated data
print(data)


</code></pre>

<hr>
<h2 id='rGClat'>Generate Data from GC Spatial Regression Model with Lattice Spatial Effect</h2><span id='topic+rGClat'></span>

<h3>Description</h3>

<p>This function generates spatially dependent count data based on the Gamma-Count (GC) spatial regression model.
It uses a specified spatial dependency model (either ICAR or CAR) and optional adjacency matrix or shapefile for spatial relationships.
The function returns a list containing the generated data and relevant information about the simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rGClat(
  n = n,
  alpha,
  beta0,
  beta,
  spatial = "ICAR",
  W = NULL,
  V = NULL,
  rho = 1,
  shapefile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rGClat_+3A_n">n</code></td>
<td>
<p>Integer. The number of knots (or spatial units) for which the data should be generated. If a shapefile or adjacency matrix ('W') is provided, this will be determined from those inputs.</p>
</td></tr>
<tr><td><code id="rGClat_+3A_alpha">alpha</code></td>
<td>
<p>Numeric. The dispersion parameter of the Gamma-Count model.</p>
</td></tr>
<tr><td><code id="rGClat_+3A_beta0">beta0</code></td>
<td>
<p>Numeric. The intercept term for the model.</p>
</td></tr>
<tr><td><code id="rGClat_+3A_beta">beta</code></td>
<td>
<p>Numeric vector. The regression coefficients (fixed effects) for the model.</p>
</td></tr>
<tr><td><code id="rGClat_+3A_spatial">spatial</code></td>
<td>
<p>Character. Specifies the type of spatial dependency to use. Options are &quot;ICAR&quot; for Intrinsic Conditional Autoregressive, or &quot;CAR&quot; for Conditional Autoregressive.</p>
</td></tr>
<tr><td><code id="rGClat_+3A_w">W</code></td>
<td>
<p>Optional matrix. The adjacency matrix for lattice data. If provided, it will be used to define spatial relationships between knots.</p>
</td></tr>
<tr><td><code id="rGClat_+3A_v">V</code></td>
<td>
<p>Optional numeric. The variance of the spatial random effects for lattice data.</p>
</td></tr>
<tr><td><code id="rGClat_+3A_rho">rho</code></td>
<td>
<p>Optional numeric. The spatial correlation coefficient for the CAR model. Default is 1.</p>
</td></tr>
<tr><td><code id="rGClat_+3A_shapefile">shapefile</code></td>
<td>
<p>Optional. A shapefile defining the spatial relationships between knots. If provided, it will be used to define an adjacency matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt>covariate</dt><dd><p>A matrix of covariates with the specified number of knots ('n') and columns based on the length of 'beta'.</p>
</dd>
<dt>phi</dt><dd><p>A vector of spatial random effects, generated based on the specified spatial dependency model ('spatial').</p>
</dd>
<dt>eta</dt><dd><p>A vector representing the linear predictor, calculated as the dot product of the covariates and coefficients plus the spatial effects ('phi').</p>
</dd>
<dt>y</dt><dd><p>A vector of simulated count data based on the GC model and the linear predictor ('eta').</p>
</dd>
<dt>ID</dt><dd><p>A vector of knot IDs from 1 to 'n'.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Generate a random adjacency matrix for a 429x429 grid
W &lt;- rAdj(429)

# Generate data from the GC spatial regression model with the specified parameters
data &lt;- rGClat(n = 200, alpha = 1, beta0 = 0.3, beta = c(-0.5, 0.5),
spatial = "ICAR", W = W, V = 1)

# View the generated data
print(data)


</code></pre>

<hr>
<h2 id='spatCAR'>Generate Spatial Random Fields from CAR Models</h2><span id='topic+spatCAR'></span>

<h3>Description</h3>

<p>This function generates spatial random fields from Conditional Autoregressive (CAR) models
for lattice spatial data. Given a neighborhood matrix, a variance parameter, and a spatial
dependence parameter, the function produces a spatial random field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatCAR(W, sig, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatCAR_+3A_w">W</code></td>
<td>
<p>Numeric matrix. The neighborhood matrix representing the adjacency relationships
between spatial units.
It can be provided by using the function 'rAdj'.</p>
</td></tr>
<tr><td><code id="spatCAR_+3A_sig">sig</code></td>
<td>
<p>Numeric. The variance of the spatial random effects from the CAR model.
Must be positive.</p>
</td></tr>
<tr><td><code id="spatCAR_+3A_rho">rho</code></td>
<td>
<p>Numeric. The spatial dependence parameter for the CAR model.
Must be between -1 and 1, inclusive.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function starts by computing the diagonal matrix of the number of neighbors for each
spatial unit.
Then, it calculates the precision matrix (Q) based on the given parameters and
neighborhood matrix.
A small constant (0.0001) is added to the diagonal to ensure the precision matrix is
non-singular.
Finally, the covariance matrix is calculated as the inverse of the precision matrix
multiplied by the variance parameter ('sig').
The function uses multivariate normal random generation
(using 'rmvnorm' from the 'mvtnorm' package) to produce the spatial random field.
</p>


<h3>Value</h3>

<p>A numeric vector representing the spatial random field from the CAR model.
The length of the vector
is equal to the number of spatial units (rows in the neighborhood matrix).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a random adjacency matrix for 5 spatial regions with a probability of 0.2
W &lt;- rAdj(n = 5, p = 0.2)

# Generate a spatial random field from the CAR model using the adjacency matrix
# with parameters variance = 0.1, and rho = 0.5
spatial_random_field &lt;- spatCAR(W = W, sig = 0.1, rho = 0.5)
print(spatial_random_field)

</code></pre>

<hr>
<h2 id='spatGEO'>Generate Spatial Random Fields from Matern Covariance Model</h2><span id='topic+spatGEO'></span>

<h3>Description</h3>

<p>This function generates spatial random fields from the Matern covariance model for geospatial data.
Given a number of knots, a variance parameter, and a range parameter, the function produces
a spatial random field from the Matern covariance model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatGEO(m, sigma, range)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatGEO_+3A_m">m</code></td>
<td>
<p>Integer. The number of knots (or spatial units) for which the spatial random field should be generated.</p>
</td></tr>
<tr><td><code id="spatGEO_+3A_sigma">sigma</code></td>
<td>
<p>Numeric. The variance of the spatial random effects with Matern covariance. Must be positive.</p>
</td></tr>
<tr><td><code id="spatGEO_+3A_range">range</code></td>
<td>
<p>Numeric. The range of the spatial random effects with Matern covariance. Must be positive.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function starts by converting the variance ('sigma') and range ('range') parameters into the tau and kappa
parameters required for the Matern covariance model. Then, it constructs a mesh for the given number of knots,
defining the spatial layout of the data. The function uses INLA functions ('inla.spde2.matern' and others) to
create an SPDE object and set the priors for the spatial model. It then projects the mesh and constructs a predictor
for the model. Finally, the function calculates the precision matrix, samples from the distribution, and computes
the spatial random field using the A matrix and sampled values.
</p>


<h3>Value</h3>

<p>A numeric vector representing the spatial random field from the Matern covariance model.
The length of the vector is equal to the number of knots specified by the parameter 'm'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Generate a spatial random field from the Matern covariance model
# using 100 knots, variance = 1, and range = 1
spatial_random_field &lt;- spatGEO(m = 100, sigma = 1, range = 1)
print(spatial_random_field)


</code></pre>

<hr>
<h2 id='spatICAR'>Generate Spatial Random Fields from ICAR Models</h2><span id='topic+spatICAR'></span>

<h3>Description</h3>

<p>This function generates spatial random fields from Intrinsic Conditional Autoregressive (ICAR)
models for lattice spatial data. Given an adjacency matrix and a variance parameter, the function
produces a spatial random field from the ICAR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatICAR(W, sig = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatICAR_+3A_w">W</code></td>
<td>
<p>Numeric matrix. The adjacency matrix representing the adjacency relationships between spatial units.
It can be provided by using the function 'generate_adjacency_matrix'.</p>
</td></tr>
<tr><td><code id="spatICAR_+3A_sig">sig</code></td>
<td>
<p>Numeric. The variance of the spatial random effects from the ICAR model. Must be positive.
Default value is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function starts by computing the degree of each spatial unit (number of neighbors) from the adjacency matrix.
Then, it constructs the precision matrix (Q) based on the adjacency matrix. The function computes the eigenvalues and eigenvectors of Q.
To generate the spatial random field, it uses a standard normal distribution to generate a vector of random numbers,
scales the random numbers by the variance and the inverse of the eigenvalues (excluding the smallest eigenvalue), and then transforms
the random numbers using the eigenvectors. The function returns a spatial random field vector.
</p>


<h3>Value</h3>

<p>A numeric vector representing the spatial random field from the ICAR model.
The length of the vector is equal to the number of spatial units (columns in the adjacency matrix).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define an adjacency matrix for 5 spatial units
W &lt;- rAdj(n = 5, p = 0.2)

# Generate spatial random field from ICAR model with variance = 1
spatial_random_field_icar &lt;- spatICAR(W = W, sig = 1)
print(spatial_random_field_icar)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
