<!DOCTYPE html><html lang="en"><head><title>Help for package capm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {capm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#capm-package'><p>The capm Package</p></a></li>
<li><a href='#Calculate2StageSampleSize'><p>Two-stage cluster sampling size and composition (Deprecated)</p></a></li>
<li><a href='#CalculateGlobalSens'><p>Global sensitivity analysis</p></a></li>
<li><a href='#CalculateLocalSens'><p>Local sensitivity analysis</p></a></li>
<li><a href='#CalculatePopChange'><p>Population change.</p></a></li>
<li><a href='#CalculateSimpleSampleSize'><p>Simple random sample size</p></a></li>
<li><a href='#CalculateStratifiedSampleSize'><p>Stratified random sample size</p></a></li>
<li><a href='#cats'><p>Cat's sample data from Pinhais, Brazil, 2017</p></a></li>
<li><a href='#cluster_sample'><p>Household data from a two-stage cluster sample</p></a></li>
<li><a href='#DesignSurvey'><p>Survey design</p></a></li>
<li><a href='#dogs'><p>Dog's sample data from Pinhais, Brazil, 2017</p></a></li>
<li><a href='#FreqTab'><p>Frequency table of categorical variables</p></a></li>
<li><a href='#GetDataIASA'><p>Get initial values and paramters for IASA model from survey data</p></a></li>
<li><a href='#MapkmlPSU'><p>Creates *.kml files of a subset of polygons from a polygon shapefile</p></a></li>
<li><a href='#PlotGlobalSens'><p>Plot results of GlobalSens function</p></a></li>
<li><a href='#PlotHHxSpecies'><p>Distribution of households according to the number of inhabitants one or more species</p></a></li>
<li><a href='#PlotImmigrationFlow'><p>Plot immigration flows</p></a></li>
<li><a href='#PlotLocalSens'><p>Plot results of CalculateLocalSens function</p></a></li>
<li><a href='#PlotModels'><p>Plot results of capm model functions</p></a></li>
<li><a href='#PlotPopPyramid'><p>Population PlotPopPyramid</p></a></li>
<li><a href='#psu_ssu'><p>Census tracts of Pinhais, Brazil.</p></a></li>
<li><a href='#SamplePPS'><p>Sampling with probability proportional to size and with replacement</p></a></li>
<li><a href='#SampleSystematic'><p>Simple and stratified systematic sampling</p></a></li>
<li><a href='#SetRanges'><p>Parameter ranges for global sensitivity analysis</p></a></li>
<li><a href='#SolveIASA'><p>Modelling of immigration, abandonment, sterilization and adoption of companion animals</p></a></li>
<li><a href='#SolveSI'><p>Modelling of sterilization and immigration of comapnion animals.</p></a></li>
<li><a href='#SolveTC'><p>Modelling of reversible contraception for companion animals</p></a></li>
<li><a href='#SummarySurvey'><p>Summary statistics for sample surveys</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Companion Animal Population Management</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve, FME, survey, ggplot2, dplyr, tidyr, magrittr, grid,
stats, circlize, utils, sf</td>
</tr>
<tr>
<td>Description:</td>
<td>Quantitative analysis to support companion animal population
    management. Some functions assist survey sampling tasks (calculate sample 
    size for simple and complex designs, select sampling units and estimate 
    population parameters) while others assist the modelling of population 
    dynamics. For demographic characterizations and population management 
    evaluations see: "Baquero, et al." (2018), 
    &lt;<a href="https://doi.org/10.1016%2Fj.prevetmed.2018.07.006">doi:10.1016/j.prevetmed.2018.07.006</a>&gt;. For modelling of 
    population dynamics see: "Baquero et al." (2016),
    &lt;<a href="https://doi.org/10.1016%2Fj.prevetmed.2015.11.009">doi:10.1016/j.prevetmed.2015.11.009</a>&gt;. For sampling methods
    see: "Levy PS &amp; Lemeshow S" (2013), "ISBN-10: 0470040076"; 
    "Lumley" (2010), "ISBN: 978-0-470-28430-8".</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a></td>
</tr>
<tr>
<td>Version:</td>
<td>0.14.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-10-24</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-24 16:29:36 UTC; oswaldo</td>
</tr>
<tr>
<td>Author:</td>
<td>Oswaldo Santos Baquero [aut, cre],
  Marcos Amaku [ctb],
  Fernando Ferreira [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oswaldo Santos Baquero &lt;baquero@usp.br&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-24 16:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='capm-package'>The capm Package</h2><span id='topic+capm-package'></span>

<h3>Description</h3>

<p>Companion Animal Population Management. Provides functions for quantitative Companion Animal Population Management. Further information can be found in the URL given below.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> capm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.14.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-10-24</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.4)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> deSolve, FME, survey, dplyr, tidyr, magrittr, ggplot2, grid, stats, utils, sf</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> <a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a></td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Oswaldo Santos Baquero <a href="mailto:baquero@usp.br">baquero@usp.br</a></td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Oswaldo Santos Baquero <a href="mailto:baquero@usp.br">baquero@usp.br</a></td>
</tr>
<tr>
 <td style="text-align: left;">
Contributors: </td><td style="text-align: left;"> Marcos Amaku <a href="mailto:amaku@vps.fmvz.usp.br">amaku@vps.fmvz.usp.br</a>, Fernando Ferreira <a href="mailto:fernando@vps.fmvz.usp.br">fernando@vps.fmvz.usp.br</a>
</td>
</tr>

</table>


<hr>
<h2 id='Calculate2StageSampleSize'>Two-stage cluster sampling size and composition (Deprecated)</h2><span id='topic+Calculate2StageSampleSize'></span>

<h3>Description</h3>

<p>Calculates sample size and composition to estimate a total from a two-stage cluster sampling design. This function is deprecated, see details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Calculate2StageSampleSize(psu.ssu = NULL, psu.x = NULL,
  conf.level = 0.95, error = 0.1, cost = 4, minimum.ssu = 15)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Calculate2StageSampleSize_+3A_psu.ssu">psu.ssu</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with all primary sampling units (PSU). First column contains PSU unique identifiers. Second column contains <code><a href="base.html#topic+numeric">numeric</a></code> PSU sizes.</p>
</td></tr>
<tr><td><code id="Calculate2StageSampleSize_+3A_psu.x">psu.x</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code>. Each row corresponds to a secondary sampling unit (SSU) included in a pilot study. First column contains the PSU identifiers to which the ssu belongs to. Second column contains the totals observed in the ssu and must be <code><a href="base.html#topic+numeric">numeric</a></code>.</p>
</td></tr>
<tr><td><code id="Calculate2StageSampleSize_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level required. It must be <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1 inclusive.</p>
</td></tr>
<tr><td><code id="Calculate2StageSampleSize_+3A_error">error</code></td>
<td>
<p>the maximum relative difference between the estimate and the unknown population value. It must be <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1 inclusive.</p>
</td></tr>
<tr><td><code id="Calculate2StageSampleSize_+3A_cost">cost</code></td>
<td>
<p>the ratio of the cost of sampling a PSU to the cost of sampling a SSU.</p>
</td></tr>
<tr><td><code id="Calculate2StageSampleSize_+3A_minimum.ssu">minimum.ssu</code></td>
<td>
<p>integer to define the minimum number of SSU to be selected per PSU. If the calculated number of SSU to be selected is lesser than <code>minimum.ssu</code>, it is redefined as <code>minimum.ssu</code>. To avoid any lower threshold, define <code>minimum.ssu</code> as equal to 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that PSU from the pilot are selected with probability proportional to size (PPS) and with replacement. SSU are assumed to be selected via simple (systematic) random sampling.
</p>
<p>PSU must have the same identifiers in <code>psu.ssu</code> and in <code>psu.x</code>.
This function is deprecated because a study (Baquero et. al, 2018a) showed that the calculated sample size are too large for practical purposes. The same study found predefined sample compositions that result in estimates with precision equivalent to that achieved with the algorithm implemented in this function.
The predefined sample compositions are (PSU * SSU): 65 \* 15, 50 \* 20, and 30 \* 30. If possible, take larger samples.
</p>


<h3>Value</h3>

<p>Matrix with the sample size and composition and with variability estimates.
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p>Levy P and Lemeshow S (2008). Sampling of populations: methods and applications, Fourth edition. John Wiley and Sons, Inc.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>

<hr>
<h2 id='CalculateGlobalSens'>Global sensitivity analysis</h2><span id='topic+CalculateGlobalSens'></span>

<h3>Description</h3>

<p>Wraper for <code><a href="FME.html#topic+sensRange">sensRange</a></code> function, which calculates sensitivities of population sizes to parameters used in one of the following functions: <code><a href="#topic+SolveIASA">SolveIASA</a></code>, <code><a href="#topic+SolveSI">SolveSI</a></code> or <code><a href="#topic+SolveTC">SolveTC</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateGlobalSens(model.out = NULL, ranges = NULL, sensv = NULL,
  all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CalculateGlobalSens_+3A_model.out">model.out</code></td>
<td>
<p>output from one of the previous function or a <code><a href="base.html#topic+list">list</a></code> with equivalent structure.</p>
</td></tr>
<tr><td><code id="CalculateGlobalSens_+3A_ranges">ranges</code></td>
<td>
<p>output from the <code><a href="#topic+SetRanges">SetRanges</a></code> function applied to the <code>pars</code> argument used in the function specified in <code>model.out</code>.</p>
</td></tr>
<tr><td><code id="CalculateGlobalSens_+3A_sensv">sensv</code></td>
<td>
<p>string with the name of the output variables for which the sensitivity are to be estimated.</p>
</td></tr>
<tr><td><code id="CalculateGlobalSens_+3A_all">all</code></td>
<td>
<p>logical. If <code><a href="base.html#topic+FALSE">FALSE</a></code>, sensitivity ranges are calculated for each parameter. If <code>TRUE</code>, sensitivity ranges are calculated for the combination of all aparameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>all</code> is equal to TRUE, <code>dist</code> argument in <code><a href="FME.html#topic+sensRange">sensRange</a></code> is defined as &quot;latin&quot; and when equal to <code><a href="base.html#topic+FALSE">FALSE</a></code>, as &quot;grid&quot;. The <code>num</code> argument in <code><a href="FME.html#topic+sensRange">sensRange</a></code> is defined as 100.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> (extended by <code>summary.sensRange</code> when <code>all == TRUE</code>) containing the parameter set and the corresponding values of the sensitivity output variables.
</p>


<h3>References</h3>

<p>Soetaert K and Petzoldt T (2010). Inverse modelling, sensitivity and monte carlo analysis in R using package FME. Journal of Statistical Software, 33(3), pp. 1-28.
</p>
<p>Reichert P and Kfinsch HR (2001). Practical identifiability analysis of large environmental simulation models. Water Resources Research, 37(4), pp.1015-1030.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><code><a href="FME.html#topic+sensRange">sensRange</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## IASA model

## Parameters and intial conditions.
data(dogs)
dogs_iasa &lt;- GetDataIASA(dogs,
                         destination.label = "Pinhais",
                         total.estimate = 50444)

# Solve for point estimates.
solve_iasa_pt &lt;- SolveIASA(pars = dogs_iasa$pars,
                          init = dogs_iasa$init,
                          time = 0:15,
                          alpha.owned = TRUE,
                          method = 'rk4')

## Set ranges 10 % greater and lesser than the
## point estimates.
rg_solve_iasa &lt;- SetRanges(pars = dogs_iasa$pars)

## Calculate golobal sensitivity of combined parameters.
## To calculate global sensitivity to each parameter, set
## all as FALSE.
glob_all_solve_iasa &lt;- CalculateGlobalSens(
  model.out = solve_iasa_pt,
  ranges = rg_solve_iasa, 
  sensv = "n2", all = TRUE)

</code></pre>

<hr>
<h2 id='CalculateLocalSens'>Local sensitivity analysis</h2><span id='topic+CalculateLocalSens'></span>

<h3>Description</h3>

<p>Wraper for <code><a href="FME.html#topic+sensFun">sensFun</a></code> function, which estimates local effect of all model parameters on population size, applying the so-called sensitivity functions. The set of parameters used in any of the following functions can be assessed: <code><a href="#topic+SolveIASA">SolveIASA</a></code>, <code><a href="#topic+SolveSI">SolveSI</a></code> or <code><a href="#topic+SolveTC">SolveTC</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateLocalSens(model.out = NULL, sensv = "n")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CalculateLocalSens_+3A_model.out">model.out</code></td>
<td>
<p>output from one of the previous functions or a <code><a href="base.html#topic+list">list</a></code> with equivalent structure.</p>
</td></tr>
<tr><td><code id="CalculateLocalSens_+3A_sensv">sensv</code></td>
<td>
<p>string with the name of the output variables for which sensitivity are to be estimated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For further arguments of <code><a href="FME.html#topic+sensFun">sensFun</a></code>, defaults are used. See the help page of this function for details. Methods for class &quot;sensFun&quot; can be used.
</p>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> of class <code><a href="FME.html#topic+sensFun">sensFun</a></code> containing the sensitivity functions. There is one row for each sensitivity variable at each independent time. The first column <code>x</code>, contains the time value; the second column <code>var</code>, the name of the observed variable; and remaining columns have the sensitivity parameters.
</p>


<h3>References</h3>

<p>Soetaert K and Petzoldt T (2010). Inverse modelling, sensitivity and monte carlo analysis in R using package FME. Journal of Statistical Software, 33(3), pp. 1-28.
</p>
<p>Reichert P and Kfinsch HR (2001). Practical identifiability analysis of large environmental simulation models. Water Resources Research, 37(4), pp.1015-1030.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><code><a href="FME.html#topic+sensRange">sensRange</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## IASA model

## Parameters and intial conditions.
data(dogs)
dogs_iasa &lt;- GetDataIASA(dogs,
                         destination.label = "Pinhais",
                         total.estimate = 50444)

# Solve for point estimates.
solve_iasa_pt &lt;- SolveIASA(pars = dogs_iasa$pars,
                          init = dogs_iasa$init,
                          time = 0:15,
                          alpha.owned = TRUE,
                          method = 'rk4')

## Calculate local sensitivities to all parameters.
local_solve_iasa2 &lt;- CalculateLocalSens(
  model.out = solve_iasa_pt, sensv = "n2")
local_solve_iasa1 &lt;- CalculateLocalSens(
  model.out = solve_iasa_pt, sensv = "n1")

</code></pre>

<hr>
<h2 id='CalculatePopChange'>Population change.</h2><span id='topic+CalculatePopChange'></span>

<h3>Description</h3>

<p>Calculate the change in population size between two times. When only one time is specified, the population size at that time is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculatePopChange(model.out = NULL, variable = NULL, t1 = NULL,
  t2 = NULL, ratio = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CalculatePopChange_+3A_model.out">model.out</code></td>
<td>
<p>output from one of the following functions or a <code><a href="base.html#topic+list">list</a></code> with equivalent structure: <code><a href="#topic+SolveIASA">SolveIASA</a></code>, <code><a href="#topic+SolveSI">SolveSI</a></code>,  <code><a href="#topic+SolveTC">SolveTC</a></code> or <code><a href="#topic+CalculateGlobalSens">CalculateGlobalSens</a></code>. When the last function is used, its <code>all</code> argument must be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="CalculatePopChange_+3A_variable">variable</code></td>
<td>
<p>string with the name of the the output variable for which the change are to be calculated (see the variable argument for <code><a href="#topic+PlotModels">PlotModels</a></code>.</p>
</td></tr>
<tr><td><code id="CalculatePopChange_+3A_t1">t1</code></td>
<td>
<p>value specifying the first time.</p>
</td></tr>
<tr><td><code id="CalculatePopChange_+3A_t2">t2</code></td>
<td>
<p>value specifying the second time.</p>
</td></tr>
<tr><td><code id="CalculatePopChange_+3A_ratio">ratio</code></td>
<td>
<p>logical. When <code>TRUE</code>, the calculated change is based on poulation size at t2 divided by population size at t1. When <code>FALSE</code>, the calculated change is based on poulation size at t2 minus population size at t1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value representing the ratio (if <code>ratio</code> is <code>TRUE</code>) or the difference (if <code>ratio</code> is <code>FALSE</code>) between population size at time t2 and t1. If only one time is specified, the value is the population size at that time.
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## IASA model

## Parameters and intial conditions.
data(dogs)
dogs_iasa &lt;- GetDataIASA(dogs,
                         destination.label = "Pinhais",
                         total.estimate = 50444)

# Solve for point estimates.
solve_iasa_pt &lt;- SolveIASA(pars = dogs_iasa$pars,
                          init = dogs_iasa$init,
                          time = 0:15,
                          alpha.owned = TRUE,
                          method = 'rk4')

# Calculate the population change (ratio) between times 0 and 15.
CalculatePopChange(solve_iasa_pt, variable = 'N1', t2 = 15, t1 = 0)

# Calculate the population change (difference) between times 0 and 15.
CalculatePopChange(solve_iasa_pt, variable = 'N1', t2 = 15,
                   t1 = 0, ratio = FALSE)

# Calculate the population zises at time 15.
CalculatePopChange(solve_iasa_pt, variable = 'N1', t2 = 15)

</code></pre>

<hr>
<h2 id='CalculateSimpleSampleSize'>Simple random sample size</h2><span id='topic+CalculateSimpleSampleSize'></span>

<h3>Description</h3>

<p>Calculates sample size to estimate a total from a simple sampling design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateSimpleSampleSize(x = NULL, N = NULL, conf.level = 0.95,
  error = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CalculateSimpleSampleSize_+3A_x">x</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> with variable collected in a pilot and to be estimated. If x is a scalar, it is used as the relative variance of the variable to be estimated (<code>((N - 1) / N * sd(x)^2) / mean(x)^2</code>).</p>
</td></tr>
<tr><td><code id="CalculateSimpleSampleSize_+3A_n">N</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> indicating the number of sampling units in the population.</p>
</td></tr>
<tr><td><code id="CalculateSimpleSampleSize_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level required. It must be <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1 inclusive.</p>
</td></tr>
<tr><td><code id="CalculateSimpleSampleSize_+3A_error">error</code></td>
<td>
<p>the maximum relative difference between the estimate and the unknown population value. It must be <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1 inclusive.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric sample size rounded up to nearest integer.
</p>


<h3>References</h3>

<p>Levy P and Lemeshow S (2008). Sampling of populations: methods and applications, Fourth edition. John Wiley and Sons, Inc.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using a pilot sample from a population with 10000 sampling units.
pilot &lt;- rpois(50, 0.8)
CalculateSimpleSampleSize(x = pilot, N = 10000,
                          conf.level = 0.95, error = 0.1)

# Using expected mean and standard deviation for a population
# with 10000 sampling units.
mean_x &lt;- mean(pilot)
sd_x &lt;- sd(pilot)
N &lt;- 10000
V &lt;- ((N - 1) / N * sd_x^2) / mean_x^2
CalculateSimpleSampleSize(x = V, N = 10000, conf.level = 0.95, error = 0.1)

</code></pre>

<hr>
<h2 id='CalculateStratifiedSampleSize'>Stratified random sample size</h2><span id='topic+CalculateStratifiedSampleSize'></span>

<h3>Description</h3>

<p>Calculates sample size to estimate a total from a stratified random sampling design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalculateStratifiedSampleSize(strata = NULL, x = NULL,
  conf.level = 0.95, error = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CalculateStratifiedSampleSize_+3A_strata">strata</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code>, <code><a href="base.html#topic+matrix">matrix</a></code> or <code><a href="base.html#topic+data.frame">data.frame</a></code>. If vector, named elements represent the size of the strata. If matrix or data.frame, first column represent the size of each strata, second column represent the expected mean in each strata and third column represent the expected variance in each strata. Each row is a strata and must be named.</p>
</td></tr>
<tr><td><code id="CalculateStratifiedSampleSize_+3A_x">x</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> representing a pilot sample. First column has the variable to be estimated and second column has the strata membership of each observation. Needed when <code>strata</code> is a vector.</p>
</td></tr>
<tr><td><code id="CalculateStratifiedSampleSize_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level required. It must be <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1 inclusive.</p>
</td></tr>
<tr><td><code id="CalculateStratifiedSampleSize_+3A_error">error</code></td>
<td>
<p>the maximum relative difference between the estimate and the unknown population value. It must be <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1 inclusive.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric sample size rounded up to nearest integer.
</p>


<h3>References</h3>

<p>Levy P and Lemeshow S (2008). Sampling of populations: methods and applications, Fourth edition. John Wiley and Sons, Inc.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using a pilot sample from a population with 10000 sampling units.
strata &lt;- rep(c("rural", "urban"), c(100, 9900))
pilot &lt;- data.frame(c(rpois(5, 1.3), rpois(45, 0.8)),
                           rep(c("rural", "urban"), c(5, 45)))
CalculateStratifiedSampleSize(strata, pilot)
      
# Using expected mean and variance for a population with
# 10000 sampling units.
str_n &lt;- c(rural = 100, urban = 9900)
str_mean &lt;- c(rural = 1.4, urban = 0.98)
str_var &lt;- c(rural = 1.48, urban = 1.02)
CalculateStratifiedSampleSize(cbind(str_n, str_mean, str_var))

</code></pre>

<hr>
<h2 id='cats'>Cat's sample data from Pinhais, Brazil, 2017</h2><span id='topic+cats'></span>

<h3>Description</h3>

<p>Data described and analyzed by Baquero et al., 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cats
</code></pre>


<h3>Format</h3>

<p>Data frame with 195 observations (cats) and 22 variables:
</p>

<dl>
<dt>interview_id</dt><dd><p>Interview's ID.</p>
</dd>
<dt>census_tract_id</dt><dd><p>Census tract's ID.</p>
</dd>
<dt>name</dt><dd><p>Cat's name.</p>
</dd>
<dt>species</dt><dd><p>Animal's species</p>
</dd>
<dt>sex</dt><dd><p>Cat's sex.</p>
</dd>
<dt>age</dt><dd><p>Cat's age. An age equal to 0 means that the cat had less than 1 year.</p>
</dd>
<dt>sterilized</dt><dd><p>Cat's reproductive status.</p>
</dd>
<dt>sterilized_ly</dt><dd><p>For sterilized cats, indicates if the cat was sterilized during the last year.</p>
</dd>
<dt>go_out_on_the_street_alone</dt><dd><p>Indicates if the cat had access to the street without supervision (free-roaming).</p>
</dd>
<dt>acquisition</dt><dd><p>Acquisition type.</p>
</dd>
<dt>acquired_ly</dt><dd><p>Indicates if the cat was acquired during the last year.</p>
</dd>
<dt>acquired_sterilized</dt><dd><p>Indicates if the cat was sterilized when acquired.</p>
</dd>
<dt>acquisition_city</dt><dd><p>City of acquisition.</p>
</dd>
<dt>acquisition_state</dt><dd><p>State of acquisition.</p>
</dd>
<dt>lost_animals</dt><dd><p>Indicates if the cat was acquired during the year following the lost of another car</p>
</dd>
<dt>births_ly</dt><dd><p>Litter size if the bitch had the litter during the last year.</p>
</dd>
<dt>name3</dt><dd><p>Dog's name (cats not present anymore in the household).</p>
</dd>
<dt>species3</dt><dd><p>Animal's species (animals not present anymore in the household).</p>
</dd>
<dt>sex3</dt><dd><p>Dog's sex (cats not present anymore in the household).</p>
</dd>
<dt>age3</dt><dd><p>Dog's age (cats not present anymore in the household). An age equal to 0 means that the dog had less than 1 year.</p>
</dd>
<dt>sterilized3</dt><dd><p>Dog's reproductive status (cats not present anymore in the household).</p>
</dd>
<dt>fate3</dt><dd><p>Dog's fate.</p>
</dd>
</dl>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>

<hr>
<h2 id='cluster_sample'>Household data from a two-stage cluster sample</h2><span id='topic+cluster_sample'></span>

<h3>Description</h3>

<p>Data described and analyzed by Baquero et al., 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_sample
</code></pre>


<h3>Format</h3>

<p>Data frame with 1230 observations (households) and 14 variables:
</p>

<dl>
<dt>interview_id</dt><dd><p>Interview's ID.</p>
</dd>
<dt>census_tract_id</dt><dd><p>Census tract's ID.</p>
</dd>
<dt>interviewer</dt><dd><p>Interviewer's name.</p>
</dd>
<dt>date</dt><dd><p>Interview's date.</p>
</dd>
<dt>address</dt><dd><p>Household's address.</p>
</dd>
<dt>interview</dt><dd><p>Interview status.</p>
</dd>
<dt>interviewee</dt><dd><p>Interviewee's name.</p>
</dd>
<dt>number_of_dogs</dt><dd><p>Number of dogs.</p>
</dd>
<dt>number_of_cats</dt><dd><p>Number of cats.</p>
</dd>
<dt>number_of_persons</dt><dd><p>Number of persons.</p>
</dd>
<dt>cell_phone</dt><dd><p>Interviewee's cell phone.</p>
</dd>
<dt>e_mail</dt><dd><p>Interviewee's e-mail.</p>
</dd>
<dt>reasons_for_not_sterilize</dt><dd><p>Interviewee's reported reason for not sterilizing her/his animal.</p>
</dd>
<dt>reasons_for_not_sterilize_others</dt><dd><p>Other reasons for not sterilizing her/his animal.</p>
</dd>
</dl>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>

<hr>
<h2 id='DesignSurvey'>Survey design</h2><span id='topic+DesignSurvey'></span>

<h3>Description</h3>

<p>A wraper for <code><a href="survey.html#topic+svydesign">svydesign</a></code> function from the survey package, to define one of the following survey designs: two-stage cluster, simple (systematic) or stratified. In the first case, weights are calculated considering a sample with probability proportional to size and with replacement for the first stage and a simple random sampling for the second stage. Finite population correction is specified as the population size for each level of sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DesignSurvey(sample = NULL, psu.ssu = NULL, psu.col = NULL,
  ssu.col = NULL, cal.col = NULL, N = NULL, strata = NULL,
  cal.N = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DesignSurvey_+3A_sample">sample</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with sample observations. for two-stage cluster designs, one of the columns must contain unique identifiers for PSU and another column must contain unique identifiers for Secondary Sampling Units (SSU).</p>
</td></tr>
<tr><td><code id="DesignSurvey_+3A_psu.ssu">psu.ssu</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with all Primary Sampling Units (PSU). First column contains PSU unique identifiers. Second column contains <code><a href="base.html#topic+numeric">numeric</a></code> PSU sizes. It is used only for two-stage cluster designs.</p>
</td></tr>
<tr><td><code id="DesignSurvey_+3A_psu.col">psu.col</code></td>
<td>
<p>the column of <code>sample</code> containing the psu identifiers (for two-stage cluster designs). It is used only for two-stage cluster designs.</p>
</td></tr>
<tr><td><code id="DesignSurvey_+3A_ssu.col">ssu.col</code></td>
<td>
<p>the column of <code>sample</code> containing the ssu identifiers (for two-stage cluster designs). It is used only for two-stage cluster designs.</p>
</td></tr>
<tr><td><code id="DesignSurvey_+3A_cal.col">cal.col</code></td>
<td>
<p>the column of <code>sample</code> with the variable to calibrate estimates. It must be used together with <code>cal.N</code>.</p>
</td></tr>
<tr><td><code id="DesignSurvey_+3A_n">N</code></td>
<td>
<p>for simple designs, a <code><a href="base.html#topic+numeric">numeric</a></code> value representing the total of sampling units in the population. for a stratified design, it is a column of <code>sample</code> indicating, for each observation, the total of sampling units in its respective strata. <code>N</code> is ignored in two-stage cluster designs.</p>
</td></tr>
<tr><td><code id="DesignSurvey_+3A_strata">strata</code></td>
<td>
<p>for stratified designs, a column of <code>sample</code> indicating the strata memebership of each observation.</p>
</td></tr>
<tr><td><code id="DesignSurvey_+3A_cal.n">cal.N</code></td>
<td>
<p>population total for the variable to calibrate the estimates. It must be used togheter with <code>cal.col</code>.</p>
</td></tr>
<tr><td><code id="DesignSurvey_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="survey.html#topic+svydesign">svydesign</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For two-stage cluster designs, a PSU appearing in both <code>psu.ssu</code> and in <code>sample</code> must have the same identifier. SSU identifiers must be unique but can appear more than once if there is more than one observation per SSU. <code>sample</code> argument must have just the varibles to be estimated plus the variables required to define the design (two-stage cluster or stratified). <code>cal.col</code> and <code>cal.N</code> are needed only if estimates will be calibrated. The calibration is based on a population total.
</p>


<h3>Value</h3>

<p>An object of class survey.design.
</p>


<h3>References</h3>

<p>Lumley, T. (2011). Complex surveys: A guide to analysis using R (Vol. 565). Wiley.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("cluster_sample")
data("psu_ssu")

## Calibrated two-stage cluster design
design &lt;- DesignSurvey(na.omit(cluster_sample),
                       psu.ssu = psu_ssu,
                       psu.col = "census_tract_id",
                       ssu.col = "interview_id",
                       cal.col = "number_of_persons",
                       cal.N = 129445)

## Simple design
# If data in cluster_sample were from a simple design:
design &lt;- DesignSurvey(na.omit(cluster_sample), 
                       N = sum(psu_ssu$hh),
                       cal.N = 129445)

## Stratified design
# Simulate strata and assume that the data in cluster_design came
# from a stratified design
cluster_sample$strat &lt;- sample(c("urban", "rural"),
                               nrow(cluster_sample),
                               prob = c(.95, .05),
                               replace = TRUE)
cluster_sample$strat_size &lt;- round(sum(psu_ssu$hh) * .95)
cluster_sample$strat_size[cluster_sample$strat == "rural"] &lt;-
  round(sum(psu_ssu$hh) * .05)
design &lt;- DesignSurvey(cluster_sample,
                       N = "strat_size",
                       strata = "strat",
                       cal.N = 129445)

</code></pre>

<hr>
<h2 id='dogs'>Dog's sample data from Pinhais, Brazil, 2017</h2><span id='topic+dogs'></span>

<h3>Description</h3>

<p>Data described and analyzed by Baquero et al., 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dogs
</code></pre>


<h3>Format</h3>

<p>Data frame with 1252 observations (dogs) and 22 variables:
</p>

<dl>
<dt>interview_id</dt><dd><p>Interview's ID.</p>
</dd>
<dt>census_tract_id</dt><dd><p>Census tract's ID.</p>
</dd>
<dt>name</dt><dd><p>Dog's name.</p>
</dd>
<dt>species</dt><dd><p>Animal's species</p>
</dd>
<dt>sex</dt><dd><p>Dog's sex.</p>
</dd>
<dt>age</dt><dd><p>Dog's age. An age equal to 0 means that the dog had less than 1 year.</p>
</dd>
<dt>sterilized</dt><dd><p>Dog's reproductive status.</p>
</dd>
<dt>sterilized_ly</dt><dd><p>For sterilized dogs, indicates if the dog was sterilized during the last year.</p>
</dd>
<dt>go_out_on_the_street_alone</dt><dd><p>Indicates if the dog had access to the street without supervision (free-roaming).</p>
</dd>
<dt>acquisition</dt><dd><p>Acquisition type.</p>
</dd>
<dt>acquired_ly</dt><dd><p>Indicates if the dog was acquired during the last year.</p>
</dd>
<dt>acquired_sterilized</dt><dd><p>Indicates if the dog was sterilized when acquired.</p>
</dd>
<dt>acquisition_city</dt><dd><p>City of acquisition.</p>
</dd>
<dt>acquisition_state</dt><dd><p>State of acquisition.</p>
</dd>
<dt>lost_animals</dt><dd><p>Indicates if the dog was acquired during the year following the lost of another dog</p>
</dd>
<dt>births_ly</dt><dd><p>Litter size if the bitch had the litter during the last year.</p>
</dd>
<dt>name3</dt><dd><p>Dog's name (dogs not present anymore in the household).</p>
</dd>
<dt>species3</dt><dd><p>Animal's species (animals not present anymore in the household).</p>
</dd>
<dt>sex3</dt><dd><p>Dog's sex (dogs not present anymore in the household).</p>
</dd>
<dt>age3</dt><dd><p>Dog's age (dogs not present anymore in the household). An age equal to 0 means that the dog had less than 1 year.</p>
</dd>
<dt>sterilized3</dt><dd><p>Dog's reproductive status (dogs not present anymore in the household).</p>
</dd>
<dt>fate3</dt><dd><p>Dog's fate.</p>
</dd>
</dl>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>

<hr>
<h2 id='FreqTab'>Frequency table of categorical variables</h2><span id='topic+FreqTab'></span>

<h3>Description</h3>

<p>Calculates and sort the count and relative frequency of categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FreqTab(data = NULL, variables = NULL, rnd = 3, decreasing = TRUE,
  use.na = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FreqTab_+3A_data">data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with categorical variables.</p>
</td></tr>
<tr><td><code id="FreqTab_+3A_variables">variables</code></td>
<td>
<p>name or position of categorical variables. If more than one variable is provided, contingency frequencies are calculated.</p>
</td></tr>
<tr><td><code id="FreqTab_+3A_rnd">rnd</code></td>
<td>
<p>the number of decimal places (round) or significant digits (signif) to be used.</p>
</td></tr>
<tr><td><code id="FreqTab_+3A_decreasing">decreasing</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code>. If <code>TRUE</code>, frequencies will be sorted in decreasing order, if <code>FALSE</code>, they will be sorted in increasing order.</p>
</td></tr>
<tr><td><code id="FreqTab_+3A_use.na">use.na</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code>. If <code>FALSE</code> (default), missing values are omitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
<a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><a href="base.html#topic+table">table</a> and <a href="base.html#topic+sort">sort</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cluster_sample)
FreqTab(cluster_sample$number_of_dogs)

data(dogs)
FreqTab(dogs, c("species", "sex"))

</code></pre>

<hr>
<h2 id='GetDataIASA'>Get initial values and paramters for IASA model from survey data</h2><span id='topic+GetDataIASA'></span>

<h3>Description</h3>

<p>Calculates initial values and paramters for the IASA model, from survey data collectected with the questionnaire described by Bquero at al., 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetDataIASA(data = NULL, sex.col = "sex", female.label = "female",
  male.label = "male", sterilized.col = "sterilized",
  sterilized.label = "yes", sterilized.ly.col = "sterilized_ly",
  sterilized.ly.label = "yes", births.ly.col = "births_ly",
  species3.col = "species3", species.label = "dog",
  sex3.col = "sex2", fate.col = "fate", died.label = "died",
  lost.label = "lost", acquisition.col = "acquisition",
  acquired.ly.col = "acquired_ly", acquired.ly.label = "yes",
  adopted.label = "adopted", bought.label = "bought",
  acquisition.source.col = "acquisition_city",
  acquired.sterilized.col = "acquired_sterilized",
  destination.label = NULL, total.estimate = NULL, k1.scale = 5,
  h1 = 1, N2.scale = 0.05, f2.scale = 0.9, fs2.scale = 0.1,
  m2.scale = 0.95, ms2.scale = 0.05, b2.scale = 1.5,
  df2.scale = 1.2, dm2.scale = 1.2, sf2.scale = 0.3,
  sm2.scale = 0.3, k2.scale = 2, h2 = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetDataIASA_+3A_data">data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with survey data.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_sex.col">sex.col</code></td>
<td>
<p>name or index of the column with the *sex* variable.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_female.label">female.label</code></td>
<td>
<p>string with the *female* category in <code>sex.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_male.label">male.label</code></td>
<td>
<p>string with the *male* category in <code>sex.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_sterilized.col">sterilized.col</code></td>
<td>
<p>name or index of the column with the *sterilized* variable.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_sterilized.label">sterilized.label</code></td>
<td>
<p>string with the *sterilized* category (ex. yes) in <code>sterilized.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_sterilized.ly.col">sterilized.ly.col</code></td>
<td>
<p>name or index of the column with *sterilized last year* variable.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_sterilized.ly.label">sterilized.ly.label</code></td>
<td>
<p>string with the *sterilized during the last year* category (ex. yes) in <code>sterilized.ly.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_births.ly.col">births.ly.col</code></td>
<td>
<p>name or index of the column with the *births during the last year* variable.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_species3.col">species3.col</code></td>
<td>
<p>name or index of the column with the *species* variable form the third questionnaire's section (animals that left the household).</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_species.label">species.label</code></td>
<td>
<p>string with the *species* category of interest (ex. dog) in <code>species3.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_sex3.col">sex3.col</code></td>
<td>
<p>name or index of the column with the *sex* variable form the third questionnaire's section (animals that left the household).</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_fate.col">fate.col</code></td>
<td>
<p>name or index of the column with the *fate* variable.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_died.label">died.label</code></td>
<td>
<p>string with the *died* category in <code>fate.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_lost.label">lost.label</code></td>
<td>
<p>string with the *lost* category in <code>fate.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_acquisition.col">acquisition.col</code></td>
<td>
<p>name or index of the column with the *acquisition* variable.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_acquired.ly.col">acquired.ly.col</code></td>
<td>
<p>name or index of the column with the *acquisition during the last year* variable.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_acquired.ly.label">acquired.ly.label</code></td>
<td>
<p>string with the *acquisition during the last year* category (ex. yes) in <code>acquisition.ly.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_adopted.label">adopted.label</code></td>
<td>
<p>string with the *adopted* category in <code>acquistion.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_bought.label">bought.label</code></td>
<td>
<p>string with the *bought* category in <code>acquisition.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_acquisition.source.col">acquisition.source.col</code></td>
<td>
<p>name or index of the column with the *source* variable (ex. city).</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_acquired.sterilized.col">acquired.sterilized.col</code></td>
<td>
<p>name or index of the column with the *sterilized when acquired* variable.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_destination.label">destination.label</code></td>
<td>
<p>string with the *destination* category (ex. city) in <code>acquisition.source.col</code>.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_total.estimate">total.estimate</code></td>
<td>
<p>number representing the estimated total population size.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_k1.scale">k1.scale</code></td>
<td>
<p>scale to define the carrying capacity of the owned population as k1 = k.scale * total.estimate.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_h1">h1</code></td>
<td>
<p>number representing the mean harem size in the owned population.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_n2.scale">N2.scale</code></td>
<td>
<p>scale to define the unowned population size as N2 = N2.sclae * total.estimate.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_f2.scale">f2.scale</code></td>
<td>
<p>scale to define the female unowned population size as f2 = f2.scale * f1.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_fs2.scale">fs2.scale</code></td>
<td>
<p>scale to define the sterilized female unowned population size as fs2 = fs2.scale * fs1.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_m2.scale">m2.scale</code></td>
<td>
<p>scale to define the sterimlized male unowned population as m2 = m2.scale * m1.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_ms2.scale">ms2.scale</code></td>
<td>
<p>scale to define the sterilized male unowned population size as ms2 = ms2.scale * ms1.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_b2.scale">b2.scale</code></td>
<td>
<p>scale to define the birth function of the unowned population as b2 = f2 \* b1 / f1 \* b2.scale.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_df2.scale">df2.scale</code></td>
<td>
<p>scale to define the death rate of the female unowned population as df2 = df2.scale * df1.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_dm2.scale">dm2.scale</code></td>
<td>
<p>scale to define the death rate of the male unowned population as dm2 = dm2.scale * dm1.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_sf2.scale">sf2.scale</code></td>
<td>
<p>scale to define the sterilized female unowned population size as sf2 = sf2 = sf2.scale * sf1.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_sm2.scale">sm2.scale</code></td>
<td>
<p>scale to define the sterilized male unowned population size as sm2 = sm2.scale * sm1.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_k2.scale">k2.scale</code></td>
<td>
<p>scale to define the carrying capacity of the unowned population as k2 = k2.scale * N2.</p>
</td></tr>
<tr><td><code id="GetDataIASA_+3A_h2">h2</code></td>
<td>
<p>number representing the mean harem size in the unowned population.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If column and category names in <code>data</code> match arguments' defaults, the function call is simplified as in the example below.
</p>


<h3>Value</h3>

<p><code><a href="base.html#topic+list">list</a></code> with two vectors: <code>init</code> (initial values) and <code>pars</code> (parameters).
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dogs)
GetDataIASA(dogs, destination.label = "Pinhais", total.estimate = 50444)

</code></pre>

<hr>
<h2 id='MapkmlPSU'>Creates *.kml files of a subset of polygons from a polygon shapefile</h2><span id='topic+MapkmlPSU'></span>

<h3>Description</h3>

<p>Subset the polygons specified in <code>psu</code> and creates *.kml files of theses polygons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MapkmlPSU(shape = NULL, psu = NULL, id = NULL,
  path = "./psu_maps/")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MapkmlPSU_+3A_shape">shape</code></td>
<td>
<p>string with the path of a polygon shapefile or an object of <code><a href="base.html#topic+class">class</a></code> <a href="sf.html#topic+sf">sf</a> (see examples).</p>
</td></tr>
<tr><td><code id="MapkmlPSU_+3A_psu">psu</code></td>
<td>
<p>polygons to subset.</p>
</td></tr>
<tr><td><code id="MapkmlPSU_+3A_id">id</code></td>
<td>
<p>column of the *.dbf file with the values to be matched against.</p>
</td></tr>
<tr><td><code id="MapkmlPSU_+3A_path">path</code></td>
<td>
<p><code><a href="base.html#topic+class">class</a></code> character with the path in which maps will be saved. If the path already exists, it will be overwrited.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there are *.kml files in the working directory, the new created files will overwrite it in case of name matching.
</p>
<p><code>shape</code> must receive a shapefile with appropriate coordinate reference system, otherwise, <code>MapkmlPSU</code> report an error.
</p>


<h3>Value</h3>

<p>*.kml files of the subsetted polygons.
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("psu_ssu")

# Take a sample of 5 PSU.
(selected_psu &lt;- SamplePPS(psu.ssu = psu_ssu, psu = 5))
 
## Define shape from shapefile.
shp_path &lt;- system.file("extdata/35SEE250GC_SIR.shp", package="capm")
# The code above used a shapefile avaliable in the
# capm package.
# You might want to write a code like:
# shp.path  &lt;- 'path_to_the_folder_with_the_shapefile'
 
# Create *kml files of 10 polygons.
## Not run: 
MapkmlPSU(shape = shp_path,
         psu = selected_psu[, "selected_psu"],
         id = "CD_GEOCODI")

## Define the shape argument as an object x of class sf.
x &lt;- read_sf(shp_path)
MapkmlPSU(shape = x, psu = selected_psu[, "selected_psu"], id = "CD_GEOCODI")

## End(Not run)

</code></pre>

<hr>
<h2 id='PlotGlobalSens'>Plot results of GlobalSens function</h2><span id='topic+PlotGlobalSens'></span>

<h3>Description</h3>

<p>Plot results of of <code><a href="#topic+CalculateGlobalSens">CalculateGlobalSens</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotGlobalSens(global.out = NULL, x.label = "Time",
  y.label = "Population", legend.label = "Sensitivity range",
  qt.label = "Qt 0.05 - 0.95", sd.label = "mean +- sd   ",
  inner.color = "DarkRed", outer.color = "LightBlue")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotGlobalSens_+3A_global.out">global.out</code></td>
<td>
<p>output from <code><a href="#topic+CalculateGlobalSens">CalculateGlobalSens</a></code> function.</p>
</td></tr>
<tr><td><code id="PlotGlobalSens_+3A_x.label">x.label</code></td>
<td>
<p>string with the name for the x axis.</p>
</td></tr>
<tr><td><code id="PlotGlobalSens_+3A_y.label">y.label</code></td>
<td>
<p>string with the name for the y axis.</p>
</td></tr>
<tr><td><code id="PlotGlobalSens_+3A_legend.label">legend.label</code></td>
<td>
<p>string with the name for the legend.</p>
</td></tr>
<tr><td><code id="PlotGlobalSens_+3A_qt.label">qt.label</code></td>
<td>
<p>string with the name for the envelope calculated using the quantiles 0.05 and 0.95.</p>
</td></tr>
<tr><td><code id="PlotGlobalSens_+3A_sd.label">sd.label</code></td>
<td>
<p>string with the name for the envelope calculated using the mean +- standard deviation ranges.</p>
</td></tr>
<tr><td><code id="PlotGlobalSens_+3A_inner.color">inner.color</code></td>
<td>
<p>any valid specification of a color for the inner envelope.</p>
</td></tr>
<tr><td><code id="PlotGlobalSens_+3A_outer.color">outer.color</code></td>
<td>
<p>any valid specification of a color for the outer envelope.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Font size of saved plots is usually different to the font size seen in graphic browsers. Before changing font sizes, see the final result in saved (or preview) plots.
</p>
<p>Other details of the plot can be modifyed using appropriate functions from <code>ggplot2</code> package.
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><a href="deSolve.html#topic+plot.deSolve">plot.deSolve</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## IASA model

## Parameters and intial conditions.
data(dogs)
dogs_iasa &lt;- GetDataIASA(dogs,
                         destination.label = "Pinhais",
                         total.estimate = 50444)

# Solve for point estimates.
solve_iasa_pt &lt;- SolveIASA(pars = dogs_iasa$pars,
                          init = dogs_iasa$init,
                          time = 0:15,
                          alpha.owned = TRUE,
                          method = 'rk4')

## Set ranges 10 % greater and lesser than the
## point estimates.
rg_solve_iasa &lt;- SetRanges(pars = dogs_iasa$pars)

## Calculate golobal sensitivity of combined parameters.
## To calculate global sensitivity to each parameter, set
## all as FALSE.
glob_all_solve_iasa &lt;- CalculateGlobalSens(
  model.out = solve_iasa_pt,
  ranges = rg_solve_iasa, 
  sensv = "n2", all = TRUE)
PlotGlobalSens(glob_all_solve_iasa)

</code></pre>

<hr>
<h2 id='PlotHHxSpecies'>Distribution of households according to the number of inhabitants one or more species</h2><span id='topic+PlotHHxSpecies'></span>

<h3>Description</h3>

<p>Dodged bar plot of the distribution of households according to the number of inhabitants of one or more species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotHHxSpecies(dat = NULL, species = NULL, proportion = TRUE,
  x.label = "Individuals per household",
  y.label = "Proportion of households", legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotHHxSpecies_+3A_dat">dat</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with households as observation unit and columns with the number of individuals of the species of interest.</p>
</td></tr>
<tr><td><code id="PlotHHxSpecies_+3A_species">species</code></td>
<td>
<p>names or positions of columns with species data.</p>
</td></tr>
<tr><td><code id="PlotHHxSpecies_+3A_proportion">proportion</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code>. If <code>TRUE</code> (default), the y axis will represent proportions, if <code>FALSE</code>, it would represent raw counts.</p>
</td></tr>
<tr><td><code id="PlotHHxSpecies_+3A_x.label">x.label</code></td>
<td>
<p>title for x axis.</p>
</td></tr>
<tr><td><code id="PlotHHxSpecies_+3A_y.label">y.label</code></td>
<td>
<p>title for y axis.</p>
</td></tr>
<tr><td><code id="PlotHHxSpecies_+3A_legend">legend</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code>. If <code>TRUE</code> (default), the legend will be showed, if <code>FALSE</code>, it will be removed.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>


<h3>See Also</h3>

<p><a href="ggplot2.html#topic+geom_bar">geom_bar</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cluster_sample)
PlotHHxSpecies(cluster_sample, c("number_of_persons",
                                 "number_of_dogs",
                                 "number_of_cats"))

</code></pre>

<hr>
<h2 id='PlotImmigrationFlow'>Plot immigration flows</h2><span id='topic+PlotImmigrationFlow'></span>

<h3>Description</h3>

<p>Plot rimmigration flows from many sources to one destination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotImmigrationFlow(data = NULL, source = NULL, destination = NULL,
  n.sources = 5, agg.sources.prefix = "Other ",
  agg.sources.suffix = " sources", cls = NULL, start.degree = 0,
  sources.label.dist = 0.15, sources.label.size = 0.75,
  ticks.label.size = 0.7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotImmigrationFlow_+3A_data">data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with sources and destination.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_source">source</code></td>
<td>
<p><code>data</code>'s column name or index with places' names. Sources' names and destination's name must be in this column.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_destination">destination</code></td>
<td>
<p>destination's name.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_n.sources">n.sources</code></td>
<td>
<p>number of sources to plot. If smaller than the total number of sources <code>source</code>, the less frequent sources are aggregated.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_agg.sources.prefix">agg.sources.prefix</code></td>
<td>
<p>string. If n.sources is smaller than the total number of sources, <code>agg.sources.prefix</code> is used to label the aggregated sources.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_agg.sources.suffix">agg.sources.suffix</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code>. If n.sources is smaller than the total number of sources, <code>agg.sources.prefix</code> is used to label the aggregated sources.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_cls">cls</code></td>
<td>
<p>Optional <code><a href="base.html#topic+character">character</a></code> <code><a href="base.html#topic+vector">vector</a></code> with <code>n.sources</code> + 1 colors.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_start.degree">start.degree</code></td>
<td>
<p>The starting degree from which the circle begins to draw. It is passed to the <code>start.degree</code> argumento of <code>circlize::circos.par</code> function.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_sources.label.dist">sources.label.dist</code></td>
<td>
<p>Data point on y-axis to separate the sources' labels from the circle. It is passed to the <code>y</code> argument of <code>circlize::circos.text</code> function.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_sources.label.size">sources.label.size</code></td>
<td>
<p>Font size for sources' labels. It is passed to the <code>cex</code> argument of <code>circlize::circos.text</code> function.</p>
</td></tr>
<tr><td><code id="PlotImmigrationFlow_+3A_ticks.label.size">ticks.label.size</code></td>
<td>
<p>Font size for sources' labels. It is passed to the <code>labels.cex</code> argument of <code>circlize::circos.axis</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The numbers arround the circle indicate the number of animals.
</p>


<h3>References</h3>

<p>Gu, Z. (2014) circlize implements and enhances circular visualization in R. Bioinformatics. DOI: 10.1093/bioinformatics/btu393
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dogs)
cls &lt;- c("blue3", "orange", "skyblue", "darkgreen", "yellow3", "black")
PlotImmigrationFlow(dogs, "acquisition_city", "Pinhais",
                    cls = cls, agg.sources.suffix = " cities")

</code></pre>

<hr>
<h2 id='PlotLocalSens'>Plot results of CalculateLocalSens function</h2><span id='topic+PlotLocalSens'></span>

<h3>Description</h3>

<p>Plot results of the <code><a href="#topic+CalculateLocalSens">CalculateLocalSens</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotLocalSens(local.out = NULL, x.sens = "Time",
  y.sens = "Sensitivity", y.ind = c("L1", "L2", "Mean", "Min", "Max"),
  bar.colors = "DarkRed", label.size = 10, x.axis.angle = 90,
  type = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotLocalSens_+3A_local.out">local.out</code></td>
<td>
<p>output from <code><a href="#topic+CalculateLocalSens">CalculateLocalSens</a></code> function.</p>
</td></tr>
<tr><td><code id="PlotLocalSens_+3A_x.sens">x.sens</code></td>
<td>
<p>string with the name for the x axis.</p>
</td></tr>
<tr><td><code id="PlotLocalSens_+3A_y.sens">y.sens</code></td>
<td>
<p>string with the name for the y axis of the sensitivity functions (when <code>type = 6</code>).</p>
</td></tr>
<tr><td><code id="PlotLocalSens_+3A_y.ind">y.ind</code></td>
<td>
<p>string with the name for the y axis of the parameter importance indices.</p>
</td></tr>
<tr><td><code id="PlotLocalSens_+3A_bar.colors">bar.colors</code></td>
<td>
<p>any valid specification of a color.</p>
</td></tr>
<tr><td><code id="PlotLocalSens_+3A_label.size">label.size</code></td>
<td>
<p>a number to specify the size of axes labels and text.</p>
</td></tr>
<tr><td><code id="PlotLocalSens_+3A_x.axis.angle">x.axis.angle</code></td>
<td>
<p>a number with angle of rotation for x axis text. Passed to <code>angle</code> argument of <code><a href="ggplot2.html#topic+element_text">element_text</a></code>.</p>
</td></tr>
<tr><td><code id="PlotLocalSens_+3A_type">type</code></td>
<td>
<p>a number to define the type of graphical output. <code>1</code>: importance index L1; <code>2</code>:  importance index L2; <code>3</code>: mean of sensitivity functions; <code>5</code>: minimum of sensitivity functions; and <code>5</code>: maximum of sensitivity functions; <code>6</code>: sensitivity functions and all importance indices are ploted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Font size of saved plots is usually different to the font size seen in graphic browsers. Before changing font sizes, see the final result in saved (or preview) plots.
</p>


<h3>References</h3>

<p>Chang W (2012). R Graphics Cookbook. O'Reilly Media, Inc.
</p>
<p>Soetaert K, Cash J and Mazzia F (2012). Solving differential equations in R. Springer.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><a href="FME.html#topic+plot.sensFun">plot.sensFun</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## IASA model#' 
## Parameters and intial conditions.
data(dogs)
dogs_iasa &lt;- GetDataIASA(dogs,
                        destination.label = "Pinhais",
                        total.estimate = 50444)
# Solve for point estimates.
solve_iasa_pt &lt;- SolveIASA(pars = dogs_iasa$pars,
                         init = dogs_iasa$init,
                         time = 0:15,
                         alpha.owned = TRUE,
                         method = 'rk4')
## Calculate local sensitivities to all parameters.
local_solve_iasa2 &lt;- CalculateLocalSens(
 model.out = solve_iasa_pt, sensv = "n2")
## Plot local sensitivities
PlotLocalSens(local_solve_iasa2)

</code></pre>

<hr>
<h2 id='PlotModels'>Plot results of capm model functions</h2><span id='topic+PlotModels'></span>

<h3>Description</h3>

<p>Plot results of one of the following functions: <code><a href="#topic+SolveIASA">SolveIASA</a></code>, <code><a href="#topic+SolveSI">SolveSI</a></code> or <code><a href="#topic+SolveTC">SolveTC</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotModels(model.out = NULL, variable = NULL, col = "red",
  col1 = c("cadetblue1", "yellow", "red"), col2 = c("blue",
  "darkgreen", "darkred"), x.label = "Years", y.label = NULL,
  legend.label = NULL, pop = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotModels_+3A_model.out">model.out</code></td>
<td>
<p>output of one of the function previously mentioned.</p>
</td></tr>
<tr><td><code id="PlotModels_+3A_variable">variable</code></td>
<td>
<p>string to specify the variable to be ploted. 
</p>
<p>For <code><a href="#topic+SolveSI">SolveSI</a></code> function: 
</p>
<p>&quot;n&quot; (population size).
</p>
<p>&quot;q&quot; (proportion of sterilized animals). 
</p>
<p>For <code><a href="#topic+SolveIASA">SolveIASA</a></code> function using only point estimates:
</p>
<p>&quot;f1&quot; (owned intact females).
</p>
<p>&quot;fs1&quot; (owned sterilized females).
</p>
<p>&quot;m1&quot; (owned intact males).
</p>
<p>&quot;ms1&quot; (owned sterilized males).
</p>
<p>&quot;f2&quot; (unowned intact females).
</p>
<p>&quot;fs2&quot; (unowned sterilized females).
</p>
<p>&quot;m2&quot; (unowned intact males).
</p>
<p>&quot;ms2&quot; (unowned sterilized males). 
</p>
<p>&quot;n1&quot; (owned intact animals).
</p>
<p>&quot;ns1&quot; (owned sterilized animals).
</p>
<p>&quot;n2&quot; (unowned intact animals).
</p>
<p>&quot;ns2&quot; (unowned sterilized animals).
</p>
<p>&quot;N1&quot; (owned animals).
</p>
<p>&quot;N2&quot; (unowned animals).
</p>
<p>&quot;N&quot; (total population).
</p>
<p>For <code><a href="#topic+SolveIASA">SolveIASA</a></code> function using *.range arguments:
</p>
<p>&quot;f&quot; (intact females).
</p>
<p>&quot;fs&quot; (sterilized females).
</p>
<p>&quot;m&quot; (intact males).
</p>
<p>&quot;ms&quot; (sterilized males).
</p>
<p>&quot;n&quot; (intact animals).
</p>
<p>&quot;ns&quot; (sterilized animals).
</p>
<p>&quot;N&quot; (Total population stratified by reproductive status).
</p>
<p>For <code><a href="#topic+SolveTC">SolveTC</a></code> function: 
</p>
<p>&quot;n&quot; (fertile animals).
</p>
<p>&quot;g&quot; (sterilized animals).
</p>
<p>&quot;u&quot; (cumulative of sterilized animals)</p>
</td></tr>
<tr><td><code id="PlotModels_+3A_col">col</code></td>
<td>
<p>string indicating the color of ploted line, when <code>s.range</code> is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="PlotModels_+3A_col1">col1</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> <code><a href="base.html#topic+vector">vector</a></code> indicating the color of lowest (highest) population sizes (proportion of sterilized animals), when <code>s.range</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="PlotModels_+3A_col2">col2</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> <code><a href="base.html#topic+vector">vector</a></code> indicating the color of highest (lowest) population sizes (proportion of sterilized animals), when <code>s.range</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="PlotModels_+3A_x.label">x.label</code></td>
<td>
<p>string with the name for x axis.</p>
</td></tr>
<tr><td><code id="PlotModels_+3A_y.label">y.label</code></td>
<td>
<p>string with the name for y axis.</p>
</td></tr>
<tr><td><code id="PlotModels_+3A_legend.label">legend.label</code></td>
<td>
<p>string with the name of the legend, for plots of <code><a href="#topic+SolveIASA">SolveIASA</a></code> output.</p>
</td></tr>
<tr><td><code id="PlotModels_+3A_pop">pop</code></td>
<td>
<p>value indicating the output of <code><a href="#topic+SolveIASA">SolveIASA</a></code> to be ploted. When <code>NULL</code> (default), plots for owned and unowned populations under scenarios created by immigartion rate are created. If <code>1</code>, the plots of owned population for the minimum immigartion rate are ploted. When <code>2</code>, the plots of unowned population for the minimum immigartion rate are ploted. If <code>3</code>, the plots of owned population for the maximum immigartion rate are ploted. When <code>4</code>, the plots of owned population for the maximum immigartion rate are ploted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Font size of saved plots is usually different to the font size seen in graphic browsers. Before changing font sizes, see the final result in saved (or preview) plots.
</p>
<p>Other details of the plot can be modifyed using appropriate functions from <code>ggplot2</code> package.
</p>


<h3>References</h3>

<p>Chang W (2012). R Graphics Cookbook. O'Reilly Media, Inc.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><a href="deSolve.html#topic+plot.deSolve">plot.deSolve</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## IASA model

## Parameters and intial conditions.
data(dogs)
dogs_iasa &lt;- GetDataIASA(dogs,
                         destination.label = "Pinhais",
                         total.estimate = 50444)

# Solve for point estimates.
solve_iasa_pt &lt;- SolveIASA(pars = dogs_iasa$pars,
                           init = dogs_iasa$init,
                           time = 0:15,
                           alpha.owned = TRUE,
                           method = 'rk4')
solve_iasa_rg &lt;- SolveIASA(pars = dogs_iasa$pars,
                           init = dogs_iasa$init, 
                           time = 0:10,
                           alpha.owned = TRUE,
                           s.range = seq(0, .4, l = 15), 
                           a.range = c(0, .2), 
                           alpha.range = c(0, .05),
                           v.range = c(0, .1),
                           method = 'rk4')

## Plot unowned population sizes using point estimates
## Not run: 
PlotModels(solve_iasa_pt, variable = "ns2")

## Plot all scenarios and change the label for the scenarios.
## Not run
PlotModels(solve_iasa_rg, variable = "ns")

## End(Not run)

</code></pre>

<hr>
<h2 id='PlotPopPyramid'>Population PlotPopPyramid</h2><span id='topic+PlotPopPyramid'></span>

<h3>Description</h3>

<p>Displays two opposed horizontal barplots (pyramid).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotPopPyramid(dat = NULL, age.col = NULL, sex.col = NULL,
  str.col = NULL, str.tip = NULL, x.label = "Count",
  stage.label = "Years", legend.label = "Sterilized",
  inner.color = "LightBlue", outer.color = "DarkRed",
  label.size = 13)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotPopPyramid_+3A_dat">dat</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_age.col">age.col</code></td>
<td>
<p><code>dat</code> column that has a <code><a href="base.html#topic+numeric">numeric</a></code> <code><a href="base.html#topic+vector">vector</a></code> representing ages or stage categories.</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_sex.col">sex.col</code></td>
<td>
<p><code>dat</code> column that has two unique values representing the sex of individuals (see Details).</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_str.col">str.col</code></td>
<td>
<p><code>dat</code> column that has two unique values representing the reproductive status of individuals (see Details).</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_str.tip">str.tip</code></td>
<td>
<p>string with the category of <code>str.col</code> to place at tip of the bars.</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_x.label">x.label</code></td>
<td>
<p>string to be used as a label for the x axis. If undefined, <code>x.label</code> is equal to &quot;Total&quot; (see Details).</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_stage.label">stage.label</code></td>
<td>
<p>a string to be used as a label for the ages or stage categories. If undefined, <code>stage.label</code> is equal to &quot;Years&quot; (see Details).</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_legend.label">legend.label</code></td>
<td>
<p>a string to be used as a label for the legend. If undefined, <code>legend.label</code> is equal to &quot;Sterilized&quot;.</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_inner.color">inner.color</code></td>
<td>
<p>any valid specification of a color. When <code>str.col</code> is not <code>NULL</code>, <code>inner.color</code> is the color of inner bars.</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_outer.color">outer.color</code></td>
<td>
<p>any valid way specification of a color. When <code>str.col</code> is <code>NULL</code>, <code>outer.color</code> is the default color. When <code>str.col</code> is not <code>NULL</code>, <code>outer.color</code> is the outer color of bars.</p>
</td></tr>
<tr><td><code id="PlotPopPyramid_+3A_label.size">label.size</code></td>
<td>
<p>string to define the font size for labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PlotPopPyramid</code> is mainly intended for companion animals population pyramids, although it can display other types of opposed bar charts.
</p>
<p>The bars to the left of the x axis correspond to <code>sort(unique(dat[, sex.col]))[1]</code>. If <code>str.col</code> is not <code>NULL</code>, bars will be stacked, with <code>sort(unique(dat[, str.col]))[1]</code> as their base.
</p>
<p>On the top of the plot, it is displayed the total number of observations of each <code>dat[, sex.col]</code> unique value. This unique values are used as <code><a href="base.html#topic+labels">labels</a></code>.
</p>
<p>The legend <code><a href="base.html#topic+labels">labels</a></code> are equal to the <code>dat[, str.col]</code> unique values.
</p>
<p>Font size of saved plots is usually different to the font size seen in graphic browsers. Before changing font sizes, see the final result in saved (or preview) plots.
</p>
<p>Other details of the plot can be modifyed using appropriate functions from <code>ggplot2</code> package (see examples).
</p>


<h3>Value</h3>

<p>Two opposed horizontal barplots.
</p>


<h3>Note</h3>

<p>In companion animals population surveys, some age categories might be empty. One difference between <code>PlotPopPyramid</code> and <code>pryramid.plot</code> is that the first does not drop empty age categories.
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dogs)

PlotPopPyramid(dogs,
               age.col = "age",
               sex.col = "sex",
               str.col = "sterilized")

PlotPopPyramid(dogs,
               age.col = "age",
               sex.col = "sex")

## Merge age categories
pp_age &lt;- cut(c(dogs$age, dogs$age3),
               breaks = c(0, 1, 3, 5, 7, 9, 11, 13, 15,
                          max(c(dogs$age, dogs$age3), na.rm = TRUE)),
               labels = c("&lt;1", "1-3", "3-5", "5-7", "7-9",
                          "9-11", "11-13", "13-15", "&gt;15"),
               include.lowest = TRUE)
pp_sex &lt;- c(dogs$sex, dogs$sex3)
pp_ster &lt;- c(dogs$sterilized, dogs$sterilized3)
pp &lt;- data.frame(age = pp_age, sex = pp_sex, sterilized = pp_ster)

PlotPopPyramid(pp,
              age.col = "age",
              sex.col = "sex",
              str.col = "sterilized")

PlotPopPyramid(pp,
              age.col = "age",
              sex.col = "sex")

</code></pre>

<hr>
<h2 id='psu_ssu'>Census tracts of Pinhais, Brazil.</h2><span id='topic+psu_ssu'></span>

<h3>Description</h3>

<p>Census tracts of Pinhais, Brazil, according to the census of 2010. Data described and analyzed by Baquero et al., 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psu_ssu
</code></pre>


<h3>Format</h3>

<p>A data frame with 655 observations and 5 variables:
</p>

<dl>
<dt>census_tract_id</dt><dd><p>Census track's ID.</p>
</dd>
<dt>hh</dt><dd><p>Number of households.</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="http://www.ibge.gov.br/">http://www.ibge.gov.br/</a>
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>

<hr>
<h2 id='SamplePPS'>Sampling with probability proportional to size and with replacement</h2><span id='topic+SamplePPS'></span>

<h3>Description</h3>

<p>Select Primary Sampling Units (PSU) with probability proportional to size and with replacement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SamplePPS(psu.ssu = NULL, psu = NULL, write = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SamplePPS_+3A_psu.ssu">psu.ssu</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with all PSU. First column contains PSU unique identifiers. Second column contains <code><a href="base.html#topic+numeric">numeric</a></code> PSU sizes.</p>
</td></tr>
<tr><td><code id="SamplePPS_+3A_psu">psu</code></td>
<td>
<p>the number of PSU to be selected.</p>
</td></tr>
<tr><td><code id="SamplePPS_+3A_write">write</code></td>
<td>
<p>logical. If <code>TRUE</code>, a *.csv file containing the PSU and their Secondary Sampling Units (SSU) is writed in the current working directory.</p>
</td></tr>
<tr><td><code id="SamplePPS_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="utils.html#topic+write.table">write.table</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+data.frame">data.frame</a></code>. First column contains the selected PSU identifiers, coerced by <code><a href="base.html#topic+as.character">as.character</a></code>, to avoid scientific notation in case the identifiers be large numbers of <code><a href="base.html#topic+class">class</a></code> <code><a href="base.html#topic+numeric">numeric</a></code>. Second column contain PSU sizes, a variable needed for second stage sampling with <code><a href="#topic+SampleSystematic">SampleSystematic</a></code>.
</p>


<h3>References</h3>

<p>Levy P and Lemeshow S (2008). Sampling of populations: methods and applications, Fourth edition. John Wiley and Sons, Inc.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SampleSystematic">SampleSystematic</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(psu_ssu)

# Take a sample of 10 PSU.
SamplePPS(psu.ssu = psu_ssu, psu = 10, write = FALSE)

</code></pre>

<hr>
<h2 id='SampleSystematic'>Simple and stratified systematic sampling</h2><span id='topic+SampleSystematic'></span>

<h3>Description</h3>

<p>Select sampling units using simple or stratified systematic samplin. In the context of two-stage cluster sampling, select Secondary Sampling Units (SSU) in one or more Primary Sampling Units (PSU), using systematic sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SampleSystematic(psu.ssu = NULL, su = NULL, N = NULL,
  write = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SampleSystematic_+3A_psu.ssu">psu.ssu</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with all PSU. First column contains PSU unique identifiers. Second column contains <code><a href="base.html#topic+numeric">numeric</a></code> PSU sizes. It is used only for the second stage of a two-stage cluster design (see details).</p>
</td></tr>
<tr><td><code id="SampleSystematic_+3A_su">su</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> indicating the number of sampling units to be selected. If <code>su</code> has more than one element, stratified sampling is applied and <code>psu.ssu</code> is ignored (see details).</p>
</td></tr>
<tr><td><code id="SampleSystematic_+3A_n">N</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> indicating the number of sampling units in the population. It is intended for simple or stratified sampling designs and when used, <code>psu.ssu</code> is ignored (see details).</p>
</td></tr>
<tr><td><code id="SampleSystematic_+3A_write">write</code></td>
<td>
<p>logical. If <code>TRUE</code>, a *.csv file containing the PSU and their SSU is writed in the current working directory.</p>
</td></tr>
<tr><td><code id="SampleSystematic_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="utils.html#topic+write.table">write.table</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>N</code> is defined, <code>psu.ssu</code> is ignored. If <code>N</code> has one element, <code>su</code> must too and the result is a simple systematic selection.  If <code>N</code> has more than one element, <code>su</code> must have the same number of elements and each oredered pair represent an strata. Thus, when N has more than one element, the result is a stratified sampling with systematic selection within each strata (see examples).
</p>


<h3>Value</h3>

<p>A <code>matrix</code>. For the second stage in a two-stage cluster sampling, the names of columns are the identifiers of selected psu, coerced by <code><a href="base.html#topic+as.character">as.character</a></code> to avoid scientific notation in case the identifiers be of <code><a href="base.html#topic+class">class</a></code> <code><a href="base.html#topic+numeric">numeric</a></code>. The rows correspond to the selected SSU within each PSU. For simple systematic sampling, the rows correspond to the selected sampling units. For stratified sampling, each column represent an strata and the rows correspond to the selected sampling units in each strata.
</p>


<h3>References</h3>

<p>Levy P and Lemeshow S (2008). Sampling of populations: methods and applications, Fourth edition. John Wiley and Sons, Inc.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SamplePPS">SamplePPS</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(psu_ssu)

## Two-stage cluster sampling
selected_psu &lt;- SamplePPS(psu.ssu = psu_ssu, psu = 10)

# Take a systematic sampling of 5 SSU within each selected PSU.
SampleSystematic(selected_psu, 5, write = FALSE)

## Simple systematic sampling
SampleSystematic(su = 5, N = 100)

## Stratified systematic sampling
SampleSystematic(su = c("urban" = 50, "rural" = 10),
                 N = c("urban" = 4000, "rural" = 150))
</code></pre>

<hr>
<h2 id='SetRanges'>Parameter ranges for global sensitivity analysis</h2><span id='topic+SetRanges'></span>

<h3>Description</h3>

<p>Define the minimum and maximum values for parameters whose global sensitivities are to be assessed with <code><a href="#topic+CalculateGlobalSens">CalculateGlobalSens</a></code> or <code><a href="FME.html#topic+sensRange">sensRange</a></code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SetRanges(pars = NULL, range = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SetRanges_+3A_pars">pars</code></td>
<td>
<p>the same <code>pars</code> vector used in one of the following functions: <code><a href="#topic+SolveSI">SolveSI</a></code> or <code><a href="#topic+SolveIASA">SolveIASA</a></code>.</p>
</td></tr>
<tr><td><code id="SetRanges_+3A_range">range</code></td>
<td>
<p>scale factor to define the minimum and maximum for each parameter. The default is 0.1, which set the minimum and maximum as 10 percent lesser and greater than the <code>pars</code> values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+data.frame">data.frame</a></code> with the complete set of parameter ranges.
</p>


<h3>References</h3>

<p>Soetaert K and Petzoldt T (2010). Inverse modelling, sensitivity and monte carlo analysis in R using package FME. Journal of Statistical Software, 33(3), pp. 1-28.
</p>
<p>Reichert P and Kfinsch HR (2001). Practical identifiability analysis of large environmental simulation models. Water Resources Research, 37(4), pp. 1015-1030.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><code><a href="FME.html#topic+sensRange">sensRange</a></code> and <code><a href="#topic+SolveSI">SolveSI</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## IASA model

## Parameters and intial conditions.
data(dogs)
dogs_iasa &lt;- GetDataIASA(dogs,
                         destination.label = "Pinhais",
                         total.estimate = 50444)

## Set ranges 10 % greater and lesser than the
## point estimates.
rg_solve_iasa &lt;- SetRanges(pars = dogs_iasa$pars)

</code></pre>

<hr>
<h2 id='SolveIASA'>Modelling of immigration, abandonment, sterilization and adoption of companion animals</h2><span id='topic+SolveIASA'></span>

<h3>Description</h3>

<p>System of ordinary differential equations to simulate the effect of immigration of owned dogs, abandonment, sterilization of owned and unowned dogs and adoption, on population dynamics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SolveIASA(pars = NULL, init = NULL, time = NULL,
  alpha.owned = TRUE, immigration.reference = "N1", s.range = NULL,
  a.range = NULL, alpha.range = NULL, v.range = NULL, s.fm = TRUE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SolveIASA_+3A_pars">pars</code></td>
<td>
<p>a named <code><a href="base.html#topic+vector">vector</a></code> of length 21, with point estimates of model parameters (see details).</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_init">init</code></td>
<td>
<p>a named <code><a href="base.html#topic+vector">vector</a></code> of length 8, with point estimates of model parameters (see details).</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_time">time</code></td>
<td>
<p>time sequence for which output is wanted; the first value of times must be the initial time.</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_alpha.owned">alpha.owned</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code>. If <code>TRUE</code> (default), adoption rate is relative to the owned population (proportion of the owned population). If <code>FALSE</code>, it is relative to the unowned population.</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_immigration.reference">immigration.reference</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> indicating the value of reference to calculate the immigration rate. If <code>"N1"</code> (default), the total of immigrants is the product of the owned population size times the immigration rate (N1 \* v). If <code>k1</code>, it is the product of the owned carrying capacity times the immigration rate (k1 \* v).</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_s.range">s.range</code></td>
<td>
<p>optional sequence (between 0 and 1) of the sterilization rates to be simulated.</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_a.range">a.range</code></td>
<td>
<p>optional <code><a href="base.html#topic+vector">vector</a></code> of length 2, with range (ie, confidence interval) of abandonment rates to be assessed. If given, the rates evaluated are those specified by the argument plus the point estimate given in <code>pars</code>.</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_alpha.range">alpha.range</code></td>
<td>
<p>optional <code><a href="base.html#topic+vector">vector</a></code> of length 2, with range (ie, confidence interval) of adoption rates to be assessed. If given, the rates evaluated are those specified by the argument plus the point estimate given in <code>pars</code>.</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_v.range">v.range</code></td>
<td>
<p>optional <code><a href="base.html#topic+vector">vector</a></code> of length 2, with range of values of immigration rates to be assessed.</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_s.fm">s.fm</code></td>
<td>
<p>logical. If <code>TRUE</code>, s.range is used for females and males and if <code>FALSE</code>, it is used for only females (for males, the point estimate given in <code>pars</code> is used.)</p>
</td></tr>
<tr><td><code id="SolveIASA_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="deSolve.html#topic+ode">ode</a> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implemented model is described by Baquero, et. al., 2016 and the function is a wrapper around the defaults of <a href="deSolve.html#topic+ode">ode</a> function, whose help page must be consulted for details.
</p>
<p>The <code>pars</code> argument must contain named values, using the following conventions: <code>1</code>: owned animals; <code>2</code>: unowned animals; <code>f</code>: females; <code>m</code>: males. Then:
</p>
<p><code>b1</code> and <code>b2</code>: number of births.
</p>
<p><code>df1</code>, <code>dm1</code>, <code>df2</code> and <code>dm2</code>: death rate.
</p>
<p><code>sf1</code>, <code>sm1</code>, <code>sf2</code> and <code>sm2</code>: sterilization rate.
</p>
<p><code>k1</code> and <code>k2</code>: carrying capacity.
</p>
<p><code>h1</code> and <code>h2</code>: mean harem size.
</p>
<p><code>a</code>: abandonment rate.
</p>
<p><code>alpha</code>: adoption rate.
</p>
<p><code>v</code>: immigration rate.
</p>
<p><code>z</code>: proportion of sterilized immigrants.
</p>
<p>The <code>init</code> argument must contain named values for the inital number of animals, using the following conventions: <code>1</code>: owned animals; <code>2</code>: unowned animals; <code>f</code>: females; <code>m</code>: males; and <code>s</code>: sterilized. Then, the names are:
</p>
<p><code>f1</code>, <code>fs1</code>, <code>m1</code>, <code>ms1</code>, <code>f2</code>, <code>fs2</code>, <code>m2</code> and <code>ms2</code>.
</p>
<p>If any range is specified (e.g <code>s.range</code>), the remaining ranges must be specified too (<code>a.range</code>, <code>alpha.range</code> and <code>v.range</code>).
The function is a wrapper around the defaults of <a href="deSolve.html#topic+ode">ode</a> function, whose help page must be consulted for details. An exception is the method argument, which here has &quot;rk4&quot; as a default.
</p>


<h3>Value</h3>

<p><code><a href="base.html#topic+list">list</a></code>. The first element, <code>name</code>, is a string with the name of the function, the second element, <code>model</code>, is the model function. The third, fourth and fifth elements are vectors (<code>pars</code>, <code>init</code>, <code>time</code>, respectively) containing the <code>pars</code>, <code>init</code> and <code>time</code> arguments of the function. The sixth element <code>results</code> is a <code><a href="base.html#topic+data.frame">data.frame</a></code> with up to as many rows as elements in time. The first column contain the time and subsequent columns contain the size of specific subpopulations, named according to conventions above. The <code>group</code> column differentiate between owned and unowned. When *.range arguments are given, the last fourth columsn specify their instances.
</p>


<h3>Note</h3>

<p>Logistic growth models are not intended for scenarios in which
population size is greater than carrying capacity and growth rate is negative.
</p>


<h3>References</h3>

<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
Baquero, O. S., Akamine, L. A., Amaku, M., &amp; Ferreira, F. (2016). Defining priorities for dog population management through mathematical modeling. Preventive veterinary medicine, 123, 121-127.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><a href="deSolve.html#topic+ode">ode</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Parameters and intial conditions.
data(dogs)
dogs_iasa &lt;- GetDataIASA(dogs,
                         destination.label = "Pinhais",
                         total.estimate = 50444)

# Solve for point estimates.
solve_iasa_pt &lt;- SolveIASA(pars = dogs_iasa$pars,
                           init = dogs_iasa$init,
                           time = 0:15,
                           alpha.owned = TRUE,
                           method = 'rk4')
solve_iasa_rg &lt;- SolveIASA(pars = dogs_iasa$pars,
                           init = dogs_iasa$init, 
                           time = 0:10,
                           alpha.owned = TRUE,
                           s.range = seq(0, .4, l = 15), 
                           a.range = c(0, .2), 
                           alpha.range = c(0, .05),
                           v.range = c(0, .1),
                           method = 'rk4')

</code></pre>

<hr>
<h2 id='SolveSI'>Modelling of sterilization and immigration of comapnion animals.</h2><span id='topic+SolveSI'></span>

<h3>Description</h3>

<p>System of ordinary differential equations to simulate the effect of sterilization and immigration on population dynamics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SolveSI(pars = NULL, init = NULL, time = NULL, dd = "b", im = 0,
  s.range = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SolveSI_+3A_pars">pars</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of length 4. The values are point estimates of birth rate, death rate, carrying capacity and sterilization rate. The names of this values must be &quot;b&quot;, &quot;d&quot;, &quot;k&quot; and &quot;s&quot;, respectively.</p>
</td></tr>
<tr><td><code id="SolveSI_+3A_init">init</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of length 2. The values are initial population size and initial proportion of sterilized animals. The names of this values must be &quot;n&quot; and &quot;q&quot;, respectively.</p>
</td></tr>
<tr><td><code id="SolveSI_+3A_time">time</code></td>
<td>
<p>time sequence for which output is wanted; the first value of times must be the initial time.</p>
</td></tr>
<tr><td><code id="SolveSI_+3A_dd">dd</code></td>
<td>
<p>string equal to <code>b</code>, <code>d</code> or <code>bd</code> to define if density-dependece act on birth rate, death rarte or both, respectively.</p>
</td></tr>
<tr><td><code id="SolveSI_+3A_im">im</code></td>
<td>
<p>a number representing the total of immigrants per time unit.</p>
</td></tr>
<tr><td><code id="SolveSI_+3A_s.range">s.range</code></td>
<td>
<p>optional sequence (between 0 and 1) of the sterilization rates to be simulated.</p>
</td></tr>
<tr><td><code id="SolveSI_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="deSolve.html#topic+ode">ode</a> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implemented model is described by Amaku, et. al., 2009 and the function is a wrapper around the defaults of <a href="deSolve.html#topic+ode">ode</a> function, whose help page must be consulted for details.
</p>


<h3>Value</h3>

<p><code><a href="base.html#topic+list">list</a></code>. The first element, <code>name</code>, is a string with the name of the function, the second element, <code>model</code>, is the model function. The third, fourth and fifth elements are vectors (<code>pars</code>, <code>init</code>, <code>time</code>, respectively) containing the <code>pars</code>, <code>init</code> and <code>time</code> arguments of the function. The sisxth element <code>results</code> is a <code><a href="base.html#topic+data.frame">data.frame</a></code> with up to as many rows as elements in time. First column contains the time, second column the population size and third column the proportion of sterilized animals. If <code>s.range</code> is specified, fourth column contains its specific instances.
</p>


<h3>Note</h3>

<p>Logistic growth models are not intended for scenarios in which population size is greater than carrying capacity and growth rate is negative.
</p>


<h3>References</h3>

<p>Amaku M, Dias R and Ferreira F (2009). Dinamica populacional canina: potenciais efeitos de campanhas de esterilizacao. Revista Panamericana de Salud Publica, 25(4), pp. 300-304.
</p>
<p>Soetaert K, Cash J and Mazzia F (2012). Solving differential equations in R. Springer.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>See Also</h3>

<p><a href="deSolve.html#topic+ode">ode</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Parameters and initial conditions.
pars_solve_si = c(b = 0.245, d = 0.101, 
                 k = 98050, s = 0.048)
init_solve_si = c(n = 89137, q = 0.198)

# Solve for a specific sterilization rate.
solve_si_pt = SolveSI(pars = pars_solve_si, 
                     init = init_solve_si, 
                     time = 0:15, dd = "b",
                     im = 100, method = "rk4")

# Solve for a range of sterilization rates.
solve_si_rg = SolveSI(pars = pars_solve_si,
                     init = init_solve_si,
                     time = 0:15, dd = "b", im = 100, 
                     s.range = seq(0, .4, l = 50),
                     method = "rk4")

</code></pre>

<hr>
<h2 id='SolveTC'>Modelling of reversible contraception for companion animals</h2><span id='topic+SolveTC'></span>

<h3>Description</h3>

<p>System of ordinary differential equations to simulate the effect of reversible contraception in a population at equilibrium, where deaths are compensated by births and net immigration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SolveTC(pars = NULL, init = NULL, time = NULL, f.range = NULL,
  s.range = NULL, z.range = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SolveTC_+3A_pars">pars</code></td>
<td>
<p>a named <code><a href="base.html#topic+vector">vector</a></code> of length 5. The values are point estimates of the death rate (d), the fertility recovery rate (f), the sterilization rate (s), the proportion of infertile immigrants (z) and the proportion of the death rate compensated by immigration (r). Abreviations in parentheses indicate the names that must be given to the values.</p>
</td></tr>
<tr><td><code id="SolveTC_+3A_init">init</code></td>
<td>
<p>a named <code><a href="base.html#topic+vector">vector</a></code> of length 2, with the total number of fertile (n) and infertile (g) animals.</p>
</td></tr>
<tr><td><code id="SolveTC_+3A_time">time</code></td>
<td>
<p>time sequence for which output is wanted; the first value of times must be the initial time.</p>
</td></tr>
<tr><td><code id="SolveTC_+3A_f.range">f.range</code></td>
<td>
<p>optional sequence (between 0 and 1) with the fertility recovery rates to be simulated.</p>
</td></tr>
<tr><td><code id="SolveTC_+3A_s.range">s.range</code></td>
<td>
<p>optional <code><a href="base.html#topic+vector">vector</a></code> of length 2, with a range of sterilization rates to be assessed. If given, the rates evaluated are those specified by the argument plus the point estimate given in <code>pars</code>.</p>
</td></tr>
<tr><td><code id="SolveTC_+3A_z.range">z.range</code></td>
<td>
<p>optional <code><a href="base.html#topic+vector">vector</a></code> of length 2, with a range of the proportion of infertile immigrants. If given, the rates evaluated are those specified by the argument plus the point estimate given in <code>pars</code>.</p>
</td></tr>
<tr><td><code id="SolveTC_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="deSolve.html#topic+ode">ode</a> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+list">list</a></code>. The first element, <code>name</code>, is a string with the name of the function, the second element, <code>model</code>, is the model function. The third, fourth and fifth elements are vectors (<code>pars</code>, <code>init</code>, <code>time</code>, respectively) containing the <code>pars</code>, <code>init</code> and <code>time</code> arguments of the function. The sisxthth element <code>results</code> is a <code><a href="base.html#topic+data.frame">data.frame</a></code> with up to as many rows as elements in time. The first fourth columns contain the time and the variables: <code>n</code>, <code>g</code> and <code>u</code>. When *.range arguments are given, additional columns contain the variables <code>f</code>, <code>s</code> and <code>z</code>.
</p>


<h3>References</h3>

<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>
<p>Baquero, O. S., Brandao, A. P. D., Amaku, M., &amp; Ferreira, F. (2016). Effectiveness of reversible contraception in dog population management. Acta Scientiae Veterinariae, 44, 01-06.
</p>


<h3>See Also</h3>

<p><a href="deSolve.html#topic+ode">ode</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Parameters and initial conditions.
pars_solvetc &lt;- c(d = 1 / 6, f = 0.5, s = 0.2, 
                   z = 0.2, r = 0.8)

init_solvetc &lt;- c(n = 950, g = 50)

# Solve for point estimates.
solve_tc_pt &lt;- SolveTC(pars = pars_solvetc, 
                      init = init_solvetc, 
                      time = 0:10, method = "rk4")

# Solve for parameter ranges.
solve_tc_rg &lt;- SolveTC(pars = pars_solvetc, 
                      init = init_solvetc, 
                      time = 0:15,
                      f.range = seq(0, 1, 0.1), 
                      s.range = c(0.05, 0.4), 
                      z.range = c(0.05, 0.4),
                      method = "rk4")

</code></pre>

<hr>
<h2 id='SummarySurvey'>Summary statistics for sample surveys</h2><span id='topic+SummarySurvey'></span>

<h3>Description</h3>

<p>Wraps functions for summary statistics from survey package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SummarySurvey(design = NULL, variables = NULL, conf.level = 0.95,
  rnd = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SummarySurvey_+3A_design">design</code></td>
<td>
<p>an output form <code><a href="#topic+DesignSurvey">DesignSurvey</a></code> function.</p>
</td></tr>
<tr><td><code id="SummarySurvey_+3A_variables">variables</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> <code><a href="base.html#topic+vector">vector</a></code> with the type of estimate for each variable contained in <code>design</code>. Possible types: total, mean, and prop (see details).</p>
</td></tr>
<tr><td><code id="SummarySurvey_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="SummarySurvey_+3A_rnd">rnd</code></td>
<td>
<p>the number of decimal places (round) or significant digits (signif) to be used. If <code>NA</code>, scientific notation is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The length of <code>variables</code> must be equal to the length of <code>names(design$variables)</code> (see examples).
</p>


<h3>Value</h3>

<p>Matrix with survey summaries. The error (column &quot;Error (
</p>


<h3>References</h3>

<p>Lumley, T. (2011). Complex surveys: A guide to analysis using R (Vol. 565). Wiley.
</p>
<p>Baquero, O. S., Marconcin, S., Rocha, A., &amp; Garcia, R. D. C. M. (2018). Companion animal demography and population management in Pinhais, Brazil. Preventive Veterinary Medicine.
</p>
<p><a href="http://oswaldosantos.github.io/capm">http://oswaldosantos.github.io/capm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("cluster_sample")
data("psu_ssu")

## Calibrated two-stage cluster design
cs &lt;- cluster_sample[ , c("interview_id",
                          "census_tract_id",
                          "number_of_persons",
                          "number_of_dogs",
                          "number_of_cats")]

design &lt;- DesignSurvey(na.omit(cs),
                       psu.ssu = psu_ssu,
                       psu.col = "census_tract_id",
                       ssu.col = "interview_id",
                       cal.col = "number_of_persons",
                       cal.N = 129445)

SummarySurvey(design, c("total", "total", "total"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
