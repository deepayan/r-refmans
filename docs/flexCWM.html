<!DOCTYPE html><html><head><title>Help for package flexCWM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {flexCWM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#flexCWM-package'><p>flexCWM - Flexible Cluster Weighted Modeling</p></a></li>
<li><a href='#cwm'><p>Fit for the CWM</p></a></li>
<li><a href='#ExCWM'><p>dataset ExCWM</p></a></li>
<li><a href='#Extractor functions'>
<p>Extractors for <code>cwm</code> class objects.</p></a></li>
<li><a href='#plot.cwm'>
<p>Plot for CWMs</p></a></li>
<li><a href='#students'><p>dataset students</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Flexible Cluster-Weighted Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.92</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Mazza A., Punzo A., Ingrassia S.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Angelo Mazza &lt;a.mazza@unict.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows maximum likelihood fitting of cluster-weighted models, a class of mixtures of regression models with random covariates. 
            Methods are described in Angelo Mazza, Antonio Punzo, Salvatore Ingrassia (2018) &lt;<a href="https://doi.org/10.18637%2Fjss.v086.i02">doi:10.18637/jss.v086.i02</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats,graphics,parallel,numDeriv,mclust,statmod,ContaminatedMixt</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-27 17:01:35 UTC; angel</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-27 22:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='flexCWM-package'>flexCWM - Flexible Cluster Weighted Modeling</h2><span id='topic+flexCWM-package'></span>

<h3>Description</h3>

<p>Allows for maximum likelihood fitting of cluster-weighted models, a class of mixtures of regression models with random covariates. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> CWM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-02-14</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GNU-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Mazza A., Punzo A., Ingrassia S.
</p>
<p>Maintainer: Mazza Angelo &lt;a.mazza@unict.it&gt;
</p>


<h3>References</h3>

<p>Mazza, A., Ingrassia, S., and Punzo, A. (2018). flexCWM: A Flexible Framework for Cluster-Weighted Models.  <em>Journal of Statistical Software</em>, <b>86</b>(2), 1-30.
</p>
<p>Ingrassia, S., Minotti, S. C., and Vittadini, G. (2012). Local Statistical Modeling via the Cluster-Weighted Approach with Elliptical Distributions. <em>Journal of Classification</em>, <b>29</b>(3), 363-401.
</p>
<p>Ingrassia, S., Minotti, S. C., and Punzo, A. (2014). Model-based clustering via linear cluster-weighted models. <em>Computational Statistics and Data Analysis</em>, <b>71</b>, 159-182.
</p>
<p>Ingrassia, S., Punzo, A., and Vittadini, G. (2015). The Generalized Linear Mixed Cluster-Weighted Model. <em>Journal of Classification</em>, <b>32</b>(forthcoming)
</p>
<p>Punzo, A. (2014). Flexible Mixture Modeling with the Polynomial Gaussian Cluster-Weighted Model. <em>Statistical Modelling</em>, <b>14</b>(3), 257-291.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cwm">cwm</a></code>
</p>

<hr>
<h2 id='cwm'>Fit for the CWM</h2><span id='topic+cwm'></span><span id='topic+student.t'></span>

<h3>Description</h3>

<p>Maximum likelihood fitting of the cluster-weighted model by the EM algorithm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cwm(formulaY = NULL, familyY = gaussian, data, Xnorm = NULL, Xbin = NULL,
  Xpois = NULL, Xmult = NULL, modelXnorm = NULL, Xbtrials = NULL, k = 1:3, 
  initialization = c("random.soft", "random.hard", "kmeans", "mclust", "manual"), 
  start.z = NULL, seed = NULL, maxR = 1, iter.max = 1000, threshold = 1.0e-04, 
  eps = 1e-100, parallel = FALSE,   pwarning = FALSE)
</code></pre>


<h3>Arguments</h3>

                      
<table>
<tr><td><code id="cwm_+3A_formulay">formulaY</code></td>
<td>
<p>an optional object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.    
</p>
</td></tr>
<tr><td><code id="cwm_+3A_familyy">familyY</code></td>
<td>
<p>a description of the error distribution and link function to be used for the conditional distribution of <code class="reqn">Y</code> in each mixture component. This can be a character string naming a <code><a href="stats.html#topic+family">family function</a></code>, a family function or the result of a call to a family function. 
The following family functions are supported:  
</p>

<ul>
<li> <p><code>binomial(link = "logit")</code> 
</p>
</li>
<li> <p><code>gaussian(link = "identity")</code> 
</p>
</li>
<li> <p><code>Gamma(link = "log")</code>
</p>
</li>
<li> <p><code>inverse.gaussian(link = "1/mu^2")</code> 
</p>
</li>
<li> <p><code>poisson(link = "log")</code>
</p>
</li>
<li> <p><code>student.t(link = "identity")</code> 
</p>
</li></ul>

<p>Default value is <code>gaussian(link = "identity")</code>.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_data">data</code></td>
<td>

<p>an optional <code><a href="base.html#topic+data.frame">data.frame</a></code>, <code><a href="base.html#topic+list">list</a></code>, or <code><a href="base.html#topic+environment">environment</a></code> with the variables needed to use <code>formulaY</code>.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_xnorm">Xnorm</code>, <code id="cwm_+3A_xbin">Xbin</code>, <code id="cwm_+3A_xpois">Xpois</code>, <code id="cwm_+3A_xmult">Xmult</code></td>
<td>

<p>an optional matrix containing variables to be used for marginalization having normal, binomial, Poisson and multinomial distributions. 
</p>
</td></tr>
<tr><td><code id="cwm_+3A_modelxnorm">modelXnorm</code></td>
<td>
<p>an optional vector of character strings indicating the parsimonious models to be fitted for variables in <code>Xnorm</code>. The default is  <code>c("E", "V")</code> for a single continuous covariate, and <code>c("EII", "VII", "EEI", "VEI", "EVI", "VVI", "EEE", "VEE", "EVE", "EEV", "VVE", "VEV", "EVV", "VVV")</code> for multivariate continuous covariates (see <code><a href="mixture.html#topic+gpcm">mixture:gpcm</a> for details</code>). 
</p>
</td></tr>
<tr><td><code id="cwm_+3A_xbtrials">Xbtrials</code></td>
<td>

<p>an optional vector containing the number of trials for each column in <code>Xbin</code>. If omitted, the maximum of each column in <code>Xbin</code> is used.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_k">k</code></td>
<td>

<p>an optional vector containing the numbers of mixture components to be tried. Default value is <code>1:3</code>.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_initialization">initialization</code></td>
<td>

<p>an optional character string. It sets the initialization strategy for the EM-algorithm. It can be:
</p>

<ul>
<li> <p><code>"random.soft"</code>
</p>
</li>
<li> <p><code>"random.hard"</code>
</p>
</li>
<li> <p><code>"kmeans"</code>
</p>
</li>
<li> <p><code>"mclust"</code> 
</p>
</li>
<li> <p><code>"manual"</code>
</p>
</li></ul>

<p>Default value is <code>"random.soft"</code>.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_start.z">start.z</code></td>
<td>

<p>matrix of soft or hard classification: it is used only if <code>initialization = "manual"</code>.Only models with the same number of mixture components as the columns of this matrix will be fit.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_seed">seed</code></td>
<td>

<p>an optional scalar. It sets the seed for the random number generator, when random initializations are used; if <code>NULL</code>, current seed is not changed. Default value is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_maxr">maxR</code></td>
<td>

<p>number of initializations to be tried. Default value is 1.
</p>
</td></tr> 
<tr><td><code id="cwm_+3A_iter.max">iter.max</code></td>
<td>

<p>an optional scalar. It sets the maximum number of iterations in the EM-algorithm. Default value is 200.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_threshold">threshold</code></td>
<td>

<p>an optional scalar. It sets the threshold for the Aitken acceleration procedure. Default value is 1.0e-04.
</p>
</td></tr>  
<tr><td><code id="cwm_+3A_eps">eps</code></td>
<td>

<p>an optional scalar. It sets the smallest value for eigenvalues of covariance matrices for <code>Xnorm</code>. Default value is 1e-100.
</p>
</td></tr>
<tr><td><code id="cwm_+3A_parallel">parallel</code></td>
<td>

<p>When <code>TRUE</code>, the package <code><a href="parallel.html#topic+parallel-package">parallel</a></code> is used for parallel computation. When several models are estimated, computational time is reduced. The number of cores to use may be set with the global option <code>cl.cores</code>; default value is detected using <code><a href="parallel.html#topic+detectCores">detectCores()</a></code>.
</p>
</td></tr> 
<tr><td><code id="cwm_+3A_pwarning">pwarning</code></td>
<td>
<p>When <code>TRUE</code>, warnings are printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>familyY = binomial</code>, the response variable must be a matrix with two columns, where the first column is the number of &quot;successes&quot; and the second column is the number of &quot;failures&quot;.  
When several models have been estimated, methods <code>summary</code> and <code>print</code> consider the best model according to the information criterion in <code>criterion</code>, among the estimated models having a number of components among those in <code>k</code> an error distribution among those in <code>familyY</code> and a parsimonious model among those in <code>modelXnorm</code>.
</p>


<h3>Value</h3>

<p>This function returns a class <code>cwm</code> object, which is a list of values related to the model selected. It contains:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>an object of class <code>call</code>.</p>
</td></tr>
<tr><td><code>formulaY</code></td>
<td>
<p>an object of class <code><a href="stats.html#topic+formula">formula</a></code> containing a symbolic description of the model fitted.</p>
</td></tr>
<tr><td><code>familyY</code></td>
<td>
<p>the distribution used for the conditional distribution of <code class="reqn">Y</code> in each mixture component.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> with the variables needed to use <code>formulaY</code>.</p>
</td></tr>
<tr><td><code>concomitant</code></td>
<td>
<p>a list containing <code>Xnorm</code>, <code>Xbin</code>, <code>Xpois</code>, <code>Xmult</code>.</p>
</td></tr>
<tr><td><code>Xbtrials</code></td>
<td>
<p>number of trials used for <code>Xbin</code>.</p>
</td></tr>
<tr><td><code>models</code></td>
<td>
<p>a list; each element is related to one of the models fitted. Each element is a list and contains:</p>
</td></tr>
</table>

<ul>
<li><p><code>posterior</code> posterior probabilities
</p>
</li>
<li><p><code>iter</code> number of iterations performed in EM algorithm
</p>
</li>
<li><p><code>k </code> number of (fitted) mixture components.
</p>
</li>
<li><p><code>size</code> estimated size of the groups.
</p>
</li>
<li><p><code>cluster </code> classification vector
</p>
</li>
<li><p><code>loglik </code> final log-likelihood value
</p>
</li>
<li><p><code>df </code> overall number of estimated parameters
</p>
</li>
<li><p><code>prior </code> weights for the mixture components
</p>
</li>
<li><p><code>IC </code> list containing values of the information criteria 
</p>
</li>
<li><p><code>converged</code> logical; <code>TRUE</code> if EM algorithm converged
</p>
</li>
<li><p><code>GLModels</code> a list;  each element is related to a mixture component and contains:
</p>

<ul>
<li><p><code>model </code> a &quot;<code><a href="stats.html#topic+glm">glm</a></code>&quot; class object.
</p>
</li>
<li><p><code>sigma </code> estimated local scale parameters of the conditional distribution of <code class="reqn">Y</code>, when <code>familyY</code> is <code>gaussian</code> or <code>student.t</code>
</p>
</li>
<li><p><code>t_df</code> estimated degrees of freedom of the t distribution, when <code>familyY</code> is <code>student.t</code>
</p>
</li>
<li><p><code>nuY</code> estimated shape parameter, when <code>familyY</code> is <code>Gamma</code>. The gamma distribution is parameterized according to McCullagh &amp; Nelder (1989, p. 30)
</p>
</li></ul>

</li>
<li><p><code>concomitant</code> a list with estimated concomitant variables parameters for each mixture component
</p>

<ul>
<li><p><code>normal.d, multinomial.d, poisson.d, binomial.d</code> marginal distribution of concomitant variables
</p>
</li>
<li><p><code>normal.mu</code> mixture component means for <code>Xnorm</code>  
</p>
</li>
<li><p><code>normal.Sigma</code> mixture component covariance matrices for <code>Xnorm</code>
</p>
</li>
<li><p><code>normal.model</code> models fitted for <code>Xnorm</code>  
</p>
</li>
<li><p><code>multinomial.probs</code> multinomial distribution probabilities for  <code>Xmult</code> 
</p>
</li>
<li><p><code>poisson.lambda</code> lambda parameters for <code>Xpois</code>  
</p>
</li>
<li><p><code>binomial.p</code> binomial probabilities for <code>Xbin</code>  
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Mazza A., Punzo A., Ingrassia S.
</p>


<h3>References</h3>

<p>Mazza, A., Ingrassia, S., and Punzo, A. (2018). flexCWM: A Flexible Framework for Cluster-Weighted Models.  <em>Journal of Statistical Software</em>, <b>86</b>(2), 1-30.
</p>
<p>Ingrassia, S., Minotti, S. C., and Vittadini, G. (2012). Local Statistical Modeling via the Cluster-Weighted Approach with Elliptical Distributions. <em>Journal of Classification</em>, <b>29</b>(3), 363-401.
</p>
<p>Ingrassia, S., Minotti, S. C., and Punzo, A. (2014). Model-based clustering via linear cluster-weighted models. <em>Computational Statistics and Data Analysis</em>, <b>71</b>, 159-182.
</p>
<p>Ingrassia, S., Punzo, A., and Vittadini, G. (2015). The Generalized Linear Mixed Cluster-Weighted Model. <em>Journal of Classification</em>, <b>32</b>(forthcoming)
</p>
<p>McCullagh, P. and Nelder, J. (1989). Generalized Linear Models. Chapman &amp; Hall, Boca Raton, 2nd edition
</p>
<p>Punzo, A. (2014). Flexible Mixture Modeling with the Polynomial Gaussian Cluster-Weighted Model. <em>Statistical Modelling</em>, <b>14</b>(3), 257-291.
</p>


<h3>See Also</h3>

                  
<p><code><a href="#topic+flexCWM-package">flexCWM-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## an exemple with artificial data
data("ExCWM")
attach(ExCWM)
str(ExCWM)

# mixtures of binomial distributions
resXbin &lt;- cwm(Xbin = Xbin, k = 1:2, initialization = "kmeans")
getParXbin(resXbin)

# Mixtures of Poisson distributions
resXpois &lt;- cwm(Xpois = Xpois, k = 1:2, initialization = "kmeans")
getParXpois(resXpois)

# parsimonious mixtures of multivariate normal distributions
resXnorm &lt;- cwm(Xnorm = cbind(Xnorm1,Xnorm2), k = 1:2, initialization = "kmeans")
getParXnorm(resXnorm)

## an exemple with real data
data("students")
attach(students)
str(students)
# CWM
fit2 &lt;- cwm(WEIGHT ~ HEIGHT + HEIGHT.F , Xnorm = cbind(HEIGHT, HEIGHT.F), 
  k = 2, initialization = "kmeans", modelXnorm = "EEE")
summary(fit2, concomitant = TRUE)
plot(fit2)


</code></pre>

<hr>
<h2 id='ExCWM'>dataset ExCWM</h2><span id='topic+ExCWM'></span>

<h3>Description</h3>

<p>An artificial data set, with 200 observations, generated by a CWM with 2 mixture components of different size, one binomial response variable, and four covariates with bivariate Gaussian, Poisson and Binomial distribution, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ExCWM)</code></pre>


<h3>Format</h3>

<p>A dataset</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexCWM-package">flexCWM-package</a></code>, <code><a href="#topic+cwm">cwm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ExCWM")
attach(ExCWM)
str(ExCWM)

# mixtures of binomial distributions
resXbin &lt;- cwm(Xbin = Xbin, k = 1:2, initialization = "kmeans")
getParXbin(resXbin)

# Mixtures of Poisson distributions
resXpois &lt;- cwm(Xpois = Xpois, k = 1:2, initialization = "kmeans")
getParXpois(resXpois)

# parsimonious mixtures of multivariate normal distributions
resXnorm &lt;- cwm(Xnorm = cbind(Xnorm1,Xnorm2), k = 1:2, initialization = "kmeans")
getParXnorm(resXnorm)


</code></pre>

<hr>
<h2 id='Extractor+20functions'>
Extractors for <code>cwm</code> class objects.
</h2><span id='topic+getBestModel'></span><span id='topic+getPosterior'></span><span id='topic+getSize'></span><span id='topic+getCluster'></span><span id='topic+getPar'></span><span id='topic+getParPrior'></span><span id='topic+getParGLM'></span><span id='topic+getParConcomitant'></span><span id='topic+getParXnorm'></span><span id='topic+getParXbin'></span><span id='topic+getParXpois'></span><span id='topic+getParXmult'></span><span id='topic+getIC'></span><span id='topic+whichBest'></span><span id='topic+summary.cwm'></span><span id='topic+print.cwm'></span><span id='topic+print.cwm.IC'></span>

<h3>Description</h3>

<p>These functions extract values from <code>cwm</code> class objects. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
getBestModel(object, criterion = "BIC", k = NULL, modelXnorm = NULL, familyY = NULL)
getPosterior(object, ...)
getSize(object, ...)
getCluster(object, ...)
getParGLM(object, ...)
getParConcomitant(object, name = NULL, ...)
getPar(object, ...)
getParPrior(object, ...)
getParXnorm(object, ...)
getParXbin(object, ...)
getParXpois(object, ...)
getParXmult(object, ...)
getIC(object,criteria)
whichBest(object, criteria = NULL, k = NULL, modelXnorm = NULL, familyY = NULL)

## S3 method for class 'cwm'
summary(object, criterion = "BIC",  concomitant = FALSE, 
  digits = getOption("digits")-2, ...)
## S3 method for class 'cwm'
print(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extractor+2B20functions_+3A_object">object</code>, <code id="Extractor+2B20functions_+3A_x">x</code></td>
<td>
<p>a class <code>cwm</code> object.
</p>
</td></tr>
<tr><td><code id="Extractor+2B20functions_+3A_criterion">criterion</code></td>
<td>
<p>a string with the information criterion to consider; supported values are:<code>"AIC", "AICc", "AICu", "AIC3", "AWE", "BIC", "CAIC", "ICL".</code> Default value is <code>"BIC"</code>. 
</p>
</td></tr>  
<tr><td><code id="Extractor+2B20functions_+3A_criteria">criteria</code></td>
<td>
<p>a vector of strings  with the names of information criteria to consider. If <code>NULL</code> all the supported infromation criteria are considered.
</p>
</td></tr>
<tr><td><code id="Extractor+2B20functions_+3A_k">k</code></td>
<td>
<p>an optional vector containing the numbers of mixture components to consider. If not specified, all the estimated models are considered.
</p>
</td></tr>
<tr><td><code id="Extractor+2B20functions_+3A_modelxnorm">modelXnorm</code></td>
<td>
<p>an optional vector of character strings indicating the parsimonious models to consider for <code>Xnorm</code>. If not specified, all the estimated models are considered. 
</p>
</td></tr>
<tr><td><code id="Extractor+2B20functions_+3A_familyy">familyY</code></td>
<td>
<p>an optional vector of character strings indicating the conditional distribution of <code class="reqn">Y</code> in each mixture component to consider. If not specified, all the estimated models are considered. 
</p>
</td></tr>
<tr><td><code id="Extractor+2B20functions_+3A_name">name</code></td>
<td>
<p>an optional vector of strings specifing the names of distribution families of concomitant variables; if <code>NULL</code>, parameters estimated for all concomitant variables are returned.</p>
</td></tr>
<tr><td><code id="Extractor+2B20functions_+3A_concomitant">concomitant</code></td>
<td>
<p>When <code>TRUE</code>, concomitant variables parameters are displayed. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="Extractor+2B20functions_+3A_digits">digits</code></td>
<td>
 
<p>integer used for number formatting.
</p>
</td></tr>
<tr><td><code id="Extractor+2B20functions_+3A_...">...</code></td>
<td>
   
<p>additional arguments to be passed to <code>getBestModel</code> (or to <code>whichBest</code> for the <code>print</code> method). 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When several models have been estimated, these functions consider the best model according to the information criterion in <code>criterion</code>, among the estimated models having a number of components among those in <code>k</code> an error distribution among those in <code>familyY</code> and a parsimonious model among those in <code>modelXnorm</code>.
<code>getIC</code> provides values for the information criteria in <code>criteria</code>.
</p>
<p>The <code>getBestModel</code> method returns a <code>cwm</code> object containing the best model only, selected as described above.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#res &lt;- cwm(Y=Y,Xcont=X,k=1:4,seed=1)
#summary(res)
#plot(res)
</code></pre>

<hr>
<h2 id='plot.cwm'>
Plot for CWMs
</h2><span id='topic+plot.cwm'></span>

<h3>Description</h3>

<p>Plot method for cwm class objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'cwm'
plot(x, regr = TRUE, ctype = c("Xnorm","Xbin","Xpois",
                 "Xmult"), which = NULL, criterion = "BIC", k = NULL,
                 modelXnorm = NULL, familyY = NULL,histargs=list(breaks=31),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cwm_+3A_x">x</code></td>
<td>

<p>An object of class <code>cwm</code>.
</p>
</td></tr>
<tr><td><code id="plot.cwm_+3A_regr">regr</code></td>
<td>
<p>boolean, allows for bivariate regression plot.</p>
</td></tr>
<tr><td><code id="plot.cwm_+3A_ctype">ctype</code></td>
<td>
<p>a vector with concomitant variables types to plot.</p>
</td></tr>
<tr><td><code id="plot.cwm_+3A_which">which</code></td>
<td>
<p>a vector with columns number to plot, or &quot;all&quot; for all the columns</p>
</td></tr>
<tr><td><code id="plot.cwm_+3A_criterion">criterion</code></td>
<td>
<p>a string with the information criterion to consider; supported values are:<code>"AIC", "AICc", "AICu", "AIC3", "AWE", "BIC", "CAIC", "ICL".</code> Default value is <code>"BIC"</code>. 
</p>
</td></tr>  
<tr><td><code id="plot.cwm_+3A_k">k</code></td>
<td>
<p>an optional vector containing the numbers of mixture components to consider. If not specified, all the estimated models are considered.
</p>
</td></tr>
<tr><td><code id="plot.cwm_+3A_modelxnorm">modelXnorm</code></td>
<td>
<p>an optional vector of character strings indicating the parsimonious models to consider for <code>Xnorm</code>. If not specified, all the estimated models are considered. 
</p>
</td></tr>
<tr><td><code id="plot.cwm_+3A_familyy">familyY</code></td>
<td>
<p>an optional vector of character strings indicating the conditional distribution of <code class="reqn">Y</code> in each mixture component to consider. If not specified, all the estimated models are considered. 
</p>
</td></tr>
<tr><td><code id="plot.cwm_+3A_histargs">histargs</code></td>
<td>
<p>an optional list with <code><a href="graphics.html#topic+hist">hist</a></code> arguments to be used in plot for normal concomitant variables.
</p>
</td></tr>
<tr><td><code id="plot.cwm_+3A_...">...</code></td>
<td>
<p>further arguments for <code><a href="graphics.html#topic+plot">plot</a></code>.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("students")
attach(students)
str(students)
fit2 &lt;- cwm(WEIGHT ~ HEIGHT + HEIGHT.F , Xnorm = cbind(HEIGHT, HEIGHT.F), k = 2, 
  initialization = "kmeans", modelXnorm = "EEE")
summary(fit2, concomitant = TRUE)
plot(fit2)

</code></pre>

<hr>
<h2 id='students'>dataset students</h2><span id='topic+students'></span>

<h3>Description</h3>

<p>A dataframe with data from a survey of 270 students attending a statistics course at the
Department of Economics and Business of the University of Catania in the academic year 2011/2012. 
It contains the following variables:
</p>

<ul>
<li> <p><code>GENDER</code> gender of the respondent;
</p>
</li>
<li> <p><code>HEIGHT</code> height of the respondent, measured in centimeters;
</p>
</li>
<li> <p><code>WEIGHT</code> weight of the respondent, measured in kilograms;
</p>
</li>
<li> <p><code>HEIGHT.F</code> height of respondent's father, measured in centimeters.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(students)</code></pre>


<h3>Format</h3>

<p>A dataset</p>


<h3>Source</h3>

<p><a href="http://www.economia.unict.it/punzo/">http://www.economia.unict.it/punzo/</a></p>


<h3>References</h3>

<p>Ingrassia, S., Minotti, S. C., and Punzo, A. (2014). Model-based clustering via linear cluster-weighted models. <em>Computational Statistics and Data Analysis</em>, <b>71</b>, 159-182.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexCWM-package">flexCWM-package</a></code>, <code><a href="#topic+cwm">cwm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("students")
attach(students)
str(students)
fit2 &lt;- cwm(WEIGHT ~ HEIGHT + HEIGHT.F , Xnorm = cbind(HEIGHT, HEIGHT.F), k = 2, 
  initialization = "kmeans", modelXnorm = "EEE")
summary(fit2, concomitant = TRUE)
plot(fit2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
