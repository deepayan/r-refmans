<!DOCTYPE html><html><head><title>Help for package npcopTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {npcopTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CopTestdm'><p>Test for break detection in copula with change-point known in the marginal cumulative distributions</p></a></li>
<li><a href='#kn'><p>Estimation of the location of the change point in the copula</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non Parametric Test for Detecting Changes in the Copula</td>
</tr>
<tr>
<td>Version:</td>
<td>1.03</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-02-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Tom Rohmer </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tom Rohmer &lt;tom.rohmer@univ-lemans.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A non parametric test for change points detection in the dependence between the components of multivariate data, with or without (multiple) changes in the marginal distributions. The full details, justification and examples are published in Rohmer (2016) &lt;<a href="https://doi.org/10.1016%2Fj.spl.2016.06.026">doi:10.1016/j.spl.2016.06.026</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-02-09 13:05:03 UTC; tom</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-02-09 13:28:52 UTC</td>
</tr>
</table>
<hr>
<h2 id='CopTestdm'>Test for break detection in copula with change-point known in the marginal cumulative distributions</h2><span id='topic+CopTestdm'></span>

<h3>Description</h3>

<p>Give the p-value of the test based on the sequential empirical copula process when a break occurs in the marginal cumulative distributions at time m known. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CopTestdm(X,b=1,M=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CopTestdm_+3A_x">X</code></td>
<td>
<p>a (non-empty) numeric matrix of <code class="reqn">d</code>-dimensional data values, greater than 2. Each row of the matrix contains one mutlivariate data.</p>
</td></tr>
<tr><td><code id="CopTestdm_+3A_m">M</code></td>
<td>
<p>a strictly positive integer (default <code class="reqn">M=1000</code>) specifying the number of bootstrap repetitions. A sequence of i.i.d. normal multipliers is generated. For no independent or normal multipliers, you also can specify the matrix of multipliers as <code class="reqn">M</code>. The specified matrix is required to have an identical number of rows than <code class="reqn">X</code>.</p>
</td></tr>
<tr><td><code id="CopTestdm_+3A_b">b</code></td>
<td>
<p>a single value or a vector of real values on (0,1] indicating the location(s) of the potential break time(s) in marginal cumulative distribution functions. You can specify <code class="reqn">b=1</code> (default) for any break time. In this case, the test corresponds to the test described in the third reference using the hat version of bootstrap replications.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the e.c.d.f.s <code class="reqn">F_{k:l,j}</code> appearing in the construction of pseudo-values (as defined in the section 2 of the first reference) evaluated from the sub-samble <code class="reqn">X_{kj},\ldots, X_{lj}</code>  are multiplied by <code class="reqn">\frac{l-k+1}{l-k+2}</code>. Discussions about this subject can be found in the third reference. For serially dependent data, you need to specify dependent multipliers, see the second and third reference for details. 
</p>


<h3>Value</h3>

<p>A list with class <code>htest</code> containing the following components:
</p>
<table>
<tr><td><code>m</code></td>
<td>
<p>the value of the potential break times in marginal cumulative distribution functions.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of change-point test was performed.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the estimated p-value for the test.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the statistic <code class="reqn">S_{nm}</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rohmer Tom
</p>


<h3>References</h3>

<p>Tom Rohmer, Some results on change-point detection in cross-sectional dependence of multivariate data with changes in marginal distributions, Statistics &amp; Probability Letters, Volume 119, December 2016, Pages 45-54, ISSN 0167-7152
</p>
<p>A. Bucher and I. Kojadinovic (2016), A dependent multiplier bootstrap for the sequential empirical copula process under strong mixing, Bernoulli 22:2, pages 927-968
</p>
<p>A. Bucher, I. Kojadinovic, T. Rohmer and J. Segers (2014), Detecting changes in cross-sectional dependence in multivariate time series, Journal of Multivariate Analysis 132, pages 111-128
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#Example 1: under the nulle hypothesis 
#of an abrupt change in the m.c.d.f. at time m=50 and no change in the copula

n=100
m=50
sigma = matrix(c(1,0.4,0.4,1),2,2)
mean1 = rep(0,2)
mean2 = rep(4,2)

X=matrix(rep(0,n*2),n,2)

for(j in 1:n) X[j,]=t(chol(sigma))%*%rnorm(2)

X[1:m,] = X[1:m,]+mean1
X[(m+1):n,] = X[(m+1):n,]+mean2

CopTestdm(X,b=0.5)


      
#Example 2: under the alternative hypothesis 
#of an abrupt change in the m.c.d.f at and in the copula time k=m=50  

n=100
m=50

mean1 = rep(0,2)
mean2 = rep(4,2)
sigma1 = matrix(c(1,0.2,0.2,1),2,2)
sigma2 = matrix(c(1,0.6,0.6,1),2,2)

X=matrix(rep(0,n*2),n,2)
for(j in 1:m) X[j,]=t(chol(sigma1))%*%rnorm(2) + mean1
for(j in (m+1):n) X[j,]=t(chol(sigma2))%*%rnorm(2) + mean2

CopTestdm(X,b=0.5)

  
#Example 3: under the alternative hypothesis 
#of abrupt changes in the m.c.d.f at times m=100 and 150 and in the copula at time k=50

n=200
m1 = 100
m2 = 150
k = 50

sigma1 = matrix(c(1,0.2,0.2,1),2,2)
sigma2 = matrix(c(1,0.6,0.6,1),2,2)

mean1 = rep(0,2)
mean2 = rep(2,2)
mean3 = rep(4,2)

X=matrix(rep(0,n*2),n,2)
for(j in 1:k) X[j,]=t(chol(sigma1))%*%rnorm(2)
for(j in (k+1):n) X[j,]=t(chol(sigma2))%*%rnorm(2)

X[1:m1,]=X[1:m1,]+mean1
X[(m1+1):m2,]=X[(m1+1):m2,]+mean2
X[(m2+1):n,]=X[(m2+1):n,]+mean3

CopTestdm(X,b=c(0.5,0.75))

</code></pre>

<hr>
<h2 id='kn'>Estimation of the location of the change point in the copula</h2><span id='topic+kn'></span>

<h3>Description</h3>

<p>Give an estimation of the abrupt change point in the copula when changes known occurs in the m.c.d.f.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>kn(X,b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kn_+3A_x">X</code></td>
<td>
<p>a (non-empty) numeric matrix of <code class="reqn">d</code>-dimensional data values, <code class="reqn">d\geq 2</code>. Each row of the matrix contains one mutlivariate data.
</p>
</td></tr>
<tr><td><code id="kn_+3A_b">b</code></td>
<td>
<p>a single value or a vector of real values on (0,1] indicating the location(s) of the potential break time(s) in marginal cumulative distribution functions. You can specify <code class="reqn">b=1</code> (default) for any break time. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the location of the abrupt change point in copula
</p>


<h3>Value</h3>

<p>estimation of the location of the change point in the copula 
</p>


<h3>Author(s)</h3>

<p>Rohmer Tom</p>


<h3>References</h3>

<p>Tom Rohmer, Some results on change-point detection in cross-sectional dependence of multivariate data with changes in marginal distributions, Statistics &amp; Probability Letters, Volume 119, December 2016, Pages 45-54, ISSN 0167-7152
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Example 1: Abrupt change in the m.c.d.f at time (known) m=50 
# and in the copula at time k=50 (to be estimated)
n=100
m=50
mean1 = rep(0,2)
mean2 = rep(4,2)
sigma1 = matrix(c(1,0.2,0.2,1),2,2)
sigma2 = matrix(c(1,0.6,0.6,1),2,2)

X=matrix(rep(0,n*2),n,2)
for(j in 1:m) X[j,]=t(chol(sigma1))%*%rnorm(2) + mean1
for(j in (m+1):n) X[j,]=t(chol(sigma2))%*%rnorm(2) + mean2

kn(X,b=0.5) 


#Example 2: Abrupt changes in the m.c.d.f at times (known) m=100 and 150
# and in the copula at time k=50 (to be estimated)
n=200
m1 = 100
m2 = 150
k = 50

sigma1 = matrix(c(1,0.2,0.2,1),2,2)
sigma2 = matrix(c(1,0.6,0.6,1),2,2)

mean1 = rep(0,2)
mean2 = rep(2,2)
mean3 = rep(4,2)

X=matrix(rep(0,n*2),n,2)
for(j in 1:k) X[j,]=t(chol(sigma1))%*%rnorm(2)
for(j in (k+1):n) X[j,]=t(chol(sigma2))%*%rnorm(2)

X[1:m1,]=X[1:m1,]+mean1
X[(m1+1):m2,]=X[(m1+1):m2,]+mean2
X[(m2+1):n,]=X[(m2+1):n,]+mean3

kn(X,b=c(0.5,0.75))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
