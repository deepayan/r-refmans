<!DOCTYPE html><html><head><title>Help for package progenyClust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {progenyClust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cell'>
<p>cell imaging metrics dataset</p></a></li>
<li><a href='#hclust.progenyClust'>
<p>Hierarchical Clustering</p></a></li>
<li><a href='#plot.progenyClust'>
<p>Plot Progeny Clustering Results</p></a></li>
<li><a href='#progenyClust'>
<p>Progeny Clustering</p></a></li>
<li><a href='#progenyClust-package'>
<p>Finding the Optimal Cluster Number Using Progeny Clustering</p></a></li>
<li><a href='#test'>
<p>3-cluster 2-dimensional test dataset</p>
</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Finding the Optimal Cluster Number Using Progeny Clustering</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-04-08</td>
</tr>
<tr>
<td>Author:</td>
<td>C.W. Hu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>C.W. Hu &lt;wendyhu001@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementing the Progeny Clustering algorithm, the 'progenyClust' package assesses the clustering stability and identifies the optimal clustering number for a given data matrix. It uses k-means clustering as a default, provides a tailored hierarchical clustering function, and can be customized to work with other clustering algorithms and different parameter settings. The package includes a main function progenyClust(), plot and summary methods for 'progenyClust' object, a function hclust.progenyClust() for hierarchical clustering, and two example datasets (test and cell) for testing. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Hmisc</td>
</tr>
<tr>
<td>Depends:</td>
<td>graphics,stats,grDevices</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-04-12 15:01:34 UTC; wendy</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-04-12 20:04:15</td>
</tr>
</table>
<hr>
<h2 id='cell'>
cell imaging metrics dataset
</h2><span id='topic+cell'></span>

<h3>Description</h3>

<p>This cell dataset contains the first three principal components of the imaging metrics for 444 cells that were engineered into four patterns. The dataset therefore should include four clusters of cell samples in theory. See the references for  more experimental and imaging analysis details of this data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cell")</code></pre>


<h3>Format</h3>

<p>A data frame with 444 observations on the following 3 variables.
</p>

<dl>
<dt><code>PC1</code></dt><dd><p>The first principal component of imaging metrics</p>
</dd>
<dt><code>PC2</code></dt><dd><p>The second principal component of imaging metrics</p>
</dd>
<dt><code>PC3</code></dt><dd><p>The third principal component of imaging metrics</p>
</dd>
</dl>



<h3>References</h3>

<p>Slater, John, et al. &quot;Recapitulation and Modulation of the Cellular Architecture of a User-Chosen Cell-of-Interest Using Cell-Derived, Biomimetic Patterning.&quot; ACS nano (2015).<br />
Hu, C.W., et al. &quot;Progeny Clustering: A Method to Identify Biological Phenotypes.&quot; Scientific reports 5 (2015). <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cell)
</code></pre>

<hr>
<h2 id='hclust.progenyClust'>
Hierarchical Clustering
</h2><span id='topic+hclust.progenyClust'></span>

<h3>Description</h3>

<p>hierarchical clustering function for progeny clustering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hclust.progenyClust(x,k,h.method='ward.D2',dist='euclidean',p=2,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hclust.progenyClust_+3A_x">x</code></td>
<td>

<p>a numeric matrix, data frame or <code><a href="stats.html#topic+dist">dist</a></code> object.
</p>
</td></tr>
<tr><td><code id="hclust.progenyClust_+3A_k">k</code></td>
<td>

<p>an integer specifying the number of clusters.
</p>
</td></tr>
<tr><td><code id="hclust.progenyClust_+3A_h.method">h.method</code></td>
<td>

<p>the agglomeration method to be used. This should be (an unambiguous abbreviation of) one of <code>"ward.D"</code>, <code>"ward.D2"</code> (default), <code>"single"</code>, <code>"complete"</code>, <code>"average"</code> (= UPGMA), <code>"mcquitty"</code> (= WPGMA), <code>"median"</code> (= WPGMC) or <code>"centroid"</code> (= UPGMC).
</p>
</td></tr>
<tr><td><code id="hclust.progenyClust_+3A_dist">dist</code></td>
<td>

<p>the distance measure to be used. This must be one of <code>"euclidean"</code>, <code>"maximum"</code>, <code>"manhattan"</code>, <code>"canberra"</code>, <code>"binary"</code> or <code>"minkowski"</code>. Any unambiguous substring can be given.
</p>
</td></tr>
<tr><td><code id="hclust.progenyClust_+3A_p">p</code></td>
<td>

<p>The power of the Minkowski distance, when <code>dist="minkowski"</code>.
</p>
</td></tr>
<tr><td><code id="hclust.progenyClust_+3A_...">...</code></td>
<td>

<p>additional arguments in <code><a href="stats.html#topic+hclust">hclust</a></code>(...).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>hclust.progenyClust</code> mainly streamlines <code><a href="stats.html#topic+dist">dist</a></code>, <code><a href="stats.html#topic+hclust">hclust</a></code> and <code><a href="stats.html#topic+cutree">cutree</a></code> into one, and structures the output to be directly used by <code><a href="#topic+progenyClust">progenyClust</a></code>. Most arguments and explanations were kept the same to ensure consistancy and avoid confusion. For more details, please check each individual function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>cluster</code></td>
<td>
<p>A vector of integers (from 1:k) indicating the cluster membership for each sample.</p>
</td></tr>
<tr><td><code>tree</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+hclust">hclust</a></code> which describes the tree produced by the clustering process.</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>A dissimilarity structure as produced by <code><a href="stats.html#topic+dist">dist</a></code>.</p>
</td></tr>


</table>


<h3>Author(s)</h3>

<p>C.W. Hu, Rice University
</p>


<h3>References</h3>

<p>Hu, C.W., et al. &quot;Progeny Clustering: A Method to Identify Biological Phenotypes.&quot; Scientific reports 5 (2015). <br />
<a href="http://www.nature.com/articles/srep12894">http://www.nature.com/articles/srep12894</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a 3-cluster 2-dimensional example dataset
data('test')

# default progeny clsutering
progenyClust(test,FUNclust=hclust.progenyClust,ncluster=2:5)-&gt;pc

# plot the scores to select the optimal cluster number
plot(pc)

# plot the clustering results with the optimal cluster number
plot(pc,test)
</code></pre>

<hr>
<h2 id='plot.progenyClust'>
Plot Progeny Clustering Results
</h2><span id='topic+plot.progenyClust'></span>

<h3>Description</h3>

<p>Plot the cluster number selection results and visualizes the clustering results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'progenyClust'
plot(x,data=NULL,k=NULL,errorbar=FALSE,xlab='',ylab='',...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.progenyClust_+3A_x">x</code></td>
<td>

<p>a <code><a href="#topic+progenyClust">progenyClust</a></code> object.
</p>
</td></tr>
<tr><td><code id="plot.progenyClust_+3A_data">data</code></td>
<td>

<p>the full or a subset of the oringal data matrix that was used for clustering. If unspecified, the function will plot stability scores for cluster number selection; If specified, the function will plot the data in scatter plots with colors annotated by clustering memberships (Please see details below).
</p>
</td></tr>
<tr><td><code id="plot.progenyClust_+3A_k">k</code></td>
<td>

<p>integer specifying the cluster number for visualizing the clustering results of original data: only takes into effect when argument <code>data</code> is provided, and needs to be a cluster number that was previously investigated in <code><a href="#topic+progenyClust">progenyClust</a></code> to generate the <code>progenyClust</code> object <code>x</code>. The default is the optimal number of clusters.  
</p>
</td></tr>
<tr><td><code id="plot.progenyClust_+3A_errorbar">errorbar</code></td>
<td>

<p>logical flag: specifies whether the error bars should be drawn. The error bars can only be drawn when progeny clustering is repeated multiple times, i.e. input argument &quot;repeats&quot; in function <a href="#topic+progenyClust">progenyClust</a> is greater than 1.
</p>
</td></tr>
<tr><td><code id="plot.progenyClust_+3A_xlab">xlab</code></td>
<td>

<p>character string specifying the name of the x axis.
</p>
</td></tr>
<tr><td><code id="plot.progenyClust_+3A_ylab">ylab</code></td>
<td>

<p>character string specifying the name of the y axis.
</p>
</td></tr>
<tr><td><code id="plot.progenyClust_+3A_...">...</code></td>
<td>

<p>additional graphical arguments in <code><a href="graphics.html#topic+plot">plot</a></code>(...).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot function provides two types of visualization: (1) visualizing stability scores, and (2) visualizing clustering results. 
To visualize the stability scores that are output from <code><a href="#topic+progenyClust">progenyClust</a></code> function, please run the plot function without specifying the input argument <code>data</code>. The resulting plot visualizes the stability score at each cluster number. This plot can provide an overview of clustering stability, and can facilitate selecting the optimal cluster number.<br /><br />
The plot function can also visualize the clustering results in scatter plots by specifying the input argument <code>data</code>. Since the goal is to view how the original data is clustered with certain cluster number, <code>data</code> needs to contain exactly the same number of samples as in the original data that was used to run the <code><a href="#topic+progenyClust">progenyClust</a></code> function. If <code>data</code> contains more than two features, a table of scatter plots will be created to show clustering results within each pair of dimensions. <code>data</code> with more than 20 features/columns will not be accepted, but a subset of <code>data</code> with selected features can be used in this case. The input argument <code>k</code> specifies the cluster number at which the clustering result is shown. Note that <code>k</code> needs to be a cluster number that was previously examined by <code><a href="#topic+progenyClust">progenyClust</a></code> when generating the <code>progenyClust</code> object <code>x</code>. If <code>k</code> is not provided, the function will use the optimal cluster number determined by the Gap criterion only if <code>method='gap'</code>, and will use the optimal number determined by the Score criterion if <code>method='gap'</code> or <code>method='both'</code> when running <code><a href="#topic+progenyClust">progenyClust</a></code>. 
</p>


<h3>Value</h3>

<p>returns plots as described in Details.

</p>



<h3>Author(s)</h3>

<p>C.W. Hu, Rice University
</p>


<h3>References</h3>

<p>Hu, C.W., et al. &quot;Progeny Clustering: A Method to Identify Biological Phenotypes.&quot; Scientific reports 5 (2015). <br />
<a href="http://www.nature.com/articles/srep12894">http://www.nature.com/articles/srep12894</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a 3-cluster 2-dimensional example dataset
data('test')

# default progeny clsutering
progenyClust(test,ncluster=2:5)-&gt;pc

# plot the scores to select the optimal cluster number
plot(pc)

# plot the clustering results with the optimal cluster number
plot(pc,test)
</code></pre>

<hr>
<h2 id='progenyClust'>
Progeny Clustering
</h2><span id='topic+progenyClust'></span><span id='topic+summary.progenyClust'></span><span id='topic+print.summary.progenyClust'></span>

<h3>Description</h3>

<p>Select the optimal number for clustering using Progeny Clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>progenyClust(data, FUNclust = kmeans, method = "gap", score.invert = F, ncluster = 2:10, 
size = 10, iteration = 100, repeats = 1, nrandom = 10, ...)

## S3 method for class 'progenyClust'
summary(object,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="progenyClust_+3A_data">data</code></td>
<td>

<p>data matrix or data frame for clustering: each row correpsonds to a sample or observation, whereas each column corresponds to a feature or variable.
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_funclust">FUNclust</code></td>
<td>

<p>clustering function: accepts data as its first argument and the number for clustering as the second argument; returns a list containing a component called 'cluster' which is a vector of integers recording the clustering assignment for all samples. The default function is kmeans.
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_method">method</code></td>
<td>

<p>character string indicating the criterion used to pick the optimal cluster number.<br />
'gap': the default value, selecting the cluster number that has the biggest or smallest (when score.invert=TRUE) gap from its neighboring numbrs. The optimal cluster number is picked based on the input data only, and is not compared against any random datasets, thus is quick to compute. Note that this method does not evaluate the minimum and maximum cluster numbers.<br />
'score': selects the cluster number that has the highest or lowest (when score.invert=TRUE) score when comparing against scores generated from random datasets. Due to the repeats on progeny clustering on random datasets, this method is slower to compute.<br />
'both': uses and outputs results from both the 'gap' and 'score' criteria.
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_score.invert">score.invert</code></td>
<td>

<p>logical flag: specifies whether the score should be inverted. The default score is the ratio of true classification probabilities over false classification probilities. The inverted score is the ratio of false classification over true classification probilities, which can prevent the algorithm from generating infinite score values in cases of perfect clustering. When score.invert=TRUE, the optimla cluster number is picked based on the lowest score.  
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_ncluster">ncluster</code></td>
<td>

<p>sequence of integers specifying candidate cluster numbers for evaluation: ncluster needs to be continuous if the method 'gap' is chosen.
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_size">size</code></td>
<td>

<p>integer specifying the number of progenies generated from each cluster. Default value is 10.
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_iteration">iteration</code></td>
<td>

<p>integer specifying the number of times the algorithm samples progenies and evalutes similarity among progenies. Default value is 100.
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_repeats">repeats</code></td>
<td>

<p>integer specifying the number of times the algorithm should be run: needs to be greater than 0. Values greater than 1 output standard deviations of the scores, which are plotted as error bars in print(...,errorbar=T,...) function. Default value is 1.
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_nrandom">nrandom</code></td>
<td>

<p>integer specifying the number of random datasets used to generate reference scores when using method 'score'. Default value is 10. 
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_object">object</code></td>
<td>

<p>the S3 object of class &quot;progenyClust&quot;.
</p>
</td></tr>
<tr><td><code id="progenyClust_+3A_...">...</code></td>
<td>

<p>additional arguments for FUNclust in progenyClust(...).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>progenyClust returns an object of class &quot;progenyClust&quot; which has a plot and summary method. It is a list with the following components:

</p>
<table>
<tr><td><code>cluster</code></td>
<td>
<p>matrix of clustering memberships for all samples under given cluster numbers: each row corresponds to a sample; each column corresponds to a given cluster number.</p>
</td></tr>
<tr><td><code>score</code></td>
<td>
<p>matrix of stability scores from clustering the input data under given cluster numbers: each column corresponds to a given cluster number; each row corresponds to a repeat, the number of which is defined by 'repeats' in the input argument.</p>
</td></tr>
<tr><td><code>random.score</code></td>
<td>
<p>matrix of stability scores from clustering random datasets under given cluster numbers: each column corresponds to a given cluster number; each row corresponds to a random dataset, the number of which is defined by 'nrandom' in the input argument.</p>
</td></tr>
<tr><td><code>random.score</code></td>
<td>
<p>matrix of stability scores from clustering random datasets under given cluster numbers: each column corresponds to a given cluster number; each row corresponds to a random dataset, the number of which is defined by 'nrandom' in the input argument.</p>
</td></tr>
<tr><td><code>mean.gap</code></td>
<td>
<p>vector of mean stability scores based on the 'gap' criterion when the input argument 'method' is set to be 'gap' or 'both'.</p>
</td></tr>
<tr><td><code>mean.score</code></td>
<td>
<p>vector of mean stability scores based on the 'score' criterion when the input argument 'method' is set to be 'score' or 'both'.</p>
</td></tr>
<tr><td><code>sd.gap</code></td>
<td>
<p>vector of standard deviations of stability scores for each given cluster number based on the 'gap' criterion, when the input argument 'method' is set to be 'gap' or 'both'.</p>
</td></tr>
<tr><td><code>sd.score</code></td>
<td>
<p>vector of standard deviations of stability scores for each given cluster number based on the 'score' criterion, when the input argument 'method' is set to be 'score' or 'both'.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call with arguments specified.</p>
</td></tr>
<tr><td><code>ncluster</code></td>
<td>
<p>the specified value of input argument 'ncluster'.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the specified value of input argument 'method'.</p>
</td></tr>
<tr><td><code>score.invert</code></td>
<td>
<p>the specified value of input argument 'score.invert'.</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p>C.W. Hu, Rice University
</p>


<h3>References</h3>

<p>Hu, C.W., et al. &quot;Progeny Clustering: A Method to Identify Biological Phenotypes.&quot; Scientific reports 5 (2015). <br />
http://www.nature.com/articles/srep12894
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a 3-cluster 2-dimensional example dataset
data('test')

# default progeny clsutering
progenyClust(test,ncluster=2:5)-&gt;pc

summary(pc)
plot(pc)

</code></pre>

<hr>
<h2 id='progenyClust-package'>
Finding the Optimal Cluster Number Using Progeny Clustering
</h2><span id='topic+progenyClust-package'></span>

<h3>Description</h3>

<p>Implementing the Progeny Clustering algorithm based on Hu, Chenyue W., et al. &quot;Progeny Clustering: A Method to Identify Biological Phenotypes.&quot; Scientific Reports 5 (2015), the progenyClust package assesses the clustering stability and identifies the optimal clustering number for a given data matrix. It uses kmeans clustering as default, but can be customized to work with other clustering algorithms and different parameter settings. The package includes one main function progenyClust(), plot and summary methods for &quot;progenyClust&quot; object, and two example dataset (&quot;test&quot; and &quot;cell&quot;) for testing. 
</p>


<h3>Details</h3>

<p>Package: progenyclust<br />
Version: 1.1<br />
Date: 2015-11-24<br />
License: AGPL-3<br />
Imports: Hmisc<br />
Depends: graphics, stats
</p>


<h3>Author(s)</h3>

<p>C.W. Hu, Rice University<br />
Maintainer: C.W. Hu &lt;wendyhu001@gmail.com&gt;
</p>


<h3>References</h3>

<p>Hu, C.W., et al. &quot;Progeny Clustering: A Method to Identify Biological Phenotypes.&quot; Scientific reports 5 (2015). <br />
http://www.nature.com/articles/srep12894
</p>

<hr>
<h2 id='test'>
3-cluster 2-dimensional test dataset

</h2><span id='topic+test'></span>

<h3>Description</h3>

<p>This test dataset contains 3 clusters centered around (-1,2),(2,0) and (-1,-2) in a 2-dimensional space. Each cluster consists of 50 samples that were drawn from bivariate normal distributions with a common identity covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("test")</code></pre>


<h3>Format</h3>

<p>A data frame with 150 observations on the following 2 variables. 
</p>

<dl>
<dt>V1</dt><dd><p>numeric vector of coordinates in x axis</p>
</dd>
<dt>V2</dt><dd><p>numeric vector of coordinates in y axis</p>
</dd>
</dl>



<h3>References</h3>

<p>Hu, C.W., et al. &quot;Progeny Clustering: A Method to Identify Biological Phenotypes.&quot; Scientific reports 5 (2015). <br />
http://www.nature.com/articles/srep12894
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(test)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
