<!DOCTYPE html><html><head><title>Help for package relMix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {relMix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allGenos'><p>Find all possible genotypes</p></a></li>
<li><a href='#checkFrequenciesFile'><p>Load and check a frequency file</p></a></li>
<li><a href='#checkMixtureFile'><p>Load and check a mixture file</p></a></li>
<li><a href='#checkPedigreeFile'><p>Check a pedigree file</p></a></li>
<li><a href='#checkReferenceFile'><p>Check a reference profiles file</p></a></li>
<li><a href='#createDatamatrix'><p>Create data matrix with possible genotype combinations for specified individuals</p></a></li>
<li><a href='#db'><p>Allele database</p></a></li>
<li><a href='#db2'><p>Allele database for 22 markers</p></a></li>
<li><a href='#generateMix'><p>Create a mixture of genotypes with simulated drop-in and dropout</p></a></li>
<li><a href='#mixLikDrop'><p>Likelihoods for DNA mixtures with dropout and dropin</p></a></li>
<li><a href='#relMix'><p>Relationship inference based on mixtures</p></a></li>
<li><a href='#relMixGUI'><p>GUI for relMix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Relationship Inference for DNA Mixtures</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-12</td>
</tr>
<tr>
<td>Description:</td>
<td>
  Analysis of DNA mixtures involving relatives by computation of likelihood ratios that account for dropout and drop-in, mutations, silent alleles and population 
  substructure. This is useful in kinship cases, like non-invasive prenatal paternity testing, where deductions about individuals' relationships rely on DNA mixtures, 
  and in criminal cases where the contributors to a mixed DNA stain may be related. Relationships are represented 
  by pedigrees and can include kinship between more than two individuals. The main function is relMix() and its graphical user interface relMixGUI(). 
  The implementation and method is described in Dorum et al. (2017) &lt;<a href="https://doi.org/doi.org%2F10.1007%2Fs00414-016-1526-x">doi:doi.org/10.1007/s00414-016-1526-x</a>&gt;, Hernandis et al. (2019)
  &lt;<a href="https://doi.org/doi.org%2F10.1016%2Fj.fsigss.2019.09.085">doi:doi.org/10.1016/j.fsigss.2019.09.085</a>&gt; and Kaur et al. (2016) &lt;<a href="https://doi.org/doi.org%2F10.1007%2Fs00414-015-1276-1">doi:doi.org/10.1007/s00414-015-1276-1</a>&gt;.</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Familias (&ge; 2.6.1), gWidgets2, gWidgets2tcltk, flextable,
officer, pedFamilias, pedtools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, pander, rmarkdown, tkrplot</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gdorum.github.io/relMix/">https://gdorum.github.io/relMix/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-22 08:57:01 UTC; dogu</td>
</tr>
<tr>
<td>Author:</td>
<td>Guro Dorum [aut, cre],
  Elias Hernandis [aut],
  Navreet Kaur [ctb],
  Thore Egeland [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guro Dorum &lt;guro.dorum@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-23 10:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='allGenos'>Find all possible genotypes</h2><span id='topic+allGenos'></span>

<h3>Description</h3>

<p>Finds all possible genotypes based on input alleles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allGenos(alleles)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allGenos_+3A_alleles">alleles</code></td>
<td>
<p>Vector of input alleles, numeric or character</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of all possible genotypes, one row per genotype
</p>


<h3>Author(s)</h3>

<p>Guro Dorum
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alleles &lt;- 1:3
allGenos(alleles)
</code></pre>

<hr>
<h2 id='checkFrequenciesFile'>Load and check a frequency file</h2><span id='topic+checkFrequenciesFile'></span>

<h3>Description</h3>

<p>Loads a frequency database file and compares it against mixture data to check for common errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkFrequenciesFile(filename, mix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkFrequenciesFile_+3A_filename">filename</code></td>
<td>
<p>Path of the frequency database file</p>
</td></tr>
<tr><td><code id="checkFrequenciesFile_+3A_mix">mix</code></td>
<td>
<p>Data frame with mixture data. See relMix vignette for description of the format</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mixture data is used to perform more advanced checks, such as to make sure all alleles present
in the mixture file have an entry in the frequency database.
If warnings are found, the function attempts to fix them and explains what it has done in the warning messages.
If an error is found, checking stops and a NULL data frame is returned. The error is described in the error messages.
</p>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li> <p><code>df</code> Data frame with frequencies
</p>
</li>
<li> <p><code>warning</code> List of strings describing the errors that occurred but could be fixed or that do not prevent
the execution of the program.
</p>
</li>
<li> <p><code>error</code> List of strings describing the errors that occurred that made it impossible to return a valid data frame.
If this list is not empty, then the data frame item will be NULL</p>
</li></ul>



<h3>Author(s)</h3>

<p>Elias Hernandis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+checkMixtureFile">checkMixtureFile</a></code> for information on how to load a mixture file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mixfile &lt;- system.file("extdata","mixture.txt",package="relMix")
mix &lt;- checkMixtureFile(mixfile)
# note: the mixture data frame is passed as an argument
# if the previous check failed, the program should not continue
# with the frequencies file check
freqfile &lt;- system.file('extdata','frequencies22Markers.txt',package='relMix')
freqs &lt;- checkFrequenciesFile(freqfile, mix$df)
</code></pre>

<hr>
<h2 id='checkMixtureFile'>Load and check a mixture file</h2><span id='topic+checkMixtureFile'></span>

<h3>Description</h3>

<p>Given a mixture file name, returns the loaded data frame along with any detected errors or warnings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkMixtureFile(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkMixtureFile_+3A_filename">filename</code></td>
<td>
<p>Path of the mixture file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If warnings are found, the function attempts to fix them and explains what it has done in the warning messages.
If an error is found, checking stops and a NULL data frame is returned. The error is described in the error messages.
</p>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li> <p><code>df</code> The loaded data frame, NULL if errors are present.
</p>
</li>
<li> <p><code>warning</code> A list of strings describing the errors that ocurred but could be fixed or that do not prevent the execution of the program.
</p>
</li>
<li> <p><code>error</code> A list of strings describing the errors that occurred that made it impossible to return a valid data frame.
If this list is not empty, then the data frame item will be null.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Elias Hernandis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mixfile &lt;- system.file("extdata","mixture.txt",package="relMix")
result &lt;- checkMixtureFile(mixfile);
print(result$df);
print(result$warning);
print(result$error);
</code></pre>

<hr>
<h2 id='checkPedigreeFile'>Check a pedigree file</h2><span id='topic+checkPedigreeFile'></span>

<h3>Description</h3>

<p>Given a pedigree file path the function attempts to load it and compare it
to the reference profiles to detect possible errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkPedigreeFile(filename, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkPedigreeFile_+3A_filename">filename</code></td>
<td>
<p>Path of the pedigree file</p>
</td></tr>
<tr><td><code id="checkPedigreeFile_+3A_df">df</code></td>
<td>
<p>Data frame with reference profiles</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The pedigree file must be a a text file in ped format (see the relMix vignette for an example). The data frame with reference data is used to compare names of individuals and detect possible misspellings.
If warnings are found, the function attempts to fix them and explains what it has done in the warning messages.
If an error is found, checking stops. The error is described in the error messages.
</p>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li> <p><code>df</code> A list of class [Familias::FamiliasPedigree()], or NULL if errors are present.
</p>
</li>
<li> <p><code>warning</code> A list of strings describing the errors that ocurred but could be fixed or that do not prevent the execution of the program.
</p>
</li>
<li> <p><code>error</code> A list of strings describing the errors that ocurred that made it imposible to return a valid data frame.
If this list is not empty, then the dataframe item will be null.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Elias Hernandis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#First load mixture file
mixfile &lt;- system.file("extdata","mixture_silent_ex.txt",package="relMix")
mix &lt;- checkMixtureFile(mixfile);
#Load reference file
reffile &lt;- system.file("extdata","references_silent.txt",package="relMix")
ref &lt;- checkReferenceFile(reffile, mix$df)
#Check pedigree file
pedfile &lt;- system.file("extdata","custom_pedigree_maternity_duo.ped",package="relMix")
checkPedigreeFile(pedfile,ref$df);
</code></pre>

<hr>
<h2 id='checkReferenceFile'>Check a reference profiles file</h2><span id='topic+checkReferenceFile'></span>

<h3>Description</h3>

<p>Given a reference profile file name the function attempts to load it and compare it to the mixture file to detect possible errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkReferenceFile(filename, mix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkReferenceFile_+3A_filename">filename</code></td>
<td>
<p>Path of the reference profiles file</p>
</td></tr>
<tr><td><code id="checkReferenceFile_+3A_mix">mix</code></td>
<td>
<p>Data frame with mixture data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the relMix vignette for a description of the format of the reference file. The data frame with mixture data is used to compare
If warnings are found, the function attempts to fix them and explains what it has done in the warning messages.
If an error is found, checking stops and a NULL dataframe is returned. The error is described in the error messages.
</p>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li> <p><code>df</code> The loaded data frame, NULL if errors are present
</p>
</li>
<li> <p><code>warning</code> A list of strings describing the errors that ocurred but could be fixed or that do not prevent the execution of the program.
</p>
</li>
<li> <p><code>error</code> A list of strings describing the errors that ocurred that made it impossible to return a valid data frame.
If this list is not empty, then the data frame item will be null.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Elias Hernandis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+checkMixtureFile">checkMixtureFile</a></code> for information on how to load a mixture file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load a mixture file
mixfile &lt;- system.file("extdata","mixture.txt",package="relMix")
mix &lt;- checkMixtureFile(mixfile);
#Note: the mixture dataframe is passed as an argument. If the previous check failed,
#the program should not continue with the reference file check
reffile &lt;- system.file("extdata","references.txt",package="relMix")
checkReferenceFile(reffile, mix$df);
</code></pre>

<hr>
<h2 id='createDatamatrix'>Create data matrix with possible genotype combinations for specified individuals</h2><span id='topic+createDatamatrix'></span>

<h3>Description</h3>

<p>A data matrix of genotypes for known individuals and all possible genotypes for unknown individuals is created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createDatamatrix(locus, knownGenos, idsU = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createDatamatrix_+3A_locus">locus</code></td>
<td>
<p>A list of class <code><a href="Familias.html#topic+FamiliasLocus">FamiliasLocus</a></code> containing information about the locus</p>
</td></tr>
<tr><td><code id="createDatamatrix_+3A_knowngenos">knownGenos</code></td>
<td>
<p>List of known genotypes. Each element is a vector with genotype for one individual. The elements must be named</p>
</td></tr>
<tr><td><code id="createDatamatrix_+3A_idsu">idsU</code></td>
<td>
<p>Vector of indices for unknown individuals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data matrix of genotypes where each row corresponds to an individual.
</p>


<h3>Author(s)</h3>

<p>Guro Dorum
</p>


<h3>See Also</h3>

<p><code><a href="Familias.html#topic+FamiliasLocus">FamiliasLocus</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Define alleles and frequencies
alleles &lt;- 1:2
afreq &lt;- c(0.5,0.5)
#Create locus object
locus &lt;- Familias::FamiliasLocus(frequencies=afreq,name="M1",allelenames= alleles)
#Known genotypes of alleged father and mother, child's genotype is uknown
gAF &lt;- c(1,1)
gMO &lt;- c(1,1)
datamatrix &lt;- createDatamatrix(locus,knownGenos=list(AF=gAF,MO=gMO),idsU=c("CH"))
</code></pre>

<hr>
<h2 id='db'>Allele database</h2><span id='topic+db'></span>

<h3>Description</h3>

<p>Norwegian database with 17 EXS17 markers and 6 additional markers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(db)
</code></pre>


<h3>Format</h3>

<p>A data frame with 324 observations on the following 3 variables:
</p>

<dl>
<dt><code>Marker</code></dt><dd><p>a factor with levels corresponding to name of markers</p>
</dd>
<dt><code>Allel</code></dt><dd><p>a numeric vector denoting allele</p>
</dd>
<dt><code>Frequency</code></dt><dd><p>a numeric vector in (0,1)</p>
</dd></dl>



<h3>Source</h3>

<p>Dupuy et al. (2013), unpublished.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(db)
#Checks that frequencies add to 1
lapply(split(db$Frequency,db$Marker),sum)
#Finds number of alleles for all markers
unlist(lapply(split(db$Frequency,db$Marker),length))
#A closer look at the marker SE33
SE33=db[db$Marker=="SE33",]
barplot(SE33$Frequency)
</code></pre>

<hr>
<h2 id='db2'>Allele database for 22 markers</h2><span id='topic+db2'></span>

<h3>Description</h3>

<p>Frequencies for 22 loci from the prototype 24-plex STR panel from Thermo Fisher.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(db2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 206 observations on the following 3 variables.
</p>

<dl>
<dt><code>Marker</code></dt><dd><p>a factor with levels corresponding to name of markers</p>
</dd>
<dt><code>Allele</code></dt><dd><p>a numeric vector denoting allele</p>
</dd>
<dt><code>Frequency</code></dt><dd><p>a numeric vector in (0,1)</p>
</dd></dl>



<h3>Details</h3>

<p>The format is convenient for R.
</p>


<h3>Source</h3>

<p>Hill et al. (2013) U.S. population data for 29 autosomal STR loci. Forensic Sci. Int. Genet. 7, e82-e83. <br />
Hill et al. (2006) Allele Frequencies for 26 MiniSTR Loci with U.S. Caucasian, African American, and Hispanic Populations. http://www.cstl.nist.gov/biotech/strbase/NISTpop.htm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(db2)
</code></pre>

<hr>
<h2 id='generateMix'>Create a mixture of genotypes with simulated drop-in and dropout</h2><span id='topic+generateMix'></span>

<h3>Description</h3>

<p>Takes as input genotypes and creates a mixture. Alleles drop in and out of the mixture with the specified probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateMix(G, alleles, afreq, D, di)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generateMix_+3A_g">G</code></td>
<td>
<p>List of genotypes. Each element is a vector with genotype for one individual</p>
</td></tr>
<tr><td><code id="generateMix_+3A_alleles">alleles</code></td>
<td>
<p>Numeric or character Vector of allele names for the marker</p>
</td></tr>
<tr><td><code id="generateMix_+3A_afreq">afreq</code></td>
<td>
<p>Numeric vector of allele frequencies for the marker</p>
</td></tr>
<tr><td><code id="generateMix_+3A_d">D</code></td>
<td>
<p>List of dropout values (between 0 and 1) per contributor.
Each element is a vector containing heterozygous and homozygous dropout probability for the given contributor</p>
</td></tr>
<tr><td><code id="generateMix_+3A_di">di</code></td>
<td>
<p>Drop-in value (between 0 and 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of mixture alleles.
</p>


<h3>Author(s)</h3>

<p>Guro Dorum
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Define alleles and frequencies
alleles &lt;- 1:2
afreq &lt;- c(0.5,0.5)
#Genotypes
gM &lt;- c(1,1)
gC &lt;- c(1,2)
#Dropout and drop-in values
d &lt;- 0.1
di &lt;- 0.05
#No drop-in for first contributor
D &lt;- list(c(0,0),c(d,d^2))
R &lt;- generateMix(G=list(gM,gC),alleles,afreq,D=D,di=di)
</code></pre>

<hr>
<h2 id='mixLikDrop'>Likelihoods for DNA mixtures with dropout and dropin</h2><span id='topic+mixLikDrop'></span>

<h3>Description</h3>

<p>Computes the likelihood of a mixture conditioned on a given number of known and unknown contributors, and drop-in and dropout probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixLikDrop(R, G, D, di = 0, alleleNames, afreq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixLikDrop_+3A_r">R</code></td>
<td>
<p>Vector of mixture alleles</p>
</td></tr>
<tr><td><code id="mixLikDrop_+3A_g">G</code></td>
<td>
<p>List of genotypes. Each element is a vector with genotype for one individual</p>
</td></tr>
<tr><td><code id="mixLikDrop_+3A_d">D</code></td>
<td>
<p>List of dropout values (between 0 and 1) per contributor. Each element is a vector containing heterozygous and homozygous dropout probability for the given contributor</p>
</td></tr>
<tr><td><code id="mixLikDrop_+3A_di">di</code></td>
<td>
<p>Drop-in value (between 0 and 1)</p>
</td></tr>
<tr><td><code id="mixLikDrop_+3A_allelenames">alleleNames</code></td>
<td>
<p>Vector of allele names for the marker</p>
</td></tr>
<tr><td><code id="mixLikDrop_+3A_afreq">afreq</code></td>
<td>
<p>Vector of allele frequencies for the marker</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The likelihood (a numeric)
</p>


<h3>Author(s)</h3>

<p>Guro Dorum
</p>


<h3>References</h3>

<p>The model is specified in the appendix of Haned et al. (2012) &lt;doi:10.1016/j.fsigen.2012.08.008&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+relMix">relMix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Define alleles and frequencies
alleles &lt;- 1:2
afreq &lt;- c(0.5,0.5)
#Genotypes
gM &lt;- c(1,1)
gC &lt;- c(1,2)
#Mixture alleles
R &lt;- c(1,2)
#Dropout and drop-in values
d &lt;- 0.1
di &lt;- 0.05
#No drop-in for first contributor
D &lt;- list(c(0,0),c(d,d^2))
mixLikDrop(R=R,G=list(gM,gC),D=D,di=di,alleleNames=alleles,afreq=afreq)
</code></pre>

<hr>
<h2 id='relMix'>Relationship inference based on mixtures</h2><span id='topic+relMix'></span>

<h3>Description</h3>

<p>Calculates likelihoods for relationship inference involving mixtures and missing reference profiles,
including drop-in and dropout, mutations, silent alleles and theta correction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relMix(
  pedigrees,
  locus,
  R,
  datamatrix,
  ids,
  D = rep(list(c(0, 0)), length(ids)),
  di = 0,
  kinship = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relMix_+3A_pedigrees">pedigrees</code></td>
<td>
<p>A list of pedigrees defined using <code><a href="Familias.html#topic+FamiliasPedigree">FamiliasPedigree</a></code></p>
</td></tr>
<tr><td><code id="relMix_+3A_locus">locus</code></td>
<td>
<p>A list of class <code><a href="Familias.html#topic+FamiliasLocus">FamiliasLocus</a></code> containing information about the locus. Note that a silent allele must be indicated by 's' (and not 'silent' as in Familias)</p>
</td></tr>
<tr><td><code id="relMix_+3A_r">R</code></td>
<td>
<p>A vector of mixture alleles, or a list of such if there are multiple replicates</p>
</td></tr>
<tr><td><code id="relMix_+3A_datamatrix">datamatrix</code></td>
<td>
<p>A data frame where each line corresponds to one constellation of genotypes for the involved individuals.
Indices of individuals must be given as rownames and must correspond to indices in the pedigree</p>
</td></tr>
<tr><td><code id="relMix_+3A_ids">ids</code></td>
<td>
<p>Index vector indicating which individuals are contributors to the mixture. The indices must correspond to
indices in the pedigree</p>
</td></tr>
<tr><td><code id="relMix_+3A_d">D</code></td>
<td>
<p>List of numeric dropout values (between 0 and 1) per contributor.
Each element is a vector containing heterozygous and homozygous dropout probability for the given contributor</p>
</td></tr>
<tr><td><code id="relMix_+3A_di">di</code></td>
<td>
<p>A numeric drop-in value (between 0 and 1)</p>
</td></tr>
<tr><td><code id="relMix_+3A_kinship">kinship</code></td>
<td>
<p>A numeric value between 0 and 1 that defines the theta-parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function requires the package <code><a href="Familias.html#topic+Familias">Familias</a></code> and calls on the function <code><a href="Familias.html#topic+FamiliasPosterior">FamiliasPosterior</a></code>.
</p>


<h3>Value</h3>

<p>A numeric likelihood for each pedigree named according to the pedigrees, and a matrix of likelihoods for each pedigree and each term (genotype constellation) considered in the calculation
(one row per term).
</p>


<h3>Author(s)</h3>

<p>Navreet Kaur, Thore Egeland, Guro Dorum
</p>


<h3>References</h3>

<p>Dorum et al. (2017) &lt;doi:10.1007/s00414-016-1526-x&gt; <br />
Kaur et al. (2016) &lt;doi:10.1007/s00414-015-1276-1&gt; <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+relMixGUI">relMixGUI</a></code> for the GUI version of relMix, <code><a href="Familias.html#topic+FamiliasLocus">FamiliasLocus</a></code> on how to create a FamiliasLocus and <code><a href="Familias.html#topic+FamiliasPedigree">FamiliasPedigree</a></code> on how to create a FamiliasPedigree.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1: paternity trio with mixture of mother and child
#Define alleles and frequencies
alleles &lt;- 1:2
afreq &lt;- c(0.4,0.6)
#Define pedigrees
persons &lt;- c("CH","MO","AF")
ped1 &lt;- Familias::FamiliasPedigree(id=persons, dadid=c("AF",NA, NA), momid=c("MO", NA,NA),
                        sex=c("male", "female", "male"))
ped2 &lt;- Familias::FamiliasPedigree(id=c(persons, "TF"), dadid=c("TF", NA, NA,NA),
                        momid=c("MO", NA, NA,NA), sex=c("male", "female", "male", "male"))
pedigrees &lt;- list(isFather = ped1, unrelated=ped2)
#Create locus object
locus &lt;- Familias::FamiliasLocus(frequencies=afreq,name="M1",
                      allelenames= alleles)
#Known genotypes of alleged father and mother
gAF &lt;- c(1,1)
gMO &lt;- c(1,1)
#Mixture alleles
R &lt;- c(1,2)
datamatrix &lt;- createDatamatrix(locus,knownGenos=list(AF=gAF,MO=gMO),idsU=c("CH"))
#Define dropout and drop-in values
d &lt;- 0.1
di &lt;- 0.05
res &lt;- relMix(pedigrees, locus, R, datamatrix, ids=c("MO","CH"),
             D=list(c(0,0),c(d,d^2)),di=di, kinship=0)
#LR=0.054
res$isFather/res$unrelated

#Example 2: Exhaustive example with silent allele, mutations, dropout and drop-in
#H1: Contributors are mother and child
#H2: Contributors are mother and unrelated
#Possible dropout in both contributors
gMO &lt;- c(1,1) #Mother's genotype
R &lt;- 1 #Mixture alleles
#Mother/child pedigree
persons &lt;- c("CH","MO")
ped1 &lt;- Familias::FamiliasPedigree(id=persons, dadid=c(NA,NA), momid=c("MO", NA),
                        sex=c("male", "female"))
ped2 &lt;- Familias::FamiliasPedigree(id=c(persons), dadid=c(NA, NA),
                        momid=c( NA, NA),
                        sex=c("male", "female"))
pedigrees &lt;- list(H1 = ped1, H2=ped2)
#Alleles and frequencies:
#When silent alleles are involved, a custom mutation matrix is required.
#No mutations are possible to or from silent alleles.
#We create the mutation model with FamiliasLocus and modify it before it is
#passed on to relMix
alleles &lt;- c(1,2,'silent')
afreq &lt;- c(0.4,0.5,0.1)
#Create initial locus object with mutation matrix
locus &lt;- Familias::FamiliasLocus(frequencies=afreq,name='M1',
                      allelenames= alleles, MutationModel='Equal',
                      femaleMutationRate=0.1,maleMutationRate=0.1)
#Modify mutation matrix from Familias:
#Silent allele must be given as 's' (not 'silent' as in Familias)
newAlleles &lt;- c(alleles[-length(alleles)],'s')
mm &lt;- locus$femaleMutationMatrix
colnames(mm) &lt;- rownames(mm) &lt;- newAlleles
#Create new locus object with modified mutation matrix
locus &lt;- Familias::FamiliasLocus(frequencies=afreq,name='M1',
                      allelenames= newAlleles, MutationModel='Custom', MutationMatrix=mm)
knownGenos &lt;- list(gMO)
names(knownGenos) &lt;- c("MO")
datamatrix &lt;- createDatamatrix(locus,knownGenos,ids="CH")
d &lt;- 0.1 #Dropout probability for both contributors
di &lt;- 0.05
res2 &lt;- relMix(pedigrees, locus, R, datamatrix, ids=c("MO","CH"),
              D=list(c(d,d^2),c(d,d^2)),di=di, kinship=0)
#LR=1.68
res2$H1/res2$H2

</code></pre>

<hr>
<h2 id='relMixGUI'>GUI for relMix</h2><span id='topic+relMixGUI'></span>

<h3>Description</h3>

<p>User-friendly graphical user interface for relMix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relMixGUI()
</code></pre>


<h3>Details</h3>

<p>Includes error checking for the input files.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Guro Dorum, Elias Hernandis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+relMix">relMix</a></code> for the main function implemented in <code>relMixGUI</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Examples can be found in the vignette and example data files can be found
#in the folder "extdata" in the installation folder for relMix
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
