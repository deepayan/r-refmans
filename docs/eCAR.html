<!DOCTYPE html><html lang="en"><head><title>Help for package eCAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eCAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eCAR.out'><p>eCAR class constructor</p></a></li>
<li><a href='#lipcancer'><p>Number of recorded lip cancer cases in the 56 districts of Scotland.</p></a></li>
<li><a href='#par.eCAR.Leroux'><p>R wrapper that accesses C code to fit parametric Leroux CAR spatial regression model that accounts for spatial confounding</p></a></li>
<li><a href='#plot'><p>Plot the spatial scale varying coefficient</p></a></li>
<li><a href='#semipar.eCAR.Leroux'><p>R wrapper that accesses 'INLA' to fit semi-parametric Leroux CAR spatial regression model that accounts for spatial confounding.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Eigenvalue CAR Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Garritt L. Page &lt;page@stat.byu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits Leroux model in spectral domain to estimate causal spatial effect as detailed in 
             Guan, Y; Page, G.L.; Reich, B.J.; Ventrucci, M.; Yang, S; (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2012.11767">doi:10.48550/arXiv.2012.11767</a>&gt;.  
             Both the parametric and semi-parametric models are available.  The semi-parametric model 
             relies on 'INLA'.  The 'INLA' package can be obtained from <a href="https://www.r-inla.org/">https://www.r-inla.org/</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>INLA</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://inla.r-inla-download.org/R/stable/">https://inla.r-inla-download.org/R/stable/</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gpage2990/eCAR">https://github.com/gpage2990/eCAR</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-05 15:43:17 UTC; gpage</td>
</tr>
<tr>
<td>Author:</td>
<td>Garritt L. Page [aut, cre],
  Massimo Ventrucci [aut],
  S. McKay Curtis [cph],
  Radford M. Neal [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-05 16:33:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='eCAR.out'>eCAR class constructor</h2><span id='topic+eCAR.out'></span>

<h3>Description</h3>

<p>A constructor for the <code>eCAR</code> class. The class <code>eCAR</code> is a named list containing
the output from the calling the <code>par.eCAR.Leroux</code> or <code>semipar.eCAR.Leroux</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eCAR.out(
  data_model = NULL,
  beta_omega = NULL,
  posterior_draws = NULL,
  DIC = NULL,
  regrcoef = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eCAR.out_+3A_data_model">data_model</code></td>
<td>
<p>a characther indicating what data model was fit;</p>
</td></tr>
<tr><td><code id="eCAR.out_+3A_beta_omega">beta_omega</code></td>
<td>
<p>matrix containing estimated beta as a function of omega with 95% credible bands, and eigen-values;</p>
</td></tr>
<tr><td><code id="eCAR.out_+3A_posterior_draws">posterior_draws</code></td>
<td>
<p>a list containing the posterior draws of all model parameters;</p>
</td></tr>
<tr><td><code id="eCAR.out_+3A_dic">DIC</code></td>
<td>
<p>Deviance information criterion;</p>
</td></tr>
<tr><td><code id="eCAR.out_+3A_regrcoef">regrcoef</code></td>
<td>
<p>posterior summaries (mean, sd, 0.025quant, 0.975quant) for the regression coefs;</p>
</td></tr>
</table>

<hr>
<h2 id='lipcancer'>Number of recorded lip cancer cases in the 56 districts of Scotland.</h2><span id='topic+lipcancer'></span>

<h3>Description</h3>

<p>A list containing the data frame and neighborhood matrix based on 56 districts of Scotland that is with the following variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lipcancer
</code></pre>


<h3>Format</h3>

<p>data: A data frame with 56 rows and the following 6 variables:
</p>

<dl>
<dt>observed</dt><dd><p>observed number of cancer cases</p>
</dd>
<dt>expected</dt><dd><p>the expected number of lip cancer cases computed using indirect standardisation based on Scotland-wide disease rates</p>
</dd>
<dt>pcaff</dt><dd><p>percentage of the districtâ€™s workforce employed in agriculture, fishing and forestry</p>
</dd>
<dt>latitude</dt><dd><p>latitude coordinates</p>
</dd>
<dt>longitude</dt><dd><p>longitude coordinates</p>
</dd>
<dt>name</dt><dd><p>name</p>
</dd>
</dl>

<p>neighborhood.Matrix: A 56 x 56 matrix neighbhorhood matrix
</p>

<hr>
<h2 id='par.eCAR.Leroux'>R wrapper that accesses C code to fit parametric Leroux CAR spatial regression model that accounts for spatial confounding</h2><span id='topic+par.eCAR.Leroux'></span>

<h3>Description</h3>

<p><code>par.eCAR.Leroux</code> is the main function used to fit the parametric Leroux CAR model specified in the spectral domain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par.eCAR.Leroux(y, x, W,
                E=NULL,
                C=NULL,
                model="Gaussian",
                joint_prior_lamx_lamz = FALSE,
                lamx.fix.val = NULL,
                sig2x.fix.val = NULL,
                mb=0,s2b=10,
                mg=0,s2g=10.0,
                alamx=1, blamx=1,
                alamz=1, blamz=1,
                asig=1, bsig=1,
                atau=1, btau=1,
                asigx=1, bsigx=1,
                mb0=0,s2b0=100,
                me=0,s2e=100,
                mx=0,s2x=100,
                tau_cand_sd = 1,
                sig2_cand_sd = 1,
                draws=10000, burn=5000, thin=5,
                verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="par.eCAR.Leroux_+3A_y">y</code></td>
<td>
<p>response vector</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_x">x</code></td>
<td>
<p>covariate vector for which casual effect is desired</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_w">W</code></td>
<td>
<p>neighborhood matrix comprised of zeros and ones</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_e">E</code></td>
<td>
<p>This argument is ignored if model is Gaussian.  For other models it takes on the following:
</p>

<ul>
<li><p> Poisson - E is vector that contains expected counts
</p>
</li>
<li><p> Binomial - E is vector that contains number of trials
</p>
</li>
<li><p> Negative Binomial - E is vector that contains an offset.
</p>
</li></ul>

</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_c">C</code></td>
<td>
<p>design matrix for the covariates that are included as controls</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_model">model</code></td>
<td>
<p>Specifies the likelihood or data model.  Options are &quot;Gaussian&quot;, &quot;Poisson&quot;, &quot;Binomial&quot;, &quot;Negative Binomial&quot;</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_joint_prior_lamx_lamz">joint_prior_lamx_lamz</code></td>
<td>
<p>Logical.  If TRUE, then a uniform prior on space such that lamz &gt; lamx.  If FALSE, independent beta priors are used.  </p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_lamx.fix.val">lamx.fix.val</code></td>
<td>
<p>If a value is supplied then lambda_x is not updated in the MCMC algorithm, but rather treated as the fixed known supplied value</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_sig2x.fix.val">sig2x.fix.val</code></td>
<td>
<p>If a value is supplied then sigma2_x is not updated in the MCMC algorithm, but rather treated as the fixed known supplied value</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_mb">mb</code></td>
<td>
<p>prior mean for beta.  default is 0.</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_s2b">s2b</code></td>
<td>
<p>prior variance for beta. default is 10</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_mg">mg</code></td>
<td>
<p>prior mean for gamma, where gamma = rho*(sigz/sigx).  default is 0.</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_s2g">s2g</code></td>
<td>
<p>prior variance for, gamma), where gamma = rho*(sigz/sigx). default is 10</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_alamx">alamx</code></td>
<td>
<p>prior shape1 parameter for lam.x, default is 1. Only used if joint_prior_lamx_lamz = FALSE</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_blamx">blamx</code></td>
<td>
<p>prior shape2 parameter for lam.x, default is 1. Only used if joint_prior_lamx_lamz = FALSE</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_alamz">alamz</code></td>
<td>
<p>prior shape1 parameter for lam.z, default is 1. Only used if joint_prior_lamx_lamz = FALSE</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_blamz">blamz</code></td>
<td>
<p>prior shape2 parameter for lam.z, default is 1. Only used if joint_prior_lamx_lamz = FALSE</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_asig">asig</code></td>
<td>
<p>prior shape parameter for sigma2, default is 1. Only used if model is Gaussian</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_bsig">bsig</code></td>
<td>
<p>prior scale parameter for sigma2, default is 1. Only used if model is Gaussian</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_atau">atau</code></td>
<td>
<p>prior shape parameter for tau, where tau = sigma2.z*(1-rho^2). default is 1</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_btau">btau</code></td>
<td>
<p>prior scale parameter for tau, where tau = sigma2.z*(1-rho^2).  default is 1</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_asigx">asigx</code></td>
<td>
<p>prior shape parameter for sigma2.x, default is 1</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_bsigx">bsigx</code></td>
<td>
<p>prior scale parameter for sigma2.x, default is 1</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_mb0">mb0</code></td>
<td>
<p>prior mean parameter for beta0, default is 0.  Only used if model is not Gaussian</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_s2b0">s2b0</code></td>
<td>
<p>prior variance parameter for beta0, default is 100. Only used if model is not Gaussian</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_me">me</code></td>
<td>
<p>prior mean parameter for eta, default is 0. Only used if C is not NULL</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_s2e">s2e</code></td>
<td>
<p>prior variance parameter for eta, default is 100. Only used if C is not NULL</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_mx">mx</code></td>
<td>
<p>prior mean parameter for xi, default is 0. Only used for negative binomial model</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_s2x">s2x</code></td>
<td>
<p>prior variance parameter for eta, default is 100. Only used for negative binomial model</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_tau_cand_sd">tau_cand_sd</code></td>
<td>
<p>standard deviation for candidate density in Metropolis step for tau.  Default is 1</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_sig2_cand_sd">sig2_cand_sd</code></td>
<td>
<p>standard deviation for candidate density in Metropolis step for sig2.  Default is 1. Only used if model is Gaussian</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_draws">draws</code></td>
<td>
<p>number of MCMC iterates to be collected. default is 10000</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_burn">burn</code></td>
<td>
<p>number of MCMC iterates discared as burn-in. default is 5000</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_thin">thin</code></td>
<td>
<p>number by which the MCMC chain is thinned. default is 5</p>
</td></tr>
<tr><td><code id="par.eCAR.Leroux_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, then details associated with data being fit are printed to screen along with MCMC iterate counter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an <code>eCAR</code> object which is a list that contains the following
</p>
<table role = "presentation">
<tr><td><code>data_model</code></td>
<td>
<p>Character indicating which model was fit</p>
</td></tr>
<tr><td><code>beta_omega</code></td>
<td>
<p>Matrix that contains respectively, the posterior mean lower and upper quantiles of the (spatial scale)-varying beta at each omega value (for the non Gaussian cases it is the exponentiated beta).</p>
</td></tr>
<tr><td><code>posterior_draws</code></td>
<td>
<p>List containing posterior draws of the following parameters
</p>

<ol>
<li><p>beta: vector containing draws from the posterior distribution of exposure coefficient 
</p>
</li>
<li><p>gamma: vector containing draws from the posterior distribution of gamma=rho*(sigz/sigx)
</p>
</li>
<li><p>tau: vector containing draws from tau=sigma2.z*(1-rho^2)
</p>
</li>
<li><p>sig2x: vector containing draws from sig2x 
</p>
</li>
<li><p>lamx: vector containing draws from the posterior distribution of lamx 
</p>
</li>
<li><p>lamz: vector containing draws from the posterior distribution of lamz
</p>
</li>
<li><p>sigma2: vector containing draws from the posterior distribution of sigma2.  Only available if model is Gaussian
</p>
</li>
<li><p>rho: vector containing draws from the posterior distribution of rho
</p>
</li>
<li><p>sig2z: vector containing draws from the posterior distribution of sig2z
</p>
</li>
<li><p>theta: matrix containing draws from the posterior distribution of theta. Only available if model is not Gaussian
</p>
</li>
<li><p>beta0: vector containing draws from the posterior distribution of beta0. Only available if model is not Gaussian
</p>
</li>
<li><p>eta: matrix containing draws from the posterior distribution of eta, regression coefficients of additional confouner variables.  Only available if C is not NULL
</p>
</li>
<li><p>nb_r: matrix containing draws from the posterior distribution of nb_r.  0nly available if model is Negative Binomial
</p>
</li></ol>

</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Not available from parametric model yet</p>
</td></tr>
<tr><td><code>regrcoef</code></td>
<td>
<p>Not available from parametric model yet</p>
</td></tr>
</table>


<h3>References</h3>

<p>Guan, Y; Page, G.L.; Reich, B.J.; Ventrucci, M.; Yang, S; &quot;A spectral adjustment for spatial confounding&quot; &lt;arXiv:2012.11767&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Our R-package
library(eCAR)

data(lipcancer)


W &lt;- lipcancer$neighborhood.Matrix
M &lt;- diag(apply(W,1,sum))
R &lt;- M-W
e.dec &lt;- eigen(R)
e.val &lt;- e.dec$values
D.eigval = diag(e.val)


Y &lt;- lipcancer$data$observed
X &lt;- lipcancer$data$pcaff
E &lt;- lipcancer$data$expected

set.seed(101)
fit1 &lt;- par.eCAR.Leroux(y=Y, x=X, W=W, E=E, C=NULL, model="Poisson",
                         draws=10000, burn=5000, thin=1, verbose=FALSE,
                         joint_prior_lamx_lamz=FALSE)


plot(fit1)
</code></pre>

<hr>
<h2 id='plot'>Plot the spatial scale varying coefficient
</h2><span id='topic+plot.eCAR'></span>

<h3>Description</h3>

<p>This function takes the output obtained from the parametric or semiparametric fit and returns a plot of the spatial scale varying coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eCAR'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>

<p>an object of class eCAR (i.e. the output of the par.eCAR.Leroux() or semipar.eCAR.Leroux())
</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>

<p>include here other inputs to the plot function
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the estimated posterior mean and 95-th credible intervals for the effect of the covariate of interest as a function of eigenvalues.   If model is not Gaussian the exponential of the spatial scale varying coefficient is plotted which is useful in interpretating the covariate effect in the Binomial, Negative Binomial and Poisson models.
</p>

<hr>
<h2 id='semipar.eCAR.Leroux'>R wrapper that accesses 'INLA' to fit semi-parametric Leroux CAR spatial regression model that accounts for spatial confounding.</h2><span id='topic+semipar.eCAR.Leroux'></span>

<h3>Description</h3>

<p><code>semipar.eCAR.Leroux</code> is the main function used to fit the semi-parametric Leroux CAR model specified in the spectral domain.  This function calls 'INLA'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semipar.eCAR.Leroux(y, x, W,
                       E,
                       C=NULL,
                       names.covariates=NULL,
                       model="Gaussian",
                       L=10,
                       pcprior.sd=c(0.1,1),
                       s2=10,
                       method = "spectral",
                       num.threads.inla = NULL,
                       verbose=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="semipar.eCAR.Leroux_+3A_y">y</code></td>
<td>
<p>response vector</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_x">x</code></td>
<td>
<p>covariate vector for which casual effect is desired</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_w">W</code></td>
<td>
<p>neighborhood matrix comprised of zeros and ones</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_e">E</code></td>
<td>
<p>Offset value whose specification depends on the data model selected such that for
</p>
<p>* Poisson - E is vector that contains expected counts
</p>
<p>* Binomial - E is vector that contains number of trials
</p>
<p>* Negative Binomial - E is vector that contains an offset.
</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_c">C</code></td>
<td>
<p>design matrix for the covariates that are included as controls</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_names.covariates">names.covariates</code></td>
<td>
<p>Specifies the names of the covariates inside C</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_model">model</code></td>
<td>
<p>Specifies the likelihood or data model.  Options are &quot;Gaussian&quot;, &quot;Poisson&quot;, &quot;Binomial&quot;, &quot;Negative Binomial&quot;</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_l">L</code></td>
<td>
<p>Number of basis functions for the spline model on the (spatial scale)-varying beta. The smoothing method applied here is a Bayesian version of the P-spline approach by Eilers and Marx (1996), assuming a random walk on the spline coefficients and a PC-prior on the precision parameter of the random walk.</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_pcprior.sd">pcprior.sd</code></td>
<td>
<p>Vector of length 2 specifying the scaling parameters for the PC-priors assumed on the precision of the (spatial scale)-varying beta and the data y, respectively. Each of the scaling parameters can be interpreted as a guess on the marginal standard deviation (default are 0.1 and 1).</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_s2">s2</code></td>
<td>
<p>Prior variance for the log of the dispersion parameter (only used for model=&quot;Negative Binomial&quot;, default equal to 10).</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_method">method</code></td>
<td>
<p>A character defining the type of adjustment; either &quot;spectral&quot; (default choice) which implements the model assuming (spatial scale)-varying beta, or &quot;naive&quot; which implements the standard method with constant beta hence no spectral adjustment.</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_verbose">verbose</code></td>
<td>
<p>logical; if TRUE the verbose output from the &quot;inla&quot; call is printed.</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_num.threads.inla">num.threads.inla</code></td>
<td>
<p>Argument that indicates the number of computing cores that the INLA call will occupy.  For syntax, see &ldquo;inla.setOption&quot;</p>
</td></tr>
<tr><td><code id="semipar.eCAR.Leroux_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to the &quot;inla&quot; call; for instance control.inla=list(strategy=&quot;laplace&quot;)</p>
</td></tr></table>


<h3>Value</h3>

<p>A eCAR object which is a list containing the following
</p>
<table role = "presentation">
<tr><td><code>data_model</code></td>
<td>
<p>Character indicating which model was fit</p>
</td></tr>
<tr><td><code>beta_omega</code></td>
<td>
<p>Matrix that contains respectively, the posterior mean lower and upper quantiles of the (spatial scale)-varying beta at each omega value (for the non Gaussian cases it is the exponentiated beta).</p>
</td></tr>
<tr><td><code>posterior_draws</code></td>
<td>
<p>List containing posterior draws of the following parameters
</p>

<ol>
<li><p>postsample.beta: matrix of dim Lx1000, containing drawns from the posterior distribution of the L spline coefficients
</p>
</li>
<li><p>postsample.prec.beta: vector of length 1000, containing drawns from the posterior distribution of the precision of the random walk on the spline coefficients
</p>
</li>
<li><p>postsample.prec.z: vector of length 1000, containing drawns from the posterior distribution of prec.z
</p>
</li>
<li><p>postsample.lambda.z: vector of length 1000, containing drawns from the posterior distribution of lambda.z
</p>
</li>
<li><p>postsample.c.beta: vector of length 1000, containing drawns from the posterior distribution of the bias corrected beta (i.e. beta evaluated at the largest eigenvalue)
</p>
</li></ol>

</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion computed by 'INLA'</p>
</td></tr>
<tr><td><code>regrcoef</code></td>
<td>
<p>posterior summaries (mean, sd, 0.025quant, 0.975quant) for the regression coefs associated to the covariates inside 'C' (if model is Binomial, Poisson or Negative binomial, the posterior summaries refer to the exponentiated coef)</p>
</td></tr>
</table>


<h3>References</h3>

<p>Guan, Y; Page, G.L.; Reich, B.J.; Ventrucci, M.; Yang, S; &quot;A spectral adjustment for spatial confounding&quot; &lt;arXiv:2012.11767&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Our R-package
library(eCAR)

data(lipcancer)
W &lt;- lipcancer$neighborhood.Matrix
Y &lt;- lipcancer$data$observed
X &lt;- lipcancer$data$pcaff
E &lt;- lipcancer$data$expected


# only run example if INLA is installed.
if (requireNamespace("INLA", quietly = TRUE)) {
  fit1 = semipar.eCAR.Leroux(y=Y, x=X, W=W, E=E, C=NULL,
                                    pcprior.sd = c(0.1,1),
                                    model="Poisson",
                                    L=10,
                                    num.threads.inla = '1:1',
                                    verbose=FALSE)
  plot(fit1)
}

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
