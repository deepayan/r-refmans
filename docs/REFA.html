<!DOCTYPE html><html><head><title>Help for package REFA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {REFA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ECC'><p>Estimation of errors for common component</p></a></li>
<li><a href='#est_num'><p>Estimating Factor Numbers Corresponding  PCA</p></a></li>
<li><a href='#FA'>
<p>Principal Component Analysis for Factor Models</p></a></li>
<li><a href='#gendata'><p>Data generation process</p></a></li>
<li><a href='#REFA'>
<p>Robust Exponential Factor Analysis</p></a></li>
<li><a href='#REFA_FN'>
<p>Estimating Factor Numbers via Modified Rank Minimization</p></a></li>
<li><a href='#TR'><p>Trace ratios</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Exponential Factor Analysis</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-01</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiaqi Hu [cre, aut],
  Xueqin Wang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiaqi Hu &lt;hujiaqi@mail.ustc.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A robust alternative to the traditional principal component estimator is proposed within the framework of factor models, known as Robust Exponential Factor Analysis, specifically designed for the modeling of high-dimensional datasets with heavy-tailed distributions. The algorithm estimates the latent factors and the loading by minimizing the exponential squared loss function. To determine the appropriate number of factors, we propose a modified rank minimization technique, which has been shown to significantly enhance finite-sample performance.  </td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-18 03:28:45 UTC; hujiaqi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-19 15:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ECC'>Estimation of errors for common component</h2><span id='topic+ECC'></span>

<h3>Description</h3>

<p>Estimation of errors for common component</p>


<h3>Usage</h3>

<pre><code class='language-R'>ECC(Chat, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ECC_+3A_chat">Chat</code></td>
<td>
<p>The estimated common component</p>
</td></tr>
<tr><td><code id="ECC_+3A_c">C</code></td>
<td>
<p>The true common component</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value of the ECC
</p>


<h3>Author(s)</h3>

<p>Jiaqi Hu</p>


<h3>References</h3>

<p>Manuscript: Robust factor analysis with exponential squared loss</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat = gendata()
Y = dat$Y
F0 = dat$F0
L0 = dat$L0
C0 = F0 
res = REFA(dat$Y, r = 3)
Fhat = res$Fhat
Lhat = res$Lhat
Chat = Fhat 
ECC(Chat, C0)

</code></pre>

<hr>
<h2 id='est_num'>Estimating Factor Numbers Corresponding  PCA</h2><span id='topic+est_num'></span>

<h3>Description</h3>

<p>Estimating Factor Numbers Corresponding  PCA</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_num(X, kmax = 8, type = "BIC3")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_num_+3A_x">X</code></td>
<td>
<p>Input matrix, of dimension <code class="reqn">T\times N</code>. Each row is an observation with <code class="reqn">N</code> features at time point <code class="reqn">t</code>.</p>
</td></tr>
<tr><td><code id="est_num_+3A_kmax">kmax</code></td>
<td>
<p>The user-supplied maximum factor numbers.</p>
</td></tr>
<tr><td><code id="est_num_+3A_type">type</code></td>
<td>
<p>the method used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the estimated factor numbers
</p>


<h3>Author(s)</h3>

<p>Jiaqi Hu</p>


<h3>References</h3>

<p>Manuscript: Robust factor analysis with exponential squared loss</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat = gendata()
est_num(dat$Y)

</code></pre>

<hr>
<h2 id='FA'>
Principal Component Analysis for Factor Models
</h2><span id='topic+FA'></span>

<h3>Description</h3>

<p>Principal Component Analysis for Factor Models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FA(X, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FA_+3A_x">X</code></td>
<td>
<p>Input matrix, of dimension <code class="reqn">T\times N</code>. Each row is an observation with <code class="reqn">N</code> features at time point <code class="reqn">t</code>.</p>
</td></tr>
<tr><td><code id="FA_+3A_r">r</code></td>
<td>
<p>A positive integer indicating the factor numbers.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Fhat</code></td>
<td>
<p>The estimated factor matrix.</p>
</td></tr>
<tr><td><code>Lhat</code></td>
<td>
<p>The estimated loading matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jiaqi Hu</p>


<h3>References</h3>

<p>Manuscript: Robust factor analysis with exponential squared loss</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----


</code></pre>

<hr>
<h2 id='gendata'>Data generation process
</h2><span id='topic+gendata'></span>

<h3>Description</h3>

<p>Generate heavy-tailed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gendata(seed = 1, T = 50, N = 50, type = "1a")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gendata_+3A_seed">seed</code></td>
<td>
<p>the <code>seed</code> used in the data generation process.
</p>
</td></tr>
<tr><td><code id="gendata_+3A_t">T</code></td>
<td>
<p>time dimension.
</p>
</td></tr>
<tr><td><code id="gendata_+3A_n">N</code></td>
<td>
<p>cross-sectional dimension.
</p>
</td></tr>
<tr><td><code id="gendata_+3A_type">type</code></td>
<td>
<p>the type of the data generation process, it can be <code>"1a", "1b", "1c", "1d", "2a", "2b", "2c", "2d".</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list consisting of <code>Y, F0, L0</code>.
</p>


<h3>Author(s)</h3>

<p>Jiaqi Hu</p>


<h3>References</h3>

<p>Manuscript: Robust factor analysis with exponential squared loss</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat = gendata()
Y = dat$Y
head(Y)
</code></pre>

<hr>
<h2 id='REFA'>
Robust Exponential Factor Analysis
</h2><span id='topic+REFA'></span>

<h3>Description</h3>

<p>Robust Exponential Factor Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REFA(Y, r = 3, tau = 0.75, q = 0.05, eps = 1e-05, init = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="REFA_+3A_y">Y</code></td>
<td>
<p>Input matrix, of dimension <code class="reqn">T\times N</code>. Each row is an observation with <code class="reqn">N</code> features at time point <code class="reqn">t</code>.</p>
</td></tr>
<tr><td><code id="REFA_+3A_r">r</code></td>
<td>
<p>A positive integer indicating the factor numbers.</p>
</td></tr>
<tr><td><code id="REFA_+3A_q">q</code></td>
<td>
<p>Hyper parameter</p>
</td></tr>
<tr><td><code id="REFA_+3A_eps">eps</code></td>
<td>
<p>The stopping criterion parameter. The default is 1e-5.</p>
</td></tr>
<tr><td><code id="REFA_+3A_tau">tau</code></td>
<td>
<p>Hyper parameter</p>
</td></tr>
<tr><td><code id="REFA_+3A_init">init</code></td>
<td>
<p>Warn start of the algorithm. If <code>init = TRUE</code>, use modified PCA initialization. If <code>init</code> is a list contains <code>F0</code> and <code>L0</code>, we will use this initialization. Otherwise, use traditional PCA initialization.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Fhat</code></td>
<td>
<p>The estimated factor matrix.</p>
</td></tr>
<tr><td><code>Lhat</code></td>
<td>
<p>The estimated loading matrix.</p>
</td></tr>
<tr><td><code>loss</code></td>
<td>
<p>the value of the loss function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jiaqi Hu</p>


<h3>References</h3>

<p>Manuscript: Robust factor analysis with exponential squared loss</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat = gendata()
REFA(dat$Y, r = 3)

</code></pre>

<hr>
<h2 id='REFA_FN'>
Estimating Factor Numbers via Modified Rank Minimization
</h2><span id='topic+REFA_FN'></span>

<h3>Description</h3>

<p>Estimating Factor Numbers via Modified Rank Minimization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REFA_FN(Y, rmax = 8, tau = 0.75, q = 0.1, eps = 1e-04, init = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="REFA_FN_+3A_y">Y</code></td>
<td>
<p>Input matrix, of dimension <code class="reqn">T\times N</code>. Each row is an observation with <code class="reqn">N</code> features at time point <code class="reqn">t</code>.</p>
</td></tr>
<tr><td><code id="REFA_FN_+3A_rmax">rmax</code></td>
<td>
<p>The bound of the number of factors.</p>
</td></tr>
<tr><td><code id="REFA_FN_+3A_q">q</code></td>
<td>
<p>Hyper parameter in modified PCA algorithm. Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="REFA_FN_+3A_eps">eps</code></td>
<td>
<p>The stopping criterion parameter. Default is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="REFA_FN_+3A_tau">tau</code></td>
<td>
<p>Hyper parameter in selecting <code class="reqn">\gamma</code> of the loss function.</p>
</td></tr>
<tr><td><code id="REFA_FN_+3A_init">init</code></td>
<td>
<p>Warn start by modified PCA algorithm. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>rhat</code></td>
<td>
<p>The estimated factor number.</p>
</td></tr>
<tr><td><code>Fhat</code></td>
<td>
<p>The estimated factor matrix.</p>
</td></tr>
<tr><td><code>Lhat</code></td>
<td>
<p>The estimated loading matrix.</p>
</td></tr>
<tr><td><code>loss</code></td>
<td>
<p>the value of the loss function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jiaqi Hu</p>


<h3>References</h3>

<p>Manuscript: Robust factor analysis with exponential squared loss</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat = gendata()
REFA_FN(dat$Y, rmax = 8)

</code></pre>

<hr>
<h2 id='TR'>Trace ratios</h2><span id='topic+TR'></span>

<h3>Description</h3>

<p>Trace ratios</p>


<h3>Usage</h3>

<pre><code class='language-R'>TR(Fhat, F0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TR_+3A_fhat">Fhat</code></td>
<td>
<p>The estimated factors.</p>
</td></tr>
<tr><td><code id="TR_+3A_f0">F0</code></td>
<td>
<p>The true factors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value of the trace ratios.
</p>


<h3>Author(s)</h3>

<p>Jiaqi Hu</p>


<h3>References</h3>

<p>Manuscript: Robust factor analysis with exponential squared loss</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat = gendata()
Y = dat$Y
F0 = dat$F0
res = REFA(dat$Y, r = 3)
Fhat = res$Fhat
TR(Fhat, F0)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
