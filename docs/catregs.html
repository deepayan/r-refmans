<!DOCTYPE html><html lang="en"><head><title>Help for package catregs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {catregs}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compare.margins'><p>Compares two marginal effects (MEMs or AMEs). Estimate of uncertainty is from a simulated draw from a normal distribution.</p></a></li>
<li><a href='#count.fit'><p>Fits four different count models and compares them.</p></a></li>
<li><a href='#diagn'><p>Computes diagnostics for generalized linear models.</p></a></li>
<li><a href='#ess'>
<p>A subset of data from the European Social Survey</p></a></li>
<li><a href='#essUK'>
<p>A subset of data from the European Social Survey</p></a></li>
<li><a href='#first.diff.fitted'><p>Computes the first difference in fitted values, or a series of first differences. Inference in supported via the delta method or bootstrapping.</p></a></li>
<li><a href='#gss2016'>
<p>Data from the 2016 General Social Survey.</p></a></li>
<li><a href='#LF06art'>
<p>Data to replicate Long and Freese's (2006) count models (pp354-414)</p></a></li>
<li><a href='#LF06travel'>
<p>Travel time example data for alternative-specific outcomes.</p></a></li>
<li><a href='#list.coef'><p>Transform glm and mixed model objects into model summaries that include coefficients, standard errors, exponentiated coefficients, confidence intervals and percent change.</p></a></li>
<li><a href='#logan'>
<p>Replication data for Logan's (1983) application of conditional logistic regression to mobility processes.</p></a></li>
<li><a href='#margins.dat'><p>Add model predictions, standard errors and confidence intervals to a design matrix for a model object.</p></a></li>
<li><a href='#margins.dat.clogit'><p>Computes predicted probabilities for conditional and rank-order/exploded logistic regression models. Inference is based upon simulation techniques (requires the MASS package). Alternatively, bootstrapping is an option for conditional logistic regression models.</p></a></li>
<li><a href='#margins.des'><p>Creates a design matrix of idealized data for illustrating model predictions.</p></a></li>
<li><a href='#Mize19AH'>
<p>Add-Health Data analzed in Mize (2019)</p></a></li>
<li><a href='#Mize19GSS'>
<p>General Social Survey Data analzed in Mize (2019)</p></a></li>
<li><a href='#rubins.rule'><p>Aggregate Standard Errors using Rubin's Rule.</p></a></li>
<li><a href='#second.diff.fitted'><p>Computes the second difference in fitted values. Inference in supported via the delta method or bootstrapping.</p></a></li>
<li><a href='#wagepan'>
<p>Data to illustrate mixed effects regression models with serial correlation.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Post-Estimation Functions for Generalized Linear Mixed Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Several functions for working with mixed effects regression models for limited dependent variables. The functions facilitate post-estimation of model predictions or margins, and comparisons between model predictions for assessing or probing moderation. Additional helper functions facilitate model comparisons and implements simulation-based inference for model predictions of alternative-specific outcome models. See also, Melamed and Doan (2024, ISBN: 978-1032509518). </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tidyverse, ggplot2, MASS, emmeans, pscl, nnet,
marginaleffects, ggpubr, knitr, rmarkdown, Epi, dplyr, ordinal,
nlme, lme4</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-03 15:54:50 UTC; melamed.9</td>
</tr>
<tr>
<td>Author:</td>
<td>David Melamed <a href="https://orcid.org/0000-0002-8821-7698"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Melamed &lt;dmmelamed@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-04 17:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='compare.margins'>Compares two marginal effects (MEMs or AMEs). Estimate of uncertainty is from a simulated draw from a normal distribution.
</h2><span id='topic+compare.margins'></span>

<h3>Description</h3>

<p>Given two marginal effects (AMEs or MEMs), as estimated via the margins package or via first.diff.fitted, this function simulates draws from the distribution of MEs defined by the estimates and their standard error, and computes the overlap in the two distributions. The p-value refers to proportion of times the two draws overlapped.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare.margins(margins,margins.ses,seed=1234,rounded=3,nsim=10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare.margins_+3A_margins">margins</code></td>
<td>
<p>The two marginal effects that you want to compare.</p>
</td></tr>
<tr><td><code id="compare.margins_+3A_margins.ses">margins.ses</code></td>
<td>
<p>The standard errors for the marginal effects you want to compare.</p>
</td></tr>
<tr><td><code id="compare.margins_+3A_seed">seed</code></td>
<td>
<p>Random number seed so that results are reproducible.</p>
</td></tr>
<tr><td><code id="compare.margins_+3A_rounded">rounded</code></td>
<td>
<p>The number of decimal places to round the output. The default is 3.</p>
</td></tr>
<tr><td><code id="compare.margins_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulated AMEs to draw from each distribution. The default is 10,000.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>differnce</code></td>
<td>
<p>The observed difference in the two AMEs.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value associated with the difference. This is the proportion of the simulated sample when the MEs overlapped.</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("essUK")
m1 &lt;- glm(safe ~ religious + minority*female + age,data=essUK,family="binomial")
des&lt;-margins.des(m1,expand.grid(minority=c(0,1),female=c(0,1)))
des
ma1&lt;-suppressWarnings(as.data.frame(marginaleffects::avg_slopes(m1,
variables="female",newdata=data.frame(minority=0,religious=3.6024,age=53.146))))
ma2&lt;-as.data.frame(marginaleffects::avg_slopes(m1,variables="female",
newdata=data.frame(minority=1,religious=3.6024,age=53.146)))
cames &lt;- rbind(ma2,ma1)
compare.margins(margins=cames$estimate,margins.ses=cames$std.error)
</code></pre>

<hr>
<h2 id='count.fit'>Fits four different count models and compares them.
</h2><span id='topic+count.fit'></span>

<h3>Description</h3>

<p>Given a Poisson model object, count.fit fits Poisson, negative binomial, zero-inflated Poisson, and zero-inflated negative binomial models to the data. It reports results of Vuong tests between the zero-inflated and non-zer-inflated models, summarizes the information criteria of the four models, summarizes the model output of the four models, creates a ggplot object of coefficient plots for each model, and creates a ggplot object of model residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count.fit(m1,y.range,rounded=3,use.color="yes")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="count.fit_+3A_m1">m1</code></td>
<td>
<p>A Poisson regression model, as estimated via the glm function.</p>
</td></tr>
<tr><td><code id="count.fit_+3A_y.range">y.range</code></td>
<td>
<p>The observed response range for the count outcome. For example, if the observed range is 0 to 18, this would be 0:18</p>
</td></tr>
<tr><td><code id="count.fit_+3A_rounded">rounded</code></td>
<td>
<p>The number of decimal places to round the output. The default is 3.</p>
</td></tr>
<tr><td><code id="count.fit_+3A_use.color">use.color</code></td>
<td>
<p>Whether to use color in the ggplot objects. Default is &quot;yes&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ic</code></td>
<td>
<p>A data.frame summarizing the information criteria for the four models. Bayesian and Akaike's informaiton criteria are included.</p>
</td></tr>
<tr><td><code>models</code></td>
<td>
<p>A summary of the model estimates, including coefficients and standard errors.</p>
</td></tr>
<tr><td><code>pic</code></td>
<td>
<p>A ggplot object illustrating model residuals for each type of model.</p>
</td></tr>
<tr><td><code>models.pic</code></td>
<td>
<p>A ggplot object of coefficient plots from each type of model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("LF06art")
p1 &lt;- glm(art ~ fem + mar + kid5 + phd + ment , family = "poisson", data = LF06art)
table(LF06art$art)
fit&lt;-count.fit(p1,0:19)
names(fit)
</code></pre>

<hr>
<h2 id='diagn'>Computes diagnostics for generalized linear models.
</h2><span id='topic+diagn'></span>

<h3>Description</h3>

<p>Given a glm object, diagn returns case-level diagnostics.
For logistic, probit, Poisson, and negative binomial models, it returns Pearson residuals, standardized Pearson residuals, the diagonal of the hat matrix, delta-beta (Cook's D), and deviance residuals. For zero-inflated and hurdle models, it returns the Pearson residual and the observation number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagn(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagn_+3A_model">model</code></td>
<td>
<p>A model object. The model should be regression model for limited dependent variables, such as a logistic regression.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>out</code></td>
<td>
<p>The output is a dataframe of diagnostic statistics.
For logit, probit, Poisson, and negative binomial models, the output includes the Pearson residual (pearsonres), the diagonal of the Hat matrix (h), the standardized Pearson residual (stdpres), the delta-beta statistic (deltabeta), the observation number (obs), and the deviance residual (devres).
For zero-inflated and hurdle models, the output includes the Pearson residual (pearsonres), and the observation number (obs).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Mize19AH")
m1 &lt;- glm(alcB ~woman*parrole + age + race2 + race3 +
race4 + income + ed1 + ed2 + ed3 + ed4,
family="binomial",data=Mize19AH)
head(diagn(m1))
</code></pre>

<hr>
<h2 id='ess'>
A subset of data from the European Social Survey
</h2><span id='topic+ess'></span>

<h3>Description</h3>

<p>These are data from the European Social Survey used to illustrate mixed effects, multilevel, or hierarchical regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ess")</code></pre>


<h3>Format</h3>

<p>A data frame with 49519 observations on the following 37 variables.
</p>

<dl>
<dt><code>country</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>can.trust.people</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>people.try.fair</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>say.in.govt</code></dt><dd><p>a factor with levels <code>Not at all</code> <code>Very little</code> <code>Some</code> <code>A lot</code> <code>A great deal</code></p>
</dd>
<dt><code>trust.legal.sys</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>trust.police</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>vote</code></dt><dd><p>a factor with levels <code>Yes</code> <code>No</code> <code>Not eligible to vote</code></p>
</dd>
<dt><code>conservative</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>life.satisfaction</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>immigration.good.economy</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>happy</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>important.matters.people</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>walk.alone.dark</code></dt><dd><p>a factor with levels <code>Very unsafe</code> <code>Unsafe</code> <code>Safe</code> <code>Very safe</code></p>
</dd>
<dt><code>religious</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ethnic.minority</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>num.children</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ideal.age.parent</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>household.size</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>gender</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>marital</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>education</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>employment</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>income.decile</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>father.education</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>father.education.num</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>everyone.job.wanted</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>income.fairness</code></dt><dd><p>a factor with levels <code>Low, extremely unfair</code> <code>Low, very unfair</code> <code>Low, somewhat unfair</code> <code>Low, slightly unfair</code> <code>Fair</code> <code>High, slightly unfair</code> <code>High, somewhat unfair</code> <code>High, very unfair</code> <code>High, extremely unfair</code></p>
</dd>
<dt><code>under.over.paid</code></dt><dd><p>a factor with levels <code>Underpaid</code> <code>Right amount</code> <code>Overpaid</code></p>
</dd>
<dt><code>income.fairness.num</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>wealth.diff.fair</code></dt><dd><p>a factor with levels <code>Small, extremely unfair</code> <code>Small, very unfair</code> <code>Small, somewhat unfair</code> <code>Small, slightly unfair</code> <code>Fair</code> <code>Large, slightly unfair</code> <code>Large, somewhat unfair</code> <code>Large, very unfair</code> <code>Large, extremely unfair</code></p>
</dd>
<dt><code>wealth.differences</code></dt><dd><p>a factor with levels <code>Too little</code> <code>Just right</code> <code>Too much</code></p>
</dd>
<dt><code>gdp</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>urban.population</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>unemployment</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>alcolhol.consumption</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>suicide.rate</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>European Social Survey.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ess)
head(ess)
</code></pre>

<hr>
<h2 id='essUK'>
A subset of data from the European Social Survey
</h2><span id='topic+essUK'></span>

<h3>Description</h3>

<p>These are data from respondents in the United Kingdom from the European Social Survey. They are used to illustrate regression models for limited dependent variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("essUK")</code></pre>


<h3>Format</h3>

<p>A data frame with 2204 observations on the following 45 variables.
</p>

<dl>
<dt><code>country</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>can.trust.people</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>people.try.fair</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>say.in.govt</code></dt><dd><p>a factor with levels <code>Not at all</code> <code>Very little</code> <code>Some</code> <code>A lot</code> <code>A great deal</code></p>
</dd>
<dt><code>trust.legal.sys</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>trust.police</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>vote</code></dt><dd><p>a factor with levels <code>Yes</code> <code>No</code> <code>Not eligible to vote</code></p>
</dd>
<dt><code>conservative</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>life.satisfaction</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>immigration.good.economy</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>happy</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>important.matters.people</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>walk.alone.dark</code></dt><dd><p>a factor with levels <code>Very unsafe</code> <code>Unsafe</code> <code>Safe</code> <code>Very safe</code></p>
</dd>
<dt><code>religious</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ethnic.minority</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>num.children</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ideal.age.parent</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>household.size</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>gender</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>marital</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>education</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>employment</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>income.decile</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>father.education</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>father.education.num</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>everyone.job.wanted</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>income.fairness</code></dt><dd><p>a factor with levels <code>Low, extremely unfair</code> <code>Low, very unfair</code> <code>Low, somewhat unfair</code> <code>Low, slightly unfair</code> <code>Fair</code> <code>High, slightly unfair</code> <code>High, somewhat unfair</code> <code>High, very unfair</code> <code>High, extremely unfair</code></p>
</dd>
<dt><code>under.over.paid</code></dt><dd><p>a factor with levels <code>Underpaid</code> <code>Right amount</code> <code>Overpaid</code></p>
</dd>
<dt><code>income.fairness.num</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>wealth.diff.fair</code></dt><dd><p>a factor with levels <code>Small, extremely unfair</code> <code>Small, very unfair</code> <code>Small, somewhat unfair</code> <code>Small, slightly unfair</code> <code>Fair</code> <code>Large, slightly unfair</code> <code>Large, somewhat unfair</code> <code>Large, very unfair</code> <code>Large, extremely unfair</code></p>
</dd>
<dt><code>wealth.differences</code></dt><dd><p>a factor with levels <code>Too little</code> <code>Just right</code> <code>Too much</code></p>
</dd>
<dt><code>gdp</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>urban.population</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>unemployment</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>alcolhol.consumption</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>suicide.rate</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>safe</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>minority</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>female</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>divorced</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>married</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>widow</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>highinc</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>age2</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>European Social Survey.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(essUK)
head(essUK)</code></pre>

<hr>
<h2 id='first.diff.fitted'>Computes the first difference in fitted values, or a series of first differences. Inference in supported via the delta method or bootstrapping.
</h2><span id='topic+first.diff.fitted'></span>

<h3>Description</h3>

<p>first.diff.fitted computes first differences between fitted values from a regression model.
</p>
<p>Supported models include OLS regression via lm, logistic regression via glm, Poisson regression via glm, negative binomial regression via MASS:glm.nb, ordinal logistic regression via MASS::polr, partial proportional odds models via vgam::vglm, multinomial logistic regression via nnet::multinom, zero-inflated Poisson or negative binomial regression via pscl::zeroinfl, hurdle Poisson or negative binomial regression via pscl::hurdle, mixed effects logistic regression via lme4/lmerTest::glmer, mixed effects Poisson regression via lme4/lmerTest::glmer, mixed effects negative binomial regression via lme4/lmerTest::glmer.nb, and mixed effects ordinal logistic regression via ordinal::clmm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>first.diff.fitted(mod,design.matrix,compare,alpha=.05,rounded=3,
bootstrap="no",num.sample=1000,prop.sample=.9,data,seed=1234,cum.probs="no")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="first.diff.fitted_+3A_mod">mod</code></td>
<td>
<p>A model object. The model should be regression model for limited dependent variables, such as a logistic regression.</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_design.matrix">design.matrix</code></td>
<td>
<p>Design matrix of values for the independent variables in the regression model.</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_compare">compare</code></td>
<td>
<p>Pairs of rows in the design matrix to use for computing the fitted values. The first difference between the fitted values is then computed. For example, compare=c(4,2) means to compute the difference in the fitted values between predictions for row 4 of the design matrix and row 2 of the design matrix. If more than two rows are provided, the function uses them two at a time and computes multiple first differences.</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_alpha">alpha</code></td>
<td>
<p>The alpha value for confidence intervals. Default is .05.</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_rounded">rounded</code></td>
<td>
<p>The number of decimal places to round the output. The default is 3.</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_bootstrap">bootstrap</code></td>
<td>
<p>By default, inference is based on the Delta Method, as implemented in the marginaleffects package. Alternatively, inference can be based upon a bootstrapped sampling distirbution. To do so, change this to &quot;yes.&quot; Note that bootstrapping is only supported for one first difference at a time.</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_num.sample">num.sample</code></td>
<td>
<p>num.sample is the number samples drawn to compute the sampling distibution when using bootstrapping. Default is 1,000</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_prop.sample">prop.sample</code></td>
<td>
<p>prop.sample is the proportion of the original sample (with replacement) to include in the sampling distibution samples when using bootstrapping. Default is .9</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_data">data</code></td>
<td>
<p>For nonparametric inference, provide the data used in the original model statement.</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_seed">seed</code></td>
<td>
<p>For models using bootstrapped inference. The seed ensures reproducible results across runs. Default is 1234, but may be changed.</p>
</td></tr>
<tr><td><code id="first.diff.fitted_+3A_cum.probs">cum.probs</code></td>
<td>
<p>For ordinal logistic regression models, including mixed effects models, do you want the first differences to be based on probabilities of the response categories or cumulative probabilities of the response categories. The default is cum.probs==&quot;no&quot; corresponding to non-cumulative probabilities. Change cum.probs to &quot;yes&quot; for cumulative probabilities.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>out</code></td>
<td>
<p>If using parametric inference (delta method): output is a dataframe including the first fitted value (&quot;fitted1&quot;), the second fitted value (&quot;fitted2&quot;), the difference in fitted values (&quot;first.diff&quot;), the standard error (&quot;std.error&quot;), the lower limit (&quot;ll&quot;), and upper limit (&quot;ul&quot;) of the confidence interval. Of course, ll and ul are based on the alpha level.
If using nonparametric inference (bootstrapping): output is a list of objects. obs.diff is the observed difference in the response or fitted values. boot.dist is the sorted bootstrapped distribution of differences in the samples. mean.boot.dist is the average of the differences in the responses or fitted values. sd.boot.dist is the standard deviation of the sampling distribution. ci.95 is the Lower and Upper limits of the confidence interval; despite it's name, the confidence interval is based upon the alpha level. model.class is just the class of the model that was used to generate the fitted values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Mize19AH")
m1 &lt;- glm(alcB ~woman*parrole + age + race2 +
race3 + race4 + income + ed1 + ed2 + ed3 +
ed4,family="binomial",data=Mize19AH)
des2&lt;-margins.des(m1,expand.grid(woman=c(0,1),parrole=c(0,1)))
des2
first.diff.fitted(m1,des2,compare=c(4,2))
# Pr(Drink | Mothers) - Pr(Drink | Childless Women)

first.diff.fitted(m1,des2,compare=c(3,1))
# Pr(Drink | Fathers) - Pr(Drink | Childless Men)
</code></pre>

<hr>
<h2 id='gss2016'>
Data from the 2016 General Social Survey.
</h2><span id='topic+gss2016'></span>

<h3>Description</h3>

<p>Limited date from the 2016 General Social Survey on respondent and paternal class and occupational classifications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gss2016")</code></pre>


<h3>Format</h3>

<p>A data frame with 12498 observations on the following 13 variables.
</p>

<dl>
<dt><code>pclass</code></dt><dd><p>a factor with levels <code>Unskilled Manual</code> <code>Skilled Manual</code> <code>Self-Employed</code> <code>Non-Manual/Service</code> <code>Professional, Lower</code> <code>Professional, Higher</code></p>
</dd>
<dt><code>sclass</code></dt><dd><p>a factor with levels <code>Unskilled Manual</code> <code>Skilled Manual</code> <code>Self-Employed</code> <code>Non-Manual/Service</code> <code>Professional, Lower</code> <code>Professional, Higher</code></p>
</dd>
<dt><code>educ</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>race</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>id</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ2</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>occ</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>unskmanual</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>skmanual</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>selfemp</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>service</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>proflow</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>profhigh</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>The General Social Survey.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gss2016)
head(gss2016)
</code></pre>

<hr>
<h2 id='LF06art'>
Data to replicate Long and Freese's (2006) count models (pp354-414)
</h2><span id='topic+LF06art'></span>

<h3>Description</h3>

<p>For replication purposes between Stata and R. Long and Freese (2006) analyze these data to illustrate regression models for count dependent variables. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data("LF06art")</code></pre>


<h3>Format</h3>

<p>A data frame with 915 observations on the following 6 variables.
</p>

<dl>
<dt><code>art</code></dt><dd><p>count response</p>
</dd>
<dt><code>fem</code></dt><dd><p>dummy for sex</p>
</dd>
<dt><code>mar</code></dt><dd><p>dummy for married</p>
</dd>
<dt><code>kid5</code></dt><dd><p>number of children under five</p>
</dd>
<dt><code>phd</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ment</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Long, Scott J. and Jeremy Freese. 2006. &quot;Regression Models for Categorical Dependent Variables Using Stata.&quot; Austin, TX: Stata Press
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LF06art)
head(LF06art)
</code></pre>

<hr>
<h2 id='LF06travel'>
Travel time example data for alternative-specific outcomes.
</h2><span id='topic+LF06travel'></span>

<h3>Description</h3>

<p>Example data, also used in Long and Freese (2006), to illustrate conditional or fixed effects logistic regression. Also refered to as alternative-specific outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("LF06travel")</code></pre>


<h3>Format</h3>

<p>A data frame with 456 observations on the following 13 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>a numeric vector denoting nested units (individuals) or strata</p>
</dd>
<dt><code>mode</code></dt><dd><p>a numeric vector denoting mode of transit</p>
</dd>
<dt><code>train</code></dt><dd><p>a dummy variable for selecting the train</p>
</dd>
<dt><code>bus</code></dt><dd><p>a dummy variable for selecting the bus</p>
</dd>
<dt><code>car</code></dt><dd><p>a dummy variable for selecting a car</p>
</dd>
<dt><code>time</code></dt><dd><p>a numeric vector denoting transit time</p>
</dd>
<dt><code>invc</code></dt><dd><p>a numeric vector denoting invertng cost</p>
</dd>
<dt><code>choice</code></dt><dd><p>a numeric vector denoting the choice of travel, i.e. the dependent variable</p>
</dd>
<dt><code>ttme</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>invt</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>gc</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>hinc</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>psize</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Long, Scott J. and Jeremy Freese. 2006. &quot;Regression Models for Categorical Dependent Variables Using Stata.&quot; Austin, TX: Stata Press
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LF06travel)
head(LF06travel)
</code></pre>

<hr>
<h2 id='list.coef'>Transform glm and mixed model objects into model summaries that include coefficients, standard errors, exponentiated coefficients, confidence intervals and percent change.
</h2><span id='topic+list.coef'></span>

<h3>Description</h3>

<p>Given a glm model object or a mixed model model object, the function computes and returns: coefficients, standard errors, z-scores, confidence intervals, p-values, exponentiated coefficients, confidence intervals for exponentiated coefficients, and percent change.
</p>
<p>Supported models include logistic regression via the glm function, ordinal regression via mass::polr, multinomial regression via nnet:multinom, Poisson regression via the glm function, negative binomial regression via mass::glm.nb, mixed effects models for continuous outcomes with serial correlation via nlme::lme, mixed effects logistic and poisson regression via lme4::glmer, mixed effects negative binomial regression via lme4::glmer.nb, and mixed effects ordinal regression via ordinal::clmm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list.coef(model,rounded=3,alpha=.05)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list.coef_+3A_model">model</code></td>
<td>
<p>A model object. The model should be regression model for limited dependent variables, such as a logistic regression, or a mixed model from nlme or lme4/lmerTest.</p>
</td></tr>
<tr><td><code id="list.coef_+3A_rounded">rounded</code></td>
<td>
<p>The number of decimal places to round the output. The default is 3.</p>
</td></tr>
<tr><td><code id="list.coef_+3A_alpha">alpha</code></td>
<td>
<p>The alpha value for confidence intervals. Default is .05.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>b</code></td>
<td>
<p>The estimated model coefficients from the model object.</p>
</td></tr>
<tr><td><code>S.E.</code></td>
<td>
<p>The estimated model standard errors from the model object.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>The z-statistic corresponding to the coefficient.</p>
</td></tr>
<tr><td><code>LL CI</code></td>
<td>
<p>Given the coefficient, standard error and alpha value (default=.05), the lower limit of the confidence interval around the coefficient is reported.</p>
</td></tr>
<tr><td><code>UL CI</code></td>
<td>
<p>Given the coefficient, standard error and alpha value (default=.05), the upper limit of the confidence interval around the coefficient is reported.</p>
</td></tr>
<tr><td><code>p-val</code></td>
<td>
<p>The p-value associated with the z-statistic.</p>
</td></tr>
<tr><td><code>exp(b)</code></td>
<td>
<p>The exponentiated model coefficients. That is, odds ratios in the case of a logistic regression, or incidence rate ratios in the case of a count model.</p>
</td></tr>
<tr><td><code>LL CI for exp(b)</code></td>
<td>
<p>Given the exponentiated coefficient, standard error and alpha value (default=.05), the lower limit of the confidence interval around the exponentiated coefficient is reported.</p>
</td></tr>
<tr><td><code>UL CI for exp(b)</code></td>
<td>
<p>Given the exponentiated coefficient, standard error and alpha value (default=.05), the upper limit of the confidence interval around the exponentiated coefficient is reported.</p>
</td></tr>
<tr><td><code>Percent</code></td>
<td>
<p>The coefficients in terms of percent change. That is, 100*(exp(coef(model))-1)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Mize19AH")
m1 &lt;- glm(alcB ~woman*parrole + age + race2 +
race3 + race4 + income + ed1 + ed2 + ed3 +
ed4,family="binomial",data=Mize19AH)
list.coef(m1,rounded=4)
list.coef(m1,rounded=4,alpha=.01)
</code></pre>

<hr>
<h2 id='logan'>
Replication data for Logan's (1983) application of conditional logistic regression to mobility processes.
</h2><span id='topic+logan'></span>

<h3>Description</h3>

<p>Replication data for Logan's (1983) application of conditional logistic regression to mobility processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("logan")</code></pre>


<h3>Format</h3>

<p>A data frame with 4190 observations on the following 11 variables.
</p>

<dl>
<dt><code>occupation</code></dt><dd><p>respondent occupation with levels <code>farm</code> <code>operatives</code> <code>craftsmen</code> <code>sales</code> <code>professional</code></p>
</dd>
<dt><code>focc</code></dt><dd><p>paternal occupation, i.e., father's occupation with levels <code>farm</code> <code>operatives</code> <code>craftsmen</code> <code>sales</code> <code>professional</code></p>
</dd>
<dt><code>education</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>race</code></dt><dd><p>a factor with levels <code>non-black</code> <code>black</code></p>
</dd>
<dt><code>id</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tocc</code></dt><dd><p>a factor with levels <code>farm</code> <code>operatives</code> <code>craftsmen</code> <code>sales</code> <code>professional</code></p>
</dd>
<dt><code>case</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>craftsmen</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>farm</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>operatives</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>professional</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Logan, John A. 1983. “A Multivariate Model for Mobility Tables.” American Journal of Sociology 89(2):324–349.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(logan)
head(logan)
</code></pre>

<hr>
<h2 id='margins.dat'>Add model predictions, standard errors and confidence intervals to a design matrix for a model object.
</h2><span id='topic+margins.dat'></span>

<h3>Description</h3>

<p>Given a model object and a design matrix, this creates a data.frame of the design matrix, with model predictions, standard errors and lower/upper limits of confidence intervals around the predictions. This is a wrap around function for calls to emmeans; it adjusts the emmeans equation to return fitted values on the response scale.
</p>
<p>Supported models include OLS regression via lm, logistic regression via glm, Poisson regression via glm, negative binomial regression via MASS:glm.nb, ordinal logistic regression via MASS::polr, multinomial logistic regression via nnet::multinom, zero-inflated Poisson or negative binomial regression via pscl::zeroinfl, hurdle Poisson or negative binomial regression via pscl::hurdle, linear mixed effects models with or without serial correlation via nlme::lme, linear mixed effects models via lme4/lmerTest::lmer, mixed effects logistic regression via lme4/lmerTest::glmer, mixed effects Poisson regression via lme4/lmerTest::glmer, mixed effects negative binomial regression via lme4/lmerTest::glmer.nb, and mixed effects ordinal logistic regression via ordinal::clmm.
</p>
<p>For mixed effects ordinal logistic regression models, as estimated via the ordinal package, the outcome variable in the regression model (i.e., the clmm function) needs to be named &quot;dv.&quot;
</p>
<p>Given one of these model objects and an appropiate design matrix, the function detects the model response type and generates fitted values on the response scale. For example, a logistic regression model returns predicted probabilities, and a Poisson model returns the fitted counts. In addition to the fitted values, the function returns the delta method standard error for the fitted value and a confidence interval. The confidence interval is 95 percent by default, but that may be changed by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margins.dat(mod,des,alpha=.05,rounded=3,cumulate="no",
pscl.data=data,num.sample=1000,prop.sample=.9,seed=1234)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="margins.dat_+3A_mod">mod</code></td>
<td>
<p>A regression model object.</p>
</td></tr>
<tr><td><code id="margins.dat_+3A_des">des</code></td>
<td>
<p>Design matrix of values for the independent variables in the regression model.</p>
</td></tr>
<tr><td><code id="margins.dat_+3A_alpha">alpha</code></td>
<td>
<p>The alpha value for confidence intervals. Default is .05.</p>
</td></tr>
<tr><td><code id="margins.dat_+3A_rounded">rounded</code></td>
<td>
<p>The number of decimal places to round the output. The default is 3.</p>
</td></tr>
<tr><td><code id="margins.dat_+3A_cumulate">cumulate</code></td>
<td>
<p>Whether the fitted values should reflect cumulative probabilities. Default is &quot;no.&quot; Intended for predicted probabilities drawn from ordinal logistic regression models (polr) or mixed effects ordinal logistic regression (clmm).</p>
</td></tr>
<tr><td><code id="margins.dat_+3A_pscl.data">pscl.data</code></td>
<td>
<p>If generating predicted counts from Zero-Inflated models (either Poisson or negative binomial), you need to include the data that was specified in the model statement, i.e., the data in the &quot;mod&quot; object.</p>
</td></tr>
<tr><td><code id="margins.dat_+3A_num.sample">num.sample</code></td>
<td>
<p>num.sample is the number samples drawn to compute the sampling distibution.</p>
</td></tr>
<tr><td><code id="margins.dat_+3A_prop.sample">prop.sample</code></td>
<td>
<p>prop.sample is the proportion of the original sample to include in the sampling distibution samples. Default is .9</p>
</td></tr>
<tr><td><code id="margins.dat_+3A_seed">seed</code></td>
<td>
<p>For models using bootstrapped inference. The seed ensures reproducible results across runs. Default is 1234, but may be changed.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>marginsdat</code></td>
<td>
<p>Returns a data.frame containing the design matrix and additional columns for the fitted value on the response scale, the delta method standard error (except partial proportional odds models, which are bootstrapped), and the lower/upper limits on confidence intervals around the fitted value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Mize19AH")
m1 &lt;- glm(alcB ~woman*parrole + age +
race2 + race3 + race4 + income + ed1 +
ed2 + ed3 + ed4,family="binomial",data=Mize19AH)
des2&lt;-margins.des(m1,expand.grid(woman=c(0,1),parrole=c(0,1)))
margins.dat(m1,des2,rounded=5)
des1 &lt;- margins.des(m1,expand.grid(parrole=1,woman=1))
margins.dat(m1,des1,rounded=5)
des3 &lt;- margins.des(m1,expand.grid(age=seq(20,75,5),parrole=c(0,1)))
a&lt;- margins.dat(m1,des3,rounded=5)
a # Then plot a using ggplot
</code></pre>

<hr>
<h2 id='margins.dat.clogit'>Computes predicted probabilities for conditional and rank-order/exploded logistic regression models. Inference is based upon simulation techniques (requires the MASS package). Alternatively, bootstrapping is an option for conditional logistic regression models.
</h2><span id='topic+margins.dat.clogit'></span>

<h3>Description</h3>

<p>Given a model object and a design matrix, this creates a data.frame of the design matrix, with predicted probabilities for each response category. Inferential information about the predict probabilities is supported with simulation. Bootstrapping may be added as an option for conditional logistic regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margins.dat.clogit(mod,design.matrix,run.boot="no",num.sample=1000,
prop.sample=.9,alpha=.05,seed=1234,rounded=3)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="margins.dat.clogit_+3A_mod">mod</code></td>
<td>
<p>A conditional logistic regression model as estimated in the Epi package or an Exploded logistic regression model as estimated in the mlogit package.
</p>
</td></tr>
<tr><td><code id="margins.dat.clogit_+3A_design.matrix">design.matrix</code></td>
<td>
<p>Design matrix of values for the independent variables in the regression model. Unlike the design matrices in the margins.des function, the design matrix for a conditional logistic regression entails multiple rows, corresponding to the number of response options.</p>
</td></tr>
<tr><td><code id="margins.dat.clogit_+3A_run.boot">run.boot</code></td>
<td>
<p>Whether to compute confidence intervals around the predicted probabilities using bootstrapping. Defaul is &quot;no.&quot;</p>
</td></tr>
<tr><td><code id="margins.dat.clogit_+3A_num.sample">num.sample</code></td>
<td>
<p>num.sample is the number samples drawn to compute the sampling distibution.</p>
</td></tr>
<tr><td><code id="margins.dat.clogit_+3A_prop.sample">prop.sample</code></td>
<td>
<p>prop.sample is the proportion of the original sample to include in the sampling distibution samples. Default is .9</p>
</td></tr>
<tr><td><code id="margins.dat.clogit_+3A_alpha">alpha</code></td>
<td>
<p>The alpha value for confidence intervals. Default is .05.</p>
</td></tr>
<tr><td><code id="margins.dat.clogit_+3A_seed">seed</code></td>
<td>
<p>Sets a seed so that random results are reprodicible.</p>
</td></tr>
<tr><td><code id="margins.dat.clogit_+3A_rounded">rounded</code></td>
<td>
<p>How many decimal places to show in the output.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>des</code></td>
<td>
<p>Returns a data.frame containing the design matrix and additional columns for the predicted probabilities.</p>
</td></tr>
<tr><td><code>boot.dist</code></td>
<td>
<p>The full bootstrapped distribution for the probabilities.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("LF06travel")
m1 &lt;- Epi::clogistic(choice ~ train + bus +
time  + invc, strata=id, data=LF06travel)
design &lt;- data.frame(train=c(0,0,1),bus=c(0,1,0),time=200,invc=20)
design
margins.dat.clogit(m1,design)
</code></pre>

<hr>
<h2 id='margins.des'>Creates a design matrix of idealized data for illustrating model predictions.
</h2><span id='topic+margins.des'></span>

<h3>Description</h3>

<p>Create a data frame of idealized data for making model predictions/predicted margins that will be used with margins.dat for generating/plotting model predictions.
Given a model object (generalized linear model or generalized linear mixed model), a grid of independent variable values, and a list of any variables (factor variables in particular) to exclude from the design matrix, the function returns the design matrix as a data.frame object. All covariates are set to their means in the data used to estimate the model object. If there are factors in the model, they need to be excluded using the &quot;excl&quot; option.
</p>
<p>Supported models include OLS via the lm function, logistic and Poisson regression via the glm function, negative binomial regression via MASS::glm.nb, ordinal logistic regression via MASS::polr, multinomial logistic regression via nnet::multinom, partial proportional odds models via vgam::vglm, linear mixed effects models with or without serial correlation specified via nlme::lme, mixed effects logistic regression via lme4::glmer, mixed effects Poisson regression via lme4::glmer, mixed effects negative binomial regression via lme4::glmer.nb, and mixed effects ordinal logistic regression via ordinal::clmm. Zero-inflated and hurdle models are also supported via pscl::zeroinfl and pscl::hurdle, respectively.
</p>
<p>For multinomial regression model, as estimated via the nnet package, you need to provide the data used in the nnet function that defined the model.
For partial proportional odds models, as estimated via the vgam package, you need to specify an ordinal model via MASS::polr and provide that model to the margins.des function (the data for the model are not part of a vgam object.)
For mixed effects regression models, as estimated by lme4/lmerTest, you need to provide the data used in the glmer or lmer function that defined the model.
For mixed effects ordinal logistic regression models, as estimated via the ordinal package, the outcome variable in the regression model (i.e., the clmm function) needs to be named &quot;dv.&quot;</p>


<h3>Usage</h3>

<pre><code class='language-R'>margins.des(mod,ivs,excl="nonE",data)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="margins.des_+3A_mod">mod</code></td>
<td>
<p>A model object. The model should be regression model for limited dependent variables, such as a logistic regression. Specifically, supported models include lm, glm, polr, multinom, vgam, zeroinf (pscl), amd hurdle (pscl). vgam is supported for partial proportional odds models, not models for count outcomes. zerotrunc is only supported with bootstrapped inference, and may take a while.
</p>
</td></tr>
<tr><td><code id="margins.des_+3A_ivs">ivs</code></td>
<td>
<p>This should be an 'expand.grid' statement including all desired variables and their corresponding levels in the design matrix.</p>
</td></tr>
<tr><td><code id="margins.des_+3A_excl">excl</code></td>
<td>
<p>If you want to exclude covariates from the design matrix, you can list them here. This is designed to exclude factor variables from the design matrix, as they do not have means, but may be useful in other specialized cases. Default is &quot;nonE,&quot; corresponding to excluding none of the variables.</p>
</td></tr>
<tr><td><code id="margins.des_+3A_data">data</code></td>
<td>
<p>If the model is a multinomial model, you also need to provide the data. This is because nnet objects do not include the relevant information for computing the means of covariates.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>design</code></td>
<td>
<p>Returns a data.frame containing the design matrix for model predictions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Mize19AH")
m1 &lt;- glm(alcB ~woman*parrole + age + race2 +
race3 + race4 + income + ed1 + ed2 + ed3 +
ed4,family="binomial",data=Mize19AH)
des1 &lt;- margins.des(m1,expand.grid(parrole=1,woman=1))
des1
des2&lt;-margins.des(m1,expand.grid(woman=c(0,1),parrole=c(0,1)))
des2
des3 &lt;- margins.des(m1,expand.grid(age=seq(20,75,5),parrole=c(0,1)))
des3
</code></pre>

<hr>
<h2 id='Mize19AH'>
Add-Health Data analzed in Mize (2019)
</h2><span id='topic+Mize19AH'></span>

<h3>Description</h3>

<p>Mize (2019) illustrates how to establish moderation in the context of regression models for limited dependent variables. He illustrates using AddHealth data and provides Stata code to replicate the results. Catregs functions can replicate these results in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Mize19AH")</code></pre>


<h3>Format</h3>

<p>A data frame with 4307 observations on the following 29 variables.
</p>

<dl>
<dt><code>AID</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>race</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>educ</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>degree</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>college</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>health</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>role</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>workrole</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>parrole</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>income</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>wages</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>logwages</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>depB</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>alcB</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>woman</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>edyrs</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>whiteB</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>X_est_prno</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>X_est_prpar</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>X_est_alcedmod</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>X_est_alcmod</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>race2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>race3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>race4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ed1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ed2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ed3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ed4</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mize, Trenton D. 2019. &quot;Best Practices for Estimating, Interpreting, and
Presenting Nonlinear Interaction Effects&quot; Sociological Science 6: 81-117.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Mize19AH)
head(Mize19AH)
</code></pre>

<hr>
<h2 id='Mize19GSS'>
General Social Survey Data analzed in Mize (2019)</h2><span id='topic+Mize19GSS'></span>

<h3>Description</h3>

<p>Mize (2019) illustrates how to establish nonlinear moderation in the context of regression models. He illustrates using General Social Survey (GSS) data and provides Stata code to replicate the results. Catregs functions can replicate these results in R.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Mize19GSS")</code></pre>


<h3>Format</h3>

<p>A data frame with 19337 observations on the following 42 variables.
</p>

<dl>
<dt><code>nosameB</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>sameokB</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>polviews</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>age10</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>year</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>id</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>degree</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>race</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>partyid</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natspac</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natenvir</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natheal</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natcity</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natcrime</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natdrug</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>nateduc</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natrace</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natarms</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>nataid</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>natfare</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>health</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>helpnotB</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>conserv</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>polviews3</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>employed</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>male</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>woman</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>white</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>college</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>married</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>parent</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>edyrs</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>income</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>hrswork</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>parttime</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>wages</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>conviewSS</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>year2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>yearcat</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>year1976</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>year1976.2</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mize, Trenton D. 2019. &quot;Best Practices for Estimating, Interpreting, and
Presenting Nonlinear Interaction Effects&quot; Sociological Science 6: 81-117.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Mize19GSS)
head(Mize19GSS)
</code></pre>

<hr>
<h2 id='rubins.rule'>Aggregate Standard Errors using Rubin's Rule.
</h2><span id='topic+rubins.rule'></span>

<h3>Description</h3>

<p>The function takes a vector of standard error estimates and it pools them using Rubin's rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rubins.rule(std.errors)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rubins.rule_+3A_std.errors">std.errors</code></td>
<td>
<p>A vector of standard errors to be aggregated using Rubin's rule.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>r.r.std.error</code></td>
<td>
<p>The aggregated standard error.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>References</h3>

<p>Rubin, Donald B. 2004. Multiple Imputation for Nonresponse in Surveys. Vol. 81. John Wiley &amp; Sons.
</p>

<hr>
<h2 id='second.diff.fitted'>Computes the second difference in fitted values. Inference in supported via the delta method or bootstrapping.
</h2><span id='topic+second.diff.fitted'></span>

<h3>Description</h3>

<p>second.diff.fitted computes the second differences between fitted values, that is, the difference between two first differences, from a regression model.
</p>
<p>Supported models include OLS regression via lm, logistic regression via glm, Poisson regression via glm, negative binomial regression via MASS:glm.nb, ordinal logistic regression via MASS::polr, partial proportional odds models via vgam::vglm, multinomial logistic regression via nnet::multinom, zero-inflated Poisson or negative binomial regression via pscl::zeroinfl, hurdle Poisson or negative binomial regression via pscl::hurdle, mixed effects logistic regression via lme4/lmerTest::glmer, mixed effects Poisson regression via lme4/lmerTest::glmer, mixed effects negative binomial regression via lme4/lmerTest::glmer.nb, and mixed effects ordinal logistic regression via ordinal::clmm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second.diff.fitted(mod,design.matrix,compare,alpha=.05,rounded=3,
bootstrap="no",num.sample=1000,prop.sample=.9,
data,seed=1234,cum.probs="no")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="second.diff.fitted_+3A_mod">mod</code></td>
<td>
<p>A model object. The model should be regression model for limited dependent variables, such as a logistic regression.</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_design.matrix">design.matrix</code></td>
<td>
<p>Design matrix of values for the independent variables in the regression model.</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_compare">compare</code></td>
<td>
<p>A set of four rows in the design matrix to use for computing the fitted values that are used in the calculation of second differences. For example, compare(a,b,c,d) results in computing the fitted values for rows a, b, c, and d of the design matrix, respectively, and then computing the following second difference: (a - b) - (c - d). Only four rows may be compared at a time.</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_alpha">alpha</code></td>
<td>
<p>The alpha value for confidence intervals. Default is .05.</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_rounded">rounded</code></td>
<td>
<p>The number of decimal places to round the output. The default is 3.</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_bootstrap">bootstrap</code></td>
<td>
<p>By default, inference is based on the Delta Method, as implemented in the marginaleffects package. Alternatively, inference can be based upon a bootstrapped sampling distirbution. To do so, change this to &quot;yes&quot;</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_num.sample">num.sample</code></td>
<td>
<p>num.sample is the number samples drawn to compute the sampling distibution when using bootstrapping. Default is 1,000</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_prop.sample">prop.sample</code></td>
<td>
<p>prop.sample is the proportion of the original sample to include in the sampling distibution samples when using bootstrapping. Default is .9</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_data">data</code></td>
<td>
<p>For nonparametric inference, provide the data used in the original model statement.</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_seed">seed</code></td>
<td>
<p>For models using bootstrapped inference. The seed ensures reproducible results across runs. Default is 1234, but may be changed.</p>
</td></tr>
<tr><td><code id="second.diff.fitted_+3A_cum.probs">cum.probs</code></td>
<td>
<p>For ordinal logistic regression models, including mixed effects models, do you want the first differences to be based on probabilities of the response categories or cumulative probabilities of the response categories. The default is cum.probs==&quot;no&quot; corresponding to non-cumulative probabilities. Change cum.probs to &quot;yes&quot; for cumulative probabilities.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>out</code></td>
<td>
<p>If using parametric inference (delta method): output is a dataframe including the second difference in fitted values (&quot;est&quot;), the standard error (&quot;std.error&quot;), the lower limit (&quot;ll&quot;), and upper limit (&quot;ul&quot;) of the confidence interval. Of course, ll and ul are based on the alpha level.
If using nonparametric inference (bootstrapping): output is a list of objects. obs.diff is the observed second difference in the response or fitted values. boot.dist is the sorted bootstrapped distribution of second differences in the samples. mean.boot.dist is the average of the second differences in the responses or fitted values. sd.boot.dist is the standard deviation of the sampling distribution. ci.95 is the Lower and Upper limits of the confidence interval; despite it's name, the confidence interval is based upon the alpha level. model.class is just the class of the model that was used to generate the fitted values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Melamed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Mize19AH")
m1 &lt;- glm(alcB ~woman*parrole + age + race2 + race3 +
race4 + income + ed1 + ed2 + ed3 +
ed4,family="binomial",data=Mize19AH)
des2&lt;-margins.des(m1,expand.grid(woman=c(0,1),parrole=c(0,1)))
des2
second.diff.fitted(m1,des2,compare=c(4,2,3,1),rounded=5)
# [Pr(Drink | Mothers) - Pr(Drink | Childless Women)] -
# [Pr(Drink | Fathers) - Pr(Drink | Childless Men)]

# Note that this is reported as the "Second Difference" in
# Table 3 of Mize (2019: 104, "Best Practices for Estimating,
# Interpreting, and Presenting Nonlinear Interaction Effect.
# Sociological Science. 6(4): 81-117.")
</code></pre>

<hr>
<h2 id='wagepan'>
Data to illustrate mixed effects regression models with serial correlation.
</h2><span id='topic+wagepan'></span>

<h3>Description</h3>

<p>Replication data illustrating serial correlation specifications to adjust for correlated residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("wagepan")</code></pre>


<h3>Format</h3>

<p>A data frame with 4360 observations on the following 51 variables.
</p>

<dl>
<dt><code>nr</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>year</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>agric</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>black</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>bus</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>construc</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ent</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>exper</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>fin</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>hisp</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>poorhlth</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>hours</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>manuf</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>married</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>min</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nrthcen</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nrtheast</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ5</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ6</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ7</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ8</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>occ9</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>per</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>pro</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>pub</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>rur</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>south</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>educ</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>tra</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>trad</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>union</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>lwage</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>d81</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>d82</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>d83</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>d84</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>d85</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>d86</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>d87</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>expersq</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>r</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>num</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>number</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>mn_lwage</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>yeart</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>yeart2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>yeart3</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(wagepan)
head(wagepan)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
