<!DOCTYPE html><html><head><title>Help for package Barnard</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Barnard}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Barnard'>
<p>Barnard's Unconditional Test</p></a></li>
<li><a href='#barnard.test'><p> Barnard's Unconditional Test</p></a></li>
<li><a href='#barnardw.test'><p> Barnard's Unconditional Test with Wald Statistics (obsolete)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Barnard's Unconditional Test</td>
</tr>
<tr>
<td>Version:</td>
<td>1.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-10-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Kamil Erguler</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kamil Erguler &lt;k.erguler@cyi.ac.cy&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Barnard's unconditional test for 2x2 contingency tables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kerguler/Barnard">https://github.com/kerguler/Barnard</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-10-20 10:21:54 UTC; kamil</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-10-20 22:09:29</td>
</tr>
</table>
<hr>
<h2 id='Barnard'>
Barnard's Unconditional Test
</h2><span id='topic+Barnard'></span>

<h3>Description</h3>

<p>This package implements the <code>barnard.test</code> function for performing Barnard's unconditional test of superiority.
This is a more powerful alternative of Fisher's exact test for 2x2 contingency tables. The test, in its current implementation, uses Wald statistics as a measure of difference between two binomial proportions.
</p>


<h3>Author(s)</h3>


<ol>
<li><p> Kamil Erguler, Post-doctoral Fellow, EEWRC, The Cyprus Institute <a href="mailto:k.erguler@cyi.ac.cy">k.erguler@cyi.ac.cy</a>
</p>
</li></ol>



<h3>References</h3>


<ol>
<li><p> Barnard, G.A. (1945) A new test for 2x2 tables. <em>Nature</em>, 156:177.
</p>
</li>
<li><p> Barnard, G.A. (1947) Significance tests for 2x2 tables. <em>Biometrika</em>, 34:123-138.
</p>
</li></ol>


<hr>
<h2 id='barnard.test'> Barnard's Unconditional Test</h2><span id='topic+barnard.test'></span>

<h3>Description</h3>

<p>Barnard's unconditional test for superiority applied to 2x2 contingency tables
using Score or Wald statistics for the difference between two binomial proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>barnard.test(n1, n2, n3, n4, dp = 0.001, pooled = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barnard.test_+3A_n1">n1</code>, <code id="barnard.test_+3A_n2">n2</code>, <code id="barnard.test_+3A_n3">n3</code>, <code id="barnard.test_+3A_n4">n4</code></td>
<td>
<p> Elements of the 2x2 contingency table </p>
</td></tr>
<tr><td><code id="barnard.test_+3A_dp">dp</code></td>
<td>
<p> The resolution to search for the nuisance parameter </p>
</td></tr>
<tr><td><code id="barnard.test_+3A_pooled">pooled</code></td>
<td>
<p> Z statistic with pooled (Score) or unpooled (Wald) variance </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a 2x2 contingency table, such as <code class="reqn">X=[n_1,n_2;n_3,n_4]</code>, the normalized difference in proportions between the two categories, given in each column, can be written with pooled variance (Score statistic) as
</p>
<p style="text-align: center;"><code class="reqn">T(X)=\frac{\hat{p}_2-\hat{p}_1}{\sqrt{\hat{p}(1-\hat{p})(\frac{1}{c_1}+\frac{1}{c_2})}},</code>
</p>

<p>where <code class="reqn">\hat{p}=(n_1+n_3)/(n_1+n_2+n_3+n_4)</code>, <code class="reqn">\hat{p}_2=n_2/(n_2+n_4)</code>, <code class="reqn">\hat{p}_1=n_1/(n_1+n_3)</code>, <code class="reqn">c_1=n_1+n_3</code> and <code class="reqn">c_2=n_2+n_4</code>. Alternatively, with unpooled variance (Wald statistic), the difference in proportions can we written as
</p>
<p style="text-align: center;"><code class="reqn">T(X)=\frac{\hat{p}_2-\hat{p}_1}{\sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{c_1}+\frac{\hat{p}_2(1-\hat{p}_2)}{c_2}}}.</code>
</p>

<p>The probability of observing <code class="reqn">X</code> is
</p>
<p style="text-align: center;"><code class="reqn">P(X)=\frac{c_1!c_2!}{n_1!n_2!n_3!n_4!}p^{n_1+n_2}(1-p)^{n_3+n_4},</code>
</p>

<p>where <code class="reqn">p</code> is the unknown nuisance parameter.
</p>
<p>Barnard's test considers all tables with category sizes <code class="reqn">c_1</code> and <code class="reqn">c_2</code> for a given <code class="reqn">p</code>. The p-value is the sum of probabilities of the tables having a score in the rejection region, e.g. having significantly large difference in proportions for a two-sided test. The p-value of the test is the maximum p-value calculated over all <code class="reqn">p</code> between 0 and 1.
</p>


<h3>Value</h3>

<table>
<tr><td><code>statistic.table</code></td>
<td>
<p>The contingency tables considered in the analysis represented by 'n1' and 'n2', their scores, and whether they are included in the one-sided (1), two-sided (2) tests, or not included at all (0)</p>
</td></tr>
<tr><td><code>nuisance.matrix</code></td>
<td>
<p>Nuisance parameters, <code class="reqn">p</code>, and the corresponding p-values for both one- and two-sided tests</p>
</td></tr>
<tr><td><code>dp</code></td>
<td>
<p>The resolution of the search space for the nuisance parameter</p>
</td></tr>
<tr><td><code>contingency.matrix</code></td>
<td>
<p>The observed 2x2 contingency table</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>One sided or two sided test</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The standardized difference between the observed proportions</p>
</td></tr>
<tr><td><code>nuisance.parameter</code></td>
<td>
<p>The nuisance parameter where the p-value is maximized</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value for the observed contingency table</p>
</td></tr>
<tr><td><code>pooled</code></td>
<td>
<p>Variance estimator of the Z statistic</p>
</td></tr>
</table>


<h3>Note</h3>

<p> I am indebted to Peter Calhoun for helping to test the performance and the accuracy of the code. I also thank Rodrigo Duprat, Long Qu, and Nicolas Sounac for their valuable comments. The accuracy has been tested with respect to the existing MATLAB and R implementations as well as the results of StatXact. I have largely been influenced by the works of Trujillo-Ortiz etal. (2004), Cardillo G. (2009), and Galili T. (2010). </p>


<h3>Author(s)</h3>

 
<p>Kamil Erguler, Post-doctoral Fellow, EEWRC, The Cyprus Institute <a href="mailto:k.erguler@cyi.ac.cy">k.erguler@cyi.ac.cy</a>
</p>


<h3>References</h3>


<ol>
<li><p> Barnard, G.A. (1945) A new test for 2x2 tables. <em>Nature</em>, 156:177.
</p>
</li>
<li><p> Barnard, G.A. (1947) Significance tests for 2x2 tables. <em>Biometrika</em>, 34:123-138.
</p>
</li>
<li><p> Suissa, S. and Shuster, J. J. (1985), Exact Unconditional Sample Sizes for the 2x2 Binomial Trial, Journal of the Royal Statistical Society, Ser. A, 148, 317-327.
</p>
</li>
<li><p> Cardillo G. (2009) MyBarnard: a very compact routine for Barnard's exact test on 2x2 matrix. URL <a href="http://www.mathworks.com/matlabcentral/fileexchange/25760">http://www.mathworks.com/matlabcentral/fileexchange/25760</a>
</p>
</li>
<li><p> Galili T. (2010) URL <a href="http://www.r-statistics.com/2010/02/barnards-exact-test-a-powerful-alternative-for-fishers-exact-test-implemented-in-r/">http://www.r-statistics.com/2010/02/barnards-exact-test-a-powerful-alternative-for-fishers-exact-test-implemented-in-r/</a>
</p>
</li>
<li><p> Lin C.Y., Yang M.C. (2009) Improved p-value tests for comparing two independent binomial proportions. <em>Communications in Statistics-Simulation and Computation</em>, 38(1):78-91.
</p>
</li>
<li><p> Trujillo-Ortiz, A., R. Hernandez-Walls, A. Castro-Perez, L. Rodriguez-Cardozo N.A. Ramos-Delgado and R. Garcia-Sanchez. (2004). Barnardextest:Barnard's Exact Probability Test. A MATLAB file. [WWW document]. URL <a href="http://www.mathworks.com/">http://www.mathworks.com/</a>
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>barnard.test(8,14,1,3)

## Plotting the search for the nuisance parameter for a one-sided test
bt&lt;-barnard.test(8,14,1,3)
plot(bt$nuisance.matrix[,1:2],
     t="l",xlab="nuisance parameter",ylab="p-value")

## Plotting the tables included in the p-value
bt&lt;-barnard.test(40,14,10,30)
bts&lt;-bt$statistic.table
plot(bts[,1],bts[,2],
     col=hsv(bts[,4]/4,1,1),
     t="p",xlab="n1",ylab="n2")

## Plotting the difference between pooled and unpooled tests
bts&lt;-barnard.test(40,14,10,30,pooled=TRUE)$statistic.table
btw&lt;-barnard.test(40,14,10,30,pooled=FALSE)$statistic.table
plot(bts[,1],bts[,2],
     col=c("black","white")[1+as.numeric(bts[,4]==btw[,4])],
     t="p",xlab="n1",ylab="n2")
</code></pre>

<hr>
<h2 id='barnardw.test'> Barnard's Unconditional Test with Wald Statistics (obsolete)</h2><span id='topic+barnardw.test'></span>

<h3>Description</h3>

<p>Previous version of Barnard's unconditional test for superiority which
used Z-statistic with pooled variance for the difference between two binomial
proportions in a 2x2 contingency table. Please use the 'barnard.test' instead.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
