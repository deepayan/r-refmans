<!DOCTYPE html><html><head><title>Help for package plotROC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {plotROC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc_auc'><p>Calculate the Area under the ROC curve</p></a></li>
<li><a href='#calculate_multi_roc'><p>Calculate the Empirical ROC curves for multiple biomarkers</p></a></li>
<li><a href='#calculate_roc'><p>Calculate the Empirical ROC curve</p></a></li>
<li><a href='#direct_label'><p>Add direct labels to a ROC plot</p></a></li>
<li><a href='#export_interactive_roc'><p>Generate svg code for an ROC curve object</p></a></li>
<li><a href='#geom_rocci'><p>Confidence regions for the ROC curve</p></a></li>
<li><a href='#GeomRoc'><p>Empirical Receiver Operating Characteristic Curve</p></a></li>
<li><a href='#getD3'><p>Reads included JavaScript functions and returns them as a string for pasting into a webpage</p></a></li>
<li><a href='#ggroc'><p>Plot an ROC curve</p></a></li>
<li><a href='#melt_roc'><p>Transform biomarkers stored as wide to long</p></a></li>
<li><a href='#multi_ggroc'><p>Plot multiple ROC curves</p></a></li>
<li><a href='#plot_interactive_roc'><p>Generate a standalone html document displaying an interactive ROC curve</p></a></li>
<li><a href='#plot_journal_roc'><p>Plot an ROC curve for use in print</p></a></li>
<li><a href='#plotROC'><p>Tools for plotting ROC Curves</p></a></li>
<li><a href='#roc_key'><p>Key for ROC geom</p></a></li>
<li><a href='#shiny_plotROC'><p>Start the plotROC Shiny app</p></a></li>
<li><a href='#StatRoc'><p>Calculate the empirical Receiver Operating Characteristic curve</p></a></li>
<li><a href='#StatRocci'><p>Calculate confidence regions for the empirical ROC curve</p></a></li>
<li><a href='#style_roc'><p>Add guides and annotations to a ROC plot</p></a></li>
<li><a href='#verify_d'><p>Check that D is suitable for using as binary disease status</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generate Useful ROC Curve Charts for Print and Interactive Use</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-05</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael C. Sachs &lt;sachsmc@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Most ROC curve plots obscure the cutoff values and inhibit
    interpretation and comparison of multiple curves. This attempts to address
    those shortcomings by providing plotting and interactive tools. Functions
    are provided to generate an interactive ROC curve plot for web use, and
    print versions. A Shiny application implementing the functions is also
    included.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://sachsmc.github.io/plotROC/">https://sachsmc.github.io/plotROC/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sachsmc/plotROC/issues/">https://github.com/sachsmc/plotROC/issues/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), ggplot2</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, grid, gridSVG, shiny, plyr, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, stringr, survivalROC, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-06 12:13:25 UTC; sachsmc</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael C. Sachs [aut, cre],
  Robert W. Corty [ctb],
  Luis Crouch [ctb] (Modification to calc_auc)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-06 12:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc_auc'>Calculate the Area under the ROC curve</h2><span id='topic+calc_auc'></span>

<h3>Description</h3>

<p>Given a ggplot object with a GeomRoc layer, computes the area under the ROC curve for each group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_auc(ggroc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_auc_+3A_ggroc">ggroc</code></td>
<td>
<p>A ggplot object that contains a GeomRoc layer</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the estimated AUCs for each panel and group
</p>


<h3>Examples</h3>

<pre><code class='language-R'>D.ex &lt;- rbinom(50, 1, .5)
rocdata &lt;- data.frame(D = c(D.ex, D.ex),
                     M = c(rnorm(50, mean = D.ex, sd = .4), rnorm(50, mean = D.ex, sd = 1)),
                     Z = c(rep("A", 50), rep("B", 50)))

ggroc &lt;- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
calc_auc(ggroc)
ggroc2 &lt;- ggplot(rocdata, aes(m = M, d = D, color = Z)) + geom_roc()
calc_auc(ggroc2)
</code></pre>

<hr>
<h2 id='calculate_multi_roc'>Calculate the Empirical ROC curves for multiple biomarkers</h2><span id='topic+calculate_multi_roc'></span>

<h3>Description</h3>

<p>Deprecated, use <a href="#topic+geom_roc">geom_roc</a> instead
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_multi_roc(data, M_string, D_string)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_multi_roc_+3A_data">data</code></td>
<td>
<p>data frame containing at least 1 marker and the common class
labels, coded as 0 and 1</p>
</td></tr>
<tr><td><code id="calculate_multi_roc_+3A_m_string">M_string</code></td>
<td>
<p>vector of marker column names</p>
</td></tr>
<tr><td><code id="calculate_multi_roc_+3A_d_string">D_string</code></td>
<td>
<p>class label column name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of data frames containing cutoffs, and estimated true and false
positive fractions
</p>

<hr>
<h2 id='calculate_roc'>Calculate the Empirical ROC curve</h2><span id='topic+calculate_roc'></span>

<h3>Description</h3>

<p>Deprecated, use <a href="#topic+geom_roc">geom_roc</a> instead
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_roc(M, D, ci = FALSE, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_roc_+3A_m">M</code></td>
<td>
<p>continuous marker values or predictions of class labels</p>
</td></tr>
<tr><td><code id="calculate_roc_+3A_d">D</code></td>
<td>
<p>class labels, must be coded as 0 and 1. If not numeric with 0/1,
then plotROC assumes the first level in sort order is healthy status, with
a warning.</p>
</td></tr>
<tr><td><code id="calculate_roc_+3A_ci">ci</code></td>
<td>
<p>Logical, if true, will calculate exact joint confidence regions for
the TPF and FPF</p>
</td></tr>
<tr><td><code id="calculate_roc_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level, ignored if <code>ci = FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals for TPF and FPF are calculated using the exact 
method of Clopper and Pearson (1934) each at the level <code>1 - sqrt(1 - 
  alpha)</code>. Based on result 2.4 from Pepe (2003), the cross-product of these 
intervals yields a 1 - alpha 
</p>


<h3>Value</h3>

<p>A dataframe containing cutoffs, estimated true and false positive 
fractions, and confidence intervals if <code>ci = TRUE</code>.
</p>

<hr>
<h2 id='direct_label'>Add direct labels to a ROC plot</h2><span id='topic+direct_label'></span>

<h3>Description</h3>

<p>Add direct labels to a ROC plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>direct_label(
  ggroc_p,
  labels = NULL,
  label.angle = 45,
  nudge_x = 0,
  nudge_y = 0,
  size = 6,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="direct_label_+3A_ggroc_p">ggroc_p</code></td>
<td>
<p>A ggplot object that contains a <a href="#topic+geom_roc">geom_roc</a> layer</p>
</td></tr>
<tr><td><code id="direct_label_+3A_labels">labels</code></td>
<td>
<p>vector of labels to add directly to the plot next to
the curves. If multiple curves, must be in the same order as the grouping
factor. If NULL, attempts to determine labels from the ggroc_p object</p>
</td></tr>
<tr><td><code id="direct_label_+3A_label.angle">label.angle</code></td>
<td>
<p>angle of adjustment for the direct labels</p>
</td></tr>
<tr><td><code id="direct_label_+3A_nudge_x">nudge_x</code>, <code id="direct_label_+3A_nudge_y">nudge_y</code></td>
<td>
<p>Horizontal and vertical adjustment to nudge labels
by. These can be scalars or vectors the same length as the number of labels</p>
</td></tr>
<tr><td><code id="direct_label_+3A_size">size</code></td>
<td>
<p>Size of labels</p>
</td></tr>
<tr><td><code id="direct_label_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <a href="ggplot2.html#topic+annotate">annotate</a></p>
</td></tr>
</table>

<hr>
<h2 id='export_interactive_roc'>Generate svg code for an ROC curve object</h2><span id='topic+export_interactive_roc'></span>

<h3>Description</h3>

<p>Takes a ggplot object that contains a GeomRoc layer and returns a string that
contains html suitable for creating a standalone interactive ROC curve plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_interactive_roc(
  ggroc_p,
  add.cis = TRUE,
  hide.points = FALSE,
  prefix = "a",
  width = 6,
  height = 6,
  omit.js = FALSE,
  style = style_roc(theme = theme_grey()),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_interactive_roc_+3A_ggroc_p">ggroc_p</code></td>
<td>
<p>A ggplot object with a GeomRoc layer and optionally a
GeomRocci layer as returned by <a href="#topic+geom_roc">geom_roc</a> and/or <a href="#topic+geom_rocci">geom_rocci</a>. It can
be modified with annotations, themes, etc.</p>
</td></tr>
<tr><td><code id="export_interactive_roc_+3A_add.cis">add.cis</code></td>
<td>
<p>Logical, if true, removes the current confidence interval 
layer (if present) and replaces it with a denser layer of confidence 
regions</p>
</td></tr>
<tr><td><code id="export_interactive_roc_+3A_hide.points">hide.points</code></td>
<td>
<p>Logical, if true, hides points layer so that points with cutoff values are
only visible when hovering. Recommended for plots containing more than 3 curves.</p>
</td></tr>
<tr><td><code id="export_interactive_roc_+3A_prefix">prefix</code></td>
<td>
<p>A string to assign to the objects within the svg. Enables 
unique identification by the javascript code</p>
</td></tr>
<tr><td><code id="export_interactive_roc_+3A_width">width</code>, <code id="export_interactive_roc_+3A_height">height</code></td>
<td>
<p>Width and height in inches of plot</p>
</td></tr>
<tr><td><code id="export_interactive_roc_+3A_omit.js">omit.js</code></td>
<td>
<p>Logical. If true, omit inclusion of javascript source in 
output. Useful for documents with multiple interactive plots</p>
</td></tr>
<tr><td><code id="export_interactive_roc_+3A_style">style</code></td>
<td>
<p>A call to the function <a href="#topic+style_roc">style_roc</a></p>
</td></tr>
<tr><td><code id="export_interactive_roc_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <a href="#topic+geom_rocci">geom_rocci</a> when <code>add.cis = 
TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you intend to include more than one of these objects in a single 
page, use a different <code>prefix</code> string for each one. To use this 
function in knitr, use the chunk options <code>fig.keep='none'</code> and 
<code>results = 'asis'</code>, then <code>cat()</code> the resulting string to the 
output. See the vignette for examples. Older browsers (&lt; IE7) are not 
supported.
</p>


<h3>Value</h3>

<p>A character object containing the html necessary to plot the ROC 
curve in a web browser
</p>

<hr>
<h2 id='geom_rocci'>Confidence regions for the ROC curve</h2><span id='topic+geom_rocci'></span><span id='topic+GeomRocci'></span>

<h3>Description</h3>

<p>Display rectangular confidence regions for the empirical ROC curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_rocci(
  mapping = NULL,
  data = NULL,
  stat = "rocci",
  ci.at = NULL,
  sig.level = 0.05,
  na.rm = TRUE,
  alpha.box = 0.3,
  labels = TRUE,
  labelsize = 3.88,
  labelround = 1,
  position = "identity",
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)

GeomRocci
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_rocci_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_stat">stat</code></td>
<td>
<p>Use to override the default connection between
<code>geom_rocci</code> and <code>stat_rocci</code>.</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_ci.at">ci.at</code></td>
<td>
<p>Vector of values in the range of the biomarker where confidence regions will be displayed</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level for the confidence regions</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_alpha.box">alpha.box</code></td>
<td>
<p>Alpha level for the confidence regions</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_labels">labels</code></td>
<td>
<p>If TRUE, adds text labels for the cutoffs where the confidence regions are displayed</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_labelsize">labelsize</code></td>
<td>
<p>Size of cutoff text labels</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_labelround">labelround</code></td>
<td>
<p>Integer, number of significant digits to round cutoff labels</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="geom_rocci_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>GeomRocci</code> (inherits from <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 6.
</p>


<h3>Aesthetics</h3>

<p><code>geom_rocci</code> understands the following aesthetics (required aesthetics
are in bold). <code>stat_rocci</code> automatically maps the estimates to the required aesthetics:
</p>

<ul>
<li> <p><strong><code>x</code></strong> The FPF estimate
</p>
</li>
<li> <p><strong><code>y</code></strong> The TPF estimate
</p>
</li>
<li> <p><strong><code>xmin</code></strong> Lower confidence limit for the FPF
</p>
</li>
<li> <p><strong><code>xmax</code></strong> Upper confidence limit for the FPF
</p>
</li>
<li> <p><strong><code>ymin</code></strong> Lower confidence limit for the TPF
</p>
</li>
<li> <p><strong><code>ymax</code></strong> Upper confidence limit for the TPF
</p>
</li>
<li> <p><code>alpha</code>
</p>
</li>
<li> <p><code>color</code>
</p>
</li>
<li> <p><code>fill</code>
</p>
</li>
<li> <p><code>linetype</code>
</p>
</li>
<li> <p><code>size</code>
</p>
</li></ul>



<h3>See Also</h3>

<p>See <code><a href="#topic+geom_roc">geom_roc</a></code> for the empirical ROC curve, <code><a href="#topic+style_roc">style_roc</a></code> for 
adding guidelines and labels, and <code><a href="#topic+direct_label">direct_label</a></code> for adding direct labels to the 
curves. Also <a href="#topic+export_interactive_roc">export_interactive_roc</a> for creating interactive ROC curve plots for use in a web browser.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
D.ex &lt;- rbinom(50, 1, .5)
rocdata &lt;- data.frame(D = c(D.ex, D.ex), 
                   M = c(rnorm(50, mean = D.ex, sd = .4), rnorm(50, mean = D.ex, sd = 1)), 
                   Z = c(rep("A", 50), rep("B", 50)))

ggplot(rocdata, aes(m = M, d = D)) + geom_roc() + geom_rocci()
ggplot(rocdata, aes(m = M, d = D, color = Z)) + geom_roc() + geom_rocci()
ggplot(rocdata, aes(m = M, d = D, color = Z)) + geom_roc() + geom_rocci(sig.level = .01)
ggplot(rocdata, aes(m = M, d = D)) + geom_roc(n.cuts = 0) + 
geom_rocci(ci.at = quantile(rocdata$M, c(.1, .25, .5, .75, .9)))
ggplot(rocdata, aes(m = M, d = D, color = Z)) + geom_roc() + geom_rocci(linetype = 1)
</code></pre>

<hr>
<h2 id='GeomRoc'>Empirical Receiver Operating Characteristic Curve</h2><span id='topic+GeomRoc'></span><span id='topic+geom_roc'></span>

<h3>Description</h3>

<p>Display the empirical ROC curve. Useful for characterizing the classification
accuracy of continuous measurements for predicting binary states
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GeomRoc

geom_roc(
  mapping = NULL,
  data = NULL,
  stat = "roc",
  n.cuts = 10,
  arrow = NULL,
  lineend = "butt",
  linejoin = "round",
  linemitre = 1,
  linealpha = 1,
  pointalpha = 1,
  pointsize = 0.5,
  labels = TRUE,
  labelsize = 3.88,
  labelround = 1,
  na.rm = TRUE,
  cutoffs.at = NULL,
  cutoff.labels = NULL,
  position = "identity",
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GeomRoc_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_stat">stat</code></td>
<td>
<p>Use to override the default connection between
<code>geom_roc</code> and <code>stat_roc</code>.</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_n.cuts">n.cuts</code></td>
<td>
<p>Number of cutpoints to display along each curve</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_arrow">arrow</code></td>
<td>
<p>Arrow specification, as created by <code><a href="grid.html#topic+arrow">arrow</a></code></p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_lineend">lineend</code></td>
<td>
<p>Line end style (round, butt, square)</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_linejoin">linejoin</code></td>
<td>
<p>Line join style (round, mitre, bevel)</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_linemitre">linemitre</code></td>
<td>
<p>Line mitre limit (number greater than 1)</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_linealpha">linealpha</code></td>
<td>
<p>Alpha level for the lines, alpha.line is deprecated</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_pointalpha">pointalpha</code></td>
<td>
<p>Alpha level for the cutoff points, alpha.point is deprecated</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_pointsize">pointsize</code></td>
<td>
<p>Size of cutoff points, size.point is deprecated</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_labels">labels</code></td>
<td>
<p>Logical, display cutoff text labels</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_labelsize">labelsize</code></td>
<td>
<p>Size of cutoff text labels</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_labelround">labelround</code></td>
<td>
<p>Integer, number of significant digits to round cutoff labels</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove missing values from curve</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_cutoffs.at">cutoffs.at</code></td>
<td>
<p>Vector of user supplied cutoffs to plot as points. If non-NULL, 
it will override the values of n.cuts and plot the observed cutoffs closest to the user-supplied ones.</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_cutoff.labels">cutoff.labels</code></td>
<td>
<p>vector of user-supplied labels for the cutoffs.  Must be a character vector of
the same length as cutoffs.at.</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="GeomRoc_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>GeomRoc</code> (inherits from <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 6.
</p>


<h3>Computed variables</h3>


<dl>
<dt>false_positive_fraction</dt><dd><p>estimate of false positive fraction</p>
</dd>
<dt>true_positive_fraction</dt><dd><p>estimate of true positive fraction</p>
</dd>
<dt>cutoffs</dt><dd><p>values of m at which estimates are calculated</p>
</dd>
</dl>



<h3>Aesthetics</h3>

<p><code>geom_roc</code> understands the following aesthetics (required aesthetics
are in bold):
</p>

<ul>
<li> <p><strong><code>x</code></strong> The FPF estimate. This is automatically mapped by <a href="#topic+stat_roc">stat_roc</a>
</p>
</li>
<li> <p><strong><code>y</code></strong> The TPF estimate. This is automatically mapped by <a href="#topic+stat_roc">stat_roc</a>
smallest level in sort order is assumed to be 0, with a warning
</p>
</li>
<li> <p><code>alpha</code>
</p>
</li>
<li> <p><code>color</code>
</p>
</li>
<li> <p><code>fill</code>
</p>
</li>
<li> <p><code>linetype</code>
</p>
</li>
<li> <p><code>size</code>
</p>
</li></ul>



<h3>See Also</h3>

<p>See <code><a href="#topic+geom_rocci">geom_rocci</a></code> for
displaying rectangular confidence regions for the empirical ROC curve, <code><a href="#topic+style_roc">style_roc</a></code> for 
adding guidelines and labels, and <code><a href="#topic+direct_label">direct_label</a></code> for adding direct labels to the 
curves. Also <a href="#topic+export_interactive_roc">export_interactive_roc</a> for creating interactive ROC curve plots for use in a web browser.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>D.ex &lt;- rbinom(50, 1, .5)
rocdata &lt;- data.frame(D = c(D.ex, D.ex), 
                   M = c(rnorm(50, mean = D.ex, sd = .4), rnorm(50, mean = D.ex, sd = 1)), 
                   Z = c(rep("A", 50), rep("B", 50)))

ggplot(rocdata, aes(m = M, d = D)) + geom_roc()

ggplot(rocdata, aes(m = M, d = D, color = Z)) + geom_roc()
ggplot(rocdata, aes(m = M, d = D)) + geom_roc() + facet_wrap(~ Z)
ggplot(rocdata, aes(m = M, d = D)) + geom_roc(n.cuts = 20)
ggplot(rocdata, aes(m = M, d = D)) + geom_roc(cutoffs.at = c(1.5, 1, .5, 0, -.5))
ggplot(rocdata, aes(m = M, d = D)) + geom_roc(labels = FALSE)
ggplot(rocdata, aes(m = M, d = D)) + geom_roc(size = 1.25)

</code></pre>

<hr>
<h2 id='getD3'>Reads included JavaScript functions and returns them as a string for pasting into a webpage</h2><span id='topic+getD3'></span>

<h3>Description</h3>

<p>Reads included JavaScript functions and returns them as a string for pasting into a webpage
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getD3()
</code></pre>

<hr>
<h2 id='ggroc'>Plot an ROC curve</h2><span id='topic+ggroc'></span>

<h3>Description</h3>

<p>Deprecated, use <a href="#topic+geom_roc">geom_roc</a> instead
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggroc(
  rocdata,
  fpf_string = "FPF",
  tpf_string = "TPF",
  c_string = "c",
  ci = FALSE,
  label = NULL,
  label.adj.x = 0,
  label.adj.y = 0,
  label.angle = 45,
  plotmath = FALSE,
  xlabel = "False positive fraction",
  ylabel = "True positive fraction"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggroc_+3A_rocdata">rocdata</code></td>
<td>
<p>Data frame containing true and false positive fractions, and
cutoff values</p>
</td></tr>
<tr><td><code id="ggroc_+3A_fpf_string">fpf_string</code></td>
<td>
<p>Column name identifying false positive fraction column</p>
</td></tr>
<tr><td><code id="ggroc_+3A_tpf_string">tpf_string</code></td>
<td>
<p>Column name identifying true positive fraction column</p>
</td></tr>
<tr><td><code id="ggroc_+3A_c_string">c_string</code></td>
<td>
<p>Column name identifying cutoff values</p>
</td></tr>
<tr><td><code id="ggroc_+3A_ci">ci</code></td>
<td>
<p>Logical, not supported</p>
</td></tr>
<tr><td><code id="ggroc_+3A_label">label</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="ggroc_+3A_label.adj.x">label.adj.x</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="ggroc_+3A_label.adj.y">label.adj.y</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="ggroc_+3A_label.angle">label.angle</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="ggroc_+3A_plotmath">plotmath</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="ggroc_+3A_xlabel">xlabel</code></td>
<td>
<p>Defaults to &quot;False positive fraction&quot;</p>
</td></tr>
<tr><td><code id="ggroc_+3A_ylabel">ylabel</code></td>
<td>
<p>Defaults to &quot;True positive fraction&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>

<hr>
<h2 id='melt_roc'>Transform biomarkers stored as wide to long</h2><span id='topic+melt_roc'></span>

<h3>Description</h3>

<p>Multiple biomarkers measured on the same subjects are often stored as multiple columns in a data frame. This is a convenience function that transforms the data into long format, suitable for use with ggplot and <a href="#topic+geom_roc">geom_roc</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>melt_roc(data, d, m, names = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="melt_roc_+3A_data">data</code></td>
<td>
<p>Data frame containing disease status and biomarkers stored in columns</p>
</td></tr>
<tr><td><code id="melt_roc_+3A_d">d</code></td>
<td>
<p>Column containing binary disease status. Can be a column name or index</p>
</td></tr>
<tr><td><code id="melt_roc_+3A_m">m</code></td>
<td>
<p>Vector of column names or indices identifying biomarkers</p>
</td></tr>
<tr><td><code id="melt_roc_+3A_names">names</code></td>
<td>
<p>Optional vector of names to assign to the biomarkers. If NULL, names will be taken from the column names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame in long format with three columns: D = binary disease status, M = biomarker value, and name = biomarker name
</p>


<h3>Examples</h3>

<pre><code class='language-R'>D.ex &lt;- rbinom(50, 1, .5)
widedata &lt;- data.frame(D = D.ex, M1 = rnorm(50, mean = D.ex, sd = 1), 
   M2 = rnorm(50, mean = D.ex, sd = .5))
longdata &lt;- melt_roc(widedata, "D", c("M1", "M2"))
ggplot(longdata, aes(d = D, m = M, color = name)) + geom_roc()

</code></pre>

<hr>
<h2 id='multi_ggroc'>Plot multiple ROC curves</h2><span id='topic+multi_ggroc'></span>

<h3>Description</h3>

<p>Given a list of results computed by <a href="#topic+calculate_roc">calculate_roc</a>, plot the curve
using ggplot with sensible defaults. Pass the resulting object and data to
<a href="#topic+export_interactive_roc">export_interactive_roc</a>, <a href="#topic+plot_interactive_roc">plot_interactive_roc</a>, or
<a href="#topic+plot_journal_roc">plot_journal_roc</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_ggroc(
  datalist,
  fpf_string = rep("FPF", length(datalist)),
  tpf_string = rep("TPF", length(datalist)),
  c_string = rep("c", length(datalist)),
  label = NULL,
  legend = TRUE,
  label.adj.x = rep(0, length(datalist)),
  label.adj.y = rep(0, length(datalist)),
  label.angle = rep(45, length(datalist)),
  plotmath = FALSE,
  xlabel = "False positive fraction",
  ylabel = "True positive fraction"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_ggroc_+3A_datalist">datalist</code></td>
<td>
<p>List of data frames each containing true and false positive
fractions and cutoffs</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_fpf_string">fpf_string</code></td>
<td>
<p>Column names identifying false positive fraction</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_tpf_string">tpf_string</code></td>
<td>
<p>Column names identifying true positive fraction</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_c_string">c_string</code></td>
<td>
<p>Column names identifying cutoff values</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_label">label</code></td>
<td>
<p>Not supported.</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_legend">legend</code></td>
<td>
<p>If true, draws legend</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_label.adj.x">label.adj.x</code></td>
<td>
<p>Not supported.</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_label.adj.y">label.adj.y</code></td>
<td>
<p>Not supported.</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_label.angle">label.angle</code></td>
<td>
<p>Not supported.</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_plotmath">plotmath</code></td>
<td>
<p>Logical. Not supported.</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_xlabel">xlabel</code></td>
<td>
<p>Defaults to &quot;False positive fraction&quot;</p>
</td></tr>
<tr><td><code id="multi_ggroc_+3A_ylabel">ylabel</code></td>
<td>
<p>Defaults to &quot;True positive fraction&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>

<hr>
<h2 id='plot_interactive_roc'>Generate a standalone html document displaying an interactive ROC curve</h2><span id='topic+plot_interactive_roc'></span>

<h3>Description</h3>

<p>Generate a standalone html document displaying an interactive ROC curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_interactive_roc(ggroc, file = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_interactive_roc_+3A_ggroc">ggroc</code></td>
<td>
<p>An object as returned by <a href="#topic+ggroc">ggroc</a> or <a href="#topic+multi_ggroc">multi_ggroc</a>. It can be modified with annotations, themes, etc.</p>
</td></tr>
<tr><td><code id="plot_interactive_roc_+3A_file">file</code></td>
<td>
<p>A path to save the result to. If NULL, will save to a temporary directory</p>
</td></tr>
<tr><td><code id="plot_interactive_roc_+3A_...">...</code></td>
<td>
<p>arguments passed to <a href="#topic+export_interactive_roc">export_interactive_roc</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL opens an interactive document in Rstudio or the default web browser
</p>

<hr>
<h2 id='plot_journal_roc'>Plot an ROC curve for use in print</h2><span id='topic+plot_journal_roc'></span>

<h3>Description</h3>

<p>Deprecated, use <a href="#topic+style_roc">style_roc</a> instead
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_journal_roc(
  ggroc_p,
  font.size = 3,
  n.cuts = 20,
  ci.at = NULL,
  opacity = 0.3,
  lty = NULL,
  color = NULL,
  lwd = NULL,
  legend = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_journal_roc_+3A_ggroc_p">ggroc_p</code></td>
<td>
<p>An object as returned by <a href="#topic+ggroc">ggroc</a> or <a href="#topic+multi_ggroc">multi_ggroc</a>.
It can be modified with annotations, themes, etc.</p>
</td></tr>
<tr><td><code id="plot_journal_roc_+3A_font.size">font.size</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="plot_journal_roc_+3A_n.cuts">n.cuts</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="plot_journal_roc_+3A_ci.at">ci.at</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="plot_journal_roc_+3A_opacity">opacity</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="plot_journal_roc_+3A_lty">lty</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="plot_journal_roc_+3A_color">color</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="plot_journal_roc_+3A_lwd">lwd</code></td>
<td>
<p>Not supported</p>
</td></tr>
<tr><td><code id="plot_journal_roc_+3A_legend">legend</code></td>
<td>
<p>Not supported</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>

<hr>
<h2 id='plotROC'>Tools for plotting ROC Curves</h2><span id='topic+plotROC'></span><span id='topic+plotROC-package'></span>

<h3>Description</h3>

<p>Generate Useful ROC Curve Charts for Print and Interactive Use. This defines
a set of stats and geoms for use with ggplot2. In addition, ggplot objects
created with these geoms can be exported and turned into interactive plots
for use on the web. The interactive features include hovering to display
hidden labels, and clicking to reveal confidence regions.
</p>


<h3>Details</h3>

<p>To get started, see <a href="#topic+geom_roc">geom_roc</a>, <a href="#topic+geom_rocci">geom_rocci</a>, or the examples
below. For transforming data, we also provide the convenience function
<a href="#topic+melt_roc">melt_roc</a>.
</p>
<p>The vignette contains some examples, along with explanations of the results. To view, run 
<code>vignette("examples", package = "plotROC")</code>
</p>


<h3>Author(s)</h3>

<p>Michael Sachs (@sachsmc)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://sachsmc.github.io/plotROC/">https://sachsmc.github.io/plotROC/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/sachsmc/plotROC/issues/">https://github.com/sachsmc/plotROC/issues/</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
D.ex &lt;- rbinom(50, 1, .5)
rocdata &lt;- data.frame(D = c(D.ex, D.ex), 
                   M = c(rnorm(50, mean = D.ex, sd = .4), rnorm(50, mean = D.ex, sd = 1)), 
                   Z = c(rep("A", 50), rep("B", 50)))

ggplot(rocdata, aes(m = M, d = D)) + geom_roc() + geom_rocci()

ggplot(rocdata, aes(m = M, d = D)) + geom_roc() + style_roc()
ggplot(rocdata, aes(m = M, d = D, color = Z)) + geom_roc() + geom_rocci()
ggplot(rocdata, aes(m = M, d = D, color = Z)) + geom_roc() + geom_rocci(sig.level = .01)
ggplot(rocdata, aes(m = M, d = D)) + geom_roc(n.cuts = 0) + 
geom_rocci(ci.at = quantile(rocdata$M, c(.1, .25, .5, .75, .9)))
ggplot(rocdata, aes(m = M, d = D, color = Z)) + geom_roc() + geom_rocci(linetype = 1)

rocplot &lt;- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()

plot_interactive_roc(rocplot)
plot_interactive_roc(rocplot + aes(color = Z))
plot_interactive_roc(rocplot + facet_wrap( ~ Z))


</code></pre>

<hr>
<h2 id='roc_key'>Key for ROC geom</h2><span id='topic+roc_key'></span>

<h3>Description</h3>

<p>Key for ROC geom
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roc_key(data, params, size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roc_key_+3A_data">data</code></td>
<td>
<p>Data created by stat</p>
</td></tr>
<tr><td><code id="roc_key_+3A_params">params</code></td>
<td>
<p>parameters</p>
</td></tr>
<tr><td><code id="roc_key_+3A_size">size</code></td>
<td>
<p>Size</p>
</td></tr>
</table>

<hr>
<h2 id='shiny_plotROC'>Start the plotROC Shiny app</h2><span id='topic+shiny_plotROC'></span>

<h3>Description</h3>

<p>A convenience function to easily start the shiny application. It will open in Rstudio, or in the default web browser.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny_plotROC()
</code></pre>

<hr>
<h2 id='StatRoc'>Calculate the empirical Receiver Operating Characteristic curve</h2><span id='topic+StatRoc'></span><span id='topic+stat_roc'></span>

<h3>Description</h3>

<p>Given a binary outcome d and continuous measurement m, computes the empirical
ROC curve for assessing the classification accuracy of m
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatRoc

stat_roc(
  mapping = NULL,
  data = NULL,
  geom = "roc",
  position = "identity",
  show.legend = NA,
  inherit.aes = TRUE,
  na.rm = TRUE,
  max.num.points = 1000,
  increasing = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StatRoc_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use to display the data, either as a
<code>ggproto</code> <code>Geom</code> subclass or as a string naming the geom stripped of the
<code>geom_</code> prefix (e.g. <code>"point"</code> rather than <code>"geom_point"</code>)</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove missing observations</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_max.num.points">max.num.points</code></td>
<td>
<p>maximum number of points to plot</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_increasing">increasing</code></td>
<td>
<p>TRUE (default) if M is positively associated with Pr(D = 1), if FALSE, assumes M is negatively associated with Pr(D = 1)</p>
</td></tr>
<tr><td><code id="StatRoc_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>StatRoc</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 6.
</p>


<h3>Aesthetics</h3>

<p><code>stat_roc</code> understands the following aesthetics (required aesthetics
are in bold):
</p>

<ul>
<li> <p><strong><code>m</code></strong> The continuous biomarker/predictor
</p>
</li>
<li> <p><strong><code>d</code></strong> The binary outcome, if not coded as 0/1, the 
smallest level in sort order is assumed to be 0, with a warning
</p>
</li>
<li> <p><code>alpha</code> Controls the label alpha, see also <code>linealpha</code> and <code>pointalpha</code>
</p>
</li>
<li> <p><code>color</code>
</p>
</li>
<li> <p><code>linetype</code> 
</p>
</li>
<li> <p><code>size</code> Controls the line weight, see also <code>pointsize</code> and <code>labelsize</code>
</p>
</li></ul>



<h3>Computed variables</h3>


<dl>
<dt>false_positive_fraction</dt><dd><p>estimate of false positive fraction</p>
</dd>
<dt>true_positive_fraction</dt><dd><p>estimate of true positive fraction</p>
</dd>
<dt>cutoffs</dt><dd><p>values of m at which estimates are calculated</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>D.ex &lt;- rbinom(50, 1, .5)
rocdata &lt;- data.frame(D = c(D.ex, D.ex), 
                   M = c(rnorm(50, mean = D.ex, sd = .4), rnorm(50, mean = D.ex, sd = 1)), 
                   Z = c(rep("A", 50), rep("B", 50)))

ggplot(rocdata, aes(m = M, d = D)) + stat_roc()
</code></pre>

<hr>
<h2 id='StatRocci'>Calculate confidence regions for the empirical ROC curve</h2><span id='topic+StatRocci'></span><span id='topic+stat_rocci'></span>

<h3>Description</h3>

<p>Confidence intervals for TPF and FPF are calculated using the exact 
method of Clopper and Pearson (1934) each at the level <code>1 - sqrt(1 - 
  alpha)</code>. Based on result 2.4 from Pepe (2003), the cross-product of these 
intervals yields a 1 - alpha 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatRocci

stat_rocci(
  mapping = NULL,
  data = NULL,
  geom = "rocci",
  position = "identity",
  show.legend = NA,
  inherit.aes = TRUE,
  ci.at = NULL,
  sig.level = 0.05,
  na.rm = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StatRocci_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use to display the data, either as a
<code>ggproto</code> <code>Geom</code> subclass or as a string naming the geom stripped of the
<code>geom_</code> prefix (e.g. <code>"point"</code> rather than <code>"geom_point"</code>)</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_ci.at">ci.at</code></td>
<td>
<p>Vector of cutoffs at which to display confidence regions. If
NULL, will automatically choose 3 evenly spaced points to display the regions</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level for the confidence regions</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove missing observations</p>
</td></tr>
<tr><td><code id="StatRocci_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>StatRocci</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 6.
</p>


<h3>Aesthetics</h3>

<p><code>stat_rocci</code> understands the following aesthetics (required aesthetics
are in bold):
</p>

<ul>
<li> <p><strong><code>m</code></strong> The continuous biomarker/predictor
</p>
</li>
<li> <p><strong><code>d</code></strong> The binary outcome, if not coded as 0/1, the 
smallest level in sort order is assumed to be 0, with a warning
</p>
</li>
<li> <p><code>alpha</code>
</p>
</li>
<li> <p><code>color</code>
</p>
</li>
<li> <p><code>fill</code>
</p>
</li>
<li> <p><code>linetype</code>
</p>
</li>
<li> <p><code>size</code>
</p>
</li></ul>



<h3>Computed variables</h3>


<dl>
<dt>FPF</dt><dd><p>estimate of false positive fraction</p>
</dd>
<dt>TPF</dt><dd><p>estimate of true positive fraction</p>
</dd>
<dt>cutoffs</dt><dd><p>values of m at which estimates are calculated</p>
</dd>
<dt>FPFL</dt><dd><p>lower bound of confidence region for FPF</p>
</dd>
<dt>FPFU</dt><dd><p>upper bound of confidence region for FPF</p>
</dd>
<dt>TPFL</dt><dd><p>lower bound of confidence region for TPF</p>
</dd>
<dt>TPFU</dt><dd><p>upper bound of confidence region for TPF</p>
</dd>
</dl>



<h3>References</h3>


<ul>
<li><p> Clopper, C. J., and Egon S. Pearson. &quot;The use of confidence or fiducial limits illustrated in the case of the binomial.&quot; Biometrika (1934): 404-413.
</p>
</li>
<li><p> Pepe, M.S. &quot;The Statistical Evaluation of Medical Tests for Classification and Prediction.&quot; Oxford (2003). 
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>D.ex &lt;- rbinom(50, 1, .5)
rocdata &lt;- data.frame(D = c(D.ex, D.ex), 
                   M = c(rnorm(50, mean = D.ex, sd = .4), rnorm(50, mean = D.ex, sd = 1)), 
                   Z = c(rep("A", 50), rep("B", 50)))

ggplot(rocdata, aes(m = M, d = D)) + geom_roc() + stat_rocci()
ggplot(rocdata, aes(m = M, d = D)) + geom_roc() + 
stat_rocci(ci.at = quantile(rocdata$M, c(.1, .3, .5, .7, .9)))

</code></pre>

<hr>
<h2 id='style_roc'>Add guides and annotations to a ROC plot</h2><span id='topic+style_roc'></span>

<h3>Description</h3>

<p>Adds a diagonal guideline, minor grid lines, and optionally direct labels to ggplot objects containing a geom_roc layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>style_roc(
  major.breaks = c(0, 0.1, 0.25, 0.5, 0.75, 0.9, 1),
  minor.breaks = c(seq(0, 0.1, by = 0.01), seq(0.9, 1, by = 0.01)),
  guide = TRUE,
  xlab = "False positive fraction",
  ylab = "True positive fraction",
  theme = theme_bw
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="style_roc_+3A_major.breaks">major.breaks</code></td>
<td>
<p>vector of breakpoints for the major gridlines and axes</p>
</td></tr>
<tr><td><code id="style_roc_+3A_minor.breaks">minor.breaks</code></td>
<td>
<p>vector of breakpoints for the minor gridlines and axes</p>
</td></tr>
<tr><td><code id="style_roc_+3A_guide">guide</code></td>
<td>
<p>logical, if TRUE draws diagonal guideline</p>
</td></tr>
<tr><td><code id="style_roc_+3A_xlab">xlab</code></td>
<td>
<p>X-axis label</p>
</td></tr>
<tr><td><code id="style_roc_+3A_ylab">ylab</code></td>
<td>
<p>Y-axis label</p>
</td></tr>
<tr><td><code id="style_roc_+3A_theme">theme</code></td>
<td>
<p>Theme function compatible with ggplot2</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>D.ex &lt;- rbinom(50, 1, .5)
fakedata &lt;- data.frame(M1 = rnorm(50, mean = D.ex), 
   D = D.ex)
ggplot(fakedata, aes(m = M1, d = D)) + geom_roc() + style_roc()
ggplot(fakedata, aes(m = M1, d = D)) + geom_roc() + style_roc(xlab = "1 - Specificity")
ggplot(fakedata, aes(m = M1, d = D)) + geom_roc() + style_roc(theme = theme_grey)
</code></pre>

<hr>
<h2 id='verify_d'>Check that D is suitable for using as binary disease status</h2><span id='topic+verify_d'></span>

<h3>Description</h3>

<p>Checks for two classes and gives a warning message indicating which level is assumed to be 0/1. Throws an error if more than two levels appear in D.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify_d(D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verify_d_+3A_d">D</code></td>
<td>
<p>Vector that will be checked for 2-class labels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector the same length as D that takes values 0, indicating no disease or 1 indicating disease.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
verify_d(c(1, 0, 1))
## Not run: 
verify_d(c(TRUE, FALSE, TRUE)) #warning
verify_d(c("Dead", "Alive", "Dead")) #warning
verify_d(c("Disease", "Healthy", "Missing")) #error

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
