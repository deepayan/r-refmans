<!DOCTYPE html><html><head><title>Help for package nifti.io</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nifti.io}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#info.nii'><p>Retrieve NIfTI Header Information</p></a></li>
<li><a href='#init.nii'><p>Initialize Empty NIfTI File</p></a></li>
<li><a href='#read.nii.volume'>
<p>Read NII Volume</p></a></li>
<li><a href='#read.nii.voxel'>
<p>Read NII Voxel</p></a></li>
<li><a href='#table.to.nii'><p>Table to NII file</p></a></li>
<li><a href='#write.nii.volume'><p>Write NIfTI-1 Volume</p></a></li>
<li><a href='#write.nii.voxel'>
<p>Write NII Voxel</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Read and Write NIfTI Files</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Timothy R. Koscik [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Timothy Koscik &lt;timothy-koscik@uiowa.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for reading and writing NIfTI-1.1 (NII) files, including optimized voxelwise read/write operations and a simplified method to write dataframes to NII.
    Specification of the NIfTI-1.1 format can be found here <a href="https://nifti.nimh.nih.gov/nifti-1">https://nifti.nimh.nih.gov/nifti-1</a>.
    Scientific publication first using these tools
        Koscik TR, Man V, Jahn A, Lee CH, Cunningham WA (2020) &lt;<a href="https://doi.org/10.1016%2Fj.neuroimage.2020.116764">doi:10.1016/j.neuroimage.2020.116764</a>&gt; "Decomposing the neural pathways in a simple, value-based choice." Neuroimage, 214, 116764. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-07 14:03:28 UTC; Tim</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-08 07:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='info.nii'>Retrieve NIfTI Header Information</h2><span id='topic+info.nii'></span>

<h3>Description</h3>

<p>Retrieve information from the NIfTI header of the specified file. The entire header can be retrieved as a list, or a single or subset of items can be specified as a character vector to get specific information. There are several special cases implemented including getting number of voxels, number of volumes, image spacing, and orientation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>info.nii(nii.file, field="hdr")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="info.nii_+3A_nii.file">nii.file</code></td>
<td>
<p>Full directory listing to NIfTI file.</p>
</td></tr>
<tr><td><code id="info.nii_+3A_field">field</code></td>
<td>
<p>A character vector of field names to be returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fields can take a number of different values indicating the entire header, a specific item or subset of header values or set of useful values.
<br /> Number of voxels in XYZ planes: <br /> 'dimensions', 'dims', 'size', 'sz', 'voxels', 'vxls', 'xyz'
<br /> Voxel spacing: <br /> 'space', 'spacing'
<br /> Number of Volumes: <br /> 'volumes', 'vols', 'trs'
<br /> Orientation fields: <br /> 'orientation'
<br /> Entire Header as list object: <br /> 'hdr'
<br /> Subset of specific header items: <br /> 'sizeof_hdr', 'data_type', 'db_name', 'extents', 'session_error', 'regular', 'dim_info', 'dim', 'intent_p1', 'intent_p2', 'intent_p3', 'intent_code', 'datatype', 'bitpix', 'slice_start', 'pixdim', 'vox_offset', 'scl_slope', 'scl_inter', 'slice_end', 'slice_code', 'xyzt_units', 'cal_max', 'cal_min', 'slice_duration', 'toffset', 'glmax', 'glmin', 'descrip', 'aux_file', 'qform_code', 'sform_code', 'quatern_b', 'quatern_c', 'quatern_d', 'qoffset_x', 'qoffset_y', 'qoffset_z', 'srow_x', 'srow_y', 'srow_z', 'intent_name', 'magic'
</p>


<h3>Value</h3>

<p>A vector or named list containing the requested output</p>


<h3>Author(s)</h3>

<p>Timothy R. Koscik &lt;timothy-koscik@uiowa.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get filename for example NII file included in nifti.io package
nii.eg &lt;- system.file("extdata", "egBrain.nii", package="nifti.io")

# get the number of voxels in the 3-dimensional volume of the specified image
image.size &lt;- info.nii(nii.file = nii.eg, field = "dimensions")

# get the size in mm of the volume
image.spacing &lt;- info.nii(nii.file = nii.eg, field = "spacing")

# get the number of volumes
image.volumes &lt;- info.nii(nii.file = nii.eg, field = "volumes")

# get list containing orientation parameters
image.orientation &lt;- info.nii(nii.file = nii.eg, field = "orientation")

# get entire header from NII file
image.hdr &lt;- info.nii(nii.file = nii.eg, field = "hdr")

# get a specific element in the header
image.hdr.datatype &lt;- info.nii(nii.file = nii.eg, field = "datatype")
</code></pre>

<hr>
<h2 id='init.nii'>Initialize Empty NIfTI File</h2><span id='topic+init.nii'></span>

<h3>Description</h3>

<p>This function is used to initialize an empty NIfTI file. It creates the file volume-by-volume rather than a bulk array write operation such that massive arrays do not need to be loaded into memory</p>


<h3>Usage</h3>

<pre><code class='language-R'>init.nii(new.nii,
         ref.nii=NULL,
         dims,
         pixdim=NULL,
         orient=NULL,
         datatype=16,
         init.value=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init.nii_+3A_new.nii">new.nii</code></td>
<td>
<p>Full file path for the file to be written, must have .nii extension</p>
</td></tr>
<tr><td><code id="init.nii_+3A_ref.nii">ref.nii</code></td>
<td>
<p>Full file path for reference image to use same space</p>
</td></tr>
<tr><td><code id="init.nii_+3A_dims">dims</code></td>
<td>
<p>a numeric vector specifying the image dimensions, e.g., c(X,Y,Z,T)</p>
</td></tr>
<tr><td><code id="init.nii_+3A_pixdim">pixdim</code></td>
<td>
<p>An 8 element numeric vector specifying the pixel dimensions image to be created. Should be in the format (a,x,y,z,t,b,c,d), the output from info.nii(&quot;example_file.nii&quot;, &quot;pixdim&quot;) is the correct format</p>
</td></tr>
<tr><td><code id="init.nii_+3A_orient">orient</code></td>
<td>
<p>A named list with the following elements, qform_code [integer(1)], sform_code [integer(1)], quatern_b [numeric(1)], quatern_c [numeric(1)], quatern_d [numeric(1)], qoffset_x [numeric(1)], qoffset_y [numeric(1)], qoffset_z [numeric(1)], srow_x [numeric(3)], srow_y [numeric(3)], srow_z [numeric(3)]</p>
</td></tr>
<tr><td><code id="init.nii_+3A_datatype">datatype</code></td>
<td>
<p>a numeric value indicating the type of tdata to be used in the new NII file, default=16</p>
</td></tr>
<tr><td><code id="init.nii_+3A_init.value">init.value</code></td>
<td>
<p>value to use for all voxels to initialize NIfTI file, default=NA</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value</p>


<h3>Author(s)</h3>

<p>Timothy R. Koscik &lt;timothy-koscik@uiowa.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get filename for example NII file included in nifti.io package
ref.nii &lt;- system.file("extdata", "egBrain.nii", package="nifti.io")

# set new filename (using temporary directory for example)
tdir &lt;- tempdir()
new.nii &lt;- paste0(tdir, "/new.nii")

# initialize new NII file
init.nii(new.nii = new.nii, ref.nii = ref.nii)
</code></pre>

<hr>
<h2 id='read.nii.volume'>
Read NII Volume
</h2><span id='topic+read.nii.volume'></span>

<h3>Description</h3>

<p>Read indicated volume from NIfTI files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.nii.volume(nii.file, vol.num)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.nii.volume_+3A_nii.file">nii.file</code></td>
<td>

<p>Full directory listing to a NIFTI file.  File must not be gzipped.
</p>
</td></tr>
<tr><td><code id="read.nii.volume_+3A_vol.num">vol.num</code></td>
<td>

<p>An integer indicating which volume to read.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NIfTI files need to be unzipped before using this function or any other portions of the nifti.io package. This is necessary given the inconsistent way in which gzipped files are indexed (Some information on this is given in the documentation for the readBin function).
</p>


<h3>Value</h3>

<p>An array containing values from NIFTI volume.
</p>


<h3>Author(s)</h3>

<p>Timothy R. Koscik &lt;timothy-koscik@uiowa.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get filename for example NII file included in nifti.io package
nii.eg &lt;- system.file("extdata", "egBrain.nii", package="nifti.io")

# read entire volume into array
volume.values &lt;- read.nii.volume(nii.file = nii.eg, vol.num = 1)
</code></pre>

<hr>
<h2 id='read.nii.voxel'>
Read NII Voxel
</h2><span id='topic+read.nii.voxel'></span>

<h3>Description</h3>

<p>Read values from NIfTI files at given coordinates (x,y,z,t).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.nii.voxel(nii.file, coords)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.nii.voxel_+3A_nii.file">nii.file</code></td>
<td>

<p>Full directory listing to a NIfTI file.  File must not be gzipped.
</p>
</td></tr>
<tr><td><code id="read.nii.voxel_+3A_coords">coords</code></td>
<td>

<p>A numeric vector conatining x,y,z,t coordinates indicating the location to read values. To read all volumes (timepoints) at an XYZ coordinate use 'Inf' for t, e.g., c(50,50,50,Inf).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NIfTI files need to be unzipped before using this function or any other portions of the nifti.io package. This is necessary given the inconsistent way in which gzipped files are indexed (Some information on this is given in the documentation for the readBin function).
</p>
<p>Values for t coordinates (coords[4]) may be Inf to retrieve all timepoints for the given x,y,z coordinates.  If data is 4D and only x, y, z coordinates are given, the value at those coordinates for the first volume only is returned.
</p>


<h3>Value</h3>

<p>A number or a numeric vector containing values for all timepoints.
</p>


<h3>Author(s)</h3>

<p>Timothy R. Koscik &lt;timothy-koscik@uiowa.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get filename for example NII file included in nifti.io package
nii.eg &lt;- system.file("extdata", "egBrain.nii", package="nifti.io")

# set coordinates (this is a voxel in the head of the
# caudate in the right hemisphere in the example image)
coordinates &lt;- c(20,35,20,1)

# read voxel value at coordinates
voxel.value &lt;- read.nii.voxel(nii.file = nii.eg, coords = coordinates)
</code></pre>

<hr>
<h2 id='table.to.nii'>Table to NII file</h2><span id='topic+table.to.nii'></span>

<h3>Description</h3>

<p>Write Dataframe or Matrix to NII file</p>


<h3>Usage</h3>

<pre><code class='language-R'>  table.to.nii(in.table,
               coords,
               save.dir,
               prefix=NULL,
               do.log=TRUE,
               model.string=NULL,
               ref.nii=NULL,
               img.dims=NULL,
               pixdim=NULL,
               orient=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="table.to.nii_+3A_in.table">in.table</code></td>
<td>
<p>dataframe or matrix object to output to NII file</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_coords">coords</code></td>
<td>
<p>voxel coordinates of location in NII file to write values</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_save.dir">save.dir</code></td>
<td>
<p>directory location to save output</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_prefix">prefix</code></td>
<td>
<p>prefix to be the base of filenames, default is the name of the input table object</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_do.log">do.log</code></td>
<td>
<p>logical, whether or not to write log file providing details about what the output contents are. this may be helpful for sorting through volumes.</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_model.string">model.string</code></td>
<td>
<p>A string to wirte to the log file specifying describing or specifying the model that was run</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_ref.nii">ref.nii</code></td>
<td>
<p>a reference NII image to draw image properties from (e.g., dimensions and orientation)</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_img.dims">img.dims</code></td>
<td>
<p>voxel dimensions of target NII file</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_pixdim">pixdim</code></td>
<td>
<p>voxel dimensions of NII output</p>
</td></tr>
<tr><td><code id="table.to.nii_+3A_orient">orient</code></td>
<td>
<p>orientation list object of NII output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output directly to log.text file and write to specified coordinates in a set of NII files.</p>


<h3>Author(s)</h3>

<p>Timothy R. Koscik &lt;timothy-koscik@uiowa.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get filename for example NII file included in nifti.io package
ref.nii &lt;- system.file("extdata", "egBrain.nii", package="nifti.io")

mdl &lt;- lm(mpg ~ cyl, mtcars)
mdl.coef &lt;- as.data.frame(summary(mdl)$coef)
table.to.nii(in.table=mdl.coef,
             coords=c(20,35,20),
             save.dir=tempdir(),
             prefix="exampleModel_coef",
             model.string="lm(mpg ~ cyl, mtcars)",
             ref.nii=ref.nii)
</code></pre>

<hr>
<h2 id='write.nii.volume'>Write NIfTI-1 Volume</h2><span id='topic+write.nii.volume'></span>

<h3>Description</h3>

<p>Write values to a specific volume in a NIfTI-1 file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  write.nii.volume(nii.file, vol.num, values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.nii.volume_+3A_nii.file">nii.file</code></td>
<td>
<p>Full directory listing to a NIfTI file. File must not be gzipped.</p>
</td></tr>
<tr><td><code id="write.nii.volume_+3A_vol.num">vol.num</code></td>
<td>
<p>An integer indicating which volume to read.</p>
</td></tr>
<tr><td><code id="write.nii.volume_+3A_values">values</code></td>
<td>
<p>an array or vector of values to be written</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NIfTI files need to be unzipped before using this function or any other portions of the nifti.io package. This is necessary given the inconsistent way in which gzipped files are indexed.
</p>


<h3>Value</h3>

<p>Output directly to NIFTI file.
</p>


<h3>Author(s)</h3>

<p>Timothy R. Koscik &lt;timothy-koscik@uiowa.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get filename for example NII file included in nifti.io package
ref.nii &lt;- system.file("extdata", "egBrain.nii", package="nifti.io")

# create a temporary file to write into
tdir &lt;- tempdir()
new.nii &lt;- paste0(tdir, "/new.nii")
init.nii(new.nii = new.nii, ref.nii = ref.nii)

# generate an array of random values the same size as the image volume
xyz.dims &lt;- info.nii(ref.nii, "xyz")
new.values &lt;- array(rnorm(prod(xyz.dims)), dim=xyz.dims)

# write out volume all at once
write.nii.volume(nii.file = new.nii, vol.num = 1, values = new.values)
</code></pre>

<hr>
<h2 id='write.nii.voxel'>
Write NII Voxel
</h2><span id='topic+write.nii.voxel'></span>

<h3>Description</h3>

<p>Write NII Voxel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.nii.voxel(nii.file, coords, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.nii.voxel_+3A_nii.file">nii.file</code></td>
<td>

<p>Full directory listing to a NIfTI file.  File must not be gzipped.
</p>
</td></tr>
<tr><td><code id="write.nii.voxel_+3A_coords">coords</code></td>
<td>

<p>A numeric vector conatining x,y,z,t coordinates indicating the location to write values
</p>
</td></tr>
<tr><td><code id="write.nii.voxel_+3A_value">value</code></td>
<td>

<p>A numeric value to write
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NIfTI files need to be unzipped before using this function or any other portions of the nifti.io package. This is necessary given the inconsistent way in which gzipped files are indexed (Some information on this is given in the documentation for the readBin function).
</p>


<h3>Value</h3>

<p>Output directly to NIFTI file.
</p>


<h3>Author(s)</h3>

<p>Timothy R. Koscik &lt;timothy-koscik@uiowa.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get filename for example NII file included in nifti.io package
ref.nii &lt;- system.file("extdata", "egBrain.nii", package="nifti.io")

# create a temporary file to write into
tdir &lt;- tempdir()
new.nii &lt;- paste0(tdir, "/new.nii")
init.nii(new.nii = new.nii, ref.nii = ref.nii)

# set coordinates and value of voxel to write
coordinates &lt;- c(20,35,20)
new.value &lt;- rnorm(1)

# write to single voxel in NII file
write.nii.voxel(nii.file = new.nii, coords = coordinates, value = new.value)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
