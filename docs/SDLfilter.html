<!DOCTYPE html><html lang="en"><head><title>Help for package SDLfilter</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SDLfilter}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#asymptote'><p>Horizontal asymptotes of rational functions</p></a></li>
<li><a href='#Australia'><p>A map of Australia</p></a></li>
<li><a href='#bathymodel'><p>Bathymetry model for Sandy Strait, Australia</p></a></li>
<li><a href='#boot_area'><p>Cumulative analysis of collective areas by bootstrapping</p></a></li>
<li><a href='#boot_overlap'><p>Bootstrap overlaps between Utilisation Distributions (UDs)</p></a></li>
<li><a href='#combn_overlap'><p>Quantifying overlaps between all possible combination of Utilisation Distributions (UDs)</p></a></li>
<li><a href='#ddfilter'><p>Filter locations using a data driven filter</p></a></li>
<li><a href='#ddfilter_loop'><p>Filter locations by quality index, inner angle, and speed</p></a></li>
<li><a href='#ddfilter_speed'><p>Filter locations by speed</p></a></li>
<li><a href='#depthfilter'><p>Filter locations by water depth</p></a></li>
<li><a href='#distfilter'><p>Filter locations by distance</p></a></li>
<li><a href='#dupfilter'><p>Filter temporal and/or spatial duplicates</p></a></li>
<li><a href='#dupfilter_exact'><p>Filter temporally and spatially exact duplicates</p></a></li>
<li><a href='#dupfilter_qi'><p>Filter temporal duplicates by quality index</p></a></li>
<li><a href='#dupfilter_space'><p>Filter spatial duplicates</p></a></li>
<li><a href='#dupfilter_time'><p>Filter temporal duplicates</p></a></li>
<li><a href='#flatback'><p>Flatback turtle tracking data</p></a></li>
<li><a href='#percent_vol'><p>UD percent volume</p></a></li>
<li><a href='#SandyStrait'><p>A map of Sandy Strait, Australia</p></a></li>
<li><a href='#tidalplane'><p>Tidal plane table for Sandy Strait, Australia</p></a></li>
<li><a href='#tidedata'><p>Tidal data for Sandy Strait, Australia</p></a></li>
<li><a href='#to_map'><p>Plot location data on a map</p></a></li>
<li><a href='#track_param'><p>Calculate parameters between locations</p></a></li>
<li><a href='#turtle'><p>Green turtle tracking data</p></a></li>
<li><a href='#turtle2'><p>Green turtle tracking data 2</p></a></li>
<li><a href='#ud_matrix'><p>A matrix containing probability distributions of flatback turtles</p></a></li>
<li><a href='#ud_raster'><p>A list of raster data containing probability distributions of flatback turtles</p></a></li>
<li><a href='#vmax'><p>Maximum linear speed</p></a></li>
<li><a href='#vmaxlp'><p>Maximum one-way linear speed of a loop trip</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Filtering and Assessing the Sample Size of Tracking Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Takahiro Shimada</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Takahiro Shimada &lt;taka.shimada@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to filter GPS/Argos locations, as well as assessing the sample size for the analysis of animal distributions. The filters remove temporal and spatial duplicates, fixes located at a given height from estimated high tide line, and locations with high error as described in Shimada et al. (2012) &lt;<a href="https://doi.org/10.3354%2Fmeps09747">doi:10.3354/meps09747</a>&gt; and Shimada et al. (2016) &lt;<a href="https://doi.org/10.1007%2Fs00227-015-2771-0">doi:10.1007/s00227-015-2771-0</a>&gt;. Sample size for the analysis of animal distributions can be assessed by the conventional area-based approach or the alternative probability-based approach as described in Shimada et al. (2021) &lt;<a href="https://doi.org/10.1111%2F2041-210X.13506">doi:10.1111/2041-210X.13506</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), ggplot2</td>
</tr>
<tr>
<td>Imports:</td>
<td>geosphere, data.table, gridExtra, ggmap, maps, pracma,
lubridate, dplyr, emmeans, utils, sf, stars, ggspatial</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/TakahiroShimada/SDLfilter">https://github.com/TakahiroShimada/SDLfilter</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/TakahiroShimada/SDLfilter/issues">https://github.com/TakahiroShimada/SDLfilter/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-09 23:25:03 UTC; root</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-10 00:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='asymptote'>Horizontal asymptotes of rational functions</h2><span id='topic+asymptote'></span>

<h3>Description</h3>

<p>Function to find horizontal asymptotes of a rational function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asymptote(
  data = NULL,
  x = NULL,
  y = NULL,
  degree = "optim",
  upper.degree = 5,
  d1 = NA,
  d2 = NA,
  threshold = 0.95,
  proportional = TRUE,
  max.asymptote = 1,
  estimator = "glm",
  ci.level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="asymptote_+3A_data">data</code></td>
<td>
<p>An output object from <code><a href="#topic+boot_overlap">boot_overlap</a></code>, <code><a href="#topic+combn_overlap">combn_overlap</a></code>, or <code><a href="#topic+boot_area">boot_area</a></code>.</p>
</td></tr>
<tr><td><code id="asymptote_+3A_x">x</code>, <code id="asymptote_+3A_y">y</code></td>
<td>
<p>Numeric vectors of independent (x) and dependent (y) variables. 
These parameters will be ignored if <em>data</em> is supplied.</p>
</td></tr>
<tr><td><code id="asymptote_+3A_degree">degree</code></td>
<td>
<p>The default 'optim' option selects the maximal degree of numerator and denominator of a rational function 
that minimises the mean squared error. 
Alternatively, an integer can be used to specify the maximal degree.
The 'optim' option is recommended unless there is a strong reason that a maximal degree should be specified.</p>
</td></tr>
<tr><td><code id="asymptote_+3A_upper.degree">upper.degree</code></td>
<td>
<p>The upper limit of the maximal degree to be assessed when the 'optim' option is selected. 
Default is 5, meaning the &quot;optimal&quot; degree is searched from 1 and 10. 
The default usually gives good results. If the fit does not look good, a larger value may result in a better fit.</p>
</td></tr>
<tr><td><code id="asymptote_+3A_d1">d1</code>, <code id="asymptote_+3A_d2">d2</code></td>
<td>
<p>(Deprecated) Maximal degrees of numerator (d1) and denominator (d2) of a rational function. d1 and d2 must be equal. 
Use <em>degree</em> instead.</p>
</td></tr>
<tr><td><code id="asymptote_+3A_threshold">threshold</code></td>
<td>
<p>Threshold value for considering an asymptote. 
Once the y value reaches the threshold, it is considered that an asymptote is reached.</p>
</td></tr>
<tr><td><code id="asymptote_+3A_proportional">proportional</code></td>
<td>
<p>If TRUE (default), a threshold is calculated as <em>estimated asymptote * threshold</em>. 
If FALSE, the value specified in <em>threshold</em> is used in the analysis.</p>
</td></tr>
<tr><td><code id="asymptote_+3A_max.asymptote">max.asymptote</code></td>
<td>
<p>The maximum limit of an expected asymptote. Default is 1 (i.e. maximum probability). 
If it is unknown, set as NA (e.g. max.asymptote = NA).</p>
</td></tr>
<tr><td><code id="asymptote_+3A_estimator">estimator</code></td>
<td>
<p>Method used to estimate the mean or predicted <em>y</em> relative to <em>x</em> (e.g. sample size).
Available options are 'mean' using arithmetic means and 'glm' using the <code><a href="stats.html#topic+glm">glm</a></code> function.</p>
</td></tr>
<tr><td><code id="asymptote_+3A_ci.level">ci.level</code></td>
<td>
<p>Confidence level for the mean or predicted <em>y</em>, which will be used to assess if/when an asymptote has been reached.
If NULL, only the mean and predicted <em>y</em> are used for the assessment (see details).</p>
</td></tr>
<tr><td><code id="asymptote_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a rational function to the input data. 
When an output object from <code><a href="#topic+boot_overlap">boot_overlap</a></code>, <code><a href="#topic+combn_overlap">combn_overlap</a></code> or <code><a href="#topic+boot_area">boot_area</a></code> is supplied, 
a rational function is fit to the means or predicted values of the bootstrap results (e.g. mean overlap probability) 
as a function of <em>x</em> (e.g. sample size).
It then estimates horizontal asymptotes and identifies the sample size when an asymptote is considered.
If ci.level = NULL and threshold = 0.95, 
an asymptote is considered when the mean or predicted y value reaches above 95
If ci.level is specified (e.g. 0.95) and threshold = 0.95,
an asymptote is considered when the mean or predicted y value AND the confidence interval are above 95
When the &quot;PHR&quot; method was used in <code><a href="#topic+boot_overlap">boot_overlap</a></code>, 
binomial is generally a sensible <code><a href="stats.html#topic+family">family</a></code> object for the GLM.
gaussian and Gamma are often good options when the maximum <em>y</em> value exceeds 1 (e.g. area size).
Please caution if estimated horizontal asymptote is very different from the expected asymptote. 
For example, the estimated horizontal asymptote should be around 1 when overlaps between UDs are calculated using the &quot;PHR&quot; method.
see <code><a href="#topic+boot_overlap">boot_overlap</a></code>.
</p>


<h3>Value</h3>

<p>A list containing a data frame (rational function fit associated with x values), an estimated horizontal asymptote, 
the minimum sample size if an asymptote is reached, and the estimated optimal degree of numerator and denominator of the rational function.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Thums M, Hamann M, Limpus CJ, Hays GC, FitzSimmons N, Wildermann NE, Duarte CD, Meekan MG (2021) 
Optimising sample sizes for animal distribution analysis using tracking data. 
<em>Methods in Ecology and Evolution</em> 12(2):288-297 <a href="https://doi.org/10.1111/2041-210X.13506">doi:10.1111/2041-210X.13506</a>
</p>
<p>Press, W. H., S. A. Teukolsky, W. T. Vetterling, and B. P. Flannery (2007). 
<em>Numerical Recipes: The Art of Numerical Computing</em>. Third Edition, Cambridge University Press, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot_overlap">boot_overlap</a></code>, <code><a href="#topic+combn_overlap">combn_overlap</a></code>, <code><a href="#topic+boot_area">boot_area</a></code>
</p>

<hr>
<h2 id='Australia'>A map of Australia</h2><span id='topic+Australia'></span>

<h3>Description</h3>

<p>This map layer outlines the coast of Australia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Australia
</code></pre>


<h3>Format</h3>

<p>A data.frame
</p>

<hr>
<h2 id='bathymodel'>Bathymetry model for Sandy Strait, Australia</h2><span id='topic+bathymodel'></span>

<h3>Description</h3>

<p>A high resolution bathymetry model (100 m) for the Sandy Strait region developed by Beaman, R.J. (2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bathymodel
</code></pre>


<h3>Format</h3>

<p>A stars
</p>


<h3>Source</h3>

<p><a href="https://www.deepreef.org/">https://www.deepreef.org/</a>
</p>


<h3>References</h3>

<p>Beaman, R.J. (2010) Project 3DGBR: A high-resolution depth model for the Great Barrier Reef and Coral Sea. 
<em>Marine and Tropical Sciences Research Facility (MTSRF) Project 2.5i.1a Final Report</em>, MTSRF, Cairns, Australia, pp. 13 plus Appendix 1.
</p>

<hr>
<h2 id='boot_area'>Cumulative analysis of collective areas by bootstrapping</h2><span id='topic+boot_area'></span>

<h3>Description</h3>

<p>Function to calculate collective areas (merged x% Utilisation Distributions or UDs) of <em>n</em> individuals by bootstrapping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot_area(
  data,
  cell.size = NA,
  R = 1000,
  percent = 50,
  quantiles = c(0.25, 0.5, 0.75)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boot_area_+3A_data">data</code></td>
<td>
<p>A matrix or list of RasterLayer/SpatRaster objects. 
Each row of the matrix or each RasterLayer/SpatRaster object contains a utilisation distribution 
(or other statistics that sums to 1 - e.g. proportion of time spent).
<b>The grid size and geographical extent must be consistent across each row of the matrix or each RasterLayer/SpatRaster object.</b>
The function assumes that each column of the matrix is associated with a unique geographical location or 
that each RasterLayer/SpatRaster has exactly the same geographical extent and resolution.</p>
</td></tr>
<tr><td><code id="boot_area_+3A_cell.size">cell.size</code></td>
<td>
<p>A numeric value specifying the grid cell size of the input data in metres.</p>
</td></tr>
<tr><td><code id="boot_area_+3A_r">R</code></td>
<td>
<p>An integer specifying the number of iterations. A larger <em>R</em> is required when the sample size is large. 
R &gt; sample size x 100 is recommended (e.g. R &gt; 1000 for a sample size 10).</p>
</td></tr>
<tr><td><code id="boot_area_+3A_percent">percent</code></td>
<td>
<p>An integer specifying the percent volume of each UD to be considered in the analysis.</p>
</td></tr>
<tr><td><code id="boot_area_+3A_quantiles">quantiles</code></td>
<td>
<p>A vector or a number to specify the quantiles to be calculated in the summary of the results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates collective areas (e.g. 50% UDs) of 1 to <em>n</em> individuals by bootstrapping.
</p>


<h3>Value</h3>

<p>A list containing two data frames - raw results and summary (mean, sd, sem and quantiles at each sample size).
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Thums M, Hamann M, Limpus CJ, Hays GC, FitzSimmons N, Wildermann NE, Duarte CD, Meekan MG (2021) 
Optimising sample sizes for animal distribution analysis using tracking data. 
<em>Methods in Ecology and Evolution</em> 12(2):288-297 <a href="https://doi.org/10.1111/2041-210X.13506">doi:10.1111/2041-210X.13506</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot_overlap">boot_overlap</a></code>, <code><a href="#topic+combn_overlap">combn_overlap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

#1 Utilisation distributions of flatback turtles (n = 15).
data(ud_raster)

#2 Calculate collective areas from 3000 random permutation
area &lt;- boot_area(ud_raster, R = 3000, percent = 50)

#3 Find the minimum sample size required to estimate the general distribution.
a &lt;- asymptote(area, upper.degree = 10, estimator = 'glm', family = gaussian, max.asymptote = NA)

#4 Plot the mean collective area and rational function fit relative to the sample sizes.
ggplot(data = a$results, aes(x = x))+
  geom_pointrange(aes(y = y, ymin = y_lwr, ymax = y_upr)) + 
  geom_point(aes(y = y), size = 2) + 
  scale_x_continuous(breaks = seq(0, 15, 3), limits = c(2,15), name = "Animals tracked (n)") +
  scale_y_continuous(name = expression(Area~(km^2)), labels=function(x) x/1e6)

## End(Not run)
</code></pre>

<hr>
<h2 id='boot_overlap'>Bootstrap overlaps between Utilisation Distributions (UDs)</h2><span id='topic+boot_overlap'></span>

<h3>Description</h3>

<p>Function to calculate overlaps between UDs relative to sample size by bootstrapping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot_overlap(
  data,
  R = 1000,
  method = "PHR",
  percent = 100,
  quantiles = c(0.25, 0.5, 0.75)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boot_overlap_+3A_data">data</code></td>
<td>
<p>A matrix or list of RasterLayer/SpatRaster objects. 
Each row of the matrix or each RasterLayer/SpatRaster object contains a utilisation distribution 
(or other statistics that sums to 1 - e.g. proportion of time spent).
<b>The grid size and geographical extent must be consistent across each row of the matrix or each RasterLayer/SpatRaster object.</b>
The function assumes that each column of the matrix is associated with a unique geographical location or 
that each RasterLayer/SpatRaster has exactly the same geographical extent and resolution.</p>
</td></tr>
<tr><td><code id="boot_overlap_+3A_r">R</code></td>
<td>
<p>An integer specifying the number of iterations. A larger <em>R</em> is required when the sample size is large.
R &gt; sample size x 100 is recommended (e.g. R &gt; 1000 for a sample size 10).</p>
</td></tr>
<tr><td><code id="boot_overlap_+3A_method">method</code></td>
<td>
<p>The overlap quantification method. 
&quot;HR&quot; is for the proportion of an individual's home range overlapped by the known habitats of other individuals. 
&quot;PHR&quot; is for the probability of an individual to be within the known habitats of other individuals. 
&quot;VI&quot;, &quot;BA&quot; and &quot;UDOI&quot; quantify overlap between UDs using the full probabilistic properties as described in Fieberg and Kochanny (2005). 
For the latter three options, the function calculates overlaps between each additional UD and a collective UD. 
To generate a collective UD, each UD is overlaid and averaged at each grid cell so the probability density of the collective UD sums up to 1.</p>
</td></tr>
<tr><td><code id="boot_overlap_+3A_percent">percent</code></td>
<td>
<p>An integer specifying the percent volume of each UD to be considered in the analysis.</p>
</td></tr>
<tr><td><code id="boot_overlap_+3A_quantiles">quantiles</code></td>
<td>
<p>A vector or a number to specify the quantiles to be calculated in the summary of the results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates and bootstraps overlap between UDs based on the areas (&quot;HR&quot;), 
areas of collective UDs and the probability distribution of each individual (&quot;PHR&quot;), 
or the probability distribution of an individual and an averaged probability distribution of collective individuals (&quot;VI&quot;, &quot;BA&quot;, &quot;UDOI&quot;).
</p>


<h3>Value</h3>

<p>A list containing two data frames - raw results and summary (mean, sd, sem and quantiles at each sample size).
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Thums M, Hamann M, Limpus CJ, Hays GC, FitzSimmons N, Wildermann NE, Duarte CD, Meekan MG (2021) 
Optimising sample sizes for animal distribution analysis using tracking data. 
<em>Methods in Ecology and Evolution</em> 12(2):288-297 <a href="https://doi.org/10.1111/2041-210X.13506">doi:10.1111/2041-210X.13506</a>
</p>
<p>Fieberg J &amp; Kochanny CO (2005) Quantifying home-range overlap: The importance of the utilization distribution. 
<em>The Journal of Wildlife Management</em>, 69(4), 1346–1359. <a href="https://doi.org/10.2193/0022-541x%282005%2969%5B1346%3AQhotio%5D2.0.Co%3B2">doi:10.2193/0022-541x(2005)69[1346:Qhotio]2.0.Co;2</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+combn_overlap">combn_overlap</a></code>, <code><a href="#topic+boot_area">boot_area</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

#1 Utilisation uistributions of flatback turtles (n = 15).
data(ud_matrix)

#2 Calculate overlap probability from 2000 random permutation.
overlap &lt;- boot_overlap(ud_matrix, R = 2000, method = "PHR")

#3 Find the minimum sample size required to estimate the general distribution.
a &lt;- asymptote(overlap, upper.degree = 10, estimator = 'glm', family = binomial)

#4 Plot the mean probability and rational function fit relative to the sample sizes.
ggplot(data = a$results, aes(x = x))+
  geom_pointrange(aes(y = y, ymin = y_lwr, ymax = y_upr)) + 
  geom_hline(yintercept = a$h.asymptote*0.95, linetype = 2) +
  scale_x_continuous(breaks = seq(0, 15, 3), limits = c(2,15), name = "Animals tracked (n)") +
  scale_y_continuous(limits = c(0.5,1), name = "Overlap probability")

## End(Not run)
</code></pre>

<hr>
<h2 id='combn_overlap'>Quantifying overlaps between all possible combination of Utilisation Distributions (UDs)</h2><span id='topic+combn_overlap'></span>

<h3>Description</h3>

<p>Function to calculate overlaps between all possible combination of UDs relative to sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combn_overlap(
  data,
  method = "PHR",
  percent = 100,
  quantiles = c(0.25, 0.5, 0.75)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combn_overlap_+3A_data">data</code></td>
<td>
<p>A matrix or list of RasterLayer/SpatRaster objects. 
Each row of the matrix or each RasterLayer/SpatRaster object contains a utilisation distribution 
(or other statistics that sums to 1 - e.g. proportion of time spent).
<b>The grid size and geographical extent must be consistent across each row of the matrix or each RasterLayer/SpatRaster object.</b>
The function assumes that each column of the matrix is associated with a unique geographical location or 
that each RasterLayer/SpatRaster has exactly the same geographical extent and resolution.</p>
</td></tr>
<tr><td><code id="combn_overlap_+3A_method">method</code></td>
<td>
<p>The overlap quantification method. 
&quot;HR&quot; is for the proportion of an individual's home range overlapped by the known habitats of other individuals. 
&quot;PHR&quot; is for the probability of an individual to be within the known habitats of other individuals. 
&quot;VI&quot;, &quot;BA&quot; and &quot;UDOI&quot; quantify overlap between UDs using the full probabilistic properties as described in Fieberg and Kochanny (2005). 
For the latter three options, the function calculates overlaps between each additional UD and a collective UD. 
To generate a collective UD, each UD is overlaid and averaged at each grid cell so the probability density of the collective UD sums up to 1.</p>
</td></tr>
<tr><td><code id="combn_overlap_+3A_percent">percent</code></td>
<td>
<p>An integer specifying the percent volume of each UD to be considered in the analysis.</p>
</td></tr>
<tr><td><code id="combn_overlap_+3A_quantiles">quantiles</code></td>
<td>
<p>A vector or a number to specify the quantiles to be calculated in the summary of the results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates overlap between all possible combination of input UDs based on the areas (&quot;HR&quot;), 
areas of collective UDs and the probability distribution of each individual (&quot;PHR&quot;), 
or the probability distribution of an individual and an averaged probability distribution of collective individuals (&quot;VI&quot;, &quot;BA&quot;, &quot;UDOI&quot;).
</p>


<h3>Value</h3>

<p>A list containing two data frames - raw results and summary (mean, sd, sem and quantiles at each sample size).
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Thums M, Hamann M, Limpus CJ, Hays GC, FitzSimmons N, Wildermann NE, Duarte CD, Meekan MG (2021) 
Optimising sample sizes for animal distribution analysis using tracking data. 
<em>Methods in Ecology and Evolution</em> 12(2):288-297 <a href="https://doi.org/10.1111/2041-210X.13506">doi:10.1111/2041-210X.13506</a>
</p>
<p>Fieberg J &amp; Kochanny CO (2005) Quantifying home-range overlap: The importance of the utilization distribution. 
<em>The Journal of Wildlife Management</em>, 69(4), 1346–1359. <a href="https://doi.org/10.2193/0022-541x%282005%2969%5B1346%3AQhotio%5D2.0.Co%3B2">doi:10.2193/0022-541x(2005)69[1346:Qhotio]2.0.Co;2</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot_overlap">boot_overlap</a></code>, <code><a href="#topic+boot_area">boot_area</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

#1 Utilisation uistributions of flatback turtles (n = 15).
data(ud_matrix)

#2 Calculate overlap probability from all combination of the UDs.
overlap &lt;- combn_overlap(ud_matrix, method = "PHR")

#3 Find the minimum sample size required to estimate the general distribution.
a &lt;- asymptote(overlap, upper.degree = 10, ci.level = NULL)

#4 Plot the mean probability and rational function fit relative to the sample sizes.
ggplot(data = a$results, aes(x = x, y = y))+
  geom_point() +
  geom_hline(yintercept = a$h.asymptote*0.95, linetype = 2) +
  scale_x_continuous(breaks = seq(0, 15, 3), limits = c(2,15), name = "Animals tracked (n)") +
  scale_y_continuous(limits = c(0.5,1), name = "Overlap probability")

## End(Not run)
</code></pre>

<hr>
<h2 id='ddfilter'>Filter locations using a data driven filter</h2><span id='topic+ddfilter'></span>

<h3>Description</h3>

<p>Function to remove locations by a data driven filter as described in Shimada et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddfilter(sdata, vmax = 8.9, vmaxlp = 1.8, qi = 4, ia = 90, method = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ddfilter_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or 
<code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="ddfilter_+3A_vmax">vmax</code></td>
<td>
<p>A numeric value specifying a threshold of speed from a previous and/or to a subsequent fix. 
Default is 8.9km/h. 
If this value is unknown, it can be estimated from <em>sdata</em> using the function <code><a href="#topic+vmax">vmax</a></code>.</p>
</td></tr>
<tr><td><code id="ddfilter_+3A_vmaxlp">vmaxlp</code></td>
<td>
<p>A numeric value specifying a threshold of speed, which is used to evaluate the locations of loop trips. 
Default is 1.8 km/h.
If this value is unknown, it can be estimated from <em>sdata</em> using the function <code><a href="#topic+vmaxlp">vmaxlp</a></code>.</p>
</td></tr>
<tr><td><code id="ddfilter_+3A_qi">qi</code></td>
<td>
<p>An integer specifying a threshold of quality index, which is used to evaluate the locations of loop trips. 
Default is 4.</p>
</td></tr>
<tr><td><code id="ddfilter_+3A_ia">ia</code></td>
<td>
<p>An integer specifying a threshold of inner angle, which is used to evaluate the locations of loop trips. 
Default is 90 degrees.</p>
</td></tr>
<tr><td><code id="ddfilter_+3A_method">method</code></td>
<td>
<p>An integer (1 or 2) specifying how locations should be filtered with <em>vmax</em>. 
Default is 1 (both way) and removes a location if the speed from a previous AND to a subsequent location exceeds <em>vmax</em>. 
Select 2 (one way) to remove a location if the speed from a previous OR to a subsequent location exceeds <em>vmax</em>. 
For the latter, the filter examines successive suspect locations (i.e. the speed from a previous and/or to a subsequent location exceeds <em>vmax</em>) 
and retain one location that is associated with the minimum speed from a previous and/or to a subsequent location.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Locations are removed if the speed from a previous and/or to a subsequent location exceeds <em>vmax</em>, 
or if all of the following criteria apply: the associated quality index is less than or equal to <em>qi</em>, 
the inner angle is less than or equal to <em>ia</em> and the speed either from a previous 
or to a subsequent location exceeds <em>vmaxlp</em>. 
If <em>vmax</em> and <em>vmaxlp</em> are unknown, they can be estimated using the functions <code><a href="#topic+vmax">vmax</a></code> and <code><a href="#topic+vmaxlp">vmaxlp</a></code> respectively.
</p>


<h3>Value</h3>

<p>The input data is returned without locations identified by this filter. 
The following columns are added: &quot;pTime&quot;, &quot;sTime&quot;, &quot;pDist&quot;, &quot;sDist&quot;, &quot;pSpeed&quot;, &quot;sSpeed&quot;, &quot;inAng&quot;. 
&quot;pTime&quot; and &quot;sTime&quot; are hours from a previous and to a subsequent fix respectively. 
&quot;pDist&quot; and &quot;sDist&quot; are straight distances in kilometres from a previous and to a subsequent fix respectively. 
&quot;pSpeed&quot; and &quot;sSpeed&quot; are linear speed from a previous and to a subsequent fix respectively. 
&quot;inAng&quot; is the degree between the bearings of lines joining successive location points.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Jones R, Limpus C, Hamann M (2012) 
Improving data retention and home range estimates by data-driven screening. 
<em>Marine Ecology Progress Series</em> 457:171-180 <a href="https://doi.org/10.3354/meps09747">doi:10.3354/meps09747</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfilter_speed">ddfilter_speed</a></code>, <code><a href="#topic+ddfilter_loop">ddfilter_loop</a></code>, <code><a href="#topic+vmax">vmax</a></code>, <code><a href="#topic+vmaxlp">vmaxlp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Load data sets
## Fastloc GPS data obtained from a green turtle
data(turtle)

## A Map for the example site
data(Australia)
data(SandyStrait)


#### Filter temporal and/or spatial duplicates
turtle.dup &lt;- dupfilter(turtle, step.time=5/60, step.dist=0.001)
 

#### ddfilter
## Using the built-in function to estimate the threshold speeds
V &lt;- vmax(turtle.dup)
VLP &lt;- vmaxlp(turtle.dup)
turtle.dd &lt;- ddfilter(turtle.dup, vmax=V, vmaxlp=VLP)

## Or using user specified threshold speeds
turtle.dd &lt;- ddfilter(turtle.dup, vmax=9.9, qi=4, ia=90, vmaxlp=2.0)


#### Plot data removed or retained by ddfilter
## Entire area
p1 &lt;- to_map(turtle.dup, bgmap=Australia, point.size = 2, line.size = 0.5, axes.lab.size = 0, 
            multiplot = FALSE, point.bg = "red",
            title.size=15, title="Entire area")[[1]] + 
  geom_point(aes(x=lon, y=lat), data=turtle.dd, size=2, fill="yellow", shape=21)+
  geom_point(aes(x=x, y=y), data=data.frame(x=c(154, 154), y=c(-22, -22.5)), 
             size=3, fill=c("yellow", "red"), shape=21) + 
  annotate("text", x=c(154.3, 154.3), y=c(-22, -22.5), label=c("Retained", "Removed"), 
           colour="black", size=4, hjust = 0)

## Zoomed in
p2 &lt;- to_map(turtle.dup, bgmap=SandyStrait, xlim=c(152.7, 153.2), ylim=(c(-25.75, -25.24)), 
            axes.lab.size = 0, point.size = 2, point.bg = "red", line.size = 0.5, 
            multiplot = FALSE, title.size=15, title="Zoomed in")[[1]] + 
geom_path(aes(x=lon, y=lat), data=turtle.dd, linewidth=0.5, colour="black", linetype=1) + 
geom_point(aes(x=lon, y=lat), data=turtle.dd, size=2, colour="black", shape=21, fill="yellow")

gridExtra::marrangeGrob(list(p1, p2), nrow=1, ncol=2)
</code></pre>

<hr>
<h2 id='ddfilter_loop'>Filter locations by quality index, inner angle, and speed</h2><span id='topic+ddfilter_loop'></span>

<h3>Description</h3>

<p>A partial component of <code><a href="#topic+ddfilter">ddfilter</a></code>, although works as a stand-alone function. 
This function removes locations by speed, inner angle, and quality index as described in Shimada et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddfilter_loop(sdata, qi = 4, ia = 90, vmaxlp = 1.8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ddfilter_loop_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="ddfilter_loop_+3A_qi">qi</code></td>
<td>
<p>An integer specifying a threshold of quality index, which is used to evaluate the locations of loop trips. 
Default is 4.</p>
</td></tr>
<tr><td><code id="ddfilter_loop_+3A_ia">ia</code></td>
<td>
<p>An integer specifying a threshold of inner angle, which is used to evaluate the locations of loop trips. 
Default is 90 degrees.</p>
</td></tr>
<tr><td><code id="ddfilter_loop_+3A_vmaxlp">vmaxlp</code></td>
<td>
<p>A numeric value specifying a threshold of speed, which is used to evaluate the locations of loop trips. 
Default is 1.8 km/h.
If this value is unknown, it can be estimated from <em>sdata</em> using the function <code><a href="#topic+vmaxlp">vmaxlp</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function removes locations if all of the following criteria apply: 
the number of source satellites are less than or equal to <em>qi</em>, 
the inner angle is less than and equal to <em>ia</em> and the speed either from a previous or to a subsequent location exceeds <em>vmaxlp</em>. 
If <em>vmaxlp</em> is unknown, it can be estimated using the function <code><a href="#topic+vmaxlp">vmaxlp</a></code>.
</p>


<h3>Value</h3>

<p>The input data is returned without locations identified by this filter.
The following columns are added: &quot;pTime&quot;, &quot;sTime&quot;, &quot;pDist&quot;, &quot;sDist&quot;, &quot;pSpeed&quot;, &quot;sSpeed&quot;, &quot;inAng&quot;.
&quot;pTime&quot; and &quot;sTime&quot; are hours from a previous and to a subsequent fix respectively.
&quot;pDist&quot; and &quot;sDist&quot; are straight distances in kilometres from a previous and to a subsequent fix respectively.
&quot;pSpeed&quot; and &quot;sSpeed&quot; are linear speed from a previous and to a subsequent fix respectively.
&quot;inAng&quot; is the degree between the bearings of lines joining successive location points.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Jones R, Limpus C, Hamann M (2012) Improving data retention and home range estimates by data-driven screening. 
<em>Marine Ecology Progress Series</em> 457:171-180 <a href="https://doi.org/10.3354/meps09747">doi:10.3354/meps09747</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfilter">ddfilter</a></code>, <code><a href="#topic+ddfilter_speed">ddfilter_speed</a></code>, <code><a href="#topic+vmaxlp">vmaxlp</a></code>
</p>

<hr>
<h2 id='ddfilter_speed'>Filter locations by speed</h2><span id='topic+ddfilter_speed'></span>

<h3>Description</h3>

<p>A partial component of <code><a href="#topic+ddfilter">ddfilter</a></code>, although works as a stand-alone function. 
This function removes locations by a given threshold speed as described in Shimada et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddfilter_speed(sdata, vmax = 8.9, method = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ddfilter_speed_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="ddfilter_speed_+3A_vmax">vmax</code></td>
<td>
<p>A numeric value specifying a threshold of speed from a previous and/or to a subsequent fix. 
Default is 8.9km/h. 
If this value is unknown, it can be estimated from <em>sdata</em> using the function <code><a href="#topic+vmax">vmax</a></code>.</p>
</td></tr>
<tr><td><code id="ddfilter_speed_+3A_method">method</code></td>
<td>
<p>An integer (1 or 2) specifying how locations should be filtered. 
Default is 1 and removes a location if the speed from a previous AND to a subsequent location exceeds <em>vmax</em>. 
Select 2 to remove a location if the speed from a previous OR to a subsequent location exceeds <em>vmax</em>. 
For the latter, the filter examines successive suspect locations (i.e. the speed from a previous and/or to a subsequent location exceeds <em>vmax</em>) 
and retain one location that is associated with the minimum speed from a previous and to a subsequent location.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function removes locations if the speed from a previous and/or to a subsequent location exceeds a given threshold speed. 
If <em>vmax</em> is unknown, it can be estimated using the function <code><a href="#topic+vmax">vmax</a></code>.
</p>


<h3>Value</h3>

<p>The input data is returned without locations identified by this filter. 
The following columns are added: &quot;pTime&quot;, &quot;sTime&quot;, &quot;pDist&quot;, &quot;sDist&quot;, &quot;pSpeed&quot;, &quot;sSpeed&quot;. 
&quot;pTime&quot; and &quot;sTime&quot; are hours from a previous and to a subsequent fix respectively. 
&quot;pDist&quot; and &quot;sDist&quot; are straight distances in kilometres from a previous and to a subsequent fix respectively. 
&quot;pSpeed&quot; and &quot;sSpeed&quot; are linear speed from a previous and to a subsequent fix respectively.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Jones R, Limpus C, Hamann M (2012) 
Improving data retention and home range estimates by data-driven screening.
<em>Marine Ecology Progress Series</em> 457:171-180 <a href="https://doi.org/10.3354/meps09747">doi:10.3354/meps09747</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfilter">ddfilter</a></code>, <code><a href="#topic+ddfilter_loop">ddfilter_loop</a></code>, <code><a href="#topic+vmax">vmax</a></code>, <code><a href="#topic+track_param">track_param</a></code>
</p>

<hr>
<h2 id='depthfilter'>Filter locations by water depth</h2><span id='topic+depthfilter'></span>

<h3>Description</h3>

<p>Function to filter locations according to bathymetry and tide.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>depthfilter(
  sdata,
  bathymetry,
  bilinear = TRUE,
  qi = 4,
  tide,
  tidal.plane,
  type = "HT",
  height = 0,
  filter = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="depthfilter_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="depthfilter_+3A_bathymetry">bathymetry</code></td>
<td>
<p>A stars object containing bathymetric data in metres. 
Negative and positive values indicate below and above the water respectively. 
Geographic coordinate system is WGS84.</p>
</td></tr>
<tr><td><code id="depthfilter_+3A_bilinear">bilinear</code></td>
<td>
<p>Logical. This defines a method for how to extract cell values from the <em>bathymetry</em> layer.
Options are bilinear (TRUE) or nearest neighbour (False) as inherited from <code><a href="stars.html#topic+st_extract">st_extract</a></code>.</p>
</td></tr>
<tr><td><code id="depthfilter_+3A_qi">qi</code></td>
<td>
<p>An integer specifying a threshold of quality index. 
<em>depthfilter</em> does not filter a location that is associated with a quality index higher than this threshold. 
Default is 4.</p>
</td></tr>
<tr><td><code id="depthfilter_+3A_tide">tide</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;tideDT&quot;, &quot;reading&quot;, &quot;standard.port&quot;. 
&quot;tideDT&quot; is date &amp; time in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> at each observation. &quot;reading&quot; is the observed tidal height in metres. 
&quot;standard.port&quot; is the identifier of each tidal station.</p>
</td></tr>
<tr><td><code id="depthfilter_+3A_tidal.plane">tidal.plane</code></td>
<td>
<p>A data frame containing columns with the following headers: 
&quot;standard.port&quot;, &quot;secondary.port&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;timeDiff&quot;, &quot;datumDiff&quot;. 
&quot;standard.port&quot; is the identifier for a tidal observation station. 
&quot;secondary.port&quot; is the identifier for a station at which tide is only predicted using tidal records observed at the related standard port. 
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each secondary port in decimal degrees. 
&quot;timeDiff&quot; is the time difference between standard port and its associated secondary port. 
&quot;datumDiff&quot; is the baseline difference in metres if bathymetry and tidal observations/predictions 
uses different datum (e.g. LAT and MSL).</p>
</td></tr>
<tr><td><code id="depthfilter_+3A_type">type</code></td>
<td>
<p>The type of water depth considered in the filtering process.
&quot;exp&quot; is for the water depth experienced by the animal at the time.
This option may be applicable to species that remain in water at all times (e.g. dugongs, dolphins, etc).
&quot;HT&quot; is for the water depth at the nearest high tide (default). 
This option is useful for animals that use inter-tidal zones at high tide and may remain there even after the tide drops (e.g. some sea turtles).</p>
</td></tr>
<tr><td><code id="depthfilter_+3A_height">height</code></td>
<td>
<p>A numerical value to adjust the water depth an animal is likely to use. Default is 0 m. 
This parameter is useful if the minimum water depth used by the animal is known. 
For example, a dugong is unlikely to use water shallower than its body height (e.g. ~0.5 m)
so it may be sensible to consider the fix is an error if the estimated water depth is shallower than its body height.
A negative value indicates below the water surface. 
For the dugong example, to remove locations for which the water depth was &lt;0.5 m, 
it should be specified as; height = -0.5.
By supplying the body height to this argument, all the locations recorded shallower than its body will be removed.</p>
</td></tr>
<tr><td><code id="depthfilter_+3A_filter">filter</code></td>
<td>
<p>Default is TRUE. 
If FALSE, the function does not filter locations but it still returns estimates of the water depth experienced by the animal at each location.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function examines each location according to the water depth experienced by the animal or the water depth at the nearest high tide. 
The function looks for the closest match between each fix and tidal observations or predictions in temporal and spatial scales. 
When <em>filter</em> is disabled, the function does not filter locations but returns the estimated water depth of each location with 
the tide effect considered (bathymetry + tide).
</p>


<h3>Value</h3>

<p>When <em>filter</em> option is enabled, this function filters the input data and returns with two additional columns; &quot;depth.exp&quot;, &quot;depth.HT&quot;. 
&quot;depth.exp&quot; is the estimated water depth at each location at the time of location fixing. 
&quot;depth.HT&quot; is the estimated water depth at the nearest high tide at each location.
</p>


<h3>Note</h3>

<p>The input data must not contain temporal or spatial duplicates.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Limpus C, Jones R, Hazel J, Groom R, Hamann M (2016) 
Sea turtles return home after intentional displacement from coastal foraging areas. 
<em>Marine Biology</em> 163:1-14 <a href="https://doi.org/10.1007/s00227-015-2771-0">doi:10.1007/s00227-015-2771-0</a>
</p>
<p>Beaman, R.J. (2010) Project 3DGBR: A high-resolution depth model for the Great Barrier Reef and Coral Sea. 
<em>Marine and Tropical Sciences Research Facility (MTSRF) Project 2.5i.1a Final Report</em>, MTSRF, Cairns, Australia, pp. 13 plus Appendix 1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dupfilter">dupfilter</a></code>, <code><a href="#topic+ddfilter">ddfilter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

#### Load data sets
## Fastloc GPS data obtained from a green turtle
data(turtle)

## Bathymetry model developed by Beaman (2010)
data(bathymodel)

## A tidal plane for the example site
data(tidalplane)

## Tidal observations and predictions for the example site
data(tidedata)

## Maps for the example site
data(SandyStrait)


#### Remove temporal and/or spatial duplicates and biologically unrealistic fixes 
turtle.dd &lt;- ddfilter(dupfilter(turtle))


#### Apply depthfilter
turtle &lt;- depthfilter(sdata = turtle.dd, bathymetry = bathymodel, 
tide = tidedata, tidal.plane = tidalplane)


#### Plot data removed or retained by depthfilter
to_map(turtle.dd, bgmap = SandyStrait, point.bg = "red", point.size = 2, line.size = 0.5, 
        axes.lab.size = 0, title.size = 0, multiplot = FALSE)[[1]] + 
geom_point(aes(x = lon, y = lat), data = turtle, size = 2, fill = "yellow", shape = 21)+
geom_point(aes(x = x, y = y), data = data.frame(x = c(152.68, 152.68), y = c(-25.3, -25.34)), 
           size = 3, fill = c("yellow", "red"), shape = 21) + 
annotate("text", x = c(152.7, 152.7), y = c(-25.3, -25.34), label = c("Retained", "Removed"), 
         colour = "black", size = 4, hjust = 0)

## End(Not run)          
</code></pre>

<hr>
<h2 id='distfilter'>Filter locations by distance</h2><span id='topic+distfilter'></span>

<h3>Description</h3>

<p>This function removes locations that are located beyond a specified distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distfilter(sdata, max.dist = 100, method = 1, ia = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distfilter_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees.</p>
</td></tr>
<tr><td><code id="distfilter_+3A_max.dist">max.dist</code></td>
<td>
<p>A numeric value specifying a threshold of distance between successive locations. Default is 100 km.</p>
</td></tr>
<tr><td><code id="distfilter_+3A_method">method</code></td>
<td>
<p>An integer specifying how locations should be filtered with <em>max.dist</em>. 
A location is removed if the distance from a previous and(1)/or(2) to a subsequent location exceeds <em>max.dist</em>. 
Default is 1 (both way).</p>
</td></tr>
<tr><td><code id="distfilter_+3A_ia">ia</code></td>
<td>
<p>An integer (0 to 180) specifying an inner angle (in degrees) between consecutive locations, 
beyond which the locations are considered potential outliers. 
Default (NA) ignores this option. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function removes locations if the distance from a previous and/or to a subsequent location exceeds <em>max.dist</em> and
the inner angle is less than <em>ia</em>. If <em>ia</em> is NA (default), inner angles are not considered in the filtering.
</p>


<h3>Value</h3>

<p>The input data is returned without locations identified by this filter. 
The following columns are added: &quot;pDist&quot;, &quot;sDist&quot;, 'inAng'. 
&quot;pDist&quot; and &quot;sDist&quot; are straight distances in kilometres from a previous and to a subsequent fix respectively.
&quot;inAng&quot; is the degree between the bearings of lines joining successive location points.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Load data sets
## Fastloc GPS data obtained from a green turtle
data(turtle)

## A Map for the example site
data(Australia)
data(SandyStrait)


#### Filter temporal and/or spatial duplicates
turtle.dup &lt;- dupfilter(turtle, step.time=1/60, step.dist=0.001)
 

#### distfilter
turtle.dist &lt;- distfilter(turtle.dup, max.dist = 50, ia = 20)


#### Plot data removed or retained by ddfilter
## Entire area
p1 &lt;- to_map(turtle.dup, bgmap=Australia, point.size = 2, line.size = 0.5, axes.lab.size = 0, 
            multiplot = FALSE, point.bg = "red",
            title.size=15, title="Entire area")[[1]] + 
  geom_point(aes(x=lon, y=lat), data=turtle.dist, size=2, fill="yellow", shape=21)+
  geom_point(aes(x=x, y=y), data=data.frame(x=c(154, 154), y=c(-22, -22.5)), 
             size=3, fill=c("yellow", "red"), shape=21) + 
  annotate("text", x=c(154.3, 154.3), y=c(-22, -22.5), label=c("Retained", "Removed"), 
           colour="black", size=4, hjust = 0)

## Zoomed in
p2 &lt;- to_map(turtle.dup, bgmap=SandyStrait, xlim=c(152.7, 153.2), ylim=(c(-25.75, -25.24)), 
            axes.lab.size = 0, point.size = 2, point.bg = "red", line.size = 0.5, 
            multiplot = FALSE, title.size=15, title="Zoomed in")[[1]] + 
geom_path(aes(x=lon, y=lat), data=turtle.dist, linewidth=0.5, colour="black", linetype=1) + 
geom_point(aes(x=lon, y=lat), data=turtle.dist, size=2, colour="black", shape=21, fill="yellow")

gridExtra::marrangeGrob(list(p1, p2), nrow=1, ncol=2)
</code></pre>

<hr>
<h2 id='dupfilter'>Filter temporal and/or spatial duplicates</h2><span id='topic+dupfilter'></span>

<h3>Description</h3>

<p>Function to filter temporal and spatial duplicates in tracking data 
and retain only a single fix per time and location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dupfilter(
  sdata,
  step.time = 0,
  step.dist = 0,
  conditional = FALSE,
  no.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dupfilter_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="dupfilter_+3A_step.time">step.time</code></td>
<td>
<p>Consecutive locations less than or equal to <em>step.time</em> apart are considered temporal duplicates.
Default is 0 hours.</p>
</td></tr>
<tr><td><code id="dupfilter_+3A_step.dist">step.dist</code></td>
<td>
<p>Consecutive locations less than or equal to <em>step.dist</em> apart are considered spatial duplicates.
Default is 0 kilometres.</p>
</td></tr>
<tr><td><code id="dupfilter_+3A_conditional">conditional</code></td>
<td>
<p>If TRUE, spatial duplicates are filtered only if they are less than or equal to <em>step.time</em> apart. 
Default is FALSE.</p>
</td></tr>
<tr><td><code id="dupfilter_+3A_no.cores">no.cores</code></td>
<td>
<p>An integer specifying the number of cores used for parallel computing. 
Alternatively, type in 'detect' to use the maximum number of available cores minus one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function filters temporal and spatial duplicates in tracking data.
It first filters temporally and spatially exact locations. 
It then looks for temporal duplicates and retains a fix with the highest quality index.
When temporal or spatial duplicates are associated with the same quality index, 
the function retains a location that is nearest from a previous and to a subsequent location.
</p>


<h3>Value</h3>

<p>The input data frame is returned containing only a single fix (latitude/longitude pair) per time and location.
The following columns are added: &quot;pTime&quot;, &quot;sTime&quot;, &quot;pDist&quot;, &quot;sDist&quot;. 
&quot;pTime&quot; and &quot;sTime&quot; are hours from a previous and to a subsequent fix respectively. 
&quot;pDist&quot; and &quot;sDist&quot; are straight distances in kilometres from a previous and to a subsequent fix respectively.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Limpus C, Jones R, Hazel J, Groom R, Hamann M (2016) 
Sea turtles return home after intentional displacement from coastal foraging areas. 
<em>Marine Biology</em> 163:1-14 <a href="https://doi.org/10.1007/s00227-015-2771-0">doi:10.1007/s00227-015-2771-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dupfilter_exact">dupfilter_exact</a></code>, <code><a href="#topic+dupfilter_qi">dupfilter_qi</a></code>, <code><a href="#topic+dupfilter_time">dupfilter_time</a></code>, <code><a href="#topic+dupfilter_space">dupfilter_space</a></code>, <code><a href="#topic+track_param">track_param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Load data sets
## Fastloc GPS data obtained from a green turtle
data(turtle)


#### Apply dupfilter
turtle.dup &lt;- dupfilter(turtle)
</code></pre>

<hr>
<h2 id='dupfilter_exact'>Filter temporally and spatially exact duplicates</h2><span id='topic+dupfilter_exact'></span>

<h3>Description</h3>

<p>Function to filter temporally and spatially exact locations in tracking data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dupfilter_exact(sdata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dupfilter_exact_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a partial component of <code><a href="#topic+dupfilter">dupfilter</a></code>, although works as a stand-alone function.
It looks for temporally and spatially exact locations and retains only a single fix (latitude/longitude pair) per time and location.
</p>


<h3>Value</h3>

<p>The input data frame is returned with temporally and spatially exact duplicates removed.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Limpus C, Jones R, Hazel J, Groom R, Hamann M (2016) 
Sea turtles return home after intentional displacement from coastal foraging areas. 
<em>Marine Biology</em> 163:1-14 <a href="https://doi.org/10.1007/s00227-015-2771-0">doi:10.1007/s00227-015-2771-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dupfilter">dupfilter</a></code>, <code><a href="#topic+dupfilter_qi">dupfilter_qi</a></code>, <code><a href="#topic+dupfilter_time">dupfilter_time</a></code>, <code><a href="#topic+dupfilter_space">dupfilter_space</a></code>
</p>

<hr>
<h2 id='dupfilter_qi'>Filter temporal duplicates by quality index</h2><span id='topic+dupfilter_qi'></span>

<h3>Description</h3>

<p>Function to filter temporal duplicates in tracking data by quality index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dupfilter_qi(sdata = sdata, step.time = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dupfilter_qi_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="dupfilter_qi_+3A_step.time">step.time</code></td>
<td>
<p>Consecutive locations less than or equal to <em>step.time</em> apart are considered temporal duplicates.
Default is 0 hours.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a partial component of <code><a href="#topic+dupfilter">dupfilter</a></code>, although works as a stand-alone function. 
It looks for temporal duplicates and retains a fix with the highest quality index.
</p>


<h3>Value</h3>

<p>The input data frame is returned with temporal duplicates removed by the quality index.
The following columns are added: &quot;pTime&quot;, &quot;sTime&quot;. 
&quot;pTime&quot; and &quot;sTime&quot; are hours from a previous and to a subsequent fix respectively.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Limpus C, Jones R, Hazel J, Groom R, Hamann M (2016) 
Sea turtles return home after intentional displacement from coastal foraging areas. 
<em>Marine Biology</em> 163:1-14 <a href="https://doi.org/10.1007/s00227-015-2771-0">doi:10.1007/s00227-015-2771-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dupfilter">dupfilter</a></code>, <code><a href="#topic+dupfilter_exact">dupfilter_exact</a></code>, <code><a href="#topic+dupfilter_time">dupfilter_time</a></code>, <code><a href="#topic+dupfilter_space">dupfilter_space</a></code>, <code><a href="#topic+track_param">track_param</a></code>
</p>

<hr>
<h2 id='dupfilter_space'>Filter spatial duplicates</h2><span id='topic+dupfilter_space'></span>

<h3>Description</h3>

<p>Function to filter spatial duplicates in tracking data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dupfilter_space(
  sdata,
  step.time = 0,
  step.dist = 0,
  conditional = FALSE,
  no.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dupfilter_space_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="dupfilter_space_+3A_step.time">step.time</code></td>
<td>
<p>Consecutive locations less than or equal to <em>step.time</em> apart are considered temporal duplicates.
Default is 0 hours.</p>
</td></tr>
<tr><td><code id="dupfilter_space_+3A_step.dist">step.dist</code></td>
<td>
<p>Consecutive locations less than or equal to <em>step.dist</em> apart are considered spatial duplicates.
Default is 0 kilometres.</p>
</td></tr>
<tr><td><code id="dupfilter_space_+3A_conditional">conditional</code></td>
<td>
<p>If TRUE, spatial duplicates are filtered only if they are less than or equal to <em>step.time</em> apart. 
Default is FALSE.</p>
</td></tr>
<tr><td><code id="dupfilter_space_+3A_no.cores">no.cores</code></td>
<td>
<p>An integer specifying the number of cores used for parallel computing. 
Alternatively, type in 'detect' to use the maximum number of available cores minus one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a partial component of <code><a href="#topic+dupfilter">dupfilter</a></code>, although works as a stand-alone function.
First it identifies spatial duplicates by searching for consecutive fixes that were located within <em>step.dist</em>.
For each group of spatial duplicates, the function then retains a single fix that is nearest from a previous and to a subsequent location.
</p>


<h3>Value</h3>

<p>The input data frame is returned with spatial duplicates removed.
The following columns are added: &quot;pTime&quot;, &quot;sTime&quot;, &quot;pDist&quot;, &quot;sDist&quot;. 
&quot;pTime&quot; and &quot;sTime&quot; are hours from a previous and to a subsequent fix respectively. 
&quot;pDist&quot; and &quot;sDist&quot; are straight distances in kilometres from a previous and to a subsequent fix respectively.
</p>


<h3>Note</h3>

<p>A minimum of two locations per id is required.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Limpus C, Jones R, Hazel J, Groom R, Hamann M (2016) 
Sea turtles return home after intentional displacement from coastal foraging areas. 
<em>Marine Biology</em> 163:1-14 <a href="https://doi.org/10.1007/s00227-015-2771-0">doi:10.1007/s00227-015-2771-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dupfilter">dupfilter</a></code>, <code><a href="#topic+dupfilter_exact">dupfilter_exact</a></code>, <code><a href="#topic+dupfilter_time">dupfilter_time</a></code>, <code><a href="#topic+dupfilter_qi">dupfilter_qi</a></code>, <code><a href="#topic+track_param">track_param</a></code>
</p>

<hr>
<h2 id='dupfilter_time'>Filter temporal duplicates</h2><span id='topic+dupfilter_time'></span>

<h3>Description</h3>

<p>Function to filter temporal duplicates that are associated with the same quality index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dupfilter_time(sdata, step.time = 0, no.cores = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dupfilter_time_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> 
or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="dupfilter_time_+3A_step.time">step.time</code></td>
<td>
<p>Consecutive locations less than or equal to <em>step.time</em> apart are considered temporal duplicates.
Default is 0 hours.</p>
</td></tr>
<tr><td><code id="dupfilter_time_+3A_no.cores">no.cores</code></td>
<td>
<p>An integer specifying the number of cores used for parallel computing. 
Alternatively, type in 'detect' to use the maximum number of available cores minus one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a partial component of <code><a href="#topic+dupfilter">dupfilter</a></code>, although works as a stand-alone function.
First it identifies temporal duplicates by searching for consecutive locations that were obtained within <em>step.time</em>.
For each group of temporal duplicates, the function then retains a single fix that is nearest from a previous and to a subsequent location.
</p>


<h3>Value</h3>

<p>The input data frame is returned with temporal duplicates removed.
The following columns are added: &quot;pTime&quot;, &quot;sTime&quot;, &quot;pDist&quot;, &quot;sDist&quot;. 
&quot;pTime&quot; and &quot;sTime&quot; are hours from a previous and to a subsequent fix respectively. 
&quot;pDist&quot; and &quot;sDist&quot; are straight distances in kilometres from a previous and to a subsequent fix respectively.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Limpus C, Jones R, Hazel J, Groom R, Hamann M (2016) 
Sea turtles return home after intentional displacement from coastal foraging areas. 
<em>Marine Biology</em> 163:1-14 <a href="https://doi.org/10.1007/s00227-015-2771-0">doi:10.1007/s00227-015-2771-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dupfilter">dupfilter</a></code>, <code><a href="#topic+dupfilter_exact">dupfilter_exact</a></code>, <code><a href="#topic+dupfilter_qi">dupfilter_qi</a></code>, <code><a href="#topic+dupfilter_space">dupfilter_space</a></code>, <code><a href="#topic+track_param">track_param</a></code>
</p>

<hr>
<h2 id='flatback'>Flatback turtle tracking data</h2><span id='topic+flatback'></span>

<h3>Description</h3>

<p>Satellite tracking data of 15 flatback turtles (<em>Natator depressus</em>) that nested in Curtis Island, Australia.
This sample data is a subset of the tracking data used in <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13506">Shimada et al. (2021)</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatback
</code></pre>


<h3>Format</h3>

<p>A data frame with 1020 rows and 4 variables:
</p>

<dl>
<dt>id</dt><dd><p>identifier for each animal.</p>
</dd>
<dt>DateTime</dt><dd><p>GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code>.</p>
</dd>
<dt>x</dt><dd><p>longitude in UTM.</p>
</dd>
<dt>y</dt><dd><p>latitude in UTM.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Shimada T, Thums M, Hamann M, Limpus CJ, Hays GC, FitzSimmons N, Wildermann NE, Duarte CD, Meekan MG (2021) 
Optimising sample sizes for animal distribution analysis using tracking data. 
<em>Methods in Ecology and Evolution</em> 12(2):288-297 <a href="https://doi.org/10.1111/2041-210X.13506">doi:10.1111/2041-210X.13506</a>
</p>

<hr>
<h2 id='percent_vol'>UD percent volume</h2><span id='topic+percent_vol'></span>

<h3>Description</h3>

<p>Function to calculate a percent volume on a utilisation distribution (UD)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>percent_vol(x, percent = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="percent_vol_+3A_x">x</code></td>
<td>
<p>A vector containing the probability density.</p>
</td></tr>
<tr><td><code id="percent_vol_+3A_percent">percent</code></td>
<td>
<p>An integer specifying the percent volume of a UD to be considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates a percent volume on a UD. The probability beyond the specified range will be assigned with a zero value.
</p>


<h3>Value</h3>

<p>A vector containing the specified percent volume.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>

<hr>
<h2 id='SandyStrait'>A map of Sandy Strait, Australia</h2><span id='topic+SandyStrait'></span>

<h3>Description</h3>

<p>This map layer outlines the coast around Sandy Strait, Australia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SandyStrait
</code></pre>


<h3>Format</h3>

<p>A data.frame
</p>

<hr>
<h2 id='tidalplane'>Tidal plane table for Sandy Strait, Australia</h2><span id='topic+tidalplane'></span>

<h3>Description</h3>

<p>A semidiurnal tidal plane table containing the height of the mean tidal planes and the average time differences of tide 
at different locations within Sandy Strait.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidalplane
</code></pre>


<h3>Format</h3>

<p>A data frame with 2 rows and 6 variables:
</p>

<dl>
<dt>standard.port</dt><dd><p>identifier for a tidal observation station.</p>
</dd>
<dt>secondary.port</dt><dd><p>identifier for a station at which tide is only predicted using the tidal records observed at the related standard port.</p>
</dd>
<dt>lat</dt><dd><p>latitude in decimal degrees.</p>
</dd>
<dt>lon</dt><dd><p>longitude in decimal degrees.</p>
</dd>
<dt>timeDiff</dt><dd><p>time difference between standard port and its associated secondary port.</p>
</dd>
<dt>datumDiff</dt><dd><p>baseline difference in metres between the bathymetry model and tidal observations/predictions, 
if each data uses different datum (e.g. LAT and MSL).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The State of Queensland (Department of Transport and Main Roads), Tidal planes.
</p>

<hr>
<h2 id='tidedata'>Tidal data for Sandy Strait, Australia</h2><span id='topic+tidedata'></span>

<h3>Description</h3>

<p>A dataset containing tidal observations recorded at Bundaberg, Australia
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidedata
</code></pre>


<h3>Format</h3>

<p>A data frame with 26351 rows and 3 variables:
</p>

<dl>
<dt>tideDT</dt><dd><p>GMT date &amp; time of each observation in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code>.</p>
</dd>
<dt>reading</dt><dd><p>observed tidal height in metres.</p>
</dd>
<dt>standard.port</dt><dd><p>identifier of the tidal station.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The State of Queensland (Department of Transport and Main Roads), Tidal data.
</p>

<hr>
<h2 id='to_map'>Plot location data on a map</h2><span id='topic+to_map'></span>

<h3>Description</h3>

<p>Function to plot tracking data on a map or a satellite image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_map(
  sdata,
  xlim = NULL,
  ylim = NULL,
  margin = 10,
  bgmap = NULL,
  google.key = NULL,
  map.bg = "grey",
  map.col = "black",
  zoom = NULL,
  point.bg = "yellow",
  point.col = "black",
  point.symbol = 21,
  point.size = 1,
  line.col = "lightgrey",
  line.type = 1,
  line.size = 0.5,
  title = "id",
  title.size = 11,
  axes.text.size = 11,
  axes.lab.size = 11,
  multiplot = TRUE,
  nrow = 1,
  ncol = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_map_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;. 
The function creates a map for each unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> 
or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees.</p>
</td></tr>
<tr><td><code id="to_map_+3A_xlim">xlim</code>, <code id="to_map_+3A_ylim">ylim</code></td>
<td>
<p>Limits for x and y axes. 
If not specified, the values are determined as the maximum range of the input data plus an additional margin (see <em>margin</em>).</p>
</td></tr>
<tr><td><code id="to_map_+3A_margin">margin</code></td>
<td>
<p>Set the amount of spaces added around the periphery of the plot. The value is scaled to the plot. 
The smaller value increases the margin.</p>
</td></tr>
<tr><td><code id="to_map_+3A_bgmap">bgmap</code></td>
<td>
<p>A data frame of a background map data, containing the following headers: &quot;long&quot;, &quot;lat&quot;, &quot;group&quot;. 
If not specified, the <code><a href="maps.html#topic+world">world</a></code> map is used. 
Google Maps (&quot;terrain&quot;, &quot;satellite&quot;, &quot;roadmap&quot;, &quot;hybrid&quot;) can also be queried.</p>
</td></tr>
<tr><td><code id="to_map_+3A_google.key">google.key</code></td>
<td>
<p>If Google Maps are queried, a valid API key (a string) needs to be specified here. See <code><a href="ggmap.html#topic+register_google">register_google</a></code> for details.</p>
</td></tr>
<tr><td><code id="to_map_+3A_map.bg">map.bg</code></td>
<td>
<p>Background colour of the map. This argument is ignored when any Google Maps is selected.</p>
</td></tr>
<tr><td><code id="to_map_+3A_map.col">map.col</code></td>
<td>
<p>Outline colour of the map. This argument is ignored when any Google Maps is selected.</p>
</td></tr>
<tr><td><code id="to_map_+3A_zoom">zoom</code></td>
<td>
<p>Map zoom for Google Maps. Default (NULL) to estimate the zoom from each data set. 
For other options, see <code><a href="ggmap.html#topic+get_map">get_map</a></code> for details.</p>
</td></tr>
<tr><td><code id="to_map_+3A_point.bg">point.bg</code></td>
<td>
<p>The colour to fill in a symbol.</p>
</td></tr>
<tr><td><code id="to_map_+3A_point.col">point.col</code></td>
<td>
<p>The colour for the outline of a symbol.</p>
</td></tr>
<tr><td><code id="to_map_+3A_point.symbol">point.symbol</code></td>
<td>
<p>An integer or a string to specify the symbol type. See <code><a href="ggplot2.html#topic+aes_linetype_size_shape">shape</a></code> for details.</p>
</td></tr>
<tr><td><code id="to_map_+3A_point.size">point.size</code></td>
<td>
<p>An integer to specify the size of the symbol.</p>
</td></tr>
<tr><td><code id="to_map_+3A_line.col">line.col</code></td>
<td>
<p>The colour of the line that connects consecutive points.</p>
</td></tr>
<tr><td><code id="to_map_+3A_line.type">line.type</code></td>
<td>
<p>The type of the line that connects consecutive points. See <code><a href="ggplot2.html#topic+aes_linetype_size_shape">linetype</a></code> for details.</p>
</td></tr>
<tr><td><code id="to_map_+3A_line.size">line.size</code></td>
<td>
<p>An integer to specify the thickness (width) of the line that connects consecutive points.</p>
</td></tr>
<tr><td><code id="to_map_+3A_title">title</code></td>
<td>
<p>The main title for each plot. If not specified, the &quot;id&quot; will be used.</p>
</td></tr>
<tr><td><code id="to_map_+3A_title.size">title.size</code></td>
<td>
<p>An integer to specify the size of the title.</p>
</td></tr>
<tr><td><code id="to_map_+3A_axes.text.size">axes.text.size</code></td>
<td>
<p>An integer to specify the size of the axes characters.</p>
</td></tr>
<tr><td><code id="to_map_+3A_axes.lab.size">axes.lab.size</code></td>
<td>
<p>An integer to specify the size of the axes labels.</p>
</td></tr>
<tr><td><code id="to_map_+3A_multiplot">multiplot</code></td>
<td>
<p>Logical. If TRUE (default), multiple plots are displayed on the same page.</p>
</td></tr>
<tr><td><code id="to_map_+3A_nrow">nrow</code></td>
<td>
<p>An integer to specify the number of rows in the multiple plot page.</p>
</td></tr>
<tr><td><code id="to_map_+3A_ncol">ncol</code></td>
<td>
<p>An integer to specify the number of columns in the multiple plot page.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An arrangelist is returned when <em>multiplot</em> is TRUE. Otherwise a list is returned.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dupfilter">dupfilter</a></code>, <code><a href="#topic+ddfilter">ddfilter</a></code>, <code><a href="#topic+vmax">vmax</a></code>, <code><a href="#topic+vmaxlp">vmaxlp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Load data sets
## Fastloc GPS data obtained from two green turtles
data(turtle)
data(turtle2)
turtles&lt;-rbind(turtle, turtle2)

#### Filter temporal and/or spatial duplicates
turtle.dup &lt;- dupfilter(turtles, step.time=5/60, step.dist=0.001)
 

#### ddfilter
V &lt;- vmax(turtle.dup)
VLP &lt;- vmaxlp(turtle.dup)
turtle.dd &lt;- ddfilter(turtle.dup, vmax=V, vmaxlp=VLP)


#### Plot filtered data for each animal
## using the low-resolution world map
to_map(turtle.dd, point.size = 2, line.size = 0.5, axes.lab.size = 0, ncol=2, nrow=1)

## Not run: 
## using the high-resolution google satellite images
to_map(turtle.dd, bgmap = "satellite", google.key = "key", ncol=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='track_param'>Calculate parameters between locations</h2><span id='topic+track_param'></span>

<h3>Description</h3>

<p>Calculate time, distance, speed, and inner angle between successive locations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>track_param(
  sdata,
  param = c("time", "distance", "speed", "angle", "mean speed", "mean angle"),
  days = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="track_param_+3A_sdata">sdata</code></td>
<td>
<p>A data.frame or a list of data.frames containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;. 
The function calculates each movement parameter by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal) 
if the input is a data.frame, or by each element of the list if the input is a list.  
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> 
or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees.</p>
</td></tr>
<tr><td><code id="track_param_+3A_param">param</code></td>
<td>
<p>A string or vector specifying movement parameters to be calculated.
Options are 'time', 'distance', 'speed', 'angle', 'mean speed' and 'mean angle'.
See <em>details</em>.</p>
</td></tr>
<tr><td><code id="track_param_+3A_days">days</code></td>
<td>
<p>A numeric value specifying the number of days to calculate mean speeds and angles.
This argument is only used when 'mean speed' and/or 'mean angle' are selected in <em>param</em>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates various parameters of tracks. 
time (h), distance (km), speed (km/h) and inner angle (degrees) are calculated from each pair of successive locations.
mean speed (km/h) and angle (degrees) are calculated from locations over a specified number of days.
</p>


<h3>Value</h3>

<p>The input data is returned with new columns containing the requested parameters. 
&quot;pTime&quot; and &quot;sTime&quot; are hours from a previous and to a subsequent fix respectively. 
&quot;pDist&quot; and &quot;sDist&quot; are straight distances in kilometres from a previous and to a subsequent fix respectively. 
&quot;pSpeed&quot; and &quot;sSpeed&quot; are linear speed (km/h) from a previous and to a subsequent fix respectively. 
&quot;inAng&quot; is the degree between the bearings of lines joining successive location points.
&quot;meanSpeed&quot; and &quot;meanAngle&quot; are the mean speed and degree over a specified number of days.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Load turtle tracking data
data(turtle)


#### Filter temporal and/or spatial duplicates
turtle.dup &lt;- dupfilter(turtle, step.time=5/60, step.dist=0.001)


#### ddfilter
turtle.dd &lt;- ddfilter(turtle.dup, vmax=9.9, qi=4, ia=90, vmaxlp=2.0)


#### Mean speed over 2 days
mean.speed &lt;- track_param(turtle.dd, param = c('speed', 'mean speed'), days=2)


#### Plot data
ggplot(data = mean.speed, aes(x=lon, y=lat)) +
geom_path(colour = 'grey') +
geom_point(aes(colour=meanSpeed))
</code></pre>

<hr>
<h2 id='turtle'>Green turtle tracking data</h2><span id='topic+turtle'></span>

<h3>Description</h3>

<p>A dataset containing Fastloc GPS locations of a green turtle tracked in Sandy Strait, Australia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>turtle
</code></pre>


<h3>Format</h3>

<p>A data frame with 429 rows and 5 variables:
</p>

<dl>
<dt>id</dt><dd><p>identifier for each animal.</p>
</dd>
<dt>DateTime</dt><dd><p>GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code>.</p>
</dd>
<dt>lat</dt><dd><p>latitude in decimal degrees.</p>
</dd>
<dt>lon</dt><dd><p>longitude in decimal degrees.</p>
</dd>
<dt>qi</dt><dd><p>quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Shimada T, Jones R, Limpus C, Groom R, Hamann M (2016) 
Long-term and seasonal patterns of sea turtle home ranges in warm coastal foraging habitats: Implications for conservation. 
<em>Marine Ecology Progress Series</em> 562:163-179. <a href="https://doi.org/10.3354/meps11972">doi:10.3354/meps11972</a>
</p>

<hr>
<h2 id='turtle2'>Green turtle tracking data 2</h2><span id='topic+turtle2'></span>

<h3>Description</h3>

<p>A dataset containing Fastloc GPS locations of a green turtle tracked in Moreton Bay, Australia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>turtle2
</code></pre>


<h3>Format</h3>

<p>A data frame with 276 rows and 5 variables:
</p>

<dl>
<dt>id</dt><dd><p>identifier for each animal.</p>
</dd>
<dt>DateTime</dt><dd><p>GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code>.</p>
</dd>
<dt>lat</dt><dd><p>latitude in decimal degrees.</p>
</dd>
<dt>lon</dt><dd><p>longitude in decimal degrees.</p>
</dd>
<dt>qi</dt><dd><p>quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Shimada T, Jones R, Limpus C, Groom R, Hamann M (2016) 
Long-term and seasonal patterns of sea turtle home ranges in warm coastal foraging habitats: Implications for conservation. 
<em>Marine Ecology Progress Series</em> 562:163-179. <a href="https://doi.org/10.3354/meps11972">doi:10.3354/meps11972</a>
</p>

<hr>
<h2 id='ud_matrix'>A matrix containing probability distributions of flatback turtles</h2><span id='topic+ud_matrix'></span>

<h3>Description</h3>

<p>Inter-nesting utilisation distributions of 15 flatback turtles (<em>Natator depressus</em>) that nested in Curtis Island, Australia.
The UDs were calculated using the sample tracking data <code><a href="#topic+flatback">flatback</a></code> and reduced grid resolution (1 km)
instead of 50m as used in <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13506">Shimada et al. (2021)</a>. 
See <a href="https://github.com/TakahiroShimada/SDLfilter">GitHub</a> for an example code of UD estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ud_matrix
</code></pre>


<h3>Format</h3>

<p>A matrix
</p>


<h3>Source</h3>

<p>Shimada T, Thums M, Hamann M, Limpus CJ, Hays GC, FitzSimmons N, Wildermann NE, Duarte CD, Meekan MG (2021) 
Optimising sample sizes for animal distribution analysis using tracking data. 
<em>Methods in Ecology and Evolution</em> 12(2):288-297 <a href="https://doi.org/10.1111/2041-210X.13506">doi:10.1111/2041-210X.13506</a>
</p>

<hr>
<h2 id='ud_raster'>A list of raster data containing probability distributions of flatback turtles</h2><span id='topic+ud_raster'></span>

<h3>Description</h3>

<p>Inter-nesting utilisation distributions of 15 flatback turtles (<em>Natator depressus</em>) that nested in Curtis Island, Australia.
The UDs were calculated using the sample tracking data <code><a href="#topic+flatback">flatback</a></code> and reduced grid resolution (1 km)
instead of 50m as used in <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13506">Shimada et al. (2021)</a>.
See <a href="https://github.com/TakahiroShimada/SDLfilter">GitHub</a> for an example code of UD estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ud_raster
</code></pre>


<h3>Format</h3>

<p>A list of 15 stars objects
</p>


<h3>Source</h3>

<p>Shimada T, Thums M, Hamann M, Limpus CJ, Hays GC, FitzSimmons N, Wildermann NE, Duarte CD, Meekan MG (2021) 
Optimising sample sizes for animal distribution analysis using tracking data. 
<em>Methods in Ecology and Evolution</em> 12(2):288-297 <a href="https://doi.org/10.1111/2041-210X.13506">doi:10.1111/2041-210X.13506</a>
</p>

<hr>
<h2 id='vmax'>Maximum linear speed</h2><span id='topic+vmax'></span>

<h3>Description</h3>

<p>Function to estimate the maximum linear speed between two consecutive locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vmax(sdata, qi = 5, method = "ML", prob = 0.99, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vmax_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> 
or <code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the latitude and longitude of each location in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="vmax_+3A_qi">qi</code></td>
<td>
<p>An integer specifying the lowest quality index of a location that is qualified to be used in the estimation. 
Default is 5 (e.g. 5 GPS satellite or more).</p>
</td></tr>
<tr><td><code id="vmax_+3A_method">method</code></td>
<td>
<p>Available options are &quot;sample&quot; (i.e. sample quantile - see <code><a href="stats.html#topic+quantile">quantile</a></code>)
and &quot;ML&quot; (maximum likelihood estimation). Default is &quot;ML&quot;. See details.</p>
</td></tr>
<tr><td><code id="vmax_+3A_prob">prob</code></td>
<td>
<p>A value (0 to 1) specifying the sample quantile or cumulative probability for linear speed.
Values beyond this threshold are considered 'outliers' and excluded from estimation of maximum linear speed. 
Default is 0.99. See details.</p>
</td></tr>
<tr><td><code id="vmax_+3A_...">...</code></td>
<td>
<p>Extra arguments passed to <code><a href="#topic+dupfilter">dupfilter</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first calculates the linear speed between each pair of two consecutive locations. 
Some of the calculated linear speed can be inaccurate when the input data contains inaccurate locations (e.g. outliers).
The function can discard the implausible outliers by excluding extreme values using either the &quot;sample&quot; or &quot;ML&quot; method.
The &quot;sample&quot; method simply discards values that lie beyond the specified quantile. 
If the &quot;ML&quot; method is selected, it is assumed that the linear speed follow a Gamma distribution. 
The distribution parameters are derived via maximum likelihood estimation using the <code><a href="stats.html#topic+optim">optim</a></code> function. 
The linear speed at the given quantile or cumulative probability (e.g. 0.99) represents the maximum linear speed at which 
an animal would travel between two consecutive locations.
</p>


<h3>Value</h3>

<p>Maximum linear speed (vmax) estimated from the input data. The unit is km/h.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Jones R, Limpus C, Hamann M (2012) 
Improving data retention and home range estimates by data-driven screening. 
<em>Marine Ecology Progress Series</em> 457:171-180 <a href="https://doi.org/10.3354/meps09747">doi:10.3354/meps09747</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfilter">ddfilter</a></code>, <code><a href="#topic+ddfilter_speed">ddfilter_speed</a></code>, <code><a href="#topic+track_param">track_param</a></code>, <code><a href="#topic+dupfilter">dupfilter</a></code>
</p>

<hr>
<h2 id='vmaxlp'>Maximum one-way linear speed of a loop trip</h2><span id='topic+vmaxlp'></span>

<h3>Description</h3>

<p>Function to estimate the maximum one-way linear speed of a loop trip.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vmaxlp(sdata, qi = 4, nloc = 5, method = "ML", prob = 0.99, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vmaxlp_+3A_sdata">sdata</code></td>
<td>
<p>A data frame containing columns with the following headers: &quot;id&quot;, &quot;DateTime&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;qi&quot;. 
See the data <code><a href="#topic+turtle">turtle</a></code> for an example.
The function filters the input data by a unique &quot;id&quot; (e.g. transmitter number, identifier for each animal). 
&quot;DateTime&quot; is the GMT date &amp; time of each location in class <code><a href="base.html#topic+DateTimeClasses">POSIXct</a></code> or 
<code><a href="base.html#topic+character">character</a></code> with the following format &quot;2012-06-03 01:33:46&quot;.
&quot;lat&quot; and &quot;lon&quot; are the recorded latitude and longitude in decimal degrees. 
&quot;qi&quot; is the quality index associated with each location fix. 
The input values can be either the number of GPS satellites or Argos Location Classes. 
Argos Location Classes will be converted to numerical values, where &quot;A&quot;, &quot;B&quot;, &quot;Z&quot; will be replaced with &quot;-1&quot;, &quot;-2&quot;, &quot;-3&quot; respectively.
The greater number indicates a higher accuracy.</p>
</td></tr>
<tr><td><code id="vmaxlp_+3A_qi">qi</code></td>
<td>
<p>An integer specifying the minimum quality index associated with a location used for the estimation. 
Default is 4 (e.g. 4 GPS satellite or more).</p>
</td></tr>
<tr><td><code id="vmaxlp_+3A_nloc">nloc</code></td>
<td>
<p>An integer specifying the minimum number of successive locations to be considered a loop trip.</p>
</td></tr>
<tr><td><code id="vmaxlp_+3A_method">method</code></td>
<td>
<p>Available options are &quot;sample&quot; (i.e. sample quantile - see <code><a href="stats.html#topic+quantile">quantile</a></code>)
and &quot;ML&quot; (maximum likelihood estimation - see details). Default is &quot;ML&quot;.</p>
</td></tr>
<tr><td><code id="vmaxlp_+3A_prob">prob</code></td>
<td>
<p>A value (0 to 1) specifying the sample quantile or cumulative probability for one-way linear speed of a loop trip.
Values beyond this threshold are considered 'outliers' and excluded from estimation of maximum one-way linear speed of a loop trip. 
Default is 0.99. See details.</p>
</td></tr>
<tr><td><code id="vmaxlp_+3A_...">...</code></td>
<td>
<p>Extra arguments passed to <code><a href="#topic+dupfilter">dupfilter</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first detects a &quot;loop trip&quot;. 
Loop trip behaviour is represented by spatial departure and return involving more than 3 consecutive locations 
<a href="https://www.int-res.com/abstracts/meps/v457/p171-180/">(Shimada et al. 2012)</a>. 
The function calculates the net (i.e. straight-line) distance between the departure and turning point as well as 
the turning point and return location of a loop trip. 
It then calculates the one-way travelling speed to or from each turning point for each loop trip. 
To exclude implausible outliers, the function discards extreme values based on the specified quantile or 
an estimated probability distribution for the loop trip speed, depending on the selected <em>method</em>. 
If the &quot;ML&quot; method is selected, a Gamma distribution is assumed and the shape and scale parameters are estimated via maximum likelihood estimation 
using the <code><a href="stats.html#topic+optim">optim</a></code> function.
The maximum value within a given quantile or probability range (e.g. 0.99) represents the maximum one-way linear speed at which 
an animal would travel during a loop trip.
</p>


<h3>Value</h3>

<p>Maximum one-way linear speed of a loop trip (vmaxlp) estimated from the input data. The unit km/h.
</p>


<h3>Note</h3>

<p>The input data must not contain temporal or spatial duplicates. A minimum of 8 locations are required.
</p>


<h3>Author(s)</h3>

<p>Takahiro Shimada
</p>


<h3>References</h3>

<p>Shimada T, Jones R, Limpus C, Hamann M (2012) 
Improving data retention and home range estimates by data-driven screening. 
<em>Marine Ecology Progress Series</em> 457:171-180 <a href="https://doi.org/10.3354/meps09747">doi:10.3354/meps09747</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ddfilter">ddfilter</a></code>, <code><a href="#topic+ddfilter_loop">ddfilter_loop</a></code>, <code><a href="#topic+track_param">track_param</a></code>, <code><a href="#topic+dupfilter">dupfilter</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
