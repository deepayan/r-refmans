<!DOCTYPE html><html><head><title>Help for package ipwCoxCSV</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ipwCoxCSV}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ipwCoxCluster'><p>Inference of marginal HR in IPW Cox model based on CSV with clustering</p></a></li>
<li><a href='#ipwCoxCSV-package'>
<p>Inference of Marginal Hazard Ratios (HR) in Inverse Probability Weighted (IPW) Cox Model Using Corrected Sandwich Variance (CSV)</p></a></li>
<li><a href='#ipwCoxInd'><p>Inference of marginal HR in IPW Cox model based on CSV without clustering (i.e., assuming independence among observations)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inverse Probability Weighted Cox Model with Corrected Sandwich
Variance</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-09-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Di Shu &lt;shudi1991@gmail.com&gt;, Rui Wang &lt;rwang@hsph.harvard.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Di Shu &lt;shudi1991@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of corrected sandwich variance (CSV) estimation method for making inference of marginal hazard ratios (HR) in inverse probability weighted (IPW) Cox model without and with clustered data, proposed by Shu, Young, Toh, and Wang (2019) in their paper under revision for Biometrics. Both conventional inverse probability weights and stabilized weights are implemented. Logistic regression model is assumed for propensity score model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-06 18:39:09 UTC; dishu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-09 08:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='ipwCoxCluster'>Inference of marginal HR in IPW Cox model based on CSV with clustering</h2><span id='topic+ipwCoxCluster'></span>

<h3>Description</h3>

<p>Inference of marginal hazard ratios (HR) in inverse probability weighted (IPW) Cox model with clustered data, under both the conventional inverse probability weights and the stabilized weights. Corrected sandwich variance (CSV) estimation method is used for variance estimation of estimated log marginal hazard ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipwCoxCluster(data, indID, indA, indX, indStatus, indTime, ties = "breslow",
  confidence = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipwCoxCluster_+3A_data">data</code></td>
<td>
<p>A clustered dataset to be analyzed in the form of R data frame.</p>
</td></tr>
<tr><td><code id="ipwCoxCluster_+3A_indid">indID</code></td>
<td>
<p>A column name indicating the cluster variable. Observations from the same cluster have the same indID value.</p>
</td></tr>
<tr><td><code id="ipwCoxCluster_+3A_inda">indA</code></td>
<td>
<p>A column name indicating the treatment variable.</p>
</td></tr>
<tr><td><code id="ipwCoxCluster_+3A_indx">indX</code></td>
<td>
<p>A vector of column names indicating the covariates included in the propensity score model.</p>
</td></tr>
<tr><td><code id="ipwCoxCluster_+3A_indstatus">indStatus</code></td>
<td>
<p>A column name indicating the non-censoring status (1 if observed and 0 if censored).</p>
</td></tr>
<tr><td><code id="ipwCoxCluster_+3A_indtime">indTime</code></td>
<td>
<p>A column name indicating the outcome variable, i.e., min(true event time, censoring time).</p>
</td></tr>
<tr><td><code id="ipwCoxCluster_+3A_ties">ties</code></td>
<td>
<p>A character string indicating the method (&quot;efron&quot;,&quot;breslow&quot;,or &quot;exact&quot;) to deal with tied events for point estimation; the default is &quot;breslow&quot;. For variance estimation, Breslow method is used to deal with tied events.</p>
</td></tr>
<tr><td><code id="ipwCoxCluster_+3A_confidence">confidence</code></td>
<td>
<p>A confidence level between 0 and 1; the default is 0.95 corresponding to a 95 per cent confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of inference results from inverse probability weighted Cox model with clustered data. The first and the second rows report log marginal hazard ratio estimate and associated corrected sandwich based standard error, marginal hazard ratio estimate and associated normality-based confidence interval, under conventional inverse probability weights and stabilized weights, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulate a dataset under marginal hazard ratio 1.5 with clustering
set.seed(100)
n=300
oneGene&lt;-function(id){
 tau=0.7
 alpha=(1/tau-1)/2
 u1=runif(1)
 u2=runif(1)
 af=(1-u2)^(-1/alpha)
 T0v1=-log(1-u2)
 T0v2=alpha*log((1-af)+af*((1-u1)^(-1/(1+alpha))))
 T0=c(T0v1,T0v2)
 ZZZ=rep(rnorm(1),2)
 X1before= 0.5*(T0+0.2)/(T0+1)+0.3*ZZZ
 X1=mean(X1before)
 X2= 1/log(1.3*T0+3)-0.3*ZZZ
 X3= rbinom(2,1,0.3+0.5/(T0+1))  
 A=rbinom(2,1,1/(1+exp(1-2*X1-X2-X3)))
 Ttime &lt;- T0*exp(-log(1.5)*A)
 rateC=0.5
 C &lt;- rexp(2, rate=rateC)
 time &lt;- pmin(Ttime, C)
 status &lt;- as.numeric(Ttime &lt;= C)
 cbind(id=id,time=time,status=status,A=A,X1=X1,X2=X2,X3=X3)
} 
da=as.data.frame(do.call("rbind",lapply(1:n,oneGene)))
head(da)
#inference results for marginal hazard ratio 
ipwCoxCluster(data=da,indID="id",indA="A",indX=c("X1","X2","X3"),indStatus="status",indTime="time")

</code></pre>

<hr>
<h2 id='ipwCoxCSV-package'>
Inference of Marginal Hazard Ratios (HR) in Inverse Probability Weighted (IPW) Cox Model Using Corrected Sandwich Variance (CSV)
</h2><span id='topic+ipwCoxCSV-package'></span>

<h3>Description</h3>

<p>This package is an implementation of the corrected sandwich variance (CSV) estimation method for making inference of marginal hazard ratios (HR) in inverse probability weighted (IPW) Cox model without and with clustered data, under both the conventional inverse probability weights and the stabilized weights, proposed by Shu, Young, Toh, and Wang (2019). Logistic regression model is assumed for propensity score model.
</p>


<h3>Details</h3>

<p>The <code>ipwCoxCSV</code> package implements the corrected sandwich variance estimation method for making inference of marginal hazard ratios in inverse probability weighted Cox model without and with clustered data, under both the conventional inverse probability weights and the stabilized weights, proposed by Shu, Young, Toh, and Wang (2019). This sandwich type variance estimation is referred to as corrected sandwich variance estimation, because it takes into account the uncertainty in weight estimation. The function <code><a href="#topic+ipwCoxInd">ipwCoxInd</a></code> implements the corrected sandwich variance estimation method without clustered data (i.e., assuming independence among observations). The function <code><a href="#topic+ipwCoxCluster">ipwCoxCluster</a></code> implements the corrected sandwich variance estimation method with clustered data (i.e., allowing for within-cluster correlation). 
</p>


<h3>Author(s)</h3>

<p>Di Shu and Rui Wang
</p>
<p>Maintainer: Di Shu &lt;shudi1991@gmail.com&gt;
</p>


<h3>References</h3>

<p>Shu D, Young JG, Toh S, Wang R (2019). Variance estimation in inverse probability weighted Cox model.  <em>Biometrics,</em> under revision.
</p>

<hr>
<h2 id='ipwCoxInd'>Inference of marginal HR in IPW Cox model based on CSV without clustering (i.e., assuming independence among observations)</h2><span id='topic+ipwCoxInd'></span>

<h3>Description</h3>

<p>Inference of marginal hazard ratios (HR) in inverse probability weighted (IPW) Cox model with independent sample (i.e, without clustered data), under both the conventional inverse probability weights and the stabilized weights. Corrected sandwich variance (CSV) estimation method is used for variance estimation of estimated log marginal hazard ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipwCoxInd(data, indA, indX, indStatus, indTime, ties = "breslow",
  confidence = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipwCoxInd_+3A_data">data</code></td>
<td>
<p>A dataset to be analyzed in the form of R data frame.</p>
</td></tr>
<tr><td><code id="ipwCoxInd_+3A_inda">indA</code></td>
<td>
<p>A column name indicating the treatment variable.</p>
</td></tr>
<tr><td><code id="ipwCoxInd_+3A_indx">indX</code></td>
<td>
<p>A vector of column names indicating the covariates included in the propensity score model.</p>
</td></tr>
<tr><td><code id="ipwCoxInd_+3A_indstatus">indStatus</code></td>
<td>
<p>A column name indicating the non-censoring status (1 if observed and 0 if censored).</p>
</td></tr>
<tr><td><code id="ipwCoxInd_+3A_indtime">indTime</code></td>
<td>
<p>A column name indicating the outcome variable, i.e., min(true event time, censoring time).</p>
</td></tr>
<tr><td><code id="ipwCoxInd_+3A_ties">ties</code></td>
<td>
<p>A character string indicating the method (&quot;efron&quot;,&quot;breslow&quot;,or &quot;exact&quot;) to deal with tied events for point estimation; the default is &quot;breslow&quot;. For variance estimation, Breslow method is used to deal with tied events.</p>
</td></tr>
<tr><td><code id="ipwCoxInd_+3A_confidence">confidence</code></td>
<td>
<p>A confidence level between 0 and 1; the default is 0.95 corresponding to a 95 per cent confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of inference results from inverse probability weighted Cox model with independent sample. The first and the second rows report log marginal hazard ratio estimate and associated corrected sandwich based standard error, marginal hazard ratio estimate and associated normality-based confidence interval, under conventional inverse probability weights and stabilized weights, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulate a dataset under marginal hazard ratio 1.5 without clustering
set.seed(100)
n=700
T0=rexp(n, rate=0.01)
ZZZ=rnorm(n)
X1= 0.5*(T0+0.2)/(T0+1)+0.3*ZZZ
X2= 1/log(1.3*T0+3)-0.3*ZZZ
X3= rbinom(n,1,0.3+0.5/(T0+1))  
A=rbinom(n,1,1/(1+exp(0.53+X1-X2-X3)))
Ttime &lt;- T0*exp(-log(1.5)*A)
rateC=0.0005
C &lt;- rexp(n, rate=rateC)
time &lt;- pmin(Ttime, C)
status &lt;- as.numeric(Ttime &lt;= C)
da=data.frame(id=1:n,time=time,status=status,A=A,X1=X1,X2=X2,X3=X3)
head(da)
#inference results for marginal hazard ratio  
ipwCoxInd(data=da,indA="A",indX=c("X1","X2","X3"),indStatus="status",indTime="time")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
