<!DOCTYPE html><html><head><title>Help for package MLMusingR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MLMusingR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#cdata.ex'><p>Clustered dataset for centering example</p></a></li>
<li><a href='#engage'><p>Student engagement dataset (complete data).</p></a></li>
<li><a href='#engage.miss'><p>Student engagement dataset (with missing data).</p></a></li>
<li><a href='#glance.CR2'><p>Glance at goodness-of-fit statistics</p></a></li>
<li><a href='#group_center'><p>Group-mean center a variable</p></a></li>
<li><a href='#group_mean'><p>Computes the group mean of a variable</p></a></li>
<li><a href='#hdp'><p>Hospital, doctor, patient (hdp) dataset</p></a></li>
<li><a href='#Htest'><p>Test for homoskedasticity at level one</p></a></li>
<li><a href='#MatSqrtInverse'><p>Compute the inverse square root of a matrix</p></a></li>
<li><a href='#nmiss'><p>Amount of missing data per variable</p></a></li>
<li><a href='#pisa2012'><p>USA data from PISA 2012</p></a></li>
<li><a href='#ri_test1'><p>Sample dataset 1 for testing the likelihood ratio test</p></a></li>
<li><a href='#ri_test2'><p>Sample dataset 2 for testing the likelihood ratio test (LRT)</p></a></li>
<li><a href='#robust_mixed'><p>Cluster robust standard errors with degrees of freedom adjustments for lmerMod/lme objects</p></a></li>
<li><a href='#satdf'><p>Compute Satterthwaite degrees of freedom</p></a></li>
<li><a href='#sch29'><p>Data from 29 schools (based on the NELS dataset) used for regression diagnostics</p></a></li>
<li><a href='#suspend'><p>Suspension data from Virginia</p></a></li>
<li><a href='#thai'><p>Thai data from PISA</p></a></li>
<li><a href='#thai.sm'><p>Thai data from PISA (reduced)</p></a></li>
<li><a href='#tidy.CR2'><p>Tidy a CR2 object</p></a></li>
<li><a href='#wide'><p>Wide dataset to be used for growth modeling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Practical Multilevel Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-26</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francis Huang &lt;flhuang2000@yahoo.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Convenience functions and datasets to be used with Practical Multilevel Modeling using R. The package includes functions for calculating group means, group mean centered variables, and displaying some basic missing data information. A function for computing robust standard errors for linear mixed models based on Liang and Zeger (1986) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F73.1.13">doi:10.1093/biomet/73.1.13</a>&gt; and Bell and 'McCaffrey' (2002) <a href="https://www150.statcan.gc.ca/n1/en/pub/12-001-x/2002002/article/9058-eng.pdf?st=NxMjN1YZ">https://www150.statcan.gc.ca/n1/en/pub/12-001-x/2002002/article/9058-eng.pdf?st=NxMjN1YZ</a> is included as well as a function for checking for level-one homoskedasticity (Raudenbush &amp; Bryk, 2002, ISBN:076191904X).  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/flh3/MLMusingR">https://github.com/flh3/MLMusingR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/flh3/MLMusingR/issues">https://github.com/flh3/MLMusingR/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, stats, nlme, Matrix, methods, magrittr, broom, generics,
dplyr, performance, tibble</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-27 14:38:42 UTC; huangf</td>
</tr>
<tr>
<td>Author:</td>
<td>Francis Huang [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-27 15:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling 'rhs(lhs)'.
</p>

<hr>
<h2 id='cdata.ex'>Clustered dataset for centering example</h2><span id='topic+cdata.ex'></span>

<h3>Description</h3>

<p>Dataset of 60 observations from 3 clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdata.ex
</code></pre>


<h3>Format</h3>

<p>A wide data frame of 60 observations. Used for discussing within and between group effects.
</p>

<dl>
<dt>x</dt><dd><p>The predictor.</p>
</dd>
<dt>y</dt><dd><p>The outcome of interest.</p>
</dd>
</dl>


<hr>
<h2 id='engage'>Student engagement dataset (complete data).</h2><span id='topic+engage'></span>

<h3>Description</h3>

<p>Example data used to investigate missing data (this is the complete dataset).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(engage)
</code></pre>


<h3>Format</h3>

<p>A data frame with 528 observations from 40 groups and 7 variables:
</p>

<dl>
<dt>eng</dt><dd><p>Student engagement.</p>
</dd>
<dt>mot</dt><dd><p>Student motivation.</p>
</dd>
<dt>gpa</dt><dd><p>Student grade point average.</p>
</dd>
<dt>grade</dt><dd><p>Student grade level (6-8; a factor).</p>
</dd>
<dt>rural</dt><dd><p>School level rural variable indicator; 1 = yes/0 = no.</p>
</dd>
<dt>frpm</dt><dd><p>Percent of students eligible for free or reduced price meals at the school.</p>
</dd>
<dt>school</dt><dd><p>School indicator (clustering variable).</p>
</dd>
</dl>


<hr>
<h2 id='engage.miss'>Student engagement dataset (with missing data).</h2><span id='topic+engage.miss'></span>

<h3>Description</h3>

<p>Example data used to investigate missing data (this has missing data).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(engage.miss)
</code></pre>


<h3>Format</h3>

<p>A data frame with 528 observations from 40 groups and 7 variables:
</p>

<dl>
<dt>eng</dt><dd><p>Student engagement.</p>
</dd>
<dt>mot</dt><dd><p>Student motivation.</p>
</dd>
<dt>gpa</dt><dd><p>Student grade point average.</p>
</dd>
<dt>grade</dt><dd><p>Student grade level (6-8; a factor).</p>
</dd>
<dt>rural</dt><dd><p>School level rural variable indicator; 1 = yes/0 = no.</p>
</dd>
<dt>frpm</dt><dd><p>Percent of students eligible for free or reduced price meals at the school.</p>
</dd>
<dt>school</dt><dd><p>School indicator (clustering variable).</p>
</dd>
</dl>


<hr>
<h2 id='glance.CR2'>Glance at goodness-of-fit statistics</h2><span id='topic+glance.CR2'></span>

<h3>Description</h3>

<p>Helper function used to obtain supporting fit statistics for multilevel models. The R2s are computed using the 'performance' package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CR2'
glance(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glance.CR2_+3A_x">x</code></td>
<td>
<p>A 'CR2' object.</p>
</td></tr>
<tr><td><code id="glance.CR2_+3A_...">...</code></td>
<td>
<p>Unused, included for generic consistency only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>glance</code> returns one row with the columns:
</p>
<table>
<tr><td><code>nobs</code></td>
<td>
<p>the number of observations</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the square root of the estimated residual variance</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>the data's log-likelihood under the model</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike Information Criterion</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian Information Criterion</p>
</td></tr>
<tr><td><code>r2.marginal</code></td>
<td>
<p>marginal R2 based on fixed effects only using method of Nakagawa and Schielzeth (2013)</p>
</td></tr>
<tr><td><code>r2.conditional</code></td>
<td>
<p>conditional R2 based on fixed and random effects using method of Nakagawa and Schielzeth (2013)</p>
</td></tr>
</table>

<hr>
<h2 id='group_center'>Group-mean center a variable</h2><span id='topic+group_center'></span>

<h3>Description</h3>

<p>Also referred to as centering within cluster (or within context) or demeaning the variable.
By default, uses <code>na.rm = TRUE</code> when computing group means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_center(x, grp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_center_+3A_x">x</code></td>
<td>
<p>Variable to center (e.g., <code>dataframe$varname</code>).</p>
</td></tr>
<tr><td><code id="group_center_+3A_grp">grp</code></td>
<td>
<p>Cluster/grouping variable (e.g., <code>dataframe$cluster</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of group-mean centered variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mtcars)
#create a group centered variable
mtcars$mpg.gpc &lt;- group_center(mtcars$mpg, mtcars$cyl)
</code></pre>

<hr>
<h2 id='group_mean'>Computes the group mean of a variable</h2><span id='topic+group_mean'></span>

<h3>Description</h3>

<p>Computes the group means of a variable by a specified cluster/group. Can also be used with factors that have two levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_mean(x, grp, lm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_mean_+3A_x">x</code></td>
<td>
<p>Variable to compute the mean for (e.g., <code>dataframe$varname</code>).</p>
</td></tr>
<tr><td><code id="group_mean_+3A_grp">grp</code></td>
<td>
<p>Cluster/grouping variable (e.g., <code>dataframe$cluster</code>).</p>
</td></tr>
<tr><td><code id="group_mean_+3A_lm">lm</code></td>
<td>
<p>Compute reliability (lambda) adjusted means.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Outputs a vector of group means.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mtcars)
#create a group mean aggregated variable
mtcars$mpg.barj &lt;- group_mean(mtcars$mpg, mtcars$cyl)
</code></pre>

<hr>
<h2 id='hdp'>Hospital, doctor, patient (hdp) dataset</h2><span id='topic+hdp'></span>

<h3>Description</h3>

<p>This dataset has a three-level, hierarchical structure with patients nested within doctors within hospitals. The simulation code can be found at &lt;https://stats.idre.ucla.edu/r/codefragments/mesimulation/#setup&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hdp)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8,525 rows and 17 variables:
</p>

<dl>
<dt>Age</dt><dd><p>Continuous in years but recorded at a higher degree of accuracy.</p>
</dd>
<dt>Married</dt><dd><p>Binary, married/living with partner or single.</p>
</dd>
<dt>FamilyHx</dt><dd><p>Binary (yes/no), does the patient have a family history (Hx) of cancer?</p>
</dd>
<dt>SmokingHx</dt><dd><p>Categorical with three levels, current smoker, former smoker, never smoked.</p>
</dd>
<dt>Sex</dt><dd><p>Binary (female/male).</p>
</dd>
<dt>CancerStage</dt><dd><p>Categorical with four levels, stages 1-4.</p>
</dd>
<dt>LengthofStay</dt><dd><p>Count number of days patients stayed in the hospital after surgery.</p>
</dd>
<dt>WBC</dt><dd><p>Continuous, white blood count. Roughly 3,000 is low, 10,000 is middle, and 30,000 per microliter is high.</p>
</dd>
<dt>RBC</dt><dd><p>Continuous, red blood count.</p>
</dd>
<dt>BMI</dt><dd><p>Body mass index given by the formula (<code class="reqn">kg / meters^2</code>).</p>
</dd>
<dt>IL6</dt><dd><p>Continuous, interleukin 6, a proinflammatory cytokine commonly examined as an indicator of inflammation, cannot be lower than zero.</p>
</dd>
<dt>CRP</dt><dd><p>Continuous, C-reactive protein, a protein in the blood also used as an indicator of inflammation. It is also impacted by BMI.</p>
</dd>
<dt>HID</dt><dd><p>Hospital identifier.</p>
</dd>
<dt>DID</dt><dd><p>Doctor identifier</p>
</dd>
<dt>Experience</dt><dd><p>Years as a doctor.</p>
</dd>
<dt>School</dt><dd><p>Whether the school doctor trained at was high quality or not.</p>
</dd>
<dt>remission</dt><dd><p>Cancer in remission? 1 = yes, 0 = no.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://stats.oarc.ucla.edu/r/codefragments/mesimulation/">https://stats.oarc.ucla.edu/r/codefragments/mesimulation/</a>
</p>

<hr>
<h2 id='Htest'>Test for homoskedasticity at level one</h2><span id='topic+Htest'></span>

<h3>Description</h3>

<p>Based on Raudenbush and Bryk (2002) and Hoffman (2007).
A statistically significant Chisq indicates heteroskedasticity.
Output shows the H statistic, degrees of freedom, and p value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Htest(newdata, fml, group)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Htest_+3A_newdata">newdata</code></td>
<td>
<p>data to be used.</p>
</td></tr>
<tr><td><code id="Htest_+3A_fml">fml</code></td>
<td>
<p>level 1 formula.</p>
</td></tr>
<tr><td><code id="Htest_+3A_group">group</code></td>
<td>
<p>grouping variable (in quotes).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame which contains:
</p>
<table>
<tr><td><code>H</code></td>
<td>
<p>The computed H statistic.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>The degrees of freedom.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The p-value (&lt; .05 indicates heteroskedasticity is present).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hoffman, L. (2007). Multilevel models for examining individual differences in within-person variation and covariation over time. <em>Multivariate Behavioral Research, 42</em>(4), 609â€“629.
</p>
<p>Raudenbush, S., &amp; Bryk, A. (2002). <em>Hierarchical linear models: Applications and data analysis methods (2nd ed.)</em>. Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x1 &lt;- rnorm(400)
y &lt;- x1 * .3 + rnorm(400)
gr &lt;- rep(1:20, each = 20)
dat &lt;- data.frame(x1, y, gr)
Htest(dat, y ~ x1, 'gr') #no violation
y &lt;- x1 * .3 + rnorm(400, 0, sqrt(x1^2)) #add violation
dat &lt;- data.frame(x1, y, gr)
Htest(dat, y ~ x1, 'gr')
</code></pre>

<hr>
<h2 id='MatSqrtInverse'>Compute the inverse square root of a matrix</h2><span id='topic+MatSqrtInverse'></span>

<h3>Description</h3>

<p>From Imbens and Kolesar (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MatSqrtInverse(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MatSqrtInverse_+3A_a">A</code></td>
<td>
<p>The matrix object.</p>
</td></tr>
</table>

<hr>
<h2 id='nmiss'>Amount of missing data per variable</h2><span id='topic+nmiss'></span>

<h3>Description</h3>

<p>Amount of missing data per variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nmiss(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nmiss_+3A_dat">dat</code></td>
<td>
<p>Data frame that you want to inspect.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>By default, this function will print the following items to the console
</p>

<ul>
<li><p> The percent of missing data per variable.
</p>
</li>
<li><p> The percent of complete cases (range: 0 to 1).
</p>
</li>
<li><p> Suggested number of datasets to impute when using multiple imputation.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(mtcars)
mtcars[c(2:3), 4] &lt;- NA #create NAs
nmiss(mtcars)

</code></pre>

<hr>
<h2 id='pisa2012'>USA data from PISA 2012</h2><span id='topic+pisa2012'></span>

<h3>Description</h3>

<p>Example data for mixPV.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pisa2012)
</code></pre>


<h3>Format</h3>

<p>A data frame with 3136 rows and 14 variables:
</p>

<dl>
<dt>pv1math</dt><dd><p>Plausible value #1 for mathematics</p>
</dd>
<dt>pv2math</dt><dd><p>Plausible value #2 for mathematics</p>
</dd>
<dt>pv3math</dt><dd><p>Plausible value #3 for mathematics</p>
</dd>
<dt>pv4math</dt><dd><p>Plausible value #4 for mathematics</p>
</dd>
<dt>pv5math</dt><dd><p>Plausible value #5 for mathematics</p>
</dd>
<dt>escs</dt><dd><p>Index of economic, social, and cultural status.</p>
</dd>
<dt>schoolid</dt><dd><p>School identifier</p>
</dd>
<dt>st29q03</dt><dd><p>Maths interest- Look forward to lessons.</p>
</dd>
<dt>st04q01</dt><dd><p>Student gender.</p>
</dd>
<dt>w_fstuwt</dt><dd><p>Final student weight (total).</p>
</dd>
<dt>w_fschwt</dt><dd><p>School weight.</p>
</dd>
<dt>sc14q02</dt><dd><p>Shortage- Maths teachers</p>
</dd>
<dt>pwt1</dt><dd><p>Student weight (conditional).</p>
</dd>
<dt>noise1</dt><dd><p>Random noise.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://nces.ed.gov/pubsearch/pubsinfo.asp?pubid=2014028">https://nces.ed.gov/pubsearch/pubsinfo.asp?pubid=2014028</a>
</p>

<hr>
<h2 id='ri_test1'>Sample dataset 1 for testing the likelihood ratio test</h2><span id='topic+ri_test1'></span>

<h3>Description</h3>

<p>Example data for testing the need for a random intercept. Illustrates the need to adjust the p values for a modified LRT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ri_test1)
</code></pre>


<h3>Format</h3>

<p>A data frame with 900 observations from 30 groups and 4 variables:
</p>

<dl>
<dt>y</dt><dd><p>The outcome variable.</p>
</dd>
<dt>w1</dt><dd><p>A level-2 predictor.</p>
</dd>
<dt>x1</dt><dd><p>A level-1 predictor</p>
</dd>
<dt>group</dt><dd><p>The cluster identifier</p>
</dd>
</dl>


<hr>
<h2 id='ri_test2'>Sample dataset 2 for testing the likelihood ratio test (LRT)</h2><span id='topic+ri_test2'></span>

<h3>Description</h3>

<p>Example data for testing the need for a random intercept. LRT results show that a random slope is not warranted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ri_test2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 3,000 observations from 30 groups and 4 variables:
</p>

<dl>
<dt>y</dt><dd><p>The outcome variable.</p>
</dd>
<dt>w1</dt><dd><p>A level-2 predictor.</p>
</dd>
<dt>x1</dt><dd><p>A level-1 predictor</p>
</dd>
<dt>group</dt><dd><p>The cluster identifier</p>
</dd>
</dl>


<hr>
<h2 id='robust_mixed'>Cluster robust standard errors with degrees of freedom adjustments for lmerMod/lme objects</h2><span id='topic+robust_mixed'></span>

<h3>Description</h3>

<p>Function to compute the CR2/CR0 cluster
robust standard errors (SE) with Bell and McCaffrey (2002)
degrees of freedom (dof) adjustments. Suitable even with a low number of clusters.
The model based (mb) and cluster robust standard errors are shown for comparison purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>robust_mixed(m1, digits = 3, type = "CR2", satt = TRUE, Gname = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robust_mixed_+3A_m1">m1</code></td>
<td>
<p>The <code>lmerMod</code> or <code>lme</code> model object.</p>
</td></tr>
<tr><td><code id="robust_mixed_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places to display.</p>
</td></tr>
<tr><td><code id="robust_mixed_+3A_type">type</code></td>
<td>
<p>Type of cluster robust standard error to use (&quot;CR2&quot; or &quot;CR0&quot;).</p>
</td></tr>
<tr><td><code id="robust_mixed_+3A_satt">satt</code></td>
<td>
<p>If Satterthwaite degrees of freedom are to be computed (if not, between-within df are used).</p>
</td></tr>
<tr><td><code id="robust_mixed_+3A_gname">Gname</code></td>
<td>
<p>Group/cluster name if more than two levels of clustering (does not work with lme).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (<code>results</code>) with the cluster robust adjustments with p-values.
</p>
<table>
<tr><td><code>Estimate</code></td>
<td>
<p>The regression coefficient.</p>
</td></tr>
<tr><td><code>mb.se</code></td>
<td>
<p>The model-based (regular, unadjusted) SE.</p>
</td></tr>
<tr><td><code>cr.se</code></td>
<td>
<p>The cluster robust standard error.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom: Satterthwaite or between-within.</p>
</td></tr>
<tr><td><code>p.val</code></td>
<td>
<p>p-value using CR0/CR2 standard error.</p>
</td></tr>
<tr><td><code>stars</code></td>
<td>
<p>stars showing statistical significance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francis Huang, <a href="mailto:huangf@missouri.edu">huangf@missouri.edu</a>
</p>
<p>Bixi Zhang, <a href="mailto:bixizhang@missouri.edu">bixizhang@missouri.edu</a>
</p>


<h3>References</h3>

<p><cite>Bell, R., &amp; McCaffrey, D. (2002). Bias reduction in standard errors for linear regression with multi-stage samples. Survey Methodology, 28, 169-182.
(<a href="https://www150.statcan.gc.ca/n1/pub/12-001-x/2002002/article/9058-eng.pdf">link</a>)</cite>
</p>
<p><cite>Liang, K.Y., &amp; Zeger, S. L. (1986). Longitudinal data analysis using generalized linear models. <em>Biometrika, 73</em>(1), 13-22.
(<a href="https://academic.oup.com/biomet/article/73/1/13/246001">link</a>)
</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(lme4)
data(sch29, package = 'MLMusingR')
robust_mixed(lmer(math ~ male + minority + mses + mhmwk + (1|schid), data = sch29))
</code></pre>

<hr>
<h2 id='satdf'>Compute Satterthwaite degrees of freedom</h2><span id='topic+satdf'></span>

<h3>Description</h3>

<p>Function to compute empirical degrees of freedom
based on Bell and McCaffrey (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>satdf(m1, type = "none", Vinv2, Vm2, br2, Gname = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="satdf_+3A_m1">m1</code></td>
<td>
<p>The <code>lmerMod</code> or <code>lme</code> model object.</p>
</td></tr>
<tr><td><code id="satdf_+3A_type">type</code></td>
<td>
<p>The type of cluster robust correction used (i.e., CR2 or none).</p>
</td></tr>
<tr><td><code id="satdf_+3A_vinv2">Vinv2</code></td>
<td>
<p>Inverse of the variance matrix.</p>
</td></tr>
<tr><td><code id="satdf_+3A_vm2">Vm2</code></td>
<td>
<p>The variance matrix.</p>
</td></tr>
<tr><td><code id="satdf_+3A_br2">br2</code></td>
<td>
<p>The bread component.</p>
</td></tr>
<tr><td><code id="satdf_+3A_gname">Gname</code></td>
<td>
<p>The group (clustering variable) name'</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francis Huang, <a href="mailto:huangf@missouri.edu">huangf@missouri.edu</a>
</p>
<p>Bixi Zhang, <a href="mailto:bixizhang@missouri.edu">bixizhang@missouri.edu</a>
</p>

<hr>
<h2 id='sch29'>Data from 29 schools (based on the NELS dataset) used for regression diagnostics</h2><span id='topic+sch29'></span>

<h3>Description</h3>

<p>For examining the association between amount homework done per week and math outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sch29)
</code></pre>


<h3>Format</h3>

<p>A data frame with 648 rows and 8 variables:
</p>

<dl>
<dt>schid</dt><dd><p>The school identifier (the grouping variable)</p>
</dd>
<dt>ses</dt><dd><p>Student-level socioeconomic status</p>
</dd>
<dt>byhomewk</dt><dd><p>Total amount of time the student spent on homework per week. 1 = None, 2 = Less than one hour, 3 = 1 hour, 4 = 2 hours, 5 = 3 hours, 6 = 4-6 hours, 7 = 7 - 9 hours, 8 = 10 or more</p>
</dd>
<dt>math</dt><dd><p>Mathematics score.</p>
</dd>
<dt>male</dt><dd><p>Dummy coded gender, 1 = male, 0 = female</p>
</dd>
<dt>minority</dt><dd><p>Dummy coded minority status, 1 = yes, 0 = no</p>
</dd>
<dt>mses</dt><dd><p>Aggregated socioeconomic status at the school level</p>
</dd>
<dt>mhmwk</dt><dd><p>Aggregated time spent on homework at the school level</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://nces.ed.gov/pubs92/92030.pdf">https://nces.ed.gov/pubs92/92030.pdf</a>
</p>

<hr>
<h2 id='suspend'>Suspension data from Virginia</h2><span id='topic+suspend'></span>

<h3>Description</h3>

<p>Data from 8465 students from 100 schools in
Virginia
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(suspend)
</code></pre>


<h3>Format</h3>

<p>Dataset:
</p>

<dl>
<dt>school</dt><dd><p>School identifier</p>
</dd>
<dt>pminor</dt><dd><p>Percent minority enrollment at school</p>
</dd>
<dt>male</dt><dd><p>1 = male, 0 = female</p>
</dd>
<dt>sus</dt><dd><p>Whether the student was suspended (1 = yes) in the
school year or not (0 = no). Self reported.</p>
</dd>
<dt>fight</dt><dd><p>If the student got into one or more fights (1 = yes) in
the school year</p>
</dd>
<dt>gpa</dt><dd><p>Students self-reported GPA; 1 = D to 4 = A</p>
</dd>
</dl>


<hr>
<h2 id='thai'>Thai data from PISA</h2><span id='topic+thai'></span>

<h3>Description</h3>

<p>Example data to be used for centering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(thai)
</code></pre>


<h3>Format</h3>

<p>A data frame with 6606 rows and 18 variables:
</p>

<dl>
<dt>pv1math</dt><dd><p>First plausible value in mathematics.</p>
</dd>
<dt>escs</dt><dd><p>Index of economic, social, and cultural status.</p>
</dd>
<dt>hisei</dt><dd><p>Highest parent occupational status.</p>
</dd>
<dt>sex</dt><dd><p>Student gender. 1 = Female, 2 = Male.</p>
</dd>
<dt>intmat</dt><dd><p>Mathematics interest.</p>
</dd>
<dt>matheff</dt><dd><p>Mathematics self-efficacy.</p>
</dd>
<dt>schoolid</dt><dd><p>School identifier</p>
</dd>
<dt>othl</dt><dd><p>Spoke another language at home other than Thai. 1 = yes, 0 = no.</p>
</dd>
<dt>books</dt><dd><p>How many books at home.</p>
</dd>
<dt>pared</dt><dd><p>Highest parental education in years.</p>
</dd>
<dt>w_fstuwt</dt><dd><p>Student weight.</p>
</dd>
<dt>pv1read</dt><dd><p>Plausible value #1 for reading.</p>
</dd>
<dt>pv2read</dt><dd><p>Plausible value #2 for reading.</p>
</dd>
<dt>pv3read</dt><dd><p>Plausible value #3 for reading.</p>
</dd>
<dt>pv4read</dt><dd><p>Plausible value #4 for reading.</p>
</dd>
<dt>pv5read</dt><dd><p>Plausible value #5 for reading.</p>
</dd>
<dt>private</dt><dd><p>Private school. 1 = yes, 0 = no.</p>
</dd>
<dt>schsize</dt><dd><p>Total school enrolment.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://gpseducation.oecd.org/CountryProfile?primaryCountry=THA">https://gpseducation.oecd.org/CountryProfile?primaryCountry=THA</a>
</p>

<hr>
<h2 id='thai.sm'>Thai data from PISA (reduced)</h2><span id='topic+thai.sm'></span>

<h3>Description</h3>

<p>Example data to be used for centering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(thai)
</code></pre>


<h3>Format</h3>

<p>A data frame with 4271 rows and 7 variables:
</p>

<dl>
<dt>math</dt><dd><p>First plausible value in mathematics.</p>
</dd>
<dt>escs</dt><dd><p>Index of economic, social, and cultural status.</p>
</dd>
<dt>intmat</dt><dd><p>Mathematics interest.</p>
</dd>
<dt>schoolid</dt><dd><p>School identifier</p>
</dd>
<dt>othl</dt><dd><p>Spoke another language at home other than Thai. 1 = yes, 0 = no.</p>
</dd>
<dt>private</dt><dd><p>Private school. 1 = yes, 0 = no.</p>
</dd>
<dt>schsize</dt><dd><p>Total school enrolment.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://gpseducation.oecd.org/CountryProfile?primaryCountry=THA">https://gpseducation.oecd.org/CountryProfile?primaryCountry=THA</a>
</p>

<hr>
<h2 id='tidy.CR2'>Tidy a CR2 object</h2><span id='topic+tidy.CR2'></span>

<h3>Description</h3>

<p>Tidy a CR2 object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CR2'
tidy(x, conf.int = FALSE, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidy.CR2_+3A_x">x</code></td>
<td>
<p>A 'CR2' object.</p>
</td></tr>
<tr><td><code id="tidy.CR2_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical indicating whether or not to include
a confidence interval in the tidied output. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="tidy.CR2_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level to use for the confidence
interval if conf.int = TRUE. Must be strictly greater than 0
and less than 1. Defaults to 0.95, which corresponds to a
95 percent confidence interval.</p>
</td></tr>
<tr><td><code id="tidy.CR2_+3A_...">...</code></td>
<td>
<p>Unused, included for generic consistency only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy [tibble::tibble()] summarizing component-level
information about the model
</p>

<hr>
<h2 id='wide'>Wide dataset to be used for growth modeling</h2><span id='topic+wide'></span>

<h3>Description</h3>

<p>A dataset containing 30 observations with reading scores
taken in the fall kindergarten, spring kindergarten, and
spring first grade
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wide
</code></pre>


<h3>Format</h3>

<p>A wide data frame of 30 observations:
</p>

<dl>
<dt>studentid</dt><dd><p>Factor indicating student identification</p>
</dd>
<dt>int</dt><dd><p>treatment or control</p>
</dd>
<dt>female</dt><dd><p>1 = female, 0 = male</p>
</dd>
<dt>fall_k</dt><dd><p>Reading scores in fall kindergarten</p>
</dd>
<dt>spring_k</dt><dd><p>Reading scores in spring kindergarten</p>
</dd>
<dt>spring_g1</dt><dd><p>Reading scores in spring first grade</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
