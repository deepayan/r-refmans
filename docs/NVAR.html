<!DOCTYPE html><html lang="en"><head><title>Help for package NVAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NVAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#NVAR'><p>Fit a nonlinear vector autoregression model</p></a></li>
<li><a href='#sim_NVAR'><p>Time series simulation with an NVAR model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Nonlinear Vector Autoregression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate nonlinear vector autoregression models (also known as the 
    next generation reservoir computing) for nonlinear dynamic systems. The 
    algorithm was described by Gauthier et al. (2021) &lt;<a href="https://doi.org/10.1038%2Fs41467-021-25801-2">doi:10.1038/s41467-021-25801-2</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, magrittr, purrr, rlang, stats, tibble, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, nonlinearTseries, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Sciurus365/NVAR">https://github.com/Sciurus365/NVAR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Sciurus365/NVAR/issues">https://github.com/Sciurus365/NVAR/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-18 09:43:11 UTC; jingm</td>
</tr>
<tr>
<td>Author:</td>
<td>Jingmeng Cui <a href="https://orcid.org/0000-0003-3421-8457"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jingmeng Cui &lt;jingmeng.cui@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-18 11:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='NVAR'>Fit a nonlinear vector autoregression model</h2><span id='topic+NVAR'></span>

<h3>Description</h3>

<p>Described by Gauthier et al. (2021), also known as the &quot;next generation reservoir computing&quot; (NG-RC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NVAR(data, vars, s, k, p, constant = TRUE, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NVAR_+3A_data">data</code></td>
<td>
<p>A <code>tibble</code>, data.frame, or matrix that represents a time series of vectors, with each row as a time step.</p>
</td></tr>
<tr><td><code id="NVAR_+3A_vars">vars</code></td>
<td>
<p>A character vector of the variable names used in the model.</p>
</td></tr>
<tr><td><code id="NVAR_+3A_s">s</code></td>
<td>
<p>The number of time steps skipped between each two used time steps.</p>
</td></tr>
<tr><td><code id="NVAR_+3A_k">k</code></td>
<td>
<p>The number of time steps used for constructing features.</p>
</td></tr>
<tr><td><code id="NVAR_+3A_p">p</code></td>
<td>
<p>The order of polynomial feature vector.</p>
</td></tr>
<tr><td><code id="NVAR_+3A_constant">constant</code></td>
<td>
<p>Whether there should be a constant value (1) in the feature set? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="NVAR_+3A_alpha">alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code> value for ridge regression. Default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The feature vector is as follows (from the reference):
</p>
<p style="text-align: center;"><code class="reqn">\mathbb{O}_{\text {total }}=\mathbb{O}_{\text {lin }} \oplus \mathbb{O}_{\text {nonlinear }}^{(p)}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathbb{O}_{\operatorname{lin}, i}=\mathbf{X}_i \oplus \mathbf{X}_{i-s} \oplus \mathbf{X}_{i-2 s} \oplus \ldots \oplus \mathbf{X}_{i-(k-1) s}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathbb{O}_{\text {nonlinear }}^{(p)}=\mathbb{O}_{\text {lin }}\lceil\otimes\rceil \mathbb{O}_{\text {lin }}\lceil\otimes\rceil \ldots\lceil\otimes\rceil \mathbb{O}_{\text {lin }}</code>
</p>

<p>The feature vector <code class="reqn">\mathbb{O}_{\text {total }}</code> is then used as input for a ridge regression with <code>alpha</code>.
</p>


<h3>Value</h3>

<p>An <code>NVAR</code> object that contains <code>data</code>, <code>data_td</code> (a tidy form of <code>tibble</code> that contains the training data), <code>W_out</code> (the fitted coefficients), and <code>parameters</code>.
</p>


<h3>References</h3>

<p>Gauthier, D. J., Bollt, E., Griffith, A., &amp; Barbosa, W. A. S. (2021). Next generation reservoir computing. Nature Communications, 12(1), 5564. https://doi.org/10.1038/s41467-021-25801-2
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sim_NVAR">sim_NVAR()</a></code> for simulating the NVAR model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate test data from the Lorenz system
testdata &lt;- nonlinearTseries::lorenz()
testdata &lt;- tibble::as_tibble(testdata)
# fit an NVAR model for the Lorenz system
t1 &lt;- NVAR(data = testdata, vars = c("x", "y", "z"), s = 2, k = 2, p = 2, alpha = 1e-3)
# simulate the NVAR model
t1_sim &lt;- sim_NVAR(t1, length = 5000)
# (also see README for the plots of the results and the comparison with the true model)

</code></pre>

<hr>
<h2 id='sim_NVAR'>Time series simulation with an NVAR model</h2><span id='topic+sim_NVAR'></span>

<h3>Description</h3>

<p>Time series simulation with an NVAR model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_NVAR(
  model,
  init = NULL,
  length = 1000,
  noise = 0,
  upper_lim = Inf,
  lower_lim = -Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_NVAR_+3A_model">model</code></td>
<td>
<p>An <code>NVAR</code> model, fitted by <code><a href="#topic+NVAR">NVAR()</a></code>.</p>
</td></tr>
<tr><td><code id="sim_NVAR_+3A_init">init</code></td>
<td>
<p>A <code>tibble</code>, data.frame, or matrix that specify the initial values for a simulation. Should contain the variables used to fit the model and be at least <code class="reqn">s * (k - 1)</code> long. <code>NULL</code> by default, in which case the data used for fitting the model will be used for simulation.</p>
</td></tr>
<tr><td><code id="sim_NVAR_+3A_length">length</code></td>
<td>
<p>How many time steps should be simulated? <code>1e3</code> by default.</p>
</td></tr>
<tr><td><code id="sim_NVAR_+3A_noise">noise</code></td>
<td>
<p>A number indicating the standard deviation of the Gaussian noise
added to each time step. <code>0</code> by default (no noise).</p>
</td></tr>
<tr><td><code id="sim_NVAR_+3A_upper_lim">upper_lim</code>, <code id="sim_NVAR_+3A_lower_lim">lower_lim</code></td>
<td>
<p>The upper and lower limit for the simulation. Once the simulated value is out of the limits, it will be taken back to avoid instability of the simulation. Both should either be a single number or a numeric vector with the same length as the number of variables in the model. <code>Inf</code> and <code>-Inf</code> by default, which means no limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tibble</code> with the simulated time series.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
