<!DOCTYPE html><html><head><title>Help for package ecotraj</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ecotraj}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ecotraj-package'><p>ecotraj: Ecological Trajectory Analysis</p></a></li>
<li><a href='#avoca'><p>Avoca permanent plot dataset</p></a></li>
<li><a href='#furseals'><p>furseals dataset</p></a></li>
<li><a href='#glenan'><p>Glenan dataset</p></a></li>
<li><a href='#glomel'><p>Glomel vegetation dataset</p></a></li>
<li><a href='#heatmapdata'><p>heatmapdata dataset</p></a></li>
<li><a href='#isoscape'><p>isoscape dataset</p></a></li>
<li><a href='#pike'><p>pike dataset</p></a></li>
<li><a href='#referenceEnvelopes'><p>Ecological quality assessment</p></a></li>
<li><a href='#trajectorymetrics'><p>Metrics for Ecological Trajectory Analysis</p></a></li>
<li><a href='#trajectoryplots'><p>Trajectory plots</p></a></li>
<li><a href='#trajectoryutils'><p>Utility functions for Ecological Trajectory Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Ecological Trajectory Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-30</td>
</tr>
<tr>
<td>Description:</td>
<td>Assists ecologists in the analysis of temporal changes of 
    ecosystems, defined as trajectories on a chosen multivariate space, by providing a set of 
    trajectory metrics and visual representations [De Caceres et al. (2019) &lt;<a href="https://doi.org/10.1002%2Fecm.1350">doi:10.1002/ecm.1350</a>&gt;; 
    and Sturbois et al. (2021) &lt;<a href="https://doi.org/10.1016%2Fj.ecolmodel.2020.109400">doi:10.1016/j.ecolmodel.2020.109400</a>&gt;]. Includes functions
    to estimate metrics for individual trajectories (length, directionality, angles, ...) as well as
    metrics to relate pairs of trajectories (dissimilarity and convergence). Functions are also
    provided to estimate the ecological quality of ecosystem with respect to reference conditions 
    [Sturbois et al. (2023) ].</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), Rcpp (&ge; 0.12.12)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Kendall, MASS</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://emf-creaf.github.io/ecotraj/">https://emf-creaf.github.io/ecotraj/</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ape, vegclust, knitr, rmarkdown, RColorBrewer, smacof, vegan,
ggplot2, hrbrthemes, reshape2, scales, tidyr, viridis, testthat
(&ge; 3.0.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-30 16:45:03 UTC; miquel</td>
</tr>
<tr>
<td>Author:</td>
<td>Miquel De Cáceres <a href="https://orcid.org/0000-0001-7132-2080"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Anthony Sturbois [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Miquel De Cáceres &lt;miquelcaceres@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-30 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ecotraj-package'>ecotraj: Ecological Trajectory Analysis</h2><span id='topic+ecotraj-package'></span><span id='topic+_PACKAGE'></span><span id='topic+ecotraj'></span>

<h3>Description</h3>

<p>Assists ecologists in the analysis of temporal changes of ecosystems, defined as trajectories on a chosen multivariate space
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Miquel De Cáceres
<a href="mailto:miquelcaceres@gmail.com">miquelcaceres@gmail.com</a>
<a href="https://orcid.org/0000-0001-7132-2080">ORCID</a>
</p>
<p>Authors: </p>

<ul>
<li><p> Anthony Sturbois
</p>
</li></ul>



<h3>References</h3>

<p>De Caceres et al., 2019 (<a href="https://doi.org/10.1002/ecm.1350">doi:10.1002/ecm.1350</a>), Sturbois et al., 2021 (<a href="https://doi.org/10.1016/j.ecolmodel.2020.109400">doi:10.1016/j.ecolmodel.2020.109400</a>)
</p>


<h3>See Also</h3>

<p>Useful links: </p>
 <ul>
<li>
<p><a href="https://emf-creaf.github.io/ecotraj/index.html">https://emf-creaf.github.io/ecotraj/index.html</a> </p>
</li></ul>


<hr>
<h2 id='avoca'>Avoca permanent plot dataset</h2><span id='topic+avoca'></span><span id='topic+avoca_sites'></span><span id='topic+avoca_strat'></span><span id='topic+avoca_surveys'></span>

<h3>Description</h3>

<p>Example dataset with data from 8 permanent forest plots located on slopes of a valley in the New Zealand Alps.
The study area is mountainous and centered on the Craigieburn Range (Southern Alps), South Island, New Zealand.
Forests plots are almost monospecific, being the mountain beech (Fuscospora cliffortioides) the main dominant tree species.
Previously forests consisted of largely mature stands, but some of them were affected by different disturbances during the sampling period (1972-2009)
which includes 9 surveys.
</p>


<h3>Format</h3>

<p>Three data items are included:
</p>

<dl>
<dt>avoca_strat</dt><dd><p>An object of class <code>stratifiedvegdata</code> (see function <code>stratifyvegdata</code> from package 'vegclust') with structural and compositional data.</p>
</dd>
<dt>avoca_sites</dt><dd><p>A vector identifying sampled sites of each element in <code>avoca_strat</code>.</p>
</dd>
<dt>avoca_surveys</dt><dd><p>A vector identifying surveys of each element in <code>avoca_strat</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>New Zealand National Vegetation Survey (NVS) Databank (https://nvs.landcareresearch.co.nz/).
</p>


<h3>References</h3>

<p>Allen, R. B., P. J. Bellingham, and S. K. Wiser. 1999. Immediate damage by an earthquake to a temperate montane forest. Ecology 80:708–714.
</p>
<p>Harcombe, P. A., R. B. Allen, J. A. Wardle, and K. H. Platt. 1998. Spatial and temporal patterns in stand structure, biomass, growth and mortality in a monospecific Nothofagus solandri var. cliffortioides (Hook. f.) Poole forest in New Zealand. Journal of Sustainable Forestry 6:313–343.
</p>
<p>Hurst, J. M., R. B. Allen, D. A. Coomes, and R. P. Duncan. 2011. Size-specific tree mortality varies with neighbourhood crowding and disturbance in a montane Nothofagus forest. PLoS ONE 6.
</p>

<hr>
<h2 id='furseals'>furseals dataset</h2><span id='topic+furseals'></span>

<h3>Description</h3>

<p>This is a subset of a data sets from Kernaléguen et al. (2015).
</p>


<h3>Format</h3>

<p>furseals is an object of class data.frame composed of 1414 observations and 8 variables.
</p>

<dl>
<dt>ID_SITA</dt><dd><p>Fur seal ID used by Sturbois et al. (under review), from 1 to 47</p>
</dd>
<dt>ID</dt><dd><p>Fur seal ID used by Kernaléguen et al. (2015) in the initial data set.</p>
</dd>
<dt>Species</dt><dd><p>Fur seal species: the Antarctic fur seal Arctocephalus gazella or the subantarctic fur seal A. tropicalis.</p>
</dd>
<dt>Sexe</dt><dd><p>Fur seal gender, either 'Male' or 'Female'.</p>
</dd>
<dt>Time</dt><dd><p>Number of the whisker sections from 1 to 30.</p>
</dd>
<dt>Place</dt><dd><p>Breeding place: Crozet, Amsterdam or Kerguelen</p>
</dd>
<dt>d13C</dt><dd><p>delta 13C value</p>
</dd>
<dt>d15N</dt><dd><p>delta 15N value</p>
</dd>
</dl>



<h3>Details</h3>

<p>Briefly, fur seals the Antarctic fur seal Arctocephalus gazella and subantarctic fur seal A. tropicalis whisker SI values yield unique long-term information
on individual behaviour which integrates the spatial, trophic and temporal dimensions of the ecological niche. The foraging strategies of this two species of sympatric
fur seals were examined in the winter 2001/2002 at Crozet, Amsterdam and Kerguelen Islands (Southern Ocean) using the stable isotope values of serially sampled whiskers.
The subset of the initial data set is composed of consecutive whisker sections (3 mm-long) starting from the proximal (facial) end, with the most recently synthesized tissue remaining
under the skin. Only individuals (n = 47) with whiskers totalizing at least 30 sections were selected in the initail data, and only those 30 sections were selected.
</p>


<h3>Author(s)</h3>

<p>Kernaléguen, L., Arnould, J.P.Y., Guinet, C., Cherel, Y.
</p>


<h3>References</h3>

<p>Kernaléguen, L., Arnould, J.P.Y., Guinet, C., Cherel, Y., 2015. Determinants of individual foraging specialization inlarge marine vertebrates, the Antarctic and subantarctic fur seals. Journal of Animal Ecology 1081–1091.
</p>

<hr>
<h2 id='glenan'>Glenan dataset</h2><span id='topic+glenan'></span>

<h3>Description</h3>

<p>Maerl bed data set to illustrate Ecological Quality Assessment (EQA)
</p>


<h3>Format</h3>

<p>Glenan is an object of class data.frame composed of 32 observations and 252 variables.
</p>

<dl>
<dt>Abundance.<em>x</em></dt><dd><p>Abundance (number of individuals) of each taxon <em>x</em></p>
</dd>
<dt>Surveys</dt><dd><p>Indicates different Maerl bed surveys.</p>
</dd>
<dt>Treatment</dt><dd><p>Combinations of fishing dredges and pressure levels. 'CTRL' stands for control. Fishing dredges are:
</p>

<ul>
<li><p>(1) a clam dredge (CD), 70 to 90 kg, 1.5 m wide, 40 teeth of 11 cm each;
</p>
</li>
<li><p>(2) a queen scallop dredge (QSD), 120 kg,1.8 m wide, with a blade;
</p>
</li>
<li><p>(3) a king scallop dredge (KSD), 190 kg, 1.8 m wide, 18 teeth of 10 cm each every 9 cm.
</p>
</li></ul>

</dd>
</dl>



<h3>Details</h3>

<p>Experimental data set built by Tauran et al. (2020) to study the impact of fishing dredges
and varying fishing pressures on maerl beds, in the bay of Brest (Brittany, France).
</p>


<h3>References</h3>

<p>Tauran, A., Dubreuil, J., Guyonnet, B., Grall, J., 2020. Impact of fishing gears and fishing intensities on maerl beds: An experimental approach. Journal of Experimental Marine Biology and Ecology 533, 151472. https://doi.org/10.1016/j.jembe.2020.151472
</p>


<h3>See Also</h3>

<p><code><a href="boot.html#topic+envelope">envelope</a></code>
</p>

<hr>
<h2 id='glomel'>Glomel vegetation dataset</h2><span id='topic+glomel'></span>

<h3>Description</h3>

<p>Vegetation data set to illustrate Ecological Quality Assessment (EQA)
</p>


<h3>Format</h3>

<p>Glomel is an object of class data.frame composed of 23 observations and 46 variables.
</p>

<dl>
<dt>ID</dt><dd><p>Station ID.</p>
</dd>
<dt>Ref</dt><dd><p>Logical flag to indicate stations used to define the reference envelope.</p>
</dd>
<dt>Complementary</dt><dd><p>Comments regarding the quality of the ecosystem.</p>
</dd>
<dt>...</dt><dd><p>Percent cover values (derived from Braun-Blanquet ordinal scale) for 43 species of vascular plants.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The nature reserve of Landes et Marais de Glomel (Brittany, France) is
composed of temperate Atlantic wet heaths whose reference state is commonly
considered dominated by plant communities associated to acid, nutrient poor soils
that are at least seasonally water logged and dominated by <em>Erica tetralix</em> and
<em>E. ciliaris</em>. The data set consists of 23 rows and 46 columns.
The first five stations (rows) were used to define the reference
envelope, and the next 18 stations (rows) where those for which the conservation status
was to be assessed.
</p>


<h3>Author(s)</h3>

<p>Aline Bifolchi, Réserve Naturelle des landes et marais de Glomel
</p>


<h3>See Also</h3>

<p><code><a href="boot.html#topic+envelope">envelope</a></code>
</p>

<hr>
<h2 id='heatmapdata'>heatmapdata dataset</h2><span id='topic+heatmapdata'></span>

<h3>Description</h3>

<p>Espinasse et al. (2020) tested the application of isoscapes modelled from satellite data to the description of secondary production in the Northeast pacific.
The output model fits in a 0.25° x 0.25° spatial grid covering the region spanning from 46 to 62°N and from 195 to 235°E and supporting delta 13C and delta 15N isoscapes
from 1998 to 2017.
</p>


<h3>Format</h3>

<p>heatmapdata is an object of class dataframe composed of 9206 observations of 9 variables.
</p>

<dl>
<dt>Latitude</dt><dd><p>Latitude coordinate of the station, in degrees</p>
</dd>
<dt>Longitude</dt><dd><p>Longitude coordinate of the station, in degrees</p>
</dd>
<dt>d13C</dt><dd><p>delta 13C modelled value</p>
</dd>
<dt>d15N</dt><dd><p>delta 15N modelled value</p>
</dd>
<dt>station</dt><dd><p>Station ID</p>
</dd>
<dt>Years</dt><dd><p>Period corresponding to the calculation of trajectory metrics</p>
</dd>
<dt>Angles</dt><dd><p>Angle alpha (i.e direction) in the stable isotope space</p>
</dd>
<dt>Lengths</dt><dd><p>Net change values (i.e direction) in the stable isotope space</p>
</dd>
<dt>Angles2</dt><dd><p>Angle alpha values (i.e direction) in the stable isotope space transformed for a potential use with function <code>geom_spoke</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>This data sets is composed of trajectory metrics calculated by Sturbois et al. (2021) for all stations within all inter-annual consecutive periods between 1998 and 2017
calculated from the whole data set of Espinasse et al. (2020) for a 1° x 1° spatial grid.
</p>


<h3>Author(s)</h3>

<p>Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E.A.
</p>


<h3>References</h3>

<p>Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E.A., 2020. Defining isoscapes in the Northeast Pacific as an index of ocean productivity. Global Ecol Biogeogr 29, 246–261.
</p>


<h3>See Also</h3>

<p>isoscape
</p>

<hr>
<h2 id='isoscape'>isoscape dataset</h2><span id='topic+isoscape'></span>

<h3>Description</h3>

<p>This data sets is a subset from Espinasse et al. (2020).
</p>


<h3>Format</h3>

<p>isoscape is an object of class dataframe composed of 978 observations of 6 variables.
</p>

<dl>
<dt>Latitude</dt><dd><p>Latitude coordinate of the station, in degrees</p>
</dd>
<dt>Longitude</dt><dd><p>Longitude coordinate of the station, in degrees</p>
</dd>
<dt>d13C</dt><dd><p>delta 13C modelled value</p>
</dd>
<dt>d15N</dt><dd><p>delta 15N modelled value</p>
</dd>
<dt>station</dt><dd><p>station ID</p>
</dd>
<dt>Year</dt><dd><p>Year corresponding to modelled stable isotope values</p>
</dd>
</dl>



<h3>Details</h3>

<p>Briefly, Espinasse et al. (2020) tested the application of isoscapes modelled from satellite data to the description of secondary production in the Northeast pacific.
The output model fits in a 0.25° x 0.25° spatial grid covering the region spanning from 46 to 62°N and from 195 to 235°E and supporting delta 13C and delta 15N isoscapes
from 1998 to 2017. The subset is composed of modelled  delta 13C and delta 15N values of a 1° x 1° spatial grid from the original modelled dataset for 2013 and 2015.
</p>


<h3>Author(s)</h3>

<p>Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E.A.
</p>


<h3>References</h3>

<p>Espinasse, B., Hunt, B.P.V., Batten, S.D., Pakhomov, E.A., 2020. Defining isoscapes in the Northeast Pacific as an index of ocean productivity. Global Ecol Biogeogr 29, 246–261.
</p>


<h3>See Also</h3>

<p>heatmapdata
</p>

<hr>
<h2 id='pike'>pike dataset</h2><span id='topic+pike'></span>

<h3>Description</h3>

<p>This data sets comes from Cucherousset et al. (2013).
</p>


<h3>Format</h3>

<p>pike is an object of class dataframe composed of 58 observations of 10 variables.
</p>

<dl>
<dt>trophic_status_initial</dt><dd><p>Initial trophic status at release</p>
</dd>
<dt>ID</dt><dd><p>ID used for each individual by Cucherousset et al. (2013)</p>
</dd>
<dt>Time</dt><dd><p>Time of the stable isotope measurement: 1 (Release) or 2 (Departure)</p>
</dd>
<dt>Time_L</dt><dd><p>Time of the stable isotope measurement as string, either 'Release' or 'Departure'</p>
</dd>
<dt>Date</dt><dd><p>Date of release (common for all individuals) or recapture (variable dependind of the date of departure)</p>
</dd>
<dt>Size_mm</dt><dd><p>Size (length) of juvenile pike, in mm</p>
</dd>
<dt>d13C</dt><dd><p>delta 13C values</p>
</dd>
<dt>d15N</dt><dd><p>delta 15N values</p>
</dd>
<dt>Residence_time</dt><dd><p>Number of days between the release and the recapture</p>
</dd>
<dt>Trophic_status_final</dt><dd><p>Trophic status at the end of the study</p>
</dd>
</dl>



<h3>Details</h3>

<p>Briefly, Cucherousset et al. (2013) released 192 individually tagged, hatchery-raised, juvenile pike (Esox lucius L.) with variable initial trophic position (fin delta 13C/delta 15N values).
Based on delta values, individuals were classified into zooplanktivorous (delta 15N &lt; 10 ‰) and piscivorous (delta 15N &gt; 10 ‰) as cannibalism is commonly observed in this species.
Individuals were released in a temporarily flooded grassland where pike eggs usually hatch of the Brière marsh (France) to identify the determinants of juvenile natal departure.
The release site was connected through a unique point to an adjacent pond used as a nursery habitat. Fish were continuously recaptured when migrating from flooded grassland
to adjacent pond. Recaptured individuals (n = 29) were anaesthetized, checked for tags, measured for fork length, fin-clipped to quantify changes in delta 13C and delta 15N values,
and released.
</p>


<h3>Author(s)</h3>

<p>Cucherousset, J., Paillisson, J.-M., Roussel, J.-M.
</p>


<h3>References</h3>

<p>Cucherousset, J., Paillisson, J.-M., Roussel, J.-M., 2013. Natal departure timing from spatially varying environments is dependent of individual ontogenetic status. Naturwissenschaften 100, 761–768.
</p>

<hr>
<h2 id='referenceEnvelopes'>Ecological quality assessment</h2><span id='topic+referenceEnvelopes'></span><span id='topic+trajectoryEnvelopeVariability'></span><span id='topic+stateEnvelopeVariability'></span><span id='topic+compareToStateEnvelope'></span><span id='topic+compareToTrajectoryEnvelope'></span>

<h3>Description</h3>

<p>Functions to assess the variability of ecological reference envelopes and to assess the ecological quality of
target stations/observations with respect to reference envelopes (Sturbois et al., under review).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trajectoryEnvelopeVariability(
  d,
  sites,
  surveys = NULL,
  nboot.ci = NULL,
  alpha.ci = 0.05,
  ...
)

stateEnvelopeVariability(d, nboot.ci = NULL, alpha.ci = 0.05)

compareToTrajectoryEnvelope(
  d,
  sites,
  envelope,
  surveys = NULL,
  m = 1.5,
  nboot.ci = NULL,
  alpha.ci = 0.05,
  distances_to_envelope = FALSE,
  distance_percentiles = FALSE,
  ...
)

compareToStateEnvelope(
  d,
  envelope,
  m = 1.5,
  nboot.ci = NULL,
  alpha.ci = 0.05,
  distances_to_envelope = FALSE,
  distance_percentiles = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="referenceEnvelopes_+3A_d">d</code></td>
<td>
<p>A symmetric <code><a href="base.html#topic+matrix">matrix</a></code> or an object of class <code><a href="stats.html#topic+dist">dist</a></code> containing the distance values between pairs of ecosystem states (see details).</p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_sites">sites</code></td>
<td>
<p>A vector indicating the site corresponding to each ecosystem state.</p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_surveys">surveys</code></td>
<td>
<p>A vector indicating the survey corresponding to each ecosystem state (only necessary when surveys are not in order).</p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_nboot.ci">nboot.ci</code></td>
<td>
<p>Number of bootstrap samples for confidence intervals. If nboot.ci = NULL then confidence intervals are not estimated.</p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_alpha.ci">alpha.ci</code></td>
<td>
<p>Error in confidence intervals.</p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_...">...</code></td>
<td>
<p>Additional parameters for function <code><a href="#topic+trajectoryDistances">trajectoryDistances</a></code></p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_envelope">envelope</code></td>
<td>
<p>A vector indicating the set of sites that conform the reference envelope (other sites will be compared to the envelope)</p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_m">m</code></td>
<td>
<p>Fuzziness exponent for quality value assessment</p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_distances_to_envelope">distances_to_envelope</code></td>
<td>
<p>Flag to indicate that distances to envelope should be included in the result</p>
</td></tr>
<tr><td><code id="referenceEnvelopes_+3A_distance_percentiles">distance_percentiles</code></td>
<td>
<p>Flag to include the percentage of distances to the envelope (among sites corresponding to the reference) that are smaller than that of the site.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions <code>stateEnvelopeVariability</code> and <code>trajectoryEnvelopeVariability</code> are used to assess the
variability of reference envelopes. Functions <code>compareToStateEnvelope</code> and <code>compareToTrajectoryEnvelope</code> are
used to evaluate the ecological quality of stations/observations with respect to a predefined reference envelope.
</p>


<h3>Value</h3>


<ul>
<li><p>Functions <code>stateEnvelopeVariability</code> and <code>trajectoryEnvelopeVariability</code> are used to assess the
</p>
</li>
<li><p>Functions <code>compareToStateEnvelope</code> and <code>compareToTrajectoryEnvelope</code> return data frame with columns identifying the envelope and the Q statistic for the ecological quality with respect to the
envelope. If <code>nboot.ci != NULL</code> extra columns are added to indicate the boundaries of a confidence interval for Q, built
using bootstrap samples of the reference envelope.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Miquel De Cáceres, CREAF
</p>
<p>Anthony Sturbois, Vivarmor nature, Réserve Naturelle nationale de la Baie de Saint-Brieuc
</p>


<h3>References</h3>

<p>Sturbois, A., De Cáceres, M., Bifolchi, A., Bioret, F., Boyé, A., Gauthier, O., Grall, J., Grémare, A., Labrune, C.,
Robert, A., Schaal, G., Desroy, N. (2023). Ecological Quality Assessment: a general multivariate framework to report
the quality of ecosystems and their dynamics with respect to reference conditions. Ecosphere.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trajectorymetrics">trajectorymetrics</a></code>, <code><a href="#topic+glomel">glomel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(glomel)
 
# Extract compositional data matrix
glomel_comp &lt;- as.matrix(glomel[,!(names(glomel) %in% c("ID", "Ref", "Complementary"))])
rownames(glomel_comp) &lt;- glomel$ID
 
# Calculate Bray-Curtis distance matrix 
glomel_bc &lt;- vegan::vegdist(glomel_comp, method = "bray")
 
# Define reference envelope (5 stations) by observation ID
glomel_env &lt;- glomel$ID[glomel$Ref]
 
# Assess quality with respect to reference envelope
compareToStateEnvelope(glomel_bc, glomel_env)

</code></pre>

<hr>
<h2 id='trajectorymetrics'>Metrics for Ecological Trajectory Analysis</h2><span id='topic+trajectorymetrics'></span><span id='topic+segmentDistances'></span><span id='topic+trajectoryDistances'></span><span id='topic+trajectoryLengths'></span><span id='topic+trajectoryLengths2D'></span><span id='topic+trajectoryAngles'></span><span id='topic+trajectoryAngles2D'></span><span id='topic+trajectoryProjection'></span><span id='topic+trajectoryConvergence'></span><span id='topic+trajectoryDirectionality'></span>

<h3>Description</h3>

<p>Ecological Trajectory Analysis (ETA) is a framework to analyze dynamics of ecosystems described as trajectories in a chosen space of multivariate resemblance (De Cáceres et al. 2019).
ETA takes trajectories as objects to be analyzed and compared geometrically.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>segmentDistances(
  d,
  sites,
  surveys = NULL,
  distance.type = "directed-segment",
  add = TRUE,
  verbose = FALSE
)

trajectoryDistances(
  d,
  sites,
  surveys = NULL,
  distance.type = "DSPD",
  symmetrization = "mean",
  add = TRUE,
  verbose = FALSE
)

trajectoryLengths(
  d,
  sites,
  surveys = NULL,
  relativeToInitial = FALSE,
  all = FALSE,
  verbose = FALSE
)

trajectoryLengths2D(
  xy,
  sites,
  surveys,
  relativeToInitial = FALSE,
  all = FALSE,
  verbose = FALSE
)

trajectoryAngles(
  d,
  sites,
  surveys = NULL,
  all = FALSE,
  relativeToInitial = FALSE,
  stats = TRUE,
  add = TRUE,
  verbose = FALSE
)

trajectoryAngles2D(
  xy,
  sites,
  surveys,
  relativeToInitial = FALSE,
  betweenSegments = TRUE
)

trajectoryProjection(d, target, trajectory, tol = 1e-06, add = TRUE)

trajectoryConvergence(
  d,
  sites,
  surveys = NULL,
  symmetric = FALSE,
  add = TRUE,
  verbose = FALSE
)

trajectoryDirectionality(d, sites, surveys = NULL, add = TRUE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trajectorymetrics_+3A_d">d</code></td>
<td>
<p>A symmetric <code><a href="base.html#topic+matrix">matrix</a></code> or an object of class <code><a href="stats.html#topic+dist">dist</a></code> containing the distance values between pairs of ecosystem states (see details).</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_sites">sites</code></td>
<td>
<p>A vector indicating the site corresponding to each ecosystem state.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_surveys">surveys</code></td>
<td>
<p>A vector indicating the survey corresponding to each ecosystem state (only necessary when surveys are not in order).</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_distance.type">distance.type</code></td>
<td>
<p>The type of distance index to be calculated (Besse et al. 2016; De Cáceres et al. submitted). For <code>segmentDistances</code> the available indices are:
</p>

<ul>
<li><p><code>Hausdorff</code>: Hausdorff distance between two segments.
</p>
</li>
<li><p><code>directed-segment</code>: Directed segment distance (default).
</p>
</li>
<li><p><code>PPA</code>: Perpendicular-parallel-angle distance.
</p>
</li></ul>

<p>whereas for <code>trajectoryDistances</code> the available indices are:
</p>

<ul>
<li><p><code>Hausdorff</code>: Hausdorff distance between two trajectories.
</p>
</li>
<li><p><code>SPD</code>: Segment path distance.
</p>
</li>
<li><p><code>DSPD</code>: Directed segment path distance (default).
</p>
</li></ul>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_add">add</code></td>
<td>
<p>Flag to indicate that constant values should be added (local transformation) to correct triplets of distance values that do not fulfill the triangle inequality.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_verbose">verbose</code></td>
<td>
<p>Provides console output informing about process (useful for large dataset).</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_symmetrization">symmetrization</code></td>
<td>
<p>Function used to obtain a symmetric distance, so that DSPD(T1,T2) = DSPD(T2,T1) (e.g., <code>mean</code> or <code>min</code>). If <code>symmetrization = NULL</code> then the symmetrization is not conducted and the output dissimilarity matrix is not symmetric.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_relativetoinitial">relativeToInitial</code></td>
<td>
<p>Flag to indicate that lengths or angles should be calculated with respect to initial survey.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_all">all</code></td>
<td>
<p>A flag to indicate that angles are desired for all triangles (i.e. all pairs of segments) in the trajectory. If FALSE, angles are calculated for consecutive segments only.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_xy">xy</code></td>
<td>
<p>Matrix with 2D coordinates in a Cartesian space (typically an ordination of ecosystem states).</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_stats">stats</code></td>
<td>
<p>A flag to indicate that circular statistics are desired (mean, standard deviation and mean resultant length, i.e. rho)</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_betweensegments">betweenSegments</code></td>
<td>
<p>Flag to indicate that angles should be calculated between trajectory segments or with respect to X axis.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_target">target</code></td>
<td>
<p>An integer vector of the ecosystem states to be projected.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_trajectory">trajectory</code></td>
<td>
<p>An integer vector of the trajectory onto which target states are to be projected.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_tol">tol</code></td>
<td>
<p>Numerical tolerance value to determine that projection of a point lies within the trajectory.</p>
</td></tr>
<tr><td><code id="trajectorymetrics_+3A_symmetric">symmetric</code></td>
<td>
<p>A logical flag to indicate a symmetric convergence comparison of trajectories.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a distance matrix between ecosystem states, the set of functions that provide ETA metrics are:
</p>

<ul>
<li><p>Functions <code>segmentDistances</code> and <code>trajectoryDistances</code> calculate the distance between pairs of directed segments and ecosystem trajectories, respectively.
</p>
</li>
<li><p>Function <code>trajectoryLengths</code> calculates lengths of directed segments and total path lengths of trajectories.
</p>
</li>
<li><p>Function <code>trajectoryLengths2D</code> calculates lengths of directed segments and total path lengths of trajectories from 2D coordinates given as input.
</p>
</li>
<li><p>Function <code>trajectoryAngles</code> calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.
</p>
</li>
<li><p>Function <code>trajectoryAngles2D</code> calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points.
</p>
</li>
<li><p>Function <code>trajectoryProjection</code> projects a set of target points onto a specified trajectory and returns the distance to the trajectory (i.e. rejection) and the relative position of the projection point within the trajectory.
</p>
</li>
<li><p>Function <code>trajectoryConvergence</code> performs the Mann-Kendall trend test on the distances between trajectories (symmetric test) or the distance between points of one trajectory to the other.
</p>
</li>
<li><p>Function <code>trajectoryDirectionality</code> returns (for each trajectory) a statistic that measures directionality of the whole trajectory.
</p>
</li></ul>

<p>Details of calculations are given in De Cáceres et al (2019).
The input distance matrix <code>d</code> should ideally be metric. That is, all subsets of distance triplets should fulfill the triangle inequality (see utility function <code><a href="#topic+is.metric">is.metric</a></code>).
All ETA functions that require metricity include a parameter '<code>add</code>', which by default is TRUE, meaning that whenever the triangle inequality is broken the minimum constant required to fulfill it is added to the three distances.
If such local (an hence, inconsistent across triplets) corrections are not desired, users should find another way modify <code>d</code> to achieve metricity, such as PCoA, metric MDS or non-metric MDS (see vignette 'Introduction to Ecological Trajectory Analysis').
If parameter '<code>add</code>' is set to FALSE and problems of triangle inequality exist, ETA functions may provide missing values in some cases where they should not.
</p>
<p>The resemblance between trajectories is done by adapting concepts and procedures used for the analysis of trajectories in space (i.e. movement data) (Besse et al. 2016).
</p>
<p>Function <code>trajectoryAngles</code> calculates angles between consecutive segments in degrees. For each pair of segments, the angle between the two is defined on the plane that contains the two segments, and measures the change in direction (in degrees) from one segment to the other.
Angles are always positive, with zero values indicating segments that are in a straight line, and values equal to 180 degrees for segments that are in opposite directions. If <code>all = TRUE</code>
angles are calculated between the segments corresponding to all ordered triplets. Alternatively, if <code>relativeToInitial = TRUE</code> angles are calculated for each segment with respect to the initial survey.
</p>
<p>Function <code>trajectoryAngles2D</code> calculates angles between consecutive segments in degrees from 2D coordinates given as input. For each pair of segments, the angle between the two is defined on the plane that contains the two segments, and measures the change in direction (in degrees) from one segment to the other.
Angles are always positive (O to 360), with zero values indicating segments that are in a straight line, and values equal to 180 degrees for segments that are in opposite directions.
If <code>all = TRUE</code> angles are calculated between the segments corresponding to all ordered triplets. Alternatively, if <code>relativeToInitial = TRUE</code> angles are calculated for each segment with respect to the initial survey.
If <code>betweenSegments = TRUE</code> angles are calculated between segments of trajectory, otherwise, If <code>betweenSegments = FALSE</code>, angles are calculated considering Y axis as the North (0°).
</p>


<h3>Value</h3>

<p>Function <code>trajectoryDistances</code> returns an object of class <code><a href="stats.html#topic+dist">dist</a></code> containing the distances between trajectories (if <code>symmetrization = NULL</code> then the object returned is of class <code>matrix</code>).
</p>
<p>Function <code>trajectorySegments</code> returns a list with the following elements:
</p>

<ul>
<li><p><code>Dseg</code>: Distance matrix between segments.
</p>
</li>
<li><p><code>Dini</code>: Distance matrix between initial points of segments.
</p>
</li>
<li><p><code>Dfin</code>: Distance matrix between final points of segments.
</p>
</li>
<li><p><code>Dinifin</code>: Distance matrix between initial points of one segment and the final point of the other.
</p>
</li>
<li><p><code>Dfinini</code>: Distance matrix between final points of one segment and the initial point of the other.
</p>
</li></ul>

<p>Function <code>trajectoryLengths</code> returns a data frame with the length of each segment on each trajectory and the total length of all trajectories.
If <code>relativeToInitial = TRUE</code> lengths are calculated between the initial survey and all the other surveys.
If <code>all = TRUE</code> lengths are calculated for all segments.
</p>
<p>Function <code>trajectoryLengths2D</code> returns a data frame with the length of each segment on each trajectory and the total length of all trajectories.
If <code>relativeToInitial = TRUE</code> lengths are calculated between the initial survey and all the other surveys.
If <code>all = TRUE</code> lengths are calculated for all segments.
</p>
<p>Function <code>trajectoryAngles</code> returns a data frame with angle values on each trajectory. If <code>stats=TRUE</code>, then the mean, standard deviation and mean resultant length of those angles are also returned.
</p>
<p>Function <code>trajectoryAngles2D</code> returns a data frame with angle values on each trajectory. If <code>betweenSegments=TRUE</code>, then angles are calculated between trajectory segments, alternatively, If <code>betweenSegments=FALSE</code>, angles are calculated considering Y axis as the North (0°).
</p>
<p>Function <code>trajectoryProjection</code> returns a data frame with the following columns:
</p>

<ul>
<li><p><code>distanceToTrajectory</code>: Distances to the trajectory, i.e. rejection (<code>NA</code> for target points whose projection is outside the trajectory).
</p>
</li>
<li><p><code>segment</code>: Segment that includes the projected point (<code>NA</code> for target points whose projection is outside the trajectory).
</p>
</li>
<li><p><code>relativePosition</code>: Relative position of the projected point within the trajectory, i.e. values from 0 to 1 with 0 representing the start of the trajectory and 1 representing the end (<code>NA</code> for target points whose projection is outside the trajectory).
</p>
</li></ul>

<p>Function <code>trajectoryConvergence</code> returns a list with two elements:
</p>

<ul>
<li><p><code>tau</code>: A matrix with the statistic (Mann-Kendall's tau) of the convergence/divergence test between trajectories. If <code>symmetric=TRUE</code> then the matrix is square. Otherwise the statistic of the test of the row trajectory approaching the column trajectory.
</p>
</li>
<li><p><code>p.value</code>: A matrix with the p-value of the convergence/divergence test between trajectories. If <code>symmetric=TRUE</code> then the matrix is square. Otherwise the p-value indicates the test of the row trajectory approaching the column trajectory.
</p>
</li></ul>

<p>Function <code>trajectoryDirectionality</code> returns a vector with directionality values (one per trajectory).
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres, CREAF
</p>
<p>Anthony Sturbois, Vivarmor nature, Réserve Naturelle nationale de la Baie de Saint-Brieuc
</p>


<h3>References</h3>

<p>Besse, P., Guillouet, B., Loubes, J.-M. &amp; François, R. (2016). Review and perspective for distance based trajectory clustering. IEEE Trans. Intell. Transp. Syst., 17, 3306–3317.
</p>
<p>De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R &amp; Hubbell S. (2019).
Trajectory analysis in community ecology. Ecological Monographs 89, e01350.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trajectoryplots">trajectoryplots</a></code>, <code><a href="#topic+trajectoryutils">trajectoryutils</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Description of sites and surveys
sites = c(1,1,1,2,2,2)
surveys=c(1,2,3,1,2,3)
  
#Raw data table
xy&lt;-matrix(0, nrow=6, ncol=2)
xy[2,2]&lt;-1
xy[3,2]&lt;-2
xy[4:6,1] &lt;- 0.5
xy[4:6,2] &lt;- xy[1:3,2]
xy[6,1]&lt;-1
  
#Draw trajectories
trajectoryPlot(xy, sites, surveys, 
               traj.colors = c("black","red"), lwd = 2)

#Distance matrix
d = dist(xy)
d
  
trajectoryLengths(d, sites, surveys)
trajectoryLengths2D(xy, sites, surveys)
trajectoryAngles(d, sites, surveys)
trajectoryAngles2D(xy, sites, surveys, betweenSegments = TRUE)
trajectoryAngles2D(xy, sites, surveys, betweenSegments = FALSE)
segmentDistances(d, sites, surveys)$Dseg
trajectoryDistances(d, sites, surveys, distance.type = "Hausdorff")
trajectoryDistances(d, sites, surveys, distance.type = "DSPD")
  
  
#Should give the same results if surveys are not in order 
#(here we switch surveys for site 2)
temp = xy[5,]
xy[5,] = xy[6,]
xy[6,] = temp
surveys[5] = 3
surveys[6] = 2
  
trajectoryPlot(xy, sites, surveys, 
               traj.colors = c("black","red"), lwd = 2)   
trajectoryLengths(dist(xy), sites, surveys)
trajectoryLengths2D(xy, sites, surveys)
segmentDistances(dist(xy), sites, surveys)$Dseg
trajectoryAngles(dist(xy), sites, surveys)
trajectoryAngles2D(xy, sites, surveys, betweenSegments = TRUE)
trajectoryAngles2D(xy, sites, surveys, betweenSegments = FALSE)
trajectoryDistances(dist(xy), sites, surveys, distance.type = "Hausdorff")
trajectoryDistances(dist(xy), sites, surveys, distance.type = "DSPD")
 
</code></pre>

<hr>
<h2 id='trajectoryplots'>Trajectory plots</h2><span id='topic+trajectoryplots'></span><span id='topic+trajectoryPCoA'></span><span id='topic+trajectoryPlot'></span>

<h3>Description</h3>

<p>Set of plotting functions for Ecological Trajectory Analysis:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trajectoryPCoA(
  d,
  sites,
  surveys = NULL,
  selection = NULL,
  traj.colors = NULL,
  axes = c(1, 2),
  survey.labels = FALSE,
  ...
)

trajectoryPlot(
  x,
  sites,
  surveys = NULL,
  selection = NULL,
  traj.colors = NULL,
  axes = c(1, 2),
  survey.labels = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trajectoryplots_+3A_d">d</code></td>
<td>
<p>A symmetric <code><a href="base.html#topic+matrix">matrix</a></code> or an object of class <code><a href="stats.html#topic+dist">dist</a></code> containing the distance values between pairs of ecosystem states (see details).</p>
</td></tr>
<tr><td><code id="trajectoryplots_+3A_sites">sites</code></td>
<td>
<p>A vector indicating the site corresponding to each ecosystem state.</p>
</td></tr>
<tr><td><code id="trajectoryplots_+3A_surveys">surveys</code></td>
<td>
<p>A vector indicating the survey corresponding to each ecosystem state (only necessary when surveys are not in order).</p>
</td></tr>
<tr><td><code id="trajectoryplots_+3A_selection">selection</code></td>
<td>
<p>A character vector of sites, a numeric vector of site indices or logical vector of the same length as <code>sites</code>, indicating a subset of site trajectories to be selected.</p>
</td></tr>
<tr><td><code id="trajectoryplots_+3A_traj.colors">traj.colors</code></td>
<td>
<p>A vector of colors (one per site). If <code>selection != NULL</code> the length of the color vector should be equal to the number of sites selected.</p>
</td></tr>
<tr><td><code id="trajectoryplots_+3A_axes">axes</code></td>
<td>
<p>The pair of principal coordinates to be plotted.</p>
</td></tr>
<tr><td><code id="trajectoryplots_+3A_survey.labels">survey.labels</code></td>
<td>
<p>A boolean flag to indicate whether surveys should be plotted as text next to arrow endpoints</p>
</td></tr>
<tr><td><code id="trajectoryplots_+3A_...">...</code></td>
<td>
<p>Additional parameters for function <code><a href="graphics.html#topic+arrows">arrows</a></code>.</p>
</td></tr>
<tr><td><code id="trajectoryplots_+3A_x">x</code></td>
<td>
<p>A data.frame or matrix where rows are ecosystem states and columns are coordinates in an arbitrary space</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>Function <code>trajectoryPCoA</code> performs principal coordinates analysis (<code><a href="stats.html#topic+cmdscale">cmdscale</a></code>) and draws trajectories in the ordination scatterplot.
</p>
</li>
<li><p>Function <code>trajectoryPlot</code> Draws trajectories in a scatterplot corresponding to the input coordinates.
</p>
</li></ul>

<p>Details of calculations are given in De Cáceres et al (2019).
The input distance matrix <code>d</code> should ideally be metric. That is, all subsets of distance triplets should fulfill the triangle inequality (see function <code>is.metric</code>).
All CTA functions that require metricity include a parameter '<code>add</code>', which by default is TRUE, meaning that whenever the triangle inequality is broken the minimum constant required to fulfill it is added to the three distances.
If such local (an hence, inconsistent across triplets) corrections are not desired, users should find another way modify <code>d</code> to achieve metricity, such as PCoA, metric MDS or non-metric MDS (see CTA vignette).
If parameter '<code>add</code>' is set to FALSE and problems of triangle inequality exist, CTA functions may provide missing values in some cases where they should not.
</p>
<p>The resemblance between trajectories is done by adapting concepts and procedures used for the analysis of trajectories in space (i.e. movement data) (Besse et al. 2016).
</p>


<h3>Value</h3>

<p>Function <code>trajectoryPCoA</code> returns the result of calling <code><a href="stats.html#topic+cmdscale">cmdscale</a></code>.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres, CREAF
</p>
<p>Anthony Sturbois, Vivarmor nature, Réserve Naturelle nationale de la Baie de Saint-Brieuc
</p>


<h3>References</h3>

<p>Besse, P., Guillouet, B., Loubes, J.-M. &amp; François, R. (2016). Review and perspective for distance based trajectory clustering. IEEE Trans. Intell. Transp. Syst., 17, 3306–3317.
</p>
<p>De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R &amp; Hubbell S. (2019). Trajectory analysis in community ecology. Ecological Monographs 89, e01350.
</p>
<p>Anderson (2017). Permutational Multivariate Analysis of Variance (PERMANOVA). Wiley StatsRef: Statistics Reference Online. 1-15. Article ID: stat07841.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trajectorymetrics">trajectorymetrics</a></code>, <code><a href="#topic+trajectoryutils">trajectoryutils</a></code>, <code><a href="stats.html#topic+cmdscale">cmdscale</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Description of sites and surveys
sites = c(1,1,1,2,2,2)
surveys=c(1,2,3,1,2,3)
  
#Raw data table
xy&lt;-matrix(0, nrow=6, ncol=2)
xy[2,2]&lt;-1
xy[3,2]&lt;-2
xy[4:6,1] &lt;- 0.5
xy[4:6,2] &lt;- xy[1:3,2]
xy[6,1]&lt;-1
  
#Draw trajectories
trajectoryPlot(xy, sites, surveys, 
               traj.colors = c("black","red"), lwd = 2)

  
#Should give the same results if surveys are not in order 
#(here we switch surveys for site 2)
temp = xy[5,]
xy[5,] = xy[6,]
xy[6,] = temp
surveys[5] = 3
surveys[6] = 2
  
trajectoryPlot(xy, sites, surveys, 
               traj.colors = c("black","red"), lwd = 2)   
 
</code></pre>

<hr>
<h2 id='trajectoryutils'>Utility functions for Ecological Trajectory Analysis</h2><span id='topic+trajectoryutils'></span><span id='topic+trajectorySelection'></span><span id='topic+centerTrajectories'></span><span id='topic+is.metric'></span>

<h3>Description</h3>

<p>The set following set of utility functions are provided:
</p>

<ul>
<li><p>Function <code>trajectorySelection</code> allows selecting the submatrix of distances corresponding to a given subset of trajectories.
</p>
</li>
<li><p>Function <code>centerTrajectories</code> shifts all trajectories to the center of the compositional space and returns a modified distance matrix.
</p>
</li>
<li><p>Function <code>is.metric</code> checks whether the input dissimilarity matrix is metric (i.e. all triplets fulfill the triangle inequality).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>trajectorySelection(d, sites, selection)

centerTrajectories(d, sites, verbose = FALSE)

is.metric(d, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trajectoryutils_+3A_d">d</code></td>
<td>
<p>A symmetric <code><a href="base.html#topic+matrix">matrix</a></code> or an object of class <code><a href="stats.html#topic+dist">dist</a></code> containing the distance values between pairs of ecosystem states (see details).</p>
</td></tr>
<tr><td><code id="trajectoryutils_+3A_sites">sites</code></td>
<td>
<p>A vector indicating the site corresponding to each ecosystem state.</p>
</td></tr>
<tr><td><code id="trajectoryutils_+3A_selection">selection</code></td>
<td>
<p>A character vector of sites, a numeric vector of site indices or logical vector of the same length as <code>sites</code>, indicating a subset of site trajectories to be selected.</p>
</td></tr>
<tr><td><code id="trajectoryutils_+3A_verbose">verbose</code></td>
<td>
<p>Provides console output informing about process (useful for large dataset).</p>
</td></tr>
<tr><td><code id="trajectoryutils_+3A_tol">tol</code></td>
<td>
<p>Tolerance value for metricity</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details of calculations are given in De Cáceres et al (2019).
Function <code>centerTrajectories</code> performs centering of trajectories using matrix algebra as explained in Anderson (2017).
</p>


<h3>Value</h3>

<p>Function <code>centerTrajectories</code> and <code>trajectorySelection</code> return an object of class <code><a href="stats.html#topic+dist">dist</a></code>.
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres, CREAF
</p>


<h3>References</h3>

<p>De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ, Condit R &amp; Hubbell S. (2019). Trajectory analysis in community ecology. Ecological Monographs 89, e01350.
</p>
<p>Anderson (2017). Permutational Multivariate Analysis of Variance (PERMANOVA). Wiley StatsRef: Statistics Reference Online. 1-15. Article ID: stat07841.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trajectoryplots">trajectoryplots</a></code> <code><a href="#topic+trajectorymetrics">trajectorymetrics</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
