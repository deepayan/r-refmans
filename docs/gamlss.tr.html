<!DOCTYPE html><html><head><title>Help for package gamlss.tr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gamlss.tr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gamlss.tr-package'>
<p>Generating and Fitting Truncated &lsquo;gamlss.family&rsquo; Distributions</p></a></li>
<li><a href='#fitTail'><p>For fitting truncated distribution to the tails of data</p></a></li>
<li><a href='#gen.trun'><p>Generates a truncated distribution from a gamlss.family</p></a></li>
<li><a href='#trun'><p>Fits a Truncate Distribution from a gamlss.family</p></a></li>
<li><a href='#trun.d'><p>Truncated Probability Density Function of a gamlss.family Distribution</p></a></li>
<li><a href='#trun.p'><p>Truncated Cumulative Density Function of a gamlss.family Distribution</p></a></li>
<li><a href='#trun.q'><p>Truncated Inverse Cumulative Density Function of a gamlss.family Distribution</p></a></li>
<li><a href='#trun.r'><p>Generates Random Values from a Truncated Density Function of a gamlss.family Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generating and Fitting Truncated &lsquo;gamlss.family&rsquo; Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>5.1-9</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;, Bob
        Rigby &lt;r.rigby@gre.ac.uk&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.2.1), gamlss.dist, gamlss (&ge; 5.0-0), methods</td>
</tr>
<tr>
<td>Description:</td>
<td>This is an add on package to GAMLSS. The purpose of this
        package is to allow users to defined truncated distributions in
        GAMLSS models. The main function gen.trun() generates truncated
        version of an existing GAMLSS family distribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.gamlss.com/">https://www.gamlss.com/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-28 10:03:10 UTC; dimitriosstasinopoulos</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-30 08:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='gamlss.tr-package'>
Generating and Fitting Truncated &lsquo;gamlss.family&rsquo; Distributions
</h2><span id='topic+gamlss.tr-package'></span><span id='topic+gamlss.tr'></span>

<h3>Description</h3>

<p>This is an add on package to GAMLSS. The purpose of this
        package is to allow users to defined truncated distributions in
        GAMLSS models. The main function gen.trun() generates truncated
        version of an existing GAMLSS family distribution.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> gamlss.tr</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Generating and Fitting Truncated `gamlss.family' Distributions</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 5.1-9</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-01-28</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;, Bob
        Rigby &lt;r.rigby@gre.ac.uk&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 2.2.1), gamlss.dist,  gamlss (&gt;= 5.0-0), methods</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> This is an add on package to GAMLSS. The purpose of this
        package is to allow users to defined truncated distributions in
        GAMLSS models. The main function gen.trun() generates truncated
        version of an existing GAMLSS family distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://www.gamlss.com/</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
fitTail                 For fitting truncated distribution to the tails
                        of data
gamlss.tr-package       Generating and Fitting Truncated
                        'gamlss.family' Distributions
gen.trun                Generates a truncated distribution from a
                        gamlss.family
trun                    Fits a Truncate Distribution from a
                        gamlss.family
trun.d                  Truncated Probability Density Function of a
                        gamlss.family Distribution
trun.p                  Truncated Cumulative Density Function of a
                        gamlss.family Distribution
trun.q                  Truncated Inverse Cumulative Density Function
                        of a gamlss.family Distribution
trun.r                  Generates Random Values from a Truncated
                        Density Function of a gamlss.family
                        Distribution
</pre>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;, Bob
        Rigby &lt;r.rigby@gre.ac.uk&gt;
</p>
<p>Maintainer: Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generating a t-distribution from 0 to 100  	
gen.trun(par=c(0,100),family="TF", name="0to100", type="both")
op&lt;-par(mfrow=c(2,2))
plot(function(x) dTF0to100(x, mu=80 ,sigma=20, nu=5), 0, 100, ylab="pdf")
plot(function(x) pTF0to100(x, mu=80 ,sigma=20, nu=5), 0, 100, ylab="cdf")
plot(function(x) qTF0to100(x, mu=80 ,sigma=20, nu=5), 0.01, .999, ylab="invcdf")
hist(s1&lt;-rTF0to100(1000, mu=80 ,sigma=20, nu=5), ylab="hist", xlab="x", main="generated data")
par(op)
</code></pre>

<hr>
<h2 id='fitTail'>For fitting truncated distribution to the tails of data 
</h2><span id='topic+fitTail'></span><span id='topic+fitTailAll'></span>

<h3>Description</h3>

<p>There are two functions here. The function <code>fitTail()</code> which fits a truncated distribution to certain percentage of the tail of a response variable and the function  <code>fitTailAll()</code> which does a sequence of truncated fits. Plotting  the results from those fits is analogous to the Hill plot, Hill (1975).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitTail(y, family = "WEI3", percentage = 10, howmany = NULL, 
      type = c("right", "left"), ...)
   
fitTailAll(y, family = "WEI3", percentage = 10, howmany = NULL, 
      type = c("right", "left"), plot = TRUE, 
      print = TRUE, save = FALSE, start = 5, trace = 0,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitTail_+3A_y">y</code></td>
<td>
<p>The variable of interest
</p>
</td></tr>
<tr><td><code id="fitTail_+3A_family">family</code></td>
<td>
<p>a <code>gamlsss.family</code> distribution</p>
</td></tr>
<tr><td><code id="fitTail_+3A_percentage">percentage</code></td>
<td>
<p>what percentage of the tail need to be modelled, default is 10%</p>
</td></tr>
<tr><td><code id="fitTail_+3A_howmany">howmany</code></td>
<td>
<p>how many observations in the tail needed. This is an alternative to <code>percentage</code>. If it specified it take over from the <code>percentage</code> argument otherwise <code>percentage</code> is used.</p>
</td></tr>
<tr><td><code id="fitTail_+3A_type">type</code></td>
<td>
<p>which tall needs checking the right (default) of the left</p>
</td></tr>
<tr><td><code id="fitTail_+3A_plot">plot</code></td>
<td>
<p>whether to plot with default equal <code>TRUE</code> </p>
</td></tr>
<tr><td><code id="fitTail_+3A_print">print</code></td>
<td>
<p>whether to print the coefficients with default equal <code>TRUE</code></p>
</td></tr>
<tr><td><code id="fitTail_+3A_save">save</code></td>
<td>
<p>whether to save the fitted linear model with default equal <code>FALSE</code></p>
</td></tr>
<tr><td><code id="fitTail_+3A_start">start</code></td>
<td>
<p>where to start fitting from the tail of the data</p>
</td></tr>
<tr><td><code id="fitTail_+3A_trace">trace</code></td>
<td>
<p>0: no output 1: minimal 2: print estimates</p>
</td></tr>
<tr><td><code id="fitTail_+3A_...">...</code></td>
<td>

<p>for further argument to the fitting function
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The idea here is to fit a truncated distribution to the tail of the data.
Truncated log-normal and Weibull distributions could be appropriate distributions. More details can be found in Chapter 6 of  &quot;The Distribution Toolbox of GAMLSS&quot; book  which can be found in   <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>Value</h3>

<p>A fitted gamlss model
</p>


<h3>Author(s)</h3>

<p>Bob Rigby <a href="mailto:r.rigby@gre.ac.uk">r.rigby@gre.ac.uk</a>, Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Vlassios Voudouris 
</p>


<h3>References</h3>

<p>Hill B. M. (1975) A Simple General Approach to Inference About the Tail of a Distribution
<em>Ann. Statist.</em> Volume <b>3</b>, Number 5, pp 1163-1174.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code><a href="gamlss.html#topic+loglogSurv">loglogSurv</a></code>, <code><a href="gamlss.html#topic+logSurv">logSurv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(film90)
F90 &lt;- exp(film90$lborev1)# original scale
# trucated plots
# 10%
w403&lt;- fitTail(F90, family=WEI3)
qqnorm(resid(w403))
abline(0,1, col="red")

## Not run: 
# hill -sequential plot 10
w1&lt;-fitTailAll(F90)
# plot sigma
plot(w1[,2])
#-----------------
#LOGNO
l403&lt;- fitTail(F90, family=LOGNO)
plot(l403)
qqnorm(resid(l403))
abline(0,1)
#  hill -sequential plot 10
l1&lt;-fitTailAll(F90, family=LOGNO)
plot(l1[,2])
#-------------------------

## End(Not run)
</code></pre>

<hr>
<h2 id='gen.trun'>Generates a truncated distribution from a gamlss.family</h2><span id='topic+gen.trun'></span>

<h3>Description</h3>

<p>The <code>gen.trun()</code> function allows the user to generate <code>d</code>, <code>p</code>,  <code>q</code>, and <code>r</code> distribution functions plus  an extra
<code>gamlss.family</code> function for fitting a truncated  distribution with <code>gamlss</code>. 
</p>
<p>For continuous distributions left truncation at 3 means that the random variable can take the value 3.
For discrete distributions left truncation at 3 means that the random variable can take values from 4 onwards.
This is the same for right truncation. Truncation at 15 for a discrete variable means that 
15 and greater values are not allowed but for continuous variable it mean values greater that 15 are not allowed 
(so 15 is a possible value).    
</p>
<p>If the user want a different link (rather the default) for any of the parameters she/he has to declare at the generation of the functions, see example.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.trun(par = c(0), family = "NO", name = "tr", 
         type = c("left", "right", "both"), 
         varying = FALSE,  print=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.trun_+3A_par">par</code></td>
<td>
<p> a vector with one (for <code>"left"</code> or <code>"right"</code> truncation) or two elements for <code>"both"</code>. When the argument <code>varying = TRUE</code> then <code>par</code> can be a vector or a matrix with two columns respectively.</p>
</td></tr>
<tr><td><code id="gen.trun_+3A_family">family</code></td>
<td>
<p> a <code>gamlss.family</code> object, which is used to define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> can be found in <code>gamlss.family</code>.
</p>
</td></tr>
<tr><td><code id="gen.trun_+3A_name">name</code></td>
<td>
<p>the extra characters to be added to the name of new truncated distribution, by default it adds <code>tr</code></p>
</td></tr>
<tr><td><code id="gen.trun_+3A_type">type</code></td>
<td>
<p>whether <code>"left"</code>, <code>"right"</code> or in <code>"both"</code> sides truncation is required  </p>
</td></tr>
<tr><td><code id="gen.trun_+3A_varying">varying</code></td>
<td>
<p>whether the truncation  varies for different observations. This can be useful in regression analysis. If <code>varying = TRUE</code> then <code>par</code> should be an n-length vector for <code>type</code> equal <code>"left"</code> and <code>"right"</code> and an n by 2 matrix for <code>type="both"</code></p>
</td></tr>
<tr><td><code id="gen.trun_+3A_print">print</code></td>
<td>
<p>whether to print the names of the created distribution</p>
</td></tr>
<tr><td><code id="gen.trun_+3A_...">...</code></td>
<td>
<p>for extra arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns  the <code>d</code>, the <code>p</code>, the <code>q</code>, the <code>r</code> and the fitting functions of a truncated <code>gamlss.family</code> distribution. 
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

 
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+trun.d">trun.d</a></code>, <code><a href="#topic+trun.p">trun.p</a></code>, <code><a href="#topic+trun.q">trun.q</a></code>, <code><a href="#topic+trun.r">trun.r</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># generating a t-distribution from 0 to 100  	
gen.trun(par=c(0,100),family="TF", name="0to100", type="both")
op&lt;-par(mfrow=c(2,2))
plot(function(x) dTF0to100(x, mu=80 ,sigma=20, nu=5), 0, 100, ylab="pdf")
plot(function(x) pTF0to100(x, mu=80 ,sigma=20, nu=5), 0, 100, ylab="cdf")
plot(function(x) qTF0to100(x, mu=80 ,sigma=20, nu=5), 0.01, .999, ylab="invcdf")
hist(s1&lt;-rTF0to100(1000, mu=80 ,sigma=20, nu=5), ylab="hist", xlab="x", 
            main="generated data")
par(op)
m1&lt;-histDist(s1, family=TF0to100, xlim=c(0,100))# fitting the data
# using the argumnt varying 
# left part varies right part equal 100
leftPAR &lt;- rPO(100)
gen.trun(par=cbind(leftPAR,rep(100, 100)),family="TF", name="0to100Varying", 
            type="both", varying=TRUE)
YY&lt;- rTF0to100Varying(100, mu=80, sigma=20, nu=5)
m1&lt;-gamlss(YY~1, family=TF0to100Varying)
m1
</code></pre>

<hr>
<h2 id='trun'>Fits a Truncate Distribution from a gamlss.family</h2><span id='topic+trun'></span>

<h3>Description</h3>

<p>This function can be used to fit truncated distributions. It takes as an argument an existing GAMLSS family distribution and 
a parameter vector,  of the type c(left.value, right.value), and  generates a <code>gamlss.family</code> object which then can be used to fit 
a truncated distribution.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trun(par = c(0), family = "NO",  type = c("left", "right", "both"), name = "tr", 
        local = TRUE, delta=NULL, varying = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trun_+3A_par">par</code></td>
<td>
<p> a vector with one (for <code>"left"</code> or <code>"right"</code> truncation) or two elements for <code>"both"</code>. When the argument <code>varying = TRUE</code> then <code>par</code> can be a vector or a matrix with two columns respectively.</p>
</td></tr>
<tr><td><code id="trun_+3A_family">family</code></td>
<td>
<p>an existing <code>gamlss.family</code> distribution</p>
</td></tr>
<tr><td><code id="trun_+3A_type">type</code></td>
<td>
<p>what type of truncation is required, <code>left</code>, <code>right</code> or <code>both</code>. If <code>both</code> the <code>par</code> should be a vector of length two. (the default is left truncation)</p>
</td></tr>
<tr><td><code id="trun_+3A_name">name</code></td>
<td>
<p>a character string to be added to name of the created object i.e. with <code>family=TF</code> and <code>name=trZero</code> the <code>gamlss.family</code> object will be called <code>TFtrZero</code></p>
</td></tr>
<tr><td><code id="trun_+3A_local">local</code></td>
<td>
<p>if TRUE the function will try to find the environment of <code>gamlss</code> to generate the <code>d</code> and <code>p</code> functions required for the fitting, if FALSE the functions will be generated in the global environment</p>
</td></tr>
<tr><td><code id="trun_+3A_delta">delta</code></td>
<td>
<p>the delta increment used in the numerical derivatives</p>
</td></tr> 
<tr><td><code id="trun_+3A_varying">varying</code></td>
<td>
<p>whether the truncation  varies for diferent observations. This can be usefull in regression analysis. If <code>varying = TRUE</code> then <code>par</code> should be an n-length vector for <code>type</code> equal <code>"left"</code> and <code>"right"</code> and an n by 2 matrix for <code>type="both"</code></p>
</td></tr>
<tr><td><code id="trun_+3A_...">...</code></td>
<td>
<p>for extra arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is created to help the user to fit a truncated form of existing <code>gamlss</code> distribution.
It does this by taking an existing <code>gamlss.family</code> and changing some of the components of the distribution to help the fitting process. 
It particular it i) creates a pdf (<code>d</code>) and a cdf (<code>p</code>) function within <code>gamlss</code>, 
ii) changes  the global deviance function <code>G.dev.incr</code>, the first derivative functions (see note below) and the quantile residual function.   
</p>


<h3>Value</h3>

<p>It returns a <code>gamlss.family</code> object which has all the components needed for fitting a distribution in <code>gamlss</code>. 
</p>


<h3>Note</h3>

<p>This function is experimental and could be changed. The function <code>trun</code>  changes 
the first derivatives of the original gamlss family <code>d</code> function to numerical derivatives 
for the new truncated <code>d</code> function. The default increment <code>delta</code>,
for this numerical derivatives function, is <code>eps * pmax(abs(x), 1)</code> where 
<code>eps&lt;-sqrt(.Machine$double.eps)</code>.  The default <code>delta</code> could be inappropriate 
for specific applications and can be overwritten by using the argument <code>delta</code>.</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

<p> Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).</p>


<h3>See Also</h3>

<p><code><a href="#topic+trun.d">trun.d</a></code>, <code><a href="#topic+trun.p">trun.p</a></code>, <code><a href="#topic+trun.q">trun.q</a></code>, <code><a href="#topic+trun.r">trun.r</a></code>,  <code><a href="#topic+gen.trun">gen.trun</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># generate a left truncated zero t family
gen.trun(0,family="TF")
# take a random sample of 1000 observations
sam&lt;-rTFtr(1000,mu=10,sigma=5, nu=5 )
hist(sam)
# fit the distribution to the data
mod1&lt;-gamlss(sam~1, family=trun(0,TF))
mod1
# now create a gamlss.family object before the fitting 
Ttruc.Zero&lt;- trun(par=0,family=TF, local=FALSE)
mod2&lt;-gamlss(sam~1, family=Ttruc.Zero)
# now check the sensitivity of delta 
Ttruc.Zero&lt;- trun(par=0,family=TF, local=FALSE, delta=c(0.01,0.01, 0.01))
mod3&lt;-gamlss(sam~1, family=Ttruc.Zero)
</code></pre>

<hr>
<h2 id='trun.d'>Truncated Probability Density Function of a gamlss.family Distribution</h2><span id='topic+trun.d'></span>

<h3>Description</h3>

<p>Creates a truncated probability density function version from a current GAMLSS family distribution
</p>
<p>For continuous distributions left truncation at  3 means that the random variable can take the value 3.
For discrete distributions left truncation at 3 means that the random variable can take values from 4 onwards.
This is the same for right truncation. Truncation at 15 for a discrete variable means that 
15 and greater values are not allowed but for continuous variable it mean values greater that 15 are not allowed 
(so 15 is a possible value). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trun.d(par, family = "NO", type = c("left", "right", "both"),
       varying = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trun.d_+3A_par">par</code></td>
<td>
<p> a vector with one (for <code>"left"</code> or <code>"right"</code> truncation) or two elements for <code>"both"</code>. When the argument <code>varying = TRUE</code> then <code>par</code> can be a vector or a matrix with two columns respectively.</p>
</td></tr>
<tr><td><code id="trun.d_+3A_family">family</code></td>
<td>
<p>a <code>gamlss.family</code> object, which is used to define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> can be found in <code>gamlss.family</code>.
Functions such as BI() (binomial) produce a family object. </p>
</td></tr>
<tr><td><code id="trun.d_+3A_type">type</code></td>
<td>
<p>whether <code>left</code>, <code>right</code> or in <code>both</code> sides truncation is required, (left is the default).</p>
</td></tr>
<tr><td><code id="trun.d_+3A_varying">varying</code></td>
<td>
<p>whether the truncation  varies for diferent observations. This can be usefull in regression analysis. If <code>varying = TRUE</code> then <code>par</code> should be an n-length vector for <code>type</code> equal <code>"left"</code> and <code>"right"</code> and an n by 2 matrix for <code>type="both"</code></p>
</td></tr>
<tr><td><code id="trun.d_+3A_...">...</code></td>
<td>
<p> for extra arguments </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a d family function 
</p>


<h3>Author(s)</h3>

<p> Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

<p> Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>). </p>


<h3>See Also</h3>

  <p><code><a href="#topic+trun.p">trun.p</a></code>, <code><a href="#topic+trun.q">trun.q</a></code>, <code><a href="#topic+trun.r">trun.r</a></code>, <code><a href="#topic+gen.trun">gen.trun</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#------------------------------------------------------------------------------------------
# continuous distribution 
# left truncation 
test1&lt;-trun.d(par=c(0), family="TF", type="left")
test1(1)
dTF(1)/(1-pTF(0))
if(abs(test1(1)-(dTF(1)/pTF(0)))&gt;0.00001) stop("error in left trucation")
test1(1, log=TRUE)
log(dTF(1)/(1-pTF(0)))
if(abs(test1(1, log=TRUE)-log(dTF(1)/pTF(0)))&gt;0.00001) 
                   stop("error in left trucation")
integrate(function(x) test1(x, mu=-2, sigma=1, nu=1),0,Inf) 
# the pdf is defined even with negative mu
integrate(function(x) test1(x, mu=0, sigma=10, nu=1),0,Inf) 
integrate(function(x) test1(x, mu=5, sigma=5, nu=10),0,Inf)
plot(function(x) test1(x, mu=-3, sigma=1, nu=1),0,10)
plot(function(x) test1(x, mu=3, sigma=5, nu=10),0,10)
#----------------------------------------------------------------------------------------
# right truncation
test2&lt;-trun.d(par=c(10), family="BCT", type="right")
test2(1)
dBCT(1)/(pBCT(10))
#if(abs(test2(1)-(dBCT(1)/pBCT(10)))&gt;0.00001) stop("error in right trucation")
test2(1, log=TRUE)
log(dBCT(1)/(pBCT(10)))
if(abs(test2(1, log=TRUE)-log(dBCT(1)/(pBCT(10))))&gt;0.00001) 
                   stop("error in right trucation")
integrate(function(x) test2(x, mu=2, sigma=1, nu=1),0,10) 
integrate(function(x) test2(x, mu=2, sigma=.1, nu=1),0,10) 
integrate(function(x) test2(x, mu=2, sigma=.1, nu=10),0,10) 
plot(function(x) test2(x, mu=2, sigma=.1, nu=1),0,10)
plot(function(x) test2(x, mu=2, sigma=1, nu=1),0,10)
#-----------------------------------------------------------------------------------------
# both left and right truncation
test3&lt;-trun.d(par=c(-3,3), family="TF", type="both")
test3(0)
dTF(0)/(pTF(3)-pTF(-3))
if(abs(test3(0)-dTF(0)/(pTF(3)-pTF(-3)))&gt;0.00001) 
              stop("error in right trucation")
test3(0, log=TRUE)
log(dTF(0)/(pTF(3)-pTF(-3)))
if(abs(test3(0, log=TRUE)-log(dTF(0)/(pTF(3)-pTF(-3))))&gt;0.00001) 
            stop("error in both trucation")
plot(function(x) test3(x, mu=0, sigma=1, nu=1),-3,3)
integrate(function(x) test3(x, mu=2, sigma=1, nu=1),-3,3)
#-----------------------------------------------------------------------------------------
# discrete distribution
# left 
# Poisson truncated at zero means zero is excluded
test4&lt;-trun.d(par=c(0), family="PO", type="left")
test4(1)
dPO(1)/(1-pPO(0))
if(abs(test4(1)-dPO(1)/(1-pPO(0)))&gt;0.00001) stop("error in left trucation")
test4(1, log=TRUE)
log(dPO(1)/(1-pPO(0)))
if(abs(test4(1, log=TRUE)-log(dPO(1)/(1-pPO(0))))&gt;0.00001) 
               stop("error in left trucation")
sum(test4(x=1:20, mu=2)) # 
sum(test4(x=1:200, mu=80)) #
plot(function(x) test4(x, mu=20), from=1, to=51, n=50+1, type="h") # pdf 
# right
# right truncated at 10 means 10 is excluded
test5&lt;-trun.d(par=c(10), family="NBI", type="right")
test5(2)
dNBI(2)/(pNBI(9))
if(abs(test5(1)-dNBI(1)/(pNBI(9)))&gt;0.00001) stop("error in right trucation")
test5(1, log=TRUE)
log(dNBI(1)/(pNBI(9)))
if(abs(test5(1, log=TRUE)-log(dNBI(1)/(pNBI(9))))&gt;0.00001) stop("error in right trucation")
sum(test5(x=0:9, mu=2,   sigma=2)) # 
sum(test5(x=0:9, mu=300, sigma=5)) # can have mu &gt; parameter
plot(function(x) test5(x, mu=20, sigma=3), from=0, to=9, n=10, type="h") # pdf
plot(function(x) test5(x, mu=300, sigma=5), from=0, to=9, n=10, type="h") # pdf
#----------------------------------------------------------------------------------------
# both
test6&lt;-trun.d(par=c(0,10), family="NBI", type="both")
test6(2)
dNBI(2)/(pNBI(9)-pNBI(0))
if(abs(test6(2)-dNBI(2)/(pNBI(9)-pNBI(0)))&gt;0.00001) 
        stop("error in right trucation")
test6(1, log=TRUE)
log(dNBI(1)/(pNBI(9)-pNBI(0)))
if(abs(test6(1, log=TRUE)-log(dNBI(1)/(pNBI(9)-pNBI(0))))&gt;0.00001) 
  stop("error in right trucation")
sum(test6(x=1:9, mu=2,   sigma=2)) # 
sum(test6(x=1:9, mu=100, sigma=5)) # can have mu &gt; parameter
plot(function(x) test6(x, mu=20, sigma=3), from=1, to=9, n=9, type="h") # pdf
plot(function(x) test6(x, mu=300, sigma=.4), from=1, to=9, n=9, type="h") # pdf
#------------------------------------------------------------------------------------------
# now try when the trucated points varies for each observarion
# this will be appropriate for regression models only 
# continuous
#----------------------------------------------------------------------------------------
# left truncation
test7&lt;-trun.d(par=c(0,1,2), family="TF", type="left", varying=TRUE)
test7(c(1,2,3))
dTF(c(1,2,3))/(1-pTF(c(0,1,2)))
test7(c(1,2,3), log=TRUE)
#----------------------------------------------------------------------------------------
# right truncation
test8&lt;-trun.d(par=c(10,11,12), family="BCT", type="right", varying=TRUE)
test8(c(1,2,3))
dBCT(c(1,2,3))/(pBCT(c(10,11,12)))
test8(c(1,2,3), log=TRUE)
#----------------------------------------------------------------------------------------
# both left and right truncation
test9&lt;-trun.d(par=cbind(c(0,1,2),c(10,11,12) ), family="TF", type="both", 
             varying=TRUE)
test9(c(1,2,3))
dTF(c(1,2,3))/ (pTF(c(10,11,12))-pTF(c(0,1,2)))
test3(c(1,2,3), log=TRUE)
#----------------------------------------------------------------------------------------
# discrete
# left
test10&lt;-trun.d(par=c(0,1,2), family="PO", type="left", varying=TRUE)
test10(c(1,2,3))
dPO(c(1,2,3))/(1-pPO(c(0,1,2)))
# right
test11&lt;-trun.d(par=c(10,11,12), family="NBI", type="right", varying=TRUE)
test11(c(1,2,3))
dNBI(c(1,2,3))/pNBI(c(9,10,11))
# both
test12&lt;-trun.d(par=rbind(c(0,10), c(1,11), c(2,12)), family="NBI", type="both", varying=TRUE)
test12(c(2,3,4))
dNBI(c(2,3,4))/(pNBI(c(9,10,11))-pNBI(c(0,1,2)))
</code></pre>

<hr>
<h2 id='trun.p'>Truncated Cumulative Density Function of a gamlss.family Distribution</h2><span id='topic+trun.p'></span>

<h3>Description</h3>

<p>Creates a truncated cumulative density function version from a current GAMLSS family distribution.
</p>
<p>For continuous distributions left truncation at  3 means that the random variable can take the value 3.
For discrete distributions left truncation at 3 means that the random variable can take values from 4 onwards.
This is the same for right truncation. Truncation at 15 for a discrete variable means that 
15 and greater values are not allowed but for continuous variable it mean values greater that 15 are not allowed 
(so 15 is a possible value). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trun.p(par, family = "NO", type = c("left", "right", "both"),
        varying = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trun.p_+3A_par">par</code></td>
<td>
<p> a vector with one (for <code>"left"</code> or <code>"right"</code> truncation) or two elements for <code>"both"</code>. When the argument <code>varying = TRUE</code> then <code>par</code> can be a vector or a matrix with two columns respectively.</p>
</td></tr>
<tr><td><code id="trun.p_+3A_family">family</code></td>
<td>
<p> a <code>gamlss.family</code> object, which is used to define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> can be found in <code>gamlss.family</code>.
Functions such as BI() (binomial) produce a family object. </p>
</td></tr>
<tr><td><code id="trun.p_+3A_type">type</code></td>
<td>
<p> whether <code>left</code>, <code>right</code> or in <code>both</code> sides truncation is required, (left is the default)</p>
</td></tr>
<tr><td><code id="trun.p_+3A_varying">varying</code></td>
<td>
<p>whether the truncation  varies for diferent observations. This can be usefull in regression analysis. If <code>varying = TRUE</code> then <code>par</code> should be an n-length vector for <code>type</code> equal <code>"left"</code> and <code>"right"</code> and an n by 2 matrix for <code>type="both"</code></p>
</td></tr>
<tr><td><code id="trun.p_+3A_...">...</code></td>
<td>
<p>for extra arguments </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a p family function 
</p>


<h3>Author(s)</h3>

<p>  Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>). </p>


<h3>See Also</h3>

  <p><code><a href="#topic+trun.d">trun.d</a></code>, <code><a href="#topic+trun.q">trun.q</a></code>, <code><a href="#topic+trun.r">trun.r</a></code>, <code><a href="#topic+gen.trun">gen.trun</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># trucated p  continuous function
# continuous
#----------------------------------------------------------------------------------------
# left
test1&lt;-trun.p(par=c(0), family="TF", type="left")
test1(1)
(pTF(1)-pTF(0))/(1-pTF(0))
if(abs(test1(1)-(pTF(1)-pTF(0))/(1-pTF(0)))&gt;0.00001) 
                      stop("error in left trucation of p")
plot(function(x) test1(x, mu=2, sigma=1, nu=2),0,10)
#----------------------------------------------------------------------------------------
# right
test2 &lt;- trun.p(par=c(10), family="BCT", type="right")
test2(1)
pBCT(1)/pBCT(10)
if(abs(test2(1)-pBCT(1)/pBCT(10))&gt;0.00001) stop("error in right trucation")
test2(1, lower.tail=FALSE)
1-pBCT(1)/pBCT(10)
if(abs(test2(1, lower.tail=FALSE)-(1-pBCT(1)/pBCT(10)))&gt;0.00001) 
                stop("error in right trucation")
test2(1, log.p=TRUE)
log(pBCT(1)/pBCT(10))
if(abs(test2(1, log.p=TRUE)-log(pBCT(1)/pBCT(10)))&gt;0.00001) 
               stop("error in right trucation")
plot(function(x) test2(x, mu=2, sigma=1, nu=2, tau=2),0,10)
plot(function(x) test2(x, mu=2, sigma=1, nu=2, tau=2, 
                       lower.tail=FALSE),0,10)
#----------------------------------------------------------------------------------------
# both 
test3&lt;-trun.p(par=c(-3,3), family="TF", type="both")
test3(1)
(pTF(1)-pTF(-3))/(pTF(3)-pTF(-3))
if(abs(test3(1)-(pTF(1)-pTF(-3))/(pTF(3)-pTF(-3)))&gt;0.00001) 
             stop("error in right trucation")
test3(1, lower.tail=FALSE)
1-(pTF(1)-pTF(-3))/(pTF(3)-pTF(-3))
if(abs(test3(0,lower.tail=FALSE)-
            (1-(pTF(0)-pTF(-3))/(pTF(3)-pTF(-3))))&gt;0.00001) 
      stop("error in right trucation")
plot(function(x) test3(x, mu=2, sigma=1, nu=2, ),-3,3)
plot(function(x) test3(x, mu=2, sigma=1, nu=2, lower.tail=FALSE),-3,3)
#----------------------------------------------------------------------------------------
# Discrete
#----------------------------------------------------------------------------------------
# trucated p function
# left
test4&lt;-trun.p(par=c(0), family="PO", type="left")
test4(1)
(pPO(1)-pPO(0))/(1-pPO(0))
if(abs(test4(1)-(pPO(1)-pPO(0))/(1-pPO(0)))&gt;0.00001) 
               stop("error in left trucation of p")
plot(function(x) test4(x, mu=2), from=1, to=10, n=10, type="h")
cdf &lt;- stepfun(1:40, test4(1:41, mu=5), f = 0)
plot(cdf, main="cdf", ylab="cdf(x)", do.points=FALSE )
#----------------------------------------------------------------------------------------
# right
test5&lt;-trun.p(par=c(10), family="NBI", type="right")
test5(2)
pNBI(2)/(pNBI(9))
if(abs(test5(2)-(pNBI(2)/(pNBI(9))))&gt;0.00001) 
          stop("error in right trucation of p")
plot(function(x) test5(x, mu=2), from=0, to=9, n=10, type="h")
cdf &lt;- stepfun(0:8, test5(0:9, mu=5), f = 0)
plot(cdf, main="cdf", ylab="cdf(x)", do.points=FALSE )
#----------------------------------------------------------------------------------------
# both 
test6&lt;-trun.p(par=c(0,10), family="NBI", type="both")
test6(2)
(pNBI(2)-pNBI(0))/(pNBI(9)-pNBI(0))
if(abs(test6(2)-(pNBI(2)-pNBI(0))/(pNBI(9)-pNBI(0)))&gt;0.00001) 
               stop("error in the both trucation")
test6(1, log=TRUE)
log((pNBI(1)-pNBI(0))/(pNBI(9)-pNBI(0)))
if(abs(test6(1, log=TRUE)-log((pNBI(1)-pNBI(0))/(pNBI(9)-pNBI(0))))&gt;0.00001) 
             stop("error in both trucation")
plot(function(y) test6(y, mu=20, sigma=3), from=1, to=9, n=9, type="h") 
plot(function(y) test6(y, mu=300, sigma=.4), from=1, to=9, n=9, type="h")
cdf &lt;- stepfun(1:8, test6(1:9, mu=5), f = 0)
plot(cdf, main="cdf", ylab="cdf(x)", do.points=FALSE )
#----------------------------------------------------------------------------------------
# varying  truncation
#----------------------------------------------------------------------------------------
# coninuous
# left
test6&lt;-trun.p(par=c(0,1,2), family="TF", type="left", varying=TRUE)
test6(c(2,3,4))
(pTF(c(2,3,4))-pTF(c(0,1,2)))/(1-pTF(c(0,1,2)))
test6(c(2,3,4), log.p=TRUE)
#----------------------------------------------------------------------------------------
# right
test7 &lt;- trun.p(par=c(10,11,12), family="BCT", type="right", varying=TRUE)
test7(c(1,2,3))
pBCT(c(1,2,3))/pBCT(c(10,11,12))
test7(c(1,2,3), lower.tail=FALSE)
1-pBCT(c(1,2,3))/pBCT(c(10,11,12))
test7(c(1,2,3), log.p=TRUE)
#--------------------------------------------------------------------------------------- 
# both 
test8&lt;-trun.p(par=cbind(c(0,1,2), c(10,11,12)), family="TF", 
           type="both", varying=TRUE)
test8(c(1,2,3))
(pTF(c(1,2,3))-pTF(c(0,1,2)))/(pTF(c(10,11,12))-pTF(c(0,1,2)))
test8(c(1,2,3), lower.tail=FALSE)
1-(pTF(c(1,2,3))-pTF(c(0,1,2)))/(pTF(c(10,11,12))-pTF(c(0,1,2)))
#--------------------------------------------------------------------------------------
# discrete
#--------------------------------------------------------------------------------------
# left
test9&lt;-trun.p(par=c(0,1,2), family="PO", type="left", varying=TRUE)
test9(c(1,2,3))
(pPO(c(1,2,3))-pPO(c(0,1,2)))/(1-pPO(c(0,1,2)))
#--------------------------------------------------------------------------------------
# right
test10&lt;-trun.p(par=c(10,11,12), family="NBI", type="right", varying=TRUE)
test10(c(2,3,4))
pNBI(c(2,3,4))/(pNBI(c(9,10,11)))
#-------------------------------------------------------------------------------------
# both
test11&lt;-trun.p(par=rbind(c(0,10), c(1,11), c(2, 12)), family="NBI", 
              type="both", varying=TRUE)
test11(c(2,3,4))
(pNBI(c(2,3,4))-pNBI(c(0,1,2)))/(pNBI(c(9,10,11))-pNBI(c(0,1,2)))
#-------------------------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='trun.q'>Truncated Inverse Cumulative Density Function of a gamlss.family Distribution</h2><span id='topic+trun.q'></span>

<h3>Description</h3>

<p>Creates a function to produce the inverse of a truncated cumulative density function generated from a current GAMLSS family distribution.
</p>
<p>For continuous distributions left truncation at  3 means that the random variable can take the value 3.
For discrete distributions left truncation at 3 means that the random variable can take values from 4 onwards.
This is the same for right truncation. Truncation at 15 for a discrete variable means that 
15 and greater values are not allowed but for continuous variable it mean values greater that 15 are not allowed 
(so 15 is a possible value). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trun.q(par, family = "NO", type = c("left", "right", "both"),
        varying = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trun.q_+3A_par">par</code></td>
<td>
<p> a vector with one (for <code>"left"</code> or <code>"right"</code> truncation) or two elements for <code>"both"</code>. When the argument <code>varying = TRUE</code> then <code>par</code> can be a vector or a matrix with two columns respectively.</p>
</td></tr>
<tr><td><code id="trun.q_+3A_family">family</code></td>
<td>
<p> a <code>gamlss.family</code> object, which is used to define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> can be found in <code>gamlss.family</code>.
Functions such as BI() (binomial) produce a family object. </p>
</td></tr>
<tr><td><code id="trun.q_+3A_type">type</code></td>
<td>
<p> whether <code>left</code>, <code>right</code> or in <code>both</code> sides truncation is required, (left is the default)  </p>
</td></tr>
<tr><td><code id="trun.q_+3A_varying">varying</code></td>
<td>
<p>whether the truncation  varies for diferent observations. This can be usefull in regression analysis. If <code>varying = TRUE</code> then <code>par</code> should be an n-length vector for <code>type</code> equal <code>"left"</code> and <code>"right"</code> and an n by 2 matrix for <code>type="both"</code></p>
</td></tr>
<tr><td><code id="trun.q_+3A_...">...</code></td>
<td>
<p>for extra arguments </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a q family function 
</p>


<h3>Author(s)</h3>

<p> Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>)..</p>


<h3>See Also</h3>

  <p><code><a href="#topic+trun.d">trun.d</a></code>, <code><a href="#topic+trun.q">trun.q</a></code>, <code><a href="#topic+trun.r">trun.r</a></code>, <code><a href="#topic+gen.trun">gen.trun</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># trucated q  continuous function
# continuous
#----------------------------------------------------------------------------------------
# left
test1&lt;-trun.q(par=c(0), family="TF", type="left")
test1(.6)
qTF(pTF(0)+0.6*(1-pTF(0)))
#----------------------------------------------------------------------------------------
# right
test2 &lt;- trun.q(par=c(10), family="BCT", type="right")
test2(.6)
qBCT(0.6*pBCT(10))
#----------------------------------------------------------------------------------------
# both
test3&lt;-trun.q(par=c(-3,3), family="TF", type="both")
test3(.6)
qTF(0.6*(pTF(3)-pTF(-3))+pTF(-3))
#----------------------------------------------------------------------------------------
# varying  par
#----------------------------------------------------------------------------------------
# left
test7&lt;-trun.q(par=c(0,1,2), family="TF", type="left", varying=TRUE)
test7(c(.5,.5,.6))
qTF(pTF(c(0,1,2))+c(.5,.5,.6)*(1-pTF(c(0,1,2))))
#---------------------------------------------------------------------------------------
# right
test9 &lt;- trun.q(par=c(10,11,12), family="BCT", type="right", varying=TRUE)
test9(c(.5,.5,.6))
qBCT(c(.5,.5,.6)*pBCT(c(10,11,12)))
#----------------------------------------------------------------------------------------
# both
test10&lt;-trun.q(par=cbind(c(0,1,2), c(10,11,12)), family="TF", type="both", varying=TRUE)
test10(c(.5, .5, .7))
qTF(c(.5, .5, .7)*(pTF(c(10,11,12))-pTF(c(0,1,2)))+pTF(c(0,1,2)))
#----------------------------------------------------------------------------------------
# FOR DISCRETE DISTRIBUTIONS
# trucated q function
# left
test4&lt;-trun.q(par=c(0), family="PO", type="left")
test4(.6)
qPO(pPO(0)+0.6*(1-pPO(0)))
# varying
test41&lt;-trun.q(par=c(0,1,2), family="PO", type="left", varying=TRUE)
test41(c(.6,.4,.5))
qPO(pPO(c(0,1,2))+c(.6,.4,.5)*(1-pPO(c(0,1,2))))
#----------------------------------------------------------------------------------------
# right
test5 &lt;- trun.q(par=c(10), family="NBI", type="right")
test5(.6)
qNBI(0.6*pNBI(10))
test5(.6, mu=10, sigma=2)
qNBI(0.6*pNBI(10, mu=10, sigma=2), mu=10, sigma=2)
# varying
test51 &lt;- trun.q(par=c(10, 11, 12), family="NBI", type="right", varying=TRUE)
test51(c(.6,.4,.5))
qNBI(c(.6,.4,.5)*pNBI(c(10, 11, 12)))
test51(c(.6,.4,.5), mu=10, sigma=2)
qNBI(c(.6,.4,.5)*pNBI(c(10, 11, 12), mu=10, sigma=2), mu=10, sigma=2)
#----------------------------------------------------------------------------------------
# both
test6&lt;-trun.q(par=c(0,10), family="NBI", type="both")
test6(.6)
qNBI(0.6*(pNBI(10)-pNBI(0))+pNBI(0))
# varying 
test61&lt;-trun.q(par=cbind(c(0,1,2), c(10,11,12)), family="NBI", type="both", varying=TRUE)
test61(c(.6,.4,.5))
qNBI(c(.6,.4,.5)*(pNBI(c(10,11,12))-pNBI(c(0,1,2)))+pNBI(c(0,1,2)))
#----------------------------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='trun.r'>Generates Random Values from a Truncated Density Function of a gamlss.family Distribution</h2><span id='topic+trun.r'></span>

<h3>Description</h3>

<p>Creates a function to generate randon values from a truncated probability density function created from a current GAMLSS family distribution
</p>
<p>For continuous distributions left truncation at  3 means that the random variable can take the value 3.
For discrete distributions left truncation at 3 means that the random variable can take values from 4 onwards.
This is the same for right truncation. Truncation at 15 for a discrete variable means that 
15 and greater values are not allowed but for continuous variable it mean values greater that 15 are not allowed 
(so 15 is a possible value). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trun.r(par, family = "NO", type = c("left", "right", "both"), 
          varying = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trun.r_+3A_par">par</code></td>
<td>
<p> a vector with one (for <code>"left"</code> or <code>"right"</code> truncation) or two elements for <code>"both"</code>. When the argument <code>varying = TRUE</code> then <code>par</code> can be a vector or a matrix with two columns respectively.</p>
</td></tr>
<tr><td><code id="trun.r_+3A_family">family</code></td>
<td>
<p> a <code>gamlss.family</code> object, which is used to define the distribution and the link functions of the various parameters. 
The distribution families supported by <code>gamlss()</code> can be found in <code>gamlss.family</code>.
Functions such as BI() (binomial) produce a family object. </p>
</td></tr>
<tr><td><code id="trun.r_+3A_type">type</code></td>
<td>
<p> whether <code>left</code>, <code>right</code> or in <code>both</code> sides truncation is required, (left is the default)  </p>
</td></tr>
<tr><td><code id="trun.r_+3A_varying">varying</code></td>
<td>
<p>whether the truncation  varies for diferent observations. This can be usefull in regression analysis. If <code>varying = TRUE</code> then <code>par</code> should be an n-length vector for <code>type</code> equal <code>"left"</code> and <code>"right"</code> and an n by 2 matrix for <code>type="both"</code></p>
</td></tr>
<tr><td><code id="trun.r_+3A_...">...</code></td>
<td>
<p>for extra arguments </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a r family function  
</p>


<h3>Author(s)</h3>

<p> Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

<p> Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>). </p>


<h3>See Also</h3>

 <p><code><a href="#topic+trun.p">trun.p</a></code>, <code><a href="#topic+trun.q">trun.q</a></code>, <code><a href="#topic+trun.d">trun.d</a></code>, <code><a href="#topic+gen.trun">gen.trun</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># trucated r function
# continuous
#----------------------------------------------------------------------------------------
# left
test1&lt;-trun.r(par=c(0), family="TF", type="left")
rr&lt;-test1(1000)
hist(rr)
#----------------------------------------------------------------------------------------
# right
test2 &lt;- trun.r(par=c(10), family="BCT", type="right")
rr&lt;-test2(1000)
hist(rr)
#----------------------------------------------------------------------------------------
# both
test3&lt;-trun.r(par=c(-3,3), family="TF", type="both")
rr&lt;-test3(1000)
hist(rr)
#----------------------------------------------------------------------------------------
# discrete 
# trucated r function
# left
test4&lt;-trun.r(par=c(0), family="PO", type="left")
tN &lt;- table(Ni &lt;- test4(1000))
r &lt;- barplot(tN, col='lightblue')
#----------------------------------------------------------------------------------------
# right
test5 &lt;- trun.r(par=c(10), family="NBI", type="right")
tN &lt;- table(Ni &lt;- test5(1000))
r &lt;- barplot(tN, col='lightblue')
tN &lt;- table(Ni &lt;- test5(1000,mu=5))
r &lt;- barplot(tN, col='lightblue')
tN &lt;- table(Ni &lt;- test5(1000,mu=10, sigma=.1))
r &lt;- barplot(tN, col='lightblue')
#----------------------------------------------------------------------------------------
# both 
test6&lt;-trun.r(par=c(0,10), family="NBI", type="both")
tN &lt;- table(Ni &lt;- test6(1000,mu=5))
r &lt;- barplot(tN, col='lightblue')
#----------------------------------------------------------------------------------------
# varying = TRUE
#----------------------------------------------------------------------------------------
# continuous
#----------------------------------------------------------------------------------------
# left
test7&lt;-trun.r(par=c(0,1,2), family="TF", type="left", varying=TRUE)
test7(3)

#----------------------------------------------------------------------------------------
# right
test8 &lt;- trun.r(par=c(10,11,12), family="BCT", type="right", varying=TRUE)
test8(3)
#----------------------------------------------------------------------------------------
# both
test9&lt;-trun.r(par=rbind(c(-3,3), c(-1,5), c(0,6)), , family="TF", type="both", varying=TRUE)
test9(3)
#----------------------------------------------------------------------------------------
# discrete 
# trucated r function
# left
test10&lt;-trun.r(par=c(0,1,2), family="PO", type="left", varying=TRUE)
test10(3)
#----------------------------------------------------------------------------------------
# right
test11 &lt;- trun.r(par=c(10,11,12), family="NBI", type="right", varying=TRUE)
test11(3)
test11(3, mu=10, sigma=.1)
#----------------------------------------------------------------------------------------
# both 
test12&lt;-trun.r(par=rbind(c(0,10), c(1,11), c(2,12)), family="NBI", type="both", varying=TRUE)
test12(3,mu=5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
