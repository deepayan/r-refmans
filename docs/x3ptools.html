<!DOCTYPE html><html lang="en"><head><title>Help for package x3ptools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {x3ptools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#calculate_spacing'><p>Calculate grid spacing</p></a></li>
<li><a href='#df_to_x3p'><p>Convert  a data frame into an x3p file</p></a></li>
<li><a href='#head.x3p'><p>Show meta information of an x3p file</p></a></li>
<li><a href='#image.x3p'><p>Raster image of an x3p surface</p></a></li>
<li><a href='#lea'><p>Subsampled scan of a land-engraved area</p></a></li>
<li><a href='#print.x3p'><p>Show meta information of an x3p file</p></a></li>
<li><a href='#stl_to_x3p'><p>Convert an STL file to an x3p file</p></a></li>
<li><a href='#tmd_to_x3p'><p>Read (or convert) from TMD file to x3p</p></a></li>
<li><a href='#wire'><p>Subsampled wire cut scan</p></a></li>
<li><a href='#x3p_add_annotation'><p>Add annotations to an x3p object</p></a></li>
<li><a href='#x3p_add_grid'><p>Add a grid of helper lines to the mask of an x3p object</p></a></li>
<li><a href='#x3p_add_hline'><p>Add horizontal line to the mask of an x3p object</p></a></li>
<li><a href='#x3p_add_legend'><p>Display legend in active rgl object</p></a></li>
<li><a href='#x3p_add_mask'><p>Add/Exchange a mask for an x3p object</p></a></li>
<li><a href='#x3p_add_mask_layer'><p>Add a layer to the mask</p></a></li>
<li><a href='#x3p_add_meta'><p>Add/change xml meta information in x3p object</p></a></li>
<li><a href='#x3p_add_vline'><p>Add vertical line to the mask of an x3p object</p></a></li>
<li><a href='#x3p_average'><p>Average an x3p object</p></a></li>
<li><a href='#x3p_bin_stripes'><p>Add colored stripes of the surface gradient to the mask of an x3p object</p></a></li>
<li><a href='#x3p_circle_select'><p>Select a circle area on the surface of an x3p file using rgl</p></a></li>
<li><a href='#x3p_crop'><p>Crop an x3p object to a specified width and height</p></a></li>
<li><a href='#x3p_darker'><p>Darken active rgl object</p></a></li>
<li><a href='#x3p_delete_mask'><p>Delete mask from an x3p object</p></a></li>
<li><a href='#x3p_extract'><p>Extract values from a surface matrix based on a mask</p></a></li>
<li><a href='#x3p_extract_profile'><p>Interactively select a line on the active rgl device</p></a></li>
<li><a href='#x3p_extract_profile_segments'><p>Extract profiles from surface using multiple segments</p></a></li>
<li><a href='#x3p_flip_x'><p>Flip the x coordinate of an x3p file</p></a></li>
<li><a href='#x3p_flip_y'><p>Flip the y coordinate of an x3p image</p></a></li>
<li><a href='#x3p_fuzzyselect'><p>Interactive selection of region of interest</p></a></li>
<li><a href='#x3p_get_scale'><p>Check resolution of a scan</p></a></li>
<li><a href='#x3p_image'><p>Plot x3p object as an image</p></a></li>
<li><a href='#x3p_interpolate'><p>Interpolate from an x3p object</p></a></li>
<li><a href='#x3p_lighter'><p>Lighten active rgl object</p></a></li>
<li><a href='#x3p_m_to_mum'><p>Convert x3p header information to microns from meters</p></a></li>
<li><a href='#x3p_mask_legend'><p>Get legend for mask colors</p></a></li>
<li><a href='#x3p_mask_quantile'><p>Draw a quantile region on the mask</p></a></li>
<li><a href='#x3p_modify_xml'><p>Modify xml elements meta information in x3p object</p></a></li>
<li><a href='#x3p_read'><p>Read an x3p file into an x3p object</p></a></li>
<li><a href='#x3p_read_dat'><p>Read data from an x-y-z file</p></a></li>
<li><a href='#x3p_read_plux'><p>Read information from plux file</p></a></li>
<li><a href='#x3p_rotate'><p>Rotate an x3p object</p></a></li>
<li><a href='#x3p_sample'><p>Sample from an x3p object</p></a></li>
<li><a href='#x3p_scale_unit'><p>Scale x3p object by given unit</p></a></li>
<li><a href='#x3p_select'><p>Draw rectangle on the mask of an x3p file using rgl</p></a></li>
<li><a href='#x3p_shade_mask'><p>Shade the mask of an x3p object to reflect its surface profile</p></a></li>
<li><a href='#x3p_show_xml'><p>Show xml elements from meta information in x3p object</p></a></li>
<li><a href='#x3p_snapshot'><p>Take a snapshot of the active rgl device and save in a file</p></a></li>
<li><a href='#x3p_to_df'><p>Convert an x3p file into a data frame</p></a></li>
<li><a href='#x3p_transpose'><p>Transpose an x3p object</p></a></li>
<li><a href='#x3p_trim_na'><p>Trim rows and columns with missing values only from an x3p</p></a></li>
<li><a href='#x3p_write'><p>Write an x3p object to a file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Working with 3D Surface Measurements</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Heike Hofmann &lt;hofmann@iastate.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The x3p file format  is specified in ISO standard 5436:2000 to 
    describe 3d surface measurements. 'x3ptools' allows reading, writing and 
    basic modifications to the 3D surface measurements.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS (&ge; 7.3), digest (&ge; 0.6), xml2 (&ge; 1.3.5), rgl (&ge;
1.2.0), zoo (&ge; 1.8), png (&ge; 0.1-7), readr (&ge; 2.1.0), dplyr
(&ge; 1.1.0), pracma (&ge; 2.4.0), assertthat (&ge; 0.2.1), purrr (&ge;
1.0.0), yaml (&ge; 2.3.7), scales (&ge; 1.2.1), tidyr (&ge; 1.3.0),
imager (&ge; 0.45.2), magrittr (&ge; 2.0.3), grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, patchwork, testthat (&ge; 3.0.4), covr, here,
magick (&ge; 2.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/heike/x3ptools">https://github.com/heike/x3ptools</a>,
<a href="https://heike.github.io/x3ptools/">https://heike.github.io/x3ptools/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/heike/x3ptools/issues">https://github.com/heike/x3ptools/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-30 08:53:44 UTC; hofmann</td>
</tr>
<tr>
<td>Author:</td>
<td>Heike Hofmann <a href="https://orcid.org/0000-0001-6216-5183"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Susan Vanderplas <a href="https://orcid.org/0000-0002-3803-0972"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Ganesh Krishnan [aut],
  Eric Hare <a href="https://orcid.org/0000-0002-4277-3146"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-30 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='calculate_spacing'>Calculate grid spacing</h2><span id='topic+calculate_spacing'></span>

<h3>Description</h3>

<p>Helper function, not exported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_spacing(x3p, spaces, axis = "y")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_spacing_+3A_x3p">x3p</code></td>
<td>
<p>x3p file</p>
</td></tr>
<tr><td><code id="calculate_spacing_+3A_spaces">spaces</code></td>
<td>
<p>space between grid lines</p>
</td></tr>
<tr><td><code id="calculate_spacing_+3A_axis">axis</code></td>
<td>
<p>axis to calculate, as character</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of line locations
</p>

<hr>
<h2 id='df_to_x3p'>Convert  a data frame into an x3p file</h2><span id='topic+df_to_x3p'></span>

<h3>Description</h3>

<p>Convert  a data frame into an x3p file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_to_x3p(dframe, var = "value")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_to_x3p_+3A_dframe">dframe</code></td>
<td>
<p>data frame. <code>dframe</code> must have the columns x, y, and value.</p>
</td></tr>
<tr><td><code id="df_to_x3p_+3A_var">var</code></td>
<td>
<p>name of the variable containing the surface measurements. Defaults to &quot;value&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object
</p>

<hr>
<h2 id='head.x3p'>Show meta information of an x3p file</h2><span id='topic+head.x3p'></span>

<h3>Description</h3>

<p><code>head.x3p</code> expands the generic head method for x3p objects. It gives a summary of the most relevant 3p meta information and returns the object invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'x3p'
head(x, n = 6L, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="head.x3p_+3A_x">x</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="head.x3p_+3A_n">n</code></td>
<td>
<p>number of rows/columns of the matrix</p>
</td></tr>
<tr><td><code id="head.x3p_+3A_...">...</code></td>
<td>
<p>extra parameters passed to head.matrix()</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
head(logo)
</code></pre>

<hr>
<h2 id='image.x3p'>Raster image of an x3p surface</h2><span id='topic+image.x3p'></span>

<h3>Description</h3>

<p><code>image.x3p</code> expands the generic image method for x3p objects.
This image function creates a raster image to show the surface of an x3p file.
Due to some inconsistency in the mapping of the origin (0,0), (choice between top left or bottom left)  image functions from different packages will result in different images.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'x3p'
image(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="image.x3p_+3A_x">x</code></td>
<td>
<p>an x3p object</p>
</td></tr>
<tr><td><code id="image.x3p_+3A_...">...</code></td>
<td>
<p>parameters passed into image</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
image(logo)
</code></pre>

<hr>
<h2 id='lea'>Subsampled scan of a land-engraved area</h2><span id='topic+lea'></span>

<h3>Description</h3>

<p>LEAs (land-engraved areas) are created on the outside of a bullet during
the firing process. Depending on the rifling inside the barrel, multiple lands
exist for each barrel. Striation marks in these land engraved areas are used
in forensic labs to determine whether two bullets were fired from the same firearm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lea
</code></pre>


<h3>Format</h3>

<p><code>x3p</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lea)
image(lea)
if (interactive()) x3p_image(lea)
</code></pre>

<hr>
<h2 id='print.x3p'>Show meta information of an x3p file</h2><span id='topic+print.x3p'></span>

<h3>Description</h3>

<p><code>print.x3p</code> expands the generic print method for x3p objects. It gives a summary of the most relevant x3p meta information and returns the object invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'x3p'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.x3p_+3A_x">x</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="print.x3p_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
print(logo)
</code></pre>

<hr>
<h2 id='stl_to_x3p'>Convert an STL file to an x3p file</h2><span id='topic+stl_to_x3p'></span>

<h3>Description</h3>

<p>STL (STereo Lithographic) files describe 3d objects as mesh objects. Here, we assume that the 3d object consists of a 3d surface on the top of a rectangular, equi-spaced 2d grid.
We further assume, that each node of the STL file describes the x-y location of an actual measurement. These measurements are then converted into the surface matrix of an x3p object.
The resolution is derived from the distance between consecutive x and y nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stl_to_x3p(stl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stl_to_x3p_+3A_stl">stl</code></td>
<td>
<p>STL file object or path to the file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# the website https://touchterrain.geol.iastate.edu/ allows a download
# of a 3d printable terrain model. For an example we suggest to download a file from there.
gc &lt;- rgl::readSTL("&lt;PATH TO STL FILE&gt;", plot=FALSE)
x3p &lt;- stl_to_x3p(gc)

## End(Not run)
</code></pre>

<hr>
<h2 id='tmd_to_x3p'>Read (or convert) from TMD file to x3p</h2><span id='topic+tmd_to_x3p'></span>

<h3>Description</h3>

<p>TMD files are used in telemetry, specifically, they are a native format used
by GelSight to store 3d topographic surface scans.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tmd_to_x3p(tmd_path, yaml_path = NA, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tmd_to_x3p_+3A_tmd_path">tmd_path</code></td>
<td>
<p>path to TMD file</p>
</td></tr>
<tr><td><code id="tmd_to_x3p_+3A_yaml_path">yaml_path</code></td>
<td>
<p>path to corresponding yaml file with meta information.
If set to <code>NA</code> (default), path of the the tmd file will be tried. If set to NULL,
meta file will be ignored.</p>
</td></tr>
<tr><td><code id="tmd_to_x3p_+3A_verbose">verbose</code></td>
<td>
<p>boolean</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is based on GelSight's MatLab routine <code>readtmd.m</code> published as
part of the Github repository
<a href="https://github.com/gelsightinc/gsmatlab"><code>gelsightinc/gsmatlab</code></a>
</p>


<h3>Value</h3>

<p>x3p file of the scan. Some rudimentary information will be filled in,
information of scanning process, and parameter settings need to be added manually.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#x3p &lt;- tmd_to_x3p("~/Downloads/Sc04.Pl044.Ma4.SB.An80.Pb.DirFo.SizL.tmd") # 
#x3p &lt;- tmd_to_x3p("~/Downloads/Sc04.Pl044.Ma4.SB.An80.Pb.DirFo.SizL.tmd", 
#                   yaml_path="~/Downloads/scan.yaml") # 
</code></pre>

<hr>
<h2 id='wire'>Subsampled wire cut scan</h2><span id='topic+wire'></span>

<h3>Description</h3>

<p>An example part of a wire cut in <code>x3p</code> format. The wire cut is part of a CSAFE study
involving 1.5 mm Aluminium wires cut by Kaiweet wire-cutters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wire
</code></pre>


<h3>Format</h3>

<p><code>x3p</code> object
</p>

<hr>
<h2 id='x3p_add_annotation'>Add annotations to an x3p object</h2><span id='topic+x3p_add_annotation'></span>

<h3>Description</h3>

<p>Annotations in an x3p object are  legend entries for each color of a mask.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_add_annotation(x3p, color, annotation)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_add_annotation_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_add_annotation_+3A_color">color</code></td>
<td>
<p>name or hex value of color</p>
</td></tr>
<tr><td><code id="x3p_add_annotation_+3A_annotation">annotation</code></td>
<td>
<p>character value describing the region</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with the added annotations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
color_logo &lt;- png::readPNG(system.file("csafe-color.png", package="x3ptools"))
logoplus &lt;- x3p_add_mask(logo, as.raster(color_logo))
x3p_image(logoplus, multiply=50, size = c(741, 419),zoom = 0.5)
logoplus &lt;- x3p_add_annotation(logoplus, "#FFFFFFFF", "background")
logoplus &lt;- x3p_add_annotation(logoplus, "#818285FF", "text")
logoplus &lt;- x3p_add_annotation(logoplus, "#F6BD47FF", "fingerprint")
logoplus &lt;- x3p_add_annotation(logoplus, "#D2202FFF", "fingerprint")
logoplus &lt;- x3p_add_annotation(logoplus, "#92278FFF", "fingerprint")

x3p_add_legend(logoplus)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_add_grid'>Add a grid of helper lines to the mask of an x3p object</h2><span id='topic+x3p_add_grid'></span>

<h3>Description</h3>

<p>Add a grid of lines to overlay the surface of an x3p object.
Lines are added to a mask. In case no mask exists, one is created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_add_grid(
  x3p,
  spaces,
  size = c(1, 3, 5),
  color = c("grey50", "black", "darkred")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_add_grid_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_add_grid_+3A_spaces">spaces</code></td>
<td>
<p>space between grid lines, doubled for x</p>
</td></tr>
<tr><td><code id="x3p_add_grid_+3A_size">size</code></td>
<td>
<p>width (in pixels) of the lines</p>
</td></tr>
<tr><td><code id="x3p_add_grid_+3A_color">color</code></td>
<td>
<p>(vector of) character values to describe color of lines</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with added vertical lines in the mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
logo &lt;- x3p_read(system.file("csafe-logo.x3p", package = "x3ptools"))
# ten vertical lines across:
logoplus &lt;- x3p_add_grid(logo,
  spaces = 50e-6, size = c(1, 3, 5),
  color = c("grey50", "black", "darkred")
)
x3p_image(logoplus, size = c(741, 419), zoom = 0.5)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_add_hline'>Add horizontal line to the mask of an x3p object</h2><span id='topic+x3p_add_hline'></span>

<h3>Description</h3>

<p>Add horizontal lines to overlay the surface of an x3p object. Lines are added to a mask. In case no mask exists, one is created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_add_hline(x3p, yintercept, size = 5, color = "#e6bf98")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_add_hline_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_add_hline_+3A_yintercept">yintercept</code></td>
<td>
<p>(vector of) numerical values for the position of the lines.</p>
</td></tr>
<tr><td><code id="x3p_add_hline_+3A_size">size</code></td>
<td>
<p>width (in pixels) of the line</p>
</td></tr>
<tr><td><code id="x3p_add_hline_+3A_color">color</code></td>
<td>
<p>(vector of) character values to describe color of lines</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with added vertical lines in the mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
logo &lt;- x3p_read(system.file("csafe-logo.x3p", package = "x3ptools"))
color_logo &lt;- magick::image_read(system.file("csafe-color.png", package = "x3ptools"))
logoplus &lt;- x3p_add_mask(logo, as.raster(color_logo))
# five horizontal lines at equal intervals:
logoplus &lt;- x3p_add_hline(logo, seq(0, 418 * 6.4500e-7, length = 5), size = 3)
x3p_image(logoplus, size = c(741, 419), zoom = 0.5)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_add_legend'>Display legend in active rgl object</h2><span id='topic+x3p_add_legend'></span>

<h3>Description</h3>

<p>Display the legend for colors and annotations in the active rgl window. In case no rgl window is opened, a new window displaying the x3p file (using default sizes and zoom) opens.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_add_legend(x3p, colors = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_add_legend_+3A_x3p">x3p</code></td>
<td>
<p>x3p object with a mask</p>
</td></tr>
<tr><td><code id="x3p_add_legend_+3A_colors">colors</code></td>
<td>
<p>named character vector of colors (in hex format by default), names contain annotations</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x3p &lt;- x3p_read(system.file("sample-land.x3p", package="x3ptools"))
## Not run: 
# run when rgl can open window on the device
x3p_image(x3p) 
x3p_add_legend(x3p) # add legend

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_add_mask'>Add/Exchange a mask for an x3p object</h2><span id='topic+x3p_add_mask'></span>

<h3>Description</h3>

<p>Create a mask for an x3p object in case it does not have a mask yet.
Masks are used for overlaying colors on the bullets surface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_add_mask(x3p, mask = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_add_mask_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_add_mask_+3A_mask">mask</code></td>
<td>
<p>raster matrix of colors with the same dimensions as the x3p surface. If NULL, an object of the right size will be created.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with added/changed mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x3p &lt;- x3p_read(system.file("sample-land.x3p", package="x3ptools"))
# x3p file has mask consisting color raster image:
x3p$mask[1:5,1:5]
## Not run: 
logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
color_logo &lt;- png::readPNG(system.file("csafe-color.png", package="x3ptools"))
logoplus &lt;- x3p_add_mask(logo, as.raster(color_logo))
x3p_image(logoplus, multiply=50, size = c(741, 419),zoom = 0.5)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_add_mask_layer'>Add a layer to the mask</h2><span id='topic+x3p_add_mask_layer'></span>

<h3>Description</h3>

<p>Add a region  a mask.  The region is specfied as TRUE values in a matrix of the same dimensions as the existing mask. In case no mask exists, one is created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_add_mask_layer(x3p, mask, color = "red", annotation = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_add_mask_layer_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_add_mask_layer_+3A_mask">mask</code></td>
<td>
<p>logical matrix of the same dimension as the surface matrix. Values of TRUE are assumed to be added in the mask, values of FALSE are being ignored.</p>
</td></tr>
<tr><td><code id="x3p_add_mask_layer_+3A_color">color</code></td>
<td>
<p>name or hex value of color</p>
</td></tr>
<tr><td><code id="x3p_add_mask_layer_+3A_annotation">annotation</code></td>
<td>
<p>character value describing the region</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with changed mask
</p>

<hr>
<h2 id='x3p_add_meta'>Add/change xml meta information in x3p object</h2><span id='topic+x3p_add_meta'></span><span id='topic+addtemplate_x3p'></span>

<h3>Description</h3>

<p>Use a specified template to overwrite the general info in the x3p object (and structure of the feature info, if needed).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_add_meta(x3p, template = NULL)

addtemplate_x3p(x3p, template = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_add_meta_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_add_meta_+3A_template">template</code></td>
<td>
<p>file path to xml template, use NULL for in-built package template</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
# exchange meta information for general x3p information:
logo &lt;- x3p_add_meta(logo, template = system.file("templateXML.xml", package="x3ptools"))
logo$general.info
</code></pre>

<hr>
<h2 id='x3p_add_vline'>Add vertical line to the mask of an x3p object</h2><span id='topic+x3p_add_vline'></span>

<h3>Description</h3>

<p>Add vertical lines to overlay the surface of an x3p object. Lines are added to a mask. In case no mask exists, one is created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_add_vline(x3p, xintercept, size = 5, color = "#e6bf98")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_add_vline_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_add_vline_+3A_xintercept">xintercept</code></td>
<td>
<p>(vector of) numerical values for the position of the lines.</p>
</td></tr>
<tr><td><code id="x3p_add_vline_+3A_size">size</code></td>
<td>
<p>width (in pixels) of the line</p>
</td></tr>
<tr><td><code id="x3p_add_vline_+3A_color">color</code></td>
<td>
<p>(vector of) character values to describe color of lines</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with added vertical lines in the mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
logo &lt;- x3p_read(system.file("csafe-logo.x3p", package = "x3ptools"))
logo_color &lt;- magick::image_read(system.file("csafe-color.png", package = "x3ptools"))
logoplus &lt;- x3p_add_mask(logo, as.raster(logo_color))
# ten vertical lines across:
logoplus &lt;- x3p_add_vline(logo, seq(0, 740 * 6.4500e-7, length = 5), size = 3)
x3p_image(logoplus, size = c(741, 419), zoom = 0.5)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_average'>Average an x3p object</h2><span id='topic+x3p_average'></span>

<h3>Description</h3>

<p>Calculate blockwise summary statistics on the surface matrix of an x3p.
If the x3p object has a mask, the mode of the mask value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_average(x3p, b = 10, f = mean, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_average_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_average_+3A_b">b</code></td>
<td>
<p>positive integer value, block size</p>
</td></tr>
<tr><td><code id="x3p_average_+3A_f">f</code></td>
<td>
<p>function aggregate function</p>
</td></tr>
<tr><td><code id="x3p_average_+3A_...">...</code></td>
<td>
<p>parameters passed on to function f. Make sure to use na.rm = T as needed.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
small &lt;- x3p_average(logo)
</code></pre>

<hr>
<h2 id='x3p_bin_stripes'>Add colored stripes of the surface gradient to the mask of an x3p object</h2><span id='topic+x3p_bin_stripes'></span>

<h3>Description</h3>

<p>Apply gradient-based color shading to the mask of a 3d topographic surface.
Gradients are determined empirically based on sequentical row- (or column-)wise
differences of surface values.
The <code>direction</code> parameter determines the direction of differencing.
If direction is &quot;vertical&quot;, columns in the surface matrix are
differenced to identify whether 'vertical' stripes exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_bin_stripes(
  x3p,
  direction = "vertical",
  colors = rev(c("#b12819", "#d7301f", "#e16457", "#ffffff", "#5186a2", "#175d82",
    "#134D6B")),
  freqs = c(0, 0.05, 0.1, 0.3, 0.7, 0.9, 0.95, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_bin_stripes_+3A_x3p">x3p</code></td>
<td>
<p>object containing a 3d topographic surface</p>
</td></tr>
<tr><td><code id="x3p_bin_stripes_+3A_direction">direction</code></td>
<td>
<p>in which the stripes are created: <code>vertical</code> or <code>horizontal</code>.</p>
</td></tr>
<tr><td><code id="x3p_bin_stripes_+3A_colors">colors</code></td>
<td>
<p>vector of colors</p>
</td></tr>
<tr><td><code id="x3p_bin_stripes_+3A_freqs">freqs</code></td>
<td>
<p>vector of values corresponding to color frequency (turned into quantiles of the differenced values)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with mask colored by discretized surface gradient
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wire)
x3p &lt;- wire
if (interactive()) x3p_image(x3p, size = c(400, 400), zoom=0.8)
x3p_with &lt;- x3p_bin_stripes(x3p, direction="vertical")
x3p_with &lt;- x3p_bin_stripes(x3p, direction="vertical", 
colors=c("#b12819","#ffffff","#134D6B"), freqs=c(0, 0.3, 0.7, 1))
if (interactive()) x3p_image(x3p_with, size = c(400, 400), zoom=0.8)

data(lea)
if (interactive()) {
  lea %&gt;% x3p_bin_stripes() %&gt;% x3p_image() # default stripes
 
# three colors only   
  lea %&gt;% x3p_bin_stripes(
     colors=c("#b12819","#ffffff","#134D6B"), 
     freqs=c(0, 0.3, 0.7, 1)) %&gt;%  x3p_image()
}
</code></pre>

<hr>
<h2 id='x3p_circle_select'>Select a circle area on the surface of an x3p file using rgl</h2><span id='topic+x3p_circle_select'></span>

<h3>Description</h3>

<p>In the active rgl window select a circle on the scan's surface by clicking on three points along the circumference.
Make sure that x3p file and the rgl window match. If no rgl window is active, an rgl window opens with the scan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_circle_select(x3p, col = "#FF0000", update = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_circle_select_+3A_x3p">x3p</code></td>
<td>
<p>x3p file</p>
</td></tr>
<tr><td><code id="x3p_circle_select_+3A_col">col</code></td>
<td>
<p>character value of the selection color</p>
</td></tr>
<tr><td><code id="x3p_circle_select_+3A_update">update</code></td>
<td>
<p>boolean value, whether the rgl window should be updated to show the selected circle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p file with selected circle in mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if (interactive) {
  if (!file.exists("fadul1-1.x3p")) {
    url &lt;- "https://tsapps.nist.gov/NRBTD/Studies/CartridgeMeasurement/DownloadMeasurement"
    file &lt;- "2d9cc51f-6f66-40a0-973a-a9292dbee36d"
    download.file(file.path(url, file), destfile="fadul1-1.x3p")
  }
  x3p &lt;- x3p_read("fadul1-1.x3p")
  x3p_image(x3p, size=c(500,500), zoom=.8)
  x3p &lt;- x3p_circle_select(x3p, update=TRUE, col="#FF0000") 

  logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
  x3p_image(logo, size=c(500,500), zoom = 1)
  x3p_circle_select(logo, update=TRUE, col="#00FF00") 
}
## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_crop'>Crop an x3p object to a specified width and height</h2><span id='topic+x3p_crop'></span>

<h3>Description</h3>

<p>Cuts out a rectangle of size width x height from the location (x, y) of an x3p object.
x and y specify the bottom right corner of the rectangle.
In case the dimensions of the surface matrix do not allow for the full dimensions of the rectangle cutout the dimensions are adjusted accordingly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_crop(x3p, x = 1, y = 1, width = 128, height = 128)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_crop_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_crop_+3A_x">x</code></td>
<td>
<p>integer, location (in pixels) of the leftmost side of the rectangle,</p>
</td></tr>
<tr><td><code id="x3p_crop_+3A_y">y</code></td>
<td>
<p>integer, location (in pixels) of the leftmost side of the rectangle,</p>
</td></tr>
<tr><td><code id="x3p_crop_+3A_width">width</code></td>
<td>
<p>integer, width (in pixels) of the rectangle,</p>
</td></tr>
<tr><td><code id="x3p_crop_+3A_height">height</code></td>
<td>
<p>integer, height (in pixels) of the rectangle,</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
# crop the x3p file to just the CSAFE logo
logo_only &lt;- x3p_crop(logo, x=20, y=50, width = 255 ,height =310)
logo_only &lt;- x3p_crop(logo, x=20, y=50, width = 255 ,height =510)
# x3p_image(logo_only, size=c(500,500), zoom = 1)
</code></pre>

<hr>
<h2 id='x3p_darker'>Darken active rgl object</h2><span id='topic+x3p_darker'></span>

<h3>Description</h3>

<p>Makes the currently active rgl object darker by removing a light source. Once all light sources are removed the object can not be any darker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_darker()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>x3p &lt;- x3p_read(system.file("sample-land.x3p", package="x3ptools"))
## Not run: 
x3p_image(x3p) # run when rgl can open window on the device
x3p_darker() # remove a light source

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_delete_mask'>Delete mask from an x3p object</h2><span id='topic+x3p_delete_mask'></span>

<h3>Description</h3>

<p>Deletes mask and its annotations from an x3p file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_delete_mask(x3p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_delete_mask_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object without the mask
</p>

<hr>
<h2 id='x3p_extract'>Extract values from a surface matrix based on a mask</h2><span id='topic+x3p_extract'></span>

<h3>Description</h3>

<p>If a mask is present, a subset of the surface matrix is extracted based on specified value(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_extract(x3p, mask_vals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_extract_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_extract_+3A_mask_vals">mask_vals</code></td>
<td>
<p>vector of mask value(s)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
# add a mask
logo &lt;- x3p_add_mask(logo)
mask &lt;- t(logo$surface.matrix==median(logo$surface.matrix))
logo &lt;- x3p_add_mask_layer(logo, mask, color = "red", annotation = "median") 
x3p_extract(logo, "#cd7f32") 
# x3p_image(logo, size=c(500,500), zoom = 1)
</code></pre>

<hr>
<h2 id='x3p_extract_profile'>Interactively select a line on the active rgl device</h2><span id='topic+x3p_extract_profile'></span>

<h3>Description</h3>

<p>In the active rgl device select a line on the 3d surface by clicking on start and end-point (order matters). These points define the beginning and end  of a line segment.
The line segment is drawn on the mask of the x3p object.
The line object is returned as part of the x3p object, if <code>line_result</code> is set to <code>TRUE</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_extract_profile(
  x3p,
  col = "#FF0000",
  update = TRUE,
  line_result = "equi-spaced",
  multiply = 5,
  linewidth = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_extract_profile_+3A_x3p">x3p</code></td>
<td>
<p>x3p file</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_+3A_col">col</code></td>
<td>
<p>character value of the selection color</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_+3A_update">update</code></td>
<td>
<p>boolean value, whether the rgl window should be updated to show the selected circle</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_+3A_line_result">line_result</code></td>
<td>
<p>enhance result by a data frame of the line: NULL for no, &quot;raw&quot; for data frame of original x and y (in the mask) and
projected x onto the line, &quot;equi-spaced&quot; (default) returns a data frame with equispaced x values after fitting a loess smooth to the raw values.
Note that variable x indicates the direction from first click (x=0) to
the second click (max x).</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_+3A_multiply">multiply</code></td>
<td>
<p>integer value, factor to multiply surface values.  Only applied if update is true. Defaults to 5,</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_+3A_linewidth">linewidth</code></td>
<td>
<p>line width of the extracted line. Defaults to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p file with identified line in the mask. Depending on the setting of <code>line_result</code>
additional information on the line is attached as a data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if (interactive) {
  x3p &lt;- x3p_read(system.file("sample-land.x3p", package="x3ptools"))
  x3p %&gt;% image_x3p(size=dim(x3p$surface.matrix), multiply=1, zoom=.3)
  x3p &lt;- x3p_extract_profile(x3p, update=TRUE, col="#FFFFFF") 
  x3p$line_df %&gt;% 
    ggplot(aes(x = x, y = value)) + geom_line() 
 
 x3p$line_df$y &lt;- 1      
 sigs &lt;- bulletxtrctr::cc_get_signature(ccdata = x3p$line_df, 
   grooves = list(groove=range(x3p$line_df$x)), span1 = 0.75, span2 = 0.03)
 sigs %&gt;% 
   ggplot(aes(x = x)) + 
     geom_line(aes(y = raw_sig), colour = "grey50") +
     geom_line(aes(y = sig), size = 1) +
     theme_bw() 
}
## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_extract_profile_segments'>Extract profiles from surface using multiple segments</h2><span id='topic+x3p_extract_profile_segments'></span>

<h3>Description</h3>

<p>The 3d topographic surface is split into multiple segments of width <code>width</code> (in pixels)
using an overlap of 10% between segments. For each segment, a line is extracted (with <code>x3p_extract_profile</code>).
Line segments are projected onto the mask of the initial x3p object and exported as a <code>lines</code> attribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_extract_profile_segments(
  x3p,
  width,
  col = "#FF0000",
  linewidth = 11,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_extract_profile_segments_+3A_x3p">x3p</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_segments_+3A_width">width</code></td>
<td>
<p>segment width</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_segments_+3A_col">col</code></td>
<td>
<p>color</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_segments_+3A_linewidth">linewidth</code></td>
<td>
<p>integer value specifying the width for the profile</p>
</td></tr>
<tr><td><code id="x3p_extract_profile_segments_+3A_verbose">verbose</code></td>
<td>
<p>logical</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with added <code>lines</code> attribute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
logo &lt;- x3p_m_to_mum(logo)
if(interactive())
  x3p_extract_profile_segments(logo, 850, col="#ffffff", linewidth=5)
</code></pre>

<hr>
<h2 id='x3p_flip_x'>Flip the x coordinate of an x3p file</h2><span id='topic+x3p_flip_x'></span><span id='topic+x_flip_x3p'></span>

<h3>Description</h3>

<p>Flip the surface matrix of an x3p file along the x axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_flip_x(x3p)

x_flip_x3p(x3p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_flip_x_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object in which the x coordinate is reversed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
dim(logo$surface.matrix)
## Not run: 
x3p_image(logo)

## End(Not run)
# flip the y-axis for the old ISO standard:
logoflip &lt;- x3p_flip_x(logo)
dim(logoflip$surface.matrix)
## Not run: 
x3p_image(logoflip)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_flip_y'>Flip the y coordinate of an x3p image</h2><span id='topic+x3p_flip_y'></span><span id='topic+y_flip_x3p'></span>

<h3>Description</h3>

<p>One of the major changes between the previous two ISO standards is the
way the y axis is defined in a scan. The entry (0,0) used to refer to the top left corner of a scan, now it refers to the
bottom right corner, which means that all legacy x3p files have to flip their y axis in order to
conform to the newest ISO norm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_flip_y(x3p)

y_flip_x3p(x3p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_flip_y_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object in which the y coordinate is reversed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
dim(logo$surface.matrix)
## Not run: 
x3p_image(logo)

## End(Not run)
# flip the y-axis for the old ISO standard:
logoflip &lt;- x3p_flip_y(logo)
dim(logoflip$surface.matrix)
## Not run: 
x3p_image(logoflip)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_fuzzyselect'>Interactive selection of region of interest</h2><span id='topic+x3p_fuzzyselect'></span>

<h3>Description</h3>

<p>Interactive selection of region of interest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_fuzzyselect(x3p, col = "#FF0000", mad = 5, type = "plane", update = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_fuzzyselect_+3A_x3p">x3p</code></td>
<td>
<p>x3p file</p>
</td></tr>
<tr><td><code id="x3p_fuzzyselect_+3A_col">col</code></td>
<td>
<p>character value of the selection color</p>
</td></tr>
<tr><td><code id="x3p_fuzzyselect_+3A_mad">mad</code></td>
<td>
<p>scalar</p>
</td></tr>
<tr><td><code id="x3p_fuzzyselect_+3A_type">type</code></td>
<td>
<p>only &quot;plane&quot; is implemented at the moment</p>
</td></tr>
<tr><td><code id="x3p_fuzzyselect_+3A_update">update</code></td>
<td>
<p>boolean value, whether the rgl window should be updated to show the selected rectangle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p file with updated mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if (interactive) {
  if (!file.exists("fadul1-1.x3p")) {
    url &lt;- "https://tsapps.nist.gov/NRBTD/Studies/CartridgeMeasurement/DownloadMeasurement"
    file &lt;- "2d9cc51f-6f66-40a0-973a-a9292dbee36d"
    download.file(file.path(url, file), destfile="fadul1-1.x3p")
  }
  x3p &lt;- x3p_read("fadul1-1.x3p")
  x3p_image(x3p, size=c(500,500), zoom=.8)
  x3p &lt;- x3p_fuzzyselect(x3p, update=TRUE, col="#FF0000") 

  logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
  x3p_image(logo, size=c(500,500), zoom = 1)
  x3p_fuzzyselect(logo, update=TRUE, col="#00FF00") 
}
## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_get_scale'>Check resolution of a scan</h2><span id='topic+x3p_get_scale'></span>

<h3>Description</h3>

<p>Scans in x3p format capture 3d topogographic surfaces. According to ISO standard
ISO5436 - 2000 scans are supposed to be captured in meters. For microscopic images
capture in meters might be impractical.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_get_scale(x3p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_get_scale_+3A_x3p">x3p</code></td>
<td>
<p>object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric value of resolution per pixel
</p>

<hr>
<h2 id='x3p_image'>Plot x3p object as an image</h2><span id='topic+x3p_image'></span><span id='topic+image_x3p'></span>

<h3>Description</h3>

<p>Plot an interactive surface plot of the x3p matrix. This implementation uses the <code>rgl</code> package.
In case <code>rgl.useNULL</code> is set to TRUE (i.e. no separate window will be opened), an rgl widget
can be used to show the surface in the viewer window (see the example).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_image(
  x3p,
  file = NULL,
  col = "#cd7f32",
  size = 750,
  zoom = 0.35,
  multiply = 5,
  update = FALSE,
  ...
)

image_x3p(
  x3p,
  file = NULL,
  col = "#cd7f32",
  size = c(750, 250),
  zoom = 0.35,
  multiply = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_image_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_image_+3A_file">file</code></td>
<td>
<p>file name for saving, if file is NULL the opengl device stays open.
The file extension determines the type of output. Possible extensions are png, stl (suitable for 3d printing), or svg.</p>
</td></tr>
<tr><td><code id="x3p_image_+3A_col">col</code></td>
<td>
<p>color specification</p>
</td></tr>
<tr><td><code id="x3p_image_+3A_size">size</code></td>
<td>
<p>vector of width and height. If only one value is given, height or width will be adjusted proportionally to the dimensions of the surface matrix of the scan to reach an upper bound of size.</p>
</td></tr>
<tr><td><code id="x3p_image_+3A_zoom">zoom</code></td>
<td>
<p>numeric value indicating the amount of zoom</p>
</td></tr>
<tr><td><code id="x3p_image_+3A_multiply">multiply</code></td>
<td>
<p>exaggerate the relief by factor multiply</p>
</td></tr>
<tr><td><code id="x3p_image_+3A_update">update</code></td>
<td>
<p>Boolean value indicating whether a scene should be updated (defaults to FALSE). If FALSE, a new rgl device is opened.</p>
</td></tr>
<tr><td><code id="x3p_image_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>save &lt;- getOption("rgl.useNULL")
options(rgl.useNULL=TRUE)

logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
x3p_image(logo, size = c(741, 419), zoom=0.5)
# add crosscut:
logoplus &lt;- x3p_add_hline(logo, yintercept = 50*.645e-6, color = "#e6bf98", size = 5)
x3p_image(logoplus, size = c(741, 419), zoom=0.5)
widget &lt;- rgl::rglwidget()
if (interactive())
  widget

options(rgl.useNULL=save)   
</code></pre>

<hr>
<h2 id='x3p_interpolate'>Interpolate from an x3p object</h2><span id='topic+x3p_interpolate'></span><span id='topic+interpolate_x3p'></span>

<h3>Description</h3>

<p>An interpolated scan is created at specified resolutions <code>resx</code>, <code>resy</code> in x and y direction.
The interpolation is based on <code>na.approx</code> from the <code>zoo</code> package. It is possible to create interpolations at a higher resolution than the one specified in the data itself, but it is not recommended to do so.
<code>x3p_interpolate</code> can also be used as a way to linearly interpolate any missing values in an existing scan without changing the resolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_interpolate(x3p, resx = 1e-06, resy = resx, maxgap = 1)

interpolate_x3p(x3p, resx = 1e-06, resy = resx, maxgap = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_interpolate_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_interpolate_+3A_resx">resx</code></td>
<td>
<p>numeric value specifying the new resolution for the x axis.</p>
</td></tr>
<tr><td><code id="x3p_interpolate_+3A_resy">resy</code></td>
<td>
<p>numeric value specifying the new resolution for the y axis.</p>
</td></tr>
<tr><td><code id="x3p_interpolate_+3A_maxgap">maxgap</code></td>
<td>
<p>integer variable used in <code>na.approx</code> to specify the maximum number of NAs to be interpolated, defaults to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>interpolated x3p object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
# resolution:
logo$header.info$incrementX
# change resolution to 1 micron = 1e-6 meters
logo2 &lt;- x3p_interpolate(logo, resx = 1e-6)
logo2$header.info$incrementX
</code></pre>

<hr>
<h2 id='x3p_lighter'>Lighten active rgl object</h2><span id='topic+x3p_lighter'></span>

<h3>Description</h3>

<p>Make the currently active rgl object lighter. Adds a light source. Up to eight light sources can be added. Alternatively, any rgl light source can be added (see <code>light3d</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_lighter()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>x3p &lt;- x3p_read(system.file("sample-land.x3p", package="x3ptools"))
## Not run: 
x3p_image(x3p) # run when rgl can open window on the device
x3p_lighter() # add a light source

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_m_to_mum'>Convert x3p header information to microns from meters</h2><span id='topic+x3p_m_to_mum'></span>

<h3>Description</h3>

<p>ISO standard 5436_2 asks for specification of values in meters.
For topographic surfaces collected by microscopes values in microns are
more readable. Besides scaling the values in the surface matrix, corresponding
increments are changed to microns as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_m_to_mum(x3p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_m_to_mum_+3A_x3p">x3p</code></td>
<td>
<p>x3p file with header information in meters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p with header information in microns
</p>

<hr>
<h2 id='x3p_mask_legend'>Get legend for mask colors</h2><span id='topic+x3p_mask_legend'></span>

<h3>Description</h3>

<p>Retrieve  color definitions and annotations from the mask. If available, results in a named vector of colors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_mask_legend(x3p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_mask_legend_+3A_x3p">x3p</code></td>
<td>
<p>x3p object with a mask</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named vector of colors, names show annotations. In case no annotations exist NULL is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x3p &lt;- x3p_read(system.file("sample-land.x3p", package="x3ptools"))
x3p_mask_legend(x3p) # annotations and color hex definitions
</code></pre>

<hr>
<h2 id='x3p_mask_quantile'>Draw a quantile region on the mask</h2><span id='topic+x3p_mask_quantile'></span>

<h3>Description</h3>

<p>For each x value of the surface matrix add a region to the mask of an x3p object corresponding to the area between two specified
quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_mask_quantile(
  x3p,
  quantiles = c(0.25, 0.75),
  color = "red",
  annotation = "quantile-region"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_mask_quantile_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_mask_quantile_+3A_quantiles">quantiles</code></td>
<td>
<p>vector of quantiles between which surface matrix values are included in the mask</p>
</td></tr>
<tr><td><code id="x3p_mask_quantile_+3A_color">color</code></td>
<td>
<p>name or hex value of color</p>
</td></tr>
<tr><td><code id="x3p_mask_quantile_+3A_annotation">annotation</code></td>
<td>
<p>character value describing the region</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with changed mask
</p>

<hr>
<h2 id='x3p_modify_xml'>Modify xml elements meta information in x3p object</h2><span id='topic+x3p_modify_xml'></span>

<h3>Description</h3>

<p>Identify xml fields in the meta file of an x3p object by name and modify content if uniquely described.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_modify_xml(x3p, element, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_modify_xml_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_modify_xml_+3A_element">element</code></td>
<td>
<p>character or integer. In case of character, name of xml field in the meta file. Note that element can contain regular expressions, e.g. <code>"*"</code> returns all meta fields.
In case of integer, element is used as an index for the meta fields.</p>
</td></tr>
<tr><td><code id="x3p_modify_xml_+3A_value">value</code></td>
<td>
<p>character. Value to be given to the xml field in the meta file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with changed meta information
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
x3p_show_xml(logo, "creator")
x3p_modify_xml(logo, "creator", "I did that")
x3p_show_xml(logo, 20)
x3p_modify_xml(logo, 20, "I did that, too")
</code></pre>

<hr>
<h2 id='x3p_read'>Read an x3p file into an x3p object</h2><span id='topic+x3p_read'></span><span id='topic+read_x3p'></span>

<h3>Description</h3>

<p>Read file in x3p format. x3p formats describe 3d topological surface according to
ISO standard ISO5436  2000.
x3p files are a container format implemented as a zip archive of a folder
consisting of an xml file of meta
information and a binary matrix of numeric surface measurements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_read(file, size = NA, quiet = T, tmpdir = NULL)

read_x3p(file, size = NA, quiet = T, tmpdir = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_read_+3A_file">file</code></td>
<td>
<p>The file path to the x3p file, or an url to an x3p file</p>
</td></tr>
<tr><td><code id="x3p_read_+3A_size">size</code></td>
<td>
<p>size in bytes to use for reading the binary file. If not specified, default is used. Will be overwritten if specified in the xml meta file.</p>
</td></tr>
<tr><td><code id="x3p_read_+3A_quiet">quiet</code></td>
<td>
<p>for url downloads, show download progress?</p>
</td></tr>
<tr><td><code id="x3p_read_+3A_tmpdir">tmpdir</code></td>
<td>
<p>temporary directory to use to extract the x3p file (default NULL uses tempdir() to set a directory).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object consisting of a list of the surface matrix and the four records as specified in the ISO standard
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
</code></pre>

<hr>
<h2 id='x3p_read_dat'>Read data from an x-y-z file</h2><span id='topic+x3p_read_dat'></span>

<h3>Description</h3>

<p>Read data from an x-y-z file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_read_dat(dat, delim = " ", col_names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_read_dat_+3A_dat">dat</code></td>
<td>
<p>path to the x-y-z file</p>
</td></tr>
<tr><td><code id="x3p_read_dat_+3A_delim">delim</code></td>
<td>
<p>character determining delimiter</p>
</td></tr>
<tr><td><code id="x3p_read_dat_+3A_col_names">col_names</code></td>
<td>
<p>logical value - does the first line of the file contain the column names? Default is set to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object
</p>

<hr>
<h2 id='x3p_read_plux'>Read information from plux file</h2><span id='topic+x3p_read_plux'></span>

<h3>Description</h3>

<p>plux files are zip containers of 3d topographic scans in a format proprietary to Sensofar.
One of the files in the container is the file <code>index.xml</code> which contains meta-information on the instrument, scan settings, date, and creator.
This information is added to the x3p meta-information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_read_plux(plux)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_read_plux_+3A_plux">plux</code></td>
<td>
<p>path to plux file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>xml of general information as stored in the plux file
</p>

<hr>
<h2 id='x3p_rotate'>Rotate an x3p object</h2><span id='topic+x3p_rotate'></span><span id='topic+rotate_x3p'></span>

<h3>Description</h3>

<p>Rotate the surface matrix and mask of an x3p object. Also adjust meta information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_rotate(x3p, angle = 90)

rotate_x3p(x3p, angle = 90)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_rotate_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_rotate_+3A_angle">angle</code></td>
<td>
<p>rotate counter-clockwise by angle in degrees.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
logo &lt;- x3p_read(system.file("csafe-logo.x3p", package = "x3ptools"))
color_logo &lt;- png::readPNG(system.file("csafe-color.png", package="x3ptools"))
logoplus &lt;- x3p_add_mask(logo, as.raster(color_logo))
dim(logoplus$surface.matrix)
dim(logoplus$mask)
x3p_image(logoplus, multiply=50, size = c(741, 419),zoom = 0.5)

logoplus60 &lt;- x3p_rotate(x3p = logoplus, angle = 60)
dim(logoplus60$surface.matrix)
dim(logoplus60$mask)
x3p_image(logoplus60, multiply=50, size = c(741, 419),zoom = 0.75)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_sample'>Sample from an x3p object</h2><span id='topic+x3p_sample'></span><span id='topic+sample_x3p'></span>

<h3>Description</h3>

<p>Sample from an x3p object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_sample(x3p, m = 2, mY = m, offset = 0, offsetY = offset)

sample_x3p(x3p, m = 2, mY = m, offset = 0, offsetY = offset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_sample_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_sample_+3A_m">m</code></td>
<td>
<p>integer value - every mth value is included in the sample</p>
</td></tr>
<tr><td><code id="x3p_sample_+3A_my">mY</code></td>
<td>
<p>integer value - every mth value is included in the sample in x direction and every mYth value is included in y direction</p>
</td></tr>
<tr><td><code id="x3p_sample_+3A_offset">offset</code></td>
<td>
<p>integer value between 0 and m-1 to specify offset of the sample</p>
</td></tr>
<tr><td><code id="x3p_sample_+3A_offsety">offsetY</code></td>
<td>
<p>integer value between 0 and mY-1 to specify different offsets for x and y direction</p>
</td></tr>
</table>


<h3>Value</h3>

<p>down-sampled x3p object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
dim(logo$surface.matrix)
# down-sample to one-fourth of the image:
logo4 &lt;- x3p_sample(logo, m=4)
dim(logo4$surface.matrix)
## Not run: 
x3p_image(logo)
x3p_image(logo4)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_scale_unit'>Scale x3p object by given unit</h2><span id='topic+x3p_scale_unit'></span>

<h3>Description</h3>

<p>x3p objects can be presented in different units. ISO standard 5436_2 asks for specification of values in meters.
For topographic surfaces collected by microscopes values in microns are
more readable. This functions allows to convert between different units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_scale_unit(x3p, scale_by)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_scale_unit_+3A_x3p">x3p</code></td>
<td>
<p>object in x3p format, 3d topographic surface.</p>
</td></tr>
<tr><td><code id="x3p_scale_unit_+3A_scale_by">scale_by</code></td>
<td>
<p>numeric value. Value the surface to be scaled by. While not enforced, values of <code>scale_by</code> make most sense as multiples of 10 (for a metric system).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p with header information in microns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
logo # measurements in meters
x3p_scale_unit(logo, scale_by=10^6) # measurements in microns
</code></pre>

<hr>
<h2 id='x3p_select'>Draw rectangle on the mask of an x3p file using rgl</h2><span id='topic+x3p_select'></span>

<h3>Description</h3>

<p>Interactive selection of rectangular area on the mask of an x3p object. Once the function runs, the active rgl window is brought to the front.
Select the window with a click, then use click &amp; drag to select a rectangular area. On release, this area is marked in the mask and (if update is TRUE) appears in the selection color in the active rgl window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_select(x3p, col = "#FF0000", update = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_select_+3A_x3p">x3p</code></td>
<td>
<p>x3p file</p>
</td></tr>
<tr><td><code id="x3p_select_+3A_col">col</code></td>
<td>
<p>character value of the selection color</p>
</td></tr>
<tr><td><code id="x3p_select_+3A_update">update</code></td>
<td>
<p>boolean value, whether the rgl window should be updated to show the selected rectangle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p file with selection in mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if (interactive) {
  if (!file.exists("fadul1-1.x3p")) {
    url &lt;- "https://tsapps.nist.gov/NRBTD/Studies/CartridgeMeasurement/DownloadMeasurement"
    file &lt;- "2d9cc51f-6f66-40a0-973a-a9292dbee36d"
    download.file(file.path(url, file), destfile="fadul1-1.x3p")
  }
  x3p &lt;- x3p_read("fadul1-1.x3p")
  x3p_image(x3p, size=c(500,500), zoom=.8)
  x3p &lt;- x3p_select(x3p, update=TRUE, col="#FF0000") 

  logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
  x3p_image(logo, size=c(500,500), zoom = 1)
  x3p_select(logo, update=TRUE, col="#00FF00") 
}
## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_shade_mask'>Shade the mask of an x3p object to reflect its surface profile</h2><span id='topic+x3p_shade_mask'></span>

<h3>Description</h3>

<p>Apply color shading to the mask of a 3d topographic surface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_shade_mask(
  x3p,
  colors = rev(c("#b12819", "#d7301f", "#e16457", "#ffffff", "#5186a2", "#175d82",
    "#134D6B")),
  freqs = c(0, 0.05, 0.25, 0.45, 0.55, 0.75, 0.95, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_shade_mask_+3A_x3p">x3p</code></td>
<td>
<p>object containing a 3d topographic surface</p>
</td></tr>
<tr><td><code id="x3p_shade_mask_+3A_colors">colors</code></td>
<td>
<p>vector of colors</p>
</td></tr>
<tr><td><code id="x3p_shade_mask_+3A_freqs">freqs</code></td>
<td>
<p>vector of values corresponding to color frequency (turned into quantiles of the differenced values)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object with color-shaded mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(wire)
x3p &lt;- wire
x3p_image(x3p, size = c(400, 400), zoom=0.8)
x3p_with &lt;- x3p %&gt;% x3p_shade_mask()
x3p_image(x3p_with, size = c(400, 400), zoom=0.8)

data(lea)
lea %&gt;% x3p_shade_mask() %&gt;% x3p_image()
lea %&gt;% x3p_shade_mask(freqs = c(0, 0.05, 0.1, 0.3,0.7, 0.9, 0.95, 1)) %&gt;% x3p_image()

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_show_xml'>Show xml elements from meta information in x3p object</h2><span id='topic+x3p_show_xml'></span>

<h3>Description</h3>

<p>Identify xml fields by name and show content.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_show_xml(x3p, element)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_show_xml_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_show_xml_+3A_element">element</code></td>
<td>
<p>character or integer (vector). In case of character, name of xml field in the meta file. Note that element can contain regular expressions, e.g. <code>"*"</code> returns all meta fields.
In case of integer, element is used as an index vector for the meta fields.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of exact field names and their contents
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
x3p_show_xml(logo, "creator") # all fields containing the word "creator"
x3p_show_xml(logo, "axis")
x3p_show_xml(logo, "CZ.AxisType")
# show all fields:
x3p_show_xml(logo, "*")
# show first five fields
x3p_show_xml(logo, 1:5)
</code></pre>

<hr>
<h2 id='x3p_snapshot'>Take a snapshot of the active rgl device and save in a file</h2><span id='topic+x3p_snapshot'></span>

<h3>Description</h3>

<p>Make a snapshot of the current rgl device and save it to file. Options for file formats are png, svg, and stl (for 3d printing).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_snapshot(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_snapshot_+3A_file">file</code></td>
<td>
<p>file name for saving.
The file extension determines the type of output. Possible extensions are png, stl (suitable for 3d printing), or svg.</p>
</td></tr>
</table>

<hr>
<h2 id='x3p_to_df'>Convert an x3p file into a data frame</h2><span id='topic+x3p_to_df'></span>

<h3>Description</h3>

<p>An x3p file consists of a list with meta info and a 2d matrix with scan depths.
fortify turns the matrix into a data frame, using the parameters of the header as necessary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_to_df(x3p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_to_df_+3A_x3p">x3p</code></td>
<td>
<p>a file in x3p format as returned by function x3p_read</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with variables x, y, and value and meta function in attribute
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
logo_df &lt;- x3p_to_df(logo)
head(logo_df)
</code></pre>

<hr>
<h2 id='x3p_transpose'>Transpose an x3p object</h2><span id='topic+x3p_transpose'></span><span id='topic+transpose_x3p'></span>

<h3>Description</h3>

<p>Transpose the surface matrix of an x3p object. Also adjust meta information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_transpose(x3p)

transpose_x3p(x3p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_transpose_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
dim(logo$surface.matrix)
## Not run: 
x3p_image(logo)

## End(Not run)
#  transpose the image
logotp &lt;- x3p_transpose(logo)
dim(logotp$surface.matrix)
## Not run: 
x3p_image(logotp)

## End(Not run)
</code></pre>

<hr>
<h2 id='x3p_trim_na'>Trim rows and columns with missing values only from an x3p</h2><span id='topic+x3p_trim_na'></span>

<h3>Description</h3>

<p>Trims rows and columns from the edges of a surface matrix that contain missing values only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_trim_na(x3p, ratio = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_trim_na_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_trim_na_+3A_ratio">ratio</code></td>
<td>
<p>ratio between zero and one, indicating the percent of values that need to be missing in each row and column, for the row or column to be removed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x3p object of the same or smaller dimension where missing values are removed from the boundaries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
logo$surface.matrix[logo$surface.matrix == median(logo$surface.matrix)] &lt;- NA
x3p_trim_na(logo) # reduced to dimension: 668 by 268
</code></pre>

<hr>
<h2 id='x3p_write'>Write an x3p object to a file</h2><span id='topic+x3p_write'></span><span id='topic+write_x3p'></span>

<h3>Description</h3>

<p>Write an x3p object to a file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x3p_write(x3p, file, size = 8, quiet = F, create_dir = T)

write_x3p(x3p, file, size = 8, quiet = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="x3p_write_+3A_x3p">x3p</code></td>
<td>
<p>x3p object</p>
</td></tr>
<tr><td><code id="x3p_write_+3A_file">file</code></td>
<td>
<p>path to where the file should be written</p>
</td></tr>
<tr><td><code id="x3p_write_+3A_size">size</code></td>
<td>
<p>integer. The number of bytes per element in the  surface matrix used for creating the binary file. Use size = 4 for 32 bit IEEE 754 floating point numbers and size = 8 for 64 bit IEEE 754 floating point number (default).</p>
</td></tr>
<tr><td><code id="x3p_write_+3A_quiet">quiet</code></td>
<td>
<p>suppress messages</p>
</td></tr>
<tr><td><code id="x3p_write_+3A_create_dir">create_dir</code></td>
<td>
<p>boolean. create directory for saving file, if necessary. Posts a message in case a directory is created.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>logo &lt;- x3p_read(system.file("csafe-logo.x3p", package="x3ptools"))
# write a copy of the file into a temporary file
x3p_write(logo, file = tempfile(fileext="x3p"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
